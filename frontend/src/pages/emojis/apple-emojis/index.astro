---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import AdBanner from '../../../components/banner/AdBanner';
import { getAllEmojis, getEmojiCategories } from '../../../lib/emojis';

// Load all emojis
const emojis = await getAllEmojis();

// Metadata-based categories
const categories = getEmojiCategories();
const emojisByCategory: Record<string, EmojiData[]> = {};

// Group emojis by category
for (const cat of categories) {
  emojisByCategory[cat] = emojis.filter((e) => (e.category || 'Other') === cat);
}

// Sort categories alphabetically and exclude "Other"
const sortedCategories = Object.keys(emojisByCategory)
  .filter((cat) => cat !== 'Other')
  .sort();

// Sort emojis within each category by title (fallback to slug)
for (const category of sortedCategories) {
  emojisByCategory[category].sort((a, b) => {
    const titleA = a.title || a.slug || '';
    const titleB = b.title || b.slug || '';
    return titleA.localeCompare(titleB);
  });
}

// Pagination logic for page 1
const itemsPerPage = 30;
const currentPage = 1;
const totalPages = Math.ceil(sortedCategories.length / itemsPerPage);
const startIndex = (currentPage - 1) * itemsPerPage;
const endIndex = startIndex + itemsPerPage;
const paginatedCategories = sortedCategories.slice(startIndex, endIndex);
const totalCategories = sortedCategories.length;

// Breadcrumb items
const breadcrumbItems = [
  { label: 'Free DevTools', href: '/freedevtools/' },
  { label: 'Emojis', href: '/freedevtools/emojis/' },
  { label: 'Apple Emojis' }
];

// SEO data
const seoTitle = currentPage === 1
  ? "Apple Emojis Reference - Browse & Copy Apple Emojis | Online Free DevTools by Hexmos"
  : `Apple Emojis Reference - Page ${currentPage} | Online Free DevTools by Hexmos`;

const seoDescription = currentPage === 1
  ? "Browse Apple's version of emojis by category. Copy instantly, explore meanings, and discover platform-specific emoji designs."
  : `Browse page ${currentPage} of Apple's emoji reference. Copy instantly, explore meanings, and discover iOS-style emoji artwork.`;

const canonical = currentPage === 1
  ? "https://hexmos.com/freedevtools/emojis/apple-emojis/"
  : `https://hexmos.com/freedevtools/emojis/apple-emojis/${currentPage}/`;

const mainKeywords = [
  'apple emojis',
  'ios emojis',
  'apple emoji list',
  'apple emoji reference',
  'emoji categories',
  'copy emojis',
  'emoji meanings',
  'emoji shortcodes',
  'emoji library',
  'emoji copy'
];

// Category icons
export const categoryIconMap: Record<string, string> = {
  "Smileys & Emotion": "/freedevtools/emoji_data/slightly-smiling-face/apple-emojis/slightly-smiling-face_iOS_18.4.png",
  "People & Body": "/freedevtools/emoji_data/bust-in-silhouette/apple-emojis/bust-in-silhouette_1f464_iOS_18.4.png",
  "Animals & Nature": "/freedevtools/emoji_data/dog-face/apple-emojis/dog-face_1f436_iOS_18.4.png",
  "Food & Drink": "/freedevtools/emoji_data/red-apple/apple-emojis/red-apple_1f34e_iOS_18.4.png",
  "Travel & Places": "/freedevtools/emoji_data/airplane/apple-emojis/airplane_iOS_18.4.png",
  "Activities": "/freedevtools/emoji_data/soccer-ball/apple-emojis/soccer-ball_26bd_iOS_18.4.png",
  "Objects": "/freedevtools/emoji_data/mobile-phone/apple-emojis/mobile-phone_iOS_18.4.png",
  "Symbols": "/freedevtools/emoji_data/check-mark-button/apple-emojis/check-mark-button_2705_iOS_18.4.png",
  "Flags": "/freedevtools/emoji_data/chequered-flag/apple-emojis/chequered-flag_iOS_18.4.png",
  "Other": "/freedevtools/emoji_data/question-mark/apple-emojis/question-mark_2753_iOS_18.4.png"
};
---

<BaseLayout 
  name="Apple Emojis"
  path={currentPage === 1 ? "/freedevtools/emojis/apple-emojis/" : `/freedevtools/emojis/apple-emojis/${currentPage}/`}
  title={seoTitle}
  description={seoDescription}
  canonical={canonical}
  themeColor="#1e40af"
  showHeader={true}
  totalItems={totalCategories}
  itemsPerPage={itemsPerPage}
  currentPage={currentPage}
  category="Emojis"
  partOf="Free DevTools"
  partOfUrl="https://hexmos.com/freedevtools/"
  keywords={mainKeywords}
  features={["Apple-style designs", "Browse by category", "Copy instantly", "Compare with Unicode", "Free access"]}
  emojiCategory="Apple Emojis"
>
  <div class="max-w-6xl mx-auto px-2 md:px-6">
    <div class="mb-16 mt-[74px]">
      <AdBanner />
    </div>

    <div class="mb-8">
      <!-- Breadcrumbs -->
      <nav class="text-sm text-slate-600 dark:text-slate-400 mb-4">
        {breadcrumbItems.map((item, idx) => (
          <>
            {idx > 0 && <span class="mx-2">/</span>}
            {item.href ? (
              <a href={item.href} class="hover:text-blue-600 dark:hover:text-blue-400">{item.label}</a>
            ) : (
              <span>{item.label}</span>
            )}
          </>
        ))}
      </nav>

      <h1 class="text-3xl font-bold text-slate-900 dark:text-slate-100 mb-4">
        Apple Emojis üçé
      </h1>

      <p class="text-lg text-slate-600 dark:text-slate-400 mb-6">
        Apple's emojis are renowned for their vibrant, playful designs and frequent updates with each iOS release. 
        Unlike the standard Unicode glyphs, Apple creates custom artwork for every emoji, making their set instantly recognizable 
        to iPhone, iPad, and Mac users.
        Discover Apple's full emoji collection here ‚Äî complete with previews and instant copy functionality for all categories. 
        Whether you're checking out new emojis from the latest iOS update or comparing platform differences, 
        this page makes it easy to explore Apple's creative emoji style.
      </p>
    </div>

    <!-- Emoji Categories Grid -->
    <div id="emoji-categories" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {paginatedCategories.map((category) => (
        <div class="category-card bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-4 transition-all duration-300 ease-in-out shadow-sm hover:-translate-y-1 hover:shadow-xl">
          <div class="flex items-center mb-4">
            <div class="w-10 h-10 flex items-center justify-center mr-3">
              <img 
                src={categoryIconMap[category] || "/freedevtools/emoji_data/question-mark/apple-emojis/question-mark_2753_iOS_18.4.png"} 
                alt={category + " icon"} 
                class="h-10 w-10" 
              />
            </div>
            <a 
              href={`/freedevtools/emojis/apple-emojis/${category.toLowerCase().replace(/[^a-z0-9]+/g, '-')}/`}
              class="text-xl font-semibold text-black dark:text-neon-light capitalize hover:text-green-600 dark:hover:text-green-400 transition-colors"
            >
              {category}
            </a>
          </div>
          <p class="text-sm text-slate-800 dark:text-slate-400 mb-2">
            {emojisByCategory[category].length} emojis available
          </p>
        </div>
      ))}
    </div>

    <!-- Navigation -->
    <div class="mt-10 pt-6 mb-8 border-t border-slate-200 dark:border-slate-700">
      <div class="flex flex-wrap gap-4">
        <a 
          href="/freedevtools/emojis/" 
          class="inline-flex items-center px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 rounded-lg hover:bg-blue-100 transition-colors"
        >
          ‚Üê Back to Emojis
        </a>
      </div>
    </div>
  </div>
</BaseLayout>
