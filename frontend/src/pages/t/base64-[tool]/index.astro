---
import type { Tool } from '@/config/tools';
import { getToolByKey } from '@/config/tools';
import BaseLayout from '@/layouts/BaseLayout.astro';
import Base64Encoder from './_Base64Encoder';

// Dynamic routes: tell Astro all possible `tool` keys
export function getStaticPaths() {
  return [
    { params: { tool: "encoder" }},
    { params: { tool: "decoder" }},
    { params: { tool: "utilities" }},
  ];
}

// Use the param from route
const { tool } = Astro.params;

// Map short key to full tool key used in config
const toolKey = `base64-${tool}`;

// Fetch the tool config; fallback to utilities if invalid
const toolConfig = (getToolByKey(toolKey) as Tool) || getToolByKey('base64-utilities');
---

<BaseLayout 
  name={toolConfig.name}
  title={toolConfig.title}
  path={toolConfig.path}
  description={toolConfig.description}
  canonical={toolConfig.canonical}
  keywords={toolConfig.keywords}
  ogImage={toolConfig.ogImage}
  twitterImage={toolConfig.twitterImage}
  datePublished={toolConfig.datePublished}
  softwareVersion={toolConfig.softwareVersion}
  features={toolConfig.features}
>
  <Base64Encoder client:load tool={toolKey} />
</BaseLayout>
