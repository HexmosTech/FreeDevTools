---
import { getToolByKey } from '../../config/tools';
import BaseLayout from '../../layouts/BaseLayout.astro';
import JsonPrettifier from './_JsonPrettifier.tsx';
import type { Tool } from '../../config/tools';

// âœ… Define JSON_KEYS inside the frontmatter block

// Dynamic routes: tell Astro all possible `tool` keys
export function getStaticPaths() {
  return [
    { params: { tool: "prettifier" }},
    { params: { tool: "validator" }},
    { params: { tool: "fixer" }},
  ];
}

// Use the param from route
const { tool } = Astro.params;

// Map short key to full tool key used in config
const toolKey = `json-${tool}`;

// Fetch the tool config; fallback to prettifier if invalid
const toolConfig = (getToolByKey(toolKey) as Tool) || getToolByKey('json-prettifier');
---

<BaseLayout 
  name={toolConfig.name}
  title={toolConfig.title}
  path={toolConfig.path}
  description={toolConfig.description}
  canonical={toolConfig.canonical}
  themeColor={toolConfig.themeColor}
  keywords={toolConfig.keywords}
  ogImage={toolConfig.ogImage}
  twitterImage={toolConfig.twitterImage}
  datePublished={toolConfig.datePublished}
  softwareVersion={toolConfig.softwareVersion}
  features={toolConfig.features}
>
  <JsonPrettifier client:load tool={toolKey} />
</BaseLayout>
