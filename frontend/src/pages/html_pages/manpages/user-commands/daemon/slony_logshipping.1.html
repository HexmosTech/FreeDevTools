<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>slony_logshipping - slony_logshippping daemon</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/slony1-2-bin">slony1-2-bin_2.2.11-6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       slony_logshipping - slony_logshippping daemon

</pre><h4><b>slony_logshipper</b> <b>TOOL</b></h4><pre>
       slony_logshipper  is  a  tool  designed  to  help  apply  logs. It runs as a daemon and scans the archive
       directory for new .SQL files which it then applies to the target database. It can be run with three sorts
       of parameters:

</pre><h4><b>OPTIONS</b></h4><pre>
       • Options, chosen from the following:

         • <b>h</b>

           display this help text and exit

         • <b>v</b>

           display program version and exit

         • <b>q</b>

           quiet mode

         • <b>l</b>

           cause running daemon to reopen its logfile

         • <b>r</b>

           cause running daemon to resume after error

         • <b>t</b>

           cause running daemon to enter smart shutdown mode

         • <b>T</b>

           cause running daemon to enter immediate shutdown mode

         • <b>c</b>

           destroy existing semaphore set and message queue (use with caution)

         • <b>f</b>

           stay in foreground (don't daemonize)

         • <b>w</b>

           enter smart shutdown mode immediately

       • A specified log shipper configuration file

         This configuration file consists of the following specifications:

         • <b>logfile</b> <b>=</b> <b>'./offline_logs/logshipper.log';</b>

           Where the log shipper will leave messages.

         • <b>cluster</b> <b>name</b> <b>=</b> <b>'T1';</b>

           Cluster name

         • <b>destination</b> <b>database</b> <b>=</b> <b>'dbname=slony_test3';</b>

           Optional conninfo for the destination database. If given,  the  log  shipper  will  connect  to  this
           database, and apply logs to it.

         • <b>archive</b> <b>dir</b> <b>=</b> <b>'./offline_logs';</b>

           The  archive  directory is required when running in ‘database-connected’ mode to have a place to scan
           for missing (unapplied) archives.

         • <b>destination</b> <b>dir</b> <b>=</b> <b>'./offline_result';</b>

           If specified, the log shipper will write the results of data massaging into result logfiles  in  this
           directory.

         • <b>max</b> <b>archives</b> <b>=</b> <b>3600;</b>

           This  fights  eventual  resource  leakage;  the daemon will enter ‘smart shutdown’ mode automatically
           after processing this many archives.

         • <b>ignore</b> <b>table</b> <b>"public"."history";</b>

           One may filter out single tables from log shipped replication

         • <b>ignore</b> <b>namespace</b> <b>"public";</b>

           One may filter out entire namespaces from log shipped replication

         • <b>rename</b> <b>namespace</b> <b>"public"."history"</b> <b>to</b> <b>"site_001"."history";</b>

           One may rename specific tables.

         • <b>rename</b> <b>namespace</b> <b>"public"</b> <b>to</b> <b>"site_001";</b>

           One may rename entire namespaces.

         • <b>post</b> <b>processing</b> <b>command</b> <b>=</b> <b>'gzip</b> <b>-9</b> <b>$inarchive';</b>

           Pre- and post-processing commands are executed via <b><a href="../man3/system.3.html">system</a>(3)</b>.

       An ‘@’ as the first character causes the exit code to be ignored.  Otherwise,  a  nonzero  exit  code  is
       treated as an error and causes processing to abort.

       Pre- and post-processing commands have two further special variables defined:

         • <b>$inarchive</b> - indicating incoming archive filename

         • <b>$outnarchive</b> - indicating outgoing archive filename

       • <b>error</b>  <b>command</b>  <b>=</b>  <b>'</b>  <b>(</b>  <b>echo</b> <b>"archive=$inarchive"</b> <b>echo</b> <b>"error</b> <b>messages:"</b> <b>echo</b> <b>"$errortext"</b> <b>)</b> <b>|</b> <b>mail</b> <b>-s</b>
         <b>"Slony</b> <b>log</b> <b>shipping</b> <b>failed"</b> <b>postgres@localhost</b> <b>';</b>

         The error command indicates a command to execute upon encountering an error. All logging since the last
         successful completion of an archive is available in the <b>$errortext</b> variable.

         In the example shown, this sends an email to the DBAs upon encountering an error.

       • Archive File Names

         Each filename is added to the SystemV Message queue for processing by a slony_logshipper process.

                                                19 September 2024                           <u><a href="../man1/slony_logshipping.1.html">slony_logshipping</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>