<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>virt-v2v-input-vmware - Using virt-v2v to convert guests from VMware</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/virt-v2v">virt-v2v_2.6.0-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       virt-v2v-input-vmware - Using virt-v2v to convert guests from VMware

</pre><h4><b>SYNOPSIS</b></h4><pre>
        virt-v2v -i vmx GUEST.vmx [-o* options]

        virt-v2v -i vmx
           -it ssh
           -ip passwordfile
           'ssh://<a href="mailto:root@esxi.example.com">root@esxi.example.com</a>/vmfs/volumes/datastore1/guest/guest.vmx'
           [-o* options]

        virt-v2v
           -ic 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi?no_verify=1'
           -it vddk
           -io vddk-libdir=/path/to/vmware-vix-disklib-distrib
           -io vddk-thumbprint=xx:xx:xx:...
           "GUEST NAME"
           [-o* options]

        virt-v2v -i ova DISK.ova [-o* options]

        virt-v2v
           -ic 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi?no_verify=1'
           -ip passwordfile
           "GUEST NAME" [-o* options]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This page documents how to use <b><a href="../man1/virt-v2v.1.html">virt-v2v</a></b>(1) to convert guests from VMware.  There are currently five
       different methods to access VMware:

       <b>-i</b> <b>vmx</b> GUEST<b>.vmx</b>
           Full documentation: "INPUT FROM VMWARE VMX"

           If  you  either have a <u>GUEST.vmx</u> file and one or more <u>GUEST.vmdk</u> disk image files, or if you are able
           to NFS-mount the VMware storage, then you can use the <u>-i</u> <u>vmx</u> method to read the source guest.

       <b>-i</b> <b>vmx</b> <b>-it</b> <b>ssh</b> ssh://...
           Full documentation: "INPUT FROM VMWARE VMX"

           This is similar to the method above, except it uses an SSH connection to ESXi to read  the  <u>GUEST.vmx</u>
           file  and  associated  disks.   This  requires  that  you  have enabled SSH access to the VMware ESXi
           hypervisor - in the default ESXi configuration this is turned off.

           This transport is incompatible with guests that have snapshots; refer to "NOTES".

       <b>-ic</b> <b>vpx://...</b> <b>-it</b> <b>vddk</b>
       <b>-ic</b> <b>esx://...</b> <b>-it</b> <b>vddk</b>
           Full documentation: "INPUT FROM VDDK"

           This method uses the proprietary VDDK library (a.k.a. VixDiskLib) to access the VMware vCenter server
           or VMware ESXi hypervisor.

           If you have the proprietary library then this method is usually the fastest and  most  flexible.   If
           you don't have or don't want to use non-free software then the VMX or SSH methods above will be best.

       <b>-i</b> <b>ova</b> DISK<b>.ova</b>
           Full documentation: "INPUT FROM VMWARE OVA"

           With  this  method you must first export the guest (eg. from vSphere) as an <u>.ova</u> file, which virt-v2v
           can then read directly.  Note this method only works with files exported from VMware, not  OVA  files
           that  come  from other hypervisors or management systems, since OVA is only a pretend standard and is
           not compatible or interoperable between vendors.

       <b>-ic</b> <b>vpx://...</b> "GUEST NAME"
           Full documentation: "INPUT FROM VMWARE VCENTER SERVER"

           If none of the above methods is available, then use  this  method  to  import  a  guest  from  VMware
           vCenter.  This is the slowest method.

</pre><h4><b>NOTES</b></h4><pre>
       When  accessing the <u>guest.vmx</u> file on ESXi over an SSH connection (that is, when using the <u>-i</u> <u>vmx</u> <u>-it</u> <u>ssh</u>
       options), the conversion will not work if the guest has snapshots  (files  called  <u>guest-000001.vmdk</u>  and
       similar).   Either collapse the snapshots for the guest and retry the conversion with the same <u>-i</u> <u>vmx</u> <u>-it</u>
       <u>ssh</u> options, or leave the snapshots intact and use a transport different from SSH: just <u>-i</u>  <u>vmx</u>,  or  <u>-ic</u>
       <u>vpx://...</u> <u>-it</u> <u>vddk</u> or <u>-ic</u> <u>esx://...</u> <u>-it</u> <u>vddk</u>.  Refer to https://bugzilla.redhat.com/1774386.

</pre><h4><b>INPUT</b> <b>FROM</b> <b>VMWARE</b> <b>VMX</b></h4><pre>
       Virt-v2v is able to import guests from VMware’s vmx files.

       This is useful in two cases:

       1.  VMware virtual machines are stored on a separate NFS server and you are able to mount the NFS storage
           directly.

       2.  You  have  enabled  SSH  access  to  the VMware ESXi hypervisor and there is a "/vmfs/volumes" folder
           containing the virtual machines.

       If you find a folder of files called <u>guest.vmx</u>, <u>guest.vmxf</u>,  <u>guest.nvram</u>  and  one  or  more  <u>.vmdk</u>  disk
       images,  then you can use this method.  The SSH transport is not usable if the guest has snapshots; refer
       to "NOTES".

   <b>VMX:</b> <b>Guest</b> <b>must</b> <b>be</b> <b>shut</b> <b>down</b>
       <b>The</b> <b>guest</b> <b>must</b> <b>be</b> <b>shut</b> <b>down</b> <b>before</b> <b>conversion</b> <b>starts</b>.  If you don't shut it down, you will end up with  a
       corrupted  VM  disk  on the target.  With other methods, virt-v2v tries to prevent concurrent access, but
       because the <u>-i</u> <u>vmx</u> method works directly against the storage,  checking  for  concurrent  access  is  not
       possible.

   <b>VMX:</b> <b>Access</b> <b>to</b> <b>the</b> <b>storage</b> <b>containing</b> <b>the</b> <b>VMX</b> <b>and</b> <b>VMDK</b> <b>files</b>
       If  the  vmx  and  vmdk  files aren't available locally then you must <u>either</u> mount the NFS storage on the
       conversion server <u>or</u> enable passwordless SSH on the ESXi hypervisor.

       <u>VMX:</u> <u>SSH</u> <u>authentication</u>

       You can use SSH password authentication, by supplying the name of a file containing the password  to  the
       <u>-ip</u>  option  (note  this  option  does  <u>not</u>  take  the  password  directly).   You  may  need  to  adjust
       <u><a href="file:/etc/ssh/sshd_config">/etc/ssh/sshd_config</a></u> on the VMware server to set "PasswordAuthentication yes".

       If you are not using password authentication, an alternative is to use ssh-agent, and add your ssh public
       key to <u>/etc/ssh/keys-root/authorized_keys</u> (on the ESXi hypervisor).  After doing this, you  should  check
       that passwordless access works from the virt-v2v server to the ESXi hypervisor.  For example:

        $ ssh <a href="mailto:root@esxi.example.com">root@esxi.example.com</a>
        [ logs straight into the shell, no password is requested ]

       Note  that  support for non-interactive authentication via the <u>-ip</u> option is incomplete.  Some operations
       remain that still require the user to enter the password manually.  Therefore  ssh-agent  is  recommended
       over the <u>-ip</u> option.  See https://bugzilla.redhat.com/1854275.

       <u>VMX:</u> <u>Construct</u> <u>the</u> <u>SSH</u> <u>URI</u>

       When using the SSH input transport you must specify a remote "ssh://..." URI pointing to the VMX file.  A
       typical URI looks like:

        ssh://<a href="mailto:root@esxi.example.com">root@esxi.example.com</a>/vmfs/volumes/datastore1/my%20guest/my%20guest.vmx

       The username is not required if it is the same as your local username.

       You  may  optionally  supply  a  port number after the hostname if the SSH server is not listening on the
       default port (22).

       For determining the pathname component of the URI, log in to the ESXi server via SSH  interactively,  and
       identify the absolute pathname of the VMX file on the ESXi server, such as:

        /vmfs/volumes/datastore1/my guest/my guest.vmx

       Subsequently,  on  the virt-v2v command line, percent-encode any reserved characters that you find in the
       individual pathname components.  For example, space characters must be specified as %20:

        /vmfs/volumes/datastore1/my%20guest/my%20guest.vmx

       Refer to https://bugzilla.redhat.com/1938954.

   <b>VMX:</b> <b>Importing</b> <b>a</b> <b>guest</b>
       To import a vmx file from a local file or NFS, do:

        $ virt-v2v -i vmx guest.vmx -o local -os <a href="file:/var/tmp">/var/tmp</a>

       To import a vmx file over SSH, add <u>-it</u> <u>ssh</u> to select the SSH transport and supply a remote SSH URI:

        $ virt-v2v \
            -i vmx -it ssh \
            "ssh://<a href="mailto:root@esxi.example.com">root@esxi.example.com</a>/vmfs/volumes/datastore1/guest/guest.vmx" \
            -o local -os <a href="file:/var/tmp">/var/tmp</a>

       Virt-v2v processes the vmx file and uses it to find the location of any vmdk disks.

</pre><h4><b>INPUT</b> <b>FROM</b> <b>VDDK</b></h4><pre>
       Virt-v2v is able to import guests using VMware’s proprietary VDDK library (a.k.a. VixDiskLib).

   <b>VDDK:</b> <b>Prerequisites</b>
       1.  As the VDDK  library  is  not  open  source,  and  the  license  of  this  library  does  not  permit
           redistribution  or commercial use, you must obtain VDDK yourself and satisfy yourself that your usage
           of the library is permitted by the license.

       2.  nbdkit ≥ 1.6 is recommended, as it ships with the VDDK plugin enabled unconditionally.

       3.  You must find the SSL  "thumbprint"  of  your  VMware  server.   How  to  do  this  is  explained  in
           <b><a href="../man1/nbdkit-vddk-plugin.1.html">nbdkit-vddk-plugin</a></b>(1), also available at the link above.

       4.  VDDK imports require a feature added in libvirt ≥ 3.7.

       5.  The VMware server must not be in maintenance mode.

   <b>VDDK:</b> <b>ESXi</b> <b>NFC</b> <b>service</b> <b>memory</b> <b>limits</b>
       In the verbose log you may see errors like:

        nbdkit: vddk[3]: error: [NFC ERROR] NfcFssrvrProcessErrorMsg:
        received NFC error 5 from server: Failed to allocate the
        requested 2097176 bytes

       This seems especially common when there are multiple parallel connections open to the VMware server.

       These  can be caused by resource limits set on the VMware server.  You can increase the limit for the NFC
       service by editing <u>/etc/vmware/hostd/config.xml</u> and adjusting the "&lt;maxMemory&gt;" setting:

        &lt;nfcsvc&gt;
          &lt;path&gt;libnfcsvc.so&lt;/path&gt;
          &lt;enabled&gt;true&lt;/enabled&gt;
          &lt;maxMemory&gt;50331648&lt;/maxMemory&gt;
          &lt;maxStreamMemory&gt;10485760&lt;/maxStreamMemory&gt;
        &lt;/nfcsvc&gt;

       and restarting the "hostd" service:

        # /etc/init.d/hostd restart

       For more information see https://bugzilla.redhat.com/1614276.

   <b>VDDK:</b> <b>"error:</b> <b>VixDiskLibVim:</b> <b>Failed</b> <b>to</b> <b>open</b> <b>disk</b> <b>using</b> <b>NFC.</b> <b>VixError</b> <b>1"</b>
       If you see an error similar to:

        nbdkit: vddk[2]: error: VixDiskLibVim: Failed to open disk using NFC. VixError 1 at 1166.

       then it is caused by a bug in VDDK ≤ 6.7.  The suggested solution it to upgrade to the latest VDDK.   See
       also https://bugzilla.redhat.com/1684075

   <b>VDDK:</b> <b>URI</b>
       Construct  the  correct  "vpx://"  (for vCenter) or "esx://" (for ESXi) URL.  It will look something like
       these:

        vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi

        esx://<a href="mailto:root@esxi.example.com">root@esxi.example.com</a>

       To verify that you have the correct URL, use the <b><a href="../man1/virsh.1.html">virsh</a></b>(1) command to list the guests on the server:

        $ virsh -c 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi' list --all
        Enter root's password for vcenter.example.com: ***

         Id    Name                           State
        ----------------------------------------------------
         -     Fedora 20                      shut off
         -     Windows 2003                   shut off

       If you get an error "Peer certificate cannot be authenticated with given  CA  certificates"  or  similar,
       then you can either import the vCenter host’s certificate, or bypass signature verification by adding the
       "?no_verify=1" flag:

        $ virsh -c 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi?no_verify=1' list --all

       You should also try dumping the metadata from any guest on your server, like this:

        $ virsh -c 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi' dumpxml "Windows 2003"
        &lt;domain type='vmware'&gt;
          &lt;name&gt;Windows 2003&lt;/name&gt;
          [...]
          &lt;vmware:moref&gt;vm-123&lt;/vmware:moref&gt;
        &lt;/domain&gt;

       If "&lt;vmware:moref&gt;" does not appear in the metadata, then you need to upgrade libvirt.

       <b>If</b>  <b>the</b>  <b>above</b> <b>commands</b> <b>do</b> <b>not</b> <b>work,</b> <b>then</b> <b>virt-v2v</b> <b>is</b> <b>not</b> <b>going</b> <b>to</b> <b>work</b> <b>either</b>.  Fix your URI and/or your
       VMware server before continuing.

   <b>VDDK:</b> <b>Importing</b> <b>a</b> <b>guest</b>
       The <u>-it</u> <u>vddk</u> parameter selects VDDK as the input transport for disks.

       To import a particular guest from vCenter server or ESXi hypervisor, use a command  like  the  following,
       substituting the URI, guest name and SSL thumbprint:

        $ virt-v2v \
            -ic 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi?no_verify=1' \
            -it vddk \
            -io vddk-libdir=/path/to/vmware-vix-disklib-distrib \
            -io vddk-thumbprint=xx:xx:xx:... \
            "Windows 2003" \
            -o local -os <a href="file:/var/tmp">/var/tmp</a>

       Other  options that you might need to add in rare circumstances include <u>-io</u> <u>vddk-config</u>, <u>-io</u> <u>vddk-cookie</u>,
       <u>-io</u> <u>vddk-nfchostport</u>, <u>-io</u> <u>vddk-port</u>, <u>-io</u> <u>vddk-snapshot</u>, and <u>-io</u> <u>vddk-transports</u>, which are all  explained
       in the <b><a href="../man1/nbdkit-vddk-plugin.1.html">nbdkit-vddk-plugin</a></b>(1) documentation.  Do not use these options unless you know what you are doing.

   <b>VDDK:</b> <b>Debugging</b> <b>VDDK</b> <b>failures</b>
       The VDDK library can be operated in a verbose mode where it gives (very) verbose messages.  Use ‘virt-v2v
       -v -x’ as usual to enable verbose messages.

   <b>VDDK:</b> <b>Slow</b> <b>imports</b> <b>and</b> <b>repeated</b> <b>NBD_ClientOpen</b> <b>messages</b>
       If  imports  over  VDDK are slow, and ‘virt-v2v -v -x’ shows many "NBD_ClientOpen" messages, then you are
       hitting an apparent bug in VDDK 6.7 (https://bugzilla.redhat.com/1901489).  Upgrade to at least VDDK 7 to
       resolve the issue.

</pre><h4><b>INPUT</b> <b>FROM</b> <b>VMWARE</b> <b>OVA</b></h4><pre>
       Virt-v2v is able to import guests from VMware’s OVA (Open Virtualization  Appliance)  files.   Only  OVAs
       exported from VMware vSphere will work.

   <b>OVA:</b> <b>Create</b> <b>OVA</b>
       To  create an OVA in vSphere, use the "Export OVF Template" option (from the VM context menu, or from the
       File menu).  Either "Folder of files" (OVF) or "Single file" (OVA) will work, but OVA is probably  easier
       to  deal  with.   OVA  files are really just uncompressed tar files, so you can use commands like "tar tf
       VM.ova" to view their contents.

       <u>Create</u> <u>OVA</u> <u>with</u> <u>ovftool</u>

       You can also use VMware’s proprietary "ovftool":

        ovftool --noSSLVerify \
          vi://USER:<a href="mailto:PASSWORD@esxi.example.com">PASSWORD@esxi.example.com</a>/VM \
          VM.ova

       To connect to vCenter:

        ovftool  --noSSLVerify \
          vi://USER:<a href="mailto:PASSWORD@vcenter.example.com">PASSWORD@vcenter.example.com</a>/DATACENTER-NAME/vm/VM \
          VM.ova

       For Active Directory-aware authentication using down-level  logon  names  ("DOMAIN\USER"),  you  have  to
       express the "\" character in the form of its ascii hex-code (%5c):

        vi://DOMAIN%5cUSER:PASSWORD@...

   <b>OVA:</b> <b>Importing</b> <b>a</b> <b>guest</b>
       To import an OVA file called <u>VM.ova</u>, do:

        $ virt-v2v -i ova VM.ova -o local -os <a href="file:/var/tmp">/var/tmp</a>

       If  you  exported the guest as a "Folder of files", <u>or</u> if you unpacked the OVA tarball yourself, then you
       can point virt-v2v at the directory containing the files:

        $ virt-v2v -i ova /path/to/files -o local -os <a href="file:/var/tmp">/var/tmp</a>

   <b>OVA:</b> <b>Permissions</b> <b>issues</b> <b>with</b> <b>oVirt/RHV</b> <b>import</b>
       oVirt/RHV provides a graphical user interface for importing from OVA files which uses  this  method.   It
       requires that RHV is able to access the OVA file which can be a problem if the file is owned by root (RHV
       runs as a non-root user).

       The  suggested  workaround  is  to  copy  the OVA to a public directory such as <u><a href="file:/var/tmp">/var/tmp</a></u> before doing the
       import and perhaps change the user and group ownership of the file.

       For more information see these links:

       •   https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/virtual_machine_management_guide/index#Importing_a_virtual_machine_from_a_host

       •   https://bugzilla.redhat.com/show_bug.cgi?id=2039597

</pre><h4><b>INPUT</b> <b>FROM</b> <b>VMWARE</b> <b>VCENTER</b> <b>SERVER</b></h4><pre>
       Virt-v2v is able to import guests from VMware vCenter Server.

       vCenter ≥ 5.0 is required.  If you don’t have vCenter, using OVA  or  VMX  is  recommended  instead  (see
       "INPUT FROM VMWARE OVA" and/or "INPUT FROM VMWARE VMX").

       Virt-v2v  uses libvirt for access to vCenter, and therefore the input mode should be <u>-i</u> <u>libvirt</u>.  As this
       is the default, you don't need to specify it on the command line.

   <b>vCenter:</b> <b>URI</b>
       The libvirt URI of a vCenter server looks something like this:

        vpx://user@server/Datacenter/esxi

       where:

       "user@"
           is the (optional, but recommended) user to connect as.

           If the username contains a backslash (eg. "DOMAIN\USER")  then  you  will  need  to  URI-escape  that
           character  using  %5c:  "DOMAIN%5cUSER"  (5c  is  the  hexadecimal  ASCII code for backslash.)  Other
           punctuation may also have to be escaped.

           The user's password must be supplied in a local file using the separate <u>-ip</u> parameter.

       "server"
           is the vCenter Server (<u>not</u> hypervisor).

       "Datacenter"
           is the name of the datacenter.

           If the name contains a space, replace it with the URI-escape code %20.

       "esxi"
           is the name of the ESXi hypervisor running the guest.

       If the VMware deployment is using folders, then these may need to be added to the URI, eg:

        vpx://user@server/Folder/Datacenter/esxi

       For full details of libvirt URIs, see: <a href="http://libvirt.org/drvesx.html">http://libvirt.org/drvesx.html</a>

       Typical errors from libvirt / virsh when the URI is wrong include:

       •   Could not find datacenter specified in [...]

       •   Could not find compute resource specified in [...]

       •   Path [...] does not specify a compute resource

       •   Path [...] does not specify a host system

       •   Could not find host system specified in [...]

   <b>vCenter:</b> <b>Test</b> <b>libvirt</b> <b>connection</b> <b>to</b> <b>vCenter</b>
       Use the <b><a href="../man1/virsh.1.html">virsh</a></b>(1) command to list the guests on the vCenter Server like this:

        $ virsh -c 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi' list --all
        Enter root's password for vcenter.example.com: ***

         Id    Name                           State
        ----------------------------------------------------
         -     Fedora 20                      shut off
         -     Windows 2003                   shut off

       If you get an error "Peer certificate cannot be authenticated with given  CA  certificates"  or  similar,
       then you can either import the vCenter host’s certificate, or bypass signature verification by adding the
       "?no_verify=1" flag:

        $ virsh -c 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi?no_verify=1' list --all

       You should also try dumping the metadata from any guest on your server, like this:

        $ virsh -c 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi' dumpxml "Windows 2003"
        &lt;domain type='vmware'&gt;
          &lt;name&gt;Windows 2003&lt;/name&gt;
          [...]
        &lt;/domain&gt;

       <b>If</b>  <b>the</b>  <b>above</b>  <b>commands</b>  <b>do</b>  <b>not</b>  <b>work,</b>  <b>then</b>  <b>virt-v2v</b>  <b>is</b>  <b>not</b> <b>going</b> <b>to</b> <b>work</b> <b>either</b>.  Fix your libvirt
       configuration and/or your VMware vCenter Server before continuing.

   <b>vCenter:</b> <b>Supplying</b> <b>the</b> <b>password</b>
       The vCenter password (usually for the root account, or the account specified by "user@" in the  vpx  URL)
       has to be written to a local file, and the name of that file specified on the virt-v2v command line using
       <u>-ip</u> <u>passwordfile</u>.

   <b>vCenter:</b> <b>Importing</b> <b>a</b> <b>guest</b>
       To import a particular guest from vCenter Server, do:

        $ virt-v2v -ic 'vpx://<a href="mailto:root@vcenter.example.com">root@vcenter.example.com</a>/Datacenter/esxi?no_verify=1' \
          -ip passwordfile \
          "Windows 2003" \
          -o local -os <a href="file:/var/tmp">/var/tmp</a>

       where "Windows 2003" is the name of the guest (which must be shut down).

       In  this  case  the output flags are set to write the converted guest to a temporary directory as this is
       just an example, but you can also write to libvirt or any other supported target.

   <b>vCenter:</b> <b>Non-administrator</b> <b>role</b>
       Instead of using the vCenter Administrator role, you  can  create  a  custom  non-administrator  role  to
       perform  the  conversion.   You  will  however  need  enable the following permissions (or as many as are
       available, older versions of VMware were missing some of these settings):

       1.  Create a custom role in vCenter.

       2.  Enable (check) the following objects:

            Datastore:
             - Browse datastore
             - Low level file operations

            Sessions:
             - Validate session

            Virtual Machine:
              Interaction:
                - Guest operating system management by VIX API
              Provisioning:
                - Allow disk access
                - Allow read-only disk access
                - Allow virtual machine download

            Cryptographic operations:
             - Decrypt
             - Direct Access

   <b>vCenter:</b> <b>Firewall</b> <b>and</b> <b>proxy</b> <b>settings</b>
       <u>vCenter:</u> <u>Ports</u>

       If there is a firewall between the virt-v2v conversion server and the vCenter server, then you will  need
       to open port 443 (https) and port 5480.

       Port 443 is used to copy the guest disk image(s).  Port 5480 is used to query vCenter for guest metadata.

       These  port  numbers  are  only  the  defaults.   It is possible to reconfigure vCenter to use other port
       numbers.  In that case you would need to specify those ports in the "vpx://"  URI.   See  "vCenter:  URI"
       above.

       These  ports  only  apply  to  virt-v2v  conversions.  You may have to open other ports for other vCenter
       functionality, for example the web user interface.  VMware documents the required ports  for  vCenter  in
       their online documentation.

        ┌────────────┐   port 443 ┌────────────┐        ┌────────────┐
        │ virt-v2v   │────────────▶ vCenter    │────────▶ ESXi       │
        │ conversion │────────────▶ server     │        │ hypervisor │
        │ server     │  port 5480 │            │        │   ┌─────┐  │
        └────────────┘            └────────────┘        │   │guest│  │
                                                        └───┴─────┴──┘

       (In  the  diagram  above  the  arrows  show  the  direction in which the TCP connection is initiated, <u>not</u>
       necessarily the direction of data transfer.)

       Virt-v2v itself does not connect directly to the ESXi hypervisor containing the guest.   However  vCenter
       connects  to  the  hypervisor and forwards the information, so if you have a firewall between vCenter and
       its hypervisors you may need to open additional ports (consult VMware documentation).

       The proxy environment variables ("https_proxy", "all_proxy", "no_proxy", "HTTPS_PROXY",  "ALL_PROXY"  and
       "NO_PROXY") are <b>ignored</b> when doing vCenter conversions.

   <b>vCenter:</b> <b>SSL/TLS</b> <b>certificate</b> <b>problems</b>
       You may see this error:

         CURL: Error opening file: SSL: no alternative certificate subject
         name matches target host name

       (You may need to enable debugging with ‘virt-v2v -v -x’ to see this message).

       This  can  be caused by using an IP address instead of the fully-qualified DNS domain name of the vCenter
       server, ie.  use "vpx://vcenter.example.com/..." instead of "vpx://11.22.33.44/..."

       Another certificate problem can be caused by the vCenter server having a mismatching FQDN and IP address,
       for example if the server acquired a new IP address from DHCP.  To fix this you need to change your  DHCP
       server  or  network configuration so that the vCenter server always gets a stable IP address.  After that
       log in to the vCenter server’s admin console at "https://vcenter:5480/".  Under the "Admin"  tab,  select
       "Certificate regeneration enabled" and then reboot it.

   <b>vCenter:</b> <b>"Out</b> <b>of</b> <b>HTTP</b> <b>sessions:</b> <b>Limited</b> <b>to</b> <b>..."</b>
       VMware  vCenter appears to limit HTTP sessions and in some circumstances virt-v2v may exceed this number.
       You can adjust or remove the limit by editing <u>/etc/vmware-vpx/vpxd.cfg</u> on the vCenter  server.   Increase
       the "&lt;maxSessionCount&gt;" field, or set it to 0 which makes it unlimited:

        &lt;soap&gt;
          &lt;maxSessionCount&gt;0&lt;/maxSessionCount&gt;
        &lt;/soap&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/virt-v2v.1.html">virt-v2v</a></b>(1).

</pre><h4><b>AUTHOR</b></h4><pre>
       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2009-2020 Red Hat Inc.

</pre><h4><b>LICENSE</b></h4><pre>
       This  program  is  free  software;  you  can  redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation; either version 2 of the License,  or
       (at your option) any later version.

       This  program  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General  Public
       License for more details.

       You  should have received a copy of the GNU General Public License along with this program; if not, write
       to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

</pre><h4><b>BUGS</b></h4><pre>
       To     get      a      list      of      bugs      against      libguestfs,      use      this      link:
       https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools

       To       report       a       new       bug       against       libguestfs,      use      this      link:
       https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools

       When reporting a bug, please supply:

       •   The version of libguestfs.

       •   Where you got libguestfs (eg. which Linux distro, compiled from source, etc)

       •   Describe the bug accurately and give a way to reproduce it.

       •   Run <b><a href="../man1/libguestfs-test-tool.1.html">libguestfs-test-tool</a></b>(1) and paste the <b>complete,</b> <b>unedited</b> output into the bug report.

virt-v2v-2.6.0                                     2024-11-30                           <u><a href="../man1/virt-v2v-input-vmware.1.html">virt-v2v-input-vmware</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>