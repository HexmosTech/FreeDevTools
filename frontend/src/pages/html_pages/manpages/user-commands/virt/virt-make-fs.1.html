<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>virt-make-fs - Make a filesystem from a tar archive or files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/guestfs-tools">guestfs-tools_1.52.2-4ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       virt-make-fs - Make a filesystem from a tar archive or files

</pre><h4><b>SYNOPSIS</b></h4><pre>
        virt-make-fs [--options] input.tar output.img

        virt-make-fs [--options] input.tar.gz output.img

        virt-make-fs [--options] directory output.img

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Virt-make-fs is a command line tool for creating a filesystem from a tar archive or some files in a
       directory.  It is similar to tools like <b><a href="../man1/mkisofs.1.html">mkisofs</a></b>(1), <b><a href="../man1/genisoimage.1.html">genisoimage</a></b>(1) and <b><a href="../man1/mksquashfs.1.html">mksquashfs</a></b>(1).  Unlike those
       tools, it can create common filesystem types like ext2/3 or NTFS, which can be useful if you want to
       attach these filesystems to existing virtual machines (eg. to import large amounts of read-only data to a
       VM).

       To create blank disks, use <b><a href="../man1/virt-format.1.html">virt-format</a></b>(1).  To create complex layouts, use <b><a href="../man1/guestfish.1.html">guestfish</a></b>(1).

       Basic usage is:

        virt-make-fs input output.img

       where "input" is either a directory containing files that you want to add, or a tar archive (either
       uncompressed tar or gzip-compressed tar); and <u>output.img</u> is a disk image.  The input type is detected
       automatically.  The output disk image defaults to a raw ext2 sparse image unless you specify extra flags
       (see "OPTIONS" below).

   <b>FILESYSTEM</b> <b>TYPE</b>
       The default filesystem type is "ext2".  Just about any filesystem type that libguestfs supports can be
       used (but <u>not</u> read-only formats like ISO9660).  Here are some of the more common choices:

       <u>ext3</u>
           Note that ext3 filesystems contain a journal, typically 1-32 MB in size.  If you are not going to use
           the filesystem in a way that requires the journal, then this is just wasted overhead.

       <u>ntfs</u> or <u>vfat</u>
           Useful if exporting data to a Windows guest.

       <u>minix</u>
           Lower overhead than "ext2", but certain limitations on filename length and total filesystem size.

       <u>EXAMPLE</u>

        virt-make-fs --type=minix input minixfs.img

   <b>TO</b> <b>PARTITION</b> <b>OR</b> <b>NOT</b> <b>TO</b> <b>PARTITION</b>
       Optionally virt-make-fs can add a partition table to the output disk.

       Adding  a  partition  can  make the disk image more compatible with certain virtualized operating systems
       which don't expect to see a filesystem directly located on a block device (Linux doesn't  care  and  will
       happily handle both types).

       On  the  other  hand,  if  you  have  a  partition  table  then  the output image is no longer a straight
       filesystem.  For example you  cannot  run  <b><a href="../man8/fsck.8.html">fsck</a></b>(8)  directly  on  a  partitioned  disk  image.   (However
       libguestfs tools such as <b><a href="../man1/guestfish.1.html">guestfish</a></b>(1) and <b><a href="../man1/virt-resize.1.html">virt-resize</a></b>(1) can still be used).

       <u>EXAMPLE</u>

       Add an MBR partition:

        virt-make-fs --partition -- input disk.img

       If  the  output  disk  image  could be terabyte-sized or larger, it's better to use an EFI/GPT-compatible
       partition table:

        virt-make-fs --partition=gpt --size=+4T --format=qcow2 input disk.img

   <b>EXTRA</b> <b>SPACE</b>
       Unlike formats such as tar and squashfs, a filesystem does not "just fit" the files that it contains, but
       might have extra space.  Depending on how you are going to use the output, you  might  think  this  extra
       space is wasted and want to minimize it, or you might want to leave space so that more files can be added
       later.   Virt-make-fs  defaults  to  minimizing the extra space, but you can use the <u>--size</u> flag to leave
       space in the filesystem if you want it.

       An alternative way to leave extra space but not make the output image any bigger is to use an alternative
       disk image format (instead of the default "raw"  format).   Using  <u>--format=qcow2</u>  will  use  the  native
       qemu/KVM  qcow2  image  format (check your hypervisor supports this before using it).  This allows you to
       choose a large <u>--size</u> but the extra space won't actually be allocated in the image until you try to store
       something in it.

       Don’t forget that you can also use local commands including <b><a href="../man8/resize2fs.8.html">resize2fs</a></b>(8)  and  <b><a href="../man1/virt-resize.1.html">virt-resize</a></b>(1)  to  resize
       existing filesystems, or rerun virt-make-fs to build another image from scratch.

       <u>EXAMPLE</u>

        virt-make-fs --format=qcow2 --size=+200M input output.img

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--help</b>
           Display brief help.

       <b>--blocksize=512</b>
       <b>--blocksize=4096</b>
           This parameter sets the sector size of the output disk image.

           The default is 512 bytes.

           See also "guestfs_add_drive_opts" in <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3).

       <b>--floppy</b>
           Create a virtual floppy disk.

           Currently  this  preselects  the  size  (1440K), partition type (MBR) and filesystem type (VFAT).  In
           future it may also choose the geometry.

       <b>--size=</b>N
       <b>--size=+</b>N
       <b>-s</b> N
       <b>-s</b> <b>+</b>N
           Use the <u>--size</u> (or <u>-s</u>) option to choose the size of the output image.

           If this option is <u>not</u> given, then the output image will be just  large  enough  to  contain  all  the
           files, with not much wasted space.

           To  choose  a  fixed  size  output disk, specify an absolute number followed by b/K/M/G/T/P/E to mean
           bytes, Kilobytes, Megabytes, Gigabytes, Terabytes, Petabytes or Exabytes.  This must be large  enough
           to contain all the input files, else you will get an error.

           To  leave  extra space, specify "+" (plus sign) and a number followed by b/K/M/G/T/P/E to mean bytes,
           Kilobytes, Megabytes, Gigabytes, Terabytes, Petabytes or Exabytes.  For example:  <u>--size=+200M</u>  means
           enough space for the input files, and (approximately) an extra 200 MB free space.

           Note  that  virt-make-fs  estimates free space, and therefore will not produce filesystems containing
           precisely the free space requested.  (It is much more  expensive  and  time-consuming  to  produce  a
           filesystem which has precisely the desired free space).

       <b>--format=</b>FMT
       <b>-F</b> FMT
           Choose the output disk image format.

           The default is "raw" (raw sparse disk image).

       <b>--type=</b>FS
       <b>-t</b> FS
           Choose the output filesystem type.

           The default is "ext2".

           Any filesystem which is supported read-write by libguestfs can be used here.

       <b>--label=</b>LABEL
           Set the filesystem label.

       <b>--partition</b>
       <b>--partition=</b>PARTTYPE
           If specified, this flag adds an MBR partition table to the output disk image.

           You can change the partition table type, eg. <u>--partition=gpt</u> for large disks.

           For MBR, virt-make-fs sets the partition type byte automatically.

       <b>-v</b>
       <b>--verbose</b>
           Enable debugging information.

       <b>-V</b>
       <b>--version</b>
           Display version number and exit.

       <b>-x</b>  Enable libguestfs trace.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/guestfish.1.html">guestfish</a></b>(1),  <b><a href="../man1/virt-format.1.html">virt-format</a></b>(1), <b><a href="../man1/virt-resize.1.html">virt-resize</a></b>(1), <b><a href="../man1/virt-tar-in.1.html">virt-tar-in</a></b>(1), <b><a href="../man1/mkisofs.1.html">mkisofs</a></b>(1), <b><a href="../man1/genisoimage.1.html">genisoimage</a></b>(1), <b><a href="../man1/mksquashfs.1.html">mksquashfs</a></b>(1),
       <b><a href="../man8/mke2fs.8.html">mke2fs</a></b>(8), <b><a href="../man8/resize2fs.8.html">resize2fs</a></b>(8), <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3), <a href="http://libguestfs.org/">http://libguestfs.org/</a>.

</pre><h4><b>AUTHOR</b></h4><pre>
       Richard W.M. Jones <a href="http://people.redhat.com/~rjones/">http://people.redhat.com/~rjones/</a>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2010-2023 Red Hat Inc.

</pre><h4><b>LICENSE</b></h4><pre>
       This program is free software; you can redistribute it and/or modify  it  under  the  terms  of  the  GNU
       General  Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This program is distributed in the hope that it will be useful, but WITHOUT ANY  WARRANTY;  without  even
       the  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with this program; if not,  write
       to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

</pre><h4><b>BUGS</b></h4><pre>
       To      get      a      list      of      bugs      against      libguestfs,      use      this     link:
       https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools

       To      report      a      new       bug       against       libguestfs,       use       this       link:
       https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools

       When reporting a bug, please supply:

       •   The version of libguestfs.

       •   Where you got libguestfs (eg. which Linux distro, compiled from source, etc)

       •   Describe the bug accurately and give a way to reproduce it.

       •   Run <b><a href="../man1/libguestfs-test-tool.1.html">libguestfs-test-tool</a></b>(1) and paste the <b>complete,</b> <b>unedited</b> output into the bug report.

guestfs-tools-1.52.2                               2025-02-04                                    <u><a href="../man1/virt-make-fs.1.html">virt-make-fs</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>