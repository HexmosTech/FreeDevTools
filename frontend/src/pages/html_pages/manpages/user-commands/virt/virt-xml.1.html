<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>virt-xml - Edit libvirt XML using command line options.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/virt-install">virt-install_5.0.0-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       virt-xml - Edit libvirt XML using command line options.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>virt-xml</b> DOMAIN XML-ACTION XML-OPTION [OUTPUT-OPTION] [MISC-OPTIONS] ...

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>virt-xml</b>  is  a  command  line  tool for editing libvirt XML using explicit command line options. See the
       EXAMPLES section at the end of this document to jump right in.

       Each <b>virt-xml</b> invocation requires 3 things: name of an existing domain to alter (or XML passed on stdin),
       an action to on the XML, and an XML change to make. actions are one of:

       • <b>--add-device</b>: Append a new device definition to the XML

       • <b>--remove-device</b>: Remove an existing device definition

       • <b>--edit</b>: Edit an existing XML block

       • <b>--build-xml</b>: Just build the requested XML block and print it. No domain or input are required here, but
         it's recommended to provide them, so virt-xml can fill in optimal defaults.

       An XML change is one instance of any of the XML options provided  by  virt-xml,  for  example  --disk  or
       --boot.

       <b>virt-xml</b>  only  allows one action and XML pair per invocation. If you need to make multiple edits, invoke
       the command multiple times.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-c</b> <b>--connect</b> <b>URI</b>
              Connect to a non-default hypervisor. See <a href="../man1/virt-install.1.html">virt-install</a>(1) for details

       <b>domain</b> domain is the name, UUID, or ID of the existing VM. This can be omitted if using  --build-xml,  or
              if XML is passed on stdin.

              When  a  domain is specified, the default output action is --define, even if the VM is running. To
              update the running VM configuration, add the --update option (but not all options/devices  support
              updating the running VM configuration).

              If XML is passed on stdin, the default output is --print-xml.

</pre><h4><b>XML</b> <b>ACTIONS</b></h4><pre>
       <b>--edit</b> <b>[EDIT-OPTIONS]</b>
              Edit the specified XML block. EDIT-OPTIONS tell <b>virt-xml</b> which block to edit. The type of XML that
              we  are  editing  is  decided  by  XML option that is passed to <b>virt-xml</b> . So if --disk is passed,
              EDIT-OPTIONS select which &lt;disk&gt; block to edit.

              Certain XML options only ever map to a single XML block, like --cpu, --security, --boot,  --clock,
              and a few others. In those cases, <b>virt-xml</b> will not complain if a corresponding XML block does not
              already exist, it will create it for you.

              Most  XML  options  support  a  special  value  'clearxml=yes'. When combined with --edit, it will
              completely blank out the XML block being edited before applying the requested changes. This allows
              completely rebuilding an XML block. See EXAMPLES for some usage.

              EDIT-OPTIONS examples:

              •

                <b>--edit</b> --edit  without  any  options  implies  'edit  the  first  block'.  So   '--edit   --disk
                       DISK-OPTIONS' means 'edit the first &lt;disk&gt;'.

                       For  the  single XML block options mentioned above, plain '--edit' without any options is
                       what you always want to use.

              •

                <b>--edit</b> <b>#</b>
                       Select the specified XML block number. So '--edit 2 --disk  DISK-OPTS'  means  'edit  the
                       second &lt;disk&gt;'. This option only really applies for device XML.

              •

                <b>--edit</b> <b>all</b>
                       Modify  every  XML  block  of the XML option type. So '--edit all --disk DISK-OPTS' means
                       'edit ever &lt;disk&gt; block'.  This option only really applies for device XML.

              •

                <b>--edit</b> <b>DEVICE-OPTIONS</b>
                       Modify every XML block that matches the passed device options.  The device options are in
                       the same format as would be passed to the XML option.

              So <u>--edit</u> <u>path=/tmp/foo</u> <u>--disk</u> <u>DISK-OPTS</u> means 'edit every &lt;disk&gt; with path /tmp/foo'. This option
              only really applies for device XML.

       <b>--add-device</b>
              Append the specified XML  options  to  the  XML  &lt;devices&gt;  list.  Example:  '--add-device  --disk
              DISK-OPTIONS' will create a new &lt;disk&gt; block and add it to the XML.

              This option will error if specified with a non-device XML option (see --edit section for a partial
              list).

       <b>--remove-device</b>
              Remove  the specified device from the XML. The device to remove is chosen by the XML option, which
              takes arguments in the same format as --edit.  Examples:

              •

                <b>--remove-device</b> <b>--disk</b> <b>2</b>
                       Remove the second disk device

              •

                <b>--remove-device</b> <b>--network</b> <b>all</b>
                       Remove all network devices

              •

                <b>--remove-device</b> <b>--sound</b> <b>pcspk</b>
                       Remove all sound devices with model='pcspk'

              This option will error if specified with a non-device  XML  option  (see  --edit  isection  for  a
              partial list).

       <b>--build-xml</b>
              Just  build  the  specified XML, and print it to stdout. No input domain or input XML is required.
              Example: '--build-xml --disk DISK-OPTIONS' will just print the new &lt;disk&gt; device.

              However if the generated XML is targeted for a specific domain, it's recommended  to  pass  it  to
              virt-xml, so the tool can set optimal defaults.

              This option will error if specified with an XML option that does not map cleanly to a specific XML
              block, like --vcpus or --memory.

</pre><h4><b>OUTPUT</b> <b>OPTIONS</b></h4><pre>
       These  options decide what action to take after altering the XML. In the common case these do not need to
       be specified, as 'XML actions' will imply a default output action, described in detail above.  These  are
       only needed if you want to modify the default output.

       <b>--update</b>
              If  the  specified  domain  is running, attempt to alter the running VM configuration. If combined
              with --edit, this is an update operation. If combined with --add-device, this is a device hotplug.
              If combined with --remove-device, this is a device hotunplug.

              Keep in mind, most XML properties and devices do not support  live  update  operations,  so  don't
              expect it to succeed in all cases.

              By default this also implies <b>--define</b>.

       <b>--define</b>
              Define  the  requested XML change. This is typically the default if no output option is specified,
              but if a --print option is specified, --define is required to force the change.

       <b>--no-define</b>
              Explicitly do not define the XML. For example if you only want to alter the runtime state of a VM,
              combine this with <b>--update</b>.

       <b>--start</b>
              Start the VM after performing the requested changes.  If  combined  with  --no-define,  this  will
              create transient VM boot with the requested changes.

       <b>--print-diff</b>
              Print  the  generated  XML change in unified diff format. If only this output option is specified,
              all other output options are disabled and no persistent change is made.

       <b>--print-xml</b>
              Print the generated XML in its entirety. If only this output option is specified, all other output
              options are disabled and no persistent change is made.

       <b>--confirm</b>
              Before defining or updating the domain, show the generated  XML  diff  and  interactively  request
              confirmation.

</pre><h4><b>GUEST</b> <b>OS</b> <b>OPTIONS</b></h4><pre>
       <b>--os-variant,</b> <b>--osinfo</b> <b>OS_VARIANT</b>
              Optimize  the  guest  configuration  for  a  specific  operating system (ex.  'fedora29', 'rhel7',
              'win10'). While not required, specifying this options is HIGHLY RECOMMENDED,  as  it  can  greatly
              increase performance by specifying virtio among other guest tweaks.

              If  the  guest  has  been  installed  using  virt-manager  version  2.0.0 or newer, providing this
              information should not be necessary, as the  OS  variant  will  have  been  stored  in  the  guest
              configuration during installation and virt-xml will retrieve it from there automatically.

              Use  the  command  <b>virt-xml</b>  <b>--osinfo</b>  <b>list</b>  to  get  the  list  of  the accepted OS variants. See
              <b>osinfo-query</b> <b>os</b> for even more output.

              See <a href="../man1/virt-install.1.html">virt-install</a>(1) documentation for more details about <b>--os-variant/--osinfo</b>

</pre><h4><b>CONVERSION</b> <b>OPTIONS</b></h4><pre>
   <b>--convert-to-q35</b>
       <b>Syntax:</b> <b>--convert-to-q35</b> [OPTIONS]

       Convert an existing VM config from PC/i440FX to Q35 machine type.  This largely consists of:

       • Convert device topology from PCI to PCIe

       • Convert any IDE storage to SATA

       You may need to make config changes inside the VM to handle this as well.  For example,  Windows  10  may
       not find the boot device after IDE to SATA conversion.  But booting into safe mode once may fix it.

       Sub options are:

       <b>num_pcie_root_ports=NUM</b>
              Control the number of default <b>pcie-root-port</b> controller devices we add to the VM by default.

   <b>--convert-to-vnc</b>
       <b>Syntax:</b> <b>--convert-to-vnc</b> [OPTIONS]

       Convert an existing VM to exclusively use a single VNC graphics device.

       It will attempt to remove all references to any non-VNC graphics config, like Spice. For example:

       • <b>qxl</b> devices will be replaced

       • all <b>spicevmc</b> and <b>spiceport</b> devices will be removed

       • spice GL will be converted to <b>egl-headless</b>

       Sub options are:

       <b>qemu-vdagent=on|off</b>
              Add  a  <b>qemu-vdagent</b> device if one is not already configured.  This replaces some functionality of
              the spice vdagent.  This defaults to <b>off</b> but that could change in the future.

</pre><h4><b>XML</b> <b>OPTIONS</b></h4><pre>
       • <b>--disk</b>

       • <b>--network</b>

       • <b>--graphics</b>

       • <b>--metadata</b>

       • <b>--memory</b>

       • <b>--vcpus</b>

       • <b>--cpu</b>

       • <b>--iothreads</b>

       • <b>--seclabel</b>

       • <b>--keywrap</b>

       • <b>--cputune</b>

       • <b>--numatune</b>

       • <b>--memtune</b>

       • <b>--blkiotune</b>

       • <b>--memorybacking</b>

       • <b>--features</b>

       • <b>--clock</b>

       • <b>--pm</b>

       • <b>--events</b>

       • <b>--resources</b>

       • <b>--sysinfo</b>

       • <b>--xml</b>

       • <b>--qemu-commandline</b>

       • <b>--launchSecurity</b>

       • <b>--boot</b>

       • <b>--idmap</b>

       • <b>--controller</b>

       • <b>--input</b>

       • <b>--serial</b>

       • <b>--parallel</b>

       • <b>--channel</b>

       • <b>--console</b>

       • <b>--hostdev</b>

       • <b>--filesystem</b>

       • <b>--sound</b>

       • <b>--audio</b>

       • <b>--watchdog</b>

       • <b>--video</b>

       • <b>--smartcard</b>

       • <b>--redirdev</b>

       • <b>--memballoon</b>

       • <b>--tpm</b>

       • <b>--rng</b>

       • <b>--panic</b>

       • <b>--shmem</b>

       • <b>--memdev</b>

       These options alter the XML for a single class of XML elements. More complete documentation is  found  in
       <a href="../man1/virt-install.1.html">virt-install</a>(1).

       Generally   these   options   map   pretty   straightforwardly   to   the   libvirt  XML,  documented  at
       &lt;https://libvirt.org/formatdomain.html&gt;

       Option   strings   are   in   the   format   of:   --option   opt=val,opt2=val2,...    example:    --disk
       path=/tmp/foo,shareable=on.  Properties  can  be  used  with  '--option opt=,', so to clear a disks cache
       setting you could use '--disk cache=,'

       For any option, use --option=? to see a  list  of  all  available  sub  options,  example:  --disk=?   or
       --boot=?

       --help output also lists a few general examples. See the EXAMPLES section below for some common examples.

       virt-xml specifically has some operations that don't really apply to virt-install Examples:

       <b>--boot</b> <b>refresh-machine-type=yes</b>
              Refresh the XML <b>&lt;os&gt;&lt;type</b> <b>machine=X&gt;&lt;/os&gt;</b> value to the latest one that qemu provides. For example,
              if  your  VM  has  a  machine  type  value <b>pc-q35-4.0</b>, this will reset the value to <b>q35</b>, and works
              similarly with other versioned machine types. Occasionally this is necessary to  get  enable  qemu
              bug fixes, or when qemu deprecates and removes old machine type values.

</pre><h4><b>MISCELLANEOUS</b> <b>OPTIONS</b></h4><pre>
       <b>-h,</b> <b>--help</b>
              Show the help message and exit

       <b>--version</b>
              Show program's version number and exit

       <b>-q,</b> <b>--quiet</b>
              Avoid verbose output.

       <b>-d,</b> <b>--debug</b>
              Print debugging information

</pre><h4><b>EXAMPLES</b></h4><pre>
       See a list of all suboptions that --disk and --network take

          # virt-xml --disk=? --network=?

       Change the &lt;description&gt; of domain 'EXAMPLE':

          # virt-xml EXAMPLE --edit --metadata description="my new description"

       # Enable the boot device menu for domain 'EXAMPLE':

          # virt-xml EXAMPLE --edit --boot menu=on

       Clear  the  previous  &lt;cpu&gt;  definition  of  domain 'winxp', change it to 'host-model', but interactively
       confirm the diff before saving:

          # virt-xml winxp --edit --cpu host-model,clearxml=yes --confirm

       Change the second sound card to model=ich6 on 'fedora19', but only output the diff:

          # virt-xml fedora19 --edit 2 --sound model=ich6 --print-diff

       Update the every graphics device password to 'foo' of the running VM 'rhel6':

          # virt-xml rhel6 --edit all --graphics password=foo --update

       Remove the disk path from disk device hdc:

          # virt-xml rhel6 --edit target=hdc --disk path=

       Change all disk devices of type 'disk' to use cache=none, using XML from stdin, printing the new  XML  to
       stdout.

          # cat &lt;xmlfile&gt; | virt-xml --edit device=disk --disk cache=none

       Change disk 'hda' IO to native and use startup policy as 'optional'.

          # virt-xml fedora20 --edit target=hda \
                     --disk io=native,startup_policy=optional

       Change all host devices to use driver_name=vfio for VM 'fedora20' on the remote connection

          # virt-xml --connect qemu+ssh://remotehost/system \
                     fedora20 --edit all --hostdev driver_name=vfio

       Hotplug host USB device 001.003 to running domain 'fedora19':

          # virt-xml fedora19 --update --add-device --hostdev 001.003

       Add a spicevmc channel to the domain 'winxp', that will be available after the next VM shutdown.

          # virt-xml winxp --add-device --channel spicevmc

       Create a 10G qcow2 disk image and attach it to 'fedora18' for the next VM startup:

          # virt-xml fedora18 --add-device \
            --disk /var/lib/libvirt/images/newimage.qcow2,format=qcow2,size=10

       Same  as above, but ensure the disk is attached to the most appropriate bus for the guest OS by providing
       information about it on the command line:

          # virt-xml fedora18 --osinfo fedora18 --add-device \
            --disk /var/lib/libvirt/images/newimage.qcow2,format=qcow2,size=10

       Hotunplug the disk vdb from the running domain 'rhel7':

          # virt-xml rhel7 --update --remove-device --disk target=vdb

       Remove all graphics devices from the VM 'rhel7' after the next shutdown:

          # virt-xml rhel7 --remove-device --graphics all

       Generate XML for a virtio console device and print it to stdout:

          # virt-xml --build-xml --console pty,target_type=virtio

       Add qemu command line passthrough:

          # virt-xml f25 --edit --confirm --qemu-commandline="-device FOO"

       Use boot device 'network' for a single transient boot:

          # virt-xml myvm --no-define --start --edit --boot network

</pre><h4><b>CAVEATS</b></h4><pre>
       Virtualization hosts supported by libvirt may not permit all changes that might seem possible. Some edits
       made to a VM's definition may be ignored. For instance, QEMU  does  not  allow  the  removal  of  certain
       devices once they've been defined.

</pre><h4><b>BUGS</b></h4><pre>
       Please see  &lt;https://virt-manager.org/bugs&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) Red Hat, Inc, and various contributors.  This is free software. You may redistribute copies
       of it under the terms of the GNU General Public License  &lt;https://www.gnu.org/licenses/gpl.html&gt; .  There
       is NO WARRANTY, to the extent permitted by law.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/virt-install.1.html">virt-install</a>(1), the project website  &lt;https://virt-manager.org&gt;

                                                                                                     <u><a href="../man1/VIRT-XML.1.html">VIRT-XML</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>