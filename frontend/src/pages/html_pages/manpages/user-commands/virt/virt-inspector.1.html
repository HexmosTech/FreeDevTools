<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>virt-inspector - Display operating system version and other information about a virtual machine</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/guestfs-tools">guestfs-tools_1.52.2-4ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       virt-inspector - Display operating system version and other information about a virtual machine

</pre><h4><b>SYNOPSIS</b></h4><pre>
        virt-inspector [--options] -d domname

        virt-inspector [--options] -a disk.img [-a disk.img ...]

       Old-style:

        virt-inspector domname

        virt-inspector disk.img [disk.img ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>virt-inspector</b> examines a virtual machine or disk image and tries to determine the version of the
       operating system and other information about the virtual machine.

       Virt-inspector produces XML output for feeding into other programs.

       In the normal usage, use "virt-inspector -d domname" where "domname" is the libvirt domain (see: "virsh
       list --all").

       You can also run virt-inspector directly on disk images from a single virtual machine.  Use
       "virt-inspector -a disk.img".  In rare cases a domain has several block devices, in which case you should
       list several <u>-a</u> options one after another, with the first corresponding to the guest’s <u>/dev/sda</u>, the
       second to the guest’s <u>/dev/sdb</u> and so on.

       You can also run virt-inspector on install disks, live CDs, bootable USB keys and similar.

       Virt-inspector can only inspect and report upon <u>one</u> <u>domain</u> <u>at</u> <u>a</u> <u>time</u>.  To inspect several virtual
       machines, you have to run virt-inspector several times (for example, from a shell script for-loop).

       Because virt-inspector needs direct access to guest images, it won’t normally work over remote libvirt
       connections.

       All of the information available from virt-inspector is also available through the core libguestfs
       inspection API (see "INSPECTION" in <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3)).  The same information can also be fetched using
       guestfish or via libguestfs bindings in many programming languages (see "GETTING INSPECTION DATA FROM THE
       LIBGUESTFS API").

       Additional information about bootloader, kernel and drivers inside a guest can be found using
       <b><a href="../man1/virt-drivers.1.html">virt-drivers</a></b>(1).

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--help</b>
           Display brief help.

       <b>-a</b> file
       <b>--add</b> file
           Add  <u>file</u>  which  should be a disk image from a virtual machine.  If the virtual machine has multiple
           block devices, you must supply all of them with separate <u>-a</u> options.

           The format of the disk image is auto-detected.  To override this and force a  particular  format  use
           the <u>--format=..</u> option.

       <b>-a</b> URI
       <b>--add</b> URI
           Add a remote disk.  See "ADDING REMOTE STORAGE" in <b><a href="../man1/guestfish.1.html">guestfish</a></b>(1).

       <b>--blocksize=512</b>
       <b>--blocksize=4096</b>
       <b>--blocksize</b>
           This  parameter  sets  the sector size of the disk image.  It affects all explicitly added subsequent
           disks after this parameter.  Using <u>--blocksize</u> with no argument switches the disk sector size to  the
           default value which is usually 512 bytes.  See also "guestfs_add_drive_opts" in <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3).

       <b>-c</b> URI
       <b>--connect</b> URI
           If  using  libvirt,  connect  to  the  given <u>URI</u>.  If omitted, then we connect to the default libvirt
           hypervisor.

           Libvirt is only used if you specify a "domname" on the command line.   If  you  specify  guest  block
           devices directly (<u>-a</u>), then libvirt is not used at all.

       <b>-d</b> guest
       <b>--domain</b> guest
           Add all the disks from the named libvirt guest.  Domain UUIDs can be used instead of names.

       <b>--echo-keys</b>
           When  prompting for keys and passphrases, virt-inspector normally turns echoing off so you cannot see
           what you are typing.  If you are not worried about Tempest attacks and there is no one  else  in  the
           room you can specify this flag to see what you are typing.

       <b>--format=raw|qcow2|..</b>
       <b>--format</b>
           Specify  the  format of disk images given on the command line.  If this is omitted then the format is
           autodetected from the content of the disk image.

           If disk images are requested from libvirt, then this program asks libvirt for this  information.   In
           this case, the value of the format parameter is ignored.

           If  working  with  untrusted  raw-format  guest  disk  images, you should ensure the format is always
           specified.

       <b>--key</b> SELECTOR
           Specify a key for LUKS, to automatically open a LUKS device when using the inspection.

           <b>--key</b> NAME<b>:key:</b>KEY_STRING
           <b>--key</b> UUID<b>:key:</b>KEY_STRING
           <b>--key</b> <b>all:key:</b>KEY_STRING
               "NAME" is the libguestfs device name (eg. "/dev/sda1").  "UUID" is the device UUID.  "all"  means
               try the key against any encrypted device.

               Use the specified "KEY_STRING" as passphrase.

           <b>--key</b> NAME<b>:file:</b>FILENAME
           <b>--key</b> UUID<b>:file:</b>FILENAME
           <b>--key</b> <b>all:file:</b>FILENAME
               Read the passphrase from <u>FILENAME</u>.

           <b>--key</b> NAME<b>:clevis</b>
           <b>--key</b> UUID<b>:clevis</b>
           <b>--key</b> <b>all:clevis</b>
               Attempt  passphrase-less unlocking for the device with Clevis, over the network.  Please refer to
               "ENCRYPTED DISKS" in <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3) for more information on network-bound disk encryption (NBDE).

               Note that if any such option is present on  the  command  line,  QEMU  user  networking  will  be
               automatically enabled for the libguestfs appliance.

       <b>--keys-from-stdin</b>
           Read  key  or  passphrase  parameters from stdin.  The default is to try to read passphrases from the
           user by opening <u>/dev/tty</u>.

           If there are multiple encrypted devices then you may need to supply multiple keys on stdin,  one  per
           line.

       <b>--no-applications</b>
           By  default  the  output of virt-inspector includes the list of all the applications installed in the
           guest, if available.

           Specify this option to disable this part of the resulting XML.

       <b>--no-icon</b>
           By default the output of virt-inspector includes the icon of the guest, if available (see "icon").

           Specify this option to disable this part of the resulting XML.

       <b>-v</b>
       <b>--verbose</b>
           Enable verbose messages for debugging.

       <b>-V</b>
       <b>--version</b>
           Display version number and exit.

       <b>-x</b>  Enable tracing of libguestfs API calls.

       <b>--xpath</b> query
           Perform an XPath query on the XML on stdin, and print the result  on  stdout.   In  this  mode  virt-
           inspector  simply  runs  an  XPath  query;  all  other inspection functions are disabled.  See "XPATH
           QUERIES" below for some examples.

</pre><h4><b>OLD-STYLE</b> <b>COMMAND</b> <b>LINE</b> <b>ARGUMENTS</b></h4><pre>
       Previous versions of virt-inspector allowed you to write either:

        virt-inspector disk.img [disk.img ...]

       or

        virt-inspector guestname

       whereas in this version you should use <u>-a</u> or <u>-d</u> respectively to avoid the confusing  case  where  a  disk
       image might have the same name as a guest.

       For compatibility the old style is still supported.

</pre><h4><b>XML</b> <b>FORMAT</b></h4><pre>
       The  virt-inspector  XML  is  described  precisely  in a RELAX NG schema file <u>virt-inspector.rng</u> which is
       supplied with libguestfs.  This section is just an overview.

       The top-level element is &lt;operatingsystems&gt;, and it contains one or more &lt;operatingsystem&gt; elements.  You
       would only see more than one &lt;operatingsystem&gt; element if the virtual machine  is  multi-boot,  which  is
       vanishingly rare in real world VMs.

   <b>&lt;operatingsystem&gt;</b>
       In  the  &lt;operatingsystem&gt;  tag  are  various  optional  fields  that  describe the operating system, its
       architecture, the descriptive "product name" string, the type of OS and so on, as in this example:

        &lt;operatingsystems&gt;
          &lt;operatingsystem&gt;
            &lt;root&gt;/dev/sda2&lt;<a href="file:/root">/root</a>&gt;
            &lt;name&gt;windows&lt;/name&gt;
            &lt;arch&gt;i386&lt;/arch&gt;
            &lt;distro&gt;windows&lt;/distro&gt;
            &lt;product_name&gt;Windows 7 Enterprise&lt;/product_name&gt;
            &lt;product_variant&gt;Client&lt;/product_variant&gt;
            &lt;major_version&gt;6&lt;/major_version&gt;
            &lt;minor_version&gt;1&lt;/minor_version&gt;
            &lt;windows_systemroot&gt;/Windows&lt;/windows_systemroot&gt;

       In brief, &lt;name&gt; is the class of operating system (something like "linux" or "windows"), &lt;distro&gt; is  the
       distribution  (eg.  "fedora" but many other distros are recognized) and &lt;arch&gt; is the guest architecture.
       The other fields are fairly self-explanatory, but because  these  fields  are  taken  directly  from  the
       libguestfs inspection API you can find precise information from "INSPECTION" in <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3).

       The &lt;root&gt; element is the root filesystem device, but from the point of view of libguestfs (block devices
       may have completely different names inside the VM itself).

   <b>&lt;mountpoints&gt;</b>
       Un*x-like  guests typically have multiple filesystems which are mounted at various mountpoints, and these
       are described in the &lt;mountpoints&gt; element which looks like this:

        &lt;operatingsystems&gt;
          &lt;operatingsystem&gt;
            ...
            &lt;mountpoints&gt;
              &lt;mountpoint dev="/dev/vg_f13x64/lv_root"&gt;/&lt;/mountpoint&gt;
              &lt;mountpoint dev="/dev/sda1"&gt;<a href="file:/boot">/boot</a>&lt;/mountpoint&gt;
            &lt;/mountpoints&gt;

       As with &lt;root&gt;, devices are from the point of view of libguestfs, and may have completely different names
       inside the guest.  Only mountable filesystems appear in this list, not things like swap devices.

   <b>&lt;filesystems&gt;</b>
       &lt;filesystems&gt; is like &lt;mountpoints&gt; but covers <u>all</u> filesystems belonging to the guest, including swap and
       empty partitions.  (In the rare case of a multi-boot guest, it covers filesystems belonging to this OS or
       shared with this OS and other OSes).

       You might see something like this:

        &lt;operatingsystems&gt;
          &lt;operatingsystem&gt;
            ...
            &lt;filesystems&gt;
              &lt;filesystem dev="/dev/vg_f13x64/lv_root"&gt;
                &lt;type&gt;ext4&lt;/type&gt;
                &lt;label&gt;Fedora-13-x86_64&lt;/label&gt;
                &lt;uuid&gt;e6a4db1e-15c2-477b-ac2a-699181c396aa&lt;/uuid&gt;
              &lt;/filesystem&gt;

       The optional elements within &lt;filesystem&gt; are the filesystem type, the label, and the UUID.

   <b>&lt;applications&gt;</b>
       The related elements &lt;package_format&gt;,  &lt;package_management&gt;  and  &lt;applications&gt;  describe  applications
       installed in the virtual machine.

       &lt;package_format&gt;,  if  present,  describes  the packaging system used.  Typical values would be "rpm" and
       "deb".

       &lt;package_management&gt;, if present, describes the package manager.  Typical values include "yum", "up2date"
       and "apt"

       &lt;applications&gt; lists the packages or applications installed.

        &lt;operatingsystems&gt;
          &lt;operatingsystem&gt;
            ...
            &lt;applications&gt;
              &lt;application&gt;
                &lt;name&gt;coreutils&lt;/name&gt;
                &lt;version&gt;8.5&lt;/version&gt;
                &lt;release&gt;1&lt;/release&gt;
              &lt;/application&gt;

       The version and release fields may not be available for some types guests.  Other  fields  are  possible,
       see "guestfs_inspect_list_applications" in <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3).

   <b>&lt;drive_mappings&gt;</b>
       For  operating systems like Windows which use drive letters, virt-inspector is able to find out how drive
       letters map to filesystems.

        &lt;operatingsystems&gt;
          &lt;operatingsystem&gt;
            ...
            &lt;drive_mappings&gt;
              &lt;drive_mapping name="C"&gt;/dev/sda2&lt;/drive_mapping&gt;
              &lt;drive_mapping name="E"&gt;/dev/sdb1&lt;/drive_mapping&gt;
            &lt;/drive_mappings&gt;

       In the example above, drive C maps to the filesystem on the second partition on the first disk, and drive
       E maps to the filesystem on the first partition on the second disk.

       Note that this only  covers  permanent  local  filesystem  mappings,  not  things  like  network  shares.
       Furthermore NTFS volume mount points may not be listed here.

   <b>&lt;icon&gt;</b>
       Virt-inspector  is  sometimes  able  to  extract  an icon or logo for the guest.  The icon is returned as
       base64-encoded PNG data.  Note that the icon can be very large and high quality.

        &lt;operatingsystems&gt;
          &lt;operatingsystem&gt;
            ...
            &lt;icon&gt;
              iVBORw0KGgoAAAANSUhEUgAAAGAAAABg[.......]
              [... many lines of base64 data ...]
            &lt;/icon&gt;

       To display the icon, you have to extract it and convert the base64 data back to a binary  file.   Use  an
       XPath  query  or simply an editor to extract the data, then use the coreutils <b><a href="../man1/base64.1.html">base64</a></b>(1) program to do the
       conversion back to a PNG file:

        base64 -i -d &lt; icon.data &gt; icon.png

</pre><h4><b>XPATH</b> <b>QUERIES</b></h4><pre>
       Virt-inspector includes built in support for running XPath  queries.   The  reason  for  including  XPath
       support  directly  in  virt-inspector  is simply that there are no good and widely available command line
       programs that can do XPath queries.  The only good one is <b><a href="../man1/xmlstarlet.1.html">xmlstarlet</a></b>(1) and that is not available on  Red
       Hat Enterprise Linux.

       To  perform  an XPath query, use the <u>--xpath</u> option.  Note that in this mode, virt-inspector simply reads
       XML from stdin and outputs the query result on stdout.  All other inspection  features  are  disabled  in
       this mode.

       For example:

        $ virt-inspector -d Guest | virt-inspector --xpath '//filesystems'
        &lt;filesystems&gt;
             &lt;filesystem dev="/dev/vg_f13x64/lv_root"&gt;
               &lt;type&gt;ext4&lt;/type&gt;
        [...]

        $ virt-inspector -d Guest | \
            virt-inspector --xpath "string(//filesystem[@dev='/dev/sda1']/type)"
        ext4

        $ virt-inspector -d Guest | \
            virt-inspector --xpath 'string(//icon)' | base64 -i -d | display -
        [displays the guest icon, if there is one]

</pre><h4><b>GETTING</b> <b>INSPECTION</b> <b>DATA</b> <b>FROM</b> <b>THE</b> <b>LIBGUESTFS</b> <b>API</b></h4><pre>
       In  early  versions  of libguestfs, virt-inspector was a large Perl script that contained many heuristics
       for inspecting guests.  This had several problems: in order to  do  inspection  from  other  tools  (like
       guestfish)  we  had  to  call  out  to this Perl script; and it privileged Perl over other languages that
       libguestfs supports.

       By libguestfs 1.8 we had rewritten the Perl code in C, and incorporated it all into the  core  libguestfs
       API  (<b><a href="../man3/guestfs.3.html">guestfs</a></b>(3)).   Now  virt-inspector  is  simply  a  thin  C program over the core C API.  All of the
       inspection information is available from all programming languages that  libguestfs  supports,  and  from
       guestfish.

       For a description of the C inspection API, read "INSPECTION" in <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3).

       For example code using the C inspection API, look for <u>inspect-vm.c</u> which ships with libguestfs.

       <u>inspect-vm.c</u>  has  also  been  translated  into  other languages.  For example, <u>inspect_vm.pl</u> is the Perl
       translation, and there are other translations for OCaml, Python, etc.  See "USING LIBGUESTFS  WITH  OTHER
       PROGRAMMING LANGUAGES" in <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3) for a list of man pages which contain this example code.

   <b>GETTING</b> <b>INSPECTION</b> <b>DATA</b> <b>FROM</b> <b>GUESTFISH</b>
       If  you use the guestfish <u>-i</u> option, then the main C inspection API "guestfs_inspect_os" in <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3) is
       called.  This is equivalent to the guestfish command "inspect-os".  You  can  also  call  this  guestfish
       command by hand.

       "inspect-os"  performs  inspection  on  the  current  disk image, returning the list of operating systems
       found.  Each OS is represented by its root filesystem device.  In the majority  of  cases,  this  command
       prints  nothing  (no OSes found), or a single root device, but beware that it can print multiple lines if
       there are multiple OSes or if there is an install CD attached to the guest.

        $ guestfish --ro -a F15x32.img
        &gt;&lt;fs&gt; run
        &gt;&lt;fs&gt; inspect-os
        /dev/vg_f15x32/lv_root

       Using the root device, you can fetch further information about the guest:

        &gt;&lt;fs&gt; inspect-get-type /dev/vg_f15x32/lv_root
        linux
        &gt;&lt;fs&gt; inspect-get-distro /dev/vg_f15x32/lv_root
        fedora
        &gt;&lt;fs&gt; inspect-get-major-version /dev/vg_f15x32/lv_root
        15
        &gt;&lt;fs&gt; inspect-get-product-name /dev/vg_f15x32/lv_root
        Fedora release 15 (Lovelock)

       Limitations of guestfish make it hard to assign the root device to a variable  (since  guestfish  doesn't
       have  variables), so if you want to do this reproducibly you are better off writing a script using one of
       the other languages that the libguestfs API supports.

       To list applications, you have to first mount up the disks:

        &gt;&lt;fs&gt; inspect-get-mountpoints /dev/vg_f15x32/lv_root
        /: /dev/vg_f15x32/lv_root
        <a href="file:/boot">/boot</a>: /dev/vda1
        &gt;&lt;fs&gt; mount-ro /dev/vg_f15x32/lv_root /
        &gt;&lt;fs&gt; mount-ro /dev/vda1 <a href="file:/boot">/boot</a>

       and then call the inspect-list-applications API:

        &gt;&lt;fs&gt; inspect-list-applications /dev/vg_f15x32/lv_root | head -28
        [0] = {
          app_name: ConsoleKit
          app_display_name:
          app_epoch: 0
          app_version: 0.4.5
          app_release: 1.fc15
          app_install_path:
          app_trans_path:
          app_publisher:
          app_url:
          app_source_package:
          app_summary:
          app_description:
        }
        [1] = {
          app_name: ConsoleKit-libs
          app_display_name:
          app_epoch: 0
          app_version: 0.4.5
          app_release: 1.fc15
          app_install_path:
          app_trans_path:
          app_publisher:
          app_url:
          app_source_package:
          app_summary:
          app_description:
        }

       To display an icon for the guest, note that filesystems must also be mounted as above.  You can then do:

        &gt;&lt;fs&gt; inspect-get-icon /dev/vg_f15x32/lv_root | display -

</pre><h4><b>OLD</b> <b>VERSIONS</b> <b>OF</b> <b>VIRT-INSPECTOR</b></h4><pre>
       As described above, early versions of libguestfs shipped with a different virt-inspector program  written
       in  Perl  (the current version is written in C).  The XML output of the Perl virt-inspector was different
       and it could also output in other formats like text.

       The old virt-inspector is no longer supported or shipped with libguestfs.

       To confuse matters further, in Red Hat Enterprise Linux 6 we ship two  versions  of  virt-inspector  with
       different names:

        virt-inspector     Old Perl version.
        virt-inspector2    New C version.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       This program returns 0 if successful, or non-zero if there was an error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3),   <b><a href="../man1/guestfish.1.html">guestfish</a></b>(1),   <a href="http://www.w3.org/TR/xpath/">http://www.w3.org/TR/xpath/</a>,   <b><a href="../man1/base64.1.html">base64</a></b>(1),  <b><a href="../man1/xmlstarlet.1.html">xmlstarlet</a></b>(1),  <b><a href="../man1/virt-drivers.1.html">virt-drivers</a></b>(1),
       <a href="http://libguestfs.org/">http://libguestfs.org/</a>.

</pre><h4><b>AUTHORS</b></h4><pre>
       •   Richard W.M. Jones <a href="http://people.redhat.com/~rjones/">http://people.redhat.com/~rjones/</a>

       •   Matthew Booth <a href="mailto:mbooth@redhat.com">mbooth@redhat.com</a>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2010-2023 Red Hat Inc.

</pre><h4><b>LICENSE</b></h4><pre>
       This program is free software; you can redistribute it and/or modify  it  under  the  terms  of  the  GNU
       General  Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This program is distributed in the hope that it will be useful, but WITHOUT ANY  WARRANTY;  without  even
       the  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with this program; if not,  write
       to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

</pre><h4><b>BUGS</b></h4><pre>
       To      get      a      list      of      bugs      against      libguestfs,      use      this     link:
       https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools

       To      report      a      new       bug       against       libguestfs,       use       this       link:
       https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools

       When reporting a bug, please supply:

       •   The version of libguestfs.

       •   Where you got libguestfs (eg. which Linux distro, compiled from source, etc)

       •   Describe the bug accurately and give a way to reproduce it.

       •   Run <b><a href="../man1/libguestfs-test-tool.1.html">libguestfs-test-tool</a></b>(1) and paste the <b>complete,</b> <b>unedited</b> output into the bug report.

guestfs-tools-1.52.2                               2025-02-04                                  <u><a href="../man1/virt-inspector.1.html">virt-inspector</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>