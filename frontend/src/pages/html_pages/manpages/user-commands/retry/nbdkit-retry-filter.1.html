<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbdkit-retry-filter - reopen connection on error</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nbdkit">nbdkit_1.42.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nbdkit-retry-filter - reopen connection on error

</pre><h4><b>SYNOPSIS</b></h4><pre>
        nbdkit --filter=retry PLUGIN [retries=N] [retry-delay=N]
                                     [retry-exponential=yes|no]
                                     [retry-readonly=yes|no]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       "nbdkit-retry-filter" is a filter that transparently reopens the plugin connection when an error is
       encountered.  It can be used to make long-running copy operations reliable in the presence of temporary
       network failures, without requiring any changes to the plugin or the NBD client.

       An alternative and more fine-grained filter is <b><a href="../man1/nbdkit-retry-request-filter.1.html">nbdkit-retry-request-filter</a></b>(1) which will retry only
       single requests that fail.

       Several optional parameters are available to control:

       •   how many times we retry,

       •   the delay between retries, and whether we wait longer each time (known as “exponential back-off”),

       •   if we reopen the plugin in read-only mode after the first failure.

       The  default  (with  no  parameters)  is  designed  to offer a happy medium between recovering from short
       temporary failures but not doing anything too bad when permanent or unrecoverable failures  happen.   The
       default  behaviour is: we retry 5 times with exponential back-off, waiting in total about 1 minute before
       we give up.

</pre><h4><b>EXAMPLE</b></h4><pre>
       In  this  example  we  copy  and  convert  a  large  file  using  <b><a href="../man1/nbdkit-ssh-plugin.1.html">nbdkit-ssh-plugin</a></b>(1),  <b><a href="../man1/qemu-img.1.html">qemu-img</a></b>(1)  and
       <b><a href="../man1/nbdkit-captive.1.html">nbdkit-captive</a></b>(1).

        nbdkit \
          ssh host=remote.example.com /var/tmp/test.iso \
          --filter=retry \
          --run 'qemu-img convert -p -f raw "$uri" -O qcow2 test.qcow2'

       Without  <u>--filter=retry</u>  a temporary failure would cause the copy to fail (for example, the remote host’s
       firewall is restarted causing the SSH connection to be dropped).  Adding this filter means that it may be
       possible to transparently recover.

</pre><h4><b>PARAMETERS</b></h4><pre>
       <b>retries=</b>N
           The number of times any single operation will be retried before we give up and  fail  the  operation.
           The default is 5.

       <b>retry-delay=</b>N
           The  number  of  seconds to wait before retrying.  The default is 2 seconds.  Any format supported by
           <b><a href="../man3/nbdkit_parse_delay.3.html">nbdkit_parse_delay</a></b>(3) is allowed here.

       <b>retry-exponential=yes</b>
           Use exponential back-off.  The retry delay is doubled between each retry.  This is the default.

       <b>retry-exponential=no</b>
           Do not use exponential back-off.  The retry delay is the same between each retry.

       <b>retry-readonly=yes</b>
           As soon as a failure occurs, switch the underlying plugin to read-only mode  for  the  rest  of  this
           connection.  (A new NBD client connection will still open the plugin in the original mode.)

       <b>retry-readonly=no</b>
           Do not change the read-write/read-only mode of the plugin when retrying.  This is the default.

</pre><h4><b>FILES</b></h4><pre>
       <u>$filterdir/nbdkit-retry-filter.so</u>
           The filter.

           Use "nbdkit --dump-config" to find the location of $filterdir.

</pre><h4><b>VERSION</b></h4><pre>
       "nbdkit-retry-filter" first appeared in nbdkit 1.16.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1),       <b><a href="../man3/nbdkit-filter.3.html">nbdkit-filter</a></b>(3),       <b><a href="../man1/nbdkit-readahead-filter.1.html">nbdkit-readahead-filter</a></b>(1),      <b><a href="../man1/nbdkit-retry-request-filter.1.html">nbdkit-retry-request-filter</a></b>(1),
       <b><a href="../man3/nbdkit_parse_delay.3.html">nbdkit_parse_delay</a></b>(3).

</pre><h4><b>AUTHORS</b></h4><pre>
       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       Redistribution and use in source and binary forms, with or without modification, are  permitted  provided
       that the following conditions are met:

       •   Redistributions  of  source  code must retain the above copyright notice, this list of conditions and
           the following disclaimer.

       •   Redistributions in binary form must reproduce the above copyright notice, this list of conditions and
           the following disclaimer in the documentation and/or other materials provided with the distribution.

       •   Neither the name of Red Hat nor the names of its contributors may  be  used  to  endorse  or  promote
           products derived from this software without specific prior written permission.

       THIS  SOFTWARE  IS  PROVIDED BY RED HAT AND CONTRIBUTORS ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
       INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND  FITNESS  FOR  A  PARTICULAR
       PURPOSE  ARE  DISCLAIMED.  IN  NO EVENT SHALL RED HAT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
       INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,  PROCUREMENT  OF
       SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
       ON  ANY  THEORY  OF  LIABILITY,  WHETHER  IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
       OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
       DAMAGE.

nbdkit-1.42.2                                      2025-04-02                             <u><a href="../man1/nbdkit-retry-filter.1.html">nbdkit-retry-filter</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>