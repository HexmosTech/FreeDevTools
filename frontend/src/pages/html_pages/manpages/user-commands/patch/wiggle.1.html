<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>wiggle - apply rejected patches and perform word-wise diffs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/wiggle">wiggle_1.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       wiggle - apply rejected patches and perform word-wise diffs

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>wiggle</b> <u>[function]</u> <u>[options]</u> <u>file</u> <u>[files]</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The main function of <u>wiggle</u> is to apply a patch to a file in a similar manner to the <b><a href="../man1/patch.1.html">patch</a></b>(1) program.

       The  distinctive  difference of <u>wiggle</u> is that it will attempt to apply a patch even if the "before" part
       of the patch doesn't match the target file perfectly.  This is achieved by breaking the  file  and  patch
       into  words  and  finding  the  best  alignment  of words in the file with words in the patch.  Once this
       alignment has been found, any differences (word-wise) in the patch are applied to the  file  as  best  as
       possible.

       Also, <u>wiggle</u> will (in some cases) detect changes that have already been applied, and will ignore them.

       <u>wiggle</u>  ensures  that  every  change in the patch is applied to the target file somehow.  If a particular
       change cannot be made in the file, the file is annotated to show where the change should  be  made  in  a
       similar way to the <b><a href="../man1/merge.1.html">merge</a></b>(1) program with the <b>-A</b> option.  Each annotation contains 3 components: a portion
       of  the original file where the change should be applied, a portion of the patch that couldn't be matched
       precisely in the file, and the text that should replace that portion of the patch.  These  are  separated
       by  lines containing precisely 7 identical characters, either '&lt;', '|', '=', or '&gt;', possibly followed by
       a descriptive word. So
            &lt;&lt;&lt;&lt;&lt;&lt;&lt; found
            Some portion of the original file
            ||||||| expected
            text to replace
            =======
            text to replace it with
            &gt;&gt;&gt;&gt;&gt;&gt;&gt; replacement
       indicates that "text to replace" should be replaced by "text to replace it with" somewhere in the portion
       of the original file.  However <u>wiggle</u> was not able to find a place to make this change.

       <u>wiggle</u> can also produce conflict reports showing only the words that are  involved  rather  than  showing
       whole lines.  In this case the output looks like:
            &lt;&lt;&lt;---original|||old===new---&gt;&gt;&gt;

       One  possible  usage  of  <u>wiggle</u> is to run <u>patch</u> to apply some patch, and to collect a list of rejects by
       monitoring the error messages from patch.  Then for each file for which a reject was found, run
            wiggle --replace originalfile originalfile.rej

       Finally each file must be examined to resolve any unresolved conflicts, and  to  make  sure  the  applied
       patch is semantically correct.

       Alternately, the original patch file can be fed to the <b>browse</b> mode as
            wiggle -B &lt; patchfile

       This  will  allow  the  changes and conflicts to be inspected and, to some extent, modified; and then the
       results can be saved.

   <b>OPTIONS</b>
       The following options are understood by <u>wiggle</u>.  Some of these  are  explained  in  more  detail  in  the
       following sections on MERGE, DIFF, EXTRACT, and BROWSE.

       <b>-m</b>, <b>--merge</b>
              Select the "merge" function.  This is the default function.

       <b>-d</b>, <b>--diff</b>
              Select the "diff" function.  This displays the differences between files.  This can be given after
              <b>--browse</b>  (see  below)  in  which  case  a  patch  or  diff of two files can be viewed without the
              originals.

       <b>-x</b>, <b>--extract</b>
              Select the "extract" function.  This extracts one branch of a patch or merge file.

       <b>-B</b>, <b>--browse</b>
              Select the "browse" function.  This is similar to  "merge"  (or  "diff")  only  with  a  different
              presentation.   Instead  of the result simply being sent to standard output, it is presented using
              an ncurses-based GUI so that each hunk of the patch can be examined to understand  what  conflicts
              where involved and what needed to be ignored in order of the patch to be wiggled in to place.

       <b>-w</b>, <b>--words</b>
              Request  that  all  operations  and  display  be  word  based.  This is the default for the "diff"
              function.

       <b>--non-space</b>
              Request that words be defined as sequences  of  non-white-space.   Without  this  flag  words  are
              sequences  of  alphanumerics  or  single  non-white-space  characters.   This  flag  is enabled by
              automatically enabled if <u>wiggle</u> needs to compare two files which both have more than 50,000 words.

       <b>-l</b>, <b>--lines</b>
              Request that all operations and display be line based.

       <b>-b</b>, <b>--ignore-blanks</b>
              De-emphasise white space (space, tab, and newline) is determining differences and changes.

              Normally white space is treated like a word which can be matched or changed by a patch.  When this
              flag is in force, white space serves only as a separator between other words and  is  not  matched
              itself.   The  effect  of  this  is  that  changes in the amount of white space are not treated as
              significant.

              To be precise, any white space is combined with the preceding word or,  in  the  case  of  leading
              space  on  a line, with the following word.  However it is not involved in any comparisons of that
              word.  If a patch deletes a word, the attached white space is deleted as well.  If a patch adds  a
              word, the attached white space is added as well.

              An  empty line, or one that contains only blanks, will be treated as a single word that will match
              any other blank line, no matter how many spaces it has.

              <b>-b</b> has no effect in <b>--line</b> mode.

       <b>-p</b>, <b>--patch</b>
              Treat the last named file as a patch instead of a file (with --diff) or a merge  (--extract).   In
              <u>merge</u> or <b>browse</b> mode, <b>-p</b> requires there be exactly one file which is a patch and which can contain
              patches  to multiple files.  The patches are merged into each file.  When used in <u>merge</u> mode, this
              usage requires  the  <b>--replace</b>  option  as  writing  lots  of  merged  files  to  standard-out  is
              impractical.

              When  processing  a multi-file patch, <b>-p</b> can be followed by a numeric argument indicating how many
              file name components should be stripped from files  named  in  the  patch  file.   If  no  numeric
              argument  is  given,  <u>wiggle</u> will deduce an appropriate number based what files are present in the
              filesystem.

       <b>-r</b>, <b>--replace</b>
              Normally the merged output is written to standard-output.  With <b>--replace</b>, the  original  file  is
              replaced  with  the  merge  output.   In  <b>browse</b>  mode,  this  instructs <u>wiggle</u> to always save the
              resulting merge when exiting.

       <b>--no-backup</b>
              Normally when an original file is replaced with the merged result, that file is renamed to have  a
              ".porig"  extension,  so  that  it is preserved.  If you don't want to keep the original, use this
              option to suppress the backup.

       <b>-o</b>, <b>--output=</b>
              Rather than writing the result to stdout or to replace the original file, this requests  that  the
              output  be written to the given file.  This is only meaningful with <b>--merge</b> or <b>--browse</b> when given
              a single merge to browse.

              This option overrides <b>-r</b>.

       <b>-R</b>, <b>--reverse</b>
              When used with the <b>diff</b> function, swap the files before calculating the  differences.   When  used
              with the <b>merge</b> or <b>browse</b> functions, <u>wiggle</u> attempts to revert changes rather than apply them.

       <b>--shortest</b>
              If  the  files  being  compared  are  large,  it  can take a long time to isolate the differences.
              Normally <u>wiggle</u> will give up on perfection if a step take more than 20msec.  To over-ride this and
              always find the shortest edit-distance between two files, use the <b>--shortest</b> option.

       <b>-i</b>, <b>--no-ignore</b>
              Normally wiggle will ignore changes in the patch which appear to already have been applied in  the
              original.  With this flag those changes are reported as conflicts rather than being ignored.

       <b>-W</b>, <b>--show-wiggles</b>
              When used with <b>--merge</b>, conflicts that can be wiggled into place are reported as conflicts with an
              extra  stanza  which  shows  what  the  result would be if this flag had not been used.  The extra
              stanza is introduce with a line containing 7 ampersand (<b>&amp;</b>) characters thus:
                   &lt;&lt;&lt;&lt;&lt;&lt;&lt; found
                   Some portion of the original file
                   ||||||| expected
                   text to replace
                   =======
                   text to replace it with
                   &amp;&amp;&amp;&amp;&amp;&amp;&amp; resolution
                   Text that would result from a successful wiggle
                   &gt;&gt;&gt;&gt;&gt;&gt;&gt; replacement

       <b>--report-wiggles</b>
              If a merge is successful in applying all changes, it will normally exit with a success status (0),
              only reporting failure (1) if a conflict occurred and was annotated.  With <b>--report-wiggles</b> <u>wiggle</u>
              will also report failure if any changes had to be wiggled in.  This can be useful when  <u>wiggle</u>  is
              used  for  automatic  merges as with <u>git</u>.  If any wiggles happen, <u>git</u> will report the failure, and
              the results can be examined to confirm they are acceptable.

       <b>-h</b>, <b>--help</b>
              Print a simple help message.  If given after one  of  the  function  selectors  (<b>--merge</b>,  <b>--diff</b>,
              <b>--extract</b>, <b>--browse</b>) help specific to that function is displayed.

       <b>-V</b>, <b>--version</b>
              Display the version number of <u>wiggle</u>.

       <b>-v</b>, <b>--verbose</b>
              Enable verbose mode.  Currently this makes no difference.

       <b>-q</b>, <b>--quiet</b>
              Enable  quiet  mode.   This  suppresses  the  message  from  the  merge  function  when  there are
              unresolvable conflicts.

   <b>WORDS</b>
       <u>wiggle</u> can divide a text into lines or words when performing it's tasks.  A line is simply  a  string  of
       characters  terminated  by  a  newline.   A  word  is either a maximal contiguous string of alphanumerics
       (including underscore), a maximal contiguous string of space or  tab  characters,  or  any  other  single
       character.

   <b>MERGE</b>
       The  merge  function  modifies  a  given text by finding all changes between two other texts and imposing
       those changes on the given text.

       Normally <u>wiggle</u> focuses on which words have changed so as to maximise the possibility of finding  a  good
       match  in  the  given  text  for the context of a given change.  However it can consider only whole lines
       instead.

       <u>wiggle</u> extracts the three texts that it needs from files listed on the command line.  Either 1, 2,  or  3
       files may be listed, and any one of them may be a lone hyphen signifying standard-input.

       If  one  file  is  given  and the <b>-p</b> option is not present, the file is treated as a <b>merge</b> file, i.e. the
       output of "merge -A" or "wiggle".  Such a file implicitly contains three streams and these are  extracted
       and compared.

       If  two  files are given, then the first simply contains the primary text, and the second is treated as a
       patch file (the output of "diff -u" or "diff -c", or a ".rej" file from <u>patch</u>) and the  two  other  texts
       are extracted from that.

       If  one  file  is  given  together with the <b>-p</b> option, the file is treated as a patch file containing the
       names of the files that it patches.  In this case multiple merge operations can happen and each takes one
       stream from a file named in the patch, and the other two from the patch itself.  The <b>--replace</b> option  is
       required and the results are written back to the target files.

       Finally  if  three files are listed, they are taken to contain the given text and the two other texts, in
       order.

       Normally the result of the merge is written to standard-output.  If the <b>-r</b> flag is given, the  output  is
       written to a file which replaces the original given file. In this case the original file will normally be
       renamed to have a <b>.porig</b> suffix (for "patched original" which makes sense if you first use <u>patch</u> to apply
       a  patch,  and  then  use  <u>wiggle</u> to wiggle the rejects in).  This can be suppressed with the <b>--no-backup</b>
       uption.

       Further if the <b>-o</b> option is given with a file name, the output will be written to  that  file.   In  this
       case no backup is created.

       If  no  errors occur (such as file access errors) <u>wiggle</u> will exit with a status of 0 if all changes were
       successfully merged, and with an exit status of 1 and a brief message if any changes could not  be  fully
       merged  and  were  instead inserted as annotations.  However if either <b>--report-wiggles</b> or <b>--show-wiggles</b>
       options were given, <u>wiggle</u> will also exist with status of 1 if any changes had  to  be  wiggled  in  even
       though this was successful.

       The merge function can operate in three different modes with respect to lines or words.

       With the <b>--lines</b> option, whole lines are compared and any conflicts are reported as whole lines that need
       to be replaced.

       With  the  <b>--words</b> option, individual words are compared and any conflicts are reported just covering the
       words affected.  This uses the  &lt;&lt;&lt;|||===&gt;&gt;&gt;  conflict format.

       Without either of these options, a hybrid approach is taken.  Individual words are compared  and  merged,
       but when a conflict is found the whole surrounding line is reported as being in conflict.

       <u>wiggle</u>  will ensure that every change between the two other texts is reflected in the result of the merge
       somehow.  There are four different ways that a change can be reflected.

       1      If a change converts <b>A</b> to <b>B</b> and <b>A</b> is found at a  suitable  place  in  the  original  file,  it  is
              replaced with <b>B</b>.  This includes the possibility that <b>B</b> is empty, but not that <b>A</b> is empty.

       2      If  a  change  is  found  which simply adds <b>B</b> and the text immediately preceding and following the
              insertion are found adjacent in the original file in a suitable place, then <b>B</b> is inserted  between
              those adjacent texts.

       3      If  a  change is found which changes <b>A</b> to <b>B</b> and this appears (based on context) to align with <b>B</b> in
              the original, then it is assumed that this change has already been  applied,  and  the  change  is
              ignored.   When  this  happens,  a  message reflecting the number of ignored changes is printed by
              <u>wiggle</u>.  This optimisation can be suppressed with the <b>-i</b> flag.

       4      If a change is found that does not fit any of the above possibilities, then a conflict is reported
              as described earlier.

   <b>DIFF</b>
       The diff function is provided primarily to allow inspection of  the  alignments  that  <u>wiggle</u>  calculated
       between texts and that it uses for performing a merge.

       The  output  of  the diff function is similar to the unified output of diff.  However while diff does not
       output long stretches of common text, <u>wiggle</u>'s diff mode outputs everything.

       When calculating a word-based  alignment  (the  default),  <u>wiggle</u>  may  need  to  show  these  word-based
       differences.   This  is  done  using  an  extension  to the unified-diff format.  If a line starts with a
       vertical bar, then it may contain sections surrounded by special multi-character brackets.  The  brackets
       "&lt;&lt;&lt;++" and "++&gt;&gt;&gt;" surround added text while "&lt;&lt;&lt;--" and "--&gt;&gt;&gt;" surround removed text.

       <u>wiggle</u> can be given the two texts to compare in one of three ways.

       If only one file is given, then it is treated as a patch and the two branches of that patch are compared.
       This effectively allows a patch to be refined from a line-based patch to a word-based patch.

       If two files are given, then they are normally assumed to be simple texts to be compared.

       If  two  files are given along with the --patch option, then the second file is assumed to be a patch and
       either the first (with -1) or the second (with -2) branch is extracted and compared with  text  found  in
       the first file.

       This  last  option  causes  <u>wiggle</u> to apply a "best-fit" algorithm for aligning patch hunks with the file
       before computing the differences.  This algorithm is used when merging a patch with a file, and its value
       can be seen by comparing the  difference  produced  this  way  with  the  difference  produced  by  first
       extracting  one  branch  of  a patch into a file, and then computing the difference of that file with the
       main file.

   <b>EXTRACT</b>
       The extract function of <u>wiggle</u> simply exposes the internal functionality for extracting one branch  of  a
       patch or a merge file.

       Precisely one file should be given, and it will be assumed to be a merge file unless <b>--patch</b> is given, in
       which case a patch is assumed.

       The choice of branch in made by providing one of <b>-1</b>, <b>-2</b>, or <b>-3</b> with obvious meanings.

   <b>BROWSE</b>
       The browse function of <u>wiggle</u> presents the result of a merge or (with <b>-d</b>) a diff in a text-based GUI that
       can be navigated using keystrokes similar to <u><a href="../man1/vi.1.html">vi</a></u>(1) or <u><a href="../man1/emacs.1.html">emacs</a></u>(1).

       The  browser  allows  each  of  the  two or  three streams to be viewed individually with colours used to
       highlight different sorts of text - green for added text, red for deleted text etc.  It can also show the
       patch by itself, the full result of the merge, or the merge and the patch side-by-side.

       The browser provides a number of context-sensitive help pages which can be accessed by typing '?'

       The top right of the GUI will report the type of text under the cursor, which is also  indicated  by  the
       colour  of the text.  Options are Unchanged, Changed, Unmatched, Extraneous, AlreadyApplied and Conflict.
       If the meanings of these are clear a little experimentations should help.

       A limited amount of editing is permitted while in <b>browse</b> mode.  Currently text that is  unwanted  can  be
       discarded  with  <b>x</b>.   This  will  convert  a Conflict or Change to Unchanged, and an Unmatched to Changed
       (which effectively changes it to the empty string).  Similarly a text can be marked  as  wanted  with  <b>c</b>.
       This will convert a Conflict or Extraneous to Changed.  Using the same key again will revert the change.

       Finally, the uppercase <b>X</b> will revert all changes on the current line.

       To  make  more sweeping changes you can use <b>v</b> which runs an editor, preferring <b>$VISUAL</b> or <b>$EDITOR</b> if they
       are set in the environment.

       If you make any changes, then wiggle will ask you if you want to save the changes, even if <b>--replace</b>  was
       not given.

</pre><h4><b>WARNING</b></h4><pre>
       Caution  should  always  be  exercised  when applying a rejected patch with <u>wiggle</u>.  When <u>patch</u> rejects a
       patch, it does so for a good reason.  Even though <u>wiggle</u> may be able to find a believable place to  apply
       each  textual change, there is no guarantee that the result is correct in any semantic sense.  The result
       should always be inspected to make sure it is correct.

</pre><h4><b>EXAMPLES</b></h4><pre>
         <b>wiggle</b> <b>--replace</b> <b>file</b> <b>file.rej</b>
       This is the normal usage of <u>wiggle</u> and will take any changes in <b>file.rej</b> that <u>patch</u> could not apply,  and
       merge them into <b>file</b>.

         <b>wiggle</b> <b>-dp1</b> <b>file</b> <b>file.rej</b>
       This  will  perform a word-wise comparison between the <b>file</b> and the <u>before</u> branch of the diff in <b>file.rej</b>
       and display the differences.  This allows you to see where a given patch would apply.

          <b>wiggle</b> <b>--merge</b> <b>--help</b>
       Get help about the merge function of <u>wiggle</u>.

          <b>wiggle</b> <b>--browse</b> <b>--patch</b> <b>update.patch</b>
       Parse the <b>update.patch</b> file for patches and present a list of patched  files  which  can  be  browsed  to
       examine each patch in detail.

       <u>wiggle</u>  can  be integrated with <u>git</u> so that it is used as the default merge tool and diff tool.  This can
       be achieved by adding the following lines to <b>.gitconfig</b> in the user's home directory.
           [merge "wiggle"]
                name = "Wiggle flexible merging"
                driver = wiggle -o %A %A %O %B
                recursive = binary
           [merge]
                tool = wiggle
           [mergetool "wiggle"]
                cmd = wiggle -B -o $MERGED $LOCAL $BASE $REMOTE
           [difftool "wiggle"]
                cmd = wiggle -Bd $LOCAL $REMOTE
       This will make <b>git</b> <b>mergetool</b> and <b>git</b> <b>difftool</b> use <u>wiggle</u>.

       If you want <u>git</u> to always use <u>wiggle</u> for merges (which may be dangerous), you can add
           * merge=wiggle
       to an appropriate <u>gitattributes</u> file such as <b>$HOME/.config/git/attributes</b>.

</pre><h4><b>QUOTE</b></h4><pre>
       The name of <u>wiggle</u> was inspired by the following quote.

       The problem I find is that I often want to take
         (file1+patch) -&gt; file2,
       when I don't have file1.  But merge tools want to take
         (file1|file2) -&gt; file3.
       I haven't seen a graphical tool which helps you to wiggle a patch
       into a file.
       -- Andrew Morton - 2002

</pre><h4><b>SHORTCOMINGS</b></h4><pre>
       -      <u>wiggle</u> cannot read the extended unified-diff output that it produces for --diff --words.

       -      <u>wiggle</u> cannot read the word-based merge format that it produces for --merge --words.

       -      <u>wiggle</u> does not understand unicode and so will treat all non-ASCII characters much the same as  it
              treats punctuation - it will treat each one as a separate word.  The browser will not display non-
              ASCII characters properly.

</pre><h4><b>AUTHOR</b></h4><pre>
       Neil  Brown  at Computer Science and Engineering at The University of New South Wales, Sydney, Australia;
       and later at SUSE, still in Sydney, Australia.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/patch.1.html">patch</a></u>(1), <u><a href="../man1/diff.1.html">diff</a></u>(1), <u><a href="../man1/merge.1.html">merge</a></u>(1), <u><a href="../man1/wdiff.1.html">wdiff</a></u>(1), <u><a href="../man1/diff3.1.html">diff3</a></u>(1), <u><a href="../man1/git-config.1.html">git-config</a></u>(1), <u><a href="../man5/gitattributes.5.html">gitattributes</a></u>(5).

v1.3                                                                                                   <u><a href="../man1/WIGGLE.1.html">WIGGLE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>