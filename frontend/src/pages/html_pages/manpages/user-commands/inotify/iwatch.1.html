<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iwatch - realtime filesystem monitoring program using inotify</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/iwatch">iwatch_0.2.2-11_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>iwatch</b> - realtime filesystem monitoring program using inotify

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>iwatch</b> [<b>-d</b>] [<b>-f</b> &lt;config file&gt;] [<b>-v</b>] [<b>-p</b> &lt;pid file&gt;]
       <b>iwatch</b> [<b>-c</b> <u>command</u>] [<b>-C</b> <u>charset</u>] [<b>-e</b> event[,event[,..]]] [<b>-h</b>|<b>--help</b>] [<b>-m</b> &lt;email address&gt;]
              [<b>-r</b>] [<b>-s</b> &lt;on|off&gt;] [<b>-t</b> &lt;filter string&gt;] [<b>-v</b>] [<b>--version</b>] [<b>-x</b> <u>exception</u>]
              [<b>-X</b> &lt;regex <u>string</u> <u>as</u> <u>exception</u>&gt;] &lt;target&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       inotify  (inode notify) is a Linux kernel subsystem that monitors events in filesystems and reports those
       events to applications in real time.

       inotify can be used to monitor individual files or directories. When a directory  is  monitored,  inotify
       will return events for the directory itself, and for files inside this directory. The inotify support was
       added to Linux Kernel 2.6.13.

       Do    not    forget    to    consider   directories   <u>as</u>   "special   files".   See   more   details   at
       <a href="http://www.tldp.org/LDP/intro-linux/html/sect_03_01.html">http://www.tldp.org/LDP/intro-linux/html/sect_03_01.html</a>

       iWatch is a Perl wrap to inotify to monitor changes in specific directories or files, sending  alarms  to
       the system administrator in real time. So, iWatch can do:

              •  Send notifications via email about changes.

              •  Take  programmable actions immediately, <u>as</u> emit alerts via XMPP messengers, WhatsApp or execute
                 a local program or script.

              •  Act <u>as</u> HIDS (Host-based Intrusion Detection System) or an integrity checker, complementing  the
                 local firewall systems.

       iWatch  can  run  <u>as</u> daemon, <u>as</u> well a simple <u>command</u>. The daemon mode uses a XML configuration file, and
       put a list of directories and files (targets) to monitor. The  <u>command</u>  line  mode  will  run  without  a
       configuration  file.  You  just need to put the necessary information (target to watch, email, <u>exception</u>,
       recursivity, events to monitor and <u>command</u> to execute) in the <u>command</u> line. The options  for  both  modes
       cannot be mixed together.

       In  the XML configuration file, each target can have its own email contact point. This contact point will
       get an email notification for any  changes  in  the  monitored  targets.  You  can  monitor  a  directory
       recursively,  and you can also setup a list of exceptions where you do not want to monitor directory/file
       inside a monitored directory. It is also possible to disable email  notification,  and  instead  setup  a
       <u>command</u> to be executed if an event occurs. Per default iWatch only monitor following events: close_write,
       create,  delete,  move,  delete_self and move_self. But you can specify any possible events, like access,
       attrib, modify or all_events. See the EVENTS section for more details.

       A good example of iWatch usage is to monitor the pages directory in webservers to notify, in  real  time,
       about  defacements  or  file  insertions.  Other  example  is  to synchronize configuration files between
       machines, when they are changed, <u>as</u> in DHCP servers acting in failover mode. You also use to  synchronize
       files, via rsync when these files are changed.

</pre><h4><b>OPTIONS</b></h4><pre>
       Usage for daemon mode (background) of iWatch:

              <b>-d</b>     Execute the application <u>as</u> daemon. iWatch will run in foreground without this option.

              <b>-f</b> <b>&lt;config_file.xml&gt;</b>
                     Specify alternative configuration file. Default is <a href="file:/etc/">/etc/</a><b>iwatch</b>/iwatch.xml.

              <b>-p</b> <b>&lt;pid_file&gt;</b>
                     Specify an alternate pid file. Default: /var/run/iwatch.pid.

              <b>-v</b>     Be verbose.

       Usage for <u>command</u> line mode (foreground) of iWatch:

              <b>-c</b> <b>&lt;</b><u>command</u><b>&gt;</b>
                     You  can  specify  a  <u>command</u>  to  be  executed  if  an event occurs. For details about the
                     available strings, take a look at STRINGS FOR COMMAND section.

              <b>-C</b> <b>&lt;</b><u>charset</u><b>&gt;</b>
                     Specify the <u>charset</u> (default is utf-8).

              <b>-e</b> <b>&lt;event[,event[,..]]&gt;</b>
                     Specify a list of events that you want to watch. For details about possible events, take  a
                     look at EVENTS section.

              <b>-h,</b> <b>--help</b>
                     Print help message.

              <b>-m</b> <b>&lt;email_address&gt;</b>
                     Contact  point's  email  address.  Without  this  option,  iWatch  will  not send any email
                     notification.

              <b>-r</b>     Recursivity when watching a directory.

              <b>-s</b> <b>on|off</b>
                     Enable or disable reports to the syslog (default is off/disabled).

              <b>-t</b> <b>&lt;filter&gt;</b>
                     Specify a filter <u>string</u> (regex) to compare with the filename or  directory  name.  It  will
                     report  events  only  if the file/directory name matches the filter <u>string</u>. It is useful if
                     you want watch a file like <a href="file:/etc/passwd">/etc/passwd</a> or /etc/shadow. Instead watching this  single  file,
                     just  watch  the  <a href="file:/etc">/etc</a> directory with filter="passwd|shadow", because if you watch only the
                     passwd/shadow file, the watcher will be deleted after one change of this file and you  will
                     not  get  another  notification.  This  is caused by the application that changes passwd or
                     shadow (e.g. passwd or chfn), they do not change the files directly, but create a new  file
                     and  move it to passwd or shadow file. So, this <u>command</u> will remove the inode and therefore
                     the watcher.

              <b>-v</b>     Verbose mode. This option will show the main current action.

              <b>--version</b>
                     Print the version number.

              <b>-x</b> <b>&lt;</b><u>exception</u> <b>file</b> <b>or</b> <b>directory&gt;</b>
                     Specify the file or directory which should not be watched.

              <b>-X</b> <b>&lt;regex</b> <u>string</u> <u>as</u> <u>exception</u><b>&gt;</b>
                     Similar to <b>-x</b> but specifying a regex <u>string</u> <u>as</u> <u>exception</u>.

</pre><h4><b>STRINGS</b> <b>FOR</b> <b>COMMANDS</b></h4><pre>
       When using the '<b>-c</b> &lt;<u>command</u>&gt;' option, these strings will be available:

       <b>%c</b>     Event cookie number.

       <b>%e</b>     Event name. (e.g.: IN_CLOSE_WRITE)

       <b>%f</b>     Full path of the filename that gets an event. (e.g.: /var/www/index.html)

       <b>%F</b>     The old filename in case moved_to event.

       <b>%p</b>     Program name, always "iWatch".

       <b>%v</b>     Version number. (e.g.: 0.2.2)

</pre><h4><b>EVENTS</b></h4><pre>
       Following are the possible events you can use with the '<b>-e</b>' option:

       <b>access</b> file/directory was accessed.

       <b>attrib</b> file/directory attributes changed.

       <b>close</b>  file/directory closed, regardless of read/write mode.

       <b>close_nowrite</b>
              file/directory closed, after being opened in read-only mode.

       <b>close_write</b>
              file/directory closed, after being opened in writable mode.

       <b>create</b> a file/directory was created within watched directory.

       <b>delete</b> a file/directory was deleted within watched directory.

       <b>delete_self</b>
              the watched file/directory was deleted.

       <b>ignored</b>
              file was ignored.

       <b>isdir</b>  event occurred against a directory.

       <b>modify</b> a file content was modified.

       <b>move</b>   a file/directory within watched directory was moved.

       <b>moved_from</b>
              a file was moved away from.

       <b>moved_to</b>
              a file was moved to.

       <b>oneshot</b>
              only send event once.

       <b>open</b>   a file/directory was opened.

       <b>q_overflow</b>
              event queued overflowed.

       <b>unmount</b>
              file system on which watched file exists was unmounted.

       <b>default</b>
              close_write, create, delete, move, delete_self and move_self.

       <b>all_events</b>
              all possible events.

</pre><h4><b>COMMAND</b> <b>LINE</b> <b>USAGE</b> <b>EXAMPLES</b></h4><pre>
       <b>$</b> <b>iwatch</b> <b><a href="file:/tmp">/tmp</a></b>
              Monitor changes in <a href="file:/tmp">/tmp</a> directory, using default events, without recursivity.

       <b>$</b> <b>iwatch</b> <b>-r</b> <b>-e</b> <b>access,create</b> <b>-m</b> <b><a href="mailto:root@example.com">root@example.com</a></b> <b>-x</b> <b>/etc/mail</b> <b><a href="file:/etc">/etc</a></b>
              Monitor only access and create events in <a href="file:/etc">/etc</a> directory, recursively, with /etc/mail <u>as</u> <u>exception</u>,
              and send email notification to <a href="mailto:root@example.com">root@example.com</a> if a listed event occurs.

       <b>$</b> <b>iwatch</b> <b>-r</b> <b>-c</b> <b>'(w;</b> <b>ps</b> <b>-aux)'</b> <b>|</b> <b>mail</b> <b>-s</b> <b>'%f</b> <b>was</b> <b>changed'</b> <b>root@localhost</b> <b><a href="file:/bin">/bin</a></b>
              Monitor <a href="file:/bin">/bin</a> directory, recursively, and execute the commands  'w'  and  'ps  <b>-aux</b>',  sending  the
              results to root@localhost, using '&lt;path_filename&gt; was changed' <u>as</u> subject.  To see about '%f' take
              a look at STRINGS FOR COMMANDS section.

       <b>$</b> <b>iwatch</b> <b>-r</b> <b>-X</b> <b>'.svn'</b> <b><a href="file:~/projects">~/projects</a></b>
              Monitor <a href="file:~/projects">~/projects</a> directory, recursively, but exclude any .svn directories inside. This cannot be
              done with a normal '<b>-x</b>' option since '<b>-x</b>' can only exclude the defined path.

</pre><h4><b>CONFIGURATION</b> <b>FILE</b> <b>EXAMPLE</b></h4><pre>
       The default configuration file is <a href="file:/etc/">/etc/</a><b>iwatch</b>/iwatch.xml. See an example:

           &lt;?xml version="1.0" ?&gt;
           &lt;!DOCTYPE config SYSTEM "/etc/iwatch/iwatch.dtd" &gt;

           &lt;config&gt;
            &lt;guard email="<a href="mailto:root@example.com">root@example.com</a>" name="iWatch"/&gt;
            &lt;watchlist&gt;
            &lt;title&gt;WEB server integrity monitoring&lt;/title&gt;
            &lt;contactpoint email="<a href="mailto:someone@example.com">someone@example.com</a>" name="Administrator"/&gt;
               &lt;path type="recursive" syslog="off" alert="off" exec="echo %p: %e %f | /usr/bin/sendxmpp -t <a href="mailto:foo@jabber-br.org">foo@jabber-br.org</a>"&gt;<a href="file:/var/www">/var/www</a>&lt;/path&gt;
               &lt;path type="exception"&gt;/var/www/counter&lt;/path&gt;
            &lt;/watchlist&gt;
           &lt;/config&gt;

       The two first lines will define the XML version and the file that defines the pattern used by iWatch (the
       default is <a href="file:/etc/">/etc/</a><b>iwatch</b>/iwatch.dtd). These lines needn't be changed.

       The  &lt;config&gt; statement is used to mark the configuration start point. The last line of the configuration
       must be &lt;/config&gt;. The 'guard email' line is used to specify the sender email and name to  be  used  when
       sending  notifications  by  email.  In  other  words,  this  line  defines  the  'From:' email field. The
       &lt;watchlist&gt;&lt;/watchlist&gt; delimits a block of definitions about a watch or some watches procedures.

       The &lt;config&gt;&lt;/config&gt;  place  can  have  several  &lt;watchlist&gt;&lt;/watchlist&gt;  blocks.  Inside  these  blocks
       (&lt;watchlist&gt;&lt;/watchlist&gt;),  the  &lt;title&gt;&lt;/title&gt;  space  is  used  to  add a title that will identify the
       purpose of the block. This field is a visual text to indicate what the block  does.  The  &lt;title&gt;&lt;/title&gt;
       does nothing. It is a tag for people reading the configuration file. The 'contactpoint' line contains the
       destination email address (To:) and name when sending notifications by email.

       Each &lt;path&gt;&lt;/path&gt; line can monitor a file/directory and execute actions. The first path line showed will
       monitor  recursively  the  directory  /var/www.  As no events was defined, iWatch will employ the default
       event (close_write, create, delete, move, delete_self and move_self events).  If  an  event  occurs,  the
       syslog  will  not  register it and a message reporting the program name (%p = iWatch), the event (%e) and
       the monitored file/directory name (%f) will be sent via XMPP  protocol  (sendxmpp  external  program)  to
       <a href="mailto:foo@jabber-br.org">foo@jabber-br.org</a>.  Note  that  alert="off"  will  disable any sending email. Other way to avoid an email
       message is drop the line "contactpoint". Another important point is that a second line is  excluding  the
       /var/www/counter file/directory from observation.

       The  showed  example uses the sendxmpp <u>command</u>. Other good possibility is to apply the yowsup-cli <u>command</u>
       to send WhatsApp messages.

       A new example. With configuration showed below, iWatch will work over three &lt;watchlist&gt; blocks.

           &lt;?xml version="1.0" ?&gt;
           &lt;!DOCTYPE config SYSTEM "iwatch.dtd"&gt;

           &lt;config&gt;
            &lt;guard email="admin@localhost" name="iWatch"&gt;&lt;/guard&gt;
            &lt;watchlist&gt;
            &lt;title&gt;Public Website&lt;/title&gt;
            &lt;contactpoint email="<a href="mailto:webmaster@example.com">webmaster@example.com</a>" name="WebMaster"/&gt;
               &lt;path type="single"&gt;/var/www/localhost/htdocs&lt;/path&gt;
               &lt;path type="recursive"&gt;/var/www/localhost/htdocs/Photos&lt;/path&gt;
            &lt;/watchlist&gt;
            &lt;watchlist&gt;
            &lt;title&gt;Operating System&lt;/title&gt;
            &lt;contactpoint email="admin@localhost" name="Administrator"/&gt;
               &lt;path type="recursive"&gt;/etc/apache2&lt;/path&gt;
               &lt;path type="recursive"&gt;/etc/mail&lt;/path&gt;
               &lt;path type="exception"&gt;/etc/mail/statistics&lt;/path&gt;
               &lt;path type="single" filter="shadow|passwd"&gt;<a href="file:/etc">/etc</a>&lt;/path&gt;
            &lt;/watchlist&gt;
            &lt;watchlist&gt;
            &lt;title&gt;Only a test&lt;/title&gt;
            &lt;contactpoint email="root@localhost" name="Administrator"/&gt;
                &lt;path type="single" alert="off" exec="(w;ps -aux) | mail -s %f root@localhost"&gt;/tmp/dir1&lt;/path&gt;
                &lt;path type="single" events="access,close" alert="off" exec="(w;ps -aux) | mail -s %f root@localhost"&gt;/tmp/dir2&lt;/path&gt;
                &lt;path type="single" events="default,access" alert="off" exec="(w;ps -aux) | mail -s '%f is accessed' root@localhost"&gt;/tmp/dir3&lt;/path&gt;
                &lt;path type="single" events="all_events"&gt;/tmp/dir4&lt;/path&gt;
            &lt;/watchlist&gt;
           &lt;/config&gt;

       The first &lt;watchlist&gt; block monitors a directory and has special actions for a  file  but  no  execute  a
       <u>command</u>  for  it.  The first path is a single (non recursive) directory /var/www/localhost/htdocs and any
       notification will be sent to the contact point <a href="mailto:webmaster@example.com">webmaster@example.com</a>. Note that have no events specified.
       So, the default events (close_write,

       <b>create,</b> <b>delete,</b> <b>move,</b> <b>delete_self</b>
              and  move_self)  will  be  used.  The  second  path  will  monitor,  recursively,  the   directory
              /var/www/localhost/htdocs/Photos  (also  inside  of  the  first directory). Default events will be
              notified via mail.

       The second block has four monitoring. All notification will be sent to admin@localhost. The main  novelty
       over  the  first block is that a path uses a 'filter' instruction to watch <a href="file:/etc/shadow">/etc/shadow</a> and <a href="file:/etc/passwd">/etc/passwd</a> at
       the same time. To understand better this situation, see the '<b>-t</b>' at OPTIONS section.

       The last block monitors default events in first line and several non  default  events  in  the  following
       three lines.  In several lines the 'alert' is defined <u>as</u> 'off'. So, iWatch will not send emails using the
       builtin  mail  engine.  However, in three lines the external <u>command</u> 'mail' was used to send personalized
       emails.

</pre><h4><b>LEARNING</b> <b>ABOUT</b> <b>EVENTS</b></h4><pre>
       A tip to learn about events is watch the iWatch  <u>command</u>  executing  with  '<b>-e</b>  all_events'  option.  The
       following example will monitor a 'ls <a href="file:/tmp">/tmp</a>' <u>command</u>.

           $ iwatch -e all_events <a href="file:/tmp">/tmp</a>
           [17/Jun/2014 11:22:59] IN_ISDIR,IN_OPEN <a href="file:/tmp">/tmp</a>
           [17/Jun/2014 11:22:59] IN_ISDIR,IN_CLOSE_NOWRITE <a href="file:/tmp">/tmp</a>

       Another example, that monitors the creating of a file inside <a href="file:/tmp">/tmp</a>:

           $ iwatch -e all_events <a href="file:/tmp">/tmp</a>
           [17/Jun/2014 11:29:43] IN_MODIFY /tmp/file.txt
           [17/Jun/2014 11:29:43] IN_OPEN /tmp/file.txt
           [17/Jun/2014 11:29:43] IN_MODIFY /tmp/file.txt
           [17/Jun/2014 11:29:43] IN_CLOSE_WRITE /tmp/file.txt
           [17/Jun/2014 11:29:43] * /tmp/file.txt is closed

       So, in the last example occurred modify, open and close_write actions.

</pre><h4><b>RULES</b> <b>VALIDATION</b></h4><pre>
       Since  version  0.2.0  iWatch  checks the validity of XML file if it has following entry in the first two
       lines:

           &lt;?xml version="1.0" ?&gt;
           &lt;!DOCTYPE config SYSTEM "iwatch.dtd"&gt;

       The check will be made over a pattern described by <a href="file:/etc/">/etc/</a><b>iwatch</b>/iwatch.dtd file. Without  the  showed  two
       lines,  iWatch  will just give a warning that you have to use DTD file, and it continues to run <u>as</u> normal
       without XML validation. The iWatch's XML format is very simple  and  easy  to  understand,  and  it  uses
       following DTD :

           &lt;!ELEMENT config (guard,watchlist+)&gt;
           &lt;!ATTLIST config
              charset CDATA "utf-8"
           &gt;
           &lt;!ELEMENT guard (#PCDATA)&gt;
           &lt;!ATTLIST guard
              email  CDATA #REQUIRED
              name   CDATA #IMPLIED
           &gt;
           &lt;!ELEMENT watchlist (title,contactpoint,path+)&gt;
           &lt;!ELEMENT title (#PCDATA)&gt;
           &lt;!ELEMENT contactpoint (#PCDATA)&gt;
           &lt;!ATTLIST contactpoint
              email  CDATA #REQUIRED
              name   CDATA #IMPLIED
           &gt;
           &lt;!ELEMENT path (#PCDATA)&gt;
           &lt;!ATTLIST path
              type   CDATA          #REQUIRED
              alert  (on|off) "off"
              events CDATA          #IMPLIED
              exec   CDATA          #IMPLIED
              filter CDATA          #IMPLIED
              syslog (on|off) "off"

</pre><h4><b>CAVEATS</b></h4><pre>
       On Debian systems, when running <b>iwatch</b> <u>as</u> a daemon via systemd, it will work under the root user. Be sure
       that  your  system is ready to make all things via root user. E.g. if you are using sendxmpp <u>command</u>, you
       will need a .sendxmpprc file under the <a href="file:/root/">/root/</a> directory.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/inotify.7.html">inotify</a></b>(7), <b><a href="../man1/sendxmpp.1.html">sendxmpp</a></b>(1), <b><a href="../man1/yowsup-cli.1.html">yowsup-cli</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
       iWatch was written by Cahya Wirawan &lt;<a href="mailto:cahya@gmx.at">cahya@gmx.at</a>&gt;.

       This manual page was written by  Michael  Prokop  &lt;<a href="mailto:mika@debian.org">mika@debian.org</a>&gt;  and  was  updated/expanded  by  Joao
       Eriberto Mota Filho &lt;<a href="mailto:eriberto@debian.org">eriberto@debian.org</a>&gt; for the Debian project (but may be used by others).

iwatch-0.2.2                                       04 Dec 2022                                         <u><a href="../man1/iwatch.1.html">iwatch</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>