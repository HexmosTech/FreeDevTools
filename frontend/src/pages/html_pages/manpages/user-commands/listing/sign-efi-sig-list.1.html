<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sign-efi-sig-list - signing tool for secure variables as EFI Signature Lists</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/efitools">efitools_1.9.2-3.5_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sign-efi-sig-list - signing tool for secure variables as EFI Signature Lists

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>sign-efi-sig-list</b> [<u>-r</u>] [<u>-m</u>] [<u>-a</u>] [<u>-g</u> <u>&lt;guid&gt;</u>] [<u>-o</u>] [<u>-t</u> <u>&lt;timestamp&gt;</u>] [<u>-i</u> <u>&lt;infile&gt;</u>] [<u>-c</u> <u>&lt;crt</u> <u>file&gt;</u>] [<u>-k</u> <u>&lt;key</u>
       <u>file&gt;</u>] [<u>-e</u> <u>&lt;engine&gt;</u>] <u>&lt;var&gt;</u> <u>&lt;efi</u> <u>sig</u> <u>list</u> <u>file&gt;</u> <u>&lt;output</u> <u>file&gt;</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Produce an output file with an authentication header for direct update to a secure variable.  This output
       may  be  signed  by  the  usual  keys  directly  or may be split for external signing using the <b>-o</b> and <b>-i</b>
       options.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-r</b>     the certificate is rsa2048 rather than x509 [UNIMPLEMENTED]

       <b>-m</b>     Use a monotonic count instead of a timestamp [UNIMPLEMENTED]

       <b>-a</b>     Prepare the variable for APPEND_WRITE rather than replacement

       <b>-o</b>     Do not sign, but output a file of the exact bundle to be signed

       <b>-t</b> &lt;timestamp&gt;
              Use &lt;timestamp&gt; as the timestamp of the timed variable update If not present, then  the  timestamp
              will  be  taken  from  system  time.   Note  you  must use this option when doing detached signing
              otherwise the signature will be incorrect because of timestamp mismatches.

       <b>-i</b> &lt;infile&gt;
              take a detached signature (in PEM format) of the bundle produced by <b>-o</b> and complete  the  creation
              of the update

       <b>-g</b> &lt;guid&gt;
              Use &lt;guid&gt; as the signature owner GUID

       <b>-c</b> &lt;crt&gt;
              &lt;crt&gt; is the file containing the signing certificate in PEM format

       <b>-k</b> &lt;key&gt;
              &lt;key&gt; is the file containing the key for &lt;crt&gt; in PEM format

       <b>-e</b> &lt;engine&gt;
              Use openssl engine &lt;engine&gt; for the private key

</pre><h4><b>EXAMPLES</b></h4><pre>
       To  sign  a  simple  append  update  to db which has been prepared as an EFI Signature List in DB.esl and
       output the result with the authentication header in DB.auth

       sign-efi-sig-list -a -c KEK.crt -k KEK.key db DB.esl DB.auth

       To do a detached signature in the same way

       sign-efi-sig-list -a -t 'Jul 21 09:39:37 BST 2012' -o db DB.esl DB.forsig

       Now sign the DB.forsig file in the standard openssl way.  Note that the standards require sha256  as  the
       signature algorithm

       openssl  smime -sign -binary -in DB.forsig -out DB.signed -signer KEK.crt -inkey KEK.key -outform DER -md
       sha256

       Which produces a detached PKCS7 signature in DB.signed.  Now feed this back into the program  remembering
       to keep the same timestamp (and the -a flag):

       sign-efi-sig-list -a -i DB.signed -t 'Jul 21 09:39:37 BST 2012' db DB.auth

       To delete a key, simply sign an empty EFI signature list file, so to produce an variable update that will
       delete the PK:

       &gt; null.esl

       And then sign it in the standard way (must not be an append write update):

       sign-efi-sig-list -c PK.crt -k PK.key PK null.esl PK.auth

       Once  you  have  the  .auth file conveyed to the UEFI platform, you can use the UpdateVars.efi program to
       apply it

       UpdateVars [-a] db DB.auth

       Where the -a flag must be present if the DB.auth file was created as an append write update and absent if
       its replacing the variable.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/cert-to-efi-sig-list.1.html">cert-to-efi-sig-list</a>(1) for details on how to produce EFI signature lists.

sign-efi-sig-list 1.9.2                            March 2025                               <u><a href="../man1/SIGN-EFI-SIG-LIST.1.html">SIGN-EFI-SIG-LIST</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>