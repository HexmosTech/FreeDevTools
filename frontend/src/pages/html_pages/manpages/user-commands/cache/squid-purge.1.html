<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>purge - magnifying glass into your squid cache</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/squid-purge">squid-purge_6.13-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       purge - magnifying glass into your squid cache

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>purge</b>  <b>[-a]</b> <b>[-c</b> <b>cf]</b> <b>[-d</b> <b>l]</b> <b>[-(f|F)</b> <b>fn</b> <b>|</b> <b>-(e|E)</b> <b>re]</b> <b>[-p</b> <b>h[:p]]</b> <b>[-P</b> <b>#]</b> <b>[-s]</b> <b>[-v]</b> <b>[-C</b> <b>dir</b> <b>[-H]]</b> <b>[-n]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>purge</b>  is used to have a look at what URLs are stored in which file within your cache. The <b>purge</b> tool can
       also be used to release objects which URLs match user specified regular expressions. A  more  troublesome
       feature is the ability to remove files <b>squid</b> does not seem to know about any longer.

       This is a tool for expert usage only, use it under your own responsibility.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b>          a kind of "i am alive" flag. It can only be activated, if your stdout is a tty. If active, it
                   will  display  a little rotating line to indicate that there is actually something happening.
                   You should not use this switch if you capture your stdout in a file  or  if  your  expression
                   list  produces  many  matches.  The  -a  flag  is  also incompatible with the (default) multi
                   cache_dir mode.
                   default: off        See also: -n

       <b>-c</b> <b>cd</b>       this option lets you specify the location of the squid.conf file.   Purge  understands  about
                   more  than  one  cache_dir,  and  does  so by parsing squid.conf. It knows about both ways of
                   Squid-2 cache_dir specifications, and will automatically try to use the correct one.
                   default: /usr/local/squid/etc/squid.conf

       <b>-C</b> <b>cf</b>       if you want to rescue files from your cache, you need to specify the directory into which the
                   files will be copied. Please note that purge  will  try  to  establish  the  original  server
                   directory  structure.  This  switch  also activates copy-out mode. Please do not use copy-out
                   mode with any purge mode (-P) other than 0.
                   For   instance,   if   you   specified   "-C   <a href="file:/tmp">/tmp</a>",   purge   will    try    to    recreate
                   /tmp/www.server.1/url/path/file, and so forth.
                   default: off        See also: -H, -P

       <b>-d</b> <b>l</b>        lets you specify a debug level. Different bits are reserved for different output.
                   default: 0

       <b>-e|-E</b> <b>re</b>    Specify  one  regular expression to be searched for in the cache.  This is useful if there is
                   only a handful of objects you want to  check.  Please  remember  to  escape  the  shell  meta
                   characters  used  in your regular expression. The use of single quotes around your expression
                   is recommended. The capital letter version works case sensitive, the lower caps version  does
                   not.
                   default: (no default)

       <b>-f|-F</b> <b>fn</b>    if  you  have  more  than  a handful of expressions, or want to check the same set at regular
                   intervals, the file option might be more useful to you. Each line in the text  file  will  be
                   regarded  as one regular expression.  Again, the capital letter version works case sensitive,
                   the lower caps version does not.
                   default: (no default)

       <b>-H</b>          if in copy-out mode (see: -C), you can specify to keep the HTTP Header in the recreated file.
                   default: off        See also: -C

       <b>-n</b>          tell purge to process one cache_dir after another, instead of doing things in  parallel.   If
                   you  have  more than one cache_dir in your configuration purge will fork off a worker process
                   for each cache_dir to do the checks for optimum speed, assuming a  decently  designed  cache.
                   Since  parallel  execution  will put quite some load on the system and its controllers, it is
                   sometimes preferred to use less resources,     though it will take longer.
                   default: parallel mode for more than one cache_dir

       <b>-p</b> <b>h[:p]</b>    Some cache admins use a different port than 3128. The purge tool will need to connect to your
                   cache in order to send the PURGE request (see -P). This option lets you specify the host  and
                   port  to  connect to. The port is optional. The port can be a name (check your <a href="file:/etc/services">/etc/services</a>)
                   or number. It is separated from the host name portion by a single colon, no spaces allowed.
                   default: localhost:3128

       <b>-P</b> <b>#</b>        If you want to do more than just print your cache content, you  will  need  to  specify  this
                   option.  Each bit is reserved for a different action. Only the use of the LSB is recommended,
                   the rest should be considered experimental.

              <b>no</b> <b>bit</b> <b>set:</b>    <b>just</b> <b>print</b>
              <b>bit#0</b> <b>set:</b>     <b>send</b> <b>PURGE</b> <b>for</b> <b>matches</b>
              <b>bit#1</b> <b>set:</b>     <b>unlink</b> <b>object</b> <b>file</b> <b>for</b> <b>404</b> <b>not</b> <b>found</b> <b>PURGEs</b>
              <b>bit#2</b> <b>set:</b>     <b>unlink</b> <b>weird</b> <b>object</b> <b>files</b>

       If you use a value other than 0 or 1, you will need to slow rebuild your cache content. A warning message
       will remind you of that. If you use bit#1, all unsuccessful PURGEs will result in the object file in your
       cache directory to be removed, because squid does not seem to know about it any longer. Beware  that  the
       asyncio might try to remove it after the purge tool, and thus complains bitterly. Bit#1 only makes sense,
       if Bit#0 is also set, otherwise it has no effect (since the HTTP status 404 is never returned).

       Bit#2 is reserved for strange files which do not even contain a URL. Beware that these files may indicate
       a  new  object  squid  currently intends to swap onto disk. If the file suddenly went away, or is removed
       when squid tries to fetch the object, it will complain bitterly. You must slow rebuild your cache, if you
       use this option.

       It is recommended that if you dare to use bit#1 or bit#2, you should only grant the purge tool access  to
       your  squid,  e.g.   move  the  HTTP and ICP listening port of squid to a different non-standard location
       during the purge.
       default: 0 (just print)

       <b>-s</b>     If you specify this switch, all commandline parameters will be shown after they were parsed.
              default: off

       <b>-v</b>     be verbose in the things reported about the file. See the output section below.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       In order to use <b>purge</b> to affect a running proxy with PURGE method, you will have to enable  this  feature
       in  squid.conf.  By  default,  PURGE  is disabled. You should watch closely for whom you enable the PURGE
       ability, otherwise a total stranger just might wipe your cache content. Lines similar  to  the  following
       will need to be added to your squid.conf:

              <b>acl</b> <b>purge</b> <b>method</b> <b>PURGE</b>
              <b>http_access</b> <b>allow</b> <b>localhost</b> <b>purge</b>
              <b>http_access</b> <b>deny</b> <b>purge</b>

       Reconfigure or restart (preferred) your squid after changing the configuration file.

</pre><h4><b>OUTPUT</b></h4><pre>
       In  regular  mode,  the  output  of  purge  consists  of  four  columns.  If the URL contains not encoded
       whitespaces, it may look as if there are more columns, but the last one is the URI.
        # name   meaning
        = ====== ===========================================================
        1 file   name of cache file eximed which matches the regular expression.
        2 status return result of purge request, "  0" in print mode.
        3 size   object size including stored headers, not file size.
        4 uri    perceived uri

       Example for non-verbose output in print-mode:

       /cache3/00/00/0000004A   0     5682 <a href="http://graphics.userfriendly.org/images/slovenia.gif">http://graphics.userfriendly.org/images/slovenia.gif</a>

       In verbose mode, additional columns  are  inserted  before  the  uri.  Time  stamps  are  reported  using
       hexadecimal  notation,  and  Squid's  standard  for  reporting "no such timestamp" == -1, and "unparsable
       timestamp" == -2.
        # name   meaning
        = ====== ===========================================================
        1 file   name of cache file eximed which matches the re.
        2 status return result of purge request, "  0" in print mode "-P 0".
        3 size   object size including stored headers, not file size.
        4 md5    MD5 of URI from file, or "(no_md5_data_available)" string.
        5 ts     UTC of Value of Date: header in hex notation
        6 lr     UTC of last time the object was referenced
        7 ex     UTC of Expires: header
        8 lr     UTC of Last-Modified: header
        9 flags  Value of objects flags field in hex, see: Programmers Guide  10  refcnt  number  of  times  the
       object  was  referenced.   11  uri     STORE_META_URL uri or "strange_file" Example for verbose output in
       print-mode:  /cache1/00/00/000000B7    0       406  7CFCB1D319F158ADC9CFD991BB8F6DCE  397d449b   39bf677b
       ffffffff 3820abfc 0460     1  <a href="http://www.netscape.com/images/nc_vera_tile.gif">http://www.netscape.com/images/nc_vera_tile.gif</a>

</pre><h4><b>KNOWN</b> <b>ISSUES</b></h4><pre>
       Purge does not slow rebuild the cache for you.

       It  is  still  relatively  slow, especially if your machine is low on memory and/or unable to hold all OS
       directory cache entries in main memory.

       Should never be used on "busy" caches with purge modes higher than 1.

</pre><h4><b>TODO</b></h4><pre>
       1) use the stat() result on weird files to have a look at their ctime and  mtime.  If  they  are  younger
       than, lets say 30 seconds, they were just created by <b>squid</b> and should not be removed.

       2) Add a query before purging objects or removing files, and add another option to remove nagging for the
       experienced user.

       3) The reported object size may be off by one.

</pre><h4><b>AUTHOR</b></h4><pre>
       This  program  and  manual  was  written  by  <b>Santiago</b>  <b>Garcia</b>  <b>Mantinan</b> <b>&lt;<a href="mailto:manty@debian.org">manty@debian.org</a>&gt;</b> <u>Amos</u> <u>Jeffries</u>
       <u>&lt;<a href="mailto:amosjeffries@squid-cache.org">amosjeffries@squid-cache.org</a>&gt;</u>

       Based on original squidpurge README.

</pre><h4><b>COPYRIGHT</b></h4><pre>
        * Copyright (C) 1996-2024 The Squid Software Foundation and contributors
        *
        * Squid software is distributed under GPLv2+ license and includes
        * contributions from numerous individuals and organizations.
        * Please see the COPYING and CONTRIBUTORS files for details.

</pre><h4><b>QUESTIONS</b></h4><pre>
       Questions on  the  usage  of  this  program  can  be  sent  to  the  <u>Squid</u>  <u>Users</u>  <u>mailing</u>  <u>list</u>  &lt;squid-
       <a href="mailto:users@lists.squid-cache.org">users@lists.squid-cache.org</a>&gt;

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       See  https://wiki.squid-cache.org/SquidFaq/BugReporting for details of what you need to include with your
       bug report.

       Report bugs or bug fixes using https://bugs.squid-cache.org/

       Report serious security bugs to <u>Squid</u> <u>Bugs</u> <u>&lt;<a href="mailto:squid-bugs@lists.squid-cache.org">squid-bugs@lists.squid-cache.org</a>&gt;</u>

       Report ideas for new improvements to the <u>Squid</u> <u>Developers</u> <u>mailing</u> <u>list</u> &lt;<a href="mailto:squid-dev@lists.squid-cache.org">squid-dev@lists.squid-cache.org</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/squid.8.html">squid</a></b>(8), <b><a href="../man1/squidclient.1.html">squidclient</a></b>(1) <b><a href="../man8/cachemgr.cgi.8.html">cachemgr.cgi</a></b>(8)

                                                October 12, 2014                                        <u><a href="../man8/purge.8.html">purge</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>