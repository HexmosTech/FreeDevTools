<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dpa - DNS Packet Analyzer. Analyze DNS packets in ip trace files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/ldnsutils">ldnsutils_1.8.4-2build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dpa - DNS Packet Analyzer. Analyze DNS packets in ip trace files

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>dpa</b> [ <u>OPTION</u> ] <u>TRACEFILE</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>dpa</b>  is  used  to  analyze  dns  packets  in trace files. It has 3 main options: count, filter, and count
       uniques (i.e. count all different occurrences).

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-c</b> <u>expressionlist</u>
              Count occurrences of matching expressions

       <b>-f</b> <u>expression</u>
              Filter: only process packets that match the expression

       <b>-h</b>     Show usage

       <b>-p</b>     Show the total number of correct DNS packets, and percentage of -u and -c values  (of the total of
              matching on the -f filter. if no filter is given, percentages are on all correct dns packets)

       <b>-of</b> <u>file</u>
              Write all packets that match the -f flag to file, as pcap data.

       <b>-ofh</b> <u>file</u>
              Write all packets that match the -f flag to file, in hexadecimal format, readable by drill.

       <b>-s</b>     Show possible match names

       <b>-s</b> <u>matchname</u>
              show possible match operators and values for name

       <b>-sf</b>    Only evaluate packets (in representation format) that match the -f filter.  If no  -f  was  given,
              evaluate all correct dns packets.

       <b>-u</b> <u>matchnamelist</u>
              Count  every  occurrence of every value of the matchname (for instance, count all packetsizes, see
              EXAMPLES in <a href="../man1/ldns-dpa.1.html">ldns-dpa</a>(1) ).

       <b>-ua</b>    For every matchname in -u, show the average value of all matches. Behaviour for match  types  that
              do not have an integer value is undefined.

       <b>-uac</b>   For every matchname in -u, show the average number of times this value was encountered.

       <b>-um</b> <u>number</u>
              Only show the results from -u for values that occurred more than &lt;number&gt; times.

       <b>-v</b> <u>level</u>
              Set verbosity to level (1-5, 5 being the highest). Mostly used for debugging.

       <b>-notip</b> <u>file</u>
              Write packets that were not recognized as IP packets to file (as pcap data).

       <b>-baddns</b> <u>file</u>
              Write dns packets that were too mangled to parse to file (as pcap data).

       <b>-version</b>
              Show version and exit

</pre><h4><b>LIST</b> <b>AND</b> <b>MATCHES</b></h4><pre>
       A  &lt;matchnamelist&gt;  is  a  comma  separated  list of match names (use -s to see possible match names).  A
       &lt;expressionlist&gt; is a comma separated list of expressions.

       An expression has the following form: &lt;expr&gt;: (&lt;expr&gt;)
               &lt;expr&gt; | &lt;expr&gt;
               &lt;expr&gt; &amp; &lt;expr&gt;
               &lt;match&gt;

       &lt;match&gt;:        &lt;matchname&gt; &lt;operator&gt; &lt;value&gt;

       &lt;operator&gt;:      =    equal to &lt;value&gt;      !=   not equal  to  &lt;value&gt;       &gt;    greater  than  &lt;value&gt;
            &lt;    lesser  than  &lt;value&gt;      &gt;=   greater than or equal to &lt;value&gt;      &lt;=   lesser than or equal
       to &lt;value&gt;      ~=   contains &lt;value&gt;

       See the -s option for possible matchnames, operators and values.

</pre><h4><b>EXAMPLES</b></h4><pre>
       ldns-dpa -u packetsize -p test.tr
              Count all different packetsizes in test.tr and show the percentages.

       ldns-dpa -f "edns=1&amp;qr=0" -of edns.tr test.tr
              Filter out all edns enable queries in test.tr and put them in edns.tr

       ldns-dpa -f edns=1 -c tc=1 -u rcode test.tr
              For all edns packets, count the number of truncated packets and all their rcodes in test.tr.

       ldns-dpa -c tc=1,qr=0,qr=1,opcode=QUERY test.tr
              For all packets, count the number of truncated packets, the  number  of  packets  with  qr=0,  the
              number of packets with qr=1 and the number of queries in test.tr.

       ldns-dpa -u packetsize -ua test.tr
              Show all packet sizes and the average packet size per packet.

       ldns-dpa -u srcaddress -uac test.tr
              Show all packet source addresses and the average number of packets sent from this address.

       sudo tcpdump -i eth0 -s 0 -U -w - port 53 | ldns-dpa -f qr=0 -sf
              Print all query packets seen on the specified interface.

</pre><h4><b>AUTHOR</b></h4><pre>
       Written by Jelte Jansen for NLnetLabs.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<a href="mailto:dns-team@nlnetlabs.nl">dns-team@nlnetlabs.nl</a>&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright  (C) 2005 NLnet Labs. This is free software. There is NO warranty; not even for MERCHANTABILITY
       or FITNESS FOR A PARTICULAR PURPOSE.

                                                   1 Nov 2005                                             <u><a href="../man1/dpa.1.html">dpa</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>