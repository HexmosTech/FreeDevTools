<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tcpflow - TCP flow recorder</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/tcpflow-nox">tcpflow-nox_1.6.1-3build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tcpflow - TCP flow recorder

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>tcpflow</b> [<b>-aBcCDIpsZ</b>] [<b>-b</b> <u>max_bytes</u>] [<b>-d</b> <u>debug_level</u>] [<b>-[eE]</b> <u>scanner</u>] [<b>-f</b> <u>max_fds</u>] [<b>-F[ctTXMkmg]</b>]
       [<b>-h</b>|<b>--help</b>] [<b>-i</b> <u>iface</u>] [<b>-l</b> <u>file1.pcap</u> <u>file2.pcap...</u>]  [<b>-L</b> <u>semlock</u>] [<b>-m</b> <u>min_bytes</u>] [<b>-o</b> <u>outdir</u>]
       [<b>-r</b> <u>file1.pcap</u>] [<b>-R</b> <u>file0.pcap</u>] [<b>-S</b> <u>name=value</u>] [<b>-T[filename</b> <b>template]</b>] [<b>-U</b>|<b>--relinquish-</b>
       <b>privileges</b> <u>username</u>] [<b>-v</b>|<b>--verbose</b>] [<b>-V</b>|<b>--version</b>] [<b>-w</b> <u>file</u>] [<b>-x</b> <u>scanner</u>] [<b>-X</b> <u>file.xml</u>]
       [<b>-z</b>|<b>--chroot</b> <u>directory</u>] [<b>expression</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>tcpflow</b> is a program that captures data transmitted as part of TCP connections (flows), and stores the
       data in a way that is convenient for protocol analysis or debugging.  Rather than showing packet-by-
       packet information, <b>tcpflow</b> reconstructs the actual data streams and stores each flow in a separate file
       for later analysis.  <b>tcpflow</b> understands TCP sequence numbers and will correctly reconstruct data streams
       regardless of retransmissions or out-of-order delivery. <b>tcpflow</b> provides control over filenames for
       automatic binning of connections by protocol, IP address or connection number, and has a sophisticated
       plug-in system for decompressing compressed HTTP connections, undoing MIME encoding, or calling user-
       provided programs for post-processing.

       By default <b>tcpflow</b> stores all captured data in files that have names of the form:

            <b>192.168.101.102.02345-010.011.012.013.45103</b>

       ...where the contents of the above file would be data transmitted from host 192.168.101.102 port 2345, to
       host 10.11.12.13 port 45103.

       If you want to simply process a few hundred thousand packets and see what you have, try this:

            <b>tcpflow</b> <b>-a</b> <b>-o</b> <b>outdir</b> <b>-Fk</b> <b>-r</b> <b>packets.pcap</b>

       This will cause <b>tcpflow</b> to perform (-a) all processing, store the output in a directory called <b>outdir,</b>
       bin the output in directories of 1000 connections each, and read its input from the file <b>packets.pcap</b>.
       More sophisticated processing is possible, of course.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b>     Enable all processing. Same as <b>-e</b> <b>all.</b>

       <b>-B</b>     Force binary output even when printing to console with <b>-C</b> or <b>-c.</b>

       <b>-b</b> <u>max_bytes</u>
              Specifies  the  maximum  size  of a captured flow.  Any bytes beyond <u>max_bytes</u> from the first byte
              captured will be discarded.  The default is to store an unlimited number of bytes per flow.  <b>Note:</b>
              before version 1.4, <b>tcpflow</b> could only store a maximum of 4GiB per flow.

       <b>-c</b>     Console  print.  Print the contents of packets to stdout as they are received, without storing any
              captured data to files (implies <b>-s</b>).

       <b>-C</b>     Console print without the packet source and destination details being printed.  Print the contents
              of packets to stdout as they are received, without storing any captured  data  to  files  (implies
              <b>-s</b>).

       <b>-D</b>     Console output should be in hex.

       <b>-d</b>     Debug  level.   Set  the  level  of  debugging  messages printed to stderr to <u>debug_level</u>.  Higher
              numbers produce more messages.  <b>-d</b> <b>0</b> causes completely silent operation.   <b>-d</b>  <b>1</b>  ,  the  default,
              produces  minimal  status  messages.   <b>-d</b>  <b>10</b>  produces verbose output equivalent to <b>-v</b> <b>.</b>  Numbers
              higher than 10 can produce a large amount of debugging information useful only to developers.

       <b>-E</b> <b>name</b>
              Disable all scanners and then enable scanner <b>name</b>

       <b>-e</b> <b>name</b>
              Enable scanner <b>name.</b>

       <b>-e</b> <b>all</b> Enables all scanners. Same as <b>-a</b>

       <b>-e</b> <b>http</b>
              Perform HTTP post-processing ("After" processing). If the output file is

                   <b>208.111.153.175.00080-192.168.001.064.37314,</b>

              Then the post-processing will create the files:

                   <b>208.111.153.175.00080-192.168.001.064.37314-HTTP</b>
                   <b>208.111.153.175.00080-192.168.001.064.37314-HTTPBODY</b>

              If the HTTPBODY was compressed with GZIP, you may get a third file as well:

                   <b>208.111.153.175.00080-192.168.001.064.37314-HTTPBODY-GZIP</b>

              Additional information about these streams, such as their MD5 hash value, is also written  to  the
              <b>DFXML</b> <b>report</b> file.

       <b>-e</b> <b>python</b> <b>-S</b> <b>py_path=path</b> <b>-S</b> <b>py_module=module</b> <b>-S</b> <b>py_function=foo</b>
              Post-process TCP payload by an external python function.

              The  python function must take a single string parameter.  The python function can return a string
              (else the function does must not return).  The returned string (if any) is written  in  the  <b>DFXML</b>
              <b>report</b>  file  inside  the  XML  tag <b>&lt;scan_python_result&gt;...&lt;/scan_python_result&gt;</b>.  A sample python
              script is available within the tcpflow source code in directory <b>python/plugins</b>.

              Example:

                  <b>tcpflow</b> <b>-r</b> <b>my.cap</b> <b>-e</b> <b>python</b> <b>-S</b> <b>py_path=python/plugins</b> <b>-S</b> <b>py_module=samplePlugin</b> <b>-S</b> <b>py_function=sampleFunction</b>

       <b>-F[format]</b>
              Specifies format for output filenames.

              Format specifiers:

              <b>c</b>      Appends the connection counter to ALL filenames.

              <b>t</b>      Prepends each filename with a Unix timestamp (seconds since epoch).

              <b>T</b>      Prepends each filename with an ISO-8601 timestamp.

              <b>X</b>      Do not output any files (other than the <b>DFXML</b> <b>report</b> file).

       <b>-FM</b>    Include MD5 of each flow in the <b>DFXML</b> <b>report</b> file.

       <b>-FX</b>    Suppresses file output entirely, <b>DFXML</b> <b>report</b> file is still produced.

       <b>-Fk</b>    bin output in 1K directories

       <b>-Fm</b>    bin output in 1M directories (2 levels)

       <b>-Fg</b>    bin output in 1G directories (3 levels)

       <b>-f</b><u>max_fds</u>
              Max file descriptors used.  Limit the number of file  descriptors  used  by  <b>tcpflow</b>  to  <u>max_fds</u>.
              Higher numbers use more system resources, but usually perform better.  If the underlying operating
              system  supports the <b>setrlimit()</b> system call, the OS will be asked to enforce the requested limit.
              The default is for <b>tcpflow</b> to use the maximum number of file descriptors allowed by the  OS.   The
              <b>-v</b> option will report how many file descriptors <b>tcpflow</b> is using.

       <b>-g</b>     Output  flow  information to console in multiple colors. (Blue for client to server flows, red for
              server to client flows, green for undecided flows.)  Note: This option was different from  <b>tcpflow</b>
              1.3 (-e) and 1.4.4 (-J).

       <b>-h</b> <b>--help</b>
              Help.  Print usage information and exit.

       <b>-hh</b>    More help.  Print more usage information and exit.

       <b>-i</b> <u>iface</u>
              Interface  name.   Capture  packets  from  the  network interface named <u>iface</u>.  If no interface is
              specified with <b>-i</b> , a reasonable default will be used by libpcap automatically.

       <b>-I</b>     Store the reception timestamps (of TCP packets) in a companion file <b>*.findx</b>.  Therefore each  flow
              will  have two files: (1) the usual file containing payload bytes and (2) the text file containing
              the corresponding timestamps.  This last file <b>*.findx</b> has three columns  using  the  pipe  <b>'|'</b>  as
              separator:

                  <b>byte-index|timestamp|length</b>

              The  <b>byte-index</b> column is the postion within the file containing the payload bytes.  The <b>timestamp</b>
              column represents the number of seconds since epoch as a floating point number.  The precision  is
              the  microsecond but may also be the nanosecond in a future <b>tcpflow</b> version.  The <b>length</b> column is
              the number of successive bytes concerned by <b>timestamp</b> and can  include  several  TCP  frames  (TCP
              packets).  The extension <b>findx</b> may become from the fact that the timestamps are <b>frame</b> <b>indexed</b>.

       <b>-L</b> <u>semlock_name</u>
              Specifies  that <u>semlock_name</u> should be used as a Unix semaphore to prevent two different copies of
              <b>tcpflow</b> running in two different processes  but  outputting  to  the  same  standard  output  from
              printing on top of each other. This is an application of Unix named semaphores; bet you have never
              seen one before.

       <b>-l</b>     Treat  the  following  arguments  as  filenames  with an assumed <b>-r</b> command before each one.  This
              allows you to read a lot of files at once with shell globbing. For example, to process all of  the
              pcap files in the current directory, use this:

                   <b>tcpflow</b> <b>-o</b> <b>out</b> <b>-a</b> <b>-l</b> <b>*.pcap</b>

       <b>-m</b> <u>min_size</u>
              Forces  a  new connection output file when there is a skip in the TCP session of <u>min_size</u> bytes or
              more.

       <b>-o</b> <u>outdir</u>
              Specifies the output directory where the transcript files will be written.

       <b>-P</b>     No purge. Normally <b>tcpflow</b> removes connections from the hash table after the connection is  closed
              with  a FIN. This conserves memory but takes additional CPU time. Selecting this option causes the
              std::tr1:unordered_map to grow without bounds, as <b>tcpflow</b> did prior to  version  1.1.  That  makes
              <b>tcpflow</b>  run  faster  if there are less than 10 million connections, but can lead to out-of-memory
              errors.

       <b>-p</b>     No promiscuous mode.  Normally, <b>tcpflow</b> attempts to put the  network  interface  into  promiscuous
              mode  before  capturing  packets.   The  <b>-p</b>  option  tells  <b>tcpflow</b>  <u>not</u> to put the interface into
              promiscuous mode.  Note that it might already be in promiscuous mode for some other reason.

       <b>-q</b>     Quiet mode --- don't print warnings. Currently the only warning that <b>tcpflow</b> prints is  a  warning
              when  more  than  10,000 files are created that the user should have provided the <b>-Fk</b>, <b>-Fm</b>, or <b>-Fg</b>
              options. We might have other warnings in the future.

       <b>--relinquish-privileges=</b><u>username</u>
              When <b>tcpflow</b> is run as root, this option changes the user ID and group ID to write files owned  by
              <u>username</u>.   The  group  ID  is  the  first  one  from the <u>username</u> groups list.  This operation is
              performed just after opening the capture device or just after opening the first input  PCAP  file.
              This  option  does  not  support  multi  root-only readable input files as the root privileges are
              dropped after opening the first file (e.g.  <b>-r</b> <u>root-only-access.pcap</u> <b>-R</b>  <u>root-only.pcap</u>  <b>-l</b>  <u>root-</u>
              <u>only*.pcap</u>).   This  option  has  the same behaviour as the <u><a href="../man1/tcpdump.1.html">tcpdump</a></u>(1) option having the same name
              <b>--relinquish-privileges</b>

       <b>-r</b>     Read from file.  Read packets from <u>file</u>, which was created using  the  <b>-w</b>  option  of  <u><a href="../man1/tcpdump.1.html">tcpdump</a></u>(1).
              This option may be repeated any number of times. Standard input is used if <u>file</u> is "-".  Note that
              for  this option to be useful, tcpdump's <b>-s</b> option should be used to set the snaplen to the MTU of
              the interface (e.g., 1500) while capturing packets.

       <b>-R</b>     Read from a file, but only to complete TCP flows. This option is used  when  <u>tcpflow</u>  is  used  to
              process a series of files that are captured over time.  For each time period <u>n,</u> file  <u>file(n).pcap</u>
              should  be  processed  with   <b>-R</b>  <u>file(n).pcap</u><b>,</b>  <b>while</b>  <u>file(n-1).pcap</u> <b>should</b> <b>be</b> <b>processed</b> <b>with</b> <u>-r</u>
              <u>file(n-1).pcap.</u>

       <b>-S</b><u>name</u><b>=</b><u>value</u>
              Sets a <u>name</u> parameter to be equal to <u>value</u> for a plug-in.  Use <b>-hh</b> to find out all of the settable
              parameters.

       <b>-s</b>     Strip non-printables.  Convert all non-printable characters to the "." character  before  printing
              packets to the console or storing them to a file.

       <b>-T[format]</b>
              Specifies an arbitrary template for filenames.

              <b>%A</b>     expands to source IP address.

              <b>%a</b>     expands to source IP port.

              <b>%B</b>     expands to destination IP address.

              <b>%b</b>     expands to destination IP port.

              <b>%T</b>     expands to timestamp in ISO8601 format.

              <b>%t</b>     expands to timestamp in Unix time_t format.

              <b>%V</b>     expands to "--" if a VLAN is present.

              <b>%v</b>     expands to the VLAN number if a VLAN is present.

              <b>%C</b>     expands to "c" if the connection count&gt;0.

              <b>%c</b>     expands to the connection count if the connection count&gt;0.

              <b>%#</b>     always expands to the connection count.

              <b>%N</b>     (connection_number )             % 1000

              <b>%K</b>     (connection_number / 1000)       % 1000

              <b>%M</b>     (connection_number / 1000000)    % 1000

              <b>%G</b>     (connection_number / 1000000000) % 1000

              <b>%%</b>     prints a "%".

              When the option <b>-T</b> is used, <b>tcpflow</b> ignores options <b>-Fk</b>, <b>-Fm</b> and <b>-Fg</b>.
              However,  the option <b>-T</b> handles <b>'/'</b> within the filename template patern to create sub-directories.
              For example the following line will create a directory tree <b>out/IP-src/port-src/IP-dst/port-dst</b>.

                  <b>tcpflow</b> <b>-r</b> <b>packets.pcap</b> <b>-o</b> <b>out</b> <b>-T</b> <b>%A/%a/%B/%b/%c%N.flow</b>

       <b>-V</b> <b>--version</b>
              Print the version number and exit.

       <b>-v</b> <b>--verbose</b>
              Verbose operation.  Verbosely describe <b>tcpflow</b>'s operation.  Equivalent to  <b>-d</b> <b>10</b>.

       <b>-w</b> <u>filename.pcap</u>
              Write packets that were not processed to <u>filename.pcap</u>. Typically this will be UDP packets.

       <b>-X</b> <u>filename.xml</u>
              Write a <b>DFXML</b> <b>report</b> to <u>filename.xml</u>. The file contains a record of every tcp connection, how  the
              <b>tcpflow</b>  program  was  compiled,  and  the  computer on which <b>tcpflow</b> was run.  By default <b>tcpflow</b>
              writes the <b>DFXML</b> <b>report</b> in file <u>report.xml</u>.

       <b>-Z</b>     Don't decompress gzip-compressed streams.  <b>-K</b> Retain per flow isolated pcap structure.

       <u>expression</u>
              selects which packets will be captured.  If no <u>expression</u> is given, all packets on the net will be
              captured.  Otherwise, only packets for which <u>expression</u> is `true' will be captured.

              For the <u>expression</u> syntax, see <b><a href="../man7/pcap-filter.7.html">pcap-filter</a></b>(7).

              The <u>expression</u> argument can be passed to <u>tcpflow</u> as either a single Shell argument, or as multiple
              Shell arguments, whichever is more  convenient.   Generally,  if  the  expression  contains  Shell
              metacharacters,  such  as  backslashes used to escape protocol names, it is easier to pass it as a
              single, quoted argument rather than to escape the Shell metacharacters.   Multiple  arguments  are
              concatenated with spaces before being parsed.

</pre><h4><b>DFXML</b> <b>report</b></h4><pre>
       The  <b>DFXML</b>  <b>report</b>  is  the  XML  file  written by <b>tcpflow</b> to provide <b>tcpflow</b> build details, command line
       arguments and information about processed flows.

       By default the <b>DFXML</b> <b>file</b> is named <u>report.xml</u>.  But this filename  can  be  changed  using  command  line
       option <b>-X</b>.

       <b>DFXML</b>   <b>file</b>   respects   the   <b>DFXML</b>   <b>schema</b>   defined   by  project  <u>https://github.com/dfxml-working-</u>
       <u>group/dfxml_schema</u>.
       Moreover <b>tcpflow</b> adds two extra XML tags, as illustrated by the following example:

              <b>&lt;tcpflow</b> <b>startime='2017-07-22T00:12:21.962782Z'</b> <b>endtime='2017-07-22T00:12:22.097591Z'</b>
                       <b>family='2'</b> <b>mac_daddr='40:3d:78:57:ed:d4'</b> <b>mac_saddr='00:c5:42:d2:cb:f2'</b>
                       <b>src_ipn='141.134.34.12'</b> <b>dst_ipn='192.168.0.40'</b> <b>srcport='80'</b> <b>dstport='38797'</b>
                       <b>packets='4'</b> <b>len='677'</b> <b>caplen='611'</b> <b>/&gt;</b>

              <b>&lt;tcpflow:result</b> <b>scanner="python"</b> <b>path="python/plugins"</b> <b>module="samplePlugin"</b>
                              <b>function="sampleFunction"&gt;bla</b> <b>bla</b> <b>bla&lt;/tcpflow:result&gt;</b>

       The first XML tag <b>&lt;tcpflow&gt;</b> provide information about the captured flow.   This  tag  should  be  renamed
       <b>&lt;tcpflow:cap&gt;</b> in a future version in order to conform better to <b>DFXML</b> <b>schema</b>.

       The second XML tag <b>&lt;tcpflow:result&gt;</b> collects processing results.  For the moment, only the scanner <u>python</u>
       uses this feature.

       The XML attributes of <b>&lt;tcpflow&gt;</b> are:

       •      <b>startime</b> Reception time of first packet

       •      <b>endtime</b> Reception time of last packet

       •      <b>family</b>

       •      <b>mac_daddr</b> Destination MAC address of first packet (printed if any)

       •      <b>mac_saddr</b> Source MAC address of first packet (printed if any)

       •      <b>src_ipn</b> IP source

       •      <b>dst_ipn</b> IP destination

       •      <b>srcport</b> TCP port source

       •      <b>dstport</b> TCP port destination

       •      <b>packets</b> Nummber of packets

       •      <b>out_of_order_count</b> Number of times <b>tcpflow</b> has replaced missing payload by zeros in the flow file,
              for example when capture does not contain the TCP session begin (printed if any)

       •      <b>violations</b> Number of protocol violations (printed if any)

       •      <b>len</b>    Sum    of    un-truncated   length   of   all   packet   data   (including   headers,   see
              https://stackoverflow.com/q/1491660)

       •      <b>caplen</b> Sum of captured bytes of all packet data (including headers, printed if different from <b>len</b>)

       The XML attributes of <b>&lt;tcpflow:result&gt;</b> are:

       •      <b>scanner</b> Name of the scanner

       •      <b>path</b> Directory of the scanner module (printed if relevant)

       •      <b>module</b> Module name (printed if relevant, used to indicate the python script)

       •      <b>function</b> Function name (printed if relevant, used to  indicate  the  function  within  the  python
              module)

</pre><h4><b>EXAMPLES</b></h4><pre>
       To record all packets arriving at or departing from <u>sundown</u> and extract all of the HTTP attachments:
              <b>tcpflow</b> <b>-e</b> <b>http</b> <b>-o</b> <b>outdir</b> <b>host</b> <b>sundown</b>

       To  record traffic between <u>helios</u> and either <u>hot</u> or <u>ace</u> and bin the results into 1000 files per directory
       and calculate the MD5 of each flow:
              <b>tcpflow</b> <b>-X</b> <b>report.xml</b> <b>-e</b> <b>md5</b> <b>-o</b> <b>outdir</b> <b>-Fk</b> <b>host</b> <b>helios</b> <b>and</b> <b>\(</b> <b>hot</b> <b>or</b> <b>ace</b> <b>\)</b>

</pre><h4><b>BUGS</b></h4><pre>
       Please send bug reports to <a href="mailto:simsong@acm.org">simsong@acm.org</a>.

       <b>tcpflow</b> currently does not understand IP fragments.  Flows containing IP fragments will not  be  recorded
       correctly.

</pre><h4><b>AUTHORS</b></h4><pre>
       Originally  by  Jeremy  Elson &lt;<a href="mailto:jelson@circlemud.org">jelson@circlemud.org</a>&gt;.  Substantially modified and maintained by Simson L.
       Garfinkel &lt;<a href="mailto:simsong@acm.org">simsong@acm.org</a>&gt;.  Network visualization code by Michael Shick &lt;<a href="mailto:mike@shick.in">mike@shick.in</a>&gt;

       The current version of this software is available at
              <u><a href="http://digitalcorpora.org/downloads/tcpflow/">http://digitalcorpora.org/downloads/tcpflow/</a></u>

       An announcement mailing list for this program is at:
              <u><a href="http://groups.google.com/group/tcpflow-users">http://groups.google.com/group/tcpflow-users</a></u>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/tcpdump.1.html">tcpdump</a>(1), <a href="../man4P/nit.4P.html">nit</a>(4P), <a href="../man4/bpf.4.html">bpf</a>(4), <a href="../man3/pcap.3.html">pcap</a>(3), <a href="../man5/pcap-savefile.5.html">pcap-savefile</a>(5), <a href="../man7/pcap-filter.7.html">pcap-filter</a>(7)

tcpflow 1.6.1                                      2013-04-13                                         <u><a href="../man1/tcpflow.1.html">tcpflow</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>