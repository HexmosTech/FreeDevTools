<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>labrea - Honeypot for incoming IP connection attempts</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/labrea">labrea_2.5-stable-3.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       labrea - Honeypot for incoming IP connection attempts

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>labrea</b>  [<b>-i</b>  <b>--device</b>  <b>INTERFACE</b>]  [<b>-n</b>  <b>--network</b>  <b>nnn.nnn.nnn.nnn[/nn]</b>]  [<b>-m</b> <b>--mask</b> <b>nnn.nnn.nnn.nnn</b>] [<b>-t</b>
       <b>--throttle-size</b>  <b>BYTES</b>]  [<b>-p</b>  <b>--max-rate</b>  <b>RATE</b>  ]  [<b>-R</b>  <b>--soft-restart</b>]  [<b>-r</b>  <b>--arp-timeout</b>   <b>RATE</b>]   [<b>-s</b>
       <b>--switch-safe</b>]   [<b>-h</b>   <b>--hard-capture</b>]   [<b>-x</b>   <b>--disable-capture</b>]   [<b>-X</b>   <b>--exclude-resolvable-ips</b>]   [<b>-P</b>
       <b>--persist-mode-only</b>]  [<b>-a</b>  <b>--no-resp-synack</b>]  [<b>-H</b>  <b>--auto-hard-capture</b>]   [<b>-f</b>   <b>--no-resp-excluded-ports</b>]
       [<b>--no-arp-sweep</b>]   [<b>--init-file</b>   <b>FILE</b>]  [<b>-F</b>  <b>--bpf-file</b>  <b>FILE</b>]  [<b>-T</b>  <b>--dry-run</b>]  [<b>-d</b>  <b>--foreground</b>]  [<b>-o</b>
       <b>--log-to-stdout</b>] [<b>-O</b> <b>--log-timestamp-epoch</b>] [<b>-l</b> <b>--log-to-syslog</b>] [<b>-b</b> <b>--log-bandwidth</b>] [<b>-v</b> <b>--verbose</b>]  [<b>-q</b>
       <b>--quiet</b>]  [<b>-z</b>  <b>--no-nag</b>]  [<b>-?</b>  <b>--usage</b>  <b>--help</b>  ]  [<b>-V</b>  <b>--version</b>]  [<b>-I</b>  <b>--ip-addr</b>  <b>nnn.nnn.nnn.nnn</b>]  [<b>-E</b>
       <b>--my-mac-addr</b>  <b>xx:xx:xx:xx:xx:xx</b>]  [<b>-D</b>  <b>--list-interfaces</b>]   [<b>-j</b>   <b>--winpcap-dev</b>   <b>nn</b>]   [<b>--syslog-server</b>
       <b>nnn.nnn.nnn.nnn</b>] [<b>--syslog-port</b> <b>nnn</b>]

       [<b>BPF</b> <b>Filter</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>labrea</b>  creates  virtual machines for unused IP addresses in the specified block of IP addresses.  LaBrea
       sits and listens for ARP "who-has" requests.

       When an ARP request for a particular IP goes unanswered for longer than its "rate"  setting  (default:  3
       seconds),  labrea  crafts  an  ARP  reply  that  routes  all traffic destined for the IP to a "bogus" MAC
       address.  labrea sniffs for TCP/IP traffic sent to that MAC address and then responds to any  SYN  packet
       with a SYN/ACK packet that it creates.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>labrea</b> accepts the following options:

       <b>-i</b> <b>--device</b> <u>interface</u>
              By  default,  labrea  uses  the  first ethernet interface. This forces labrea to use the specified
              interface.

       <b>-n</b> <b>--network</b> xxx.xxx.xxx.xxx[/nn]
              labrea normally pulls information about the netblock from  the  IP  information  assigned  to  the
              interface.   If  labrea  is run on an unconfigured interface (one without an assigned IP address),
              then use this option to specify the subnet to be captured.

              <u>xxx.xxx.xxx.xxx</u> is the network address.  <u>/nn</u> is the subnet mask in CIDR notation.  If  the  subnet
              mask is not specified here, then you must include the -m parameter.

       <b>-m</b> <b>--mask</b> xxx.xxx.xxx.xxx
              Another  way to specify the network mask for the capture netblock. If this parameter is specified,
              then the -n parameter must also be specified.

       <b>-t</b> <b>--throttle-size</b> <u>nn</u>
              Sets the TCP window advertisement to limit the amount of data sent to labrea. The number  of  data
              bytes to allow per packet is <u>nn</u> bytes.

       <b>-p</b> <b>--max-rate</b> <u>rate</u>
              Connect attempts will be permanently captured by forcing the connection into a "persist" state (by
              closing the TCP window). In this state, the connection will not time out.  labrea will permanently
              capture  connect  attempts  up  to  maximum  bandwidth  <u>rate</u> bytes.  If the specified bandwidth is
              exceeded, labrea will still tarpit the incoming connection (ie respond SYN/ACK to incoming SYN).

       <b>-R</b> <b>--soft-restart</b>
              New captures will be held off for 5 minutes to let bandwidth calculations  progress.  If  a  major
              scan hits just after startup, this prevents labrea from capturing too many connections.

       <b>-r</b> <b>--arp-timeout</b> <u>rate</u>
              Wait <u>rate</u> seconds after seeing incoming arp requests before capturing an IP address.

       <b>-s</b> <b>--switch-safe</b>
              When there is an incoming ARP request, specifies that labrea should send out an ARP request of its
              own  for the same IP address. This is necessary for safe operation in a switched environment where
              one host does not necessarily see all the traffic on the switch.

       <b>-h</b> <b>--hard-capture</b>
              Once an IP address has been captured, then do not wait for a "-r" timeout for  the  next  incoming
              ARP request.

       <b>-x</b> <b>--disable-capture</b>
              Do not capture IPs.

       <b>-X</b> <b>--exclude-resolvable-ips</b>
              On  startup,  attempt DNS resolution on all IPs within the capture netblock. Automatically exclude
              any IP that has a corresponding entry in the DNS. Be careful because this can generate  a  lot  of
              DNS lookups if the capture subnet is large.

       <b>-P</b> <b>--persist-mode-only</b>
              Try  to  limit  bandwidth  use  by  doing only persist capturing. Note: This parameter has limited
              usefulness since below max b/w, the same exchange that leads to persist capture also has the  side
              effect of tarpitting.

       <b>-a</b> <b>--no-resp-synack</b>
              By  default, the LaBrea virtual hosts respond to SYN/ACK with RST, and answer Pings. Disables this
              behaviour.

       <b>-H</b> <b>--auto-hard-capture</b>
              Mark all non-excluded and all non-hardexcluded IPs as being hard captured. See <b><a href="../man5/labrea.conf.5.html">labrea.conf</a>(5)</b>  for
              more information. This parameter should be used <u>with</u> <u>caution.</u>

       <b>-f</b> <b>--no-resp-excluded-ports</b>
              Drop  incoming  connections  to excluded ports. Normal default behaviour is to return a RST. Makes
              nmap-style scanning go much slower.

       <b>--no-arp-sweep</b>
              On startup, labrea sweeps the capture subnet with bursts of ARP requests in an attempt  to  locate
              all live machines. This parameter disables the sweep.

       <b>--init-file</b> <u>file</u>
              Read the configuration from the specified <u>file</u> instead of from the default location.

       <b>-F</b> <b>--bpf-file</b> <u>file</u>
              Designates  the name of a file containing a BPF filter pointing to machines/ports to be tarpitted.
              As with the command line BPF filter, these connections MUST be firewalled to DROP inbound traffic.

       <b>-T</b> <b>--dry-run</b>
              Do labrea initialization, including Dns excludes, parse of the  configuration  file,  opening  the
              network interface etc. Print diagnostic information, then exit.

       <b>-d</b> <b>--foreground</b>
              Do not detach the process. (Unix systems only)

       <b>-o</b> <b>--log-to-stdout</b>
              Send  log  information  to stdout rather than to syslog.  This option also implies and sets the -d
              option (i.e. do not detach process).

       <b>-O</b> <b>--log-timestamp-epoch</b>
              Same as the "-o" option, but with time output in seconds since epoch to make it easier for logfile
              analysis programs.

       <b>-l</b> <b>--log-to-syslog</b>
              Send log messages to syslog.

       <b>-b</b> <b>--log-bandwidth</b>
              Log a message every minute detailing the current bandwidth consumption of the -p  option  (persist
              capture).

       <b>-v</b> <b>--verbose</b>
              Increase the verbosity of log messages. Use twice for more effect.

       <b>-q</b> <b>--quiet</b>
              Do not report arp requests for IPs that are not in the capture subnet.

       <b>-z</b> <b>--no-nag</b>
              Turn  off  the  nag  message. Before you do this, read the basic warning in the Notes section just
              below.

       <b>-?</b> <b>--usage</b> <b>--help</b>
              Print a help message and then exit.

       <b>-V</b> <b>--version</b>
              Print version information and exit.

       <b>-I</b> <b>--ip-addr</b> <u>nnn.nnn.nnn.nnn</u>
              Manually specify the IP address for the labrea server.

       <b>-E</b> <b>--my-mac-addr</b> <u>xx:xx:xx:xx:xx:xx</u>
              Manually specify the MAC address of the labrea server's NIC.

       <b>-D</b> <b>--list-interfaces</b>
              On Windows systems, print the list of WinPcap  devices,  followed  by  the  list  of  the  libdnet
              interfaces. Note that each API has a different nomenclature for the underlying NIC.

       <b>-j</b> <b>--winpcap-dev</b> <u>nn</u>
              On windows systems, select the nth winpcap device in the list.

</pre><h4><b>NOTES</b></h4><pre>
   <b>Basic</b> <b>Warning</b> <b>about</b> <b>use</b> <b>of</b> <b>labrea</b>
       <u>You</u> <u>must</u> <u>understand</u> <u>this:</u> As a default, LaBrea captures IP addresses by creating a "virtual machine" that
       sits on any UNUSED IP address that it sees. labrea has been carefully written and tested to transparently
       and peacefully operate in normal production environments but ...

       <u>There</u>  <u>is</u>  <u>a</u> <u>potential</u> <u>for</u> <u>problems</u> if someone decides to start using one of the IP addresses that labrea
       has laid claim to, or if labrea erroneously decides that an IP address  is  free  when  in  fact  a  real
       machine is already there.

   <b>Built-in</b> <b>protections</b>
       labrea tries very hard to NEVER capture an IP that has a live machine sitting on it.

       The following automatic mechanisms are provided:

              •      If  labrea  sees  a  gratuitous  ARP  signalling the arrival of a new machine, it marks the
                     corresponding IP address as excluded. ("new kids on the block" logic)

              •      Each ARP response is noted and the corresponding IP address is marked as excluded.

              •      At startup, a systematic sweep is done of the entire capture subnet (as long as the  subnet
                     is not too big). All IP addresses that respond are marked as excluded.

       Then  there  are  ways  of manually specifying the exclusion of certain addresses, and otherwise ensuring
       safe operation:

              •      The EXC config stmt allows specified IP addresses to be manually excluded from capture.

              •      The IPI config stmt causes packets with the specified IP source address(es) to be ignored.

              •      -s --switch-safe parameter causes mirroring of ARP requests in a switched environment

              •      -X --exclude-resolvable-ips says to exclude all IPs that have a corresponding Dns entry

       <b>Traffic</b> <b>rerouting:</b> Despite all this, if labrea somehow receives  traffic  whose  IP  destination  address
       belongs to a live machine, labrea will reroute that traffic to the real machine.

   <b>Size</b> <b>of</b> <b>the</b> <b>capture</b> <b>subnet</b>
       It  is  best  to  limit  the  capture  subnet  to the <u>actual</u> <u>physical</u> <u>segment</u> (VLAN, hub) where labrea is
       running.

       In some configurations, where proxy arp is being used to determine routing, interface subnet masks can be
       quite large. (i.e. the "whole" network is "directly" attached to the physical segment).

       In this case, if labrea picks up the subnet mask from the interface, then labrea will inefficiently watch
       addresses that it has no hope of capturing. You should use the -m / -n parameters to manually  limit  the
       size of the capture subnet.

   <b>Other</b> <b>usage</b> <b>notes</b>

       The labrea virtual machines use a bogus MAC address of 0:0:f:ff:ff:ff

       On certain older Windows systems, it may be necessary to manually specify the capture subnet.

       On unix systems, KILL -USR1 will toggle logging off on and off.

       On unix systems, KILL -HUP will cause labrea to reinitialize (and thus free captured IPs).

       If the capture subnet is too large (greater than 1024 addresses), then labrea will not do an arp sweep.

</pre><h4><b>BUGS</b></h4><pre>

       On  some  systems,  if there is absolutely no traffic to sniff, pcap_dispatch will wait instead of timing
              out, making the program seem unresponsive. (Workaround: ping the labrea server to "wake" it up.)

       If --exclude-resolvable-ips is enabled, and if the capture subnet is large (say class A /8), then  a  LOT
              of traffic will be generated to the Dns server.

</pre><h4><b>EXAMPLES</b></h4><pre>
       1)     Run  safely  in a switched environment with very verbose logging. Don't respond to excluded ports.
              Log bandwidth usage from persist capturing. Exclude all IPs that  are  in  the  Dns.  Run  in  the
              foreground,  and  log  to  stdout.  Maximum  capture  bandwidth  is 2 MB/sec. Use toto.conf as the
              initialisation file. Use network device "eth1" instead of the default device. Do a test run only -
              parse input, initialize, then exit.

              labrea --switch-safe --verbose -v  --no-resp-excluded-ports
                 --log-bandwidth --exclude-resolvable-ips --foreground
                 --log-to-stdout --max-rate 2000000 --init-file toto.conf
                 --device eth1 -z --dry-run
                 (one line)

       2)     Same thing with the short parameter style.

              labrea -z -s -v -v -f -b -X -d -o -p 2000000
                 --init-file toto.conf -i eth1 -T
                 (one line)

</pre><h4><b>FILES</b></h4><pre>
       <u>/usr/local/etc/labrea.conf</u>
              Default configuration file

       <u>/usr/local/sbin/labrea</u>
              Program

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/labrea.conf.5.html">labrea.conf</a></b>(5)

</pre><h4><b>AUTHOR</b></h4><pre>
       Tom Liston &lt;<a href="mailto:tliston@hackbusters.net">tliston@hackbusters.net</a>&gt; Bugs: <a href="mailto:lorgor@users.sourceforge.net">lorgor@users.sourceforge.net</a> or <a href="http://labrea.sourceforge.net">http://labrea.sourceforge.net</a>

                                                                                                       <u><a href="../man1/LABREA.1.html">LABREA</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>