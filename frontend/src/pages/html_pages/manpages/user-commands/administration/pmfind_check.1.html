<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmfind_check - administration of Performance Co-Pilot discovery</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/pcp">pcp_6.3.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmfind_check</b> - administration of Performance Co-Pilot discovery

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>$PCP_BINADM_DIR/pmfind_check</b> [<b>-CNV?</b>]  [<b>-l</b> <u>logfile</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  shell  script  is  used  to  integrate the Performance Co-Pilot (see <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1)) collector service
       discovery mechanisms with <b><a href="../man1/pmie.1.html">pmie</a></b>(1) and <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) service administration, such  that  multiple  collector
       hosts  can  be monitored from a single centralized host.  It is important to note that the <b>pmfind</b> service
       is tightly integrated with the <b>pmie</b> and <b>pmlogger</b> services, and these must also be enabled if the services
       are to be started for each collector system that <b>pmfind</b> discovers.

       <b>pmfind_check</b> is designed to be enabled via a service management daemon such as <b><a href="../man1/systemd.1.html">systemd</a></b>(1) on  Linux.   It
       is  run  from  a  system  timer (either by <b>systemd</b> or by <b>cron</b> on other systems).  Once per timer interval
       <b>pmfind</b> attempts discovery of PCP collector systems.  For each unique system  found  <b>pmfind_check</b>  creates
       <b>pmie_check</b>  and  <b>pmlogger_check</b>  control file entries, such that these latter process can manage one <b>pmie</b>
       and <b>pmlogger</b> service for each discovered collector system.

       When run through <b>systemd</b> these processes will  be  launched  immediately  because  <b>systemd</b>  monitors  the
       service  control  files  for  changes.  With <b>systemd</b> one may also initiate an immediate service discovery
       with <b>pmfind</b> and <b>pmfind_check</b> by modifying the <u>$PCP_SYSCONF_DIR/pmfind</u> directory in any way.

       When run from <b>cron</b> the next (also timer-based) invocation of <b>pmie_check</b> or <b>pmlogger_check</b> will start  and
       manage the associated <b>pmie</b> and <b>pmlogger</b> processes.

       The  control  file  entries  created  by  <b>pmfind_check</b> follow the convention of individual files for each
       collector host.  The files are named using the (unique) source identifier that <b>pmfind</b>  calculates.   This
       identifier  is  a  hash  calculated based on (non-optional) context labels available from every collector
       host, and is the same source identifier reported and used by <b><a href="../man1/pminfo.1.html">pminfo</a></b>(1) and <b><a href="../man1/pmseries.1.html">pmseries</a></b>(1).

</pre><h4><b>OPTIONS</b></h4><pre>
       The available command line options are:

       <b>-C</b>, <b>--containers</b>
            This option causes <b>pmfind_check</b> to query each discovered collector system for running containers  as
            well, which will then be individually monitored.

       <b>-l</b> <u>file</u>, <b>--logfile</b>=<u>file</u>
            In  order  to  ensure  that mail is not unintentionally sent when these scripts are run from <b><a href="../man8/cron.8.html">cron</a></b>(8)
            diagnostics    are    always    sent    to    log    files.     By    default,    this    file    is
            <b>$PCP_LOG_DIR/pmfind/pmfind_check.log</b>  but this can be changed using the <b>-l</b> option.  If this log <u>file</u>
            already exists when the script starts, it will be renamed with a <u>.prev</u> suffix (overwriting  any  log
            file saved earlier) before diagnostics are generated to the new log file.

       <b>-N</b>, <b>--showme</b>
            This  option enables a ``show me'' mode, where the programs actions are echoed, but not executed, in
            the style of ``make -n''.  Using <b>-N</b> in conjunction with <b>-V</b> maximizes the diagnostic capabilities for
            debugging.

       <b>-V</b>, <b>--verbose</b>
            The output from the <b>cron</b> execution of the scripts may be extended using the <b>-V</b> option to the scripts
            which will enable verbose tracing of their activity.  By default  the  scripts  generate  no  output
            unless  some  error  or warning condition is encountered.  Using <b>-N</b> in conjunction with <b>-V</b> maximizes
            the diagnostic capabilities for debugging.

       <b>-?</b>, <b>--help</b>
            Display usage message and exit.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       The command line options passed to <b>pmie</b> and <b>pmlogger</b> can be customized via the  <u>$PCP_SYSCONFIG_DIR/pmfind</u>
       configuration file.

       Refer  to the <b>pmie_check</b> and <b>pmlogger_check</b> manual pages for details of the control file format generated
       by <b>pmfind_check</b>.

       By default, each collector system <b>pmie</b> logfile will be created in <b>$PCP_LOG_DIR/pmie/</b><u>source</u>  and  <b>pmlogger</b>
       archives  will  be  created  below  <b>$PCP_ARCHIVE_DIR/</b><u>source</u>.  This is consistent with the way <b><a href="../man1/pmie.1.html">pmie</a></b>(1) and
       <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) maintain their activity logs and archive files.

       Typical   <b><a href="../man5/crontab.5.html">crontab</a></b>(5)   entries   for    periodic    execution    of    <b>pmfind_check</b>    are    given    in
       <b>$PCP_SYSCONF_DIR/pmfind/crontab</b> (unless installed by default in <u><a href="file:/etc/cron.d">/etc/cron.d</a></u> already) and shown below.

       # every minute, discover remote PCP services
       *       *       *       *       *       $PCP_BINADM_DIR/pmfind_check
       When  using  <b><a href="../man1/systemd.1.html">systemd</a></b>(1) on Linux, no <b>crontab</b> entries are needed as the timer and path mechanisms provided
       by <b>systemd</b> are used instead.

</pre><h4><b>FILES</b></h4><pre>
       <u>$PCP_PMIECONTROL_PATH.d</u>
            PCP inference engine control files for each discovered metric source,  typically  one  per  host  or
            container.
            <b>Warning</b>: this files herein must not be writable by any user other than root.

       <u>$PCP_PMLOGGERCONTROL_PATH.d</u>
            PCP logger control files for each discovered metric source, typically one per host or container.
            <b>Warning</b>: this files herein must not be writable by any user other than root.

       <u>$PCP_SYSCONFIG_DIR/pmfind</u>
            default <b>pmie</b> and <b>pmlogger</b> command line arguments, and other parameters passed to <b>pmfind</b>.

       <u>$PCP_SYSCONF_DIR/pmfind/crontab</u>
            sample crontab for automated script execution by root - exists only if the platform does not support
            the <u><a href="file:/etc/cron.d">/etc/cron.d</a></u> mechanism.

</pre><h4><b>PCP</b> <b>ENVIRONMENT</b></h4><pre>
       Environment  variables with the prefix <b>PCP_</b> are used to parameterize the file and directory names used by
       PCP.  On each installation, the file <u>/etc/pcp.conf</u> contains the local values for  these  variables.   The
       <b>$PCP_CONF</b> variable may be used to specify an alternative configuration file, as described in <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1),  <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1),  <b><a href="../man1/pmfind.1.html">pmfind</a></b>(1),  <b><a href="../man1/pmie.1.html">pmie</a></b>(1),  <b><a href="../man1/pmie_check.1.html">pmie_check</a></b>(1),  <b><a href="../man1/pminfo.1.html">pminfo</a></b>(1),  <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1), <b><a href="../man1/pmlogger_check.1.html">pmlogger_check</a></b>(1),
       <b><a href="../man1/pmseries.1.html">pmseries</a></b>(1), <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man5/crontab.5.html">crontab</a></b>(5), and <b><a href="../man8/cron.8.html">cron</a></b>(8).

Performance Co-Pilot                                   PCP                                       <u><a href="../man1/PMFIND_CHECK.1.html">PMFIND_CHECK</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>