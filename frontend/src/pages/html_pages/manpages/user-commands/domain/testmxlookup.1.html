<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>testmxlookup - Look up mail servers for a domain</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/courier-base">courier-base_1.3.13-11_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       testmxlookup - Look up mail servers for a domain

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>testmxlookup</b> [@<u>ip-address</u> | --dnssec | --udpsize <u>n</u> | --sts | --sts-override=<u>mode</u> | --sts-purge] {<u>domain</u>}

       <b>testmxlookup</b> {--sts-expire | --sts-cache-disable | --sts-cache-enable | --sts-cache-enable=<u>size</u>}

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>testmxlookup</b> reports the names and IP addresses of mail servers that receive mail for the <u>domain</u>, as well
       as the <u>domain</u>'s published STS policy. This is useful in diagnosing mail delivery problems.

       <b>testmxlookup</b> sends a DNS MX query for the specified domain, followed by A/AAAA queries, if needed.
       <b>testmxlookup</b> lists the hostname and the IP address of every mail server, and its MX priority. The
       domain's strict transport security (STS) policy status, if one is published, precedes the mail server
       list.

   <b>DIAGNOSTICS</b>
       The error message “Hard error” indicates that the domain does not exist, or does not have any mail
       servers. The error message "Soft error" indicates a temporary error condition (usually a network failure
       of some sorts, or the local DNS server is down).

       “STS: testing” or “STS: enforcing” preceding the list of mail servers indicates that the domain publishes
       an STS policy.  “ERROR: STS Policy verification failed” appearing after an individual mail server
       indicates that the mail server's name does not meet the domain's STS policy.

       “STS: testing” or “STS: enforcing” by itself, with no further messages, indicates that all listed mail
       servers comply with the listed STS policy. If you are attempting to install your own STS policy this is a
       simple means of checking its validity.

   <b>OPTIONS</b>
       @ip-address
           Specify the DNS server's IP address, where to send the DNS query to, overriding the default DNS
           server addresses read from /etc/resolv.conf.

           “ip-address” must be a literal, numeric, IP address.

       --dnssec
           Enable the DNSSEC extension. If the DNS server has DNSSEC enabled, and the specified domain's DNS
           records are signed, the list of IP addresses is suffixed by “(DNSSEC)”, indicating a signed response.

           This is a diagnostic option. Older DNS servers may respond with an error, to a DNSSEC query.

       --udpsize <u>n</u>
           Specify that <u>n</u> is the largest UDP packet size that the DNS server may send. This option is only valid
           together with “--dnssec”. If “--dnssec” always returns an error, try “--udpsize 512” (the default
           setting is 1280 bytes, which is adequate for Ethernet, but other kinds of networks may impose lower
           limits).

       --sts
           Do not issue an MX query, and display the domain's raw STS policy file.

       --sts-cache-disable
           Turn off STS lookups, checking, and verification.  STS is enabled by default, but requires that a
           global systemwide list of SSL certificate authorities is available, and that <b>TLS_TRUSTCERTS</b> is
           specified in /etc/courier/courierd.  STS can be disabled, if needed.

       --sts-cache-enable
           Reenable STS lookups, checking, and verification, and set the size of the internal cache to its
           default value. Specify “=size” to enable and set a non-default cache size, a positive value
           indicating the approximate number of most recent domains whose STS policies get cached internally.

       --sts-override=<u>policy</u>
           Override the domain's STS enforcement mode.  <u>policy</u> is one of: “none”, “testing”, or “enforce”, and
           overrides the cached domain STS policy setting.

               <b>Note</b>
               This is a diagnostic or a testing tool.  Courier may eventually purge the cached policy setting,
               or the domain can update its policy, replacing the overridden setting.

       --sts-purge
           Remove the domain's cached STS policy, and retrieve and cache the domain's policy, again.

       --sts-expire
           Execute Courier's STS policy expiration process. Nothing happens unless /var/lib/courier/sts's size
           exceeds the configured cache size setting. The oldest cached policy files get removed to bring the
           cache size down to its maximum size.

   <b>STRICT</b> <b>TRANSPORT</b> <b>SECURITY</b>
       Courier automatically downloads and caches domains' STS policy files by default, in an internal cache
       with a default size of 1000 domains.

           <b>Note</b>

           The cache size setting is approximate.  Courier purges stale cache entries periodically, and the size
           of the cache can temporarily exceed its set size, by as much as a factor of two.
           /var/lib/courier/sts must be owned by courier:courier, and uses one file per mail domain. The maximum
           cache size depends on the capabilities of the underlying filesystem.

           <b>testmxlookup</b> must be executed with sufficient privileges to access the cache directory (by root, or
           by courier). Without sufficient privileges <b>testmxlookup</b> still attempts to use the cache directory
           even without write permissions on it, as long as it's accessible, and attempts to download the STS
           policy for a domain that's not already cached; but, of course, won't be able to save the downloaded
           policy in the cache directory.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/courier.8.html">courier</a></b>(8)[1], <b>RFC</b> <b>1035</b>[2], <b>RFC</b> <b>8461</b>[3].

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>Sam</b> <b>Varshavchik</b>
           Author

</pre><h4><b>NOTES</b></h4><pre>
        1. <b><a href="../man8/courier.8.html">courier</a></b>(8)
           <a href="http://www.courier-mta.org/courier.html">http://www.courier-mta.org/courier.html</a>

        2. RFC 1035
           https://www.ietf.org/rfc/rfc1035.txt

        3. RFC 8461
           https://www.ietf.org/rfc/rfc8461.txt

Courier Mail Server                                01/22/2022                                    <u><a href="../man1/TESTMXLOOKUP.1.html">TESTMXLOOKUP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>