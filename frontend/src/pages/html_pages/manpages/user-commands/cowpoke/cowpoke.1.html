<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cowpoke - Build a Debian source package in a remote cowbuilder instance</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/devscripts">devscripts_2.25.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cowpoke - Build a Debian source package in a remote cowbuilder instance

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>cowpoke</b> [<u>options</u>] <u>packagename.dsc</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Uploads a Debian source package to a <b>cowbuilder</b> host and builds it, optionally also signing and uploading
       the result to an incoming queue.

</pre><h4><b>OPTIONS</b></h4><pre>
       The following options are available:

       <b>--arch=</b><u>architecture</u>
              Specify  the  Debian architecture(s) to build for.  A space separated list of architectures may be
              used to build for all of them in a single pass.  Valid arch names  are  those  returned  by  <b><a href="../man1/dpkgarchitecture.1.html">dpkg-</a></b>
              <b><a href="../man1/dpkgarchitecture.1.html">architecture</a></b>(1) for <b>DEB_BUILD_ARCH</b>.

       <b>--dist=</b><u>distribution</u>
              Specify  the  Debian distribution(s) to build for.  A space separated list of distributions may be
              used to build for all of them in a single pass.  Either codenames (such as  <b>sid</b>,  or  <b>squeeze</b>)  or
              distribution  names  (such as <b>unstable</b>, or <b>experimental</b>) may be used, but you should usually stick
              to using one or the other consistently as this name may be used in file paths and  to  locate  old
              packages for comparison reporting.

              It  is  now  also possible to use locally defined names with this option, when used in conjunction
              with the <b>BASE_DIST</b> option in a configuration file.   This  permits  the  maintenance  and  use  of
              specially  configured  build  chroots,  which  can  source package dependencies from the backports
              archives or a local repository, or have other unusual configuration options set, without polluting
              the chroots you use for clean package builds intended for upload to the  main  repositories.   See
              the description of <b>BASE_DIST</b> below.

       <b>--buildd=</b><u>host</u>
              Specify the remote host to build on.

       <b>--buildd-user=</b><u>name</u>
              Specify the remote user to build as.

       <b>--create</b>
              Create  the  remote <b>cowbuilder</b> root if it does not already exist.  If this option is not passed it
              is an error for the specified <b>--dist</b> or <b>--arch</b> to not have an  existing  <b>cowbuilder</b>  root  in  the
              expected location.

              The  <b>--buildd-user</b>  must  have  permission to create the <b>RESULT_DIR</b> on the build host, or an admin
              with the necessary permission must first create it and give that user (or some group they are  in)
              write access to it, for this option to succeed.

       <b>--return=</b>[<u>path</u>]
              Copy  results  of  the  build  to <u>path</u>.  If <u>path</u> is not specified, then return them to the current
              directory. The given <u>path</u> must exist, it will not be created.

       <b>--no-return</b>
              Do not copy results of the build to <b>RETURN_DIR</b> (overriding a path set for it in the  configuration
              files).

       <b>--dpkg-opts=</b><u>'opt1</u> <u>opt2</u> <u>...'</u>
              Specify  additional  options to be passed to <b><a href="../man1/dpkg-buildpackage.1.html">dpkg-buildpackage</a></b>(1).  Multiple options are delimited
              with spaces.  This will override any  options  specified  in  <b>DEBBUILDOPTS</b>  in  the  build  host's
              <u>pbuilderrc</u>.

       <b>--create-opts=</b><u>'cowbuilder</u> <u>option'</u>
              Specify  additional  arguments  to be passed verbatim to <b>cowbuilder</b> when a chroot is first created
              (using the <b>--create</b> option above). If multiple arguments need to be passed, this option should  be
              specified separately for each of them.

              E.g., <b>--create-opts</b> <b>"--othermirror"</b> <b>--create-opts</b> <b>"deb</b> <b>http://</b> <b>..."</b>

              This  option  will  override  any  <b>CREATE_OPTS</b> specified for a chroot in the cowpoke configuration
              files.

       <b>--update-opts=</b><u>'cowbuilder</u> <u>option'</u>
              Specify additional arguments to be passed verbatim to <b>cowbuilder</b> if the  base  of  the  chroot  is
              updated.   If multiple arguments need to be passed, this option should be specified separately for
              each of them.

              This option will override any <b>UPDATE_OPTS</b> specified for a  chroot  in  the  cowpoke  configuration
              files.

       <b>--build-opts=</b><u>'cowbuilder</u> <u>option'</u>
              Specify  additional  arguments  to  be  passed  verbatim  to  <b>cowbuilder</b>  when  a package build is
              performed.  If multiple arguments need to be passed, this option should  be  specified  separately
              for each of them.

              This  option  will  override  any  <b>BUILD_OPTS</b>  specified for a chroot in the cowpoke configuration
              files.

       <b>--sign=</b><u>keyid</u>
              Specify the key to sign packages with.  This will override any <b>SIGN_KEYID</b> specified for  a  chroot
              in the cowpoke configuration files.

       <b>--upload=</b><u>queue</u>
              Specify  the  dput  queue  to  upload  signed  packages  to.   This will override any <b>UPLOAD_QUEUE</b>
              specified for a chroot in the cowpoke configuration files.

       <b>--help</b> Display a brief summary of the available options and current configuration.

       <b>--version</b>
              Display the current version information.

</pre><h4><b>CONFIGURATION</b> <b>OPTIONS</b></h4><pre>
       When <b>cowpoke</b> is run the following configuration options are read from global, per-user,  and  per-project
       configuration files if present.  File paths may be absolute or relative, the latter being relative to the
       <b>BUILDD_USER</b>'s  home  directory.  Since the paths are typically quoted when used, tilde expansion will <b>not</b>
       be performed on them.

   <b>Global</b> <b>defaults</b>
       These apply to every <u>arch</u> and <u>dist</u> in a single cowpoke invocation.

       <b>BUILDD_HOST</b>
              The network address or fqdn of the build machine where <b>cowbuilder</b>  is  configured.   This  may  be
              overridden by the <b>--buildd</b> command line option.

       <b>BUILDD_USER</b>
              The  unprivileged  user name for operations on the build machine.  This defaults to the local name
              of the user executing <b>cowpoke</b> (or to a username that is specified in your  SSH  configuration  for
              <b>BUILDD_HOST</b>), and may be overridden by the <b>--buildd-user</b> command line option.

       <b>BUILDD_ARCH</b>
              The  Debian  architecture(s) to build for.  This must match the <b>DEB_BUILD_ARCH</b> of the build chroot
              being used.  It defaults to the local machine architecture where <b>cowpoke</b> is executed, and  may  be
              overridden  by  the  <b>--arch</b> command line option.  A (quoted) space separated list of architectures
              may be used here to build for all of them in a single pass.

       <b>BUILDD_DIST</b>
              The Debian distribution(s) to build for.  A (quoted) space separated list of distributions may  be
              used to build for all of them in a single pass.  This may be overridden by the <b>--dist</b> command line
              option.

       <b>INCOMING_DIR</b>
              The  directory  path on the build machine where the source package will initially be placed.  This
              must be writable by the <b>BUILDD_USER</b>.

       <b>PBUILDER_BASE</b>
              The filesystem root for all pbuilder CoW and result files.  <u>Arch</u> and <u>dist</u> specific  subdirectories
              will  normally  be  created  under this.  The apt cache and temporary build directory will also be
              located under this path.

       <b>SIGN_KEYID</b>
              If this option is set, it is expected to contain the gpg key ID  to  pass  to  <b><a href="../man1/debsign.1.html">debsign</a></b>(1)  if  the
              packages  are to be remotely signed.  You will be prompted to confirm whether you wish to sign the
              packages after all builds are complete.  If this option is unset or an empty string, no attempt to
              sign packages will be made.  It may be overridden on an <u>arch</u> and <u>dist</u>  specific  basis  using  the
              <u>arch_dist</u><b>_SIGN_KEYID</b>  option  described  below,  or  per-invocation  with  the <b>--sign</b> command line
              option.

       <b>UPLOAD_QUEUE</b>
              If this option is set, it is expected to contain a 'host' specification for <b><a href="../man1/dput.1.html">dput</a></b>(1) which will  be
              used  to  upload  them after they are signed.  You will be prompted to confirm whether you wish to
              upload the packages after they are signed.  If this option is unset or an empty string, no attempt
              to upload packages will be made.  If <b>SIGN_KEYID</b> is not set, this option will be ignored  entirely.
              It  may  be  overridden on an <u>arch</u> and <u>dist</u> specific basis using the <u>arch_dist</u><b>_UPLOAD_QUEUE</b> option
              described below, or per-invocation with the <b>--upload</b> command line option.

       <b>BUILDD_ROOTCMD</b>
              The command to use to gain root privileges on the remote build machine.  If unset the  default  is
              <b><a href="../man8/sudo.8.html">sudo</a></b>(8).   This is only required to invoke <b>cowbuilder</b> and allow it to enter its chroot, so you may
              restrict this user to only being able to run that command with  escalated  privileges.   Something
              like  this  in  sudoers  will  enable  invoking  <b>cowbuilder</b>  without  an additional password entry
              required:

                      youruser ALL = NOPASSWD: /usr/sbin/cowbuilder

              Alternatively you could use SSH with a forwarded key, or whatever other mechanism suits your local
              access policy.  Using <b>su</b> <b>-c</b> isn't really suitable here  due  to  its  quoting  requirements  being
              somewhat different to the rest.

       <b>DEBOOTSTRAP</b>
              The utility to use when creating a new build root.  Alternatives are <b>debootstrap</b> or <b>cdebootstrap</b>.

       <b>RETURN_DIR</b>
              If  set,  package files resulting from the build will be copied to the path (local or remote) that
              this is set to, after the build completes.  The path must exist, it will  not  be  created.   This
              option is unset by default and can be overridden with <b>--return</b> or <b>--no-return</b>.

   <b>Arch</b> <b>and</b> <b>dist</b> <b>specific</b> <b>options</b>
       These  are  variables  of  the  form:  $arch_$dist<b>_VAR</b> which apply only for a particular target arch/dist
       build.

       <u>arch_dist</u><b>_RESULT_DIR</b>
              The directory path on the build machine where the resulting packages (source and binary)  will  be
              found,  and  where  older versions of the package that were built previously may be found.  If any
              such older packages exist, <b>debdiff</b> will be used to compare  the  new  package  with  the  previous
              version  after  the build is complete, and the result will be included in the build log.  Files in
              it must be readable by the <b>BUILDD_USER</b> for sanity checking with <b><a href="../man1/lintian.1.html">lintian</a></b>(1) and <b><a href="../man1/debdiff.1.html">debdiff</a></b>(1), and for
              upload with <b><a href="../man1/dput.1.html">dput</a></b>(1).  If this option is not specified for some arch and dist combination  then  it
              will default to <u>$PBUILDER_BASE/$arch/$dist/result</u>

       <u>arch_dist</u><b>_BASE_PATH</b>
              The  directory where the CoW master files are to be found (or created if the <b>--create</b> command line
              option was passed).  If this option is not specified for some arch or dist then it will default to
              <u>$PBUILDER_BASE/$arch/$dist/base.cow</u>

       <u>arch_dist</u><b>_BASE_DIST</b>
              The code name to pass as the <b>--distribution</b> option  for  cowbuilder  instead  of  <u>dist</u>.   This  is
              necessary  when  <u>dist</u>  is  a  locally significant name assigned to some specially configured build
              chroot, such as 'wheezy_backports', and not the formal suite name of a  distro  release  known  to
              debootstrap.   This  option  cannot  be  overridden on the command line, since it would rarely, if
              ever, make any sense to change it for individual invocations of <b>cowpoke</b>. If  this  option  is  not
              specified for an arch and dist combination then it will default to <u>dist</u>.

       <u>arch_dist</u><b>_CREATE_OPTS</b>
              A  bash  array  containing  additional  options to pass verbatim to <b>cowbuilder</b> when this chroot is
              created for the first time (using  the  <b>--create</b>  option).   This  is  useful  when  options  like
              <b>--othermirror</b>  are  wanted to create specialised chroot configurations such as 'wheezy_backports'.
              By default this is unset.  All values set in it will be overridden if the <b>--create-opts</b> option  is
              passed on the command line.

              Each  element  in  this  array  corresponds  to a single argument (in the ARGV sense) that will be
              passed to cowbuilder.  This ensures that arguments which may contain whitespace  or  have  strange
              quoting  requirements  or  other  special  characters  will  not  be  mangled  before  they get to
              cowbuilder.

              Bash arrays are initialised using the following form:

                  OPTS=( "arg1" "arg 2" "--option" "value" "--opt=val" "etc. etc." )

       <u>arch_dist</u><b>_UPDATE_OPTS</b>
              A bash array containing additional options to pass verbatim to <b>cowbuilder</b> each time  the  base  of
              this  chroot  is updated.  It behaves similarly to the <b>CREATE_OPTS</b> option above, except for acting
              when the chroot is updated.

       <u>arch_dist</u><b>_BUILD_OPTS</b>
              A bash array containing additional options to pass verbatim to  <b>cowbuilder</b>  each  time  a  package
              build  is  performed in this chroot.  This is useful when you want to use some option like <b>--twice</b>
              which cowpoke does not directly need to care about.  It otherwise behaves similarly to <b>UPDATE_OPTS</b>
              above except that it acts during the build phase of <b>cowbuilder</b>.

       <u>arch_dist</u><b>_SIGN_KEYID</b>
              An optional arch and dist specific override for the global <b>SIGN_KEYID</b> option.

       <u>arch_dist</u><b>_UPLOAD_QUEUE</b>
              An optional arch and dist specific override for the global <b>UPLOAD_QUEUE</b> option.

</pre><h4><b>CONFIGURATION</b> <b>FILES</b></h4><pre>
       <u>/etc/cowpoke.conf</u>
              Global configuration options.  Will override hardcoded defaults.

       <u><a href="file:~/.cowpoke">~/.cowpoke</a></u>
              Per-user configuration options.  Will override any global configuration.

       <u>.cowpoke</u>
              Per-project configuration options.  Will override any per-user or global configuration if  <b>cowpoke</b>
              is called from the directory where they exist.

              If  the  environment  variable  <b>COWPOKE_CONF</b> is set, it specifies an additional configuration file
              which will override all of those above.  Options specified explicitly on the command line override
              all configuration files.

</pre><h4><b>COWBUILDER</b> <b>CONFIGURATION</b></h4><pre>
       There is nothing particularly special required to configure a <b>cowbuilder</b> instance for use  with  <b>cowpoke</b>.
       Simply  create  them  in  the  flavour you require with `<b>cowbuilder</b> <b>--create</b>` according to the <b>cowbuilder</b>
       documentation, then configure <b>cowpoke</b> with the user, arch, and path information required to access it, on
       the machines you wish to invoke it from (or alternatively configure  <b>cowpoke</b>  with  the  path,  arch  and
       distribution  information  and  pass  the <b>--create</b> option to it on the first invocation).  The build host
       running <b>cowbuilder</b> does not require <b>cowpoke</b> installed locally.

       The build machine should have the  <b>lintian</b>  and  <b>devscripts</b>  packages  installed  for  post-build  sanity
       checking.   Upon  completion,  the  build log and the results of automated checks will be recorded in the
       <b>INCOMING_DIR</b>.  If you wish to upload signed packages the build machine will also need  <b><a href="../man1/dput.1.html">dput</a></b>(1)  installed
       and  configured  to use the '<u>host</u>' alias specified by <b>UPLOAD_QUEUE</b>.  If <b><a href="../man1/rsync.1.html">rsync</a></b>(1) is available on both the
       local and build machine, then it will be used to transfer the source  package  (this  may  save  on  some
       transfers of the <u>orig.tar.*</u> when building subsequent Debian revisions).

       The  user executing <b>cowpoke</b> must have SSH access to the build machine as the <b>BUILDD_USER</b>.  That user must
       be able to invoke <b>cowbuilder</b> as root by using the <b>BUILDD_ROOTCMD</b>.  Signing keys are not  required  to  be
       installed  on  the build machine (and will be ignored there if they are).  If the package is signed, keys
       will be expected on the machine that executes <b>cowpoke</b>.

       When <b>cowpoke</b> is invoked, it will first attempt to update the <b>cowbuilder</b> image if  that  has  not  already
       been  done  on  the  same  day.   This is checked by the presence or absence of a <u>cowbuilder-$arch-$dist-</u>
       <u>update-log-$date</u> file in the <b>INCOMING_DIR</b>.  You may move, remove, or touch this  file  if  you  wish  the
       image  to  be updated more or less often than that.  Its contents log the output of <b>cowbuilder</b> during the
       update (or creation) of the build root.

</pre><h4><b>NOTES</b></h4><pre>
       Since <b>cowbuilder</b> creates a chroot, and to do that you need root, <b>cowpoke</b> also  requires  some  degree  of
       root access.  So all the horrible things that can go wrong with that may well one day rain down upon you.
       <b>cowbuilder</b> has been known to accidentally wipe out bind-mounted filesystems outside the chroot, and worse
       than  that  can easily happen.  So be careful, keep good backups of things you don't want to lose on your
       build machine, and use <b>cowpoke</b> to keep all that on a machine that isn't your bleeding edge dev  box  with
       your last few hours of uncommitted work.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/cowbuilder.1.html">cowbuilder</a></b>(1), <b><a href="../man1/pbuilder.1.html">pbuilder</a></b>(1), <b><a href="../man1/ssh-agent.1.html">ssh-agent</a></b>(1), <b><a href="../man5/sudoers.5.html">sudoers</a></b>(5)

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>cowpoke</b> was written by Ron &lt;<u><a href="mailto:ron@debian.org">ron@debian.org</a></u>&gt;.

                                                 April 28, 2008                                       <u><a href="../man1/COWPOKE.1.html">COWPOKE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>