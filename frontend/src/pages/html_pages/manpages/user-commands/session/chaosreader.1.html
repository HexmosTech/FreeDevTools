<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chaosreader - trace network sessions and export it to html format</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/chaosreader">chaosreader_0.96-13_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>chaosreader</b> - trace network sessions and export it to html format

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>chaosreader</b>

       <b>chaosreader</b> [<b>-adehiknqrvxAHIRTUXY</b>] [<b>-D</b> <u>dir</u>]
                   [<b>-b</b> port[,...]] [<b>-B</b> port[,...]]
                   [<b>-j</b> IPaddr[,...]] [<b>-J</b> IPaddr[,...]]
                   [<b>-l</b> port[,...]] [<b>-L</b> port[,...]] [<b>-m</b> bytes[k]]
                   [<b>-M</b> bytes[k]] [<b>-o</b> "time"|"size"|"type"|"ip"]
                   [<b>-p</b> port[,...]] [<b>-P</b> port[,...]]
                   <b>infile</b> [<u>infile2</u> ...]

       <b>chaosreader</b> <b>-s</b> [<u>mins</u>] | <b>-S</b> [<u>mins</u>[,count]]
                   [<b>-z</b>] [<b>-f</b> 'filter']

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Chaosreader  traces TCP/UDP/others sessions and fetches application data from snoop or tcpdump logs. This
       is a type of "any-snarf" program, as it will fetch telnet sessions, FTP files, HTTP transfers (HTML, GIF,
       JPEG etc) and SMTP emails from the captured data inside network  traffic  logs.  A  html  index  file  is
       created  to that links to all the session details, including realtime replay programs for telnet, rlogin,
       IRC, X11 and VNC sessions. Chaosreader reports such as image reports and HTTP GET/POST content reports.

       It also creates replay programs for telnet sessions, so that you can play them back in realtime (or  even
       different speeds).

       Chaosreader  can  also  run  in  standalone mode, where it invokes tcpdump or snoop (a similar to tcpdump
       program for Solaris) to create the log files and then processes them.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a,</b> <b>--application</b>
              Create application session files (default).

       <b>-d,</b> <b>--preferdns</b>
              Show DNS names instead of IP addresses.

       <b>-e,</b> <b>--everything</b>
              Create HTML 2-way &amp; hex files for everything.

       <b>-h</b>     Print a brief help.

       <b>--help</b> Print verbose help (this) and version.

       <b>--help2</b>
              Print massive help.

       <b>-i,</b> <b>--info</b>
              Create info file.

       <b>-q,</b> <b>--quiet</b>
              Quiet, no output to screen.

       <b>-r,</b> <b>--raw</b>
              Create raw files.

       <b>-v,</b> <b>--verbose</b>
              Verbose.

       <b>-x,</b> <b>--index</b>
              Create index files (default).

       <b>-A,</b> <b>--noapplication</b>
              Exclude application session files.

       <b>-H,</b> <b>--hex</b>
              Include hex dumps (slow).

       <b>-I,</b> <b>--noinfo</b>
              Exclude info files.

       <b>-R,</b> <b>--noraw</b>
              Exclude raw files.

       <b>-T,</b> <b>--notcp</b>
              Exclude TCP traffic.

       <b>-U,</b> <b>--noudp</b>
              Exclude UDP traffic.

       <b>-Y,</b> <b>--noicmp</b>
              Exclude ICMP traffic.

       <b>-X,</b> <b>--noindex</b>
              Exclude index files.

       <b>-k,</b> <b>--keydata</b>
              Create extra files for keystroke analysis.

       <b>-n,</b> <b>--names</b>
              Include hostnames in hyperlinked HTTPlog (HTML)

       <b>-D</b> <u>dir</u><b>,</b> <b>--</b><u>dir</u> <u>dir</u>
              Output all files to this directory.

       <b>-b</b> <b>25,79,</b> <b>--playtcp</b> <b>25,79</b>
              Replay these TCP ports as well (playback).

       <b>-B</b> <b>36,42,</b> <b>--playudp</b> <b>36,42</b>
              Replay these UDP ports as well (playback).

       <b>-l</b> <b>7,79,</b> <b>--htmltcp</b> <b>7,79</b>
              Create HTML for these TCP ports as well.

       <b>-L</b> <b>7,123,</b> <b>--htmludp</b> <b>7,123</b>
              Create HTML for these UDP ports as well.

       <b>-m</b> <b>1k,</b> <b>--min</b> <b>1k</b>
              Min size of connection to save ("k" for Kb).

       <b>-M</b> <b>1024k,</b> <b>--max</b> <b>1k</b>
              Max size of connection to save ("k" for Kb)

       <b>-o</b> <b>size,</b> <b>--sort</b> <b>size</b>
              Sort Order: time/size/type/ip (Default time).

       <b>-p</b> <b>21,23,</b> <b>--port</b> <b>21,23</b>
              Only examine these ports (TCP &amp; UDP).

       <b>-P</b> <b>80,81,</b> <b>--noport</b> <b>80,81</b>
              Exclude these ports (TCP &amp; UDP).

       <b>-s</b> <b>5,</b> <b>--runonce</b> <b>5</b>
              Standalone. Run tcpdump/snoop for 5 <u>mins</u>.

       <b>-S</b> <b>5,10,</b> <b>--runmany</b> <b>5,10</b>
              Standalone, many. 10 samples of 5 <u>mins</u> each.

       <b>-S</b> <b>5,</b> <b>--runmany</b> <b>5</b>
              Standalone, endless. 5 min samples forever.

       <b>-z,</b> <b>--runredo</b>
              Standalone, redo. Rereads last run's logs.

       <b>-j</b> <b>10.1.2.1,</b> <b>--ipaddr</b> <b>10.1.2.1</b>
              Only examine these IPs.

       <b>-J</b> <b>10.1.2.1,</b> <b>--noipaddr</b> <b>10.1.2.1</b>
              Exclude these IPs.

       <b>-f</b> <b>'port</b> <b>7',</b> <b>--filter</b> <b>'port</b> <b>7'</b>
              With standalone, use this dump filter.

</pre><h4><b>OUTPUT</b> <b>FILES</b></h4><pre>
       Many files will be created, run this in a clean directory. Short example:

       <b>index.html</b>
              Html index (full details).

       <b>index.text</b>
              Text index.

       <b>index.file</b>
              File index for standalone redo mode.

       <b>image.html</b>
              HTML report of images.

       <b>getpost.html</b>
              HTML report of HTTP GET/POST requests.

       <b>session_0001.info</b>
              Info file describing TCP session #1.

       <b>session_0001.telnet.html</b>
              HTML colored 2-way capture (time sorted).

       <b>session_0001.telnet.raw</b>
              Raw data 2-way capture (time sorted).

       <b>session_0001.telnet.raw1</b>
              Raw 1-way capture (assembled) server-&gt;client.

       <b>session_0001.telnet.raw2</b>
              Raw 1-way capture (assembled) client-&gt;server.

       <b>session_0002.web.html</b>
              HTML colored 2-way.

       <b>session_0002.part_01.html</b>
              HTTP portion of the above, a HTML file.

       <b>session_0003.web.html</b>
              HTML colored 2-way.

       <b>session_0003.part_01.jpeg</b>
              HTTP portion of the above, a JPEG file.

       <b>session_0004.web.html</b>
              HTML colored 2-way.

       <b>session_0004.part_01.gif</b>
              HTTP portion of the above, a GIF file.

       <b>session_0005.part_01.ftp-data.gz</b>
              An FTP transfer, a gz file.

</pre><h4><b>CONVENTIONS</b></h4><pre>
       <b>session_*</b>
              TCP Sessions.

       <b>stream_*</b>
              UDP Streams.

       <b>icmp_*</b> ICMP packets.

       <b>index.html</b>
              HTML Index.

       <b>index.text</b>
              Text Index.

       <b>index.file</b>
              File Index for standalone redo mode only.

       <b>image.html</b>
              HTML report of images.

       <b>getpost.html</b>
              HTML report of HTTP GET/POST requests.

       <b>*.info</b> Info file describing the Session/Stream.

       <b>*.raw</b>  Raw data 2-way capture (time sorted).

       <b>*.raw1</b> Raw 1-way capture (assembled) server-&gt;client.

       <b>*.raw2</b> Raw 1-way capture (assembled) client-&gt;server.

       <b>*.replay</b>
              Session replay program (perl).

       <b>*.partial.*</b>
              Partial capture (tcpdump/snoop were aware of drops).

       <b>*.hex.html</b>
              2-way Hex dump, rendered in colored HTML.

       <b>*.hex.text</b>
              2-way Hex dump in plain text.

       <b>*.X11.replay</b>
              X11 replay script (talks X11).

       <b>*.textX11.replay</b>
              X11 communicated text replay script (text only).

       <b>*.textX11.html</b>
              2-way text report, rendered in red/blue HTML.

       <b>*.keydata</b>
              Keystroke delay data file. Used for SSH analysis.

</pre><h4><b>MODES</b></h4><pre>
       <b>Normal</b> eg "<b>chaosreader</b> <b>infile</b>", this is where a tcpdump/snoop file was created previously and <b>chaosreader</b>
              reads and processes it.

       <b>Standalone</b> <b>once</b>
              eg "<b>chaosreader</b> <b>-s</b> 10" this is where <b>chaosreader</b> runs tcpdump/snoop and generates the log file, in
              this case for 10 minutes, and then processes the result.  Some OS's may not have tcpdump or  snoop
              available  so this will not work (instead you may be able to get Ethereal, run it, save to a file,
              then use normal mode).  There is a master index.html and the report index.html in a sub <u>dir</u>, which
              is of the format out_YYYYMMDD-hhmm, eg "out_20031003-2221".

       <b>Standalone,</b> <b>many</b>
              eg "<b>chaosreader</b> <b>-S</b> 5,12", this is where <b>chaosreader</b> runs  tcpdump/snoop  and  generates  many  log
              files,  in  this  case  it samples 12 times for 5 minutes each.  While this is running, the master
              index.html can be viewed to watch progress, which links to minor index.html reports  in  each  sub
              directory.

       <b>Standalone,</b> <b>redo</b>
              eg  "<b>chaosreader</b>  <b>-ve</b> <b>-z</b>", (the <b>-z</b>), this is where a standalone capture was previously performed -
              and now you would like to reprocess the logs - perhaps  with  different  options  (in  this  case,
              "<b>-ve</b>"). It reads index.file to determine which capture logs to read.

       <b>Standalone,</b> <b>endless</b>
              eg  "<b>chaosreader</b> <b>-S</b> 5", like standalone many - but runs forever (if you ever had the need?). Watch
              your disk space!

       Note: this is a work in progress, some of the code is a little unpolished.

</pre><h4><b>NOTES</b></h4><pre>
       •  Run <b>chaosreader</b> in an empty directory.

       •  Create small packet dumps. Chaosreader uses around 5x the dump size in memory. A 100Mb file could need
          500Mb of RAM to process.

       •  Your tcpdump may allow "<b>-s0</b>" (entire packet) instead of "<b>-s9000</b>".

       •  Beware of using too much disk space, especially standalone mode.

       •  If you capture too many small connections giving a huge index.html, try using the <b>-m</b> option to  ignore
          small connections. eg "<b>-m</b> 1k".

       •  snoop  logs may actually work better. Snoop logs are based on RFC1761, however there are many variants
          of tcpdump/libpcap and this program cannot read them all. If you have Ethereal you  can  create  snoop
          logs during the "save as" option. On Solaris use "snoop <b>-o</b> logfile".

       •  tcpdump logs may not be portable between OSs that use different sized timestamps or endian.

       •  Logs are best created in a memory filesystem for speed, usually /tmp.

       •  For  X11  or  VNC  playbacks,  first  practise by replaying a recent captured session of your own. The
          biggest problem is color depth, your screen must match  the  capture.  For  X11  check  authentication
          (xhost +), for VNC check the viewers options (<b>-8bit</b>, "Hextile", ...)

       •  SSH    analysis    can   be   performed   with   the   "sshkeydata"   program   as   demonstrated   on
          <a href="http://www.brendangregg.com/sshanalysis.html">http://www.brendangregg.com/sshanalysis.html</a> .  <b>chaosreader</b> provides the input files (*.keydata)  that
          sshkeydata analyses.

</pre><h4><b>BUGS</b></h4><pre>
       The following assumptions may cause problems (check for new vers):

       •  A  lower  port  number  =  the service type. Eg with ports 31247 and 23, the actual type of session is
          telnet (23). This may not work for some things (eg, VNC).

       •  Time based order is more important for 2-way sessions (eg telnet), SEQ order is more import for  1-way
          transfers (eg ftp-data).

       •  One particular TCP session isn't active for long enough that the SEQ number loops (or even wraps).

</pre><h4><b>EXAMPLES</b></h4><pre>
       •  Example 1:

           tcpdump -s9000 -w output1        # create tcpdump capture file

           chaosreader output1              # extract recognised sessions, or,

           chaosreader -ve output1          # gimme everything, or,

           chaosreader -p 20,21,23 output1  # only ftp and telnet...

       •  Example 2:

           snoop -o output1                 # create snoop capture file instead

           chaosreader output1              # extract recognised sessions...

       •  Example 3:

           chaosreader -S 2,5      # Standalone, sniff network 5 times for 2 mins
                                   each. View index.html for progress (or .text)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/tcpdump.8.html">tcpdump</a></b>(8), <b><a href="../man1M/snoop.1M.html">snoop</a></b>(1M), <b>chaosreader</b> help page.

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>chaosreader</b> was written by Brendan Gregg.

       This  manual  page  was  written by Joao Eriberto Mota Filho &lt;<a href="mailto:eriberto@debian.org">eriberto@debian.org</a>&gt; for the Debian project
       (but may be used by others).

chaosreader-0.96                                   18 Nov 2016                                    <u><a href="../man1/chaosreader.1.html">chaosreader</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>