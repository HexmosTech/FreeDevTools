<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>klog.krb5 - Authenticates to Kerberos and obtains a token</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/openafs-krb5">openafs-krb5_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       klog.krb5 - Authenticates to Kerberos and obtains a token

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>klog.krb5</b> [<b>-x</b>] [<b>-principal</b> &lt;<u>user</u> <u>name</u>&gt;]
           [-password &lt;<u>user's</u> <u>password</u>&gt;] [<b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;]
           [<b>-k</b> &lt;<u>realm</u>&gt;] [<b>-pipe</b>] [<b>-silent</b>]
           [<b>-lifetime</b> &lt;<u>ticket</u> <u>lifetime</u> <u>in</u> <u>hh[:mm[:ss]]</u>&gt;]
           [<b>-setpag</b>] [<b>-tmp</b>] [<b>-noprdb</b>] [<b>-unwrap</b>] [<b>-insecure_des</b>]
           [<b>-help</b>]

       <b>klog.krb5</b> [<b>-x</b>] [<b>-pr</b> &lt;<u>user</u> <u>name</u>&gt;]
           [<b>-pa</b> &lt;<u>user's</u> <u>password</u>&gt;]
           [<b>-c</b> &lt;<u>cell</u> <u>name</u>&gt;]
           <b>[-k</b> <b>&lt;</b><u><b>realm</b></u><b>&gt;]</b> [<b>-pi</b>] [<b>-si</b>]
           [<b>-l</b> &lt;<u>ticket</u> <u>lifetime</u> <u>in</u> <u>hh[:mm[:ss]]</u>&gt;]
           [<b>-se</b>] [<b>-t</b>] [<b>-n</b>] [<b>-u</b>] [<b>-i</b>] [<b>-h</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>klog.krb5</b> command obtains a Kerberos v5 ticket from a Kerberos KDC and, from the ticket, an AFS token
       and then stores it in the Cache Manager.  The Cache Manager keeps the token in kernel memory and uses it
       when obtaining authenticated access to the AFS filespace.  This command does not affect the issuer's
       identity (UNIX UID) on the local file system.

       By default, the command interpreter obtains a token for the AFS user name that matches the issuer's local
       user name.  To specify an alternate user, include the <b>-principal</b> argument.  The user named by the
       <b>-principal</b> argument does not have to appear in the local password file (the <u><a href="file:/etc/passwd">/etc/passwd</a></u> file or
       equivalent).

       By default, the command interpreter obtains a token for the local cell, as defined by the AFSCELL
       environment variable set in the command shell or by the <u>/etc/openafs/ThisCell</u> file on the local machine.
       To specify an alternate cell, include the <b>-cell</b> argument.  A user can have tokens in multiple cells
       simultaneously, but only one token per cell per connection to the client machine.  If the user's
       credential structure already contains a token for the requested cell, the token resulting from this
       command replaces it.

       By default, the command interpreter obtains a Kerberos ticket for the local realm.  To specify a
       different Kerberos realm, include the <b>-k</b> argument.  The Kerberos realm name need not match the AFS cell
       name.  <b>klog.krb5</b> will request a ticket for the principal "afs/<u>cell</u>" where <u>cell</u> is the cell name for which
       the user is requesting tokens, falling back on the principal "afs" if that principal does not work.

       The lifetime of the token resulting from this command is the smallest of the following:

       •   The maximum ticket lifetime recorded for the "afs/<u>cell</u>" principal in thet Kerberos database.

       •   The maximum ticket lifetime recorded in the specified user's Kerberos database entry.

</pre><h4><b>CAUTIONS</b></h4><pre>
       By default, this command does not create a new process authentication group (PAG); see the description of
       the  <b>pagsh</b> command to learn about PAGs.  If a cell does not use an AFS-modified login utility, users must
       include <b>-setpag</b> option to this command, or issue the <b>pagsh</b> command before this one, to have their  tokens
       stored  in  a  credential  structure that is identified by PAG rather than by local UID.  Users should be
       aware that <b>-setpag</b> will not work on some systems, most notably recent Linux systems, and using  <b>pagsh</b>  is
       preferrable and more reliable.

       When a credential structure is identified by local UID, the potential security exposure is that the local
       superuser  "root"  can use the UNIX <b>su</b> command to assume any other identity and automatically inherit the
       tokens associated with that UID.  Identifying the credential structure by PAG  makes  it  more  difficult
       (but not impossible) for the local superuser to obtain tokens of other users.

       If  the  <b>-password</b>  argument  is  used,  the specified password cannot begin with a hyphen, because it is
       interpreted as another option name.  Use of the <b>-password</b> argument is not recommended in any case.

       By default, it is possible to issue this command on a properly configured  NFS  client  machine  that  is
       accessing  AFS  via  the  NFS/AFS  Translator, assuming that the NFS client machine is a supported system
       type. However, if the translator machine's administrator  has  enabled  UID  checking  by  including  the
       <b>-uidcheck</b> <b>on</b> argument to the <b>fs</b> <b>exportafs</b> command, the command fails with an error message similar to the
       following:

          Warning: Remote pioctl to &lt;translator_machine&gt; has failed (err=8). . .
          Unable to authenticate to AFS because a pioctl failed.

       Enabling  UID  checking  means that the credential structure in which tokens are stored on the translator
       machine must be identified by a UID that matches the local UID of the process that is placing the  tokens
       in  the  credential  structure.   After  the  <b>klog.krb5</b>  command interpreter obtains the token on the NFS
       client, it passes it to the remote executor daemon on the translator machine, which makes the system call
       that stores the token in a credential structure on the translator machine.  The remote executor generally
       runs as the local superuser "root", so in most cases its local UID (normally zero)  does  not  match  the
       local UID of the user who issued the <b>klog.krb5</b> command on the NFS client machine.

       Issuing  the  <b>klog.krb5</b>  command  on  an  NFS  client  machine  creates  a security exposure: the command
       interpreter passes the token across the network to the remote executor daemon in clear text mode.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-x</b>  Appears only for backwards compatibility.  Its former function is now the default  behavior  of  this
           command.

       <b>-principal</b> &lt;<u>user</u> <u>name</u>&gt;
           Specifies the user name to authenticate.  If this argument is omitted, the default value is the local
           user name.

       <b>-password</b> &lt;<u>user's</u> <u>password</u>&gt;
           Specifies  the  issuer's  password  (or  that  of  the  alternate  user  identified by the <b>-principal</b>
           argument).  Omit this argument to have the command interpreter prompt for the password, in which case
           it does not echo visibly in the command shell.

       <b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;
           Specifies the cell for which to obtain a token.  During a single login session on a given machine,  a
           user can be authenticated in multiple cells simultaneously, but can have only one token at a time for
           each  of  them (that is, can only authenticate under one identity per cell per session on a machine).
           It is acceptable to abbreviate the cell name to the shortest form  that  distinguishes  it  from  the
           other  cells listed in the <u>/etc/openafs/CellServDB</u> file on the client machine on which the command is
           issued.

           If this argument is omitted, the command is executed in the local cell, as defined

           •   First, by the value of the environment variable AFSCELL.

           •   Second, in the <u>/etc/openafs/ThisCell</u> file on the client machine on which the command is issued.

       <b>-k</b> &lt;<u>realm</u>&gt;
           Obtain tickets and tokens from the &lt;<u>realm</u>&gt; Kerberos realm.  If this option is  not  given,  <b>klog.krb5</b>
           defaults to using the default local realm.  The Kerberos realm name need not match the AFS cell name.

       <b>-pipe</b>
           Suppresses  all  output  to  the  standard  output  stream, including prompts and error messages. The
           <b>klog.krb5</b> command interpreter expects to receive the password from the standard input stream. Do  not
           use this argument; it is designed for use by application programs rather than human users.

       <b>-silent</b>
           Suppresses  some  of  the  trace  messages that the <b>klog.krb5</b> command produces on the standard output
           stream by default.  It still reports on major problems encountered.

       <b>-lifetime</b> &lt;<u>ticket</u> <u>lifetime</u>
           This option is not implemented by <b>klog.krb5</b> and has no effect.

       <b>-setpag</b>
           Creates a process authentication group  (PAG)  prior  to  requesting  authentication.  The  token  is
           associated with the newly created PAG.

       <b>-tmp</b>
           Creates  a  Kerberos-style  ticket  file  rather than only obtaining tokens.  The ticket file will be
           stored in the default Kerberos ticket cache location, which is usually in the <u><a href="file:/tmp">/tmp</a></u> directory  of  the
           local machine (but depends on the Kerberos implementation used).

       <b>-noprdb</b>
           By  default,  <b>klog.krb5</b>  looks up the user's AFS ID in the Protection Server and associates the token
           with that AFS ID.  This is helpful when looking at the output of commands  like  <b>tokens</b>  but  is  not
           required.   If  this  option is given, this behavior is suppressed and <b>klog.krb5</b> will store the token
           under a generic name.  You may wish this if, for example, you have problems contacting the Protection
           Server for an AFS cell for some reason.

       <b>-unwrap</b>
           Normally, <b>klog.krb5</b> uses the Kerberos service ticket for the AFS principal as the AFS token.  If this
           option is given, <b>klog.krb5</b> creates a different, simplified AFS token form based on the service ticket
           (the so-called "rxkad 2b" token).  Normally, this is not necessary.  However, if you are using  older
           OpenAFS  software  that  cannot handle large ticket sizes in conjunction with Active Directory as the
           Kerberos server, using <b>-unwrap</b> can shrink the AFS token size so that older  software  can  handle  it
           more easily.

       <b>-insecure_des</b>
           Configures  libkrb5 to allow the use of the (insecure) single-DES encryption types.  When rxkad-k5 is
           in use, this is not needed.

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>OUTPUT</b></h4><pre>
       If the <b>-tmp</b> flag is included, the following message confirms that a Kerberos ticket cache was created:

          Wrote ticket file to /tmp/krb5cc_1000_rENJoZ

       The path to the cache will vary, of course.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Most often, this command is issued  without  arguments.  The  appropriate  password  is  for  the  person
       currently  logged  into  the  local  system.   The  ticket's  lifetime  is  calculated  as  described  in
       "DESCRIPTION".

          % klog.krb5
          Password for <a href="mailto:user@EXAMPLE.ORG">user@EXAMPLE.ORG</a>:

       The following example authenticates the user as admin in the Example Corporation's test cell:

          % klog.krb5 -principal admin -cell test.example.com
          Password for <a href="mailto:admin@EXAMPLE.COM">admin@EXAMPLE.COM</a>:

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       None

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/aklog.1.html">aklog</a></b>(1), <b><a href="../man1/fs_exportafs.1.html">fs_exportafs</a></b>(1), <b><a href="../man1/pagsh.1.html">pagsh</a></b>(1), <b><a href="../man1/tokens.1.html">tokens</a></b>(1)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       IBM Corporation 2000. &lt;<a href="http://www.ibm.com/">http://www.ibm.com/</a>&gt; All Rights Reserved.

       This documentation is covered by the IBM Public License Version 1.0.  It was converted from HTML  to  POD
       by  software  written  by  Chas  Williams  and Russ Allbery, based on work by Alf Wachsmann and Elizabeth
       Cassell.

OpenAFS                                            2025-03-21                                       <u><a href="../man1/KLOG.KRB5.1.html">KLOG.KRB5</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>