<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>glab-cluster-agent-bootstrap - Bootstrap a GitLab Agent for Kubernetes in a project.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/glab">glab_1.49.0-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       glab-cluster-agent-bootstrap - Bootstrap a GitLab Agent for Kubernetes in a project.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>glab</b> <b>cluster</b> <b>agent</b> <b>bootstrap</b> <b>agent-name</b> <b>[flags]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Bootstrap a GitLab Agent for Kubernetes (agentk) in a project.

       The first argument must be the name of the agent.

       It requires the kubectl and flux commands to be accessible via $PATH.

       This command consists of multiple idempotent steps:

                1. Register the agent with the project.

                2. Configure the agent.

                3. Configure an environment with dashboard for the agent.

                4. Create a token for the agent.

                   • If  the  agent has reached the maximum amount of tokens, the one that has not been used the
                     longest is revoked and a new one is created.

                   • If the agent has not reached the maximum amount of tokens, a new one is created.

                5. Push the Kubernetes Secret that contains the token to the cluster.

                6. Create Flux HelmRepository and HelmRelease resource.

                7. Commit and Push the created Flux Helm resources to the manifest path.

                8. Trigger Flux reconciliation of GitLab Agent HelmRelease.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--create-environment</b>[=true]      Create an Environment for the GitLab Agent.

       <b>--environment-flux-resource-path</b>="helm.toolkit.fluxcd.io/v2beta1/namespaces//helmreleases/"          Flux
       Resource Path of the Environment for the GitLab Agent.

       <b>--environment-name</b>="/"      Name of the Environment for the GitLab Agent.

       <b>--environment-namespace</b>=""      Kubernetes namespace of the Environment for the GitLab Agent.

       <b>--flux-source-name</b>="flux-system"      Flux source name.

       <b>--flux-source-namespace</b>="flux-system"      Flux source namespace.

       <b>--flux-source-type</b>="git"      Source type of the flux-system, e.g. git, oci, helm, ...

       <b>--gitlab-agent-token-secret-name</b>="gitlab-agent-token"       Name  of  the  Secret where the token for the
       GitLab Agent is stored. The helm-release-target-namespace is implied for the namespace of the Secret.

       <b>--helm-release-filepath</b>="gitlab-agent-helm-release.yaml"      Filepath within the GitLab Agent project to
       commit the Flux HelmRelease to.

       <b>--helm-release-name</b>="gitlab-agent"      Name of the Flux HelmRelease manifest.

       <b>--helm-release-namespace</b>="flux-system"      Namespace of the Flux HelmRelease manifest.

       <b>--helm-release-target-namespace</b>="gitlab-agent"      Namespace of the GitLab Agent deployment.

       <b>--helm-release-values</b>=[]      Local path to values.yaml files

       <b>--helm-release-values-from</b>=[]      Kubernetes object reference that contains the values.yaml data key  in
       the format '/', where kind must be one of: (Secret,ConfigMap)

       <b>--helm-repository-filepath</b>="gitlab-helm-repository.yaml"      Filepath within the GitLab Agent project to
       commit the Flux HelmRepository to.

       <b>--helm-repository-name</b>="gitlab"      Name of the Flux HelmRepository manifest.

       <b>--helm-repository-namespace</b>="flux-system"      Namespace of the Flux HelmRepository manifest.

       <b>-b</b>,  <b>--manifest-branch</b>=""       Branch  to  commit the Flux Manifests to. (default to the project default
       branch)

       <b>-p</b>, <b>--manifest-path</b>=""      Location of directory in Git repository for  storing  the  GitLab  Agent  for
       Kubernetes Helm resources.

       <b>--no-reconcile</b>[=false]       Do  not  trigger  Flux  reconciliation  for GitLab Agent for Kubernetes Flux
       resource.

</pre><h4><b>OPTIONS</b> <b>INHERITED</b> <b>FROM</b> <b>PARENT</b> <b>COMMANDS</b></h4><pre>
       <b>--help</b>[=false]      Show help for this command.

       <b>-R</b>, <b>--repo</b>=""      Select another repository. Can use either <b>OWNER/REPO</b> or  <b>GROUP/NAMESPACE/REPO</b>  format.
       Also accepts full URL or Git URL.

</pre><h4><b>EXAMPLE</b></h4><pre>
       # Bootstrap "my-agent" to root of Git project in CWD and trigger reconciliation
       glab cluster agent bootstrap my-agent

       # Bootstrap "my-agent" to "manifests/" of Git project in CWD and trigger reconciliation
       # This is especially useful when "flux bootstrap gitlab --path manifests/" was used.
       # Make sure that the "--path" from the "flux bootstrap gitlab" command matches
       # the "--manifest-path" of the "glab cluster agent bootstrap" command.
       glab cluster agent bootstrap my-agent --manifest-path manifests/

       # Bootstrap "my-agent" to "manifests/" of Git project in CWD and do not manually trigger a reconilication
       glab cluster agent bootstrap my-agent --manifest-path manifests/ --no-reconcile

       # Bootstrap "my-agent" without configuring an environment
       glab cluster agent bootstrap my-agent --create-environment=false

       # Bootstrap "my-agent" and configure an environment with custom name and Kubernetes namespace
       glab cluster agent bootstrap my-agent --environment-name production --environment-namespace default

       # Bootstrap "my-agent" and pass additional GitLab Helm Chart values from a local file
       glab cluster agent bootstrap my-agent --helm-release-values values.yaml

       # Bootstrap "my-agent" and pass additional GitLab Helm Chart values from a Kubernetes ConfigMap
       glab cluster agent bootstrap my-agent --helm-release-values-from ConfigMap/agent-config

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/glab-cluster-agent.1.html">glab-cluster-agent</a>(1)</b>

Auto generated by spf13/cobra                       Nov 2024                                             <u><a href="../man1/glab.1.html">glab</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>