<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>maildirmake - create maildirs and maildir folders</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/maildrop">maildrop_3.1.8-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       maildirmake - create maildirs and maildir folders

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>maildirmake</b> [options...] {<u>maildir</u>}

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>maildirmake</b> command creates maildirs, and maildir folders and performs some routine maintenance on
       them. This documentation describes the <b>maildirmake</b> command from the Courier mail server, which creates an
       extended form of maildirs that implements additional extensions beyond the basic maildir properties that
       were first implemented in the Qmail mail server.

</pre><h4><b>OPTIONS</b></h4><pre>
       -S
           create a "sharable" maildir. A sharable maildir has slightly different permissions which allows
           creation of publicly-shared folders.

       -q <u>quota</u>
           install a quota on the maildir. See <b><a href="../man7/maildirquota.7.html">maildirquota</a></b>(7)[1] for more information. The specified maildir
           gets automatically created if it does not exist; otherwise the existing maildir's quota gets updated.
           <u>quota</u> may be:

           <u>####S</u>
               Specifies the quota in the total number of bytes for all messages.  “10000000S” specifies a quota
               of ten million bytes.

           <u>####C</u>
               Specifies the quota in the total number of messages in the maildir.  “10000S” specifies a quota
               of ten thousand messages.

       -f <u>folder</u>
           do not create a maildir, but create a folder in an existing maildir.

       -F <u>folder</u>
           Like the -f option, except that the folder's name is given using the system locale's character set.
           Non-Latin characters in the folder's name must be given to the -f option using IMAP's UTF8 encoding.
           The -F option takes the folder name specified using the console's character set.

       -s <u>mode</u>
           create a publicly accessible folder in an existing sharable maildir. First, use the <b>-S</b> option to
           create a sharable maildir. Then, run <b>maildirmake</b> again with the <b>-s</b> option to create publicly
           accessible folders.  <u>mode</u> is a comma-separated list of the following keywords: read - readonly
           folder, only you can write messages to this folder; write - anyone can read and write messages to
           this folder; group - only allow members of your own system group to access messages in this folder
           (instead of everyone).

       --add <u>name</u>=<u>pathname</u>, --del <u>name</u>
           create or delete the directories and links needed to access shared folders. See below for more
           information.

       --checkutf8 <u>maildir</u> <u>maildirfilter</u>
           Perform a sanity check to verify that a pre-unicode format maildir can be converted to a
           unicode-format maildir. See “Converting pre-unicode format maildirs”, below, for more information.

       --convutf8 <u>maildir</u> <u>maildirfilter</u>
           Convert a pre-unicode format maildir can be converted to a unicode-format maildir. See “Converting
           pre-unicode format maildirs”, below, for more information.

   <b>FOLDERS</b>
       This <b>maildirmake</b> command supports enhanced maildirs that contain folders.

       By itself, <b>maildirmake</b> makes a new subdirectory <u>maildir</u>, and creates all the necessary structures. The <b>-f</b>
       option creates a new "folder" within an existing <u>maildir</u>.  <u>maildir</u> must already exist, and the
       <b>maildirmake</b> command will create a new folder in the maildir.

       Folders are simply subdirectories inside the main maildir whose names start with a period, and which are
       themselves maildirs. For example, the command "<b>maildirmake</b> <b>-f</b> <b>Drafts</b> <b>mail/Maildir</b>" creates
       mail/Maildir/.Drafts, that has the usual tmp, new and cur. You MUST use the <b>-f</b> option, instead of
       specifying mail/Maildir/.Drafts directly, in order to correctly initialize certain enhanced maildir
       features.

       Folders cannot be created directly within other folders. Running <b>maildirmake</b> <b>-f</b> <b>Urgent</b>
       <b>mail/Maildir/.Drafts</b> will not work. Instead, the period character is designated as a hierarchy separator,
       run <b>maildirmake</b> <b>-f</b> <b>Drafts.Urgent</b> <b>mail/Maildir</b> instead. This creates mail/Maildir/.Drafts.Urgent, and all
       mail software that supports enhanced maildirs will interpret it as a subfolder Urgent of the Drafts
       folder.

   <b>SHARED</b> <b>FOLDERS</b>
       This is another extension to the Maildir format that allows folders to be shared between multiple
       clients.

           <b>Note</b>

           The Courier IMAP server implements two types of shared folders: filesystem permission-based shared
           folders, as well as virtual shared folders based on IMAP access control lists. Use the <b>maildirmake</b>
           command to implement shared folders based on filesystem permissions. The <b><a href="../man1/maildiracl.1.html">maildiracl</a></b>(1)[2] command
           manages access control lists, which are used by virtual shared folders.

           See the Courier IMAP server documentation for more information.

       First, you need to create a collection of sharable folders, as a separate maildir:

           <b>maildirmake</b> <b>-S</b> <b>/usr/local/share/maildirs/notices</b>

       Then, create individuals folders that will be accessed in shared mode:

           <b>maildirmake</b> <b>-s</b> <b>write</b> <b>-f</b> <b>Weekly</b> <b>/usr/local/share/maildirs/notices</b>

       In this example, the "Weekly" folder is created, with read/write access to everyone. Multiple folders can
       be created in the same maildir, with different access permissions. Everyone can create a sharable
       maildir. The access privileges for individual folders are set by the <b>-s</b> option, and are implemented using
       traditional filesystem permissions.

       Use the <b>--add</b> and <b>--del</b> options to add a sharable maildir to an existing maildir. Client software that
       implements this extension will now know where to find sharable folders:

           <b>maildirmake</b> <b>--add</b> <b>notices=/usr/local/share/maildirs/notices</b> <b>$HOME/Maildir</b>

       $HOME/Maildir is your main maildir. The argument to <b>-add</b> is <u>nick</u>=<u>path</u>.  <u>nick</u> is a nickname for this
       collection of sharable folders, and <u>path</u> is the location of the sharable maildir. All folders in the
       sharable maildir that you have access to -- such as "Weekly", in this case, will now be accessible.
       Multiple sharable maildirs can be added, by giving each one a unique <u>nick</u>.

       The <b>--del</b> option "disconnects" the sharable maildir from the main maildir.

   <b>GLOBAL</b> <b>SHARED</b> <b>FOLDERS</b>
       Normally <b>-add</b> command must be run for every maildir which needs to access the sharable maildir.
       Alternatively the file /etc/maildirshared can be created, to specify a default set of sharable maildirs.
       Each line in this file takes the following format:

           <u>nick</u>&lt;tab&gt;<u>path</u>

       <u>nick</u> is a short nickname for the sharable maildir, &lt;tab&gt; is a single tab character, <u>path</u> is the pathname
       to the sharable maildir.

   <b>ACCESSING</b> <b>SHARED</b> <b>FOLDERS</b>
       You may have read or write access to a shared folder. If you have write access, you can add messages to
       the shared folder. You can also delete messages that you've added.

       Anyone can create a sharable maildir, so if the sharable maildir is actually created by you, can can
       delete any message, not just your own.

</pre><h4><b>CONVERTING</b> <b>PRE-UNICODE</b> <b>FORMAT</b> <b>MAILDIRS</b></h4><pre>
       This section is relevant to:

       •   Updating Courier-IMAP to version 5.0, and later, from prior versions of Courier-IMAP, or:

       •   Updating SqWebmail to version 6.0, and later, from prior versions of SqWebmail, or:

       •   Updating Courier to version 1.0, and later, from prior versions of Courier.

       These versions have been updated to implement native Unicode support in several E-mail-related protocols.
       It is already expected that updating Internet standards to use native Unicode-formatted E-mail messages
       will not be 100% backwards-compatible, in terms of E-mail client support. Given that, this major update
       to Unicode will also introduce some backwards-incompatible changes to the internal structure of maildirs,
       as a major upgrade to simplify Unicode support going forward. Might as well go through the pain of a
       major upgrade once.

       <b>maildirmake</b>'s <b>--checkutf8</b> and <b>--convutf8</b> options are tools to aid in conversion of existing mailboxes to
       the new Unicode-based naming standard.

   <b>Background</b>
       Mail folders in a maildir are hidden subdirectories. For example: a folder name “Mailing list” is a
       maildir subdirectory named $HOME/Maildir/.Mailing list ($HOME/Maildir is the main mailbox).

       Prior to the unicode update, non-English characters in folder names used a convention based on the
       non-standard “modified-UTF7” encoding used by IMAP. A folder named “Résumé” is a maildir subdirectory
       named $HOME/Maildir/.R&amp;AOk-sum&amp;AOk-. The current versions of Courier, Courier-IMAP, and SqWebmail, now
       creates $HOME/Maildir/.Résumé using the UTF8 encoding. This appears as plain “.Résumé” (hidden)
       subdirectory on modern UTF8-based systems.

       Consequently, any existing maildirs with folders that use non-English names must be converted as part of
       updating to the current version of Courier, Courier-IMAP, and SqWebmail from pre-unicode versions. This
       does not happen automatically when updating to the current version. This must be done manually given the
       wide variety of individual mail server configurations that are possible.

   <b>Unicode</b> <b>conversion</b> <b>overview</b>
       Updating from pre-unicode versions involves:

       •   Renaming the actual maildir folders, $HOME/Maildir/.<u>names</u> into unicode names (using UTF8).

       •   Updating the $HOME/Maildir/courierimapsubscribed file, which is a list of subscribed IMAP folders, if
           it exists.

       •   Updating any maildrop mail filtering recipes, $HOME/.mailfilter, if it exists, to reference the
           unicode maildir folders; or updating any custom site mail filtering engine that delivers to maildir
           folders, to reference the correct subdirectory names.

   <b>Unicode</b> <b>conversion</b> <b>steps</b>
       The <b>--checkutf8</b> and <b>--convutf8</b> options to <b>maildirmake</b> convert a single maildir to the new unicode format:

           $ ./maildirmake --checkutf8 <a href="file:~/Maildir">~/Maildir</a> <a href="file:~/.mailfilter">~/.mailfilter</a>
           Checking /home/mrsam/Maildir:
           Mail filter to INBOX.R&amp;AOk-sum&amp;AOk- updated to INBOX.Résumé
           Subscription to INBOX.R&amp;AOk-sum&amp;AOk- changed to INBOX.Résumé
           Rename INBOX.R&amp;AOk-sum&amp;AOk- to INBOX.Résumé
           Verified /home/mrsam/Maildir/courierimapsubscribed
           Verified /home/mrsam/.mailfilter
           $ ./maildirmake --convutf8 <a href="file:~/Maildir">~/Maildir</a> <a href="file:~/.mailfilter">~/.mailfilter</a>
           Checking /home/mrsam/Maildir:
           Mail filter to INBOX.R&amp;AOk-sum&amp;AOk- updated to INBOX.Résumé
           Subscription to INBOX.R&amp;AOk-sum&amp;AOk- changed to INBOX.Résumé
           Rename INBOX.R&amp;AOk-sum&amp;AOk- to INBOX.Résumé
           Updating /home/mrsam/Maildir/courierimapsubscribed
           Updating /home/mrsam/.mailfilter

       <b>--checkutf8</b> goes through the motions of converting a single maildir to Unicode, but without making any
       actual changes.  <b>--convutf8</b> does the conversion for real. The first required parameter is the maildir to
       convert. The second parameter is optional, and specifies the corresponding <b>maildrop</b> filtering recipe, <u>but</u>
       <u>only</u> <u>if</u> <u>SqWebMail</u> generates the mail filtering recipes.  SqWebMail's mail filtering recipes are parsable,
       and can be automatically-converted. Non-SqWebMail-generated .mailfilters cannot be converted
       automatically. The second parameter must be omitted, and the mail filtering recipe must be converted by
       hand.

           <b>Note</b>

           All this work is only needed if maildirs have folders with non-English names. Ignore everything
           you've just read if all folder names are English-only.  <b>--checkutf8</b> and <b>--convutf8</b> will not do
           anything, and nothing needs to be done.

       To convert all mailboxes to Unicode all at once:

       •   A shell script needs to run the <b>--checkutf8</b> option for every mailbox. A list of all accounts'
           maildirs needs to be prepared in advance, together with the corresponding .mailfilters (where
           appropriate). courier-authlib's <b>authenumerate</b> command is usually a good starting point. It's ok to
           explicitly specify each mailbox's .mailfilter, when using SqWebMail even if a particular mailbox does
           not use it. It will be ignored. The list of all accounts' maildirs gets converted to a shell script
           that runs <b>maildirmake</b> with the <b>--checkutf8</b> option. The script should report any maildir whose
           <b>--checkutf8</b> option reports an error, and <b>maildirmake</b> exits with a non-zero status.

           It is safe to run <b>--checkutf8</b> without shutting down your mail server. A non-zero exit from
           <b>--checkutf8</b> indicates a problem (see below) for a particular maildir.

       •   Once <b>--checkutf8</b> does not find any problems with any mailbox, shut down the mail server, run
           <b>--checkutf8</b> one more time for all mailboxes, then if everything goes well, upgrade Courier,
           Courier-IMAP, or SqWebMail and run <b>--convutf8</b> on every mailbox before restarting the server.

           <b>Note</b>

           <b>--convutf8</b> is a one-shot deal. Do not run <b>--convutf8</b> a second time after it successfully converted a
           maildir. In nearly all cases nothing will happen, but there are rare edge cases where some folder
           names may get garbled, or it fails completely.

   <b>Resolving</b> <b>unicode</b> <b>conversion</b> <b>problems</b>
       The only likely problems that might be encountered is the fall-out from buggy IMAP clients that did not
       follow the pre-Unicode naming convention for non-Latin folder names. The customized IMAP “modified-UTF7”
       encoding convention for non-Latin folder names is mostly an IMAP client convention, and the pre-Unicode
       version of Courier-IMAP did not enforce it. The server took the name from the IMAP client, as is.

       Unicode conversion (<b>--checkutf8</b> or <b>--convutf8</b>) fails if it finds a folder name that does not correctly
       use IMAP's “modified-UTF7” encoding. This can only be resolved manually, by renaming the folder. This may
       also involve manually editing courierimapsubscribed and .mailfilter if they exist. The bad folder name
       should be removed from courierimapsubscribed. For .mailfilter it is sufficient to remove only the
       comments that precede the actual <b>maildrop</b> rule, and <b>--convutf8</b> will remove the entire rule, by itself.
       <b>--convutf8</b> actually reads only the machine-parsable comments in <b>SqWebMail</b>-generated .mailfilter (plus a
       few other things in the file), and replaces the .mailfilter with the Unicode version based solely on the
       parsed data.

   <b>After</b> <b>the</b> <b>Unicode</b> <b>conversion</b>
       The current, Unicode version of Courier-IMAP supports both Unicode and non-Unicode IMAP clients; however
       unlike the pre-Unicode version, Courier-IMAP rejects requests from non-Unicode IMAP clients to use or
       create folders that are not properly encoded.

       Encountering a bad folder during conversion strongly suggests the presence of an IMAP client that does
       not correctly encode non-English folder names. Such an IMAP client will likely have problems after the
       conversion.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/maildir.5.html">maildir</a></b>(5)[3], <b><a href="../man1/maildiracl.1.html">maildiracl</a></b>(1)[2], <b><a href="../man1/maildirkw.1.html">maildirkw</a></b>(1)[4], <b><a href="../man1/maildirwatch.1.html">maildirwatch</a></b>(1)[5], <b><a href="../man1/maildrop.1.html">maildrop</a></b>(1)[6], <b><a href="../man7/maildirquota.7.html">maildirquota</a></b>(7)[1],
       <b><a href="../man8/deliverquota.8.html">deliverquota</a></b>(8)[7], <b><a href="../man7/maildropfilter.7.html">maildropfilter</a></b>(7)[8].

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>Sam</b> <b>Varshavchik</b>
           Author

</pre><h4><b>NOTES</b></h4><pre>
        1. <b><a href="../man7/maildirquota.7.html">maildirquota</a></b>(7)
           <a href="http://www.courier-mta.org/maildirquota.html">http://www.courier-mta.org/maildirquota.html</a>

        2. <b><a href="../man1/maildiracl.1.html">maildiracl</a></b>(1)
           <a href="http://www.courier-mta.org/maildiracl.html">http://www.courier-mta.org/maildiracl.html</a>

        3. <b><a href="../man5/maildir.5.html">maildir</a></b>(5)
           <a href="http://www.courier-mta.org/maildir.html">http://www.courier-mta.org/maildir.html</a>

        4. <b><a href="../man1/maildirkw.1.html">maildirkw</a></b>(1)
           <a href="http://www.courier-mta.org/maildirkw.html">http://www.courier-mta.org/maildirkw.html</a>

        5. <b><a href="../man1/maildirwatch.1.html">maildirwatch</a></b>(1)
           <a href="http://www.courier-mta.org/maildirwatch.html">http://www.courier-mta.org/maildirwatch.html</a>

        6. <b><a href="../man1/maildrop.1.html">maildrop</a></b>(1)
           <a href="http://www.courier-mta.org/maildrop.html">http://www.courier-mta.org/maildrop.html</a>

        7. <b><a href="../man8/deliverquota.8.html">deliverquota</a></b>(8)
           <a href="http://www.courier-mta.org/deliverquota.html">http://www.courier-mta.org/deliverquota.html</a>

        8. <b><a href="../man7/maildropfilter.7.html">maildropfilter</a></b>(7)
           <a href="http://www.courier-mta.org/maildropfilter.html">http://www.courier-mta.org/maildropfilter.html</a>

Courier Mail Server                                04/08/2022                                     <u><a href="../man1/MAILDIRMAKE.1.html">MAILDIRMAKE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>