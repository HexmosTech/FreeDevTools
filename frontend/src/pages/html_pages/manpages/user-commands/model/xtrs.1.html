<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xtrs - TRS-80 Model I/III/4/4P emulator for the X Window System</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/xtrs">xtrs_4.9d-2.1_amd64</a> <br><br><pre>
</pre><h4><b>Name</b></h4><pre>
       <b>xtrs</b> - TRS-80 Model I/III/4/4P emulator for the X Window System

</pre><h4><b>Synopsis</b></h4><pre>
       <b>xtrs</b> [<b>-model</b> <u>m</u>] [<b>-diskdir</b> <u>d</u>] [<b>-debug</b>] [<u>other-options</u>]

</pre><h4><b>Description</b></h4><pre>
       <b>xtrs</b>  is  an emulator for a series of 8-bit microcomputers manufactured by Tandy/Radio Shack in the 1970s
       and 1980s.  The program is built on top of a Zilog Z80 emulator, with added routines to support  keyboard
       and video I/O through an X interface.  The hardware emulation can operate as a TRS-80 Model I, Model III,
       Model 4, or Model 4P.

       <b>xtrs</b>  supports 48kiB of RAM in Model I or Model III mode, and 128kiB in Model 4 or Model 4P mode.  Floppy
       disks and hard disks are emulated using files to store the data; or under Linux only, real floppy  drives
       can  be  used.   A  printer  is  emulated by sending its output to the standard output.  A serial port is
       emulated using a Unix terminal device.  Cassette I/O is emulated using files to store the cassette  data;
       real cassettes can also be read or written (with luck), either directly through your sound card (on Linux
       and other systems with OSS-compatible sound drivers), or via <u>.wav</u> files.  Game sound and music output are
       also supported if you have an OSS-compatible sound driver; sound output though the cassette port, through
       the  Model  4  sound  option,  and  through  the  optional Orchestra-85/90 music synthesizer card are all
       emulated.  In Model I mode, the HRG1B graphics card is emulated.  In Model III and  4/4P  mode,  you  can
       select  whether the Radio Shack graphics card or Micro Labs Grafyx Solution is emulated.  There is also a
       mouse driver for Model 4/4P mode.  Several common time-of-day clock cards are  emulated  on  all  models.
       The Alpha Products joystick is emulated using the keyboard's numeric keypad.

       Because <b>xtrs</b> emulates the hardware, all known TRS-80 Model I/III/4/4P operating systems should run on it,
       including  all  flavors of <u>TRSDOS</u>, <u>LDOS/LS-DOS</u>, <u>NEWDOS</u>, <u>DOSPLUS</u>, <u>MultiDOS</u>, and TRS-80 <u>CP/M</u>.  However, the
       emulator also includes some extensions to the standard hardware, and the special drivers, utilities,  and
       instructions needed for these are not provided for all operating systems.

       The  Z80 emulator has a debugger called <u>zbx</u>.  You can enter the debugger either by starting <b>xtrs</b> with the
       <b>-debug</b> flag or by pressing <b>F9</b> while <b>xtrs</b> is running.  The debugger runs in the X terminal window that you
       started <b>xtrs</b> from.  Once you are in the debugger, type <b>help</b> for more information.

       Special support in the emulator allows the program  to  block  when  waiting  for  information  from  the
       keyboard.   This  will work only for programs that wait for keyboard input using the standard Model I/III
       ROM call; the emulator decides whether to block the Z80 program when it tries to read from  the  keyboard
       memory by pattern-matching its stack.

   <b>Keys</b>
       The following keys on the host keyboard have special meanings to <b>xtrs</b>.

       <b>F11</b> toggles onscreen help on the keyboard mappings.

       <b>LeftArrow</b>,  <b>Backspace</b>, or <b>Delete</b> is the TRS-80 left arrow key.  <b>RightArrow</b> or <b>Tab</b> is the right arrow key.
       <b>UpArrow</b> is the up arrow key.  <b>DownArrow</b> or <b>Linefeed</b> is the down arrow key.  <b>Esc</b> or  <b>Break</b>  is  the  Break
       key.   <b>Home</b> or <b>Clear</b> is the Clear key.  <b>Control</b> is the Model 4 Ctrl key (address bit 7, data bit 2).  <b>F12</b>
       is equivalent to the shifted down arrow key (used as a control key with some TRS-80 software).

       <b>F1</b>, <b>F2</b>, and <b>F3</b> are the Model 4/4P function keys (address bit 7, data bits 4, 5, and 6).  <b>F1</b> is  also  the
       Model I Electric Pencil control key that some users added to their machines.  <b>F4</b> is the Model 4 Caps Lock
       key (address bit 7, data bit 3).  <b>F5</b>, <b>Compose</b>, or <b>ScrollLock</b> is equivalent to the @ key (so that @ can be
       used  as  a  modifier  key).   <b>F6</b>  is  equivalent to the 0 key (so that a shifted 0 can be obtained).  <b>F7</b>
       signals a floppy disk change (see <b>Emulated</b> <b>floppy</b> <b>disks</b>, below).  <b>F8</b> exits the program.   <b>F9</b>  enters  the
       <u>zbx</u> debugger.  <b>F10</b> is the reset button.

       In  Model III, 4, and 4P modes, the left and right <b>Shift</b> keys are distinct; in Model I mode, they are the
       same.  The <b>PageUp</b> and <b>PageDown</b> keys always activate the positions that correspond to the  Model  III/4/4P
       left and right shift keys (address bit 7, data bits 0 and 1 respectively), even in Model I mode.  The <b>End</b>
       key activates an unused position in the keyboard matrix (address bit 7, data bit 7).

       The  keys  <b>[</b>,  <b>\</b>,  <b>]</b>, <b>^</b>, and <b>_</b> also activate unused positions in the keyboard matrix (address bit 3, data
       bits 3–7), as do the ASCII-shifted counterparts of the first four (<b>{</b>, <b>|</b>, <b>}</b>, and <b>~</b>); see  above  regarding
       <b>Delete</b>.   With  many  TRS-80 keyboard drivers, these keys map to the corresponding ASCII characters; with
       others, they do nothing.  In some cases you may find the shift state reversed from what you  expect;  if,
       for instance, you press <b>[</b> but “{” is displayed instead, see <b>-shiftbracket</b> and <b>-noshiftbracket</b> in <b>Options</b>,
       below,  to  correct  the problem.  The <b>Insert</b> key maps to the same position as underscore (address bit 3,
       data bit 7), so that this key can be used both with and without shift pressed; with many TRS-80  keyboard
       drivers one of these maps to ASCII code 0x7f (DEL).

       On  a German keyboard, the <b>¨</b> and <b>ß</b> keys should activate the corresponding characters used in the GENIE, a
       German Model I clone.  This feature is most useful together with the <b>-charset</b> <b>genie</b> command-line option.

       Pressing a key on a PC-style keyboard's  numeric  keypad  with  <b>NumLock</b>  disengaged  emulates  the  Alpha
       Products  joystick.  Keys 2, 4, 6, and 8 (<b>KP_Down</b>, <b>KP_Left</b>, <b>KP_Right</b>, and <b>KP_Up</b>) are the main directions;
       keys 1, 3, 7, and 9 (<b>KP_End</b>, <b>KP_Page_Down</b>, <b>KP_Home</b>, <b>KP_Page_Up</b>) work as diagonal directions by activating
       two main directions at once; and key 0 (<b>KP_Insert</b>) or 5 (<b>KP_Begin</b>) is the fire button.  Note that your  X
       server  may  default to sending digits for the keys on the numeric pad even if <b>NumLock</b> is not active.  If
       you have this problem, you can use <b><a href="../man1/xev.1.html">xev</a></b>(1) to determine the names of  the  X  keysyms  generated  by  your
       keystroke  events.   You  may need to check or update your XKB configuration.  Alternatively, you can use
       <b><a href="../man1/xmodmap.1.html">xmodmap</a></b>(1) to remap your numeric pad.

   <b>Emulated</b> <b>cassette</b>
       To control the emulated cassette, a file called <u>.cassette.ctl</u> in  the  current  working  directory  keeps
       track  of  what  file is currently loaded as the cassette tape and the current position within that file.
       The <b><a href="../man1/cassette.1.html">cassette</a></b>(1) shell script provides a way to manipulate this file.  You may use this script to load and
       position cassette tape files.  The operation works very much like an actual tape recorder.  The  <b>cassette</b>
       man page has more information about the shell script and the cassette file formats that are supported.

   <b>Printer</b>
       For  printer  support, any text sent to the TRS-80's printer (using LPRINT or LLIST, for example) is sent
       to the standard output.

   <b>Emulated</b> <b>floppy</b> <b>disks</b>
       In Model I mode, <b>xtrs</b> emulates a Radio Shack Expansion Interface with the Percom Doubler or  Radio  Shack
       Doubler  installed.   The Doubler provides double-density disk access by allowing either the stock WD1771
       FDC chip or a WD1791 chip to be selected under program control.  At powerup  the  1771  is  selected,  so
       operating  systems  with  no  Doubler driver see a stock system.  By default, the emulator pretends to be
       both a Percom and Radio Shack Doubler at the same time—it responds to the special commands of  both—so  a
       driver for either should work.  Under <u>LDOS</u> use the command <u>FDUBL</u> (on newer versions of <u>LDOS</u>), or <u>PDUBL</u> or
       <u>RDUBL</u>  (on  older  versions) to install the driver.  Software that tries to detect which doubler you have
       (such as <u>Super</u> <u>Utility</u>) may be confused by the emulation of both at once, so you can  choose  to  emulate
       only one with a command-line option; see <b>Options</b> below.

       In  Model  III,  4,  or  4P  mode,  <b>xtrs</b>  emulates  the stock floppy controller, which uses a WD1793 chip
       (software-compatible with the WD1791) to provide both single and double density.

       Four 5¼-inch floppy drives are emulated, with storage in files named <u>disk</u>M<u>-</u>U, where <u>M</u> is the TRS-80 model
       (<b>1</b>, <b>3</b>, <b>4</b>, or <b>4p</b>) and <u>U</u> is the drive unit number (<b>0</b>, <b>1</b>, <b>2</b>, or <b>3</b>).  If a file of the required name  is  not
       found,  a  drive  with  no  disk  in  it  is  emulated  (but see below).  If the user does not have write
       permission for a floppy file, and/or the file has an internal write protect flag set, a write-protect tab
       is emulated.  Use the <b><a href="../man1/mkdisk.1.html">mkdisk</a></b>(1) program to turn the write protect flag on or off.  To change floppies  in
       an  emulated  drive,  rename  the existing file for the drive (if any), rename the new floppy file to the
       proper name, and press <b>F7</b> (see <b>Keys,</b> above).

       If you try to boot an emulated Model I, III, or 4 with no file named <u>disk</u>M<u>-0</u> (that is, no disk  in  drive
       0),  <b>xtrs</b>  emulates  having  no  floppy  disk  controller.   The  behavior  of a real machine with a disk
       controller in this case didn't seem useful to emulate faithfully: a real Model I hangs with a screen full
       of garbage; a real Model III or 4 goes  into  a  retry  loop  printing  "Diskette?"  on  the  screen  and
       rechecking whether you've inserted one.  A real Model 4P always has a floppy controller, however, so <b>xtrs</b>
       always emulates one.

       Due  to  a  limitation of the original Model I hardware, drive :3 cannot be double-sided in Model I mode.
       In the original Model I, you could not have a drive :3 at all if any drive  in  the  system  was  double-
       sided, but the emulator is able to be more forgiving.

       Emulated  floppy  image  files can be of any of three types: JV1, compatible with Jeff Vavasour's popular
       freeware Model I emulator for <u>MS-DOS</u>; JV3, a compatible extension of a format first  used  in  Vavasour's
       commercial  Model III/4 emulator; or DMK, compatible with David Keil's Model 4 emulator.  All three types
       work in <b>xtrs</b> regardless of what model it is emulating.  A heuristic is used to decide which type of image
       is in a drive, as none of the types has a magic number or signature.

       JV1 supports only single-sided, single-density diskettes, with directory on track 17.   Sectors  must  be
       256  bytes  long.  Use <b>FORMAT</b> <b>(DIR=17)</b> if you want to format JV1 disks with more (or less) than 35 tracks
       under <u>LDOS</u>.

       JV3 is much more flexible, though it still does not support everything the real controllers could do.  It
       is probably best to use JV3 for all the disk images you create, since it is the most  widely  implemented
       by  other  emulators,  unless  you  have  a  special  reason to use one of the others.  A JV3 disk can be
       formatted with 128, 256, 512, or 1024-byte sectors, 1 or 2 sides, single or double density,  with  either
       an  0xFB  (normal)  or  0xF8 (deleted) data address mark on any sector.  On single-density JV3 disks, the
       nonstandard data address marks 0xFA and 0xF9 are also available.  You cannot  format  a  sector  with  an
       incorrect track number or head number.  You <u>can</u> format a sector with an intentional CRC error in the data
       field.  <b>xtrs</b> supports at most 5802 total sectors on a JV3 image.

       The  original Vavasour JV3 format supported only 256-byte sectors, and had a limit of 2901 total sectors.
       If you use sector sizes other than 256 bytes or format more than 2901 sectors on a disk image,  emulators
       other  than  <b>xtrs</b>  may  be  unable  to  read it.  Note that an 80 track, double-sided, double-density (18
       sector) 5¼-inch floppy will fit within the original 2901 sector limit; the extension to 5802 is primarily
       for emulation of 8-inch drives (discussed below).

       The DMK format is the most flexible.  It supports essentially everything that the original hardware could
       do, including all “protected” disk formats.  However, a few protected disks still may not work with  <b>xtrs</b>
       due  to limitations in <b>xtrs</b>'s floppy disk controller emulation rather than limitations of the DMK format;
       see <b>Bugs</b> <b>and</b> <b>limitations</b>, below.

       The program <b><a href="../man1/mkdisk.1.html">mkdisk</a></b>(1) makes a blank emulated floppy or “bulk erases” an existing one.  By default, <b>mkdisk</b>
       makes a JV3 floppy, but with the <b>-1</b> flag it makes a JV1 floppy, or with the <b>-k</b> flag a  DMK  floppy.   See
       the <b>mkdisk</b> man page for more information.

       Early  Model I operating systems used an 0xFA data address mark (DAM) for the directory on single-density
       disks, while later ones wrote 0xF8 but would accept either upon reading.  The change was  needed  because
       0xFA  is  a nonstandard DAM that is fully supported only by the WD1771 floppy disk controller used in the
       Model I; the controllers in the Model III and 4 cannot distinguish between 0xFA and 0xFB (which  is  used
       for  non-directory  sectors) upon reading, and cannot write 0xFA.  To deal nicely with this problem, <b>xtrs</b>
       implements the following kludge.  On writing in single density, an 0xF8 data address mark is recorded  as
       0xFA.   On reading with an emulated WD1771 (available in Model I mode only), 0xFA is returned as 0xFA; on
       reading with a WD179<u>x</u>, 0xFA is returned as 0xF8.   This  trick  makes  the  different  operating  systems
       perfectly  compatible  with each other, which is better than on a real Model I!  You can use the <b>-truedam</b>
       flag to turn off this kludge if you need to; in that case the original hardware is emulated exactly.

       TRS-80 programs that attempt to measure the rotational speed of their floppy  disk  drives  using  timing
       loops will get the answers they expect, even when <b>xtrs</b> does not emulate instructions at the same speed as
       the  original  machines.  This works because <b>xtrs</b> keeps a virtual clock (technically, a T-state counter),
       which measures how much time it should have taken to execute the instruction stream on  a  real  machine,
       and it ties the emulation of floppy disk index holes to this clock, not to real time.

   <b>Emulated</b> <b>8-inch</b> <b>floppy</b> <b>disks</b>
       In  addition to the four standard 5¼-inch drives, <b>xtrs</b> also emulates four 8-inch floppy drives.  There is
       no widely-accepted standard hardware interface for 8-inch floppies on the  TRS-80,  so  <b>xtrs</b>  emulates  a
       pseudo-hardware interface of its own and provides an <u>LDOS</u>/<u>LS-DOS</u> driver for it.

       Storage for the emulated 8-inch disks is in files named <u>disk</u>M<u>-</u>U, where <u>M</u> is the TRS-80 model (<b>1</b>, <b>3</b>, <b>4</b>, or
       <b>4p</b>)  and  <u>U</u>  is  the  drive  unit number (<b>4</b>, <b>5</b>, <b>6</b>, or <b>7</b>).  The only difference between 5¼-inch and 8-inch
       emulated drives is that the emulator allows you to format more bytes per track in the latter.  A new  JV3
       floppy  can  be  formatted  as  either 5¼-inch or 8-inch depending on whether you initially put it into a
       5¼-inch or 8-inch emulated drive.  A new DMK floppy, however, must be created with the <b>-8</b> flag to  <b>mkdisk</b>
       in  order  to be large enough for use in an 8-inch emulated drive.  JV1 floppies cannot be used in 8-inch
       drives.  Be careful not to put an emulated floppy into  a  5¼-inch  emulated  drive  after  it  has  been
       formatted  in  an  8-inch emulated drive or vice versa; the results are likely to be confusing.  Consider
       using different file extensions for the two types; say, <u>.dsk</u> for 5¼-inch and <u>.8in</u> for 8-inch.

       To use the emulated 8-inch drives, you'll need a driver.  Under <u>LDOS</u> or <u>LS-DOS</u>, use the program <u>XTRS8/DCT</u>
       supplied on the emulated floppy <u>utility.dsk</u>.  This driver is a very  simple  wrapper  around  the  native
       <u>LDOS</u>/<u>LS-DOS</u> floppy driver.  Here are detailed instructions.

       First,  make  sure  an  appropriate  version of <u>LDOS</u> is in emulated floppy drive 0, and the supplied file
       <u>utility.dsk</u> is in another emulated floppy drive.  Boot <u>LDOS</u>.  If you are using  Model  I  <u>LDOS</u>,  be  sure
       <u>FDUBL</u> is running.

       Second,  type  the  following  commands.   Here <u>d</u> is the <u>LDOS</u> drive number you want to use for the 8-inch
       drive and <u>u</u> is the unit number you chose when naming the file.  Most likely you will choose <u>d</u> and <u>u</u> to be
       equal to reduce confusion.
              <b>SYSTEM</b> <b>(DRIVE=</b>dd<b>,DRIVER="XTRS8",ENABLE)</b>
              Enter unit number ([4]-7): u
       You can repeat these steps with different values of <u>d</u> and <u>u</u> to have more  than  one  8-inch  drive.   You
       might  want  to  repeat four times using <b>4</b>, <b>5</b>, <b>6</b>, and <b>7</b>, or you might want to save some drive numbers for
       hard drives (see below).

       Finally, it's a good idea to give the <u>SYSTEM</u> <u>(SYSGEN)</u> command (Model  I/III)  or  <u>SYSGEN</u>  command  (Model
       4/4P).   This  command  saves  the <u>SYSTEM</u> settings, so the 8-inch drives will be available again the next
       time you reboot or restart the emulator.  If you need to access an 8-inch drive after booting from a disk
       that hasn't been <u>SYSGEN</u>ed, simply use the same <u>SYSTEM</u> command again.

       In case you want to write your own driver for another TRS-80 operating system, here are  details  on  the
       emulated  pseudo-hardware.   The  8-inch  drives  are accessed through the normal floppy disk controller,
       exactly like 5¼-inch drives.  The four 5¼-inch drives  have  hardware  select  codes  1,  2,  4,  and  8,
       corresponding respectively to files <u>disk</u>M<u>-0,</u> <u>-1</u>, <u>-2</u>, and <u>-3</u>.  The four 8-inch drives have hardware select
       codes  3,  5,  6,  and  7,  corresponding  respectively  to files <u>disk</u>M<u>-4,</u> <u>-5</u>, <u>-6</u>, and <u>-7</u>.  (See also the
       <b>-sizemap</b> option below, however.)

   <b>Real</b> <b>floppy</b> <b>disks</b>
       Under Linux only, any <u>disk</u>M<u>-</u>U file can be a symbolic link to a real floppy disk drive, typically <u>/dev/fd0</u>
       or <u>/dev/fd1</u>.  Most machines with “legacy” (ISA bus) floppy drive support should be able to read and write
       TRS-80-compatible floppies in this way.  Many floppy controllers cannot handle single  density,  however,
       and  some  may  have  problems  even with double-density disks written on a real TRS-80, especially disks
       formatted by older TRS-80 operating systems.  Use the <b>-doublestep</b> flag if you need to  read  35-track  or
       40-track  media  in  an  80-track  drive.  If you need to write 35-track or 40-track media in an 80-track
       drive, bulk-erase the media first and format it in the 80-track drive.  Don't  write  to  a  disk  in  an
       80-track drive if it has ever been written to in a 40-track drive.  The narrower head used in an 80-track
       drive cannot erase the full track width written by the head in a 40-track drive.

       If  you  link  one  of  the 5¼-inch floppy files (<u>disk</u>M<u>-0</u> through <u>disk</u>M<u>-3</u>) to a real floppy drive, TRS-80
       programs will see it as a 5¼-inch drive, but the actual drive can be  either  3½-inch  or  5¼-inch.   The
       drive  will  be  operated  in double density (or single density), not high density, so be sure to use the
       appropriate media.

       If you link one of the 8-inch floppy files (<u>disk</u>M<u>-4</u> through <u>disk</u>M<u>-7</u>)  to  a  real  floppy  drive,  TRS-80
       programs  will see it as an 8-inch drive.  Again, you need to use the <u>XTRS8/DCT</u> driver described above to
       enable <u>LDOS</u>/<u>LS-DOS</u> to access an 8-inch drive.  The real drive can be either 3½-inch, 5¼-inch, or  8-inch.
       A  3½-inch  or  5¼-inch drive will be operated in high-density mode, using MFM recording if the TRS-80 is
       trying to do double density, or FM recording if the TRS-80 is trying to do single density.  In this mode,
       these drives can hold as much data as a standard 8-inch drive.  In fact, a 5¼-inch HD drive holds exactly
       the same number of bits per track as an 8-inch drive; a 3½-inch HD drive can hold 20% more, but we  waste
       that  space when using one to emulate an 8-inch drive.  In both cases we also waste the top three tracks,
       since an 8-inch drive has only 77 tracks, not 80.

       The nonstandard 0xFA and 0xF9 data address marks available in single density on a real Model I  with  the
       WD1771  controller  also  need  special  handling.  A ISA-bus floppy disk controller can neither read nor
       write sectors with such DAMs at all.  This raises three issues.
</pre>
 </div>
</div></section>
</div>
</body>
</html>