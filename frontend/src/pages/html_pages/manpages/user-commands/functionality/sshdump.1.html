<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sshdump - Provide interfaces to capture from a remote host through SSH using a remote capture binary.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/wireshark-common">wireshark-common_4.4.7-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sshdump - Provide interfaces to capture from a remote host through SSH using a remote capture binary.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>sshdump</b> [ <b>--help</b> ] [ <b>--version</b> ] [ <b>--extcap-interfaces</b> ] [ <b>--extcap-dlts</b> ]
       [ <b>--extcap-interface</b>=&lt;interface&gt; ] [ <b>--extcap-config</b> ] [ <b>--extcap-capture-filter</b>=&lt;capture filter&gt; ]
       [ <b>--capture</b> ] [ <b>--fifo</b>=&lt;path to file or pipe&gt; ] [ <b>--remote-host</b>=&lt;IP address&gt; ]
       [ <b>--remote-port</b>=&lt;TCP port&gt; ] [ <b>--remote-username</b>=&lt;username&gt; ] [ <b>--remote-password</b>=&lt;password&gt; ]
       [ <b>--sshkey</b>=&lt;private key path&gt; ] [ <b>--sshkey-passphrase</b>=&lt;private key passphrase&gt; ]
       [ <b>--proxycommand</b>=&lt;SSH proxy command&gt; ] [ <b>--remote-interface</b>=&lt;interface&gt; ]
       [ <b>--remote-capture-command-select</b>=&lt;capture command selection&gt; ]
       [ <b>--remote-capture-command</b>=&lt;capture command&gt; ] [ <b>--remote-priv</b>=&lt;privilege elevation command selection&gt; ]
       [ <b>--remote-priv-user</b>=&lt;privileged user name&gt; ] [ <b>--remote-noprom</b> ]
       [ <b>--remote-filter</b>=&lt;remote capture filter&gt; ] [ <b>--remote-count</b>=&lt;number&gt; ]

       <b>sshdump</b> <b>--extcap-interfaces</b>

       <b>sshdump</b> <b>--extcap-interface</b>=&lt;interface&gt; <b>--extcap-dlts</b>

       <b>sshdump</b> <b>--extcap-interface</b>=&lt;interface&gt; <b>--extcap-config</b>

       <b>sshdump</b> <b>--extcap-interface</b>=&lt;interface&gt; <b>--fifo</b>=&lt;path to file or pipe&gt; <b>--capture</b> <b>--remote-host=myremotehost</b>
       <b>--remote-port=22</b> <b>--remote-username=user</b> <b>--remote-interface=eth2</b>
       <b>--remote-capture-command='tcpdump</b> <b>-U</b> <b>-i</b> <b>eth0</b> <b>-w-'</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Sshdump</b> is an extcap tool that allows one to run a remote capture tool over a SSH connection. The
       requirement is that the capture executable must have the capabilities to capture from the wanted
       interface.

       The feature is functionally equivalent to run commands like

           $ ssh remoteuser@remotehost -p 22222 'tcpdump -U -i IFACE -w -' &gt; FILE &amp;
           $ wireshark FILE

           $ ssh remoteuser@remotehost '/sbin/dumpcap -i IFACE -P -w - -f "not port 22"' &gt; FILE &amp;
           $ wireshark FILE

           $ ssh somehost dumpcap -P -w - -f udp | tshark -i -

       Typically sshdump is not invoked directly. Instead it can be configured through the Wireshark graphical
       user interface or its command line. The following will start Wireshark and start capturing from host
       <b>remotehost</b>:

           $ wireshark '-oextcap.sshdump.remotehost:"remotehost"' -i sshdump -k

       To explicitly control the remote capture command:

           $ wireshark '-oextcap.sshdump.remotehost:"remotehost"' \
                       '-oextcap.sshdump.remotecapturecommand:"tcpdump -i eth0 -Uw- not port 22"' \
                       -i sshdump -k

       Supported interfaces:

        1. ssh

</pre><h4><b>OPTIONS</b></h4><pre>
       --help
           Print program arguments.

       --version
           Print program version.

       --extcap-interfaces
           List available interfaces.

       --extcap-interface=&lt;interface&gt;
           Use specified interfaces.

       --extcap-dlts
           List DLTs of specified interface.

       --extcap-config
           List configuration options of specified interface.

       --extcap-capture-filter=&lt;capture filter&gt;
           The capture filter. It corresponds to the value provided via the <b>tshark</b> <b>-f</b> option, and the Capture
           Filter field next to the interfaces list in the Wireshark interface.

       --capture
           Start capturing from specified interface and write raw packet data to the location specified by
           --fifo.

       --fifo=&lt;path to file or pipe&gt;
           Save captured packet to file or send it through pipe.

       --remote-host=&lt;remote host&gt;
           The address of the remote host for capture.

       --remote-port=&lt;remote port&gt;
           The SSH port of the remote host.

       --remote-username=&lt;username&gt;
           The username for SSH authentication.

       --remote-password=&lt;password&gt;
           The password to use (if not ssh-agent and pubkey are used). WARNING: the passwords are stored in
           plaintext and visible to all users on this system. It is recommended to use keyfiles with a SSH
           agent.

       --sshkey=&lt;SSH private key path&gt;
           The path to a private key for authentication. NOTE: Only OPENSSH key/value pair format is supported.

       --sshkey-passphrase=&lt;SSH private key passphrase&gt;
           The passphrase for the private key for authentication.

       --proxycommand=&lt;proxy command&gt;
           The command to use as proxy for the SSH connection.

       --remote-interface=&lt;remote interface&gt;
           The remote network interface to capture from.

       --remote-capture-command-select=&lt;capture command-selection&gt;

           The selection of the build-in support for remote capture commands. Either <b>dumpcap</b> for a remote
           capture command using dumpcap, <b>tcpdump</b> for a remote capture command using tcpdump, or <b>other</b>, where
           the remote capture command is to be given with the <b>--remote-capture-command</b> option.

           Note that selecting dumpcap allows for specifying multiple capture interfaces as a whitespace
           separated list, while tcpdump does not.

       --remote-capture-command=&lt;capture command&gt;

           A custom remote capture command that produces the remote stream that is shown in Wireshark. The
           command must be able to produce a PCAP stream written to STDOUT. See below for more examples.

           If using tcpdump, use the <b>-w-</b> option to ensure that packets are written to standard output (stdout).
           Include the <b>-U</b> option to write packets as soon as they are received.

           When specified, this command will be used as is, options such as the capture filter
           (<b>--extcap-capture-filter</b>) will not be appended.

       --remote-priv=&lt;privilege elevation command selection&gt;
           The command to use to achieve privilege elevation to capture on the remote host. Either none, sudo or
           doas.

       --remote-priv-user=&lt;privileged user name&gt;
           If a command is used to achieve privilege elevation to capture on the remote host this may require a
           user name. If needed use this option to give that user name.

       --remote-filter=&lt;capture filter&gt;
           The remote capture filter. It corresponds to the value provided via the <b>tshark</b> <b>-f</b> option, and the
           Capture Filter field next to the interfaces list in the Wireshark interface.

       --remote-count=&lt;number&gt;
           The number of packets to capture.

</pre><h4><b>EXAMPLES</b></h4><pre>
       To see program arguments:

           sshdump --help

       To see program version:

           sshdump --version

       To see interfaces:

           sshdump --extcap-interfaces

       Only one interface (sshdump) is supported.

       <b>Example</b> <b>output</b>

           interface {value=sshdump}{display=SSH remote capture}

       To see interface DLTs:

           sshdump --extcap-interface=sshdump --extcap-dlts

       <b>Example</b> <b>output</b>

           dlt {number=147}{name=sshdump}{display=Remote capture dependent DLT}

       To see interface configuration options:

           sshdump --extcap-interface=sshdump --extcap-config

       <b>Example</b> <b>output</b>

           arg {number=0}{call=--remote-host}{display=Remote SSH server address}{type=string}
               {tooltip=The remote SSH host. It can be both an IP address or a hostname}{required=true}{group=Server}
           arg {number=1}{call=--remote-port}{display=Remote SSH server port}{type=unsigned}{default=22}
               {tooltip=The remote SSH host port (1-65535)}{range=1,65535}{group=Server}
           arg {number=2}{call=--remote-username}{display=Remote SSH server username}{type=string}
               {tooltip=The remote SSH username. If not provided, the current user will be used}{group=Authentication}
           arg {number=3}{call=--remote-password}{display=Remote SSH server password}{type=password}
               {tooltip=The SSH password, used when other methods (SSH agent or key files) are unavailable.}{group=Authentication}
           arg {number=4}{call=--sshkey}{display=Path to SSH private key}{type=fileselect}
               {tooltip=The path on the local filesystem of the private SSH key (OpenSSH format)}{mustexist=true}{group=Authentication}
           arg {number=5}{call=--sshkey-passphrase}{display=SSH key passphrase}{type=password}
               {tooltip=Passphrase to unlock the SSH private key}{group=Authentication}
           arg {number=6}{call=--proxycommand}{display=ProxyCommand}{type=string}
               {tooltip=The command to use as proxy for the SSH connection}{group=Authentication}
           arg {number=7}{call=--remote-interface}{display=Remote interface}{type=string}
               {tooltip=The remote network interface used for capture}{group=Capture}
           arg {number=8}{call=--remote-capture-command-select}{display=Remote capture command selection}{type=radio}
               {tooltip=The remote capture command to build a command line for}{group=Capture}
               value {arg=8}{value=dumpcap}{display=dumpcap}
               value {arg=8}{value=tcpdump}{display=tcpdump}{default=true}
               value {arg=8}{value=other}{display=Other:}
           arg {number=9}{call=--remote-capture-command}{display=Remote capture command}{type=string}
               {tooltip=The remote command used to capture}{group=Capture}
           arg {number=10}{call=--remote-priv}{display=Gain capture privilege on the remote machine}{type=radio}
               {tooltip=Optionally prepend the capture command with sudo or doas on the remote machine}{group=Capture}
               value {arg=10}{value=none}{display=none}{default=true}
               value {arg=10}{value=sudo}{display=sudo}
               value {arg=10}{value=doas -n}{display=doas}
           arg {number=11}{call=--remote-priv-user}{display=Privileged user name for sudo or doas}{type=string}
               {tooltip=User name of privileged user to execute the capture command on the remote machine}{group=Capture}
           arg {number=12}{call=--remote-noprom}{display=No promiscuous mode}{type=boolflag}
               {tooltip=Don't use promiscuous mode on the remote machine}{group=Capture}
           arg {number=13}{call=--remote-filter}{display=Remote capture filter}{type=string}
               {tooltip=The remote capture filter}{default=not ((host myhost) and port 22)}{group=Capture}
           arg {number=14}{call=--remote-count}{display=Packets to capture}{type=unsigned}{default=0}
               {tooltip=The number of remote packets to capture. (Default: inf)}{group=Capture}
           arg {number=15}{call=--log-level}{display=Set the log level}{type=selector}
               {tooltip=Set the log level}{required=false}{group=Debug}
               value {arg=14}{value=message}{display=Message}{default=true}
               value {arg=14}{value=info}{display=Info}
               value {arg=14}{value=debug}{display=Debug}
               value {arg=14}{value=noisy}{display=Noisy}
           arg {number=16}{call=--log-file}{display=Use a file for logging}{type=fileselect}
               {tooltip=Set a file where log messages are written}{required=false}{group=Debug}

       To capture:

           sshdump --extcap-interface=sshdump --fifo=/tmp/ssh.pcap --capture --remote-host 192.168.1.10
           --remote-username user --remote-filter "not port 22"

       To use different capture binaries:

           sshdump --extcap-interface=sshdump --fifo=/tmp/ssh.pcap --capture --remote-host 192.168.1.10
           --remote-username user --remote-priv sudo --remote-capture-command-select tcpdump
           --remote-interface eth0 --remote-noprom

           sshdump --extcap-interface=sshdump --fifo=/tmp/ssh.pcap --capture --remote-host 192.168.1.10
           --remote-capture-command='dumpcap -i eth0 -P -w -'

           sshdump --extcap-interface=sshdump --fifo=/tmp/ssh.pcap --capture --remote-host 192.168.1.10
           --remote-capture-command='sudo tcpdump -i eth0 -U -w -'

           <b>Note</b>

           To stop capturing CTRL+C/kill/terminate the application.

       The sshdump binary can be renamed to support multiple instances. For instance if we want sshdump to show
       up twice in wireshark (for instance to handle multiple profiles), we can copy sshdump to sshdump-host1
       and sshdump-host2. Each binary will show up an interface name same as the executable name. Those
       executables not being "sshdump" will show up as "custom version" in the interface description.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/wireshark.1.html">wireshark</a>(1), <a href="../man1/tshark.1.html">tshark</a>(1), <a href="../man1/dumpcap.1.html">dumpcap</a>(1), <a href="../man4/extcap.4.html">extcap</a>(4), <a href="../man1/tcpdump.1.html">tcpdump</a>(1)

</pre><h4><b>NOTES</b></h4><pre>
       <b>Sshdump</b> is part of the <b>Wireshark</b> distribution. The latest version of <b>Wireshark</b> can be found at
       https://www.wireshark.org.

       HTML versions of the Wireshark project man pages are available at
       https://www.wireshark.org/docs/man-pages.

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>Original</b> <b>Author</b>
       Dario Lombardo &lt;lomato[AT]gmail.com&gt;

                                                   2025-06-10                                         <u><a href="../man1/SSHDUMP.1.html">SSHDUMP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>