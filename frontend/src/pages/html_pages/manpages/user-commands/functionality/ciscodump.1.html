<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ciscodump - Provide interfaces to capture from a remote Cisco device through SSH.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/wireshark-common">wireshark-common_4.4.7-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ciscodump - Provide interfaces to capture from a remote Cisco device through SSH.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ciscodump</b> [ <b>--help</b> ] [ <b>--version</b> ] [ <b>--extcap-interfaces</b> ] [ <b>--extcap-dlts</b> ]
       [ <b>--extcap-interface</b>=&lt;interface&gt; ] [ <b>--extcap-config</b> ] [ <b>--extcap-capture-filter</b>=&lt;capture filter&gt; ]
       [ <b>--capture</b> ] [ <b>--fifo</b>=&lt;path to file or pipe&gt; ] [ <b>--remote-host</b>=&lt;IP address&gt; ]
       [ <b>--remote-port</b>=&lt;TCP port&gt; ] [ <b>--remote-username</b>=&lt;username&gt; ] [ <b>--remote-password</b>=&lt;password&gt; ]
       [ <b>--remote-filter</b>=&lt;filter&gt; ] [ <b>--sshkey</b>=&lt;public key path&gt; ] [ <b>--remote-interface</b>=&lt;interface&gt; ]
       [ <b>--remote-count</b>=&lt;count&gt; ]

       <b>ciscodump</b> <b>--extcap-interfaces</b>

       <b>ciscodump</b> <b>--extcap-interface</b>=ciscodump <b>--extcap-dlts</b>

       <b>ciscodump</b> <b>--extcap-interface</b>=ciscodump <b>--extcap-config</b>

       <b>ciscodump</b> <b>--extcap-interface</b>=ciscodump <b>--fifo</b>=&lt;path to file or pipe&gt; <b>--capture</b> <b>--remote-host</b>=remotedevice
       <b>--remote-port</b>=22 <b>--remote-username</b>=user <b>--remote-interface</b>=&lt;the device interface&gt; <b>--remote-count</b>=&lt;count&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Ciscodump</b> is an extcap tool that relies on Cisco EPC to allow a user to run a remote capture on a Cisco
       device in a SSH connection. It supports IOS, IOS-XE based device and ASA devices.

       The tool configures capture on the device, reads data and removes configuration from the device. Provided
       credentials must allow the tool to configure the device.

       When capture is started, packets are provided as they are received from the device. Capture stops when:

       •   requested count of packets is reached (<b>--remote-count</b> is mandatory)

       •   when capture finishes on the device (e.g. capture buffer is full)

       •   the capture is stopped by the user

       Capture performance depends on a device type. The tool tries to read packets as soon as they received,
       but is usually slower than capturing device captures packets. Therefore packets are read in batches.

       IOS/IOS-XE provides only access to all captured packets from the top. Therefore reading of second batch
       means to read all packets from first batch, but ignore them and then read new packets in second batch.

       ASA provides access to specific packet so tool reads every packet just once.

   <b>SUPPORTED</b> <b>CISCO</b> <b>SOFTWARE</b>
       The application supports IOS version is 12.4 and higher. The IOS version supporting capture feature is
       <a href="../man20/12.4.20.html">12.4</a>(20)T and higher. More details can be found here:
       https://www.cisco.com/c/en/us/products/collateral/ios-nx-os-software/ios-embedded-packet-capture/datasheet_c78-502727.html

       The application supports IOS-XE version 16.1 and higher. Search for "Embedded Packet Capture
       Configuration Guide, Cisco IOS XE" to get more details.

       The application supports ASA version 8.4 and higher. More details can be found here:
       https://community.cisco.com/t5/security-documents/asa-using-packet-capture-to-troubleshoot-asa-firewall/ta-p/3129889

</pre><h4><b>OPTIONS</b></h4><pre>
       --help
           Print program arguments.

       --version
           Print program version.

       --extcap-interfaces
           List available interfaces.

       --extcap-interface=&lt;interface&gt;
           Use specified interfaces.

       --extcap-dlts
           List DLTs of specified interface.

       --extcap-config
           List configuration options of specified interface.

       --capture
           Start capturing from specified interface and save it in place specified by --fifo.

       --fifo=&lt;path to file or pipe&gt;
           Save captured packet to file or send it through pipe.

       --remote-host=&lt;remote host&gt;
           The address of the remote host for capture.

       --remote-port=&lt;remote port&gt;
           The SSH port of the remote host.

       --remote-username=&lt;username&gt;
           The username for ssh authentication.

       --remote-password=&lt;password&gt;
           The password to use (if not ssh-agent and pubkey are used). WARNING: the passwords are stored in
           plaintext and visible to all users on this system. It is recommended to use keyfiles with a SSH
           agent.

       --remote-filter=&lt;filter&gt;

           The remote filter on the device. This is a capture filter that follows the Cisco standards.

           For IOS/IOS-XE see https://www.cisco.com/c/en/us/support/docs/ip/access-lists/26448-ACLsamples.html.

           For ASA see
           https://www.cisco.com/c/en/us/td/docs/security/asa/asa96/configuration/firewall/asa-96-firewall-config/access-acls.html.

           Multiple filters can be specified using a comma between them. BEWARE: when using a filter, the
           default behavior is to drop all the packets except the ones that fall into the filter.

           Examples for IOS/IOS-XE:

               permit ip host MYHOST any, permit ip any host MYHOST (capture the traffic for MYHOST)

               deny ip host MYHOST any, deny ip any host MYHOST, permit ip any any (capture all the traffic except MYHOST)

           Examples for ASA:

               permit any4 host MYHOST, permit host MYHOST any4 (capture IPv4 traffic for MYHOST)

               <b>Note</b>

               Different capture types support or do not support specific ACL keywords. The tool is not able to
               check it, just tries to configure it. If error occurs, the tool just reports it and terminates.
               Debris are left in configuration in this case.

       --sshkey=&lt;SSH private key path&gt;
           The path to a private key for authentication.

       --remote-interface=&lt;remote interface&gt;

           The remote network interface to capture from. One interface or list of interface names can be used.
           Interfaces are separated by comma. Interface names must be supported by the device.

           There are interface names causing different capture types. They are specific to used Cisco software.

           <b>IOS</b> <b>special</b> <b>names</b>

           •   process-switched - capture process switched packets in both directions

           •   from-us - capture process switched packets originating at the device

           <b>IOS-XE</b> <b>special</b> <b>names</b>

           •   control-plane - captures in/out packets touching control plane

           <b>ASA</b> <b>special</b> <b>names</b>

           •   asp-drop - capture packets dropped by all asp categories

           •   TYPE---ifname - syntax to refer ASA capture types, see
               https://www.cisco.com/c/en/us/td/docs/security/asa/asa-cli-reference/A-H/asa-command-ref-A-H/ca-cld-commands.html#wp2435483314

               •   isakmp---ifname - capture isakmp packets

               •   lacp---ifname - capture lacp packets (just physical interfaces are supported)

               •   tls-proxy---ifname - capture tls-proxy packets

               •   inline-tag---ifname - capture all SGT tagged packets

               •   raw-data---ifname - same as ifname

           •   syntax to capture decrypted traffic for some of capture types:

               •   isakmp/decrypted---ifname - capture isakmp packets including decrypted payload

               •   tls-proxy/decrypted---ifname - capture tls-proxy packets including decrypted payload

               •   inline-tag/decrypted---ifname - capture inline-tag packets including decrypted payload

               •   raw-data/decrypted---ifname - capture raw-data packets including decrypted payload

           Use e. g. isakmp/decrypted---outside to capture encrypted and decrypted isakmp traffic on outside
           interface.

       --remote-count=&lt;count&gt;
           Count of packets to capture. Capture is stopped when count is reached.

       --extcap-capture-filter=&lt;capture filter&gt;
           Unused (compatibility only).

</pre><h4><b>EXAMPLES</b></h4><pre>
       To see program arguments:

           ciscodump --help

       To see program version:

           ciscodump --version

       To see interfaces:

           ciscodump --extcap-interfaces

       Only one interface (ciscodump) is supported.

       <b>Example</b> <b>output</b>

           interface {value=ciscodump}{display=SSH remote capture}

       To see interface DLTs:

           ciscodump --extcap-interface=ciscodump --extcap-dlts

       <b>Example</b> <b>output</b>

           dlt {number=147}{name=ciscodump}{display=Remote capture dependent DLT}

       To see interface configuration options:

           ciscodump --extcap-interface=ciscodump --extcap-config

       <b>Example</b> <b>output</b>

           ciscodump --extcap-interface=ciscodump --extcap-config
           arg {number=0}{call=--remote-host}{display=Remote SSH server address}
               {type=string}{tooltip=The remote SSH host. It can be both an IP address or a hostname}
               {required=true}{group=Server}
           arg {number=1}{call=--remote-port}{display=Remote SSH server port}
               {type=unsigned}{default=22}{tooltip=The remote SSH host port (1-65535)}
               {range=1,65535}{group=Server}
           arg {number=2}{call=--remote-username}{display=Remote SSH server username}
               {type=string}{default=&lt;current user&gt;}{tooltip=The remote SSH username. If not provided, the current user will be used}
               {group=Authentication}
           arg {number=3}{call=--remote-password}{display=Remote SSH server password}
               {type=password}{tooltip=The SSH password, used when other methods (SSH agent or key files) are unavailable.}
               {group=Authentication}
           arg {number=4}{call=--sshkey}{display=Path to SSH private key}
               {type=fileselect}{tooltip=The path on the local filesystem of the private ssh key}
               {group=Authentication}
           arg {number=5}{call=--proxycommand}{display=ProxyCommand}
               {type=string}{tooltip=The command to use as proxy for the SSH connection}{group=Authentication}
           arg {number=6}{call--sshkey-passphrase}{display=SSH key passphrase}
               {type=password}{tooltip=Passphrase to unlock the SSH private key}{group=Authentication
           arg {number=7}{call=--remote-interface}{display=Remote interface}
               {type=string}{tooltip=The remote network interface used for capture}
               {required=true}{group=Capture}
           arg {number=8}{call=--remote-filter}{display=Remote capture filter}
               {type=string}{tooltip=The remote capture filter}{default=&lt;filter to exclude current host&gt;}
               {group=Capture}
           arg {number=9}{call=--remote-count}{display=Packets to capture}
               {type=unsigned}{tooltip=The number of remote packets to capture.}
               {required=true}{group=Capture}
           arg {number=10}{call=--debug}{display=Run in debug mode}
               {type=boolflag}{default=false}{tooltip=Print debug messages}
               {required=false}{group=Debug}
           arg {number=11}{call=--debug-file}{display=Use a file for debug}
               {type=string}{tooltip=Set a file where the debug messages are written}
               {required=false}{group=Debug}

       To capture on IOS/IOS-XE:

           ciscodump --extcap-interface ciscodump --fifo=/tmp/cisco.pcap --capture --remote-host 192.168.1.10
               --remote-username user --remote-interface gigabit0/0,gigiabit0/1
               --remote-filter "permit ip host 192.168.1.1 any, permit ip any host 192.168.1.1"
               --remote-count=10

       To capture on IOS/IOS-XE:

           ciscodump --extcap-interface ciscodump --fifo=/tmp/cisco.pcap --capture --remote-host 192.168.1.10
               --remote-username user --remote-interface outside,dmz
               --remote-filter "permit host 192.168.1.1 any4, permit any4 host 192.168.1.1"
               --remote-count=10

           ciscodump --extcap-interface ciscodump --fifo=/tmp/cisco.pcap --capture --remote-host 192.168.1.10
               --remote-username user --remote-interface raw-data/decrypted---outside
               --remote-filter "permit host 192.168.1.1 any4, permit any4 host 192.168.1.1"

</pre><h4><b>KNOWN</b> <b>ISSUES</b></h4><pre>
       When capture stopped by the user before it finishes on Windows platform, configuration is not cleared on
       the device. Next run will probably fails because parts of configuration already exists on the device.

       Reading performance on IOS/IOS-XE is poor because re-reading of capture buffer over and over.

       The configuration of the capture on the device is a multi-step process. If the SSH connection is
       interrupted during it, the configuration can be in an inconsistent state. That can happen also if the
       capture is stopped and ciscodump can’t clean the configuration up. In this case it is necessary to log
       into the device and manually clean the configuration, removing configuration elements:

       •   IOS

           •   capture points WSC_P_&lt;number&gt; (depends on count of capture interfaces)

           •   the capture buffer WSC_B

           •   the capture capture acl WSC_ACL (if filter was used)

       •   IOS-XE

           •   the capture WSC

           •   the capture capture acl WSC_ACL (if filter was used)

       •   ASA

           •   the capture WSC

           •   the capture capture acl WSC_ACL (if filter was used)

       On IOS platforms, only IPv4 commands issued and only IPv4 packets are captured.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/wireshark.1.html">wireshark</a>(1), <a href="../man1/tshark.1.html">tshark</a>(1), <a href="../man1/dumpcap.1.html">dumpcap</a>(1), <a href="../man4/extcap.4.html">extcap</a>(4), <a href="../man1/sshdump.1.html">sshdump</a>(1)

</pre><h4><b>NOTES</b></h4><pre>
       <b>ciscodump</b> is part of the <b>Wireshark</b> distribution. The latest version of <b>Wireshark</b> can be found at
       https://www.wireshark.org.

       HTML versions of the Wireshark project man pages are available at
       https://www.wireshark.org/docs/man-pages.

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>Original</b> <b>Author</b>
       Dario Lombardo &lt;lomato[AT]gmail.com&gt;

                                                   2025-06-10                                       <u><a href="../man1/CISCODUMP.1.html">CISCODUMP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>