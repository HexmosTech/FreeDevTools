<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kcapi-enc - Kernel Crypto API Symmetric Cipher Crypto Helper</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/kcapi-tools">kcapi-tools_1.4.0-1ubuntu4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       kcapi-enc - Kernel Crypto API Symmetric Cipher Crypto Helper

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>kcapi-enc</b> [<u>OPTION</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <u>kcapi-enc</u> application provides tool to use the symmetric ciphers of the Linux kernel crypto API from
       the command line.

       The input data can be provided either via STDIN or via a file that is  referenced  with  a  command  line
       option.  Similarly, the output data can either be sent to a file referenced with a command line option or
       to STDOUT.

       The majority of symmetric ciphers are block ciphers requiring the input data to be multiples of the block
       size.  <u>kcapi-enc</u> automatically adds padding when using block ciphers and input data whose size is  not  a
       multiple  of  the cipher's block size during encryption. An automated unpadding during decryption is only
       applied when the input and output data is provided as files. If either the input  data  is  provided  via
       STDIN or the output data is obtained via STDOUT, the unpadding is not applied.

       The  used  padding schema is consistent with OpenSSL's <u>enc</u> application. Data encrypted with OpenSSL's <u>enc</u>
       tool can be decrypted with <u>kcapi-enc</u> and vice versa.

       The symmetric key used for the cryptographic operation can either be provided via a  file  descriptor  or
       via  a  password. When using a file descriptor, the provided data is taken directly as the symmetric key.
       As the Linux kernel crypto API does not allow specifying the used key size with the cipher algorithm name
       (e.g. AES-128 or AES-256 cannot be specified, but only AES), the size of the provided key  defines  which
       cipher operation is used. When providing a password, the <u>kcapi-enc</u> application derives a 256 bit key from
       the  password  using PBKDF2.  PBKDF2 with HMAC-SHA256 as default transforms the password into a key.  The
       PBKDF2 operation requires two additional input values: a  salt  and  an  iteration  count.  Both  can  be
       provided  via  the  command  line.  If  the  iteration  count  is not specified, <u>kcapi-enc</u> determines the
       iteration count internally by counting how many iterations are necessary to surpass 100ms operation time.
       The determined number is provided via STDERR and must be re-used when decrypting the data. If the salt is
       not  provided  via  command  line,  <u>kcapi-enc</u>  generates  a  256  bit  salt  and  sends  its  hexadecimal
       representation  to  STDERR.  This  salt  must  be  used  during decryption to ensure the PBKDF2 operation
       generates the correct symmetric key.

       The following options are supported when invoking <u>kcapi-enc</u>:

       <b>-c</b>, <b>--cipher</b> <u>NAME</u>
              The <u>NAME</u> argument specifies the symmetric cipher to be used. The allowed ciphers  are  defined  by
              the  Linux  kernel.  Currently registered ciphers can be reviewed at <u><a href="file:/proc/crypto">/proc/crypto</a></u>.  The content of
              this file, however, can change when new  ciphers  are  registered.  The  <u>NAME</u>  argument  is  given
              directly  to  the Linux kernel crypto API. The chosen cipher must be either of type <u>skcipher</u> or of
              type <u>aead</u> as marked in <u><a href="file:/proc/crypto">/proc/crypto</a></u>.

       <b>-e</b>, <b>--encrypt</b>
              Perform an encryption operation on the input data. This is the default behavior which implies that
              this option can be skipped.  The input data is automatically padded if the the data size is not  a
              multiple of the block size of the chosen cipher.

       <b>-d</b>, <b>--decrypt</b>
              Perform  a  decryption operation on the input data. Automated unpadding is performed only when the
              input and output data is provided via files referenced with the command line options.

       <b>-i</b>, <b>--infile</b> <u>FILE</u>
              Use the file referenced with <u>FILE</u> as the input data. If this option  is  not  provided,  <u>kcapi-enc</u>
              expects the input data via STDIN.

       <b>-o</b>, <b>--outfile</b> <u>FILE</u>
              Use  the  file  referenced  with  <u>FILE</u>  as  the  destination  for  the output of the cryptographic
              operation. If this option is not provided, <u>kcapi-enc</u> will provide the output via STDOUT.

       <b>--iv</b> <u>IV</u>
              Use the <u>IV</u> data as initialization vector for  the  cryptographic  operation.   That  <u>IV</u>  value  is
              expected to be a hexadecimal notation and must match the block size of the chosen cipher. When the
              CTR  block  chaining  mode is used, the <u>IV</u> value is the start value of the counter. When using the
              CCM cipher, the <u>IV</u> must specify the initialization vector. If the CCM nonce  should  be  specified
              instead, the option <u>--ccm-nonce</u> must be used instead.

       <b>--aad</b> <u>AAD</u>
              For  AEAD  ciphers  like  CCM,  GCM  or  the  authenc  ciphers of the Linux kernel crypto API, the
              additional authentication data can be provided with the <u>AAD</u> parameter. The  data  is  expected  in
              hexadecimal format.

       <b>--tag</b> <u>TAG</u>
              The  AEAD tag value required for the decryption operation is provided with the <u>TAG</u> parameter. This
              parameter is expected in hexadecimal format.

       <b>--taglen</b> <u>LENGTH</u>
              During encryption operation of AEAD ciphers, the tag is generated. It is permissible  to  generate
              differently  sized  tags  where  the  parameter  <u>LENGTH</u>  specifies the size of the tag value to be
              generated in bytes.

       <b>--ccm-nonce</b> <u>NONCE</u>
              Use the <u>NONCE</u> data as CCM nonce as defined in SP800-38C Appendix A.2. That <u>NONCE</u> value is expected
              to be a hexadecimal notation and must match the constraints of SP800-38C Appendix A.2.

       <b>--salt</b> <u>SALT</u>
              When performing the PBKDF2 operation to obtain the symmetric key from the password, the <u>SALT</u> value
              is used as one input parameter. To ensure the  same  symmetric  key  is  generated  from  a  given
              password,  the  same  salt  value must be used. This implies that during decryption, the same salt
              used during the encryption operation must be referenced.  <u>kcapi-enc</u> is unable to determine whether
              the symmetric key derived from the password is the correct one to decrypt the  data,  because  any
              symmetric key will always successfully decrypt data. Yet, the resulting data may be different from
              what is expected.

       <b>-p</b>, <b>--passwd</b> <u>PASSWORD</u>
              The  <u>PASSWORD</u>  parameter  provides  the  password  from which the symmetric key is derived used to
              encrypt or decrypt the data.  <b>WARNING</b> The password provided with the command line can be seen from
              other applications or users when inspecting the <u><a href="file:/proc">/proc</a></u> file system! Thus, a password SHOULD NOT  be
              used via the command line and the <u>passwdfd</u> option should be used instead.

       <b>--passwdfd</b> <u>FD</u>
              Instead of providing the password via command line, it can be injected into <u>kcapi-enc</u> using a file
              descriptor.  The file descriptor number the password will be send through can be provided with the
              <u>FD</u> option.

       <b>--pbkdfiter</b> <u>NUM</u>
              Perform <u>NUM</u> iterations of the PBKDF2 operation to derive the symmetric key.  If this option is not
              supplied, <u>kcapi-enc</u> determines a number of iterations  that  is  large  enough  to  surpass  100ms
              operational  time  for  the PBKDF2 function. The determined iteration number is logged and must be
              reused if the same symmetric key is to be generated from the same password.

       <b>--pbkdfmac</b> <u>MAC</u>
              Use the keyed message digest referenced with <u>MAC</u> for the PBKDF2 operation. If this option  is  not
              supplied, the default of <u>hmac(sha256)</u> is used.

       <b>--key-len</b> <u>LENGTH</u>
              <u>LENGTH</u>  specifies length of the key passed to the cipher algorithm.  <u>kcapi-enc</u> uses 32-byte key by
              default.

       <b>--keyfd</b> <u>FD</u>
              To provide a symmetric key that is  directly  used  for  the  cryptographic  operation,  the  file
              descriptor  referenced with <u>FD</u> must be used. Using a file descriptor is intentionally the only way
              to provide a symmetric key to <u>kcapi-enc</u>.

       <b>--nounpad</b>
              During decryption and when the input data is provided via a file as well as the output is  written
              to a file, <u>kcapi-enc</u> automatically tries to detect a padding and removes the padding data. If this
              automated unpadding is not desired, the <u>nounpad</u> option will prevent the unpadding.

       <b>-v</b>, <b>--verbose</b>
              Enable  a  verbose  operation  of  <u>kcapi-enc</u>.   Using  this  option  multiple  times increases the
              verbosity.

       <b>-q</b>, <b>--quiet</b>
              Prevent the generation of any log output. Note,  some  log  output  would  be  needed  for  proper
              operation  like  the display of the number of PBKDF2 iterations or the internally generated PBKDF2
              salt.  During quiet operation, none of this information is displayed.  Note, both information  can
              also  be  supplied  via  the  command  line  so  that  <u>kcapi-enc</u>  does  not  need to generate this
              information.

       <b>-h</b>, <b>--help</b>
              Display the help text.

       <b>--version</b>
              Display the version number of the <u>kcapi-enc</u> application.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/kcapi-dgst.1.html">kcapi-dgst</a></b>(1) <b><a href="../man1/kcapi-hasher.1.html">kcapi-hasher</a></b>(1) <b><a href="../man1/kcapi-rng.1.html">kcapi-rng</a></b>(1)

                                                   2017-08-14                                       <u><a href="../man1/KCAPI-ENC.1.html">KCAPI-ENC</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>