<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>monkeysphere - Monkeysphere client user interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/monkeysphere">monkeysphere_0.43-3.1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       monkeysphere - Monkeysphere client user interface

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>monkeysphere</b> <u>subcommand</u> <b>[</b><u>args</u><b>]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Monkeysphere</b>  is  a  framework  to  leverage  the  OpenPGP  web  of  trust  for OpenSSH and TLS key-based
       authentication.  OpenPGP keys are tracked via GnuPG, and added to  the  authorized_keys  and  known_hosts
       files used by OpenSSH for connection authentication.  Monkeysphere can also be used by a validation agent
       to validate TLS connections (e.g. https).

       <b>monkeysphere</b> is the Monkeysphere client utility.

</pre><h4><b>SUBCOMMANDS</b></h4><pre>
       <b>monkeysphere</b> takes various subcommands:

       <b>update-known_hosts</b> <b>[HOST]...</b>
              Update  the  known_hosts  file.  For each specified host, gpg will be queried for a key associated
              with the host URI (see HOST IDENTIFICATION in <b><a href="../man7/monkeysphere.7.html">monkeysphere</a>(7)),</b> optionally querying  a  keyserver.
              If  an acceptable key is found for the host (see KEY ACCEPTABILITY in <b><a href="../man7/monkeysphere.7.html">monkeysphere</a>(7)),</b> the key is
              added to the user's known_hosts file.  If a key is found but is unacceptable  for  the  host,  any
              matching  keys are removed from the user's known_hosts file.  If no gpg key is found for the host,
              nothing is done.  If no hosts are specified, all hosts listed in  the  known_hosts  file  will  be
              processed.   This subcommand will exit with a status of 0 if at least one acceptable key was found
              for a specified host, 1 if no matching keys were found at all, and 2 if matching keys  were  found
              but none were acceptable.  `k' may be used in place of `update-known_hosts'.

       <b>update-authorized_keys</b>
              Update    the    authorized_keys    file    for    the    user    executing   the   command   (see
              MONKEYSPHERE_AUTHORIZED_KEYS in ENVIRONMENT, below).  First all monkeysphere keys are cleared from
              the authorized_keys file.  Then, for each user ID in the user's authorized_user_ids file, gpg will
              be queried for keys associated with  that  user  ID,  optionally  querying  a  keyserver.   If  an
              acceptable key is found (see KEY ACCEPTABILITY in <b><a href="../man7/monkeysphere.7.html">monkeysphere</a></b>(7)), the key is added to the user's
              authorized_keys  file.   If  a key is found but is unacceptable for the user ID, any matching keys
              are removed from the user's authorized_keys file.  If no gpg key is found for the user ID, nothing
              is done.  This subcommand will exit with a status of 0 if at least one acceptable  key  was  found
              for a user ID, 1 if no matching keys were found at all, and 2 if matching keys were found but none
              were acceptable.  `a' may be used in place of `update-authorized_keys'.

       <b>gen-subkey</b> <b>[KEYID]</b>
              Generate  an  authentication  subkey for a private key in your GnuPG keyring.  KEYID is the key ID
              for the primary key for which the subkey with "authentication" capability will be  generated.   If
              no key ID is specified, but only one key exists in the secret keyring, that key will be used.  The
              length  of the generated key can be specified with the `--length' or `-l' option.  `g' may be used
              in place of `gen-subkey'.

       <b>ssh-proxycommand</b> <b>[--no-connect]</b> <b>HOST</b> <b>[PORT]</b>
              An ssh ProxyCommand that can be used to trigger a monkeysphere update of the ssh known_hosts  file
              for  a  host that is being connected to with ssh.  This works by updating the known_hosts file for
              the host first, before an attempted connection to the host is made.  Once the known_hosts file has
              been updated, a  TCP  connection  to  the  host  is  made  by  exec'ing  <a href="../man1/netcat.1.html">netcat</a>(1).   Regular  ssh
              communication  is then done over this netcat TCP connection (see ProxyCommand in <a href="../man5/ssh_config.5.html">ssh_config</a>(5) for
              more info).

              This command is meant to be run as the ssh "ProxyCommand".  This can either be done by  specifying
              the proxy command on the command line:

              <b>ssh</b> <b>-o</b> <b>ProxyCommand="monkeysphere</b> <b>ssh-proxycommand</b> <b>%h</b> <b>%p"</b> <b>...</b>

              or by adding the following line to your <a href="file:~/.ssh/config">~/.ssh/config</a> script:

              <b>ProxyCommand</b> <b>monkeysphere</b> <b>ssh-proxycommand</b> <b>%h</b> <b>%p</b>

              The  script  can  easily  be  incorporated  into other ProxyCommand scripts by calling it with the
              "--no-connect" option, i.e.:

              <b>monkeysphere</b> <b>ssh-proxycommand</b> <b>--no-connect</b> <b>$HOST</b> <b>$PORT</b>

              This will run everything except the final exec of netcat to make the TCP connection to  the  host.
              In  this  way  this  command can be added to another proxy command that does other stuff, and then
              makes the connection to the host itself.  For example, in <a href="file:~/.ssh/config">~/.ssh/config</a>:

              <b>ProxyCommand</b>  <b>sh</b>  <b>-c</b>  <b>'monkeysphere</b>  <b>ssh-proxycommand</b>  <b>--no-connect</b>  <b>%h</b>  <b>%p</b>   <b>;</b>   <b>ssh</b>   <b>-W</b>   <b>%h:%p</b>
              <b>jumphost.example.net'</b>

              KEYSERVER  CHECKING: The proxy command has a fairly nuanced policy for when keyservers are queried
              when processing a host.  If the host userID is not found in either the user's keyring  or  in  the
              known_hosts  file, then the keyserver is queried for the host userID.  If the host userID is found
              in the user's keyring, then the keyserver is not checked.  This assumes that the keyring  is  kept
              up-to-date,  in  a  cronjob  or  the  like, so that revocations are properly handled.  If the host
              userID is not found in the user's keyring, but the host is listed in the  known_hosts  file,  then
              the  keyserver  is not checked.  This last policy might change in the future, possibly by adding a
              deferred check, so that hosts that go from non-monkeysphere-enabled to  monkeysphere-enabled  will
              be properly checked.

              Setting  the  CHECK_KEYSERVER  variable  in  the  config  file or the MONKEYSPHERE_CHECK_KEYSERVER
              environment variable to either `true' or  `false'  will  override  the  keyserver-checking  policy
              defined above and either always or never check the keyserver for host key updates.

       <b>subkey-to-ssh-agent</b> <b>[ssh-add</b> <b>arguments]</b>
              Push  all authentication-capable subkeys in your GnuPG secret keyring into your running ssh-agent.
              Additional arguments are passed through to <b><a href="../man1/ssh-add.1.html">ssh-add</a></b>(1).  For example, to remove the  authentication
              subkeys,  pass  an additional `-d' argument.  To require confirmation on each use of the key, pass
              `-c'.  The MONKEYSPHERE_SUBKEYS_FOR_AGENT environment can be used to specify the full fingerprints
              of specific keys to add to the agent (space separated), instead of adding them all.   `s'  may  be
              used in place of `subkey-to-ssh-agent'.

       <b>keys-for-userid</b> <b>USERID</b>
              Output  to  stdout  all  acceptable  keys  for  a  given  user  ID.   `u'  may be used in place of
              `keys-for-userid'.

       <b>sshfprs-for-userid</b> <b>USERID</b>
              Output the ssh fingerprints of acceptable keys for a given user ID.

       <b>version</b>
              Show the monkeysphere version number.  `v' may be used in place of `version'.

       <b>help</b>   Output a brief usage summary.  `h' or `?' may be used in place of `help'.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       The following environment variables will override those specified in the monkeysphere.conf  configuration
       file (defaults in parentheses):

       MONKEYSPHERE_LOG_LEVEL
              Set  the log level.  Can be SILENT, ERROR, INFO, VERBOSE, DEBUG, in increasing order of verbosity.
              (INFO)

       MONKEYSPHERE_GNUPGHOME, GNUPGHOME
              GnuPG home directory. (<a href="file:~/.gnupg">~/.gnupg</a>)

       MONKEYSPHERE_KEYSERVER
              OpenPGP keyserver to use. (pool.sks-keyservers.net)

       MONKEYSPHERE_CHECK_KEYSERVER
              Whether or not to check keyserver when making gpg queries. (true)

       MONKEYSPHERE_KNOWN_HOSTS
              Path to ssh known_hosts file. (<a href="file:~/.ssh/known_hosts">~/.ssh/known_hosts</a>)

       MONKEYSPHERE_HASH_KNOWN_HOSTS
              Whether or not to hash to the known_hosts file entries. (false)

       MONKEYSPHERE_AUTHORIZED_KEYS
              Path to ssh authorized_keys file. (<a href="file:~/.ssh/authorized_keys">~/.ssh/authorized_keys</a>)

       MONKEYSPHERE_PROMPT
              If set to `false', never prompt the user for confirmation. (true)

       MONKEYSPHERE_STRICT_MODES
              If  set  to  `false',  ignore  too-loose  permissions   on   known_hosts,   authorized_keys,   and
              authorized_user_ids  files.  NOTE: setting this to false may expose you to abuse by other users on
              the system. (true)

       MONKEYSPHERE_SUBKEYS_FOR_AGENT
              A space-separated list of authentication-capable subkeys to add to the ssh agent  with  subkey-to-
              ssh-agent.

</pre><h4><b>FILES</b></h4><pre>
       <a href="file:~/.monkeysphere/monkeysphere.conf">~/.monkeysphere/monkeysphere.conf</a>
              User monkeysphere config file.

       /etc/monkeysphere/monkeysphere.conf
              System-wide monkeysphere config file.

       <a href="file:~/.monkeysphere/authorized_user_ids">~/.monkeysphere/authorized_user_ids</a>
              A  list  of  OpenPGP  user  IDs,  one  per  line.   OpenPGP  keys with an exactly-matching User ID
              (calculated valid by the designated identity  certifiers),  will  have  any  valid  authorization-
              capable keys or subkeys added to the given user's authorized_keys file.

</pre><h4><b>AUTHOR</b></h4><pre>
       Written by: Jameson Rollins &lt;<a href="mailto:jrollins@finestructure.net">jrollins@finestructure.net</a>&gt;, Daniel Kahn Gillmor &lt;<a href="mailto:dkg@fifthhorseman.net">dkg@fifthhorseman.net</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/monkeysphere-host.8.html">monkeysphere-host</a></b>(8), <b><a href="../man8/monkeysphere-authentication.8.html">monkeysphere-authentication</a></b>(8), <b><a href="../man7/monkeysphere.7.html">monkeysphere</a></b>(7), <b><a href="../man1/ssh.1.html">ssh</a></b>(1), <b><a href="../man1/ssh-add.1.html">ssh-add</a></b>(1), <b><a href="../man1/gpg.1.html">gpg</a></b>(1)

monkeysphere                                        June 2008                                    <u><a href="../man1/MONKEYSPHERE.1.html">MONKEYSPHERE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>