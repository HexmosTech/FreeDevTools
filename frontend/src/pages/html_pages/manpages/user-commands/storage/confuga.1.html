<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confuga - An active storage cluster file system.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/coop-computing-tools">coop-computing-tools_7.14.5-1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>Confuga</b> - An active storage cluster file system.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       chirp_server --jobs --root=<u>&lt;Confuga</u> <u>URI&gt;</u> [options]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Configures and starts a Chirp server to act as the head node for a Confuga storage cluster.

       For      complete      details      with      examples,     see     the     Confuga     User's     Manual
       (<b><a href="http://ccl.cse.nd.edu/software/manuals/confuga.html">http://ccl.cse.nd.edu/software/manuals/confuga.html</a></b>).

</pre><h4><b>OPTIONS</b></h4><pre>
       A Chirp server acting as the Confuga head node uses normal <b><a href="../man1/chirp_server.1.html">chirp_server</a>(1)</b> options. In order to  run  the
       Chirp  server  as the Confuga head node, use the <b>--root</b> switch with the Confuga URI. You must also enable
       job execution with the <b>--jobs</b> switch.

       The  format  for  the  Confuga  URI  is:  <b>confuga:///path/to/workspace?option1=value&amp;option2=value</b>.   The
       workspace  path  is  the  location  Confuga  maintains  metadata and databases for the head node. Confuga
       specific options are also passed through the URI, documented below.  Examples demonstrating how to  start
       Confuga and a small cluster are at the end of this manual.

        <b>--auth=</b><u>&lt;method&gt;</u>
              Enable  this  method  for  Head  Node to Storage Node authentication. The default is to enable all
              available authentication mechanisms.

        <b>--concurrency=</b><u>&lt;limit&gt;</u>
              Limits the number of concurrent jobs executed by the cluster. The default is 0 for limitless.

        <b>--pull-threshold=</b><u>&lt;bytes&gt;</u>
              Sets the threshold for pull transfers. The default is 128MB.

        <b>--replication=</b><u>&lt;type&gt;</u>
              Sets the replication mode for satisfying job dependencies. <b>type</b> may be <b>push-sync</b> or  <b>push-async-N</b>.
              The default is <b>push-async-1</b>.

        <b>--scheduler=</b><u>&lt;type&gt;</u>
              Sets the scheduler used to assign jobs to storage nodes. The default is <b>fifo-0</b>.

        <b>--tickets=</b><u>&lt;tickets&gt;</u>
              Sets tickets to use for authenticating with storage nodes. Paths must be absolute.

</pre><h4><b>STORAGE</b> <b>NODES</b></h4><pre>
       Confuga  uses regular Chirp servers as storage nodes. Each storage node is added to the cluster using the
       <b><a href="../man1/confuga_adm.1.html">confuga_adm</a>(1)</b> command.  All storage node Chirp servers must be run with:

       •   Ticket authentication enabled (<b>--auth=ticket</b>). Remember by default all authentication mechanisms  are
           enabled.

       •   Job execution enabled (<b>--jobs</b>).

       •   Job concurrency of at least two (<b>--job-concurrency=2</b>).

       These options are also suggested but not required:

       •   More frequent Catalog updates (<b>--catalog-update=30s</b>).

       •   Project name for the cluster (<b>--project-name=foo</b>).

       You   must  also  ensure  that  the  storage  nodes  and  the  Confuga  head  node  are  using  the  same
       <b><a href="../man1/catalog_server.1.html">catalog_server</a>(1)</b>. By default, this should be the case. The <b>EXAMPLES</b> section below  includes  an  example
       cluster using a manually hosted catalog server.

   <b>ADDING</b> <b>STORAGE</b> <b>NODES</b>
       To add storage nodes to the Confuga cluster, use the <b><a href="../man1/confuga_adm.1.html">confuga_adm</a>(1)</b> administrative tool.

</pre><h4><b>EXECUTING</b> <b>WORKFLOWS</b></h4><pre>
       The easiest way to execute workflows on Confuga is through <b><a href="../man1/makeflow.1.html">makeflow</a>(1)</b>.  Only two options to Makeflow are
       required,  <b>--batch-type</b>  and  <b>--working-dir</b>.  Confuga  uses  the Chirp job protocol, so the batch type is
       <b>chirp</b>. It is also necessary to define the executing server, the Confuga Head Node, and the <u>namespace</u>  the
       workflow executes in. For example:

               makeflow --batch-type=chirp --working-dir=chirp://confuga.example.com:9094/<b>path/to/workflow</b>

       The workflow namespace is logically prepended to all file paths defined in the Makeflow specification. So
       for example, if you have this Makeflow file:

               a: exe
                   ./exe &gt; a

       Confuga will execute <b>/path/to/workflow/exe</b> and produce the output file <b>/path/to/workflow/a</b>.

       Unlike  other  batch  systems used with Makeflow, like Condor or Work Queue, <u>all</u> <u>files</u> <u>used</u> <u>by</u> <u>a</u> <u>workflow</u>
       <u>must</u> <u>be</u> <u>in</u> <u>the</u> <u>Confuga</u> <u>file</u> <u>system</u>. Condor and Work Queue both stage workflow files from  the  submission
       site  to  the execution sites. In Confuga, the entire workflow dataset, including executables, is already
       resident.  So when executing a new workflow, you need to upload the workflow dataset to Confuga. The eas‐
       iest way to do this is using the <b><a href="../man1/chirp.1.html">chirp</a>(1)</b> command line tool:

               chirp confuga.example.com put workflow/ /path/to/

       Finally, Confuga does not save the <u>stdout</u> or <u>stderr</u> of jobs.  If you want these files for debugging  pur‐
       poses,  you  must  explicitly save them.  To streamline the process, you may use Makeflow's <b>--wrapper</b> op‐
       tions to save <u>stdout</u> and <u>stderr</u>:

               makeflow --batch-type=chirp \
                        --working-dir=chirp://confuga.example.com/ \
                        --wrapper=$'{\n{}\n} &gt; stdout.%% 2&gt; stderr.%%' \
                        --wrapper-output='stdout.%%' \
                        --wrapper-output='stderr.%%'

</pre><h4><b>EXAMPLES</b></h4><pre>
       Launch a head node with Confuga state stored in <b>./confuga.root</b>:

               chirp_server --jobs --root="confuga://$(pwd)/confuga.root/"

       Launch a head node with workspace  <b>/tmp/confuga.root</b>  using  storage  nodes  <b>chirp://localhost:10001</b>  and
       <b>chirp://localhost:10002/u/joe/confuga</b>:

               chirp_server --jobs --root='confuga:///tmp/confuga.root/'
               confuga_adm confuga:///tmp/confuga.root/ sn-add address localhost:10001
               confuga_adm confuga:///tmp/confuga.root/ sn-add -r /u/joe/confuga address localhost:10001

       Run a simple test cluster on your workstation:

               # start a catalog server in the background
               catalog_server --history=catalog.history \
                              --update-log=catalog.update \
                              --interface=127.0.0.1 \
                              &amp;
               # sleep for a time so catalog can start
               sleep 1
               # start storage node 1 in the background
               chirp_server --advertise=localhost \
                            --catalog-name=localhost \
                            --catalog-update=10s \
                            --interface=127.0.0.1 \
                            --jobs \
                            --job-concurrency=10 \
                            --root=./root.1 \
                            --port=9001 \
                            --project-name=test \
                            --transient=./tran.1 \
                            &amp;
               # start storage node 2 in the background
               chirp_server --advertise=localhost \
                            --catalog-name=localhost \
                            --catalog-update=10s \
                            --interface=127.0.0.1 \
                            --jobs \
                            --job-concurrency=10 \
                            --root=./root.2 \
                            --port=9002 \
                            --project-name=test \
                            --transient=./tran.2 \
                            &amp;
               # sleep for a time so catalog can receive storage node status
               sleep 5
               confuga_adm confuga:///$(pwd)/confuga.root/ sn-add address localhost:9001
               confuga_adm confuga:///$(pwd)/confuga.root/ sn-add address localhost:9002
               # start the Confuga head node
               chirp_server --advertise=localhost \
                            --catalog-name=localhost \
                            --catalog-update=30s \
                            --debug=confuga \
                            --jobs \
                            --root="confuga://$(pwd)/confuga.root/?auth=unix" \
                            --port=9000

</pre><h4><b>COPYRIGHT</b></h4><pre>
       The  Cooperative  Computing  Tools are Copyright (C) 2022 The University of Notre Dame.  This software is
       distributed under the GNU General Public License.  See the file COPYING for details.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/confuga_adm.1.html">confuga_adm</a>(1)</b>

       •   <b>Cooperative</b> <b>Computing</b> <b>Tools</b> <b>Documentation</b>

       •   <b>Chirp</b> <b>User</b> <b>Manual</b>

       •   <b><a href="../man1/chirp.1.html">chirp</a>(1)</b>    <b><a href="../man1/chirp_status.1.html">chirp_status</a>(1)</b>    <b><a href="../man1/chirp_fuse.1.html">chirp_fuse</a>(1)</b>    <b><a href="../man1/chirp_get.1.html">chirp_get</a>(1)</b>    <b><a href="../man1/chirp_put.1.html">chirp_put</a>(1)</b>    <b><a href="../man1/chirp_stream_files.1.html">chirp_stream_files</a>(1)</b>
           <b><a href="../man1/chirp_distribute.1.html">chirp_distribute</a>(1)</b>  <b><a href="../man1/chirp_benchmark.1.html">chirp_benchmark</a>(1)</b>  <b><a href="../man1/chirp_server.1.html">chirp_server</a>(1)</b>

CCTools 7.14.5 FINAL                                                                                  <u><a href="../man1/confuga.1.html">confuga</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>