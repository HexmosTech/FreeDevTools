<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>podman-auto-update - Auto update containers according to their auto-update policy</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/podman">podman_5.4.1+ds1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       podman-auto-update - Auto update containers according to their auto-update policy

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>podman</b> <b>auto-update</b> [<u>options</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>podman</b>  <b>auto-update</b>  pulls down new container images and restarts containers configured for auto updates.
       To make use of auto updates, the container or Kubernetes workloads must run inside a systemd unit.  After
       a successful update of an image, the containers using the image get updated  by  restarting  the  systemd
       units they run in.  Please refer to <b><a href="../man5/podman-systemd.unit.5.html">podman-systemd.unit</a>(5)</b> on how to run Podman under systemd.

       To  configure a container for auto updates, it must be created with the <b>io.containers.autoupdate</b> label or
       the <b>AutoUpdate</b> field in <b><a href="../man5/podman-systemd.unit.5.html">podman-systemd.unit</a>(5)</b> with one of the following two values:

              • <b>registry</b>: If the label is present and set to <b>registry</b>, Podman reaches out to  the  corresponding
                registry  to check if the image has been updated.  The label <b>image</b> is an alternative to <b>registry</b>
                maintained for backwards compatibility.  An image is considered updated if  the  digest  in  the
                local  storage  is  different  than  the  one of the remote image.  If an image must be updated,
                Podman pulls it down and restarts the systemd unit executing the container.  The registry policy
                requires a fully-qualified image reference (e.g., quay.io/podman/stable:latest) to  be  used  to
                create  the  container.  This enforcement is necessary to know which image to actually check and
                pull.  If an image ID was used, Podman would not know which image to check/pull anymore.

              • <b>local</b>: If the autoupdate label is set  to  <b>local</b>,  Podman  compares  the  image  digest  of  the
                container  to  the  one  in  the  local  container  storage.  If they differ, the local image is
                considered to be newer and the systemd unit gets restarted.

   <b>Auto</b> <b>Updates</b> <b>and</b> <b>Kubernetes</b> <b>YAML</b>
       Podman supports auto updates for Kubernetes workloads.  The auto-update policy can be configured directly
       via <b><a href="../man5/podman-systemd.unit.5.html">podman-systemd.unit</a>(5)</b> or inside the Kubernetes YAML with the Podman-specific  annotations  mentioned
       below:

              • <b>io.containers.autoupdate</b>: "registry|local" to apply the auto-update policy to all containers

              • <b>io.containers.autoupdate/$container</b>:   "registry|local"  to  apply  the  auto-update  policy  to
                <b>$container</b> only

              • <b>io.containers.sdnotify</b>: "conmon|container" to apply the sdnotify policy to all containers

              • <b>io.containers.sdnotify/$container</b>: "conmon|container" to apply the sdnotify policy to <b>$container</b>
                only

       By default, the autoupdate policy is set to "disabled", the sdnotify policy is set to "conmon".

   <b>Systemd</b> <b>Unit</b> <b>and</b> <b>Timer</b>
       Podman ships with a <b>podman-auto-update.service</b> systemd unit. This unit is triggered daily at midnight  by
       the  <b>podman-auto-update.timer</b>  systemd  timer.  The timer can be altered for custom time-based updates if
       desired.  The unit can further be invoked by other systemd units  (e.g.,  via  the  dependency  tree)  or
       manually via <b>systemctl</b> <b>start</b> <b>podman-auto-update.service</b>.

</pre><h4><b>OPTIONS</b></h4><pre>
   <b>--authfile=</b><u><b>path</b></u>
       Path  of  the  authentication  file.  Default  is  <b>${XDG_RUNTIME_DIR}/containers/auth.json</b>  on Linux, and
       <b>$HOME/.config/containers/auth.json</b> on Windows/macOS.  The  file  is  created  by  <b>podman</b>  <b>login</b>.  If  the
       authorization  state  is not found there, <b>$HOME/.docker/config.json</b> is checked, which is set using <b>docker</b>
       <b>login</b>.

       Note: There is also the option to override the default path of the authentication  file  by  setting  the
       <b>REGISTRY_AUTH_FILE</b> environment variable. This can be done with <b>export</b> <b>REGISTRY_AUTH_FILE=</b><u>path.</u>

       Alternatively,  the  <b>io.containers.autoupdate.authfile</b>  container label can be configured.  In that case,
       Podman will use the specified label's value instead.

   <b>--dry-run</b>
       Check for the availability of new images but do not perform any pull operation or restart any service  or
       container.  The <b>UPDATED</b> field indicates the availability of a new image with "pending".

   <b>--format=</b><u><b>format</b></u>
       Change  the  default output format.  This can be of a supported type like 'json' or a Go template.  Valid
       placeholders for the Go template are listed below:

       ┌────────────────┬─────────────────────────────────────┐
       │ <b>Placeholder</b>    │ <b>Description</b>                         │
       ├────────────────┼─────────────────────────────────────┤
       │ <b>.Container</b>     │ <b>ID</b> <b>and</b> <b>name</b> <b>of</b> <b>the</b> <b>container</b>        │
       ├────────────────┼─────────────────────────────────────┤
       │ <b>.ContainerID</b>   │ <b>ID</b> <b>of</b> <b>the</b> <b>container</b>                 │
       ├────────────────┼─────────────────────────────────────┤
       │ <b>.ContainerName</b> │ <b>Name</b> <b>of</b> <b>the</b> <b>container</b>               │
       ├────────────────┼─────────────────────────────────────┤
       │ <b>.Image</b>         │ <b>Name</b> <b>of</b> <b>the</b> <b>image</b>                   │
       ├────────────────┼─────────────────────────────────────┤
       │ <b>.Policy</b>        │ Auto-update policy of the container │
       ├────────────────┼─────────────────────────────────────┤
       │ <b>.Unit</b>          │ <b>Name</b> <b>of</b> <b>the</b> <b>systemd</b> <b>unit</b>            │
       ├────────────────┼─────────────────────────────────────┤
       │ <b>.Updated</b>       │ Update status: true,false,failed    │
       └────────────────┴─────────────────────────────────────┘

   <b>--rollback</b>
       If restarting a systemd unit after updating the image has failed, rollback to using  the  previous  image
       and restart the unit another time.  Default is true.

       Note  that detecting if a systemd unit has failed is best done by the container sending the READY message
       via SDNOTIFY.  This way, restarting the unit waits until having received the message or a timeout  kicked
       in.   Without  that,  restarting  the  systemd  unit may succeed even if the container has failed shortly
       after.

       For a container to send the READY message via SDNOTIFY it must be created with  the  <b>--sdnotify=container</b>
       option (see <a href="../man1/podman-run.1.html">podman-run</a>(1)).  The application running inside the container can then execute <b>systemd-notify</b>
       <b>--ready</b>   when  ready  or  use  the  sdnotify  bindings  of  the  specific  programming  language  (e.g.,
       <a href="../man3/sd_notify.3.html">sd_notify</a>(3)).

   <b>--tls-verify</b>
       Require HTTPS and verify certificates when contacting registries (default: <b>true</b>).  If explicitly  set  to
       <b>true</b>,  TLS  verification  is used.  If set to <b>false</b>, TLS verification is not used.  If not specified, TLS
       verification is used unless the target  registry  is  listed  as  an  insecure  registry  in  <b><a href="../man5/containersregistries.conf.5.html">containers-</a></b>
       <b><a href="../man5/containersregistries.conf.5.html">registries.conf</a>(5)</b>

</pre><h4><b>EXAMPLES</b></h4><pre>
       Create a Quadlet file configured for auto updates:

       $ cat <a href="file:~/.config/containers/systemd/sleep.container">~/.config/containers/systemd/sleep.container</a>
       [Container]
       Image=registry.fedoraproject.org/fedora:latest
       Exec=sleep infinity
       AutoUpdate=registry

       Generate a systemd service from the Quadlet file by reloading the systemd user daemon:

       $ systemctl --user daemon-reload

       Start the systemd service and make sure the container is running

       $ systemctl --user start sleep.service
       $ podman ps
       CONTAINER ID  IMAGE                                     COMMAND         CREATED        STATUS        PORTS       NAMES
       f8e4759798d4  registry.fedoraproject.org/fedora:latest  sleep infinity  2 seconds ago  Up 2 seconds              systemd-sleep

       Check if a new image is available via <b>--dry-run</b>:

       $ podman auto-update --dry-run --format "{{.Image}} {{.Updated}}"
       registry.fedoraproject.org/fedora:latest   pending

       Update the service:

       $ podman auto-update
       UNIT           CONTAINER                     IMAGE                                     POLICY      UPDATED
       sleep.service  f8e4759798d4 (systemd-sleep)  registry.fedoraproject.org/fedora:latest  registry    true

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/podman.1.html">podman</a>(1)</b>,     <b><a href="../man1/podman-generate-systemd.1.html">podman-generate-systemd</a>(1)</b>,     <b><a href="../man1/podman-run.1.html">podman-run</a>(1)</b>,    <b><a href="../man5/podman-systemd.unit.5.html">podman-systemd.unit</a>(5)</b>,    <b><a href="../man3/sd_notify.3.html">sd_notify</a>(3)</b>,
       <b><a href="../man5/systemd.unit.5.html">systemd.unit</a>(5)</b>

                                                                                           <u><a href="../man1/podman-auto-update.1.html">podman-auto-update</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>