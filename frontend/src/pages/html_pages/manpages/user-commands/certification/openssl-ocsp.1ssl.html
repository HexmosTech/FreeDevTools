<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>openssl-ocsp - Online Certificate Status Protocol command</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/openssl">openssl_3.4.1-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       openssl-ocsp - Online Certificate Status Protocol command

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>OCSP</b> <b>Client</b>
       <b>openssl</b> <b>ocsp</b> [<b>-help</b>] [<b>-out</b> <u>file</u>] [<b>-issuer</b> <u>file</u>] [<b>-cert</b> <u>file</u>] [<b>-no_certs</b>] [<b>-serial</b> <u>n</u>] [<b>-signer</b> <u>file</u>]
       [<b>-signkey</b> <u>file</u>] [<b>-sign_other</b> <u>file</u>] [<b>-nonce</b>] [<b>-no_nonce</b>] [<b>-req_text</b>] [<b>-resp_text</b>] [<b>-text</b>] [<b>-reqout</b> <u>file</u>]
       [<b>-respout</b> <u>file</u>] [<b>-reqin</b> <u>file</u>] [<b>-respin</b> <u>file</u>] [<b>-url</b> <u>URL</u>] [<b>-host</b> <u>host</u>:<u>port</u>] [<b>-path</b> <u>pathname</u>] [<b>-proxy</b>
       <u>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</u>] [<b>-no_proxy</b> <u>addresses</u>] [<b>-header</b>] [<b>-timeout</b>
       <u>seconds</u>] [<b>-VAfile</b> <u>file</u>] [<b>-validity_period</b> <u>n</u>] [<b>-status_age</b> <u>n</u>] [<b>-noverify</b>] [<b>-verify_other</b> <u>file</u>]
       [<b>-trust_other</b>] [<b>-no_intern</b>] [<b>-no_signature_verify</b>] [<b>-no_cert_verify</b>] [<b>-no_chain</b>] [<b>-no_cert_checks</b>]
       [<b>-no_explicit</b>] [<b>-port</b> <u>num</u>] [<b>-ignore_err</b>]

   <b>OCSP</b> <b>Server</b>
       <b>openssl</b> <b>ocsp</b> [<b>-index</b> <u>file</u>] [<b>-CA</b> <u>file</u>] [<b>-rsigner</b> <u>file</u>] [<b>-rkey</b> <u>file</u>] [<b>-passin</b> <u>arg</u>] [<b>-rother</b> <u>file</u>] [<b>-rsigopt</b>
       <u>nm</u>:<u>v</u>] [<b>-rmd</b> <u>digest</u>] [<b>-badsig</b>] [<b>-resp_no_certs</b>] [<b>-nmin</b> <u>n</u>] [<b>-ndays</b> <u>n</u>] [<b>-resp_key_id</b>] [<b>-nrequest</b> <u>n</u>] [<b>-multi</b>
       <u>process-count</u>] [<b>-rcid</b> <u>digest</u>] [<b>-</b><u><b>digest</b></u>] [<b>-CAfile</b> <u>file</u>] [<b>-no-CAfile</b>] [<b>-CApath</b> <u>dir</u>] [<b>-no-CApath</b>] [<b>-CAstore</b>
       <u>uri</u>] [<b>-no-CAstore</b>] [<b>-allow_proxy_certs</b>] [<b>-attime</b> <u>timestamp</u>] [<b>-no_check_time</b>] [<b>-check_ss_sig</b>] [<b>-crl_check</b>]
       [<b>-crl_check_all</b>] [<b>-explicit_policy</b>] [<b>-extended_crl</b>] [<b>-ignore_critical</b>] [<b>-inhibit_any</b>] [<b>-inhibit_map</b>]
       [<b>-partial_chain</b>] [<b>-policy</b> <u>arg</u>] [<b>-policy_check</b>] [<b>-policy_print</b>] [<b>-purpose</b> <u>purpose</u>] [<b>-suiteB_128</b>]
       [<b>-suiteB_128_only</b>] [<b>-suiteB_192</b>] [<b>-trusted_first</b>] [<b>-no_alt_chains</b>] [<b>-use_deltas</b>] [<b>-auth_level</b> <u>num</u>]
       [<b>-verify_depth</b> <u>num</u>] [<b>-verify_email</b> <u>email</u>] [<b>-verify_hostname</b> <u>hostname</u>] [<b>-verify_ip</b> <u>ip</u>] [<b>-verify_name</b> <u>name</u>]
       [<b>-x509_strict</b>] [<b>-issuer_checks</b>] [<b>-provider</b> <u>name</u>] [<b>-provider-path</b> <u>path</u>] [<b>-propquery</b> <u>propq</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The Online Certificate Status Protocol (OCSP) enables applications to determine the (revocation) state of
       an identified certificate (RFC 2560).

       This command performs many common OCSP tasks. It can be used to print out requests and responses, create
       requests and send queries to an OCSP responder and behave like a mini OCSP server itself.

</pre><h4><b>OPTIONS</b></h4><pre>
       This command operates as either a client or a server.  The options are described below, divided into
       those two modes.

   <b>OCSP</b> <b>Client</b> <b>Options</b>
       <b>-help</b>
           Print out a usage message.

       <b>-out</b> <u>filename</u>
           specify output filename, default is standard output.

       <b>-issuer</b> <u>filename</u>
           This specifies the current issuer certificate.  The input can be in PEM, DER, or PKCS#12 format.

           This option can be used multiple times.  This option <b>MUST</b> come before any <b>-cert</b> options.

       <b>-cert</b> <u>filename</u>
           Add the certificate <u>filename</u> to the request.  The input can be in PEM, DER, or PKCS#12 format.

           This  option  can  be used multiple times.  The issuer certificate is taken from the previous <b>-issuer</b>
           option, or an error occurs if no issuer certificate is specified.

       <b>-no_certs</b>
           Don't include any certificates in signed request.

       <b>-serial</b> <u>num</u>
           Same as the <b>-cert</b> option except the certificate with serial number <b>num</b> is added to the  request.  The
           serial number is interpreted as a decimal integer unless preceded by "0x". Negative integers can also
           be specified by preceding the value by a "-" sign.

       <b>-signer</b> <u>filename</u>, <b>-signkey</b> <u>filename</u>
           Sign  the  OCSP  request  using  the  certificate specified in the <b>-signer</b> option and the private key
           specified by the <b>-signkey</b> option.  The input can be in PEM, DER, or PKCS#12 format.

           If the <b>-signkey</b> option is not present then the private  key  is  read  from  the  same  file  as  the
           certificate. If neither option is specified then the OCSP request is not signed.

       <b>-sign_other</b> <u>filename</u>
           Additional  certificates  to include in the signed request.  The input can be in PEM, DER, or PKCS#12
           format.

       <b>-nonce</b>, <b>-no_nonce</b>
           Add an OCSP nonce extension to a request or disable OCSP nonce addition.  Normally if an OCSP request
           is input using the <b>-reqin</b> option no nonce is added: using the <b>-nonce</b> option will force addition of  a
           nonce.   If  an  OCSP  request  is  being  created  (using  <b>-cert</b>  and  <b>-serial</b>  options)  a nonce is
           automatically added specifying <b>-no_nonce</b> overrides this.

       <b>-req_text</b>, <b>-resp_text</b>, <b>-text</b>
           Print out the text form of the OCSP request, response or both respectively.

       <b>-reqout</b> <u>file</u>, <b>-respout</b> <u>file</u>
           Write out the DER encoded certificate request or response to <u>file</u>.

       <b>-reqin</b> <u>file</u>, <b>-respin</b> <u>file</u>
           Read OCSP request or response file from <u>file</u>. These option are ignored if OCSP  request  or  response
           creation is implied by other options (for example with <b>-serial</b>, <b>-cert</b> and <b>-host</b> options).

       <b>-url</b> <u>responder_url</u>
           Specify  the  responder  host  and optionally port and path via a URL.  Both HTTP and HTTPS (SSL/TLS)
           URLs can be specified.  The optional userinfo and fragment components are ignored.  Any  given  query
           component  is  handled  as  part of the path component.  For details, see the <b>-host</b> and <b>-path</b> options
           described next.

       <b>-host</b> <u>host</u>:<u>port</u>, <b>-path</b> <u>pathname</u>
           If the <b>-host</b> option is present then the OCSP request is sent to the host <u>host</u> on port <u>port</u>.  The <u>host</u>
           may be a domain name or an IP (v4 or v6) address, such as 127.0.0.1 or "[::1]" for localhost.  If  it
           is an IPv6 address, it must be enclosed in "[" and "]".

           The  <b>-path</b>  option  specifies  the  HTTP  pathname  to  use or "/" by default.  This is equivalent to
           specifying <b>-url</b> with scheme http:// and the given <u>host</u>, <u>port</u>, and optional <u>pathname</u>.

       <b>-proxy</b> <u>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</u>
           The HTTP(S) proxy server to use for reaching the OCSP server unless <b>-no_proxy</b> applies, see below.  If
           the host string is an IPv6 address, it must be enclosed in "[" and "]".  The proxy port  defaults  to
           80  or  443  if the scheme is "https"; apart from that the optional "http://" or "https://" prefix is
           ignored, as well as any userinfo, path, query, and fragment components.  Defaults to the  environment
           variable  "http_proxy"  if  set, else "HTTP_PROXY" in case no TLS is used, otherwise "https_proxy" if
           set, else "HTTPS_PROXY".

       <b>-no_proxy</b> <u>addresses</u>
           List of IP addresses and/or DNS names of servers not to use an HTTP(S) proxy for, separated by commas
           and/or whitespace (where in the latter case the whole argument must be enclosed in  "...").   Default
           is from the environment variable "no_proxy" if set, else "NO_PROXY".

       <b>-header</b> <u>name</u>=<u>value</u>
           Adds  the  header  <u>name</u>  with  the specified <u>value</u> to the OCSP request that is sent to the responder.
           This may be repeated.

       <b>-timeout</b> <u>seconds</u>
           Connection timeout to the OCSP responder in seconds.  On POSIX  systems,  when  running  as  an  OCSP
           responder,  this  option  also  limits  the time that the responder is willing to wait for the client
           request.  This time is measured from the time the responder accepts the connection until the complete
           request is received.

       <b>-verify_other</b> <u>file</u>
           File or URI containing additional certificates to search when attempting to locate the OCSP  response
           signing  certificate.  Some  responders  omit the actual signer's certificate from the response: this
           option can be used to supply the necessary certificate in such cases.  The input can be in PEM,  DER,
           or PKCS#12 format.

       <b>-trust_other</b>
           The certificates specified by the <b>-verify_other</b> option should be explicitly trusted and no additional
           checks will be performed on them. This is useful when the complete responder certificate chain is not
           available or trusting a root CA is not appropriate.

       <b>-VAfile</b> <u>file</u>
           File  or  URI  containing explicitly trusted responder certificates.  Equivalent to the <b>-verify_other</b>
           and <b>-trust_other</b> options.  The input can be in PEM, DER, or PKCS#12 format.

       <b>-noverify</b>
           Don't attempt to verify the OCSP response signature or the nonce values. This  option  will  normally
           only be used for debugging since it disables all verification of the responders certificate.

       <b>-no_intern</b>
           Ignore  certificates  contained in the OCSP response when searching for the signers certificate. With
           this option the signers certificate must be  specified  with  either  the  <b>-verify_other</b>  or  <b>-VAfile</b>
           options.

       <b>-no_signature_verify</b>
           Don't  check  the  signature  on the OCSP response. Since this option tolerates invalid signatures on
           OCSP responses it will normally only be used for testing purposes.

       <b>-no_cert_verify</b>
           Don't verify the OCSP response signers certificate at all. Since this option allows the OCSP response
           to be signed by any certificate it should only be used for testing purposes.

       <b>-no_chain</b>
           Do not use certificates in the response as additional untrusted CA certificates.

       <b>-no_explicit</b>
           Do not explicitly trust the root CA if it is set to be trusted for OCSP signing.

       <b>-no_cert_checks</b>
           Don't perform any additional checks on the OCSP response signers certificate.  That is  do  not  make
           any  checks  to  see  if  the  signers  certificate  is  authorised  to  provide the necessary status
           information: as a result this option should only be used for testing purposes.

       <b>-validity_period</b> <u>nsec</u>, <b>-status_age</b> <u>age</u>
           These options specify the range of times, in seconds, which will be tolerated in  an  OCSP  response.
           Each certificate status response includes a <b>notBefore</b> time and an optional <b>notAfter</b> time. The current
           time  should  fall between these two values, but the interval between the two times may be only a few
           seconds. In practice the OCSP responder and clients clocks may not be precisely synchronised  and  so
           such a check may fail. To avoid this the <b>-validity_period</b> option can be used to specify an acceptable
           error range in seconds, the default value is 5 minutes.

           If  the  <b>notAfter</b>  time  is  omitted  from  a response then this means that new status information is
           immediately available. In this case the age of the <b>notBefore</b> field is checked to see it is not  older
           than <u>age</u> seconds old.  By default this additional check is not performed.

       <b>-rcid</b> <u>digest</u>
           This option sets the digest algorithm to use for certificate identification in the OCSP response. Any
           digest supported by the <b><a href="../man1/openssl-dgst.1.html">openssl-dgst</a></b>(1) command can be used. The default is the same digest algorithm
           used in the request.

       <b>-</b><u><b>digest</b></u>
           This  option  sets  digest  algorithm  to use for certificate identification in the OCSP request. Any
           digest supported by the OpenSSL <b>dgst</b> command can be used.  The default is SHA-1. This option  may  be
           used multiple times to specify the digest used by subsequent certificate identifiers.

       <b>-CAfile</b> <u>file</u>, <b>-no-CAfile</b>, <b>-CApath</b> <u>dir</u>, <b>-no-CApath</b>, <b>-CAstore</b> <u>uri</u>, <b>-no-CAstore</b>
           See "Trusted Certificate Options" in <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1) for details.

       <b>-allow_proxy_certs</b>, <b>-attime</b>, <b>-no_check_time</b>, <b>-check_ss_sig</b>, <b>-crl_check</b>, <b>-crl_check_all</b>, <b>-explicit_policy</b>,
       <b>-extended_crl</b>, <b>-ignore_critical</b>, <b>-inhibit_any</b>, <b>-inhibit_map</b>, <b>-no_alt_chains</b>, <b>-partial_chain</b>, <b>-policy</b>,
       <b>-policy_check</b>, <b>-policy_print</b>, <b>-purpose</b>, <b>-suiteB_128</b>, <b>-suiteB_128_only</b>, <b>-suiteB_192</b>, <b>-trusted_first</b>,
       <b>-use_deltas</b>, <b>-auth_level</b>, <b>-verify_depth</b>, <b>-verify_email</b>, <b>-verify_hostname</b>, <b>-verify_ip</b>, <b>-verify_name</b>,
       <b>-x509_strict</b> <b>-issuer_checks</b>
           Set   various   options   of   certificate   chain   verification.   See  "Verification  Options"  in
           <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1) for details.

       <b>-provider</b> <u>name</u>
       <b>-provider-path</b> <u>path</u>
       <b>-propquery</b> <u>propq</u>
           See "Provider Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1), <b><a href="../man7/provider.7.html">provider</a></b>(7), and <b><a href="../man7/property.7.html">property</a></b>(7).

   <b>OCSP</b> <b>Server</b> <b>Options</b>
       <b>-index</b> <u>indexfile</u>
           The <u>indexfile</u> parameter is the name of  a  text  index  file  in  <b>ca</b>  format  containing  certificate
           revocation information.

           If  the  <b>-index</b>  option is specified then this command switches to responder mode, otherwise it is in
           client mode. The request(s) the responder processes can be  either  specified  on  the  command  line
           (using  <b>-issuer</b>  and  <b>-serial</b>  options), supplied in a file (using the <b>-reqin</b> option) or via external
           OCSP clients (if <b>-port</b> or <b>-url</b> is specified).

           If the <b>-index</b> option is present then the <b>-CA</b> and <b>-rsigner</b> options must also be present.

       <b>-CA</b> <u>file</u>
           CA certificates corresponding to the revocation information in the index file given with <b>-index</b>.  The
           input can be in PEM, DER, or PKCS#12 format.

       <b>-rsigner</b> <u>file</u>
           The certificate to sign OCSP responses with.  The input can be in PEM, DER, or PKCS#12 format.

       <b>-rkey</b> <u>file</u>
           The private key to sign OCSP responses with: if not present the file specified in the <b>-rsigner</b> option
           is used.

       <b>-passin</b> <u>arg</u>
           The  private  key  password  source.  For  more   information   about   the   format   of   <u>arg</u>   see
           <b><a href="../man1/openssl-passphrase-options.1.html">openssl-passphrase-options</a></b>(1).

       <b>-rother</b> <u>file</u>
           Additional  certificates  to  include in the OCSP response.  The input can be in PEM, DER, or PKCS#12
           format.

       <b>-rsigopt</b> <u>nm</u>:<u>v</u>
           Pass options to the signature algorithm when signing OCSP  responses.   Names  and  values  of  these
           options are algorithm-specific.

       <b>-rmd</b> <u>digest</u>
           The digest to use when signing the response.

       <b>-badsig</b>
           Corrupt the response signature before writing it; this can be useful for testing.

       <b>-resp_no_certs</b>
           Don't include any certificates in the OCSP response.

       <b>-resp_key_id</b>
           Identify the signer certificate using the key ID, default is to use the subject name.

       <b>-port</b> <u>portnum</u>
           Port to listen for OCSP requests on. Both IPv4 and IPv6 are possible.  The port may also be specified
           using the <b>-url</b> option.  A 0 argument indicates that any available port shall be chosen automatically.

       <b>-ignore_err</b>
           Ignore  malformed requests or responses: When acting as an OCSP client, retry if a malformed response
           is received. When acting as an OCSP responder, continue running instead of terminating upon receiving
           a malformed request.

       <b>-nrequest</b> <u>number</u>
           The OCSP server will exit after receiving <u>number</u> requests, default unlimited.

       <b>-multi</b> <u>process-count</u>
           Run the specified number of OCSP responder child processes, with the parent process respawning  child
           processes  as  needed.   Child  processes  will detect changes in the CA index file and automatically
           reload it.  When running as a responder <b>-timeout</b> option is recommended to limit the time  each  child
           is  willing  to wait for the client's OCSP response.  This option is available on POSIX systems (that
           support the <b>fork()</b> and other required unix system-calls).

       <b>-nmin</b> <u>minutes</u>, <b>-ndays</b> <u>days</u>
           Number of minutes or days when fresh revocation information is  available:  used  in  the  <b>nextUpdate</b>
           field.  If  neither  option  is present then the <b>nextUpdate</b> field is omitted meaning fresh revocation
           information is immediately available.

</pre><h4><b>OCSP</b> <b>RESPONSE</b> <b>VERIFICATION</b></h4><pre>
       OCSP Response follows the rules specified in RFC2560.

       Initially the OCSP responder certificate is located and the signature on the OCSP request  checked  using
       the responder certificate's public key.

       Then a normal certificate verify is performed on the OCSP responder certificate building up a certificate
       chain  in the process. The locations of the trusted certificates used to build the chain can be specified
       by the <b>-CAfile</b>, <b>-CApath</b> or <b>-CAstore</b>  options  or  they  will  be  looked  for  in  the  standard  OpenSSL
       certificates directory.

       If the initial verify fails then the OCSP verify process halts with an error.

       Otherwise  the  issuing  CA  certificate in the request is compared to the OCSP responder certificate: if
       there is a match then the OCSP verify succeeds.

       Otherwise the OCSP responder certificate's CA is checked  against  the  issuing  CA  certificate  in  the
       request.  If  there  is  a  match and the OCSPSigning extended key usage is present in the OCSP responder
       certificate then the OCSP verify succeeds.

       Otherwise, if <b>-no_explicit</b> is <b>not</b> set the root CA of the OCSP responders CA is checked to see  if  it  is
       trusted for OCSP signing. If it is the OCSP verify succeeds.

       If none of these checks is successful then the OCSP verify fails.

       What this effectively means if that if the OCSP responder certificate is authorised directly by the CA it
       is issuing revocation information about (and it is correctly configured) then verification will succeed.

       If  the  OCSP responder is a "global responder" which can give details about multiple CAs and has its own
       separate certificate chain then its root CA can be trusted for OCSP signing. For example:

        openssl x509 -in ocspCA.pem -addtrust OCSPSigning -out trustedCA.pem

       Alternatively the responder certificate itself can be explicitly trusted with the <b>-VAfile</b> option.

</pre><h4><b>NOTES</b></h4><pre>
       As noted, most of the verify options are for testing or debugging purposes.  Normally only  the  <b>-CApath</b>,
       <b>-CAfile</b>, <b>-CAstore</b> and (if the responder is a 'global VA') <b>-VAfile</b> options need to be used.

       The  OCSP  server  is  only useful for test and demonstration purposes: it is not really usable as a full
       OCSP responder. It contains only a very simple HTTP request handling and can only handle the POST form of
       OCSP queries. It also handles requests serially meaning it cannot respond to new requests  until  it  has
       processed  the  current  one.  The  text  index  file  format of revocation is also inefficient for large
       quantities of revocation data.

       It is possible to run this command in responder mode via a CGI  script  using  the  <b>-reqin</b>  and  <b>-respout</b>
       options.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Create an OCSP request and write it to a file:

        openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem -reqout req.der

       Send  a query to an OCSP responder with URL <a href="http://ocsp.myhost.com/">http://ocsp.myhost.com/</a> save the response to a file, print it
       out in text form, and verify the response:

        openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem \
            -url <a href="http://ocsp.myhost.com/">http://ocsp.myhost.com/</a> -resp_text -respout resp.der

       Read in an OCSP response and print out text form:

        openssl ocsp -respin resp.der -text -noverify

       OCSP server on port 8888 using a standard <b>ca</b> configuration, and a  separate  responder  certificate.  All
       requests and responses are printed to a file.

        openssl ocsp -index demoCA/index.txt -port 8888 -rsigner rcert.pem -CA demoCA/cacert.pem
               -text -out log.txt

       As above but exit after processing one request:

        openssl ocsp -index demoCA/index.txt -port 8888 -rsigner rcert.pem -CA demoCA/cacert.pem
            -nrequest 1

       Query status information using an internally generated request:

        openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA demoCA/cacert.pem
            -issuer demoCA/cacert.pem -serial 1

       Query status information using request read from a file, and write the response to a second file.

        openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA demoCA/cacert.pem
            -reqin req.der -respout resp.der

</pre><h4><b>HISTORY</b></h4><pre>
       The -no_alt_chains option was added in OpenSSL 1.1.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2001-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.4.1                                              2025-04-03                                 <u><a href="../man1SSL/OPENSSL-OCSP.1SSL.html">OPENSSL-OCSP</a></u>(1SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>