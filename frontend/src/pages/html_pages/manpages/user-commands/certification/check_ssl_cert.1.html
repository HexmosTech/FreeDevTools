<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>check_ssl_cert - checks the validity of X.509 certificates</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/monitoring-plugins-contrib">monitoring-plugins-contrib_46.20240417ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       check_ssl_cert - checks the validity of X.509 certificates

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>check_ssl_cert</b> -H host [OPTIONS]
       <b>check_ssl_cert</b> -f file [OPTIONS]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>check_ssl_cert</b> A shell script (that can be used as a Nagios/Icinga plugin) to check an SSL/TLS connection

</pre><h4><b>ARGUMENTS</b></h4><pre>
       <b>-f,--file</b> file
              Local  file  path  or  URI.  With  -f  you  can  not  only pass a x509 certificate file but also a
              certificate revocation list (CRL) to check the validity period or a Java KeyStore file

       <b>-H,--host</b> host
              server

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-A,--noauth</b>
              Ignore authority warnings (expiration only)

           <b>--all</b>
              Enable all the possible optional checks at the maximum level

           <b>--all-local</b>
              Enable all the possible optional checks at the maximum level (without SSL-Labs)

           <b>--allow-empty-san</b>
              Allow certificates without Subject Alternative Names (SANs)

       <b>-C,--clientcert</b> path
              Use client certificate to authenticate

       <b>-c,--critical</b> days
              Minimum number of days a certificate has to be valid to issue a critical status. Can be a floating
              point number, e.g., 0.5. Default: 15

          <b>--check-chain</b>
              The certificate chain cannot contain double or root certificates

          <b>--check-ciphers</b> grade
              Check the offered ciphers

          <b>--check-ciphers-warnings</b>
              Critical if nmap reports a warning for an offered cipher

          <b>--check-http-headers</b>
              Check the HTTP headers for best practices

          <b>--check-ssl-labs-warn</b> <b>grade</b>
              SSL Labs grade on which to warn

          <b>--clientpass</b> phrase
              Set passphrase for client certificate.

          <b>--configuration</b> file
              Read options from the specified file

          <b>--crl</b>
              Check revocation via CRL (requires --rootcert-file)

          <b>--curl-bin</b> path
              Path of the curl binary to be used

          <b>--custom-http-header</b> string
              Custom HTTP header sent when getting the cert example: 'X-Check-Ssl-Cert: Foobar=1'

          <b>--dane</b>
              Verify that valid DANE records exist (since OpenSSL 1.1.0)

          <b>--dane</b> <b>211</b>
              Verify that a valid <a href="../man2/DANE-TA.2.html">DANE-TA</a>(2) <a href="../man1/SPKI.1.html">SPKI</a>(1) <a href="../man1/SHA2-256.1.html">SHA2-256</a>(1) TLSA record exists

          <b>--dane</b> <b>301</b>
              Verify that a valid <a href="../man3/DANE-EE.3.html">DANE-EE</a>(3) <a href="../man0/Cert.0.html">Cert</a>(0) <a href="../man1/SHA2-256.1.html">SHA2-256</a>(1) TLSA record exists

          <b>--dane</b> <b>302</b>
              Verify that a valid <a href="../man3/DANE-EE.3.html">DANE-EE</a>(3) <a href="../man0/Cert.0.html">Cert</a>(0) <a href="../man2/SHA2-512.2.html">SHA2-512</a>(2) TLSA record exists

          <b>--dane</b> <b>311</b>
              Verify that a valid <a href="../man3/DANE-EE.3.html">DANE-EE</a>(3) <a href="../man1/SPKI.1.html">SPKI</a>(1) <a href="../man1/SHA2-256.1.html">SHA2-256</a>(1) TLSA record exists

          <b>--dane</b> <b>312</b>
              Verify that a valid <a href="../man3/DANE-EE.3.html">DANE-EE</a>(3) <a href="../man1/SPKI.1.html">SPKI</a>(1) <a href="../man1/SHA2-512.1.html">SHA2-512</a>(1) TLSA record exists

          <b>--date</b> path
              Path of the date binary to be used

       <b>-d,--debug</b>
              Produce debugging output (can be specified more than once)

          <b>--debug-cert</b>
              Store the retrieved certificates in the current directory

          <b>--debug-file</b> file
              Write the debug messages to file

          <b>--debug-headers</b>
              Store the retrieved HTLM headers in the headers.txt file

          <b>--debug-time</b>
              Write timing information in the debugging output

          <b>--default-format</b>
              Print the default output format and exit

          <b>--dig-bin</b> path
              Path of the dig binary to be used

          <b>--do-not-resolve</b>
              Do not check if the host can be resolved

          <b>--dtls</b>
              Use the DTLS protocol

          <b>--dtls1</b>
              Use the DTLS protocol 1.0

          <b>--dtls1_2</b>
              Use the DTLS protocol 1.2

       <b>-e,--email</b> address
              Pattern to match the email address contained in the certificate

          <b>--ecdsa</b>
              Signature algorithm selection: force ECDSA certificate

          <b>--element</b> number
              Check up to the N cert element from the beginning of the chain

          <b>--file-bin</b> path
              Path of the file binary to be used

          <b>--fingerprint</b> hash
              Pattern to match the fingerprint

          <b>--fingerprint-alg</b> algorithm
              Algorithm for fingerprint. Default sha1

          <b>--first-element-only</b>
              Verify just the first cert element, not the whole chain

          <b>--force-dconv-date</b>
              Force the usage of dconv for date computations

          <b>--force-perl-date</b>
              Force the usage of Perl for date computations

          <b>--format</b> FORMAT
              Format output template on success, for example: '%SHORTNAME% OK %CN% from %CA_ISSUER_MATCHED%'
              List of possible variables:
              - %CA_ISSUER_MATCHED%
              - %CHECKEDNAMES%
              - %CN%
              - %DATE%
              - %DAYS_VALID%
              - %DYSPLAY_CN%
              - %HOST%
              - %OCSP_EXPIRES_IN_HOURS%
              - %OPENSSL_COMMAND%
              - %PORT%
              - %SELFSIGNEDCERT%
              - %SHORTNAME%
              - %SIGALGO%
              - %SSL_LABS_HOST_GRADE%
              See --default-format for the default

          <b>--grep-bin</b> path
              Path of the grep binary to be used

       <b>-h,--help,-?</b>
              This help message

          <b>--http-headers-path</b> path
              The path to be used to fetch HTTP headers

          <b>--http-use-get</b>
              Use GET instead of HEAD (default) for the HTTP related checks

       <b>-i,--issuer</b> issuer
              Pattern to match the issuer of the certificate

         <b>--ignore-altnames</b>
              Ignore alternative names when matching pattern specified in -n (or the host name)

         <b>--ignore-connection-problems</b> [state]
              In case of connection problems returns OK or the optional state

          <b>--ignore-exp</b>
              Ignore expiration date

          <b>--ignore-http-headers</b>
              Ignore checks on HTTP headers with --all and --all-local

          <b>--ignore-host-cn</b>
              Do not complain if the CN does not match the host name

          <b>--ignore-incomplete-chain</b>
              Do not check chain integrity

          <b>--ignore-maximum-validity</b>
              Ignore the certificate maximum validity

          <b>--ignore-ocsp</b>
              Do not check revocation with OCSP

          <b>--ignore-ocsp-errors</b>
              Continue if the OCSP status cannot be checked

          <b>--ignore-ocsp-timeout</b>
              Ignore OCSP result when timeout occurs while checking

          <b>--ignore-sct</b>
              Do not check for signed certificate timestamps (SCT)

          <b>--ignore-sig-alg</b>
              Do not check if the certificate was signed with SHA1 or MD5

          <b>--ignore-ssl-labs-cache</b>
              Force a new check by SSL Labs (see -L)

          <b>--ignore-ssl-labs-errors</b>
              Ignore errors if SSL Labs is not accessible or times out

          <b>--ignore-tls-renegotiation</b>
              Ignore the TLS renegotiation check

          <b>--ignore-unexpected-eof</b>
              Ignore unclean TLS shutdowns

          <b>--inetproto</b> <b>protocol</b>
              Force IP version 4 or 6

          <b>--info</b>
              Print certificate information

          <b>--init-host-cache</b>
              Initialize the host cache

          <b>--issuer-cert-cache</b> dir
              Directory where to store issuer certificates cache

          <b>--jks-alias</b> alias
              Alias name of the Java KeyStore entry (requires --file)

       <b>-K,--clientkey</b> path
              Use client certificate key to authenticate

       <b>-L,--check-ssl-labs</b> <b>grade</b>
              SSL Labs assessment (please check https://www.ssllabs.com/about/terms.html). Critical if the grade
              is lower than specified.

          <b>--long-output</b> list
              Append the specified comma separated (no spaces) list  of  attributes  to  the  plugin  output  on
              additional  lines.   Valid  attributes  are: enddate, startdate, subject, issuer, modulus, serial,
              hash, email, ocsp_uri and fingerprint. 'all' will include all the available attributes.

       <b>-m,--match</b> name
              Pattern to match the CN or AltName (can be specified multiple times)

          <b>--maximum-validity</b> [days]
              The maximum validity of the certificate must not  exceed  'days'  (default  397).  This  check  is
              automatic for HTTPS

          <b>--nmap-bin</b> path
              Path of the nmap binary to be used

          <b>--nmap-with-proxy</b>
              Allow nmap to be used with a proxy

          <b>--no-perf</b>
              Do not show performance data

          <b>--no-proxy</b>
              Ignore the http_proxy and https_proxy environment variables

          <b>--no-proxy-curl</b>
              Ignore the http_proxy and https_proxy environment variables for curl

          <b>--no-proxy-s_client</b>
              Ignore the http_proxy and https_proxy environment variables for openssl s_client

          <b>--no-ssl2</b>
              Disable SSL version 2

          <b>--no-ssl3</b>
              Disable SSL version 3

          <b>--no-tls1</b>
              Disable TLS version 1

          <b>--no-tls1_1</b>
              Disable TLS version 1.1

          <b>--no-tls1_3</b>
              Disable TLS version 1.3

          <b>--no-tls1_2</b>
              Disable TLS version 1.2

          <b>--not-issued-by</b> issuer
              Check that the issuer of the certificate does not match the given pattern

          <b>--not-valid-longer-than</b> days
              Critical if the certificate validity is longer than the specified period

       <b>-o,--org</b> org
              Pattern to match the organization of the certificate

          <b>--ocsp-critical</b> hours
              Minimum number of hours an OCSP response has to be valid to issue a critical status

           <b>--ocsp-warning</b> hours
              Minimum number of hours an OCSP response has to be valid to issue a warning status

          <b>--openssl</b> path
              Path of the openssl binary to be used

       <b>-p,--port</b> port
              TCP port (default 443)

       <b>--precision</b> digits
              Number  of  decimal  places  for  durations:  defaults to 0 if critical or warning are integers, 2
              otherwise

       <b>-P,--protocol</b> protocol
              Use the specific protocol: dns, ftp, ftps, http, https (default), h2 (HTTP/2), h3 (HTTP/3),  imap,
              imaps, irc, ircs, ldap, ldaps, mqtts, mysql, pop3, pop3s, postgres, sieve, sips, smtp, smtps, tds,
              xmpp,  xmpp-server.  ftp,  imap,  irc,  ldap,  pop3,  postgres,  sieve,  smtp: switch to TLS using
              StartTLS.  These protocols switch to TLS using StartTLS: ftp, imap, irc, ldap, mysql, pop3, smtp.

          <b>--path</b> path
              Set the PATH variable to 'path'

          <b>--password</b> source
              Password source for a local certificate, see the PASS PHRASE ARGUMENTS section <a href="../man1/openssl.1.html">openssl</a>(1)

          <b>--prometheus</b>
              Generate Prometheus/OpenMetrics output

          <b>--proxy</b> proxy
              Set http_proxy and the s_client -proxy option

          <b>--python-bin</b> path
              Path of the python binary to be used

          <b>--quic</b>
              Use QUIC

       <b>-q,--quiet</b>
              Do not produce any output

       <b>-r,--rootcert</b> cert
              Root certificate or directory to be used for certificate validation (passed to  openssl's  -CAfile
              or -CApath)

          <b>--require-client-cert</b> [list]
              The  server  must  accept  a  client  certificate.  'list'  is an optional comma separated list of
              expected client certificate CAs

          <b>--require-dnssec</b>
              Require DNSSEC

          <b>--require-http-header</b> header
              Require the specified HTTP header (e.g., X-Frame-Options)

          <b>--require-no-http-header</b> header
              Require the absence of the specified HTTP header (e.g., X-Powered-By)

          <b>--require-no-ssl2</b>
              Critical if SSL version 2 is offered

          <b>--require-no-ssl3</b>
              Critical if SSL version 3 is offered

          <b>--require-no-tls1</b>
              Critical if TLS 1 is offered

          <b>--require-no-tls1_1</b>
              Critical if TLS 1.1 is offered

          <b>--require-ocsp-stapling</b>
              Require OCSP stapling

           <b>--require-purpose</b> usage
              Require the specified key usage (can be specified more then once)

           <b>--require-purpose-critical</b>
              The key usage must be critical

           <b>--require-security-header</b> header
              Require the specified HTTP security header (e.g., X-Frame-Options)

           <b>--require-security-headers</b>
              Require all the HTTP security headers:
                Content-Security-Policy
                Permissions-Policy
                Referrer-Policy
                strict-transport-security
                X-Content-Type-Options
                X-Frame-Options

          <b>--resolve</b> ip
              Provide a custom IP address for the specified host

          <b>--resolve-over-http</b> [server]
              Resolve the host over HTTP using Google or the specified server

          <b>--rootcert-dir</b> dir
              Root directory to be used for certificate  validation  (passed  to  openssl's  -CApath)  overrides
              option -r,--rootcert

          <b>--rootcert-file</b> cert
              Root  certificate  to  be  used for certificate validation (passed to openssl's -CAfile) overrides
              option -r,--rootcert

          <b>--rsa</b>
              Signature algorithm selection: force RSA certificate

          <b>--security-level</b> number
              Set the security level to specified value. See <a href="../man3/SSL_CTX_set_security_level.3.html">SSL_CTX_set_security_level</a>(3) for a description  of
              what each level means

       <b>-s,--selfsigned</b>
              Allow self-signed certificates

          <b>--serial</b> serialnum
              Pattern to match the serial number

       <b>--skip-element</b> number
              Skip checks on the Nth cert element (can be specified multiple times)

          <b>--sni</b> name
              Set the TLS SNI (Server Name Indication) extension in the ClientHello message to 'name'

          <b>--ssl2</b>
              Force SSL version 2

          <b>--ssl3</b>
              Force SSL version 3

       <b>-t,--timeout</b> seconds
              Timeout after the specified time (defaults to 120 seconds)

          <b>--temp</b> dir
              Directory where to store the temporary files

          <b>--terse</b>
              Terse output (also see --verbose)

          <b>--tls1</b>
              Force TLS version 1

          <b>--tls1_1</b>
              Force TLS version 1.1

          <b>--tls1_2</b>
              Force TLS version 1.2

          <b>--tls1_3</b>
              Force TLS version 1.3

       <b>-u,--url</b> URL
              HTTP request URL

          <b>--user-agent</b> string
              User agent that shall be used for HTTPS connections

       <b>-v,--verbose</b>
              Verbose output (can be specified more than once)

       <b>-V,--version</b>
              Version

       <b>-w,--warning</b> days
              Minimum  number  of  days  a  certificate  has  to  be valid to issue a warning status. Might be a
              floating point number, e.g., 0.5. Default: 20

          <b>--xmpphost</b> name
              Specify the host for the 'to' attribute of the stream element

       <b>-4</b>     Force IPv4

       <b>-6</b>     Force IPv6

</pre><h4><b>DEPRECATED</b> <b>OPTIONS</b></h4><pre>
          <b>--altnames</b>
              Match the pattern specified in -n with alternate names too (enabled by default)

       <b>-n,--cn</b> name
              Pattern to match the CN or AltName (can be specified multiple times)

          <b>--curl-user-agent</b> string
              User agent that curl shall use to obtain the issuer cert

       <b>-d,--days</b> days
              Minimum number of days a certificate has to be valid (see --critical and --warning)

       <b>-N,--host-cn</b>
              Match CN with the host name (enabled by default)

          <b>--no_ssl2</b>
              Disable SSLv2 (deprecated use --no-ssl2)

          <b>--no_ssl3</b>
              Disable SSLv3 (deprecated use --no-ssl3)

           <b>--no_tls1</b>
              Disable TLSv1 (deprecated use --no-tls1)

          <b>--no_tls1_1</b>
              Disable TLSv1.1 (deprecated use --no-tls1_1)

          <b>--no_tls1_2</b>
              Disable TLSv1.1 (deprecated use --no-tls1_2)

          <b>--no_tls1_3</b>
              Disable TLSv1.1 (deprecated use --no-tls1_3)

          <b>--ocsp</b>
              Check revocation via OCSP (enabled by default)

          <b>--require-hsts</b>
              Require HTTP Strict Transport Security (deprecated use --require-security-header strict-transport-
              security)

           <b>--require-security-headers-path</b> path
              the path to be used to fetch HTTP security headers

          <b>--require-san</b>
              Require the presence of a Subject Alternative Name extension

          <b>--require-x-frame-options</b> <b>[path]</b>
              Require the presence of the X-Frame-Options HTTP header. 'path' is the optional path to be used in
              the URL to check for the header  (deprecated  use  --require-security-header  X-Frame-Options  and
              --require-security-headers-path path)

       <b>-S,--ssl</b> version
              Force SSL version (2,3) (see: --ssl2 or --ssl3)

</pre><h4><b>CONFIGURATION</b></h4><pre>
       Command line options can be specified in a configuration file (${HOME}/.check_ssl_certrc). For example

         $ cat ${HOME}/.check_ssl_certrc
         --verbose
         --critical 20
         --warning 40

       Options  specified  in  the  configuration  file  are  read  before  processing  the arguments and can be
       overridden.

</pre><h4><b>NOTES</b></h4><pre>
       If the host has multiple certificates and the installed openssl version supports the  -servername  option
       it is possible to specify the TLS SNI (Server Name Identificator) with the -N (or --host-cn) option.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       check_ssl_cert returns a zero exist status if it finds no errors, 1 for warnings, 2 for a critical errors
       and 3 for unknown problems

</pre><h4><b>BUGS</b></h4><pre>
       Please report bugs to: https://github.com/matteocorti/check_ssl_cert/issues

</pre><h4><b>EXAMPLE</b></h4><pre>
       check_ssl_cert --host github.com --all-local

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/openssl.1.html">openssl</a>(1), <a href="../man1/openssl-x509.1.html">openssl-x509</a>(1)

2.81.0                                             March, 2024                                 <u><a href="../man1/check_ssl_cert.1.html">check_ssl_cert</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>