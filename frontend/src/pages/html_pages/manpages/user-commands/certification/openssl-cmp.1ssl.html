<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>openssl-cmp - Certificate Management Protocol (CMP, RFC 4210) application</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/openssl">openssl_3.4.1-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       openssl-cmp - Certificate Management Protocol (CMP, RFC 4210) application

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>openssl</b> <b>cmp</b> [<b>-help</b>] [<b>-config</b> <u>filename</u>] [<b>-section</b> <u>names</u>] [<b>-verbosity</b> <u>level</u>]

       Generic message options:

       [<b>-cmd</b> <u>ir|cr|kur|p10cr|rr|genm</u>] [<b>-infotype</b> <u>name</u>] [<b>-profile</b> <u>name</u>] [<b>-geninfo</b> <u>values</u>] [<b>-template</b> <u>filename</u>]
       [<b>-keyspec</b> <u>filename</u>]

       Certificate enrollment options:

       [<b>-newkey</b> <u>filename</u>|<u>uri</u>] [<b>-newkeypass</b> <u>arg</u>] [<b>-subject</b> <u>name</u>] [<b>-days</b> <u>number</u>] [<b>-reqexts</b> <u>name</u>] [<b>-sans</b> <u>spec</u>]
       [<b>-san_nodefault</b>] [<b>-policies</b> <u>name</u>] [<b>-policy_oids</b> <u>names</u>] [<b>-policy_oids_critical</b>] [<b>-popo</b> <u>number</u>] [<b>-csr</b>
       <u>filename</u>] [<b>-out_trusted</b> <u>filenames</u>|<u>uris</u>] [<b>-implicit_confirm</b>] [<b>-disable_confirm</b>] [<b>-certout</b> <u>filename</u>]
       [<b>-chainout</b> <u>filename</u>]

       Certificate enrollment and revocation options:

       [<b>-oldcert</b> <u>filename</u>|<u>uri</u>] [<b>-issuer</b> <u>name</u>] [<b>-serial</b> <u>number</u>] [<b>-revreason</b> <u>number</u>]

       Message transfer options:

       [<b>-server</b> <u>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</u>] [<b>-proxy</b>
       <u>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</u>] [<b>-no_proxy</b> <u>addresses</u>] [<b>-recipient</b> <u>name</u>]
       [<b>-path</b> <u>remote_path</u>] [<b>-keep_alive</b> <u>value</u>] [<b>-msg_timeout</b> <u>seconds</u>] [<b>-total_timeout</b> <u>seconds</u>]

       Server authentication options:

       [<b>-trusted</b> <u>filenames</u>|<u>uris</u>] [<b>-untrusted</b> <u>filenames</u>|<u>uris</u>] [<b>-srvcert</b> <u>filename</u>|<u>uri</u>] [<b>-expect_sender</b> <u>name</u>]
       [<b>-ignore_keyusage</b>] [<b>-unprotected_errors</b>] [<b>-no_cache_extracerts</b>] [<b>-srvcertout</b> <u>filename</u>] [<b>-extracertsout</b>
       <u>filename</u>] [<b>-cacertsout</b> <u>filename</u>] [<b>-oldwithold</b> <u>filename</u>] [<b>-newwithnew</b> <u>filename</u>] [<b>-newwithold</b> <u>filename</u>]
       [<b>-oldwithnew</b> <u>filename</u>] [<b>-crlcert</b> <u>filename</u>] [<b>-oldcrl</b> <u>filename</u>] [<b>-crlout</b> <u>filename</u>]

       Client authentication and protection options:

       [<b>-ref</b> <u>value</u>] [<b>-secret</b> <u>arg</u>] [<b>-cert</b> <u>filename</u>|<u>uri</u>] [<b>-own_trusted</b> <u>filenames</u>|<u>uris</u>] [<b>-key</b> <u>filename</u>|<u>uri</u>]
       [<b>-keypass</b> <u>arg</u>] [<b>-digest</b> <u>name</u>] [<b>-mac</b> <u>name</u>] [<b>-extracerts</b> <u>filenames</u>|<u>uris</u>] [<b>-unprotected_requests</b>]

       Credentials format options:

       [<b>-certform</b> <u>PEM|DER</u>] [<b>-crlform</b> <u>PEM|DER</u>] [<b>-keyform</b> <u>PEM|DER|P12|ENGINE</u>] [<b>-otherpass</b> <u>arg</u>] [<b>-engine</b> <u>id</u>]
       [<b>-provider</b> <u>name</u>] [<b>-provider-path</b> <u>path</u>] [<b>-propquery</b> <u>propq</u>]

       Random state options:

       [<b>-rand</b> <u>files</u>] [<b>-writerand</b> <u>file</u>]

       TLS connection options:

       [<b>-tls_used</b>] [<b>-tls_cert</b> <u>filename</u>|<u>uri</u>] [<b>-tls_key</b> <u>filename</u>|<u>uri</u>] [<b>-tls_keypass</b> <u>arg</u>] [<b>-tls_extra</b>
       <u>filenames</u>|<u>uris</u>] [<b>-tls_trusted</b> <u>filenames</u>|<u>uris</u>] [<b>-tls_host</b> <u>name</u>]

       Client-side debugging options:

       [<b>-batch</b>] [<b>-repeat</b> <u>number</u>] [<b>-reqin</b> <u>filenames</u>] [<b>-reqin_new_tid</b>] [<b>-reqout</b> <u>filenames</u>] [<b>-reqout_only</b> <u>filename</u>]
       [<b>-rspin</b> <u>filenames</u>] [<b>-rspout</b> <u>filenames</u>] [<b>-use_mock_srv</b>]

       Mock server options:

       [<b>-port</b> <u>number</u>] [<b>-max_msgs</b> <u>number</u>] [<b>-srv_ref</b> <u>value</u>] [<b>-srv_secret</b> <u>arg</u>] [<b>-srv_cert</b> <u>filename</u>|<u>uri</u>] [<b>-srv_key</b>
       <u>filename</u>|<u>uri</u>] [<b>-srv_keypass</b> <u>arg</u>] [<b>-srv_trusted</b> <u>filenames</u>|<u>uris</u>] [<b>-srv_untrusted</b> <u>filenames</u>|<u>uris</u>] [<b>-ref_cert</b>
       <u>filename</u>|<u>uri</u>] [<b>-rsp_cert</b> <u>filename</u>|<u>uri</u>] [<b>-rsp_crl</b> <u>filename</u>|<u>uri</u>] [<b>-rsp_extracerts</b> <u>filenames</u>|<u>uris</u>]
       [<b>-rsp_capubs</b> <u>filenames</u>|<u>uris</u>] [<b>-rsp_newwithnew</b> <u>filename</u>|<u>uri</u>] [<b>-rsp_newwithold</b> <u>filename</u>|<u>uri</u>]
       [<b>-rsp_oldwithnew</b> <u>filename</u>|<u>uri</u>] [<b>-poll_count</b> <u>number</u>] [<b>-check_after</b> <u>number</u>] [<b>-grant_implicitconf</b>]
       [<b>-pkistatus</b> <u>number</u>] [<b>-failure</b> <u>number</u>] [<b>-failurebits</b> <u>number</u>] [<b>-statusstring</b> <u>arg</u>] [<b>-send_error</b>]
       [<b>-send_unprotected</b>] [<b>-send_unprot_err</b>] [<b>-accept_unprotected</b>] [<b>-accept_unprot_err</b>] [<b>-accept_raverified</b>]

       Certificate verification options, for both CMP and TLS:

       [<b>-allow_proxy_certs</b>] [<b>-attime</b> <u>timestamp</u>] [<b>-no_check_time</b>] [<b>-check_ss_sig</b>] [<b>-crl_check</b>] [<b>-crl_check_all</b>]
       [<b>-explicit_policy</b>] [<b>-extended_crl</b>] [<b>-ignore_critical</b>] [<b>-inhibit_any</b>] [<b>-inhibit_map</b>] [<b>-partial_chain</b>]
       [<b>-policy</b> <u>arg</u>] [<b>-policy_check</b>] [<b>-policy_print</b>] [<b>-purpose</b> <u>purpose</u>] [<b>-suiteB_128</b>] [<b>-suiteB_128_only</b>]
       [<b>-suiteB_192</b>] [<b>-trusted_first</b>] [<b>-no_alt_chains</b>] [<b>-use_deltas</b>] [<b>-auth_level</b> <u>num</u>] [<b>-verify_depth</b> <u>num</u>]
       [<b>-verify_email</b> <u>email</u>] [<b>-verify_hostname</b> <u>hostname</u>] [<b>-verify_ip</b> <u>ip</u>] [<b>-verify_name</b> <u>name</u>] [<b>-x509_strict</b>]
       [<b>-issuer_checks</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>cmp</b> command is a client implementation for the Certificate Management Protocol (CMP) as defined in
       RFC4210.  It can be used to request certificates from a CA server, update their certificates, request
       certificates to be revoked, and perform other types of CMP requests.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-help</b>
           Display a summary of all options

       <b>-config</b> <u>filename</u>
           Configuration  file to use.  An empty string "" means none.  Default filename is from the environment
           variable "OPENSSL_CONF".

       <b>-section</b> <u>names</u>
           Section(s) to use within config file defining CMP options.  An empty  string  ""  means  no  specific
           section.  Default is "cmp".

           Multiple  section names may be given, separated by commas and/or whitespace (where in the latter case
           the whole argument must be enclosed in  "...").   Contents  of  sections  named  later  may  override
           contents  of  sections  named before.  In any case, as usual, the "[default]" section and finally the
           unnamed section (as far as present) can provide per-option fallback values.

       <b>-verbosity</b> <u>level</u>
           Level of verbosity for logging, error output, etc.  0 = EMERG, 1 = ALERT, 2 = CRIT,  3  =  ERR,  4  =
           WARN, 5 = NOTE, 6 = INFO, 7 = DEBUG, 8 = TRACE.  Defaults to 6 = INFO.

   <b>Generic</b> <b>message</b> <b>options</b>
       <b>-cmd</b> <u>ir|cr|kur|p10cr|rr|genm</u>
           CMP command to execute.  Currently implemented commands are:

           ir    - Initialization Request
           cr    - Certificate Request
           p10cr - PKCS#10 Certification Request (for legacy support)
           kur   - Key Update Request
           rr    - Revocation Request
           genm  - General Message

           <b>ir</b> requests initialization of an end entity into a PKI hierarchy by issuing a first certificate.

           <b>cr</b>  requests  issuing  an  additional  certificate  for  an end entity already initialized to the PKI
           hierarchy.

           <b>p10cr</b> requests issuing an additional certificate similarly to <b>cr</b> but using legacy PKCS#10 CSR format.

           <b>kur</b> requests a (key) update for an existing certificate.

           <b>rr</b> requests revocation of an existing certificate.

           <b>genm</b> requests information using a General Message, where optionally included <b>InfoTypeAndValue</b>s may be
           used to state which info is of interest.  Upon receipt of the General Response, information about all
           received ITAV <b>infoType</b>s is printed to stdout.

       <b>-infotype</b> <u>name</u>
           Set InfoType name to use for requesting specific info in <b>genm</b>, e.g.,  "signKeyPairTypes".   There  is
           specific  support  for  "caCerts",  "rootCaCert",  "certReqTemplate", and "crlStatusList" (CRL update
           retrieval).

       <b>-profile</b> <u>name</u>
           Name of a certificate profile to place in the PKIHeader generalInfo field of request messages.

       <b>-geninfo</b> <u>values</u>
           A comma-separated list of InfoTypeAndValue to place in the generalInfo  field  of  the  PKIHeader  of
           requests  messages.   Each  InfoTypeAndValue  gives an OID and an integer or string value of the form
           <u>OID</u>:int:<u>number</u> or <u>OID</u>:str:<u>text</u>, e.g., '1.2.3.4:int:56789, id-kp:str:name'.

       <b>-template</b> <u>filename</u>
           The file to save any CRMF certTemplate  in  DER  format  received  in  a  genp  message  with  id-it-
           certReqTemplate.

       <b>-keyspec</b> <u>filename</u>
           It is optional and used to specify the file to save any keySpec if present in a genp message with id-
           it-keyGenParameters.

           Note: any keySpec field contents received are logged as INFO.

   <b>Certificate</b> <b>enrollment</b> <b>options</b>
       <b>-newkey</b> <u>filename</u>|<u>uri</u>
           The  source of the private or public key for the certificate being requested.  Defaults to the public
           key in the PKCS#10 CSR given with the <b>-csr</b> option, the public key of the  reference  certificate,  or
           the current client key.

           The public portion of the key is placed in the certification request.

           Unless  <b>-cmd</b>  <u>p10cr</u>, <b>-popo</b> <u>-1</u>, or <b>-popo</b> <u>0</u> is given, the private key will be needed as well to provide
           the proof of possession (POPO), where the <b>-key</b> option may provide a fallback.

       <b>-newkeypass</b> <u>arg</u>
           Pass phrase source for the key given with the <b>-newkey</b> option.  If not given here, the  password  will
           be prompted for if needed.

           For more information about the format of <u>arg</u> see <b><a href="../man1/openssl-passphrase-options.1.html">openssl-passphrase-options</a></b>(1).

       <b>-subject</b> <u>name</u>
           X.509  Distinguished  Name  (DN)  to  use  as  subject field in the requested certificate template in
           IR/CR/KUR messages.  If the NULL-DN ("/") is given  then  no  subject  is  placed  in  the  template.
           Default is the subject DN of any PKCS#10 CSR given with the <b>-csr</b> option.  For KUR, a further fallback
           is the subject DN of the reference certificate (see <b>-oldcert</b>) if provided.  This fallback is used for
           IR and CR only if no SANs are set.

           If  provided  and  neither  of  <b>-cert</b>, <b>-oldcert</b>, or <b>-csr</b> is given, the subject DN is used as fallback
           sender of outgoing CMP messages.

           The argument must be formatted as <u>/type0=value0/type1=value1/type2=...</u>.  Special  characters  may  be
           escaped   by  "\"  (backslash);  whitespace  is  retained.   Empty  values  are  permitted,  but  the
           corresponding type will not be included.  Giving a single "/" will lead to an empty sequence of  RDNs
           (a NULL-DN).  Multi-valued RDNs can be formed by placing a "+" character instead of a "/" between the
           AttributeValueAssertions (AVAs) that specify the members of the set.  Example:

           "/DC=org/DC=OpenSSL/DC=users/UID=123456+CN=John Doe"

       <b>-days</b> <u>number</u>
           Number  of  days  the new certificate is requested to be valid for, counting from the current time of
           the host.  Also triggers the explicit request that the validity period starts from the  current  time
           (as seen by the host).

       <b>-reqexts</b> <u>name</u>
           Name  of  section in OpenSSL config file defining certificate request extensions.  If the <b>-csr</b> option
           is present, these extensions augment the extensions contained the given PKCS#10 CSR,  overriding  any
           extensions with same OIDs.

       <b>-sans</b> <u>spec</u>
           One  or  more  IP  addresses,  email  addresses, DNS names, or URIs separated by commas or whitespace
           (where in the latter case the  whole  argument  must  be  enclosed  in  "...")   to  add  as  Subject
           Alternative  Name(s) (SAN) certificate request extension.  If the special element "critical" is given
           the SANs are flagged as critical.  Cannot be used if any Subject Alternative Name  extension  is  set
           via <b>-reqexts</b>.

       <b>-san_nodefault</b>
           When  Subject  Alternative Names are not given via <b>-sans</b> nor defined via <b>-reqexts</b>, they are copied by
           default from the  reference  certificate  (see  <b>-oldcert</b>).   This  can  be  disabled  by  giving  the
           <b>-san_nodefault</b> option.

       <b>-policies</b> <u>name</u>
           Name  of section in OpenSSL config file defining policies to be set as certificate request extension.
           This option cannot be used together with <b>-policy_oids</b>.

       <b>-policy_oids</b> <u>names</u>
           One or more OID(s), separated by commas and/or  whitespace  (where  in  the  latter  case  the  whole
           argument  must  be enclosed in "...")  to add as certificate policies request extension.  This option
           cannot be used together with <b>-policies</b>.

       <b>-policy_oids_critical</b>
           Flag the policies given with <b>-policy_oids</b> as critical.

       <b>-popo</b> <u>number</u>
           Proof-of-possession (POPO) method to use for  IR/CR/KUR;  values:  -1..&lt;2&gt;  where  -1  =  NONE,  0  =
           RAVERIFIED, 1 = SIGNATURE (default), 2 = KEYENC.

           Note that a signature-based POPO can only be produced if a private key is provided via the <b>-newkey</b> or
           <b>-key</b> options.

       <b>-csr</b> <u>filename</u>
           PKCS#10  CSR  in  PEM  or  DER  format  containing a certificate request.  With <b>-cmd</b> <u>p10cr</u> it is used
           directly in a legacy P10CR message.

           When used with <b>-cmd</b> <u>ir</u>, <u>cr</u>, or <u>kur</u>, it is transformed into the respective regular  CMP  request.   In
           this  case, a private key must be provided (with <b>-newkey</b> or <b>-key</b>) for the proof of possession (unless
           <b>-popo</b> <u>-1</u> or <b>-popo</b> <u>0</u> is used) and the respective public key is placed  in  the  certification  request
           (rather than taking over the public key contained in the PKCS#10 CSR).

           PKCS#10  CSR  input  may  also  be used with <b>-cmd</b> <u>rr</u> to specify the certificate to be revoked via the
           included subject name and public key.  Its subject is used as fallback sender in CMP message  headers
           if <b>-cert</b> and <b>-oldcert</b> are not given.

       <b>-out_trusted</b> <u>filenames</u>|<u>uris</u>
           Trusted   certificate(s)  to  use  for  validating  the  newly  enrolled  certificate.   During  this
           verification, any certificate status checking is disabled.

           Multiple sources may be given, separated by commas and/or whitespace (where in the  latter  case  the
           whole argument must be enclosed in "...").  Each source may contain multiple certificates.

           The  certificate verification options <b>-verify_hostname</b>, <b>-verify_ip</b>, and <b>-verify_email</b> only affect the
           certificate verification enabled via this option.

       <b>-implicit_confirm</b>
           Request implicit confirmation of newly enrolled certificates.

       <b>-disable_confirm</b>
           Do not send certificate confirmation  message  for  newly  enrolled  certificate  without  requesting
           implicit  confirmation  to  cope  with broken servers not supporting implicit confirmation correctly.
           <b>WARNING:</b> This leads to behavior violating RFC 4210.

       <b>-certout</b> <u>filename</u>
           The file where any newly enrolled certificate should be saved.

       <b>-chainout</b> <u>filename</u>
           The file where the chain of any newly enrolled certificate should be saved.  This chain excludes  the
           leaf certificate, i.e., the newly enrolled certificate.  Also the trust anchor (the root certificate)
           is not included.

           If  the  <b>-certout</b> option is given, too, with equal <u>filename</u> argument, then the file produced contains
           both outputs concatenated: the newly enrolled certificate followed by its chain.

   <b>Certificate</b> <b>enrollment</b> <b>and</b> <b>revocation</b> <b>options</b>
       <b>-oldcert</b> <u>filename</u>|<u>uri</u>
           The certificate to be updated (i.e., renewed or re-keyed) in Key Update Request (KUR) messages or  to
           be  revoked  in  Revocation Request (RR) messages.  For KUR the certificate to be updated defaults to
           <b>-cert</b>, and the resulting certificate is called <u>reference</u> <u>certificate</u>.  For RR the certificate  to  be
           revoked  can  also  be  specified using <b>-csr</b>.  <b>-oldcert</b> and <b>-csr</b> is ignored if <b>-issuer</b> and <b>-serial</b> is
           provided.

           The reference certificate, if any,  is  also  used  for  deriving  default  subject  DN  and  Subject
           Alternative Names and the default issuer entry in the requested certificate template of an IR/CR/KUR.
           Its  public key is used as a fallback in the template of certification requests.  Its subject is used
           as sender of outgoing messages if <b>-cert</b> is not given.  Its issuer is used as default recipient in CMP
           message headers if neither <b>-recipient</b>, <b>-srvcert</b>, nor <b>-issuer</b> is given.

       <b>-issuer</b> <u>name</u>
           X.509 Distinguished Name (DN) to place as the issuer field in the requested certificate  template  in
           IR/CR/KUR/RR messages.  If the NULL-DN ("/") is given then no issuer is placed in the template.

           If provided and neither <b>-recipient</b> nor <b>-srvcert</b> is given, the issuer DN is used as fallback recipient
           of outgoing CMP messages.

           The  argument  must  be  formatted  as  <u>/type0=value0/type1=value1/type2=...</u>.   For  details  see the
           description of the <b>-subject</b> option.

       <b>-serial</b> <u>number</u>
           Specify the Serial number of certificate to be revoked in revocation request.  The serial number  can
           be decimal or hex (if preceded by "0x")

       <b>-revreason</b> <u>number</u>
           Set  CRLReason  to be included in revocation request (RR); values: 0..10 or -1 for none (which is the
           default).

           Reason numbers defined in RFC 5280 are:

              CRLReason ::= ENUMERATED {
                   unspecified             (0),
                   keyCompromise           (1),
                   cACompromise            (2),
                   affiliationChanged      (3),
                   superseded              (4),
                   cessationOfOperation    (5),
                   certificateHold         (6),
                   -- value 7 is not used
                   removeFromCRL           (8),
                   privilegeWithdrawn      (9),
                   aACompromise           (10)
               }

   <b>Message</b> <b>transfer</b> <b>options</b>
       <b>-server</b> <u>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</u>
           The <u>host</u> domain name or IP address and optionally <u>port</u> of the CMP server to connect to using HTTP(S).
           IP address may be for v4 or v6, such as 127.0.0.1 or "[::1]" for localhost.  If the host string is an
           IPv6 address, it must be enclosed in "[" and "]".

           This option excludes <u>-port</u> and <u>-use_mock_srv</u>.  It is ignored if <u>-rspin</u> is given with enough  filename
           arguments.

           If  the scheme "https" is given, the <b>-tls_used</b> option is implied.  When TLS is used, the default port
           is 443, otherwise 80.  The optional userinfo and fragment components are ignored.   Any  given  query
           component  is  handled  as part of the path component.  If a path is included it provides the default
           value for the <b>-path</b> option.

       <b>-proxy</b> <u>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</u>
           The HTTP(S) proxy server to use for reaching the CMP server unless <b>-no_proxy</b> applies, see below.   If
           the  host  string is an IPv6 address, it must be enclosed in "[" and "]".  The proxy port defaults to
           80 or 443 if the scheme is "https"; apart from that the optional "http://" or  "https://"  prefix  is
           ignored  (note  that  using  TLS may be required by <b>-tls_used</b> or <b>-server</b> with the prefix "https"), as
           well as any path, userinfo, and query, and fragment components.  Defaults to the environment variable
           "http_proxy" if set, else "HTTP_PROXY" in case no TLS is used, otherwise "https_proxy" if  set,  else
           "HTTPS_PROXY".  This option is ignored if <u>-server</u> is not given.

       <b>-no_proxy</b> <u>addresses</u>
           List of IP addresses and/or DNS names of servers not to use an HTTP(S) proxy for, separated by commas
           and/or  whitespace  (where in the latter case the whole argument must be enclosed in "...").  Default
           is from the environment variable "no_proxy" if set, else  "NO_PROXY".   This  option  is  ignored  if
           <u>-server</u> is not given.

       <b>-recipient</b> <u>name</u>
           Distinguished  Name  (DN) to use in the recipient field of CMP request message headers, i.e., the CMP
           server (usually the addressed CA).

           The recipient field in the header of a CMP  message  is  mandatory.   If  not  given  explicitly  the
           recipient  is determined in the following order: the subject of the CMP server certificate given with
           the <b>-srvcert</b> option, the <b>-issuer</b> option, the issuer  of  the  certificate  given  with  the  <b>-oldcert</b>
           option,  the  issuer of the CMP client certificate (<b>-cert</b> option), as far as any of those is present,
           else the NULL-DN as last resort.

           The argument  must  be  formatted  as  <u>/type0=value0/type1=value1/type2=...</u>.   For  details  see  the
           description of the <b>-subject</b> option.

       <b>-path</b> <u>remote_path</u>
           HTTP  path  at  the  CMP server (aka CMP alias) to use for POST requests.  Defaults to any path given
           with <b>-server</b>, else "/".

       <b>-keep_alive</b> <u>value</u>
           If the given value is 0 then HTTP connections are closed after each  response  (which  would  be  the
           default behavior of HTTP 1.0) even if a CMP transaction needs more than one round trip.  If the value
           is  1  or 2 then for each transaction a persistent connection is requested.  If the value is 2 then a
           persistent connection is required, i.e., an error occurs if  the  server  does  not  grant  it.   The
           default value is 1, which means preferring to keep the connection open.

       <b>-msg_timeout</b> <u>seconds</u>
           Number of seconds a CMP request-response message round trip is allowed to take before a timeout error
           is  returned.   A  value  &lt;=  0  means  no  limitation (waiting indefinitely).  Default is to use the
           <b>-total_timeout</b> setting.

       <b>-total_timeout</b> <u>seconds</u>
           Maximum total number of seconds a transaction may take, including polling etc.  A value &lt;= 0 means no
           limitation (waiting indefinitely).  Default is 0.

   <b>Server</b> <b>authentication</b> <b>options</b>
       <b>-trusted</b> <u>filenames</u>|<u>uris</u>
           The certificate(s), typically of root CAs, the client shall use  as  trust  anchors  when  validating
           signature-based  protection  of CMP response messages.  This option is ignored if the <b>-srvcert</b> option
           is given as well.  It provides more flexibility than <b>-srvcert</b> because the CMP protection  certificate
           of  the  server is not pinned but may be any certificate from which a chain to one of the given trust
           anchors can be constructed.

           If none of <b>-trusted</b>, <b>-srvcert</b>, and <b>-secret</b> is given, message validation errors will be thrown  unless
           <b>-unprotected_errors</b> permits an exception.

           Multiple  sources  may  be given, separated by commas and/or whitespace (where in the latter case the
           whole argument must be enclosed in "...").  Each source may contain multiple certificates.

           The certificate verification options <b>-verify_hostname</b>, <b>-verify_ip</b>, and <b>-verify_email</b> have  no  effect
           on the certificate verification enabled via this option.

       <b>-untrusted</b> <u>filenames</u>|<u>uris</u>
           Non-trusted  intermediate  CA certificate(s).  Any extra certificates given with the <b>-cert</b> option are
           appended to it.  All these certificates may be useful for cert path  construction  for  the  own  CMP
           signer  certificate  (to  include in the extraCerts field of request messages) and for the TLS client
           certificate (if TLS is used) as well as  for  chain  building  when  validating  server  certificates
           (checking signature-based CMP message protection) and when validating newly enrolled certificates.

           Multiple  sources  may  be given, separated by commas and/or whitespace (where in the latter case the
           whole argument must be enclosed in "...").  Each source may contain multiple certificates.

       <b>-srvcert</b> <u>filename</u>|<u>uri</u>
           The specific CMP server certificate to expect and  directly  trust  (even  if  it  is  expired)  when
           verifying  signature-based  protection  of  CMP response messages.  This pins the accepted server and
           results in ignoring the <b>-trusted</b> option.

           If set, the subject of the certificate is also used  as  default  value  for  the  recipient  of  CMP
           requests and as default value for the expected sender of CMP responses.

       <b>-expect_sender</b> <u>name</u>
           Distinguished  Name  (DN)  expected  in  the  sender field of incoming CMP messages.  Defaults to the
           subject DN of the pinned <b>-srvcert</b>, if any.

           This can be used to make sure that only a particular entity is accepted as CMP  message  signer,  and
           attackers  are not able to use arbitrary certificates of a trusted PKI hierarchy to fraudulently pose
           as a CMP server.  Note that this option gives slightly more freedom than setting the <b>-srvcert</b>,  which
           pins  the  server  to  the  holder  of  a particular certificate, while the expected sender name will
           continue to match after updates of the server cert.

           The argument  must  be  formatted  as  <u>/type0=value0/type1=value1/type2=...</u>.   For  details  see  the
           description of the <b>-subject</b> option.

       <b>-ignore_keyusage</b>
           Ignore  key  usage restrictions in CMP signer certificates when validating signature-based protection
           of incoming CMP messages.  By default, "digitalSignature" must be allowed by CMP signer certificates.
           This option applies to both CMP clients and the mock server.

       <b>-unprotected_errors</b>
           Accept missing or invalid protection of negative responses from the  server.   This  applies  to  the
           following message types and contents:

           •   error messages

           •   negative certificate responses (IP/CP/KUP)

           •   negative revocation responses (RP)

           •   negative PKIConf messages

           <b>WARNING:</b>  This  setting  leads  to  unspecified  behavior  and  it  is  meant  exclusively  to  allow
           interoperability with server implementations violating RFC 4210, e.g.:

           •   section 5.1.3.1 allows exceptions from protecting only for special cases: "There MAY be cases  in
               which  the  PKIProtection  BIT STRING is deliberately not used to protect a message [...] because
               other protection, external to PKIX, will be applied instead."

           •   section 5.3.21 is clear on ErrMsgContent: "The CA MUST always sign it with a signature key."

           •   appendix D.4 shows PKIConf message having protection

       <b>-no_cache_extracerts</b>
           Do not cache certificates in the extraCerts field of CMP messages received.   By  default,  they  are
           kept  as they may be helful for validating further messages.  This option applies to both CMP clients
           and the mock server.

       <b>-srvcertout</b> <u>filename</u>
           The file where to save the successfully validated certificate, if any, that the CMP server  used  for
           signature-based  response message protection.  If there is no such certificate, typically because the
           protection was MAC-based, this is indicated by deleting the file (if it existed).

       <b>-extracertsout</b> <u>filename</u>
           The file where to save the list of certificates  contained  in  the  extraCerts  field  of  the  last
           received response message that is not a pollRep nor PKIConf.

       <b>-cacertsout</b> <u>filename</u>
           The  file  where  to  save  the  list  of CA certificates contained in the caPubs field if a positive
           certificate response (i.e., IP, CP, or KUP) message was received or contained in a  general  response
           (genp) message with infoType "caCerts".

       <b>-oldwithold</b> <u>filename</u>
           The  root  CA  certificate to include in a genm request of infoType "rootCaCert".  If present and the
           optional oldWithNew certificate is received, it is verified using the newWithNew certificate  as  the
           (only) trust anchor.

       <b>-newwithnew</b> <u>filename</u>
           This  option  must be provided when <b>-infotype</b> <u>rootCaCert</u> is given.  It specifies the file to save the
           newWithNew certificate received in a genp message of type "rootCaKeyUpdate".  If on success  no  such
           cert  was  received,  this  file  (if  present)  is  deleted  to  indicate that the requested root CA
           certificate update is not available.

           Any received newWithNew  certificate  is  verified  using  any  received  newWithOld  certificate  as
           untrusted  intermediate certificate and the certificate provided with <b>-oldwithold</b> as the (only) trust
           anchor, or if not provided, using the certificates given with the <b>-trusted</b> option.

           <b>WARNING:</b> The newWithNew certificate is meant to be a certificate that will  be  trusted.   The  trust
           placed  in  it  cannot  be  stronger than the trust placed in the <b>-oldwithold</b> certificate if present,
           otherwise it cannot be stronger than the weakest trust placed in any of the <b>-trusted</b> certificates.

       <b>-newwithold</b> <u>filename</u>
           The file to save any newWithOld certificate received in a genp message of infoType "rootCaKeyUpdate".
           If on success no such cert was received, this is indicated by deleting the file.

       <b>-oldwithnew</b> <u>filename</u>
           The file to save any oldWithNew certificate received in a genp message of infoType "rootCaKeyUpdate".
           If on success no such cert was received, this is indicated by deleting the file.

       <b>-crlcert</b> <u>filename</u>
           Certificate to derive CRL issuer data for the source field when obtaining a CRL  in  a  genm  request
           with infoType "crlStatusList".  Any available distribution point name is preferred over issuer names.

       <b>-oldcrl</b> <u>filename</u>
           The CRL to obtain an update for in a genm request with infoType "crlStatusList".  Unless the <b>-crlcert</b>
           option  is provided as well, the given CRL is used for deriving CRL issuer data for the source field.
           Any available distribution point name is  preferred  over  issuer  names.   If  the  CRL  contains  a
           thisUpdate field, its value is copied to the request.

       <b>-crlout</b> <u>filename</u>
           The  file  to  save any CRL received in a genp message of infoType "crls".  If on success no such CRL
           was received, this is indicated by deleting the file.

   <b>Client</b> <b>authentication</b> <b>options</b>
       <b>-ref</b> <u>value</u>
           Reference number/string/value to use as fallback senderKID; this is required if no sender name can be
           determined from the <b>-cert</b> or &lt;-subject&gt; options and is typically used when authenticating  with  pre-
           shared key (password-based MAC).

       <b>-secret</b> <u>arg</u>
           Provides  the  source  of  a  secret  value  to  use  with  MAC-based message protection.  This takes
           precedence over the <b>-cert</b> and <b>-key</b> options.  The secret is used for creating MAC-based protection  of
           outgoing messages and for validating incoming messages that have MAC-based protection.  The algorithm
           used  by  default  is Password-Based Message Authentication Code (PBM) as defined in RFC 4210 section
           5.1.3.1.

           For more information about the format of <u>arg</u> see <b><a href="../man1/openssl-passphrase-options.1.html">openssl-passphrase-options</a></b>(1).

       <b>-cert</b> <u>filename</u>|<u>uri</u>
           The client's current CMP signer certificate.  Requires the corresponding key to be given with <b>-key</b>.

           The subject and the public key contained  in  this  certificate  serve  as  fallback  values  in  the
           certificate template of IR/CR/KUR messages.

           The subject of this certificate will be used as sender of outgoing CMP messages, while the subject of
           <b>-oldcert</b> or <b>-subjectName</b> may provide fallback values.

           The issuer of this certificate is used as one of the recipient fallback values and as fallback issuer
           entry in the certificate template of IR/CR/KUR messages.

           When  performing  signature-based  message  protection,  this  "protection  certificate", also called
           "signer certificate", will be included first in the extraCerts field of  outgoing  messages  and  the
           signature  is  done  with the corresponding key.  In Initialization Request (IR) messages this can be
           used for authenticating using an external entity certificate as defined in appendix E.7 of RFC 4210.

           For Key Update Request (KUR) messages this is also used as the  certificate  to  be  updated  if  the
           <b>-oldcert</b> option is not given.

           If  the  file includes further certs, they are appended to the untrusted certs because they typically
           constitute the chain of the client  certificate,  which  is  included  in  the  extraCerts  field  in
           signature-protected request messages.

       <b>-own_trusted</b> <u>filenames</u>|<u>uris</u>
           If  this  list  of  certificates  is  provided  then  the  chain built for the client-side CMP signer
           certificate given with the <b>-cert</b> option is verified using the given certificates as trust anchors.

           Multiple sources may be given, separated by commas and/or whitespace (where in the  latter  case  the
           whole argument must be enclosed in "...").  Each source may contain multiple certificates.

           The  certificate  verification options <b>-verify_hostname</b>, <b>-verify_ip</b>, and <b>-verify_email</b> have no effect
           on the certificate verification enabled via this option.

       <b>-key</b> <u>filename</u>|<u>uri</u>
           The corresponding private key file for the client's current certificate given in  the  <b>-cert</b>  option.
           This  will  be  used for signature-based message protection unless the <b>-secret</b> option indicating MAC-
           based protection or <b>-unprotected_requests</b> is given.

           It is also used as a fallback for the <b>-newkey</b> option with IR/CR/KUR messages.

       <b>-keypass</b> <u>arg</u>
           Pass phrase source for the private key given with the <b>-key</b> option.  Also used for <b>-cert</b> and  <b>-oldcert</b>
           in  case  it  is  an encrypted PKCS#12 file.  If not given here, the password will be prompted for if
           needed.

           For more information about the format of <u>arg</u> see <b><a href="../man1/openssl-passphrase-options.1.html">openssl-passphrase-options</a></b>(1).

       <b>-digest</b> <u>name</u>
           Specifies name of supported digest to use in RFC 4210's MSG_SIG_ALG and as the one-way function (OWF)
           in "MSG_MAC_ALG".  If applicable, this is used for message protection and proof-of-possession  (POPO)
           signatures.   To see the list of supported digests, use "openssl list -digest-commands".  Defaults to
           "sha256".

       <b>-mac</b> <u>name</u>
           Specifies the name of the MAC algorithm  in  "MSG_MAC_ALG".   To  get  the  names  of  supported  MAC
           algorithms  use  "openssl  list  -mac-algorithms" and possibly combine such a name with the name of a
           supported digest algorithm, e.g., hmacWithSHA256.  Defaults to "hmac-sha1" as per RFC 4210.

       <b>-extracerts</b> <u>filenames</u>|<u>uris</u>
           Certificates to append in the extraCerts field when sending  messages.   They  can  be  used  as  the
           default CMP signer certificate chain to include.

           Multiple  sources  may  be given, separated by commas and/or whitespace (where in the latter case the
           whole argument must be enclosed in "...").  Each source may contain multiple certificates.

       <b>-unprotected_requests</b>
           Send request messages without CMP-level protection.

   <b>Credentials</b> <b>format</b> <b>options</b>
       <b>-certform</b> <u>PEM|DER</u>
           File format to use when saving a certificate to a file.  Default value is PEM.

       <b>-crlform</b> <u>PEM|DER</u>
           File format to use when saving a CRL to a file.  Default value  is  DER.   DER  format  is  preferred
           because it enables more efficient storage of large CRLs.

       <b>-keyform</b> <u>PEM|DER|P12|ENGINE</u>
           The format of the key input; unspecified by default.  See "Format Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1) for details.

       <b>-otherpass</b> <u>arg</u>
           Pass  phrase  source  for  certificate  given  with the <b>-trusted</b>, <b>-untrusted</b>, <b>-own_trusted</b>, <b>-srvcert</b>,
           <b>-crlcert</b>,   <b>-out_trusted</b>,   <b>-extracerts</b>,   <b>-srv_trusted</b>,   <b>-srv_untrusted</b>,   <b>-ref_cert</b>,    <b>-rsp_cert</b>,
           <b>-rsp_extracerts</b>,  <b>-rsp_capubs</b>,  <b>-rsp_newwithnew</b>,  <b>-rsp_newwithold</b>,  <b>-rsp_oldwithnew</b>,  <b>-tls_extra</b>, and
           <b>-tls_trusted</b> options.  If not given here, the password will be prompted for if needed.

           For more information about the format of <u>arg</u> see <b><a href="../man1/openssl-passphrase-options.1.html">openssl-passphrase-options</a></b>(1).

       <b>-engine</b> <u>id</u>
           See "Engine Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1).  This option is deprecated.

           As an alternative to using this combination:

               -engine {engineid} -key {keyid} -keyform ENGINE

           ... it's also possible to just give the key ID in URI form to <b>-key</b>, like this:

               -key org.openssl.engine:{engineid}:{keyid}

           This applies to all options specifying keys: <b>-key</b>, <b>-newkey</b>, and <b>-tls_key</b>.

   <b>Provider</b> <b>options</b>
       <b>-provider</b> <u>name</u>
       <b>-provider-path</b> <u>path</u>
       <b>-propquery</b> <u>propq</u>
           See "Provider Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1), <b><a href="../man7/provider.7.html">provider</a></b>(7), and <b><a href="../man7/property.7.html">property</a></b>(7).

   <b>Random</b> <b>state</b> <b>options</b>
       <b>-rand</b> <u>files</u>, <b>-writerand</b> <u>file</u>
           See "Random State Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1) for details.

   <b>TLS</b> <b>connection</b> <b>options</b>
       <b>-tls_used</b>
           Make the CMP client use TLS (regardless if other TLS-related options are set)  for  message  exchange
           with  the server via HTTP.  This option is not supported with the <u>-port</u> option.  It is implied if the
           <b>-server</b> option is given with the scheme "https".  It is ignored if the <b>-server</b> option is not given or
           <b>-use_mock_srv</b> is given or <b>-rspin</b> is given with enough filename arguments.

           The following TLS-related options are ignored if TLS is not used.

       <b>-tls_cert</b> <u>filename</u>|<u>uri</u>
           Client's TLS certificate to use for authenticating to the TLS server.  If the source includes further
           certs they are used (along with <b>-untrusted</b> certs) for constructing the client cert chain provided  to
           the TLS server.

       <b>-tls_key</b> <u>filename</u>|<u>uri</u>
           Private key for the client's TLS certificate.

       <b>-tls_keypass</b> <u>arg</u>
           Pass  phrase  source for client's private TLS key <b>-tls_key</b>.  Also used for <b>-tls_cert</b> in case it is an
           encrypted PKCS#12 file.  If not given here, the password will be prompted for if needed.

           For more information about the format of <u>arg</u> see <b><a href="../man1/openssl-passphrase-options.1.html">openssl-passphrase-options</a></b>(1).

       <b>-tls_extra</b> <u>filenames</u>|<u>uris</u>
           Extra certificates to provide to the TLS server during handshake.

       <b>-tls_trusted</b> <u>filenames</u>|<u>uris</u>
           Trusted certificate(s) to use for validating the  TLS  server  certificate.   This  implies  hostname
           validation.

           Multiple  sources  may  be given, separated by commas and/or whitespace (where in the latter case the
           whole argument must be enclosed in "...").  Each source may contain multiple certificates.

           The certificate verification options <b>-verify_hostname</b>, <b>-verify_ip</b>, and <b>-verify_email</b> have  no  effect
           on the certificate verification enabled via this option.

       <b>-tls_host</b> <u>name</u>
           Address  to  be checked during hostname validation.  This may be a DNS name or an IP address.  If not
           given it defaults to the <b>-server</b> address.

   <b>Client-side</b> <b>options</b> <b>for</b> <b>debugging</b> <b>and</b> <b>offline</b> <b>scenarios</b>
       <b>-batch</b>
           Do not interactively prompt for input, for instance when a password is needed.  This  can  be  useful
           for batch processing and testing.

       <b>-repeat</b> <u>number</u>
           Invoke  the  command  the  given  positive  number of times with the same parameters.  Default is one
           invocation.

       <b>-reqin</b> <u>filenames</u>
           Take the sequence of CMP requests to send to the server from the given file(s) rather than  from  the
           sequence of requests produced internally.

           This  option  is  useful for supporting offline scenarios where the certificate request (or any other
           CMP request) is produced beforehand and sent out later.

           This option is ignored if the <b>-rspin</b> option is given because in  the  latter  case  no  requests  are
           actually sent.

           Note  that in any case the client produces internally its sequence of CMP request messages. Thus, all
           options required for doing this (such as <b>-cmd</b> and all options providing the required parameters) need
           to be given also when the <b>-reqin</b> option is present.

           If the <b>-reqin</b> option is given for a certificate request and  no  <b>-newkey</b>,  <b>-key</b>,  <b>-oldcert</b>,  or  <b>-csr</b>
           option  is  given, a fallback public key is taken from the request message file (if it is included in
           the certificate template).

           Hint: In case the <b>-reqin</b> option is given for a certificate request, there are  situations  where  the
           client  has  access to the public key to be certified but not to the private key that by default will
           be needed for proof of possession.  In this case  the  POPO  is  not  actually  needed  (because  the
           internally produced certificate request message will not be sent), and its generation can be disabled
           using the options <b>-popo</b> <u>-1</u> or <b>-popo</b> <u>0</u>.

           Multiple  filenames may be given, separated by commas and/or whitespace (where in the latter case the
           whole argument must be enclosed in "...").

           The files are read as far as needed to complete the transaction and filenames have been provided.  If
           more requests are needed, the remaining ones are taken from the items at the respective  position  in
           the sequence of requests produced internally.

           The  client  needs to update the recipNonce field in the given requests (except for the first one) in
           order to satisfy the checks to be performed by the server.  This causes re-protection (if  protecting
           requests is required).

       <b>-reqin_new_tid</b>
           Use a fresh transactionID for CMP request messages read using <b>-reqin</b>, which causes their reprotection
           (if  protecting requests is required).  This may be needed in case the sequence of requests is reused
           and the CMP server complains that the transaction ID has already been used.

       <b>-reqout</b> <u>filenames</u>
           Save the sequence of CMP requests created by the client to the given file(s).  These requests are not
           sent to the server if the <b>-reqin</b> option is used, too.

           Multiple filenames may be given, separated by commas and/or whitespace.

           Files are written as far as needed to save the transaction and filenames have been provided.  If  the
           transaction contains more requests, the remaining ones are not saved.

       <b>-reqout_only</b> <u>filename</u>
           Save the first CMP requests created by the client to the given file and exit.  Any options related to
           CMP servers and their responses are ignored.

           This  option  is  useful for supporting offline scenarios where the certificate request (or any other
           CMP request) is produced beforehand and sent out later.

       <b>-rspin</b> <u>filenames</u>
           Process the sequence of CMP responses provided in the given file(s), not contacting any given server,
           as long as enough filenames are provided to complete the transaction.

           Multiple filenames may be given, separated by commas and/or whitespace.

           Any server specified via the <u>-server</u> or <u>-use_mock_srv</u> options is contacted only if more responses are
           needed to complete the transaction.  In this case the transaction will fail  unless  the  server  has
           been prepared to continue the already started transaction.

       <b>-rspout</b> <u>filenames</u>
           Save the sequence of actually used CMP responses to the given file(s).  These have been received from
           the server unless <b>-rspin</b> takes effect.

           Multiple filenames may be given, separated by commas and/or whitespace.

           Files  are  written as far as needed to save the responses contained in the transaction and filenames
           have been provided.  If the transaction contains more responses, the remaining ones are not saved.

       <b>-use_mock_srv</b>
           Test the client using the internal CMP server mock-up at API level, bypassing  socket-based  transfer
           via HTTP.  This excludes the <b>-server</b> and <b>-port</b> options.

   <b>Mock</b> <b>server</b> <b>options</b>
       <b>-port</b> <u>number</u>
           Act  as  HTTP-based CMP server mock-up listening on the given local port.  The client may address the
           server via, e.g., 127.0.0.1 or "[::1]".  This option excludes the <b>-server</b> and <b>-use_mock_srv</b>  options.
           The <b>-rspin</b>, <b>-rspout</b>, <b>-reqin</b>, and <b>-reqout</b> options so far are not supported in this mode.

       <b>-max_msgs</b> <u>number</u>
           Maximum  number  of  CMP  (request) messages the CMP HTTP server mock-up should handle, which must be
           nonnegative.  The default value is 0, which means that no limit is imposed.  In any case  the  server
           terminates  on  internal  errors,  but not when it detects a CMP-level error that it can successfully
           answer with an error message.

       <b>-srv_ref</b> <u>value</u>
           Reference value to use as senderKID of server in case no <b>-srv_cert</b> is given.

       <b>-srv_secret</b> <u>arg</u>
           Password source for server authentication with a pre-shared key (secret).

       <b>-srv_cert</b> <u>filename</u>|<u>uri</u>
           Certificate of the server.

       <b>-srv_key</b> <u>filename</u>|<u>uri</u>
           Private key used by the server for signing messages.

       <b>-srv_keypass</b> <u>arg</u>
           Server private key (and cert) file pass phrase source.

       <b>-srv_trusted</b> <u>filenames</u>|<u>uris</u>
           Trusted certificates for client authentication.

           The certificate verification options <b>-verify_hostname</b>, <b>-verify_ip</b>, and <b>-verify_email</b> have  no  effect
           on the certificate verification enabled via this option.

       <b>-srv_untrusted</b> <u>filenames</u>|<u>uris</u>
           Intermediate CA certs that may be useful when validating client certificates.

       <b>-ref_cert</b> <u>filename</u>|<u>uri</u>
           Certificate to be expected for RR messages and any oldCertID in KUR messages.

       <b>-rsp_cert</b> <u>filename</u>|<u>uri</u>
           Certificate to be returned as mock enrollment result.

       <b>-rsp_crl</b> <u>filename</u>|<u>uri</u>
           CRL to be returned in genp of type "crls".

       <b>-rsp_extracerts</b> <u>filenames</u>|<u>uris</u>
           Extra certificates to be included in mock certification responses.

       <b>-rsp_capubs</b> <u>filenames</u>|<u>uris</u>
           CA certificates to be included in mock Initialization Response (IP) message.

       <b>-rsp_newwithnew</b> <u>filename</u>|<u>uri</u>
           Certificate to be returned in newWithNew field of genp of type rootCaKeyUpdate.

       <b>-rsp_newwithold</b> <u>filename</u>|<u>uri</u>
           Certificate to be returned in newWithOld field of genp of type rootCaKeyUpdate.

       <b>-rsp_oldwithnew</b> <u>filename</u>|<u>uri</u>
           Certificate to be returned in oldWithNew field of genp of type rootCaKeyUpdate.

       <b>-poll_count</b> <u>number</u>
           Number of times the client must poll before receiving a certificate.

       <b>-check_after</b> <u>number</u>
           The checkAfter value (number of seconds to wait) to include in poll response.

       <b>-grant_implicitconf</b>
           Grant implicit confirmation of newly enrolled certificate.

       <b>-pkistatus</b> <u>number</u>
           PKIStatus to be included in server response.  Valid range is 0 (accepted) .. 6 (keyUpdateWarning).

       <b>-failure</b> <u>number</u>
           A  single failure info bit number to be included in server response.  Valid range is 0 (badAlg) .. 26
           (duplicateCertReq).

       <b>-failurebits</b> <u>number</u> Number representing failure bits to be included in server response. Valid range is 0
       .. 2^27 - 1.
       <b>-statusstring</b> <u>arg</u>
           Text to be included as status string in server response.

       <b>-send_error</b>
           Force server to reply with error message.

       <b>-send_unprotected</b>
           Send response messages without CMP-level protection.

       <b>-send_unprot_err</b>
           In case of negative responses, server shall send unprotected error  messages,  certificate  responses
           (IP/CP/KUP),  and  revocation  responses (RP).  WARNING: This setting leads to behavior violating RFC
           4210.

       <b>-accept_unprotected</b>
           Accept missing or invalid protection of requests.

       <b>-accept_unprot_err</b>
           Accept unprotected error messages from client.  So far this has no effect because the server does not
           accept any error messages.

       <b>-accept_raverified</b>
           Accept RAVERIFED as proof of possession (POPO).

   <b>Certificate</b> <b>verification</b> <b>options,</b> <b>for</b> <b>both</b> <b>CMP</b> <b>and</b> <b>TLS</b>
       <b>-allow_proxy_certs</b>, <b>-attime</b>, <b>-no_check_time</b>, <b>-check_ss_sig</b>, <b>-crl_check</b>, <b>-crl_check_all</b>, <b>-explicit_policy</b>,
       <b>-extended_crl</b>, <b>-ignore_critical</b>, <b>-inhibit_any</b>, <b>-inhibit_map</b>, <b>-no_alt_chains</b>, <b>-partial_chain</b>, <b>-policy</b>,
       <b>-policy_check</b>, <b>-policy_print</b>, <b>-purpose</b>, <b>-suiteB_128</b>, <b>-suiteB_128_only</b>, <b>-suiteB_192</b>, <b>-trusted_first</b>,
       <b>-use_deltas</b>, <b>-auth_level</b>, <b>-verify_depth</b>, <b>-verify_email</b>, <b>-verify_hostname</b>, <b>-verify_ip</b>, <b>-verify_name</b>,
       <b>-x509_strict</b> <b>-issuer_checks</b>
           Set  various  options  of  certificate   chain   verification.    See   "Verification   Options"   in
           <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1) for details.

           The  certificate verification options <b>-verify_hostname</b>, <b>-verify_ip</b>, and <b>-verify_email</b> only affect the
           certificate verification enabled via the <b>-out_trusted</b> option.

</pre><h4><b>NOTES</b></h4><pre>
       When a client obtains, from a CMP server, CA certificates that it is going to trust, for instance via the
       "caPubs" field  of  a  certificate  response  or  using  general  messages  with  infoType  "caCerts"  or
       "rootCaCert",  authentication  of the CMP server is particularly critical.  So special care must be taken
       setting up server authentication using <b>-trusted</b> and related options for certificate-based  authentication
       or  <b>-secret</b>  for  MAC-based  protection.   If authentication is certificate-based, the <b>-srvcertout</b> option
       should be used to obtain the validated server certificate and perform an authorization check based on it.

       When setting up CMP configurations and experimenting with enrollment  options  typically  various  errors
       occur  until  the configuration is correct and complete.  When the CMP server reports an error the client
       will by default check the protection of the CMP response message.  Yet some  CMP  services  tend  not  to
       protect  negative  responses.   In this case the client will reject them, and thus their contents are not
       shown although they usually contain hints that would be helpful for diagnostics.  For assisting  in  such
       cases  the CMP client offers a workaround via the <b>-unprotected_errors</b> option, which allows accepting such
       negative messages.

       If OpenSSL was built with trace support enabled  (e.g.,  "./config  enable-trace")  and  the  environment
       variable  <b>OPENSSL_TRACE</b>  includes  <b>HTTP</b>,  the  requests and the response headers transferred via HTTP are
       printed.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Simple</b> <b>examples</b> <b>using</b> <b>the</b> <b>default</b> <b>OpenSSL</b> <b>configuration</b> <b>file</b>
       This CMP client implementation comes with demonstrative CMP sections in the  example  configuration  file
       <u>openssl/apps/openssl.cnf</u>, which can be used to interact conveniently with the Insta Demo CA.

       In  order  to  enroll  an  initial certificate from that CA it is sufficient to issue the following shell
       commands.

         export OPENSSL_CONF=/path/to/openssl/apps/openssl.cnf

         openssl genrsa -out insta.priv.pem
         openssl cmp -section insta

       This should produce the file <u>insta.cert.pem</u> containing a new certificate for  the  private  key  held  in
       <u>insta.priv.pem</u>.  It can be viewed using, e.g.,

         openssl x509 -noout -text -in insta.cert.pem

       In  case  the  network  setup  requires  using an HTTP proxy it may be given as usual via the environment
       variable <b>http_proxy</b> or via the <b>-proxy</b> option in the configuration file or the CMP  command-line  argument
       <b>-proxy</b>, for example

         -proxy <a href="http://192.168.1.1">http://192.168.1.1</a>:8080

       In  the  Insta  Demo  CA scenario both clients and the server may use the pre-shared secret <u>insta</u> and the
       reference value <u>3078</u> to authenticate to each other.

       Alternatively, CMP messages may be protected in signature-based manner, where the trust  anchor  in  this
       case  is  <u>insta.ca.crt</u> and the client may use any certificate already obtained from that CA, as specified
       in the <b>[signature]</b> section of the example configuration.  This  can  be  used  in  combination  with  the
       <b>[insta]</b> section simply by

         openssl cmp -section insta,signature

       By default the CMP IR message type is used, yet CR works equally here.  This may be specified directly at
       the command line:

         openssl cmp -section insta -cmd cr

       or by referencing in addition the <b>[cr]</b> section of the example configuration:

         openssl cmp -section insta,cr

       In order to update the enrolled certificate one may call

         openssl cmp -section insta,kur,signature

       using  signature-based  protection  with the certificate that is to be updated.  For certificate updates,
       MAC-based protection should generally not be used.

       In a similar way any previously enrolled certificate may be revoked by

         openssl cmp -section insta,rr -trusted insta.ca.crt

       or

         openssl cmp -section insta,rr,signature

       Many more options can be given in the configuration file and/or on the command line.  For  instance,  the
       <b>-reqexts</b>  CLI option may refer to a section in the configuration file defining X.509 extensions to use in
       certificate requests, such as "v3_req" in <u>openssl/apps/openssl.cnf</u>:

         openssl cmp -section insta,cr -reqexts v3_req

   <b>Certificate</b> <b>enrollment</b>
       The following examples do not make use of a configuration file at first.  They assume that a  CMP  server
       can be contacted on the local TCP port 80 and accepts requests under the alias <u>/pkix/</u>.

       For  enrolling  its very first certificate the client generates a client key and sends an initial request
       message to the local CMP server using a pre-shared secret key for mutual authentication.  In this example
       the client does not have the CA certificate yet, so we specify the name of the  CA  with  the  <b>-recipient</b>
       option and save any CA certificates that we may receive in the "capubs.pem" file.

       In  below  command  line  usage  examples  the  "\" at line ends is used just for formatting; each of the
       command invocations should be on a single line.

         openssl genrsa -out cl_key.pem
         openssl cmp -cmd ir -server 127.0.0.1:80/pkix/ -recipient "/CN=CMPserver" \
           -ref 1234 -secret pass:1234-5678 \
           -newkey cl_key.pem -subject "/CN=MyName" \
           -cacertsout capubs.pem -certout cl_cert.pem

   <b>Certificate</b> <b>update</b>
       Then, when the client certificate and its related key pair needs to be updated, the client can send a key
       update request taking the certs in "capubs.pem" as trusted for authenticating the server  and  using  the
       previous cert and key for its own authentication.  Then it can start using the new cert and key.

         openssl genrsa -out cl_key_new.pem
         openssl cmp -cmd kur -server 127.0.0.1:80/pkix/ \
           -trusted capubs.pem \
           -cert cl_cert.pem -key cl_key.pem \
           -newkey cl_key_new.pem -certout cl_cert.pem
         cp cl_key_new.pem cl_key.pem

       This command sequence can be repeated as often as needed.

   <b>Requesting</b> <b>information</b> <b>from</b> <b>CMP</b> <b>server</b>
       Requesting  "all  relevant information" with an empty General Message.  This prints information about all
       received ITAV <b>infoType</b>s to stdout.

         openssl cmp -cmd genm -server 127.0.0.1/pkix/ -recipient "/CN=CMPserver" \
           -ref 1234 -secret pass:1234-5678

   <b>Using</b> <b>a</b> <b>custom</b> <b>configuration</b> <b>file</b>
       For CMP client invocations, in particular for certificate enrollment, usually many parameters need to  be
       set,  which  is  tedious  and  error-prone  to  do on the command line.  Therefore, the client offers the
       possibility to read options from sections of the OpenSSL config file, usually  called  <u>openssl.cnf</u>.   The
       values  found  there can still be extended and even overridden by any subsequently loaded sections and on
       the command line.

       After including in the configuration file the following sections:

         [cmp]
         server = 127.0.0.1
         path = pkix/
         trusted = capubs.pem
         cert = cl_cert.pem
         key = cl_key.pem
         newkey = cl_key.pem
         certout = cl_cert.pem

         [init]
         recipient = "/CN=CMPserver"
         trusted =
         cert =
         key =
         ref = 1234
         secret = pass:1234-5678-1234-567
         subject = "/CN=MyName"
         cacertsout = capubs.pem

       the above enrollment transactions reduce to

         openssl cmp -section cmp,init
         openssl cmp -cmd kur -newkey cl_key_new.pem

       and the above transaction using a general message reduces to

         openssl cmp -section cmp,init -cmd genm

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/openssl-genrsa.1.html">openssl-genrsa</a></b>(1), <b><a href="../man1/openssl-ecparam.1.html">openssl-ecparam</a></b>(1), <b><a href="../man1/openssl-list.1.html">openssl-list</a></b>(1), <b><a href="../man1/openssl-req.1.html">openssl-req</a></b>(1), <b><a href="../man1/openssl-x509.1.html">openssl-x509</a></b>(1), <b><a href="../man5/x509v3_config.5.html">x509v3_config</a></b>(5)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>cmp</b> application was added in OpenSSL 3.0.

       The <b>-engine</b> option was deprecated in OpenSSL 3.0.

       The <b>-profile</b> option was added in OpenSSL 3.3.

       <b>-crlcert</b>, <b>-oldcrl</b>, <b>-crlout</b>, <b>-crlform</b> and <b>-rsp_crl</b> options were added in OpenSSL 3.4.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2007-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.4.1                                              2025-04-03                                  <u><a href="../man1SSL/OPENSSL-CMP.1SSL.html">OPENSSL-CMP</a></u>(1SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>