<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ocsptool - GnuTLS OCSP tool</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/gnutls-bin">gnutls-bin_3.8.9-2ubuntu3.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>ocsptool</b> - GnuTLS OCSP tool

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ocsptool</b> [<b>-flags</b>] [<b>-flag</b> [<u>value</u>]] [<b>--option-name</b>[[=| ]<u>value</u>]]

       All arguments must be options.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>On</b> <b>verification</b>
       Responses are typically signed/issued by designated certificates or certificate authorities and thus this
       tool  requires  on  verification  the certificate of the issuer or the full certificate chain in order to
       determine the appropriate signing authority. The specified certificate of the issuer is assumed trusted.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-d</b> <u>num</u>, <b>--debug</b>=<u>num</u> Enable debugging.  This option takes an integer number as its argument.  The value of
       <u>num</u> is constrained to being:
           in the range 0 through 9999

       Specifies the debug level.

       <b>-V</b>, <b>--verbose</b> More verbose output.

       <b>--infile</b>=<u>file</u> Input file.

       <b>--outfile</b>=<u>str</u> Output file.

       <b>--ask</b>=<u>server</u> <u>name|url</u> Ask an OCSP/HTTP server on a certificate validity.

       Connects to the specified HTTP OCSP server and queries on the validity of the loaded certificate.  Its
       argument can be a URL or a plain server name. It can be combined with --load-chain, where it checks all
       certificates in the provided chain, or with --load-cert and --load-issuer options. The latter checks the
       provided certificate against its specified issuer certificate.

       <b>-e</b>, <b>--verify-response</b> Verify response.

       Verifies the provided OCSP response against the system trust anchors (unless --load-trust is provided).
       It requires the --load-signer or --load-chain options to obtain the signer of the OCSP response.

       <b>-i</b>, <b>--request-info</b> Print information on a OCSP request.

       Display detailed information on the provided OCSP request.

       <b>-j</b>, <b>--response-info</b> Print information on a OCSP response.

       Display detailed information on the provided OCSP response.

       <b>-q</b>, <b>--generate-request</b> Generates an OCSP request.

       <b>--nonce</b>, <b>--no-nonce</b> Use (or not) a nonce to OCSP request.  The <u>no-nonce</u> form will disable the option.

       <b>--load-chain</b>=<u>file</u> Reads a set of certificates forming a chain from file.

       <b>--load-issuer</b>=<u>file</u> Reads issuer's certificate from file.

       <b>--load-cert</b>=<u>file</u> Reads the certificate to check from file.

       <b>--load-trust</b>=<u>file</u> Read OCSP trust anchors from file.  This option must not appear in combination with any
       of the following options: load-signer.

       When verifying an OCSP response read the trust anchors from the provided file. When this is not provided,
       the system's trust anchors will be used.

       <b>--load-signer</b>=<u>file</u> Reads the OCSP response signer from file.  This option must not appear in combination
       with any of the following options: load-trust.

       <b>--inder</b>, <b>--no-inder</b> Use DER format for input certificates and private keys.  The <u>no-inder</u> form will
       disable the option.

       <b>--outder</b> Use DER format for output of responses (this is the default).

       The output will be in DER encoded format. Unlike other GnuTLS tools, this is the default for this tool

       <b>--outpem</b> Use PEM format for output of responses.

       The output will be in PEM format.

       <b>-Q</b> <u>file</u>, <b>--load-request</b>=<u>file</u> Reads the DER encoded OCSP request from file.

       <b>-S</b> <u>file</u>, <b>--load-response</b>=<u>file</u> Reads the DER encoded OCSP response from file.

       <b>--ignore-errors</b> Ignore any verification errors.

       <b>--verify-allow-broken</b> Allow broken algorithms, such as MD5 for verification.

       This can be combined with --verify-response.

       <b>--attime</b>=<u>timestamp</u> Perform validation at the timestamp instead of the system time.

       timestamp is an instance in time encoded as Unix time or in a human
        readable timestring such as "29 Feb 2004", "2004-02-29".  Full documentation available at
       &lt;https://www.gnu.org/software/coreutils/manual/html_node/Date-input-formats.html&gt; or locally via info
       '(coreutils) date invocation'.

       <b>-v</b> <u>arg</u>, <b>--version</b>=<u>arg</u> Output version of program and exit.  The default mode is `v', a simple version.
       The `c' mode will print copyright information and `n' will print the full copyright notice.

       <b>-h</b>, <b>--help</b> Display usage information and exit.

       <b>-!</b>, <b>--more-help</b> Pass the extended usage information through a pager.

       <b>EXAMPLES</b>
              <b>Print</b> <b>information</b> <b>about</b> <b>an</b> <b>OCSP</b> <b>request</b>

              To parse an OCSP request and print  information  about  the  content,  the  <b>-i</b>  or  <b>--request-info</b>
              parameter  may  be  used as follows.  The <b>-Q</b> parameter specify the name of the file containing the
              OCSP request, and it should contain the OCSP request in binary DER format.

                  $ ocsptool -i -Q ocsp-request.der

              The input file may also be sent to standard input like this:

                  $ cat ocsp-request.der | ocsptool --request-info

              <b>Print</b> <b>information</b> <b>about</b> <b>an</b> <b>OCSP</b> <b>response</b>

              Similar to parsing OCSP requests, OCSP responses can be parsed using the <b>-j</b> or <b>--response-info</b>  as
              follows.

                  $ ocsptool -j -Q ocsp-response.der
                  $ cat ocsp-response.der | ocsptool --response-info

              <b>Generate</b> <b>an</b> <b>OCSP</b> <b>request</b>

              The <b>-q</b> or <b>--generate-request</b> parameters are used to generate an OCSP request.  By default the OCSP
              request  is  written  to  standard  output in binary DER format, but can be stored in a file using
              <b>--outfile</b>.  To generate an OCSP request the issuer  of  the  certificate  to  check  needs  to  be
              specified with <b>--load-issuer</b> and the certificate to check with <b>--load-cert</b>.  By default PEM format
              is  used  for these files, although <b>--inder</b> can be used to specify that the input files are in DER
              format.

                  $ ocsptool -q --load-issuer issuer.pem --load-cert client.pem            --outfile ocsp-request.der

              When generating OCSP requests, the tool will add an  OCSP  extension  containing  a  nonce.   This
              behaviour can be disabled by specifying <b>--no-nonce</b>.

              <b>Verify</b> <b>signature</b> <b>in</b> <b>OCSP</b> <b>response</b>

              To  verify  the  signature in an OCSP response the <b>-e</b> or <b>--verify-response</b> parameter is used.  The
              tool will read an OCSP response in DER format from standard input, or from the file  specified  by
              <b>--load-response</b>.   The  OCSP  response  is  verified  against  a  set  of trust anchors, which are
              specified using <b>--load-trust</b>.  The trust anchors are concatenated certificates in PEM format.  The
              certificate that signed the OCSP response needs to be in the set of trust anchors, or  the  issuer
              of  the signer certificate needs to be in the set of trust anchors and the OCSP Extended Key Usage
              bit has to be asserted in the signer certificate.

                  $ ocsptool -e --load-trust issuer.pem            --load-response ocsp-response.der

              The tool will print status of verification.

              <b>Verify</b> <b>signature</b> <b>in</b> <b>OCSP</b> <b>response</b> <b>against</b> <b>given</b> <b>certificate</b>

              It is possible to override the normal trust logic if  you  know  that  a  certain  certificate  is
              supposed to have signed the OCSP response, and you want to use it to check the signature.  This is
              achieved  using <b>--load-signer</b> instead of <b>--load-trust</b>.  This will load one certificate and it will
              be used to verify the signature in the OCSP response.  It will not check the  Extended  Key  Usage
              bit.

                  $ ocsptool -e --load-signer ocsp-signer.pem            --load-response ocsp-response.der

              This  approach  is  normally only relevant in two situations.  The first is when the OCSP response
              does not contain a copy of the signer certificate, so  the  <b>--load-trust</b>  code  would  fail.   The
              second  is  if  you  want to avoid the indirect mode where the OCSP response signer certificate is
              signed by a trust anchor.

              <b>Real-world</b> <b>example</b>

              Here is an example of how to generate an  OCSP  request  for  a  certificate  and  to  verify  the
              response.   For  illustration  we'll use the <b>blog.josefsson.org</b> host, which (as of writing) uses a
              certificate from CACert.  First we'll use <b>gnutls-cli</b> to get  a  copy  of  the  server  certificate
              chain.  The server is not required to send this information, but this particular one is configured
              to do so.

                  $ echo | gnutls-cli -p 443 blog.josefsson.org --save-cert chain.pem

              The  saved  certificates normally contain a pointer to where the OCSP responder is located, in the
              Authority Information Access Information extension.  For example, from  <b>certtool</b>  <b>-i</b>  <b>&lt;</b>  <b>chain.pem</b>
              there is this information:

                            Authority Information Access Information (not critical):
                                 Access Method: 1.3.6.1.5.5.7.48.1 (id-ad-ocsp)
                                 Access Location URI: https://ocsp.CAcert.org/

              This  means  that  ocsptool  can  discover  the  servers to contact over HTTP.  We can now request
              information on the chain certificates.

                  $ ocsptool --ask --load-chain chain.pem

              The request is sent via HTTP to the OCSP server address found in the certificates. It is  possible
              to  override the address of the OCSP server as well as ask information on a particular certificate
              using --load-cert and --load-issuer.

                  $ ocsptool --ask https://ocsp.CAcert.org/ --load-chain chain.pem

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       One of the following exit values will be returned:

       0  (EXIT_SUCCESS) Successful program execution.

       1  (EXIT_FAILURE) The operation failed or the command syntax was not valid.

       <b>SEE</b> <b>ALSO</b>
              certtool (1)

</pre><h4><b>AUTHORS</b></h4><pre>
</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2020-2023 Free Software Foundation, and  others  all  rights  reserved.   This  program  is
       released under the terms of the GNU General Public License, version 3 or later

</pre><h4><b>BUGS</b></h4><pre>
       Please send bug reports to: <a href="mailto:bugs@gnutls.org">bugs@gnutls.org</a>

3.8.9                                              08 Feb 2025                                       <u><a href="../man1/ocsptool.1.html">ocsptool</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>