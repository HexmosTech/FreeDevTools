<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>capsh - capability shell wrapper</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/libcap2-bin">libcap2-bin_2.73-4ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       capsh - capability shell wrapper

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>capsh</b> [<u>OPTION</u>]...

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Linux  capability  support  and  use can be explored and constrained with this tool. This tool provides a
       handy wrapper for certain types of capability testing and environment creation.  It  also  provides  some
       debugging features useful for summarizing capability state.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>capsh</b>  takes  a  number of optional arguments, acting on them in the order they are provided. They are as
       follows:

       <b>--help</b> Display the list of commands supported by <b>capsh</b>.

       <b>--print</b>
              Display prevailing capability and related state.

       <b>--current</b>
              Display prevailing capability state, 1e capabilities and IAB vector.

       <b>--</b> <u>[args]</u>
              Execute <b><a href="file:/bin/bash">/bin/bash</a></b> with trailing arguments. Note, you can use <b>-c</b> <b>'command</b> <b>to</b> <b>execute'</b> for  specific
              commands.

       <b>-+</b> <u>[args]</u>
              Uses  <b><a href="../man3/cap_launch.3.html">cap_launch</a></b>(3)  to  fork a child to execute the shell. When the child exits, <b>capsh</b> exits with
              the status of the child or 1 in the case that the child was terminated by a signal.

       <b>==</b> <u>[args]</u>
              Execute <b>capsh</b> again with the remaining arguments. Useful for testing <b>exec</b>() behavior.  Note,  PATH
              is  searched  when  the running <b>capsh</b> was found via the shell's PATH searching. If the <b>exec</b> occurs
              after a <b>--chroot=</b><u>/some/path</u> argument the PATH located binary may not be resolve to the same binary
              as that running initially. This behavior is an intended feature as  it  can  complete  the  chroot
              transition.

       <b>=+</b> <u>[args]</u>
              Uses  <b><a href="../man3/cap_launch.3.html">cap_launch</a></b>(3)  to  fork a child to re-execute <b>capsh</b>. When this child exits, <b>capsh</b> exits with
              the status of the child or 1 in the case that the child was terminated by a signal.

       <b>--caps=</b><u>cap-set</u>
              Set the prevailing process capabilities to those specified by <u>cap-set</u>.  Where <u>cap-set</u> is  a  text-
              representation of capability state as per <b><a href="../man3/cap_from_text.3.html">cap_from_text</a></b>(3).

       <b>--drop=</b><u>cap-list</u>
              Remove  the  listed  capabilities  from the prevailing bounding set. The capabilities are a comma-
              separated list of capabilities as recognized by the <b><a href="../man3/cap_from_name.3.html">cap_from_name</a></b>(3) function. Use of this feature
              requires that <b>capsh</b> is operating with <b>CAP_SETPCAP</b> in its effective set.

       <b>--inh=</b><u>cap-list</u>
              Set the inheritable set of capabilities for the current process to equal  those  provided  in  the
              comma  separated list. For this action to succeed, the prevailing process should already have each
              of these capabilities in the union of the current inheritable and permitted  capability  sets,  or
              <b>capsh</b> should be operating with <b>CAP_SETPCAP</b> in its effective set.

       <b>--user=</b><u>username</u>
              Assume  the  identity  of the named user. That is, look up the user's UID and GID with <b><a href="../man3/getpwuid.3.html">getpwuid</a></b>(3)
              and their group memberships  with  <b><a href="../man3/getgrouplist.3.html">getgrouplist</a></b>(3)  and  set  them  all  using  <b><a href="../man3/cap_setuid.3.html">cap_setuid</a></b>(3)  and
              <b><a href="../man3/cap_setgroups.3.html">cap_setgroups</a></b>(3).   Following  this  command,  the effective capabilities will be cleared, but the
              permitted set will not be, so the running program is still privileged.

       <b>--mode</b> Display the prevailing libcap mode as guessed by the <b><a href="../man3/cap_get_mode.3.html">cap_get_mode</a></b>(3) function.

       <b>--mode=</b>&lt;mode&gt;
              Force the program into a <b><a href="../man3/cap_set_mode.3.html">cap_set_mode</a></b>(3) security mode. This is a set of securebits and prevailing
              capability arrangement recommended for its pre-determined security stance.

       <b>--modes</b>
              Lists all of the libcap modes supported by <b>--mode=</b>&lt;mode&gt;.

       <b>--inmode=</b>&lt;mode&gt;
              Confirm that the prevailing mode is that specified in <u>&lt;mode&gt;</u>, or exit with a status 1.

       <b>--uid=</b><u>id</u>
              Force all UID values to equal <u>id</u> using the  <b><a href="../man2/setuid.2.html">setuid</a></b>(2)  system  call.  This  argument  may  require
              explicit preparation of the effective set.

       <b>--cap-uid=</b>&lt;uid&gt;
              use  the  <b><a href="../man3/cap_setuid.3.html">cap_setuid</a></b>(3)  function  to  set  the  UID  of  the  current  process. This performs all
              preparations for setting the UID without dropping capabilities  in  the  process.  Following  this
              command the prevailing effective capabilities will be lowered.

       <b>--is-uid=</b><u>&lt;id&gt;</u>
              Exit with status 1 unless the current UID equals <u>&lt;id&gt;</u>.

       <b>--gid=</b><u>&lt;id&gt;</u>
              Force all GID values to equal <u>id</u> using the <b><a href="../man2/setgid.2.html">setgid</a></b>(2) system call.

       <b>--is-gid=</b><u>&lt;id&gt;</u>
              Exit with status 1 unless the current GIQ equals <u>&lt;id&gt;</u>.

       <b>--groups=</b><u>&lt;gid-list&gt;</u>
              Set  the  supplementary  groups  to  the  numerical  list  provided.  The  groups are set with the
              <b><a href="../man2/setgroups.2.html">setgroups</a></b>(2) system call. See <b>--user</b> for a more convenient way of doing this.

       <b>--keep=</b><u>&lt;0|1&gt;</u>
              In a non-pure capability mode, the kernel provides liberal privilege to the  super-user.  However,
              it  is  normally  the  case  that  when  the  super-user  changes  UID  to  some lesser user, then
              capabilities are dropped. For these situations, the kernel can permit the process  to  retain  its
              capabilities after a <b><a href="../man2/setuid.2.html">setuid</a></b>(2) system call. This feature is known as <u>keep-caps</u> support. The way to
              activate  it using this program is with this argument. Setting the value to 1 will cause <u>keep-caps</u>
              to be active. Setting it to 0 will cause keep-caps to deactivate for the current process.  In  all
              cases,  <u>keep-caps</u>  is  deactivated when an <b>exec</b>() is performed. See <b>--secbits</b>and<b>--mode</b> for ways to
              disable this feature.

       <b>--secbits=</b><u>N</u>
              Set the security-bits for  the  program.   This  is  done  using  the  <b><a href="../man2/prctl.2.html">prctl</a></b>(2)  <b>PR_SET_SECUREBITS</b>
              operation.   The  list  of  supported  bits  and their meaning can be found in the <b>&lt;sys/secbits.h&gt;</b>
              header file. The program will list these bits via the <b>--print</b> command.  The argument is  expressed
              as  a numeric bitmask, in any of the formats permitted by <b><a href="../man3/strtoul.3.html">strtoul</a></b>(3).  An alternative to this bit-
              twiddling is embedded in the <b>--mode*</b> commandline arguments.

       <b>--chroot=</b><u>/some/path</u>
              Execute the <b><a href="../man2/chroot.2.html">chroot</a></b>(2) system call with the new root-directory (/) equal to <u>path</u>.   This  operation
              requires <b>CAP_SYS_CHROOT</b> to be in effect.

       <b>--forkfor=</b><u>sec</u>
              This  command causes the program to fork a child process for so many seconds. The child will sleep
              that long and then exit with status 0. The purpose of this command is to support exploring the way
              processes are killable in the face of capability changes. See the <b>--killit</b> command. Only one  fork
              can be active at a time.

       <b>--killit=</b><u>sig</u>
              This  commands causes a <b>--forkfor</b> child to be <b><a href="../man2/kill.2.html">kill</a></b>(2)d with the specified signal. The command then
              waits for the child to exit.  If the exit status does not match the signal being used to kill  it,
              the <b>capsh</b> program exits with status 1.

       <b>--explain=</b><u>cap_xxx</u>
              Give  a brief textual description of what privileges the specified capability makes available to a
              running program. Note, instead of <u>cap_xxx</u>, one can provide a decimal number and <b>capsh</b> will look up
              the corresponding capability's description.

       <b>--shell</b><u>=/full/path</u>
              This option changes the shell that is invoked when the argument <b>==</b> is encountered.

       <b>--strict</b>
              This option toggles the suppression of subsequent attempts to fixup <b>--caps=</b> and <b>--inh=</b>  arguments.
              That  is,  when  the  prevailing  Effective  flag  does  not  contain <b>CAP_SETPCAP</b> <b>the</b> <b>to</b> <b>be</b> <b>raised</b>
              <b>Inheritable</b> <b>Flag</b> <b>values</b> <b>(in</b> <b>strict</b> <b>mode)</b> <b>are</b> <b>limited</b> <b>to</b> <b>those</b> <b>in</b> <b>the</b>  <b>Permitted</b>  <b>set.</b>  <b>The</b>  <b>strict</b>
              <b>mode</b>  <b>defaults</b>  <b>to</b>  <b>off.</b>  <b>Supplying</b>  <b>this</b>  <b>argument</b>  <b>an</b> <b>even</b> <b>number</b> <b>of</b> <b>times</b> <b>restores</b> <b>this</b> <b>default</b>
              <b>behavior.</b>

       <b>--suggest=</b><u>phrase</u>
              Scan each  of  the  textual  descriptions  of  capabilities,  known  to  <b>capsh</b>,  and  display  all
              descriptions that include <u>phrase</u>.

       <b>--decode=</b><u>N</u>
              This  is  a  convenience  feature. If you look at <b><a href="file:/proc/1/status">/proc/1/status</a></b> there are some capability related
              fields of the following form:

              CapInh:   0000000000000000
              CapPrm:   0000003fffffffff
              CapEff:   0000003fffffffff
              CapBnd:   0000003fffffffff
              CapAmb:   0000000000000000

              This option provides a quick way to decode a capability vector  represented  in  this  hexadecimal
              form.  Here's an example that decodes the two lowest capability bits:

              $ <b>capsh</b> <b>--decode=3</b>
              0x0000000000000003=cap_chown,cap_dac_override

       <b>--supports=</b><u>xxx</u>
              As  the  kernel  evolves,  more  capabilities  are  added.  This  option can be used to verify the
              existence of a capability on the system. For example, <b>--supports=</b><u>cap_syslog</u> will  cause  <b>capsh</b>  to
              promptly exit with a status of 1 when run on kernel 2.6.27.  However, when run on kernel 2.6.38 it
              will silently succeed.

       <b>--has-p=</b><u>xxx</u>
              Exit with status 1 unless the <u>permitted</u> vector has capability <b>xxx</b> raised.

       <b>--has-ambient</b>
              Performs  a  check to see if the running kernel supports ambient capabilities. If not, <b>capsh</b> exits
              with status 1.

       <b>--has-a=</b><u>xxx</u>
              Exit with status 1 unless the <u>ambient</u> vector has capability <b>xxx</b> raised.

       <b>--has-b=</b><u>xxx</u>
              Exit with status 1 unless the <u>bounding</u> vector has capability  <b>xxx</b>  in  its  (default)  non-blocked
              state.

       <b>--iab=</b><u>xxx</u>
              Attempts  to  set  the IAB tuple of inheritable capability vectors.  The text conventions used for
              <u>xxx</u> are those of <b><a href="../man3/cap_iab_from_text.3.html">cap_iab_from_text</a></b>(3).

       <b>--addamb=</b><u>xxx</u>
              Adds the specified ambient capability to the running process.

       <b>--delamb=</b><u>xxx</u>
              Removes the specified ambient capability from the running process.

       <b>--noamb</b>
              Drops all ambient capabilities from the running process.

       <b>--noenv</b>
              Suppresses overriding of the HOME and USER environment variables when a subsequent <b>--user</b> argument
              is processed.

       <b>--quiet</b>
              This argument is ignored unless it is the first one. If present, it suppresses the  capsh  runtime
              check  to confirm the running libcap is recent enough that it can name all of the kernel supported
              capability values.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       Following successful execution, <b>capsh</b> exits with status 0. Following an error,  <b>capsh</b>  immediately  exits
       with status 1.

</pre><h4><b>AUTHOR</b></h4><pre>
       Written by Andrew G. Morgan &lt;<a href="mailto:morgan@kernel.org">morgan@kernel.org</a>&gt;.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Please report bugs via:

       https://bugzilla.kernel.org/buglist.cgi?component=libcap&amp;list_id=1090757

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libcap.3.html">libcap</a></b>(3),   <b><a href="../man3/cap_from_text.3.html">cap_from_text</a></b>(3),   <b><a href="../man3/cap_iab.3.html">cap_iab</a></b>(3)  <b><a href="../man7/capabilities.7.html">capabilities</a></b>(7),  <b><a href="../man8/captree.8.html">captree</a></b>(8),  <b><a href="../man8/getcap.8.html">getcap</a></b>(8),  <b><a href="../man8/getpcaps.8.html">getpcaps</a></b>(8),  and
       <b><a href="../man8/setcap.8.html">setcap</a></b>(8).

libcap                                             2021-10-22                                           <u><a href="../man1/CAPSH.1.html">CAPSH</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>