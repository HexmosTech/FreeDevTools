<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>scado - Script Capability Ambient DO</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/cado">cado_0.9.6-1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       scado - Script Capability Ambient DO

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>scado</b> <b>-D</b> | <b>-e</b> | <b>-l</b>
       <b>scado</b> <b>-u</b> <u>command</u> | <b>-U</b>
       <b>scado</b> <b>-h</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b><a href="../man1/cado.1.html">cado</a>(1)</b>  allows  the system administrator to delegate capabilities to users.  Users can grant a subset of
       these ambient capabilities to trusted programs.  Each user can define their own list of trusted  programs
       and  which capabilities to grant, using a scado file.  <b>cado</b> <b>-S</b> or <b>cado</b> <b>--scado</b> run those trusted programs
       without any further authentication.  In this way it is also possible to run programs  requiring  specific
       capabilities within a bash script.

       <b>Scado</b> is the command a user can run to create, edit, check or delete their own scado file.

       Each line of a scado file file has the following syntax:
           <u>path_of_the_executable_file</u> <u>:</u> <u>capability_list</u>
       or
           <u>path_of_the_executable_file</u> <u>:</u> <u>capability_list</u> <u>:</u> <u>sha256_digest_of_the_executable</u>
       (See  the  EXAMPLES  section  at  the  end of the man page for more info. All the trailing part of a line
       following a # sign is a comment.).

       The <u>path_of_the_executable_file</u> must be absolute.

       The <u>capability_list</u> is a comma separated list of capability names or capability masks.  For brevity,  the
       <b>cap_</b>  prefix  of  capabilities  names  can  be  omitted  (e.g.  <b>net_admin</b> and <b>cap_net_admin</b> have the same
       meaning).

       The <u>sha256_digest_of_the_executable</u> prevents <u>TOCTTOU</u> attacks. When a  user  wants  to  run  the  file  at
       <u>path_of_the_executable_file</u>  granting  it some of the capabilities in the <u>capability_list</u>, the permission
       is denied if its sha256 digest does not match <u>sha256_digest_of_the_executable</u>.

       If there are only two colon (<b>:</b>) separated fields in a line, it means that the user trusts  a  priori  the
       integrity  of  the file whose pathname is <u>path_of_the_executable_file</u>.  It can be, for example, a program
       in <a href="file:/bin">/bin</a> or <a href="file:/usr/bin">/usr/bin</a> not modifiable by users.

       If there are three fields (i.e. two colon characters), it means that the  user  wants  the  cryptographic
       digest  check  on  the  executable  file  integrity.   When  a  user edits their scado file, if the field
       (<u>sha256_digest_of_the_executable</u>) is empty, <b>scado</b> computes it automatically when the scado file is saved.

       <b>Scado</b> asks for user authentication by PAM to confirm any modification of the scado file.

       There is also a <u>TOCTTOU</u> protection at running time: cado -S copies the executable file in a  safe  place,
       where  the user cannot change it, and runs it only if the integrity check on it succeeds.  The user (or a
       malicious intruder acting as the user) cannot modify the file after the integrity check has completed and
       before the program is loaded.

</pre><h4><b>OPTIONS</b></h4><pre>
       <u>scado</u> accepts the following options:

       <b>-l</b>
       <b>--list</b> Display the current scado file.  The  actual  file  in  the  file  system  is  not  accessible  by
              unprivileged users, for security reasons.

       <b>-e</b>
       <b>--edit</b> Edit  the  scado  file  of the current user using the editor specified by either the <b>VISUAL</b> or the
              <b>EDITOR</b> environment variable (checked in that order).  After you exit from the editor, the modified
              file will be installed automatically.

       <b>-D</b>
       <b>--delete</b>
              Delete the current user's scado file.

       <b>-u</b> <u>command</u>
       <b>--update</b> <u>command</u>
              Recompute the hash of the line which starts with <u>command</u>.

       <b>-U</b>
       <b>--update-all</b>
              Update all the digest entries.

       <b>-h</b>
       <b>--help</b> print a short usage banner and exit.

</pre><h4><b>EXCEPTIONS</b> <b>FILES</b> <b>EXAMPLES</b></h4><pre>
       Allow <b>cado</b> <b>-S</b> to run <a href="file:/bin/ping">/bin/ping</a> providing it with the cap_net_raw capability, without any integrity check:
           <a href="file:/bin/ping">/bin/ping</a> : cap_net_raw

       Allow the activation of ping with cap_net_raw provided it has a specific SHA256 digest
           <a href="file:/bin/ping">/bin/ping</a> : cap_net_raw : dcb237f1cb20ee7b1550900d1b524c554063fd17fc673c56d341736ced6bed4b

       Compute the SHA256 digest of (the current version  of)  ping  so,  allow  the  activation  of  ping  with
       cap_net_raw provided it has not been modified.
           <a href="file:/bin/ping">/bin/ping</a> : cap_net_raw :

       If  one  of  the  example lines here above has been inserted in the user scado file using <b>scado</b> <b>-e</b>, it is
       possible to execute ping as follows:
           cado -S cap_net_raw <a href="file:/bin/ping">/bin/ping</a>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/cado.1.html">cado</a></b>(1), <b><a href="../man7/capabilities.7.html">capabilities</a></b>(7)

VirtualSquare Labs                                June 23, 2016                                         <u><a href="../man1/SCADO.1.html">SCADO</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>