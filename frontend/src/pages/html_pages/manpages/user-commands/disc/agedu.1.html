<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>agedu - correlate disk usage with last-access times to identify large and disused data</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/agedu">agedu_20211129.8cd63c5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>agedu</b> - correlate disk usage with last-access times to identify large and disused data

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>agedu</b> [ <u>options</u> ] <u>action</u> [<u>action</u>...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>agedu</b> scans a directory tree and produces reports about how much disk space is used in each directory and
       subdirectory,  and  also  how that usage of disk space corresponds to files with last-access times a long
       time ago.

       In other words, <b>agedu</b> is a tool you might use to help you free up disk  space.  It  lets  you  see  which
       directories  are taking up the most space, as <b>du</b> does; but unlike <b>du</b>, it also distinguishes between large
       collections of data which are still in use and ones which have not been accessed in months or years - for
       instance, large archives downloaded, unpacked, used once, and never cleaned up. Where <b>du</b> helps  you  find
       what's using your disk space, <b>agedu</b> helps you find what's <u>wasting</u> your disk space.

       <b>agedu</b>  has several operating modes. In one mode, it scans your disk and builds an index file containing a
       data structure which allows it to efficiently retrieve any information  it  might  need.  Typically,  you
       would  use it in this mode first, and then run it in one of a number of `query' modes to display a report
       of the disk space usage of a particular directory and its subdirectories. Those reports can  be  produced
       as  plain  text  (much like <b>du</b>) or as HTML. <b>agedu</b> can even run as a miniature web server, presenting each
       directory's HTML report with hyperlinks to let you navigate around the file system to similar reports for
       other directories.

       So you would typically start using <b>agedu</b> by telling it to do a scan of a  directory  tree  and  build  an
       index. This is done with a command such as

       $ <b>agedu</b> <b>-s</b> <b>/home/fred</b>

       which will build a large data file called <b>agedu.dat</b> in your current directory. (If that current directory
       is <u>inside</u> <b>/home/fred</b>, don't worry - <b>agedu</b> is smart enough to discount its own index file.)

       Having  built  the index, you would now query it for reports of disk space usage. If you have a graphical
       web browser, the simplest and nicest way to query the index is by running <b>agedu</b> in web server mode:

       $ <b>agedu</b> <b>-w</b>

       which will print (among other messages) a URL on its standard output along the lines of

       URL: <a href="http://127.0.0.1">http://127.0.0.1</a>:48638/

       (That URL will always begin with `<b>127.</b>', meaning that it's  in  the  <b>localhost</b>  address  space.  So  only
       processes  running  on  the  same  computer can even try to connect to that web server, and also there is
       access control to prevent other users from seeing it - see below for more detail.)

       Now paste that URL into your web browser, and you will be shown a graphical representation  of  the  disk
       usage  in  <b>/home/fred</b>  and its immediate subdirectories, with varying colours used to show the difference
       between disused and recently-accessed data. Click on any subdirectory to descend into it and see a report
       for its subdirectories in turn; click on parts of the pathname at the  top  of  any  page  to  return  to
       higher-level directories. When you've finished browsing, you can just press Ctrl-D to send an end-of-file
       indication to <b>agedu</b>, and it will shut down.

       After  that,  you  probably want to delete the data file <b>agedu.dat</b>, since it's pretty large. In fact, the
       command <b>agedu</b> <b>-R</b> will do this for you; and you can chain <b>agedu</b> commands on the same command line, so that
       instead of the above you could have done

       $ <b>agedu</b> <b>-s</b> <b>/home/fred</b> <b>-w</b> <b>-R</b>

       for a single self-contained run of <b>agedu</b> which builds its index, serves web pages from it, and cleans  it
       up when finished.

       In  some situations, you might want to scan the directory structure of one computer, but run <b>agedu</b>'s user
       interface on another. In that case, you can do your scan using the <b>agedu</b> <b>-S</b> option in place of <b>agedu</b>  <b>-s</b>,
       which  will  make  <b>agedu</b> not bother building an index file but instead just write out its scan results in
       plain text on standard output; then you can funnel that  output  to  the  other  machine  using  SSH  (or
       whatever  other  technique  you  prefer), and there, run <b>agedu</b> <b>-L</b> to load in the textual dump and turn it
       into an index file. For example, you might run a command like this (plus any <b>ssh</b> options you need) on the
       machine you want to scan:

       $ <b>agedu</b> <b>-S</b> <b>/home/fred</b> <b>|</b> <b>ssh</b> <b>indexing-machine</b> <b>agedu</b> <b>-L</b>

       or, equivalently, run something like this on the other machine:

       $ <b>ssh</b> <b>machine-to-scan</b> <b>agedu</b> <b>-S</b> <b>/home/fred</b> <b>|</b> <b>agedu</b> <b>-L</b>

       Either way, the <b>agedu</b> <b>-L</b> command will create an <b>agedu.dat</b> index file, which you can then use  with  <b>agedu</b>
       <b>-w</b> just as above.

       (Another  way  to  do this might be to build the index file on the first machine as normal, and then just
       copy it to the other machine once it's complete. However, for efficiency, the  index  file  is  formatted
       differently  depending  on  the  CPU  architecture  that  <b>agedu</b> is compiled for. So if that doesn't match
       between the two machines - e.g. if one is a 32-bit machine and one 64-bit - then <b>agedu.dat</b> files  written
       on  one  machine  will  not  work on the other. The technique described above using <b>-S</b> and <b>-L</b> should work
       between any two machines.)

       If you don't have a graphical web browser, you can do text-based queries instead  of  using  <b>agedu</b>'s  web
       interface. Having scanned <b>/home/fred</b> in any of the ways suggested above, you might run

       $ <b>agedu</b> <b>-t</b> <b>/home/fred</b>

       which  again  gives  a summary of the disk usage in <b>/home/fred</b> and its immediate subdirectories; but this
       time <b>agedu</b> will print it on standard output, in much the same format as <b>du</b>. If you then want to find  out
       how  much  <u>old</u> data is there, you can add the <b>-a</b> option to show only files last accessed a certain length
       of time ago. For example, to show only files which haven't been looked at in six months or more:

       $ <b>agedu</b> <b>-t</b> <b>/home/fred</b> <b>-a</b> <b>6m</b>

       That's the essence of what <b>agedu</b> does. It has other modes of operation for more complex  situations,  and
       the  usual array of configurable options. The following sections contain a complete reference for all its
       functionality.

</pre><h4><b>OPERATING</b> <b>MODES</b></h4><pre>
       This section describes the operating modes supported by <b>agedu</b>. Each of these is in the form of a command-
       line option, sometimes with an argument. Multiple operating-mode options may appear on the command  line,
       in  which  case <b>agedu</b> will perform the specified actions one after another. For instance, as shown in the
       previous section, you might want to perform a disk scan  and  immediately  launch  a  web  server  giving
       reports from that scan.

       <b>-s</b> <u>directory</u> or <b>--scan</b> <u>directory</u>
              In  this  mode,  <b>agedu</b>  scans the file system starting at the specified directory, and indexes the
              results of the scan into a large data file which other operating modes can query.

              By default, the scan is restricted to a single file system (since the expected  use  of  <b>agedu</b>  is
              that  you would probably use it because a particular disk partition was running low on space). You
              can remove that restriction using the <b>--cross-fs</b> option; other configuration options allow you  to
              include  or  exclude  files  or entire subdirectories from the scan. See the next section for full
              details of the configurable options.

              The index file is created with restrictive permissions, in case the file system you  are  scanning
              contains confidential information in its structure.

              Index  files are dependent on the characteristics of the CPU architecture you created them on. You
              should not expect to be able to move an index file between different types of computer and have it
              continue to work. If you need to transfer the results of a  disk  scan  to  a  different  kind  of
              computer, see the <b>-D</b> and <b>-L</b> options below.

       <b>-w</b> or <b>--web</b>
              In  this  mode,  <b>agedu</b> expects to find an index file already written. It allocates a network port,
              and starts up a web server on that port which serves reports generated from  the  index  file.  By
              default it invents its own URL and prints it out.

              The web server runs until <b>agedu</b> receives an end-of-file event on its standard input. (The expected
              usage  is  that  you  run  it  from  the  command  line, immediately browse web pages until you're
              satisfied, and then press Ctrl-D.) To disable the EOF behaviour, use the <b>--no-eof</b> option.

              In case the index file contains any confidential information  about  your  file  system,  the  web
              server  protects  the  pages  it  serves  from  access  by  other  people.  On Linux, this is done
              transparently by means of using <b><a href="file:/proc/net/tcp">/proc/net/tcp</a></b> to check the  owner  of  each  incoming  connection;
              failing that, the web server will require a password to view the reports, and <b>agedu</b> will print the
              password it invented on standard output along with the URL.

              Configurable  options for this mode let you specify your own address and port number to listen on,
              and also specify your own choice of authentication method (including  turning  authentication  off
              completely) and a username and password of your choice.

       <b>-t</b> <u>directory</u> or <b>--text</b> <u>directory</u>
              In  this  mode, <b>agedu</b> generates a textual report on standard output, listing the disk usage in the
              specified directory and all its subdirectories down to a given depth. By default that depth is  1,
              so  that  you  see  a report for <u>directory</u> itself and all of its immediate subdirectories. You can
              configure a different depth (or no depth limit) using <b>-d</b>, described in the next section.

              Used on its own, <b>-t</b> merely lists the <u>total</u> disk usage in  each  subdirectory;  <b>agedu</b>'s  additional
              ability to distinguish unused from recently-used data is not activated. To activate it, use the <b>-a</b>
              option to specify a minimum age.

              The  directory structure stored in <b>agedu</b>'s index file is treated as a set of literal strings. This
              means that you cannot refer to directories by synonyms. So if you ran <b>agedu</b> <b>-s</b>  <b>.</b>,  then  all  the
              path  names  you  later  pass  to  the <b>-t</b> option must be either `<b>.</b>' or begin with `<b>./</b>'. Similarly,
              symbolic links within the directory you scanned will not be  followed;  you  must  refer  to  each
              directory by its canonical, symlink-free pathname.

       <b>-R</b> or <b>--remove</b>
              In  this  mode,  <b>agedu</b>  deletes  its  index  file.  Running  just <b>agedu</b> <b>-R</b> on its own is therefore
              equivalent to typing <b>rm</b> <b>agedu.dat</b>. However, you can also put <b>-R</b> on the end of a  command  line  to
              indicate that <b>agedu</b> should delete its index file after it finishes performing other operations.

       <b>-S</b> <u>directory</u> or <b>--scan-dump</b> <u>directory</u>
              In  this  mode,  <b>agedu</b>  will scan a directory tree and convert the results straight into a textual
              dump on standard output, without generating an index file at all. The dump data  is  intended  for
              <b>agedu</b> <b>-L</b> to read.

       <b>-L</b> or <b>--load</b>
              In  this  mode, <b>agedu</b> expects to read a dump produced by the <b>-S</b> option from its standard input. It
              constructs an index file from that dump, exactly as it would have if it had  read  the  same  data
              from a disk scan in <b>-s</b> mode.

       <b>-D</b> or <b>--dump</b>
              In  this  mode, <b>agedu</b> reads an existing index file and produces a dump of its contents on standard
              output, in the same format used by <b>-S</b> and <b>-L</b>. This option could be used  to  convert  an  existing
              index  file  into  a format acceptable to a different kind of computer, by dumping it using <b>-D</b> and
              then loading the dump back in on the other machine using <b>-L</b>.

              (The output of <b>agedu</b> <b>-D</b> on an existing index file will not be exactly <u>identical</u> to what  <b>agedu</b>  <b>-S</b>
              would  have  originally  produced,  due  to  a  difference  in  treatment  of last-access times on
              directories. However, it should be effectively equivalent for most purposes. See the documentation
              of the <b>--dir-atime</b> option in the next section for further detail.)

       <b>-H</b> <u>directory</u> or <b>--html</b> <u>directory</u>
              In this mode, <b>agedu</b> will generate an HTML report of the disk usage in the specified directory  and
              its immediate subdirectories, in the same form that it serves from its web server in <b>-w</b> mode.

              By  default, a single HTML report will be generated and simply written to standard output, with no
              hyperlinks pointing to other similar pages. If you also specify the <b>-d</b> option (see  below),  <b>agedu</b>
              will  instead write out a collection of HTML files with hyperlinks between them, and call the top-
              level file <b>index.html</b>.

       <b>--cgi</b>  In this mode, <b>agedu</b> will run as the bulk of a CGI script which provides the same set of web  pages
              as the built-in web server would. It will read the usual CGI environment variables, and write CGI-
              style data to its standard output.

              The  actual  CGI  program  itself  should be a tiny wrapper around <b>agedu</b> which passes it the <b>--cgi</b>
              option, and also (probably) <b>-f</b> to locate the index  file.  <b>agedu</b>  will  do  everything  else.  For
              example, your script might read

              #!<a href="file:/bin/sh">/bin/sh</a>
              <u>/some/path/to/</u>agedu --cgi -f <u>/some/other/path/to/</u>agedu.dat

              (Note  that  <b>agedu</b> will produce the <u>entire</u> CGI output, including status code, HTTP headers and the
              full HTML document. If you try to surround the call to <b>agedu</b> <b>--cgi</b> with code that  adds  your  own
              HTML  header  and footer, you won't get the results you want, and <b>agedu</b>'s HTTP-level features such
              as auto-redirecting to canonical versions of URIs will stop working.)

              No access control is performed in this mode: restricting access to CGI scripts is  assumed  to  be
              the job of the web server.

       <b>--presort</b> and <b>--postsort</b>
              In  these  two modes, <b>agedu</b> will expect to read a textual data dump from its standard input of the
              form produced by <b>-S</b> (and <b>-D</b>). It will transform the data into a different version of its text dump
              format, and write the transformed version on standard output.

              The ordinary dump file format is reasonably readable, but loading it  into  an  index  file  using
              <b>agedu</b>  <b>-L</b>  requires  it  to  be  sorted  in a specific order, which is complicated to describe and
              difficult to implement using ordinary Unix sorting tools. So if you want  to  construct  your  own
              data  dump  from a source of your own that <b>agedu</b> itself doesn't know how to scan, you will need to
              make sure it's sorted in the right order.

              To help with this, <b>agedu</b> provides a secondary dump format which is `sortable', in the  sense  that
              ordinary  <b>sort</b>(<u>1</u>)  without  arguments  will arrange it into the right order. However, the sortable
              format is much more unreadable and also twice the size, so you wouldn't want to write it directly!

              So the recommended procedure is to generate dump data in the ordinary format; then pipe it through
              <b>agedu</b> <b>--presort</b> to turn it into the sortable format; then sort it; <u>then</u>  pipe  it  into  <b>agedu</b>  <b>-L</b>
              (which can accept either the normal or the sortable format as input). For example:

              <u>generate_custom_data.sh</u> | agedu --presort | sort | agedu -L

              If  you need to transform the sorted dump file back into the ordinary format, <b>agedu</b> <b>--postsort</b> can
              do that. But since <b>agedu</b> <b>-L</b> can accept either format as input, you may not need to.

       <b>-h</b> or <b>--help</b>
              Causes <b>agedu</b> to print some help text and terminate immediately.

       <b>-V</b> or <b>--version</b>
              Causes <b>agedu</b> to print its version number and terminate immediately.

</pre><h4><b>OPTIONS</b></h4><pre>
       This section describes the various configuration options that affect <b>agedu</b>'s operation  in  one  mode  or
       another.

       The following option affects nearly all modes (except <b>-S</b>):

       <b>-f</b> <u>filename</u> or <b>--file</b> <u>filename</u>
              Specifies  the  location  of the index file which <b>agedu</b> creates, reads or removes depending on its
              operating mode. By default, this is  simply  `<b>agedu.dat</b>',  in  whatever  is  the  current  working
              directory when you run <b>agedu</b>.

       The following options affect the disk-scanning modes, <b>-s</b> and <b>-S</b>:

       <b>--cross-fs</b> and <b>--no-cross-fs</b>
              These configure whether or not the disk scan is permitted to cross between different file systems.
              The  default  is  not  to:  <b>agedu</b> will normally skip over subdirectories on which a different file
              system is mounted. This makes it convenient when you want to free up space on  a  particular  file
              system  which  is  running  low.  However,  in  other  circumstances you might wish to see general
              information about the use of space no matter which file system it's on (for instance, if your real
              concern is your backup media running out of space, and if your backups do not treat different file
              systems specially); in that situation, use <b>--cross-fs</b>.

              (Note that this default is the opposite way round from the corresponding option in <b>du</b>.)

       <b>--prune</b> <u>wildcard</u> and <b>--prune-path</b> <u>wildcard</u>
              These cause particular files or directories to be omitted entirely from the scan. If <b>agedu</b>'s  scan
              encounters  a file or directory whose name matches the wildcard provided to the <b>--prune</b> option, it
              will not include that file in its index, and also if it's a directory it will skip over it and not
              scan its contents.

              Note that in most Unix shells, wildcards will probably need to be escaped on the command line,  to
              prevent the shell from expanding the wildcard before <b>agedu</b> sees it.

              <b>--prune-path</b>  is  similar  to  <b>--prune</b>,  except  that  the  wildcard is matched against the entire
              pathname instead of just the filename at the end of it. So whereas <b>--prune</b> <b>*a*b*</b>  will  match  any
              file  whose  actual  name contains an <b>a</b> somewhere before a <b>b</b>, <b>--prune-path</b> <b>*a*b*</b> will also match a
              file whose name contains <b>b</b> and which is inside a directory containing an <b>a</b>, or any file  inside  a
              directory of that form, and so on.

       <b>--exclude</b> <u>wildcard</u> and <b>--exclude-path</b> <u>wildcard</u>
              These  cause  particular files or directories to be omitted from the index, but not from the scan.
              If <b>agedu</b>'s scan encounters a file or directory whose name matches the  wildcard  provided  to  the
              <b>--exclude</b>  option, it will not include that file in its index - but unlike <b>--prune</b>, if the file in
              question is a directory it will still scan its contents and index them if they are not  ruled  out
              themselves by <b>--exclude</b> options.

              As  above, <b>--exclude-path</b> is similar to <b>--exclude</b>, except that the wildcard is matched against the
              entire pathname.

       <b>--include</b> <u>wildcard</u> and <b>--include-path</b> <u>wildcard</u>
              These cause particular files or directories to be re-included in the index and the scan,  if  they
              had  previously  been  ruled  out by one of the above exclude or prune options. You can interleave
              include, exclude and prune options as you wish on the command line, and if more than one  of  them
              applies to a file then the last one takes priority.

              For example, if you wanted to see only the disk space taken up by MP3 files, you might run

              $ <b>agedu</b> <b>-s</b> <b>.</b> <b>--exclude</b> <b>'*'</b> <b>--include</b> <b>'*.mp3'</b>

              which will cause everything to be omitted from the scan, but then the MP3 files to be put back in.
              If  you  then  wanted  only  a  subset of those MP3s, you could then exclude some of them again by
              adding, say, `<b>--exclude-path</b> <b>'./queen/*'</b>' (or, more efficiently, `<b>--prune</b> <b>./queen</b>') on the end  of
              that command.

              As  with the previous two options, <b>--include-path</b> is similar to <b>--include</b> except that the wildcard
              is matched against the entire pathname.

       <b>--progress</b>, <b>--no-progress</b> and <b>--tty-progress</b>
              When <b>agedu</b> is scanning a directory tree, it will typically print a one-line progress report  every
              second  showing  where it has reached in the scan, so you can have some idea of how much longer it
              will take. (Of course, it can't predict <u>exactly</u> how long it will take, since it doesn't know which
              of the directories it hasn't scanned yet will turn out to be huge.)

              By default, those progress reports are displayed  on  <b>agedu</b>'s  standard  error  channel,  if  that
              channel  points  to a terminal device. If you need to manually enable or disable them, you can use
              the above three options to do so: <b>--progress</b> unconditionally enables the progress  reports,  <b>--no-</b>
              <b>progress</b>  unconditionally disables them, and <b>--tty-progress</b> reverts to the default behaviour which
              is conditional on standard error being a terminal.

       <b>--dir-atime</b> and <b>--no-dir-atime</b>
              In normal operation, <b>agedu</b> ignores the atimes (last access times) on the <u>directories</u> it scans:  it
              only pays attention to the atimes of the <u>files</u> inside those directories. This is because directory
              atimes  tend to be reset by a lot of system administrative tasks, such as <b>cron</b> jobs which scan the
              file system for one reason or another - or even other invocations of <b>agedu</b> itself, though it tries
              to avoid modifying any atimes if possible. So the literal atimes on directories are typically  not
              representative of how long ago the data in question was last accessed with real intent to use that
              data in particular.

              Instead,  <b>agedu</b>  makes  up a fake atime for every directory it scans, which is equal to the newest
              atime of any file in or below that directory (or the directory's last <u>modification</u> time, whichever
              is newest). This is based on the  assumption  that  all  <u>important</u>  accesses  to  directories  are
              actually accesses to the files inside those directories, so that when any file is accessed all the
              directories on the path leading to it should be considered to have been accessed as well.

              In  unusual  cases  it  is  possible  that a directory itself might embody important data which is
              accessed by reading the directory. In that situation, <b>agedu</b>'s atime-faking policy  will  misreport
              the  directory  as disused. In the unlikely event that such directories form a significant part of
              your disk space usage, you might want to turn off the faking. The <b>--dir-atime</b> option does this: it
              causes the disk scan to read the original atimes of the directories it scans.

              The faking of atimes on directories also requires a processing pass over the index file after  the
              main  disk  scan is complete. <b>--dir-atime</b> also turns this pass off. Hence, this option affects the
              <b>-L</b> option as well as <b>-s</b> and <b>-S</b>.

              (The previous section mentioned that there might be subtle differences between the output of <b>agedu</b>
              <b>-s</b> <b>/path</b> <b>-D</b> and <b>agedu</b> <b>-S</b> <b>/path</b>. This is why. Doing a scan with <b>-s</b> and then dumping it with <b>-D</b> will
              dump the fully faked atimes on the directories, whereas doing a scan-to-dump  with  <b>-S</b>  will  dump
              only  <u>partially</u>  faked  atimes - specifically, each directory's last modification time - since the
              subsequent processing pass will not have had a chance to take place. However,  loading  either  of
              the  resulting  dump  files  with <b>-L</b> will perform the atime-faking processing pass, leading to the
              same data in the index file in each case. In normal usage it should be safe to ignore all of  this
              complexity.)

       <b>--mtime</b>
              This  option  causes  <b>agedu</b>  to  index files by their last modification time instead of their last
              access time. You might want to use this if your last access times were completely useless for some
              reason: for example, if you had recently searched every file on your system, the system would have
              lost all the information about what files you hadn't recently accessed  before  then.  Using  this
              option is liable to be less effective at finding genuinely wasted space than the normal mode (that
              is,  it  will  be  more  likely  to flag things as disused when they're not, so you will have more
              candidates to go through by hand looking for data you don't need), but may be better than  nothing
              if your last-access times are unhelpful.

              Another  use  for  this  mode  might be to find <u>recently</u> <u>created</u> large data. If your disk has been
              gradually filling up for years, the default mode of <b>agedu</b> will let you find unused data to delete;
              but if you know your disk had plenty of space recently and now it's suddenly full, and you suspect
              that some rogue program has left a large core dump or output file, then <b>agedu</b> <b>--mtime</b> might  be  a
              convenient way to locate the culprit.

       <b>--logicalsize</b>
              This  option  causes <b>agedu</b> to consider the size of each file to be its `logical' size, rather than
              the amount of space it consumes on disk. (That is, it will use <b>st_size</b> instead of <b>st_blocks</b> in the
              data returned from <b>stat</b>(<u>2</u>).) This option makes <b>agedu</b> less accurate at reporting how much  of  your
              disk  is  used,  but  it might be useful in specialist cases, such as working around a file system
              that is misreporting physical sizes.

              For most files, the physical size of a file will be larger than the logical size,  reflecting  the
              fact that filesystem layouts generally allocate a whole number of blocks of the disk to each file,
              so  some space is wasted at the end of the last block. So counting only the logical file size will
              typically cause under-reporting of the disk usage (perhaps <u>large</u> under-reporting in the case of  a
              very large number of very small files).

              On  the other hand, sometimes a file with a very large logical size can have `holes' where no data
              is actually stored, in which case using the logical size of the file  will  <u>over</u>-report  its  disk
              usage. So the use of logical sizes can give wrong answers in both directions.

       The following option affects all the modes that generate reports: the web server mode <b>-w</b>, the stand-alone
       HTML generation mode <b>-H</b> and the text report mode <b>-t</b>.

       <b>--files</b>
              This option causes <b>agedu</b>'s reports to list the individual files in each directory, instead of just
              giving a combined report for everything that's not in a subdirectory.

       The following option affects the text report mode <b>-t</b>.

       <b>-a</b> <u>age</u> or <b>--age</b> <u>age</u>
              This option tells <b>agedu</b> to report only files of at least the specified age. An age is specified as
              a number, followed by one of `<b>y</b>' (years), `<b>m</b>' (months), `<b>w</b>' (weeks) or `<b>d</b>' (days). (This syntax is
              also  used  by  the  <b>-r</b> option.) For example, <b>-a</b> <b>6m</b> will produce a text report which includes only
              files at least six months old.

       The following options affect the stand-alone HTML generation mode <b>-H</b> and the text report mode <b>-t</b>.

       <b>-d</b> <u>depth</u> or <b>--depth</b> <u>depth</u>
              This option controls the maximum depth to which <b>agedu</b> recurses when  generating  a  text  or  HTML
              report.

              In  text  mode,  the default is 1, meaning that the report will include the directory given on the
              command line and all of its immediate subdirectories. A depth of two includes another level  below
              that, and so on; a depth of zero means <u>only</u> the directory on the command line.

              In HTML mode, specifying this option switches <b>agedu</b> from writing out a single HTML file to writing
              out  multiple files which link to each other. A depth of 1 means <b>agedu</b> will write out an HTML file
              for the given directory and also one for each of its immediate subdirectories.

              If you want <b>agedu</b> to recurse as deeply as possible, give the special word `<b>max</b>' as an argument  to
              <b>-d</b>.

       <b>-o</b> <u>filename</u> or <b>--output</b> <u>filename</u>
              This  option  is  used to specify an output file for <b>agedu</b> to write its report to. In text mode or
              single-file HTML mode, the argument is treated as the name of a file. In multiple-file HTML  mode,
              the  argument  is treated as the name of a directory: the directory will be created if it does not
              already exist, and the output HTML files will be created inside it.

       The following option affects only the stand-alone HTML  generation  mode  <b>-H</b>,  and  even  then,  only  in
       recursive mode (with <b>-d</b>):

       <b>--numeric</b>
              This  option  tells <b>agedu</b> to name most of its output HTML files numerically. The root of the whole
              output file collection will still be called <b>index.html</b>, but all the  rest  will  have  names  like
              <b>73.html</b>  or  <b>12525.html</b>. (The numbers are essentially arbitrary; in fact, they're indices of nodes
              in the data structure used by <b>agedu</b>'s index file.)

              This system of file naming is less intuitive than the default  of  naming  files  after  the  sub-
              pathname  they index. It's also less stable: the same pathname will not necessarily be represented
              by the same filename if <b>agedu</b> <b>-H</b> is re-run after another scan of the same directory tree. However,
              it does have the virtue that it keeps the filenames <u>short</u>, so that even if your directory tree  is
              very deep, the output HTML files won't exceed any OS limit on filename length.

       The  following  options  affect  the  web  server  mode  <b>-w</b>,  and in some cases also the stand-alone HTML
       generation mode <b>-H</b>:

       <b>-r</b> <u>age</u> <u>range</u> or <b>--age-range</b> <u>age</u> <u>range</u>
              The HTML reports produced by <b>agedu</b> use a range of colours to indicate how long ago data  was  last
              accessed,  running  from  red  (representing  the  most  disused  data) to green (representing the
              newest). By default, the lengths of time represented by the two ends of that spectrum  are  chosen
              by examining the data file to see what range of ages appears in it. However, you might want to set
              your own limits, and you can do this using <b>-r</b>.

              The  argument  to  <b>-r</b> consists of a single age, or two ages separated by a minus sign. An age is a
              number, followed by one of `<b>y</b>' (years), `<b>m</b>' (months), `<b>w</b>' (weeks) or `<b>d</b>' (days). (This  syntax  is
              also  used  by  the <b>-a</b> option.) The first age in the range represents the oldest data, and will be
              coloured red in the HTML; the second age represents the newest, coloured green. If the second  age
              is  not  specified, it will default to zero (so that green means data which has been accessed <u>just</u>
              <u>now</u>).

              For example, <b>-r</b> <b>2y</b> will mark data in red if it has been unused for two years or more, and green if
              it has been accessed just now. <b>-r</b> <b>2y-3m</b> will similarly mark data red if it has been unused for two
              years or more, but will mark it green if it has been accessed three months ago or later.

       <b>--address</b> <u>addr</u>[<b>:</b><u>port</u>]
              Specifies the network address and port number on which <b>agedu</b> should listen when  running  its  web
              server. If you want <b>agedu</b> to listen for connections coming in from any source, specify the address
              as  the  special value <b>ANY</b>. If the port number is omitted, an arbitrary unused port will be chosen
              for you and displayed.

              If you specify this option, <b>agedu</b> will not print  its  URL  on  standard  output  (since  you  are
              expected to know what address you told it to listen to).

       <b>--auth</b> <u>auth-type</u>
              Specifies how <b>agedu</b> should control access to the web pages it serves. The options are as follows:

              <b>magic</b>  This  option  only  works  on Linux, and only when the incoming connection is from the same
                     machine that <b>agedu</b> is running on. On Linux, the special file <b><a href="file:/proc/net/tcp">/proc/net/tcp</a></b> contains a  list
                     of network connections currently known to the operating system kernel, including which user
                     id  created  them.  So  <b>agedu</b> will look up each incoming connection in that file, and allow
                     access if it comes from the same user id under which <b>agedu</b> itself is running. Therefore, in
                     <b>agedu</b>'s normal web server mode, you can safely run it on a multi-user machine and no  other
                     user will be able to read data out of your index file.

              <b>basic</b>  In  this  mode,  <b>agedu</b>  will use HTTP Basic authentication: the user will have to provide a
                     username and password via their browser.  <b>agedu</b>  will  normally  make  up  a  username  and
                     password for the purpose, but you can specify your own; see below.

              <b>none</b>   In this mode, the web server is unauthenticated: anyone connecting to it has full access to
                     the  reports generated by <b>agedu</b>. Do not do this unless there is nothing confidential at all
                     in your index file, or unless you are certain that nobody but you can run processes on your
                     computer.

              <b>default</b>
                     This is the default mode if you do not specify one of the above. In this mode,  <b>agedu</b>  will
                     attempt  to  use  Linux  magic  authentication,  but  if  it  detects  at startup time that
                     <b><a href="file:/proc/net/tcp">/proc/net/tcp</a></b> is absent or non-functional then it  will  fall  back  to  using  HTTP  Basic
                     authentication and invent a user name and password.

       <b>--auth-file</b> <u>filename</u> or <b>--auth-fd</b> <u>fd</u>
              When  <b>agedu</b>  is  using HTTP Basic authentication, these options allow you to specify your own user
              name and password. If you specify <b>--auth-file</b>, these will be read from the specified file; if  you
              specify  <b>--auth-fd</b>  they  will  instead be read from a given file descriptor which you should have
              arranged to pass to <b>agedu</b>. In either case,  the  authentication  details  should  consist  of  the
              username,  followed  by a colon, followed by the password, followed <u>immediately</u> by end of file (no
              trailing newline, or else it will be considered part of the password).

       <b>--title</b> <u>title</u>
              Specify the string that appears at the start of the <b>&lt;title&gt;</b> section of the output HTML pages.  The
              default  is `<b>agedu</b>'. This title is followed by a colon and then the path you're viewing within the
              index file. You might use this option if you were serving  <b>agedu</b>  reports  for  several  different
              servers and wanted to make it clearer which one a user was looking at.

       <b>--launch</b> <u>shell-command</u>
              Specify  a  command to be run with the base URL of the web user interface, once the web server has
              started up. The command will be interpreted by <b><a href="file:/bin/sh">/bin/sh</a></b>, and the base URL will be appended to it as
              an extra argument word.

              A typical use for this would  be  `<b>--launch=browse</b>',  which  uses  the  XDG  `<b>browse</b>'  command  to
              automatically  open  the  <b>agedu</b>  web  interface  in  your default browser. However, other uses are
              possible: for example, you could provide a command  which  communicates  the  URL  to  some  other
              software that will use it for something.

       <b>--no-eof</b>
              Stop  <b>agedu</b> in web server mode from looking for end-of-file on standard input and treating it as a
              signal to terminate.

</pre><h4><b>LIMITATIONS</b></h4><pre>
       The data file is pretty large. The core of <b>agedu</b> is the tree-based data structure it uses in its index in
       order to efficiently perform the queries it needs; this data structure requires <b>O(N</b> <b>log</b> <b>N)</b> storage.  This
       is  larger  than  you  might expect; a scan of my own home directory, containing half a million files and
       directories and about 20Gb of data, produced an index file over 60Mb in size. Furthermore, since the data
       file must be memory-mapped during most processing, it can never grow larger than available address space,
       so a <u>really</u> big filesystem may need to be indexed on a 64-bit computer.  (This  is  one  reason  for  the
       existence of the <b>-D</b> and <b>-L</b> options: you can do the scanning on the machine with access to the filesystem,
       and the indexing on a machine big enough to handle it.)

       The  data  structure  also  does  not usefully permit access control within the data file, so it would be
       difficult - even given the willingness to do additional coding - to run a system-wide  <b>agedu</b>  scan  on  a
       <b>cron</b> job and serve the right subset of reports to each user.

       In  certain circumstances, <b>agedu</b> can report false positives (reporting files as disused which are in fact
       in use) as well as the more benign false negatives (reporting files as in use which are not). This arises
       when a file is, semantically speaking, `read' without actually  being  physically  <u>read</u>.  Typically  this
       occurs  when  a  program checks whether the file's mtime has changed and only bothers re-reading it if it
       has; programs which do this include <b>rsync</b>(<u>1</u>) and <b>make</b>(<u>1</u>). Such programs will fail to update the atime  of
       unmodified  files  despite depending on their continued existence; a directory full of such files will be
       reported as disused by <b>agedu</b> even in situations where deleting them will cause trouble.

       Finally, of course, <b>agedu</b>'s normal usage mode depends critically on the OS  providing  last-access  times
       which  are  at  least approximately right. So a file system mounted with Linux's `<b>noatime</b>' option, or the
       equivalent on any other OS, will not give useful results! (However, the Linux  mount  option  `<b>relatime</b>',
       which  distributions  now  tend  to  use  by  default, should be fine for all but specialist purposes: it
       reduces the accuracy of last-access times so that they might be wrong by up to 24 hours,  but  if  you're
       looking for files that have been unused for months or years, that's not a problem.)

</pre><h4><b>LICENCE</b></h4><pre>
       <b>agedu</b>  is  free software, distributed under the MIT licence. Type <b>agedu</b> <b>--licence</b> to see the full licence
       text.

Simon Tatham                                       2008‐11‐02                                           <u><a href="../man1/agedu.1.html">agedu</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>