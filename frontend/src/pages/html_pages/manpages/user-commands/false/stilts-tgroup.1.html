<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>stilts-tgroup - Calculates aggregate functions on groups of rows</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/stilts">stilts_3.5.1-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       stilts-tgroup - Calculates aggregate functions on groups of rows

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>stilts</b> <b>tgroup</b> [ifmt=<u>&lt;in-format&gt;</u>] [istream=<u>true|false</u>] [in=<u>&lt;table&gt;</u>] [icmd=<u>&lt;cmds&gt;</u>] [ocmd=<u>&lt;cmds&gt;</u>]
                     [omode=<u>out|meta|stats|count|checksum|cgi|discard|topcat|samp|tosql|gui</u>] [out=<u>&lt;out-table&gt;</u>]
                     [ofmt=<u>&lt;out-format&gt;</u>] [keys=<u>&lt;expr&gt;</u> <u>...</u>] [aggcols=<u>&lt;expr&gt;;&lt;aggregator&gt;[;&lt;name&gt;]</u> <u>...</u>]
                     [runner=<u>sequential|parallel|parallel&lt;n&gt;|partest</u>] [sort=<u>true|false</u>] [cache=<u>true|false</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>tgroup</u>  identifies groups of rows in a table based on the values in a given column or columns, and calcu‐
       lates statistical quantities or otherwise collapses down the multiple values from other columns into sin‐
       gle values representing each group. It does the same job as a <u>SELECT</u> <u>...</u> <u>GROUP</u> <u>BY</u> statement  with  aggre‐
       gate functions in ADQL/SQL.

       The  <u>keys</u> parameter defines how input rows are grouped, and the <u>aggcols</u> parameter defines what quantities
       to aggregate from the rows in each group. <u>keys</u> specifies one or more values  (column  names  or  express‐
       sions)  that  must be the same for rows grouped together, while <u>aggcols</u> specifies zero or more columns to
       be added based on the content of rows in each group. The output table therefore contains one  column  for
       each entry in <u>keys</u> and one column for each entry in <u>aggcols</u>, and has one row for each group identified.

       This  command can therefore be used to count rows or calculate statistical quantities per group. A number
       of statistical aggregation methods are provided such as mean, median, minimum, maximum etc. For more spe‐
       cialised requirements, for instance quantiles or custom statistics, you can also use the  array  aggrega‐
       tors which generate an array containing all of the values in the group, and operate on the resulting col‐
       umn using one of the functions in the Arrays class.

       By way of comparison, the <u>tgroup</u> invocation: stilts tgroup in=t keys="year detector" aggcols="0;count;num
       gmag;min;min_gmag  gmag;mean" corresponds roughly to the ADQL query: SELECT COUNT(*) AS num, MIN(gmag) AS
       min_gmag, MEAN(gmag), FROM t GROUP BY year, detector

       See also the <u>tgridmap</u> and <u>tskymap</u> commands, which provide similar functionality  where  the  grouping  is
       over evenly spaced numeric/coordinate values.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>ifmt=</b><u>&lt;in-format&gt;</u>
              Specifies the format of the input table as specified by parameter <u>in</u>. The known formats are listed
              in  SUN/256. This flag can be used if you know what format your table is in. If it has the special
              value <u>(auto)</u> (the default), then an attempt will be made to detect the format of the  table  auto‐
              matically.  This cannot always be done correctly however, in which case the program will exit with
              an error explaining which formats were attempted. This parameter is ignored  for  scheme-specified
              tables.

       <b>istream=</b><u>true|false</u>
              If  set true, the input table specified by the <u>in</u> parameter will be read as a stream. It is neces‐
              sary to give the <u>ifmt</u> parameter in this case. Depending on the required operations and  processing
              mode,  this  may  cause  the  read  to fail (sometimes it is necessary to read the table more than
              once). It is not normally necessary to set this flag; in most cases the data will be streamed  au‐
              tomatically  if that is the best thing to do. However it can sometimes result in less resource us‐
              age when processing large files in certain formats (such as VOTable). This  parameter  is  ignored
              for scheme-specified tables.

       <b>in=</b><u>&lt;table&gt;</u>
              The location of the input table. This may take one of the following forms:

                * A filename.

                * A URL.

                * The special value "<u>-</u>", meaning standard input. In this case the input format must be given ex‐
                  plicitly using the <u>ifmt</u> parameter. Note that not all formats can be streamed in this way.

                * A scheme specification of the form <u>:&lt;scheme-name&gt;:&lt;scheme-args&gt;</u>.

                * A  system command line with either a "<u>&lt;</u>" character at the start, or a "<u>|</u>" character at the end
                  ("<u>&lt;syscmd</u>" or "<u>syscmd|</u>"). This executes the given pipeline and reads from its standard output.
                  This will probably only work on unix-like systems.
               In any case, compressed data in one of the supported compression formats (gzip, Unix compress  or
              bzip2) will be decompressed transparently.

       <b>icmd=</b><u>&lt;cmds&gt;</u>
              Specifies  processing  to be performed on the input table as specified by parameter <u>in</u>, before any
              other processing has taken place. The value of this parameter is one or more of  the  filter  com‐
              mands described in SUN/256. If more than one is given, they must be separated by semicolon charac‐
              ters  (";").  This parameter can be repeated multiple times on the same command line to build up a
              list of processing steps. The sequence of commands  given  in  this  way  defines  the  processing
              pipeline which is performed on the table.

              Commands  may  alternatively  be  supplied in an external file, by using the indirection character
              '<u>@</u>'. Thus a value of "<u>@filename</u>" causes the file <u>filename</u> to be read for a list of filter commands
              to execute. The commands in the file may be separated by newline characters and/or semicolons, and
              lines which are blank or which start with a '<u>#</u>' character are ignored. A backslash character '<u>\fR'</u>
              <u>at</u> <u>the</u> <u>end</u> <u>of</u> <u>a</u> <u>line</u> <u>joins</u> <u>it</u> <u>with</u> <u>the</u> <u>following</u> <u>line.</u>

       <b>ocmd=</b><u>&lt;cmds&gt;</u>
              Specifies processing to be performed on the output table, after all  other  processing  has  taken
              place.  The value of this parameter is one or more of the filter commands described in SUN/256. If
              more than one is given, they must be separated by semicolon characters (";"). This  parameter  can
              be  repeated  multiple  times on the same command line to build up a list of processing steps. The
              sequence of commands given in this way defines the processing pipeline which is performed  on  the
              table.

              Commands  may  alternatively  be  supplied in an external file, by using the indirection character
              '<u>@</u>'. Thus a value of "<u>@filename</u>" causes the file <u>filename</u> to be read for a list of filter commands
              to execute. The commands in the file may be separated by newline characters and/or semicolons, and
              lines which are blank or which start with a '<u>#</u>' character are ignored. A backslash character '<u>\fR'</u>
              <u>at</u> <u>the</u> <u>end</u> <u>of</u> <u>a</u> <u>line</u> <u>joins</u> <u>it</u> <u>with</u> <u>the</u> <u>following</u> <u>line.</u>

       <b>omode=</b><u>out|meta|stats|count|checksum|cgi|discard|topcat|samp|tosql|gui</u>
              The mode in which the result table will be output. The default mode is <u>out</u>, which means  that  the
              result  will be written as a new table to disk or elsewhere, as determined by the <u>out</u> and <u>ofmt</u> pa‐
              rameters. However, there are other possibilities, which correspond to uses to which a table can be
              put other than outputting it, such as displaying metadata, calculating statistics, or populating a
              table in an SQL database. For some values of this parameter, additional  parameters  (<u>&lt;mode-args&gt;</u>)
              are required to determine the exact behaviour.

              Possible values are

                * <u>out</u>

                * <u>meta</u>

                * <u>stats</u>

                * <u>count</u>

                * <u>checksum</u>

                * <u>cgi</u>

                * <u>discard</u>

                * <u>topcat</u>

                * <u>samp</u>

                * <u>tosql</u>

                * <u>gui</u>
               Use the <u>help=omode</u> flag or see SUN/256 for more information.

       <b>out=</b><u>&lt;out-table&gt;</u>
              The  location  of  the output table. This is usually a filename to write to. If it is equal to the
              special value "-" (the default) the output table will be written to standard output.

              This parameter must only be given if <u>omode</u> has its default value of "<u>out</u>".

       <b>ofmt=</b><u>&lt;out-format&gt;</u>
              Specifies the format in which the output table will be written (one  of  the  ones  in  SUN/256  -
              matching  is  case-insensitive  and you can use just the first few letters). If it has the special
              value "<u>(auto)</u>" (the default), then the output filename will be examined to try to guess what  sort
              of  file  is  required  usually by looking at the extension. If it's not obvious from the filename
              what output format is intended, an error will result.

              This parameter must only be given if <u>omode</u> has its default value of "<u>out</u>".

       <b>keys=</b><u>&lt;expr&gt;</u> <u>...</u>
              List of one or more space-separated words defining the groups within which aggregation  should  be
              done.  Each word can be a column name or an expression using the expression language. Each expres‐
              sion will appear as one of the columns in the output table. This list corresponds to the  contents
              of an ADQL/SQL <u>GROUP</u> <u>BY</u> clause.

       <b>aggcols=</b><u>&lt;expr&gt;;&lt;aggregator&gt;[;&lt;name&gt;]</u> <u>...</u>
              Defines  the  aggregate quantities to be calculated for each group of input rows. Each quantity is
              defined by one entry in this list; entries are space-separated, or can be given  by  multiple  in‐
              stances of this parameter on the command line.

              Each entry is composed of two or three tokens, separated by semicolon ("<u>;</u>") characters:

                * <u>&lt;expr&gt;</u>:  (required) column name, or expression using the expression language, for the quantity
                  to be aggregated

                * <u>&lt;aggregator&gt;</u>: (required) aggregation method

                * <u>&lt;name&gt;</u>: (optional) name of output column; if omitted, a name based on the <u>&lt;expr&gt;</u> value will be
                  used

              The available <u>&lt;aggregator&gt;</u> values are as follows:

                * <u>count</u>: counts the number of rows

                * <u>ngood</u>: counts the number of non-blank items

                * <u>sum</u>: the sum of all the combined values per bin

                * <u>mean</u>: the mean of the combined values

                * <u>median</u>: the median

                * <u>stdev</u>: the sample standard deviation of the combined values

                * <u>stdev-pop</u>: the population standard deviation of the combined values

                * <u>max</u>: records the maximum value

                * <u>min</u>: records the minimum value

                * <u>array</u>: collects all non-blank values into an array

                * <u>array-withblanks</u>: collects all values into an array; blank values are represented as zero  for
                  integers

                * <u>count-long</u>: counts the number of rows, works for &gt;2 billion

                * <u>ngood-long</u>: counts the number of non-blank items, works for &gt;2 billion

                * <u>Q.nnn</u>: quantile nnn (e.g. Q.05 is the fifth percentile)

       <b>runner=</b><u>sequential|parallel|parallel&lt;n&gt;|partest</u>
              Selects  the threading implementation, i.e. to what extent processing is done in parallel. The op‐
              tions are currently:

                * <u>sequential</u>: runs using only a single thread

                * <u>parallel</u>: runs using multiple threads for large tables, with parallelism given by  the  number
                  of available processors

                * <u>parallel&lt;n&gt;</u>:  runs using multiple threads for large tables, with parallelism given by the sup‐
                  plied value <u>&lt;n&gt;</u>

                * <u>partest</u>: runs using multiple threads even when tables are small  (only  intended  for  testing
                  purposes)

              Using parallel processing can speed up execution considerably; however, depending on the I/O oper‐
              ations required, it can also slow it down by disrupting patterns of disk access. If the content of
              a file is on a solid state disk, or is already in cache for instance because a similar command has
              been  run  recently, then <u>parallel</u> will probably be faster. However, if the data is being read di‐
              rectly from a spinning disk, for instance because the file is too large to fit in  RAM,  then  <u>se‐</u>
              <u>quential</u> or <u>parallel&lt;n&gt;</u> with a small <u>&lt;n&gt;</u> may be faster.

              The value of this parameter should make only very tiny differences to the output table. If you no‐
              tice significant discrepancies <b>please</b> <b>report</b> <b>them</b>.

       <b>sort=</b><u>true|false</u>
              Determines  whether  an attempt is made to sort the output table by the values of the <u>keys</u> expres‐
              sions. This may not be possible if no sort order is defined on the keys.

              In most cases such sorting will be a small overhead on the rest of the work done by this task,  so
              the default is <u>true</u> but if ordering by key is not useful you may save some resources by setting it
              <u>false</u>. If no sorting is done, the output row order is undefined.

       <b>cache=</b><u>true|false</u>
              Determines  whether the results of the aggregation operation will be cached in random-access stor‐
              age before output. This is set true by default, since accessing rows of the calculated  table  may
              be somewhat expensive, and most uses of the results will need all of the cells. But if you antici‐
              pate  making only a small number of accesses to the output table cells, it could be more efficient
              to set this false.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/stilts.1.html">stilts</a></b>(1)

       If the package stilts-doc is installed, the full documentation <b>SUN/256</b> is available in HTML format:
       file:///usr/share/doc/stilts/sun256/index.html

</pre><h4><b>VERSION</b></h4><pre>
       STILTS version 3.5.1-debian

       This is the Debian version of Stilts, which lack the support of some file formats and network  protocols.
       For differences see
       file:///usr/share/doc/stilts/README.Debian

</pre><h4><b>AUTHOR</b></h4><pre>
       Mark Taylor (Bristol University)

                                                    Mar 2017                                    <u><a href="../man1/STILTS-TGROUP.1.html">STILTS-TGROUP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>