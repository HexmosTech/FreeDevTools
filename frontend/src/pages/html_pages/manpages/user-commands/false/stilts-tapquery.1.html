<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>stilts-tapquery - Queries a Table Access Protocol server</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/stilts">stilts_3.5.1-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       stilts-tapquery - Queries a Table Access Protocol server

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>stilts</b> <b>tapquery</b> [nupload=<u>&lt;count&gt;</u>] [ufmtN=<u>&lt;in-format&gt;</u>] [uploadN=<u>&lt;tableN&gt;</u>] [ucmdN=<u>&lt;cmds&gt;</u>] [ocmd=<u>&lt;cmds&gt;</u>]
                       [omode=<u>out|meta|stats|count|checksum|cgi|discard|topcat|samp|tosql|gui</u>] [out=<u>&lt;out-table&gt;</u>]
                       [ofmt=<u>&lt;out-format&gt;</u>] [upnameN=<u>&lt;adql-identifier&gt;</u>] [tapurl=<u>&lt;url-value&gt;</u>]
                       [interface=<u>tap1.0|tap1.1|cap</u>] [auth=<u>true|false</u>] [adql=<u>&lt;query-text&gt;</u>] [parse=<u>true|false</u>]
                       [sync=<u>true|false</u>] [maxrec=<u>&lt;nrow&gt;</u>] [destruction=<u>&lt;iso8601&gt;</u>] [executionduration=<u>&lt;seconds&gt;</u>]
                       [compress=<u>true|false</u>] [upvotformat=<u>TABLEDATA|BINARY|BINARY2</u>] [language=<u>&lt;lang-name&gt;</u>]
                       [poll=<u>&lt;millisec&gt;</u>] [progress=<u>true|false</u>] [delete=<u>finished|never|always|now</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>tapquery</u>  can  query remote databases using the Table Access Protocol (TAP) services by submitting Astro‐
       nomical Data Query Language (ADQL) queries to them and retrieving the results. TAP and ADQL  are  Virtual
       Observatory protocols.

       Queries can be submitted in either synchronous or asynchronous mode, as determined by the <u>sync</u> parameter.
       In asynchronous mode, if the query has not been deleted by the time the command exits (see the <u>delete</u> pa‐
       rameter), the result can be picked up at a later stage using the <u>tapresume</u> command.

       Table  uploads are supported, so it is possible (if the service supports this functionality), to upload a
       local table to the remote database, perform a query involving it, such as a join with a remote  table  of
       some sort, and receive the result. This powerful facility gives you crossmatches between local and remote
       tables.

       For  services  that  require  authentication,  you  will  need to supply your credentials as described in
       SUN/256. Otherwise, queries will be submitted anonymously by default, but you can force a  login  attempt
       to services with optional authentication by setting <u>auth=true</u>.

       This  command does not provide any facility for querying the service for either table or capability meta‐
       data, so you will need to know about the service capabilities and  database  structure  from  some  other
       source (possibly TOPCAT).

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>nupload=</b><u>&lt;count&gt;</u>
              The number of upload tables for this task. For each of the upload tables N there will be associat‐
              ed parameters <u>ufmtN</u>, <u>uploadN</u> and <u>ucmdN</u>.

       <b>ufmtN=</b><u>&lt;in-format&gt;</u>
              Specifies  the  format of upload table #N as specified by parameter <u>uploadN</u>. The known formats are
              listed in SUN/256. This flag can be used if you know what format your table is in. If it  has  the
              special value <u>(auto)</u> (the default), then an attempt will be made to detect the format of the table
              automatically.  This  cannot always be done correctly however, in which case the program will exit
              with an error explaining which formats were attempted. This parameter is ignored for scheme-speci‐
              fied tables.

       <b>uploadN=</b><u>&lt;tableN&gt;</u>
              The location of upload table #N. This may take one of the following forms:

                * A filename.

                * A URL.

                * The special value "<u>-</u>", meaning standard input. In this case the input format must be given ex‐
                  plicitly using the <u>ufmtN</u> parameter. Note that not all formats can be streamed in this way.

                * A scheme specification of the form <u>:&lt;scheme-name&gt;:&lt;scheme-args&gt;</u>.

                * A system command line with either a "<u>&lt;</u>" character at the start, or a "<u>|</u>" character at the  end
                  ("<u>&lt;syscmd</u>" or "<u>syscmd|</u>"). This executes the given pipeline and reads from its standard output.
                  This will probably only work on unix-like systems.
               In  any case, compressed data in one of the supported compression formats (gzip, Unix compress or
              bzip2) will be decompressed transparently.

       <b>ucmdN=</b><u>&lt;cmds&gt;</u>
              Specifies processing to be performed on upload table #N as specified by parameter <u>uploadN</u>,  before
              any  other  processing  has  taken place. The value of this parameter is one or more of the filter
              commands described in SUN/256. If more than one is given, they  must  be  separated  by  semicolon
              characters  (";"). This parameter can be repeated multiple times on the same command line to build
              up a list of processing steps. The sequence of commands given in this way defines  the  processing
              pipeline which is performed on the table.

              Commands  may  alternatively  be  supplied in an external file, by using the indirection character
              '<u>@</u>'. Thus a value of "<u>@filename</u>" causes the file <u>filename</u> to be read for a list of filter commands
              to execute. The commands in the file may be separated by newline characters and/or semicolons, and
              lines which are blank or which start with a '<u>#</u>' character are ignored. A backslash character '<u>\fR'</u>
              <u>at</u> <u>the</u> <u>end</u> <u>of</u> <u>a</u> <u>line</u> <u>joins</u> <u>it</u> <u>with</u> <u>the</u> <u>following</u> <u>line.</u>

       <b>ocmd=</b><u>&lt;cmds&gt;</u>
              Specifies processing to be performed on the output table, after all  other  processing  has  taken
              place.  The value of this parameter is one or more of the filter commands described in SUN/256. If
              more than one is given, they must be separated by semicolon characters (";"). This  parameter  can
              be  repeated  multiple  times on the same command line to build up a list of processing steps. The
              sequence of commands given in this way defines the processing pipeline which is performed  on  the
              table.

              Commands  may  alternatively  be  supplied in an external file, by using the indirection character
              '<u>@</u>'. Thus a value of "<u>@filename</u>" causes the file <u>filename</u> to be read for a list of filter commands
              to execute. The commands in the file may be separated by newline characters and/or semicolons, and
              lines which are blank or which start with a '<u>#</u>' character are ignored. A backslash character '<u>\fR'</u>
              <u>at</u> <u>the</u> <u>end</u> <u>of</u> <u>a</u> <u>line</u> <u>joins</u> <u>it</u> <u>with</u> <u>the</u> <u>following</u> <u>line.</u>

       <b>omode=</b><u>out|meta|stats|count|checksum|cgi|discard|topcat|samp|tosql|gui</u>
              The mode in which the result table will be output. The default mode is <u>out</u>, which means  that  the
              result  will be written as a new table to disk or elsewhere, as determined by the <u>out</u> and <u>ofmt</u> pa‐
              rameters. However, there are other possibilities, which correspond to uses to which a table can be
              put other than outputting it, such as displaying metadata, calculating statistics, or populating a
              table in an SQL database. For some values of this parameter, additional  parameters  (<u>&lt;mode-args&gt;</u>)
              are required to determine the exact behaviour.

              Possible values are

                * <u>out</u>

                * <u>meta</u>

                * <u>stats</u>

                * <u>count</u>

                * <u>checksum</u>

                * <u>cgi</u>

                * <u>discard</u>

                * <u>topcat</u>

                * <u>samp</u>

                * <u>tosql</u>

                * <u>gui</u>
               Use the <u>help=omode</u> flag or see SUN/256 for more information.

       <b>out=</b><u>&lt;out-table&gt;</u>
              The  location  of  the output table. This is usually a filename to write to. If it is equal to the
              special value "-" (the default) the output table will be written to standard output.

              This parameter must only be given if <u>omode</u> has its default value of "<u>out</u>".

       <b>ofmt=</b><u>&lt;out-format&gt;</u>
              Specifies the format in which the output table will be written (one  of  the  ones  in  SUN/256  -
              matching  is  case-insensitive  and you can use just the first few letters). If it has the special
              value "<u>(auto)</u>" (the default), then the output filename will be examined to try to guess what  sort
              of  file  is  required  usually by looking at the extension. If it's not obvious from the filename
              what output format is intended, an error will result.

              This parameter must only be given if <u>omode</u> has its default value of "<u>out</u>".

       <b>upnameN=</b><u>&lt;adql-identifier&gt;</u>
              Identifier to use in server-side expressions for uploaded table #N. In ADQL expressions, the table
              should be referred to as "<u>TAP_UPLOAD.&lt;label&gt;</u>".

              The value must syntactically be an ADQL identifier (<u>[A-Za-z][A-Za-z0-9_]*</u>).

       <b>tapurl=</b><u>&lt;url-value&gt;</u>
              The base URL of a Table Access  Protocol  service.  This  is  the  bare  URL  without  a  trailing
              "/[a]sync".

              In  the  usual case, the default values of the various endpoints (sync and async query submission,
              tables metadata, service-provided examples etc) use this URL as a parent and append standard  sub-
              paths.

              In  some  cases  however, determination of the endpoints is more complicated, as determined by the
              <u>interface</u> parameter which may cause endpoints  to  be  read  from  the  capabilities  document  at
              <u>tapurl/capabilities</u>,  and by other endpoint-specific parameters (<u>syncurl</u>, <u>asyncurl</u>, <u>tablesurl</u>, <u>ca‐</u>
              <u>pabilitiesurl</u>, <u>availabilityurl</u>, <u>examplesurl</u>) for fine tuning.

       <b>interface=</b><u>tap1.0|tap1.1|cap</u>
              Defines how the service endpoints and the version of the TAP protocol to use for queries is deter‐
              mined. This may take one of the following (case-insensitive) values:

                * <u>TAP1.0</u>: The standard TAP endpoints are used, without examining the service's capabilities doc‐
                  ument. The service is queried using version 1.0 of the TAP protocol.

                * <u>TAP1.1</u>: The standard TAP endpoints are used, without examining the service's capabilities doc‐
                  ument. The service is queried using version 1.1 of the TAP protocol.

                * <u>cap</u>: The service's capabilities document is examined, and the endpoints listed there are used.

              The capabilities document, if used, is read from <u>tapurl</u>/capabilities  unless  the  <u>capabilitiesurl</u>
              parameter is defined, in which case that is used.

              The  baseline value of all the TAP service endpoints (<u>sync</u>, <u>async</u>, <u>tables</u>, <u>capabilities</u>, <u>examples</u>)
              are determined by this parameter, but each of those endpoint values may be overridden individually
              by other endpoint-specific parameters (<u>syncurl</u>, <u>asyncurl</u>, <u>tablesurl</u>, <u>capabilitiesurl</u>,  <u>availabili‐</u>
              <u>tyurl</u>, <u>examplesurl</u>)

              For default (unauthenticated) access, the default value is usually suitable.

       <b>auth=</b><u>true|false</u>
              If true, then an attempt will be made to authenticate with the TAP service even if anonymous oper‐
              ation is permitted. If the service offers authentication, you will be asked for credentials.

              To  use  this  option  in  non-interactive  contexts,  you  may  want to use the <u>auth.username</u> and
              <u>auth.password</u> system properties.

       <b>adql=</b><u>&lt;query-text&gt;</u>
              Astronomical Data Query Language string specifying the TAP query to execute. ADQL/S resembles SQL,
              so this string will likely start with "SELECT".

       <b>parse=</b><u>true|false</u>
              Determines whether an attempt will be made to check the syntax of the ADQL prior to submitting the
              query. If this is set true, and if a syntax error is found, the task will fail with an  error  be‐
              fore any attempt is made to submit the query.

       <b>sync=</b><u>true|false</u>
              Determines  whether  the  TAP  query is submitted in synchronous or asynchronous mode. Synchronous
              (<u>true</u>) means that the result is retrieved over the same HTTP connection that the query is  submit‐
              ted  from. This is uncomplicated, but means if the query takes a long time it may time out and the
              results will be lost. Asynchronous (<u>false</u>) means that the job is queued and  results  may  be  re‐
              trieved later. Normally this command does the necessary waiting around and recovery of the result,
              though  with  appropriate  settings  you can get <u>tapresume</u> to pick it up for you later instead. In
              most cases <u>false</u> (the default) is preferred.

       <b>maxrec=</b><u>&lt;nrow&gt;</u>
              Sets the requested maximum row count for the result of the query. The service is  not  obliged  to
              respect  this,  but in the case that it has a default maximum record count, setting this value may
              raise the limit. If no value is set, the service's default policy will be used.

       <b>destruction=</b><u>&lt;iso8601&gt;</u>
              Posts an updated value of the UWS DESTRUCTION parameter to the query job before  it  starts.  This
              only makes sense for asynchronous jobs (<u>sync</u>=false).

              The  supplied  value  should  be an ISO-8601-like string, giving the new requested job destruction
              time. The service is not obliged to honour this request. See UWS v1.0, sec 2.2.3.3.

       <b>executionduration=</b><u>&lt;seconds&gt;</u>
              Posts an updated value of the UWS EXECUTIONDURATION parameter to the query job before  it  starts.
              This only makes sense for asynchronous jobs (<u>sync</u>=false).

              The supplied value is an integer giving the maximum number of wall-clock seconds for which the job
              is  permitted to execute before being forcibly terminated. A value of zero indicates unlimited du‐
              ration. The service is not obliged to honour this request. See UWS v1.0, sec 2.2.3.4.

       <b>compress=</b><u>true|false</u>
              If true, the service is requested to provide HTTP-level compression for the response  stream  (Ac‐
              cept-Encoding  header  is  set  to "<u>gzip</u>", see RFC 2616). This does not guarantee that compression
              will happen but if the service honours this request it may result in a smaller amount  of  network
              traffic at the expense of more processing on the server and client.

       <b>upvotformat=</b><u>TABLEDATA|BINARY|BINARY2</u>
              Determines how any uploaded tables will be serialized for transmission to the TAP server. The sup‐
              plied string is the name of one of the defined VOTable serialization formats. The choice shouldn't
              affect  any results, though it may affect required bandwidth, and some services may (though should
              not) have non-standard requirements for serialization format.

       <b>language=</b><u>&lt;lang-name&gt;</u>
              Language to use for the ADQL-like query. This will usually be "ADQL" (the default), but may be set
              to some other value supported by the service, for instance a variant indicating a  different  ADQL
              version. Note that at present, setting it to "PQL" is not sufficient to submit a PQL query.

       <b>poll=</b><u>&lt;millisec&gt;</u>
              Interval to wait between polling attempts, in milliseconds. Asynchronous TAP queries can only find
              out when they are complete by repeatedly polling the server to find out the job's status. This pa‐
              rameter allows you to set how often that happens. Attempts to set it too low (&lt;50) will be reject‐
              ed on the assumption that you're thinking in seconds.

       <b>progress=</b><u>true|false</u>
              If this parameter is set true, progress of the job is reported to standard output as it happens.

       <b>delete=</b><u>finished|never|always|now</u>
              Determines  under what circumstances the UWS job is to be deleted from the server when its data is
              no longer required. If it is not deleted, then the job is left on the TAP server and it can be ac‐
              cessed via the normal UWS REST endpoints or using <u>tapresume</u> until it is destroyed by the server.

              Possible values:

                * <u>finished</u>: delete only if the job finished, successfully or not

                * <u>never</u>: do not delete

                * <u>always</u>: delete on command exit

                * <u>now</u>: delete and return immediately

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/stilts.1.html">stilts</a></b>(1)

       If the package stilts-doc is installed, the full documentation <b>SUN/256</b> is available in HTML format:
       file:///usr/share/doc/stilts/sun256/index.html

</pre><h4><b>VERSION</b></h4><pre>
       STILTS version 3.5.1-debian

       This is the Debian version of Stilts, which lack the support of some file formats and network  protocols.
       For differences see
       file:///usr/share/doc/stilts/README.Debian

</pre><h4><b>AUTHOR</b></h4><pre>
       Mark Taylor (Bristol University)

                                                    Mar 2017                                  <u><a href="../man1/STILTS-TAPQUERY.1.html">STILTS-TAPQUERY</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>