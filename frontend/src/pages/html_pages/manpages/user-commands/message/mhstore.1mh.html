<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mhstore - store contents of nmh MIME messages into files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nmh">nmh_1.8-3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mhstore - store contents of nmh MIME messages into files

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>mhstore</b> [<b>-help</b>] [<b>-version</b>] [<u>+folder</u>] [<u>msgs</u>] [<b>-file</b> <u>file</u>] [<b>-outfile</b> <u>outfile</u>] [<b>-part</b> <u>number</u>] ...  [<b>-type</b>
            <u>content</u>] ...  [<b>-prefer</b> <u>content</u>] ...  [<b>-noprefer</b>] [<b>-auto</b> | <b>-noauto</b>] [<b>-clobber</b> <u>always</u> | <u>auto</u> | <u>suffix</u>
            | <u>ask</u> | <u>never</u>] [<b>-verbose</b> | <b>-noverbose</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>mhstore</b> command allows you to store the contents of a collection of MIME (multi-media) messages into
       files or other messages.

       <b>mhstore</b> manipulates multi-media messages as specified in RFC 2045 to RFC 2049.

       By default, <b>mhstore</b> will store all the parts of each message.  Each part will be  stored  in  a  separate
       file.  The header fields of the message are not stored.  By using the <b>-part</b>, <b>-type</b>, and <b>-prefer</b> switches,
       you may limit and reorder the set of parts to be stored, based on part number and/or content type.

       The  <b>-file</b>  <u>file</u>  switch  directs  <b>mhstore</b> to use the specified file as the source message, rather than a
       message from a folder.  If you specify this file as “-”, then <b>mhstore</b> will accept the source  message  on
       the  standard  input.   Note  that  the file, or input from standard input, should be a validly formatted
       message, just like any other <b>nmh</b> message.  It should <u>not</u> be in mail drop format (to  convert  a  file  in
       mail drop format to a folder of <b>nmh</b> messages, see <u><a href="../man1/inc.1.html">inc</a></u>(1)).

       A  part  specification  consists  of  a series of numbers separated by dots.  For example, in a multipart
       content containing three parts, these would be named as 1, 2, and 3, respectively.  If part 2 was also  a
       multipart content containing two parts, these would be named as 2.1 and 2.2, respectively.  Note that the
       <b>-part</b>  switch is effective only for messages containing a multipart content.  If a message has some other
       kind of content, or if the part is itself another multipart content, the <b>-part</b> switch  will  not  prevent
       the content from being acted upon.

       The  <b>-type</b>  switch  can  also  be  used  to restrict (or, when used in conjunction with <b>-part</b>, to further
       restrict) the selection of parts according to content type.  One or more <b>-type</b> switches  part  will  only
       select  the first match from a multipart/alternative, even if there is more than one subpart that matches
       (one of) the given content type(s).

       Using either <b>-part</b> or <b>-type</b> switches alone will cause either to select the  part(s)  they  match.   Using
       them  together  will  select  only  the  part(s) matched by both (sets of) switches.  In other words, the
       result is the intersection, and not the union, of their separate match results.

       A content specification consists of a content type and a subtype.  The initial list of “standard” content
       types and subtypes can be found in RFC 2046.

       A list of commonly used contents is briefly reproduced here:

            Type         Subtypes
            ----         --------
            text         plain, enriched
            multipart    mixed, alternative, digest, parallel
            message      rfc822, external-body
            application  octet-stream, postscript
            image        jpeg, gif, png
            audio        basic
            video        mpeg

       A legal MIME message must contain a subtype specification.

       To specify a content, regardless of its subtype, just use the name of the  content,  e.g.,  “audio”.   To
       specify  a specific subtype, separate the two with a slash, e.g., “audio/basic”.  Note that regardless of
       the values given to the <b>-type</b> switch, a multipart content (of any subtype listed above) is  always  acted
       upon.   Further  note that if the <b>-type</b> switch is used, and it is desirable to act on a message/external-
       body content, then the <b>-type</b> switch must be used twice: once for message/external-body and once  for  the
       content externally referenced.

       The  <b>-prefer</b>  switch  will  alter  the  part-ordering  of multipart/alternative MIME sections in order to
       override the sender-imposed default ordering.  The <b>-prefer</b> switch  is  functionally  most  important  for
       <b>mhshow</b>,  but  is also implemented in <b>mhlist</b> and <b>mhstore</b> to make common part-numbering possible across all
       three programs.  The last of multiple <b>-prefer</b> switches will have the highest priority.  This  allows  the
       command  line  switches to override profile entries.  See <u><a href="../man1/mhlist.1.html">mhlist</a></u>(1) and <u><a href="../man1/mhshow.1.html">mhshow</a></u>(1) for more information on
       <b>-prefer</b>.

       The <b>-noprefer</b> switch will cancel any previous <b>-prefer</b> switches.

   <b>Storing</b> <b>the</b> <b>Contents</b>
       <b>mhstore</b> will store the contents of the named messages in “native” (decoded) format.  Two things  must  be
       determined:  the  directory  in  which to store the content, and the filenames.  Files are written in the
       directory given by the “nmh-storage” profile entry, e.g.,

            nmh-storage: <a href="file:/tmp">/tmp</a>

       If this entry isn't present, the current working directory is used.

       If the <b>-outfile</b> switch is given, its argument is used for the filename to store all of the content,  with
       “-”  indicating  standard  output.   If the <b>-auto</b> switch is given, then <b>mhstore</b> will check if the message
       contains information indicating the filename that should be used to store the content.  This  information
       should  be  specified  as  the  “filename” attribute in the “Content-Disposition” header or as the “name”
       attribute in the “Content-Type” header for the content you  are  storing.   For  security  reasons,  this
       filename  will  be  ignored  if it begins with the character `/', `.', `|', or `!', or if it contains the
       character `%'.  We also recommend using a “nmh-storage” profile entry or a <b>-clobber</b> switch setting  other
       than the default of “always” to avoid overwriting existing files.

       If the <b>-auto</b> switch is not given (or is being ignored for security reasons) then <b>mhstore</b> will look in the
       user's  profile  for  a  “formatting  string”  to  determine how the different contents should be stored.
       First, <b>mhstore</b> will look for an entry of the form:

            mhstore-store-&lt;type&gt;/&lt;subtype&gt;

       to determine the formatting string.  If this isn't found, <b>mhstore</b> will look for an entry of the form:

            mhstore-store-&lt;type&gt;

       to determine the formatting string.

       If the formatting string starts with a “+” character, then content is stored  in  the  named  folder.   A
       formatting string consisting solely of a “+” character is interpreted to be the current folder.

       If  the  formatting  string  consists solely of a “-” character, then the content is sent to the standard
       output.

       If the formatting string starts with a `|', then it represents a command for  <b>mhstore</b>  to  execute  which
       should  ultimately  store  the content.  The content will be passed to the standard input of the command.
       Before the command is executed, <b>mhstore</b> will change to the appropriate directory, and any escapes  (given
       below)  in  the  formatting  string  will  be  expanded.  The use of the “%a” sequence is not recommended
       because the user has no control over the Content-Type parameter data.

       Otherwise, the formatting string will represent a pathname  in  which  to  store  the  content.   If  the
       formatting  string  starts  with  a `/', then the content will be stored in the full path given, else the
       file name will be relative to the value of “nmh-storage” or the current working directory.   Any  escapes
       (given  below)  will be expanded, except for the a-escape.  Note that if “nmh-storage” is not an absolute
       path, it will be relative to the folder that contains the message(s).

       A command or pathname formatting string may contain the following escapes.  If the content isn't part  of
       a multipart (of any subtype listed above) content, the p-escapes are ignored.

            %a  Parameters from Content-Type  (only valid with command)
            %m  Insert message number
            %P  Insert part number with leading dot
            %p  Insert part number without leading dot
            %t  Insert content type
            %s  Insert content subtype
            %%  Insert character %

       If  no  formatting  string is found, <b>mhstore</b> will check to see if the content is application/octet-stream
       with parameter “type=tar”.  If so, <b>mhstore</b> will choose an appropriate filename.  If the  content  is  not
       application/octet-stream,  then  <b>mhstore</b>  will  check to see if the content is a message.  If so, <b>mhstore</b>
       will use the value “+”.  As a last resort, <b>mhstore</b> will use the value “%m%P.%s”.

       Example profile entries might be:

            mhstore-store-text: %m%P.txt
            mhstore-store-text: +inbox
            mhstore-store-audio/basic: | raw2audio -e ulaw -s 8000 -c 1 &gt; %m%P.au
            mhstore-store-image/jpeg: %m%P.jpg
            mhstore-store-application/PostScript: %m%P.ps

       The <b>-verbose</b> switch directs <b>mhstore</b> to print out the  names  of  files  that  it  stores.   For  backward
       compatibility, it is the default.  The <b>-noverbose</b> switch suppresses these printouts.

   <b>Overwriting</b> <b>Existing</b> <b>Files</b>
       The  <b>-clobber</b>  switch  controls  whether <b>mhstore</b> should overwrite existing files.  The allowed values for
       this switch and corresponding behavior when <b>mhstore</b> encounters an existing file are:

            always    Overwrite existing file (default)
            auto      Create new file of form name-n.extension
            suffix    Create new file of form name.extension.n
            ask       Prompt the user to specify whether or not to overwrite
                      the existing file
            never     Do not overwrite existing file

       With <u>auto</u> and <u>suffix</u>, <u>n</u> is the lowest unused number, starting from one, in the same form.  If a  filename
       does  not  have an extension (following a `.'), then <u>auto</u> and <u>suffix</u> create a new file of the form <u>name-n</u>
       and <u>name.n</u>, respectively.  With <u>never</u> and <u>ask</u>, the exit status of <b>mhstore</b> will be  the  number  of  files
       that were requested but not stored.

       With  <u>ask</u>,  if  standard  input  is  connected to a terminal, the user is prompted to respond <u>yes</u>, <u>no</u>, or
       <u>rename</u>, to whether the file should be overwritten.  The  responses  can  be  abbreviated.   If  the  user
       responds with <u>rename</u>, then <b>mhstore</b> prompts the user for the name of the new file to be created.  If it is
       a  relative  path name (does not begin with `/'), then it is relative to the current directory.  If it is
       an absolute or relative path to a directory that does not exist, the user will  be  prompted  whether  to
       create the directory.  If standard input is not connected to a terminal, <u>ask</u> behaves the same as <u>always</u>.

   <b>External</b> <b>Access</b>
       For contents of type message/external-body, <u>mhstore</u> supports these access-types:

       •   afs

       •   anon-ftp

       •   ftp

       •   local-file

       •   mail-server

       •   url

       For  the  “anon-ftp”  and  “ftp”  access types, <b>mhstore</b> will look for the “nmh-access-ftp” profile entry,
       e.g.,

            nmh-access-ftp: myftp.sh

       to determine the pathname of a program to perform the FTP retrieval.  This program is invoked with  these
       arguments:

            domain name of FTP-site
            username
            password
            remote directory
            remote filename
            local filename
            “ascii” or “binary”

       The  program  should terminate with an exit status of zero if the retrieval is successful, and a non-zero
       exit status otherwise.

       For the “url” access types, <b>mhstore</b> will look for the “nmh-access-url” profile entry, e.g.,

            nmh-access-url: curl -L

       to determine the program to use to perform  the  HTTP  retrieval.   This  program  is  invoked  with  one
       argument:  the URL of the content to retrieve.  The program should write the content to standard out, and
       should terminate with a status of zero if  the  retrieval  is  successful  and  a  non-zero  exit  status
       otherwise.

   <b>User</b> <b>Environment</b>
       Because  the environment in which <b>mhstore</b> operates may vary for different machines, <b>mhstore</b> will look for
       the environment variable MHSTORE .  If present, this specifies the name of  an  additional  user  profile
       which  should  be  read.   Hence,  when a user logs in on a particular machine, this environment variable
       should be set to refer to a file containing definitions useful for that machine.  Finally,  <b>mhstore</b>  will
       attempt to consult

            /etc/nmh/mhn.defaults

       which is created automatically during <b>nmh</b> installation.

       See  "Profile  Lookup"  in  <u><a href="../man5/mh-profile.5.html">mh-profile</a></u>(5) for the profile search order, and for how duplicate entries are
       treated.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Decoding</b> <b>RFC</b> <b>2047-encoded</b> <b>file</b> <b>names</b>
       The improper RFC 2047 encoding of file name parameters can be replaced with  correct  RFC  2231  encoding
       using <b>mhfixmsg</b>, either permanently or ephemerally, e.g.,

              mhfixmsg -outfile - | mhstore -auto -clobber ask -file -

       The <b>-clobber</b><u>ask</u> is not necessary, though recommended to avoid silently overwriting an existing file.

</pre><h4><b>FILES</b></h4><pre>
       <b>mhstore</b>  looks  for  additional  profile  files  in  multiple  locations: absolute pathnames are accessed
       directly, tilde expansion is done on usernames, and files are searched for in the user's  <u>Mail</u>  directory
       as specified in their profile.  If not found there, the directory “<u>/etc/nmh</u>” is checked.

       $HOME/.mh_profile          The user profile
       $MHSTORE                   Additional profile entries
       /etc/nmh/mhn.defaults      System default MIME profile entries

</pre><h4><b>PROFILE</b> <b>COMPONENTS</b></h4><pre>
       Path:                To determine the user's nmh directory
       Current-Folder:      To find the default current folder
       nmh-access-ftp:      Program to retrieve contents via FTP
       nmh-access-url:      Program to retrieve contents via HTTP
       nmh-storage          Directory to store contents
       mhstore-store-&lt;type&gt;*Template for storing contents

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/mhbuild.1.html">mhbuild</a></u>(1), <u><a href="../man1/mhfixmsg.1.html">mhfixmsg</a></u>(1), <u><a href="../man1/mhlist.1.html">mhlist</a></u>(1), <u><a href="../man1/mhshow.1.html">mhshow</a></u>(1), <u><a href="../man1/sendfiles.1.html">sendfiles</a></u>(1)

</pre><h4><b>DEFAULTS</b></h4><pre>
       `<b>+folder</b>' defaults to the current folder
       `<b>msgs</b>' defaults to cur
       `<b>-noauto</b>'
       `<b>-clobber</b> <b>always</b>'
       `<b>-verbose</b>'

</pre><h4><b>CONTEXT</b></h4><pre>
       If  a  folder  is  given,  it  will become the current folder.  The last message selected will become the
       current message.

</pre><h4><b>BUGS</b></h4><pre>
       Partial messages contained within a multipart content are not reassembled.

nmh-1.8                                            2015-02-06                                       <u><a href="../man1mh/MHSTORE.1mh.html">MHSTORE</a></u>(1mh)
</pre>
 </div>
</div></section>
</div>
</body>
</html>