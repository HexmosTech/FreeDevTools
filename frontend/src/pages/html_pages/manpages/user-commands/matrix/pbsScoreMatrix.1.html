<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pbsScoreMatrix - Generate log-odds score matrices for use in alignment of</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/phast">phast_1.7+dfsg-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pbsScoreMatrix - Generate log-odds score matrices for use in alignment of

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Generate  log-odds  score matrices for use in alignment of probabilistic biological sequences (PBSs).  By
       default, generates a matrix for every branch of the tree (as defined in tree.mod), but can also  generate
       a  matrix  for  a  given  branch  length (see <b>--branch-length</b>).  For a code size of N, an N x N matrix is
       generated by default; <b>--half-pbs</b> will produce an N x 4 matrix, and <b>--no-pbs</b> will produce a 4 x  4  matrix
       (assuming a four-character nucleotide alphabet).

       Two  sequences  are assumed to have evolved from a common ancestor by a reversible continuous-time Markov
       substitution process, and to be separated by a branch of length t.  The conditional probability of a base
       j in one sequence given a base i in the other, P(j | i, t) is given by element (i, j) of the matrix

              P(t) = exp(Qt)

       where Q is the rate  matrix  defining  the  substitution  process,  and  element  (i,  j)  of  Q  is  the
       instantaneous rate at which base i changes to base j.

       Let S_t(i, j) be a log odds score for the alignment of two bases, i and j, based on P(t):

              S_t(i, j) = log P(i, j | t) / (pi(i) * pi(j))

              = log P(j | i, t) pi(i) / (pi(i) * pi(j))

              = log P(j | i, t) / pi(j)                         (1)

       where  pi(x)  is the "equilibrium" or "background" probability of base x.  Because of reversibility, S(i,
       j) = S(j, i), and the S(i, j) form a symmetric 4 x 4 matrix.  This is the matrix  that  is  generated  by
       pbsScoreMatrix  with  the  <b>--no-pbs</b>  option.   If each "letter" in each sequence represents a probability
       distribution over bases, as in a PBS, then the score for two letters k and l can be shown to be

              S'_t(k, l) = log sum_i sum_j p_k(i) p_l(j) exp S_t(i, j) (2)

       where the two sums are over the four bases, p_k(i) is the probability of base i  under  the  distribution
       for k, and p_l(j) is the probability of base j under the distribution for l.

       Notice  that  (2)  reduces  to  (1) when p_k(i) = p_l(j) = 1 for some i and j and for all other i' and j'
       p_k(i') = p_l(j') = 0 (i.e., when all of the probability mass is on a single base in  both  distributions
       and  the PBS reduces to an ordinary nucleotide sequence).  The special case of p_l(j) = 1 only is also of
       interest when aligning a PBS and a nucleotide sequence:

              S''_t(k, j) = log sum_i p_k(i) exp S_t(i, j) (3)

       This is the matrix generated by pbsScoreMatrix with the <b>--half-pbs</b> option.  Note: all logs are base 2.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Generate an N x N matrix for every branch of the tree, using a code file "code" (generated  by  pbsTrain)
       and a tree model file "mytree.mod" (generated by phyloFit):

              pbsScoreMatrix mytree.mod code &gt; matrices.dat

       Generate an N x N matrix for a branch length of 0.2 expected substitutions per site.

              pbsScoreMatrix <b>--branch-length</b> 0.2 mytree.mod code &gt; matrix.dat

       Generate an N x 4 matrix:

              pbsScoreMatrix <b>--branch-length</b> 0.2 <b>--half-pbs</b> mytree.mod code &gt; matrix.dat

       Generate a 4 x 4 matrix:

              pbsScoreMatrix <b>--branch-length</b> 0.2 <b>--no-pbs</b> code mytree.mod &gt; matrix.dat

       (In this case, a code file is not needed.)

</pre><h4><b>OPTIONS</b></h4><pre>

       <b>--branch-length</b>, <b>-t</b> &lt;length&gt;

              Output a matrix for a branch of the specified length, rather than a matrix for every branch of the
              tree.  The given length must be non-negative and in units of expected substitutions per site.

       <b>--half-pbs</b>, <b>-H</b>

              Output an N x 4 matrix, as described above.

       <b>--no-pbs</b>, <b>-N</b> Output a 4 x 4 matrix, as described above.  With this option, a code file is not needed.

       <b>--help</b>, <b>-h</b>

              Show this help message.

pbsScoreMatrix 1.4                                  May 2016                                   <u><a href="../man1/PBSSCOREMATRIX.1.html">PBSSCOREMATRIX</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>