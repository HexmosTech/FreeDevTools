<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>borg-prune - Prune repository archives according to specified rules</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/borgbackup">borgbackup_1.2.0-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       borg-prune - Prune repository archives according to specified rules

</pre><h4><b>SYNOPSIS</b></h4><pre>
       borg [common options] prune [options] [REPOSITORY]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  prune  command  prunes  a  repository  by  deleting  all  archives not matching any of the specified
       retention options.

       Important: Repository disk space is <b>not</b> freed until you run <b>borg</b> <b>compact</b>.

       This command is normally used by automated backup scripts wanting to keep a certain  number  of  historic
       backups.  This  retention  policy is commonly referred to as <u>GFS</u> (Grandfather-father-son) backup rotation
       scheme.

       Also, prune automatically removes checkpoint archives (incomplete archives  left  behind  by  interrupted
       backup  runs) except if the checkpoint is the latest archive (and thus still needed). Checkpoint archives
       are not considered when comparing archive counts against the retention limits (<b>--keep-X</b>).

       If a prefix is set with -P, then only archives that start with the prefix are considered for deletion and
       only those archives count towards the totals specified by the rules.   Otherwise,  <u>all</u>  archives  in  the
       repository  are candidates for deletion!  There is no automatic distinction between archives representing
       different contents. These need to be distinguished by specifying matching prefixes.

       If you have multiple sequences of archives with different data sets (e.g.  from  different  machines)  in
       one  shared  repository,  use one prune call per data set that matches only the respective archives using
       the -P option.

       The <b>--keep-within</b> option takes an argument of the form "&lt;int&gt;&lt;char&gt;", where char is "H", "d",  "w",  "m",
       "y". For example, <b>--keep-within</b> <b>2d</b> means to keep all archives that were created within the past 48 hours.
       "1m" is taken to mean "31d". The archives kept with this option do not count towards the totals specified
       by any other options.

       A  good procedure is to thin out more and more the older your backups get.  As an example, <b>--keep-daily</b> <b>7</b>
       means to keep the latest backup on each day, up to 7 most recent days with backups (days without  backups
       do  not count).  The rules are applied from secondly to yearly, and backups selected by previous rules do
       not count towards those of later rules. The time that each backup starts is used  for  pruning  purposes.
       Dates  and  times are interpreted in the local timezone, and weeks go from Monday to Sunday. Specifying a
       negative number of archives to keep means that there is no limit. As of borg 1.2.0, borg will retain  the
       oldest  archive if any of the secondly, minutely, hourly, daily, weekly, monthly, or yearly rules was not
       otherwise able to meet its retention target. This enables the first  chronological  archive  to  continue
       aging until it is replaced by a newer archive that meets the retention criteria.

       The  <b>--keep-last</b>  <b>N</b>  option  is doing the same as <b>--keep-secondly</b> <b>N</b> (and it will keep the last N archives
       under the assumption that you do not create more than one backup archive in the same second).

       When using <b>--stats</b>, you will get some statistics about how much data was deleted  -  the  "Deleted  data"
       deduplicated size there is most interesting as that is how much your repository will shrink.  Please note
       that the "All archives" stats refer to the state after pruning.

</pre><h4><b>OPTIONS</b></h4><pre>
       See <u><a href="../man1/borg-common.1.html">borg-common</a>(1)</u> for common options of Borg commands.

   <b>arguments</b>
       <b>REPOSITORY</b>
              repository to prune

   <b>optional</b> <b>arguments</b>
       <b>-n</b>, <b>--dry-run</b>
              do not change repository

       <b>--force</b>
              force pruning of corrupted archives, use <b>--force</b> <b>--force</b> in case <b>--force</b> does not work.

       <b>-s</b>, <b>--stats</b>
              print statistics for the deleted archive

       <b>--list</b> output verbose list of archives it keeps/prunes

       <b>--keep-within</b> <u>INTERVAL</u>
              keep all archives within this time interval

       <b>--keep-last</b>, <b>--keep-secondly</b>
              number of secondly archives to keep

       <b>--keep-minutely</b>
              number of minutely archives to keep

       <b>-H</b>, <b>--keep-hourly</b>
              number of hourly archives to keep

       <b>-d</b>, <b>--keep-daily</b>
              number of daily archives to keep

       <b>-w</b>, <b>--keep-weekly</b>
              number of weekly archives to keep

       <b>-m</b>, <b>--keep-monthly</b>
              number of monthly archives to keep

       <b>-y</b>, <b>--keep-yearly</b>
              number of yearly archives to keep

       <b>--save-space</b>
              work slower, but using less space

   <b>Archive</b> <b>filters</b>
       <b>-P</b> <u>PREFIX</u>, <b>--prefix</b> <u>PREFIX</u>
              only consider archive names starting with this prefix.

       <b>-a</b> <u>GLOB</u>, <b>--glob-archives</b> <u>GLOB</u>
              only consider archive names matching the glob. sh: rules apply, see "borg help patterns". <b>--prefix</b>
              and <b>--glob-archives</b> are mutually exclusive.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Be careful, prune is a potentially dangerous command, it will remove backup archives.

       The default of prune is to apply to <b>all</b> <b>archives</b> <b>in</b> <b>the</b> <b>repository</b> unless you restrict its operation to a
       subset of the archives using <b>--prefix</b>.  When using <b>--prefix</b>, be careful to choose a good prefix - e.g. do
       not use a prefix "foo" if you do not also want to match "foobar".

       It  is  strongly  recommended  to always run <b>prune</b> <b>-v</b> <b>--list</b> <b>--dry-run</b> <b>...</b>  first so you will see what it
       would do without it actually doing anything.

          # Keep 7 end of day and 4 additional end of week archives.
          # Do a dry-run without actually deleting anything.
          $ borg prune -v --list --dry-run --keep-daily=7 --keep-weekly=4 /path/to/repo

          # Same as above but only apply to archive names starting with the hostname
          # of the machine followed by a "-" character:
          $ borg prune -v --list --keep-daily=7 --keep-weekly=4 --prefix='{hostname}-' /path/to/repo
          # actually free disk space:
          $ borg compact /path/to/repo

          # Keep 7 end of day, 4 additional end of week archives,
          # and an end of month archive for every month:
          $ borg prune -v --list --keep-daily=7 --keep-weekly=4 --keep-monthly=-1 /path/to/repo

          # Keep all backups in the last 10 days, 4 additional end of week archives,
          # and an end of month archive for every month:
          $ borg prune -v --list --keep-within=10d --keep-weekly=4 --keep-monthly=-1 /path/to/repo

       There is also a visualized prune example in <b>docs/misc/prune-example.txt</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/borg-common.1.html">borg-common</a>(1)</u>, <u><a href="../man1/borg-compact.1.html">borg-compact</a>(1)</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       The Borg Collective

                                                   2022-02-19                                      <u><a href="../man1/BORG-PRUNE.1.html">BORG-PRUNE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>