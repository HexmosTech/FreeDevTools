<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>borg-prune - Prune repository archives according to specified rules</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/borgbackup2">borgbackup2_2.0.0b14-3build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       borg-prune - Prune repository archives according to specified rules

</pre><h4><b>SYNOPSIS</b></h4><pre>
       borg [common options] prune [options] [NAME]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  prune  command  prunes  a repository by soft-deleting all archives not matching any of the specified
       retention options.

       Important:

       • The prune command will only mark archives for deletion ("soft-deletion"), repository disk space is  <b>not</b>
         freed until you run <b>borg</b> <b>compact</b>.

       • You can use <b>borg</b> <b>undelete</b> to undelete archives, but only until you run <b>borg</b> <b>compact</b>.

       This  command  is  normally used by automated backup scripts wanting to keep a certain number of historic
       backups.     This      retention      policy      is      commonly      referred      to      as      GFS
       &lt;https://en.wikipedia.org/wiki/Backup_rotation_scheme#Grandfather-father-son&gt;

       (Grandfather-father-son) backup rotation scheme.

       The recommended way to use prune is to give the archive series name to it via the NAME argument (assuming
       you  have  the same name for all archives in a series).  Alternatively, you can also use --match-archives
       (-a), then only archives that match the pattern are considered for deletion and only those archives count
       towards the totals specified by the rules.  Otherwise, <u>all</u> archives in the repository are candidates  for
       deletion!  There is no automatic distinction between archives representing different contents. These need
       to be distinguished by specifying matching globs.

       If  you  have multiple series of archives with different data sets (e.g.  from different machines) in one
       shared repository, use one prune call per series.

       The <b>--keep-within</b> option takes an argument of the form "&lt;int&gt;&lt;char&gt;", where char is "H", "d",  "w",  "m",
       "y". For example, <b>--keep-within</b> <b>2d</b> means to keep all archives that were created within the past 48 hours.
       "1m" is taken to mean "31d". The archives kept with this option do not count towards the totals specified
       by any other options.

       A  good procedure is to thin out more and more the older your backups get.  As an example, <b>--keep-daily</b> <b>7</b>
       means to keep the latest backup on each day, up to 7 most recent days with backups (days without  backups
       do  not count).  The rules are applied from secondly to yearly, and backups selected by previous rules do
       not count towards those of later rules. The time that each backup starts is used  for  pruning  purposes.
       Dates  and  times are interpreted in the local timezone of the system where borg prune runs, and weeks go
       from Monday to Sunday.  Specifying a negative number of archives to keep means that there is no limit.

       Borg will retain the oldest archive if any of the secondly, minutely,  hourly,  daily,  weekly,  monthly,
       quarterly,  or  yearly  rules was not otherwise able to meet its retention target. This enables the first
       chronological archive to continue aging until it is replaced by a newer archive that meets the  retention
       criteria.

       The  <b>--keep-13weekly</b>  and  <b>--keep-3monthly</b>  rules are two different strategies for keeping archives every
       quarter year.

       The <b>--keep-last</b> <b>N</b> option is doing the same as <b>--keep-secondly</b> <b>N</b> (and it will keep  the  last  N  archives
       under the assumption that you do not create more than one backup archive in the same second).

       You can influence how the <b>--list</b> output is formatted by using the <b>--short</b> option (less wide output) or by
       giving  a  custom  format  using  <b>--format</b> (see the <b>borg</b> <b>repo-list</b> description for more details about the
       format string).

</pre><h4><b>OPTIONS</b></h4><pre>
       See <u><a href="../man1/borg-common.1.html">borg-common</a>(1)</u> for common options of Borg commands.

   <b>arguments</b>
       <b>NAME</b>   specify the archive name

   <b>options</b>
       <b>-n</b>, <b>--dry-run</b>
              do not change repository

       <b>--list</b> output verbose list of archives it keeps/prunes

       <b>--short</b>
              use a less wide archive part format

       <b>--list-pruned</b>
              output verbose list of archives it prunes

       <b>--list-kept</b>
              output verbose list of archives it keeps

       <b>--format</b> <u>FORMAT</u>
              specify format for the archive part (default: "{archive:&lt;36} {time} [{id}]")

       <b>--keep-within</b> <u>INTERVAL</u>
              keep all archives within this time interval

       <b>--keep-last</b>, <b>--keep-secondly</b>
              number of secondly archives to keep

       <b>--keep-minutely</b>
              number of minutely archives to keep

       <b>-H</b>, <b>--keep-hourly</b>
              number of hourly archives to keep

       <b>-d</b>, <b>--keep-daily</b>
              number of daily archives to keep

       <b>-w</b>, <b>--keep-weekly</b>
              number of weekly archives to keep

       <b>-m</b>, <b>--keep-monthly</b>
              number of monthly archives to keep

       <b>--keep-13weekly</b>
              number of quarterly archives to keep (13 week strategy)

       <b>--keep-3monthly</b>
              number of quarterly archives to keep (3 month strategy)

       <b>-y</b>, <b>--keep-yearly</b>
              number of yearly archives to keep

   <b>Archive</b> <b>filters</b>
       <b>-a</b> <u>PATTERN</u>, <b>--match-archives</b> <u>PATTERN</u>
              only consider archives matching all patterns. see "borg help match-archives".

       <b>--oldest</b> <u>TIMESPAN</u>
              consider archives between the oldest archive's timestamp and (oldest + TIMESPAN), e.g. 7d or 12m.

       <b>--newest</b> <u>TIMESPAN</u>
              consider archives between the newest archive's timestamp and (newest - TIMESPAN), e.g. 7d or 12m.

       <b>--older</b> <u>TIMESPAN</u>
              consider archives older than (now - TIMESPAN), e.g. 7d or 12m.

       <b>--newer</b> <u>TIMESPAN</u>
              consider archives newer than (now - TIMESPAN), e.g. 7d or 12m.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Be careful, prune is a potentially dangerous command, it will remove backup archives.

       The default of prune is to apply to <b>all</b> <b>archives</b> <b>in</b> <b>the</b> <b>repository</b> unless you restrict its operation to a
       subset of the archives.

       The recommended way to name archives (with <b>borg</b> <b>create</b>) is to use the identical  archive  name  within  a
       series  of archives. Then you can simply give that name to prune also, so it operates just on that series
       of archives.

       Alternatively, you can use <b>-a</b> / <b>--match-archives</b> to do a match on the archive names  to  select  some  of
       them.   When using <b>-a</b>, be careful to choose a good pattern - e.g. do not use a prefix "foo" if you do not
       also want to match "foobar".

       It is strongly recommended to always run <b>prune</b> <b>-v</b> <b>--list</b> <b>--dry-run</b> <b>...</b>  first so you  will  see  what  it
       would do without it actually doing anything.

       Don't forget to run <b>borg</b> <b>compact</b> <b>-v</b> after prune to actually free disk space.

          # Keep 7 end of day and 4 additional end of week archives.
          # Do a dry-run without actually deleting anything.
          $ borg prune -v --list --dry-run --keep-daily=7 --keep-weekly=4

          # Similar as above but only apply to the archive series named '{hostname}':
          $ borg prune -v --list --keep-daily=7 --keep-weekly=4 '{hostname}'

          # Similar as above but apply to archive names starting with the hostname
          # of the machine followed by a "-" character:
          $ borg prune -v --list --keep-daily=7 --keep-weekly=4 -a 'sh:{hostname}-*'

          # Keep 7 end of day, 4 additional end of week archives,
          # and an end of month archive for every month:
          $ borg prune -v --list --keep-daily=7 --keep-weekly=4 --keep-monthly=-1

          # Keep all backups in the last 10 days, 4 additional end of week archives,
          # and an end of month archive for every month:
          $ borg prune -v --list --keep-within=10d --keep-weekly=4 --keep-monthly=-1

       There is also a visualized prune example in <b>docs/misc/prune-example.txt</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/borg-common.1.html">borg-common</a>(1)</u>, <u><a href="../man1/borg-compact.1.html">borg-compact</a>(1)</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       The Borg Collective

                                                   2025-01-03                                      <u><a href="../man1/BORG-PRUNE.1.html">BORG-PRUNE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>