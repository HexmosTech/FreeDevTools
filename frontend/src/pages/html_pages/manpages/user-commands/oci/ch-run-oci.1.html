<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ch-run-oci - OCI wrapper for "ch-run"</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/charliecloud-runtime">charliecloud-runtime_0.38-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ch-run-oci - OCI wrapper for "ch-run"

</pre><h4><b>SYNOPSIS</b></h4><pre>
          $ ch-run-oci OPERATION [ARG ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>NOTE:</b>
          This  command is experimental. Features may be incomplete and/or buggy. The quality of code is not yet
          up to the usual Charliecloud standards, and error handling is poor. Please report any issues you find,
          so we can fix them!

       Open Containers Initiative (OCI) wrapper for <b><a href="../man1/ch-run.1.html">ch-run</a>(1)</b>. You probably  don’t  want  to  run  this  command
       directly;  it  is intended to interface with other software that expects an OCI runtime. The current goal
       is to support completely unprivileged image building  (e.g.  <b>buildah</b>  <b>--runtime=ch-run-oci</b>)  rather  than
       general OCI container running.

       <u>Support</u>  <u>of</u>  <u>the</u>  <u>OCI</u>  <u>runtime</u>  <u>specification</u>  <u>is</u>  <u>only</u>  <u>partial.</u> This is for two reasons. First, it’s an
       experimental  and  incomplete  feature.  More  importantly,  the  philosophy  and  goals  of  OCI  differ
       significantly from those of Charliecloud. Key differences include:

          • OCI is designed to run services, while Charliecloud is designed to run scientific applications.

          • OCI  containers  are  persistent  things with a complex lifecycle, while Charliecloud containers are
            simply UNIX processes.

          • OCI expects support for a variety of namespaces, while Charliecloud supports user and mount, no more
            and no less.

          • OCI expects runtimes to maintain a supervisor process in addition to  user  processes;  Charliecloud
            has no need for this.

          • OCI  expects runtimes to maintain state throughout the container lifecycle in a location independent
            from the caller.

       For these reasons, <b>ch-run-oci</b> is a bit of a kludge, and much of what it does is  provide  scaffolding  to
       satisfy OCI requirements.

       Which  OCI  features  are  and  are not supported is provided in the rest of this man page, and technical
       analysis and discussion are in the Contributor’s Guide.

       This command supports OCI version 1.0.0 only and fails with an error if other versions are offered.

</pre><h4><b>OPERATIONS</b></h4><pre>
       All OCI operations are accepted, but some are no-ops or merely scaffolding to  satisfy  the  caller.  For
       comparison, see also:

       • <u>OCI</u> <u>runtime</u> <u>and</u> <u>lifecycle</u> <u>spec</u>

       • The <u>runc</u> <u>man</u> <u>pages</u>

   <b>create</b>
          $ ch-run-oci create --bundle DIR --pid-file FILE [--no-new-keyring] CONTAINER_ID

       Create  a  container. Charliecloud does not have separate create and start phases, so this operation only
       sets up OCI-related scaffolding.

       Arguments:

          <b>--bundle</b> <b>DIR</b>
                 Directory  containing  the  OCI  bundle.  This  must  be  <b>/tmp/buildahYYY</b>,  where  <b>YYY</b>  matches
                 <b>CONTAINER_ID</b> below.

          <b>--pid-file</b> <b>FILE</b>
                 Filename to write the “container” process PID to. Note that for Charliecloud, the process given
                 is fake; see above. This must be <b>DIR/pid</b>, where <b>DIR</b> is given by <b>--bundle</b>.

          <b>--no-new-keyring</b>
                 Ignored. (Charliecloud does not implement session keyrings.)

          <b>CONTAINER_ID</b>
                 String  to  use  as  the  container  ID. This must be <b>buildah-buildahYYY</b>, where <b>YYY</b> matches <b>DIR</b>
                 above.

       Unsupported arguments:

          <b>--console-socket</b> <b>PATH</b>
                 UNIX  socket  to  pass  pseudoterminal  file  descriptor.   Charliecloud   does   not   support
                 pseudoterminals;  fail with an error if this argument is given. For Buildah, redirect its input
                 from <b>/dev/null</b> to prevent it from requesting a pseudoterminal.

   <b>delete</b>
          $ ch-run-oci delete CONTAINER_ID

       Clean up the OCI-related scaffolding for specified container.

   <b>kill</b>
          $ ch-run-oci kill CONTAINER_ID

       No-op.

   <b>start</b>
          $ ch-run-oci start CONTAINER_ID

       Eexecute the user command specified at create time in a Charliecloud container.

   <b>state</b>
          $ ch-run-oci state CONTAINER_ID

       Print the state of the given container on standard output as an OCI compliant JSON document.

</pre><h4><b>UNSUPPORTED</b> <b>OCI</b> <b>FEATURES</b></h4><pre>
       As noted above, various OCI features are not supported by Charliecloud. We  have  tried  to  guess  which
       features would be essential to callers; <b>ch-run-oci</b> fails with an error if these are requested. Otherwise,
       the request is simply ignored.

       We are interested in hearing about scientific-computing use cases for unsupported features, so we can add
       support for things that are needed.

       Our  goal  is  for  this man page to be comprehensive: every OCI runtime feature should either work or be
       listed as unsupported.

       Unsupported features that are an error:

          • Pseudoterminals

          • Hooks (prestart, poststart, and prestop)

          • Annotations

          • Joining existing namespaces

          • Intel Resource Director Technology (RDT)

       Unsupported features that are ignored:

          • Mounts other than the root filesystem

          • User/group mappings beyond one user mapped to EUID and one group mapped to EGID

          • Disabling <b>prctl(PR_SET_NO_NEW_PRIVS)</b>

          • Root filesystem propagation mode

          • <b>sysctl</b> directives

          • masked and read-only paths (remaining unprivileged protects you)

          • Capabilities

          • rlimits

          • Devices (all devices are inherited from the host)

          • cgroups

          • seccomp

          • SELinux

          • AppArmor

          • Container hostname setting

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       <b>CH_LOG_FILE</b>
              If set, append log chatter to this file, rather than standard error. This is useful for  debugging
              situations where standard error is consumed or lost.

              Also sets verbose mode if not already set (equivalent to <b>--verbose</b>).

       <b>CH_LOG_FESTOON</b>
              If set, prepend PID and timestamp to logged chatter.

       <b>CH_XATTRS</b>
              If set, save xattrs in the build cache and restore them when rebuilding from the cache (equivalent
              to <b>--xattrs</b>).

       <b>CH_RUN_OCI_HANG</b>
          If  set  to the name of a command (e.g., <b>create</b>), sleep indefinitely when that command is invoked. The
          purpose here is to halt a build so it can be examined and debugged.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       If Charliecloud was obtained  from  your  Linux  distribution,  use  your  distribution’s  bug  reporting
       procedures.

       Otherwise, report bugs to: <u>https://github.com/hpc/charliecloud/issues</u>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man7/charliecloud.7.html">charliecloud</a>(7)

       Full documentation at: &lt;<u>https://hpc.github.io/charliecloud</u>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2014–2023, Triad National Security, LLC and others

0.38                                          2024-11-23 16:04 UTC                                 <u><a href="../man1/CH-RUN-OCI.1.html">CH-RUN-OCI</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>