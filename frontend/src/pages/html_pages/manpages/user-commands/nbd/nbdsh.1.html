<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbdsh - network block device (NBD) shell</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/python3-libnbd">python3-libnbd_1.22.0-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nbdsh - network block device (NBD) shell

</pre><h4><b>SYNOPSIS</b></h4><pre>
        $ nbdsh

        Welcome to nbdsh, the shell for interacting with
        Network Block Device (NBD) servers.

        The ‘nbd’ module has already been imported and there
        is an open NBD handle called ‘h’.

        nbd&gt; h.connect_command(["nbdkit", "-s", "memory", "1G"])
        nbd&gt; h.get_size()
        1073741824
        nbd&gt; buf = b"hello, world"
        nbd&gt; h.pwrite(buf, 0)
        nbd&gt; exit()

</pre><h4><b>DESCRIPTION</b></h4><pre>
       nbdsh is a Python-based client shell for accessing Network Block Device (NBD) servers.

       For documentation about the libnbd API please open the shell and type:

        help(nbd)

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Print</b> <b>the</b> <b>size</b> <b>of</b> <b>an</b> <b>NBD</b> <b>export</b>
       The <u>-u</u> option connects to an NBD URI.  The <u>-c</u> option lets you execute single Python statements from the
       command line.  Combining these two options lets you print the size in bytes of an NBD export:

        $ nbdsh -u nbd://localhost -c 'print(h.get_size())'
        1073741824

   <b>Hexdump</b> <b>the</b> <b>boot</b> <b>sector</b> <b>of</b> <b>an</b> <b>NBD</b> <b>export</b>
       Using <u>-c</u> <u>-</u> you can feed a whole Python program to the standard input of nbdsh:

        nbdsh -c - &lt;&lt;'EOF'
        from subprocess import *

        h.connect_uri("nbd://localhost")
        bootsect = h.pread(512, 0)
        p = Popen("hexdump -C", shell=True, stdin=PIPE)
        p.stdin.write(bootsect)
        EOF

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-h</b>
       <b>--help</b>
           Display brief command line help and exit.

       <b>--base-allocation</b>
           Request  the  use  of  the "base:allocation" meta context, which is the most common context used with
           <b><a href="../man3/nbd_block_status_64.3.html">nbd_block_status_64</a></b>(3).           This          is          equivalent           to           calling
           "h.set_meta_context(nbd.CONTEXT_BASE_ALLOCATION)"  in  the  shell prior to connecting, and works even
           when combined with "--uri" (while attempting the same with "-c" would be too late).

       <b>-c</b> 'COMMAND ...'
       <b>--command</b> 'COMMAND ...'
           Instead of starting an interactive shell, run a command.  This option can be specified multiple times
           in order to run multiple commands.

       <b>-c</b> <b>-</b>
       <b>--command</b> <b>-</b>
           Read standard input and execute it as a command.

       <b>-n</b>  Do not create the implicit handle "h".

       <b>--opt-mode</b>
           Request that option mode be enabled, which gives fine-grained control over option  negotiation  after
           initially  contacting  the  server  but  prior  to  actually using the export.  This is equivalent to
           calling "h.set_opt_mode(True)" in the shell prior to connecting, and works even  when  combined  with
           "--uri" (while attempting the same with "-c" would be too late).

       <b>-u</b> URI
       <b>--uri</b> URI
           Connect to the given NBD URI.  This is equivalent to the "h.connect_uri(URI)" command in the shell.

           Note  that the connection is created prior to processing any "-c" commands, which prevents the use of
           configuration commands such as "h.add_meta_context("NAME")" from the command  line  when  mixed  with
           this  option.   The  options  "--opt-mode" and "--base-allocation" can be used to make this situation
           easier to manage.

       <b>-v</b>
       <b>--verbose</b>
           Enable verbose libnbd messages.  This has  the  same  effect  as  setting  the  environment  variable
           "LIBNBD_DEBUG=1"

       <b>-V</b>
       <b>--version</b>
           Display the package name and version and exit.

</pre><h4><b>NOTES</b></h4><pre>
   <b>nbdsh</b> <b>examples</b>
       There  are  some  example  nbdsh  scripts  in  the  libnbd  source  repository  under  <u>sh/examples</u> or see
       https://gitlab.com/nbdkit/libnbd/tree/master/sh/examples.

   <b>Using</b> <b>libnbd</b> <b>directly</b> <b>from</b> <b>Python</b>
       nbdsh is convenient for command line scripting, but you do not have to use it.  Instead you can write  an
       ordinary Python program or module which imports the "nbd" module:

        #!<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?python3">/usr/bin/python3</a>
        import nbd
        h = nbd.NBD()
        h.connect_uri("nbd://localhost")

       There  are  some  example  Python  scripts  in  the libnbd source repository under <u>python/examples</u> or see
       https://gitlab.com/nbdkit/libnbd/tree/master/python/examples.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3), <b><a href="../man3/libnbd-security.3.html">libnbd-security</a></b>(3), <b><a href="../man1/nbdcopy.1.html">nbdcopy</a></b>(1), <b><a href="../man1/nbddump.1.html">nbddump</a></b>(1), <b><a href="../man1/nbdfuse.1.html">nbdfuse</a></b>(1), <b><a href="../man1/nbdublk.1.html">nbdublk</a></b>(1), <b><a href="../man1/nbdinfo.1.html">nbdinfo</a></b>(1), <b><a href="../man1/qemu-img.1.html">qemu-img</a></b>(1).

</pre><h4><b>AUTHORS</b></h4><pre>
       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
       General Public License as published by the Free Software Foundation; either version 2 of the License,  or
       (at your option) any later version.

       This  library  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser  General
       Public License for more details.

       You should have received a copy of the GNU Lesser General Public License along with this library; if not,
       write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA

libnbd-1.22.0                                      2025-02-12                                           <u><a href="../man1/nbdsh.1.html">nbdsh</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>