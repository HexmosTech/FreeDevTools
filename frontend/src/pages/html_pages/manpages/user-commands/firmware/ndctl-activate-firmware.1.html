<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ndctl-activate-firmware - activate staged firmware on memory devices</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/ndctl">ndctl_77-2.2ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ndctl-activate-firmware - activate staged firmware on memory devices

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <u>ndctl</u> <u>activate-firmware</u> [&lt;bus-id&gt; &lt;bus-id2&gt; ... &lt;bus-idN&gt;] [&lt;options&gt;]

       Some persistent memory devices run a firmware locally on the device / "DIMM" to perform tasks like media
       management, capacity provisioning, and health monitoring. The process of updating that firmware typically
       involves a reboot because it has implications for in-flight memory transactions. However, reboots can be
       costly for systems that can not tolerate extended downtime.

       The kernel detects platforms that expose support for runtime-firmware-activation (FWA). The <u>ndctl</u>
       <u>update-firmware</u> stages new firmware binaries, but if the platform supports FWA it will additionally arm
       the devices for activation. Then <u>ndctl</u> <u>activate-firmware</u> may attempt to activate the firmware live.
       However, if the platform indicates that the memory controller will be taken off-line for the duration of
       the update "activate_method == suspend" then the default policy for firmware activation is to inject a
       truncated hibernate cycle to freeze devices and applications before the hard quiesce is injected by the
       platform, and then resume the system.

       <b>DANGER</b> the activate-firmware command includes a --force option to tell the driver bypass the hibernation
       cycle and perform the update "live". I.e. it arranges for applications and devices to race the platform
       injected quiesce period. This option should only be used explicit knowledge that the platform quiesce
       time will not trigger completion timeout violations for any devices in the system.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Check for any buses that support activation without triggering an activation:

           # ndctl activate-firmware all --dry-run
           ACPI.NFIT: ndbus1: has no devices that support firmware update.
           nfit_test.1: ndbus3: has no devices that support firmware update.
           e820: ndbus0: has no devices that support firmware update.
           [
             {
               "provider":"nfit_test.0",
               "dev":"ndbus1",
               "scrub_state":"idle",
               "firmware":{
                 "activate_method":"suspend",
                 "activate_state":"idle"
               },
               "dimms":[
                 {
           ...

       Check that a specific bus supports activation without performing an activation:

           # ndctl activate-firmware nfit_test.0 --dry-run --force
           [
             {
               "provider":"nfit_test.0",
               "dev":"ndbus2",
               "scrub_state":"idle",
               "firmware":{
                 "activate_method":"suspend",
                 "activate_state":"idle"
               },
               "dimms":[
           ...
           ]

       The result is equivalent to <u>ndctl</u> <u>list</u> <u>-BFDu</u> upon successful activation.

       The <u>ndctl</u> <u>list</u> command can also enumerate the default activation method:

           # ndctl list -b nfit_test.0 -BF
           [
             {
               "provider":"nfit_test.0",
               "dev":"ndbus2",
               "scrub_state":"idle",
               "firmware":{
                 "activate_method":"suspend",
                 "activate_state":"idle"
               }
             }
           ]

</pre><h4><b>OPTIONS</b></h4><pre>
       -n, --dry-run
           Perform all actions related to activation including honoring --idle and --force, but skip the final
           execution of the activation. The overrides are undone before the command completes. Any failed
           overrides will be reported as error messages.

       -I, --idle
           Implied by default, this option controls whether the platform will attempt to increase the completion
           timeout of all devices in the system and validate that the max completion timeout satisfies the time
           needed to perform the activation. This validation step can be overridden by specifying --no-idle.

       -f, --force
           The activation method defaults to the reported "bus.firmware.activate_method" property. When the
           method is "live" then this --force option is ignored. When the method is "reset" no runtime
           activation is attempted. When the method is "suspend" this option indicates to the driver to bypass
           the hibernate cycle to activate firmware. in the bus When the reported "activate_method" is "suspend"
           the kernel driver may support overriding the suspend requirement and instead issue the
           firmware-activation live. <b>CAUTION</b> this may lead to undefined system behavior if device completion
           timeouts are violated for in-flight memory operations.

       -v, --verbose
           Emit debug messages for the firmware activation procedure

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Â© 2016 - 2022, Intel Corporation. License GPLv2: GNU GPL version 2
       <a href="http://gnu.org/licenses/gpl.html">http://gnu.org/licenses/gpl.html</a>. This is free software: you are free to change and redistribute it.
       There is NO WARRANTY, to the extent permitted by law.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/ndctl-update-firmware.1.html">ndctl-update-firmware</a>(1), Intel Optane PMem DSM Interface
       &lt;https://pmem.io/documents/IntelOptanePMem_DSM_Interface-V2.0.pdf&gt;

ndctl                                              2024-11-01                         <u><a href="../man1/NDCTL-ACTIVATE-FIRMWARE.1.html">NDCTL-ACTIVATE-FIRMWARE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>