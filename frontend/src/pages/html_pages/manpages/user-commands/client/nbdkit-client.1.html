<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbdkit-client - how to mount NBD filesystems on a client machine</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nbdkit">nbdkit_1.42.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nbdkit-client - how to mount NBD filesystems on a client machine

</pre><h4><b>DESCRIPTION</b></h4><pre>
       For NBD exports that contain filesystems there are several approaches to mounting them on a client
       machine.

       To ensure the nbd kernel module is loaded you may need to do:

        # echo nbd &gt; /etc/modules-load.d/nbd.conf

       This will not take effect until you reboot, so also do:

        # modprobe nbd

   <b>Easy</b> <b>mounting</b> <b>at</b> <b>boot</b> <b>time</b>
       For simple setups the following method is the easiest way to get an NBD filesystem to mount at boot.
       Create or edit <u>/etc/rc.local</u> or <u>/etc/rc.d/rc.local</u>:

        #!<a href="file:/bin/sh">/bin/sh</a> -
        nm-online
        modprobe nbd
        nbd-client server /dev/nbd0
        mount /dev/nbd0 <a href="file:/mnt">/mnt</a>

   <b>Mounting</b> <b>using</b> <b>systemd</b> <b>mount</b> <b>points</b>
       You can use systemd mount points to mount NBD filesystems at boot and/or on demand.

       Set up an <b><a href="../man5/nbdtab.5.html">nbdtab</a></b>(5) mapping.  If <u>/etc/nbdtab</u> doesn't exist, then create it first.  Add this line:

        nbd0 server / bs=512,persist

       As a workaround for https://github.com/NetworkBlockDevice/nbd/issues/91 you must currently modify the
       <u>nbd@.service</u> file:

        # cp /usr/lib/systemd/system/nbd@.service <a href="file:/etc/systemd/system/">/etc/systemd/system/</a>
        # vi /etc/systemd/system/nbd@.service

       and edit or create these settings in the "[Service]" section:

        [Service]
        Type=oneshot
        RemainAfterExit=yes
        ExecStart=/usr/sbin/nbd-client %i
        ExecStop=/usr/sbin/nbd-client -d <a href="file:/dev/">/dev/</a>%i

       Finally create a systemd mount file called <u>/etc/systemd/system/mnt.mount</u>:

        [Unit]
        Requires=<a href="mailto:nbd@nbd0.service">nbd@nbd0.service</a>
        [Mount]
        What=/dev/nbd0
        Where=<a href="file:/mnt">/mnt</a>
        Type=ext4

       You can either reboot now or do:

        # systemctl start mnt.mount

       Other systemd services which need this mount point can depend on this mount unit.

</pre><h4><b>LIMITATIONS</b></h4><pre>
       Red Hat Enterprise Linux 8 enabled the "nbd.ko" Linux kernel module but only for Unix domain sockets (ie.
       local connections).  This means you cannot connect to an NBD server over a TCP network.  This also
       affects Linux distributions derived from RHEL like CentOS, Alma and others.

       This does not affect use of nbdkit as an NBD server, only the Linux kernel as an NBD client.  Userspace
       Linux clients such as <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3) tools will work.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1), <b><a href="../man1/nbdkit-loop.1.html">nbdkit-loop</a></b>(1), <b><a href="../man1/nbdkit-service.1.html">nbdkit-service</a></b>(1), <b><a href="../man8/nbd-client.8.html">nbd-client</a></b>(8), <b><a href="../man5/nbdtab.5.html">nbdtab</a></b>(5), <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man5/systemd.mount.5.html">systemd.mount</a></b>(5).

</pre><h4><b>AUTHORS</b></h4><pre>
       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       Redistribution and use in source and binary forms, with or without modification, are permitted provided
       that the following conditions are met:

       •   Redistributions  of  source  code must retain the above copyright notice, this list of conditions and
           the following disclaimer.

       •   Redistributions in binary form must reproduce the above copyright notice, this list of conditions and
           the following disclaimer in the documentation and/or other materials provided with the distribution.

       •   Neither the name of Red Hat nor the names of its contributors may  be  used  to  endorse  or  promote
           products derived from this software without specific prior written permission.

       THIS  SOFTWARE  IS  PROVIDED BY RED HAT AND CONTRIBUTORS ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
       INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND  FITNESS  FOR  A  PARTICULAR
       PURPOSE  ARE  DISCLAIMED.  IN  NO EVENT SHALL RED HAT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
       INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,  PROCUREMENT  OF
       SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
       ON  ANY  THEORY  OF  LIABILITY,  WHETHER  IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
       OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
       DAMAGE.

nbdkit-1.42.2                                      2025-04-02                                   <u><a href="../man1/nbdkit-client.1.html">nbdkit-client</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>