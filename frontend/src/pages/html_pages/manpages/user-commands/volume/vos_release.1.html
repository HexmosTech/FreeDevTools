<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vos_release - Updates read-only volumes to match the read/write source volume</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/openafs-client">openafs-client_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       vos_release - Updates read-only volumes to match the read/write source volume

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>vos</b> <b>release</b> <b>-id</b> &lt;<u>volume</u> <u>name</u> <u>or</u> <u>ID</u>&gt;
           [<b>-force</b>] [<b>-force-reclone</b>]
           [<b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;]
           [<b>-noauth</b>] [<b>-localauth</b>]
           [<b>-verbose</b>] [<b>-encrypt</b>] [<b>-noresolve</b>]
           [<b>-config</b> &lt;<u>config</u> <u>directory</u>&gt;]
           [<b>-help</b>]

       <b>vos</b> <b>rel</b> <b>-i</b> &lt;<u>volume</u> <u>name</u> <u>or</u> <u>ID</u>&gt;
           [<b>-force</b>] [<b>-force-r</b>]
           [<b>-c</b> &lt;<u>cell</u> <u>name</u>&gt;]
           [<b>-noa</b>] [<b>-l</b>] [<b>-v</b>] [<b>-e</b>] [<b>-nor</b>]
           [<b>-co</b> &lt;<u>config</u> <u>directory</u>&gt;]
           [<b>-h</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>vos</b> <b>release</b> command copies the contents of the indicated read/write source volume to each read-only
       site defined in the source volume's Volume Location Database (VLDB) entry. (Use the <b>vos</b> <b>addsite</b> command
       to define sites as necessary before issuing this command). Each read-only copy has the same name as
       read/write source with the addition of a ".readonly" extension.

       For users to have a consistent view of the file system, the release of the new volume version must be
       atomic: either all read-only sites receive the new version, or all sites keep the version they currently
       have. The <b>vos</b> <b>release</b> command is designed to ensure that all copies of the volume's read-only version
       match both the read/write source and each other. In cases where problems such as machine or server
       process outages prevent successful completion of the release operation, AFS uses two mechanisms to alert
       the administrator.

       First, the command interpreter generates an error message on the standard error stream naming each read-
       only site that did not receive the new volume version. Second, during the release operation the Volume
       Location (VL) Server marks site definitions in the VLDB entry with flags ("New release" and "Old
       release") that indicate whether or not the site has the new volume version. If any flags remain after the
       operation completes, it was not successful. The Cache Manager refuses to access a read-only site marked
       with the "Old release" flag, which potentially imposes a greater load on the sites marked with the "New
       release" flag. It is important to investigate and eliminate the cause of the failure and then to issue
       the <b>vos</b> <b>release</b> command as many times as necessary to complete the release without errors.

       The pattern of site flags remaining in the volume's VLDB entry after a failed release operation can help
       determine the point at which the operation failed. Use the <b>vos</b> <b>examine</b> or <b>vos</b> <b>listvldb</b> command to display
       the VLDB entry. The VL Server sets the flags in concert with the Volume Server's operations, as follows:

       •   Before  the  operation  begins,  the  VL  Server  sets  the "New release" flag on the read/write site
           definition in the VLDB entry and the "Old release" flag on read-only  site  definitions  (unless  the
           read-only  site  has been defined since the last release operation and has no actual volume, in which
           case its site flag remains "Not released").

       •   If necessary, the Volume Server creates a temporary copy (a <u>clone</u>) of the  read/write  source  called
           the  ReleaseClone  (see  the following discussion of when the Volume Server does or does not create a
           new ReleaseClone.) It assigns the ReleaseClone its own volume ID number, which the VL Server  records
           in the "RClone" field of the source volume's VLDB entry.

       •   The  Volume  Server distributes a copy of the ReleaseClone to each read-only site defined in the VLDB
           entry. As the site successfully receives the new clone, the VL Server sets the  site's  flag  in  the
           VLDB entry to "New release".

       •   When  all  the read-only copies are successfully released, the VL Server clears all the "New release"
           site flags. The ReleaseClone is no longer needed, so the Volume Server deletes it and the  VL  Server
           erases its ID from the VLDB entry.

       By  default,  the  Volume  Server  determines  automatically  whether  or  not  it  needs to create a new
       ReleaseClone:

       •   If there are no flags ("New release", "Old release", or "Not released") on site  definitions  in  the
           VLDB entry, the previous <b>vos</b> <b>release</b> command completed successfully and all read-only sites currently
           have  the  same  volume.  The  Volume  Server  infers that the current <b>vos</b> <b>release</b> command was issued
           because the read/write volume has changed. The Volume Server creates a new  ReleaseClone  volume  and
           distributes  a copy of the clone volume to all the read-only sites.  In order to reduce the amount of
           data transferred during a release, the Volume Server sends incremental changes to remote sites during
           the release.  The Volume Server only sends files and directories  which  have  been  changed  in  the
           read/write volume since the previous release.

       •   If any site definition in the VLDB entry is marked with a flag, either the previous release operation
           did  not complete successfully or a new read-only site was defined since the last release. The Volume
           Server does not create a new ReleaseClone, instead distributing the entire existing  ReleaseClone  to
           sites  marked with the "Old release" or "Not released" flag. As previously noted, the VL Server marks
           each VLDB site definition with the "New release" flag as the  site  receives  the  ReleaseClone,  and
           clears all flags after all sites successfully receive it.

       To  override  the default behavior, forcing the Volume Server to create and release a new ReleaseClone to
       the read-only sites, include the <b>-force</b> flag. This is appropriate  if,  for  example,  the  data  at  the
       read/write  site  has  changed  since  the  existing ReleaseClone was created during the previous release
       operation.

       The <b>-force-reclone</b> will force the creation of a new release clone volume,  but  will  not  force  a  full
       volume dump to be distributed to the remote sites.  Instead, incremental changes will be distributed when
       possible.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-id</b> &lt;<u>volume</u> <u>name</u> <u>or</u> <u>id</u>&gt;
           Specifies either the complete name or volume ID number of a read/write volume.

       <b>-force</b>
           Creates a new ReleaseClone and distributes the entire clone volume to all read-only sites, regardless
           of the "New release", "Old release", or "Not released" site flags.

       <b>-force-reclone</b>
           Creates  a  new  ReleaseClone  and incrementally distributes the clone volume to all read-only sites,
           regardless of the "New release", "Old release", or "Not released" site flags.

       <b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;
           Names the cell in which to run the command. Do not combine this argument with  the  <b>-localauth</b>  flag.
           For more details, see <b><a href="../man1/vos.1.html">vos</a></b>(1).

       <b>-noauth</b>
           Assigns  the  unprivileged  identity  "anonymous"  to  the  issuer. Do not combine this flag with the
           <b>-localauth</b> flag. For more details, see <b><a href="../man1/vos.1.html">vos</a></b>(1).

       <b>-localauth</b>
           Constructs a server ticket using a key from  the  local  <u>/etc/openafs/server/KeyFile</u>  file.  The  <b>vos</b>
           command  interpreter  presents  it  to  the  Volume  Server  and Volume Location Server during mutual
           authentication. Do not combine this flag with the <b>-cell</b> argument or <b>-noauth</b> flag. For  more  details,
           see <b><a href="../man1/vos.1.html">vos</a></b>(1).

       <b>-verbose</b>
           Produces  on the standard output stream a detailed trace of the command's execution. If this argument
           is omitted, only warnings and error messages appear.

       <b>-encrypt</b>
           Encrypts the command so that the operation's results are not transmitted across the network in  clear
           text. This option is available in OpenAFS versions 1.4.11 or later and 1.5.60 or later.

       <b>-noresolve</b>
           Shows  all  servers  as  IP  addresses  instead  of the DNS name. This is very useful when the server
           address is registered as 127.0.0.1 or when dealing with multi-homed servers. This option is available
           in OpenAFS versions 1.4.8 or later and 1.5.35 or later.

       <b>-config</b> &lt;<u>configuration</u> <u>directory</u>&gt;
           Set the location of the configuration directory to be used. This defaults to <u>/etc/openafs</u>, except  if
           <b>-localauth</b> is specified, in which case the default is <u>/etc/openafs/server</u>. This option allows the use
           of alternative configuration locations for testing purposes.

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The  following command clones the read/write volume usr and releases it to the read-only sites defined in
       its VLDB entry.

          % vos release usr

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       The issuer must be listed in the <u>/etc/openafs/server/UserList</u> file on  the  machine  specified  with  the
       <b>-server</b> argument and on each database server machine. If the <b>-localauth</b> flag is included, the issuer must
       instead be logged on to a server machine as the local superuser "root".

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/vos.1.html">vos</a></b>(1), <b><a href="../man1/vos_addsite.1.html">vos_addsite</a></b>(1), <b><a href="../man1/vos_examine.1.html">vos_examine</a></b>(1), <b><a href="../man1/vos_listvldb.1.html">vos_listvldb</a></b>(1)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       IBM Corporation 2000. &lt;<a href="http://www.ibm.com/">http://www.ibm.com/</a>&gt; All Rights Reserved.

       This  documentation  is covered by the IBM Public License Version 1.0.  It was converted from HTML to POD
       by software written by Chas Williams and Russ Allbery, based on  work  by  Alf  Wachsmann  and  Elizabeth
       Cassell.

OpenAFS                                            2025-03-21                                     <u><a href="../man1/VOS_RELEASE.1.html">VOS_RELEASE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>