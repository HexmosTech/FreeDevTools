<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>restorevol - Restore a volume from vos dump to the local file system</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/openafs-client">openafs-client_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       restorevol - Restore a volume from vos dump to the local file system

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>restorevol</b> [<b>-file</b> &lt;<u>dump</u> <u>file</u>&gt;] [<b>-dir</b> &lt;<u>restore</u> <u>dir</u>&gt; ]
           [<b>-extension</b> &lt;<u>name</u> <u>extension</u>&gt;]
           [<b>-mountpoint</b> &lt;<u>mount</u> <u>point</u> <u>root</u>&gt;]
           [<b>-umask</b> &lt;<u>mode</u> <u>mask</u>&gt;] [<b>-help</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>restorevol</b> takes an AFS volume in the format produced by <b>vos</b> <b>dump</b> and restores it to the local file
       system.  Normally, the contents of a volume are maintained by the AFS File Server in an opaque format and
       copying a volume's raw data does not make it easily accessible.  This utility will produce a directory
       tree that is equivalent to that seen via an AFS client, but without preserving the AFS-specific Access
       Control Lists (ACLs).  It's primary use is to recover data from a volume dump or backup and make it
       available via a filesystem other than AFS.

       The dump output will read from standard input, or from a file if <b>-file</b> is specified.

       The restore process is as follows:

       1.  The dump file will be restored within the current directory or that specified with <b>-dir</b>.

       2.  Within  this  directory,  a  subdir is created.  It's name is the RW volume name that was dumped.  An
           extension can be appended to this directory name with <b>-extension</b>.

       3.  All mountpoints will appear as symbolic links to the volume name.  The path name to the  volume  will
           be either that in <b>-mountpoint</b>, or <b>-dir</b>.  Symbolic links remain untouched.

       4.  You  can  change  your umask during the restore with <b>-umask</b>.  Otherwise, <b>restorevol</b> uses your current
           umask.  Mode bits for directories are 0777 (then AND'ed with the umask).  Mode bits for files are the
           owner mode bits duplicated accross group and user (then AND'ed with the umask).

       5.  For restores of full dumps, if a directory says it has a file and the  file  is  not  found,  then  a
           symbolic  link  <u>AFSFile-&lt;#&gt;</u>  will appear in that restored tree.  Restores of incremental dumps remove
           all these files at the end (expensive because it is a tree search).

       6.  If a file or directory was found in the dump but found not to be connected to the hierarchical  tree,
           then  the  file  or  directory  will  be  connected  at the root of the tree as <b>__</b><u>ORPHANEDIR</u><b>__</b><u>.&lt;#&gt;</u> or
           <b>__</b><u>ORPHANFILE</u><b>__</b><u>.&lt;#&gt;</u>.

       7.  ACLs are not restored.

</pre><h4><b>CAUTIONS</b></h4><pre>
       Normally, use <b><a href="../man1/vos_restore.1.html">vos_restore</a></b>(1) instead of this command.  <b>restorevol</b> is a tool of  last  resort  to  try  to
       extract  data from the data structures stored in a volume dumpfile and is not as regularly tested or used
       as the normal <b><a href="../man1/vos_restore.1.html">vos_restore</a></b>(1) implementation.  Using <b>restorevol</b> bypasses checks done by the  <b><a href="../man8/fileserver.8.html">fileserver</a></b>(8)
       and <b><a href="../man8/salvager.8.html">salvager</a></b>(8).

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-file</b> &lt;<u>dump</u> <u>file</u>&gt;
           Specifies  the  volume  dump file to be read and restored to the local filesystem.  If this option is
           not given, the volume dump will be read from standard input.

       <b>-dir</b> &lt;<u>restore</u> <u>dir</u>&gt;
           Names the directory in which to create the restored filesystem.  The current  directory  is  used  by
           default.   Note  that  any  mountpoints inside the volume will point to the same directory unless the
           <b>-mountpoint</b> option is also specified.

       <b>-extension</b> &lt;<u>name</u> <u>extension</u>&gt;
           By default, the name of the directory created matches the RW volume name of the volume  in  the  dump
           file.   If  this  option is used, the directory name will be the RW volume name <u>name</u> <u>extension</u> as the
           suffix.

       <b>-mountpoint</b> &lt;<u>mount</u> <u>point</u> <u>root</u>&gt;
           By default, mountpoints inside the volume being restored point to the  value  given  by  <u>-dir</u>.   This
           option allows mountpoints to be resolved relative to another path.  A common use for this would be to
           specify  a  path  under  <u>/afs</u>  as the mount point root so that mountpoints inside the restored volume
           would be resolved via AFS.

           The <u>mount</u> <u>point</u> <u>root</u> must exist, and the process  running  the  command  have  read  access  to  that
           directory, or the command will fail.

       <b>-umask</b> &lt;<u>mode</u> <u>mask</u>&gt;
           Sets  the  umask  while  creating  files.  If  not  specified, the current process umask is used. All
           directories are created with mode 0777 (ANDed with the umask), and files are created with the  owner,
           group, and user mode bits set to the owner mode bits of the relevant AFS file (ANDed with the umask).

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The   following  command  restores  the  contents  of  the  dumpfile  in  <u>sample.dump</u>  to  the  directory
       <u>/tmp/sample.2009-05-17</u>, but having all mountpoints inside  the  volume  point  to  AFS  (note  that  this
       requires knowledge of where <u>sample</u> is mounted in AFS):

          % restorevol -file sample.dump -dir <a href="file:/tmp">/tmp</a> -extension .2009-05-17 \
              -mountpoint /afs/example.com/sample
          Restoring volume dump of 'sample' to directory '/tmp/sample.2009-05-17'

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       The  issuer  must have read access to the dump file and write access to the directory into which the dump
       is restored.  If the <b>-mountpoint</b> flag is given, the issuer must also have read access to that directory.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/salvager.8.html">salvager</a></b>(8), <b><a href="../man8/voldump.8.html">voldump</a></b>(8), <b><a href="../man1/vos_dump.1.html">vos_dump</a></b>(1), <b><a href="../man1/vos_restore.1.html">vos_restore</a></b>(1)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2009 Steven Jenkins &lt;<a href="mailto:steven@endpoint.com">steven@endpoint.com</a>&gt;

       This documentation is covered by the BSD License as written in the doc/LICENSE file. This  man  page  was
       written by Steven Jenkins for OpenAFS.

OpenAFS                                            2025-03-21                                      <u><a href="../man1/RESTOREVOL.1.html">RESTOREVOL</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>