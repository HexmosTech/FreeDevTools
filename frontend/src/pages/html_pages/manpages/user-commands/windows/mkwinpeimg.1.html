<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mkwinpeimg - Make a customized bootable image of Windows PE</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/wimtools">wimtools_1.14.4-1.1build4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mkwinpeimg - Make a customized bootable image of Windows PE

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>mkwinpeimg</b> [<u>OPTIONS</u>] <u>IMAGE</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>mkwinpeimg</b>  is  able  to  make  a  bootable  image  of  Windows PE by taking files from a mounted Windows
       installation ISO image (Vista or later) or the mounted ISO image for the Windows  Automated  Installation
       Kit  (WAIK)  or  the  WAIK  supplement.  The <b>--windows-dir</b> and <b>--waik-dir</b> options are used to specify the
       locations of these mounted ISOs.  You only need one  or  the  other.   The  files  that  <b>mkwinpeimg</b>  will
       retrieve are <u>boot.wim</u>, <u>bootmgr</u>, <u>boot.sdi</u>, and <u>bcd</u>.  If making an ISO image, the file <u>etfsboot.com</u> is also
       retrieved.  Microsoft owns the rights to these files and they are not distributed with wimlib.

       <b>mkwinpeimg</b>  can  make  two  types of bootable images.  The default is to make a bootable disk image.  The
       image is not partitioned and is formatted into a FAT filesystem.  <b><a href="../man1/syslinux.1.html">syslinux</a></b>(1) is required  to  make  this
       type of image, as it is used to chainload <u>bootmgr</u>. Also, <b><a href="../man1/mtools.1.html">mtools</a></b>(1) is required so that the FAT filesystem
       can be created without root privileges.

       The  other type of bootable image that <b>mkwinpeimg</b> can make is a bootable ISO image.  To make this type of
       image, give the <b>--iso</b> option.  <b><a href="../man1/mkisofs.1.html">mkisofs</a></b>(1) is required to make this type of image.  In <b>--iso</b> mode, you can
       specify <u>IMAGE</u> as "-" to write the ISO image to standard output.

       If you make a disk image, you could put it on a USB drive, and if you make an ISO image, you could put it
       on a CD.  In addition, both types of images can be loaded by the SYSLINUX or PXELINUX  bootloaders  using
       the MEMDISK module.

       Windows PE itself is contained in the <u>boot.wim</u> file.  <b>mkwinpeimg</b> can modify this file before embedding it
       in  a bootable image.  The most useful modification is to specify an executable or batch file for Windows
       PE to execute as soon as it starts up.  Use the <b>--start-script</b> <u>FILE</u> option to specify such a  file.   You
       may  also  add  arbitrary files to <u>boot.wim</u> by putting them in a directory, then specifying the <b>--overlay</b>
       <u>DIR</u> option.  However, for more extensive modifications, consider modifying the <u>boot.wim</u>  file  separately
       using <b><a href="../man1/wimmountrw.1.html">wimmountrw</a></b>(1) or <b><a href="../man1/wimupdate.1.html">wimupdate</a></b>(1), then providing it to <b>mkwinpeimg</b> using the <b>--wim</b> option.

       <b>mkwinpeimg</b>  can  also  make  only  a  modified <u>boot.wim</u>, rather than a bootable ISO or disk image, if the
       <b>--only-wim</b> option is given.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-i</b>, <b>--iso</b>
             Make an ISO image instead of a disk image.

       <b>-o</b>, <b>--only-wim</b>
             Make neither a disk image nor an ISO image; instead, only make a modified <u>boot.wim</u> file.

       <b>-W</b>, <b>--windows-dir</b>=<u>DIR</u>
             Use DIR as the location of the mounted Windows installation ISO image.   If  neither  <b>--windows-dir</b>
             nor  <b>--waik-dir</b>  is  specified,  then the script looks for the mounted ISO in the following default
             locations: /mnt/windows, /mnt/windows7, /mnt/windows8, and /mnt/windows10.

       <b>-A</b>, <b>--waik-dir</b>=<u>DIR</u>
             Get the boot files and boot.wim from the ISO of the Windows Automated Installation Kit  mounted  on
             DIR instead of from a Windows installation ISO.  This also works if the mounted ISO is for the WAIK
             supplement rather than the WAIK itself.

       <b>-s</b>, <b>--start-script</b>=<u>FILE</u>
             Add  FILE  to  the  root directory of Windows PE image and adjust \Windows\System32\winpeshl.ini to
             execute FILE when Windows PE starts up.

       <b>-w</b>, <b>--wim</b>=<u>WIM</u>
             Use WIM as the "boot.wim" file.  This defaults to the appropriate WIM file from  the  Windows  ISO,
             WAIK, or WAIK supplement.

       <b>-O</b>, <b>--overlay</b>=<u>DIR</u>
             Adds all the files in DIR to the Windows PE image.

       <b>-t</b>, <b>--tmp-dir</b>=<u>DIR</u>
             Use DIR for temporary files.  Defaults to a directory made using "mktemp -d".

       <b>-a</b>, <b>--arch</b>=<u>ARCH</u>
             Use  the  Windows  PE  version from the Windows Automated Installation Kit (or the WAIK supplement)
             that has the CPU architecture <u>ARCH</u>.   Only  valid  with  <b>--waik-dir</b>.   Possible  values:  "x86"  or
             "amd64".  Default is "x86".  Note: the WAIK also contains a Windows PE image for the ia64 (Itanium)
             architecture; however, this is not supported by this script.

       <b>-h</b>, <b>--help</b>
             Display help.

       <b>-v</b>, <b>--version</b>
             Show version information.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Create  a  bootable disk image of Windows PE from the Windows (Vista or later) installation media mounted
       on /media/windows:

              mkwinpeimg --windows-dir=/media/windows winpe.img

       Create a bootable ISO of Windows PE from the WAIK (or WAIK supplement) mounted on  /media/waik,  and  add
       all the files in "winpe_overlay" to Windows PE's filesystem:

              mkwinpeimg --iso --waik-dir=/media/waik --overlay=winpe_overlay winpe.iso

       Create  a bootable image of Windows PE from the Windows installation media mounted on /media/windows, add
       and make it execute "install.cmd" when it starts up.  In this example the image is created  in  the  root
       directory of the TFTP server for network booting.

              mkwinpeimg --start-script=install.cmd --windows-dir=/media/windows /var/tftpboot/winpe.img

</pre><h4><b>NOTES</b></h4><pre>
       Microsoft's licenses may limit the things that Windows PE can be used for, and they may limit your rights
       to redistribute customized versions of Windows PE.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to <u>https://wimlib.net/forums/</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/wimlib-imagex.1.html">wimlib-imagex</a></b>(1)

wimlib 1.14.4                                     February 2024                                    <u><a href="../man1/MKWINPEIMG.1.html">MKWINPEIMG</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>