<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dh_ruby - debhelper build system for Ruby software</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/gem2deb">gem2deb_2.2.5_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dh_ruby - debhelper build system for Ruby software

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>dh_ruby</b> [<u>OPTIONS</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>dh_ruby</b> is a Debhelper build system for Ruby software. It will automatically build and install files
       contained in Ruby packages, trying to work as close to Rubygems as possible but respecting Debian
       standards for Ruby packages.

       dh_ruby can automatically run your tests against all supported Ruby versions, see the "FILES" section
       below.

       See dh_ruby --help for details.

</pre><h4><b>SOURCE</b> <b>PACKAGE</b> <b>LAYOUT</b></h4><pre>
       <b>dh_ruby</b> supports two different source package styles: single-binary source packages, and multi-binary
       source packages.

   <b>Single-binary</b> <b>layout</b>
       The default layout is the <b>single-binary</b> layout. This is the layout used by most Ruby packages upstream,
       i.e. Ruby code in <u>lib</u>/, executable programs in <u>bin</u>/, etc. Packages imported from Rubygems using
       <b><a href="../man1/gem2deb.1.html">gem2deb</a>(1)</b> will have this layout.

       When using this layout, <b>dh_ruby</b> will install files (Ruby code, executables, gemspecs) to the <u>first</u> <u>binary</u>
       <u>package</u> listed in <u>debian/control</u>.

   <b>Multi-binary</b> <b>layout</b>
       <b>gem2deb</b> version <u>0.4.0</u> introduced support for the <b>multi-binary</b> layout. This layout should be used when you
       have a set of different Ruby packages maintained upstream in a single VCS, and you decide that you also
       want to maintain a single source package in Debian having the different components as separate binary
       packages.

       In this layout, the source package contains the separate components in subdirectories where each of them
       will use the standard Ruby layout (<u>lib</u>/, <u>bin</u>/, etc).

       This layout does not support creating separate binary packages from the same root directory. For those
       cases, see the documentation on <u>DH_RUBY_USE_DH_AUTO_INSTALL_DESTDIR</u> below.

       To indicate that you want to use a multi-binary layout, we have to 1) list your multiple binary packages
       in <u>debian/control</u> as usual, and add an extra-field called <u>X-DhRuby-Root</u> to each binary package stanza,
       indicating which directory has to be used as the root for that binary package.

       An example:

           Source: mymultibinarypackage
           [...]

           Package: ruby-foo
           X-DhRuby-Root: path/to/foo
           [...]

           Package: ruby-bar
           X-DhRuby-Root: path/to/bar

       The corresponding source package should be layed out like this:

           foo/
             foo.gemspec
             lib/
               foo.rb
             bin/foo
           bar/
             bar.gemspec
             lib/
               bar.rb
             bin/
               bar

       Important notes about multi-binary packages and the usage of <u>X-DhRuby-Root</u>:

       •   If your package uses the multi-binary layout, it must include `<u>gem2deb</u> (&gt;= 0.4.0~)` in <u>Build-Depends</u>.

           <b>Version</b>  <b>0.4.0</b>  <b>had</b>  <b>a</b>  <b>bug</b> <b>in</b> <b>the</b> <b>support</b> <b>for</b> <b>native</b> <b>extensions</b> in multi-binary packages, so if your
           package uses the multi-binary feature and at least one of the sub-components has  native  extensions,
           you must use `<u>gem2deb</u> (&gt;= 0.4.1~)` in <u>Build-Depends</u> instead.

       •   The  path  indicated  in  <u>X-DhRuby-Root</u>, as you have probably guessed by now, must be relative to the
           root of the source package.

       •   If any binary package declares a <u>X-DhRuby-Root</u> field, all other binary packages that don't  have  one
           will be ignored by <b>dh_ruby</b>.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--clean</b>, <b>--configure</b>, <b>--build</b>, <b>--test</b>, <b>--install</b>
           Commands called by debhelper at various steps of the build process.

       <b>--print-supported</b>
           Prints the supported Ruby versions.

       <b>-h</b>, <b>--help</b>
           Displays <b>dh_ruby</b> usage information.

       <b>-v</b>, <b>--version</b>
           Displays <b>dh_ruby</b> version information.

       <b>--gem-install</b>
           This  option indicates that the build should use the <b>gem</b> command to install the files, instead of the
           homegrown       installer.       Native       packages       will       be        installed        to
           <u><a href="file:/usr/lib/">/usr/lib/</a>$ARCH/rubygems-integration/$RUBY_VERSION</u>,  while  pure  Ruby  packages  will be installed to
           <u>/usr/share/rubygems-integration/all</u>.

           There is an internal include list of directories from the source package that need to  be  installed,
           but  we  can't possibly know all possibilities: if a package needs to install a directory that is not
           automatically installed, use <u>DH_RUBY_GEM_INSTALL_INCLUDE</u>. If you want to  exclude  a  directory  from
           being  installed,  use  <u>DH_RUBY_GEM_INSTALL_EXCLUDE</u>. Note that for using those variables, you need to
           build depend on gem2deb (&gt;= 1.6~).

</pre><h4><b>COMPATIBILITY</b> <b>LEVELS</b></h4><pre>
       dh_ruby reuses the <b><a href="../man7/debhelper.7.html">debhelper</a></b>(7) compatibility levels for  introducing  behavior  changes  that  might  be
       backwards-incompatible.

       v14 This level is still open for development; use with caution.

           Changes from v13 are:

           Packages  are  built and tested when executing the <b>build</b> target of <u>debian/rules</u>. The build is done as
           part of <b>dh_auto_build</b>, and the tests are run as part of <b>dh_auto_test</b>. The installation  into  debian/
           is  performed  during  the  <b>install</b>  target,  i.e.   during  <b>dh_auto_install</b>. This means that you can
           intercept  the  build  between  these   steps   using   targets   such   <b>execute_after_dh_auto_build</b>,
           <b>override_dh_auto_build</b>, <b>override_dh_auto_test</b>, <b>execute_before_dh_auto_install</b> etc.

       v13 This is the recommended mode of operation.

           This  was  the  current compatibility level at the point where this mechanism was introduced. So even
           packages with compatibility levels lower than 13 use this mode.

           In this this compatibility level, dh_ruby exhibits its classic behavior. In particular, packages  are
           built,  installed  and  tested during the <b>dh_auto_install</b> phase of the build process, i.e. when dpkg-
           buildpackage is invoking the <b>install</b> target of <u>debian/rules</u>.

</pre><h4><b>SUBSTITUTION</b> <b>VARIABLES</b></h4><pre>
       <u>${ruby:Depends}</u>
           ${ruby:Depends} will expand to the runtime dependencies of the package. This is determined by  taking
           the runtime dependencies from the Rubygems metadata, and then mapping them to Debian package names.

           The  relevant  packages  must  be installed during the package build for the mapping to be successful
           (normally they should be hardcoded in the Build-Depends: field).

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       <u>DH_RUBY</u>
           Use this variable to pass command line parameters to dh_ruby. For example in debian/rules:

               export DH_RUBY = --gem-install

       <u>DH_RUBY_IGNORE_TESTS</u>
           This is a space-separated list of tests that dh_ruby will ignore during package build. The  available
           test  names  are  the  names  of  all  supported  Ruby  versions  (you  can  list  them with `dh_ruby
           --print-supported`).

           If set to "all", all tests will be ignored during the package build.

       <u>DH_RUBY_USE_DH_AUTO_INSTALL_DESTDIR</u>
           If this  variable  is  defined  (to  anything),  dh_ruby  will  respect  the  directory  informed  by
           <b><a href="../man1/dh_auto_install.1.html">dh_auto_install</a></b>(1),  usually  <u>debian/tmp</u>.  By  default, gem2deb will install files to debian/<u>package</u>,
           where <u>package</u> is the first binary package listed in debian/control.

           This is useful for multi-binary source packages that don't conform  to  the  supported  layout  (i.e.
           separate  subdirectories  each  with  <u>lib</u>/,  <u>bin</u>/  etc).  Using  this, all files will be installed to
           <u>debian/tmp</u>,  and  you  can  them  distribute  them   into   separate   binary   packages   by   using
           <u>debian/$package.install</u> files or explicit shell calls in <u>debian/rules</u>.

           Mixing  <u>DH_RUBY_USE_DH_AUTO_INSTALL_DESTDIR</u>  and  multi-binary layout (using `X-DhRuby-Root:`) is NOT
           SUPPORTED.

       <u>DH_RUBY_GEMSPEC</u>
           Determines which file contain the gem specification with package metadata.  By default, dh_ruby  will
           read metadata from a .gemspec file in the root of source package directory. You can use this variable
           to override that if you want to provide custom metadata for the Debian package.

           In  the  case  there  are  more  than  one  .gemspec in the source package root, you will <u>need</u> to use
           DH_RUBY_GEMSPEC to instruct dh_ruby about which one to use.

       <u>DH_RUBY_GEM_INSTALL_INCLUDE</u>.
           When using --gem-install, this variable adds <b>files</b> to the list of files that need  to  be  installed.
           Entries  must  be  separated  by spaces, and can be either exact filenames, of glob expressions (e.g.
           <u>*.txt</u>, <u>foo/*</u>).

           Directories cannot be added directly, only files. If you want to include  an  entire  directory,  say
           <u>foo</u>, use a glob expression like <u>foo/*</u>.

           Note that by default all top-level files are automatically excluded, except <u>VERSION*</u> which is used by
           some  packages.  If  you  need  a  top-level  file  to  be installed, you need to explicit list it as
           included.

       <u>DH_RUBY_GEM_INSTALL_EXCLUDE</u>.
           When using --gem-install, this variable adds files to the list of files that SHOULD NOT be installed.
           Entries must be separated by spaces, and must be either specific filenames, or glob expressions (e.g.
           <u>*.txt</u>).

           Directories cannot be excluded directly. To exclude an entire directory, use a glob  expression  such
           as <u>foo/*</u>.

</pre><h4><b>FILES</b></h4><pre>
       debian/<u>ruby-test-files.yaml</u>, debian/<u>ruby-tests.rake</u>, debian/<u>ruby-tests.rb</u>
           Theses  files  can  be  used  to  explicitly  tell dh_ruby how to run the tests in your package. When
           running the tests, dh_ruby will automatically set RUBYLIB  to  include  the  appropriate  directories
           where the package files were installed in your package to make sure the tests use them instead of the
           files in the source directory.

           <b>Your</b> <b>package</b> <b>can</b> <b>only</b> <b>contain</b> <b>at</b> <b>most</b> <b>one</b> <b>of</b> <b>these</b> <b>files.</b>

           debian/<u>ruby-test-files.yaml</u>  must contain a YAML document with a list of test files to be run. If the
           package metadata contains an explicit list of test files, <b><a href="../man1/gem2deb.1.html">gem2deb</a></b>(1) will automatically generate this
           file for you. Example from ruby-mime-types:

             ---
             - test/test_mime_type.rb
             - test/test_mime_types.rb

           debian/<u>ruby-tests.rake</u> can be used to run the tests with <b><a href="../man1/rake.1.html">rake</a></b>(1). You can use anything you would  use
           in  a regular Rakefile, but you must define a default task. gem2deb includes a utility test task that
           makes it easier for you by creating a default task automatically. Example:

             require 'gem2deb/rake/testtask'
             Gem2Deb::Rake::TestTask.new do |t|
               t.test_files = FileList['test/*_test.rb']
             end

           You can also use the equivalent RSpec task:

             require 'gem2deb/rake/spectask'
             Gem2Deb::Rake::RSpecTask.new do |spec|
               spec.pattern = './spec/**/*_spec.rb'
             end

           If debian/<u>ruby-tests.rb</u> exists, it will be run with each supported Ruby version, and must finish with
           a exit status of <u>0</u>, otherwise dh_ruby assumes the tests failed. A simple example:

             require 'test/unit'
             require 'mypackage' # if 'mypackage.rb' or 'mypackage.so' was not installed properly, this will fail
             class MyPackageTest &lt; Test::Unit::TestCase
               def test_features
                 assert_equal 4, MyPackage.sum(2,2)
               end
             end

       debian/tests/assets (directory)
           For Rails assets packages (ruby-rails-assets-*), the presence of this directory will cause the  Rails
           assets  smoke test to be run. During the test run, this directory will be copied into under app/ in a
           freshly created rails application, and `bundle exec rake assets:precompile` will be called.

           <b>debian/tests/assets</b> should contain example usage of the given package, e.g.:

           <b>debian/tests/assets/javascripts/application.js</b>
           <b>debian/tests/assets/stylesheets/application.scss</b>

           In the above example, those files will be copied at the following location in the test Rails app:

           <b>app/assets/javascripts/application.js</b>
           <b>app/assets/stylesheets/application.scss</b>

           <b>Note</b>: any dependencies needed to run this smoke test must be specified explicitly  as  package  build
           dependencies.

       debian/<u>dh_ruby.mk</u>
           If  this  file is present, dh_ruby will call <b>make</b> passing it as the makefile during the build, in the
           <u>clean</u>, <u>build</u>, and <u>install</u> steps, like this:

           clean: <b>make</b> <b>-f</b> <b>debian/dh_ruby.mk</b> <b>clean</b>
           build: <b>make</b> <b>-f</b> <b>debian/dh_ruby.mk</b>
           install: <b>make</b> <b>-f</b> <b>debian/dh_ruby.mk</b> <b>install</b>

           If you want the upstream Makefile to be used, just make <u>debian/dh_ruby.mk</u> a symlink to <u>../Makefile</u>.

       debian/<u>dh_ruby.rake</u>
           If this file is present, dh_ruby will call <b>rake</b> passing it as the rakefile during the build,  in  the
           <u>clean</u>, <u>build</u>, and <u>install</u> steps, like this:

           clean: <b>rake</b> <b>-f</b> <b>debian/dh_ruby.rake</b> <b>clean</b>
           build: <b>rake</b> <b>-f</b> <b>debian/dh_ruby.rake</b>
           install: <b>rake</b> <b>-f</b> <b>debian/dh_ruby.rake</b> <b>install</b>

           If you want the upstream Rakefile to be used, just make <u>debian/dh_ruby.rake</u> a symlink to <u>../Rakefile</u>.

       debian/<u>gemspec</u>
           If  this  file  exists,  it  will  be used as the package gemspec, regardless of <u>metadata.yml</u> and any
           <u>*.gemspec</u> that exists in the upstream source. Using this is  only  advised  on  single-binary  source
           packages,  and the behavior of this feature is undefined for multi-binary source packages (see <b>SOURCE</b>
           <b>PACKAGE</b> <b>LAYOUT</b> above).

           If debian/<u>gemspec</u> is a symlink, it will first be expanded, and then the symlink target will  be  used
           as a gemspec.

           Hint:  for  packages  with multiple gemspec, you can have debian/<u>gemspec</u> as a symlink pointing to the
           one you want to use.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/gem2deb.1.html">gem2deb</a></b>(1)

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>AUTHORS</b></h4><pre>
       Copyright (c) 2011, Lucas Nussbaum &lt;<a href="mailto:lucas@debian.org">lucas@debian.org</a>&gt;

       This program is free software: you can redistribute it and/or modify  it  under  the  terms  of  the  GNU
       General  Public License as published by the Free Software Foundation, either version 3 of the License, or
       (at your option) any later version.

       This program is distributed in the hope that it will be useful, but WITHOUT ANY  WARRANTY;  without  even
       the  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with this program.  If  not,  see
       &lt;<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.

                                                   2024-11-13                                         <u><a href="../man1/DH_RUBY.1.html">DH_RUBY</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>