<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gmx-nonbonded-benchmark - Benchmarking tool for the non-bonded pair kernels.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/gromacs-data">gromacs-data_2025.0-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gmx-nonbonded-benchmark - Benchmarking tool for the non-bonded pair kernels.

</pre><h4><b>SYNOPSIS</b></h4><pre>
          gmx nonbonded-benchmark [<b>-o</b> <u>[&lt;.csv&gt;]</u>] [<b>-size</b> <u>&lt;int&gt;</u>] [<b>-nt</b> <u>&lt;int&gt;</u>]
                       [<b>-simd</b> <u>&lt;enum&gt;</u>] [<b>-coulomb</b> <u>&lt;enum&gt;</u>] [<b>-[no]table</b>]
                       [<b>-combrule</b> <u>&lt;enum&gt;</u>] [<b>-[no]halflj</b>] [<b>-[no]energy</b>]
                       [<b>-[no]all</b>] [<b>-cutoff</b> <u>&lt;real&gt;</u>] [<b>-iter</b> <u>&lt;int&gt;</u>]
                       [<b>-warmup</b> <u>&lt;int&gt;</u>] [<b>-[no]cycles</b>] [<b>-[no]time</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>gmx</b>  <b>nonbonded-benchmark</b>  runs  benchmarks  for  one or more so-called Nbnxm non-bonded pair kernels. The
       non-bonded pair kernels are the most compute intensive part of MD simulations and usually comprise 60  to
       90  percent  of  the runtime.  For this reason they are highly optimized and several different setups are
       available to compute  the  same  physical  interactions.   In  addition,  there  are  different  physical
       treatments  of Coulomb interactions and optimizations for atoms without Lennard-Jones interactions. There
       are also different physical treatments of  Lennard-Jones  interactions,  but  only  a  plain  cut-off  is
       supported  in this tool, as that is by far the most common treatment.  And finally, while force output is
       always necessary, energy output is only required at  certain  steps.  In  total  there  are  12  relevant
       combinations  of  options.  The  combinations  double to 24 when two different SIMD setups are supported.
       These combinations can be run with a single invocation using the  <b>-all</b>  option.   The  behavior  of  each
       kernel is affected by caching behavior, which is determined by the hardware used together with the system
       size  and  the  cut-off radius. The larger the number of atoms per thread, the more L1 cache is needed to
       avoid L1 cache misses.  The cut-off radius mainly affects the data reuse: a  larger  cut-off  results  in
       more data reuse and makes the kernel less sensitive to cache misses.

       OpenMP  parallelization  is  used  to  utilize  multiple hardware threads within a compute node. In these
       benchmarks there is no interaction between threads, apart from  starting  and  closing  a  single  OpenMP
       parallel  region  per  iteration.  Additionally,  threads interact through sharing and evicting data from
       shared caches.  The number of threads to use is set with the <b>-nt</b> option.  Thread affinity  is  important,
       especially  with  SMT  and  shared  caches.  Affinities  can  be set through the OpenMP library using the
       GOMP_CPU_AFFINITY environment variable.

       The benchmark tool times one or more kernels by running them repeatedly for a number of iterations set by
       the <b>-iter</b> option. An initial kernel call is done to avoid additional  initial  cache  misses.  Times  are
       recording  in cycles read from efficient, high accuracy counters in the CPU. Note that these often do not
       correspond to actual clock cycles. For each kernel, the tool reports the total number of  cycles,  cycles
       per  iteration,  and (total and useful) pair interactions per cycle.  Because a cluster pair list is used
       instead of an atom pair list, interactions are also computed for some atom  pairs  that  are  beyond  the
       cut-off  distance.  These  pairs  are  not  useful  (except  for additional buffering, but that is not of
       interest here), only a side effect of the cluster-pair setup. The SIMD 2xMM kernel has  a  higher  useful
       pair  ratio  then the 4xM kernel due to a smaller cluster size, but a lower total pair throughput.  It is
       best to run this, or for that matter any, benchmark with locked CPU clocks,  as  thermal  throttling  can
       significantly  affect  performance.  If  that  is  not  an  option, the <b>-warmup</b> option can be used to run
       initial, untimed iterations to warm up the processor.

       The most relevant regime is between 0.1 to 1 millisecond per iteration. Thus it is  useful  to  run  with
       system sizes that cover both ends of this regime.

       The  <b>-simd</b> and <b>-table</b> options select different implementations to compute the same physics. The choice of
       these options should ideally be optimized for the target hardware.  Historically, we only found tabulated
       Ewald correction to be useful on  2-wide  SIMD  or  4-wide  SIMD  without  FMA  support.  As  all  modern
       architectures are wider and support FMA, we do not use tables by default. The only exceptions are kernels
       without  SIMD,  which  only  support tables.  Options <b>-coulomb</b>, <b>-combrule</b> and <b>-halflj</b> depend on the force
       field and composition of the simulated system.  The optimization of computing Lennard-Jones  interactions
       for only half of the atoms in a cluster is useful for water, which does not use Lennard-Jones on hydrogen
       atoms  in  most  water  models.   In  the MD engine, any clusters where at most half of the atoms have LJ
       interactions will automatically use this kernel.  And finally, the <b>-energy</b> option selects the computation
       of energies, which are usually only needed infrequently.

</pre><h4><b>OPTIONS</b></h4><pre>
       Options to specify output files:

       <b>-o</b> <b>[&lt;.csv&gt;]</b> <b>(nonbonded-benchmark.csv)</b> <b>(Optional)</b>
              Also output results in csv format

       Other options:

       <b>-size</b> <b>&lt;int&gt;</b> <b>(1)</b>
              The system size is 3000 atoms times this value

       <b>-nt</b> <b>&lt;int&gt;</b> <b>(1)</b>
              The number of OpenMP threads to use

       <b>-simd</b> <b>&lt;enum&gt;</b> <b>(auto)</b>
              SIMD type, auto runs all supported SIMD setups or no SIMD when SIMD is not  supported:  auto,  no,
              4xm, 2xmm

       <b>-coulomb</b> <b>&lt;enum&gt;</b> <b>(ewald)</b>
              The functional form for the Coulomb interactions: ewald, reaction-field

       <b>-[no]table</b> <b>(no)</b>
              Use lookup table for Ewald correction instead of analytical

       <b>-combrule</b> <b>&lt;enum&gt;</b> <b>(geometric)</b>
              The LJ combination rule: geometric, lb, none

       <b>-[no]halflj</b> <b>(no)</b>
              Use optimization for LJ on half of the atoms

       <b>-[no]energy</b> <b>(no)</b>
              Compute energies in addition to forces

       <b>-[no]all</b> <b>(no)</b>
              Run all 12 combinations of options for coulomb, halflj, combrule

       <b>-cutoff</b> <b>&lt;real&gt;</b> <b>(1)</b>
              Pair-list and interaction cut-off distance

       <b>-iter</b> <b>&lt;int&gt;</b> <b>(100)</b>
              The number of iterations for each kernel

       <b>-warmup</b> <b>&lt;int&gt;</b> <b>(0)</b>
              The number of iterations for initial warmup

       <b>-[no]cycles</b> <b>(no)</b>
              Report cycles/pair instead of pairs/cycle

       <b>-[no]time</b> <b>(no)</b>
              Report micro-seconds instead of cycles

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/gmx.1.html">gmx</a>(1)</b>

       More information about GROMACS is available at &lt;<u><a href="http://www.gromacs.org/">http://www.gromacs.org/</a></u>&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2025, GROMACS development team

2025.0                                            Feb 10, 2025                        <u><a href="../man1/GMX-NONBONDED-BENCHMARK.1.html">GMX-NONBONDED-BENCHMARK</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>