<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gmx-cluster - Cluster structures</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/gromacs-data">gromacs-data_2025.0-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gmx-cluster - Cluster structures

</pre><h4><b>SYNOPSIS</b></h4><pre>
          gmx cluster [<b>-f</b> <u>[&lt;.xtc/.trr/...&gt;]</u>] [<b>-s</b> <u>[&lt;.tpr/.gro/...&gt;]</u>] [<b>-n</b> <u>[&lt;.ndx&gt;]</u>]
                      [<b>-dm</b> <u>[&lt;.xpm&gt;]</u>] [<b>-om</b> <u>[&lt;.xpm&gt;]</u>] [<b>-o</b> <u>[&lt;.xpm&gt;]</u>] [<b>-g</b> <u>[&lt;.log&gt;]</u>]
                      [<b>-dist</b> <u>[&lt;.xvg&gt;]</u>] [<b>-ev</b> <u>[&lt;.xvg&gt;]</u>] [<b>-conv</b> <u>[&lt;.xvg&gt;]</u>]
                      [<b>-sz</b> <u>[&lt;.xvg&gt;]</u>] [<b>-tr</b> <u>[&lt;.xpm&gt;]</u>] [<b>-ntr</b> <u>[&lt;.xvg&gt;]</u>]
                      [<b>-clid</b> <u>[&lt;.xvg&gt;]</u>] [<b>-cl</b> <u>[&lt;.xtc/.trr/...&gt;]</u>]
                      [<b>-clndx</b> <u>[&lt;.ndx&gt;]</u>] [<b>-b</b> <u>&lt;time&gt;</u>] [<b>-e</b> <u>&lt;time&gt;</u>] [<b>-dt</b> <u>&lt;time&gt;</u>]
                      [<b>-tu</b> <u>&lt;enum&gt;</u>] [<b>-[no]w</b>] [<b>-xvg</b> <u>&lt;enum&gt;</u>] [<b>-[no]dista</b>]
                      [<b>-nlevels</b> <u>&lt;int&gt;</u>] [<b>-cutoff</b> <u>&lt;real&gt;</u>] [<b>-[no]fit</b>]
                      [<b>-max</b> <u>&lt;real&gt;</u>] [<b>-skip</b> <u>&lt;int&gt;</u>] [<b>-[no]av</b>] [<b>-wcl</b> <u>&lt;int&gt;</u>]
                      [<b>-nst</b> <u>&lt;int&gt;</u>] [<b>-rmsmin</b> <u>&lt;real&gt;</u>] [<b>-method</b> <u>&lt;enum&gt;</u>]
                      [<b>-minstruct</b> <u>&lt;int&gt;</u>] [<b>-[no]binary</b>] [<b>-M</b> <u>&lt;int&gt;</u>] [<b>-P</b> <u>&lt;int&gt;</u>]
                      [<b>-seed</b> <u>&lt;int&gt;</u>] [<b>-niter</b> <u>&lt;int&gt;</u>] [<b>-nrandom</b> <u>&lt;int&gt;</u>]
                      [<b>-kT</b> <u>&lt;real&gt;</u>] [<b>-[no]pbc</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>gmx</b>  <b>cluster</b> can cluster structures using several different methods.  Distances between structures can be
       determined from a trajectory or read from an <u>.xpm</u> matrix file with the <b>-dm</b> option.  RMS  deviation  after
       fitting or RMS deviation of atom-pair distances can be used to define the distance between structures.

       single linkage: add a structure to a cluster when its distance to any element of the cluster is less than
       <b>cutoff</b>.

       Jarvis Patrick: add a structure to a cluster when this structure and a structure in the cluster have each
       other  as  neighbors  and they have a least <b>P</b> neighbors in common. The neighbors of a structure are the M
       closest structures or all structures within <b>cutoff</b>.

       Monte Carlo: reorder the RMSD matrix using Monte Carlo such that the order of the  frames  is  using  the
       smallest  possible  increments.   With  this  it  is  possible  to make a smooth animation going from one
       structure to another with the largest possible (e.g.) RMSD between them, however the  intermediate  steps
       should be as small as possible.  Applications could be to visualize a potential of mean force ensemble of
       simulations  or  a pulling simulation. Obviously the user has to prepare the trajectory well (e.g. by not
       superimposing frames).  The final result can be inspect visually by looking  at  the  matrix  <u>.xpm</u>  file,
       which should vary smoothly from bottom to top.

       diagonalization: diagonalize the RMSD matrix.

       gromos:  use algorithm as described in Daura <u>et</u> <u>al.</u>  (<u>Angew.</u> <u>Chem.</u> <u>Int.</u> <u>Ed.</u> <b>1999</b>, <u>38</u>, pp 236-240).  Count
       number of neighbors using cut-off, take structure with largest number of neighbors with all its neighbors
       as cluster and eliminate it from the pool of clusters. Repeat for remaining structures in pool.

       When the clustering algorithm assigns each structure to  exactly  one  cluster  (single  linkage,  Jarvis
       Patrick  and  gromos) and a trajectory file is supplied, the structure with the smallest average distance
       to the others or the average structure or all structures for each cluster will be written to a trajectory
       file. When writing all structures, separate numbered files are made for each cluster.

       Two output files are always written:

          • <b>-o</b> writes the RMSD values in the upper left half of the matrix and  a  graphical  depiction  of  the
            clusters  in  the  lower  right  half  When <b>-minstruct</b> = 1 the graphical depiction is black when two
            structures are in the same cluster.  When <b>-minstruct</b> &gt; 1 different colors  will  be  used  for  each
            cluster.

          • <b>-g</b> writes information on the options used and a detailed list of all clusters and their members.

       Additionally, a number of optional output files can be written:

          • <b>-dist</b> writes the RMSD distribution.

          • <b>-ev</b> writes the eigenvectors of the RMSD matrix diagonalization.

          • <b>-sz</b> writes the cluster sizes.

          • <b>-tr</b> writes a matrix of the number transitions between cluster pairs.

          • <b>-ntr</b> writes the total number of transitions to or from each cluster.

          • <b>-clid</b> writes the cluster number as a function of time.

          • <b>-clndx</b> writes the frame numbers corresponding to the clusters to the specified index file to be read
            into trjconv.

          • <b>-cl</b>  writes  average (with option <b>-av</b>) or central structure of each cluster or writes numbered files
            with cluster members for a selected set of clusters (with option <b>-wcl</b>, depends on <b>-nst</b> and <b>-rmsmin</b>).
            The center of a cluster is the structure with the smallest average RMSD from all other structures of
            the cluster.

</pre><h4><b>OPTIONS</b></h4><pre>
       Options to specify input files:

       <b>-f</b> <b>[&lt;.xtc/.trr/...&gt;]</b> <b>(traj.xtc)</b> <b>(Optional)</b>
              Trajectory: <u>xtc</u> <u>trr</u> <u>cpt</u> <u>gro</u> <u>g96</u> <u>pdb</u> <u>tng</u>

       <b>-s</b> <b>[&lt;.tpr/.gro/...&gt;]</b> <b>(topol.tpr)</b>
              Structure+mass(db): <u>tpr</u> <u>gro</u> <u>g96</u> <u>pdb</u> brk ent

       <b>-n</b> <b>[&lt;.ndx&gt;]</b> <b>(index.ndx)</b> <b>(Optional)</b>
              Index file

       <b>-dm</b> <b>[&lt;.xpm&gt;]</b> <b>(rmsd.xpm)</b> <b>(Optional)</b>
              X PixMap compatible matrix file

       Options to specify output files:

       <b>-om</b> <b>[&lt;.xpm&gt;]</b> <b>(rmsd-raw.xpm)</b>
              X PixMap compatible matrix file

       <b>-o</b> <b>[&lt;.xpm&gt;]</b> <b>(rmsd-clust.xpm)</b>
              X PixMap compatible matrix file

       <b>-g</b> <b>[&lt;.log&gt;]</b> <b>(cluster.log)</b>
              Log file

       <b>-dist</b> <b>[&lt;.xvg&gt;]</b> <b>(rmsd-dist.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-ev</b> <b>[&lt;.xvg&gt;]</b> <b>(rmsd-eig.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-conv</b> <b>[&lt;.xvg&gt;]</b> <b>(mc-conv.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-sz</b> <b>[&lt;.xvg&gt;]</b> <b>(clust-size.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-tr</b> <b>[&lt;.xpm&gt;]</b> <b>(clust-trans.xpm)</b> <b>(Optional)</b>
              X PixMap compatible matrix file

       <b>-ntr</b> <b>[&lt;.xvg&gt;]</b> <b>(clust-trans.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-clid</b> <b>[&lt;.xvg&gt;]</b> <b>(clust-id.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-cl</b> <b>[&lt;.xtc/.trr/...&gt;]</b> <b>(clusters.pdb)</b> <b>(Optional)</b>
              Trajectory: <u>xtc</u> <u>trr</u> <u>cpt</u> <u>gro</u> <u>g96</u> <u>pdb</u> <u>tng</u>

       <b>-clndx</b> <b>[&lt;.ndx&gt;]</b> <b>(clusters.ndx)</b> <b>(Optional)</b>
              Index file

       Other options:

       <b>-b</b> <b>&lt;time&gt;</b> <b>(0)</b>
              Time of first frame to read from trajectory (default unit ps)

       <b>-e</b> <b>&lt;time&gt;</b> <b>(0)</b>
              Time of last frame to read from trajectory (default unit ps)

       <b>-dt</b> <b>&lt;time&gt;</b> <b>(0)</b>
              Only use frame when t MOD dt = first time (default unit ps)

       <b>-tu</b> <b>&lt;enum&gt;</b> <b>(ps)</b>
              Unit for time values: fs, ps, ns, us, ms, s

       <b>-[no]w</b> <b>(no)</b>
              View output <u>.xvg</u>, <u>.xpm</u>, <u>.eps</u> and <u>.pdb</u> files

       <b>-xvg</b> <b>&lt;enum&gt;</b> <b>(xmgrace)</b>
              xvg plot formatting: xmgrace, xmgr, none

       <b>-[no]dista</b> <b>(no)</b>
              Use RMSD of distances instead of RMS deviation

       <b>-nlevels</b> <b>&lt;int&gt;</b> <b>(40)</b>
              Discretize RMSD matrix in this number of levels

       <b>-cutoff</b> <b>&lt;real&gt;</b> <b>(0.1)</b>
              RMSD cut-off (nm) for two structures to be neighbor

       <b>-[no]fit</b> <b>(yes)</b>
              Use least squares fitting before RMSD calculation

       <b>-max</b> <b>&lt;real&gt;</b> <b>(-1)</b>
              Maximum level in RMSD matrix

       <b>-skip</b> <b>&lt;int&gt;</b> <b>(1)</b>
              Only analyze every nr-th frame

       <b>-[no]av</b> <b>(no)</b>
              Write average instead of middle structure for each cluster

       <b>-wcl</b> <b>&lt;int&gt;</b> <b>(0)</b>
              Write the structures for this number of clusters to numbered files

       <b>-nst</b> <b>&lt;int&gt;</b> <b>(1)</b>
              Only write all structures if more than this number of structures per cluster

       <b>-rmsmin</b> <b>&lt;real&gt;</b> <b>(0)</b>
              minimum rms difference with rest of cluster for writing structures

       <b>-method</b> <b>&lt;enum&gt;</b> <b>(linkage)</b>
              Method for cluster determination: linkage, jarvis-patrick, monte-carlo, diagonalization, gromos

       <b>-minstruct</b> <b>&lt;int&gt;</b> <b>(1)</b>
              Minimum number of structures in cluster for coloring in the <u>.xpm</u> file

       <b>-[no]binary</b> <b>(no)</b>
              Treat the RMSD matrix as consisting of 0 and 1, where the cut-off is given by <b>-cutoff</b>

       <b>-M</b> <b>&lt;int&gt;</b> <b>(10)</b>
              Number of nearest neighbors considered for Jarvis-Patrick algorithm, 0 is use cutoff

       <b>-P</b> <b>&lt;int&gt;</b> <b>(3)</b>
              Number of identical nearest neighbors required to form a cluster

       <b>-seed</b> <b>&lt;int&gt;</b> <b>(0)</b>
              Random number seed for Monte Carlo clustering algorithm (0 means generate)

       <b>-niter</b> <b>&lt;int&gt;</b> <b>(10000)</b>
              Number of iterations for MC

       <b>-nrandom</b> <b>&lt;int&gt;</b> <b>(0)</b>
              The first iterations for MC may be done complete random, to shuffle the frames

       <b>-kT</b> <b>&lt;real&gt;</b> <b>(0.001)</b>
              Boltzmann weighting factor for Monte Carlo optimization (zero turns off uphill steps)

       <b>-[no]pbc</b> <b>(yes)</b>
              PBC check

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/gmx.1.html">gmx</a>(1)</b>

       More information about GROMACS is available at &lt;<u><a href="http://www.gromacs.org/">http://www.gromacs.org/</a></u>&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2025, GROMACS development team

2025.0                                            Feb 10, 2025                                    <u><a href="../man1/GMX-CLUSTER.1.html">GMX-CLUSTER</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>