<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>openssl-cms - CMS command</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/openssl">openssl_3.4.1-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       openssl-cms - CMS command

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>openssl</b> <b>cms</b> [<b>-help</b>]

       General options:

       [<b>-in</b> <u>filename</u>] [<b>-out</b> <u>filename</u>] [<b>-config</b> <u>configfile</u>]

       Operation options:

       [<b>-encrypt</b>] [<b>-decrypt</b>] [<b>-sign</b>] [<b>-verify</b>] [<b>-resign</b>] [<b>-sign_receipt</b>] [<b>-verify_receipt</b> <u>receipt</u>] [<b>-digest</b>
       <u>digest</u>] [<b>-digest_create</b>] [<b>-digest_verify</b>] [<b>-compress</b>] [<b>-uncompress</b>] [<b>-EncryptedData_encrypt</b>]
       [<b>-EncryptedData_decrypt</b>] [<b>-data_create</b>] [<b>-data_out</b>] [<b>-cmsout</b>]

       File format options:

       [<b>-inform</b> <b>DER</b>|<b>PEM</b>|<b>SMIME</b>] [<b>-outform</b> <b>DER</b>|<b>PEM</b>|<b>SMIME</b>] [<b>-rctform</b> <b>DER</b>|<b>PEM</b>|<b>SMIME</b>] [<b>-stream</b>] [<b>-indef</b>] [<b>-noindef</b>]
       [<b>-binary</b>] [<b>-crlfeol</b>] [<b>-asciicrlf</b>]

       Keys and password options:

       [<b>-pwri_password</b> <u>password</u>] [<b>-secretkey</b> <u>key</u>] [<b>-secretkeyid</b> <u>id</u>] [<b>-inkey</b> <u>filename</u>|<u>uri</u>] [<b>-passin</b> <u>arg</u>] [<b>-keyopt</b>
       <u>name</u>:<u>parameter</u>] [<b>-keyform</b> <b>DER</b>|<b>PEM</b>|<b>P12</b>|<b>ENGINE</b>] [<b>-engine</b> <u>id</u>] [<b>-provider</b> <u>name</u>] [<b>-provider-path</b> <u>path</u>]
       [<b>-propquery</b> <u>propq</u>] [<b>-rand</b> <u>files</u>] [<b>-writerand</b> <u>file</u>]

       Encryption options:

       [<b>-originator</b> <u>file</u>] [<b>-recip</b> <u>file</u>] [<u>recipient-cert</u> ...]  [<b>-</b><u><b>cipher</b></u>] [<b>-wrap</b> <u>cipher</u>] [<b>-aes128-wrap</b>]
       [<b>-aes192-wrap</b>] [<b>-aes256-wrap</b>] [<b>-des3-wrap</b>] [<b>-debug_decrypt</b>]

       Signing options:

       [<b>-md</b> <u>digest</u>] [<b>-signer</b> <u>file</u>] [<b>-certfile</b> <u>file</u>] [<b>-cades</b>] [<b>-nodetach</b>] [<b>-nocerts</b>] [<b>-noattr</b>] [<b>-nosmimecap</b>]
       [<b>-receipt_request_all</b>] [<b>-receipt_request_first</b>] [<b>-receipt_request_from</b> <u>emailaddress</u>] [<b>-receipt_request_to</b>
       <u>emailaddress</u>]

       Verification options:

       [<b>-signer</b> <u>file</u>] [<b>-content</b> <u>filename</u>] [<b>-no_content_verify</b>] [<b>-no_attr_verify</b>] [<b>-nosigs</b>] [<b>-noverify</b>]
       [<b>-nointern</b>] [<b>-cades</b>] [<b>-verify_retcode</b>] [<b>-CAfile</b> <u>file</u>] [<b>-no-CAfile</b>] [<b>-CApath</b> <u>dir</u>] [<b>-no-CApath</b>] [<b>-CAstore</b>
       <u>uri</u>] [<b>-no-CAstore</b>]

       Output options:

       [<b>-keyid</b>] [<b>-econtent_type</b> <u>type</u>] [<b>-text</b>] [<b>-certsout</b> <u>file</u>] [<b>-to</b> <u>addr</u>] [<b>-from</b> <u>addr</u>] [<b>-subject</b> <u>subj</u>]

       Printing options:

       [<b>-noout</b>] [<b>-print</b>] [<b>-nameopt</b> <u>option</u>] [<b>-receipt_request_print</b>]

       Validation options:

       [<b>-allow_proxy_certs</b>] [<b>-attime</b> <u>timestamp</u>] [<b>-no_check_time</b>] [<b>-check_ss_sig</b>] [<b>-crl_check</b>] [<b>-crl_check_all</b>]
       [<b>-explicit_policy</b>] [<b>-extended_crl</b>] [<b>-ignore_critical</b>] [<b>-inhibit_any</b>] [<b>-inhibit_map</b>] [<b>-partial_chain</b>]
       [<b>-policy</b> <u>arg</u>] [<b>-policy_check</b>] [<b>-policy_print</b>] [<b>-purpose</b> <u>purpose</u>] [<b>-suiteB_128</b>] [<b>-suiteB_128_only</b>]
       [<b>-suiteB_192</b>] [<b>-trusted_first</b>] [<b>-no_alt_chains</b>] [<b>-use_deltas</b>] [<b>-auth_level</b> <u>num</u>] [<b>-verify_depth</b> <u>num</u>]
       [<b>-verify_email</b> <u>email</u>] [<b>-verify_hostname</b> <u>hostname</u>] [<b>-verify_ip</b> <u>ip</u>] [<b>-verify_name</b> <u>name</u>] [<b>-x509_strict</b>]
       [<b>-issuer_checks</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This command handles data in CMS format such as S/MIME v3.1 email messages.  It can encrypt, decrypt,
       sign, verify, compress, uncompress, and print messages.

</pre><h4><b>OPTIONS</b></h4><pre>
       There are a number of operation options that set the type of operation to be performed: encrypt, decrypt,
       sign, verify, resign, sign_receipt, verify_receipt, digest_create, digest_verify, compress, uncompress,
       EncryptedData_encrypt, EncryptedData_decrypt, data_create, data_out, or cmsout.  The relevance of the
       other options depends on the operation type and their meaning may vary according to it.

       <b>-help</b>
           Print out a usage message.

   <b>General</b> <b>options</b>
       <b>-in</b> <u>filename</u>
           The input message to be encrypted or signed or the message to be decrypted or verified.

       <b>-out</b> <u>filename</u>
           The  message text that has been decrypted or verified or the output MIME format message that has been
           signed or verified.

       <b>-config</b> <u>configfile</u>
           See "Configuration Option" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1).

   <b>Operation</b> <b>options</b>
       <b>-encrypt</b>
           Encrypt data for the given recipient certificates. Input file is the message  to  be  encrypted.  The
           output file is the encrypted data in MIME format. The actual CMS type is <b>EnvelopedData</b>.

           Note  that  no  revocation check is done for the recipient cert, so if that key has been compromised,
           others may be able to decrypt the text.

       <b>-decrypt</b>
           Decrypt data using the supplied certificate and private key. Expects encrypted datain MIME format for
           the input file. The decrypted data is written to the output file.

       <b>-sign</b>
           Sign data using the supplied certificate and private key. Input file is the message to be signed. The
           signed data in MIME format is written to the output file.

       <b>-verify</b>
           Verify signed data. Expects a signed data on input and outputs the signed data. Both clear  text  and
           opaque signing is supported.

           By  default,  validation  of  signer  certificates  and their chain is done w.r.t. the S/MIME signing
           ("smimesign") purpose.  For details see "Certificate Extensions" in <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1).

       <b>-resign</b>
           Resign a message: take an existing message and one or more new signers.

       <b>-sign_receipt</b>
           Generate and output a signed receipt for the supplied message.  The  input  message  <b>must</b>  contain  a
           signed receipt request. Functionality is otherwise similar to the <b>-sign</b> operation.

       <b>-verify_receipt</b> <u>receipt</u>
           Verify  a  signed  receipt  in  filename <b>receipt</b>. The input message <b>must</b> contain the original receipt
           request. Functionality is otherwise similar to the <b>-verify</b> operation.

       <b>-digest</b> <u>digest</u>
           When used with <b>-sign</b>, provides the digest in hexadecimal  form  instead  of  computing  it  from  the
           original message content. Cannot be combined with <b>-in</b> or <b>-nodetach</b>.

           This  operation  is  the  CMS  equivalent of <b><a href="../man1/openssl-pkeyutl.1.html">openssl-pkeyutl</a></b>(1) signing.  When signing a pre-computed
           digest, the security relies on the digest  and  its  computation  from  the  original  message  being
           trusted.

       <b>-digest_create</b>
           Create a CMS <b>DigestedData</b> type.

       <b>-digest_verify</b>
           Verify a CMS <b>DigestedData</b> type and output the content.

       <b>-compress</b>
           Create a CMS <b>CompressedData</b> type. OpenSSL must be compiled with <b>zlib</b> support for this option to work,
           otherwise it will output an error.

       <b>-uncompress</b>
           Uncompress  a  CMS  <b>CompressedData</b>  type  and  output the content. OpenSSL must be compiled with <b>zlib</b>
           support for this option to work, otherwise it will output an error.

       <b>-EncryptedData_encrypt</b>
           Encrypt content using supplied symmetric key and algorithm using a CMS <b>EncryptedData</b> type and  output
           the content.

       <b>-EncryptedData_decrypt</b>
           Decrypt  content using supplied symmetric key and algorithm using a CMS <b>EncryptedData</b> type and output
           the content.

       <b>-data_create</b>
           Create a CMS <b>Data</b> type.

       <b>-data_out</b>
           <b>Data</b> type and output the content.

       <b>-cmsout</b>
           Takes an input message and writes out a PEM encoded CMS structure.

   <b>File</b> <b>format</b> <b>options</b>
       <b>-inform</b> <b>DER</b>|<b>PEM</b>|<b>SMIME</b>
           The input format of  the  CMS  structure  (if  one  is  being  read);  the  default  is  <b>SMIME</b>.   See
           <b><a href="../man1/openssl-format-options.1.html">openssl-format-options</a></b>(1) for details.

       <b>-outform</b> <b>DER</b>|<b>PEM</b>|<b>SMIME</b>
           The  output  format  of  the  CMS  structure  (if  one  is being written); the default is <b>SMIME</b>.  See
           <b><a href="../man1/openssl-format-options.1.html">openssl-format-options</a></b>(1) for details.

       <b>-rctform</b> <b>DER</b>|<b>PEM</b>|<b>SMIME</b>
           The  signed  receipt  format  for  use  with  the  <b>-receipt_verify</b>;  the  default  is   <b>SMIME</b>.    See
           <b><a href="../man1/openssl-format-options.1.html">openssl-format-options</a></b>(1) for details.

       <b>-stream</b>, <b>-indef</b>
           The  <b>-stream</b> and <b>-indef</b> options are equivalent and enable streaming I/O for encoding operations. This
           permits single pass processing of data without the need  to  hold  the  entire  contents  in  memory,
           potentially  supporting  very  large  files.  Streaming  is automatically set for S/MIME signing with
           detached data if the output format is <b>SMIME</b> it is currently off by default for all other operations.

       <b>-noindef</b>
           Disable streaming I/O where it would produce and indefinite length constructed encoding. This  option
           currently  has  no  effect. In future streaming will be enabled by default on all relevant operations
           and this option will disable it.

       <b>-binary</b>
           Normally the input message is converted to "canonical" format which is effectively using CR and LF as
           end of line: as required by the S/MIME specification. When this  option  is  present  no  translation
           occurs. This is useful when handling binary data which may not be in MIME format.

       <b>-crlfeol</b>
           Normally  the  output  file uses a single <b>LF</b> as end of line. When this option is present <b>CRLF</b> is used
           instead.

       <b>-asciicrlf</b>
           When signing use ASCII CRLF format canonicalisation. This strips trailing whitespace from all  lines,
           deletes  trailing  blank lines at EOF and sets the encapsulated content type. This option is normally
           used with detached content and an output signature format of DER. This option is not normally  needed
           when verifying as it is enabled automatically if the encapsulated content format is detected.

   <b>Keys</b> <b>and</b> <b>password</b> <b>options</b>
       <b>-pwri_password</b> <u>password</u>
           Specify password for recipient.

       <b>-secretkey</b> <u>key</u>
           Specify  symmetric  key  to  use.  The  key must be supplied in hex format and be consistent with the
           algorithm used. Supported by the <b>-EncryptedData_encrypt</b> <b>-EncryptedData_decrypt</b>, <b>-encrypt</b> and <b>-decrypt</b>
           options. When used with <b>-encrypt</b> or <b>-decrypt</b> the supplied key is used to wrap or unwrap  the  content
           encryption key using an AES key in the <b>KEKRecipientInfo</b> type.

       <b>-secretkeyid</b> <u>id</u>
           The  key  identifier  for  the supplied symmetric key for <b>KEKRecipientInfo</b> type.  This option <b>must</b> be
           present if the <b>-secretkey</b> option is used with <b>-encrypt</b>. With <b>-decrypt</b> operations the <u>id</u>  is  used  to
           locate the relevant key if it is not supplied then an attempt is used to decrypt any <b>KEKRecipientInfo</b>
           structures.

       <b>-inkey</b> <u>filename</u>|<u>uri</u>
           The  private key to use when signing or decrypting. This must match the corresponding certificate. If
           this option is not specified then the private key must be included in the certificate file  specified
           with  the  <b>-recip</b>  or  <b>-signer</b>  file.  When signing this option can be used multiple times to specify
           successive keys.

       <b>-passin</b> <u>arg</u>
           The  private  key  password  source.  For  more   information   about   the   format   of   <b>arg</b>   see
           <b><a href="../man1/openssl-passphrase-options.1.html">openssl-passphrase-options</a></b>(1).

       <b>-keyopt</b> <u>name</u>:<u>parameter</u>
           For  signing  and  encryption this option can be used multiple times to set customised parameters for
           the preceding key or certificate. It can currently be used to set RSA-PSS for signing,  RSA-OAEP  for
           encryption or to modify default parameters for ECDH.

       <b>-keyform</b> <b>DER</b>|<b>PEM</b>|<b>P12</b>|<b>ENGINE</b>
           The  format  of  the  private  key  file;  unspecified by default.  See <b><a href="../man1/openssl-format-options.1.html">openssl-format-options</a></b>(1) for
           details.

       <b>-engine</b> <u>id</u>
           See "Engine Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1).  This option is deprecated.

       <b>-provider</b> <u>name</u>
       <b>-provider-path</b> <u>path</u>
       <b>-propquery</b> <u>propq</u>
           See "Provider Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1), <b><a href="../man7/provider.7.html">provider</a></b>(7), and <b><a href="../man7/property.7.html">property</a></b>(7).

       <b>-rand</b> <u>files</u>, <b>-writerand</b> <u>file</u>
           See "Random State Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1) for details.

   <b>Encryption</b> <b>and</b> <b>decryption</b> <b>options</b>
       <b>-originator</b> <u>file</u>
           A certificate of the originator of the encrypted message. Necessary for decryption when Key Agreement
           is in use for a shared key. Currently, not allowed for encryption.

       <b>-recip</b> <u>file</u>
           When decrypting a message this specifies the certificate of  the  recipient.   The  certificate  must
           match one of the recipients of the message.

           When encrypting a message this option may be used multiple times to specify each recipient. This form
           <b>must</b> be used if customised parameters are required (for example to specify RSA-OAEP).

           Only certificates carrying RSA, Diffie-Hellman or EC keys are supported by this option.

       <u>recipient-cert</u> ...
           This is an alternative to using the <b>-recip</b> option when encrypting a message.  One or more certificate
           filenames may be given.

       <b>-</b><u><b>cipher</b></u>
           The  encryption algorithm to use. For example triple DES (168 bits) - <b>-des3</b> or 256 bit AES - <b>-aes256</b>.
           Any standard algorithm name (as used  by  the  <b>EVP_get_cipherbyname()</b>  function)  can  also  be  used
           preceded  by  a dash, for example <b>-aes-128-cbc</b>. See <b><a href="../man1/openssl-enc.1.html">openssl-enc</a></b>(1) for a list of ciphers supported by
           your version of OpenSSL.

           Currently the AES variants with GCM mode are the only supported AEAD algorithms.

           If not specified triple DES is used. Only used with <b>-encrypt</b> and <b>-EncryptedData_create</b> commands.

       <b>-wrap</b> <u>cipher</u>
           Cipher algorithm to use for key wrap  when  encrypting  the  message  using  Key  Agreement  for  key
           transport. The algorithm specified should be suitable for key wrap.

       <b>-aes128-wrap</b>, <b>-aes192-wrap</b>, <b>-aes256-wrap</b>, <b>-des3-wrap</b>
           Use  AES128,  AES192, AES256, or 3DES-EDE, respectively, to wrap key.  Depending on the OpenSSL build
           options used, <b>-des3-wrap</b> may not be supported.

       <b>-debug_decrypt</b>
           This option sets the <b>CMS_DEBUG_DECRYPT</b> flag. This option should be used with caution: see  the  notes
           section below.

   <b>Signing</b> <b>options</b>
       <b>-md</b> <u>digest</u>
           Digest  algorithm  to use when signing or resigning. If not present then the default digest algorithm
           for the signing key will be used (usually SHA1).

       <b>-signer</b> <u>file</u>
           A signing certificate.  When signing or resigning a message, this option can be used  multiple  times
           if more than one signer is required.

       <b>-certfile</b> <u>file</u>
           Allows additional certificates to be specified. When signing these will be included with the message.
           When verifying, these will be searched for signer certificates and will be used for chain building.

           The input can be in PEM, DER, or PKCS#12 format.

       <b>-cades</b>
           When  used  with <b>-sign</b>, add an ESS signingCertificate or ESS signingCertificateV2 signed-attribute to
           the SignerInfo, in order to make the signature  comply  with  the  requirements  for  a  CAdES  Basic
           Electronic Signature (CAdES-BES).

       <b>-nodetach</b>
           When  signing a message use opaque signing: this form is more resistant to translation by mail relays
           but it cannot be read by mail agents that do not  support  S/MIME.   Without  this  option  cleartext
           signing with the MIME type multipart/signed is used.

       <b>-nocerts</b>
           When signing a message the signer's certificate is normally included with this option it is excluded.
           This  will  reduce  the  size  of the signed message but the verifier must have a copy of the signers
           certificate available locally (passed using the <b>-certfile</b> option for example).

       <b>-noattr</b>
           Normally when a message is signed a set of attributes are included which include the signing time and
           supported symmetric algorithms. With this option they are not included.

       <b>-nosmimecap</b>
           Exclude the list of supported algorithms from signed attributes, other options such as  signing  time
           and content type are still included.

       <b>-receipt_request_all</b>, <b>-receipt_request_first</b>
           For  <b>-sign</b>  option  include  a  signed  receipt  request. Indicate requests should be provided by all
           recipient or first tier recipients (those mailed directly and not from a mailing  list).  Ignored  it
           <b>-receipt_request_from</b> is included.

       <b>-receipt_request_from</b> <u>emailaddress</u>
           For  <b>-sign</b>  option  include  a  signed  receipt request. Add an explicit email address where receipts
           should be supplied.

       <b>-receipt_request_to</b> <u>emailaddress</u>
           Add an explicit email address where signed receipts should be sent to. This option <b>must</b> but  supplied
           if a signed receipt is requested.

   <b>Verification</b> <b>options</b>
       <b>-signer</b> <u>file</u>
           If  a  message has been verified successfully then the signers certificate(s) will be written to this
           file if the verification was successful.

       <b>-content</b> <u>filename</u>
           This specifies a file containing the detached content for operations taking S/MIME input, such as the
           <b>-verify</b> command. This is only usable if the CMS structure is using the detached signature form  where
           the  content is not included. This option will override any content if the input format is S/MIME and
           it uses the multipart/signed MIME content type.

       <b>-no_content_verify</b>
           Do not verify signed content signatures.

       <b>-no_attr_verify</b>
           Do not verify signed attribute signatures.

       <b>-nosigs</b>
           Don't verify message signature.

       <b>-noverify</b>
           Do not verify the signers certificate of a signed message.

       <b>-nointern</b>
           When verifying a message normally certificates (if any) included in the message are searched for  the
           signing  certificate.  With  this  option only the certificates specified in the <b>-certfile</b> option are
           used.  The supplied certificates can still be used as untrusted CAs however.

       <b>-cades</b>
           When used with <b>-verify</b>, require and check signer certificate digest.  See the NOTES section for  more
           details.

       <b>-verify_retcode</b>
           Exit nonzero on verification failure.

       <b>-CAfile</b> <u>file</u>, <b>-no-CAfile</b>, <b>-CApath</b> <u>dir</u>, <b>-no-CApath</b>, <b>-CAstore</b> <u>uri</u>, <b>-no-CAstore</b>
           See "Trusted Certificate Options" in <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1) for details.

   <b>Output</b> <b>options</b>
       <b>-keyid</b>
           Use  subject  key  identifier  to identify certificates instead of issuer name and serial number. The
           supplied certificate <b>must</b> include a subject key identifier extension. Supported by <b>-sign</b> and <b>-encrypt</b>
           options.

       <b>-econtent_type</b> <u>type</u>
           Set the encapsulated content type to <u>type</u> if not supplied the <b>Data</b> type is used.  The  <u>type</u>  argument
           can be any valid OID name in either text or numerical format.

       <b>-text</b>
           This  option  adds  plain  text  (text/plain)  MIME  headers to the supplied message if encrypting or
           signing. If decrypting or verifying it strips off text headers: if the decrypted or verified  message
           is not of MIME type text/plain then an error occurs.

       <b>-certsout</b> <u>file</u>
           Any certificates contained in the input message are written to <u>file</u>.

       <b>-to</b>, <b>-from</b>, <b>-subject</b>
           The relevant email headers. These are included outside the signed portion of a message so they may be
           included  manually.  If  signing  then many S/MIME mail clients check the signers certificate's email
           address matches that specified in the From: address.

   <b>Printing</b> <b>options</b>
       <b>-noout</b>
           For the <b>-cmsout</b> operation do not output the parsed CMS structure.  This is useful if  the  syntax  of
           the CMS structure is being checked.

       <b>-print</b>
           For  the  <b>-cmsout</b> operation print out all fields of the CMS structure.  This implies <b>-noout</b>.  This is
           mainly useful for testing purposes.

       <b>-nameopt</b> <u>option</u>
           For the <b>-cmsout</b> operation when <b>-print</b> option is in use, specifies printing options for string fields.
           For most cases <b>utf8</b> is reasonable value.  See <b><a href="../man1/openssl-namedisplay-options.1.html">openssl-namedisplay-options</a></b>(1) for details.

       <b>-receipt_request_print</b>
           For the <b>-verify</b> operation print out the contents of any signed receipt requests.

   <b>Validation</b> <b>options</b>
       <b>-allow_proxy_certs</b>, <b>-attime</b>, <b>-no_check_time</b>, <b>-check_ss_sig</b>, <b>-crl_check</b>, <b>-crl_check_all</b>, <b>-explicit_policy</b>,
       <b>-extended_crl</b>, <b>-ignore_critical</b>, <b>-inhibit_any</b>, <b>-inhibit_map</b>, <b>-no_alt_chains</b>, <b>-partial_chain</b>, <b>-policy</b>,
       <b>-policy_check</b>, <b>-policy_print</b>, <b>-purpose</b>, <b>-suiteB_128</b>, <b>-suiteB_128_only</b>, <b>-suiteB_192</b>, <b>-trusted_first</b>,
       <b>-use_deltas</b>, <b>-auth_level</b>, <b>-verify_depth</b>, <b>-verify_email</b>, <b>-verify_hostname</b>, <b>-verify_ip</b>, <b>-verify_name</b>,
       <b>-x509_strict</b> <b>-issuer_checks</b>
           Set  various  options  of  certificate   chain   verification.    See   "Verification   Options"   in
           <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1) for details.

           Any validation errors cause the command to exit.

</pre><h4><b>NOTES</b></h4><pre>
       The  MIME  message  must  be  sent  without any blank lines between the headers and the output. Some mail
       programs will automatically add a blank line. Piping the mail directly to sendmail is one way to  achieve
       the correct format.

       The  supplied  message  to  be signed or encrypted must include the necessary MIME headers or many S/MIME
       clients won't display it properly (if at all). You can use the <b>-text</b> option to  automatically  add  plain
       text headers.

       A "signed and encrypted" message is one where a signed message is then encrypted. This can be produced by
       encrypting an already signed message: see the examples section.

       This  version  of  the  program only allows one signer per message but it will verify multiple signers on
       received messages. Some S/MIME clients choke if a message contains multiple signers. It  is  possible  to
       sign messages "in parallel" by signing an already signed message.

       The options <b>-encrypt</b> and <b>-decrypt</b> reflect common usage in S/MIME clients. Strictly speaking these process
       CMS enveloped data: CMS encrypted data is used for other purposes.

       The  <b>-resign</b>  option uses an existing message digest when adding a new signer. This means that attributes
       must be present in at least one existing signer using the same message  digest  or  this  operation  will
       fail.

       The  <b>-stream</b>  and  <b>-indef</b>  options  enable  streaming I/O support.  As a result the encoding is BER using
       indefinite length constructed encoding and no  longer  DER.  Streaming  is  supported  for  the  <b>-encrypt</b>
       operation and the <b>-sign</b> operation if the content is not detached.

       Streaming  is  always  used for the <b>-sign</b> operation with detached data but since the content is no longer
       part of the CMS structure the encoding remains DER.

       If the <b>-decrypt</b> option is used without a recipient certificate then an attempt  is  made  to  locate  the
       recipient  by  trying  each potential recipient in turn using the supplied private key. To thwart the MMA
       attack (Bleichenbacher's attack on PKCS #1 v1.5 RSA  padding)  all  recipients  are  tried  whether  they
       succeed  or  not  and  if  no  recipients  match the message is "decrypted" using a random key which will
       typically output garbage.  The <b>-debug_decrypt</b> option can be used to disable the MMA attack protection and
       return an error if no recipient can be found: this option should be  used  with  caution.  For  a  fuller
       description see <b><a href="../man3/CMS_decrypt.3.html">CMS_decrypt</a></b>(3)).

</pre><h4><b>CADES</b> <b>BASIC</b> <b>ELECTRONIC</b> <b>SIGNATURE</b> <b>(CADES-BES)</b></h4><pre>
       A  CAdES  Basic  Electronic  Signature (CAdES-BES), as defined in the European Standard ETSI EN 319 122-1
       V1.1.1, contains:

       •   The signed user data as defined in CMS (RFC 3852);

       •   Content-type of the EncapsulatedContentInfo value being signed;

       •   Message-digest of the eContent OCTET STRING within encapContentInfo being signed;

       •   An ESS signingCertificate or ESS signingCertificateV2 attribute,  as  defined  in  Enhanced  Security
           Services  (ESS), RFC 2634 and RFC 5035.  An ESS signingCertificate attribute only allows for SHA-1 as
           digest algorithm.  An ESS signingCertificateV2 attribute allows for any digest algorithm.

       •   The digital signature value computed on the user data and, when present, on the signed attributes.

           NOTE that the <b>-cades</b> option applies to the <b>-sign</b>  or  <b>-verify</b>  operations.   With  this  option,  the
           <b>-verify</b>  operation also requires that the signingCertificate attribute is present and checks that the
           given identifiers match the verification trust chain built during the verification process.

</pre><h4><b>EXIT</b> <b>CODES</b></h4><pre>
       0   The operation was completely successfully.

       1   An error occurred parsing the command options.

       2   One of the input files could not be read.

       3   An error occurred creating the CMS file or when reading the MIME message.

       4   An error occurred decrypting or verifying the message.

       5   The message was verified correctly but an error occurred writing out the signers certificates.

</pre><h4><b>COMPATIBILITY</b> <b>WITH</b> <b>PKCS#7</b> <b>FORMAT</b></h4><pre>
       <b><a href="../man1/openssl-smime.1.html">openssl-smime</a></b>(1) can only process the older <b>PKCS#7</b> format.  <b>openssl</b> <b>cms</b>  supports  Cryptographic  Message
       Syntax  format.   Use  of some features will result in messages which cannot be processed by applications
       which only support the older format. These are detailed below.

       The use of the <b>-keyid</b> option with <b>-sign</b> or <b>-encrypt</b>.

       The <b>-outform</b> <u>PEM</u> option uses different headers.

       The <b>-compress</b> option.

       The <b>-secretkey</b> option when used with <b>-encrypt</b>.

       The use of PSS with <b>-sign</b>.

       The use of OAEP or non-RSA keys with <b>-encrypt</b>.

       Additionally  the  <b>-EncryptedData_create</b>  and  <b>-data_create</b>  type  cannot  be  processed  by  the   older
       <b><a href="../man1/openssl-smime.1.html">openssl-smime</a></b>(1) command.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Create a cleartext signed message:

        openssl cms -sign -in message.txt -text -out mail.msg \
               -signer mycert.pem

       Create an opaque signed message

        openssl cms -sign -in message.txt -text -out mail.msg -nodetach \
               -signer mycert.pem

       Create a signed message, include some additional certificates and read the private key from another file:

        openssl cms -sign -in in.txt -text -out mail.msg \
               -signer mycert.pem -inkey mykey.pem -certfile mycerts.pem

       Create a signed message with two signers, use key identifier:

        openssl cms -sign -in message.txt -text -out mail.msg \
               -signer mycert.pem -signer othercert.pem -keyid

       Send a signed message under Unix directly to sendmail, including headers:

        openssl cms -sign -in in.txt -text -signer mycert.pem \
               -from <a href="mailto:steve@openssl.org">steve@openssl.org</a> -to someone@somewhere \
               -subject "Signed message" | sendmail someone@somewhere

       Verify a message and extract the signer's certificate if successful:

        openssl cms -verify -in mail.msg -signer user.pem -out signedtext.txt

       Send encrypted mail using triple DES:

        openssl cms -encrypt -in in.txt -from <a href="mailto:steve@openssl.org">steve@openssl.org</a> \
               -to someone@somewhere -subject "Encrypted message" \
               -des3 user.pem -out mail.msg

       Sign and encrypt mail:

        openssl cms -sign -in ml.txt -signer my.pem -text \
               | openssl cms -encrypt -out mail.msg \
               -from <a href="mailto:steve@openssl.org">steve@openssl.org</a> -to someone@somewhere \
               -subject "Signed and Encrypted message" -des3 user.pem

       Note:  the  encryption  command  does  not  include  the <b>-text</b> option because the message being encrypted
       already has MIME headers.

       Decrypt a message:

        openssl cms -decrypt -in mail.msg -recip mycert.pem -inkey key.pem

       The output from Netscape form signing is a PKCS#7 structure with the detached signature format.  You  can
       use this program to verify the signature by line wrapping the base64 encoded structure and surrounding it
       with:

        -----BEGIN PKCS7-----

        -----END PKCS7-----
       and using the command,

        openssl cms -verify -inform PEM -in signature.pem -content content.txt

       alternatively you can base64 decode the signature and use

        openssl cms -verify -inform DER -in signature.der -content content.txt

       Create an encrypted message using 128 bit Camellia:

        openssl cms -encrypt -in plain.txt -camellia128 -out mail.msg cert.pem

       Add a signer to an existing message:

        openssl cms -resign -in mail.msg -signer newsign.pem -out mail2.msg

       Sign a message using RSA-PSS:

        openssl cms -sign -in message.txt -text -out mail.msg \
               -signer mycert.pem -keyopt rsa_padding_mode:pss

       Create an encrypted message using RSA-OAEP:

        openssl cms -encrypt -in plain.txt -out mail.msg \
               -recip cert.pem -keyopt rsa_padding_mode:oaep

       Use SHA256 KDF with an ECDH certificate:

        openssl cms -encrypt -in plain.txt -out mail.msg \
               -recip ecdhcert.pem -keyopt ecdh_kdf_md:sha256

       Print CMS signed binary data in human-readable form:

       openssl cms -in signed.cms -binary -inform DER -cmsout -print

</pre><h4><b>BUGS</b></h4><pre>
       The  MIME  parser  isn't  very clever: it seems to handle most messages that I've thrown at it but it may
       choke on others.

       The code currently will only write out the signer's certificate to a file: if the signer has  a  separate
       encryption  certificate  this  must be manually extracted. There should be some heuristic that determines
       the correct encryption certificate.

       Ideally a database should be maintained of a certificates for each email address.

       The code doesn't currently take note of the permitted symmetric encryption algorithms as supplied in  the
       SMIMECapabilities  signed  attribute.  this means the user has to manually include the correct encryption
       algorithm. It should store the list of permitted ciphers in a database and only use those.

       No revocation checking is done on the signer's certificate.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ossl_store-file.7.html">ossl_store-file</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       The use of multiple <b>-signer</b> options and the <b>-resign</b> command were first added in OpenSSL 1.0.0.

       The <b>-keyopt</b> option was added in OpenSSL 1.0.2.

       Support for RSA-OAEP and RSA-PSS was added in OpenSSL 1.0.2.

       The use of non-RSA keys with <b>-encrypt</b> and <b>-decrypt</b> was added in OpenSSL 1.0.2.

       The -no_alt_chains option was added in OpenSSL 1.0.2b.

       The <b>-nameopt</b> option was added in OpenSSL 3.0.0.

       The <b>-engine</b> option was deprecated in OpenSSL 3.0.

       The <b>-digest</b> option was added in OpenSSL 3.2.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2008-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.4.1                                              2025-04-03                                  <u><a href="../man1SSL/OPENSSL-CMS.1SSL.html">OPENSSL-CMS</a></u>(1SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>