<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>traceroute - print the route packets trace to network host</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/traceroute">traceroute_2.1.6-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       traceroute - print the route packets trace to network host

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>traceroute</b> [<b>-46dFITUnreAV</b>] [<b>-f</b> <b>first_ttl</b>] [<b>-g</b> <b>gate,...</b>]
               [<b>-i</b> <b>device</b>] [<b>-m</b> <b>max_ttl</b>] [<b>-p</b> <b>port</b>] [<b>-s</b> <b>src_addr</b>]
               [<b>-q</b> <b>nqueries</b>] [<b>-N</b> <b>squeries</b>] [<b>-t</b> <b>tos</b>]
               [<b>-l</b> <b>flow_label</b>] [<b>-w</b> <b>waittimes</b>] [<b>-z</b> <b>sendwait</b>] [<b>-UL</b>] [<b>-D</b>]
               [<b>-P</b> <b>proto</b>] [<b>--sport=port</b>] [<b>-M</b> <b>method</b>] [<b>-O</b> <b>mod_options</b>]
               [<b>--mtu</b>] [<b>--back</b>]
               <b>host</b> [<b>packet_len</b>]
       <b>traceroute6</b>  [<u>options</u>]
       <b>tcptraceroute</b>  [<u>options</u>]
       <b>lft</b>  [<u>options</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>traceroute</u>  tracks  the  route packets taken from an IP network on their way to a given host. It utilizes
       the IP protocol's time to live (TTL) field and attempts to elicit an  ICMP  TIME_EXCEEDED  response  from
       each gateway along the path to the host.

       <u>traceroute6</u> is equivalent to <u>traceroute</u> <b>-6</b>

       <u>tcptraceroute</u> is equivalent to <u>traceroute</u> <b>-T</b>

       <u>lft</u>  , the Layer Four Traceroute, performs a TCP traceroute, like <u>traceroute</u> <b>-T</b> , but attempts to provide
       compatibility with the original such implementation, also called "lft".

       The only required parameter  is  the  name  or  IP  address  of  the  destination  <b>host</b> .   The  optional
       <b>packet_len</b>`gth  is  the total size of the probing packet (default 60 bytes for IPv4 and 80 for IPv6). The
       specified size can be ignored in some situations or increased up to a minimal value.

       This program attempts to trace the route an IP packet would follow to some  internet  host  by  launching
       probe  packets  with  a  small ttl (time to live) then listening for an ICMP "time exceeded" reply from a
       gateway.  We start our probes with a ttl of  one  and  increase  by  one  until  we  get  an  ICMP  "port
       unreachable"  (or TCP reset), which means we got to the "host", or hit a max (which defaults to 30 hops).
       Three probes (by default) are sent at each ttl setting and a line is printed showing the ttl, address  of
       the gateway and round trip time of each probe. The address can be followed by additional information when
       requested.  If the probe answers come from different gateways, the address of each responding system will
       be printed.  If there is no response within a certain timeout, an "*"  (asterisk)  is  printed  for  that
       probe.

       After  the trip time, some additional annotation can be printed: <b>!H</b>, <b>!N</b>, or <b>!P</b> (host, network or protocol
       unreachable), <b>!S</b> (source route failed), <b>!F</b> (fragmentation  needed),  <b>!X</b>  (communication  administratively
       prohibited),  <b>!V</b>  (host  precedence  violation),  <b>!C</b>  (precedence  cutoff  in  effect),  or  <b>!&lt;num&gt;</b> (ICMP
       unreachable code &lt;num&gt;).  If almost all the probes result in some kind of  unreachable,  traceroute  will
       give up and exit.

       We don't want the destination host to process the UDP probe packets, so the destination port is set to an
       unlikely  value  (you  can  change  it  with  the  <b>-p</b>  flag).  There is no such a problem for ICMP or TCP
       tracerouting (for TCP we use half-open technique, which prevents our probes to be seen by applications on
       the destination host).

       In the modern network environment the traditional  traceroute  methods  can  not  be  always  applicable,
       because  of  widespread  use  of firewalls.  Such firewalls filter the "unlikely" UDP ports, or even ICMP
       echoes.  To solve this, some additional tracerouting methods are implemented (including tcp), see <b>LIST</b> <b>OF</b>
       <b>AVAILABLE</b> <b>METHODS</b> below. Such methods try to use particular  protocol  and  source/destination  port,  in
       order to bypass firewalls (to be seen by firewalls just as a start of allowed type of a network session).

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--help</b> Print help info and exit.

       <b>-4</b>, <b>-6</b> Explicitly  force  IPv4 or IPv6 tracerouting. By default, the program will try to resolve the name
              given, and choose the appropriate protocol automatically. If resolving a host  name  returns  both
              IPv4 and IPv6 addresses, <u>traceroute</u> will use IPv4.

       <b>-I,</b> <b>--icmp</b>
              Use ICMP ECHO for probes

       <b>-T,</b> <b>--tcp</b>
              Use TCP SYN for probes

       <b>-d,</b> <b>--debug</b>
              Enable socket level debugging (when the Linux kernel supports it)

       <b>-F,</b> <b>--dont-fragment</b>
              Do not fragment probe packets. (For IPv4 it also sets DF bit, which tells intermediate routers not
              to fragment remotely as well).

              Varying  the size of the probing packet by the <b>packet_len</b> command line parameter, you can manually
              obtain information about the MTU of individual network hops. The <b>--mtu</b> option (see below) tries to
              do this automatically.

              Note, that non-fragmented features (like <b>-F</b> or <b>--mtu</b>) work properly since the Linux kernel  2.6.22
              only.   Before  that  version,  IPv6 was always fragmented, IPv4 could use the once the discovered
              final mtu only (from the route cache), which can be less than the actual mtu of a device.

       <b>-f</b> <u>first_ttl</u><b>,</b> <b>--first=</b><u>first_ttl</u>
              Specifies with what TTL to start. Defaults to 1.

       <b>-g</b> <u>gateway</u><b>,</b> <b>--gateway=</b><u>gateway</u>
              Tells traceroute to add an IP source routing option to the outgoing packet that tells the  network
              to  route  the packet through the specified <u>gateway</u> (most routers have disabled source routing for
              security reasons).  In general, several <u>gateway</u>'s is allowed (comma separated). For IPv6, the form
              of <u>num</u><b>,</b><u>addr</u><b>,</b><u>addr...</u>  is allowed, where <u>num</u> is a route header type (default is type  2).  Note  the
              type 0 route header is now deprecated (rfc5095).

       <b>-i</b> <u>interface</u><b>,</b> <b>--interface=</b><u>interface</u>
              Specifies the interface through which <u>traceroute</u> should send packets. By default, the interface is
              selected according to the routing table.

       <b>-m</b> <u>max_ttl</u><b>,</b> <b>--max-hops=</b><u>max_ttl</u>
              Specifies  the  maximum number of hops (max time-to-live value) <u>traceroute</u> will probe. The default
              is 30.

       <b>-N</b> <u>squeries</u><b>,</b> <b>--sim-queries=</b><u>squeries</u>
              Specifies  the  number  of  probe  packets  sent  out  simultaneously.   Sending  several   probes
              concurrently can speed up <u>traceroute</u> considerably. The default value is 16.
              Note  that some routers and hosts can use ICMP rate throttling. In such a situation specifying too
              large number can lead to loss of some responses.

       <b>-n</b>     Do not try to map IP addresses to host names when displaying them.

       <b>-p</b> <u>port</u><b>,</b> <b>--port=</b><u>port</u>
              For UDP tracing, specifies the destination port base <u>traceroute</u> will  use  (the  destination  port
              number will be incremented by each probe).
              For ICMP tracing, specifies the initial ICMP sequence value (incremented by each probe too).
              For  TCP  and  others  specifies  just  the (constant) destination port to connect. When using the
              tcptraceroute wrapper, -p specifies the source port.

       <b>-t</b> <u>tos</u><b>,</b> <b>--tos=</b><u>tos</u>
              For IPv4, set the Type of Service (TOS) and Precedence value. Useful values are 16 (low delay) and
              8 (high throughput). Note that in order to use some TOS precedence values, you have  to  be  super
              user.
              For IPv6, set the Traffic Control value.

       <b>-l</b> <u>flow_label</u><b>,</b> <b>--flowlabel=</b><u>flow_label</u>
              Use specified flow_label for IPv6 packets.

       <b>-w</b> <u>max</u>[<b>,</b><u>here</u><b>,</b><u>near</u>]<b>,</b> <b>--wait=</b><u>max</u>[<b>,</b><u>here</u><b>,</b><u>near</u>]
              Determines how long to wait for a response to a probe.

              There  are  three  (in general) float values separated by a comma (or a slash).  <u>Max</u> specifies the
              maximum time (in seconds, default 5.0) to wait, in any case.

              Traditional traceroute implementation always waited whole <u>max</u> seconds for any  probe.  But  if  we
              already have some replies from the <b>same</b> hop, or even from some <b>next</b> hop, we can use the round trip
              time of such a reply as a hint to determine the actual reasonable amount of time to wait.

              The  optional  <u>here</u> (default 3.0) specifies a factor to multiply the round trip time of an already
              received response from the <b>same</b> hop. The resulting value is used  as  a  timeout  for  the  probe,
              instead  of  (but  no more than) <u>max</u>.  The optional <u>near</u> (default 10.0) specifies a similar factor
              for a response from some <b>next</b> hop.  (The time of the first found result is used in both cases).

              First, we look for the <b>same</b> hop (of the probe which will be printed first from now).   If  nothing
              found,  then  look  for  some  <b>next</b> hop. If nothing found, use <u>max</u>.  If <u>here</u> and/or <u>near</u> have zero
              values, the corresponding computation is skipped.
              <u>Here</u> and <u>near</u> are always set to zero if only <u>max</u> is specified  (for  compatibility  with  previous
              versions).

       <b>-q</b> <u>nqueries</u><b>,</b> <b>--queries=</b><u>nqueries</u>
              Sets the number of probe packets per hop. The default is 3.

       <b>-r</b>     Bypass  the normal routing tables and send directly to a host on an attached network.  If the host
              is not on a directly-attached network, an error is returned.  This option can be used  to  ping  a
              local host through an interface that has no route through it.

       <b>-s</b> <u>source_addr</u><b>,</b> <b>--source=</b><u>source_addr</u>
              Chooses  an  alternative  source  address.  Note  that  you  must select the address of one of the
              interfaces.  By default, the address of the outgoing interface is used.

       <b>-z</b> <u>sendwait</u><b>,</b> <b>--sendwait=</b><u>sendwait</u>
              Minimal time interval between probes (default 0).  If the value is more than 10, then it specifies
              a number in milliseconds, else it is a number of seconds (float point values allowed too).  Useful
              when some routers use rate-limit for ICMP messages.

       <b>-e,</b> <b>--extensions</b>
              Show ICMP extensions (rfc4884). The general form is <u>CLASS</u><b>/</b><u>TYPE</u><b>:</b> followed by  a  hexadecimal  dump.
              The  MPLS  (rfc4950) is shown parsed, in a form: <b>MPLS:L=</b><u>label</u><b>,E=</b><u>exp_use</u><b>,S=</b><u>stack_bottom</u><b>,T=</b><u>TTL</u> (more
              objects separated by <b>/</b> ). The Interface Information (rfc5837)  is  shown  parsed  as  well,  in  a
              following form: {<b>INC</b>|<b>SUB</b>|<b>OUT</b>|<b>NXT</b>}<b>:</b><u>index</u><b>,</b><u>IP_addr</u><b>,"</b><u>name</u><b>",mtu=</b><u>MTU</u> (all four fields may be missing).

       <b>-A,</b> <b>--as-path-lookups</b>
              Perform  AS  path lookups in routing registries and print results directly after the corresponding
              addresses.

       <b>-V,</b> <b>--version</b>
              Print the version and exit.

       There are additional options intended for advanced usage (such as alternate trace methods etc.):

       <b>--sport</b>=<u>port</u>
              Chooses the source port to use. Implies <b>-N</b> <b>1</b> -w 5 .  Normally source  ports  (if  applicable)  are
              chosen by the system.

       <b>--fwmark</b>=<u>mark</u>
              Set the firewall mark for outgoing packets (since the Linux kernel 2.6.25).

       <b>-M</b> <u>method</u><b>,</b> <b>--module=</b><u>name</u>
              Use  specified  method for traceroute operations. Default traditional udp method has name <u>default</u>,
              icmp (<b>-I</b>) and tcp (<b>-T</b>) have names <u>icmp</u> and <u>tcp</u> respectively.
              Method-specific options can be passed by <b>-O</b> .  Most methods have their simple shortcuts, (<b>-I</b> means
              <b>-M</b> <b>icmp</b>, etc).

       <b>-O</b> <u>option</u><b>,</b> <b>--options=</b><u>options</u>
              Specifies some method-specific option. Several options are separated by comma (or use  several  <b>-O</b>
              on  cmdline).   Each  method  may have its own specific options, or many not have them at all.  To
              print information about available options, use <b>-O</b> <b>help</b>.

       <b>-U,</b> <b>--udp</b>
              Use UDP to particular destination port for tracerouting (instead of increasing the port  per  each
              probe). Default port is 53 (dns).

       <b>-UL</b>    Use UDPLITE for tracerouting (default port is 53).

       <b>-D,</b> <b>--dccp</b>
              Use DCCP Requests for probes.

       <b>-P</b> <u>protocol</u><b>,</b> <b>--protocol=</b><u>protocol</u>
              Use raw packet of specified protocol for tracerouting. Default protocol is 253 (rfc3692).

       <b>--mtu</b>  Discover  MTU  along the path being traced. Implies <b>-F</b> <b>-N</b> <b>1</b>.  New <u>mtu</u> is printed once in a form of
              <b>F=</b><u>NUM</u> at the first probe of a hop which requires such <u>mtu</u> to be reached. (Actually, the correspond
              "frag needed" icmp message normally is sent by the previous hop).

              Note, that some routers might cache once the seen information on a  fragmentation.  Thus  you  can
              receive  the final mtu from a closer hop.  Try to specify an unusual <u>tos</u> by <b>-t</b> , this can help for
              one attempt (then it can be cached there as well).
              See <b>-F</b> option for more info.

       <b>--back</b> Print the number of backward hops when it seems different with the forward direction. This  number
              is guessed in assumption that remote hops send reply packets with initial ttl set to either 64, or
              128 or 255 (which seems a common practice). It is printed as a negate value in a form of '-NUM' .

</pre><h4><b>LIST</b> <b>OF</b> <b>AVAILABLE</b> <b>METHODS</b></h4><pre>
       In general, a particular traceroute method may have to be chosen by <b>-M</b> <b>name</b>, but most of the methods have
       their simple cmdline switches (you can see them after the method name, if present).

   <b>default</b>
       The traditional, ancient method of tracerouting. Used by default.

       Probe  packets are udp datagrams with so-called "unlikely" destination ports.  The "unlikely" port of the
       first probe is 33434, then for each next probe it is incremented by one. Since the ports are expected  to
       be  unused, the destination host normally returns "icmp unreach port" as a final response.  (Nobody knows
       what happens when some application listens for such ports, though).

       This method is allowed for unprivileged users.

   <b>icmp</b>       <b>-I</b>
       Most usual method for now, which uses icmp echo packets for probes.
       If you can <a href="../man8/ping.8.html">ping</a>(8) the destination host, icmp tracerouting is applicable as well.

       This method may be allowed for unprivileged users since the kernel 3.0 (IPv4, for IPv6 since 3.11), which
       supports  new  <u>dgram</u>  <u>icmp</u>  (or  "<u>ping</u>")  sockets.  To  allow  such  sockets,  sysadmin  should   provide
       <u>net/ipv4/ping_group_range</u> sysctl range to match any group of the user.
       Options:

       <b>raw</b>    Use only raw sockets (the traditional way).
              This  way  is  tried  first by default (for compatibility reasons), then new dgram icmp sockets as
              fallback.

       <b>dgram</b>  Use only dgram icmp sockets.

   <b>tcp</b>        <b>-T</b>
       Well-known modern method, intended to bypass firewalls.
       Uses the constant destination port (default is 80, http).

       If some filters are present in the network path, then most probably any  "unlikely"  udp  ports  (as  for
       <u>default</u>  method) or even icmp echoes (as for <u>icmp</u>) are filtered, and whole tracerouting will just stop at
       such a firewall.  To bypass a network filter, we have to use only allowed protocol/port combinations.  If
       we trace for some, say, mailserver, then more likely <b>-T</b> <b>-p</b> <b>25</b> can reach it, even when <b>-I</b> can not.

       This  method  uses  well-known "half-open technique", which prevents applications on the destination host
       from seeing our probes at all.  Normally, a tcp syn is sent. For non-listened ports we receive tcp reset,
       and all is done. For active listening ports we receive tcp syn+ack, but answer by tcp reset  (instead  of
       expected  tcp  ack),  this way the remote tcp session is dropped even without the application ever taking
       notice.

       There is a couple of options for <u>tcp</u> method:

       <b>syn,ack,fin,rst,psh,urg,ece,cwr</b>
              Sets specified tcp flags for probe packet, in any combination.

       <b>flags</b>=<u>num</u>
              Sets the flags field in the tcp header exactly to <u>num</u>.

       <b>ecn</b>    Send syn packet with tcp flags ECE and CWR (for Explicit Congestion Notification, rfc3168).

       <b>sack,timestamps,window_scaling</b>
              Use the corresponding tcp header option in the outgoing probe packet.

       <b>sysctl</b> Use current sysctl (<u><a href="file:/proc/sys/net/">/proc/sys/net/</a>*</u>) setting for the tcp header options above and <b>ecn</b>.  Always set
              by default, if nothing else specified.

       <b>fastopen</b>
              Use fastopen tcp option (when <b>syn</b>), for initial cookie negotiation only.

       <b>mss</b>=[<u>num</u>]
              Use value of <u>num</u> (or unchanged) for maxseg tcp header option (when <b>syn</b>), and discover its clamping
              along the path being traced.  New changed <u>mss</u> is printed once in a form  of  <b>M=</b><u>NUM</u>  at  the  first
              probe  on which it was detected.  Note, some routers may return too short original fragment in the
              time exceeded message, making the check impossible.  Besides that the  responses  may  come  in  a
              different  order.   All  this can lead to a later place of the report (using <b>-N</b> <b>1</b> can help for the
              order).

       <b>info</b>   Print tcp flags and supported options of final tcp  replies  when  the  target  host  is  reached.
              Allows  to  determine  whether an application listens the port and other useful things.  Supported
              tcp options are all that can be set by <b>-T</b> <b>-O</b>,  ie.   <u>mss</u>,  <u>sack</u>,  <u>timestamps</u>,  <u>window_scaling</u>  and
              <u>fastopen</u>, with the similar output format (a value for <u>mss</u> and just presence for others).

       Default options is <b>syn,sysctl</b>.

   <b>tcpconn</b>
       An  initial  implementation  of  tcp  method,  simple  using <a href="../man2/connect.2.html">connect</a>(2) call, which does full tcp session
       opening. Not recommended for normal use, because a destination application is always affected (and can be
       confused).

   <b>udp</b>        <b>-U</b>
       Use udp datagram with constant destination port (default 53, dns).
       Intended to bypass firewall as well.

       Note, that unlike in <u>tcp</u> method, the correspond application on the destination host  <b>always</b>  receive  our
       probes (with random data), and most can easily be confused by them. Most cases it will not respond to our
       packets though, so we will never see the final hop in the trace. (Fortunately, it seems that at least dns
       servers replies with something angry).

       This method is allowed for unprivileged users.

   <b>udplite</b>    <b>-UL</b>
       Use udplite datagram for probes (with constant destination port, default 53).

       This method is allowed for unprivileged users.
       Options:

       <b>coverage</b>=<u>num</u>
              Set udplite send coverage to <u>num</u>.

   <b>dccp</b>    <b>-D</b>
       Use DCCP Request packets for probes (rfc4340).

       This method uses the same "half-open technique" as used for TCP.  The default destination port is 33434.

       Options:

       <b>service</b>=<u>num</u>
              Set DCCP service code to <u>num</u> (default is 1885957735).

   <b>raw</b>        <b>-P</b> <b>proto</b>
       Send raw packet of protocol <u>proto</u>.
       No protocol-specific headers are used, just IP header only.
       Implies <b>-N</b> <b>1</b> -w 5 .
       Options:

       <b>protocol</b>=<u>proto</u>
              Use IP protocol <u>proto</u> (default 253).

</pre><h4><b>NOTES</b></h4><pre>
       To  speed  up  work,  normally  several  probes are sent simultaneously.  On the other hand, it creates a
       "storm of packages", especially in the reply direction. Routers can throttle the rate of icmp  responses,
       and  some  of replies can be lost. To avoid this, decrease the number of simultaneous probes, or even set
       it to 1 (like in initial traceroute implementation), i.e.  <b>-N</b> <b>1</b>

       The final (target) host can drop some of the simultaneous probes, and might even answer only  the  latest
       ones.  It  can  lead  to  extra "looks like expired" hops near the final hop. We use a smart algorithm to
       auto-detect such a situation, but if it cannot help in your case, just use <b>-N</b> <b>1</b> too.

       For even greater stability you can slow down the program's work by <b>-z</b> option, for example use <b>-z</b> <b>0.5</b>  for
       half-second pause between probes.

       To  avoid  an extra waiting, we use adaptive algorithm for timeouts (see <b>-w</b> option for more info). It can
       lead to premature expiry (especially when response times differ at times) and printing "*" instead  of  a
       time.  In  such  a  case,  switch this algorithm off, by specifying <b>-w</b> with the desired timeout only (for
       example, <b>-w</b> <b>5</b>).

       If some hops report nothing for every method, the last chance to obtain  something  is  to  use  <b>ping</b>  <b>-R</b>
       command (IPv4, and for nearest 8 hops only).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/ping.8.html">ping</a></b>(8), <b><a href="../man8/ping6.8.html">ping6</a></b>(8), <b><a href="../man8/tcpdump.8.html">tcpdump</a></b>(8), <b><a href="../man8/netstat.8.html">netstat</a></b>(8)

Traceroute                                       11 October 2006                                   <u><a href="../man1/TRACEROUTE.1.html">TRACEROUTE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>