<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cvtsudoers — convert between sudoers file formats</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/sudo-ldap">sudo-ldap_1.9.16p2-1ubuntu1.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cvtsudoers — convert between sudoers file formats

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>cvtsudoers</b>   [<b>-ehMpV</b>]  [<b>-b</b>  <u>dn</u>]  [<b>-c</b>  <u>conf_file</u>]  [<b>-d</b>  <u>deftypes</u>]  [<b>-f</b>  <u>output_format</u>]  [<b>-i</b>  <u>input_format</u>]
                  [<b>-I</b> <u>increment</u>] [<b>-l</b> <u>log_file</u>] [<b>-m</b>  <u>filter</u>]  [<b>-o</b>  <u>output_file</u>]  [<b>-O</b>  <u>start_point</u>]  [<b>-P</b>  <u>padding</u>]
                  [<b>-s</b> <u>sections</u>] [<u>input_file</u> <u>...</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>cvtsudoers</b>  utility accepts one or more security policies in either <u>sudoers</u> or LDIF format as input,
       and generates a single policy of the specified format as output.  The default input  format  is  <u>sudoers.</u>
       The  default  output  format is LDIF.  It is only possible to convert a policy file that is syntactically
       correct.

       If no <u>input_file</u> is specified, or if it is ‘-’, the policy is read from the standard input.  Input  files
       may  be  optionally prefixed with a host name followed by a colon (‘:’) to make the policy rules specific
       to a host when merging multiple files.  By default, the result is written to the standard output.

       The options are as follows:

       <b>-b</b> <u>dn</u>, <b>--base</b>=<u>dn</u>
               The base DN (distinguished name) that will be used when performing LDAP queries.  Typically  this
               is  of the form “ou=SUDOers,dc=my-domain,dc=com” for the domain my-domain.com.  If this option is
               not specified, the value of the SUDOERS_BASE environment variable will  be  used  instead.   Only
               necessary when converting to LDIF format.

       <b>-c</b> <u>conf_file</u>, <b>--config</b>=<u>conf_file</u>
               Specify the path to the configuration file.  Defaults to <u>/etc/cvtsudoers.conf</u>.

       <b>-d</b> <u>deftypes</u>, <b>--defaults</b>=<u>deftypes</u>
               Only  convert  <u>Defaults</u>  entries  of  the  specified  types.   One  or more <u>Defaults</u> types may be
               specified, separated by a comma (‘,’).  The supported types are:

               all      All Defaults entries.

               global   Global Defaults entries that are applied regardless of user, runas, host, or command.

               user     Per-user Defaults entries.

               runas    Per-runas user Defaults entries.

               host     Per-host Defaults entries.

               command  Per-command Defaults entries.

               See the <b>Defaults</b> section in <u><a href="../man5/sudoers.5.html">sudoers</a></u>(5) for more information.

               If the <b>-d</b> option is not specified, all <u>Defaults</u> entries will be converted.

       <b>-e</b>, <b>--expand-aliases</b>
               Expand aliases in <u>input_file</u>.  Aliases are preserved by default when the output <u>format</u> is JSON or
               sudoers.

       <b>-f</b> <u>output_format</u>, <b>--output-format</b>=<u>output_format</u>
               Specify the output format (case-insensitive).  The following formats are supported:

               CSV      CSV (comma-separated value) files are often used by spreadsheets and report  generators.
                        See “CSV output format” for more details.

               JSON     JSON  (JavaScript Object Notation) files are usually easier for third-party applications
                        to consume than the traditional <u>sudoers</u> format.  The various values have explicit  types
                        which removes much of the ambiguity of the <u>sudoers</u> format.  See “JSON output format” for
                        more details.

               LDIF     LDIF  (LDAP  Data  Interchange Format) files can be imported into an LDAP server for use
                        with <u><a href="../man5/sudoers.ldap.5.html">sudoers.ldap</a></u>(5).

                        Conversion to LDIF has the following limitations:

                        <b>•</b>  Command, host, runas, and user-specific Defaults lines cannot be translated  as  they
                           don't have an equivalent in the sudoers LDAP schema.

                        <b>•</b>  Command,  host,  runas, and user aliases are not supported by the sudoers LDAP schema
                           so they are expanded during the conversion.

               sudoers  Traditional sudoers format.  A new sudoers file will be reconstructed  from  the  parsed
                        input  file.   Comments are not preserved and data from any include files will be output
                        inline.

       <b>--group-file</b>=<u>file</u>
               When the <b>-M</b> option is also specified, perform group queries using  <u>file</u>  instead  of  the  system
               group database.

       <b>-h</b>, <b>--help</b>
               Display a short help message to the standard output and exit.

       <b>-i</b> <u>input_format</u>, <b>--input-format</b>=<u>input_format</u>
               Specify the input format.  The following formats are supported:

               LDIF     LDIF (LDAP Data Interchange Format) files can be exported from an LDAP server to convert
                        security  policies  used  by  <u><a href="../man5/sudoers.ldap.5.html">sudoers.ldap</a></u>(5).   If  a  base  DN (distinguished name) is
                        specified, only sudoRole objects that match the base DN  will  be  processed.   Not  all
                        sudoOptions specified in a sudoRole can be translated from LDIF to sudoers format.

               sudoers  Traditional sudoers format.  This is the default input format.

       <b>-I</b> <u>increment</u>, <b>--increment</b>=<u>increment</u>
               When  generating  LDIF  output,  increment  each  sudoOrder  attribute  by  the specified number.
               Defaults to an increment of 1.

       <b>-l</b> <u>log_file</u>, <b>--logfile</b>=<u>log_file</u>
               Log conversion warnings to <u>log_file</u> instead of to  the  standard  error.   This  is  particularly
               useful when merging multiple <u>sudoers</u> files, which can generate a large number of warnings.

       <b>-m</b> <u>filter</u>, <b>--match</b>=<u>filter</u>
               Only output rules that match the specified <u>filter</u>.  A <u>filter</u> expression is made up of one or more
               <b>key</b>  <b>=</b>  <u>value</u>  pairs,  separated  by  a  comma  (‘,’).  The <b>key</b> may be “cmnd” (or “cmd”), “host”,
               “group”, or “user”.  For example, <b>user</b> = <u>operator</u> or  <b>host</b>  =  <u>www</u>.   An  upper-case  <u>Cmnd_Alias</u>,
               <u>Host_alias</u>, or <u>User_Alias</u> may be specified as the “cmnd”, “host”, or “user”.

               A  matching  <u>sudoers</u>  rule  may  also  include  users, groups, and hosts that are not part of the
               <u>filter</u>.  This can happen when a rule includes multiple users, groups, or hosts.  To prune out any
               non-matching user, group, or host from the rules, the <b>-p</b> option may be used.

               By default, the password and group databases are not consulted when matching against  the  filter
               so  the users and groups do not need to be present on the local system (see the <b>-M</b> option).  Only
               aliases that are referenced by the filtered policy rules will be displayed.

       <b>-M</b>, <b>--match-local</b>
               When the <b>-m</b> option is also specified, use password and group database information  when  matching
               users  and  groups  in  the  filter.  Only users and groups in the filter that exist on the local
               system will match, and a user's groups will automatically be added to the filter.  If the  <b>-M</b>  is
               <u>not</u>  specified,  users and groups in the filter do not need to exist on the local system, but all
               groups used for matching must be explicitly listed in the filter.

       <b>-o</b> <u>output_file</u>, <b>--output</b>=<u>output_file</u>
               Write the converted output to <u>output_file</u>.  If no <u>output_file</u> is specified, or if it is ‘-’,  the
               converted <u>sudoers</u> policy will be written to the standard output.

       <b>-O</b> <u>start_point</u>, <b>--order-start</b>=<u>start_point</u>
               When  generating  LDIF output, use the number specified by <u>start_point</u> in the sudoOrder attribute
               of the first sudoRole object.  Subsequent sudoRole object use  a  sudoOrder  value  generated  by
               adding  an  <u>increment</u>,  see  the  <b>-I</b>  option  for details.  Defaults to a starting point of 1.  A
               starting point of 0 will disable the generation of sudoOrder attributes  in  the  resulting  LDIF
               file.

       <b>--passwd-file</b>=<u>file</u>
               When  the  <b>-M</b>  option  is also specified, perform passwd queries using <u>file</u> instead of the system
               passwd database.

       <b>-p</b>, <b>--prune-matches</b>
               When the <b>-m</b> option is also specified, <b>cvtsudoers</b> will prune out non-matching users,  groups,  and
               hosts from matching entries.

       <b>-P</b> <u>padding</u>, <b>--padding</b>=<u>padding</u>
               When  generating  LDIF output, construct the initial sudoOrder value by concatenating <u>order_start</u>
               and <u>increment</u>, padding the <u>increment</u> with  zeros  until  it  consists  of  <u>padding</u>  digits.   For
               example, if <u>order_start</u> is 1027, <u>padding</u> is 3, and <u>increment</u> is 1, the value of sudoOrder for the
               first  entry  will  be  1027000,  followed  by  1027001, 1027002, etc.  If the number of sudoRole
               entries is larger than the padding would allow, <b>cvtsudoers</b> will exit with an error.  By  default,
               no padding is performed.

       <b>-s</b> <u>sections</u>, <b>--suppress</b>=<u>sections</u>
               Suppress  the  output of specific <u>sections</u> of the security policy.  One or more section names may
               be specified, separated by a comma (‘,’).  The supported section name are: <b>defaults</b>, <b>aliases</b>  and
               <b>privileges</b> (which may be shortened to <b>privs</b>).

       <b>-V</b>, <b>--version</b>
               Print the <b>cvtsudoers</b> and <u>sudoers</u> grammar versions and exit.

   <b>Merging</b> <b>multiple</b> <b>files</b>
       When multiple input files are specified, <b>cvtsudoers</b> will attempt to merge them into a single policy file.
       It is assumed that user and group names are consistent among the policy files to be merged.  For example,
       user “bob” on one host is the same as user “bob” on another host.

       When  merging policy files, it is possible to prefix the input file name with a host name, separated by a
       colon (‘:’).  When the files are merged, the host name will be used to restrict the policy rules to  that
       specific host where possible.

       The merging process is performed as follows:

       <b>•</b>  Each input file is parsed into internal sudoers data structures.

       <b>•</b>  Aliases are merged and renamed as necessary to avoid conflicts.  In the event of a conflict, the first
          alias  found  is  left as-is and subsequent aliases of the same name are renamed with a numeric suffix
          separated with a underscore (‘_’).  For example, if there are two different aliases named SERVERS, the
          first will be left as-is and the second will be renamed SERVERS_1.  References to  the  renamed  alias
          are also updated in the policy file.  Duplicate aliases (those with identical contents) are pruned.

       <b>•</b>  Defaults  settings  are  merged  and  duplicates  are removed.  If there are conflicts in the Defaults
          settings, a warning is emitted for each conflict.  If a host name is specified with  the  input  file,
          <b>cvtsudoers</b>  will  change  the global Defaults settings in that file to be host-specific.  A warning is
          emitted for command, user, or runas-specific Defaults settings which cannot be made host-specific.

       <b>•</b>  Per-user rules are merged and duplicates are removed.  If a host name  is  specified  with  the  input
          file,  <b>cvtsudoers</b>  will  change rules that specify a host name of <b>ALL</b> to the host name associated with
          the policy file being merged.  The merging of  rules  is  currently  fairly  simplistic  but  will  be
          improved in a later release.

       It is possible to merge policy files with differing formats.

   <b>The</b> <b>cvtsudoers.conf</b> <b>file</b>
       Options in the form “keyword = value” may also be specified in a configuration file, <u>/etc/cvtsudoers.conf</u>
       by default.  The following keywords are recognized:

       <b>defaults</b> <b>=</b> <u>deftypes</u>
             See the description of the <b>-d</b> command line option.

       <b>expand_aliases</b> <b>=</b> <u>yes</u> | <u>no</u>
             See the description of the <b>-e</b> command line option.

       <b>group_file</b> <b>=</b> <u>file</u>
             See the description of the <b>--group-file</b> command line option.

       <b>input_format</b> <b>=</b> <u>ldif</u> | <u>sudoers</u>
             See the description of the <b>-i</b> command line option.

       <b>match</b> <b>=</b> <u>filter</u>
             See the description of the <b>-m</b> command line option.

       <b>match_local</b> <b>=</b> <u>yes</u> | <u>no</u>
             See the description of the <b>-M</b> command line option.

       <b>order_increment</b> <b>=</b> <u>increment</u>
             See the description of the <b>-I</b> command line option.

       <b>order_start</b> <b>=</b> <u>start_point</u>
             See the description of the <b>-O</b> command line option.

       <b>output_format</b> <b>=</b> <u>csv</u> | <u>json</u> | <u>ldif</u> | <u>sudoers</u>
             See the description of the <b>-f</b> command line option.

       <b>padding</b> <b>=</b> <u>padding</u>
             See the description of the <b>-P</b> command line option.

       <b>passwd_file</b> <b>=</b> <u>file</u>
             See the description of the <b>--passwd-file</b> command line option.

       <b>prune_matches</b> <b>=</b> <u>yes</u> | <u>no</u>
             See the description of the <b>-p</b> command line option.

       <b>sudoers_base</b> <b>=</b> <u>dn</u>
             See the description of the <b>-b</b> command line option.

       <b>suppress</b> <b>=</b> <u>sections</u>
             See the description of the <b>-s</b> command line option.

       Options on the command line will override values from the configuration file.

   <b>JSON</b> <b>output</b> <b>format</b>
       The <u>sudoers</u> JSON format may contain any of the following top-level objects:

       Defaults
             An array of objects, each containing an <u>Options</u> array and an optional <u>Binding</u> array.

             The  <u>Options</u>  array  consists  of  one  or  more  objects, each containing a “name:value” pair that
             corresponds to a <u>sudoers</u> <u>Defaults</u> setting.  <u>Options</u> that operate on a list  will  also  include  an
             <u>operation</u>  entry  in  the  object,  with  a value of “list_assign” for ‘=’, “list_add” for ‘+=’, or
             “list_remove” for ‘-=’.

             The optional <u>Binding</u> array consists of one or more objects, each containing a “name:value” pair and
             an optional <u>negated</u> entry, which will negate any  comparison  performed  with  the  object.   If  a
             <u>Binding</u>  is  present,  the setting will only take effect if one of the specified <u>command</u>, <u>hostname</u>,
             <u>netgroup</u>, <u>networkaddr</u>, <u>nonunixgid</u>, <u>nonunixgroup</u>, <u>usergid</u>, <u>usergroup</u>,  <u>userid</u>,  <u>username</u>,  or  alias
             entries match.

             For example, the following <u>sudoers</u> entry:

             Defaults@somehost set_home, env_keep += DISPLAY

             converts to:

             "Defaults": [
                 {
                     "Binding": [
                         { "hostname": "somehost" }
                     ],
                     "Options": [
                         { "set_home": true },
                         {
                             "operation": "list_add",
                             "env_keep": [
                                 "DISPLAY"
                             ]
                         }
                     ]
                 }
             ]

       User_Aliases
             A  JSON  object containing one or more <u>sudoers</u> <u>User_Alias</u> entries where each named alias has as its
             value an array containing one or more objects.  Each object contains a  “name:value”  pair  and  an
             optional  <u>negated</u>  entry, which will negate any comparison performed with the object.  The name may
             be one of <u>netgroup</u>, <u>nonunixgid</u>, <u>nonunixgroup</u>, <u>useralias</u>, <u>usergid</u>, <u>usergroup</u>, <u>userid</u>, or <u>username</u>.

             For example, the following <u>sudoers</u> entry:

             User_Alias SYSADMIN = will, %wheel, +admin

             converts to:

             "User_Aliases": {
                 "SYSADMIN": [
                     { "username": "will" },
                     { "usergroup": "wheel" },
                     { "netgroup": "admin" }
                 ]
             }

       Runas_Aliases
             A JSON object containing one or more <u>sudoers</u> <u>Runas_Alias</u> entries, where each named alias has as its
             value an array containing one or more objects.  Each object contains a  “name:value”  pair  and  an
             optional  <u>negated</u>  entry, which will negate any comparison performed with the object.  The name may
             be one of <u>netgroup</u>, <u>nonunixgid</u>, <u>nonunixgroup</u>, <u>runasalias</u>, <u>usergid</u>, <u>usergroup</u>, <u>userid</u>, or <u>username</u>.

             For example, the following <u>sudoers</u> entry:

             Runas_Alias DB = oracle, sybase : OP = root, operator

             converts to:

             "Runas_Aliases": {
                 "DB": [
                     { "username": "oracle" },
                     { "username": "sybase" }
                 ],
                 "OP": [
                     { "username": "root" },
                     { "username": "operator" }
                 ]
             }

       Host_Aliases
             A JSON object containing one or more <u>sudoers</u> <u>Host_Alias</u> entries where each named alias has  as  its
             value  an  array  containing  one or more objects.  Each object contains a “name:value” pair and an
             optional <u>negated</u> entry, which will negate any comparison performed with the object.  The  name  may
             be one of <u>hostalias</u>, <u>hostname</u>, <u>netgroup</u>, or <u>networkaddr</u>.

             For example, the following <u>sudoers</u> entries:

             Host_Alias DORMNET = 128.138.243.0, 128.138.204.0/24
             Host_Alias SERVERS = boulder, refuge

             convert to:

             "Host_Aliases": {
                 "DORMNET": [
                     { "networkaddr": "128.138.243.0" },
                     { "networkaddr": "128.138.204.0/24" }
                 ],
                 "SERVERS": [
                     { "hostname": "boulder" },
                     { "hostname": "refuge" }
                 ]
             }

       Cmnd_Aliases
             A  JSON  object containing one or more <u>sudoers</u> <u>Cmnd_Alias</u> entries where each named alias has as its
             value an array containing one or more objects.  Each object contains a  “name:value”  pair  and  an
             optional  <u>negated</u>  entry, which will negate any comparison performed with the object.  The name may
             be either another <u>cmndalias</u> or a <u>command</u>.  For example, the following <u>sudoers</u> entries:

             Cmnd_Alias SHELLS = <a href="file:/bin/bash">/bin/bash</a>, /bin/csh, <a href="file:/bin/sh">/bin/sh</a>, /bin/zsh
             Cmnd_Alias VIPW = /usr/bin/chpass, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?chfn">/usr/bin/chfn</a>, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?chsh">/usr/bin/chsh</a>, \
                               <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?passwd">/usr/bin/passwd</a>, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vigr">/usr/sbin/vigr</a>, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vipw">/usr/sbin/vipw</a>

             convert to:

             "Cmnd_Aliases": {
                 "SHELLS": [
                     { "command": "<a href="file:/bin/bash">/bin/bash</a>" },
                     { "command": "/bin/csh" },
                     { "command": "<a href="file:/bin/sh">/bin/sh</a>" },
                     { "command": "/bin/zsh" }
                 ],
                 "VIPW": [
                     { "command": "/usr/bin/chpass" },
                     { "command": "<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?chfn">/usr/bin/chfn</a>" },
                     { "command": "<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?chsh">/usr/bin/chsh</a>" },
                     { "command": "<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?passwd">/usr/bin/passwd</a>" },
                     { "command": "<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vigr">/usr/sbin/vigr</a>" },
                     { "command": "<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vipw">/usr/sbin/vipw</a>" }
                 ]
             }

       User_Specs
             A JSON array containing one or more objects, each representing a <u>sudoers</u> User_Spec.  Each object in
             the <u>User_Specs</u> array should contain a <u>User_List</u> array, a <u>Host_List</u> array and a <u>Cmnd_Specs</u> array.

             A <u>User_List</u> consists of one or more objects.  Each object  contains  a  “name:value”  pair  and  an
             optional  <u>negated</u>  entry, which will negate any comparison performed with the object.  The name may
             be one of <u>netgroup</u>, <u>nonunixgid</u>, <u>nonunixgroup</u>, <u>useralias</u>, <u>usergid</u>, <u>usergroup</u>, <u>userid</u>,  or  <u>username</u>.
             If <u>username</u> is set to the special value <b>ALL</b>, it will match any user.

             A  <u>Host_List</u>  consists  of  one  or  more objects.  Each object contains a “name:value” pair and an
             optional <u>negated</u> entry, which will negate any comparison performed with the object.  The  name  may
             be  one  of <u>hostalias</u>, <u>hostname</u>, <u>netgroup</u>, or <u>networkaddr</u>.  If <u>hostname</u> is set to the special value
             <b>ALL</b>, it will match any host.

             The <u>Cmnd_Specs</u> array consists of one or more JSON objects describing a command  that  may  be  run.
             Each  <u>Cmnd_Specs</u>  is  made  up  of  a  <u>Commands</u>  array,  an  optional <u>runasusers</u> array, an optional
             <u>runasgroups</u> array, and an optional <u>Options</u> <u>array.</u>

             The <u>Commands</u> array consists of one or more objects  containing  “name:value”  pair  elements.   The
             following names and values are supported:

             command  A string containing the command to run.  The special value <b>ALL</b> it will match any command.

             negated  A boolean value that, if true, will negate any comparison performed with the object.

             sha224   One  or  more SHA224 digests for the <u>command</u> in string form.  Multiple digests of the same
                      type are stored as an array.

             sha256   One or more SHA256 digests for the <u>command</u> in string form.  Multiple digests of  the  same
                      type are stored as an array.

             sha384   One  or  more SHA384 digests for the <u>command</u> in string form.  Multiple digests of the same
                      type are stored as an array.

             sha512   One or more SHA512 digests for the <u>command</u> in string form.  Multiple digests of  the  same
                      type are stored as an array.

             The  <u>runasusers</u>  array consists of objects describing users the command may be run as.  Each object
             contains a “name:value” pair and an optional  <u>negated</u>  entry,  which  will  negate  any  comparison
             performed  with the object.  The name may be one of <u>netgroup</u>, <u>nonunixgid</u>, <u>nonunixgroup</u>, <u>runasalias</u>,
             <u>usergid</u>, <u>usergroup</u>, <u>userid</u>, or <u>username</u>.  If <u>username</u> is set to the  special  value  <b>ALL</b>,  it  will
             match any user.  If <u>username</u> is set to the empty string “”, it will match the invoking user.

             The <u>runasgroups</u> array consists of objects describing groups the command may be run as.  Each object
             contains  a  “name:value”  pair  and  an  optional  <u>negated</u> entry, which will negate any comparison
             performed with the object.  The name may be one of <u>runasalias</u>, <u>usergid</u>, or <u>usergroup</u>.  If <u>usergroup</u>
             is set to the special value <b>ALL</b>, it will match any group.

             The <u>Options</u> array is of the same format as the one in the <u>Defaults</u> object.  Any <u>Tag_Spec</u> entries in
             <u>sudoers</u> are converted to <u>Options</u>.  A user with “sudo ALL” privileges will  automatically  have  the
             <u>setenv</u> option enabled to match the implicit behavior provided by <u>sudoers</u>.

             For example, the following <u>sudoers</u> entry:

             millert ALL = (ALL : ALL) NOPASSWD: ALL, !<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?id">/usr/bin/id</a>

             converts to:

             "User_Specs": [
                 {
                     "User_List": [
                         { "username": "millert" }
                     ],
                     "Host_List": [
                         { "hostname": "ALL" }
                     ],
                     "Cmnd_Specs": [
                         {
                             "runasusers": [
                                 { "username": "ALL" }
                             ],
                             "runasgroups": [
                                 { "usergroup": "ALL" }
                             ],
                             "Options": [
                                 { "authenticate": false },
                                 { "setenv": true }
                             ],
                             "Commands": [
                                 { "command": "ALL" },
                                 {
                                     "command": "<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?id">/usr/bin/id</a>",
                                     "negated": true
                                 }
                             ]
                         }
                     ]
                 }
             ]

   <b>CSV</b> <b>output</b> <b>format</b>
       CSV  (comma-separated value) files are often used by spreadsheets and report generators.  For CSV output,
       <b>cvtsudoers</b> double quotes strings that contain commas.  For each literal double  quote  character  present
       inside  the  string, two double quotes are output.  This method of quoting commas is compatible with most
       spreadsheet programs.

       There are three possible sections in <b>cvtsudoers</b>'s CSV output, each separated by a blank line:

       defaults
             This section includes any <u>Defaults</u> settings in <u>sudoers</u>.   The  <u>defaults</u>  section  begins  with  the
             following heading:

                   defaults_type,binding,name,operator,value

             The fields are as follows:

             defaults_type
                   The   type   of   <u>Defaults</u>   setting;   one  of  <u>defaults</u>,  <u>defaults_command</u>,  <u>defaults_host</u>,
                   <u>defaults_runas</u>, or <u>defaults_user</u>.

             binding
                   For <u>defaults_command</u>, <u>defaults_host</u>, <u>defaults_runas</u>, and <u>defaults_user</u> this is the value that
                   must match for the setting to be applied.

             name  The name of the <u>Defaults</u> setting.

             operator
                   The operator determines how the value is applied to  the  setting.   It  may  be  either  ‘=’
                   (assignment), ‘+=’ (append), or ‘-=’ (remove).

             value
                   The  setting's  value,  usually  a string or, for settings used in a boolean context, <u>true</u> or
                   <u>false</u>.

       aliases
             This section includes any <u>Cmnd_Alias</u> <u>Host_Alias</u>, <u>Runas_Alias</u>, or <u>User_Alias</u>, entries from  <u>sudoers</u>.
             The <u>aliases</u> section begins with the following heading:

                   alias_type,alias_name,members

             The fields are as follows:

             alias_type
                   The type of alias; one of <u>Cmnd_Alias</u>, <u>Host_Alias</u>, <u>Runas_Alias</u>, or <u>User_Alias</u>.

             alias_name
                   The  name  of  the alias; a string starting with an upper-case letter that consists of upper-
                   case letters, digits, or underscores.

             members
                   A comma-separated list of members belonging to the alias.  Due to the use of commas,  <u>members</u>
                   is surrounded by double quotes if it contains more than one member.

       rules
             This  section  includes the <u>sudoers</u> rules that grant privileges.  The <u>rules</u> section begins with the
             following heading:

                   rule,user,host,runusers,rungroups,options,command

             The fields are as follows:

             rule  This field indicates a <u>sudoers</u> <u>rule</u> entry.

             user  The user the rule applies to.  This may also be a Unix group (preceded by a ‘%’ character), a
                   non-Unix group (preceded by  ‘%:’)  or  a  netgroup  (preceded  by  a  ‘+’  character)  or  a
                   <u>User_Alias</u>.  If set to the special value <b>ALL</b>, it will match any user.

             host  The host the rule applies to.  This may also be a netgroup (preceded by a ‘+’ character) or a
                   <u>Host_Alias</u>.  If set to the special value <b>ALL</b>, it will match any host.

             runusers
                   An  optional  comma-separated list of users (or <u>Runas_Alias</u>es) the command may be run as.  If
                   it contains more than one member, the value is surrounded by double quotes.  If  set  to  the
                   special value <b>ALL</b>, it will match any user.  If empty, the root user is assumed.

             rungroups
                   An  optional comma-separated list of groups (or <u>Runas_Alias</u>es) the command may be run as.  If
                   it contains more than one member, the value is surrounded by double quotes.  If  set  to  the
                   special value <b>ALL</b>, it will match any group.  If empty, the <u>runuser</u>'s group is used.

             options
                   An  optional  list  of  <u>Defaults</u>  settings  to apply to the command.  Any <u>Tag_Spec</u> entries in
                   <u>sudoers</u> are converted to <u>options</u>.

             commands
                   A list of commands, with optional arguments, that the user is allowed to run.  If set to  the
                   special value <b>ALL</b>, it will match any command.

             For example, the following <u>sudoers</u> entry:

             millert ALL = (ALL : ALL) NOPASSWD: ALL, !<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?id">/usr/bin/id</a>

             converts to:

             rule,millert,ALL,ALL,ALL,"!authenticate","ALL,!<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?id">/usr/bin/id</a>"

</pre><h4><b>FILES</b></h4><pre>
       <u>/etc/cvtsudoers.conf</u>      default configuration for cvtsudoers

</pre><h4><b>EXAMPLES</b></h4><pre>
       Convert  <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> to LDIF (LDAP Data Interchange Format) where the <u>ldap.conf</u> file uses a <u>sudoers_base</u>
       of my-domain,dc=com, storing the result in <u>sudoers.ldif</u>:

           $ cvtsudoers -b ou=SUDOers,dc=my-domain,dc=com -o sudoers.ldif \
                        <a href="file:/etc/sudoers">/etc/sudoers</a>

       Convert <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> to JSON format, storing the result in <u>sudoers.json</u>:

           $ cvtsudoers -f json -o sudoers.json <a href="file:/etc/sudoers">/etc/sudoers</a>

       Parse <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> and display only rules that match user <u>ambrose</u> on host <u>hastur</u>:

           $ cvtsudoers -f sudoers -m user=ambrose,host=hastur <a href="file:/etc/sudoers">/etc/sudoers</a>

       Same as above, but expand aliases and prune out any  non-matching  users  and  hosts  from  the  expanded
       entries.

           $ cvtsudoers -ep -f sudoers -m user=ambrose,host=hastur <a href="file:/etc/sudoers">/etc/sudoers</a>

       Convert <u>sudoers.ldif</u> from LDIF to traditional <u>sudoers</u> format:

           $ cvtsudoers -i ldif -f sudoers -o sudoers.new sudoers.ldif

       Merge a global <u>sudoers</u> file with two host-specific policy files from the hosts “xyzzy” and “plugh”:

           $ cvtsudoers -f sudoers -o sudoers.merged sudoers \
               xyzzy:sudoers.xyzzy plugh:sudoers.plugh

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man5/sudoers.5.html">sudoers</a></u>(5), <u><a href="../man5/sudoers.ldap.5.html">sudoers.ldap</a></u>(5), <u><a href="../man8/sudo.8.html">sudo</a></u>(8)

</pre><h4><b>AUTHORS</b></h4><pre>
       Many people have worked on <b>sudo</b> over the years; this version consists of code written primarily by:

             Todd C. Miller

       See  the  CONTRIBUTORS.md  file in the <b>sudo</b> distribution (https://www.sudo.ws/about/contributors/) for an
       exhaustive list of people who have contributed to <b>sudo</b>.

</pre><h4><b>BUGS</b></h4><pre>
       If you believe you have found a bug in <b>cvtsudoers</b>, you can either file a  bug  report  in  the  sudo  bug
       database, https://bugzilla.sudo.ws/, or open an issue at https://github.com/sudo-project/sudo/issues.  If
       you   would   prefer   to   use   email,   messages  may  be  sent  to  the  sudo-workers  mailing  list,
       https://www.sudo.ws/mailman/listinfo/sudo-workers (public) or &lt;<a href="mailto:sudo@sudo.ws">sudo@sudo.ws</a>&gt; (private).

       Please not report security vulnerabilities through public  GitHub  issues,  Bugzilla  or  mailing  lists.
       Instead,  report  them  via email to &lt;<a href="mailto:Todd.Miller@sudo.ws">Todd.Miller@sudo.ws</a>&gt;.  You may encrypt your message with PGP if you
       would like, using the key found at https://www.sudo.ws/dist/PGPKEYS.

</pre><h4><b>SUPPORT</b></h4><pre>
       Limited    free    support    is    available    via     the     sudo-users     mailing     list,     see
       https://www.sudo.ws/mailman/listinfo/sudo-users to subscribe or search the archives.

</pre><h4><b>DISCLAIMER</b></h4><pre>
       <b>cvtsudoers</b>  is provided “AS IS” and any express or implied warranties, including, but not limited to, the
       implied warranties of merchantability and fitness for a  particular  purpose  are  disclaimed.   See  the
       LICENSE.md file distributed with <b>sudo</b> or https://www.sudo.ws/about/license/ for complete details.

Sudo 1.9.16p2                                    April 26, 2024                                    <u><a href="../man1/CVTSUDOERS.1.html">CVTSUDOERS</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>