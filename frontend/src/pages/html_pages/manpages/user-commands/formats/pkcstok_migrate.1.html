<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pkcstok_migrate  -  utility  to migrate an ICA, CCA, Soft, or EP11 token repository to the FIPS compliant</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/opencryptoki">opencryptoki_3.24.0+git20250128.0462717+dfsg-0ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pkcstok_migrate  -  utility  to migrate an ICA, CCA, Soft, or EP11 token repository to the FIPS compliant
       format introduced with openCryptoki 3.12.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pkcstok_migrate</b> [<b>-h</b>]
       <b>pkcstok_migrate</b> <b>--slotid</b> <u>slot-number</u> <b>--datastore</b> <u>datastore</u> <b>--confdir</b> <u>confdir</u> [<b>--sopin</b>  <u>sopin</u>]  [<b>--userpin</b>
       <u>userpin</u>] [<b>--verbose</b> <u>level</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Convert  all  objects  inside  a  token  repository  to the new format introduced with version 3.12.  All
       encrypted data inside the new format is stored using FIPS compliant methods. The new format  affects  the
       token's  master  key  files (MK_SO and MK_USER), the NVTOK.DAT, and the token object files in the TOK_OBJ
       folder.

       While using this tool no process using the  token  to  be  migrated  must  be  running.   Especially  the
       pkcsslotd must be stopped before running this tool.

       The  tool  creates a backup of the token repository to be migrated, and performs all migration actions on
       this backup, leaving the original repository folder completely untouched. The backup folder is located in
       the same directory as the original repository and is suffixed with _PKCSTOK_MIGRATE_TMP.

       After a successful migration, the original repository is renamed with a suffix of  _BAK  and  the  backup
       folder  is  renamed  to  the original repository name, so that the migrated repository can immediately be
       used. The old folder may be deleted by the user manually later.

       After a successful  migration,  the  tool  adds  parameter  'tokversion  =  3.12'  to  the  token's  slot
       configuration   in   the  opencryptoki.conf  file.  The  original  config  file  is  still  available  as
       opencryptoki.conf_BAK and may be removed by the user manually.

       After an unsuccessful migration, the original repository is still available unchanged.

       The <b>pkcstok_migrate</b> utility must be run as root.

</pre><h4><b>OPTIONS</b> <b>SUMMARY</b></h4><pre>
       <b>--slotid</b> <b>-s</b> <u>SLOT-NUMBER</u>
                 specifies the token slot number of the token repository to be migrated

       <b>--datastore</b> <b>-d</b> <u>DATASTORE</u>
                 specifies the directory of the token repository to be migrated.

       <b>--confdir</b> <b>-c</b> <u>CONFDIR</u>
                 specifies the directory where the opencryptoki.conf file is located.

       <b>--sopin</b> <b>-p</b> <u>SOPIN</u>
                 specifies the SO pin. If not specified, the SO pin is prompted.

       <b>--userpin</b> <b>-u</b> <u>USERPIN</u>
                 specifies the user pin. If not specified, the user pin is prompted.

       <b>--verbose</b> <b>-v</b> <u>LEVEL</u>
                 specifies the verbose level: <u>none</u>, error, warn, info, devel, debug

       <b>--help</b> <b>-h</b> show usage information

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/pkcsconf.1.html">pkcsconf</a></b>(1),
       <b><a href="../man7/opencryptoki.7.html">opencryptoki</a></b>(7),
       <b><a href="../man8/pkcsslotd.8.html">pkcsslotd</a></b>(8).

3.24                                                June 2020                                 <u><a href="../man1/PKCSTOK_MIGRATE.1.html">PKCSTOK_MIGRATE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>