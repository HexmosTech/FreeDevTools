<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>filtermail - Filter incoming e-mail to accepted, spam or ignored</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/filtermail">filtermail_1.06.00-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       filtermail - Filter incoming e-mail to accepted, spam or ignored

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>filtermail</b> [OPTIONS] <u>base</u>
       [OPTIONS] - cf. section <b>OPTIONS</b>
       <u>base</u>: the absolute path to the user’s home directory

       When specified paths with options or in the configuration file specifications may start with <u>~/</u>, in which
       case  <u>~</u> is replaced by <u>base</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Filtermail</b> filters incoming e-mail as either accepted, spam, or ignored e-mail. It uses rule files, which
       are  inspected  in  sequence  until  the  incoming  e-mail  matches  a rule. Once that happens the rule’s
       associated action (accept, spam, or ignore) is executed. If the e-mail is not matched by  any  rule  then
       the e-mail is accepted.

       Alternatively,  when using option <u>--inspect</u> <b>filtermail</b> can be used to find the domain name of the sender,
       its IP address, its country of origin and the cidr-range containing the received IP address (see sections
       <b>OPTIONS</b> and <b>FILTERMAIL</b> <b>INSPECT</b> below).

       Accepted e-mail normally is appended to the mail file which is used by  the  incoming  mail  server  when
       receiving mail for the current user. E.g., if the user’s username is <u>frank</u> then incoming mail is appended
       to  the  file <u>/var/mail/frank</u>. Users may also define directories to contain saved e-mails (e.g., <u><a href="file:~/Mail">~/Mail</a></u>),
       and <b>filtermail</b> can be configured to append e-mail considered as spam  to,  e.g.,  <u><a href="file:~/Mail/spam">~/Mail/spam</a></u>.  Likewise,
       e-mail  matching  the  ’ignore’  criteria  could  be  appended to <u><a href="file:~/Mail/ignore">~/Mail/ignore</a></u>. Instead of appending the
       complete e-mail to its destination file the received e-mail’s <u>From:</u> and <u>Subject:</u> headers can be  appended
       to  its  destination  file.  This  is  achieved  by prefixing <u>:HDRS:</u> to the name of the destination file.
       Alternatively, such e-mail can also be ignored, losing it completely, by  not  specifying  a  destination
       file.  The option to merely log the received e-mail’s <u>From:</u> and <u>Subject:</u> headers may come in handy if the
       received e-mail is also kept elsewhere (e.g., in another account, which forwards the received  e-mail  to
       the  computer  running  <b>filtermail</b>)  and  the  ignoring  rules  might result in occasional false positive
       decisions.  (see also section <b>OPTIONS</b> below).

       <b>Filtermail</b> uses three types of files:

       o      The configuration  file  contains  values  of  options  with  are  generally  used  (see  sections
              <b>CONFIGURATION</b> and <b>OPTIONS</b>);

       o      Mail  filtering  rules are hierarchically ordered in the <u>rules</u> file: incoming mail is sequentially
              matched against the patterns defined in files specified in the rules file until a match is  found.
              Once  a  match  has  been found the rule’s action (accept, ignore or spam) is executed, ending the
              filtering process (see section <b>RULES</b>);

       o      Each file specified in the rules file defines matching patterns, which  are  tested  sequentially.
              Testing  those  patterns ends once the incoming mail matches a pattern. The result of the matching
              is forwarded to the rules file which may result  in  executing  the  rule’s  action  (see  section
              <b>PATTERNS</b>).

       If  <b>filtermail</b> detects a syntax error in the rules file or in a rule specification file the incoming mail
       is accepted. To avoid this situation the <u>--syntax</u> option  (see  section  <b>OPTIONS</b>)  should  be  used  when
       modifying, adding or removing rule files to verify that the specified rules were correctly formulated.

       To  use  <b>filtermail</b>  the  incoming  mail  server  must recognize it as a valid mail handling program (see
       section <b>EXAMPLES</b>).

</pre><h4><b>CONFIGURATION</b></h4><pre>
       Options (see section <b>OPTIONS</b>) not flagged with `NO_CONFIG’ can also be specified in a configutation file.
       By default the configuration file <u><a href="file:~/.filtermail/config">~/.filtermail/config</a></u> is used.

       Command line options always take precedence over specifications in the configuration file.

       The configuration file <u>must</u> exist, but may be empty. It must exist  because  its  directory  defines  the
       directory  where the files defining the filtering rules are located. Empty lines and the content of lines
       starting at the <u>#</u>-character are ignored.

       Option <u>--expire</u> is used to remove patterns whose date stamps (cf. section <b>PATTERNS</b>) indicate dates before
       the date specified by <u>--expire</u>. The configuration file may contain <u>dont-expire:</u> lines. Each  <u>dont-expire:</u>
       line  specifies  the  name  of a pattern file whose entries don’t expire. Files specified in <u>dont-expire:</u>
       lines may not exist, but to avoid inspecting pattern files for expired dates the name(s) of those <b>s</b>  must
       be identical to the names of the <b>s</b> used in the rules file (cf. section <b>RULES</b> below).

       Other  files  in the configuration file may use the <u>[~]/path</u> format or must be plain filenames (i.e., not
       starting with <u>/</u>-characters). Plain files are relative to the directory containing the configuration  file
       (cf. section <b>EXAMPLES</b>).

</pre><h4><b>RULES</b></h4><pre>
       All  mail  filtering  rules  are defined in the <u>rules</u> file. Mail filtering starts at the first rule until
       either the incoming e-mail matches a rule, or until all rules have been processed and the e-mail does not
       match any rule. In the latter case the e-mail is considered accepted.

       Empty lines and lines whose first non-blank character is a <u>#</u>-character are ignored. The rules  themselves
       cannot contain <u>#</u>-characters.

       Rules  are  written according to the following syntax (elements between square brackets are optional, the
       content of bracketed sections followed by a <u>*</u> character may be repeated (not using the square  brackets).
       Lowercase  words  are  keywords and cannot be used otherwise. Capitalized words are described below. Each
       rule is specified on its own line. Line continuation (using, e.g., <u>\</u>  at  the  end  of  a  line)  is  not
       supported). Here’s the rule’s syntax:

           if Header File [and Header File]* Action

       <u>Header</u>  is the name of a mail header (e.g., <u>From:,</u> <u>Received:</u>). Header specifications must be identical to
       the first words of header lines of the received e-mail. So to match the <u>From</u> header in the e-mail’s first
       line specify <u>From</u> (i.e., no colon). Some headers have variants. E.g.,  <u>Received:</u>  and  <u>Received-SPF:</u>.  To
       select  all  headers  sharing their initial characters append a <u>+</u>-character to the initial part (e.g., to
       select all headers starting with <u>Received</u> use <u>Received+</u>, and  use  <u>From+</u>  to  select  all  <u>From:</u>  headers
       including the e-mail’s first line).

       <u>File</u> is the name of the file containing patterns to inspect.  Filenames must start with <u>./</u> and define the
       locations  of  files  below  the  configuration file’s directory. E.g., <u>./spam/subject</u> specifies the file
       <u>subject</u> in a subdirectory <u>spam</u> containing patterns considered by the rule.

       <u>Action</u> specifies the action to execute when e-mail matches a rule. <u>Action</u> can be

       o      <u>accept</u>:

              the e-mail is accepted (i.e., appended to the <u>accept</u> location spcified in the configuration file)

       o      <u>ignore</u>:

              the e-mail is ignored (i.e., appended to the <u>ignore</u> location spcified in the configuration file)

       o      <u>spam</u>:

              the e-mail is considered spam (i.e., appended to the <u>spam</u> location spcified in  the  configuration
              file)

</pre><h4><b>PATTERNS</b></h4><pre>
       Files  specified  in  <u>rules</u> files define patterns which may be found in the headers defined by the rules.
       The header lines which are selected by the <u>Header</u> specifications in the <u>rules</u> file  are  matched  against
       those  patterns  after  removing the header labels from those lines. So <u>Subject:</u> <u>hello</u> <u>world</u> is passed to
       the patterns as the (trimmed) line <u>hello</u> <u>world</u>. Once a header’s content matches a pattern inspection ends
       with a successful match (the rule itself may specify <u>not</u>, in which case a successful match results  in  a
       failing match of the rule).

       Pattern  files  may  start  with file-specific comment (i.e., empty lines and lines whose first non-blank
       character is <u>#</u>) up to a comment line equal to <u>#=</u>. The patterns themselves may also be preceded by comment
       lines. Once a pattern is matched it is moved one position upward  in  the  pattern  file  (including  its
       associated comment).

       Pattern  specifications  use  the  following  syntax (elements between square brackets are optional (when
       used, the square brackets are not specified), capitalized words are  described  below,  each  pattern  is
       defined on a single line, line continuation is not supported):

           Nr Date Expression [and Expression]*

       This pattern indicates a match when all <u>Expressions</u> match.

       This syntax uses the following elements:

       o      <u>Nr</u>:  specifies  the  number  of  times  e-mail  was  successfully  matched by the pattern. At each
              successful match the count is incremented (up to a maximum of 999),  and  the  pattern  rises  one
              position  in  the  pattern  file. The field width of the number field must be at least 3 character
              positions wide. When adding a pattern use 1;

       o      <u>Date</u>: shows the date of the most recent match. Its format is <u>yy-mm-dd</u>, e.g. 23-03-31. When  adding
              a pattern the current date could be used.

       o      <u>Expression</u>: defines at least one matching mode and associated expression.

       The <u>Expressions</u> themselves use the following syntax:
       MatchMode [not] Spec
       The selected headers are matched against <u>Spec</u> using the specified <u>MatchMode</u>. The <u>not</u> keyword is optional.
       When  specified  (omit  the square brackets) the result of the match is negated. When multiple <u>Expression</u>
       specifications are joined by <u>and</u> keywords, then the final pattern results in a match  if  all  <u>Expression</u>
       specifications  indicate  a  match.  Once  an  <u>Expression</u>  does  not  indicate  a  match, then subsequent
       <u>Expressions</u> are not evaluated and headers do not match the pattern.

       When using <u>not</u> the e-mail may not match the <u>Spec</u> specification.  E.g, when e-mail should  contain  a  <u>To:</u>
       header or a <u>Cc:</u> header the following rule can be used (cf. section <b>EXAMPLES</b>:)

           if To: ./match/noto and Cc: ./match/noto  spam

       with <u>match/noto</u>:

            1   23-05-10  p not  ’.’

       Note  that  <u>Spec</u>  must  be surrounded by single quotes. To use a single quote inside a <u>Spec</u> escape it (as
       <u>\’</u>). In general: the character following a backslash is used as-is, removing the backslash from the  <u>Spec</u>
       (e.g., to construct a <u>Spec</u> containing <u>’\n</u> specify <u>\’\\n</u>).

       There  are five types of <u>MatchModes.</u> <u>MatchModes</u> using regular expressions use extended regular expression
       patterns: prefix multipliers and bounding-characters by backslashes when they should  be  interpreted  as
       ordinary  characters  (i.e.,  <u>*,</u>  <u>+,</u>  <u>?,</u> <u>^,</u> <u>$,</u> <u>|,</u> <u>(,</u> <u>),</u> <u>[,</u> <u>],</u> <u>{,</u> <u>}</u> should be escaped when used as literal
       characters).

       o      <u>c</u>: (cidr) matches <u>[d{1.3}.d{1.3}.d{1.3}.d{1.3}]</u> IP address  patterns  found  in  selected  headers
              against the <u>Spec</u> pattern, e.g., <u>’1.22.333.0/24’</u>;

       o      <u>i</u>:  (ignore  case) matches the selected headers case-insensitively against the <u>Spec</u> pattern, e.g.,
              <u>’yes’</u>;

       o      <u>n</u>: (no-case pattern) matches the selected headers  case-insensitively  against  the  <u>Spec</u>  regular
              expression pattern, e.g., <u>’news.*\.*@reply’</u>;

       o      <u>p</u>:  (pattern)  matches the selected headers (case-sensitively) against the <u>Spec</u> regular expression
              pattern;

       o      <u>s</u>: (string text) matches the selected headers as specified  (case-sensitively)  against  the  <u>Spec</u>
              pattern,  e.g., <u>’noreply@’</u>.  This matchmode can also be used to match IP version 6 patterns if the
              cidr-range uses multiples of 16-bit values, e.g., <u>’[2a02:7a60:’</u>;

       o      <u>$</u>: (script or program): <u>Spec</u> calls a script or program. The selected headers  are  passed  to  the
              script  or  program,  which  must  return 0 to indicate a match and any other value to indicate no
              match. The script or program may specify arguments, but in addition two additional  arguments  are
              passed  to  the  script or program, the first one being the name of a file containing the selected
              e-mail headers, the second one being the name of the file containing  the  e-mail’s  content.  The
              script or program does not use the <u>PATH</u> environment variable, so the path to the script or program
              (possibly  starting  with  <u>~/</u>)  must  be specified. When <u>Spec</u> starts with the word <u>SHELL]</u> then the
              script or program is called as <u><a href="file:/bin/sh">/bin/sh</a></u> <u>-c</u> <u>’script/program</u> <u>[arguments]’</u>. Examples:

                      # call program in the user’s bin dir. with 4 arguments
                  ’<a href="file:~/bin/program">~/bin/program</a> arg1, arg2’

                      # call script in the user’s bin dir. with 4 arguments
                      # via <a href="file:/bin/sh">/bin/sh</a>
                  ’SHELL <a href="file:~/bin/script">~/bin/script</a> arg1, arg2’

</pre><h4><b>OPTIONS</b></h4><pre>
       Short options, when defined, are provided between parentheses immediately  following  their  long  option
       equivalents.  Several  parameters specify locations of files written or used by <b>filtermail</b>. If a location
       specification starts with <u>~/</u> then the tilde-character is replaced by  the  <u>base</u>  directory  specified  as
       <b>filtermail</b>’s  argument.  Otherwise,  if  the  location does not start with a slash (<u>/</u>) character then the
       location is prefixed by the path of the directory containing the configuration file.

       Some options can also be specified in the configuration file (cf. section  <b>CONFIGURATION</b>).  Options  that
       cannot be specified in the configuration file are marked as <u>NO-CONFIG</u>.

       o      <b>--accept</b>([:HDRS:]path)
              the  path  receiving  accept-marked  mail.  Mail  not matching any rules is also accepted. Prepend
              <u>:HDRS:</u> to <u>path</u> to log the mail’s  <u>From:</u>  and  <u>Subject:</u>  headers  to  <u>path</u>.  To  completely  ignore
              accept-marked   mail   omit   this  option  (although  ignoring  accept-marked  mail  is  probably
              undesirable). Examples (commonly <u>frank</u> (used in the example) is replaced by the user’s username):
                  --accept /var/mail/USER
                  --accept :HDRS:/var/mail/USER

       o      <b>--cls</b>
              By default <b>filtermail</b> clears the terminal’s screen (calling <u>tput</u> <u>clear</u>). If the screen should  not
              be  cleared  option  <u>--cls</u>  <u>no</u>  can  be  specified.  A  default value can also be specified in the
              configuration file, using

                  cls: no

              in  which  case  option  <u>--cls</u>  <u>yes</u>  can  be  specified  to  overrule  the  configuration   file’s
              specification. This option is only used when the <u>--inspect</u> option is specified.

       o      NO-CONFIG <b>--config</b>=<u>path</u> (<b>-c</b>)
              the  path  to  the  configuration  file  (default:  <a href="file:~/etc/mailfilter/config">~/etc/mailfilter/config</a>).   (see  also section
              <u>CONFIGURATION</u> below).

       o      NO-CONFIG <b>--expire</b>=<u>date</u> (<b>-e</b>)
              no mail is read, but patterns having date stamps older than <u>date</u> are removed from their files  and
              are  stored  in files having extension <u>.exp</u> (cf. section <b>PATTERNS</b> below). Use format <u>yy-mm-dd</u> when
              specifying <u>date</u>. This option and <u>--interactive</u> (see below) cannot both be specified. Example:
                  --date 23-01-31

       o      NO-CONFIG <b>--help</b> (<b>-h</b>)
              a summary of <b>filtermail</b>’s usage is written to <u>cout</u> and <b>filtermail</b> ends, returning 0 to the shell.

       o      <b>--ignore</b>([:HDRS:]path)
              the path receiving ignore-marked mail. Prepend <u>:HDRS:</u> to <u>path</u> to log the mail’s <u>From:</u> and <u>Subject:</u>
              headers to <u>path</u>. To completely ignore ignore-marked mail omit this option. Examples:
                  --ignore <a href="file:~/Mail/ignore">~/Mail/ignore</a>
                  --ignore :HDRS: <a href="file:~/Mail/ignore">~/Mail/ignore</a>

       o      NO-CONFIG <b>--inspect</b> (<b>-I</b>)
              when specifying this option <b>filtermail</b> expects a  received  e-mail  file  at  its  standard  input
              showing  the  domain  name of the sender, its IP address, its country of origin and the cidr-range
              containing the received IP address. E.g.,

                  from renxincj.com (unknown [104.223.188.228])
                  IP = `104.223.188.228’, Country: US,  CIDR = 104.223.128.0/17

              See section <b>FILTERMAIL</b> <b>INSPECT</b> for additional info.

       o      NO-CONFIG <b>--interactive</b> (<b>-i</b>)
              the matching result of matching patterns is interactively simulated (no mail is read). This option
              and <u>--expire</u> cannot both be specified.

       o      <b>--IP4-pattern</b>=<u>regex</u> (<b>-p</b>)
              by   default   IP4   patterns   are   recognized   using   the    regular    expression    pattern
              <u>\[((\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3}))\]</u>,   matching   addresses  like  <u>[123.11.22.33]</u>  in
              specified headers. This format is  commonly  encountered  in  <u>Received:</u>  headers.  When  different
              IP4-patterns  should  be  recognized  then  this  option  can  be  used to specify another regular
              expression for matching IP4-patterns in headers.

              The required regex is an extended regular expression in which the characters <u>*,</u> <u>+,</u> <u>?,</u> <u>^,</u> <u>$,</u> <u>|,</u>  <u>(,</u>
              <u>),</u>  <u>[,</u>  <u>],</u> <u>{,</u> and <u>}</u> must be escaped when used as literal characters. Perl-like escape sequences <u>\b</u>
              (word-boundary),  <u>\d</u>  (digit  character),  <u>\s</u>  (white-space  character),  and  <u>\w</u>   (alpha-numeric
              character) are supported. Their capital variants represent their complementary sets.

              The  regexes  specified  using  this  option  must  have at least five elements, addressable using
              indices 1..5:
              * element 1 defines the complete IP4 pattern,
              * element 2 defines the most significant (4th)  octet  (available  in  bits  24  thru  31  in  the
              converted binary address),
              *  element  3  defines  the  3th  IP4  octet (available in bits 16 thru 23 in the converted binary
              address),
              * element 4 defines the 2nd IP4 octet (available in bits  8  thru  15   in  the  converted  binary
              address),
              *  element  5  defines  the  least  significant (1st) IP4 octet (available in bits 0 thru 7 in the
              converted binary address).

       o      <b>--log</b>=<u>spec</u> (<b>-l</b>)
              specify the log-facility. By default no logging is used.
              The <u>spec</u> argument can be the location of a file receiving the log messages.
              If <u>spec</u> uses the format <u>facility:level</u>  (<u>facility</u>  and  <u>level</u>  being  the  names  defined  in  the
              <b><a href="../man3/syslog.3.html">syslog</a></b>(3)  man-page  omitting  their  <u>LOG</u><b>_</b>  prefixes) then the log messages are written by <u>syslog</u>.
              Examples:
                  --log log/log     # uses log/log in the configuration
                                    # file’s directory
                  --log USER:NOTICE # uses syslog

       o      <b>--preamble</b>
              merely verify that the basic options are correctly specified. No mail is read, but all options and
              configuration file specifications are processed.  When  the  verification  successfully  ends  the
              message
                  Preamble successfully completed
              is written to <u>cout</u> and <b>filtermail</b> returns 0.

       o      <b>--received</b>=<u>content</u> (<b>-R</b>)
              before  incoming  mail  reaches  your  computer  your,  e.g.,  organization’s mail server may have
              processed the incoming mail, and it may be OK to inspect only the <u>Received:</u> headers following that
              mail server’s <u>Received:</u> header. The content of the <u>Received:</u> header may (partially)  be  specified
              using  this  option,  which can also be provided in the configuration file. E.g., if the <u>Received:</u>
              header originating from your organization’s mail  server  contains  <u>ourorganization.org</u>  then  the
              option  <u>-r</u>  <u>ourorganization.org</u>  causes  all  <u>Received:</u>  headers to be ignored until the <u>Received:</u>
              header containing <u>ourorganization.org</u> has been seen. If the incoming mail doesn’t contain  such  a
              <u>Received:</u>  header  then  all  <u>Received:</u>  headers are inspected.  This option is only used when the
              <u>--inspect</u> option is specified.

       o      <b>--rules</b>=<u>path</u> (<b>-r</b>)
              the location of the rules specification file (cf. section <b>RULES</b> below).

       o      <b>--spam</b> <u>[:HDRS:]path</u>
              the path receiving spam-marked mail. Prepend <u>:HDRS:</u> to <u>path</u> to log the mail’s <u>From:</u>  and  <u>Subject:</u>
              headers to <u>path</u>. To completely ignore spam-marked mail omit this option. Examples:
                  --spam <a href="file:~/Mail/spam">~/Mail/spam</a>
                  --spam :HDRS: <a href="file:~/Mail/spam">~/Mail/spam</a>

       o      NO-CONFIG <b>--syntax</b>
              perform  a  syntax  check  of  the  specified  rules.  Encountered syntax errors are logged in the
              log-file. The begin and end of the syntax check is also logged in the log file. No  mail  is  read
              from the standard input stream.

       o      NO-CONFIG <b>--version</b> (<b>-v</b>)
              writes <b>filtermail</b>’s version to <u>cout</u> and ends, returning 0.

</pre><h4><b>FILTERMAIL</b> <b>INSPECT</b></h4><pre>
       When specifying the <u>--inspect</u> (<u>-I</u>) option <b>filtermail</b> expects a received e-mail file at its standard input
       showing  the  domain  name  of  the  sender,  its  IP  address,  its country of origin and the cidr-range
       containing the received IP address. E.g.,

           from renxincj.com (unknown [104.223.188.228])
           IP = `104.223.188.228’, Country: US,  CIDR = 104.223.128.0/17

       Mail handling programs (e.g., <b><a href="../man1/mutt.1.html">mutt</a></b>(1)) allow its users to pipe an  e-mail  file  to  a  program,  so  the
       received  e-mail  can  be inspected from inside the mail handling program. E.g., with <u>mutt</u> typing <u>|</u> shows
       the prompt

           Pipe to command:

       and assuming that the <b>filtermail</b> program is available in  the  user’s  <u>PATH</u>  environment  variable  enter
       `<b>filtermail</b> -I’ to pass the received e-mail to <b>filtermail</b>:

           Pipe to command: filtermail -I

       Depending  on  the  content  of  the  <u>Received:</u>  headers <b>filtermail</b>’s output shows the domain name of the
       sender, its IP address, its country of origin and the cidr-range  containing  the  received  IP  address.
       E.g.,

           from renxincj.com (unknown [104.223.188.228])
           IP = `104.223.188.228’, Country: US,  CIDR = 104.223.128.0/17

       IP version 6 addresses are also inspected, producing output like

           from mail.resoascijournal.info (s857e6ba3.fastvps-server.com \
                                                       [2a03:f480:2:8::3f])
           IP = `2a03:f480:2:8::3f’, Country: EE,  CIDR = 2a03:f480:2::/48

       If the received e-mail is considered conspicuous (e.g., spam or mail to ignore) then the cidr range could
       be  added  to a file like <u>suspect.cidr</u>. Once more e-mails from the suspected cidr-range are received, the
       range could be added to, e.g., <u><a href="file:~/etc/filtermail/spam/cidr">~/etc/filtermail/spam/cidr</a></u> or  to  <u><a href="file:~/etc/filtermail/ignore/cidr">~/etc/filtermail/ignore/cidr</a></u>,  using  a
       pattern line like

               1   23-05-10    s ’2a03:f480:2:’

       When  the  option  <u>--cls</u> is specified as <u>yes</u> (either as command-line option or in the configuration file)
       then the terminal screen will be cleared before showing <u>--inspect’s</u> output.  When the  option  <u>--received</u>
       is  specified <u>Received:</u> headers appearing before the <u>Received:</u> header containing the content specified at
       the <u>--received</u> option are ignored.

</pre><h4><b>EXAMPLES</b></h4><pre>
       o      <u>configure</u> <b>filtermail</b> <u>as</u> <u>a</u> <u>valid</u> <u>mail</u> <u>handling</u> <u>program:</u>

       Commonly incoming mail servers define a directory where valid mail handling programs (or links  to  those
       programs) are listed. E.g., <b><a href="../man8/sendmail.8.html">sendmail</a></b>(8) uses the `sendmail restricted shell’ (<u>/etc/mail/smrsh</u>) directory.
       If  <b>filtermail</b>  is  installed  in  a  standard  user-accessible directory (e.g., <u><a href="file:/usr/bin">/usr/bin</a></u>) then the <u>smrsh</u>
       directory should contain the link
           filtermail -&gt; /usr/bin/filtermail

       Once the <b>filtermail</b> program is recognized by the incoming mail server users may  filter  incoming  e-mail
       through <b>filtermail</b> using, e.g., a <u><a href="file:~/.forward">~/.forward</a></u> file. Such <u>.forward</u> files ignore empty lines and end-of-line
       comment  (starting  at  <u>#</u>).  Assuming a standard <b>filtermail</b>-configuration (cf. section <b>CONFIGURATION</b>) and
       assuming that user <u>frank’s</u> home-directory is <u>/home/frank</u>, then <u>/home/frank/.forward</u>  should  contain  the
       following line:
           "|/usr/bin/filtermail /home/USER"
       Note the double quotes: they are required because <b>filtermail</b> is called with an argument.

       o      <u>a</u> <u>configuration</u> <u>file</u>:

       The  following configuration file specifies that the <u>rules</u> and log files are located in the configuration
       file’s directory and defines paths for all three mail categories:
           rules:  rules
           log:    log/log
           accept: /var/spool/mail/USER
           spam:   <a href="file:~/Mail/spam">~/Mail/spam</a>
           ignore: <a href="file:~/Mail/ignore">~/Mail/ignore</a>

           # as illustration of a ’dont-expire:’ specification:
           #dont-expire: ./ignore/from

       o      <u>rule</u> <u>specifications</u>:

       Filtering rules are defined in the file specified by the <u>--rules</u> option or in  the  <u>rules:</u>  line  of  the
       configuration file. Note that the pattern files must start with <u>./</u>.

           if From:                    ./ignore/from           ignore
           if Subject:                 ./spam/nolowercase      spam

               # inspect all Received... headers:
           if Received+                ./spam/cidr             spam

               # a To: or Cc: header is required:
           if To:  ./match/noto  and  Cc: ./match/noto ignore

       The  final  rule  uses  the  pattern  in  <u>./match/tocc</u> (shown below) specifying the `any character’ (<u>’.’</u>)
       regular expression: if the <u>To:</u> header is empty (which is also true if there is no <u>To:</u>  header,  then  the
       <u>not</u>  <u>To:</u> condition matches. The same holds true for the second condition. So if neither condition matches
       there is neither a <u>To:</u> nor a <u>Cc:</u> header, in which case the e-mail is sent to the <u>spam</u>  destination.  Also
       note that, according to <u>De</u> <u>Morgan’s</u> rule, a <u>not</u> <u>X</u> <u>and</u> <u>not</u> <u>Y</u> rule is identical to an <u>X</u> <u>or</u> <u>Y</u> rule.

       o      <u>pattern</u> <u>specifications</u>:

           # the ./spam/nolowercase pattern:
           1   23-05-10    not p   ’[a-z]’

           # e.g., the ./match/noto as used in the above example
           #       requiring either a To: or a Cc: header:
           1   23-05-10    p  not  ’.’

</pre><h4><b>FILES</b></h4><pre>
       By  default  the  configuration  file  is  expected  in  the subdirectory <u>etc/filtermail</u> of the directory
       specified as <b>filtermail</b>’s argument.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/mutt.1.html">mutt</a></b>(1), <b><a href="../man3bobcat/pattern.3bobcat.html">pattern</a></b>(3bobcat), <b><a href="../man3/regcomp.3.html">regcomp</a></b>(3), <b><a href="../man8/sendmail.8.html">sendmail</a></b>(8), <b><a href="../man3/syslog.3.html">syslog</a></b>(3), <b><a href="../man1/tput.1.html">tput</a></b>(1), <b><a href="../man1/whois.1.html">whois</a></b>(1)

</pre><h4><b>BUGS</b></h4><pre>
       None reported.

</pre><h4><b>AUTHOR</b></h4><pre>
       Frank B. Brokken (<a href="mailto:f.b.brokken@rug.nl">f.b.brokken@rug.nl</a>).

filtermail_1.06.00                                  2023-2025                                      <u><a href="../man1/filtermail.1.html">filtermail</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>