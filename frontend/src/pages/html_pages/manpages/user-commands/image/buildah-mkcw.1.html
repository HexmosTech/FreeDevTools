<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>buildah-mkcw - Convert a conventional container image into a confidential workload image.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/buildah">buildah_1.39.3+ds1-1syncable1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       buildah-mkcw - Convert a conventional container image into a confidential workload image.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>buildah</b> <b>mkcw</b> [<u>options</u>] <u>source</u> <u>destination</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Converts  the  contents  of  a  container image into a new container image which is suitable for use in a
       trusted execution environment (TEE), typically run using krun (i.e., crun built with the libkrun  feature
       enabled  and  invoked as <u>krun</u>).  Instead of the conventional contents, the root filesystem of the created
       image will contain an encrypted disk image and configuration information for krun.

</pre><h4><b>source</b></h4><pre>
       A container image, stored locally or in a registry

</pre><h4><b>destination</b></h4><pre>
       A container image, stored locally or in a registry

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--add-file</b> <u>source[:destination]</u>

       Read the contents of the file <b>source</b> and add it to the committed image as  a  file  at  <b>destination</b>.   If
       <b>destination</b>  is not specified, the path of <b>source</b> will be used.  The new file will be owned by UID 0, GID
       0, have 0644 permissions, and be given a current timestamp.  This option can be specified multiple times.

       <b>--attestation-url</b>, <b>-u</b> <u>url</u> The location of a key broker / attestation server.  If a  value  is  specified,
       the new image's workload ID, along with the passphrase used to encrypt the disk image, will be registered
       with  the  server, and the server's location will be stored in the container image.  At run-time, krun is
       expected to contact the server to retrieve the passphrase using the workload ID, which is also stored  in
       the container image.  If no value is specified, a <u>passphrase</u> value <u>must</u> be specified.

       <b>--base-image</b>,  <b>-b</b>  <u>image</u>  An  alternate  image  to use as the base for the output image.  By default, the
       <u>scratch</u> non-image is used.

       <b>--cpus</b>, <b>-c</b> <u>number</u> The number of virtual CPUs which the image expects to be run with at run-time.  If  not
       specified, a default value will be supplied.

       <b>--firmware-library</b>,  <b>-f</b> <u>file</u> The location of the libkrunfw-sev shared library.  If not specified, <b>buildah</b>
       checks for its presence in a number of hard-coded locations.

       <b>--memory</b>, <b>-m</b> <u>number</u> The amount of memory which the image expects to be run with at run-time, as a  number
       of megabytes.  If not specified, a default value will be supplied.

       <b>--passphrase</b>,  <b>-p</b>  <u>text</u>  The  passphrase  to  use to encrypt the disk image which will be included in the
       container image.  If no value is specified, but an <u>--attestation-url</u>  value  is  specified,  a  randomly-
       generated  passphrase  will  be  used.   The  authors  recommend  setting  an <u>--attestation-url</u> but not a
       <u>--passphrase</u>.

       <b>--slop</b>, <b>-s</b> <u>{percentage%|sizeKB|sizeMB|sizeGB}</u> Extra space to allocate for the disk image compared to  the
       size of the container image's contents, expressed either as a percentage (..%) or a size value (bytes, or
       larger units if suffixes like KB or MB are present), or a sum of two or more such specifications.  If not
       specified,  <b>buildah</b>  guesses  that  25%  more  space than the contents will be enough, but this option is
       provided in case its guess is wrong.  If the specified or computed size is less  than  10  megabytes,  it
       will be increased to 10 megabytes.

       <b>--type</b>, <b>-t</b> {SEV|SNP} The type of trusted execution environment (TEE) which the image should be marked for
       use  with.   Accepted  values are "SEV" (AMD Secure Encrypted Virtualization - Encrypted State) and "SNP"
       (AMD Secure Encrypted Virtualization - Secure Nested Paging).  If not specified, defaults to "SNP".

       <b>--workload-id</b>, <b>-w</b> <u>id</u> A workload identifier which will be recorded in the container image, to be  used  at
       run-time  for  retrieving  the  passphrase which was used to encrypt the disk image.  If not specified, a
       semi-random value will be derived from the base image's image ID.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/buildah.1.html">buildah</a>(1)

buildah                                             July 2023                                    <u><a href="../man1/buildah-mkcw.1.html">buildah-mkcw</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>