<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>umoci insert - insert content into an OCI image</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/umoci">umoci_0.4.7+ds-4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       umoci insert - insert content into an OCI image

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>umoci</b>  <b>insert</b>  <b>--image</b>=<u>image</u>[:<u>tag</u>]  [<b>--tag</b>=<u>new-tag</u>]  [<b>--opaque</b>]  [<b>--rootless</b>]  [<b>--uid-map</b>=<u>value</u>]  [<b>--uid-</b>
       <b>map</b>=<u>value</u>]       [<b>--no-history</b>]       [<b>--history.comment</b>=<u>comment</u>]       [<b>--history.created_by</b>=<u>created_by</u>]
       [<b>--history.author</b>=<u>author</u>] [<b>--history-created</b>=<u>date</u>] <u>source</u> <u>target</u>

       <b>umoci</b> <b>insert</b> [options] <b>--whiteout</b> <u>target</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       In  the  first  form, insert the contents of <u>source</u> into the OCI image given by <b>--image</b> -- <b>overwriting</b> <b>it</b>
       <b>unless</b> <b>you</b> <b>specify</b> <b>--tag</b>. This is done by creating a new layer containing just  the  contents  of  <u>source</u>
       with  a  name  of  <u>target</u>.  <u>source</u>  can  be either a file or directory, and in the latter case it will be
       recursed. If <b>--opaque</b> is specified then any paths below <u>target</u> in the  previous  image  layers  (assuming
       <u>target</u> is a directory) will be removed.

       In  the  second  form, inserts a "deletion entry" into the OCI image for <u>target</u> inside the image. This is
       done by inserting a layer containing just a whiteout entry for the given path.

       Note that this command works by creating a new layer, so this should not be used to remove  (or  replace)
       secrets  from  an  already-built  image.  See <b><a href="../man1/umoci-config.1.html">umoci-config</a></b>(1) and <b>--config.volume</b> for how to achieve this
       correctly by not creating image layers with secrets in the first place.

       If <b>--no-history</b> was not specified, a history entry is appended to the tagged OCI image  for  this  change
       (with the various <b>--history.</b> flags controlling the values used). To view the history, see <b><a href="../man1/umoci-stat.1.html">umoci-stat</a></b>(1).

</pre><h4><b>OPTIONS</b></h4><pre>
       The global options are defined in <b><a href="../man1/umoci.1.html">umoci</a></b>(1).

       <b>--image</b>=<u>image</u>[:<u>tag</u>]
         The source and destination tag for the insertion of <u>file</u> at <u>path</u> inside
         the container image. <u>image</u> must be a path to a valid OCI image and <u>tag</u>
         must be a valid tag in the image. If <u>tag</u> is not provided it defaults to
         "latest".

       <b>--tag</b>=<u>new-tag</u>
         Tag name for the modified image, if unspecified then the original tag
         provided to <b>--image</b> will be clobbered.

       <b>--opaque</b>
         (Assuming <u>target</u> is a directory.) Add an opaque whiteout entry for <u>target</u>
         so that any child path of <u>target</u> in previous layers is masked by the new
         entry for <u>target</u>, which will just contain the contents of <u>source</u>. This
         allows for the complete replacement of a directory, as opposed to the merging
         of directory entries.

       <b>--whiteout</b>
         Add a deletion entry for <u>target</u>, so that it is not present in future
         extractions of the image.

       <b>--rootless</b>
         Enable rootless insertion support. This allows for <b><a href="../man1/umoci-insert.1.html">umoci-insert</a></b>(1) to be
         used as an unprivileged user. Use of this flag implies <b>--uid-map=0:$(id</b>
         <b>-u):1</b> and <b>--gid-map=0:$(id</b> <b>-g):1</b>, as well as enabling several features
         to fake parts of the recursion process in an attempt to generate an
         as-close-as-possible clone of the filesystem for insertion.

       <b>--uid-map</b>=<u>value</u>
         Specifies a UID mapping to use when inserting files. This is used in a
         similar fashion to <b><a href="../man7/user_namespaces.7.html">user_namespaces</a></b>(7), and is of the form
         <b>container:host[:size]</b>.

       <b>--gid-map</b>=<u>value</u>
         Specifies a GID mapping to use when inserting files. This is used in a
         similar fashion to <b><a href="../man7/user_namespaces.7.html">user_namespaces</a></b>(7), and is of the form
         <b>container:host[:size]</b>.

       <b>--no-history</b>
         Causes no history entry to be added for this operation. <b>This</b> <b>is</b> <b>not</b>
         <b>recommended</b> <b>for</b> <b>use</b> <b>with</b> <b><a href="../man1/umoci-insert.1.html">umoci-insert</a>(1),</b> <b>since</b> <b>it</b> <b>results</b> <b>in</b> <b>the</b> <b>history</b> <b>not</b>
         <b>including</b> <b>all</b> <b>of</b> <b>the</b> <b>image</b> <b>layers</b> <b>--</b> <b>and</b> <b>thus</b> <b>will</b> <b>cause</b> <b>confusion</b> <b>with</b> <b>tools</b>
         <b>that</b> <b>look</b> <b>at</b> <b>image</b> <b>history.</b>

       <b>--history.comment</b>=<u>comment</u>
         Comment for the history entry corresponding to this modification of the image
         If unspecified, <b><a href="../man1/umoci.1.html">umoci</a></b>(1) will generate an implementation-dependent value.

       <b>--history.created_by</b>=<u>created_by</u>
         CreatedBy entry for the history entry corresponding to this modification of
         the image. If unspecified, <b><a href="../man1/umoci.1.html">umoci</a></b>(1) will generate an
         implementation-dependent value.

       <b>--history.author</b>=<u>author</u>
         Author value for the history entry corresponding to this modification of the
         image. If unspecified, this value will be the image's author value <b>after</b>
         any modifications were made by this call of <b><a href="../man1/umoci-config.1.html">umoci-config</a></b>(1).

       <b>--history-created</b>=<u>date</u>
         Creation date for the history entry corresponding to this modifications of
         the image. This must be an ISO8601 formatted timestamp (see <b><a href="../man1/date.1.html">date</a></b>(1)). If
         unspecified, the current time is used.

</pre><h4><b>EXAMPLE</b></h4><pre>
       The  following  inserts  a file <b>mybinary</b> into the path <b>/usr/bin/mybinary</b> and a directory <b>myconfigdir</b> into
       the path <b>/etc/myconfigdir</b>. It should be noted that if <b>/etc/myconfigdir</b> already exists in the  image,  the
       contents of the two directories are merged (with the newer layer taking precedence).

       % umoci insert --image oci:foo mybinary /usr/bin/mybinary
       % umoci insert --image oci:foo myconfigdir /etc/myconfigdir

       And  in  these  examples we delete <b>/usr/bin/mybinary</b> and replace the entirety of <b><a href="file:/etc">/etc</a></b> with <b>myetcdir</b> (such
       that none of the old <b><a href="file:/etc">/etc</a></b> entries will be present on <b><a href="../man1/umoci-unpack.1.html">umoci-unpack</a></b>(1)).

       % umoci insert --image oci:foo --whiteout /usr/bin/mybinary
       % umoci insert --image oci:foo --opaque myetcdir <a href="file:/etc">/etc</a>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/umoci.1.html">umoci</a></b>(1), <b><a href="../man1/umoci-repack.1.html">umoci-repack</a></b>(1), <b><a href="../man1/umoci-raw-add-layer.1.html">umoci-raw-add-layer</a></b>(1)

insert                                                umoci                                   <u><a href="../man1/umoci-insert.1.html">umoci-insert</a>(1)</u>(#)
</pre>
 </div>
</div></section>
</div>
</body>
</html>