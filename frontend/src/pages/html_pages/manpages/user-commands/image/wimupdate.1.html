<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>wimupdate - Update a WIM image</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/wimtools">wimtools_1.14.4-1.1build4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       wimupdate - Update a WIM image

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>wimupdate</b> <u>WIMFILE</u> [<u>IMAGE</u>] [<u>OPTION</u>...] [&lt; <u>CMDFILE</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>wimupdate</b>,  or  equivalently  <b>wimlib-imagex</b>  <b>update</b>,  modifies the specified <u>IMAGE</u> in the Windows Imaging
       (WIM) archive <u>WIMFILE</u> by adding, deleting, or renaming files or directories in it.

       <u>IMAGE</u> specifies the image in <u>WIMFILE</u> to update.  It may be the 1-based index of an image or the  name  of
       an  image.   It  may  be  omitted if <u>WIMFILE</u> contains only one image.  You can use <b><a href="../man1/wiminfo.1.html">wiminfo</a></b>(1) to list the
       images contained in <u>WIMFILE</u>.

       The modifications to perform on the WIM image are specified as a sequence of commands, one per line, read
       in a text file (UTF-8 or UTF-16LE encoded; plain  ASCII  is  also  fine)  from  standard  input.   It  is
       recommended  that  standard input be redirected from a file (<u>CMDFILE</u>), as shown above, rather than typing
       in commands interactively.  Alternatively, to specify a command directly on the  command  line,  see  the
       <b>--command</b> option.

</pre><h4><b>AVAILABLE</b> <b>COMMANDS</b></h4><pre>
       This section documents the commands that may appear in the <u>CMDFILE</u> described above.

   <b>add</b> [<u><b>OPTION</b></u>...] <u><b>SOURCE</b></u> <u><b>DESTINATION</b></u>
       Add  a  file  or directory tree to the WIM image.  <u>SOURCE</u> must specify the path to a file or directory on
       your filesystem.  <u>DESTINATION</u> must specify the path inside the WIM image at which  to  add  the  file  or
       directory tree.

       If  <u>DESTINATION</u>  names  an  existing  directory in the WIM image, then <u>SOURCE</u> must also name a directory.
       This causes the contents of the <u>SOURCE</u> directory to be added to the <u>DESTINATION</u> directory.

       If <u>DESTINATION</u> names an existing nondirectory file in the  WIM  image,  then  <u>SOURCE</u>  must  also  name  a
       nondirectory  file.   By  default,  this causes the <u>DESTINATION</u> file to be replaced with the <u>SOURCE</u> file.
       Or, with <b>--no-replace</b> specified, this generates an error.

       If <u>DESTINATION</u> does not exist in the WIM image, then any prerequisite directories are created  as  needed
       to add the <u>SOURCE</u> at that location.

       The  <b>add</b>  command supports a subset of the options accepted by <b>wimcapture</b>; namely, <b>--dereference</b>, <b>--unix-</b>
       <b>data</b>, <b>--no-acls</b>, and <b>--strict-acls</b>.  See <b><a href="../man1/wimcapture.1.html">wimcapture</a></b>(1) for explanations of these options.

       In addition, the <b>add</b> command supports the <b>--no-replace</b> option, which causes the <b>add</b> command to refuse  to
       overwrite existing nondirectory files in the WIM image.

   <b>delete</b> [<u><b>OPTION</b></u>...] <u><b>PATH</b></u>
       Delete  a  file or directory tree from the WIM image.  <u>PATH</u> must specify the path inside the WIM image of
       the file or directory tree to delete.

       The available options for the <b>delete</b> command are:

       <b>--force</b>
             Do not issue an error if the path to delete does not exist.

       <b>--recursive</b>
             Delete the file or directory tree recursively; if not specified, an error is issued if the path  to
             delete is a directory.

   <b>rename</b> <u><b>OLD_PATH</b></u> <u><b>NEW_PATH</b></u>
       Rename  a file or directory tree inside the WIM image.  <u>OLD_PATH</u> must specify the old path of the file or
       directory tree inside the WIM image, and <u>NEW_PATH</u> must specify the new path for  the  file  or  directory
       tree.  This command follows the semantics of the POSIX <b>rename</b> (3) function; in particular, a pre-existing
       file  at  <u>NEW_PATH</u>  will  be  deleted  if present, except in certain cases such as attempting to rename a
       directory to a non-directory, which is not allowed.

       There are no options available for the <b>rename</b> command.

</pre><h4><b>OPTIONS</b></h4><pre>
       The following options are accepted on the command line by <b>wimupdate</b> itself:

       <b>--dereference</b>
             Use <b>--dereference</b> for all <b>add</b> commands.

       <b>--unix-data</b>
             Use <b>--unix-data</b> for all <b>add</b> commands.

       <b>--no-acls</b>
             Use <b>--no-acls</b> for all <b>add</b> commands.

       <b>--strict-acls</b>
             Use <b>--strict-acls</b> for all <b>add</b> commands.

       <b>--no-replace</b>
             Use <b>--no-replace</b> for all <b>add</b> commands.

       <b>--config</b>=<u>FILE</u>
             Set the capture configuration file for all <b>add</b> commands.  See the description  of  this  option  to
             <b><a href="../man1/wimcapture.1.html">wimcapture</a></b>(1).

       <b>--force</b>
             Use <b>--force</b> for all <b>delete</b> commands.

       <b>--recursive</b>
             Use <b>--recursive</b> for all <b>delete</b> commands.

       <b>--check</b>
             Before  updating  the  WIM,  verify its integrity if it contains extra integrity information.  Also
             include extra integrity information in the updated WIM even if it was not present before.

       <b>--include-integrity</b>
             Include extra integrity information in the updated WIM, i.e. like <b>--check</b> but don't also verify the
             WIM beforehand.

       <b>--threads</b>=<u>NUM_THREADS</u>
             Number of threads to use for  compressing  newly  added  files.   Default:  autodetect  (number  of
             processors).

       <b>--rebuild</b>
             Rebuild the entire WIM rather than appending the updated data to the end of it.  Rebuilding the WIM
             is  slower,  but  will save a little bit of space that would otherwise be left as a hole in the WIM
             file.

             See <b><a href="../man1/wimoptimize.1.html">wimoptimize</a></b>(1) for a more customizable way of rebuilding (and optionally recompressing)  a  WIM
             file.  If running <b>wimoptimize</b> after <b>wimupdate</b>, there is no need to specify <b>--rebuild</b> to <b>wimupdate</b>.

       <b>--command</b>=<u>STRING</u>
             Instead  of reading update commands from standard input, read a single update command directly from
             the string <u>STRING</u> specified on the command line.  This option cannot be provided more than one time
             and cannot be used to specify more than one update command.  Note that the <u>STRING</u>, as well  as  any
             paths containing spaces within the <u>STRING</u> must be appropriately quoted.  If running from cmd.exe on
             Windows,  you should use double quotes for the outer quotes and single quotes for the inner quotes.
             Example:

                    wimupdate boot.wim 1 --command="add 'C:\My Dir' '\My Dir'"

             This option is provided for convenience only.  Do not execute <b>wimupdate</b> multiple consecutive times,
             each time passing the <b>--command</b> option!  This is inefficient.  Instead, generate an update  command
             file  and  provide it (on standard input) to a single invocation of <b>wimupdate</b>, as explained in this
             document.

       <b>--wimboot-config</b>=<u>FILE</u>
             If this option is specified, no commands shall  be  read  from  standard  input,  and  instead  the
             following command shall be executed:

                    <b>add</b> <u>FILE</u> /Windows/System32/WimBootCompress.ini

             This  sets  <u>FILE</u> as the WIMBoot configuration file for the image.  The [PrepopulateList] section of
             this file specifies path globs that shall not be extracted as WIMBoot pointer files (perhaps due to
             being needed early in the boot process).   See  the  documentation  for  the  <b>--wimboot</b>  option  of
             <b><a href="../man1/wimapply.1.html">wimapply</a></b>(1) for more information.

       <b>--unsafe-compact</b>
             Compact  the WIM archive in-place and append any new data, eliminating "holes".  This is efficient,
             but in general this option should <u>not</u> be used because  a  failed  or  interrupted  compaction  will
             corrupt  the  WIM  archive.   For  more  information,  see  the  documentation  for  this option in
             <b><a href="../man1/wimoptimize.1.html">wimoptimize</a></b>(1).

       <b>--ref</b>="<u>GLOB</u>"
             File glob of WIM(s) on which the delta WIM is based.  Updating  split  WIMs  is  not  allowed,  but
             updating  delta  WIMs  is allowed.  When updating a delta WIM, the WIM(s) on which the delta WIM is
             based should be specified using this option.  (It isn't a hard requirement,  but  it's  needed  for
             data deduplication to work fully and for the TOTALBYTES statistic to be correctly updated.)

</pre><h4><b>NOTES</b></h4><pre>
       <b>wimupdate</b>  can  be viewed as redundant with <b>wimmountrw</b>, since a WIM image can also be updated by mounting
       it read-write.  However, <b>wimupdate</b> works on all platforms  including  Windows,  whereas  <b>wimmountrw</b>  only
       works on Linux.

       Symbolic  links  inside a WIM image are not dereferenced when being interpreted.  So, for example, if you
       have a WIM image that contains a symbolic link "/Documents and Settings" -&gt; "/Users" where "/Users" is  a
       directory,  then  a  subdirectory  named  "Public" in this directory must be specified as "/Users/Public"
       rather than "/Documents and Settings/Public".

       All paths to files or directories within the WIM image must be specified relative  to  the  root  of  the
       image.   However,  the  leading slash is optional, and both forward slashes and backslashes are accepted.
       In addition, on Windows, the paths are by default treated case-insensitively, while on UNIX-like systems,
       the paths are by default treated case-sensitively.  The  default  case  sensitivity  may  be  changed  by
       setting the <b>WIMLIB_IMAGEX_IGNORE_CASE</b> environmental variable to 0 or 1.

       The  command  file  (<u>CMDFILE</u>)  is parsed by <b>wimupdate</b> itself and not by the system shell.  Therefore, its
       syntax is limited.  However, comment lines beginning with '#' are allowed, and it  is  also  possible  to
       quote arguments with whitespace inside them.

       On  UNIX-like  systems,  you  cannot  use <b>wimupdate</b> to add files to an image directly from an NTFS volume
       using libntfs-3g, even though <b>wimcapture</b> supports capturing a full image this way.

       Except when using <b>--unsafe-compact</b>, it is safe to abort a <b>wimupdate</b>  command  partway  through;  however,
       after  doing  this,  it  is  recommended  to  run <b>wimoptimize</b> to remove any data that was appended to the
       physical WIM file but not yet incorporated into the structure of the WIM, unless <b>--rebuild</b> was specified,
       in which case you should delete the temporary file left over.

</pre><h4><b>EXAMPLES</b></h4><pre>
       All the examples below show the update command file to be created as well as the <b>wimupdate</b> command to run
       to perform the updates.

       Delete two files from a WIM image:

              <u>update_commands.txt</u>:

                     delete /setup.exe
                     delete /sources/setup.exe

              $ wimupdate boot.wim 2 &lt; update_commands.txt

       Add some files and directories to a WIM image.  Note that the first path of each  <b>add</b>  command  specifies
       the  files  to  add, while the second path of each <b>add</b> command specify the locations at which to add them
       inside the WIM image:

              <u>update_commands.txt</u>:

                     add somedir     /dir
                     add somefile    /dir/file

              $ wimupdate boot.wim 2 &lt; update_commands.txt

       Rename a file inside a WIM image.

              <u>update_commands.txt</u>:

                     rename /dir_in_wim/oldfile.txt /dir_in_wim/newfile.txt

              $ wimupdate boot.wim 2 &lt; update_commands.txt

       Using additional features, such as  comments,  options,  and  overlays,  and  including  extra  integrity
       information in the updated WIM:

              <u>update_commands.txt</u>:

                     #
                     # This file specifies some changes to make to a WIM image.
                     #

                     # Add a new directory containing files I want in the image.
                     # The quotes are necessary because the directory name
                     # contains a space.
                     add "My Directory" "/My Directory"

                     # Add the contents of "Another Directory" to the
                     # "/My Directory" we just created in the WIM image.  Since
                     # the destination path already exists, this performs an
                     # overlay.
                     add "Another Directory" "/My Directory"

                     # Rename some file for some reason.
                     rename /dir_in_wim/oldfile.txt /dir_in_wim/newfile.txt

                     # Delete an unwanted directory.
                     delete --recursive /Users/Me/Documents/Junk

              $ wimupdate boot.wim 2 --check &lt; update_commands.txt

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/wimlib-imagex.1.html">wimlib-imagex</a></b>(1) <b><a href="../man1/wimcapture.1.html">wimcapture</a></b>(1) <b><a href="../man1/wiminfo.1.html">wiminfo</a></b>(1) <b><a href="../man1/wimmountrw.1.html">wimmountrw</a></b>(1) <b><a href="../man1/wimoptimize.1.html">wimoptimize</a></b>(1)

wimlib 1.14.4                                     February 2024                                     <u><a href="../man1/WIMUPDATE.1.html">WIMUPDATE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>