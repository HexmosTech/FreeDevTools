<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pkcs15-init - smart card personalization utility</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/opensc">opensc_0.26.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pkcs15-init - smart card personalization utility

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>pkcs15-init</b> [<u>OPTIONS</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>pkcs15-init</b> utility can be used to create a PKCS #15 structure on a smart card, and add key or
       certificate objects. Details of the structure that will be created are controlled via profiles.

       The profile used by default is <b>pkcs15</b>. Alternative profiles can be specified via the <b>-p</b> switch.

</pre><h4><b>PIN</b> <b>USAGE</b></h4><pre>
       <b>pkcs15-init</b> can be used to create a PKCS #15 structure on your smart card, create PINs, and install keys
       and certificates on the card. This process is also called <u>personalization</u>.

       An OpenSC card can have one security officer PIN, and zero or more user PINs. PIN stands for Personal
       Identification Number, and is a secret code you need to present to the card before being allowed to
       perform certain operations, such as using one of the stored RSA keys to sign a document, or modifying the
       card itself.

       Usually, PINs are a sequence of decimal digits, but some cards will accept arbitrary ASCII characters. Be
       aware however that using characters other than digits will make the card unusable with PIN pad readers,
       because those usually have keys for entering digits only.

       The security officer (SO) PIN is special; it is used to protect meta data information on the card, such
       as the PKCS #15 structure itself. Setting the SO PIN is optional, because the worst that can usually
       happen is that someone finding your card can mess it up. To extract any of your secret keys stored on the
       card, an attacker will still need your user PIN, at least for the default OpenSC profiles. However, it is
       possible to create card profiles that will allow the security officer to override user PINs.

       For each PIN, you can specify a PUK (also called <u>unblock</u> <u>PIN</u>). The PUK can be used to overwrite or unlock
       a PIN if too many incorrect values have been entered in a row.

       For some cards that use the PKCS#15 emulation, the attributes of private objects are protected and cannot
       be parsed without authentication (usually with User PIN). This authentication need to be done immediately
       after the card binding. In such cases <b>--verify-pin</b> has to be used.

</pre><h4><b>MODES</b> <b>OF</b> <b>OPERATION</b></h4><pre>
   <b>Initialization</b>
       This is the first step during card personalization, and will create the basic files on the card. To
       create the initial PKCS #15 structure, invoke the utility as

       <b>pkcs15-init</b> <b>--create-pkcs15</b>

       You will then be asked for the security officer PIN and PUK. Simply pressing return at the SO PIN prompt
       will skip installation of an SO PIN.

       If the card supports it, you should erase the contents of the card with <b>pkcs15-init</b> <b>--erase-card</b> before
       creating the PKCS#15 structure.

   <b>User</b> <b>PIN</b> <b>Installation</b>
       Before installing any user objects such as private keys, you need at least one PIN to protect these
       objects. you can do this using

       <b>pkcs15-init</b> <b>--store-pin</b> <b>--id</b> <b>"</b> <b>nn</b>

       where <u>nn</u> is a PKCS #15 ID in hexadecimal notation. Common values are 01, 02, etc.

       Entering the command above will ask you for the user's PIN and PUK. If you do not wish to install an
       unblock PIN, simply press return at the PUK prompt.

       To set a label for this PIN object (which can be used by applications to display a meaningful prompt to
       the user), use the <b>--label</b> command line option.

   <b>Key</b> <b>generation</b>
       <b>pkcs15-init</b> lets you generate a new key and store it on the card. You can do this using:

       <b>pkcs15-init</b> <b>--generate-key</b> <b>"keyspec"</b> <b>--auth-id</b> <b>"nn"</b>

       where <u>keyspec</u> describes the algorithm and the parameters of the key to be created. For example, rsa:2048
       generates a RSA key with 2048-bit modulus. If you are generating an EC key, the curve designation must be
       specified, for example ec:prime256v1. For symmetric key, the length of key is specified in bytes, for
       example AES:32 or DES3:24.

       <u>nn</u> is the ID of a user PIN installed previously, e.g.  01.

       In addition to storing the private portion of the key on the card, <b>pkcs15-init</b> will also store the public
       portion of the key as a PKCS #15 public key object.

   <b>Private</b> <b>Key</b> <b>Upload</b>
       You can use a private key generated by other means and upload it to the card. For instance, to upload a
       private key contained in a file named okir.pem, which is in PEM format, you would use

       <b>pkcs15-init</b> <b>--store-private-key</b> <b>okir.pem</b> <b>--id</b> <b>45</b> <b>--auth-id</b> <b>01</b>

       In addition to storing the private portion of the key on the card, <b>pkcs15-init</b> will also store the public
       portion of the key as a PKCS #15 public key object.

       Note that usage of <b>--id</b> option in the <b>pkcs15-init</b> commands to generate or to import a new key is
       deprecated. Better practice is to let the middleware to derive the identifier from the key material.
       (<a href="../manmodulus/SHA1.modulus.html">SHA1</a>(modulus) for RSA, ...). This allows easily set up relation between 'related' objects
       (private/public keys and certificates).

       In addition to the PEM key file format, <b>pkcs15-init</b> also supports DER encoded keys, and PKCS #12 files.
       The latter is the file format used by Netscape Navigator (among others) when exporting certificates to a
       file. A PKCS #12 file usually contains the X.509 certificate corresponding to the private key. If that is
       the case, <b>pkcs15-init</b> will store the certificate instead of the public key portion.

   <b>Public</b> <b>Key</b> <b>Upload</b>
       You can also upload individual public keys to the card using the <b>--store-public-key</b> option, which takes a
       filename as an argument. This file is supposed to contain the public key. If you don't specify a key file
       format using the <b>--format</b> option, <b>pkcs15-init</b> will assume PEM format. The only other supported public key
       file format is DER.

       Since the corresponding public keys are always uploaded automatically when generating a new key, or when
       uploading a private key, you will probably use this option only very rarely.

   <b>Certificate</b> <b>Upload</b>
       You can upload certificates to the card using the <b>--store-certificate</b> option, which takes a filename as
       an argument. This file is supposed to contain the PEM encoded X.509 certificate.

   <b>Uploading</b> <b>PKCS</b> <b>#12</b> <b>bags</b>
       Most browsers nowadays use PKCS #12 format files when you ask them to export your key and certificate to
       a file.  <b>pkcs15-init</b> is capable of parsing these files, and storing their contents on the card in a
       single operation. This works just like storing a private key, except that you need to specify the file
       format:

       <b>pkcs15-init</b> <b>--store-private-key</b> <b>okir.p12</b> <b>--format</b> <b>pkcs12</b> <b>--auth-id</b> <b>01</b>

       This will install the private key contained in the file okir.p12, and protect it with the PIN referenced
       by authentication ID 01. It will also store any X.509 certificates contained in the file, which is
       usually the user certificate that goes with the key, as well as the CA certificate.

   <b>Secret</b> <b>Key</b> <b>Upload</b>
       You can use a secret key generated by other means and upload it to the card. For instance, to upload an
       AES-secret key generated by the system random generator you would use

       <b>pkcs15-init</b> <b>--store-secret-key</b> <b>/dev/urandom</b> <b>--secret-key-algorithm</b> <b>aes:256</b> <b>--auth-id</b> <b>01</b>

       By default a random ID is generated for the secret key. You may specify an ID with the <b>--id</b> if needed.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--version</b>,
           Print the OpenSC package release version.

       <b>--card-profile</b> <u>name</u>, <b>-c</b> <u>name</u>
           Tells <b>pkcs15-init</b> to load the specified card profile option. You will rarely need this option.

       <b>--create-pkcs15</b>, <b>-C</b>
           This tells <b>pkcs15-init</b> to create a PKCS #15 structure on the card, and initialize any PINs.

       <b>--serial</b> <u>SERIAL</u>
           Specify the serial number of the card.

       <b>--erase-card</b>, <b>-E</b>
           This will erase the card prior to creating the PKCS #15 structure, if the card supports it. If the
           card does not support erasing, <b>pkcs15-init</b> will fail.

       <b>--erase-application</b> <u>AID</u>
           This will erase the application with the application identifier <u>AID</u>.

       <b>--generate-key</b> <u>keyspec</u>, <b>-G</b> <u>keyspec</u>
           Tells the card to generate new key and store it on the card.  <u>keyspec</u> consists of an algorithm name,
           optionally followed by a colon ":", slash "/" or hyphen "-" and the parameters of the key to be
           created. It is a good idea to specify the key ID along with this command, using the <b>id</b> option,
           otherwise an intrinsic ID will be calculated from the key material. Look the description of the
           'pkcs15-id-style' attribute in the 'pkcs15.profile' for the details about the algorithm used to
           calculate intrinsic ID. For the multi-application cards the target PKCS#15 application can be
           specified by the hexadecimal AID value of the <b>aid</b> option.

       <b>--pin</b> <u>pin</u>, <b>--puk</b> <u>puk</u>, <b>--so-pin</b> <u>sopin</u>, <b>--so-puk</b> <u>sopuk</u>
           These options can be used to specify the PIN/PUK values on the command line. If the value is set to
           env:<u>VARIABLE</u>, the value of the specified environment variable is used. By default, the code is
           prompted on the command line if needed.

           Note that on most operation systems, any user can display the command line of any process on the
           system using utilities such as <b><a href="../man1/ps.1.html">ps</a>(1)</b>. Therefore, you should prefer passing the codes via an
           environment variable on an unsecured system.

       <b>--no-so-pin</b>,
           Do not install a SO PIN, and do not prompt for it.

       <b>--profile</b> <u>name</u>, <b>-p</b> <u>name</u>
           Tells <b>pkcs15-init</b> to load the specified general profile. Currently, the only application profile
           defined is pkcs15, but you can write your own profiles and specify them using this option.

           The profile name can be combined with one or more profile options, which slightly modify the
           profile's behavior. For instance, the default OpenSC profile supports the <b>openpin</b> option, which
           installs a single PIN during card initialization. This PIN is then used both as the SO PIN as well as
           the user PIN for all keys stored on the card.

           Profile name and options are separated by a + character, as in pkcs15+onepin.

       <b>--secret-key-algorithm</b> <u>keyspec</u>,
           <u>keyspec</u> describes the algorithm and length of the key to be created or downloaded, such as aes:256.
           This will create a 256 bit AES key.

       <b>--store-certificate</b> <u>filename</u>, <b>-X</b> <u>filename</u>
           Tells <b>pkcs15-init</b> to store the certificate given in <b>filename</b> on the card, creating a certificate
           object with the ID specified via the <b>--id</b> option. Without supplied ID an intrinsic ID will be
           calculated from the certificate's public key. Look the description of the 'pkcs15-id-style' attribute
           in the 'pkcs15.profile' for the details about the algorithm used to calculate intrinsic ID. The file
           is assumed to contain the PEM encoded certificate. For the multi-application cards the target
           application can be specified by the hexadecimal AID value of the <b>aid</b> option.

       <b>--store-pin</b>, <b>-P</b>
           Store a new PIN/PUK on the card.

       <b>--store-public-key</b> <u>filename</u>
           Tells <b>pkcs15-init</b> to download the specified public key to the card and create a public key object
           with the key ID specified via the <b>--id</b>. By default, the file is assumed to contain the key in PEM
           format. Alternative formats can be specified using <b>--format</b>.

       <b>--store-private-key</b> <u>filename</u>, <b>-S</b> <u>filename</u>
           Tells <b>pkcs15-init</b> to download the specified private key to the card. This command will also create a
           public key object containing the public key portion. By default, the file is assumed to contain the
           key in PEM format. Alternative formats can be specified using <b>--format</b>. It is a good idea to specify
           the key ID along with this command, using the <b>--id</b> option, otherwise an intrinsic ID will be
           calculated from the key material. Look the description of the 'pkcs15-id-style' attribute in the
           'pkcs15.profile' for the details about the algorithm used to calculate intrinsic ID. For the
           multi-application cards the target PKCS#15 application can be specified by the hexadecimal AID value
           of the <b>aid</b> option.

       <b>--store-secret-key</b> <u>filename</u>,
           Tells <b>pkcs15-init</b> to download the specified secret key to the card. The file is assumed to contain
           the raw key. They key type should be specified with <b>--secret-key-algorithm</b> option.

           You may additionally specify the key ID along with this command, using the <b>--id</b> option, otherwise a
           random ID is generated. For the multi-application cards the target PKCS#15 application can be
           specified by the hexadecimal AID value of the <b>aid</b> option.

       <b>--store-data</b> <u>filename</u>, <b>-W</b> <u>filename</u>
           Store a data object.

       <b>--update-certificate</b> <u>filename</u>, <b>-U</b> <u>filename</u>
           Tells <b>pkcs15-init</b> to update the certificate object with the ID specified via the <b>--id</b> option with the
           certificate in <u>filename</u>. The file is assumed to contain a PEM encoded certificate.

           Pay extra attention when updating mail decryption certificates, as missing certificates can render
           e-mail messages unreadable!

       <b>--delete-objects</b> <u>arg</u>, <b>-D</b> <u>arg</u>
           Tells <b>pkcs15-init</b> to delete the specified object.  <u>arg</u> is comma-separated list containing any of
           privkey, pubkey, secrkey, cert, chain or data.

           When data is specified, an -<b>--application-id</b> must also be specified, in the other cases an <b>--id</b> must
           also be specified

           When chain is specified, the certificate chain starting with the cert with specified ID will be
           deleted, until there's a CA certificate that certifies another cert on the card

       <b>--change-attributes</b> <u>arg</u>, <b>-A</b> <u>arg</u>
           Tells <b>pkcs15-init</b> to change the specified attribute.  <u>arg</u> is either privkey, pubkey, secrkey, cert or
           data. You also have to specify the <b>--id</b> of the object. For now, you can only change the <b>--label</b>, e.g:

                                                       pkcs15-init -A cert --id 45 -a 1 --label Jim

       <b>--use-default-transport-keys</b>, <b>-T</b>
           Tells <b>pkcs15-init</b> to not ask for the transport keys and use default keys, as known by the card
           driver.

       <b>--sanity-check</b>
           Tells <b>pkcs15-init</b> to perform a card specific sanity check and possibly update procedure.

       <b>--reader</b> <u>arg</u>, <b>-r</b> <u>arg</u>
           Number of the reader to use. By default, the first reader with a present card is used. If <u>arg</u> is an
           ATR, the reader with a matching card will be chosen.

       <b>--verbose</b>, <b>-v</b>
           Causes <b>pkcs15-init</b> to be more verbose. Specify this flag several times to enable debug output in the
           OpenSC library.

       <b>--wait</b>, <b>-w</b>
           Causes <b>pkcs15-init</b> to wait for a card insertion.

       <b>--use-pinpad</b>
           Do not prompt the user; if no PINs supplied, pinpad will be used.

       <b>--auth-id</b> <u>filename</u>, <b>-a</b> <u>filename</u>
           Specify ID of PIN to use/create

       <b>--puk-id</b> <u>ID</u>
           Specify ID of PUK to use/create

       <b>--label</b> <u>LABEL</u>
           Specify label for a PIN, key, certificate or data object when creating a new objects. When deleting
           objects, this can be used to delete object by label.

       <b>--puk-label</b> <u>LABEL</u>
           Specify label of PUK

       <b>--public-key-label</b> <u>LABEL</u>
           Specify public key label (use with <b>--generate-key</b>)

       <b>--cert-label</b> <u>LABEL</u>
           Specify user cert label (use with <b>--store-private-key</b>)

       <b>--application-name</b> <u>arg</u>
           Specify application name of data object (use with <b>--store-data-object</b>)

       <b>--aid</b> <u>AID</u>
           Specify AID of the on-card PKCS#15 application to be binded to (in hexadecimal form)

       <b>--output-file</b> <u>filename</u> <b>-o</b> <u>filename</u>,
           Output public portion of generated key to file

       <b>--passphrase</b> <u>PASSPHRASE</u>
           Specify passphrase for unlocking secret key

       <b>--authority</b>
           Mark certificate as a CA certificate

       <b>--key-usage</b> <u>arg</u> <b>-u</b> <u>arg</u>,
           Specifies the X.509 key usage.  <u>arg</u> is comma-separated list containing any of digitalSignature,
           nonRepudiation, keyEncipherment, dataEncipherment, keyAgreement, keyCertSign, cRLSign. Abbreviated
           names are allowed if unique (e.g.  dataEnc).

           The alias sign is equivalent to digitalSignature,keyCertSign,cRLSign

           The alias decrypt is equivalent to keyEncipherment,dataEncipherment

       <b>--finalize</b> <b>-F</b>,
           Finish initialization phase of the smart card

       <b>--update-last-update</b>
           Update 'lastUpdate' attribute of tokenInfo

       <b>--ignore-ca-certificates</b>
           When storing PKCS#12 ignore CA certificates

       <b>--update-existing</b>
           Store or update existing certificate

       <b>--extractable</b>
           Private key stored as an extractable key

       <b>--user-consent</b> <u>arg</u>
           Specify user-consent.  <u>arg</u> is an integer value. If &gt; 0, the value specifies how many times the object
           can be accessed before a new authentication is required. If zero, the object does not require
           re-authentication.

       <b>--insecure</b>
           Insecure mode: do not require a PIN for private key

       <b>--md-container-guid</b> <u>GUID</u>
           For a new key specify GUID for a MD container

       <b>--help</b> <b>-h</b>,
           Display help message

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/pkcs15-profile.5.html">pkcs15-profile</a></b>(5)

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>pkcs15-init</b> was written by Olaf Kirch &lt;<a href="mailto:okir@suse.de">okir@suse.de</a>&gt;.

openscopensc                                       03/22/2025                              <u><a href="../man1/PKCS15-INITPKCS15-.1.html">PKCS15-INITPKCS15-</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>