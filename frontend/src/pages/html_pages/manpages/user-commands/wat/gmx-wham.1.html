<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gmx-wham - Perform weighted histogram analysis after umbrella sampling</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/gromacs-data">gromacs-data_2025.0-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gmx-wham - Perform weighted histogram analysis after umbrella sampling

</pre><h4><b>SYNOPSIS</b></h4><pre>
          gmx wham [<b>-ix</b> <u>[&lt;.dat&gt;]</u>] [<b>-if</b> <u>[&lt;.dat&gt;]</u>] [<b>-it</b> <u>[&lt;.dat&gt;]</u>] [<b>-is</b> <u>[&lt;.dat&gt;]</u>]
                   [<b>-iiact</b> <u>[&lt;.dat&gt;]</u>] [<b>-tab</b> <u>[&lt;.dat&gt;]</u>] [<b>-o</b> <u>[&lt;.xvg&gt;]</u>]
                   [<b>-hist</b> <u>[&lt;.xvg&gt;]</u>] [<b>-oiact</b> <u>[&lt;.xvg&gt;]</u>] [<b>-bsres</b> <u>[&lt;.xvg&gt;]</u>]
                   [<b>-bsprof</b> <u>[&lt;.xvg&gt;]</u>] [<b>-xvg</b> <u>&lt;enum&gt;</u>] [<b>-min</b> <u>&lt;real&gt;</u>] [<b>-max</b> <u>&lt;real&gt;</u>]
                   [<b>-[no]auto</b>] [<b>-bins</b> <u>&lt;int&gt;</u>] [<b>-temp</b> <u>&lt;real&gt;</u>] [<b>-tol</b> <u>&lt;real&gt;</u>]
                   [<b>-[no]v</b>] [<b>-b</b> <u>&lt;real&gt;</u>] [<b>-e</b> <u>&lt;real&gt;</u>] [<b>-dt</b> <u>&lt;real&gt;</u>]
                   [<b>-[no]histonly</b>] [<b>-[no]boundsonly</b>] [<b>-[no]log</b>] [<b>-unit</b> <u>&lt;enum&gt;</u>]
                   [<b>-zprof0</b> <u>&lt;real&gt;</u>] [<b>-[no]cycl</b>] [<b>-[no]sym</b>] [<b>-[no]ac</b>]
                   [<b>-acsig</b> <u>&lt;real&gt;</u>] [<b>-ac-trestart</b> <u>&lt;real&gt;</u>] [<b>-nBootstrap</b> <u>&lt;int&gt;</u>]
                   [<b>-bs-method</b> <u>&lt;enum&gt;</u>] [<b>-bs-tau</b> <u>&lt;real&gt;</u>] [<b>-bs-seed</b> <u>&lt;int&gt;</u>]
                   [<b>-histbs-block</b> <u>&lt;int&gt;</u>] [<b>-[no]vbs</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>gmx</b>  <b>wham</b>  is  an  analysis  program that implements the Weighted Histogram Analysis Method (WHAM). It is
       intended to analyze output files generated by umbrella sampling simulations to  compute  a  potential  of
       mean force (PMF).

       <b>gmx</b>  <b>wham</b>  is  currently  not  fully  up  to  date.  It  only  supports  pull setups where the first pull
       coordinate(s) is/are umbrella pull coordinates and, if multiple coordinates need to be analyzed, all used
       the same geometry and dimensions. In most cases this is not an issue.

       At present, three input modes are supported.

       • With option <b>-it</b>, the user provides a file which contains the file  names  of  the  umbrella  simulation
         run-input files (<u>.tpr</u> files), AND, with option <b>-ix</b>, a file which contains file names of the pullx <b>mdrun</b>
         output  files. The <u>.tpr</u> and pullx files must be in corresponding order, i.e. the first <u>.tpr</u> created the
         first pullx, etc.

       • Same as the previous input mode, except that the  user  provides  the  pull  force  output  file  names
         (<b>pullf.xvg</b>)  with  option <b>-if</b>.  From the pull force the position in the umbrella potential is computed.
         This does not work with tabulated umbrella potentials.

       By default, all pull coordinates found in all pullx/pullf files are used in WHAM. If  only  some  of  the
       pull  coordinates  should  be  used,  a  pull coordinate selection file (option <b>-is</b>) can be provided. The
       selection file must contain one line for each tpr file  in  tpr-files.dat.   Each  of  these  lines  must
       contain  one  digit  (0  or 1) for each pull coordinate in the tpr file.  Here, 1 indicates that the pull
       coordinate is used in WHAM, and 0 means it is omitted.  Example:  If  you  have  three  tpr  files,  each
       containing  4 pull coordinates, but only pull coordinates 1 and 2 should be used, coordsel.dat looks like
       this:

          1 1 0 0
          1 1 0 0
          1 1 0 0

       By default, the output files are:

          ``-o``      PMF output file
          ``-hist``   Histograms output file

       Always check whether the histograms sufficiently overlap.

       The umbrella potential is assumed to be harmonic and the force constants are read from the <u>.tpr</u> files. If
       a non-harmonic umbrella force was applied a tabulated potential can be provided with <b>-tab</b>.

   <b>WHAM</b> <b>options</b>
       • <b>-bins</b>   Number of bins used in analysis

       • <b>-temp</b>   Temperature in the simulations

       • <b>-tol</b>    Stop iteration if profile (probability) changed less than tolerance

       • <b>-auto</b>   Automatic determination of boundaries

       • <b>-min,-max</b>   Boundaries of the profile

       The data points that are used to compute the profile can be restricted with  options  <b>-b</b>,  <b>-e</b>,  and  <b>-dt</b>.
       Adjust <b>-b</b> to ensure sufficient equilibration in each umbrella window.

       With  <b>-log</b>  (default) the profile is written in energy units, otherwise (with <b>-nolog</b>) as probability. The
       unit can be specified with <b>-unit</b>.  With energy output, the energy in the first bin is defined to be zero.
       If you want the free energy at a different position to be zero, set <b>-zprof0</b> (useful  with  bootstrapping,
       see below).

       For  cyclic  or periodic reaction coordinates (dihedral angle, channel PMF without osmotic gradient), the
       option <b>-cycl</b> is useful.  <b>gmx</b> <b>wham</b> will make use of the periodicity of the system and generate a  periodic
       PMF. The first and the last bin of the reaction coordinate will assumed be be neighbors.

       Option <b>-sym</b> symmetrizes the profile around z=0 before output, which may be useful for, e.g. membranes.

   <b>Parallelization</b>
       If  available,  the  number  of  OpenMP  threads  used  by  gmx  wham  can  be  controlled by setting the
       <b>OMP_NUM_THREADS</b> environment variable.

   <b>Autocorrelations</b>
       With <b>-ac</b>, <b>gmx</b> <b>wham</b> estimates the integrated autocorrelation time (IACT) tau for each umbrella window  and
       weights the respective window with 1/[1+2*tau/dt]. The IACTs are written to the file defined with <b>-oiact</b>.
       In  verbose  mode,  all  autocorrelation  functions (ACFs) are written to <b>hist_autocorr.xvg</b>.  Because the
       IACTs can be severely underestimated in case of limited sampling, option <b>-acsig</b> allows one to smooth  the
       IACTs along the reaction coordinate with a Gaussian (sigma provided with <b>-acsig</b>, see output in <b>iact.xvg</b>).
       Note  that  the IACTs are estimated by simple integration of the ACFs while the ACFs are larger 0.05.  If
       you prefer to compute the IACTs by a more sophisticated (but possibly less robust) method such as fitting
       to a double exponential, you can compute the IACTs with <u>gmx</u> <u>analyze</u> and provide them to <b>gmx</b> <b>wham</b> with the
       file <b>iact-in.dat</b> (option <b>-iiact</b>), which should contain one line per input file (pullx/pullf file) and one
       column per pull coordinate in the respective file.

   <b>Error</b> <b>analysis</b>
       Statistical errors may be estimated with bootstrap analysis. Use it with care, otherwise the  statistical
       error  may be substantially underestimated.  More background and examples for the bootstrap technique can
       be found in Hub, de Groot and Van der Spoel, JCTC (2010) 6: 3713-3720.  <b>-nBootstrap</b> defines the number of
       bootstraps (use, e.g., 100).  Four bootstrapping methods are supported and selected with <b>-bs-method</b>.

       • <b>b-hist</b>   Default: complete histograms are considered as independent data points, and the  bootstrap  is
         carried  out by assigning random weights to the histograms ("Bayesian bootstrap"). Note that each point
         along the reaction coordinate must be covered by multiple independent histograms (e.g. 10  histograms),
         otherwise the statistical error is underestimated.

       • <b>hist</b>     Complete  histograms  are  considered  as  independent  data  points.   For  each bootstrap, N
         histograms are randomly chosen from the N given histograms (allowing duplication,  i.e.  sampling  with
         replacement).   To  avoid  gaps  without  data  along  the  reaction  coordinate  blocks  of histograms
         (<b>-histbs-block</b>) may be defined. In that case, the given histograms are divided  into  blocks  and  only
         histograms  within  each  block  are  mixed.  Note  that  the  histograms  within  each  block  must be
         representative for all possible histograms, otherwise the statistical error is underestimated.

       • <b>traj</b>  The given histograms are used to generate new random trajectories, such that the  generated  data
         points  are distributed according the given histograms and properly autocorrelated. The autocorrelation
         time (ACT) for each window must be known, so use <b>-ac</b> or provide the ACT with <b>-iiact</b>. If the ACT of  all
         windows  are  identical (and known), you can also provide them with <b>-bs-tau</b>.  Note that this method may
         severely underestimate the error in case of limited sampling, that is if individual histograms  do  not
         represent the complete phase space at the respective positions.

       • <b>traj-gauss</b>   The  same  as  method  <b>traj</b>,  but  the trajectories are not bootstrapped from the umbrella
         histograms but from Gaussians with the average and width of the umbrella histograms. That method yields
         similar error estimates like method <b>traj</b>.

       Bootstrapping output:

       • <b>-bsres</b>   Average profile and standard deviations

       • <b>-bsprof</b>  All bootstrapping profiles

       With <b>-vbs</b> (verbose bootstrapping), the histograms of each bootstrap  are  written,  and,  with  bootstrap
       method <b>traj</b>, the cumulative distribution functions of the histograms.

</pre><h4><b>OPTIONS</b></h4><pre>
       Options to specify input files:

       <b>-ix</b> <b>[&lt;.dat&gt;]</b> <b>(pullx-files.dat)</b> <b>(Optional)</b>
              Generic data file

       <b>-if</b> <b>[&lt;.dat&gt;]</b> <b>(pullf-files.dat)</b> <b>(Optional)</b>
              Generic data file

       <b>-it</b> <b>[&lt;.dat&gt;]</b> <b>(tpr-files.dat)</b> <b>(Optional)</b>
              Generic data file

       <b>-is</b> <b>[&lt;.dat&gt;]</b> <b>(coordsel.dat)</b> <b>(Optional)</b>
              Generic data file

       <b>-iiact</b> <b>[&lt;.dat&gt;]</b> <b>(iact-in.dat)</b> <b>(Optional)</b>
              Generic data file

       <b>-tab</b> <b>[&lt;.dat&gt;]</b> <b>(umb-pot.dat)</b> <b>(Optional)</b>
              Generic data file

       Options to specify output files:

       <b>-o</b> <b>[&lt;.xvg&gt;]</b> <b>(profile.xvg)</b>
              xvgr/xmgr file

       <b>-hist</b> <b>[&lt;.xvg&gt;]</b> <b>(histo.xvg)</b>
              xvgr/xmgr file

       <b>-oiact</b> <b>[&lt;.xvg&gt;]</b> <b>(iact.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-bsres</b> <b>[&lt;.xvg&gt;]</b> <b>(bsResult.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-bsprof</b> <b>[&lt;.xvg&gt;]</b> <b>(bsProfs.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       Other options:

       <b>-xvg</b> <b>&lt;enum&gt;</b> <b>(xmgrace)</b>
              xvg plot formatting: xmgrace, xmgr, none

       <b>-min</b> <b>&lt;real&gt;</b> <b>(0)</b>
              Minimum coordinate in profile

       <b>-max</b> <b>&lt;real&gt;</b> <b>(0)</b>
              Maximum coordinate in profile

       <b>-[no]auto</b> <b>(yes)</b>
              Determine min and max automatically

       <b>-bins</b> <b>&lt;int&gt;</b> <b>(200)</b>
              Number of bins in profile

       <b>-temp</b> <b>&lt;real&gt;</b> <b>(298)</b>
              Temperature

       <b>-tol</b> <b>&lt;real&gt;</b> <b>(1e-06)</b>
              Tolerance

       <b>-[no]v</b> <b>(no)</b>
              Verbose mode

       <b>-b</b> <b>&lt;real&gt;</b> <b>(50)</b>
              First time to analyse (ps)

       <b>-e</b> <b>&lt;real&gt;</b> <b>(1e+20)</b>
              Last time to analyse (ps)

       <b>-dt</b> <b>&lt;real&gt;</b> <b>(0)</b>
              Analyse only every dt ps

       <b>-[no]histonly</b> <b>(no)</b>
              Write histograms and exit

       <b>-[no]boundsonly</b> <b>(no)</b>
              Determine min and max and exit (with <b>-auto</b>)

       <b>-[no]log</b> <b>(yes)</b>
              Calculate the log of the profile before printing

       <b>-unit</b> <b>&lt;enum&gt;</b> <b>(kJ)</b>
              Energy unit in case of log output: kJ, kCal, kT

       <b>-zprof0</b> <b>&lt;real&gt;</b> <b>(0)</b>
              Define profile to 0.0 at this position (with <b>-log</b>)

       <b>-[no]cycl</b> <b>(no)</b>
              Create cyclic/periodic profile. Assumes min and max are the same point.

       <b>-[no]sym</b> <b>(no)</b>
              Symmetrize profile around z=0

       <b>-[no]ac</b> <b>(no)</b>
              Calculate integrated autocorrelation times and use in wham

       <b>-acsig</b> <b>&lt;real&gt;</b> <b>(0)</b>
              Smooth autocorrelation times along reaction coordinate with Gaussian of this sigma

       <b>-ac-trestart</b> <b>&lt;real&gt;</b> <b>(1)</b>
              When computing autocorrelation functions, restart computing every .. (ps)

       <b>-nBootstrap</b> <b>&lt;int&gt;</b> <b>(0)</b>
              nr of bootstraps to estimate statistical uncertainty (e.g., 200)

       <b>-bs-method</b> <b>&lt;enum&gt;</b> <b>(b-hist)</b>
              Bootstrap method: b-hist, hist, traj, traj-gauss

       <b>-bs-tau</b> <b>&lt;real&gt;</b> <b>(0)</b>
              Autocorrelation time (ACT) assumed for all histograms. Use option <b>-ac</b> if ACT is unknown.

       <b>-bs-seed</b> <b>&lt;int&gt;</b> <b>(-1)</b>
              Seed for bootstrapping. (-1 = use time)

       <b>-histbs-block</b> <b>&lt;int&gt;</b> <b>(8)</b>
              When mixing histograms only mix within blocks of <b>-histbs-block</b>.

       <b>-[no]vbs</b> <b>(no)</b>
              Verbose bootstrapping. Print the CDFs and a histogram file for each bootstrap.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/gmx.1.html">gmx</a>(1)</b>

       More information about GROMACS is available at &lt;<u><a href="http://www.gromacs.org/">http://www.gromacs.org/</a></u>&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2025, GROMACS development team

2025.0                                            Feb 10, 2025                                       <u><a href="../man1/GMX-WHAM.1.html">GMX-WHAM</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>