<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>msencrypt - create an encryption key or encrypt portions of connection strings for use in mapfiles</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/mapserver-bin">mapserver-bin_8.4.0-1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       msencrypt - create an encryption key or encrypt portions of connection strings for use in mapfiles

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>msencrypt</b> [<b>-keygen</b> <u>file</u> | <b>-key</b> <u>file</u> <u>string</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>msencrypt</b>  can  create  an  encryption key or encrypt portions of connection strings for use in mapfiles.
       Typically you might want to encrypt portions of the CONNECTION parameter for a database connection.   The
       following CONNECTIONTYPEs are supported for using this encryption method:

       • OGR

       • Oracle Spatial

       • PostGIS

       • SDE

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-keygen</b> <u>file</u>
              Creates a new encryption key in <u>file</u>.

       <b>-key</b> <u>file</u> <u>string</u>
              Use the key in <u>file</u> to encrypt <u>string</u>.

</pre><h4><b>NOTES</b></h4><pre>
       <b>Use</b> <b>in</b> <b>Mapfile</b>.

       The  location of the encryption key can be specified by two mechanisms, either by setting the environment
       variable MS_ENCRYPTION_KEY or using a CONFIG directive in the MAP object of your mapfile. For example:

               CONFIG MS_ENCRYPTION_KEY "/path/to/mykey.txt"

       Use the { and } characters as delimiters for encrypted strings inside database CONNECTIONs in  your  map‐
       file. For example:

               CONNECTIONTYPE ORACLESPATIAL
               CONNECTION "user/{MIIBugIBAAKBgQCP0Yj+Seh8==}@service"

</pre><h4><b>EXAMPLE</b></h4><pre>
               LAYER
                 NAME "provinces"
                 TYPE POLYGON
                 CONNECTIONTYPE POSTGIS
                 CONNECTION "host=127.0.0.1 dbname=gmap user=postgres password=iluvyou18 port=5432"
                 DATA "the_geom FROM province using SRID=42304"
                 STATUS DEFAULT
                 CLASS
                   NAME "Countries"
                   COLOR 255 0 0
                 END
               END

       Here are the steps to encrypt the password in the above connection:

       1.  Generate an encryption key (note that this key should not be stored anywhere within your web server's
           accessible directories):

               msencrypt -keygen "/home/user/mykey.txt"

       And this generated key file might contain something like:

               2137FEFDB5611448738D9FBB1DC59055

       2.  Encrypt the connection's password using that generated key:

               msencrypt -key "/home/user/mykey.txt" "iluvyou18"

       Which returns the password encrypted, at the commandline (you'll use it in a second):

               3656026A23DBAFC04C402EDFAB7CE714

       3.  Edit the mapfile to make sure the 'mykey.txt' can be found, using the "MS_ENCRYPTION_KEY" environment
           variable.  The  CONFIG parameter inside the MAP object can be used to set an environment variable in‐
           side a mapfile:

               MAP
                   ...
                   CONFIG "MS_ENCRYPTION_KEY" "/home/user/mykey.txt"
                   ...
               END #mapfile

       4.  Modify the layer's CONNECTION to use the generated password key, making sure to use the "{}" brackets
           around the key:

               CONNECTION "host=127.0.0.1 dbname=gmap user=postgres
                           password={3656026A23DBAFC04C402EDFAB7CE714} port=5432"

       5.  Done! Give your new encrypted mapfile a try with the <b><a href="../man1/map2img.1.html">map2img</a></b>(1) utility!

                                                 22 January 2025                                    <u><a href="../man1/msencrypt.1.html">msencrypt</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>