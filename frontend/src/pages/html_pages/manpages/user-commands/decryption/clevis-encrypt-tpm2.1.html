<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>clevis-encrypt-tpm2 - Encrypts using a TPM2.0 chip binding policy</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/clevis-tpm2">clevis-tpm2_20-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       clevis-encrypt-tpm2 - Encrypts using a TPM2.0 chip binding policy

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>clevis</b> <b>encrypt</b> <b>tpm2</b> CONFIG &lt; PT &gt; JWE

</pre><h4><b>OVERVIEW</b></h4><pre>
       The <b>clevis</b> <b>encrypt</b> <b>tpm2</b> command encrypts using a Trusted Platform Module 2.0 (TPM2) chip. Its only
       argument is the JSON configuration object.

       When using the tpm2 pin, we create a new, cryptographically-strong, random key. This key is encrypted
       using the TPM2 chip. Then at decryption time, the key is decrypted again using the TPM2 chip.

           $ clevis encrypt tpm2 '{}' &lt; PT &gt; JWE

       The pin has reasonable defaults for its configuration, but a different hierarchy, hash, and key
       algorithms can be chosen if the defaults used are not suitable:

           $ clevis encrypt tpm2 '{"hash":"sha1","key":"rsa"}' &lt; PT &gt; JWE

       To decrypt the data, simply provide the ciphertext (JWE):

           $ clevis decrypt &lt; JWE &gt; PT

       Note that like other pins no configuration is used for decryption, this is due clevis storing the public
       and private keys to unseal the TPM2 encrypted object in the JWE so clevis can fetch that information from
       there.

       The pin also supports sealing data to a Platform Configuration Registers (PCR) state. That way the data
       can only be unsealed if the PCRs hashes values match the policy used when sealing.

       For example, to seal the data to the PCR with index 0 and 1 for the SHA1 bank:

           $ clevis encrypt tpm2 '{"pcr_bank":"sha1","pcr_ids":"0,1"}' &lt; PT &gt; JWE

       The PCR digest values are looked up from the current hash values for the PCRs, but a digest can also be
       provided if the data needs to be sealed with values different to the current ones, by passing the binary
       hash encoded in base64:

           $ clevis encrypt tpm2 '{"pcr_ids":"0","pcr_digest":"xy7J5svCtqlfM03d1lE5gdoA8MI"}' &lt; PT &gt; JWE

</pre><h4><b>THREAT</b> <b>MODEL</b></h4><pre>
       The Clevis security model relies in the fact that an attacker will not be able to access both the
       encrypted data and the decryption key.

       For most Clevis pins, the decryption key is not locally stored, so the decryption policy is only
       satisfied if the decryption key can be remotely accessed. It could for example be stored in a remote
       server or in a hardware authentication device that has to be plugged into the machine.

       The tpm2 pin is different in this regard, since a key is wrapped by a TPM2 chip that is always present in
       the machine. This does not mean that there are not use cases for this pin, but it is important to
       understand the fact that an attacker that has access to both the encrypted data and the local TPM2 chip
       will be able to decrypt the data.

</pre><h4><b>CONFIG</b></h4><pre>
       This command uses the following configuration properties:

       •   <b>hash</b>  (string) : Hash algorithm used in the computation of the object name (default: sha256)

               It must be one of the following:

           •   <b>sha1</b>

           •   <b>sha256</b>

           •   <b>sha384</b>

           •   <b>sha512</b>

           •   <b>sm3_256</b>

       •   <b>key</b>  (string) : Algorithm type for the generated key (default: ecc)

               It must be one of the following:

           •   <b>rsa</b>

           •   <b>keyedhash</b>

           •   <b>ecc</b>

           •   <b>symcipher</b>

       •   <b>pcr_bank</b>  (string) : PCR algorithm bank to use for policy (default: sha1)

               It must be one of the following:

           •   <b>sha1</b>

           •   <b>sha256</b>

       •   <b>pcr_ids</b>  (string) : Comma separated list of PCR used for policy. If not present, no policy is used

       •   <b>pcr_digest</b>  (string) : Binary PCR hashes encoded in base64. If not present, the hash values are
           looked up

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/clevis-decrypt.1.html">clevis-decrypt</a></b>(1) &lt;clevis-decrypt.1.adoc&gt;

                                                                                          <u><a href="../man1/CLEVIS-ENCRYPT-TPM2.1.html">CLEVIS-ENCRYPT-TPM2</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>