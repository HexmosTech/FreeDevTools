<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>k5start - Obtain and optionally keep active a Kerberos ticket</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/kstart">kstart_4.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       k5start - Obtain and optionally keep active a Kerberos ticket

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>k5start</b> [<b>-abFhLnPqstvx</b>] [<b>-c</b> <u>child</u> <u>pid</u> <u>file</u>] [<b>-f</b> <u>keytab</u>]
           [<b>-g</b> <u>group</u>] [<b>-H</b> <u>minutes</u>] [<b>-I</b> <u>service</u> <u>instance</u>]
           [<b>-i</b> <u>client</u> <u>instance</u>] [<b>-K</b> <u>minutes</u>] [<b>-k</b> <u>ticket</u> <u>cache</u>]
           [<b>-l</b> <u>time</u> <u>string</u>] [<b>-m</b> <u>mode</u>] [<b>-o</b> <u>owner</u>]
           [<b>-p</b> <u>pid</u> <u>file</u>] [<b>-r</b> <u>service</u> <u>realm</u>] [<b>-S</b> <u>service</u> <u>name</u>]
           [<b>-u</b> <u>client</u> <u>principal</u>] [<u>principal</u> [<u>command</u> ...]]

       <b>k5start</b> <b>-U</b> <b>-f</b> <u>keytab</u> [<b>-abFhLnPqstvx</b>] [<b>-c</b> <u>child</u> <u>pid</u> <u>file</u>]
           [<b>-g</b> <u>group</u>] [<b>-H</b> <u>minutes</u>] [<b>-I</b> <u>service</u> <u>instance</u>]
           [<b>-K</b> <u>minutes</u>] [<b>-k</b> <u>ticket</u> <u>cache</u>] [<b>-l</b> <u>time</u> <u>string</u>]
           [<b>-m</b> <u>mode</u>] [<b>-o</b> <u>owner</u>] [<b>-p</b> <u>pid</u> <u>file</u>]
           [<b>-r</b> <u>service</u> <u>realm</u>] [<b>-S</b> <u>service</u> <u>name</u>] [<u>command</u> ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>k5start</b> obtains and caches an initial Kerberos ticket-granting ticket for a principal.  <b>k5start</b> can be
       used as an alternative to <b>kinit</b>, but it is primarily intended to be used by programs that want to use a
       keytab to obtain Kerberos credentials, such as a web server that needs to authenticate to another service
       such as an LDAP server.

       Normally, the principal for which to give tickets should be specified as the first argument.  <u>principal</u>
       may be either just a principal name (including the optional instance) or a full principal and realm
       string.  The <b>-u</b> and <b>-i</b> options can be used as an alternative mechanism for specifying the principal, but
       generally aren't as convenient.  If no principal is given as either the first argument or the argument to
       the <b>-u</b> option, the client principal defaults to the Unix username of the user running <b>k5start</b> in the
       default local realm.

       Optionally, a command may be given on the command line of <b>k5start</b>.  If so, that command is run after
       Kerberos authentication (and running <b>aklog</b> if desired), with the appropriate environment variables set to
       point it to the right ticket cache.  <b>k5start</b> will then continue running, waking up periodically to
       refresh credentials slightly before they would expire, until the command completes.  (The frequency with
       which it wakes up to refresh credentials can still be controlled with the <b>-K</b> option.)  To run in this
       mode, the principal must either be specified as a regular command-line argument or via the <b>-U</b> option; the
       <b>-u</b> and <b>-i</b> options may not be used.  Also, a keytab must be specified with <b>-f</b> to run a specific command.

       The command will not be run using the shell, so if you want to use shell metacharacters in the command
       with their special meaning, give "sh -c <u>command</u>" as the command to run and quote <u>command</u>.

       If the command contains command-line options (like "-c"), put -- on the command line before the beginning
       of the command to tell <b>k5start</b> to not parse those options as its own.

       When running a command, <b>k5start</b> propagates HUP, TERM, INT, and QUIT signals to the child process and does
       not exit when those signals are received.  (If the propagated signal causes the child process to exit,
       <b>k5start</b> will then exit.)  This allows <b>k5start</b> to react properly when run under a command supervision
       system such as <b><a href="../man8/runit.8.html">runit</a></b>(8) or <b><a href="../man8/svscan.8.html">svscan</a></b>(8) that uses signals to control supervised commands, and to run
       interactive commands that should receive Ctrl-C.

       If a running <b>k5start</b> receives an ALRM signal, it immediately refreshes the ticket cache regardless of
       whether it is in danger of expiring.

       If <b>k5start</b> is run with a command or the <b>-K</b> flag and the <b>-x</b> flag is not given, it will keep trying even if
       the initial authentication fails.  It will retry the initial authentication immediately and then with
       exponential backoff to once per minute, and keep trying until authentication succeeds or it is killed.
       The command, if any, will not be started until authentication succeeds.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b>  When  run  with  either  the  <b>-K</b>  flag or a command, always renew tickets each time <b>k5start</b> wakes up.
           Without this option, <b>k5start</b> will only try to renew a ticket as often as  necessary  to  prevent  the
           ticket  from  expiring.   With  this  option,  <b>k5start</b>  will  renew tickets according to the interval
           specified with the <b>-K</b> flag.

           This behavior probably should have been the default behavior of <b>-K</b>.  The default was not  changed  to
           avoid changes for existing users, but for new applications, consider always using <b>-a</b> with <b>-K</b>.

           This  option  is important if another program is manipulating the ticket cache that <b>k5start</b> is using.
           For example, if another program is automatically renewing a ticket more frequently than <b>k5start</b>, then
           <b>k5start</b> will never see a ticket that is close to expiring and will therefore, by default,  never  try
           to renew the ticket.  This means that <b>k5start</b> will also never renew AFS tokens, even if the <b>-t</b> option
           was  given,  since  <b>k5start</b>  only  renews  AFS tokens after it successfully renews a ticket.  If this
           option is specified in such a situation, <b>k5start</b> will renew its  ticket  every  time  it  checks  the
           ticket, so AFS tokens will be renewed.

           This argument is only valid in combination with either <b>-K</b> or a command to run.

       <b>-b</b>  After  starting,  detach  from  the controlling terminal and run in the background.  This option only
           makes sense in combination with <b>-K</b> or a command that <b>k5start</b> will be running and can only be used  if
           a  keytab  is  specified  with  <u>-f</u>.   <b>k5start</b>  will  not  background  itself until after it has tried
           authenticating once, so that any initial errors will be reported, but it will then redirect output to
           <u>/dev/null</u> and no subsequent errors will be reported.

           If this flag is given, <b>k5start</b> will also change directories to "/".  All paths (such as to a  command
           to run or a PID file) should therefore be given as absolute, not relative, paths.

           If  used  in conjunction with a command to run, that command will also run in the background and will
           also have its input and output redirected to <u>/dev/null</u>.  It will have to report any errors  via  some
           other mechanism for the errors to be seen.

           Note  that  on  Mac  OS  X,  the  default ticket cache type is per-session and using the <b>-b</b> flag will
           disassociate <b>k5start</b> from the existing ticket cache.  When using <b>-b</b> in conjunction with <b>-K</b> on Mac  OS
           X,  you  probably  also want to use the <b>-k</b> flag to specify a ticket cache file and force the use of a
           file cache.

           When using this option, consider also using <b>-L</b> to report <b>k5start</b> errors to syslog.

       <b>-c</b> <u>child</u> <u>pid</u> <u>file</u>
           Save the process ID (PID) of the child process into <u>child</u> <u>pid</u> <u>file</u>.  <u>child</u> <u>pid</u> <u>file</u> is created if  it
           doesn't exist and overwritten if it does exist.  This option is only allowed when a command was given
           on  the  command  line  and  is most useful in conjunction with <b>-b</b> to allow management of the running
           child process.

           Note that, when used with <b>-b</b>, the PID file is written out after <b>k5start</b> is backgrounded  and  changes
           its  working  directory  to <u>/</u>, so relative paths for the PID file will be relative to <u>/</u> (probably not
           what you want).

       <b>-F</b>  Do not get forwardable tickets even if the local configuration says to  get  forwardable  tickets  by
           default.  Without this flag, <b>k5start</b> does whatever the library default is.

       <b>-f</b> <u>keytab</u>
           Authenticate  using  the  keytab  <u>keytab</u>  rather  than  asking  for a password.  A key for the client
           principal must be present in <u>keytab</u>.

       <b>-g</b> <u>group</u>
           After creating the ticket cache, change its group ownership to <u>group</u>, which may be either the name of
           a group or a numeric group ID.  Ticket caches are created with 0600 permissions by default,  so  this
           will have no useful effect unless used with <b>-m</b>.

       <b>-H</b> <u>minutes</u>
           Check  for  a happy ticket, defined as one that has a remaining lifetime of at least <u>minutes</u> minutes.
           If such a ticket is found, do not attempt authentication.  Instead, just run the command (if one  was
           specified)  or  exit  immediately with status 0 (if none was).  Otherwise, try to obtain a new ticket
           and then run the command, if any.

           If <b>-H</b> is used with <b>-t</b>, the external program will always be run even if a  ticket  with  a  sufficient
           remaining lifetime was found.

           If  <b>-H</b> is used with <b>-K</b>, <b>k5start</b> will not exit immediately.  Instead, the specified remaining lifetime
           will replace the default value of two minutes, meaning that <b>k5start</b> will ensure, each time  it  wakes
           up,  that  the ticket has a remaining lifetime of the <u>minutes</u> argument.  This is an alternative to <b>-a</b>
           to ensure that tickets always have a certain minimal amount of lifetime remaining.

       <b>-h</b>  Display a usage message and exit.

       <b>-I</b> <u>service</u> <u>instance</u>
           The instance portion of the service principal.  The default is the  default  realm  of  the  machine.
           Note  that unlike the client principal, a non-default service principal must be specified with <b>-I</b> and
           <b>-S</b>; one cannot provide the instance portion as part of the argument to <b>-S</b>.

       <b>-i</b> <u>client</u> <u>instance</u>
           Specifies the instance  portion  of  the  principal.   This  option  doesn't  make  sense  except  in
           combination  with <b>-u</b>.  Note that the instance can be specified as part of <u>username</u> through the normal
           convention of appending a slash and then the instance, so one never has to use this option.

       <b>-K</b> <u>minutes</u>
           Run in daemon mode to keep a ticket alive indefinitely.  The program reawakens after <u>minutes</u> minutes,
           checks if the ticket will expire before or less than two minutes after the next scheduled check,  and
           gets  a  new  ticket  if  needed.   (In  other  words,  it ensures that the ticket will always have a
           remaining lifetime of at least two minutes.)  If the <b>-H</b> flag is also given, the lifetime specified by
           it replaces the two minute default.

           If this option is not given but a command was given on the command line, the default interval  is  60
           minutes (1 hour).

           If  an  error  occurs  in  refreshing the ticket cache, the wake-up interval will be shortened to one
           minute and the operation retried at that interval for as long as the error persists.

       <b>-k</b> <u>ticket</u> <u>cache</u>
           Use <u>ticket</u> <u>cache</u> as the ticket cache rather than the contents of the environment variable  KRB5CCNAME
           or the library default.  <u>ticket</u> <u>cache</u> may be any ticket cache identifier recognized by the underlying
           Kerberos  libraries.   This  generally  supports  a path to a file, with or without a leading "FILE:"
           string, but may also support other ticket cache types.

           If any of <b>-o</b>, <b>-g</b>, or <b>-m</b> are given, <u>ticket</u> <u>cache</u> must be either a simple path to a file or start  with
           "FILE:" or "WRFILE:".

       <b>-L</b>  Report  messages  to  syslog  as  well as to standard output or standard error.  All messages will be
           logged with facility LOG_DAEMON.  Regular messages that are displayed on standard output  are  logged
           with  level  LOG_NOTICE.   Errors  that  don't  cause  <b>k5start</b>  to  terminate  are  logged with level
           LOG_WARNING.  Fatal errors are logged with level LOG_ERR.

           This is useful when debugging problems in combination with <b>-b</b>.

       <b>-l</b> <u>time</u> <u>string</u>
           Set the ticket lifetime.  <u>time</u> <u>string</u> should be in a format recognized by the Kerberos libraries  for
           specifying  times,  such as "10h" (ten hours) or "10m" (ten minutes).  Known units are "s", "m", "h",
           and "d".  For more information, see <b><a href="../man1/kinit.1.html">kinit</a></b>(1).

       <b>-m</b> <u>mode</u>
           After creating the ticket cache, change its file permissions to <u>mode</u>, which must be a  file  mode  in
           octal (640 or 444, for example).

           Setting a <u>mode</u> that does not allow <b>k5start</b> to read or write to the ticket cache will cause <b>k5start</b> to
           fail and exit when using the <b>-K</b> option or running a command.

       <b>-n</b>  Ignored, present for option compatibility with the now-obsolete <b>k4start</b>.

       <b>-o</b> <u>owner</u>
           After  creating  the  ticket  cache, change its ownership to <u>owner</u>, which may be either the name of a
           user or a numeric user ID.  If <u>owner</u> is the name of a user and <b>-g</b> was not also given, also change the
           group ownership of the ticket cache to the default group for that user.

       <b>-P</b>  Do not get proxiable tickets even if the  local  configuration  says  to  get  proxiable  tickets  by
           default.  Without this flag, <b>k5start</b> does whatever the library default is.

       <b>-p</b> <u>pid</u> <u>file</u>
           Save  the  process  ID (PID) of the running <b>k5start</b> process into <u>pid</u> <u>file</u>.  <u>pid</u> <u>file</u> is created if it
           doesn't exist and overwritten if it does exist.  This option is most useful in conjunction with <b>-b</b> to
           allow management of the running <b>k5start</b> daemon.

           Note that, when used with <b>-b</b> the PID file is written out after <b>k5start</b> is  backgrounded  and  changes
           its  working  directory  to <u>/</u>, so relative paths for the PID file will be relative to <u>/</u> (probably not
           what you want).

       <b>-q</b>  Quiet.  Suppresses the printing of the initial banner message saying what Kerberos principal  tickets
           are being obtained for, and also suppresses the password prompt when the <b>-s</b> option is given.

       <b>-r</b> <u>service</u> <u>realm</u>
           The realm for the service principal.  This defaults to the default local realm.

       <b>-S</b> <u>service</u> <u>name</u>
           Specifies  the  principal  for  which  <b>k5start</b>  is  getting  a  service ticket.  The default value is
           "krbtgt", to obtain a ticket-granting ticket.  This option (along with <b>-I</b>) may be used  if  one  only
           needs  access  to  a  single  service.   Note that unlike the client principal, a non-default service
           principal must be specified with both <b>-S</b> and <b>-I</b>; one cannot provide the instance portion as  part  of
           the argument to <b>-S</b>.

       <b>-s</b>  Read  the  password  from standard input.  This bypasses the normal password prompt, which means echo
           isn't suppressed and input isn't forced to be from the  controlling  terminal.   Most  uses  of  this
           option are a security risk.  You normally want to use a keytab and the <b>-f</b> option instead.

       <b>-t</b>  Run  an  external  program after getting a ticket.  The intended use of this is to run <b>aklog</b> to get a
           token.  If the environment variable AKLOG (or KINIT_PROG  for  backward  compatibility)  is  set,  it
           overrides the compiled-in default.

           If  a  command was given on the command line, <b>k5start</b> will attempt to isolate the AFS credentials for
           that command from the invoking process.  There are two possible ways in which this is done.

           First, if <b>k5start</b> has been built with AFS <b>setpag()</b> support and AFS is available, <b>k5start</b> will  create
           a new PAG before running the external program.

           Otherwise, if either <b>k5start</b> was not built with AFS <b>setpag()</b> support or AFS is not available, but the
           Linux  kafs  module is available and <b>k5start</b> was built with libkeyutils support, it will create a new
           session keyring and link it to the current user keyring before running the external program.

           If neither of these conditions are true, <b>k5start</b> will run the  external  program  without  doing  any
           credential isolation, which may also affect the credentials of the invoking process.

       <b>-U</b>  Rather  than  requiring  the  authentication principal be given on the command line, read it from the
           keytab specified with <b>-f</b>.  The principal will be taken from the first entry in the keytab.   <b>-f</b>  must
           be specified if this option is used.

           When  <b>-U</b>  is given, <b>k5start</b> will not expect a principal name to be given on the command line, and any
           arguments after the options will be taken as a command to run.

       <b>-u</b> <u>client</u> <u>principal</u>
           This specifies the principal to obtain credentials as.  The entire principal may be  specified  here,
           or  alternatively  just  the first portion may be specified with this flag and the instance specified
           with <b>-i</b>.

           Note that there's normally no reason to use this flag rather than simply giving the principal on  the
           command line as the first regular argument.

       <b>-v</b>  Be  verbose.   This  will print out a bit of additional information about what is being attempted and
           what the results are.

       <b>-x</b>  Exit immediately on any error.  Normally, when running a command or when  run  with  the  <b>-K</b>  option,
           <b>k5start</b>  keeps  running  even  if it fails to refresh the ticket cache and will try again at the next
           check interval.  With this option, <b>k5start</b> will instead exit.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       The program exits with status 0 if it successfully gets a ticket or has a  happy  ticket  (see  <b>-H</b>).   If
       <b>k5start</b>  runs  aklog  or  some  other program <b>k5start</b> returns the exit status of that program if it exits
       normally.  If the program exits abnormally due to a signal, <b>k5start</b> will exit with a status of  128  plus
       the signal number.  (This matches the behavior of <b>bash</b>.)

</pre><h4><b>EXAMPLE</b></h4><pre>
       Use  the  <u>/etc/krb5.keytab</u>  keytab to obtain a ticket granting ticket for the principal host/example.com,
       putting the ticket cache in <u>/tmp/service.tkt</u>.  The lifetime is 10 hours and the program wakes up every 10
       minutes to check if the ticket is about to expire.

           k5start -k /tmp/service.tkt -f /etc/krb5.keytab -K 10 -l 10h \
               host/example.com

       Do the same, but using the default ticket cache and run the command <u>/usr/local/bin/auth-backup</u>.   <b>k5start</b>
       will  continue running until the command finishes.  If the initial authentication fails, keep trying, and
       don't start the command until it succeeds.  This could be used during system startup for a  command  that
       must  have  valid  tickets  before  starting,  and  tolerates  having <b>k5start</b> start before the network is
       completely set up.

           k5start -f /etc/krb5.keytab -K 10 -l 10h host/example.com \
               /usr/local/bin/auth-backup

       Shows the permissions of the temporary cache file created by <b>k5start</b>:

           k5start -f /etc/krb5.keytab host/example.com \
               -- sh -c 'ls -l $KRB5CCNAME'

       Notice the "--" before the command to keep <b>k5start</b> from parsing the "-c" as its own option.

       Do the same thing, but determine the principal from the keytab:

           k5start -f /etc/krb5.keytab -U -- sh -c 'ls -l $KRB5CCNAME'

       Note that no principal is given before the command.

       Starts <b>k5start</b> as a daemon using the Debian <b>start-stop-daemon</b> management program.  This is  the  sort  of
       line that one could put into a Debian init script:

           start-stop-daemon --start --pidfile /var/run/k5start.pid \
               --exec /usr/local/bin/k5start -- -b -p /var/run/k5start.pid \
               -f /etc/krb5.keytab host/example.com

       This  uses  <u>/var/run/k5start.pid</u>  as  the  PID  file and obtains host/example.com tickets from the system
       keytab file.  <b>k5start</b> would then be stopped with:

           start-stop-daemon --stop --pidfile /var/run/k5start.pid
           rm -f /var/run/k5start.pid

       This code could be added to an init script for Apache, for example, to start a <b>k5start</b> process  alongside
       Apache to manage its Kerberos credentials.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       If  the  environment  variable  AKLOG is set, its value will be used as the program to run with <b>-t</b> rather
       than the default complied into <b>k5start</b>.  If AKLOG is not set and KINIT_PROG is set,  its  value  will  be
       used instead.  KINIT_PROG is honored for backward compatibility but its use is not recommended due to its
       confusing name.

       If no ticket file (with <b>-k</b>) or command is specified on the command line, <b>k5start</b> will use the environment
       variable  KRB5CCNAME to determine the location of the the ticket granting ticket.  If either a command is
       specified or the <b>-k</b> option is used, KRB5CCNAME will be set to point to the ticket file before running the
       <b>aklog</b> program or any command given on the command line.

</pre><h4><b>FILES</b></h4><pre>
       The default ticket cache is determined by the underlying Kerberos libraries.  The default path for  aklog
       is  determined  at  build  time, and will normally be whichever of <b>aklog</b> or <b>afslog</b> is found in the user's
       path.

       If a command is specified and <b>-k</b> was not given, <b>k5start</b> will create a temporary ticket cache file of  the
       form "/tmp/krb5cc_%d_%s" where %d is the UID <b>k5start</b> is running as and %s is a random string.

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>k5start</b>  was  based on the k4start code written by Robert Morgan.  It was ported to Kerberos v5 by Booker
       C. Bense.  Additional cleanup and current maintenance are done by Russ Allbery &lt;<a href="mailto:eagle@eyrie.org">eagle@eyrie.org</a>&gt;.

       Implementations of <b>-b</b> and <b>-p</b> and the example for a Debian init script are based on  code  contributed  by
       Navid Golpayegani.

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       Copyright 2015, 2021 Russ Allbery &lt;<a href="mailto:eagle@eyrie.org">eagle@eyrie.org</a>&gt;

       Copyright 2002, 2004-2012, 2014 The Board of Trustees of the Leland Stanford Junior University

       Copying  and distribution of this file, with or without modification, are permitted in any medium without
       royalty provided the copyright notice and this notice are preserved.  This file is offered as-is, without
       any warranty.

       SPDX-License-Identifier: FSFAP

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/kinit.1.html">kinit</a></b>(1), <b><a href="../man1/krenew.1.html">krenew</a></b>(1)

       This  program  is  part  of  kstart.   The  current  version  is  available  from   its   web   site   at
       &lt;https://www.eyrie.org/~eagle/software/kstart/&gt;.

4.3                                                2021-08-31                                         <u><a href="../man1/K5START.1.html">K5START</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>