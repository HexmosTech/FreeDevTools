<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>s9 ‐ Scheme Interpreter</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/scheme9">scheme9_2018.12.05-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
          <b>s9</b> ‐ Scheme Interpreter

</pre><h4><b>USAGE</b></h4><pre>
          <b>s9</b> <b>[‐i</b> <b>file</b> <b>|</b> <b>‐]</b> <b>[‐hv?]</b> <b>[‐gqu]</b> <b>[‐e</b> <b>expr]</b> <b>[‐d</b> <b>file]</b>
             <b>[‐k</b> <b>cells]</b> <b>[‐l</b> <b>file]</b> <b>[‐n</b> <b>nodes]</b> <b>[‐r</b> <b>expr]</b>
             <b>[‐‐</b> <b>argument</b> <b>...</b> <b>|</b> <b>[‐f]</b> <b>file</b> <b>argument</b> <b>...]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
          <b>Scheme</b>  <b>9</b> <b>from</b> <b>Empty</b> <b>Space</b> is an interpreter for R4RS Scheme
          with some additional procedures for accessing  typical  Unix
          system  calls  and  Unix  and  Curses  library functions (if
          compiled‐in). The <b>s9</b> command starts the interpreter.

</pre><h4><b>OPTIONS</b></h4><pre>
          <b>‐h,</b> <b>‐v,</b> <b>or</b> <b>‐?</b>
              Display a brief summary of options.

          <b>‐i</b> <b>file</b> <b>|</b> <b>‐</b>
              Load alternative image file ‘<u>file</u>’. Image files will  be
              searched  in  the directory specified in <u>S9FES_IMAGE_DIR</u>
              (see below) except when the file name begins with a  ‘.’
              or  ‘/’  character. When this option is used, it <b>must</b> be
              the first one of the s9 command.
              When ‘‐’ is specified as <u>file</u>, no  heap  image  will  be
              loaded,  and  the  core  library  will  be read from the
              source file ‘s9.scm’ in the current directory.

          <b>‐d</b> <b>file</b>
              Dump heap image to <u>file</u> and exit.

          <b>‐e</b> <b>expr</b>
              Read expression from <u>expr</u>, evaluate it,  and  print  its
              value.  Multiple  <b>‐e</b>  options  may  be given, which will
              evaluate from left to right.  Interactive mode will  not
              be entered.

          <b>‐g[g]</b>
              Print  GC  summaries.  A  single  ‘g’  will  report pool
              growth, a second ‘g’ will also include data  about  pool
              usage after each collection.

          <b>‐k</b> <b>N[m]</b>
              Set  vector  limit to <u>N</u> kilo (or mega) cells (<b>‐k</b> <b>0</b> means
              no  limit;  use  with  care!).  An  <u>m</u>  suffix  indicates
              2ˆ20*cells, the default is 2ˆ10*cells.

          <b>‐l</b> <b>program</b>
              Load  <u>program</u>  before entering the REPL or processing <b>‐e</b>
              and <b>‐r</b> options  or  running  a  final  program.  May  be
              repeated.

          <b>‐n</b> <b>N[m]</b>
              Set  node limit to <u>N</u> kilo (or mega) nodes (<b>‐n</b> <b>0</b> means no
              limit;  use  with  care!).   An   <u>m</u>   suffix   indicates
              2ˆ20*nodes, the default is 2ˆ10*nodes.
          <b>‐q</b>
              Be quiet: skip banners and prompts, exit on errors.

          <b>‐r</b> <b>expr</b>
              Like   <b>‐e</b>,   but  no  value  will  print.  Used  to  run
              expressions for effect.

          <b>‐u</b>
              Short for <b>‐k</b> <b>0</b> <b>‐n</b> <b>0</b> (use unlimited memory).

          <b>‐‐</b> <b>[argument</b> <b>...]</b>
              Arguments following <b>‐‐</b> are not interpreted by S9fES, but
              passed to the interpreted  program,  which  can  extract
              them  using the <b>command‐line</b> procedure. This option must
              be the last one.

          <b>[‐f]</b> <b>program</b> <b>[argument</b> <b>...]</b>
              Run <u>program</u> and exit (implies ‐q). When  there  are  any
              <u>argument</u>s,  they  are  passed to the <u>program</u>, where they
              can be extracted using the <b>command‐line</b> procedure.  This
              option must be the last one. The <b>‐f</b> flag is deprecated.

</pre><h4><b>ONLINE</b> <b>HELP</b></h4><pre>
          When  the  interpreter is running and the default heap image
          is loaded, just type <b>(help)</b> or <b>,h</b> to invoke the online  help
          system.  When the online help system is not loaded, you will
          have to run the following command first:

          <b>(load‐from‐library</b> <b>"help.scm")</b>

</pre><h4><b>META</b> <b>COMMANDS</b></h4><pre>
          In  order  to  facilitate  the invocation of frequently‐used
          top‐level  procedures,  <b>s9</b>  provides  the  following   ‘meta
          commands’  (they  work  only when entered directly at the <b>s9</b>
          prompt):

              <b>,a</b> <b>text</b>  =  (apropos "text")
              <b>,h</b> <b>text</b>  =  (help "text")
              <b>,l</b> <b>file</b>  =  (load‐from‐library "file")
              <b>,q</b>       =  (quit)

          The arguments of <b>,a</b> and <b>,h</b> are optional.

</pre><h4><b>ADDITIONS</b></h4><pre>
          S9fES supports nestable block comments of the form

              <b>#|</b> <u>comment</u> <b>|#</b>

          Square brackets may be used in the places of parentheses:

              <b>(cond</b> <b>[(foo)</b> <b>(bar)])</b>

          The same type of bracket must be used  on  both  ends  of  a
          list.

          These S9fES procedures are not in R4RS:
          <b>(bit‐op</b> <b>integer1</b> <b>integer2</b> <b>integer3</b> <b>...)</b>  <b>==&gt;</b>  <b>integer</b>
              Implement  a variety of bitwise operations. See the <b>bit‐</b>
              <b>op</b> help page for details.

          <b>(command‐line)</b>  <b>==&gt;</b>  <b>list</b>
              Return a list of command line arguments passed to the  a
              program  being  interpreted  or following the <b>‐‐</b> command
              line option.

          <b>(delete‐file</b> <b>string)</b>  <b>==&gt;</b>  <b>unspecific</b>
              Delete the file specified in the <u>string</u> argument. If the
              file does not exist or  cannot  be  deleted,  report  an
              error.

          <b>(environment‐variable</b> <b>string)</b>  <b>==&gt;</b>  <b>string</b> <b>|</b> <b>#f</b>
              Retrieve  the  value  of the given environment variable.
              Return <b>#f</b>, if the variable is undefined.

          <b>(error</b> <b>string)</b>         <b>==&gt;</b>  <b>undefined</b>
          <b>(error</b> <b>string</b> <b>object)</b>  <b>==&gt;</b>  <b>undefined</b>
              Print an error message of the form <u>error:</u> <u>string:</u> <u>object</u>
              and terminate program execution. When no <u>object</u> argument
              is given, this part will be omitted in the message.

          <b>(eval</b> <b>object)</b>  <b>==&gt;</b>  <b>object</b>
              Evaluate <u>object</u> in the current  environment  and  return
              its normal form.

          <b>(exponent</b> <b>number)</b>  <b>==&gt;</b>  <b>integer</b>
              Extract  the exponent part from a number. This will be 0
              for integers.

          <b>(file‐exists?</b> <b>string)</b>  <b>==&gt;</b>  <b>boolean</b>
              Return <b>#t</b> if the file specified in the  <u>string</u>  argument
              exists and otherwise <b>#f</b>.

          <b>(fold‐left</b> <b>proc</b> <b>base</b> <b>list</b> <b>...)</b>  <b>==&gt;</b>  <b>object</b>
              Combine  the  elements of the <u>list</u>s using <u>proc</u>.  Combine
              elements  left‐associatively.   <u>Base</u>  is  the   leftmost
              element.

          <b>(fold‐right</b> <b>proc</b> <b>base</b> <b>list</b> <b>...)</b>  <b>==&gt;</b>  <b>object</b>
              Combine  the  elements of the <u>list</u>s using <u>proc</u>.  Combine
              elements right‐associatively.   <u>Base</u>  is  the  rightmost
              element.

          <b>(gensym)</b>  <b>==&gt;</b>  <b>symbol</b>
              Return a fresh symbol.

          <b>(load‐from‐library</b> <b>string)</b>  <b>==&gt;</b>  <b>unspecific</b>
              Attempt  to  <b>load</b>  the  file  <u>string</u> from each directory
              listed in the top‐level variable <b>*library‐path*</b>.

          <b>(locate‐file</b> <b>string)</b>  <b>==&gt;</b>  <b>string</b> <b>|</b> <b>#f</b>
              Search for the file <u>string</u> in each  directory listed  in
              <b>*library‐path*</b>  in  sequence.   When  the  file  can  be
              located, return its full path, else return <b>#f</b>.
          <b>(macro‐expand</b> <b>object)</b>    <b>==&gt;</b>  <b>object</b>
          <b>(macro‐expand‐1</b> <b>object)</b>  <b>==&gt;</b>  <b>object</b>
              If <u>object</u>  contains  a  macro  application,  return  its
              expanded form, else return the object unchanged.  <b>Macro‐</b>
              <b>expand‐1</b>  expands  macros  only  once while <b>macro‐expand</b>
              expands them recursively.

          <b>(mantissa</b> <b>number)</b>  <b>==&gt;</b>  <b>integer</b>
              Extract the mantissa part from a number.  This  will  be
              the number itself for integers.

          <b>(print</b> <b>object</b> <b>...)</b>  <b>==&gt;</b>  <b>unspecific</b>
              Write  multiple  <u>object</u>s  separated by spaces and with a
              trailing newline.

          <b>(require‐extension</b> <b>ext</b> <b>...)</b>  <b>==&gt;</b>  <b>unspecific</b>
              Require the named extensions to be  compiled‐in.  Signal
              an  error  if  not  all  of  the required extensions are
              present.  <u>Ext</u> may be of the form <u>(or</u> <u>ext1</u> <u>ext2</u> <u>...)</u>.  In
              this  case, it is sufficient if at least one of the <u>ext</u>s
              gven in <u>or</u> is present.

          <b>(reverse!</b> <b>list)</b>  <b>==&gt;</b>  <b>list</b>
              Reverse <u>list</u> destructively and return the reverse list.

          <b>(set‐input‐port!</b> <b>input‐port)</b>  <b>==&gt;</b>  <b>unspecific</b>
              Destructively set the current input port.

          <b>(set‐output‐port!</b> <b>output‐port)</b>  <b>==&gt;</b>  <b>unspecific</b>
              Destructively set the current output port.

          <b>(stats</b> <b>expr)</b>  <b>==&gt;</b>  <b>object</b>
              Evaluate  the  given  expression  and  return   a   list
              containing  its  normal  form  plus  a  summary  of  the
              resources used to compute that normal form:

                  ‐ total nodes allocated
                  ‐ conses allocated
                  ‐ vector cells allocated
                  ‐ garbage collections

              Each resource count will  be  returned  as  a  group  of
              integers  representing  ones,  thousands, millions, etc.
              Note that <u>expr</u> must be quoted or it  will  be  evaluated
              before passing it to <b>stats</b>.

          <b>(symbols)</b>  <b>==&gt;</b>  <b>list</b>
              Return a list of all defined symbols.

          <b>(system‐command</b> <b>string)</b>  <b>==&gt;</b>  <b>number</b>
              Run the given shell command and return its exit code.

          <b>(vector‐append</b> <b>vector</b> <b>...)</b>  <b>==&gt;</b>  <b>vector</b>
              Return  a  fresh  vector containing the concatenation of
              the given vectors.
          <b>(vector‐copy</b> <b>vector)</b>                           <b>==&gt;</b>  <b>vector</b>
          <b>(vector‐copy</b> <b>vector</b> <b>integer)</b>                   <b>==&gt;</b>  <b>vector</b>
          <b>(vector‐copy</b> <b>vector</b> <b>integer1</b> <b>integer2)</b>         <b>==&gt;</b>  <b>vector</b>
          <b>(vector‐copy</b> <b>vector</b> <b>integer1</b> <b>integer2</b> <b>object)</b>  <b>==&gt;</b>  <b>vector</b>
              Return a copy of the  given  vector.  When  <u>integer1</u>  is
              specified,  skip  the  given  number  of  elements. When
              <u>integer2</u> is also specified, copy elements from  <u>integer1</u>
              up  to,  but  not  including,  <u>integer2</u>.   When <u>integer2</u>
              exceeds the size of the original vector, add slots of an
              unspecific value to the copy. When an <u>object</u> argument is
              given, fill extra slots with that argument.

          <b>(void)</b>  <b>==&gt;</b>  <b>unspecific</b>
              Return an unspecific value.

          Refer to the help pages for more  detailed  descriptions  of
          the Scheme 9 extension procedures.

</pre><h4><b>SPECIAL</b> <b>VARIABLES</b></h4><pre>
          These variables are predefined in the top‐level scope of the
          interpreter.

          <b>**</b> <b>(object)</b>
              The   normal   form  of  the  expression  most  recently
              evaluated at  the  top  level.  Unspecific  results  and
              aborted computations do not change the value of <b>**</b>.

          <b>*arguments*</b> <b>(list</b> <b>of</b> <b>strings)</b>
              A  list  of  command line arguments passed to the <u>Scheme</u>
              <u>program</u> (not to the interpreter), i.e. the  <u>args</u>  in  <u>s9</u>
              <u>file</u> <u>args</u> or <u>s9</u> <u>‐‐</u> <u>args</u>.

          <b>*epsilon*</b> <b>(real</b> <b>number)</b>
              The smallest difference between two real numbers.

          <b>*extensions*</b> <b>(list</b> <b>of</b> <b>symbols)</b>
              Identifiers naming the compiled‐in extensions.

          <b>*host‐system*</b> <b>(symbol)</b>
              The host system running the <b>s9</b> interpreter: <b>unix</b>, <b>plan9</b>,
              or <b>unknown</b>.

          <b>*image‐file*</b> <b>(string</b> <b>or</b> <b>#f)</b>
              The  name of the heap image file loaded at startup time.
              When no image is loaded, the variable is set to <b>#f</b>.

          <b>*library‐path*</b> <b>(list</b> <b>of</b> <b>strings)</b>
              A  list  containing   each   path   contained   in   the
              <u>S9FES_LIBRARY_PATH</u> environment variable (see below).

          <b>*loading*</b> <b>(boolean)</b>
              Set to <b>#t</b> when <b>load</b>ing a file, else <b>#f</b>.

          <b>*release‐date*</b> <b>(string)</b>
              A   string   containing  the  release  date  of  the  S9
              interpreter in the form ‘YYYY‐MM‐DD’.
</pre><h4><b>MACROS</b></h4><pre>
          A macro is a procedure that is applied  to  its  unevaluated
          arguments.  The macro application is replaced with the value
          returned   by   the  procedure.   This  happens  before  the
          expression containing the macro application is evaluated, so
          a macro <u>rewrites</u> its own application:

          (define‐syntax (when p . c)
            ‘(if ,p (begin ,@c)))
          (macro‐expand ’(when (= 1 1) (display "true") (newline) #t))
            ==&gt;  (if (= 1 1)
                     (begin (display "true")
                            (newline)
                            #t))
          (when (= 1 1) 1 2 3)  ==&gt;  3

          The <b>define‐syntax</b> form introduces a new macro:

          <b>(define‐syntax</b> <b>name</b> <b>procedure)</b>        <b>==&gt;</b>  <b>unspecific</b>
          <b>(define‐syntax</b> <b>(name</b> <b>args</b> <b>...)</b> <b>body)</b>  <b>==&gt;</b>  <b>unspecific</b>

          Both of these forms introduce the keyword <u>name</u> and  bind  it
          to  a procedure. The first form requires the second argument
          to be a procedure. Like in <b>define</b> forms the  second  variant
          implies a procedure definition.

          Macros  may contain applications of macros that were defined
          earlier.  Macros may not  recurse  directly,  but  they  may
          implement  recursion internally using <b>letrec</b> or by rewriting
          their own applications. The following  macro,  for  example,
          does <u>not</u> work, because <u>d</u> is undefined in the body of <u>d</u>:

          <b>(define‐syntax</b> <b>(d</b> <b>x)</b> <b>(and</b> <b>(pair?</b> <b>x)</b> <b>(d</b> <b>(cdr</b> <b>x))))</b> <b>;</b> <b>wrong</b>

          The following version <u>does</u> work, though:

          <b>(define‐syntax</b> <b>(d</b> <b>x)</b> <b>(and</b> <b>(pair?</b> <b>x)</b> <b>‘(d</b> <b>,(cdr</b> <b>x))))</b> <b>;</b> <b>OK</b>

          The body of <b>define‐syntax</b> may be a <b>syntax‐rules</b> transformer,
          as described in R4RS, if the <b>syntax‐rules</b> extension has been
          loaded.

</pre><h4><b>TECHNICAL</b> <b>DETAILS</b></h4><pre>
          S9fES is a bytecode compiler and SECD abstract machine using
          shallow  binding,  primitive procedure inlining, and in‐situ
          lambda  lifting.   It  employs  an   extremely   reliable[1]
          constant‐space mark and sweep garbage collector with in‐situ
          vector  pool  compaction.   Memory pools grow on demand. The
          interpreter uses arbitrary‐precision integer arithmetics and
          decimal‐based real number arithmetics.

</pre><h4><b>INTERPRETER</b> <b>START‐UP</b></h4><pre>
          When the <b>s9</b> interpreter is started, the following steps will
          be performed in this order:

          Load heap image or library.
              The interpreter searches the <u>image</u> <u>directory</u> for a  heap
              image  file  and  loads it. The image directory is taken
              from the <u>S9FES_IMAGE_DIR</u> environment variable. When  the
              variable  is  undefined,  a  compiled‐in default will be
              used. The default image  file  is  named  <u>s9.image</u>.   An
              alternative  name  can  be  specified with the <b>‐i</b> option
              (see  <b>OPTIONS</b>).   When  no  image  file  is   found   in
              <u>S9FES_IMAGE_DIR</u>,  a fallback image is loaded from a file
              named <u>s9.image</u> in the local directory. When no  fallback
              image  can  be  found,  an  error  is  signalled and the
              interpreter will not start.

          Initialize extensions.
              Any  extensions  compiled  into  the   interpreter   are
              initialized  by  calling  the nullary procedure <b>ext:ext</b>,
              where <b>ext</b> is the name of the extension.  The  procedures
              are  optional. The last ‘extension’ being initialized is
              <b>S9</b> itself, so when a procedure named  <b>s9:s9</b>  exists,  it
              will be called at this point.

          Evaluate command line options.
              First  all  files  specified  in <b>‐l</b> <b>file</b> options will be
              loaded in the  specified  order.  Then  all  expressions
              specified  in  <b>‐e</b>  <b>expr</b> and <b>‐r</b> <b>expr</b> command line options
              will be evaluated in the given order. After that,  a  <b>‐d</b>
              <b>file</b>   option  will  be  evaluated,  if  present.  After
              processing such an option,  the  interpreter  will  exit
              immediately.   Finally,  if a program is being passed to
              the interpreter, the program will be run and any options
              following  the  program  name  will  be  passed  to  the
              program.  In  this  case  S9  will  exit  after  program
              execution.

          Enter REPL.
              Interactive mode is only entered, when no <b>‐e</b>, <b>‐r</b>, or  <b>‐d</b>
              option was given and no program was specified.

</pre><h4><b>ALLOCATION</b> <b>STRATEGY</b></h4><pre>
          The  S9fES  memory pools grow exponentially until the memory
          limit is reached. When the limit  is  reached,  the  current
          computation  is  aborted.  A  memory  limit can be specified
          using the <b>‐k</b>, <b>‐n</b>, and <b>‐u</b> command line options. The limit  is
          specified  in  units  of  1024  nodes/cells  (or in units of
          1024*1024 nodes/cells by appending an <b>m</b> suffix).

          Note that computations may abort <u>before</u> the limit is reached
          due to the way the pool  grows.  Use  the  <b>‐g</b>  command  line
          option to experiment with pool sizes.

          Specifying a limit of zero (or using the <b>‐u</b> option) disables
          the   memory  limit  completely  and  the  interpreter  will
          allocate as much memory as it can get.  This  option  should
          be used with care.

</pre><h4><b>LIMITATIONS</b></h4><pre>
          These parts of R4RS are not implemented:

          I/O: <b>char‐ready?</b>  (this is in the <b>sys‐unix</b> extension).
          Transcripts: <b>transcript‐off</b>, <b>transcript‐on</b>.
          Rational and complex numbers and related procedures.
          The <b>atan</b> procedure does not accept a second argument.
          Inexact digits of the form <u>#</u>.

</pre><h4><b>BUGS</b></h4><pre>
          You  may  not quasiquote <b>quasiquote</b> unless in <b>unquote</b> (e.g.:
          <b>‘‘x</b> does not work, but <b>‘,‘x</b> does).
          <b>Syntax‐rules</b> is not fully hygienic.

</pre><h4><b>FILES</b></h4><pre>
          <b>@S9DIR@</b>
              The S9fES procedure library (source code).
          <b>s9.image</b>
              The interpreter heap image.
          <b>*.scm</b>
              Scheme source code.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
          <b>S9FES_IMAGE_DIR</b>
              The directory that will be searched for heap image files
              when the s9 interpreter starts.

          <b>S9FES_LIBRARY_PATH</b>
              A colon‐separated list  of  directories  which  will  be
              searched  for library files by the <b>load‐from‐library</b> and
              <b>locate‐file</b> procedures. The value of this variable  will
              be  split at the colons and copied to the <b>*library‐path*</b>
              variable when S9 starts.
              Default: <u>.:˜/.s9fes:@S9DIR@</u>

</pre><h4><b>SIGNALS</b></h4><pre>
          <b>SIGINT</b>
              Abort input or terminate program execution.
          <b>SIGQUIT</b>
              Terminate the interpreter process (emergency exit).
          <b>"interrupt"</b>
              On Plan 9, receiving an <u>interrupt</u> note will abort  input
              or terminate program execution, as <u>SIGINT</u> would on Unix.

</pre><h4><b>FOOTNOTES</b></h4><pre>
          <b>[1]</b> See <u>comp.lang.scheme</u> Usenet message
              <u>&lt;<a href="mailto:vhtzl9lupyp.fsf@maharal.csail.mit.edu">vhtzl9lupyp.fsf@maharal.csail.mit.edu</a>&gt;</u>
              (Thu, 27 Aug 2009 13:27:42 ‐0400) and its follow‐ups.

</pre><h4><b>REFERENCES</b></h4><pre>
          The Revisedˆ4 Report on the Algorithmic Language Scheme.
              <b><a href="http://www">http://www</a>‐swiss.ai.mit.edu/˜jaffer/r4rs_toc.html</b>

          Scheme  9 from Empty Space ‐‐ A Guide to Implementing Scheme
          in C.
              <b>Available</b> <b>at</b> <b>Lulu.com,</b> <b>see</b> <b><a href="http://www.t3x.org">http://www.t3x.org</a></b>

</pre><h4><b>AUTHOR</b></h4><pre>
          Nils M Holm
</pre>
 </div>
</div></section>
</div>
</body>
</html>