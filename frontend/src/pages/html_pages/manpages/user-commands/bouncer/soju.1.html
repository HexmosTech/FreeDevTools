<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>soju - IRC bouncer</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/soju">soju_0.8.2-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       soju - IRC bouncer

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>soju</b> [options...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       soju is a user-friendly IRC bouncer. It connects to upstream IRC servers on behalf of the user to provide
       extra features.

       •   Multiple separate users sharing the same bouncer, each with their own upstream servers
       •   Sending  the  backlog (messages received while the user was disconnected from the bouncer), with per-
           client buffers

       To connect to the bouncer, use the bouncer username and password. To use a client which  doesn't  support
       the  <u>soju.im/bouncer-networks</u>  IRC  extension,  setup  one  connection per server configured in soju, and
       indicate the network name in the username: "&lt;username&gt;/&lt;network&gt;". Then channels can be joined and parted
       as if you were directly connected to the upstream server.

       For per-client history to work on clients which don't support the IRCv3  <u>chathistory</u>  extension,  clients
       need to indicate their name. This can be done by adding a "@&lt;client&gt;" suffix to the username.

       When  joining  a channel, the channel will be saved and automatically joined on the next connection. When
       registering or authenticating with NickServ, the credentials will be saved and automatically used on  the
       next connection if the server supports SASL. When parting a channel with the reason "detach", the channel
       will be detached instead of being left.

       If  a  network  specified  in  the  username doesn't exist, and the network name is a valid hostname, the
       network will be automatically added.

       When all clients are disconnected from the bouncer, the user is automatically marked as away by default.

       soju will reload the configuration file, the TLS certificate/key and the MOTD file when it  receives  the
       HUP signal. The configuration options <u>listen</u>, <u>db</u> and <u>log</u> cannot be reloaded.

       Administrators  can  broadcast  a  message  to  all  bouncer users via <u>/notice</u> <u>$&lt;hostname&gt;</u> <u>&lt;text&gt;</u>, or via
       <u>/notice</u> <u>$*</u> <u>&lt;text&gt;</u> if the connection isn't bound to a particular network. All currently connected  bouncer
       users will receive the message from the special <u>BouncerServ</u> service.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-h,</b> <b>-help</b>
           Show help message and quit.

       <b>-config</b> &lt;path&gt;
           Path to the config file. If unset, a default config file is used.

       <b>-debug</b>
           Enable debug logging (this will leak sensitive information such as passwords).

       <b>-listen</b> &lt;uri&gt;
           Listening URI (default: ":6697"). Can be specified multiple times.

</pre><h4><b>CONFIG</b> <b>FILE</b></h4><pre>
       The config file has one directive per line.

       Example:

           listen ircs://
           tls cert.pem key.pem
           hostname example.org

       The following directives are supported:

       <b>listen</b> &lt;uri&gt;
           Listening URI (default: ":6697").

           The following URIs are supported:

           •   <u>[ircs://][host][:port]</u> listens with TLS over TCP (default port if omitted: 6697)
           •   <u>irc+insecure://[host][:port]</u> listens with plain-text over TCP (default port if omitted: 6667)
           •   <u>unix://&lt;path&gt;</u> listens on a Unix domain socket
           •   <u>https://[host][:port]</u>  listens  for  HTTPS  connections (default port: 443) and handles WebSocket
               requests at endpoint <u>/socket</u>
           •   <u>http+insecure://[host][:port]</u> listens for plain-text HTTP  connections  (default  port:  80)  and
               handles WebSocket requests at endpoint <u>/socket</u>
           •   <u>http+unix://&lt;path&gt;</u>  listens  for  plain-text HTTP connections on a Unix domain socket and handles
               WebSocket requests at endpoint <u>/socket</u>
           •   <u>wss://[host][:port]</u> listens for WebSocket connections over TLS (default port: 443)
           •   <u>ws+insecure://[host][:port]</u> listens for plain-text WebSocket connections (default port: 80)
           •   <u>ws+unix://&lt;path&gt;</u> listens for plain-text WebSocket connections on a Unix domain socket
           •   <u>ident://[host][:port]</u> listens for plain-text ident connections (default port: 113)
           •   <u>http+prometheus://localhost:&lt;port&gt;</u> listens for plain-text HTTP connections and serves  Prometheus
               metrics (host must be "localhost")
           •   <u>http+pprof://localhost:&lt;port&gt;</u>  listens  for  plain-text HTTP connections and serves pprof runtime
               profiling    data    (host    must    be    "localhost").    For    more    information,     see:
               &lt;https://pkg.go.dev/net/http/pprof&gt;.
           •   <u>unix+admin://[path]</u>  listens  on  a  Unix  domain  socket for administrative connections, such as
               sojuctl (default path: /run/soju/admin)

           If the scheme is omitted, "ircs" is assumed. If multiple <b>listen</b> directives are specified,  soju  will
           listen on each of them.

       <b>hostname</b> &lt;name&gt;
           Server hostname (default: system hostname).

           This should be set to a fully qualified domain name.

       <b>title</b> &lt;title&gt;
           Server  title.  This  will be sent as the <u>ISUPPORT</u> <u>NETWORK</u> value when clients don't select a specific
           network.

       <b>tls</b> &lt;cert&gt; &lt;key&gt;
           Enable TLS support. The certificate and the key files must be PEM-encoded.

       <b>db</b> &lt;driver&gt; &lt;source&gt;
           Set the database location for user, network and channel storage. By default, a  <u>sqlite3</u>  database  is
           opened in "./soju.db".

           Supported drivers:

           •   <u>sqlite3</u> expects <u>source</u> to be a path to the SQLite file
           •   <u>postgres</u>  expects  <u>source</u>  to be a space-separated list of <u>key=value</u> parameters, e.g. <u>db</u> <u>postgres</u>
               <u>"host=/run/postgresql</u> <u>dbname=soju"</u>. Note that <u>sslmode</u> defaults to <u>require</u>. For  more  information
               on        connection        strings,        see:       &lt;https://pkg.go.dev/github.com/lib/pq#hdr-
               Connection_String_Parameters&gt;.

       <b>message-store</b> &lt;driver&gt; [source]
           Set the database location for IRC messages. By default, an in-memory message database is used.

           Supported drivers:

           •   <u>memory</u> stores messages in memory. For each channel/user, only the latest 4K messages are kept  in
               memory, older messages are discarded. This driver is very basic and doesn't support features such
               as the <u>chathistory</u> extension and search.
           •   <u>fs</u>  stores  messages  on  disk,  in  the  same  format as ZNC. <u>source</u> is required and is the root
               directory path for the database. This on-disk format is lossy: some IRCv3 messages (e.g.  TAGMSG)
               and all message tags are discarded.
           •   <u>db</u> stores messages in the database. A full-text search index is used to speed up search queries.

           (<u>log</u> is a deprecated alias for this directive.)

       <b>file-upload</b> &lt;driver&gt; [source]
           Set the database location for uploaded files.

           File  upload  requires  setting  up  an  HTTP listener (see <u>https://</u> and <u>http+insecure://</u> URIs in the
           <u>listen</u> directive).

           Supported drivers:

           •   <u>fs</u> stores uploaded files on disk. <u>source</u> is required.

       <b>http-origin</b> &lt;patterns...&gt;
           List of allowed HTTP origins for  WebSocket  listeners.  The  parameters  are  interpreted  as  shell
           patterns, see <b><a href="../man7/glob.7.html">glob</a></b>(7).

           By  default,  only  the  request  host  is  authorized.  Use  this  directive  to enable cross-origin
           WebSockets.

       <b>http-ingress</b> &lt;url&gt;
           External URL on which HTTPS listeners are exposed.

           By default, this is <u>https://&lt;hostname&gt;</u>.

       <b>accept-proxy-ip</b> &lt;cidr...&gt;
           Allow the specified IPs to act as a proxy. Proxys have the ability to overwrite the remote and  local
           connection  addresses (via the PROXY protocol, the Forwarded HTTP header field defined in RFC 7239 or
           the X-Forwarded-* HTTP header fields). The special name "localhost" accepts  the  loopback  addresses
           127.0.0.0/8 and ::1/128.

           By default, all IPs are rejected.

       <b>max-user-networks</b> &lt;limit&gt;
           Maximum number of networks per user. By default, there is no limit.

       <b>motd</b> &lt;path&gt;
           Path  to the MOTD file. The bouncer MOTD is sent to clients which aren't bound to a specific network.
           By default, no MOTD is sent.

       <b>upstream-user-ip</b> &lt;cidr...&gt;
           Enable per-user IP addresses. One IPv4 range and/or one IPv6 range can be specified in CIDR notation.
           One IP address per range will be assigned to each user and will be used as the  source  address  when
           connecting to an upstream network.

           This  can  be useful to avoid having the whole bouncer banned from an upstream network because of one
           malicious user.

       <b>disable-inactive-user</b> &lt;duration&gt;
           Disable inactive users after the specified duration.

           A user is inactive when the last downstream connection is closed.

           The duration is a positive decimal number followed by  the  unit  "d"  (days).  For  instance,  "30d"
           disables users 30 days after they last disconnect from the bouncer.

       <b>enable-user-on-auth</b> true|false
           Enable users when they successfully authenticate.

           This can be used together with <u>disable-inactive-user</u> to seamlessly disable and re-enable users during
           lengthy inactivity.

           When  external  authentication  is  used  (e.g. <u>auth</u> <u>oauth2</u>), bouncer users are automatically created
           after successfull authentication.

       <b>auth</b> &lt;driver&gt; ...
           Set the authentication method. By default, internal authentication is used.

           Supported drivers:

           <b>auth</b> <b>internal</b>
               Use internal authentication.
           <b>auth</b> <b>oauth2</b> &lt;url&gt;
               Use external OAuth 2.0 authentication. The authorization server URL must be provided. The  client
               ID  and  client  secret  can  be  provided as username and password in the URL. The authorization
               server must support OAuth 2.0 Authorization Server  Metadata  (RFC  8414)  and  OAuth  2.0  Token
               Introspection (RFC 7662).
           <b>auth</b> <b>pam</b>
               Use PAM authentication.

</pre><h4><b>IRC</b> <b>SERVICE</b></h4><pre>
       soju  exposes  an  IRC service called <b>BouncerServ</b> to manage the bouncer. Commands can be sent via regular
       private messages (<u>/msg</u> <u>BouncerServ</u> <u>&lt;command&gt;</u> <u>[args...]</u>). Commands may be written in full  or  abbreviated
       form, for instance <b>network</b> can be abbreviated as <b>net</b> or just <b>n</b>.

       Commands  are  parsed  according the POSIX shell rules. In particular, words can be quoted (via double or
       single quotes) and a backslash escapes the next character.

       <b>help</b> [command]
           Show a list of commands. If <u>command</u> is specified, show a help message for the command.

       <b>network</b> <b>create</b> <b>-addr</b> &lt;addr&gt; [options...]
           Connect to a new network at <u>addr</u>. <u>-addr</u> is mandatory.

           <u>addr</u> supports several connection types:

           •   <u>[ircs://]&lt;host&gt;[:port]</u> connects with TLS over TCP
           •   <u>irc+insecure://&lt;host&gt;[:port]</u> connects with plain-text TCP
           •   <u>irc+unix:///&lt;path&gt;</u> connects to a Unix socket

           For example, to connect to Libera Chat:

               net create -addr irc.libera.chat

           Other options are:

           <b>-name</b> &lt;name&gt;
               Short network name. This will be used instead of <u>addr</u> to refer to the network.

           <b>-username</b> &lt;username&gt;
               Connect with the specified username. By default, the nickname is used.

           <b>-pass</b> &lt;pass&gt;
               Connect with the specified server password.

           <b>-realname</b> &lt;realname&gt;
               Connect with the specified real name.  By  default,  the  account's  realname  is  used  if  set,
               otherwise the network's nickname is used.

           <b>-certfp</b> &lt;fingerprint&gt;
               Instead of using certificate authorities to check the server's TLS certificate, check whether the
               server certificate matches the provided fingerprint. This can be used to connect to servers using
               self-signed  certificates. The fingerprint format is SHA512. An empty string removes any previous
               fingerprint.

               The following command can be used to fetch the certificate fingerprint of an IRC server:

                   openssl s_client -connect irc.example.org:6697 -verify_quiet &lt;/dev/null | openssl x509 -fingerprint -sha512 -noout -in <a href="file:/dev/stdin">/dev/stdin</a>

           <b>-nick</b> &lt;nickname&gt;
               Connect with the specified nickname. By default, the account's username is used.

           <b>-auto-away</b> true|false
               Enable or disable the auto-away feature. If the feature is enabled, the user will  be  marked  as
               away when all clients are disconnected from the bouncer. By default, auto-away is enabled.

           <b>-enabled</b> true|false
               Enable  or  disable  the network. If the network is disabled, the bouncer won't connect to it. By
               default, the network is enabled.

           <b>-connect-command</b> &lt;command&gt;
               Send the specified quoted string as a raw IRC command right after connecting to the server.  This
               can be used to identify to an account when the server doesn't support SASL.

               For instance, to identify with <u>NickServ</u>, the following command can be used:

                   "PRIVMSG NickServ :IDENTIFY &lt;password&gt;"

               The  flag  can  be specified multiple times to send multiple IRC messages. To clear all commands,
               set it to the empty string.

       <b>network</b> <b>update</b> [name] [options...]
           Update an existing network. The options are the same as the <u>network</u> <u>create</u> command.

           When this command is executed, soju will disconnect and re-connect to the network.

           If <u>name</u> is not specified, the current network is updated.

       <b>network</b> <b>delete</b> [name]
           Disconnect and delete a network.

           If <u>name</u> is not specified, the current network is deleted.

       <b>network</b> <b>quote</b> [name] &lt;command&gt;
           Send a raw IRC line as-is to a network.

           If <u>name</u> is not specified, the command is sent to the current network.

       <b>network</b> <b>status</b>
           Show a list of saved networks and their current status.

       <b>channel</b> <b>status</b> [options...]
           Show a list of saved channels and their current status.

           Options:

           <b>-network</b> &lt;name&gt;
               Only show channels for the specified network. By  default,  only  the  channels  in  the  current
               network are displayed.

       <b>channel</b> <b>update</b> &lt;name&gt; [options...]
           Update the options of an existing channel.

           Options are:

           <b>-detached</b> true|false
               Attach or detach this channel.

               A  detached  channel  is joined but is hidden by the bouncer. This is useful to e.g. collect logs
               and highlights in low-interest or high-traffic channels.

           <b>-relay-detached</b> &lt;mode&gt;
               Set when to relay messages from detached channels to the user with a BouncerServ NOTICE.

               Modes are:

               <b>message</b>
                   Relay any message from this channel when detached.

               <b>highlight</b>
                   Relay only messages mentioning you when detached.

               <b>none</b>
                   Don't relay any messages from this channel when detached.

               <b>default</b>
                   Currently same as <b>highlight</b>. This is the default behaviour.

           <b>-reattach-on</b> &lt;mode&gt;
               Set when to automatically reattach to detached channels.

               Modes are:

               <b>message</b>
                   Reattach to this channel when any message is received.

               <b>highlight</b>
                   Reattach to this channel when any message mentioning you is received.

               <b>none</b>
                   Never automatically reattach to this channel.

               <b>default</b>
                   Currently same as <b>none</b>. This is the default behaviour.

           <b>-detach-after</b> &lt;duration&gt;
               Automatically detach this channel after the specified duration has elapsed without  receving  any
               message corresponding to <b>-detach-on</b>.

               Example duration values: <b>1h30m</b>, <b>30s</b>, <b>2.5h</b>.

               Setting  this  value  to  0  will  disable  this  behaviour,  i.e.  this  channel  will  never be
               automatically detached. This is the default behaviour.

           <b>-detach-on</b> &lt;mode&gt;
               Set when to reset the auto-detach timer used by <b>-detach-after</b>, causing it to wait again  for  the
               auto-detach duration timer before detaching. Joining, reattaching, sending a message, or changing
               any channel option will reset the timer, in addition to the messages specified by the mode.

               Modes are:

               <b>message</b>
                   Receiving any message from this channel will reset the auto-detach timer.

               <b>highlight</b>
                   Receiving any message mentioning you from this channel will reset the auto-detach timer.

               <b>none</b>
                   Receiving  messages  from this channel will not reset the auto-detach timer. Sending messages
                   or joining the channel will still reset the timer.

               <b>default</b>
                   Currently same as <b>message</b>. This is the default behaviour.

       <b>channel</b> <b>delete</b> &lt;name&gt;
           Leave and forget a channel.

       <b>certfp</b> <b>generate</b> [options...]
           Generate self-signed certificate and use it for authentication (via SASL EXTERNAL).

           Generates a 3072-bit RSA private key by default.

           Options are:

           <b>-network</b> &lt;name&gt;
               Select a network. By default, the current network is selected, if any.

           <b>-key-type</b> &lt;type&gt;
               Private key algorithm to use. Valid values are: <u>rsa</u>, <u>ecdsa</u> and <u>ed25519</u>. <u>ecdsa</u> uses the NIST P-521
               curve.

           <b>-bits</b> &lt;bits&gt;
               Size of RSA key to generate. Ignored for other key types.

       <b>certfp</b> <b>fingerprint</b> [options...]
           Show SHA-1 and SHA-256 fingerprints for the certificate currently used with the network.

           Options are:

           <b>-network</b> &lt;name&gt;
               Select a network. By default, the current network is selected, if any.

       <b>sasl</b> <b>status</b> [options...]
           Show current SASL status.

           Options are:

           <b>-network</b> &lt;name&gt;
               Select a network. By default, the current network is selected, if any.

       <b>sasl</b> <b>set-plain</b> [options...] &lt;username&gt; &lt;password&gt;
           Set SASL PLAIN credentials.

           Options are:

           <b>-network</b> &lt;name&gt;
               Select a network. By default, the current network is selected, if any.

       <b>sasl</b> <b>reset</b> [options...]
           Disable SASL authentication and remove stored credentials.

           Options are:

           <b>-network</b> &lt;name&gt;
               Select a network. By default, the current network is selected, if any.

       <b>user</b> <b>status</b> [username]
           Show a list of users on this server. Only admins can query this information.

           If <u>username</u> is specified, statistics are only displayed for this user.

       <b>user</b> <b>create</b> -username &lt;username&gt; -password &lt;password&gt; [options...]
           Create a new soju user. Only admin users can create new accounts. The <u>-username</u> and  <u>-password</u>  flags
           are mandatory.

           Options are:

           <b>-username</b> &lt;username&gt;
               The bouncer username. This cannot be changed after the user has been created.

           <b>-password</b> &lt;password&gt;
               The bouncer password.

           <b>-disable-password</b>
               Disable password authentication. The user will be unable to login.

           <b>-admin</b> true|false
               Make the new user an administrator.

           <b>-nick</b> &lt;nick&gt;
               Set the user's nickname. This is used as a fallback if there is no nickname set for a network.

           <b>-realname</b> &lt;realname&gt;
               Set the user's realname. This is used as a fallback if there is no realname set for a network.

           <b>-enabled</b> true|false
               Enable or disable the user. If the user is disabled, the bouncer will not connect to any of their
               networks, and downstream connections will be immediately closed. By default, users are enabled.

       <b>user</b> <b>update</b> [username] [options...]
           Update a user. The options are the same as the <u>user</u> <u>create</u> command.

           If <u>username</u> is omitted, the current user is updated. Only admins can update other users.

           Not all flags are valid in all contexts:

           •   The <u>-username</u> flag is never valid, usernames are immutable.
           •   The <u>-nick</u> and <u>-realname</u> flag are only valid when updating the current user.
           •   The <u>-admin</u> and <u>-enabled</u> flags are only valid when updating another user.

       <b>user</b> <b>delete</b> &lt;username&gt; [confirmation token]
           Delete a soju user.

           Only admins can delete other users.

       <b>user</b> <b>run</b> &lt;username&gt; &lt;command...&gt;
           Execute a command as another user.

           Only admins can use this command.

       <b>server</b> <b>status</b>
           Show some bouncer statistics. Only admins can query this information.

       <b>server</b> <b>notice</b> &lt;message&gt;
           Broadcast  a  notice. All currently connected bouncer users will receive the message from the special
           <u>BouncerServ</u> service. Only admins can broadcast a notice.

</pre><h4><b>AUTHORS</b></h4><pre>
       Maintained by Simon Ser &lt;<a href="mailto:contact@emersion.fr">contact@emersion.fr</a>&gt;, who is assisted by  other  open-source  contributors.  For
       more information about soju development, see &lt;https://soju.im&gt;.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/sojuctl.1.html">sojuctl</a></b>(1)

                                                   2024-12-16                                            <u><a href="../man1/soju.1.html">soju</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>