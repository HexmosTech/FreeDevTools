<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>niceload - slow down a program when the load average is above a certain limit</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/parallel">parallel_20240222+ds-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       niceload - slow down a program when the load average is above a certain limit

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>niceload</b> [-v] [-h] [-n nice] [-I io] [-L load] [-M mem] [-N] [--sensor program] [-t time] [-s time|-f
       factor] ( command | -p PID [-p PID ...] | --prg program )

</pre><h4><b>DESCRIPTION</b></h4><pre>
       GNU <b>niceload</b> will slow down a program when the load average (or other system activity) is above a certain
       limit. When the limit is reached the program will be suspended for some time. Then resumed again for some
       time.  Then the load average is checked again and we start over.

       Instead of load average <b>niceload</b> can also look at disk I/O, amount of free memory, or swapping activity.

       If the load is 3.00 then the default settings will run a program like this:

       run 1 second, suspend (3.00-1.00) seconds, run 1 second, suspend (3.00-1.00) seconds, run 1 second, ...

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-B</b>
       <b>--battery</b>
                Suspend   if   the   system   is  running  on  battery.  Shorthand  for:  -l  -1  --sensor  'cat
                /sys/class/power_supply/BAT0/status  /proc/acpi/battery/BAT0/state  2&gt;/dev/null  |  grep  -i  -q
                discharging; echo $?'

       <b>-f</b> <u>FACTOR</u>
       <b>--factor</b> <u>FACTOR</u>
                Suspend time factor. Dynamically set <b>-s</b> as amount over limit * factor. Default is 1.

       <b>-H</b>
       <b>--hard</b>   Hard limit. <b>--hard</b> will suspend the process until the system is under the limits. The default is
                <b>--soft</b>.

       <b>--io</b> <u>iolimit</u>
       <b>-I</b> <u>iolimit</u>
                Limit  for I/O. The amount of disk I/O will be computed as a value 0 - 10, where 0 is no I/O and
                10 is at least one disk is 100% saturated.

                <b>--io</b> will set both <b>--start-io</b> and <b>--run-io</b>.

       <b>--load</b> <u>loadlimit</u>
       <b>-L</b> <u>loadlimit</u>
                Limit for load average.

                <b>--load</b> will set both <b>--start-load</b> and <b>--run-load</b>.

       <b>--mem</b> <u>memlimit</u>
       <b>-M</b> <u>memlimit</u>
                Limit for free memory. This is the amount of bytes available as free  +  cache.  This  limit  is
                treated  opposite  other limits: If the system is above the limit the program will run, if it is
                below the limit the program will stop

                <u>memlimit</u> can be postfixed with K, M, G, T, or  P  which  would  multiply  the  size  with  1024,
                1048576, 1073741824, or 1099511627776 respectively.

                <b>--mem</b> will set both <b>--start-mem</b> and <b>--run-mem</b>.

       <b>--noswap</b>
       <b>-N</b>       No  swapping.  If the system is swapping both in and out it is a good indication that the system
                is memory stressed.

                <b>--noswap</b> is over limit if the system is swapping both in and out.

                <b>--noswap</b> will set both <b>--start-noswap</b> and <b>--run-noswap</b>.

       <b>--net</b>    Shorthand for <b>--nethops</b> <b>3</b>.

       <b>--nethops</b> <u>h</u>
                Network nice. Pause if the internet connection is overloaded.

                <b>niceload</b> finds a router <u>h</u> hops closer to the internet.  It  <b>ping</b>s  this  every  second.  If  the
                latency is more than 50% bigger than the median, it is regarded as being over the limit.

                <b>--nethops</b>  can  be  combined  with <b>--hard</b>. Without <b>--hard</b> the program may be able to queue up so
                much traffic that it will take longer than the <b>--suspend</b> time to clear it. <b>--hard</b> is useful  for
                traffic that does not break by being suspended for a longer time.

                <b>--nethops</b>  can  be combined with a high <b>--suspend</b>. This way a program can be allowed to do a bit
                of traffic now and then. This is useful to keep the connection alive.

       <b>-n</b> <u>niceness</u>
       <b>--nice</b> <u>niceness</u>
                Sets niceness. See <b><a href="../man1/nice.1.html">nice</a></b>(1).

       <b>-p</b> <u>PID</u>[,<u>PID</u>]
       <b>--pid</b> <u>PID</u>[,<u>PID</u>]
                Process IDs of processes to suspend. You can specify multiple process IDs with multiple  <b>-p</b>  <u>PID</u>
                or by separating the PIDs with comma.

       <b>--prg</b> <u>program</u>
       <b>--program</b> <u>program</u>
                Name  of  running  program  to  suspend.  You  can specify multiple programs with multiple <b>--prg</b>
                <u>program</u>. If no processes with the name <u>program</u> is found, <b>niceload</b>  with  search  for  substrings
                containing <u>program</u>.

       <b>--quote</b>
       <b>-q</b>       Quote the command line. Useful if the command contains chars like *, $, &gt;, and " that should not
                be interpreted by the shell.

       <b>--run-io</b> <u>iolimit</u>
       <b>--ri</b> <u>iolimit</u>
       <b>--run-load</b> <u>loadlimit</u>
       <b>--rl</b> <u>loadlimit</u>
       <b>--run-mem</b> <u>memlimit</u>
       <b>--rm</b> <u>memlimit</u>
                Run  limit. The running program will be slowed down if the system is above the limit. See: <b>--io</b>,
                <b>--load</b>, <b>--mem</b>, <b>--noswap</b>.

       <b>--sensor</b> <u>sensor</u> <u>program</u>
                Read sensor. Use <u>sensor</u> <u>program</u> to read a sensor.

                This will keep the CPU temperature below 80 deg C on GNU/Linux:

                  niceload -l 80000 -f 0.001 --sensor 'sort -n /sys/devices/platform/coretemp*/temp*_input' gzip *

                This will stop if the disk space &lt; 100000.

                  niceload -H -l -100000 --sensor "df . | awk '{ print \$4 }'" echo

       <b>--start-io</b> <u>iolimit</u>
       <b>--si</b> <u>iolimit</u>
       <b>--start-load</b> <u>loadlimit</u>
       <b>--sl</b> <u>loadlimit</u>
       <b>--start-mem</b> <u>memlimit</u>
       <b>--sm</b> <u>memlimit</u>
                Start limit. The program will not start until the system is below the limit. See: <b>--io</b>,  <b>--load</b>,
                <b>--mem</b>, <b>--noswap</b>.

       <b>--soft</b>
       <b>-S</b>       Soft  limit.  <b>niceload</b>  will suspend a process for a while and then let it run for a second thus
                only slowing down a process while the system is over one  of  the  given  limits.  This  is  the
                default.

       <b>--suspend</b> <u>SEC</u>
       <b>-s</b> <u>SEC</u>   Suspend time. Suspend the command this many seconds when the max load average is reached.

       <b>--recheck</b> <u>SEC</u>
       <b>-t</b> <u>SEC</u>   Recheck load time. Sleep SEC seconds before checking load again. Default is 1 second.

       <b>--verbose</b>
       <b>-v</b>       Verbose.  Print  some  extra  output  on  what is happening. Use <b>-v</b> until you know what your are
                doing.

</pre><h4><b>EXAMPLE:</b> <b>See</b> <b>niceload</b> <b>in</b> <b>action</b></h4><pre>
       In terminal 1 run: top

       In terminal 2 run:

       <b>niceload</b> <b>-q</b> <b>perl</b> <b>-e</b> <b>'$|=1;do{$l==$r</b> <b>or</b> <b>print</b> <b>".";</b> <b>$l=$r}until(($r=time-$^T)</b>&gt;<b>50)'</b>

       This will print a '.' every second for 50 seconds and eat a lot of CPU. When the load rises  to  1.0  the
       process is suspended.

</pre><h4><b>EXAMPLE:</b> <b>Run</b> <b>updatedb</b></h4><pre>
       Running <b>updatedb</b> can often starve the system for disk I/O and thus result in a high load.

       Run <b>updatedb</b> but suspend <b>updatedb</b> if the load is above 2.00:

       <b>niceload</b> <b>-L</b> <b>2</b> <b>updatedb</b>

</pre><h4><b>EXAMPLE:</b> <b>Run</b> <b>rsync</b></h4><pre>
       <b>rsync</b> can, just like <b>updatedb</b>, starve the system for disk I/O and thus result in a high load.

       Run <b>rsync</b> but keep load below 3.4. If load reaches 7 sleep for (7-3.4)*12 seconds:

       <b>niceload</b> <b>-L</b> <b>3.4</b> <b>-f</b> <b>12</b> <b>rsync</b> <b>-Ha</b> <b><a href="file:/home/">/home/</a></b> <b>/backup/home/</b>

</pre><h4><b>EXAMPLE:</b> <b>Ensure</b> <b>enough</b> <b>disk</b> <b>cache</b></h4><pre>
       Assume  the program <b>foo</b> uses 2 GB files intensively. <b>foo</b> will run fast if the files are in disk cache and
       be slow as a crawl if they are not in the cache.

       To ensure 2 GB are reserved for disk cache run:

       <b>niceload</b> <b>--hard</b> <b>--run-mem</b> <b>2g</b> <b>foo</b>

       This will not guarantee that the 2 GB memory will be used for the files for <b>foo</b>, but it will stop <b>foo</b>  if
       the memory for disk cache is too low.

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       None. In future versions $NICELOAD will be able to contain default settings.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       Exit status should be the same as the command being run (untested).

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<a href="mailto:bug-parallel@gnu.org">bug-parallel@gnu.org</a>&gt;.

</pre><h4><b>AUTHOR</b></h4><pre>
       Copyright (C) 2004-11-19 Ole Tange, <a href="http://ole.tange.dk">http://ole.tange.dk</a>

       Copyright (C) 2005-2010 Ole Tange, <a href="http://ole.tange.dk">http://ole.tange.dk</a>

       Copyright (C) 2010-2024 Ole Tange, <a href="http://ole.tange.dk">http://ole.tange.dk</a> and Free Software Foundation, Inc.

</pre><h4><b>LICENSE</b></h4><pre>
       This  program  is  free  software;  you  can  redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation; either version 3 of the License,  or
       at your option any later version.

       This  program  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General  Public
       License for more details.

       You  should  have received a copy of the GNU General Public License along with this program.  If not, see
       &lt;<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.

   <b>Documentation</b> <b>license</b> <b>I</b>
       Permission is granted to copy, distribute and/or modify this documentation under the  terms  of  the  GNU
       Free  Documentation  License, Version 1.3 or any later version published by the Free Software Foundation;
       with no Invariant Sections, with no Front-Cover Texts, and with no  Back-Cover  Texts.   A  copy  of  the
       license is included in the file LICENSES/GFDL-1.3-or-later.txt.

   <b>Documentation</b> <b>license</b> <b>II</b>
       You are free:

       <b>to</b> <b>Share</b> to copy, distribute and transmit the work

       <b>to</b> <b>Remix</b> to adapt the work

       Under the following conditions:

       <b>Attribution</b>
                You  must  attribute  the work in the manner specified by the author or licensor (but not in any
                way that suggests that they endorse you or your use of the work).

       <b>Share</b> <b>Alike</b>
                If you alter, transform, or build upon this work, you may distribute  the  resulting  work  only
                under the same, similar or a compatible license.

       With the understanding that:

       <b>Waiver</b>   Any of the above conditions can be waived if you get permission from the copyright holder.

       <b>Public</b> <b>Domain</b>
                Where  the work or any of its elements is in the public domain under applicable law, that status
                is in no way affected by the license.

       <b>Other</b> <b>Rights</b>
                In no way are any of the following rights affected by the license:

                • Your  fair  dealing  or  fair  use  rights,  or  other  applicable  copyright  exceptions  and
                  limitations;

                • The author's moral rights;

                • Rights  other  persons  may have either in the work itself or in how the work is used, such as
                  publicity or privacy rights.

       <b>Notice</b>   For any reuse or distribution, you must make clear to others the license terms of this work.

       A copy of the full license is included in the file as LICENCES/CC-BY-SA-4.0.txt

</pre><h4><b>DEPENDENCIES</b></h4><pre>
       GNU <b>niceload</b> uses Perl, and the Perl modules POSIX, and Getopt::Long.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/parallel.1.html">parallel</a></b>(1), <b><a href="../man1/nice.1.html">nice</a></b>(1), <b><a href="../man1/uptime.1.html">uptime</a></b>(1)

20240222                                           2024-03-22                                        <u><a href="../man1/NICELOAD.1.html">NICELOAD</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>