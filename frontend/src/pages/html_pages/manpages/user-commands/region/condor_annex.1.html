<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>condor_annex - HTCondor Manual</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/condor">condor_23.6.2+dfsg-2build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       condor_annex - HTCondor Manual

       Add cloud resources to the pool.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>condor_annex</b> <b>-help</b>

       <b>condor_annex</b>     [<b>-aws-region</b>     <u>&lt;region&gt;</u>]    <b>-setup</b>    <u>[FROM</u>    <u>INSTANCE|[/full/path/to/access/key/file</u>
       <u>[/full/path/to/secret/key/file]]]</u>

       <b>condor_annex</b> [<b>-aws-on-demand</b> ] <b>-annex-name</b> <u>&lt;name</u> <u>of</u> <u>the</u>  <u>annex&gt;</u>  <b>-count</b>  <u>&lt;integer</u>  <u>number</u>  <u>of</u>  <u>instances&gt;</u>
       [<b>-aws-on-demand-*</b> ] [<b>common</b> <b>options</b> ]

       <b>condor_annex</b>   [<b>-aws-spot-fleet</b>   ]   <b>-annex-name</b>   <u>&lt;name</u>   <u>of</u>   <u>the</u>   <u>annex&gt;</u>   <b>-slots</b>  <u>&lt;integer</u>  <u>weight&gt;</u>
       [<b>-aws-spot-fleet-*</b> ] [<b>common</b> <b>options</b> ]

       <b>condor_annex</b> <b>-annex-name</b> <u>&lt;name</u> <u>of</u> <u>the</u> <u>annex&gt;</u> <b>-duration</b> <u>hours</u>

       <b>condor_annex</b> [<b>-annex-name</b> <u>&lt;name</u> <u>of</u> <u>the</u> <u>annex&gt;</u>] <b>-status</b> [<b>-classad</b> ]

       <b>condor_annex</b> <b>-check-setup</b>

       <b>condor_annex</b> &lt;condor_annex options&gt; <b>status</b> &lt;condor_status options&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>condor_annex</u> adds clouds resources to the pool. ("The  pool"  is  determined  in  the  usual  manner  for
       HTCondor  daemons  and tools.) This version supports only Amazon Web Services ('AWS'). To add "on-demand"
       instances, use the third form listed above; to add "spot" instances, use the fourth. For  an  explanation
       of terms, consult either the HTCondor manual in the <u>Cloud</u> <u>Computing</u> chapter or the AWS documentation.

       Using  <u>condor_annex</u>  with AWS requires a one-time setup procedure performed by invoking <u>condor_annex</u> with
       the <b>-setup</b> flag (the second form listed above). You may check if this procedure has been  performed  with
       the  <b>-check-setup</b>  flag  (the  seventh form listed above). If you use the setup flag on an instance whose
       role gives it sufficient privileges, you may, instead of specifying your API keys, pass <b>FROM</b> <b>INSTANCE</b>  to
       <b>-setup</b> to ask <u>condor_annex</u> to use the instance's role credentials.

       To  reset  the  lease  on  an  existing  annex,  invoke <u>condor_annex</u> with only the <b>-annex-name</b> option and
       <b>-duration</b> flag (the fifth form listed above).

       To determine which of the instances previously requested for a particular annex are not currently in  the
       pool, invoke <u>condor_annex</u> with the <b>-status</b> flag and the <b>-annex-name</b> option (the sixth form listed above).
       The  output  of  this command is intended to be human-readable; specifying the <b>-classad</b> flag will produce
       the same information in ClassAd format. If you omit <b>-annex-name</b>, information  for  all  annexes  will  be
       returned.

       Starting in 8.7.3, you may instead invoke <u>condor_annex</u> with <b>status</b> as a command argument (the eighth form
       listed  above).  This  will  cause  <u>condor_annex</u>  to  use  <u>condor_status</u>  to present annex instance data.
       Arguments and options on the command line after <b>status</b> will be passed unmodified  to  <u>condor_status</u>,  but
       not  all  arguments  and options will behave as expected. (See below.)  <u>condor_annex</u> will construct an ad
       for each annex instance and pass that  information  to  <u>condor_status</u>;  <u>condor_status</u>  will  (unless  you
       specify  otherwise  using its command line) query the collector for more information about the instances.
       Information from the collector will be presented as usual; instances  which  did  not  have  ads  in  the
       collector  will  be presented last, in their own table. These instances can not be presented in the usual
       way because the annex instance ads generated  by  <u>condor_annex</u>  do  not  (and  can  not)  have  the  same
       information  in  them  as ads generated by a <u>condor_startd</u> running in the instance. See the <u>condor_status</u>
       manual page for details about the "merge" mode of <u>condor_status</u> used by this command argument. Note  that
       both <u>condor_annex</u> and <u>condor_status</u> have <b>-annex-name</b> options; if you're interested in a particular annex,
       put this flag on the command line before the <b>status</b> command argument to avoid confusing results.

       Common  options  are  listed  first, followed by options specific to AWS, followed by options specific to
       AWS' on-demand instances, followed by options specific  to  AWS'  spot  instances,  followed  by  options
       intended for use by experts.

</pre><h4><b>OPTIONS</b></h4><pre>
          <b>-help</b>  Print a usage reminder.

          <b>-setup</b> <u>[/full/path/to/access/key/file/full/path/to/secret/key/file]</u>
                 Do the first-time setup.

          <b>-duration</b> <u>hours</u>
                 Set  the maximum lease duration in decimal <u>hours</u>. After this amount of time, all instances will
                 terminated, regardless of their idleness. Defaults to 50 minutes.

          <b>-idle</b> <u>hours</u>
                 Set the maximum idle duration in decimal <u>hours</u>. An instance idle for longer than this  duration
                 will terminate itself. Defaults to 15 minutes.

          <b>-yes</b>   Start the annex automatically without a yes/no confirmation prompt.

          <b>-tag</b> <u>name</u> <u>value</u>
                 Add  a  tag named <u>name</u> with value <u>value</u> to each instance in the requested annex.  Only works at
                 annex creation.  This option may be specified more than once.

          <b>-config-dir</b> <u>/full/path/to/directory</u>
                 Copy the contents of <u>/full/path/to/directory</u> to each instance's configuration directory.

          <b>-owner</b> <u>owner[,</u> <u>owner]*</u>
                 Configure the annex so that only <u>owner</u> may start jobs there. By default, configure the annex so
                 that only the user running <u>condor_annex</u> may start jobs there.

          <b>-no-owner</b>
                 Configure the annex so that anyone in the pool may use the annex.

          <b>-aws-region</b> <u>region</u>
                 Specify the region in which to create the annex.

          <b>-aws-user-data</b> <u>user-data</u>
                 Set the instance user data to <u>user-data</u>.

          <b>-aws-user-data-file</b> <u>/full/path/to/file</u>
                 Set the instance user data to the contents of the file <u>/full/path/to/file</u>.

          <b>-aws-default-user-data</b> <u>user-data</u>
                 Set the instance user data to <u>user-data</u>, if it's not already set.  Only applies to  spot  fleet
                 requests.

          <b>-aws-default-user-data-file</b> <u>/full/path/to/file</u>
                 Set  the instance user data to the contents of the file <u>/full/path/to/file</u>, if it's not already
                 set. Only applies to spot fleet requests.

          <b>-aws-on-demand-instance-type</b> <u>instance-type</u>
                 This annex will requests instances of type <u>instance-type</u>. The default for v8.7.1 is 'm4.large'.

          <b>-aws-on-demand-ami-id</b> <u>ami-id</u>
                 This annex will start instances of the AMI <u>ami-id</u>. The default for v8.7.1 is 'ami-35b13223',  a
                 GPU-compatible Amazon Linux image with HTCondor pre-installed.

          <b>-aws-on-demand-security-group-ids</b> <u>group-id[,group-id]</u>
                 This  annex  will  start  instances  with  the  listed  security group IDs.  The default is the
                 security group created by <b>-setup</b>.

          <b>-aws-on-demand-key-name</b> <u>key-name</u>
                 This annex will start instances with the key pair named <u>key-name</u>.  The default is the key  pair
                 created by <b>-setup</b>.

          <b>-aws-spot-fleet-config-file</b> <u>/full/path/to/file</u>
                 Use the JSON blob in <u>/full/path/to/file</u> for the spot fleet request.

          <b>-aws-access-key-file</b> <u>/full/path/to/access-key-file</u>
                 Experts only.

          <b>-aws-secret-key-file</b> <u>/full/path/to/secret-key-file</u>
                 Experts only.

          <b>-aws-ec2-url</b> <u>https://ec2.&lt;region&gt;.amazonaws.com</u>
                 Experts only.

          <b>-aws-events-url</b> <u>https://events.&lt;region&gt;.amazonaws.com</u>
                 Experts only.

          <b>-aws-lambda-url</b> <u>https://lambda.&lt;region&gt;.amazonaws.com</u>
                 Experts only.

          <b>-aws-s3-url</b> <u>https://s3.&lt;region&gt;.amazonaws.com</u>
                 Experts only.

          <b>-aws-spot-fleet-lease-function-arn</b> <u>sfr-lease-function-arn</u>
                 Developers only.

          <b>-aws-on-demand-lease-function-arn</b> <u>odi-lease-function-arn</u>
                 Developers only.

          <b>-aws-on-demand-instance-profile-arn</b> <u>instance-profile-arn</u>
                 Developers only.

</pre><h4><b>GENERAL</b> <b>REMARKS</b></h4><pre>
       Currently,  only  AWS  is  supported.  The  AMI configured by setup runs HTCondor v8.6.10 on Amazon Linux
       2016.09, and the default instance type is "m4.large". The default AMI has  the  appropriate  drivers  for
       AWS' GPU instance types.

</pre><h4><b>EXAMPLES</b></h4><pre>
       To  start an on-demand annex named 'MyFirstAnnex' with one core, using the default AMI and instance type,
       run

          $ condor_annex -count 1 -annex-name MyFirstAnnex

       You will be asked to confirm that the defaults are what you want.

       As of 2017-04-17, the following example will cost a minimum of $90.

       To start an on-demand annex with 100 GPUs that job owners 'big' and 'little' may use (be sure to  include
       yourself!), run

          $ condor_annex -count 100 -annex-name MySecondAnnex \
            -aws-on-demand-instance-type p2.xlarge -owner "big, little"

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <u>condor_annex</u> will exit with a status value of 0 (zero) on success.

</pre><h4><b>AUTHOR</b></h4><pre>
       HTCondor Team

</pre><h4><b>COPYRIGHT</b></h4><pre>
       1990-2024,  Center  for High Throughput Computing, Computer Sciences Department, University of Wisconsin-
       Madison, Madison, WI, US. Licensed under the Apache License, Version 2.0.

                                                  Jan 04, 2025                                   <u><a href="../man1/CONDOR_ANNEX.1.html">CONDOR_ANNEX</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>