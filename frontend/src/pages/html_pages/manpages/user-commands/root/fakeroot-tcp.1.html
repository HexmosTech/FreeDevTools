<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fakeroot - run a command in an environment faking root privileges for file manipulation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/fakeroot">fakeroot_1.37.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fakeroot - run a command in an environment faking root privileges for file manipulation

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>fakeroot</b>  [<b>-l</b>|<b>--lib</b>  <u>library</u>] [<b>--faked</b> <u>faked-binary</u>] [<b>-i</b> <u>load-file</u>] [<b>-s</b> <u>save-file</u>] [<b>-u</b>|<b>--unknown-is-real</b>]
       [<b>-b</b>|<b>--fd-base</b>] [<b>-h</b>|<b>--help</b>] [<b>-v</b>|<b>--version</b>] [<b>--</b>] [<u>command</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>fakeroot</b> runs a command  in  an  environment  wherein  it  appears  to  have  root  privileges  for  file
       manipulation.   This  is  useful for allowing users to create archives (tar, ar, .deb etc.) with files in
       them with root permissions/ownership.  Without <b>fakeroot</b> one would need to have root privileges to  create
       the  constituent files of the archives with the correct permissions and ownership, and then pack them up,
       or one would have to construct the archives directly, without using the archiver.

       <b>fakeroot</b> works by replacing the file manipulation library functions (<a href="../man2/chmod.2.html">chmod</a>(2), <a href="../man2/stat.2.html">stat</a>(2) etc.) by ones that
       simulate the effect the real library functions would have had, had  the  user  really  been  root.  These
       wrapper  functions  are  in  a  shared  library  <b><a href="file:/usr/lib/">/usr/lib/</a>*/libfakeroot-*.so</b>  or similar location on your
       platform.  The shared object is loaded through the <b>LD_PRELOAD</b>  mechanism  of  the  dynamic  loader.  (See
       <b><a href="../man8/ld.so.8.html">ld.so</a></b>(8))

       If  you  intend  to  build  packages  with  <b>fakeroot</b>, please try building the fakeroot package first: the
       "debian/rules build" stage has a few tests (testing mostly for bugs in old fakeroot versions).  If  those
       tests fail (for example because you have certain libc5 programs on your system), other packages you build
       with fakeroot will quite likely fail too, but possibly in much more subtle ways.

       Also,  note  that  it's best not to do the building of the binaries themselves under fakeroot. Especially
       configure and friends don't like it when the system suddenly behaves differently from  what  they  expect
       (or, they randomly unset some environment variables, some of which fakeroot needs).

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-l</b> <u>library</u>, <b>--lib</b> <u>library</u>
              Specify an alternative wrapper library.

       <b>--faked</b> <u>binary</u>
              Specify an alternative binary to use as faked.

       <b>[--]</b> <u>command</u>
              Any command you want to be run as fakeroot. Use ‘--’ if in the command you have other options that
              may confuse fakeroot's option parsing.

       <b>-s</b> <u>save-file</u>
              Save  the  fakeroot  environment  to  save-file  on  exit.  This  file  can be used to restore the
              environment later using -i. However, this file will leak and fakeroot  will  behave  in  odd  ways
              unless  you leave the files touched inside the fakeroot alone when outside the environment. Still,
              this can be useful. For example, it can be used  with  <a href="../man1/rsync.1.html">rsync</a>(1)  to  back  up  and  restore  whole
              directory  trees  complete with user, group and device information without needing to be root. See
              <u>/usr/share/doc/fakeroot/README.saving</u> for more details.

       <b>-i</b> <u>load-file</u>
              Load a fakeroot environment previously saved using -s from load-file.  Note  that  this  does  not
              implicitly  save  the file, use -s as well for that behaviour. Using the same file for both -i and
              -s in a single <b>fakeroot</b> invocation is safe.

       <b>-u</b>, <b>--unknown-is-real</b>
              Use the real ownership of files previously unknown to fakeroot  instead  of  pretending  they  are
              owned by root:root.

       <b>-b</b> <u>fd</u>  Specify  fd  base  (TCP  mode  only).  fd  is  the  minimum  file descriptor number to use for TCP
              connections; this may be important to avoid conflicts  with  the  file  descriptors  used  by  the
              programs being run under fakeroot.

       <b>-h</b>     Display help.

       <b>-v</b>     Display version.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Here is an example session with <b>fakeroot</b>.  Notice that inside the fake root environment file manipulation
       that requires root privileges succeeds, but is not really happening.

       $  whoami
       joost
       $ fakeroot <a href="file:/bin/bash">/bin/bash</a>
       #  whoami
       root
       # mknod hda3 b 3 1
       # ls -ld hda3
       brw-r--r--   1 root     root       3,   1 Jul  2 22:58 hda3
       # chown joost:root hda3
       # ls -ld hda3
       brw-r--r--   1 joost    root       3,   1 Jul  2 22:58 hda3
       # ls -ld /
       drwxr-xr-x  20 root     root         1024 Jun 17 21:50 /
       # chown joost:users /
       # chmod a+w /
       # ls -ld /
       drwxrwxrwx  20 joost    users        1024 Jun 17 21:50 /
       # exit
       $ ls -ld /
       drwxr-xr-x  20 root     root         1024 Jun 17 21:50 //
       $ ls -ld hda3
       -rw-r--r--   1 joost    users           0 Jul  2 22:58 hda3

       Only the effects that user <b>joost</b> could do anyway happen for real.

       <b>fakeroot</b>  was  specifically  written  to  enable users to create Debian GNU/Linux packages (in the <b><a href="../man5/deb.5.html">deb</a></b>(5)
       format) without giving them root privileges.   This  can  be  done  by  commands  like  <b>dpkg-buildpackage</b>
       <b>-rfakeroot</b>  or <b>debuild</b> <b>-rfakeroot</b> (actually, -rfakeroot is default in debuild nowadays, so you don't need
       that argument).

</pre><h4><b>SECURITY</b> <b>ASPECTS</b></h4><pre>
       <b>fakeroot</b> is a regular, non-setuid program. It does not enhance  a  user's  privileges,  or  decrease  the
       system's security.

</pre><h4><b>FILES</b></h4><pre>
       <u><a href="file:/usr/lib/">/usr/lib/</a>*/libfakeroot-*.so</u> The shared library containing the wrapper functions.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       FAKEROOTKEY
              The  key  used  to  communicate  with  the  fakeroot  daemon.  Any  program started with the right
              <b>LD_PRELOAD</b> and a <b>FAKEROOTKEY</b> of a running daemon will automatically connect to  that  daemon,  and
              have  the  same  "fake"  view of the file system's permissions/ownerships (assuming the daemon and
              connecting program were started by the same user).

       LD_LIBRARY_PATH

       LD_PRELOAD
              fakeroot  is  implemented  by  wrapping  system  calls.    This   is   accomplished   by   setting
              LD_LIBRARY_PATH=/usr/lib/fakeroot  and LD_PRELOAD=libfakeroot.so.0.  That library is loaded before
              the system's C library, and so most of the library functions are intercepted by it.  If  you  need
              to  set  either <b>LD_LIBRARY_PATH</b> or <b>LD_PRELOAD</b> from within a fakeroot environment, it should be set
              relative to the given paths, as in <b>LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/foo/bar/</b>

</pre><h4><b>LIMITATIONS</b></h4><pre>
       Library versions
              Every command executed within <b>fakeroot</b> needs to be linked to the same version of the C library  as
              <b>fakeroot</b> itself.

       open()/create()
              fakeroot doesn't wrap open(), create(), etc. So, if user <b>joost</b> does either

              touch foo
              fakeroot
              ls -al foo

              or the other way around,

              fakeroot
              touch foo
              ls -al foo

              fakeroot  has  no  way  of knowing that in the first case, the owner of foo really should be <b>joost</b>
              while the second case it should have been <b>root</b>.  For the Debian packaging,  defaulting  to  giving
              all  "unknown"  files  uid=gid=0,  is  always  OK.  The real way around this is to wrap <b>open()</b> and
              <b>create()</b>, but that creates other problems, as demonstrated by the libtricks package. This  package
              wrapped  many  more  functions,  and  tried to do a lot more than <b>fakeroot</b> <b>.</b>  It turned out that a
              minor upgrade of libc (from one where the <b>stat</b>() function didn't use <b>open</b>() to one with  a  <b>stat</b>()
              function  that did (in some cases) use <b>open</b>() ), would cause unexplainable segfaults (that is, the
              libc6 <b>stat</b>() called the wrapped <b>open</b>() , which would then call the libc6 <b>stat</b>()  ,  etc).   Fixing
              them  wasn't  all  that easy, but once fixed, it was just a matter of time before another function
              started to use open(), never mind trying to port it  to  a  different  operating  system.  Thus  I
              decided  to  keep  the  number of functions wrapped by fakeroot as small as possible, to limit the
              likelihood of ‘collisions’.

       GNU configure (and other such programs)
              fakeroot, in effect, is changing the way the system behaves. Programs that probe the  system  like
              GNU  configure  may  get confused by this (or if they don't, they may stress fakeroot so much that
              fakeroot itself becomes confused). So, it's advisable not to run "configure" from within fakeroot.
              As configure should be called in  the  "debian/rules  build"  target,  running  "dpkg-buildpackage
              -rfakeroot" correctly takes care of this.

</pre><h4><b>BUGS</b></h4><pre>
       It  doesn't  wrap  open().  This  isn't bad by itself, but if a program does open("file", O_WRONLY, 000),
       writes to file "file", closes it, and then again tries to open to read the file, then that open fails, as
       the mode of the file will be 000. The bug is that if root does the same, open() will succeed, as the file
       permissions aren't checked at all for root. I choose not to wrap open(), as open() is used by many  other
       functions  in  libc (also those that are already wrapped), thus creating loops (or possible future loops,
       when the implementation of various libc functions slightly change).

</pre><h4><b>COPYING</b></h4><pre>
       <b>fakeroot</b> is distributed under the GNU General Public License.  (GPL 2.0 or greater).

</pre><h4><b>AUTHORS</b></h4><pre>
       joost witteveen
              &lt;<u><a href="mailto:joostje@debian.org">joostje@debian.org</a></u>&gt;

       Clint Adams
              &lt;<u><a href="mailto:clint@debian.org">clint@debian.org</a></u>&gt;

       Timo Savola

</pre><h4><b>MANUAL</b> <b>PAGE</b></h4><pre>
       mostly by J.H.M. Dassen <b>&lt;</b><u><a href="mailto:jdassen@debian.org">jdassen@debian.org</a></u><b>&gt;</b> with rather a lot of modsifications and additions  by  joost
       and Clint.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/debuild.1.html">debuild</a></b>(1), <b><a href="../man1/dpkg-buildpackage.1.html">dpkg-buildpackage</a></b>(1), <b><a href="../man1/faked.1.html">faked</a></b>(1), <b>/usr/share/doc/fakeroot/DEBUG</b>

Debian Project                                     2024-12-19                                        <u><a href="../man1/fakeroot.1.html">fakeroot</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>