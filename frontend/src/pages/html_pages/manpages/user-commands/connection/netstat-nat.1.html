<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>netstat-nat — extract and filter NAT/firewall connection data</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/netstat-nat">netstat-nat_2a-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       netstat-nat — extract and filter NAT/firewall connection data

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>netstat-nat</b>   [<b>-no</b>]  [<b>-x</b>|<b>-X</b>[<u>width</u>]]  {[<b>-G</b>]  [<b>-S</b>|<b>-D</b>]}|[<b>-L</b>|<b>-R</b>]  [<b>-s</b> <u>ource</u>]…  [<b>-d</b> <u>estination</u>]…  [<b>-g</b> <u>ateway</u>]…
                   [<b>-p</b> <u>rotocol</u>]… [<b>-r</b> {<b>src</b>,<b>dst</b>,<b>gate</b>}{,<b>-port</b>}|<b>state</b>] [<u>nf_conntrack</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       All network-enabled hosts track ongoing network connections, but this  is  especially  true  of  stateful
       firewalls  and  gateways  (routers)  which  perform  network  address  translation.   Under  Linux,  this
       information is accounted by the netfilter framework,  tracking  connectionless  protocols  (like  <u><a href="../man7/udp.7.html">udp</a></u>(7),
       <u><a href="../man7/icmp.7.html">icmp</a></u>(7)) in addition to the connection-based ones (like <u><a href="../man7/tcp.7.html">tcp</a></u>(7)).

       <b>netstat-nat</b> parses <u>nf_conntrack</u> (<u>/proc/net/nf_conntrack</u> by default, or the standard input stream if "<b>-</b>"),
       filters  it  so  it  only has NAT connections (by default, cf. <b>-LR</b>), looks up the canonical names for the
       hosts and ports (unless <b>-n</b>), and presents it in a table:
           Proto NATed Address                  Destination Address            State
           icmp  10.179.163.88                  tarta.nabijaczleweli.xyz
           icmp  10.200.233.12                  tarta.nabijaczleweli.xyz
           tcp   10.32.144.39.host.securi:63770 tarta.nabijaczleweli.xyz:https TIME_WAIT
           tcp   10.32.144.39.host.securi:64361 tarta.nabijaczleweli.xyz:http  TIME_WAIT
           tcp   10.72.217.111:33864            tarta.nabijaczleweli.xyz:5900  TIME_WAIT
           tcp   10.72.217.111:39074            tarta.nabijaczleweli.xyz:5900  TIME_WAIT
           tcp   nabijaczleweli.nabijaczl:20985 lb-10-268-216-78-iad.git:https ESTABLISHED
           tcp   nabijaczleweli.nabijaczl:21047 waw07s05-in-f4.1e100.net:http  TIME_WAIT
           tcp   nabijaczleweli.nabijaczl:20751 waw07s05-in-f14.1e100.ne:https ESTABLISHED
           tcp   nabijaczleweli.nabijaczl:17906 101010.pl:https                ESTABLISHED
           tcp   192.168.1.136:38216            lt-in-f188.1e100.net:5228      ESTABLISHED
           tcp   192.168.1.136:38330            lt-in-f188.1e100.net:5228      ESTABLISHED
           tcp   192.168.1.136:39972            lt-in-f188.1e100.net:5228      ESTABLISHED
           tcp   192.168.1.136:40092            lt-in-f188.1e100.net:5228      ESTABLISHED
           udp   rozbian.nabijaczleweli.x:46115 10.158.103.58:https            ASSURED
           udp   rozbian.nabijaczleweli.x:42560 10.69.17.108:https             ASSURED
           udp   rozbian.nabijaczleweli.x:44786 10.140.3.34:https              ASSURED
           udp   rozbian.nabijaczleweli.x:47079 10.140.3.34:https              UNREPLIED
           udp   192.168.1.185:3076             ec2-10-213-30-29.eu-cent:https ASSURED
           udp   tarta.nabijaczleweli.xyz:39517 ns-153.awsdns-19.com:domain
           udp   tarta.nabijaczleweli.xyz:16829 ns-1007.awsdns-61.net:domain
           udp   tarta.nabijaczleweli.xyz:46874 ns-1411.awsdns-48.org:domain
       herein we can see: two ongoing incoming ICMP queries (no state available); many remote hosts are  calling
       <u>tarta</u>  (and it is the one to hang up); local hosts <u>nabijaczleweli</u> and <u>192.168.1.136</u> are generally calling
       google; that the HTTP/3 revolution is real; and that <u>tarta</u> is querying  some  DNS  servers  (they  didn't
       reply yet).

       The state column can be any of
       <b>ESTABLISHED</b>  a functional ongoing connection
       <b>ASSURED</b>      similar, but for connectionless protocols
       (blank)      either  no  connection state is tracked (like in ICMP), or waiting for remote reply (like in
                    UDP)
       <b>UNREPLIED</b>    remote didn't reply for longer than the expected time-out

       <b>TIME_WAIT</b>    the local side of the connection was closed, delayed  remote  packets  are  being  collected
                    before recycling
       <b>FIN_WAIT</b>     the  remote  side  of  the  connection  was closed, waiting for acknowledgement (→FIN, ACK→,
                    waiting for →FIN)
       <b>SYN_RECV</b>     a remote client started opening a connection, but  didn't  acknowledge  the  local  response
                    (→SYN, SYN,ACK→, waiting for →ACK)
       <b>SYN_SENT</b>     a  local client started opening a connection, but remote didn't yet accept it (SYN→, waiting
                    for →SYN,ACK)
       <b>CLOSE</b>        <b>TIME_WAIT</b> because connection was closed forcibly (→RST)
       the last 5 only really apply to TCP-like protocols.

       With <b>-L</b> or (R) on <u>tarta</u> the table looks very similar (<b>-nX</b><u>21</u> added as well), but loopback connections also
       appear:
           Proto Source Address        Destination Address   State
           tcp   [::1]:49118           [::1]:9928            TIME_WAIT
           tcp   [::1]:50624           [::1]:80              ESTABLISHED
           tcp   10.221.132.191:35862  192.168.1.250:5900    TIME_WAIT
           tcp   127.0.0.1:34030       127.0.0.1:8213        TIME_WAIT
           tcp   127.0.0.1:52476       127.0.1.1:3493        ESTABLISHED
           tcp   10.176.163.40:51167   192.168.1.250:443     TIME_WAIT
           tcp   10.62.134.22:23178    192.168.1.250:80      SYN_RECV
           tcp   10.62.134.22:47444    192.168.1.250:80      SYN_RECV
           udp   127.0.0.1:42738       127.0.0.1:323
           udp   127.0.0.1:44850       127.0.0.1:5353
           udp   127.0.0.1:46444       127.0.0.1:53          ASSURED
           udp   192.168.1.144:20407   192.168.1.250:53
           udp   192.168.1.146:59266   192.168.1.250:53
           udp   192.168.1.204:35989   192.168.1.250:53
           udp   192.168.1.250:23225   10.46.8.231:53
           udp   192.168.1.250:11300   10.11.28.69:53
           udp   192.168.1.250:51413   10.116.123.52:6881    ASSURED
       (Public addresses were anonymised as 10/8 in both tables; both tables heavily abridged.)

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-n</b>                Don't try to resolve IP addresses to  hostnames  nor  port  numbers  to  service  names
                         (<u><a href="../man5/hosts.5.html">hosts</a></u>(5), <u><a href="../man5/services.5.html">services</a></u>(5)) — just normalise them.
       <b>-o</b>                Don't output the table header line.
       <b>-x</b>                Widen the table: addresses are <b>40</b> instead of <b>30</b> columns wide.
       <b>-X</b>                Widen   the  table:  address  columns  are  the  width  of  a  fully-specified  <u><a href="../man7/ipv6.7.html">ipv6</a></u>(7)
                         address + port (like <b>[fc00:e355:e73f:b463:a28e:529d:7838:65be]:34012</b>).
       <b>-X</b><u>width</u>           Widen the table: address columns use the given <u>width</u>.

       <b>-G</b> (also <b>-N</b>)      Add a <u>Gateway</u> <u>Address</u> column between the source and destination columns — this  is  the
                         outside-facing address of the node performing NAT.

       <b>-S</b>                Only show connections this node facilitates <u>from</u> its local network <u>to</u> the outside world
                         (SNAT — source NAT).  Overrides <b>-D</b>.
       <b>-D</b>                Only show connections this node facilitates <u>to</u> its local network <u>from</u> the outside world
                         (DNAT — destination NAT).  Overrides <b>-S</b>.
       By default, the table is filtered as-if <b>-S</b> and <b>-D</b> were used additively instead of subtractively.
       <b>-L</b>                Only  show  direct connections made by this node (and any of its configured addresses).
                         This still includes hosts outside the local network.  Disables <b>-SDG</b>.  Overrides <b>-R</b>.
       <b>-R</b>                Only show non-NAT connections that don't involve this node('s addresses) at  all  (This
                         is  most  likely  because  their destinations are broadcast addresses.)  Disables <b>-SDG</b>.
                         Overrides <b>-L</b>.

       <b>-s</b> <u>source</u><b>,</b>…       Hide connections that don't originate from <u>source</u>s (parsed as an address or  looked  up
                         in DNS (<u><a href="../man3/getaddrinfo.3.html">getaddrinfo</a></u>(3)); comma- or whitespace-separated, or specify multiple times).
       <b>-d</b> <u>destination</u><b>,</b>…  Hide connections that aren't targeting <u>destination</u>s (likewise).
       <b>-g</b> <u>gateway</u><b>,</b>…      Hide connections that aren't going through <u>gateway</u>s (likewise).
       <b>-p</b> <u>protocol</u><b>,</b>…     Hide connections that aren't formed by these layer 4 protocols (like UDP, TCP, or ICMP)
                         (case-insensitive; likewise).

       <b>-r</b> {<b>src</b>,<b>dst</b>,<b>gate</b>}{,<b>-port</b>}|<b>state</b>
                         Sort the output by the given column (after partitioning by L4 protocol):
                             <b>src</b>        source address (this is the default)
                             <b>dst</b>        destination address
                             <b>src-port</b>   source port
                             <b>dst-port</b>   destination port
                             <b>state</b>      connection state
                             <b>gate</b>       gateway address
                             <b>gate-port</b>  gateway port
                         ties  are  then  broken  in  this  order.  Everything is sorted lexicographically (as a
                         string), before address/port→name lookup (unless disabled by <b>-n</b>).

</pre><h4><b>FILES</b></h4><pre>
       <u>/proc/net/nf_conntrack</u>: Contains the current netfilter connections.  This is  usually  only  readable  by
       root.

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       NETSTAT_NAT_LOCAL_ADDRS:  If  set,  contains  a  comma-  or  whitespace-separated list of addresses to be
       considered local.  This supersedes any real sysem state (for use with <u>nf_conntrack</u> backups).

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <b>1</b> if <u>nf_conntrack</u> couldn't be opened or a <u>source</u>, <u>destination</u>, or <u>gateway</u> didn't exist.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/conntrack.8.html">conntrack</a></u>(8) provides a read-write interface to this table.

       <u><a href="../man3/getaddrinfo.3.html">getaddrinfo</a></u>(3), <u><a href="../man3/getifaddrs.3.html">getifaddrs</a></u>(3), <u><a href="../man3/getnameinfo.3.html">getnameinfo</a></u>(3), <u><a href="../man5/hosts.5.html">hosts</a></u>(5), <u><a href="../man5/services.5.html">services</a></u>(5)

netstat-nat-ng 2a-1                            September 18, 2024                                 <u><a href="../man1/NETSTAT-NAT.1.html">NETSTAT-NAT</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>