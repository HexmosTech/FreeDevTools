<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>wallet-rekey - Client for rekeying a Kerberos keytab using wallet</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/krb5-wallet-client">krb5-wallet-client_1.7_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       wallet-rekey - Client for rekeying a Kerberos keytab using wallet

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>wallet-rekey</b> [<b>-hv</b>] [<b>-c</b> <u>command</u>] [<b>-k</b> <u>principal</u>]
           [<b>-p</b> <u>port</u>] [<b>-s</b> <u>server</u>] [<b>-u</b> <u>principal</u>] [<u>keytab</u> ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>wallet-rekey</b> is a specialized client for the wallet system used to rekey a Kerberos keytab by downloading
       new keytab objects from wallet for each principal found in the keytab.  For each keytab file listed on
       the command line, it walks through the principals in that keytab, finds all from the local default realm,
       requests new wallet keytab objects for each principal (removing the realm when naming the keytab), and
       merges the new keys into the keytab.

       If an error occurs, <b>wallet-rekey</b> continues to rekey all principals that it can, producing error messages
       for those that it cannot rekey.

       If no keytab file name is given on the command line, <b>wallet-rekey</b> attempts to rekey <u>/etc/krb5.keytab</u>, the
       system default keytab file.

       The new keys are merged into the existing keytab file, but old keys are not removed.  This means that,
       over time, the keytab will grow and accumulate old keys, which eventually should no longer be honored.
       Administrators may want to run:

           kadmin -q 'ktremove -k &lt;keytab&gt; &lt;principal&gt; old'

       for MIT Kerberos, where &lt;keytab&gt; is the path to the keytab and &lt;principal&gt; is a principal in the keytab
       (repeating the command for each principal) or:

           ktutil -k &lt;keytab&gt; purge

       for Heimdal.  The Heimdal command can be run by any user with access to the keytab, but the MIT Kerberos
       command unfortunately has to be run by a someone with direct <b>kadmin</b> access.  This functionality will
       eventually be provided by <b>wallet-rekey</b> directly.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-c</b> <u>command</u>
           The  command prefix (remctl type) to use.  Normally this is an internal implementation detail and the
           default ("wallet") should be fine.  It may sometimes be useful to use a different prefix for  testing
           a  different version of the wallet code on the server.  This option can also be set in <u>krb5.conf</u>; see
           CONFIGURATION below.

       <b>-k</b> <u>principal</u>
           The service principal of the wallet server.  The default is to  use  the  "host"  principal  for  the
           wallet  server.  The principal chosen must match one of the keys in the keytab used by <b>remctld</b> on the
           wallet server.  This option can also be set in <u>krb5.conf</u>; see CONFIGURATION below.

       <b>-h</b>  Display a brief summary of options and exit.  All other valid options and commands are ignored.

       <b>-p</b> <u>port</u>
           The port to connect to on the wallet server.  The default is the default remctl  port.   This  option
           can also be set in <u>krb5.conf</u>; see CONFIGURATION below.

       <b>-s</b> <u>server</u>
           The  wallet  server  to  connect to.  The default may be set when compiling the wallet client.  If it
           isn't, either <b>-s</b> must be given or the server must be set in <u>krb5.conf</u>.  See CONFIGURATION below.

       <b>-u</b> <u>principal</u>
           Rather than using the user's existing ticket cache  for  authentication,  authenticate  as  <u>principal</u>
           first  and use those credentials for authentication to the wallet server.  <b>wallet</b> will prompt for the
           password for <u>principal</u>.  Non-password authentication methods such as PKINIT aren't supported; to  use
           those, run <b>kinit</b> first and use an existing ticket cache.

       <b>-v</b>  Display the version of the <b>wallet</b> client and exit.  All other valid options and commands are ignored.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       The wallet system, including <b>wallet-rekey</b>, can optionally be configured in the system <u>krb5.conf</u>.  It will
       read the default <u>krb5.conf</u> file for the Kerberos libraries with which it was compiled.  To set an option,
       put  the option in the [appdefaults] section.  <b>wallet-rekey</b> will look for options either at the top level
       of the [appdefaults] section or in a subsection named "wallet".  For example, the following fragment of a
       <u>krb5.conf</u> file would set the default port to 4373 and the default server to "wallet.example.org".

           [appdefaults]
               wallet_port = 4373
               wallet = {
                   wallet_server = wallet.example.org
               }

       The supported options are:

       wallet_principal
           The service principal of the wallet server.  The default is to  use  the  "host"  principal  for  the
           wallet  server.  The principal chosen must match one of the keys in the keytab used by <b>remctld</b> on the
           wallet server.  The <b>-k</b> command-line option overrides this setting.

       wallet_port
           The port to connect to on the wallet server.  The  default  is  the  default  remctl  port.   The  <b>-p</b>
           command-line option overrides this setting.

       wallet_server
           The wallet server to connect to.  The <b>-s</b> command-line option overrides this setting.  The default may
           be set when compiling the wallet client.  If it isn't, either <b>-s</b> must be given or this parameter must
           be present in in <u>krb5.conf</u>.

       wallet_type
           The  command prefix (remctl type) to use.  Normally this is an internal implementation detail and the
           default ("wallet") should be fine.  It may sometimes be useful to use a different prefix for  testing
           a  different  version  of  the  wallet code on the server.  The <b>-c</b> command-line option overrides this
           setting.

</pre><h4><b>AUTHOR</b></h4><pre>
       Russ Allbery &lt;<a href="mailto:eagle@eyrie.org">eagle@eyrie.org</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       Copyright 2010, 2013 The Board of Trustees of the Leland Stanford Junior University

       Copying and distribution of this file, with or without modification, are permitted in any medium  without
       royalty provided the copyright notice and this notice are preserved.  This file is offered as-is, without
       any warranty.

       SPDX-License-Identifier: FSFAP

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/kadmin.8.html">kadmin</a></b>(8), <b><a href="../man1/kinit.1.html">kinit</a></b>(1), <b><a href="../man5/krb5.conf.5.html">krb5.conf</a></b>(5), <b><a href="../man1/remctl.1.html">remctl</a></b>(1), <b><a href="../man8/remctld.8.html">remctld</a></b>(8), <b><a href="../man1/wallet.1.html">wallet</a></b>(1)

       This   program   is   part   of   the   wallet   system.    The   current   version   is  available  from
       &lt;https://www.eyrie.org/~eagle/software/wallet/&gt;.

       <b>wallet-rekey</b>   uses   the   remctl    protocol.     For    more    information    about    remctl,    see
       &lt;https://www.eyrie.org/~eagle/software/remctl/&gt;.

1.5                                                2024-04-30                                    <u><a href="../man1/WALLET-REKEY.1.html">WALLET-REKEY</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>