<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>smtp-sink - parallelized SMTP/LMTP test server</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/postfix">postfix_3.9.1-10ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       smtp-sink - parallelized SMTP/LMTP test server

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>smtp-sink</b> [<u>options</u>] [<b>inet:</b>][<u>host</u>]:<u>port</u> <u>backlog</u>

       <b>smtp-sink</b> [<u>options</u>] <b>unix:</b><u>pathname</u> <u>backlog</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>smtp-sink</b>  listens  on the named host (or address) and port.  It takes SMTP messages from the network and
       throws them away.  The purpose is to measure client performance, not protocol compliance.

       <b>smtp-sink</b> may also be configured to capture each mail delivery transaction to file. Since disk  latencies
       are  large  compared  to  network  delays,  this  mode of operation can reduce the maximal performance by
       several orders of magnitude.

       Connections can be accepted on IPv4 or IPv6 endpoints, or on UNIX-domain sockets.  IPv4 and IPv6 are  the
       default.  This program is the complement of the <b><a href="../man1/smtp-source.1.html">smtp-source</a></b>(1) program.

       Note:  this  is  an  unsupported  test  program.  No  attempt  is  made to maintain compatibility between
       successive versions.

       Arguments:

       <b>-4</b>     Support IPv4 only. This option has no effect when Postfix is built without IPv6 support.

       <b>-6</b>     Support IPv6 only. This option is not available when Postfix is built without IPv6 support.

       <b>-8</b>     Do not announce 8BITMIME support.

       <b>-a</b>     Do not announce SASL authentication support.

       <b>-A</b> <u>delay</u>
              Wait <u>delay</u> seconds after responding to DATA, then abort prematurely with a 550 reply  status.   Do
              not  read  further  input  from the client; this is an attempt to block the client before it sends
              ".".  Specify a zero delay value to abort immediately.

       <b>-b</b> <u>soft-bounce-reply</u>
              Use <u>soft-bounce-reply</u> for soft reject responses.  The default reply is "450 4.3.0  Error:  command
              failed".

       <b>-B</b> <u>hard-bounce-reply</u>
              Use  <u>hard-bounce-reply</u>  for hard reject responses.  The default reply is "500 5.3.0 Error: command
              failed".

       <b>-c</b>     Display running counters that are updated whenever  an  SMTP  session  ends,  a  QUIT  command  is
              executed, or when "." is received.

       <b>-C</b>     Disable XCLIENT support.

       <b>-d</b> <u>dump-template</u>
              Dump  each  mail  transaction  to  a  single-message  file  whose name is created by expanding the
              <u>dump-template</u>  via  <a href="../man3/strftime.3.html">strftime</a>(3)  and  appending  a  pseudo-random  hexadecimal  number   (example:
              "%Y%m%d%H/%M."  expands  into "2006081203/05.809a62e3").  If the template contains "/" characters,
              missing directories are created automatically.  The message dump format is described below.

              Note: this option keeps one capture file open for every mail transaction in progress.

       <b>-D</b> <u>dump-template</u>
              Append mail transactions to a multi-message dump file whose  name  is  created  by  expanding  the
              <u>dump-template</u>  via  <a href="../man3/strftime.3.html">strftime</a>(3).  If the template contains "/" characters, missing directories are
              created automatically.  The message dump format is described below.

              Note: this option keeps one capture file open for every mail transaction in progress.

       <b>-e</b>     Do not announce ESMTP support.

       <b>-E</b>     Do not announce ENHANCEDSTATUSCODES support.

       <b>-f</b> <u>command,command,...</u>
              Reject the specified commands with a hard (5xx) error code.  This option implies <b>-p</b>.

              Examples of commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA,  .,  RSET,  NOOP,  and
              QUIT.  Separate command names by white space or commas, and use quotes to protect white space from
              the shell. Command names are case-insensitive.

       <b>-F</b>     Disable XFORWARD support.

       <b>-h</b> <u>hostname</u>
              Use <u>hostname</u> in the SMTP greeting, in the HELO response, and in the  EHLO  response.  The  default
              hostname is "smtp-sink".

       <b>-H</b> <u>delay</u>
              Delay  the  first read operation after receiving DATA (time in seconds). Combine with a large test
              message and a small TCP window size (see the <b>-T</b> option) to test the  Postfix  client  write_wait()
              implementation.

       <b>-L</b>     Enable LMTP instead of SMTP.

       <b>-m</b> <u>count</u> (default: 256)
              An  upper bound on the maximal number of simultaneous connections that <b>smtp-sink</b> will handle. This
              prevents the process from running out of file descriptors. Excess connections will stay queued  in
              the TCP/IP stack.

       <b>-M</b> <u>count</u>
              Terminate after receiving <u>count</u> messages.

       <b>-n</b> <u>count</u>
              Terminate after <u>count</u> sessions.

       <b>-N</b>     Do not announce support for DSN.

       <b>-p</b>     Do not announce support for ESMTP command pipelining.

       <b>-P</b>     Change the server greeting so that it appears to come through a CISCO PIX system. Implies <b>-e</b>.

       <b>-q</b> <u>command,command,...</u>
              Disconnect (without replying) after receiving one of the specified commands.

              Examples  of  commands  are  CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA, ., RSET, NOOP, and
              QUIT. Separate command names by white space or commas, and use quotes to protect white space  from
              the shell. Command names are case-insensitive.

       <b>-Q</b> <u>command,command,...</u>
              Send a 421 reply and disconnect after receiving one of the specified commands.

              Examples  of  commands  are  CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA, ., RSET, NOOP, and
              QUIT. Separate command names by white space or commas, and use quotes to protect white space  from
              the shell. Command names are case-insensitive.

       <b>-r</b> <u>command,command,...</u>
              Reject the specified commands with a soft (4xx) error code.  This option implies <b>-p</b>.

              Examples  of  commands  are  CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA, ., RSET, NOOP, and
              QUIT. Separate command names by white space or commas, and use quotes to protect white space  from
              the shell. Command names are case-insensitive.

       <b>-R</b> <u>root-directory</u>
              Change  the  process  root  directory  to the specified location.  This option requires super-user
              privileges. See also the <b>-u</b> option.

       <b>-s</b> <u>command,command,...</u>
              Log the named commands to syslogd.

              Examples of commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA,  .,  RSET,  NOOP,  and
              QUIT.  Separate command names by white space or commas, and use quotes to protect white space from
              the shell. Command names are case-insensitive.

       <b>-S</b> <b>start-string</b>
              An optional string that is prepended to each message that is written to a dump file (see the  dump
              file  format  description  below).  The  following C escape sequences are supported: \a (bell), \b
              (backspace), \f (formfeed), \n (newline), \r (carriage return), \t (horizontal tab), \v  (vertical
              tab), \<u>ddd</u> (up to three octal digits) and \\ (the backslash character).

       <b>-t</b> <u>timeout</u> (default: 100)
              Limit  the  time  for  receiving  a command or sending a response.  The time limit is specified in
              seconds.

       <b>-T</b> <u>windowsize</u>
              Override the default TCP window size. To work around broken TCP  window  scaling  implementations,
              specify a value &gt; 0 and &lt; 65536.

       <b>-u</b> <u>username</u>
              Switch  to  the specified user privileges after opening the network socket and optionally changing
              the process root directory. This  option  is  required  when  the  process  runs  with  super-user
              privileges. See also the <b>-R</b> option.

       <b>-v</b>     Show the SMTP conversations.

       <b>-w</b> <u>delay</u>
              Wait <u>delay</u> seconds before responding to a DATA command.

       <b>-W</b> <u>command:delay[:odds]</u>
              Wait <u>delay</u> seconds before responding to <u>command</u>.  If <u>odds</u> is also specified (a number between 1-99
              inclusive),  wait  for a random multiple of <u>delay</u>. The random multiplier is equal to the number of
              times the program needs to roll a dice with a range of 0..99 inclusive, before the dice produces a
              result greater than or equal to <u>odds</u>.

       [<b>inet:</b>][<u>host</u>]:<u>port</u>
              Listen on network interface <u>host</u> (default: any interface) TCP port <u>port</u>. Both <u>host</u> and <u>port</u> may be
              specified in numeric or symbolic form.

       <b>unix:</b><u>pathname</u>
              Listen on the UNIX-domain socket at <u>pathname</u>.

       <u>backlog</u>
              The maximum length of the queue of pending connections, as defined by the <b><a href="../man2/listen.2.html">listen</a></b>(2) system call.

</pre><h4><b>DUMP</b> <b>FILE</b> <b>FORMAT</b></h4><pre>
       Each dumped message contains a sequence of  text  lines,  terminated  with  the  newline  character.  The
       sequence of information is as follows:

       •      The optional string specified with the <b>-S</b> option.

       •      The <b>smtp-sink</b> generated headers as documented below.

       •      The message header and body as received from the SMTP client.

       •      An empty line.

       The format of the <b>smtp-sink</b> generated headers is as follows:

       <b>X-Client-Addr:</b> <u>text</u>
              The  client IP address without enclosing []. An IPv6 address is prefixed with "ipv6:". This record
              is always present.

       <b>X-Client-Proto:</b> <u>text</u>
              The client protocol: SMTP, ESMTP or LMTP. This record is always present.

       <b>X-Helo-Args:</b> <u>text</u>
              The arguments of the last HELO or EHLO command before this mail delivery transaction. This  record
              is present only if the client sent a recognizable HELO or EHLO command before the DATA command.

       <b>X-Mail-Args:</b> <u>text</u>
              The  arguments  of  the  MAIL  command that started this mail delivery transaction. This record is
              present exactly once.

       <b>X-Rcpt-Args:</b> <u>text</u>
              The arguments of an RCPT command within this mail delivery transaction. There is  one  record  for
              each RCPT command, and they are in the order as sent by the client.

       <b>Received:</b> <u>text</u>
              A message header for compatibility with mail processing software. This three-line header marks the
              end of the headers provided by <b>smtp-sink</b>, and is formatted as follows:

              <b>from</b> <u>helo</u> ([<u>addr</u>])
                     The  HELO  or EHLO command argument and client IP address.  If the client did not send HELO
                     or EHLO, the client IP address is used instead.

              <b>by</b> <u>host</u> <b>(smtp-sink)</b> <b>with</b> <u>proto</u> <b>id</b> <u>random</u><b>;</b>
                     The hostname specified with the <b>-h</b> option, the client protocol (see <b>X-Client-Proto</b>  above),
                     and the pseudo-random portion of the per-message capture file name.

              <u>time-stamp</u>
                     A time stamp as defined in RFC 2822.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/smtp-source.1.html">smtp-source</a>(1), SMTP/LMTP message generator

</pre><h4><b>LICENSE</b></h4><pre>
       The Secure Mailer license must be distributed with this software.

</pre><h4><b>AUTHOR(S)</b></h4><pre>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA

       Wietse Venema
       Google, Inc.
       111 8th Avenue
       New York, NY 10011, USA

                                                                                                    <u><a href="../man1/SMTP-SINK.1.html">SMTP-SINK</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>