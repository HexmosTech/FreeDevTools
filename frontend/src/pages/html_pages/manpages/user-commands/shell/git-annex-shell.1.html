<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>git-annex-shell - Restricted login shell for git-annex only SSH access</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/git-annex">git-annex_10.20241202-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       git-annex-shell - Restricted login shell for git-annex only SSH access

</pre><h4><b>SYNOPSIS</b></h4><pre>
       git-annex-shell [-c] command [params ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       git-annex-shell  is  a restricted shell, similar to git-shell, which can be used as a login shell for SSH
       accounts.

       Since its syntax is identical to git-shell's, it can be used as a drop-in replacement anywhere  git-shell
       is used. For example it can be used as a user's restricted login shell.

</pre><h4><b>COMMANDS</b></h4><pre>
       Any command not listed below is passed through to git-shell.

       Note  that  the directory parameter should be an absolute path, otherwise it is assumed to be relative to
       the user's home directory. Also the first "/~/" or "/~user/" is expanded to the specified home directory.

       configlist directory
              This outputs a subset of the git configuration, in the same form as <b>git</b>  <b>config</b>  <b>--list</b>.  This  is
              used to get the annex.uuid of the remote repository.

              When  run  in a repository that does not yet have an annex.uuid, one will be created, as long as a
              git-annex branch has already been pushed to the repository, or if the autoinit=1 flag is  used  to
              indicate initialization is desired.

       p2pstdio directory uuid
              This causes git-annex-shell to communicate using the git-annex p2p protocol over stdio.

              The uuid is the one belonging to the repository that will be communicating with git-annex-shell.

       notifychanges directory
              This  is  used  by  <b>git-annex</b>  <b>remotedaemon</b>  to be notified when refs in the remote repository are
              changed.

       gcryptsetup directory gcryptid
              Sets up a repository as a gcrypt repository.

       inannex directory [key ...]
              This checks if all specified keys are present in the annex, and exits zero if so.

              Exits 1 if the key is certainly not present in the annex.   Exits  100  if  it's  unable  to  tell
              (perhaps the key is in the process of being removed from the annex).

              Used only by the gcrypt special remote.

       recvkey directory key
              This  runs  rsync  in  server  mode to receive the content of a key, and stores the content in the
              annex.

              Used only by the gcrypt special remote.

       sendkey directory key
              This runs rsync in server mode to transfer out the content of a key.

              Used only by the gcrypt special remote.

       dropkey directory [key ...]
              This drops the annexed data for the specified keys.

              Used only by the gcrypt special remote.

</pre><h4><b>OPTIONS</b></h4><pre>
       --uuid=UUID

              git-annex uses this to specify the UUID of the repository  it  was  expecting  git-annex-shell  to
              access.  This  is both a sanity check, and allows git-annex shell to proxy access to remotes, when
              configured by git-annex-update-proxy.

       Also the <a href="../man1/git-annex-common-options.1.html">git-annex-common-options</a>(1) can be used.

       -- fields=val fields=val.. --
              Additional fields may be specified this way, to retain compatibility with past  versions  of  git-
              annex-shell (that ignore these, but would choke on new dashed options).

              Currently used fields are autoinit= and remoteuuid=

</pre><h4><b>HOOK</b></h4><pre>
       After  content  is  received  or  dropped  from  the  repository  by  git-annex-shell,  it  runs  a hook,
       <b>.git/hooks/annex-content</b> (or <b>hooks/annex-content</b> on a bare repository). The hook is not currently  passed
       any information about what changed.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       GIT_ANNEX_SHELL_READONLY

              If set, disallows any action that could modify the git-annex repository.

              Note that this does not prevent passing commands on to git-shell.  For that, you also need ...

       GIT_ANNEX_SHELL_LIMITED
              If set, disallows running git-shell to handle unknown commands.

       GIT_ANNEX_SHELL_APPENDONLY
              If  set,  allows  data  to  be  written to the git-annex repository, but does not allow data to be
              removed from it.

              Note that this does not prevent passing commands on to git-shell, so you will have  to  separately
              configure  git  to  reject  pushes  that  overwrite branches or are otherwise not appends. The git
              pre-receive hook may be useful for accomplishing this.

              It's a good idea to enable annex.securehashesonly in a repository that's set up this way.

       GIT_ANNEX_SHELL_DIRECTORY
              If set, git-annex-shell will refuse  to  run  commands  that  do  not  operate  on  the  specified
              directory.

</pre><h4><b>EXAMPLES</b></h4><pre>
       To make a <b><a href="file:~/.ssh/authorized_keys">~/.ssh/authorized_keys</a></b> file that only allows git-annex-shell to be run, and not other commands,
       pass the original command to the -c option:

        command="git-annex-shell                                                                              -c
       \"$SSH_ORIGINAL_COMMAND\"",no-agent-forwarding,no-port-forwarding,no-X11-forwarding               ssh-rsa
       AAAAB3NzaC1y[...] <a href="mailto:user@example.com">user@example.com</a>

       To further restrict git-annex-shell to a particular repository, and fully lock it down to read-only mode:

        command="GIT_ANNEX_SHELL_DIRECTORY=/srv/annex GIT_ANNEX_SHELL_LIMITED=true GIT_ANNEX_SHELL_READONLY=true
       git-annex-shell -c \"$SSH_ORIGINAL_COMMAND\"",restrict ssh-rsa AAAAB3NzaC1y[...] <a href="mailto:user@example.com">user@example.com</a>

       Obviously, <b>ssh-rsa</b> <b>AAAAB3NzaC1y[...]</b> <b><a href="mailto:user@example.com">user@example.com</a></b> needs to replaced with your SSH key. The above also
       assumes <b>git-annex-shell</b> is available in your <b>$PATH</b>, use an absolute path if it is not the case. Also note
       how  the  above  uses  the <b>restrict</b> option instead of an explicit list of functionality to disallow. This
       only works in certain OpenSSH releases, starting from 7.1p2.

       To only allow adding new objects to the repository, the <b>GIT_ANNEX_SHELL_APPENDONLY</b> variable can  be  used
       as well:

       command="GIT_ANNEX_SHELL_DIRECTORY=/srv/annex    GIT_ANNEX_SHELL_APPENDONLY=true    git-annex-shell    -c
       \"$SSH_ORIGINAL_COMMAND\"",restrict ssh-rsa AAAAB3NzaC1y[...] <a href="mailto:user@example.com">user@example.com</a>

       This will not keep an attacker from destroying the git history, as explained above. For  this  you  might
       want   to   disallow  certain  operations,  like  branch  deletion  and  force-push,  with  options  from
       <a href="../man1/git-config.1.html">git-config</a>(1). For example:

       git config receive.denyDeletes true git config receive.denyNonFastForwards true

       With this configuration, git commits can still remove files, but they will still be available in the  git
       history  and  git-annex  will retain their contents. Changes to <b>git-annex</b> branch, however, can negatively
       impact git-annex's location tracking information and might cause data loss. To work around this  problem,
       more complex hooks are required, see for example the <b>update-paranoid</b> hook in the git source distribution.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/git-annex.1.html">git-annex</a>(1)

       <a href="../man1/git-shell.1.html">git-shell</a>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
       Joey Hess &lt;<a href="mailto:id@joeyh.name">id@joeyh.name</a>&gt;

       &lt;<a href="http://git-annex.branchable.com/">http://git-annex.branchable.com/</a>&gt;

                                                                                              <u><a href="../man1/git-annex-shell.1.html">git-annex-shell</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>