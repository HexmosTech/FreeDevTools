<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xa - 6502/R65C02/65816 cross-assembler</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/xa65">xa65_2.4.1-0.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       xa - 6502/R65C02/65816 cross-assembler

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>xa</b> [<u>OPTION</u>]... <u>FILE</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>xa</b>  is a multi-pass cross-assembler for the 8-bit processors in the 6502 series (such as the 6502, 65C02,
       6504, 6507, 6510, 7501, 8500, 8501 and 8502), the Rockwell R65C02, and the 16-bit 65816 processor. For  a
       description of syntax, see <b>ASSEMBLER</b> <b>SYNTAX</b> further in this manual page.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-E</b>     Do not stop after 20 errors, but show all errors.

       <b>-v</b>     Verbose output.

       <b>-C</b>     No CMOS opcodes (default is to allow R65C02 opcodes).

       <b>-W</b>     No 65816 opcodes (default).

       <b>-w</b>     Allow 65816 opcodes.

       <b>-B</b>     Show lines with block open/close (see <b>PSEUDO-OPS</b>).

       <b>-c</b>     Produce  o65  object  files  instead of executable files (no linking performed); files may contain
              undefined references.

       <b>-o</b> <b>filename</b>
              Set output filename. The default is <b>a.o65</b>; use the  special  filename  <b>-</b>  to  output  to  standard
              output.

       <b>-P</b> <b>filename</b>
              Set  listing  filename.  The  default  is none; use the special filename <b>-</b> to print the listing to
              standard output.

       <b>-F</b> <b>format</b>
              Set listing format; default is <b>plain</b>.  The only other currently supported format is <b>html</b>.

       <b>-e</b> <b>filename</b>
              Set errorlog filename; default is none.

       <b>-l</b> <b>filename</b>
              Set labellist filename; default is none. This is the symbol table and can be used by disassemblers
              such as <b><a href="../man1/dxa.1.html">dxa</a></b>(1) to reconstruct source.

       <b>-r</b>     Add cross-reference list to labellist (requires <b>-l</b>).

       <b>-Xcompatset</b>
              Enables compatibility settings to become more (not fully!) compatible with other  6502  assemblers
              and  codebases.   Currently supported are compatibility sets <b>MASM</b>, <b>CA65</b> and <b>C</b>, with <b>XA23</b> available
              as a deprecated option for codebases relying on compatibility with the  previous  version  of  <b>xa</b>.
              Multiple compatibility sets may be specified and combined, e.g., <b>-XMASM</b> <b>-XXA23</b>.

              <b>-XMASM</b>  allows  colons  to  appear in comments for MASM compatibility.  This does not affect colon
              interpretation elsewhere and may become the default in a future version.

              <b>-XCA65</b> adds syntactic features more compatible with <b><a href="../man1/ca65.1.html">ca65</a></b>(1).  It permits <b>:=</b>  for  defining  labels
              (instead  of  plain  <b>=</b>),  and adds support for unnamed labels and "cheap" local labels using the <b>@</b>
              character, but disables its other meaning for 24-bit mode (see <b>ASSEMBLER</b> <b>SYNTAX</b>).

              <b>-XC</b> enables the usage of <b>0xHEX</b> and <b>0OCTAL</b> C-style number encodings.

              <b>-XXA23</b> restores partial compatibility with <b>xa</b> 2.3.x. In  particular,  it  uses  <b>^</b>  for  generating
              control  characters,  disables  escaped  characters with <b>\</b>, allows nested multi-line comments, and
              disables all predefined <b>xa</b> preprocessor macros. Although  some  portions  of  this  option  remain
              supported syntax, the option itself is inherently deprecated and may be removed in the next 2.x or
              3.x release.

       <b>-a</b>     Support  <b><a href="../man1/ca65.1.html">ca65</a></b>(1)-style  unnamed  labels using colons, but not the remainder of the other supported
              <b><a href="../man1/ca65.1.html">ca65</a></b>(1) features. This allows their use with 65816 mode, for example. Implies <b>-XMASM</b>.

       <b>-M</b>     This option is deprecated and will be removed in a future  version;  use  <b>-XMASM</b>  instead.  Allows
              colons  to  appear  in  comments for MASM compatibility. This does not affect colon interpretation
              elsewhere, and may become the default in a future version.

       <b>-k</b>     Allow the carat (<b>^</b>) to mask a character with $1f/31. This can be used as a shorthand  for  control
              characters, such as <b>^m^j</b> becoming a carriage return followed by a linefeed.

       <b>-R</b>     Start assembler in relocating mode, i.e. use segments.

       <b>-U</b>     Do not allow undefined labels in relocating mode.

       <b>-Llabel</b>
              Defines <b>label</b> as an absolute (but undefined) label even when linking.

       <b>-b?</b> <b>addr</b>
              Set segment base for segment <b>?</b>  to address <b>addr</b>.  <b>?</b>  should be t, d, b or z for text, data, bss or
              zero segments, respectively.

       <b>-A</b> <b>addr</b>
              Make  text  segment start at an address such that when the file starts at address <b>addr</b>, relocation
              is not necessary. Overrides <b>-bt</b>; other segments still have to be taken care of with <b>-b</b>.

       <b>-G</b>     Suppress list of exported globals.

       <b>-DDEF=TEXT</b>
              Define a preprocessor macro on the command line (see <b>PREPROCESSOR</b>).

       <b>-I</b> <b>dir</b> Add directory <b>dir</b> to the include path (before <b>XAINPUT</b>; see <b>ENVIRONMENT</b>).

       <b>-O</b> <b>charset</b>
              Define the output charset for character strings. Currently supported are ASCII (default),  PETSCII
              (Commodore ASCII), PETSCREEN (Commodore screen codes) and HIGH (set high bit on all characters).

       <b>-p?</b>    Set  the  alternative preprocessor character to <b>?</b>.  This is useful when you wish to use <b><a href="../man1/cpp.1.html">cpp</a></b>(1) and
              the built-in preprocessor at the same time (see <b>PREPROCESSOR</b>).  Characters may need to  be  quoted
              for your shell (example: <b>-p'~'</b> ).

       <b>--help</b> Show summary of options (<b>-?</b>  is a synonym).

       <b>--version</b>
              Show version of program.

</pre><h4><b>ASSEMBLER</b> <b>SYNTAX</b></h4><pre>
       An  introduction  to  6502 assembly language programming and mnemonics is beyond the scope of this manual
       page. We invite you to investigate any number of the excellent books on the subject; one useful title  is
       "Machine Language For Beginners" by Richard Mansfield (COMPUTE!), covering the Atari, Commodore and Apple
       8-bit systems, and is widely available on the used market.

       <b>xa</b>  supports  both  the standard NMOS 6502 opcodes as well as the Rockwell CMOS opcodes used in the 65C02
       (R65C02). With the <b>-w</b> option, <b>xa</b> will also accept opcodes for the 65816. NMOS 6502  undocumented  opcodes
       are  intentionally  not  supported, and should be entered manually using the <b>.byte</b> pseudo-op (see <b>PSEUDO-</b>
       <b>OPS</b>).  Due to conflicts between the R65C02 and 65816 instruction sets and  undocumented  instructions  on
       the NMOS 6502, their use is discouraged.

       In  general,  <b>xa</b>  accepts  the  more-or-less  standard  6502  assembler format as popularised by MASM and
       TurboAssembler. Values and addresses can be expressed either as literals, or as expressions; to wit,

       <b>123</b>       decimal value

       <b>$234</b>      hexadecimal value (<b>0x234</b> accepted with <b>-XC</b>)

       <b>&amp;123</b>      octal (<b>0123</b> accepted with <b>-XC</b>)

       <b>%010110</b>   binary

       <b>*</b>         current value of the program counter

       The ASCII value of any quoted character is inserted directly into the program text (example: <b>"A"</b>  inserts
       the  byte "A" into the output stream); see also the <b>PSEUDO-OPS</b> section. This is affected by the currently
       selected character set, if any.

       <b>Labels</b> define locations within the program text, just as in  other  multi-pass  assemblers.  A  label  is
       defined by anything that is not an opcode; for example, a line such as

              <b>label1</b> <b>lda</b> <b>#0</b>

       defines  <b>label1</b> to be the current location of the program counter (thus the address of the <b>LDA</b> opcode). A
       label can be explicitly defined by assigning it the value of an expression, such as

              <b>label2</b> <b>=</b> <b>$d000</b>

       which defines <b>label2</b> to be the address $d000, namely, the start of the VIC-II register block on Commodore
       64 computers. The program counter <b>*</b> is considered to be a special kind of label, and can be  assigned  to
       with statements such as

              <b>*</b> <b>=</b> <b>$c000</b>

       which  sets the program counter to decimal location 49152. If <b>-XCA65</b> is specified, you can also use <b>:=</b> as
       well as <b>=</b>.

       With the exception of the program counter, labels  cannot  be  assigned  multiple  times.  To  explicitly
       declare redefinition of a label, place a - (dash) before it, e.g.,

              <b>-label2</b> <b>=</b> <b>$d020</b>

       which  sets  <b>label2</b>  to  the Commodore 64 border colour register. The scope of a label is affected by the
       block it resides within (see <b>PSEUDO-OPS</b> for block instructions). A label may also be hard-specified  with
       the <b>-L</b> command line option.

       Redefining  a  label  does  not  change previously assembled code that used the earlier value. Therefore,
       because the program counter is a special type of label, changing the program counter  to  a  lower  value
       does  not  reorder  code assembled previously and changing it to a higher value does not issue padding to
       put subsequent code at  the  new  location.  This  is  intentional  behaviour  to  facilitate  generating
       relocatable  and position-independent code, but can differ from other assemblers which use this behaviour
       for linking. However, it is possible to use pseudo-ops to simulate other assemblers' behaviour and use <b>xa</b>
       as a linker; see <b>PSEUDO-OPS</b> and <b>LINKING</b>.

       If <b>-XCA65</b> or <b>-a</b> is specified, "unnamed" labels may be specified with <b>:</b> (i.e., no label,  just  a  colon);
       branches  may  then  reference  these unnamed labels with a colon and plus signs for forward branching or
       minus signs for backward branching. For example (from the <b><a href="../man1/ca65.1.html">ca65</a></b>(1) documentation),

           :       lda     (ptr1),y        ; #1
                   cmp     (ptr2),y
                   bne     :+              ; -&gt; #2
                   tax
                   beq     :+++            ; -&gt; #4
                   iny
                   bne     :-              ; -&gt; #1
                   inc     ptr1+1
                   inc     ptr2+1
                   bne     :-              ; -&gt; #1

           :       bcs     :+              ; #2 -&gt; #3
                   ldx     #$FF
                   rts

           :       ldx     #$01            ; #3
           :       rts                     ; #4

       Additionally, in <b>-XCA65</b> mode, "cheap" local labels may be used, marked by the <b>@</b> prefix.  These  temporary
       labels  exist  only  between  two  regular labels and automatically go out of scope with the next regular
       label. This allows, with reasonable care, reuse of common label names like "loop."

       For those instructions where the accumulator is the implied argument (such as <b>asl</b> and <b>lsr</b>; <b>inc</b> and <b>dec</b> on
       R65C02; etc.), the idiom of explicitly specifying the accumulator with <b>a</b> is  unnecessary  as  the  proper
       form  will be selected if there is no explicit argument. In fact, for consistency with label handling, if
       there is a label named <b>a</b>, this will actually generate code referencing that label as  a  memory  location
       and not the accumulator. Otherwise, the assembler will complain.

       Labels  and  opcodes may take <b>expressions</b> as their arguments to allow computed values, and may themselves
       reference other labels and/or the program counter. An expression such as <b>lab1+1</b> (which  operates  on  the
       current  value of label <b>lab1</b> and increments it by one) may use the following operands, given from highest
       to lowest priority:

       <b>*</b>       multiplication (priority 10)

       <b>/</b>       integer division (priority 10)

       <b>+</b>       addition (priority 9)

       <b>-</b>       subtraction (9)

       <b>&lt;&lt;</b>      shift left (8)

       <b>&gt;&gt;</b>      shift right (8)

       <b>&gt;=</b> <b>=&gt;</b>   greater than or equal to (7)

       <b>&gt;</b>       greater than (7)

       <b>&lt;=</b> <b>=&lt;</b>   less than or equal to (7)

       <b>&lt;</b>       less than (7)

       <b>=</b>       equal to (6); <b>==</b> also accepted

       <b>&lt;&gt;</b> <b>&gt;&lt;</b>   does not equal (6); <b>!=</b> also accepted

       <b>&amp;</b>       bitwise AND (5)

       <b>^</b>       bitwise XOR (4)

       <b>|</b>       bitwise OR (3)

       <b>&amp;&amp;</b>      logical AND (2)

       <b>||</b>      logical OR (1)

       Parentheses are valid. When redefining a label, combining arithmetic or  bitwise  operators  with  the  =
       (equals) operator such as <b>+=</b> and so on are valid, e.g.,

              <b>-redeflabel</b> <b>+=</b> <b>(label12/4)</b>

       Normally, <b>xa</b> attempts to ascertain the value of the operand and (when referring to a memory location) use
       zero  page,  16-bit  or  (for  65816)  24-bit  addressing  where  appropriate  and where supported by the
       particular opcode. This generates smaller and faster code, and is almost always preferable.

       Nevertheless, you can use these prefix operators to force a particular rendering of  the  operand.  Those
       that  generate an eight bit result can also be used in 8-bit addressing modes, such as immediate and zero
       page.

       <b>&lt;</b>      low byte of expression, e.g., <b>lda</b> <b>#&lt;vector</b>

       <b>&gt;</b>      high byte of expression

       <b>!</b>      in situations where the expression could be understood as either an absolute or zero  page  value,
              do  not  attempt to optimize to a zero page argument for those opcodes that support it (i.e., keep
              as 16 bit word)

       <b>@</b>      render as 24-bit quantity for 65816, even if smaller than 24 bits (must  specify  <b>-w</b>  command-line
              option, must not specify <b>-XCA65</b>)

       <b>`</b>      force  further  optimization,  even if the length of the instruction cannot be reliably determined
              (see <b>NOTES'N'BUGS</b>)

       Expressions can occur as arguments to opcodes or within the preprocessor (see <b>PREPROCESSOR</b>  for  syntax).
       For example,

              <b>lda</b> <b>label2+1</b>

       takes  the  value  at  <b>label2+1</b>  (using  our  previous  label's  value, this would be $d021), and will be
       assembled as <b>$ad</b> <b>$21</b> <b>$d0</b> to disk. Similarly,

              <b>lda</b> <b>#&lt;label2</b>

       will take the lowest 8 bits of <b>label2</b> (i.e., $20), and assign them to  the  accumulator  (assembling  the
       instruction as <b>$a9</b> <b>$20</b> to disk).

       Comments are specified with a semicolon (;), such as

              <b>;this</b> <b>is</b> <b>a</b> <b>comment</b>

       They  can  also  be  specified  in  the  C language style, using <b>/*</b> <b>*/</b> and <b>//</b> which are understood at the
       <b>PREPROCESSOR</b> level (q.v.).

       Normally, the colon (:) separates statements, such as

              <b>label4</b> <b>lda</b> <b>#0:sta</b> <b>$d020</b>

       or

              <b>label2:</b> <b>lda</b> <b>#2</b>

       (note the use of a colon for specifying a  label,  similar  to  some  other  assemblers,  which  <b>xa</b>  also
       understands with or without the colon). This also applies to semicolon comments, such that

              <b>;</b> <b>a</b> <b>comment:lda</b> <b>#0</b>

       is  understood  as  a comment followed by an opcode. To defeat this, use the <b>-XMASM</b> compatibility mode to
       allow colons within comments; this may become the default in a future version. Colon statement separation
       does not apply to <b>/*</b> <b>*/</b> and <b>//</b> comments, which are dealt with at the preprocessor level (q.v.).

</pre><h4><b>PSEUDO-OPS</b></h4><pre>
       <b>Pseudo-ops</b> are false opcodes used by the assembler to  denote  meta-  or  inlined  commands.   Like  most
       assemblers, <b>xa</b> has a rich set.

       <b>.byt</b> <b>value1,value2,value3,...</b>
              Specifies a string of bytes to be directly placed into the assembled object.  The arguments may be
              expressions. Any number of bytes can be specified.

       <b>.asc</b> <b>"text1"</b> <b>,"text2",...</b>
              Specifies  a  character  string  which  will  be  inserted  into the assembled object. Strings are
              understood according to the currently specified character set; for example, if ASCII is specified,
              they will be rendered as ASCII, and if PETSCII is specified, they  will  be  translated  into  the
              equivalent  Commodore  ASCII  equivalent.  Other  non-standard  ASCIIs  such  as ATASCII for Atari
              computers should use the ASCII equivalent characters; graphic and  control  characters  should  be
              specified  explicitly using <b>.byt</b> for the precise character you want. Note that when specifying the
              argument of an opcode, <b>.asc</b> is not necessary; the quoted character can simply be  inserted  (e.g.,
              <b>lda</b>  <b>#"A"</b>  ),  and is also affected by the current character set.  Any number of character strings
              can be specified.

       <b>.byt</b> and <b>.asc</b> are synonymous, so you can mix things such as <b>.byt</b> <b>$43,</b> <b>22,</b> <b>"a</b> <b>character</b>  <b>string"</b>  and  get
       the  expected  result.  The  string  is subject to the current character set, but the remaining bytes are
       inserted without modification.

       <b>.aasc</b> <b>"text1"</b> <b>,"text2",...</b>
              Specifies a character string that is <b>always</b> rendered in  true  ASCII  regardless  of  the  current
              character set. Like <b>.asc</b>, it is synonymous with <b>.byt</b>.

       <b>.word</b> <b>value1,value2,value3...</b>
              Specifies  a  string  of 16-bit words to be placed into the assembled object in 6502 little-endian
              format (that is, low-byte/high-byte). The arguments may be expressions. Any number of words can be
              specified.

       <b>.dsb</b> <b>length,fillbyte</b>
              Specifies a data block; a total of <b>length</b> repetitions  of  <b>fillbyte</b>  will  be  inserted  into  the
              assembled  object. For example, <b>.dsb</b> <b>5,$10</b> will insert five bytes, each being 16 decimal, into the
              object. The arguments may be expressions. If only a single argument is provided, then the argument
              is treated as a number of null bytes to insert. See <b>LINKING</b> for how to use this pseudo-op to  link
              multiple objects.

       <b>.bin</b> <b>offset,length,"filename"</b>
              Inlines  a  binary  file  without  further interpretation specified by <b>filename</b> from offset <b>offset</b>
              (relative to the beginning of the file) for <b>length</b> bytes.  This allows you to insert data such  as
              a  previously  assembled  object file or an image or other binary data structure, inlined directly
              into this file's object. If <b>length</b> is zero, then the length of <b>filename</b>, minus the offset, is used
              instead. The arguments may be expressions. See <b>LINKING</b> for how  to  use  this  pseudo-op  to  link
              multiple objects.

       <b>.(</b>     Opens  a new block for scoping. Within a block, all labels defined are local to that block and any
              sub-blocks, and go out of scope as soon as the enclosing block is closed (i.e., lexically scoped).
              All labels defined outside of the block are still visible  within  it.  To  explicitly  declare  a
              global  label  within  a block, precede the label with <b>+</b> or precede it with <b>&amp;</b> to declare it within
              the previous level only (or globally if you are only one level deep). Sixteen  levels  of  scoping
              are permitted.

              <b>.block</b> is accepted as a synonym for <b>.(</b>, as well as <b>.proc</b> (but you cannot specify an explicit scope
              name as in <b>ca65</b>; only anonymous blocks are supported).

       <b>.)</b>     Closes a block.  <b>.bend</b> or <b>.endproc</b> are accepted as synonyms.

       <b>.as</b> <b>.al</b> <b>.xs</b> <b>.xl</b>
              Only  relevant  in  65816  mode  (with  the  <b>-w</b>  option specified). These pseudo-ops set what size
              accumulator and X/Y-register should be used  for  future  instructions;  <b>.as</b>  and  <b>.xs</b>  set  8-bit
              operands  for  the  accumulator  and  index  registers,  respectively,  and <b>.al</b> and <b>.xl</b> set 16-bit
              operands. These pseudo-ops on purpose do not automatically issue <b>sep</b> and <b>rep</b> instructions  to  set
              the  specified  width  in  the CPU; set the processor bits as you need, or consider constructing a
              macro.  <b>.al</b> and <b>.xl</b> generate errors if <b>-w</b> is not specified.

       <b>.assert</b> <b>expression,"message"</b>
              Evaluates <b>expression</b> and if it is false (i.e., evaluates to  zero),  prints  <b>message</b>  as  a  fatal
              error,  terminating assembly immediately.  For example, a block of assembly code that creates high
              ROM might have

              .assert *&lt;$fffa, "hit vectors"

              to ensure that assembled code does not leak into the 6502 high vectors. If the preceding  code  is
              too long, the assertion will be false, and the condition will be detected in a controlled fashion.
              Any  operation may be used as part of the expression, including logical comparisons such as <b>=</b>, <b>==</b>,
              <b>&lt;</b>, <b>&lt;=</b>, <b>&gt;</b>, <b>&gt;=</b>, <b>!=</b> and <b>&lt;&gt;</b>.

       <b>.include</b> <b>filename</b>
              Includes another file in place of the pseudo-op, as if  the  preprocessor  had  done  so  with  an
              <b>#include</b>  directive (see <b>PREPROCESSOR</b>), but at the assembler phase after preprocessing has already
              occurred.

       The following pseudo-op applies to listing mode.

       <b>.listbytes</b> <b>number</b>
              In the listing output, sets the maximum number of hex bytes to  be  printed  in  the  listing  for
              pseudo-ops like <b>.byt</b>, by default 8. The special argument <b>unlimited</b> sets no upper limit. If listing
              mode is disabled, this pseudo-op has no observable effect.

       The  following  pseudo-ops  apply  primarily  to  relocatable  <b>.o65</b>  objects.   A  full discussion of the
       relocatable format is beyond the scope of this manpage; see <b><a href="http://www.6502.org/users/andre/o65/">http://www.6502.org/users/andre/o65/</a></b> for  the
       most current specification.

       <b>.text</b> <b>.data</b> <b>.bss</b> <b>.zero</b>
              These pseudo-ops switch between the different segments, <b>.text</b> being the actual code section, <b>.data</b>
              being  the  data  segment,  <b>.bss</b>  being  uninitialized  label space for allocation and <b>.zero</b> being
              uninitialized zero page space for allocation. In <b>.bss</b> and <b>.zero</b>, only labels are evaluated.  These
              pseudo-ops are valid in relocating and absolute modes.

       <b>.code</b>  For <b>ca65</b> compatibility, this is currently mapped to <b>.text</b>.

       <b>.zeropage</b>
              For <b>ca65</b> compatibility, this is currently mapped to <b>.zero</b>.

       <b>.align</b> <b>value</b>
              Aligns  the  current segment to a byte boundary (2, 4 or 256) as specified by <b>value</b> (and places it
              in the header when relocating mode is enabled). Other values generate an error.

       <b>.fopt</b> <b>type,</b> <b>value1,</b> <b>value2,</b> <b>value3,</b> <b>...</b>
              Acts like <b>.byt/.asc</b> except that the values are embedded into the object file as file options.  The
              argument <b>type</b> is used to specify the file option being referenced. A table of these options is  in
              the  relocatable  o65  file  format  description.  The remainder of the options are interpreted as
              values to insert. Any number of values may be specified, and may also be strings.

       <b>.import</b> <b>label1,</b> <b>label2,</b> <b>label3,</b> <b>...</b>
              Defines the given labels as global labels which are imported and resolved during the  link  stage,
              like the <b>-L</b> command line parameter.

       <b>.importzp</b> <b>label1,</b> <b>label2,</b> <b>label3,</b> <b>...</b>
              Analogous to <b>.import</b>, except that it only imports zeropage labels (i.e., byte values).

</pre><h4><b>PREPROCESSOR</b></h4><pre>
       <b>xa</b>  implements  a  preprocessor  very  similar  to  that  of  the C-language preprocessor <b><a href="../man1/cpp.1.html">cpp</a></b>(1) and many
       oddiments apply to both. For example, as in C, the use of <b>/*</b> <b>*/</b> for comment delimiters is also  supported
       in <b>xa</b>, and so are comments using the double slash <b>//</b>.  The preprocessor also supports continuation lines,
       i.e.,  lines  ending  with a backslash (\); the following line is then appended to it as if there were no
       dividing newline. This too is handled at the preprocessor level.

       For reasons of memory and complexity, the full breadth of the <b><a href="../man1/cpp.1.html">cpp</a></b>(1) syntax is not  fully  supported.  In
       particular,  macro  definitions may not be forward-defined (i.e., a macro definition can only reference a
       previously defined  macro  definition),  except  for  macro  functions,  where  recursive  evaluation  is
       supported;  e.g.,  to <b>#define</b> <b>WW</b> <b>AA</b> , <b>AA</b> must have already been defined. Certain other directives are not
       supported, nor are most standard pre-defined macros, and there are other limits on  evaluation  and  line
       length.  Because the maintainers of <b>xa</b> recognize that some files will require more complicated preparsing
       than the built-in preprocessor can supply, the preprocessor will accept <b><a href="../man1/cpp.1.html">cpp</a></b>(1)-style  line/filename/flags
       output.  When  these  lines are seen in the input file, <b>xa</b> will treat them as <b>cc</b> would, except that flags
       are ignored.  <b>xa</b> does not accept files on standard input for parsing reasons, so  you  should  dump  your
       <b><a href="../man1/cpp.1.html">cpp</a></b>(1) output to an intermediate temporary file, such as

              <b>cc</b> <b>-E</b> <b>test.s</b> <b>&gt;</b> <b>test.xa</b>
              <b>xa</b> <b>test.xa</b>

       No special arguments need to be passed to <b>xa</b>; the presence of <b><a href="../man1/cpp.1.html">cpp</a></b>(1) output is detected automatically.

       Note  that  passing your file through <b><a href="../man1/cpp.1.html">cpp</a></b>(1) may interfere with <b>xa</b>'s own preprocessor directives. In this
       case, to mask directives from <b><a href="../man1/cpp.1.html">cpp</a></b>(1), use the <b>-p</b> option to specify an alternative character instead of <b>#</b>,
       such as the tilde (e.g., <b>-p'~'</b> ). With this option and argument specified, then instead of <b>#include</b>,  for
       example,  you can also use <b>~include</b>, in addition to <b>#include</b> (which will also still be accepted by the <b>xa</b>
       preprocessor, assuming any survive <b><a href="../man1/cpp.1.html">cpp</a></b>(1)).  Any character  can  be  used,  although  frankly  pathologic
       choices  may  lead  to  amusing and frustrating glitches during parsing.  You can also use this option to
       defer preprocessor directives that <b><a href="../man1/cpp.1.html">cpp</a></b>(1) may interpret too early until the  file  actually  gets  to  <b>xa</b>
       itself for processing.

       The following predefined macros are supported, except if <b>-XXA23</b> is specified:

       <b>XA_MAJOR</b>
              The current major version of <b>xa</b>.

       <b>XA_MINOR</b>
              The current minor version of <b>xa</b>.

       The following preprocessor directives are supported:

       <b>#include</b> <b>"filename"</b>
              Inserts  the  contents of file <b>filename</b> at this position. If the file is not found, it is searched
              using paths specified by the <b>-I</b> command line option or the environment  variable  <b>XAINPUT</b>  (q.v.).
              When inserted, the file will also be parsed for preprocessor directives.

       <b>#echo</b> <b>comment</b>
              Inserts comment <b>comment</b> into the errorlog file, specified with the <b>-e</b> command line option.

       <b>#print</b> <b>expression</b>
              Computes the value of expression <b>expression</b> and prints it into the errorlog file.

       <b>#error</b> <b>message</b>
              Displays the message as an error and terminates assembly.

       <b>#define</b> <b>DEFINE</b> <b>text</b>
              Equates macro <b>DEFINE</b> with text <b>text</b> such that wherever <b>DEFINE</b> appears in the assembly source, <b>text</b>
              is  substituted  in  its place (just like <b><a href="../man1/cpp.1.html">cpp</a></b>(1) would do). In addition, <b>#define</b> can specify macro
              functions like <b><a href="../man1/cpp.1.html">cpp</a></b>(1) such that a directive like <b>#define</b> <b>mult(a,b)</b> <b>((a)*(b))</b>  would  generate  the
              expected  result wherever an expression of the form <b>mult(a,b)</b> appears in the source. This can also
              be specified on the command line with the <b>-D</b> option. The arguments of  a  macro  function  may  be
              recursively  evaluated,  unlike  other  <b>#define</b>s; the preprocessor will attempt to re-evaluate any
              argument refencing another preprocessor definition up to ten times before complaining.

       The following directives are conditionals. If the conditional is not  satisfied,  then  the  source  code
       between  the directive and its terminating <b>#endif</b> are expunged and not assembled. Up to fifteen levels of
       nesting are supported.

       <b>#ifdef</b> <b>DEFINE</b>
              True only if macro <b>DEFINE</b> is defined.

       <b>#ifndef</b> <b>DEFINE</b>
              The opposite; true only if macro <b>DEFINE</b> has not been previously defined.

       <b>#if</b> <b>expression</b>
              True if expression <b>expression</b> evaluates to non-zero.  <b>expression</b> may reference other macros.

       <b>#iflused</b> <b>label</b>
              True if label <b>label</b> has been used (but not necessarily instantiated with a value).  <u>This</u> <u>works</u>  <u>on</u>
              <u>labels,</u> <u>not</u> <u>macros!</u>

       <b>#ifldef</b> <b>label</b>
              True if label <b>label</b> is defined <u>and</u> assigned with a value.  <u>This</u> <u>works</u> <u>on</u> <u>labels,</u> <u>not</u> <u>macros!</u>

       <b>#else</b>  Implements alternate path for a conditional block.

       <b>#endif</b> Closes a conditional block.

       Unclosed  conditional  blocks at the end of included files generate warnings; unclosed conditional blocks
       at the end of assembly generate an error.

       <b>#iflused</b> and <b>#ifldef</b> are useful for building up a library based on labels. For  example,  you  might  use
       something like this in your library's code:

              <b>#iflused</b> <b>label</b>
              <b>#ifldef</b> <b>label</b>
              <b>#echo</b> <b>label</b> <b>already</b> <b>defined,</b> <b>library</b> <b>function</b> <b>label</b> <b>cannot</b> <b>be</b> <b>inserted</b>
              <b>#else</b>
              <b>label</b> <b>/*</b> <b>your</b> <b>code</b> <b>*/</b>
              <b>#endif</b>
              <b>#endif</b>

</pre><h4><b>LINKING</b></h4><pre>
       <b>xa</b>  is  oriented  towards  generating  sequential binaries. Code is strictly emitted in order even if the
       program counter is set  to  a  lower  location  than  previously  assembled  code,  and  padding  is  not
       automatically  emitted  if the program counter is set to a higher location. Changing the program location
       only changes new labels for code that is subsequently emitted; previous emitted code  remains  unchanged.
       Fortunately, for many object files these conventions have no effect on their generation.

       However,  some applications may require generating an object file built from several previously generated
       components, and/or submodules which may need to be present at specific memory  locations.  With  a  minor
       amount of additional specification, it is possible to use <b>xa</b> for this purpose as well.

       The first means of doing so uses the o65 format to make relocatable objects that in turn can be linked by
       <b><a href="../man1/ldo65.1.html">ldo65</a></b>(1) (q.v.).

       The  second  means  involves either assembled code, or insertion of previously built object or data files
       with <b>.bin</b>, using <b>.dsb</b> pseudo-ops with computed expression  arguments  to  insert  any  necessary  padding
       between them, in the sequential order they are to reside in memory. Consider this example:

           .word $1000
           * = $1000

           ; this is your code at $1000
       part1       rts
           ; this label marks the end of code
       endofpart1

           ; DON'T PUT A NEW .word HERE!
           * = $2000
           .dsb (*-endofpart1), 0
           ; yes, set it again
           * = $2000

           ; this is your code at $2000
       part2       rts

       This  example, written for Commodore microcomputers using a 16-bit starting address, has two "modules" in
       it: one block of code at $1000 (4096), indicated by the code between labels <b>part1</b> and <b>endofpart1</b>,  and  a
       second block at $2000 (8192) starting at label <b>part2</b>.

       The  padding  is computed by the <b>.dsb</b> pseudo-op between the two modules. Note that the program counter is
       set to the new address and then a computed expression inserts the proper number of fill  bytes  from  the
       end of the assembled code in part 1 up to the new program counter address. Since this itself advances the
       program counter, the program counter is reset again, and assembly continues.

       When  the  object  this source file generates is loaded, there will be an <b>rts</b> instruction at address 4096
       and another at address 8192, with null bytes between them.

       Should one of these areas need to contain a pre-built file, instead of assembly code, simply use  a  <b>.bin</b>
       pseudo-op  to  load  whatever  portions  of  the  file  are  required into the output. The computation of
       addresses and number of necessary fill bytes is done in the same fashion.

       Although this example used the program counter itself to compute the difference  between  addresses,  you
       can  use  any  label  for  this  purpose,  keeping in mind that only the program counter determines where
       relative addresses within assembled code are resolved.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       <b>xa</b> utilises the following environment variables, if they exist:

       <b>XAINPUT</b>
              Include file path; components should be separated by `,'.

       <b>XAOUTPUT</b>
              Output file path.

</pre><h4><b>NOTES'N'BUGS</b></h4><pre>
       The R65C02 instructions <b>ina</b> (often rendered <b>inc</b> <b>a</b>) and <b>dea</b> (<b>dec</b> <b>a</b>) must be rendered as bare <b>inc</b>  and  <b>dec</b>
       instructions respectively.

       The  65816  instructions  <b>mvn</b>  and  <b>mvp</b> use two eight bit parameters, the only instructions in the entire
       instruction set to do so. Older versions of <b>xa</b> took a single 16-bit absolute value. As of 2.4.0, this old
       syntax is no longer accepted.

       Forward-defined labels -- that is, labels that are defined after the current instruction is processed  --
       cannot  be  optimized  into  zero page instructions even if the label does end up being defined as a zero
       page location, because the assembler does not know the value of the label in  advance  during  the  first
       pass  when the length of an instruction is computed. On the second pass, a warning will be issued when an
       instruction that could have been optimized can't be because of this limitation.   (Obviously,  this  does
       not  apply  to  branching  or  jumping  instructions  because  they're  not optimizable anyhow, and those
       instructions that can <u>only</u> take an 8-bit parameter will always be casted to an 8-bit quantity.)   If  the
       label  cannot  otherwise  be defined ahead of the instruction, the backtick prefix <b>`</b> may be used to force
       further optimization no matter where the label is  defined  as  long  as  the  instruction  supports  it.
       Indiscriminately  forcing  the  issue  can  be  fraught  with  peril, however, and is not recommended; to
       discourage this, the assembler will complain about  its  use  in  addressing  mode  situations  where  no
       ambiguity exists, such as indirect indexed, branching and so on.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/file65.1.html">file65</a></b>(1), <b><a href="../man1/ldo65.1.html">ldo65</a></b>(1), <b><a href="../man1/reloc65.1.html">reloc65</a></b>(1), <b><a href="../man1/uncpk.1.html">uncpk</a></b>(1), <b><a href="../man1/dxa.1.html">dxa</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
       This  manual  page  was  written  by  David  Weinehall &lt;<a href="mailto:tao@acc.umu.se">tao@acc.umu.se</a>&gt;, Andre Fachat &lt;<a href="mailto:fachat@web.de">fachat@web.de</a>&gt; and
       Cameron Kaiser &lt;<a href="mailto:ckaiser@floodgap.com">ckaiser@floodgap.com</a>&gt;.  Original xa package (C)1989-1997 Andre Fachat. Additional changes
       (C)1989-2024 Andre Fachat, Jolse Maginnis, David Weinehall, Cameron Kaiser. The  official  maintainer  is
       Cameron Kaiser.

</pre><h4><b>OVER</b> <b>30</b> <b>YEARS</b> <b>OF</b> <b>XA</b></h4><pre>
       Yay us?

</pre><h4><b>WEBSITE</b></h4><pre>
       <a href="http://www.floodgap.com/retrotech/xa/">http://www.floodgap.com/retrotech/xa/</a>

                                                  5 March 2024                                             <u><a href="../man1/XA.1.html">XA</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>