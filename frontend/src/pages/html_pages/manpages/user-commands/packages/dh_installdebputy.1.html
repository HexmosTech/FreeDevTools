<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dh_installdebputy - install debputy plugins for debhelper packages</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/dh-debputy">dh-debputy_0.1.67_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dh_installdebputy - install debputy plugins for debhelper packages

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>dh_installdebputy</b> [<u>debhelper</u> <u>options</u>] [<b>--</b> <u>params</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>dh_installdebputy</b> is a tool for installing <b>debputy</b> plugins from a package built using <b>debhelper</b>

</pre><h4><b>OPTIONS</b></h4><pre>
       Standard debhelper options (such as <b>-p</b>). Please see <b><a href="../man7/debhelper.7.html">debhelper</a></b>(7).

</pre><h4><b>DIRECTORIES</b></h4><pre>
       <u>debian/debputy-plugins/</u>, <u>debian/PACKAGE.debputy-plugins/</u>
           These  directories  will contain the plugin(s) and related support files.  Unlike most debhelper like
           tools, these must be directories (not files).

           Inside each directory, place the JSON descriptor file and  (if  relevant)  related  Python  code  and
           tests.  For a plugin named <u>my-plugin</u> installed into <u>package</u>, you might see:

               debian/package.debputy-plugins/my-plugin.json
                   debian/package.debputy-plugins/my_plugin.py
                   debian/package.debputy-plugins/my_plugin_check.py

           If  any  tests  are  provided, they will be run when the plugin is installed provided that <b>py.test</b> is
           available.  Consider  adding  <b>python3-pytest</b>  <b>&lt;!nocheck&gt;</b>   to   <b>Build-Depends</b>   for   this   purpose.
           Additionally,  the  tests  can be picked up by the <b>autopkgtests</b> framework if you add <b>autopkgtest-pkg-</b>
           <b>debputy</b> to the <b>Testsuite</b> field in <u>debian/control</u>.

           It is possible to have multiple test files:

               debian/package.debputy-plugins/my-plugin.json
                   debian/package.debputy-plugins/my_plugin.py
                   debian/package.debputy-plugins/my_plugin_check_foo.py
                   debian/package.debputy-plugins/my_plugin_check_bar.py

           If you find yourself fighting with upstream's Python test runner picking up the  <b>debputy</b>  test,  then
           please review the "DEALING WITH UPSTREAM'S PYTHON TEST RUNNER" sections for ways to deal with it.

</pre><h4><b>DEALING</b> <b>WITH</b> <b>UPSTREAM'S</b> <b>PYTHON</b> <b>TEST</b> <b>RUNNER</b></h4><pre>
       There  are  multiple  ways  to  deal with upstream's python test runner picking up the <b>debputy</b> test. This
       section is written assuming upstream is using <b>py.test</b> (sometimes invoked as <b>python3</b> <b>-m</b> <b>pytest</b>). While the
       concepts should carry over to other test runners, the examples and configuration names will probably  not
       be directly reusable.

       The  "least"  effort option is to use <b>_check</b> instead <b>_test</b> in the naming of the <b>debputy</b> tests.  This will
       work for clean builds as long as the <b>py.test</b> run can still <u>load</u> the modules  (which  often  assumes  that
       <b>debputy</b>  is  installed).  However,  on  unclean  (<b>dpkg-buildpackage</b> <b>-nc</b>) builds, <b>py.test</b> can get confused
       because the module implementation file is both in <b>debian/</b><u><b>pkg</b></u><b>.debputy-plugins</b> and in <b>debian/</b><u><b>pkg</b></u>.  You  can
       `rm` the version under <b>debian/</b><u><b>pkg</b></u> manually, but it gets tedious.

       A more involved fix is to tell <b>py.test</b> to either stay away from the <u>debian</u> directory via <b>norecursedirs</b> OR
       explicitly  tell  it  where  to  find  the  source  and  tests (<b>pythonpath</b> + <b>testpaths</b>). If upstream uses
       <b>pyproject.toml</b>, this could look something like:

               [tool.pytest.ini_options]
               # Option A: Stay out of the "debian" dir.
               norecursedirs = [
                       "debian",
               ]
               # Option B: Explicitly lists where the source and tests are.
               # In this case, `py.test` will work out of the box (without resorting
               # to "python3 -m pytest" or similar tricks). This approach may have
               # value for upstream for that particular reason.
               pythonpath = [
                       "src",
               ]
               testpaths = [
                       "tests",
                       # You may need "src" here if upstream uses --doctest-modules
               ]

       The upstream fix will also prevent <b>py.test</b> from picking up the plugin  inside  <b>debian/</b><u><b>package</b></u>  directory,
       which makes it more robust for <b>dpkg-buildpackage</b> <b>-nc</b> builds.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/debhelper.7.html">debhelper</a></b>(7)

       This program integrates into the debhelper suite.

</pre><h4><b>AUTHOR</b></h4><pre>
       Niels Thykier &lt;<a href="mailto:niels@thykier.net">niels@thykier.net</a>&gt;

perl v5.40.1                                       2025-03-13                               <u><a href="../man1/dh_installdebputy.1.html">dh_installdebputy</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>