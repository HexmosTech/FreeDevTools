<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nix-env --install - add packages to user environment</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nix-bin">nix-bin_2.24.9+dfsg-2ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>Name</b></h4><pre>
       nix-env --install - add packages to user environment

</pre><h4><b>Synopsis</b></h4><pre>
       nix-env {--install | -i} <u>args…</u> [{--prebuilt-only | -b}] [{--attr | -A}] [--from-expression] [-E] [--from-
       profile <u>path</u>] [--preserve-installed | -P] [--remove-all | -r]

</pre><h4><b>Description</b></h4><pre>
       The  --install  operation  creates  a new user environment.  It is based on the current generation of the
       active profile, to which a set of store paths described by <u>args</u> is added.

       The arguments <u>args</u> map to store paths in a number of possible ways:

       •  By default, <u>args</u> is a set of derivation names  denoting  derivations  in  the  default Nix expression.
          These  are  realised,  and  the resulting output paths are installed.  Currently installed derivations
          with a name equal to the name of a derivation being added are removed unless  the  option  --preserve-
          installed is specified.

          If there are multiple derivations matching a name in <u>args</u> that have the same name (e.g., gcc-3.3.6 and
          gcc-4.1.1),  then the derivation with the highest <u>priority</u> is used. A derivation can define a priority
          by declaring the meta.priority attribute. This attribute should be  a  number,  with  a  higher  value
          denoting a lower priority. The default priority is 5.

          If  there  are  multiple  matching  derivations  with  the same priority, then the derivation with the
          highest version will be installed.

          You can force the installation of multiple derivations with the same name by being specific about  the
          versions.  For  instance,  nix-env --install gcc-3.3.6 gcc-4.1.1 will install both version of GCC (and
          will probably cause a user environment conflict!).

       •  If --attr / -A is specified, the arguments are <u>attribute</u> <u>paths</u> that select attributes from the default
          Nix expression.  This is faster than using derivation names and unambiguous.  Show the attribute paths
          of available packages with nix-env --query:

       nix-env --query --available --attr-path

       •  If --from-profile <u>path</u> is given, <u>args</u> is a set of names denoting installed store paths in the  profile
          <u>path</u>. This is an easy way to copy user environment elements from one profile to another.

       •  If  --from-expression  is  given, <u>args</u> are Nix language functions that are called with the default Nix
          expression as their single argument.  The derivations returned by those function calls are  installed.
          This  allows  derivations  to  be  specified  in  an  unambiguous way, which is necessary if there are
          multiple derivations with the same name.

       •  If <u>args</u> are store derivations, then these are realised, and the resulting output paths are installed.

       •  If <u>args</u> are store paths that are not store derivations, then these are realised and installed.

       •  By default all outputs are installed for  each  derivation.   This  can  be  overridden  by  adding  a
          meta.outputsToInstall attribute on the derivation listing a subset of the output names.

          Example:

          The file example.nix defines a derivation with two outputs foo and bar, each containing a file.

       # example.nix
       let
       pkgs = import &lt;nixpkgs&gt; {};
       command = ''
         ${pkgs.coreutils}<a href="file:/bin/mkdir">/bin/mkdir</a> -p $foo $bar
         echo foo &gt; $foo/foo-file
         echo bar &gt; $bar/bar-file
       '';
       in
       derivation {
       name = "example";
       builder = "${pkgs.bash}<a href="file:/bin/bash">/bin/bash</a>";
       args = [ "-c" command ];
       outputs = [ "foo" "bar" ];
       system = builtins.currentSystem;
       }

              Installing  from  this  Nix  expression  will  make  files from both outputs appear in the current
              profile.

       $ nix-env --install --file example.nix
       installing 'example'
       $ ls <a href="file:~/.nix-profile">~/.nix-profile</a>
       foo-file
       bar-file
       manifest.nix

              Adding meta.outputsToInstall to that derivation will make nix-env  only  install  files  from  the
              specified outputs.

       # example-outputs.nix
       import ./example.nix // { meta.outputsToInstall = [ "bar" ]; }

       $ nix-env --install --file example-outputs.nix
       installing 'example'
       $ ls <a href="file:~/.nix-profile">~/.nix-profile</a>
       bar-file
       manifest.nix

</pre><h4><b>Options</b></h4><pre>
       •  --prebuilt-only / -b

          Use only derivations for which a substitute is registered, i.e., there is a pre-built binary available
          that  can  be  downloaded  in  lieu  of  building the derivation. Thus, no packages will be built from
          source.

       •  --preserve-installed / -P

          Do not remove derivations with a name matching one of the derivations being installed. Usually, trying
          to have two versions of the same package installed in the same generation of a profile will lead to an
          error in building the generation, due to file name clashes between the two versions. However, this  is
          not the case for all packages.

       •  --remove-all / -r

          Remove all previously installed packages first. This is equivalent to running nix-env --uninstall '.*'
          first, except that everything happens in a single transaction.

</pre><h4><b>Options</b></h4><pre>
       The following options are allowed for all nix-env operations, but may not always have an effect.

       •  --file / -f <u>path</u>

          Specifies  the  Nix  expression (designated below as the <u>active</u> <u>Nix</u> <u>expression</u>) used by the --install,
          --upgrade, and --query --available operations to obtain derivations. The default is <a href="file:~/.nix-defexpr.">~/.nix-defexpr.</a>

          If the argument starts with http:// or https://, it is interpreted as the URL of a tarball  that  will
          be  downloaded  and  unpacked  to  a  temporary  location. The tarball must include a single top-level
          directory containing at least a file named default.nix.

       •  --profile / -p <u>path</u>

          Specifies the profile to be used by those operations that operate on a profile  (designated  below  as
          the  <u>active</u> <u>profile</u>). A profile is a sequence of user environments called <u>generations</u>, one of which is
          the <u>current</u> <u>generation</u>.

       •  --dry-run

          For the --install, --upgrade, --uninstall, --switch-generation,  --delete-generations  and  --rollback
          operations,  this  flag  will  cause  nix-env  to  print  what <u>would</u> be done if this flag had not been
          specified, without actually doing it.

          --dry-run also prints out which paths will be substituted (i.e., downloaded) and which paths  will  be
          built from source (because no substitute is available).

       •  --system-filter <u>system</u>

          By default, operations such as --query --available show derivations matching any platform. This option
          allows you to use derivations for the specified platform <u>system</u>.

</pre><h4><b>Common</b> <b>Options</b></h4><pre>
       Most Nix commands accept the following command-line options:

       •  --help

          Prints out a summary of the command syntax and exits.

       •  --version

          Prints out the Nix version number on standard output and exits.

       •  --verbose / -v

          Increases  the  level  of  verbosity  of  diagnostic messages printed on standard error.  For each Nix
          operation, the information printed on standard output is well-defined; any diagnostic  information  is
          printed on standard error, never on standard output.

          This option may be specified repeatedly.  Currently, the following verbosity levels exist:

          •  0 “Errors only”

          Only print messages explaining why the Nix invocation failed.

          •  1 “Informational”

          Print <u>useful</u> messages about what Nix is doing.  This is the default.

          •  2 “Talkative”

          Print more informational messages.

          •  3 “Chatty”

          Print even more informational messages.

          •  4 “Debug”

          Print debug information.

          •  5 “Vomit”

          Print vast amounts of debug information.

       •  --quiet

          Decreases  the  level  of  verbosity  of  diagnostic  messages printed on standard error.  This is the
          inverse option to -v / --verbose.

          This option may be specified repeatedly.  See the previous verbosity levels list.

       •  --log-format <u>format</u>

          This option can be used to change the output of the log format, with <u>format</u> being one of:

          •  raw

          This is the raw format, as outputted by nix-build.

          •  internal-json

          Outputs the logs in a structured manner.

                 <b>Warning</b>

                 While the schema itself is relatively stable, the format of the error-messages (namely  of  the
                 msg-field) can change between releases.

          •  bar

          Only display a progress bar during the builds.

          •  bar-with-logs

          Display the raw logs, with the progress bar at the bottom.

       •  --no-build-output / -Q

          By  default,  output  written  by  builders to standard output and standard error is echoed to the Nix
          command’s standard error.  This option suppresses this behaviour.  Note that  the  builder’s  standard
          output and error are always written to a log file in prefix/nix/var/log/nix.

       •  --max-jobs / -j <u>number</u>

          Sets  the  maximum  number  of  build  jobs that Nix will perform in parallel to the specified number.
          Specify auto to use the number of CPUs in the system.   The  default  is  specified  by  the  max-jobs
          configuration  setting,  which  itself  defaults  to 1.  A higher value is useful on SMP systems or to
          exploit I/O latency.

          Setting it to 0 disallows building on the local machine, which is  useful  when  you  want  builds  to
          happen only on remote builders.

       •  --cores

          Sets  the  value  of the NIX_BUILD_CORES environment variable in the invocation of builders.  Builders
          can use this variable at their discretion to control the maximum amount of parallelism.  For instance,
          in Nixpkgs, if the derivation attribute enableParallelBuilding is set to true, the builder passes  the
          -jN  flag  to  GNU  Make.   It  defaults to the value of the cores configuration setting, if set, or 1
          otherwise.  The value 0 means that the builder should use all available CPU cores in the system.

       •  --max-silent-time

          Sets the maximum number of seconds that a builder can go without producing any data on standard output
          or standard error.  The default is specified by the max-silent-time configuration setting.  0 means no
          time-out.

       •  --timeout

          Sets the maximum number of seconds that a builder can run.  The default is specified  by  the  timeout
          configuration setting.  0 means no timeout.

       •  --keep-going / -k

          Keep  going  in case of failed builds, to the greatest extent possible.  That is, if building an input
          of some derivation fails, Nix will still build the  other  inputs,  but  not  the  derivation  itself.
          Without this option, Nix stops if any build fails (except for builds of substitutes), possibly killing
          builds in progress (in case of parallel or distributed builds).

       •  --keep-failed / -K

          Specifies  that  in  case  of  a build failure, the temporary directory (usually in <a href="file:/tmp">/tmp</a>) in which the
          build takes place should not  be  deleted.   The  path  of  the  build  directory  is  printed  as  an
          informational message.

       •  --fallback

          Whenever  Nix attempts to build a derivation for which substitutes are known for each output path, but
          realising the output paths through the substitutes fails, fall back on building the derivation.

          The most common scenario in which this is useful is when we have registered substitutes  in  order  to
          perform  binary  distribution  from,  say,  a  network  repository.   If  the  repository is down, the
          realisation of the derivation will fail.  When this option is specified, Nix will build the derivation
          instead.  Thus, installation from binaries falls back on installation from source.  This option is not
          the default since it is generally not desirable for a transient failure in obtaining  the  substitutes
          to lead to a full build from source (with the related consumption of resources).

       •  --readonly-mode

          When  this  option  is used, no attempt is made to open the Nix database.  Most Nix operations do need
          database access, so those operations will fail.

       •  --arg <u>name</u> <u>value</u>

          This option is accepted by nix-env, nix-instantiate, nix-shell and  nix-build.   When  evaluating  Nix
          expressions, the expression evaluator will automatically try to call functions that it encounters.  It
          can  automatically  call  functions  for  which  every argument has a default value (e.g., { argName ?
          defaultValue }: ...).

          With --arg, you can also call functions that have arguments without a default  value  (or  override  a
          default  value).  That is, if the evaluator encounters a function with an argument named <u>name</u>, it will
          call it with value <u>value</u>.

          For instance, the top-level default.nix in Nixpkgs is actually a function:

       { # The system (e.g., `i686-linux') for which to build the packages.
       system ? builtins.currentSystem
       ...
       }: ...

              So if you call this Nix expression (e.g., when you  do  nix-env  --install  --attr  pkgname),  the
              function  will  be  called  automatically  using  the  value builtins.currentSystem for the system
              argument.  You can override this using --arg, e.g., nix-env --install --attr pkgname --arg  system
              \"i686-freebsd\".   (Note  that since the argument is a Nix string literal, you have to escape the
              quotes.)

       •  --argstr <u>name</u> <u>value</u>

          This option is like --arg, only the value is not a Nix expression but a string.  So instead  of  --arg
          system  \"i686-linux\"  (the  outer  quotes  are  to keep the shell happy) you can say --argstr system
          i686-linux.

       •  --attr / -A <u>attrPath</u>

          Select an attribute from the top-level Nix expression  being  evaluated.   (nix-env,  nix-instantiate,
          nix-build and nix-shell only.)  The <u>attribute</u> <u>path</u> <u>attrPath</u> is a sequence of attribute names separated
          by  dots.   For instance, given a top-level Nix expression <u>e</u>, the attribute path xorg.xorgserver would
          cause the expression e.xorg.xorgserver to be used.  See nix-env --install for some concrete examples.

          In addition to attribute names, you can also specify array indices.  For instance, the attribute  path
          foo.3.bar  selects  the  bar  attribute of the fourth element of the array in the foo attribute of the
          top-level expression.

       •  --expr / -E

          Interpret the command line arguments as a list of Nix expressions to be parsed and  evaluated,  rather
          than as a list of file names of Nix expressions.  (nix-instantiate, nix-build and nix-shell only.)

          For  nix-shell,  this  option is commonly used to give you a shell in which you can build the packages
          returned by the expression.  If you want to get a shell which contain the  <u>built</u>  packages  ready  for
          use, give your expression to the nix-shell --packages convenience flag instead.

       •  -I / --include <u>path</u>

          Add  an  entry  to  the  list  of search paths used to resolve lookup paths.  This option may be given
          multiple times.

          Paths added through -I take  precedence  over  the  nix-path configuration setting  and  the  NIX_PATH
          environment variable.

       •  --option <u>name</u> <u>value</u>

          Set the Nix configuration option <u>name</u> to <u>value</u>.  This overrides settings in the Nix configuration file
          (see nix.conf5).

       •  --repair

          Fix  corrupted  or  missing  store  paths by redownloading or rebuilding them.  Note that this is slow
          because it requires computing a cryptographic hash of the contents of every path in the closure of the
          build.  Also note the warning under nix-store --repair-path.

          <b>Note</b>

          See man nix.conf for overriding configuration settings with command line flags.

</pre><h4><b>Environment</b> <b>variables</b></h4><pre>
       •  NIX_PROFILE

          Location of the Nix profile. Defaults to the target of the symlink <a href="file:~/.nix-profile">~/.nix-profile</a>, if  it  exists,  or
          /nix/var/nix/profiles/default otherwise.

</pre><h4><b>Common</b> <b>Environment</b> <b>Variables</b></h4><pre>
       Most Nix commands interpret the following environment variables:

       •  IN_NIX_SHELL

          Indicator  that  tells if the current environment was set up by nix-shell. It can have the values pure
          or impure.

       •  NIX_PATH

          A colon-separated list of search path entries used to resolve lookup paths.

          This environment variable overrides the value of the nix-path configuration setting.

          It can be extended using the -I option.

                 <b>Example</b>

          $ export NIX_PATH=`/home/eelco/Dev:nixos-config=/etc/nixos

          If NIX_PATH is set to an empty string, resolving search paths will always fail.

                 <b>Example</b>

          $ NIX_PATH= nix-instantiate --eval '&lt;nixpkgs&gt;'
          error: file 'nixpkgs' was not found in the Nix search path (add it using $NIX_PATH or -I)

       •  NIX_IGNORE_SYMLINK_STORE

          Normally, the Nix store directory (typically  /nix/store)  is  not  allowed  to  contain  any  symlink
          components.  This  is to prevent “impure” builds. Builders sometimes “canonicalise” paths by resolving
          all symlink components. Thus, builds on different machines (with  /nix/store  resolving  to  different
          locations)  could  yield  different  results.  This is generally not a problem, except when builds are
          deployed to machines where /nix/store resolves differently. If you are sure that you’re not  going  to
          do that, you can set NIX_IGNORE_SYMLINK_STORE to 1.

          Note  that  if  you’re symlinking the Nix store so that you can put it on another file system than the
          root file system, on Linux you’re better off using bind mount points, e.g.,

       $ mkdir /nix
       $ mount -o bind /mnt/otherdisk/nix /nix

              Consult the mount 8 manual page for details.

       •  NIX_STORE_DIR

          Overrides the location of the Nix store (default prefix/store).

       •  NIX_DATA_DIR

          Overrides the location of the Nix static data directory (default prefix/share).

       •  NIX_LOG_DIR

          Overrides the location of the Nix log directory (default prefix/var/log/nix).

       •  NIX_STATE_DIR

          Overrides the location of the Nix state directory (default prefix/var/nix).

       •  NIX_CONF_DIR

          Overrides the location of the system Nix configuration directory (default prefix/etc/nix).

       •  NIX_CONFIG

          Applies settings from Nix configuration from the environment.  The content is treated  as  if  it  was
          read from a Nix configuration file.  Settings are separated by the newline character.

       •  NIX_USER_CONF_FILES

          Overrides the location of the Nix user configuration files to load from.

          The  default  are  the  locations according to the XDG Base Directory Specification.  See the XDG Base
          Directories sub-section for details.

          The variable is treated as a list separated by the : token.

       •  TMPDIR

          Use the specified directory to store temporary files. In particular,  this  includes  temporary  build
          directories; these can take up substantial amounts of disk space. The default is /tmp.

       •  NIX_REMOTE

          This  variable  should  be  set to daemon if you want to use the Nix daemon to execute Nix operations.
          This is necessary in multi-user Nix installations. If the Nix daemon’s Unix socket  is  at  some  non-
          standard  path,  this  variable  should  be set to unix://path/to/socket. Otherwise, it should be left
          unset.

       •  NIX_SHOW_STATS

          If set to 1, Nix will print some evaluation statistics, such as the number of values allocated.

       •  NIX_COUNT_CALLS

          If set to 1, Nix will print how often functions were called during Nix expression evaluation. This  is
          useful for profiling your Nix expressions.

       •  GC_INITIAL_HEAP_SIZE

          If  Nix has been configured to use the Boehm garbage collector, this variable sets the initial size of
          the heap in bytes. It defaults to 384 MiB. Setting it to a low value reduces memory  consumption,  but
          will increase runtime due to the overhead of garbage collection.

   <b>XDG</b> <b>Base</b> <b>Directories</b>
       Nix follows the XDG Base Directory Specification.

       For  backwards compatibility, Nix commands will follow the standard only when use-xdg-base-directories is
       enabled.  New Nix commands (experimental) conform to the standard by default.

       The following environment variables are used to determine locations of various  state  and  configuration
       files:

       •  [XDG_CONFIG_HOME]{#env-XDG<u>CONFIG</u>HOME} (default <a href="file:~/.config">~/.config</a>)
       •  [XDG_STATE_HOME]{#env-XDG<u>STATE</u>HOME} (default <a href="file:~/.local/state">~/.local/state</a>)
       •  [XDG_CACHE_HOME]{#env-XDG<u>CACHE</u>HOME} (default <a href="file:~/.cache">~/.cache</a>)

</pre><h4><b>Examples</b></h4><pre>
       To install a package using a specific attribute path from the active Nix expression:

       $ nix-env --install --attr gcc40mips
       installing `gcc-4.0.2'
       $ nix-env --install --attr xorg.xorgserver
       installing `xorg-server-1.2.0'

       To install a specific version of gcc using the derivation name:

       $ nix-env --install gcc-3.3.2
       installing `gcc-3.3.2'
       uninstalling `gcc-3.1'

       Using  attribute  path  for  selecting a package is preferred, as it is much faster and there will not be
       multiple matches.

       Note the previously installed version is removed, since --preserve-installed was not specified.

       To install an arbitrary version:

       $ nix-env --install gcc
       installing `gcc-3.3.2'

       To install all derivations in the Nix expression foo.nix:

       $ nix-env --file <a href="file:~/foo.nix">~/foo.nix</a> --install '.*'

       To copy the store path with symbolic name gcc from another profile:

       $ nix-env --install --from-profile /nix/var/nix/profiles/foo gcc

       To install a specific store derivation:

       $ nix-env --install /nix/store/fibjb1bfbpm5mrsxc4mh2d8n37sxh91i-gcc-3.4.3.drv

       To install a specific output path:

       $ nix-env --install /nix/store/y3cgx0xj1p4iv9x0pnnmdhr8iyg741vk-gcc-3.4.3

       To install from a Nix expression specified on the command-line:

       $ nix-env --file ./foo.nix --install --expr \
           'f: (f {system = "i686-linux";}).subversionWithJava'

       I.e., this evaluates to (f: (f {system =  "i686-linux";}).subversionWithJava)  (import  ./foo.nix),  thus
       selecting  the  subversionWithJava  attribute  from  the  set returned by calling the function defined in
       ./foo.nix.

       A dry-run tells you which paths will be downloaded or built from source:

       $ nix-env --file '&lt;nixpkgs&gt;' --install --attr hello --dry-run
       (dry run; not doing anything)
       installing ‘hello-2.10’
       this path will be fetched (0.04 MiB download, 0.19 MiB unpacked):
         /nix/store/wkhdf9jinag5750mqlax6z2zbwhqb76n-hello-2.10
         ...

       To install Firefox from the latest revision in the Nixpkgs/NixOS 14.12 channel:

       $ nix-env --file https://github.com/NixOS/nixpkgs/archive/nixos-14.12.tar.gz --install --attr firefox

                                                                                            <u>nix-env</u> <u>--<a href="../man1/install.1.html">install</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>