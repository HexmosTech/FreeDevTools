<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ampctld - TCP amplifier control daemon</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/libhamlib-utils">libhamlib-utils_4.6.2-1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ampctld - TCP amplifier control daemon

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ampctld</b> [<b>-hlLuV</b>] [<b>-m</b> <u>id</u>] [<b>-r</b> <u>device</u>] [<b>-s</b> <u>baud</u>] [<b>-T</b> <u>IPADDR</u>] [<b>-t</b> <u>number</u>] [<b>-C</b> <u>parm=val</u>] [<b>-v</b>[<b>-Z</b>]]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>ampctld</b>  program  is an amplifier control daemon that handles client requests via TCP sockets.  This
       allows multiple user programs to share one amplifier (this needs more development).  Multiple  amplifiers
       can  be  controlled  on  different  TCP  ports  by use of multiple <b>ampctld</b> processes.  Note that multiple
       processes/ports are also necessary if some clients use extended responses and/or vfo mode.  So  up  to  4
       processes/ports  may  be  needed  for  each combination of extended response/vfo mode.  The syntax of the
       commands are the same as <b><a href="../man1/ampctl.1.html">ampctl</a></b>(1).  It is hoped that  <b>ampctld</b>  will  be  especially  useful  for  client
       authors using languages such as Perl, Python, PHP, and others.

       <b>ampctld</b>  communicates  to  a  client  through  a  TCP socket using text commands shared with <b>ampctl</b>.  The
       protocol is simple, commands are sent to <b>ampctld</b> on one line and <b>ampctld</b> responds to  <b>get</b>  commands  with
       the requested values, one per line, when successful, otherwise, it responds with one line “RPRT x”, where
       ‘x’  is a negative number indicating the error code.  Commands that do not return values respond with the
       line “RPRT x”, where ‘x’ is ‘0’ when successful, otherwise is a  regative  number  indicating  the  error
       code.   Each line is terminated with a newline ‘\n’ character.  This protocol is primarily for use by the
       <b>NET</b> <b>ampctl</b> (amplifier model 2) backend.

       A separate <b>Extended</b> <b>Response</b> <b>Protocol</b> extends the above behavior by echoing the received  command  string
       as  a  header,  any  returned values as a key: value pair, and the “RPRT x” string as the end of response
       marker which includes the <b>Hamlib</b> success or  failure  value.   See  the  <b>PROTOCOL</b>  section  for  details.
       Consider using this protocol for clients that will interact with <b>ampctld</b> directly through a TCP socket.

       Keep  in  mind  that  Hamlib  is  BETA  level  software.   While a lot of backend libraries lack complete
       amplifier support, the basic functions are usually well supported.

       Please report bugs and provide feedback at the e-mail address given in the <b>BUGS</b> section  below.   Patches
       and code enhancements sent to the same address are welcome.

</pre><h4><b>OPTIONS</b></h4><pre>
       This program follows the usual GNU command line syntax.  Short options that take an argument may have the
       value follow immediately or be separated by a space.  Long options starting with two dashes (‘-’) require
       an ‘=’ between the option and any argument.

       Here is a summary of the supported options:

       <b>-m</b>, <b>--model</b>=<u>id</u>
              Select amplifier model number.

              See model list (use “ampctl -l”).

              <b>Note</b>:  <b>ampctl</b>  (or third party software using the C API) will use amplifier model 2 for <b>NET</b> <b>ampctl</b>
              (communicating with <b>ampctld</b>).

       <b>-r</b>, <b>--amp-file</b>=<u>device</u>
              Use <u>device</u> as the file name of the port connected to the amplifier.

              Often a serial port, but could be a USB to  serial  adapter.   Typically  <u>/dev/ttyS0</u>,  <u>/dev/ttyS1</u>,
              <u>/dev/ttyUSB0</u>,  etc.  on  Linux, <u>COM1</u>, <u>COM2</u>, etc. on MS Windows.  The BSD flavors and Mac OS/X have
              their own designations.  See your system's documentation.

       <b>-s</b>, <b>--serial-speed</b>=<u>baud</u>
              Set serial speed to <u>baud</u> rate.

              Uses maximum serial speed from amplifier backend capabilities (set by <b>-m</b> above) as the default.

       <b>-t</b>, <b>--port</b>=<u>number</u>
              Use <u>number</u> as the TCP listening port.

              The default is 4531.

              <b>Note</b>: As <b>rigctld</b>'s default port is 4532 and <b>rotctld</b>'s default port is 4533, it is  recommended  to
              use DESCENDING odd numbered ports for multiple <b>ampctld</b> instances, e.g. 4529, 4527, 4525, etc.

       <b>-T</b>, <b>--listen-addr</b>=<u>IPADDR</u>
              Use <u>IPADDR</u> as the listening IP address.

              The default is ANY.

       <b>-L</b>, <b>--show-conf</b>
              List all config parameters for the amplifier defined with <b>-m</b> above.

       <b>-C</b>, <b>--set-conf</b>=<u>parm=val</u>[<u>,parm=val</u>]
              Set amplifier configuration parameter(s), e.g.  <u>stop_bits=2</u>.

              Use the <b>-L</b> option above for a list of configuration parameters for a given model number.

       <b>-u</b>, <b>--dump-caps</b>
              Dump capabilities for the amplifier defined with <b>-m</b> above and exit.

       <b>-l</b>, <b>--list</b>
              List all amplifier model numbers defined in <b>Hamlib</b> and exit.

              The list is sorted by model number.

              <b>Note</b>:  In  Linux  the  list  can  be scrolled back using <b>Shift-PageUp</b>/<b>Shift-PageDown</b>, or using the
              scrollbars of a virtual terminal in X or the cmd window in Windows.  The output can  be  piped  to
              <b><a href="../man1/more.1.html">more</a></b>(1) or <b><a href="../man1/less.1.html">less</a></b>(1), e.g. “ampctl -l | more”.

       <b>-v</b>, <b>--verbose</b>
              Set verbose mode, cumulative (see <b>DIAGNOSTICS</b> below).

       <b>-Z</b>, <b>--debug-time-stamps</b>
              Enable time stamps for the debug messages.

              Use only in combination with the <b>-v</b> option as it generates no output on its own.

       <b>-h</b>, <b>--help</b>
              Show a summary of these options and exit.

       <b>-V</b>, <b>--version</b>
              Show version of <b>ampctl</b> and exit.

       <b>Note</b>:  Some  options  may  not  be implemented by a given backend and will return an error.  This is most
       likely to occur with the <b>--set-conf</b> and <b>--show-conf</b> options.

       Please note that the backend for the amplifier to be controlled, or the amplifier itself may not  support
       some commands.  In that case, the operation will fail with a <b>Hamlib</b> error code.

</pre><h4><b>COMMANDS</b></h4><pre>
       Commands  can  be  sent  over  the TCP socket either as a single char, or as a long command name plus the
       value(s) space separated on one ‘\n’ terminated line. See <b>PROTOCOL</b>.

       Since most of the <b>Hamlib</b> operations have a <b>set</b> and a <b>get</b> method, an upper case letter will  be  used  for
       <b>set</b>  methods  whereas  the corresponding lower case letter refers to the <b>get</b> method.  Each operation also
       has a long name; prepend a backslash, ‘\’, to send a long command name.

       Example (Perl): “print $socket "\\dump_caps\n";” to see what the amplifier's backend  can  do  (<b>Note</b>:  In
       Perl  and many other languages a ‘\’ will need to be escaped with a preceding ‘\’ so that even though two
       backslash characters appear in the code, only one will be passed to <b>ampctld</b>.  This  is  a  possible  bug,
       beware!).

       <b>Note</b>:  The  backend  for  the  amplifier  to  be controlled, or the amplifier itself may not support some
       commands. In that case, the operation will fail with a <b>Hamlib</b> error message.

       Here is a summary of the supported commands (In the case of <b>set</b> commands the quoted italicized string  is
       replaced  by  the  value in the description.  In the case of <b>get</b> commands the quoted italicized string is
       the key name of the value returned.):

       <b>F</b>, <b>set_freq</b> '<u>Frequency</u>'
              Set '<u>Frequency</u>', in Hz.

              Frequency may be a floating point or integer value.

       <b>f</b>, <b>get_freq</b>
              Get '<u>Frequency</u>', in Hz.

              Returns an integer value.

       <b>l</b>, <b>get_level</b> '<u>Level</u>'
              Get '<u>Level</u> <u>Value</u>'.

              Returns Level Value as a float or integer for the Level token given.

              <b>Note</b>: Passing a ‘?’ (query) as the first argument instead of a Level token  will  return  a  space
              separated  list  of  amplifier  backend  supported  get  level  tokens.  Use this to determine the
              supported levels of a given amplifier backend.

       <b>dump_state</b>
              Return certain state information about the amplifier backend.

       <b>1</b>, <b>dump_caps</b>
              Not a real amplifier remote command, it just dumps capabilities, i.e. what the backend knows about
              this model, and what it can do.

              TODO: Ensure this is in a consistent format so it can be read into a hash, dictionary,  etc.   Bug
              reports requested.

              <b>Note</b>:  This  command  will produce many lines of output so be very careful if using a fixed length
              array!  For example, running this command against the Dummy backend results in a number  of  lines
              of text output.

       <b>_</b>, <b>get_info</b>
              Return information from the amplifier backend.

       <b>R</b>, <b>reset</b> '<u>Reset</u>'
              Perform amplifier '<u>Reset</u>'.

              Reset  is  an  integer  value:  ‘0’ = None, ‘1’ = Memory reset, ‘2’ = Fault reset, ‘3’ = Amplifier
              reset.

       <b>set_powerstat</b> '<u>Power</u> <u>Status</u>'
              Set '<u>Power</u> <u>Status</u>'.

              Power Status is an integer value: ‘0’ = Power Off, ‘1’ = Power On,  ‘2’  =  Power  Standby  (enter
              standby), ‘4’ = Power Operate (leave standby).

       <b>get_powerstat</b>
              Get '<u>Power</u> <u>Status</u>' as in <b>set_powerstat</b> above.

</pre><h4><b>PROTOCOL</b></h4><pre>
       There are two protocols in use by <b>ampctld</b>, the <b>Default</b> <b>Protocol</b> and the <b>Extended</b> <b>Response</b> <b>Protocol</b>.

       The  <b>Default</b>  <b>Protocol</b>  is  intended primarily for the communication between <b>Hamlib</b> library functions and
       <b>ampctld</b> (“NET ampctl”, available using amplifier model ‘2’).

       The <b>Extended</b> <b>Response</b> <b>Protocol</b> is intended to be used with scripts or other programs interacting directly
       with <b>ampctld</b> as consistent feedback is provided.

   <b>Default</b> <b>Protocol</b>
       The <b>Default</b> <b>Protocol</b> is intentionally simple.  Commands are entered on a  single  line  with  any  needed
       values.   In  practice,  reliable  results are obtained by terminating each command string with a newline
       character, ‘\n’.

       Example set frequency and mode commands (Perl code (typed text shown in bold)):

           <b>print</b> <b>$socket</b> <b>"F</b> <b>14250000\n";</b>
           <b>print</b> <b>$socket</b> <b>"\\set_powerstat</b> <b>1\n";</b> # escape leading '\'

       A one line response will be sent as a reply to <b>set</b> commands, “RPRT <u>x</u>\n” where <u>x</u> is the Hamlib error  code
       with ‘0’ indicating success of the command.

       Responses  from  <b>ampctld</b> <b>get</b> commands are text values and match the same tokens used in the <b>set</b> commands.
       Each value is returned on its own line.  On error the string “RPRT <u>x</u>\n” is returned where <u>x</u> is the Hamlib
       error code.

       Example get frequency (Perl code):

           <b>print</b> <b>$socket</b> <b>"f\n";</b>
           "14250000\n"

       Most <b>get</b> functions return one to three values. A notable exception is the <b>dump_caps</b> command which returns
       many lines of <b>key</b>:<u>value</u> pairs.

       This protocol is primarily used by the “NET ampctl” (ampctl model 2) backend  which  allows  applications
       already written for Hamlib's C API to take advantage of <b>ampctld</b> without the need of rewriting application
       code.   An  application's  user  can select amplifier model 2 (“NET ampctl”) and then set <b>amp_pathname</b> to
       “localhost:4531” or other network <u>host</u>:<u>port</u> (set by the <b>-T</b>/<b>-t</b> options, respectively, above).

   <b>Extended</b> <b>Response</b> <b>Protocol</b>
       The Extended Response protocol adds several rules to the strings returned by <b>ampctld</b> and adds a rule  for
       the command syntax.

       1. The command received by <b>ampctld</b> is echoed with its long command name followed by the value(s) (if any)
       received  from  the  client  terminated  by  the  specified response separator as the first record of the
       response.

       2. The last record of each block is the string “RPRT <u>x</u>\n” where <u>x</u> is the  numeric  return  value  of  the
       Hamlib backend function that was called by the command.

       3.  Any  records  consisting  of  data values returned by the amplifier backend are prepended by a string
       immediately followed by a colon then a space and then the value terminated  by  the  response  separator.
       e.g. “Frequency: 14250000\n” when the command was prepended by ‘+’.

       4. All commands received will be acknowledged by <b>ampctld</b>
        with  records  from  rules  1  and  2.   Records  from rule 3 are only returned when data values must be
       returned to the client.

       4. All commands received will be acknowledged by <b>ampctld</b> with records from rules 1 and 2.   Records  from
       rule 3 are only returned when data values must be returned to the client.

       An example response to a <b>set_frequency</b> command sent from the shell prompt (note the prepended ‘+’):

           $ <b>echo</b> <b>"+F</b> <b>14250000"</b> <b>|</b> <b>nc</b> <b>-w</b> <b>1</b> <b>localhost</b> <b>4531</b>
           set_freq: 14250000
           RPRT 0

       In this case the long command name and values are returned on the first line and the second line contains
       the end of block marker and the numeric amplifier backend return value indicating success.

       An example response to a <b>get_freq</b> query:

           $ <b>echo</b> <b>"+\get_freq"</b> <b>|</b> <b>nc</b> <b>-w</b> <b>1</b> <b>localhost</b> <b>4531</b>
           get_freq:
           Frequency(Hz): 14250000
           RPRT 0

              <b>Note</b>: The ‘\’ is still required for the long command name even with the ERP character.

       In  this  case,  as no value is passed to <b>ampctld</b>, the first line consists only of the long command name.
       The final line shows that the command was processed successfully by the amplifier backend.

       Invoking the Extended Response Protocol requires prepending a command with a punctuation  character.   As
       shown  in  the  examples  above, prepending a ‘+’ character to the command results in the responses being
       separated by a newline character (‘\n’).  Any other punctuation character recognized by the  C  <b>ispunct</b>()
       function  except  ‘\’,  ‘?’,  or  ‘_’  will cause that character to become the response separator and the
       entire response will be on one line.

       Separator character summary:

       ‘<b>+</b>’    Each record of the response is appended with a newline (‘\n’).

       ‘<b>;</b>’, ‘<b>|</b>’, or, ‘<b>,</b>’
              Each record of the response is appended by the given character resulting in entire response on one
              line.

              These are common record separators for text representations of spreadsheet data, etc.

       ‘<b>?</b>’    Reserved for help in <b>ampctl</b>.

       ‘<b>_</b>’    Reserved for <b>get_info</b> short command

       ‘<b>#</b>’    Reserved for comments when reading a command file script.

              <b>Note</b>: Other punctuation characters have not been tested!  Use at your own risk.

       For example, invoking a <b>get_freq</b> query with a leading ‘;’ returns:

           get_freq:;Frequency(Hz): 14250000;RPRT 0

       Or, using the pipe character ‘|’ returns:

           get_freq:|Frequency(Hz): 14250000|RPRT 0

       And a <b>set_freq</b> command prepended with a ‘|’ returns:

           set_freq: 14250000|RPRT 0

       Such a format will allow reading a response as a single  event  using  a  preferred  response  separator.
       Other punctuation characters have not been tested!

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       The  <b>-v</b>, <b>--verbose</b> option allows different levels of diagnostics to be output to <b>stderr</b> and correspond to
       -v for <b>BUG</b>, -vv for <b>ERR</b>, -vvv for <b>WARN</b>, -vvvv for <b>VERBOSE</b>, or -vvvvv for <b>TRACE</b>.

       A given verbose level is useful for providing needed debugging information to the  email  address  below.
       For  example,  TRACE output shows all of the values sent to and received from the amplifier which is very
       useful for amplifier backend library development and may be requested by the developers.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Start <b>ampctld</b> for an Elecraft KPA-1500 using a USB-to-serial adapter and backgrounding:

           $ <b>ampctld</b> <b>-m</b> <b>201</b> <b>-r</b> <b>/dev/ttyUSB1</b> <b>&amp;</b>

       Start <b>ampctld</b> for an Elecraft KPA-1500 using COM2 on MS Windows:

           $ <b>ampctld</b> <b>-m</b> <b>201</b> <b>-r</b> <b>COM2</b>

       Connect to the already running <b>ampctld</b> and set the frequency to 14.266 MHz with a 1 second  read  timeout
       using the default protocol from the shell prompt:

           $ <b>echo</b> <b>"\set_freq</b> <b>14266000"</b> <b>|</b> <b>nc</b> <b>-w</b> <b>1</b> <b>localhost</b> <b>4531</b>

       Connect to a running <b>ampctld</b> with <b>ampctl</b> on the local host:

           $ <b>ampctl</b> <b>-m2</b>

</pre><h4><b>SECURITY</b></h4><pre>
       No  authentication  whatsoever;  DO  NOT  leave  this  TCP port open wide to the Internet.  Please ask if
       stronger security is needed or consider using a Secure Shell (<b><a href="../man1/ssh.1.html">ssh</a></b>(1)) tunnel.

       As <b>ampctld</b> does not need any greater permissions than <b>ampctl</b>, it is advisable to  not  start  <b>ampctld</b>  as
       “root” or another system user account in order to limit any vulnerability.

</pre><h4><b>BUGS</b></h4><pre>
       The daemon is not detaching and backgrounding itself.

       No method to exit the daemon so the <b><a href="../man1/kill.1.html">kill</a></b>(1) command must be used to terminate it.

       Multiple clients using the daemon may experience contention with the connected amplifier.

       Report bugs to:

              Hamlib Developer mailing list

</pre><h4><b>COPYING</b></h4><pre>
       This file is part of Hamlib, a project to develop a library that simplifies radio, rotator, and amplifier
       control functions for developers of software primarily of interest to radio amateurs and those interested
       in radio communications.

       Copyright © 2000-2010 Stephane Fillod
       Copyright © 2000-2018 the Hamlib Group (various contributors)
       Copyright © 2011-2020 Nate Bargmann

       This  is  free software; see the file COPYING for copying conditions.  There is NO warranty; not even for
       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/kill.1.html">kill</a></b>(1), <b><a href="../man1/ampctl.1.html">ampctl</a></b>(1), <b><a href="../man1/ssh.1.html">ssh</a></b>(1), <b><a href="../man7/hamlib.7.html">hamlib</a></b>(7)

</pre><h4><b>COLOPHON</b></h4><pre>
       Links to the Hamlib Wiki, Git repository, release archives, and daily snapshot archives are available via
       hamlib.org.

Hamlib                                             2020-09-09                                         <u><a href="../man1/AMPCTLD.1.html">AMPCTLD</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>