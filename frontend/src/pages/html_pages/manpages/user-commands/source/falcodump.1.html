<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>falcodump - Dump log data to a file using a Falco source plugin.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/wireshark-common">wireshark-common_4.4.7-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       falcodump - Dump log data to a file using a Falco source plugin.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>Common</b> <b>options</b>
       <b>falcodump</b> [ <b>--help</b> ] [ <b>--version</b> ] [ <b>--plugin-api-version</b> ] [ <b>--extcap-interfaces</b> ] [ <b>--extcap-dlts</b> ]
       [ <b>--extcap-interface</b>=&lt;interface&gt; ] [ <b>--extcap-config</b> ] [ <b>--extcap-capture-filter</b>=&lt;capture filter&gt; ]
       [ <b>--capture</b> ] [ <b>--fifo</b>=&lt;path to file or pipe&gt; ] [ <b>--plugin-source</b>=&lt;source path or URL&gt; ]
       [ <b>--log-level</b>=&lt;log level&gt; ] [ <b>--log-file</b>=&lt;path to file&gt; ]

       <b>System</b> <b>call</b> <b>options</b>
       [ <b>--include-capture-processes=&lt;TRUE</b> <b>or</b> <b>FALSE&gt;</b> <b>]</b> <b>[</b> --include-switch-calls=&lt;TRUE or FALSE&gt; ]

       <b>CloudTrail</b> <b>plugin</b> <b>options</b>
       [ <b>--cloudtrail-s3downloadconcurrency</b>=&lt;number of concurrent downloads&gt; ]
       [ <b>--cloudtrail-s3interval</b>=&lt;timeframe&gt; ] [ <b>--cloudtrail-s3accountlist</b>=&lt;comma separated account IDs&gt; ]
       [ <b>--cloudtrail-sqsdelete</b>=&lt;true or false&gt; ] [ <b>--cloudtrail-useasync</b>=&lt;true or false&gt; ]
       [ <b>--cloudtrail-uses3sns</b>=&lt;true or false&gt; ] [ <b>--cloudtrail-aws-region</b>=&lt;AWS region&gt; ]
       [ <b>--cloudtrail-aws-profile</b>=&lt;AWS profile&gt; ] [ <b>--cloudtrail-aws-config</b>=&lt;path&gt; ]
       [ <b>--cloudtrail-aws-credentials</b>=&lt;path to file&gt; ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>falcodump</b> is an extcap tool that allows one to capture log messages from cloud providers.

       Each plugin is listed as a separate interface. For example, the AWS CloudTrail plugin is listed as
       “cloudtrail”.

</pre><h4><b>OPTIONS</b></h4><pre>
       --help
           Print program arguments. This will also list the configuration arguments for each plugin.

       --version
           Print the program version.

       --plugin-api-version
           Print the Falco plugin API version.

       --extcap-interfaces
           List the available interfaces.

       --extcap-interface=&lt;interface&gt;
           Use the specified interface.

       --extcap-dlts
           List the DLTs of the specified interface.

       --extcap-config
           List the configuration options of specified interface.

       --extcap-capture-filter=&lt;capture filter&gt;
           The capture filter. Must be a valid Sysdig / Falco filter.

       --capture
           Start capturing from the source specified by --plugin-source via the specified interface and write
           raw packet data to the location specified by --fifo.

       --fifo=&lt;path to file or pipe&gt;
           Save captured packet to file or send it through pipe.

       --plugin-source=&lt;source path or URL&gt;
           Capture from the specified location.

       --log-level
           Set the log level

       --log-file
           Set a log file to log messages in addition to the console

</pre><h4><b>SYSTEM</b> <b>CALL</b> <b>OPTIONS</b></h4><pre>
       --include-capture-processes
           Include system calls for capture processes (falcodump, dumpcap, and Logray) if TRUE. Defaults to
           FALSE.

       --include-switch-calls
           Include "switch" calls if TRUE. Defaults to FALSE.

</pre><h4><b>PLUGINS</b></h4><pre>
   <b>cloudtrail</b> <b>(AWS</b> <b>CloudTrail)</b>
       --cloudtrail-s3downloadconcurrency
           Controls the number of background goroutines used to download S3 files (Default: 32)

       --cloudtrail-s3interval
           Download log files over the specified interval (Default: no interval)

       --cloudtrail-s3accountlist
           If source is an organization CloudTrail S3 bucket download log files for all specified account IDs
           (Default: no account IDs)

       --cloudtrail-sqsdelete
           If true then the plugin will delete SQS messages from the queue immediately after receiving them
           (Default: true)

       --cloudtrail-useasync
           If true then async extraction optimization is enabled (Default: true)

       --cloudtrail-uses3sns
           If true then the plugin will expect SNS messages to originate from S3 instead of directly from
           Cloudtrail (Default: false)

       --cloudtrail-aws-profile
           If non-empty overrides the AWS shared configuration profile (e.g. 'default') and environment
           variables such as AWS_PROFILE (Default: empty)

       --cloudtrail-aws-region
           If non-empty overrides the AWS region specified in the profile (e.g. 'us-east-1') and environment
           variables such as AWS_REGION (Default: empty)

       --cloudtrail-aws-config
           If non-empty overrides the AWS shared configuration filepath (e.g. <a href="file:~/.aws/config">~/.aws/config</a>) and env variables
           such as AWS_CONFIG_FILE (Default: empty)

       --cloudtrail-aws-credentials
           If non-empty overrides the AWS shared credentials filepath (e.g. <a href="file:~/.aws/credentials">~/.aws/credentials</a>) and env
           variables such as AWS_SHARED_CREDENTIALS_FILE (Default: empty)

       CloudTrail sources can be S3 buckets or SQS queue URLs. S3 bucket URLs have the form

       's3://<u>bucket_name</u>/<u>prefix</u>/AWSLogs/<u>account-id</u>/CloudTrail/<u>region</u>/<u>year</u>/<u>month</u>/<u>day</u>'

       For organization CloudTrail the S3 bucket URL can be

       's3://<u>bucket_name</u>/<u>prefix</u>/AWSLogs/<u>org-id</u>/<u>account-id</u>/CloudTrail/<u>region</u>/<u>year</u>/<u>month</u>/<u>day</u>'

       The <u>region</u>, <u>year</u>, <u>month</u>, and <u>day</u> components can be omitted in order to fetch more or less data. For
       example, the source 's3://mybucket/AWSLogs/012345678/CloudTrail/us-west-2/2023' will fetch all CloudWatch
       logs for the year 2023.

       If the URL ends with '<u>account-id</u>/' or '<u>account-id</u>/CloudTrail/' (for example
       's3://mybucket/AWSLOGS/012345678912/') the option '--cloudtrail-s3interval' can be used to define the
       time frame. A s3interval of '1d' for example would get all events of the last 24 hours from all available
       regions. A s3interval of '2w-1w' would get all events from all regions from two weeks ago up to one week
       ago. The s3invterval can also be defined as a RFC 3339-style timestamp like '2024-02-29T18:07:17Z' or
       '2024-02-29T00:00:00Z-2024-03-01T23:59:59Z'.

       If the URL ends with 'AWSLogs/<u>org-id</u>' option '--cloudtrail-s3accountlist' can be used to specify account
       IDs. This can be combined with '--cloudtrail-s3interval'. A source like
       's3://my-org-bucket/AWSLogs/o-123abc/' with '--cloudstrail-s3accountlist' set to
       '123456789012,987654321098' and '--cloudtrail-s3interval' set to '30m' would get all events of the last
       30min from all regions for accounts 123456789012 and 987654321098.

       If source URL is the organization CloudTrail bucket (like 's3://my-org-bucket/AWSLogs/o-123abc') and
       '--s3accountlist' is not set the plugin iterates over all accounts (limited by '--s3interval' if set).
       Attention: Depending on the size of the organization and the time interval, this can take a long time.

       The cloudtrail plugin uses the AWS SDK for Go, which can obtain profile, region, and credential settings
       from a set of standard environment variables and configuration files
       &lt;https://aws.github.io/aws-sdk-go-v2/docs/configuring-sdk/&gt;. Falcodump will show a list of locally
       configured profiles and the current regions, and will let you supply a custom value as well.

       More information is available in the README
       &lt;https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/README.md&gt; of the CloudTrail
       plugin.

</pre><h4><b>EXAMPLES</b></h4><pre>
       To see program arguments:

           falcodump --help

       To see program version:

           falcodump --version

       To see interfaces:

           falcodump --extcap-interfaces

       Only one interface (falcodump) is supported.

       <b>Example</b> <b>output</b>

           interface {value=cloudtrail}{display=Falco plugin}

       To see interface DLTs:

           falcodump --extcap-interface=cloudtrail --extcap-dlts

       <b>Example</b> <b>output</b>

           dlt {number=147}{name=cloudtrail}{display=USER0}

       To see interface configuration options:

           falcodump --extcap-interface=cloudtrail --extcap-config

       <b>Example</b> <b>output</b>

           arg {number=0}{call=--plugin-source}{display=Plugin source}{type=string}{tooltip=The plugin data source. This us usually a URL.}{placeholder=Enter a source URL…}{required=true}{group=Capture}
           arg {number=1}{call=cloudtrail-s3downloadconcurrency}{display=s3DownloadConcurrency}{type=integer}{default=1}{tooltip=Controls the number of background goroutines used to download S3 files (Default: 1)}{group=Capture}
           arg {number=2}{call=cloudtrail-sqsdelete}{display=sqsDelete}{type=boolean}{default=true}{tooltip=If true then the plugin will delete sqs messages from the queue immediately after receiving them (Default: true)}{group=Capture}
           arg {number=3}{call=cloudtrail-useasync}{display=useAsync}{type=boolean}{default=true}{tooltip=If true then async extraction optimization is enabled (Default: true)}{group=Capture}

       To capture AWS CloudTrail events from an S3 bucket:

           falcodump --extcap-interface=cloudtrail --fifo=/tmp/cloudtrail.pcap --plugin-source=s3://aws-cloudtrail-logs.../CloudTrail/us-east-2/... --capture

       or:

           falcodump --capture --extcap-interface cloudtrail --fifo <a href="file:~/cloudtrail.pcap">~/cloudtrail.pcap</a> --plugin-source s3://my-cloudtrail-bucket/AWSLogs/o-abc12345/123456789012/ --cloudtrail-s3downloadconcurrency 32 --cloudtrail-s3interval 5d-2d --cloudtrail-aws-region eu-west-1

           <b>Note</b>

           CTRL + C should be used to stop the capture in order to ensure clean termination.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/wireshark.1.html">wireshark</a>(1), <a href="../man1/tshark.1.html">tshark</a>(1), <a href="../man1/dumpcap.1.html">dumpcap</a>(1), <a href="../man4/extcap.4.html">extcap</a>(4)

</pre><h4><b>NOTES</b></h4><pre>
       <b>falcodump</b> is part of the <b>Logray</b> distribution. The latest version of <b>Logray</b> can be found at
       https://www.wireshark.org.

       HTML versions of the Wireshark project man pages are available at
       https://www.wireshark.org/docs/man-pages.

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>Original</b> <b>Author</b>
       Gerald Combs &lt;gerald[AT]wireshark.org&gt;

                                                   2025-06-10                                       <u><a href="../man1/FALCODUMP.1.html">FALCODUMP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>