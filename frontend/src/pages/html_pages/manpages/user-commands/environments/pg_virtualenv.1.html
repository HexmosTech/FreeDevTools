<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pg_virtualenv - Create a throw-away PostgreSQL environment for running regression tests</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/postgresql-common">postgresql-common_274_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pg_virtualenv - Create a throw-away PostgreSQL environment for running regression tests

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pg_virtualenv</b> [<u>OPTIONS</u>] [<b>-v</b> '<u>version</u> <u>...</u>'] [<u>command</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>pg_virtualenv</b> creates a virtual PostgreSQL server environment, and sets environment variables such that
       <u>command</u> can access the PostgreSQL database server(s). The servers are destroyed when <u>command</u> exits.

       The environment variables <b>PGHOST</b>, <b>PGDATABASE</b>, <b>PGUSER</b>, and <b>PGPASSWORD</b> will be set. Per default, a single
       new cluster is created, using the newest PostgreSQL server version installed. The cluster will use the
       first available port number starting from <b>5432</b>, and <b>PGPORT</b> will be set.  <b>PGVERSION</b> is set the the
       PostgreSQL major version number.

       When clusters for more than one versions are created, they will differ in the port number used, and
       <b>PGPORT</b> and <b>PGVERSION</b> are not set. The clusters are named <u>version</u>/regress. To access a cluster, set
       <b>PGCLUSTER=</b><u>version</u><b>/regress</b>. For ease of access, the clusters are also registered in
       <u>/etc/postgresql-common/pg_service.conf</u>, with the version number as cluster name. Clusters can be accessed
       by passing the connection string "<b>service=</b><u>version</u>", e.g. <b>psql</b> <b>service=9.2</b>.

       When invoked as root, the clusters are created in <u>/etc/postgresql/</u> as usual; for other users,
       <b>PG_CLUSTER_CONF_ROOT</b> and <b>PGSYSCONFDIR</b> are set to a temporary directory where all files belonging to the
       clusters are created.

       If <u>command</u> fails, the tail of the PostgreSQL server log is shown.  Additionally, if <b>gdb</b> is available, the
       backtrace from any PostgreSQL coredump is show.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b>  Use all PostgreSQL server versions installed.

       <b>-v</b> <u>version</u> <u>...</u>
           Use these versions (space-separated list).

       <b>-c</b> <u>pg_createcluster</u> <u>options</u>
           Extra options to pass to <b>pg_createcluster</b>.

       <b>-i</b> <u>initdb</u> <u>options</u>
           Extra initdb options to pass to <b>pg_createcluster</b>.

       <b>-o</b> <u>guc</u><b>=</b><u>value</u>
           Configuration option to set in the postgresql.conf file, passed to <b>pg_createcluster</b>.

       <b>-p</b> <u>package</u>
           Set <b>extension_destdir</b> and <b>dynamic_library_path</b> in cluster to enable loading and testing extensions at
           build-time from <b>debian/</b><u>package</u><b>/</b>.

           This is a Debian-specific PostgreSQL patch.

       <b>-s</b>  Launch a shell inside the virtual environment when <u>command</u> fails.

       <b>-t</b>  Install clusters in a temporary directory, even when running as root.

       <b>-h</b>  Show program help.

</pre><h4><b>EXAMPLE</b></h4><pre>
         # pg_virtualenv make check

</pre><h4><b>NOTES</b></h4><pre>
       When  run  with  <b><a href="../man1/fakeroot.1.html">fakeroot</a></b>(1),  <b>pg_virtualenv</b>  will  fall  back to the non-root mode of operation. Running
       "fakeroot pg_virtualenv" as root will fail, though.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       <b>PG_VIRTUALENV_NEWPID</b>=yes
           When non-empty, <b>pg_virtualenv</b> will re-exec itself using <b><a href="../man1/newpid.1.html">newpid</a></b>(1).

       <b>PG_VIRTUALENV_UNSHARE</b>=<u>flags</u>
           When non-empty, <b>pg_virtualenv</b> will re-exec itself using <b><a href="../man1/unshare.1.html">unshare</a></b>(1) using these flags.

       <b>PGPORT</b>=<u>n</u>
           When set, the value is used for the (single) cluster created.

</pre><h4><b>COMPATIBILITY</b></h4><pre>
       <b>PGVERSION</b> is set in postgresql-common (&gt;= 219~).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/initdb.1.html">initdb</a></b>(1), <b><a href="../man1/pg_createcluster.1.html">pg_createcluster</a></b>(1).

</pre><h4><b>AUTHOR</b></h4><pre>
       Christoph Berg &lt;<a href="mailto:myon@debian.org">myon@debian.org</a>&gt;

Debian                                             2025-02-20                                   <u><a href="../man1/PG_VIRTUALENV.1.html">PG_VIRTUALENV</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>