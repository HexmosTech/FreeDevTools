<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbdkit-pause-filter - pause NBD requests</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nbdkit">nbdkit_1.42.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nbdkit-pause-filter - pause NBD requests

</pre><h4><b>SYNOPSIS</b></h4><pre>
        nbdkit --filter=pause PLUGIN [PLUGIN-ARGS...] pause-control=SOCKET

</pre><h4><b>DESCRIPTION</b></h4><pre>
       "nbdkit-pause-filter" is a filter for <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1) which can temporarily stop NBD requests from being
       handled by nbdkit, and later resume them.  This filter can be used if you need to take a snapshot of the
       underlying storage.

   <b>Control</b> <b>socket</b>
       The "pause-control" parameter is the name of a Unix domain socket which the filter listens for commands
       on.

       To pause NBD request processing you send character 'p' to the socket.  Any NBD requests received
       afterwards will hang until you resume processing.

       To resume processing you send character 'r' to the socket.

       So you can know when pausing/resuming has taken effect, the filter echos back the character over the
       socket in uppercase (ie. either 'P' or 'R').  When pausing, the 'P' response is not sent until all
       outstanding NBD requests (received before the pause) have been completed.  This usually means the plugin
       is idle, although be aware that it is possible for plugins to create background threads and do work that
       the filter cannot "see".

       Any unknown commands are ignored.  The filter responds with 'X'.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Pick a large file, disk image or ISO, serve it over NBD, and start copying it:

        nbdkit --filter=pause --filter=rate \
          file BIG_FILE.ISO rate=10M pause-control=sock \
               --run 'qemu-img convert -p "$uri" /var/tmp/out'

       To cause the copy to appear to hang, do:

        echo p | nc -U sock

       To resume activity:

        echo r | nc -U sock

</pre><h4><b>PARAMETERS</b></h4><pre>
       <b>pause-control=</b>SOCKET
           The Unix domain socket for controlling the filter.  See "Control socket" above.

</pre><h4><b>NOTES</b></h4><pre>
       If  you  are  connecting a kernel client, virtual machine or similar to nbdkit then only short pauses are
       tolerated, and you will soon get timeout errors.  The timeouts are not generated by nbdkit,  but  by  the
       client itself.

       The pause filter does not flush requests to disk, although this is a possible future enhancement.

       A virtual machine with multiple disks connected through multiple nbdkit instances cannot get a consistent
       snapshot  using  this filter, since even if you send the pause commands to all instances at the same time
       they will be processed at slightly different times (and this can matter if a  virtual  machine  is  doing
       something  like  RAID  across  the  disks).   This  is  not  something that can be solved at the level of
       individual devices, the only way to solve this is at the hypervisor level.

</pre><h4><b>FILES</b></h4><pre>
       <u>$filterdir/nbdkit-pause-filter.so</u>
           The filter.

           Use "nbdkit --dump-config" to find the location of $filterdir.

</pre><h4><b>VERSION</b></h4><pre>
       "nbdkit-pause-filter" first appeared in nbdkit 1.22.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1), <b><a href="../man3/nbdkit-filter.3.html">nbdkit-filter</a></b>(3), <b><a href="../man1/nbdkit-delay-filter.1.html">nbdkit-delay-filter</a></b>(1), <b><a href="../man1/nbdkit-rate-filter.1.html">nbdkit-rate-filter</a></b>(1), <b><a href="../man1/nc.1.html">nc</a></b>(1).

</pre><h4><b>AUTHORS</b></h4><pre>
       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       Redistribution and use in source and binary forms, with or without modification, are  permitted  provided
       that the following conditions are met:

       •   Redistributions  of  source  code must retain the above copyright notice, this list of conditions and
           the following disclaimer.

       •   Redistributions in binary form must reproduce the above copyright notice, this list of conditions and
           the following disclaimer in the documentation and/or other materials provided with the distribution.

       •   Neither the name of Red Hat nor the names of its contributors may  be  used  to  endorse  or  promote
           products derived from this software without specific prior written permission.

       THIS  SOFTWARE  IS  PROVIDED BY RED HAT AND CONTRIBUTORS ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
       INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND  FITNESS  FOR  A  PARTICULAR
       PURPOSE  ARE  DISCLAIMED.  IN  NO EVENT SHALL RED HAT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
       INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,  PROCUREMENT  OF
       SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
       ON  ANY  THEORY  OF  LIABILITY,  WHETHER  IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
       OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
       DAMAGE.

nbdkit-1.42.2                                      2025-04-02                             <u><a href="../man1/nbdkit-pause-filter.1.html">nbdkit-pause-filter</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>