<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>barman-cloud-wal-archive - Barman-cloud Commands</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/barman-cli-cloud">barman-cli-cloud_3.12.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       barman-cloud-wal-archive - Barman-cloud Commands

       <b>Synopsis</b>

          barman-cloud-wal-archive
                          [ { -V | --version } ]
                          [ --help ]
                          [ { -v | --verbose } ]
                          [ { -q | --quiet } ]
                          [ { -t | --test } ]
                          [ --cloud-provider { aws-s3 | azure-blob-storage | google-cloud-storage } ]
                          [ { { -z | --gzip } | { -j | --bzip2 } | --xz | --snappy | --zstd | --lz4 } ]
                          [ --tags [ TAGS ... ] ]
                          [ --history-tags [ HISTORY_TAGS ... ] ]
                          [ --endpoint-url ENDPOINT_URL ]
                          [ { -P | --aws-profile } AWS_PROFILE ]
                          [ --read-timeout READ_TIMEOUT ]
                          [ { -e | --encryption } ENCRYPTION ]
                          [ --sse-kms-key-id SSE_KMS_KEY_ID ]
                          [ --azure-credential { azure-cli | managed-identity } ]
                          [ --encryption-scope ENCRYPTION_SCOPE ]
                          [ --max-block-size MAX_BLOCK_SIZE ]
                          [ --max-concurrency MAX_CONCURRENCY ]
                          [ --max-single-put-size MAX_SINGLE_PUT_SIZE ]
                          [ --kms-key-name KMS_KEY_NAME ]
                          DESTINATION_URL SERVER_NAME [ WAL_PATH ]

       <b>Description</b>

       The  <b>barman-cloud-wal-archive</b>  command is designed to be used in the <b>archive_command</b> of a Postgres server
       to directly ship WAL files to cloud storage.

       <b>NOTE:</b>
          If you are using Python 2 or unsupported versions of Python 3, avoid  using  the  compression  options
          <b>--gzip</b>  or <b>--bzip2</b>. The script cannot restore gzip-compressed WALs on Python &lt; 3.2 or bzip2-compressed
          WALs on Python &lt; 3.3.

       This script enables the direct transfer of WAL files to  cloud  storage,  bypassing  the  Barman  server.
       Additionally, it can be utilized as a hook script for WAL archiving (pre_archive_retry_script).

       <b>NOTE:</b>
          For GCP, only authentication with <b>GOOGLE_APPLICATION_CREDENTIALS</b> env is supported.

       <b>Parameters</b>

       <b>SERVER_NAME</b>
              Name of the server that will have the WALs archived.

       <b>DESTINATION_URL</b>
              URL of the cloud destination, such as a bucket in AWS S3. For example: <b>s3://bucket/path/to/folder</b>.

       <b>WAL_PATH</b>
              The value of the '%p' keyword (according to <b>archive_command</b>).

       <b>-V</b> <b>/</b> <b>--version</b>
              Show version and exit.

       <b>--help</b> show this help message and exit.

       <b>-v</b> <b>/</b> <b>--verbose</b>
              Increase output verbosity (e.g., <b>-vv</b> is more than <b>-v</b>).

       <b>-q</b> <b>/</b> <b>--quiet</b>
              Decrease output verbosity (e.g., <b>-qq</b> is less than <b>-q</b>).

       <b>-t</b> <b>/</b> <b>--test</b>
              Test cloud connectivity and exit.

       <b>--cloud-provider</b>
              The cloud provider to use as a storage backend.

              Allowed options are:

              • <b>aws-s3</b>.

              • <b>azure-blob-storage</b>.

              • <b>google-cloud-storage</b>.

       <b>-z</b> <b>/</b> <b>--gzip</b>
              gzip-compress the WAL while uploading to the cloud (should not be used with python &lt; 3.2).

       <b>-j</b> <b>/</b> <b>--bzip2</b>
              bzip2-compress the WAL while uploading to the cloud (should not be used with python &lt; 3.3).

       <b>--xz</b>   xz-compress the WAL while uploading to the cloud (should not be used with python &lt; 3.3).

       <b>--snappy</b>
              snappy-compress the WAL while uploading to the cloud (requires optional <b>python-snappy</b> library).

       <b>--zstd</b> zstd-compress the WAL while uploading to the cloud (requires optional <b>zstandard</b> library).

       <b>--lz4</b>  lz4-compress the WAL while uploading to the cloud (requires optional <b>lz4</b> library).

       <b>--tags</b> Tags to be added to archived WAL files in cloud storage.

       <b>--history-tags</b>
              Tags to be added to archived history files in cloud storage.

       <b>Extra</b> <b>options</b> <b>for</b> <b>the</b> <b>AWS</b> <b>cloud</b> <b>provider</b>

       <b>--endpoint-url</b>
              Override default S3 endpoint URL with the given one.

       <b>-P</b> <b>/</b> <b>--aws-profile</b>
              Profile name (e.g. <b>INI</b> section in AWS credentials file).

       <b>--profile</b> <b>(deprecated)</b>
              Profile name (e.g. <b>INI</b> section in AWS credentials file) - replaced by <b>--aws-profile</b>.

       <b>--read-timeout</b>
              The  time in seconds until a timeout is raised when waiting to read from a connection (defaults to
              <b>60</b> seconds).

       <b>-e</b> <b>/</b> <b>--encryption</b>
              The encryption algorithm used when storing the uploaded data in S3.

              Allowed options:

              • <b>AES256</b>.

              • <b>aws:kms</b>.

       <b>--sse-kms-key-id</b>
              The AWS KMS key ID that should be used for encrypting the uploaded data in S3.  Can  be  specified
              using  the  key ID on its own or using the full ARN for the key. Only allowed if <b>-e</b> / <b>--encryption</b>
              is set to <b>aws:kms</b>.

       <b>Extra</b> <b>options</b> <b>for</b> <b>the</b> <b>Azure</b> <b>cloud</b> <b>provider</b>

       <b>--azure-credential</b> <b>/</b> <b>--credential</b>
              Optionally specify the type of credential to use when authenticating with Azure. If  omitted  then
              Azure  Blob  Storage  credentials  will  be  obtained  from  the environment and the default Azure
              authentication flow will be  used  for  authenticating  with  all  other  Azure  services.  If  no
              credentials  can  be found in the environment then the default Azure authentication flow will also
              be used for Azure Blob Storage.

              Allowed options are:

              • <b>azure-cli</b>.

              • <b>managed-identity</b>.

       <b>--encryption-scope</b>
              The name of an encryption scope defined in the Azure Blob Storage service which is to be  used  to
              encrypt the data in Azure.

       <b>--max-block-size</b>
              The chunk size to be used when uploading an object via the concurrent chunk method (default: <b>4MB</b>).

       <b>--max-concurrency</b>
              The maximum number of chunks to be uploaded concurrently (default: <b>1</b>).

       <b>--max-single-put-size</b>
              Maximum size for which the Azure client will upload an object in a single request (default: <b>64MB</b>).
              If  this  is  set  lower than the Postgres WAL segment size after any applied compression then the
              concurrent chunk upload method for WAL archiving will be used.

       <b>Extra</b> <b>options</b> <b>for</b> <b>GCP</b> <b>cloud</b> <b>provider</b>

       <b>--kms-key-name</b>
              The name of the GCP KMS key which should be used for encrypting the uploaded data in GCS.

</pre><h4><b>AUTHOR</b></h4><pre>
       EnterpriseDB

</pre><h4><b>COPYRIGHT</b></h4><pre>
       © Copyright EnterpriseDB UK Limited 2011-2024

3.12                                              Dec 09, 2024                       <u><a href="../man1/BARMAN-CLOUD-WAL-ARCHIVE.1.html">BARMAN-CLOUD-WAL-ARCHIVE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>