<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>run — find, execute, and log the results of tests</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/zfs-test">zfs-test_2.3.2-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       run — find, execute, and log the results of tests

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>run</b> [<b>-dgq</b>] [<b>-o</b> <u>outputdir</u>] [<b>-pP</b> <u>script</u>] [<b>-t</b> <b>-seconds</b>] [<b>-uxX</b> <u>username</u>] <u>pathname</u>…

       <b>run</b> <b>-w</b> <u>runfile</u> [<b>-gq</b>] [<b>-o</b> <u>outputdir</u>] [<b>-pP</b> <u>script</u>] [<b>-t</b> <b>-seconds</b>] [<b>-uxX</b> <u>username</u>] <u>pathname</u>…

       <b>run</b> <b>-c</b> <u>runfile</u> [<b>-dq</b>]

       <b>run</b> [<b>-h</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>run</b>  command  has  three  basic  modes of operation.  With neither <b>-c</b> nor <b>-w</b>, <b>run</b> processes the arguments
       provided on the command line, adding them to the list for this  run.   If  a  specified  <u>pathname</u>  is  an
       executable  file,  it  is  added as a test.  If a specified <u>pathname</u> is a directory, the behavior depends
       upon the presence of <b>-g</b>.  If <b>-g</b> is specified, the directory is treated as a test group.  See the  section
       on  <b>Test</b>  <b>Groups</b> below.  Without <b>-g</b>, <b>run</b> simply descends into the directory looking for executable files.
       The tests are then executed, and the results are logged.

       With <b>-w</b>, <b>run</b> finds tests in the manner described above.  Rather than executing the tests and logging  the
       results,  the  test  configuration  is  stored  in a <u>runfile</u>, which can be used in future invocations, or
       edited to modify which tests are executed and which options are applied.  Options included on the command
       line with <b>-w</b> become defaults in the <u>runfile</u>.

       With <b>-c</b>, <b>run</b> parses a <u>runfile</u>, which can specify a series of tests and test groups to be  executed.   The
       tests are then executed, and the results are logged.

   <b>Test</b> <b>Groups</b>
       A test group is comprised of a set of executable files, all of which exist in one directory.  The options
       specified  on  the command line or in a <u>runfile</u> apply to individual tests in the group.  The exception is
       options pertaining to pre and post scripts, which act on all tests  as  a  group.   Rather  than  running
       before and after each test, these scripts are run only once each at the start and end of the test group.

   <b>Test</b> <b>Execution</b>
       The  specified  tests  run  serially, and are typically assigned results according to exit values.  Tests
       that exit zero and non-zero are marked <b>PASS</b> and <b>FAIL</b>, respectively.  When a pre script fails for  a  test
       group,  only  the  post  script  is  executed, and the remaining tests are marked <b>SKIPPED</b>.  Any test that
       exceeds its <u>timeout</u> is terminated, and marked <b>KILLED</b>.

       By default, tests are executed with the credentials of  the  <b>run</b>  script.   Executing  tests  with  other
       credentials  is  done  via  <u><a href="../man1m/sudo.1m.html">sudo</a></u>(1m), which must be configured to allow execution without prompting for a
       password.  Environment variables from the calling shell are available to individual tests.   During  test
       execution, the working directory is changed to <u>outputdir</u>.

   <b>Output</b> <b>Logging</b>
       By default, <b>run</b> will print one line on standard output at the conclusion of each test indicating the test
       name,  result  and  elapsed time.  Additionally, for each invocation of <b>run</b>, a directory is created using
       the ISO 8601 date format.  Within this directory is a file named <b>log</b> containing all the test output  with
       timestamps,  and  a  directory  for  each  test.  Within the test directories, there is one file each for
       standard output,  standard  error  and  merged  output.   The  default  location  for  the  <u>outputdir</u>  is
       <u>/var/tmp/test_results</u>.

   <b>Runfiles</b>
       The <u>runfile</u> is an INI-style configuration file that describes a test run.  The file has one section named
       <b>DEFAULT</b>,  which  contains configuration option names and their values in <b>name</b> = <u>value</u> format.  The values
       in this section apply to all the subsequent sections, unless they are also specified there, in which case
       the default is overridden.  The  remaining  section  names  are  the  absolute  pathnames  of  files  and
       directories, describing tests and test groups respectively.  The legal option names are:

       <b>outputdir</b> = <u>pathname</u>     The name of the directory that holds test logs.

       <b>pre</b> = <u>script</u>             Run <u>script</u> prior to the test or test group.

       <b>pre_user</b> = <u>username</u>      Execute the pre script as <u>username</u>.

       <b>post</b> = <u>script</u>            Run <u>script</u> after the test or test group.

       <b>post_user</b> = <u>username</u>     Execute the post script as <u>username</u>.

       <b>quiet</b> = <b>True</b>|<b>False</b>       If <b>True</b>, only the results summary is printed to standard out.

       <b>tests</b> = [<u>'filename'</u>, …]  Specify  a  list  of  <u>filenames</u>  for  this test group.  Only the basename of the
                                absolute path is required.  This option is only valid for test groups, and  each
                                <u>filename</u> must be single quoted.

       <b>timeout</b> = <u>n</u>              A timeout value of <u>n</u> seconds.

       <b>user</b> = <u>username</u>          Execute the test or test group as <u>username</u>.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-c</b> <u>runfile</u>    Specify a <u>runfile</u> to be consumed by the run command.

       <b>-d</b>            Dry  run mode.  Execute no tests, but print a description of each test that would have been
                     run.

       <b>-m</b>            Enable kmemleak reporting (Linux only)

       <b>-g</b>            Create test groups from any directories found while searching for tests.

       <b>-o</b> <u>outputdir</u>  Specify the directory in which to write test results.

       <b>-p</b> <u>script</u>     Run <u>script</u> prior to any test or test group.

       <b>-P</b> <u>script</u>     Run <u>script</u> after any test or test group.

       <b>-q</b>            Print only the results summary to the standard output.

       <b>-s</b> <u>script</u>     Run <u>script</u> as a failsafe after any test is killed.

       <b>-S</b> <u>username</u>   Execute the failsafe script as <u>username</u>.

       <b>-t</b> <u>n</u>          Specify a timeout value of <u>n</u> seconds per test.

       <b>-u</b> <u>username</u>   Execute tests or test groups as <u>username</u>.

       <b>-w</b> <u>runfile</u>    Specify the name of the <u>runfile</u> to create.

       <b>-x</b> <u>username</u>   Execute the pre script as <u>username</u>.

       <b>-X</b> <u>username</u>   Execute the post script as <u>username</u>.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>Example</b> <b>1</b>: Running ad-hoc tests.
           This example demonstrates the simplest invocation of <b>run</b>.

           % <b>run</b> <u>my-tests</u>
           Test: /home/jkennedy/my-tests/test-01                    [00:02] [PASS]
           Test: /home/jkennedy/my-tests/test-02                    [00:04] [PASS]
           Test: /home/jkennedy/my-tests/test-03                    [00:01] [PASS]

           Results Summary
           PASS       3

           Running Time:   00:00:07
           Percent passed: 100.0%
           Log directory:  /var/tmp/test_results/20120923T180654

       <b>Example</b> <b>2</b>: Creating a <u>runfile</u> for future use.
           This example demonstrates creating a <u>runfile</u> with non-default options.

           % <b>run</b> <b>-p</b> <u>setup</u> <b>-x</b> <u>root</u> <b>-g</b> <b>-w</b> <u>new-tests.run</u> <u>new-tests</u>
           % <b>cat</b> <u>new-tests.run</u>
           [DEFAULT]
           pre = setup
           post_user =
           quiet = False
           user =
           timeout = 60
           post =
           pre_user = root
           outputdir = /var/tmp/test_results

           [/home/jkennedy/new-tests]
           tests = ['test-01', 'test-02', 'test-03']

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1m/sudo.1m.html">sudo</a></u>(1m)

OpenZFS                                           May 26, 2021                                            <u><a href="../man1/RUN.1.html">RUN</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>