<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bmaptool - create block map (bmap) for a file or copy a file using bmap</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/bmap-tools">bmap-tools_3.8.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       bmaptool - create block map (bmap) for a file or copy a file using bmap

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>bmaptool</b> [--help] [--version] [--quiet] [--debug] &lt;command&gt; [&lt;options&gt;] &lt;args&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>bmaptool</u> is a generic tool for creating the block map (bmap) for a file and copying files using the block
       map.  The  idea  is  that large files, like raw system image files, can be copied or flashed a lot faster
       with <u>bmaptool</u> than with traditional tools, like "dd" or "cp".

       <u>bmaptool</u> supports 2 commands:
         1. <b>copy</b> - copy a file to another file using bmap or flash an image to a block device
         2. <b>create</b> - create a bmap for a file

       Please, find full documentation for the project online.

</pre><h4><b>OPTIONS</b></h4><pre>
       --version
         Print <u>bmaptool</u> version and exit.

       -h, --help
         Print short help text and exit.

       -q, --quiet
         Be quiet, do not print extra information.

       -d, --debug
         Print debugging messages.

</pre><h4><b>COMMANDS</b></h4><pre>
   <b>copy</b> [options] IMAGE DEST
         Copy file IMAGE to the destination regular file or block device DEST using bmap. IMAGE may either be  a
         local path or an URL. DEST may either be a regular file or a block device (only local).

         Unless the bmap file is explicitly specified with the "--bmap" option, <u>bmaptool</u> automatically discovers
         it  by looking for a file with the same basename as IMAGE but with the ".bmap" extension. The bmap file
         is only looked for in IMAGE's directory (or base URL, in case IMAGE was specified as an  URL).  If  the
         bmap file is not found, <u>bmaptool</u> fails. To copy without bmap, use the "--nobmap" option.

         Both  IMAGE  and the bmap file may be specified as an URL (http://, ftp://, https://, file://, ssh://).
         In order to  make  <u>bmaptool</u>  use  a  proxy  server,  please,  specify  the  proxy  using  the  standard
         "$http_proxy", "$https_proxy", "$ftp_proxy" or "$no_proxy" environment variables.

         If  the server requires authentication, user name and password may be specified in the URL, for example
         "https://user:<a href="mailto:password@my.server.org">password@my.server.org</a>/image.raw.bz2", or "ssh://user:password@host:path/to/image.raw".

         IMAGE may be compressed, in which case <u>bmaptool</u> decompresses it on-the-fly.  The  compression  type  is
         detected by the file extension and the following extensions are supported:

             1. ".gz", ".gzip", ".tar.gz" and ".tgz" for files and tar archives compressed with "<u>gzip</u>" program
             2.  ".bz2",  "tar.bz2",  ".tbz2",  ".tbz",  and  ".tb2"  for files and tar archives compressed with
             "<u>bzip2</u>" program
             3. ".xz", ".tar.xz", ".txz" for files and tar archives compressed with "<u>xz</u>" program
             4. ".lzo", "tar.lzo", ".tzo" for files and tar archives compressed with "<u>lzo</u>" program
             5. ".lz4", "tar.lz4", ".tlz4" for files and tar archives compressed with "<u>lz4</u>" program
             6. ".zst", "tar.zst", ".tzst" for files and tar archives compressed with "<u>zstd</u>" program

         IMAGE files with other extensions are assumed to be uncompressed.  Note,  <u>bmaptool</u>  uses  "<u>pbzip2</u>"  and
         "<u>pigz</u>"  programs  for  decompressing  bzip2 and gzip archives faster, unless they are not available, in
         which case if falls-back to using "<u>bzip2</u>" and "<u>gzip</u>". Furthermore,  uncompressed  IMAGE  files  can  be
         piped to the standard input using "-".

         If DEST is a block device node (e.g., "/dev/sdg"), <u>bmaptool</u> opens it in exclusive mode. This means that
         it  will  fail  if  any other process has IMAGE block device node opened. This also means that no other
         processes will be able to open IMAGE until <u>bmaptool</u> finishes the copying. Please, see semantics of  the
         "O_EXCL" flag of the "open()" syscall.

         The  bmap  file  typically contains SHA-256 checksum for itself as well as SHA-256 checksum for all the
         mapped data regions, which makes it  possible  to  guarantee  data  integrity.  <u>bmaptool</u>  verifies  the
         checksums  and  exits  with an error in case of a mismatch. Checksum verification can be disabled using
         the "--no-verify" option. <u>bmaptool</u> does not verify that unampped areas  contain  only  zeroes,  because
         these areas are anyway dropped and are not used for anything.

         The  bmap file may be signed with OpenPGP (gpg). The signature may be either detached (a separate file)
         or "built into" the bmap file (so called "clearsign" signature).

         The detached signature can be specified with the  "--bmap-sig"  option,  otherwise  <u>bmaptool</u>  tries  to
         automatically  discover  it  by looking for a file with the same basename as the bmap file but with the
         ".asc" or ".sig" extension.  This is very similar to the bmap file auto-discovery. So if  a  ".asc"  or
         ".sig" file exists, <u>bmaptool</u> will verify the signature.

         The clearsign signature is part of the bmap file and <u>bmaptool</u> automatically detected and verifies it.

         If the signature is bad, <u>bmaptool</u> exits with an error. Bmap file signature verification can be disabled
         using the "--no-sig-verify" option.

         <b>OPTIONS</b>
           -h, --help
             Print short help text about the "copy" command and exit.

           --bmap BMAP
             Use  bmap file "BMAP" for copying. If this option is not specified, <u>bmaptool</u> tries to automatically
             discover the bmap file.

           --bmap-sig SIG
             Use a detached OpenPGP signature file "SIG" for verifying the bmap file integrity and publisher. If
             this option is not specified, <u>bmaptool</u> tries to automatically discover the signature file.

           --nobmap
             Disable automatic bmap file discovery and force flashing entire IMAGE without bmap.

           --no-sig-verify
             Do not verify the OpenPGP bmap file signature (not recommended).

         --no-verify
           Do not verify data checksums when copying (not recommended). The checksums are  stored  in  the  bmap
           file, and normally <u>bmaptool</u> verifies that the data in IMAGE matches the checksums.

         --psplash-pipe PATH
           Write  periodic  machine-readable  progress  reports  to  a  fifo in the format used by <b>psplash</b>. Each
           progress report consists of "PROGRESS" followed by a space, an integer percentage and a newline.

         <b>EXAMPLES</b>
           <u>bmaptool</u> copy image.raw.bz2 /dev/sdg
             Copy bz2-compressed local file "image.raw.bz2" to  block  device  "/dev/sdg".  The  image  file  is
             uncompressed  on-the-fly.  The  bmap  file  is  discovered  automatically. The OpenPGP signature is
             detected/discovered automatically too.

           <u>bmaptool</u> copy <a href="http://my-server.com/files/image.raw.bz2">http://my-server.com/files/image.raw.bz2</a> $HOME/tmp/file
             Copy bz2-compressed remote "image.raw.bz2" to regular file "$HOME/tmp/file".   The  image  file  is
             uncompressed  on-the-fly.  The  bmap  file  is  discovered  automatically. The OpenPGP signature is
             detected/discovered automatically too.

           <u>bmaptool</u> copy --bmap image.bmap --bmap-sig image.bmap.asc image.raw /dev/sdg
             Copy non-compressed local file "image.raw" to block device "/dev/sdg" using bmap file "image.bmap".
             Verify the bmap file signature using a detached OpenPGP signature from "imag.bmap.asc".

           cat image.raw | <u>bmaptool</u> copy --bmap image.bmap - /dev/sdg
             Copy non-compressed  image  from  standard  input  to  block  device  "/dev/sdg"  using  bmap  file
             "image.bmap".

   <b>create</b> [options] IMAGE
       Generate  bmap  for  a regular file IMAGE. Internally, this command uses the Linux "FIEMAP" ioctl to find
       out which IMAGE blocks are mapped. However, if "FIEMAP" is not supported, the "SEEK_HOLE" feature of  the
       "lseek" system call is used instead. By default, the resulting bmap file is printed to stdout, unless the
       "--output" option is used.

       The IMAGE file is always synchronized before the block map is generated. And it is important to make sure
       that  the  IMAGE  file is not modified when the bmap file is being generated, and after the bmap file has
       been generated. Otherwise the bmap file becomes invalid and checksum verification will fail.

       The image file can further be signed using OpenPGP.

         <b>OPTIONS</b>
           -h, --help
             Print short help text about the "create" command and exit.

           -o, --output OUTPUT
             Save the generated bmap in the OUTPUT file (by default the bmap is printed to stdout).

           --no-checksum
             Generate a bmap file without SHA1 checksums (not recommended).

         <b>EXAMPLES</b>
           <u>bmaptool</u> create image.raw
             Generate bmap for the "image.raw" file and print it to stdout.

           <u>bmaptool</u> create -o image.bmap image.raw
             Generate bmap for the "image.raw" file and save it in "image.bmap".

</pre><h4><b>AUTHOR</b></h4><pre>
       Artem Bityutskiy &lt;<a href="mailto:artem.bityutskiy@linux.intel.com">artem.bityutskiy@linux.intel.com</a>&gt;.

</pre><h4><b>Maintainers</b></h4><pre>
       Trevor Woerner &lt;<a href="mailto:twoerner@gmail.com">twoerner@gmail.com</a>&gt; Joshua Watt &lt;<a href="mailto:JPEWhacker@gmail.com">JPEWhacker@gmail.com</a>&gt; Tim Orling &lt;<a href="mailto:ticotimo@gmail.com">ticotimo@gmail.com</a>&gt;

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       This  project  is  hosted  on  github;  please  use  it  to  report  any  issues  or  post  any  patches:
       https://github.com/yoctoproject/bmaptool

bmaptool 3.8.0                                     March 2024                                        <u><a href="../man1/BMAPTOOL.1.html">BMAPTOOL</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>