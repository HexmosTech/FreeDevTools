<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>openssl-pkeyutl - asymmetric key command</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/openssl">openssl_3.4.1-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       openssl-pkeyutl - asymmetric key command

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>openssl</b> <b>pkeyutl</b> [<b>-help</b>] [<b>-in</b> <u>file</u>] [<b>-rawin</b>] [<b>-digest</b> <u>algorithm</u>] [<b>-out</b> <u>file</u>] [<b>-secret</b> <u>file</u>] [<b>-sigfile</b>
       <u>file</u>] [<b>-inkey</b> <u>filename</u>|<u>uri</u>] [<b>-keyform</b> <b>DER</b>|<b>PEM</b>|<b>P12</b>|<b>ENGINE</b>] [<b>-passin</b> <u>arg</u>] [<b>-pubin</b>] [<b>-certin</b>] [<b>-rev</b>] [<b>-sign</b>]
       [<b>-verify</b>] [<b>-verifyrecover</b>] [<b>-encrypt</b>] [<b>-decrypt</b>] [<b>-derive</b>] [<b>-peerkey</b> <u>file</u>] [<b>-peerform</b> <b>DER</b>|<b>PEM</b>|<b>P12</b>|<b>ENGINE</b>]
       [<b>-encap</b>] [<b>-decap</b>] [<b>-kdf</b> <u>algorithm</u>] [<b>-kdflen</b> <u>length</u>] [<b>-kemop</b> <u>operation</u>] [<b>-pkeyopt</b> <u>opt</u>:<u>value</u>]
       [<b>-pkeyopt_passin</b> <u>opt</u>[:<u>passarg</u>]] [<b>-hexdump</b>] [<b>-asn1parse</b>] [<b>-engine</b> <u>id</u>] [<b>-engine_impl</b>] [<b>-rand</b> <u>files</u>]
       [<b>-writerand</b> <u>file</u>] [<b>-provider</b> <u>name</u>] [<b>-provider-path</b> <u>path</u>] [<b>-propquery</b> <u>propq</u>] [<b>-config</b> <u>configfile</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This command can be used to perform low-level operations on asymmetric (public or private) keys using any
       supported algorithm.

       By default the signing operation (see <b>-sign</b> option) is assumed.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-help</b>
           Print out a usage message.

       <b>-in</b> <u>filename</u>
           This  specifies  the  input  filename  to  read  data  from  or  standard input if this option is not
           specified.

       <b>-rawin</b>
           This indicates that the signature or verification input data is raw data, which is not hashed by  any
           message  digest  algorithm.   Except with EdDSA, the user can specify a digest algorithm by using the
           <b>-digest</b> option.  For signature algorithms like RSA, DSA and ECDSA, the default  digest  algorithm  is
           SHA256. For SM2, it is SM3.

           This  option  can  only be used with <b>-sign</b> and <b>-verify</b>.  For EdDSA (the Ed25519 and Ed448 algorithms)
           this option is required.

       <b>-digest</b> <u>algorithm</u>
           This option can only be used with <b>-sign</b> and <b>-verify</b>.  It specifies the digest algorithm that is  used
           to  hash  the  input  data  before  signing  or verifying it with the input key. This option could be
           omitted if the signature algorithm does not require preprocessing the input through a pluggable  hash
           function  before signing (for instance, EdDSA). If this option is omitted but the signature algorithm
           requires one and the <b>-rawin</b> option is given, a default value will be used (see <b>-rawin</b>  for  details).
           If this option is present, then the <b>-rawin</b> option is required.

           At  this  time,  HashEdDSA  (the  ph  or "prehash" variant of EdDSA) is not supported, so the <b>-digest</b>
           option cannot be used with EdDSA.

       <b>-out</b> <u>filename</u>
           Specifies the output filename to write to or standard output by default.

       <b>-secret</b> <u>filename</u>
           Specifies the output filename to write the secret to on <u>-encap</u>.

       <b>-sigfile</b> <u>file</u>
           Signature file, required and allowed for <b>-verify</b> operations only.

       <b>-inkey</b> <u>filename</u>|<u>uri</u>
           The input key, by default it should be a private key.

       <b>-keyform</b> <b>DER</b>|<b>PEM</b>|<b>P12</b>|<b>ENGINE</b>
           The key format; unspecified by default.  See <b><a href="../man1/openssl-format-options.1.html">openssl-format-options</a></b>(1) for details.

       <b>-passin</b> <u>arg</u>
           The  input  key  password  source.   For   more   information   about   the   format   of   <u>arg</u>   see
           <b><a href="../man1/openssl-passphrase-options.1.html">openssl-passphrase-options</a></b>(1).

       <b>-pubin</b>
           By  default a private key is read from the key input.  With this option a public key is read instead.
           If the input contains no public key but a private key, its public part is used.

       <b>-certin</b>
           The input is a certificate containing a public key.

       <b>-rev</b>
           Reverse the order of the input buffer. This is useful for some libraries (such  as  CryptoAPI)  which
           represent the buffer in little-endian format.  This cannot be used in conjunction with <b>-rawin</b>.

       <b>-sign</b>
           Sign  the  input  data  and  output  the signed result. This requires a private key.  Using a message
           digest operation along with this is recommended, when applicable, see the <b>-rawin</b> and <b>-digest</b>  options
           for  details.  Otherwise, the input data given with the <b>-in</b> option is assumed to already be a digest,
           but this may then require an additional <b>-pkeyopt</b> "digest:"<u>md</u>  in  some  cases  (e.g.,  RSA  with  the
           default  PKCS#1  padding  mode).  Even for other algorithms like ECDSA, where the additional <b>-pkeyopt</b>
           option does not affect signature output, it is recommended, as it enables  checking  that  the  input
           length is consistent with the intended digest.

       <b>-verify</b>
           Verify  the  input  data  against  the  signature  given with the <b>-sigfile</b> option and indicate if the
           verification succeeded or failed.  The input data given with the <b>-in</b> option is assumed to be  a  hash
           value  unless  the  <b>-rawin</b> option is specified or implied.  With raw data, when a digest algorithm is
           applicable, though it may be inferred from the signature or take a default value, it should  also  be
           specified.

       <b>-verifyrecover</b>
           Verify  the  given signature and output the recovered data (signature payload).  For example, in case
           of RSA PKCS#1 the recovered data is the <b>EMSA-PKCS-v1_5</b> DER encoding of the digest algorithm  OID  and
           value           as           specified           in           RFC8017           Section           9.2
           &lt;https://datatracker.ietf.org/doc/html/rfc8017#section-9.2&gt;.

           Note that here the input given with the <b>-in</b> option is not a signature input (as with  the  <b>-sign</b>  and
           <b>-verify</b> options) but a signature output value, typically produced using the <b>-sign</b> option.

           This option is available only for use with RSA keys.

       <b>-encrypt</b>
           Encrypt the input data using a public key.

       <b>-decrypt</b>
           Decrypt the input data using a private key.

       <b>-derive</b>
           Derive a shared secret using own private (EC)DH key and peer key.

       <b>-peerkey</b> <u>file</u>
           File  containing  the  peer  public  or private (EC)DH key to use with the key derivation (agreement)
           operation.  Its type must match the type of the own private key given with <b>-inkey</b>.

       <b>-peerform</b> <b>DER</b>|<b>PEM</b>|<b>P12</b>|<b>ENGINE</b>
           The peer key format; unspecified by default.  See <b><a href="../man1/openssl-format-options.1.html">openssl-format-options</a></b>(1) for details.

       <b>-encap</b>
           Encapsulate a generated secret using a private key.  The encapsulated result (binary data) is written
           to standard output by default, or else to the file specified with <u>-out</u>.  The <u>-secret</u> option must also
           be provided to specify the output file for the secret value generated in the encapsulation process.

       <b>-decap</b>
           Decapsulate the secret using a private key.  The result (binary data) is written to  standard  output
           by default, or else to the file specified with <u>-out</u>.

       <b>-kemop</b> <u>operation</u>
           This  option  is used for <u>-encap</u>/<u>-decap</u> commands and specifies the KEM operation specific for the key
           algorithm when there is no default KEM operation.  If the algorithm has the  default  KEM  operation,
           this option can be omitted.

           See   <b><a href="../man3/EVP_PKEY_CTX_set_kem_op.3.html">EVP_PKEY_CTX_set_kem_op</a></b>(3)  and  algorithm-specific  KEM  documentation  e.g.   <b><a href="../man7/EVP_KEM-RSA.7.html">EVP_KEM-RSA</a></b>(7),
           <b><a href="../man7/EVP_KEM-EC.7.html">EVP_KEM-EC</a></b>(7), <b><a href="../man7/EVP_KEM-X25519.7.html">EVP_KEM-X25519</a></b>(7), and <b><a href="../man7/EVP_KEM-X448.7.html">EVP_KEM-X448</a></b>(7).

       <b>-kdf</b> <u>algorithm</u>
           Use key derivation function <u>algorithm</u>.  The supported algorithms are at present  <b>TLS1-PRF</b>  and  <b>HKDF</b>.
           Note:  additional parameters and the KDF output length will normally have to be set for this to work.
           See  <b><a href="../man3/EVP_PKEY_CTX_set_hkdf_md.3.html">EVP_PKEY_CTX_set_hkdf_md</a></b>(3)  and  <b><a href="../man3/EVP_PKEY_CTX_set_tls1_prf_md.3.html">EVP_PKEY_CTX_set_tls1_prf_md</a></b>(3)  for  the   supported   string
           parameters of each algorithm.

       <b>-kdflen</b> <u>length</u>
           Set the output length for KDF.

       <b>-pkeyopt</b> <u>opt</u>:<u>value</u>
           Public key options specified as opt:value. See NOTES below for more details.

       <b>-pkeyopt_passin</b> <u>opt</u>[:<u>passarg</u>]
           Allows  reading  a  public key option <u>opt</u> from stdin or a password source.  If only <u>opt</u> is specified,
           the user will be prompted to enter a password on stdin.   Alternatively,  <u>passarg</u>  can  be  specified
           which can be any value supported by <b><a href="../man1/openssl-passphrase-options.1.html">openssl-passphrase-options</a></b>(1).

       <b>-hexdump</b>
           hex dump the output data.

       <b>-asn1parse</b>
           Parse  the  ASN.1 output data to check its DER encoding and print any errors.  When combined with the
           <b>-verifyrecover</b> option, this may be useful in case an ASN.1  DER-encoded  structure  had  been  signed
           directly  (without  hashing  it) and when checking a signature in PKCS#1 v1.5 format, which has a DER
           encoding.

       <b>-engine</b> <u>id</u>
           See "Engine Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1).  This option is deprecated.

       <b>-engine_impl</b>
           When used with the <b>-engine</b> option, it specifies to also use engine <u>id</u> for crypto operations.

       <b>-rand</b> <u>files</u>, <b>-writerand</b> <u>file</u>
           See "Random State Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1) for details.

       <b>-provider</b> <u>name</u>
       <b>-provider-path</b> <u>path</u>
       <b>-propquery</b> <u>propq</u>
           See "Provider Options" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1), <b><a href="../man7/provider.7.html">provider</a></b>(7), and <b><a href="../man7/property.7.html">property</a></b>(7).

       <b>-config</b> <u>configfile</u>
           See "Configuration Option" in <b><a href="../man1/openssl.1.html">openssl</a></b>(1).

</pre><h4><b>NOTES</b></h4><pre>
       The operations and options supported vary according to the key  algorithm  and  its  implementation.  The
       OpenSSL operations and options are indicated below.

       Unless  otherwise  mentioned,  the  <b>-pkeyopt</b>  option  supports  for all public-key types the "digest:"<u>alg</u>
       argument, which specifies the digest in use for the signing and verification operations.  The  value  <u>alg</u>
       should  represent  a  digest name as used in the <b>EVP_get_digestbyname()</b> function for example <b>sha256</b>. This
       value is not used to hash the input data. It is used (by some algorithms) for sanity-checking the lengths
       of data passed in and for creating the structures that make up the signature (e.g., <b>DigestInfo</b> in  RSASSA
       PKCS#1 v1.5 signatures).

       For  instance,  if  the  value  of  the  <b>-pkeyopt</b>  option  "digest"  argument is <b>sha256</b>, the signature or
       verification input should be the 32 bytes long binary value of the SHA256 hash function output.

       Unless <b>-rawin</b> is used or implied, this command does not hash the input data but rather it  will  use  the
       data  directly  as input to the signature algorithm.  Depending on the key type, signature type, and mode
       of padding, the maximum sensible lengths of input data differ. With RSA the signed data cannot be  longer
       than  the  key  modulus.  In  case  of  ECDSA  and DSA the data should not be longer than the field size,
       otherwise it will be silently truncated to the field size.  In any event  the  input  size  must  not  be
       larger than the largest supported digest output size <b>EVP_MAX_MD_SIZE</b>, which currently is 64 bytes.

</pre><h4><b>RSA</b> <b>ALGORITHM</b></h4><pre>
       The  RSA  algorithm  generally  supports the encrypt, decrypt, sign, verify and verifyrecover operations.
       However, some padding modes support only a subset of these operations. The following  additional  <b>pkeyopt</b>
       values are supported:

       <b>rsa_padding_mode:</b><u>mode</u>
           This  sets the RSA padding mode. Acceptable values for <u>mode</u> are <b>pkcs1</b> for PKCS#1 padding, <b>none</b> for no
           padding, <b>oaep</b> for <b>OAEP</b> mode, <b>x931</b> for X9.31 mode and <b>pss</b> for PSS.

           In PKCS#1 padding, if the message digest is not set, then the supplied data  is  signed  or  verified
           directly  instead  of using a <b>DigestInfo</b> structure. If a digest is set, then the <b>DigestInfo</b> structure
           is used and its length must correspond to the digest type.

           Note, for <b>pkcs1</b> padding, as a protection against the Bleichenbacher attack, the decryption  will  not
           fail  in  case  of padding check failures. Use <b>none</b> and manual inspection of the decrypted message to
           verify if the decrypted value has correct PKCS#1 v1.5 padding.

           For <b>oaep</b> mode only encryption and decryption is supported.

           For <b>x931</b> if the digest type is set it is used to format the block data otherwise the  first  byte  is
           used  to  specify  the  X9.31  digest ID. Sign, verify and verifyrecover are can be performed in this
           mode.

           For <b>pss</b> mode only sign and verify are supported and the digest type must be specified.

       <b>rsa_pss_saltlen:</b><u>len</u>
           For <b>pss</b> mode only this option specifies the salt length. Three special values are  supported:  <b>digest</b>
           sets the salt length to the digest length, <b>max</b> sets the salt length to the maximum permissible value.
           When  verifying  <b>auto</b>  causes  the  salt length to be automatically determined based on the <b>PSS</b> block
           structure.

       <b>rsa_mgf1_md:</b><u>digest</u>
           For PSS and OAEP padding sets the MGF1 digest. If the MGF1 digest is not explicitly set in  PSS  mode
           then the signing digest is used.

       <b>rsa_oaep_md:</b><u>digest</u>
           Sets the digest used for the OAEP hash function. If not explicitly set then SHA256 is used.

       <b>rsa_pkcs1_implicit_rejection:</b><u>flag</u>
           Disables  (when  set  to 0) or enables (when set to 1) the use of implicit rejection with PKCS#1 v1.5
           decryption. When enabled (the default), as a protection against Bleichenbacher  attack,  the  library
           will  generate  a deterministic random plaintext that it will return to the caller in case of padding
           check failure.  When disabled, it's the callers' responsibility to handle the returned  errors  in  a
           side-channel free manner.

</pre><h4><b>RSA-PSS</b> <b>ALGORITHM</b></h4><pre>
       The  RSA-PSS  algorithm  is  a  restricted  version of the RSA algorithm which only supports the sign and
       verify operations with PSS padding. The following additional <b>-pkeyopt</b> values are supported:

       <b>rsa_padding_mode:</b><u>mode</u>, <b>rsa_pss_saltlen:</b><u>len</u>, <b>rsa_mgf1_md:</b><u>digest</u>
           These have the same meaning as the <b>RSA</b> algorithm with some additional restrictions. The padding  mode
           can only be set to <b>pss</b> which is the default value.

           If  the  key  has  parameter restrictions then the digest, MGF1 digest and salt length are set to the
           values specified in the parameters.  The digest and MG cannot be changed and the salt  length  cannot
           be set to a value less than the minimum restriction.

</pre><h4><b>DSA</b> <b>ALGORITHM</b></h4><pre>
       The  DSA  algorithm  supports signing and verification operations only. Currently there are no additional
       <b>-pkeyopt</b> options other than <b>digest</b>. The SHA256 digest is assumed by default.

</pre><h4><b>DH</b> <b>ALGORITHM</b></h4><pre>
       The DH algorithm only supports the derivation operation and no additional <b>-pkeyopt</b> options.

</pre><h4><b>EC</b> <b>ALGORITHM</b></h4><pre>
       The EC algorithm supports sign, verify and derive operations. The sign and verify  operations  use  ECDSA
       and derive uses ECDH. SHA256 is assumed by default for the <b>-pkeyopt</b> <b>digest</b> option.

</pre><h4><b>X25519</b> <b>AND</b> <b>X448</b> <b>ALGORITHMS</b></h4><pre>
       The X25519 and X448 algorithms support key derivation only. Currently there are no additional options.

</pre><h4><b>ED25519</b> <b>AND</b> <b>ED448</b> <b>ALGORITHMS</b></h4><pre>
       These algorithms only support signing and verifying. OpenSSL only implements the "pure" variants of these
       algorithms  so  raw data can be passed directly to them without hashing them first. OpenSSL only supports
       "oneshot" operation with these algorithms. This means that the entire file to be signed/verified must  be
       read  into  memory  before  processing  it.  Signing  or  Verifying  very  large files should be avoided.
       Additionally the size of the file must be known for this to work. If the  size  of  the  file  cannot  be
       determined (for example if the input is stdin) then the sign or verify operation will fail.

</pre><h4><b>SM2</b></h4><pre>
       The  SM2  algorithm  supports  sign,  verify,  encrypt  and  decrypt  operations. For the sign and verify
       operations, SM2 requires an Distinguishing ID string to be passed in. The  following  <b>-pkeyopt</b>  value  is
       supported:

       <b>distid:</b><u>string</u>
           This  sets the ID string used in SM2 sign or verify operations. While verifying an SM2 signature, the
           ID string must be the same one used when signing the data.  Otherwise the verification will fail.

       <b>hexdistid:</b><u>hex_string</u>
           This sets the ID string used in SM2 sign or verify operations. While verifying an SM2 signature,  the
           ID string must be the same one used when signing the data.  Otherwise the verification will fail. The
           ID string provided with this option should be a valid hexadecimal value.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Sign some data using a private key:

        openssl pkeyutl -sign -in file -inkey key.pem -out sig

       Recover the signed data (e.g. if an RSA key is used):

        openssl pkeyutl -verifyrecover -in sig -inkey key.pem

       Verify the signature (e.g. a DSA key):

        openssl pkeyutl -verify -in file -sigfile sig -inkey key.pem

       Sign data using a message digest value (this is currently only valid for RSA):

        openssl pkeyutl -sign -in file -inkey key.pem -out sig -pkeyopt digest:sha256

       Derive a shared secret value:

        openssl pkeyutl -derive -inkey key.pem -peerkey pubkey.pem -out secret

       Hexdump 48 bytes of TLS1 PRF using digest <b>SHA256</b> and shared secret and seed consisting of the single byte
       0xFF:

        openssl pkeyutl -kdf TLS1-PRF -kdflen 48 -pkeyopt md:SHA256 \
           -pkeyopt hexsecret:ff -pkeyopt hexseed:ff -hexdump

       Derive a key using <b>scrypt</b> where the password is read from command line:

        openssl pkeyutl -kdf scrypt -kdflen 16 -pkeyopt_passin pass \
           -pkeyopt hexsalt:aabbcc -pkeyopt N:16384 -pkeyopt r:8 -pkeyopt p:1

       Derive using the same algorithm, but read key from environment variable MYPASS:

        openssl pkeyutl -kdf scrypt -kdflen 16 -pkeyopt_passin pass:env:MYPASS \
           -pkeyopt hexsalt:aabbcc -pkeyopt N:16384 -pkeyopt r:8 -pkeyopt p:1

       Sign some data using an <b><a href="../man7/SM2.7.html">SM2</a></b>(7) private key and a specific ID:

        openssl pkeyutl -sign -in file -inkey sm2.key -out sig -rawin -digest sm3 \
           -pkeyopt distid:someid

       Verify some data using an <b><a href="../man7/SM2.7.html">SM2</a></b>(7) certificate and a specific ID:

        openssl pkeyutl -verify -certin -in file -inkey sm2.cert -sigfile sig \
           -rawin -digest sm3 -pkeyopt distid:someid

       Decrypt some data using a private key with OAEP padding using SHA256:

        openssl pkeyutl -decrypt -in file -inkey key.pem -out secret \
           -pkeyopt rsa_padding_mode:oaep -pkeyopt rsa_oaep_md:sha256

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/openssl.1.html">openssl</a></b>(1),   <b><a href="../man1/openssl-genpkey.1.html">openssl-genpkey</a></b>(1),  <b><a href="../man1/openssl-pkey.1.html">openssl-pkey</a></b>(1),  <b><a href="../man1/openssl-rsautl.1.html">openssl-rsautl</a></b>(1)  <b><a href="../man1/openssl-dgst.1.html">openssl-dgst</a></b>(1),  <b><a href="../man1/openssl-rsa.1.html">openssl-rsa</a></b>(1),
       <b><a href="../man1/openssl-genrsa.1.html">openssl-genrsa</a></b>(1), <b><a href="../man1/openssl-kdf.1.html">openssl-kdf</a></b>(1) <b><a href="../man3/EVP_PKEY_CTX_set_hkdf_md.3.html">EVP_PKEY_CTX_set_hkdf_md</a></b>(3), <b><a href="../man3/EVP_PKEY_CTX_set_tls1_prf_md.3.html">EVP_PKEY_CTX_set_tls1_prf_md</a></b>(3),

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>-engine</b> option was deprecated in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2006-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.4.1                                              2025-04-03                              <u><a href="../man1SSL/OPENSSL-PKEYUTL.1SSL.html">OPENSSL-PKEYUTL</a></u>(1SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>