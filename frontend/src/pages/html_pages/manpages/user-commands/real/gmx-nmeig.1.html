<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gmx-nmeig - Diagonalize the Hessian for normal mode analysis</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/gromacs-data">gromacs-data_2025.0-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gmx-nmeig - Diagonalize the Hessian for normal mode analysis

</pre><h4><b>SYNOPSIS</b></h4><pre>
          gmx nmeig [<b>-f</b> <u>[&lt;.mtx&gt;]</u>] [<b>-s</b> <u>[&lt;.tpr&gt;]</u>] [<b>-of</b> <u>[&lt;.xvg&gt;]</u>] [<b>-ol</b> <u>[&lt;.xvg&gt;]</u>]
                    [<b>-os</b> <u>[&lt;.xvg&gt;]</u>] [<b>-qc</b> <u>[&lt;.xvg&gt;]</u>] [<b>-v</b> <u>[&lt;.trr/.cpt/...&gt;]</u>]
                    [<b>-xvg</b> <u>&lt;enum&gt;</u>] [<b>-[no]m</b>] [<b>-first</b> <u>&lt;int&gt;</u>] [<b>-last</b> <u>&lt;int&gt;</u>]
                    [<b>-maxspec</b> <u>&lt;int&gt;</u>] [<b>-T</b> <u>&lt;real&gt;</u>] [<b>-P</b> <u>&lt;real&gt;</u>] [<b>-sigma</b> <u>&lt;int&gt;</u>]
                    [<b>-scale</b> <u>&lt;real&gt;</u>] [<b>-linear_toler</b> <u>&lt;real&gt;</u>] [<b>-[no]constr</b>]
                    [<b>-width</b> <u>&lt;real&gt;</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>gmx</b>  <b>nmeig</b>  calculates  the  eigenvectors/values  of a (Hessian) matrix, which can be calculated with <u>gmx</u>
       <u>mdrun</u>.  The eigenvectors are written to a trajectory file (<b>-v</b>).  The structure is written first with t=0.
       The eigenvectors are written as frames with the eigenvector number and eigenvalue written as step  number
       and  timestamp,  respectively.   The  eigenvectors  can  be  analyzed  with  <u>gmx</u>  <u>anaeig</u>.  An ensemble of
       structures can be generated from the eigenvectors with <u>gmx</u>  <u>nmens</u>.  When  mass  weighting  is  used,  the
       generated  eigenvectors  will be scaled back to plain Cartesian coordinates before generating the output.
       In this case, they will no longer be exactly orthogonal in  the  standard  Cartesian  norm,  but  in  the
       mass-weighted norm they would be.

       This  program  can  be  optionally  used  to compute quantum corrections to heat capacity and enthalpy by
       providing an extra file argument <b>-qcorr</b>. See the GROMACS manual,  Chapter  1,  for  details.  The  result
       includes  subtracting  a  harmonic  degree  of freedom at the given temperature.  The total correction is
       printed on the terminal screen.  The recommended way of getting the corrections out is:

       <b>gmx</b> <b>nmeig</b> <b>-s</b> <b>topol.tpr</b> <b>-f</b> <b>nm.mtx</b> <b>-first</b> <b>7</b> <b>-last</b> <b>10000</b> <b>-T</b> <b>300</b> <b>-qc</b> <b>[-constr]</b>

       The <b>-constr</b> option should be used when bond constraints were used  during  the  simulation  <b>for</b>  <b>all</b>  <b>the</b>
       <b>covalent</b> <b>bonds</b>. If this is not the case, you need to analyze the <b>quant_corr.xvg</b> file yourself.

       To make things more flexible, the program can also take virtual sites into account when computing quantum
       corrections.  When  selecting  <b>-constr</b>  and <b>-qc</b>, the <b>-begin</b> and <b>-end</b> options will be set automatically as
       well.

       Based on a harmonic analysis of the normal  mode  frequencies,  thermochemical  properties  S0  (Standard
       Entropy),  Cv (Heat capacity at constant volume), Zero-point energy and the internal energy are computed,
       much in the same manner as popular quantum chemistry programs.

</pre><h4><b>OPTIONS</b></h4><pre>
       Options to specify input files:

       <b>-f</b> <b>[&lt;.mtx&gt;]</b> <b>(hessian.mtx)</b>
              Hessian matrix

       <b>-s</b> <b>[&lt;.tpr&gt;]</b> <b>(topol.tpr)</b>
              Portable xdr run input file

       Options to specify output files:

       <b>-of</b> <b>[&lt;.xvg&gt;]</b> <b>(eigenfreq.xvg)</b>
              xvgr/xmgr file

       <b>-ol</b> <b>[&lt;.xvg&gt;]</b> <b>(eigenval.xvg)</b>
              xvgr/xmgr file

       <b>-os</b> <b>[&lt;.xvg&gt;]</b> <b>(spectrum.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-qc</b> <b>[&lt;.xvg&gt;]</b> <b>(quant_corr.xvg)</b> <b>(Optional)</b>
              xvgr/xmgr file

       <b>-v</b> <b>[&lt;.trr/.cpt/...&gt;]</b> <b>(eigenvec.trr)</b>
              Full precision trajectory: <u>trr</u> <u>cpt</u> <u>tng</u>

       Other options:

       <b>-xvg</b> <b>&lt;enum&gt;</b> <b>(xmgrace)</b>
              xvg plot formatting: xmgrace, xmgr, none

       <b>-[no]m</b> <b>(yes)</b>
              Divide elements of Hessian by product of <a href="../manmass/sqrt.mass.html">sqrt</a>(mass) of involved atoms  prior  to  diagonalization.
              This should be used for 'Normal Modes' analysis

       <b>-first</b> <b>&lt;int&gt;</b> <b>(1)</b>
              First eigenvector to write away

       <b>-last</b> <b>&lt;int&gt;</b> <b>(50)</b>
              Last eigenvector to write away. -1 is use all dimensions.

       <b>-maxspec</b> <b>&lt;int&gt;</b> <b>(4000)</b>
              Highest frequency (1/cm) to consider in the spectrum

       <b>-T</b> <b>&lt;real&gt;</b> <b>(298.15)</b>
              Temperature  for  computing  entropy,  quantum  heat  capacity and enthalpy when using normal mode
              calculations to correct classical simulations

       <b>-P</b> <b>&lt;real&gt;</b> <b>(1)</b>
              Pressure (bar) when computing entropy

       <b>-sigma</b> <b>&lt;int&gt;</b> <b>(1)</b>
              Number of symmetric copies used when computing entropy. E.g. for water the number is 2, for NH3 it
              is 3 and for methane it is 12.

       <b>-scale</b> <b>&lt;real&gt;</b> <b>(1)</b>
              Factor to scale frequencies before computing thermochemistry values

       <b>-linear_toler</b> <b>&lt;real&gt;</b> <b>(1e-05)</b>
              Tolerance for determining whether a compound is linear  as  determined  from  the  ration  of  the
              moments inertion Ix/Iy and Ix/Iz.

       <b>-[no]constr</b> <b>(no)</b>
              If  constraints  were  used in the simulation but not in the normal mode analysis you will need to
              set this for computing the quantum corrections.

       <b>-width</b> <b>&lt;real&gt;</b> <b>(1)</b>
              Width (sigma) of the gaussian peaks (1/cm) when generating a spectrum

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/gmx.1.html">gmx</a>(1)</b>

       More information about GROMACS is available at &lt;<u><a href="http://www.gromacs.org/">http://www.gromacs.org/</a></u>&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2025, GROMACS development team

2025.0                                            Feb 10, 2025                                      <u><a href="../man1/GMX-NMEIG.1.html">GMX-NMEIG</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>