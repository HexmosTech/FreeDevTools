<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>v.clean  - Toolset for cleaning topology of vector map.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/grass-doc">grass-doc_8.4.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>v.clean</b>  - Toolset for cleaning topology of vector map.

</pre><h4><b>KEYWORDS</b></h4><pre>
       vector, topology, geometry, snapping

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>v.clean</b>
       <b>v.clean</b> <b>--help</b>
       <b>v.clean</b>   [-<b>bc</b>]   <b>input</b>=<u>name</u>    [<b>layer</b>=<u>string</u>]    [<b>type</b>=<u>string</u>[,<u>string</u>,...]]   <b>output</b>=<u>name</u>   [<b>error</b>=<u>name</u>]
       <b>tool</b>=<u>string</u>[,<u>string</u>,...]  [<b>threshold</b>=<u>float</u>[,<u>float</u>,...]]   [--<b>overwrite</b>]  [--<b>help</b>]  [--<b>verbose</b>]  [--<b>quiet</b>]
       [--<b>ui</b>]

   <b>Flags:</b>
       <b>-b</b>
           Do not build topology for the output vector

       <b>-c</b>
           Combine tools with recommended follow-up tools

       <b>--overwrite</b>
           Allow output files to overwrite existing files

       <b>--help</b>
           Print usage summary

       <b>--verbose</b>
           Verbose module output

       <b>--quiet</b>
           Quiet module output

       <b>--ui</b>
           Force launching GUI dialog

   <b>Parameters:</b>
       <b>input</b>=<u>name</u> <b>[required]</b>
           Name of input vector map
           Or data source for direct OGR access

       <b>layer</b>=<u>string</u>
           Layer number or name (’-1’ for all layers)
           A single vector map can be connected to multiple database tables. This number determines which  table
           to use. When used with direct OGR access this is the layer name.
           Default: <u>-1</u>

       <b>type</b>=<u>string[,string</u>,...]
           Input feature type
           Options: <u>point,</u> <u>line,</u> <u>boundary,</u> <u>centroid,</u> <u>area,</u> <u>face,</u> <u>kernel</u>
           Default: <u>point,line,boundary,centroid,area,face,kernel</u>

       <b>output</b>=<u>name</u> <b>[required]</b>
           Name for output vector map

       <b>error</b>=<u>name</u>
           Name of output map where errors are written

       <b>tool</b>=<u>string[,string</u>,...] <b>[required]</b>
           Cleaning tool
           Options:  <u>break,</u>  <u>snap,</u>  <u>rmdangle,</u>  <u>chdangle,</u> <u>rmbridge,</u> <u>chbridge,</u> <u>rmdupl,</u> <u>rmdac,</u> <u>bpol,</u> <u>prune,</u> <u>rmarea,</u>
           <u>rmline,</u> <u>rmsa</u>
           <b>break</b>: break lines at each intersection
           <b>snap</b>: snap lines to vertex in threshold
           <b>rmdangle</b>: remove dangles, threshold ignored if &lt; 0
           <b>chdangle</b>: change the type of boundary dangle to line, threshold ignored if &lt; 0, input  line  type  is
           ignored
           <b>rmbridge</b>: remove bridges connecting area and island or 2 islands
           <b>chbridge</b>: change the type of bridges connecting area and island or 2 islands from boundary to line
           <b>rmdupl</b>: remove duplicate geometry features (pay attention to categories!)
           <b>rmdac</b>: remove duplicate area centroids (’type’ option ignored)
           <b>bpol</b>:  break  (topologically  clean) polygons (imported from non topological format, like ShapeFile).
           Boundaries are broken on each point shared between 2 and more polygons where angles of  segments  are
           different
           <b>prune</b>: remove vertices in threshold from lines and boundaries, boundary is pruned only if topology is
           not  damaged  (new  intersection,  changed  attachment  of  centroid),  first and last segment of the
           boundary is never changed
           <b>rmarea</b>: remove small areas, the longest boundary with adjacent area is removed
           <b>rmline</b>: remove all lines or boundaries of zero length, threshold is ignored
           <b>rmsa</b>: remove small angles between lines at nodes

       <b>threshold</b>=<u>float[,float</u>,...]
           One value for each tool; for threshold units, see each tool
           Default: 0.0[,0.0,...])

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>v.clean</u> allows the user to automatically fix topology of vector maps. Several tools may be listed  to  be
       executed  sequentially.  In  this case, also the threshold parameter requires several values to be listed
       accordingly. An error map is optionally written which stores the erroneous geometries.

   <b>Break</b> <b>lines/boundaries</b>
       <u>tool=break</u>

       The <u>break</u> tool breaks lines/boundaries at intersections and it also  breaks  lines/boundaries  forming  a
       collapsed loop.  For example, 0.0;1.0;0.0 is broken at 1.0.

       Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if <u>v.clean</u> is run with several
       tools.

       Hint:  Breaking  lines should be followed by removing duplicates, e.g.  <u>v.clean</u> <u>...</u> <u>tool=break,rmdupl</u>. If
       the <u>-c</u> flag is used with <u>v.clean</u> <u>...</u> <u>tool=break</u>, duplicates are automatically removed.

   <b>Remove</b> <b>duplicate</b> <b>geometry</b> <b>features</b>
       <u>tool=rmdupl</u>

       The <u>rmdupl</u> tool removes geometry features with identical coordinates. Categories are merged. If  a  point
       and  a  centroid have identical coordinates, one of them will be removed if both points and centroids are
       selected with <u>v.clean</u> <u>...</u> <u>type=point,centroid</u>.  The  same applies for lines and boundaries.

       Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if <u>v.clean</u> is run with several
       tools.

       The <u>rmdupl</u> tool should be used after breaking lines and breaking polygons.

   <b>Remove</b> <b>dangles</b> <b>or</b> <b>change</b> <b>boundary</b> <b>dangles</b> <b>to</b> <b>type</b> <b>line</b>
       <u>tool=rmdangle</u> and <u>tool=chdangle</u>

       A line/boundary is considered to be a dangle if no other line of given <u>type</u> is on at least one end  node.
       If  a  dangle  is formed by several lines, such a string of lines is taken as one dangle and line lengths
       are summarized. The <u>rmdangle</u> tool deletes a dangle if the (combined) length is  shorter  than  <u>thresh</u>  or
       <u>thresh</u> &lt; 0. If the combined length is larger than <u>thresh</u>, nothing is deleted.

       Threshold  has  to be given as maximum line/boundary length in map units; for latitude-longitude projects
       in degrees. Dangles shorter than <u>thresh</u> are removed sequentially. All dangles will be removed if <u>thresh</u> &lt;
       0.

       With <u>thresh</u> &lt; 0, only closed loops and lines connecting loops will remain. This is useful to  remove  all
       incorrect  boundaries  after  other cleaning operations with <u>thres</u> is &lt; 0. Areas can then be successfully
       built.

       To preferentially remove shortest dangles first, a first pass with a small <u>thresh</u> value can  be  followed
       by  subsequent  passes with higher <u>thresh</u> values. This can be done as one <u>v.clean</u> job by listing the tool
       several times and by defining a list of increasing <u>thresh</u> values.

       The <u>chdangle</u> tool is similar to the <u>rmdangle</u> tool, but works only  on  boundaries  and  changes  dangling
       boundaries to lines instead of removing them.

   <b>Remove</b> <b>or</b> <b>change</b> <b>bridges</b> <b>connecting</b> <b>an</b> <b>area</b> <b>and</b> <b>an</b> <b>island</b> <b>or</b> <b>two</b> <b>islands</b>
       <u>tool=rmbridge</u> and <u>tool=chbridge</u>

       A  bridge  is  an  area type connection of an island (polygon in a polygon) to the outer polygon. This is
       topologically incorrect (but OGC Simple Features allow it). The <u>rmbridge</u> tool  removes  bridges  and  the
       <u>chbridge</u> tool changes bridges to type line:
           +-------------+             +-------------+   +-------------+
           |            P|  P: polygon |            P|   |            P|
           |    +---+    |  I: island  |    +---+    |   |    +---+    |
           |    | I |    |  B: bridge  |    | I |    |   |    | I |    |
           |    |   |    |  L: line    |    |   |    |   |    |   |    |
           |    +-+-+    |             |    +---+    |   |    +-.-+    |
           |      |      |             |             |   |      .      |
           |      | B    |             |             |   |      . L    |
           |      |      |             |             |   |      .      |
           +------+------+             +-------------+   +-------------+

       Islands  and  areas  must  be  already  clean,  i.e.  without  dangles or small angles, e.g.  <u>v.clean</u> <u>...</u>
       <u>type=boundary</u> <u>tool=rmdangle,rmsa,break,rmdupl,rmbridge</u> <u>thresh=-1,0,0,0,0</u>.

       Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if <u>v.clean</u> is run with several
       tools.

   <b>Snap</b> <b>lines</b> <b>to</b> <b>vertex</b> <b>in</b> <b>threshold</b>
       <u>tool=snap</u>

       The <u>snap</u> tool snaps vertices to another vertex not farther away than <u>thresh</u>. If there is no other  vertex
       within <u>thresh</u>, no snapping will be done. The <u>type</u> option can have a strong influence on the result. A too
       large threshold and <u>type=boundary</u> can severely damage area topology, beyond repair.

       Threshold  gives  maximum  distance  to  another  vertex in map units, for latitude-longitude projects in
       degrees.

       Snapped boundaries may need to be cleaned with <u>break,rmdupl,rmsa</u>.  If the <u>-c</u> flag is  used  with  <u>v.clean</u>
       <u>tool=snap</u>, the sequence of <u>break,rmdupl,rmsa</u> is automatically repeated after snapping until no more small
       angles a left. Additional cleaning with e.g.  <u>tool=rmdangle</u>may be necessary.

   <b>Remove</b> <b>duplicate</b> <b>area</b> <b>centroids</b>
       <u>tool=rmdac</u>

       The <u>rmdac</u> tool removes duplicate area centroids that can result from deleting boundaries.

       Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if <u>v.clean</u> is run with several
       tools.

   <b>Break</b> <b>(topologically</b> <b>clean)</b> <b>areas</b> <b>(imported</b> <b>from</b> <b>a</b> <b>non</b> <b>topological</b>
       format like ShapeFile) <u>tool=bpol</u>

       The  <u>bpol</u>  tool  breaks boundaries on each point shared between 2 and more areas where angles of boundary
       segments are different and on all boundary nodes (start and end points of each boundary). The  <u>bpol</u>  tool
       behaves similar to <u>break</u> for boundaries, but does not break collapsed loops. The <u>bpol</u> tool is faster than
       the <u>break</u> tool but needs more memory.

       Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if <u>v.clean</u> is run with several
       tools.

       The <u>bpol</u> tool should be followed by <u>rmdupl</u>. If the <u>-c</u> flag is used with <u>v.clean</u> <u>...</u> <u>tool=bpol</u>, duplicates
       are automatically removed.

   <b>Remove</b> <b>vertices</b> <b>in</b> <b>threshold</b> <b>from</b> <b>lines</b> <b>and</b> <b>boundaries</b>
       <u>tool=prune</u>

       The  <u>prune</u>  tool  simplifies  lines and boundaries by removing vertices according to threshold. This tool
       preserves area topology, areas are never deleted and centroid attachment is never changed.   <u>v.generalize</u>
       offers much more functionality for line simplification but does not preserve area topology.

   <b>Remove</b> <b>small</b> <b>areas</b>
       <u>tool=rmarea</u>

       The <u>rmarea</u> tool removes all areas &lt;= <u>thresh</u>. The longest boundary with an adjacent area is removed or all
       boundaries  if  there  is  no adjacent area. Area categories are not combined when a small area is merged
       with a larger area.

       Threshold must always be in square meters, also for latitude-longitude projects or  projects  with  units
       other than meters.

   <b>Remove</b> <b>all</b> <b>lines</b> <b>or</b> <b>boundaries</b> <b>of</b> <b>zero</b> <b>length</b>
       <u>tool=rmline</u>

       The <u>rmline</u> tool removes all lines or boundaries of zero length that may have resulted from other cleaning
       operations. Zero length boundaries are redundant and do not influence area topology.

       Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if <u>v.clean</u> is run with several
       tools.

   <b>Remove</b> <b>small</b> <b>angles</b> <b>between</b> <b>lines</b> <b>at</b> <b>nodes</b>
       <u>tool=rmsa</u>

       The  <u>rmsa</u>  tool  only  concerns  angles  which are so small that the calculated angle is 0. The following
       figure should help demonstrate what the tool does.

       Threshold does not apply, use dummy value if <u>v.clean</u> is run with several tools.

       <u>tool=rmsa</u>

       The <u>rmsa</u> tool should be followed by <u>break,rmdupl</u>. The <u>rmsa</u> tool followed by <u>break,rmdupl</u> may need  to  be
       run  more  than  once  to remove all small angles. If the <u>-c</u> flag is used with <u>v.clean</u> <u>...</u> <u>tool=rmsa</u>, the
       sequence of <u>rmsa,break,rmdupl</u> is automatically repeated until no more small angles a left.

</pre><h4><b>NOTES</b></h4><pre>
       The user does <b>not</b> have to run <u>v.build</u> on the <u>output</u> vector, unless the <u>-b</u> flag  was  used.  The  <u>-b</u>  flag
       affects <b>only</b> the <u>output</u> vector - topology is always built for <u>error</u> vector.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Snap</b> <b>lines</b> <b>to</b> <b>vertex</b> <b>in</b> <b>threshold</b>
       v.clean input=testmap output=cleanmap tool=snap threshold=1

   <b>Inspecting</b> <b>the</b> <b>topological</b> <b>errors</b> <b>visually</b>
       Both <u>v.build</u> and <u>v.clean</u> can collect the topological errors into a vector map:
       v.build -e map=imported error=build_errors
       v.clean -c input=imported output=clean error=cleaning_errors tool=snap,rmdangle,rmbridge,chbridge,bpol,prune threshold=5
       The  vector  maps  can  be  visualized  together  with  the original data by the following set of display
       commands:
       d.vect map=imported color=26:26:26 fill_color=77:77:77 width=5
       d.vect map=build_errors color=255:33:36 fill_color=none width=5 icon=basic/point size=30
       d.vect map=cleaning_errors color=255:33:36 fill_color=none width=5 icon=basic/point size=30
       <u>Figure:</u> <u>Topological</u> <u>errors</u> <u>detected</u> <u>in</u> <u>the</u> <u>original</u> <u>data</u> <u>(left)</u> <u>and</u> <u>cleaned</u> <u>data</u> <u>(right)</u>

   <b>Cleaning</b> <b>OGR</b> <b>imported</b> <b>data</b> <b>(Simple</b> <b>Feature</b> <b>data)</b> <b>such</b> <b>as</b> <b>SHAPE</b> <b>file</b>
       The import of areas with <u>v.in.ogr</u> <u>-c</u> (no cleaning) requires a subsequent run of <u>v.clean</u> to update the map
       to a topologically valid structure (removal of duplicate collinear lines etc). The tools  used  for  that
       are <u>bpol</u> and <u>rmdupl</u>:
       v.clean input=areamap output=areamap_clean tool=bpol,rmdupl type=boundary

   <b>Extracting</b> <b>intersection</b> <b>points</b> <b>of</b> <b>vector</b> <b>lines</b>
       v.clean input=lines1 output=lines2 err=points tool=break type=line
       Intersection points are written to ’points’ map.

   <b>Break</b> <b>lines</b>
       <u>v.clean</u> will break the lines where they cross, creating new node if needed. Example:
       v.in.ascii -n out=crossed_lines format=standard &lt;&lt; EOF
       L 2
        0 5
        10 5
       L 2
        5 0
        5 10
       EOF
       v.clean in=crossed_lines out=crossed_lines_brk \
               error=intersection tool=break type=line

   <b>Remove</b> <b>all</b> <b>lines</b> <b>of</b> <b>zero</b> <b>length</b>
       v.out.ascii zero format=standard
       L  2 1
        -819832.09065589 -987825.2187231
        -806227.28362601 -971104.80702988
        1     1
       L  2 1
        -799165.24638913 -972974.16982788
        -799165.24638913 -972974.16982788
        1     2
       v.clean input=zero output=zero_clean tool=rmline type=line
       v.out.ascii zero_clean format=standard
       L  2 1
        -819832.09065589 -987825.2187231
        -806227.28362601 -971104.80702988
        1     1
       v.clean type=boundary would remove nothing.

   <b>Repeatedly</b> <b>remove</b> <b>dangling</b> <b>lines</b> <b>up</b> <b>to</b> <b>50m</b> <b>length</b>
       v.clean input=testmap output=cleanmap type=line \
               tool=rmdangle,rmdangle,rmdangle,rmdangle threshold=5,10,20,50

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        <u>v.info,</u> <u>v.build,</u> <u>g.gui.vdigit,</u> <u>v.edit,</u> <u>v.fill.holes,</u> <u>v.generalize</u>

</pre><h4><b>AUTHORS</b></h4><pre>
       David Gerdes, U.S. Army Construction Engineering Research Laboratory
       Radim Blazek, ITC-irst, Trento, Italy
       Martin Landa, FBK-irst (formerly ITC-irst), Trento, Italy

</pre><h4><b>SOURCE</b> <b>CODE</b></h4><pre>
       Available at: v.clean source code (history)

       Accessed: Friday Apr 04 01:20:12 2025

       Main index | Vector index | Topics index | Keywords index | Graphical index | Full index

       © 2003-2025 GRASS Development Team, GRASS GIS 8.4.1 Reference Manual

GRASS 8.4.1                                                                                      <u><a href="../man1grass/v.clean.1grass.html">v.clean</a></u>(1grass)
</pre>
 </div>
</div></section>
</div>
</body>
</html>