<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sem - semaphore for executing shell command lines in parallel</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/parallel">parallel_20240222+ds-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sem - semaphore for executing shell command lines in parallel

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>sem</b> [--fg] [--id &lt;id&gt;] [--semaphoretimeout &lt;secs&gt;] [-j &lt;num&gt;] [--wait] command

</pre><h4><b>DESCRIPTION</b></h4><pre>
       GNU <b>sem</b> is an alias for GNU <b>parallel</b> <b>--semaphore</b>.

       GNU <b>sem</b> acts as a counting semaphore. When GNU <b>sem</b> is called with command it starts the command in the
       background. When <u>num</u> number of commands are running in the background, GNU <b>sem</b> waits for one of these to
       complete before starting the command.

       GNU <b>sem</b> does not read any arguments to build the command (no -a, :::, and ::::). It simply waits for a
       semaphore to become available and then runs the command given.

       Before looking at the options you may want to check out the examples after the list of options. That will
       give you an idea of what GNU <b>sem</b> is capable of.

</pre><h4><b>OPTIONS</b></h4><pre>
       <u>command</u>  Command to execute. The command may be followed by arguments for the command.

       <b>--bg</b>     Run  command  in  background  thus  GNU  <b>sem</b>  will not wait for completion of the command before
                exiting. This is the default.

                In toilet analogy: GNU <b>sem</b> waits for a toilet to be available, gives the toilet to a person, and
                exits immediately.

                See also: <b>--fg</b>

       <b>--jobs</b> <u>N</u>
       <b>-j</b> <u>N</u>
       <b>--max-procs</b> <u>N</u>
       <b>-P</b> <u>N</u>     Run up to N commands in parallel. Default is 1 thus acting like a mutex.

                In toilet analogy: <b>-j</b> is the number of toilets.

       <b>--jobs</b> <u>+N</u>
       <b>-j</b> <u>+N</u>
       <b>--max-procs</b> <u>+N</u>
       <b>-P</b> <u>+N</u>    Add N to the number of CPU cores.  Run up to this many jobs in parallel. For  compute  intensive
                jobs <b>-j</b> +0 is useful as it will run number-of-cpu-cores jobs simultaneously.

       <b>--jobs</b> <u>-N</u>
       <b>-j</b> <u>-N</u>
       <b>--max-procs</b> <u>-N</u>
       <b>-P</b> <u>-N</u>    Subtract  N  from  the  number  of  CPU  cores.   Run  up to this many jobs in parallel.  If the
                evaluated number is less than 1 then 1 will be used.  See also <b>--use-cpus-instead-of-cores</b>.

       <b>--jobs</b> <u>N</u>%
       <b>-j</b> <u>N</u>%
       <b>--max-procs</b> <u>N</u>%
       <b>-P</b> <u>N</u>%    Multiply N% with the number of CPU cores.  Run up  to  this  many  jobs  in  parallel.   If  the
                evaluated number is less than 1 then 1 will be used.  See also <b>--use-cpus-instead-of-cores</b>.

       <b>--jobs</b> <u>procfile</u>
       <b>-j</b> <u>procfile</u>
       <b>--max-procs</b> <u>procfile</u>
       <b>-P</b> <u>procfile</u>
                Read  parameter  from file. Use the content of <u>procfile</u> as parameter for <u>-j</u>. E.g. <u>procfile</u> could
                contain the string 100% or +2 or 10.

       <b>--pipe</b>   Pass stdin (standard input) to <u>command</u>.

                If <u>command</u> read from stdin (standard input), use <b>--pipe</b>.

       <b>--semaphorename</b> <u>name</u>
       <b>--id</b> <u>name</u>
                Use <b>name</b> as the name of the semaphore. Default is the name of the controlling tty  (output  from
                <b>tty</b>).

                The  default  normally works as expected when used interactively, but when used in a script <u>name</u>
                should be set. <u>$$</u> or <u>my_task_name</u> are often a good value.

                The semaphore is stored in <a href="file:~/.parallel/semaphores/">~/.parallel/semaphores/</a>

                In toilet analogy the name corresponds  to  different  types  of  toilets:  e.g.  male,  female,
                customer, staff.

       <b>--fg</b>     Do not put command in background.

                In  toilet  analogy:  GNU  <b>sem</b> waits for a toilet to be available, takes a person to the toilet,
                waits for the person to finish, and exits.

       <b>--semaphoretimeout</b> <u>secs</u>
       <b>--st</b> <u>secs</u>
                If <u>secs</u> &gt; 0: If the semaphore is not released within <u>secs</u> seconds, take it anyway.

                If <u>secs</u> &lt; 0: If the semaphore is not released within <u>secs</u> seconds, exit.

                In toilet analogy: <u>secs</u> &gt; 0: If no toilet becomes available within  <u>secs</u>  seconds,  pee  on  the
                floor.  <u>secs</u>  &lt;  0:  If  no  toilet  becomes  available  within <u>secs</u> seconds, exit without doing
                anything.

       <b>--wait</b>   Wait for all commands to complete.

                In toilet analogy: Wait until all toilets are empty, then exit.

</pre><h4><b>UNDERSTANDING</b> <b>A</b> <b>SEMAPHORE</b></h4><pre>
       Try the following example:

         sem -j 2 'sleep 1;echo 1 finished';   echo sem 1 exited
         sem -j 2 'sleep 2;echo 2 finished';   echo sem 2 exited
         sem -j 2 'sleep 3;echo 3 finished';   echo sem 3 exited
         sem -j 2 'sleep 4;echo 4 finished';   echo sem 4 exited
         sem --wait; echo sem --wait done

       In toilet analogy this uses 2 toilets (<b>-j</b> <b>2</b>). GNU <b>sem</b> takes '1' to a toilet, and exits immediately. While
       '1' is sleeping, another GNU <b>sem</b> takes '2' to a toilet, and exits immediately.

       While '1' and '2' are sleeping, another GNU <b>sem</b> waits for a free toilet.  When  '1'  finishes,  a  toilet
       becomes available, and this GNU <b>sem</b> stops waiting, and takes '3' to a toilet, and exits immediately.

       While  '2'  and  '3'  are sleeping, another GNU <b>sem</b> waits for a free toilet.  When '2' finishes, a toilet
       becomes available, and this GNU <b>sem</b> stops waiting, and takes '4' to a toilet, and exits immediately.

       Finally another GNU <b>sem</b> waits for all toilets to become free.

</pre><h4><b>EXAMPLE:</b> <b>Gzipping</b> <b>*.log</b></h4><pre>
       Run one gzip process per CPU core. Block until a CPU core becomes available.

         for i in *.log ; do
           echo $i
           sem -j+0 gzip $i ";" echo done
         done
         sem --wait

</pre><h4><b>EXAMPLE:</b> <b>Protecting</b> <b>pod2html</b> <b>from</b> <b>itself</b></h4><pre>
       pod2html creates two files: pod2htmd.tmp and pod2htmi.tmp which it does not clean up. It uses  these  two
       files  for  a  short time. But if you run multiple pod2html in parallel (e.g. in a Makefile with make -j)
       there is a risk that two different instances of pod2html will write to the files at the same time:

         # This may fail due to shared pod2htmd.tmp/pod2htmi.tmp files
         foo.html:
                 pod2html foo.pod --outfile foo.html

         bar.html:
                 pod2html bar.pod --outfile bar.html

         $ make -j foo.html bar.html

       You need to protect pod2html from running twice at the same time.  <b>sem</b> running as a mutex will make  sure
       only one runs:

         foo.html:
                 sem --id pod2html pod2html foo.pod --outfile foo.html

         bar.html:
                 sem --id pod2html pod2html bar.pod --outfile bar.html

         clean: foo.html bar.html
                 sem --id pod2html --wait
                 rm -f pod2htmd.tmp pod2htmi.tmp

         $ make -j foo.html bar.html clean

</pre><h4><b>BUGS</b></h4><pre>
       None known.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<a href="mailto:bug-parallel@gnu.org">bug-parallel@gnu.org</a>&gt;.

</pre><h4><b>AUTHOR</b></h4><pre>
       Copyright (C) 2010-2024 Ole Tange, <a href="http://ole.tange.dk">http://ole.tange.dk</a> and Free Software Foundation, Inc.

</pre><h4><b>LICENSE</b></h4><pre>
       This  program  is  free  software;  you  can  redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation; either version 3 of the License,  or
       at your option any later version.

       This  program  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General  Public
       License for more details.

       You  should  have received a copy of the GNU General Public License along with this program.  If not, see
       &lt;https://www.gnu.org/licenses/&gt;.

   <b>Documentation</b> <b>license</b> <b>I</b>
       Permission is granted to copy, distribute and/or modify this documentation under the  terms  of  the  GNU
       Free  Documentation  License, Version 1.3 or any later version published by the Free Software Foundation;
       with no Invariant Sections, with no Front-Cover Texts, and with no  Back-Cover  Texts.   A  copy  of  the
       license is included in the file LICENSES/GFDL-1.3-or-later.txt.

   <b>Documentation</b> <b>license</b> <b>II</b>
       You are free:

       <b>to</b> <b>Share</b> to copy, distribute and transmit the work

       <b>to</b> <b>Remix</b> to adapt the work

       Under the following conditions:

       <b>Attribution</b>
                You  must  attribute  the work in the manner specified by the author or licensor (but not in any
                way that suggests that they endorse you or your use of the work).

       <b>Share</b> <b>Alike</b>
                If you alter, transform, or build upon this work, you may distribute  the  resulting  work  only
                under the same, similar or a compatible license.

       With the understanding that:

       <b>Waiver</b>   Any of the above conditions can be waived if you get permission from the copyright holder.

       <b>Public</b> <b>Domain</b>
                Where  the work or any of its elements is in the public domain under applicable law, that status
                is in no way affected by the license.

       <b>Other</b> <b>Rights</b>
                In no way are any of the following rights affected by the license:

                • Your  fair  dealing  or  fair  use  rights,  or  other  applicable  copyright  exceptions  and
                  limitations;

                • The author's moral rights;

                • Rights  other  persons  may have either in the work itself or in how the work is used, such as
                  publicity or privacy rights.

       <b>Notice</b>   For any reuse or distribution, you must make clear to others the license terms of this work.

       A copy of the full license is included in the file as LICENCES/CC-BY-SA-4.0.txt

</pre><h4><b>DEPENDENCIES</b></h4><pre>
       GNU <b>sem</b> uses Perl, and the Perl modules Getopt::Long, Symbol, Fcntl.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/parallel.1.html">parallel</a></b>(1)

20240222                                           2024-03-22                                             <u><a href="../man1/SEM.1.html">SEM</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>