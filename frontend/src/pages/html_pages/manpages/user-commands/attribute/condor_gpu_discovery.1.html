<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>condor_gpu_discovery - HTCondor Manual</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/condor">condor_23.6.2+dfsg-2build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       condor_gpu_discovery - HTCondor Manual

       Output GPU-related ClassAd attributes

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>condor_gpu_discovery</b> <b>-help</b>

       <b>condor_gpu_discovery</b> [<b>&lt;options&gt;</b> ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>condor_gpu_discovery</u>  outputs  ClassAd  attributes  corresponding  to  a  host's GPU capabilities. It can
       presently report CUDA and OpenCL devices; which type(s) of device(s) it reports is  determined  by  which
       libraries, if any, it can find when it runs; this reflects what GPU jobs will find on that host when they
       run. (Note that some HTCondor configuration settings may cause the environment to differ between jobs and
       the HTCondor daemons in ways that change library discovery.)

       If <b>CUDA_VISIBLE_DEVICES</b> or <b>GPU_DEVICE_ORDINAL</b> is set in the environment when <u>condor_gpu_discovery</u> is run,
       it will report only devices present in the those lists.

       This tool is not available for MAC OS platforms.

       With no command line options, the single ClassAd attribute <b>DetectedGPUs</b> is printed. If the value is 0, no
       GPUs  were  detected.  If one or more GPUS were detected, the value is a string, presented as a comma and
       space separated list of the GPUs discovered, where each is given a name further used as the <u>prefix</u> <u>string</u>
       in other attribute names. Where there is more than one GPU  of  a  particular  type,  the  <u>prefix</u>  <u>string</u>
       includes  an GPU id value identifying the device; these can be integer values that monotonically increase
       from 0 when the <b>-by-index</b> option is used or globally unique identifiers when  the  <b>-short-uuid</b>  or  <b>-uuid</b>
       argument is used.

       For example, a discovery of two GPUs with <b>-by-index</b> may output

          DetectedGPUs="CUDA0, CUDA1"

       Further  command  line  options use <b>"CUDA"</b> either with or without one of the integer values 0 or 1 as the
       name of the device properties ad for <b>-nested</b> properties, or as the <u>prefix</u> <u>string</u> in attribute names  when
       <b>-not-nested</b> properties are chosen.

       For  machines  with  more  than  one  or  two  NVIDIA  devices,  it  is recommended that you also use the
       <b>-short-uuid</b> or <b>-uuid</b> option.  The uuid value assigned by NVIDA to each GPU  is  unique,  so   using  this
       option  provides stable device identifiers for your devices. The <b>-short-uuid</b> option uses only part of the
       uuid, but it is highly likely to still be unique for devices on a single machine.   As  of  HTCondor  9.0
       <b>-short-uuid</b> is the default.  When <b>-short-uuid</b> is used, discovery of two GPUs may look like this

          DetectedGPUs="GPU-ddc1c098, GPU-9dc7c6d6"

       Any  NVIDIA  runtime library later than 9.0 will accept the above identifiers in the <b>CUDA_VISIBLE_DEVICES</b>
       environment variable.

       If the NVML libary is available, and a multi-instance GPU (MIG)  -capable  device  is  present,  has  MIG
       enabled,  and has created compute instances for each MIG instance, <u>condor_gpu_discovery</u> will report those
       instance as distinct devices.  Their names will be in the long UUID form unless the <b>-short-uuid</b> option is
       used, because they can not be enumerated via CUDA.  MIG instances  don't  have  some  of  the  properties
       reported  by  the <b>-properties</b>, <b>-extra</b>, and <b>-dynamic</b> options; these properties will be omitted.  If MIG is
       enabled on any GPU in the system, some properties  become  unavailable  for  every  GPU  in  the  system;
       <u>condor_gpu_discovery</u> will report what it can.

</pre><h4><b>OPTIONS</b></h4><pre>
          <b>-help</b>  Print usage information and exit.

          <b>-properties</b>
                 In  addition to the <b>DetectedGPUs</b> attribute, display some of the attributes of the GPUs. Each of
                 these attributes will be in a nested ClassAd (<b>-nested</b>) or have a <u>prefix</u> <u>string</u> at the beginning
                 of  its  name  (<b>-not-nested</b>).   The  displayed  CUDA  attributes  are  <b>Capability</b>,  <b>DeviceName</b>,
                 <b>DriverVersion</b>, <b>ECCEnabled</b>, <b>GlobalMemoryMb</b>, and <b>RuntimeVersion</b>. The displayed Open CL attributes
                 are <b>DeviceName</b>, <b>ECCEnabled</b>, <b>OpenCLVersion</b>, and <b>GlobalMemoryMb</b>.

          <b>-nested</b>

                 <b>Default.</b> <b>Display</b> <b>properties</b> <b>that</b> <b>are</b> <b>common</b> <b>to</b> <b>all</b> <b>GPUs</b> <b>in</b> <b>a</b> <b>Common</b> <b>nested</b> <b>ClassAd,</b>
                        and  properties  that  are  not common to all in a nested ClassAd using the GPUid as the
                        ClassAd name.  Use the <b>-not-nested</b> argument to disable nested ClassAds and return to the
                        older behavior of using a <u>prefix</u> <u>string</u> for individual property attributes.

          <b>-not-nested</b>

                 <b>Display</b> <b>properties</b> <b>that</b> <b>are</b> <b>common</b> <b>to</b> <b>all</b> <b>GPUs</b> <b>using</b> <b>a</b> <b>CUDA</b> <b>or</b> <b>OCL</b> <b>as</b>
                        the attribute prefix, and properties that are not common to all using  a  GPUid  prefix.
                        Versions of <u>condor_gpu_discovery</u> prior to 9.11.0 support only this mode.

          <b>-extra</b> Display  more  attributes  of  the  GPUs.  Each  of  these attributes will be added to a nested
                 property ClassAd (<b>-nested</b>) or have a <u>prefix</u> <u>string</u> at the beginning of its name  (<b>-not-nested</b>).
                 The  additional CUDA attributes are <b>ClockMhz</b>, <b>ComputeUnits</b>, and <b>CoresPerCU</b>. The additional Open
                 CL attributes are <b>ClockMhz</b> and <b>ComputeUnits</b>.

          <b>-dynamic</b>
                 Display attributes of NVIDIA devices that change values as the GPU is working.  Each  of  these
                 attributes  will  be added to the the nested property ClassAd (<b>-nested</b>) or have a <u>prefix</u> <u>string</u>
                 at the beginning of its name  (<b>-not-nested</b>).   These  are  <b>FanSpeedPct</b>,  <b>BoardTempC</b>,  <b>DieTempC</b>,
                 <b>EccErrorsSingleBit</b>, and <b>EccErrorsDoubleBit</b>.

          <b>-mixed</b> When  displaying  attribute values, assume that the machine has a heterogeneous set of GPUs, so
                 always include the integer value in the <u>prefix</u> <u>string</u>.

          <b>-device</b> <u>&lt;N&gt;</u>
                 Display properties only for GPU device <u>&lt;N&gt;</u>, where <u>&lt;N&gt;</u> is the  integer  value  defined  for  the
                 <u>prefix</u>  <u>string</u>.  This  option  may be specified more than once; additional <u>&lt;N&gt;</u> are listed along
                 with the first. This option adds to the  devices(s)  specified  by  the  environment  variables
                 <b>CUDA_VISIBLE_DEVICES</b> and <b>GPU_DEVICE_ORDINAL</b>, if any.

          <b>-tag</b> <u>string</u>
                 Set the resource tag portion of the intended machine ClassAd attribute <b>Detected&lt;ResourceTag&gt;</b> to
                 be  <u>string</u>. If this option is not specified, the resource tag is <b>"GPUs"</b>, resulting in attribute
                 name <b>DetectedGPUs</b>.

          <b>-prefix</b> <u>str</u>
                 When naming <b>-not-nested</b> attributes, use <u>str</u> as the <u>prefix</u>  <u>string</u>.  When  this  option  is  not
                 specified, the <u>prefix</u> <u>string</u> is either <b>CUDA</b> or <b>OCL</b> unless <b>-uuid</b> or <b>-short-uuid</b> is also used.

          <b>-by-index</b>
                 Use the prefix and device index as the device identifier.

          <b>-short-uuid</b>
                 Use  the  first  8 characters of the NVIDIA uuid as the device identifier.  When this option is
                 used, devices will be shown as <b>GPU-&lt;xxxxxxxx&gt;</b> where &lt;xxxxxxxx&gt; is the first 8 hex digits of the
                 NVIDIA device uuid.  Unlike device indices, the uuid of a  device  will  not  change  of  other
                 devices are taken offline or drained.

          <b>-uuid</b>  Use the full NVIDIA uuid as the device identifier rather than the device index.

          <b>-simulate:[D,N[,D2,...]]</b>
                 For testing purposes, assume that N devices of type D were detected, And N2 devices of type D2,
                 etc.   No discovery software is invoked. D can be a value from 0 to 6 which selects a simulated
                 a GPU from the following table.

</pre><h4><b>SIMULATED</b> <b>GPUS</b></h4><pre>
                             ┌───┬────────────────────────┬────────────┬────────────────┐
                             │   │ DeviceName             │ Capability │ GlobalMemoryMB │
                             ├───┼────────────────────────┼────────────┼────────────────┤
                             │ 0 │ GeForce GT 330         │ 1.2        │ 1024           │
                             ├───┼────────────────────────┼────────────┼────────────────┤
                             │ 1 │ GeForce GTX 480        │ 2.0        │ 1536           │
                             ├───┼────────────────────────┼────────────┼────────────────┤
                             │ 2 │ Tesla V100-PCIE-16GB   │ 7.0        │ 24220          │
                             ├───┼────────────────────────┼────────────┼────────────────┤
                             │ 3 │ TITAN RTX              │ 7.5        │ 24220          │
                             ├───┼────────────────────────┼────────────┼────────────────┤
                             │ 4 │ A100-SXM4-40GB         │ 8.0        │ 40536          │
                             ├───┼────────────────────────┼────────────┼────────────────┤
                             │ 5 │ NVIDIA  A100-SXM4-40GB │ 8.0        │ 20096          │
                             │   │ MIG 3g.20gb            │            │                │
                             ├───┼────────────────────────┼────────────┼────────────────┤
                             │ 6 │ NVIDIA  A100-SXM4-40GB │ 8.0        │ 4864           │
                             │   │ MIG 1g.5gb             │            │                │
                             └───┴────────────────────────┴────────────┴────────────────┘

       <b>-opencl</b>
              Prefer detection via OpenCL rather than CUDA. Without this  option,  CUDA  detection  software  is
              invoked first, and no further Open CL software is invoked if CUDA devices are detected.

       <b>-cuda</b>  Do only CUDA detection.

       <b>-nvcuda</b>
              For Windows platforms only, use a CUDA driver rather than the CUDA run time.

       <b>-config</b>
              Output  in  the  syntax  of  HTCondor  configuration,  instead  of ClassAd language. An additional
              attribute is produced <b>NUM_DETECTED_GPUs</b> which is set to the number of GPUs detected.

       <b>-repeat</b> [<u>N</u>]
              Repeat listed GPUs <u>N</u> (default 2) times.  This results in a list  that  looks  like  <b>CUDA0,</b>  <b>CUDA1,</b>
              <b>CUDA0,</b> <b>CUDA1</b>.

              If  used  with  <b>-divide</b>, the last one on the command-line wins, but you must specify <b>2</b> if you want
              it; the default value only applies to the first flag.

       <b>-divide</b> [<u>N</u>]
              Like <b>-repeat</b>, except also divide the attribute <b>GlobalMemoryMb</b> by  <u>N</u>.   This  may  help  you  avoid
              overcommitting your GPU's memory.

              If  used  with  <b>-repeat</b>, the last one on the command-line wins, but you must specify <b>2</b> if you want
              it; the default value only applies to the first flag.

       <b>-packed</b>
              When repeating GPUs, repeat each GPU <u>N</u> times, not the whole list.  This results  in  a  list  that
              looks like <b>CUDA0,</b> <b>CUDA0,</b> <b>CUDA1,</b> <b>CUDA1</b>.

       <b>-cron</b>  This  option  suppresses  the  <b>DetectedGpus</b>  attribute so that the output is suitable for use with
              <u>condor_startd</u> cron. Combine this option with the  <b>-dynamic</b>  option  to  periodically  refresh  the
              dynamic  Gpu  information  such  as  temperature. For example, to refresh GPU temperatures every 5
              minutes

                 use FEATURE : StartdCronPeriodic(DYNGPUS, 5*60, $(LIBEXEC)/condor_gpu_discovery, -dynamic -cron)

       <b>-verbose</b>
              For interactive use of the tool, output extra information to show detection while in progress.

       <b>-diagnostic</b>
              Show diagnostic information, to aid in tool development.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <u>condor_gpu_discovery</u> will exit with a status value of 0 (zero) upon success, and it will  exit  with  the
       value 1 (one) upon failure.

</pre><h4><b>AUTHOR</b></h4><pre>
       HTCondor Team

</pre><h4><b>COPYRIGHT</b></h4><pre>
       1990-2024,  Center  for High Throughput Computing, Computer Sciences Department, University of Wisconsin-
       Madison, Madison, WI, US. Licensed under the Apache License, Version 2.0.

                                                  Jan 04, 2025                           <u><a href="../man1/CONDOR_GPU_DISCOVERY.1.html">CONDOR_GPU_DISCOVERY</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>