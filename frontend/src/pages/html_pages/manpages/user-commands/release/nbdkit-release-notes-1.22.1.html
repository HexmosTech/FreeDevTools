<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbdkit-release-notes-1.22 - release notes for nbdkit 1.22</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nbdkit">nbdkit_1.42.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nbdkit-release-notes-1.22 - release notes for nbdkit 1.22

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These are the release notes for nbdkit stable release 1.22.  This describes the major changes since 1.20.

       nbdkit 1.22.0 was released on <b>27</b> <b>August</b> <b>2020</b>.

   <b>Security</b>
       There were no security issues found.  All past security issues and information about how to report new
       ones can be found in <b><a href="../man1/nbdkit-security.1.html">nbdkit-security</a></b>(1).

   <b>Plugins</b>
       New <b><a href="../man1/nbdkit-cdi-plugin.1.html">nbdkit-cdi-plugin</a></b>(1) (Containerized Data Importer) lets you export a single layer from a container
       image, allowing you to access disk images distributed using container registry infrastructure.

       New <b><a href="../man1/nbdkit-ondemand-plugin.1.html">nbdkit-ondemand-plugin</a></b>(1) creates filesystems for clients on demand.

       New <b><a href="../man1/nbdkit-torrent-plugin.1.html">nbdkit-torrent-plugin</a></b>(1) serves a BitTorrent file or magnet link over NBD.

       <b><a href="../man1/nbdkit-data-plugin.1.html">nbdkit-data-plugin</a></b>(1) and <b><a href="../man1/nbdkit-memory-plugin.1.html">nbdkit-memory-plugin</a></b>(1) have a new "allocator" parameter giving more fine-
       grained control over the allocation strategy.  Currently implemented strategies are: sparse array, sparse
       array with zstd compression, malloc, and malloc with mlock.

       <b><a href="../man1/nbdkit-data-plugin.1.html">nbdkit-data-plugin</a></b>(1) data format now supports strings and alignment.  The "disk2data.pl" script has been
       enhanced to detect repeated sequences and produce a more compact output.

       <b><a href="../man1/nbdkit-curl-plugin.1.html">nbdkit-curl-plugin</a></b>(1) adds support for arbitrary custom request headers.  Also it now supports scripts
       for generating cookies and custom request headers.  This is especially useful when accessing web servers
       that require authentication which has to be renewed periodically.

       <b><a href="../man1/nbdkit-curl-plugin.1.html">nbdkit-curl-plugin</a></b>(1) now supports HTTP/2 servers (David Edmondson, Pino Toscano, Zi Liu).

       <b><a href="../man1/nbdkit-curl-plugin.1.html">nbdkit-curl-plugin</a></b>(1) adds support for the "User-Agent" header.

       <b><a href="../man1/nbdkit-file-plugin.1.html">nbdkit-file-plugin</a></b>(1) can export multiple files in a directory as separate exports (Eric Blake).

       <b><a href="../man1/nbdkit-file-plugin.1.html">nbdkit-file-plugin</a></b>(1) supports new "cache=none" and "fadvise=normal|random|sequential" parameters which
       can be used to optimize access patterns and avoid filling the page cache.

       <b><a href="../man1/nbdkit-nbd-plugin.1.html">nbdkit-nbd-plugin</a></b>(1) supports proxying to another NBD server over "AF_VSOCK" (Eric Blake).

       <b><a href="../man1/nbdkit-nbd-plugin.1.html">nbdkit-nbd-plugin</a></b>(1) supports new "command=" and "socket-fd=" parameters which allow you to run a
       subordinate NBD server as a command directly from the plugin, or pass in an already connected NBD
       endpoint.

       <b><a href="../man1/nbdkit-streaming-plugin.1.html">nbdkit-streaming-plugin</a></b>(1) supports streaming to and from local pipes.

       <b><a href="../man1/nbdkit-vddk-plugin.1.html">nbdkit-vddk-plugin</a></b>(1) now has support for VDDK 7.0.  A new and useless "error" message printed by VDDK 7
       has been suppressed (thanks Ming Xie, Pino Toscano).

       nbdkit-ext2-plugin has been removed.  It was deprecated in nbdkit 1.17.8.  All existing uses can be
       replaced with <b><a href="../man1/nbdkit-ext2-filter.1.html">nbdkit-ext2-filter</a></b>(1).

       The "-" character is now permitted within plugin and filter names (Eric Blake).

   <b>Filters</b>
       New <b><a href="../man1/nbdkit-ddrescue-filter.1.html">nbdkit-ddrescue-filter</a></b>(1) lets you test disk images recovered by <b><a href="../man1/ddrescue.1.html">ddrescue</a></b>(1) (François Revol).

       New <b><a href="../man1/nbdkit-gzip-filter.1.html">nbdkit-gzip-filter</a></b>(1) can decompress a plugin that contains gzip-compressed data.  It replaces
       nbdkit-gzip-plugin which is deprecated and will be removed in nbdkit 1.26.

       New <b><a href="../man1/nbdkit-pause-filter.1.html">nbdkit-pause-filter</a></b>(1) can temporarily stop and later resume NBD requests.  This can be used when
       taking snapshots.

       New <b><a href="../man1/nbdkit-swab-filter.1.html">nbdkit-swab-filter</a></b>(1) swaps bytes in the underlying plugin, which can be used to adjust images that
       have an incorrect byte order (François Revol).

       New <b><a href="../man1/nbdkit-tar-filter.1.html">nbdkit-tar-filter</a></b>(1) reads and writes files inside a tar file in the underlying plugin.  It replaces
       nbdkit-tar-plugin which is deprecated and will be removed in nbdkit 1.26.

       New <b><a href="../man1/nbdkit-tls-fallback-filter.1.html">nbdkit-tls-fallback-filter</a></b>(1) provides alternate content when a client connects without using TLS to
       a server that permits but does not require TLS (Eric Blake).

       <b><a href="../man1/nbdkit-fua-filter.1.html">nbdkit-fua-filter</a></b>(1) has new option "fuamode=pass" to pass through FUA and flush requests unchanged
       (disabling the filter).  A new, unsafe "fuamode=discard" mode was added which discards FUA and flush
       requests.

   <b>Language</b> <b>bindings</b>
       New <b><a href="../man3/nbdkit-cc-plugin.3.html">nbdkit-cc-plugin</a></b>(3) lets you write small nbdkit plugins as inline C, C++ or OCaml "scripts" (and
       potentially other ahead-of-time compiled programming languages).

       <b><a href="../man3/nbdkit-rust-plugin.3.html">nbdkit-rust-plugin</a></b>(3) bindings have been replaced by higher level and more idiomatic bindings.  These
       also support a greater range of server features (Alan Somers).

       <b><a href="../man3/nbdkit-python-plugin.3.html">nbdkit-python-plugin</a></b>(3) now supports parallel plugins.  These cannot run Python code in parallel (because
       of the Python GIL), but for Python code that blocks, eg. calling out to external services, requests can
       now be handled in parallel (thanks Nir Soffer).

       <b><a href="../man3/nbdkit-python-plugin.3.html">nbdkit-python-plugin</a></b>(3) has a greater range of examples (Nir Soffer).

       <b><a href="../man3/nbdkit-python-plugin.3.html">nbdkit-python-plugin</a></b>(3) adds support for getting the client export name, calling "nbdkit_debug", and also
       for extents.

   <b>Server</b>
       "nbdkit --dump-config" has new fields: "version_major" and "version_minor" to allow easier version
       parsing from scripts.  "host_cpu" and "host_os" so you can find out if nbdkit was cross-compiled for
       another platform.  "zstd=(yes|no)" so you can find out if nbdkit was compiled with zstd compression
       support.

       The <u>-e</u>/<u>--exportname</u> option (which never did anything useful previously) is now used to pass the preferred
       exportname to the <u>--run</u> option.  In general you should never use this option except in very limited and
       exceptional circumstances (Eric Blake).

   <b>API</b>
       New ".after_fork" callback which can be used for plugins which need to create background threads, since
       those threads would otherwise be stranded if the server forks into the background.  The VDDK plugin now
       defers VDDK library initialization til ".after_fork" because it is thought that the library creates
       background threads especially when accessing remote servers.

       New API "nbdkit_extents_aligned" is a helper function for filters that retrieves extents as needed until
       at least a certain range is covered (Eric Blake).

       New "nbdkit_is_tls" can be called to determine if TLS was negotiated on the connection.  Plugins could
       use this to hide certain exports from non-authenticated/non-encrypted clients (Eric Blake).

       "nbdkit_read_password" with "password=-" will now return an error if the input is not a tty.  Also
       "password=-FD" is disallowed if the file descriptor is 0, 1 or 2.

   <b>Bug</b> <b>fixes</b>
       The VDDK plugin was extensively refactored to fix many bugs: Reading passwords from a tty should work
       again.  The plugin should now work properly when daemonized or using the <u>--run</u> option.  The threading
       model has been relaxed to "SERIALIZE_REQUESTS" which should give small performance improvements when
       using multiple connections.

       The "base64" option of <b><a href="../man1/nbdkit-data-plugin.1.html">nbdkit-data-plugin</a></b>(1) has been fixed so it sets the implicit size correctly.

       The "&lt;FILE" formatter of <b><a href="../man1/nbdkit-data-plugin.1.html">nbdkit-data-plugin</a></b>(1) now works if you use it more than once.

   <b>Documentation</b>
       New <b><a href="../man1/nbdkit-client.1.html">nbdkit-client</a></b>(1) manual page documents how to mount filesystems from NBD exports on client machines,
       either directly or using systemd mountpoints.

       Examples now use "NBDKIT_API_VERSION 2" so that the examples match the documentation.

   <b>Tests</b>
       The tests should now pass on OpenBSD ≥ 6.4.

       <u>tests/Makefile.am</u> was refactored: There is now no longer a single massive "EXTRA_DIST".  Creation of test
       disks was refactored.

       Some tests will now use new libnbd 1.4 tools <b><a href="../man1/nbdcopy.1.html">nbdcopy</a></b>(1) and <b><a href="../man1/nbdinfo.1.html">nbdinfo</a></b>(1) if available, and skip the tests
       otherwise.

       New test functions "requires_plugin" and "requires_filter" allows tests to be skipped if the
       corresponding plugin/filter was not compiled on a particular platform.  So tests should now not fail when
       an optional external library needed by a plugin/filter is not available.

   <b>Build</b>
       Honggfuzz may now be used for fuzz testing.

       If <b><a href="../man3/nbdkit-python-plugin.3.html">nbdkit-python-plugin</a></b>(3) is enabled, Python ≥ 3.6 must be used.

   <b>Internals</b>
       The export name is now passed down through filter ".open" callbacks, allowing filters to modify the
       export name passed through to plugins.

       The final thread model is passed to filter ".get_ready" callbacks.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1).

</pre><h4><b>AUTHORS</b></h4><pre>
       Authors of nbdkit 1.22:

       Alan Somers
           (7 commits)

       Eric Blake
           (53 commits)

       François Revol
           (2 commits)

       Nir Soffer
           (2 commits)

       Richard W.M. Jones
           (285 commits)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       Redistribution  and  use in source and binary forms, with or without modification, are permitted provided
       that the following conditions are met:

       •   Redistributions of source code must retain the above copyright notice, this list  of  conditions  and
           the following disclaimer.

       •   Redistributions in binary form must reproduce the above copyright notice, this list of conditions and
           the following disclaimer in the documentation and/or other materials provided with the distribution.

       •   Neither  the  name  of  Red  Hat  nor the names of its contributors may be used to endorse or promote
           products derived from this software without specific prior written permission.

       THIS SOFTWARE IS PROVIDED BY RED HAT AND CONTRIBUTORS ''AS IS'' AND ANY EXPRESS  OR  IMPLIED  WARRANTIES,
       INCLUDING,  BUT  NOT  LIMITED  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
       PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL RED HAT OR CONTRIBUTORS BE LIABLE  FOR  ANY  DIRECT,  INDIRECT,
       INCIDENTAL,  SPECIAL,  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
       SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
       ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  LIABILITY,  OR  TORT  (INCLUDING  NEGLIGENCE  OR
       OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
       DAMAGE.

nbdkit-1.42.2                                      2025-04-02                       <u><a href="../man1/nbdkit-release-notes-1.22.1.html">nbdkit-release-notes-1.22</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>