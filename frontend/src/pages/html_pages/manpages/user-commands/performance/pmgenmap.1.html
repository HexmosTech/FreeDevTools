<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmgenmap - generate C code to simplify handling of performance metrics</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/pcp">pcp_6.3.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmgenmap</b> - generate C code to simplify handling of performance metrics

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pmgenmap</b> [<u>infile</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Given one or more lists of metric names in <u>infile</u> or on standard input, <b>pmgenmap</b> generates C declarations
       and  <b><a href="../man1/cpp.1.html">cpp</a></b>(1)  macros  suitable  for  use  across  the Performance Metrics Programming Interface (PMAPI) on
       standard output.

       The declarations produced by <b>pmgenmap</b> simplify the coding for client applications using the PMAPI.

       The input should consist of one or more lists of metric names of the form

            listname {
                metricname1 symbolname1
                metricname2 symbolname2
                ...
            }

       which will generate C and <b><a href="../man1/cpp.1.html">cpp</a></b>(1) declarations of the form

            char *listname[] = {
            #define symbolname1 0
                "metricname1",
            #define symbolname2 1
                "metricname2",
                ...
            };

       The array declarations produced are suitable as parameters to <b><a href="../man3/pmLookupName.3.html">pmLookupName</a></b>(3) and the <b>#define</b>d  constants
       may be used to index the <u>vset</u>s in the <u>pmResult</u> structure returned by a <b><a href="../man3/pmFetch.3.html">pmFetch</a></b>(3) call.

       Obviously,  <u>listname</u>  must  conform to the C identifier naming rules, each <u>symbolname</u> must conform to the
       <b><a href="../man1/cpp.1.html">cpp</a></b>(1) macro naming rules, and each <u>metricname</u> is expected to be a valid performance  metrics  name  (see
       <b><a href="../man5/PMNS.5.html">PMNS</a></b>(5) for more details).

       The input may include <b>sh</b>-style comment lines, i.e. with a `<b>#</b>' as the first non-blank character of a line,
       and  these are translated on output to either single line or multi-line C comments in the K&amp;R style.  For
       example, the input:

            # leading block of multi-line comments
            # initialization group
            foo {
                    a.b.c   ONE
                    d.e.f.g TWO
                    # embedded block of multi-lines
                    # comments and boring pad text
                    xx.yy.zz        THREE
            }

            # trailing single line comment

       Produces the output:

            /*
             * leading block of multi-line comments
             * initialization group
             */
            char *foo[] = {
            #define ONE 0
                    "a.b.c",
            #define TWO 1
                    "d.e.f.g",
            /*
             * embedded block of multi-lines
             * comments and boring pad text
             */
            #define THREE 2
                    "xx.yy.zz",

            };

            /* trailing single line comment */

</pre><h4><b>EXAMPLES</b></h4><pre>
       For brevity we have removed the error handling code, and assumed the chosen metrics do not have  multiple
       values.

       The input file

            mystats {
                kernel.percpu.cpu.idle     IDLE
                kernel.percpu.cpu.sys      SYS
                kernel.percpu.cpu.user     USER
                hinv.ncpu                       NCPU
            }

       produces the following C code, suitable for <b>#include</b>-ing

            /*
             * Performance Metrics Name Space Map
             * Built by pmgenmap from the file
             * mystats.metrics
             * on Wed Dec 28 19:44:17 EST 1994
             *
             * Do not edit this file!
             */

            char *mystats[] = {
            #define IDLE    0
                    "kernel.percpu.cpu.idle",
            #define SYS     1
                    "kernel.percpu.cpu.sys",
            #define USER    2
                    "kernel.percpu.cpu.user",
            #define NCPU    3
                    "hinv.ncpu",

            };

       Using  the  code  generated  by  <b>pmgenmap</b>,  we are now able to easily obtain metrics from the Performance
       Metrics Collection Subsystem (PMCS) as follows:

            #define MAX_PMID 4

                int         trip = 0;
                int         numpmid = <a href="../manmystats/sizeof.mystats.html">sizeof</a>(mystats)/sizeof(mystats[0]);
                double      duration;
                pmResult    *resp;
                pmResult    *prev;
                pmID        pmidlist[MAX_PMID];

                pmNewContext(PM_CONTEXT_HOST, "localhost");
                pmLookupName(numpmid, mystats, pmidlist);
                pmFetch(numpmid, pmidlist, &amp;resp);

                printf("%d CPUs: %d usr   %d sys   %d   idle0,
                       resp-&gt;vset[NCPU]-&gt;vlist[0].value.lval,
                       resp-&gt;vset[USER]-&gt;vlist[0].value.lval,
                       resp-&gt;vset[SYS]-&gt;vlist[0].value.lval,
                       resp-&gt;vset[IDLE]-&gt;vlist[0].value.lval);

       Some calls to ensure portability have been removed from the code above for the  sake  of  clarity  -  the
       example  above  should  not  be used as a template for programming.  In particular, the raw values of the
       metrics were used when <b><a href="../man3/pmLookupDesc.3.html">pmLookupDesc</a></b>(3) should have been called to determine the semantics of each metric.

       More complete examples that demonstrate the use of <b>pmgenmap</b> which may be used  as  a  basis  for  program
       development are included in the PCP demos, e.g.  <u>$PCP_DEMOS_DIR/pmclient</u>.

</pre><h4><b>FILES</b></h4><pre>
       <u>$PCP_VAR_DIR/pmns/*</u>
            default PMNS specification files

</pre><h4><b>PCP</b> <b>ENVIRONMENT</b></h4><pre>
       Environment  variables with the prefix <b>PCP_</b> are used to parameterize the file and directory names used by
       PCP.  On each installation, the file <u>/etc/pcp.conf</u> contains the local values for  these  variables.   The
       <b>$PCP_CONF</b> variable may be used to specify an alternative configuration file, as described in <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/cpp.1.html">cpp</a></b>(1), <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3), <b><a href="../man3/pmFetch.3.html">pmFetch</a></b>(3), <b><a href="../man3/pmLookupName.3.html">pmLookupName</a></b>(3), <b><a href="../man3/pmNewContext.3.html">pmNewContext</a></b>(3), <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5), <b><a href="../man5/pcp.env.5.html">pcp.env</a></b>(5) and <b><a href="../man5/PMNS.5.html">PMNS</a></b>(5).

Performance Co-Pilot                                   PCP                                           <u><a href="../man1/PMGENMAP.1.html">PMGENMAP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>