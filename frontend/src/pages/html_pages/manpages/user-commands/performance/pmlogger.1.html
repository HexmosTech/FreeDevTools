<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmlogger - create an archive for performance metrics</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/pcp">pcp_6.3.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmlogger</b> - create an archive for performance metrics

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pmlogger</b>  [<b>-CLNoPruy?</b>]   [<b>-c</b>  <u>conffile</u>] [<b>-d</b> <u>directory</u>] [<b>-h</b> <u>host</u>] [<b>-H</b> <u>hostname</u>] [<b>-I</b> <u>version</u>] [<b>-K</b> <u>spec</u>] [<b>-l</b>
       <u>logfile</u>] [<b>-m</b> <u>note</u>] [<b>-n</b> <u>pmnsfile</u>] [<b>-p</b> <u>pid</u>] [<b>-s</b> <u>endsize</u>] [<b>-t</b>  <u>interval</u>]  [<b>-T</b>  <u>endtime</u>]  [<b>-U</b>  <u>username</u>]  [<b>-v</b>
       <u>volsize</u>] [<b>-V</b> <u>version</u>] [<b>-x</b> <u>fd</u>] <u>archive</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>pmlogger</b>  creates  the  archives  of  performance  metric  values  that  may  be ``played back'' by other
       Performance Co-Pilot (see <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1)) tools.  These  logs  form  the  basis  of  the  VCR  paradigm  and
       retrospective performance analysis services common to the PCP toolkit.

       The  mandatory  argument <u>archive</u> is the base name for the physical files that constitute an archive.  The
       <u>archive</u> argument may contain <b><a href="../man3/strftime.3.html">strftime</a></b>(3) meta-characters, which will be substituted prior to creating the
       archive files.  When <b>pmlogger</b> is run as a service (see <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1)), the standard archive base name
       template is <b>%Y%m%d.%H.%M</b>.

       The <b>-V</b> option specifies the version for the archive that is generated.  By default  the  archive  version
       <b>$PCP_ARCHIVE_VERSION</b>  (set to 3 in current PCP releases) is used, and the only values currently supported
       for <u>version</u> are 2 or 3.

       Unless directed to another host by the <b>-h</b> option or when directly using PMDAs via the <b>-o</b> option, <b>pmlogger</b>
       will contact the Performance Metrics Collector Daemon (PMCD) on the local host and use that as the source
       of the metric values to be logged.

       To support the required flexibility and control over what is  logged  and  when,  <b>pmlogger</b>  maintains  an
       independent  two  level  logging  state  for  each  instance  of  each  performance metric.  At the first
       (mandatory) level, logging is allowed to be <b>on</b> (with an associated interval between samples), or  <b>off</b>  or
       <b>maybe</b>.   In  the latter case, the second (advisory) level logging is allowed to be <b>on</b> (with an associated
       interval between samples), or <b>off</b>.

       The mandatory level allows universal specification that some metrics must  be  logged,  or  must  <b>not</b>  be
       logged.   The  default state for all instances of all metrics when <b>pmlogger</b> starts is mandatory maybe and
       advisory off.

       Use <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1) to interrogate and change the logging state once <b>pmlogger</b> is running.

       If a metric's state is mandatory (on or off) and a request is made to change it to mandatory  maybe,  the
       new state is mandatory maybe and advisory off.  If a metric's state is already advisory (on or off) and a
       request is made to change it to mandatory maybe, the current state is retained.

       It  is  not  possible  for  <b>pmlogger</b>  to log specific instances of a metric and all instances of the same
       metric concurrently.  If specific instances are being logged and a request to log all instances is  made,
       then  all  instances  of  the  metric  will be logged according to the new request, superseding any prior
       logging request for the metric.  A request to log all instances of a metric will supersede  any  previous
       request  to  log  all  instances.  A request to log specific instances of a metric when all instances are
       already being logged is refused.  To do this one must turn off logging for all instances  of  the  metric
       first.   In  each  case,  the validity of the request is checked first; for example a request to change a
       metric's logging state to advisory on when it is currently  mandatory  off  is  never  permitted  (it  is
       necessary to change the state to mandatory maybe first).

       Optionally,  each  system  running <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) may also be configured to run a ``primary'' <b>pmlogger</b> instance.
       This  <b>pmlogger</b>  instance  is  launched  by  <b>$PCP_RC_DIR/pmlogger</b>,  and   is   affected   by   the   files
       <b>$PCP_SYSCONF_DIR/pmlogger/control</b>, <b>$PCP_SYSCONF_DIR/pmlogger/control.d/*</b>, (use <b><a href="../man8/chkconfig.8.html">chkconfig</a></b>(8), <b><a href="../man1/systemctl.1.html">systemctl</a></b>(1)
       or   similar   platform-specific  commands  to  activate  or  disable  the  primary  <b>pmlogger</b>  instance),
       <b>$PCP_SYSCONFIG_DIR/pmlogger</b>    (environment    variable    settings    for    the    primary    <b>pmlogger</b>)
       <b>$PCP_SYSCONF_DIR/pmlogger/pmlogger.options</b>  (command  line  options  passed  to the primary <b>pmlogger</b>) and
       <b>$PCP_VAR_DIR/config/pmlogger/config.default</b> (the default  initial  configuration  file  for  the  primary
       <b>pmlogger</b>).

       The  primary  <b>pmlogger</b>  instance  is  identified  by the <b>-P</b> option.  There may be at most one ``primary''
       <b>pmlogger</b> instance on each system.  The primary <b>pmlogger</b> instance (if any) must be  running  on  the  same
       host as the <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) to which it connects (if any), so the <b>-h</b> and <b>-P</b> options are mutually exclusive.

       Logging  of  some  metrics  is possible even in the absence of a local <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1), using the "local context"
       mode of operation.  This is activated using the <b>-o</b> option, and causes <b>pmlogger</b> to make use of  local  DSO
       PMDAs  instead of communicating with <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1).  When operating using a local context, the <b>-K</b> option may be
       used to control the DSO PMDAs that should be made accessible.  The <u>spec</u> argument conforms to  the  syntax
       described in <b><a href="../man3/pmSpecLocalPMDA.3.html">pmSpecLocalPMDA</a></b>(3).  More than one <b>-K</b> option may be used.

       When  launched as a non-primary instance, <b>pmlogger</b> will exit immediately if the configuration file causes
       no metric logging to be scheduled.  The <b>-L</b> option overrides  this  behavior,  and  causes  a  non-primary
       <b>pmlogger</b> instance to ``linger'', presumably pending some future dynamic re-configuration and state change
       via  <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1).  <b>pmlogger</b> will also linger without the <b>-L</b> option being used if all the metrics to be logged
       are logged as once only metrics.  When the once only metrics have been logged, a warning message will  be
       generated stating that the event queue is empty and no more events will be scheduled.

       By default all diagnostics and errors from <b>pmlogger</b> are written to the file <b>pmlogger.log</b> in the directory
       where <b>pmlogger</b> is launched.  The <b>-l</b> option may be used to override the default behavior.  If the log file
       cannot  be  created  or is not writable, output is written to standard error instead.  If the <u>logfile</u> for
       the <b>-l</b> option is "<b>-</b>" (i.e.  <b>-l-</b>) then log messages are written to the standard output stream.   This  can
       be particularly useful when running <b>pmlogger</b> manually, rather than as a service daemon.

       The <b>-N</b> option directs <b>pmlogger</b> to notify a service manager, typically <b><a href="../man1/systemd.1.html">systemd</a></b>(1), when it has started and
       is  about to begin writing PCP archives.  This option would only normally be used when <b>pmlogger</b> is run as
       a   daemon   service   under   the   control   of   a   service   manager.    For   more   details,   see
       <b><a href="../man3/__pmServerNotifyServiceManagerReady.3.html">__pmServerNotifyServiceManagerReady</a></b>(3)  and  <b><a href="../man1/systemd.1.html">systemd</a></b>(1).   On platforms that do not use a service manager
       that supports notifications, the <b>-N</b> option is basically a no-op.

       If specified, the <b>-s</b> option instructs <b>pmlogger</b> to terminate after a certain size  in  records,  bytes  or
       time  units  has  been accumulated.  If <u>endsize</u> is an integer then <u>endsize</u> records will be written to the
       archive.  If <u>endsize</u> is an integer suffixed by <b>b</b> or <b>bytes</b> then <u>endsize</u> bytes of the archive data will  be
       written  out  (note,  however, that archive record boundaries will not be broken and so this limit may be
       slightly surpassed).  Other viable file size units include: <b>K</b>, <b>Kb</b>, <b>KiB</b>, <b>Kbyte</b>, <b>Kilobyte</b> for kilobytes and
       <b>M</b>, <b>Mb</b>, <b>MiB</b>, <b>Mbyte</b>, <b>Megabyte</b> for megabytes and <b>G</b>, <b>Gb</b>, <b>GiB</b>, <b>Gbyte</b>, <b>Gigabyte</b> for gigabytes.  These units may
       be optionally suffixed by an <b>s</b> and may be of mixed case.  Alternatively <u>endsize</u> may be an  integer  or  a
       floating  point  number  suffixed using a time unit as described in <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1) for the <u>interval</u> argument
       (to the standard PCP <b>-t</b> command line option).
       Some examples of different formats:
          <b>-s</b> <b>100</b>
          <b>-s</b> <b>100bytes</b>
          <b>-s</b> <b>100K</b>
          <b>-s</b> <b>100Mb</b>
          <b>-s</b> <b>10Gbyte</b>
          <b>-s</b> <b>10mins</b>
          <b>-s</b> <b>1.5hours</b>
       The default is for <b>pmlogger</b> to run forever.

       The <b>-r</b> option causes the size of the physical record(s) for  each  group  of  metrics  and  the  expected
       contribution of the group to the size of the PCP archive for one full day of collection to be reported in
       the  log  file.   This  information  is reported the first time each group is successfully written to the
       archive.

       The <b>-U</b> option specifies the user account under which to run <b>pmlogger</b>.  The default is  the  current  user
       account  for  interactive  use.   When run as a daemon, the unprivileged "pcp" account is used in current
       versions of PCP, but in older versions the superuser account ("root") was used by default.

       The archive is potentially a multi-volume data set, and the <b>-v</b> option causes  <b>pmlogger</b>  to  start  a  new
       volume after a certain size in records, bytes, or time units has been accumulated for the current volume.
       The  format of this size specification is identical to that of the <b>-s</b> option (see above).  The default is
       for <b>pmlogger</b> to create  a  single  volume  archive.   Additional  volume  switches  can  also  be  forced
       asynchronously  by  either  using  <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1)  or  sending <b>pmlogger</b> a SIGHUP signal (see below).  Note, if a
       scheduled volume switch is in operation due to the <b>-v</b> option, then its counters will be  reset  after  an
       asynchronous switch.

       Independent  of  any  <b>-v</b>  option,  each  volume  of  an archive is limited to no more than 2^31 bytes, so
       <u>pmlogger</u> will automatically create a new volume for the archive before this limit is reached.

       Normally <b>pmlogger</b> operates on the distributed Performance Metrics Name Space (PMNS), however  if  the  <b>-n</b>
       option is specified an alternative local PMNS is loaded from the file <u>pmnsfile</u>.

       Under  normal  circumstances, <b>pmlogger</b> will run forever (except for a <b>-s</b> option or a termination signal).
       The <b>-T</b> option may be used to limit the  execution  time  using  the  format  of  time  as  prescribed  by
       <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1).   The  time  is interpreted within the time zone of the PMCD server, unless the <b>-y</b> option is
       given, within which case the time zone at this logger host is used.
       Some examples of different formats:
          <b>-T</b> <b>10mins</b>
          <b>-T</b> <b>'@</b> <b>11:30'</b>
       From this it can be seen that <b>-T</b> <b>10mins</b> and <b>-s</b> <b>10mins</b> perform identical actions.

       Alternatively, <b>pmlogger</b> runtime may be limited to the lifetime of another process  by  using  the  <b>-p</b>  or
       <b>--PID</b>  option  to  nominate the PID of the process of interest.  In this case the <b>pmlogger</b> will exit when
       the other process no longer exists.

       When <b>pmlogger</b> receives a <b>SIGHUP</b> signal, the current volume of the archive is closed, and a new volume  is
       opened.   This  mechanism  (or the alternative mechanism via <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1)) may be used to manage the growth of
       the archive files - once a log volume is closed, that file may be  archived  without  ill-effect  on  the
       continued operation of <b>pmlogger</b>.  See also the <b>-v</b> option above.

       When <b>pmlogger</b> receives a <b>SIGUSR2</b> signal, the current archive is closed, and a new archive is opened.  For
       this  to  succeed,  the  original  <u>archive</u>  argument  must  include  <b><a href="../man3/strftime.3.html">strftime</a></b>(3)  meta  characters  (e.g.
       <b>%Y%m%d.%H.%M</b>), otherwise <b>pmlogger</b> will exit because the archive files will  already  exist  and  <b>pmlogger</b>
       will  not  over-write  existing archive files.  Note that <b>SIGUSR2</b> triggers <b>pmlogger</b> to re-exec itself and
       re-parse all original arguments.  This means that any relative time limits  placed  on  it's  termination
       time  or  sampling  limit  are  reset and begin again.  This only affects relative termination times, not
       absolute times e.g.  <b>-T</b> <b>5s</b> is affected, but <b>-T</b> <b>5pm</b> is not.

       Historically the buffers for the current archive may be flushed  to  disk  using  the  <b>flush</b>  command  of
       <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1),  or  by  using  the  <b>-u</b>  option.   The  current version of <u>pmlogger</u> and the <u>libpcp</u> routines that
       underpin <u>pmlogger</u> unconditionally use unbuffered writes and a single <b><a href="../man3/fwrite.3.html">fwrite</a></b>(3) for  each  logical  record
       written, and so ``flushing'' does not force any additional data to be written to the file system.  The <b>-u</b>
       option and the <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1) <b>flush</b> command are retained for backwards compatibility.

       When  launched  with  the  <b>-x</b>  option,  pmlogger  will  accept  asynchronous control requests on the file
       descriptor <u>fd</u>.  This option is only expected to be used  internally  by  PCP  applications  that  support
       ``live record mode''.

       The  <b>-m</b> option allows the string <u>note</u> to be appended to the map file for this instance of <b>pmlogger</b> in the
       <b>$PCP_TMP_DIR/pmlogger</b> directory.  This is currently used internally to document the file descriptor  (<u>fd</u>)
       when  the  <b>-x</b> option is used, or to indicate that this <b>pmlogger</b> instance was started under the control of
       <b><a href="../man1/pmlogger_check.1.html">pmlogger_check</a></b>(1), (<b>-m</b> <b>pmlogger_check</b>) or was re-exec'd (see <b><a href="../man3/execvp.3.html">execvp</a></b>(3)) due to  a  <b>SIGUSR2</b>  signal  being
       received as described above (<b>-m</b> <b>reexec</b>).

       The  <b>-H</b>  option allows the hostname written into the archive label to be overridden.  This mirrors the <b>-H</b>
       option of <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) , but allows it to be specified on the <b>pmlogger</b>  process.   Without  this  option,  the
       value returned from the logged <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) is used.

       The <b>-C</b> option will cause the configuration file to be parsed and <u>pmlogger</u> will then exit without creating
       an  output  archive,  so  when  <b>-C</b>  is specified, the <u>archive</u> command line argument is not required.  Any
       errors in the configuration file are reported.

       The <b>-d</b> or <b>--directory</b> option may be used to specify the directory where the <u>archive</u>  should  be  created.
       <u>directory</u>  may include <b><a href="../man1/sh.1.html">sh</a></b>(1) metacharacters, like <b>$(</b><u>...</u><b>)</b>  or <b>`</b>...<b>`</b> or <b>$</b><u>var</u> and <b>pmlogger</b> will expand these
       to produce a final directory path.  The resultant path must be absolute, not relative.  The <b>-d</b> option  is
       intended  primarily  for  use  by  <b><a href="../man1/pmlogger_check.1.html">pmlogger_check</a></b>(1) and normal users would not typically need to use the
       option, as the directory for <u>archive</u> is either implied by <u>archive</u> if  it  contains  directory  components
       else the current directory by default.

</pre><h4><b>CONFIGURATION</b> <b>FILE</b> <b>SYNTAX</b></h4><pre>
       The  configuration  file may be specified with the <b>-c</b> option.  If it is not, configuration specifications
       are read from standard input.

       If <u>conffile</u> does not exist, then a search is made in the  directory  <b>$PCP_VAR_DIR/config/pmlogger</b>  for  a
       file  of  the  same  name,  and  if  found that file is used, e.g. if <b>config.mumble</b> does not exist in the
       current  directory  and  the  file  <b>$PCP_VAR_DIR/config/pmlogger/config.mumble</b>  does   exist,   then   <b>-c</b>
       <b>config.mumble</b> and <b>-c</b> <b>$PCP_VAR_DIR/config/pmlogger/config.mumble</b> are equivalent.

       The syntax for the configuration file is as follows.

       1.   Words are separated by white space (space, tab or newline).

       2.   The symbol ``#'' (hash) introduces a comment, and all text up to the next newline is ignored.

       3.   Keywords (shown in <b>bold</b> below) must appear literally (i.e. in lower case).

       4.   Each specification begins with the optional keyword <b>log</b>, followed by one of the states <b>mandatory</b> <b>on</b>,
            <b>mandatory</b> <b>off</b>, <b>mandatory</b> <b>maybe</b>, <b>advisory</b> <b>on</b> or <b>advisory</b> <b>off</b>.

       5.   For  the  <b>on</b>  states,  a  logging interval must follow using the syntax ``<b>once</b>'', or ``<b>default</b>'', or
            ``<b>every</b> <u>N</u> <u>timeunits</u>'', or simply ``<u>N</u> <u>timeunits</u>'' - <u>N</u> is an unsigned integer, and <u>timeunits</u> is one of
            the keywords <b>msec</b>, <b>millisecond</b>, <b>sec</b>, <b>second</b>, <b>min</b>, <b>minute</b>, <b>hour</b> or the plural  form  of  one  of  the
            above.
            Internal  limitations require the interval to be smaller than (approximately) 74 hours.  An interval
            value of zero is a synonym for <b>once</b>.  An interval of  <b>default</b>  means  to  use  the  default  logging
            interval  of  60  seconds;  this  default  value may be changed to <u>interval</u> with the <b>-t</b> command line
            option.

            The <u>interval</u> argument follows the syntax described in <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1), and in the simplest form  may  be
            an unsigned integer (the implied units in this case are seconds).

       6.   Following the state and possible interval specifications comes a ``{'', followed by a list of one or
            more  metric  specifications and a closing ``}''.  The list is white space (or comma) separated.  If
            there is only one metric specification in the list, the braces are optional.

       7.   A metric specification consists of a metric name optionally followed by a  set  of  instance  names.
            The  metric name follows the standard PCP naming conventions, see <b><a href="../man5/PMNS.5.html">PMNS</a></b>(5), and if the metric name is
            a non-leaf node in the PMNS (see <b><a href="../man5/PMNS.5.html">PMNS</a></b>(5)), then <b>pmlogger</b> will recursively descend the PMNS and apply
            the logging specification to all descendent metric names that are leaf nodes in the PMNS.   The  set
            of  instance  names  is a ``['', followed by a list of one or more space (or comma) separated names,
            numbers or strings, and a closing ``]''.  Elements in the list that are numbers are  assumed  to  be
            internal  instance identifiers, other elements are assumed to be external instance identifiers - see
            <b><a href="../man3/pmGetInDom.3.html">pmGetInDom</a></b>(3) for more information.

            If no instances are given, then the logging  specification  is  applied  to  all  instances  of  the
            associated metric.

       8.   There may be an arbitrary number of logging specifications.

       9.   As  of PCP version 4.0 and later, any metric name specification that does not resolve to a leaf node
            in the PMNS is added to an internal list of possible <u>dynamic</u> <u>subtree</u> <u>roots</u>.  PMDAs  can  dynamically
            create  new metrics below a dynamic root node in their PMNS, and send a notification to clients that
            the PMNS has changed, see <b><a href="../man3/pmdaExtSetFlags.3.html">pmdaExtSetFlags</a></b>(3) and in particular the <b>METRIC</b> <b>CHANGES</b>  section  for  API
            details.   This mechanism is currently supported by <b><a href="../man1/pmdaopenmetrics.1.html">pmdaopenmetrics</a></b>(1) and <b><a href="../man1/pmdammv.1.html">pmdammv</a></b>(1)<b>.</b>  When a fetch
            issued by <b>pmlogger</b> returns with the <b>PMDA_EXT_NAMES_CHANGE</b>  flag  set,  <b>pmlogger</b>  will  traverse  the
            internal  list  of  possible  dynamic  subtree  nodes  and dynamically discover any new metrics.  In
            effect, as of PCP version 4.0 and later, <b>pmlogger</b> can be configured to dynamically log  new  metrics
            that appear in the future, after the configuration file is initially parsed.

       10.  Following  all  of  the  logging  specifications,  there  may be an optional access control section,
            introduced by the literal token <b>[access]</b>.  Thereafter  come  access  control  rules  that  allow  or
            disallow operations from particular hosts or groups of hosts.

            The  operations may be used to interrogate or control a running <b>pmlogger</b> using <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1) and fall into
            the following classes:

            <b>enquire</b>        interrogate the status of <b>pmlogger</b> and the metrics it is logging
            <b>advisory</b>       Change advisory logging.
            <b>mandatory</b>      Change mandatory logging.
            <b>all</b>            All of the above.

            Access control rules are of the form ``<b>allow</b> <u>hostlist</u> <b>:</b> <u>operationslist</u> <b>;</b>'' and ``<b>disallow</b> <u>hostlist</u> <b>:</b>
            <u>operationslist</u> <b>;</b>''.

            The <u>hostlist</u> follows the syntax and semantics for the access control mechanisms used by PMCD and are
            fully documented in <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1).  An  <u>operationslist</u>  is  a  comma  separated  list  of  the  operations
            <b>advisory</b>, <b>mandatory</b>, <b>enquire</b> and <b>all</b>.

            A missing <b>[access]</b> section allows all access and is equivalent to <b>allow</b> <b>*</b> <b>:</b> <b>all;</b>.

       The  configuration  (either  from  standard  input or <u>conffile</u>) is initially scanned by <b><a href="../man1/pmcpp.1.html">pmcpp</a></b>(1) with the
       options <b>-rs</b> and <b>-I</b> <b>$PCP_VAR_DIR/config/pmlogger</b>.  This extends the configuration file syntax with include
       file processing (<b>%include</b>), a common location to search for include files (<b>$PCP_VAR_DIR/config/pmlogger</b>),
       macro definitions (<b>%define</b>), macro expansion (<b>%</b><u>name</u> and  <b>%{</b><u>name</u><b>}</b>)  and  conditional  inclusion  of  lines
       (<b>%ifdef</b> <u>name</u> ... <b>%else</b> ... <b>%endif</b> and <b>%ifndef</b> <u>name</u> ... <b>%else</b> ... <b>%endif</b>).

</pre><h4><b>OPTIONS</b></h4><pre>
       The available command line options are:

       <b>-c</b> <u>conffile</u>, <b>--config</b>=<u>conffile</u>
            Specify the <u>conffile</u> file to use.

       <b>-C</b>, <b>--check</b>
            Parse configuration and exit.

       <b>-h</b> <u>host</u>, <b>--host</b>=<u>host</u>
            Fetch performance metrics from <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) on <u>host</u>, rather than from the default localhost.

       <b>-H</b> <u>hostname</u>, <b>--labelhost</b>=<u>hostname</u>
            Specify the <u>hostname</u> to use instead of the one returned by <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1).

       <b>-I</b> <u>version</u>, <b>--pmlc-ipc-version</b>=<u>version</u>
            Normally,  <b>pmlogger</b>  and  <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1) will autonegotiate a mutually acceptable version for their private
            IPC channel.  Use <b>-I</b> to force <b>pmlogger</b> to offer (at most) <u>version</u> as the version to be  used.   This
            option  may be required if <b>pmlogger</b> needs to be managed by an older version of <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1) that fails to
            autonegotiate correctly.

       <b>-K</b> <u>spec</u>, <b>--spec-local</b>=<u>spec</u>
            When fetching metrics from a local context (see <b>-o</b>), the <b>-K</b> option may be used to  control  the  DSO
            PMDAs  that  should  be  made  accessible.   The  <u>spec</u>  argument conforms to the syntax described in
            <b><a href="../man3/pmSpecLocalPMDA.3.html">pmSpecLocalPMDA</a></b>(3).  More than one <b>-K</b> option may be used.

       <b>-l</b> <u>logfile</u>, <b>--log</b>=<u>logfile</u>
            Write all diagnostics to <b>logfile</b> instead of the default <b>pmlogger.log</b>.

       <b>-L</b>, <b>--linger</b>
            Run even if not the primary logger instance and nothing to log.

       <b>-m</b> <u>note</u>, <b>--note</b>=<u>note</u>
            Append <u>note</u> to the port map file for this instance.

       <b>-n</b> <u>pmnsfile</u>, <b>--namespace</b>=<u>pmnsfile</u>
            Load an alternative Performance Metrics Name Space (<b><a href="../man5/PMNS.5.html">PMNS</a></b>(5)) from the file <u>pmnsfile</u>.

       <b>-N</b>, <b>--notify</b>
            Notify service manager such as <b><a href="../man1/systemd.1.html">systemd</a>(1)</b> as needed.

       <b>-o</b>, <b>--local-PMDA</b>
            Use a local context to collect metrics from DSO PMDAs on the local host without PMCD.  See also <b>-K</b>.

       <b>-p</b> <u>PID</u>, <b>--PID</b>=<u>PID</u>
            Log specified metrics for the lifetime of the pid <u>PID</u>.

       <b>-P</b>, <b>--primary</b>
            Run as primary logger instance.  See above for more detailed description of this.

       <b>-r</b>, <b>--report</b>
            Report record sizes and archive growth rate.

       <b>-s</b> <u>endsize</u>, <b>--size</b>=<u>endsize</u>
            Terminate after archive size exceeds <u>endsize</u>.

       <b>-t</b> <u>interval</u>, <b>--interval</b>=<u>interval</u>
            Specify the logging <u>interval</u>.  The default value is 60 seconds.  Please refer to the <b>ENVIRONMENT</b> and
            <b>FILES</b> sections below regarding the <b>PMLOGGER_INTERVAL</b> environment variable  and  its  impact  on  the
            default logging interval.

       <b>-T</b> <u>endtime</u>, <b>--finish</b>=<u>endtime</u>
            Specify the <u>endtime</u> when to end logging.

       <b>-u</b>   Use unbuffered output.  This is the default (so this option does nothing).

       <b>-U</b> <u>username</u>, <b>--username</b>=<u>username</u>
            When in daemon mode, run as user <u>username</u>.

       <b>-v</b> <u>volsize</u>, <b>--volsize</b>=<u>volsize</u>
            Switch volumes after reaching archive volume size <u>volsize</u>.

       <b>-V</b> <u>version</u>, <b>--version</b>=<u>version</u>
            Specify archive <u>version</u>.  The default and the only accepted value is 2.

       <b>-x</b> <u>fd</u>
            Allow asynchronous control requests on the file descriptor <u>fd</u>.

       <b>-y</b>   Use local timezone instead of the timezone from the <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) host.

       <b>-?</b>, <b>--help</b>
            Display usage message and exit.

</pre><h4><b>EXAMPLES</b></h4><pre>
       For  each  PCP  utility,  there  is  a sample <b>pmlogger</b> configuration file that could be used to create an
       archive suitable for replaying with that tool (i.e. includes all of the performance metrics used  by  the
       tool).      For     a     tool     named     <u>foo</u>     this    configuration    file    is    located    in
       <b>$PCP_VAR_DIR/config/pmlogger/config.foo</b>.

       The following is a simple default configuration file for a primary <b>pmlogger</b>  instance,  and  demonstrates
       most of the capabilities of the configuration specification language.

            log mandatory on once { hinv.ncpu hinv.ndisk }
            log mandatory on every 10 minutes {
                disk.all.write
                disk.all.read
                network.interface.in.packets [ "et0" ]
                network.interface.out.packets [ "et0" ]
                nfs.server.reqs [ "lookup" "getattr" "read" "write" ]
            }

            log advisory on every 30 minutes {
                environ.temp
                pmcd.pdu_in.total
                pmcd.pdu_out.total
            }

            %include "macros.default"

            %ifdef %disk_detail
            log mandatory on %disk_detail_freq {
                disk.dev
            }
            %endif

            [access]
            disallow * : all except enquire;
            allow localhost : mandatory, advisory;

</pre><h4><b>HOSTNAME</b> <b>CHANGES</b></h4><pre>
       The hostname of the PMCD that is providing metrics to <b>pmlogger</b> is used in several ways.

       PMCD's  hostname (or the argument from the <b>-H</b> option) is included in the archive label and may be used to
       ensure that subsequent operations on  multiple  archives,  e.g.  <b><a href="../man1/pmlogextract.1.html">pmlogextract</a></b>(1),  are  only  applied  to
       archives from the same host.

       For  <b>pmlogger</b>  instances  using  a  local  PMCD  that  are  launched and managed by <b><a href="../man1/pmlogger_check.1.html">pmlogger_check</a></b>(1) and
       <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1), (or the <b><a href="../man1/systemd.1.html">systemd</a></b>(1) or <b><a href="../man8/cron.8.html">cron</a></b>(8) services that use these scripts), the local hostname may
       also be used to construct the name of a directory where all the archives for the  one  host  are  stored,
       e.g. <b>$PCP_ARCHIVE_DIR/</b><u>&lt;hostname&gt;</u>.

       And  PMCD's  hostname is also stored in the archive via the <b>pmcd.pmlogger.hostname</b> metric that is used as
       part of the checks to ensure that there is continuity of  performance  data  after  the  nightly  archive
       rotation by <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1).

       The  hostname  of  the PMCD host may change during boot time when the system transitions from a temporary
       hostname to a persistent hostname, or by explicit administrative action anytime after the system has been
       booted.  When this happens, <b>pmlogger</b> may need to  take  special  action,  specifically  if  the  <b>pmlogger</b>
       instance was launched from <b><a href="../man1/pmlogger_check.1.html">pmlogger_check</a></b>(1) or <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1), then <b>pmlogger</b> must exit.  Under normal
       circumstances  <b><a href="../man1/systemd.1.html">systemd</a></b>(1) or <b><a href="../man8/cron.8.html">cron</a></b>(8) will launch a new <b>pmlogger</b> shortly thereafter, and this new <b>pmlogger</b>
       instance will be operating in the context of the new hostname for the host where PMCD is running.

</pre><h4><b>DERIVED</b> <b>METRICS</b></h4><pre>
       As described in <b><a href="../man3/pmRegisterDerived.3.html">pmRegisterDerived</a></b>(3), derived metrics provide a mechanism for extending the PMNS with new
       metrics defined at the PCP client-side using expressions over the existing performance metrics.   Derived
       metrics may be included in a <b>pmlogger</b> configuration file, but they come with some special handling rules.

       First,  the  values  of a derived metric, <b>not</b> the operand metrics in the derived metric's expression, are
       stored in the archive.  This is because the definition of a derived metric exists independent of <b>pmlogger</b>
       and <u>archive</u> and may be different, or not exist at all, when <u>archive</u> is replayed.

       To avoid ambiguity during archive replay each derived metric's Performance Metric  Identifier  (PMID)  is
       rewritten  (or  ``remapped'')  to  indicate  that  this  was,  but now is <u>not</u>, a derived metric; refer to
       <b><a href="../man3/pmRegisterDerived.3.html">pmRegisterDerived</a></b>(3) for a detailed description of the PMID remapping.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       The archives are sufficiently precious that <b>pmlogger</b> will not truncate  an  existing  physical  file.   A
       message of the form
        ...: "foo.index" already exists, not over-written
        ...: File exists
       indicates this situation has arisen.  You must explicitly remove the files and launch <b>pmlogger</b> again.

       There  may  be  at  most  one  primary <b>pmlogger</b> instance per monitored host; attempting to bend this rule
       produces the error:
        pmlogger: there is already a primary pmlogger running

       Various other messages relating to the creation and/or deletion of files in <b>$PCP_TMP_DIR/pmlogger</b> suggest
       a permission problem on this directory, or some feral files have appeared therein.

</pre><h4><b>FILES</b></h4><pre>
       <u>archive</u><b>.meta</b>
            metadata (metric descriptions, instance domains, etc.) for the archive

       <u>archive</u><b>.0</b>
            initial volume of metrics values (subsequent volumes have suffixes <b>1</b>, <b>2</b>, ...)

       <u>archive</u><b>.index</b>
            temporal index to support rapid random access to the other files in the archive

       <b>$PCP_TMP_DIR/pmlogger</b>
            <b>pmlogger</b> maintains the files in this directory as the map between the process  id  of  the  <b>pmlogger</b>
            instance and the IPC port that may be used to control each <b>pmlogger</b> instance (as used by <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1))

       <b>$PCP_VAR_DIR/config/pmlogger/config.default</b>
            default configuration file for the primary logger instance launched from <b>$PCP_RC_DIR/pmlogger</b>

       <b>$PCP_VAR_DIR/config/pmlogger/config.*</b>
            assorted  configuration  files suitable for creating logs that may be subsequently replayed with the
            PCP visualization and monitoring tools

       <b>$PCP_ARCHIVE_DIR/</b><u>&lt;hostname&gt;</u>
            Default directory for PCP archive files for  performance  metric  values  collected  from  the  host
            <u>&lt;hostname&gt;</u>.

       <b>$PCP_SYSCONFIG_DIR/pmlogger</b>
            additional environment variables that will be set when the primary <b>pmlogger</b> instance executes.  Only
            settings of the form "PMLOGGER_VARIABLE=value" will be honoured.

       <b>./pmlogger.log</b>
            (or     <b>$PCP_ARCHIVE_DIR/</b><u>&lt;hostname&gt;</u><b>/pmlogger.log</b>    when    started    automatically    by    either
            <b>$PCP_RC_DIR/pmlogger</b> or one of the <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) monitoring scripts such as <b><a href="../man1/pmlogger_check.1.html">pmlogger_check</a></b>(1))
            all messages and diagnostics are directed here

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       Normally <b>pmlogger</b> creates a socket to receive control messages from <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1) on the first available TCP/IP
       port numbered 4330 or higher.   The  environment  variable  <b>PMLOGGER_PORT</b>  may  be  used  to  specify  an
       alternative starting port number.

       If set to the value 1, the <b>PMLOGGER_LOCAL</b> environment variable will cause <b>pmlogger</b> to run in a localhost-
       only mode of operation, where it binds only to the loopback interface.

       The  <b>PMLOGGER_REQUEST_TIMEOUT</b> variable may be set by applications such as <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1) to specify a timeout in
       seconds for connection requests to the  <b>pmlogger</b>  control  port.   If  not  set,  connections  may  block
       indefinitely.  This variable would not normally be set by <b>pmlogger</b> itself.

       The  <b>PMLOGGER_MAXPENDING</b> variable can be set to indicate the maximum length to which the queue of pending
       <b>pmlc</b> connections may grow.

       The default sampling interval used by <b>pmlogger</b> can be set using the <b>PMLOGGER_INTERVAL</b>  variable  (if  not
       set,  60  seconds  will  be  used).   Both the command line and directives in the configuration file will
       override this value.  It is an integer in units of seconds.

       On platforms using <b><a href="../man1/systemd.1.html">systemd</a></b>(1), and when the <b>-N</b> option is given, the  <b>NOTIFY_SOCKET</b>  environment  variable
       would normally be set by the service manager prior to launching <b>pmlogger</b>.

       Two  additional  environment variables are used as part of the hand-off from one <b>pmlogger</b> instance to the
       next during a re-exec operation, namely <b>__PMLOGGER_REEXEC</b> and <b>__PMLOGGER_TZ</b>.  The details  of  how  these
       are  used is an internal implementation detail, but end-users should avoid using variables of these names
       in their shell's environment.

</pre><h4><b>PCP</b> <b>ENVIRONMENT</b></h4><pre>
       Environment variables with the prefix <b>PCP_</b> are used to parameterize the file and directory names used  by
       PCP.   On  each  installation, the file <u>/etc/pcp.conf</u> contains the local values for these variables.  The
       <b>$PCP_CONF</b> variable may be used to specify an alternative configuration file, as described in <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1),  <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1),  <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1),  <b><a href="../man1/pmlogdump.1.html">pmlogdump</a></b>(1),   <b><a href="../man1/pmlogger_check.1.html">pmlogger_check</a></b>(1),   <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1),   <b><a href="../man1/systemctl.1.html">systemctl</a></b>(1),
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1),    <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3),    <b><a href="../man3/__pmServerNotifyServiceManagerReady.3.html">__pmServerNotifyServiceManagerReady</a></b>(3),    <b><a href="../man3/execvp.3.html">execvp</a></b>(3),   <b><a href="../man3/pmRegisterDerived.3.html">pmRegisterDerived</a></b>(3),
       <b><a href="../man3/pmSpecLocalPMDA.3.html">pmSpecLocalPMDA</a></b>(3),  <b><a href="../man3/strftime.3.html">strftime</a></b>(3),  <b><a href="../man5/PMNS.5.html">PMNS</a></b>(5),  <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5),  <b><a href="../man5/pcp.env.5.html">pcp.env</a></b>(5),  <b><a href="../man5/LOGARCHIVE.5.html">LOGARCHIVE</a></b>(5),  <b><a href="../man8/chkconfig.8.html">chkconfig</a></b>(8)  and
       <b><a href="../man8/cron.8.html">cron</a></b>(8).

Performance Co-Pilot                                   PCP                                           <u><a href="../man1/PMLOGGER.1.html">PMLOGGER</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>