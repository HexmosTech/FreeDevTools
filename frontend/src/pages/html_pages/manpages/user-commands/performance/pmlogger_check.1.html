<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmlogger_check - administration of Performance Co-Pilot archive files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/pcp">pcp_6.3.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmlogger_check</b> - administration of Performance Co-Pilot archive files

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>$PCP_BINADM_DIR/pmlogger_check</b> [<b>-CNPpqsTV?</b>]  [<b>-c</b> <u>control</u>] [<b>-l</b> <u>logfile</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>pmlogger_check</b>  and  the  related  <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1)  tools  along  with  associated  control  files (see
       <b><a href="../man5/pmlogger.control.5.html">pmlogger.control</a></b>(5)) may be used to create a customized  regime  of  administration  and  management  for
       historical archives of performance data within the Performance Co-Pilot (see <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1)) infrastructure.

       <b>pmlogger_check</b>  may  be  run  at  any  time  of  the  day  and is intended to check that a desired set of
       <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) processes are running.  If not, it (re-)starts any missing  logger  processes.   By  default,
       <b>pmlogger_check</b>  also calls <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1) with a <b>-K</b> option to execute any required archive compression
       tasks.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-C</b>   This option causes <b>pmlogger_check</b> to query the system service runlevel information for <b>pmlogger</b>, and
            use that to determine whether to start processes or not.

       <b>-c</b> <u>control</u>, <b>--control</b>=<u>control</u>
            Both <b>pmlogger_check</b> and  <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1)  are  controlled  by  PCP  logger  control  file(s)  that
            specifies    the    <b>pmlogger</b>   instances   to   be   managed.    The   default   <u>control</u>   file   is
            <u>$PCP_PMLOGGERCONTROL_PATH</u> but an alternate may be specified using the <b>-c</b> option.  If  the  directory
            <u>$PCP_PMLOGGERCONTROL_PATH</u>.d  (or  <u>control</u>.d  from  the  <b>-c</b>  option) exists, then the contents of any
            additional <u>control</u> files therein will be appended to the main control file (which must exist).

       <b>-l</b> <u>file</u>, <b>--logfile</b>=<u>file</u>
            In order to ensure that mail is not unintentionally sent when these scripts are run from <b><a href="../man8/cron.8.html">cron</a></b>(8)  or
            <b><a href="../man1/systemd.1.html">systemd</a></b>(1)   diagnostics   are   always   sent   to   log   files.    By   default,   this  file  is
            <u>$PCP_LOG_DIR/pmlogger/pmlogger_check.log</u> but this can be changed using the <b>-l</b> option.  If  this  log
            <u>file</u>  already exists when the script starts, it will be renamed with a <u>.prev</u> suffix (overwriting any
            log file saved earlier) before diagnostics are generated to the log file.  The  <b>-l</b>  and  <b>-t</b>  options
            cannot be used together.

       <b>-N</b>, <b>--showme</b>
            This option enables a ``show me'' mode, where the actions are echoed, but not executed, in the style
            of  ``make  -n''.   Using  <b>-N</b>  in  conjunction  with  <b>-V</b>  maximizes  the diagnostic capabilities for
            debugging.

       <b>-P</b>, <b>--only-primary</b>
            If this option is specified for <b>pmlogger_check</b> then only the primary logger  entry  in  the  control
            files  will  be  processed.   This  is  the logical opposite of the <b>-p</b> option described above and is
            intended for use by RC scripts that start only the primary  logger,  such  as  the  <b>pmlogger.service</b>
            unit.  The <b>-p</b> and <b>-P</b> options are mutually exclusive.

       <b>-p</b>, <b>--skip-primary</b>
            If  this option is specified for <b>pmlogger_check</b> then any line from the control files for the <u>primary</u>
            <b>pmlogger</b> will be ignored.  This option is intended for environments where some system  daemon,  like
            <b><a href="../man1/systemd.1.html">systemd</a></b>(1),  is  responsible  for  controlling  (starting,  stopping,  restarting, etc.) the <u>primary</u>
            <b>pmlogger</b>.

       <b>-q</b>, <b>--quick</b>
            If this option is specified for <b>pmlogger_check</b> then the  script  will  ``quickstart''  avoiding  any
            optional processing like calling <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1) to perform archive compression tasks.

       <b>-s</b>, <b>--stop</b>
            Use  of  this option provides the reverse <b>pmlogger_check</b> functionality, allowing the set of <b>pmlogger</b>
            processes to be cleanly shutdown.

       <b>-T</b>, <b>--terse</b>
            This option to <b>pmlogger_check</b> produces less verbose output than the default.  This is most  suitable
            for a <b>pmlogger</b> ``farm'' where many instances of <b>pmlogger</b> are expected to be running.

       <b>-V</b>, <b>--verbose</b>
            The  <b>-V</b>  option  enables verbose tracing.  By default <b>pmlogger_check</b> generates no output unless some
            error or warning condition is encountered.  A second  <b>-V</b>  increases  the  verbosity.   Using  <b>-N</b>  in
            conjunction with <b>-V</b> maximizes the diagnostic capabilities for debugging.

       <b>-?</b>, <b>--help</b>
            Display usage message and exit.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       Refer  to  <b><a href="../man5/pmlogger.control.5.html">pmlogger.control</a></b>(5)  for  a  description of the control file(s) that are used to control which
       <b>pmlogger</b> instances and which archives are managed by <b>pmlogger_check</b> and <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1).

       The <b><a href="../man1/pmlogctl.1.html">pmlogctl</a></b>(1) utility may invoke <b>pmlogger_check</b> using the <b><a href="../man1/sudo.1.html">sudo</a></b>(1) command to run it under the $PCP_USER
       ``pcp''  account.   If  <b>sudo</b>  is  configured  with  the  non-default  <u>requiretty</u>  option   (see   below),
       <b>pmlogger_check</b>  may fail to run due to not having a tty configured.  This issue can be resolved by adding
       a second line (expand $PCP_BINADM_DIR according to your platform) to the <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> configuration  file
       as follows:

            Defaults requiretty
            Defaults!$PCP_BINADM_DIR/pmlogger_check !requiretty

       Note that the unprivileged PCP account under which these commands run uses <u><a href="file:/sbin/nologin">/sbin/nologin</a></u> as the shell, so
       the <u>requiretty</u> option is ineffective here and safe to disable in this way.

</pre><h4><b>FILES</b></h4><pre>
       <u>$PCP_VAR_DIR/config/pmlogger/config.default</u>
            default  <b>pmlogger</b>  configuration  file  location  for  the local primary logger, typically generated
            automatically by <b><a href="../man1/pmlogconf.1.html">pmlogconf</a></b>(1).

       <u>$PCP_ARCHIVE_DIR/&lt;hostname&gt;</u>
            default location for archives of performance information collected from the host <u>hostname</u>

       <u>$PCP_ARCHIVE_DIR/&lt;hostname&gt;/lock</u>
            transient lock file to guarantee mutual  exclusion  during  <b>pmlogger</b>  administration  for  the  host
            <u>hostname</u>  -  if  present,  can be safely removed if neither <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1) nor <b>pmlogger_check</b> are
            running

       <u>$PCP_ARCHIVE_DIR/&lt;hostname&gt;/Latest</u>
            PCP archive folio created by <b><a href="../man1/mkaf.1.html">mkaf</a></b>(1) for the most recently launched archive  containing  performance
            metrics from the host <u>hostname</u>

       <u>$PCP_LOG_DIR/NOTICES</u>
            PCP ``notices'' file used by <b><a href="../man1/pmie.1.html">pmie</a></b>(1) and friends

       <u>$PCP_LOG_DIR/pmlogger/pmlogger_check.log</u>
            if  the  previous execution of <b>pmlogger_check</b> produced any output it is saved here.  The normal case
            is no output in which case the file does not exist.

       <u>$PCP_ARCHIVE_DIR/SaveLogs</u>
            if this directory exists, then the log file from the <b>-l</b> argument for <b>pmlogger_check</b> will be saved in
            this directory with the name of the format &lt;date&gt;-<b>pmlogger_check</b>.<b>log</b>.&lt;pid&gt; This allows the log  file
            to be inspected at a later time, even if several <b>pmlogger_check</b> executions have been launched in the
            interim.   Because  the  PCP  archive  management  tools  run  under  the $PCP_USER account ``pcp'',
            <u>$PCP_ARCHIVE_DIR/SaveLogs</u> typically needs to be owned by the user ``pcp''.

       <u>$PCP_ARCHIVE_DIR/&lt;hostname&gt;/SaveLogs</u>
             if this directory exists, then the log file from the <b>-l</b> argument of a  newly  launched  <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1)
             for  <u>hostname</u>  will  be  saved  in  this  directory  with the name <u>archive</u><b>.log</b> where <u>archive</u> is the
             basename of the associated <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) PCP archive files.  This allows the log file to be inspected
             at a later time, even if several <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) instances for  <u>hostname</u>  have  been  launched  in  the
             interim.   Because  the  PCP  archive  management  tools  run  under the $PCP_USER account ``pcp'',
             <u>$PCP_ARCHIVE_DIR/&lt;hostname&gt;/SaveLogs</u> typically needs to be owned by the user ``pcp''.

</pre><h4><b>PCP</b> <b>ENVIRONMENT</b></h4><pre>
       Environment variables with the prefix <b>PCP_</b> are used to parameterize the file and directory names used  by
       PCP.   On  each  installation, the file <u>/etc/pcp.conf</u> contains the local values for these variables.  The
       <b>$PCP_CONF</b> variable may be used to specify an alternative configuration file, as described in <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5).

       The default behaviour, when <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) configuration comes  from  <b><a href="../man1/pmlogconf.1.html">pmlogconf</a></b>(1),  is  to  regenerate  the
       configuration  file  and  check  for changes whenever <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) is started from <b>pmlogger_check.</b>  If the
       PMDA configuration is stable, this is not necessary,  and  setting  <b>$PMLOGGER_CHECK_SKIP_LOGCONF</b>  to  <b>yes</b>
       disables the regeneration and checking.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/mkaf.1.html">mkaf</a></b>(1),  <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1),  <b><a href="../man1/pmie.1.html">pmie</a></b>(1),  <b><a href="../man1/pmlc.1.html">pmlc</a></b>(1),  <b><a href="../man1/pmlogconf.1.html">pmlogconf</a></b>(1),  <b><a href="../man1/pmlogctl.1.html">pmlogctl</a></b>(1),  <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1),  <b><a href="../man1/pmlogger_daily.1.html">pmlogger_daily</a></b>(1),
       <b><a href="../man1/pmlogger_daily_report.1.html">pmlogger_daily_report</a></b>(1), <b><a href="../man1/sudo.1.html">sudo</a></b>(1), <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man5/pmlogger.control.5.html">pmlogger.control</a></b>(5) and <b><a href="../man8/cron.8.html">cron</a></b>(8).

Performance Co-Pilot                                   PCP                                     <u><a href="../man1/PMLOGGER_CHECK.1.html">PMLOGGER_CHECK</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>