<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmdaperfevent - hardware performance counter performance metrics domain agent (PMDA)</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/pcp">pcp_6.3.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmdaperfevent</b> - hardware performance counter performance metrics domain agent (PMDA)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>$PCP_PMDAS_DIR/perfevent/pmdaperfevent</b>  [<b>-d</b> <u>domain</u>] [<b>-l</b> <u>logfile</u>] [<b>-U</b> <u>username</u>] [<b>-i</b> <u>port</u>] [<b>-p</b>] [<b>-u</b> <u>socket</u>]
       [<b>-6</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>pmdaperfevent</b> is a Performance Metrics Domain  Agent  (PMDA)  that  configures  and  reads  the  hardware
       performance counters using the Linux kernel perf_event API.

       The <b>perfevent</b> PMDA exports metrics for hardware performance counters that are configurable from the Linux
       kernel  perf_event API.  The PMDA uses the libpfm4 library to access the hardware performance counters so
       any counters that are supported in libpfm4 should be available.  Also included is the ability to read the
       Intel RAPL counters via direct MSR access.  The PMDA supports automatically  loading  different  counters
       for  each hardware architecture.  A single configuration file is used to specify the desired counters for
       each hardware performance monitoring unit (PMU).  The configuration file allows different counters to  be
       programmed  on  different CPUs and supports round-robin assignment of uncore counters needed for some AMD
       chips.

       The PMDA also counts for events exposed in the kernel via  <a href="file:/sys/bus/event_source/devices">/sys/bus/event_source/devices</a>  directory.  The
       PMU  device  name  and  the event name must be mentioned in the configuration file. Otherwise, the metric
       won't be available to monitor through this PMDA.

       The PMDA configures the counters to count events in both user and  kernel  mode.   This  means  that  the
       hardware counters are unavailable to use by normal unprivileged user applications when they are in use by
       the  PMDA.   The  PMDA  provides  a mechanism to temporarily disable the system-wide counters in order to
       allow normal users to be able to use the counters if they wish.  See <b><a href="../man1/perfalloc.1.html">perfalloc</a></b>(1) for details.

       Note that <b>pmdaperfevent</b> is affected by the value of the <u>kernel.perf_event_paranoid</u> setting, which can  be
       adjusted by <b><a href="../man8/sysctl.8.html">sysctl</a></b>(8).

       A brief description of the <b>pmdaperfevent</b> command line options follows:

       <b>-d</b>   It  is  absolutely  crucial  that the performance metrics <u>domain</u> number specified here is unique and
            consistent.  That is, <u>domain</u> should be different for every PMDA on the one host, and the same <u>domain</u>
            number should be used for the same PMDA on all hosts.

       <b>-l</b>   Location of the log file.  By default, a log file named <u>perfevent.log</u>  is  written  in  the  current
            directory of <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) when <b>pmdaperfevent</b> is started, i.e.  <b>$PCP_LOG_DIR/pmcd</b>.  If the log file cannot
            be created or is not writable, output is written to the standard error instead.

       <b>-U</b>   User account under which to run the agent.  The default is the privileged "root" account.

       <b>-i</b>   listen on given port number for connection from <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1)

       <b>-p</b>   communicate with <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) via stdin/stdout

       <b>-u</b>   expect <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) to connect on given unix domain socket

       <b>-6</b>   expect <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) to connect on given ipv6 port (number or name)

</pre><h4><b>INSTALLATION</b></h4><pre>
       The <b>perfevent</b> PMDA is not activated by default To install the PMDA, do the following as root:

            # cd $PCP_PMDAS_DIR/perfevent
            # ./Install

       If you want to undo the installation, do the following as root:

            # cd $PCP_PMDAS_DIR/perfevent
            # ./Remove

       <b>pmdaperfevent</b>  is  launched  by  <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1)  and  should never be executed directly.  The Install and Remove
       scripts notify <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) when the agent is installed or removed.

</pre><h4><b>FILES</b></h4><pre>
       <b>$PCP_PMCDCONF_PATH</b>
                 command line options used to launch <b>pmdaperfevent</b>
       <b>$PCP_PMDAS_DIR/perfevent/perfevent.conf</b>
                 default configuration file for the PMDA.  See <b><a href="../man5/perfevent.conf.5.html">perfevent.conf</a></b>(5) for detailed information.
       <b>$PCP_PMDAS_DIR/perfevent/help</b>
                 default help text file for the perfevent metrics
       <b>$PCP_PMDAS_DIR/perfevent/Install</b>
                 installation script for the <b>pmdaperfevent</b> agent
       <b>$PCP_PMDAS_DIR/perfevent/Remove</b>
                 undo installation script for the <b>pmdaperfevent</b> agent
       <b>$PCP_LOG_DIR/pmcd/perfevent.log</b>
                 default log file for error messages and other information from <b>pmdaperfevent</b>

</pre><h4><b>UPGRADING</b></h4><pre>
       Some metric names have changed starting  in  version  3.10.8  to  better  conform  to  PMNS  conventions.
       <b><a href="../man1/pmlogrewrite.1.html">pmlogrewrite</a></b>(1)     can     be     used     to     update    old    archives.     A    helper    utility,
       <b>$PCP_PMDAS_DIR/perfevent/perfevent-makerewrite.pl</b> will generate a config file that is  suitable  for  use
       with <b><a href="../man1/pmlogrewrite.1.html">pmlogrewrite</a></b>(1) to update the metric names in existing archives.

</pre><h4><b>BUGS</b></h4><pre>
       Each  event  is  placed in its own group and there is no way to group related events together so they are
       guaranteed to be simultaneously active.  A workaround for this is to ensure that the number of configured
       events is less than or equal to the number of available hardware counters.  This means  that  the  events
       will not be time-multiplexed by the kernel and will be simultaneously active.

</pre><h4><b>PCP</b> <b>ENVIRONMENT</b></h4><pre>
       Environment  variables with the prefix <b>PCP_</b> are used to parameterize the file and directory names used by
       PCP.  On each installation, the file <u>/etc/pcp.conf</u> contains the local values for  these  variables.   The
       <b>$PCP_CONF</b> variable may be used to specify an alternative configuration file, as described in <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/perfalloc.1.html">perfalloc</a></b>(1), <b><a href="../man5/perfevent.conf.5.html">perfevent.conf</a></b>(5), <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1), <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1), <b><a href="../man1/pmlogrewrite.1.html">pmlogrewrite</a></b>(1), <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3), <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5), <b><a href="../man5/pcp.env.5.html">pcp.env</a></b>(5)
       and <b><a href="../man8/sysctl.8.html">sysctl</a></b>(8).

Performance Co-Pilot                                   PCP                                      <u><a href="../man1/PMDAPERFEVENT.1.html">PMDAPERFEVENT</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>