<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmdammv - memory mapped values performance metrics domain agent (PMDA)</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/pcp">pcp_6.3.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmdammv</b> - memory mapped values performance metrics domain agent (PMDA)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>$PCP_PMDAS_DIR/mmv/pmdammv</b> [<b>-d</b> <u>domain</u>] [<b>-l</b> <u>logfile</u>] [<b>-U</b> <u>username</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>pmdammv</b>  is a Performance Metrics Domain Agent (PMDA) which exports application level performance metrics
       using memory mapped files.  It offers an extremely low overhead instrumentation facility  that  is  well-
       suited  to  long running, mission critical applications where it is desirable to have performance metrics
       and availability information permanently enabled.

       The <b>mmv</b> PMDA exports instrumentation that has been added to an application using the MMV APIs  (refer  to
       <b><a href="../man3/mmv_stats_init.3.html">mmv_stats_init</a></b>(3)  and  <b><a href="../man5/mmv.5.html">mmv</a></b>(5)  for  further  details).  These APIs can be called from several languages,
       including C, C++, Perl, Python, Java (via the separate ``Parfait'' class library)  and  GoLang  (via  the
       separate ``Speed'' library).

       A brief description of the <b>pmdammv</b> command line options follows:

       <b>-d</b>   It  is  absolutely  crucial  that the performance metrics <u>domain</u> number specified here is unique and
            consistent.  That is, <u>domain</u> should be different for every PMDA on the one host, and the same <u>domain</u>
            number should be used for the same PMDA on all hosts.

       <b>-l</b>   Location of the log file.  By default, a log file named <u>mmv.log</u> is written in the current  directory
            of  <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1)  when <b>pmdammv</b> is started, i.e.  <b>$PCP_LOG_DIR/pmcd</b>.  If the log file cannot be created or
            is not writable, output is written to the standard error instead.

       <b>-U</b>   User account under which to run the agent.  The default is the unprivileged "pcp" account in current
            versions of PCP, but in older versions the superuser account ("root") was used by default.

</pre><h4><b>INSTALLATION</b></h4><pre>
       Firstly, a security model for interprocess communication between instrumented  applications  and  <b>pmdammv</b>
       (running as a shared library inside <b>pmcd</b>) must be chosen and established.

       This  communication  occurs  through  memory  mapped  files  in  a location known to both <b>pmdammv</b> and the
       instrumented applications.  That location is <u>$PCP_TMP_DIR/mmv</u>,  although  that  is  often  hidden  behind
       application  APIs  such  as  ``Parfait''  and  <b><a href="../man3/mmv_stats_init.3.html">mmv_stats_init</a></b>(3).   The permissions set on this directory
       indicate the security model in use.

       The more secure method is to  use  an  existing  unprivileged  group  which  is  shared  by  instrumented
       applications, <b>pmcd</b> and <b>pmdammv</b> such as the "pcp" group.

            # . /etc/pcp.env
            # mkdir -m 775 $PCP_TMP_DIR/mmv
            # chgrp pcp $PCP_TMP_DIR/mmv

       Since  this  method  requires  instrumented applications to use this non-default group (see <b><a href="../man1/newgrp.1.html">newgrp</a></b>(1) and
       <b><a href="../man2/setgid.2.html">setgid</a></b>(2)) a common alternative involves the use of a world-writable <u>$PCP_TMP_DIR/mmv</u> directory with  the
       sticky-bit set (similar to <u><a href="file:/tmp">/tmp</a></u> and <u><a href="file:/var/tmp">/var/tmp</a></u>, for example).

       This  allows  any  application,  running under any user account, to communicate with the PMDA (which runs
       under the "pcp" account by default).  This may not be desirable  for  all  environments  and  one  should
       consider  the  security implications of any directory setup like this (similar classes of issues exist as
       those that affect the system temporary file directories).

       <b>pmdammv</b> is enabled by default on all modern PCP installations, and thus the names, help text  and  values
       for the mmv performance metrics are available without the usual PMDA ./Install process.

       If  the  <u>$PCP_TMP_DIR/mmv</u>  directory  does  not  exist, then the ./Install script can be used to create a
       world-writable sticky-bit-set directory for communication.  This is for backwards compatibility, as  well
       as ease of use - to use this mechanism, do the following as root:

            # rmdir $PCP_TMP_DIR/mmv
            # cd $PCP_PMDAS_DIR/mmv
            # ./Install

       This installation process will not overwrite any existing <u>$PCP_TMP_DIR/mmv</u> directory.

       If you want to undo the installation, do the following as root:

            # cd $PCP_PMDAS_DIR/mmv
            # ./Remove

       <b>pmdammv</b> is launched by <b>pmcd</b> and should never be executed directly.  The Install and Remove scripts notify
       <b>pmcd</b> when the agent is installed or removed.

</pre><h4><b>FILES</b></h4><pre>
       <b>$PCP_PMCDCONF_PATH</b>
                 command line options used to launch <b>pmdammv</b>
       <b>$PCP_TMP_DIR/mmv</b>
                 directory housing memory mapped value files
       <b>$PCP_PMDAS_DIR/mmv/help</b>
                 default help text file for the mmv metrics
       <b>$PCP_PMDAS_DIR/mmv/Install</b>
                 installation script for the <b>pmdammv</b> agent
       <b>$PCP_PMDAS_DIR/mmv/Remove</b>
                 undo installation script for the <b>pmdammv</b> agent
       <b>$PCP_LOG_DIR/pmcd/mmv.log</b>
                 default log file for error messages and other information from <b>pmdammv</b>

</pre><h4><b>PCP</b> <b>ENVIRONMENT</b></h4><pre>
       Environment  variables with the prefix <b>PCP_</b> are used to parameterize the file and directory names used by
       PCP.  On each installation, the file <u>/etc/pcp.conf</u> contains the local values for  these  variables.   The
       <b>$PCP_CONF</b> variable may be used to specify an alternative configuration file, as described in <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1), <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1), <b><a href="../man1/newgrp.1.html">newgrp</a></b>(1), <b><a href="../man2/setgid.2.html">setgid</a></b>(2), <b><a href="../man3/mmv_stats_init.3.html">mmv_stats_init</a></b>(3), <b><a href="../man5/mmv.5.html">mmv</a></b>(5), <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5) and <b><a href="../man5/pcp.env.5.html">pcp.env</a></b>(5).

Performance Co-Pilot                                   PCP                                            <u><a href="../man1/PMDAMMV.1.html">PMDAMMV</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>