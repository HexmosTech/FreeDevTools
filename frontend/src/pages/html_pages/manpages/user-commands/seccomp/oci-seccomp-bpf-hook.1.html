<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oci-seccomp-bpf-hook prestart [container.json]</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/oci-seccomp-bpf-hook">oci-seccomp-bpf-hook_1.2.10+ds-2_amd64</a> <br><br><pre>
</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>oci-seccomp-bpf-hook</b> prestart [container.json]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  oci  hook  <b>oci-seccomp-bpf-hook</b>  generates  seccomp  profiles  by  tracing  the syscalls made by the
       container. The generated profile would whitelist all the syscalls made and blacklist all other syscall.

       The syscalls are traced by launching a binary using the OCI prestart hook.  The  binary  spawns  a  child
       process  which attaches the function <b>enter_trace</b> to the <b>raw_syscalls:sys_enter</b> tracepoint using eBPF. The
       hook buffers all syscalls made by processes  within  the  PID  namespace  of  the  container.   When  the
       container exits, the hook writes out the seccomp profile using all of the syscalls stored in the buffer.

       There are a few limitations to this approach:

       Requires:

       Root privileges (CAP_SYS_ADMIN).  Hook will not work with rootless containers.

       The bcc tool chain and kernel-headers to run. BPF programs must be compiled before running to match the current kernel.

       A container engine that supports OCI Hooks.

       Annotation:

       The oci-seccomp-bpf-hook requires the container be run with the annotation `io.containers.trace-syscall=`. It must include an output file parameter `of:[output file]` This output file must be a absolute path.

       Optionally you can include an input file parameter `if:[input file]` pointing to a previously generated seccomp profile file.  This input file must also be an absolute path.  If specified the oci-seccomp-bpf-hook will read in the input seccomp profile and preload the list of syscalls.

       The profile will be created at the output path provided to the annotation. An input file can be used to create a baseline and newly recorded syscalls will be added to the set and written to the output. If a syscall is blocked in the base profile, then it will remain blocked in the output file even if it is recorded while tracing.

       This annotation can be used directly via container engines like Podman or passed into the container engine by Kubernetes.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>sudo</b> <b>podman</b> <b>run</b> <b>--annotation</b> <b>io.containers.trace-syscall="of:/tmp/seccomp-new.json"</b> <b>IMAGE</b> <b>COMMAND</b>

       <b>sudo</b>  <b>podman</b>  <b>run</b>  <b>--annotation</b> <b>io.containers.trace-syscall="if:/tmp/seccomp-origin.json;of:/tmp/seccomp-</b>
       <b>new.json"</b> <b>IMAGE</b> <b>COMMAND</b>

</pre><h4><b>FILES</b></h4><pre>
       OCI hook configuration file for prestart

       <b>/usr/share/containers/oci/hooks.d/oci-seccomp-bpf-hook.json</b>

       <b>/etc/containers/oci/hooks.d/oci-seccomp-bpf-hook.json</b> <b>(Override)</b>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/podman.1.html">podman</a>(1), <a href="../man2/seccomp.2.html">seccomp</a>(2), <a href="../man5/oci-hooks.5.html">oci-hooks</a>(5)

</pre><h4><b>AUTHORS</b></h4><pre>
       Divyansh Kamboj <a href="mailto:kambojdivyansh2000@gmail.com">kambojdivyansh2000@gmail.com</a> ⟨<a href="mailto:kambojdivyansh2000@gmail.com">mailto:kambojdivyansh2000@gmail.com</a>⟩

       Valentin Rothberg <a href="mailto:vrothberg@redhat.com">vrothberg@redhat.com</a> ⟨<a href="mailto:vrothberg@redhat.com">mailto:vrothberg@redhat.com</a>⟩

       Dan Walsh <a href="mailto:dwalsh@redhat.com">dwalsh@redhat.com</a> ⟨<a href="mailto:dwalsh@redhat.com">mailto:dwalsh@redhat.com</a>⟩

systemd                                                OCI                           <u><a href="../man1/oci-seccomp-bpf-hook.1.html">oci-seccomp-bpf-hook</a>(1)</u>(--)
</pre>
 </div>
</div></section>
</div>
</body>
</html>