<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bup-restore - extract files from a backup set</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/bup-doc">bup-doc_0.33.7-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       bup-restore - extract files from a backup set

</pre><h4><b>SYNOPSIS</b></h4><pre>
       bup  restore  [-r <u>host</u>:[<u>path</u>]] [--outdir=<u>outdir</u>] [--exclude-rx <u>pattern</u>] [--exclude-rx-from <u>filename</u>] [-v]
       [-q] &lt;paths...&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       bup restore extracts files from a backup set (created with <a href="../man1/bup-save.1.html">bup-save</a>(1)) to the local filesystem.

       The specified <u>paths</u> are of the form /<u>branch</u>/<u>revision</u>/<u>some/where</u>.  The  components  of  the  path  are  as
       follows:

       branch the  name  of  the  backup  set to restore from; this corresponds to the --name (-n) option to bup
              save.

       revision
              the revision of the backup set to restore.  The revision <u>latest</u> is always the most  recent  backup
              on the given branch.  You can discover other revisions using bup ls /branch.

       some/where
              the  previously  saved path (after any stripping/grafting) that you want to restore.  For example,
              etc/passwd.

       If <u>some/where</u> names a directory, bup restore will restore that directory and then recursively restore its
       contents.

       If <u>some/where</u> names a directory and ends with a slash (ie.  path/to/dir/), bup restore will  restore  the
       children  of  that directory directly to the current directory (or the --outdir).  If <u>some/where</u> does not
       end in a slash, the children will be restored to a subdirectory of the current directory.

       If <u>some/where</u> names a directory and ends in `<a href="file:/.">/.</a>' (ie.  path/to/dir/.), bup restore will do  exactly  what
       it  would  have  done  for  path/to/dir, and then restore <u>dir</u>’s metadata to the current directory (or the
       --outdir).  See the EXAMPLES section.

       As a special case, if <u>some/where</u> names the “latest” symlink, e.g. bup restore /foo/latest, then bup  will
       act  exactly as if the save that “latest” points to had been specified, and restore that, rather than the
       “latest” symlink itself.

       Whenever path metadata is available, bup restore will attempt to restore it.  When  restoring  ownership,
       bup  implements  tar/rsync-like semantics.  It will normally prefer user and group names to uids and gids
       when they’re available, but it will not try to restore the user unless running as root, and it will  fall
       back  to the numeric uid or gid whenever the metadata contains a user or group name that doesn’t exist on
       the current system.  The use of user and group names can be disabled  via  --numeric-ids  (which  can  be
       important  when  restoring a chroot, for example), and as a special case, a uid or gid of 0 will never be
       remapped by name.  Additionally, some systems don’t allow setting a uid/gid that doesn’t correspond  with
       a known user/group.  On those systems, bup will log an error for each relevant path.

       The  --map-user,  --map-group, --map-uid, --map-gid options may be used to adjust the available ownership
       information before any of the rules above are applied, but note that due to those  rules,  --map-uid  and
       --map-gid  will  have  no  effect  whenever  a  path  has  a valid user or group.  In those cases, either
       --numeric-ids must be specified, or the user or group must be cleared by a suitable  --map-user  foo=  or
       --map-group foo=.

       Hardlinks  will  also be restored when possible, but at least currently, no links will be made to targets
       outside the restore tree, and if the restore tree spans a different arrangement of filesystems  from  the
       save tree, some hardlink sets may not be completely restored.

       Also  note  that  changing  hardlink  sets on disk between index and save may produce unexpected results.
       With the current implementation, bup will attempt to recreate any given hardlink set  as  it  existed  at
       index  time,  even if all of the files in the set weren’t still hardlinked (but were otherwise identical)
       at save time.

       Note that during the restoration process, access to data within the restore tree may be  more  permissive
       than  it  was  in  the  original  source.   Unless  security is irrelevant, you must restore to a private
       subdirectory, and then move the resulting tree to its final position.  See the  EXAMPLES  section  for  a
       demonstration.

</pre><h4><b>OPTIONS</b></h4><pre>
       -r, --remote=<u>host</u>:<u>path</u>
              restore the backup set from the given remote server.  If <u>path</u> is omitted, uses the default path on
              the  remote  server  (you  still need to include the `:').  The connection to the remote server is
              made with SSH.  If you’d like to specify which port, user or  private  key  to  use  for  the  SSH
              connection, we recommend you use the <a href="file:~/.ssh/config">~/.ssh/config</a> file.

       -C, --outdir=<u>outdir</u>
              create and change to directory <u>outdir</u> before extracting the files.

       --numeric-ids
              restore numeric IDs (user, group, etc.)  rather than names.

       --exclude-rx=<u>pattern</u>
              exclude   any   path   matching   <u>pattern</u>,   which   must   be   a   Python   regular   expression
              (<a href="http://docs.python.org/library/re.html">http://docs.python.org/library/re.html</a>).  The pattern will be  compared  against  the  full  path
              rooted  at  the  top  of  the  restore  tree,  without anchoring, so “x/y” will match “ox/yard” or
              “box/yards”.  To exclude the contents of <a href="file:/tmp">/tmp</a>, but not the directory itself, use “^<a href="file:/tmp/.">/tmp/.</a>”.   (can
              be specified more than once)

              Note  that  the root of the restore tree (which matches `^/') is the top of the archive tree being
              restored,  and  has  nothing  to  do  with  the  filesystem  destination.   Given   “restore   ...
              /foo/latest/etc/”,  the  pattern  `^/passwd$' would match if a file named passwd had been saved as
              `/foo/latest/etc/passwd'.

              Examples:

              • `/foo$' - exclude any file named foo

              • `/foo/$' - exclude any directory named foo

              • `/foo/.' - exclude the content of any directory named foo

              • `^<a href="file:/tmp/.">/tmp/.</a>' - exclude root-level <a href="file:/tmp">/tmp</a>’s content, but not <a href="file:/tmp">/tmp</a> itself

       --exclude-rx-from=<u>filename</u>
              read –exclude-rx  patterns  from  <u>filename</u>,  one  pattern  per-line  (may  be  repeated).   Ignore
              completely empty lines.

       --sparse
              write  output  data sparsely when reasonable.  Currently, reasonable just means “at least whenever
              there are 512 or more consecutive zeroes”.

       --map-user <u>old</u>=<u>new</u>
              for every path, restore the <u>old</u> (saved) user name as <u>new</u>.  Specifying “” for <u>new</u>  will  clear  the
              user.  For example “–map-user foo=” will allow the uid to take effect for any path that originally
              had a user of “foo”, unless countermanded by a subsequent “–map-user foo=...”  specification.  See
              DESCRIPTION above for further information.

       --map-group <u>old</u>=<u>new</u>
              for  every  path, restore the <u>old</u> (saved) group name as <u>new</u>.  Specifying “” for <u>new</u> will clear the
              group.  For example “–map-group foo=” will allow  the  gid  to  take  effect  for  any  path  that
              originally  had  a  group  of  “foo”,  unless  countermanded  by a subsequent “–map-group foo=...”
              specification.  See DESCRIPTION above for further information.

       --map-uid <u>old</u>=<u>new</u>
              for every path, restore the <u>old</u> (saved) uid as <u>new</u>, unless countermanded by a subsequent “–map-uid
              <u>old</u>=...” option.  Note that the uid will only be relevant for paths with no user.  See DESCRIPTION
              above for further information.

       --map-gid <u>old</u>=<u>new</u>
              for every path, restore the <u>old</u> (saved) gid as <u>new</u>, unless countermanded by a subsequent “–map-gid
              <u>old</u>=...” option.  Note that the gid will only be relevant for paths with no user.  See DESCRIPTION
              above for further information.

       -v, --verbose
              increase log output.  Given once, prints every directory as it is restored;  given  twice,  prints
              every file and directory.

       -q, --quiet
              suppress  output,  including  the  progress meter.  Normally, if stderr is a tty, a progress meter
              displays the total number of files restored.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Create a simple test backup set:

              $ bup index -u <a href="file:/etc">/etc</a>
              $ bup save -n mybackup <a href="file:/etc/passwd">/etc/passwd</a> <a href="file:/etc/profile">/etc/profile</a>

       Restore just one file:

              $ bup restore /mybackup/latest/etc/passwd
              Restoring: 1, done.

              $ ls -l passwd
              -rw-r--r-- 1 apenwarr apenwarr 1478 2010-09-08 03:06 passwd

       Restore etc to test (no trailing slash):

              $ bup restore -C test /mybackup/latest/etc
              Restoring: 3, done.

              $ find test
              test
              test/etc
              test/etc/passwd
              test/etc/profile

       Restore the contents of etc to test (trailing slash):

              $ bup restore -C test /mybackup/latest/etc/
              Restoring: 2, done.

              $ find test
              test
              test/passwd
              test/profile

       Restore the contents of etc and etc’s metadata to test (trailing “<a href="file:/.">/.</a>”):

              $ bup restore -C test /mybackup/latest/etc/.
              Restoring: 2, done.

              # At this point test and etc's metadata will match.
              $ find test
              test
              test/passwd
              test/profile

       Restore a tree without risk of unauthorized access:

              # mkdir --mode 0700 restore-tmp

              # bup restore -C restore-tmp /somebackup/latest/foo
              Restoring: 42, done.

              # mv restore-tmp/foo somewhere

              # rmdir restore-tmp

       Restore a tree, remapping an old user and group to a new user and group:

              # ls -l /original/y
              -rw-r----- 1 foo baz  3610 Nov  4 11:31 y
              # bup restore -C dest --map-user foo=bar --map-group baz=bax /x/latest/y
              Restoring: 42, done.
              # ls -l dest/y
              -rw-r----- 1 bar bax  3610 Nov  4 11:31 y

       Restore a tree, remapping an old uid to a new uid.  Note that the old user must be  erased  so  that  bup
       won’t prefer it over the uid:

              # ls -l /original/y
              -rw-r----- 1 foo baz  3610 Nov  4 11:31 y
              # ls -ln /original/y
              -rw-r----- 1 1000 1007  3610 Nov  4 11:31 y
              # bup restore -C dest --map-user foo= --map-uid 1000=1042 /x/latest/y
              Restoring: 97, done.
              # ls -ln dest/y
              -rw-r----- 1 1042 1007  3610 Nov  4 11:31 y

       An alternate way to do the same by quashing users/groups universally with --numeric-ids:

              # bup restore -C dest --numeric-ids --map-uid 1000=1042 /x/latest/y
              Restoring: 97, done.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/bup-save.1.html">bup-save</a>(1), <a href="../man1/bup-ftp.1.html">bup-ftp</a>(1), <a href="../man1/bup-fuse.1.html">bup-fuse</a>(1), <a href="../man1/bup-web.1.html">bup-web</a>(1)

</pre><h4><b>BUP</b></h4><pre>
       Part of the <a href="../man1/bup.1.html">bup</a>(1) suite.

</pre><h4><b>AUTHORS</b></h4><pre>
       Avery Pennarun <a href="mailto:apenwarr@gmail.com">apenwarr@gmail.com</a>

Bup 0.33.7                                         2025-01-11                                     <u><a href="../man1/bup-restore.1.html">bup-restore</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>