<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>log2pcap - Extract network traces from Samba log files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/samba">samba_4.15.13+dfsg-0ubuntu1.7_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       log2pcap - Extract network traces from Samba log files

</pre><h4><b>SYNOPSIS</b></h4><pre>

       log2pcap [-h] [-q] [logfile] [pcap_file]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This tool is part of the <b><a href="../man7/samba.7.html">samba</a></b>(7) suite.

       log2pcap reads in a samba log file and generates a pcap file (readable by most sniffers, such as ethereal
       or tcpdump) based on the packet dumps in the log file.

       The log file must have a <u>log</u> <u>level</u> of at least <b>5</b> to get the SMB header/parameters right, <b>10</b> to get the
       first 512 data bytes of the packet and <b>50</b> to get the whole packet.

</pre><h4><b>OPTIONS</b></h4><pre>
       -h
           If this parameter is specified the output file will be a hex dump, in a format that is readable by
           the text2pcap utility.

       -q
           Be quiet. No warning messages about missing or incomplete data will be given.

       logfile
           Samba log file. log2pcap will try to read the log from stdin if the log file is not specified.

       pcap_file
           Name of the output file to write the pcap (or hexdump) data to. If this argument is not specified,
           output data will be written to stdout.

       -?|--help
           Print a summary of command line options.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Extract all network traffic from all samba log files:

                          $ log2pcap &lt; <a href="file:/var/log/">/var/log/</a>* &gt; trace.pcap

       Convert to pcap using text2pcap:

                $ log2pcap -h samba.log | text2pcap -T 139,139 - trace.pcap

</pre><h4><b>VERSION</b></h4><pre>
       This man page is part of version 4.15.13-Ubuntu of the Samba suite.

</pre><h4><b>BUGS</b></h4><pre>
       Only SMB data is extracted from the samba logs, no LDAP, NetBIOS lookup or other data.

       The generated TCP and IP headers don't contain a valid checksum.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/text2pcap.1.html">text2pcap</a></b>(1), <b><a href="../man1/ethereal.1.html">ethereal</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
       The original Samba software and related utilities were created by Andrew Tridgell. Samba is now developed
       by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.

       This manpage was written by Jelmer Vernooij.

Samba 4.15.13-Ubuntu                               07/21/2025                                        <u><a href="../man1/LOG2PCAP.1.html">LOG2PCAP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>