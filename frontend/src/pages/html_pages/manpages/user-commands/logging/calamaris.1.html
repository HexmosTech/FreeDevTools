<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>calamaris - generate text and graphical statistics out of log files from Proxy-Cache-Servers</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/calamaris">calamaris_2.99.4.8-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>calamaris</b> - generate text and graphical statistics out of log files from Proxy-Cache-Servers

</pre><h4><b>SYNOPSIS</b></h4><pre>
       cat log | <b>calamaris</b> [ --config-file .../calamaris.conf ] [ switches ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Calamaris</b> is used to produce statistical output from <b>Squid</b>, <b>NetCache</b>, <b>Inktomi</b> <b>Traffic</b> <b>Server</b>, <b>Oops!</b> <b>proxy</b>
       <b>server</b>,  <b>Compaq</b> <b>Tasksmart</b>, <b>Cisco</b> <b>Content</b> <b>Engines</b> or related Proxy log files.  The resulting output can be
       ascii or html with or without graphic and with or without frames. It is possible to cache calculated data
       in a file to use them in later runs.

       This manual page describes the options of <b>Calamaris</b> and gives a few examples.

</pre><h4><b>OPTIONS</b></h4><pre>
   <b>Configuration</b> <b>File</b>
       <u>--config-file</u> <u>file</u>

              Not all reports and modification can be made through command-line-switches.  To use all options of
              Calamaris youÂ´ll have to use the configuration file.   You'll  find  the  configuration-directives
              below,  always  inside  of braces.  Examples are in the calamaris.conf which should come with this
              package.

   <b>Reports</b>
       <u>--all-useful-reports|-a</u>
              extracts all useful reports available, <u>--all-useful-reports</u> equals  <u>--size-distribution-report</u>  <u>10</u>
              <u>--domain-report</u>  <u>20</u> <u>--performance-report</u> <u>60</u> <u>--requester-report</u> <u>20</u> <u>--status-report</u> <u>--type-report</u> <u>20</u>
              <u>--response-time-report</u> <u>--errorcode-distribution-report</u>

       <u>--domain-report|-d</u> <u>n</u> <u>($domain_report)</u>
              switches the top level and the second level report on.  The data is derived  from  the  URL.   The
              output is limited by n. (-1 is unlimited)

       <u>--domain-report-limit</u> <u>n</u> <u>($domain_report_limit)</u>
              limit the domain-report to lines which have n or more requests.

       <u>--domain-report-n-level|-N</u> <u>n</u> <u>($domain_report_n_level)</u>
              All URL-Host reports will be switched from 2nd-level to n-level-reports. (-1 shows a full urlhost-
              report)

              <b>Note:</b> This option is only useful with activated domain-report.

       <u>--errorcode-distribution-report</u> <u>($errorcode_distribution_report)</u>
              shows the Response code distribution over all objects

       <u>($object_freshness_report)</u>
              shows  the freshness of objects in your cache.  <b>Calamaris</b> looks for freshness tags like 'TCP_HIT',
              'TCP_REFRESH_MISS', ...  and make statistics on it. With this information  you  can  optimize  the
              caching  behaviour  of  your cache depending on the objects content type.  E.g. squid admins could
              use this information to configure the refresh_pattern. This option needs more configuration in the
              configuration-file.

       <u>--peak-report|-p</u> <u>type</u> <u>($peak_report)</u>
              Measures the peaks of the Proxy usage in requests per second, per minute and per hour.  It reports
              peaks for TCP, UDP and ALL requests. If set to <u>'old'</u> these values were  calculated  with  the  old
              slow method, if set to <u>'new'</u> the new faster (but still slow) method is used.

       <u>--performance-report|-P</u> <u>n</u> <u>($performance_report)</u>
              Shows the throughput of TCP requests for every n minutes.

       <u>--performance-report-adjust|-T</u> <u>n</u> <u>($performance_report_adjust)</u>
              Time: Adjust the Performancereport in minutes for non GMT-Timezoners.

       <u>--requester-report|-r</u> <u>n</u> <u>($requester_report)</u>
              Switches the UDP and TCP requester reports on.  The output is limited by n.  (-1 is unlimited)

       <u>--requester-report-no-dns-lookup|-n</u> <u>($requester_report_no_dns_lookup)</u>
              Switches the IP lookup for the requesters off.

       <u>--requester-report-use-user-info|-u</u> <u>($requester_report_use_user_info)</u>
              Switches the usage of eventually available ident information for requester reports on.

              <b>Warning:</b> This breaks the privacy of your users! (see PRIVACY-Section below)

       <u>--requester-report-with-targets|-R</u> <u>n</u> <u>($requester_report_with_targets)</u>
              adds  to each line of the requester report the requested URLs. The output is limited by n.  (-1 is
              unlimited, and can result in very very long reports.)

              <b>Warning:</b> Using this option breaks the privacy of your users! (see PRIVACY-Section below)

       <u>--response-time-report</u> <u>($response_time_report)</u>
              sums up the time distribution over all objects

       <u>(@response_time_report_interval)</u>
              This array defines the time steps, which should be reported in the response-time-report.

       <u>--size-distribution-report|-D</u> <u>n</u> <u>($size_distribution_report)</u>
              shows size-based distribution of  requested  objects,  smaller  numbers  result  in  more  verbose
              reports. (choose 2, 10 or 100 for useful output.)

       <u>--status-report|-s</u> <u>($status_report)</u>
              alters the default behaviour of <b>Calamaris</b> and makes the status reports more verbose.

       <u>--type-report|-t</u> <u>n</u> <u>($type_report)</u>
              switches  the  content type and the file extension report on.  The output is limited by n.  (-1 is
              unlimited)

       <u>--type-report-ignore-case|-c</u> <u>($type_report_ignore_case)</u>
              Switch to case-insensitive. This is useful for the 'Requested extensions' report.

   <b>Input</b>
       <u>--input-format|-f</u> <u>type</u> <u>($input_format)</u>
              sets the type of input logfiles. If set to

              <u>'auto'</u> <b>Calamaris</b> tries to guess the input file format.  This is the Default.

              <b>Note:</b> If the first line of your input file is corrupted, <b>Calamaris</b> will stop with an error.

              <u>'squid'</u> <b>Calamaris</b> expects native logfile derived from <b>Squid</b> V1.1.beta26-V2.x or <b>OOPS.</b>

              <u>'squid-extended'</u> <b>Calamaris</b>  expects  native  logfile  derived  from  <b>Squid</b>  V1.1.alpha1-V2.x  with
              <u>log_mime_hdrs</u> enabled or <b>Squid</b> with <b>Smartfilter-Patch</b> or squid-style logfiles out of <b>Cisco</b> <b>Content</b>
              <b>Engines.</b>   (This  only  enables  parsing  of  these  kind  of logfile, the additional data will be
              ignored.)

              (Logging of MIME-Headers breaks the privacy of your users! (see PRIVACY-Section below)

              <u>'squid-old'</u> <b>Calamaris</b> expects native logfile derived from <b>Squid</b> V1.1.alpha1-V1.1.beta25.

              <u>'nc'</u> <b>Calamaris</b> expects Logfiles from <b>NetCache</b> up to V4.x. (Please see the README on this.)

              <u>'its'</u> <b>Calamaris</b> expects Logfiles from <b>Inktomi</b> <b>Traffic</b> <b>Server.</b>

              <u>'elff'</u> <b>Calamaris</b> expects Logfiles in Extended Logfile Format (i.e. from <b>Compaq</b>  <b>Tasksmart,</b>  <b>Novell</b>
              <b>Internet</b> <b>Caching</b> <b>System</b> or <b>NetCache</b> V5.x)

              <u>'nse'</u>  <b>Calamaris</b>  expects  Logfiles  in  Netscape Extended-1 or Netscape Extended-2 Logfile Format
              (from <b>Netscape/iPlanet/SunOne</b> <b>Proxy-Server</b> )

       <u>--ipfilter-exclude</u> <u>IP/range</u> <u>($ipfilter_exclude)</u>
              all    IPs    are    analyzed,    except    IP/range.     Format:     1.1.1.1/32:1.1.2.0/24     or
              1.1.1.1/255.255.255.255:1.1.2.0/255.255.255.0

              IP list separated by ':' This switch needs the perl Module NetAddr::IP.

              <b>Warning:</b> This breaks the privacy of your users! (see PRIVACY-Section below)

       <u>--ipfilter-include</u> <u>IP/range</u> <u>($ipfilter_include)</u>
              no IPs are analyzed, except IP/range. Format: see --ipfilter-exclude

              <b>Warning:</b> This breaks the privacy of your users! (see PRIVACY-Section below)

       <u>--no-input|-z</u> <u>($no_input)</u>
              Switches  reading from standard input off.  You can use this to merge many cache files to one (see
              <u>--cache-input-file</u> and <u>--cache-output-file)</u> or to generate a report out of cache files.

       <u>--time-interval|-I</u> <u>t-t</u> <u>($time_interval)</u>
              defines which time-interval should be parsed.  t has to be the format yyyymmddhhmmss (localtime)

              <b>Note:</b> omitting the beginning or ending date is allowed.

   <b>Output</b>
       Standard output format is plain ascii with 80 chars width.

       <u>($column1_color)</u>
              <u>($column2_color)</u> defines the colors for the columns in graphics. (only useful with <u>--output-format</u>
              graph)

       <u>($formats[n])</u>
              Through the config-file you are able to modify the width of the report and alter the culomns  that
              are displayed in the reports. n is the number of the report, as displayed by --help in the --show-
              reports-option.

       <u>--hostname|-H</u> <u>name</u> <u>($hostname)</u>
              The  name  for the title or subject of the output.  If set to <u>'lookup'</u> <b>Calamaris</b> looks up the host
              name of the system its been run on.

       <u>--image-type</u> <u>($image_type)</u>
              Sets the image type to gif, png, jpeg, gd or gd2. Only useful when <u>--output-format</u> <u>graph</u>  is  set.
              The available images types are depending on your GD::Graph installation. Default is 'png'.

       <u>--logo|-l</u> <u>string</u> <u>($logo)</u>
              add  a custom string to a HTML-Report. It'll be added to a table on the top of the output.  <u>-l</u> <u>'&lt;A</u>
              <u>HREF="https://cord.de/"&gt;&lt;IMG</u>   <u>BORDER=0</u>    SRC="https://cord.de/sites/default/files/cordlog2n.gif"
              ALT="Cord"&gt;&lt;/A&gt;' will add my logo with a link to the Report.

              <b>Note:</b> <u>--logo</u> works only in combination with <u>--output-format</u> <u>html</u> <u>or</u> <u>html-frame</u>

       <u>--meta|-M</u> <u>string</u> <u>($meta)</u>
              Meta:  adds  a  custom string or the content of a file into the &lt;HEAD&gt; of a HTML-Report. Useful if
              you want to add Stylesheets or something to the Report.

              <b>Note:</b> <u>--meta</u> works only in combination with <u>--output-format</u> <u>html</u> <u>or</u> <u>html-frame</u>

       <u>--output-format|-F</u> <u>type[,type[,type[,...]]]</u> <u>($output_format)</u>
              Format: sets the format of the output-report. If set to

              <u>'mail'</u> adds a subject header to the beginning of the report.

              <u>'html'</u> all output is given in html with tables.  Can be combined with <u>'mail'</u> to send html mails.

              <u>'html-frame'</u> all output is given in html frames with tables.

              <u>'html-embed'</u> all output is given in html with tables without HTML-Headers. Useful for Server-Side-
              Includes.

              <u>'graph'</u> enables graphics for html, html-embed or html-frame.

              <u>'unformatted'</u> gives out the raw numbers separated by spaces. Useful for  re-using  the  output  in
              other  scripts.  If  you use this along with <u>-U,</u> the byte values are calculated in the given Unit,
              and displayed without indication along with the numbers. the indication moves up to the header  of
              the report.

       <u>--output-path</u> <u>($output_path)</u>
              output  calamaris  statistics to /path. In case of graph output, the graphics destination is /path
              and the filename is index.html, else it is calamaris.txt.  If  <u>--output-path</u>  is  not  given,  all
              graphics are written to the working directory.

       <u>--output-file</u> <u>($output_file)</u>
              alter the filename of --output-path.

       <u>--output-file-prefix</u> <u>($output_file_prefix)</u>
              adds  a  prefix to <u>--output-file</u> <u>%t</u> is replaced by the timerange of the report, <u>%h</u> by the hostname
              (see <u>--hostname</u> )

       <u>--show-reports|-S</u> <u>n[,n[,n[,...]]]</u> <u>($show_reports)</u>
              Show: Shows only the defined reports in the specified order. Default is to display the reports  as
              they are defined through the report-switches above. The following numbers are defined:

              0  Summary
              1  Incoming request peak per protocol
              2  Incoming transfer volume peak per protocol
              3  Incoming requests by method
              4  Incoming UDP-requests by status
              5  Incoming TCP-requests by status
              6  Outgoing requests by status
              7  Outgoing requests by destination
              8  Request-destinations by 2ndlevel-domain
              9  Request-destinations by toplevel-domain
              10 TCP-Request-protocol
              11 Requested content-type
              12 Requested extensions
              13 Incoming UDP-requests by host
              14 Incoming TCP-requests by host
              15 Size Distribution Diagram
              16 Performance in n minute steps
              17 UDP-Request duration distribution in msec
              18 TCP-Request duration distribution in msec
              19 UDP Response code distribution
              20 TCP Response code distribution

       <b>Note:</b> Using this doesn't make <b>Calamaris</b> any faster, the internal calculations will be done as the report-
       switches were set (see above).

       <u>--sort-order|-O</u> <u>($sort_order)</u>
              Changes the sort order in the reports to request size, default is sorting by number of requests.

       <u>($text_color)</u>
              defines  the  colors  for  text/axis/legend/labels  in graphics. (only useful with <u>--output-format</u>
              <u>graph</u> )

       <u>--unit|-U</u> <u>string</u> <u>($unit)</u>
              You can define this to K(ilo), M(ega), G(iga) or T(era) for the Byte-units.

       <u>($width)</u>
              defines the width of the graphics. height is calculated from this with a 3:2-ratio.  (only  useful
              with <u>--output-format</u> <u>graph</u> )

       <u>($x_scale)</u>
              defines  how many datasets should be drawn on the graph. 30 is a good value, but you can play with
              this. if $x_scale gets to big, you're on your own ;-)

       <u>--generate-index</u> <u>($generate_index)</u>
              generates an index for all reports that match <u>--output-file-prefix.</u>

   <b>Caching</b>
       <u>--cache-input-file|-i</u> <u>file</u> <u>($cache_input_file)</u>
              You can reuse a cache file generated with <u>--cache-output-file</u> <u>file</u>  to  add  old  data  to  a  new
              report.  Several files can be separated with a ':'.

              <b>Note:</b>  if  you  use  more  than  one cache file, make sure they are chronologicaly ordered (oldest
              first).

              <b>Note:</b> if you reuse cache-files, which were not created with <u>-d</u> <u>-1</u> <u>-r</u> <u>-1</u> <u>-t</u> <u>-1</u> <u>-R</u> <u>-1</u> the number  of
              'others' would be wrong everywhere. In this case the number of 'others' are omitted.

       <u>--cache-output-file|-o</u> <u>file</u> <u>($cache_output_file)</u>
              <b>Calamaris</b>  stores  a  summary  of the computed information in <u>file</u> and you can reuse it at a later
              time with <u>--cache-input-file</u>

              <b>Note:</b> The output file can be the same as the input file: it is simply  overwritten  after  reading
              the data.  It is not recommended to change the options between different runs if you include older
              data as this can result in strange measurements.

   <b>Misc</b>
       <u>--benchmark|-b</u> <u>n</u> <u>($benchmark)</u>
              benchmark: A switch for the impatient as it prints a '#' for every n parsed lines.

       <u>--copyright|-C</u>
              Prints the copyright information of <b>Calamaris</b>

       <u>--help|-h</u>
              Prints a brief description of the command line options.

       <u>--version|-V</u>
              Prints out the Version-Number.

   <b>Debug</b>
       <u>--dump-loop|-L</u>
              prints the internal loop to STDERR. (for Debugging)

       <u>($test)</u>
              activates some small tests for the programmer.

       <u>--verbose|-v</u> <u>($verbose)</u>
              print more information about what is Calamaris is doing and believing.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This example mails the daily statistics to root:
              cat  /var/log/squid/access.log  |  nice -39 <b>calamaris</b> <u>--all-useful-reports</u> <u>--hostname</u> "daily worf"
              <u>--output-format</u> mail | mail root

       This one only caches a summary for later use:
              cat /var/log/squid/access.log |  <b>calamaris</b>  --all-useful-reports  --cache-output-file  daily.`date
              +"%w"` &gt; /dev/null

       You can then use the caches to have weekly statistics:

       if [ $DAYOFWEEK = "0" ]; then
              <b>calamaris</b>                          --all-useful-reports                         --cache-input-file
              daily.1:daily.2:daily.3:daily.4:daily.5:daily.6:daily.0 --no-input --output-format mail --hostname
              "weekly worf" | mail root ;

       fi

</pre><h4><b>BUGS</b></h4><pre>
       If you have a problem with <b>Calamaris</b> , please make sure that you use the recent version of <b>Calamaris</b> (see
       VERSION below). Also check that your proxy works correctly and doesn't produce invalid Logfiles. (see the
       README for buglist and pointers.)

       If you're sure that you've encountered a bug in <b>Calamaris</b> please report it to <a href="mailto:Calamaris-bug@cord.de">Calamaris-bug@cord.de</a>. This
       also applies if <b>Calamaris</b> itself says 'please report this'.

</pre><h4><b>PRIVACY</b></h4><pre>
       <b>Calamaris</b> can be (mis-)used to track what users are requesting.

       So please read the following and think about it, before using <b>Calamaris</b> to be the <u>Big</u> <u>Brother.</u>

       -      If you don't trust your users than there is something more wrong than the loss of productivity.

       -      Squid has some nice acl-mechanisms. If you think that your users don't use the net properly, don't
              let them use it. (You can also open the net at specific times or to specific sites, if you want.)

       -      If you still want to use <b>Calamaris</b> that way, let your vict^Wusers know, that they'll be monitored.
              (in Germany you have to let them know!)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/squid.8.html">squid</a>(8)</b>

</pre><h4><b>AUTHOR</b></h4><pre>
       Cord Beermann &lt;<a href="mailto:Cord@Wunder-Nett.org">Cord@Wunder-Nett.org</a>&gt;, Michael Pophal &lt;<a href="mailto:michael.pophal@nefkom.net">michael.pophal@nefkom.net</a>&gt;.  There are also  a  lot
       of people who contributed code, gave ideas or requested features. Look them up in the executable.

       This  man  page  was  written  by  Philipp  Frauenfelder  &lt;<a href="mailto:pfrauenf@debian.org">pfrauenf@debian.org</a>&gt;, maintainer of the Debian
       package.  Maintenance is now taken over by Cord Beermann.

</pre><h4><b>VERSION</b></h4><pre>
       Version of this manpage: $Id: calamaris.1,v 3.1 2006-03-19 17:52:48 cord Exp $

       It describes the usage of Calamaris V3.0 and later.

       Information about new releases, mailing lists, and other related issues can be found from  the  <b>Calamaris</b>
       home page at URL https://Calamaris.Cord.de/

</pre><h4><b>WARRANTY</b></h4><pre>
       <b>Calamaris</b> comes with "absolutely no warranty".

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 1997-2006, 2013, 2015, 2017, 2021 Cord Beermann

       This  program  is  free  software;  you  can  redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation; either version 2 of the License,  or
       (at your option) any later version.

       (If  you modify and want to publish it under the name <b>Calamaris</b> , please ask me.  I don't want to confuse
       the 'audience' with many different versions of the same name and/or Version number.  (This is not part of
       the license, it is only a favour i asked of you.))

       This program is distributed in the hope that it will be useful, but WITHOUT ANY  WARRANTY;  without  even
       the  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with this program; if not,  write
       to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.

Handmade                                  $Date: 2006-03-19 17:52:48 $                              <u><a href="../man1/CALAMARIS.1.html">CALAMARIS</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>