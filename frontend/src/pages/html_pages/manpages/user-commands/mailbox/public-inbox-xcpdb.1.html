<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>public-inbox-xcpdb - upgrade Xapian DB formats</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/public-inbox">public-inbox_1.9.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       public-inbox-xcpdb - upgrade Xapian DB formats

</pre><h4><b>SYNOPSIS</b></h4><pre>
       public-inbox-xcpdb [OPTIONS] INBOX_DIR

       public-inbox-xcpdb [OPTIONS] --all

</pre><h4><b>DESCRIPTION</b></h4><pre>
       public-inbox-xcpdb is similar to <b><a href="../man1/copydatabase.1.html">copydatabase</a></b>(1) for upgrading to the latest database format supported by
       Xapian (e.g. "glass" or "honey"), but is designed to tolerate and accept parallel Xapian database
       modifications from <b><a href="../man1/public-inbox-watch.1.html">public-inbox-watch</a></b>(1), <b><a href="../man1/public-inbox-mda.1.html">public-inbox-mda</a></b>(1), <b><a href="../man1/public-inbox-learn.1.html">public-inbox-learn</a></b>(1), and
       <b><a href="../man1/public-inbox-index.1.html">public-inbox-index</a></b>(1).

       This command is rarely used, as Xapian DB formats rarely change.

</pre><h4><b>OPTIONS</b></h4><pre>
       --all
           Copy  all  inboxes  configured  in  <a href="file:~/.public-inbox/config.">~/.public-inbox/config.</a>   This  is  an  alternative to specifying
           individual inboxes directories on the command-line.

       -c
       --compact
           In addition to performing the copy operation,  run  <b><a href="../man1/xapian-compact.1.html">xapian-compact</a></b>(1)  on  each  Xapian  shard  after
           copying  but  before  finalizing it.  Compared to the cost of copying a Xapian database, compacting a
           Xapian database takes only around 5% of the time required to copy.

           Compared to <b><a href="../man1/public-inbox-compact.1.html">public-inbox-compact</a></b>(1), use of this option is preferable for gigantic inboxes where  the
           coarse-grained  lock  currently required for <b><a href="../man1/public-inbox-compact.1.html">public-inbox-compact</a></b>(1) can cause the compaction to take
           hours at-a-time.

       -R N
       --reshard=N
           Reshard the Xapian database on a v2 inbox to "N" shards .  Since <b><a href="../man1/xapian-compact.1.html">xapian-compact</a></b>(1)  is  not  suitable
           for merging, users can rely on this switch to reshard the existing Xapian database(s) to any positive
           value of "N".

           This  is  useful  in  case  the  Xapian  DB  was  created  with  too few or too many shards given the
           capabilities of the current hardware.

       --blocksize
       --no-full
       --fuller
           These options are passed directly to <b><a href="../man1/xapian-compact.1.html">xapian-compact</a></b>(1) when used with "--compact".

       --no-fsync
           Disable <b><a href="../man2/fsync.2.html">fsync</a></b>(2) and <b><a href="../man2/fdatasync.2.html">fdatasync</a></b>(2).  See "--no-fsync" in <b><a href="../man1/public-inbox-index.1.html">public-inbox-index</a></b>(1) for caveats.

           Available in public-inbox 1.6.0+.

       --sequential-shard
           Copy each shard sequentially, ignoring "--jobs".  This also affects indexing done at  the  end  of  a
           run.

       --batch-size=BYTES
       --max-size=BYTES
           See <b><a href="../man1/public-inbox-index.1.html">public-inbox-index</a></b>(1) for a description of these options.

           These  indexing  options indexing at the end of a run.  "public-inbox-xcpdb" may run in parallel with
           with <b><a href="../man1/public-inbox-index.1.html">public-inbox-index</a></b>(1), and "public-inbox-xcpdb" needs to reindex changes made to the old  Xapian
           DBs by <b><a href="../man1/public-inbox-index.1.html">public-inbox-index</a></b>(1) while it was running.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       PI_CONFIG
               The default config file, normally "<a href="file:~/.public-inbox/config">~/.public-inbox/config</a>".  See <b><a href="../man5/public-inbox-config.5.html">public-inbox-config</a></b>(5)

       XAPIAN_FLUSH_THRESHOLD
               The number of documents to update before committing changes to disk.  This environment is handled
               directly by Xapian, refer to Xapian API documentation for more details.

               Default: 10000

</pre><h4><b>UPGRADING</b></h4><pre>
       This  tool  is  intended  for  admins  upgrading  Xapian search databases used by public-inbox, NOT users
       upgrading public-inbox itself.

       In  particular,  it  DOES  NOT  upgrade  the  schema   used   by   the   PSGI   search   interface   (see
       <b><a href="../man1/public-inbox-index.1.html">public-inbox-index</a></b>(1)).

</pre><h4><b>LIMITATIONS</b></h4><pre>
       Do  not  use  <b><a href="../man1/public-inbox-purge.1.html">public-inbox-purge</a></b>(1)  or <b><a href="../man1/public-inbox-edit.1.html">public-inbox-edit</a></b>(1) while this is running; old (purged or edited
       data) may show up.

       Normal invocations <b><a href="../man1/public-inbox-index.1.html">public-inbox-index</a></b>(1) can safely run while this is running, too.  However,  reindexing
       via the "--reindex" in <b><a href="../man1/public-inbox-index.1.html">public-inbox-index</a></b>(1) switch will be a waste of computing resources.

</pre><h4><b>CONTACT</b></h4><pre>
       Feedback welcome via plain-text mail to &lt;<a href="mailto:meta@public-inbox.org">mailto:meta@public-inbox.org</a>&gt;

       The       mail       archives      are      hosted      at      &lt;https://public-inbox.org/meta/&gt;      and
       &lt;<a href="http://4uok3hntl7oi7b4uf4rtfwefqeexfzil2w6kgk2jn5z2f764irre7byd.onion/meta/">http://4uok3hntl7oi7b4uf4rtfwefqeexfzil2w6kgk2jn5z2f764irre7byd.onion/meta/</a>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2021 all contributors &lt;<a href="mailto:meta@public-inbox.org">mailto:meta@public-inbox.org</a>&gt;

       License: AGPL-3.0+ &lt;https://www.gnu.org/licenses/agpl-3.0.txt&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/copydatabase.1.html">copydatabase</a></b>(1), <b><a href="../man1/xapian-compact.1.html">xapian-compact</a></b>(1), <b><a href="../man1/public-inbox-index.1.html">public-inbox-index</a></b>(1)

public-inbox.git                                   1993-10-02                              <u><a href="../man1/PUBLIC-INBOX-XCPDB.1.html">PUBLIC-INBOX-XCPDB</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>