<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>r.solute.transport   -  Numerical  calculation  program  for  transient,  confined  and unconfined solute</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/grass-doc">grass-doc_8.4.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>r.solute.transport</b>   -  Numerical  calculation  program  for  transient,  confined  and unconfined solute
       transport in two dimensions

</pre><h4><b>KEYWORDS</b></h4><pre>
       raster, hydrology, solute transport

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>r.solute.transport</b>
       <b>r.solute.transport</b> <b>--help</b>
       <b>r.solute.transport</b> [-<b>fc</b>]  <b>c</b>=<u>name</u>  <b>phead</b>=<u>name</u>  <b>hc_x</b>=<u>name</u>  <b>hc_y</b>=<u>name</u>  <b>status</b>=<u>name</u>  <b>diff_x</b>=<u>name</u>  <b>diff_y</b>=<u>name</u>
       [<b>q</b>=<u>name</u>]    [<b>cin</b>=<u>name</u>]   <b>cs</b>=<u>name</u>  <b>rd</b>=<u>name</u> <b>nf</b>=<u>name</u> <b>top</b>=<u>name</u> <b>bottom</b>=<u>name</u> <b>output</b>=<u>name</u>  [<b>vx</b>=<u>name</u>]   [<b>vy</b>=<u>name</u>]
       <b>dtime</b>=<u>float</u>  [<b>maxit</b>=<u>integer</u>]   [<b>error</b>=<u>float</u>]   [<b>solver</b>=<u>name</u>]    [<b>relax</b>=<u>float</u>]    [<b>al</b>=<u>float</u>]    [<b>at</b>=<u>float</u>]
       [<b>loops</b>=<u>float</u>]   [<b>stab</b>=<u>string</u>]   [--<b>overwrite</b>]  [--<b>help</b>]  [--<b>verbose</b>]  [--<b>quiet</b>]  [--<b>ui</b>]

   <b>Flags:</b>
       <b>-f</b>
           Use a full filled quadratic linear equation system, default is a sparse linear equation system.

       <b>-c</b>
           Use the Courant-Friedrichs-Lewy criteria for time step calculation

       <b>--overwrite</b>
           Allow output files to overwrite existing files

       <b>--help</b>
           Print usage summary

       <b>--verbose</b>
           Verbose module output

       <b>--quiet</b>
           Quiet module output

       <b>--ui</b>
           Force launching GUI dialog

   <b>Parameters:</b>
       <b>c</b>=<u>name</u> <b>[required]</b>
           The initial concentration in [kg/m^3]

       <b>phead</b>=<u>name</u> <b>[required]</b>
           The piezometric head in [m]

       <b>hc_x</b>=<u>name</u> <b>[required]</b>
           The x-part of the hydraulic conductivity tensor in [m/s]

       <b>hc_y</b>=<u>name</u> <b>[required]</b>
           The y-part of the hydraulic conductivity tensor in [m/s]

       <b>status</b>=<u>name</u> <b>[required]</b>
           The  status  for  each  cell,  =  0 - inactive cell, 1 - active cell, 2 - dirichlet- and 3 - transfer
           boundary condition

       <b>diff_x</b>=<u>name</u> <b>[required]</b>
           The x-part of the diffusion tensor in [m^2/s]

       <b>diff_y</b>=<u>name</u> <b>[required]</b>
           The y-part of the diffusion tensor in [m^2/s]

       <b>q</b>=<u>name</u>
           Groundwater sources and sinks in [m^3/s]

       <b>cin</b>=<u>name</u>
           Concentration sources and sinks bounded to a water source or sink in [kg/s]

       <b>cs</b>=<u>name</u> <b>[required]</b>
           Concentration of inner sources and inner sinks in [kg/s] (i.e. a chemical reaction)

       <b>rd</b>=<u>name</u> <b>[required]</b>
           Retardation factor [-]

       <b>nf</b>=<u>name</u> <b>[required]</b>
           Effective porosity [-]

       <b>top</b>=<u>name</u> <b>[required]</b>
           Top surface of the aquifer in [m]

       <b>bottom</b>=<u>name</u> <b>[required]</b>
           Bottom surface of the aquifer in [m]

       <b>output</b>=<u>name</u> <b>[required]</b>
           The resulting concentration of the numerical solute transport calculation will  be  written  to  this
           map. [kg/m^3]

       <b>vx</b>=<u>name</u>
           Calculate and store the groundwater filter velocity vector part in x direction [m/s]

       <b>vy</b>=<u>name</u>
           Calculate and store the groundwater filter velocity vector part in y direction [m/s]

       <b>dtime</b>=<u>float</u> <b>[required]</b>
           The calculation time in seconds
           Default: <u>86400</u>

       <b>maxit</b>=<u>integer</u>
           Maximum number of iteration used to solve the linear equation system
           Default: <u>10000</u>

       <b>error</b>=<u>float</u>
           Error break criteria for iterative solver
           Default: <u>0.000001</u>

       <b>solver</b>=<u>name</u>
           The type of solver which should solve the linear equation system
           Options: <u>gauss,</u> <u>lu,</u> <u>jacobi,</u> <u>sor,</u> <u>bicgstab</u>
           Default: <u>bicgstab</u>

       <b>relax</b>=<u>float</u>
           The relaxation parameter used by the jacobi and sor solver for speedup or stabilizing
           Default: <u>1</u>

       <b>al</b>=<u>float</u>
           The longditudinal dispersivity length. [m]
           Default: <u>0.0</u>

       <b>at</b>=<u>float</u>
           The transversal dispersivity length. [m]
           Default: <u>0.0</u>

       <b>loops</b>=<u>float</u>
           Use this number of time loops if the CFL flag is off. The timestep will become dt/loops.
           Default: <u>1</u>

       <b>stab</b>=<u>string</u>
           Set the flow stabilizing scheme (full or exponential upwinding).
           Options: <u>full,</u> <u>exp</u>
           Default: <u>full</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  numerical  program  calculates  numerical  implicit  transient and steady state solute transport in
       porous media in the saturated zone of an aquifer. The computation is based on raster maps and the current
       region settings. All initial- and boundary-conditions must be provided as raster maps. The  unit  of  the
       coordinate reference system must be meters.

       This  module  is sensitive to mask settings. All cells which are outside the mask are ignored and handled
       as no flow boundaries.
       This module calculates the concentration of the solution and optional the velocity field,  based  on  the
       hydraulic  conductivity, the effective porosity and the initial piecometric heads.  The vector components
       can be visualized with paraview if they are exported with r.out.vtk.
       Use r.gwflow to compute the piezometric heights of the aquifer. The piezometric heights and the hydraulic
       conductivity are used to compute the flow direction and the mean velocity of the  groundwater.   This  is
       the base of the solute transport computation.
       The  solute  transport will always be calculated transient.  For stady state computation set the timestep
       to a large number (billions of seconds).
       To reduce the numerical dispersion, which is a consequence of the convection term and the  finite  volume
       discretization, you can use small time steps and choose between full and exponential upwinding.

</pre><h4><b>NOTES</b></h4><pre>
       The  solute  transport calculation is based on a diffusion/convection partial differential equation and a
       numerical implicit finite volume discretization. Specific for this kind of differential equation  is  the
       combination  of  a  diffusion/dispersion  term  and  a convection term.  The discretization results in an
       unsymmetric linear equation system in form of <u>Ax</u> <u>=</u> <u>b</u>, which must be solved. The solute transport  partial
       differential equation is of the following form:

       (dc/dt)*R = div ( D grad c - uc) + cs -q/nf(c - c_in)

           •   c -- the concentration [kg/m^3]

           •   u -- vector of mean groundwater flow velocity

           •   dt -- the time step for transient calculation in seconds [s]

           •   R -- the linear retardation coefficient [-]

           •   D -- the diffusion and dispersion tensor [m^2/s]

           •   cs -- inner concentration sources/sinks [kg/m^3]

           •   c_in -- the solute concentration of influent water [kg/m^3]

           •   q -- inner well sources/sinks [m^3/s]

           •   nf -- the effective porosity [-]
       Three  different boundary conditions are implemented, the Dirichlet, Transmission and Neumann conditions.
       The calculation and boundary status of single cells can be set with the status map.  The following states
       are supported:

           •   0 == inactive - the cell with status 0 will not be calculated, active cells will have a  no  flow
               boundary to an inactive cell

           •   1  ==  active  - this cell is used for sloute transport calculation, inner sources can be defined
               for those cells

           •   2 == Dirichlet - cells of this type will have a fixed concentration value  which  do  not  change
               over time

           •   3 == Transmission - cells of this type should be placed on out-flow boundaries to assure the flow
               of the solute stream out
       Note  that  all  required  raster maps are read into main memory. Additionally the linear equation system
       will be allocated, so the memory consumption of this module rapidely grow with  the  size  of  the  input
       maps.
       The  resulting  linear  equation  system  <u>Ax</u>  <u>=</u>  <u>b</u> can be solved with several solvers.  Several iterative
       solvers with unsymmetric sparse and quadratic matrices support are implemented.  The jacobi  method,  the
       Gauss-Seidel  method  and  the biconjugate gradients-stabilized (bicgstab) method.  Additionally a direct
       Gauss solver and LU solver are available. Those direct solvers only work with quadratic matrices,  so  be
       careful  using  them with large maps (maps of size 10.000 cells will need more than one gigabyte of ram).
       Always prefer a sparse matrix solver.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Use this small python script to create a working groundwater flow / solute transport area and data.  Make
       sure you are not in a lat/lon projection.
       #!<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?env">/usr/bin/env</a> python3
       # This is an example script how groundwater flow and solute transport are
       # computed within GRASS GIS
       import sys
       import os
       import grass.script as gs
       # Overwrite existing maps
       gs.run_command("g.gisenv", set="OVERWRITE=1")
       gs.message(_("Set the region"))
       # The area is 200m x 100m with a cell size of 1m x 1m
       gs.run_command("g.region", res=1, res3=1, t=10, b=0, n=100, s=0, w=0, e=200)
       gs.run_command("r.mapcalc", expression="phead = if(col() == 1 , 50, 40)")
       gs.run_command("r.mapcalc", expression="phead = if(col() ==200  , 45 + row()/40, phead)")
       gs.run_command("r.mapcalc", expression="status = if(col() == 1 || col() == 200 , 2, 1)")
       gs.run_command("r.mapcalc", expression="well = if((row() == 50 &amp;&amp; col() == 175) || (row() == 10 &amp;&amp; col() == 135) , -0.001, 0)")
       gs.run_command("r.mapcalc", expression="hydcond = 0.00005")
       gs.run_command("r.mapcalc", expression="recharge = 0")
       gs.run_command("r.mapcalc", expression="top_conf = 20")
       gs.run_command("r.mapcalc", expression="bottom = 0")
       gs.run_command("r.mapcalc", expression="poros = 0.17")
       gs.run_command("r.mapcalc", expression="syield = 0.0001")
       gs.run_command("r.mapcalc", expression="null = 0.0")
       gs.message(_("Compute a steady state groundwater flow"))
       gs.run_command("r.gwflow", solver="cg", top="top_conf", bottom="bottom", phead="phead",\
         status="status", hc_x="hydcond", hc_y="hydcond", q="well", s="syield",\
         recharge="recharge", output="gwresult_conf", dt=8640000000000, type="confined")
       gs.message(_("generate the transport data"))
       gs.run_command("r.mapcalc", expression="c = if(col() == 15 &amp;&amp; row() == 75 , 500.0, 0.0)")
       gs.run_command("r.mapcalc", expression="cs = if(col() == 15 &amp;&amp; row() == 75 , 0.0, 0.0)")
       gs.run_command("r.mapcalc", expression="tstatus = if(col() == 1 || col() == 200 , 3, 1)")
       gs.run_command("r.mapcalc", expression="diff = 0.0000001")
       gs.run_command("r.mapcalc", expression="R = 1.0")
       # Compute the initial state
       gs.run_command("r.solute.transport", solver="bicgstab", top="top_conf",\
         bottom="bottom", phead="gwresult_conf", status="tstatus", hc_x="hydcond", hc_y="hydcond",\
         rd="R", cs="cs", q="well", nf="poros", output="stresult_conf_0", dt=3600, diff_x="diff",\
         diff_y="diff", c="c", al=0.1, at=0.01)
       # Compute the solute transport for 300 days in 10 day steps
       for dt in <a href="../man30/range.30.html">range</a>(30):
           gs.run_command("r.solute.transport", solver="bicgstab", top="top_conf",\
           bottom="bottom", phead="gwresult_conf", status="tstatus", hc_x="hydcond", hc_y="hydcond",\
           rd="R", cs="cs", q="well", nf="poros", output="stresult_conf_" + str(dt + 1), dt=864000, diff_x="diff",\
           diff_y="diff", c="stresult_conf_" + str(dt), al=0.1, at=0.01)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>r.gwflow</u>
       <u>r3.gwflow</u>
       <u>r.out.vtk</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       Sören Gebbert

       This work is based on the Diploma Thesis of Sören Gebbert available here at Technical  University  Berlin
       in Germany.

</pre><h4><b>SOURCE</b> <b>CODE</b></h4><pre>
       Available at: r.solute.transport source code (history)

       Accessed: Friday Apr 04 01:19:32 2025

       Main index | Raster index | Topics index | Keywords index | Graphical index | Full index

       © 2003-2025 GRASS Development Team, GRASS GIS 8.4.1 Reference Manual

GRASS 8.4.1                                                                           <u><a href="../man1grass/r.solute.transport.1grass.html">r.solute.transport</a></u>(1grass)
</pre>
 </div>
</div></section>
</div>
</body>
</html>