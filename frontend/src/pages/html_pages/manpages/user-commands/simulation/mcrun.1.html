<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mcrun - Running mcstas simulations from the command-line</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/mcstas-mcrun">mcstas-mcrun_3.5+3.5.19+ds5-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>mcrun</b> - Running mcstas simulations from the command-line

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>mcrun</b>   [-cpnN]  <u>INSTR</u>  [-sndftgahi]  params={val|min,max|min,guess,max}...   [-hB][-c  CMD][-f  FROM][-n
       NAME][-o DIR][-s SCRIPT]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>mcrun</b> front-end provides a convenient command-line interface for running simulations  with  the  same
       automatic  compilation  features.   It also provides a facility for running a series of simulations while
       varying an input parameter, as well as a multiparameter non-linear optimisation.  The command  mcrun  sim
       args  ...  will compile the instrument definition INSTR e.g.  sim.instr (if necessary) into an executable
       simulation sim.out.  It will then run sim.out, passing the argument list args usually given as  a  series
       of param=value pairs.  The -h option will list valid options.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>–version</b>
              show program’s version number and exit

       <b>-h,</b> <b>–help</b>
              show this help message and exit

       <b>-c,</b> <b>–force-compile</b>
              force  rebuilding of instrument.  This may be needed in case any component definitions are changed
              (in which case mcrun does not automatically recompile), or if a new version  of  mcstas  has  been
              installed.

       <b>-I</b> <b>I</b>   Append path <u>I</u> to McCode search path (implies -c)

       <b>–D1=D1</b> Set extra -D args (implies -c)

       <b>–D2=D2</b> Set extra -D args (implies -c)

       <b>–D3=D3</b> Set extra -D args (implies -c)

       <b>-p</b> <b>FILE,</b> <b>–param=FILE</b>
              Read  parameters  from file FILE The file should consist of specifications of the form name =value
              separated by spaces or line breaks.  Multiple  -p  options  may  be  given  together  with  direct
              parameter  specifications  on  the command line.  If a parameter is assigned multiple times, later
              assignments override previous ones.

       <b>-N</b> <b>NP,</b> <b>–numpoints=NP</b>
              Set number of scan points, varying one or more parameters  within  specified  intervals.   Such  a
              series  of  simulations  is called a scan.  To specify an interval for a parameter X, it should be
              assigned two values separated by a comma.  For example, the command <u>mcrun</u> <u>sim.instr</u> <u>-N4</u> <u>X=2,8</u>  <u>Y=1</u>
              would run the simulation defined in sim.instr four times, with X having the values 2, 4, 6, and 8,
              respectively.  After running the simulation, the results will be written to the file mccode.dat by
              default.   This  file  contains  one line for each simulation run giving the values of the scanned
              input variables along with the integrated intensity and estimated error in all monitors

       <b>-L,</b> <b>–list</b>
              Use a fixed list of points for linear scanning

       <b>-M,</b> <b>–multi</b>
              Run a multi-dimensional scan

       <b>–autoplot</b>
              Open plotter on generated dataset

       <b>–autoplotter=AUTOPLOTTER</b>
              Specify the plotter used with –autoplot

       <b>–embed</b> Store copy of instrument file in output directory

       <b>–mpi=NB_CPU</b>
              Spread simulation over NB_CPU machines using MPI

       <b>–openacc</b>
              parallelize using openacc

       <b>–funnel</b>
              funneling simulation flow, e.g. for mixed CPU/GPU

       <b>–machines=machines</b>
              Defines path of MPI machinefile to use in parallel mode

       <b>–optimise-file=FILE</b>
              Store scan results in FILE (defaults to: “mccode.dat”)

       <b>–no-cflags</b>
              Disable optimising compiler flags for faster compilation

       <b>–no-main</b>
              Do not generate a main(), e.g. for use with mcstas2vitess.pl.  Implies -c

       <b>–verbose</b>
              Enable verbose output

       <b>–write-user-config</b>
              Generate a user config file

       <b>–override-config=PATH</b>
              Load config file from specific dir

       <b>–optimize</b>
              Optimize instrument variable parameters to maximize monitors

       <b>–optimize-maxiter=optimize_maxiter</b>
              Maximum number of optimization iterations to perform

       <b>–optimize-tol=optimize_tol</b>
              Tolerance for optimization termination.  When optimizetol is specified, the selected  optimization
              algorithm sets some rele‐ vant solver-specific tolerance(s) equal to optimize-tol

       <b>–optimize-method=optimize_method</b>
              Optimization  solver  in  ['powell',  'nelder-mead', 'cg', 'bfgs', 'newton-cg', 'l-bfgs-b', 'tnc',
              'cobyla',  'slsqp',  'trust-con‐ str', 'dogleg', 'trust-ncg', 'trust-exact', 'trust-krylov']  (de‐
              fault:  powell)  You  can  use  your  custom  method method(fun,  x0, args,  **kwargs, **options).
              Please refer to scipy documentation for proper use of it: <u>https://docs.scipy</u> <u>.org/doc/scipy/refer‐</u>
              <u>ence/generated/scipy.optimize.mini</u> <u>mize.html?highlight=minimize</u>

       <b>–optimize-minimize</b>
              Choose to minimize the monitors instead of maximize

       <b>–optimize-monitor=optimize_monitor</b>
              Name of a single monitor to optimize (default is to use all)

       <b>–showcfg=ITEM</b>
              Print selected cfg item and exit  (paths  are  resolved  and  abso‐  lute).   Allowed  values  are
              “bindir”, “libdir”, “resourcedir”, and “tooldir”.

   <b>INSTRUMENT</b> <b>OPTIONS</b>
       <b>-s</b> <b>SEED,</b> <b>–seed=SEED</b>
              Set random seed (must be: SEED != 0)

       <b>-n</b> <b>COUNT,</b> <b>–ncount=COUNT</b>
              Set number of neutron to simulate

       <b>-t</b> <b>trace,</b> <b>–trace=trace</b>
              Enable trace of neutron through instrument

       <b>-d</b> <b>DIR,</b> <b>–dir=DIR</b>
              Put  all  data files in directory DIR.  Additionally, the directory will have subdirectories 1, 2,
              3,.  .  .  containing all data files output from the different simulations.

       <b>–format=FORMAT</b>
              Output data files using format FORMAT, usually McCode or NeXus (format list obtained from .out -h)

       <b>–bufsiz=BUFSIZ</b>
              Monitor_nD list/buffer-size (defaults to 1000000)

       <b>–vecsize=VECSIZE</b>
              vector length in OpenACC parallel scenarios

       <b>–numgangs=NUMGANGS</b>
              number of `gangs' in OpenACC parallel scenarios

       <b>–gpu_innerloop=INNERLOOP</b>
              Maximum particles in an OpenACC kernel run.  (If INNERLOOP is smaller than ncount we repeat)

       <b>–no-output-files</b>
              Do not write any data files

       <b>-i,</b> <b>–info</b>
              Detailed instrument information

       <b>–list-parameters</b>
              Print the instrument parameters to standard out

       <b>–meta-list</b>
              Print all metadata defining component names

       <b>–meta-defined=META_DEFINED</b>
              Print metadata names for component, or indicate if component:name exists.

       <b>–meta-type=META_TYPE</b>
              Print metadata type for component:name

       <b>–meta-data=META_DATA</b>
              Print metadata for component:name

</pre><h4><b>FILES</b></h4><pre>
       /usr/share/mcstas/resources                   /usr/share/mcstas/tools/Python/mccodelib/mccode_config.json
       <a href="file:~/.mcstas/mccode_config.json">~/.mcstas/mccode_config.json</a> <a href="http://www.mcstas.org">http://www.mcstas.org</a>

</pre><h4><b>EXAMPLES</b></h4><pre>
       Run the <u>Test_SX</u> example (Single crystal diffraction)

       • mcrun Test_SX.instr -d output_dir -n 1e7 TTH=13.4

</pre><h4><b>AUTHORS</b></h4><pre>
       mcstas Team (mcstas.org)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/mcstas.1.html">mcstas</a>(1), <a href="../man1/mcdoc.1.html">mcdoc</a>(1), <a href="../man1/mcplot.1.html">mcplot</a>(1), <a href="../man1/mcrun.1.html">mcrun</a>(1), <a href="../man1/mcgui.1.html">mcgui</a>(1), <a href="../man1/mcdisplay.1.html">mcdisplay</a>(1)

</pre><h4><b>AUTHORS</b></h4><pre>
       MCSTAS neutron Ray Tracing Team.

                                                       git                                              <u><a href="../man1/mcRUN.1.html">mcRUN</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>