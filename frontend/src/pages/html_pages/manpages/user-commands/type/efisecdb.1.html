<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>efisecdb - utility for managing UEFI signature lists</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/efivar">efivar_38-3.1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>efisecdb</b> - utility for managing UEFI signature lists

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>efisecdb</b> [<b>-s</b> <u>SORT</u>] [<b>-i</b> <u>file</u> [<b>-i</b> <u>file</u>] ...]
                [<b>-g</b> <u>guid</u> ⟨<b>-a</b> | <b>-r</b>⟩ ⟨[<b>-t</b> <u>hash-type</u>] <b>-h</b> <u>hash</u> | <b>-c</b> <u>file</u>⟩
                [<b>-g</b> <u>guid</u> ⟨<b>-a</b> | <b>-r</b>⟩ ⟨[<b>-t</b> <u>hash-type</u>] <b>-h</b> <u>hash</u> | <b>-c</b> <u>file</u>⟩] ...]  ⟨<b>-d</b> [<b>-A</b>] | <b>-o</b> <u>file</u> | <b>-L</b>⟩

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>efisecdb</b> is a command line utility for management of UEFI signature lists in detached files. That is,
       it's for command line generation and management of files in the format of KEK, DB, and DBX.

       Operation occurs in three phases:
       1.   Loading of security databases specified with <b>--input</b>
       2.   Left-to-right  processing  of other options, using <b>--hash-type,</b> <b>--owner-guid,</b> <b>--add,</b> and <b>--remove</b> as
            state to build selectors  to  add  or  remove  hashes  and  certificates  specified  by  <b>--hash</b>  and
            <b>--certificate</b>.
       3.   Generation of output
       The  accumulated  state  is  persistent;  once  an  Owner GUID, Add or Delete operation, or hash type are
       specified, they need only be present again to change the operations that follow.  Operations are added to
       the list to process when <b>-h</b> <u>hash</u> or <b>-c</b> <u>cert</u> are specified, and are processed in the  order  they  appear.
       Additionally,  at  least one <b>-g</b> argument and either <b>--add</b> or <b>--remove</b> must appear before the first use of
       <b>-h</b> <u>hash</u> or <b>-c</b> <u>cert</u>.

</pre><h4><b>OPTIONS</b></h4><pre>
       ⟨<b>-s</b> | <b>--sort</b>⟩ ⟨<u>all</u> | <u>data</u> | <u>none</u> | <u>type</u>⟩
         Sort by data after sorting and grouping entry types, entry data, no sorting, or by entry type

       ⟨<b>-s</b> | <b>--sort</b>⟩ ⟨<u>ascending</u> | <u>descending</u>⟩
         Sort in ascending or descending order

       <b>-i</b> <u>file</u> | <b>--infile</b> <u>file</u>
         Read EFI Security Database from <u>file</u>

       <b>-g</b> <u>guid</u> | <b>--owner-guid</b> <u>guid</u>
         Use the specified GUID or symbolic  refrence  (i.e.  {empty})  for  forthcoming  addition  and  removal
         operations

       <b>-a</b> | <b>--add</b> | <b>-r</b> | <b>--remove</b>
         Select <u>add</u> or <u>remove</u> for forthcoming operations

       <b>-t</b> <u>hash-type</u> | <b>--hash-type</b> <u>hash-type</u>
         Select <u>hash-type</u> for forthcoming addition and removal operations (default <u>sha256</u>)

         Use hash-type <u>help</u> to list supported hash types.

       <b>-h</b> <u>hash</u> | <b>--hash</b> <u>hash</u>
         Add or remove the specified hash

       <b>-c</b> <u>file</u> | <b>--certificate</b> <u>file</u>
         Add or remove the specified certificate

       <b>-d</b> | <b>--dump</b>
         Produce a hex dump of the output

       <b>-A</b> | <b>--annotate</b>
         Annotate the hex dump produced by <b>--dump</b>

       <b>-o</b> <u>file</u> | <b>--outfile</b> <u>file</u>
         Write EFI Security Database to <u>file</u>

       <b>-L</b> | <b>--list-guids</b>
         List the well known guids

         The output is tab delimited: GUID short_name desription

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Dumping</b> <b>the</b> <b>current</b> <b>system's</b> <u><b>DBX</b></u> <b>database</b> <b>with</b> <b>annotations</b>
       host:~$ <b>efisecdb</b> <b>-d</b> <b>-A</b> <b>-i</b> <b>/sys/firmware/efi/efivars/dbx-d719b2cb-3d3a-4596-a3bc-dad00e67656f</b>
       00000000  26 16 c4 c1 4c 50 92 40  ac a9 41 f9 36 93 43 28  |&amp;...LP.@..A.6.C(|  esl[0].signature_type = {sha256}
       00000010  60 00 00 00                                       |....|              esl[0].signature_list_size = 96
       00000014              00 00 00 00                               |....|          esl[0].signature_header_size = 0
       00000018                           30 00 00 00                      |0...|      esl[0].signature_size = 48
       0000001c                                                                        esl[0].signature_header (end:0x0000001c)
       0000001c                                       bd 9a fa 77              |...w|  esl[0].signature[0].owner = {microsoft}
       00000020  59 03 32 4d bd 60 28 f4  e7 8f 78 4b              |Y.2M.`(...xK|
       0000002c                                       fe cf b2 32              |...2|  esl[0].signature[0].data (end:0x0000004c)
       00000030  d1 2e 99 4b 6d 48 5d 2c  71 67 72 8a a5 52 59 84  |...KmH],qgr..RY.|
       00000040  ad 5c a6 1e 75 16 22 1f  07 9a 14 36              |...u."....6|
       0000004c                                       bd 9a fa 77              |...w|  esl[0].signature[1].owner = {microsoft}
       00000050  59 03 32 4d bd 60 28 f4  e7 8f 78 4b              |Y.2M.`(...xK|
       0000005c                                       fe 63 a8 4f              |.c.O|  esl[0].signature[1].data (end:0x0000007c)
       00000060  78 2c c9 d3 fc f2 cc f9  fc 11 fb d0 37 60 87 87  |x,..........7`..|
       00000070  58 d2 62 85 ed 12 66 9b  dc 6e 6d 01              |X.b...f..nm.|
       0000007c

   <b>Building</b> <b>a</b> <b>new</b> <b>EFI</b> <b>Security</b> <b>Database</b> <b>for</b> <b>use</b> <b>as</b> <u><b>KEK</b></u><b>,</b> <b>replacing</b> <b>one</b> <b>certificate.</b>
       # Figure out the original cert... the easy way
       host:~$ <b>strings</b> <b>KEK-*</b> <b>|</b> <b>grep</b> <b>microsoft.*crt</b>
       D<a href="http://www.microsoft.com/pki/certs/MicCorThiParMarRoo_2010-10-05.crt0">http://www.microsoft.com/pki/certs/MicCorThiParMarRoo_2010-10-05.crt0</a>

       # Find it, because --export isn't implemented yet
       host:~$ <b>wget</b> <b>\</b>
               <b>--user-agent='Mozilla/5.0</b> <b>(Windows</b> <b>NT</b> <b>10.0;</b> <b>WOW64;</b> <b>Trident/7.0;</b> <b>rv:11.0)</b> <b>like</b> <b>Gecko'</b> <b>\</b>
               <b><a href="http://www.microsoft.com/pki/certs/MicCorThiParMarRoo_2010-10-05.crt">http://www.microsoft.com/pki/certs/MicCorThiParMarRoo_2010-10-05.crt</a></b>
       --2020-06-04 20:41:27--  <a href="http://www.microsoft.com/pki/certs/MicCorThiParMarRoo_2010-10-05.crt">http://www.microsoft.com/pki/certs/MicCorThiParMarRoo_2010-10-05.crt</a>
       Resolving www.microsoft.com (www.microsoft.com)... 2600:141b:800:287::356e, 2600:141b:800:2a0::356e, 23.43.254.254
       Connecting to www.microsoft.com (www.microsoft.com)|2600:141b:800:287::356e|:80... connected.
       HTTP request sent, awaiting response... 200 OK
       Length: 1539 (1.5K) [application/octet-stream]
       Saving to: ‘MicCorThiParMarRoo_2010-10-05.crt’

       MicCorThiParMarRoo_ 100%[===================&gt;]   1.50K  --.-KB/s    in 0s

       2020-06-04 20:41:27 (177 MB/s) - ‘MicCorThiParMarRoo_2010-10-05.crt’ saved [1539/1539]

       # Pick a GUID-like object, any GUID-like object...
       host:~$ <b>uuidgen</b>
       aab3960c-501e-485e-ac59-62805970a3dd

       # Remove the old KEK entry and add a different one
       host:~$ <b>efisecdb</b> <b>-i</b> <b>KEK-8be4df61-93ca-11d2-aa0d-00e098032b8c</b> <b>\</b>
               <b>-g</b> <b>{microsoft}</b> <b>-r</b> <b>-c</b> <b>MicCorThiParMarRoo_2010-10-05.crt</b> <b>\</b>
               <b>-g</b> <b>aab3960c-501e-485e-ac59-62805970a3dd</b> <b>-a</b> <b>-c</b> <b>pjkek.cer</b> <b>\</b>
               <b>-o</b> <b>newkek.bin</b>

   <b>Searching</b>
       <b>the</b> <b>list</b> <b>of</b> <b>well-known</b> <b>GUIDs</b>
       host:~$ <b>efisecdb</b> <b>-L</b> <b>|</b> <b>grep</b> <b>shim</b>
       {605dab50-e046-4300-abb6-3dd810dd8b23}  {shim}    shim

</pre><h4><b>STANDARDS</b></h4><pre>

       UEFI Specification Working Group, <u>Unified</u> <u>Extensible</u> <u>Firmware</u> <u>Interface</u> <u>(UEFI)</u> <u>Specification</u> <u>Version</u> <u>2.8</u>,
       <u>Unified</u> <u>Extensible</u> <u>Firmware</u> <u>Interface</u> <u>Forum</u>, https://uefi.org/specifications , March 2019.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/authvar.1.html">authvar</a>(1), <a href="../man1/efikeygen.1.html">efikeygen</a>(1), <a href="../man1/pesign.1.html">pesign</a>(1)

</pre><h4><b>AUTHORS</b></h4><pre>
       Peter Jones

</pre><h4><b>BUGS</b></h4><pre>
       <b>efisecdb</b> is currently lacking several useful features:
       <b>•</b>   positional exporting of certificates
       <b>•</b>   <b>--dump</b> and <b>--annotate</b> do not adjust the output width for the terminal
       <b>•</b>   certificates can't be specified for removal by their <u>ToBeSigned</u> hash

                                                 January 7, 2021                                     <u><a href="../man1/EFISECDB.1.html">EFISECDB</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>