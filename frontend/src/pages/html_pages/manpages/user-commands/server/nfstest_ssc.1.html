<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nfstest_ssc - Server side copy tests</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nfstest">nfstest_3.2-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nfstest_ssc - Server side copy tests

</pre><h4><b>SYNOPSIS</b></h4><pre>
       nfstest_ssc --server &lt;server&gt; [options]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Verify correct functionality of server side copy

       Copying  a  file  via NFS the client reads the data from the source file and then writes the same data to
       the destination file which is located in the same server or it could be located in  a  different  server.
       Either  way the file data is transferred twice, once for reading and the second for writing.  Server side
       copy allows unnecessary network traffic to be eliminated.  The intra-server copy  allows  the  client  to
       request  the  server to perform the copy internally thus avoiding any data being sent through the network
       at all. In the case for the inter-server copy where the destination server is different from  the  source
       server, the client authorizes both servers to interact directly with one another.

       The  system  call  copy_file_range  is used to send both intra and inter server side copy requests to the
       correct server.

       Basic server side copy tests verify the actual file range from the source file(s) are copied correctly to
       the destination file(s). Most tests deal with a single source and destination file  while  verifying  the
       data is copied correctly. Also it verifies the data is copied starting from the correct source offset and
       it  is  copied  to  the  correct  offset  on the destination file.  Other tests deal with multiple files:
       copying multiple source files to a single destination file, a single source file to multiple  destination
       files, or N number of source files to M number of destination files.

       Some  tests  include  testing  at  the  protocol level by taking a packet trace and inspecting the actual
       packets sent to the server or servers. For the intra-server side copy, these tests verify the  COPY/CLONE
       operation  is  sent  to  the  server  with correct arguments. For the inter-server side copy, these tests
       verify the COPY_NOTIFY operation is sent to the source server with correct  arguments  to  authorize  the
       source  server  to allow the destination server to copy the data directly; then the client sends the COPY
       operation to the destination server so it could initiate the actual copy.

       The server side copy could either be synchronous or asynchronous depending on both client and  server(s).
       The  client  could  issue  either a synchronous or asynchronous copy and the server could either copy the
       file data in either mode depending on implementation or other factors. In either case, the  tests  verify
       the  correct  functionality for both cases. The CB_OFFLOAD operation is used by the destination server to
       report the actual results of the copy when  it  is  done.  The  client  could  also  actively  query  the
       destination  server  for  status on a current asynchronous copy using the OFFLOAD_STATUS operation.  Also
       the client has a mechanism to cancel a given asynchronous copy using the OFFLOAD_CANCEL operation.

       Negative testing is included whenever possible since some testing cannot be done at  the  protocol  level
       because the copy_file_range system call does some error checking of its own and the NFS client won't even
       send a COPY_NOTIFY or COPY operation to the server letting the server deal with the error. Negative tests
       include  trying  to  copy  an  invalid source range, having an invalid value for either the offset or the
       length, trying to copy a region on a source file opened as write only, a destination file opened as  read
       only or the file is a non-regular file type.

</pre><h4><b>OPTIONS</b></h4><pre>
       --version
              show program's version number and exit

       -h, --help
              show this help message and exit

       -f FILE, --file=FILE
              File  where  options  are  specified  besides  the  system  wide file /etc/nfstest, user wide file
              $HOME/.nfstest or in the current directory .nfstest file

   <b>NFS</b> <b>specific</b> <b>options:</b>
       -s SERVER, --server=SERVER
              Server name or IP address

       -e EXPORT, --export=EXPORT
              Exported file system to mount [default: '/']

       --nfsversion=NFSVERSION
              NFS version, e.g., 3, 4, 4.1, etc. [default: 4.2]

       -m MTPOINT, --mtpoint=MTPOINT
              Mount point [default: '/mnt/t']

       -p PORT, --port=PORT
              NFS server port [default: 2049]

       --proto=PROTO
              NFS protocol name [default: 'tcp']

       --sec=SEC
              Security flavor [default: 'sys']

       --nconnect=NCONNECT
              Multiple TCP connections option [default: '1']

       -o MTOPTS, --mtopts=MTOPTS
              Mount options [default: 'hard,rsize=4096,wsize=4096']

       --datadir=DATADIR
              Data directory where files are created, directory is created on the mount point [default: '']

   <b>Logging</b> <b>options:</b>
       -v VERBOSE, --verbose=VERBOSE
              Verbose level for debug messages [default: 'opts|info|dbg1|dbg2|dbg3']

       --tverbose=TVERBOSE
              Verbose level for test messages [default: '1']

       --createlog
              Create log file

       --rexeclog
              Create rexec log files

       --warnings
              Display warnings

       --tag=TAG
              Informational tag, it is displayed as an INFO message [default: '']

       --notty
              Do not use terminal colors on output

       --isatty
              Use terminal colors on output -- useful when running with nohup

   <b>Packet</b> <b>trace</b> <b>options:</b>
       --createtraces
              Create a packet trace for each test

       --tbsize=TBSIZE
              Capture buffer size for tcpdump [default: 192k]

       --trcdelay=TRCDELAY
              Seconds to delay before stopping packet trace [default: 2.0]

       --keeptraces
              Do not remove any trace files [default: remove trace files if no errors]

       --rmtraces
              Remove trace files [default: remove trace files if no errors]

       -i INTERFACE, --interface=INTERFACE
              Device interface [default: automatically selected]

   <b>File</b> <b>options:</b>
       --nfiles=NFILES
              Number of files to create [default: 2]

       --filesize=FILESIZE
              File size to use for test files [default: 256k]

       --rsize=RSIZE
              Read size to use when reading files [default: 4k]

       --wsize=WSIZE
              Write size to use when writing files [default: 4k]

       --iodelay=IODELAY
              Seconds to delay I/O operations [default: 0.1]

       --offset-delta=OFFSET_DELTA
              Read/Write offset delta [default: 4k]

   <b>Path</b> <b>options:</b>
       --sudo=SUDO
              Full path of binary for sudo [default: '<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sudo">/usr/bin/sudo</a>']

       --kill=KILL
              Full path of binary for kill [default: '<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?kill">/usr/bin/kill</a>']

       --nfsstat=NFSSTAT
              Full path of binary for nfsstat [default: '/usr/sbin/nfsstat']

       --tcpdump=TCPDUMP
              Full path of binary for tcpdump [default: '/usr/sbin/tcpdump']

       --iptables=IPTABLES
              Full path of binary for iptables [default: '<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?iptables">/usr/sbin/iptables</a>']

       --messages=MESSAGES
              Full path of log messages file [default: '/var/log/messages']

       --trcevents=TRCEVENTS
              Full path of tracing events directory [default: '/sys/kernel/debug/tracing/events']

       --trcpipe=TRCPIPE
              Full path of trace pipe file [default: '/sys/kernel/debug/tracing/trace_pipe']

       --tmpdir=TMPDIR
              Temporary directory [default: '<a href="file:/tmp">/tmp</a>']

   <b>Debug</b> <b>options:</b>
       --nocleanup
              Do not cleanup created files

       --notimestamps
              Do not display timestamps in debug messages

       --bugmsgs=BUGMSGS
              File containing test messages to mark as bugs if they failed

       --nomount
              Do not mount server and run the tests on local disk space

       --basename=BASENAME
              Base name for all files and logs [default: automatically generated]

       --nfsdebug=NFSDEBUG
              Set NFS kernel debug flags and save log messages [default: '']

       --rpcdebug=RPCDEBUG
              Set RPC kernel debug flags and save log messages [default: '']

       --tracepoints=TRACEPOINTS
              List of trace points modules to enable [default: '']

       --nfsstats
              Get NFS stats [default: 'False']

       --pktdisp
              Display main packets related to the given test

       --nfserrors
              Fail every NFS error found in the packet trace

       --client-ipaddr=CLIENT_IPADDR
              IP address of localhost

   <b>Reporting</b> <b>options:</b>
       --xunit-report
              Generate xUnit compatible test report

       --xunit-report-file=XUNIT_REPORT_FILE
              Path to xout report file

   <b>Test</b> <b>options:</b>
       --runtest=RUNTEST
              Comma separated list of tests to run, if list starts with a '^' then all tests are run except  the
              ones listed [default: 'all']

       --dst-server=DST_SERVER
              Destination server for inter server side copy [default: none]

       --dst-export=DST_EXPORT
              Destination export for inter server side copy [default: none]

       --ncopies=NCOPIES
              Number of concurrent copies to use on intra14 and inter14 tests [default: 4]

       --src-files=SRC_FILES
              Number of source files to use concurrently on intra15 and inter15 tests [default: 3]

       --dst-files=DST_FILES
              Number of destination files to use concurrently on intra15 and inter15 tests [default: 2]

       --pre-write=PRE_WRITE
              Write destination file before copy_file_range [default: 1]

       --locks=LOCKS
              Lock files [default: 1]

</pre><h4><b>TESTS</b></h4><pre>
   <b>intra</b>
       Run all intra server side copy tests: intra01, intra02, intra03,
       intra04, intra05, intra06, intra07, intra08, intra09, intra10, intra11,
       intra12, intra13, intra14, intra15

   <b>pintra</b>
       Run all positive intra server side copy tests: intra01, intra02,
       intra03, intra04, intra05, intra06, intra07, intra08, intra14, intra15

   <b>nintra</b>
       Run all negative intra server side copy tests: intra09, intra10,
       intra11, intra12, intra13

   <b>intra01</b>
       Verify intra server side COPY succeeds

   <b>intra02</b>
       Verify intra server side COPY succeeds when using source offset

   <b>intra03</b>
       Verify intra server side COPY succeeds when using destination offset

   <b>intra04</b>
       Verify intra server side COPY succeeds when using NULL as source offset

   <b>intra05</b>
       Verify intra server side COPY succeeds when using NULL as destination
       offset

   <b>intra06</b>
       Verify intra server side COPY succeeds when using count = 0

   <b>intra07</b>
       Verify intra server side COPY succeeds when the source file is opened
       as read/write

   <b>intra08</b>
       Verify intra server side COPY succeeds when the destination file is
       opened as read/write

   <b>intra09</b>
       Verify intra server side COPY fails when the source file is opened
       as write only

   <b>intra10</b>
       Verify intra server side COPY fails when the destination file is opened
       as read only

   <b>intra11</b>
       Verify intra server side COPY succeeds when source offset is beyond the
       end of the file

   <b>intra12</b>
       Verify intra server side COPY succeeds when source offset plus count
       is beyond the end of the file

   <b>intra13</b>
       Verify intra server side COPY may fail when both source and destination
       files point to the same file

   <b>intra14</b>
       Verify intra server side COPY succeeds when using multiple source and
       destination offsets

   <b>intra15</b>
       Verify intra server side COPY succeeds when using multiple source and
       destination files

   <b>inter</b>
       Run all inter server side copy tests: inter01, inter02, inter03,
       inter04, inter05, inter06, inter07, inter08, inter09, inter10, inter11,
       inter12, inter13, inter14, inter15

   <b>pinter</b>
       Run all positive inter server side copy tests: inter01, inter02,
       inter03, inter04, inter05, inter06, inter07, inter08, inter13, inter14,
       inter15

   <b>ninter</b>
       Run all negative inter server side copy tests: inter09, inter10,
       inter11, inter12

   <b>inter01</b>
       Verify inter server side COPY succeeds

   <b>inter02</b>
       Verify inter server side COPY succeeds when using source offset

   <b>inter03</b>
       Verify inter server side COPY succeeds when using destination offset

   <b>inter04</b>
       Verify inter server side COPY succeeds when using NULL as source offset

   <b>inter05</b>
       Verify inter server side COPY succeeds when using NULL as destination
       offset

   <b>inter06</b>
       Verify inter server side COPY succeeds when using count = 0

   <b>inter07</b>
       Verify inter server side COPY succeeds when the source file is opened
       as read/write

   <b>inter08</b>
       Verify inter server side COPY succeeds when the destination file is
       opened as read/write

   <b>inter09</b>
       Verify inter server side COPY fails when the source file is opened
       as write only

   <b>inter10</b>
       Verify inter server side COPY fails when the destination file is opened
       as read only

   <b>inter11</b>
       Verify inter server side COPY succeeds when source offset is beyond the
       end of the file

   <b>inter12</b>
       Verify inter server side COPY succeeds when source offset plus count
       is beyond the end of the file

   <b>inter13</b>
       Verify inter server side COPY succeeds when both source and destination
       file names are the same

   <b>inter14</b>
       Verify inter server side COPY succeeds when using multiple source and
       destination offsets

   <b>inter15</b>
       Verify inter server side COPY succeeds when using multiple source and
       destination files

   <b>positive</b>
       Run all positive server side copy tests: intra01, intra02, intra03,
       intra04, intra05, intra06, intra07, intra08, intra14, intra15, inter01,
       inter02, inter03, inter04, inter05, inter06, inter07, inter08, inter13,
       inter14, inter15

   <b>negative</b>
       Run all negative server side copy tests: intra09, intra10, intra11,
       intra12, intra13, inter09, inter10, inter11, inter12

   <b>all</b>
       Run all tests: intra01, intra02, intra03, intra04, intra05, intra06,
       intra07, intra08, intra09, intra10, intra11, intra12, intra13, intra14,
       intra15, inter01, inter02, inter03, inter04, inter05, inter06, inter07,
       inter08, inter09, inter10, inter11, inter12, inter13, inter14, inter15

</pre><h4><b>EXAMPLES</b></h4><pre>
       The only required option is --server
       $ nfstest_ssc --server 192.168.0.11

</pre><h4><b>NOTES</b></h4><pre>
       The  user id in the local host and the host specified by --dst-server must have access to run commands as
       root using the 'sudo' command without the need for a password.

       The user id must be able to 'ssh' to remote host without the need for a password.

       Valid only for NFS version 4.2 and above.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/baseobj.3.html">baseobj</a>(3),</b>      <b><a href="../man3/formatstr.3.html">formatstr</a>(3),</b>      <b><a href="../man3/nfstest.test_util.3.html">nfstest.test_util</a>(3),</b>       <b><a href="../man1/nfstest_alloc.1.html">nfstest_alloc</a>(1),</b>       <b><a href="../man1/nfstest_cache.1.html">nfstest_cache</a>(1),</b>
       <b><a href="../man1/nfstest_delegation.1.html">nfstest_delegation</a>(1),</b>     <b><a href="../man1/nfstest_dio.1.html">nfstest_dio</a>(1),</b>    <b><a href="../man1/nfstest_fcmp.1.html">nfstest_fcmp</a>(1),</b>    <b><a href="../man1/nfstest_file.1.html">nfstest_file</a>(1),</b>    <b><a href="../man1/nfstest_interop.1.html">nfstest_interop</a>(1),</b>
       <b><a href="../man1/nfstest_io.1.html">nfstest_io</a>(1),</b>  <b><a href="../man1/nfstest_lock.1.html">nfstest_lock</a>(1),</b>  <b><a href="../man1/nfstest_pkt.1.html">nfstest_pkt</a>(1),</b>  <b><a href="../man1/nfstest_pnfs.1.html">nfstest_pnfs</a>(1),</b>  <b><a href="../man1/nfstest_posix.1.html">nfstest_posix</a>(1),</b>   <b><a href="../man1/nfstest_rdma.1.html">nfstest_rdma</a>(1),</b>
       <b><a href="../man1/nfstest_sparse.1.html">nfstest_sparse</a>(1),</b> <b><a href="../man1/nfstest_xattr.1.html">nfstest_xattr</a>(1),</b> <b><a href="../man1/nfstest_xid.1.html">nfstest_xid</a>(1),</b> <b><a href="../man3/packet.nfs.nfs3_const.3.html">packet.nfs.nfs3_const</a>(3),</b> <b><a href="../man3/packet.nfs.nfs4_const.3.html">packet.nfs.nfs4_const</a>(3)</b>

</pre><h4><b>BUGS</b></h4><pre>
       No known bugs.

</pre><h4><b>AUTHOR</b></h4><pre>
       Jorge Mora (<a href="mailto:mora@netapp.com">mora@netapp.com</a>)

NFStest 3.2                                       21 March 2023                                   <u><a href="../man1/NFSTEST_SSC.1.html">NFSTEST_SSC</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>