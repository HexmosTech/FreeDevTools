<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fs_storebehind - Enables asynchronous writes to the file server</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/openafs-client">openafs-client_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fs_storebehind - Enables asynchronous writes to the file server

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>fs</b> <b>storebehind</b> [<b>-kbytes</b> &lt;<u>asynchrony</u> <u>for</u> <u>specified</u> <u>names</u>&gt;]
           [<b>-files</b> &lt;<u>specific</u> <u>pathnames</u>&gt;+]
           [<b>-allfiles</b> &lt;<u>new</u> <u>default</u> <u>(KB)</u>&gt;] [<b>-verbose</b>] [<b>-help</b>]

       <b>fs</b> <b>st</b> [<b>-k</b> &lt;<u>asynchrony</u> <u>for</u> <u>specified</u> <u>names</u>&gt;]
           [<b>-f</b> &lt;<u>specific</u> <u>pathnames</u>&gt;+]
           [<b>-a</b> &lt;<u>new</u> <u>default</u> <u>(KB)</u>&gt;] [<b>-v</b>] [<b>-h</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>fs</b> <b>storebehind</b> command enables the Cache Manager to perform a delayed asynchronous write to the File
       Server when an application closes a file. By default, the Cache Manager writes all data to the File
       Server immediately and synchronously when an application program closes a file -- that is, the <b>close()</b>
       system call does not return until the Cache Manager has actually transferred the final chunk of the file
       to the File Server. This command specifies the number of kilobytes of a file that can still remain to be
       written to the File Server when the Cache Manager returns control to the application. It is useful if
       users working on the machine commonly work with very large files, but also introduces the complications
       discussed in the "CAUTIONS".

       Set either or both of the following in a single command:

       •   To  set a value that applies to all AFS files manipulated by applications running on the machine, use
           the <b>-allfiles</b> argument. This value is termed the  <u>default</u>  <u>store</u>  <u>asynchrony</u>  for  the  machine,  and
           persists  until the machine reboots. If it is not set, the default value is zero, indicating that the
           Cache Manager performs synchronous writes.

           As an example, the following setting means that when an application closes a file, the Cache  Manager
           can  return  control to the application as soon as no more than 10 kilobytes of the file remain to be
           written to the File Server.

              -allfiles 10

       •   To set a value that applies to one or more individual files, and overrides the value of the <b>-allfiles</b>
           argument for them, combine the <b>-kbytes</b> and <b>-files</b> arguments. The setting persists as long as there is
           an entry for the file in the kernel table that the Cache Manager uses to  track  certain  information
           about  files.  In  general,  such  an entry persists at least until an application closes the file or
           exits, but the Cache Manager is free to recycle the entry if the file is inactive  and  it  needs  to
           free  up  slots  in  the  table. To increase the certainty that there is an entry for the file in the
           table, issue the <b>fs</b> <b>storebehind</b> command shortly before closing the file.

           As an example, the following setting means that when  an  application  closes  either  of  the  files
           <b>bigfile</b>  and  <b>biggerfile</b>,  the Cache Manager can return control to the application as soon as no more
           than a megabyte of the file remains to be written to the File Server.

              -kbytes 1024 -files bigfile biggerfile

           Note that once an explicit value has been set for a file, the only way to  make  it  subject  to  the
           default  store  asynchrony  once  again  is to set <b>-kbytes</b> to that value. In other words, there is no
           combination of arguments that automatically makes a file subject to the default store asynchrony once
           another value has been set for the file.

       To display the settings that currently apply to individual files or to all files, provide  the  command's
       arguments in certain combinations as specified in "OUTPUT".

</pre><h4><b>CAUTIONS</b></h4><pre>
       For the following reasons, use of this command is not recommended in most cases.

       In  normal  circumstances,  an  asynchronous  setting  results  in the Cache Manager returning control to
       applications earlier than it otherwise does, but this is not guaranteed.

       If a delayed write fails, there is no way to notify the application, since the <b>close()</b>  system  call  has
       already returned with a code indicating success.

       Writing asynchronously increases the possibility that the user will not notice if a write operation makes
       the  volume  that  houses  the file exceed its quota. As always, the portion of the file that exceeds the
       volume's quota is lost, which prompts a message such as the following:

          No space left on device

       To avoid losing data, it is advisable to verify that the volume housing the file has space available  for
       the amount of data anticipated to be written.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-kbytes</b> &lt;<u>asynchrony</u> <u>for</u> <u>specified</u> <u>names</u>&gt;
           Specifies the number of kilobytes of data from each file named by the <b>-files</b> argument that can remain
           to  be  written  to  the file server when the Cache Manager returns control to an application program
           that closed the file. The <b>-files</b> argument is required along with this argument.  Provide  an  integer
           from  the range 0 (which reinstates the Cache Manager's default behavior or writing synchronously) to
           the maximum AFS file size.

       <b>-files</b> &lt;<u>specific</u> <u>pathnames</u>&gt;+
           Names each file to which the value set with the <b>-kbytes</b> argument applies.  The  setting  persists  as
           long  as  there  is  an  entry  for the file in the kernel table that the Cache Manager uses to track
           certain information about files. Because closing a file generally erases the entry, when reopening  a
           file  the  only  way  to  guarantee that the setting still applies is to reissue the command. If this
           argument is provided without the <b>-kbytes</b> argument, the command reports the current  setting  for  the
           specified files, and the default store asynchrony.

       <b>-allfiles</b> &lt;<u>new</u> <u>default</u> <u>(KB)</u>&gt;
           Sets  the  default  store  asynchrony for the local machine, which is the number of kilobytes of data
           that can remain to be written to the file server when  the  Cache  Manager  returns  control  to  the
           application  program  that  closed  a  file.  The  value  applies  to  all  AFS  files manipulated by
           applications running on the machine, except those for which settings have been made with the  <b>-kbytes</b>
           and <b>-files</b> arguments. Provide an integer from the range 0 (which indicates the default of synchronous
           writes) to the maximum AFS file size.

       <b>-verbose</b>
           Produces  output confirming the settings made with the accompanying <b>-kbytes</b> and <b>-files</b> arguments, the
           <b>-allfiles</b> argument, or  all  three.  If  provided  by  itself,  reports  the  current  default  store
           asynchrony.

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>OUTPUT</b></h4><pre>
       If  none  of  the command's options are included, or if only the <b>-verbose</b> flag is included, the following
       message reports the default store asynchrony (the setting  that  applies  to  all  files  manipulated  by
       applications running on the local machine and for which not more specific asynchrony is set).

          Default store asynchrony is &lt;x&gt; kbytes.

       A  value of 0 (zero) indicates synchronous writes and is the default if no one has included the <b>-allfiles</b>
       argument on this command since the machine last rebooted.

       If the <b>-files</b> argument is provided without the <b>-kbytes</b>  argument,  the  output  reports  the  value  that
       applies  to  each  specified  file  along  with  the  default store asynchrony. If a particular value has
       previously been set for a file, the following message reports it:

          Will store up to &lt;y&gt; kbytes of &lt;file&gt; asynchronously.
          Default store asynchrony is &lt;x&gt; kbytes.

       If the default store asynchrony applies to a file because no explicit <b>-kbytes</b> value has been set for  it,
       the message is instead as follows:

          Will store &lt;file&gt; according to default.
          Default store asynchrony is &lt;x&gt; kbytes.

       If the <b>-verbose</b> flag is combined with arguments that set values (<b>-files</b> and <b>-kbytes</b>, or <b>-allfiles</b>, or all
       three),  there  is  a  message that confirms immediately that the setting has taken effect. When included
       without other arguments or flags, the <b>-verbose</b> flag reports the default store asynchrony only.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following command enables the Cache Manager to return control to the application program that  closed
       the  file  <u>test.data</u>  when 100 kilobytes still remain to be written to the File Server. The <b>-verbose</b> flag
       produces output that confirms the new setting, and that the default store asynchrony is zero.

          % fs storebehind -kbytes 100 -files test.data -verbose
          Will store up to 100 kbytes of test.data asynchronously.
          Default store asynchrony is 0 kbytes.

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       To include the <b>-allfiles</b> argument, the issuer must be logged in as the local superuser "root".

       To include the <b>-kbytes</b> and <b>-files</b> arguments, the issuer must either be logged in as the  local  superuser
       "root" or have the "w" (write) permission on the ACL of each file's directory.

       To  view  the  current  settings  (by  including  no arguments, the <b>-file</b> argument alone, or the <b>-verbose</b>
       argument alone), no privilege is required.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/afsd.8.html">afsd</a></b>(8)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       IBM Corporation 2000. &lt;<a href="http://www.ibm.com/">http://www.ibm.com/</a>&gt; All Rights Reserved.

       This documentation is covered by the IBM Public License Version 1.0.  It was converted from HTML  to  POD
       by  software  written  by  Chas  Williams  and Russ Allbery, based on work by Alf Wachsmann and Elizabeth
       Cassell.

OpenAFS                                            2025-03-21                                  <u><a href="../man1/FS_STOREBEHIND.1.html">FS_STOREBEHIND</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>