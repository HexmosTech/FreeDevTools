<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gpg-wks-server - Server providing the Web Key Service</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/gpg-wks-server">gpg-wks-server_2.4.4-2ubuntu23.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>gpg-wks-server</b> - Server providing the Web Key Service

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>gpg-wks-server</b> [<u>options</u>] <b>--receive</b>
       <b>gpg-wks-server</b> [<u>options</u>] <b>--cron</b>
       <b>gpg-wks-server</b> [<u>options</u>] <b>--list-domains</b>
       <b>gpg-wks-server</b> [<u>options</u>] <b>--check-key</b> <u>user-id</u>
       <b>gpg-wks-server</b> [<u>options</u>] <b>--install-key</b> <u>file</u> <u>user-id</u>
       <b>gpg-wks-server</b> [<u>options</u>] <b>--remove-key</b> <u>user-id</u>
       <b>gpg-wks-server</b> [<u>options</u>] <b>--revoke-key</b> <u>user-id</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>gpg-wks-server</b>  is  a  server  side implementation of the Web Key Service.  It receives requests for
       publication, sends confirmation requests, receives confirmations, and published the  key.   It  also  has
       features to ease the setup and maintenance of a Web Key Directory.

       When  used  with the command <b>--receive</b> a single Web Key Service mail is processed.  Commonly this command
       is used with the option <b>--send</b> to directly send the created mails back.  See below  for  an  installation
       example.

       The  command  <b>--cron</b>  is  used  for regular cleanup tasks.  For example non-confirmed requested should be
       removed after their expire time.  It is best to run this command once a day from a cronjob.

       The command <b>--list-domains</b> prints all configured domains.  Further it creates missing directories for the
       configuration and prints warnings pertaining to problems in the configuration.

       The command <b>--check-key</b> (or just <b>--check</b>) checks whether a key with the given user-id is installed.   The
       process  returns  success  in this case; to also print a diagnostic use the option <b>-v</b>.  If the key is not
       installed a diagnostic is printed and the process returns failure; to suppress the diagnostic, use option
       <b>-q</b>.  More than one user-id can be given; see also option <b>with-file</b>.

       The command <b>--install-key</b> manually installs a key into the WKD.   The  arguments  are  a  file  with  the
       keyblock and the user-id to install.  If the first argument resembles a fingerprint the key is taken from
       the  current  keyring;  to force the use of a file, prefix the first argument with "./".  If no arguments
       are given the parameters are read from stdin; the expected format are lines with the fingerprint and  the
       mailbox separated by a space.

       The  command  <b>--remove-key</b>  uninstalls  a key from the WKD.  The process returns success in this case; to
       also print a diagnostic, use option <b>-v</b>.  If the key is not installed a  diagnostic  is  printed  and  the
       process returns failure; to suppress the diagnostic, use option <b>-q</b>.

       The command <b>--revoke-key</b> is not yet functional.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>gpg-wks-server</b> understands these options:

       <b>-C</b> <u>dir</u>
       <b>--directory</b> <u>dir</u>
              Use <u>dir</u> as top level directory for domains.  The default is ‘<u>/var/lib/gnupg/wks</u>’.

       <b>--from</b> <u>mailaddr</u>
              Use <u>mailaddr</u> as the default sender address.

       <b>--header</b> <u>name</u><b>=</b><u>value</u>
              Add the mail header "<u>name</u>: <u>value</u>" to all outgoing mails.

       <b>--send</b> Directly send created mails using the <b>sendmail</b> command.  Requires installation of that command.

       <b>-o</b> <u>file</u>
       <b>--output</b> <u>file</u>
              Write the created mail also to <u>file</u>. Note that the value <b>-</b> for <u>file</u> would write it to stdout.

       <b>--with-dir</b>
              When  used with the command <b>--list-domains</b> print for each installed domain the domain name and its
              directory name.

       <b>--with-file</b>
              When used with the command <b>--check-key</b> print for each user-id, the address, 'i' for installed  key
              or 'n' for not installed key, and the filename.

       <b>--verbose</b>
              Enable extra informational output.

       <b>--quiet</b>
              Disable almost all informational output.

       <b>--version</b>
              Print version of the program and exit.

       <b>--help</b> Display a brief help page and exit.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The Web Key Service requires a working directory to store keys pending for publication.  As root create a
       working directory:

           # mkdir /var/lib/gnupg/wks
           # chown webkey:webkey /var/lib/gnupg/wks
           # chmod 2750 /var/lib/gnupg/wks

       Then under your webkey account create directories for all your domains.  Here we do it for "example.net":

           $ mkdir /var/lib/gnupg/wks/example.net

       Finally run

           $ gpg-wks-server --list-domains

       to  create the required sub-directories with the permissions set correctly.  For each domain a submission
       address needs to be configured.  All service mails are directed to that address.   It  can  be  the  same
       address for all configured domains, for example:

           $ cd /var/lib/gnupg/wks/example.net
           $ echo <a href="mailto:key-submission@example.net">key-submission@example.net</a> &gt;submission-address

       The  protocol  requires that the key to be published is sent with an encrypted mail to the service.  Thus
       you need to create a key for the submission address:

           $ gpg --batch --passphrase '' --quick-gen-key <a href="mailto:key-submission@example.net">key-submission@example.net</a>
           $ gpg -K <a href="mailto:key-submission@example.net">key-submission@example.net</a>

       The output of the last command looks similar to this:

           sec   rsa3072 2016-08-30 [SC]
                 C0FCF8642D830C53246211400346653590B3795B
           uid           [ultimate] <a href="mailto:key-submission@example.net">key-submission@example.net</a>
                         <a href="mailto:bxzcxpxk8h87z1k7bzk86xn5aj47intu@example.net">bxzcxpxk8h87z1k7bzk86xn5aj47intu@example.net</a>
           ssb   rsa3072 2016-08-30 [E]

       Take the fingerprint from that output and manually publish the key:

           $ gpg-wks-server --install-key C0FCF8642D830C53246211400346653590B3795B \
           &gt;                <a href="mailto:key-submission@example.net">key-submission@example.net</a>

       Finally that submission address needs to be redirected to a script running <b>gpg-wks-server</b>.  The  <b>procmail</b>
       command  can  be  used  for  this: Redirect the submission address to the user "webkey" and put this into
       webkey's ‘<u>.procmailrc</u>’:

         :0
         * !^From: <a href="mailto:webkey@example.net">webkey@example.net</a>
         * !^X-WKS-Loop: webkey.example.net
         |gpg-wks-server -v --receive \
              --header X-WKS-Loop=webkey.example.net \
              --from <a href="mailto:webkey@example.net">webkey@example.net</a> --send

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/gpg-wks-client.1.html">gpg-wks-client</a></b>(1)

GnuPG 2.4.4                                        2024-01-25                                  <u><a href="../man1/GPG-WKS-SERVER.1.html">GPG-WKS-SERVER</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>