<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>netsed - a network stream editor.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/netsed">netsed_1.2-3build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       netsed - a network stream editor.

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>netsed</b> {<u>proto</u>} {<u>lport</u>} {<u>rhost</u>} {<u>rport</u>} {<u>rule</u>} [<u>rule</u> ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>netsed</b> is a small and handy utility to alter, in real time, the contents of packets forwarded in a
       network stream, or in a datagram connection. When called with a set of replacement rules, these rules are
       tested for applicability to each packet entering in either direction.

</pre><h4><b>ARGUMENTS</b></h4><pre>
       <u>proto</u>
           Determines the protocol for the desired connection: "tcp", "TCP", "udp", or "UDP".

       <u>lport</u>
           The local listening port for the connection. A service name, or a numerical port value, is
           acceptable.

       <u>rhost</u>
           The remote host with whom the connection is desired. Resolvable host names and IPv4/IPv6 addresses
           are equally usable.

           As a special case, assigning "0" to <u>rhost</u> will insert the kernel's knowledge of the targeted host
           address, in a situation where a netfilter rule is redirecting traffic. This happens when running a
           transparent proxy service.

       <u>rport</u>
           The remote port to connect to. A service name, or a numerical port value, is acceptable.

           Also here a value "0" will be acceptable to arrange a transparent proxy service, as the kernel's
           tracking will provide the intended remote port number.

       <u>rule</u>
           At least one replacement rule is mandatory. The general syntax for this is:

               s/pat1/pat2[/flag]

           The effect is to replace the text that matches <u>pat1</u> with the expansion of <u>pat2</u>. The optional
           parameter <u>flag</u> is a composite containing a numerical value limiting the maximal number of times the
           rule can be applied, or a direction semaphore indicating that the rule applies only to incoming
           (coded as 'I' or 'i') or outgoing ('O' or 'o') traffic. One could say that the rule <u>expires</u> after <u>num</u>
           occurrences.

           The rules are applied in succession to all passing packets, flowing in either direction. As soon as a
           rule has been expired, it is removed from the collection of active rules for the current connection.
           Observe that any counter is started as the connection is initiated, running as long as the connection
           is alive.

           This holds directly for TCP connections, whereas for UDP a connection is considered to consist of
           incoming data on fixed address and fixed port together with any response from a remote server. When
           no datagrams have been transmitted for a period of 30 seconds, the UPD connection is seen as closed.

           A single rule is limited to act on individual packets; a pattern can not match across packet
           boundaries.

           Using HTTP-like escape sequences for hexadecimal values, all eight-bit characters are viable in the
           patterns. Thus the standard character pair CRNL would code as "%0a%0d". In a pattern, the percentage
           sign itself must be escaped by duplication. Thus a string "%%" is interpreted in a pattern as a
           literal percentage sign.

</pre><h4><b>EXAMPLES</b></h4><pre>
       A handful replacement rules are handy as examples.

       s/andrew/mike
           Replace every occurrence of the string "andrew" with "mike", in every passing packet.

       s/andrew/mike/1
           Replace only the first occurrence of the string "andrew" for "mike" in each packet. Any repetition is
           unaltered, unless a further rule specifies some replacement.

       s/andrew/mike%00%00
           Replace in each packet every occurrence of the string "andrew" with "mike\x00\x00" . The padding with
           two null bytes ensures an unaltered packet length, which might be essential at times.

       s/%%/%2f/20
           Replace the first twenty occurrences of the percentage character '%' with slashes '/'.

       s/Rilke/Proust/o, s/Proust/Rilke/i
           Let Rilke travel incognito as Proust, i.e., on outgoing packets replace Rilke's real sirname by
           Proust, then restore it again in any incoming packet.

</pre><h4><b>AUTHOR</b></h4><pre>
       This text was initially compiled by Mats Erik Andersson as a Docbook source from the usage printout.
       Permission is granted to copy, distribute and/or modify this document under the terms of the GNU General
       Public License, version 2, or of a later version.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Â© 2010-2014 Mats Erik Andersson

NetSED 1.2                                       May 23rd, 2014                                        <u><a href="../man1/NETSED.1.html">NETSED</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>