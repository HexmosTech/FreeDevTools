<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>v.vol.rst   -  Interpolates  point  data  to  a 3D raster map using regularized spline with tension (RST)</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/grass-doc">grass-doc_8.4.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>v.vol.rst</b>   -  Interpolates  point  data  to  a 3D raster map using regularized spline with tension (RST)
       algorithm.

</pre><h4><b>KEYWORDS</b></h4><pre>
       vector, voxel, surface, interpolation, RST, 3D, no-data filling

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>v.vol.rst</b>
       <b>v.vol.rst</b> <b>--help</b>
       <b>v.vol.rst</b>  [-<b>c</b>]  <b>input</b>=<u>name</u>   [<b>cross_input</b>=<u>name</u>]    [<b>wcolumn</b>=<u>name</u>]     [<b>tension</b>=<u>float</u>]     [<b>smooth</b>=<u>float</u>]
       [<b>smooth_column</b>=<u>name</u>]       [<b>where</b>=<u>sql_query</u>]      [<b>deviations</b>=<u>name</u>]      [<b>cvdev</b>=<u>name</u>]      [<b>maskmap</b>=<u>name</u>]
       [<b>segmax</b>=<u>integer</u>]   [<b>npmin</b>=<u>integer</u>]    [<b>npmax</b>=<u>integer</u>]    [<b>dmin</b>=<u>float</u>]    [<b>wscale</b>=<u>float</u>]    [<b>zscale</b>=<u>float</u>]
       [<b>cross_output</b>=<u>name</u>]           [<b>elevation</b>=<u>name</u>]          [<b>gradient</b>=<u>name</u>]          [<b>aspect_horizontal</b>=<u>name</u>]
       [<b>aspect_vertical</b>=<u>name</u>]    [<b>ncurvature</b>=<u>name</u>]     [<b>gcurvature</b>=<u>name</u>]     [<b>mcurvature</b>=<u>name</u>]     [--<b>overwrite</b>]
       [--<b>help</b>]  [--<b>verbose</b>]  [--<b>quiet</b>]  [--<b>ui</b>]

   <b>Flags:</b>
       <b>-c</b>
           Perform a cross-validation procedure without volume interpolation

       <b>--overwrite</b>
           Allow output files to overwrite existing files

       <b>--help</b>
           Print usage summary

       <b>--verbose</b>
           Verbose module output

       <b>--quiet</b>
           Quiet module output

       <b>--ui</b>
           Force launching GUI dialog

   <b>Parameters:</b>
       <b>input</b>=<u>name</u> <b>[required]</b>
           Name of input 3D vector points map

       <b>cross_input</b>=<u>name</u>
           Name of input surface raster map for cross-section

       <b>wcolumn</b>=<u>name</u>
           Name of column containing w-values attribute to interpolate

       <b>tension</b>=<u>float</u>
           Tension parameter
           Default: <u>40.</u>

       <b>smooth</b>=<u>float</u>
           Smoothing parameter
           Default: <u>0.1</u>

       <b>smooth_column</b>=<u>name</u>
           Name of column with smoothing parameters

       <b>where</b>=<u>sql_query</u>
           WHERE conditions of SQL statement without ’where’ keyword
           Example: income &lt; 1000 and population &gt;= 10000

       <b>deviations</b>=<u>name</u>
           Name for output deviations vector point map

       <b>cvdev</b>=<u>name</u>
           Name for output cross-validation errors vector point map

       <b>maskmap</b>=<u>name</u>
           Name of input raster map used as mask

       <b>segmax</b>=<u>integer</u>
           Maximum number of points in a segment
           Default: <u>50</u>

       <b>npmin</b>=<u>integer</u>
           Minimum number of points for approximation in a segment (&gt;segmax)
           Default: <u>200</u>

       <b>npmax</b>=<u>integer</u>
           Maximum number of points for approximation in a segment (&gt;npmin)
           Default: <u>700</u>

       <b>dmin</b>=<u>float</u>
           Minimum distance between points (to remove almost identical points)

       <b>wscale</b>=<u>float</u>
           Conversion factor for w-values used for interpolation
           Default: <u>1.0</u>

       <b>zscale</b>=<u>float</u>
           Conversion factor for z-values
           Default: <u>1.0</u>

       <b>cross_output</b>=<u>name</u>
           Name for output cross-section raster map

       <b>elevation</b>=<u>name</u>
           Name for output elevation 3D raster map

       <b>gradient</b>=<u>name</u>
           Name for output gradient magnitude 3D raster map

       <b>aspect_horizontal</b>=<u>name</u>
           Name for output gradient horizontal angle 3D raster map

       <b>aspect_vertical</b>=<u>name</u>
           Name for output gradient vertical angle 3D raster map

       <b>ncurvature</b>=<u>name</u>
           Name for output change of gradient 3D raster map

       <b>gcurvature</b>=<u>name</u>
           Name for output Gaussian curvature 3D raster map

       <b>mcurvature</b>=<u>name</u>
           Name for output mean curvature 3D raster map

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>v.vol.rst</u>  interpolates  values  to  a  3-dimensional  raster  map  from  3-dimensional  point data (e.g.
       temperature, rainfall data from climatic stations, concentrations from drill holes etc.) given in  a  3-D
       vector point file named <b>input</b>.  The size of the output 3D raster map <b>elevation</b> is given by the current 3D
       region.  Sometimes,  the  user  may  want to get a 2-D map showing a modelled phenomenon at a crossection
       surface. In that case, <b>cross_input</b> and <b>cross_output</b> options must be specified, with the output 2D  raster
       map  <b>cross_output</b>  containing  the  crossection  of  the  interpolated  volume  with a surface defined by
       <b>cross_input</b> 2D raster map. As an option, simultaneously with interpolation, geometric parameters  of  the
       interpolated  phenomenon  can  be  computed  (magnitude  of  gradient,  direction  of gradient defined by
       horizontal and vertical angles), change of gradient, Gauss-Kronecker curvature, or mean curvature). These
       geometric  parameteres  are  saved  as  3D  raster  maps  <b>gradient,</b>  <b>aspect_horizontal,</b>  <b>aspect_vertical,</b>
       <b>ncurvature,</b>  <b>gcurvature,</b>  <b>mcurvature</b>,  respectively.  Maps  <b>aspect_horizontal</b>  and <b>aspect_vertical</b> are in
       degrees.

       At first, data points are checked for identical positions and points that are closer to each  other  than
       given  <b>dmin</b>  are  removed.   Parameters  <b>wscale</b>  and  <b>zscale</b>  allow the user to re-scale the w-values and
       z-coordinates of the point data (useful e.g. for transformation of elevations given in feet to meters, so
       that the proper values of gradient and curvatures can be computed).  Rescaling of z-coordinates  (<b>zscale</b>)
       is  also  needed when the distances in vertical direction are much smaller than the horizontal distances;
       if that is the case, the value of <b>zscale</b> should be selected so that the vertical and horizontal distances
       have about the same magnitude.

       Regularized spline with tension method is used in the interpolation.  The <b>tension</b> parameter controls  the
       distance  over which each given point influences the resulting volume (with very high tension, each point
       influences only its close neighborhood and the volume goes rapidly to trend between the points).   Higher
       values  of  tension  parameter  reduce  the  overshoots  that  can appear in volumes with rapid change of
       gradient. For noisy data, it is possible to define  a  global  smoothing  parameter,  <b>smooth</b>.   With  the
       smoothing  parameter  set to zero (<b>smooth=0</b>) the resulting volume passes exactly through the data points.
       When smoothing is used, it is possible to output a vector map <b>deviations</b>  containing  deviations  of  the
       resulting volume from the given data.

       The  user  can  define  a 2D raster map named <b>maskmap</b>, which will be used as a mask. The interpolation is
       skipped for 3-dimensional cells whose 2-dimensional projection has a zero value in the mask. Zero  values
       will be assigned to these cells in all output 3D raster maps.

       If the number of given points is greater than 700, segmented processing is used. The region is split into
       3-dimensional  "box" segments, each having less than <b>segmax</b> points and interpolation is performed on each
       segment of the region. To ensure the smooth connection of segments, the interpolation function  for  each
       segment is computed using the points in the given segment and the points in its neighborhood. The minimum
       number  of points taken for interpolation is controlled by <b>npmin</b> , the value of which must be larger than
       <b>segmax</b> and less than 700. This limit of 700 was selected to ensure the numerical stability and efficiency
       of the algorithm.

   <b>SQL</b> <b>support</b>
       Using the <b>where</b> parameter, the interpolation can be limited to use only a subset of the input vectors.
       # preparation as in above example
       v.vol.rst elevrand_3d wcol=soilrange elevation=soilrange zscale=100 where="soilrange &gt; 3"

   <b>Cross</b> <b>validation</b> <b>procedure</b>
       Sometimes it can be difficult to figure out the proper values of interpolation parameters. In this  case,
       the  user  can use a crossvalidation procedure using <b>-c</b> flag (a.k.a. "jack-knife" method) to find optimal
       parameters for given data. In this method, every point in the input point file  is  temporarily  excluded
       from  the computation and interpolation error for this point location is computed.  During this procedure
       no output grid files can be simultanuously computed.  The procedure for larger datasets may take  a  very
       long time, so it might be worth to use just a sample data representing the whole dataset.

       <u>Example</u> <u>(based</u> <u>on</u> <u>Slovakia3d</u> <u>dataset):</u>

       v.info -c precip3d
       g.region n=5530000 s=5275000 w=4186000 e=4631000 res=500 -p
       v.vol.rst -c input=precip3d wcolumn=precip zscale=50 segmax=700 cvdev=cvdevmap tension=10
       v.db.select cvdevmap
       v.univar cvdevmap col=flt1 type=point
       Based  on these results, the parameters will have to be optimized. It is recommended to plot the CV error
       as curve while modifying the parameters.

       The best approach is to start with <b>tension</b>, <b>smooth</b> and <b>zscale</b> with rough steps, or to  set  <b>zscale</b>  to  a
       constant  somewhere  between  30-60. This helps to find minimal RMSE values while then finer steps can be
       used in all parameters. The reasonable range is <b>tension</b>=10...100, <b>smooth</b>=0.1...1.0, <b>zscale</b>=10...100.

       In <u>v.vol.rst</u> the tension parameter is much more sensitive to changes than in  <u>v.surf.rst</u>,  therefore  the
       user  should always check the result by visual inspection. Minimizing CV does not always provide the best
       result, especially when the density of data are insufficient. Then the optimal result found by CV  is  an
       oversmoothed surface.

</pre><h4><b>NOTES</b></h4><pre>
       The  vector  points map must be a 3D vector map (x, y, z as geometry).  The module v.in.db can be used to
       generate a 3D vector map from a table containing x,y,z columns.  Also, the input  data  should  be  in  a
       projected  coordinate  system,  such as Universal Transverse Mercator. The module does not appear to have
       support for geographic (Lat/Long) coordinates as of May 2009.

       <u>v.vol.rst</u> uses regularized spline with tension  for  interpolation  from  point  data  (as  described  in
       Mitasova  and  Mitas, 1993). The implementation has an improved segmentation procedure based on Oct-trees
       which enhances the efficiency for large data sets.

       Geometric parameters - magnitude of gradient  (<b>gradient</b>),  horizontal  (<b>aspect_horizontal</b>)  and  vertical
       (<b>aspect_vertical)</b>aspects,   change  of  gradient  (<b>ncurvature</b>),  Gauss-Kronecker  (<b>gcurvature</b>)  and  mean
       curvatures (<b>mcurvature</b>) are computed directly from the  interpolation  function  so  that  the  important
       relationships  between  these parameters are preserved. More information on these parameters can be found
       in Mitasova et al., 1995 or Thorpe, 1979.

       The program gives warning when significant overshoots appear and higher tension should be used.  However,
       with  tension  too  high  the resulting volume will have local maximum in each given point and everywhere
       else the volume goes rapidly to trend. With a smoothing parameter greater than zero, the volume will  not
       pass through the data points and the higher the parameter the closer the volume will be to the trend. For
       theory on smoothing with splines see Talmi and Gilat, 1977 or Wahba, 1990.

       If  a  visible  connection of segments appears, the program should be rerun with higher <b>npmin</b> to get more
       points from the neighborhood of given segment.

       If the number of points in a vector map  is  less  than  400,  <b>segmax</b>  should  be  set  to  400  so  that
       segmentation is not performed when it is not necessary.

       The  program  gives  a  warning when the user wants to interpolate outside the "box" given by minimum and
       maximum coordinates in the input vector map.  To remedy this, zoom into the area encompassing  the  input
       vector data points.

       For  large  data  sets  (thousands of data points), it is suggested to zoom into a smaller representative
       area and test whether the parameters chosen (e.g. defaults) are appropriate.

       The user must run <u>g.region</u> before the program to set the 3D region for interpolation.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Spearfish example (we first simulate 3D soil range data):
       g.region -dp
       # define volume
       g.region res=100 tbres=100 res3=100 b=0 t=1500 -ap3
       ### First part: generate synthetic 3D data (true 3D soil data preferred)
       # generate random positions from elevation map (2D)
       r.random elevation.10m vector=elevrand n=200 seed=42
       # generate synthetic values
       v.to.db elevrand option=coor col=x,y
       v.db.select elevrand
       # create new 3D map
       v.in.db elevrand out=elevrand_3d x=x y=y z=value key=cat
       v.info -c elevrand_3d
       v.info -t elevrand_3d
       # remove the now superfluous ’x’, ’y’ and ’value’ (z) columns
       v.db.dropcolumn elevrand_3d col=x
       v.db.dropcolumn elevrand_3d col=y
       v.db.dropcolumn elevrand_3d col=value
       # add attribute to have data available for 3D interpolation
       # (Soil range types taken from the USDA Soil Survey)
       d.mon wx0
       d.rast soils.range
       d.vect elevrand_3d
       v.db.addcolumn elevrand_3d col="soilrange integer"
       v.what.rast elevrand_3d col=soilrange rast=soils.range
       # fix 0 (no data in raster map) to NULL:
       v.db.update elevrand_3d col=soilrange value=NULL where="soilrange=0"
       v.db.select elevrand_3d
       # optionally: check 3D points in Paraview
       v.out.vtk input=elevrand_3d output=elevrand_3d.vtk type=point precision=2
       paraview --data=elevrand_3d.vtk
       ### Second part: 3D interpolation from 3D point data
       # interpolate volume to "soilrange" voxel map
       v.vol.rst input=elevrand_3d wcol=soilrange elevation=soilrange zscale=100
       # visualize I: in GRASS GIS wxGUI
       g.gui
       # load: 2D raster map: elevation.10m
       #       3D raster map: soilrange
       # visualize II: export to Paraview
       r.mapcalc "bottom = 0.0"
       r3.out.vtk -s input=soilrange top=elevation.10m bottom=bottom dp=2 output=volume.vtk
       paraview --data=volume.vtk

</pre><h4><b>KNOWN</b> <b>ISSUES</b></h4><pre>
       <b>deviations</b> file is written as 2D and deviations are not written as attributes.

</pre><h4><b>REFERENCES</b></h4><pre>
       Hofierka J., Parajka J., Mitasova H., Mitas L., 2002, Multivariate Interpolation of  Precipitation  Using
       Regularized Spline with Tension.  Transactions in GIS  6, pp. 135-150.

       Mitas,  L.,  Mitasova,  H.,  1999,  Spatial  Interpolation. In: P.Longley, M.F.  Goodchild, D.J. Maguire,
       D.W.Rhind (Eds.), Geographical Information Systems: Principles, Techniques, Management and  Applications,
       Wiley, pp.481-492

       Mitas  L.,  Brown  W.  M.,  Mitasova  H.,  1997,  Role of dynamic cartography in simulations of landscape
       processes based on multi-variate fields. Computers and Geosciences, Vol. 23, No. 4, pp. 437-446 (includes
       CDROM and WWW: www.elsevier.nl/locate/cgvis)

       Mitasova H., Mitas L.,  Brown W.M.,  D.P. Gerdes, I.  Kosinovsky, Baker, T.1995, Modeling  spatially  and
       temporally  distributed  phenomena:  New methods and tools for GRASS GIS. International Journal of GIS, 9
       (4), special issue on Integrating GIS and Environmental modeling, 433-446.

       Mitasova, H., Mitas, L., Brown, B., Kosinovsky,  I.,  Baker,  T.,  Gerdes,  D.  (1994):  Multidimensional
       interpolation and visualization in GRASS GIS

       Mitasova  H.  and  Mitas  L.  1993:  Interpolation  by  Regularized  Spline  with  Tension: I. Theory and
       Implementation, <u>Mathematical</u> <u>Geology</u> 25, 641-655.

       Mitasova H. and Hofierka J. 1993: Interpolation by Regularized Spline with Tension:  II.  Application  to
       Terrain Modeling and Surface Geometry Analysis, <u>Mathematical</u> <u>Geology</u> 25, 657-667.

       Mitasova, H., 1992 : New capabilities for interpolation and topographic analysis in GRASS, GRASSclippings
       6, No.2 (summer), p.13.

       Wahba,  G.,  1990  : Spline Models for Observational Data, CNMS-NSF Regional Conference series in applied
       mathematics, 59, SIAM, Philadelphia, Pennsylvania.

       Mitas, L., Mitasova H., 1988 : General variational approach to the interpolation problem,  Computers  and
       Mathematics with Applications 16, p. 983

       Talmi,  A.  and  Gilat,  G.,  1977  :  Method  for Smooth Approximation of Data, Journal of Computational
       Physics, 23, p.93-123.

       Thorpe, J. A. (1979): Elementary Topics in Differential Geometry.  Springer-Verlag, New York, pp. 6-94.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        <u>g.region,</u> <u>v.in.ascii,</u> <u>r3.mask,</u> <u>v.in.db,</u> <u>v.surf.rst,</u> <u>v.univar</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       Original version of program (in FORTRAN) and GRASS enhancements:
       Lubos Mitas, NCSA, University of Illinois at Urbana-Champaign, Illinois, USA, since 2000 at Department of
       Physics, North Carolina State University, Raleigh, USA <a href="mailto:lubos_mitas@ncsu.edu">lubos_mitas@ncsu.edu</a>
       Helena Mitasova, Department of Marine, Earth and Atmospheric Sciences, North Carolina  State  University,
       Raleigh, USA, <a href="mailto:hmitaso@unity.ncsu.edu">hmitaso@unity.ncsu.edu</a>

       Modified program (translated to C, adapted for GRASS, new segmentation procedure):
       Irina Kosinovsky, US Army CERL, Champaign, Illinois, USA
       Dave Gerdes, US Army CERL, Champaign, Illinois, USA

       Modifications for g3d library, geometric parameters, cross-validation, deviations:
       Jaro  Hofierka, Department of Geography and Regional Development, University of Presov, Presov, Slovakia,
       <a href="mailto:hofierka@fhpv.unipo.sk">hofierka@fhpv.unipo.sk</a>, <a href="http://www.geomodel.sk">http://www.geomodel.sk</a>

</pre><h4><b>SOURCE</b> <b>CODE</b></h4><pre>
       Available at: v.vol.rst source code (history)

       Accessed: Friday Apr 04 01:20:43 2025

       Main index | Vector index | Topics index | Keywords index | Graphical index | Full index

       © 2003-2025 GRASS Development Team, GRASS GIS 8.4.1 Reference Manual

GRASS 8.4.1                                                                                    <u><a href="../man1grass/v.vol.rst.1grass.html">v.vol.rst</a></u>(1grass)
</pre>
 </div>
</div></section>
</div>
</body>
</html>