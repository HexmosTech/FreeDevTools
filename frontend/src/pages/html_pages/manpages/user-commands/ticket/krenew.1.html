<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>krenew - Renew a Kerberos ticket</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/kstart">kstart_4.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       krenew - Renew a Kerberos ticket

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>krenew</b> [<b>-abhiLstvx</b>] [<b>-c</b> <u>child</u> <u>pid</u> <u>file</u>] [<b>-H</b> <u>minutes</u>]
           [<b>-K</b> <u>minutes</u>] [<b>-k</b> <u>ticket</u> <u>cache</u>] [<b>-p</b> <u>pid</u> <u>file</u>]
           [<u>command</u> ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>krenew</b> renews an existing renewable ticket.  When run without any arguments, it just attempts to renew
       the existing ticket-granting ticket in the current ticket cache, equivalent to "kinit -R", but it can
       optionally run a program like <b>aklog</b> to refresh AFS tokens, can run as a daemon and wake up periodically
       to renew the ticket cache, or can run a specified command and keep renewing the ticket cache until the
       command finishes (or renewal is no longer possible).  If a command is specified, <b>krenew</b> by default wakes
       up every 60 minutes (1 hour) to check the ticket cache.

       If a command is given, <b>krenew</b> makes a copy of the ticket cache and creates a private ticket cache just
       for that command, thus isolating it from later destruction of the original ticket cache.  This allows
       krenew to maintain authentication for a command even if, for example, the user running the command logs
       out and OpenSSH destroys their original ticket cache.

       If a command is given, it will not be run using the shell, so if you want to use shell metacharacters in
       the command with their special meaning, give "sh -c <u>command</u>" as the command to run and quote <u>command</u>.  If
       the command contains command-line options (like "-c"), put "--" on the command line before the beginning
       of the command to tell <b>krenew</b> to not parse those options as its own.

       If <b>krenew</b> is built with <b>setpag()</b> support and AFS tokens are requested with the <b>-t</b> option, it will put the
       command in a separate PAG before obtaining AFS tokens so that they don't interfere with other processes
       on the system.

       When running a command, <b>krenew</b> propagates HUP, TERM, INT, and QUIT signals to the child process and does
       not exit when those signals are received.  (If the propagated signal causes the child process to exit,
       <b>krenew</b> will then exit.)  This allows <b>krenew</b> to react properly when run under a command supervision system
       such as <b><a href="../man8/runit.8.html">runit</a></b>(8) or <b><a href="../man8/svscan.8.html">svscan</a></b>(8) that uses signals to control supervised commands, and to run interactive
       commands that should receive Ctrl-C.

       If a running <b>krenew</b> receives an ALRM signal, it immediately refreshes the ticket cache regardless of
       whether it is in danger of expiring.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b>  When  run  with  either  the  <b>-K</b>  flag  or a command, always renew tickets each time <b>krenew</b> wakes up.
           Without this option, <b>krenew</b> will only try to renew a ticket as often  as  necessary  to  prevent  the
           ticket  from  expiring.   With  this  option,  <b>krenew</b>  will  renew  tickets according to the interval
           specified with the <b>-K</b> flag.

           This behavior probably should have been the default behavior of <b>-K</b>.  The default was not  changed  to
           avoid changes for existing users, but for new applications, consider always using <b>-a</b> with <b>-K</b>.

           This  option  is  important if another program is manipulating the ticket cache that <b>krenew</b> is using.
           For example, if another program is automatically renewing a ticket more frequently than <b>krenew</b>,  then
           <b>krenew</b> will never see a ticket that is close to expiring and will therefore, by default, never try to
           renew the ticket.  This means that <b>krenew</b> will also never renew AFS tokens, even if the <b>-t</b> option was
           given,  since <b>krenew</b> only renews AFS tokens after it successfully renews a ticket.  If this option is
           specified in such a situation, <b>krenew</b> will renew its ticket every time it checks the ticket,  so  AFS
           tokens will be renewed.

           This argument is only valid in combination with either <b>-K</b> or a command to run.

       <b>-b</b>  After  starting,  detach  from  the controlling terminal and run in the background.  This option only
           makes sense in combination with <b>-K</b> or a command  that  <b>krenew</b>  will  be  running.   <b>krenew</b>  will  not
           background  itself until after it does the initial ticket renewal, so that any initial errors will be
           reported, but it will then redirect output to <u>/dev/null</u> and no subsequent errors will be reported.

           If this flag is given, <b>krenew</b> will also change directories to "/".  All paths (such as to  a  command
           to run or a PID file) should therefore be given as absolute, not relative, paths.

           If  used  in conjunction with a command to run, that command will also run in the background and will
           also have its input and output redirected to <u>/dev/null</u>.  It will have to report any errors  via  some
           other mechanism for the errors to be seen.

           Use  of  this  flag  on  Mac  OS X without specifying a file-based ticket cache by either using <b>-k</b> or
           setting KRB5CCNAME will probably not do what you want.  Ticket caches on Mac OS X  are,  by  default,
           per-session and with <b>-b</b> <b>krenew</b> will detach itself from your existing ticket cache.  Instead, to renew
           the default ticket cache on Mac OS X, try something like:

               (krenew -K 60 &amp;)

           to run <b>krenew</b> in the background but within the current session.

           When using this option, consider also using <b>-L</b> to report <b>krenew</b> errors to syslog.

       <b>-c</b> <u>child</u> <u>pid</u> <u>file</u>
           Save  the process ID (PID) of the child process into <u>child</u> <u>pid</u> <u>file</u>.  <u>child</u> <u>pid</u> <u>file</u> is created if it
           doesn't exist and overwritten if it does exist.  This option is only allowed when a command was given
           on the command line and is most useful in conjunction with <b>-b</b> to  allow  management  of  the  running
           child process.

           Note  that,  when  used with <b>-b</b>, the PID file is written out after <b>krenew</b> is backgrounded and changes
           its working directory to <u>/</u>, so relative paths for the PID file will be relative to  <u>/</u>  (probably  not
           what you want).

       <b>-H</b> <u>minutes</u>
           Only  renew  the  ticket  if it has a remaining lifetime of less than <u>minutes</u> minutes.  If either the
           ticket already has a sufficiently long remaining lifetime or renewal was successful, run the  command
           (if  one was specified) or exit immediately with status 0 (if none was).  Otherwise, try to renew the
           ticket so that it will have a remaining  lifetime  of  at  least  <u>minutes</u>,  exit  with  an  error  if
           unsuccessful, and then run the command, if any.

           If  <b>-H</b>  is used with <b>-K</b>, <b>krenew</b> will not exit immediately.  Instead, the specified remaining lifetime
           will replace the default value of two minutes, meaning that <b>krenew</b> will ensure, each  time  it  wakes
           up,  that  the ticket has a remaining lifetime of the <u>minutes</u> argument.  This is an alternative to <b>-a</b>
           to ensure that tickets always have a certain minimal amount of lifetime remaining.

       <b>-h</b>  Display a usage message and exit.

       <b>-i</b>  Ignore errors in renewing the ticket and keep running.  Normally, <b>krenew</b> exits as soon as the  ticket
           cache either disappears or the tickets run out of renewable lifetime.  If this flag is given, it will
           complain about the failure to standard error (unless <b>-b</b> was given) but continue running, waking up to
           try  again after the next check interval (see <b>-K</b>).  This is useful if some other process may recreate
           an expired ticket cache and <b>krenew</b> should stay around and act on that  recreated  ticket  cache  once
           it's present.

           If  the  initial  ticket  cache  renew fails, <b>krenew</b> will retry the renewal immediately and then with
           exponential backoff to once per minute, and keep  trying  until  authentication  succeeds  or  it  is
           killed.  The command, if any, will not be started until cache renewal succeeds.

           This flag is only useful in daemon mode or when a command was given.

       <b>-K</b> <u>minutes</u>
           Run in daemon mode to keep a ticket alive indefinitely.  The program reawakens after <u>minutes</u> minutes,
           checks if the ticket will expire before or less than two minutes before the next scheduled check, and
           renews  the  ticket  if  needed.   (In  other  words,  it  ensures that the ticket will always have a
           remaining lifetime of at least two minutes.)  If the <b>-H</b> flag is also given, the lifetime specified by
           it replaces the two minute default.

           If this option is not given but a command was given on the command line, the default interval  is  60
           minutes (1 hour).

           If  an  error  occurs  in  refreshing the ticket cache that doesn't cause <b>krenew</b> to exit, the wake-up
           interval will be shortened to one minute and the operation retried at that interval for  as  long  as
           the error persists.

       <b>-k</b> <u>ticket</u> <u>cache</u>
           Use  <u>ticket</u> <u>cache</u> as the ticket cache rather than the contents of the environment variable KRB5CCNAME
           or the library default.  <u>ticket</u> <u>cache</u> may be any ticket cache identifier recognized by the underlying
           Kerberos libraries.  This generally supports a path to a file, with  or  without  a  leading  "FILE:"
           string, but may also support other ticket cache types.

       <b>-L</b>  Report  messages  to  syslog  as  well as to standard output or standard error.  All messages will be
           logged with facility LOG_DAEMON.  Regular messages that are displayed on standard output  are  logged
           with  level LOG_NOTICE.  Errors that don't cause <b>krenew</b> to terminate when run with <b>-i</b> are logged with
           level LOG_WARNING.  Fatal errors are logged with level LOG_ERR.

           This is useful when debugging problems in combination with <b>-b</b>.

       <b>-p</b> <u>pid</u> <u>file</u>
           Save the process ID (PID) of the running <b>krenew</b> process into <u>pid</u> <u>file</u>.  <u>pid</u> <u>file</u>  is  created  if  it
           doesn't exist and overwritten if it does exist.  This option is most useful in conjunction with <b>-b</b> to
           allow management of the running <b>krenew</b> daemon.

           Note that, when used with <b>-b</b> the PID file is written out after <b>krenew</b> is backgrounded and changes its
           working  directory  to <u>/</u>, so relative paths for the PID file will be relative to <u>/</u> (probably not what
           you want).

       <b>-s</b>  Normally, when <b>krenew</b> exits abnormally while  running  a  command  (if,  for  example,  the  ticket's
           renewable  lifetime  has  expired),  it  leaves  the command running.  If <b>-s</b> is given, it will send a
           SIGHUP signal to the command before exiting.  This can be useful if it's pointless for the command to
           keep running without Kerberos tickets.

       <b>-t</b>  Run an external program after getting a ticket.  The intended use of this is to run <b>aklog</b>  to  get  a
           token.   If  the  environment  variable  AKLOG  (or KINIT_PROG for backward compatibility) is set, it
           overrides the compiled-in default.

           If a command was given on the command line, <b>krenew</b> will attempt to isolate the  AFS  credentials  for
           that command from the invoking process.  There are two possible ways in which this is done.

           First,  if <b>krenew</b> has been built with AFS <b>setpag()</b> support and AFS is available, <b>krenew</b> will create a
           new PAG before running the external program.

           Otherwise, if either <b>krenew</b> was not built with AFS <b>setpag()</b> support or AFS is not available, but  the
           Linux  kafs  module  is available and <b>krenew</b> was built with libkeyutils support, it will create a new
           session keyring and link it to the current user keyring before running the external program.

           If neither of these conditions are true, <b>krenew</b> will run  the  external  program  without  doing  any
           credential isolation, which may also affect the credentials of the invoking process.

       <b>-v</b>  Be  verbose.   This  will print out a bit of additional information about what is being attempted and
           what the results are.

       <b>-x</b>  Exit immediately on any error.  Normally, when running a command or when  run  with  the  <b>-K</b>  option,
           <b>krenew</b>  keeps  running  even  if it fails to renew the ticket cache as long as the ticket cache still
           exists and appears to be renewable.  It tries again at the next check interval.   With  this  option,
           <b>krenew</b> will instead exit.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       The  program  normally  exits  with status 0 if it successfully renews a ticket.  If <b>krenew</b> runs aklog or
       some other program <b>krenew</b> returns the exit status of that program if it exits normally.  If  the  program
       exits  abnormally  due  to a signal, <b>krenew</b> will exit with a status of 128 plus the signal number.  (This
       matches the behavior of <b>bash</b>.).

</pre><h4><b>EXAMPLES</b></h4><pre>
       Renew the current ticket-granting ticket.

           krenew

       Wake up every ten minutes and check to see if the ticket cache needs renewing.  If it does, re-run  <b>aklog</b>
       as well.

           krenew -K 10 -t

       Run  the  program  <u>/usr/local/bin/compute-job</u> in the background, checking every hour to see if the ticket
       needs to be renewed (the default).  Put the PID of the <b>krenew</b> job in <u>/var/run/compute.pid</u>.  Obtain a  new
       AFS token each time the ticket has to be renewed.

           krenew -b -t -p /var/run/compute.pid /usr/local/bin/compute-job

       If  you  wanted to pass options to <u>/usr/local/bin/compute-job</u>, putting a "--" argument before it would be
       necessary to keep <b>krenew</b> from interpreting those options as its own.

       If you want to redirect output to a file that requires authentication to write to, you will  need  to  do
       that redirection in a sub-shell.  In other words, the following command:

           krenew -t compute-job &gt; /afs/local/data/output

       won't  work  if  /afs/local/data/output  requires an AFS token to write to.  The job, while running, will
       have an AFS token, but the output redirection is done in  the  parent  shell  and  doesn't  benefit  from
       <b>krenew</b>.  The above should instead be written as:

           krenew -t -- sh -c 'compute-job &gt; /afs/local/data/output'

       With  this command, the shell doing the redirection will also be run under <b>krenew</b> and have the benefit of
       the AFS token it obtains.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       If the environment variable AKLOG is set, its value will be used as the program to  run  with  <b>-t</b>  rather
       than the default complied into <b>krenew</b>.  If AKLOG is not set and KINIT_PROG is set, its value will be used
       instead.   KINIT_PROG  is  honored  for  backward compatibility but its use is not recommended due to its
       confusing name.

       If no ticket file (with <b>-k</b>) or command is specified on the command line, <b>krenew</b> will use the  environment
       variable  KRB5CCNAME  to  determine  the location of the the ticket granting ticket.  If the <b>-k</b> option is
       used, KRB5CCNAME will be set to point to the ticket file before running the <b>aklog</b> program or any  command
       given on the command line.

</pre><h4><b>FILES</b></h4><pre>
       The  default ticket cache is determined by the underlying Kerberos libraries.  The default path for aklog
       is determined at build time, and will normally be whichever of <b>aklog</b> or <b>afslog</b> is  found  in  the  user's
       path.

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>krenew</b>  was  written  by  Russ  Allbery  &lt;<a href="mailto:eagle@eyrie.org">eagle@eyrie.org</a>&gt;.  It was based heavily on <b>k5start</b> by Booker C.
       Bense, which in turn was based on the k4start code written by Robert Morgan.

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       Copyright 2015, 2021 Russ Allbery &lt;<a href="mailto:eagle@eyrie.org">eagle@eyrie.org</a>&gt;

       Copyright 2006, 2008-2012, 2014 The Board of Trustees of the Leland Stanford Junior University

       Copying and distribution of this file, with or without modification, are permitted in any medium  without
       royalty provided the copyright notice and this notice are preserved.  This file is offered as-is, without
       any warranty.

       SPDX-License-Identifier: FSFAP

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/k5start.1.html">k5start</a></b>(1), <b><a href="../man1/kinit.1.html">kinit</a></b>(1)

       This   program   is   part   of  kstart.   The  current  version  is  available  from  its  web  site  at
       &lt;https://www.eyrie.org/~eagle/software/kstart/&gt;.

4.3                                                2021-08-31                                          <u><a href="../man1/KRENEW.1.html">KRENEW</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>