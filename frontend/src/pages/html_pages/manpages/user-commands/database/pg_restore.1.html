<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pg_restore - restore a PostgreSQL database from an archive file created by pg_dump</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/postgresql-client-17">postgresql-client-17_17.5-0ubuntu0.25.04.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pg_restore - restore a PostgreSQL database from an archive file created by pg_dump

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>pg_restore</b> [<u>connection-option</u>...] [<u>option</u>...] [<u>filename</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       pg_restore is a utility for restoring a PostgreSQL database from an archive created by <b><a href="../man1/pg_dump.1.html">pg_dump</a></b>(1) in one
       of the non-plain-text formats. It will issue the commands necessary to reconstruct the database to the
       state it was in at the time it was saved. The archive files also allow pg_restore to be selective about
       what is restored, or even to reorder the items prior to being restored. The archive files are designed to
       be portable across architectures.

       pg_restore can operate in two modes. If a database name is specified, pg_restore connects to that
       database and restores archive contents directly into the database. Otherwise, a script containing the SQL
       commands necessary to rebuild the database is created and written to a file or standard output. This
       script output is equivalent to the plain text output format of pg_dump. Some of the options controlling
       the output are therefore analogous to pg_dump options.

       Obviously, pg_restore cannot restore information that is not present in the archive file. For instance,
       if the archive was made using the “dump data as <b>INSERT</b> commands” option, pg_restore will not be able to
       load the data using <b>COPY</b> statements.

</pre><h4><b>OPTIONS</b></h4><pre>
       pg_restore accepts the following command line arguments.

       <u>filename</u>
           Specifies the location of the archive file (or directory, for a directory-format archive) to be
           restored. If not specified, the standard input is used.

       <b>-a</b>
       <b>--data-only</b>
           Restore only the data, not the schema (data definitions). Table data, large objects, and sequence
           values are restored, if present in the archive.

           This option is similar to, but for historical reasons not identical to, specifying <b>--section=data</b>.

       <b>-c</b>
       <b>--clean</b>
           Before restoring database objects, issue commands to <b>DROP</b> all the objects that will be restored. This
           option is useful for overwriting an existing database. If any of the objects do not exist in the
           destination database, ignorable error messages will be reported, unless <b>--if-exists</b> is also
           specified.

       <b>-C</b>
       <b>--create</b>
           Create the database before restoring into it. If <b>--clean</b> is also specified, drop and recreate the
           target database before connecting to it.

           With <b>--create</b>, pg_restore also restores the database's comment if any, and any configuration variable
           settings that are specific to this database, that is, any <b>ALTER</b> <b>DATABASE</b> <b>...</b> <b>SET</b> <b>...</b>  and <b>ALTER</b> <b>ROLE</b>
           <b>...</b> <b>IN</b> <b>DATABASE</b> <b>...</b> <b>SET</b> <b>...</b>  commands that mention this database. Access privileges for the database
           itself are also restored, unless <b>--no-acl</b> is specified.

           When this option is used, the database named with <b>-d</b> is used only to issue the initial <b>DROP</b> <b>DATABASE</b>
           and <b>CREATE</b> <b>DATABASE</b> commands. All data is restored into the database name that appears in the
           archive.

       <b>-d</b> <u>dbname</u>
       <b>--dbname=</b><u>dbname</u>
           Connect to database <u>dbname</u> and restore directly into the database. The <u>dbname</u> can be a connection
           string. If so, connection string parameters will override any conflicting command line options.

       <b>-e</b>
       <b>--exit-on-error</b>
           Exit if an error is encountered while sending SQL commands to the database. The default is to
           continue and to display a count of errors at the end of the restoration.

       <b>-f</b> <u>filename</u>
       <b>--file=</b><u>filename</u>
           Specify output file for generated script, or for the listing when used with <b>-l</b>. Use - for stdout.

       <b>--filter=</b><u>filename</u>
           Specify a filename from which to read patterns for objects excluded or included from restore. The
           patterns are interpreted according to the same rules as <b>-n</b>/<b>--schema</b> for including objects in schemas,
           <b>-N</b>/<b>--exclude-schema</b> for excluding objects in schemas, <b>-P</b>/<b>--function</b> for restoring named functions,
           <b>-I</b>/<b>--index</b> for restoring named indexes, <b>-t</b>/<b>--table</b> for restoring named tables or <b>-T</b>/<b>--trigger</b> for
           restoring triggers. To read from STDIN, use - as the filename. The <b>--filter</b> option can be specified
           in conjunction with the above listed options for including or excluding objects, and can also be
           specified more than once for multiple filter files.

           The file lists one database pattern per row, with the following format:

               { include | exclude } { function | index | schema | table | trigger } <u>PATTERN</u>

           The first keyword specifies whether the objects matched by the pattern are to be included or
           excluded. The second keyword specifies the type of object to be filtered using the pattern:

           •   function: functions, works like the <b>-P</b>/<b>--function</b> option. This keyword can only be used with the
               include keyword.

           •   index: indexes, works like the <b>-I</b>/<b>--indexes</b> option. This keyword can only be used with the
               include keyword.

           •   schema: schemas, works like the <b>-n</b>/<b>--schema</b> and <b>-N</b>/<b>--exclude-schema</b> options.

           •   table: tables, works like the <b>-t</b>/<b>--table</b> option. This keyword can only be used with the include
               keyword.

           •   trigger: triggers, works like the <b>-T</b>/<b>--trigger</b> option. This keyword can only be used with the
               include keyword.

           Lines starting with # are considered comments and ignored. Comments can be placed after an object
           pattern row as well. Blank lines are also ignored. See Patterns for how to perform quoting in
           patterns.

       <b>-F</b> <u>format</u>
       <b>--format=</b><u>format</u>
           Specify format of the archive. It is not necessary to specify the format, since pg_restore will
           determine the format automatically. If specified, it can be one of the following:

           c
           custom
               The archive is in the custom format of pg_dump.

           d
           directory
               The archive is a directory archive.

           t
           tar
               The archive is a <b>tar</b> archive.

       <b>-I</b> <u>index</u>
       <b>--index=</b><u>index</u>
           Restore definition of named index only. Multiple indexes may be specified with multiple <b>-I</b> switches.

       <b>-j</b> <u>number-of-jobs</u>
       <b>--jobs=</b><u>number-of-jobs</u>
           Run the most time-consuming steps of pg_restore — those that load data, create indexes, or create
           constraints — concurrently, using up to <u>number-of-jobs</u> concurrent sessions. This option can
           dramatically reduce the time to restore a large database to a server running on a multiprocessor
           machine. This option is ignored when emitting a script rather than connecting directly to a database
           server.

           Each job is one process or one thread, depending on the operating system, and uses a separate
           connection to the server.

           The optimal value for this option depends on the hardware setup of the server, of the client, and of
           the network. Factors include the number of CPU cores and the disk setup. A good place to start is the
           number of CPU cores on the server, but values larger than that can also lead to faster restore times
           in many cases. Of course, values that are too high will lead to decreased performance because of
           thrashing.

           Only the custom and directory archive formats are supported with this option. The input must be a
           regular file or directory (not, for example, a pipe or standard input). Also, multiple jobs cannot be
           used together with the option <b>--single-transaction</b>.

       <b>-l</b>
       <b>--list</b>
           List the table of contents of the archive. The output of this operation can be used as input to the
           <b>-L</b> option. Note that if filtering switches such as <b>-n</b> or <b>-t</b> are used with <b>-l</b>, they will restrict the
           items listed.

       <b>-L</b> <u>list-file</u>
       <b>--use-list=</b><u>list-file</u>
           Restore only those archive elements that are listed in <u>list-file</u>, and restore them in the order they
           appear in the file. Note that if filtering switches such as <b>-n</b> or <b>-t</b> are used with <b>-L</b>, they will
           further restrict the items restored.

           <u>list-file</u> is normally created by editing the output of a previous <b>-l</b> operation. Lines can be moved or
           removed, and can also be commented out by placing a semicolon (;) at the start of the line. See below
           for examples.

       <b>-n</b> <u>schema</u>
       <b>--schema=</b><u>schema</u>
           Restore only objects that are in the named schema. Multiple schemas may be specified with multiple <b>-n</b>
           switches. This can be combined with the <b>-t</b> option to restore just a specific table.

       <b>-N</b> <u>schema</u>
       <b>--exclude-schema=</b><u>schema</u>
           Do not restore objects that are in the named schema. Multiple schemas to be excluded may be specified
           with multiple <b>-N</b> switches.

           When both <b>-n</b> and <b>-N</b> are given for the same schema name, the <b>-N</b> switch wins and the schema is
           excluded.

       <b>-O</b>
       <b>--no-owner</b>
           Do not output commands to set ownership of objects to match the original database. By default,
           pg_restore issues <b>ALTER</b> <b>OWNER</b> or <b>SET</b> <b>SESSION</b> <b>AUTHORIZATION</b> statements to set ownership of created
           schema elements. These statements will fail unless the initial connection to the database is made by
           a superuser (or the same user that owns all of the objects in the script). With <b>-O</b>, any user name can
           be used for the initial connection, and this user will own all the created objects.

       <b>-P</b> <u>function-name(argtype</u> <u>[,</u> <u>...])</u>
       <b>--function=</b><u>function-name(argtype</u> <u>[,</u> <u>...])</u>
           Restore the named function only. Be careful to spell the function name and arguments exactly as they
           appear in the dump file's table of contents. Multiple functions may be specified with multiple <b>-P</b>
           switches.

       <b>-R</b>
       <b>--no-reconnect</b>
           This option is obsolete but still accepted for backwards compatibility.

       <b>-s</b>
       <b>--schema-only</b>
           Restore only the schema (data definitions), not data, to the extent that schema entries are present
           in the archive.

           This option is the inverse of <b>--data-only</b>. It is similar to, but for historical reasons not identical
           to, specifying <b>--section=pre-data</b> <b>--section=post-data</b>.

           (Do not confuse this with the <b>--schema</b> option, which uses the word “schema” in a different meaning.)

       <b>-S</b> <u>username</u>
       <b>--superuser=</b><u>username</u>
           Specify the superuser user name to use when disabling triggers. This is relevant only if
           <b>--disable-triggers</b> is used.

       <b>-t</b> <u>table</u>
       <b>--table=</b><u>table</u>
           Restore definition and/or data of only the named table. For this purpose, “table” includes views,
           materialized views, sequences, and foreign tables. Multiple tables can be selected by writing
           multiple <b>-t</b> switches. This option can be combined with the <b>-n</b> option to specify table(s) in a
           particular schema.

               <b>Note</b>
               When <b>-t</b> is specified, pg_restore makes no attempt to restore any other database objects that the
               selected table(s) might depend upon. Therefore, there is no guarantee that a specific-table
               restore into a clean database will succeed.

               <b>Note</b>
               This flag does not behave identically to the <b>-t</b> flag of pg_dump. There is not currently any
               provision for wild-card matching in pg_restore, nor can you include a schema name within its <b>-t</b>.
               And, while pg_dump's <b>-t</b> flag will also dump subsidiary objects (such as indexes) of the selected
               table(s), pg_restore's <b>-t</b> flag does not include such subsidiary objects.

               <b>Note</b>
               In versions prior to PostgreSQL 9.6, this flag matched only tables, not any other type of
               relation.

       <b>-T</b> <u>trigger</u>
       <b>--trigger=</b><u>trigger</u>
           Restore named trigger only. Multiple triggers may be specified with multiple <b>-T</b> switches.

       <b>-v</b>
       <b>--verbose</b>
           Specifies verbose mode. This will cause pg_restore to output detailed object comments and start/stop
           times to the output file, and progress messages to standard error. Repeating the option causes
           additional debug-level messages to appear on standard error.

       <b>-V</b>
       <b>--version</b>
           Print the pg_restore version and exit.

       <b>-x</b>
       <b>--no-privileges</b>
       <b>--no-acl</b>
           Prevent restoration of access privileges (grant/revoke commands).

       <b>-1</b>
       <b>--single-transaction</b>
           Execute the restore as a single transaction (that is, wrap the emitted commands in <b>BEGIN</b>/<b>COMMIT</b>).
           This ensures that either all the commands complete successfully, or no changes are applied. This
           option implies <b>--exit-on-error</b>.

       <b>--disable-triggers</b>
           This option is relevant only when performing a data-only restore. It instructs pg_restore to execute
           commands to temporarily disable triggers on the target tables while the data is restored. Use this if
           you have referential integrity checks or other triggers on the tables that you do not want to invoke
           during data restore.

           Presently, the commands emitted for <b>--disable-triggers</b> must be done as superuser. So you should also
           specify a superuser name with <b>-S</b> or, preferably, run pg_restore as a PostgreSQL superuser.

       <b>--enable-row-security</b>
           This option is relevant only when restoring the contents of a table which has row security. By
           default, pg_restore will set row_security to off, to ensure that all data is restored in to the
           table. If the user does not have sufficient privileges to bypass row security, then an error is
           thrown. This parameter instructs pg_restore to set row_security to on instead, allowing the user to
           attempt to restore the contents of the table with row security enabled. This might still fail if the
           user does not have the right to insert the rows from the dump into the table.

           Note that this option currently also requires the dump be in <b>INSERT</b> format, as <b>COPY</b> <b>FROM</b> does not
           support row security.

       <b>--if-exists</b>
           Use DROP ... IF EXISTS commands to drop objects in <b>--clean</b> mode. This suppresses “does not exist”
           errors that might otherwise be reported. This option is not valid unless <b>--clean</b> is also specified.

       <b>--no-comments</b>
           Do not output commands to restore comments, even if the archive contains them.

       <b>--no-data-for-failed-tables</b>
           By default, table data is restored even if the creation command for the table failed (e.g., because
           it already exists). With this option, data for such a table is skipped. This behavior is useful if
           the target database already contains the desired table contents. For example, auxiliary tables for
           PostgreSQL extensions such as PostGIS might already be loaded in the target database; specifying this
           option prevents duplicate or obsolete data from being loaded into them.

           This option is effective only when restoring directly into a database, not when producing SQL script
           output.

       <b>--no-publications</b>
           Do not output commands to restore publications, even if the archive contains them.

       <b>--no-security-labels</b>
           Do not output commands to restore security labels, even if the archive contains them.

       <b>--no-subscriptions</b>
           Do not output commands to restore subscriptions, even if the archive contains them.

       <b>--no-table-access-method</b>
           Do not output commands to select table access methods. With this option, all objects will be created
           with whichever table access method is the default during restore.

       <b>--no-tablespaces</b>
           Do not output commands to select tablespaces. With this option, all objects will be created in
           whichever tablespace is the default during restore.

       <b>--section=</b><u>sectionname</u>
           Only restore the named section. The section name can be <b>pre-data</b>, <b>data</b>, or <b>post-data</b>. This option can
           be specified more than once to select multiple sections. The default is to restore all sections.

           The data section contains actual table data as well as large-object definitions. Post-data items
           consist of definitions of indexes, triggers, rules and constraints other than validated check
           constraints. Pre-data items consist of all other data definition items.

       <b>--strict-names</b>
           Require that each schema (<b>-n</b>/<b>--schema</b>) and table (<b>-t</b>/<b>--table</b>) qualifier match at least one
           schema/table in the backup file.

       <b>--transaction-size=</b><u>N</u>
           Execute the restore as a series of transactions, each processing up to <u>N</u> database objects. This
           option implies <b>--exit-on-error</b>.

           <b>--transaction-size</b> offers an intermediate choice between the default behavior (one transaction per
           SQL command) and <b>-1</b>/<b>--single-transaction</b> (one transaction for all restored objects). While
           <b>--single-transaction</b> has the least overhead, it may be impractical for large databases because the
           transaction will take a lock on each restored object, possibly exhausting the server's lock table
           space. Using <b>--transaction-size</b> with a size of a few thousand objects offers nearly the same
           performance benefits while capping the amount of lock table space needed.

       <b>--use-set-session-authorization</b>
           Output SQL-standard <b>SET</b> <b>SESSION</b> <b>AUTHORIZATION</b> commands instead of <b>ALTER</b> <b>OWNER</b> commands to determine
           object ownership. This makes the dump more standards-compatible, but depending on the history of the
           objects in the dump, might not restore properly.

       <b>-?</b>
       <b>--help</b>
           Show help about pg_restore command line arguments, and exit.

       pg_restore also accepts the following command line arguments for connection parameters:

       <b>-h</b> <u>host</u>
       <b>--host=</b><u>host</u>
           Specifies the host name of the machine on which the server is running. If the value begins with a
           slash, it is used as the directory for the Unix domain socket. The default is taken from the <b>PGHOST</b>
           environment variable, if set, else a Unix domain socket connection is attempted.

       <b>-p</b> <u>port</u>
       <b>--port=</b><u>port</u>
           Specifies the TCP port or local Unix domain socket file extension on which the server is listening
           for connections. Defaults to the <b>PGPORT</b> environment variable, if set, or a compiled-in default.

       <b>-U</b> <u>username</u>
       <b>--username=</b><u>username</u>
           User name to connect as.

       <b>-w</b>
       <b>--no-password</b>
           Never issue a password prompt. If the server requires password authentication and a password is not
           available by other means such as a .pgpass file, the connection attempt will fail. This option can be
           useful in batch jobs and scripts where no user is present to enter a password.

       <b>-W</b>
       <b>--password</b>
           Force pg_restore to prompt for a password before connecting to a database.

           This option is never essential, since pg_restore will automatically prompt for a password if the
           server demands password authentication. However, pg_restore will waste a connection attempt finding
           out that the server wants a password. In some cases it is worth typing <b>-W</b> to avoid the extra
           connection attempt.

       <b>--role=</b><u>rolename</u>
           Specifies a role name to be used to perform the restore. This option causes pg_restore to issue a <b>SET</b>
           <b>ROLE</b> <u>rolename</u> command after connecting to the database. It is useful when the authenticated user
           (specified by <b>-U</b>) lacks privileges needed by pg_restore, but can switch to a role with the required
           rights. Some installations have a policy against logging in directly as a superuser, and use of this
           option allows restores to be performed without violating the policy.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       <b>PGHOST</b>
       <b>PGOPTIONS</b>
       <b>PGPORT</b>
       <b>PGUSER</b>
           Default connection parameters

       <b>PG_COLOR</b>
           Specifies whether to use color in diagnostic messages. Possible values are always, auto and never.

       This utility, like most other PostgreSQL utilities, also uses the environment variables supported by
       libpq (see Section 32.15). However, it does not read <b>PGDATABASE</b> when a database name is not supplied.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       When a direct database connection is specified using the <b>-d</b> option, pg_restore internally executes SQL
       statements. If you have problems running pg_restore, make sure you are able to select information from
       the database using, for example, <b><a href="../man1/psql.1.html">psql</a></b>(1). Also, any default connection settings and environment variables
       used by the libpq front-end library will apply.

</pre><h4><b>NOTES</b></h4><pre>
       If your installation has any local additions to the template1 database, be careful to load the output of
       pg_restore into a truly empty database; otherwise you are likely to get errors due to duplicate
       definitions of the added objects. To make an empty database without any local additions, copy from
       template0 not template1, for example:

           CREATE DATABASE foo WITH TEMPLATE template0;

       The limitations of pg_restore are detailed below.

       •   When restoring data to a pre-existing table and the option <b>--disable-triggers</b> is used, pg_restore
           emits commands to disable triggers on user tables before inserting the data, then emits commands to
           re-enable them after the data has been inserted. If the restore is stopped in the middle, the system
           catalogs might be left in the wrong state.

       •   pg_restore cannot restore large objects selectively; for instance, only those for a specific table.
           If an archive contains large objects, then all large objects will be restored, or none of them if
           they are excluded via <b>-L</b>, <b>-t</b>, or other options.

       See also the <b><a href="../man1/pg_dump.1.html">pg_dump</a></b>(1) documentation for details on limitations of pg_dump.

       Once restored, it is wise to run <b>ANALYZE</b> on each restored table so the optimizer has useful statistics;
       see Section 24.1.3 and Section 24.1.6 for more information.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Assume we have dumped a database called mydb into a custom-format dump file:

           $ <b>pg_dump</b> <b>-Fc</b> <b>mydb</b> <b>&gt;</b> <b>db.dump</b>

       To drop the database and recreate it from the dump:

           $ <b>dropdb</b> <b>mydb</b>
           $ <b>pg_restore</b> <b>-C</b> <b>-d</b> <b>postgres</b> <b>db.dump</b>

       The database named in the <b>-d</b> switch can be any database existing in the cluster; pg_restore only uses it
       to issue the <b>CREATE</b> <b>DATABASE</b> command for mydb. With <b>-C</b>, data is always restored into the database name
       that appears in the dump file.

       To restore the dump into a new database called newdb:

           $ <b>createdb</b> <b>-T</b> <b>template0</b> <b>newdb</b>
           $ <b>pg_restore</b> <b>-d</b> <b>newdb</b> <b>db.dump</b>

       Notice we don't use <b>-C</b>, and instead connect directly to the database to be restored into. Also note that
       we clone the new database from template0 not template1, to ensure it is initially empty.

       To reorder database items, it is first necessary to dump the table of contents of the archive:

           $ <b>pg_restore</b> <b>-l</b> <b>db.dump</b> <b>&gt;</b> <b>db.list</b>

       The listing file consists of a header and one line for each item, e.g.:

           ;
           ; Archive created at Mon Sep 14 13:55:39 2009
           ;     dbname: DBDEMOS
           ;     TOC Entries: 81
           ;     Compression: 9
           ;     Dump Version: 1.10-0
           ;     Format: CUSTOM
           ;     Integer: 4 bytes
           ;     Offset: 8 bytes
           ;     Dumped from database version: 8.3.5
           ;     Dumped by pg_dump version: 8.3.8
           ;
           ;
           ; Selected TOC Entries:
           ;
           3; 2615 2200 SCHEMA - public pasha
           1861; 0 0 COMMENT - SCHEMA public pasha
           1862; 0 0 ACL - public pasha
           317; 1247 17715 TYPE public composite pasha
           319; 1247 25899 DOMAIN public domain0 pasha

       Semicolons start a comment, and the numbers at the start of lines refer to the internal archive ID
       assigned to each item.

       Lines in the file can be commented out, deleted, and reordered. For example:

           10; 145433 TABLE map_resolutions postgres
           ;2; 145344 TABLE species postgres
           ;4; 145359 TABLE nt_header postgres
           6; 145402 TABLE species_records postgres
           ;8; 145416 TABLE ss_old postgres

       could be used as input to pg_restore and would only restore items 10 and 6, in that order:

           $ <b>pg_restore</b> <b>-L</b> <b>db.list</b> <b>db.dump</b>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/pg_dump.1.html">pg_dump</a></b>(1), <b><a href="../man1/pg_dumpall.1.html">pg_dumpall</a></b>(1), <b><a href="../man1/psql.1.html">psql</a></b>(1)

PostgreSQL 17.5                                       2025                                         <u><a href="../man1/PG_RESTORE.1.html">PG_RESTORE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>