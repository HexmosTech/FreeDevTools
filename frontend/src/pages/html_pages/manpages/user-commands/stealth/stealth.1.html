<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>stealth - Stealthy File Integrity Scanner</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/stealth">stealth_4.03.03-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       stealth - Stealthy File Integrity Scanner

</pre><h4><b>SYNOPSIS</b></h4><pre>
       `&lt;uds&gt;’ represents the location of the used Unix Domain Socket.

       <b>stealth</b>  --daemon &lt;uds&gt; --dry-run --log &lt;file-spec&gt; --logmail
       --max-size &lt;size&gt;[BKMG] --no-mail --parse-policy-file
       --random-interval &lt;seconds&gt; --repeat &lt;seconds&gt;
       --skip-files &lt;file-spec&gt; --syslog
       --syslog-facility &lt;fac&gt; --syslog-priority &lt;pri&gt; --syslog-tag &lt;tag&gt;
       --verbosity &lt;value&gt; policy

       <b>stealth</b>  --dry-run --log &lt;file-spec&gt; --logmail
       --max-size &lt;size&gt;[BKMG] --no-mail --parse-policy-file
       --random-interval &lt;seconds&gt; --repeat &lt;seconds&gt;
       --run-command &lt;nr&gt; --skip-files &lt;file-spec&gt; --stdout --syslog
       --syslog-facility &lt;fac&gt; --syslog-priority &lt;pri&gt; --syslog-tag &lt;tag&gt;
       --verbosity &lt;value&gt; policy

       <b>stealth</b> {--ping,--reload,--rerun,--resume,--suspend,--terminate} &lt;uds&gt;

       <b>stealth</b> --help --version

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The name of the <b>stealth</b> program is an acronym of:
              <b>SSH-based</b> <b>Trust</b> <b>Enforcement</b> <b>Acquired</b> <b>through</b> <b>a</b> <b>Locally</b> <b>Trusted</b> <b>Host.</b>
       <b>Stealth</b>  is  based  on  an  idea  by  <u>Hans</u>  <u>Gankema</u>  and  <u>Kees</u> <u>Visser</u>, both at the Center for Information
       Technology of the University of Groningen. <u>Hopko</u> <u>Meijering</u> provided valuable suggestions for improvement.

       <b>Stealth</b>’s main task is to perform file integrity  tests.  However,  the  testing  itself  will  leave  no
       sediments  on the tested computer. Therefore, <b>stealth</b> has <u>stealthy</u> characteristics. This is considered an
       important feature, improving the security (integrity) of the software of computers monitored by <b>stealth</b>.

       Please realize that <b>stealth</b> intends to be just  another  security  tool:  other  security  measures  like
       firewalls,  portscanners,  intrusion  detection systems, dropping unencrypted protocols, etc. are usually
       required to improve the security of a group of computers that are connected to the Internet. <b>Stealth</b> is a
       file integrity scanner, and file integrity scanners offer no substitute for those tools (and vv.).

       <b>Stealth</b> uses a policy file to determine the actions to perform. Each policy file is  uniquely  associated
       with  a  host  being  monitored. This host (called the <u>client</u> below) trusts the computer on which <b>stealth</b>
       runs, called the <u>monitor</u> (hence: a <u>Locally</u> <u>Trusted</u> <u>Host</u>).  The  monitor  performs  tasks  (normally  file
       integrity  tests) that <u>Enforce</u> the <u>Trust</u> we have in the client computer. Since almost all integrity tests
       can be run on the client, one monitor can control many clients, even if  the  monitor  itself  uses  aged
       hard- and software components.

       As  the  monitor  and  the client are (i.e., should be) different computers, the monitor must communicate
       with the client in a secure fashion. This is realized through SSH. So, there’s another element of  `local
       trust’ involved here: the client should permit the monitor to set up a secure SSH connection allowing the
       monitor to access sensitive elements in the client’s file system.

       <b>It</b>  <b>is</b> <b>important</b> <b>to</b> <b>ensure</b> <b>that</b> <b>public</b> <b>access</b> <b>to</b> <b>the</b> <b>monitor</b> <b>is</b> <b>prevented.</b> <b>No</b> <b>incoming</b> <b>services</b> <b>should</b> <b>be</b>
       <b>allowed.</b> <b>The</b> <b>only</b> <b>access</b> <b>to</b> <b>the</b> <b>monitor</b> <b>should</b> <b>be</b> <b>via</b> <b>its</b> <b>console</b> <b>and</b> <b>the</b> <b>monitor</b> <b>should</b> <b>be</b> <b>placed</b>  <b>in</b>  <b>a</b>
       <b>physically</b>  <b>secure</b> <b>location.</b> <b>Sensitive</b> <b>information</b> <b>of</b> <b>clients</b> <b>are</b> <b>stored</b> <b>in</b> <b>the</b> <b>monitor’s</b> <b>file</b> <b>system.</b> <b>To</b>
       <b>access</b> <b>the</b> <b>clients</b> <b>stealth</b> <b>in</b> <b>daemon</b> <b>mode</b> <b>can</b> <b>use</b> <b>a</b> <b>passphrase-protected</b>  <b>ssh-key,</b>  <b>allowing</b>  <b>stealth</b>  <b>to</b>
       <b>perform</b> <b>its</b> <b>tasks</b> <b>thereafter.</b> <b>This,</b> <b>too,</b> <b>makes</b> <b>it</b> <b>important</b> <b>to</b> <b>prevent</b> <b>the</b> <b>monitor</b> <b>from</b> <b>being</b> <b>accessed</b> <b>by</b>
       <b>unauthorized</b> <b>persons.</b>

       If,  instead  of  running  <b>stealth</b>  in  daemon  mode  it  is preferred to let <b>stealth</b> perform single, but
       automated integrity scans, then new <b><a href="../man1/ssh.1.html">ssh</a></b>(1) connections may be difficult to establish if the used  ssh-key
       is  passphrase-protected.  To  implement  this scenario (i.e., automated integrity scans using passphrase
       protected ssh-keys) the program <b><a href="../man1/ssh-cron.1.html">ssh-cron</a></b>(1) can profitably be used.

       <b>Stealth</b>’s current way of connecting to clients uses a single <b><a href="../man1/ssh.1.html">ssh</a></b>(1) connection, which results in  only  a
       single  <b><a href="../man1/sshd.1.html">sshd</a></b>(1) entry in the client’s logfiles, which lasts for the duration of <b>stealth</b>’s run. When using
       <b>stealth</b> in daemon mode this too minimizes the `footprint’ <b>stealth</b> has on the client hosts.

       The  monitor  itself normally only requires two types of outgoing services: <b>SSH</b> to reach its clients, and
       some mail transport agent (e.g., <b><a href="../man1/sendmail.1.html">sendmail</a></b>(1)) to forward its outgoing mail to some mail-hub.

       Here is what happens when <b>stealth</b> running using the first synopsis:

       o      First, the <u>policy</u> file is read. For each client a policy file is defined, specifying  the  actions
              to be performed, and specifying the values of several variables used by <b>stealth</b>.

       o      If  the  command-line  option --daemon &lt;uds&gt; is specified, <b>stealth</b> runs as a daemon process, using
              the Unix Domain Socket (&lt;uds&gt;) for communication with <b>stealth</b> processes running in IPC mode.

              If access to the Unix  Domain  Socket  defined  by  Stealth  running  in  daemon  mode  should  be
              restricted,  it  can be defined in a directory with is only accessible to the user running Stealth
              (this will often be the root-user).

              When running in daemon mode, --repeat &lt;seconds&gt; may be specified to rerun the integrity scan every
              &lt;seconds&gt; seconds. If an integrity scan is being performed when, according to the repeat  interval
              the next integrity scan is due, then the current scan is first completed. Once completed, the next
              integrity scan will be performed after seconds seconds.

       o      Next,  the  monitor  opens  a command shell on the client using <b><a href="../man1/ssh.1.html">ssh</a></b>(1), and a command shell on the
              monitor computer itself using <b><a href="../man1/sh.1.html">sh</a></b>(1).

       o      Once the command shells are available, commands defined in the policy file are executed  in  their
              order of appearance. Examples are given below. Normally, return values of the programs are tested.
              When  return values are to be tested <b>stealth</b> terminates when a non-zero return value is sensed. If
              this happens, a message stating the reason why <b>stealth</b> terminated is written to  the  report  file
              (and  into  the  mail  sent  by  <b>stealth</b>).  In some cases (e.g., when the report file could not be
              written), the message is written to the standard error stream.

       o      Very often integrity  tests  can  be  controlled  using  <b><a href="../man1/find.1.html">find</a></b>(1),  calling  programs  like  <b><a href="../man1/ls.1.html">ls</a></b>(1),
              <b><a href="../man1/sha256sum.1.html">sha256sum</a></b>(1) or its own -printf method to produce file-integrity related statistics. Most of these
              programs  write  file  names  at the end of generated lines. This characteristic is used by one of
              <b>stealth</b>’s internal routines to detect changes in the generated output. Such changes could indicate
              some harmful intent, like an installed <u>root-kit</u>.

       o      When changes are detected, they are logged in a  <u>report</u>  <u>file</u>,  to  which  information  is  always
              appended.  <b>Stealth</b> never reduces the report file’s size or rewrites its contents. When information
              is added to the report file (beyond a plain time stamp) the newly added information is e-mailed to
              a configurable e-mail address for further (human) processing. Usually the e-mail is  sent  to  the
              systems  manager  of  the  tested client. <b>Stealth</b> follows the `dark cockpit’ approach in the sense
              that no mail is sent when no changes were detected.

       o      Report and other log-files may safely be  rotated  between  a  pair  of  --suppress  and  --resume
              commands (see below at the section `REPORT FILE ROTATION’).

       If  <b>stealth</b>  should  not be run as a daemon process the second synopsis can be used. In this case <b>stealth</b>
       performs one or more integrity scans (the latter when the --repreat option was specified). When a  single
       integrity scan is requested <b>stealth</b> terminates after the scan. When --repeat is specified <b>stealth</b> shows a
       prompt (i.e., `? ’) and terminates after pressing the Enter-key.

       The  third  synopsis  is  used  for communication with a <b>stealth</b> daemon. In this case the the Unix Domain
       Socket defined by the <b>stealth</b> daemon process must be specified after the option specifying the  requested
       command.

</pre><h4><b>OPTIONS</b></h4><pre>
       Short options are provided between parentheses, immediately following their long option equivalents.

       Option  descriptions  showing (C) can only be used on the command-line, and are ignored when specified in
       the second section of the policy file.

       In the overview of  options  `&lt;uds&gt;’  represents  the  name  of  the  <u>Unix</u>  <u>Domain</u>  <u>Socket</u>  to  use,  and
       `&lt;file-spec&gt;’ refers to a (relative or absolute) specification of a file location.

       With  the  first  and  second  synopses  relative  locations  (of  the  Unix  Domain  Socket and of other
       file-specifications) are interpreted relative to the current working directory.

       Command-line options overrule options defined in the policy-file.

       o      --daemon (-d) &lt;uds&gt;: (C) run as background (daemon) process. When the Stealth  daemon  process  is
              started, the Unix Domain Socket (tt&lt;uds&gt;) may not already exist.

       o      --dry-run:  (C)  no  integrity scans or reloads are performed, but are assumed OK. Remaining tasks
              are normally performed;

       o      --help (-h): (C) Display help information and exit;

       o      --log (-L) &lt;file-spec&gt;: log messages are appended to `file-spec’. If file-spec does not exist,  it
              is first created;

       o      --logmail: mail sent by <b>stealth</b> is logged (requires --log or --syslog);

       o      --max-size &lt;size&gt;[BKMG]: files retrieved by GET commands may at most have &lt;size&gt; bytes (B), KBytes
              (K), MBytes (M), GBytes (G). The default size is 10M, the default unit is B.

       o      --no-mail:  mail  is not sent. By default mail is sent as configured in the policy-file (--logmail
              can be specified independently from --no-mail);

       o      --parse-policy-file (-p): (C) parse the policy file, after which <b>stealth</b> ends.
              Specify once to see the numbered commands;
              twice to see the policy file parsing steps as well.
              Results are written to the std. output.

       o      --ping &lt;uds&gt;: (C) performs no actions, but is used to verify that a <b>stealth</b> daemon can be  reached
              via  its  Unix Domain Socket (&lt;uds&gt;). The daemon will respond even if it’s currently performing an
              integrity scan. It is used by the /usr/bin/stealthcron script to verify that a <b>stealth</b>  daemon  is
              alive.

       o      --random-interval  (-i) &lt;interval&gt;[m]&gt;: start the scan a random interval of &lt;interval&gt; seconds (or
              minutes if an `m’ is appended (no blanks) to &lt;interval&gt;) following the delay specified at --repeat
              (see below). This option requires specification of the --repeat and --daemon options;

       o      --reload &lt;uds&gt;: (C) reloads the configuration and skip-files and restarts the scan of the  <b>stealth</b>
              daemon  process.  Options  defined  in  the  policy  file are also reloaded. However, command-line
              options always take priority over options defined in the policy file, so when command-line options
              were used when starting <b>stealth</b> in daemon mode, they cannot be modified by  reloading  the  policy
              file.

       o      --repeat &lt;seconds&gt;: wake up and perform an integrity scan at interrupts or after &lt;seconds&gt; seconds
              (or  minutes  if  an  `m’  is  appended  (no  blanks)  to &lt;seconds&gt;) after completing the previous
              integrity scan. The option --random-interval can be used to add a random delay to &lt;seconds&gt;  until
              the  next  integrity  scan  is  performed.  This option requires specification of the and --daemon
              option;

       o      --rerun &lt;uds&gt;: (C) start executing the integrity scan commands that are specified in  the  <b>stealth</b>
              daemon process’s policy file;

       o      --resume &lt;uds&gt;: (C) resume a suspended <b>stealth</b> process, implies --rerun;

       o      --run-command  (-r)  &lt;nr&gt;: (C) Only execute command number &lt;nr&gt; (natural number).  Command numbers
              are shown by <b>stealth</b> ---parse-policy-file. This option can only  be  specified  using  the  second
              synopsis;

       o      --skip-files  (-s)  &lt;file-spec&gt;:  all  entries  in &lt;file-spec&gt; are skipped. Their integrity is not
              monitored. If an entry is already present in a log file then <b>stealth</b> once  generates  an  IGNORING
              message  in  the  mail  sent  to  the  address  specified  at EMAIL in the policy file. Each entry
              mentioned in file-spec must be on a line of its own and must  be  specified  using  absolute  file
              paths.  Entries  ending  in  a  slash  are  assumed  to be directories whose full contents must be
              skipped. Other entries are interpreted as the names of files to skip. Initial and trailing blanks,
              empty lines and lines having a # as their 1st non blank  character  are  ignored.  Here  are  some
              examples:

                      # skip all files in user’s Mail directory
                  /home/user/Mail/
                      # skip user’s .history file
                  /home/user/.history

       o      --stdout  (-o):  messages  are  (also)  written to the std. output stream (only available with the
              second synopsis);

       o      --suspend &lt;uds&gt;: (C) suspends a currently active <b>stealth</b> process. Following --suspend use --resume
              to re-activate an <b>stealth</b> daemon or --terminate to end an <b>stealth</b> daemon;

       o      --syslog: write syslog messages;

       o      --syslog-facility &lt;facility&gt;:  syslog facility to use. By default facility DAEMON is used;

       o      --syslog-priority &lt;priority&gt;: syslog priority to use. By default priority NOTICE is used;

       o      --syslog-tag &lt;tag&gt;: &lt;tag&gt; specifies the identifier that is prefixed to syslog messages. By default
              the tag `STEALTH’ is used, see also the next section;

       o      --terminate &lt;uds&gt;: (C) terminate a currently active <b>stealth</b> process;

       o      --time-stamp (-t) &lt;type&gt;: the time-stamps to use. By default UTC. To use the  local  time  specify
              --time-stamp  LT.  The  --time-stamp option does not apply to time-stamps generated by syslog (see
              also the next section);

       o      --usage: (C) Display help information and exit;

       o      --verbosity &lt;value&gt;: determines the amount  of  logged  information.  Requires  options  --log  or
              --syslog. Possible values are:
              0: nothing is logged
              1: (default) mode reports and policy commands
              2: also: ipc commands and actions
              3: also: integrity scan informative messages

       o      --version (-v): (C) Display <b>stealth</b>’s version information and terminate;

       o      policy:  file  specification  of  the  policy  file. If a relative location is specified then this
              location is interpreted relative to the current working directory. <b>Stealth</b> converts this  relative
              specification  to  an  absolute  file location, and an option like --reload will reload the policy
              file from the thus determined absolute file path.

       Only one of the options --daemon, --reload, --resume, --suspend or  --terminate  can  be  specified.  The
       options --reload, --rerun, --resume, --suspend, and --terminate ignore any other options.

       The  following options are still recognized for backward compatibility with <b>stealth</b> pre-3.00 versions and
       will be removed in a future <b>stealth</b> version. They generate error messages suggesting alternatives:

       o      --echo-commands (-e): echo commands to std error when they are processed; use --log instead.

       o      --keep-alive: run as a daemon; use --daemon instead.

       o      --only-stdout: scan report is written to stdout; use --stdout instead.

       o      --quiet (-q): suppresses progress messages written to stderr; use --verbosity 0 instead.

       o      --suppress &lt;uds&gt;: suppresses a currently active <b>stealth</b> process; use --suspend instead.

       The following options were discontinued starting since <b>stealth</b> version 3.00.00:

       o      --debug (option --verbosity or --dry-run could be used instead);

       o      --no-child-processes;

       o      --parse-config-file.

       When specifying long options in policy files initial hyphens should be omitted. Here are some examples:
           %%
           log /tmp/stealth.log
           verbosity 3

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       When requesting an IPC command or when starting <b>stealth</b> as a daemon 0 is  returned  if  the  command  was
       successfully completed. Otherwise a non-0 value is returned.

</pre><h4><b>OPEN</b> <b>SSH</b> <b>LINK</b> <b>TO</b> <b>CLIENTS</b></h4><pre>
       Once <b>stealth</b> has started as a foreground or daemon process performing file integrity scans <b><a href="../man1/ssh.1.html">ssh</a></b>(1) is used
       to connect to the client(s) monitored by <b>stealth</b>. While <b>stealth</b> runs only one <b><a href="../man1/ssh.1.html">ssh</a></b>(1) connection is opened
       to  each  client. This connection remains active during <b>stealth</b>’s lifetime to minimize the number of <b>sshd</b>
       entries in the client’s log files.

</pre><h4><b>THE</b> <b>POLICY</b> <b>FILE</b></h4><pre>
       The policy file consists of two sections, the second section is optional, and starts  at  a  line  merely
       containing %%.

       The  policy  file’s first section consists of two sets of data: <u>use</u> <u>directives</u> (starting with the keyword
       <b>USE</b>) and <u>commands</u>. Blank lines and information beyond hash-marks (#) are ignored, while  lines  following
       lines  terminating  in backslashes (\) are concatenated (<u>en</u> <u>passant</u> removing these trailing backslashes).
       Leading white space on lines of the policy file is ignored.

       The (optional) second section starts at a line merely  containing  %%.  Following  this  separating  line
       several  long  option  specifications can be entered (see below at section <b>OPTIONS</b>). Options specified on
       the command-line take priority over options specified in the policy file. Although  the  --reload  option
       reloads  the  policy file, it will not change option values originally specified as command-line options.
       This section may contain specifications of the skip-files  and  log  options.   Relative  file  locations
       specified  for  these  options  are interpreted relative to the location of the policy file. E.g., if the
       policy file argument is specified as /root/client/policy then the specification log:  client.log  results
       in <b>stealth</b> writing its logs into the file /root/client/client.log.

</pre><h4><b>DEFINE</b> <b>DIRECTIVES</b></h4><pre>
       <b>DEFINE</b>  directives  are used to associate longer strings of text with certain symbols. E.g., after DEFINE
       FINDARGS -xdev -type f -exec <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a> {} \; the specification ${FINDARGS} may be  used  in  <b>USE</b>
       <b>DIRECTIVES</b> and <b>commands</b> (see below) to use the text associated with the <b>FINDARGS</b> symbol.

       Note  that  <b>DEFINE</b>  symbols may also be used in the definition of other <b>DEFINE</b> symbols as well. Direct or
       indirect circular definitions should be avoided, as they are either not or incompletely expanded.

</pre><h4><b>USE</b> <b>DIRECTIVES</b></h4><pre>
       The following <b>USE</b> directives may be specified (directives are written  in  capitals,  and  should  appear
       exactly  as  written below: letter casing is preserved). Specifications in angular brackets (like &lt;this&gt;)
       represent specifications to be provided  by <b>stealth</b>’s users:

       o      <b>USE</b> <b>BASE</b> &lt;base-directory&gt;
              <b>BASE</b>  defines  the  directory  from  where  <b>stealth</b>  operates.  All   subsequent   relative   path
              specifications  in  the policy file (including relative path specifications in the policy’s second
              part) are interpreted relative to <b>BASE</b>. <u>By</u>  <u>default</u>  this  is  the  directory  where  <b>stealth</b>  was
              started.
              <b>BASE</b> and other non-existing paths are created automatically by <b>stealth</b> if not yet existing.
              Example:
              USE BASE /root/client

       o      <b>USE</b> <b>DD</b> &lt;dd&gt;
              The  <b>DD</b> specification uses <a href="file:/bin/dd">/bin/dd</a> as default, and defines the location of the <b><a href="../man1/dd.1.html">dd</a></b>(1) program, both
              on the server and on the client. The <b>DD</b> program is used to copy files between the client  and  the
              monitor  over the existing ssh-connection. The program specified here is only used by <b>stealth</b> when
              executing PUT and GET commands (described below).
              Example showing the default:
              USE DD <a href="file:/bin/dd">/bin/dd</a>

       o      <b>USE</b> <b>DIFF</b> &lt;diff&gt;
              The default <b>DIFF</b> specification uses <a href="../man1/diff">/usr/bin/diff</a>, and defines the location of the <b><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?diff.1.html">diff</a></b>(1) program
              on the monitor. The <b><a href="../man1/diff.1.html">diff</a></b>(1) program is used to compare a formerly created logfile of an  integrity
              check with a newly created logfile.
              Example showing the default:
              USE DIFF <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?diff">/usr/bin/diff</a>

       o      <b>USE</b> <b>DIFFPREFIX</b> &lt;prefix&gt;
              The  <b>DIFFPREFIX</b>  specification  defines  the size of the prefix added by the DIFF command to lines
              produced by commands executed through <b>stealth</b>.

              The default <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?diff">/usr/bin/diff</a> program prefixes lines by either `&gt; ’ or `&lt; ’.  The  default  value  for
              &lt;prefix&gt; is therefore equal to 2.
              Example showing the default:
              USE DIFFPREFIX 2

       o      <b>USE</b> <b>EMAIL</b> &lt;address&gt;
              The  <b>EMAIL</b>  specification defines the email-address to receive the report of the integrity scan of
              the client. The `dark cockpit’ philosophy is followed here: mail is only sent when a  modification
              is detected.
              Example showing the default (apparently an email address on the monitor):
              USE EMAIL root

       o      <b>USE</b> <b>MAILER</b> &lt;mailer&gt;
              The <b>MAILER</b> specification defines the program that to send e-mail to the <b>EMAIL</b>-address. Contrary to
              <b>DIFF</b> and <b>DD</b> and (see below) <b>SH</b> and <b>SSH</b>, <b>MAILER</b> is run as a <a href="file:/bin/sh">/bin/sh</a> command, to allow shell-scripts
              to  process the mail too. By default <b>MAILER</b> is defined as <b>/usr/bin/mail</b>. <b>MAILER</b> is called with the
              following arguments:
              ----------------------------------------------------------
              <b>MAILARGS</b>, see below;
              <b>EMAIL</b>, the addressee of the mail.
              ----------------------------------------------------------
              Example showing the default:
              USE MAILER /usr/bin/mail

              As an alternative, the script stealthmail is provided.  It  offers  a  convenient  filter  sorting
              <b>stealth</b>’s  output  and keeping only lines containing the text ADDED, MODIFIED, REMOVED or STEALTH.
              Usually these lines are the ones system managers are interested in. The report and log  files  can
              always be consulted to determine the actual nature of the changes.

       o      <b>USE</b> <b>MAILARGS</b> &lt;args&gt;
              The  <b>MAILARGS</b> specification defines the arguments that are passed to MAILER, followed by the EMAIL
              specification.
              Example showing the default:
              USE MAILARGS -s "STEALTH scan report"
              Note that blanks may be used in the subject specification: use double or single quotes  to  define
              elements  containing  blanks.  Use \" to use a double quote in a string that itself is delimted by
              double quotes; use \’ to use a single quote in a string that itself is delimted by single quotes.

       o      <b>USE</b> <b>REPORT</b> &lt;file-spec&gt;
              <b>REPORT</b> defines the name of the reportfile. Information is always appended to this  file.  At  each
              <b>stealth</b> integrity scan a <u>time</u> <u>marker</u> <u>line</u> is written to the report file. Only when (in addition to
              the  marker  line) additional information is appended to the report file the added contents of the
              report file are mailed to the mail address specified  in  the  <b>USE</b>  <b>EMAIL</b>  specification.  When  a
              relative  file  specification  is  used  it  is  interpreted  a  location relative to the USE BASE
              specification.
              Example showing the default:
              USE REPORT report

       o      <b>USE</b> <b>SH</b> &lt;sh&gt;
              The <b>SH</b> specification uses <a href="file:/bin/sh">/bin/sh</a> as default, and defines the command shell used by the monitor to
              execute commands on itself. This must be an absolute path specification.
              Example showing the default:
              USE SH <a href="file:/bin/sh">/bin/sh</a>

       o      <b>USE</b> <b>SSH</b> &lt;user&gt;
              <b>The</b> <b>SSH</b> <b>specification</b> <b>has</b> <b>no</b> <b>default</b>, and <u>must</u>  be  specified.  This  must  be  an  absolute  path
              specification.

              Assuming the client <u>trusts</u> the monitor (which is after all what this program is all about, so this
              should  not  be  a very strong assumption), preferably the public ssh key of the monitor should be
              placed in the client’s root .ssh/authorized_keys file, granting the monitor  root  access  to  the
              client. Root access is normally needed to gain access to all directories and files of the client’s
              file system.

              In  practice,  connecting  to an account using the <b><a href="../man1/sh.1.html">sh</a></b>(1) shell is preferred. When another shell is
              already used by that account, one  should  make  sure  that  its  shell  doesn’t  define  its  own
              redirections  for  standard input and standard output. One way to accomplish that is for force the
              execution of <a href="file:/bin/sh">/bin/sh</a> in the <b>USE</b> <b>SSH</b> specification.  Examples:
                  # root’s shell is <a href="file:/bin/sh">/bin/sh</a>:
                      USE SSH root@client -T -q
                  # root uses another shell, but the use of <a href="file:/bin/bash">/bin/bash</a> is forced:
                      USE SSH root@client -T -q exec <a href="file:/bin/bash">/bin/bash</a>
                  # an alternative:
                      USE SSH root@client -T -q exec <a href="file:/bin/bash">/bin/bash</a> --noprofile

       In some installations <b>stealth</b> is used to inspect the monitor itself, even though this is <u>not</u> recommended,
       as it breaks one of the main reasons for <b>stealth</b>’s existence. But in those situations (so, where  <b>stealth</b>
       is  used  to  monitor  the  integrity  of  the  localhost),  <a href="file:/bin/bash">/bin/bash</a>  could be specified at the USE SSH
       directive. For example:
           # For stealth inspecting localhost:
               USE SSH <a href="file:/bin/bash">/bin/bash</a> --noprofile

</pre><h4><b>COMMANDS</b></h4><pre>
       Following the <b>USE</b> specifications, <u>commands</u> can be specified. The commands are executed in their order  of
       appearance  in the policy file. Processing continues until the last command has been processed or until a
       tested command (see below) returns a non-zero return value.

</pre><h4><b>LABEL</b> <b>COMMANDS</b></h4><pre>
       The following <b>LABEL</b> commands are available:

       o      <b>LABEL</b> &lt;text&gt;
              This defines a text-label which is written to the <b>REPORT</b> file, in front of the output generated by
              the next <b>CHECK</b>-command. If the next <b>CHECK</b>-command generates  no  output,  the  text-label  is  not
              written to the <b>REPORT</b>-file. Once a <b>LABEL</b> has been defined, it is used until it is redefined by the
              next <b>LABEL</b>. Use an empty <b>LABEL</b> specification to suppress the printing of labels.

              The text may contain \n characters (two characters) which are transformed to a newline character.

              Example:
              LABEL Inspecting files in <a href="file:/etc">/etc</a>\nIncluding subdirectories
              LABEL
              (In this example the former <b>LABEL</b> specification is erased by the latter <b>LABEL</b> command).

</pre><h4><b>LOCAL</b> <b>COMMANDS</b></h4><pre>
       <b>LOCAL</b> commands are executed on the monitor itself:

       o      <b>LOCAL</b> &lt;command&gt;
              Execute  command  on the monitor, using the <b>SH</b> command shell. The command must succeed (i.e., must
              return a zero exit value).
              Example:
              LOCAL scp rootsh@client:<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a> <a href="file:/tmp">/tmp</a>
              This command copies the client’s <b><a href="../man1/sha256sum.1.html">sha256sum</a></b>(1) program to the monitor.

       o      <b>LOCAL</b> <b>NOTEST</b> &lt;command&gt;
              Execute command on the monitor, using the <b>SH</b> command shell. The command may or may not succeed.
              Example:
              LOCAL NOTEST mkdir /tmp/subdir
              This command creates /tmp/subdir on the monitor. The command fails  if  the  directory  cannot  be
              created, but this does not terminate <b>stealth</b>.

       o      <b>LOCAL</b> <b>CHECK</b> [<b>LOG</b> <b>=</b>] &lt;file-spec&gt; [pathOffset] &lt;command&gt;
              Execute  command  on the monitor, using the <b>SH</b> command shell. The command must succeed. The output
              of this command is compared to the output of this command generated during the previous  integrity
              check run by <b>stealth</b>.

              The  phrase  <b>LOG</b>  <b>=</b>  is  optional. When a relative file location is specified at &lt;file-spec&gt; it is
              interpreted relatively to the USE BASE path specification.

              PathOffset is also optional. If specified it defines the  (0-based)  offset  where  path-names  of
              inspected  files  start  in lines produced by &lt;command&gt;. By default <b>stealth</b> assumes that the first
              occurrence of a forward slash defines the first character of the path-names of inspected files.

              For example, if diff-output looks like this:
                  01234567890123456789012345678901234567890 (column offsets)
                  33c33
                  &lt; 90d8b506d249634c4ff80b9018644567  filename-specification
                  ---
                  &gt; b88d0b77db74cc4a742d7bc26cdd2a1e  filename-specification
              then the specification
                  LOCAL CHECK logfile 36 command-to-be-executed
              informs <b>stealth</b> where to find the filename specifications in the diff-output. Using  the  standard
              <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?diff">/usr/bin/diff</a>  command,  this  offset equals 2 + the offset of the filename-specification found in
              command-to-be-executed.

              Any differences between the previous and current output are written to <b>REPORT</b>. If differences were
              found, the existing logfile name is renamed to logfile.YYMMDD-HHMMSS, with YYMMDD-HHMMSS the (UTC)
              datetime-stamp at the time <b>stealth</b> was run.

              Note that eventually many logfile.YYMMDD-HHMMSS files could be created: It is up to the  monitor’s
              systems manager to decide what to do with old datetime-stamped logfiles.

              The  logfile  specifications  may  use  relative and absolute paths. When relative paths are used,
              these paths are relative to <b>BASE</b>. When the directories implied by the  logfile  specifications  do
              not yet exist, they are created first.

              Example:
              LOCAL CHECK LOG = local/sha256sum sha256sum /tmp/sha256sum
              This command checks the SHA256 sum of the /tmp/sha256sum program. The resulting output is saved at
              <b>BASE</b>/local/sha256sum. The program must succeed (i.e., sha256sum must return a zero exit-value).

       o      <b>LOCAL</b> <b>NOTEST</b> <b>CHECK</b> &lt;logfile&gt;  [pathOffset] &lt;command&gt;
              Execute  command  on  the monitor, using the <b>SH</b> command shell. The command may or may not succeed.
              Otherwise, the command performs exactly like the <b>LOCAL</b> <b>CHECK</b> <b>...</b> command, discussed above.

              Example:
              LOCAL NOTEST CHECK LOG=local/sha256sum sha256sum /tmp/sha256sum
              This command checks the SHA256 sum of the /tmp/sha256sum program. The resulting output is saved at
              <b>BASE</b>/local/sha256sum. The program must succeed (i.e., sha256sum must return a zero exit-value).

       Note that the <b><a href="../man1/scp.1.html">scp</a></b>(1) command can be used to copy files between the client and the monitor, using a  local
       command.  This,  however,  is  discouraged, as a separate <b><a href="../man1/ssh.1.html">ssh</a></b>(1)-connection is required for each separate
       <b><a href="../man1/scp.1.html">scp</a></b>(1)  command.  This  subtlety  was  brought   to   the   author’s   attention   by   Hopko   Meijerink
       (<a href="mailto:h.meijering@rug.nl">h.meijering@rug.nl</a>).

       To  copy  files  between the client and the monitor, the GET and PUT commands (described below) should be
       used instead, as these commands use the existing <b><a href="../man1/ssh.1.html">ssh</a></b>(1) connection. In general, LOCAL commands should not
       be used to establish additional <b><a href="../man1/ssh.1.html">ssh</a></b>(1) connections to a client.

</pre><h4><b>REMOTE</b> <b>COMMANDS</b></h4><pre>
       Remote commands are commands executed on the client using the <b>SSH</b>  shell.  These  commands  are  executed
       using the standard PATH set for the <b>SSH</b> shell. However, it is advised to specify the full pathname to the
       programs  to  be  executed,  to  prevent  ``trojan  approaches’’  where a trojan horse is installed in an
       `earlier’ directory of the PATH-specification than the intended program.

       Two special remote commands are GET and PUT, which can be used to copy files between the client  and  the
       monitor.   Internally,  GET and PUT use the DD specification. If a non-default specification is used, one
       should ensure that the alternate program accepts <b><a href="../man1/dd.1.html">dd</a></b>(1)’s if=, of=, bs= and count= options. With  GET  the
       options  bs=,  count= and of= are used, with PUT the options bs=, count= and if= are used. Normally there
       should be no need to alter the default DD specification.

       The GET command may be used as follows:

       o      <b>GET</b> &lt;client-path&gt; &lt;local-path&gt;
              Copy the file indicated by  client-path  at  the  client  to  local-path  at  the  monitor.  Here,
              client-path  must  be  the full path of an existing file on the client, local-path may either be a
              local directory, in which case the client’s file name  is  used,  or  another  file  name  may  be
              specified, in which case the client’s file is copied to the specified local filename. If the local
              file already exists, it is overwritten by the copy-procedure.

              Example:
              GET <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a> <a href="file:/tmp">/tmp</a>
              The  program  <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a>,  available  at  the  client,  is  copied  to  the monitor’s <a href="file:/tmp">/tmp</a>
              directory. If, for whatever reason, copying fails, then <b>stealth</b> terminates.

       o      <b>GET</b> <b>NOTEST</b> &lt;client-path&gt; &lt;local-path&gt;
              Copy the file indicated by client-path  at  the  client  to  local-path  at  the  monitor.  Again,
              client-path  must  be  the full path of an existing file on the client, local-path may either be a
              local directory, in which case the client’s file name  is  used,  or  another  file  name  may  be
              specified, in which case the client’s file is copied to the specified local filename. If the local
              file already exists, it is overwritten by the copy-procedure.

              Example:
              GET NOTEST <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a> <a href="file:/tmp">/tmp</a>
              The  program  <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a>,  available  at  the  client,  is  copied  to  the monitor’s <a href="file:/tmp">/tmp</a>
              directory. Remaining commands in the policy file are executed, even if the copying process  wasn’t
              successful.

       The PUT command may be used as follows:

       o      <b>PUT</b> &lt;local-path&gt; &lt;remote-path&gt;
              Copy  the  file  indicated by local-path at the monitor to remote-path at the client. The argument
              local-path must be the full path of an existing file on the monitor. The argument remote-path must
              be the full path to a file on the client. If the remote file already exists, it is overwritten  by
              PUT.

              Example:
              PUT /tmp/sha256sum <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a>
              The   program   /tmp/sha256sum,   available   at   the   monitor,  is  copied  to  the  client  as
              usr/bin/sha256sum. If the copying fails, <b>stealth</b> terminates.

       o      <b>PUT</b> <b>NOTEST</b> &lt;local-path&gt; &lt;remote-path&gt;
              Copy the file indicated by local-path at the monitor to remote-path at the  client.  The  argument
              local-path must be the full path of an existing file on the monitor. The argument remote-path must
              be  the full path to a file on the client. If the remote file already exists, it is overwritten by
              PUT.

              Example:
              PUT NOTEST /tmp/sha256sum <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a>
              Copy the file indicated by local-path at the monitor to remote-path at the  client.  The  argument
              local-path must be the full path of an existing file on the monitor. The argument remote-path must
              be  the full path to a file on the client. If the remote file already exists, it is overwritten by
              PUT. Remaining commands in the policy file are  executed,  even  if  the  copying  process  wasn’t
              successful.

       Plain  commands can be executed on the client computer by merely specifying them. Of course, this implies
       that programs on the client which are named, e.g., LABEL, LOCAL or USE, cannot be executed,  since  these
       names  are  interpreted  otherwise  by  <b>stealth</b>.  It’s  unlikely that this restriction presents much of a
       problem....

       The following commands are available for execution on the client:

       o      &lt;command-path&gt;
              Execute command-path on the client using the <b>SSH</b> command shell (it is strongly advised to  specify
              a  full  path  to the command to execute). The command must succeed (i.e., must return a zero exit
              value). However, any output generated by the the command is ignored.
              Example:
              <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?find">/usr/bin/find</a> <a href="file:/tmp">/tmp</a> -type f -exec <a href="file:/bin/rm">/bin/rm</a> {} \;
              This command removes all ordinary files in and below the client’s <a href="file:/tmp">/tmp</a> directory.

       o      <b>NOTEST</b> &lt;command-path&gt;
              Execute command-path on the client, using the <b>SSH</b> command  shell.  The  command  may  or  may  not
              succeed.
              Example:
              NOTEST <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?find">/usr/bin/find</a> <a href="file:/tmp">/tmp</a> -type f -exec <a href="file:/bin/rm">/bin/rm</a> {} \;
              Same as the previous command, but this time the exit value of <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?find">/usr/bin/find</a> is not interpreted.

       o      <b>CHECK</b> [<b>LOG</b> <b>=</b>] &lt;file-spec&gt;  [pathOffset] &lt;command-path&gt;
              Execute command-path on the client, using the <b>SSH</b> command shell.

              The  phrase  <b>LOG</b>  <b>=</b>  is  optional. When a relative file location is specified at &lt;file-spec&gt; it is
              interpreted relatively to the USE BASE path specification.

              PathOffset is also optional, and has the same meaning as for the LOCAL  CHECK  command,  described
              above.  The  command  must  succeed.  The output of this command is compared to the output of this
              command generated during the previous run of <b>stealth</b>. Any differences are written  to  <b>REPORT</b>.  If
              differences  were  found,  the  existing  logfile  name  is renamed to logfile.YYMMDD-HHMMSS, with
              YYMMDD-HHMMSS the datetime-stamp at the time <b>stealth</b> was run.

              Note that the command is executed on the client, but the logfile is  kept  on  the  monitor.  This
              command represents the core of the method implemented by <b>stealth</b>: there will be no residues of the
              actions performed by <b>stealth</b> on the client computers.

              Several examples (note the use of the backslash as line continuation characters):

              CHECK LOG = remote/ls.root \
              <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?find">/usr/bin/find</a> / \
              -xdev -perm /6111 -type f -exec <a href="file:/bin/ls">/bin/ls</a> -l {} \;

              All  suid/gid/executable files on the same device as the root-directory (/) on the client computer
              are listed with their permissions, owner and size information. The resulting listing is written on
              the file <b>BASE</b>/remote/ls.root.

              CHECK remote/sha256.root \
              <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?find">/usr/bin/find</a> / \
              -xdev -perm /6111 -type f -exec <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a> {} \;

              The SHA256 checksums of all suid/gid/executable files on the same device as the root-directory (/)
              on  the  client  computer  are  determined.   The  resulting  listing  is  written  on  the   file
              <b>BASE</b>/remote/sha256.root.

       o      <b>NOTEST</b> <b>CHECK</b> [<b>LOG</b> <b>=</b>] &lt;file-spec&gt; [pathOffset] &lt;command-path&gt;
              Execute command-path on the client, using the <b>SSH</b> command shell.

              The  phrase  <b>LOG</b>  <b>=</b>  is  optional. When a relative file location is specified at &lt;file-spec&gt; it is
              interpreted relatively to the USE BASE path specification.

              PathOffset is also optional, and has the same meaning as for the LOCAL  CHECK  command,  described
              above.  The  command  may or may not succeed. Otherwise, the program acts identically as the <b>CHECK</b>
              <b>...</b> command, described above.

              Example:
              NOTEST CHECK LOG = remote/sha256.root \
              <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?find">/usr/bin/find</a> / \
              -xdev -perm /6111 -type f -exec <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sha256sum">/usr/bin/sha256sum</a> {} \;

              The SHA256 checksums of all suid/gid/executable files on the same device as the root-directory (/)
              on  the  client  computer  are  determined.   The  resulting  listing  is  written  on  the   file
              <b>BASE</b>/remote/sha256.root.  <b>stealth</b>  does  not  terminate  if  the  <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?find">/usr/bin/find</a>  program returns a
              non-zero exit value.

       The maximum download size (using GET or CHECK) can be specified using the --max-size option,  see  below.
       By default this size is set at 10M.

</pre><h4><b>REPORT</b> <b>FILE</b> <b>ROTATION</b></h4><pre>
       Since  <b>stealth</b>  only appends information to the report file, the report file’s size may eventually become
       prohibitively large, and log-rotation may be desirable. It is of course possible to issue  a  --terminate
       command,  rotate  the  logfiles,  and  restart <b>stealth</b>, but <b>stealth</b> also offers a facility to temporarily
       suspend integrity scans performed by a <b>stealth</b> daemon process:

       o      Calling <b>stealth</b> with the option --suspend &lt;uds&gt; suspends the daemon’s integrity scans. If  <b>stealth</b>
              is  actually  performing  a  series  of  integrity  scans  when --suspend is issued, the currently
              executing command is first completed after which the --suspend command completes. Once the <b>stealth</b>
              daemon has been suspended, automatic or explicit integrity  scan  requests  are  denied,  and  the
              daemon  can  only  be  instructed  to  resume  its  scanning  tasks (<b>stealth</b> --resume &lt;uds&gt;) or to
              terminate (<b>stealth</b> --terminate &lt;uds&gt;).

       o      Once `<b>stealth</b> --suspend &lt;uds&gt;’ has returned, the report file may safely be rotated  (using,  e.g.,
              <b><a href="../man1/logrotate.1.html">logrotate</a></b>(1)), and a new (empty) report file may optionally be created by the logrotation process.

       o      Once  the  log-rotation  has  been  completed,  the  log-rotation process should issue the command
              `<b>stealth</b> --resume &lt;uds&gt;’. This resumes the activities  of  a  suspended  <b>stealth</b>  daemon  process,
              immediately  performing  the next integrity scan. Following this the <b>stealth</b> daemon is back to its
              original integrity scanning mode.  Here is  an  example  of  <b><a href="../man1/logrotate.1.html">logrotate</a></b>(1)  specification  rotating
              <b>stealth</b> log-files:

              /root/stealth/clienthost/small/report /var/log/stealth/clienthost-small.log {
                  daily
                  rotate 4
                  compress
                  missingok
                  copytruncate
                  sharedscripts
                  prerotate
                      /usr/bin/stealth --suspend /root/stealth/client/small.uds
                  endscript
                  postrotate
                      /usr/bin/stealth --resume /root/stealth/client/small.uds
                  endscript
              }

</pre><h4><b>RELOAD,</b> <b>RERUN</b> <b>AND</b> <b>TERMINATE</b></h4><pre>
       Here is what happens when <b>stealth</b> is run using the third synopsis:

       o      When started as <b>stealth</b> --reload &lt;uds&gt;, the <b>stealth</b> daemon process reloads its policy file and (if
              specified)  --skip-files  specification  file.  Next  the  <b>stealth</b>  daemon process performs a file
              integrity scan using the information in the re-read  policy  and  skip-files  files.  <b>Stealth</b>  can
              reload  the  (modified)  contents  of  the  originally  specified policy- and skip-files names. If
              another policy and/or skip-files files must be used another <b>stealth</b> process must be  started,  for
              which these new filenames are specified.

       o      When  started  as  <b>stealth</b>  --rerun &lt;uds&gt;, the <b>stealth</b> daemon performs another scan (unless it has
              been suspended using <b>stealth</b> --suspend &lt;uds&gt;).

       o      When started as <b>stealth</b> --terminate &lt;uds&gt;, the <b>stealth</b> daemon is terminated.

</pre><h4><b>RSYSLOG</b> <b>FILTERING</b></h4><pre>
       When using <b><a href="../man1/rsyslogd.1.html">rsyslogd</a></b>(1) property based filters may be used to filter syslog messages and write them  to  a
       file of your choice. E.g., to filter messages starting with the syslog message tag (e.g., STEALTH) use

       :syslogtag, isequal, "STEALTH:"   /var/log/stealth.log
       :syslogtag, isequal, "STEALTH:"   stop

       Note that the colon is part of the tag, but is not specified with the syslog-tag option.

       This  causes  all messages having the STEALTH: tag to be written on /var/log/stealth.log after which they
       are     discarded.     More     extensive     filtering     is     also     supported,     see,     e.g.,
       <a href="http://www.rsyslog.com/doc/rsyslog_conf_filter.html">http://www.rsyslog.com/doc/rsyslog_conf_filter.html</a> and <a href="http://www.rsyslog.com/doc/property_replacer.html">http://www.rsyslog.com/doc/property_replacer.html</a>

       Time  stamps  written by rsyslogd are not controlled by <b>stealth</b>’s --time-stamp option, but, e.g., by a TZ
       specification in /etc/default/rsyslog. Simply add the line
           export TZ=UTC
       to /etc/default/rsyslog, followed by restarting rsyslogd configures  rsyslogd  to  generate  time  stamps
       using UTC.

</pre><h4><b>DEPLOYMENT</b> <b>SUMMARY</b></h4><pre>
       The  following  summarizes  the  advised  steps  to  perform when installing stealth. All these steps are
       elaborated upon in <b>stealth</b>’s <u>User</u> <u>Guide</u> (chapter <u>Running</u> <u>`stealth’</u>):

       o      Install <b>stealth</b> (e.g., use <b><a href="../man1/dpkg.1.html">dpkg</a></b>(1) to install the <b>.deb</b> file);

       o      Construct one or more policy files;

       o      Automate (re)starting <b>stealth</b> using <b><a href="../man1/cron.1.html">cron</a></b>(1) or <b><a href="../man1/ssh-cron.1.html">ssh-cron</a></b>(1) (possibly calling <b>stealthcron</b>);

       o      Set up automated log-file rotation, using, e.g., <b>stealthcleanup</b> and <b><a href="../man1/logrotate.1.html">logrotate</a></b>(1), defining one  or
              more /etc/logrotate.d/stealth... configuration files.

</pre><h4><b>FILES</b></h4><pre>
       /usr/share/doc/stealth/;
       the policy file;
       files under the <b>BASE</b> directory as defined in the policy file;
       the report file as defined by the policy’s <b>USE</b> <b>REPORT</b> directive.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/cron.1.html">cron</a></b>(1),  <b><a href="../man1/dd.1.html">dd</a></b>(1),  <b><a href="../man1/diff.1.html">diff</a></b>(1),  <b><a href="../man1/dpkg.1.html">dpkg</a></b>(1),  <b><a href="../man1/find.1.html">find</a></b>(1),  <b><a href="../man1/logrotate.1.html">logrotate</a></b>(1),  <b><a href="../man1/ls.1.html">ls</a></b>(1),  <b><a href="../man1/mail.1.html">mail</a></b>(1),  <b><a href="../man1/sha256sum.1.html">sha256sum</a></b>(1), <b><a href="../man5/passwd.5.html">passwd</a></b>(5),
       <b><a href="../man1/rsyslog.1.html">rsyslog</a></b>(1), <b><a href="../man1/sendmail.1.html">sendmail</a></b>(1), <b><a href="../man1/sh.1.html">sh</a></b>(1), <b><a href="../man1/ssh.1.html">ssh</a></b>(1), <b><a href="../man1/ssh-cron.1.html">ssh-cron</a></b>(1)

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       By default, executed commands are echoed to stderr. Use <b>-q</b> to suppress this echoing.

</pre><h4><b>BUGS</b></h4><pre>
       None reported

</pre><h4><b>COPYRIGHT</b></h4><pre>
       This is free software, distributed under the terms of the `GNU General Public License’. Copyright remains
       with the author. <b>Stealth</b> is found at https://fbb-git.gitlab.io/stealth/.

</pre><h4><b>ORGANIZATION</b></h4><pre>
       University of Groningen.

</pre><h4><b>AUTHOR</b></h4><pre>
           Frank B. Brokken (<b><a href="mailto:f.b.brokken@rug.nl">f.b.brokken@rug.nl</a></b>).

stealth_4.03.03                                     2005-2022                                         <u><a href="../man1/stealth.1.html">stealth</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>