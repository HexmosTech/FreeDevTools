<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>r.mfilter  - Performs raster map matrix filter.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/grass-doc">grass-doc_8.4.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>r.mfilter</b>  - Performs raster map matrix filter.

</pre><h4><b>KEYWORDS</b></h4><pre>
       raster, algebra, statistics, filter, parallel

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>r.mfilter</b>
       <b>r.mfilter</b> <b>--help</b>
       <b>r.mfilter</b>  [-<b>z</b>]  <b>input</b>=<u>name</u> <b>output</b>=<u>name</u> <b>filter</b>=<u>name</u>  [<b>repeat</b>=<u>integer</u>]   [<b>title</b>=<u>string</u>]   [<b>nprocs</b>=<u>integer</u>]
       [--<b>overwrite</b>]  [--<b>help</b>]  [--<b>verbose</b>]  [--<b>quiet</b>]  [--<b>ui</b>]

   <b>Flags:</b>
       <b>-z</b>
           Apply filter only to null data values

       <b>--overwrite</b>
           Allow output files to overwrite existing files

       <b>--help</b>
           Print usage summary

       <b>--verbose</b>
           Verbose module output

       <b>--quiet</b>
           Quiet module output

       <b>--ui</b>
           Force launching GUI dialog

   <b>Parameters:</b>
       <b>input</b>=<u>name</u> <b>[required]</b>
           Name of input raster map

       <b>output</b>=<u>name</u> <b>[required]</b>
           Name for output raster map

       <b>filter</b>=<u>name</u> <b>[required]</b>
           Path to filter file

       <b>repeat</b>=<u>integer</u>
           Number of times to repeat the filter
           Default: <u>1</u>

       <b>title</b>=<u>string</u>
           Output raster map title

       <b>nprocs</b>=<u>integer</u>
           Number of threads for parallel computing
           Default: <u>1</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>r.mfilter</u> filters the raster <u>input</u> to produce the raster <u>output</u> according to the matrix  <u>filter</u>  designed
       by the user (see <u>FILTERS</u> below).

       <u>Figure:</u> <u>Illustration</u> <u>for</u> <u>a</u> <u>custom</u> <u>3x3</u> <u>filter</u>

       The  filter  is  applied  <u>repeat</u>  times (default <u>value</u> is 1).  The <u>output</u> raster map layer can be given a
       <u>TITLE</u> if desired.  (This TITLE should be put in quotes if it contains more than one word.)

       With <b>-z</b> flag the filter is applied only to null values in the  input  raster  map  layer.   The  non-null
       category  values  are not changed.  Note that if there is more than one filter step, this rule is applied
       to the intermediate raster map layer -- only null category values which result from the first filter will
       be changed.  In most cases this will NOT be the desired result. Hence -z should be used only with  single
       step filters.

       The  <b>filter</b>  parameter  defines the name of an existing, user-created UNIX ASCII file whose contents is a
       matrix defining the way in which the <u>input</u> file will be filtered. The format of this  file  is  described
       below, under FILTERS.

       The <b>repeat</b> parameter defines the number of times the <u>filter</u> is to be applied to the <u>input</u> data.

   <b>FILTERS</b>
       The <u>filter</u> file is a normal UNIX ASCII file designed by the user.  It has the following format:
            TITLE      TITLE
            MATRIX     n
                         .
            n lines of n values
                         .
            DIVISOR    d
            TYPE        S/P

       TITLE
           A  one-line  TITLE  for  the  filter.   If  a  TITLE was not specified on the command line, it can be
           specified here.  This TITLE would be used to construct a TITLE for the resulting  raster  map  layer.
           It should be a one-line description of the filter.

       MATRIX
           The matrix (n x n) follows on the next n lines.  <u>n</u> must be an odd integer greater than or equal to 3.
           The matrix itself consists of n rows of n values.  The values must be separated from each other by at
           least 1 blank.

       DIVISOR
           The  filter  divisor is <u>d</u>.  If not specified, the default is 1.  If the divisor is zero (0), then the
           divisor is dependent on the category values in the neighborhood (see HOW THE FILTER WORKS below).

       TYPE
           The filter type.  <u>S</u> means sequential, while <u>P</u> mean parallel.  If not specified, the default is S.

       Sequential filtering happens in place.  As the filter is applied to the raster map  layer,  the  category
       values  that  were  changed  in neighboring cells affect the resulting category value of the current cell
       being filtered.

       Parallel filtering happens in such a way that the original raster map layer category values are  used  to
       produce the new category value.

       More  than  one  filter may be specified in the filter file.  The additional filter(s) are described just
       like the first.  For example, the following describes two filters:

   <b>EXAMPLE</b> <b>FILTER</b> <b>FILE</b>
             TITLE     3x3 average, non-null data only, followed by 5x5 average
            MATRIX    3
            1 1 1
            1 1 1
            1 1 1
            DIVISOR   0
            TYPE      P
            MATRIX    5
            1 1 1 1 1
            1 1 1 1 1
            1 1 1 1 1
            1 1 1 1 1
            1 1 1 1 1
            DIVISOR   25
            TYPE      P

   <b>HOW</b> <b>THE</b> <b>FILTER</b> <b>WORKS</b>
       The filter process produces a new category value  for  each  cell  in  the  input  raster  map  layer  by
       multiplying  the  category  values  of  the cells in the n x n neighborhood around the center cell by the
       corresponding matrix value and adding them together.  If a divisor is specified, the sum  is  divided  by
       this divisor.  (If a zero divisor was specified, then the divisor is computed for each cell as the sum of
       the MATRIX values where the corresponding input cell is non-null.)

       If  more  than  one  filter  step  is  specified, either because the repeat value was greater than one or
       because the filter file contained more than one matrix, these  steps  are  performed  sequentially.  This
       means  that  first  one filter is applied to the entire input raster map layer to produce an intermediate
       result; then the next filter is applied to  the  intermediate  result  to  produce  another  intermediate
       result;  and so on, until the final filter is applied.  Then the output cell is written.

   <b>PERFORMANCE</b>
       By  specifying  the  number  of  parallel  processes  with <b>nprocs</b> option, <u>r.mfilter</u> can run significantly
       faster, see benchmarks below.
       <u>Figure:</u> <u>Benchmark</u> <u>on</u> <u>the</u> <u>left</u> <u>shows</u> <u>execution</u>  <u>time</u>  <u>for</u>  <u>different</u>  <u>number</u>  <u>of</u>  <u>cells</u>  <u>for</u>  <u>9x9</u>  <u>matrix,</u>
       <u>benchmark</u>  <u>on</u> <u>the</u> <u>right</u> <u>shows</u> <u>execution</u> <u>time</u> <u>for</u> <u>16</u> <u>billion</u> <u>cells</u> <u>for</u> <u>different</u> <u>matrix</u> <u>sizes.</u> <u>(Intel</u> <u>Core</u>
       <u>i9-10940X</u> <u>CPU</u> <u>@</u> <u>3.30GHz</u> <u>x</u> <u>28)</u>

       Note that parallelization is implemented only for the parallel filter, not the sequential one.   To  take
       advantage of the parallelization, GRASS GIS needs to compiled with OpenMP enabled.

</pre><h4><b>NOTES</b></h4><pre>
       If  the  resolution  of the geographic region does not agree with the resolution of the raster map layer,
       unintended resampling of the original data may occur.  The user should be sure that the geographic region
       is set properly.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        <u>g.region,</u> <u>r.clump,</u> <u>r.neighbors,</u> <u>r.resamp.filter,</u>
       <u>Raster</u> <u>Parallelization</u> <u>with</u> <u>OpenMP</u>

</pre><h4><b>AUTHORS</b></h4><pre>
       Glynn Clements.  Based upon r.mfilter, by Michael Shapiro,  U.S.Army  Construction  Engineering  Research
       Laboratory.
       Aaron Saw Min Sern (OpenMP support).

</pre><h4><b>SOURCE</b> <b>CODE</b></h4><pre>
       Available at: r.mfilter source code (history)

       Accessed: Friday Apr 04 01:19:15 2025

       Main index | Raster index | Topics index | Keywords index | Graphical index | Full index

       Â© 2003-2025 GRASS Development Team, GRASS GIS 8.4.1 Reference Manual

GRASS 8.4.1                                                                                    <u><a href="../man1grass/r.mfilter.1grass.html">r.mfilter</a></u>(1grass)
</pre>
 </div>
</div></section>
</div>
</body>
</html>