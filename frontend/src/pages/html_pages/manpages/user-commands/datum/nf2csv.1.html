<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nf2csv - iptables to CSV data</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/psad">psad_2.4.6-3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>nf2csv</b> - iptables to CSV data

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>nf2csv</b> <b>[options]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>nf2csv</b> Parses iptables log messages and generates comma-separate value formatted data.  This is useful to
       provide  input  to  the  <b>AfterGlow</b> project (see <a href="http://afterglow.sourceforge.net">http://afterglow.sourceforge.net</a>) so iptables logs can be
       visualized graphically.  An interesting application of <b>nf2csv</b> and <b>AfterGlow</b> is to parse and visualize the
       iptables logfiles made available by the Honeynet project in their Scan  of  the  Month  challenges.   The
       Scan30      and      Scan34      challenges      (see      <a href="http://www.honeynet.org/scans/scan30/">http://www.honeynet.org/scans/scan30/</a>      and
       <a href="http://www.honeynet.org/scans/scan34/">http://www.honeynet.org/scans/scan34/</a>)  contain  extensive  iptables   logfiles,   and   some   graphical
       representations  of these can be viewed here: <a href="http://www.cipherdyne.org/psad/honeynet/">http://www.cipherdyne.org/psad/honeynet/</a>.  The <b>psad</b> program
       also has the ability to generate CSV data from iptables logs with its <u>--CSV</u> mode.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-f</b>, <b>--fields</b> <b>&lt;tokens&gt;</b>
              Specify the set of fields that should be printed from iptables log messages. The most common usage
              of this argument is <b>SRC</b> <b>DST</b> <b>DPT</b> to print the source and destination IP addresses, followed by  the
              destination  port  number.  Available fields to print include: SRC, SPT, DST, DPT, PROTO, LEN, IN,
              TOS, TTL, SEQ, ID, TYPE, CODE (and these can also be referred to  as  src,  dst,  sp,  dp,  proto,
              ip_len, intf, tos, and ttl).  There are several additional fields that are not given specific tags
              within iptables log messages, and these can be included by specifying one of the following: flags,
              top_opts,  ip_opts,  chain,  log_prefix,  frag_bit,  src_mac, dst_mac, and udp_len.  Each of these
              fields accepts a search criteria in the form of a numeric comparison, string match, or  IP  match.
              See the EXAMPLES section below for more information.

       <b>-u</b>, <b>--unique-lines</b>
              Only print unique output lines.  This can drastically reduce the output of <b>nf2csv</b> depending on the
              characteristics of the iptables logfile that is being parsed.

       <b>-m</b>, <b>--max-lines</b> <b>&lt;num&gt;</b>
              Specify  the  maximum number of output lines <b>nf2csv</b> will generate.  This is useful for providing a
              limited set of data to AfterGlow in order to make visualizations more clear and less cluttered.

       <b>-r</b>, <b>--regex</b> <b>&lt;regex&gt;</b>
              Specify a regular expression that must match against the entire iptables log message in order  for
              it  to be included within the CSV output.  This allows log messages to be included from the output
              with all of the flexibility of regular expressions.  See  the  EXAMPLES  section  below  for  more
              information.

       <b>-n</b>, <b>--neg-regex</b> <b>&lt;regex&gt;</b>
              Specify  a regular expression that must not match against the iptables log message in order for it
              to be included within the CSV output.  This allows log messages to be  excluded  from  the  output
              with  all  of  the  flexibility  of  regular expressions.  See the EXAMPLES section below for more
              information.

       <b>-s</b>, <b>--start-line</b> <b>&lt;line&gt;</b>
              Specify the starting line where <b>nf2csv</b> begins to process iptables log data.  If you are processing
              a huge file with thousands of iptables log messages this option can be useful to parse a  specific
              chunk of this data.  Also see the <u>--end-line</u> option below.

       <b>-e</b>, <b>--end-line</b> <b>&lt;line&gt;</b>
              Specify the last line of iptables log data that <b>nf2csv</b> will parse.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The  following  examples  illustrate the command line arguments that could be supplied to <b>nf2csv</b> in a few
       situations:

       Print source and destination IP addresses and the destination port number:

       <b>$</b> <b>nfcsv</b> <b>-f</b> <b>src</b> <b>dst</b> <b>dp</b>

       Same as above, but now require that the source IP come from the 11.11.11.0/24 subnet:

       <b>$</b> <b>nfcsv</b> <b>-f</b> <b>src:11.11.11.0/24</b> <b>dst</b> <b>dp</b>

       Display instances of the MyDoom worm:

       <b>$</b> <b>nfcsv</b> <b>-f</b> <b>src</b> <b>dst</b> <b>dp:3127</b>

       Display packets that have low TTL values:

       <b>$</b> <b>nfcsv</b> <b>-f</b> <b>src</b> <b>dst</b> <b>ttl:&lt;10</b>

       Display all traffic to or from the host 11.11.11.67 (this sets up an OR condition between the src and dst
       fields):

       <b>$</b> <b>nfcsv</b> <b>-f</b> <b>src</b> <b>dst</b> <b>dp</b> <b>-r</b> <b>11.11.11.67</b>

       Display likely instances of Window Messenger popup spam attempts (note the use of the --regex argument to
       require minimal lengths on the UDP length field and source port, but the output contains the  destination
       port of 1026):

       <b>$</b> <b>nfcsv</b> <b>-f</b> <b>src</b> <b>dst</b> <b>dp</b> <b>-r</b> <b>SPT={4}.*LEN=[4-9]{2}</b>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/psad.8.html">psad</a></b>(8)

</pre><h4><b>AUTHOR</b></h4><pre>
       Michael Rash &lt;<a href="mailto:mbr@cipherdyne.org">mbr@cipherdyne.org</a>&gt;

</pre><h4><b>BUGS</b></h4><pre>
       Send bug reports to <a href="mailto:mbr@cipherdyne.org">mbr@cipherdyne.org</a>.  Suggestions and/or comments are always welcome as well.

</pre><h4><b>DISTRIBUTION</b></h4><pre>
       <b>nf2csv</b>  is  distributed  with  the  psad  project (<a href="http://www.cipherdyne.org/psad/">http://www.cipherdyne.org/psad/</a>) under the GNU General
       Public License (GPL), and the latest version may be downloaded from <b><a href="http://www.cipherdyne.org/">http://www.cipherdyne.org/</a></b>

Linux                                               Jun, 2006                                          <u><a href="../man1/NF2CSV.1.html">NF2CSV</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>