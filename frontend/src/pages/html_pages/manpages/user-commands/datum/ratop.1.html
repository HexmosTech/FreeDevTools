<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ratop - display and update sorted network flow data</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/argus-client">argus-client_3.0.8.2-6.2ubuntu5_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>ratop</b> - display and update sorted network flow data

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ratop</b> <b>[raoptions]</b> <b>[--</b> <u>filter-expression</u><b>]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Ratop</b>  reads  <b><a href="../man8/argus.8.html">argus</a>(8)</b> data from an <u>argus-file</u>, or from a remote data source, and periodically displays a
       sorted list of network flow records.  When read from a file, <b>ratop</b> displays  the  resulting  flow  caches
       when  the  file is completed, updating its status display line with each input.  When reading from a live
       argus data stream, <b>ratop</b> will display data, asynchronously in  realtime,  as  it  is  received  from  the
       source.

       Flow  data  is  aggregated  as  its  read, (see <b>racluster.1</b>), resulting in a single line for each network
       transaction encountered in the data stream.  The default sorting key is total packets per flow, but other
       keys can be used instead.  Flow records that have been idle for more than the default  60s  are  removed.
       Various  output  options,  such as the specific columns of data to display, the entry idle timeout value,
       the screen refresh rate, etc ... are all configurable.

       <b>ratop</b> uses <b>ncurses</b> and <b>readline.3</b>, when available, to provide  a  <b>vi.1</b>  look  and  feel  for  displaying,
       navigating and modifying network flow data.

       While running <b>ratop</b> a lot of help can be obtained from the on-line help system, using the ":h" command.

</pre><h4><b>OPTIONS</b></h4><pre>
       Command  line option specifications are processed from left to right.  Options can be specified more than
       once.  If conflicting options are specified, later specifications override earlier ones.  This  makes  it
       viable to create a shell alias for <b>ratop</b> with preferred defaults specified, then override those preferred
       defaults as desired on the command line.

       <b>ratop</b>,  like  all  ra  based  clients, supports a number of <b>ra</b> <b>options</b> including filtering of input argus
       records through a terminating filter expression, and the ability to specify the output style, format  and
       contents  for  printing  data.   See  <b><a href="../man1/ra.1.html">ra</a>(1)</b>  for a complete description of <b>ra</b> <b>options</b>.  <b><a href="../man1/ratop.1.html">ratop</a>(1)</b> specific
       options are:

       <b>-m</b> <u>aggregation</u> <u>object</u>
           Supported aggregation objects are:
              <b>none</b>           use a null flow key.
              <b>srcid</b>          argus source identifier.
              <b>smac</b>           source mac(ether) addr.
              <b>dmac</b>           destination mac(ether) addr.
              <b>soui</b>           oui portion of the source mac(ether) addr.
              <b>doui</b>           oui portion of the destination mac(ether) addr.
              <b>smpls</b>          source mpls label.
              <b>dmpls</b>          destination label addr.
              <b>svlan</b>          source vlan label.
              <b>dvlan</b>          destination vlan addr.
              <b>saddr/[l|m]</b>    source IP addr/[cidr len | m.a.s.k].
              <b>daddr/[l|m]</b>    destination IP addr/[cidr len | m.a.s.k].
              <b>matrix/l</b>       sorted src and dst IP addr/cidr len.
              <b>proto</b>          transaction protocol.
              <b>sport</b>          source port number. Implies use of 'proto'.
              <b>dport</b>          destination port number. Implies use of 'proto'.
              <b>stos</b>           source TOS byte value.
              <b>dtos</b>           destination TOS byte value.
              <b>sttl</b>           src -&gt; dst TTL value.
              <b>dttl</b>           dst -&gt; src TTL value.
              <b>stcpb</b>          src -&gt; dst TCP base sequence number.
              <b>dtcpb</b>          dst -&gt; src TCP base sequence number.
              <b>inode[/l|m]]</b>   intermediate node IP addr/[cidr len | m.a.s.k], source of ICMP mapped events.
              <b>sco</b>            source ARIN country code, if present.
              <b>dco</b>            destination ARIN country code, if present.
              <b>sas</b>            source node origin AS number, if available.
              <b>das</b>            destination node origin AS number, if available.
              <b>ias</b>            intermediate node origin AS number, if available.

       <b>-M</b> <u>modes</u>
           Supported modes are:
              <b>correct</b>        Attempt to correct the direction of flows by also searching the reverse  flow  key,
                             if  a  match  isn't  found in the cache.  This mode is on by default when using the
                             default full 5-tuple flow key definitions.
              <b>nocorrect</b>      Turn off flow correction for direction.  This mode is used by default if  the  flow
                             key has been changed.
              <b>preserve</b>       Preserve fields when aggregating matching flow data.
              <b>nopreserve</b>     Do not preserve fields when aggregating matching flow data.
              <b>norep</b>          Do  not generate an aggregate statistic for each flow.  This is used primarily when
                             the output represents a single object.  Primarily used when merging status  records
                             to generate single flows that represent single transactions.
              <b>rmon</b>           Generate data suitable for producing RMON types of metrics.
              <b>nocurses</b>       Do not use the curses interface to present data. This option is primarily used when
                             debugging  ratop, to get around the issues of screen maniuplation within a debugger
                             like gdb or lldb.

</pre><h4><b>DISPLAY</b></h4><pre>
       The first several lines of the <b>ratop</b> display show global state. The top line shows how ratop is  running,
       with  the list of command line options that are in effect.  In the upper most right corner is the current
       time.  The next line is the column title line, that labels each column.  The bottom line is  the  command
       line,  where  you  will see and prepare ':' commands.  The line above the bottom line is the status line,
       showing the number of flows that are in the <b>ratop</b> process queue, display queue, the total number of flows
       read, the rate of flow records read, and the current status, whether it is Active,  reading  records,  or
       Idle, when all input is complete.  This line can be toggled on or off using ^G.

       Flows  caches  are  displayed one per row and are sorted by total pkts, by default.  <b>ratop</b> sorting can be
       configured using the <u>rarc</u> variable RA_SORT_ALGORITHMS, or by using the ":P" command.

       <b>ratop</b> supports 3 basic filters.  Like all other ra* programs, <b>ratop</b> will send its command line filter  to
       its  remote argus data sources, to limit the load on the wire.  This is the "remote" filter.  Also, <b>ratop</b>
       supports a "local" filter, that is applied to flow record input.  Normally this is used when  the  remote
       argus  data  source  doesn't  support  the syntax of the specific filter.  <b>ratop</b> also support a "display"
       filter, that is used to select which flow records are to be displayed.  This filter  does  not  have  any
       impact  on the internal flow caches that <b>ratop</b> is tracking, so you can change the "display" filter at any
       time and see the current state of other flows.

</pre><h4><b>COLOR</b></h4><pre>
       <b>ratop</b> supports color which is configured using the rarc file.  The RA_COLOR_CONFIG file is a fall through
       specification of flow filters and field color definitions.  For  flows  that  match  a  filter,  specific
       fields  in the row will be painted the configured color.  Because the filter specification supports the "
       cont " directive, a single row can be painted by any number of color definitions.

       When color is enabled <b>ratop</b> will attempt to color IP addresses to indicate that local host  address,  and
       the  local  network.   This  is very helpful in mobile host installations, where you may not know what IP
       address has been assigned the localhost.  <b>ratop</b> also supports  coloring  local  addresses  based  on  the
       RA_LOCAL rarc variable.

       See racolor.conf.5.

</pre><h4><b>ARGUS</b> <b>EVENTS</b></h4><pre>
       Introduced in argus-3.0.8, <b>ratop</b> supports correlating specific ARGUS_EVENT data with flow data, which can
       be  turned  on  through  the use of the RA_CORRELATE_EVENTS rarc variable.  <b>ratop</b> will process argus-lsof
       event data generated by host bourne argi, and label flow data with user, pid and process  name  metadata.
       While  experimental,  it  is  production  level functionality, and can be used with other ra* programs to
       enhance flow data with host os process information.  See argus-3.0.8 documentation on ARGUS_EVENTS.

</pre><h4><b>EXAMPLES</b></h4><pre>
       ratop -r argus.file -s rank stime dur:14 saddr daddr proto pkts bytes

              Read the file argus.file, and display the resulting aggregated and sorted list  of  flow  records,
              using the default sorting methods.

       ratop -S localhost
              Run ratop as a live display of realtime flow traffic.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man5/rarc.5.html">rarc</a>(5) <a href="../man1/racluster.1.html">racluster</a>(1) <a href="../man5/racluster.conf.5.html">racluster.conf</a>(5)

ratop 3.0.8                                     12 November 2007                                        <u><a href="../man1/RATOP.1.html">RATOP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>