<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>icmodmap - Initializes the maintenance of C++ projects using modules</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/icmake">icmake_13.02.00-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       icmodmap - Initializes the maintenance of C++ projects using modules

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>icmodmap</b> <u>[Options]</u> <u>[arg]</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Although  modules  have  already  been  available for quite some time, the Gnu <u>g++</u> compiler still shows a
       number of bugs related to C++  modules  (cf.  <u>https://gcc.gnu.org/bugzilla/show_bug.cgi?id=103524</u>).  It’s
       possible  that  you stumble across some of these (or new) bugs when using modules. The number of reported
       bugs is gradually reducing, and the current state of affairs at least allows you to gain some  experience
       in using modules.

       Modules  cannot  mutually  import  each  other. Consequently there’s always a linear, non-circular module
       hierarchy, which should be acknowledged  when  compiling  files  defining  and  using  modules.  <b>Icmodmap</b>
       determines this order and prepares the construction of programs using modules. Once <b>icmodmap</b> has done its
       job  your favorite build-utility can be used as before. Just make sure that compilation uses the same <b>C++</b>
       standard as used by <b>icmodmap</b>, and provide the <u>-fmodules-ts</u> compiler option when compiling source files.

       <b>Icmodmap</b> assumes that modules are defined in separate sub-directories. For your  own  documentation  it’s
       advised  that  filenames  containing  module  (and  partition)  interface  units  start  with  <u>mod</u> (e.g.,
       <u>modsupport.cc</u>. If a program defines two modules <u>First</u> and <u>Second</u>  (e.g.,  in  sub-directories  <u>first</u>  and
       <u>second</u>  and  <u>second/modsecond.cc</u>  imports  module  <u>First</u>  then  <u>first/modfirst.cc</u> must be compiled before
       compiling <u>second/modsecond.cc</u>. This requirement is handled by <b>icmodmap</b>. Once the source files  containing
       module interface units have been compiled the program’s remaining source files can be compiled as usual.

       By default <b>icmodmap</b> expect projects using modules to be organized this way:

       o      The  project’s  top-level  directory  contains  a  file  <u>CLASSES</u>,  where each line (ignoring (<b>C++</b>)
              comment) specifies the name of a sub-directory implementing one of the project’s components.  Each
              sub-directory can (but does not have to) define a module, a module partition, a class (not part of
              a module, but maybe using modules), or other (source) files, maybe using modules;

       o      If  the  project  defines a program, the project’s top-level directory contains source files (like
              <u>main.cc</u>) defining the <u>main</u> function. <b>Icmodmap</b> also recognizes  module interface units  defined  in
              the  top-level  directory  (but, for clarity, module interface units should probably be defined in
              their own sub-directories).

       o      Since partitions define sub-components of modules, consider defining partitions in sub-directories
              of their module asub-directories. When adopting this organization then  these  sub-sub-directories
              are specified in the <u>CLASSES</u> file. E.g.,

                  module
                  module/part1
                  module/part2

       o      Modules  and  partitions  may  define  classes  (preferably  one  class  per module, one class per
              partition). If so the member  functions  of  those  classes  can  be  defined  in  the  module  or
              partition’s directory.

       <b>Icmodmap</b>  inspects  each  directory  specified in the <u>CLASSES</u> file, including the top-level directory. It
       recognizes interface units and source files implementing module components. It ignores comment,  but  the
       individual parts of specifications can be separated by spaces or tabs but not by comment. E.g., <u>export</u> <u>/*</u>
       <u>*/</u> <u>module</u> <u>Support;</u> is not recognized.

       When  compiling  source  files  containing  interface  units  the  compiler  is called using at least the
       following options (see also the options <u>--colors,</u> <u>--extension</u> and <u>--subdir</u> in section <b>Options</b>):
           /bin/g++ ${ICMAKE_CPPSTD} -fmodules-ts -c -Wall
       If the environment variable ttICMAKE_CPP) standard is not defined then the <b>C++</b> standard used  by  default
       by the compiler is used. To define it use e.g., <u>export</u> <u>ICMAKE_CPPSTD=--std=c++26</u>.

</pre><h4><b>The</b> <b>program’s</b> <b>argument</b></h4><pre>
       The program’s argument can be omitted or it can be specified in various ways:

       o      when  not  specified  <b>icmodmap</b>  starts its mapping process, according to its default or explicitly
              specified options. E.g, when merely  calling  <b>icmodmap</b>  it  locates  the  project’s  source  files
              containing  interface  units,  determines their compilation order, and compiles those files in the
              determined order;

       o      when specified as <u>clean</u> the project’s <u>gcm.cache</u> sub-directory and  the  <u>gcm.cache</u>  soft-links  are
              removed.  Compiled  object files (e.g., files under <u>tmp/o</u> are not removed; removing those files is
              left to the used build-utility);

       o      when specified as - interface unit files are not compiled but their source file names are  written
              in the required compilation order to the standard output stream

       o      otherwise  <b>icmodmap</b>’s  argument  is a filename to receive the names of the source files that would
              have been written to the standard output stream when argument - would have been specified.

</pre><h4><b>OPTIONS</b></h4><pre>
       <u>Icmodmap</u> supports the following options:

       o      <b>--colors</b> (<b>-c</b>)
              by default the compiler is called using the option <u>-fdiagnostics-color=never</u>. When this option  is
              specified the compiler messages may use colors;

       o      <b>--dependencies</b> (<b>-d</b>)
              the  dependencies between modules is shown using this option. Module defining source files are not
              compiled. <b>Icmodmap’s</b> output may look like this:
                  Dependencies:
                     LOCAL module Square
                     LOCAL module DepSquare
                         imports LOCAL module Square

              indicating that modules <u>Square</u> and <u>DepSquare</u> are defined by the current project,  and  the  module
              <u>DepSquare</u> depends on the module <u>Square</u>.

              It’s  also  possible  that  modules  depend on modules defined by other projects. In that case the
              output may look like this:
                  Dependencies:
                     LOCAL module Square
                         imports EXTERN module RectAngle
                     LOCAL module DepSquare
                         imports LOCAL module Square
                     EXTERN module RectAngle

              In this example module <u>RectAngle</u> is a module made available by some other project. The local modue
              <u>DepSquare</u>, as before, depends on <u>Square</u>. In this example the <u>RectAngle.gcm</u> file must be  available
              in  the  project’s  <u>gcm.cache</u>  directory  before module <u>Square</u> can be compiled (it’s normally made
              available via a soft-link to the actual file);

       o      <b>--extension</b>=<u>ext</u> (<b>-x</b>)
              <u>ext</u> is the extension of the source files inspected by <b>icmodmap</b>. By default it is <u>.cc</u>;

       o      <b>--extern</b>=<u>arg</u> (<b>-e</b>)
              when modules depend on  externally  available  modules  then  the  locations  of  the  directories
              containing  those  <u>.gcm</u> files can be specified using this option. If those external <u>.gcm</u> files are
              all located in a single directory then the location of the that directory (absolute or relative to
              the current project’s top-level directory) can be specified by <u>arg</u>.

              If those external <u>.gcm</u> files are located in multiple  directories  then  the  locations  of  those
              directories  are  specified  in a file which is specified by <u>arg</u>. In this case each of <u>arg’s</u> lines
              specifies the location of an external directory, ignoring  empty lines and lines starting with <u>//</u>;

       o      <b>--help</b> (<b>-h</b>)
              Provides usage info, returning 0 to the operating system;

       o      <b>--ignore</b>=<u>list</u> (<b>-i</b>)
              use this option instead of using the <u>CLASSES</u> file. When using this  option  all  (one-level  deep)
              sub-directories  (and  the project’s top-level directory) are inspected except for those listed in
              the <u>list</u> argument. If <u>list</u> must specify multiple directories  then  surround  the  space-separated
              sub-directory names by quotes. To visit all sub-directories use <u>’’</u>;

       o      <b>--library</b>=<u>lib</u> (<b>-l</b>)
              <u>lib</u>  specifies  the  path  (relative  to  the  project’s  top-level directory) of a (library) file
              containing the project’s .o files. To determine whether source files defining interface units must
              be (re)compiled their timestamps are not only compared to the timestamps of their object files but
              also to the timestamp of the library;

       o      <b>--mark</b>=<u>arg</u> (<b>-m</b>)
              <u>arg</u> can be +, ++, or a filename. When this option is  used  interface  units  depending  on  other
              modified interface units are also compiled.

              If  <u>arg</u>  is  ++ then the last write times of <u>all</u> files implementing or using those interface units
              are set to the current time.

              If <u>arg</u> is neither + nor ++ then <u>arg</u> is the name of a file it receiving  the  names  of  the  files
              otherwise processed by ’++’;

       o      <b>--quiet</b>=<u>what</u> (<b>-q</b>)
              by  default the compiler calls and the dependencies are written to the std. output stream. Specify
              ’what’ as:
              c - to suppress showing the compiler commands;
              d - to suppress showing the dependencies;
              any other argument: both ’c’ and ’d’.
              <u>--verbose</u> suppresses --quiet;

       o      <b>--subdir</b> (<b>-s</b>)
              By default the project’s <u>tmp/o</u> sub-directory receives the compiled  interface  unit  files,  using
              their  <u>CLASSES’</u>  compilation  order  number prefix (e.g., <u>tmp/o/1modsquare.o,</u> <u>tmp/o/2modepquare.o,</u>
              <u>...</u>). When this options is specified the compiled files are located in the same  sub-directory  as
              their source files (in which case an order number prefix is not used);

       o      <b>--version</b> (<b>-v</b>)
              Displays <b>icmodmap</b>’s version.

       o      <b>--verbose</b> (<b>-V</b>)
              Shows  additional  output  when  determining the module compilation order and compiling the module
              definition files.

</pre><h4><b>EXAMPLE</b></h4><pre>
       The following program defines a module <u>Square</u> in its sub-directory <u>square</u>, containing  this  <u>modsquare.cc</u>
       file:

       export module Square;

       export
       {
           double square(double value);

           class Square
           {
               double d_amount;

               public:
                   Square(double amount = 0);          // initialize
                   void amount(double value);          // change d_amount
                   double amount() const;              // return d_amount

                   double lastSquared() const;         // returns g_squared
                   double square() const;              // returns sqr(d_amount)
           };
       }

       double g_squared;

       The  <u>main</u>  function  imports  the  <u>Square</u>  module  and  uses its facilities. It also imports the <u>iostream</u>
       module-compiled system header. That header is not inspected by <b>icmodmap</b>, and must be available before the
       <u>main.cc</u> file can be compiled. Here is the <u>main.cc</u> source file:

       import Square;
       import &lt;iostream&gt;;

       int main(int argc, char **argv)
       {
           std::cout &lt;&lt; "the square of " &lt;&lt; argc &lt;&lt; " is "
                                               &lt;&lt; square(argc) &lt;&lt; ’\n’;
           Square obj{12};
           std::cout &lt;&lt; "the square of 12 is " &lt;&lt; obj.square() &lt;&lt; "\n"
                       "the last computed square is " &lt;&lt;
                       obj.lastSquared() &lt;&lt; ’\n’;

       }

       Executing <u>icmodmap</u> <u>-d</u> shows <u>Square</u> as a local module:
           Dependencies:
              LOCAL module Square

       Executing <u>icmodmap</u> <u>-V</u> performs and shows the compilation of <u>square/module.cc</u> as well as the names of  the
       source files implementing (declaring) its components or merely importing the module:

           Defining a soft-link from gcm.cache/usr -&gt; <a href="file:/usr">/usr</a>
           Inspecting square/
              scanning square1.cc
                  declares module Square
              scanning amount1.cc
                  declares module Square
              scanning square.cc
                  declares module Square
              scanning square2.cc
                  declares module Square
              scanning modsquare.cc
                  defines module Square
              scanning amount2.cc
                  declares module Square
              scanning lastsquared.cc
                  declares module Square
           Inspecting ./
              scanning main.cc
                  imports module Square
           Compiling...
              in square: /bin/g++ --std=c++26 -fdiagnostics-color=never  -c
                   -fmodules-ts -Wall -o ../tmp/o/1modsquare.o modsquare.cc

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/icmake.1.html">icmake</a></b>(1).

</pre><h4><b>BUGS</b></h4><pre>
       None reported.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       This is free software, distributed under the terms of the GNU General Public License (GPL).

</pre><h4><b>AUTHOR</b></h4><pre>
       Frank B. Brokken (<b><a href="mailto:f.b.brokken@rug.nl">f.b.brokken@rug.nl</a></b>).

icmake.13.02.00                                     1992-2025                                        <u><a href="../man1/icmodmap.1.html">icmodmap</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>