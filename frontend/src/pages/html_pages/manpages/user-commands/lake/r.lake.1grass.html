<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>r.lake  - Fills lake at given point to given level.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/grass-doc">grass-doc_8.4.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>r.lake</b>  - Fills lake at given point to given level.

</pre><h4><b>KEYWORDS</b></h4><pre>
       raster, hydrology, hazard, flood

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>r.lake</b>
       <b>r.lake</b> <b>--help</b>
       <b>r.lake</b>  [-<b>no</b>]  <b>elevation</b>=<u>name</u>  <b>water_level</b>=<u>float</u>   [<b>lake</b>=<u>name</u>]    [<b>coordinates</b>=<u>east,north</u>]    [<b>seed</b>=<u>name</u>]
       [--<b>overwrite</b>]  [--<b>help</b>]  [--<b>verbose</b>]  [--<b>quiet</b>]  [--<b>ui</b>]

   <b>Flags:</b>
       <b>-n</b>
           Use negative depth values for lake raster map

       <b>-o</b>
           Overwrite seed map with result (lake) map

       <b>--overwrite</b>
           Allow output files to overwrite existing files

       <b>--help</b>
           Print usage summary

       <b>--verbose</b>
           Verbose module output

       <b>--quiet</b>
           Quiet module output

       <b>--ui</b>
           Force launching GUI dialog

   <b>Parameters:</b>
       <b>elevation</b>=<u>name</u> <b>[required]</b>
           Name of input elevation raster map

       <b>water_level</b>=<u>float</u> <b>[required]</b>
           Water level

       <b>lake</b>=<u>name</u>
           Name for output raster map

       <b>coordinates</b>=<u>east,north</u>
           Seed point coordinates
           Either this coordinates pair or a seed map have to be specified

       <b>seed</b>=<u>name</u>
           Input raster map with given starting point(s) (at least 1 cell &gt; 0)
           Either this parameter or a coordinates pair have to be specified

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>r.lake</u> fills a lake to a target water level from a given start point. The user can think of it as  <u>r.grow</u>
       with  additional  checks  for elevation. The resulting raster map contains cells with values representing
       lake depth and NULL for all other cells beyond the lake. Lake depth is  reported  relative  to  specified
       water level (specified level = 0 depth).

       This  module  uses a 3x3 moving window approach to find all cells that match three criteria and to define
       the lake:

           •   cells are below the specified elevation (i.e., water level);

           •   cells are connected with an initial cell (seed or coordinates pair value);

           •   cells are not NULL or masked.

       The water level must be in DEM units.

</pre><h4><b>NOTES</b></h4><pre>
       The seed (starting) point can be a raster map with at least one cell value greater than zero, or  a  seed
       point  can  be  specified  as  an E, N coordinate pair. If the seed is specified as a coordinate pair, an
       additional check is done to make sure that the target water level is above the level of the DEM.  When  a
       raster  map  is  used as a seed, however, no such checks are done.  Specifying a target water level below
       surface represented by DEM will result in an empty map. Note: a raster lake map created in a previous run
       can also be used as a seed map for a new run to simulate rising water levels.

       The module will create a new map (<b>lake=foo</b>) or can be set to replace the input (<b>seed=bar</b>) map if  the  <b>-o</b>
       flag  is  used.   The user can use <b>-o</b> flag to create animations of rising water level without producing a
       separate map for each frame.  An initial seed map must be created to start  the  sequence,  and  will  be
       overwritten  during subsequent runs with resulting water levels maps (i.e., a single file serves for both
       input and output).

       Negative output (the <b>-n</b> flag) is useful for visualisations in NVIZ.  It equals the  mapcalc’s  expression
       <u>"negative</u> <u>=</u> <u>0</u> <u>-</u> <u>positive"</u>.

   <b>r.mapcalc</b> <b>equivalent</b> <b>-</b> <b>for</b> <b>GRASS</b> <b>hackers</b>
       This  module  was initially created as a script using <u>r.mapcalc</u>.  This had some limitations - it was slow
       and no checks where done to find out required iteration count. The shell script  code  (using  <u>r.mapcalc</u>)
       used in the original script is shown below:
       ${seedmap} = if( ${dem}, \
       if( if( isnull(${seedmap}),0,${seedmap} &gt; 0), ${wlevel}-${dem}, \
        if( \
         if(isnull(${seedmap}[-1,0]),0, ${seedmap}[-1,0] &gt; 0 &amp;&amp; ${wlevel} &gt; ${dem}) ||\
         if(isnull(${seedmap}[-1,1]),0, ${seedmap}[-1,1] &gt; 0 &amp;&amp; ${wlevel} &gt; ${dem}) ||\
         if(isnull(${seedmap}[0,1]), 0, ${seedmap}[0,1] &gt; 0  &amp;&amp; ${wlevel} &gt; ${dem}) ||\
         if(isnull(${seedmap}[1,1]), 0, ${seedmap}[1,1] &gt; 0  &amp;&amp; ${wlevel} &gt; ${dem}) ||\
         if(isnull(${seedmap}[1,0]), 0, ${seedmap}[1,0] &gt; 0  &amp;&amp; ${wlevel} &gt; ${dem}) ||\
         if(isnull(${seedmap}[1,-1]),0, ${seedmap}[1,-1] &gt; 0 &amp;&amp; ${wlevel} &gt; ${dem}) ||\
         if(isnull(${seedmap}[0,-1]),0, ${seedmap}[0,-1] &gt; 0 &amp;&amp; ${wlevel} &gt; ${dem}) ||\
         if(isnull(${seedmap}[-1,-1]),0, ${seedmap}[-1,-1] &gt; 0 &amp;&amp; ${wlevel} &gt; ${dem}),\
        ${wlevel}-${dem}, null() )))

       The  ${seedmap}  variable  is  replaced  by  seed map names, ${dem} with DEM map name, and ${wlevel} with
       target water level. To get single water level, this code block is called with same level  numerous  times
       (in a loop) as the lake grows by single cells during single run.

</pre><h4><b>KNOWN</b> <b>ISSUES</b></h4><pre>
           •   The entire map is loaded into RAM.

           •   A  completely  negative  seed  map will not work! At least one cell must have a value &gt; 0. Output
               from r.lake -n <u>cannot</u> be used as input in the next run.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Example of small flooding along a street (North Carolina sample dataset):
       g.region raster=elev_lid792_1m -p
       # water accumulation next to street dam
       r.lake elev_lid792_1m coordinates=638759.3,220264.1 water_level=113.4 lake=flooding
       # draw resulting lake map over shaded terrain map
       r.relief input=elev_lid792_1m output=elev_lid792_1m_shade
       d.rast elev_lid792_1m_shade
       d.rast flooding
       d.vect streets_wake

       Small flooding along a street (<u>r.lake</u>, using Lidar 1m DEM)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        <u>r.mapcalc,</u> <u>r.grow,</u> <u>r.plane</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       Maris Nartiss (maris.nartiss gmail.com)

</pre><h4><b>SOURCE</b> <b>CODE</b></h4><pre>
       Available at: r.lake source code (history)

       Accessed: Friday Apr 04 01:19:14 2025

       Main index | Raster index | Topics index | Keywords index | Graphical index | Full index

       © 2003-2025 GRASS Development Team, GRASS GIS 8.4.1 Reference Manual

GRASS 8.4.1                                                                                       <u><a href="../man1grass/r.lake.1grass.html">r.lake</a></u>(1grass)
</pre>
 </div>
</div></section>
</div>
</body>
</html>