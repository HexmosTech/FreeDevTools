<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>buildah-unshare - Run a command inside of a modified user namespace.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/buildah">buildah_1.39.3+ds1-1syncable1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       buildah-unshare - Run a command inside of a modified user namespace.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>buildah</b> <b>unshare</b> [<u>options</u>] [<b>--</b>] [<u>command</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Launches  a  process  (by  default, <u>$SHELL</u>) in a new user namespace.  The user namespace is configured so
       that the invoking user's UID and primary GID appear to be UID 0 and  GID  0,  respectively.   Any  ranges
       which  match that user and group in <a href="file:/etc/subuid">/etc/subuid</a> and <a href="file:/etc/subgid">/etc/subgid</a> are also mapped in as themselves with the
       help of the <u><a href="../man1/newuidmap.1.html">newuidmap</a>(1)</u> and <u><a href="../man1/newgidmap.1.html">newgidmap</a>(1)</u> helpers.

       buildah unshare is useful for troubleshooting unprivileged operations and for manually  clearing  storage
       and other data related to images and containers.

       It  is  also useful if you want to use the <b>buildah</b> <b>mount</b> command.  If an unprivileged user wants to mount
       and work with a container, then they need to execute buildah unshare.  Executing <b>buildah</b> <b>mount</b> fails  for
       unprivileged users unless the user is running inside a <b>buildah</b> <b>unshare</b> session.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--mount</b>, <b>-m</b> [<u>VARIABLE=]containerNameOrID</u>

       Mount the <u>containerNameOrID</u> container while running <u>command</u>, and set the environment variable <u>VARIABLE</u> to
       the  path  of  the mountpoint.  If <u>VARIABLE</u> is not specified, it defaults to <u>containerNameOrID</u>, which may
       not be a valid name for an environment variable.

</pre><h4><b>EXAMPLE</b></h4><pre>
       buildah unshare id

       buildah unshare pwd

       buildah unshare cat <a href="file:/proc/self/uid_map">/proc/self/uid_map</a> <a href="file:/proc/self/gid_map">/proc/self/gid_map</a>

       buildah unshare rm -fr $HOME/.local/share/containers/storage <a href="file:/run/user/">/run/user/</a>`id -u`<a href="file:/run">/run</a>

       buildah unshare --mount containerID sh -c 'cat ${containerID}<a href="file:/etc/os-release">/etc/os-release</a>'

       If you want to use buildah with a mount command then you can create a script that looks something like:

       cat buildah-script.sh &lt;&lt; _EOF
       #!<a href="file:/bin/sh">/bin/sh</a>
       ctr=$(buildah from scratch)
       mnt=$(buildah mount $ctr)
       dnf -y install --installroot=$mnt PACKAGES
       dnf -y clean all --installroot=$mnt
       buildah config --entrypoint="/bin/PACKAGE" --env "FOO=BAR" $ctr
       buildah commit $ctr imagename
       buildah unmount $ctr
       _EOF

       Then execute it with:

       buildah unshare buildah-script.sh

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/buildah.1.html">buildah</a>(1), <a href="../man1/buildah-mount.1.html">buildah-mount</a>(1), <a href="../man7/namespaces.7.html">namespaces</a>(7), <a href="../man1/newuidmap.1.html">newuidmap</a>(1), <a href="../man1/newgidmap.1.html">newgidmap</a>(1), <a href="../man7/user_namespaces.7.html">user_namespaces</a>(7)

buildah                                             June 2018                                 <u><a href="../man1/buildah-unshare.1.html">buildah-unshare</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>