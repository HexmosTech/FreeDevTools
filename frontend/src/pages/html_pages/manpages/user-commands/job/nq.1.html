<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nq — job queue utility</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nq">nq_1.0-0.2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nq — job queue utility

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>nq</b> [<b>-c</b>] [<b>-q</b>] <u>command</u> <u>line</u> <u>...</u>
       <b>nq</b> <b>-t</b> <u>job</u> <u>id</u> <u>...</u>
       <b>nq</b> <b>-w</b> <u>job</u> <u>id</u> <u>...</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>nq</b>  utility  provides  a  very  lightweight  queuing  system  without  requiring setup, maintenance,
       supervision or any long-running processes.

       Job order is enforced by a timestamp <b>nq</b> gets immediately when started.  Synchronization happens on  file-
       system  level.   Timer  resolution  is milliseconds.  No sub-second file system time stamps are required.
       Polling is not used.  Exclusive execution is maintained strictly.

       You enqueue(!) new jobs into the queue by running

             <b>nq</b> <u>command</u> <u>line</u> <u>...</u>

       The job id (a file name relative to NQDIR, which defaults to the current  directory)  is  output  (unless
       suppressed  using  <b>-q</b>)  and <b>nq</b> detaches from the terminal immediately, running the job in the background.
       Standard output and standard error are redirected into the  job  id  file.   <u><a href="../man1/nqtail.1.html">nqtail</a></u>(1)  can  be  used  to
       conveniently watch the log files.

       The options are as follows:

       <b>-c</b>      Clean up job id file when process exited with status 0.

       <b>-q</b>      Suppress output of the job id after spawning new job.

       <b>-t</b>      Enter  <u>test</u>  <u>mode</u>:  exit with status 0 when <u>all</u> of the listed job ids are already done, else with
               status 1.

       <b>-w</b>      Enter <u>waiting</u> <u>mode</u>: wait in the foreground until <u>all</u> listed job ids are done.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       NQDIR      Directory where lock files/job output resides.  Each NQDIR can be considered a separate queue.
                  The current working directory is used when NQDIR is unset.  NQDIR is created if needed.

       NQDONEDIR  When set, specifies a directory (must be  on  the  same  file  system  as  NQDIR)  where  lock
                  files/job output is moved to after successful execution of the job.

                  Ignored when <b>-c</b> is used.

       NQFAILDIR  When  set,  specifies  a  directory  (must  be  on  the  same file system as NQDIR) where lock
                  files/job output is moved to after unsuccessful execution of the job.

       NQJOBID    The job id of the currently running job, exposed to the job itself.

</pre><h4><b>FILES</b></h4><pre>
       <b>nq</b> expects to control all files in NQDIR (respectively <u>.</u>) which start with “<b>,</b>” or “<b>.,</b>”.  These files  are
       created according to the following scheme:

             <b>,hexadecimal-time-stamp.pid</b>

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       The  <b>nq</b>  utility  exits  0 on success, and &gt;0 if an error occurs; unless <u>test</u> <u>mode</u> is used, in which case
       exit status 1 means there is a job running.

       On fatal errors, exit codes 111 and 222 are used.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Build <u><a href="../man1/make.1.html">make</a></u>(1) targets <b>clean</b>, <b>depends</b>, <b>all</b>, without occupying the terminal:

             % nq make clean
             % nq make depends
             % nq make all
             % nqtail
             ... look at output, can interrupt with C-c any time
             without stopping the build ...

       Simple download queue, accessible from multiple terminals:

             % alias qget='NQDIR=/tmp/downloads nq wget'
             % alias qwait='NQDIR=/tmp/downloads nqtail -q'
             window1% qget <a href="http://mymirror/big1.iso">http://mymirror/big1.iso</a>
             window2% qget <a href="http://mymirror/big2.iso">http://mymirror/big2.iso</a>
             window3% qget <a href="http://mymirror/big3.iso">http://mymirror/big3.iso</a>
             % qwait
             ... wait for all downloads to finish ...

       As <u><a href="../man1/nohup.1.html">nohup</a></u>(1) replacement (The benchmark will run in background, every run gets a  different  output  file,
       and the command line you ran is logged too.):

             % ssh remote
             remote% nq ./run-benchmark
             ,14f6f3034f8.17035
             remote% ^D
             % ssh remote
             remote% nqtail
             ... see output, nqtail exits when job finished ...

</pre><h4><b>TRICKS</b></h4><pre>
       The  "file  extension"  of  the  log file is actually the PID of the job.  <b>nq</b> runs all jobs in a separate
       process group, so you can kill an entire job process tree at once using  <u><a href="../man1/kill.1.html">kill</a></u>(1)  with  a  negative  PID.
       Before the job is started, it is the PID of <b>nq</b>, so you can cancel a queued job by killing it as well.

       Thanks  to  the  initial  <b>exec</b>  line  in the log files, you can resubmit a job by executing it as a shell
       command file, i.e. running

             <b>sh</b> <u>job</u> <u>id</u>

       Creating <b>nq</b> wrappers setting NQDIR to provide different queues for different purposes is encouraged.

</pre><h4><b>INTERNALS</b></h4><pre>
       Enforcing job order works like this:
       <b>-</b>   every job has an output file locked using <u><a href="../man2/flock.2.html">flock</a></u>(2) and named according to “FILES”.
       <b>-</b>   every job starts only after all earlier flocked files are unlocked.
       <b>-</b>   the lock is released by the kernel after the job terminates.

</pre><h4><b>ASSUMPTIONS</b></h4><pre>
       <b>nq</b> will only work correctly when:

       <b>-</b>   NQDIR (respectively <u>.</u>) is writable.

       <b>-</b>   <u><a href="../man2/flock.2.html">flock</a></u>(2) works correctly in NQDIR (respectively <u>.</u>).

       <b>-</b>   <u><a href="../man2/gettimeofday.2.html">gettimeofday</a></u>(2) behaves monotonic (using CLOCK_MONOTONIC would  create  confusing  file  names  after
           reboot).

       <b>-</b>   No other programs put files matching <b>,*</b> into NQDIR (respectively <u>.</u>).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/nqtail.1.html">nqtail</a></u>(1), <u><a href="../man1/nqterm.1.html">nqterm</a></u>(1).

       Alternatives to the <b>nq</b> system include <u><a href="../man1/batch.1.html">batch</a></u>(1), <u><a href="../man1/qsub.1.html">qsub</a></u>(1), <u><a href="../man1/schedule.1.html">schedule</a></u>(1), <u><a href="../man1/srun.1.html">srun</a></u>(1), and <u><a href="../man1/ts.1.html">ts</a></u>(1).

</pre><h4><b>AUTHORS</b></h4><pre>
       Leah Neukirchen &lt;<u><a href="mailto:leah@vuxu.org">leah@vuxu.org</a></u>&gt;

</pre><h4><b>CAVEATS</b></h4><pre>
       All  reliable queue status information is in main memory only, which makes restarting a job queue after a
       reboot difficult.

</pre><h4><b>LICENSE</b></h4><pre>
       <b>nq</b> is in the public domain.

       To the extent possible under law, the creator of this work  has  waived  all  copyright  and  related  or
       neighboring rights to this work.

       <a href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</a>

Debian                                            July 3, 2024                                             <u><a href="../man1/NQ.1.html">NQ</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>