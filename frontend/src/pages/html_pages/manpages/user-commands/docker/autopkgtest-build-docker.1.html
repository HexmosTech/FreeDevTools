<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>autopkgtest-build-docker,   autopkgtest-build-podman   -   Create   or   update   autopkgtest  image  for</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/autopkgtest">autopkgtest_5.47_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       autopkgtest-build-docker,   autopkgtest-build-podman   -   Create   or   update   autopkgtest  image  for
       autopkgtest-virt-docker, autopkgtest-virt-podman

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>autopkgtest-build-docker</b> [<u>options</u>] [<u>--</u> <u>extra</u> <u>docker-build</u> <u>args...</u>]

       <b>autopkgtest-build-podman</b> [<u>options</u>] [<u>--</u> <u>extra</u> <u>podman-build</u> <u>args...</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>autopkgtest-build-docker</b> creates or updates a Docker or Podman image which is suitable for  autopkgtest's
       Docker/Podman runner <b><a href="../man1/autopkgtest-virt-docker.1.html">autopkgtest-virt-docker</a></b>(1) or <b><a href="../man1/autopkgtest-virt-podman.1.html">autopkgtest-virt-podman</a></b>(1).

       When  run  as  <b>autopkgtest-virt-podman</b>  or  with  the  <b>--podman</b>  option (recommended), Podman is used for
       building images.  This can be done unprivileged.

       When run as <b>autopkgtest-virt-docker</b> or with the <b>--docker</b> option, Docker is  used.   This  requires  root-
       equivalent privileges on the host system.  Using Podman instead of Docker is recommended.

       The images produced by this tool are intended to be suitable for use with either Podman or Docker.

       The  image  used  for  testing  is  built  using  <b><a href="../man1/docker-build.1.html">docker-build</a></b>(1) or <b><a href="../man1/podman-build.1.html">podman-build</a></b>(1) from a base image or
       tarball, using a  recipe  that  adds  <b>deb-src</b>  apt  sources,  runs  <b>apt-get</b>  <b>update</b>  and  installs  build
       dependencies.

       If  the  <b>--tarball</b> option is used, the image used for testing is based on that tarball, and no base image
       is downloaded.

       Otherwise, it is based on a pre-existing base image.  The default is to download a  suitable  base  image
       for  the  detected or configured OS vendor from a third-party container registry.  The <b>--image</b> option can
       be used to select a different base image.

       You can specify an apt proxy to use in the container in the <b>--apt-proxy</b> parameter. If  you  have  an  apt
       proxy configured on the host, the container will automatically use this, otherwise there is no default.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-i</b> <u>image-name</u> <b>|</b> <b>--image=</b><u>image-name</u>
              Container  image  to use as base image.  The default is derived from the <b>--vendor</b> and <b>--release</b> by
              assuming that image names follow the same  pattern  as  the  semi-official  Debian  Docker  images
              (<b>debian:</b><u>RELEASE</u>)  and the official Ubuntu Docker images (<b>ubuntu:</b><u>RELEASE</u>).  If the <b>--tarball</b> option
              is also used, this option still affects the  default  <b>--tag</b>  but  no  base  image  is  downloaded.
              Otherwise,  the  image will be downloaded from a third-party container registry if required, using
              the same configuration and aliasing rules that are normally  used  by  <b><a href="../man1/docker-pull.1.html">docker-pull</a></b>(1)  or  <b><a href="../man1/podmanpull.1.html">podman-</a></b>
              <b><a href="../man1/podmanpull.1.html">pull</a></b>(1).    For   both   Debian   and   Ubuntu,   this   will   usually   result   in  downloading
              <b>docker.io/library/</b><u>VENDOR</u><b>:</b><u>RELEASE</u> from Docker Hub.

       <b>--vendor</b> <b>debian</b>|<b>ubuntu</b>|...
              Operating system vendor to use.  This is used to set defaults  for  parameters  like  <b>--image</b>  and
              <b>--mirror</b>.   The  default  is  to  guess  from  the <b>--release</b> if specified, or from the <b>--mirror</b> if
              specified, or use the <b>--image</b> as-is if specified, falling back to Debian if no image is specified.

       <b>-r</b> <u>release-name</u> <b>|</b> <b>--release=</b><u>release-name</u>
              Operating system release (suite) to use.  The default is to guess from the <b>--image</b>  if  specified,
              or use <b>unstable</b> for Debian, or use whatever image is tagged as <b>latest</b> for other vendors.

       <b>-t</b> <u>name</u>  <b>|</b> <b>--tag=</b><u>name</u>
              Image  name to tag the new image.  When using a base image, the default is to prepend <b>autopkgtest/</b>
              to the name of the base image, resulting in an image name like <b>autopkgtest/debian:unstable</b>.   When
              using  a <b>--tarball</b>, the default is to use a name based on the <b>--vendor</b> and <b>--release</b> (matching the
              default base image), again resulting in a name  like  <b>autopkgtest/debian:unstable</b>.   If  the  base
              image  starts with <b>localhost/</b>, that prefix is removed, to reduce repetition when using podman.  If
              the <b>--init</b> option is used, then the init system is also added to the default tag  name,  resulting
              in  an  image name like <b>autopkgtest/systemd/debian:unstable</b>.  When using Podman, if no destination
              registry  is  specified,  local  storage   will   be   assumed,   resulting   in   a   name   like
              <b>localhost/autopkgtest/debian:unstable</b>.

       <b>--init=systemd</b>|<b>sysv-rc</b>|<b>openrc</b>
              Add  the  specified  init system to the container image, so that it can be booted as a full-system
              container using a command like <b>podman</b>  <b>run</b>  <u>IMAGE</u>  <b><a href="file:/sbin/init">/sbin/init</a></b>  or  <b>autopkgtest-virt-podman</b>  <b>--init</b>
              <u>IMAGE</u>.   By  default,  whatever  init system is in the base image is kept, usually meaning no init
              system at all (so the container can be used to run individual shell commands, but cannot be booted
              like a full system and will not provide  the  <b>isolation-container</b>  autopkgtest  capability).   The
              presence  or  absence  of  an init system is recorded in the image's metadata so that <b><a href="../man1/autopkgtestvirt-podman.1.html">autopkgtest-</a></b>
              <b><a href="../man1/autopkgtestvirt-podman.1.html">virt-podman</a></b>(1) can automatically detect whether to enable or disable <b>--init</b>.

       <b>-m</b> <u>URL</u> <b>|</b> <b>--mirror=</b><u>URL</u>
              Mirror   for   apt.    The   default   is    <b><a href="http://deb.debian.org/debian/">http://deb.debian.org/debian/</a></b>    for    Debian,    or
              <b><a href="http://archive.ubuntu.com/ubuntu/">http://archive.ubuntu.com/ubuntu/</a></b>  for  Ubuntu, or whatever mirror is configured in the base image
              otherwise.

       <b>-p</b> <u>URL</u> <b>|</b> <b>--apt-proxy=</b><u>URL</u>
              Proxy for apt. If you have an apt proxy configured on the local host, the image will automatically
              use this; otherwise there is no default.

       <b>--post-command=</b><u>COMMAND</u>
              Run shell command in the image after the setup.

       <b>--tarball=</b><u>PATH</u> | <b>--tarball=-</b>
              Import a pre-prepared root filesystem tarball as generated by <b><a href="../man1/debootstrap.1.html">debootstrap</a></b>(1), <b><a href="../man1/mmdebstrap.1.html">mmdebstrap</a></b>(1)  or  a
              similar  tool,  and  use  it  as  the  root  filesystem of the container before adding autopkgtest
              customizations.  If this option is used, no base image is downloaded  from  third-party  container
              registries; the <b>--image</b> is used to choose the default <b>--tag</b> but is is otherwise ignored.

              In addition to Essential packages, <b>autopkgtest-virt-docker</b> currently requires at least the <b>apt</b> and
              <b>passwd</b>  packages  to  be  included,  so  the smallest suitable tarball is the output of <b>mmdebstrap</b>
              <b>--variant=apt</b> <b>--include=passwd</b> <u>RELEASE</u>.  It is more typical to use  a  <b>--variant=minbase</b>  tarball,
              which is also used as the basis for the <b>docker.io/library/debian:</b><u>RELEASE</u> images.

       You  can  pass  additional options to Docker or Podman: any positional arguments, or any arguments at all
       after a <b>--,</b> get passed verbatim to <b><a href="../man1/docker-build.1.html">docker-build</a></b>(1) or <b><a href="../man1/podman-build.1.html">podman-build</a></b>(1).

       It is recommended that you always use a <b>--</b> to distinguish these arguments, for readability.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       If  the   <b>$AUTOPKGTEST_KEEP_APT_SOURCES</b>   environment   variable   is   set   to   a   non-empty   value,
       <b>autopkgtest-build-docker</b> will keep whatever <b><a href="file:/etc/apt/sources.list">/etc/apt/sources.list</a></b> was inherited from the base image.

       Otherwise,  if  the  <b>$AUTOPKGTEST_APT_SOURCES_FILE</b>  environment variable is set to a non-empty value, for
       example <b>AUTOPKGTEST_APT_SOURCES_FILE=/home/me/mydistro/sources.list</b>, then  <b>autopkgtest-build-docker</b>  will
       read  that file (on the host system) and use it to populate <b><a href="file:/etc/apt/sources.list">/etc/apt/sources.list</a></b> in the virtual machine;
       or if the <b>$AUTOPKGTEST_APT_SOURCES</b> environment  variable  is  set  to  a  non-empty  value,  for  example
       <b>AUTOPKGTEST_APT_SOURCES=$(cat</b>  <b>/home/me/mydistro/sources.list)</b>,  <b>autopkgtest-build-docker</b>  will  write it
       directly into <b><a href="file:/etc/apt/sources.list">/etc/apt/sources.list</a></b> in the resulting container image.

       When <b>$AUTOPKGTEST_APT_SOURCES_FILE</b> or <b>$AUTOPKGTEST_APT_SOURCES</b> contain sources in the deb822 format, then
       sources  are  written  to  <b><a href="file:/etc/apt/sources.list.d/">/etc/apt/sources.list.d/</a>&lt;distro&gt;.sources</b>  in  the   container,   rather   than
       <b>/etc/apt/sources.list.</b>

       You  can  specify  an  apt  proxy  to  configure  in  the  container  image in the <b>$AUTOPKGTEST_APT_PROXY</b>
       environment variable. If you have an apt proxy configured on the host, the container  will  automatically
       use this, otherwise there is no default.

</pre><h4><b>EXAMPLES</b></h4><pre>
       A container image named <b>autopkgtest/debian:sid</b>, suitable for testing packages that target Debian unstable
       (sid), can be based on the images available from docker.io:

       $   autopkgtest-build-podman  --image  debian:sid  --post-command  "apt-get  update  &amp;&amp;  apt-get  install
       some-package"

       or can be built locally from a minbase tarball generated by <b><a href="../man1/mmdebstrap.1.html">mmdebstrap</a></b>(1):

       $ mmdebstrap --variant=minbase sid - | autopkgtest-build-podman --release=sid --tarball=-

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/podman.1.html">podman</a></b>(1),   <b><a href="../man1/docker.1.html">docker</a></b>(1),   <b><a href="../man5/containers-registries.conf.5.html">containers-registries.conf</a></b>(5),   <b><a href="../man1/autopkgtest-virt-docker.1.html">autopkgtest-virt-docker</a></b>(1),    <b><a href="../man1/autopkgtest.1.html">autopkgtest</a></b>(1),
       <b>/usr/share/doc/autopkgtest/</b>

</pre><h4><b>AUTHORS</b> <b>AND</b> <b>COPYRIGHT</b></h4><pre>
       <b>autopkgtest-build-docker</b> was written by Iñaki Malerba &lt;<a href="mailto:inaki@malerba.space">inaki@malerba.space</a>&gt;

       This manpage is part of autopkgtest, a tool for testing Debian binary packages.  autopkgtest is Copyright
       (C) 2006-2014 Canonical Ltd and others.

       See <b>/usr/share/doc/autopkgtest/CREDITS</b> for the list of contributors and full copying conditions.

Linux Programmer's Manual                             2018                           <u><a href="../man1/autopkgtest-build-docker.1.html">autopkgtest-build-docker</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>