<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmlogconf - create/edit a pmlogger configuration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/pcp">pcp_6.3.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmlogconf</b> - create/edit a pmlogger configuration file

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pmlogconf</b> [<b>-cqrvV?</b>]  [<b>-d</b> <u>groupsdir</u>] [<b>-g</b> <u>grouptag</u>] [<b>-h</b> <u>host</u>] [<b>-s</b> <u>groupfile</u>] <u>configfile</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>pmlogconf</b>  may  be  used  to  create  and  modify  a  generic  configuration  file  for the PCP archiver,
       <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1).

       If <u>configfile</u> does not exist, <b>pmlogconf</b> will create a generic configuration file with a  default  set  of
       enabled metrics and logging intervals.

       Once  created, <u>configfile</u> may be used with the <b>-c</b> option to <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) to select performance metrics and
       specify logging intervals for a PCP archive.

       If <u>configfile</u> does exist, <b>pmlogconf</b> will prompt for input from the user to enable or  disable  groups  of
       related performance metrics and to control the logging interval for each enabled group.

       Group selection requires a simple <b>y</b> (yes) or <b>n</b> (no) response to the prompt <b>Log</b> <b>this</b> <b>group?</b>.

       Other responses at this point may be used to select additional control functions as follows:

       <b>m</b>         Report the names of the metrics in the current group.

       <b>q</b>         Finish  with group selection (quit) and make no further changes to this group or any subsequent
                 group.

       <b>/</b><u>pattern</u>  Make no change to this group but search for a group containing <u>pattern</u> in  the  description  of
                 the group or the names of the associated metrics.

       A  logging interval is specified by responding to the <b>Logging</b> <b>interval?</b>  prompt with the keywords <b>once</b> or
       <b>default</b> or a valid <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) interval specification of the form ``<b>every</b> <u>N</u>  <u>timeunits</u>''  or  simply  ``<u>N</u>
       <u>timeunits</u>  <u>''</u> (the <b>every</b> is optional) where <u>N</u> is an unsigned integer and <u>timeunits</u> is one of the keywords
       <b>msec</b>, <b>millisecond</b>, <b>sec</b>, <b>second</b>, <b>min</b>, <b>minute</b>, <b>hour</b> or the plural form of one of the keywords.

       When run from automated logging setup processes, the <b>-c</b> option is used to indicate that <u>pmlogconf</u>  is  in
       auto-create  mode and no interactive dialog takes place.  The output <u>configfile</u> has an additional comment
       message and timestamp indicating this fact, so that it can be identified and subsequently  updated  using
       <b>-c</b> again.  This option is not appropriate for interactive use of the tool.

       The <b>-q</b> option suppresses the logging interval dialog and preserves the current interval from <u>configfile</u>.

       More verbose output may be enabled with the <b>-v</b> option.

</pre><h4><b>SETUP</b> <b>GROUP</b> <b>FILES</b></h4><pre>
       When  an  initial  <u>configfile</u> is created, the default specifications come from a set of group files below
       the <u>groupsdir</u> specified with the <b>-d</b> option (the default <u>groupsdir</u> is <b>$PCP_VAR_DIR/config/pmlogconf</b>  which
       is most commonly correct, so the <b>-d</b> option is rarely used in practice).

       The  directory  structure  below  <u>groupsdir</u>  is arbitrary as all regular files will be found by recursive
       descent and considered, so add-on products and PMDA developers can easily extend the  available  defaults
       to <b>pmlogconf</b> by adding new directories and/or group files below <u>groupsdir</u>.

       These group files are processed in the following ways:

       •  When a new <u>configfile</u> is created, all group files are processed.

       •  Whenever <b>pmlogconf</b> is run with an existing <u>configfile</u>, <u>groupsdir</u> is traversed to see if any new groups
          have been defined and should be considered for inclusion in <u>configfile</u>.

       •  When  <b>pmlogconf</b>  processes  a group in <u>configfile</u> that is enabled, the list of metrics associated with
          the group is taken from the group file (and replaces any previous list of metrics associated with this
          group in <u>configfile</u>).

       •  When either the <b>-r</b> (reprobe) or the <b>-c</b> (auto-create) command line option  is  specified,  every  group
          (not  just  newly  discovered  ones) is reprocessed to see if it should be considered for inclusion in
          <u>configfile</u>.

       •  If a group is found in <u>configfile</u> but the corresponding group does not exist below <u>groupsdir</u> (as would
          be the case when a group is made obsolete by a PCP upgrade) then the handling of the group depends  on
          the  mode in which <u>pmlogconf</u> is being run.  With <b>-c</b> the corresponding group is culled from <u>configfile</u>,
          otherwise the corresponding group is unchanged in <u>configfile</u>.  In either case a warning is issued.

       Each group file is structured as follows:

       •  The first line must contain <b>#pmlogconf-setup</b> <b>2.0</b>

       •  Other lines beginning with <b>#</b> are treated as comments.

       •  Blank lines are ignored.

       •  One or more lines starting with the keyword <b>ident</b> are used to provide the  human-readable  description
          of the group.

       •  Non-blank  lines  beginning  with white space define metrics to be associated with this group, one per
          line.  Each metric specification follows the rules for a <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) configuration, namely either  the
          name of a non-leaf node in the PMNS (implying all descendent names in the PMNS), or the name of a leaf
          node in the PMNS optionally followed by one or more instance names enclosed by ``['' and ``]''.

       •  A control line starting with one of the keywords <b>probe</b> or <b>force</b> must be present.

       •  An  optional  logging  interval  control  line  begins  with  the keyword <b>delta</b> followed by one of the
          <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1) interval specification described above.

       •  <b>probe</b> control lines have the format:
                                          <b>probe</b> <u>metric</u> [<u>condition</u> [<u>state_rule</u>] ]
          where <u>metric</u> is the name of a PCP metric (must be a leaf node in the PMNS, no  instance  specification
          is  allowed,  and  it  must  not be a derived metric) and the optional <u>condition</u> is the keyword <b>exists</b>
          (true if <u>metric</u> exists, i.e. is defined in the PMNS) or the keyword <b>values</b> (true if <u>metric</u>  exists  in
          the PMNS and has one or more current values) or an expression of the form
                                                          <u>op</u> <u>val</u>
          where  <u>op</u>  is  one  of  the <b><a href="../man1/awk.1.html">awk</a></b>(1) operators (<b>==</b>, <b>!=</b>, <b>&gt;</b>, <b>&gt;=</b>, <b>&lt;</b>, <b>&lt;=</b>, <b>~</b> (regular expression match) or <b>!~</b>
          (negated regular expression match)) and <u>val</u> is a value (arbitrary sequence of characters, excluding  a
          space) and the <u>condition</u> is true if there is some instance of <u>metric</u> that makes the expression true.

          If the <u>condition</u> is missing, the default is <b>exists</b>.

          When an explicit <u>condition</u> is provided, there may also be an optional <u>state_rule</u> of the form
                                                <b>?</b> <u>true_state</u> <b>:</b> <u>false_state</u>
          where  <u>true_state</u>  (applies  if <u>condition</u> is true) and <u>false_state</u> (applies if <u>condition</u> is false) are
          both taken from the keywords <b>include</b> (include and enable the  group  and  the  associated  metrics  in
          <u>configfile</u>),  <b>available</b> (include and disable the group in <u>configfile</u> - a user action of <b>y</b> as described
          above is needed to enable the group and add the associated metrics into <u>configfile</u>)  or  <b>exclude</b>  (the
          group is not considered for inclusion in <u>configfile</u>).

          The default <u>state_rule</u> is
                                                  <b>?</b> <b>available</b> <b>:</b> <b>exclude</b>

       •  <b>force</b>  control  lines begin with the keyword <b>force</b> followed by one of the states defined above, so one
          of the actions <b>include</b>, <b>exclude</b> or <b>available</b> is applied unconditionally to the group.

       Probing is only done when a new group is being added to <u>configfile</u> or when the <b>-r</b> command line option  is
       specified.   The evaluation of the probing conditions is done by contacting <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) on <u>hostname</u> (defaults
       to local:).

</pre><h4><b>OPTIONS</b></h4><pre>
       The available command line options are:

       <b>-c</b>   Enable non-interactive, auto-create mode.

       <b>-d</b> <u>groupsdir</u>, <b>--groups</b>=<u>groupsdir</u>
            Specify the path to the <u>groupsdir</u> directory.

       <b>-g</b> <u>grouptag</u>, <b>--group</b>=<u>grouptag</u>
            Query logging state for the specific logging group named <u>grouptag</u>.

       <b>-h</b> <u>host</u>, <b>--host</b>=<u>host</u>
            Performance metrics source is <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) on <u>host</u>, rather than on the default localhost.

       <b>-q</b>, <b>--quiet</b>
            Quiet mode, suppress logging interval dialog.

       <b>-r</b>, <b>--reprobe</b>
            Reconsider every group for inclusion in the <u>configfile</u>.

       <b>-s</b> <u>groupfile</u>, <b>--setup</b>=<u>groupfile</u>
            Report the default logging state for the one logging group in <u>groupfile</u>.  This is equivalent  output
            to that produced by the retired <b>pmlogconf-setup</b> shell script from earlier versions of PCP.

       <b>-v</b>, <b>--verbose</b>
            Enable verbose mode.

       <b>-V</b>, <b>--version</b>
            Display version number and exit.

       <b>-?</b>, <b>--help</b>
            Display usage message and exit.

</pre><h4><b>EXAMPLE</b></h4><pre>
       The following group file demonstrates all of the supported syntactic elements.

       #pmlogconf-setup 2.0
       ident   Example group file
       ident   ... more description
       delta   1 minute
       probe   sample.secret.foo.one values ? include : exclude
               sample.secret.foo.one
               sample.secret.foo.bar   # non-leaf in the PMNS
               sample.colour [ red green ]

</pre><h4><b>MIGRATION</b></h4><pre>
       The  current  version  of <b>pmlogconf</b> (2.0) supports a slightly different format for <u>configfile</u> compared to
       earlier versions.  If an old version <u>configfile</u> is presented to <b>pmlogconf</b> it will be converted to the new
       format.

</pre><h4><b>PCP</b> <b>ENVIRONMENT</b></h4><pre>
       Environment variables with the prefix <b>PCP_</b> are used to parameterize the file and directory names used  by
       PCP.   On  each  installation, the file <u>/etc/pcp.conf</u> contains the local values for these variables.  The
       <b>$PCP_CONF</b> variable may be used to specify an alternative configuration file, as described in <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5).

       <b>pmlogconf</b> overrides any <b>$PCP_DERIVED_CONFIG</b> environment variable to  an  empty  string,  for  performance
       reasons.

       <b>pmlogconf</b>  honours  the  <b>$PMCD_WAIT_TIMEOUT</b>  environment  variable when probing and creating new <b>pmlogger</b>
       configuration files.  It uses a default timeout value of 10 seconds  for  this,  in  the  absence  of  an
       environment setting.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1), <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1), <b><a href="../man5/pcp.conf.5.html">pcp.conf</a></b>(5) and <b><a href="../man5/pcp.env.5.html">pcp.env</a></b>(5).

Performance Co-Pilot                                   PCP                                          <u><a href="../man1/PMLOGCONF.1.html">PMLOGCONF</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>