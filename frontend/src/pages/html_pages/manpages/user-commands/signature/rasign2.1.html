<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rasign2 - a tool for generating and managing binary file signatures</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/radare2">radare2_5.9.8+dfsg-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rasign2 - a tool for generating and managing binary file signatures

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>rasign2</b> [options] [file]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  rasign2 tool is designed for creating, dumping, and managing signature files for binary analysis. It
       facilitates the generation of signature databases (SDB) from binary files, making it easier  to  identify
       and  catalog  functions  and  other  symbols.  The tool can interpret FLIRT 'I.sig' files, execute custom
       Radare2 scripts, and output signatures in multiple formats.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b>     Perform a more thorough analysis by adding extra 'a' to the analysis command. The more  'A's,  the
              deeper the analysis.

       <b>-A[AAA]</b>
              Equivalent to <b>r2</b> <b>-A</b>

       <b>-f</b>     Interpret the input file as a FLIRT 'I.sig' file and dump its signatures.

       <b>-h</b>     Display the help menu.

       <b>-j</b>     Output signatures in JSON format.

       <b>-i</b> <b>script.r2</b>
              Execute the specified Radare2 script on the input file.

       <b>-o</b> <b>sigs.sdb</b>
              Add generated signatures to the specified file. Creates the file if it does not exist.

       <b>-q</b>     Enable quiet mode, suppressing normal output.

       <b>-r</b>     Show output as Radare2 commands.

       <b>-S</b>     Operate on an SDB signature file. Use '-o -' to save to the same file.

       <b>-s</b> <b>signspace</b>
              Save all signatures under the specified signspace.

       <b>-c</b>     Add collision signatures before writing to a file.

       <b>-v</b>     Display version information.

       <b>-m</b>     Merge or overwrite signatures with the same name.

</pre><h4><b>USAGE</b> <b>EXAMPLES</b></h4><pre>
       Basic signature generation:
              <b>rasign2</b> <b>-o</b> <b>libc.sdb</b> <b>libc.so.6</b>
       This command generates signatures from 'libc.so.6' and saves them in 'libc.sdb'.

       Enhanced analysis:
              <b>rasign2</b> <b>-A</b> <b>-o</b> <b>enhanced_libc.sdb</b> <b>libc.so.6</b>
       This performs a deeper analysis before generating signatures, potentially discovering more functions.

       Output in Radare2 commands:
              <b>rasign2</b> <b>-r</b> <b>input_file</b> <b>|</b> <b>grep</b> <b>main</b>
       Prints the discovered signatures for 'main' as Radare2 commands.

       JSON output:
              <b>rasign2</b> <b>-j</b> <b>input_file</b>
       Outputs the generated signatures in JSON format.

       Merging signatures:
              <b>rasign2</b> <b>-m</b> <b>-o</b> <b>existing_sigs.sdb</b> <b>new_sigs.sdb</b>
       Merges or overwrites signatures in 'existing_sigs.sdb' with those from 'new_sigs.sdb'.

</pre><h4><b>THE</b> <b>Z</b> <b>COMMAND</b> <b>IN</b> <b>RADARE2</b></h4><pre>
       The  <b>z</b>  command  in  radare2  is  dedicated  to the management of binary signatures, known as zignatures.
       Zignatures are used for identifying and cataloging functions across different binaries  by  their  unique
       characteristics, such as bytes patterns, graph metrics, and other attributes.

</pre><h4><b>CONFIGURATION</b> <b>OPTIONS</b></h4><pre>
       The  behavior  of  zignature  processing  can  be  fine-tuned through a variety of configuration options,
       accessible via 'e??zign.' in radare2. Some key configuration options include:

       <b>zign.autoload</b>
              Autoload all zignatures located in dir.zigns.

       <b>zign.bytes</b>
              Use bytes patterns for matching.

       <b>zign.graph</b>
              Use graph metrics for matching.

       <b>zign.hash</b>
              Use Hash for matching.

       <b>zign.threshold</b>
              Minimum similarity required for inclusion in zb output.

       <b>zign.types</b>
              Use types for matching.

</pre><h4><b>ADDING</b> <b>ZIGNATURES</b></h4><pre>
       Zignatures can be added with the 'za' command, supporting a variety of  types  such  as  bytes  patterns,
       graph metrics, and more.

       <b>za</b> <b>foo</b> <b>b</b> <b>558bec..e8........</b>
              Adds a bytes pattern zignature.

       <b>za</b> <b>foo</b> <b>g</b> <b>cc=2</b> <b>nbbs=3</b> <b>edges=3</b> <b>ebbs=1</b>
              Adds a graph metrics zignature.

</pre><h4><b>ZIGNATURE</b> <b>COMMANDS</b></h4><pre>
       The <b>z</b> command encompasses several subcommands for managing zignatures:

       <b>z</b>      Show zignatures.

       <b>z.</b>     Find matching zignatures in current offset.

       <b>zb</b>     Search for best match.

       <b>zdzignature</b>
              Diff current function and signature.

       <b>z*</b>     Show zignatures in radare format.

       <b>zo</b>     Manage zignature files.

       <b>zf</b>     Manage FLIRT signatures.

       <b>z/</b>     Search zignatures.

       <b>zc</b>     Compare current zignspace zignatures with another one.

       <b>zs</b>     Manage zignspaces.

       <b>zi</b>     Show zignatures matching information.

              The  comprehensive  management  of zignatures through these commands facilitates a robust workflow
              for binary analysis, enabling the identification of known functions and facilitating the  analysis
              of binary similarities and differences.

</pre><h4><b>SUPPORTED</b> <b>ZIGNATURE</b> <b>METRICS</b></h4><pre>
       Zignatures  in  radare2  can  be  created  with a variety of metrics, each capturing different aspects of
       binary functions. These metrics include:

       <b>a:</b> <b>bytes</b> <b>pattern</b>
              Radare2 creates a mask from analysis to match bytes patterns.

       <b>b:</b> <b>bytes</b> <b>pattern</b>
              Direct bytes pattern matching.

       <b>c:</b> <b>base64</b> <b>comment</b>
              Associates a base64-encoded comment with the zignature.

       <b>n:</b> <b>real</b> <b>function</b> <b>name</b>
              Uses the real function name for matching.

       <b>g:</b> <b>graph</b> <b>metrics</b>
              Utilizes graph metrics such as cyclomatic complexity, number  of  edges,  basic  blocks,  and  end
              blocks.

       <b>o:</b> <b>original</b> <b>offset</b>
              Matches based on the original offset of the function.

       <b>r:</b> <b>references</b>
              Uses references for matching.

       <b>x:</b> <b>cross</b> <b>references</b>
              Incorporates cross references into the zignature.

       <b>h:</b> <b>bbhash</b>
              Employs hashing of function basic blocks for matching.

       <b>v:</b> <b>vars</b> <b>(and</b> <b>args)</b>
              Matches based on variables and arguments.

              Each  metric allows for a nuanced approach to identifying and comparing functions across binaries,
              enabling more accurate and comprehensive analysis.

</pre><h4><b>USAGE</b> <b>EXAMPLES</b> <b>FOR</b> <b>THE</b> <b>Z</b> <b>COMMAND</b></h4><pre>
       The z command in radare2 is versatile, offering various functionalities through its subcommands. Here are
       five usage examples:

       <b>Show</b> <b>all</b> <b>zignatures</b>
              <b>z</b>
       Displays all zignatures currently loaded in radare2.

       <b>Find</b> <b>matching</b> <b>zignatures</b> <b>at</b> <b>the</b> <b>current</b> <b>offset</b>
              <b>z.</b>
       Searches for and displays zignatures that match at the current offset in the binary.

       <b>Scan</b> <b>all</b> <b>functions</b> <b>to</b> <b>find</b> <b>matching</b> <b>zignatures</b>
              <b>z/</b>
       Searches and match all signatures loaded against all the analyzed functions in order to give  a  name  to
       every one.

       <b>Load</b> <b>zignature</b> <b>files</b>
              <b>zo</b> <b>libc.sdb</b>
       Loads zignatures from the specified SDB file into the current session.

       <b>Generate</b> <b>zignatures</b> <b>for</b> <b>all</b> <b>functions</b>
              <b>zaF</b>
       Generates zignatures for all identified functions in the binary and adds them to the current session.

       <b>Search</b> <b>for</b> <b>the</b> <b>closest</b> <b>matching</b> <b>zignatures</b>
              <b>zb</b>
       Searches  for and displays the closest matching zignatures to the function at the current offset, helping
       identify similar functions across binaries.

       These examples showcase the `z` command's ability to manage zignatures efficiently, aiding in the  binary
       analysis process by leveraging the power of zignatures for function identification and comparison.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/r2.1.html">r2</a>(1),</b> <b><a href="../man1/radare2.1.html">radare2</a>(1)</b>

</pre><h4><b>WWW</b></h4><pre>
       https://www.radare.org/

</pre><h4><b>AUTHORS</b></h4><pre>
       pancake &lt;<a href="mailto:pancake@nopcode.org">pancake@nopcode.org</a>&gt;

1.0                                                17 Mar 2024                                        <u><a href="../man1/RASIGN2.1.html">RASIGN2</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>