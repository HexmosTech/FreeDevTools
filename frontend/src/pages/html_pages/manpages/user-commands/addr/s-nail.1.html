<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S-nail [v14.9.25] — send and receive Internet mail</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/s-nail">s-nail_14.9.25-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       S-nail [v14.9.25] — send and receive Internet mail

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>s-nail</b>  [<b>-DdEFinv~#</b>]  [<b>-:</b>  <u>spec</u>]  [<b>-A</b>  <u>account</u>]  [:<b>-a</b>  <u>attachment</u>:]  [:<b>-b</b> <u>bcc-addr</u>:] [:<b>-C</b> <u>"field:</u> <u>body"</u>:]
              [:<b>-c</b> <u>cc-addr</u>:] [<b>-M</b> <u>type</u> | <b>-m</b> <u>file</u> | <b>-q</b> <u>file</u> | <b>-t</b>] [<b>-r</b> <u>from-addr</u>] [:<b>-S</b> <u>var</u>[=<u>value</u>]:]  [<b>-s</b>  <u>subject</u>]
              [:<b>-T</b> <u>"field:</u> <u>addr"</u>:] [:<b>-X</b> <u>cmd</u>:] [:<b>-Y</b> <u>cmd</u>:] [<b>-.</b>] :<u>to-addr</u>: [<b>--</b> :<u>mta-option</u>:]

       <b>s-nail</b>   [<b>-DdEeHiNnRv~#</b>]   [<b>-:</b>   <u>spec</u>]  [<b>-A</b>  <u>account</u>]  [:<b>-C</b>  <u>"field:</u> <u>body"</u>:]  [<b>-L</b>  <u>spec</u>]  [<b>-r</b>  <u>from-addr</u>]
              [:<b>-S</b> <u>var</u>[=<u>value</u>]:] [<b>-u</b> <u>user</u>] [:<b>-X</b> <u>cmd</u>:] [:<b>-Y</b> <u>cmd</u>:] [<b>--</b> :<u>mta-option</u>:]
       <b>s-nail</b> [<b>-DdEeHiNnRv~#</b>]  [<b>-:</b>  <u>spec</u>]  [<b>-A</b>  <u>account</u>]  [:<b>-C</b>  <u>"field:</u> <u>body"</u>:]  <b>-f</b>  [<b>-L</b>  <u>spec</u>]  [<b>-r</b>  <u>from-addr</u>]
              [:<b>-S</b> <u>var</u>[=<u>value</u>]:] [:<b>-X</b> <u>cmd</u>:] [:<b>-Y</b> <u>cmd</u>:] [<u>file</u>] [<b>--</b> :<u>mta-option</u>:]

       <b>s-nail</b> <b>-h</b> | <b>--help</b>
       <b>s-nail</b> <b>-V</b> | <b>--version</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
             <b>Note:</b>   S-nail   (S-nail)   will   see   major  changes  in  v15.0  (circa  2022).   Some  backward
             incompatibilities cannot be avoided.  “COMMANDS” change  to  “Shell-style  argument  quoting”,  and
             shell metacharacters will become (more) meaningful.  Some commands accept new syntax today via <b>wysh</b>
             (“Command  modifiers”).   Behaviour is flagged [v15-compat] and [no v15-compat], <b>set</b>ting <u>v15-compat</u>
             (“INTERNAL VARIABLES”) will choose new behaviour when applicable; giving it a value makes  <b>wysh</b>  an
             implied default.  [Obsolete] flags what will vanish.

             <b>Warning!</b> <u>v15-compat</u> (with value) will be a default in v14.10.0!

       S-nail  provides  a  simple  and  friendly environment for sending and receiving mail.  It is intended to
       provide the functionality of the POSIX <u><a href="../man1/mailx.1.html">mailx</a></u>(1) command,  but  is  MIME  capable  and  optionally  offers
       extensions  for line editing, S/MIME, SMTP and POP3, among others.  S-nail divides incoming mail into its
       constituent messages and allows the user to deal with them in any order.  It offers many  “COMMANDS”  and
       “INTERNAL  VARIABLES”  for  manipulating  messages and sending mail.  It provides the user simple editing
       capabilities to ease the composition of outgoing messages, and increasingly powerful  and  reliable  non-
       interactive scripting capabilities.

   <b>Options</b>
       <b>-:</b> <u>spec</u>, <b>--resource-files</b>=..
                 Controls  loading  of  (as via <b>source</b>) “Resource files”: <u>spec</u> is parsed case-insensitively, the
                 letter ‘s’ corresponds to the system wide <u>s-nail.rc</u>, ‘u’ the user's  personal  file  <u><a href="file:~/.mailrc">~/.mailrc</a></u>.
                 The  (original)  system wide resource is also compiled-in, accessible via ‘x’.  The letters ‘-’
                 and ‘/’ disable usage of  resource  files.   Order  matters,  default  is  ‘su’.   This  option
                 overrides <b>-n</b>.

       <b>-A</b> <u>name</u>, <b>--account</b>=..
                 Activate  user  <b>account</b>  <u>name</u> after program startup is complete (resource files loaded, only <b>-X</b>
                 commands are to be executed), and switch to its  “primary  system  mailbox”  (most  likely  the
                 <u>inbox</u>).   If activation fails the program e<b>xit</b>s if used non-interactively, or if any of <u>errexit</u>
                 or <u>posix</u> are set.

       <b>-a</b> <u>file</u>[<u>=input-charset</u>[<u>#output-charset</u>]], <b>--attach</b>=..
                 (Send mode) Attach <u>file</u>.  For (Compose mode) opportunities refer to <b>~@</b> and <b>~^</b>.  <u>file</u> is subject
                 to tilde expansion (see “Filename transformations” and <b>folder</b>); if it  is  not  accessible  but
                 contains  a  ‘=’ character, anything before the last ‘=’ will be used as the filename, anything
                 thereafter as a character set specification, as shown.

                 If only an input character set is specified, the input side is  fixed,  and  no  character  set
                 conversion  will  be  applied;  an  empty  or  the special string hyphen-minus ‘-’ is taken for
                 <u>ttycharset</u> (the default).  If an output character set  has  also  been  specified  the  desired
                 conversion is performed immediately, not considering file type and content, except for an empty
                 string  or  hyphen-minus  ‘-’,  which  select  the default conversion algorithm (see “Character
                 sets”): no immediate conversion is performed, <u>file</u> and its  contents  will  be  MIME-classified
                 (“HTML  mail  and  MIME  attachments,  The  mime.types  files”) first — only the latter mode is
                 available unless <u>features</u> includes ‘,+iconv,’.

       <b>-B</b>        ([Obsolete]: S-nail will always use line-buffered output, to gain line-buffered input  even  in
                 batch mode enable batch mode via <b>-#</b>.)

       <b>-b</b> <u>addr</u>, <b>--bcc</b>=..
                 (Send mode) Send a blind carbon copy to recipient <u>addr</u>.  The option may be used multiple times.
                 Also see the section “On sending mail, and non-interactive mode”.

       <b>-C</b> <u>"field:</u> <u>body"</u>, <b>--custom-header</b>=..
                 Create  a  custom header which persists for an entire session.  A custom header consists of the
                 field name followed by a colon ‘:’ and the field content body, for example ‘-C  "Blah:  Neminem
                 laede;  imo omnes, quantum potes, juva"’.  Standard header field names cannot be overwritten by
                 custom headers.  Runtime adjustable custom headers are available via  the  variable  <u>customhdr</u>,
                 and in (Compose mode) <b>~^</b>, one of the “COMMAND ESCAPES”, as well as <b>digmsg</b> are the most flexible
                 and powerful options to manage message headers.  This option may be used multiple times.

       <b>-c</b> <u>addr</u>, <b>--cc</b>=..
                 (Send mode) Just like <b>-b</b>, except it places the argument in the list of carbon copies.

       <b>-D</b>, <b>--disconnected</b>
                 [Option] Startup with <u>disconnected</u> <b>set</b>.

       <b>-d</b>, <b>--debug</b>
                 Enter  a  debug-only  sandbox  mode  by  setting  the  internal variable <u>debug</u>; the same can be
                 achieved via ‘<b>-S</b> <u>debug</u>’ or ‘<b>set</b> <u>debug</u>’.  Also see <b>-v</b>.

       <b>-E</b>, <b>--discard-empty-messages</b>
                 (Send mode) <b>set</b> <u>skipemptybody</u> and thus discard  messages  with  an  empty  message  part  body,
                 successfully.

       <b>-e</b>, <b>--check-and-exit</b>
                 Just check if mail is present (in the system <u>inbox</u> or the one specified via <b>-f</b>): if yes, return
                 an  exit  status of zero, a non-zero value otherwise.  To restrict the set of mails to consider
                 in this evaluation a message specification can be added with the option <b>-L</b>.  Quickrun: does not
                 open an interactive session.

       <b>-F</b>        (Send mode) Save the message to send in a  file  named  after  the  local  part  of  the  first
                 recipient's address (instead of in <u>record</u>).

       <b>-f</b>, <b>--file</b>
                 Read  in  the  contents  of  the  user's  “secondary  mailbox” MBOX (or the specified file) for
                 processing; when S-nail is quit, it writes undeleted messages back to this file (but  be  aware
                 of  the  <u>hold</u>  option).   The  optional  <u>file</u>  argument  will  undergo  some  special “Filename
                 transformations” (as via <b>folder</b>).  Note that <u>file</u> is not an argument to the  flag  <b>-f</b>,  but  is
                 instead  taken  from  the command line after option processing has been completed.  In order to
                 use  a  <u>file</u>  that  starts  with  a  hyphen-minus,  prefix  with  a  relative   path,   as   in
                 ‘./-hyphenbox.mbox’.

       <b>-H</b>, <b>--header-summary</b>
                 Display  a  summary  of  <b>headers</b>  for  the  given <b>folder</b> (depending on <b>-u</b>, <u>inbox</u> or MAIL, or as
                 specified via <b>-f</b>), then exit.  A configurable summary view is  available  via  the  option  <b>-L</b>.
                 This mode does not honour <u>showlast</u>.  Quickrun: does not open an interactive session.

       <b>-h</b>, <b>--help</b>
                 Show a brief usage summary; use <b>--long-help</b> for a list long options.

       <b>-i</b>        <b>set</b> <u>ignore</u> to ignore tty interrupt signals.

       <b>-L</b> <u>spec</u>, <b>--search</b>=..
                 Display  a  summary of <b>headers</b> of all messages that match the given <u>spec</u> in the <b>folder</b> found by
                 the same algorithm used by <b>-H</b>, then exit.  See the section “Specifying messages” for the format
                 of <u>spec</u>.  This mode does not honour <u>showlast</u>.

                 If the <b>-e</b> option has been given in addition no header summary  is  produced,  but  S-nail  will
                 instead indicate via its exit status whether <u>spec</u> matched any messages (‘0’) or not (‘1’); note
                 that  any verbose output is suppressed in this mode and must instead be enabled explicitly (see
                 <b>-v</b>).  Quickrun: does not open an interactive session.

       <b>-M</b> <u>type</u>   (Send mode) Will flag standard input with the MIME ‘Content-Type:’ set to the given known  <u>type</u>
                 (“HTML  mail  and MIME attachments, The mime.types files”) and use it as the main message body.
                 [v15 behaviour may differ] Using this option will bypass processing of <u>message-inject-head</u>  and
                 <u>message-inject-tail</u>.  Also see <b>-q</b>, <b>-m</b>, <b>-t</b>.

       <b>-m</b> <u>file</u>   (Send  mode)  MIME  classify  the  specified  <u>file</u>  and  use it as the main message body.  [v15
                 behaviour may differ] Using this option  will  bypass  processing  of  <u>message-inject-head</u>  and
                 <u>message-inject-tail</u>.  Also see <b>-q</b>, <b>-M</b>, <b>-t</b>.

       <b>-N</b>, <b>--no-header-summary</b>
                 inhibit the initial display of message headers when reading mail or editing a mailbox <b>folder</b> by
                 calling <b>unset</b> for the internal variable <u>header</u>.

       <b>-n</b>        Standard  flag  that  inhibits  reading  the system wide <u>s-nail.rc</u> upon startup.  The option <b>-:</b>
                 allows more control over the startup sequence; also see “Resource files”.

       <b>-q</b> <u>file</u>, <b>--quote-file</b>=..
                 (Send mode) Initialize the message body with the contents of <u>file</u>, which may be standard  input
                 ‘-’ only in non-interactive context.  Also see <b>-M</b>, <b>-m</b>, <b>-t</b>.

       <b>-R</b>, <b>--read-only</b>
                 Any mailbox <b>folder</b> aka <b>folder</b> opened will be in read-only mode.

       <b>-r</b> <u>from-addr</u>, <b>--from-address</b>=..
                 The  RFC 5321 reverse-path used for relaying and delegating messages to its destination(s), for
                 example to report delivery errors, is normally derived from the address which  appears  in  the
                 <u>from</u>  header  (or,  if  that  contains  multiple addresses, in <u>sender</u>).  A file-based aka local
                 executable  <u>mta</u>  (Mail-Transfer-Agent),  however,  instead  uses  the  local  identity  of  the
                 initiating user.

                 When  this command line option is used the given single addressee <u>from-addr</u> will be assigned to
                 the internal variable <u>from</u>, but in addition the command line option <b>-f</b> <u>from-addr</u> will be passed
                 to a file-based <u>mta</u> whenever a message is sent.   Shall  <u>from-addr</u>  include  a  user  name  the
                 address  components  will  be  separated  and  the name part will be passed to a file-based <u>mta</u>
                 individually via <b>-F</b> <u>name</u>.  Even though  not  a  recipient  the  ‘shquote’  <u>expandaddr</u>  flag  is
                 supported.

                 If  an  empty  string is passed as <u>from-addr</u> then the content of the variable <u>from</u> (or, if that
                 contains multiple addresses, <u>sender</u>) will be evaluated and used for this purpose  whenever  the
                 file-based  <u>mta</u>  is  contacted.  By default, without <b>-r</b> that is, neither <b>-f</b> nor <b>-F</b> command line
                 options are used when contacting a file-based MTA, unless this automatic deduction is  enforced
                 by <b>set</b>ting the internal variable <u>r-option-implicit</u>.

                 Remarks:  many default installations and sites disallow overriding the local user identity like
                 this unless either the MTA has been configured accordingly or the user is  member  of  a  group
                 with special privileges.  Passing an invalid address will cause an error.

       <b>-S</b> <u>var</u>[=value], <b>--set</b>=..
                 <b>set</b>  (or, with a prefix string ‘no’, as documented in “INTERNAL VARIABLES”, <b>unset</b>) <u>var</u>iable and
                 optionally assign <u>value</u>, if supported; [v15 behaviour may  differ]  the  entire  expression  is
                 evaluated  as  if specified within dollar-single-quotes (see “Shell-style argument quoting”) if
                 the internal variable <u>v15-compat</u> is set.  If the operation fails the program will exit  if  any
                 of  <u>errexit</u>  or  <u>posix</u>  are  set.   Settings  established  via <b>-S</b> cannot be changed from within
                 “Resource files” or an account switch initiated by <b>-A</b>.  They will become mutable  again  before
                 commands registered via <b>-X</b> are executed.

       <b>-s</b> <u>subject</u>, <b>--subject</b>=..
                 (Send  mode)  Specify  the subject of the message to be sent.  Newline (NL) and carriage-return
                 (CR) bytes are invalid and will be normalized to space (SP) characters.

       <b>-T</b> <u>"field:</u> <u>addr"</u>, <b>--target</b>=..
                 (Send mode) Add <u>addr</u> to the list of receivers targeted by <u>field</u>, for  now  supported  are  only
                 ‘bcc’,  ‘cc’,  ‘fcc’,  and  ‘to’.   Field  and  body (address) are separated by a colon ‘:’ and
                 optionally blank (space, tabulator) characters.  The ‘shquote’ <u>expandaddr</u>  flag  is  supported.
                 <u>addr</u> is parsed like a message header address line, as if it would be part of a template message
                 fed  in  via  <b>-t</b>,  and the same modifier suffix is supported.  This option may be used multiple
                 times.

       <b>-t</b>, <b>--template</b>
                 (Send mode) The text message given (on standard input) is expected to contain,  separated  from
                 the  message body by an empty line, one or multiple plain text message headers.  [v15 behaviour
                 may differ] Readily prepared MIME mail messages cannot be passed.  Headers  can  span  multiple
                 consecutive  lines  if  follow lines start with any amount of whitespace.  A line starting with
                 the number sign ‘#’ in the first column is ignored.  Message recipients can be  given  via  the
                 message  headers  ‘To:’,  ‘Cc:’,  ‘Bcc:’ (the ‘?single’ modifier enforces treatment as a single
                 addressee, for example ‘To?single: exa,  &lt;m@ple&gt;’)  or  ‘Fcc:’,  they  will  be  added  to  any
                 recipients  specified  on  the  command  line,  and are likewise subject to <u>expandaddr</u> validity
                 checks.  If a message subject is specified via ‘Subject:’ then it will be used in favour of one
                 given on the command line.

                 More optional headers are  ‘Reply-To:’  (possibly  overriding  <u>reply-to</u>),  ‘Sender:’  (<u>sender</u>),
                 ‘From:’   (<u>from</u>  and  /  or  option  <b>-r</b>).   ‘Message-ID:’,  ‘In-Reply-To:’,  ‘References:’  and
                 ‘Mail-Followup-To:’, by default created automatically dependent on  message  context,  will  be
                 used  if  specified  (a  special address massage will however still occur for the latter).  Any
                 other custom header field (also see <b>-C</b>, <u>customhdr</u> and <b>~^</b>) is passed through entirely unchanged,
                 and in conjunction with the options <b>-~</b> or <b>-#</b> it is possible to embed “COMMAND  ESCAPES”.   Also
                 see <b>-M</b>, <b>-m</b>, <b>-q</b>.

       <b>-u</b> <u>user</u>, <b>--inbox-of</b>=..
                 Initially  read  the  “primary  system  mailbox”  of  <u>user</u>,  appropriate  privileges  presumed;
                 effectively identical to ‘<b>-f</b> %user’.

       <b>-V</b>, <b>--version</b>
                 Show S-nails <u>version</u> and exit.  The command <b>version</b> will also show the  list  of  <u>features</u>:  ‘$
                 s-nail -:/ -Xversion -Xx’.

       <b>-v</b>, <b>--verbose</b>
                 <b>set</b>s  the  internal  variable  <u>verbose</u>  to  enable  logging  of informational context messages.
                 (Increases level of verbosity when used multiple times.)  Also see <b>-d</b>.

       <b>-X</b> <u>cmd</u>, <b>--startup-cmd</b>=..
                 Add the given (or multiple for a multiline argument) <u>cmd</u> to a list of commands to  be  executed
                 before  normal operation starts.  The commands will be evaluated as a unit, just as via <b>source</b>.
                 Correlates with <b>-#</b> and <u>errexit</u>.

       <b>-Y</b> <u>cmd</u>, <b>--cmd</b>=..
                 Add the given (or multiple for a multiline argument) <u>cmd</u> to a list of commands to  be  executed
                 after  normal  operation has started.  The commands will be evaluated successively in the given
                 order, and as if given on the program's standard input — before interactive prompting begins in
                 interactive mode, after standard input has been consumed otherwise.

       <b>-~</b>, <b>--enable-cmd-escapes</b>
                 Enable “COMMAND ESCAPES” in (Compose mode) even in non-interactive use  cases.   This  can  for
                 example be used to automatically format the composed message text before sending the message:

                       $ ( echo 'line    one. Word.     Word2.';\
                           echo '~| <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?fmt">/usr/bin/fmt</a> -tuw66' ) |\
                         LC_ALL=C s-nail -d~:/ -Sttycharset=utf-8 <a href="mailto:bob@exam.ple">bob@exam.ple</a>

       <b>-#</b>, <b>--batch-mode</b>
                 Enables  batch  mode:  standard  input is made line buffered, the complete set of (interactive)
                 commands is available, processing of “COMMAND  ESCAPES”  is  enabled  in  “Compose  mode”,  and
                 diverse  “INTERNAL  VARIABLES”  are  adjusted for batch necessities, exactly as if done via <b>-S</b>:
                 <u>emptystart</u>, no<u>errexit</u>, no<u>header</u>, no<u>posix</u>, <u>quiet</u>, <u>sendwait</u>, <u>typescript-mode</u>  as  well  as  MAIL,
                 MBOX  and  <u>inbox</u>  (the  latter  three to <u>/dev/null</u>).  Also, the values of COLUMNS and LINES are
                 looked up, and acted upon.  The following prepares an email message in a batched dry run:

                       $ for name in bob <a href="mailto:alice@exam.ple">alice@exam.ple</a> <a href="mailto:lisa@exam.ple">lisa@exam.ple</a>; do
                           printf 'mail %s\n~s ubject\nText\n~.\n' "${name}"
                         done |
                         LC_ALL=C s-nail -#:x -Smta=test \
                           -X'alias bob <a href="mailto:bob@exam.ple">bob@exam.ple</a>'

       <b>-.</b>, <b>--end-options</b>
                 This flag forces termination of option  processing  in  order  to  prevent  “option  injection”
                 (attacks).   It  also  forcefully  puts  S-nail  into send mode, see “On sending mail, and non-
                 interactive mode”.

       If the setting of <u>expandargv</u> allows their recognition all <u>mta-option</u> arguments given at the  end  of  the
       command  line after a ‘--’ separator will be passed through to a file-based <u>mta</u> (Mail-Transfer-Agent) and
       persist for the entire session.  <u>expandargv</u> constraints do not apply to  the  content  of  <u>mta-arguments</u>.
       Command  line  receiver address handling supports the ‘shquote’ constraint of <u>expandaddr</u>, for more please
       see “On sending mail, and non-interactive mode”.

             $ s-nail -#:/ -X 'addrcodec enc Hey, ho &lt;silver@go&gt;' -Xx

   <b>A</b> <b>starter</b>
       S-nail is a direct descendant of BSD Mail, itself a successor to the Research Unix mail which “was  there
       from  the  start”  according  to  “HISTORY”.   It  thus represents the user side of the Unix mail system,
       whereas the system side (Mail-Transfer-Agent, MTA) was traditionally taken by <u><a href="../man8/sendmail.8.html">sendmail</a></u>(8) (and most  MTAs
       provide  a binary of this name for compatibility reasons).  If the [Option]al SMTP <u>mta</u> is included in the
       <u>features</u> of S-nail then the system side is not a mandatory precondition for mail delivery.

       S-nail strives for compliance with  the  POSIX  <u><a href="../man1/mailx.1.html">mailx</a></u>(1)  standard,  but  <u>posix</u>,  one  of  the  “INTERNAL
       VARIABLES”,  or its “ENVIRONMENT”al equivalent POSIXLY_CORRECT, needs to be set to adjust behaviour to be
       almost on par.  Almost, because there is one important difference: POSIX “Shell-style  argument  quoting”
       is  ([v15  behaviour  may differ] increasingly) used instead of the “Old-style argument quoting” that the
       standard documents, which is believed to be a feature.  The builtin  as  well  as  the  (default)  global
       <u>s-nail.rc</u> “Resource files” already bend the standard imposed settings a bit.

       For  example,  <u>hold</u>  and  <u>keepsave</u>  are  <b>set</b> in order to suppress the automatic moving of messages to the
       “secondary mailbox” MBOX that would otherwise occur (see “Message states”), and <u>keep</u> to not remove  empty
       system  MBOX  mailbox files (or all empty such files in <u>posix</u> mode) to avoid mangling of file permissions
       when files eventually get recreated.

       To enter interactive mode even if the initial mailbox is empty <u>emptystart</u> is set,  <u>editheaders</u>  to  allow
       editing  of  headers  as  well  as  <u>fullnames</u> to not strip down addresses in “Compose mode”, and <u>quote</u> to
       include the message that is being responded to when <b>reply</b>ing, which is indented by an  <u>indentprefix</u>  that
       also  deviates  from  standard  imposed  settings.  <u>mime-counter-evidence</u> is fully enabled, too.  It sets
       <u>followup-to-honour</u> and <u>reply-to-honour</u> to comply with reply address desires.

       Credentials and other settings are easily addressable by  grouping  them  via  <b>account</b>.   The  file  mode
       creation mask can be managed with <u>umask</u>.  Files and shell pipe output can be <b>source</b>d for <b>eval</b>uation, also
       during  startup  from  within  the  “Resource  files”.  Informational context can be available by <b>set</b>ting
       <u>verbose</u> or <u>debug</u> (as via <b>-v</b>, <b>-d</b>).

   <b>On</b> <b>sending</b> <b>mail,</b> <b>and</b> <b>non-interactive</b> <b>mode</b>
       To send a message to one or more people, using a local or built-in <u>mta</u> (Mail-Transfer-Agent) transport to
       actually deliver the generated mail message, S-nail can be invoked with arguments which are the names  of
       people  to  whom the mail will be sent, and the command line options <b>-b</b> and <b>-c</b> can be used to add (blind)
       carbon copy receivers:

             # Via test MTA
             $ echo Hello, world | s-nail -:/ -Smta=test -s test $LOGNAME

             # Via <a href="../man1/sendmail.1.html">sendmail</a>(1) MTA
             $ &lt;/dev/null s-nail -:x -s test $LOGNAME

             # Debug dry-run mode:
             $ &lt;/dev/null LC_ALL=C s-nail -d -:/ \
                -Sttycharset=utf8 -Sfullnames \
                -b <a href="mailto:bcc@exam.ple">bcc@exam.ple</a> -c <a href="mailto:cc@exam.ple">cc@exam.ple</a> -. \
                '(Lovely) Bob &lt;<a href="mailto:bob@exam.ple">bob@exam.ple</a>&gt;' <a href="mailto:eric@exam.ple">eric@exam.ple</a>

             # With SMTP (no real sending due to -d debug dry-run)
             $ LC_ALL=C s-nail -d -:/ -Sv15-compat -Sttycharset=utf8 \
                 -S mta=smtps://<a href="mailto:mylogin@exam.ple">mylogin@exam.ple</a>:465 -Ssmtp-auth=none \
                 -S from=<a href="mailto:scriptreply@exam.ple">scriptreply@exam.ple</a> \
                 -a /etc/mail.rc --end-options \
                 <a href="mailto:eric@exam.ple">eric@exam.ple</a> &lt; /tmp/letter.txt

       Email addresses and plain user names are subject to <b>alternates</b> filtering, names only are  first  expanded
       through  <b>alias</b>  and  <u>mta-aliases</u>.   An  address  in  angle brackets consisting only of a valid local user
       ‘&lt;name&gt;’ will be converted to a fully qualified address if either <u>hostname</u> is not set, or set to  a  non-
       empty value; if set to the empty value the conversion is left up to the <u>mta</u>.  By setting <u>expandaddr</u> fine-
       grained  control  of  recipient  address  types  other than user names and network addresses is possible.
       Recipients are classified as follows: any name that starts with a vertical bar ‘|’ character specifies  a
       command  pipe  – the command string following the ‘|’ is executed and the message is sent to its standard
       input; likewise, any name that consists only of hyphen-minus ‘-’ or starts with the character solidus ‘/’
       or the character sequence dot solidus ‘./’ is treated as a file, regardless  of  the  remaining  content.
       Any  other  name  which contains a commercial at ‘@’ character is a network address; Any other name which
       starts with a plus sign ‘+’ character is a mailbox name; Any other name  which  contains  a  solidus  ‘/’
       character  but  no exclamation mark ‘!’ or percent sign ‘%’ character before is also a mailbox name; What
       remains is treated as a network address.  This classification can be avoided by using  a  ‘Fcc:’  header,
       see “Compose mode”.

             $ echo bla | s-nail -Sexpandaddr -s test ./mbox.mbox
             $ echo bla | s-nail -Sexpandaddr -s test '|cat &gt;&gt; ./mbox.mbox'
             $ echo safe | LC_ALL=C \
                 s-nail -:/ -Smta=test -Sv15-compat -Sttycharset=utf8 \
                   --set mime-force-sendout --set fullnames \
                   -S expandaddr=fail,-all,+addr,failinvaddr -s test \
                   --end-options 'Imagine John &lt;<a href="mailto:cold@turk.ey">cold@turk.ey</a>&gt;'

       Before messages are sent they undergo editing in “Compose mode”.  But many settings are static and can be
       set  more  generally.  The envelope sender address for example is defined by <u>from</u>, explicitly defining an
       originating <u>hostname</u> may be  desirable,  especially  with  the  built-in  SMTP  Mail-Transfer-Agent  <u>mta</u>.
       “Character  sets”  for  outgoing message and MIME part content are configurable via <u>sendcharsets</u>, whereas
       input data is assumed to be in <u>ttycharset</u>.  Message data will be passed over the wire in a <u>mime-encoding</u>,
       and MIME parts aka attachments need a <b>mimetype</b>, usually taken out  of  “The  mime.types  files”.   Saving
       copies  of  sent  messages  in  a  <u>record</u>  mailbox  may be desirable – as for most mailbox <b>folder</b> targets
       “Filename transformations” will be performed.

       For the purpose of arranging a complete environment of settings that can be switched  to  with  a  single
       command or command line option there are <b>account</b>s.  Alternatively a flat configuration could be possible,
       making  use of so-called variable chains which automatically pick ‘USER@HOST’ or ‘HOST’ context-dependent
       variants  some  variables  support:  for  example  addressing  ‘<b>Folder</b>  pop3://<a href="mailto:yaa@exam.ple">yaa@exam.ple</a>’  would  find
       <u><a href="mailto:pop3-no-apop-yaa@exam.ple">pop3-no-apop-yaa@exam.ple</a></u>,  <u>pop3-no-apop-exam.ple</u> and <u>pop3-no-apop</u> in order.  For more please see “On URL
       syntax and credential lookup” and “INTERNAL VARIABLES”.

       To avoid environmental noise scripts should create a script-local environment, ideally with  the  command
       line  options  <b>-:</b>  to  disable  configuration  files  in  conjunction  with  repetitions of <b>-S</b> to specify
       variables:

             $ env LC_ALL=C s-nail -:/ \
                 -Sv15-compat \
                 -Sttycharset=utf-8 -Smime-force-sendout \
                 -Sexpandaddr=fail,-all,failinvaddr \
                 -S mta=smtps://<a href="mailto:mylogin@exam.ple">mylogin@exam.ple</a>:465 -Ssmtp-auth=login \
                 -S from=<a href="mailto:scriptreply@exam.ple">scriptreply@exam.ple</a> \
                 -s 'Subject to go' -a attachment_file \
                 -Sfullnames -. \
                 'Recipient 1 &lt;<a href="mailto:rec1@exam.ple">rec1@exam.ple</a>&gt;' <a href="mailto:rec2@exam.ple">rec2@exam.ple</a> \
                 &lt; content_file

       As shown, scripts producing messages can “fake” a  locale  environment,  the  above  specifies  the  all-
       compatible  7-bit clean LC_ALL “C”, but will nonetheless take and send UTF-8 in the message text by using
       <u>ttycharset</u>.  If character set conversion is compiled in (<u>features</u> includes the term  ‘,+iconv,’)  invalid
       (according  to  <u>ttycharset</u>)  character input data would normally cause errors; setting <u>mime-force-sendout</u>
       will instead, as a last resort, classify the input as binary data, and therefore allow  message  creation
       to  be  successful.  (Such content can then be inspected either by installing a <u>pipe-TYPE/SUBTYPE</u> handler
       for ‘application/octet-stream’, or possibly automatically through <u>mime-counter-evidence</u>).

       In interactive mode, introduced soon, messages can be sent by calling the <b>mail</b> command  with  a  list  of
       recipient addresses:

             $ s-nail -:/ -Squiet -Semptystart -Sfullnames -Smta=test
             "/var/spool/mail/user": 0 messages
             ? mail "Recipient 1 &lt;<a href="mailto:rec1@exam.ple">rec1@exam.ple</a>&gt;", <a href="mailto:rec2@exam.ple">rec2@exam.ple</a>
             ...
             ? # Will do the right thing (tm)
             ? m <a href="mailto:rec1@exam.ple">rec1@exam.ple</a> <a href="mailto:rec2@exam.ple">rec2@exam.ple</a>

   <b>Compose</b> <b>mode</b>
       If  standard  input is a terminal rather than the message to be sent, the user is expected to type in the
       message contents.  In compose mode lines beginning with the character ‘~’ (in fact the value  of  <u>escape</u>)
       are  special  –  these  are so-called “COMMAND ESCAPES” which can be used to read in files, process shell
       commands, add and edit attachments and more.  For example <b>~v</b> or <b>~e</b> will start  the  VISUAL  text  EDITOR,
       respectively, to revise the message in its current state, <b>~h</b> allows editing of the most important message
       headers,  with  the  potent <b>~^</b> custom headers can be created, for example (more specifically than with <b>-C</b>
       and <u>customhdr</u>).  [Option]ally <b>~?</b> gives an overview of most other available command escapes.

       To create file-carbon-copies the special recipient header ‘Fcc:’ may be used as  often  as  desired,  for
       example  via  <b>~^</b>.   Its entire value (or body in standard terms) is interpreted as a <b>folder</b> target, after
       having been subject to “Filename transformations”: this is the only  way  to  create  a  file-carbon-copy
       without  introducing  an  ambiguity  regarding the interpretation of the address, file names with leading
       vertical bars or commercial ats can be used.  Like all other recipients ‘Fcc:’ is subject to  the  checks
       of <u>expandaddr</u>.  Any local file and pipe command addressee honours the setting of <u>mbox-fcc-and-pcc</u>.

       Once finished with editing the command escape <b>~.</b> (see there) will call hooks, insert automatic injections
       and receivers, leave compose mode and send the message once it is completed.  Aborting letter composition
       is  possible  with  either  of <b>~x</b> or <b>~q</b>, the latter of which will save the message in the file denoted by
       DEAD unless no<u>save</u> is set.  And unless <u>ignoreeof</u> is set the effect of <b>~.</b> can also be achieved  by  typing
       end-of-transmission  (EOT)  via  ‘control-D’  (‘^D’)  at the beginning of an empty line, and <b>~q</b> is always
       reachable by typing end-of-text (ETX) twice via ‘control-C’ (‘^C’).

       The compose mode hooks <u>on-compose-enter</u>, <u>on-compose-splice</u>, <u>on-compose-leave</u> and  <u>on-compose-cleanup</u>  may
       be  set  to <b>define</b>d macros and provide reliable and increasingly powerful mechanisms to perform automated
       message  adjustments  dependent  on  message  context,  for  example  addition  of   message   signatures
       (<u>message-inject-head</u>,  <u>message-inject-tail</u>)  or  creation  of  additional receiver lists (also by setting
       <u>autocc</u>, <u>autobcc</u>).  To achieve that the command <b>digmsg</b> may be used in order to query and adjust status  of
       message(s).   The  splice  hook  can also make use of “COMMAND ESCAPES”.  ([v15 behaviour may differ] The
       compose mode hooks work for <b>forward</b>, <b>mail</b>, <b>reply</b> and variants; <b>resend</b> and <b>Resend</b> only provide  the  hooks
       <u>on-resend-enter</u> and <u>on-resend-cleanup</u>, which are pretty restricted due to the nature of the operation.)

   <b>On</b> <b>reading</b> <b>mail,</b> <b>and</b> <b>more</b> <b>on</b> <b>interactive</b> <b>mode</b>
       When  invoked  without  addressees  S-nail enters interactive mode in which mails may be read.  When used
       like that the user's system <u>inbox</u> (for more on mailbox types please see the command <b>folder</b>)  is  read  in
       and  a  one  line  header of each message therein is displayed if the variable <u>header</u> is set.  The visual
       style of this summary of <b>headers</b> can be adjusted through the variable <u>headline</u> and the  possible  sorting
       criterion via <u>autosort</u>.  Scrolling through <u>screen</u>fuls of <b>headers</b> can be performed with the command <b>z</b>.  If
       the  initially  opened mailbox is empty S-nail will instead exit immediately (after displaying a message)
       unless the variable <u>emptystart</u> is set.

       At the <u>prompt</u> the command <b>list</b> will give a listing of all available commands and <b>help</b>  will  [Option]ally
       give a summary of some common ones.  If the [Option]al documentation strings are available (see <u>features</u>)
       one  can  type  ‘help  X’  (or  ‘?X’)  and see the actual expansion of ‘X’ and what its purpose is, i.e.,
       commands can be abbreviated (note that POSIX defines some abbreviations, so that the  alphabetical  order
       of commands does not necessarily relate to the abbreviations; it is however possible to define overwrites
       with <b>commandalias</b>).  These commands can also produce a more <u>verbose</u> output.

       Messages  are  given  numbers (starting at 1) which uniquely identify messages; the current message – the
       “dot” – will either be the first new message, or the first unread message, or the first  message  of  the
       mailbox;  the  internal  variable <u>showlast</u> will instead cause usage of the last message for this purpose.
       The command <b>headers</b> will display a <u>screen</u>ful of header summaries containing the “dot”, whereas <b>from</b>  will
       display only the summaries of the given messages, defaulting to the “dot”.

       Message  content  can  be  displayed  with  the  command  <b>type</b> (‘t’, alias <b>print</b>).  Here the variable <u>crt</u>
       controls whether and when S-nail will use the configured PAGER for display instead of directly writing to
       the user terminal <u>screen</u>, the sole difference to the command <b>more</b>, which will always use the PAGER.   The
       command  <b>top</b>  will instead only show the first <u>toplines</u> of a message (maybe even compressed if <u>topsqueeze</u>
       is set).  Message display experience may improve by setting and adjusting <u>mime-counter-evidence</u>, and also
       see “HTML mail and MIME attachments”.

       By default the current message (“dot”) is displayed, but like with many other commands it is possible  to
       give a fancy message specification (see “Specifying messages”), for example ‘t:u’ will display all unread
       messages,  ‘t.’  will  display  the  “dot”, ‘t 1 5’ will type the messages 1 and 5, ‘t 1-5’ will type the
       messages 1 through 5, and ‘t-’ and ‘t+’ will display the previous and  the  next  message,  respectively.
       The command <b>search</b> (a more substantial alias for <b>from</b>) will display a header summary of the given message
       specification list instead of their content; the following will search for subjects:

             ? <b>from</b> <b>'@Some</b> <b>subject</b> <b>to</b> <b>search</b> <b>for'</b>

       In  the  default  setup  all  header  fields  of  a  message  will  be <b>type</b>d, but fields can be white- or
       blacklisted for a variety of applications by using  the  command  <b>headerpick</b>,  e.g.,  to  restrict  their
       display  to  a  very  restricted  set for <b>type</b>: ‘<b>headerpick</b> <b>type</b> <b>retain</b> <u>from</u> <u>to</u> <u>cc</u> <u>subject</u>’.  In order to
       display all header fields of a message regardless of currently active ignore or  retain  lists,  use  the
       commands  <b>Type</b>  and  <b>Top</b>;  <b>Show</b>  will  show  the  raw message content.  Note that historically the global
       <u>s-nail.rc</u> not only adjusts the list of displayed headers, but also sets <u>crt</u>.  ([v15 behaviour may differ]
       A yet somewhat restricted) Reliable scriptable message inspection is available via <b>digmsg</b>.

       Dependent upon the configuration a line editor (see the section “On terminal control  and  line  editor”)
       aims  at making the user experience with the many “COMMANDS” a bit nicer.  When reading the system <u>inbox</u>,
       or when <b>-f</b> (or <b>folder</b>) specified a mailbox  explicitly  prefixed  with  the  special  ‘%:’  modifier  (to
       propagate  it  to  a “primary system mailbox”), then messages which have been read (see “Message states”)
       will be automatically moved to a “secondary mailbox”, the user's MBOX file, when  the  mailbox  is  left,
       either  by  changing  the  active mailbox or by quitting S-nail – this automatic moving from a system- or
       primary- to the secondary mailbox is not performed when the variable <u>hold</u> is set.  Messages can  also  be
       explicitly <b>move</b>d to other mailboxes, whereas <b>copy</b> keeps the original message.  <b>write</b> can be used to write
       out data content of specific parts of messages.

       After  examining  a  message  the user can <b>reply</b> ‘r’ to the sender and all recipients (which will also be
       placed in ‘To:’ unless <u>recipients-in-cc</u> is set), or <b>Reply</b> ‘R’ exclusively to the  sender(s).   To  comply
       with  with  the  receivers desired reply address the “quadoption”s <u>followup-to-honour</u> and <u>reply-to-honour</u>
       should usually be set.  The commands <b>Lreply</b> and <b>Lfollowup</b> know how to apply a special addressee  massage,
       see  “Mailing  lists”.  Dependent on the presence and value of <u>quote</u> the message being replied to will be
       included in a quoted form.  <b>forward</b>ing a message will allow editing the new message: the original message
       will be contained in the message body, adjusted according to <b>headerpick</b>.  It is  possible  to  <b>resend</b>  or
       <b>Resend</b>  messages:  the  former  will  add  a  series  of  ‘Resent-’ headers, whereas the latter will not;
       different to newly created messages editing is not possible and no copy will be saved  even  with  <u>record</u>
       unless  the  additional  variable  <u>record-resent</u>  is  set.  When sending, replying or forwarding messages
       comments and full names will be stripped from recipient addresses unless the internal variable  <u>fullnames</u>
       is set.

       Of  course messages can be <b>delete</b> ‘d’, and they can spring into existence again via <b>undelete</b>, or when the
       S-nail session is ended via the <b>exit</b> or <b>xit</b> commands to perform a quick program termation.  To end a mail
       processing session regularly and perform a full program exit one may issue the command  <b>quit</b>.   It  will,
       among  others,  move read messages to the “secondary mailbox” MBOX as necessary, discard deleted messages
       in the current mailbox, and update the [Option]al (see <u>features</u>) line editor <u>history-file</u>.  By  the  way,
       whenever  the  main  event  loop  is  about  to look out for the next input line it will trigger the hook
       <u>on-main-loop-tick</u>.

   <b>HTML</b> <b>mail</b> <b>and</b> <b>MIME</b> <b>attachments</b>
       HTML-only messages become more and more common, and many messages come bundled with  a  bouquet  of  MIME
       (Multipurpose  Internet Mail Extensions) parts and attachments.  To get a notion of MIME types there is a
       built-in default set, onto which the content of “The mime.types files” will be added (as  configured  and
       allowed  by  <u>mimetypes-load-control</u>).   Types  can  also  become  registered  and listed with the command
       <b>mimetype</b>.   To  improve  interaction  with   the   faulty   MIME   part   declarations   of   real   life
       <u>mime-counter-evidence</u>  will  allow  verification of the given assertion, and the possible provision of an
       alternative, better MIME type.  Note plain text parts will always be preferred in ‘multipart/alternative’
       MIME messages unless <u>mime-alternative-favour-rich</u> is set.

       Whereas a simple HTML-to-text filter for displaying HTML messages is [Option]ally supported (indicated by
       ‘,+filter-html-tagsoup,’ in <u>features</u>), MIME types other than plain text cannot be handled  directly.   To
       deal  with  specific  non-text  MIME types or file extensions programs need to be registered which either
       prepare (re-)integrable plain text versions of their input (a mode which  is  called  <b>copiousoutput</b>),  or
       display  the content externally, for example in a graphical window: the latter type is only considered by
       and for the command <b>mimeview</b>.

       To install a handler program for a MIME type an according <u>pipe-TYPE/SUBTYPE</u> variable needs to be set;  to
       define  a  handler  for  a  file  extension  <u>pipe-EXTENSION</u> can be used – these handlers take precedence.
       [Option]ally mail user agent configuration is supported (see “The Mailcap files”), and  will  be  queried
       for  display  or quote handlers after the former ones.  Type-markers registered via <b>mimetype</b> are the last
       possible source for information how to handle a MIME type.

       For example, to display HTML messages integrated via the text browsers <u><a href="../man1/lynx.1.html">lynx</a></u>(1) or <u><a href="../man1/elinks.1.html">elinks</a></u>(1),  register  a
       MathML  MIME  type  and  enable  its  plain  text display, and to open PDF attachments in an external PDF
       viewer, asynchronously and with some other magic attached:

             ? if "$features" !% ,+filter-html-tagsoup,
             ?   #set pipe-text/html='?* elinks -force-html -dump 1'
             ?   set pipe-text/html='?* lynx -stdin -dump -force_html'
             ?   # Display HTML as plain text instead
             ?   #set pipe-text/html=?t
             ? endif

             ? mimetype ?t application/mathml+xml mathml

             ? wysh set pipe-application/pdf='?&amp;=? \
                 trap "rm -f \"${MAILX_FILENAME_TEMPORARY}\"" EXIT;\
                 trap "trap \"\" INT QUIT TERM; exit 1" INT QUIT TERM;\
                 mupdf "${MAILX_FILENAME_TEMPORARY}"'

             ? define showhtml {
             ?   \localopts yes
             ?   \set mime-alternative-favour-rich pipe-text/html=?h?
             ?   \type "$@"
             ? }
             ? \commandalias html \\call showhtml

   <b>Mailing</b> <b>lists</b>
       Known or subscribed-to mailing lists may be flagged in the summary of <b>headers</b> (<u>headline</u> format  character
       ‘%L’),  and  will  gain special treatment when sending mails: the variable <u>followup-to-honour</u> will ensure
       that a ‘Mail-Followup-To:’ header is honoured when a  message  is  being  replied  to  (<b>reply</b>,  <b>followup</b>,
       <b>Lreply</b>,  <b>Lfollowup</b>),  and  <u>followup-to</u>  controls  creation  of  this  header  when creating <b>mail</b>s, if the
       necessary user setup (from, sender); is available; then,  it  may  also  be  created  automatically,  for
       example  when  list-replying  via  <b>Lreply</b>  or  <b>Lfollowup</b>, when <b>followup</b> or <b>reply</b> is used and the messages
       ‘Mail-Followup-To:’ is honoured etc.

       The commands <b>mlist</b> and <b>mlsubscribe</b> manage S-nails notion of which addresses are mailing lists.  With  the
       [Option]al  regular  expression  support  any  address which contains any of the magic regular expression
       characters (‘^[*+?|$’; see <u><a href="../man7/re_format.7.html">re_format</a></u>(7) or <u><a href="../man7/regex.7.html">regex</a></u>(7), dependent on the host system) will be  compiled  and
       used  as  one,  possibly  matching many addresses.  It is not possible to escape the “magic”: in order to
       match special characters as-is, bracket expressions must be used, for example  ‘<b>search</b>  <b>@subject@'[[]open</b>
       <b>bracket'</b>’.

             ? set followup-to followup-to-honour=ask-yes \
                 reply-to-honour=ask-yes
             ? mlist <a href="mailto:a1@b1.c1">a1@b1.c1</a> <a href="mailto:a2@b2.c2">a2@b2.c2</a> '.*@lists\.c3$'
             ? mlsubscribe <a href="mailto:a4@b4.c4">a4@b4.c4</a> <a href="mailto:exact@lists.c3">exact@lists.c3</a>

       Known  and  subscribed  lists  differ in that for the latter the <u>user</u>s address is not part of a generated
       ‘Mail-Followup-To:’.  There are exceptions, for example if multiple lists are addressed and not all  have
       the  subscription  attribute.   When  replying  to  a  message  its list address (‘List-Post:’ header) is
       automatically and temporarily treated like a known <b>mlist</b>; dependent on the  variable  <u>reply-to-honour</u>  an
       existing  ‘Reply-To:’  is  used instead (if it is a single address on the same domain as ‘List-Post:’) in
       order to accept a list administrator's wish that is supposed to have been manifested like that.

       For convenience and compatibility with mail programs that  do  not  honour  the  non-standard  M-F-T,  an
       automatic user entry in the carbon-copy ‘Cc:’ address list of generated message can be created by setting
       <u>followup-to-add-cc</u>.  This entry will be added whenever the user will be placed in the ‘Mail-Followup-To:’
       list,  and is not a regular addressee already.  <u>reply-to-swap-in</u> tries to deal with the address rewriting
       that many mailing-lists nowadays perform to work around DKIM / DMARC etc. standard imposed problems.

   <b>Signed</b> <b>and</b> <b>encrypted</b> <b>messages</b> <b>with</b> <b>S/MIME</b>
       [Option] S/MIME provides two central mechanisms:  message  signing  and  message  encryption.   A  signed
       message  contains  some  data  in  addition to the regular text.  The data can be used to verify that the
       message has been sent using a valid certificate, that the sender address matches that in the certificate,
       and that the message text has not been altered.  Signing a message does not change its regular  text;  it
       can  be  read regardless of whether the recipients software is able to handle S/MIME.  It is thus usually
       possible to sign all outgoing messages if so desired.

       Encryption, in contrast, makes the message text invisible for all people except those who have access  to
       the  secret  decryption key.  To encrypt a message, the specific recipients public encryption key must be
       known.  It is therefore not possible to send encrypted mail to people unless their key has been retrieved
       from either previous communication or public key directories.  Because signing is performed with  private
       keys, and encryption with public keys, messages should always be signed before being encrypted.

       A  central  concept to S/MIME is that of the certification authority (CA).  A CA is a trusted institution
       that issues certificates.  For each of these certificates it can be verified that  it  really  originates
       from  the  CA,  provided  that the CA's own certificate is previously known.  A set of CA certificates is
       usually delivered and installed together with the cryptographical library  that  is  used  on  the  local
       system.  Therefore reasonable security for S/MIME on the Internet is provided if the source that provides
       that  library  installation  is  trusted.   It  is  also  possible  to  use  a  specific  pool of trusted
       certificates.  If this is desired,  <u>smime-ca-no-defaults</u>  should  be  set  to  avoid  using  the  default
       certificate  pool,  and  <u>smime-ca-file</u>  and/or  <u>smime-ca-dir</u>  should  be  pointed  to  a  trusted pool of
       certificates.  A certificate cannot be more secure than the method its CA certificate has been  retrieved
       with.

       This  trusted pool of certificates is used by the command <b>verify</b> to ensure that the given S/MIME messages
       can be trusted.  If so, verified sender certificates that were embedded in signed messages can  be  saved
       locally  with  the  command  <b>certsave</b>,  and  used  by  S-nail to encrypt further communication with these
       senders:

             ? certsave FILENAME
             ? set smime-encrypt-USER@HOST=FILENAME \
                 smime-cipher-USER@HOST=AES256

       To sign outgoing messages, in order to allow receivers to verify the origin of these messages, a personal
       S/MIME certificate is required.  S-nail supports password-protected personal certificates (and keys), see
       <u>smime-sign-cert</u>.  The section “On URL syntax and credential lookup” gives an  overview  of  the  possible
       sources of user credentials, and “S/MIME step by step” shows examplarily how a private S/MIME certificate
       can  be obtained.  In general, if such a private key plus certificate “pair” is available, all that needs
       to be done is to set some variables:

             ? set smime-sign-cert=<a href="mailto:ME@exam.ple.paired">ME@exam.ple.paired</a> \
                 smime-sign-digest=SHA512 \
                 smime-sign from=<a href="mailto:myname@my.host">myname@my.host</a>

       Variables  of  interest  for  S/MIME  in  general  are   <u>smime-ca-dir</u>,   <u>smime-ca-file</u>,   <u>smime-ca-flags</u>,
       <u>smime-ca-no-defaults</u>,  <u>smime-crl-dir</u>,  <u>smime-crl-file</u>.   For  S/MIME  signing of interest are <u>smime-sign</u>,
       <u>smime-sign-cert</u>, <u>smime-sign-include-certs</u> and <u>smime-sign-digest</u>.  Additional variables  of  interest  for
       S/MIME en- and decryption: <u>smime-cipher</u> and <u>smime-encrypt-USER@HOST</u>.  Variables of secondary interest may
       be  <u>content-description-smime-message</u>  and  <u>content-description-smime-signature</u>.   S/MIME is available if
       ‘,+smime,’ is included in <u>features</u>.

       [v15 behaviour may differ] Note that neither S/MIME signing nor encryption applies to message subjects or
       other header fields yet.  Thus they may not contain sensitive information  for  encrypted  messages,  and
       cannot  be  trusted  even  if the message content has been verified.  When sending signed messages, it is
       recommended to repeat any important header information in the message text.

   <b>On</b> <b>URL</b> <b>syntax</b> <b>and</b> <b>credential</b> <b>lookup</b>
       For accessing  protocol-specific  resources  Uniform  Resource  Locators  (URL,  RFC  3986)  have  become
       omnipresent.  Here they are expected in a “normalized” variant, not used in data exchange, but only meant
       as  a compact, easy-to-use way of defining and representing information in a well-known notation; as such
       they do not conform to any real standard.  Optional parts are placed in brackets  ‘[]’,  optional  either
       because  there also exist other ways to define the information, or because the part is protocol specific.
       ‘/path’ for example is used by the [Option]al Maildir <b>folder</b> type and the IMAP protocol, but not by POP3.
       If ‘USER’ and ‘PASSWORD’ are included in an URL server specification,  URL  percent  encoded  (RFC  3986)
       forms are needed, generable with <b>urlcodec</b>.

             <b>PROTOCOL://[USER[:PASSWORD]@]server[:port][/path]</b>

       Often  “INTERNAL  VARIABLES”  exist  in multiple versions, called “variable chains” in this document: the
       plain ‘variable’ as well as ‘variable-HOST’ and ‘variable-USER@HOST’.  If a  port  was  specified  ‘HOST’
       really  means  ‘server:port’,  not  ‘server’.  And this ‘USER’ is never in URL percent encoded form.  For
       example, whether the hypothetical ‘smtp://wings%<a href="mailto:3Aof@a.dove">3Aof@a.dove</a>’ including user and  password  was  used,  or
       whether  it was ‘smtp://a.dove’ and it came from a different source, to lookup the chain <u>tls-config-pairs</u>
       first ‘tls-config-pairs-wings:<a href="mailto:of@a.dove">of@a.dove</a>’ is looked up,  then  ‘tls-config-pairs-a.dove’,  before  finally
       looking up the plain variable.

       The logic to collect (an <b>account</b>s) credential information is as follows:

       <b>•</b>   A  user  is always required.  If no ‘USER’ has been given in the URL the variables <u>user-HOST</u> and <u>user</u>
           are  looked  up.   Afterwards,  when  enforced  by  the  [Option]al  variables  <u>netrc-lookup-HOST</u>  or
           <u>netrc-lookup</u>,  “The  .netrc  file”  of  the  user  will be searched for a ‘HOST’ specific entry which
           provides a ‘login’ name: only unambiguous entries are used (one possible matching entry for ‘HOST’).

           If there is still no ‘USER’ then the verified LOGNAME, known to be a valid user on the current  host,
           is used.

       <b>•</b>   Authentication:   unless  otherwise  noted  the  chain  <u>PROTOCOL-auth-USER@HOST</u>,  <u>PROTOCOL-auth-HOST</u>,
           <u>PROTOCOL-auth</u> is checked, falling back to a protocol-specific default as necessary.

       <b>•</b>   If no ‘PASSWORD’ has been given in the URL, then if the ‘USER’ has been found through the  [Option]al
           <u>netrc-lookup</u>,  that  may  have  also  provided the password.  Otherwise the chain <u>password-USER@HOST</u>,
           <u>password-HOST</u>, <u>password</u> is looked up.

           Thereafter  the  (now   complete)   [Option]al   chain   <u>netrc-lookup-USER@HOST</u>,   <u>netrc-lookup-HOST</u>,
           <u>netrc-lookup</u>  is  checked,  if  set  the  <b>netrc</b>  cache is searched for a password only (multiple user
           accounts for a single machine may exist as  well  as  a  fallback  entry  without  user  but  with  a
           password).

           If  at  that  point  there is still no password available, but the (protocols') chosen authentication
           type requires a password, then in interactive mode the user will be prompted on the terminal.

       <b>Note:</b> S/MIME verification works relative to the  values  found  in  the  ‘From:’  (or  ‘Sender:’)  header
       field(s),   which   means   the  values  of  <u>smime-sign</u>,  <u>smime-sign-cert</u>,  <u>smime-sign-include-certs</u>  and
       <u>smime-sign-digest</u> will not be looked up using the ‘USER’ and ‘HOST’ chains from above,  but  instead  use
       the  corresponding  values from the message that is being worked on.  If no address matches we assume and
       use the setting of <u>from</u>.  In unusual cases multiple and different  ‘USER’  and  ‘HOST’  combinations  may
       therefore  be  involved  –  on  the other hand those unusual cases become possible.  The usual case is as
       short as:

             set mta=smtp://USER:PASS@HOST smtp-use-starttls \
                 smime-sign smime-sign-cert=+smime.pair \
                 from=<a href="mailto:myname@my.host">myname@my.host</a>

       The section “EXAMPLES” contains complete example configurations.

   <b>Encrypted</b> <b>network</b> <b>communication</b>
       [Option] SSL (Secure Sockets Layer) aka its successor TLS (Transport Layer Security) are protocols  which
       aid  in  securing  communication  by  providing  a  safely initiated and encrypted network connection.  A
       central concept of TLS are certificates: as part of each network connection setup a (set of) certificates
       will be exchanged through which the identity of the network peer can be  cryptographically  verified;  if
       possible  the  TLS/SNI  (ServerNameIndication)  extension  will  be enabled to allow servers fine-grained
       control over the certificates being used.  A locally installed pool of trusted certificates will then  be
       inspected,  and  verification  will  succeed  if  it  contains  a(n  in)direct  signer  of  the presented
       certificate(s).

       The local pool of trusted so-called CA (Certification Authority) certificates is usually  delivered  with
       and  used  along  the  TLS  library.   A  custom pool of trusted certificates can be selected by pointing
       <u>tls-ca-file</u>  and/or  (with  special  preparation)   <u>tls-ca-dir</u>   to   the   desired   location;   setting
       <u>tls-ca-no-defaults</u>  in  addition  will  avoid  additional  inspection of the default pool.  A certificate
       cannot be more secure than the method its CA certificate has been  retrieved  with.   For  inspection  or
       other  purposes,  the  certificate  of  a  server (as seen when connecting to it) can be fetched with the
       command <b>tls</b> (port can usually be the protocol name, too, and <u>tls-verify</u> is taken into account here):

             $ s-nail -vX 'tls certchain SERVER-URL[:PORT]; x'

       A local pool of CA certificates is not strictly necessary,  however,  server  certificates  can  also  be
       verified  via  their  fingerprint.  For this a message digest will be calculated and compared against the
       variable chain <u>tls-fingerprint</u>, and verification will succeed if the fingerprint  matches.   The  message
       digest  (algorithm)  can  be  configured  via the variable chain <u>tls-fingerprint-digest</u>; <b>tls</b> can again be
       used:

             $ s-nail -X 'wysh set verbose; tls fingerprint SERVER-URL[:PORT]; x'

       It depends on the used protocol whether encrypted communication  is  possible,  and  which  configuration
       steps  have to be taken to enable it.  Some protocols, like POP3S, are implicitly encrypted, others, like
       POP3, can upgrade a plain text connection if so requested.  For example, to  use  the  ‘STLS’  that  POP3
       offers  (a  member  of)  the  variable  (chain)  <u>pop3-use-starttls</u>  needs to be set, with convenience via
       <b>shortcut</b>:

             shortcut encpop1 pop3s://pop1.exam.ple

             shortcut encpop2 pop3://pop2.exam.ple
             set pop3-use-starttls-pop2.exam.ple

             set mta=smtps://smtp.exam.ple:465
             set mta=smtp://smtp.exam.ple smtp-use-starttls

       Normally that is all there is to do, given that TLS libraries try to provide  safe  defaults,  plenty  of
       knobs  however exist to adjust settings.  For example certificate verification settings can be fine-tuned
       via <u>tls-ca-flags</u>, and the TLS configuration basics are accessible via <u>tls-config-pairs</u>,  for  example  to
       control  protocol versions or cipher lists.  In the past hints on how to restrict the set of protocols to
       highly secure ones were indicated, but as of the time of this writing the list of  protocols  or  ciphers
       may  need  to become relaxed in order to be able to connect to some servers; the following example allows
       connecting to a “Lion” that uses OpenSSL 0.9.8za from June 2014 (refer to “INTERNAL VARIABLES”  for  more
       on variable chains):

             wysh set <a href="mailto:tls-config-pairs-lion@exam.ple">tls-config-pairs-lion@exam.ple</a>='MinProtocol=TLSv1.1,\
                 CipherString=TLSv1.2:!aNULL:!eNULL:\
                   ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:\
                   DHE-RSA-AES256-SHA:@STRENGTH'

       The  OpenSSL  program  <u><a href="../man1/ciphers.1.html">ciphers</a></u>(1) should be referred to when creating a custom cipher list.  Variables of
       interest  for  TLS  in   general   are   <u>tls-ca-dir</u>,   <u>tls-ca-file</u>,   <u>tls-ca-flags</u>,   <u>tls-ca-no-defaults</u>,
       <u>tls-config-file</u>, <u>tls-config-module</u>, <u>tls-config-pairs</u>, <u>tls-crl-dir</u>, <u>tls-crl-file</u>, <u>tls-rand-file</u> as well as
       <u>tls-verify</u>.  Also see <u>tls-features</u>.  TLS is available if ‘+tls’ is included in <u>features</u>.

   <b>Character</b> <b>sets</b>
       [Option]  The  user's  locale environment is detected by looking at the LC_ALL environment variable.  The
       internal variable <u>ttycharset</u> will be set to the detected terminal character  set  accordingly,  and  will
       thus  show  up  in the output of commands like <b>set</b> and <b>varshow</b>.  This character set will be targeted when
       trying to display data, and user input data is expected to be in this character set, too.

       When creating messages their character input data is classified.  7-bit clean text data  and  attachments
       will  be  classified  as  <u>charset-7bit</u>.   8-bit  data  will  [Option]ally  be  converted  into members of
       <u>sendcharsets</u> until a character set conversion succeeds.  <u>charset-8bit</u> is the implied default last  member
       of this list.  If no 8-bit character set is capable to represent input data, no message will be sent, and
       its  text  will  optionally  be  <u>save</u>d  in  DEAD.   If  that  is  not  acceptable,  for example in script
       environments,  <u>mime-force-sendout</u>  can  be  set   to   force   sending   of   non-convertible   data   as
       ‘application/octet-stream’  classified  binary content instead: like this receivers still have the option
       to inspect message content (for example via <u>mime-counter-evidence</u>).   If  the  [Option]al  character  set
       conversion  is not available (<u>features</u> misses ‘,+iconv,’), <u>ttycharset</u> is the only supported character set
       for non 7-bit clean data, and it is simply assumed it can be used to exchange 8-bit messages.

       <u>ttycharset</u> may also be given an explicit value to send mail in a completely “faked”  locale  environment,
       which  can  be  used  to  generate  and  send for example 8-bit UTF-8 input data in a pure 7-bit US-ASCII
       ‘LC_ALL=C’ environment (an example of this can be found  in  the  section  “On  sending  mail,  and  non-
       interactive  mode”).  Due to lack of programming interfaces reading mail will not really work as expected
       in a faked environment: whereas  <u>ttycharset</u>  might  be  addressable,  any  output  will  be  made  safely
       printable,  as  via <b>vexpr</b> <b>makeprint</b>, according to the actual locale environment, which is not affected by
       <u>ttycharset.</u>

       Classifying 7-bit clean data as <u>charset-7bit</u> is a problem if the input character set  (<u>ttycharset</u>)  is  a
       multibyte  character set that is itself 7-bit clean.  For example, the Japanese character set ISO-2022-JP
       is, but is capable to encode the rich set of Japanese Kanji, Hiragana and Katakana characters:  in  order
       to notify receivers of this character set the mail message must be MIME encoded so that the character set
       ISO-2022-JP  can  be  advertised,  otherwise an invalid email message would result!  To achieve this, the
       variable <u>charset-7bit</u> can be set to ISO-2022-JP.  (Today a better approach regarding email is  the  usage
       of UTF-8, which uses 8-bit bytes for non-US-ASCII data.)

       When  replying  to  a  message  and  the  variable <u>reply-in-same-charset</u> is set, the character set of the
       message being replied to is tried first as a target character set (still being a subject of  <b>charsetalias</b>
       filtering,  however).   Another  opportunity is <u>sendcharsets-else-ttycharset</u> to reflect the user's locale
       environment automatically, it will treat <u>ttycharset</u> as an implied member of (an unset) <u>sendcharsets</u>.

       [Option] When reading messages, their text data is converted into <u>ttycharset</u> as  necessary  in  order  to
       display  them on the user's terminal.  Unprintable characters and invalid byte sequences are detected and
       replaced by substitution characters.  Character set mappings for source character sets can be established
       with <b>charsetalias</b>, which may be handy to work around faulty or incomplete character set  catalogues  (one
       could  for  example add a missing LATIN1 to ISO-8859-1 mapping), or to enforce treatment of one character
       set as another one (“interpret LATIN1 as CP1252”).  Also see <u>charset-unknown-8bit</u> to  deal  with  another
       hairy aspect of message interpretation.

       In  general,  if  a  message  saying “cannot convert from a to b” appears, either some characters are not
       appropriate for the currently selected  (terminal)  character  set,  or  the  needed  conversion  is  not
       supported by the system.  In the first case, it is necessary to set an appropriate LC_CTYPE locale and/or
       the variable <u>ttycharset</u>.  The best results are usually achieved when running in a UTF-8 locale on a UTF-8
       capable  terminal,  in  which  case  the full Unicode spectrum of characters is available.  In this setup
       characters from various countries can be displayed, while  it  is  still  possible  to  use  more  simple
       character sets for sending to retain maximum compatibility with older mail clients.

       On  the  other  hand  the POSIX standard defines a locale-independent 7-bit “portable character set” that
       should be used when overall portability is an issue, the even  more  restricted  subset  named  “portable
       filename character set” consists of A-Z, a-z, 0-9, period ‘.’, underscore ‘_’ and hyphen-minus ‘-’.

   <b>Message</b> <b>states</b>
       S-nail  differentiates  in  between  several  message  states; the current state will be reflected in the
       summary of <b>headers</b> if the <u>attrlist</u> of the configured <u>headline</u> allows, and “Specifying messages” dependent
       on their state is possible.  When operating on  the  system  <u>inbox</u>,  or  in  any  other  “primary  system
       mailbox”,  special actions, like the automatic moving of messages to the “secondary mailbox” MBOX, may be
       applied when the mailbox is left (also implicitly by program termination, unless  the  command  <b>exit</b>  was
       used)  –  however,  because  this  may  be irritating to users which are used to “more modern” mail-user-
       agents, the provided global <u>s-nail.rc</u> template sets the internal <u>hold</u> and <u>keepsave</u> variables in order  to
       suppress this behaviour.

       ‘new’     Message  has neither been viewed nor moved to any other state.  Such messages are retained even
                 in the “primary system mailbox”.

       ‘unread’  Message has neither been viewed nor moved to any other  state,  but  the  message  was  present
                 already  when the mailbox has been opened last: Such messages are retained even in the “primary
                 system mailbox”.

       ‘read’    The message has been processed by one of the following commands: <b>~f</b>, <b>~m</b>, <b>~F</b>,  <b>~M</b>,  <b>copy</b>,  <b>mbox</b>,
                 <b>next</b>, <b>pipe</b>, <b>Print</b>, <b>print</b>, <b>top</b>, <b>Type</b>, <b>type</b>, <b>undelete</b>.  The commands <b>dp</b> and <b>dt</b> will always try to
                 automatically  “step”  and <b>type</b> the “next” logical message, and may thus mark multiple messages
                 as read, the <b>delete</b> command will do so if the internal variable <u>autoprint</u> is set.

                 Except when the <b>exit</b> command is used, messages that are in a “primary system mailbox”  and  are
                 in  ‘read’  state when the mailbox is left will be saved in the “secondary mailbox” MBOX unless
                 the internal variable <u>hold</u> it set.

       ‘deleted’ The message has been processed by one of the following commands: <b>delete</b>, <b>dp</b>, <b>dt</b>.  Only <b>undelete</b>
                 can be used to access such messages.

       ‘preserved’ The message has been processed by a <b>preserve</b> command and it will be retained in  its  current
                 location.

       ‘saved’   The  message  has  been processed by one of the following commands: <b>save</b> or <b>write</b>.  Unless when
                 the <b>exit</b> command is used, messages that are in a “primary system mailbox” and  are  in  ‘saved’
                 state  when  the mailbox is left will be deleted; they will be saved in the “secondary mailbox”
                 MBOX when the internal variable <u>keepsave</u> is set.

       In addition to these message states, flags which otherwise have no technical meaning in the  mail  system
       except allowing special ways of addressing them when “Specifying messages” can be set on messages.  These
       flags  are  saved  with  messages  and are thus persistent, and are portable between a set of widely used
       MUAs.

       <b>answered</b>  Mark messages as having been answered.

       <b>draft</b>     Mark messages as being a draft.

       <b>flag</b>      Mark messages which need special attention.

   <b>Specifying</b> <b>messages</b>
       [Only new quoting rules] <b>COMMANDS</b> which take “Message list arguments”, such as <b>search</b>,  <b>type</b>,  <b>copy</b>,  and
       <b>delete</b>,  can  perform  actions  on  a  number of messages at once.  Specifying invalid messages, or using
       illegal syntax, will cause errors to be reported through the “INTERNAL VARIABLES” <u>!</u>, <u>^ERR</u> and companions,
       as well as the command exit status <u>?</u>.

       For example, ‘delete 1 2’ deletes the messages 1 and 2, whereas ‘delete 1-5’ will delete the  messages  1
       through 5.  In sorted or threaded mode (see the <b>sort</b> command), ‘delete 1-5’ will delete the messages that
       are  located  between  (and including) messages 1 through 5 in the sorted/threaded order, as shown in the
       <b>headers</b> summary.

       Errors can for example be <u>^ERR</u>-BADMSG when requesting an invalid message,  <u>^ERR</u>-NOMSG  if  no  applicable
       message  can  be found, <u>^ERR</u>-CANCELED for missing informational data (mostly thread-related).  <u>^ERR</u>-INVAL
       for invalid syntax as well as <u>^ERR</u>-IO for input/output errors can happen.  The following special  message
       names exist:

       <u>.</u>         The current message, the so-called “dot”.

       <u>;</u>         The message that was previously the current message; needs to be quoted.

       <u>,</u>         The parent message of the current message, that is the message with the Message-ID given in the
                 ‘In-Reply-To:’ field or the last entry of the ‘References:’ field of the current message.

       <u>-</u>         The  previous  undeleted  message, or the previous deleted message for the <b>undelete</b> command; In
                 <b>sort</b>ed or ‘thread’ed mode, the previous such message in the according order.

       <u>+</u>         The next undeleted message, or the next deleted message for the <b>undelete</b> command; In <b>sort</b>ed  or
                 ‘thread’ed mode, the next such message in the according order.

       <u>^</u>         The  first  undeleted message, or the first deleted message for the <b>undelete</b> command; In <b>sort</b>ed
                 or ‘thread’ed mode, the first such message in the according order.

       <u>$</u>         The last message; In <b>sort</b>ed or ‘thread’ed mode, the last such message in the  according  order.
                 Needs to be quoted.

       <u>&amp;x</u>        In  ‘thread’ed  <b>sort</b>  mode,  selects the message addressed with <u>x</u>, where <u>x</u> is any other message
                 specification, and all messages from the thread that begins at it.  Otherwise it  is  identical
                 to <u>x</u>.  If <u>x</u> is omitted, the thread beginning with the current message is selected.

       <u>*</u>         All messages.

       <u>`</u>         All  messages that were included in the “Message list arguments” of the previous command; needs
                 to be quoted.  (A convenient way to read all new messages is to select them via ‘from  :n’,  as
                 below,  and then to read them in order with the default command — <b>next</b> — simply by successively
                 typing ‘`’; for this to work <u>showlast</u> must be set.)

       <u>x-y</u>       An inclusive range of message numbers.  Selectors that may also be used  as  endpoints  include
                 any of <u>.;-+^$</u>.

       <u>address</u>   A  case-insensitive “any substring matches” search against the ‘From:’ header, which will match
                 addresses (too) even if <u>showname</u> is set (and POSIX says “any  address  as  shown  in  a  header
                 summary  shall  be  matchable  in this form”); However, if the <u>allnet</u> variable is set, only the
                 local part of the address is evaluated for the comparison, not ignoring case, and  the  setting
                 of  <u>showname</u>  is completely ignored.  For finer control and match boundaries use the ‘@’ search
                 expression.

       <u>/string</u>   All messages that contain <u>string</u> in the subject field (case ignored according to locale).   See
                 also   the  <u>searchheaders</u>  variable.   If  <u>string</u>  is  empty,  the  string  from  the  previous
                 specification of that type is used again.

       [<u>@name-list</u>]<u>@expr</u>
                 All messages that contain the given case-insensitive  search  <u>expr</u>ession;   If  the  [Option]al
                 regular expression support is available <u>expr</u> will be interpreted as (an extended) one if any of
                 the  “magic regular expression characters” is seen.  If the optional <u>@name-list</u> part is missing
                 the search is restricted to the subject field body, but otherwise <u>name-list</u> specifies a  comma-
                 separated list of header fields to search, for example

                       <b>'@to,from,cc@Someone</b> <b>i</b> <b>ought</b> <b>to</b> <b>know'</b>

                 In  order to search for a string that includes a ‘@’ (commercial at) character the <u>name-list</u> is
                 effectively non-optional, but may be given as the empty  string.   Also,  specifying  an  empty
                 search <u>expr</u>ession will effectively test for existence of the given header fields.  Some special
                 header  fields  may  be  abbreviated: ‘f’, ‘t’, ‘c’, ‘b’ and ‘s’ will match ‘From’, ‘To’, ‘Cc’,
                 ‘Bcc’ and ‘Subject’, respectively and case-insensitively.  [Option]ally, and  just  like  <u>expr</u>,
                 <u>name-list</u>  will be interpreted as (an extended) regular expression if any of the “magic regular
                 expression characters” is seen.

                 The special names ‘header’ or ‘&lt;’ can be used to search  in  (all  of)  the  header(s)  of  the
                 message,  and the special names ‘body’ or ‘&gt;’ and ‘text’ or ‘=’ will perform full text searches
                 – whereas the former searches only the body, the latter also searches the message header  ([v15
                 behaviour  may  differ]  this  mode yet brute force searches over the entire decoded content of
                 messages, including administrativa strings).

                 This specification performs full text comparison, but even with regular expression  support  it
                 is  almost  impossible to write a search expression that safely matches only a specific address
                 domain.  To request that the body content of the header is treated as a list of addresses,  and
                 to  strip  those  down  to the plain email address which the search expression is to be matched
                 against, prefix the effective <u>name-list</u> with a tilde ‘~’:

                       <b>'@~f,c@@a\.safe\.domain\.match$'</b>

       <u>:c</u>        All messages of state or with matching condition ‘c’, where ‘c’  is  one  or  multiple  of  the
                 following colon modifiers:

                 <u>a</u>         <b>answered</b> messages (cf. the variable <u>markanswered</u>).
                 <u>d</u>         ‘deleted’ messages (for the <b>undelete</b> and <b>from</b> commands only).
                 <u>f</u>         <b>flag</b>ged messages.
                 <u>L</u>         Messages with receivers that match <b>mlsubscribe</b>d addresses.
                 <u>l</u>         Messages with receivers that match <b>mlist</b>ed addresses.
                 <u>n</u>         ‘new’ messages.
                 <u>o</u>         Old messages (any not in state ‘read’ or ‘new’).
                 <u>r</u>         ‘read’ messages.
                 <u>S</u>         [Option] Messages with unsure spam classification (see “Handling spam”).
                 <u>s</u>         [Option] Messages classified as spam.
                 <u>t</u>         Messages marked as <b>draft</b>.
                 <u>u</u>         ‘unread’ messages.

       [Option]  IMAP-style  SEARCH expressions may also be used.  These consist of keywords and criterions, and
       because “Message list arguments” are split into tokens according to “Shell-style argument quoting” it  is
       necessary  to  quote the entire IMAP search expression in order to ensure that it remains a single token.
       This addressing mode is available with all types of mailbox  <b>folder</b>s;  S-nail  will  perform  the  search
       locally  as  necessary.  Strings must be enclosed by double quotation marks ‘"’ in their entirety if they
       contain whitespace or parentheses; within the quotes, only reverse solidus ‘\’ is recognized as an escape
       character.  All string searches are case-insensitive.  When the description indicates that the “envelope”
       representation of an address field is used, this means that the search string is checked against  both  a
       list constructed as

             '("name" "source" "local-part" "domain-part")'

       for  each  address,  and the addresses without real names from the respective header field.  These search
       expressions can be nested using parentheses, see below for examples.

       (<u>criterion</u>)
                 All messages that satisfy the given <u>criterion</u>.
       (<u>criterion1</u> <u>criterion2</u> <u>...</u> <u>criterionN</u>)
                 All messages that satisfy all of the given criteria.
       (<u>or</u> <u>criterion1</u> <u>criterion2</u>)
                 All messages that satisfy either <u>criterion1</u> or <u>criterion2</u>, or both.  To connect more  than  two
                 criteria using ‘or’ specifications have to be nested using additional parentheses, as with ‘(or
                 a  (or b c))’, since ‘(or a b c)’ really means ‘((a or b) and c)’.  For a simple ‘or’ operation
                 of independent criteria on the lowest nesting level, it is possible to achieve similar  effects
                 by using three separate criteria, as with ‘(a) (b) (c)’.
       (<u>not</u> <u>criterion</u>)
                 All messages that do not satisfy <u>criterion</u>.
       (<u>bcc</u> <u>"string"</u>)
                 All messages that contain <u>string</u> in the envelope representation of the ‘Bcc:’ field.
       (<u>cc</u> <u>"string"</u>)
                 All messages that contain <u>string</u> in the envelope representation of the ‘Cc:’ field.
       (<u>from</u> <u>"string"</u>)
                 All messages that contain <u>string</u> in the envelope representation of the ‘From:’ field.
       (<u>subject</u> <u>"string"</u>)
                 All messages that contain <u>string</u> in the ‘Subject:’ field.
       (<u>to</u> <u>"string"</u>)
                 All messages that contain <u>string</u> in the envelope representation of the ‘To:’ field.
       (<u>header</u> <u>name</u> <u>"string"</u>)
                 All messages that contain <u>string</u> in the specified ‘Name:’ field.
       (<u>body</u> <u>"string"</u>)
                 All messages that contain <u>string</u> in their body.
       (<u>text</u> <u>"string"</u>)
                 All messages that contain <u>string</u> in their header or body.
       (<u>larger</u> <u>size</u>)
                 All messages that are larger than <u>size</u> (in bytes).
       (<u>smaller</u> <u>size</u>)
                 All messages that are smaller than <u>size</u> (in bytes).
       (<u>before</u> <u>date</u>)
                 All  messages  that were received before <u>date</u>, which must be in the form ‘d[d]-mon-yyyy’, where
                 ‘d’ denotes the day of the month as one or two digits, ‘mon’ is the name of the month – one  of
                 ‘Jan  Feb  Mar Apr May Jun Jul Aug Sep Oct Nov Dec’, and ‘yyyy’ is the year as four digits, for
                 example ‘28-Dec-2012’.
       (<u>on</u> <u>date</u>)
                 All messages that were received on the specified date.
       (<u>since</u> <u>date</u>)
                 All messages that were received since the specified date.
       (<u>sentbefore</u> <u>date</u>)
                 All messages that were sent on the specified date.
       (<u>senton</u> <u>date</u>)
                 All messages that were sent on the specified date.
       (<u>sentsince</u> <u>date</u>)
                 All messages that were sent since the specified date.
       <u>()</u>        The same criterion as for the previous search.  This specification cannot be used  as  part  of
                 another  criterion.  If the previous command line contained more than one independent criterion
                 then the last of those criteria is used.

   <b>On</b> <b>terminal</b> <b>control</b> <b>and</b> <b>line</b> <b>editor</b>
       [Option] Terminal control through one of the standard Unix libraries, Termcap Access Library (libtermcap,
       -ltermcap) or Terminal Information Library (libterminfo, -lterminfo), may be available.  For the TERMinal
       defined in the environment interactive usage aspects, for example  “Coloured  display”,  and  insight  of
       cursor  and  function  keys  for  the  Mailx-Line-Editor  (MLE),  will  be  enhanced or enabled.  Library
       interaction can be disabled on a per-invocation basis via <u>termcap-disable</u>, whereas the internal  variable
       <u>termcap</u>  is  always  used  as  a preferred source of terminal capabilities.  (For a usage example see the
       “FAQ” entry “Not "defunctional", but the editor key does not work”.)

       [Option] The built-in Mailx-Line-Editor (MLE) should work in all environments which comply to the  ISO  C
       standard  ISO/IEC  9899/AMD1:1995 (“ISO C90, Amendment 1”), and will support wide glyphs if possible (the
       necessary functionality had been removed from ISO C, but was included in X/Open Portability Guide Issue 4
       (“XPG4”)).  Usage of a line editor in interactive mode can be prevented by  setting  <u>line-editor-disable</u>.
       Especially  if  the  [Option]al  terminal control support is missing setting entries in <u>termcap</u> will help
       shall the MLE misbehave, see there for more.  The MLE can support a little bit of <b>colour</b>.

       [Option] If the <b>history</b> feature is available then input from line editor  prompts  will  be  saved  in  a
       history  list  that  can  be searched in and be expanded from.  Such saving can be prevented by prefixing
       input with any amount of whitespace.  Aspects of history, like allowed content and maximum size, as  well
       as  whether  history  shall  be  saved  persistently,  can  be  configured  with  the  internal variables
       <u>history-file</u>, <u>history-gabby</u>, <u>history-gabby-persist</u> and <u>history-size</u>.  There also exists  the  macro  hook
       <u>on-history-addition</u> which can be used to apply finer control on what enters history.

       The MLE supports a set of editing and control commands.  By default (as) many (as possible) of these will
       be  assigned  to  a  set  of  single-letter  control codes, which should work on any terminal (and can be
       generated by holding the “control” key while pressing the key of desire, for  example  ‘control-D’).   If
       the  [Option]al  <b>bind</b> command is available then the MLE commands can also be accessed freely by assigning
       the command name, which is shown in parenthesis in the list below, to any desired key-sequence,  and  the
       MLE will instead and also use <b>bind</b> to establish its built-in key bindings (more of them if the [Option]al
       terminal  control  is  available),  an  action  which  can  then  be  suppressed  completely  by  setting
       <u>line-editor-no-defaults</u>.  “Shell-style argument quoting” notation is used in the following:

       ‘\cA’     Go to the start of the line (<b>mle-go-home</b>).
       ‘\cB’     Move the cursor backward one character (<b>mle-go-bwd</b>).
       ‘\cC’     <u><a href="../man3/raise.3.html">raise</a></u>(3) ‘SIGINT’ (<b>mle-raise-int</b>).
       ‘\cD’     Forward delete the character under the cursor; quits S-nail if used on the  empty  line  unless
                 the internal variable <u>ignoreeof</u> is set (<b>mle-del-fwd</b>).
       ‘\cE’     Go to the end of the line (<b>mle-go-end</b>).
       ‘\cF’     Move the cursor forward one character (<b>mle-go-fwd</b>).
       ‘\cG’     Cancel  current  operation,  full  reset.   If  there  is an active history search or tabulator
                 expansion then this command will first reset that, reverting to the former line content; thus a
                 second reset is needed for a full reset in this case (<b>mle-reset</b>).
       ‘\cH’     Backspace: backward delete one character (<b>mle-del-bwd</b>).
       ‘\cI’     [Only new quoting rules] Horizontal tabulator: try  to  expand  the  word  before  the  cursor,
                 supporting   the   usual   “Filename   transformations”  (<b>mle-complete</b>;  this  is  affected  by
                 <b>mle-quote-rndtrip</b> and <u>line-editor-cpl-word-breaks</u>).
       ‘\cJ’     Newline: commit the current line (<b>mle-commit</b>).
       ‘\cK’     Cut all characters from the cursor to the end of the line (<b>mle-snarf-end</b>).
       ‘\cL’     Repaint the line (<b>mle-repaint</b>).
       ‘\cN’     [Option] Go to the next history entry (<b>mle-hist-fwd</b>).
       ‘\cO’     ([Option]ally context-dependent) Invokes the command <b>dt</b>.
       ‘\cP’     [Option] Go to the previous history entry (<b>mle-hist-bwd</b>).
       ‘\cQ’     Toggle roundtrip mode shell quotes, where  produced,  on  and  off  (<b>mle-quote-rndtrip</b>).   This
                 setting  is  temporary,  and  will  be  forgotten  once the command line is committed; also see
                 <b>shcodec</b>.
       ‘\cR’     [Option]  Complete  the   current   line   from   (the   remaining)   older   history   entries
                 (<b>mle-hist-srch-bwd</b>).
       ‘\cS’     [Option]   Complete   the   current   line   from   (the   remaining)   newer  history  entries
                 (<b>mle-hist-srch-fwd</b>).
       ‘\cT’     Paste the snarf buffer (<b>mle-paste</b>).
       ‘\cU’     The same as ‘\cA’ followed by ‘\cK’ (<b>mle-snarf-line</b>).
       ‘\cV’     Prompts for a Unicode character (hexadecimal number without prefix, see <b>vexpr</b>) to  be  inserted
                 (<b>mle-prompt-char</b>).   Note  this command needs to be assigned to a single-letter control code in
                 order to become recognized and executed during input of  a  key-sequence  (only  three  single-
                 letter control codes can be used for that shortcut purpose); this control code is then special-
                 treated  and  thus  cannot  be  part  of  any  other  sequence  (because  it  will  trigger the
                 <b>mle-prompt-char</b> function immediately).
       ‘\cW’     Cut the  characters  from  the  one  preceding  the  cursor  to  the  preceding  word  boundary
                 (<b>mle-snarf-word-bwd</b>).
       ‘\cX’     Move the cursor forward one word boundary (<b>mle-go-word-fwd</b>).
       ‘\cY’     Move the cursor backward one word boundary (<b>mle-go-word-bwd</b>).
       ‘\cZ’     <u><a href="../man3/raise.3.html">raise</a></u>(3) ‘SIGTSTP’ (<b>mle-raise-tstp</b>).
       ‘\c[’     Escape:  reset  a  possibly  used  multibyte  character  input state machine and [Option]ally a
                 lingering, incomplete key binding (<b>mle-cancel</b>).  This command needs to be assigned to a single-
                 letter control code in order to become recognized and executed during input of  a  key-sequence
                 (only  three  single-letter control codes can be used for that shortcut purpose).  This control
                 code may also be part of a multi-byte sequence, but if  a  sequence  is  active  and  the  very
                 control code is currently also an expected input, then the active sequence takes precedence and
                 will consume the control code.
       ‘\c\’     ([Option]ally context-dependent) Invokes the command ‘<b>z</b>+’.
       ‘\c]’     ([Option]ally context-dependent) Invokes the command ‘<b>z</b>$’.
       ‘\c^’     ([Option]ally context-dependent) Invokes the command ‘<b>z</b>0’.
       ‘\c_’     Cut   the   characters  from  the  one  after  the  cursor  to  the  succeeding  word  boundary
                 (<b>mle-snarf-word-fwd</b>).
       ‘\c?’     Backspace: <b>mle-del-bwd</b>.
       –         <b>mle-bell</b>: ring the audible bell.
       –         [Option] <b>mle-clear-screen</b>: move the cursor home and clear the screen.
       –         <b>mle-fullreset</b>: different to <b>mle-reset</b> this will immediately reset a possibly active search etc.
       –         <b>mle-go-screen-bwd</b>: move the cursor backward one screen width.
       –         <b>mle-go-screen-fwd</b>: move the cursor forward one screen width.
       –         <b>mle-raise-quit:</b> <u><a href="../man3/raise.3.html">raise</a></u>(3) ‘SIGQUIT’.

   <b>Coloured</b> <b>display</b>
       [Option] Colours and font attributes through ANSI a.k.a. ISO 6429 SGR (select graphic  rendition)  escape
       sequences  are  optionally  supported.   Usage  of  colours  and  font attributes solely depends upon the
       capability of the detected terminal type (TERM), and as fine-tuned through  <u>termcap</u>.   Colours  and  font
       attributes  can  be managed with the multiplexer command <b>colour</b>, and <b>uncolour</b> removes the given mappings.
       Setting <u>colour-disable</u> suppresses usage of colour and font attribute sequences, while leaving established
       mappings unchanged.

       Whether actually applicable colour and font attribute sequences should also be generated when  output  is
       going  to  be  paged  through the external PAGER (also see <u>crt</u>) depends upon the setting of <u>colour-pager</u>,
       because pagers usually need to be configured in order to support ISO escape sequences.  Knowledge of some
       widely used pagers is however built-in, and in a clean environment it  is  often  enough  to  simply  set
       <u>colour-pager</u>; please refer to that variable for more on this topic.

       It  might  make  sense to conditionalize colour setup on interactive mode via <b>if</b> (‘terminal’ indeed means
       “interactive”):

             if terminal &amp;&amp; "$features" =% ,+colour,
               colour iso view-msginfo ft=bold,fg=green
               colour iso view-header ft=bold,fg=red (from|subject) # regex
               colour iso view-header fg=red

               uncolour iso view-header from,subject
               colour iso view-header ft=bold,fg=magenta,bg=cyan
               colour 256 view-header ft=bold,fg=208,bg=230 "subject,from"
               colour mono view-header ft=bold
               colour mono view-header ft=bold,ft=reverse subject,from
             endif

   <b>Handling</b> <b>spam</b>
       [Option] S-nail can make use of several spam interfaces for the purpose of  identification  of,  and,  in
       general,  dealing  with  spam messages.  A precondition of most commands in order to function is that the
       <u>spam-interface</u> variable is set to one of the supported interfaces.  “Specifying messages” that have  been
       identified  as  spam  is  possible  via  their  (volatile)  ‘is-spam’  state  by  using the ‘<u>:s</u>’ and ‘<u>:S</u>’
       specifications, and their <u>attrlist</u> entries will be used when displaying the <u>headline</u> in  the  summary  of
       <b>headers</b>.

       <b>•</b>   <b>spamrate</b>  rates  the given messages and sets their ‘is-spam’ flag accordingly.  If the spam interface
           offers spam scores these can be shown in <u>headline</u> by using the format ‘%$’.

       <b>•</b>   <b>spamham</b>, <b>spamspam</b> and <b>spamforget</b> will interact with the Bayesian filter of the chosen  interface  and
           learn  the  given  messages  as  “ham” or “spam”, respectively; the last command can be used to cause
           “unlearning” of messages; it adheres to their current  ‘is-spam’  state  and  thus  reverts  previous
           teachings.

       <b>•</b>   <b>spamclear</b>  and  <b>spamset</b>  will  simply  set  and clear, respectively, the mentioned volatile ‘is-spam’
           message flag, without any interface interaction.

       The <u><a href="../man1/spamassassin.1.html">spamassassin</a></u>(1) based <u>spam-interface</u> ‘spamc’ requires a running instance of the  <u><a href="../man1/spamd.1.html">spamd</a></u>(1)  server  in
       order to function, started with the option <b>--allow-tell</b> shall Bayesian filter learning be possible.

             $ spamd -i localhost:2142 -i /tmp/.spamsock -d [-L] [-l]
             $ spamd --listen=localhost:2142 --listen=/tmp/.spamsock \
                 --daemonize [--local] [--allow-tell]

       Thereafter S-nail can make use of these interfaces:

             $ s-nail -Sspam-interface=spamc -Sspam-maxsize=500000 \
                 -Sspamc-command=/usr/local/bin/spamc \
                 -Sspamc-arguments="-U /tmp/.spamsock" -Sspamc-user=
             or
             $ s-nail -Sspam-interface=spamc -Sspam-maxsize=500000 \
                 -Sspamc-command=/usr/local/bin/spamc \
                 -Sspamc-arguments="-d localhost -p 2142" -Sspamc-user=

       Using  the  generic  filter  approach  allows  usage of programs like <u><a href="../man1/bogofilter.1.html">bogofilter</a></u>(1).  Here is an example,
       requiring it to be accessible via PATH:

             $ s-nail -Sspam-interface=filter -Sspam-maxsize=500000 \
                 -Sspamfilter-ham="bogofilter -n" \
                 -Sspamfilter-noham="bogofilter -N" \
                 -Sspamfilter-nospam="bogofilter -S" \
                 -Sspamfilter-rate="bogofilter -TTu 2&gt;/dev/null" \
                 -Sspamfilter-spam="bogofilter -s" \
                 -Sspamfilter-rate-scanscore="1;^(.+)$"

       Because messages must exist on local storage  in  order  to  be  scored  (or  used  for  Bayesian  filter
       training),  it  is  possibly  a  good  idea  to  perform  the local spam check last.  Spam can be checked
       automatically when opening specific folders by setting  a  specialized  form  of  the  internal  variable
       <u>folder-hook</u>.

             define spamdelhook {
               # Server side DCC
               spamset (header x-dcc-brand-metrics "bulk")
               # Server-side <a href="../man1/spamassassin.1.html">spamassassin</a>(1)
               spamset (header x-spam-flag "YES")
               del :s # TODO we HAVE to be able to do `spamrate :u ! :sS'
               move :S +maybe-spam
               spamrate :u
               del :s
               move :S +maybe-spam
             }
             set folder-hook-SOMEFOLDER=spamdelhook

       See   also   the   documentation   for   the   variables   <u>spam-interface</u>,  <u>spam-maxsize</u>,  <u>spamc-command</u>,
       <u>spamc-arguments</u>, <u>spamc-user</u>, <u>spamfilter-ham</u>,  <u>spamfilter-noham</u>,  <u>spamfilter-nospam</u>,  <u>spamfilter-rate</u>  and
       <u>spamfilter-rate-scanscore</u>.

</pre><h4><b>COMMANDS</b></h4><pre>
       S-nail  reads input in lines.  An unquoted reverse solidus ‘\’ at the end of a command line “escapes” the
       newline character: it is discarded and the next line of input is used  as  a  follow-up  line,  with  all
       leading whitespace removed; once an entire line is completed, the whitespace characters <b>space</b>, <b>tabulator</b>,
       <b>newline</b> as well as those defined by the variable <u>ifs</u> are removed from the beginning and end.  Placing any
       whitespace  characters at the beginning of a line will prevent a possible addition of the command line to
       the [Option]al <b>history</b>.

       The beginning of such input lines is then scanned for the name of a known command: command names  may  be
       abbreviated,  in  which  case  the  first  command  that matches the given prefix will be used.  “Command
       modifiers” may prefix a command in order to modify its behaviour.  A name may  also  be  a  <b>commandalias</b>,
       which  will become expanded until no more expansion is possible.  Once the command that shall be executed
       is known, the remains of the  input  line  will  be  interpreted  according  to  command-specific  rules,
       documented in the following.

       This  behaviour  is different to the <u><a href="../man1/sh.1.html">sh</a></u>(1)ell, which is a programming language with syntactic elements of
       clearly defined semantics, and therefore capable to sequentially expand and evaluate individual  elements
       of  a  line.  ‘? set one=value two=$one’ for example will never possibly assign value to one, because the
       variable assignment is performed no sooner but by the command (<b>set</b>), long after the expansion happened.

       A list of all commands in lookup order is dumped by the command <b>list</b>.  [Option]ally the command <b>help</b>  (or
       <b>?</b>),  when  given  an  argument,  will  show  a documentation string for the command matching the expanded
       argument, as in ‘?t’, which should be a shorthand of  ‘?type’;  with  these  documentation  strings  both
       commands  support  a  more <u>verbose</u> listing mode which includes the argument type of the command and other
       information which applies; a handy suggestion might thus be:

             ? define __xv {
               # Before v15: need to enable <a href="../man1/sh.1.html">sh</a>(1)ell-style on _entire_ line!
               localopts yes;wysh set verbose;ignerr eval "${@}";return ${?}
             }
             ? commandalias xv '\call __xv'
             ? xv help set

   <b>Command</b> <b>modifiers</b>
       Commands may be prefixed by none to multiple command modifiers.  Some command modifiers can be used  with
       a  restricted  set of commands only, the <u>verbose</u> version of <b>list</b> will ([Option]ally) show which modifiers
       apply.

       <b>•</b>   The modifier reverse solidus <b>\</b>, to be placed first, prevents <b>commandalias</b> expansions on  the  remains
           of  the line, for example ‘\echo’ will always evaluate the command <b>echo</b>, even if an (command)alias of
           the same name exists.  <b>commandalias</b> content may itself contain further command  modifiers,  including
           an initial reverse solidus to prevent further expansions.

       <b>•</b>   The  modifier <b>ignerr</b> indicates that any error generated by the following command should be ignored by
           the state machine and not cause a program exit with enabled <u>errexit</u>  or  for  the  standardized  exit
           cases  in <u>posix</u> mode.  <u>?</u>, one of the “INTERNAL VARIABLES”, will be set to the real exit status of the
           command regardless.

       <b>•</b>   <b>local</b> will alter the called command to apply changes only temporarily, local to block-scope, and  can
           thus  only  be  used  inside  of a <b>define</b>d macro or an <b>account</b> definition.  Specifying it implies the
           modifier <b>wysh</b>.  Local variables will not be inherited by macros deeper in the  <b>call</b>  chain,  and  all
           local  settings will be garbage collected once the local scope is left.  To record and unroll changes
           in the global scope use the command <b>localopts</b>.

       <b>•</b>   <b>scope</b> does yet not implement any functionality.

       <b>•</b>   <b>u</b> does yet not implement any functionality.

       <b>•</b>   Some commands support the <b>vput</b> modifier: if used, they expect the  name  of  a  variable,  which  can
           itself be a variable, i.e., shell expansion is applied, as their first argument, and will place their
           computation result in it instead of the default location (it is usually written to standard output).

           The  given  name will be tested for being a valid <u><a href="../man1/sh.1.html">sh</a></u>(1) variable name, and may therefore only consist
           of upper- and lowercase characters, digits, and the underscore; the hyphen-minus may  be  used  as  a
           non-portable  extension;  digits  may  not  be  used  as  first, hyphen-minus may not be used as last
           characters.  In addition the name may either not be one of the known “INTERNAL  VARIABLES”,  or  must
           otherwise  refer  to  a  writable  (non-boolean)  value  variable.  The actual put operation may fail
           nonetheless, for example if the variable expects a number argument only a number  will  be  accepted.
           Any  error during these operations causes the command as such to fail, and the error number <u>!</u> will be
           set to <u>^ERR</u>-NOTSUP, the exit status <u>?</u> should be set to ‘-1’,  but  some  commands  deviate  from  the
           latter, which is documented.

       <b>•</b>   Last,  but  not  least, the modifier <b>wysh</b> can be used for some old and established commands to choose
           the new “Shell-style argument quoting” rules over the traditional “Old-style argument quoting”.  This
           modifier is implied if <u>v15-compat</u> is set to a non-empty value.

   <b>Old-style</b> <b>argument</b> <b>quoting</b>
       [v15 behaviour may differ] This section documents the traditional and POSIX standardized style of quoting
       non-message list arguments to commands which expect this type of arguments: whereas  still  used  by  the
       majority  of  such  commands,  the new “Shell-style argument quoting” may be available even for those via
       <b>wysh</b>, one of the “Command modifiers”.  Nonetheless care must be taken, because  only  new  commands  have
       been designed with all the capabilities of the new quoting rules in mind, which can, for example generate
       control characters.

             <b>•</b>   An  argument  can  be  enclosed  between  paired  double-quotes  ‘"argument"’  or single-quotes
                 ‘'argument'’; any whitespace, shell word expansion, or reverse solidus  characters  (except  as
                 described  next)  within  the  quotes are treated literally as part of the argument.  A double-
                 quote will be treated literally within single-quotes and vice  versa.   Inside  such  a  quoted
                 string  the actually used quote character can be used nonetheless by escaping it with a reverse
                 solidus ‘\’, as in ‘"y\"ou"’.

             <b>•</b>   An argument that is not  enclosed  in  quotes,  as  above,  can  usually  still  contain  space
                 characters if those spaces are reverse solidus escaped, as in ‘you\ are’.

             <b>•</b>   A  reverse  solidus outside of the enclosing quotes is discarded and the following character is
                 treated literally as part of the argument.

   <b>Shell-style</b> <b>argument</b> <b>quoting</b>
       <u><a href="../man1/sh.1.html">sh</a></u>(1)ell-style, and therefore POSIX standardized, argument parsing and quoting rules  are  used  by  most
       commands.   [v15  behaviour  may  differ]  Most new commands only support these new rules and are flagged
       [Only new quoting rules], some elder ones can use them with the command modifier <b>wysh</b>; in the future only
       this type of argument quoting will remain.

       A command line is parsed from left to right and  an  input  token  is  completed  whenever  an  unquoted,
       otherwise  ignored,  metacharacter is seen.  Metacharacters are vertical bar <b>|</b>, ampersand <b>&amp;</b>, semicolon <b>;</b>,
       as well as all characters from the variable <u>ifs</u>, and / or  <b>space</b>,  <b>tabulator</b>,  <b>newline</b>.   The  additional
       metacharacters  left  and right parenthesis <b>(</b>, <b>)</b> and less-than and greater-than signs <b>&lt;</b>, <b>&gt;</b> that the <u><a href="../man1/sh.1.html">sh</a></u>(1)
       supports are not used, and are treated as ordinary characters: for one these characters are a vivid  part
       of email addresses, and it seems highly unlikely that their function will become meaningful to S-nail.

             <b>Compatibility</b> <b>note:</b> [v15 behaviour may differ] Please note that even many new-style commands do not
             yet honour <u>ifs</u> to parse their arguments: whereas the <u><a href="../man1/sh.1.html">sh</a></u>(1)ell is a language with syntactic elements
             of  clearly  defined  semantics, S-nail parses entire input lines and decides on a per-command base
             what to do with the rest of the line.  This also means that whenever an unknown command is seen all
             that S-nail can do is cancellation of the processing of the remains of the line.

             It also often depends on an actual subcommand of a multiplexer command how the  rest  of  the  line
             should  be  treated, and until v15 we are not capable to perform this deep inspection of arguments.
             Nonetheless, at least the following commands which work with positional  parameters  fully  support
             <u>ifs</u> for an almost shell-compatible field splitting: <b>call</b>, <b>call_if</b>, <b>read</b>, <b>vpospar</b>, <b>xcall</b>.

       Any  unquoted number sign ‘#’ at the beginning of a new token starts a comment that extends to the end of
       the line, and therefore ends argument processing.  An  unquoted  dollar  sign  ‘$’  will  cause  variable
       expansion  of  the  given  name, which must be a valid <u><a href="../man1/sh.1.html">sh</a></u>(1)ell-style variable name (see <b>vput</b>): “INTERNAL
       VARIABLES” as well as “ENVIRONMENT” (shell) variables can  be  accessed  through  this  mechanism,  brace
       enclosing the name is supported (i.e., to subdivide a token).

       Whereas  the  metacharacters  <b>space</b>,  <b>tabulator</b>,  <b>newline</b>  only  complete an input token, vertical bar <b>|</b>,
       ampersand <b>&amp;</b> and semicolon <b>;</b> also act as  control  operators  and  perform  control  functions.   For  now
       supported  is  semicolon  <b>;</b>, which terminates a single command, therefore sequencing the command line and
       making the remainder of the line a subject to reevaluation.  With sequencing, multiple  command  argument
       types  and  quoting  rules may therefore apply to a single line, which can become problematic before v15:
       e.g., the first of the following will cause surprising results.

             ? <b>echo</b> <b>one;</b> <b>set</b> <b>verbose;</b> <b>echo</b> <b>verbose=$verbose.</b>
             ? <b>echo</b> <b>one;</b> <b>wysh</b> <b>set</b> <b>verbose;</b> <b>echo</b> <b>verbose=$verbose.</b>

       Quoting is a mechanism that will remove the special meaning of metacharacters  and  reserved  words,  and
       will  prevent expansion.  There are four quoting mechanisms: the escape character, single-quotes, double-
       quotes and dollar-single-quotes:

             <b>•</b>   The literal value of any character can be preserved by preceding it with the  escape  character
                 reverse solidus ‘\’.

             <b>•</b>   Arguments  which  are enclosed in ‘'single-quotes'’ retain their literal value.  A single-quote
                 cannot occur within single-quotes.

             <b>•</b>   The literal value of all  characters  enclosed  in  ‘"double-quotes"’  is  retained,  with  the
                 exception  of  dollar sign ‘$’, which will cause variable expansion, as above, backquote (grave
                 accent) ‘`’, (which not yet means anything special), reverse solidus ‘\’, which will escape any
                 of the characters dollar sign ‘$’ (to prevent variable  expansion),  backquote  (grave  accent)
                 ‘`’,  double-quote  ‘"’  (to  prevent  ending  the  quote)  and reverse solidus ‘\’ (to prevent
                 escaping, i.e., to embed a reverse  solidus  character  as-is),  but  has  no  special  meaning
                 otherwise.

             <b>•</b>   Arguments  enclosed  in  ‘$'dollar-single-quotes'’  extend normal single quotes in that reverse
                 solidus escape sequences are expanded as follows:

                 ‘\a’    bell control character (ASCII and ISO-10646 BEL).
                 ‘\b’    backspace control character (ASCII and ISO-10646 BS).
                 ‘\E’    escape control character (ASCII and ISO-10646 ESC).
                 ‘\e’    the same.
                 ‘\f’    form feed control character (ASCII and ISO-10646 FF).
                 ‘\n’    line feed control character (ASCII and ISO-10646 LF).
                 ‘\r’    carriage return control character (ASCII and ISO-10646 CR).
                 ‘\t’    horizontal tabulator control character (ASCII and ISO-10646 HT).
                 ‘\v’    vertical tabulator control character (ASCII and ISO-10646 VT).
                 ‘\\’    emits a reverse solidus character.
                 ‘\'’    single quote.
                 ‘\"’    double quote (escaping is optional).
                 ‘\NNN’  eight-bit byte with the octal value ‘NNN’  (one  to  three  octal  digits),  optionally
                         prefixed  by  an  additional ‘0’.  A 0 byte will suppress further output for the quoted
                         argument.
                 ‘\xHH’  eight-bit byte with the hexadecimal value ‘HH’ (one or two hexadecimal  characters,  no
                         prefix, see <b>vexpr</b>).  A 0 byte will suppress further output for the quoted argument.
                 ‘\UHHHHHHHH’
                         the  Unicode / ISO-10646 character with the hexadecimal codepoint value ‘HHHHHHHH’ (one
                         to eight hexadecimal characters) — note that Unicode defines the maximum codepoint ever
                         to be supported as ‘0x10FFFF’ (in planes of ‘0xFFFF’ characters each).  This escape  is
                         only  supported  in locales that support Unicode (see “Character sets”), in other cases
                         the sequence will remain unexpanded unless the given code point is ASCII compatible  or
                         (if  the  [Option]al  character  set conversion is available) can be represented in the
                         current locale.  The  character  NUL  will  suppress  further  output  for  the  quoted
                         argument.
                 ‘\uHHHH’
                         Identical to ‘\UHHHHHHHH’ except it takes only one to four hexadecimal characters.
                 ‘\cX’   Emits the non-printable (ASCII and compatible) C0 control codes 0 (NUL) to 31 (US), and
                         127  (DEL).  Printable representations of ASCII control codes can be created by mapping
                         them to a different, visible part of the ASCII character set.   Adding  the  number  64
                         achieves  this  for  the  codes  0  to  31,  here 7 (BEL): ‘7 + 64 = 71 = G’.  The real
                         operation is a bitwise logical XOR with 64 (bit 7 set, see <b>vexpr</b>), thus  also  covering
                         code 127 (DEL), which is mapped to 63 (question mark): ‘? vexpr ^ 127 64’.

                         Whereas historically circumflex notation has often been used for visualization purposes
                         of  control  codes,  as  in  ‘^G’,  the reverse solidus notation has been standardized:
                         ‘\cG’.  Some control codes also have standardized (ISO-10646, ISO C) aliases, as  shown
                         above  (‘\a’,  ‘\n’,  ‘\t’  etc)  :  whenever  such an alias exists it will be used for
                         display purposes.  The control code NUL (‘\c@’, a non-standard extension) will suppress
                         further output for the remains of the  token  (which  may  extend  beyond  the  current
                         quote),  or,  depending  on  the  context, the remains of all arguments for the current
                         command.
                 ‘\$NAME’
                         Non-standard extension: expand the given variable name, as above.  Brace enclosing  the
                         name is supported.
                 ‘\`{command}’
                         Not yet supported, just to raise awareness: Non-standard extension.

       Caveats:

             ? echo 'Quotes '${HOME}' and 'tokens" differ!"# no comment
             ? echo Quotes ${HOME} and tokens differ! # comment
             ? echo Don"'"t you worry$'\x21' The sun shines on us. $'\u263A'

   <b>Message</b> <b>list</b> <b>arguments</b>
       Many  commands  operate  on  message  list  specifications,  as documented in “Specifying messages”.  The
       argument input is first split into individual tokens via “Shell-style argument quoting”, which  are  then
       interpreted  as  the  mentioned  specifications.   If  no  explicit message list has been specified, many
       commands will search for and use the next message forward that satisfies the commands' requirements,  and
       if  there  are no messages forward of the current message, the search proceeds backwards; if there are no
       good messages at all to be found, an error message is shown and the  command  is  aborted.   The  <u>verbose</u>
       output of the command <b>list</b> will indicate whether a command searches for a default message, or not.

   <b>Raw</b> <b>data</b> <b>arguments</b> <b>for</b> <b>codec</b> <b>commands</b>
       A  special  set  of  commands,  which all have the string “codec” in their name, like <b>addrcodec</b>, <b>shcodec</b>,
       <b>urlcodec</b>, take raw string data as input, which means that the content of the command input line is passed
       completely unexpanded and otherwise unchanged: like this the  effect  of  the  actual  codec  is  visible
       without  any  noise of possible shell quoting rules etc., i.e., the user can input one-to-one the desired
       or questionable data.  To gain a level of expansion, the entire command line can be <b>eval</b>uated first,  for
       example

             ? vput shcodec res encode /usr/Schönes Wetter/heute.txt
             ? echo $res
             $'/usr/Sch\u00F6nes Wetter/heute.txt'
             ? shcodec d $res
             $'/usr/Sch\u00F6nes Wetter/heute.txt'
             ? eval shcodec d $res
             /usr/Schönes Wetter/heute.txt

   <b>Filename</b> <b>transformations</b>
       Filenames,  where  expected,  and  unless documented otherwise, are subsequently subject to the following
       filename transformations, in sequence:

             <b>•</b>   If the given name is a registered <b>shortcut</b>, it will be replaced  with  the  expanded  shortcut.
                 This step is mostly taken for <b>folder</b>s only.

             <b>•</b>   The  filename  is matched against the following patterns or strings.  But for plus <u>+file</u> <u>folder</u>
                 expansion this step is mostly taken for <b>folder</b>s only.

                 <u>#</u>      (Number sign) is expanded to the previous file.
                 <u>%</u>      (Percent sign) is replaced by the invoking user's primary system mailbox,  which  either
                        is  the  (itself  expandable)  <u>inbox</u>  if that is set, the standardized absolute pathname
                        indicated by MAIL if that is set, or a built-in compile-time  default  otherwise.   When
                        opening  a  <b>folder</b>  the used name is actively checked for being a primary mailbox, first
                        against <u>inbox</u>, then against MAIL.
                 <u>%user</u>  Expands to the primary system mailbox of <u>user</u> (and never the value of <u>inbox</u>,  regardless
                        of its actual setting).
                 <u>&amp;</u>      (Ampersand) is replaced with the invoking user's secondary mailbox, the MBOX.
                 <u>+file</u>  Refers to a <u>file</u> in the <u>folder</u> directory (if that variable is set).
                 <u>%:filespec</u>  Expands  to the same value as <u>filespec</u>, but has special meaning when used with, for
                        example, the command <b>folder</b>: the file will be treated as a primary  system  mailbox  by,
                        among  others,  the <b>mbox</b> and <b>save</b> commands, meaning that messages that have been read in
                        the current session will be moved to the MBOX mailbox instead of simply being flagged as
                        read.

             <b>•</b>   Meta expansions may be applied to the resulting filename,  as  allowed  by  the  operation  and
                 applicable  to  the resulting access protocol (also see “On URL syntax and credential lookup”).
                 For the file-protocol, a leading tilde ‘~’ character will be replaced by the expansion of HOME,
                 except when followed by a valid user name, in which case the home directory of the  given  user
                 is used instead.

                 A  shell expansion as if specified in double-quotes (see “Shell-style argument quoting”) may be
                 applied, so that any occurrence of ‘$VARIABLE’ (or  ‘${VARIABLE}’)  will  be  replaced  by  the
                 expansion  of  the variable, if possible; “INTERNAL VARIABLES” as well as “ENVIRONMENT” (shell)
                 variables can be accessed through this mechanism.

                 Shell pathname wildcard pattern expansions (<u><a href="../man7/glob.7.html">glob</a></u>(7)) may be  applied  as  documented.   If  the
                 fully  expanded  filename  results  in multiple pathnames and the command is expecting only one
                 file, an error results.

                 In interactive context, in order to allow simple value acceptance (via “ENTER”), arguments will
                 usually be displayed in a properly quoted form, so a file ‘diet\ is \curd.txt’ may be displayed
                 as ‘'diet\ is \curd.txt'’.

   <b>Commands</b>
       The following commands are available:

       <b>!</b>         Executes the SHELL command which  follows,  replacing  unescaped  exclamation  marks  with  the
                 previously  executed  command if the internal variable <u>bang</u> is set.  This command supports <b>vput</b>
                 as documented in “Command modifiers”, and manages the error number <u>!</u>.  A  0  or  positive  exit
                 status  <u>?</u>  reflects the exit status of the command, negative ones that an error happened before
                 the command was executed, or that the program did not exit cleanly, but maybe due to a  signal:
                 the error number is <u>^ERR</u>-CHILD, then.

                 In conjunction with the <b>vput</b> modifier the following special cases exist: a negative exit status
                 occurs  if the collected data could not be stored in the given variable, which is a <u>^ERR</u>-NOTSUP
                 error that should otherwise not occur.  <u>^ERR</u>-CANCELED indicates that no temporary file could be
                 created to collect the command output at first glance.   In  case  of  catchable  out-of-memory
                 situations  <u>^ERR</u>-NOMEM will occur and S-nail will try to store the empty string, just like with
                 all other detected error conditions.

       <b>#</b>         The comment-command causes the entire line to be  ignored.   <b>Note:</b>  this  really  is  a  normal
                 command  which'  purpose  is to discard its arguments, not a “comment-start” indicating special
                 character, which means that for example trailing comments on a line are  not  possible  (except
                 for commands which use “Shell-style argument quoting”).

       <b>+</b>         Goes to the next message in sequence and types it (like “ENTER”).

       <b>-</b>         Display the preceding message, or the n'th previous message if given a numeric argument n.

       <b>=</b>         Shows  the  message number of the current message (the “dot”) when used without arguments, that
                 of the given list otherwise.  Output numbers will be separated from each other with  the  first
                 character  of  <u>ifs</u>,  and followed by the first character of <u>if-ws</u>, if that is not empty and not
                 identical to the first.  If that results in no separation at all a  <b>space</b>  character  is  used.
                 This command supports <b>vput</b> (see “Command modifiers”), and manages the error number <u>!</u>.

       <b>?</b>         [Option]  Show  a  brief  summary  of  commands.  [Option] Given an argument a synopsis for the
                 command in question is shown instead; commands can be abbreviated in general and  this  command
                 can  be  used  to  see  the  full expansion of an abbreviation including the synopsis, try, for
                 example ‘?h’, ‘?hel’ and ‘?help’ and see how the output changes.  To  avoid  that  aliases  are
                 resolved  the  modifier  <b>\</b>  can be prepended to the argument, but note it must be quoted.  This
                 mode also supports a more <u>verbose</u> output, which will provide  the  information  documented  for
                 <b>list</b>.

       <b>|</b>         A synonym for the <b>pipe</b> command.

       <b>account</b>, <b>unaccount</b>
                 (ac,  una)  Creates,  selects  or  lists (an) account(s).  Accounts are special incarnations of
                 <b>define</b>d macros and group commands and variable settings  which  together  usually  arrange  the
                 environment  for the purpose of creating an email account.  Different to normal macros settings
                 which are covered by <b>localopts</b> – here by default enabled! – will not  be  reverted  before  the
                 <b>account</b> is changed again.  The special account ‘null’ (case-insensitive) always exists, and all
                 but  it  can  be deleted by the latter command, and in one operation with the special name ‘*’.
                 Also for all but it a possibly set <u>on-account-cleanup</u> hook is called once they are  left,  also
                 for program exit.

                 Without  arguments  a  listing  of  all defined accounts is shown.  With one argument the given
                 account is activated: the system <u>inbox</u> of that account will be activated  (as  via  <b>folder</b>),  a
                 possibly  installed <u>folder-hook</u> will be run, and the internal variable <u>account</u> will be updated.
                 The two argument form behaves identical to defining a macro as via <b>define</b>.  Important  settings
                 for  accounts include <u>folder</u>, <u>from</u>, <u>hostname</u>, <u>inbox</u>, <u>mta</u>, <u>password</u> and <u>user</u> (“On URL syntax and
                 credential  lookup”),  as  well   as   things   like   <u>tls-config-pairs</u>   (“Encrypted   network
                 communication”), and protocol specifics like <u>imap-auth</u>, <u>pop3-auth</u>, <u>smtp-auth</u>.

                       account myisp {
                         set folder=<a href="file:~/mail">~/mail</a> inbox=+syste.mbox record=+sent.mbox
                         set from='(My Name) <a href="mailto:myname@myisp.example">myname@myisp.example</a>'
                         set mta=smtp://<a href="mailto:mylogin@smtp.myisp.example">mylogin@smtp.myisp.example</a>
                       }

       <b>addrcodec</b>
                 Perform  email  address  codec  transformations on raw-data argument, rather according to email
                 standards (RFC 5322; [v15 behaviour may differ] will furtherly improve).   Supports  <b>vput</b>  (see
                 “Command  modifiers”),  and  manages  the  error  number  <u>!</u>.  The first argument must be either
                 <u>[+[+[+]]]e[ncode]</u>, <u>d[ecode]</u>, <u>s[kin]</u> or <u>skinl[ist]</u> and specifies the operation to perform on the
                 rest of the line.

                 Decoding will show how a standard-compliant MUA will display the given argument,  which  should
                 be  an  email  address.   Please  be  aware  that  most MUAs have difficulties with the address
                 standards, and vary wildly when (comments) in parenthesis, “double-quoted” strings, or  quoted-
                 pairs, as below, become involved.  [v15 behaviour may differ] S-nail currently does not perform
                 decoding when displaying addresses.

                 Skinning  is  identical  to  decoding  but  only outputs the plain address, without any string,
                 comment etc. components.  Another difference is that it may fail with the error number <u>!</u> set to
                 <u>^ERR</u>-INVAL if decoding fails to find a(n) (valid) email address, in which case  the  unmodified
                 input will be output again.

                 <u>skinlist</u>  first performs a skin operation, and thereafter checks a valid address for whether it
                 is a registered mailing list (see <b>mlist</b> and <b>mlsubscribe</b>), eventually reporting  that  state  in
                 the  error number <u>!</u> as <u>^ERR</u>-EXIST.  (This state could later become overwritten by an I/O error,
                 though.)

                 Encoding supports four different modes, lesser automated versions can be  chosen  by  prefixing
                 one,  two or three plus signs: the standard imposes a special meaning on some characters, which
                 thus have to be transformed to so-called quoted-pairs by pairing them with  a  reverse  solidus
                 ‘\’  in  order  to  remove  the special meaning; this might change interpretation of the entire
                 argument from what has been desired, however!  Specify one plus sign to remark that parenthesis
                 shall be left alone, two for not turning double quotation marks into  quoted-pairs,  and  three
                 for also leaving any user-specified reverse solidus alone.  The result will always be valid, if
                 a  successful exit status is reported ([v15 behaviour may differ] the current parser fails this
                 assertion for some constructs).  [v15 behaviour may differ] Addresses need to be  specified  in
                 between  angle brackets ‘&lt;’, ‘&gt;’ if the construct becomes more difficult, otherwise the current
                 parser will fail; it is not smart enough to guess right.

                       ? addrc enc "Hey, you",&lt;<a href="mailto:diet@exam.ple">diet@exam.ple</a>&gt;\ out\ there
                       "\"Hey, you\", \\ out\\ there" &lt;<a href="mailto:diet@exam.ple">diet@exam.ple</a>&gt;
                       ? addrc d "\"Hey, you\", \\ out\\ there" &lt;<a href="mailto:diet@exam.ple">diet@exam.ple</a>&gt;
                       "Hey, you", \ out\ there &lt;<a href="mailto:diet@exam.ple">diet@exam.ple</a>&gt;
                       ? addrc s "\"Hey, you\", \\ out\\ there" &lt;<a href="mailto:diet@exam.ple">diet@exam.ple</a>&gt;
                       <a href="mailto:diet@exam.ple">diet@exam.ple</a>

       <b>alias</b>, <b>unalias</b>
                 [Only new quoting rules](a, una) Define or list, and  remove,  respectively,  address  aliases,
                 which  are  a  method of creating personal distribution lists that map a single name to none to
                 multiple receivers, to be expanded after “Compose mode” is left; the expansion correlates  with
                 <u>metoo</u>.  The latter command removes all given aliases, the special name asterisk ‘*’ will remove
                 all  existing  aliases.   When  used without arguments the former shows a list of all currently
                 known aliases, with one argument  only  the  target(s)  of  the  given  one.   When  given  two
                 arguments,  hyphen-minus  ‘-’  being  the  first,  the  target(s) of the second is/are expanded
                 recursively.

                 In all other cases the given alias is newly defined, or will be  appended  to:  arguments  must
                 either  be  themselves  valid alias names, or any other address type (see “On sending mail, and
                 non-interactive mode”).  Recursive expansion of aliases  can  be  prevented  by  prefixing  the
                 desired  argument  with  the  modifier  reverse  solidus  <b>\</b>.   A  valid  alias name conforms to
                 <u>mta-aliases</u> syntax, but follow-up characters can also  be  the  number  sign  ‘#’,  colon  ‘:’,
                 commercial at ‘@,’ exclamation mark ‘!’, period ‘.’ as well as “any character that has the high
                 bit  set”.   The  dollar  sign  ‘$’  may  be  the last character.  The number sign ‘#’ may need
                 “Shell-style argument quoting”.

                 [v15 behaviour may differ] Unfortunately the colon is currently not supported, as it interferes
                 with normal address parsing rules.  [v15 behaviour may differ] Such high  bit  characters  will
                 likely cause warnings at the moment for the same reasons why colon is unsupported; also, in the
                 future locale dependent character set validity checks will be performed.

                       ? alias cohorts  bill jkf mark kridle@ucbcory <a href="file:~/cohorts.mbox">~/cohorts.mbox</a>
                       ? alias mark  <a href="mailto:mark@exam.ple">mark@exam.ple</a>
                       ? set mta-aliases=/etc/aliases

       <b>alternates</b>, <b>unalternates</b>
                 [Only  new  quoting  rules]  (alt)  Manage a list of alternate addresses or names of the active
                 user, members of which will be removed from recipient lists (except one).  There is  a  set  of
                 implicit  alternates which is formed of the values of LOGNAME, <u>from</u>, <u>sender</u> and <u>reply-to</u>.  <u>from</u>
                 will not be used if <u>sender</u> is set.  The latter command removes the given  list  of  alternates,
                 the special name ‘*’ will discard all existing alternate names.

                 The  former  command  manages  the error number <u>!</u>.  It shows the current set of alternates when
                 used without arguments; in this mode only it also  supports  <b>vput</b>  (see  “Command  modifiers”).
                 Otherwise  the  given  arguments (after being checked for validity) are appended to the list of
                 alternate names; in <u>posix</u> mode they replace that list instead.

       <b>answered</b>, <b>unanswered</b>
                 Take a message lists and mark each message as (not) having been  answered.   Messages  will  be
                 marked  answered  when  being <b>reply</b>d to automatically if the <u>markanswered</u> variable is set.  See
                 the section “Message states”.

       <b>bind</b>, <b>unbind</b>
                 [Option][Only new quoting rules] The bind command extends the MLE (see “On terminal control and
                 line editor”) with freely configurable key bindings.  The latter command removes from the given
                 context the given key binding, both of which may be  specified  as  a  wildcard  ‘*’,  so  that
                 ‘unbind  *  *’ will remove all bindings of all contexts.  Due to initialization order unbinding
                 will  not  work  for  built-in  key  bindings  upon  program  startup,  however:   please   use
                 <u>line-editor-no-defaults</u> for this purpose instead.

                 With  zero  arguments, or with a context name the former command shows all key bindings (of the
                 given context; an asterisk ‘*’ will iterate over all contexts); a more verbose listing will  be
                 produced  if either of <u>debug</u> or <u>verbose</u> are set.  With two or more arguments a specific binding
                 is shown, or (re)established: the first argument is the context  to  which  the  binding  shall
                 apply,  the  second  argument  is  a comma-separated list of the “keys” which form the binding.
                 Further arguments will be joined to form the expansion, and cause the binding to be created  or
                 updated.   To indicate that a binding shall not be auto-committed, but that the expansion shall
                 instead be furtherly editable by the user, a commercial at ‘@’ (that will be  removed)  can  be
                 placed  last  in  the  expansion,  from  which  leading and trailing whitespace will finally be
                 removed.  Reverse solidus cannot be  used  as  the  last  character  of  expansion.   An  empty
                 expansion will be rejected.

                 Contexts define when a binding applies, i.e., a binding will not be seen unless the context for
                 which  it  is defined for is currently active.  This is not true for the shared binding ‘base’,
                 which is the foundation for all other bindings  and  as  such  always  applies,  its  bindings,
                 however,  only  apply secondarily.  The available contexts are the shared ‘base’, the ‘default’
                 context which is used in all not otherwise documented situations, and ‘compose’, which  applies
                 only to “Compose mode”.

                 Bindings  are  specified  as  a  comma-separated  list of byte-sequences, where each list entry
                 corresponds to one “key” (press).  Byte sequence boundaries will be forcefully terminated after
                 <u>bind-inter-byte-timeout</u>  milliseconds,  whereas  key   sequences   can   be   timed   out   via
                 <u>bind-inter-key-timeout</u>.   A  list  entry  may, indicated by a leading colon character ‘:’, also
                 refer to the name of a terminal capability; several dozen names are  compiled  in  and  may  be
                 specified either by their <u><a href="../man5/terminfo.5.html">terminfo</a></u>(5), or, if existing, by their <u><a href="../man5/termcap.5.html">termcap</a></u>(5) name, regardless of
                 the actually used [Option]al terminal control library.  But any capability may be used, as long
                 as  the  name  is resolvable by the [Option]al control library, or was defined via the internal
                 variable <u>termcap</u>.  Input sequences are not case-normalized,  an  exact  match  is  required  to
                 update  or  remove  a  binding.   It  is  advisable  to  use an initial escape or other control
                 character (like ‘\cA’) for user (as opposed to purely terminal capability  based)  bindings  in
                 order to avoid ambiguities; it also reduces search time.  Examples:

                       ? bind base a,b echo one
                       ? bind base $'\E',d mle-snarf-word-fwd # Esc(ape)
                       ? bind base $'\E',$'\c?' mle-snarf-word-bwd # Esc,Delete
                       ? bind default $'\cA',:khome,w 'echo Editable binding@'
                       ? bind default a,b,c rm -irf / @  # Also editable
                       ? bind default :kf1 File %
                       ? bind compose :kf1 ~v

                 Note  that  the  entire  comma-separated  list  is  first  parsed  (over) as a shell-token with
                 whitespace as the field separator, then parsed and expanded for real with comma  as  the  field
                 separator,  therefore  whitespace  needs  to  be  properly  quoted,  see  “Shell-style argument
                 quoting”.  Using Unicode reverse solidus escape sequences renders a binding defunctional if the
                 locale does not support Unicode (see “Character sets”), and using terminal capabilities does so
                 if no (corresponding) terminal control support is (currently) available.  Adding,  deleting  or
                 modifying  a key binding invalidates the internal prebuilt lookup tree, it will be recreated as
                 necessary: this process will be visualized in most <u>verbose</u> as well as in <u>debug</u> mode.

                 The following terminal capability names are built-in and can be  used  in  <u><a href="../man5/terminfo.5.html">terminfo</a></u>(5)  or  (if
                 available)  the  two-letter  <u><a href="../man5/termcap.5.html">termcap</a></u>(5)  notation.   See  the  respective  manual for a list of
                 capabilities.  The program <u><a href="../man1/infocmp.1.html">infocmp</a></u>(1) can be used to show all the capabilities of TERM  or  the
                 given terminal type; using the <b>-x</b> flag will also show supported (non-standard) extensions.

                 <b>kbs</b> or <b>kb</b>       Backspace.
                 <b>kdch1</b> or <b>kD</b>     Delete character.
                 <b>kDC</b> or <b>*4</b>       — shifted variant.
                 <b>kel</b> or <b>kE</b>       Clear to end of line.
                 <b>kext</b> or <b>@9</b>      Exit.
                 <b>kich1</b> or <b>kI</b>     Insert character.
                 <b>kIC</b> or <b>#3</b>       — shifted variant.
                 <b>khome</b> or <b>kh</b>     Home.
                 <b>kHOM</b> or <b>#2</b>      — shifted variant.
                 <b>kend</b> or <b>@7</b>      End.
                 <b>knp</b> or <b>kN</b>       Next page.
                 <b>kpp</b> or <b>kP</b>       Previous page.
                 <b>kcub1</b> or <b>kl</b>     Left cursor (with more modifiers: see below).
                 <b>kLFT</b> or <b>#4</b>      — shifted variant.
                 <b>kcuf1</b> or <b>kr</b>     Right cursor (ditto).
                 <b>kRIT</b> or <b>%i</b>      — shifted variant.
                 <b>kcud1</b> or <b>kd</b>     Down cursor (ditto).
                 <b>kDN</b>             — shifted variant (only terminfo).
                 <b>kcuu1</b> or <b>ku</b>     Up cursor (ditto).
                 <b>kUP</b>             — shifted variant (only terminfo).
                 <b>kf0</b> or <b>k0</b>       Function key 0.  Add one for each function key up to <b>kf9</b> and <b>k9</b>, respectively.
                 <b>kf10</b> or <b>k;</b>      Function key 10.
                 <b>kf11</b> or <b>F1</b>      Function  key  11.   Add  one  for  each  function  key  up  to  <b>kf19</b>  and  <b>F9</b>,
                                 respectively.

                 Some terminals support key-modifier combination extensions, e.g., ‘Alt+Shift+xy’.  For example,
                 the delete key, <b>kdch1</b>: in its shifted variant, the name is mutated to <b>kDC</b>,  then  a  number  is
                 appended  for  the  states  ‘Alt’ (<b>kDC3</b>), ‘Shift+Alt’ (<b>kDC4</b>), ‘Control’ (<b>kDC5</b>), ‘Shift+Control’
                 (<b>kDC6</b>), ‘Alt+Control’ (<b>kDC7</b>), finally ‘Shift+Alt+Control’ (<b>kDC8</b>).  The same for the left cursor
                 key, <b>kcub1</b>: <b>KLFT</b>, <b>KLFT3</b>, <b>KLFT4</b>, <b>KLFT5</b>, <b>KLFT6</b>, <b>KLFT7</b>, <b>KLFT8</b>.

       <b>call</b>      [Only new quoting rules] Calls the given macro, which must have been created  via  <b>define</b>  (see
                 there for more), otherwise an <u>^ERR</u>-NOENT error occurs.  Calling macros recursively will at some
                 time  excess  the  stack  size limit, causing a hard program abortion; if recursively calling a
                 macro is the last command of the current macro, consider to use the command <b>xcall</b>,  which  will
                 first  release  all  resources of the current macro before replacing the current macro with the
                 called one.

       <b>call_if</b>   Identical to <b>call</b> if the given macro has been created via <b>define</b>, but does not fail nor warn if
                 the macro does not exist.

       <b>cd</b>        Synonym for <b>chdir</b>.

       <b>certsave</b>  [Option] Only applicable to S/MIME signed messages.  Takes  an  optional  message  list  and  a
                 filename  and  saves the certificates contained within the message signatures to the named file
                 in both human-readable and PEM format.  The certificates can later be used  to  send  encrypted
                 messages to the respective message senders by setting <u>smime-encrypt-USER@HOST</u> variables.

       <b>charsetalias</b>, <b>uncharsetalias</b>
                 [Only  new  quoting  rules]  Manage alias mappings for (conversion of) “Character sets”.  Alias
                 processing is not performed for “INTERNAL VARIABLES”, for example  <u>charset-8bit</u>,  and  mappings
                 are  ineffective  if  character  set  conversion  is  not available (<u>features</u> does not announce
                 ‘,+iconv,’).  Expansion happens recursively for cases where  aliases  point  to  other  aliases
                 (built-in loop limit: 8).

                 The  latter  command  deletes  all  aliases  given  as arguments, or all at once when given the
                 asterisk ‘*’.  The former shows the list of all  currently  defined  aliases  if  used  without
                 arguments,  or  the target of the given single argument; when given two arguments, hyphen-minus
                 ‘-’ being the first, the second is instead expanded recursively.  In all other cases the  given
                 arguments  are treated as pairs of character sets and their desired target alias name, creating
                 new or updating already existing aliases.

       <b>chdir</b>     [Only new quoting rules](ch) Change the working  directory  to  HOME  or  the  given  argument.
                 Synonym for <b>cd</b>.

       <b>collapse</b>, <b>uncollapse</b>
                 Only  applicable  to ‘thread’ed <b>sort</b> mode.  Takes a message list and makes all replies to these
                 messages invisible in header summaries, except for ‘new’ messages and the “dot”.  Also  when  a
                 message  with  collapsed replies is displayed, all of these are automatically uncollapsed.  The
                 latter command undoes collapsing.

       <b>colour</b>, <b>uncolour</b>
                 [Option][Only new quoting rules] Manage colour  mappings  of  and  for  a  “Coloured  display”.
                 Without  arguments the former shows all currently defined mappings.  Otherwise a colour type is
                 expected (case-insensitively), it must be one of ‘256’ for 256-colour terminals, ‘8’, ‘ansi’ or
                 ‘iso’ for the standard 8-colour ANSI  /  ISO  6429  colour  palette,  and  ‘1’  or  ‘mono’  for
                 monochrome terminals, which only support (some) font attributes.  Without further arguments the
                 list  of  all  currently defined mappings of the given type is shown (here the special ‘all’ or
                 ‘*’ also show all currently defined mappings).

                 Otherwise the second argument defines the mappable slot, the third argument a  (comma-separated
                 list  of)  colour  and  font  attribute  specification(s),  and the optionally supported fourth
                 argument can be used to specify a precondition: if conditioned mappings exist they  are  tested
                 in  (creation)  order unless a (case-insensitive) match has been found, and the default mapping
                 (if any has been established) will only be chosen as a last resort.   The  types  of  available
                 preconditions depend on the mappable slot, the following of which exist:

                 Mappings  prefixed with ‘mle-’ are used for the [Option]al built-in Mailx-Line-Editor (MLE, see
                 “On terminal control and line editor”) and do not support preconditions.

                 <u>mle-position</u>   This mapping is used for the position indicator that  is  visible  when  a  line
                                cannot be fully displayed on the screen.
                 <u>mle-prompt</u>     Used for the <u>prompt</u>.
                 <u>mle-error</u>      Used  for the occasionally appearing error indicator that is joined onto <u>prompt</u>.
                                [v15 behaviour may differ] Also used for  error  messages  written  on  standard
                                error .

                 Mappings  prefixed  with  ‘sum-’  are  used  in  header  summaries, and they all understand the
                 preconditions ‘dot’ (the current message) and ‘older’ for  elder  messages  (only  honoured  in
                 conjunction with <u>datefield-markout-older</u>).

                 <u>sum-dotmark</u>    This mapping is used for the “dotmark” that can be created with the ‘%&gt;’ or ‘%&lt;’
                                formats of the variable <u>headline</u>.
                 <u>sum-header</u>     For  the  complete  header  summary  line  except  the  “dotmark” and the thread
                                structure.
                 <u>sum-thread</u>     For the thread structure which can be  created  with  the  ‘%i’  format  of  the
                                variable <u>headline</u>.

                 Mappings prefixed with ‘view-’ are used when displaying messages.

                 <u>view-from</u><b>_</b>     This  mapping  is  used  for so-called ‘From_’ lines, which are MBOX file format
                                specific header lines (also see <u>mbox-rfc4155</u>).
                 <u>view-header</u>    For header lines.  A comma-separated  list  of  headers  to  which  the  mapping
                                applies  may  be  given  as a precondition; if the [Option]al regular expression
                                support is available then if any of the “magic regular expression characters” is
                                seen the precondition will be evaluated as (an extended) one.
                 <u>view-msginfo</u>   For the introductional message info line.
                 <u>view-partinfo</u>  For MIME part info lines.

                 The following  (case-insensitive)  colour  definitions  and  font  attributes  are  understood,
                 multiple of which can be specified in a comma-separated list:

                 <u>ft=</u>  a font attribute: ‘bold’, ‘reverse’ or ‘underline’.  It is possible (and often applicable)
                      to specify multiple font attributes for a single mapping.

                 <u>fg=</u>  foreground  colour  attribute,  in order (numbers 0 - 7) ‘black’, ‘red’, ‘green’, ‘brown’,
                      ‘blue’, ‘magenta’, ‘cyan’ or ‘white’.  To specify  a  256-colour  mode  a  decimal  number
                      colour  specification  in  the range 0 to 255, inclusive, is supported, and interpreted as
                      follows:

                      0 - 7      the standard ISO 6429 colours, as above.
                      8 - 15     high intensity variants of the standard colours.
                      16 - 231   216 colours in tuples of 6.
                      232 - 255  grayscale from black to white in 24 steps.

                            #!<a href="file:/bin/sh">/bin/sh</a> -
                            fg() { printf "\033[38;5;${1}m($1)"; }
                            bg() { printf "\033[48;5;${1}m($1)"; }
                            i=0
                            while [ $i -lt 256 ]; do fg $i; i=$(($i + 1)); done
                            printf "\033[0m\n"
                            i=0
                            while [ $i -lt 256 ]; do bg $i; i=$(($i + 1)); done
                            printf "\033[0m\n"

                 <u>bg=</u>  background colour attribute (see <b>fg=</b> for possible values).

                 The command <b>uncolour</b> will remove for the given colour type (the special type ‘*’  selects  all)
                 the  given  mapping;  if  the  optional  precondition argument is given only the exact tuple of
                 mapping and precondition is removed.  The  special  name  ‘*’  will  remove  all  mappings  (no
                 precondition allowed), thus ‘uncolour * *’ will remove all established mappings.

       <b>commandalias</b>, <b>uncommandalias</b>
                 [Only  new  quoting  rules]  Define  or  list,  and  remove, respectively, command aliases.  An
                 (command)alias can be  used  everywhere  a  normal  command  can  be  used,  but  always  takes
                 precedence:  any  arguments  that  are  given  to  the  command alias are joined onto the alias
                 expansion, and the resulting string forms the command line that is, in effect,  executed.   The
                 latter  command  removes  all  given  aliases,  the  special  name asterisk ‘*’ will remove all
                 existing aliases.  When used without arguments the former shows a list of all  currently  known
                 aliases, with one argument only the expansion of the given one.

                 With  two  or  more  arguments a command alias is defined or updated: the first argument is the
                 name under which the remaining command line should be accessible, the content of which  can  be
                 just about anything.  An alias may itself expand to another alias, but to avoid expansion loops
                 further expansion will be prevented if an alias refers to itself or if an expansion depth limit
                 is  reached.   Explicit  expansion  prevention  is  available via reverse solidus <b>\</b>, one of the
                 “Command modifiers”.

                       ? commandalias xx
                       s-nail: `commandalias': no such alias: xx
                       ? commandalias xx echo hello,
                       ? commandalias xx
                       commandalias xx 'echo hello,'
                       ? xx
                       hello,
                       ? xx world
                       hello, world

       <b>Copy</b>      (C) Similar to <b>copy</b>, but copy the messages to a file named after the local part of  the  sender
                 of the first message instead of taking a filename argument; <u>outfolder</u> is inspected to decide on
                 the actual storage location.

       <b>copy</b>      (c) Copy messages to the named file and do not mark them as being saved; otherwise identical to
                 <b>save</b>.

       <b>csop</b>      [Only  new  quoting  rules]  A  multiplexer command which provides C-style string operations on
                 8-bit bytes without a notion of locale settings and character sets, effectively assuming  ASCII
                 data.   For numeric and other operations refer to <b>vexpr</b>.  <b>vput</b>, one of the “Command modifiers”,
                 is supported.  The error result is ‘-1’ for usage errors and numeric results, the empty  string
                 otherwise;  missing  data  errors,  as  for unsuccessful searches, result in the <u>!</u> error number
                 being set to <u>^ERR</u>-NODATA.  Where the question mark ‘?’ modifier suffix is  supported,  a  case-
                 insensitive (ASCII mapping) operation mode is supported; the keyword ‘case’ is optional so that
                 ‘find?’ and ‘find?case’ are identical.

                 <b>length</b>    Queries the length of the given argument.

                 <b>hash</b>,  <b>hash32</b>  Calculates  a hash value of the given argument.  The latter will return a 32-bit
                           result regardless of host environment.  ‘?’ modifier suffix is supported.  These  use
                           Chris  Torek's hash algorithm, the resulting hash value is bit mixed as shown by Bret
                           Mulvey.

                 <b>find</b>      Search for the second in the first argument.   Shows  the  resulting  0-based  offset
                           shall it have been found.  ‘?’ modifier suffix is supported.

                 <b>substring</b>  Creates  a  substring  of  its  first argument.  The optional second argument is the
                           0-based starting offset, a negative one counts  from  the  end;  the  optional  third
                           argument specifies the length of the desired result, a negative length leaves off the
                           given number of bytes at the end of the original string; by default the entire string
                           is used.  This operation tries to work around faulty arguments (set <u>verbose</u> for error
                           logs), but reports them via the error number <u>!</u> as <u>^ERR</u>-OVERFLOW.

                 <b>trim</b>      Trim away whitespace characters from both ends of the argument.

                 <b>trim-front</b> Trim away whitespace characters from the begin of the argument.

                 <b>trim-end</b>  Trim away whitespace characters from the end of the argument.

       <b>cwd</b>       Show  the  name of the current working directory, as reported by <u><a href="../man3/getcwd.3.html">getcwd</a></u>(3).  Supports <b>vput</b> (see
                 “Command modifiers”).  The return status is tracked via <u>?</u>.

       <b>Decrypt</b>   [Option] For unencrypted messages this command is identical to  <b>Copy</b>;  Encrypted  messages  are
                 first decrypted, if possible, and then copied.

       <b>decrypt</b>   [Option]  For  unencrypted  messages  this command is identical to <b>copy</b>; Encrypted messages are
                 first decrypted, if possible, and then copied.

       <b>define</b>, <b>undefine</b>
                 The latter command deletes the given macro, the special name  ‘*’  will  discard  all  existing
                 macros.   Deletion of (a) macro(s) can be performed from within running (a) macro(s), including
                 self-deletion.  Without arguments the  former  command  prints  the  current  list  of  macros,
                 including  their  content,  otherwise it defines a macro, replacing an existing one of the same
                 name as applicable.

                 A defined macro can be invoked explicitly by using the <b>call</b>, <b>call_if</b>  and  <b>xcall</b>  commands,  or
                 implicitly  if a macro hook is triggered, for example a <u>folder-hook</u>.  Execution of a macro body
                 can be stopped from within by calling <b>return</b>.

                 Temporary macro block-scope variables can be created or deleted with the <b>local</b> command modifier
                 in conjunction with the commands <b>set</b> and <b>unset</b>, respectively.  To enforce unrolling of  changes
                 made  to  (global)  “INTERNAL VARIABLES” the command <b>localopts</b> can be used instead; its covered
                 scope depends on how (i.e., “as what”: normal macro, folder hook,  hook,  <b>account</b>  switch)  the
                 macro is invoked.

                 Inside  a  <b>call</b>ed  macro,  the  given positional parameters are implicitly local to the macro's
                 scope, and may be accessed via the variables <u>*</u>, <u>@</u>, <u>#</u> and <u>1</u>  and  any  other  positive  unsigned
                 decimal  number  less  than  or  equal  to  <u>#</u>.  Positional parameters can be <b>shift</b>ed, or become
                 completely replaced, removed etc. via <b>vpospar</b>.  A helpful command for numeric  computation  and
                 string evaluations is <b>vexpr</b>, <b>csop</b> offers C-style byte string operations.

                       define name {
                         command1
                         command2
                         ...
                         commandN
                       }

                       define exmac {
                         echo Parameter 1 of ${#} is ${1}, all: ${*} / ${@}
                         return 1000 0
                       }
                       call exmac Hello macro exmac!
                       echo ${?}/${!}/${^ERRNAME}

       <b>delete</b>, <b>undelete</b>
                 (d,  u)  Marks  the  given  message  list  as being or not being ‘deleted’, respectively; if no
                 argument has been specified then the usual search  for  a  visible  message  is  performed,  as
                 documented  for  “Message  list  arguments”,  showing  only the next input prompt if the search
                 fails.  Deleted messages will neither be saved in the “secondary mailbox” MBOX nor will they be
                 available for most other commands.  If the <u>autoprint</u> variable is set, the new “dot” or the last
                 message restored, respectively, is automatically <b>type</b>d; also see <b>dp</b>, <b>dt</b>.

       <b>digmsg</b>    [Only new quoting rules] Digging (information out  of)  messages  is  possible  through  <b>digmsg</b>
                 objects,  which can be <b>create</b>d for the given message number; in “Compose mode” the hyphen-minus
                 ‘-’ will instead open the message that is being composed.  If a hyphen-minus is  given  as  the
                 optional third argument then output will be generated on the standard output channel instead of
                 being subject to consumption by the <b>readall</b> (or <b>read</b> and <b>readsh</b>) command(s).  Note: output must
                 be  consumed  before normal processing can continue; for <b>digmsg</b> objects this means each command
                 output has to be read until the end of file (EOF) state occurs.

                 The objects may be <b>remove</b>d again by giving the same identifier used  for  creation;  this  step
                 could  be omitted: objects will be automatically closed when the active <b>folder</b> (mailbox) or the
                 compose mode is left, respectively.  In all other use cases the second argument  is  an  object
                 identifier,  and  the third and all following arguments are interpreted as via <b>~^</b> (see “COMMAND
                 ESCAPES”):

                       ? vput = msgno; digmsg create $msgno
                       ? digmsg $msgno header list;   readall x;   echon $x
                       210 Subject From To Message-ID References In-Reply-To
                       ? digmsg $msgno header show Subject;readall x;echon $x
                       212 Subject
                       'Hello, world'

                       ? digmsg remove $msgno

       <b>discard</b>   (di) Identical to <b>ignore</b>.  Superseded by the multiplexer <b>headerpick</b>.

       <b>dp</b>, <b>dt</b>    Delete the given messages and automatically <b>type</b> the new “dot” if one exists, regardless of the
                 setting of <u>autoprint</u>.

       <b>dotmove</b>   Move the “dot” up or down by one message when given ‘+’ or ‘-’ argument, respectively.

       <b>draft</b>, <b>undraft</b>
                 Take message  lists  and  mark  each  given  message  as  being  draft,  or  not  being  draft,
                 respectively, as documented in the section “Message states”.

       <b>echo</b>      [Only  new quoting rules](ec) Print the given strings, equivalent to the shell utility <u><a href="../man1/echo.1.html">echo</a></u>(1),
                 that is, “Shell-style argument quoting” expansion is performed and, different to the  otherwise
                 identical  <b>echon</b>,  a  trailing newline is echoed.  <b>vput</b> as documented in “Command modifiers” is
                 supported, and the error number <u>!</u> is managed: if data is stored in a variable then  the  return
                 value reflects the length of the result string in case of success and is ‘-1’ on error.

                 <b>Remarks:</b>  this  command  traditionally (in BSD Mail) also performed “Filename transformations”,
                 which is standard incompatible and hard to handle because quoting  transformation  patterns  is
                 not possible; the subcommand <b>file-expand</b> of <b>vexpr</b> can be used to expand filenames.

       <b>echoerr</b>   [Only  new  quoting rules] Identical to <b>echo</b>, but the message is written to standard error, and
                 prefixed by <u>log-prefix</u>.  Also see <b>echoerrn</b>.  In interactive  sessions  the  [Option]al  message
                 ring queue for <b>errors</b> will be used instead, if available and <b>vput</b> was not used.

       <b>echon</b>     [Only new quoting rules] Identical to <b>echo</b>, but does not write or store a trailing newline.

       <b>echoerrn</b>  [Only new quoting rules] Identical to <b>echoerr</b>, but does not write or store a trailing newline.

       <b>edit</b>      (e)  Point  the text EDITOR at each message from the given list in turn.  Modified contents are
                 discarded unless the <u>writebackedited</u> variable is set, and are not used unless the  mailbox  can
                 be  written to and the editor returns a successful exit status.  <b>visual</b> can be used instead for
                 a more display oriented editor.

       <b>elif</b>      Part of the <b>if</b> (see there for more), <b>elif</b>, <b>else</b>, <b>endif</b> conditional —  if  the  condition  of  a
                 preceding  <b>if</b>  was  false,  check the following condition and execute the following block if it
                 evaluates true.

       <b>else</b>      (el) Part of the <b>if</b> (see there for more), <b>elif</b>, <b>else</b>,  <b>endif</b>  conditional  —  if  none  of  the
                 conditions of the preceding <b>if</b> and <b>elif</b> commands was true, the <b>else</b> block is executed.

       <b>endif</b>     (en)  Marks  the  end  of  an  <b>if</b> (see there for more), <b>elif</b>, <b>else</b>, <b>endif</b> conditional execution
                 block.

       <b>environ</b>   [Only new quoting rules] There is a strict separation in between “INTERNAL VARIABLES”  and  the
                 program “ENVIRONMENT”, which is inherited by child processes.  Some variables of the latter are
                 however  vivid  for  program  operation,  their  purpose  is  known,  therefore  they have been
                 integrated transparently into handling of the former, as accessible  via  <b>set</b>  and  <b>unset</b>.   To
                 integrate  any other environment variable, and/or to export internal variables into the process
                 environment where they normally are not, a <b>link</b> needs to become established with this  command,
                 for example

                       <b>environ</b> <b>link</b> <b>PERL5LIB</b> <b>TZ</b>

                 Afterwards  changing  such  variables with <b>set</b> will cause automatic updates of the environment,
                 too.  Sufficient system support provided (it was in BSD as early as 1987, and  is  standardized
                 since  Y2K)  removing such variables with <b>unset</b> will remove them also from the environment, but
                 in any way the knowledge they ever have been <b>link</b>ed will be lost.  This implies that  <b>localopts</b>
                 may cause loss of such links.

                 The  subcommand  <b>unlink</b>  removes an existing link without otherwise touching variables, the <b>set</b>
                 and <b>unset</b> subcommands are identical to <b>set</b> and  <b>unset</b>,  but  additionally  update  the  program
                 environment accordingly; removing a variable breaks any freely established <b>link</b>.

       <b>errors</b>    [Option]  As  console  user interfaces at times scroll error messages by too fast and/or out of
                 scope, data can additionally be sent to an error queue manageable by this command: <u>show</u>  or  no
                 argument  will  display  and  clear  the queue, <u>clear</u> will only clear it.  As the queue becomes
                 filled with <u>errors-limit</u> entries the eldest entries are being  dropped.   There  are  also  the
                 variables <u>^ERRQUEUE-COUNT</u> and <u>^ERRQUEUE-EXISTS</u>.

       <b>eval</b>      [Only  new  quoting rules] Construct a command by concatenating the arguments, separated with a
                 single space character, and then evaluate the result.  This command  passes  through  the  exit
                 status <u>?</u> and error number <u>!</u> of the evaluated command; also see <b>call</b>.

                       define xxx {
                         echo "xxx arg &lt;$1&gt;"
                         shift
                         if $# -gt 0
                           \xcall xxx "$@"
                         endif
                       }
                       define yyy {
                         eval "$@ ' ball"
                       }
                       call yyy '\call xxx' "b\$'\t'u ' "
                       call xxx arg &lt;b      u&gt;
                       call xxx arg &lt;  &gt;
                       call xxx arg &lt;ball&gt;

       <b>exit</b>      (ex  or x) Exit from S-nail without changing the active mailbox and skip any saving of messages
                 in the “secondary mailbox” MBOX, as well as a possibly tracked  line  editor  <u>history-file</u>.   A
                 possibly  set <u>on-account-cleanup</u> will be invoked, however.  The optional status number argument
                 will be passed through to <u><a href="../man3/exit.3.html">exit</a></u>(3).  [v15 behaviour may differ] For now it can happen  that  the
                 given  status  will  be  overwritten,  later  this will only occur if a later error needs to be
                 reported onto an otherwise success indicating status.

       <b>File</b>      (Fi) Like <b>folder</b>, but open the mailbox read-only.

       <b>file</b>      (fi) See <b>folder</b>.

       <b>filetype</b>, <b>unfiletype</b>
                 [Only new quoting rules] Define, list, and remove,  respectively,  file  handler  hooks,  which
                 provide  (shell) commands that enable S-nail to load and save MBOX files from and to files with
                 the registered file extensions, as shown and described for <b>folder</b>.   The  extensions  are  used
                 case-insensitively,  yet the auto-completion feature of for example <b>folder</b> will only work case-
                 sensitively.  An intermediate temporary file will be used to  store  the  expanded  data.   The
                 latter  command  will  remove  hooks  for  all  given  extensions, asterisk ‘*’ will remove all
                 existing handlers.

                 When used without arguments the former shows a list of all currently defined file  hooks,  with
                 one  argument  the  expansion  of the given alias.  Otherwise three arguments are expected, the
                 first specifying the file extension for which the hook is  meant,  and  the  second  and  third
                 defining  the  load-  and save commands to deal with the file type, respectively, both of which
                 must read from standard input and write to standard output.  Changing  hooks  will  not  affect
                 already opened mailboxes ([v15 behaviour may differ] except below).  [v15 behaviour may differ]
                 For  now  too  much  work  is  done,  and  files  are oftened read in twice where once would be
                 sufficient: this can cause problems if a filetype is changed while such a file is opened;  this
                 was already so with the built-in support of .gz etc. in Heirloom, and will vanish in v15.  [v15
                 behaviour  may  differ]  For  now  all  handler  strings are passed to the SHELL for evaluation
                 purposes; in the future a ‘!’ prefix to load and save commands may mean to  bypass  this  shell
                 instance: placing a leading space will avoid any possible misinterpretations.

                       ? filetype bz2 'bzip2 -dc' 'bzip2 -zc' \
                           gz 'gzip -dc' 'gzip -c'  xz 'xz -dc' 'xz -zc' \
                           zst 'zstd -dc' 'zstd -19 -zc' \
                           zst.pgp 'gpg -d | zstd -dc' 'zstd -19 -zc | gpg -e'
                       ? set record=+sent.zst.pgp

       <b>flag</b>, <b>unflag</b>
                 Take  message lists and mark the messages as being flagged, or not being flagged, respectively,
                 for urgent/special attention.  See the section “Message states”.

       <b>Folder</b>    (Fold) Like <b>folder</b>, but open the mailbox read-only.

       <b>folder</b>    (fold) Open a new, or show status information of the current mailbox.  If an argument is given,
                 changes (such as deletions) will be written out, a new mailbox will  be  opened,  the  internal
                 variables  <u>mailbox-resolved</u> and <u>mailbox-display</u> will be updated, a set according <u>folder-hook</u> is
                 executed, and optionally a summary of <b>headers</b> is displayed if the variable <u>header</u> is set.

                 “Filename transformations” will be applied to the <u>name</u>  argument,  and  ‘protocol://’  prefixes
                 are,  i.e.,  URL  (see  “On  URL  syntax  and  credential  lookup”) syntax is understood, as in
                 ‘mbox:///tmp/somefolder’.  If a protocol prefix is used the mailbox type is fixated,  otherwise
                 opening none-existing <b>folders</b> uses the protocol defined in <u>newfolders</u>.

                 For  the  protocols <u>mbox</u> and <u>file</u> (MBOX database), as well as <u>eml</u> (electronic mail message [v15
                 behaviour may differ] read-only) the list of all registered <b>filetype</b>s  is  traversed  to  check
                 whether  hooks  shall  be  used to load (and save) data from (and to) the given <u>name</u>.  Changing
                 hooks will not affect already opened mailboxes.  For example, the following creates  hooks  for
                 the <u><a href="../man1/gzip.1.html">gzip</a></u>(1) compression tool and a combined compressed and encrypted format:

                       ? filetype \
                           gzip 'gzip -dc' 'gzip -c' \
                           zst.pgp 'gpg -d | zstd -dc' 'zstd -19 -zc | gpg -e'

                 For  historic  reasons <b>filetype</b>s provide limited (case-sensitive) auto-completion capabilities.
                 For example ‘mbox.gz’ will be found for ‘? file mbox’, provided that corresponding handlers are
                 installed.  It will neither find ‘mbox.GZ’ nor ‘mbox.Gz’  however,  but  an  explicit  ‘?  file
                 mbox.GZ’  will  find  and use the handler for ‘gz’.  [v15 behaviour may differ] The latter mode
                 can only be used for MBOX files.

                 EML files consist of only one mail message, [v15 behaviour may differ] and can only  be  opened
                 read-only.   When reading MBOX files tolerant POSIX rules are used by default.  Invalid message
                 boundaries that can be found quite often in historic MBOX files will be complained about  (even
                 more  with  <u>debug</u>):  in this case the method described for <u>mbox-rfc4155</u> can be used to create a
                 valid MBOX database from the invalid input.

                 MBOX databases and EML files will always be protected via file-region locks  (<u><a href="../man2/fcntl.2.html">fcntl</a></u>(2))  during
                 file  operations to protect against concurrent modifications.  [Option] An MBOX <u>inbox</u> (MAIL) or
                 “primary system mailbox” will also be protected by so-called dotlock files, the traditional way
                 of mail spool file locking: for any file ‘x’ a lock file ‘x.lock’ will be  created  during  the
                 synchronization,  in the same directory and with the same user and group identities as the file
                 of interest — as necessary created by an external privileged dotlock  helper.   <u>dotlock-disable</u>
                 disables dotlock files.  Also see “FAQ”: “Howto handle stale dotlock files”.

                 [Option]  If  no  protocol  has  been  fixated,  and  <u>name</u>  refers  to  a  directory  with  the
                 subdirectories ‘tmp’, ‘new’ and ‘cur’, then it is treated as a folder in “Maildir” format.  The
                 maildir format stores each message in its own file, and has been designed so that file  locking
                 is not necessary when reading or writing files.

                 [Option]ally  URLs  can  be  used  to access network resources, securely via “Encrypted network
                 communication”, if so supported.  Network communication socket timeouts  are  configurable  via
                 <u>socket-connect-timeout</u>.    All  network  traffic  may  be  proxied  over  a  SOCKS  server  via
                 <u>socks-proxy</u>.

                       <b>[v15-compat]</b> <b>protocol://[user[:password]@]host[:port][/path]</b>
                       <b>[no</b> <b>v15-compat]</b> <b>protocol://[user@]host[:port][/path]</b>

                 [Option]ally supported network protocols are <u>pop3</u> (POP3) and <u>pop3s</u>  (POP3  with  TLS  encrypted
                 transport),  <u>imap</u>  and  <u>imaps</u>.   The  <u>[/path]</u> part is valid only for IMAP; there it defaults to
                 <u>INBOX</u>.  Network URLs require a special encoding as documented in the section “On URL syntax and
                 credential lookup”.

       <b>folders</b>   Lists the names of all folders below the given argument or <u>folder</u>.   For  file-based  protocols
                 LISTER will be used for display purposes.

       <b>Followup</b>, <b>followup</b>
                 (Compose  mode)(F,fo) Similar to <b>Reply</b>, and <b>reply</b>, respectively, but save the message in a file
                 named after the local part of the (first) recipient's address, possibly overwriting <u>record</u>, and
                 honouring <u>outfolder</u>.  Also see <b>Copy</b> and <b>Save</b>.

       <b>Forward</b>   (Compose mode) Similar to <b>forward</b>, but saves the message in a file named after the  local  part
                 of the recipient's address (instead of in <u>record</u>).

       <b>forward</b>   (Compose  mode)  Take  a  message list and the address of a recipient, subject to <u>fullnames</u>, to
                 whom the messages are sent.  The text of the original message  is  included  in  the  new  one,
                 enclosed     by     the     values     of    <u>forward-inject-head</u>    and    <u>forward-inject-tail</u>.
                 <u>content-description-forwarded-message</u> is inspected.   The  list  of  included  headers  can  be
                 filtered  with  the ‘forward’ slot of the white- and blacklisting command <b>headerpick</b>.  Only the
                 first part of a multipart message is included but for <u>forward-as-attachment</u>.

                 This may generate the errors <u>^ERR</u>-DESTADDRREQ  if  no  receiver  has  been  specified,  or  was
                 rejected  by  <u>expandaddr</u>  policy,  <u>^ERR</u>-IO  if  an I/O error occurs, <u>^ERR</u>-NOTSUP if a necessary
                 character set conversion fails, and <u>^ERR</u>-INVAL for other errors.  It can also fail with  errors
                 of “Specifying messages”.  Any error stops processing of further messages.

       <b>from</b>      (f)  Takes  a  list  of message specifications and displays a summary of their message headers,
                 exactly as via <b>headers</b>, making the first message of the result the new “dot” (the last  message
                 if <u>showlast</u> is set).  An alias of this command is <b>search</b>.  Also see “Specifying messages”.

       <b>Fwd</b>       [Obsolete] Alias for <b>Forward</b>.

       <b>fwd</b>       [Obsolete] Alias for <b>forward</b>.

       <b>fwdignore</b>
                 [Obsolete] Superseded by the multiplexer <b>headerpick</b>.

       <b>fwdretain</b>
                 [Obsolete] Superseded by the multiplexer <b>headerpick</b>.

       <b>ghost</b>, <b>unghost</b>
                 [Obsolete] Replaced by <b>commandalias</b>, <b>uncommandalias</b>.

       <b>headerpick</b>, <b>unheaderpick</b>
                 [Only  new  quoting  rules] Multiplexer command to manage white- and blacklisting selections of
                 header fields for a variety of applications.  Without arguments the set of contexts  that  have
                 settings  is  displayed.   When given arguments, the first argument is the context to which the
                 command applies, one of (case-insensitive) ‘type’ for  display  purposes  (for  example  <b>type</b>),
                 ‘save’  for  selecting which headers shall be stored persistently when <b>save</b>, <b>copy</b>, <b>move</b> or even
                 <b>decrypt</b>ing messages (note that MIME related etc. header fields should not be ignored  in  order
                 to  not  destroy  usability of the message in this case), ‘forward’ for stripping down messages
                 when <b>forward</b>ing message (has no effect if <u>forward-as-attachment</u> is set), and ‘top’ for defining
                 user-defined set of fields for the command <b>top</b>.

                 The current settings of the given context are displayed if it is the only argument.   A  second
                 argument  denotes  the  type of restriction that is to be chosen, it may be (a case-insensitive
                 prefix  of)  ‘retain’  or  ‘ignore’  for  white-  and  blacklisting   purposes,   respectively.
                 Establishing a whitelist suppresses inspection of the corresponding blacklist.

                 If  no  further  argument  is  given  the current settings of the given type will be displayed,
                 otherwise the remaining arguments specify header fields, which [Option]ally  may  be  given  as
                 regular expressions, to be added to the given type.  The special wildcard field (asterisk, ‘*’)
                 will establish a (fast) shorthand setting which covers all fields.

                 The  latter  command always takes three or more arguments and can be used to remove selections,
                 i.e., from the given context, the given type of list, all the given headers  will  be  removed,
                 the special argument ‘*’ will remove all headers.

       <b>headers</b>   (h)  Show  the  current  group  of headers, the size of which depends on the variable <u>screen</u> in
                 interactive mode, and the format of  which  can  be  defined  with  <u>headline</u>.   If  a  message-
                 specification  is  given the group of headers containing the first message therein is shown and
                 the message at the top of the screen becomes the new “dot”; the last  message  is  targeted  if
                 <u>showlast</u> is set.

       <b>help</b>      (hel) A synonym for <b>?</b>.

       <b>history</b>   [Option]  Without  arguments  or  when given <b>show</b> all history entries are shown (this mode also
                 supports a more <u>verbose</u> output).  <b>load</b> will replace the list of entries  with  the  content  of
                 <u>history-file</u>,  and <b>save</b> will dump all entries to said file, replacing former content, and <b>clear</b>
                 will delete all entries.  The argument can also be a signed decimal <u>NUMBER</u>, which  will  select
                 and  evaluate  the  respective history entry, and move it to the top of the history; a negative
                 number is used as an offset to the current command so that ‘-1’ will select the  last  command,
                 the  history  top,  whereas  <b>delete</b>  will  delete  all  given entries (<u>:NUMBER:</u>).  Also see “On
                 terminal control and line editor”.

       <b>hold</b>      (ho, also <b>preserve</b>) Takes a message list and marks each message therein  to  be  saved  in  the
                 user's  system  <u>inbox</u> instead of in the “secondary mailbox” MBOX.  Does not override the <b>delete</b>
                 command.  S-nail deviates from the POSIX standard with this command,  because  a  <b>next</b>  command
                 issued after <b>hold</b> will display the following message, not the current one.

       <b>if</b>        (i)  Part of the <b>if</b>, <b>elif</b>, <b>else</b>, <b>endif</b> conditional execution construct — if the given condition
                 is true then the encapsulated block is executed.  The POSIX standard only supports  the  (case-
                 insensitive)  conditions ‘r’eceive and ‘s’end, the remaining are non-portable extensions.  [v15
                 behaviour may differ] In conjunction with the <b>wysh</b>  command  prefix(es)  “Shell-style  argument
                 quoting” and more test operators are available.

                       if receive
                         commands ...
                       else
                         commands ...
                       endif

                 Further  (case-insensitive)  one-argument  conditions are ‘t’erminal which evaluates to true in
                 interactive terminal sessions (running with standard input or standard  output  attached  to  a
                 terminal,  and  none  of  the “quickrun” command line options <b>-e</b>, <b>-H</b> and <b>-L</b> have been used), as
                 well as any boolean value (see “INTERNAL VARIABLES” for  textual  boolean  representations)  to
                 mark  an  enwrapped  block  as “never execute” or “always execute”.  (Remarks: condition syntax
                 errors skip all branches until <b>endif</b>.)

                 [no v15-compat] and without <b>wysh</b>: It is possible to  check  “INTERNAL  VARIABLES”  as  well  as
                 “ENVIRONMENT”  variables for existence or compare their expansion against a user given value or
                 another variable by using the ‘$’ (“variable next”) conditional trigger character;  a  variable
                 on  the  right  hand  side  may  be  signalled using the same mechanism.  Variable names may be
                 enclosed in a pair of matching braces.  When this mode has been  triggered,  several  operators
                 are  available  ([v15-compat]  and  <b>wysh</b>:  they  are always available, and there is no trigger:
                 variables will have been expanded by the shell-compatible parser before  the  <b>if</b>  etc.  command
                 sees them).

                 [v15-compat]  Two  argument  conditions.   Variables can be tested for existence and expansion:
                 ‘-N’ will test whether the given variable exists, so that ‘-N editalong’ will evaluate to  true
                 when  <u>editalong</u>  is  set,  whereas ‘-Z editalong’ will if it is not.  ‘-n "$editalong"’ will be
                 true if the variable is set and expands to a non-empty string, ‘-z $'\$editalong'’ only if  the
                 expansion  is  empty,  whether the variable exists or not.  The remaining conditions take three
                 arguments.

                 Integer operators treat the arguments on the left and  right  hand  side  of  the  operator  as
                 integral numbers and compare them arithmetically.  It is an error if any of the operands is not
                 a  valid integer, an empty argument (which implies it had been quoted) is treated as if it were
                 0.  Via the question mark ‘?’ modifier suffix a saturated operation  mode  is  available  where
                 numbers  will  linger  at  the  minimum  or  maximum possible value, instead of overflowing (or
                 trapping), the keyword  ‘saturated’  is  optional,  ‘==?’,  ‘==?satu’  and  ‘==?saturated’  are
                 therefore identical.  Available operators are ‘-lt’ (less than), ‘-le’ (less than or equal to),
                 ‘-eq’ (equal), ‘-ne’ (not equal), ‘-ge’ (greater than or equal to), and ‘-gt’ (greater than).

                 String  and regular expression data operators compare the left and right hand side according to
                 their textual content.  Unset variables are treated as the empty string.  Via the question mark
                 ‘?’ modifier suffix a case-insensitive operation mode  is  available,  the  keyword  ‘case’  is
                 optional, ‘==?’ and ‘==?case’ are identical.

                 Available  string  operators  are  ‘&lt;’ (less than), ‘&lt;=’ (less than or equal to), ‘==’ (equal),
                 ‘!=’ (not equal), ‘&gt;=’ (greater than or equal to), ‘&gt;’ (greater than), ‘=%’ (is  substring  of)
                 and  ‘!%’  (is  not substring of).  By default these operators work on bytes and (therefore) do
                 not take into account character set specifics.  If the  case-insensitivity  modifier  has  been
                 used,  case  is  ignored according to the rules of the US-ASCII encoding, i.e., bytes are still
                 compared.

                 When the [Option]al regular expression support is available, the  additional  string  operators
                 ‘=~’  and  ‘!~’  can be used.  They treat the right hand side as an extended regular expression
                 that is matched according to the active locale (see “Character  sets”),  i.e.,  character  sets
                 should be honoured correctly.

                 Conditions  can  be joined via AND-OR lists (where the AND operator is ‘&amp;&amp;’ and the OR operator
                 is ‘||’), which have equal precedence and will be evaluated with left associativity, thus using
                 the same syntax that is known for the <u><a href="../man1/sh.1.html">sh</a></u>(1).  It is also possible to form groups of  conditions
                 and  lists  by  enclosing  them in pairs of brackets ‘[ ... ]’, which may be interlocked within
                 each other, and also be joined via AND-OR lists.

                 The results of individual conditions and entire groups may be modified via unary operators: the
                 unary operator ‘!’ will reverse the result.

                       wysh set v15-compat=yes # with value: automatic "wysh"!
                       if -N debug;echo *debug* set;else;echo not;endif
                       if "$ttycharset" == UTF-8 || "$ttycharset" ==?cas UTF8
                         echo ttycharset is UTF-8, the former case-sensitive!
                       endif
                       set t1=one t2=one
                       if [ "${t1}" == "${t2}" ]
                         echo These two variables are equal
                       endif
                       if "$features" =% ,+regex, &amp;&amp; "$TERM" =~?case ^xterm.*
                         echo ..in an X terminal
                       endif
                       if [ [ true ] &amp;&amp; [ [ "${debug}" != '' ] || \
                           [ "$verbose" != '' ] ] ]
                         echo Noisy, noisy
                       endif
                       if true &amp;&amp; [ -n "$debug" || -n "${verbose}" ]
                         echo Left associativity, as is known from the shell
                       endif

       <b>ignore</b>    (ig) Identical to <b>discard</b>.  Superseded by the multiplexer <b>headerpick</b>.

       <b>list</b>      Shows the names of all available commands, in command lookup order.   [Option]  In  conjunction
                 with  a  set  variable  <u>verbose</u>  additional  information will be provided for each command: the
                 argument type will be indicated, the documentation string will be shown, and the set of command
                 flags will show up:

                 ‘`local'’    command supports the command modifier <b>local</b>.
                 ‘`vput'’     command supports the command modifier <b>vput</b>.
                 ‘*!*’        the error number is tracked in <u>!</u>.
                 ‘needs-box’  whether the command needs an active mailbox, a <b>folder</b>.
                 ‘ok:’        indicators whether command is ...
                              ‘batch/interactive’
                                            usable in interactive or batch mode (<b>-#</b>).
                              ‘send-mode’   usable in send mode.
                              ‘subprocess’  allowed to be used  when  running  in  a  subprocess  instance,  for
                                            example from within a macro that is called via <u>on-compose-splice</u>.
                 ‘not ok:’    indicators whether command is not ...
                              ‘compose mode’  available in “Compose mode”.
                              ‘startup’       available during program startup, like in “Resource files”.
                 ‘gabby’      The command produces <u>history-gabby</u> <b>history</b> entries.

       <b>localopts</b>
                 Enforce  change  localization  of  <b>environ</b> (linked) “ENVIRONMENT” as well as (global) “INTERNAL
                 VARIABLES”, meaning that their state will be reverted to  the  former  one  once  the  “covered
                 scope”  is left.  Just like the command modifier <b>local</b>, which provides block-scope localization
                 for some commands (instead), it can only be used inside of macro definition  blocks  introduced
                 by  <b>account</b>  or  <b>define</b>.   The  covered scope of an <b>account</b> is left once a different account is
                 activated, and some macros, notably <u>folder-hook</u>s, use their  own  specific  notion  of  covered
                 scope, here it will be extended until the folder is left again.

                 This setting stacks up: i.e., if ‘macro1’ enables change localization and calls ‘macro2’, which
                 explicitly  resets  localization, then any value changes within ‘macro2’ will still be reverted
                 when the scope of ‘macro1’ is left.  (Caveats:  if  in  this  example  ‘macro2’  changes  to  a
                 different  <b>account</b>  which  sets some variables that are already covered by localizations, their
                 scope will be extended, and in fact  leaving  the  <b>account</b>  will  (thus)  restore  settings  in
                 (likely) global scope which actually were defined in a local, macro private context!)

                 This command takes one or two arguments, the optional first one specifies an attribute that may
                 be  one of <b>scope</b>, which refers to the current scope and is thus the default, <b>call</b>, which causes
                 any macro that is being <b>call</b>ed to be started with localization enabled by default, as  well  as
                 <b>call-fixate</b>,  which (if enabled) disallows any called macro to turn off localization: like this
                 it can be ensured that once the current scope regains  control,  any  changes  made  in  deeper
                 levels  have  been reverted.  The latter two are mutually exclusive, and neither affects <b>xcall</b>.
                 The (second) argument is interpreted as a boolean (string, see “INTERNAL VARIABLES”) and states
                 whether the given attribute shall be turned on or off.

                       define temporary_settings {
                         set possibly_global_option1
                         localopts on
                         set localized_option1
                         set localized_option2
                         localopts scope off
                         set possibly_global_option2
                       }

       <b>Lfollowup</b>, <b>Lreply</b>
                 (Compose mode) Reply to messages that come in via known  (<b>mlist</b>)  or  subscribed  (<b>mlsubscribe</b>)
                 mailing  lists,  or  pretend  to  do so (see “Mailing lists”): on top of the usual <b>followup</b> and
                 <b>reply</b>, respectively, functionality this will actively resort and even remove message recipients
                 in order to generate a message that is supposed to be sent to a mailing list.  For  example  it
                 will  also implicitly generate a ‘Mail-Followup-To:’ header if that seems useful, regardless of
                 the setting of the variable <u>followup-to</u>.  For more documentation please refer  to  “On  sending
                 mail, and non-interactive mode”.

                 This  may  generate the errors <u>^ERR</u>-DESTADDRREQ if no receiver has been specified, <u>^ERR</u>-PERM if
                 some addressees where rejected by <u>expandaddr</u>, <u>^ERR</u>-IO if an I/O error occurs, <u>^ERR</u>-NOTSUP if  a
                 necessary  character  set  conversion fails, and <u>^ERR</u>-INVAL for other errors.  It can also fail
                 with errors of “Specifying messages”.  Occurrence of some of the errors depend on the value  of
                 <u>expandaddr</u>.  Any error stops processing of further messages.

       <b>Mail</b>      (Compose  mode)  Similar to <b>mail</b>, but saves the message in a file named after the local part of
                 the first recipient's address (instead of in <u>record</u>).

       <b>mail</b>      (Compose mode)(m) Takes a (list of) recipient address(es)  as  (an)  argument(s),  or  asks  on
                 standard  input  if none were given; then collects the remaining mail content and sends it out.
                 Unless the internal variable <u>fullnames</u>  is  set  recipient  addresses  will  be  stripped  from
                 comments,  names  etc.   For  more  documentation  please  refer  to “On sending mail, and non-
                 interactive mode”.

                 This may generate the errors <u>^ERR</u>-DESTADDRREQ if no receiver has been specified,  <u>^ERR</u>-PERM  if
                 some  addressees  where  rejected  by  <u>expandaddr</u>,  <u>^ERR</u>-NOTSUP  if multiple messages have been
                 specified, <u>^ERR</u>-IO if an I/O error occurs, <u>^ERR</u>-NOTSUP if a necessary character set  conversion
                 fails, and <u>^ERR</u>-INVAL for other errors.  It can also fail with errors of “Specifying messages”.
                 Occurrence of some of the errors depend on the value of <u>expandaddr</u>.

       <b>mailcap</b>   [Option]  When  used  without  arguments  or if <u>show</u> has been given the content of “The Mailcap
                 files” cache is shown, (re-)initializing it first (as necessary.  If the argument is <u>load</u>  then
                 the  cache will only be (re-)initialized, and <u>clear</u> will remove its contents.  Note that S-nail
                 will try to load the files only once, use ‘<b>mailcap</b> clear’ to unlock further attempts.   Loading
                 and parsing can be made more <u>verbose</u>.

       <b>mbox</b>      (mb)  The given message list is to be sent to the “secondary mailbox” MBOX when S-nail is quit;
                 this is the default action unless the variable <u>hold</u> is set.  [v15 behaviour  may  differ]  This
                 command can only be used in a “primary system mailbox”.

       <b>mimetype</b>, <b>unmimetype</b>
                 [Only new quoting rules] Without arguments the content of the MIME type cache will displayed; a
                 more  verbose  listing  will  be  produced  if  either of <u>debug</u> or <u>verbose</u> are set.  When given
                 arguments they will be joined, interpreted as shown in “The mime.types files” (also  see  “HTML
                 mail  and  MIME  attachments”), and the resulting entry will be added (prepended) to the cache.
                 In any event MIME type sources are loaded first as necessary –  <u>mimetypes-load-control</u>  can  be
                 used to fine-tune which sources are actually loaded.

                 The  latter  command  deletes  all  specifications  of  the given MIME type, thus ‘? unmimetype
                 text/plain’ will remove all registered specifications for  the  MIME  type  ‘text/plain’.   The
                 special  name  ‘*’  will  discard all existing MIME types, just as will ‘reset’, but which also
                 reenables cache initialization via <u>mimetypes-load-control</u>.

       <b>mimeview</b>  [v15 behaviour may differ] Only available in interactive mode, this command allows execution of
                 external MIME type handlers which do not integrate into the normal <b>type</b> output (see “HTML  mail
                 and  MIME attachments”).  ([v15 behaviour may differ] No syntax to directly address parts, this
                 restriction may vanish.)  The user will be asked for each non-text part of the given message in
                 turn whether the registered handler shall be used to display the part.

       <b>mlist</b>, <b>unmlist</b>
                 [Only new quoting rules] Manage the list of known “Mailing lists”; subscriptions are controlled
                 via <b>mlsubscribe</b>.  The latter command deletes all given arguments, or all at once when given the
                 asterisk ‘*’.  The former shows  the  list  of  all  currently  known  lists  if  used  without
                 arguments,  otherwise  the  given  arguments  will  become known.  [Option] In the latter case,
                 arguments which contain any of the “magic regular expression characters” will be interpreted as
                 one, possibly matching many addresses; these will be  sequentially  matched  via  linked  lists
                 instead of being looked up in a dictionary.

       <b>mlsubscribe</b>, <b>unmlsubscribe</b>
                 Building  upon the command pair <b>mlist</b>, <b>unmlist</b>, but only managing the subscription attribute of
                 mailing lists.  (The former will also create not yet existing mailing lists.)

       <b>Move</b>      Similar to <b>move</b>, but move the messages to a file named after the local part of  the  sender  of
                 the  first  message  instead of taking a filename argument; <u>outfolder</u> is inspected to decide on
                 the actual storage location.

       <b>move</b>      Acts like <b>copy</b> but marks the messages for deletion if they were transferred successfully.

       <b>More</b>      Like <b>more</b>, but also displays header fields which would not pass the <b>headerpick</b>  selection,  and
                 all MIME parts.  Identical to <b>Page</b>.

       <b>more</b>      Invokes  the  PAGER  on  the  given  messages,  even in non-interactive mode and as long as the
                 standard output is a terminal.  Identical to <b>page</b>.

       <b>mtaaliases</b>
                 [Option] When used without arguments or if <u>show</u> has been given the content of  the  <u>mta-aliases</u>
                 cache  is  shown,  (re-)initializing it first (as necessary).  If the argument is <u>load</u> then the
                 cache will only be (re-)initialized, and <u>clear</u> will remove its contents.

       <b>netrc</b>     [Option] When used without arguments, or when the argument was <u>show</u> the content of the <u><a href="file:~/.netrc">~/.netrc</a></u>
                 cache is shown, initializing it as necessary.  If the argument is <u>load</u> then the cache  will  be
                 (re)loaded,  whereas  <u>clear</u>  removes it.  Loading and parsing can be made more <u>verbose</u>.  <u>lookup</u>
                 will query  the  cache  for  the  URL  given  as  the  second  argument  (‘[USER@]HOST’).   See
                 <u>netrc-lookup</u>,  <u>netrc-pipe</u>  and  the  section “On URL syntax and credential lookup”; the section
                 “The .netrc file” documents the file format in detail.

       <b>newmail</b>   Checks for new mail in the current folder without committing any changes before.  If  new  mail
                 is present, a message is shown.  If the <u>header</u> variable is set, the headers of each new message
                 are also shown.  This command is not available for all mailbox types.

       <b>next</b>      (n)  (like ‘+’ or “ENTER”) Goes to the next message in sequence and types it.  With an argument
                 list, types the next matching message.

       <b>New</b>       Same as <b>Unread</b>.

       <b>new</b>       Same as <b>unread</b>.

       <b>noop</b>      If the current folder is accessed via a network connection, a “NOOP” command is sent, otherwise
                 no operation is performed.

       <b>Page</b>      Like <b>page</b>, but also displays header fields which would not pass the <b>headerpick</b>  selection,  and
                 all MIME parts.  Identical to <b>More</b>.

       <b>page</b>      Invokes  the  PAGER  on  the  given  messages,  even in non-interactive mode and as long as the
                 standard output is a terminal.  Identical to <b>more</b>.

       <b>Pipe</b>      Like <b>pipe</b> but also pipes header fields which would not pass the <b>headerpick</b> selection,  and  all
                 parts of MIME ‘multipart/alternative’ messages.

       <b>pipe</b>      (pi)  Takes  an  optional  message list and shell command (that defaults to <u>cmd</u>), and pipes the
                 messages through the command.  If the <u>page</u> variable is set, every  message  is  followed  by  a
                 formfeed character.

       <b>preserve</b>  (pre) A synonym for <b>hold</b>.

       <b>Print</b>     (P) Alias for <b>Type</b>.

       <b>print</b>     (p) Research Unix equivalent of <b>type</b>.

       <b>quit</b>      (q)  Terminates  the  session, saving all undeleted, unsaved messages in the current “secondary
                 mailbox” MBOX, preserving all messages marked with <b>hold</b> or <b>preserve</b> or never referenced in  the
                 system  <u>inbox</u>,  and removing all other messages from the “primary system mailbox”.  If new mail
                 has arrived during the session, the message “You have new mail” will be shown.  If given  while
                 editing  a  mailbox  file  with the command line option <b>-f</b>, then the edit file is rewritten.  A
                 return to the shell is effected, unless the rewrite of edit file fails, in which case the  user
                 can  escape  with the exit command.  The optional status number argument will be passed through
                 to <u><a href="../man3/exit.3.html">exit</a></u>(3).  [v15 behaviour may differ] For now it can happen that the  given  status  will  be
                 overwritten, later this will only occur if a later error needs to be reported onto an otherwise
                 success indicating status.

       <b>read</b>      [Only  new  quoting  rules]  Read  a  line  from  standard input, or the channel set active via
                 <b>readctl</b>, and assign the data, which will be split as indicated by <u>ifs</u>, to the given  variables.
                 The  variable  names  are  checked by the same rules as documented for <b>vput</b>, and the same error
                 codes will be seen in <u>!</u>; the exit status <u>?</u> indicates the number of bytes read, it will be  ‘-1’
                 with  the error number <u>!</u> set to <u>^ERR</u>-BADF in case of I/O errors, or <u>^ERR</u>-NONE upon End-Of-File.
                 If there are more fields than variables, assigns successive fields to the last given  variable.
                 If there are less fields than variables, assigns the empty string to the remains.

                       ? read a b c
                          H  e  l  l  o
                       ? echo "&lt;$a&gt; &lt;$b&gt; &lt;$c&gt;"
                       &lt;H&gt; &lt;e&gt; &lt;l  l  o&gt;
                       ? wysh set ifs=:; read a b c;unset ifs
                       hey2.0,:"'you    ",:world!:mars.:
                       ? echo $?/$^ERRNAME / &lt;$a&gt;&lt;$b&gt;&lt;$c&gt;
                       0/NONE / &lt;hey2.0,&gt;&lt;"'you    ",&gt;&lt;world!:mars.:&gt;&lt;&gt;&lt;&gt;

       <b>readsh</b>    [Only  new  quoting  rules]  Like  <b>read</b>, but splits on shell token boundaries (see “Shell-style
                 argument quoting”) rather than at <u>ifs</u>.  [v15 behaviour may differ] Could become a <b>commandalias</b>,
                 maybe ‘read --tokenize --’.

       <b>readall</b>   [Only new quoting rules] Read anything from standard input,  or  the  channel  set  active  via
                 <b>readctl</b>,  and  assign the data to the given variable.  The variable name is checked by the same
                 rules as documented for <b>vput</b>, and the same error codes will be seen in <u>!</u>;  the  exit  status  <u>?</u>
                 indicates the number of bytes read, it will be ‘-1’ with the error number <u>!</u> set to <u>^ERR</u>-BADF in
                 case  of  I/O errors, or <u>^ERR</u>-NONE upon End-Of-File.  [v15 behaviour may differ] The input data
                 length is restricted to 31-bits.

       <b>readctl</b>   [Only new quoting rules] Manages input channels for <b>read</b>, <b>readsh</b> and <b>readall</b>,  to  be  used  to
                 avoid  complicated  or  impracticable  code,  like  calling  <b>read</b>  from  within a macro in non-
                 interactive mode.  Without arguments, or when the first argument is  <b>show</b>,  a  listing  of  all
                 known channels is printed.  Channels can otherwise be <b>create</b>d, and existing channels can be <b>set</b>
                 active and <b>remove</b>d by giving the string used for creation.

                 The  channel name is expected to be a file descriptor number, or, if parsing the numeric fails,
                 an input file name that undergoes minimal “Filename transformations”  (no  meta  expansion  are
                 performed).  For example (this example requires a modern shell):

                       $ printf 'echon "hey, "\nread a\nyou\necho $a' |\
                         s-nail -R#
                       hey, you
                       $ LC_ALL=C printf 'echon "hey, "\nread a\necho $a' |\
                         LC_ALL=C 6&lt;&lt;&lt; 'you' s-nail -R#X'readctl create 6'
                       hey, you

       <b>remove</b>    [Only  new  quoting  rules]  Removes  the  named  files  or directories.  If a name refers to a
                 mailbox, say a Maildir mailbox, then  a  mailbox  type  specific  removal  will  be  performed,
                 deleting the complete mailbox.  In interactive mode the user is asked for confirmation.

       <b>rename</b>    [Only  new  quoting rules] Takes the name of an existing folder and the name for the new folder
                 and renames the first to the second one.  “Filename transformations” including  shell  pathname
                 wildcard pattern expansions (<u><a href="../man7/glob.7.html">glob</a></u>(7)) are performed on both arguments.  Both folders must be of
                 the same type.

       <b>Reply</b>, <b>Respond</b>
                 (Compose  mode)(R) Identical to <b>reply</b> except that it replies to only the sender of each message
                 of the given list, by using the first message as the template  to  quote,  for  the  ‘Subject:’
                 etc.; setting <u>flipr</u> will exchange this command with <b>reply</b>.

       <b>reply</b>, <b>respond</b>
                 (Compose  mode)(r)  Take a message (list) and group-respond (to each in turn) by addressing the
                 sender and all recipients,  subject  to  <u>fullnames</u>  and  <b>alternates</b>  processing.   <u>followup-to</u>,
                 <u>followup-to-honour</u>,  <u>reply-to-honour</u>  as well as <u>recipients-in-cc</u> influence response behaviour.
                 <u>quote</u> as well as <u>quote-as-attachment</u> configure whether responded-to  message  shall  be  quoted
                 etc.,  <u>content-description-quote-attachment</u>  may  be  used.   Setting  <u>flipr</u> will exchange this
                 command with <b>Reply</b>.  The command <b>Lreply</b> offers special support for replying to  mailing  lists.
                 For more documentation please refer to “On sending mail, and non-interactive mode”.

                 This  may  generate  the  errors  <u>^ERR</u>-DESTADDRREQ  if  no  receiver has been specified, or was
                 rejected by <u>expandaddr</u> policy, <u>^ERR</u>-IO if an I/O  error  occurs,  <u>^ERR</u>-NOTSUP  if  a  necessary
                 character  set conversion fails, and <u>^ERR</u>-INVAL for other errors.  It can also fail with errors
                 of “Specifying messages”.  Any error stops processing of further messages.

       <b>Resend</b>    Like <b>resend</b>, but does not add any header lines.  This  is  not  a  way  to  hide  the  sender's
                 identity, but useful for sending a message again to the same recipients.

       <b>resend</b>    Takes  a  list  of messages and a name, and sends each message to the given addressee, which is
                 subject to <u>fullnames</u>.  ‘Resent-From:’ and related header fields are prepended to the  new  copy
                 of  the  message.   Saving in <u>record</u> is only performed if <u>record-resent</u> is set.  [v15 behaviour
                 may differ](Compose mode) is not entered, the only  supported  hooks  are  <u>on-resend-enter</u>  and
                 <u>on-resend-cleanup</u>.

                 This  may  generate  the  errors  <u>^ERR</u>-DESTADDRREQ  if  no  receiver has been specified, or was
                 rejected by <u>expandaddr</u> policy, <u>^ERR</u>-IO if an I/O  error  occurs,  <u>^ERR</u>-NOTSUP  if  a  necessary
                 character  set conversion fails, and <u>^ERR</u>-INVAL for other errors.  It can also fail with errors
                 of “Specifying messages”.  Any error stops processing of further messages.

       <b>retain</b>    (ret) Superseded by the multiplexer <b>headerpick</b>.

       <b>return</b>    Only available inside of a <b>define</b>d macro  or  an  <b>account</b>,  this  command  returns  control  of
                 execution  to  the  outer  scope.  The two optional parameters are positive decimal numbers and
                 default to 0: the first specifies the 32-bit return value  (stored  in  <u>?</u>  [v15  behaviour  may
                 differ]  and  later  extended to 64-bit), the second the 32-bit error number (stored in <u>!</u>).  As
                 documented for <u>?</u> a non-0 exit status may cause the program to exit.

       <b>Save</b>      (S) Similar to <b>save,</b> but saves the messages in a file named after the local part of the  sender
                 of the first message instead of taking a filename argument; <u>outfolder</u> is inspected to decide on
                 the actual storage location.

       <b>save</b>      (s)  Takes  a  message  list  and a filename and appends each message in turn to the end of the
                 file.   “Filename  transformations”  including  shell  pathname  wildcard  pattern   expansions
                 (<u><a href="../man7/glob.7.html">glob</a></u>(7))  is performed on the filename.  If no filename is given, the “secondary mailbox” MBOX
                 is used.  The filename in quotes, followed by the generated character count is  echoed  on  the
                 user's  terminal.   If editing a “primary system mailbox” the messages are marked for deletion.
                 To filter the saved header fields to the desired subset use the ‘save’ slot of the  white-  and
                 blacklisting command <b>headerpick</b>.  Also see <b>Copy</b>.

       <b>savediscard</b>
                 [Obsolete] Superseded by the multiplexer <b>headerpick</b>.

       <b>saveignore</b>
                 [Obsolete] Superseded by the multiplexer <b>headerpick</b>.

       <b>saveretain</b>
                 [Obsolete] Superseded by the multiplexer <b>headerpick</b>.

       <b>search</b>    Takes a message specification (list) and displays a header summary of all matching messages, as
                 via <b>headers</b>.  This command is an alias of <b>from</b>.  Also see “Specifying messages”.

       <b>seen</b>      Takes a message list and marks all messages as having been read.

       <b>set</b>, <b>unset</b>
                 (se,  [Only  new quoting rules] uns) The latter command will delete all given global variables,
                 or only block-scope local ones if the <b>local</b> command modifier has been used.  The  former,  when
                 used  without  arguments, will show all currently known variables, being more verbose if either
                 of <u>debug</u> or <u>verbose</u> is set.  Remarks: this list mode will  not  automatically  link-in  (known)
                 “ENVIRONMENT” variables, this only happens for explicit addressing, examples are <b>varshow</b>, using
                 a  variable  in  an  <b>if</b> condition or a string passed to <b>echo</b>, explicit <b>set</b>ting, as well as some
                 program-internal use cases (look-ups).

                 Otherwise the given variables (and arguments) are set or adjusted.  Arguments are of  the  form
                 ‘name=value’  (no  space  before  or  after ‘=’), or plain ‘name’ if there is no value, i.e., a
                 boolean variable.  If a name begins with ‘no’, as in ‘set nosave’, the effect is  the  same  as
                 invoking  the  <b>unset</b>  command  with  the  remaining  part of the variable (‘unset save’).  [v15
                 behaviour may differ] In conjunction with the <b>wysh</b> (or <b>local</b>) command  prefix(es)  “Shell-style
                 argument  quoting”  can  be  used  to quote arguments as necessary.  [v15 behaviour may differ]
                 Otherwise quotation marks may be placed around any part of the assignment  statement  to  quote
                 blanks or tabs.

                 When  operating in global scope any ‘name’ that is known to map to an environment variable will
                 automatically cause updates in the program environment (unsetting a variable in the environment
                 requires corresponding system support) — use the  command  <b>environ</b>  for  further  environmental
                 control.   If  the command modifier <b>local</b> has been used to enforce local scoping then the given
                 user variables will  be  garbage  collected  when  the  local  scope  is  left;  for  “INTERNAL
                 VARIABLES”,  however, <b>local</b> behaves the same as if <b>localopts</b> would have been set (temporarily),
                 which means that changes are inherited by deeper scopes.  Also see  <b>varshow</b>  and  the  sections
                 “INTERNAL VARIABLES” and “ENVIRONMENT”.

                       ? wysh set indentprefix=' -&gt; '
                       ? wysh set atab=$'' aspace=' ' zero=0

       <b>shcodec</b>   Apply  shell  quoting  rules  to  the  given  raw-data  arguments.  Supports <b>vput</b> (see “Command
                 modifiers”).  The first argument specifies the operation: <u>[+]e[ncode]</u> or <u>d[ecode]</u>  cause  shell
                 quoting  to be applied to the remains of the line, and expanded away thereof, respectively.  If
                 the former is prefixed with a plus-sign, the quoted result will not be roundtrip  enabled,  and
                 thus can be decoded only in the very same environment that was used to perform the encode; also
                 see  <b>mle-quote-rndtrip</b>.   If  the  coding  operation  fails  the  error  number  <u>!</u>  is  set  to
                 <u>^ERR</u>-CANCELED, and the unmodified input is used as the result;  the  error  number  may  change
                 again due to output or result storage errors.

       <b>shell</b>     [Only new quoting rules] (sh) Invokes an interactive version of the shell, and returns its exit
                 status.

       <b>shortcut</b>, <b>unshortcut</b>
                 [Only  new quoting rules] Manage the file- or pathname shortcuts as documented for <b>folder</b>.  The
                 latter command deletes all shortcuts given as arguments, or all at once when given the asterisk
                 ‘*’.  The former shows the list of all currently defined shortcuts if used  without  arguments,
                 the  target  of  the given with a single argument.  Otherwise arguments are treated as pairs of
                 shortcuts and their desired expansion, creating new or updating already existing ones.

       <b>shift</b>     [Only new quoting rules] Shift the positional parameter stack (starting  at  <u>1</u>)  by  the  given
                 number  (which must be a positive decimal), or 1 if no argument has been given.  It is an error
                 if the value exceeds the number of positional parameters.  If the given number is 0, no  action
                 is  performed,  successfully.  The stack as such can be managed via <b>vpospar</b>.  Note this command
                 will fail in <b>account</b> and hook macros unless the positional parameter stack has been  explicitly
                 created in the current context via <b>vpospar</b>.

       <b>show</b>      Like  <b>type</b>,  but performs neither MIME decoding nor decryption, so that the raw message text is
                 shown.

       <b>size</b>      (si) Shows the size in characters of each message of the given message list.

       <b>sleep</b>     [Only  new  quoting  rules]  Sleep  for  the  specified  number  of  seconds  (and   optionally
                 milliseconds),  by  default  interruptible.   If  a  third  argument is given the sleep will be
                 uninterruptible, otherwise the error number <u>!</u> will be set to <u>^ERR</u>-INTR if the  sleep  has  been
                 interrupted.   The  command  will  fail and the error number will be <u>^ERR</u>-OVERFLOW if the given
                 duration(s) overflow the time datatype, and <u>^ERR</u>-INVAL if the  given  durations  are  no  valid
                 integers.

       <b>sort</b>, <b>unsort</b>
                 The  latter  command  disables sorted or threaded mode, returns to normal message order and, if
                 the <u>header</u> variable is set, displays a header summary.  The former command  shows  the  current
                 sorting  criterion  when  used  without an argument, but creates a sorted representation of the
                 current folder otherwise, and changes the <b>next</b> command and the addressing modes such that  they
                 refer  to  messages  in the sorted order.  Message numbers are the same as in regular mode.  If
                 the <u>header</u> variable is set, a header summary in the new order  is  also  displayed.   Automatic
                 folder  sorting  can  be enabled by setting the <u>autosort</u> variable, as in ‘set autosort=thread’.
                 Possible sorting criterions are:

                 <u>date</u>     Sort the messages by their ‘Date:’ field, that is by the time they were sent.
                 <u>from</u>     Sort messages by the value of their ‘From:’ field, that  is  by  the  address  of  the
                          sender.  If the <u>showname</u> variable is set, the sender's real name (if any) is used.
                 <u>size</u>     Sort the messages by their size.
                 spam     [Option] Sort the message by their spam score, as has been classified by <b>spamrate</b>.
                 <u>status</u>   Sort the messages by their message status.
                 <u>subject</u>  Sort the messages by their subject.
                 <u>thread</u>   Create a threaded display.
                 <u>to</u>       Sort  messages  by  the  value  of  their  ‘To:’  field, that is by the address of the
                          recipient.  If the <u>showname</u> variable is set, the recipient's real  name  (if  any)  is
                          used.

       <b>source</b>    [Only new quoting rules] (so) The source command reads commands from the given file.  “Filename
                 transformations”  will be applied.  If the given expanded argument ends with a vertical bar ‘|’
                 then the argument will instead be interpreted as a shell  command  and  S-nail  will  read  the
                 output  generated by it.  Dependent on the settings of <u>posix</u> and <u>errexit</u>, and also dependent on
                 whether the command modifier <b>ignerr</b> had been used, encountering errors will  stop  sourcing  of
                 the given input.  [v15 behaviour may differ] Note that <b>source</b> cannot be used from within macros
                 that  execute  as  <u>folder-hook</u>s  or <b>account</b>s, i.e., it can only be called from macros that were
                 <b>call</b>ed.

       <b>source_if</b>
                 [Only new quoting rules] The difference to <b>source</b> (beside not supporting pipe syntax aka  shell
                 command  input)  is  that  this  command  will not generate an error nor warn if the given file
                 argument cannot be opened successfully.

       <b>spamclear</b>
                 [Option] Takes a list of messages and clears their ‘is-spam’ flag.

       <b>spamforget</b>
                 [Option] Takes a list of messages and causes the <u>spam-interface</u> to forget it has ever used them
                 to train its Bayesian filter.  Unless otherwise noted the ‘is-spam’  flag  of  the  message  is
                 inspected to chose whether a message shall be forgotten to be “ham” or “spam”.

       <b>spamham</b>   [Option]  Takes  a  list of messages and informs the Bayesian filter of the <u>spam-interface</u> that
                 they are “ham”.  This also clears the ‘is-spam’ flag of the messages in question.

       <b>spamrate</b>  [Option] Takes a list of messages and rates them using the configured  <u>spam-interface</u>,  without
                 modifying  the  messages,  but  setting  their  ‘is-spam’ flag as appropriate; because the spam
                 rating headers are lost the rate will be forgotten once the mailbox  is  left.   Refer  to  the
                 manual section “Handling spam” for the complete picture of spam handling in S-nail.

       <b>spamset</b>   [Option] Takes a list of messages and sets their ‘is-spam’ flag.

       <b>spamspam</b>  [Option]  Takes  a  list of messages and informs the Bayesian filter of the <u>spam-interface</u> that
                 they are “spam”.  This also sets the ‘is-spam’ flag of the messages in question.

       <b>thread</b>    [Obsolete] The same as ‘sort thread’ (consider using a ‘commandalias’ as necessary).

       <b>tls</b>       [Only new quoting  rules]  TLS  information  and  management  command  multiplexer  to  aid  in
                 “Encrypted  network  communication”, mostly available only if the term ‘,+sockets,’ is included
                 in <u>features</u>.  Commands support <b>vput</b> if so documented (see  “Command  modifiers”).   The  result
                 that  is  shown  in case of errors is always the empty string, errors can be identified via the
                 error number <u>!</u>.  For example, string length overflows are caught and set  <u>!</u>  to  <u>^ERR</u>-OVERFLOW.
                 The TLS configuration is honoured, especially <u>tls-verify</u>.

                       ? vput tls result fingerprint pop3s://ex.am.ple
                       ? echo $?/$!/$^ERRNAME: $result

                 <b>certchain</b>  Show the complete verified peer certificate chain.  Includes informational fields in
                           conjunction with <u>verbose</u>.

                 <b>certificate</b> Show only the peer certificate, without any signers.  Includes informational fields
                           in conjunction with <u>verbose</u>.

                 <b>fingerprint</b> Show the <u>tls-fingerprint-digest</u>ed fingerprint of the certificate of the given  HOST
                           (‘server:port’,  where the port defaults to the HTTPS port, 443).  <u>tls-fingerprint</u> is
                           actively ignored for the runtime of this command.

       <b>Top</b>       Like <b>top</b> but always uses the <b>headerpick</b> ‘type’ slot for white- and blacklisting header fields.

       <b>top</b>       (to) Takes a message list and types out the first <u>toplines</u> lines of each message on the  user's
                 terminal.  Unless a special selection has been established for the ‘top’ slot of the <b>headerpick</b>
                 command,  the  only header fields that are displayed are ‘From:’, ‘To:’, ‘Cc:’, and ‘Subject:’.
                 <b>Top</b> will always use  the  ‘type’  <b>headerpick</b>  selection  instead.   It  is  possible  to  apply
                 compression  to  what is displayed by setting <u>topsqueeze</u>.  Messages are decrypted and converted
                 to the terminal character set if necessary.

       <b>touch</b>     (tou) Takes a message list and marks the messages for saving in the “secondary  mailbox”  MBOX.
                 S-nail  deviates  from  the  POSIX standard with this command, as a following <b>next</b> command will
                 display the following message instead of the current one.

       <b>Type</b>      (T) Like <b>type</b> but also displays header fields which would not pass  the  <b>headerpick</b>  selection,
                 and all visualizable parts of MIME ‘multipart/alternative’ messages.

       <b>type</b>      (t)  Takes  a  message  list and types out each message on the user's terminal.  The display of
                 message headers is selectable via <b>headerpick</b>.  For MIME multipart messages, all  parts  with  a
                 content type of ‘text’, all parts which have a registered MIME type handler (see “HTML mail and
                 MIME  attachments”) which produces plain text output, and all ‘message’ parts are shown, others
                 are hidden except for their headers.  Messages are decrypted  and  converted  to  the  terminal
                 character  set  if  necessary.  The command <b>mimeview</b> can be used to display parts which are not
                 displayable as plain text.

       <b>unaccount</b>
                 See <b>account</b>.

       <b>unalias</b>   (una) See <b>alias</b>.

       <b>unanswered</b>
                 See <b>answered</b>.

       <b>unbind</b>    See <b>bind</b>.

       <b>uncollapse</b>
                 See <b>collapse</b>.

       <b>uncolour</b>  See <b>colour</b>.

       <b>undefine</b>  See <b>define</b>.

       <b>undelete</b>  See <b>delete</b>.

       <b>undraft</b>   See <b>draft</b>.

       <b>unflag</b>    See <b>flag</b>.

       <b>unfwdignore</b>
                 [Obsolete] Superseded by the multiplexer <b>headerpick</b>.

       <b>unfwdretain</b>
                 [Obsolete] Superseded by the multiplexer <b>headerpick</b>.

       <b>unignore</b>  Superseded by the multiplexer <b>headerpick</b>.

       <b>unmimetype</b>
                 See <b>mimetype</b>.

       <b>unmlist</b>   See <b>mlist</b>.

       <b>unmlsubscribe</b>
                 See <b>mlsubscribe</b>.

       <b>Unread</b>    Same as <b>unread</b>.

       <b>unread</b>    Takes a message list and marks each message as not having been read.

       <b>unretain</b>  Superseded by the multiplexer <b>headerpick</b>.

       <b>unsaveignore</b>
                 [Obsolete] Superseded by the multiplexer <b>headerpick</b>.

       <b>unsaveretain</b>
                 [Obsolete] Superseded by the multiplexer <b>headerpick</b>.

       <b>unset</b>     [Only new quoting rules] (uns) See <b>set</b>.

       <b>unshortcut</b>
                 See <b>shortcut</b>.

       <b>unsort</b>    See <b>short</b>.

       <b>unthread</b>  [Obsolete] Same as <b>unsort</b>.

       <b>urlcodec</b>  Perform URL percent codec operations on the raw-data argument, rather according  to  RFC  3986.
                 The  first argument specifies the operation: <u>e[ncode]</u> or <u>d[ecode]</u> perform plain URL percent en-
                 and decoding, respectively.  <u>p[ath]enc[ode]</u> and  <u>p[ath]dec[ode]</u>  perform  a  slightly  modified
                 operation which should be better for pathnames: it does not allow a tilde ‘~’, and will neither
                 accept hyphen-minus ‘-’ nor dot ‘’.  as an initial character.  The remains of the line form the
                 URL data which is to be converted.  This is a character set agnostic operation, and it may thus
                 decode bytes which are invalid in the current <u>ttycharset</u>.

                 Supports  <b>vput</b>  (see  “Command  modifiers”),  and  manages  the  error number <u>!</u>.  If the coding
                 operation fails the error number <u>!</u> is set to <u>^ERR</u>-CANCELED, and the unmodified input is used as
                 the result; the error number may change again due to output or  result  storage  errors.   [v15
                 behaviour  may differ] This command does not know about URLs beside what is documented.  (<b>vexpr</b>
                 offers a <b>makeprint</b> subcommand, shall the URL be displayed.)

       <b>varshow</b>   [Only new quoting rules] This command produces the same output as  the  listing  mode  of  <b>set</b>,
                 including <u>verbose</u>ity adjustments, but only for the given variables.

       <b>verify</b>    [Option]  Takes  a message list and verifies each message.  If a message is not a S/MIME signed
                 message, verification will fail for it.  The verification process checks  if  the  message  was
                 signed  using  a  valid certificate, if the message sender's email address matches one of those
                 contained within the certificate, and if the message content has been altered.

       <b>version</b>   Shows the <u>version</u> and <u>features</u> of S-nail, optionally in a more <u>verbose</u> form which also includes
                 the  build  and  running  system  environment.   This  command  supports  <b>vput</b>  (see   “Command
                 modifiers”).

       <b>vexpr</b>     [Only new quoting rules] A multiplexer command which offers signed 64-bit numeric calculations,
                 as well as other, mostly string-based operations.  C-style byte string operations are available
                 via <b>csop</b>.  The first argument defines the number, type, and meaning of the remaining arguments.
                 An empty number argument is treated as 0.  Supports <b>vput</b> (see “Command modifiers”).  The result
                 shown  in  case  of  errors  is  ‘-1’ for usage errors and numeric operations, the empty string
                 otherwise; “soft” errors, like when a search operation failed, will also set the <u>!</u> error number
                 to <u>^ERR</u>-NODATA.  Except when otherwise noted numeric arguments  are  parsed  as  signed  64-bit
                 numbers, and errors will be reported in the error number <u>!</u> as the numeric error <u>^ERR</u>-RANGE.

                 Numeric  operations  work  on one or two signed 64-bit integers.  Numbers prefixed with ‘0x’ or
                 ‘0X’ are interpreted as hexadecimal (base 16) numbers, whereas ‘0’ indicates  octal  (base  8),
                 and  ‘0b’  as  well  as ‘0B’ denote binary (base 2) numbers.  It is possible to use any base in
                 between 2 and 36, inclusive, with the ‘BASE#number’ notation, where the base  is  given  as  an
                 unsigned  decimal  number,  so ‘16#AFFE’ is a different way of specifying a hexadecimal number.
                 Unsigned interpretation of a number can be enforced by prefixing an  ‘u’  (case-insensitively),
                 as in ‘u-110’; this is not necessary for power-of-two bases (2, 4, 8, 16 and 32), which will be
                 interpreted  as  unsigned  by  default,  but  it  still  makes  a difference regarding overflow
                 detection and overflow constant.  It is possible to enforce signed interpretation by  (instead)
                 prefixing  a  ‘s’  (case-insensitively).  The number sign notation uses a permissive parse mode
                 and as such supports complicated conditions out of the box:

                       ? wysh set ifs=:;read i;unset ifs;echo $i;vexpr pb 2 10#$i
                          -009
                       &lt;   -009&gt;
                       0b1001

                 One integer is expected by assignment (equals sign ‘=’), which does  nothing  but  parsing  the
                 argument,  thus  detecting  validity  and  possible overflow conditions, unary not (tilde ‘~’),
                 which creates the bitwise complement, and unary plus and  minus.   Two  integers  are  used  by
                 addition  (plus  sign  ‘+’),  subtraction  (hyphen-minus  ‘-’),  multiplication (asterisk ‘*’),
                 division (solidus ‘/’) and modulo (percent sign ‘%’), as well  as  for  the  bitwise  operators
                 logical  or  (vertical  bar  ‘|’,  to  be quoted) , bitwise and (ampersand ‘&amp;’, to be quoted) ,
                 bitwise xor (circumflex ‘^’), the bitwise signed left- and right shifts (‘&lt;&lt;’, ‘&gt;&gt;’),  as  well
                 as for the unsigned right shift ‘&gt;&gt;&gt;’.

                 Another  numeric  operation is <b>pbase</b>, which takes a number base in between 2 and 36, inclusive,
                 and will act on the second number given just the same as what equals sign  ‘=’  does,  but  the
                 number  result  will  be formatted in the base given, as a signed 64-bit number unless unsigned
                 interpretation of the input number had been forced (with an u prefix).

                 Numeric operations support a saturated mode via the question  mark  ‘?’  modifier  suffix;  the
                 keyword ‘saturated’ is optional, ‘+?’, ‘+?satu’, and ‘+?saturated’ are therefore identical.  In
                 saturated  mode  overflow errors and division and modulo by zero are no longer reported via the
                 exit status, but the result will linger at the minimum or maximum possible  value,  instead  of
                 overflowing  (or  trapping).   This  is true also for the argument parse step.  For the bitwise
                 shifts, the saturated maximum is 63.  Any caught overflow will be reported via the error number
                 <u>!</u> as <u>^ERR</u>-OVERFLOW.

                       ? vput vexpr res -? +1 -9223372036854775808
                       ? echo $?/$!/$^ERRNAME:$res
                       0/75/OVERFLOW:-9223372036854775808

                 Character set agnostic string functions have no notion of locale settings and character sets.

                 <b>date-utc</b>  Outputs the current date and time in UTC (Coordinated  Universal  Time)  with  values
                           named  such  that  ‘vput  vexpr  x  date-utc;  eval  wysh  set $x’ creates accessible
                           variables.

                 <b>date-stamp-utc</b> Outputs a RFC 3339 internet date/time format of UTC.

                 <b>epoch</b>     The  seconds  and  nanoseconds  since  the  Unix  epoch  (1970-01-01T00:00:00)  named
                           ‘epoch_sec’ and ‘epoch_nsec’ such that ‘vput vexpr x epoch; eval wysh set $x’ creates
                           accessible variables.

                 <b>file-expand</b> Performs the usual “Filename transformations” on its argument.

                 <b>file-stat</b>,  <b>file-lstat</b>  Perform the usual “Filename transformations” on the argument, then call
                           <u><a href="../man2/stat.2.html">stat</a></u>(2) and <u><a href="../man2/lstat.2.html">lstat</a></u>(2), respectively,  and  output  values  such  that  ‘vput  vexpr  x
                           file-stat  FILE;  eval  wysh  set  $x’  creates  accessible  variables.  The variable
                           ‘st_type’ uses solidus ‘/’ to denote directories, commercial at ‘@’ for links, number
                           sign ‘#’ for block devices, percent sign ‘%’ for for character devices, vertical  bar
                           ‘|’ for FIFOs, equal sign ‘=’ for sockets, and the period ‘.’ for the rest.

                 <b>random</b>    Generates  a random string of the given length, or of PATH_MAX bytes (a constant from
                           <u><a href="file:/usr/include">/usr/include</a></u>) if the value 0 is given; the random string will  be  base64url  encoded
                           according to RFC 4648, and thus be usable as a (portable) filename.

                 String  operations  work,  sufficient  support  provided, according to the active user's locale
                 encoding and character set (see “Character sets”).  Where the question mark ‘?’ modifier suffix
                 is supported, a case-insensitive operation mode is available; the keyword ‘case’  is  optional,
                 ‘regex?’ and ‘regex?case’ are therefore identical.

                 <b>makeprint</b> (One-way) Converts the argument to something safely printable on the terminal.

                 <b>regex</b>     [Option]  A  string  operation  that  will  try  to match the first argument with the
                           regular expression given as the second argument.  ‘?’ modifier suffix  is  supported.
                           If  the  optional  third  argument  has  been given then instead of showing the match
                           offset a replacement operation is performed: the third  argument  is  treated  as  if
                           specified  within  dollar-single-quote  (see “Shell-style argument quoting”), and any
                           occurrence of a positional parameter, for example <u>0</u>, <u>1</u>  etc.  is  replaced  with  the
                           according match group of the regular expression:

                                 ? vput vexpr res regex bananarama \
                                     (.*)NanA(.*) '\${1}au\$2'
                                 ? echo $?/$!/$^ERRNAME:$res:
                                 1/61/NODATA::
                                 ? vput vexpr res regex?case bananarama \
                                     (.*)NanA(.*) '\${1}uauf\$2'
                                 ? echo $?/$!/$^ERRNAME:$res:
                                 0/0/NONE:bauauframa:

       <b>vpospar</b>   [Only  new  quoting  rules]  Manage  the  positional parameter stack (see <u>1</u>, <u>#</u>, <u>*</u>, <u>@</u> as well as
                 <b>shift</b>).  If the first argument is ‘clear’, then the positional parameter stack of  the  current
                 context,  or  the global one, if there is none, is cleared.  If it is ‘set’, then the remaining
                 arguments will be used to (re)create the stack, if the parameter stack size limit  is  excessed
                 an <u>^ERR</u>-OVERFLOW error will occur.

                 If  the first argument is ‘quote’, a round-trip capable representation of the stack contents is
                 created, with each quoted parameter separated from each other with the first character of  <u>ifs</u>,
                 and  followed  by  the  first character of <u>if-ws</u>, if that is not empty and not identical to the
                 first.  If that results in no separation at all a <b>space</b> character is used.  This mode  supports
                 <b>vput</b>  (see  “Command  modifiers”).   I.e.,  the  subcommands  ‘set’ and ‘quote’ can be used (in
                 conjunction with <b>eval</b>)  to  (re)create  an  argument  stack  from  and  to  a  single  variable
                 losslessly.

                       ? vpospar set hey, "'you    ", world!
                       ? echo $#: &lt;${1}&gt;&lt;${2}&gt;&lt;${3}&gt;
                       ? vput vpospar x quote
                       ? vpospar clear
                       ? echo $#: &lt;${1}&gt;&lt;${2}&gt;&lt;${3}&gt;
                       ? eval vpospar set ${x}
                       ? echo $#: &lt;${1}&gt;&lt;${2}&gt;&lt;${3}&gt;

       <b>visual</b>    (v)  Takes  a  message  list  and  invokes the VISUAL display editor on each message.  Modified
                 contents are discarded unless the <u>writebackedited</u> variable is set, and are not used unless  the
                 mailbox  can  be  written to and the editor returns a successful exit status.  <b>edit</b> can be used
                 instead for a less display oriented editor.

       <b>write</b>     (w) For conventional messages the body without all headers is written.  The original message is
                 never marked for deletion in  the  originating  mail  folder.   The  output  is  decrypted  and
                 converted  to its native format as necessary.  If the output file exists, the text is appended.
                 If a message is in MIME multipart format its first part is written to the specified file as for
                 conventional messages, handling of the remains depends  on  the  execution  mode.   No  special
                 handling of compressed files is performed.

                 In  interactive  mode the user is consecutively asked for the filenames of the processed parts.
                 For convenience saving of each part may be skipped by giving an empty value, the same result as
                 writing it to <u>/dev/null</u>.  Shell piping the part content by specifying a  leading  vertical  bar
                 ‘|’  character  for  the filename is supported.  Other user input undergoes the usual “Filename
                 transformations”, including shell pathname wildcard  pattern  expansions  (<u><a href="../man7/glob.7.html">glob</a></u>(7))  and  shell
                 variable  expansion  for  the  message  as  such, not the individual parts, and contents of the
                 destination file are overwritten if the file previously existed.  Character set  conversion  to
                 <u>ttycharset</u> is performed when saving text data.

                 [v15  behaviour  may differ] In non-interactive mode any part which does not specify a filename
                 is ignored, and suspicious parts of filenames of the remaining parts are  URL  percent  encoded
                 (as  via  <b>urlcodec</b>)  to  prevent  injection  of  malicious  character sequences, resulting in a
                 filename that will be  written  into  the  current  directory.   Existing  files  will  not  be
                 overwritten,  instead the part number or a dot are appended after a number sign ‘#’ to the name
                 until file creation succeeds (or fails due to other reasons).

       <b>xcall</b>     [Only new quoting rules] The sole difference to <b>call</b> is that the new macro is executed in place
                 of the current one, which will not regain control: all resources of the current macro  will  be
                 released  first.   This  implies  that  any  setting covered by <b>localopts</b> will be forgotten and
                 covered variables will become cleaned up.  If this command is not used  from  within  a  <b>call</b>ed
                 macro it will silently be (a more expensive variant of) <b>call</b>.

       <b>xit</b>       (x) A synonym for <b>exit</b>.

       <b>z</b>         [Only  new  quoting rules] S-nail presents message headers in <u>screen</u>fuls as described under the
                 <b>headers</b> command.  Without arguments this command  scrolls  to  the  next  window  of  messages,
                 likewise  if  the  argument is ‘+’.  An argument of ‘-’ scrolls to the last, ‘^’ scrolls to the
                 first, and ‘$’ to the last <u>screen</u> of messages.  A  number  argument  prefixed  by  ‘+’  or  ‘-’
                 indicates  that  the  window  is  calculated  in relation to the current position, and a number
                 without a prefix specifies an absolute position.

       <b>Z</b>         [Only new quoting rules] Similar to <b>z</b>, but scrolls to the next or previous window that contains
                 at least one ‘new’ or <b>flag</b>ged message.

</pre><h4><b>COMMAND</b> <b>ESCAPES</b></h4><pre>
       Command escapes are available in “Compose mode” during interactive usage, when explicitly  requested  via
       <b>-~</b>,  and  in  batch mode (<b>-#</b>).  They perform special functions, like editing headers of the message being
       composed, calling normal “COMMANDS”, yielding a shell, etc.  Command escapes are only recognized  at  the
       beginning  of  lines,  and  consist  of  an  escape  followed by a command character.  The default <u>escape</u>
       character is the tilde ‘~’.

       Unless otherwise documented command escapes ensure proper updates of the error  number  <u>!</u>  and  the  exit
       status  <u>?</u>.   The variable <u>errexit</u> controls whether a failed operation errors out message compose mode and
       causes program exit.  Escapes may be prefixed by none to multiple  single  character  command  modifiers,
       interspersed whitespace is ignored:

       <b>•</b>   An effect equivalent to the command modifier <b>ignerr</b> can be achieved with hyphen-minus ‘-’, overriding
           <u>errexit</u>.

       <b>•</b>   The  modifier  dollar ‘$’ <b>eval</b>uates the remains of the line; also see “Shell-style argument quoting”.
           [v15 behaviour may differ] For now the entire input line is evaluated  as  a  whole;  to  avoid  that
           control operators like semicolon <b>;</b> are interpreted unintentionally, they must be quoted.

       Addition  of  the  command line to the [Option]al history can be prevented by placing whitespace directly
       after <u>escape</u>.  The [Option]al key <b>bind</b>ings support  a  compose  mode  specific  context.   The  following
       command escapes are supported:

       <b>~~</b> <u>string</u>
                 Insert  the  string  of text in the message prefaced by a single ‘~’.  (If the escape character
                 has been changed, that character must be doubled instead.)

       <b>~!</b> <u>command</u>
                 Execute the indicated shell <u>command</u> which follows, replacing unescaped exclamation  marks  with
                 the  previously  executed  command  if  the  internal  variable <u>bang</u> is set, then return to the
                 message.

       <b>~.</b>        End  compose  mode   and   send   the   message.    The   hooks   <u>on-compose-splice-shell</u>   and
                 <u>on-compose-splice</u>, in order, will be called when set, after which, in interactive mode <u>askatend</u>
                 (leading  to <u>askcc</u>, <u>askbcc</u>) and <u>askattach</u> will be checked as well as <u>asksend</u>, after which a set
                 <u>on-compose-leave</u> hook will be called, <u>autocc</u> and <u>autobcc</u> will be joined in if  set,  finally  a
                 given <u>message-inject-tail</u> will be incorporated, after which the compose mode is left.

       <b>~:</b> <u>S-nail-command</u> or <b>~_</b> <u>S-nail-command</u>
                 Can be used to execute “COMMANDS” (which are allowed in compose mode).

       <b>~&lt;</b> <u>filename</u>
                 Identical to <b>~r</b>.

       <b>~&lt;!</b> <u>command</u>
                 <u>command</u> is executed using the shell.  Its standard output is inserted into the message.

       <b>~?</b>        [Option] Write a summary of command escapes.

       <b>~@</b> [<u>filename...</u>]
                 Append or edit the list of attachments.  Does not manage the error number <u>!</u> and the exit status
                 <u>?</u>  (please  use <b>~^</b> if error handling is necessary).  The append mode expects a list of <u>filename</u>
                 arguments as shell tokens (see “Shell-style  argument  quoting”;  token-separating  commas  are
                 ignored, too), to be interpreted as documented for the command line option <b>-a</b>, with the message
                 number exception as below.

                 Without <u>filename</u> arguments the attachment list is edited, entry by entry; if a filename is left
                 empty, that attachment is deleted from the list; once the end of the list is reached either new
                 attachments  may be entered or the session can be quit by committing an empty “new” attachment.
                 In non-interactive mode or in batch mode (<b>-#</b>) the list of attachments is effectively not edited
                 but instead recreated; again, an empty input ends list creation.

                 For all modes, if a given filename solely consists of the number sign ‘#’ followed by either  a
                 valid  message  number  of  the  currently active mailbox, or by a period ‘.’, referring to the
                 current message of the active mailbox, the so-called “dot”, then the given message is  attached
                 as   a  ‘message/rfc822’  MIME  message  part.   The  number  sign  must  be  quoted  to  avoid
                 misinterpretation as a shell comment character.

       <b>~|</b> <u>command</u>
                 Pipe the message text through the specified filter command.  If the command gives no output  or
                 terminates  abnormally,  retain  the original text of the message.  The command <u><a href="../man1/fmt.1.html">fmt</a></u>(1) is often
                 used as a rejustifying filter.

                 If the first character of the command is a vertical bar,  then  the  entire  message  including
                 header  fields is subject to the filter command, so ‘~|| echo Fcc: /tmp/test; cat’ will prepend
                 a file-carbon-copy message header.  Also see <b>~e</b>, <b>~v</b>.

       <b>~^</b> <u>cmd</u> [<u>subcmd</u> [<u>arg3</u> [<u>arg4</u>]]]
                 Inspect and modify the message using the semantics of <b>digmsg</b>, therefore arguments are evaluated
                 according to “Shell-style argument quoting”.  Error number <u>!</u> and exit status <u>?</u> are not managed:
                 errors are handled via the protocol, and hard errors like I/O failures cannot be handled.

                 The protocol consists of command lines followed by (a) response line(s).  The  first  field  of
                 the  response line represents a status code which specifies whether a command was successful or
                 not, whether result data is to be expected, and if, the format of the  result  data.   Response
                 data  will be shell quoted as necessary for consumption by <b>readsh</b>, or <b>eval</b> and <b>vpospar</b>, to name
                 a few.  Error status code lines may optionally contain additional context:

                 ‘210’     Status ok; the remains of the line are the result.
                 ‘211’     Status ok; the rest of the line is optionally used for more status.  What follows are
                           lines of result addresses, terminated by an empty line.  All the input, including the
                           empty line, must be consumed before further commands can be  issued.   Address  lines
                           consist of two token, first the plain network address, e.g., ‘<a href="mailto:bob@exam.ple">bob@exam.ple</a>’, followed
                           by  the (quoted) full address as known: ‘'(Lovely) Bob &lt;<a href="mailto:bob@exam.ple">bob@exam.ple</a>&gt;'’.  Non-network
                           addresses use the first field to indicate  the  type  (hyphen-minus  ‘-’  for  files,
                           vertical  bar  ‘|’  for pipes, and number sign ‘#’ for names which will undergo <b>alias</b>
                           processing) instead, the actual value will be in the second field.
                 ‘212’     Status ok; the rest of the line is optionally used for more status.  What follows are
                           lines of furtherly unspecified (quoted) string content, terminated by an empty  line.
                           All the input, including the empty line, must be consumed before further commands can
                           be issued.
                 ‘500’     Syntax error; invalid command.
                 ‘501’     Syntax error or otherwise invalid parameters or arguments.
                 ‘505’     Error:  an  argument  fails  verification.   For  example an invalid address has been
                           specified (also see <u>expandaddr</u>), or  an  attempt  was  made  to  modify  anything  in
                           S-nail's  own  namespace,  or  a  modifying  subcommand  has been used on a read-only
                           message.
                 ‘506’     Error: an otherwise valid argument is rendered invalid due to context.  For  example,
                           a second address is added to a header which may consist of a single address only.

                 If  a  command indicates failure then the message will have remained unmodified.  Most commands
                 can fail with ‘500’ if required arguments are missing, or excessive arguments have  been  given
                 (false  command  usage).   ([v15 behaviour may differ] The latter does not yet occur regularly,
                 because as stated in “Shell-style argument quoting” our argument parser is not yet smart enough
                 to work on subcommand base; for example one  might  get  excess  argument  error  for  a  three
                 argument  subcommand that receives four arguments, but not for a four argument subcommand which
                 receives six arguments: here excess will be joined.)  The following (case-insensitive) commands
                 are supported:

                 <b>attachment</b> This command allows listing, removal  and  addition  of  message  attachments.   The
                          second argument specifies the subcommand to apply, one of:

                          <b>attribute</b>  This  uses the same search mechanism as described for <b>remove</b> and prints any
                                    known attributes of the first found attachment via  ‘212’  upon  success  or
                                    ‘501’  if  no  such  attachment can be found.  The attributes are written as
                                    lines with a keyword and a value token.

                          <b>attribute-at</b> This uses the same search mechanism as described  for  <b>remove-at</b>  and  is
                                    otherwise identical to <b>attribute</b>.

                          <b>attribute-set</b>  This  uses  the same search mechanism as described for <b>remove</b>, and will
                                    set the attribute given as the fourth to the value given as the fifth  token
                                    argument.   If  the  value  is  an  empty token, then the given attribute is
                                    removed, or reset to a default  value  if  existence  of  the  attribute  is
                                    crucial.

                                    It  returns  via  ‘210’ upon success, with the index of the found attachment
                                    following, ‘505’ for message attachments or if the given keyword is invalid,
                                    and ‘501’ if no such attachment can be found.  The following keywords may be
                                    used (case-insensitively):

                                    ‘filename’  Sets the filename of the MIME part, i.e., the name that is  used
                                                for display and when (suggesting a name for) saving (purposes).
                                    ‘content-description’   Associate   some   descriptive  information  to  the
                                                attachment's content, used in favour of the  plain  filename  by
                                                some MUAs.
                                    ‘content-id’  May  be used for uniquely identifying MIME entities in several
                                                contexts; this expects a special  reference  address  format  as
                                                defined  in  RFC 2045 and generates a ‘505’ upon address content
                                                verification failure.
                                    ‘content-type’ Defines the media type/subtype of the part, which is  managed
                                                automatically, but can be overwritten.
                                    ‘content-disposition’ Automatically set to the string ‘attachment’.

                          <b>attribute-set-at</b> This uses the same search mechanism as described for <b>remove-at</b> and is
                                    otherwise identical to <b>attribute-set</b>.

                          <b>insert</b>    Adds  the  attachment  given  as  the  third  argument, specified exactly as
                                    documented for the command line option <b>-a</b>, and supporting the message number
                                    extension as documented for <b>~@</b>.  This reports ‘210’ upon success,  with  the
                                    index  of  the  new  attachment following, ‘505’ if the given file cannot be
                                    opened, ‘506’ if an on-the-fly performed  character  set  conversion  fails,
                                    otherwise  ‘501’  is  reported;  this  is  also  reported  if  character set
                                    conversion is requested but not available.

                          <b>list</b>      List all attachments via ‘212’, or report ‘501’  if  no  attachments  exist.
                                    This  command is the default command of <b>attachment</b> if no second argument has
                                    been given.

                          <b>remove</b>    This will remove the attachment given as  the  third  argument,  and  report
                                    ‘210’  upon  success  or ‘501’ if no such attachment can be found.  If there
                                    exists any path component in the given argument, then an exact match of  the
                                    path  which  has been used to create the attachment is used directly, but if
                                    only the basename of that path matches then all attachments are traversed to
                                    find an exact match first, and the removal occurs  afterwards;  if  multiple
                                    basenames  match,  a ‘506’ error occurs.  Message attachments are treated as
                                    absolute pathnames.

                                    If no path component exists in the given argument, then all attachments will
                                    be searched for ‘filename=’ parameter matches as well as for matches of  the
                                    basename  of  the  path  which  has  been  used when the attachment has been
                                    created; multiple matches result in a ‘506’.

                          <b>remove-at</b> This will interpret the third argument as a number and remove the attachment
                                    at that list position (counting from one!), reporting ‘210’ upon success  or
                                    ‘505’ if the argument is not a number or ‘501’ if no such attachment exists.

                 <b>header</b>   This  command allows listing, inspection, and editing of message headers.  Header name
                          case is not normalized, so  that  case-insensitive  comparison  should  be  used  when
                          matching names.  The second argument specifies the subcommand to apply, one of:

                          <b>insert</b>    Create  a  new  or  an  additional instance of the header given in the third
                                    argument, with the header body content as given in the fourth token.  It may
                                    return ‘501’ if the third argument specifies a free-form header  field  name
                                    that  is  invalid,  or if body content extraction fails to succeed, ‘505’ if
                                    any extracted address does not pass syntax  and/or  security  checks  or  on
                                    S-nail namespace violations, and ‘506’ to indicate prevention of excessing a
                                    single-instance  header  —  note that ‘Subject:’ can be appended to (a space
                                    separator will be added  automatically  first).   ‘To:’,  ‘Cc:’  and  ‘Bcc:’
                                    support  the  ‘?single’ modifier to enforce treatment as a single addressee,
                                    for example ‘header insert To?single: 'exa, &lt;m@ple&gt;'’; the word ‘single’  is
                                    optional.

                                    ‘210’  is  returned upon success, followed by the name of the header and the
                                    list position of the newly inserted instance.  The list position is always 1
                                    for single-instance header fields.  All free-form header fields are  managed
                                    in a single list; also see <u>customhdr</u>.

                          <b>list</b>      Without  a  third  argument  a list of all yet existing headers is given via
                                    ‘210’; this command is the default command of <b>header</b> if no  second  argument
                                    has been given.  A third argument restricts output to the given header only,
                                    which may fail with ‘501’ if no such field is defined.

                          <b>remove</b>    This  will  remove  all instances of the header given as the third argument,
                                    reporting ‘210’ upon success, ‘501’ if no such  header  can  be  found,  and
                                    ‘505’ on S-nail namespace violations.

                          <b>remove-at</b> This will remove from the header given as the third argument the instance at
                                    the  list  position  (counting  from  one!)  given with the fourth argument,
                                    reporting ‘210’ upon success or ‘505’ if the list position argument is not a
                                    number or on S-nail namespace  violations,  and  ‘501’  if  no  such  header
                                    instance exists.

                          <b>show</b>      Shows  the  content of the header given as the third argument.  Dependent on
                                    the header type this may respond with ‘211’ or ‘212’; any failure results in
                                    ‘501’.

                          In compose-mode read-only access to optional pseudo  headers  in  the  S-nail  private
                          namespace is available:

                          ‘Mailx-Command:’
                                    The  name  of  the  command  that  generates  the message, one of ‘forward’,
                                    ‘Lreply’, ‘mail’, ‘Reply’, ‘reply’, ‘resend’.   This  pseudo  header  always
                                    exists (in compose-mode).
                          ‘Mailx-Raw-To:’
                          ‘Mailx-Raw-Cc:’
                          ‘Mailx-Raw-Bcc:’
                                    Represent   the   frozen   initial   state   of  these  headers  before  any
                                    transformation (<b>alias</b>, <b>alternates</b>, <u>recipients-in-cc</u> etc.) took place.
                          ‘Mailx-Orig-Sender:’
                          ‘Mailx-Orig-From:’
                          ‘Mailx-Orig-To:’
                          ‘Mailx-Orig-Cc:’
                          ‘Mailx-Orig-Bcc:’
                                    The values of said headers of the original message which has been  addressed
                                    by  any  of  <b>reply</b>,  <b>forward</b>,  <b>resend</b>.  The sender field is special as it is
                                    filled in with the sole sender according to RFC 5322 rules, it may  thus  be
                                    equal to the from field.

                 <b>help</b>, <b>?</b>  Show an abstract of the above commands via ‘211’.

                 <b>version</b>  This command will print the protocol version via ‘210’.

       <b>~A</b>        The same as ‘<b>~i</b> <u>Sign</u>’.

       <b>~a</b>        The same as ‘<b>~i</b> <u>sign</u>’.

       <b>~b</b> <u>name</u> <u>...</u>
                 Add the given names to the list of blind carbon copy recipients.

       <b>~c</b> <u>name</u> <u>...</u>
                 Add the given names to the list of carbon copy recipients.

       <b>~d</b>        Read the file specified by the DEAD variable into the message.

       <b>~e</b>        Invoke the text EDITOR on the message collected so far, then return to compose mode.  <b>~v</b> can be
                 used for a more display oriented editor, and <b>~|</b>| offers a pipe-based editing approach.

       <b>~F</b> <u>messages</u>
                 Read  the  named  messages  into the message being sent, including all message headers and MIME
                 parts, and honouring <u>forward-add-cc</u> as well as <u>forward-inject-head</u> and <u>forward-inject-tail</u>.  If
                 no messages are specified, read in the current message, the “dot”.

       <b>~f</b> <u>messages</u>
                 Read the named messages into the message being sent.  If no messages are specified, read in the
                 current message, the “dot”.  Strips down the list of header fields according to  the  ‘forward’
                 (with  <u>posix</u>:  ‘type’) white- and blacklist selection of <b>headerpick</b>, and honours <u>forward-add-cc</u>
                 as well as <u>forward-inject-head</u> and <u>forward-inject-tail</u>.  For MIME multipart messages, only  the
                 first displayable part is included.

       <b>~H</b>        In  interactive  mode,  edit  the  message  header fields ‘From:’, ‘Reply-To:’ and ‘Sender:’ by
                 typing each one in turn and allowing the user to edit the field.  The default values for  these
                 fields  originate  from  the <u>from</u>, <u>reply-to</u> and <u>sender</u> variables.  In non-interactive mode this
                 sets <u>^ERR</u>-NOTTY.

       <b>~h</b>        In interactive mode, edit the message header fields ‘To:’,  ‘Cc:’,  ‘Bcc:’  and  ‘Subject:’  by
                 typing  each one in turn and allowing the user to edit the field.  In non-interactive mode this
                 sets <u>^ERR</u>-NOTTY.

       <b>~I</b> <u>variable</u>
                 Insert the value of the specified variable into the message.  The message remains unaltered  if
                 the variable is unset or empty.  Any embedded character sequences ‘\t’ horizontal tabulator and
                 ‘\n’  line  feed  are  expanded in <u>posix</u> mode; otherwise the expansion should occur at <b>set</b> time
                 ([v15 behaviour may differ] by using the command modifier <u>wysh</u>).

       <b>~i</b> <u>variable</u>
                 Like <b>~I</b>, but appends a newline character.

       <b>~M</b> <u>messages</u>
                 Read the named messages into the message being sent, indented by <u>indentprefix</u>.  If no  messages
                 are  specified,  read  the  current  message,  the  “dot”.   Honours  <u>forward-add-cc</u> as well as
                 <u>forward-inject-head</u> and <u>forward-inject-tail</u>.

       <b>~m</b> <u>messages</u>
                 Read the named messages into the message being sent, indented by <u>indentprefix</u>.  If no  messages
                 are  specified,  read  the  current  message, the “dot”.  Strips down the list of header fields
                 according to the ‘type’ white- and blacklist selection of <b>headerpick</b>.   Honours  <u>forward-add-cc</u>
                 as  well as <u>forward-inject-head</u> and <u>forward-inject-tail</u>.  For MIME multipart messages, only the
                 first displayable part is included.

       <b>~p</b>        Display the message collected so far, prefaced by the message header fields and followed by the
                 attachment list, if any.

       <b>~Q</b>        Read in the given / current message(s) using the algorithm of <u>quote</u> (except that is  implicitly
                 assumed, even if not set), honouring <u>quote-add-cc</u>.

       <b>~q</b>        Abort  the message being sent, copying it to the file specified by the DEAD variable if <u>save</u> is
                 set.

       <b>~R</b> <u>filename</u>
                 Identical to <b>~r</b>, but indent each line that has been read by <u>indentprefix</u>.

       <b>~r</b> <u>filename</u> [<u>HERE-delimiter</u>]
                 Read the named file, object to “Filename transformations” excluding shell  globs  and  variable
                 expansions,  into  the message; if <u>filename</u> is the hyphen-minus ‘-’ then standard input is used
                 (for pasting, for example).  Only in this latter mode <u>HERE-delimiter</u> may be  given:  if  it  is
                 data  will  be  read  in  until  the  given  <u>HERE-delimiter</u>  is  seen  on a line by itself, and
                 encountering EOF is an error; the <u>HERE-delimiter</u> is  a  required  argument  in  non-interactive
                 mode; if it is single-quote quoted then the pasted content will not be expanded, [v15 behaviour
                 may  differ]  otherwise  a  future  version  of S-nail may perform shell-style expansion on the
                 content.

       <b>~s</b> <u>string</u>
                 Cause the named string to become the current subject field.  Newline (NL)  and  carriage-return
                 (CR) bytes are invalid and will be normalized to space (SP) characters.

       <b>~t</b> <u>name</u> <u>...</u>
                 Add the given name(s) to the direct recipient list.

       <b>~U</b> <u>messages</u>
                 Read  in  the  given  /  current  message(s)  excluding  all headers, indented by <u>indentprefix</u>.
                 Honours <u>forward-add-cc</u> as well as <u>forward-inject-head</u> and <u>forward-inject-tail</u>.

       <b>~u</b> <u>messages</u>
                 Read in the given / current message(s), excluding all headers.  Honours <u>forward-add-cc</u> as  well
                 as <u>forward-inject-head</u> and <u>forward-inject-tail</u>.

       <b>~v</b>        Invoke  the VISUAL editor on the message collected so far, then return to compose mode.  <b>~e</b> can
                 be used for a less display oriented editor, and <b>~|</b>| offers a pipe-based editing approach.

       <b>~w</b> <u>filename</u>
                 Write the message onto the named file, which is object to the usual “Filename transformations”.
                 If the file exists, the message is appended to it.

       <b>~x</b>        Same as <b>~q</b>, except that the message is not saved at all.

</pre><h4><b>INTERNAL</b> <b>VARIABLES</b></h4><pre>
       Internal S-nail variables are controlled via the <b>set</b> and <b>unset</b> commands; prefixing a variable  name  with
       the  string  ‘no’  and calling <b>set</b> has the same effect as using <b>unset</b>: ‘unset crt’ and ‘set nocrt’ do the
       same thing.  <b>varshow</b> will give more insight on the  given  variable(s),  and  <b>set</b>,  when  called  without
       arguments,  will  show  a  listing  of all variables.  Both commands support a more <u>verbose</u> listing mode.
       Some well-known variables will also become inherited from the program  “ENVIRONMENT”  implicitly,  others
       can be imported explicitly with the command <b>environ</b> and henceforth share said properties.

       Two  different  kinds  of  internal  variables  exist, and both of which can also form chains.  There are
       boolean variables, which can only be in one of the two states “set” and “unset”, and value variables with
       a(n optional) string value.  For the latter  proper  quoting  is  necessary  upon  assignment  time,  the
       introduction of the section “COMMANDS” documents the supported quoting rules.

             ? wysh set one=val\ 1 two="val 2" \
                 three='val "3"' four=$'val \'4\''; \
                 varshow one two three four; \
                 unset one two three four

       Dependent  upon  the  actual  option  string  values  may  become  interpreted  as  colour names, command
       specifications, normal text, etc.  They may be treated as numbers,  in  which  case  decimal  values  are
       expected  if so documented, but otherwise any numeric format and base that is valid and understood by the
       <b>vexpr</b> command may be used, too.

       There also exists a special kind of string value, the “boolean string”, which must either  be  a  decimal
       integer (in which case ‘0’ is false and ‘1’ and any other value is true) or any of the (case-insensitive)
       strings  ‘off’,  ‘no’,  ‘n’  and  ‘false’  for a false boolean and ‘on’, ‘yes’, ‘y’ and ‘true’ for a true
       boolean; a special kind of boolean string is the “quadoption”: it can optionally  be  prefixed  with  the
       (case-insensitive) term ‘ask-’, as in ‘ask-yes’; in interactive mode the user will be prompted, otherwise
       the actual boolean is used.

       Variable  chains  extend a plain ‘variable’ with ‘variable-HOST’ and ‘variable-USER@HOST’ variants.  Here
       ‘HOST’ will be converted to all lowercase when looked up (but not when the variable is  set  or  unset!),
       [Option]ally  IDNA  converted,  and  indeed  means  ‘server:port’  if  a ‘port’ had been specified in the
       contextual Uniform Resource Locator URL, see “On URL syntax and credential  lookup”.   Even  though  this
       mechanism  is  based  on  URLs  no  URL  percent encoding may be applied to neither of ‘USER’ nor ‘HOST’,
       variable chains need to be specified using raw data; the mentioned section contains examples.   Variables
       which  support  chains  are  explicitly  documented  as such, and S-nail treats the base name of any such
       variable special, meaning that users should not create custom names like ‘variable-xyz’ in order to avoid
       false classifications and treatment of such variables.

   <b>Initial</b> <b>settings</b>
       The standard POSIX 2008/Cor 2-2016 mandates the following initial variable settings: no<u>allnet</u>,  no<u>append</u>,
       <u>asksub</u>,  no<u>askbcc</u>,  no<u>autoprint</u>,  no<u>bang</u>,  no<u>cmd</u>,  no<u>crt</u>,  no<u>debug</u>,  no<u>dot</u>,  <u>escape</u>  set to ‘~’, no<u>flipr</u>,
       no<u>folder</u>, <u>header</u>, no<u>hold</u>, no<u>ignore</u>, no<u>ignoreeof</u>, no<u>keep</u>, no<u>keepsave</u>, no<u>metoo</u>, no<u>outfolder</u>, no<u>page</u>, <u>prompt</u>
       set to ‘? ’, no<u>quiet</u>, no<u>record</u>, <u>save</u>, no<u>sendwait</u>, no<u>showto</u>, no<u>Sign</u>, no<u>sign</u>, <u>toplines</u> set to ‘5’.

       However, S-nail has built-in some initial (and some default) settings which  (may)  diverge,  others  may
       become adjusted by one of the “Resource files”.  Displaying the former is accomplished via <b>set</b>: ‘$ s-nail
       -:/  -v  -Xset -Xx’.  In general this implementation sets (and has extended the meaning of) <u>sendwait</u>, and
       does not support the no<u>onehop</u> variable – use command  line  options  or  <u>mta-arguments</u>  to  pass  options
       through  to  a  <u>mta</u>.   The  default global resource file sets, among others, the variables <u>hold</u>, <u>keep</u> and
       <u>keepsave</u>, establishes a default <b>headerpick</b> selection etc., and should thus be taken into account.

   <b>Variables</b>
       <u>?</u>         (Read-only) The exit status of the last command, or the <b>return</b> value of the macro <b>call</b>ed  last.
                 This  status  has  a  meaning  in the state machine: in conjunction with <u>errexit</u> any non-0 exit
                 status will cause a program exit, and in <u>posix</u> mode  any  error  while  loading  (any  of  the)
                 resource  files will have the same effect.  <b>ignerr</b>, one of the “Command modifiers”, can be used
                 to instruct the state machine to ignore errors.

       <u>!</u>         (Read-only) The current error number (<u><a href="../man3/errno.3.html">errno</a></u>(3)), which is set after an error  occurred;  it  is
                 also  available  via  <u>^ERR</u>,  and  the  error  name  and documentation string can be queried via
                 <u>^ERRNAME</u> and <u>^ERRDOC</u>.  [v15 behaviour may differ] This machinery is new and the error number is
                 only really usable if a command explicitly states that it manages the variable  <u>!</u>,  for  others
                 errno  will  be  used  in  case  of  errors, or <u>^ERR</u>-INVAL if that is 0: it thus may or may not
                 reflect the real error.  The error number may be set with the command <b>return</b>.

       <u>^</u>         (Read-only) This is a multiplexer variable which performs dynamic expansion  of  the  requested
                 state or condition, of which there are:

                 <u>^ERR</u>, <u>^ERRDOC</u>, <u>^ERRNAME</u>
                           The  number,  documentation, and name of the current <u><a href="../man3/errno.3.html">errno</a></u>(3), respectively, which is
                           usually set after an error occurred.  The documentation is an [Option], the  name  is
                           used  if  not  available.   [v15  behaviour  may differ] This machinery is new and is
                           usually reliable only if a command explicitly states that it manages the variable  <u>!</u>,
                           which is effectively identical to <u>^ERR</u>.  Each of those variables can be suffixed with
                           a  hyphen  minus  followed by a name or number, in which case the expansion refers to
                           the given error.  Note this is a direct mapping of (a subset  of)  the  system  error
                           values:

                                 define work {
                                   eval echo \$1: \$^ERR-$1:\
                                     \$^ERRNAME-$1: \$^ERRDOC-$1
                                   vput vexpr i + "$1" 1
                                   if [ $i -lt 16 ]
                                     \xcall work $i
                                   end
                                 }
                                 call work 0

                 <u>^ERRQUEUE-COUNT</u>, <u>^ERRQUEUE-EXISTS</u>
                           The  number  of  messages  in the [Option]al queue of <b>errors</b>, and a string indicating
                           queue state:  empty  or  (translated)  “ERROR”.   Always  0  and  the  empty  string,
                           respectively, unless <u>features</u> includes ‘,+errors,’.

       <u>*</u>         (Read-only)  Expands all positional parameters (see <u>1</u>), separated by the first character of the
                 value of <u>ifs</u>.  [v15 behaviour may differ] The special semantics of the  equally  named  special
                 parameter of the <u><a href="../man1/sh.1.html">sh</a></u>(1) are not yet supported.

       <u>@</u>         (Read-only)  Expands  all  positional  parameters  (see <u>1</u>), separated by a space character.  If
                 placed in double quotation marks, each positional parameter is properly quoted to expand  to  a
                 single parameter again.

       <u>#</u>         (Read-only)  Expands  to  the number of positional parameters, i.e., the size of the positional
                 parameter stack in decimal.

       <u>0</u>         (Read-only) Inside the scope of a <b>define</b>d and <b>call</b>ed macro this expands  to  the  name  of  the
                 calling  macro,  or  to  the  empty  string  if  the  macro is running from top-level.  For the
                 [Option]al regular expression search and replace operator of <b>vexpr</b> this expands to  the  entire
                 matching expression.  It represents the program name in global context.

       <u>1</u>         (Read-only)  Access  of the positional parameter stack.  All further parameters can be accessed
                 with this syntax, too, ‘2’, ‘3’ etc.; positional parameters can be shifted  off  the  stack  by
                 calling  <b>shift</b>.   The  parameter stack contains, for example, the arguments of a <b>call</b>ed <b>define</b>d
                 macro, the matching groups of the [Option]al regular expression search and  replace  expression
                 of <b>vexpr</b>, and can be explicitly created or overwritten with the command <b>vpospar</b>.

       <u>account</u>   (Read-only) Is set to the active <b>account</b>.

       <u>add-file-recipients</u>
                 (Boolean)  When  file or pipe recipients have been specified, mention them in the corresponding
                 address fields of the message instead of silently stripping them from their recipient list.  By
                 default such addressees are not mentioned.

       <u>allnet</u>    (Boolean) Causes only the local part to be evaluated when comparing addresses.

       <u>append</u>    (Boolean) Causes messages saved in the “secondary mailbox” MBOX  to  be  appended  to  the  end
                 rather than prepended.  This should always be set.

       <u>askatend</u>  (Boolean)  Causes  the  prompts for ‘Cc:’ and ‘Bcc:’ lists to appear after the message has been
                 edited.

       <u>askattach</u>
                 (Boolean) If set, S-nail asks an interactive user for files  to  attach  at  the  end  of  each
                 message; An empty line finalizes the list.

       <u>askcc</u>     (Boolean)  Causes the interactive user to be prompted for carbon copy recipients (at the end of
                 each message if <u>askatend</u> or <u>bsdcompat</u> are set).

       <u>askbcc</u>    (Boolean) Causes the interactive user to be prompted for blind carbon copy recipients  (at  the
                 end of each message if <u>askatend</u> or <u>bsdcompat</u> are set).

       <u>asksend</u>   (Boolean)  Causes  the  interactive user to be prompted for confirmation to send the message or
                 reenter compose mode after having been shown a preliminary envelope summary.

       <u>asksign</u>   (Boolean)[Option] Causes the interactive user to be prompted if the message is to be signed  at
                 the end of each message.  The <u>smime-sign</u> variable is ignored when this variable is set.

       <u>asksub</u>    (Boolean)  Causes  S-nail  to prompt the interactive user for the subject upon entering compose
                 mode unless a subject already exists.

       <u>attrlist</u>  A sequence of characters to display in the ‘attribute’ column of the <u>headline</u> as shown  in  the
                 display  of  <b>headers</b>;  each  for  one type of messages (see “Message states”), with the default
                 being ‘NUROSPMFAT+-$~’ or ‘NU  *HMFAT+-$~’ if the <u>bsdflags</u> variable is set,  in  the  following
                 order:

                 ‘N’       new.
                 ‘U’       unread but old.
                 ‘R’       new but read.
                 ‘O’       read and old.
                 ‘S’       saved.
                 ‘P’       preserved.
                 ‘M’       mboxed.
                 ‘F’       flagged.
                 ‘A’       answered.
                 ‘T’       draft.
                 ‘+’       [v15  behaviour  may  differ]  start  of  a  (collapsed) thread in threaded mode (see
                           <u>autosort</u>, <b>thread</b>);
                 ‘-’       [v15 behaviour may differ] an uncollapsed thread  in  threaded  mode;  only  used  in
                           conjunction with <b>-L</b>.
                 ‘$’       classified as spam.
                 ‘~’       classified as possible spam.

       <u>autobcc</u>   Specifies  a  list  of recipients to which a blind carbon copy of each outgoing message will be
                 sent automatically.

       <u>autocc</u>    Specifies a list of recipients to which a carbon copy of each outgoing  message  will  be  sent
                 automatically.

       <u>autocollapse</u>
                 (Boolean)  Causes  threads  to  be  collapsed  automatically when .Ql thread Ns ed <b>sort</b> mode is
                 entered (see the <b>collapse</b> command).

       <u>autoprint</u>
                 (Boolean) Enable automatic <b>type</b>ing of a(n  existing)  “successive”  message  after  <b>delete</b>  and
                 <b>undelete</b>  commands: the message that becomes the new “dot” is shown automatically, as via <b>dp</b> or
                 <b>dt</b>.

       <u>autosort</u>  Causes sorted mode (see the <b>sort</b> command) to be entered automatically with the  value  of  this
                 variable as sorting method when a folder is opened, for example ‘set autosort=thread’.

       <u>bang</u>      (Boolean)  Enables  the  substitution of all not (reverse-solidus) escaped exclamation mark ‘!’
                 characters by the contents of the last executed command for the <b>!</b> shell escape command and  <b>~!</b>,
                 one  of  the  compose  mode  “COMMAND ESCAPES”.  If this variable is not set no reverse solidus
                 stripping is performed.

       <u>bind-timeout</u>
                 [Obsolete] Predecessor of <u>bind-inter-byte-timeout</u>.  [v15 behaviour  may  differ]  Setting  this
                 automatically sets the successor.

       <u>bind-inter-byte-timeout</u>
                 [Option]  Terminals  may  generate multi-byte sequences for special function keys, for example,
                 but these sequences may not become read as a unit.  And multi-byte  sequences  can  be  defined
                 freely  via  <b>bind</b>.   This  variable specifies the timeout in milliseconds that the MLE (see “On
                 terminal control and line editor”) waits for  more  bytes  to  arrive  unless  it  considers  a
                 sequence  “complete”.   The  default is 200, the maximum is about 10 seconds.  In the following
                 example the comments state which sequences are affected by this timeout:

                       ? bind base abc echo 0 # abc
                       ? bind base ab,c echo 1 # ab
                       ? bind base abc,d echo 2 # abc
                       ? bind base ac,d echo 3 # ac
                       ? bind base a,b,c echo 4
                       ? bind base a,b,c,d echo 5
                       ? bind base a,b,cc,dd echo 6 # cc and dd

       <u>bind-inter-key-timeout</u>
                 [Option] Multi-key <b>bind</b> sequences do not time out by default.  If this variable  is  set,  then
                 the  current key sequence is forcefully terminated once the timeout (in milliseconds) triggers.
                 The value should be (maybe significantly) larger  than  <u>bind-inter-byte-timeout</u>,  but  may  not
                 excess the maximum, too.

       <u>bsdcompat</u>
                 (Boolean)  Sets  some  cosmetical  features  to  traditional  BSD style; has the same affect as
                 setting <u>askatend</u> and all other variables prefixed with ‘bsd’; it also changes the behaviour  of
                 <u>emptystart</u> (which does not exist in BSD).

       <u>bsdflags</u>  (Boolean)  Changes the letters shown in the first column of a header summary to traditional BSD
                 style.

       <u>bsdheadline</u>
                 (Boolean) Changes the display of columns in a header summary to traditional BSD style.

       <u>bsdmsgs</u>   (Boolean) Changes some informational messages to traditional BSD style.

       <u>bsdorder</u>  (Boolean) Causes the ‘Subject:’ field to appear immediately after the ‘To:’  field  in  message
                 headers and with the <b>~h</b> “COMMAND ESCAPES”.

       <u>build-cc</u>, <u>build-ld</u>, <u>build-os</u>, <u>build-rest</u>
                 (Read-only)  The  build  environment,  including the compiler, the linker, the operating system
                 S-nail has been build for, usually taken from <u><a href="../man1/uname.1.html">uname</a></u>(1) via ‘uname -s’, and then lowercased,  as
                 well  as  all  the  possibly interesting rest of the configuration and build environment.  This
                 information is also available in the <u>verbose</u> output of the command <b>version</b>.

       <u>charset-7bit</u>
                 The value that should appear in the ‘charset=’ parameter of ‘Content-Type:’ MIME header  fields
                 when no character set conversion of the message data was performed.  This defaults to US-ASCII,
                 and the chosen character set should be US-ASCII compatible.

       <u>charset-8bit</u>
                 [Option]  The  default  8-bit  character  set  that  is  used as an implicit last member of the
                 variable <u>sendcharsets</u>.  This defaults to UTF-8 if character  set  conversion  capabilities  are
                 available,  and  to  ISO-8859-1  otherwise (unless the operating system environment is known to
                 always and exclusively support UTF-8 locales), in which case the only supported  character  set
                 is <u>ttycharset</u> and this variable is effectively ignored.

       <u>charset-unknown-8bit</u>
                 [Option]  RFC 1428 specifies conditions when internet mail gateways shall “upgrade” the content
                 of a mail message by using a character set  with  the  name  ‘unknown-8bit’.   Because  of  the
                 unclassified  nature of this character set S-nail will not be capable to convert this character
                 set to any other character set.  If this variable is  set  any  message  part  which  uses  the
                 character  set  ‘unknown-8bit’ is assumed to really be in the character set given in the value,
                 otherwise the (final) value of <u>charset-8bit</u> is used for this purpose.

                 This variable will also be taken into account if a MIME type (see “The mime.types files”) of  a
                 MIME message part that uses the ‘binary’ character set is forcefully treated as text.

       <u>cmd</u>       The default value for the <b>pipe</b> command.

       <u>colour-disable</u>
                 (Boolean)[Option]  Forcefully  disable  usage  of  colours.   Also  see  the  section “Coloured
                 display”.

       <u>colour-pager</u>
                 (Boolean)[Option] Whether colour shall be used for output that is paged  through  PAGER.   Note
                 that  pagers  may need special command line options, for example <u><a href="../man1/less.1.html">less</a></u>(1) requires the option <b>-R</b>
                 and <u><a href="../man1/lv.1.html">lv</a></u>(1) the option <b>-c</b> in order  to  support  colours.   Often  doing  manual  adjustments  is
                 unnecessary  since  S-nail  may  perform  adjustments dependent on the value of the environment
                 variable PAGER (see there for more).

       <u>contact-mail</u>, <u>contact-web</u>
                 (Read-only)  Addresses  for  contact  per  email  and  web,  respectively,  for  bug   reports,
                 suggestions,  or anything else regarding S-nail.  The former can be used directly: ‘? <b>eval</b> <b>mail</b>
                 $contact-mail’.

       <u>content-description-forwarded-message</u>,                              <u>content-description-quote-attachment</u>,
                 <u>content-description-smime-message</u>, <u>content-description-smime-signature</u>
                 [Option](partially) Strings which will be placed in according ‘Content-Description:’ headers if
                 non-empty.  They all have default values, for example ‘Forwarded message’.

       <u>crt</u>       In  a(n interactive) terminal session, then if this valued variable is set it will be used as a
                 threshold to determine how many lines the given output has to span before it will be  displayed
                 via  the  configured  PAGER; Usage of the PAGER can be forced by setting this to the value ‘0’,
                 setting it without a value will deduce the current height of the terminal screen to compute the
                 threshold (see LINES, <u>screen</u> and <u><a href="../man1/stty.1.html">stty</a></u>(1)).  [v15 behaviour may differ] At the moment this  uses
                 the  count of lines of the message in wire format, which, dependent on the <u>mime-encoding</u> of the
                 message, is unrelated to the number of display lines.  (The software is  old  and  historically
                 the relation was a given thing.)

       <u>customhdr</u>
                 Define  a  set  of  custom headers to be injected into newly composed or forwarded messages.  A
                 custom header consists of the field name followed by a colon ‘:’ and the  field  content  body.
                 Standard  header  field  names  cannot be overwritten by a custom header, with the exception of
                 ‘Comments:’ and ‘Keywords:’.  Different to the command line option <b>-C</b>  the  variable  value  is
                 interpreted  as  a  comma-separated  list of custom headers: to include commas in header bodies
                 they need to become escaped with reverse solidus ‘\’.  Headers can be managed  more  freely  in
                 “Compose mode” via <b>~^</b>.

                       ? <b>set</b> <b>customhdr='Hdr1:</b> <b>Body1-1\,</b> <b>Body1-2,</b> <b>Hdr2:</b> <b>Body2'</b>

       <u>datefield</u>
                 Controls  the  appearance  of  the  ‘%d’  date  and  time  format specification of the <u>headline</u>
                 variable, that is used, for example, when viewing the summary of <b>headers</b>.  If unset,  then  the
                 local  receiving date is used and displayed unformatted, otherwise the message sending ‘Date:’.
                 It is possible to assign a <u><a href="../man3/strftime.3.html">strftime</a></u>(3) format string  and  control  formatting,  but  embedding
                 newlines  via the ‘%n’ format is not supported, and will result in display errors.  The default
                 is ‘%Y-%m-%d %H:%M’, and also see <u>datefield-markout-older</u>.

       <u>datefield-markout-older</u>
                 Only used in conjunction with <u>datefield</u>.  Can be  used  to  create  a  visible  distinction  of
                 messages dated more than a day in the future, or older than six months, a concept comparable to
                 the  <b>-l</b>  option  of the POSIX utility <u><a href="../man1/ls.1.html">ls</a></u>(1).  If set to the empty string, then the plain month,
                 day and year of the ‘Date:’ will be displayed, but  a  <u><a href="../man3/strftime.3.html">strftime</a></u>(3)  format  string  to  control
                 formatting can be assigned.  The default is ‘%Y-%m-%d’.

       <u>debug</u>     (Boolean)  (Almost) Enter a debug-only sandbox mode which generates many log messages, disables
                 the actual delivery of messages, and also  implies  no<u>record</u>  as  well  as  no<u>save</u>.   Also  see
                 <u>verbose</u>.

       <u>disposition-notification-send</u>
                 (Boolean)[Option]  Emit  a  ‘Disposition-Notification-To:’  header (RFC 3798) with the message.
                 This requires the <u>from</u> variable to be set.

       <u>dot</u>       (Boolean) When dot is set,  a  period  ‘.’  on  a  line  by  itself  during  message  input  in
                 (interactive  or batch <b>-#</b>) “Compose mode” will be treated as end-of-message (in addition to the
                 normal end-of-file condition).  This behaviour is implied in <u>posix</u> mode with a set <u>ignoreeof</u>.

       <u>dotlock-disable</u>
                 (Boolean)[Option] Disable creation of “dotlock files” for MBOX databases.

       <u>dotlock-ignore-error</u>
                 [Obsolete](Boolean)[Option]  Ignore  failures  when  creating  “dotlock  files”.   Please   use
                 <u>dotlock-disable</u> instead.

       <u>editalong</u>
                 If  this variable is set then the editor is started automatically when a message is composed in
                 interactive mode.  If the value starts with the letter ‘v’ then this acts as if  <b>~v</b>,  otherwise
                 as  if  <b>~e</b> (see “COMMAND ESCAPES”) had been specified.  The <u>editheaders</u> variable is implied for
                 this automatically spawned editor session.

       <u>editheaders</u>
                 (Boolean) When a message is edited while being composed, its header is included in the editable
                 text.

       <u>emptystart</u>
                 (Boolean) When entering interactive mode S-nail normally writes “No mail for  user”  and  exits
                 immediately  if  a  mailbox  is empty or does not exist.  If this variable is set S-nail starts
                 even with an empty or  non-existent  mailbox  (the  latter  behaviour  furtherly  depends  upon
                 <u>bsdcompat</u>, though).

       <u>errexit</u>   (Boolean) Let each command with a non-0 exit status, including every <b>call</b>ed macro which <b>return</b>s
                 a non-0 status, cause a program exit unless prefixed by <b>ignerr</b> (see “Command modifiers”).  This
                 also  affects  “COMMAND  ESCAPES”,  but  which use a different modifier for ignoring the error.
                 Please refer to the variable <u>?</u> for more on this topic.

       <u>errors-limit</u>
                 [Option] Maximum number of entries in the <b>errors</b> queue.

       <u>escape</u>    The first character of this value  defines  the  escape  character  for  “COMMAND  ESCAPES”  in
                 “Compose  mode”.   The  default  value is the character tilde ‘~’.  If set to the empty string,
                 command escapes are disabled.

       <u>expandaddr</u>
                 If unset only user name and email address recipients are allowed “On  sending  mail,  and  non-
                 interactive  mode”.   If  set  without  value all possible recipient types will be accepted.  A
                 value is parsed as a comma-separated list of case-insensitive strings,  and  if  that  contains
                 ‘restrict’  behaviour equals the former except when in interactive mode or if “COMMAND ESCAPES”
                 were enabled via <b>-~</b> or <b>-#</b>, in which case it equals the  latter,  allowing  all  address  types.
                 ‘restrict’  really  acts  like ‘restrict,-all,+name,+addr’, so care for ordering issues must be
                 taken.

                 Recipient types can be added and removed with a plus  sign  ‘+’  or  hyphen-minus  ‘-’  prefix,
                 respectively.   By  default  invalid  or disallowed types are filtered out and cause a warning,
                 hard send errors need to be enforced by including ‘fail’.  The value ‘all’  covers  all  types,
                 ‘fcc’  whitelists  ‘Fcc:’  header targets regardless of other settings, ‘file’ file targets (it
                 includes ‘fcc’), ‘pipe’ command pipeline targets, ‘name’  user  names  still  unexpanded  after
                 <b>alias</b> and <u>mta-aliases</u> processing and thus left for expansion by the <u>mta</u> (invalid for the built-
                 in  SMTP  one),  and  ‘addr’ network addresses.  Targets are interpreted in the given order, so
                 that ‘restrict,fail,+file,-all,+addr’ will  cause  hard  errors  for  any  non-network  address
                 recipient address unless running interactively or having been started with the option <b>-~</b> or <b>-#</b>;
                 in the latter case(s) any type may be used.

                 User  name  receivers  addressing  valid local users can be expanded to fully qualified network
                 addresses (also see <u>hostname</u>) by including ‘nametoaddr’  in  the  list.   Historically  invalid
                 recipients   were  stripped  off  without  causing  errors,  this  can  be  changed  by  making
                 ‘failinvaddr’ an entry of the  list  (it  really  acts  like  ‘failinvaddr,+addr’).   Likewise,
                 ‘domaincheck’  (really ‘domaincheck,+addr’)  compares  address domain names against a whitelist
                 and strips off (‘fail’ for hard errors) addressees  which  fail  this  test;  the  domain  name
                 ‘localhost’  and  the  non-empty  value  of  <u>hostname</u>  (the real hostname otherwise) are always
                 whitelisted, <u>expandaddr-domaincheck</u> can be set to  extend  this  list.   Finally  some  address
                 providers  (for  example  <b>-b</b>, <b>-c</b> and all other command line recipients) will be evaluated as if
                 specified within dollar-single-quotes (see “Shell-style argument quoting”) if  the  value  list
                 contains the string ‘shquote’.

       <u>expandaddr-domaincheck</u>
                 Can  be  set  to  a  comma-separated  list  of domain names which should be whitelisted for the
                 evaluation of the ‘domaincheck’  mode  of  <u>expandaddr</u>.   IDNA  encoding  is  not  automatically
                 performed, <b>addrcodec</b> can be used to prepare the domain (of an address).

       <u>expandargv</u>
                 Unless  this  variable  is  set additional <u>mta</u> (Mail-Transfer-Agent) arguments from the command
                 line, as can be given after a <b>--</b> separator, results  in  a  program  termination  with  failure
                 status.   The same can be accomplished by using the special (case-insensitive) value ‘fail’.  A
                 lesser strict variant is the otherwise identical ‘restrict’, which does accept  such  arguments
                 in  interactive  mode, or if tilde commands were enabled explicitly by using one of the command
                 line options <b>-~</b> or <b>-#</b>.  The empty value will allow unconditional usage.

       <u>features</u>  (Read-only) String giving a list of optional features.  Features are preceded with a plus  sign
                 ‘+’  if  they are available, with a hyphen-minus ‘-’ otherwise.  To ease substring matching the
                 string starts and ends with  a  comma.   The  output  of  the  command  <b>version</b>  includes  this
                 information in a more pleasant output.

       <u>flipr</u>     (Boolean)  This setting reverses the meanings of a set of reply commands, turning the lowercase
                 variants, which by default address all recipients included in the header of a  message  (<b>reply</b>,
                 <b>respond</b>,  <b>followup</b>)  into  the  uppercase  variants,  which  by default address the sender only
                 (<b>Reply</b>, <b>Respond</b>, <b>Followup</b>) and vice versa.

       <u>folder</u>    The default path under which mailboxes are to be saved: filenames that begin with the plus sign
                 ‘+’ will have the plus sign replaced with the value of this variable if set, otherwise the plus
                 sign will remain unchanged when doing “Filename transformations”; also see <b>folder</b> for  more  on
                 this  topic,  and  know about standard imposed implications of <u>outfolder</u>.  The value supports a
                 subset of transformations itself, and if the non-empty value does not start with a solidus ‘/’,
                 then the value of HOME will be prefixed automatically.  Once  the  actual  value  is  evaluated
                 first, the internal variable <u>folder-resolved</u> will be updated for caching purposes.

       <u>folder-hook-FOLDER</u>, <u>folder-hook</u>
                 Names a <b>define</b>d macro which will be called whenever a <b>folder</b> is opened.  The macro will also be
                 invoked  when  new  mail  arrives,  but message lists for commands executed from the macro only
                 include newly arrived messages then.  <b>localopts</b> are activated by  default  in  a  folder  hook,
                 causing the covered settings to be reverted once the folder is left again.

                 The specialized form will override the generic one if ‘FOLDER’ matches the file that is opened.
                 Unlike   other   folder   specifications,   the  fully  expanded  name  of  a  folder,  without
                 metacharacters, is used to avoid ambiguities.  However, if the  mailbox  resides  under  <u>folder</u>
                 then  the  usual  ‘+’ specification is tried in addition, so that if <u>folder</u> is “mail” (and thus
                 relative  to  the  user's  home  directory)  then  <u>/home/usr1/mail/sent</u>  will   be   tried   as
                 ‘folder-hook-/home/usr1/mail/sent’ first, but then followed by ‘folder-hook-+sent’.

       <u>folder-resolved</u>
                 (Read-only)  Set to the fully resolved path of <u>folder</u> once that evaluation has occurred; rather
                 internal.

       <u>followup-to</u>
                 (Boolean) Controls whether a ‘Mail-Followup-To:’ header is generated when sending  messages  to
                 known mailing lists.  The user as determined via <u>from</u> (or, if that contains multiple addresses,
                 <u>sender</u>)  will  be  placed  in  there  if any list addressee is not a subscribed list.  Also see
                 <u>followup-to-honour</u> and the commands <b>mlist</b>, <b>mlsubscribe</b>, <b>reply</b> and <b>Lreply</b>.

       <u>followup-to-add-cc</u>
                 (Boolean) Controls whether the user will be added to the messages' ‘Cc:’ list  in  addition  to
                 placing an entry in ‘Mail-Followup-To:’ (see <u>followup-to</u>).

       <u>followup-to-honour</u>
                 Controls  whether a ‘Mail-Followup-To:’ header is honoured when group-replying to a message via
                 <b>reply</b> or <b>Lreply</b>.  This is a “quadoption”; if set without a value it defaults to “yes”, and  see
                 <u>followup-to</u>.

       <u>forward-add-cc</u>
                 (Boolean)  Whether senders of messages forwarded via <b>~F</b>, <b>~f</b>, <b>~m</b>, <b>~U</b> or <b>~u</b> shall be made members
                 of the carbon copies ‘Cc:’ list.

       <u>forward-as-attachment</u>
                 (Boolean) Original messages are normally sent as inline text with the <b>forward</b> command, and only
                 the first part of a multipart message is included.  With this setting enabled messages are sent
                 as unmodified MIME ‘message/rfc822’ attachments with all of their parts included.

       <u>forward-inject-head</u>, <u>forward-inject-tail</u>
                 The strings to put  before  and  after  the  text  of  a  message  with  the  <b>forward</b>  command,
                 respectively.   The  former defaults to ‘-------- Original Message --------\n’.  Special format
                 directives in these strings will be expanded if possible, and if so configured the output  will
                 be folded according to <u>quote-fold</u>; for more please refer to <u>quote-inject-head</u>.  Injections will
                 not  be  performed  by  <b>forward</b>  if  the  variable  <u>forward-as-attachment</u> is set — the “COMMAND
                 ESCAPES” <b>~F</b>, <b>~f</b>, <b>~M</b>, <b>~m</b>, <b>~U</b>, <b>~u</b> always inject.

       <u>from</u>      The address (or a list of addresses) to put into the  ‘From:’  field  of  the  message  header,
                 quoting  RFC  5322:  the author(s) of the message, that is, the mailbox(es) of the person(s) or
                 system(s) responsible for the writing of the message.  According to that RFC setting the <u>sender</u>
                 variable is required if <u>from</u> contains more than one address.  [v15 behaviour may differ] Please
                 expect automatic management of the <u>from</u> and <u>sender</u>  relationship.   Dependent  on  the  context
                 these addresses are handled as if they were in the list of <b>alternates</b>.

                 If  a  file-based  MTA is used, then <u>from</u> (or, if that contains multiple addresses, <u>sender</u>) can
                 nonetheless be used as the envelope sender address at the MTA  protocol  level  (the  RFC  5321
                 reverse-path), either via the <b>-r</b> command line option (without argument; see there for more), or
                 by setting <u>r-option-implicit</u>.

                 If  the machine's hostname is not valid at the Internet (for example at a dialup machine), then
                 either this variable or <u>hostname</u> ([v15-compat] a SMTP-based  <u>mta</u>  adds  even  more  fine-tuning
                 capabilities with <u>smtp-hostname</u>) have to be set: if so the message and MIME part related unique
                 ID  fields  ‘Message-ID:’  and  ‘Content-ID:’  will  be  created  (except  when  disallowed  by
                 <u>message-id-disable</u> or <u>stealthmua</u>).

       <u>fullnames</u>
                 (Boolean) Due to historical reasons comments and name parts of email addresses are  removed  by
                 default  when  sending mail, replying to or forwarding a message.  If this variable is set such
                 stripping is not performed.

       <u>fwdheading</u>
                 [Obsolete] Predecessor of <u>forward-inject-head</u>.

       <u>header</u>    (Boolean) Causes the header summary to be written at startup and after commands that affect the
                 number of messages or the order of messages in the current <b>folder</b>.   Unless  in  <u>posix</u>  mode  a
                 header  summary  will  also  be displayed on folder changes.  The command line option <b>-N</b> can be
                 used to set no<u>header</u>.

       <u>headline</u>  A format string to use for the summary of <b>headers</b>.  Format specifiers in the given string start
                 with a percent sign ‘%’ and may be followed by an optional decimal number indicating the  field
                 width  — if that is negative, the field is to be left-aligned.  Names and addresses are subject
                 to modifications according to <u>showname</u> and <u>showto</u>.  Valid format specifiers are:

                 ‘%%’      A plain percent sign.
                 ‘%&gt;’      “Dotmark”: a space character but for  the  current  message  (“dot”),  for  which  it
                           expands to ‘&gt;’ (dependent on <u>headline-plain</u>).
                 ‘%&lt;’      “Dotmark”:  a  space  character  but  for  the  current message (“dot”), for which it
                           expands to ‘&lt;’ (dependent on <u>headline-plain</u>).
                 ‘%$’      [Option] The spam score of the message,  as  has  been  classified  via  the  command
                           <b>spamrate</b>.  Shows only a replacement character if there is no spam support.
                 ‘%a’      Message  attribute  character  (status  flag);  the actual content can be adjusted by
                           setting <u>attrlist</u>.
                 ‘%d’      The date found in the ‘Date:’ header of  the  message  when  <u>datefield</u>  is  set  (the
                           default),  otherwise  the  date  when  the  message  was received.  Formatting can be
                           controlled  by  assigning   a   <u><a href="../man3/strftime.3.html">strftime</a></u>(3)   format   string   to   <u>datefield</u>   (and
                           <u>datefield-markout-older</u>).
                 ‘%e’      The indenting level in ‘thread’ed <b>sort</b> mode.
                 ‘%f’      The address of the message sender.
                 ‘%i’      The  message  thread tree structure.  (Note that this format does not support a field
                           width, and honours <u>headline-plain</u>.)
                 ‘%L’      Mailing list status: is the addressee of the message  a  known  ‘l’  (<b>mlist</b>)  or  ‘L’
                           <b>mlsubscribe</b>d  mailing  list?   The  letter  ‘P’  announces the presence of a RFC 2369
                           ‘List-Post:’ header, which makes a message a valuable target of <b>Lreply</b>.
                 ‘%l’      The number of lines of the message, if available.
                 ‘%m’      Message number.
                 ‘%o’      The number of octets (bytes) in the message, if available.
                 ‘%S’      Message subject (if any) in double quotes.
                 ‘%s’      Message subject (if any).
                 ‘%t’      The position in threaded/sorted order.
                 ‘%U’      The value 0 except in an IMAP mailbox, where it expands to the UID of the message.

                 The default is ‘%&gt;%a%m %-18f %16d %4l/%-5o %i%-s’,  or  ‘%&gt;%a%m %20-f  %16d %3l/%-5o %i%-S’  if
                 <u>bsdcompat</u> is set.  Also see <u>attrlist</u>, <u>headline-plain</u> and <u>headline-bidi</u>.

       <u>headline-bidi</u>
                 Bidirectional  text  requires  special  treatment  when displaying headers, because numbers (in
                 dates or for file sizes etc.) will not affect the current text direction, in  effect  resulting
                 in  ugly line layouts when arabic or other right-to-left text is to be displayed.  On the other
                 hand only a minority of terminals is capable to correctly handle  direction  changes,  so  that
                 user  interaction  is necessary for acceptable results.  Note that extended host system support
                 is required nonetheless, e.g., detection of the terminal character set is one precondition; and
                 this feature only works in an Unicode (i.e., UTF-8) locale.

                 In general setting this variable will cause S-nail to encapsulate text fields  that  may  occur
                 when  displaying  <u>headline</u>  (and  some  other  fields,  like dynamic expansions in <u>prompt</u>) with
                 special Unicode control sequences; it is possible to fine-tune the terminal  support  level  by
                 assigning  a value: no value (or any value other than ‘1’, ‘2’ and ‘3’) will make S-nail assume
                 that the terminal is capable to properly deal with Unicode version 6.3, in which case  text  is
                 embedded  in  a  pair  of  U+2068  (FIRST  STRONG ISOLATE) and U+2069 (POP DIRECTIONAL ISOLATE)
                 characters.  In addition no space on the line is reserved for these characters.

                 Weaker support is chosen by using the value ‘1’ (Unicode 6.3,  but  reserve  the  room  of  two
                 spaces for writing the control sequences onto the line).  The values ‘2’ and ‘3’ select Unicode
                 1.1  support  (U+200E,  LEFT-TO-RIGHT  MARK);  the latter again reserves room for two spaces in
                 addition.

       <u>headline-plain</u>
                 (Boolean) On Unicode (UTF-8) aware terminals enhanced graphical symbols are used by default for
                 certain entries of <u>headline</u>.  If this variable is set only basic US-ASCII symbols will be used.

       <u>history-file</u>
                 [Option] The (expandable) location of a permanent <b>history</b> file for the  MLE  line  editor  (“On
                 terminal control and line editor”).  Also see <u>history-size</u>.

       <u>history-gabby</u>
                 [Option]  Add  more  entries to the MLE <b>history</b> as is normally done.  A comma-separated list of
                 case-insensitive strings can be used to fine-tune which gabby entries shall be allowed.  If  it
                 contains ‘errors’, erroneous commands will also be added.  ‘all’ adds all optional entries, and
                 is the fallback chattiness identifier of <u>on-history-addition</u>.

       <u>history-gabby-persist</u>
                 (Boolean)[Option] The <u>history-gabby</u> entries will not be saved in persistent storage unless this
                 variable  is set.  The knowledge of whether a persistent entry was gabby is not lost.  Also see
                 <u>history-file</u>.

       <u>history-size</u>
                 [Option] Setting this variable imposes a limit on the number of concurrent <b>history</b> entries.  If
                 set to the value 0 then no further history entries will be added, and loading and incorporation
                 of the <u>history-file</u> upon program startup can also be suppressed by doing this.  Runtime changes
                 will not be reflected before the <b>history</b> is saved or loaded (again).

       <u>hold</u>      (Boolean) This setting controls whether messages are held in the system <u>inbox</u>, and it is set by
                 default.

       <u>hostname</u>  Used instead of the value obtained from  <u><a href="../man3/uname.3.html">uname</a></u>(3)  and  <u><a href="../man3/getaddrinfo.3.html">getaddrinfo</a></u>(3)  as  the  hostname  when
                 expanding  local  addresses,  for  example  in  ‘From:’  (also  see  “On sending mail, and non-
                 interactive mode”, for expansion of addresses that have a valid user-, but no  domain  name  in
                 angle  brackets).   If either of <u>from</u> or this variable is set the message and MIME part related
                 unique ID fields ‘Message-ID:’ and ‘Content-ID:’ will be created  (except  when  disallowed  by
                 <u>message-id-disable</u>   or  <u>stealthmua</u>).   If  the  [Option]al  IDNA  support  is  available  (see
                 <u>idna-disable</u>) variable assignment is aborted when a necessary conversion fails.

                 Setting it to the empty string will cause the normal  hostname  to  be  used,  but  nonetheless
                 enables  creation  of  said  ID fields.  [v15-compat] in conjunction with the built-in SMTP <u>mta</u>
                 <u>smtp-hostname</u> also influences the results: one should  produce  some  test  messages  with  the
                 desired combination of <u>hostname</u>, and/or <u>from</u>, <u>sender</u> etc. first.

       <u>idna-disable</u>
                 (Boolean)[Option] Can be used to turn off the automatic conversion of domain names according to
                 the  rules  of  IDNA  (internationalized  domain  names for applications).  Since the IDNA code
                 assumes that domain names are specified with the <u>ttycharset</u>  character  set,  an  UTF-8  locale
                 charset  is  required  to represent all possible international domain names (before conversion,
                 that is).

       <u>ifs</u>       The input field separator that is used ([v15  behaviour  may  differ]  by  some  functions)  to
                 determine where to split input data.

                 1.        Unsetting is treated as assigning the default value, ‘ \t\n’.
                 2.        If set to the empty value, no field splitting will be performed.
                 3.        If  set to a non-empty value, all whitespace characters are extracted and assigned to
                           the variable <u>ifs-ws</u>.

                 a.        <u>ifs-ws</u> will be ignored at the beginning and  end  of  input.   Diverging  from  POSIX
                           shells  default  whitespace  is  removed  in  addition, which is owed to the entirely
                           different line content extraction rules.
                 b.        Each occurrence of a character of <u>ifs</u> will cause field-splitting, any adjacent <u>ifs-ws</u>
                           characters will be skipped.

       <u>ifs-ws</u>    (Read-only) Automatically deduced from the whitespace characters in <u>ifs</u>.

       <u>ignore</u>    (Boolean) Ignore interrupt signals from the terminal while entering messages; instead echo them
                 as ‘@’ characters and discard the current line.

       <u>ignoreeof</u>
                 (Boolean) Ignore end-of-file conditions (‘control-D’) in “Compose mode” on message input and in
                 interactive command input.  If set an interactive command input session can  only  be  left  by
                 explicitly  using one of the commands <b>exit</b> and <b>quit</b>, and message input in compose mode can only
                 be terminated by entering a period ‘.’ on a  line  by  itself  or  by  using  the  <b>~.</b>  “COMMAND
                 ESCAPES”; Setting this implies the behaviour that <u>dot</u> describes in <u>posix</u> mode.

       <u>inbox</u>     If  this  is  set  to  a  non-empty string it will specify the user's “primary system mailbox”,
                 overriding MAIL and the system-dependent default, and (thus) be used to replace ‘%’ when  doing
                 “Filename  transformations”;  also  see  <b>folder</b>  for  more on this topic.  The value supports a
                 subset of transformations itself.

       <u>indentprefix</u>
                 String used by the <b>~m</b>, <b>~M</b> and <b>~R</b> “COMMAND ESCAPES”  and  by  the  <u>quote</u>  option  for  indenting
                 messages,  in  place  of  the  POSIX  mandated  default  tabulator  character  ‘\t’.   Also see
                 <u>quote-chars</u>.

       <u>keep</u>      (Boolean) If set, an empty “primary system  mailbox”  file  is  not  removed.   Note  that,  in
                 conjunction  with  <u>posix</u> mode any empty file will be removed unless this variable is set.  This
                 may improve the interoperability with other  mail  user  agents  when  using  a  common  folder
                 directory,  and prevents malicious users from creating fake mailboxes in a world-writable spool
                 directory.  [v15 behaviour may differ] Only local regular (MBOX) files are covered, Maildir and
                 other mailbox types will never be removed, even if empty.

       <u>keep-content-length</u>
                 (Boolean) When (editing messages and) writing MBOX mailbox files S-nail can be told to keep the
                 ‘Content-Length:’ and ‘Lines:’ header fields that some MUAs generate by setting this  variable.
                 Since  S-nail does neither use nor update these non-standardized header fields (which in itself
                 shows one of their conceptual problems), stripping them  should  increase  interoperability  in
                 between  MUAs  that  work  with  with  same  mailbox  files.  Note that, if this is not set but
                 <u>writebackedited</u>, as below, is, a possibly performed automatic stripping of these header  fields
                 already  marks  the  message as being modified.  [v15 behaviour may differ] At some future time
                 S-nail will be capable to rewrite and apply an <u>mime-encoding</u> to  modified  messages,  and  then
                 those fields will be stripped silently.

       <u>keepsave</u>  (Boolean)  When  a  message  is  saved it is usually discarded from the originating folder when
                 S-nail is quit.  This setting causes all saved message to be retained.

       <u>line-editor-cpl-word-breaks</u>
                 [Option] List of bytes which are used by the <b>mle-complete</b> tabulator completion to decide  where
                 word  boundaries  exist,  by default ‘"'@=;|:’ [v15 behaviour may differ] This mechanism is yet
                 restricted.

       <u>line-editor-disable</u>
                 (Boolean) Turn off any line editing capabilities (from S-nails POW, see  “On  terminal  control
                 and line editor” for more).

       <u>line-editor-no-defaults</u>
                 (Boolean)[Option] Do not establish any default key binding.

       <u>log-prefix</u>
                 Error log message prefix string (‘s-nail: ’).

       <u>mailbox-display</u>
                 (Read-only)  The  name  of  the  current  mailbox  (<b>folder</b>),  possibly  abbreviated for display
                 purposes.

       <u>mailbox-resolved</u>
                 (Read-only) The fully resolved path of the current mailbox.

       <u>mailcap-disable</u>
                 (Boolean)[Option] Turn off consideration of MIME type handlers from, and  implicit  loading  of
                 “The Mailcap files”.

       <u>mailx-extra-rc</u>
                 An  additional  startup file that is loaded as the last of the “Resource files”.  Use this file
                 for commands that are not understood by other  POSIX  <u><a href="../man1/mailx.1.html">mailx</a></u>(1)  implementations,  i.e.,  mostly
                 anything which is not covered by “Initial settings”.

       <u>markanswered</u>
                 (Boolean)  When  a  message is replied to and this variable is set, it is marked as having been
                 <b>answered</b>.  See the section “Message states”.

       <u>mbox-fcc-and-pcc</u>
                 (Boolean) By default all file and pipe message receivers (see <u>expandaddr</u>)  will  be  fed  valid
                 MBOX  database  entry  message  data (see <b>folder</b>, <u>mbox-rfc4155</u>), and existing file targets will
                 become extended in compliance to RFC 4155.  If this variable is unset then a  plain  standalone
                 RFC 5322 message will be written, and existing file targets will be overwritten.

       <u>mbox-rfc4155</u>
                 (Boolean)  When  opening MBOX mailbox databases, and in order to achieve compatibility with old
                 software, the very tolerant POSIX standard rules for detecting  message  boundaries  (so-called
                 ‘From_’  lines)  are  used  instead  of  the  stricter  rules from the standard RFC 4155.  This
                 behaviour can be switched by setting this variable.

                 This may temporarily be handy when S-nail complains about invalid ‘From_’ lines when opening  a
                 MBOX: in this case setting this variable and re-opening the mailbox in question may correct the
                 result.   If  so, copying the entire mailbox to some other file, as in ‘copy * SOME-FILE’, will
                 perform proper, all-compatible ‘From_’ quoting for all detected messages, resulting in a  valid
                 MBOX  mailbox.   ([v15  behaviour may differ] The better and non-destructive approach is to re-
                 encode invalid messages, as if it would be created anew, instead of mangling the ‘From_’ lines;
                 this requires the structural code changes of the v15 rewrite.)  Finally  the  variable  can  be
                 unset again:

                       define mboxfix {
                         localopts yes; wysh set mbox-rfc4155;\
                           wysh File "${1}"; copy * "${2}"
                       }
                       call mboxfix /tmp/bad.mbox /tmp/good.mbox

       <u>memdebug</u>  (Boolean)  Internal  development  variable.   (Keeps  memory debug enabled even if <u>debug</u> is not
                 set.)

       <u>message-id-disable</u>
                 (Boolean) By setting this variable the generation of ‘Message-ID:’  and  ‘Content-ID:’  message
                 and MIME part headers can be completely suppressed, effectively leaving this task up to the <u>mta</u>
                 (Mail-Transfer-Agent) or the SMTP server.  Note that according to RFC 5321 a SMTP server is not
                 required  to add this field by itself, so it should be ensured that it accepts messages without
                 ‘Message-ID’.

       <u>message-inject-head</u>
                 A string to put at the beginning of each new message, followed by a  newline.   [Obsolete]  The
                 escape  sequences  tabulator  ‘\t’  and  newline  ‘\n’ are understood (use the <b>wysh</b> prefix when
                 <b>set</b>ting the variable(s) instead).

       <u>message-inject-tail</u>
                 A string to put at the end of each new message, followed by a newline.  [Obsolete]  The  escape
                 sequences  tabulator ‘\t’ and newline ‘\n’ are understood (use the <b>wysh</b> prefix when <b>set</b>ting the
                 variable(s) instead).  Also see <u>on-compose-leave</u>.

       <u>metoo</u>     (Boolean) Usually, when an <b>alias</b> expansion contains the sender, the sender is removed from  the
                 expansion.  Setting this option suppresses these removals.  Note that a set <u>metoo</u> also causes a
                 ‘-m’  option  to  be passed through to the <u>mta</u> (Mail-Transfer-Agent); though most of the modern
                 MTAs no longer document this flag, no MTA is known which does not support  it  (for  historical
                 compatibility).

       <u>mime-allow-text-controls</u>
                 (Boolean)  When  sending  messages,  each  part  of  the  message is MIME-inspected in order to
                 classify the ‘Content-Type:’  and  ‘Content-Transfer-Encoding:’  (see  <u>mime-encoding</u>)  that  is
                 required  to send this part over mail transport, i.e., a computation rather similar to what the
                 <u><a href="../man1/file.1.html">file</a></u>(1) command produces when used with the ‘--mime’ option.

                 This classification however treats text files which are encoded in UTF-16 (seen for HTML files)
                 and similar character sets as binary octet-streams, forcefully  changing  any  ‘text/plain’  or
                 ‘text/html’  specification  to ‘application/octet-stream’: If that actually happens a yet unset
                 charset MIME parameter is set to ‘binary’, effectively making it impossible for  the  receiving
                 MUA to automatically interpret the contents of the part.

                 If this variable is set, and the data was unambiguously identified as text data at first glance
                 (by  a  ‘.txt’  or  ‘.html’  file  extension),  then  the  original ‘Content-Type:’ will not be
                 overwritten.

       <u>mime-alternative-favour-rich</u>
                 (Boolean) If this variable is set then  rich  MIME  alternative  parts  (e.g.,  HTML)  will  be
                 preferred  in  favour of included plain text versions when displaying messages, provided that a
                 handler exists which produces output that can be (re)integrated  into  S-nail's  normal  visual
                 display.

       <u>mime-counter-evidence</u>
                 Normally  the  ‘Content-Type:’  field  is  used to decide how to handle MIME parts.  Some MUAs,
                 however, do not use “The mime.types files” (also see “HTML mail and  MIME  attachments”)  or  a
                 similar  mechanism  to  correctly  classify  content,  but  specify  an  unspecific  MIME  type
                 (‘application/octet-stream’) even for plain text attachments.  If this  variable  is  set  then
                 S-nail will try to re-classify such MIME message parts, if possible, for example via a possibly
                 existing  attachment  filename.  A non-empty value may also be given, in which case a number is
                 expected, actually a carrier of bits, best specified as a binary value, like ‘0b1111’.

                 <b>•</b>   If bit two is set (counting from 1, decimal 2) then the detected <b>mimetype</b> will  be  carried
                     along  with  the  message  and  be  used for deciding which MIME handler is to be used, for
                     example; when displaying such a MIME  part  the  part-info  will  indicate  the  overridden
                     content-type by showing a plus sign ‘+’.
                 <b>•</b>   If bit three is set (decimal 4) then the counter-evidence is always produced and a positive
                     result will be used as the MIME type, even forcefully overriding the parts given MIME type.
                 <b>•</b>   If   bit   four   is   set   (decimal   8)   as   a  last  resort  the  actual  content  of
                     ‘application/octet-stream’ parts will be inspected, so that data  which  looks  like  plain
                     text  can  be treated as such.  This mode is even more relaxed when data is to be displayed
                     to the user or used as a message quote  (data  consumers  which  mangle  data  for  display
                     purposes, which includes masking of control characters, for example).

       <u>mime-encoding</u>
                 The  MIME ‘Content-Transfer-Encoding’ to use in outgoing text messages and message parts, where
                 applicable (7-bit clean text messages are without an encoding if possible):

                 ‘8bit’    (Or ‘8b’.)  8-bit transport  effectively  causes  the  raw  data  be  passed  through
                           unchanged,  but may cause problems when transferring mail messages over channels that
                           are not ESMTP (RFC 1869) compliant.  Also, several  input  data  constructs  are  not
                           allowed by the specifications and may cause a different transfer-encoding to be used.
                           By  established  rules  and popular demand occurrences of ‘^From_’ (see <u>mbox-rfc4155</u>)
                           will be MBOXO quoted (prefixed with greater-than sign ‘&gt;’) instead of causing a  non-
                           destructive  encoding  like  ‘quoted-printable’  to  be  chosen, unless context (like
                           message signing) requires otherwise.
                 ‘quoted-printable’
                           (Or ‘qp’.)  Quoted-printable encoding is 7-bit clean and has the property that  ASCII
                           characters  are  passed through unchanged, so that an english message can be read as-
                           is; it is also acceptable for other single-byte locales that  share  many  characters
                           with  ASCII,  for  example  ISO-8859-1.  The encoding will cause a large overhead for
                           messages in other character sets: for example it will require up to twelve (12) bytes
                           to encode a single UTF-8 character of four (4) bytes.  It is the default encoding.
                 ‘base64’  (Or ‘b64’.)  This encoding is 7-bit clean and will always be used  for  binary  data.
                           This  encoding  has a constant input:output ratio of 3:4, regardless of the character
                           set of the input data it will encode three bytes of input to four  bytes  of  output.
                           This transfer-encoding is not human readable without performing a decoding step.

       <u>mime-force-sendout</u>
                 (Boolean)[Option]  Whenever  it  is not acceptable to fail sending out messages because of non-
                 convertible character content this variable may be set.  It will, as a  last  resort,  classify
                 the  part  content as ‘application/octet-stream’.  Please refer to the section “Character sets”
                 for the complete picture of character set conversion, and “HTML mail and MIME attachments”  for
                 how to internally or externally handle part content.

       <u>mimetypes-load-control</u>
                 Can be used to control which of “The mime.types files” are loaded: if the letter ‘u’ is part of
                 the  option  value,  then the user's personal <u><a href="file:~/.mime.types">~/.mime.types</a></u> file will be loaded (if it exists);
                 likewise the letter ‘s’ controls loading of the system wide <u><a href="file:/etc/mime.types">/etc/mime.types</a></u>;  directives  found
                 in the user file take precedence, letter matching is case-insensitive.  If this variable is not
                 set S-nail will try to load both files.  Incorporation of the S-nail-built-in MIME types cannot
                 be suppressed, but they will be matched last (the order can be listed via <b>mimetype</b>).

                 More  sources  can  be  specified  by using a different syntax: if the value string contains an
                 equals sign ‘=’ then it is instead parsed as a comma-separated list of  the  described  letters
                 plus ‘f=FILENAME’ pairs; the given filenames will be expanded and loaded, and their content may
                 use  the  extended  syntax that is described in the section “The mime.types files”.  Directives
                 found in such files always take precedence (are prepended to the MIME type cache).

       <u>mta</u>       Select an alternate Mail-Transfer-Agent by either specifying the full pathname of an executable
                 (a ‘file://’ prefix may  be  given),  or  [Option]ally  a  SMTP  aka  SUBMISSION  protocol  URL
                 [v15-compat]:

                       <b>submissions://[user[:password]@]server[:port]</b>

                 ([no v15-compat]: ‘[smtp://]server[:port]’.)  The default has been chosen at compile time.  MTA
                 data  transfers  are  always performed in asynchronous child processes, and without supervision
                 unless either the <u>sendwait</u> or the <u>verbose</u> variable is set.  Also see <u>mta-bcc-ok</u>.   [Option]ally
                 expansion of <u><a href="../man5/aliases.5.html">aliases</a></u>(5) can be performed by setting <u>mta-aliases</u>.

                 For  testing  purposes  there  is  the  ‘test’  pseudo-MTA,  which  dumps to standard output or
                 optionally to a file, and honours <u>mbox-fcc-and-pcc</u>:

                       $ echo text | s-nail -:/ -Smta=test -s ubject <a href="mailto:ex@am.ple">ex@am.ple</a>
                       $ &lt;/dev/null s-nail -:/ -Smta=test://./xy <a href="mailto:ex@am.ple">ex@am.ple</a>

                 For a file-based MTA it may be necessary to set <u>mta-argv0</u> in  in  order  to  choose  the  right
                 target  of  a modern <u><a href="../man8/mailwrapper.8.html">mailwrapper</a></u>(8) environment.  It will be passed command line arguments from
                 several possible sources: from the variable <u>mta-arguments</u> if set,  from  the  command  line  if
                 given  and  the  variable  <u>expandargv</u> allows their use.  Argument processing of the MTA will be
                 terminated with a <b>--</b> separator.

                 The otherwise occurring implicit usage of the following  MTA  command  line  arguments  can  be
                 disabled  by  setting  the  boolean  variable <u>mta-no-default-arguments</u> (which will also disable
                 passing <b>--</b> to the MTA): <b>-i</b> (for not treating a line with only a dot ‘.’ character as the end of
                 input), <b>-m</b> (shall the variable <u>metoo</u> be set) and <b>-v</b>  (if  the  <u>verbose</u>  variable  is  set);  in
                 conjunction with the <b>-r</b> command line option or <u>r-option-implicit</u> <b>-f</b> as well as possibly <b>-F</b> will
                 (not) be passed.

                 [Option]ally  S-nail  can  send  mail  over SMTP aka SUBMISSION network connections to a single
                 defined smart host by setting this variable to a SMTP or SUBMISSION URL (see “On URL syntax and
                 credential lookup”).  An  authentication  scheme  can  be  specified  via  the  variable  chain
                 <u>smtp-auth</u>.   Encrypted  network  connections are [Option]ally available, the section “Encrypted
                 network communication” should give an overview and provide links to more information  on  this.
                 Note  that  with  some  mail providers it may be necessary to set the <u>smtp-hostname</u> variable in
                 order to use a specific combination of <u>from</u>, <u>hostname</u> and <u>mta</u>.   Network  communication  socket
                 timeouts  are  configurable  via  <u>socket-connect-timeout</u>.  All generated network traffic may be
                 proxied over a SOCKS <u>socks-proxy</u>, it can be logged by setting  <u>verbose</u>  twice.   The  following
                 SMTP variants may be used:

                 <b>•</b>   The  plain  SMTP protocol (RFC 5321) that normally lives on the server port 25 and requires
                     setting the <u>smtp-use-starttls</u> variable to enter a TLS encrypted session  state.   Assign  a
                     value   like   [v15-compat]   ‘smtp://[user[:password]@]server[:port]’   ([no   v15-compat]
                     ‘smtp://server[:port]’) to choose this protocol.

                 <b>•</b>   The so-called SMTPS which is supposed to live on server port 465 and is  automatically  TLS
                     secured.   Unfortunately  it  never  became  a  standardized  protocol  and may thus not be
                     supported by your hosts network service database – in fact the port number has already been
                     reassigned to other protocols!

                     SMTPS is nonetheless a commonly offered protocol and thus can  be  chosen  by  assigning  a
                     value   like   [v15-compat]   ‘smtps://[user[:password]@]server[:port]’   ([no  v15-compat]
                     ‘smtps://server[:port]’); due  to  the  mentioned  problems  it  is  usually  necessary  to
                     explicitly specify the port as ‘:465’, however.

                 <b>•</b>   The  SUBMISSION protocol (RFC 6409) lives on server port 587 and is identically to the SMTP
                     protocol from S-nail's point of view; it requires setting <u>smtp-use-starttls</u> to enter a  TLS
                     secured session state; e.g., [v15-compat] ‘submission://[user[:password]@]server[:port]’.

                 <b>•</b>   The  SUBMISSIONS  protocol  (RFC  8314) that lives on server port 465 and is TLS secured by
                     default.    It   can   be   chosen    by    assigning    a    value    like    [v15-compat]
                     ‘submissions://[user[:password]@]server[:port]’.   Due  to the problems mentioned for SMTPS
                     above and the fact that SUBMISSIONS is new and a successor that lives on the same  port  as
                     the historical engineering mismanagement named SMTPS, it is usually necessary to explicitly
                     specify the port as ‘:465’.

       <u>mta-aliases</u>
                 [Option] If set to a path pointing to a text file in valid MTA (Postfix) <u><a href="../man5/aliases.5.html">aliases</a></u>(5) format, the
                 file  is  loaded  and  cached  (manageable  with  <b>mtaaliases</b>), and henceforth plain ‘name’ (see
                 <u>expandaddr</u>) message receiver names are recursively expanded as a last expansion step, after the
                 distribution lists which can be created with <b>alias</b>.  Constraints on <u><a href="../man5/aliases.5.html">aliases</a></u>(5) content support:
                 only local addresses (names) which are valid usernames (‘[a-z_][a-z0-9_-]*[$]?’) are treated as
                 expandable aliases, and [v15 behaviour may differ]  ‘:include:/file/name’  directives  are  not
                 supported.   By  including  ‘-name’  in  <u>expandaddr</u> it can be asserted that only expanded names
                 (mail addresses) are passed through to the MTA.

       <u>mta-arguments</u>
                 Arguments to pass through to  a  file-based  <u>mta</u>  (Mail-Transfer-Agent),  parsed  according  to
                 “Shell-style argument quoting” into an array of arguments which will be joined onto MTA options
                 from other sources, for example ‘? wysh set mta-arguments='-t -X "/tmp/my log"'’.

       <u>mta-no-default-arguments</u>
                 (Boolean) Avoids passing standard command line options to a file-based <u>mta</u> (please see there).

       <u>mta-no-receiver-arguments</u>
                 (Boolean)  By  default all receiver addresses will be passed as command line options to a file-
                 based <u>mta</u>.  Setting this variable disables this  behaviour  to  aid  those  MTAs  which  employ
                 special  treatment  of  such  arguments.   Doing  so  can  make  it  necessary to pass a <b>-t</b> via
                 <u>mta-arguments</u>, to testify the MTA that it should use the passed message as a template.

       <u>mta-argv0</u>
                 Many  systems  use  a  so-called  <u><a href="../man8/mailwrapper.8.html">mailwrapper</a></u>(8)  environment  to  ensure  compatibility   with
                 <u><a href="../man1/sendmail.1.html">sendmail</a></u>(1).   This  works  by  inspecting  the  name that was used to invoke the mail delivery
                 system.  If this variable is set then the mailwrapper (the program that  is  actually  executed
                 when calling the file-based <u>mta</u>) will treat its contents as that name.

       <u>mta-bcc-ok</u>
                 (Boolean) In violation of RFC 5322 some MTAs do not remove ‘Bcc:’ header lines from transported
                 messages  after  having noted the respective receivers for addressing purposes.  (The MTAs Exim
                 and Courier for example require the command line option <b>-t</b> to enforce removal.)  Unless this is
                 set corresponding receivers are addressed  by  protocol-specific  means  or  MTA  command  line
                 options only, the header itself is stripped before being sent over the wire.

       <u>netrc-lookup-USER@HOST</u>, <u>netrc-lookup-HOST</u>, <u>netrc-lookup</u>
                 (Boolean)[v15-compat][Option]  Used  to control usage of the user's <u><a href="file:~/.netrc">~/.netrc</a></u> file for lookup of
                 account credentials, as documented in the section “On URL syntax and credential lookup” and for
                 the command <b>netrc</b>; the  section  “The  .netrc  file”  documents  the  file  format.   Also  see
                 <u>netrc-pipe</u>.

       <u>netrc-pipe</u>
                 [v15-compat][Option] When <u><a href="file:~/.netrc">~/.netrc</a></u> is loaded (see <b>netrc</b> and <u>netrc-lookup</u>) then S-nail will read
                 the  output of a shell pipe instead of the user's <u><a href="file:~/.netrc">~/.netrc</a></u> file if this variable is set (to the
                 desired shell command).  This can be used to, for example, store <u><a href="file:~/.netrc">~/.netrc</a></u> in encrypted form: ‘?
                 set netrc-pipe='gpg -qd <a href="file:~/.netrc.pgp">~/.netrc.pgp</a>'’.

       <u>newfolders</u>
                 [Option] If this variable has the value ‘maildir’, newly  created  local  folders  will  be  in
                 Maildir instead of MBOX format.

       <u>newmail</u>   Checks for new mail in the current folder each time the prompt is shown.  A Maildir folder must
                 be  re-scanned  to  determine  if new mail has arrived.  If this variable is set to the special
                 value ‘nopoll’ then a Maildir folder will not  be  rescanned  completely,  but  only  timestamp
                 changes are detected.  Maildir folders are [Option]al.

       <u>outfolder</u>
                 (Boolean)  Causes  a  non-absolute  filename  specified  in <u>record</u>, as well as the sender-based
                 filenames of the <b>Copy</b>, <b>Save</b>, <b>Followup</b> and <b>followup</b> commands to be interpreted relative  to  the
                 <u>folder</u> directory rather than relative to the current directory.

       <u>on-account-cleanup-ACCOUNT</u>, <u>on-account-cleanup</u>
                 Macro hook which will be called once an <b>account</b> is left, as the very last step before unrolling
                 per-account  <b>localopts</b>.   This  hook  is  run  even  in  case  of fatal errors, including those
                 generated by switching to the account as such, and it is advisable to perform  only  absolutely
                 necessary  actions,  like cleaning up <b>alternates</b>, for example.  The specialized form is used in
                 favour of the generic one if found.

       <u>on-compose-cleanup</u>
                 Macro hook which will be called after the message has been sent (or not, in case of  failures),
                 as  the  very last step before unrolling compose mode <b>localopts</b>.  This hook is run even in case
                 of fatal errors, and it is  advisable  to  perform  only  absolutely  necessary  actions,  like
                 cleaning up <b>alternates</b>, for example.

                 For  compose  mode  hooks  that  may  affect  the  message content please see <u>on-compose-enter</u>,
                 <u>on-compose-leave</u>, <u>on-compose-splice</u>.  [v15 behaviour  may  differ]  This  hook  exists  because
                 <b>alias</b>,  <b>alternates</b>, <b>commandalias</b>, <b>shortcut</b>, to name a few, are neither covered by <b>localopts</b> nor
                 by <b>local</b>: changes applied in compose mode will continue to be in effect thereafter.

       <u>on-compose-enter</u>, <u>on-compose-leave</u>
                 Macro hooks which will be called once compose mode is entered, and  after  composing  has  been
                 finished,  respectively;  the  exact  order of the steps taken is documented for <b>~.</b>, one of the
                 “COMMAND ESCAPES”.  Context about the message being  worked  on  can  be  queried  via  <b>digmsg</b>.
                 <b>localopts</b>  are  enabled  for  these hooks, and changes on variables will be forgotten after the
                 message has been sent.  <u>on-compose-cleanup</u> can be  used  to  perform  other  necessary  cleanup
                 steps.

                 Here   is   an  example  that  injects  a  signature  via  <u>message-inject-tail</u>;  instead  using
                 <u>on-compose-splice</u> to simply inject the file of desire via <b>~&lt;</b> or <b>~&lt;!</b> may be a better approach.

                       define t_ocl {
                         vput ! i cat <a href="file:~/.mysig">~/.mysig</a>
                         if $? -eq 0
                            vput csop message-inject-tail trim-end $i
                         end

                         # Alternatively
                         readctl create <a href="file:~/.mysig">~/.mysig</a>
                         if $? -eq 0
                           readall i
                           if $? -eq 0
                             vput csop message-inject-tail trim-end $i
                           end
                           readctl remove <a href="file:~/.mysig">~/.mysig</a>
                         end
                       }
                       set on-compose-leave=t_ocl

       <u>on-compose-splice</u>, <u>on-compose-splice-shell</u>
                 These hooks run once the normal compose mode is finished, but before the <u>on-compose-leave</u> macro
                 hook is called etc.  Both hooks will be executed in a subprocess, with their input  and  output
                 connected  to  S-nail  such  that  they  can  act as if they would be an interactive user.  The
                 difference in between them is that the latter is a SHELL  command,  whereas  the  former  is  a
                 normal <b>define</b>d macro, but which is restricted to a small set of commands (the <u>verbose</u> output of
                 for example <b>list</b> will indicate said capability).  <b>localopts</b> are enabled for these hooks (in the
                 parent  process),  causing  any  setting  to  be  forgotten  after  the  message has been sent;
                 <u>on-compose-cleanup</u> can be used to perform other cleanup as necessary.

                 During execution of these hooks S-nail will temporarily forget whether it has been  started  in
                 interactive  mode,  (a  restricted  set of) “COMMAND ESCAPES” will always be available, and for
                 guaranteed reproducibilities sake <u>escape</u> and <u>ifs</u> will be set to their  defaults.   The  compose
                 mode  command  <b>~^</b>  has been especially designed for scriptability (via these hooks).  The first
                 line the hook will read on its standard input is the protocol version of said  command  escape,
                 currently “0 0 2”: backward incompatible protocol changes have to be expected.

                 Care  must be taken to avoid deadlocks and other false control flow: if both involved processes
                 wait for more input to happen at the same time, or one does not expect more input but the other
                 is stuck waiting for consumption of its output, etc.  There is no automatic synchronization  of
                 the  hook:  it  will not be stopped automatically just because it, e.g., emits ‘~x’.  The hooks
                 will however receive a termination signal if  the  parent  enters  an  error  condition.   [v15
                 behaviour  may  differ] Protection against and interaction with signals is not yet given; it is
                 likely that in the future these scripts will  be  placed  in  an  isolated  session,  which  is
                 signalled in its entirety as necessary.

                       define ocs_signature {
                         read version
                         echo '~&lt; <a href="file:~/.mysig">~/.mysig</a>' # '~&lt;! fortune pathtofortunefile'
                       }
                       set on-compose-splice=ocs_signature

                       wysh set on-compose-splice-shell=$'\
                         read version;\
                         printf "hello $version!  Headers: ";\
                         echo \'~^header list\';\
                         read status result;\
                         echo "status=$status result=$result";\
                         '

                       define ocsm {
                         read version
                         echo Splice protocol version is $version
                         echo '~^h l'; read hl; vput csop es subs "${hl}" 0 1
                         if "$es" != 2
                           echoerr 'Cannot read header list'; echo '~x'; xit
                         endif
                         if "$hl" !%?case ' cc'
                           echo '~^h i cc "Diet is your &lt;mirr.or&gt;"'; read es;\
                             vput csop es substring "${es}" 0 1
                           if "$es" != 2
                             echoerr 'Cannot insert Cc: header'; echo '~x'
                             # (no xit, macro finishes anyway)
                           endif
                         endif
                       }
                       set on-compose-splice=ocsm

       <u>on-history-addition</u>
                 This  hook  will  be  called  if  an  entry  is about to be added to the <b>history</b> of the MLE, as
                 documented in “On terminal control and line editor”.  It will be called with  three  arguments:
                 the  first is the name of the input context (see <b>bind</b>), the second is either an empty string or
                 the matching <u>history-gabby</u> type, and the third being the complete command  line  to  be  added.
                 The  entry  will  not  be added to history if the hook uses a non-0 <b>return</b>.  [v15 behaviour may
                 differ] A future version will give the expanded command name as the third argument, followed by
                 the tokenized command line as parsed in the remaining arguments, the  first  of  which  is  the
                 original  unexpanded  command  name; i.e., one may do ‘<b>shift</b> 4’ and will then be able to access
                 the positional parameters as usual via <u>*</u>, <u>#</u>, <u>1</u> etc.

       <u>on-main-loop-tick</u>
                 This hook will be called whenever the program's main event loop is about to read the next input
                 line.  Note variable and other changes it performs are not scoped as via <b>localopts</b>!

       <u>on-program-exit</u>
                 This hook will be called when the program exits, whether via <b>exit</b> or <b>quit</b>, or because the  send
                 mode is done.  <b>Note:</b> this runs late and so terminal settings etc. are already teared down.

       <u>on-resend-cleanup</u>
                 [v15 behaviour may differ] Identical to <u>on-compose-cleanup</u>, but is only triggered by <b>resend</b>.

       <u>on-resend-enter</u>
                 [v15  behaviour  may  differ]  Identical  to <u>on-compose-enter</u>, but is only triggered by <b>resend</b>;
                 currently there is no <b>digmsg</b> support, for example.

       <u>page</u>      (Boolean) If set, each message feed through the  command  given  for  <b>pipe</b>  is  followed  by  a
                 formfeed character ‘\f’.

       <u>password-USER@HOST</u>, <u>password-HOST</u>, <u>password</u>
                 [v15-compat]  Variable chain that sets a password, which is used in case none has been given in
                 the protocol and account-specific URL; as a last resort S-nail will ask for a password  on  the
                 user's  terminal  if  the authentication method requires a password.  Specifying passwords in a
                 startup file is generally a security risk; the file should be readable  by  the  invoking  user
                 only.

       <u>password-USER@HOST</u>
                 [no  v15-compat]  (see  the  chain  above  for  [v15-compat])  Set the password for ‘USER’ when
                 connecting to ‘HOST’.  If no such variable is defined for a host, the user will be asked for  a
                 password  on  standard  input.   Specifying passwords in a startup file is generally a security
                 risk; the file should be readable by the invoking user only.

       <u>piperaw</u>   (Boolean) Send messages  to  the  <b>pipe</b>  command  without  performing  MIME  and  character  set
                 conversions.

       <u>pipe-EXTENSION</u>
                 Identical to <u>pipe-TYPE/SUBTYPE</u> except that ‘EXTENSION’ (normalized to lowercase using character
                 mappings  of  the  ASCII  charset)  denotes  a  file  extension, for example ‘xhtml’.  Handlers
                 registered using this method take precedence.

       <u>pipe-TYPE/SUBTYPE</u>
                 A MIME message part identified as ‘TYPE/SUBTYPE’  (case-insensitive,  normalized  to  lowercase
                 using  character  mappings  of  the ASCII charset) is displayed or quoted, its text is filtered
                 through the value of this variable interpreted as a shell command.   Unless  noted  only  parts
                 displayable as inline plain text (see <b>copiousoutput</b>) are covered, other MIME parts will only be
                 considered by and for <b>mimeview</b>.

                 The  special  value  question mark ‘?’ forces interpretation of the message part as plain text,
                 for example ‘set pipe-application/xml=?’.  (This can also be achieved by adding  a  MIME  type-
                 marker  via  <b>mimetype</b>.)  [Option]ally MIME type handlers may be defined via “The Mailcap files”
                 to which should be referred to for documentation of flags like <b>copiousoutput</b>.  Question mark is
                 indeed a trigger character to indicate flags that adjust behaviour and usage of the rest of the
                 value, the shell command, for example:

                       ? set pipe-X/Y='?!++=? vim ${MAILX_FILENAME_TEMPORARY}'

                 ‘*’       The  command  output  can  be  reintegrated  into  this  MUA's   normal   processing:
                           <b>copiousoutput</b>.  Implied when using a plain ‘’.
                 ‘#’       Only use this handler for display, not for quoting a message: <b>x-mailx-noquote</b>.
                 ‘&amp;’       Run  the  command asynchronously, do not wait for the handler to exit: <b>x-mailx-async</b>.
                           The standard output of the command will go to <u>/dev/null</u>.
                 ‘!’       The command must be run on an interactive terminal, the terminal will temporarily  be
                           released for it to run: <b>needsterminal</b>.
                 ‘+’       Request  creation of a zero-sized temporary file, the absolute pathname of which will
                           be  made  accessible   via   the   environment   variable   MAILX_FILENAME_TEMPORARY:
                           <b>x-mailx-tmpfile</b>.   If  given  twice  then  the file will be unlinked automatically by
                           S-nail when the command loop is entered again at latest:  <b>x-mailx-tmpfile-unlink</b>;  it
                           is an error to use automatic deletion in conjunction with <b>x-mailx-async</b>.
                 ‘=’       Normally the MIME part content is passed to the handler via standard input; with this
                           the     data     will    instead    be    written    into    MAILX_FILENAME_TEMPORARY
                           (<b>x-mailx-tmpfile-fill</b>), the creation of which is implied; in order to cause automatic
                           deletion of the temporary file two plus signs ‘++’ still have to be used.
                 ‘t’       Text  type-marker:  display  this  as  normal  plain  text  (for  type-markers:  “The
                           mime.types files”).  Identical to only giving plain ‘?’, implies <b>copiousoutput</b>.
                 ‘h’       [Option]  HTML  type-marker:  display  via  built-in  HTML-to-text  filter.   Implies
                           <b>copiousoutput</b>.
                 ‘?’       To avoid ambiguities with normal shell command content another question mark  can  be
                           used  to forcefully terminate interpretation of remaining characters.  (Any character
                           not in this list will have the same effect.)

                 Some information about the MIME part to be displayed is embedded into the  environment  of  the
                 shell command:

                 MAILX_CONTENT            The  MIME  content-type  of  the  part,  if  known,  the  empty string
                                          otherwise.
                 MAILX_CONTENT_EVIDENCE   If <u>mime-counter-evidence</u> includes the carry-around-bit (2), then  this
                                          will be set to the detected MIME content-type; not only then identical
                                          to MAILX_CONTENT otherwise.
                 MAILX_EXTERNAL_BODY_URL  MIME  parts of type ‘message/external-body access-type=url’ will store
                                          the access URL in this variable, it is empty otherwise.   URL  targets
                                          should not be activated automatically, without supervision.
                 MAILX_FILENAME           The filename, if any is set, the empty string otherwise.
                 MAILX_FILENAME_GENERATED
                                          A random string.
                 MAILX_FILENAME_TEMPORARY
                                          If  temporary  file  creation  has  been requested through the command
                                          prefix this variable will be set and contain the absolute pathname  of
                                          the temporary file.

       <u>pop3-auth-USER@HOST</u>, <u>pop3-auth-HOST</u>, <u>pop3-auth</u>
                 [Option][v15-compat]  Variable  chain  that sets the POP3 authentication method.  Supported are
                 the default ‘plain’, [v15-compat] ‘oauthbearer’ (see “FAQ” entry  “But,  how  about  XOAUTH2  /
                 OAUTHBEARER?”), as well as [v15-compat] ‘external’ and ‘externanon’ for TLS secured connections
                 which  pass  a  client  certificate  via  <u>tls-config-pairs</u>.  There may be the [Option]al method
                 [v15-compat] ‘gssapi’.  ‘externanon’  does  not  need  any  user  credentials,  ‘external’  and
                 ‘gssapi’ need a <u>user</u>, the remains also require a <u>password</u>.  ‘externanon’ solely builds upon the
                 credentials  passed via a client certificate, and is usually the way to go since tested servers
                 do not actually follow RFC 4422, and  fail  if  additional  credentials  are  actually  passed.
                 Unless  <u>pop3-no-apop</u>  is  set  the  ‘plain’  method  will [Option]ally be replaced with APOP if
                 possible (see there).

       <u>pop3-bulk-load-USER@HOST</u>, <u>pop3-bulk-load-HOST</u>, <u>pop3-bulk-load</u>
                 (Boolean)[Option] When accessing a POP3 server S-nail loads the headers of  the  messages,  and
                 only  requests  the  message bodies on user request.  For the POP3 protocol this means that the
                 message headers will be downloaded twice.  If this variable is set then  S-nail  will  download
                 only complete messages from the given POP3 server(s) instead.

       <u>pop3-keepalive-USER@HOST</u>, <u>pop3-keepalive-HOST</u>, <u>pop3-keepalive</u>
                 [Option]  POP3 servers close the connection after a period of inactivity; the standard requires
                 this to be at least 10 minutes, but practical experience may vary.  Setting this variable to  a
                 numeric  value  greater  than  ‘0’  causes a ‘NOOP’ command to be sent each value seconds if no
                 other operation is performed.

       <u>pop3-no-apop-USER@HOST</u>, <u>pop3-no-apop-HOST</u>, <u>pop3-no-apop</u>
                 (Boolean)[Option] Unless this variable is set the MD5 based ‘APOP’ authentication  method  will
                 be  used instead of a chosen ‘plain’ <u>pop3-auth</u> when connecting to a POP3 server that advertises
                 support.  The advantage of ‘APOP’ is that only a single packet is sent  for  the  user/password
                 tuple.  (Originally also that the password is not sent in clear text over the wire, but for one
                 MD5  does not any longer offer sufficient security, and then today transport is almost ever TLS
                 secured.)  Note that <u>pop3-no-apop-HOST</u> requires [v15-compat].

       <u>pop3-use-starttls-USER@HOST</u>, <u>pop3-use-starttls-HOST</u>, <u>pop3-use-starttls</u>
                 (Boolean)[Option] Causes S-nail to issue a ‘STLS’ command to make an unencrypted  POP3  session
                 TLS  encrypted.   This  functionality  is  not supported by all servers, and is not used if the
                 session is already encrypted by the POP3S method.  Note  that  <u>pop3-use-starttls-HOST</u>  requires
                 [v15-compat].

       <u>posix</u>     (Boolean)  This  flag enables POSIX mode, which changes behaviour of S-nail where that deviates
                 from standardized behaviour.   It  is  automatically  squared  with  the  environment  variable
                 POSIXLY_CORRECT,  changing  the  one will adjust the other.  The following behaviour is covered
                 and enforced by this mechanism:

                 <b>•</b>   In non-interactive mode, any error encountered while loading resource files during  program
                     startup  will  cause  a  program  exit,  whereas  in interactive mode such errors will stop
                     loading of the currently loaded (stack of) file(s, i.e., recursively).  These exits can  be
                     circumvented  on  a  per-command  base by using <b>ignerr</b>, one of the “Command modifiers”, for
                     each command which shall be allowed to fail.
                 <b>•</b>   <b>alternates</b> will replace the list of alternate addresses instead of  appending  to  it.   In
                     addition alternates will only be honoured for any sort of message <b>reply</b>, and for aliases.
                 <b>•</b>   The  variable  inserting “COMMAND ESCAPES” <b>~A</b>, <b>~a</b>, <b>~I</b> and <b>~i</b> will expand embedded character
                     sequences ‘\t’ horizontal tabulator and ‘\n’ line feed.  [v15  behaviour  may  differ]  For
                     compatibility reasons this step will always be performed.
                 <b>•</b>   Reading  in  messages  via  <b>~f</b>  (“COMMAND  ESCAPES”)  will use the ‘type’ not the ‘forward’
                     <b>headerpick</b> selection.
                 <b>•</b>   Upon changing the active <b>folder</b> no summary of <b>headers</b> will be displayed even if  <u>header</u>  is
                     set.
                 <b>•</b>   Setting <u>ignoreeof</u> implies the behaviour described by <u>dot</u>.
                 <b>•</b>   The  variable  <u>keep</u>  is extended to cover any empty mailbox, not only empty “primary system
                     mailbox”es: they will be removed when they are left in empty state otherwise.
                 <b>•</b>   Each command has an exit <u>?</u> and error <u>!</u> status that overwrites that of the last command.  In
                     POSIX mode the program exit status will signal failure regardless unless all messages  were
                     successfully sent out to the <u>mta</u>; also see <u>sendwait</u>.

       <u>print-alternatives</u>
                 (Boolean) When a MIME message part of type ‘multipart/alternative’ is displayed and it contains
                 a  subpart  of  type  ‘text/plain’,  other parts are normally discarded.  Setting this variable
                 causes  all  subparts  to  be  displayed,  just  as  if  the  surrounding  part  was  of   type
                 ‘multipart/mixed’.

       <u>prompt</u>    The  string used as a prompt in interactive mode.  Whenever the variable is evaluated the value
                 is treated as if specified within dollar-single-quotes (see  “Shell-style  argument  quoting”).
                 This  (post-assignment,  i.e.,  second)  expansion can be used to embed status information, for
                 example <u>?</u>, <u>!</u>, <u>account</u> or <u>mailbox-display</u>.

                 In order to embed characters which should not be counted when calculating the visual  width  of
                 the  resulting  string, enclose the characters of interest in a pair of reverse solidus escaped
                 brackets: ‘\[\E[0m\]’; a slot for coloured  prompts  is  also  available  with  the  [Option]al
                 command  <b>colour</b>.   Prompting  may  be  prevented  by  setting this to the null string (aka ‘set
                 noprompt’).

       <u>prompt2</u>   This string is used for secondary prompts, but is otherwise identical to <u>prompt</u>.   The  default
                 is ‘.. ’.

       <u>quiet</u>     (Boolean) Suppresses the printing of the version when first invoked.

       <u>quote</u>     If  set  messages  processed  by  variants  of  <b>followup</b> and <b>reply</b> will start with the original
                 message, lines  of  which  prefixed  by  <u>indentprefix</u>,  taking  into  account  <u>quote-chars</u>  and
                 <u>quote-fold</u>.  No headers will be quoted when set without value or for ‘noheading’, for ‘headers’
                 the  ‘type’  <b>headerpick</b>  selection will be included in the quote, ‘allbodies’ embeds the (body)
                 contents of all MIME parts, and ‘allheaders’ also includes all  headers.   The  quoted  message
                 will  be  enclosed  by  the  expansions  of  <u>quote-inject-head</u> and <u>quote-inject-tail</u>.  Also see
                 <u>quote-add-cc</u>, <u>quote-as-attachment</u> and <b>~Q</b>, one of the “COMMAND ESCAPES”.

       <u>quote-add-cc</u>
                 (Boolean) Whether senders of messages quoted via <b>~Q</b> shall be made members of the carbon  copies
                 ‘Cc:’ list.

       <u>quote-as-attachment</u>
                 (Boolean)  Add  the original message in its entirety as a ‘message/rfc822’ MIME attachment when
                 replying to a message.  Note this works regardless of the setting of <u>quote</u>.

       <u>quote-chars</u>
                 Can be set to a string consisting of non-whitespace ASCII characters which shall be treated  as
                 quotation leaders, the default being ‘&gt;|}:’.

       <u>quote-fold</u>
                 [Option]  Can  be  set  in addition to <u>indentprefix</u>, and creates a more fancy quotation in that
                 leading quotation characters (<u>quote-chars</u>)  are  compressed  and  overlong  lines  are  folded.
                 <u>quote-fold</u>  can  be set to either one, two or three (space separated) numeric values, which are
                 interpreted as the maximum (goal) and the minimum line length, respectively, in a spirit rather
                 equal to the <u><a href="../man1/fmt.1.html">fmt</a></u>(1) program, but line- instead of paragraph-based.  The third value is used  as
                 the  maximum  line  length  instead  of  the first if no better break point can be found; it is
                 ignored unless it is larger than the  minimum  and  smaller  than  the  maximum.   If  not  set
                 explicitly  the minimum will reflect the goal algorithmically.  The goal cannot be smaller than
                 the length of <u>indentprefix</u> plus some additional pad; necessary adjustments take place silently.

       <u>quote-inject-head</u>, <u>quote-inject-tail</u>
                 The strings to put  before  and  after  the  text  of  a  <u>quote</u>d  message,  if  non-empty,  and
                 respectively.   The  former  defaults  to  ‘%f  wrote:\n\n’.  Special format directives will be
                 expanded if possible, and if so configured the output will be folded according  to  <u>quote-fold</u>.
                 Format  specifiers  in the given strings start with a percent sign ‘%’ and expand values of the
                 original message, unless noted otherwise.  Note that names and addresses are not subject to the
                 setting of <u>showto</u>.  Valid format specifiers are:

                 ‘%%’      A plain percent sign.
                 ‘%a’      The address(es) of the sender(s).
                 ‘%d’      The date found in the ‘Date:’ header of  the  message  when  <u>datefield</u>  is  set  (the
                           default),  otherwise  the  date  when  the  message  was received.  Formatting can be
                           controlled  by  assigning   a   <u><a href="../man3/strftime.3.html">strftime</a></u>(3)   format   string   to   <u>datefield</u>   (and
                           <u>datefield-markout-older</u>).
                 ‘%f’      The full name(s) (name and address, as given) of the sender(s).
                 ‘%i’      The ‘Message-ID:’.
                 ‘%n’      The  real  name(s)  of  the  sender(s) if there is one and <u>showname</u> allows usage, the
                           address(es) otherwise.
                 ‘%r’      The senders real name(s) if there is one, the address(es) otherwise.

       <u>r-option-implicit</u>
                 (Boolean) Setting this option evaluates the contents of <u>from</u> (or,  if  that  contains  multiple
                 addresses,  <u>sender</u>)  and passes the results onto the used (file-based) MTA as described for the
                 <b>-r</b> option (empty argument case).

       <u>recipients-in-cc</u>
                 (Boolean) When doing a <b>reply</b>, the original ‘From:’  and  ‘To:’  as  well  as  addressees  which
                 possibly  came  in  via  ‘Reply-To:’ and ‘Mail-Followup-To:’ are by default merged into the new
                 ‘To:’.  If this variable is set a sensitive algorithm tries to place in ‘To:’ only  the  sender
                 of the message being replied to, others are placed in ‘Cc:’.

       <u>record</u>    Unless this variable is defined, no copies of outgoing mail will be saved.  If defined it gives
                 the  pathname,  subject  to  the  usual  “Filename transformations”, of a folder where all new,
                 replied-to or forwarded messages are saved: when saving to this folder fails the message is not
                 sent, but instead <u>save</u>d to DEAD.  The standard defines that relative (fully expanded) paths are
                 to be interpreted relative to the current directory (<b>cwd</b>), to force interpretation relative  to
                 <u>folder</u> <u>outfolder</u> needs to be set in addition.

       <u>record-files</u>
                 (Boolean)  If  this  variable  is  set the meaning of <u>record</u> will be extended to cover messages
                 which target only file and pipe recipients (see <u>expandaddr</u>).   These  address  types  will  not
                 appear in recipient lists unless <u>add-file-recipients</u> is also set.

       <u>record-resent</u>
                 (Boolean)  If  this  variable  is  set the meaning of <u>record</u> will be extended to also cover the
                 <b>resend</b> and <b>Resend</b> commands.

       <u>reply-in-same-charset</u>
                 (Boolean) If this variable is set S-nail first tries to use  the  same  character  set  of  the
                 original  message  for  replies.  If this fails, the mechanism described in “Character sets” is
                 evaluated as usual.

       <u>reply-strings</u>
                 Can be set to a comma-separated list of (case-insensitive according  to  ASCII  rules)  strings
                 which  shall  be  recognized  in  addition  to the built-in strings as ‘Subject:’ reply message
                 indicators – built-in are ‘Re:’, which is mandated by RFC 5322, as well as  the  german  ‘Aw:’,
                 ‘Antw:’, and the ‘Wg:’ which often has been seen in the wild; I.e., the separating colon has to
                 be specified explicitly.

       <u>reply-to</u>  A  list  of addresses to put into the ‘Reply-To:’ field of the message header.  Members of this
                 list are handled as if they were in the <b>alternates</b> list.

       <u>replyto</u>   [Obsolete] Variant of <u>reply-to</u>.

       <u>reply-to-honour</u>
                 Controls whether a ‘Reply-To:’ header is honoured when replying  to  a  message  via  <b>reply</b>  or
                 <b>Lreply</b>.  This is a “quadoption”; if set without a value it defaults to “yes”.

       <u>reply-to-swap-in</u>
                 Standards  like  DKIM and (in conjunction with) DMARC caused many “Mailing lists” to use sender
                 address rewriting in the style of ‘Name via List &lt;list@address&gt;’,  where  the  original  sender
                 address  often  being  placed  in  ‘Reply-To:’.   If  this is set and a ‘Reply-To:’ exists, and
                 consists of only one addressee (!), then that is used in place of the pretended  sender.   This
                 works  independently  from  <u>reply-to-honour</u>.   The  optional  value,  a comma-separated list of
                 strings, offers more fine-grained control on when swapping shall be used; for now supported  is
                 <u>mlist</u>, here swapping occurs if the sender is a mailing-list as defined by <b>mlist</b>.

       <u>rfc822-body-from</u><b>_</b>
                 (Boolean)  This  variable can be used to force displaying a so-called ‘From_’ line for messages
                 that are embedded into an envelope mail via  the  ‘message/rfc822’  MIME  mechanism,  for  more
                 visual convenience, also see <u>mbox-rfc4155</u>.

       <u>save</u>      (Boolean) Enable saving of (partial) messages in DEAD upon interrupt or delivery error.

       <u>screen</u>    The  number  of  lines that represents a “screenful” of lines, used in <b>headers</b> summary display,
                 <b>from</b> <b>search</b>ing, message <b>top</b>line display and scrolling via <b>z</b>.   If  this  variable  is  not  set
                 S-nail  falls  back  to a calculation based upon the detected terminal window size and the baud
                 rate: the faster the terminal, the more will be shown.  Overall  screen  dimensions  and  pager
                 usage is influenced by the environment variables COLUMNS and LINES and the variable <u>crt</u>.

       <u>searchheaders</u>
                 (Boolean)  Expand  message  list  specifiers  in the form ‘/x:y’ to all messages containing the
                 substring “y” in the header field ‘x’.  The string search is case insensitive.

       <u>sendcharsets</u>
                 [Option] A comma-separated list of character set names that can be used  in  outgoing  internet
                 mail.   The  value  of  the  variable  <u>charset-8bit</u>  is  automatically appended to this list of
                 character sets.  If no character set conversion capabilities are compiled into S-nail then  the
                 only  supported  charset is <u>ttycharset</u>.  Also see <u>sendcharsets-else-ttycharset</u> and refer to the
                 section “Character sets” for the complete picture of character set conversion in S-nail.

       <u>sendcharsets-else-ttycharset</u>
                 (Boolean)[Option] If this variable is set, but <u>sendcharsets</u> is not,  then  S-nail  acts  as  if
                 <u>sendcharsets</u>  had been set to the value of the variable <u>ttycharset</u>.  In effect this combination
                 passes through the message data in the character set of the current locale encoding:  therefore
                 mail  message  text  will  be  (assumed  to  be) in ISO-8859-1 encoding when send from within a
                 ISO-8859-1 locale, and in UTF-8 encoding when send from within an UTF-8 locale.

                 The 8-bit fallback <u>charset-8bit</u> never comes into play as <u>ttycharset</u> is implicitly assumed to be
                 8-bit and capable to represent all files the user may specify (as is the case when no character
                 set conversion support is  available  in  S-nail  and  the  only  supported  character  set  is
                 <u>ttycharset</u>, see “Character sets”).  This might be a problem for scripts which use the suggested
                 ‘LC_ALL=C’  setting, since in this case the character set is US-ASCII by definition, so that it
                 is better to also override <u>ttycharset</u>, then; and/or do something  like  the  following  in  the
                 resource file:

                       # Avoid ASCII "propagates to 8-bit" when scripting
                       \if ! t &amp;&amp; "$LC_ALL" != C &amp;&amp; "$LC_CTYPE" != C
                         \set sendcharsets-else-ttycharset
                       \end

       <u>sender</u>    An  address  that  is  put into the ‘Sender:’ field of outgoing messages, quoting RFC 5322: the
                 mailbox of the agent responsible for the actual transmission of the message.  This field should
                 normally not be used unless the <u>from</u> field contains more than one address, on which case it  is
                 required.  [v15 behaviour may differ] Please expect automatic management of the <u>from</u> and <u>sender</u>
                 relationship.   Dependent  on  the context this address is handled as if it were in the list of
                 <b>alternates</b>.  Also see <b>-r</b>, <u>r-option-implicit</u>.

       <u>sendmail</u>  [Obsolete] Predecessor of <u>mta</u>.

       <u>sendmail-arguments</u>
                 [Obsolete] Predecessor of <u>mta-arguments</u>.

       <u>sendmail-no-default-arguments</u>
                 [Obsolete](Boolean) Predecessor of <u>mta-no-default-arguments</u>.

       <u>sendmail-progname</u>
                 [Obsolete] Predecessor of <u>mta-argv0</u>.

       <u>sendwait</u>  Sending messages to the chosen <u>mta</u> or to command-pipe receivers (see “On sending mail, and non-
                 interactive mode”) will be performed asynchronously.  This means that only  startup  errors  of
                 the  respective  program will be recognizable, but no delivery errors.  Also, no guarantees can
                 be made as to when the respective program will actually run, as well as to when they will  have
                 produced output.

                 If this variable is set then child program exit is waited for, and its exit status code is used
                 to  decide about success.  Remarks: in conflict with the POSIX standard this variable is built-
                 in to be initially set.  Another difference is that it can have a value, which  is  interpreted
                 as  a  comma-separated  list  of  case-insensitive strings naming specific subsystems for which
                 synchronousness shall be ensured (only).  Possible values are ‘mta’ for <u>mta</u> delivery, and ‘pcc’
                 for command-pipe receivers.

       <u>showlast</u>  (Boolean) This setting causes S-nail to start at the last message instead of the first one when
                 opening a mail folder, as well as with <b>from</b> and <b>headers</b>.

       <u>showname</u>  (Boolean) Causes S-nail to use the sender's real name instead  of  the  plain  address  in  the
                 header field summary and in message specifications.

       <u>showto</u>    (Boolean)  Causes the recipient of the message to be shown in the header summary if the message
                 was sent by the user.

       <u>Sign</u>      The  value  backing  <b>~A</b>,  one  of  the  “COMMAND  ESCAPES”.   Also   see   <u>message-inject-tail</u>,
                 <u>on-compose-leave</u> and <u>on-compose-splice</u>.

       <u>sign</u>      The   value   backing  <b>~a</b>,  one  of  the  “COMMAND  ESCAPES”.   Also  see  <u>message-inject-tail</u>,
                 <u>on-compose-leave</u> and <u>on-compose-splice</u>.

       <u>signature</u>
                 [Obsolete] Please use <u>on-compose-splice</u> or <u>on-compose-splice-shell</u> or <u>on-compose-leave</u> and  (if
                 necessary) <u>message-inject-tail</u> instead!

       <u>skipemptybody</u>
                 (Boolean)  If  an  outgoing  message  has an empty first or only message part, do not send, but
                 discard it, successfully (also see the command line option <b>-E</b>).

       <u>smime-ca-dir</u>, <u>smime-ca-file</u>
                 [Option] Specify the location of trusted CA certificates in PEM (Privacy Enhanced Mail) for the
                 purpose of  verification  of  S/MIME  signed  messages.   <u>tls-ca-dir</u>  documents  the  necessary
                 preparation  steps  to use the former.  The set of CA certificates which are built into the TLS
                 library can be explicitly turned off by setting <u>smime-ca-no-defaults</u>, and  further  fine-tuning
                 is possible via <u>smime-ca-flags</u>.

       <u>smime-ca-flags</u>
                 [Option]  Can  be  used  to  fine-tune  behaviour  of  the X509 CA certificate storage, and the
                 certificate verification that is used.  The actual values and their meanings are documented for
                 <u>tls-ca-flags</u>.

       <u>smime-ca-no-defaults</u>
                 (Boolean)[Option] Do not load the default CA locations that are built  into  the  used  to  TLS
                 library to verify S/MIME signed messages.

       <u>smime-cipher-USER@HOST</u>, <u>smime-cipher</u>
                 [Option]  Specifies  the  cipher  to  use  when  generating  S/MIME encrypted messages (for the
                 specified account).  RFC 5751 mandates a default of ‘aes128’ (AES-128  CBC).   Possible  values
                 are  (case-insensitive  and)  in  decreasing  cipher strength: ‘aes256’ (AES-256 CBC), ‘aes192’
                 (AES-192 CBC), ‘aes128’ (AES-128 CBC), ‘des3’ (DES EDE3 CBC, 168 bits; default if  ‘aes128’  is
                 not available) and ‘des’ (DES CBC, 56 bits).

                 The  actually available cipher algorithms depend on the cryptographic library that S-nail uses.
                 [Option] Support for more cipher algorithms  may  be  available  through  dynamic  loading  via
                 <u><a href="../man3/EVP_get_cipherbyname.3.html">EVP_get_cipherbyname</a></u>(3) (OpenSSL) if S-nail has been compiled to support this.

       <u>smime-crl-dir</u>
                 [Option]  Specifies  a  directory  that  contains  files  with  CRLs  in PEM format to use when
                 verifying S/MIME messages.

       <u>smime-crl-file</u>
                 [Option] Specifies a file that contains a CRL in  PEM  format  to  use  when  verifying  S/MIME
                 messages.

       <u>smime-encrypt-USER@HOST</u>
                 [Option]  If  this  variable  is  set, messages send to the given receiver are encrypted before
                 sending.  The value of the variable must be  set  to  the  name  of  a  file  that  contains  a
                 certificate in PEM format.

                 If  a message is sent to multiple recipients, each of them for whom a corresponding variable is
                 set will receive an individually encrypted message; other recipients will continue  to  receive
                 the message in plain text unless the <u>smime-force-encryption</u> variable is set.  It is recommended
                 to    sign    encrypted    messages,    i.e.,    to   also   set   the   <u>smime-sign</u>   variable.
                 <u>content-description-smime-message</u> will be inspected for messages which become encrypted.

       <u>smime-force-encryption</u>
                 (Boolean)[Option] Causes S-nail to refuse sending unencrypted messages.

       <u>smime-sign</u>
                 (Boolean)[Option] S/MIME sign outgoing messages with the user's (<u>from</u>) private key and  include
                 the  users  certificate  as a MIME attachment.  Signing a message enables a recipient to verify
                 that the sender used a valid certificate, that the email addresses  in  the  certificate  match
                 those  in  the  message  header and that the message content has not been altered.  It does not
                 change  the  message  text,  and  people  will  be  able  to  read  the   message   as   usual.
                 <u>content-description-smime-signature</u>    will    be   inspected.    Also   see   <u>smime-sign-cert</u>,
                 <u>smime-sign-include-certs</u> and <u>smime-sign-digest</u>.

       <u>smime-sign-cert-USER@HOST</u>, <u>smime-sign-cert</u>
                 [Option] Points to a file in PEM format.  For the purpose of signing and decryption  this  file
                 needs to contain the user's private key, followed by his certificate.

                 For  message signing ‘USER@HOST’ is always derived from the value of <u>from</u> (or, if that contains
                 multiple addresses, <u>sender</u>).  For the purpose of encryption the  recipients  public  encryption
                 key  (certificate) is expected; the command <b>certsave</b> can be used to save certificates of signed
                 messages (the section “Signed and encrypted messages with S/MIME” gives  some  details).   This
                 mode of operation is usually driven by the specialized form.

                 When  decrypting messages the account is derived from the recipient fields (‘To:’ and ‘Cc:’) of
                 the message, which are searched for addresses for which such a variable is set.  S-nail  always
                 uses  the  first  address  that matches, so if the same message is sent to more than one of the
                 user addresses using different encryption keys, decryption might fail.

                 Password-encrypted keys may be used for signing and decryption.  Automated password  lookup  is
                 possible   via   the   “pseudo-hosts”  ‘<a href="mailto:USER@HOST.smime-cert-key">USER@HOST.smime-cert-key</a>’  for  the  private  key,  and
                 ‘<a href="mailto:USER@HOST.smime-cert-cert">USER@HOST.smime-cert-cert</a>’ for the certificate stored in the  same  file.   For  example,  the
                 hypothetical  address ‘<a href="mailto:bob@exam.ple">bob@exam.ple</a>’ could be driven with a private key / certificate pair path
                 defined in <u><a href="mailto:smime-sign-cert-bob@exam.ple">smime-sign-cert-bob@exam.ple</a></u>, and the needed passwords would then be  looked  up  as
                 ‘<a href="mailto:bob@exam.ple.smime-cert-key">bob@exam.ple.smime-cert-key</a>’ and ‘<a href="mailto:bob@exam.ple.smime-cert-cert">bob@exam.ple.smime-cert-cert</a>’.  When decrypting the value of
                 <u>from</u> will be tried as a fallback to provide the necessary ‘USER@HOST’.  To include intermediate
                 certificates,  use  <u>smime-sign-include-certs</u>.   The possible password sources are documented in
                 “On URL syntax and credential lookup”.

       <u>smime-sign-digest-USER@HOST</u>, <u>smime-sign-digest</u>
                 [Option] Specifies the message digest to use when signing  S/MIME  messages.   Please  remember
                 that  for  this use case ‘USER@HOST’ refers to the variable <u>from</u> (or, if that contains multiple
                 addresses, <u>sender</u>).  The available algorithms depend on the used cryptographic library, but  at
                 least one usable built-in algorithm is ensured as a default.  If possible the standard RFC 5751
                 will  be  violated  by  using ‘SHA512’ instead of the mandated ‘SHA1’ due to security concerns.
                 This variable is ignored for very old (released before 2010) cryptographic libraries  which  do
                 not offer the necessary interface: it will be logged if that happened.

                 S-nail  will  try  to  add  built-in support for the following message digests, names are case-
                 insensitive: ‘BLAKE2b512’, ‘BLAKE2s256’, ‘SHA3-512’,  ‘SHA3-384’,  ‘SHA3-256’,  ‘SHA3-224’,  as
                 well  as the widely available ‘SHA512’, ‘SHA384’, ‘SHA256’, ‘SHA224’, and the proposed insecure
                 ‘SHA1’, finally ‘MD5’.  More digests may [Option]ally be available through dynamic loading  via
                 the OpenSSL function <u><a href="../man3/EVP_get_digestbyname.3.html">EVP_get_digestbyname</a></u>(3).

       <u>smime-sign-include-certs-USER@HOST</u>, <u>smime-sign-include-certs</u>
                 [Option]  If  used,  this  is supposed to a consist of a comma-separated list of files, each of
                 which containing a single certificate in PEM format to be included in  the  S/MIME  message  in
                 addition  to  the  <u>smime-sign-cert</u>  certificate.   This  can  be  used  to include intermediate
                 certificates  of  the  certificate  authority,  in  order  to  allow  the   receiver's   S/MIME
                 implementation to perform a verification of the entire certificate chain, starting from a local
                 root certificate, over the intermediate certificates, down to the <u>smime-sign-cert</u>.  Even though
                 top  level  certificates  may  also  be  included  in  the chain, they will not be used for the
                 verification on the receiver's side.

                 For the purpose of the mechanisms involved here, ‘USER@HOST’  refers  to  the  content  of  the
                 internal  variable  <u>from</u>  (or,  if  that contains multiple addresses, <u>sender</u>).  The pseudo-host
                 ‘<a href="mailto:USER@HOST.smime-include-certs">USER@HOST.smime-include-certs</a>’  will  be  used  for  performing  password  lookups  for  these
                 certificates,  shall  they  have  been given one, therefore the lookup can be automated via the
                 mechanisms described in “On URL syntax and credential lookup”.

       <u>smime-sign-message-digest-USER@HOST</u>, <u>smime-sign-message-digest</u>
                 [Obsolete][Option] Predecessor(s) of <u>smime-sign-digest</u>.

       <u>smtp</u>      [Obsolete][Option] To use the built-in SMTP  transport,  specify  a  SMTP  URL  in  <u>mta</u>.   [v15
                 behaviour may differ] For compatibility reasons a set <u>smtp</u> is used in preference of <u>mta</u>.

       <u>smtp-auth-USER@HOST</u>, <u>smtp-auth-HOST</u>, <u>smtp-auth</u>
                 [Option]  Variable  chain that controls the SMTP <u>mta</u> authentication method, possible values are
                 ‘none’  ([no  v15-compat]  default),  ‘plain’  ([v15-compat]  default),  ‘login’,  [v15-compat]
                 ‘oauthbearer’ (see “FAQ” entry “But, how about XOAUTH2 / OAUTHBEARER?”) as well as [v15-compat]
                 ‘external’  and  ‘externanon’  for  TLS secured connections which pass a client certificate via
                 <u>tls-config-pairs</u>.  There may be the [Option]al methods ‘cram-md5’  and  ‘gssapi’.   ‘none’  and
                 ‘externanon’ do not need any user credentials, ‘external’ and ‘gssapi’ require a user name, and
                 all  other  methods  require  a  <u>user</u> name and a <u>password</u>.  ‘externanon’ solely builds upon the
                 credentials passed via a client certificate, and is usually the way to go since tested  servers
                 do  not  actually  follow RFC 4422 aka RFC 4954, and fail if additional credentials are passed.
                 Also  see  <u>mta</u>.   Note  that  <u>smtp-auth-HOST</u>  is  [v15-compat].   ([no   v15-compat]   Requires
                 <u>smtp-auth-password</u> and <u>smtp-auth-user</u>.  Note for <u>smtp-auth-USER@HOST</u>: may override dependent on
                 sender address in the variable <u>from</u>.)

       <u>smtp-auth-password</u>
                 [Option][no  v15-compat]  Sets  the  global  fallback password for SMTP authentication.  If the
                 authentication method requires a  password,  but  neither  <u>smtp-auth-password</u>  nor  a  matching
                 <u>smtp-auth-password-USER@HOST</u>  can  be  found,  S-nail  will  ask  for  a password on the user's
                 terminal.

       <u>smtp-auth-password-USER@HOST</u>
                 [no v15-compat] Overrides <u>smtp-auth-password</u> for specific values of sender addresses, dependent
                 upon the variable <u>from</u>.

       <u>smtp-auth-user</u>
                 [Option][no v15-compat] Sets the global fallback user name for  SMTP  authentication.   If  the
                 authentication  method  requires  a  user  name,  but  neither  <u>smtp-auth-user</u>  nor  a matching
                 <u>smtp-auth-user-USER@HOST</u> can be found, S-nail will ask for a user name on the user's terminal.

       <u>smtp-auth-user-USER@HOST</u>
                 [no v15-compat] Overrides <u>smtp-auth-user</u> for specific values  of  sender  addresses,  dependent
                 upon the variable <u>from</u>.

       <u>smtp-hostname</u>
                 [Option][v15-compat] Normally S-nail uses the variable <u>from</u> to derive the necessary ‘USER@HOST’
                 information  in order to issue a ‘MAIL FROM:&lt;&gt;’ SMTP <u>mta</u> command.  Setting <u>smtp-hostname</u> can be
                 used to use the ‘USER’ from the SMTP account (<u>mta</u> or the <u>user</u> variable  chain)  and  the  given
                 ‘HOST’  (<u>hostname</u>  if the empty string is given, or the local hostname as a last resort).  This
                 often allows using an address that is itself valid but hosted by a  provider  other  than  from
                 which  (in  <u>from</u>)  the  message  is  sent.   Setting  this  variable  also influences generated
                 ‘Message-ID:’ and ‘Content-ID:’ header fields.  If the [Option]al  IDNA  support  is  available
                 (see <u>idna-disable</u>) variable assignment is aborted when a necessary conversion fails.

       <u>smtp-use-starttls-USER@HOST</u>, <u>smtp-use-starttls-HOST</u>, <u>smtp-use-starttls</u>
                 (Boolean)[Option]  Causes  S-nail to issue a ‘STARTTLS’ command to make an SMTP <u>mta</u> session TLS
                 encrypted, i.e., to enable transport layer security.

       <u>socket-connect-timeout</u>
                 [Option] A positive number  that  defines  the  timeout  to  wait  for  establishing  a  socket
                 connection before forcing <u>^ERR</u>-TIMEDOUT.

       <u>socks-proxy-USER@HOST</u>, <u>socks-proxy-HOST</u>, <u>socks-proxy</u>
                 [Option]  If  set to the URL of a SOCKS5 server then all network activities are proxied through
                 it, except for the single DNS name lookup necessary to resolve the proxy URL (unnecessary  when
                 given  an  already  resolved  IP  address).   It  is automatically squared with the environment
                 variable SOCKS5_PROXY, changing the one will adjust the other.  This example  creates  a  local
                 SOCKS5 proxy on port 10000 that forwards to the machine ‘HOST’ (with identity ‘USER’), and from
                 which actual network traffic happens:

                       $ ssh -D 10000 USER@HOST
                       $ s-nail -Ssocks-proxy=[socks5://]localhost:10000
                       # or =localhost:10000; no local DNS: =127.0.0.1:10000

       <u>spam-interface</u>
                 [Option]  In  order  to  use  any of the spam-related commands (like <b>spamrate</b>) the desired spam
                 interface must be defined by setting  this  variable.   Please  refer  to  the  manual  section
                 “Handling  spam”  for  the  complete  picture  of  spam handling in S-nail.  All or none of the
                 following interfaces may be available:

                 ‘spamc’   Interaction    with    <u><a href="../man1/spamc.1.html">spamc</a></u>(1)    from    the     <u><a href="../man1/spamassassin.1.html">spamassassin</a></u>(1)     (<u>SpamAssassin</u>:
                           <a href="http://spamassassin.apache.org">http://spamassassin.apache.org</a>)  suite.   Different  to  the generic filter interface
                           S-nail will automatically add the correct arguments for a given command and  has  the
                           necessary knowledge to parse the program's output.  A default value for <u>spamc-command</u>
                           will  have  been  compiled  into the S-nail binary if <u><a href="../man1/spamc.1.html">spamc</a></u>(1) has been found in PATH
                           during compilation.  Shall it be necessary  to  define  a  specific  connection  type
                           (rather  than  using a configuration file for that), the variable <u>spamc-arguments</u> can
                           be used as in for example ‘-d server.example.com -p 783’.  It  is  also  possible  to
                           specify  a  per-user configuration via <u>spamc-user</u>.  Note that this interface does not
                           inspect the ‘is-spam’ flag of a message for the command <b>spamforget</b>.

                 ‘filter’  generic spam filter support via freely configurable hooks.  This interface  is  meant
                           for  programs  like  <u><a href="../man1/bogofilter.1.html">bogofilter</a></u>(1) and requires according behaviour in respect to the
                           hooks' exit status for at least the command <b>spamrate</b> (‘0’ meaning a message is  spam,
                           ‘1’ for non-spam, ‘2’ for unsure and any other return value indicating a hard error);
                           since  the  hooks  can  include  shell  code  snippets  diverting  behaviour  can  be
                           intercepted  as  necessary.   The   hooks   are   <u>spamfilter-ham</u>,   <u>spamfilter-noham</u>,
                           <u>spamfilter-nospam</u>,  <u>spamfilter-rate</u> and <u>spamfilter-spam</u>; the manual section “Handling
                           spam” contains examples for some programs.  The process environment of the hooks will
                           have the variable MAILX_FILENAME_GENERATED set.  Note that  spam  score  support  for
                           <b>spamrate</b>  is  not  supported  unless the [Option]tional regular expression support is
                           available and the <u>spamfilter-rate-scanscore</u> variable is set.

       <u>spam-maxsize</u>
                 [Option] Messages that  exceed  this  size  will  not  be  passed  through  to  the  configured
                 <u>spam-interface</u>.  If unset or 0, the default of 420000 bytes is used.

       <u>spamc-command</u>
                 [Option]  The  path to the <u><a href="../man1/spamc.1.html">spamc</a></u>(1) program for the ‘spamc’ <u>spam-interface</u>.  Note that the path
                 is not expanded, but used “as is”.  A fallback path will have been  compiled  into  the  S-nail
                 binary if the executable had been found during compilation.

       <u>spamc-arguments</u>
                 [Option]  Even  though  S-nail  deals  with  most  arguments  for  the  ‘spamc’  <u>spam-interface</u>
                 automatically, it may at least sometimes be desirable to specify  connection-related  ones  via
                 this variable, for example ‘-d server.example.com -p 783’.

       <u>spamc-user</u>
                 [Option]  Specify  a  username for per-user configuration files for the ‘spamc’ <u>spam-interface</u>.
                 If this is set to the empty string then S-nail will use the name of the current <u>user</u>.

       <u>spamfilter-ham</u>, <u>spamfilter-noham</u>, <u>spamfilter-nospam</u>, <u>spamfilter-rate</u>, <u>spamfilter-spam</u>
                 [Option] Command and argument hooks  for  the  ‘filter’  <u>spam-interface</u>.   The  manual  section
                 “Handling spam” contains examples for some programs.

       <u>spamfilter-rate-scanscore</u>
                 [Option]  Because  of  the  generic  nature  of the ‘filter’ <u>spam-interface</u> spam scores are not
                 supported for it by default, but if the [Option]nal regular  expression  support  is  available
                 then  setting  this  variable  can  be used to overcome this restriction.  It is interpreted as
                 follows: first a number (digits) is parsed that must be followed by  a  semicolon  ‘;’  and  an
                 extended  regular  expression.   Then  the latter is used to parse the first output line of the
                 <u>spamfilter-rate</u> hook, and, in case the evaluation  is  successful,  the  group  that  has  been
                 specified via the number is interpreted as a floating point scan score.

       <u>ssl-ca-dir-USER@HOST</u>, <u>ssl-ca-dir-HOST</u>, <u>ssl-ca-dir</u>, <u>ssl-ca-file-USER@HOST</u>, <u>ssl-ca-file-HOST</u>, <u>ssl-ca-file</u>
                 [Obsolete][Option] Predecessors of <u>tls-ca-file</u>, <u>tls-ca-dir</u>.

       <u>ssl-ca-flags-USER@HOST</u>, <u>ssl-ca-flags-HOST</u>, <u>ssl-ca-flags</u>
                 [Obsolete][Option] Predecessor of <u>tls-ca-flags</u>.

       <u>ssl-ca-no-defaults-USER@HOST</u>, <u>ssl-ca-no-defaults-HOST</u>, <u>ssl-ca-no-defaults</u>
                 [Obsolete](Boolean)[Option] Predecessor of <u>tls-ca-no-defaults</u>.

       <u>ssl-cert-USER@HOST</u>, <u>ssl-cert-HOST</u>, <u>ssl-cert</u>
                 [Obsolete][Option] Please use the <b>Certificate</b> slot of <u>tls-config-pairs</u>.

       <u>ssl-cipher-list-USER@HOST</u>, <u>ssl-cipher-list-HOST</u>, <u>ssl-cipher-list</u>
                 [Obsolete][Option] Please use the <b>CipherString</b> slot of <u>tls-config-pairs</u>.

       <u>ssl-config-file</u>
                 [Obsolete][Option] Predecessor of <u>tls-config-file</u>.

       <u>ssl-config-module-USER@HOST</u>, <u>ssl-config-module-HOST</u>, <u>ssl-config-module</u>
                 [Obsolete][Option] Predecessor of <u>tls-config-module</u>.

       <u>ssl-config-pairs-USER@HOST</u>, <u>ssl-config-pairs-HOST</u>, <u>ssl-config-pairs</u>
                 [Obsolete][Option] Predecessor of <u>tls-config-pairs</u>.

       <u>ssl-crl-dir</u>, <u>ssl-crl-file</u>
                 [Obsolete][Option] Predecessors of <u>tls-crl-dir</u>, <u>tls-crl-file</u>.

       <u>ssl-curves-USER@HOST</u>, <u>ssl-curves-HOST</u>, <u>ssl-curves</u>
                 [Obsolete][Option] Please use the <b>Curves</b> slot of <u>tls-config-pairs</u>.

       <u>ssl-features</u>
                 [Obsolete][Option](Read-only) Predecessor of <u>tls-features</u>.

       <u>ssl-key-USER@HOST</u>, <u>ssl-key-HOST</u>, <u>ssl-key</u>
                 [Obsolete][Option] Please use the <b>PrivateKey</b> slot of <u>tls-config-pairs</u>.

       <u>ssl-method-USER@HOST</u>, <u>ssl-method-HOST</u>, <u>ssl-method</u>
                 [Obsolete][Option] Please use the <b>Protocol</b> slot of <u>tls-config-pairs</u>.

       <u>ssl-protocol-USER@HOST</u>, <u>ssl-protocol-HOST</u>, <u>ssl-protocol</u>
                 [Obsolete][Option] Please use the <b>Protocol</b> slot of <u>tls-config-pairs</u>.

       <u>ssl-rand-file</u>
                 [Obsolete][Option] Predecessor of <u>tls-rand-file</u>.

       <u>ssl-verify-USER@HOST</u>, <u>ssl-verify-HOST</u>, <u>ssl-verify</u>
                 [Obsolete][Option] Predecessor of <u>tls-verify</u>.

       <u>stealthmua</u>
                 If  only  set  without  an  assigned  value,  then  this setting inhibits the generation of the
                 ‘Message-ID:’, ‘Content-ID:’ and ‘User-Agent:’ header fields that include obvious references to
                 S-nail.  There are two pitfalls associated  with  this:  First,  the  message  id  of  outgoing
                 messages  is  not  known anymore.  Second, an expert may still use the remaining information in
                 the header to track down the originating mail user agent.  If set to the value ‘noagent’,  then
                 the mentioned ‘Message-ID:’ and ‘Content-ID:’ suppression does not occur.

       <u>system-mailrc</u>
                 (Read-only)  The  compiled  in path of the system wide initialization file one of the “Resource
                 files”: <u>s-nail.rc</u>.

       <u>termcap</u>   ([Option]) This specifies a comma-separated list of Terminal Information Library  (libterminfo,
                 -lterminfo)  and/or  Termcap  Access  Library  (libtermcap,  -ltermcap)  capabilities  (see “On
                 terminal control and line editor”, escape commas with  reverse  solidus  ‘\’)  to  be  used  to
                 overwrite  or  define entries.  <b>Note</b> this variable will only be queried once at program startup
                 and can thus only be specified in resource files or on the command line.   It  will  always  be
                 inspected,  regardless  of  whether  <u>features</u>  denotes  termcap/terminfo  library  support  via
                 ‘,+termcap,’.

                 String capabilities form ‘cap=value’ pairs and are expected unless noted  otherwise.   Numerics
                 have  to  be  notated  as ‘cap#number’ where the number is expected in normal decimal notation.
                 Finally, booleans do not have any value but indicate a true or  false  state  simply  by  being
                 defined  or not; this indeed means that S-nail does not support undefining an existing boolean.
                 String capability values will undergo some  expansions  before  use:  for  one  notations  like
                 ‘^LETTER’  stand  for  ‘control-LETTER’,  and  for  clarification  purposes ‘\E’ can be used to
                 specify ‘escape’ (the control notation ‘^[’ could lead  to  misreadings  when  a  left  bracket
                 follows, which it does for the standard CSI sequence); finally three letter octal sequences, as
                 in  ‘\061’,  are  supported.   To  specify  that a terminal supports 256-colours, and to define
                 sequences that home the cursor and produce an audible bell, one might write:

                       ? set termcap='Co#256,home=\E[H,bel=^G'

                 The following terminal capabilities are or may be meaningful for the operation of the  built-in
                 line editor or S-nail in general:

                 <b>am</b>        <b>auto_right_margin</b>:  boolean  which  indicates  if  the  right  margin  needs  special
                           treatment; the <b>xenl</b> capability is related, for more see COLUMNS.  This capability  is
                           only used when backed by library support.
                 <b>clear</b> or <b>cl</b>
                           <b>clear_screen</b>: clear the screen and home cursor.  (Will be simulated via <b>ho</b> plus <b>cd</b>.)
                 <b>colors</b> or <b>Co</b>
                           <b>max_colors</b>:  numeric  capability specifying the maximum number of colours.  Note that
                           S-nail does not actually care about the terminal beside that, but always emits ANSI /
                           ISO 6429 escape sequences; also see <b>colour</b>.
                 <b>cr</b>        <b>carriage_return</b>: move to the first column in the current row.  The  default  built-in
                           fallback is ‘\r’.
                 <b>cub1</b> or <b>le</b>
                           <b>cursor_left</b>:  move the cursor left one space (non-destructively).  The default built-
                           in fallback is ‘\b’.
                 <b>cuf1</b> or <b>nd</b>
                           <b>cursor_right</b>: move the cursor  right  one  space  (non-destructively).   The  default
                           built-in fallback is ‘\E[C’, which is used by most terminals.  Less often occur ‘\EC’
                           and ‘\EOC’.
                 <b>ed</b> or <b>cd</b>  <b>clr_eos</b>: clear the screen.
                 <b>el</b> or <b>ce</b>  <b>clr_eol</b>:  clear  to  the  end of line.  (Will be simulated via <b>ch</b> plus repetitions of
                           space characters.)
                 <b>home</b> or <b>ho</b>
                           <b>cursor_home</b>: home cursor.
                 <b>hpa</b> or <b>ch</b>
                           <b>column_address</b>: move the cursor (to the given column parameter) in the  current  row.
                           (Will be simulated via <b>cr</b> plus <b>nd</b>.)
                 <b>rmcup</b> or <b>te</b> / <b>smcup</b> or <b>ti</b>
                           <b>exit_ca_mode</b>  and  <b>enter_ca_mode</b>, respectively: exit and enter the alternative screen
                           ca-mode, effectively turning S-nail into a  fullscreen  application.   This  must  be
                           enabled explicitly by setting <u>termcap-ca-mode</u>.
                 <b>smkx</b> or <b>ks</b> / <b>rmkx</b> or <b>ke</b>
                           <b>keypad_xmit</b>  and  <b>keypad_local</b>, respectively: enable and disable the keypad.  This is
                           always enabled if available, because it seems even keyboards without keypads generate
                           other key codes for, e.g., cursor keys in that case, and only if enabled we  see  the
                           codes that we are interested in.
                 <b>xenl</b> or <b>xn</b>
                           <b>eat_newline_glitch</b>:  boolean  which  indicates  whether a newline written in the last
                           column of an <b>auto_right_margin</b> indicating terminal is  ignored.   With  it  the  full
                           terminal  width is available even on autowrap terminals.  This will be inspected even
                           without ‘,+termcap,’ <u>features</u>.

                 Many more capabilities which describe key-sequences are documented for <b>bind</b>.

       <u>termcap-ca-mode</u>
                 [Option] Allow usage of the <b>exit_ca_mode</b> and <b>enter_ca_mode</b> <u>termcap</u>abilities in order  to  enter
                 an  alternative  exclusive  screen,  the  so-called  ca-mode;  this  usually  requires  special
                 configuration of the PAGER, also dependent on the value of <u>crt</u>.  <b>Note</b> this variable  will  only
                 be  queried  once at program startup and can thus only be specified in resource files or on the
                 command line.

       <u>termcap-disable</u>
                 [Option] Disable any interaction with a terminal control library.  If  set  only  some  generic
                 fallback  built-ins  and possibly the content of <u>termcap</u> describe the terminal to S-nail.  <b>Note</b>
                 this variable will only be queried once at program startup and can thus only  be  specified  in
                 resource files or on the command line.

       <u>tls-ca-dir-USER@HOST</u>, <u>tls-ca-dir-HOST</u>, <u>tls-ca-dir</u>, <u>tls-ca-file-USER@HOST</u>, <u>tls-ca-file-HOST</u>, <u>tls-ca-file</u>
                 [Option] Directory and file, respectively, for pools of trusted CA certificates in PEM (Privacy
                 Enhanced  Mail) format, for the purpose of verification of TLS server certificates.  Concurrent
                 use is possible, the file is loaded once needed first, the directory lookup is  performed  anew
                 as a last resort whenever necessary.  The CA certificate pool built into the TLS library can be
                 disabled  via  <u>tls-ca-no-defaults</u>,  further  fine-tuning  is  possible  via  <u>tls-ca-flags</u>.  The
                 directory     search     requires     special     filename     conventions,     please      see
                 <u><a href="../man3/SSL_CTX_load_verify_locations.3.html">SSL_CTX_load_verify_locations</a></u>(3) and <u><a href="../man1/verify.1.html">verify</a></u>(1) (or <u><a href="../man1/c_rehash.1.html">c_rehash</a></u>(1)).

       <u>tls-ca-flags-USER@HOST</u>, <u>tls-ca-flags-HOST</u>, <u>tls-ca-flags</u>
                 [Option]  Can  be  used  to  fine-tune  behaviour  of  the X509 CA certificate storage, and the
                 certificate verification that is used (also see <u>tls-verify</u>).  The value is expected to  consist
                 of  a  comma-separated  list of configuration directives, with any intervening whitespace being
                 ignored.  The directives directly map to flags that can be passed  to  <u><a href="../man3/X509_STORE_set_flags.3.html">X509_STORE_set_flags</a></u>(3),
                 which  are  usually defined in a file <u>openssl/x509_vfy.h</u>, and the availability of which depends
                 on the used TLS library version: a directive without mapping is ignored (error log  subject  to
                 <u>debug</u>).  Directives currently understood (case-insensitively) include:

                 <b>no-alt-chains</b>
                           If  the  initial  chain is not trusted, do not attempt to build an alternative chain.
                           Setting this flag will make OpenSSL certificate  verification  match  that  of  older
                           OpenSSL  versions,  before  automatic building and checking of alternative chains has
                           been implemented; also see <b>trusted-first</b>.
                 <b>no-check-time</b>
                           Do not check certificate/CRL validity against current time.
                 <b>partial-chain</b>
                           By default partial, incomplete chains which cannot be verified up to the chain top, a
                           self-signed root certificate, will not verify.  With this flag set, a chain  succeeds
                           to  verify  if  at  least  one  signing  certificate  of  the  chain is in any of the
                           configured  trusted  stores  of   CA   certificates.    The   OpenSSL   manual   page
                           <u><a href="../man3/SSL_CTX_load_verify_locations.3.html">SSL_CTX_load_verify_locations</a></u>(3)  gives  some  advise  how to manage your own trusted
                           store of CA certificates.
                 <b>strict</b>    Disable workarounds for broken certificates.
                 <b>trusted-first</b>
                           Try building a chain using issuers in the trusted store first to avoid problems  with
                           server-sent  legacy  intermediate  certificates.   Newer  versions of OpenSSL support
                           alternative chain checking and enable it by default, resulting in the same behaviour;
                           also see <b>no-alt-chains</b>.

       <u>tls-ca-no-defaults-USER@HOST</u>, <u>tls-ca-no-defaults-HOST</u>, <u>tls-ca-no-defaults</u>
                 (Boolean)[Option] Do not load the default CA locations that are built  into  the  used  to  TLS
                 library to verify TLS server certificates.

       <u>tls-config-file</u>
                 [Option]    If   this   variable   is   set   <u><a href="../man3/CONF_modules_load_file.3.html">CONF_modules_load_file</a></u>(3)   (if   announced   via
                 ‘,+modules-load-file,’ in <u>tls-features</u>) is used to allow resource file based  configuration  of
                 the  TLS  library.  This happens once the library is used first, which may also be early during
                 startup (logged with <u>verbose</u>)!  If a non-empty value  is  given  then  the  given  file,  after
                 performing  “Filename  transformations”,  will  be  used  instead  of  the TLS libraries global
                 default, and it is an error if the file cannot be loaded.  The application name will always  be
                 passed as ‘s-nail’.  Some TLS libraries support application-specific configuration via resource
                 files loaded like this, please see <u>tls-config-module</u>.

       <u>tls-config-module-USER@HOST</u>, <u>tls-config-module-HOST</u>, <u>tls-config-module</u>
                 [Option]  If  file  based  application-specific configuration via <u>tls-config-file</u> is available,
                 announced as ‘,+ctx-config,’ by <u>tls-features</u>,  indicating  availability  of  <u><a href="../man3/SSL_CTX_config.3.html">SSL_CTX_config</a></u>(3),
                 then,  it  becomes possible to use a central TLS configuration file for all programs, including
                 s-nail, for example

                       # Register a configuration section for s-nail
                       s-nail = mailx_master
                       # The top configuration section creates a relation
                       # in between dynamic SSL configuration and an actual
                       # program specific configuration section
                       [mailx_master]
                       ssl_conf = mailx_tls_config
                       # And that program specific configuration section now
                       # can map diverse tls-config-module names to sections,
                       # as in: tls-config-module=account_xy
                       [mailx_tls_config]
                       account_xy = mailx_account_xy
                       account_yz = mailx_account_yz
                       [mailx_account_xy]
                       MinProtocol = TLSv1.2
                       Curves=P-521
                       [mailx_account_yz]
                       CipherString = TLSv1.2:!aNULL:!eNULL:
                       MinProtocol = TLSv1.1
                       Options = Bugs

       <u>tls-config-pairs-USER@HOST</u>, <u>tls-config-pairs-HOST</u>, <u>tls-config-pairs</u>
                 [Option] The value of this variable chain will be interpreted  as  a  comma-separated  list  of
                 directive/value  pairs.   Directives  and  values need to be separated by equals signs ‘=’, any
                 whitespace  surrounding  pair  members  is  removed.   Keys  are  (usually)   case-insensitive.
                 Different  to  when  placing  these  pairs in a <u>tls-config-module</u> section of a <u>tls-config-file</u>,
                 commas ‘,’ need to be escaped  with  a  reverse  solidus  ‘\’  when  included  in  pairs;  also
                 different:  if  the equals sign ‘=’ is preceded with an asterisk ‘*’ “Filename transformations”
                 will be performed on the value; it is an  error  if  these  fail.   Unless  proper  support  is
                 announced  by  <u>tls-features</u>  (‘,+conf-ctx,’)  only  the keys below are supported, otherwise the
                 pairs will be used directly as arguments to the function <u><a href="../man3/SSL_CONF_cmd.3.html">SSL_CONF_cmd</a></u>(3).

                 <b>Certificate</b>   Filename of a TLS client certificate (chain) required by some servers.   Fallback
                               support  via  <u><a href="../man3/SSL_CTX_use_certificate_chain_file.3.html">SSL_CTX_use_certificate_chain_file</a></u>(3).   “Filename transformations”
                               are performed.  <b>PrivateKey</b> will be set to  the  same  value  if  not  initialized
                               explicitly.   Some  services support so-called ‘external’ authentication if a TLS
                               client certificate was successfully  presented  during  connection  establishment
                               (“connecting is authenticating”).
                 <b>CipherString</b>  A  list  of  ciphers  for TLS connections, see <u><a href="../man1/ciphers.1.html">ciphers</a></u>(1).  By default no list of
                               ciphers is set, resulting in a <b>Protocol</b>-specific list of  ciphers  (the  protocol
                               standards  define  lists  of acceptable ciphers; possibly cramped by the used TLS
                               library).  Fallback support via <u><a href="../man3/SSL_CTX_set_cipher_list.3.html">SSL_CTX_set_cipher_list</a></u>(3).
                 <b>Ciphersuites</b>  A list of ciphers used for TLSv1.3 connections, see <u><a href="../man1/ciphers.1.html">ciphers</a></u>(1).   These  will  be
                               joined  onto  the  list  of ciphers from <b>CipherString</b>.  Available if <u>tls-features</u>
                               announces        ‘,+ctx-set-ciphersuites,’,        as        necessary        via
                               <u><a href="../man3/SSL_CTX_set_ciphersuites.3.html">SSL_CTX_set_ciphersuites</a></u>(3).
                 <b>Curves</b>        A  list  of  supported  elliptic curves, if applicable.  By default no curves are
                               set.  Fallback support via <u><a href="../man3/SSL_CTX_set1_curves_list.3.html">SSL_CTX_set1_curves_list</a></u>(3), if available.
                 <b>MaxProtocol</b>, <b>MinProtocol</b>
                               The maximum and minimum  supported  TLS  versions,  respectively.   Available  if
                               <u>tls-features</u>    announces    ‘,+ctx-set-maxmin-proto,’,    as    necessary    via
                               <u><a href="../man3/SSL_CTX_set_max_proto_version.3.html">SSL_CTX_set_max_proto_version</a></u>(3)  and   <u><a href="../man3/SSL_CTX_set_min_proto_version.3.html">SSL_CTX_set_min_proto_version</a></u>(3);   these
                               fallbacks  use an internal parser which understands the strings ‘SSLv3’, ‘TLSv1’,
                               ‘TLSv1.1’, ‘TLSv1.2’, ‘TLSv1.3’, and the special value ‘None’, which disables the
                               given limit.
                 <b>Options</b>       Various flags to set.  Fallback via <u><a href="../man3/SSL_CTX_set_options.3.html">SSL_CTX_set_options</a></u>(3),  in  which  case  any
                               other value but (exactly) ‘Bugs’ results in an error.
                 <b>PrivateKey</b>    Filename of the private key in PEM format of a TLS client certificate.  If unset,
                               the  value  of  <b>Certificate</b>  is  used.  “Filename transformations” are performed.
                               Fallback via <u><a href="../man3/SSL_CTX_use_PrivateKey_file.3.html">SSL_CTX_use_PrivateKey_file</a></u>(3).
                 <b>Protocol</b>      The  used   TLS   protocol.    If   <u>tls-features</u>   announces   ‘,+conf-ctx,’   or
                               ‘ctx-set-maxmin-proto’  then  using  <b>MaxProtocol</b>  and  <b>MinProtocol</b> is preferable.
                               Fallback  is  <u><a href="../man3/SSL_CTX_set_options.3.html">SSL_CTX_set_options</a></u>(3),  driven  via  an  internal   parser   which
                               understands  the  strings  ‘SSLv3’, ‘TLSv1’, ‘TLSv1.1’, ‘TLSv1.2’, ‘TLSv1.3’, and
                               the special value ‘ALL’.  Multiple protocols may be given  as  a  comma-separated
                               list,  any  whitespace  is  ignored,  an optional plus sign ‘+’ prefix enables, a
                               hyphen-minus ‘-’ prefix disables a protocol, so that ‘-ALL, TLSv1.2’ enables only
                               the TLSv1.2 protocol.

       <u>tls-crl-dir</u>, <u>tls-crl-file</u>
                 [Option] Specify a directory / a file, respectively, that contains a CRL in PEM format  to  use
                 when verifying TLS server certificates.

       <u>tls-features</u>
                 [Option](Read-only)  This  expands  to  a  comma-separated list of the TLS library identity and
                 optional features.  To ease substring matching  the  string  starts  and  ends  with  a  comma.
                 Currently  supported  identities  are  ‘libressl’ (LibreSSL) , ‘libssl-0x30000’ (OpenSSL v3.0.0
                 series), ‘libssl-0x10100’ (OpenSSL v1.1.x series) and ‘libssl-0x10000’ (elder  OpenSSL  series,
                 other  clones).  Optional features are preceded with a plus sign ‘+’ when available, and with a
                 hyphen-minus ‘-’ otherwise.

                 Currently known features are ‘conf-ctx’ (<u>tls-config-pairs</u>),  ‘ctx-config’  (<u>tls-config-module</u>),
                 ‘ctx-set-ciphersuites’   (<b>Ciphersuites</b>   slot   of   <u>tls-config-pairs</u>),  ‘ctx-set-maxmin-proto’
                 (<u>tls-config-pairs</u>), ‘modules-load-file’ (<u>tls-config-file</u>), and ‘tls-rand-file’ (<u>tls-rand-file</u>).

       <u>tls-fingerprint-USER@HOST</u>, <u>tls-fingerprint-HOST</u>, <u>tls-fingerprint</u>
                 [Option] It is possible to replace the verification of the connection peer certificate  against
                 the  entire  local  pool  of  CAs  (for  more  see  “Encrypted network communication”) with the
                 comparison against a precalculated certificate message digest, the so-called fingerprint, to be
                 specified as the used <u>tls-fingerprint-digest</u>.  This fingerprint can for example  be  calculated
                 with ‘<b>tls</b> fingerprint HOST’.

       <u>tls-fingerprint-digest-USER@HOST</u>, <u>tls-fingerprint-digest-HOST</u>, <u>tls-fingerprint-digest</u>
                 [Option]  The  message  digest  to  be  used  when  creating  TLS certificate fingerprints, the
                 defaults, if available, in test order, being ‘BLAKE2s256’, ‘SHA256’.  For the complete list  of
                 digest algorithms refer to <u>smime-sign-digest</u>.

       <u>tls-rand-file</u>
                 [Option]  If <u>tls-features</u> announces ‘,+tls-rand-file,’ then this will be queried to find a file
                 with random entropy data which can be used to seed the P(seudo)R(andom)N(umber)G(enerator), see
                 <u><a href="../man3/RAND_load_file.3.html">RAND_load_file</a></u>(3).  The default filename (<u><a href="../man3/RAND_file_name.3.html">RAND_file_name</a></u>(3), normally <u><a href="file:~/.rnd">~/.rnd</a></u>) will be  used  if
                 this  variable  is  not set or empty, or if the “Filename transformations” fail.  Shall seeding
                 the PRNG have been successful,  <u><a href="../man3/RAND_write_file.3.html">RAND_write_file</a></u>(3)  will  be  called  to  update  the  entropy.
                 Remarks: libraries which do not announce this feature seed the PRNG by other means.

       <u>tls-verify-USER@HOST</u>, <u>tls-verify-HOST</u>, <u>tls-verify</u>
                 [Option]  Variable  chain  that  sets  the action to be performed if an error occurs during TLS
                 server certificate validation  against  the  specified  or  default  trust  stores  <u>tls-ca-dir</u>,
                 <u>tls-ca-file</u>,   or   the   TLS   library   built-in   defaults   (unless  usage  disallowed  via
                 <u>tls-ca-no-defaults</u>), and as fine-tuned via <u>tls-ca-flags</u>.  Valid (case-insensitive)  values  are
                 ‘strict’  (fail  and  close connection immediately), ‘ask’ (ask whether to continue on standard
                 input), ‘warn’ (show a warning and  continue),  ‘ignore’  (do  not  perform  validation).   The
                 default is ‘ask’.

       <u>toplines</u>  If  defined,  gives  the  number of lines of a message to be displayed with the command <b>top</b>; if
                 unset, the first five lines are printed, if set to 0 the variable <u>screen</u> is inspected.  If  the
                 value  is negative then its absolute value will be used for unsigned right shifting (see <b>vexpr</b>)
                 the <u>screen</u> height.

       <u>topsqueeze</u>
                 (Boolean) If set then the <b>top</b> command series will strip adjacent empty lines and quotations.

       <u>ttycharset</u>
                 The character set of the terminal S-nail operates on, and the one and only supported  character
                 set that S-nail can use if no character set conversion capabilities have been compiled into it,
                 in  which  case  it defaults to ISO-8859-1.  Otherwise it defaults to UTF-8.  Sufficient locale
                 support provided the default will be preferably deduced from the locale environment if that  is
                 set  (for  example  LC_CTYPE,  see there for more); runtime locale changes will be reflected by
                 <u>ttycharset</u> except during the program startup phase and if <b>-S</b> had been used to freeze the  given
                 value.  Refer to the section “Character sets” for the complete picture about character sets.

       <u>typescript-mode</u>
                 (Boolean) A special multiplex variable that disables all variables and settings which result in
                 behaviour   that   interferes  with  running  S-nail  in  <u><a href="../man1/script.1.html">script</a></u>(1);  it  sets  <u>colour-disable</u>,
                 <u>line-editor-disable</u> and (before startup completed only) <u>termcap-disable</u>.  Unsetting it does not
                 restore the former state of the covered settings.

       <u>umask</u>     For a safe-by-default policy the process file mode creation mask <u><a href="../man2/umask.2.html">umask</a></u>(2) will be set to ‘0077’
                 on program startup after the resource files have been loaded, and unless this variable is  set.
                 By  assigning  this  an empty value the active setting will not be changed, otherwise the given
                 value will be made the new file mode creation mask.  Child  processes  inherit  the  file  mode
                 creation mask of their parent.

       <u>user-HOST</u>, <u>user</u>
                 [v15-compat]  Variable  chain that sets a global fallback user name, used in case none has been
                 given in the protocol and account-specific URL.  This variable defaults to the name of the user
                 who runs S-nail.

       <u>v15-compat</u>
                 Enable upward compatibility with S-nail version 15.0 in respect to which configuration  options
                 are  available and how they are handled.  If set to a non-empty value the command modifier <b>wysh</b>
                 is implied and thus enforces “Shell-style argument quoting” over “Old-style  argument  quoting”
                 for  all  commands  which  support  both.  This manual uses [v15-compat] and [no v15-compat] to
                 refer to the new and the old way of doing things, respectively.

       <u>verbose</u>   Verbose mode enables logging of  informational  context  messages.   Historically  a  (Boolean)
                 variable,  this  can either be set multiple times (what the command line option <b>-v</b> uses), or be
                 assigned a numeric value in order to  increase  verbosity.   Assigning  the  value  0  disables
                 verbosity and thus (almost) equals <b>unset</b>.  The maximum number is 3.  Also see <u>debug</u>.

       <u>version</u>, <u>version-date</u>, <u>version-hexnum</u>, <u>version-major</u>, <u>version-minor</u>, <u>version-update</u>
                 (Read-only)  S-nail  version  information:  the  first  variable  is a string with the complete
                 version identification, the second the release date in ISO 8601  notation  without  time.   The
                 third  is  a 32-bit hexadecimal number with the upper 8 bits storing the major, followed by the
                 minor and update version numbers which occupy 12 bits each.  The latter three variables contain
                 only decimal digits: the major, minor and update version numbers.  The output  of  the  command
                 <b>version</b> will include this information.

       <u>writebackedited</u>
                 If this variable is set messages modified using the <b>edit</b> or <b>visual</b> commands are written back to
                 the  current  folder  when it is quit; it is only honoured for writable folders in MBOX format,
                 though.  Note that the editor will be pointed to the raw message content in  that  case,  i.e.,
                 neither  MIME decoding nor decryption will have been performed, and proper <u>mbox-rfc4155</u> ‘From_’
                 quoting of newly added or edited content is also left as an exercise to the user.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       The term “environment variable” should be considered  an  indication  that  these  variables  are  either
       standardized  as  vivid  parts  of  process  environments, or that they are commonly found in there.  The
       process environment is inherited from the <u><a href="../man1/sh.1.html">sh</a></u>(1) once S-nail is started, and unless  otherwise  explicitly
       noted  handling of the following variables transparently integrates into that of the “INTERNAL VARIABLES”
       from S-nail's point of view.  This means they can be managed via <b>set</b> and <b>unset</b>, causing automatic program
       environment updates (to be inherited by newly created child processes).

       In order to integrate other environment variables equally they need to  be  imported  (linked)  with  the
       command  <b>environ</b>.   This  command  can also be used to set and unset non-integrated environment variables
       from scratch, sufficient system support provided.  The following example, applicable to  a  POSIX  shell,
       sets  the  COLUMNS  environment  variable  for S-nail only, and beforehand exports the EDITOR in order to
       affect any further processing in the running shell:

             $ EDITOR="vim -u ${HOME}/.vimrc"
             $ export EDITOR
             $ COLUMNS=80 s-nail -R

       COLUMNS   The user's preferred width in column positions for the terminal screen.  Queried and used  once
                 on  program startup in interactive or batch (<b>-#</b>) mode, actively managed for child processes and
                 the MLE (see “On terminal control and line  editor”)  in  interactive  mode  thereafter.   Non-
                 interactive  mode  always uses, and the fallback default is a compile-time constant, by default
                 80 columns.  If in batch mode COLUMNS and LINES are both set but not both  are  usable  (empty,
                 not  a  number,  or 0) at program startup, then the real terminal screen size will be (tried to
                 be) determined once.  (Normally the <u><a href="../man1/sh.1.html">sh</a></u>(1) manages these variables, and  unsets  them  for  pipe
                 specifications etc.)

       DEAD      The  name  of  the  (mailbox)  <b>folder</b>  to  use for saving aborted messages if <u>save</u> is set; this
                 defaults to <u><a href="file:~/dead.letter">~/dead.letter</a></u>.  If the variable <u>debug</u> is set no output will be generated, otherwise
                 the contents of the file will be replaced.  Except shell globs “Filename transformations” (also
                 see <b>folder</b>) will be performed.

       EDITOR    Pathname of the text editor to use for the <b>edit</b> command and <b>~e</b> (see “COMMAND ESCAPES”);  VISUAL
                 is used for a more display oriented editor.

       HOME      The  user's  home  directory.   This  variable  is  only  used  when  it resides in the process
                 environment.  The calling user's home directory will be used instead if this directory does not
                 exist, is not accessible or cannot be read; it will always be used for the root user.  (No test
                 for being writable is performed to allow usage by non-privileged users within read-only  jails,
                 but dependent on settings this directory is a default write target for, for example, DEAD, MBOX
                 and more.)

       LC_ALL, LC_CTYPE, LANG
                 [Option]  The  (names  in  lookup  order  of  the)  <u><a href="../man7/locale.7.html">locale</a></u>(7) (and / or see <u><a href="../man3/setlocale.3.html">setlocale</a></u>(3)) which
                 indicates the used “Character sets”.  Runtime changes trigger automatic updates of  the  entire
                 locale  system,  which  includes updating <u>ttycharset</u> (except during startup if the variable has
                 been frozen via <b>-S</b>).

       LINES     The user's preferred number of lines for the terminal screen.  The behaviour  is  as  described
                 for  COLUMNS,  yet  the  compile-time  constant  used in non-interactive mode and as a fallback
                 defaults to 24 (lines).

       LISTER    Pathname of the directory lister to  use  in  the  <b>folders</b>  command  when  operating  on  local
                 mailboxes.  Default is <u><a href="../man1/ls.1.html">ls</a></u>(1) (path search through SHELL).

       LOGNAME   Upon  startup S-nail will actively ensure that this variable refers to the name of the user who
                 runs S-nail, in order to be able to pass a verified name to any newly created child process.

       MAIL      Is used as the user's “primary system mailbox” unless  <u>inbox</u>  is  set.   If  the  environmental
                 fallback  is  also  not set, a built-in compile-time default is used.  This is assumed to be an
                 absolute pathname.

       MAILCAPS  [Option] Override the default path search of “The Mailcap files”:  any  existing  file  therein
                 will  be loaded in sequence, appending any content to the list of MIME type handler directives.
                 The RFC 1524 standard imposed default value is  assigned  otherwise:  ‘<a href="file:~/.mailcap">~/.mailcap</a>:/etc/mailcap:
                 /usr/etc/mailcap:/usr/local/etc/mailcap’.  (The default value is a compile-time [Option].)

       MAILRC    Is  used  as  a  startup file instead of <u><a href="file:~/.mailrc">~/.mailrc</a></u> if set.  In order to avoid side-effects from
                 configuration files scripts should either set this variable to <u>/dev/null</u> or the <b>-:</b> command line
                 option should be used.

       MAILX_NO_SYSTEM_RC
                 If this variable is set then reading of <u>s-nail.rc</u> (aka <u>system-mailrc</u>) at startup is  inhibited,
                 i.e.,  the  same  effect  is  achieved as if S-nail had been started up with the option <b>-:</b> (and
                 according argument) or <b>-n</b>.  This  variable  is  only  used  when  it  resides  in  the  process
                 environment.

       MBOX      The  name  of  the  user's “secondary mailbox” file.  A logical subset of the special “Filename
                 transformations” (also see <b>folder</b>) are supported.  The default is <u><a href="file:~/mbox">~/mbox</a></u>.   Traditionally  this
                 MBOX  is  used  as  the  file to save messages from the “primary system mailbox” that have been
                 read.  Also see “Message states”.

       NETRC     [v15-compat][Option] This variable overrides the default location of the user's <u><a href="file:~/.netrc">~/.netrc</a></u> file.

       PAGER     Pathname of the program to use for backing the command <b>more</b>, and when the <u>crt</u> variable enforces
                 usage of a pager for output.  The default paginator is <u><a href="../man1/more.1.html">more</a></u>(1) (path search through SHELL).

                 S-nail inspects the contents of this variable: if its contains the string “less”  then  a  non-
                 existing  environment  variable  LESS  will be set to (the portable) ‘RI’, likewise for “lv” LV
                 will optionally be set to ‘-c’.  Also see <u>colour-pager</u>.

       PATH      A colon-separated list of directories that is searched by the shell when looking for  commands,
                 for example ‘<a href="file:/bin">/bin</a>:<a href="file:/usr/bin">/usr/bin</a>:<a href="file:/usr/local/bin">/usr/local/bin</a>’.

       POSIXLY_CORRECT
                 This environment entry is automatically squared with <u>posix</u>.

       SHELL     The  shell  to  use  for  the  commands  <b>!</b>,  <b>shell</b>,  the <b>~!</b> “COMMAND ESCAPES” and when starting
                 subprocesses.  A default shell is used if this environment variable is not defined.

       SOCKS5_PROXY
                 This environment entry is automatically squared with <u>socks-proxy</u>.

       SOURCE_DATE_EPOCH
                 Specifies a time in seconds since the Unix epoch (1970-01-01)  to  be  used  in  place  of  the
                 current  time.   This variable is looked up upon program startup, and its existence will switch
                 S-nail to a reproducible mode (https://reproducible-builds.org) which uses deterministic random
                 numbers, a special  fixated  pseudo  LOGNAME  and  more.   This  operation  mode  is  used  for
                 development and by software packagers.  [v15 behaviour may differ] Currently an invalid setting
                 is only ignored, rather than causing a program abortion.

                       <b>$</b> <b>SOURCE_DATE_EPOCH=`date</b> <b>+%s`</b> <b>s-nail</b>

       TERM      [Option]  The  terminal  type for which output is to be prepared.  For extended colour and font
                 control please refer to “Coloured display”, and for  terminal  management  in  general  to  “On
                 terminal control and line editor”.

       TMPDIR    Except  for  the  root  user this variable defines the directory for temporary files to be used
                 instead of <u><a href="file:/tmp">/tmp</a></u> (or the given compile-time constant) if set, existent, accessible  as  well  as
                 read- and writable.  This variable is only used when it resides in the process environment, but
                 S-nail  will  ensure  at  startup that this environment variable is updated to contain a usable
                 temporary directory.

       USER      Identical to LOGNAME (see there), but this variable is not standardized, should  therefore  not
                 be used, and is only corrected if already set.

       VISUAL    Pathname  of  the  text  editor  to  use for the <b>visual</b> command and <b>~v</b> (see “COMMAND ESCAPES”);
                 EDITOR is used for a less display oriented editor.

</pre><h4><b>FILES</b></h4><pre>
       <u><a href="file:~/.mailcap">~/.mailcap</a></u>, <u>/etc/mailcap</u>
                 [Option] Personal and system-wide MIME type handler definition files, see “The Mailcap  files”.
                 (The shown names are part of the RFC 1524 standard search path MAILCAPS.)

       <u><a href="file:~/.mailrc">~/.mailrc</a></u>, <u>s-nail.rc</u>
                 User-specific  and  system-wide files giving initial commands, the “Resource files”.  (The used
                 filenames come from <u>MAILRC</u> and <u>system-mailrc</u>, respectively.)

       <u><a href="file:~/mbox">~/mbox</a></u>    The default value for MBOX.

       <u><a href="file:~/.mime.types">~/.mime.types</a></u>, <u><a href="file:/etc/mime.types">/etc/mime.types</a></u>
                 Personal and system-wide MIME types, see “The mime.types files”.

       <u><a href="file:~/.netrc">~/.netrc</a></u>  [v15-compat][Option] The default location of the user's <u>.netrc</u> file – the section  “The  .netrc
                 file” documents the file format.  The used path can be set via NETRC.

       <u>/dev/null</u>
                 The data sink <u><a href="../man4/null.4.html">null</a></u>(4).

       <u><a href="file:~/.rnd">~/.rnd</a></u>    [Option] Possible location for persistent random entropy seed storage, see <u>tls-rand-file</u>.

   <b>Resource</b> <b>files</b>
       Upon startup S-nail reads in several resource files, in order:

       <u>s-nail.rc</u>
                 System  wide  initialization  file  (<u>system-mailrc</u>).   Reading  of this file can be suppressed,
                 either by using the <b>-:</b> (and according argument) or <b>-n</b> command line options, or by  setting  the
                 “ENVIRONMENT” variable MAILX_NO_SYSTEM_RC.

       <u><a href="file:~/.mailrc">~/.mailrc</a></u>
                 File  giving  initial  commands.   A  different file can be chosen by setting the “ENVIRONMENT”
                 variable MAILRC.  Reading of this file can be suppressed with the <b>-:</b> command line option.

       <u>mailx-extra-rc</u>
                 Defines a startup file to be read after all other resource files.  It can be  used  to  specify
                 settings that are not understood by other <u><a href="../man1/mailx.1.html">mailx</a></u>(1) implementations, for example.

       The content of these files is interpreted as follows:

       <b>•</b>   The whitespace characters space, tabulator and newline, as well as those defined by the variable <u>ifs</u>,
           are removed from the beginning and end of input lines.
       <b>•</b>   Empty lines are ignored.
       <b>•</b>   Any  other  line  is  interpreted  as  a  command.  It may be spread over multiple input lines if the
           newline character is “escaped” by placing a reverse solidus character ‘\’ as the  last  character  of
           the  line;  whereas  any  leading whitespace of follow lines is ignored, trailing whitespace before a
           escaped newline remains in the input.
       <b>•</b>   If the line (content) starts with the number sign ‘#’ then it is a comment-command and also  ignored.
           (The  comment-command  is  a  real  command, which does nothing, and therefore the usual follow lines
           mechanism applies!)

       Errors while loading these files are subject to the settings of  <u>errexit</u>  and  <u>posix</u>.   More  files  with
       syntactically  equal  content  can  be  <b>source</b>ed.   The following, saved in a file, would be an examplary
       content:

              # This line is a comment command.  And y\
                 es, it is really continued here.
             set debug \
                 verbose
                 set editheaders

   <b>The</b> <b>mime.types</b> <b>files</b>
       As stated in “HTML mail and MIME attachments” S-nail needs to learn  about  MIME  (Multipurpose  Internet
       Mail  Extensions)  media  types in order to classify message and attachment content.  One source for them
       are  <u>mime.types</u>  files,  the  loading  of   which   can   be   controlled   by   setting   the   variable
       <u>mimetypes-load-control</u>.   Another  is the command <b>mimetype</b>, which also offers access to S-nails MIME type
       cache.  <u>mime.types</u> files have the following syntax:

             type/subtype extension [extension ...]
             # For example text/html html htm

       where ‘type/subtype’ define the MIME media type, as standardized in RFC 2046: ‘type’ is used  to  declare
       the  general type of data, while the ‘subtype’ specifies a specific format for that type of data.  One or
       multiple filename ‘extension’s, separated by whitespace, can be bound to the media type format.  Comments
       may be introduced anywhere on a line with a number sign ‘#’, causing the remaining line to be  discarded.
       S-nail  also  supports  an extended, non-portable syntax in especially crafted files, which can be loaded
       via the alternative value syntax of <u>mimetypes-load-control</u>, and prepends an optional ‘type-marker’:

             <b>[type-marker</b> <b>]type/subtype</b> <b>extension</b> <b>[extension</b> <b>...]</b>

       The following type markers are supported:

       <u>?</u>         Treat message parts with this content as plain text.
       <u>?t</u>        The same as plain <u>?</u>.
       <u>?h</u>        Treat message parts with this content as HTML tagsoup.  If the [Option]al  HTML-tagsoup-to-text
                 converter is not available treat the content as plain text instead.
       <u>?H</u>        Likewise  <u>?h</u>,  but instead of falling back to plain text require an explicit content handler to
                 be defined.
       <u>?q</u>        If no handler can be found a text message is displayed which says so.  This  can  be  annoying,
                 for  example signatures serve a contextual purpose, their content is of no use by itself.  This
                 marker will avoid displaying the text message.

       Further reading: for sending messages: <b>mimetype</b>, <u>mime-allow-text-controls</u>,  <u>mimetypes-load-control</u>.   For
       reading   etc.   messages:   “HTML   mail   and   MIME   attachments”,  “The  Mailcap  files”,  <b>mimetype</b>,
       <u>mime-counter-evidence</u>, <u>mimetypes-load-control</u>, <u>pipe-TYPE/SUBTYPE</u>, <u>pipe-EXTENSION</u>.

   <b>The</b> <b>Mailcap</b> <b>files</b>
       [Option] RFC 1524 defines a “User Agent Configuration Mechanism” to be used to  inform  mail  user  agent
       programs  about  the locally installed facilities for handling various data formats, i.e., about commands
       and how they can be used to display, edit et cetera MIME part contents, as well as a default path  search
       that  includes  multiple  possible  locations of resource files, and the MAILCAPS environment variable to
       overwrite that.  Handlers found from doing the path search will be cached, the command  <b>mailcap</b>  operates
       on that cache, and the variable <u>mailcap-disable</u> will suppress automatic loading, and usage of any mailcap
       handlers.  “HTML mail and MIME attachments” gives a general overview of how MIME types are handled.

       “Mailcap”  files  consist  of a set of newline separated entries.  Comment lines start with a number sign
       ‘#’ (in the first column!) and are ignored.  Empty lines are ignored.  All other lines are interpreted as
       mailcap entries.  An entry definition may be split over multiple lines by  placing  the  reverse  solidus
       character  ‘\’  last  in all but the final line.  The standard does not specify how leading whitespace of
       successive lines is to be treated, therefore they are retained.

       “Mailcap” entries consist of a number of semicolon ‘;’  separated  fields.   The  first  two  fields  are
       mandatory  and must occur in the specified order, the remaining fields are optional and may appear in any
       order.  Leading and trailing whitespace of field content is ignored (removed).  The reverse  solidus  ‘\’
       character  can be used to escape any following character including semicolon and itself in the content of
       the second field, and in value parts of any optional key/value field.

       The first field defines the MIME ‘TYPE/SUBTYPE’ the entry is about to  handle  (case-insensitively).   If
       the  subtype  is specified as an asterisk ‘*’ the entry is meant to match all subtypes of the named type,
       e.g., ‘audio/*’ would match any audio type.  The second field is the <b>view</b> shell command used  to  display
       MIME parts of the given type.

       Data  consuming  shell commands will be fed message (MIME part) data on standard input unless one or more
       instances of the (unquoted) string ‘%s’ are used:  these  formats  will  be  replaced  with  a  temporary
       file(name)  that  has  been prefilled with the parts data.  Data producing shell commands are expected to
       generata data on their standard output unless that format is used.  In all cases any given ‘%s’ format is
       replaced with a properly shell quoted filename.  When a command requests a temporary file via  ‘%s’  then
       that will be removed again, as if the <b>x-mailx-tmpfile</b> and <b>x-mailx-tmpfile-fill</b> flags had been set; unless
       the command requests <b>x-mailx-async</b> the <b>x-mailx-tmpfile-unlink</b> flag is also implied; see below for more.

       Optional  fields  define single-word flags (case-insensitive), or key / value pairs consisting of a case-
       insensitive keyword, an equals sign ‘=’, and a shell command; whitespace surrounding the equals  sign  is
       removed.  Optional fields include the following:

       <b>compose</b>   A  program that can be used to compose a new body or body part in the given format.  (Currently
                 unused.)

       <b>composetyped</b>
                 Similar to the <b>compose</b> field, but is to be used when the composing program needs to specify the
                 ‘Content-type:’ header field to be applied to the composed data.  (Currently unused.)

       <b>copiousoutput</b>
                 A flag field which indicates that the output of the <b>view</b> command  is  integrable  into  S-nails
                 normal visual display.  It is mutually exclusive with <b>needsterminal</b>.

       <b>description</b>
                 A  textual  description  that describes this type of data.  The text may optionally be enclosed
                 within double quotation marks ‘"’.

       <b>edit</b>      A program that can be used to edit a body  or  body  part  in  the  given  format.   (Currently
                 unused.)

       <b>nametemplate</b>
                 This field specifies a filename format for the ‘%s’ format used in the shell command fields, in
                 which  ‘%s’ will be replaced by a random string.  (The filename is also stored in and passed to
                 subprocesses via MAILX_FILENAME_TEMPORARY.)  The standard says this is  “only  expected  to  be
                 relevant  in  environments  where  filename  extensions  are  meaningful”, and so this field is
                 ignored unless the ‘%s’ is a prefix, optionally followed  by  (ASCII)  alphabetic  and  numeric
                 characters,  the  underscore  and the period.  For example, to specify that a JPG file is to be
                 passed to an image viewer with a name ending in ‘.jpg’, ‘nametemplate=%s.jpg’ can be used.

       <b>needsterminal</b>
                 This flag field indicates that the given shell command must be run on an interactive  terminal.
                 S-nail  will temporarily release the terminal to the given command in interactive mode, in non-
                 interactive mode this entry will be entirely ignored; this flag implies <b>x-mailx-noquote</b>.

       <b>print</b>     A program that can be used to print a message or body part in  the  given  format.   (Currently
                 unused.)

       <b>test</b>      Specifies a program to be run to test some condition, for example, the machine architecture, or
                 the  window system in use, to determine whether or not this mailcap entry applies.  If the test
                 fails, a subsequent mailcap entry should be sought; also see <b>x-mailx-test-once</b>.   Standard  I/O
                 of  the  test program is redirected from and to <u>/dev/null</u>, and the format ‘%s’ is not supported
                 (the data does not yet exist).

       <b>textualnewlines</b>
                 A flag field which indicates that this type of data is line-oriented and that,  if  encoded  in
                 ‘base64’,  all  newlines should be converted to canonical form (CRLF) before encoding, and will
                 be in that form after decoding.  (Currently unused.)

       <b>x11-bitmap</b>
                 Names a file, in X11 bitmap (xbm) format, which points to an appropriate icon  to  be  used  to
                 visually denote the presence of this kind of data.  This field is not used by S-nail.

       <b>x-mailx-async</b>
                 Extension flag field that denotes that the given <b>view</b> command shall be executed asynchronously,
                 without blocking S-nail.  Cannot be used in conjunction with <b>needsterminal</b>; the standard output
                 of the command will go to <u>/dev/null</u>.

       <b>x-mailx-noquote</b>
                 An extension flag field that indicates that even a <b>copiousoutput</b> <b>view</b> command shall not be used
                 when <u>quote</u>ing messages, as it would by default.

       <b>x-mailx-test-once</b>
                 Extension  flag  which denotes whether the given <b>test</b> command shall be evaluated once only with
                 its exit status being cached.  This is handy if some  global  unchanging  condition  is  to  be
                 queried, like “running under the X Window System”.

       <b>x-mailx-tmpfile</b>
                 Extension  flag  field that requests creation of a zero-sized temporary file, the name of which
                 is to be placed in the environment variable MAILX_FILENAME_TEMPORARY.  It is an  error  to  use
                 this  flag  with  commands  that include a ‘%s’ format (because that is implemented by means of
                 this temporary file).

       <b>x-mailx-tmpfile-fill</b>
                 Normally the MIME part content is passed to the handler via standard input; if this flag is set
                 then the data will instead be written into the implied  <b>x-mailx-tmpfile</b>.   In  order  to  cause
                 deletion  of  the temporary file you will have to set <b>x-mailx-tmpfile-unlink</b> explicitly!  It is
                 an error to use this flag with commands that include a ‘%s’ format.

       <b>x-mailx-tmpfile-unlink</b>
                 Extension flag field that requests that the temporary file shall be deleted automatically  when
                 the  command  loop  is  entered again at latest.  It is an error to use this flag with commands
                 that include a ‘%s’ format, or in conjunction with <b>x-mailx-async</b>.  <b>x-mailx-tmpfile</b> is implied.

       <b>x-mailx-last-resort</b>
                 An extension flag that indicates that this handler shall only be used as a last resort, when no
                 other source (see “HTML mail and MIME attachments”) provides a MIME handler.

       <b>x-mailx-ignore</b>
                 An extension that enforces that this handler is not used at all.

       The standard includes the possibility to define any number of additional fields, prefixed by ‘x-’.   Flag
       fields  apply  to  the  entire  “Mailcap”  entry  — in some unusual cases, this may not be desirable, but
       differentiation can be accomplished via separate entries, taking advantage of the  fact  that  subsequent
       entries  are  searched  if  an  earlier  one does not provide enough information.  For example, if a <b>view</b>
       command needs to specify the <b>needsterminal</b> flag, but the <b>compose</b> command shall not,  the  following  will
       help out the latter:

             application/postscript; ps-to-terminal %s; needsterminal
             application/postscript; ps-to-terminal %s; compose=idraw %s

       In  value  parts  of  command  fields  any  occurrence  of the format string ‘%t’ will be replaced by the
       ‘TYPE/SUBTYPE’ specification.  Any named parameter from a messages' ‘Content-type:’ field may be embedded
       into the command line using the format ‘%{’ followed by the  parameter  name  and  a  closing  brace  ‘}’
       character.   The entire parameter should appear as a single command line argument, regardless of embedded
       spaces, shell quoting will be performed by the RFC 1524 processor, thus:

             # Message
             Content-type:  multipart/mixed; boundary=42

             # Mailcap file
             multipart/*; /usr/local/bin/showmulti \
               %t %{boundary}  ;  composetyped  = /usr/local/bin/makemulti

             # Executed shell command
             /usr/local/bin/showmulti multipart/mixed 42

       Note that S-nail does not support handlers for multipart MIME parts as  shown  in  this  example  (as  of
       today).   It does not support the additional formats ‘%n’ and ‘%F’.  An example file, also showing how to
       properly deal with the expansion of ‘%s’, which includes any quotes that are necessary to make it a valid
       shell argument by itself and thus will cause undesired behaviour when placed in additional  user-provided
       quotes:

             # Comment line
             text/richtext; richtext %s; copiousoutput

             text/x-perl; perl -cWT %s; nametemplate = %s.pl

             # Exit EX_TEMPFAIL=75 on signal
             application/pdf; \
               infile=%s\; \
                 trap "rm -f ${infile}" EXIT\; \
                 trap "exit 75" INT QUIT TERM\; \
                 mupdf "${infile}"; \
               test = [ -n "${DISPLAY}" ]; \
               nametemplate = %s.pdf; x-mailx-async
             application/pdf; pdftotext -layout - -; copiousoutput

             application/*; echo "This is \\"%t\\" but \
                 is 50 \% Greek to me" \; &lt; %s head -c 512 | cat -vet; \
               copiousoutput; x-mailx-noquote; x-mailx-last-resort

       Further  reading:  “HTML  mail  and  MIME  attachments”,  “The  mime.types  files”,  <b>mimetype</b>,  MAILCAPS,
       <u>mime-counter-evidence</u>, <u>pipe-TYPE/SUBTYPE</u>, <u>pipe-EXTENSION</u>.

   <b>The</b> <b>.netrc</b> <b>file</b>
       User credentials for machine accounts (see “On URL syntax and credential lookup”) can be  placed  in  the
       <u>.netrc</u>  file,  which  will  be loaded and cached when requested by <u>netrc-lookup</u>.  The default location <u>~/</u>
       <u>.netrc</u> may be overridden by the NETRC environment variable.  As long as syntax constraints  are  honoured
       the  file  source  may  be  replaced  with  the output of the shell command set in <u>netrc-pipe</u>, to load an
       encrypted file, for example.  The cache can be managed with the command <b>netrc</b>.

       The file consists of space, tabulator or newline separated tokens.  This parser implements a superset  of
       the  original  BSD  syntax,  but  users  should nonetheless be aware of portability glitches, shall their
       <u>.netrc</u> be usable across multiple programs and platforms:

       <b>•</b>   BSD only supports double quotation marks, for example ‘password "pass with spaces"’.
       <b>•</b>   BSD (only?) supports escaping of single characters via a reverse solidus (a space  could  be  escaped
           via ‘\ ’), in- as well as outside of a quoted string.  This method is assumed to be present, and will
           actively  be  used  to quote double quotation marks ‘"’ and reverse solidus ‘\’ characters inside the
           <b>login</b> and <b>password</b> tokens, for example for display purposes.
       <b>•</b>   BSD does not require a final quotation mark of the last user input token.
       <b>•</b>   The original BSD (Berknet) parser also supported a format which allowed tokens to be  separated  with
           commas – whereas at least Hewlett-Packard still seems to support this syntax, this parser does not!
       <b>•</b>   As  a non-portable extension some widely-used programs support shell-style comments: if an input line
           starts, after any amount of whitespace, with a number sign ‘#’, then the rest of the line is ignored.
       <b>•</b>   Whereas other programs may require that the <u>.netrc</u> file is accessible by only the user if it contains
           a <b>password</b> token for any other <b>login</b> than “anonymous”, this parser will always require  these  strict
           permissions.

       Of  the following list of supported tokens this parser uses (and caches) <b>machine</b>, <b>login</b> and <b>password</b>.  An
       existing <b>default</b> entry will not be used.

       <b>machine</b> <u>name</u>
                 The hostname of the entries'  machine,  lowercase-normalized  before  use.   Any  further  file
                 content, until either end-of-file or the occurrence of another <b>machine</b> or a <b>default</b> first-class
                 token is bound (only related) to the machine <u>name</u>.

                 As  an  extension  that  should  not  be the cause of any worries this parser supports a single
                 wildcard prefix for <u>name</u>:

                       machine *.example.com login USER password PASS
                       machine pop3.example.com login USER password PASS
                       machine smtp.example.com login USER password PASS

                 which would match ‘xy.example.com’ as well as ‘pop3.example.com’, but neither ‘example.com’ nor
                 ‘local.smtp.example.com’.  In the example  neither  ‘pop3.example.com’  nor  ‘smtp.example.com’
                 will  be matched by the wildcard, since the exact matches take precedence (it is however faster
                 to specify it the other way around).

       <b>default</b>   This is the same as <b>machine</b> except that it is a fallback entry that is used shall none  of  the
                 specified  machines  match;  only  one  default token may be specified, and it must be the last
                 first-class token.

       <b>login</b> <u>name</u>
                 The user name on the remote machine.

       <b>password</b> <u>string</u>
                 The user's password on the remote machine.

       <b>account</b> <u>string</u>
                 Supply an additional account password.  This is merely for FTP purposes.

       <b>macdef</b> <u>name</u>
                 Define a macro.  A macro is defined with the specified  <u>name</u>;  it  is  formed  from  all  lines
                 beginning  with  the  next  line  and  continuing  until  a  blank line is (consecutive newline
                 characters are) encountered.   (Note  that  <b>macdef</b>  entries  cannot  be  utilized  by  multiple
                 machines,  too,  but  must be defined following the <b>machine</b> they are intended to be used with.)
                 If a macro named <u>init</u> exists, it is automatically run as the last step of  the  login  process.
                 This is merely for FTP purposes.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>An</b> <b>example</b> <b>configuration</b>
             # This example assumes v15.0 compatibility mode
             set v15-compat

             # Request strict TLL transport layer security checks
             set tls-verify=strict

             # Where are the up-to-date TLS certificates?
             # (Since we manage up-to-date ones explicitly, do not use any,
             # possibly outdated, default certificates shipped with OpenSSL)
             #set tls-ca-dir=<a href="file:/etc/ssl/certs">/etc/ssl/certs</a>
             set tls-ca-file=<a href="file:/etc/ssl/certs/ca-certificates.crt">/etc/ssl/certs/ca-certificates.crt</a>
             set tls-ca-no-defaults
             #set tls-ca-flags=partial-chain
             wysh set smime-ca-file="${tls-ca-file}" \
               smime-ca-no-defaults #smime-ca-flags="${tls-ca-flags}"

             # This could be outsourced to a central configuration file via
             # tls-config-file plus tls-config-module if the used library allows.
             # CipherString: explicitly define the list of ciphers, which may
             #   improve security, especially with protocols older than TLS v1.2.
             #   See <a href="../man1/ciphers.1.html">ciphers</a>(1).  Possibly best to only use tls-config-pairs-HOST
             #   (or -USER@HOST), as necessary, again..
             #   Note that TLSv1.3 uses Ciphersuites= instead, which will join
             #   with CipherString (if protocols older than v1.3 are allowed)
             # Curves: especially with TLSv1.3 curves selection may be desired.
             # MinProtocol,MaxProtocol: do not use protocols older than TLS v1.2.
             #   Change this only when the remote server does not support it:
             #   maybe use chain support via tls-config-pairs-HOST / -USER@HOST
             #   to define such explicit exceptions, then, e.g.,
             #     MinProtocol=TLSv1.1
             if "$tls-features" =% ,+ctx-set-maxmin-proto,
               wysh set tls-config-pairs='\
                   CipherString=TLSv1.2:!aNULL:!eNULL:@STRENGTH,\
                   Curves=P-521:P-384:P-256,\
                   MinProtocol=TLSv1.1'
             else
               wysh set tls-config-pairs='\
                   CipherString=TLSv1.2:!aNULL:!eNULL:@STRENGTH,\
                   Curves=P-521:P-384:P-256,\
                   Protocol=-ALL\,+TLSv1.1 \, +TLSv1.2\, +TLSv1.3'
             endif

             # Essential setting: select allowed character sets
             set sendcharsets=utf-8,iso-8859-1

             # A very kind option: when replying to a message, first try to
             # use the same encoding that the original poster used herself!
             set reply-in-same-charset

             # When replying, do not merge From: and To: of the original message
             # into To:.  Instead old From: -&gt; new To:, old To: -&gt; merge Cc:.
             set recipients-in-cc

             # When sending messages, wait until the Mail-Transfer-Agent finishs.
             # Only like this you will be able to see errors reported through the
             # exit status of the MTA (including the built-in SMTP one)!
             set sendwait

             # Only use built-in MIME types, no <a href="../man5/mime.types.5.html">mime.types</a>(5) files
             set mimetypes-load-control

             # Default directory where we act in (relative to $HOME)
             set folder=mail
             # A leading "+" (often) means: under *folder*
             # *record* is used to save copies of sent messages
             set MBOX=+mbox.mbox DEAD=+dead.txt \
               record=+sent.mbox record-files record-resent

             # Make "file mymbox" and "file myrec" go to..
             shortcut mymbox %:+mbox.mbox myrec +sent.mbox

             # Not really optional, e.g., for S/MIME
             set from='Your Name &lt;<a href="mailto:address@exam.ple">address@exam.ple</a>&gt;'

             # It may be necessary to set hostname and/or smtp-hostname
             # if the "SERVER" of mta and "domain" of from do not match.
             # The `urlencode' command can be used to encode USER and PASS
             set mta=(smtps?|submissions?)://[USER[:PASS]@]SERVER[:PORT] \
               smtp-auth=login/plain... \
               smtp-use-starttls

             # Never refuse to start into interactive mode, and more
             set emptystart \
               colour-pager crt= \
               followup-to followup-to-honour=ask-yes fullnames \
               history-file=+.s-nailhist history-size=-1 history-gabby \
               mime-counter-evidence=0b1111 \
               prompt='?\$?!\$!/\$^ERRNAME[\$account#\$mailbox-display]? ' \
               reply-to-honour=ask-yes \
               umask=

             # Only include the selected header fields when typing messages
             headerpick type retain from_ date from to cc subject \
               message-id mail-followup-to reply-to
             # ...when forwarding messages
             headerpick forward retain subject date from to cc
             # ...when saving message, etc.
             #headerpick save ignore ^Original-.*$ ^X-.*$

             # Some mailing lists
             mlist '@xyz-editor\.xyz$' '@xyzf\.xyz$'
             mlsubscribe '^xfans@xfans\.xyz$'

             # Handle a few file extensions (to store MBOX databases)
             filetype bz2 'bzip2 -dc' 'bzip2 -zc' \
               gz 'gzip -dc' 'gzip -c'  xz 'xz -dc' 'xz -zc' \
               zst 'zstd -dc' 'zstd -19 -zc' \
               zst.pgp 'gpg -d | zstd -dc' 'zstd -19 -zc | gpg -e'

             # A real life example of a very huge free mail provider
             # Instead of directly placing content inside `account',
             # we `define' a macro: like that we can switch "accounts"
             # from within *on-compose-splice*, for example!
             define XooglX {
               set folder=<a href="file:~/spool/XooglX">~/spool/XooglX</a> inbox=+syste.mbox sent=+sent
               set from='Your Name &lt;<a href="mailto:address@examp.ple">address@examp.ple</a>&gt;'

               set pop3-no-apop-pop.gmXil.com
               shortcut pop %:pop3s://pop.gmXil.com
               shortcut imap %:imaps://imap.gmXil.com
               # Or, entirely IMAP based setup
               #set folder=imaps://imap.gmail.com record="+[Gmail]/Sent Mail" \
               #   imap-cache=<a href="file:~/spool/cache">~/spool/cache</a>

               set mta=smtp://USER:<a href="mailto:PASS@smtp.gmXil.com">PASS@smtp.gmXil.com</a> smtp-use-starttls
               # Alternatively:
               set mta=smtps://USER:<a href="mailto:PASS@smtp.gmail.com">PASS@smtp.gmail.com</a>:465
             }
             account XooglX {
               \call XooglX
             }

             # Here is a pretty large one which does not allow sending mails
             # if there is a domain name mismatch on the SMTP protocol level,
             # which would bite us if the value of from does not match, e.g.,
             # for people who have a sXXXXeforge project and want to speak
             # with the mailing list under their project account (in from),
             # still sending the message through their normal mail provider
             define XandeX {
               set folder=<a href="file:~/spool/XandeX">~/spool/XandeX</a> inbox=+syste.mbox sent=+sent
               set from='Your Name &lt;<a href="mailto:address@exam.ple">address@exam.ple</a>&gt;'

               shortcut pop %:pop3s://pop.yaXXex.com
               shortcut imap %:imaps://imap.yaXXex.com

               set mta=smtps://USER:<a href="mailto:PASS@smtp.yaXXex.com">PASS@smtp.yaXXex.com</a>:465 \
                 hostname=yaXXex.com smtp-hostname=
             }
             account XandeX {
               \call Xandex
             }

             # Create some new commands so that, e.g., `ls <a href="file:/tmp">/tmp</a>' will..
             commandalias lls '!ls ${LS_COLOUR_FLAG} -aFlrS'
             commandalias llS '!ls ${LS_COLOUR_FLAG} -aFlS'

             set pipe-message/external-body='?* echo $MAILX_EXTERNAL_BODY_URL'

             # We do not support <a href="../man1/gpg.1.html">gpg</a>(1) directly yet.  But simple --clearsign'd
             # message parts can be dealt with as follows:
             define V {
               localopts yes
               wysh set pipe-text/plain=$'?*#++=?\
                 &lt; "${MAILX_FILENAME_TEMPORARY}" awk \
                     -v TMPFILE="${MAILX_FILENAME_TEMPORARY}" \'\
                   BEGIN{done=0}\
                   /^-----BEGIN PGP SIGNED MESSAGE-----/,/^$/ {\
                     if(done++ != 0)\
                       next;\
                     print "--- GPG --verify ---";\
                     system("gpg --verify " TMPFILE " 2&gt;&amp;1");\
                     print "--- GPG --verify ---";\
                     print "";\
                     next;\
                   }\
                   /^-----BEGIN PGP SIGNATURE-----/,\
                       /^-----END PGP SIGNATURE-----/{\
                     next;\
                   }\
                   {print}\
                 \''
                 print
             }
             commandalias V '\'call V

       When storing passwords in <u><a href="file:~/.mailrc">~/.mailrc</a></u> appropriate permissions should be set on this file with ‘$ chmod 0600
       <a href="file:~/.mailrc">~/.mailrc</a>’.  If the [Option]al <u>netrc-lookup</u> is available user credentials can be stored in the central <u>~/</u>
       <u>.netrc</u> file instead; e.g., here is a different version of the example account that sets up SMTP and POP3:

             define XandeX {
               set folder=<a href="file:~/spool/XandeX">~/spool/XandeX</a> inbox=+syste.mbox sent=+sent
               set from='Your Name &lt;<a href="mailto:address@exam.ple">address@exam.ple</a>&gt;'
               set netrc-lookup
               # Load an encrypted <a href="file:~/.netrc">~/.netrc</a> by uncommenting the next line
               #set netrc-pipe='gpg -qd <a href="file:~/.netrc.pgp">~/.netrc.pgp</a>'

               set mta=smtps://smtp.yXXXXx.ru:465 \
                   smtp-hostname= hostname=yXXXXx.com
               set pop3-keepalive=240 pop3-no-apop-pop.yXXXXx.ru
               commandalias xp fi pop3s://pop.yXXXXx.ru
             }
             account XandeX {
               \call XandeX
             }

       and, in the <u><a href="file:~/.netrc">~/.netrc</a></u> file:

             machine *.yXXXXx.ru login USER password PASS

       This configuration should now work just fine:

             <b>$</b> <b>echo</b> <b>text</b> | <b>s-nail</b> <b>-dvv</b> <b>-AXandeX</b> <b>-s</b> <b>Subject</b> <b><a href="mailto:user@exam.ple">user@exam.ple</a></b>

   <b>S/MIME</b> <b>step</b> <b>by</b> <b>step</b>
       [Option]  The  first  thing  that is needed for “Signed and encrypted messages with S/MIME” is a personal
       certificate, and a private key.  The certificate contains public information, in particular  a  name  and
       email  address(es), and the public key that can be used by others to encrypt messages for the certificate
       holder (the owner of the private key), and to <b>verify</b> signed messages generated with  that  certificate('s
       private  key).   Whereas the certificate is included in each signed message, the private key must be kept
       secret.  It is used to decrypt messages that were previously encrypted with the public key, and  to  sign
       messages.

       For personal use it is recommended to get a S/MIME certificate from one of the major CAs on the Internet.
       Many  CAs offer such certificates for free.  Usually offered is a combined certificate and private key in
       PKCS#12 format which S-nail does not accept directly.  To convert it to PEM format, the  following  shell
       command can be used; please read on for how to use these PEM files.

             $ openssl pkcs12 -in cert.p12 -out certpem.pem -clcerts -nodes
             $ # Alternatively
             $ openssl pkcs12 -in cert.p12 -out cert.pem -clcerts -nokeys
             $ openssl pkcs12 -in cert.p12 -out key.pem -nocerts -nodes

       There  is  also  https://www.CAcert.org  which  issues client and server certificates to members of their
       community for free; their root certificate (https://www.cacert.org/certs/root.crt) is often  not  in  the
       default  set  of  trusted  CA  root  certificates,  though,  which means their root certificate has to be
       downloaded separately, and needs to be part of the S/MIME certificate validation chain by including it in
       <u>smime-ca-dir</u> or as a vivid member of the <u>smime-ca-file</u>.  But let us take a step-by-step tour  on  how  to
       setup S/MIME with a certificate from CAcert.org despite this situation!

       First  of  all  you  will  have  to  become  a member of the CAcert.org community, simply by registrating
       yourself via the web interface.  Once you are, create and verify all email addresses you want to be  able
       to  create  signed  and encrypted messages for/with using the corresponding entries of the web interface.
       Now ready to create S/MIME certificates, so let us create a new “client certificate”, ensure  to  include
       all  email addresses that should be covered by the certificate in the following web form, and also to use
       your name as the “common name”.

       Create a private key and a certificate request on your local computer (please see the manual pages of the
       used commands for more in-depth knowledge on what the used arguments etc. do):

             <b>$</b> <b>openssl</b> <b>req</b> <b>-nodes</b> <b>-newkey</b> <b>rsa:4096</b> <b>-keyout</b> <b>key.pem</b> <b>-out</b> <b>creq.pem</b>

       Afterwards copy-and-paste the content of “creq.pem” into the certificate-request (CSR) field of  the  web
       form  on  the CAcert.org website (you may need to unfold some “advanced options” to see the corresponding
       text field).  This last step will ensure that your private key  (which  never  left  your  box)  and  the
       certificate  belong  together (through the public key that will find its way into the certificate via the
       certificate-request).  You are now ready and can create your CAcert certified certificate.  Download  and
       store or copy-and-paste it as “pub.crt”.

       Yay.   In  order to use your new S/MIME setup a combined private key/public key (certificate) file has to
       be created:

             <b>$</b> <b>cat</b> <b>key.pem</b> <b>pub.crt</b> <b>&gt;</b> <b><a href="mailto:ME@HERE.com.paired">ME@HERE.com.paired</a></b>

       This is the file S-nail will work with.  If you have created your private  key  with  a  passphrase  then
       S-nail  will  ask  you  for  it whenever a message is signed or decrypted, unless this operation has been
       automated as described in “Signed and encrypted messages with S/MIME”.  Set the  following  variables  to
       henceforth use S/MIME (setting <u>smime-ca-file</u> is of interest for verification only):

             ? set smime-ca-file=ALL-TRUSTED-ROOT-CERTS-HERE \
                 smime-sign-cert=<a href="mailto:ME@HERE.com.paired">ME@HERE.com.paired</a> \
                 smime-sign-digest=SHA512 \
                 smime-sign from=<a href="mailto:myname@my.host">myname@my.host</a>

   <b>Using</b> <b>CRLs</b> <b>with</b> <b>S/MIME</b> <b>or</b> <b>TLS</b>
       [Option]  Certification  authorities  (CAs) issue certificate revocation lists (CRLs) on a regular basis.
       These lists contain the serial numbers of certificates that have been declared invalid  after  they  have
       been  issued.   Such  usually  happens  because the private key for the certificate has been compromised,
       because the owner of the certificate has left the organization that is mentioned in the certificate, etc.
       To seriously use S/MIME or TLS verification, an up-to-date CRL is required for each trusted CA.  There is
       otherwise no method to distinguish between valid and invalidated certificates.  S-nail  currently  offers
       no  mechanism  to  fetch  CRLs,  nor to access them on the Internet, so they have to be retrieved by some
       external mechanism.

       S-nail accepts CRLs in PEM format only; CRLs in DER format must be converted, like, e.g.:

             <b>$</b> <b>openssl</b> <b>crl</b> <b>-inform</b> <b>DER</b> <b>-in</b> <b>crl.der</b> <b>-out</b> <b>crl.pem</b>

       To tell S-nail about the CRLs, a directory that contains all CRL files  (and  no  other  files)  must  be
       created.   The  <u>smime-crl-dir</u>  or  <u>tls-crl-dir</u> variables, respectively, must then be set to point to that
       directory.  After that, S-nail requires a CRL to be present  for  each  CA  that  is  used  to  verify  a
       certificate.

</pre><h4><b>FAQ</b></h4><pre>
       In  general  it  is  a good idea to turn on <u>debug</u> (<b>-d</b>) and / or <u>verbose</u> (<b>-v</b>, twice) if something does not
       work well.  Very often a diagnostic message can be produced that leads to the problems' solution.

   <b>S-nail</b> <b>shortly</b> <b>hangs</b> <b>on</b> <b>startup</b>
       This can have two reasons, one is the necessity to wait for a file lock and cannot be helped,  the  other
       being  that  S-nail  calls the function <u><a href="../man2/uname.2.html">uname</a></u>(2) in order to query the nodename of the box (sometimes the
       real one is needed instead of the one represented by the  internal  variable  <u>hostname</u>).   One  may  have
       varying  success  by ensuring that the real hostname and ‘localhost’ have entries in <u><a href="file:/etc/hosts">/etc/hosts</a></u>, or, more
       generally, that the name service is properly setup – and does  <u><a href="../man1/hostname.1.html">hostname</a></u>(1)  return  the  expected  value?
       Does  this  local  hostname  have a domain suffix?  RFC 6762 standardized the link-local top-level domain
       ‘.local’, try again after adding an (additional) entry with this extension.

   <b>I</b> <b>cannot</b> <b>login</b> <b>to</b> <b>Google</b> <b>mail</b> <b>(via</b> <b>OAuth)</b>
       Since 2014 some free service providers classify programs as “less  secure”  unless  they  use  a  special
       authentication  method  (OAuth 2.0) which was not standardized for non-HTTP protocol authentication token
       query until August 2015 (RFC 7628).

       Different to Kerberos / GSSAPI, which is developed since the mid of the 1980s, where a  user  can  easily
       create  a  local  authentication ticket for her- and himself with the locally installed <u><a href="../man1/kinit.1.html">kinit</a></u>(1) program,
       that protocol has no such local part but instead requires a world-wide-web query to  create  or  fetch  a
       token; since there is no local cache this query would have to be performed whenever S-nail is invoked (in
       interactive sessions situation may differ).

       S-nail does not directly support OAuth.  It, however, supports XOAUTH2 / OAUTHBEARER, see “But, how about
       XOAUTH2 / OAUTHBEARER?” If that is not used it is necessary to declare S-nail a “less secure app” (on the
       providers  account web page) in order to read and send mail.  However, it also seems possible to take the
       following steps instead:

       1.   give the provider the number of a mobile phone,
       2.   enable “2-Step Verification”,
       3.   create an application specific password (16 characters), and
       4.   use that special password instead of the real Google account password in S-nail (for  more  on  that
            see the section “On URL syntax and credential lookup”).

   <b>But,</b> <b>how</b> <b>about</b> <b>XOAUTH2</b> <b>/</b> <b>OAUTHBEARER?</b>
       Following  up  “I  cannot  login  to  Google  mail  (via OAuth)” one OAuth-based authentication method is
       available: the OAuth 2.0 bearer token usage as standardized in RFC 6750 (according SASL mechanism in  RFC
       7628),  also  known as XOAUTH2 and OAUTHBEARER, allows fetching a temporary access token via the web that
       can locally be used as a <u>password</u>.  The protocol is simple and extendable, token updates or even password
       changes via a simple TLS secured server login would be possible in theory, but today a web browser and an
       external support tool are prerequisites for using this authentication method.  The token  times  out  and
       must be periodically refreshed via the web.

       Some  hurdles  must  be  taken  before  being  able  to  use  this method.  Using GMail as an example, an
       application (that is a name) must be registered, for which credentials,  a  “client  ID”  and  a  “client
       secret”,  need  to be created and saved locally (in a secure way).  These initial configuration steps can
       be performed at https://console.developers.google.com/apis/credentials.  Thereafter a refresh  token  can
       be  requested;  a  python  program  to  do  this  for  GMail accounts is https://github.com/google/gmail-
       oauth2-tools/raw/master/python/oauth2.py:

             $ python oauth2.py --user=EMAIL \
               --client-id=THE-ID --client-secret=THE-SECRET \
               --generate_oauth2_token
             To authorize token, visit this url and follow the directions:
               https://accounts.google.com/o/oauth2/auth?client_id=...
               Enter verification code: ...
               Refresh Token: ...
               Access Token: ...
               Access Token Expiration Seconds: 3600
             $ # Of which the last three are actual token responses.
             $ # Thereafter access tokens can regularly be refreshed
             $ # via the created refresh token (read on)

       The generated refresh token must also be saved locally (securely).  The procedure as a whole can be  read
       at  https://github.com/google/gmail-oauth2-tools/wiki/OAuth2DotPyRunThrough.   Since  periodic timers are
       not yet supported, keeping an access token up-to-date (from within S-nail) can only be performed via  the
       hook <u>on-main-loop-tick</u>, or (for sending only) <u>on-compose-enter</u> (for more on authentication please see the
       section “On URL syntax and credential lookup”):

             set on-main-loop-tick=o-m-l-t on-compose-enter=o-c-e
             define o-m-l-t {
               xcall update_access_token
             }
             define o-c-e {
               xcall update_access_token
             }

             set access_token_=0
             define update_access_token {
               local set i epoch_sec epoch_nsec
               vput vexpr i epoch
               eval set $i # set epoch_sec/_nsec of vexpr epoch
               vput vexpr i + $access_token_ 2100
               if $epoch_sec -ge $i
                 vput ! password python oauth2.py --user=EMAIL \
                     --client-id=THE-ID --client-secret=THE-SECRET \
                     --refresh-token=THE-REFRESH-TOKEN |\
                   sed '1b PASS;d; :PASS s/^.\{1,\}:\(.\{1,\}\)$/\1/'
                 vput csop password trim "$password"
                 if -n "$verbose"
                   echo password is &lt;$password&gt;
                 endif
                 set access_token_=$epoch_sec
               endif
             }

   <b>Not</b> <b>"defunctional",</b> <b>but</b> <b>the</b> <b>editor</b> <b>key</b> <b>does</b> <b>not</b> <b>work</b>
       Two  thinkable  situations: the first is a shadowed sequence; setting <u>debug</u>, or the most possible <u>verbose</u>
       mode, causes a printout of the <b>bind</b> tree after that is built; being  a  cache,  this  happens  only  upon
       startup or after modifying bindings.

       Or  second,  terminal  libraries  (see  “On  terminal control and line editor”, <b>bind</b>, <u>termcap</u>) may report
       different codes than the terminal really sends, rendering bindings  dysfunctional  because  expected  and
       received  data  do  not  match;  the  <u>verbose</u>  listing  of <b>bind</b>ings will show the byte sequences that are
       expected.  (One common source of problems is that the — possibly even non-existing — keypad is not turned
       on, and the resulting layout reports the keypad control codes for the normal keyboard keys.)

       To overcome the situation use for example the program <u><a href="../man1/cat.1.html">cat</a></u>(1) with its option <b>-v</b>, if available, to see the
       byte sequences which are actually produced by keypresses, and use the variable  <u>termcap</u>  to  make  S-nail
       aware of them.  The terminal this is typed on produces some unexpected sequences, here for an example the
       shifted home key:

             ? set verbose
             ? bind*
             # 1B 5B=[ 31=1 3B=; 32=2 48=H
               bind base :kHOM z0
             ? x
             $ cat -v
             ^[[H
             $ s-nail -v -Stermcap='kHOM=\E[H'
             ? bind*
             # 1B 5B=[ 48=H
               bind base :kHOM z0

   <b>Can</b> <b>S-nail</b> <b>git-send-email?</b>
       Yes.  Put (at least parts of) the following in your <u><a href="file:~/.gitconfig">~/.gitconfig</a></u>:

             [sendemail]
             smtpserver = /usr/bin/s-nail
             smtpserveroption = -t
             #smtpserveroption = -Sexpandaddr
             smtpserveroption = -Athe-account-you-need
             ##
             suppresscc = all
             suppressfrom = false
             assume8bitEncoding = UTF-8
             #to = /tmp/OUT
             confirm = always
             chainreplyto = true
             multiedit = false
             thread = true
             quiet = true
             annotate = true

       Newer  <u><a href="../man1/git.1.html">git</a></u>(1)  versions  (v2.33.0)  added the option <b>sendmailCmd</b>.  Patches can also be send directly, for
       example:

             $ git format-patch -M --stdout HEAD^ |
               s-nail -A the-account-you-need -t RECEIVER

   <b>Howto</b> <b>handle</b> <b>stale</b> <b>dotlock</b> <b>files</b>
       <b>folder</b> sometimes fails to open MBOX mail databases because creation of “dotlock files” is impossible  due
       to existing but unowned lock files.  S-nail does not offer an option to deal with those files, because it
       is  considered a site policy what counts as unowned, and what not.  The site policy is usually defined by
       administrator(s), and expressed in the configuration of a locally  installed  MTA  (for  example  Postfix
       ‘stale_lock_time=500s’).  Therefore the suggestion:

             $ &lt;/dev/null s-nail -s 'MTA: be no frog, handle lock' $LOGNAME

       By  sending  a  mail  to  yourself  the  local MTA can use its normal queue mechanism to try the delivery
       multiple times, finally decide a lock file has become stale, and remove it.

</pre><h4><b>IMAP</b> <b>CLIENT</b></h4><pre>
       [Option]ally there is IMAP client support available.  This part of  the  program  is  obsolete  and  will
       vanish in v15 with the large MIME and I/O layer rewrite, because it uses old-style blocking I/O and makes
       excessive  use  of  signal based long code jumps.  Support can hopefully be readded later based on a new-
       style I/O, with SysV signal handling.  In fact the  IMAP  support  had  already  been  removed  from  the
       codebase,  but  was  reinstantiated  on  user  demand:  in effect the IMAP code is at the level of S-nail
       v14.8.16 (with <b>imapcodec</b> being the sole exception), and should be treated with some care.

       IMAP uses the ‘imap://’ and ‘imaps://’ protocol prefixes, and an IMAP-based <u>folder</u>  may  be  used.   IMAP
       URLs  (paths)  undergo inspections and possible transformations before use (and the command <b>imapcodec</b> can
       be used to manually apply them to any given argument).  Hierarchy delimiters are normalized, a step which
       is configurable via the <u>imap-delim</u> variable chain, but defaults to the first  seen  delimiter  otherwise.
       S-nail supports internationalised IMAP names, and en- and decodes the names from and to the <u>ttycharset</u> as
       necessary  and  possible.   If  a  mailbox  name  is expanded (see “Filename transformations”) to an IMAP
       mailbox, all names that begin with `+' then refer to IMAP mailboxes below the <u>folder</u>  target  box,  while
       folder  names  prefixed  by `@' refer to folders below the hierarchy base, so the following will list all
       folders below the current one when in an IMAP mailbox: ‘folders @’.

       Note: some IMAP servers do not accept the creation of mailboxes in the hierarchy base, but  require  that
       they are created as subfolders of `INBOX' – with such servers a folder name of the form

             <b>imaps://<a href="mailto:mylogin@imap.myisp.example">mylogin@imap.myisp.example</a>/INBOX.</b>

       should  be  used  (the  last character is the server's hierarchy delimiter).  The following IMAP-specific
       commands exist:

       <b>cache</b>     Only applicable to cached IMAP mailboxes; takes a message list and reads the specified messages
                 into the IMAP cache.

       <b>connect</b>   If operating in disconnected mode on an IMAP mailbox, switch to online mode and connect to  the
                 mail  server  while  retaining  the  mailbox  status.   See the description of the <u>disconnected</u>
                 variable for more information.

       <b>disconnect</b>
                 If operating in online mode on an IMAP mailbox, switch to disconnected mode while retaining the
                 mailbox status.  See the description of the <u>disconnected</u> variable for more.  A list of messages
                 may optionally be given as argument; the respective messages  are  then  read  into  the  cache
                 before  the  connection  is  closed,  thus  ‘disco  *’  makes  the entire mailbox available for
                 disconnected use.

       <b>imap</b>      Sends command strings directly to the current IMAP server.   S-nail  operates  always  in  IMAP
                 `selected  state'  on  the  current mailbox; commands that change this will produce undesirable
                 results and should be avoided.  Useful IMAP commands are:

                       create         Takes the name of an IMAP mailbox as an argument and creates it.

                       getquotaroot   (RFC 2087) Takes the name of an IMAP mailbox as an argument and prints the
                                      quotas that apply to the mailbox.   Not  all  IMAP  servers  support  this
                                      command.

                       namespace      (RFC  2342)  Takes  no  arguments  and prints the Personal Namespaces, the
                                      Other User's Namespaces and the Shared Namespaces.  Each namespace type is
                                      printed in parentheses; if there are multiple namespaces of the same type,
                                      inner parentheses separate them.   For  each  namespace  a  prefix  and  a
                                      hierarchy separator is listed.  Not all IMAP servers support this command.

       <b>imapcodec</b>
                 Perform  IMAP  path  transformations.  Supports <b>vput</b> (see “Command modifiers”), and manages the
                 error number <u>!</u>.  The first argument specifies  the  operation:  <u>e[ncode]</u>  normalizes  hierarchy
                 delimiters  (see  <u>imap-delim</u>)  and  converts  the  strings  from  the  locale <u>ttycharset</u> to the
                 internationalized variant used by IMAP, <u>d[ecode]</u> performs the reverse operation.  Encoding will
                 honour the (global) value of <u>imap-delim</u>.

       The following IMAP-specific internal variables exist:

       <u>disconnected</u>
                 (Boolean) When an IMAP mailbox is selected and this variable  is  set,  no  connection  to  the
                 server  is  initiated.   Instead,  data  is  obtained  from  the  local cache (see <u>imap-cache</u>).
                 Mailboxes that are not present in the cache and  messages  that  have  not  yet  entirely  been
                 fetched  from  the  server  are  not available; to fetch all messages in a mailbox at once, the
                 command `<b>copy</b> <b>*</b> <b>/dev/null</b>' can be used while still in connected mode.  Changes that are made to
                 IMAP mailboxes in disconnected mode are queued and committed later when a  connection  to  that
                 server  is  made.  This procedure is not completely reliable since it cannot be guaranteed that
                 the IMAP unique identifiers (UIDs) on the server still match the ones  in  the  cache  at  that
                 time.  Data is saved to DEAD when this problem occurs.

       <u>disconnected-USER@HOST</u>
                 The  specified  account  is handled as described for the <u>disconnected</u> variable above, but other
                 accounts are not affected.

       <u>imap-auth-USER@HOST</u>, <u>imap-auth</u>
                 Sets the IMAP authentication method.  Supported are the default ‘login’ (called ‘plain’ by some
                 servers), [v15-compat] ‘oauthbearer’ (see “FAQ” entry “But, how about XOAUTH2 / OAUTHBEARER?”),
                 [v15-compat] ‘external’ and ‘externanon’ (for TLS  secured  connections  which  pass  a  client
                 certificate  via  <u>tls-config-pairs</u>),  as  well  as the [Option]al ‘cram-md5’ and ‘gssapi’.  All
                 methods need a <u>user</u> and a <u>password</u> except ‘gssapi’ and ‘external’, which only need the  former.
                 ‘externanon’ solely builds upon the credentials passed via a client certificate, and is usually
                 the  way  to  go  since  tested servers do not actually follow RFC 4422, and fail if additional
                 credentials are actually passed.

       <u>imap-cache</u>
                 Enables caching of IMAP mailboxes.  The value of this variable must point to a  directory  that
                 is  either  existent  or can be created by S-nail.  All contents of the cache can be deleted by
                 S-nail at any time; it is not safe to make assumptions about them.

       <u>imap-delim-USER@HOST</u>, <u>imap-delim-HOST</u>, <u>imap-delim</u>
                 The hierarchy separator used by the IMAP server.  Whenever an IMAP path is  specified  it  will
                 undergo  normalization.   One  of  the  normalization  steps is the squeezing and adjustment of
                 hierarchy separators.  If this variable is set, any occurrence of any character  of  the  given
                 value that exists in the path will be replaced by the first member of the value; an empty value
                 will  cause  the default to be used, it is ‘<a href="file:/.">/.</a>’.  If not set, we will reuse the first hierarchy
                 separator character that is discovered in a user-given mailbox name.

       <u>imap-keepalive-USER@HOST</u>, <u>imap-keepalive-HOST</u>, <u>imap-keepalive</u>
                 IMAP servers may close the connection after a period of inactivity; the standard requires  this
                 to  be  at  least  30  minutes,  but practical experience may vary.  Setting this variable to a
                 numeric `value' greater than 0 causes a `NOOP' command to be sent each `value'  seconds  if  no
                 other operation is performed.

       <u>imap-list-depth</u>
                 When  retrieving  the list of folders on an IMAP server, the <b>folders</b> command stops after it has
                 reached a certain depth to avoid possible infinite loops.  The value of this variable sets  the
                 maximum  depth  allowed.  The default is 2.  If the folder separator on the current IMAP server
                 is a slash `/', this variable has no effect  and  the  <b>folders</b>  command  does  not  descend  to
                 subfolders.

       <u>imap-use-starttls-USER@HOST</u>, <u>imap-use-starttls-HOST</u>, <u>imap-use-starttls</u>
                 Causes  S-nail to issue a `STARTTLS' command to make an unencrypted IMAP session TLS encrypted.
                 This functionality is not supported by all servers, and is not used if the session  is  already
                 encrypted by the IMAPS method.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/bogofilter.1.html">bogofilter</a></u>(1), <u><a href="../man1/gpg.1.html">gpg</a></u>(1), <u><a href="../man1/more.1.html">more</a></u>(1), <u><a href="../man1/newaliases.1.html">newaliases</a></u>(1), <u><a href="../man1/openssl.1.html">openssl</a></u>(1), <u><a href="../man1/sendmail.1.html">sendmail</a></u>(1), <u><a href="../man1/sh.1.html">sh</a></u>(1), <u><a href="../man1/spamassassin.1.html">spamassassin</a></u>(1), <u><a href="../man3/iconv.3.html">iconv</a></u>(3),
       <u><a href="../man3/setlocale.3.html">setlocale</a></u>(3),  <u><a href="../man5/aliases.5.html">aliases</a></u>(5),  <u><a href="../man5/termcap.5.html">termcap</a></u>(5),  <u><a href="../man5/terminfo.5.html">terminfo</a></u>(5), <u><a href="../man7/locale.7.html">locale</a></u>(7), <u><a href="../man7/mailaddr.7.html">mailaddr</a></u>(7), <u><a href="../man7/re_format.7.html">re_format</a></u>(7) (or <u><a href="../man7/regex.7.html">regex</a></u>(7)),
       <u><a href="../man8/mailwrapper.8.html">mailwrapper</a></u>(8), <u><a href="../man8/sendmail.8.html">sendmail</a></u>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       M. Douglas McIlroy  writes  in  his  article  “A  Research  UNIX  Reader:  Annotated  Excerpts  from  the
       Programmer's Manual, 1971-1986” that a <u><a href="../man1/mail.1.html">mail</a></u>(1) command already appeared in First Edition Unix in 1971:

             Electronic mail was there from the start.  Never satisfied with its exact behavior, everybody
             touched it at one time or another: to assure the safety of simultaneous access, to improve privacy,
             to survive crashes, to exploit uucp, to screen out foreign freeloaders, or whatever.  Not until v7
             did the interface change (Thompson).  Later, as mail became global in its reach, Dave Presotto took
             charge and brought order to communications with a grab-bag of external networks (v8).

       BSD  Mail,  in large parts compatible with Unix mail, was written in 1978 by Kurt Shoens and developed as
       part of the BSD Unix distribution until 1995.  This manual page  is  derived  from  “The  Mail  Reference
       Manual”  that  Kurt  Shoens  wrote  for  Mail  1.3,  included  in  3BSD in 1980.  The common Unix and BSD
       denominator became standardized as <u><a href="../man1/mailx.1.html">mailx</a></u>(1) in the X/Open  Portability  Guide  Issue  2  (January  1987).
       After  the rise of Open Source BSD variants Mail saw continuous development in the individual code forks,
       noticeably by Christos Zoulas in NetBSD.  Based upon this Nail, later Heirloom Mailx,  was  developed  by
       Gunnar Ritter in the years 2000 until 2008.  Since 2012 S-nail is maintained by Steffen Nurpmeso.

       Electronic  mail  exchange  in  general is a concept even older.  The earliest well documented electronic
       mail system was part of the Compatible Time Sharing System (CTSS) at  MIT,  its  MAIL  command  had  been
       proposed  in  a staff planning memo at the end of 1964 and was implemented in mid-1965 when Tom Van Vleck
       and Noel Morris  wrote  the  necessary  code.   Similar  communication  programs  were  built  for  other
       timesharing  systems.  One of the most ambitious and influential was Murray Turoff's EMISARI.  Created in
       1971 for the United States Office of Emergency Preparedness, EMISARI combined private electronic messages
       with a chat system, public postings, voting, and a user directory.

       During the 1960s it was common to connect a large number of terminals  to  a  single,  central  computer.
       Connecting  two  computers together was relatively unusual.  This began to change with the development of
       the ARPANET, the ancestor of today's Internet.   In  1971  Ray  Tomlinson  adapted  the  SNDMSG  program,
       originally  developed  for  the  University  of California at Berkeley timesharing system, to give it the
       ability to transmit a message across the network into the mailbox of a user on a different computer.  For
       the first time it was necessary to  specify  the  recipient's  computer  as  well  as  an  account  name.
       Tomlinson decided that the underused commercial at ‘@’ would work to separate the two.

       Sending a message across the network was originally treated as a special instance of transmitting a file,
       and  so a MAIL command was included in RFC 385 on file transfer in 1972.  Because it was not always clear
       when or where a message had come from, RFC 561 in  1973  aimed  to  formalize  electronic  mail  headers,
       including  “from”, “date”, and “subject”.  In 1975 RFC 680 described fields to help with the transmission
       of messages to multiple users, including “to”, “cc”, and “bcc”.  In 1977 these features and  others  went
       from  best  practices  to  a binding standard in RFC 733.  Queen Elizabeth II of England became the first
       head of state to send electronic mail on March 26 1976 while  ceremonially  opening  a  building  in  the
       British Royal Signals and Radar Establishment (RSRE) in Malvern.

</pre><h4><b>AUTHORS</b></h4><pre>
       Kurt  Shoens,  Edward Wang, Keith Bostic, Christos Zoulas, Gunnar Ritter.  S-nail is developed by Steffen
       Nurpmeso &lt;<a href="mailto:s-mailx@lists.sdaoden.eu">s-mailx@lists.sdaoden.eu</a>&gt;.

</pre><h4><b>CAVEATS</b></h4><pre>
       [v15 behaviour may differ] Interrupting an operation via SIGINT aka ‘control-C’ from anywhere else but  a
       command  prompt  is  very problematic and likely to leave the program in an undefined state: many library
       functions cannot deal with the <b>siglongjmp</b>(<u>3</u>) that this software (still)  performs;  even  though  efforts
       have  been  taken  to address this, no sooner but in v15 it will have been worked out: interruptions have
       not been disabled in order to allow forceful breakage of hanging network connections,  for  example  (all
       this is unrelated to <u>ignore</u>).

       The  SMTP  and  POP3 protocol support of S-nail is very basic.  Also, if it fails to contact its upstream
       SMTP server, it will not make further attempts to transfer the message at a later time (setting <u>save</u>  and
       <u>sendwait</u>  may be useful).  If this is a concern, it might be better to set up a local SMTP server that is
       capable of message queuing.

</pre><h4><b>BUGS</b></h4><pre>
       When a network-based mailbox is open, directly changing to another network-based mailbox of  a  different
       protocol (i.e., from POP3 to IMAP or vice versa) will cause a “deadlock”.

       After  deleting  some  message  of  a  POP3  mailbox  the header summary falsely claims that there are no
       messages to display, one needs to perform a scroll or dot movement to restore proper state.

       In ‘thread’ed <b>sort</b> mode a power user may encounter crashes very occasionally (this is may and very).

       Please report  bugs  to  the  <u>contact-mail</u>  address,  for  example  from  within  s-nail:  ‘?  <b>eval</b>  <b>mail</b>
       $contact-mail’.  Including the <u>verbose</u> output of the command <b>version</b> may be helpful:

             ? wysh set escape=! verbose; vput version xy; unset verbose;\
               eval mail $contact-mail
             Bug subject
             !I xy
             !.

       Information on the web at ‘$ s-nail -X 'echo $<u>contact-web</u>; x'’.

Debian                                            June 27, 2024                                        <u><a href="../man1/S-NAIL.1.html">S-NAIL</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>