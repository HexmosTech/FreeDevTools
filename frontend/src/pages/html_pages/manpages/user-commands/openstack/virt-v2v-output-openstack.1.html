<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>virt-v2v-output-openstack - Using virt-v2v to convert guests to OpenStack</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/virt-v2v">virt-v2v_2.6.0-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       virt-v2v-output-openstack - Using virt-v2v to convert guests to OpenStack

</pre><h4><b>SYNOPSIS</b></h4><pre>
        virt-v2v [-i* options] -o openstack
                               -oo server-id=SERVER
                               [-oo guest-id=GUEST]
                               [-oo verify-server-certificate=false]
                               [-oo os-username=admin] [-oo os-*=*]

        virt-v2v [-i* options] -o glance

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This page documents how to use <b><a href="../man1/virt-v2v.1.html">virt-v2v</a></b>(1) to convert guests to run on OpenStack.  There are two output
       modes you can select, but only <u>-o</u> <u>openstack</u> should be used normally.

       <b>-o</b> <b>openstack</b> <b>-oo</b> <b>server-id=</b>SERVER [...]
           Full description: "OUTPUT TO OPENSTACK"

           This  is  the  modern  method  for  uploading  to OpenStack via the REST API.  Guests can be directly
           converted into Cinder volumes.

       <b>-o</b> <b>glance</b>
           Full description: "OUTPUT TO GLANCE"

           This is the old method for uploading to Glance.  Unfortunately Glance is not well suited  to  storing
           converted  guests  (since  virt-v2v  deals with "pets" not templated "cattle"), so this method is not
           recommended unless you really know what you are doing.

</pre><h4><b>OUTPUT</b> <b>TO</b> <b>OPENSTACK</b></h4><pre>
       To output to OpenStack, use the <u>-o</u> <u>openstack</u> option.

   <b>OpenStack:</b> <b>Setting</b> <b>up</b> <b>a</b> <b>conversion</b> <b>appliance</b>
       When virt-v2v is converting to OpenStack, it is unusual in that virt-v2v <b>must</b> be running inside a virtual
       machine running on top of the OpenStack overcloud.   This  virtual  machine  is  called  the  "conversion
       appliance".  Note this virtual machine is unrelated to the guest which is being converted.

       The  reason  for  this  is  because  to  create  Cinder volumes that will contain the guest data (for the
       converted guest) we must attach those Cinder volumes to an OpenStack virtual machine.

       The "openstack" command must be installed in the appliance.  We use it for communicating with OpenStack.

       When virt-v2v is running in the conversion appliance, you must supply the name or UUID of the  conversion
       appliance to virt-v2v, eg:

        $ openstack server list
        +--------------------------------------+-----------+--------+
        | ID                                   | Name      | Status |
        +--------------------------------------+-----------+--------+
        | bbb0147a-44b9-4d19-9a9d-10ca9a984744 | test1     | ACTIVE |
        +--------------------------------------+-----------+--------+

        # virt-v2v [...] \
              -o openstack -oo server-id=bbb0147a-44b9-4d19-9a9d-10ca9a984744

       or:

        # virt-v2v [...] -o openstack -oo server-id=test1

       You can run many parallel conversions inside a single conversion appliance if you want, subject to having
       enough  resources  available.   However  OpenStack  itself  imposes  a limit that you should be aware of:
       OpenStack cannot attach more than around 25 disks [the exact  number  varies  with  configuration]  to  a
       single  appliance,  and that limits the number of guests which can be converted in parallel, because each
       guest's disk must be attached to the appliance while being copied.

   <b>OpenStack:</b> <b>Authentication</b>
       Converting to OpenStack requires access to the tenant (non-admin) API endpoints.  You will need to either
       set up your "$OS_*" environment variables  or  use  output  options  on  the  virt-v2v  command  line  to
       authenticate with OpenStack.

       For example:

        export OS_USERNAME=admin

       or:

        virt-v2v [...] -o openstack -oo os-username=admin

       are equivalent, and have the same effect as using <u>--os-username</u> on the command line of OpenStack tools.

       Normally  there  is  a  file  called <u>overcloudrc</u> or <u>keystonerc_admin</u> which you can simply "source" to set
       everything up.

       If you need to copy <u>overcloudrc</u> to another machine, check if it  references  the  "OS_CLOUD"  environment
       variable.    If   so,   you   may   have   to   copy   the   <u>clouds.yaml</u>  file  from  <u>/etc/openstack/</u>  or
       <u>$HOME/.config/openstack/</u> to the other machine as well.  See the  section  "CLOUD  CONFIGURATION"  in  the
       openstack CLI manual.

   <b>OpenStack:</b> <b>Running</b> <b>as</b> <b>root</b>
       Because  virt-v2v  must  access  Cinder  volumes  which  are  presented as <u><a href="file:/dev">/dev</a></u> devices to the conversion
       appliance, virt-v2v must usually run as root in <u>-o</u> <u>openstack</u> mode.

       If you use "sudo" to start virt-v2v and you are using environment variables for authentication,  remember
       to use the "sudo -E" option to preserve the environment.

   <b>OpenStack:</b> <b>Guest</b> <b>ID</b>
        virt-v2v [...] -o openstack -oo guest-id=123-456-7890

       You  may  optionally  specify  <u>-oo</u> <u>guest-id=...</u> on the command line.  The ID (which can be any string) is
       saved on each Cinder volume in the "virt_v2v_guest_id" volume property.

       This can be used to find disks associated with a guest, or to associate which disks are related to  which
       guests when converting many guests.

   <b>OpenStack:</b> <b>Ignore</b> <b>server</b> <b>certificate</b>
       Using  <u>-oo</u>  <u>verify-server-certificate=false</u>  you  can  tell  the  openstack  client  to ignore the server
       certificate when connecting to the OpenStack API endpoints.  This has the  same  effect  as  passing  the
       <u>--insecure</u> option to the "openstack" command.

   <b>OpenStack:</b> <b>Converting</b> <b>a</b> <b>guest</b>
       The final command to convert the guest, running as root, will be:

        # virt-v2v [-i options ...] \
              -o openstack -oo server-id=NAME|UUID [-oo guest-id=ID]

       If you include authentication options on the command line then:

        # virt-v2v [-i options ...] \
              -o openstack -oo server-id=NAME|UUID -oo os-username=admin [etc]

   <b>OpenStack:</b> <b>Booting</b> <b>the</b> <b>guest</b>
       Guests  are  converted as Cinder volume(s) (one volume per disk in the original guest).  To boot them use
       the "openstack server create --volume" option:

        $ openstack volume list
        +--------------------------------------+---------------+-----------+
        | ID                                   | Name          | Status    |
        +--------------------------------------+---------------+-----------+
        | c4d06d15-22ef-462e-9eff-ab54ab285a1f | fedora-27-sda | available |
        +--------------------------------------+---------------+-----------+
        $ openstack server create \
              --flavor x1.small \
              --volume c4d06d15-22ef-462e-9eff-ab54ab285a1f \
              myguest
        $ openstack console url show myguest

   <b>OpenStack:</b> <b>Other</b> <b>conversion</b> <b>options</b>
       To specify the Cinder volume type, use <u>-os</u>.  If not specified then no Cinder volume type is used.

       The following options are <b>not</b> supported with OpenStack: <u>-oa</u>, <u>-of</u>.

</pre><h4><b>OUTPUT</b> <b>TO</b> <b>GLANCE</b></h4><pre>
       Note this is a legacy option.  In most cases you should use "OUTPUT TO OPENSTACK" instead.

       To output to OpenStack Glance, use the <u>-o</u> <u>glance</u> option.

       This runs the <b><a href="../man1/glance.1.html">glance</a></b>(1) CLI program which must  be  installed  on  the  virt-v2v  conversion  host.   For
       authentication   to   work,  you  will  need  to  set  "OS_*"  environment  variables.   See  "OpenStack:
       Authentication" above.

       Virt-v2v adds metadata for the guest to Glance, describing such things as the guest operating system  and
       what drivers it requires.  The command "glance image-show" will display the metadata as "Property" fields
       such as "os_type" and "hw_disk_bus".

   <b>Glance</b> <b>and</b> <b>sparseness</b>
       Glance  image upload doesn't appear to correctly handle sparseness.  For this reason, using qcow2 will be
       faster and use less space on the Glance server.  Use the virt-v2v <u>-of</u> <u>qcow2</u> option.

   <b>Glance</b> <b>and</b> <b>multiple</b> <b>disks</b>
       If the guest has a single disk, then the name of the disk in Glance will be the name of the  guest.   You
       can control this using the <u>-on</u> option.

       Glance  doesn't  have a concept of associating multiple disks with a single guest, and Nova doesn't allow
       you to boot a guest from multiple Glance disks either.  If the guest has multiple disks, then  the  first
       (assumed to be the system disk) will have the name of the guest, and the second and subsequent data disks
       will  be  called  "<u>guestname</u>-disk2",  "<u>guestname</u>-disk3"  etc.  It may be best to leave the system disk in
       Glance, and import the data disks to Cinder.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/virt-v2v.1.html">virt-v2v</a></b>(1), https://docs.openstack.org/python-openstackclient/latest/cli/man/openstack.html, <b><a href="../man1/glance.1.html">glance</a></b>(1).

</pre><h4><b>AUTHOR</b></h4><pre>
       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2009-2020 Red Hat Inc.

</pre><h4><b>LICENSE</b></h4><pre>
       This program is free software; you can redistribute it and/or modify  it  under  the  terms  of  the  GNU
       General  Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This program is distributed in the hope that it will be useful, but WITHOUT ANY  WARRANTY;  without  even
       the  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with this program; if not,  write
       to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

</pre><h4><b>BUGS</b></h4><pre>
       To      get      a      list      of      bugs      against      libguestfs,      use      this     link:
       https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools

       To      report      a      new       bug       against       libguestfs,       use       this       link:
       https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools

       When reporting a bug, please supply:

       •   The version of libguestfs.

       •   Where you got libguestfs (eg. which Linux distro, compiled from source, etc)

       •   Describe the bug accurately and give a way to reproduce it.

       •   Run <b><a href="../man1/libguestfs-test-tool.1.html">libguestfs-test-tool</a></b>(1) and paste the <b>complete,</b> <b>unedited</b> output into the bug report.

virt-v2v-2.6.0                                     2024-11-30                       <u><a href="../man1/virt-v2v-output-openstack.1.html">virt-v2v-output-openstack</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>