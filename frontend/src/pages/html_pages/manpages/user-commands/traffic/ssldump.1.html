<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ssldump - dump SSL traffic on a network</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/ssldump">ssldump_1.9-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ssldump - dump SSL traffic on a network

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ssldump</b> [ <b>-aAdeFHjnNPqtTvxXyz</b> ] [ <b>-i</b> <u>interface</u> ]
               [ <b>-k</b> <u>keyfile</u> ] [ <b>-l</b> <u>sslkeylogfile</u> ] [ <b>-p</b> <u>password</u> ] [ <b>-r</b> <u>dumpfile</u> ] [ <b>-w</b> <u>outputpcap</u> ]
               [ <b>-S</b> [<u>crypto</u>|<u>d</u>|<u>ht</u>|<u>H</u>|<u>nroff</u>] ] [ <u>expression</u> ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>ssldump</u>  is  an  SSL/TLS  network  protocol analyzer. It identifies TCP connections on the chosen network
       interface and attempts to interpret them as SSL/TLS traffic.  When  it  identifies  SSL/TLS  traffic,  it
       decodes  the  records  and  displays  them  in a textual form to stdout. If provided with the appropriate
       keying material, it will also decrypt the connections and  display  the  application  data  traffic.   It
       supports  various  version of SSL/TLS up to TLS version 1.3.  It also includes support for JSON output or
       JA3 support.

       <u>ssldump</u> has been originally tested on FreeBSD, Linux, Solaris, and HP/UX. <u>ssldump</u> has mainly a new  build
       process  and  it's  mainly tested on different Linux flavors. Since it's based on PCAP, it should work on
       most platforms. However, unlike tcpdump, <u>ssldump</u> needs  to  be  able  to  see  both  sides  of  the  data
       transmission  so  you may have trouble using it with network taps such as SunOS nit that don't permit you
       to see transmitted data.  <b>Under</b> <b>SunOS</b> <b>with</b> <b>nit</b> <b>or</b> <b>bpf:</b> To run  <u>ssldump</u>  you  must  have  read  access  to
       <u>/dev/nit</u>  or <u>/dev/bpf*</u>.  <b>Under</b> <b>Solaris</b> <b>with</b> <b>dlpi:</b> You must have read access to the network pseudo device,
       e.g.  <u>/dev/le</u>.  <b>Under</b> <b>HP-UX</b> <b>with</b> <b>dlpi:</b> You must be root or it must be installed setuid  to  root.   <b>Under</b>
       <b>IRIX</b>  <b>with</b> <b>snoop:</b> You must be root or it must be installed setuid to root.  <b>Under</b> <b>Linux:</b> You must be root
       or it must be installed setuid to root.  <b>Under</b> <b>Ultrix</b> <b>and</b> <b>Digital</b> <b>UNIX:</b> Once the super-user  has  enabled
       promiscuous-mode  operation  using  <u><a href="../man8/pfconfig.8.html">pfconfig</a></u>(8),  any  user may run <u>ssldump</u> <b>Under</b> <b>BSD:</b> You must have read
       access to <u>/dev/bpf*</u>.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b>     Print bare TCP ACKs (useful for observing Nagle behavior).

       <b>-A</b>     Print all record fields (by default <u>ssldump</u> chooses the most interesting fields).

       <b>-d</b>     Display the application data traffic. This usually means  decrypting  it,  but  when  -d  is  used
              <u>ssldump</u>  will  also decode application data traffic <u>before</u> the SSL session initiates.  This allows
              you to see HTTPS CONNECT behavior as well as SMTP STARTTLS. As a side effect, since <u>ssldump</u>  can't
              tell whether plaintext is traffic before the initiation of an SSL connection or just a regular TCP
              connection,  this  allows  you  to  use  <u>ssldump</u>  to  sniff  any  TCP  connection.   <u>ssldump</u>  will
              automatically detect ASCII data and display it directly to the screen. non-ASCII data is displayed
              as hex dumps. See also -X.

       <b>-e</b>     Print absolute timestamps instead of relative timestamps.

       <b>-F</b>     Specify the number of packets after which a connection pool cleaning  is  performed  (in  packets,
              default: 100).

       <b>-H</b>     Print the full SSL packet header.

       <b>-i</b> <u>interface</u>
              Use <u>interface</u> as the network interface on which to sniff SSL/TLS traffic.

       <b>-j</b>     Switch output format to JSON. Only stdout is affected by this toggle.

       <b>-k</b> <u>keyfile</u>
              Use  <u>keyfile</u>  as  the  location  of  the SSL keyfile (OpenSSL format) Previous versions of <u>ssldump</u>
              automatically looked in ./server.pem.  Now you must specify your keyfile every time.

       <b>-l</b> <u>sslkeylogfile</u>
              Use  <u>sslkeylogfile</u>  as  the  location  of  the  SSLKEYLOGFILE   (https://developer.mozilla.org/en-
              US/docs/Mozilla/Projects/NSS/Key_Log_Format).

       <b>-n</b>     Don't try to resolve host names from IP addresses.

       <b>-N</b>     Attempt to parse ASN.1 when it appears, such as in certificates and DNs.

       <b>-p</b> <u>password</u>
              Use <u>password</u> as the SSL keyfile password.

       <b>-P</b>     Don't put the interface into promiscuous mode.

       <b>-q</b>     Don't decode any record fields beyond a single summary line. (quiet mode).

       <b>-r</b> <u>file</u>
              Read  data from <u>file</u> instead of from the network.  The old -f option still works but is deprecated
              and will probably be removed with the next version.

       <b>-S</b> <u>[</u> <b>crypto</b> <u>|</u> <b>d</b> <u>|</u> <b>ht</b> <u>|</u> <b>H</b> <u>]</u>
              Specify SSL flags to <u>ssldump</u>.  These flags include:

              <u>crypto</u> Print cryptographic information.

              <u>d</u>      Print fields as decoded.

              <u>ht</u>     Print the handshake type.

              <u>H</u>      Print handshake type and highlights.

       <b>-t</b>     Specify the TTL for inactive connections referenced in the connection pool (in  seconds,  default:
              100).

       <b>-T</b>     Print the TCP headers.

       <b>-v</b>     Display version and copyright information.

       <b>-w</b> <u>outputpcap</u>
              Use <u>outputpcap</u> as the destination for decrypted packets.

       <b>-x</b>     Print each record in hex, as well as decoding it.

       <b>-X</b>     When the -d option is used, binary data is automatically printed in two columns with a hex dump on
              the  left  and  the  printable characters on the right. -X suppresses the display of the printable
              characters, thus making it easier to cut and paste the hex data into some other program.

       <b>-y</b>     Decorate the output for processing with nroff/troff. Not very useful for the average user.

       <b>-z</b>     Add timestamp in front of TCP packet description (-T)

       <u>expression</u>
              Selects what packets <u>ssldump</u>  will  examine.  Technically  speaking,  <u>ssldump</u>  supports  the  full
              expression  syntax  from  PCAP  and  tcpdump.   In  fact, the description here is cribbed from the
              tcpdump man page. However, since <u>ssldump</u> needs to examine full TCP streams, most  of  the  tcpdump
              expressions  will select traffic mixes that <u>ssldump</u> will simply ignore. Only the expressions which
              don't result in incomplete TCP streams are listed here.

              The <u>expression</u> consists of one or more <u>primitives</u>.  Primitives usually consist of an <u>id</u>  (name  or
              number) preceded by one or more qualifiers.  There are three different kinds of qualifier:

              <u>type</u>   qualifiers  say  what  kind  of  thing the id name or number refers to.  Possible types are
                     <b>host</b>, <b>net</b> and <b>port</b>.  E.g., `host foo', `net  128.3',  `port  20'.   If  there  is  no  type
                     qualifier, <b>host</b> is assumed.

              <u>dir</u>    qualifiers  specify a particular transfer direction to and/or from <u>id.</u>  Possible directions
                     are <b>src</b>, <b>dst</b>, <b>src</b> <b>or</b> <b>dst</b> and <b>src</b> <b>and</b> <b>dst</b>.  E.g., `src foo', `dst net 128.3',  `src  or  dst
                     port  ftp-data'.   If  there  is  no dir qualifier, <b>src</b> <b>or</b> <b>dst</b> is assumed.  For `null' link
                     layers (i.e. point to point protocols such as slip) the <b>inbound</b> and <b>outbound</b> qualifiers can
                     be used to specify a desired direction.

              More complex filter expressions are built up by using  the  words  <b>and</b>,  <b>or</b>  and  <b>not</b>  to  combine
              primitives.   E.g.,  `host foo and not port ftp and not port ftp-data'.  To save typing, identical
              qualifier lists can be omitted.  E.g., `tcp dst port ftp or ftp-data or  domain'  is  exactly  the
              same as `tcp dst port ftp or tcp dst port ftp-data or tcp dst port domain'.

              Allowable primitives are:

              <b>dst</b> <b>host</b> <u>host</u>
                     True if the IPv4/v6 destination field of the packet is <u>host</u>, which may be either an address
                     or a name.

              <b>src</b> <b>host</b> <u>host</u>
                     True if the IPv4/v6 source field of the packet is <u>host</u>.

              <b>host</b> <u>host</u>
                     True  if  either the IPv4/v6 source or destination of the packet is <u>host</u>.  Any of the above
                     host expressions can be prepended with the keywords, <b>ip</b>, <b>arp</b>, <b>rarp</b>, or <b>ip6</b> as in:
                          <b>ip</b> <b>host</b> <u>host</u>
                     which is equivalent to:
                          <b>ether</b> <b>proto</b> <u>\ip</u> <b>and</b> <b>host</b> <u>host</u>
                     If <u>host</u> is a name with multiple IP addresses, each address will be checked for a match.

              <b>ether</b> <b>dst</b> <u>ehost</u>
                     True if the ethernet destination address is  <u>ehost</u>.   <u>Ehost</u>  may  be  either  a  name  from
                     /etc/ethers or a number (see <u><a href="../man3N/ethers.3N.html">ethers</a></u>(3N) for numeric format).

              <b>ether</b> <b>src</b> <u>ehost</u>
                     True if the ethernet source address is <u>ehost</u>.

              <b>ether</b> <b>host</b> <u>ehost</u>
                     True if either the ethernet source or destination address is <u>ehost</u>.

              <b>gateway</b> <u>host</u>
                     True  if  the  packet  used  <u>host</u>  as  a gateway.  I.e., the ethernet source or destination
                     address was <u>host</u> but neither the IP source nor the IP destination was <u>host</u>.  <u>Host</u> must be a
                     name and must be found in both <a href="file:/etc/hosts">/etc/hosts</a> and /etc/ethers.  (An equivalent expression is
                          <b>ether</b> <b>host</b> <u>ehost</u> <b>and</b> <b>not</b> <b>host</b> <u>host</u>
                     which can be used with either names or numbers for <u>host</u> <u>/</u> <u>ehost</u>.)   This  syntax  does  not
                     work in IPv6-enabled configuration at this moment.

              <b>dst</b> <b>net</b> <u>net</u>
                     True  if the IPv4/v6 destination address of the packet has a network number of <u>net</u>. <u>Net</u> may
                     be either a name from <a href="file:/etc/networks">/etc/networks</a> or a network number (see <u><a href="../man4/networks.4.html">networks</a>(4)</u> for details).

              <b>src</b> <b>net</b> <u>net</u>
                     True if the IPv4/v6 source address of the packet has a network number of <u>net</u>.

              <b>net</b> <u>net</u>
                     True if either the IPv4/v6 source or destination address of the packet has a network number
                     of <u>net</u>.

              <b>net</b> <u>net</u> <b>mask</b> <u>mask</u>
                     True if the IP address matches <u>net</u> with the specific netmask.  May be qualified with <b>src</b> or
                     <b>dst</b>.  Note that this syntax is not valid for IPv6 <u>net</u>.

              <b>net</b> <u>net</u>/<u>len</u>
                     True if the IPv4/v6 address matches <u>net</u> a netmask <u>len</u> bits wide.  May be qualified with <b>src</b>
                     or <b>dst</b>.

              <b>dst</b> <b>port</b> <u>port</u>
                     True if the packet is ip/tcp, ip/udp, ip6/tcp or ip6/udp and has a destination  port  value
                     of  <u>port</u>.   The  <u>port</u>  can  be  a  number  or a name used in <a href="file:/etc/services">/etc/services</a> (see <u><a href="../man4P/tcp.4P.html">tcp</a></u>(4P) and
                     <u><a href="../man4P/udp.4P.html">udp</a></u>(4P)).  If a name is used, both the port number and protocol are checked.  If  a  number
                     or  ambiguous  name is used, only the port number is checked (e.g., <b>dst</b> <b>port</b> <b>513</b> will print
                     both tcp/login traffic and udp/who traffic, and <b>port</b> <b>domain</b> will print both tcp/domain  and
                     udp/domain traffic).

              <b>src</b> <b>port</b> <u>port</u>
                     True if the packet has a source port value of <u>port</u>.

              <b>port</b> <u>port</u>
                     True if either the source or destination port of the packet is <u>port</u>.  Any of the above port
                     expressions can be prepended with the keywords, <b>tcp</b> or <b>udp</b>, as in:
                          <b>tcp</b> <b>src</b> <b>port</b> <u>port</u>
                     which matches only tcp packets whose source port is <u>port</u>.

              Primitives may be combined using:

                     A parenthesized group of primitives and operators (parentheses are special to the Shell and
                     must be escaped).

                     Negation (`<b>!</b>' or `<b>not</b>').

                     Concatenation (`<b>&amp;&amp;</b>' or `<b>and</b>').

                     Alternation (`<b>||</b>' or `<b>or</b>').

              Negation  has  highest  precedence.   Alternation  and  concatenation  have  equal  precedence and
              associate left to right.  Note that explicit <b>and</b> tokens, not juxtaposition, are now  required  for
              concatenation.

              If an identifier is given without a keyword, the most recent keyword is assumed.  For example,
                   <b>not</b> <b>host</b> <b>vs</b> <b>and</b> <b>ace</b>
              is short for
                   <b>not</b> <b>host</b> <b>vs</b> <b>and</b> <b>host</b> <b>ace</b>
              which should not be confused with
                   <b>not</b> <b>(</b> <b>host</b> <b>vs</b> <b>or</b> <b>ace</b> <b>)</b>

              Expression  arguments  can  be  passed  to  <u>ssldump</u>  as  either  a  single argument or as multiple
              arguments,  whichever  is  more  convenient.   Generally,  if  the   expression   contains   Shell
              metacharacters,  it  is  easier  to  pass it as a single, quoted argument.  Multiple arguments are
              concatenated with spaces before being parsed.

</pre><h4><b>EXAMPLES</b></h4><pre>
       To listen to traffic on interface <u>le0</u> port <u>443</u>:
              <b>ssldump</b> <b>-i</b> <b>le0</b> <b>port</b> <b>443</b>

       To listen to traffic to the server <u>romeo</u> on port <u>443</u>:
              <b>ssldump</b> <b>-i</b> <b>le0</b> <b>port</b> <b>443</b> <b>and</b> <b>host</b> <b>romeo</b>:

       To switch output format to JSON:
              <b>ssldump</b> <b>-ANH</b> <b>-j</b> <b>-i</b> <b>le0</b> <b>port</b> <b>443</b> <b>and</b> <b>host</b> <b>romeo</b>

       To decrypt traffic to host <u>romeo</u> <u>server.pem</u> and the password <u>foobar</u>:
              <b>ssldump</b> <b>-Ad</b> <b>-k</b> <b><a href="file:~/server.pem">~/server.pem</a></b> <b>-p</b> <b>foobar</b> <b>-i</b> <b>le0</b> <b>host</b> <b>romeo</b>

</pre><h4><b>OUTPUT</b> <b>FORMAT</b></h4><pre>
       All output is printed to standard out.

       <u>ssldump</u> prints an indication of every new TCP connection using a line like the following

       <b>New</b> <b>TCP</b> <b>connection</b> <b>#2:</b> <b><a href="../man2302/iromeo.rtfm.com.2302.html">iromeo.rtfm.com</a>(2302)</b> <b>&lt;-&gt;</b> <b><a href="../man4433/sr1.rtfm.com.4433.html">sr1.rtfm.com</a>(4433)</b>

       The host which send the first SYN is printed on the left and the host which responded is printed  on  the
       right.  Ordinarily, this means that the SSL client will be printed on the left with the SSL server on the
       right. In this case we have a connection from <u>iromeo.rtfm.com</u> (port <u>2303</u>) to <u>sr1.rtfm.com</u> (port <u>4433</u>). To
       allow the user to disentangle traffic from different connections, each connection is  numbered.  This  is
       connection <u>2</u>.

       The  printout  of each SSL record begins with a record line. This line contains the connection and record
       number, a timestamp, and the record type, as in the following:

       <b>2</b> <b>3</b>  <b>0.2001</b> <b>(0.0749)</b>  <b>S&gt;C</b>  <b>Handshake</b>      <b>Certificate</b>

       This is record <u>3</u> on connection <u>2</u>. The first timestamp is the time since the beginning of the  connection.
       The second is the time since the previous record. Both are in seconds.

       The  next  field  in  the  record  line is the direction that the record was going. <u>C&gt;S</u> indicates records
       transmitted from client to server and <u>S&gt;C</u> indicates records transmitted from server to  client.   <u>ssldump</u>
       assumes that the host to transmit the first SYN is the SSL client (this is nearly always correct).

       The  next  field  is  the  record  type, one of <u>Handshake</u>, <u>IAlert</u>, <u>ChangeCipherSpec</u>, or <u>application_data</u>.
       Finally, <u>ssldump</u> may print record-specific data on the rest of the line. For <u>Handshake</u> records, it prints
       the handshake message. Thus, this record is a <u>Certificate</u> message.

       <u>ssldump</u> chooses certain record types for further decoding. These are the ones that have proven to be most
       useful for debugging:

       <u>ClientHello</u> - version, offered cipher suites, session id
                            if provided)
       <u>ServerHello</u> - version, session_id, chosen cipher suite,
                      compression method
       <u>Alert</u> - type and level (if obtainable)

       Fuller decoding of the various records can be obtained by using the <b>-A</b> , <b>-d</b> , <b>-k</b> and <b>-p</b> flags.

</pre><h4><b>SIGNALS</b></h4><pre>
       When it receives SIGUSR1, <b>ssldump</b> prints the list of currently tracked connection on stderr.

       With SIGUSR2, <b>ssldump</b> purges its internal connection tracking data structures.

</pre><h4><b>DECRYPTION</b></h4><pre>
       <u>ssldump</u> can decrypt traffic between two hosts if the following two conditions are met:
              1. <u>ssldump</u> has the keys.
              2. Static RSA was used.
       In any other case, once encryption starts, <u>ssldump</u> will only  be  able  to  determine  the  record  type.
       Consider the following section of a trace.

       <b>1</b> <b>5</b>  <b>0.4129</b> <b>(0.1983)</b>  <b>C&gt;S</b>  <b>Handshake</b>      <b>ClientKeyExchange</b>
       <b>1</b> <b>6</b>  <b>0.4129</b> <b>(0.0000)</b>  <b>C&gt;S</b>  <b>ChangeCipherSpec</b>
       <b>1</b> <b>7</b>  <b>0.4129</b> <b>(0.0000)</b>  <b>C&gt;S</b>  <b>Handshake</b>
       <b>1</b> <b>8</b>  <b>0.5585</b> <b>(0.1456)</b>  <b>S&gt;C</b>  <b>ChangeCipherSpec</b>
       <b>1</b> <b>9</b>  <b>0.6135</b> <b>(0.0550)</b>  <b>S&gt;C</b>  <b>Handshake</b>
       <b>1</b> <b>10</b> <b>2.3121</b> <b>(1.6986)</b>  <b>C&gt;S</b>  <b>application_data</b>
       <b>1</b> <b>11</b> <b>2.5336</b> <b>(0.2214)</b>  <b>C&gt;S</b>  <b>application_data</b>
       <b>1</b> <b>12</b> <b>2.5545</b> <b>(0.0209)</b>  <b>S&gt;C</b>  <b>application_data</b>
       <b>1</b> <b>13</b> <b>2.5592</b> <b>(0.0046)</b>  <b>S&gt;C</b>  <b>application_data</b>
       <b>1</b> <b>14</b> <b>2.5592</b> <b>(0.0000)</b>  <b>S&gt;C</b>  <b>Alert</b>

       Note  that  the  <u>ClientKeyExchange</u>  message type is printed but the rest of the <u>Handshake</u> messages do not
       have types. These are the <u>Finished</u> messages, but because they are encrypted <u>ssldump</u> only knows that  they
       are  of  type  <u>Handshake</u>.  Similarly, had the <u>Alert</u> in record 14 happened during the handshake, it's type
       and level would have been printed. However, since it is encrypted we can only tell that it is an alert.

</pre><h4><b>BUGS</b></h4><pre>
       Please send bug reports to https://github.com/adulau/ssldump

       The TCP reassembler is not perfect. No attempt is made to reassemble IP fragments and the 3-way handshake
       and close handshake are imperfectly implemented. In practice, this turns out not to be much of a problem.

       Support is provided for only for Ethernet and loopback interfaces because that's all that I have. If  you
       have  another  kind  of  network you will need to modify pcap_cb in base/pcap-snoop.c. If you have direct
       experience with <u>ssldump</u> on other networks, please send me patches.

       <u>ssldump</u> doesn't implement session caching and therefore can't decrypt resumed sessions.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/tcpdump.1.html">tcpdump</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
       <u>ssldump</u> was originally written by Eric Rescorla &lt;<a href="mailto:ekr@rtfm.com">ekr@rtfm.com</a>&gt;. Maintained by a bunch of volunteers,  see
       https://github.com/adulau/ssldump/blob/master/CREDITS   -  Copyright  (C)  2015-2023  the  aforementioned
       volunteers

                                         14th August 2023 - version 1.8                               <u><a href="../man1/SSLDUMP.1.html">SSLDUMP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>