<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pg_combinebackup - reconstruct a full backup from an incremental backup and dependent backups</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/postgresql-client-17">postgresql-client-17_17.5-0ubuntu0.25.04.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pg_combinebackup - reconstruct a full backup from an incremental backup and dependent backups

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>pg_combinebackup</b> [<u>option</u>...] [<u>backup_directory</u>...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       pg_combinebackup is used to reconstruct a synthetic full backup from an incremental backup and the
       earlier backups upon which it depends.

       Specify all of the required backups on the command line from oldest to newest. That is, the first backup
       directory should be the path to the full backup, and the last should be the path to the final incremental
       backup that you wish to restore. The reconstructed backup will be written to the output directory
       specified by the <b>-o</b> option.

       pg_combinebackup will attempt to verify that the backups you specify form a legal backup chain from which
       a correct full backup can be reconstructed. However, it is not designed to help you keep track of which
       backups depend on which other backups. If you remove one or more of the previous backups upon which your
       incremental backup relies, you will not be able to restore it. Moreover, pg_combinebackup only attempts
       to verify that the backups have the correct relationship to each other, not that each individual backup
       is intact; for that, use <b><a href="../man1/pg_verifybackup.1.html">pg_verifybackup</a></b>(1).

       Since the output of pg_combinebackup is a synthetic full backup, it can be used as an input to a future
       invocation of pg_combinebackup. The synthetic full backup would be specified on the command line in lieu
       of the chain of backups from which it was reconstructed.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-d</b>
       <b>--debug</b>
           Print lots of debug logging output on stderr.

       <b>-n</b>
       <b>--dry-run</b>
           The <b>-n</b>/<b>--dry-run</b> option instructs <b>pg_combinebackup</b> to figure out what would be done without actually
           creating the target directory or any output files. It is particularly useful in combination with
           <b>--debug</b>.

       <b>-N</b>
       <b>--no-sync</b>
           By default, <b>pg_combinebackup</b> will wait for all files to be written safely to disk. This option causes
           <b>pg_combinebackup</b> to return without waiting, which is faster, but means that a subsequent operating
           system crash can leave the output backup corrupt. Generally, this option is useful for testing but
           should not be used when creating a production installation.

       <b>-o</b> <u>outputdir</u>
       <b>--output=</b><u>outputdir</u>
           Specifies the output directory to which the synthetic full backup should be written. Currently, this
           argument is required.

       <b>-T</b> <u>olddir</u><b>=</b><u>newdir</u>
       <b>--tablespace-mapping=</b><u>olddir</u><b>=</b><u>newdir</u>
           Relocates the tablespace in directory <u>olddir</u> to <u>newdir</u> during the backup.  <u>olddir</u> is the absolute
           path of the tablespace as it exists in the final backup specified on the command line, and <u>newdir</u> is
           the absolute path to use for the tablespace in the reconstructed backup. If either path needs to
           contain an equal sign (=), precede that with a backslash. This option can be specified multiple times
           for multiple tablespaces.

       <b>--clone</b>
           Use efficient file cloning (also known as “reflinks” on some systems) instead of copying files to the
           new data directory, which can result in near-instantaneous copying of the data files.

           If a backup manifest is not available or does not contain checksum of the right type, file cloning
           will be used to copy the file, but the file will be also read block-by-block for the checksum
           calculation.

           File cloning is only supported on some operating systems and file systems. If it is selected but not
           supported, the pg_combinebackup run will error. At present, it is supported on Linux (kernel 4.5 or
           later) with Btrfs and XFS (on file systems created with reflink support), and on macOS with APFS.

       <b>--copy</b>
           Perform regular file copy. This is the default. (See also <b>--copy-file-range</b> and <b>--clone</b>.)

       <b>--copy-file-range</b>
           Use the <b>copy_file_range</b> system call for efficient copying. On some file systems this gives results
           similar to <b>--clone</b>, sharing physical disk blocks, while on others it may still copy blocks, but do so
           via an optimized path. At present, it is supported on Linux and FreeBSD.

           If a backup manifest is not available or does not contain checksum of the right type, <b>copy_file_range</b>
           will be used to copy the file, but the file will be also read block-by-block for the checksum
           calculation.

       <b>--manifest-checksums=</b><u>algorithm</u>
           Like <b><a href="../man1/pg_basebackup.1.html">pg_basebackup</a></b>(1), pg_combinebackup writes a backup manifest in the output directory. This option
           specifies the checksum algorithm that should be applied to each file included in the backup manifest.
           Currently, the available algorithms are NONE, CRC32C, SHA224, SHA256, SHA384, and SHA512. The default
           is CRC32C.

       <b>--no-manifest</b>
           Disables generation of a backup manifest. If this option is not specified, a backup manifest for the
           reconstructed backup will be written to the output directory.

       <b>--sync-method=</b><u>method</u>
           When set to fsync, which is the default, <b>pg_combinebackup</b> will recursively open and synchronize all
           files in the backup directory. When the plain format is used, the search for files will follow
           symbolic links for the WAL directory and each configured tablespace.

           On Linux, syncfs may be used instead to ask the operating system to synchronize the whole file system
           that contains the backup directory. When the plain format is used, <b>pg_combinebackup</b> will also
           synchronize the file systems that contain the WAL files and each tablespace. See
           recovery_init_sync_method for information about the caveats to be aware of when using syncfs.

           This option has no effect when <b>--no-sync</b> is used.

       <b>-V</b>
       <b>--version</b>
           Prints the pg_combinebackup version and exits.

       <b>-?</b>
       <b>--help</b>
           Shows help about pg_combinebackup command line arguments, and exits.

</pre><h4><b>LIMITATIONS</b></h4><pre>
       pg_combinebackup does not recompute page checksums when writing the output directory. Therefore, if any
       of the backups used for reconstruction were taken with checksums disabled, but the final backup was taken
       with checksums enabled, the resulting directory may contain pages with invalid checksums.

       To avoid this problem, taking a new full backup after changing the checksum state of the cluster using
       <b><a href="../man1/pg_checksums.1.html">pg_checksums</a></b>(1) is recommended. Otherwise, you can disable and then optionally reenable checksums on the
       directory produced by pg_combinebackup in order to correct the problem.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       This utility, like most other PostgreSQL utilities, uses the environment variables supported by libpq
       (see Section 32.15).

       The environment variable <b>PG_COLOR</b> specifies whether to use color in diagnostic messages. Possible values
       are always, auto and never.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/pg_basebackup.1.html">pg_basebackup</a></b>(1)

PostgreSQL 17.5                                       2025                                   <u><a href="../man1/PG_COMBINEBACKUP.1.html">PG_COMBINEBACKUP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>