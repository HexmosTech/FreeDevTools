<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>expire_backups - Intelligently expire old backups</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/s3ql">s3ql_5.2.3+dfsg-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       expire_backups - Intelligently expire old backups

</pre><h4><b>SYNOPSIS</b></h4><pre>
          expire_backups [options] &lt;age&gt; [&lt;age&gt; ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>expire_backups</b> command intelligently remove old backups that are no longer needed.

       To  define  what backups you want to keep for how long, you define a number of <u>age</u> <u>ranges</u>. <b>expire_backups</b>
       ensures that you will have at least one backup in each age range at all times. It will  keep  exactly  as
       many backups as are required for that and delete any backups that become redundant.

       Age  ranges  are specified by giving a list of range boundaries in terms of backup cycles. Every time you
       create a new backup, the existing backups age by one cycle.

       Example: when <b>expire_backups</b> is called with the age range definition <b>1</b> <b>3</b> <b>7</b> <b>14</b> <b>31</b>, it will guarantee  that
       you always have the following backups available:

       1. A backup that is 0 to 1 cycles old (i.e, the most recent backup)

       2. A backup that is 1 to 3 cycles old

       3. A backup that is 3 to 7 cycles old

       4. A backup that is 7 to 14 cycles old

       5. A backup that is 14 to 31 cycles old

       <b>NOTE:</b>
          If  you  do  backups in fixed intervals, then one cycle will be equivalent to the backup interval. The
          advantage of specifying the age ranges in terms of backup cycles rather than days or weeks is that  it
          allows  you  to gracefully handle irregular backup intervals.  Imagine that for some reason you do not
          turn on your computer for one month. Now all your backups are at least a month old,  and  if  you  had
          specified  the  above backup strategy in terms of absolute ages, they would all be deleted! Specifying
          age ranges in terms of backup cycles avoids these sort of problems.

       <b>expire_backups</b>  usage  is  simple.  It  requires  backups  to  be  stored  in  directories  of  the  form
       <b>year-month-day_hour:minute:seconds</b>  (<b>YYYY-MM-DD_HH:mm:ss</b>)  and  works  on  all  backups  in  the  current
       directory. So for the above backup strategy, the correct invocation would be:

          expire_backups.py 1 3 7 14 31

       When storing your backups on an S3QL file system, you probably want to specify the <b>--use-s3qlrm</b> option as
       well. This tells <b>expire_backups</b> to use the <u>s3qlrm</u> command to delete directories.

       <b>expire_backups</b> uses a "state file" to keep track which backups are how many cycles old (since this cannot
       be inferred from the dates contained in the directory names). The standard name for this  state  file  is
       <b>.expire_backups.dat</b>. If this file gets damaged or deleted, <b>expire_backups</b> no longer knows the ages of the
       backups  and  refuses  to  work.  In  this  case  you  can  use  the <b>--reconstruct-state</b> option to try to
       reconstruct the state from the backup  dates.  However,  the  accuracy  of  this  reconstruction  depends
       strongly  on  how  rigorous  you have been with making backups (it is only completely correct if the time
       between subsequent backups has always been exactly the same), so it's generally a good idea not to tamper
       with the state file.

</pre><h4><b>OPTIONS</b></h4><pre>
       The <b>expire_backups</b> command accepts the following options:

          <b>--quiet</b>
                 be really quiet

          <b>--log</b> <u>&lt;target&gt;</u>
                 Destination for log messages. Specify <b>none</b> for standard output or <b>syslog</b> for the system logging
                 daemon. Anything else will be interpreted as a file name. Log files will be rotated  when  they
                 reach 1 MiB, and at most 5 old log files will be kept. Default: <b>None</b>

          <b>--debug-modules</b> <u>&lt;modules&gt;</u>
                 Activate  debugging  output  from  specified  modules (use commas to separate multiple modules,
                 'all' for everything). Debug messages will be written to the  target  specified  by  the  <b>--log</b>
                 option.

          <b>--debug</b>
                 Activate  debugging  output from all S3QL modules. Debug messages will be written to the target
                 specified by the <b>--log</b> option.

          <b>--version</b>
                 just print program version and exit

          <b>--state</b> <u>&lt;file&gt;</u>
                 File to save state information in (default: ".expire_backups.dat")

          <b>-n</b>     Dry run. Just show which backups would be deleted.

          <b>-p</b> <u>&lt;N&gt;</u>, <b>--proportion-delete</b> <u>&lt;N&gt;</u>
                 Maximum proportion of backups to delete (between 0 and 1, default: 0.5)

          <b>--reconstruct-state</b>
                 Try to reconstruct a missing state file from backup dates.

          <b>--use-s3qlrm</b>
                 Use <b>s3qlrm</b> command to delete backups.

</pre><h4><b>EXIT</b> <b>CODES</b></h4><pre>
       <b>expire_backups</b> may terminate with the following exit codes:

       <b>0</b>      Everything went well.

       <b>1</b>      An unexpected error occurred. This may indicate a bug in the program.

       <b>2</b>      Invalid command line argument or configuration file key.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>expire_backups</b> is shipped as part of S3QL, <u>https://github.com/s3ql/s3ql/</u>.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Â© 2008 Nikolaus Rath &lt;<a href="mailto:Nikolaus@rath.org">Nikolaus@rath.org</a>&gt;

5.2.3                                             Nov 02, 2024                                 <u><a href="../man1/EXPIRE_BACKUPS.1.html">EXPIRE_BACKUPS</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>