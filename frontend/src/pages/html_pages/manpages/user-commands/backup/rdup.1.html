<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rdup - generate a file list suitable for making backups</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/noble/+package/rdup">rdup_1.1.15-1ubuntu4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rdup - generate a file list suitable for making backups

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>rdup</b> [<u>-N</u> <u>timestamp</u>] -[<u>-P</u> <u>CMD</u>]...  [<u>OPTION</u>]...  <u>FILELIST</u> [<u>DIR/FILE]...</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>rdup</b>  is  a  utility  inspired  by  rsync and the Plan9 way of doing backups. <b>rdup</b> itself does not backup
       anything. It only prints a list of files that are changed, or all files in case of a null dump.  It  also
       handles files that are removed, allowing for correct incremental backups. All paths printed are absolute.
       <b>rdup</b> uses the change time (ctime) to decide whether a file is altered.

       It works as follows, for a full dump

       <b>1.</b>     Crawl  all directories, and print all the names found to standard output.  Also check for <u>._rdup_.</u>
              files to restore the original ownership (see the <u>-u</u> flag).

       <b>2.</b>     Write a filelist with all the names found when crawling.  Use this list to calculate  the  correct
              incremental dump.

       And for incremental dumps

       <b>1.</b>     Read in the filelist that was written when doing a full dump.

       <b>2.</b>     Touch the time stamp file.

       <b>3.</b>     Crawl all the directories again.

       <b>4.</b>     Diff 1. and 2. to get two lists; one of removed items and one of added/modified items.

       <b>5.</b>     Write the removed items to standard output

       <b>6.</b>     Write the modified/new items to standard output.

       <b>7.</b>     Write a new filelist.

       The  <u>FILELIST</u>  is  a  internal  list <b>rdup</b> writes to, to keep track of which files are in a backup. If you
       don't want this (i.e. make a full backup), use <u>/dev/null</u> here. The file <u>/dev/null</u> is handled specially by
       <b>rdup</b>: if detected no new file list is written.

       The <u>DIRS/FILES</u> can be specified multiple times. These are the directories and files you want  to  backup.
       If omitted it defaults to the current directory "." .

       If  the  <u>-N</u>  <u>timestamp</u> option is not given, all paths found are printed. Only when a <u>-N</u> <u>timestamp</u> file is
       given, times can be compared and an incremental output can be generated.

       <b>rdup</b> prints a filelist to standard output.  Subsequent programs in a pipe line can be  used  to  actually
       implement  to backup scheme.  After a run a new FILELIST is written. No warning is given when FILELIST is
       an existing file, it just gets overwritten by <b>rdup</b>. New runs will print out only those  files  that  have
       actually changed or are removed since the last run, thereby making incremental backups possible.

       Files  are  checked  for  changes  by  comparing the c-time (change time), if this time is NEWER than the
       c-time of timestamp file the pathname is printed to standard output. When files are removed they are also
       printed to standard output, but they are prefixed with a '-'. See <b>FORMAT</b> below. The default  format  <b>rdup</b>
       uses is: "%p%T %b %t %u %U %g %G %l %s\n%n%C"

       Note,  that  <b>rdup</b> also supports hashing of files, this makes it possible to check the local hash with the
       hash of the backed up file.

       All errors are written to standard error.  If the directory or file does not exist, they are skipped  and
       a warning is emitted.

       The  general  idea  is  to  be very UNIX like and create a bunch of simple programs which each do a their
       specific thing very well. With <b>rdup</b> and a small shell script (50 lines) one can implement  encrypted  and
       compressed backups.

       As  <b>rdup</b>  doesn't  backup anything, the backup policy; what you backup, how you backup, how often and how
       you restore; is all left to the scripts and your imagination. To kick start your  imagination  see  <u><a href="../man1/rduptr.1.html">rdup-</a></u>
       <u><a href="../man1/rduptr.1.html">tr</a>(1)</u>, <u><a href="../man1/rdup-up.1.html">rdup-up</a>(1)</u> and maybe <u>rdup-backups</u>.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-P</b> <u>command</u>
              Filter all output through <u>command</u>, multiple -P's can be used.

              Due  to the nature of pipes in Unix, this pipeline is recreated for every file processed. Also see
              'Child Processes' below.

       <b>-F</b> <b>format</b>
              Specify a printf-style format to use. See <b>FORMAT</b> below.

       <b>-N</b> <b>timestamp</b>
              use the c_time of file <b>timestamp</b> as the timestamp to decide what to  include  in  the  incremental
              backup list. If <b>timestamp</b> does not exist a full dump is performed.

       <b>-M</b> <b>timestamp</b>
              As -N, but look at the m_time of timestamp.

       <b>-R</b>     Reverse  the output of <b>rdup</b>. Tools accepting this output must create leading directory as they see
              them. This option allows a script -- running as a normal user -- to put files in a directory which
              could have 0600 as its permission.

       <b>-E</b> <b>file</b>
              The file named 'file' contains a list of Perl-compatible regular expressions (PCRE), one per line,
              that <b>rdup</b> will use to <u>exclude</u> names. A '#' at the start of the  line  can  be  used  to  signal  a
              comment.  Empty lines are ignored.

              If  a  directory is excluded, <b>rdup</b> won't descend in that directory, so all files in that directory
              are also excluded.

              The directories leading up to the directory to be backed up can not be  excluded.  If  you  use  a
              command line like:

                      rdup /dev/null /home/miekg/bin

              The directories '<a href="file:/home">/home</a>', '/home/miekg', '/home/miekg/bin' are always printed.

              If  you  want  to  exclude  the  file  '/home/miekg/blaat'  you  need to add the following regular
              expression: '/home/miekg/blaat'.

              If  you  want  to  exclude  all  .mozilla/cache   directories   of   all   users   you   can   use
              '<a href="file:/home/.">/home/.</a>*/.mozilla/cache/.*'.  This doesn't exclude the directory itself and I'm assuming that the
              users' home directories are found under '<a href="file:/home">/home</a>'.

              Also note that <b>rdup</b> does not print directories with a trailing slash.

       <b>-a</b>     Restore the original access times on files and directories.

       <b>-n</b>     Don't honor <u>.nobackup</u> files. Normally if such  a  file  is  found  the  directory  and  all  files
              containing it, are not printed to standard output. Now they are.

       <b>-u</b>     Output  files  with  a  <u>._rdup_.</u>  prefix just as normal files. When this option is not given these
              files are skipped by <u>rdup</u>.

       <b>-r</b>     Only print removed files; entries that start with a `-'. This option unsets -m.

       <b>-m</b>     Only print modified/new files; entries that start with a `+'. This option unsets -r.

       <b>-v</b>     Be more verbose. When used each path will also be printed to standard error.

       <b>-s</b> <b>size</b>
              Don't output files larger than <b>size</b> bytes.  This can be used to limit the amount  of  data  to  be
              transferred when doing a remote backup.  This option <u>only</u> applies to files.

       <b>-x</b>     Stay on the local filesystem.

       <b>-V</b>     Print rdup's version.

       <b>-h</b>     Give an overview of the options.

   <b>Child</b> <b>Processes</b> <b>(-P</b> <b>flag)</b>
       When  creating  output  you  might  also  want  to  'pipe'  the contents of <u>each</u> file through a number of
       commands, say a compression and encryption utility. Note that this  is  different  than  compressing  the
       <u>entire</u>  archive  as GNU tar allows by using the -z option.  So this is where <b>rdup</b> comes in. It allows you
       to create a normal archive in which <u>each</u> file is encrypted (or compressed.  reversed or  whatever).  <b>rdup</b>
       does this by forking child processes which transform the content.

       If  one  of  the  forked  children  returns  an  exit  code  other than zero (0), it is assumed the whole
       conversion process failed. In that case <b>rdup</b> terminates.

       As said <b>rdup</b> works by forking off a  number  of  child  processes  (those  commands  named  with  the  -P
       option(s)),  interconnecting  these  with  pipes.  The current file is connected to the first child.  The
       output created by these child processes is captured by the parent (<b>rdup</b>).  The contents is  then  written
       to  standard  output in an archive format.  As a picture says more than a thousand words here is an ASCII
       image of the process:

                          +--- ...   (stdout)    ... ----&gt; archive
                         /
                     rdup  &lt;--- ...   ... &lt;----+
                                               |
                 loop #files                   |
                                               |
                file ---&gt; cmd1 | cmd2 | ...| cmdN

</pre><h4><b>BACKUPS</b></h4><pre>
       With:
               rm -f timestamp &amp;&amp; rdup -N timestamp LIST DIR

       A full-dump filelist is printed to standard output. And with:

               rdup -N timestamp LIST DIR

       An incremental dump filelist is printed. The file <u>timestamp</u> is used to save the exact time of rdup's run.
       The file <u>LIST</u> is used to calculate the correct incremental dump list, this is needed for files  that  are
       removed, or have a different type.

</pre><h4><b>NON-ROOT</b> <b>BACKUPS</b></h4><pre>
       If  backups  are  made  by  a non-root user or on a filesystem that does not implement/allow <u>chown</u> (think
       sshfs mounted by an ordinary user), <u>rdup</u> creates a separate file which stores the correct user and  group
       information.  If  the  file's  name  is  <u>foobar</u>  a  new file called <u>._rdup_.foobar</u> is created in the same
       directory. This file contains one line, for instance:

                  root:0/root:0

       That tells that the <u>actual</u> ownership should be root:root. For directories  a  <u>._rdup_.</u>  file  is  created
       inside the current directory.

</pre><h4><b>FORMAT</b></h4><pre>
       The default format <b>rdup</b> uses is: "%p%T %b %t %u %U %g %G %l %s\n%n%C"

       The following escape sequences are understood by <b>rdup</b>:

               'p': '+' if file is new/modified, '-' if removed
               'b': permission bits from <a href="../man2/lstat.2.html">lstat</a>(2), octal in four digits
               'm': the file mode bits, st_mode from <a href="../man2/lstat.2.html">lstat</a>(2), decimal digits
               'u': uid
               'U': username
               'g': gid
               'G': groupname
               'l': path name length
               's': original file size, but see <b>CAVEATS</b>
               'n': path name
               'N': path name, but in case of a soft- or hardlink <u>only</u> the link name
               't': time of modification (seconds from epoch)
               'H': the SHA1 hash of the file, all zeros ("0") for all other types
               'T': file type
                     <b>-</b> normal file, <b>l</b> symlink, <b>h</b> hardlink, <b>d</b> directory,
                     <b>c</b> character device, <b>b</b> block device, <b>p</b> named pipe
                     and <b>s</b> socket
               'C': the content of the file (none for all other types)

       To delimit the output of <b>rdup</b> with NULLs you can use '\0' in the format string.

       Any  file content is written in a block/chunk based manner. The last block is signaled with a null block.
       A block start entry is ASCII and is formatted as follows: VVBLOCKBBBBB\n .  Where 'VV'  is  the  version,
       currently at '01', then the literal string 'BLOCK' and then the amount of bytes (BBBBB), typical '08192'.
       And then a newline.  This look like this:

               01BLOCK08192
               &lt;START OF THE FIRST 8192 BYTES&gt;01BLOCK00015
               &lt;ANOTHER 15 BYTES&gt;01BLOCK00000

       A byte count of zero signals a stop block.

</pre><h4><b>FILELIST</b></h4><pre>
       <b>rdup</b> writes the (internal) FILELIST in the following format:

              MODE DEV INODE LINK UID GID PATH_SIZE FILE_SIZE PATH

       Where  MODE  is the st_mode from <a href="../man2/stat.2.html">stat</a>(2), DEV is the dev id as returned by the stat call and INODE is the
       inode number - <b>rdup</b> needs this info to decide if a directory  is  renamed.  LINK  is  equal  to  'h'  for
       hardlinks,  'l'  for  symlinks and otherwise it is '*'.  UID and GID are the numeric user and group id of
       the file. PATH_SIZE is the length of PATH. FILE_SIZE the file size.  And finally PATH is the path of  the
       file.

       A typical example is:

              16893 2050 32085 * 1000 1000 30 4096 /home/miekg/git/rdup/.git/logs

</pre><h4><b>OUTPUT</b> <b>FORMAT</b></h4><pre>
       The output generated by <b>rdup</b> is formatted like:

               +|-TYPE BITS MTIME UID USER GID GROUP PATH_SIZE FILE_SIZE\n
               PATH FILE_CONTENTS

       This  makes it possible possible for a remote shell script to receive the actual file contetns and make a
       backup.

       For directories: the FILE_SIZE is zero and no content is printed. Thus:

               +d 0755 1260243445 1000 miekg 1000 miekg 11 0\n
               <b>/home/miekg</b>

       For regular files the following is a sample output:

               +- 0644 1260243445 1000 miekg 1000 miekg 32 6\n
               <b>/home/miekg/svn/rdup/trunk/aaa/a</b>01BLOCK00006\n
               <u>hello</u>\n
               01BLOCK00000\n

       Where <b>aaa/a</b> is a regular file containing the word 'hello\n'

   <b>CAVEATS</b>
       Soft- and hardlinks are handled differently when using %n, if you don't like this behavior use  %N.   The
       PATH name is generated from the link's name and its target. A symlink like

               /home/bin/blaat -&gt; /home/bin/bliep

       is  printed  as '/home/bin/blaat -&gt; /home/bin/bliep'. The PATH_SIZE is modified accordingly, where ' <b>-&gt;</b> '
       (4 characters) is also counted.  The FILE_SIZE is not needed for soft- or hardlinks, so  it  is  set  the
       length of the link's name -- the part left of the ' -&gt;', in this case the length of '/home/bin/blaat'.

       If rdup encounters a hardlink it is handled in the same way, but the output type is set to 'h' instead of
       'l'. A hardlink is only detected if rdup finds a file with the same inode and device number as a previous
       one, i.e. such hardlinks must be contained in your backup.

       Again  note:  with  '%N' only the link's name is printed. The FILE_SIZE is <u>still</u> set to the length of the
       link's name.

   <b>Device</b> <b>Files</b>
       For devices the size field (%s) is changed to hold the major,minor number of the device. So  if  a  major
       number  is  8 and the minor number is 0 (under Linux this is /dev/sda), its size will be <b>8,0</b>. The numbers
       are only separated with a comma `,'.

   <b>Symlinks</b>
       You will probably think <b>rdup</b> will descend into the directory the symbolic link points  to.  This  is  not
       what  actually  happens,  <b>rdup</b>  will print any directories leading up to the symlink and will <u>not</u> descend
       into the directory. GNU tar works the same.

</pre><h4><b>EXIT</b> <b>CODE</b></h4><pre>
       <b>rdup</b> return a zero exit code on success, otherwise 1 is returned.  rdup will abort if a file can  not  be
       concatenated, if a regular expression can not be compiled or if a signal is received.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The next set of examples will all make a full dump -- because of the use of /dev/null. See <u><a href="../man1/rdup-tr.1.html">rdup-tr</a>(1)</u> for
       more advanced examples.

   <b>rdup</b> <b>(mirroring)</b>
       Backup:
               rdup /dev/null <a href="file:~/bin">~/bin</a> | rdup-up -t /shared/backup
       Restore:
              rdup /dev/null /shared/backup | rdup-up -t /tmp/restore
       or
              cp -rap /shared/backup /tmp/restore

   <b>rdup</b> <b>(archiving)</b>
       Backup:
              rdup /dev/null <a href="file:~/bin">~/bin</a> &gt; my-archive.rdup
       Restore:
              rdup-up -t /tmp/restore &lt; my-archive.rdup

   <b>cpio</b>
       Backup:
              rdup -R -F '%N\n' /dev/null <a href="file:~/bin">~/bin</a> | cpio -o -Hcrc &gt; my-archive.cpio
       Restore:
              cpio -i -d -Hcrc &lt; my-archive.cpio

   <b>tar</b>
       Backup:
              rdup -F '%N\n' /dev/null <a href="file:~/bin">~/bin</a> | tar c -f my-archive.tar -T - --no-recursion
       Restore:
              tar x -f my-archive.tar

</pre><h4><b>AUTHOR</b></h4><pre>
       Written by Miek Gieben.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<a href="mailto:miek@miek.nl">miek@miek.nl</a>&gt;.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       http:/www.miek.nl/projects/rdup  is  the  main  site  of  rdup. Also see <a href="../man1/rdup-tr.1.html">rdup-tr</a>(1), <a href="../man1/rdup-up.1.html">rdup-up</a>(1) and <a href="../man7/rdupbackups.7.html">rdup-</a>
       <a href="../man7/rdupbackups.7.html">backups</a>(7).

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2005-2011 Miek Gieben.  This  is  free  software.  There  is  NO  warranty;  not  even  for
       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

       Licensed under the GPL version 3. See the file LICENSE in the source distribution of rdup.

1.1.14                                             24 Dec 2005                                           <u><a href="../man1/RDUP.1.html">RDUP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>