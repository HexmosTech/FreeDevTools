<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>postgreyreport - Fatal report for Postfix Greylisting Policy Server</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/postgrey">postgrey_1.37-2.1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       postgreyreport - Fatal report for Postfix Greylisting Policy Server

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>postgreyreport</b> [<u>options</u>...]

        -h, --help                   display this help and exit
            --version                display version and exit

            --user=USER              run as USER (default: postgrey)
            --dbdir=PATH             find db files in PATH (default: /var/lib/postgrey)
            --delay=N                report triplets that did not try again after N seconds (default: 300)
            --greylist-text=TXT      text to match on for greylist maillog lines

            --skip_pool              Skip report for 'subscriber pools' ( last 2 octets of IP found in PTR name )
            --skip_dnsbl=RBL         RBL server to query and skip reporting for any listed hosts (SLOW!!)
            --skip_clients=FILE      PTR or IP or REGEXP of clients to skip in report
            --match_clients=FILE     *ONLY* report if fatal *AND* PTR/IP of client matches

            --show_tries             display the number of attempts failed triplets made in first column
            --show_time              show entry time in maillog (single line only)
            --tab                    use tabs as separators for easy <a href="../man1/cut.1.html">cut</a>(1)ting

            --nosingle_line          display sender/recipients grouped by ptr - ip
            --separate_by_subnet=TXT display TXT for every new /24 (ex: "=================\n" )
            --separate_by_ip=TXT     display TXT for every new IP  (ex: "\n")
            --check_sender=LIST      one or more of: mx,mx/24,a,a/24
                                     does DNS/A lookups for sender @domain and compares sending IP
                                     if match displays "MX" "A" or "MX/24" or "A/24" depending on LIST

          Note that --(skip|match)_clients can be specified multiple times and there are no default files.
          Same rules apply as postgrey's --whitelist-clients, see postgrey doc for more info.

          --skip_dnsbl can also be specified multiple times to query multiple DNSBL servers.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       postgreyreport opens postgrey.db as read-only; reads a maillog via STDIN, extracts the triplets for any
       Greylisted lines and looks them up in postgrey.db.  if the difference in first and last time seen is less
       than --delay=N then the triplet is considered fatal and displayed to STDOUT

       The report sorts by client IP address

   <b>Note:</b>
       unless you are using --lookup_by_subnet or excluding all known MTA pools you will likely have false fatal
       reports for "BigISPs". A message that was tried from every IP in SMTP pool before making it through will
       show up in the report for all of the attempted source IPs

   <b>USAGE</b>
       It is best to run postgreyreport against a maillog that is at least several hours old (yesterdays?)  (
       you be the judge on how old is acceptable ). if you run the report against a live maillog you are not
       giving legit MTA's enough time to try again and you will have lots of inaccurate information.

       •   Ex usage:

                   zcat /var/log/maillog.0.gz | ./postgreyreport [options] &gt; postgreyreport.log

                   or

                   zcat /var/log/maillog.0.gz | \
                   ./postgreyreport --nosingle_line --check_sender=mx,a \
                   --separate_by_subnet=":==================\n"
                   # 94 "=" total, some were omitted for clarity

       •   Ex Output: ( POD wrapping will mess this up, view source )

            :============================================================================================
            unknown                 4.29.43.31
                               <a href="mailto:marissa_mcclendonuu@abit.com.tw">marissa_mcclendonuu@abit.com.tw</a>                      <a href="mailto:user1@recipient1.com">user1@recipient1.com</a>
                                       <a href="mailto:jake_meyerdt@ali.com.tw">jake_meyerdt@ali.com.tw</a>                      <a href="mailto:user2@recipient1.com">user2@recipient1.com</a>
                                   <a href="mailto:jenny_banks_sh@translate.ru">jenny_banks_sh@translate.ru</a>                      <a href="mailto:user1@recipient2.com">user1@recipient2.com</a>
                                         <a href="mailto:rvazquezpo@ali.com.tw">rvazquezpo@ali.com.tw</a>                      <a href="mailto:user3@recipient1.com">user3@recipient1.com</a>
                                            <a href="mailto:aep@notimexico.com">aep@notimexico.com</a>                      <a href="mailto:user2@recipient1.com">user2@recipient1.com</a>
                               <a href="mailto:brittneystanley_ei@cetra.org.tw">brittneystanley_ei@cetra.org.tw</a>                      <a href="mailto:user2@recipient1.com">user2@recipient1.com</a>
                                       <a href="mailto:brendasheehan_cw@lib.ru">brendasheehan_cw@lib.ru</a>                      <a href="mailto:user2@recipient1.com">user2@recipient1.com</a>
            :============================================================================================
            lsanca1-ar5-127-189.biz.dsl.gtei.net      4.33.127.189
               A      <a href="mailto:fokkensr@lsanca1-ar5-127-189.biz.dsl.gtei.net">fokkensr@lsanca1-ar5-127-189.biz.dsl.gtei.net</a>                 <a href="mailto:user2@recipient1.com">user2@recipient1.com</a>

                                  <a href="mailto:cyxlfrfwciercu@publicist.com">cyxlfrfwciercu@publicist.com</a>                      <a href="mailto:user3@recipient4.com">user3@recipient4.com</a>
            :============================================================================================
            smtpout.mac.com       17.250.248.83
                                        <a href="mailto:do_not_reply@apple.com">do_not_reply@apple.com</a>                      <a href="mailto:user4@recipient5.com">user4@recipient5.com</a>

            smtpout.mac.com       17.250.248.88
              MX                             <a href="mailto:legituser@mac.com">legituser@mac.com</a>                      <a href="mailto:user6@recipient7.com">user6@recipient7.com</a>
            :============================================================================================

</pre><h4><b>HISTORY</b></h4><pre>
       <b>1.14.3</b>  <b>20100321</b>

         Some additions, Leonard den Ottolander &lt;leonard.den.ottolander.nl&gt;
         New option: --tab   Use tabs as separator in single line mode
         New option: --show_time   Show entry time in maillog in single line mode

       <b>1.14.2</b>  <b>20040715</b>

         BUGFIX: (automatic) lookup-by-subnet support was broken, fixed.
         BUGFIX: corrected a few spelling errors
         new Option: --skip_pool   Skip report for 'subscriber pools'

       <b>1.14.1</b>  <b>20040712</b>

         Changed --return-string to --greylist-text to match postgrey
         new Option: --skip_clients=FILE
         new Option: --match_clients=FILE
         new Option: --skip_dnsbl=RBL.DNS.NAME
         All 3 of the new options can be specified multiple times.
         Updated do_*_subsititions again to match postgrey

       <b>1.11.1</b> <b>20040701</b>

         missing keys from DB are considered fatal triplets and included in report
         Changed --delay testing from "greater than" to "greater than or equal to"
         Fixed --help and --man switches
         Removed setuid Notice

       <b>1.6.4</b>  <b>20040618</b>

         Initial Public Version (postgrey/contrib)

</pre><h4><b>AUTHOR</b></h4><pre>
       Tom Baker &lt;<a href="mailto:tbaker@bakerfl.org">tbaker@bakerfl.org</a>&gt;

perl v5.38.2                                       2024-05-26                                  <u><a href="../man1/POSTGREYREPORT.1.html">POSTGREYREPORT</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>