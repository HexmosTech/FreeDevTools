<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ampwait - Qualcomm Atheros Powerline Procrastinator</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/plc-utils-extra">plc-utils-extra_0.0.6+git20250218.cbf52f68-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ampwait - Qualcomm Atheros Powerline Procrastinator

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ampwait</b> [<u>options</u>] [<u>device</u>] [<u>device</u>] [...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Poll  a  Qualcomm  Atheros powerline device, waiting for one or more events to occur before continuing or
       returning.  The events include reset or power off, restart or power on and network  association.   It  is
       used to pause shell scripts at critical points where a device must be in a known state before continuing.

       This program is part of the Qualcomm Atheros Powerline Toolkit.  See the <b>plc</b> man page for an overview and
       installation instructions.

</pre><h4><b>OPTIONS</b></h4><pre>
       -<b>a</b>     Poll  the  device  every  few  seconds using VS_NW_INFO messages until the device indicates that a
              networks exists and has at least one station.  This  option  can  give  false  readings  if  other
              devices  have  dropped  off-line and the device bridging table still holds information about them.
              The program always checks for this event last if other event options are specified.

       -<b>e</b>     Redirects stderr messages to stdout.  By convention status  and  error  messages  are  printed  on
              stderr while primary program output is printed on stdout.  This option prints all output on stdout
              in cases where this is desired.

       -<b>f</b> <u>firmware</u>
              The  identification  string  for  firmware  that  should be running after the device starts.  This
              option can be used to detect a failed firmware load.  If the actual identification string does not
              match this one once the device starts then an error is reported.  If option -<b>x</b> is present then the
              program terminates with a non-zero exit code.  This option has  no  effect  unless  option  -<b>s</b>  is
              present.  An identification string looks like "INT6000-MAC-3-1-3143-1690-20071107-FINAL-B" and can
              be obtained using <b>int6k</b> <b>-r.</b>

       -<b>i</b>     Select  the  host  Ethernet  interface.   All  requests  are sent via this host interface and only
              reponses received via this host interface are recognized.  The default interface is  <b>eth1</b>  because
              most  people  use <b>eth0</b> as their principle network connection; however, if environment string "PLC"
              is defined then it takes precedence over the default interface.  This option then takes precedence
              over either default.

       -<b>p</b> <u>seconds</u>
              Fixed pause time in seconds.  This adds an fixed delay after the other  events  have  occured.   A
              pause  does  not occur if any of the specified events timeout.  When no other events are specified
              this option is effectively equivalent to <b>sleep</b>.  This option can be used to allow  the  device  or
              the  network  to  settle.   For  example,  a  nominal  5 second wait is recommended after a device
              successfully associates before attempting to transfer data.

       -<b>q</b>     Enter quiet mode.  Progress messages are suppressed.

       -<b>R</b>     Reset the device then check return status.  Exit  program  on  error  if  option  <b>-x</b>  is  present;
              otherwise,  repeat  the reset request until the device either accepts the request or the wait time
              is exceeded.

       -<b>s</b>     Poll the device every few seconds  using  VS_SW_VER  messages  until  the  bootloader  or  runtime
              firmware  responds  or  the  poll  count  exhausts.  The presence of a response indicates that the
              device has either connected to the host, received power or finished reboot.

       -<b>t</b> <u>milliseconds</u>
              Channel read/write timeout in milliseconds.  This is the maximum time allowed for  a  confirmation
              or  a response from a powerline device before abandoning a read/write operation.  Permitted values
              range from <b>0</b> through <b>UINT_MAX</b> as defined in <b>limits.h</b>.  The default is <b>50</b> milliseconds.

       -<b>v</b>     Enter verbose mode.  All Etherenet frames sent or received by the program are displayed on stdout.

       -<b>w</b> <u>seconds</u>
              Wait timeout in seconds.  This is the maximum time that this application will wait for an event to
              occur where an event is <b>reset</b>, <b>start</b> or <b>assoc</b>.  If an event does no occur within  this  time,  the
              program proceeds to wait for the next specified event.  This timeout applies to each event in turn
              when  more  than one event is specified.  Permitted values are <b>0</b> through <b>86400</b> seconds which is 24
              hours.

       -<b>x</b>     Exit program on first error with a non-zero exit code.  This option allows shell scripts to detect
              failed or incomplete operations and take the appropriate action.

       -<b>y</b>     Display actual wait times on stdout.

       -<b>?</b>, --<b>help</b>
              Print program help summary on stdout.  This option takes precedence  over  other  options  on  the
              command line.

       -<b>!</b>, --<b>version</b>
              Print  program  version information on stdout.  This option takes precedence over other options on
              the command line.  Use this option when sending screen dumps to Atheros Technical Support so  that
              they know exactly which version of the Linux Toolkit you are using.

</pre><h4><b>ARGUMENTS</b></h4><pre>
       <u>device</u> The  Media  Access  Control  (MAC)  address  of  some  device.  Addresses are 6 hexadecimal octets
              optionally separated by colon.  For example, the addresses "00b052000001", "00:b0:52:00:00:01" and
              "00b052:000001" are all valid and equivalent.   For  convenience,  the  symbolic  address  "<b>local</b>"
              resolves  to  "00:b0:52:00:00:01" and the symbolic addresses "<b>all</b>" and "<b>broadcast</b>" both resolve to
              "ff:ff:ff:ff:ff:ff".

</pre><h4><b>REFERENCES</b></h4><pre>
       See the Qualcomm Atheros HomePlug AV Firmware Technical Reference Manual for more information.

</pre><h4><b>DISCLAIMER</b></h4><pre>
       Atheros HomePlug AV Vendor Specific Management Message Entry structure  and  content  is  proprietary  to
       Qualcomm Atheros, Ocala FL USA.  Consequently, public information may not be available.  Qualcomm Atheros
       reserves  the  right  to  modify  message  structure  and content in future firmware releases without any
       obligation to notify or compensate users of this program.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following command polls the local device until firmware stops running then  polls  the  device  until
       firmware  starts  running  again.   This command can be inserted into a shell script at a point where the
       device must reset and reboot before proceeding.  Observe that the program waits up to <b>60</b> seconds for each
       event, in turn, because <b>60</b> seconds is the default wait period.  If an event occurs before  the  specified
       timeout the program will move on to the next event.

          # ampwait -rs
          eth0 00:B0:52:BA:BA:01 Allow 60 seconds for Reset
          eth0 00:B0:52:BA:BA:01 Allow 60 seconds for Start

       The following example waits up to <b>30</b> seconds for the local device to reset (<b>-r</b>) then up to 50 seconds for
       the  local device to start (<b>-s</b>).  This is the same as above but we have specified <b>30</b> seconds using option
       <b>-w</b>.

          # ampwait -r -s -w 30
          eth0 00:B0:52:BA:BA:01 Allow 30 seconds for Reset
          eth0 00:B0:52:BA:BA:01 Allow 30 seconds for Start

       The next example reports the actual amount of time taken for each event to occur.  Observe that the  last
       event, device association, did not occur within the allotted time.

          # ampwait -rsay
          eth0 00:B0:52:BA:BA:01 Allow 60 seconds for Reset
          etho 00:B0:52:BA:BA:01 Waited 22 seconds to Reset
          eth0 00:B0:52:BA:BA:01 Allow 60 seconds for Start
          etho 00:B0:52:BA:BA:01 Waited 4 seconds to Start
          eth0 00:B0:52:BA:BA:01 Allow 60 seconds for Assoc
          etho 00:B0:52:BA:BA:01 Waited 60 seconds for Assoc
          etho 00:B0:52:BA:BA:01 Device did not Assoc

       The  following  example  illustrates  use  of the revision string to detect mismatched firmware.  In this
       example, we reset the device first, using program <b>amptool</b>, then wait for it to reset then start up again.
       There are also operation that can cause the device to reset.

          # amptool -R
          # ampwait -xrsf INT6000-MAC-3-1-3143-1690-20071107-FINAL-B
          eth0 00:B0:52:BA:BA:01 Device started wrong firmware

       Immediately after a reset we wait for the firmware to stop responding, with option  -<b>r</b>,  and  then  start
       responding,  with  option  -<b>s</b>,  and then perform a string comparison against the actual firmware revision
       string, with option -<b>f</b>.  If the strings do not match then an  error  is  reported.   In  this  case,  the
       program will exit with a non-zero return code since option -<b>x</b> is present.

</pre><h4><b>DISCLAIMER</b></h4><pre>
       Atheros  HomePlug  AV  Vendor  Specific  Management Message Entry structure and content is proprietary to
       Qualcomm Atheros, Ocala FL USA.  Consequently, public information may not be available.  Qualcomm Atheros
       reserves the right to modify message structure and  content  in  future  firmware  releases  without  any
       obligation to notify or compensate users of this program.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>amp</b>(<b>1</b>), <b>amptool</b>(<b>1</b>), <b>amphost</b>(<b>1</b>), <b>amprate</b>(<b>1</b>), <b>ampid</b>(<b>1</b>), <b>ampstat</b>(<b>1</b>)

</pre><h4><b>CREDITS</b></h4><pre>
        Charles Maier

open-plc-utils-0.0.3                              November 2013                                       <u><a href="../man1/plcwait.1.html">plcwait</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>