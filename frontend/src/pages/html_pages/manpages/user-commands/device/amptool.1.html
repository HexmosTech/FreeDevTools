<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>amptool - Qualcomm Atheros AR7x00 Powerline Device Manager</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/plc-utils">plc-utils_0.0.6+git20250218.cbf52f68-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       amptool - Qualcomm Atheros AR7x00 Powerline Device Manager

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>amptool</b> [<u>options</u>] [<u>device</u>] [<u>device</u>] [...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This version of the Qualcomm Atheros Device Manager for Linux performs basic operations on Atheros AR7400
       devices  using the raw Ethernet protocol described in the Qualcomm Atheros HomePlug AV Firmware Technical
       Reference Manual.  It can be used to interrogate and control devices  or  upgrade  firmware  if  on-board
       NVRAM is present.

       This  program is part of the Qualcomm Atheros Powerline Toolkit.  It supports chipset AR7400 and QCA7450.
       See <b>plctool</b> to support QCA6410, QCA7000 and QCA7420 devices.  See the <b>plc</b> man page for  an  overview  and
       installation instructions.

</pre><h4><b>COMMENTS</b></h4><pre>
       This  program  version  is identical to legacy program <b>int6k</b> except for option -<b>m</b> which uses version <b>1</b> of
       the Qualcomm Atheros <b>VS_NW_INFO</b> vendor-specific message.  Older firmware versions may not recognize  this
       message version.

</pre><h4><b>OPTIONS</b></h4><pre>
       -<b>a</b>     Read  device  attributes  using  VS_OP_ATTRIBUTES.  Attributes are short strings and integers that
              describe device hardware and firmware.  They are concatenated to form the output that  is  similar
              to option -<b>r</b> but derived differently.

       -<b>B</b> <u>action</u>
              Press  the simple connect pushbutton using VS_PB_ENC.  The <b>action</b> can be specified by number 1, 2,
              3 or 4 or by symbol "<b>join</b>", "<b>leave</b>", "<b>status</b>" or "<b>reset</b>", respectively.  Use  1  on  both  devices
              that are expected to join.  Use 2 only on the device that is expected to leave the network.

       -<b>C</b> <u>module</u>
              Commit  (flash)  downloaded  modules  to  NVRAM  using VS_MOD_NVM.  The <b>module</b> can be spedified by
              number 1, 2 or 3 or by symbol "<b>nvm</b>", "<b>pib</b>" or "<b>all</b>",  repectively.   Module  3  is  equivalent  to
              option  -<b>F</b> which writes the NVM and PIB together.  You cannot force flash NVRAM using this option.
              Use option -<b>FF</b> to force flash.

       -<b>d</b> <u>filename</u>
              Read Watchdog Report from the device and write it  to  the  named  file  in  binary  format  using
              VS_WD_RPT.   The  report  file  can  be  sent  to  Qualcomm  Atheros  for  technical analysis.  No
              assumptions are made based on filename and no  filename  convetions  are  enforced;  however,  you
              should use a <b>.log</b> file extension to indicate binary format.

       -<b>D</b> <u>xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx</u>
              Define  the 16 octet Device Access Key (DAK) in hex format.  The DAK is used by option -<b>J</b>.  It may
              also be set to "<b>key1</b>" or "<b>key2</b>" as explained in the <b>KEYS</b> section.

       -<b>e</b>     Redirects stderr messages to stdout.  By convention status  and  error  messages  are  printed  on
              stderr while primary program output is printed on stdout.  This option prints all output on stdout
              in cases where this is desired.

       -<b>f</b>     Read  flash  memory  parameters using VS_GET_NVM.  An error will be reported if no flash memory is
              present.

       -<b>F</b>[<b>F</b>]  Write previously downloaded MAC and PIB to NVRAM using VS_MOD_NVM.  Adding  a  second  <b>F</b>  here  or
              another  -<b>F</b>  anywhere  on  the command line will <b>force-flash</b> a blank or corrupted NVRAM.  Firmware
              loaded from NVRAM will treat force-flash as an error.  This option can be used to  create  factory
              settings  but  cannot  be  used  to  change them once created.  Subsequent use creates and updates
              operational settings that can be erased using a factory reset.  This option is executed after  all
              others on the command line, except for the -<b>R</b> option.

       -<b>i</b> <u>interface</u>
              Select  the  host  Ethernet  interface.   All  requests  are sent via this host interface and only
              reponses received via this host interface are recognized.  The default interface is  <b>eth1</b>  because
              most  people  use <b>eth0</b> as their principle network connection; however, if environment string "PLC"
              is defined then it takes precedence over the default interface.  This option then takes precedence
              over either default.

       -<b>I</b>     Read the device PIB header using VS_RD_MOD and print the firmware major revision number, PIB minor
              revision number, Device Access Key (DAK), Network Membership Key  (NMK),  MAC  address  and  other
              information on stdout.  The values displayed can be changed using program <b>modpib</b>.

       -<b>J</b> <u>xx:xx:xx:xx:xx:xx</u>
              Set  the Network Membership Key (NMK) on a remote device using VS_SET_KEY.  This option is similar
              to option -<b>K</b> but requires the remote device MAC and DAK in addition to the NMK  and  local  device
              MAC  address.   The NMK value is defined using option -<b>K</b> unless you want to use the default value.
              The remote DAK is defined using option -<b>D</b> unless you want to use the default  value.   Programming
              remote  device keys is complicated.  It is often easier to connect the device directly to the host
              and use the -<b>K</b> option.

       -<b>K</b> <u>xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx</u>
              Define the Network Membership Key (NMK) value used by options -<b>M</b> or -<b>J</b>.  The symbolic names "<b>key1</b>"
              and "<b>key2</b>" are recognized as described in the <b>KEY</b> section.

       -<b>l</b> <u>count</u>
              Define the number of times that the command will be repeated for each device specified.  Normally,
              you will repeat operations on one device only.

       -<b>m</b>     Read network membership information using VS_NW_INFO.  This  can  be  used  to  determine  network
              configuration.

       -<b>M</b>     Set  the  Network  Membership  Key  (NMK)  on the local device using VS_SET_KEY.  The NMK value is
              specified using the -<b>K</b> option unless you want to use the default value.

       -<b>n</b> <u>filename</u>
              Read firmware from the device SDRAM and write it to the named <b>.nvm</b> file using  multiple  VS_RD_MOD
              messages.   No  assumptions  are  made based on filename and no filename conventions are enforced.
              This option is performed before option -<b>N</b> when both are specified.

       -<b>N</b> <u>filename</u>
              Read the named <b>.nvm</b> file and write it  to  the  device  using  multiple  VS_WR_MOD  messages.   No
              assumptions  are  made  based on filename and no filename conventions are enforced; however, files
              having invalid .nvm format will be rejected.  This option is  executed  after  -<b>n</b>  when  both  are
              specified.

       -<b>p</b> <u>filename</u>
              Read  parameters  from  the  device  SDRAM  and  write  them to the named <b>.pib</b> file using multiple
              VS_RD_MOD messages.  No assumptions are made based on filename  and  no  filename  convetions  are
              enforced.  This option is executed before option BP when both are specified.

       -<b>P</b> <u>filename</u>
              Read  the  named  <b>.pib</b>  file  and  write  it  to the device using multiple VS_WR_MOD messages.  No
              assumptions are made based on filename and no filename conventions are  enforced;  however,  files
              having  invalid  .pib  format  will  be  rejected.  This option is executed after -<b>p</b> when both are
              specified.

       -<b>q</b>     Suppresses status messages on stderr.

       -<b>Q</b>     Quick flash.  The program will not wait for a device to reset or the  firmware  to  restart  after
              writing  flash  memory.   This option is desirable with newer firmware that writes flash memory in
              the background.  It has no effect unless used with option -<b>F</b> or -<b>C</b>.

       -<b>r</b>     Read device firmware and hardware revision using VS_SW_VER.  Output is similar to option -<b>a</b> but is
              derived differently.

       -<b>R</b>     Reset the device using VS_RS_DEV.  This option is executed after all others on  the  same  command
              line.

       -<b>s</b>     Read device SDRAM configuration using VS_RD_CBLOCK.

       -<b>t</b> <u>milliseconds</u>
              Read  timeout  in  milliseconds.   Values range from 0 through UINT_MAX.  This is the maximum time
              allowed for a response.  The default is shown in brackets on the program menu.

       -<b>T</b>     Restore factory defaults.  This permanently erases all PIB changes made since the device was  last
              programmed with factory default settings.  The device will automatically reset and reboot.

       -<b>v</b>     Print  additional  information  on stdout.  In particular, this option dumps incoming and outgoing
              packets which can be saved as text files for reference.

       -<b>w</b> <u>seconds</u>
              Defines the number of <u>seconds</u> to wait before repeating command line options.  This option  has  no
              effect unless option -<b>l</b> is also specified with a non-zero value.

       -<b>x</b>     Cause  the  program  to  exit  on the first error instead of continuing with remaining iterations,
              operations or devices.  Normally, the program reports errors and moves on to the  next  operation,
              iteration or device depending on the command line.

       -<b>?</b>,--<b>help</b>
              Print  program  help  summary  on  stdout.  This option takes precedence over other options on the
              command line.

       -<b>?</b>,--<b>version</b>
              Print program version information on stdout.  This option takes precedence over other  options  on
              the  command line.  Use this option when sending screen dumps to Atheros Technical Support so that
              they know exactly which version of the Linux Toolkit you are using.

</pre><h4><b>ARGUMENTS</b></h4><pre>
       <u>device</u> The Ethernet hardware address of some powerline device.  More than one address may be specified on
              the command line.  If more than one address is specified then operations  are  performed  on  each
              device in turn.  The default address is <b>local</b>.  as explained in the <b>DEVICES</b> section.

</pre><h4><b>KEYS</b></h4><pre>
       Passwords  are  variable  length  character  strings  that end-users can remember.  Keys are fixed length
       binary values created by encrypting passwords.  There are two encryption algorithms for HomePlugAV.   One
       for  DAKs and the other for NMKs.  This means that a given password will produce different keys depending
       on use.  This program only deals with keys  because  that  is  what  powerline  devices  recognize.   The
       passwords that generated the keys are irrelevant here.

       Encryption  keys  are  tedious  to  type  and  prone to error.  For convenience, symbolic names have been
       assigned to common encryption keys and are recognized by options -<b>D</b> and -<b>K</b>.

       <b>key1</b>   Key for encrypted password "<b>HomePlugAV</b>".  This is "689F074B8B0275A2710B0B5779AD1630" for option -<b>D</b>
              and "50D3E4933F855B7040784DF815AA8DB7" for option <b>-K</b>.

       <b>key2</b>   Key for encrypted  password  "<b>HomePlugAV0123</b>".   This  is  "F084B4E8F6069FF1300C9BDB812367FF"  for
              option -<b>D</b> and "B59319D7E8157BA001B018669CCEE30D" for option -<b>K</b>.

       <b>none</b>   Always "00000000000000000000000000000000".

</pre><h4><b>DEVICES</b></h4><pre>
       Powerline  devices use Ethernet hardware, or Media Access Control (MAC), addresses.  Device addresses are
       12 hexadecimal digits (<b>0123456789ABCDEFabcdef</b>) in upper, lower or mixed case.  Individual octets  may  be
       separated  by colons, for clarity, but not all octets need to be seperated.  For example, "00b052000001",
       "00:b0:52:00:00:01" and "00b052:000001" are valid and equivalent.

       These symbolic addresses are recognized by this program and may be used instead  of  the  actual  address
       value.

       <b>all</b>    Equivalent to "broadcast", described next.

       <b>broadcast</b>
              A  synonym  for  the standard Ethernet broadcast address, <b>FF:FF:FF:FF:FF:FF</b>.  All devices, whether
              local, remote or foreign will respond to this address.

       <b>local</b>  A  synonym  for  the  Qualcomm  Atheros  vendor   specific   Local   Management   Address   (LMA),
              <b>00:B0:52:00:00:01</b>.   All  local Atheros devices will recognize this address but remote and foreign
              devices will not.  A remote device is any device at the far end  of  a  powerline  connection.   A
              foreign device is any device not manufactured by Atheros.

</pre><h4><b>REFERENCES</b></h4><pre>
       See the Qualcomm Atheros HomePlug AV Firmware Technical Reference Manual for more information.

</pre><h4><b>DISCLAIMER</b></h4><pre>
       Atheros  HomePlug  AV Vendor Specific Management Message structure and content is proprietary to Qualcomm
       Atheros, Ocala FL USA.  Consequently, public information may not be available.  Qualcomm Atheros reserves
       the right to modify message structure or content in future firmware releases without  any  obligation  to
       notify or compensate users of this program.

</pre><h4><b>EXAMPLES</b></h4><pre>
          # amptool -n old.nvm -p old.pib -N new.nvm -P new.pib -F 01:23:45:67:89:AB

       Performs  5  operations  on  one device.  Uploads the firmware and PIB from the device and writes them to
       files <b>old.nvm</b> and <b>old.pib</b>, respectively.  Reads files <b>new.nvm</b> and  <b>new.pib</b>  and  downloads  them  as  new
       firmware  and  PIB,  respectively.   Commits  the  downloaded  firmware and PIB to NVRAM.  Operations are
       executed in the order just described regardless of the order specified on the command line.  If you  want
       reading  and  writing  to occur in a different order then you must use two or more commands to accomplish
       tasks in the order you want.

          # amptool -N new.nvm 01:23:45:67:89:28
          # amptool -P new.pib 01:23:45:67:89:28
          # amptool -C 3 01:23:45:67:89:28

       It is not neccessary to specify all operations on one command line.  The three  command  lines  above  do
       essentially  the  same  thing as the command line shown in the previou example.  Notice that this example
       uses -<b>C</b> <b>3</b>, instead of -<b>F</b>, as an alternate way to write MAC and PIB to NVRAM.  Specifying -<b>C</b>  <b>1</b>,  instead,
       would  write the .nvm file only.  Specifying, -<b>C</b> <b>2</b>, instead, would write the .pib file only.  The value <b>3</b>
       is the logical OR of <b>1</b> and <b>2</b>.

          # amptool -N new.nvm -P new.pib -FF local

       Downloads file <b>new.nvm</b> and file <b>new.pib</b> and force flashes the <b>local</b> device.  Force flashing only works on
       running firmware that has been downloaded and stated by the Qualcomm Atheros Boot Loader.   See  <b>amptoolf</b>
       to download, start firmware and perform a force flash in one operation.

          # amptool -MK key1
          # amptool -M

       These  two  commands  are  equivalent.  They set the NMK on the local device to key1 as descripted in the
       <b>KEYS</b> section.  The first command resets the NMK on the local device with -<b>M</b> then  specifies  the  NMK  as
       <b>key1</b>.   The second command omits the key specification since <b>key1</b> is the program default NMK.  One could,
       of course, type the encryption key.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>plc</b>(<b>1</b>), <b>ampboot</b>(<b>1</b>), <b>ampboot</b>(<b>1</b>), <b>amphost</b>(<b>1</b>), <b>int6kid</b>(<b>1</b>), <b>amprate</b>(<b>1</b>), <b>amprule</b>(<b>1</b>), <b>ampstat</b>(<b>1</b>), <b>ampwait</b>(<b>1</b>)

</pre><h4><b>CREDITS</b></h4><pre>
        Charles Maier
        Nathaniel Houghton

open-plc-utils-0.0.3                              November 2013                                       <u><a href="../man1/amptool.1.html">amptool</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>