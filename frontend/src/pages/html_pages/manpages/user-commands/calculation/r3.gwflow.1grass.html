<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>r3.gwflow  - Numerical calculation program for transient, confined groundwater flow in three dimensions.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/grass-doc">grass-doc_8.4.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>r3.gwflow</b>  - Numerical calculation program for transient, confined groundwater flow in three dimensions.

</pre><h4><b>KEYWORDS</b></h4><pre>
       raster3d, groundwater flow, voxel, hydrology

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>r3.gwflow</b>
       <b>r3.gwflow</b> <b>--help</b>
       <b>r3.gwflow</b>   [-<b>mf</b>]   <b>phead</b>=<u>name</u>   <b>status</b>=<u>name</u>   <b>hc_x</b>=<u>name</u>  <b>hc_y</b>=<u>name</u>  <b>hc_z</b>=<u>name</u>   [<b>sink</b>=<u>name</u>]   <b>yield</b>=<u>name</u>
       [<b>recharge</b>=<u>name</u>]  <b>output</b>=<u>name</u>  [<b>velocity_x</b>=<u>name</u>]   [<b>velocity_y</b>=<u>name</u>]    [<b>velocity_z</b>=<u>name</u>]    [<b>budget</b>=<u>name</u>]
       <b>dtime</b>=<u>float</u>   [<b>maxit</b>=<u>integer</u>]    [<b>error</b>=<u>float</u>]    [<b>solver</b>=<u>name</u>]    [--<b>overwrite</b>]   [--<b>help</b>]   [--<b>verbose</b>]
       [--<b>quiet</b>]  [--<b>ui</b>]

   <b>Flags:</b>
       <b>-m</b>
           Use 3D raster mask (if exists)

       <b>-f</b>
           Use a full filled quadratic linear equation system, default is a sparse linear equation system.

       <b>--overwrite</b>
           Allow output files to overwrite existing files

       <b>--help</b>
           Print usage summary

       <b>--verbose</b>
           Verbose module output

       <b>--quiet</b>
           Quiet module output

       <b>--ui</b>
           Force launching GUI dialog

   <b>Parameters:</b>
       <b>phead</b>=<u>name</u> <b>[required]</b>
           Input 3D raster map with initial piezometric heads in [m]

       <b>status</b>=<u>name</u> <b>[required]</b>
           Input 3D raster map providing the status for each cell, = 0 - inactive, 1 - active, 2 - dirichlet

       <b>hc_x</b>=<u>name</u> <b>[required]</b>
           Input 3D raster map with the x-part of the hydraulic conductivity tensor in [m/s]

       <b>hc_y</b>=<u>name</u> <b>[required]</b>
           Input 3D raster map with the y-part of the hydraulic conductivity tensor in [m/s]

       <b>hc_z</b>=<u>name</u> <b>[required]</b>
           Input 3D raster map with the z-part of the hydraulic conductivity tensor in [m/s]

       <b>sink</b>=<u>name</u>
           Input 3D raster map with sources and sinks in [m^3/s]

       <b>yield</b>=<u>name</u> <b>[required]</b>
           Specific yield [1/m] input 3D raster map

       <b>recharge</b>=<u>name</u>
           Recharge input 3D raster map in m^3/s

       <b>output</b>=<u>name</u> <b>[required]</b>
           Output 3D raster map storing the piezometric head result of the numerical calculation

       <b>velocity_x</b>=<u>name</u>
           Output 3D raster map storing the groundwater filter velocity vector part in x direction [m/s]

       <b>velocity_y</b>=<u>name</u>
           Output 3D raster map storing the groundwater filter velocity vector part in y direction [m/s]

       <b>velocity_z</b>=<u>name</u>
           Output 3D raster map storing the groundwater filter velocity vector part in z direction [m/s]

       <b>budget</b>=<u>name</u>
           Output 3D raster map storing the groundwater budget for each cell [m^3/s]

       <b>dtime</b>=<u>float</u> <b>[required]</b>
           The calculation time in seconds
           Default: <u>86400</u>

       <b>maxit</b>=<u>integer</u>
           Maximum number of iteration used to solve the linear equation system
           Default: <u>10000</u>

       <b>error</b>=<u>float</u>
           Error break criteria for iterative solver
           Default: <u>0.000001</u>

       <b>solver</b>=<u>name</u>
           The type of solver which should solve the symmetric linear equation system
           Options: <u>cg,</u> <u>pcg,</u> <u>cholesky</u>
           Default: <u>cg</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This numerical module calculates implicit transient and steady state, confined groundwater flow in  three
       dimensions based on volume maps and the current 3D region settings.  All initial- and boundary-conditions
       must be provided as volume maps.  The unit of the current coordinate reference system must be meters.

       This  module  is sensitive to mask settings. All cells which are outside the mask are ignored and handled
       as no flow boundaries.

       The module calculates the piezometric head and optionally  the  water  balance  for  each  cell  and  the
       groundwater  velocity  field  in  3 dimensions.  The vector components can be visualized with ParaView if
       they are exported with <u>r3.out.vtk</u>.

       The groundwater flow will always be calculated transient.  For steady state computation the  user  should
       set the timestep to a large number (billions of seconds) or set the specific yield raster map to zero.

</pre><h4><b>NOTES</b></h4><pre>
       The  groundwater  flow  calculation  is  based  on  Darcy’s  law  and  a numerical implicit finite volume
       discretization. The discretization results in a symmetric and positive definite linear equation system in
       form of <u>Ax</u> <u>=</u> <u>b</u>, which must be solved. The groundwater  flow  partial  differential  equation  is  of  the
       following form:

       (dh/dt)*S = div (K grad h) + q

       In detail for 3 dimensions:

       (dh/dt)*S = Kxx * (d^2h/dx^2) + Kyy * (d^2h/dy^2) + Kzz * (d^2h/dz^2) + q

           •   h -- the piezometric head im meters [m]

           •   dt -- the time step for transient calculation in seconds [s]

           •   S -- the specific yield  [1/m]

           •   b -- the bottom surface of the aquifer meters [m]

           •   Kxx -- the hydraulic conductivity tensor part in x direction in meter per second [m/s]

           •   Kyy -- the hydraulic conductivity tensor part in y direction in meter per seconds [m/s]

           •   Kzz -- the hydraulic conductivity tensor part in z direction in meter per seconds [m/s]

           •   q - inner source/sinc in [1/s]

       Two  different  boundary conditions are implemented, the Dirichlet and Neumann conditions. By default the
       calculation area is surrounded by homogeneous Neumann boundary conditions. The calculation  and  boundary
       status of single cells can be set with the status map, the following cell states are supported:

           •   0  ==  inactive - the cell with status 0 will not be calculated, active cells will have a no flow
               boundary to an inactive cell

           •   1 == active - this cell is used for groundwater calculation, inner sources  can  be  defined  for
               those cells

           •   2  == Dirichlet - cells of this type will have a fixed piezometric head value which do not change
               over time

       Note that all required raster maps are read into main memory. Additionally  the  linear  equation  system
       will  be  allocated,  so  the  memory consumption of this module rapidely grow with the size of the input
       maps.

       The resulting linear equation system <u>Ax</u> <u>=</u> <u>b</u> can be solved with several solvers. An iterative solvers with
       sparse and quadratic matrices support is implemented.  The conjugate  gradients  method  with  (pcg)  and
       without  (cg)  precondition.  Additionally a direct Cholesky solver is available. This direct solver only
       work with normal quadratic matrices, so be careful using them with large maps (maps of size 10.000  cells
       will need more than one Gigabyte of RAM). The user should always prefer to use a sparse matrix solver.

</pre><h4><b>EXAMPLE</b> <b>1</b></h4><pre>
       This  small  script  creates  a  working  groundwater  flow  area and data. It cannot be run in a lat/lon
       project.
       # set the region accordingly
       g.region res=25 res3=25 t=100 b=0 n=1000 s=0 w=0 e=1000 -p3
       #now create the input raster maps for a confined aquifer
       r3.mapcalc expression="phead = if(row() == 1 &amp;&amp; depth() == 4, 50, 40)"
       r3.mapcalc expression="status = if(row() == 1 &amp;&amp; depth() == 4, 2, 1)"
       r3.mapcalc expression="well = if(row() == 20 &amp;&amp; col() == 20 &amp;&amp; depth() == 2, -0.25, 0)"
       r3.mapcalc expression="hydcond = 0.00025"
       r3.mapcalc expression="syield = 0.0001"
       r.mapcalc  expression="recharge = 0.0"
       r3.gwflow solver=cg phead=phead statuyield=status hc_x=hydcond hc_y=hydcond  \
          hc_z=hydcond sink=well yield=syield r=recharge output=gwresult dt=8640000 vx=vx vy=vy vz=vz budget=budget
       # The data can be visualized with ParaView when exported with r3.out.vtk
       r3.out.vtk -p in=gwresult,status,budget vector=vx,vy,vz out=/tmp/gwdata3d.vtk
       #now load the data into ParaView
       paraview --data=/tmp/gwdata3d.vtk

</pre><h4><b>EXAMPLE</b> <b>2</b></h4><pre>
       This will create a nice 3D model with geological layer with different hydraulic conductivities. Make sure
       you are not in a lat/lon projection.
       # set the region accordingly
       g.region res=15 res3=15 t=500 b=0 n=1000 s=0 w=0 e=1000
       #now create the input raster maps for a confined aquifer
       r3.mapcalc expression="phead = if(col() == 1 &amp;&amp; depth() == 33, 50, 40)"
       r3.mapcalc expression="status = if(col() == 1 &amp;&amp; depth() == 33, 2, 1)"
       r3.mapcalc expression="well = if(row() == 20 &amp;&amp; col() == 20 &amp;&amp; depth() == 3, -0.25, 0)"
       r3.mapcalc expression="well = if(row() == 50 &amp;&amp; col() == 50 &amp;&amp; depth() == 3, -0.25, well)"
       r3.mapcalc expression="hydcond = 0.0025"
       r3.mapcalc expression="hydcond = if(depth() &lt; 30 &amp;&amp; depth() &gt; 23 &amp;&amp; col() &lt; 60, 0.000025, hydcond)"
       r3.mapcalc expression="hydcond = if(depth() &lt; 20 &amp;&amp; depth() &gt; 13 &amp;&amp; col() &gt;  7, 0.000025, hydcond)"
       r3.mapcalc expression="hydcond = if(depth() &lt; 10 &amp;&amp; depth() &gt;  7 &amp;&amp; col() &lt; 60, 0.000025, hydcond)"
       r3.mapcalc expression="syield = 0.0001"
       r3.gwflow solver=cg phead=phead statuyield=status hc_x=hydcond hc_y=hydcond  \
          hc_z=hydcond sink=well yield=syield output=gwresult dt=8640000 vx=vx vy=vy vz=vz budget=budget
       # The data can be visualized with paraview when exported with r3.out.vtk
       r3.out.vtk -p in=gwresult,status,budget,hydcond,well vector=vx,vy,vz out=/tmp/gwdata3d.vtk
       #now load the data into paraview
       paraview --data=/tmp/gwdata3d.vtk

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        <u>r.gwflow,</u> <u>r.solute.transport,</u> <u>r3.out.vtk</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       Sören Gebbert

       This work is based on the Diploma Thesis of Sören Gebbert available here at Technical University  Berlin,
       Germany.

</pre><h4><b>SOURCE</b> <b>CODE</b></h4><pre>
       Available at: r3.gwflow source code (history)

       Accessed: Friday Apr 04 01:20:03 2025

       Main index | 3D raster index | Topics index | Keywords index | Graphical index | Full index

       © 2003-2025 GRASS Development Team, GRASS GIS 8.4.1 Reference Manual

GRASS 8.4.1                                                                                    <u><a href="../man1grass/r3.gwflow.1grass.html">r3.gwflow</a></u>(1grass)
</pre>
 </div>
</div></section>
</div>
</body>
</html>