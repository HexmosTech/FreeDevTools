<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>borg-create - Create new archive</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/borgbackup">borgbackup_1.2.0-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       borg-create - Create new archive

</pre><h4><b>SYNOPSIS</b></h4><pre>
       borg [common options] create [options] ARCHIVE [PATH...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  command  creates a backup archive containing all files found while recursively traversing all paths
       specified. Paths are added to the archive as they are given, that means if relative  paths  are  desired,
       the command has to be run from the correct directory.

       When giving '-' as path, borg will read data from standard input and create a file 'stdin' in the created
       archive  from  that data. In some cases it's more appropriate to use --content-from-command, however. See
       section <u>Reading</u> <u>from</u> <u>stdin</u> below for details.

       The archive will consume almost no disk space for files or parts of files that have already  been  stored
       in other archives.

       The  archive name needs to be unique. It must not end in '.checkpoint' or '.checkpoint.N' (with N being a
       number), because these names are used for checkpoints and treated in special ways.

       In the archive name, you may use the following placeholders: {now}, {utcnow}, {fqdn}, {hostname},  {user}
       and some others.

       Backup  speed  is  increased  by  not  reprocessing  files that are already part of existing archives and
       weren't modified. The detection of unmodified files is done by comparing multiple  file  metadata  values
       with previous values kept in the files cache.

       This comparison can operate in different modes as given by <b>--files-cache</b>:

       • ctime,size,inode (default)

       • mtime,size,inode (default behaviour of borg versions older than 1.1.0rc4)

       • ctime,size (ignore the inode number)

       • mtime,size (ignore the inode number)

       • rechunk,ctime (all files are considered modified - rechunk, cache ctime)

       • rechunk,mtime (all files are considered modified - rechunk, cache mtime)

       • disabled (disable the files cache, all files considered modified - rechunk)

       inode number: better safety, but often unstable on network filesystems

       Normally,  detecting  file  modifications  will  take inode information into consideration to improve the
       reliability of file change detection.  This is problematic for files located on sshfs and similar network
       file systems which do not provide stable inode numbers, such files will always  be  considered  modified.
       You  can use modes without <u>inode</u> in this case to improve performance, but reliability of change detection
       might be reduced.

       ctime vs. mtime: safety vs. speed

       • ctime is a rather safe way to detect changes to a file (metadata and contents) as it  can  not  be  set
         from  userspace.  But,  a  metadata-only  change  will already update the ctime, so there might be some
         unnecessary chunking/hashing even without content  changes.  Some  filesystems  do  not  support  ctime
         (change time).  E.g. doing a chown or chmod to a file will change its ctime.

       • mtime  usually  works  and only updates if file contents were changed. But mtime can be arbitrarily set
         from userspace, e.g. to set mtime back to the same value it had before a content change happened.  This
         can  be  used  maliciously  as  well  as  well-meant,  but in both cases mtime based cache modes can be
         problematic.

       The mount points of filesystems or filesystem snapshots should be the same for every creation  of  a  new
       archive  to ensure fast operation. This is because the file cache that is used to determine changed files
       quickly uses absolute filenames.  If this is not possible, consider creating a bind  mount  to  a  stable
       location.

       The  <b>--progress</b>  option  shows  (from  left  to right) Original, Compressed and Deduplicated (O, C and D,
       respectively), then the Number of files (N) processed so far, followed by the currently processed path.

       When using <b>--stats</b>, you will get some statistics about how much data  was  added  -  the  "This  Archive"
       deduplicated  size  there  is most interesting as that is how much your repository will grow. Please note
       that the "All archives" stats refer to the state after creation. Also, the <b>--stats</b> and <b>--dry-run</b>  options
       are mutually exclusive because the data is not actually compressed and deduplicated during a dry run.

       For more help on include/exclude patterns, see the <u>borg_patterns</u> command output.

       For more help on placeholders, see the <u>borg_placeholders</u> command output.

</pre><h4><b>OPTIONS</b></h4><pre>
       See <u><a href="../man1/borg-common.1.html">borg-common</a>(1)</u> for common options of Borg commands.

   <b>arguments</b>
       <b>ARCHIVE</b>
              name of archive to create (must be also a valid directory name)

       <b>PATH</b>   paths to archive

   <b>optional</b> <b>arguments</b>
       <b>-n</b>, <b>--dry-run</b>
              do not create a backup archive

       <b>-s</b>, <b>--stats</b>
              print statistics for the created archive

       <b>--list</b> output verbose list of items (files, dirs, ...)

       <b>--filter</b> <u>STATUSCHARS</u>
              only display items with the given status characters (see description)

       <b>--json</b> output stats as JSON. Implies <b>--stats</b>.

       <b>--no-cache-sync</b>
              experimental: do not synchronize the cache. Implies not using the files cache.

       <b>--stdin-name</b> <u>NAME</u>
              use NAME in archive for stdin data (default: 'stdin')

       <b>--stdin-user</b> <u>USER</u>
              set user USER in archive for stdin data (default: 'root')

       <b>--stdin-group</b> <u>GROUP</u>
              set group GROUP in archive for stdin data (default: 'wheel')

       <b>--stdin-mode</b> <u>M</u>
              set mode to M in archive for stdin data (default: 0660)

       <b>--content-from-command</b>
              interpret PATH as command and store its stdout. See also section Reading from stdin below.

       <b>--paths-from-stdin</b>
              read DELIM-separated list of paths to backup from stdin. Will not recurse into directories.

       <b>--paths-from-command</b>
              interpret PATH as command and treat its output as <b>--paths-from-stdin</b>

       <b>--paths-delimiter</b> <u>DELIM</u>
              set path delimiter for <b>--paths-from-stdin</b> and <b>--paths-from-command</b> (default: n)

   <b>Exclusion</b> <b>options</b>
       <b>-e</b> <u>PATTERN</u>, <b>--exclude</b> <u>PATTERN</u>
              exclude paths matching PATTERN

       <b>--exclude-from</b> <u>EXCLUDEFILE</u>
              read exclude patterns from EXCLUDEFILE, one per line

       <b>--pattern</b> <u>PATTERN</u>
              include/exclude paths matching PATTERN

       <b>--patterns-from</b> <u>PATTERNFILE</u>
              read include/exclude patterns from PATTERNFILE, one per line

       <b>--exclude-caches</b>
              exclude directories that contain a CACHEDIR.TAG file (<u><a href="http://www.bford.info/cachedir/spec.html">http://www.bford.info/cachedir/spec.html</a></u>)

       <b>--exclude-if-present</b> <u>NAME</u>
              exclude directories that are tagged by containing a filesystem object with the given NAME

       <b>--keep-exclude-tags</b>
              if tag objects are specified with <b>--exclude-if-present</b>, don't omit the tag objects themselves from
              the backup archive

       <b>--exclude-nodump</b>
              exclude files flagged NODUMP

   <b>Filesystem</b> <b>options</b>
       <b>-x</b>, <b>--one-file-system</b>
              stay  in  the  same  file  system and do not store mount points of other file systems.  This might
              behave different from your expectations, see the docs.

       <b>--numeric-owner</b>
              deprecated, use <b>--numeric-ids</b> instead

       <b>--numeric-ids</b>
              only store numeric user and group identifiers

       <b>--noatime</b>
              do not store atime into archive

       <b>--atime</b>
              do store atime into archive

       <b>--noctime</b>
              do not store ctime into archive

       <b>--nobirthtime</b>
              do not store birthtime (creation date) into archive

       <b>--nobsdflags</b>
              deprecated, use <b>--noflags</b> instead

       <b>--noflags</b>
              do not read and store flags (e.g. NODUMP, IMMUTABLE) into archive

       <b>--noacls</b>
              do not read and store ACLs into archive

       <b>--noxattrs</b>
              do not read and store xattrs into archive

       <b>--sparse</b>
              detect sparse holes in input (supported only by fixed chunker)

       <b>--files-cache</b> <u>MODE</u>
              operate files cache in MODE. default: ctime,size,inode

       <b>--read-special</b>
              open and read block and char device files as well as FIFOs as if they  were  regular  files.  Also
              follows symlinks pointing to these kinds of files.

   <b>Archive</b> <b>options</b>
       <b>--comment</b> <u>COMMENT</u>
              add a comment text to the archive

       <b>--timestamp</b> <u>TIMESTAMP</u>
              manually  specify the archive creation date/time (UTC, yyyy-mm-ddThh:mm:ss format). Alternatively,
              give a reference file/directory.

       <b>-c</b> <u>SECONDS</u>, <b>--checkpoint-interval</b> <u>SECONDS</u>
              write checkpoint every SECONDS seconds (Default: 1800)

       <b>--chunker-params</b> <u>PARAMS</u>
              specify   the   chunker   parameters   (ALGO,   CHUNK_MIN_EXP,   CHUNK_MAX_EXP,    HASH_MASK_BITS,
              HASH_WINDOW_SIZE). default: buzhash,19,23,21,4095

       <b>-C</b> <u>COMPRESSION</u>, <b>--compression</b> <u>COMPRESSION</u>
              select compression algorithm, see the output of the "borg help compression" command for details.

</pre><h4><b>EXAMPLES</b></h4><pre>
          # Backup <a href="file:~/Documents">~/Documents</a> into an archive named "my-documents"
          $ borg create /path/to/repo::my-documents <a href="file:~/Documents">~/Documents</a>

          # same, but list all files as we process them
          $ borg create --list /path/to/repo::my-documents <a href="file:~/Documents">~/Documents</a>

          # Backup <a href="file:~/Documents">~/Documents</a> and <a href="file:~/src">~/src</a> but exclude pyc files
          $ borg create /path/to/repo::my-files \
              <a href="file:~/Documents">~/Documents</a>                       \
              <a href="file:~/src">~/src</a>                             \
              --exclude '*.pyc'

          # Backup home directories excluding image thumbnails (i.e. only
          # <a href="file:/home/">/home/</a>&lt;one directory&gt;/.thumbnails is excluded, not <a href="file:/home/">/home/</a>*/*/.thumbnails etc.)
          $ borg create /path/to/repo::my-files <a href="file:/home">/home</a> \
              --exclude 'sh:<a href="file:/home/">/home/</a>*/.thumbnails'

          # Backup the root filesystem into an archive named "root-YYYY-MM-DD"
          # use zlib compression (good, but slow) - default is lz4 (fast, low compression ratio)
          $ borg create -C zlib,6 --one-file-system /path/to/repo::root-{now:%Y-%m-%d} /

          # Backup onto a remote host ("push" style) via ssh to port 2222,
          # logging in as user "borg" and storing into /path/to/repo
          $ borg create ssh://<a href="mailto:borg@backup.example.org">borg@backup.example.org</a>:2222/path/to/repo::{fqdn}-root-{now} /

          # Backup a remote host locally ("pull" style) using sshfs
          $ mkdir sshfs-mount
          $ sshfs <a href="mailto:root@example.com">root@example.com</a>:/ sshfs-mount
          $ cd sshfs-mount
          $ borg create /path/to/repo::example.com-root-{now:%Y-%m-%d} .
          $ cd ..
          $ fusermount -u sshfs-mount

          # Make a big effort in fine granular deduplication (big chunk management
          # overhead, needs a lot of RAM and disk space, see formula in internals
          # docs - same parameters as borg &lt; 1.0 or attic):
          $ borg create --chunker-params buzhash,10,23,16,4095 /path/to/repo::small /smallstuff

          # Backup a raw device (must not be active/in use/mounted at that time)
          $ borg create --read-special --chunker-params fixed,4194304 /path/to/repo::my-sdx /dev/sdX

          # Backup a sparse disk image (must not be active/in use/mounted at that time)
          $ borg create --sparse --chunker-params fixed,4194304 /path/to/repo::my-disk my-disk.raw

          # No compression (none)
          $ borg create --compression none /path/to/repo::arch ~

          # Super fast, low compression (lz4, default)
          $ borg create /path/to/repo::arch ~

          # Less fast, higher compression (zlib, N = 0..9)
          $ borg create --compression zlib,N /path/to/repo::arch ~

          # Even slower, even higher compression (lzma, N = 0..9)
          $ borg create --compression lzma,N /path/to/repo::arch ~

          # Only compress compressible data with lzma,N (N = 0..9)
          $ borg create --compression auto,lzma,N /path/to/repo::arch ~

          # Use short hostname, user name and current time in archive name
          $ borg create /path/to/repo::{hostname}-{user}-{now} ~
          # Similar, use the same datetime format that is default as of borg 1.1
          $ borg create /path/to/repo::{hostname}-{user}-{now:%Y-%m-%dT%H:%M:%S} ~
          # As above, but add nanoseconds
          $ borg create /path/to/repo::{hostname}-{user}-{now:%Y-%m-%dT%H:%M:%S.%f} ~

          # Backing up relative paths by moving into the correct directory first
          $ cd /home/user/Documents
          # The root directory of the archive will be "projectA"
          $ borg create /path/to/repo::daily-projectA-{now:%Y-%m-%d} projectA

          # Use external command to determine files to archive
          # Use --paths-from-stdin with find to only backup files less than 1MB in size
          $ find ~ -size -1000k | borg create --paths-from-stdin /path/to/repo::small-files-only
          # Use --paths-from-command with find to only backup files from a given user
          $ borg create --paths-from-command /path/to/repo::joes-files -- find /srv/samba/shared -user joe
          # Use --paths-from-stdin with --paths-delimiter (for example, for filenames with newlines in them)
          $ find ~ -size -1000k -print0 | borg create \
              --paths-from-stdin \
              --paths-delimiter "\0" \
              /path/to/repo::smallfiles-handle-newline

</pre><h4><b>NOTES</b></h4><pre>
       The  <b>--exclude</b>  patterns are not like tar. In tar <b>--exclude</b> .bundler/gems will exclude foo/.bundler/gems.
       In borg it will not, you need to use <b>--exclude</b> '*/.bundler/gems' to get the same effect.

       In addition to using <b>--exclude</b> patterns, it is possible to use <b>--exclude-if-present</b> to specify  the  name
       of  a  filesystem  object  (e.g. a file or folder name) which, when contained within another folder, will
       prevent the containing folder from being backed up.  By default, the containing folder  and  all  of  its
       contents will be omitted from the backup.  If, however, you wish to only include the objects specified by
       <b>--exclude-if-present</b>  in  your  backup, and not include any other contents of the containing folder, this
       can be enabled through using the <b>--keep-exclude-tags</b> option.

       The <b>-x</b> or <b>--one-file-system</b> option excludes directories, that are mountpoints (and everything  in  them).
       It  detects mountpoints by comparing the device number from the output of <b>stat()</b> of the directory and its
       parent directory. Specifically, it  excludes  directories  for  which  <b>stat()</b>  reports  a  device  number
       different  from  the device number of their parent. Be aware that in Linux (and possibly elsewhere) there
       are directories with device number different from their parent, which the  kernel  does  not  consider  a
       mountpoint  and  also  the  other  way around. Examples are bind mounts (possibly same device number, but
       always a mountpoint) and ALL subvolumes  of  a  btrfs  (different  device  number  from  parent  but  not
       necessarily  a  mountpoint). Therefore when using <b>--one-file-system</b>, one should make doubly sure that the
       backup works as intended especially when using btrfs. This is even more important, if  the  btrfs  layout
       was created by someone else, e.g. a distribution installer.

   <b>Item</b> <b>flags</b>
       <b>--list</b>  outputs  a  list  of  all files, directories and other file system items it considered (no matter
       whether they had content changes or not). For each item, it prefixes a single-letter flag that  indicates
       type and/or status of the item.

       If  you  are interested only in a subset of that output, you can give e.g.  <b>--filter=AME</b> and it will only
       show regular files with A, M or E status (see below).

       A uppercase character represents the status of a regular file relative to the "files" cache (not relative
       to the repo -- this is an issue if the files cache is not used). Metadata is stored in any case  and  for
       'A' and 'M' also new data chunks are stored. For 'U' all data chunks refer to already existing chunks.

       • 'A' = regular file, added (see also <u>a_status_oddity</u> in the FAQ)

       • 'M' = regular file, modified

       • 'U' = regular file, unchanged

       • 'C' = regular file, it changed while we backed it up

       • 'E' = regular file, an error happened while accessing/reading <u>this</u> file

       A  lowercase  character  means  a  file  type  other  than a regular file, borg usually just stores their
       metadata:

       • 'd' = directory

       • 'b' = block device

       • 'c' = char device

       • 'h' = regular file, hardlink (to already seen inodes)

       • 's' = symlink

       • 'f' = fifo

       Other flags used include:

       • 'i' = backup data was read from standard input (stdin)

       • '-' = dry run, item was <u>not</u> backed up

       • 'x' = excluded, item was <u>not</u> backed up

       • '?' = missing status code (if you see this, please file a bug report!)

   <b>Reading</b> <b>from</b> <b>stdin</b>
       There are two methods to read from stdin. Either specify <b>-</b> as path and pipe directly to borg:

          backup-vm --id myvm --stdout | borg create REPO::ARCHIVE -

       Or use <b>--content-from-command</b> to have Borg manage the execution of the command and piping. If you do  so,
       the  first  PATH  argument  is interpreted as command to execute and any further arguments are treated as
       arguments to the command:

          borg create --content-from-command REPO::ARCHIVE -- backup-vm --id myvm --stdout

       <b>--</b> is used to ensure <b>--id</b> and <b>--stdout</b> are <b>not</b> considered arguments to <b>borg</b> but rather <b>backup-vm</b>.

       The difference between the two approaches is that piping to borg creates an archive even if  the  command
       piping  to borg exits with a failure. In this case, <b>one</b> <b>can</b> <b>end</b> <b>up</b> <b>with</b> <b>truncated</b> <b>output</b> <b>being</b> <b>backed</b> <b>up</b>.
       Using <b>--content-from-command</b>, in contrast, borg is guaranteed to fail without creating an archive  should
       the command fail. The command is considered failed when it returned a non-zero exit code.

       Reading  from  stdin yields just a stream of data without file metadata associated with it, and the files
       cache is not needed at all. So it is safe to disable it via <b>--files-cache</b> <b>disabled</b> and  speed  up  backup
       creation a bit.

       By  default,  the content read from stdin is stored in a file called 'stdin'.  Use <b>--stdin-name</b> to change
       the name.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/borg-common.1.html">borg-common</a>(1)</u>, <u><a href="../man1/borg-delete.1.html">borg-delete</a>(1)</u>,  <u><a href="../man1/borg-prune.1.html">borg-prune</a>(1)</u>,  <u><a href="../man1/borg-check.1.html">borg-check</a>(1)</u>,  <u><a href="../man1/borg-patterns.1.html">borg-patterns</a>(1)</u>,  <u><a href="../man1/borg-placeholders.1.html">borg-placeholders</a>(1)</u>,
       <u><a href="../man1/borg-compression.1.html">borg-compression</a>(1)</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       The Borg Collective

                                                   2022-02-19                                     <u><a href="../man1/BORG-CREATE.1.html">BORG-CREATE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>