<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbdkit-evil-filter - add random data corruption to reads</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nbdkit">nbdkit_1.42.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nbdkit-evil-filter - add random data corruption to reads

</pre><h4><b>SYNOPSIS</b></h4><pre>
        nbdkit --filter=evil PLUGIN [PLUGIN-ARGS...]
               evil=[cosmic-rays|stuck-bits|stuck-wires]
               [evil-probability=PROB] [evil-stuck-probability=PROB]
               [evil-seed=SEED]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       nbdkit-evil-filter is a Byzantine filter for <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1) that randomly corrupts data when reading from the
       underlying plugin.  This can be used for testing filesystem checksums.  Note that it does not change
       write operations, so the underlying plugin contains the correct data.

       <b><a href="../man1/nbdkit-error-filter.1.html">nbdkit-error-filter</a></b>(1) is a related filter that injects hard errors into the NBD protocol.

       This filter has several modes, controlled using the "evil=..."  parameter.  These are:

       "evil=cosmic-rays"
           Bits  are  flipped  at random when reading data.  The probability that a bit is flipped is controlled
           using the "evil-probability" parameter, defaulting to 1e-8 (on average 1 in every  100  million  bits
           read is flipped).

       "evil=stuck-bits"
           This is the default mode.

           Fixed  bits  in  the  backing  file are stuck randomly high or low.  The "evil-probability" parameter
           controls the expected probability that a particular bit is stuck, defaulting in this mode to 1e-8  (1
           in  100  million).  "evil-stuck-probability" controls the probability that a stuck bit is read as its
           stuck value or its correct value, defaulting to 100% (always read as a stuck bit).

       "evil=stuck-wires"
           This is similar to "stuck-bits" but instead of simulating bad backing data, it simulates stuck  wires
           along  the  data path (eg. in a register).  The difference is that when reading, the stuck bit always
           happens at the same position in the packet of data being read, regardless of where on the  underlying
           disk  it is being read from.  "evil-probability" controls the probability of a stuck wire, defaulting
           in this mode to 1e-6 (1 in 1 million).  "evil-stuck-probability"  controls  the  probability  that  a
           stuck bit is read as its stuck value or its correct value, defaulting to 100% (always read as a stuck
           bit).

</pre><h4><b>EXAMPLES</b></h4><pre>
       Add some stuck bits to the backing file at random:

        nbdkit --filter=evil file disk.img

       Cosmic rays will flip (on average) one in every 100 million bits copied from the backing file over NBD:

        nbdkit --filter=evil file disk.img evil=cosmic-rays \
               --run 'nbdcopy $uri output.img'

</pre><h4><b>NOTES</b></h4><pre>
   <b>Extents</b>
       Plugins  can  be  sparse.   This filter only corrupts bits in non-sparse parts of the backing disk and it
       leaves sparse regions unchanged (which is realistic behaviour).  If  you  wish  to  use  this  filter  to
       corrupt sparse regions, then combine this filter with <b><a href="../man1/nbdkit-noextents-filter.1.html">nbdkit-noextents-filter</a></b>(1).  For example:

        nbdkit --filter=evil --filter=noextents memory 1G

   <b>Probability</b> <b>limited</b> <b>to</b> <b>[</b> <b>1e-12</b> <b>..</b> <b>1/8</b> <b>]</b>
       The  current  implementation limits probabilities to the range [ 1e-12 .. 1/8 ].  Values below this range
       are treated the same as 0%.  Values above this range are treated the same as 100%.

</pre><h4><b>PARAMETERS</b></h4><pre>
       <b>evil=cosmic-rays</b>
       <b>evil=stuck-bits</b>
       <b>evil=stuck-wires</b>
           Select the mode of evil.  See the "DESCRIPTION" above.  The default is "stuck-bits".

       <b>evil-probability=</b>N
       <b>evil-probability=</b>N<b>:</b>M
       <b>evil-probability=</b>N<b>%</b>
           Set the probability for the mode.  You can either use a floating point number between 0  and  1,  eg.
           "evil-probability=0.001"   or  "evil-probability=1e-6".   Or  you  can  write  it  as  N  in  M,  eg.
           "evil-probability=1:1000000"  or  "evil-probability=3.33:100000".   Or  you  can  write  this  as   a
           percentage, eg. "evil-probability=1%".

           The default probability depends on the mode.

       <b>evil-seed=</b>SEED
           To  make runs repeatable, use this to set a seed for the random number generator.  Note that runs are
           repeatable only if you use the same version of nbdkit, since in future we may change the algorithm.

           The default is to choose a seed at random.

       <b>evil-stuck-probability=</b>N
       <b>evil-stuck-probability=</b>N<b>:</b>M
       <b>evil-stuck-probability=</b>N<b>%</b>
           For the "stuck-*" modes, the probability that when reading a stuck bit you will read the stuck bit or
           the correct value.  This defaults to 1 (ie. 100%) which means the bit is always stuck.  Setting it to
           0.5 for example will mean that half the time the bit appears stuck and half  the  time  you  see  the
           correct value.

</pre><h4><b>FILES</b></h4><pre>
       <u>$filterdir/nbdkit-evil-filter.so</u>
           The filter.

           Use "nbdkit --dump-config" to find the location of $filterdir.

</pre><h4><b>VERSION</b></h4><pre>
       "nbdkit-evil-filter" first appeared in nbdkit 1.36.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1),  <b><a href="../man3/nbdkit-filter.3.html">nbdkit-filter</a></b>(3), <b><a href="../man1/nbdkit-delay-filter.1.html">nbdkit-delay-filter</a></b>(1), <b><a href="../man1/nbdkit-noextents-filter.1.html">nbdkit-noextents-filter</a></b>(1), <b><a href="../man1/nbdkit-error-filter.1.html">nbdkit-error-filter</a></b>(1),
       <b><a href="../man3/nbdkit_parse_probability.3.html">nbdkit_parse_probability</a></b>(3).

</pre><h4><b>AUTHORS</b></h4><pre>
       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       Redistribution and use in source and binary forms, with or without modification, are  permitted  provided
       that the following conditions are met:

       •   Redistributions  of  source  code must retain the above copyright notice, this list of conditions and
           the following disclaimer.

       •   Redistributions in binary form must reproduce the above copyright notice, this list of conditions and
           the following disclaimer in the documentation and/or other materials provided with the distribution.

       •   Neither the name of Red Hat nor the names of its contributors may  be  used  to  endorse  or  promote
           products derived from this software without specific prior written permission.

       THIS  SOFTWARE  IS  PROVIDED BY RED HAT AND CONTRIBUTORS ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
       INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND  FITNESS  FOR  A  PARTICULAR
       PURPOSE  ARE  DISCLAIMED.  IN  NO EVENT SHALL RED HAT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
       INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,  PROCUREMENT  OF
       SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
       ON  ANY  THEORY  OF  LIABILITY,  WHETHER  IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
       OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
       DAMAGE.

nbdkit-1.42.2                                      2025-04-02                              <u><a href="../man1/nbdkit-evil-filter.1.html">nbdkit-evil-filter</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>