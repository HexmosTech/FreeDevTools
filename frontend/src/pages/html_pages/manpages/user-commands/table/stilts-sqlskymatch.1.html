<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>stilts-sqlskymatch - Crossmatches table on sky position against SQL table</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/stilts">stilts_3.5.1-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       stilts-sqlskymatch - Crossmatches table on sky position against SQL table

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>stilts</b> <b>sqlskymatch</b> [ifmt=<u>&lt;in-format&gt;</u>] [istream=<u>true|false</u>] [in=<u>&lt;table&gt;</u>] [icmd=<u>&lt;cmds&gt;</u>] [ocmd=<u>&lt;cmds&gt;</u>]
                          [omode=<u>out|meta|stats|count|checksum|cgi|discard|topcat|samp|tosql|gui</u>] [out=<u>&lt;out-</u>
                          <u>table&gt;</u>] [ofmt=<u>&lt;out-format&gt;</u>] [ra=<u>&lt;expr&gt;</u>] [dec=<u>&lt;expr&gt;</u>] [sr=<u>&lt;expr/deg&gt;</u>]
                          [find=<u>best|all|each</u>] [usefoot=<u>true|false</u>] [footnside=<u>&lt;int-value&gt;</u>] [copycols=<u>&lt;colid-</u>
                          <u>list&gt;</u>] [scorecol=<u>&lt;col-name&gt;</u>] [erract=<u>abort|ignore|retry|retry&lt;n&gt;</u>] [ostream=<u>true|false</u>]
                          [fixcols=<u>none|dups|all</u>] [suffix0=<u>&lt;label&gt;</u>] [suffix1=<u>&lt;label&gt;</u>] [db=<u>&lt;jdbc-url&gt;</u>]
                          [user=<u>&lt;value&gt;</u>] [password=<u>&lt;value&gt;</u>] [dbtable=<u>&lt;table-name&gt;</u>] [dbra=<u>&lt;sql-col&gt;</u>] [dbdec=<u>&lt;sql-</u>
                          <u>col&gt;</u>] [dbunit=<u>deg|rad</u>] [tiling=<u>hpx&lt;K&gt;|healpixnest&lt;K&gt;|healpixring&lt;K&gt;|htm&lt;K&gt;</u>]
                          [dbtile=<u>&lt;sql-col&gt;</u>] [selectcols=<u>&lt;sql-cols&gt;</u>] [where=<u>&lt;sql-condition&gt;</u>]
                          [preparesql=<u>true|false</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>sqlskymatch</u>  resembles <u>coneskymatch</u>, but instead of sending an HTTP query to a remote cone search service
       for each match (i.e. each row of the input table), it executes an SQL query directly. The query is a  SE‐
       LECT  statement  with a WHERE clause which makes restrictions on Right Ascension and Declination columns;
       the names of these columns must be given as parameters. The effect is that of a spatial  join  between  a
       client-side table and a table stored in the database.

       This  command can only be used if you have access to an SQL database via JDBC. The details of how to con‐
       figure a JDBC connection to a database are discussed in SUN/256 - obviously you will need a  database  to
       connect to and appropriate read permissions on it as well as the relevant drivers.

       Note: this task was known as <u>sqlcone</u> in its experimental form in STILTS v1.3.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>ifmt=</b><u>&lt;in-format&gt;</u>
              Specifies the format of the input table as specified by parameter <u>in</u>. The known formats are listed
              in  SUN/256. This flag can be used if you know what format your table is in. If it has the special
              value <u>(auto)</u> (the default), then an attempt will be made to detect the format of the  table  auto‐
              matically.  This cannot always be done correctly however, in which case the program will exit with
              an error explaining which formats were attempted. This parameter is ignored  for  scheme-specified
              tables.

       <b>istream=</b><u>true|false</u>
              If  set true, the input table specified by the <u>in</u> parameter will be read as a stream. It is neces‐
              sary to give the <u>ifmt</u> parameter in this case. Depending on the required operations and  processing
              mode,  this  may  cause  the  read  to fail (sometimes it is necessary to read the table more than
              once). It is not normally necessary to set this flag; in most cases the data will be streamed  au‐
              tomatically  if that is the best thing to do. However it can sometimes result in less resource us‐
              age when processing large files in certain formats (such as VOTable). This  parameter  is  ignored
              for scheme-specified tables.

       <b>in=</b><u>&lt;table&gt;</u>
              The location of the input table. This may take one of the following forms:

                * A filename.

                * A URL.

                * The special value "<u>-</u>", meaning standard input. In this case the input format must be given ex‐
                  plicitly using the <u>ifmt</u> parameter. Note that not all formats can be streamed in this way.

                * A scheme specification of the form <u>:&lt;scheme-name&gt;:&lt;scheme-args&gt;</u>.

                * A  system command line with either a "<u>&lt;</u>" character at the start, or a "<u>|</u>" character at the end
                  ("<u>&lt;syscmd</u>" or "<u>syscmd|</u>"). This executes the given pipeline and reads from its standard output.
                  This will probably only work on unix-like systems.
               In any case, compressed data in one of the supported compression formats (gzip, Unix compress  or
              bzip2) will be decompressed transparently.

       <b>icmd=</b><u>&lt;cmds&gt;</u>
              Specifies  processing  to be performed on the input table as specified by parameter <u>in</u>, before any
              other processing has taken place. The value of this parameter is one or more of  the  filter  com‐
              mands described in SUN/256. If more than one is given, they must be separated by semicolon charac‐
              ters  (";").  This parameter can be repeated multiple times on the same command line to build up a
              list of processing steps. The sequence of commands  given  in  this  way  defines  the  processing
              pipeline which is performed on the table.

              Commands  may  alternatively  be  supplied in an external file, by using the indirection character
              '<u>@</u>'. Thus a value of "<u>@filename</u>" causes the file <u>filename</u> to be read for a list of filter commands
              to execute. The commands in the file may be separated by newline characters and/or semicolons, and
              lines which are blank or which start with a '<u>#</u>' character are ignored. A backslash character '<u>\fR'</u>
              <u>at</u> <u>the</u> <u>end</u> <u>of</u> <u>a</u> <u>line</u> <u>joins</u> <u>it</u> <u>with</u> <u>the</u> <u>following</u> <u>line.</u>

       <b>ocmd=</b><u>&lt;cmds&gt;</u>
              Specifies processing to be performed on the output table, after all  other  processing  has  taken
              place.  The value of this parameter is one or more of the filter commands described in SUN/256. If
              more than one is given, they must be separated by semicolon characters (";"). This  parameter  can
              be  repeated  multiple  times on the same command line to build up a list of processing steps. The
              sequence of commands given in this way defines the processing pipeline which is performed  on  the
              table.

              Commands  may  alternatively  be  supplied in an external file, by using the indirection character
              '<u>@</u>'. Thus a value of "<u>@filename</u>" causes the file <u>filename</u> to be read for a list of filter commands
              to execute. The commands in the file may be separated by newline characters and/or semicolons, and
              lines which are blank or which start with a '<u>#</u>' character are ignored. A backslash character '<u>\fR'</u>
              <u>at</u> <u>the</u> <u>end</u> <u>of</u> <u>a</u> <u>line</u> <u>joins</u> <u>it</u> <u>with</u> <u>the</u> <u>following</u> <u>line.</u>

       <b>omode=</b><u>out|meta|stats|count|checksum|cgi|discard|topcat|samp|tosql|gui</u>
              The mode in which the result table will be output. The default mode is <u>out</u>, which means  that  the
              result  will be written as a new table to disk or elsewhere, as determined by the <u>out</u> and <u>ofmt</u> pa‐
              rameters. However, there are other possibilities, which correspond to uses to which a table can be
              put other than outputting it, such as displaying metadata, calculating statistics, or populating a
              table in an SQL database. For some values of this parameter, additional  parameters  (<u>&lt;mode-args&gt;</u>)
              are required to determine the exact behaviour.

              Possible values are

                * <u>out</u>

                * <u>meta</u>

                * <u>stats</u>

                * <u>count</u>

                * <u>checksum</u>

                * <u>cgi</u>

                * <u>discard</u>

                * <u>topcat</u>

                * <u>samp</u>

                * <u>tosql</u>

                * <u>gui</u>
               Use the <u>help=omode</u> flag or see SUN/256 for more information.

       <b>out=</b><u>&lt;out-table&gt;</u>
              The  location  of  the output table. This is usually a filename to write to. If it is equal to the
              special value "-" (the default) the output table will be written to standard output.

              This parameter must only be given if <u>omode</u> has its default value of "<u>out</u>".

       <b>ofmt=</b><u>&lt;out-format&gt;</u>
              Specifies the format in which the output table will be written (one  of  the  ones  in  SUN/256  -
              matching  is  case-insensitive  and you can use just the first few letters). If it has the special
              value "<u>(auto)</u>" (the default), then the output filename will be examined to try to guess what  sort
              of  file  is  required  usually by looking at the extension. If it's not obvious from the filename
              what output format is intended, an error will result.

              This parameter must only be given if <u>omode</u> has its default value of "<u>out</u>".

       <b>ra=</b><u>&lt;expr&gt;</u>
              Right ascension in degrees in the coordinate system for the position of each row of the input  ta‐
              ble.  This  may  simply  be  a  column  name, or it may be an algebraic expression calculated from
              columns as explained in SUN/256. If left blank, an attempt is made  to  guess  from  UCDs,  column
              names and unit annotations what expression to use.

       <b>dec=</b><u>&lt;expr&gt;</u>
              Declination  in  degrees in the coordinate system for the position of each row of the input table.
              This may simply be a column name, or it may be an algebraic expression calculated from columns  as
              explained  in SUN/256. If left blank, an attempt is made to guess from UCDs, column names and unit
              annotations what expression to use.

       <b>sr=</b><u>&lt;expr/deg&gt;</u>
              Expression which evaluates to the search radius in degrees for the request at each row of the  in‐
              put table. This will often be a constant numerical value, but may be the name or ID of a column in
              the input table, or a function involving one.

       <b>find=</b><u>best|all|each</u>
              Determines which matches are retained.

                * <u>best</u>:  Only  the matching query table row closest to the input table row will be output. Input
                  table rows with no matches will be omitted. (Note this corresponds to the <u>best1</u> option in  the
                  pair matching commands, and <u>best1</u> is a permitted alias).

                * <u>all</u>:  All  query  table  rows which match the input table row will be output. Input table rows
                  with no matches will be omitted.

                * <u>each</u>: There will be one output table row for each input table row. If matches are  found,  the
                  closest  one from the query table will be output, and in the case of no matches, the query ta‐
                  ble columns will be blank.

       <b>usefoot=</b><u>true|false</u>
              Determines whether an attempt will be made to restrict searches in accordance with available foot‐
              print information. If this is set true, then before any of the per-row queries are  performed,  an
              attempt  may be made to acquire footprint information about the servce. If such information can be
              obtained, then queries which fall outside the footprint, and hence which are known to yield no re‐
              sults, are skipped. This can speed up the search considerably.

              Currently, the only footprints available are those provided by the CDS MOC  (Multi-Order  Coverage
              map) service, which covers VizieR and a few other cone search services.

       <b>footnside=</b><u>&lt;int-value&gt;</u>
              Determines the HEALPix Nside parameter for use with the MOC footprint service. This tuning parame‐
              ter determines the resolution of the footprint if available. Larger values give better resolution,
              hence  a  better  chance of avoiding unnecessary queries, but processing them takes longer and re‐
              trieving and storing them is more expensive.

              The value must be a power of 2, and at the time of writing, the MOC service will not supply  foot‐
              prints at resolutions greater than nside=512, so it should be &lt;=512.

              Only used if <u>usefoot=true</u>.

       <b>copycols=</b><u>&lt;colid-list&gt;</u>
              List of columns from the input table which are to be copied to the output table. Each column iden‐
              tified  here will be prepended to the columns of the combined output table, and its value for each
              row taken from the input table row which provided the parameters of the query which  produced  it.
              See SUN/256 for list syntax. The default setting is "<u>*</u>", which means that all columns from the in‐
              put table are included in the output.

       <b>scorecol=</b><u>&lt;col-name&gt;</u>
              Gives  the name of a column in the output table to contain the distance between the requested cen‐
              tral position and the actual position of the returned row. The distance  returned  is  an  angular
              distance  in  degrees. If a null value is chosen, no distance column will appear in the output ta‐
              ble.

       <b>erract=</b><u>abort|ignore|retry|retry&lt;n&gt;</u>
              Determines what will happen if any of the individual cone search requests fails.  By  default  the
              task  aborts.  That may be the best thing to do, but for unreliable or poorly implemented services
              you may find that some searches fail and others succeed so it can be best to continue operation in
              the face of a few failures. The options are:

                * <u>abort</u>: Failure of any query terminates the task.

                * <u>ignore</u>: Failure of a query is treated the same as a query which returns no rows.

                * <u>retry</u>: Failed queries are retried until they succeed; an increasing delay  is  introduced  for
                  each failure. Use with care - if the failure is for some good, or at least reproducible reason
                  this could prevent the task from ever completing.

                * <u>retry&lt;n&gt;</u>:  Failed queries are retried at most a fixed number <u>&lt;n&gt;</u> of times; an increasing delay
                  is introduced for each failure. If failures persist the task terminates.

       <b>ostream=</b><u>true|false</u>
              If set true, this will cause the operation to stream on output, so that the output table is  built
              up as the results are obtained from the cone search service. The disadvantage of this is that some
              output modes and formats need multiple passes through the data to work, so depending on the output
              destination,  the  operation may fail if this is set. Use with care (or be prepared for the opera‐
              tion to fail).

       <b>fixcols=</b><u>none|dups|all</u>
              Determines how input columns are renamed before use in the output table. The choices are:

                * <u>none</u>: columns are not renamed

                * <u>dups</u>: columns which would otherwise have duplicate names in the output will be renamed to  in‐
                  dicate which table they came from

                * <u>all</u>: all columns will be renamed to indicate which table they came from
               If columns are renamed, the new ones are determined by <u>suffix*</u> parameters.

       <b>suffix0=</b><u>&lt;label&gt;</u>
              If  the  <u>fixcols</u>  parameter is set so that input columns are renamed for insertion into the output
              table, this parameter determines how the renaming is done. It gives a suffix which is appended  to
              all renamed columns from the input table.

       <b>suffix1=</b><u>&lt;label&gt;</u>
              If  the  <u>fixcols</u>  parameter is set so that input columns are renamed for insertion into the output
              table, this parameter determines how the renaming is done. It gives a suffix which is appended  to
              all renamed columns from the cone result table.

       <b>db=</b><u>&lt;jdbc-url&gt;</u>
              URL which defines a connection to a database. This has the form <u>jdbc:&lt;subprotocol&gt;:&lt;subname&gt;</u> - the
              details are database- and driver-dependent. Consult Sun's JDBC documentation and that for the par‐
              ticular JDBC driver you are using for details. Note that the relevant driver class will need to be
              on your classpath and referenced in the <u>jdbc.drivers</u> system property as well for the connection to
              be made.

       <b>user=</b><u>&lt;value&gt;</u>
              User name for logging in to SQL database. Defaults to the current username.

       <b>password=</b><u>&lt;value&gt;</u>
              Password for logging in to SQL database.

       <b>dbtable=</b><u>&lt;table-name&gt;</u>
              The name of the table in the SQL database which provides the remote data.

       <b>dbra=</b><u>&lt;sql-col&gt;</u>
              The  name of a column in the SQL database table <u>dbtable</u> which gives the right ascension. Units are
              given by <u>dbunit</u>.

       <b>dbdec=</b><u>&lt;sql-col&gt;</u>
              The name of a column in the SQL database table <u>dbtable</u> which gives the declination. Units are giv‐
              en by <u>dbunit</u>.

       <b>dbunit=</b><u>deg|rad</u>
              Units of the right ascension and declination columns identified in the database table. May be  ei‐
              ther deg[rees] (the default) or rad[ians].

       <b>tiling=</b><u>hpx&lt;K&gt;|healpixnest&lt;K&gt;|healpixring&lt;K&gt;|htm&lt;K&gt;</u>
              Describes the sky tiling scheme that is in use. One of the following values may be used:

                * <u>hpxK</u>: alias for <u>healpixnestK</u>

                * <u>healpixnestK</u>: HEALPix using the Nest scheme at order <u>K</u>

                * <u>healpixringK</u>: HEALPix using the Ring scheme at order <u>K</u>

                * <u>htmK</u>: Hierarchical Triangular Mesh at level <u>K</u>
               So  for instance <u>hpx5</u> or <u>healpixnest5</u> would both indicate the HEALPix NEST tiling scheme at order
              5.

              At level K, there are 12*4^K HEALPix pixels, or 8*4^K HTM pixels  on  the  sky.  More  information
              about these tiling schemes can be found at the HEALPix and HTM web sites.

       <b>dbtile=</b><u>&lt;sql-col&gt;</u>
              The  name  of  a column in the SQL database table <u>dbtable</u> which contains a sky tiling pixel index.
              The tiling scheme is given by the tiling parameter. Use of a tiling column  is  optional,  but  if
              present  (and  if  the column is indexed in the database table) it may serve to speed up searches.
              Set to null if the database table contains no tiling column or if you do not wish to use one.

       <b>selectcols=</b><u>&lt;sql-cols&gt;</u>
              An SQL expression for the list of columns to be selected from the table in the database.  A  value
              of "<u>*</u>" retrieves all columns.

       <b>where=</b><u>&lt;sql-condition&gt;</u>
              An  SQL  expression  further limiting the rows to be selected from the database. This will be com‐
              bined with the constraints on position implied by the cone search centres and radii. The value  of
              this  parameter  should just be a condition, it should not contain the <u>WHERE</u> keyword. A null value
              indicates no additional criteria.

       <b>preparesql=</b><u>true|false</u>
              If true, the JDBC connection will use <u>PreparedStatement</u>s for the SQL SELECTs otherwise it will use
              simple <u>Statement</u>s. This is a tuning parameter and affects only performance. On some  database/dri‐
              ver combinations it's a lot faster set false (the default); on others it may be faster, who knows?

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/stilts.1.html">stilts</a></b>(1)

       If the package stilts-doc is installed, the full documentation <b>SUN/256</b> is available in HTML format:
       file:///usr/share/doc/stilts/sun256/index.html

</pre><h4><b>VERSION</b></h4><pre>
       STILTS version 3.5.1-debian

       This  is the Debian version of Stilts, which lack the support of some file formats and network protocols.
       For differences see
       file:///usr/share/doc/stilts/README.Debian

</pre><h4><b>AUTHOR</b></h4><pre>
       Mark Taylor (Bristol University)

                                                    Mar 2017                               <u><a href="../man1/STILTS-SQLSKYMATCH.1.html">STILTS-SQLSKYMATCH</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>