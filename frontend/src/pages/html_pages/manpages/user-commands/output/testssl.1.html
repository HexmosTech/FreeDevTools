<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>testssl</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/testssl.sh">testssl.sh_3.2~rc4+dfsg-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>testssl</b>

</pre><h4><b>NAME</b></h4><pre>
       testssl.sh -- check encryption of SSL/TLS servers

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>testssl.sh</b> <b>[OPTIONS]</b> <b>&lt;URI&gt;</b>, <b>testssl.sh</b> <b>[OPTIONS]</b> <b>--file</b> <b>&lt;FILE&gt;</b>

       or

       <b>testssl.sh</b> <b>[BANNER</b> <b>OPTIONS]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       testssl.sh  is  a  free  command line tool which checks a server's service on any port for the support of
       TLS/SSL ciphers, protocols as well as cryptographic flaws and much more.

       The output rates findings by color (screen) or severity (file output)  so  that  you  are  able  to  tell
       whether something is good or bad. The (screen) output has several sections in which classes of checks are
       being performed. To ease readability on the screen it aligns and indents the output properly.

       Only  you  see  the  result. You also can use it internally on your LAN. Except DNS lookups or unless you
       instruct testssl.sh to check for revocation of certificates it doesn't use any other hosts or even  third
       parties for any test.

</pre><h4><b>REQUIREMENTS</b></h4><pre>
       Testssl.sh  is  out  of  the  box  portable:  it  runs  under  any Unix-like stack: Linux, *BSD, MacOS X,
       WSL=Windows Subsystem for Linux, Cygwin and MSYS2. <b>bash</b> is  a  prerequisite,  also  version  3  is  still
       supported.  Standard utilities like awk, sed, tr and head are also needed. This can be of a BSD, System 5
       or GNU flavor whereas grep from System V is not yet supported.

       Any OpenSSL or LibreSSL version is needed as a helper. Unlike  previous  versions  of  testssl.sh  almost
       every check is done via (TCP) sockets. In addition statically linked OpenSSL binaries for major operating
       systems are supplied in <b>.<a href="file:/bin/">/bin/</a></b>.

</pre><h4><b>GENERAL</b></h4><pre>
       <b>testssl.sh</b> <b>URI</b> as the default invocation does the so-called default run which does a number of checks and
       puts  out the results colorized (ANSI and termcap) on the screen. It does every check listed below except
       <b>-E</b> which are (order of appearance):

       0) displays a banner (see below), does a DNS lookup also for  further  IP  addresses  and  does  for  the
       returned IP address a reverse lookup. Last but not least a service check is being done.

       1) SSL/TLS protocol check

       2) standard cipher categories

       3) server's cipher preferences (server order?)

       4) forward secrecy: ciphers and elliptical curves

       5) server defaults (certificate info, TLS extensions, session information)

       6) HTTP header (if HTTP detected or being forced via <b>--assume-http</b>)

       7) vulnerabilities

       8) testing each of 370 preconfigured ciphers

       9) client simulation

       10) rating

</pre><h4><b>OPTIONS</b> <b>AND</b> <b>PARAMETERS</b></h4><pre>
       Options  are  either short or long options. Any long or short option requiring a value can be called with
       or without an equal sign. E.g. <b>testssl.sh</b> <b>-t=smtp</b> <b>--wide</b> <b>--openssl=<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?openssl">/usr/bin/openssl</a></b> <b>&lt;URI&gt;</b> (short  options
       with  equal  sign)  is  equivalent  to <b>testssl.sh</b> <b>--starttls</b> <b>smtp</b> <b>--wide</b> <b>--openssl</b> <b><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?openssl">/usr/bin/openssl</a></b> <b>&lt;URI&gt;</b>
       (long option without equal sign). Some command line  options  can  also  be  preset  via  ENV  variables.
       <b>WIDE=true</b>  <b>OPENSSL=<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?openssl">/usr/bin/openssl</a></b>  <b>testssl.sh</b>  <b>--starttls=smtp</b>  <b>&lt;URI&gt;</b>  would  be  the equivalent to the
       aforementioned examples. Preference has the command line over any environment variables.

       <b>&lt;URI&gt;</b> or <b>--file</b> <b>&lt;FILE&gt;</b> always needs to be the last parameter.

   <b>BANNER</b> <b>OPTIONS</b> <b>(standalone)</b>
       <b>--help</b> (or no arg) displays command line help

       <b>-b,</b> <b>--banner</b> displays testssl.sh banner, including license,  usage  conditions,  version  of  testssl.sh,
       detected openssl version, its path to it, # of ciphers of openssl, its build date and the architecture.

       <b>-v,</b> <b>--version</b> same as before

       <b>-V</b> <b>[pattern],</b> <b>--local</b> <b>[pattern]</b> pretty print all local ciphers supported by openssl version. If a pattern
       is  supplied  it  performs  a  match (ignore case) on any of the strings supplied in the wide output, see
       below. The pattern will be searched in the any of the columns: hexcode, cipher  suite  name  (OpenSSL  or
       IANA),  key  exchange,  encryption, bits. It does a word pattern match for non-numbers, for number just a
       normal match applies. Numbers here are defined as [0-9,A-F].  This  means  (attention:  catch)  that  the
       pattern    CBC    is   matched   as   non-word,   but   AES   as   word.   This   option   also   accepts
       <b>--openssl=&lt;path_to_openssl&gt;</b>.

   <b>INPUT</b> <b>PARAMETERS</b>
       <b>URI</b> can be a hostname, an IPv4 or IPv6 address (restriction see below) or an URL. IPv6 addresses need  to
       be  in square brackets. For any given parameter port 443 is assumed unless specified by appending a colon
       and a port number. The only preceding protocol specifier allowed is <b>https</b>. You  need  to  be  aware  that
       checks  for  an  IP  address  might  not  hit the vhost you want. DNS resolution (A/AAAA record) is being
       performed unless you have an <b><a href="file:/etc/hosts">/etc/hosts</a></b> entry for the hostname.

       <b>--file</b> <b>&lt;fname&gt;</b> or the equivalent <b>-iL</b> <b>&lt;fname&gt;</b> are mass testing options. Per default it implicitly turns on
       <b>--warnings</b> <b>batch</b> unless warnings has been set to off before. In its first incarnation  the  mass  testing
       option reads command lines from <b>fname</b>. <b>fname</b> consists of command lines of testssl, one line per instance.
       Comments  after <b>#</b> are ignored, <b>EOF</b> signals the end of fname any subsequent lines will be ignored too. You
       can also supply additional options which will be inherited to each child, e.g. When  invoking  <b>testssl.sh</b>
       <b>--wide</b>  <b>--log</b>  <b>--file</b>  <b>&lt;fname&gt;</b>  .  Each  single  line  in  <b>fname</b>  is  parsed upon execution. If there's a
       conflicting option and serial mass testing option is being performed the check will  be  aborted  at  the
       time  it  occurs  and  depending on the output option potentially leaving you with an output file without
       footer. In parallel mode the mileage varies, likely a line won't be scanned.

       Alternatively <b>fname</b> can be in <b>nmap</b>'s grep(p)able output format (<b>-oG</b>). Only open ports will be considered.
       Multiple ports per line are allowed. The ports  can  be  different  and  will  be  tested  by  testssl.sh
       according  to  common  practice  in  the  internet,  i.e.  if  nmap  shows in its output an open port 25,
       automatically <b>-t</b> <b>smtp</b> will be added before the URI whereas port 465 will be treated as  a  plain  TLS/SSL
       port,  not  requiring  an  STARTTLS  SMTP  handshake  upfront.  This  is  done by an internal table which
       correlates nmap's open port detected to the STARTTLS/plain text decision from testssl.sh.

       Nmap's output always returns IP addresses and only if there's a PTR DNS record available a  hostname.  As
       it  is  not  checked by nmap whether the hostname matches the IP (A or AAAA record), testssl.sh does this
       automatically for you. If the A record of the hostname matches the IP address, the hostname is  used  and
       not  the  IP  address.  Please keep in mind that checks against an IP address might not hit the vhost you
       maybe were aiming at and thus it may lead to different results.

       A typical internal conversion to testssl.sh file format from nmap's grep(p)able format could look like:

       <b>10.10.12.16:443</b> <b>10.10.12.16:1443</b> <b>-t</b> <b>smtp</b> <b>host.example.com:25</b> <b>host.example.com:443</b> <b>host.example.com:631</b> <b>-t</b>
       <b>ftp</b> <b>10.10.12.11:21</b> <b>10.10.12.11:8443</b> Please note that <b>fname</b> has to be in Unix format. DOS carriage returns
       won't be accepted. Instead of the command line switch the environment variable FNAME will be honored too.

       <b>--mode</b> <b>&lt;serial|parallel&gt;</b>. Mass testing to be done serial (default) or parallel  (<b>--parallel</b>  is  shortcut
       for  the  latter, <b>--serial</b> is the opposite option). Per default mass testing is being run in serial mode,
       i.e. one line after the other is processed and invoked. The variable <b>MASS_TESTING_MODE</b> can be defined  to
       be either equal <b>serial</b> or <b>parallel</b>.

       <b>--warnings</b>  <b>&lt;batch|off&gt;</b>. The warnings parameter determines how testssl.sh will deal with situations where
       user input normally will be necessary. There are  two  options.  <b>batch</b>  doesn't  wait  for  a  confirming
       keypress  when  a  client-  or  server-side problem is encountered. As of 3.0 it just then terminates the
       particular scan. This is automatically chosen for mass testing (<b>--file</b>). <b>off</b> just skips the warning,  the
       confirmation  but  continues  the scan, independent whether it makes sense or not. Please note that there
       are conflicts where testssl.sh will still ask for confirmation which are the ones which  otherwise  would
       have  a  drastic  impact  on  the results. Almost any other decision will be made in the future as a best
       guess by testssl.sh. The same can be achieved by setting the environment variable <b>WARNINGS</b>.

       <b>--connect-timeout</b> <b>&lt;seconds&gt;</b> This is useful for socket TCP connections to a node. If  the  node  does  not
       complete  a  TCP  handshake  (e.g. because it is down or behind a firewall or there's an IDS or a tarpit)
       testssl.sh may usually hang for around 2 minutes or even much more. This parameter  instructs  testssl.sh
       to wait at most <b>seconds</b> for the handshake to complete before giving up. This option only works if your OS
       has a timeout binary installed. CONNECT_TIMEOUT is the corresponding environment variable.

       <b>--openssl-timeout</b>  <b>&lt;seconds&gt;</b>  This  is  especially  useful for all connects using openssl and practically
       useful for mass testing. It avoids the openssl connect to hang for ~2  minutes.  The  expected  parameter
       <b>seconds</b>  instructs  testssl.sh  to wait before the openssl connect will be terminated. The option is only
       available if your OS has a timeout binary installed. As there are different implementations  of  <b>timeout</b>:
       It  automatically  calls  the  binary  with  the  right  parameters.  OPENSSL_TIMEOUT  is  the equivalent
       environment variable.

       <b>--basicauth</b> <b>&lt;user:pass&gt;</b> This can be set to provide HTTP basic auth  credentials  which  are  used  during
       checks for security headers. BASICAUTH is the ENV variable you can use instead.

       <b>--reqheader</b>  <b>&lt;header&gt;</b>  This  can  be  used  to  add additional HTTP request headers in the correct format
       <b>Headername:</b> <b>headercontent</b>. This parameter  can  be  called  multiple  times  if  required.  For  example:
       <b>--reqheader</b>   <b>'Proxy-Authorization:</b>   <b>Basic</b>  <b>dGVzdHNzbDpydWxlcw=='</b>  <b>--reqheader</b>  <b>'ClientID:</b>  <b>0xDEADBEAF'</b>.
       REQHEADER is the corresponding environment variable.

   <b>SPECIAL</b> <b>INVOCATIONS</b>
       <b>-t</b> <b>&lt;protocol&gt;,</b> <b>--starttls</b> <b>&lt;protocol&gt;</b> does a default run against a  STARTTLS  enabled  <b>protocol</b>.  <b>protocol</b>
       must  be one of <b>ftp</b>, <b>smtp</b>, <b>pop3</b>, <b>imap</b>, <b>xmpp</b>, <b>sieve</b>, <b>xmpp-server</b>, <b>telnet</b>, <b>ldap</b>, <b>irc</b>, <b>lmtp</b>, <b>nntp</b>, <b>postgres</b>,
       <b>mysql</b>. For the latter four you need e.g. the supplied OpenSSL or  OpenSSL  version  1.1.1.  Please  note:
       MongoDB doesn't offer a STARTTLS connection, IRC currently only works with <b>--ssl-native</b>. <b>irc</b> is WIP.

       <b>--xmpphost</b>  <b>&lt;jabber_domain&gt;</b>  is  an  additional  option  for STARTTLS enabled XMPP: It expects the jabber
       domain as a parameter. This is only needed if the domain is different from the URI supplied.

       <b>--mx</b> <b>&lt;domain|host&gt;</b> tests all MX records (STARTTLS on port 25) from high to low priority,  one  after  the
       other.

       <b>--ip</b>  <b>&lt;ip&gt;</b>  tests  either  the  supplied IPv4 or IPv6 address instead of resolving host(s) in <b>&lt;URI&gt;</b>. IPv6
       addresses need to be supplied in square brackets. <b>--ip=one</b> means:  just  test  the  first  A  record  DNS
       returns  (useful  for  multiple  IPs).  If  <b>-6</b> and <b>--ip=one</b> was supplied an AAAA record will be picked if
       available. The <b>--ip</b> option might be also useful if you  want  to  resolve  the  supplied  hostname  to  a
       different  IP,  similar  as  if  you  would  edit  <b><a href="file:/etc/hosts">/etc/hosts</a></b>  or  <b>/c/Windows/System32/drivers/etc/hosts</b>.
       <b>--ip=proxy</b> tries a DNS resolution via proxy. <b>--ip=proxy</b> plus <b>--nodns=min</b> is useful for situations with no
       local DNS as there'll be no DNS timeouts when trying to resolve CAA, TXT and MX records.

       <b>--proxy</b> <b>&lt;host&gt;:&lt;port&gt;</b> does ANY check via the specified proxy. <b>--proxy=auto</b>  inherits  the  proxy  setting
       from  the  environment.  The hostname supplied will be resolved to the first A record. In addition if you
       want lookups via proxy you can specify <b>DNS_VIA_PROXY=true</b>. OCSP revocation checking (<b>-S</b>  <b>--phone-out</b>)  is
       not  supported  by  OpenSSL  via proxy. As supplying a proxy is an indicator for port 80 and 443 outgoing
       being blocked in your network an OCSP revocation check won't be performed. However if <b>IGN_OCSP_PROXY=true</b>
       has been supplied it will be tried directly. Authentication to the proxy is not supported.  Proxying  via
       IPv6 addresses is not possible, no HTTPS or SOCKS proxy is supported.

       <b>-6</b>  does  (also)  IPv6  checks.  Please  note  that  testssl.sh doesn't perform checks on an IPv6 address
       automatically, because of two reasons: testssl.sh does no connectivity checks  for  IPv6  and  it  cannot
       determine  reliably whether the OpenSSL binary you're using has IPv6 s_client support. <b>-6</b> assumes both is
       the case. If both conditions are met and you in general prefer to test for IPv6 branches as well you  can
       add  <b>HAS_IPv6</b>  to  your shell environment. Besides the OpenSSL binary supplied IPv6 is known to work with
       vanilla OpenSSL &gt;= 1.1.0 and older versions &gt;=1.0.2 in RHEL/CentOS/FC and Gentoo.

       <b>--ssl-native</b> Instead of using a mixture of bash sockets and a few openssl s_client  connects,  testssl.sh
       uses  the  latter  (almost)  only.  This is faster but provides less accurate results, especially for the
       client simulation and for cipher support. For all checks you will see a warning if testssl.sh cannot tell
       if a particular check cannot be performed. For some  checks  however  you  might  end  up  getting  false
       negatives  without  a  warning.  Thus  it is not recommended to use. It should only be used if you prefer
       speed over accuracy or you know that your target has sufficient overlap with  the  protocols  and  cipher
       provided by your openssl binary.

       <b>--openssl</b>  <b>&lt;path_to_openssl&gt;</b>  testssl.sh tries very hard to find automagically the binary supplied (where
       the tree of testssl.sh resides, from the directory where testssl.sh has been started from, etc.). If  all
       that  doesn't  work it falls back to openssl supplied from the OS (<b>$PATH</b>). With this option you can point
       testssl.sh to your binary of choice  and  override  any  internal  magic  to  find  the  openssl  binary.
       (Environment preset via <b>OPENSSL=&lt;path_to_openssl&gt;</b>).

   <b>TUNING</b> <b>OPTIONS</b>
       <b>--bugs</b>  does  some workarounds for buggy servers like padding for old F5 devices. The option is passed as
       <b>-bug</b> to openssl when needed, see <b><a href="../man1/s_client.1.html">s_client</a>(1)</b>, environment preset via  <b>BUGS="-bugs"</b>  (1x  dash).  For  the
       socket part testssl.sh has always workarounds in place to cope with broken server implementations.

       <b>--assuming-http</b>  testssl.sh  normally does upfront an application protocol detection. In cases where HTTP
       cannot be automatically detected you may want to use this option. It enforces testssl.sh not to skip HTTP
       specific tests (HTTP header) and to run a browser based client simulation.  Please  note  that  sometimes
       also the severity depends on the application protocol, e.g. SHA1 signed certificates, the lack of any SAN
       matches  and some vulnerabilities will be punished harder when checking a web server as opposed to a mail
       server.

       <b>-n,</b> <b>--nodns</b> <b>&lt;min|none&gt;</b> tells testssl.sh which DNS lookups should be performed. <b>min</b> uses only forward  DNS
       resolution  (A  and  AAAA  record or MX record) and skips CAA lookups and PTR records from the IP address
       back to a DNS name. <b>none</b> performs no DNS lookups at all. For the latter you either have to supply the  IP
       address  as  a  target,  to  use <b>--ip</b> or have the IP address in <b><a href="file:/etc/hosts">/etc/hosts</a></b>. The use of the switch is only
       useful if you either can't or are not willing to perform DNS lookups. The latter can apply e.g.  to  some
       pentests.  In  general  this  option  could  e.g. help you to avoid timeouts by DNS lookups. <b>NODNS</b> is the
       environment variable for this. <b>--nodns=min</b> plus <b>--ip=proxy</b> is useful for situations with no local DNS  as
       there'll be no DNS timeouts when trying to resolve CAA, TXT and MX records.

       <b>--sneaky</b>  For  HTTP header checks testssl.sh uses normally the server friendly HTTP user agent <b>TLS</b> <b>tester</b>
       <b>from</b> <b>${URL}</b>. With this option your traces are less verbose and a Firefox user agent  is  being  used.  Be
       aware  that  it  doesn't  hide  your  activities.  That  is  just  not  possible  (environment preset via
       <b>SNEAKY=true</b>).

       <b>--user-agent</b> <b>&lt;user</b> <b>agent&gt;</b> tells testssl.sh to use the supplied HTTP user agent instead  of  the  standard
       user agent <b>TLS</b> <b>tester</b> <b>from</b> <b>${URL}</b>.

       <b>--ids-friendly</b>  is  a  switch which may help to get a scan finished which otherwise would be blocked by a
       server side IDS. This switch skips tests for the following vulnerabilities:  Heartbleed,  CCS  Injection,
       Ticketbleed  and  ROBOT.  The  environment  variable OFFENSIVE set to false will achieve the same result.
       Please be advised that as an alternative or as a general approach you can try to apply evasion techniques
       by changing the variables USLEEP_SND and / or USLEEP_REC and maybe MAX_WAITSOCK.

       <b>--phone-out</b> Checking for revoked certificates via CRL and OCSP is  not  done  per  default.  This  switch
       instructs testssl.sh to query external -- in a sense of the current run -- URIs. By using this switch you
       acknowledge  that  the  check  might  have privacy issues, a download of several megabytes (CRL file) may
       happen and there may be network connectivity problems while  contacting  the  endpoint  which  testssl.sh
       doesn't  handle. PHONE_OUT is the environment variable for this which needs to be set to true if you want
       this.

       <b>--add-ca</b> <b>&lt;CAfile&gt;</b> enables you to add your own CA(s) in PEM format for trust chain checks. <b>CAfile</b> can be a
       directory containing files with a .pem extension, a single file or multiple files as  a  comma  separated
       list  of  root  CAs. Internally they will be added during runtime to all CA stores. This is (only) useful
       for internal hosts whose certificates are issued by internal CAs.  Alternatively  ADDTL_CA_FILES  is  the
       environment variable for this.

   <b>SINGLE</b> <b>CHECK</b> <b>OPTIONS</b>
       Any  single  check  switch  supplied as an argument prevents testssl.sh from doing a default run. It just
       takes this and if supplied other options and runs them - in the order  they  would  also  appear  in  the
       default run.

       <b>-e,</b> <b>--each-cipher</b> checks each of the (currently configured) 370 ciphers via openssl + sockets remotely on
       the  server  and reports back the result in wide mode. If you want to display each cipher tested you need
       to add <b>--show-each</b>. Per default it lists the following parameters: <b>hexcode</b>, <b>OpenSSL</b>  <b>cipher</b>  <b>suite</b>  <b>name</b>,
       <b>key</b>  <b>exchange</b>,  <b>encryption</b>  <b>bits</b>, <b>IANA/RFC</b> <b>cipher</b> <b>suite</b> <b>name</b>. Please note the <b>--mapping</b> parameter changes
       what cipher suite names you will see here and at which position. Also please note that the <b>bit</b> length for
       the encryption is shown and not the <b>security</b> length, albeit it'll be sorted by the latter. For  3DES  due
       to  the  Meet-in-the-Middle  problem  the  bit size of 168 bits is equivalent to the security size of 112
       bits.

       <b>-E,</b> <b>--cipher-per-proto</b> is similar to <b>-e,</b> <b>--each-cipher</b>. It checks each of the possible ciphers, here: per
       protocol. If you want to display each cipher tested you need to add <b>--show-each</b>. The output is sorted  by
       security strength, it lists the encryption bits though.

       <b>-s,</b> <b>--std,</b> <b>--categories</b> tests certain lists of cipher suites / cipher categories by strength. (<b>--standard</b>
       is deprecated.) Those lists are (<b>openssl</b> <b>ciphers</b> <b>$LIST</b>, $LIST from below:)

       ○   <b>NULL</b> <b>encryption</b> <b>ciphers</b>: 'NULL:eNULL'

       ○   <b>Anonymous</b> <b>NULL</b> <b>ciphers</b>: 'aNULL:ADH'

       ○   <b>Export</b> <b>ciphers</b> (w/o the preceding ones): 'EXPORT:!ADH:!NULL'

       ○   <b>LOW</b>        (64        Bit       +       DES       ciphers,       without       EXPORT       ciphers):
           'LOW:DES:RC2:RC4:MD5:!ADH:!EXP:!NULL:!eNULL:!AECDH'

       ○   <b>3DES</b> <b>+</b> <b>IDEA</b> <b>ciphers</b>: '3DES:IDEA:!aNULL:!ADH:!MD5'

       ○   <b>Obsoleted</b>                                        <b>CBC</b>                                         <b>ciphers</b>:
           'HIGH:MEDIUM:AES:CAMELLIA:ARIA:!IDEA:!CHACHA20:!3DES:!RC2:!RC4:!AESCCM8:!AESCCM:!AESGCM:!ARIAGCM:!aNULL:!MD5'

       ○   <b>Strong</b>               <b>ciphers</b>               <b>with</b>               <b>no</b>              <b>FS</b>              (AEAD):
           'AESGCM:CHACHA20:CamelliaGCM:AESCCM:ARIAGCM:!kEECDH:!kEDH:!kDHE:!kDHEPSK:!kECDHEPSK:!aNULL'

       ○   <b>Forward</b>                <b>Secrecy</b>                 <b>strong</b>                 <b>ciphers</b>                 (AEAD):
           'AESGCM:CHACHA20:CamelliaGCM:AESCCM:ARIAGCM:!kPSK:!kRSAPSK:!kRSA:!kDH:!kECDH:!aNULL'

       <b>-f,</b>  <b>--fs,</b>  <b>--nsa,</b>  <b>--forward-secrecy</b>  Checks  robust  forward  secrecy key exchange. "Robust" means that
       ciphers having intrinsic severe weaknesses like Null Authentication or Encryption, 3DES and RC4 won't  be
       considered here. There shouldn't be the wrong impression that a secure key exchange has been taking place
       and  everything  is  fine  when  in  reality  the encryption sucks. Also this section lists the available
       elliptical curves and Diffie Hellman groups, as well as FFDHE groups (TLS 1.2 and TLS 1.3).

       <b>-p,</b> <b>--protocols</b> checks TLS/SSL protocols SSLv2, SSLv3, TLS 1.0 through TLS 1.3 and for HTTP:  SPDY  (NPN)
       and ALPN, a.k.a. HTTP/2. For TLS 1.3 several drafts (from 18 on) and final are supported and being tested
       for.  Note  the  supplied  openssl-bad version doesn't support TLS 1.3 . As the check for TLS 1.3 will be
       done in sockets this normally does not pose a problem. However if a TLS-1.3-only host is encountered  and
       to  have  a  complete test coverage (e.g. header checks) <b><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?openssl">/usr/bin/openssl</a></b> (or the content of <b>OPENSSL2</b>) is
       checked for existence and support of TLS 1.3 and if those tests succeeded it will  be  switched  to  this
       binary. A message will notify you.

       <b>-P,</b>  <b>--server-preference,</b>  <b>--preference</b> displays the servers preferences: cipher order, with used openssl
       client: negotiated protocol and cipher. If there's a cipher order enforced by the server it  displays  it
       for  each  protocol  (openssl+sockets). If there's not, it displays instead which ciphers from the server
       were picked with each protocol.

       <b>-S,</b> <b>--server_defaults</b> displays information from the server hello(s):

       ○   Available TLS extensions,

       ○   TLS ticket + session ID information/capabilities,

       ○   session resumption capabilities,

       ○   Time skew relative to localhost (most server implementations return random values).

       ○   Several certificate information

       ○   signature algorithm,

       ○   key size,

       ○   key usage and extended key usage,

       ○   fingerprints and serial

       ○   Common Name (CN), Subject Alternative Name (SAN), Issuer,

       ○   Trust via hostname + chain of trust against supplied certificates

       ○   EV certificate detection

       ○   experimental "eTLS" detection

       ○   validity: start + end time, how many days to go (warning for certificate lifetime &gt;=5 years)

       ○   revocation info (CRL, OCSP, OCSP stapling + must staple). When <b>--phone-out</b> supplied it checks against
           the certificate issuer whether the host certificate has been revoked (plain OCSP, CRL).

       ○   displaying DNS Certification Authority Authorization resource record

       ○   Certificate Transparency info (if provided by server).

       For the trust chain check 5 certificate stores are provided. If the test against one of the trust  stores
       failed,  the  one  is being identified and the reason for the failure is displayed - in addition the ones
       which succeeded are displayed too. You can configure your own CA via ADDTL_CA_FILES,  see  section  <b>FILES</b>
       below.  If  the  server  provides no matching record in Subject Alternative Name (SAN) but in Common Name
       (CN), it will be indicated as this is deprecated. Also for multiple server certificates are being checked
       for as well as for the certificate reply to a non-SNI (Server Name Indication) client  hello  to  the  IP
       address.  Regarding  the  TLS  clock  skew: it displays the time difference to the client. Only a few TLS
       stacks nowadays still support this and return the local clock <b>gmt_unix_time</b>, e.g. IIS, openssl &lt;  1.0.1f.
       In addition to the HTTP date you could e.g. derive that there are different hosts where your TLS and your
       HTTP request ended -- if the time deltas differ significantly.

       <b>-x</b>  <b>&lt;pattern&gt;,</b>  <b>--single-cipher</b> <b>&lt;pattern&gt;</b> tests matched <b>pattern</b> of ciphers against a server. Patterns are
       similar to <b>-V</b> <b>pattern</b> <b>,</b> <b>--local</b> <b>pattern</b>, see above about matching.

       <b>-h,</b> <b>--header,</b> <b>--headers</b> if the service is HTTP (either by detection or by enforcing via <b>--assume-http</b>. It
       tests several HTTP headers like

       ○   HTTP Strict Transport Security (HSTS)

       ○   HTTP Public Key Pinning (HPKP)

       ○   Server banner

       ○   HTTP date+time

       ○   Server banner like Linux or other Unix vendor headers

       ○   Application banner (PHP, RoR, OWA, SharePoint, Wordpress, etc)

       ○   Reverse proxy headers

       ○   Web server modules

       ○   IPv4 address in header

       ○   Cookie (including Secure/HTTPOnly flags)

       ○   Decodes BIG IP F5 non-encrypted cookies

       ○   Security headers (X-Frame-Options, X-XSS-Protection, Expect-CT,... , CSP headers).  Nonsense  is  not
           yet detected here.

       <b>-c,</b>  <b>--client-simulation</b>  This  simulates  a  handshake with a number of standard clients so that you can
       figure out which client cannot or can connect to your site. For the latter case the protocol, cipher  and
       curve  is displayed, also if there's Forward Secrecy. testssl.sh uses a handselected set of clients which
       are retrieved by the SSLlabs API. The output is aligned in columns when combined with the <b>--wide</b>  option.
       If you want the full nine yards of clients displayed use the environment variable ALL_CLIENTS.

       <b>-g,</b> <b>--grease</b> checks several server implementation bugs like tolerance to size limitations and GREASE, see
       RFC 8701. This check doesn't run per default.

   <b>VULNERABILITIES</b>
       <b>-U,</b>  <b>--vulnerable,</b>  <b>--vulnerabilities</b>  Just tests all (of the following) vulnerabilities. The environment
       variable <b>VULN_THRESHLD</b> determines after which value a separate headline for each vulnerability  is  being
       displayed.  Default  is <b>1</b> which means if you check for two vulnerabilities, only the general headline for
       vulnerabilities section is displayed -- in addition to the vulnerability and the result.  Otherwise  each
       vulnerability or vulnerability section gets its own headline in addition to the output of the name of the
       vulnerability  and  test  result.  A  vulnerability section is comprised of more than one check, e.g. the
       renegotiation vulnerability check has two checks, so has Logjam.

       <b>-H,</b> <b>--heartbleed</b> Checks for Heartbleed, a memory leakage in  openssl.  Unless  the  server  side  doesn't
       support the heartbeat extension it is likely that this check runs into a timeout. The seconds to wait for
       a reply can be adjusted with <b>HEARTBLEED_MAX_WAITSOCK</b>. 8 is the default.

       <b>-I,</b>  <b>--ccs,</b>  <b>--ccs-injection</b>  Checks  for CCS Injection which is an openssl vulnerability. Sometimes also
       here the check needs to wait for a reply. The predefined timeout of 5 seconds can  be  changed  with  the
       environment variable <b>CCS_MAX_WAITSOCK</b>.

       <b>-T,</b> <b>--ticketbleed</b> Checks for Ticketbleed memory leakage in BigIP loadbalancers.

       <b>--BB,</b> <b>--robot</b> Checks for vulnerability to ROBOT / (<u>Return</u> <u>Of</u> <u>Bleichenbacher's</u> <u>Oracle</u> <u>Threat</u>) attack.

       <b>--SI,</b>  <b>--starttls-injection</b>  Checks for STARTTLS injection vulnerabilities (SMTP, IMAP, POP3 only). <b>socat</b>
       and OpenSSL &gt;=1.1.0 is needed.

       <b>-R,</b>  <b>--renegotiation</b>  Tests  renegotiation  vulnerabilities.  Currently  there's  a  check   for   <u>Secure</u>
       <u>Renegotiation</u>  and  for <u>Secure</u> <u>Client-Initiated</u> <u>Renegotiation</u>. Please be aware that vulnerable servers to
       the latter can likely be DoSed very easily (HTTP). A check for <u>Insecure</u> <u>Client-Initiated</u> <u>Renegotiation</u> is
       not yet implemented.

       <b>-C,</b> <b>--compression,</b> <b>--crime</b> Checks for CRIME (<u>Compression</u> <u>Ratio</u> <u>Info-leak</u> <u>Made</u> <u>Easy</u>) vulnerability in TLS.
       CRIME in SPDY is not yet being checked for.

       <b>-B,</b> <b>--breach</b> Checks for BREACH (<u>Browser</u> <u>Reconnaissance</u>  <u>and</u>  <u>Exfiltration</u>  <u>via</u>  <u>Adaptive</u>  <u>Compression</u>  <u>of</u>
       <u>Hypertext</u>) vulnerability. As for this vulnerability HTTP level compression is a prerequisite it'll be not
       tested  if  HTTP  cannot be detected or the detection is not enforced via <b>--assume-http</b>. Please note that
       only the URL supplied (normally "/" ) is being tested.

       <b>-O,</b> <b>--poodle</b> Tests for SSL POODLE (<u>Padding</u> <u>Oracle</u> <u>On</u>  <u>Downgraded</u>  <u>Legacy</u>  <u>Encryption</u>)  vulnerability.  It
       basically checks for the existence of CBC ciphers in SSLv3.

       <b>-Z,</b>  <b>--tls-fallback</b>  Checks  TLS_FALLBACK_SCSV  mitigation.  TLS_FALLBACK_SCSV is basically a ciphersuite
       appended to the Client Hello trying to prevent protocol downgrade attacks by a Man in the Middle.

       <b>-W,</b> <b>--sweet32</b> Checks for vulnerability to SWEET32 by testing 64 bit block ciphers (3DES, RC2 and IDEA).

       <b>-F,</b> <b>--freak</b> Checks for FREAK vulnerability (<u>Factoring</u> <u>RSA</u> <u>Export</u> <u>Keys</u>) by testing for EXPORT RSA ciphers

       <b>-D,</b> <b>--drown</b> Checks for DROWN vulnerability (<u>Decrypting</u> <u>RSA</u> <u>with</u>  <u>Obsolete</u>  <u>and</u>  <u>Weakened</u>  <u>eNcryption</u>)  by
       checking  whether the SSL 2 protocol is available at the target. Please note that if you use the same RSA
       certificate elsewhere you might be vulnerable too. testssl.sh doesn't  check  for  this  but  provides  a
       helpful link @ censys.io which provides this service.

       <b>-J,</b>  <b>--logjam</b>  Checks  for  LOGJAM  vulnerability  by  checking for DH EXPORT ciphers. It also checks for
       "common primes" which are preconfigured DH keys. DH keys =&lt; 1024 Bit will be penalized. Also FFDHE groups
       (TLS 1.2) will be displayed here.

       <b>-A,</b> <b>--beast</b> Checks BEAST vulnerabilities in SSL 3 and TLS 1.0 by testing the usage of CBC ciphers.

       <b>-L,</b> <b>--lucky13</b> Checks for LUCKY13 vulnerability. It checks for the presence of CBC ciphers in TLS versions
       1.0 - 1.2.

       <b>-WS,</b> <b>--winshock</b> Checks for Winshock vulnerability. It tests for the absence of a lot of ciphers, some TLS
       extensions and ec curves which were introduced later in Windows. In the end the server  banner  is  being
       looked at.

       <b>-4,</b> <b>--rc4,</b> <b>--appelbaum</b> Checks which RC4 stream ciphers are being offered.

   <b>OUTPUT</b> <b>OPTIONS</b>
       <b>-q,</b>  <b>--quiet</b>  Normally  testssl.sh  displays  a  banner on stdout with several version information, usage
       rights and a warning. This option suppresses it. Please note that by choosing this option you acknowledge
       usage terms and the warning normally appearing in the banner.

       <b>--wide</b> Except the "each cipher output" all tests displays the single cipher name (scheme see below). This
       option enables testssl.sh to display also for the following sections the same output as for testing  each
       ciphers: BEAST, FS, RC4. The client simulation has also a wide mode. The difference here is restricted to
       a column aligned output and a proper headline. The environment variable <b>WIDE</b> can be used instead.

       <b>--mapping</b> <b>&lt;openssl|iana|no-openssl|no-iana&gt;</b>

       ○   <b>openssl</b>: use the OpenSSL cipher suite name as the primary name cipher suite name form (default),

       ○   <b>iana</b>: use the IANA cipher suite name as the primary name cipher suite name form.

       ○   <b>no-openssl</b>: don't display the OpenSSL cipher suite name, display IANA names only.

       ○   <b>no-iana</b>: don't display the IANA cipher suite name, display OpenSSL names only.

       Please  note  that  in testssl.sh 3.0 you can still use <b>rfc</b> instead of <b>iana</b> and <b>no-rfc</b> instead of <b>no-iana</b>
       but it'll disappear after 3.0.

       <b>--show-each</b> This is an option for all wide modes only:  it  displays  all  ciphers  tested  --  not  only
       succeeded ones. <b>SHOW_EACH_C</b> is your friend if you prefer to set this via the shell environment.

       <b>--color</b>  <b>&lt;0|1|2|3&gt;</b>  determines  the use of colors on the screen and in the log file: <b>2</b> is the default and
       makes use of ANSI and termcap escape codes on your terminal. <b>1</b> just uses non-colored mark-up  like  bold,
       italics, underline, reverse. <b>0</b> means no mark-up at all = no escape codes. This is also what you want when
       you  want  a log file without any escape codes. <b>3</b> will color ciphers and EC according to an internal (not
       yet perfect) rating. Setting the environment variable <b>COLOR</b> to the value achieves the same result. Please
       not that OpenBSD and early FreeBSD do not support italics.

       <b>--colorblind</b> Swaps green and blue colors in the output, so that this percentage of folks  (up  to  8%  of
       males,   see   https://en.wikipedia.org/wiki/Color_blindness)  can  distinguish  those  findings  better.
       <b>COLORBLIND</b> is the according variable if you want to set this in the environment.

       <b>--debug</b> <b>&lt;0-6&gt;</b> This gives you additional output on the screen (2-6), only useful for debugging.  <b>DEBUG</b>  is
       the according environment variable which you can use. There are six levels (0 is the default, thus it has
       no effect):

       1.  screen  output  normal  but  leaves  useful debug output in <b>/tmp/testssl.XXXXXX/</b> . The info about the
           exact directory is included in the screen output in the end of the run.

       2.  lists more what's going on, status (high level) and connection errors, a few general debug output

       3.  even slightly more info: hexdumps + other info

       4.  display bytes sent via sockets

       5.  display bytes received via sockets

       6.  whole 9 yards

       <b>--disable-rating</b> disables rating. Rating automatically gets disabled, to not give a wrong  or  misleading
       grade, when not all required functions are executed (e.g when checking for a single vulnerabilities).

   <b>FILE</b> <b>OUTPUT</b> <b>OPTIONS</b>
       <b>--log,</b> <b>--logging</b> Logs stdout also to <b>${NODE}-p${port}${YYYYMMDD-HHMM}.log</b> in current working directory of
       the  shell. Depending on the color output option (see above) the output file will contain color and other
       markup escape codes, unless you specify <b>--color</b> <b>0</b> too. <b>cat</b> and -- if properly  configured  <b>less</b>  --  will
       show  the  output properly formatted on your terminal. The output shows a banner with the almost the same
       information as on the screen. In addition it shows the command line of the  testssl.sh  instance.  Please
       note  that  the  resulting  log  file  is  formatted  according to the width of your screen while running
       testssl.sh. You can override the width with the environment variable TERM_WIDTH.

       <b>--logfile</b> <b>&lt;logfile&gt;</b> or <b>-oL</b> <b>&lt;logfile&gt;</b> Instead of the previous option you may want to use this one  if  you
       want to log into a directory or if you rather want to specify the log file name yourself. If <b>logfile</b> is a
       directory  the output will put into <b>logfile/${NODE}-p${port}${YYYYMMDD-HHMM}.log</b>. If <b>logfile</b> is a file it
       will use that file name, an absolute path is also permitted here. LOGFILE is the variable you need to set
       if you prefer to work environment variables instead. Please note that the resulting log file is formatted
       according to the width of your screen while running testssl.sh. You  can  override  the  width  with  the
       environment variable TERM_WIDTH.

       <b>--json</b>  Logs  additionally  to  JSON  file  <b>${NODE}-p${port}${YYYYMMDD-HHMM}.json</b>  in the current working
       directory of the shell. The resulting JSON file is opposed to <b>--json-pretty</b>  flat  --  which  means  each
       section is self contained and has an identifier for each single check, the hostname/IP address, the port,
       severity  and the finding. For vulnerabilities it may contain a CVE and CWE entry too. The output doesn't
       contain a banner or a footer.

       <b>--jsonfile</b> <b>&lt;jsonfile&gt;</b> or <b>-oj</b> <b>&lt;jsonfile&gt;</b> Instead of the previous option you may want to use  this  one  if
       you  want  to  log  the  JSON out put into a directory or if you rather want to specify the log file name
       yourself.     If     <b>jsonfile</b>     is     a     directory     the      output      will      put      into
       <b>logfile/${NODE}-p${port}${YYYYMMDD-HHMM}.json</b>.  If<b>jsonfile</b>  is  a  file  it  will  use that file name, an
       absolute path is also permitted here.

       <b>--json-pretty</b> Logs additionally to JSON file <b>${NODE}-p${port}${YYYYMMDD-HHMM}.json</b> in the current working
       directory of the shell. The resulting JSON file is opposed to  <b>--json</b>  non-flat  --  which  means  it  is
       structured.  The  structure  contains a header similar to the banner on the screen, including the command
       line, scan host, openssl binary used, testssl version and epoch of the start time. Then  for  every  test
       section  of  testssl.sh  it  contains  a  separate JSON object/section. Each finding has a key/value pair
       identifier with the identifier for each single check, the severity and the finding.  For  vulnerabilities
       it may contain a CVE and CWE entry too. The footer lists the scan time in seconds.

       <b>--jsonfile-pretty</b>  <b>&lt;jsonfile&gt;</b>  or <b>-oJ</b> <b>&lt;jsonfile&gt;</b> Similar to the aforementioned <b>--jsonfile</b> or <b>--logfile</b> it
       logs the output in pretty JSON format (see <b>--json-pretty</b>)  into  a  file  or  a  directory.  For  further
       explanation see <b>--jsonfile</b> or <b>--logfile</b>.

       <b>--csv</b>  Logs  additionally  to  a  CSV  file  <b>${NODE}-p${port}${YYYYMMDD-HHMM}.csv</b>  in the current working
       directory of the shell. The output contains a header with the keys, the values are the  same  as  in  the
       flat  JSON  format  (identifier  for  each single check, the hostname/IP address, the port, severity, the
       finding and for vulnerabilities a CVE and CWE number).

       <b>--csvfile</b> <b>&lt;csvfile&gt;</b> or <b>-oC</b> <b>&lt;csvfile&gt;</b> Similar to the aforementioned <b>--jsonfile</b> or <b>--logfile</b>  it  logs  the
       output  in  CSV  format  (see <b>--cvs</b>) additionally into a file or a directory. For further explanation see
       <b>--jsonfile</b> or <b>--logfile</b>.

       <b>--html</b> Logs additionally to an HTML file <b>${NODE}-p${port}${YYYYMMDD-HHMM}.html</b>  in  the  current  working
       directory  of  the  shell.  It  contains  a  1:1  output  of  the console. In former versions there was a
       non-native option to use "aha" (Ansi HTML Adapter: github.com/theZiz/aha) like <b>testssl.sh</b> <b>[options]</b> <b>&lt;URI&gt;</b>
       <b>|</b> <b>aha</b> <b>&gt;output.html</b>. This is not necessary anymore.

       <b>--htmlfile</b> <b>&lt;htmlfile&gt;</b> or <b>-oH</b> <b>&lt;htmlfile&gt;</b> Similar to the aforementioned <b>--jsonfile</b> or <b>--logfile</b> it logs the
       output in HTML format (see <b>--html</b>) additionally into a file or a directory. For further  explanation  see
       <b>--jsonfile</b> or <b>--logfile</b>.

       <b>-oA</b>  <b>&lt;filename&gt;</b>  /  <b>--outFile</b>  <b>&lt;filename&gt;</b>  Similar  to  nmap  it does a file output to all available file
       formats: LOG, JSON  pretty,  CSV,  HTML.  If  the  filename  supplied  is  equal  <b>auto</b>  the  filename  is
       automatically  generated using '${NODE}-p${port}${YYYYMMDD-HHMM}.${EXT}' with the according extension. If
       a      directory      is      provided       all       output       files       will       put       into
       <b>&lt;filename&gt;/${NODE}-p${port}${YYYYMMDD-HHMM}.{log,json,csv,html}</b>.

       <b>-oa</b> <b>&lt;filename&gt;</b> / <b>--outfile</b> <b>&lt;filename&gt;</b> Does the same as the previous option but uses flat JSON instead.

       <b>--hints</b>  This  option  is  not  in use yet. This option is meant to give hints how to fix a finding or at
       least a help to improve something. GIVE_HINTS is the environment variable for this.

       <b>--severity</b> <b>&lt;severity&gt;</b> For CSV and both JSON outputs this will only add findings to the output file  if  a
       severity  is  equal  or higher than the <b>severity</b> value specified. Allowed are <b>&lt;LOW|MEDIUM|HIGH|CRITICAL&gt;</b>.
       WARN is another level which translates to a client-side scanning error or problem. Thus you  will  always
       see them in a file if they occur.

       <b>--append</b>  Normally, if an output file already exists and it has a file size greater zero, testssl.sh will
       prompt you to manually remove the file and exit with an error. <b>--append</b> however will append to this file,
       without a header. The environment variable APPEND does the same. Be careful using this switch/variable. A
       complementary option which overwrites an existing file doesn't exist per design.

       <b>--overwrite</b> Normally, if an output file already exists and it has a file size  greater  zero,  testssl.sh
       will  not allow you to overwrite this file. This option will do that <b>without</b> <b>any</b> <b>warning</b>. The environment
       variable OVERWRITE does the same. Be careful, you have been warned!

       <b>--outprefix</b> <b>&lt;fname_prefix&gt;</b> Prepend output filename prefix <u>fname_prefix</u> before <b>${NODE}-</b>. You  can  use  as
       well   the   environment   variable   FNAME_PREFIX.   Using   this   any   output  files  will  be  named
       <b>&lt;fname_prefix&gt;-${NODE}-p${port}${YYYYMMDD-HHMM}.&lt;format&gt;</b> when no  file  name  of  the  respective  output
       option was specified. If you do not like the separator '-' you can as well supply a <b>&lt;fname_prefix&gt;</b> ending
       in  '.',  '_'  or  ','. In this case or if you already supplied '-' no additional '-' will be appended to
       <b>&lt;fname_prefix&gt;</b>.

       A few file output options can also be preset via environment variables.

   <b>COLOR</b> <b>RATINGS</b>
       Testssl.sh makes use of (the eight) standard terminal colors. The color scheme is as follows:

       ○   light red: a critical finding

       ○   red: a high finding

       ○   brown: a medium finding

       ○   yellow: a low finding

       ○   green (blue if COLORBLIND is set): something which is either in general a good thing  or  a  negative
           result of a check which otherwise results in a high finding

       ○   light  green  (light  blue  if  COLORBLIND is set) : something which is either in general a very good
           thing or a negative result of a check which otherwise results in a critical finding

       ○   no color at places where also a finding can be expected: a finding on an info level

       ○   cyan: currently only used for <b>--show-each</b> or an additional hint

       ○   magenta: signals a warning condition, e.g. either a local lack of capabilities on the client side  or
           another problem

       ○   light  magenta:  a  fatal  error  which either requires strict consent from the user to continue or a
           condition which leaves no other choice for testssl.sh to quit

       What is labeled as "light" above appears as such on  the  screen  but  is  technically  speaking  "bold".
       Besides <b>--color=3</b> will color ciphers according to an internal and rough rating.

       Markup (without any color) is used in the following manner:

       ○   bold: for the name of the test

       ○   underline + bold: for the headline of each test section

       ○   underline: for a sub-headline

       ○   italics: for strings just reflecting a value read from the server

   <b>TUNING</b> <b>via</b> <b>ENV</b> <b>variables</b> <b>and</b> <b>more</b> <b>options</b>
       Except the environment variables mentioned above which can replace command line options here a some which
       cannot  be set otherwise. Variables used for tuning are preset with reasonable values. <u>There</u> <u>should</u> <u>be</u> <u>no</u>
       <u>reason</u> <u>to</u> <u>change</u> <u>them</u> unless you use testssl.sh under special conditions.

       ○   TERM_WIDTH is a variable which overrides  the  auto-determined  terminal  width  size.  Setting  this
           variable  normally only makes sense if you log the output to a file using the <b>--log</b>, <b>--logfile</b> or <b>-oL</b>
           option.

       ○   DEBUG_ALLINONE / SETX: when setting one of those to true testssl.sh falls back to the  standard  bash
           behavior,  i.e.  calling  <b>bash</b> <b>-x</b> <b>testssl.sh</b> it displays the bash debugging output not in an external
           file <b>/tmp/testssl-&lt;XX&gt;.log</b>

       ○   DEBUGTIME: Profiling option. When using bash's debug mode and when this is set to true, it  generates
           a  separate  text  file  with  epoch times in <b>/tmp/testssl-&lt;XX&gt;.time</b>. They need to be concatenated by
           <b>paste</b> <b>/tmp/testssl-&lt;XX&gt;.{time,log}</b> [comment]: # * FAST_SOCKET [comment]: # * SHOW_SIGALGO  [comment]:
           # * FAST

       ○   EXPERIMENTAL=true  is  an  option  which is sometimes used in the development process to make testing
           easier. In released versions this has no effect.

       ○   ALL_CLIENTS=true runs a client simulation with <u>all</u> (currently 126) clients when testing HTTP.

       ○   UNBRACKTD_IPV6: needs to be set to true for some old versions of OpenSSL  (like  from  Gentoo)  which
           don't support [bracketed] IPv6 addresses

       ○   NO_ENGINE:  if  you  have problems with garbled output containing the word 'engine' you might want to
           set this to true. It forces testssl.sh not try to configure openssl's engine or a  non  existing  one
           from libressl

       ○   HEADER_MAXSLEEP:  To  wait  how  long  before killing the process to retrieve a service banner / HTTP
           header

       ○   MAX_WAITSOCK: It instructs testssl.sh to wait until the specified  time  before  declaring  a  socket
           connection  dead.  Don't  change  this  unless  you're absolutely sure what you're doing. Value is in
           seconds.

       ○   CCS_MAX_WAITSOCK Is the similar to above but applies only to the CCS handshakes, for both of the  two
           the  two  CCS payload. Don't change this unless you're absolutely sure what you're doing. Value is in
           seconds.

       ○   HEARTBLEED_MAX_WAITSOCK Is the similar to MAX_WAITSOCK but applies  only  to  the  ServerHello  after
           sending  the  Heartbleed  payload. Don't change this unless you're absolutely sure what you're doing.
           Value is in seconds.

       ○   MEASURE_TIME_FILE For seldom cases when you don't want the scan time to be included in the output you
           can set this to false.

       ○   STARTTLS_SLEEP is per default set to 10 (seconds). That's the value testssl.sh waits for a string  in
           the STARTTLS handshake before giving up.

       ○   MAX_PARALLEL  is  the  maximum  number of tests to run in parallel in parallel mass testing mode. The
           default value of 20 may be made larger on systems with faster processors.

       ○   MAX_WAIT_TEST is the maximum time (in seconds) to wait for a single test  in  parallel  mass  testing
           mode to complete. The default is 1200. [comment]: # USLEEP_SND [comment]: # USLEEP_REC

       ○   HSTS_MIN  is  preset  to  179  (days). If you want warnings sooner or later for HTTP Strict Transport
           Security you can change this.

       ○   HPKP_MIN is preset to 30 (days). If you want warnings sooner or later for HTTP Public Key Pinning you
           can change this

       ○   DAYS2WARN1 is the first threshold when you'll be warning of  a  certificate  expiration  of  a  host,
           preset to 60 (days). For Let's Encrypt this value will be divided internally by 2.

       ○   DAYS2WARN2  is  the  second  threshold  when you'll be warning of a certificate expiration of a host,
           preset to 30 (days). For Let's Encrypt this value will be divided internally by 2.

       ○   TESTSSL_INSTALL_DIR is the derived installation directory of testssl.sh. Relatively to that  the  <b>bin</b>
           and mandatory <b>etc</b> directory will be looked for.

       ○   CA_BUNDLES_PATH:  If  you have an own set of CA bundles or you want to point testssl.sh to a specific
           location of a CA bundle, you can use this variable to set the directory which  testssl.sh  will  use.
           Please  note  that  it  overrides completely the builtin path of testssl.sh which means that you will
           only test against the bundles you point to. Also you might want to use <b><a href="file:~/utils/create_ca_hashes.sh">~/utils/create_ca_hashes.sh</a></b> to
           create the hashes for HPKP.

       ○   MAX_SOCKET_FAIL: A number which tells testssl.sh how often a TCP socket connection  may  fail  before
           the  program  gives up and terminates. The default is 2. You can increase it to a higher value if you
           frequently see a message like <u>Fatal</u> <u>error:</u> <u>repeated</u> <u>openssl</u> <u>s_client</u> <u>connect</u>  <u>problem,</u>  <u>doesn't</u>  <u>make</u>
           <u>sense</u> <u>to</u> <u>continue</u>.

       ○   MAX_OSSL_FAIL:  A number which tells testssl.sh how often an OpenSSL s_client connect may fail before
           the program gives up and terminates. The default is 2. You can increase it to a higher value  if  you
           frequently see a message like <u>Fatal</u> <u>error:</u> <u>repeated</u> <u>TCP</u> <u>connect</u> <u>problems,</u> <u>giving</u> <u>up</u>.

       ○   MAX_HEADER_FAIL: A number which tells testssl.sh how often a HTTP GET request over OpenSSL may return
           an  empty  file  before  the  program  gives  up  and terminates. The default is 3. Also here you can
           increase the threshold when you  spot  messages  like  <u>Fatal</u>  <u>error:</u>  <u>repeated</u>  <u>HTTP</u>  <u>header</u>  <u>connect</u>
           <u>problems,</u> <u>doesn't</u> <u>make</u> <u>sense</u> <u>to</u> <u>continue</u>.

       ○   OPENSSL2  can  be used to supply an alternative openssl version. This only makes sense if you want to
           amend the supplied version in <b>bin/</b> which lacks TLS 1.3 support with a version which does not  and  is
           not in <b><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?openssl">/usr/bin/openssl</a></b>.

       ○   OSSL_SHORTCUT can be set to true when you run interactively and don't want to switch automatically to
           <b><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?openssl">/usr/bin/openssl</a></b> (<b>OPENSSL2</b>) if you encounter a TLS 1.3-only host.

   <b>RATING</b>
       This   program   has   a   near-complete   implementation   of   SSL  Labs's  'SSL  Server  Rating  Guide
       <u>https://github.com/ssllabs/research/wiki/SSL-Server-Rating-Guide</u>'.

       This    is    <u>not</u>    a    100%    reimplementation    of    the    SSL    Lab's    SSL    Server     Test
       <u>https://www.ssllabs.com/ssltest/analyze.html</u>,  but  an  implementation of the above rating specification,
       slight discrepancies may occur. Please note that for now we stick to the  SSL  Labs  rating  as  good  as
       possible.  We  are  not  responsible  for  their rating. Before filing issues please inspect their Rating
       Guide.

       Disclaimer: Having a good grade is  <b>NOT</b>  necessarily  equal  to  having  good  security!  Don't  start  a
       competition  for  the  best  grade, at least not without monitoring the client handshakes and not without
       adding a portion of good sense to it. Please note STARTTLS always results in a grade cap to  T.  Anything
       else  would  lead  to  a false sense of security. Use TLS, see also RFC 8314. The security of STARTTLS is
       always client determined, i'.e. checking the certificate which for SMTP port 25 is often enough  not  the
       case. Also with DANE or MTA-STS no one can test on the server side whether a client makes use if it.

       As  of  writing,  these  checks are missing: * GOLDENDOODLE - should be graded <b>F</b> if vulnerable * Insecure
       renegotiation - should be graded <b>F</b> if vulnerable * Padding oracle in AES-NI CBC MAC check (CVE-2016-2107)
       - should be graded <b>F</b> if vulnerable * Sleeping POODLE - should be graded <b>F</b> if  vulnerable  *  Zero  Length
       Padding Oracle (CVE-2019-1559) - should be graded <b>F</b> if vulnerable * Zombie POODLE - should be graded <b>F</b> if
       vulnerable  *  All remaining old Symantec PKI certificates are distrusted - should be graded <b>T</b> * Symantec
       certificates issued before June 2016 are distrusted - should be graded  <b>T</b>  *  Anonymous  key  exchange  -
       should  give  <b>0</b>  points  in  <b>set_key_str_score()</b>  *  Exportable  key  exchange - should give <b>40</b> points in
       <b>set_key_str_score()</b> * Weak key (Debian OpenSSL Flaw) - should give <b>0</b> points in <b>set_key_str_score()</b>

       To implement a new grading cap, simply call the <b>set_grade_cap()</b> function, with the grade  and  a  reason:
       <b>bash</b>  <b>set_grade_cap</b>  <b>"D"</b>  <b>"Vulnerable</b> <b>to</b> <b>documentation"</b> To implement a new grade warning, simply call the
       <b>set_grade_warning()</b> function, with a message: <b>bash</b> <b>set_grade_warning</b> <b>"Documentation</b> <b>is</b> <b>always</b> <b>right"</b> ####
       Implementing a new check which contains grade caps When implementing a new check (be it vulnerability  or
       not)  that  sets grade caps, the <b>set_rating_state()</b> has to be updated (i.e. the <b>$do_mycheck</b> variable-name
       has to be added to the loop, and <b>$nr_enabled</b> if-statement has to be incremented)

       The <b>set_rating_state()</b> automatically disables rating, if all the required checks are <u>not</u> enabled. This is
       to prevent giving out a misleading or wrong grade.

       When a new revision of the rating specification comes around, the following has to be done: *  New  grade
       caps has to be either: 1. Added to the script wherever relevant, or 2. Added to the above list of missing
       checks  (if  above is not possible) * New grade warnings has to be added wherever relevant * The revision
       output in <b>run_rating()</b> function has to updated

</pre><h4><b>EXAMPLES</b></h4><pre>
         testssl.sh testssl.sh

       does a default run on https://testssl.sh (protocols, standard cipher lists, server's cipher  preferences,
       forward secrecy, server defaults, vulnerabilities, client simulation, and rating.

             testssl.sh testssl.net:443

       does  the  same  default run as above with the subtle difference that testssl.net has two IPv4 addresses.
       Both are tested.

             testssl.sh --ip=one --wide https://testssl.net:443

       does the same checks as above, with the  difference  that  one  IP  address  is  being  picked  randomly.
       Displayed is everything where possible in wide format.

             testssl.sh -6 https://testssl.net

       As opposed to the first example it also tests the IPv6 part -- supposed you have an IPv6 network and your
       openssl supports IPv6 (see above).

             testssl.sh -t smtp smtp.gmail.com:25

       Checks are done via a STARTTLS handshake on the plain text port 25. It checks every IP on smtp.gmail.com.

               testssl.sh --starttls=imap imap.gmx.net:143

       does the same on the plain text IMAP port.

       Please  note that for plain TLS-encrypted ports you must not specify the protocol option when no STARTTLS
       handshake is offered: <b>testssl.sh</b> <b>smtp.gmail.com:465</b>  just  checks  the  encryption  on  the  SMTPS  port,
       <b>testssl.sh</b>  <b>imap.gmx.net:993</b>  on the IMAPS port. Also MongoDB which provides TLS support without STARTTLS
       can be tested directly.

</pre><h4><b>RFCs</b> <b>and</b> <b>other</b> <b>standards</b></h4><pre>
       ○   RFC 2246: The TLS Protocol Version 1.0

       ○   RFC 2595: Using TLS with IMAP, POP3 and ACAP

       ○   RFC 2818: HTTP Over TLS

       ○   RFC 2830: Lightweight Directory Access Protocol (v3): Extension for Transport Layer Security

       ○   RFC 3207: SMTP Service Extension for Secure SMTP over Transport Layer Security

       ○   RFC 3501: INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1

       ○   RFC 4346: The Transport Layer Security (TLS) Protocol Version 1.1

       ○   RFC 4366: Transport Layer Security (TLS) Extensions

       ○   RFC 4492: Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)

       ○   RFC 5077: Transport Layer Security (TLS) Session Resumption

       ○   RFC 5246: The Transport Layer Security (TLS) Protocol Version 1.2

       ○   RFC 5280: Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List  (CRL)
           Profile

       ○   RFC 5321: Simple Mail Transfer Protocol

       ○   RFC 5746: Transport Layer Security (TLS) Renegotiation Indication Extension

       ○   RFC 5804: A Protocol for Remotely Managing Sieve Scripts

       ○   RFC 6066: Transport Layer Security (TLS) Extensions: Extension Definitions

       ○   RFC 6101: The Secure Sockets Layer (SSL) Protocol Version 3.0

       ○   RFC 6120: Extensible Messaging and Presence Protocol (XMPP): Core

       ○   RFC 6125: Domain-Based Application Service Identity [..]

       ○   RFC 6797: HTTP Strict Transport Security (HSTS)

       ○   RFC 6961: The Transport Layer Security (TLS) Multiple Certificate Status Request Extension

       ○   RFC 7469: Public Key Pinning Extension for HTTP (HPKP)

       ○   RFC 7507: TLS Fallback Signaling Cipher Suite Value (SCSV) for Preventing Protocol Downgrade Attacks

       ○   RFC 7627: Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension

       ○   RFC 7633: X.509v3 Transport Layer Security (TLS) Feature Extension

       ○   RFC 7465: Prohibiting RC4 Cipher Suites

       ○   RFC 7685: A Transport Layer Security (TLS) ClientHello Padding Extension

       ○   RFC 7905: ChaCha20-Poly1305 Cipher Suites for Transport Layer Security (TLS)

       ○   RFC 7919: Negotiated Finite Field Diffie-Hellman Ephemeral Parameters for Transport Layer Security

       ○   RFC 8143: Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)

       ○   RFC 8446: The Transport Layer Security (TLS) Protocol Version 1.3

       ○   RFC 8701: Applying Generate Random Extensions And Sustain Extensibility (GREASE) to TLS Extensibility

       ○   W3C CSP: Content Security Policy Level 1-3

       ○   TLSWG Draft: The Transport Layer Security (TLS) Protocol Version 1.3

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       ○   0 testssl.sh finished successfully without errors and without ambiguous results

       ○   1 testssl.sh has encountered exactly one ambiguous situation or an error during run

       ○   1+n same as previous. The errors or ambiguous results are added, also per IP.

       ○   50-200 reserved for returning a vulnerability scoring for system monitoring or a CI tools

       ○   242 (ERR_CHILD) Child received a signal from master

       ○   244 (ERR_RESOURCE) Resources testssl.sh needs couldn't be read

       ○   245 (ERR_CLUELESS) Weird state, either though user options or testssl.sh

       ○   246 (ERR_CONNECT) Connectivity problem

       ○   247 (ERR_DNSLOOKUP) Problem with resolving IP addresses or names

       ○   248 (ERR_OTHERCLIENT) Other client problem

       ○   249 (ERR_DNSBIN) Problem with DNS lookup binaries

       ○   250 (ERR_OSSLBIN) Problem with OpenSSL binary

       ○   251 (ERR_NOSUPPORT) Feature requested is not supported

       ○   252 (ERR_FNAMEPARSE) Input file couldn't be parsed

       ○   253 (ERR_FCREATE) Output file couldn't be created

       ○   254 (ERR_CMDLINE) Cmd line couldn't be parsed

       ○   255 (ERR_BASH) Bash version incorrect

</pre><h4><b>FILES</b></h4><pre>
       <b>etc/*pem</b> are the certificate stores from Apple, Linux, Mozilla Firefox, Windows and Java.

       <b>etc/client-simulation.txt</b> contains client simulation data.

       <b>etc/cipher-mapping.txt</b>  provides  a  mandatory  file with mapping from OpenSSL cipher suites names to the
       ones from IANA / used in the RFCs.

       <b>etc/tls_data.txt</b> provides a mandatory file for ciphers (bash sockets) and key material.

</pre><h4><b>AUTHORS</b></h4><pre>
       Developed by Dirk Wetter, David Cooper and many others, see CREDITS.md .

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright © 2012 Dirk Wetter. License GPLv2: Free Software Foundation, Inc. This is  free  software:  you
       are free to change and redistribute it under the terms of the license, see LICENSE.

       Attribution is important for the future of this project - also in the internet. Thus if you're offering a
       scanner  based  on testssl.sh as a public and/or paid service in the internet you are strongly encouraged
       to mention to your audience that you're using this program and where to get this program from. That helps
       us to get bugfixes, other feedback and more contributions.

       Usage WITHOUT ANY WARRANTY. USE at your OWN RISK!

</pre><h4><b>LIMITATION</b></h4><pre>
       All native Windows platforms emulating Linux are known to be slow.

</pre><h4><b>BUGS</b></h4><pre>
       Probably. Current known ones and interface for filing new ones: https://testssl.sh/bugs/ .

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/ciphers.1.html">ciphers</a></b>(1), <b><a href="../man1/openssl.1.html">openssl</a></b>(1), <b><a href="../man1/s_client.1.html">s_client</a></b>(1), <b><a href="../man1/x509.1.html">x509</a></b>(1),  <b><a href="../man1/verify.1.html">verify</a></b>(1),  <b><a href="../man1/ocsp.1.html">ocsp</a></b>(1),  <b><a href="../man1/crl.1.html">crl</a></b>(1),  <b><a href="../man1/bash.1.html">bash</a></b>(1)  and  the  websites
       https://testssl.sh/ and https://github.com/testssl/testssl.sh/ .

                                                  December 2021                                       <u><a href="../man1/TESTSSL.1.html">TESTSSL</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>