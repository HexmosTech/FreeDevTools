<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nstreams - a tcpdump output analyzer</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nstreams">nstreams_1.0.4-1.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nstreams - a tcpdump output analyzer

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>nstreams</b>  [  -v  ] [ -c <u>nstreams-services</u> ] [ -n <u>nstreams-networks_file</u> ] [ -N [ -i ] [ -I ]] [ -r ] [ -O
       output [ -D iface ] [ -Y ]] [ -u ] [ -U ] [ -B ] [ -f <u>tcpdump_file</u> <u>]</u> <u>[</u> <u>-l</u> <u>&lt;iface&gt;</u> <u>]</u> <u>[</u> <u>tcpdump</u> <u>output</u> ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>nstreams</b> is a utility designed to identify the IP streams that are occuring on a network from a  non-user
       friendly tcpdump output of several megabytes.

       This  is  especially  useful when you plan to install a firewall but if you do not know the nstreams that
       the network users are generating (http, real audio, and more...).  <b>nstreams</b> can read the  tcpdump  output
       directly  from stdin, or from a file. It can even generate the configuration file of your firewall, using
       the  -O option.

</pre><h4><b>OPTIONS</b></h4><pre>
       -c &lt;nstreams-services-file&gt;
              The path to an alternate nstreams service file. This file is used to identify each  protocol.  See
              the <b>services</b> <b>file</b> section later in this manual page.

       -n &lt;nstreams-networks-file&gt;
              The  path  to an alternate nstreams network file. This file is used to identify which hosts belong
              to which network. See the <b>networks</b> <b>file</b> section later in this manual page.

       -f &lt;tcpdump output file&gt;
              The path to the file to read data from. This file must  have  been  generated  using  'tcpdump  -w
              filename'.

       -l &lt;iface&gt;
              Listen directly on interface &lt;iface&gt;. This avoids the use of tcpdump.

       -N     print  the networks names instead of the hosts IP addresses. The intra-network traffic will not be
              shown. Use this option twice to show the networks IP address instead of their names.

       -i     Also show the intra-network traffic (must be used with -N)

       -I     Only show the intra-network traffic (must be used with -N)

       -r     be redundant. That is, the same streams will be printed each time they appear in the dump.

       -v     print version number and exit.

       -O &lt;type&gt;
              output type. You can use this option to generate your firewall startup script.  Do nstreams -h  to
              see the supported output types.

       -D &lt;iface&gt;
              interface to apply to output onto. Must be used with -O.

       -Y     The  firewall rules that will be generated will deny all packets coming from the outside trying to
              establish connections to the inside. If you system is not serving anything, then it's safe to turn
              on this option.

       -u     Do not print the unknown streams

       -U     Only print the unknown streams

       -B     Show broadcasts and networks

</pre><h4><b>USAGE</b></h4><pre>
       Let <a href="../man1/tcpdump.1.html">tcpdump</a>(1) run some time on your network (like one week), and save its output in a file, by doing :
       tcpdump -l -n &gt; output
       or
       tcpdump -w filename

       Then, feed <b>nstreams</b> with this output file, and it will turn it into a  easily-readable  file  which  will
       help you to write efficient firewall filters.  You may also do :
       tcpdump -l -n | nstreams
       or
       nstreams -f filename (if you used tcpdump -w)

</pre><h4><b>THE</b> <b>SERVICES</b> <b>FILE</b></h4><pre>
       The service file contains the description of each protocol, as well as their name. Its syntax is :
       protocol_name:server_port(s)/{udp,tcp}:client_ports(s)
       or :
       protocol_name:type(s)/icmp:code(s)

       Whereas :

       protocol_name
              is  the  name  of  the  protocol  described. This name may contain any character, including space,
              except ':'.

       server_port(s)
              is the range of ports used by the server. Usually, you will want to define one server  port  only,
              but you may enter any range you want.

       ip_protocol
              is the IP protocol that this protocol is lying onto. Acceptable values are <u>tcp</u> and <u>udp</u>

       client_port(s)

              is  the  range  of  ports  that  the client may use. You can set this to <u>any</u> or, for more accurate
              results, to ports ranges, like '1-1024,2048-4096'.
              The rules are : 'first match, first taken'.

</pre><h4><b>SERVICE</b> <b>FILE</b> <b>EXAMPLE</b></h4><pre>
       Using this syntax, you would declare the ssh protocol by :
       ssh-unix:22/tcp:1000-1023
       Because the Unix version of the ssh client uses a privileged port to connect onto the  ssh  server  which
       listens on port 22.

</pre><h4><b>THE</b> <b>NETWORKS</b> <b>FILE</b></h4><pre>
       The  networks  file  is  used  to  define sets and subsets of hosts (also known as networks). This avoids
       redundancy in the output file. The syntax format for this file is :
       network name:ip/mask
       Whereas the network name is whatever you want, the IP is the ip of the network, and the mask is the  CIDR
       netmask of the network.  The rule is 'first match, first taken'.

</pre><h4><b>NETWORKS</b> <b>FILE</b> <b>EXAMPLE</b></h4><pre>
       admin:192.168.19.0/29
       whole_subnet:192.168.0.0/16
       internet:0.0.0.0/0

</pre><h4><b>LIMITS</b></h4><pre>
       • nstreams can only parse the output of 'tcpdump -n'

       •  Even  though  the output of nstreams is easier to read than the one of tcpdump, it is still not easily
       readable. Use <a href="../man1/sort.1.html">sort</a>(1) on the nstream output to get a more readable file.

       • This program could have been written in perl

</pre><h4><b>FILES</b></h4><pre>
       /etc/nstreams-services
       /etc/nstreams-networks

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/tcpdump.1.html">tcpdump</a>(1)

</pre><h4><b>AUTHORS</b></h4><pre>
       Concept : Herve Schauer Consultants - <a href="http://www.hsc.fr">http://www.hsc.fr</a>
       Coding : Renaud Deraison &lt;<a href="mailto:deraison@cvs.nessus.org">deraison@cvs.nessus.org</a>&gt;

</pre><h4><b>BUG</b> <b>REPORTS</b></h4><pre>
       Please  send  all  your  bug  reports  with  the  detail  of  your  configuration  to   Renaud   Deraison
       &lt;<a href="mailto:deraison@cvs.nessus.org">deraison@cvs.nessus.org</a>&gt;

nstreams                                            July 1999                                        <u><a href="../man1/nstreams.1.html">nstreams</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>