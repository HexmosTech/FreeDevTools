<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>i.topo.corr  - Computes topographic correction of reflectance.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/grass-doc">grass-doc_8.4.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>i.topo.corr</b>  - Computes topographic correction of reflectance.

</pre><h4><b>KEYWORDS</b></h4><pre>
       imagery, terrain, topographic correction

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>i.topo.corr</b>
       <b>i.topo.corr</b> <b>--help</b>
       <b>i.topo.corr</b>   [-<b>is</b>]   [<b>input</b>=<u>name</u>[,<u>name</u>,...]]   <b>output</b>=<u>name</u>  <b>basemap</b>=<u>name</u>  <b>zenith</b>=<u>float</u>   [<b>azimuth</b>=<u>float</u>]
       [<b>method</b>=<u>string</u>]   [--<b>overwrite</b>]  [--<b>help</b>]  [--<b>verbose</b>]  [--<b>quiet</b>]  [--<b>ui</b>]

   <b>Flags:</b>
       <b>-i</b>
           Output sun illumination terrain model

       <b>-s</b>
           Scale output to input and copy color rules

       <b>--overwrite</b>
           Allow output files to overwrite existing files

       <b>--help</b>
           Print usage summary

       <b>--verbose</b>
           Verbose module output

       <b>--quiet</b>
           Quiet module output

       <b>--ui</b>
           Force launching GUI dialog

   <b>Parameters:</b>
       <b>input</b>=<u>name[,name</u>,...]
           Name of reflectance raster maps to be corrected topographically

       <b>output</b>=<u>name</u> <b>[required]</b>
           Name (flag -i) or prefix for output raster maps

       <b>basemap</b>=<u>name</u> <b>[required]</b>
           Name of input base raster map (elevation or illumination)

       <b>zenith</b>=<u>float</u> <b>[required]</b>
           Solar zenith in degrees

       <b>azimuth</b>=<u>float</u>
           Solar azimuth in degrees (only if flag -i)

       <b>method</b>=<u>string</u>
           Topographic correction method
           Options: <u>cosine,</u> <u>minnaert,</u> <u>c-factor,</u> <u>percent</u>
           Default: <u>c-factor</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>i.topo.corr</u> is used to topographically  correct  reflectance  from  imagery  files,  e.g.  obtained  with
       <u>i.landsat.toar</u>,  using a sun illumination terrain model. This illumination model represents the cosine of
       the incident angle <u>i</u>, i.e. the angle between the normal to the ground and the sun rays.

       Note: If needed, the sun position can be calculated for a given date and time with <u>r.sunmask</u>.
       Figure showing terrain and solar angles

       Using the <b>-i</b> flag and given an elevation basemap (metric),  <u>i.topo.corr</u>  creates  a  simple  illumination
       model using the formula:

           •   cos_i = cos(s) * cos(z) + sin(s) * sin(z) * cos(a - o)
       where,

           •   <u>i</u> is the incident angle to be calculated,

           •   <u>s</u> is the terrain slope angle (from <u>r.slope.aspect</u>),

           •   <u>z</u> is the solar zenith angle (i.e., 90° - solar horizon angle from <u>r.sunmask</u>),

           •   <u>a</u> the solar azimuth angle (from <u>r.sunmask</u>),

           •   <u>o</u> the terrain aspect angle (from <u>r.slope.aspect</u>).

       For  each band file, the corrected reflectance (ref_c) is calculate from the original reflectance (ref_o)
       using one of the four offered methods (one lambertian and two non-lambertian).

   <b>Method:</b> <b>cosine</b>
           •   ref_c = ref_o * cos_z / cos_i

   <b>Method:</b> <b>minnaert</b>
           •   ref_c = ref_o * (cos_z / cos_i) ^k
       where, <u>k</u> is obtained by linear regression of
       ln(ref_o) = ln(ref_c) - k ln(cos_i/cos_z)

   <b>Method:</b> <b>c-factor</b>
           •   ref_c = ref_o * (cos_z + c)/ (cos_i + c)
       where, <u>c</u> is a/m from ref_o = a + m * cos_i

   <b>Method:</b> <b>percent</b>
       We can use cos_i to estimate the percent of solar incidence  on  the  surface,  then  the  transformation
       (cos_i  +  1)/2  varied  from  0 (surface in the side in opposition to the sun: infinite correction) to 1
       (direct exhibition to the sun: no correction) and the corrected reflectance can be calculated as

           •   ref_c = ref_o * 2 / (cos_i + 1)

</pre><h4><b>NOTES</b></h4><pre>
       <b>1</b>      The illumination model (cos_i) with flag -i uses the actual region as limits and the resolution of
              the elevation map.

       <b>2</b>      The topographic correction use the full reflectance file (null remain null) and its resolution.

       <b>3</b>      The elevation map to calculate the illumination model should be metric.

</pre><h4><b>EXAMPLES</b></h4><pre>
       First, make a illumination model from the elevation map (here, SRTM). Then make perform  the  topographic
       correction  of  e.g.  the  bands  toar.5,  toar.4 and toar.3 with output as tcor.toar.5, tcor.toar.4, and
       tcor.toar.3 using c-factor (= c-correction) method:

       # first pass: create illumination model
       i.topo.corr -i base=SRTM zenith=33.3631 azimuth=59.8897 output=SRTM.illumination
       # second pass: apply illumination model
       i.topo.corr base=SRTM.illumination input=toar.5,toar.4,toar.3 output=tcor \
         zenith=33.3631 method=c-factor

</pre><h4><b>REFERENCES</b></h4><pre>
           •   Law K.H. and Nichol J, 2004. Topographic Correction  For  Differential  Illumination  Effects  On
               Ikonos  Satellite  Imagery.  International  Archives of Photogrammetry Remote Sensing and Spatial
               Information, pp. 641-646.

           •   Meyer, P. and Itten, K.I. and Kellenberger,  KJ  and  Sandmeier,  S.  and  Sandmeier,  R.,  1993.
               Radiometric  corrections of topographically induced effects on Landsat TM data in alpine terrain.
               Photogrammetric Engineering and Remote Sensing <a href="../man17/48.17.html">48</a>(17).

           •   Riaño, D. and Chuvieco, E.  and  Salas,  J.  and  Aguado,  I.,  2003.   Assessment  of  Different
               Topographic  Corrections  in  Landsat-TM  Data for Mapping Vegetation Types. IEEE Transactions On
               Geoscience And Remote Sensing, Vol. 41, No. 5

           •   Twele A. and Erasmi S, 2005. Evaluating topographic correction algorithms for improved land cover
               discrimination in mountainous areas of Central Sulawesi.  Göttinger  Geographische  Abhandlungen,
               vol. 113.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        <u>i.landsat.toar,</u> <u>r.mapcalc,</u> <u>r.sun</u> <u>r.sunmask</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       E. Jorge Tizado  (ej.tizado unileon es)
       Dept. Biodiversity and Environmental Management, University of León, Spain

       Figure derived from Neteler &amp; Mitasova, 2008.

</pre><h4><b>SOURCE</b> <b>CODE</b></h4><pre>
       Available at: i.topo.corr source code (history)

       Accessed: Friday Apr 04 01:21:03 2025

       Main index | Imagery index | Topics index | Keywords index | Graphical index | Full index

       © 2003-2025 GRASS Development Team, GRASS GIS 8.4.1 Reference Manual

GRASS 8.4.1                                                                                  <u><a href="../man1grass/i.topo.corr.1grass.html">i.topo.corr</a></u>(1grass)
</pre>
 </div>
</div></section>
</div>
</body>
</html>