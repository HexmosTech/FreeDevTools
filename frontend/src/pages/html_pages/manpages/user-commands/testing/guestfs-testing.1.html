<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>guestfs-testing - manual testing of libguestfs, you can help!</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/libguestfs0t64">libguestfs0t64_1.54.1-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       guestfs-testing - manual testing of libguestfs, you can help!

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This page has manual tests you can try on libguestfs.  Everyone has a slightly different combination of
       platform, hardware and guests, so this testing is very valuable.  Thanks for helping out!

       Tests marked with a <b>*</b> (asterisk) can <b>destroy</b> <b>data</b> if you're not careful.  The others are safe and won't
       modify anything.

       These tests <b>require</b> <b>libguestfs</b> <b>≥</b> <b>1.22</b>.

       You can report bugs you find through this link:

       https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools

       or post on the mailing list (registration is <b>not</b> required, but if you're not registered then you'll have
       to wait for a moderator to manually approve your message):

       https://lists.libguestfs.org

</pre><h4><b>TESTS</b></h4><pre>
   <b>Run</b> <b>libguestfs-test-tool</b>
       Run:

        libguestfs-test-tool

       This command does a very simple, non-destructive test that basic libguestfs is functioning.  You don't
       need to run it as root.

       If it <u>doesn't</u> print "===== TEST FINISHED OK =====", report it as a bug.  It is very important that you
       include the <b>complete,</b> <b>unedited</b> output of "libguestfs-test-tool" in your bug report.  See the "BUGS"
       section at the end of this page.

   <b>Check</b> <b>KVM</b> <b>acceleration</b> <b>is</b> <b>being</b> <b>used.</b>
       If your host has hardware virt acceleration, then with a hot cache libguestfs should be able to start up
       in a few seconds.  Run the following command a few times:

        time guestfish -a /dev/null run

       After a few runs, the time should settle down to a few seconds (under 3 seconds on fast 64 bit hardware).

       If the command above does not work at all, use <b><a href="../man1/libguestfs-test-tool.1.html">libguestfs-test-tool</a></b>(1).

   <b>Check</b> <b>which</b> <b>version</b> <b>of</b> <b>libguestfs,</b> <b>qemu,</b> <b>libvirt,</b> <b>etc</b> <b>is</b> <b>being</b> <b>used.</b>
       Look at the output of "libguestfs-test-tool" and check:

       •   Which version of libguestfs is being used?  Near the beginning of the output you'll see a line like:

            library version: 1.22.0fedora=19,release=1.fc19,libvirt

       •   Is libvirt being used?  You can tell the difference by looking for the backend:

            guestfs_get_backend: direct

           or:

            guestfs_get_backend: libvirt

       •   Which version of qemu is being used?  It may be printed out:

            libguestfs: qemu version 1.5

       •   Which  kernel  is  being  used?   <b><a href="../man1/supermin.1.html">supermin</a></b>(1)  will  try  to pick the latest kernel installed on your
           machine.  You can see the version in the appliance output, eg:

            [    0.000000] Linux version 3.9.2-200.fc18.x86_64 [...]

   <b>Try</b> <b>to</b> <b>open</b> <b>a</b> <b>local</b> <b>guest</b> <b>image</b> <b>with</b> <b>guestfish.</b>
       You can use any guest disk image for this test.  Make sure you use the "--ro" flag so  that  <b><a href="../man1/guestfish.1.html">guestfish</a></b>(1)
       will open the disk image read-only.

        guestfish --ro -a /path/to/disk.img -i

       If  the  command  is  successful,  it should print out the guest operating system name and put you at the
       guestfish "&gt;&lt;fs&gt;" prompt.  You can use guestfish commands like "ll /" to look inside the disk image.   To
       exit, type "exit".

       If  you  get  an  error,  try  enabling  debugging  (add  "-v" to the command line).  Also make sure that
       <b><a href="../man1/libguestfs-test-tool.1.html">libguestfs-test-tool</a></b>(1) succeeds.

   <b>Try</b> <b>to</b> <b>open</b> <b>a</b> <b>remote</b> <b>guest</b> <b>image</b> <b>with</b> <b>guestfish.</b>
       You may also have to disable libvirt by setting this:

        export LIBGUESTFS_BACKEND=direct

       If you have a disk image available over HTTP/FTP, try to open it.

        guestfish --ro -i --format=raw -a <a href="http://www.example.com/disk.img">http://www.example.com/disk.img</a>

       For SSH you will need to make sure that ssh-agent is set up so you don't need a password to log in to the
       remote machine.  Then a command similar to this should work:

        guestfish --ro -i --format=raw \
          -a ssh://remote.example.com/path/to/disk.img

       If you get an error, try enabling debugging (add  "-v"  to  the  command  line).   Also  make  sure  that
       <b><a href="../man1/libguestfs-test-tool.1.html">libguestfs-test-tool</a></b>(1) succeeds.

   <b>Run</b> <b>virt-alignment-scan</b> <b>on</b> <b>all</b> <b>your</b> <b>guests.</b>
       Run <b><a href="../man1/virt-alignment-scan.1.html">virt-alignment-scan</a></b>(1) on guests or disk images:

        virt-alignment-scan -a /path/to/disk.img

       or:

        virt-alignment-scan -d Guest

       Does the alignment report match how the guest partitions are aligned?

   <b>Run</b> <b>virt-cat</b> <b>on</b> <b>some</b> <b>files</b> <b>in</b> <b>guests.</b>
       <b><a href="../man1/virt-cat.1.html">virt-cat</a></b>(1) can display files from guests.  For a Linux guest, try:

        virt-cat LinuxGuest <a href="file:/etc/passwd">/etc/passwd</a>

       A recent feature is support for Windows paths, for example:

        virt-cat WindowsGuest 'c:\windows\win.ini'

       An  even  better  test is if you have a Windows guest with multiple drives.  Do "D:", "E:" etc paths work
       correctly?

   <b>*</b> <b>Copy</b> <b>some</b> <b>files</b> <b>into</b> <b>a</b> <b>shut</b> <b>off</b> <b>guest.</b>
       <b><a href="../man1/virt-copy-in.1.html">virt-copy-in</a></b>(1) can recursively copy files and directories into a guest or disk image.

        virt-copy-in -d Guest <a href="file:/etc">/etc</a> <a href="file:/tmp">/tmp</a>

       This should copy local directory <u><a href="file:/etc">/etc</a></u> to <u>/tmp/etc</u> in the guest (recursively).  If you boot the guest, can
       you see all of the copied files and directories?

       Shut the guest down and try copying multiple files and directories:

        virt-copy-in -d Guest <a href="file:/home">/home</a> <a href="file:/etc/issue">/etc/issue</a> <a href="file:/tmp">/tmp</a>

   <b>Copy</b> <b>some</b> <b>files</b> <b>out</b> <b>of</b> <b>a</b> <b>guest.</b>
       <b><a href="../man1/virt-copy-out.1.html">virt-copy-out</a></b>(1) can recursively copy files and directories out of a guest or disk image.

        virt-copy-out -d Guest <a href="file:/home">/home</a> .

       Note the final space and period in the command is not a typo.

       This should copy <u><a href="file:/home">/home</a></u> from the guest into the current directory.

   <b>Run</b> <b>virt-df.</b>
       <b><a href="../man1/virt-df.1.html">virt-df</a></b>(1) lists disk space.  Run:

        virt-df

       You can try comparing this to the results from <b><a href="../man1/df.1.html">df</a></b>(1) inside the guest, but there are some provisos:

       •   The guest must be idle.

       •   The guest disks must be synched using <b><a href="../man1/sync.1.html">sync</a></b>(1).

       •   Any action such as booting the guest will write log files causing the numbers to change.

       We don’t guarantee that the numbers will be identical even under these  circumstances.   They  should  be
       similar.  It would indicate a bug if you saw greatly differing numbers.

   <b>Try</b> <b>importing</b> <b>virt-df</b> <b>CSV</b> <b>output</b> <b>into</b> <b>a</b> <b>spreadsheet</b> <b>or</b> <b>database.</b>
       Run:

        virt-df --csv &gt; /tmp/report.csv

       Now  try  to load this into your favorite spreadsheet or database.  Are the results reproduced faithfully
       in the spreadsheet/database?

       <a href="http://www.postgresql.org/docs/8.1/static/sql-copy.html">http://www.postgresql.org/docs/8.1/static/sql-copy.html</a>
       <a href="http://dev.mysql.com/doc/refman/5.1/en/load-data.html">http://dev.mysql.com/doc/refman/5.1/en/load-data.html</a>

   <b>*</b> <b>Edit</b> <b>a</b> <b>file</b> <b>in</b> <b>a</b> <b>shut</b> <b>off</b> <b>guest.</b>
       <b><a href="../man1/virt-edit.1.html">virt-edit</a></b>(1) can edit files in guests.  Try this command on a RHEL or Fedora guest:

        virt-edit LinuxGuest /etc/sysconfig/network

       On other Linux guests try editing other files such as:

        virt-edit LinuxGuest /etc/motd

       Are the changes seen inside the guest when it is booted?

   <b>Display</b> <b>the</b> <b>filesystems</b> <b>/</b> <b>partitions</b> <b>/</b> <b>LVs</b> <b>in</b> <b>a</b> <b>guest.</b>
       <b><a href="../man1/virt-filesystems.1.html">virt-filesystems</a></b>(1) can be used to display filesystems in a guest.  Try this command on any disk image or
       guest:

        virt-filesystems -a /path/to/disk.img --all --long -h

       or:

        virt-filesystems -d Guest --all --long -h

       Do the results match what is seen in the guest?

   <b>Run</b> <b>virt-inspector</b> <b>on</b> <b>all</b> <b>your</b> <b>guests.</b>
       Use <b><a href="../man1/virt-inspector.1.html">virt-inspector</a></b>(1) to get a report on all of your guests or disk images:

        virt-inspector -a /path/to/disk.img | less

       or:

        virt-inspector -d Guest | less

       Do the results match what is actually in the guest?

       If you have an unusual guest (a rare Linux distro, a very new version of  Windows),  does  virt-inspector
       recognize it?  If not, then it's probably a bug.

   <b>Try</b> <b>the</b> <b>auditing</b> <b>features</b> <b>of</b> <b>virt-ls</b> <b>on</b> <b>all</b> <b>your</b> <b>guests.</b>
       List all setuid or setgid programs in a Linux virtual machine:

        virt-ls -lR -d Guest / | grep '^- [42]'

       List all public-writable directories in a Linux virtual machine:

        virt-ls -lR -d Guest / | grep '^d ...7'

       List all Unix domain sockets in a Linux virtual machine:

        virt-ls -lR -d Guest / | grep '^s'

       List all regular files with filenames ending in ‘.png’:

        virt-ls -lR -d Guest / | grep -i '^-.*\.png$'

       Display files larger than 10MB in home directories:

        virt-ls -lR -d Guest <a href="file:/home">/home</a> | awk '$3 &gt; 10*1024*1024'

       Find everything modified in the last 7 days:

        virt-ls -lR -d Guest --time-days / | awk '$6 &lt;= 7'

       Find regular files modified in the last 24 hours:

        virt-ls -lR -d Guest --time-days / | grep '^-' | awk '$6 &lt; 1'

       Do the results match what is in the guest?

   <b>Create</b> <b>a</b> <b>disk</b> <b>image</b> <b>from</b> <b>a</b> <b>tarball.</b>
       Use <b><a href="../man1/virt-make-fs.1.html">virt-make-fs</a></b>(1) to create a disk image from any tarball that you happen to have:

        virt-make-fs --partition=mbr --type=vfat /any/tarball.tar.gz output.img

       Add  ‘output.img’  as  a raw disk to an existing guest.  Check the guest can see the files.  This test is
       particularly useful if you try it with a Windows guest.

       Try other partitioning schemes, eg. <u>--partition=gpt</u>.

       Try other filesystem formats, eg. <u>--type=ntfs</u>, <u>--type=ext2</u>.

   <b>*</b> <b>Run</b> <b>virt-rescue</b> <b>on</b> <b>a</b> <b>shut</b> <b>off</b> <b>disk</b> <b>image</b> <b>or</b> <b>guest.</b>
       Use <b><a href="../man1/virt-rescue.1.html">virt-rescue</a></b>(1) to examine, rescue or repair a <b>shut</b> <b>off</b> guest or disk image:

        virt-rescue -a /path/to/disk.img

       or:

        virt-rescue -d Guest

       Can you use ordinary shell commands to examine the guest?

   <b>*</b> <b>Resize</b> <b>your</b> <b>guests.</b>
       Use <b><a href="../man1/virt-resize.1.html">virt-resize</a></b>(1) to give a guest some more disk space.  For example, if you have a disk image  that  is
       smaller than 30G, increase it to 30G by doing:

        truncate -s 30G newdisk.img
        virt-filesystems -a /path/to/olddisk.img --all --long -h
        virt-resize /path/to/olddisk.img newdisk.img --expand /dev/sda1
        qemu-kvm -m 1024 -hda newdisk.img

       Does the guest still boot?  Try expanding other partitions.

   <b>*</b> <b>Sparsify</b> <b>a</b> <b>guest</b> <b>disk.</b>
       Using <b><a href="../man1/virt-sparsify.1.html">virt-sparsify</a></b>(1), make a disk image more sparse:

        virt-sparsify /path/to/olddisk.img newdisk.img

       Is  <u>newdisk.img</u>  still  bootable  after  sparsifying?   Is  the resulting disk image smaller (use "du" to
       check)?

   <b>Build</b> <b>and</b> <b>boot</b> <b>a</b> <b>guest</b>
       Using <b><a href="../man1/virt-builder.1.html">virt-builder</a></b>(1), choose a guest from the list:

        virt-builder -l

       build it:

        virt-builder -o disk.img [os-version from list above]

       and boot it:

        qemu-kvm -cpu host -m 2048 -drive file=disk.img,format=raw

       Does it boot?

   <b>*</b> <b>"Sysprep"</b> <b>a</b> <b>shut</b> <b>off</b> <b>Linux</b> <b>guest.</b>
       <b>Note</b> that this really will mess up an existing guest, so it's better to clone  the  guest  before  trying
       this.

        virt-sysprep --hostname newhost.example.com -a /path/to/disk.img

       Was the sysprep successful?  After booting, what changes were made and were they successful?

   <b>Dump</b> <b>the</b> <b>Windows</b> <b>Registry</b> <b>from</b> <b>your</b> <b>Windows</b> <b>guests.</b>
       Use <b><a href="../man1/virt-win-reg.1.html">virt-win-reg</a></b>(1) to dump out the Windows Registry from any Windows guests that you have.

        virt-win-reg --unsafe-printable-strings WindowsGuest 'HKLM\Software' |
          less

        virt-win-reg --unsafe-printable-strings WindowsGuest 'HKLM\System' |
          less

       Does the output match running "regedit" inside the guest?

       A recent feature is the ability to dump user registries, so try this, replacing <u>username</u> with the name of
       a local user in the guest:

        virt-win-reg --unsafe-printable-strings WindowsGuest 'HKEY_USERS\username' |
          less

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/guestfs.3.html">guestfs</a></b>(3), <b><a href="../man1/guestfish.1.html">guestfish</a></b>(1), <b><a href="../man3/guestfs-examples.3.html">guestfs-examples</a></b>(3), <a href="http://libguestfs.org/">http://libguestfs.org/</a>.

</pre><h4><b>AUTHORS</b></h4><pre>
       Richard W.M. Jones ("rjones at redhat dot com")

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2011-2023 Red Hat Inc.

</pre><h4><b>LICENSE</b></h4><pre>
       This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
       General  Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This library is distributed in the hope that it will be useful, but WITHOUT ANY  WARRANTY;  without  even
       the  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General
       Public License for more details.

       You should have received a copy of the GNU Lesser General Public License along with this library; if not,
       write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA

</pre><h4><b>BUGS</b></h4><pre>
       To     get      a      list      of      bugs      against      libguestfs,      use      this      link:
       https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools

       To       report       a       new       bug       against       libguestfs,      use      this      link:
       https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools

       When reporting a bug, please supply:

       •   The version of libguestfs.

       •   Where you got libguestfs (eg. which Linux distro, compiled from source, etc)

       •   Describe the bug accurately and give a way to reproduce it.

       •   Run <b><a href="../man1/libguestfs-test-tool.1.html">libguestfs-test-tool</a></b>(1) and paste the <b>complete,</b> <b>unedited</b> output into the bug report.

libguestfs-1.54.1                                  2025-02-18                                 <u><a href="../man1/guestfs-testing.1.html">guestfs-testing</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>