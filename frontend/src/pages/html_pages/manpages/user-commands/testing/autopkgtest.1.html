<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>autopkgtest - test an installed binary package using the source package's tests</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/autopkgtest">autopkgtest_5.47_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       autopkgtest - test an installed binary package using the source package's tests

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>autopkgtest</b> [<u>options</u>...]  [<u>testbinary</u>...]  <u>testsrc</u> <b>--</b> <u>virt-server</u> [<u>virt-server-arg</u>...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       autopkgtest runs tests on binary Debian packages, as installed on a system (called "testbed").  The tests
       are supplied in the source package.

       autopkgtest  runs  each  test  supplied  by  a particular package and reports the results.  It drives the
       specified virtualisation regime as appropriate, parses the test description metadata,  and  arranges  for
       data to be copied to and from the testbed as required.

       See   /usr/share/doc/autopkgtest/README.running-tests.rst.gz   for  an  introduction  about  how  to  use
       autopkgtest.

</pre><h4><b>TESTING</b> <b>A</b> <b>DEBIAN</b> <b>PACKAGE</b></h4><pre>
       Positional (non-option) arguments specify exactly one source  package  (containing  the  test  code)  and
       optionally some binary packages to test.

       testsrc can be one of:

       <b>.dsc</b> <b>file</b>
              Run  tests  from  Debian  <u>.dsc</u>  source  package. By default the package will also be built and the
              resulting binaries will be used to  satisfy  test  dependencies;  to  disable  that,  specify  the
              <b>-B</b>/<b>--no-built-binaries</b> option.

       <b>source</b> <b>package</b> <b>directory</b>
              Run tests from a Debian source tree directory. If that is an unbuilt tree, this is very similar to
              specifying  a  <b>.dsc</b>.  If  that  is  a  built  tree, all test dependencies get satisfied by archive
              packages, unless you explicitly specify locally built .debs as well.

              <b>Attention:</b> If you just specify a bare directory name which is a legal Debian source package  name,
              it will be interpreted as the latter (see below). In this case, prefix the directory name with <b>./</b>.

       <b>current</b> <b>directory</b>
              If no source package is specified on the command line and the current directory is a Debian source
              package, this will be tested.

       <b>source</b> <b>package</b> <b>name</b>
              Downloads the given source package name with <b>apt-get</b> <b>source</b> in the testbed and run its tests. This
              is  similar  to  specifying  a  .dsc  but  avoids copying the source from the host to the testbed.
              Possibly built binaries (if  the  test  specifies  <b>build-needed</b>)  will  <b>not</b>  be  used  to  satisfy
              dependencies, as usually in this mode you want to test binaries from a real archive.

       <b>git</b> <b>URL</b> <b>or</b> <b>URL#branch</b>
              Git-clones  the  given  URL  (which must contain an unbuilt Debian source tree) and runs the tests
              from that.  If <u>branch</u> is given, this branch will be checked out instead of  the  default  (usually
              "master").  This can also be a more general refspec such as #refs/pull/123/head" for a GitHub pull
              request.

              This is very similar to cloning manually and specifying the checkout  directory  as  test;  i.  e.
              this is commonly used with <b>--no-built-binaries</b>.  The <b>git</b> package will be installed if necessary.

       <b>.changes</b> <b>file</b>
              Run  tests  from the .dsc source package in the given .changes file. If the .changes contains .deb
              packages, they will be used for the test.  Acts as if you had specified the .debs  and  .dsc  from
              the  .changes  file  as  explicit  arguments.  Note  that  if the .changes contains <u>only</u> debs, the
              corresponding .dsc still needs to be specified alongside, or the current  directory  must  be  the
              source package.

       All  other  positional  arguments must be .deb binary packages. They will be used for both build and test
       dependencies of the source package. If any binary package is given, then <b>--no-built-binaries</b> is implied.

</pre><h4><b>TEST</b> <b>OPTIONS</b></h4><pre>
       <b>-a</b> ARCH <b>|</b> <b>--test-architecture=</b>ARCH

              Make the testbed  a  multiarch  system,  set  up  the  environment  for  cross-building  (possibly
              installing  extra build dependencies), and run tests for the specified foreign architecture rather
              than for the testbed native architecture. Assumes that ARCH binaries can be run  on  the  testbed,
              possibly via qemu-user-binfmt or qemu-user-static.

       <b>-B</b> | <b>--no-built-binaries</b>
              Binaries  from  unbuilt source packages (see above) will not be built or ignored, and dependencies
              are satisfied with packages from the archive. Note that the source package still gets built  if  a
              test requires <b>build-needed</b>.

       <b>--override-control=</b><u>PATH</u>
              Read the test metadata from <u>PATH</u> instead of <b>debian/tests/control</b>.

       <b>--test-name=</b><u>TEST</u>
              Run only the given test name (from test control file).  If this option is used more than once, all
              the named tests are run.

       <b>--skip-test=</b><u>TEST</u>
              Skip the given test name (from test control file).  If this option is used more than once, all the
              named tests are skipped.

</pre><h4><b>LOGGING</b> <b>OPTIONS</b></h4><pre>
       If you don't specify any option, <b>autopkgtest</b> only writes its output/results to stderr.

       <b>-o</b> <u>dir</u> <b>|</b> <b>--output-dir=</b><u>dir</u>
              Specifies  that  test  artifacts  (stderr  and  stdout  from the tests, the log file, built binary
              packages etc.) should be placed in the given directory.  <u>dir</u> must  not  exist  yet  or  be  empty,
              otherwise <b>autopkgtest</b> will refuse to use it.

       <b>-l</b> <u>logfile</u> <b>|</b> <b>--log-file=</b><u>logfile</u>
              Specifies that the trace log should be written to <u>logfile</u> instead of to <u>output-dir</u>.

       <b>--summary=</b><u>summary</u>
              Specifies  that  a summary of the outcome should be written to <u>summary</u>.  The events in the summary
              are written to the log in any case.

       <b>-q</b> | <b>--quiet</b>
              Do not send a copy of <b>autopkgtest</b>'s trace logstream to stderr.  This option does  not  affect  the
              copy  sent to <u>logfile</u> or <u>output-dir</u>.  Note that without the trace logstream it can be very hard to
              diagnose problems.

</pre><h4><b>TEST</b> <b>BED</b> <b>SETUP</b> <b>OPTIONS</b></h4><pre>
       <b>--setup-commands=</b><u>commands</u>
              Run <u>commands</u> before running any test, but after adding and  updating  APT  sources  specified  via
              <b>--add-apt-source</b>,  <b>--add-apt-release</b>, or <b>--apt-pocket</b>.  This can be used to do anything that isn't
              supported by an existing autopkgtest option. If <u>commands</u> is an existing file  name,  the  commands
              are  read  from  that; otherwise it is a string with the actual commands that gets run as-is. File
              names  without  directory  will   be   searched   in   both   the   current   directory   and   in
              <b>/usr/share/autopkgtest/setup-commands/</b>  so you do not need to give the full path for setup scripts
              shipped with autopkgtest.

              Normally, if the setup commands fail, autopkgtest will consider this  a  transient  testbed  error
              (exit  code 16). However, if the setup commands exit with code 100, autopkgtest will consider this
              an "erroneous package" (exit code 12) instead, so this can be used to e. g. detect upgrade  errors
              to a new version. Note that apt exits with exit code 100 in these cases.

              This option can be specified multiple times.

              If   <b>--user</b>   is   given  or  the  test  bed  provides  a  <b>suggested-normal-user</b>  capability,  the
              <b>$AUTOPKGTEST_NORMAL_USER</b> environment variable will be set to that user.

              If the setup commands affect anything in boot directories (like <a href="file:/boot">/boot</a> or <a href="file:/lib/systemd/system">/lib/systemd/system</a>)  and
              the testbed supports rebooting, the testbed will be rebooted after the setup commands. This can be
              suppressed by creating a file <b>/run/autopkgtest_no_reboot.stamp</b>.

       <b>--setup-commands-boot=</b><u>commands</u>
              Run <u>commands</u> after the <b>--setup-commands</b>, and after every reboot. For example, these commands could
              be used to add files in a tmpfs.

              These  commands  never  cause  the  testbed to be rebooted (because that could lead to an infinite
              loop). Otherwise, they are just like the <b>--setup-commands</b>.

              This option can be specified multiple times.

       <b>--add-apt-source='</b><u>deb</u>|<u>deb-src</u> [ <u>options</u> ] <u>MIRROR</u> <u>SUITE</u> <u>COMPONENT</u>...<b>'</b>

       <b>--add-apt-source=ppa:</b>[<u>USER</u><b>:</b><u>TOKEN</u><b>@</b>]<u>OWNER</u><b>/</b><u>PPA</u>[<b>:</b><u>FINGERPRINT</u>]

       <b>--add-apt-source=</b><u>FILENAME</u>

              Add the given apt source to the APT sources.list.  Specifying  this  option  triggers  an  <b>apt-get</b>
              <b>update</b>.   Multiple  sources  can  be  specified  at  once  by  separating them with a newline, but
              specifying this option multiple times is to be preferred instead.

              When the <b>ppa:</b> syntax is used, both binary ("deb") and source ("deb-src") entries are added.  Also,
              when <u>USER</u> and <u>TOKEN</u> are specified, then the PPA in assumed to be private and <u>FINGERPRINT</u> becomes a
              mandatory field.  Note that autopkgtest can leak <u>TOKEN</u> in many ways, notably when running in debug
              mode. If credentials are private then autopkgtest should be run on a trusted platform.

              When the <b>FILENAME</b> syntax is used, the contents of the specified file are configured as sources  on
              the testbed. <u>FILENAME</u> should end with <u>.list</u> or <u>.sources</u>.

       <b>--add-apt-release=</b><u>RELEASE</u>
              Add the given <u>RELEASE</u> to the APT sources.list.  Mirrors, components and options are taken from the
              release  appearing  first  in the existing APT sources.list; any "deb" sources.list entry for this
              release will used as a template for adding <u>RELEASE</u>.  Both binary ("deb")  and  source  ("deb-src")
              entries  are  added.   Specifying  this  option  triggers  an  <b>apt-get</b> <b>update</b>.  This option can be
              specified multiple times.

              Note that autopkgtest ignores the "NotAutomatic: yes" setting that  added  releases  may  declare,
              e.g.  Debian  "experimental", the Debian "backports" pocket, or the Ubuntu "proposed" pocket since
              24.04 LTS (Noble Numbat).

       <b>--apt-pocket=</b><u>POCKET</u>[<b>=</b><u>PACKAGELIST</u>]
              Add the given <u>POCKET</u> to the APT sources.list.  The pocket "base" release assumed to be  the  first
              configured    release   in   the   APT   sources.list.    This   is   equivalent   to   specifying
              <b>--add-apt-release=</b><u>BASE-POCKET</u> where <u>BASE</u> is the pocket base release.

              Specifying <u>PACKAGELIST</u> allows to pull only specific packages from the pocket. It is equivalent  to
              <b>--pin-packages=</b><u>BASE-POCKET</u><b>=</b><u>PACKAGELIST</u>,  where  <u>BASE</u>  is the pocket base release as defined above.
              Refer to <b>--pin-packages</b> for more information on the <u>PACKAGELIST</u> syntax.

       <b>--pin-packages=</b><u>RELEASE</u><b>=</b><u>PACKAGE</u>[<b>,</b><u>PACKAGE2</u><b>,...</b>]
              Set up apt pinning to use only specified packages from <u>RELEASE</u>.  This can be used  for  minimizing
              dependencies  taken  from  <u>RELEASE</u>  so  that  package  updates  in  that  release  can  be  tested
              independently from each other for better isolation.  If <u>PACKAGE</u> is  specified  as  <b>src:</b><u>SRCPACKAGE</u>,
              pinning will cover all binary packages built by source package <u>SRCPACKAGE</u>.

              <b>Attention:</b>  This  does  not  currently  resolve  some  situations  where dependencies of the given
              packages can only be resolved in <u>RELEASE</u>.  In this case  the  apt  pinning  will  be  removed  and
              package  installation  will  be  retried with the entirety of <u>RELEASE</u>, unless <b>--no-apt-fallback</b> is
              specified.

       <b>--no-apt-fallback</b>
              Disable  the  apt-get  fallback  which  is  used  with  <b>--pin-packages</b>  or  <b>--apt-pocket</b>  in  case
              installation of dependencies fails due to strict pinning.

       <b>--apt-upgrade</b> | <b>-U</b>
              Run   <b>apt-get</b>   <b>update</b>,  <b>upgrade</b>,  <b>autopurge</b>  in  the  testbed  before  running  the  tests.   Any
              <b>--add-apt-source</b> or <b>--apt-pocket</b> options take effect first, so this  will  upgrade  packages  from
              those sources if appropriate.

       <b>--apt-default-release=</b><u>SUITE</u>
              Select  the  release  that should provide the test dependencies that are not explicitly pinned via
              <b>--apt-pocket</b> or <b>--pin-packages</b>.  Specifying  this  option  is  normally  not  necessary:  suitable
              pinning it configured automatically. This option is equivalent to setting <b>APT::Default-Release</b>.

       <b>--copy=</b><u>HOSTPATH:TESTBEDPATH</u>
              Copy  file or directory from host into testbed after opening. This happens before <b>--setup-commands</b>
              thus you can use these files in the setup commands.

       <b>--env=</b><u>VAR=value</u>
              Set arbitrary environment variable in the build and test. Can be specified multiple times.

       <b>--ignore-restrictions=</b><u>RESTRICTION</u><b>,</b><u>RESTRICTION...</u>
              If a test would normally be skipped because it has <b>Restrictions:</b> <u>RESTRICTION</u>, run it  anyway.  Can
              be specified multiple times.

              For example, you might ignore the restriction <b>isolation-machine</b> when using the <b>null</b> virtualization
              server  if  you  know  that  <b>autopkgtest</b> itself is running on an expendable virtual machine. These
              options also work for unknown restrictions, so they  can  be  used  when  experimenting  with  new
              restrictions.

</pre><h4><b>USER/PRIVILEGE</b> <b>HANDLING</b> <b>OPTIONS</b></h4><pre>
       <b>-u</b> <u>user</u> <b>|</b> <b>--user=</b><u>user</u>
              Run  builds  and  tests  as  <u>user</u>  on the testbed.  This needs root on the testbed; if root on the
              testbed is not available then builds and tests run as whatever user is provided.

       <b>--gain-root=</b><u>gain-root</u>
              Prefixes <b>debian/rules</b> <b>binary</b> with gain-root<b>.</b>  The default is not to use anything, except  that  if
              <b>--user</b> is supplied or root on the testbed is not available the default is <b>fakeroot</b>.

</pre><h4><b>DEBUGGING</b> <b>OPTIONS</b></h4><pre>
       <b>--debug</b>|<b>-d</b>
              Include  additional  debugging  information  in  the  trace log.  Each additional <b>-d</b> increases the
              debugging level; the current maximum is <b>-ddd</b>.  If you like to see what's going on, -d  <b>or</b>  -dd  <b>is</b>
              <b>recommended.</b>

       <b>--shell-fail</b>|<b>-s</b>
              Run an interactive shell in the testbed after a failed build, test, or dependency installation.

       <b>--shell</b>
              Run an interactive shell in the testbed after every test.

</pre><h4><b>TIMEOUT</b> <b>OPTIONS</b></h4><pre>
       <b>--timeout</b>=<u>seconds</u>
              Define the global timeout, limiting the time allowed to perform the build (if one is required) and
              run  the  tests. If the global timeout is reached during the build, the run will be aborted in the
              same way as if the build had failed.  If the global timeout is exceeded while running a test,  the
              test is aborted and any remaining tests are skipped. (default: 0s, meaning a global timeout is not
              in effect). The value must be specified as an integer number of seconds.

       <b>--timeout-</b><u>which</u><b>=</b><u>seconds</u>
              Use  a  different timeout for operations on or with the testbed.  There are five timeouts affected
              by five values of <u>which</u>: <b>short</b>: supposedly short operations like setting up the testbed's apt  and
              checking  the  state  (default:  100s);  <b>install</b>:  installation of packages including dependencies
              (default: 3,000s); <b>test</b>: test runs (default: 10,000s); <b>copy</b>: copy files/directories  between  host
              and  testbed  (default: 300s); and <b>build</b>: builds (default: 100,000s).  The value must be specified
              as an integer number of seconds.

       <b>--timeout-factor</b>=<u>double</u>
              Multiply all of the default timeouts by the specified factor (see  <b>--timeout-</b><u>which</u>  above).   Only
              the defaults are affected; explicit timeout settings are used exactly as specified.

</pre><h4><b>LOCALE</b> <b>OPTIONS</b></h4><pre>
       <b>--set-lang=</b><u>langval</u>
              When  running commands on the testbed, sets the <b>LANG</b> environment variable to <u>langval</u>.  The default
              in <b>autopkgtest</b> is to set it to <b>C.UTF-8</b>.

</pre><h4><b>OTHER</b> <b>OPTIONS</b></h4><pre>
       <b>--no-auto-control</b>
              Disable automatic test generation with autodep8, even if it is installed. In that  case,  packages
              without tests will exit with code 8 ("No tests in this package") just like without autodep8.

       <b>--build-parallel=</b><u>N</u>
              Set  <u>parallel=N</u> DEB_BUILD_OPTION for building packages. By default this is the number of available
              processors. This is mostly useful in containers where you can restrict the available RAM, but  not
              restrict the number of CPUs.

       <b>--needs-internet=</b><u>run</u><b>|</b><u>try</u><b>|</b><u>skip</u>
              Define  how  to  handle  the  needs-internet  restriction.  With  "try"  tests with needs-internet
              restrictions will be run, but if they fail they will be treated as flaky tests. With "skip"  these
              tests  will  skipped  immediately  and  will  not  be run. With "run" the restriction is basically
              ignored, this is the default.

       <b>-V</b>|<b>--validate</b>
              Validate the test control file and exit without running any tests.

       <b>-h</b>|<b>--help</b>
              Show command line help and exit.

</pre><h4><b>VIRTUALIZATION</b> <b>SERVER</b></h4><pre>
       <b>--</b> <u>virt-server</u> <u>virt-server-arg</u>...
              Specifies the virtualisation regime server, as a command and arguments to invoke.

              In the autopkgtest invocation,  all  the  arguments  and  options  after  <b>--</b>  are  passed  to  the
              virtualisation server.

       The   autopkgtest  package  provides  several  virtualisation  servers,  named  <b>autopkgtest-virt-*</b>  (e.g.
       <b>autopkgtest-virt-qemu</b>, <b>autopkgtest-virt-unshare</b>, ...), each coming with its own  manpage.   When  one  if
       these virtualisation servers is to be used, the <b>autopkgtest-virt-</b> prefix in the command can be omitted.

       The  virtualisation  server  choice depends on several factors, such as the desired level of isolation of
       the testbed and the user's preference towards specific tools. If unsure, the <b>qemu</b> virt server  offers  VM
       isolation  (thus  allowing  tests  with  the isolation-machine restriction) and only relies on QEMU being
       available. See <a href="../man1/autopkgtest-virt-qemu.1.html">autopkgtest-virt-qemu</a>(1) for more information.

</pre><h4><b>OUTPUT</b> <b>FORMAT</b></h4><pre>
       During a normal test run, one line is printed for each test.  This consists of a short string identifying
       the test, some horizontal whitespace, and one of <b>PASS</b>, <b>PASS</b> <u>details</u>, <b>FAIL</b> <u>reason</u>, <b>SKIP</b> <u>reason</u>,  or  <b>FLAKY</b>
       <u>reason</u>  where  the  pass/fail  indication  is  separated  by  any  reason  or  details by some horizontal
       whitespace.

       The string to identify the test consists of a  short  alphanumeric  string  invented  by  <b>autopkgtest</b>  to
       distinguish different command-line arguments, the <u>argid</u>, followed by a hyphen and the test name.

       <b>SKIP</b>  indicates  that  a  test  was not run, or that the test code was started but detected that the test
       could not complete, for instance because a required resource was not available.

       <b>FLAKY</b> indicates that a test would ordinarily have failed, but because this particular test is known to be
       unreliable, the failure was ignored.

       Sometimes a <b>SKIP</b> will be reported when the name of the test is not known or not applicable: for  example,
       when  there  are  no  tests  in  the  package,  or  a  there is a test stanza which contains features not
       understood by this version of <b>autopkgtest</b>.  In this case <b>*</b> will appear where the name of the test  should
       be.

       If  <b>autopkgtest</b>  detects  that  erroneous  package(s)  are  involved,  it will print the two lines <b>blame:</b>
       <u>blamed-thing</u><b>...</b>  and <b>badpkg:</b> <u>message</u>.  Here each whitespace-separated <u>blamed-thing</u> is one of <b>arg:</b><u>argument</u>
       (representing a pathname found in  a  command  line  argument),  <b>dsc:</b><u>package</u>  (a  source  package  name),
       <b>deb:</b><u>package</u>  (a  binary  package  name) or possibly other strings to be determined.  This indicates which
       arguments and/or packages might have contributed to the problem;  the  ones  which  were  processed  most
       recently and which are therefore most likely to be the cause of a problem are listed last.

       Other possible errors are: <b>erroneous</b> <b>package:</b> <u>message</u>, <b>testbed</b> <b>failure:</b> <u>message</u>, or <b>quitting:</b> <u>message</u>.

</pre><h4><b>CONFIGURATION</b> <b>FILES</b></h4><pre>
       If  you use lots of options or nontrivial virt server arguments, you can put any part of the command line
       into a text file, with one line per option. E. g. you can create a file <u>sid.cfg</u> with contents like

              -s
              --output-dir=/tmp/testout
              --apt-upgrade
              --
              qemu
              /path/to/sid.img

       and then run

              autopkgtest foo_1_amd64.changes @sid.cfg

       The contents of the configuration file will be expanded in-place as if you would have given its  contents
       on  the  command  line. Please ensure that you <b>don't</b> <b>place</b> <b>spaces</b> between short options and their values,
       they would become a part of the argument value.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       0    all tests passed
       2    at least one test was skipped (or at least one flaky test failed)
       4    at least one test failed
       6    at least one test failed and at least one test skipped
       8    no tests in this package, or all non-superficial tests were skipped
       12   erroneous package
       14   erroneous package and at least one test skipped
       16   testbed failure
       20   other unexpected failures including bad usage

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>/usr/share/doc/autopkgtest/README.running-tests.rst.gz</b>
       <b>/usr/share/doc/autopkgtest/README.package-tests.rst.gz</b>

</pre><h4><b>AUTHORS</b> <b>AND</b> <b>COPYRIGHT</b></h4><pre>
       This manpage is part of autopkgtest, a tool for testing Debian binary packages.  autopkgtest is Copyright
       (C) 2006-2014 Canonical Ltd.

       See <b>/usr/share/doc/autopkgtest/CREDITS</b> for the list of contributors and full copying conditions.

autopkgtest                                           2014                                        <u><a href="../man1/autopkgtest.1.html">autopkgtest</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>