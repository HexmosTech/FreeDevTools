<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kyua debug — Executes a single test case with facilities for debugging</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/kyua">kyua_0.13+git20240311+0a43bb8d89e3-3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       kyua debug — Executes a single test case with facilities for debugging

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>kyua</b> <b>debug</b> [<b>--build-root</b> <u>path</u>] [<b>--kyuafile</b> <u>file</u>] [<b>--stdout</b> <u>path</u>] [<b>--stderr</b> <u>path</u>] <u>test_case</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>kyua</b>  <b>debug</b>  command  provides  a mechanism to execute a single test case bypassing some of the Kyua
       infrastructure and allowing the user to poke into the execution behavior of the test.

       The test case to run is selected by providing a test filter, described  below  in  “Test  filters”,  that
       matches  a single test case.  The test case is executed and its result is printed as the last line of the
       output of the tool.

       The test executed by <b>kyua</b> <b>debug</b> is run under a controlled environment as described in “Test isolation”.

       At the moment, the <b>kyua</b> <b>debug</b> command allows the following  aspects  of  a  test  case  execution  to  be
       tweaked:

       <b>•</b>   Redirection  of the test case's stdout and stderr to the console (the default) or to arbitrary files.
           See the <b>--stdout</b> and <b>--stderr</b> options below.

       The following subcommand options are recognized:

       <b>--build-root</b> <u>path</u>
           Specifies the build root in which to find the test programs referenced by the Kyuafile, if  different
           from the Kyuafile's directory.  See “Build directories” below for more information.

       <b>--kyuafile</b> <u>file</u>, <b>-k</b> <u>file</u>
           Specifies the Kyuafile to process.  Defaults to <u>Kyuafile</u> file in the current directory.

       <b>--stderr</b> <u>path</u>
           Specifies  the  file  to which to send the standard error of the test program's body.  The default is
           <u>/dev/stderr</u>, which is a special character device that redirects the output to standard error  on  the
           console.

       <b>--stdout</b> <u>path</u>
           Specifies  the  file to which to send the standard output of the test program's body.  The default is
           <u>/dev/stdout</u>, which is a special character device that redirects the output to standard output on  the
           console.

       For example, consider the following Kyua session:

             $ kyua test
             kernel/fs:mkdir  -&gt;  passed
             kernel/fs:rmdir  -&gt;  failed: Invalid argument

             1/2 passed (1 failed)

       At  this  point, we do not have a lot of information regarding the failure of the ‘kernel/fs:rmdir’ test.
       We can run this test through the <b>kyua</b> <b>debug</b> command to inspect its output a bit closer, hoping  that  the
       test case is kind enough to log its progress:

             $ kyua debug kernel/fs:rmdir
             Trying rmdir('foo')
             Trying rmdir(NULL)
             kernel/fs:rmdir  -&gt;  failed: Invalid argument

       Luckily,  the  offending  test  case was printing status lines as it progressed, so we could see the last
       attempted call and we can know match the failure message to the problem.

   <b>Build</b> <b>directories</b>
       <u>Build</u> <u>directories</u> (or object directories, target directories, product directories, etc.) is  the  concept
       that  allows  a developer to keep the source tree clean from build products by asking the build system to
       place such build products under a separate subtree.

       Most build systems today support build directories.  For example, the GNU Automake/Autoconf build  system
       exposes such concept when invoked as follows:

             $ cd my-project-1.0
             $ mkdir build
             $ cd build
             $ ../configure
             $ make

       Under  such  invocation,  all the results of the build are left in the <u>my-project-1.0/build/</u> subdirectory
       while maintaining the contents of <u>my-project-1.0/</u> intact.

       Because build directories are an integral part of most build systems, and because they are  a  tool  that
       developers use frequently, <b>kyua</b> <b>debug</b> supports build directories too.  This manifests in the form of <b>kyua</b>
       <b>debug</b>  being  able  to  run  tests  from build directories while reading the (often immutable) test suite
       definition from the source tree.

       One important property of build directories is that they follow (or need to follow) the exact same layout
       as the source tree.  For example, consider the following directory listings:

             src/Kyuafile
             src/bin/ls/
             src/bin/ls/Kyuafile
             src/bin/ls/ls.c
             src/bin/ls/ls_test.c
             src/sbin/su/
             src/sbin/su/Kyuafile
             src/sbin/su/su.c
             src/sbin/su/su_test.c

             obj/bin/ls/
             obj/bin/ls/ls*
             obj/bin/ls/ls_test*
             obj/sbin/su/
             obj/sbin/su/su*
             obj/sbin/su/su_test*

       Note how the directory layout within <u>src/</u> matches that of <u>obj/</u>.  The <u>src/</u> directory contains only  source
       files  and  the  definition of the test suite (the Kyuafiles), while the <u>obj/</u> directory contains only the
       binaries generated during a build.

       All commands that deal with the workspace support the <b>--build-root</b> <u>path</u>  option.   When  this  option  is
       provided, the directory specified by the option is considered to be the root of the build directory.  For
       example, considering our previous fake tree layout, we could invoke <b>kyua</b> <b>debug</b> as any of the following:

             $ kyua debug --kyuafile=src/Kyuafile --build-root=obj
             $ cd src &amp;&amp; kyua debug --build-root=../obj

   <b>Test</b> <b>filters</b>
       A  <u>test</u>  <u>filter</u>  is  a string that is used to match test cases or test programs in a test suite.  Filters
       have the following form:

             test_program_name[:test_case_name]

       Where ‘test_program_name’ is the name of a test  program  or  a  subdirectory  in  the  test  suite,  and
       ‘test_case_name’ is the name of a test case.

   <b>Test</b> <b>isolation</b>
       The test programs and test cases run by <b>kyua</b> <b>debug</b> are all executed in a deterministic environment.  This
       known,  clean  environment  serves  to  make  the  test execution as reproducible as possible and also to
       prevent clashes between tests that may, for example, create auxiliary files with overlapping names.

       For plain test programs and for TAP test programs, the whole test program is run under a single  instance
       of the environment described in this page.  For ATF test programs (see <u><a href="../man7/atf.7.html">atf</a></u>(7)), each individual test case
       <u>and</u> test cleanup routine are executed in separate environments.

       Process space
           Each  test  is executed in an independent processes.  Corollary: the test can do whatever it wants to
           the current process (such as modify global variables) without having to undo such changes.

       Session and process group
           The test is executed in its own session and its own process group.  There is no controlling  terminal
           attached to the session.

           Should  the test spawn any children, the children should maintain the same session and process group.
           Modifying any of these settings prevents <b>kyua</b> <b>debug</b> from being able to kill any stray  subprocess  as
           part of the cleanup phase.  If modifying these settings is necessary, or if any subprocess started by
           the test decides to use a different process group or session, it is the responsibility of the test to
           ensure those subprocesses are forcibly terminated during cleanup.

       Work directory
           The  test  is  executed  in  a  temporary  directory  automatically  created  by  the runtime engine.
           Corollary: the test can write to its current directory without needing  to  clean  any  files  and/or
           directories  it  creates.   The  runtime  engine  takes  care  to  recursively  delete  the temporary
           directories after the execution of a test case.   Any  file  systems  mounted  within  the  temporary
           directory are also unmounted.

       Home directory
           The <u>HOME</u> environment variable is set to the absolute path of the work directory.

       Umask
           The value of the umask is set to 0022.

       Environment
           The  <u>LANG</u>,  <u>LC_ALL</u>,  <u>LC_COLLATE</u>, <u>LC_CTYPE</u>, <u>LC_MESSAGES</u>, <u>LC_MONETARY</u>, <u>LC_NUMERIC</u> and <u>LC_TIME</u> variables
           are unset.

           The <u>TZ</u> variable is set to ‘UTC’.

           The <u>TMPDIR</u> variable is set to the absolute path of the work directory.  This is to prevent  the  test
           from  mistakenly  using  a  temporary  directory outside of the automatically-managed work directory,
           should the test use the <u><a href="../man3/mktemp.3.html">mktemp</a></u>(3) familiy of functions.

       Process limits
           The maximum soft core size limit is raised to its corresponding hard limit.  This is a simple,  best-
           effort attempt at allowing tests to dump core for further diagnostic purposes.

       Configuration varibles
           The  test  engine  may pass run-time configuration variables to the test program via the environment.
           The name of the configuration variable is prefixed with ‘TEST_ENV_’ so that a configuration  variable
           of the form ‘foo=bar’ becomes accessible in the environment as ‘TEST_ENV_foo=bar’.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       The <b>kyua</b> <b>debug</b> command returns 0 if the test case passes or 1 if the test case fails.

       Additional exit codes may be returned as described in <u><a href="../man1/kyua.1.html">kyua</a></u>(1).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/kyua.1.html">kyua</a></u>(1), <u><a href="../man5/kyuafile.5.html">kyuafile</a></u>(5)

Debian                                          October 13, 2014                                   <u><a href="../man1/KYUA-DEBUG.1.html">KYUA-DEBUG</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>