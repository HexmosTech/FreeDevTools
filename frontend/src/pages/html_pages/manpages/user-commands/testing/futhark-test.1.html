<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>futhark-test - test Futhark programs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/futhark">futhark_0.25.27-1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       futhark-test - test Futhark programs

</pre><h4><b>SYNOPSIS</b></h4><pre>
       futhark test [options…] infiles…

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Test  Futhark programs based on input/output datasets.  All contained <b>.fut</b> files within a given directory
       are considered.  By default, tests are carried out with compiled code.  This can be changed with  the  <b>-i</b>
       option.

       A  Futhark  test  program  is  an  ordinary  Futhark  program,  with  at  least one test block describing
       input/output test cases and possibly other options.  The last line must end in a newline.  A  test  block
       consists of commented-out text with the following overall format:

          description
          ==
          cases...

       The  <b>description</b> is an arbitrary (and possibly multiline) human-readable explanation of the test program.
       It is separated from the test cases by a line containing just <b>==</b>.  Any comment starting at the  beginning
       of the line, and containing a line consisting of just <b>==</b>, will be considered a test block.  The format of
       a test case is as follows:

          [tags { tags... }]
          [entry: names...]
          ["name..."] [compiled|nobench|random|script] input ({ values... } | @ filename)
          output { values... } | auto output | error: regex

       If a test case begins with a quoted string, that string is reported as the dataset name, including in the
       JSON  file  produced by <u>futhark-bench</u>.  If no name is provided, one is automatically generated.  The name
       must be unique across all test cases.

       If <b>compiled</b> is present before the <b>input</b> keyword, this test case will never be passed to the  interpreter.
       This  is  useful  for  test cases that are annoyingly slow to interpret.  The <b>nobench</b> keyword is for data
       sets that are too small to be worth benchmarking, and only has meaning to <u>futhark-bench</u>.

       If <b>input</b> is preceded by <b>random</b>, the text between the curly braces must consist of a sequence  of  Futhark
       types,  including  sizes  in  the  case  of  arrays.  When <b>futhark</b> <b>test</b> is run, a file located in a <b>data/</b>
       subdirectory, containing values of the indicated types and  shapes  is,  automatically  constructed  with
       <u>futhark-dataset</u>.   Apart  from sizes, integer constants (with or without type suffix), and floating-point
       constants (always with type suffix) are also permitted.

       If <b>input</b> is preceded by <b>script</b>, the text between the curly  braces  is  interpreted  as  a  FutharkScript
       expression  (see  <u>futhark-literate</u>), which is executed to generate the input.  It must use only functions
       explicitly declared as entry points. If the expression produces an <u>n</u>-element tuple, it will  be  unpacked
       and  its  components  passed  as  <u>n</u>  distinct  arguments to the test function. The only builtin functions
       supported are <b>$loaddata</b> and <b>$loadbytes</b>.

       If <b>input</b> is followed by an <b>@</b> and a file name (which must not contain any  whitespace)  instead  of  curly
       braces,  values  will  be  read  from the indicated file.  This is recommended for large data sets.  This
       notation cannot be used with <b>random</b> input.  With <b>script</b> <b>input</b>, the file contents will be interpreted as a
       FutharkScript expression.

       After the <b>input</b> block, the expected result of the test case is  written  as  either  <b>output</b>  followed  by
       another block of values, or <b>error:</b> followed by a regex indicating an expected run-time error.  If neither
       <b>output</b>  nor  <b>error</b> is given, the program will be expected to execute succesfully, but its output will not
       be validated.

       If <b>output</b> is preceded by <b>auto</b> (as in <b>auto</b> <b>output</b>), the expected values  are  automatically  generated  by
       compiling  the program with <b>futhark</b> <b>c</b> and recording its result for the given input (which must not fail).
       This is usually only useful for testing or benchmarking alternative compilers, and not  for  testing  the
       correctness of Futhark programs.  This currently does not work for <b>script</b> inputs.

       Alternatively,  instead  of input-output pairs, the test cases can simply be a description of an expected
       compile time type error:

          error: regex

       This is used to test the type checker.

       Tuple syntax is not supported when specifying input and output values.  Instead, you can write an N-tuple
       as its constituent N values.  Beware of syntax errors in the values - the errors reported by <b>futhark</b> <b>test</b>
       are very poor.

       An optional tags specification is permitted in the first test block.  This section can contain  arbitrary
       tags that classify the benchmark:

          tags { names... }

       Tag  are  sequences  of  alphanumeric  characters,  dashes,  and  underscores, with each tag seperated by
       whitespace.  Any program with the <b>disable</b> tag is ignored by <b>futhark</b> <b>test</b>.

       Another optional directive is <b>entry</b>, which specifies the entry point to be used  for  testing.   This  is
       useful for writing programs that test libraries with multiple entry points.  Multiple entry points can be
       specified  on  the  same  line  by  separating them with space, and they will all be tested with the same
       input/output pairs.  The <b>entry</b> directive affects subsequent input-output pairs in the same comment block,
       and may only be present immediately preceding these input-output pairs.  If no <b>entry</b> is  given,  <b>main</b>  is
       assumed.  See below for an example.

       For  many  usage examples, see the <b>tests</b> directory in the Futhark source directory.  A simple example can
       be found in <b>EXAMPLES</b> below.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--backend=</b><u>program</u>
              The backend used when compiling Futhark programs (without leading <b>futhark</b>, e.g. just <b>opencl</b>).

       <b>--cache-extension=</b><u>EXTENSION</u>
              For a program <b>foo.fut</b>, pass <b>--cache-file</b>  <b>foo.fut.EXTENSION</b>.   By  default,  <b>--cache-file</b>  is  not
              passed.

       <b>-c</b>     Only run compiled code - do not run the interpreter.  This is the default.

       <b>-C</b>     Compile the programs, but do not run them.

       <b>--concurrency=</b><u>NUM</u>
              The number of tests to run concurrently.  Defaults to the number of (hyper-)cores available.

       <b>--exclude=</b><u>tag</u>
              Do  not  run  test  cases  that contain the given tag.  Cases marked with “disable” are ignored by
              default, as are cases marked “no_foo”, where <u>foo</u> is the backend used.

       <b>-i</b>     Test with the interpreter.

       <b>-I</b>     Pass the program through the compiler frontend, but do not run them.   This  is  only  useful  for
              testing the Futhark compiler itself.

       <b>-t</b>     Type-check the programs, but do not run them.

       <b>-s</b>     Run <b>structure</b> tests. These are not run by default. When this option is passed, no other testing is
              done.

       <b>--futhark=</b><u>program</u>
              The  program used to perform operations (eg. compilation).  Defaults to the binary running <b>futhark</b>
              <b>test</b> itself.

       <b>--no-terminal</b>
              Change the output format to be suitable for noninteractive  terminals.  Prints  a  status  message
              roughly every minute.

       <b>--no-tuning</b>
              Do not look for tuning files.

       <b>--pass-option=</b><u>opt</u>
              Pass an option to benchmark programs that are being run.  For example, we might want to run OpenCL
              programs on a specific device:

                 futhark test prog.fut --backend=opencl --pass-option=-dHawaii

       <b>--pass-compiler-option=</b><u>opt</u>
              Pass an extra option to the compiler when compiling the programs.

       <b>--runner=</b><u>program</u>
              If  set  to  a non-empty string, compiled programs are not run directly, but instead the indicated
              <u>program</u> is run with its first argument being the path to the compiled Futhark  program.   This  is
              useful  for compilation targets that cannot be executed directly (as with <u>futhark-pyopencl</u> on some
              platforms), or when you wish to run the program on a remote machine.

       <b>--tuning=</b><u>EXTENSION</u>
              For each program being run, look for a tuning file with this extension, which is suffixed  to  the
              name  of  the program.  For example, given <b>--tuning=tuning</b> (the default), the program <b>foo.fut</b> will
              be passed the tuning file <b>foo.fut.tuning</b> if it exists.

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       <b>TMPDIR</b>
          Directory used for temporary files such as gunzipped datasets and log files.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following program tests simple indexing and bounds checking:

          -- Test simple indexing of an array.
          -- ==
          -- tags { firsttag secondtag }
          -- input { [4,3,2,1] 1i64 }
          -- output { 3 }
          -- input { [4,3,2,1] 5i64 }
          -- error: Error*

          let main (a: []i32) (i: i64): i32 =
            a[i]

       The following program contains two entry points, both of which are tested:

          let add (x: i32) (y: i32): i32 = x + y

          -- Test the add1 function.
          -- ==
          -- entry: add1
          -- input { 1 } output { 2 }

          entry add1 (x: i32): i32 = add x 1

          -- Test the sub1 function.
          -- ==
          -- entry: sub1
          -- input { 1 } output { 0 }

          entry sub1 (x: i32): i32 = add x (-1)

       The following program contains an entry point that is tested with randomly generated data:

          -- ==
          -- random input { [100]i32 [100]i32 } auto output
          -- random input { [1000]i32 [1000]i32 } auto output

          let main xs ys = i32.product (map2 (*) xs ys)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>futhark-bench</u>, <u>futhark-repl</u>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2013-2020, DIKU, University of Copenhagen

0.25.27                                           Mar 02, 2025                                   <u><a href="../man1/FUTHARK-TEST.1.html">FUTHARK-TEST</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>