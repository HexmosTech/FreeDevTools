<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>barman-cloud-backup - Barman-cloud Commands</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/barman-cli-cloud">barman-cli-cloud_3.12.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       barman-cloud-backup - Barman-cloud Commands

       <b>Synopsis</b>

          barman-cloud-backup
                          [ { -V | --version } ]
                          [ --help ]
                          [ { -v | --verbose } ]
                          [ { -q | --quiet } ]
                          [ { -t | --test } ]
                          [ --cloud-provider { aws-s3 | azure-blob-storage | google-cloud-storage } ]
                          [ { -z | --gzip } ]
                          [ { -j | --bzip2 } ]
                          [ --snappy ]
                          [ { -h | --host } HOST ]
                          [ { -p | --port } PORT ]
                          [ { -U | --user } USER ]
                          [ { -d | --dbname } DBNAME ]
                          [ { -n | --name } BACKUP_NAME ]
                          [ { -J | --jobs } JOBS ]
                          [ -S MAX_ARCHIVE_SIZE ]
                          [ --immediate-checkpoint ]
                          [ --min-chunk-size MIN_CHUNK_SIZE ]
                          [ --max-bandwidth MAX_BANDWIDTH ]
                          [ --snapshot-instance SNAPSHOT_INSTANCE ]
                          [ --snapshot-disk NAME ]
                          [ --tags [ TAGS ... ] ]
                          [ --endpoint-url ENDPOINT_URL ]
                          [ { -P | --aws-profile } AWS_PROFILE ]
                          [ --read-timeout READ_TIMEOUT ]
                          [ { -e | --encryption } ENCRYPTION ]
                          [ --sse-kms-key-id SSE_KMS_KEY_ID ]
                          [ --aws-region AWS_REGION ]
                          [ --aws-snapshot-lock-mode { compliance | governance } ]
                          [ --aws-snapshot-lock-duration DAYS ]
                          [ --aws-snapshot-lock-cool-off-period HOURS ]
                          [ --aws-snapshot-lock-expiration-date DATETIME ]
                          [ --azure-credential { azure-cli | managed-identity } ]
                          [ --encryption-scope ENCRYPTION_SCOPE ]
                          [ --azure-subscription-id AZURE_SUBSCRIPTION_ID ]
                          [ --azure-resource-group AZURE_RESOURCE_GROUP ]
                          [ --gcp-project GCP_PROJECT ]
                          [ --kms-key-name KMS_KEY_NAME ]
                          [ --gcp-zone GCP_ZONE ]
                          DESTINATION_URL SERVER_NAME

       <b>Description</b>

       The <b>barman-cloud-backup</b> script is used to create a local backup of a Postgres server and transfer it to a
       supported  cloud  provider,  bypassing  the  Barman  server. It can also be utilized as a hook script for
       copying Barman backups from the Barman server to one of the supported clouds (post_backup_retry_script).

       This script requires read access to PGDATA and tablespaces, typically run as the postgres user. When used
       on a Barman server, it requires read access  to  the  directory  where  Barman  backups  are  stored.  If
       <b>--snapshot-</b>  arguments  are  used  and snapshots are supported by the selected cloud provider, the backup
       will be performed using snapshots of the specified disks (<b>--snapshot-disk</b>). The backup label and metadata
       will also be uploaded to the cloud.

       <b>NOTE:</b>
          For GCP, only authentication with <b>GOOGLE_APPLICATION_CREDENTIALS</b> env is supported.

       <b>IMPORTANT:</b>
          The cloud upload may fail if any file larger than the configured <b>--max-archive-size</b> is present in  the
          data directory or tablespaces. However, Postgres files up to <b>1GB</b> are always allowed, regardless of the
          <b>--max-archive-size</b> setting.

       <b>Parameters</b>

       <b>SERVER_NAME</b>
              Name of the server to be backed up.

       <b>DESTINATION_URL</b>
              URL of the cloud destination, such as a bucket in AWS S3. For example: <b>s3://bucket/path/to/folder</b>.

       <b>-V</b> <b>/</b> <b>--version</b>
              Show version and exit.

       <b>--help</b> show this help message and exit.

       <b>-v</b> <b>/</b> <b>--verbose</b>
              Increase output verbosity (e.g., <b>-vv</b> is more than <b>-v</b>).

       <b>-q</b> <b>/</b> <b>--quiet</b>
              Decrease output verbosity (e.g., <b>-qq</b> is less than <b>-q</b>).

       <b>-t</b> <b>/</b> <b>--test</b>
              Test cloud connectivity and exit.

       <b>--cloud-provider</b>
              The cloud provider to use as a storage backend.

              Allowed options:

              • <b>aws-s3</b>.

              • <b>azure-blob-storage</b>.

              • <b>google-cloud-storage</b>.

       <b>-z</b> <b>/</b> <b>--gzip</b>
              gzip-compress the backup while uploading to the cloud (should not be used with python &lt; 3.2).

       <b>-j</b> <b>/</b> <b>--bzip2</b>
              bzip2-compress the backup while uploading to the cloud (should not be used with python &lt; 3.3).

       <b>--snappy</b>
              snappy-compress the backup while uploading to the cloud (requires optional <b>python-snappy</b> library).

       <b>-h</b> <b>/</b> <b>--host</b>
              Host or Unix socket for Postgres connection (default: libpq settings).

       <b>-p</b> <b>/</b> <b>--port</b>
              Port for Postgres connection (default: libpq settings).

       <b>-U</b> <b>/</b> <b>--user</b>
              User name for Postgres connection (default: libpq settings).

       <b>-d</b> <b>/</b> <b>--dbname</b>
              Database name or conninfo string for Postgres connection (default: "postgres").

       <b>-n</b> <b>/</b> <b>--name</b>
              A  name  which  can  be used to reference this backup in commands such as <b>barman-cloud-restore</b> and
              <b>barman-cloud-backup-delete</b>.

       <b>-J</b> <b>/</b> <b>--jobs</b>
              Number of subprocesses to upload data to cloud storage (default: <b>2</b>).

       <b>-S</b> <b>/</b> <b>--max-archive-size</b>
              Maximum size of an archive when uploading to cloud storage (default: <b>100GB</b>).

       <b>--min-chunk-size</b>
              Minimum size of an individual chunk when uploading to cloud storage (default: <b>5MB</b> for <b>aws-s3</b>, <b>64KB</b>
              for <b>azure-blob-storage</b>, not applicable for <b>google-cloud-storage</b>).

       <b>--max-bandwidth</b>
              The maximum amount of data to be uploaded per second when backing up to object storages  (default:
              <b>0</b> - no limit).

       <b>--snapshot-instance</b>
              Instance where the disks to be backed up as snapshots are attached.

       <b>--snapshot-disk</b>
              Name of a disk from which snapshots should be taken.

       <b>--tags</b> Tags to be added to all uploaded files in cloud storage, and/or to snapshots created, if snapshots
              are used.

       <b>Extra</b> <b>options</b> <b>for</b> <b>the</b> <b>AWS</b> <b>cloud</b> <b>provider</b>

       <b>--endpoint-url</b>
              Override default S3 endpoint URL with the given one.

       <b>-P</b> <b>/</b> <b>--aws-profile</b>
              Profile name (e.g. <b>INI</b> section in AWS credentials file).

       <b>--profile</b> <b>(deprecated)</b>
              Profile name (e.g. <b>INI</b> section in AWS credentials file) - replaced by <b>--aws-profile</b>.

       <b>--read-timeout</b>
              The  time in seconds until a timeout is raised when waiting to read from a connection (defaults to
              <b>60</b> seconds).

       <b>-e</b> <b>/</b> <b>--encryption</b>
              The encryption algorithm used when storing the uploaded data in S3.

              Allowed options:

              • <b>AES256</b>.

              • <b>aws:kms</b>.

       <b>--sse-kms-key-id</b>
              The AWS KMS key ID that should be used for encrypting the uploaded data in S3.  Can  be  specified
              using  the  key ID on its own or using the full ARN for the key. Only allowed if <b>-e</b> / <b>--encryption</b>
              is set to <b>aws:kms</b>.

       <b>--aws-region</b>
              The  name  of  the  AWS  region  containing  the  EC2  VM  and  storage  volumes  defined  by  the
              <b>--snapshot-instance</b> and <b>--snapshot-disk</b> arguments.

       <b>--aws-snapshot-lock-mode</b>
              The  lock mode for the snapshot. This is only valid if <b>--snapshot-instance</b> and <b>--snapshot-disk</b> are
              set.

              Allowed options:

              • <b>compliance</b>.

              • <b>governance</b>.

       <b>--aws-snapshot-lock-duration</b>
              The lock duration is the period of time (in days) for which the  snapshot  is  to  remain  locked,
              ranging from 1 to 36,500. Set either the lock duration or the expiration date (not both).

       <b>--aws-snapshot-lock-cool-off-period</b>
              The cooling-off period is an optional period of time (in hours) that you can specify when you lock
              a snapshot in <b>compliance</b> mode, ranging from 1 to 72.

       <b>--aws-snapshot-lock-expiration-date</b>
              The  lock  duration  is  determined by an expiration date in the future. It must be at least 1 day
              after the snapshot creation date and time, using the format <b>YYYY-MM-DDTHH:MM:SS.sssZ</b>.  Set  either
              the lock duration or the expiration date (not both).

       <b>Extra</b> <b>options</b> <b>for</b> <b>the</b> <b>Azure</b> <b>cloud</b> <b>provider</b>

       <b>--azure-credential</b> <b>/</b> <b>--credential</b>
              Optionally  specify  the type of credential to use when authenticating with Azure. If omitted then
              Azure Blob Storage credentials will be  obtained  from  the  environment  and  the  default  Azure
              authentication  flow  will  be  used  for  authenticating  with  all  other  Azure services. If no
              credentials can be found in the environment then the default Azure authentication flow  will  also
              be used for Azure Blob Storage.

              Allowed options:

              • <b>azure-cli</b>.

              • <b>managed-identity</b>.

       <b>--encryption-scope</b>
              The  name  of an encryption scope defined in the Azure Blob Storage service which is to be used to
              encrypt the data in Azure.

       <b>--azure-subscription-id</b>
              The ID of the Azure subscription which owns the  instance  and  storage  volumes  defined  by  the
              <b>--snapshot-instance</b> and <b>--snapshot-disk</b> arguments.

       <b>--azure-resource-group</b>
              The  name  of  the  Azure  resource  group  to which the compute instance and disks defined by the
              <b>--snapshot-instance</b> and <b>--snapshot-disk</b> arguments belong.

       <b>Extra</b> <b>options</b> <b>for</b> <b>GCP</b> <b>cloud</b> <b>provider</b>

       <b>--gcp-project</b>
              GCP project under which disk snapshots should be stored.

       <b>--snapshot-gcp-project</b> <b>(deprecated)</b>
              GCP project under which disk snapshots should be stored - replaced by <b>--gcp-project</b>.

       <b>--kms-key-name</b>
              The name of the GCP KMS key which should be used for encrypting the uploaded data in GCS.

       <b>--gcp-zone</b>
              Zone of the disks from which snapshots should be taken.

       <b>--snapshot-zone</b> <b>(deprecated)</b>
              Zone of the disks from which snapshots should be taken - replaced by <b>--gcp-zone</b>.

</pre><h4><b>AUTHOR</b></h4><pre>
       EnterpriseDB

</pre><h4><b>COPYRIGHT</b></h4><pre>
       © Copyright EnterpriseDB UK Limited 2011-2024

3.12                                              Dec 09, 2024                            <u><a href="../man1/BARMAN-CLOUD-BACKUP.1.html">BARMAN-CLOUD-BACKUP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>