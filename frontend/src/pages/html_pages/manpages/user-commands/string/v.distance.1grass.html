<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>v.distance  - Finds the nearest element in vector map ’to’ for elements in vector map ’from’.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/grass-doc">grass-doc_8.4.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>v.distance</b>  - Finds the nearest element in vector map ’to’ for elements in vector map ’from’.

</pre><h4><b>KEYWORDS</b></h4><pre>
       vector, distance, database, attribute table

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>v.distance</b>
       <b>v.distance</b> <b>--help</b>
       <b>v.distance</b>    [-<b>pas</b>]    <b>from</b>=<u>name</u>     [<b>from_layer</b>=<u>string</u>]      [<b>from_type</b>=<u>string</u>[,<u>string</u>,...]]    <b>to</b>=<u>name</u>
       [<b>to_layer</b>=<u>string</u>]     [<b>to_type</b>=<u>string</u>[,<u>string</u>,...]]     [<b>output</b>=<u>name</u>]      [<b>dmax</b>=<u>float</u>]      [<b>dmin</b>=<u>float</u>]
       <b>upload</b>=<u>string</u>[,<u>string</u>,...]         [<b>column</b>=<u>name</u>[,<u>name</u>,...]]         [<b>to_column</b>=<u>name</u>]         [<b>table</b>=<u>name</u>]
       [<b>separator</b>=<u>character</u>]   [--<b>overwrite</b>]  [--<b>help</b>]  [--<b>verbose</b>]  [--<b>quiet</b>]  [--<b>ui</b>]

   <b>Flags:</b>
       <b>-p</b>
           Print output to stdout, don’t update attribute table
           First column is always category of ’from’ feature called from_cat

       <b>-a</b>
           Calculate distances to all features within the threshold
           Output may be written to stdout using the ’-p’ flag or uploaded to a new table created by the ’table’
           option; multiple ’upload’ options may be used.

       <b>-s</b>
           Print output as square matrix (only possible for one single upload variable)

       <b>--overwrite</b>
           Allow output files to overwrite existing files

       <b>--help</b>
           Print usage summary

       <b>--verbose</b>
           Verbose module output

       <b>--quiet</b>
           Quiet module output

       <b>--ui</b>
           Force launching GUI dialog

   <b>Parameters:</b>
       <b>from</b>=<u>name</u> <b>[required]</b>
           Name of existing vector map (from)
           Or data source for direct OGR access

       <b>from_layer</b>=<u>string</u>
           Layer number or name (from)
           Vector features can have category values in different layers. This number determines which  layer  to
           use. When used with direct OGR access this is the layer name.
           Default: <u>1</u>

       <b>from_type</b>=<u>string[,string</u>,...]
           Feature type (from)
           Input feature type
           Options: <u>point,</u> <u>line,</u> <u>boundary,</u> <u>centroid,</u> <u>area</u>
           Default: <u>point,line,area</u>

       <b>to</b>=<u>name</u> <b>[required]</b>
           Name of existing vector map (to)
           Or data source for direct OGR access

       <b>to_layer</b>=<u>string</u>
           Layer number or name (to)
           Vector  features  can have category values in different layers. This number determines which layer to
           use. When used with direct OGR access this is the layer name.
           Default: <u>1</u>

       <b>to_type</b>=<u>string[,string</u>,...]
           Feature type (to)
           Input feature type
           Options: <u>point,</u> <u>line,</u> <u>boundary,</u> <u>centroid,</u> <u>area</u>
           Default: <u>point,line,area</u>

       <b>output</b>=<u>name</u>
           Name for output vector map containing lines connecting nearest elements

       <b>dmax</b>=<u>float</u>
           Maximum distance or -1 for no limit
           Map units, meters for ll
           Default: <u>-1</u>

       <b>dmin</b>=<u>float</u>
           Minimum distance or -1 for no limit
           Map units, meters for ll
           Default: <u>-1</u>

       <b>upload</b>=<u>string[,string</u>,...] <b>[required]</b>
           Values describing the relation between two nearest features
           Options: <u>cat,</u> <u>dist,</u> <u>to_x,</u> <u>to_y,</u> <u>to_along,</u> <u>to_angle,</u> <u>to_attr</u>
           <b>cat</b>: category of the nearest feature
           <b>dist</b>: minimum distance to nearest feature
           <b>to_x</b>: x coordinate of the nearest point on the ’to’ feature
           <b>to_y</b>: y coordinate of the nearest point on the ’to’ feature
           <b>to_along</b>: distance to the nearest point on the ’to’ feature along that linear feature
           <b>to_angle</b>: angle along the nearest linear feature in the ’to’ map, measured CCW from the +x  axis,  in
           radians, between -Pi and Pi inclusive
           <b>to_attr</b>: attribute of nearest feature given by to_column option

       <b>column</b>=<u>name[,name</u>,...]
           Column name(s) where values specified by ’upload’ option will be uploaded

       <b>to_column</b>=<u>name</u>
           Column name of nearest feature (used with upload=to_attr)

       <b>table</b>=<u>name</u>
           Name for new attribute table

       <b>separator</b>=<u>character</u>
           Field separator for printing output to stdout
           Special characters: pipe, comma, space, tab, newline
           Default: <u>pipe</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>v.distance</u>  finds  the  nearest  element  in  vector  map (<b>to</b>) for elements in vector map (<b>from</b>). Various
       information about the vectors’ relationships (distance, category, etc.) may be uploaded to the  attribute
       table  attached  to  the  first vector map, or printed to ’stdout’. A new vector map may be created where
       lines connecting nearest points on features are written. <b>dmin</b> and/or <b>dmax</b> can be used to limit the search
       radius (in lat-long projects to be given in meters since they are calculated as geodesic distances  on  a
       sphere).

       For lines to lines, say line A to line B, <u>v.distance</u> calculates the shortest distance of each vertex in A
       with each segment (not vertex) in B. The module then calculates the shortest distance of each vertex in B
       to  each segment in A. The overall shortest distance of A points to B segments and B points to A segments
       is used. Additionally,  <u>v.distance</u>  checks  for  intersections.  In  case  of  intersections,  the  first
       intersection found is used and the distance set to zero.

       For  lines to areas, the distance is set to zero if a line is (partially) inside an area. The first point
       of the line that is inside the area is used as common point. The distance is also set to zero if the line
       intersects with the outer ring or any of the inner rings (isles), in which case the fist intersection  is
       used as common point.

       For  areas  to  areas, the module checks first for overlap or if one area is (partially) inside the other
       area. This is computationally quite intensive. If the outer rings of the two areas do  not  overlap,  the
       distance  is  calculated  as  above for lines to lines, treating the outer rings as two lines. Again, the
       first point encountered falling into an area is used as common point, or the first intersection point.

       For anything else than points to lines, there can be several common locations with zero distance, and the
       common location would then be the result of an overlay consisting of several  points,  lines,  or  areas.
       <u>v.distance</u>  selects in these cases a single point, and does not create an overlay like <u>v.overlay</u>. In this
       implementation, any shared point is as good as any other. Calculating an intersection is costlier than to
       check if a vertex is inside a polygon. For example, if a vertex of the  boundary  of  the  ’to’  area  is
       inside  the ’from’ area, it is a common location. For speed reasons, the distance is then set to zero and
       no further tests are done.

</pre><h4><b>NOTES</b></h4><pre>
       If a nearest feature does not have a category, the attribute column is updated to NULL.

       The upload <b>column</b>(s) must already exist. Create one with <u>v.db.addcolumn</u>.

       In lat-long projects <u>v.distance</u> gives distances (<u>dist</u>, <u>from_along</u>, and <u>to_along</u>) not in  degrees  but  in
       meters calculated as geodesic distances on a sphere.

       If one or both of the input vector maps are 3D, the user is notified accordingly.

       The  <u>-p</u>  flag prints the results to standard output. By default the output is in form of a linear matrix.
       If only only variable is upploaded and a square matrix is desired, the user can set the <u>-s</u> flag.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Find</b> <b>nearest</b> <b>lines</b>
       Find <u>nearest</u> <u>lines</u> in vector map "ln" for points from vector map "pnt" within  the  given  threshold  and
       write related line categories to column "linecat" in an attribute table attached to vector map "pnt":
       v.distance from=pnt to=ln upload=cat column=linecat

   <b>Find</b> <b>nearest</b> <b>area</b>
       For  each point from vector map "pnt", find the <u>nearest</u> <u>area</u> from map "ar" within the given threshold and
       write the related area categories to column "areacat" in an attribute table attached to vector map  "pnt"
       (in the case that a point falls into an area, the distance is zero):
       v.distance from=pnt to=ar upload=cat column=areacat

   <b>Create</b> <b>a</b> <b>new</b> <b>vector</b> <b>map</b>
       Create  a new vector map which contains <u>lines</u> <u>connecting</u> <u>nearest</u> <u>features</u> of maps "pnt" and map "ln". The
       resulting vector map can be used for example to connect  points  to  a  network  as  needed  for  network
       analysis:
       v.distance from=pnt to=ln out=connections upload=dist column=dist

   <b>Create</b> <b>a</b> <b>new</b> <b>vector</b> <b>map</b> <b>with</b> <b>from</b> <b>and</b> <b>to</b> <b>categories</b> <b>in</b> <b>the</b> <b>attribute</b> <b>table</b>
       Create a new vector map that contains <u>lines</u> <u>connecting</u> <u>nearest</u> <u>features</u> of maps "pnt" and map "ln", and a
       new attribute table that contains distances, from and to categories from the input maps:
       v.distance from=pnt to=ln out=connections upload=cat,dist column=to_cat,dist table=connections

   <b>Query</b> <b>information</b>
       Query  information  from selected point(s). <u>v.distance</u> takes points from a vector map as input instead of
       stdin. A new vector map with query points has to be created before the map can be analysed.

       Create query map (if not present):
       echo "123456|654321|1" | v.in.ascii output=pnt
       Find nearest features:
       v.distance -p from=pnt to=map_to_query upload=cat

   <b>Point-in-polygon</b>
       The option <b>dmax=0</b> is here important because otherwise for points not falling into any area, the  category
       of the nearest area is recorded.
       For  each  point  from vector map "pnt", find the <u>area</u> from vector map "ar" in which the individual point
       falls, and write the related area categories to column "areacat" into the  attribute  table  attached  to
       vector map "pnt":
       v.distance from=pnt to=ar dmax=0 upload=cat column=areacat

   <b>Univariate</b> <b>statistics</b> <b>on</b> <b>results</b>
       Create  a vector map containing connecting lines and investigate mean distance to targets. An alternative
       solution is to use the v.distance upload=dist option to upload distances into the <u>bugs</u>  vector  directly,
       then  run  v.univar  on  that.  Also  note  you  can  upload  two  columns  at  a  time,  e.g. v.distance
       upload=cat,dist column=nearest_id,dist_to_nr.
       # create working copy
       g.copy vect=bugsites,bugs
       # add new attribute column to hold nearest archsite category number
       v.db.addcolumn map=bugs column="nrst_arch INTEGER"
       v.distance from=bugs to=archsites to_type=point upload=to_attr \
         to_column=cat column=nrst_arch out=vdistance_vectors_raw
       # we need to give the lines category numbers, create a table, and create
       #  a column in that table to hold the distance data.
       v.category vdistance_vectors_raw out=vdistance_vectors type=line op=add
       g.remove -f type=vector name=vdistance_vectors_raw
       v.db.addtable map=vdistance_vectors column="length DOUBLE"
       v.to.db map=vdistance_vectors option=length column=length
       # calculate statistics
       v.univar vdistance_vectors column=length

   <b>Print</b> <b>distance</b> <b>between</b> <b>points</b>
       Example for a Latitude-longitude project (EPSG 4326):
       # points along the equator
       echo "0|-61|1" | v.in.ascii output=pnt1 input=-
       echo "0|-58|1" | v.in.ascii output=pnt2 input=-
       # here, distances are in degree units
       v.distance -p --q from=pnt1 to=pnt2 upload=dist
       from_cat|distance
       1|3

   <b>Print</b> <b>distance</b> <b>matrix</b>
       North Carolina sample data

       As linear matrix:
       v.distance -pa from=hospitals to=hospitals upload=dist,to_attr to_column=NAME separator=tab
       from_cat    to_cat  dist    to_attr
       1   1   0   Cherry Hospital
       1   2   7489.1043632983983  Wayne Memorial Hospital
       1   3   339112.17046729225  Watauga Medical Center
       1   4   70900.392145909267  Central Prison Hospital
       1   5   70406.227393921712  Dorothea Dix Hospital

       As square matrix (only possible with single upload option):
       v.distance -pas from=hospitals to=hospitals upload=dist separator=tab
       from_cat to_cat       dist
                     1          2          3          4          5 ...
       1             0    7489.10  339112.17   70900.39   70406.23 ...
       2       7489.10          0  345749.12   76025.46   75538.87 ...
       3     339112.17  345749.12          0  274153.19  274558.98 ...
       4      70900.39   76025.46  274153.19          0     501.11 ...
       5      70406.23   75538.87  274558.98     501.11          0 ...
       ...

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        <u>r.distance,</u> <u>v.db.addcolumn,</u> <u>v.what.vect</u>

</pre><h4><b>AUTHORS</b></h4><pre>
       Janne Soimasuo 1994, University of Joensuu, Faculty of Forestry, Finland
       Cmd line coordinates support: Markus Neteler, ITC-irst, Trento, Italy
       Updated for 5.1: Radim Blazek, ITC-irst, Trento, Italy
       Matrix-like output by Martin Landa, FBK-irst, Trento, Italy
       Improved processing speed: Markus Metz
       Distance from any feature to any feature: Markus Metz
       New table without the -p flag: Huidae Cho Make linear matrix the default for all outputs: Moritz Lennert

</pre><h4><b>SOURCE</b> <b>CODE</b></h4><pre>
       Available at: v.distance source code (history)

       Accessed: Friday Apr 04 01:20:16 2025

       Main index | Vector index | Topics index | Keywords index | Graphical index | Full index

       © 2003-2025 GRASS Development Team, GRASS GIS 8.4.1 Reference Manual

GRASS 8.4.1                                                                                   <u><a href="../man1grass/v.distance.1grass.html">v.distance</a></u>(1grass)
</pre>
 </div>
</div></section>
</div>
</body>
</html>