<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-posix">manpages-posix_2017a-2_all</a> <br><br><pre>
</pre><h4><b>PROLOG</b></h4><pre>
       This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface
       may differ (consult the corresponding Linux manual page for details of Linux behavior), or the  interface
       may not be implemented on Linux.

</pre><h4><b>NAME</b></h4><pre>
       pathchk — check pathnames

</pre><h4><b>SYNOPSIS</b></h4><pre>
       pathchk <b>[</b>-p<b>]</b> <b>[</b>-P<b>]</b> <u>pathname</u>...

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <u>pathchk</u>  utility  shall  check  that one or more pathnames are valid (that is, they could be used to
       access or create a file without causing syntax errors) and portable  (that  is,  no  filename  truncation
       results). More extensive portability checks are provided by the <b>-p</b> and <b>-P</b> options.

       By  default,  the  <u>pathchk</u>  utility  shall  check  each  component  of each <u>pathname</u> operand based on the
       underlying file system. A diagnostic shall be written for each <u>pathname</u> operand that:

        *  Is longer than {PATH_MAX} bytes (see <b>Pathname</b> <b>Variable</b> <b>Values</b>  in  the  Base  Definitions  volume  of
           POSIX.1‐2017, <b>&lt;limits.h&gt;</b>)

        *  Contains any component longer than {NAME_MAX} bytes in its containing directory

        *  Contains any component in a directory that is not searchable

        *  Contains any byte sequence that is not valid in its containing directory

       The  format  of  the  diagnostic  message is not specified, but shall indicate the error detected and the
       corresponding <u>pathname</u> operand.

       It shall not be considered an error if one or more components of a <u>pathname</u> operand do not exist as  long
       as  a  file  matching  the  pathname  specified  by the missing components could be created that does not
       violate any of the checks specified above.

</pre><h4><b>OPTIONS</b></h4><pre>
       The <u>pathchk</u> utility shall conform to the Base Definitions volume of POSIX.1‐2017, <u>Section</u>  <u>12.2</u>,  <u>Utility</u>
       <u>Syntax</u> <u>Guidelines</u>.

       The following option shall be supported:

       <b>-p</b>        Instead  of  performing checks based on the underlying file system, write a diagnostic for each
                 <u>pathname</u> operand that:

                  *  Is longer than {_POSIX_PATH_MAX} bytes (see <b>Minimum</b> <b>Values</b> in the Base  Definitions  volume
                     of POSIX.1‐2017, <b>&lt;limits.h&gt;</b>)

                  *  Contains any component longer than {_POSIX_NAME_MAX} bytes

                  *  Contains any character in any component that is not in the portable filename character set

       <b>-P</b>        Write a diagnostic for each <u>pathname</u> operand that:

                  *  Contains a component whose first character is the &lt;hyphen-minus&gt; character

                  *  Is empty

</pre><h4><b>OPERANDS</b></h4><pre>
       The following operand shall be supported:

       <u>pathname</u>  A pathname to be checked.

</pre><h4><b>STDIN</b></h4><pre>
       Not used.

</pre><h4><b>INPUT</b> <b>FILES</b></h4><pre>
       None.

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       The following environment variables shall affect the execution of <u>pathchk</u>:

       <u>LANG</u>      Provide a default value for the internationalization variables that are unset or null. (See the
                 Base  Definitions  volume  of  POSIX.1‐2017,  <u>Section</u>  <u>8.2</u>,  <u>Internationalization</u> <u>Variables</u> the
                 precedence  of  internationalization  variables  used  to  determine  the  values   of   locale
                 categories.)

       <u>LC_ALL</u>    If  set  to a non-empty string value, override the values of all the other internationalization
                 variables.

       <u>LC_CTYPE</u>  Determine the locale for the interpretation of sequences of bytes of text  data  as  characters
                 (for example, single-byte as opposed to multi-byte characters in arguments).

       <u>LC_MESSAGES</u>
                 Determine  the  locale  that  should  be  used  to affect the format and contents of diagnostic
                 messages written to standard error.

       <u>NLSPATH</u>   Determine the location of message catalogs for the processing of <u>LC_MESSAGES</u>.

</pre><h4><b>ASYNCHRONOUS</b> <b>EVENTS</b></h4><pre>
       Default.

</pre><h4><b>STDOUT</b></h4><pre>
       Not used.

</pre><h4><b>STDERR</b></h4><pre>
       The standard error shall be used only for diagnostic messages.

</pre><h4><b>OUTPUT</b> <b>FILES</b></h4><pre>
       None.

</pre><h4><b>EXTENDED</b> <b>DESCRIPTION</b></h4><pre>
       None.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       The following exit values shall be returned:

        0    All <u>pathname</u> operands passed all of the checks.

       &gt;0    An error occurred.

</pre><h4><b>CONSEQUENCES</b> <b>OF</b> <b>ERRORS</b></h4><pre>
       Default.

       <u>The</u> <u>following</u> <u>sections</u> <u>are</u> <u>informative.</u>

</pre><h4><b>APPLICATION</b> <b>USAGE</b></h4><pre>
       The <u>test</u> utility can be used to determine whether a given pathname names an existing file; it  does  not,
       however, give any indication of whether or not any component of the pathname was truncated in a directory
       where  the  _POSIX_NO_TRUNC  feature  is  not  in  effect.  The  <u>pathchk</u>  utility does not check for file
       existence; it performs checks to determine whether a pathname does exist or  could  be  created  with  no
       pathname component truncation.

       The <u>noclobber</u> option in the shell (see the <u>set</u> special built-in) can be used to atomically create a file.
       As with all file creation semantics in the System Interfaces volume of POSIX.1‐2017, it guarantees atomic
       creation,  but  still  depends  on applications to agree on conventions and cooperate on the use of files
       after they have been created.

       To verify that a pathname meets the requirements of filename portability, applications  should  use  both
       the <b>-p</b> and <b>-P</b> options together.

</pre><h4><b>EXAMPLES</b></h4><pre>
       To  verify  that  all pathnames in an imported data interchange archive are legitimate and unambiguous on
       the current system:

           # This example assumes that no pathnames in the archive
           # contain &lt;newline&gt; characters.
           pax -f archive | sed -e 's/[^[:alnum:]]/\\&amp;/g' | xargs pathchk --
           if [ $? -eq 0 ]
           then
               pax -r -f archive
           else
               echo Investigate problems before importing files.
               exit 1
           fi

       To verify that all files in the current directory hierarchy could be moved to any  system  conforming  to
       the System Interfaces volume of POSIX.1‐2017 that also supports the <u>pax</u> utility:

           find . -exec pathchk -p -P {} +
           if [ $? -eq 0 ]
           then
               pax -w -f ../archive .
           else
               echo Portable archive cannot be created.
               exit 1
           fi

       To  verify that a user-supplied pathname names a readable file and that the application can create a file
       extending the given path without truncation and without overwriting any existing file:

           case $- in
               *C*)    reset="";;
               *)      reset="set +C"
                       set -C;;
           esac
           test -r "$path" &amp;&amp; pathchk "$path.out" &amp;&amp;
               rm "$path.out" &gt; "$path.out"
           if [ $? -ne 0 ]; then
               printf "%s: %s not found or %s.out fails \
           creation checks.\n" $0 "$path$path"
               $reset    # Reset the noclobber option in case a trap
                         # on EXIT depends on it.
               exit 1
           fi
           $reset
           PROCESSING &lt; "$path" &gt; "$path.out"

       The following assumptions are made in this example:

        1. <b>PROCESSING</b> represents the code that is used by the application to use <b>$path</b> once it is verified  that
           <b>$path.out</b> works as intended.

        2. The  state  of the <u>noclobber</u> option is unknown when this code is invoked and should be set on exit to
           the state it was in when this code was invoked. (The <b>reset</b>  variable  is  used  in  this  example  to
           restore the initial state.)

        3. Note the usage of:

               rm "$path.out" &gt; "$path.out"

            a. The <u>pathchk</u> command has already verified, at this point, that <b>$path.out</b> is not truncated.

            b. With  the  <u>noclobber</u>  option set, the shell verifies that <b>$path.out</b> does not already exist before
               invoking <u>rm</u>.

            c. If the shell succeeded in creating <b>$path.out</b>, <u>rm</u> removes it so that the  application  can  create
               the file again in the <b>PROCESSING</b> step.

            d. If the <b>PROCESSING</b> step wants the file to exist already when it is invoked, the:

                   rm "$path.out" &gt; "$path.out"

               should be replaced with:

                   &gt; "$path.out"

               which  verifies  that  the  file  did not already exist, but leaves <b>$path.out</b> in place for use by
               <b>PROCESSING</b>.

</pre><h4><b>RATIONALE</b></h4><pre>
       The <u>pathchk</u> utility was new for the ISO POSIX‐2:1993 standard.  It,  along  with  the  <u>set</u>  <b>-C</b>(<u>noclobber</u>)
       option  added  to  the shell, replaces the <u>mktemp</u>, <u>validfnam</u>, and <u>create</u> utilities that appeared in early
       proposals. All of these utilities were attempts to solve several common problems:

        *  Verify the validity (for several different definitions of ``valid'') of  a  pathname  supplied  by  a
           user, generated by an application, or imported from an external source.

        *  Atomically create a file.

        *  Perform various string handling functions to generate a temporary filename.

       The  <u>create</u>  utility,  included  in  an early proposal, provided checking and atomic creation in a single
       invocation of the utility; these are orthogonal issues and need not be grouped  into  a  single  utility.
       Note  that the <u>noclobber</u> option also provides a way of creating a lock for process synchronization; since
       it provides an atomic <u>create</u>, there is no race between a test for existence and the following creation if
       it did not exist.

       Having a function like <u>tmpnam</u>() in the ISO C standard is important  in  many  high-level  languages.  The
       shell  programming language, however, has built-in string manipulation facilities, making it very easy to
       construct temporary filenames. The names needed obviously depend on the application, but  are  frequently
       of a form similar to:

           <b>$TMPDIR/</b><u>application_abbreviation</u><b>$$.</b><u>suffix</u>

       In  cases where there is likely to be contention for a given suffix, a simple shell <b>for</b> or <b>while</b> loop can
       be used with the shell <u>noclobber</u> option to  create  a  file  without  risk  of  collisions,  as  long  as
       applications  trying  to  use the same filename name space are cooperating on the use of files after they
       have been created.

       For historical purposes, <b>-p</b> does not check for the use of  the  &lt;hyphen-minus&gt;  character  as  the  first
       character in a component of the pathname, or for an empty <u>pathname</u> operand.

</pre><h4><b>FUTURE</b> <b>DIRECTIONS</b></h4><pre>
       None.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>Section</u> <u>2.7</u>, <u>Redirection</u>, <u>set</u>, <u>test</u>

       The  Base  Definitions  volume  of  POSIX.1‐2017, <u>Chapter</u> <u>8</u>, <u>Environment</u> <u>Variables</u>, <u>Section</u> <u>12.2</u>, <u>Utility</u>
       <u>Syntax</u> <u>Guidelines</u>, <b>&lt;limits.h&gt;</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1-2017, Standard
       for Information  Technology  --  Portable  Operating  System  Interface  (POSIX),  The  Open  Group  Base
       Specifications  Issue  7, 2018 Edition, Copyright (C) 2018 by the Institute of Electrical and Electronics
       Engineers, Inc and The Open Group.  In the event of any discrepancy between this version and the original
       IEEE and The Open Group Standard, the original IEEE and The Open Group Standard is the referee  document.
       The original Standard can be obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any  typographical  or formatting errors that appear in this page are most likely to have been introduced
       during  the  conversion  of  the  source  files  to  man  page  format.  To  report  such   errors,   see
       https://www.kernel.org/doc/man-pages/reporting_bugs.html .

IEEE/The Open Group                                   2017                                       <u><a href="../man1POSIX/PATHCHK.1POSIX.html">PATHCHK</a></u>(1POSIX)
</pre>
 </div>
</div></section>
</div>
</body>
</html>