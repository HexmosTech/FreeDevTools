<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nfstest_rdma - NFS-over-RDMA functional tests</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nfstest">nfstest_3.2-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nfstest_rdma - NFS-over-RDMA functional tests

</pre><h4><b>SYNOPSIS</b></h4><pre>
       nfstest_rdma --server &lt;server&gt; [options]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Verify correct functionality of NFS-over-RDMA

       Remote  Direct  Memory  Access  (RDMA) provides fast data transfers between servers and storage. NFS over
       RDMA is best used when a large amount of data needs  to  be  transferred  with  higher  performance  than
       regular  NFS. NFS over RDMA is usually used over InfiniBand which provides higher performance and a lower
       latency.

       Although NFS over RDMA is mostly used over InfiniBand, Ethernet could be used as  the  link  protocol  as
       well. RDMA over Converged Ethernet (RoCE) which allows RDMA over Ethernet by encapsulating the InfiniBand
       transport  packet  over  Ethernet.  RoCE provides a couple of variants: RoCEv1 and RoCEv2.  One is RoCEv1
       which is an Ethernet link layer protocol and provides RDMA functionality between two hosts  in  the  same
       Ethernet  broadcast domain.  While the second is RoCEv2 or RRoCE (Remote RoCE) which is an internet layer
       protocol so these packets can be routed. RoCEv2 runs over UDP/IPv4 or UDP/IPv6.  There  is  also  another
       variant  called  iWARP  which runs over the TCP protocol. Testing is currently supported for all of these
       variants except for iWARP.

       NFS over RDMA has a couple of extra layers in the packet: InfiniBand layer and RPC-over-RDMA or  RPCoRDMA
       layer. The InfiniBand layer contains the OpCode which specifies the type of RDMA operation to perform and
       the  PSN  which  is  the  packet  sequence number. The RPCoRDMA layer contains the XID and the RDMA chunk
       lists. The RDMA read chunk list is used to transfer DDP (Direct Data Placement) data from the NFS  client
       to the server, e.g., NFS write call. On the other hand, the RDMA write chunk list is used to transfer DDP
       data  from  the  NFS  server back to the client, e.g., NFS read reply. Only certain NFS operations can be
       transferred using DDP and only the opaque part of the operation is transferred using either RDMA reads or
       writes while the rest of the NFS packet is transferred  via  the  receive  buffer  using  the  RDMA  SEND
       operation. Finally, the RDMA reply chunk is used to transfer replies having a variable length reply which
       could  be  larger than the receive buffer and could not be transferred using the write chunk list because
       it does not contain a single large opaque item.

       Tests are divided into three groups: basic, read and write. The basic tests deal  mostly  with  verifying
       NFS  packets  using  the  reply  chunk  and some other basic RDMA functionality. The read tests deal with
       verifying NFS read which in turn verify the RDMA write functionality. Finally, the write tests deal  with
       verifying  NFS write which in turn verify the RDMA read functionality.  Also, if the NFS read or write is
       small enough the client could not use the RDMA write or read functionality, but  instead  could  use  the
       receive buffer and transfer the data using the RDMA SEND operations.

       Tests  verify  the  RPCoRDMA layer is sent when necessary and that the RDMA chunk lists are sent with the
       correct information which includes the number of chunks, number of segments in each chunk and the correct
       information for each segment. Tests verify each segment information is correct  and  their  corresponding
       RDMA  read  or  write  information  which includes correct handle, virtual offset, DMA length and the XDR
       position for the case of RDMA reads.  In addition, the correct number  of  RDMA  I/O  fragments  is  also
       verified and their corresponding lengths and packet sequence numbers.

</pre><h4><b>OPTIONS</b></h4><pre>
       --version
              show program's version number and exit

       -h, --help
              show this help message and exit

       -f FILE, --file=FILE
              File  where  options  are  specified  besides  the  system  wide file /etc/nfstest, user wide file
              $HOME/.nfstest or in the current directory .nfstest file

   <b>NFS</b> <b>specific</b> <b>options:</b>
       -s SERVER, --server=SERVER
              Server name or IP address

       -e EXPORT, --export=EXPORT
              Exported file system to mount [default: '/']

       --nfsversion=NFSVERSION
              NFS version, e.g., 3, 4, 4.1, etc. [default: 4.1]

       -m MTPOINT, --mtpoint=MTPOINT
              Mount point [default: '/mnt/t']

       -p PORT, --port=PORT
              NFS server port [default: 20049]

       --proto=PROTO
              NFS protocol name [default: 'rdma']

       --sec=SEC
              Security flavor [default: 'sys']

       --nconnect=NCONNECT
              Multiple TCP connections option [default: '1']

       -o MTOPTS, --mtopts=MTOPTS
              Mount options [default: 'hard']

       --datadir=DATADIR
              Data directory where files are created, directory is created on the mount point [default: '']

   <b>Logging</b> <b>options:</b>
       -v VERBOSE, --verbose=VERBOSE
              Verbose level for debug messages [default: 'opts|info|dbg1|dbg2|dbg3']

       --tverbose=TVERBOSE
              Verbose level for test messages [default: '1']

       --createlog
              Create log file

       --rexeclog
              Create rexec log files

       --warnings
              Display warnings

       --tag=TAG
              Informational tag, it is displayed as an INFO message [default: '']

       --notty
              Do not use terminal colors on output

       --isatty
              Use terminal colors on output -- useful when running with nohup

   <b>Packet</b> <b>trace</b> <b>options:</b>
       --createtraces
              Create a packet trace for each test

       --tbsize=TBSIZE
              Capture buffer size for tcpdump [default: 192k]

       --trcdelay=TRCDELAY
              Seconds to delay before stopping packet trace [default: 2.0]

       --keeptraces
              Do not remove any trace files [default: remove trace files if no errors]

       --rmtraces
              Remove trace files [default: remove trace files if no errors]

       -i INTERFACE, --interface=INTERFACE
              Device interface [default: automatically selected]

   <b>File</b> <b>options:</b>
       --nfiles=NFILES
              Number of files to create [default: 0]

       --filesize=FILESIZE
              File size to use for test files [default: 64k]

       --rsize=RSIZE
              Read size to use when reading files [default: 4k]

       --wsize=WSIZE
              Write size to use when writing files [default: 4k]

       --iodelay=IODELAY
              Seconds to delay I/O operations [default: 0.1]

       --offset-delta=OFFSET_DELTA
              Read/Write offset delta [default: 4k]

   <b>Path</b> <b>options:</b>
       --sudo=SUDO
              Full path of binary for sudo [default: '<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sudo">/usr/bin/sudo</a>']

       --kill=KILL
              Full path of binary for kill [default: '<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?kill">/usr/bin/kill</a>']

       --nfsstat=NFSSTAT
              Full path of binary for nfsstat [default: '/usr/sbin/nfsstat']

       --tcpdump=TCPDUMP
              Full path of binary for tcpdump [default: '/usr/sbin/tcpdump']

       --iptables=IPTABLES
              Full path of binary for iptables [default: '<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?iptables">/usr/sbin/iptables</a>']

       --messages=MESSAGES
              Full path of log messages file [default: '/var/log/messages']

       --trcevents=TRCEVENTS
              Full path of tracing events directory [default: '/sys/kernel/debug/tracing/events']

       --trcpipe=TRCPIPE
              Full path of trace pipe file [default: '/sys/kernel/debug/tracing/trace_pipe']

       --tmpdir=TMPDIR
              Temporary directory [default: '<a href="file:/tmp">/tmp</a>']

   <b>Debug</b> <b>options:</b>
       --nocleanup
              Do not cleanup created files

       --notimestamps
              Do not display timestamps in debug messages

       --bugmsgs=BUGMSGS
              File containing test messages to mark as bugs if they failed

       --nomount
              Do not mount server and run the tests on local disk space

       --basename=BASENAME
              Base name for all files and logs [default: automatically generated]

       --nfsdebug=NFSDEBUG
              Set NFS kernel debug flags and save log messages [default: '']

       --rpcdebug=RPCDEBUG
              Set RPC kernel debug flags and save log messages [default: '']

       --tracepoints=TRACEPOINTS
              List of trace points modules to enable [default: '']

       --nfsstats
              Get NFS stats [default: 'False']

       --pktdisp
              Display main packets related to the given test

       --nfserrors
              Fail every NFS error found in the packet trace

       --client-ipaddr=CLIENT_IPADDR
              IP address of localhost

   <b>Reporting</b> <b>options:</b>
       --xunit-report
              Generate xUnit compatible test report

       --xunit-report-file=XUNIT_REPORT_FILE
              Path to xout report file

   <b>Test</b> <b>options:</b>
       --runtest=RUNTEST
              Comma separated list of tests to run, if list starts with a '^' then all tests are run except  the
              ones listed [default: 'all']

       --small-filesize=SMALL_FILESIZE
              File size to use for small files [default: 4k]

       --large-filesize=LARGE_FILESIZE
              File size to use for large files [default: 1m]

       --strict
              Mark warnings for missing fragments as failures [default: False]

</pre><h4><b>TESTS</b></h4><pre>
   <b>basic</b>
       Run all NFS-over-RDMA basic functionality tests: basic01, basic02,
       basic03, basic04, basic05

   <b>basic01</b>
       Verify basic NFS-over-RDMA functionality

   <b>basic02</b>
       Verify NFS-over-RDMA reply chunk on EXCHANGE_ID/SETCLIENTID

   <b>basic03</b>
       Verify NFS-over-RDMA reply chunk on READDIR

   <b>basic04</b>
       Verify NFS-over-RDMA reply chunk on READLINK

   <b>basic05</b>
       Verify NFS-over-RDMA reply chunk on GETATTR(FATTR4_ACL)

   <b>read</b>
       Run all NFS-over-RDMA functionality tests where file is opened for
       reading: read01, read02, read03, read04

   <b>read01</b>
       Verify NFS-over-RDMA functionality on a file opened for reading (very small file)

   <b>read02</b>
       Verify NFS-over-RDMA functionality on a file opened for reading (small file)

   <b>read03</b>
       Verify NFS-over-RDMA functionality on a file opened for reading (medium file)

   <b>read04</b>
       Verify NFS-over-RDMA functionality on a file opened for reading (large file)

   <b>write</b>
       Run all NFS-over-RDMA functionality tests where file is opened for
       writing: write01, write02, write03, write04

   <b>write01</b>
       Verify NFS-over-RDMA functionality on a file opened for writing (very small file)

   <b>write02</b>
       Verify NFS-over-RDMA functionality on a file opened for writing (small file)

   <b>write03</b>
       Verify NFS-over-RDMA functionality on a file opened for writing (medium file)

   <b>write04</b>
       Verify NFS-over-RDMA functionality on a file opened for writing (large file)

   <b>all</b>
       Run all tests: basic01, basic02, basic03, basic04, basic05, read01,
       read02, read03, read04, write01, write02, write03, write04

</pre><h4><b>EXAMPLES</b></h4><pre>
       The only required option is --server
       $ nfstest_rdma --server 192.168.0.11

</pre><h4><b>NOTES</b></h4><pre>
       The  user  id in the local host must have access to run commands as root using the 'sudo' command without
       the need for a password.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/formatstr.3.html">formatstr</a>(3),</b>   <b><a href="../man3/nfstest.test_util.3.html">nfstest.test_util</a>(3),</b>    <b><a href="../man1/nfstest_alloc.1.html">nfstest_alloc</a>(1),</b>    <b><a href="../man1/nfstest_cache.1.html">nfstest_cache</a>(1),</b>    <b><a href="../man1/nfstest_delegation.1.html">nfstest_delegation</a>(1),</b>
       <b><a href="../man1/nfstest_dio.1.html">nfstest_dio</a>(1),</b>  <b><a href="../man1/nfstest_fcmp.1.html">nfstest_fcmp</a>(1),</b>  <b><a href="../man1/nfstest_file.1.html">nfstest_file</a>(1),</b>  <b><a href="../man1/nfstest_interop.1.html">nfstest_interop</a>(1),</b>  <b><a href="../man1/nfstest_io.1.html">nfstest_io</a>(1),</b> <b><a href="../man1/nfstest_lock.1.html">nfstest_lock</a>(1),</b>
       <b><a href="../man1/nfstest_pkt.1.html">nfstest_pkt</a>(1),</b> <b><a href="../man1/nfstest_pnfs.1.html">nfstest_pnfs</a>(1),</b> <b><a href="../man1/nfstest_posix.1.html">nfstest_posix</a>(1),</b> <b><a href="../man1/nfstest_sparse.1.html">nfstest_sparse</a>(1),</b>  <b><a href="../man1/nfstest_ssc.1.html">nfstest_ssc</a>(1),</b>  <b><a href="../man1/nfstest_xattr.1.html">nfstest_xattr</a>(1),</b>
       <b><a href="../man1/nfstest_xid.1.html">nfstest_xid</a>(1),</b>           <b><a href="../man3/packet.application.rpc_const.3.html">packet.application.rpc_const</a>(3),</b>          <b><a href="../man3/packet.application.rpcordma_const.3.html">packet.application.rpcordma_const</a>(3),</b>
       <b><a href="../man3/packet.nfs.nfs3_const.3.html">packet.nfs.nfs3_const</a>(3),</b> <b><a href="../man3/packet.nfs.nfs4_const.3.html">packet.nfs.nfs4_const</a>(3),</b> <b><a href="../man3/packet.transport.ib.3.html">packet.transport.ib</a>(3),</b> <b><a href="../man3/packet.transport.rdmap.3.html">packet.transport.rdmap</a>(3)</b>

</pre><h4><b>BUGS</b></h4><pre>
       No known bugs.

</pre><h4><b>AUTHOR</b></h4><pre>
       Jorge Mora (<a href="mailto:mora@netapp.com">mora@netapp.com</a>)

NFStest 3.2                                       21 March 2023                                  <u><a href="../man1/NFSTEST_RDMA.1.html">NFSTEST_RDMA</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>