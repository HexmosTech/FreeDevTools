<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>afew - afew Documentation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/afew">afew_3.0.1-7_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       afew - afew Documentation

       <u>afew</u> is an initial tagging script for notmuch mail:

       • <u><a href="http://notmuchmail.org/">http://notmuchmail.org/</a></u>

       • <u><a href="http://notmuchmail.org/initial_tagging/">http://notmuchmail.org/initial_tagging/</a></u>

       Its  basic  task  is  to  provide  automatic  tagging each time new mail is registered with notmuch. In a
       classic setup, you might call it after <u>notmuch</u> <u>new</u> in an offlineimap post sync hook  or  in  the  notmuch
       <u>post-new</u> hook.

       It  can  do  basic  thing  such as adding tags based on email headers or maildir folders, handling killed
       threads and spam.

       fyi: afew plays nicely with <u>alot</u>, a GUI for notmuch mail ;)

       • <u>https://github.com/pazz/alot</u>

       Contents:

</pre><h4><b>COMMAND</b> <b>LINE</b> <b>USAGE</b></h4><pre>
       Ultimately afew is a command line tool.  You have to specify  an  action,  and  whether  to  act  on  all
       messages, or only on new messages.  The actions you can choose from are:

       <b>tag</b>    run the tag filters.  See <u>Initial</u> <u>tagging</u>.

       <b>watch</b>  continuously monitor the mailbox for new files

       <b>move-mails</b>
              move mail files between maildir folders

   <b>Initial</b> <b>tagging</b>
       Basic tagging stuff requires no configuration, just run

          $ afew --tag --new
          # or to tag *all* messages
          $ afew --tag --all

       To do this automatically you can add the following hook into your <u><a href="file:~/.offlineimaprc">~/.offlineimaprc</a></u>:

          postsynchook = ionice -c 3 chrt --idle 0 <a href="file:/bin/sh">/bin/sh</a> -c "notmuch new &amp;&amp; afew --tag --new"

       There is a lot more to say about general filter <u>Configuration</u> and the different <u>Filters</u> provided by afew.

   <b>Simulation</b>
       Adding <u>--dry-run</u> to any <u>--tag</u> or <u>--sync-tags</u> action prevents modification of the notmuch db. Add some <u>-vv</u>
       goodness to see some action.

   <b>Move</b> <b>Mode</b>
       To invoke afew in move mode, provide the <u>--move-mails</u> option on the command line.  Move mode will respect
       <u>--dry-run</u>, so throw in <u>--verbose</u> and watch what effects a real run would have.

       In move mode, afew will check all mails (or only recent ones) in the configured maildir folders, deciding
       whether they should be moved to another folder.

       The  decision  is  based  on  rules  defined  in your config file. A rule is bound to a source folder and
       specifies a target folder into which a mail will be moved that is matched by an associated query.

       This way you will be able to transfer your sorting principles roughly to the classic folder based maildir
       structure understood by your traditional mail server. Tag your mails with notmuch, call afew <u>--move-mails</u>
       in an offlineimap presynchook and enjoy a clean inbox in your webinterface/GUI-client at work.

       Note that in move mode, afew calls  <u>notmuch</u>  <u>new</u>  after  moving  mails  around.   You  can  use  <u>afew</u>  <u>-m</u>
       <u>--notmuch-args=--no-hooks</u> in a pre-new notmuch hook to avoid loops.

       For  information  on  how  to  configure rules for move mode, what you can do with it and what you can't,
       please refer to <u>Move</u> <u>Mode</u>.

   <b>Commandline</b> <b>help</b>
       The full set of options is:

          $ afew --help
          Usage: afew [options] [--] [query]

          Options:
            -h, --help            show this help message and exit

            Actions:
              Please specify exactly one action.

              -t, --tag           run the tag filters
              -w, --watch         continuously monitor the mailbox for new files
              -m, --move-mails    move mail files between maildir folders

            Query modifiers:
              Please specify either --all or --new or a query string.

              -a, --all           operate on all messages
              -n, --new           operate on all new messages

            General options:
              -C NOTMUCH_CONFIG, --notmuch-config=NOTMUCH_CONFIG
                                  path to the notmuch configuration file [default:
                                  $NOTMUCH_CONFIG or <a href="file:~/.notmuch-config">~/.notmuch-config</a>]
              -e ENABLE_FILTERS, --enable-filters=ENABLE_FILTERS
                                  filter classes to use, separated by ',' [default:
                                  filters specified in afew's config]
              -d, --dry-run       don't change the db [default: False]
              -R REFERENCE_SET_SIZE, --reference-set-size=REFERENCE_SET_SIZE
                                  size of the reference set [default: 1000]
              -T DAYS, --reference-set-timeframe=DAYS
                                  do not use mails older than DAYS days [default: 30]
              -v, --verbose       be more verbose, can be given multiple times

</pre><h4><b>CONFIGURATION</b></h4><pre>
   <b>Configuration</b> <b>File</b>
       Customization of tag filters takes place in afew's config file in <u><a href="file:~/.config/afew/config">~/.config/afew/config</a></u>.

   <b>NotMuch</b> <b>Config</b>
       afew tries to adapt to the new tag that notmuch sets on new email, but has mostly been developed and used
       against the <b>new</b> tag.  To use that, make sure that <u><a href="file:~/.notmuch-config">~/.notmuch-config</a></u> contains:

          [new]
          tags=new

       afew reads the notmuch database location from notmuch config. When no database path  is  set  in  notmuch
       config,  afew  uses  the <u>MAILDIR</u> environment variable when set, or <u>$HOME/mail</u> as a fallback, like notmuch
       CLI does. If a relative path is provided, afew prepends <u>$HOME/</u> to the path in the same manner as notmuch,
       which was introduced in version 0.28 of notmuch.

   <b>Filter</b> <b>Configuration</b>
       You can modify filters, and define your own versions of the base Filter that allow you to tag messages in
       a similar way to the <u>notmuch</u> <u>tag</u> command, using the config file.  The default config file is:

          [SpamFilter]
          [KillThreadsFilter]
          [ListMailsFilter]
          [ArchiveSentMailsFilter]
          sent_tag = ''
          [InboxFilter]

       See the <u>Filters</u> page for the details of those filters and the custom arguments they accept.

       You can add filters based on the base filter as well.  These can be  customised  by  specifying  settings
       beneath them.  The standard settings, which apply to all filters, are:

       <b>message</b>
              text that will be displayed while running this filter if the verbosity is high enough.

       <b>query</b>  the  query to use against the messages, specified in standard notmuch format.  Note that you don't
              need to specify the <b>new</b> tag - afew will add that when run with the <u>--new</u> flag.

       <b>tags</b>   the tags to add or remove for messages that match the query. Tags to add are preceded by a  <b>+</b>  and
              tags to remove are preceded by a <b>-</b>.  Multiple tags are separated by semicolons.

       <b>tags_blacklist</b>
              if the message has one of these tags, don't add <u>tags</u> to it. Tags are separated by semicolons.

       So to add the <b>deer</b> tag to any message to or from <u><a href="mailto:antelope@deer.com">antelope@deer.com</a></u> you could do:

          [Filter.1]
          query = '<a href="mailto:antelope@deer.com">antelope@deer.com</a>'
          tags = +deer
          message = Wild animals ahoy

       You  can  also  (in  combination  with the InboxFilter) have email skip the Inbox by removing the new tag
       before you get to the InboxFilter:

          [Filter.2]
          query = from'<a href="mailto:pointyheaded@boss.com">pointyheaded@boss.com</a>'
          tags = -new;+boss
          message = Message from above

   <b>Full</b> <b>Sample</b> <b>Config</b>
       Showing some sample configs is the easiest way to understand.  The <u>notmuch</u> <u>initial</u> <u>tagging</u> <u>page</u>  shows  a
       sample config:

          # immediately archive all messages from "me"
          notmuch tag -new -- tag:new and from:<a href="mailto:me@example.com">me@example.com</a>

          # delete all messages from a spammer:
          notmuch tag +deleted -- tag:new and from:<a href="mailto:spam@spam.com">spam@spam.com</a>

          # tag all message from notmuch mailing list
          notmuch tag +notmuch -- tag:new and to:<a href="mailto:notmuch@notmuchmail.org">notmuch@notmuchmail.org</a>

          # finally, retag all "new" messages "inbox" and "unread"
          notmuch tag +inbox +unread -new -- tag:new

       The (roughly) equivalent set up in afew would be:

          [ArchiveSentMailsFilter]

          [Filter.1]
          message = Delete all messages from spammer
          query = from:<a href="mailto:spam@spam.com">spam@spam.com</a>
          tags = +deleted;-new

          [Filter.2]
          message = Tag all messages from the notmuch mailing list
          query = to:<a href="mailto:notmuch@notmuchmail.org">notmuch@notmuchmail.org</a>
          tags = +notmuch

          [InboxFilter]

       Not  that  the queries do not generally include <u>tag:new</u> because this is implied when afew is run with the
       <u>--new</u> flag.

       The differences between them is that

       • the ArchiveSentMailsFilter will add tags specified by <u>sent_tag</u> option (default <u>''</u> means  add  no  tags.
         You may want to set it to <u>sent</u>), as well as archiving the email. And it will not archive email that has
         been sent to one of your own addresses.

       • the  InboxFilter  does  not  add  the  <b>unread</b> tag.  But most mail clients will manage the unread status
         directly in maildir.

   <b>More</b> <b>Filter</b> <b>Examples</b>
       Here are a few more example filters from github dotfiles:

          [Filter.1]
          query = '<a href="mailto:sicsa-students@sicsa.ac.uk">sicsa-students@sicsa.ac.uk</a>'
          tags = +sicsa
          message = sicsa

          [Filter.2]
          query = 'from:<a href="mailto:foosoc.ed@gmail.com">foosoc.ed@gmail.com</a> OR from:GT Silber OR from:<a href="mailto:lizzie.brough@eusa.ed.ac.uk">lizzie.brough@eusa.ed.ac.uk</a>'
          tags = +soc;+foo
          message = foosoc

          [Filter.3]
          query = 'folder:gmail/G+'
          tags = +G+
          message = gmail spam

          # skip inbox
          [Filter.6]
          query = 'to:<a href="mailto:notmuch@notmuchmail.org">notmuch@notmuchmail.org</a> AND (subject:emacs OR subject:elisp OR "(defun" OR "(setq" OR PATCH)'
          tags = -new
          message = notmuch emacs stuff

          # Assuming the following workflow: all messages for projects or releases should be tagged
          # as "project/A", "project/B" respectively "release/1.0.1" or "release/1.2.0".
          #
          # In most cases replies to messages retain their context: the project, the release(s), ..
          #
          # The following config will propagate all project/... or release/... tags from a thread
          # to all new messages.

          [PropagateTagsByRegexInThreadFilter.1]
          propagate_tags = project/.*
          # do not tag spam
          filter = not is:spam

          [PropagateTagsByRegexInThreadFilter.2]
          propagate_tags = release/.*

</pre><h4><b>FILTERS</b></h4><pre>
       The default filter set (if you don't specify anything in the config) is:

          [SpamFilter]
          [KillThreadsFilter]
          [ListMailsFilter]
          [ArchiveSentMailsFilter]
          [InboxFilter]

       The standard filter <u>Configuration</u> can be applied to these filters as well. Though note that most  of  the
       filters  below  set  their own value for message, query and/or tags, and some ignore some of the standard
       settings.

   <b>ArchiveSentMailsFilter</b>
       It extends <u>SentMailsFilter</u> with the following feature:

          • Emails filtered by this filter have the <b>new</b> tag removed, so will not have the <b>inbox</b> tag added by the
            InboxFilter.

   <b>DKIMValidityFilter</b>
       This filter verifies DKIM signatures of E-Mails with DKIM header, and adds <u>dkim-ok</u> or <u>dkim-fail</u> tags.

   <b>DMARCReportInspectionFilter</b>
       DMARC reports usually come in ZIP files. To check the report you have  to  unpack  and  search  thru  XML
       document which is very tedious. This filter tags the message as follows:

       if  there's  any  SPF failure in any attachment, tag the message with "dmarc-spf-fail" tag, otherwise tag
       with "dmarc-spf-ok"

       if there's any DKIM failure in any attachment, tag the message with "dmarc-dkim-fail" tag, otherwise  tag
       with "dmarc-dkim-ok"

   <b>FolderNameFilter</b>
       For each email, it looks at all folders it is in, and uses the path and filename as a tag, for the email.
       So if you have a procmail or sieve set up that puts emails in folders for you, this might be useful.

       • folder_explicit_list = &lt;folder list&gt;

          • Tag  mails  with tag in &lt;folder list&gt; only. &lt;folder list&gt; is a space separated list, not enclosed in
            quotes or any other way.

          • Empty list means all folders (of course blacklist still applies).

          • The default is empty list.

          • You may use it e.g. to set tags only for specific folders like 'Sent'.

       • folder_blacklist = &lt;folder list&gt;

          • Never tag mails with tag in &lt;folder list&gt;. &lt;folder list&gt; is a space separated list, not enclosed  in
            quotes or any other way.

          • The default is to blacklist no folders.

          • You  may  use it e.g. to avoid mails being tagged as 'INBOX' when there is the more standard 'inbox'
            tag.

       • folder_transforms = &lt;transformation rules&gt;

          • Transform folder names according to the  specified  rules  before  tagging  mails.   &lt;transformation
            rules&gt;  is  a  space  separated list consisting of 'folder:tag' style pairs. The colon separates the
            name of the folder to be transformed from the tag it is to be transformed into.

          • The default is to transform to folder names.

          • You may use the rules e.g. to transform the name of your 'Junk' folder into your 'spam' tag  or  fix
            capitalization of your draft and sent folder:

          folder_transforms = Junk:spam Drafts:draft Sent:sent

       • folder_lowercases = true

         • Use lowercase tags for all folder names

       • maildir_separator = &lt;sep&gt;

          • Use &lt;sep&gt; to split your maildir hierarchy into individual tags.

          • The default is to split on '.'

          • If your maildir hierarchy is represented in the filesystem as collapsed dirs, &lt;sep&gt; is used to split
            it again before applying tags. If your maildir looks like this:

          [...]
          /path/to/maildir/devel.afew/[cur|new|tmp]/...
          /path/to/maildir/devel.alot/[cur|new|tmp]/...
          /path/to/maildir/devel.notmuch/[cur|new|tmp]/...
          [...]

       the mails in your afew folder will be tagged with 'devel' and 'afew'.

       If instead your hierarchy is split by a more conventional '/' or any other divider

          [...]
          /path/to/maildir/devel/afew/[cur|new|tmp]/...
          /path/to/maildir/devel/alot/[cur|new|tmp]/...
          /path/to/maildir/devel/notmuch/[cur|new|tmp]/...
          [...]

       you need to configure that divider to have your mails properly tagged:

          maildir_separator = /

   <b>HeaderMatchingFilter</b>
       This  filter  adds  tags to a message if the named header matches the regular expression given.  The tags
       can be set, or based on the match.  The settings you can use are:

       • header = &lt;header_name&gt;

       • pattern = &lt;regex_pattern&gt;

       • tags = &lt;tag_list&gt;

       If you surround a tag with <u>{}</u> then it will be replaced with the named match.

       Some examples are:

          [HeaderMatchingFilter.1]
          header = X-Spam-Flag
          pattern = YES
          tags = +spam

          [HeaderMatchingFilter.2]
          header = List-Id
          pattern = &lt;(?P&lt;list_id&gt;.*)&gt;
          tags = +lists;+{list_id}

          [HeaderMatchingFilter.3]
          header = X-Redmine-Project
          pattern = (?P&lt;project&gt;.+)
          tags = +redmine;+{project}

       SpamFilter and ListMailsFilter are implemented using HeaderMatchingFilter, and  are  only  slightly  more
       complicated than the above examples.

   <b>InboxFilter</b>
       This  removes  the  <b>new</b>  tag, and adds the <b>inbox</b> tag, to any message that isn't killed or spam.  (The new
       tags are set in your notmuch config, and default to just <b>new</b>.)

   <b>KillThreadsFilter</b>
       If the new message has been added to a thread that has already been tagged <b>killed</b> then add the <b>killed</b> tag
       to this message.  This allows for ignoring all replies to a particular thread.

   <b>ListMailsFilter</b>
       This filter looks for the <u>List-Id</u> header, and if  it  finds  it,  adds  a  tag  <b>lists</b>  and  a  tag  named
       <b>lists/&lt;list-id&gt;</b>.

   <b>MeFilter</b>
       Add  filter  tagging mail sent directly to any of addresses defined in Notmuch config file: <u>primary_email</u>
       or <u>other_email</u>.  Default tag is <u>to-me</u> and can be customized with <u>me_tag</u> option.

   <b>SentMailsFilter</b>
       The settings you can use are:

       • sent_tag = &lt;tag&gt;

          • Add &lt;tag&gt; to all mails sent from one of your configured mail addresses,  <u>and</u>  <u>not</u>  to  any  of  your
            addresses.

          • The default is to add no tag, so you need to specify something.

          • You  may  e.g.  use  it  to  tag  all  mails  sent  by you as 'sent'. This may make special sense in
            conjunction with a mail client that is able to not only search for threads but individual  mails  as
            well.

       • to_transforms = &lt;transformation rules&gt;

          • Transform  <u>To</u>/<u>Cc</u>/<u>Bcc</u>  e-mail  addresses  to  tags  according to the specified rules. &lt;transformation
            rules&gt; is a space separated list  consisting  of  user_part@domain_part'<u>'user_part@domain_part</u>:tags'
            style  pairs.  The  colon  separates  the  e-mail  address  to  be transformed from tags it is to be
            transformed into. ':tags' is optional and if empty, 'user_part' is used as tag.   'tags'  can  be  a
            single tag or semi-colon separated list of tags.

          • It  can be used for example to easily tag posts sent to mailing lists which at this stage don't have
            <u>List-Id</u> field.

   <b>SpamFilter</b>
       The settings you can use are:

       • spam_tag = &lt;tag&gt;

          • Add &lt;tag&gt; to all mails recognized as spam.

          • The default is 'spam'.

          • You may use it to tag your spam as 'junk', 'scum' or whatever suits your mood.   Note  that  only  a
            single tag is supported here.

       Email will be considered spam if the header <u>X-Spam-Flag</u> is present.

   <b>Customizing</b> <b>filters</b>
       To customize these filters, there are basically two different possibilities:

       Let's say you like the SpamFilter, but it is way too polite

       1. Create an filter object and customize it

          [SpamFilter.0] # note the index
          message = meh

       The  index is required if you want to create a new SpamFilter <u>in</u> <u>addition</u> <u>to</u> the default one. If you need
       just one customized SpamFilter, you can drop the index and customize the default instance.

       2. Create a new type...

          [ShitFilter(SpamFilter)]
          message = I hatez teh spam!

       and create an object or two

          [ShitFilter.0]
          [ShitFilter.1]
          message = Me hatez it too.

       You can provide your own filter implementations too. You have to register your filters via entry  points.
       See the afew setup.py for examples on how to register your filters. To add your filters, you just need to
       install your package in the context of the afew application.

</pre><h4><b>MOVE</b> <b>MODE</b></h4><pre>
   <b>Configuration</b> <b>Section</b>
       Here is a full sample configuration for move mode:

          [MailMover]
          folders = INBOX Junk
          rename = False
          max_age = 15

          # rules
          INBOX = 'tag:spam':Junk 'NOT tag:inbox':Archive
          Junk = 'NOT tag:spam AND tag:inbox':INBOX 'NOT tag:spam':Archive

       Below we explain what each bit of this means.

   <b>Rules</b>
       First you need to specify which folders should be checked for mails that are to be moved (as a whitespace
       separated list). Folder names containing whitespace need to be quoted:

          folders = INBOX Junk "Sent Mail"

       Then you have to specify rules that define move actions of the form

          &lt;src&gt; = ['&lt;qry&gt;':&lt;dst&gt;]+

       Every  mail  in the <u>&lt;src&gt;</u> folder that matches a <u>&lt;qry&gt;</u> will be moved into the <u>&lt;dst&gt;</u> folder associated with
       that query.  A message that matches multiple queries will be copied to multiple destinations.

       You can bind as many rules to a maildir folder as you deem necessary. Just add  them  as  elements  of  a
       (whitespace separated) list.

       Please  note,  though,  that  you need to specify at least one rule for every folder given by the <u>folders</u>
       option and at least one folder to check in order to use the move mode.

          INBOX = 'tag:spam':Junk

       will bind one rule to the maildir folder <u>INBOX</u> that states that all  mails  in  said  folder  that  carry
       (potentially among others) the tag <b>spam</b> are to be moved into the folder <u>Junk</u>.

       With  <u>&lt;qry&gt;</u> being an arbitrary notmuch query, you have the power to construct arbitrarily flexible rules.
       You can check for the absence of tags and look out for combinations of attributes:

          Junk = 'NOT tag:spam AND tag:inbox':INBOX 'NOT tag:spam':Archive

       The above rules will move all mails in <u>Junk</u> that don't have the <b>spam</b> tag but do have an  <b>inbox</b>  tag  into
       the directory <u>INBOX</u>. All other mails not tagged with <b>spam</b> will be moved into <u>Archive</u>.

   <b>Max</b> <b>Age</b>
       You  can  limit  the  age  of  mails  you want to move by setting the <u>max_age</u> option in the configuration
       section. By providing

          max_age = 15

       afew will only check mails at most 15 days old.

   <b>Rename</b>
       Set this option if you are using the <u>mbsync</u> IMAP syncing tool.  <u>mbsync</u> adds a unique identifier to files'
       names when it syncs them.  If the <u>rename</u> option is not set, moving files  can  cause  UID  conflicts  and
       prevent  <u>mbsync</u>  from syncing with error messages such as "Maildir error: duplicate UID 1234" or "UID 567
       is beyond highest assigned UID 89".

       When the option is set, afew will rename files while moving them, removing the UID but  preserving  other
       <u>mbsync</u> information.  This allows <u>mbsync</u> to assign a new UID to the file and avoid UID conflicts.

       If you are using <u>offlineimap</u>, you can safely ignore this option.

          rename = True

   <b>Limitations</b>
       <b>(1)</b> Rules don't manipulate tags.

          INBOX = 'NOT tag:inbox':Archive
          Junk = 'NOT tag:spam':INBOX

       The  above  combination of rules might prove tricky, since you might expect de-spammed mails to end up in
       <u>INBOX</u>. But since the <u>Junk</u> rule will <u>not</u> add an <b>inbox</b> tag, the next run in move mode might very well  move
       the matching mails into <u>Archive</u>.

       Then again, if you remove the <b>spam</b> tag and do not set an <b>inbox</b> tag, how would you come to expect the mail
       would end up in your INBOX folder after moving it? ;)

       <b>(2)</b>  There  is  no 1:1 mapping between folders and tags. And that's a feature. If you tag a mail with two
       tags and there is a rule for each of them, both rules will apply.  Your mail  will  be  copied  into  two
       destination folders, then removed from its original location.

</pre><h4><b>EXTENDING</b> <b>AFEW</b></h4><pre>
       You  can  put  python files in <u><a href="file:~/.config/afew/">~/.config/afew/</a></u> and they will be imported by afew.  If you use that python
       file to define a <u>Filter</u> class and use the <u>register_filter</u> decorator then you can  refer  to  it  in  your
       filter configuration.

       So an example small filter you could add might be:

          from afew.filters.BaseFilter  import Filter
          from afew.FilterRegistry import register_filter

          PROJECT_MAPPING = {
              'fabric': 'deployment',
              'oldname': 'new-name',
          }

          @register_filter
          class RedmineFilter(Filter):
              message = 'Create tag based on redmine project'
              query = 'NOT tag:redmine'

              def handle_message(self, message):
                  project = message.get_header('X-Redmine-Project')
                  if project in PROJECT_MAPPING:
                      project = PROJECT_MAPPING[project]
                  self.add_tags(message, 'redmine', project)

       We  have  defined  the  <u>message</u>  and <u>query</u> class variables that are used by the parent class <u>Filter</u>.  The
       <u>message</u> is printed when running with verbose flags.  The <u>query</u> is used to select messages to run  against
       - here we ensure we don't bother looking at messages we've already looked at.

       The  <u>handle_message()</u>  method  is  the  key  one to implement.  This will be called for each message that
       matches the query.  The argument is a <u>notmuch</u> <u>message</u> <u>object</u> and the key methods used by the afew filters
       are <u>header()</u>, <u>filename()</u> and <u>get_thread()</u>.

       Of the methods inherited from the <u>Filter</u> class the key ones are <u>add_tags()</u> and  <u>remove_tags()</u>,  but  read
       about the <u>Implementation</u> or just read the source code to get your own ideas.

       Once you've defined your filter, you can add it to your config like any other filter:

          [RedmineFilter]

</pre><h4><b>IMPLEMENTATION</b></h4><pre>
   <b>Database</b> <b>Manager</b>
       The design of the database manager was inspired by alots database manager <b>alot.db.DBManager</b>.

       <b>class</b> <b>afew.Database.Database</b>
              Convenience wrapper around <u>notmuch</u>.

              <b>add_message(path,</b> <b>sync_maildir_flags=False,</b> <b>new_mail_handler=None)</b>
                     Adds the given message to the notmuch index.

                     <b>Parameters</b>

                            • <b>path</b> (<u>str</u>) -- path to the message

                            • <b>sync_maildir_flags</b>  (<u>bool</u>)  -- if <u>True</u> notmuch converts the standard maildir flags
                              to tags

                            • <b>new_mail_handler</b> (a function that is called with a <b>notmuch.Message</b> object  as  its
                              only argument) -- callback for new messages

                     <b>Raises</b> <b>notmuch.NotmuchError</b> if adding the message fails

                     <b>Returns</b>
                            a <b>notmuch.Message</b> object

              <b>close()</b>
                     Closes the notmuch database if it has been opened.

              <b>do_query(query)</b>
                     Executes a notmuch query.

                     <b>Parameters</b>
                            <b>query</b> (<u>str</u>) -- the query to execute

                     <b>Returns</b>
                            the query result

                     <b>Return</b> <b>type</b>
                            <b>notmuch.Query</b>

              <b>get_messages(query,</b> <b>full_thread=False)</b>
                     Get all messages matching the given query.

                     <b>Parameters</b>

                            • <b>query</b> (<u>str</u>) -- the query to execute using <u>Database.do_query()</u>

                            • <b>full_thread</b> (<u>bool</u>) -- return all messages from mathing threads

                     <b>Returns</b>
                            an iterator over <b>notmuch.Message</b> objects

              <b>remove_message(path)</b>
                     Remove the given message from the notmuch index.

                     <b>Parameters</b>
                            <b>path</b> (<u>str</u>) -- path to the message

              <b><a href="../manmessage/walk_replies.message.html">walk_replies</a>(message)</b>
                     Returns all replies to the given message.

                     <b>Parameters</b>
                            <b>message</b> (<b>notmuch.Message</b>) -- the message to start from

                     <b>Returns</b>
                            an iterator over <b>notmuch.Message</b> objects

              <b>walk_thread(thread)</b>
                     Returns all messages in the given thread.

                     <b>Parameters</b>
                            <b>thread</b> (<b>notmuch.Thread</b>) -- the tread you are interested in

                     <b>Returns</b>
                            an iterator over <b>notmuch.Message</b> objects

   <b>Filter</b>
       <b>class</b> <b>afew.filters.BaseFilter.Filter(database,</b> <b>**kwargs)</b>

              <b>flush_changes()</b>
                     (Re)Initializes the data structures that hold the enqueued changes to the notmuch database.

   <b>Configuration</b> <b>management</b>
   <b>Miscellanious</b> <b>utility</b> <b>functions</b>
       • <u>Index</u>

       • <u>Module</u> <u>Index</u>

       • <u>Search</u> <u>Page</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       Justus Winter

</pre><h4><b>COPYRIGHT</b></h4><pre>
       afewmail project

3.0.1                                             Mar 15, 2025                                           <u><a href="../man1/AFEW.1.html">AFEW</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>