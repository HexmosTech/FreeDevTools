<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>samtools-calmd - calculates MD and NM tags</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/samtools">samtools_1.21-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       samtools-calmd - calculates MD and NM tags

</pre><h4><b>SYNOPSIS</b></h4><pre>
       samtools calmd [<b>-Eeubr</b>] [<b>-C</b> <u>capQcoef</u>] <u>aln.bam</u> <u>ref.fasta</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Generate  the  MD  tag.  If the MD tag is already present, this command will give a warning if the MD tag
       generated is different from the existing tag. Output SAM by default.

       Calmd can also read and write CRAM files although in most cases it is pointless as CRAM  recalculates  MD
       and  NM  tags  on the fly.  The one exception to this case is where both input and output CRAM files have
       been / are being created with the <u>no_ref</u> option.

       Note that some aligners do not include sequence or  confidence  values  in  secondary  and  supplementary
       alignment  records.   Where  this  happens in SAM files, a “*” character will be seen in the <b>SEQ</b> and <b>QUAL</b>
       columns.  These records will be skipped, as it is not possible to recalculate the MD and NM tags  without
       access  to  the  query sequence.  <b>samtools</b> <b>calmd</b> will emit a warning if any records have been skipped for
       this reason.

       Calmd works best on position-sorted input files, as with  these  it  can  stream  through  the  reference
       sequence  and  so doesn't have to store much reference data at any one time.  For other orderings, it may
       have to switch to a caching mode which keeps the reference sequences in  memory.   This  will  result  in
       calmd using more memory (up to the full size of the reference) than it would in the position-sorted case.
       Note  also  that versions of samtools calmd up to 1.16.1 should only be used on position sorted inputs as
       they could be very slow when run on other orderings.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-A</b>      When used jointly with <b>-r</b> this option overwrites the original base quality.

       <b>-e</b>      Convert a the read base to = if it is identical to the aligned reference base. Indel caller  does
               not support the = bases at the moment.

       <b>-u</b>      Output uncompressed BAM

       <b>-b</b>      Output compressed BAM

       <b>-C</b> <u>INT</u>  Coefficient  to  cap mapping quality of poorly mapped reads. See the <b>mpileup</b> command for details.
               [0]

       <b>-r</b>      Compute the BQ tag (without -A) or cap base quality by BAQ (with -A).

       <b>-E</b>      Extended BAQ calculation. This option trades specificity for sensitivity, though  the  effect  is
               minor.

       <b>--no-PG</b> Do not add a @PG line to the header of the output file.

       <b>-@,</b> <b>--threads</b> <u>INT</u>
               Number of input/output compression threads to use in addition to main thread [0].

</pre><h4><b>EXAMPLES</b></h4><pre>
       o Dump BAQ applied alignment for other SNP callers:

           samtools calmd -bAr aln.bam &gt; aln.baq.bam

         It  adds  and  corrects  the  <b>NM</b> and <b>MD</b> tags at the same time. The <b>calmd</b> command also comes with the <b>-C</b>
         option, the same as the one in <b>mpileup</b>.  Apply if it helps.

</pre><h4><b>AUTHOR</b></h4><pre>
       Written by Heng Li from the Sanger Institute.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/samtools.1.html">samtools</a></u>(1), <u><a href="../man1/samtools-mpileup.1.html">samtools-mpileup</a></u>(1)

       Samtools website: &lt;<a href="http://www.htslib.org/">http://www.htslib.org/</a>&gt;

samtools-1.21                                   12 September 2024                              <u><a href="../man1/samtools-calmd.1.html">samtools-calmd</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>