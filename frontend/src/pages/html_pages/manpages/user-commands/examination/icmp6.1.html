<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>icmp6 - A security assessment tool for attack vectors based on ICMPv6 packets</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/ipv6toolkit">ipv6toolkit_2.0+ds.1-2build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       icmp6 - A security assessment tool for attack vectors based on ICMPv6 packets

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>icmp6</b>  [<b>-i</b>  <u>INTERFACE</u>]  [-s  SRC_ADDR[/LEN]]  [-d  DST_ADDR]  [-S  LINK_SRC_ADDR]  [-D LINK-DST-ADDR] [-c
       HOP_LIMIT] [-y  FRAG_SIZE]  [-u  DST_OPT_HDR_SIZE]  [-U  DST_OPT_U_HDR_SIZE]  [-H  HBH_OPT_HDR_SIZE]  [-t
       TYPE[:CODE]  | -e CODE | -A CODE -V CODE -R CODE] [-r TARGET_ADDR] [-x PEER_ADDR] [-c HOP_LIMIT] [-m MTU]
       [-O   POINTER]   [-p   PAYLOAD_TYPE]   [-P   PAYLOAD_SIZE]   [-n]    [-a    SRC_PORTL[:SRC_PORTH]]    [-o
       DST_PORTL[:DST_PORTH]]  [-X  TCP_FLAGS]  [-q  TCP_SEQ]  [-Q  TCP_ACK]  [-V TCP_URP] [-w TCP_WIN] [-M] [-j
       PREFIX[/LEN]] [-k PREFIX[/LEN]] [-J LINK_ADDR] [-K LINK_ADDR] [-b  PREFIX[/LEN]]  [-g  PREFIX[/LEN]]  [-B
       LINK_ADDR] [-G LINK_ADDR] [-f] [-L | -l] [-z] [-v] [-h]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>icmp6</b>  allows the assessment of IPv6 implementations with respect to a variety of attack vectors based on
       ICMPv6 error messages. It is part of the SI6 Networks' IPv6 Toolkit: a security assessment suite for  the
       IPv6 Protocols.

       This  tool  has  two  modes  of  operation:  "active" and "listening". In active mode, the tool attacks a
       specific target without listening to any incoming traffic, while in "listening" mode the tool listens  to
       traffic on the local network, and launches an attack in response to such traffic. Active mode is employed
       if an IPv6 Destination Address is specified. "Listening" mode is employed if the "-L" option (or its long
       counterpart "--listen") is set. If both an attack target and the "-L" option are specified, the attack is
       launched  against  the  specified  target,  and then the tool enters "listening" mode to respond incoming
       packets with ICMPv6 error messages.

       The tool supports filtering of incoming packets based  on  the  Ethernet  Source  Address,  the  Ethernet
       Destination  Address,  the IPv6 Source Address, and the IPv6 Destination Address.  There are two types of
       filters: "block filters" and "accept filters". If any "block  filter"  is  specified,  and  the  incoming
       packet matches any of those filters, the message is discarded (and thus no ICMPv6 error messages are sent
       in  response).  If any "accept filter" is specified, incoming packets must match the specified filters in
       order for the tool to respond with ICMPv6 error messages.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>icmp6</b> takes its parameters as command-line options. Each of the options can be  specified  with  a  short
       name  (one  character  preceded  with  the  hyphen character, as e.g. "-i") or with a long name (a string
       preceded with two hyphen characters, as e.g. "--interface").

       The icmp6 tool supports IPv6 fragmentation, which might be of use to circumvent layer-2 filtering  and/or
       Network  Intrusion  Detection  Systems (NIDS). However, IPv6 fragmentation is not enabled by default, and
       must be explicitly enabled with the "-y" option.

       <b>-i</b> <u>INTERFACE</u><b>,</b> <b>--interface</b> <u>INTERFACE</u>
              This option specifies the network interface that the tool will use.  If  the  destination  address
              ("-d"  option)  is a link-local address, or the "listening" ("-L") mode is selected, the interface
              must be explicitly specified. The interface  may  also  be  specified  along  with  a  destination
              address, with the "-d" option.

       <b>-s</b> <u>SRC_ADDR</u><b>,</b> <b>--src-address</b> <u>SRC_ADDR</u>

              This  option  specifies the IPv6 source address (or IPv6 prefix) to be used for the Source Address
              of the attack packets. If a prefix is specified, the Source Address is randomly selected from that
              prefix. If this option is left unspecified, the IPv6 Source  Address  of  the  attack  packets  is
              randomly selected from the prefix ::/0.

       <b>-d</b> <u>DST_ADDR</u><b>,</b> <b>--dst-address</b> <u>DST_ADDR</u>

              This  option specifies the IPv6 Destination Address of the victim. It can be left unspecified only
              if the "-L" option is selected (that is, if the tool is to operate in "listening" mode).

              When operating in "listening" mode  ("-L"  option),  the  IPv6  Destination  Address  is  selected
              according to the IPv6 Source Address of the incoming packet.

       <b>-S</b> <u>SRC_LINK_ADDR</u><b>,</b> <b>--src-link-address</b> <u>SRC_LINK_ADDR</u>

              This  option  specifies  the link-layer Source Address of the attack packets. If left unspecified,
              the link-layer Source Address is randomized.

       <b>-D</b> <u>DST_LINK_ADDR</u><b>,</b> <b>--dst-link-address</b> <u>DST_LINK_ADDR</u>

              This option  specifies  the  link-layer  Destination  Address  of  the  attack  packets.  If  left
              unspecified,  it  is  set  to  that  of  the  local router (for non-local destinations) or to that
              corresponding to the destination host (for local hosts).

              When operating in "listening" mode, the link-layer Destination Address is set  to  the  link-layer
              Source Address of the incoming packet.

       <b>-c</b> <u>HOP_LIMIT</u><b>,</b> <b>--hop-limit</b> <u>HOP_LIMIT</u>

              This  option  specifies the Hop Limit to be used for the Redirect messages. If this option is left
              unspecified, the Hop Limit is randomized to a value between 64 and 243.

       <b>-y</b> <u>SIZE</u><b>,</b> <b>--frag-hdr</b> <u>SIZE</u>

              This option specifies that the ICMPv6 error messages must be fragmented. The fragment size must be
              specified as an argument to this option.

       <b>-u</b> <u>HDR_SIZE</u><b>,</b> <b>--dst-opt-hdr</b> <u>HDR_SIZE</u>

              This option specifies that a Destination  Options  header  is  to  be  included  in  the  outgoing
              packet(s).  The  extension header size must be specified as an argument to this option (the header
              is filled with padding options). Multiple Destination Options headers may be specified by means of
              multiple "-u" options.

       <b>-U</b> <u>HDR_SIZE</u><b>,</b> <b>--dst-opt-u-hdr</b> <u>HDR_SIZE</u>

              This option specifies a Destination Options header to be included in the "unfragmentable part"  of
              the  outgoing  packet(s).  The  header  size  must be specified as an argument to this option (the
              header is filled with padding options). Multiple Destination Options headers may be  specified  by
              means of multiple "-U" options.

       <b>-H</b> <u>HDR_SIZE</u><b>,</b> <b>--hbh-opt-hdr</b> <u>HDR_SIZE</u>

              This  option  specifies  that  a  Hop-by-Hop  Options  header  is  to  be included in the outgoing
              packet(s). The header size must be specified as an argument to this option (the header  is  filled
              with  padding  options). Multiple Hop-by-Hop Options headers may be specified by means of multiple
              "-H" options.

       <b>-t</b> <u>TYPE</u><b>,</b> <b>--icmp6</b> <b>TYPE</b>

              This option specifies the Type and  Code  of  the  ICMPv6  error  message  in  the  form  "--icmp6
              TYPE:CODE".  If  left  unspecified,  the  ICMPv6  error  message  defaults  to "Parameter Problem,
              Erroneous header field encountered" (Type 4, Code 0).

              Note: Other options (such as "--icmp6-unreachable") provide an alternative for setting the  ICMPv6
              Type and Code.

       <b>-e</b>, <b>--icmp6-dest-unreach</b>

              This  option sets the ICMPv6 Type to "1" (Destination Unreachable), and allows the user to specify
              the ICMPv6 Code, in the form "--icmp6-dest-unreach CODE".

              Note: this option is an alternative to the "-t" option for setting the ICMPv6 Type and Code.

       <b>-E</b>, <b>--icmp6-packet-too-big</b>

              This option sets the ICMPv6 Type to "1", and the ICMPv6 Code to "0" (Packet Too Big).

              Note: this option is an alternative to the "-t" option for setting the ICMPv6 Type and Code.

       <b>-A</b>, <b>--icmp6-time-exceeded</b>

              This option sets the ICMPv6 Type to "3" (Time Exceeded), and allows the user to specify the ICMPv6
              Code, in the form "--icmp6-time-exceeded CODE".

              Note: this option is an alternative to the "-t" option for setting the ICMPv6 Type and Code.

       <b>-R</b>, <b>--icmp6-param-problem</b>

              This option sets the ICMPv6 Type to "4" (Parameter Problem), and allows the user  to  specify  the
              ICMPv6 Code, in the form "--icmp6-param-problem CODE".

              Note: this option is an alternative to the "-t" option for setting the ICMPv6 Type and Code.

       <b>-m</b> <u>MTU</u><b>,</b> <b>--mtu</b> <u>MTU</u>

              This specifies the value of the "MTU" field of ICMPv6 Packet Too Big error messages.

       <b>-O</b> <u>POINTER</u><b>,</b> <b>--pointer</b> <u>POINTER</u>

              This option specifies the value of the "Pointer" field of ICMPv6 Parameter Problem error messages.

       <b>-p</b> <u>TYPE</u><b>,</b> <b>--payload-type</b> <u>TYPE</u>

              This  option  specifies the payload type to be included in the ICMPv6 Payload. Currently supported
              payloads are "TCP", "UDP", and "ICMP6". The payload-type defaults to "TCP".

              When the tool operates in "Listening" mode, this option specifies the type  of  packets  the  tool
              will listen to. In listening mode, an additional type can be specified: "IP6"; this will cause the
              tool to listen to all IPv6 traffic.

       <b>-P</b> <u>SIZE</u><b>,</b> <b>--payload-size</b> <u>SIZE</u>

              Size of the payload to be included in the ICMPv6 Payload (with the payload type being specified by
              the  "-p"  option).  By  default,  as  many  bytes as possible are included, without exceeding the
              minimum IPv6 MTU (1280 bytes).

       <b>-n</b>, <b>--no-payload</b>

              This option specifies that no payload should be included within the ICMPv6 error message.

       <b>-C</b> <u>HOP_LIMIT</u><b>,</b> <b>--ipv6-hlim</b> <u>HOP_LIMIT</u>

              This option specifies the Hop Limit of the IPv6 packet included in the payload of the ICMPv6 error
              message. If this option is left unspecified, the Hop Limit is randomized to a value between 64 and
              243.

       <b>-r</b> <u>ADDRESS</u><b>,</b> <b>--target-addr</b> <u>ADDRESS</u>

              This option specifies the Source Address of the IPv6 packet that is embedded in the  ICMPv6  error
              message. If left unspecified, it is set to the same address as the IPv6 Destination Address of the
              outer packet.

              When  operating  in "Listening mode", the tool automatically embeds a piece of the received packet
              (unless otherwise specified by the "-n" option), and hence the IPv6 Source Address of the embedded
              IPv6 packet is set accordingly.

       <b>-x</b> <u>ADDRESS</u><b>,</b> <b>--peer-addr</b> <u>ADDRESS</u>

              This option specifies the Destination Address of the IPv6 packet that is embedded  in  the  ICMPv6
              error message. If left unspecified, it is set to a random value.

              When  operating  in "Listening mode", the tool automatically embeds a piece of the received packet
              (unless otherwise specified by the "-n" option), and hence the IPv6  Destination  Address  of  the
              embedded IPv6 packet is set accordingly.

              Note:  since  the victim host is expected to check that the ICMPv6 error message corresponds to an
              ongoing communication instance, when operating in "active mode", this option should be  set  to  a
              value that corresponds to an ongoing communication instance.

       <b>-o</b> <u>PORT</u><b>,</b> <b>--target-port</b> <u>PORT</u>

              This option specifies the Source Port of the TCP or UDP packet contained in the ICMPv6 Payload. If
              a  port  range  is specified in the form "-o LOWPORT:HIGHPORT" the tool will send one ICMPv6 error
              message for each port in that range.

              Note: This option is meaningful only if "TCP" or "UDP" have been specified (with the "-p" option).

       <b>-a</b> <u>PORT</u><b>,</b> <b>--peer-port</b> <u>PORT</u>

              This option specifies the Destination Port of the TCP  or  UDP  packet  contained  in  the  ICMPv6
              Payload.  If  a  port  range is specified in the form "-o LOWPORT:HIGHPORT" the tool will send one
              ICMPv6 error message for each port in that range.

              Note: This option is meaningful only if "TCP" or "UDP" have been specified (with the "-p" option).

       <b>-X</b> <u>TCP_FLAGS</u><b>,</b> <b>--tcp-flags</b> <u>TCP_FLAGS</u>

              This option specifies the flags of the TCP header contained in the ICMPv6 Payload. The  flags  are
              specified  as "F" (FIN), "S" (SYN), "R" (RST), "P" (PSH), "A" (ACK), "U" (URG), "X" (no flags). If
              left unspecified, only the "ACK" bit is set.

              Note: This option is meaningful only if "TCP" has been specified (with the "-p" option).

       <b>-q</b> <u>SEQ_NUMBER</u><b>,</b> <b>--tcp-seq</b> <u>SEQ_NUMBER</u>

              This option specifies the Sequence Number of the TCP header contained in the  ICMPv6  Payload.  If
              left unspecified, the Sequence Number is randomized.

              Note: This option is meaningful only if "TCP" has been specified (with the "-p" option).

       <b>-Q</b> <u>ACK_NUMBER</u><b>,</b> <b>--tcp-ack</b> <u>ACK_NUMBER</u>

              This  option  specifies  the  Acknowledgment  Number  of  the  TCP  header contained in the ICMPv6
              Payload. If left unspecified, the Acknowledgment Number is randomized.

              Note: This option is meaningful only if "TCP" has been specified (with the "-p" option).

       <b>-V</b> <u>URG_POINTER</u><b>,</b> <b>--tcp-urg</b> <u>URG_POINTER</u>

              This option specifies the Urgent Pointer of the TCP header contained in  the  ICMPv6  Payload.  If
              left unspecified, the Urgent Pointer is set to 0.

              Note: This option is meaningful only if "TCP" has been specified (with the "-p" option).

       <b>-w</b> <u>TCP_WIN</u><b>,</b> <b>--tcp-win</b> <u>TCP_WIN</u>

              This  option  specifies  the  Window  of  the  TCP header contained in the ICMPv6 Payload. If left
              unspecified, the Window is randomized.

              Note: This option is meaningful only if "TCP" has been specified (with the "-p" option).

       <b>-j</b> <u>SRC_ADDR</u><b>,</b> <b>--block-src</b> <u>SRC_ADDR</u>

              This option sets a block filter for the incoming packets, based on their IPv6 Source  Address.  It
              allows the specification of an IPv6 prefix in the form "-j prefix/prefixlen". If the prefix length
              is  not  specified,  a prefix length of "/128" is selected (i.e., the option assumes that a single
              IPv6 address, rather than an IPv6 prefix, has been specified).

       <b>-k</b> <u>DST_ADDR</u><b>,</b> <b>--block-dst</b> <u>DST_ADDR</u>

              This option sets a block filter for the incoming Neighbor Solicitation messages,  based  on  their
              IPv6  Destination  Address.  It  allows  the  specification  of  an  IPv6  prefix  in the form "-k
              prefix/prefixlen". If the prefix length is not specified, a prefix length of  "/128"  is  selected
              (i.e.,  the  option  assumes  that  a  single  IPv6  address, rather than an IPv6 prefix, has been
              specified).

       <b>-J</b> <u>SRC_ADDR</u><b>,</b> <b>--block-link-src</b> <u>SRC_ADDR</u>

              This option sets a block filter for  the  incoming  packets,  based  on  their  link-layer  Source
              Address.  The  option  must  be  followed  by  a  link-layer  address (currently, only Ethernet is
              supported).

       <b>-K</b> <u>DST_ADDR</u><b>,</b> <b>--block-link-dst</b> <u>DST_ADDR</u>

              This option sets a block filter for the incoming packets, based on  their  link-layer  Destination
              Address.  The  option  must  be  followed  by  a  link-layer  address (currently, only Ethernet is
              supported).

       <b>-b</b> <u>SRC_ADDR</u><b>,</b> <b>--accept-src</b> <u>SRC_ADDR</u>

              This option sets an accept filter for the incoming packets, based on their IPv6 Source Address. It
              allows the specification of an IPv6 prefix in the form "-b prefix/prefixlen". If the prefix length
              is not specified, a prefix length of "/128" is selected (i.e., the option assumes  that  a  single
              IPv6 address, rather than an IPv6 prefix, has been specified).

       <b>-g</b> <u>DST_ADDR</u><b>,</b> <b>--accept-dst</b> <u>DST_ADDR</u>

              This  option  sets  a  accept  filter  for  the  incoming packets, based on their IPv6 Destination
              Address. It allows the specification of an IPv6 prefix in the form "-g prefix/prefixlen".  If  the
              prefix  length  is  not specified, a prefix length of "/128" is selected (i.e., the option assumes
              that a single IPv6 address, rather than an IPv6 prefix, has been specified).

       <b>-B</b> <u>SRC_ADDR</u><b>,</b> <b>--accept-link-src</b> <u>SRC_ADDR</u>

              This option sets an accept filter for the incoming Neighbor Solicitation messages, based on  their
              link-layer  Source  Address.  The option must be followed by a link-layer address (currently, only
              Ethernet is supported).

       <b>-G</b> <u>DST_ADDR</u><b>,</b> <b>--accept-link-dst</b> <u>DST_ADDR</u>

              This option sets an accept filter for the incoming packets, based on their link-layer  Destination
              Address.  The  option  must  be  followed  by  a  link-layer  address (currently, only Ethernet is
              supported).

       <b>-f</b>, <b>--sanity-filters</b>

              This option automatically adds a "block filter" for the IPv6 Source Address of the packets.

              Note: This option may be desirable when the tool operates in "Listening mode" and is instructed to
              listen to "ICMP6" or "IP6" packets (thus possibly avoiding packet loops).

       <b>-l</b>, <b>--loop</b>

              This option instructs the icmp6 tool to send periodic ICMPv6 error messages to  the  victim  node.
              The amount of time to pause between sending ICMPv6 error messages can be specified by means of the
              "-z" option, and defaults to 1 second. Note that this option cannot be set in conjunction with the
              "-L" ("--listen") option.

       <b>-z</b>, <b>--sleep</b>

              This  option specifies the amount of time to pause between sending ICMPv6 error messages (when the
              "--loop" option is set). If left unspecified, it defaults to 1 second.

       <b>-L</b>, <b>--listen</b>

              This instructs the icmp6 tool to operate in "Listening" mode (possibly  after  attacking  a  given
              node). Note that this option cannot be used in conjunction with the "-l" ("--loop") option.

       <b>-v</b>, <b>--verbose</b>

              This  option  instructs  the  icmp6 tool to be verbose.  When the option is set twice, the tool is
              "very verbose", and the tool also informs which packets have  been  accepted  or  discarded  as  a
              result of applying the specified filters.

       <b>-h</b>, <b>--help</b>

              Print help information for the <b>icmp6</b> tool.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following sections illustrate typical use cases of the <b>icmp6</b> tool.

       <b>Example</b> <b>#1</b>

       # icmp6 -i eth0 -L -p TCP -v

       The  tool  employs  the  network  interface  "eth0", and operates in "Listening" mode ("-L" option). Each
       ICMPv6 error message will contain the ICMPv6 Payload as many  bytes  from  the  captured  packet  without
       exceeding  the  minimum  IPv6 MTU (1280 bytes). The tool will print detailed information about the attack
       ("-v" option).

       <b>Example</b> <b>#2</b>

       # icmp6 --icmp6-packet-too-big -p ICMP6 -d 2001:db8:10::1 --peer-addr 2001:db8:11::2 -m 1240 -v

       The tool will send an ICMPv6 Packet Too Big error message that advertises  an  MTU  of  1240  bytes.  The
       ICMPv6  error message will be sent to the address " "2001:db8:10::1". The ICMPv6 error message will embed
       an ICMPv6 Echo Request message with the  Source  Address  set  to   "2001:db8:10::1"  (i.e.,  Destination
       Address  of  the  error  message),  and  the  Destination  Address set to "2001:db8:11::2) ("--peer-addr"
       option). The value of the "Identifier" and "Sequence Number" fields of the embedded ICMPv6  Echo  Request
       message will be randomized. The tool will provide detailed information about the attack ("-v" option).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       RFC  5927  (available  at  &lt;<a href="http://www.rfc-editor.org/rfc/rfc5927.txt">http://www.rfc-editor.org/rfc/rfc5927.txt</a>&gt;)  and  "Security Assessment of the
       Transmission            Control            Protocol            (TCP)"            (available            at
       &lt;<a href="http://www.si6networks.com/publications/tn-03-09-security-assessment-TCP.pdf">http://www.si6networks.com/publications/tn-03-09-security-assessment-TCP.pdf</a>&gt;)   for   a  discussion  of
       ICMPv6 attacks against TCP.

</pre><h4><b>AUTHOR</b></h4><pre>
       The <b>icmp6</b> tool and the corresponding manual pages were produced by Fernando Gont  &lt;<a href="mailto:fgont@si6networks.com">fgont@si6networks.com</a>&gt;
       for SI6 Networks.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2011-2013 Fernando Gont.

       Permission  is  granted  to  copy, distribute and/or modify this document under the terms of the GNU Free
       Documentation License, Version 1.3 or any later version published by the Free Software  Foundation;  with
       no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A copy of the license is available
       at <u>&lt;<a href="http://www.gnu.org/licenses/fdl.html">http://www.gnu.org/licenses/fdl.html</a>&gt;</u>.

                                                                                                        <u><a href="../man1/ICMP6.1.html">ICMP6</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>