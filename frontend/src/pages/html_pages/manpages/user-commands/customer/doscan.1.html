<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>doscan - Denial Of Service Capable Auditing of Networks</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/doscan">doscan_0.3.3-1.1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       doscan - Denial Of Service Capable Auditing of Networks

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>doscan</b> <u>options</u> <u>prefix...</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>doscan</b> is a tool to discover TCP services ony our network.  It is designed for scanning a single ports on
       a  large  network.   (There are better tools for scanning many ports on a small set of hosts, for example
       <b><a href="../man8/nmap.8.html">nmap</a></b>(8).)

       The <u>prefix</u> parameter instructs <b>doscan</b> to scan all addresses in  this  prefix.   Prefix  notation  is,  as
       usual, <u>A.B.C.D/L</u>, where <u>A.B.C.D</u> is an IP address in dotted-quad notation, and <u>L</u> is a prefix length from 1
       to 32.  If the <u>/L</u> part is omitted, <u>/32</u> is assumed (and a single host is scanned).

       <b>doscan</b>  uses  a  random  scatter  technology  to  distribute the load across the network.  Within a given
       prefix, hosts are not scanned sequentially, but in  a  random-looking,  but  reproducible  order.   As  a
       result,  <b>doscan</b>  will not stress-test the network edge (just the next hop).  (The prefixes themselves are
       scanned in order.)

</pre><h4><b>OPTIONS</b></h4><pre>
       The <b>--port</b> option is mandatory, all other options are optional.

       <b>-a</b> <u>timeout</u><b>,</b> <b>--add-timeout</b> <u>timeout</u>
       <b>-A</b> <u>count</u><b>,</b> <b>--add-burst</b> <u>count</u>
              These options specify the timeout (in milliseconds) before new  connections  are  added,  and  the
              number  of  new  connections  or  hosts  to add in one burst.  Each <u>timeout</u> millisecond, <u>count</u> new
              hosts are contacted.  (The per-host timeout controlled by the <b>--timeout</b> option is independent.  It
              specifies the timeout once the first packet has been sent.)

       <b>-b</b> <u>count</u><b>,</b> <b>--banner</b> <u>count</u>
              <b>doscan</b> reads at most <u>count</u> bytes from the remote host.  The exact effect  of  this  option  varies
              among protocol modules, see the <b>PROTOCOL</b> <b>MODULES</b> section for details.

       <b>-c</b> <u>count</u><b>,</b> <b>--connections</b> <u>count</u>
              At  most  <u>count</u>  connections are established in parallel. See <b>CAVEATS</b> below for problems resulting
              from system file descriptor limits, and instructions for choosing this parameter.  By default,  at
              most 50 parallel connections are established.

       <b>-E,</b> <b>--no-epoll</b>
              Do not use the <b>epoll</b> kernel interface even if it's available (useful for debugging).

       <b>-f,</b> <b>--file</b> <u>name</u>
              <b>doscan</b> reads prefixes from the file <u>name</u>, in addition to the command line.  The file shall contain
              one  prefix  per  line.   See  the  <b>DESCRIPTION</b>  section  above  for the prefix format.  To better
              distribute scanning of long prefix lists, all prefixies are reorded randomly if the <b>--file</b>  option
              is used.

       <b>-i,</b> <b>--indicator</b>
              Display  a  progress  indicator.  If <b>doscan</b> is invoked with this option, the number of connections
              which have been established so far, the total number of addresses to be  scanned,  the  number  of
              currently  active connections, and the number of hosts for which a report entry has been generated
              are displayed periodically.

       <b>-n,</b> <b>--net-errors</b>
              Instructs <b>doscan</b> to report network errors even if  they  prevent  a  connection.   Normally,  such
              errors are suppressed.

       <b>-o</b> <u>format</u><b>,</b> <b>--output</b> <u>format</u>
              This  option  changes  the format which <b>doscan</b> uses to report its findings.  See the <b>OUTPUT</b> <b>FORMAT</b>
              section below for details.

       <b>-p</b> <u>port</u><b>,</b> <b>--port</b> <u>port</u>
              The <b>--port</b> option controls to which TCP port <b>doscan</b> connects when scanning a host.

       <b>--protocol</b> <b>Istring</b>, -P Istring
              Chooses the protocol module <u>string</u>.  See the <b>PROTOCOL</b> <b>MODULES</b> section for information on available
              protocol modules.

       <b>--send</b> <u>string</u><b>,</b> <b>-s</b> <u>string</u>
       <b>--receive</b> <u>regexp</u><b>,</b> <b>-r</b> <u>regexp</u>
              The effects of these options depend on the protocol module.  See the <b>PROTOCOL</b> <b>MODULES</b> section  for
              details.

       <b>--style</b> <u>style</u><b>,</b> <b>-S</b> <u>style</u>
              This option controls the output style.  See the <b>OUTPUT</b> <b>FORMAT</b> section for details.

       <b>-t</b> <u>timeout</u><b>,</b> <b>--timeout</b> <u>timeout</u>
              This  option  sets  the  connect  timeout  to <u>timeout</u> milliseconds.  If this time passes without a
              successfully established connection, <b>doscan</b> skips the hosts.

       <b>-v,</b> <b>--verbose</b>
              Turn on additional reporting to standard error.

       <b>-h,</b> <b>--help</b>
              Display help message and exit.

       <b>-V,</b> <b>--version</b>
              Output version information and exit.

</pre><h4><b>PROTOCOL</b> <b>MODULES</b></h4><pre>
       <b>doscan</b> supports several protocol modules.  By default, the generic <b>tcp</b> module is used, but you can choose
       another module using the <b>--protocol</b> option.  The effect of the <b>--banner</b>,  <b>--send</b>  and  <b>--receive</b>  options
       depends on the protocol module.  Available modules include:

       <b>http</b>   This  module  causes  <b>doscan</b>  to  connect  to HTTP servers, send a request, and collect the server
              identification from the response.

              The <b>--banner</b> option specifies the maximum receive buffer size.  It defaults to 4000 bytes.

              <b>The</b> <b>--send</b> option specifies the request that is send to the server.   The  string  can  include  C
              escape sequences to send control characters.  By default, the request <b>GET</b> <b>/</b> <b>HTTP/1.0\r\n\r\n</b> (that
              is, <b>GET</b> <b>/</b> <b>HTTP/1.0</b> followed by the four characters CR, LF, CR, LF) is sent.

              The <b>--receive</b> option is not supported by this protocol module.

       <b>http_proxy</b>
              This protocol module probes hosts for open HTTP proxies.  The <b>--port</b> option controls the port that
              is  probed.   The  required  <b>--receive</b> option must be an integer in the range from 1 to 65534, the
              number specifies the port on which <b>doscan</b> listens for the  connections  from  open  proxies.   The
              required <b>--send</b> option specifies the HTTP request method, either "GET" or "CONNECT".

              The <b>--banner</b> option is not supported by this protocol module.

              <b>Warning:</b>  In the worst case, the amount of file descriptors is slightly more than twice the number
              of parallel connections given by the <b>--connections</b> options.  The additional file  descriptors  are
              used by <b>doscan</b>'s HTTP server component to process the connections <u>from</u> open proxies.

              See the <b>EXAMPLES</b> section for some convenient combinations of those otions.

       <b>ident_check</b>
              This protocol module reports hosts which have TCP service listening on the specified port which is
              <u>not</u>  a proper IDENT/AUTH daemon.  It is most useful with a <b>--port</b> <b>113</b> command line argument.  None
              of the <b>--banner</b>, <b>--receive</b> and <b>--send</b> options are supported.

       <b>tcp</b>    This module is intended for generic TCP service probing and fingerprinting.

              The <b>--banner</b> option controls the maximum length of banner strings which  are  collected.   If  its
              argument  is  zero  or  if  the option is not specified, no banner strings are collected.  In this
              case, <b>doscan</b> closes connections immediately after they have been established (which results in  an
              increased scanning rate).

              After  establishing  a  connection, <b>doscans</b> sends the string specified by the <b>--send</b> option to the
              remote host.  The string can contain the usual C escape sequences (including <b>\000</b>), to  send  non-
              printable characters.

              The  <b>--receive</b> option specifies a Perl-compatible regular expression (PCRE), and <b>doscan</b> uses it to
              analyze the data returned by a remote host.  The regular  expression  may  contain  at  least  one
              capturing subpattern, it is always anchored at the beginning of the received data. The character <b>.</b>
              (period)  matches all characters (including newline).  <b>$</b> (dollar sign) matches the very end of the
              received data (which may, however, still be incomplete).  See <b><a href="../man3/pcrepattern.3.html">pcrepattern</a></b>(3) for details about the
              syntax of Perl-compatible regular expression.

              The <b>--receive</b> regular expression is used by <b>doscan</b> for several purposes.  If data is received from
              a remote host, and if the regular expression ends with <b>$</b>, <b>doscan</b> immediately closes the connection
              if all the data received so far from this host matches the regular  expression.   (<b>doscan</b>  assumes
              that  the  reply  is  complete;  increased  scanning  speed  is the result.)  When a connection is
              terminated for any reason, <b>doscan</b> checks if the regular expression matches the collected data.  If
              it doesn't, a <b>no</b> <b>match</b> error is recorded (if no other error occured).  If it does, and the regular
              expression contains a capturing subpattern, that subpattern is  recorded.   Otherwise,  the  whole
              data is recorded.

              In order to use the <b>--receive</b> option, you have to specify the <b>--banner</b> option as well.

       <b>udp</b>    This  module  is  a generic UDP scanner, as far such a thing is possible.  It sends up to five UDP
              packets (whose payload is controlled by the  mandatory  <b>--send</b>  option)  to  the  specified  port.
              Replies  are  collected.   The  <b>--banner</b>  option  is implicit and set to the maximum payload size.
              Retransmission is stopped when the first reply is received.

              In verbose mode (with both <b>--verbose</b> and <b>--net-errors</b> options), a warning like "stray  UDP  packet
              from  192.0.2.4:7"  is  printed  to  standard  error  when  an unexpected UDP packets is received.
              Packets to sent to network or broadcast adresses trigger such packets, and poorly implemented  UDP
              services on multi-homed machines answer with a different source IP address.

</pre><h4><b>OUTPUT</b> <b>FORMAT</b></h4><pre>
       <b>doscan</b>  prints  all  gathered  data  about  scanned  prefixes to standard output, just before the program
       terminates.  The output format can be changed with the <b>--output</b> option.   The  <u>format</u>  argument  of  this
       option  is  a  string  which includes <b>%</b> substitions, similar to <b><a href="../man3/printf.3.html">printf</a></b>(3).  The following substitions are
       supported

       <b>%%</b>     A literal percent character.

       <b>%a</b>     The address of the remote host.

       <b>%b</b>     The banner return by the host.

       <b>%e</b>     The error code as a string, empty if no error occurred while scanning the host.

              This is either a system error constant (such as ECONNREFUSED),  or  the  string  <b>unknown</b>  (unknown
              error code).  If the <b>--receive</b> option is active and the received data does not match the specified
              regular expresion, and no other error has occured, the column contains <b>no</b> <b>match</b>.

       <b>%E</b>     The  numeric  error  code  corresponding  to  the  <b>%e</b> error message, or zero if no error occurred.
              Negativ error numbers are returned for internal  errors  (such  as  a  failed  match  against  the
              <b>--receive</b> regular expression).

       <b>%n</b>     The  host  name  corresponding  to the scanned IP address (based on a DNS lookup).  Note that this
              slows down reporting a lot, in general.  For this reason, it is not recommended to use <b>%n</b> together
              with <b>--style</b> <b>unsorted</b>.

       <b>%N</b>     A verbatim ASCII LF (newline) character.

       <b>%r</b>     The time when the information was gathered, measured in seconds since the scanning started.

       <b>%t</b>     The time when the information was gathered, in local time.

       <b>%T</b>     Same as <b>%t</b>, but in UTC (also known as GMT).

       <b>%%</b>     A verbatim percent sign (%).

       The default value for the <b>--output</b> option is <b>%T\t%a\t%e\t%b</b>, where <b>\t</b> denotes an ASCII HTAB character.

       The <b>--style</b> or <b>-S</b> option supports the following arguments:

       <b>sort-by-host</b>
              The output is sorted by the IP address of the scanned host. (This is the default.)

       <b>unsorted</b>
              The output is not sorted and appears in the order the hosts responded.

              Caution: Do not use this style together with an <b>--output</b> argument which includes <b>%n</b>,  and  do  not
              pipe  the  output  of <b>doscan</b> to a process which cannot read its standard input quickly.  Output is
              performed synchronously, and if it is delayed, this might impact the scanning activity.

       In all cases except <b>unsorted</b>, output is delayed just before the termination of the program.

</pre><h4><b>EXAMPLES</b></h4><pre>
              <b>doscan</b> <b>--banner</b> <b>100</b> <b>--port</b> <b>13</b> <b>192.0.2.1</b>

       Prints the time on the host 192.0.2.1 (if it runs a daytime server).

              <b>doscan</b> <b>--banner</b> <b>100</b> <b>--receive</b> <b>'(.*)\n$'</b> <b>--port</b> <b>22</b> <b>192.0.2.0/24</b>

       Scan for SSH servers and record the  banners  (usually  containing  version  information  about  the  SSH
       server).

              <b>doscan</b> <b>--banner</b> <b>200</b> <b>--receive</b> <b>'(.*?)\r?\n$'</b> <b>--port</b> <b>25</b> <b>192.0.2.0/24</b>

       Scan  for SMTP servers and record their greeting messages.  Works for FTP as well, with <b>--port</b> <b>21</b> instead
       of <b>--port</b> <b>25</b>.

              <b>doscan</b> <b>--banner</b> <b>2000</b> <b>--send</b> <b>'GET</b> <b>/</b> <b>HTTP/1.0\r\n\r\n'</b> <b>\</b>
                 <b>--receive</b> <b>'.*?\nServer:</b> <b>*([^\r\n]*)</b> <b>*\r?\n.*$'</b> <b>\</b>
                 <b>--port</b> <b>80</b> <b>192.0.2.0/24</b>

       Scan for HTTP servers and record their version strings.

              <b>doscan</b> <b>--protocol</b> <b>http_proxy</b> <b>--port</b> <b>3128</b> <b>\</b>
                 <b>--send</b> <b>GET</b> <b>--receive</b> <b>80</b> <b>192.0.2.0/24</b>

       Scan for open proxies on TCP port 3128, using the GET HTTP request method.  Try to connect back  to  port
       80 on the scanning host.

       It  is  recommended  that  you  use  port  80 for the listening port if you scan using GET requests.  For
       CONNECT requests, port 443 should be used (see below).  Some administrators might restrict CONNECT to TCP
       port 443 (or filter it for the GET request method), so these choices give best results.

              <b>doscan</b> <b>--protocol</b> <b>http_proxy</b> <b>--port</b> <b>8080</b> <b>\</b>
                 <b>--send</b> <b>CONNECT</b> <b>--receive</b> <b>443</b> <b>192.0.2.0/24</b>

       Scan for open proxies on TCP port 8080, using the CONNECT HTTP request method.  Try to  connect  back  to
       port 443 on the scanning host.

</pre><h4><b>CAVEATS</b></h4><pre>
       The  most  important  option  for  tuning  is <b>--connections</b>.  Increasing this option can greatly increase
       scanning performance.  However, there a two caveats: Many connections  require  many  sockets,  and  your
       system  might not support so many of them.  Furthermore, a large number of parallel connections generates
       significant numbers of packets, and a high CPU load, which can both lead to spurious connection  failures
       (false negatives).

       To  increase  the  number  of  connections  your  system  can  process,  you  usually  have  to raise the
       corresponding <b>ulimit</b> value in your shell, which requires <b>root</b> privileges.  For example, in  <b><a href="../man1/bash.1.html">bash</a></b>(1),  you
       can invoke

              <b>ulimit</b> <b>-n</b> <b>10030</b>

       to  raise  the  descriptor  limit to 10030.  You can then pass <b>--connections</b> <b>10000</b> to <b>doscan</b>.  (Some file
       descriptors are not used for scanning, but have to be open nonetheless, and count towards the  <b>ulimit</b>  <b>-n</b>
       limit.)

       On  Linux-based systems, you might have to adjust some <b>sysctl</b> values which control system-wide descriptor
       limits.  Refer to <b><a href="../man5/sysctl.conf.5.html">sysctl.conf</a></b>(5), the <b>Documentation</b> directory in the Linux source  tree,  or  the  source
       code itself for details.

       Note,  however,  that if you increase the number of parallel connections beyond a certain value, you will
       <u>lose</u> some hosts, that is they will not be reported even though they are running a service on the  scanned
       port.   Therefore, you should watch both network and CPU utilization to detect bottlenecks.  Although the
       random scatter technique employed by <b>doscan</b> tries to split the  load  across  your  whole  network,  this
       obviously fails if the next hop cannot bear the traffic.

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>doscan</b> was written by Florian Weimer.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/nmap.8.html">nmap</a></b>(8),  <b><a href="../man3/pcrepattern.3.html">pcrepattern</a></b>(3),  <b><a href="../man5/sysctl.conf.5.html">sysctl.conf</a></b>(5)  (on  GNU/Linux  systems),  shell  documentation for the <b>ulimit</b>
       interface

                                                   2003-07-27                                          <u><a href="../man1/DOSCAN.1.html">DOSCAN</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>