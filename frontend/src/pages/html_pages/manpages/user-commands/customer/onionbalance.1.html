<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>onionbalance - a Tor onion service load balancer</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/onionbalance">onionbalance_0.2.2-1.2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       onionbalance - a Tor onion service load balancer

</pre><h4><b>ONIONBALANCE-CONFIG</b> <b>TOOL</b></h4><pre>
   <b>Description</b>
       The  <b>onionbalance-config</b>  tool  is the fastest way to generate the necessary keys and config files to get
       your onion service up and running.

          $ onionbalance-config

       When called without any arguments, the config generator will run in an interactive mode  and  prompt  for
       user input.

       The  <b>master</b>  directory  should  be  stored  on the management server while the other <b>instance</b> directories
       should be transferred to the respective backend servers.

   <b>Files</b>
       <b>master/config.yaml</b>
              This is the configuration file that is used my the Onionbalance management server.

       <b>master/&lt;ONION_ADDRESS&gt;.key</b>
              The private key which will become the public address and identity for your onion  service.  It  is
              essential that you keep this key secure.

       <b>master/torrc-server</b>
              A  sample Tor configuration file which can be used with the Tor instance running on the management
              server (v2-only).

       <b>srv/torrc-instance</b>
              A sample Tor config file which contains the Tor <b>HiddenService*</b> options needed for your backend Tor
              instance (v2-only).

       <b>srv/&lt;ONION_ADDRESS&gt;/private_key</b>
              Directory containing the private key for your backend onion service instance.  This  key  is  less
              critical as it can be rotated if lost or compromised (v2-only).

   <b>See</b> <b>Also</b>
       Full documentation for the <b>Onionbalance</b> software is available at <u>https://onionbalance.readthedocs.org/</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       You  can  start  the  Onionbalance management server once all of your backend onion service instances are
       running.

       You will need to create a <u>configuration</u> <u>file</u> which list the backend onion services and  the  location  of
       your hidden service keys.

          $ onionbalance -c config.yaml

       or

          $ sudo service onionbalance start

       The management server must be left running to publish new descriptors for your onion service: in about 10
       minutes you should have a fully functional onionbalance setup.

       <b>NOTE:</b>
          Multiple  Onionbalance  management  servers can be run simultaneously with the same master private key
          and configuration file to provide redundancy.

</pre><h4><b>CONFIGURATION</b> <b>FILE</b> <b>FORMAT</b></h4><pre>
       The Onionbalance management server is primarily configured using a YAML configuration file.

          # Onion Load Balancer Config File
          # ---
          # Each hidden service key line should be followed be followed by a list of 0
          # or more instances which contain the onion address of the load balancing
          # hidden service

          REFRESH_INTERVAL: 600 # How often to poll for updated descriptors
          services:
              - key: /path/to/private_key # 7s4hxwwifcslrus2.onion
                instances:
                  - address: o6ff73vmigi4oxka # web1
                  - address: nkz23ai6qesuwqhc # web2
              - key: /path/to/private_key.enc # dpkdeys3apjtqydk.onion
                instances:
                  - address: htbzowpp5cn7wj2u # irc1
                  - address: huey7aiod8dja8a3 # irc2

       The <b>services</b> section of the configuration file contains a list of master onion services that Onionbalance
       is responsible for.

       Each <b>key</b> option specifies the location of the 1024 bit private RSA key for the onion service. This master
       private key determines the address that users will use to access your onion  service.  This  private  key
       <b>must</b> be kept secure.

       The  location  of the private key is evaluated as an absolute path, or relative to the configuration file
       location.

       You can use existing Tor onion service private key with Onionbalance to keep your onion address.

       Each backend Tor onion service instance is listed by its unique onion address in the <b>instances</b> list.

       <b>NOTE:</b>
          You can replace backend instance keys if they get lost or compromised.  Simply  start  a  new  backend
          onion service under a new key and replace the <b>address</b> in the config file.

       If  you  have  used  the  <u>onionbalance-config</u>  tool  you  can  simply  use the generated config file from
       <b>master/config.yaml</b>.

       <b>NOTE:</b>
          By default onionbalance will search for a <b>config.yaml</b> file in the current working directory.

   <b>Configuration</b> <b>Options</b>
       The Onionbalance command line options can also be  specified  in  the  Onionbalance  configuration  file.
       Options specified on the command line take precedence over the related configuration file options:

       <b>TOR_CONTROL_SOCKET:</b>
              The  location  of the Tor unix domain control socket. Onionbalance will attempt to connect to this
              control socket  first  before  falling  back  to  using  a  control  port  connection.   (default:
              /var/run/tor/control)

       <b>TOR_ADDRESS:</b>
              The address where the Tor control port is listening. (default: 127.0.0.1)

       <b>TOR_PORT:</b>
              The Tor control port. (default: 9051)

       <b>TOR_CONTROL_PASSWORD:</b>
              The  password  for  authenticating  to a Tor control port which is using the HashedControlPassword
              authentication method. This is not needed when the Tor control  port  is  using  the  more  common
              CookieAuthentication method.  (default: None)

       Other options:

       <b>LOG_LOCATION</b>
              The path where Onionbalance should write its log file.

       <b>LOG_LEVEL</b>
              Specify  the minimum verbosity of log messages to output. All log messages equal or higher the the
              specified log level are output. The available log levels are the same as the  --verbosity  command
              line option.

       <b>REFRESH_INTERVAL</b>
              How  often  to check for updated backend onion service descriptors. This value can be decreased if
              your backend instance are under heavy loaded causing them to rotate introduction  points  quickly.
              (default: 600 seconds).

       <b>PUBLISH_CHECK_INTERVAL</b>
              How  often  should  to  check if new descriptors need to be published for the master onion service
              (default: 360 seconds).

       <b>INITIAL_DELAY</b>
              How long to wait between starting Onionbalance and publishing the master descriptor. If  you  have
              more  than  20  backend  instances  you  may  need  to wait longer for all instance descriptors to
              download before starting (default: 45 seconds).

       <b>DISTINCT_DESCRIPTORS</b>
              Distinct descriptors are used if you have  more  than  10  backend  instances.   At  the  cost  of
              scalability, this can be disabled to appear more like a standard onion service. (default: True)

       <b>STATUS_SOCKET_LOCATION</b>
              The  Onionbalance  service creates a Unix domain socket which provides real-time information about
              the currently loaded service and descriptors.  This option can be used to change the  location  of
              this domain socket.  (default: /var/run/onionbalance/control)

       The following options typically do not need to be modified by the end user:

       <b>REPLICAS</b>
              How many set of HSDirs to upload too (default: 2).

       <b>MAX_INTRO_POINTS</b>
              How many introduction points to include in a descriptor (default: 10)

       <b>DESCRIPTOR_VALIDITY_PERIOD</b>
              How long a onion service descriptor remains valid (default: 86400 seconds)

       <b>DESCRIPTOR_OVERLAP_PERIOD</b>
              How long to overlap onion service descriptors when changing descriptor IDs (default: 3600 seconds)

       <b>DESCRIPTOR_UPLOAD_PERIOD</b>
              How  often  to publish a descriptor, even when the introduction points don't change (default: 3600
              seconds)

   <b>Environment</b> <b>Variables</b>
       <b>ONIONBALANCE_CONFIG</b>
              Override the location for the Onionbalance configuration file.

       The loaded configuration file takes precedence over environment variables.   Configuration  file  options
       will override environment variable which have the same name.

       <b>ONIONBALANCE_LOG_LOCATION</b>
              See the config file option.

       <b>ONIONBALANCE_LOG_LEVEL</b>
              See the config file option

       <b>ONIONBALANCE_STATUS_SOCKET_LOCATION</b>
              See the config file option

       <b>ONIONBALANCE_TOR_CONTROL_SOCKET</b>
              See the config file option

</pre><h4><b>FILES</b></h4><pre>
       <b>/etc/onionbalance/config.yaml</b>
              The configuration file, which contains <b>services</b> entries.

       <b>config.yaml</b>
              Fallback location for torrc, if /etc/onionbalance/config.yaml is not found.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Full documentation for the <b>Onionbalance</b> software is available at <u>https://onionbalance.readthedocs.org/</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       George Kadianakis, Donncha O'Cearbhaill &lt;<a href="mailto:asn@torproject.org">asn@torproject.org</a>&gt;

0.2.2                                             Dec 15, 2023                                   <u><a href="../man1/ONIONBALANCE.1.html">ONIONBALANCE</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>