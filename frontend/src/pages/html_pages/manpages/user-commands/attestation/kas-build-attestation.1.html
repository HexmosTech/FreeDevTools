<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kas-build-attestation - working with SLSA / in-toto attestations</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/kas">kas_4.7-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       kas-build-attestation - working with SLSA / in-toto attestations

</pre><h4><b>BUILD</b> <b>ATTESTATION</b></h4><pre>
       kas  supports  the  generation  of  SLSA  /  in-toto  build attestation data.  Currently, support for the
       following attestation formats is implemented:

       • <u>provenance</u> <u>v1</u>

   <b>Provenance</b>
       The provenance data provides information about the build. This includes data about the build environment,
       as  well  as  all   primary   (first-level)   dependencies.   The   attestation   will   be   stored   in
       <b>attestation/kas-build.provenance.json</b>

       The  following  modes  are  supported:  <b>mode=min</b>,  <b>mode=max</b>,  whereby  the  mode  controls  the amount of
       information that is included in the attestation. The CLI options hereby loosely follow the <b>docker</b>  <b>buildx</b>
       provenance options, which are described in detail in <u>Provenance</u> <u>attestations</u>.  For compatibility with the
       <b>docker</b>  <b>buildx</b>  CLI  options,  we  also  support  <b>--provenance</b>  <b>true</b>, which is equivalent to <b>--provenance</b>
       <b>mode=min</b>.

       In min mode, the provenance attestation will contain information about:

       • Build timestamps

       • Build materials (project-config files)

       • Source repositories and revisions

       • Build platform

       In max mode, it will also contain the build environment,  i.e.  all  environment  variables  of  the  <b>env</b>
       section along with their values.

       <b>WARNING:</b>
          In  max  mode,  the  provenance  attestation  captures  all environment variables specified in the <b>env</b>
          section. Make sure to not expose any secrets.

       For example, to build the configuration  described  in  the  file  <b>kas-project.yml</b>  and  emit  provenance
       attestations, you could run:

          kas build --provenance mode=max kas-project.yml

   <b>Working</b> <b>with</b> <b>sigstore</b> <b>cosign</b>
       The  <u>cosign</u>  <u>tool</u>  from  the  <u>sigstore</u>  <u>project</u>  (<u>documentation</u>)  has  native  support  for in-toto build
       predicates. However, it currently can only operate directly on the predicate but  not  on  the  enclosing
       attestation  (cosign  2.2.4).  By  that,  the  predicate  first needs to be extracted (provenance in this
       example):

          cat build/attestation/kas-build.provenance.json | jq '.predicate' &gt; provenance.json

   <b>Attestation</b> <b>Signing</b>
       <b>WARNING:</b>
          The following command operates on the public append-only transparency log. Make sure to understand the
          implications before executing.

       The following example shows how to create a signed build attestation from a provenance  predicate  and  a
       local artifact, using the OIDC keyless signing workflow:

          cosign attest-blob \
              --type=slsaprovenance1 \
              --predicate=provenance.json \
              --output-signature=kas-build.dsse.json \
              --output-certificate=cert.pem \
              &lt;image&gt;.wic

       <b>NOTE:</b>
          Currently the attestation can only be created for a single artifact file.

       For  later  verification,  both  the signed attestation (<b>kas-build.dsse.json</b>), as well as the certificate
       (<b>cert.pem</b>) are needed. Make sure to ship them along with the artifact.

   <b>Attestation</b> <b>Verification</b>
       The previously signed blob can be verified again:

          cosign verify-blob-attestation \
              --certificate=cert.pem \
              --signature=kas-build.dsse.json \
              --certificate-identity="&lt;redacted&gt;" \
              --certificate-oidc-issuer="&lt;oidc issuer&gt;" \
              --type=slsaprovenance1 \
              &lt;image&gt;.wic

   <b>Attestation</b> <b>Restoration</b>
       The dsse record (<b>kas-build.dsse.json</b>) contains the original attestation data as base64 encoded string. To
       restore the attestation, run:

          cat kas-build.dsse.json | jq -r '.payload' | base64 -d | jq

</pre><h4><b>KAS</b></h4><pre>
       Part of the <b><a href="../man1/kas.1.html">kas</a>(1)</b> suite.

</pre><h4><b>AUTHOR</b></h4><pre>
       Daniel Wagner, Jan Kiszka, Claudius Heine

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Siemens AG, 2017-2024

4.7                                               Feb 03, 2025                          <u><a href="../man1/KAS-BUILD-ATTESTATION.1.html">KAS-BUILD-ATTESTATION</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>