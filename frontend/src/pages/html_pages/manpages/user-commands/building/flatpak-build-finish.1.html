<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>flatpak-build-finish - Finalize a build directory</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/flatpak">flatpak_1.16.0-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       flatpak-build-finish - Finalize a build directory

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>flatpak</b> <b>build-finish</b> [OPTION...] DIRECTORY

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Finalizes a build directory, to prepare it for exporting.  DIRECTORY is the name of the directory.

       The result of this command is that desktop files, icons, D-Bus service files, and AppStream metainfo
       files from the files subdirectory are copied to a new export subdirectory. In the metadata file, the
       command key is set in the [Application] group, and the supported keys in the [Environment] group are set
       according to the options.

       As part of finalization you can also specify permissions that the app needs, using the various options
       specified below. Additionally during finalization the permissions from the runtime are inherited into the
       app unless you specify <b>--no-inherit-permissions</b>

       You should review the exported files and the application metadata before creating and distributing an
       application bundle.

       It is an error to run build-finish on a directory that has not been initialized as a build directory, or
       has already been finalized.

</pre><h4><b>OPTIONS</b></h4><pre>
       The following options are understood:

       <b>-h</b>, <b>--help</b>
           Show help options and exit.

       <b>--command=COMMAND</b>
           The command to use. If this option is not specified, the first executable found in files/bin is used.

           Note that the command is used when the application is run via <b>flatpak</b> <b>run</b>, and does not affect what
           gets executed when the application is run in other ways, e.g. via the desktop file or D-Bus
           activation.

       <b>--require-version=MAJOR.MINOR.MICRO</b>
           Require this version or later of flatpak to install/update to this build.

       <b>--share=SUBSYSTEM</b>
           Share a subsystem with the host session. This updates the [Context] group in the metadata. SUBSYSTEM
           must be one of: network, ipc. This option can be used multiple times.

       <b>--unshare=SUBSYSTEM</b>
           Don't share a subsystem with the host session. This updates the [Context] group in the metadata.
           SUBSYSTEM must be one of: network, ipc. This option can be used multiple times.

       <b>--socket=SOCKET</b>
           Expose a well-known socket to the application. This updates the [Context] group in the metadata.
           SOCKET must be one of: x11, wayland, fallback-x11, pulseaudio, system-bus, session-bus, ssh-auth,
           pcsc, cups, gpg-agent, inherit-wayland-socket. This option can be used multiple times.

           The fallback-x11 option makes the X11 socket available only if there is no Wayland socket. This
           option was introduced in 0.11.3. To support older Flatpak releases, specify both x11 and
           fallback-x11. The fallback-x11 option takes precedence when both are supported.

       <b>--nosocket=SOCKET</b>
           Don't expose a well known socket to the application. This updates the [Context] group in the
           metadata. SOCKET must be one of: x11, wayland, fallback-x11, pulseaudio, system-bus, session-bus,
           ssh-auth, pcsc, cups, gpg-agent, inherit-wayland-socket. This option can be used multiple times.

       <b>--device=DEVICE</b>
           Expose a device to the application. This updates the [Context] group in the metadata. DEVICE must be
           one of: dri, input, usb, kvm, shm, all. This option can be used multiple times.

       <b>--nodevice=DEVICE</b>
           Don't expose a device to the application. This updates the [Context] group in the metadata. DEVICE
           must be one of: dri, input, usb, kvm, shm, all. This option can be used multiple times.

       <b>--allow=FEATURE</b>
           Allow access to a specific feature. This updates the [Context] group in the metadata. FEATURE must be
           one of: devel, multiarch, bluetooth, canbus, per-app-dev-shm. This option can be used multiple times.

           The devel feature allows the application to access certain syscalls such as ptrace(), and
           perf_event_open().

           The multiarch feature allows the application to execute programs compiled for an ABI other than the
           one supported natively by the system. For example, for the x86_64 architecture, 32-bit x86 binaries
           will be allowed as well.

           The bluetooth feature allows the application to use bluetooth (AF_BLUETOOTH) sockets. Note, for
           bluetooth to fully work you must also have network access.

           The canbus feature allows the application to use canbus (AF_CAN) sockets. Note, for this work you
           must also have network access.

           The per-app-dev-shm feature shares a single instance of <a href="file:/dev/shm">/dev/shm</a> between the application, any
           unrestricted subsandboxes that it creates, and any other instances of the application that are
           launched while it is running.

       <b>--disallow=FEATURE</b>
           Disallow access to a specific feature. This updates the [Context] group in the metadata. FEATURE must
           be one of: devel, multiarch, bluetooth, canbus, per-app-dev-shm. This option can be used multiple
           times.

       <b>--filesystem=FS</b>
           Allow the application access to a subset of the filesystem. This updates the [Context] group in the
           metadata. FS can be one of: home, host, host-os, host-etc, xdg-desktop, xdg-documents, xdg-download,
           xdg-music, xdg-pictures, xdg-public-share, xdg-templates, xdg-videos, xdg-run, xdg-config, xdg-cache,
           xdg-data, an absolute path, or a homedir-relative path like <a href="file:~/dir">~/dir</a> or paths relative to the xdg dirs,
           like xdg-download/subdir. The optional :ro suffix indicates that the location will be read-only. The
           optional :create suffix indicates that the location will be read-write and created if it doesn't
           exist. This option can be used multiple times. See the "[Context] filesystems" list in <b><a href="../man5/flatpakmetadata.5.html">flatpak-</a></b>
           <b><a href="../man5/flatpakmetadata.5.html">metadata</a></b>(5) for details of the meanings of these filesystems.

       <b>--nofilesystem=FILESYSTEM</b>
           Remove access to the specified subset of the filesystem from the application. This overrides to the
           Context section from the application metadata. FILESYSTEM can be one of: home, host, host-os,
           host-etc, xdg-desktop, xdg-documents, xdg-download, xdg-music, xdg-pictures, xdg-public-share,
           xdg-templates, xdg-videos, an absolute path, or a homedir-relative path like <a href="file:~/dir.">~/dir.</a> This option can
           be used multiple times.

       <b>--add-policy=SUBSYSTEM.KEY=VALUE</b>
           Add generic policy option. For example, "--add-policy=subsystem.key=v1 --add-policy=subsystem.key=v2"
           would map to this metadata:

               [Policy subsystem]
               key=v1;v2;

           This option can be used multiple times.

       <b>--remove-policy=SUBSYSTEM.KEY=VALUE</b>
           Remove generic policy option. This option can be used multiple times.

       <b>--usb=TYPE[:DATA]</b>
           Makes USB devices matching the query visible to the USB portal by adding the query to the application
           metadata. This does not have any effect on the devices exposed in /dev.  TYPE must be one of: all,
           cls, dev, vnd.

           <b>all</b>
               Match all devices.

           <b>cls</b>
               A device class and subclass query.  DATA must be in the form of CLASS:SUBCLASS where both CLASS
               and SUBCLASS must valid 2-digit hexadecimal class id numbers. Alternatively, SUBCLASS may be * to
               match all subclasses.

           <b>dev</b>
               A device product id query.  DATA must be a valid 4-character hexadecimal product id number, for
               example <b>0a1b</b>. It requires a <b>vnd</b> filter in the query.

           <b>vnd</b>
               A device vendor id query.  DATA must be a valid 4-character hexadecimal vendor id number greater
               than zero, for example <b>0fab</b>.

           It is possible to compose multiple device queries together with the + sign, for example
           <b>--usb=vnd:0123+dev:4567</b>. The dev filter requires a vnd. Available since 1.15.11.

       <b>--nousb=TYPE[:DATA]</b>
           Hides USB devices matching the query from the USB portal by adding the query to the application
           metadata. Queries hiding devices take precedence over queries making devices visible (see <b>--usb</b>). The
           syntax is exactly equal to <b>--usb</b>. This does not have any effect on the devices exposed in /dev.
           Available since 1.15.11.

       <b>--usb-list-file=FILENAME</b>
           Adds USB device queries to the application metadata from the file FILE_NAME. The line syntax is
           exactly equal to <b>--usb</b>. Additionally, if it starts with ! then the query is like for <b>--nousb</b>. Lines
           sthat starts with # are ignored, like a comment. Comments will not be persisted. Available since
           1.15.11.

       <b>--usb-list=LIST</b>
           Adds USB device queries to the application metadata from LIST. The syntax is exactly equal to <b>--usb</b>
           with queries separated by ;. Additionally, if the query starts with !  then the query is like for
           <b>--nousb</b>. Available since 1.15.11.

       <b>--env=VAR=VALUE</b>
           Set an environment variable in the application. This updates the [Environment] group in the metadata.
           This overrides to the Context section from the application metadata. This option can be used multiple
           times.

       <b>--unset-env=VAR</b>
           Unset an environment variable in the application. This updates the unset-environment entry in the
           [Context] group of the metadata. This option can be used multiple times.

       <b>--env-fd=</b><u>FD</u>
           Read environment variables from the file descriptor <u>FD</u>, and set them as if via <b>--env</b>. This can be
           used to avoid environment variables and their values becoming visible to other users.

           Each environment variable is in the form <u>VAR</u>=<u>VALUE</u> followed by a zero byte. This is the same format
           used by env -0 and <a href="file:/proc/">/proc/</a>*/environ.

       <b>--own-name=NAME</b>
           Allow the application to own the well known name NAME on the session bus. If NAME ends with .*, it
           allows the application to own all matching names. This updates the [Session Bus Policy] group in the
           metadata. This option can be used multiple times.

       <b>--talk-name=NAME</b>
           Allow the application to talk to the well known name NAME on the session bus. If NAME ends with .*,
           it allows the application to talk to all matching names. This updates the [Session Bus Policy] group
           in the metadata. This option can be used multiple times.

       <b>--system-own-name=NAME</b>
           Allow the application to own the well known name NAME on the system bus. If NAME ends with .*, it
           allows the application to own all matching names. This updates the [System Bus Policy] group in the
           metadata. This option can be used multiple times.

       <b>--system-talk-name=NAME</b>
           Allow the application to talk to the well known name NAME on the system bus. If NAME ends with .*, it
           allows the application to talk to all matching names. This updates the [System Bus Policy] group in
           the metadata. This option can be used multiple times.

       <b>--persist=FILENAME</b>
           If the application doesn't have access to the real homedir, make the (homedir-relative) path FILENAME
           a bind mount to the corresponding path in the per-application directory, allowing that location to be
           used for persistent data. This updates the [Context] group in the metadata. This option can be used
           multiple times.

       <b>--runtime=RUNTIME</b>, <b>--sdk=SDK</b>
           Change the runtime or sdk used by the app to the specified partial ref. Unspecified parts of the ref
           are taken from the old values or defaults.

       <b>--metadata=GROUP=KEY[=VALUE]</b>
           Set a generic key in the metadata file. If value is left out it will be set to "true".

       <b>--extension=NAME=VARIABLE[=VALUE]</b>
           Add extension point info. See the documentation for <b><a href="../man5/flatpak-metadata.5.html">flatpak-metadata</a></b>(5) for the possible values of
           <u>VARIABLE</u> and <u>VALUE</u>.

       <b>--remove-extension=NAME</b>
           Remove extension point info.

       <b>--extension-priority=VALUE</b>
           Set the priority (library override order) of the extension point. Only useful for extensions. 0 is
           the default, and higher value means higher priority.

       <b>--extra-data=NAME:SHA256:DOWNLOAD-SIZE:INSTALL-SIZE:URL</b>
           Adds information about extra data uris to the app. These will be downloaded and verified by the
           client when the app is installed and placed in the /app/extra directory. You can also supply an
           /app/bin/apply_extra script that will be run after the files are downloaded.

       <b>--no-exports</b>
           Don't look for exports in the build.

       <b>--no-inherit-permissions</b>
           Don't inherit runtime permissions in the app.

       <b>-v</b>, <b>--verbose</b>
           Print debug information during command processing.

       <b>--ostree-verbose</b>
           Print OSTree debug information during command processing.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>$</b> <b>flatpak</b> <b>build-finish</b> <b>/build/my-app</b> <b>--socket=x11</b> <b>--share=ipc</b> <b>--usb=vnd:0fd9</b>

           Exporting share/applications/gnome-calculator.desktop
           Exporting share/dbus-1/services/org.gnome.Calculator.SearchProvider.service
           More than one executable
           Using gcalccmd as command
           Please review the exported files and the metadata

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/flatpak.1.html">flatpak</a></b>(1), <b><a href="../man1/flatpak-build-init.1.html">flatpak-build-init</a></b>(1), <b><a href="../man1/flatpak-build.1.html">flatpak-build</a></b>(1), <b><a href="../man1/flatpak-build-export.1.html">flatpak-build-export</a></b>(1)

flatpak                                                                                   <u>FLATPAK</u> <u><a href="../man1/BUILD-FINIS.1.html">BUILD-FINIS</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>