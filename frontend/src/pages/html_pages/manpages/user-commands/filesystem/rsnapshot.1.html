<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rsnapshot - remote filesystem snapshot utility</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/rsnapshot">rsnapshot_1.5.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rsnapshot - remote filesystem snapshot utility

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>rsnapshot</b> [<b>-vtxqVD</b>] [<b>-c</b> cfgfile] [command] [args]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>rsnapshot</b> is a filesystem snapshot utility. It can take incremental snapshots of local and remote
       filesystems for any number of machines.

       Local filesystem snapshots are handled with <b><a href="../man1/rsync.1.html">rsync</a></b>(1). Secure remote connections are handled with rsync
       over <b><a href="../man1/ssh.1.html">ssh</a></b>(1), while anonymous rsync connections simply use an rsync server. Both remote and local
       transfers depend on rsync.

       <b>rsnapshot</b> saves much more disk space than you might imagine. The amount of space required is roughly the
       size of one full backup, plus a copy of each additional file that is changed. <b>rsnapshot</b> makes extensive
       use of hard links, so if the file doesn't change, the next snapshot is simply a hard link to the exact
       same file.

       <b>rsnapshot</b> will typically be invoked as root by a cron job, or series of cron jobs. It is possible,
       however, to run as any arbitrary user with an alternate configuration file.

       All important options are specified in a configuration file, which is located by default at
       <u>/etc/rsnapshot.conf</u>. An alternate file can be specified on the command line. There are also additional
       options which can be passed on the command line.

       The command line options are as follows:

           <b>-v</b> verbose, show shell commands being executed

           <b>-t</b> test, show shell commands that would be executed

           <b>-c</b> path to alternate config file

           <b>-x</b> one filesystem, don't cross partitions within each backup point

           <b>-q</b> quiet, suppress non-fatal warnings

           <b>-V</b> same as -v, but with more detail

           <b>-D</b> a firehose of diagnostic information

</pre><h4><b>CONFIGURATION</b></h4><pre>
       <u>/etc/rsnapshot.conf</u> is the default configuration file. All parameters in this file must be separated by
       tabs. <u>/usr/share/doc/rsnapshot/examples/rsnapshot.conf.default.gz</u> can be used as a reference.

       It is recommended that you copy <u>/usr/share/doc/rsnapshot/examples/rsnapshot.conf.default.gz</u> to
       <u>/etc/rsnapshot.conf</u>, and then modify <u>/etc/rsnapshot.conf</u> to suit your needs.

       Long lines may be split over several lines.  "Continuation" lines <b>must</b> begin with a space or a tab
       character.  Continuation lines will have all leading and trailing whitespace stripped off, and then be
       appended with an intervening tab character to the previous line when the configuration file is parsed.

       Here is a list of allowed parameters:

           <b>config_version</b>     Config file version (required). Default is 1.2

           <b>snapshot_root</b>      Local filesystem path to save all snapshots

           <b>include_conf</b>       Include another file in the configuration at this point.

               This is recursive, but you may need to be careful about paths when specifying which file to
               include.  We check to see if the file you have specified is readable, and will yell an error if
               it isn't.  We recommend using a full path.  As a special case, include_conf's value may be
               enclosed in `backticks` in which case it will be executed and whatever it spits to STDOUT will be
               included in the configuration.  Note that shell meta-characters may be interpreted.

           <b>no_create_root</b>     If set to 1, rsnapshot won't create <b>snapshot_root</b> directory

           <b>cmd_rsync</b>          Full path to "rsync" (required)

           <b>cmd_ssh</b>            Full path to "ssh" (optional)

           <b>cmd_cp</b>             Full path to "cp" (optional, but must be GNU version)

               If you are using Linux, you should uncomment cmd_cp. If you are using a platform which does not
               have GNU cp, you should leave cmd_cp commented out.

               With GNU cp, rsnapshot can take care of both normal files and special files (such as FIFOs,
               sockets, and block/character devices) in one pass.

               If cmd_cp is disabled, rsnapshot will use its own built-in function, <b>native_cp_al()</b> to backup up
               regular files and directories. This will then be followed up by a separate call to rsync, to move
               the special files over (assuming there are any).

           <b>cmd_rm</b>             Full path to "rm" (optional)

           <b>cmd_logger</b>         Full path to "logger" (optional, for syslog support)

           <b>cmd_du</b>             Full path to "du" (optional, for disk usage reports)

           <b>cmd_rsnapshot_diff</b> Full path to "rsnapshot-diff" (optional)

           <b>cmd_preexec</b>

               Full path (plus any arguments) to preexec script (optional).  This script will run immediately
               before each backup operation (but not any rotations). If the execution fails, rsnapshot will stop
               immediately.

           <b>cmd_postexec</b>

               Full path (plus any arguments) to postexec script (optional).  This script will run immediately
               after each backup operation (but not any rotations). If the execution fails, rsnapshot will stop
               immediately.

           <b>linux_lvm_cmd_lvcreate</b>

           <b>linux_lvm_cmd_lvremove</b>

           <b>linux_lvm_cmd_mount</b>

           <b>linux_lvm_cmd_umount</b>

               Paths to lvcreate, lvremove, mount and umount commands, for use with Linux LVMs.  You may include
               options to the commands also.  The lvcreate, lvremove, mount and umount commands are required for
               managing snapshots of LVM volumes and are otherwise optional.

           <b>retain</b>             [name]   [number]

               "name" refers to the name of this backup level (e.g., alpha, beta, so also called the
               'interval'). "number" is the number of snapshots for this type of interval that will be retained.
               The value of "name" will be the command passed to <b>rsnapshot</b> to perform this type of backup.

               A deprecated alias for 'retain' is 'interval'.

               Example: <b>retain</b> <b>alpha</b> <b>6</b>

               [root@localhost]# <b>rsnapshot</b> <b>alpha</b>

               For this example, every time this is run, the following will happen:

               &lt;snapshot_root&gt;/alpha.5/ will be deleted, if it exists.

               &lt;snapshot_root&gt;/alpha.{1,2,3,4} will all be rotated +1, if they exist.

               &lt;snapshot_root&gt;/alpha.0/ will be copied to &lt;snapshot_root&gt;/alpha.1/ using hard links.

               Each backup point (explained below) will then be rsynced to the corresponding directories in
               &lt;snapshot_root&gt;/alpha.0/

               Backup levels must be specified in the config file in order, from most frequent to least
               frequent. The first entry is the one which will be synced with the backup points. The subsequent
               backup levels (e.g., beta, gamma, etc) simply rotate, with each higher backup level pulling from
               the one below it for its .0 directory.

               Example:

                   <b>retain</b>  <b>alpha</b> <b>6</b>

                   <b>retain</b>  <b>beta</b>  <b>7</b>

                   <b>retain</b>  <b>gamma</b> <b>4</b>

               beta.0/ will be moved from alpha.5/, and gamma.0/ will be moved from beta.6/

               alpha.0/ will be rsynced directly from the filesystem.

           <b>link_dest</b>           <b>1</b>

               If your version of rsync supports --link-dest (2.5.7 or newer), you can enable this to let rsync
               handle some things that GNU cp or the built-in subroutines would otherwise do. Enabling this
               makes rsnapshot take a slightly more complicated code branch, but it's the best way to support
               special files on non-Linux systems.

           <b>sync_first</b>          <b>1</b>

               sync_first changes the behaviour of rsnapshot. When this is enabled, all calls to rsnapshot with
               various backup levels simply rotate files. All backups are handled by calling rsnapshot with the
               "sync" argument. The synced files are stored in a ".sync" directory under the snapshot_root.

               This allows better recovery in the event that rsnapshot is interrupted in the middle of a sync
               operation, since the sync step and rotation steps are separated. This also means that you can
               easily run "rsnapshot sync" on the command line without fear of forcing all the other directories
               to rotate up.  This benefit comes at the cost of one more snapshot worth of disk space.  The
               default is 0 (off).

           <b>verbose</b>             <b>2</b>

               The amount of information to print out when the program is run. Allowed values are 1 through 5.
               The default is 2.

                   1        Quiet            Show fatal errors only
                   2        Default          Show warnings and errors
                   3        Verbose          Show equivalent shell commands being executed
                   4        Extra Verbose    Same as verbose, but with more detail
                   5        Debug            All kinds of information

           <b>loglevel</b>            <b>3</b>

               This number means the same thing as <b>verbose</b> above, but it determines how much data is written to
               the logfile, if one is being written.

           <b>logfile</b>             <b>/var/log/rsnapshot</b>

               Full filesystem path to the rsnapshot log file. If this is defined, a log file will be written,
               with the amount of data being controlled by <b>loglevel</b>. If this is commented out, no log file will
               be written.

           <b>include</b>             <b>[file-name-pattern]</b>

               This gets passed directly to rsync using the --include directive. This parameter can be specified
               as many times as needed, with one pattern defined per line. See the <b><a href="../man1/rsync.1.html">rsync</a></b>(1) man page for the
               syntax.

           <b>exclude</b>             <b>[file-name-pattern]</b>

               This gets passed directly to rsync using the --exclude directive. This parameter can be specified
               as many times as needed, with one pattern defined per line. See the <b><a href="../man1/rsync.1.html">rsync</a></b>(1) man page for the
               syntax.

           <b>include_file</b>        <b>/path/to/include/file</b>

               This gets passed directly to rsync using the --include-from directive. See the <b><a href="../man1/rsync.1.html">rsync</a></b>(1) man page
               for the syntax.

           <b>exclude_file</b>        <b>/path/to/exclude/file</b>

               This gets passed directly to rsync using the --exclude-from directive. See the <b><a href="../man1/rsync.1.html">rsync</a></b>(1) man page
               for the syntax.

           <b>rsync_short_args</b>    <b>-a</b>

               List of short arguments to pass to rsync. If not specified, "-a" is the default. Please note that
               these must be all next to each other.  For example, "-az" is valid, while "-a -z" is not.

               "-a" is rsync's "archive mode" which tells it to copy as much of the filesystem metadata as it
               can for each file.  This specifically does *not* include information about hard links, as that
               would greatly increase rsync's memory usage and slow it down.  If you need to preserve hard links
               in your backups, then add "H" to this.

           <b>rsync_long_args</b>     <b>--delete</b> <b>--numeric-ids</b> <b>--relative</b> <b>--delete-excluded</b>

               List of long arguments to pass to rsync.  The default values are
                   --delete --numeric-ids --relative --delete-excluded This means that the directory structure
               in each backup point destination will match that in the backup point source.

               Quotes are permitted in <b>rsync_long_args</b>, eg "--rsync-path='sudo <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?rsync">/usr/bin/rsync</a>'".  You may use
               either single (') or double (") quotes, but nested quotes (including mixed nested quotes) are not
               permitted.  Similar quoting is also allowed in per-backup-point <b>rsync_long_args</b>.

           <b>rsync_numtries</b>    <b>0</b>

               Number of additional attempts for running rsync for each given backup source.  Whenever the rsync
               operation for a source finishes with a non-zero exitcode, rsnapshot will repeat this operation
               until the configured number of "rsync_numtries" is reached or rsync finishes successfully.  By
               default no repeated attempts are performed ("rsync_numtries 0").

           <b>rsync_wait_between_tries</b>    <b>0</b>

               Wait between tries in seconds.  Specify the duration in seconds to wait between retries of the
               rsync operation.  The number of retries should be defined in rsync_numtries.  The default wait
               time is 0 seconds.

           <b>ssh_args</b>    <b>-p</b> <b>22</b>

               Arguments to be passed to ssh. If not specified, the default is none.

           <b>du_args</b>     <b>-csh</b>

               Arguments to be passed to du. If not specified, the default is -csh.  GNU du supports -csh, BSD
               du supports -csk, Solaris du doesn't support -c at all. The GNU version is recommended, since it
               offers the most features.

           <b>lockfile</b>    <b>/var/run/rsnapshot.pid</b>

           <b>stop_on_stale_lockfile</b>   <b>0</b>

               Lockfile to use when rsnapshot is run. This prevents a second invocation from clobbering the
               first one. If not specified, no lock file is used.  Make sure to use a directory that is not
               world writeable for security reasons.  Use of a lock file is strongly recommended.

               If a lockfile exists when rsnapshot starts, it will try to read the file and stop with an error
               if it can't.  If it *can* read the file, it sees if a process exists with the PID noted in the
               file.  If it does, rsnapshot stops with an error message.  If there is no process with that PID,
               then we assume that the lockfile is stale and ignore it *unless* stop_on_stale_lockfile is set to
               1 in which case we stop.

               stop_on_stale_lockfile defaults to 0.

           <b>one_fs</b>    <b>1</b>

               Prevents rsync from crossing filesystem partitions. Setting this to a value of 1 enables this
               feature. 0 turns it off. This parameter is optional.  The default is 0 (off).

           <b>use_lazy_deletes</b>    <b>1</b>

               Changes default behavior of rsnapshot and does not initially remove the oldest snapshot. Instead
               it moves that directory to _delete.[processid] and continues as normal. Once the backup has been
               completed, the lockfile will be removed before rsnapshot starts deleting the directory.

               Enabling this means that snapshots get taken sooner (since the delete doesn't come first), and
               any other rsnapshot processes are allowed to start while the final delete is happening. This
               benefit comes at the cost of using more disk space. The default is 0 (off).

               The details of how this works have changed in rsnapshot version 1.3.1.  Originally you could only
               ever have one .delete directory per backup level.  Now you can have many, so if your next (eg)
               alpha backup kicks off while the previous one is still doing a lazy delete you may temporarily
               have extra _delete directories hanging around.

           <b>linux_lvm_snapshotsize</b>    <b>2G</b>

               LVM snapshot(s) size (lvcreate --size option).

           <b>linux_lvm_snapshotname</b>  <b>rsnapshot</b>

               Name to be used when creating the LVM logical volume snapshot(s) (lvcreate --name option).

           <b>linux_lvm_vgpath</b>         <b><a href="file:/dev">/dev</a></b>

               Path to the LVM Volume Groups.

           <b>linux_lvm_mountpath</b>      <b>/mnt/lvm-snapshot</b>

               Mount point to use to temporarily mount the snapshot(s).

           <b>backup</b>  <a href="file:/etc/">/etc/</a>                       localhost/

           <b>backup</b>  <a href="mailto:root@example.com">root@example.com</a>:<a href="file:/etc/">/etc/</a>      example.com/

           <b>backup</b>  rsync://example.com/path2/  example.com/

           <b>backup</b>  <a href="file:/var/">/var/</a>                       localhost/      one_fs=1

           <b>backup</b>  lvm://vg0/home/path2/       lvm-vg0/

           <b>backup_script</b>   /usr/local/bin/backup_pgsql.sh    pgsql_backup/

               Examples:

               <b>backup</b>   <b><a href="file:/etc/">/etc/</a></b>        <b>localhost/</b>

                   Backs up <a href="file:/etc/">/etc/</a> to &lt;snapshot_root&gt;/&lt;retain&gt;.0/localhost/etc/ using rsync on the local
                   filesystem

               <b>backup</b>   <b><a href="file:/usr/local/">/usr/local/</a></b>  <b>localhost/</b>

                   Backs up <a href="file:/usr/local/">/usr/local/</a> to &lt;snapshot_root&gt;/&lt;retain&gt;.0/localhost/usr/local/ using rsync on the
                   local filesystem

               <b>backup</b>   <b><a href="mailto:root@example.com">root@example.com</a>:<a href="file:/etc/">/etc/</a></b>       <b>example.com/</b>

                   Backs up <a href="mailto:root@example.com">root@example.com</a>:<a href="file:/etc/">/etc/</a> to &lt;snapshot_root&gt;/&lt;retain&gt;.0/example.com/etc/ using rsync
                   over ssh

               <b>backup</b>   <b>example.com:<a href="file:/etc/">/etc/</a></b>       <b>example.com/</b>

                   Same thing but let ssh choose the remote username (as specified in <a href="file:~/.ssh/config">~/.ssh/config</a>, otherwise
                   the same as the local username)

               <b>backup</b>   <b><a href="mailto:root@example.com">root@example.com</a>:<a href="file:/usr/local/">/usr/local/</a></b> <b>example.com/</b>

                   Backs up <a href="mailto:root@example.com">root@example.com</a>:<a href="file:/usr/local/">/usr/local/</a> to &lt;snapshot_root&gt;/&lt;retain&gt;.0/example.com/usr/local/
                   using rsync over ssh

               <b>backup</b>   <b>rsync://example.com/pub/</b>      <b>example.com/pub/</b>

                   Backs up rsync://example.com/pub/ to &lt;snapshot_root&gt;/&lt;retain&gt;.0/example.com/pub/ using an
                   anonymous rsync server. Please note that unlike backing up local paths and using rsync over
                   ssh, rsync servers have "modules", which are top level directories that are exported.
                   Therefore, the module should also be specified in the destination path, as shown in the
                   example above (the pub/ directory at the end).

               <b>backup</b>   <b><a href="file:/var/">/var/</a></b>     <b>localhost/</b>   <b>one_fs=1</b>

                   This is the same as the other examples, but notice the fourth column.  This is how you
                   specify per-backup-point options to override global settings.  This extra parameter can take
                   several options, separated by <b>commas</b>.

                   It is most useful when specifying per-backup rsync excludes thus:

                   <b>backup</b>  <b>root@somehost:/</b>  <b>somehost</b>   <b>+rsync_long_args=--exclude=<a href="file:/var/spool/">/var/spool/</a></b>

                   Note the + sign.  That tells rsync_long_args to <u>add</u> to the list of arguments to pass to rsync
                   instead of replacing the list. The + sign is only supported for rsnapshot's rsync_long_args
                   and rsync_short_args.

               <b>backup</b>  <b>lvm://vg0/home/path2/</b>       <b>lvm-vg0/</b>

                   Backs up the LVM logical volume called home, of volume group vg0, to
                   &lt;snapshot_root&gt;/&lt;retain&gt;.0/lvm-vg0/. Will create, mount, backup, unmount and remove an LVM
                   snapshot for each lvm:// entry.

               <b>backup_script</b>      <b>/usr/local/bin/backup_database.sh</b>   <b>db_backup/</b>

                   In this example, we specify a script or program to run. This script should simply create
                   files and/or directories in its current working directory. rsnapshot will then take that
                   output and move it into the directory specified in the third column.

                   Please note that whatever is in the destination directory will be completely deleted and
                   recreated. For this reason, rsnapshot prevents you from specifying a destination directory
                   for a backup_script that will clobber other backups.

                   So in this example, say the backup_database.sh script simply runs a command like:

                       #!<a href="file:/bin/sh">/bin/sh</a>

                       mysqldump -uusername mydatabase &gt; mydatabase.sql

                       chmod u=r,go= mydatabase.sql        # r-------- (0400)

                   rsnapshot will take the generated "mydatabase.sql" file and move it into the
                   &lt;snapshot_root&gt;/&lt;retain&gt;.0/db_backup/ directory. On subsequent runs, rsnapshot checks the
                   differences between the files created against the previous files. If the backup script
                   generates the same output on the next run, the files will be hard linked against the previous
                   ones, and no additional disk space will be taken up.

               <b>backup_exec</b>      <b>ssh</b> <b><a href="mailto:root@1.2.3.4">root@1.2.3.4</a></b> <b>"du</b> <b>-sh</b> <b>/.offsite_backup"</b>                     <b>optional</b>

               <b>backup_exec</b>      <b>rsync</b> <b>-az</b> <b>/.snapshots/daily.0</b> <b><a href="mailto:root@1.2.3.4">root@1.2.3.4</a>:/.offsite_backup/</b>   <b>required</b>

               <b>backup_exec</b>      <b>/bin/true/</b>

                   <b>backup_exec</b> simply runs the command listed. The second argument is not required and defaults
                   to a value of 'optional'. It specifies the importance that the command return 0. Valid values
                   are 'optional' and 'required'. If the command is specified as optional, a non-zero exit
                   status from the command will result in a warning message being output. If the command is
                   specified as 'required', a non-zero exit status from the command will result in an error
                   message being output and rsnapshot itself will exit with a non-zero exit status.

           Remember that tabs must separate all elements, and that there must be a trailing slash on the end of
           every directory.

           A hash mark (#) on the beginning of a line is treated as a comment.

           Putting it all together (an example file):

               # THIS IS A COMMENT, REMEMBER TABS MUST SEPARATE ALL ELEMENTS

               config_version  1.2

               snapshot_root   /.snapshots/

               cmd_rsync           <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?rsync">/usr/bin/rsync</a>
               cmd_ssh             <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?ssh">/usr/bin/ssh</a>
               #cmd_cp             <a href="file:/bin/cp">/bin/cp</a>
               cmd_rm              <a href="file:/bin/rm">/bin/rm</a>
               cmd_logger          <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?logger">/usr/bin/logger</a>
               cmd_du              <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?du">/usr/bin/du</a>

               linux_lvm_cmd_lvcreate        <a href="file:/sbin/lvcreate">/sbin/lvcreate</a>
               linux_lvm_cmd_lvremove        <a href="file:/sbin/lvremove">/sbin/lvremove</a>
               linux_lvm_cmd_mount           <a href="file:/bin/mount">/bin/mount</a>
               linux_lvm_cmd_umount          <a href="file:/bin/umount">/bin/umount</a>

               linux_lvm_snapshotsize    2G
               linux_lvm_snapshotname    rsnapshot
               linux_lvm_vgpath          <a href="file:/dev">/dev</a>
               linux_lvm_mountpath       /mnt/lvm-snapshot

               retain              alpha  6
               retain              beta   7
               retain              gamma  7
               retain              delta 3

               backup              <a href="file:/etc/">/etc/</a>                     localhost/
               backup              <a href="file:/home/">/home/</a>                    localhost/
               backup_script       /usr/local/bin/backup_mysql.sh  mysql_backup/

               backup              <a href="mailto:root@foo.com">root@foo.com</a>:<a href="file:/etc/">/etc/</a>        foo.com/
               backup              <a href="mailto:root@foo.com">root@foo.com</a>:<a href="file:/home/">/home/</a>       foo.com/
               backup              <a href="mailto:root@mail.foo.com">root@mail.foo.com</a>:<a href="file:/home/">/home/</a>  mail.foo.com/
               backup              rsync://example.com/pub/  example.com/pub/
               backup              lvm://vg0/xen-home/       lvm-vg0/xen-home/
               backup_exec         echo "backup finished!"

</pre><h4><b>USAGE</b></h4><pre>
       <b>rsnapshot</b> can be used by any user, but for system-wide backups you will probably want to run it as root.

       Since backups usually get neglected if human intervention is required, the preferred way is to run it
       from cron.

       When you are first setting up your backups, you will probably also want to run it from the command line
       once or twice to get a feel for what it's doing.

       Here is an example crontab entry, assuming that backup levels <b>alpha</b>, <b>beta</b>, <b>gamma</b> and <b>delta</b> have been
       defined in <u>/etc/rsnapshot.conf</u>

           <b>0</b> <b>*/4</b> <b>*</b> <b>*</b> <b>*</b>         <b>/usr/local/bin/rsnapshot</b> <b>alpha</b>

           <b>50</b> <b>23</b> <b>*</b> <b>*</b> <b>*</b>         <b>/usr/local/bin/rsnapshot</b> <b>beta</b>

           <b>40</b> <b>23</b> <b>*</b> <b>*</b> <b>6</b>         <b>/usr/local/bin/rsnapshot</b> <b>gamma</b>

           <b>30</b> <b>23</b> <b>1</b> <b>*</b> <b>*</b>         <b>/usr/local/bin/rsnapshot</b> <b>delta</b>

       This example will do the following:

           6 alpha backups a day (once every 4 hours, at 0,4,8,12,16,20)

           1 beta backup every day, at 11:50PM

           1 gamma backup every week, at 11:40PM, on Saturdays (6th day of week)

           1 delta backup every month, at 11:30PM on the 1st day of the month

       It is usually a good idea to schedule the larger backup levels to run a bit before the lower ones. For
       example, in the crontab above, notice that "beta" runs 10 minutes before "alpha".  The main reason for
       this is that the beta rotate will pull out the oldest alpha and make that the youngest beta (which means
       that the next alpha rotate will not need to delete the oldest alpha), which is more efficient.  A
       secondary reason is that it is harder to predict how long the lowest backup level will take, since it
       needs to actually do an rsync of the source as well as the rotate that all backups do.

       If rsnapshot takes longer than 10 minutes to do the "beta" rotate (which usually includes deleting the
       oldest beta snapshot), then you should increase the time between the backup levels.  Otherwise (assuming
       you have set the <b>lockfile</b> parameter, as is recommended) your alpha snapshot will fail sometimes because
       the beta still has the lock.

       Remember that these are just the times that the program runs.  To set the number of backups stored, set
       the <b>retain</b> numbers in <u>/etc/rsnapshot.conf</u>

       To check the disk space used by rsnapshot, you can call it with the "du" argument.

       For example:

           <b>rsnapshot</b> <b>du</b>

       This will show you exactly how much disk space is taken up in the snapshot root. This feature requires
       the UNIX <b>du</b> command to be installed on your system, for it to support the "-csh" command line arguments,
       and to be in your path. You can also override your path settings and the flags passed to du using the
       cmd_du and du_args parameters.

       It is also possible to pass a relative file path as a second argument, to get a report on a particular
       file or subdirectory.

           <b>rsnapshot</b> <b>du</b> <b>localhost/home/</b>

       The GNU version of "du" is preferred. The BSD version works well also, but does not support the -h flag
       (use -k instead, to see the totals in kilobytes). Other versions of "du", such as Solaris, may not work
       at all.

       To check the differences between two directories, call rsnapshot with the "diff" argument, followed by
       two backup levels or directory paths.

       For example:

           <b>rsnapshot</b> <b>diff</b> <b>beta.0</b> <b>beta.1</b>

           <b>rsnapshot</b> <b>diff</b> <b>beta.0/localhost/etc</b> <b>beta.1/localhost/etc</b>

           <b>rsnapshot</b> <b>diff</b> <b>/.snapshots/beta.0</b> <b>/.snapshots/beta.1</b>

       This will call the "rsnapshot-diff" program, which will scan both directories looking for differences
       (based on hard links).

       <b>rsnapshot</b> <b>sync</b>

           When <b>sync_first</b> is enabled, rsnapshot must first be called with the <b>sync</b> argument, followed by the
           other usual cron entries. The sync should happen as the lowest, most frequent backup level, and right
           before. For example:

               <b>0</b> <b>*/4</b> <b>*</b> <b>*</b> <b>*</b>         <b>/usr/local/bin/rsnapshot</b> <b>sync</b> <b>&amp;&amp;</b> <b>/usr/local/bin/rsnapshot</b> <b>alpha</b>

               <b>50</b> <b>23</b> <b>*</b> <b>*</b> <b>*</b>         <b>/usr/local/bin/rsnapshot</b> <b>beta</b>

               <b>40</b> <b>23</b> <b>1,8,15,22</b> <b>*</b> <b>*</b> <b>/usr/local/bin/rsnapshot</b> <b>gamma</b>

               <b>30</b> <b>23</b> <b>1</b> <b>*</b> <b>*</b>         <b>/usr/local/bin/rsnapshot</b> <b>delta</b>

           The sync operation simply runs rsync and all backup scripts. In this scenario, all calls simply
           rotate directories, even the lowest backup level.

           Please note, that the above "rsnapshot sync &amp;&amp; rsnapshot alpha" command will skip rotation, whenever
           rsnapshot finishes its sync operation "with warnings" (e.g. some files vanished, while rsync was
           running).  If you want to ensure rotation even in case of warnings, then the following command may be
           suitable for your cron job:

               <b>0</b> <b>*/4</b> <b>*</b> <b>*</b> <b>*</b>         <b>/usr/local/bin/rsnapshot</b> <b>sync</b> <b>||</b> <b>[</b> <b>$?</b> <b>-eq</b> <b>2</b> <b>]</b> <b>&amp;&amp;</b> <b>/usr/local/bin/rsnapshot</b>
               <b>alpha</b>

       <b>rsnapshot</b> <b>sync</b> <b>[dest]</b>

           When <b>sync_first</b> is enabled, all sync behaviour happens during an additional sync step (see above).
           When using the sync argument, it is also possible to specify a backup point destination as an
           optional parameter. If this is done, only backup points sharing that destination path will be synced.

           For example, let's say that example.com is a destination path shared by one or more of your backup
           points.

               rsnapshot sync example.com

           This command will only sync the files that normally get backed up into example.com.  It will NOT get
           any other backup points with slightly different values (like example.com/etc/, for example). In order
           to sync example.com/etc, you would need to run rsnapshot again, using example.com/etc as the optional
           parameter.

       <b>rsnapshot</b> <b>configtest</b>

           Do a quick sanity check to make sure everything is ready to go.

</pre><h4><b>EXIT</b> <b>VALUES</b></h4><pre>
           <b>0</b>  All operations completed successfully

           <b>1</b>  A fatal error occurred

           <b>2</b>  Some warnings occurred, but the backup still finished

</pre><h4><b>FILES</b></h4><pre>
       /etc/rsnapshot.conf

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/rsync.1.html">rsync</a></b>(1), <b><a href="../man1/ssh.1.html">ssh</a></b>(1), <b><a href="../man1/logger.1.html">logger</a></b>(1), <b><a href="../man1/sshd.1.html">sshd</a></b>(1), <b><a href="../man1/ssh-keygen.1.html">ssh-keygen</a></b>(1), <b><a href="../man1/perl.1.html">perl</a></b>(1), <b><a href="../man1/cp.1.html">cp</a></b>(1), <b><a href="../man1/du.1.html">du</a></b>(1), <b><a href="../man1/crontab.1.html">crontab</a></b>(1)

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Use the <b>-t</b> flag to see what commands would have been executed. This will show you the commands rsnapshot
       would try to run. There are a few minor differences (for example, not showing an attempt to remove the
       lockfile because it wasn't really created in the test), but should give you a very good idea what will
       happen.

       Using the <b>-v</b>, <b>-V</b>, and <b>-D</b> flags will print increasingly more information to STDOUT.

       Make sure you don't have spaces in the config file that you think are actually tabs.

       Much other weird behavior can probably be attributed to plain old file system permissions and ssh
       authentication issues.

</pre><h4><b>BUGS</b></h4><pre>
       Please report bugs (and other comments) to the rsnapshot-discuss mailing list:

       <b><a href="http://lists.sourceforge.net/lists/listinfo/rsnapshot-discuss">http://lists.sourceforge.net/lists/listinfo/rsnapshot-discuss</a></b>

</pre><h4><b>NOTES</b></h4><pre>
       Make sure your <u>/etc/rsnapshot.conf</u> file has all elements separated by tabs.  See
       <u>/usr/share/doc/rsnapshot/examples/rsnapshot.conf.default.gz</u> for a working example file.

       Make sure you put a trailing slash on the end of all directory references.  If you don't, you may have
       extra directories created in your snapshots.  For more information on how the trailing slash is handled,
       see the <b><a href="../man1/rsync.1.html">rsync</a></b>(1) manpage.

       Make sure to make the snapshot directory chmod 700 and owned by root (assuming backups are made by the
       root user). If the snapshot directory is readable by other users, they will be able to modify the
       snapshots containing their files, thus destroying the integrity of the snapshots.

       If you would like regular users to be able to restore their own backups, there are a number of ways this
       can be accomplished. One such scenario would be:

       Set <b>snapshot_root</b> to <b>/.private/.snapshots</b> in <u>/etc/rsnapshot.conf</u>

       Set the file permissions on these directories as follows:

           drwx------    /.private

           drwxr-xr-x    /.private/.snapshots

       Export the /.private/.snapshots directory over read-only NFS, a read-only Samba share, etc.

       See the rsnapshot HOWTO for more information on making backups accessible to non-privileged users.

       For ssh to work unattended through cron, you will probably want to use public key logins. Create an ssh
       key with no passphrase for root, and install the public key on each machine you want to backup. If you
       are backing up system files from remote machines, this probably means unattended root logins. Another
       possibility is to create a second user on the machine just for backups. Give the user a different name
       such as "rsnapshot", but keep the UID and GID set to 0, to give root privileges. However, make logins
       more restrictive, either through ssh configuration, or using an alternate shell.

       BE CAREFUL! If the private key is obtained by an attacker, they will have free run of all the systems
       involved. If you are unclear on how to do this, see <b><a href="../man1/ssh.1.html">ssh</a></b>(1), <b><a href="../man1/sshd.1.html">sshd</a></b>(1), and <b><a href="../man1/ssh-keygen.1.html">ssh-keygen</a></b>(1).

       Backup scripts are run as the same user that rsnapshot is running as.  Typically this is root. Make sure
       that all of your backup scripts are only writable by root, and that they don't call any other programs
       that aren't owned by root. If you fail to do this, anyone who can write to the backup script or any
       program it calls can fully take over the machine. Of course, this is not a situation unique to rsnapshot.

       By default, rsync transfers are done using the --numeric-ids option.  This means that user names and
       group names are ignored during transfers, but the UID/GID information is kept intact. The assumption is
       that the backups will be restored in the same environment they came from. Without this option, restoring
       backups for multiple heterogeneous servers would be unmanageable. If you are archiving snapshots with GNU
       tar, you may want to use the --numeric-owner parameter. Also, keep a copy of the archived system's
       <u><a href="file:/etc/passwd">/etc/passwd</a></u> and <u><a href="file:/etc/group">/etc/group</a></u> files handy for the UID/GID to name mapping.

       If you remove backup points in the config file, the previously archived files under those points will
       permanently stay in the snapshots directory unless you remove the files yourself. If you want to conserve
       disk space, you will need to go into the &lt;snapshot_root&gt; directory and manually remove the files from the
       smallest backup level's ".0" directory.

       For example, if you were previously backing up <a href="file:/home/">/home/</a> with a destination of localhost/, and alpha is your
       smallest backup level, you would need to do the following to reclaim that disk space:

           rm -rf &lt;snapshot_root&gt;/alpha.0/localhost/home/

       Please note that the other snapshots previously made of <a href="file:/home/">/home/</a> will still be using that disk space, but
       since the files are flushed out of alpha.0/, they will no longer be copied to the subsequent directories,
       and will thus be removed in due time as the rotations happen.

</pre><h4><b>AUTHORS</b></h4><pre>
       Mike Rubel - <b><a href="http://www.mikerubel.org/computers/rsync_snapshots/">http://www.mikerubel.org/computers/rsync_snapshots/</a></b>

       - Created the original shell scripts on which this project is based

       Nathan Rosenquist (<b><a href="mailto:nathan@rsnapshot.org">nathan@rsnapshot.org</a></b>)

       - Primary author and original maintainer of rsnapshot.

       David Cantrell (<b><a href="mailto:david@cantrell.org.uk">david@cantrell.org.uk</a></b>)

       - Previous maintainer of rsnapshot
       - Wrote the "rsnapshot-diff" utility
       - Improved how use_lazy_deletes work so slow deletes don't screw up the next backup at that backup level.

       David Keegel &lt;<a href="mailto:djk@cybersource.com.au">djk@cybersource.com.au</a>&gt;

       - Previous rsnapshot maintainer
       - Fixed race condition in lock file creation, improved error reporting
       - Allowed remote ssh directory paths starting with "~/" as well as "/"
       - Fixed a number of other bugs and buglets

       Benedikt Heine &lt;<a href="mailto:bebe@bebehei.de">bebe@bebehei.de</a>&gt;

       - ex-maintainer of rsnapshot (2015-2017)

       Carl Wilhelm Soderstrom (<b><a href="mailto:chrome@real-time.com">chrome@real-time.com</a></b>)

       - Created the RPM .spec file which allowed the RPM package to be built, among other things.

       Ted Zlatanov (<b><a href="mailto:tzz@lifelogs.com">tzz@lifelogs.com</a></b>)

       - Added the one_fs feature, autoconf support, good advice, and much more.

       Ralf van Dooren (<b><a href="mailto:r.vdooren@snow.nl">r.vdooren@snow.nl</a></b>)

       - Added and maintains the rsnapshot entry in the FreeBSD ports tree.

       SlapAyoda

       - Provided access to his computer museum for software testing.

       Carl Boe (<b><a href="mailto:boe@demog.berkeley.edu">boe@demog.berkeley.edu</a></b>)

       - Found several subtle bugs and provided fixes for them.

       Shane Leibling (<b><a href="mailto:shane@cryptio.net">shane@cryptio.net</a></b>)

       - Fixed a compatibility bug in utils/backup_smb_share.sh

       Christoph Wegscheider (<b><a href="mailto:christoph.wegscheider@wegi.net">christoph.wegscheider@wegi.net</a></b>)

       - Added (and previously maintained) the Debian rsnapshot package.

       Bharat Mediratta (<b><a href="mailto:bharat@menalto.com">bharat@menalto.com</a></b>)

       - Improved the exclusion rules to avoid backing up the snapshot root (among other things).

       Peter Palfrader (<b><a href="mailto:weasel@debian.org">weasel@debian.org</a></b>)

       - Enhanced error reporting to include command line options.

       Nicolas Kaiser (<b><a href="mailto:nikai@nikai.net">nikai@nikai.net</a></b>)

       - Fixed typos in program and man page

       Chris Petersen - (<b><a href="http://www.forevermore.net/">http://www.forevermore.net/</a></b>)

           Added cwrsync permanent-share support

       Robert Jackson (<b><a href="mailto:RobertJ@promedicalinc.com">RobertJ@promedicalinc.com</a></b>)

           Added use_lazy_deletes feature

       Justin Grote (<b><a href="mailto:justin@grote.name">justin@grote.name</a></b>)

           Improved rsync error reporting code

       Anthony Ettinger (<b><a href="mailto:apwebdesign@yahoo.com">apwebdesign@yahoo.com</a></b>)

           Wrote the "utils/mysqlbackup.pl" script

       Sherman Boyd

           Wrote "utils/random_file_verify.sh" script

       William Bear (<b><a href="mailto:bear@umn.edu">bear@umn.edu</a></b>)

           Wrote the "utils/rsnapreport.pl" script (pretty summary of rsync stats)

       Eric Anderson (<b><a href="mailto:anderson@centtech.com">anderson@centtech.com</a></b>)

           Improvements to "utils/rsnapreport.pl".

       Alan Batie (<b><a href="mailto:alan@batie.org">alan@batie.org</a></b>)

           Bug fixes for include_conf

       Dieter Bloms (<b><a href="mailto:dieter@bloms.de">dieter@bloms.de</a></b>)

           Multi-line configuration options

       Henning Moll (<b><a href="mailto:newsScott@gmx.de">newsScott@gmx.de</a></b>)

           stop_on_stale_lockfile

       Ben Low (<b><a href="mailto:ben@bdlow.net">ben@bdlow.net</a></b>)

           Linux LVM snapshot support

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2003-2005 Nathan Rosenquist

       Portions  Copyright  (C)  2002-2007  Mike  Rubel,  Carl Wilhelm Soderstrom, Ted Zlatanov, Carl Boe, Shane
       Liebling, Bharat Mediratta, Peter Palfrader, Nicolas  Kaiser,  David  Cantrell,  Chris  Petersen,  Robert
       Jackson, Justin Grote, David Keegel, Alan Batie, Dieter Bloms, Henning Moll, Ben Low, Anthony Ettinger

       This man page is distributed under the same license as rsnapshot: the GPL (see below).

       This  program  is  free  software;  you  can  redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation; either version 2 of the License,  or
       (at your option) any later version.

       This  program  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General  Public
       License for more details.

       You  should have received a copy of the GNU General Public License along with this program; if not, write
       to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301 USA

rsnapshot-tools                                    2025-01-29                                       <u><a href="../man1/rsnapshot.1.html">rsnapshot</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>