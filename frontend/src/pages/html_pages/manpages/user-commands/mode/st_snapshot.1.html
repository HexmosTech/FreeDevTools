<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>st_snapshot - calculate checksum and stat ownership and permissions of files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/systraq">systraq_20201231-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       st_snapshot - calculate checksum and stat ownership and permissions of files

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <u>ST_SUM=sha256sum</u> <b>st_snapshot</b> <u>patterns</u> <u>homepatterns</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       st_snapshot calculates checksums and stats ownership and permissions of critical system files.

       This script is typically run in either root-mode or public-mode.  Running this script in root-mode
       requires root priviliges.  One is adviced to set up a dedicated user account for running this script in
       public mode.

       In root-mode, the files snapshot_root.list and snapshot_root.homelist are typically passed as arguments.
       These pattern files are read by the script and contain names of files and directories; listing a
       directory in such a pattern file is equivalent to listing all files which live in the directorytree with
       this directory as root.

       snapshot_root.list could e.g. read

        # snapshot_root.list - files and directories we wanna get
        # monitored: we wanna get a note once these files, or any file
        # under these directories, gets created, gets rm-ed, gets
        # permissions or contents changed.  these notices will not
        # include the possibly secret contents of these files
        #
        # this file gets read by st_systraq
        <a href="file:/etc/group">/etc/group</a>
        <a href="file:/etc/gshadow">/etc/gshadow</a>
        <a href="file:/etc/hosts.allow">/etc/hosts.allow</a>
        <a href="file:/etc/hosts.deny">/etc/hosts.deny</a>
        /etc/hosts.equiv
        /etc/lilo.conf
        <a href="file:/etc/passwd">/etc/passwd</a>
        /etc/postfix/server.pem
        <a href="file:/etc/shadow">/etc/shadow</a>
        <a href="file:/etc/skel">/etc/skel</a>
        <a href="file:/etc/ssh">/etc/ssh</a>

       Equivalent files snapshot_pub.list and snapshot_pub.homelist should be on the system.  These files should
       contain all worldreadable to be monitored files.  This allows for running this script as root <u>only</u> in
       those cases where it's needed: when reading files, readable for root only.

       The homelist files contain files and directories which should get monitored for every homedirectory on
       the system.  snapshot_pub.homelist could e.g. contain:

        .profile
        .cshrc
        .tcshrc
        .login
        .logout
        .bash_profile
        .bashrc
        .exrc
        .nexrc

       As a special case, when the environment variable ST_OPHOMES is set to a non-empty string (typically when
       running in public mode), we stat the permissions on all homedirectories themselves.

       The produced snapshot is printed to stdout.  The output when running in public mode could look like:

        # ownership and permissions of homedirs
        drwxr-xr-x root root <a href="file:/bin">/bin</a>
        drwxr-xr-x root root <a href="file:/dev">/dev</a>
        drwxr-sr-x root staff <a href="file:/home">/home</a>
        drwxr-sr-x joostvb joostvb /home/joostvb
        drwxr-xr-x root root <a href="file:/usr/sbin">/usr/sbin</a>
        drwxr-xr-x root root <a href="file:/var">/var</a>
        # sha256sum of critical pub files
        4d3cd13d6dbc10e2e3ccb9477cbc9eb9b76302454c276d5771ae0b10a5fbb4d2  /home/joostvb/.ssh/id_rsa.pub
        eb8d83e0246f761a21bdfb13a03fac634ed7c3b7dde4c2efddd7b2838d32596f  /var/qmail/alias/.bashrc
        4e371f9a11f5a2464d3d5c952e58e24f73b377d33767ed93b2082fcb59a647fe  /etc/zlogin
        # ownership and permissions of critical pub files
        -rw-rw-r-- joostvb joostvb /home/joostvb/.ssh/id_rsa.pub
        -rw-r--r-- joostvb joostvb /home/joostvb/.ssh/authorized_keys

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       ST_OPHOMES - non-empty in case permissions on all homedirectories should be printed

       ST_SUM - command for calculating file checksums.  E.g. sha256sum, sha512sum, sha384sum, sha224sum or
       sha1sum.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       The systraq manual.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2001, 2002, 2003, 2004, 2008 Joost van Baal

       This program is free software; you can redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with this program (see COPYING);
       if not, check with <a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> or write to the Free Software Foundation, Inc.,
       59 Temple Place - Suite 330, Boston, MA  02111, USA.

</pre><h4><b>AUTHOR</b></h4><pre>
       Joost van Baal-IliX &lt;<a href="mailto:joostvb-systraq-20201231@mdcc.cx">joostvb-systraq-20201231@mdcc.cx</a>&gt;

20201231                                           2020-12-31                                     <u><a href="../man1/ST_SNAPSHOT.1.html">ST_SNAPSHOT</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>