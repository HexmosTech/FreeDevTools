<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>virt-p2v-make-kickstart - Build the virt-p2v kickstart</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/virt-p2v">virt-p2v_1.42.4-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       virt-p2v-make-kickstart - Build the virt-p2v kickstart

</pre><h4><b>SYNOPSIS</b></h4><pre>
        virt-p2v-make-kickstart [-o p2v.ks] [--proxy=http://...] repo [repo...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b><a href="../man1/virt-p2v.1.html">virt-p2v</a></b>(1) converts a physical machine to run virtualized on KVM, managed by libvirt, OpenStack, oVirt,
       Red Hat Enterprise Virtualisation (RHEV), or one of the other targets supported by <b><a href="../man1/virt-v2v.1.html">virt-v2v</a></b>(1).

       Kickstart is a format used by Red Hat-derived distributions (such as Fedora, Red Hat Enterprise Linux,
       CentOS, Scientific Linux, and others) to describe how to make live CDs, install the distro, make "Spins"
       and so on.  It is driven by a kickstart file.

       virt-p2v-make-kickstart builds a kickstart file which can be used to build a bootable P2V ISO, live CD,
       USB key, or PXE image.  This tool only builds the kickstart file, but this manual page describes some of
       the ways you can use the kickstart file.

       The root user on the disk image uses "p2v" as its initial password.

</pre><h4><b>BUILDING</b> <b>THE</b> <b>KICKSTART</b> <b>FILE</b></h4><pre>
       Using virt-p2v-make-kickstart is very simple:

        virt-p2v-make-kickstart fedora

       will build a kickstart file for Fedora.  The kickstart file will be called <u>p2v.ks</u> and located in the
       current directory.

       The parameters are a list of one or more repositories.  Some built-in repositories are available:
       "fedora", "rawhide", "koji" or "rhel-VERSION" (eg. "rhel-7.1").  You can also use a URL as a parameter to
       point to a repository, for example:

        virt-p2v-make-kickstart https://dl.fedoraproject.org/pub/fedora/linux/releases/21/Everything/x86_64/os/

       To control the name of the output file, use the <u>-o</u> parameter.  To tell kickstart to use a proxy server or
       web cache to download files, use the <u>--proxy</u> parameter.

</pre><h4><b>BUILDING</b> <b>A</b> <b>LIVE</b> <b>CD</b> <b>/</b> <b>ISO</b></h4><pre>
       Once you have the kickstart file, you can use <b><a href="../man8/livecd-creator.8.html">livecd-creator</a></b>(8) to make a live CD:

        sudo livecd-creator p2v.ks

       Before running this note that you should probably run "livecd-creator" in a disposable virtual machine
       for these reasons:

       •   You have to disable SELinux when running the tool.

       •   This tool has to be run as root, and has some nasty failure modes.

       •   You  can  only  create  the  exact same Live CD distro as the host distro.  Cross-builds will fail in
           strange ways (eg. RHBZ#1092327).

</pre><h4><b>BUILDING</b> <b>A</b> <b>FEDORA</b> <b>SPIN</b> <b>USING</b> <b>KOJI</b></h4><pre>
       This requires "spin-livecd" permissions on Koji,  which  are  not  given  out  usually,  even  to  Fedora
       packagers.   However  assuming  you  have been given these permissions (or have your own Koji instance, I
       guess), then you can do:

        koji spin-livecd [--scratch] virt-p2v 1.XX.YY rawhide x86_64 p2v.ks

       •   Add the "--scratch" option to do a scratch build (recommended for testing).

       •   "1.XX.YY" should match the libguestfs version

       •   Instead of "rawhide" you can use any Koji target.

</pre><h4><b>BUILDING</b> <b>A</b> <b>BOOTABLE</b> <b>USB</b> <b>KEY</b></h4><pre>
       Use the <b><a href="../man8/livecd-iso-to-disk.8.html">livecd-iso-to-disk</a></b>(8) program to convert the ISO created above to a USB key:

        sudo livecd-iso-to-disk livecd-p2v.iso /dev/sdX

</pre><h4><b>BUILDING</b> <b>A</b> <b>PXE</b> <b>BOOT</b> <b>IMAGE</b></h4><pre>
       Use the "livecd-iso-to-pxeboot" program to convert the ISO created above to a PXE boot image.

        sudo livecd-iso-to-pxeboot livecd-p2v.iso

       This creates a "tftpboot" subdirectory under the current directory containing the files required  to  PXE
       boot virt-p2v:

        $ ls -1R tftpboot/
        tftpboot/:
        initrd0.img
        pxelinux.0
        pxelinux.cfg/
        vmlinuz0

        tftpboot/pxelinux.cfg:
        default

</pre><h4><b>32</b> <b>OR</b> <b>64</b> <b>BIT</b> <b>VIRT-P2V?</b></h4><pre>
       Virt-p2v can convert any 32 or 64 bit guest, regardless of whether virt-p2v itself is built as a 32 or 64
       bit binary.  The only restriction is that 64 bit virt-p2v cannot run on 32 bit hardware.

       Old  virt-p2v 0.9 was always built as a 32 bit (i686) ISO.  This meant that the CD could be booted on any
       32- or 64-bit i686 or x86-64 hardware, and could convert any guest.  The old virt-p2v ISO shipped by  Red
       Hat was based on Red Hat Enterprise Linux (RHEL) 6.

       Since  RHEL 7 dropped support for 32 bit machines, current virt-p2v on RHEL can only be built for 64 bit.
       It cannot run on old 32 bit only hardware.

       Fedora virt-p2v ISOs are generally built for 32 bit, so like the old RHEL 6-based virt-p2v 0.9  they  can
       boot on any hardware.

</pre><h4><b>TESTING</b> <b>VIRT-P2V</b> <b>USING</b> <b>QEMU</b></h4><pre>
   <b>TESTING</b> <b>THE</b> <b>P2V</b> <b>ISO</b> <b>USING</b> <b>QEMU</b>
       You can use qemu to test-boot the P2V ISO (BIOS mode):

        qemu-kvm -m 1024 -hda /tmp/guest.img -cdrom /tmp/livecd-p2v.iso -boot d

       Note  that  "-hda" is the (virtual) system that you want to convert (for test purposes).  It could be any
       guest type supported by <b><a href="../man1/virt-v2v.1.html">virt-v2v</a></b>(1), including Windows or Red Hat Enterprise Linux.

       For UEFI:

        qemu-kvm -m 1024 -M q35 \
            -drive if=pflash,format=raw,file=/usr/share/OVMF/OVMF_CODE.fd,readonly=on \
            -drive if=pflash,format=raw,file=/usr/share/OVMF/OVMF_VARS.fd,snapshot=on \
            \
            -drive if=none,format=raw,file=/tmp/guest.img,media=disk,id=guest-disk \
            -device ide-hd,drive=guest-disk,bus=ide.0 \
            \
            -drive if=none,format=raw,file=/tmp/livecd-p2v.iso,media=cdrom,id=p2v-cdrom \
            -device ide-cd,drive=p2v-cdrom,bus=ide.1,bootindex=1

   <b>TESTING</b> <b>PXE</b> <b>SUPPORT</b> <b>USING</b> <b>QEMU</b>
       •   Unpack the tftpboot directory into <u><a href="file:/tmp">/tmp</a></u> (so it appears as <u>/tmp/tftpboot</u>).

       •   Copy <u>pxelinux.0</u> and <u>ldlinux.c32</u> from syslinux (usually from <u>/usr/share/syslinux</u>) into <u>/tmp/tftpboot</u>.

       •   Adjust the "APPEND" line in <u>/tmp/tftpboot/pxelinux.cfg/default</u> if required.  See "KERNEL COMMAND LINE
           CONFIGURATION" in <b><a href="../man1/virt-p2v.1.html">virt-p2v</a></b>(1).

       •   Run qemu like this so that it acts as a TFTP and BOOTP server, emulating a netboot:

            qemu-kvm \
                -m 4096 -hda /tmp/guest.img \
                -boot n \
                -netdev user,id=unet,tftp=/tmp/tftpboot,bootfile=/pxelinux.0 \
                -device virtio-net-pci,netdev=unet \
                -serial stdio

           Note that this requires considerably more memory because the PXE image is loaded into  memory.   Also
           that  qemu’s  TFTP  server is very slow and the virt-p2v PXE image is very large, so it can appear to
           "hang" after pxelinux starts up.

</pre><h4><b>ADDING</b> <b>EXTRA</b> <b>PACKAGES</b></h4><pre>
       You can install extra packages using the <u>--install</u> option.  This can be useful for making a  more  fully-
       featured  virt-p2v  disk  with  extra  tools for debugging and troubleshooting.  Give a list of packages,
       separated by commas.  For example:

        virt-p2v-make-kickstart [...] --install tcpdump,traceroute

</pre><h4><b>ADDING</b> <b>AN</b> <b>SSH</b> <b>IDENTITY</b></h4><pre>
       You can inject an SSH identity (private key) file to the kickstart and  hence  into  the  ISO  using  the
       <u>--inject-ssh-identity</u> option.  Note that you <u>cannot</u> inject a key once the ISO has been built.

       First create a key pair.  It must have an empty passphrase:

        ssh-keygen -t rsa -N '' -f id_rsa

       This  creates  a  private  key ("id_rsa") and a public key ("id_rsa.pub") pair.  The public key should be
       appended  to   the   "authorized_keys"   file   on   the   virt-v2v   conversion   server   (usually   to
       "/root/.ssh/authorized_keys").

       The private key should be added to the kickstart file and then discarded:

        virt-p2v-make-kickstart [...] --inject-ssh-identity id_rsa
        rm id_rsa

       The  ISO  can  then  be  built  from  the kickstart in the usual way (see above), and it will contain the
       embedded SSH identity (<u>/var/tmp/id_rsa</u>).

       When booting virt-p2v, specify the URL of the injected file like this:

        │         User name: [root_____________________________] │
        │                                                        │
        │          Password: [    &lt;leave this field blank&gt;     ] │
        │                                                        │
        │  SSH Identity URL: [file:///var/tmp/id_rsa___________] │

       or if using the kernel command line, add:

        p2v.identity=file:///var/tmp/id_rsa

       For more information, see "SSH IDENTITIES" in <b><a href="../man1/virt-p2v.1.html">virt-p2v</a></b>(1).

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--help</b>
           Display help.

       <b>--inject-ssh-identity</b> id_rsa
           Add an SSH identity (private key) file into the kickstart.  See "ADDING AN SSH IDENTITY" above.

       <b>--install</b> pkg,pkg,...
           Add extra packages to the kickstart %packages section.  See "ADDING EXTRA PACKAGES" above.

       <b>-o</b> OUTPUT
       <b>--output</b> OUTPUT
           Write kickstart to "OUTPUT".  If not specified, the default is <u>p2v.ks</u> in the current directory.

       <b>--proxy</b> URL
           Tell the kickstart to use a proxy server or web cache for downloads.

       <b>-v</b>
       <b>--verbose</b>
           Enable verbose output.  Use this if you need to debug problems with the script or if you are filing a
           bug.

       <b>-V</b>
       <b>--version</b>
           Display version number and exit.

</pre><h4><b>FILES</b></h4><pre>
       <u>$libdir/virt-p2v/virt-p2v.xz</u>
           The <b><a href="../man1/virt-p2v.1.html">virt-p2v</a></b>(1) binary which is copied into the kickstart file.

           The location of the binary can be changed by setting the "VIRT_P2V_DATA_DIR" environment variable.

       <u>$datadir/virt-p2v/issue</u>
       <u>$datadir/virt-p2v/launch-virt-p2v.in</u>
       <u>$datadir/virt-p2v/p2v.ks.in</u>
       <u>$datadir/virt-p2v/p2v.service</u>
           Various data files that are used to make the kickstart.

           The location of these files can be changed by setting the "VIRT_P2V_DATA_DIR" environment variable.

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       "VIRT_P2V_DATA_DIR"
           The directory where virt-p2v-make-kickstart looks for data files and the virt-p2v binary (see "FILES"
           above).  If not set, a compiled-in location is used.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/virt-p2v.1.html">virt-p2v</a></b>(1),    <b><a href="../man1/virt-p2v-make-disk.1.html">virt-p2v-make-disk</a></b>(1),     <b><a href="../man1/virt-v2v.1.html">virt-v2v</a></b>(1),     <b><a href="../man8/livecd-creator.8.html">livecd-creator</a></b>(8),     <b><a href="../man8/livecd-iso-to-disk.8.html">livecd-iso-to-disk</a></b>(8),
       <a href="http://libguestfs.org/">http://libguestfs.org/</a>.

</pre><h4><b>AUTHORS</b></h4><pre>
       Richard W.M. Jones <a href="http://people.redhat.com/~rjones/">http://people.redhat.com/~rjones/</a>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2009-2019 Red Hat Inc.

</pre><h4><b>LICENSE</b></h4><pre>
       This  program  is  free  software;  you  can  redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation; either version 2 of the License,  or
       (at your option) any later version.

       This  program  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General  Public
       License for more details.

       You  should  have received a copy of the GNU General Public License along with this program.  If not, see
       &lt;https://www.gnu.org/licenses/&gt;.

</pre><h4><b>BUGS</b></h4><pre>
       To  get  a   list   of   bugs   against   libguestfs   (which   include   virt-p2v),   use   this   link:
       https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools

       To       report       a       new       bug       against       libguestfs,      use      this      link:
       https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools

       When reporting a bug, please supply:

       •   The version of virt-p2v.

       •   Where you got virt-p2v (eg. which Linux distro, compiled from source, etc)

       •   Describe the bug accurately and give a way to reproduce it.

virt-p2v-1.42.4                                    2024-11-30                         <u><a href="../man1/virt-p2v-make-kickstart.1.html">virt-p2v-make-kickstart</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>