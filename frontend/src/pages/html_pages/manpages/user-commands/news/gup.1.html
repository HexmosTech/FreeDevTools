<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gup  -  A  Group  Update  Program that accepts commands by mail to edit a newsgroup subscription file for</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/gup">gup_0.5.15build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gup  -  A  <u>G</u>roup  <u>U</u>pdate  <u>P</u>rogram that accepts commands by mail to edit a newsgroup subscription file for
       subsequent use by news systems such as <u>INN</u> and <u>C-News</u>.

</pre><h4><b>SYNTAX</b></h4><pre>
       <b>gup</b> [<b>-hvP</b>] -a <u>active_path</u> [<b>-d</b> <u>home_directory</u>] [<b>-l</b> <u>log_path</u>]
             [<b>-m</b> <u>reply_headers</u>] [<b>-n</b> <u>newsgroups_path</u>]
             [<b>-s</b> <u>sites_directory</u>] [<b>-M</b> <u>Mail_command</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The sole purpose of <u>gup</u> is to automate the tedious process of editing group selection patterns defined in
       the news configuration files (eg: ``newsfeeds'' for <u>INN</u> and ``sys'' for <u>C-News</u>).

       <u>Gup</u> is of use to news administrators who spend an inordinate amount of time  editing  their  news  config
       files  at  the  behest  of  the sites they feed.  In fact, once <u>gup</u> is installed, it is quite likely that
       manual edits of your ``newsfeeds'' or ``sys'' file will become a thing of the past.

       <u>Gup</u> is designed to be installed as a mail-server program that is fed an inbound mail via stdin.   <u>Gup</u>  is
       usually invoked from a .forward file. Eg:

            "|/.../bin/gup -options...."

       Each  site  has  an entry in the ``config'' file containing password and mail address details and a group
       selection file called ``groups'', see <b>CONFIG</b>, and <b>GROUPS</b> for more details.

       The news administrator of each site mails commands to <u>gup</u>.  There are commands  to  include  and  exclude
       group  patterns, list the current patterns for that site and list the available newsgroups; see <b>COMMANDS</b>,
       for more details.

       The results are normally mailed  back  to  the  site's  configured  administrator.   However  under  some
       circumstances,  the  results are mailed to the originator or the local administrator; see <b>PROCESSING</b>, for
       further details.

       <u>Gup</u> does not directly change the news system's control files (eg,  ``newsfeeds''  for  INN).   Instead  a
       trivial  shell  script  must  be  run to concatenate all of the changed ``groups'' files together into an
       appropriately formatted file for your particular news system. (One is provided  in  the  source  kit  for
       INN).

       Since  each  site has to be specifically configured in <u>gup</u>'s ``config'' file, access can be restricted to
       administrator's capable of managing their own group patterns.

</pre><h4><b>OPTIONS</b></h4><pre>
       Options can appear in any order on the command line. The most important point to note is that all of  the
       paths and directories defined will normally be absolute paths unless you are intimately familiar with the
       way  in  which  <u>gup</u>  changes  directories  as  it  processes  a  mail (the possible exception here is the
       Sites_directory).

       <b>-a</b> <u>active_path</u>
              The path of the active file for your news system.  Before accepting any newsgroup identified in  a
              command,  <u>gup</u>  validates the group against the active file. The command is rejected if no match is
              found.

       <b>-d</b> <u>home_directory</u>
              Defines <u>gup</u>'s home directory.  <u>Gup</u> changes to this directory as soon as  possible  after  starting
              up.  If  this  option is not present, the current directory is used.  <u>Gup</u> looks for the ``config''
              file in it's home directory.

       <b>-h</b>     Print out a help message showing the command line options, then exit.

       <b>-l</b> <u>log_path</u>
              A record of all significant requests are written to this file. If the path is  relative,  then  it
              will  be  relative to <u>gup</u>'s home directory; see the -d option).  <u>Gup</u> must be able to write to this
              file.  If the <b>-l</b> option is not used, then <u>gup</u> uses stderr. This is useful  for  testing  purposes,
              but is unlikely to be of use in a .forward file.

       <b>-m</b> <u>reply_headers</u>
              When  <u>gup</u>  generates  a  mail  response  it  only generates the ``To: '' header line.  This option
              defines the path of a file that contains other RFC882 conformant header lines that  are  piped  to
              the  mail  program  (see  the  -M  option).   In  fact, if this file contains a body following the
              headers, then that will precede any text generated by <u>gup</u>.  If this path is not an absolute  path,
              then it will be treated as relative to <u>gup</u>'s home directory (see the -d option).

       <b>-M</b> <u>Mail_command</u>
              <u>Gup</u>  pipes  the  rfc822  headers and the body of the mail to the nominated mail program. Normally,
              this is configured when <u>gup</u> is installed, but it can be over-ridden with  this  option.  The  mail
              command must be able to determine the recipient addresses from the rfc822 headers.

       <b>-n</b> <u>newsgroups_path</u>
              If  present,  the newsgroups file is used to try and find a matching description of newsgroup when
              listed.

       <b>-P</b>     Do <u>not</u> prune superfluous patterns from a  site's  ``groups''  file.  Before  writing  the  updated
              ``groups''  file,  <u>gup</u>  applies a fairly rigorous test to the patterns, pruning any nonsensical or
              un-necessary patterns. This pruning process can be quite CP intensive to the extent  that  it  may
              have a deleterious effect on your system - thus the ability to disable it.

       <b>-s</b> <u>Sites_directory</u>
              Each site's ``groups'' and ``exclude'' file are located in a unique directory for each site. These
              site  directories  are  located  in  the directory defined with this option. If this is given as a
              relative path then it will be relative to <u>gup</u>'s home directory (see the -d option).  <u>Gup</u> will  try
              and create this directory if it does not exist.

       <b>-v</b>     Print out the version number and various compile-time variables, then exit.

</pre><h4><b>COMMANDS</b></h4><pre>
       <u>Gup</u>  scans  the  body  of  the  mail  for  commands. Blank lines are ignored and any data after the ``#''
       character is considered a comment. No continuation is allowed. Many of the commands accept a pattern as a
       parameter.  This pattern is identical to the format of the wildmat() pattern;  see  <b>wildmat</b>  <b>(3)</b>  ).   In
       fact, <u>Gup</u> purposely uses the <b>wildmat</b> routine from INN to ensure that the pattern matching characteristics
       are identical.

       Valid commands are:

       <b>site</b> <u>sitename</u> <u>password</u>
              This  <u>must</u>  be  the  first  command in the mail.  <u>sitename</u> and <u>password</u> must match an entry in the
              ``config'' file.  Only one <u>site</u> command is allowed per mail. Aliases: "open" and "host".

       <b>quit</b>   This command stops <u>gup</u> from processing the rest of the mail. This is  useful  if  your  mail  User
              Agent tends to automatically append a signature file to your mail. Alias: "q".

       <b>include</b> <u>pattern</u>
              The  <u>pattern</u> is checked against the active file. If it matches at least one newsgroup, the <u>pattern</u>
              is placed at the end of the site's ``group'' file as an  <u>include</u>  entry.   Only  one  <u>pattern</u>  per
              <u>include</u>  command  is  allowed.  If  the pattern matches anything in the site's exclusion list (see
              <b>EXCLUSIONS</b>) then the include will fail.  Aliases: "+" and "inc".

       <b>exclude</b> <u>pattern</u>
              The <u>pattern</u> is checked against the active file. If it matches at least one newsgroup, the  <u>pattern</u>
              is  placed  at  the  end  of  the site's ``group'' file as an <u>exclude</u> entry.  Only one <u>pattern</u> per
              <u>exclude</u> command is allowed.  Aliases: "-" and "exc".

       <b>poison</b> <u>pattern</u>
              If the <u>pattern</u> matches at least one crossposted newsgroup the article will not be accepted even if
              allowed by an <u>include</u> statement.  Only one <u>pattern</u> per <u>poison</u> command is allowed.

       <b>help</b>   Generate a small help message that briefly describes each command.  There is an implied quit  with
              the help command so there is no point in placing commands after the help command.  Alias: "h".

       <b>list</b>   list  all of the current <u>include</u> and <u>exclude</u> patterns in the sites ``groups'' file.  The output is
              in a format suitable for feeding back into <u>gup</u> at a later stage if need be.  Alias: "l".

       <b>delete</b> <u>pattern</u>
              Delete all <u>include</u>, <u>exclude</u> and <u>poison</u> patterns in the  site's  ``groups''  file  that  match  the
              <u>pattern</u>.  ``delete *'' is an effective way of clearing all current patterns.

       <b>newsgroups</b> <u>pattern</u>
              This  command lists out all available newsgroups from the active file that match the <u>pattern</u>.  The
              list includes the description from the newsgroups file as well as an indication  if  the  site  is
              currently  subscribed  to that group.  Only one <u>pattern</u> per <u>newsgroups</u> command is allowed.  Alias:
              "news".

</pre><h4><b>PROCESSING</b></h4><pre>
       <u>Gup</u> has a number of processing stages.  The  initialization  stage  consists  of  changing  to  the  home
       directory  (see  the  -d  option) and opening the logfile (see the -l option). At this time, <u>gup</u> sets the
       tentative reply-to mail address to the ``backstop'' mail address defined when <u>gup</u> was compiled (typically
       the local news administrator).

       The next stage consists of  scanning  the  inbound  mail,  noting  <u>interesting</u>  mail  headers.  The  most
       interesting ones are "To:" and "Reply-To:".  When a "To:" header is found it becomes the tentative reply-
       to  mail  address.  If  a  "Reply-To:"  header is found it over-rides any "To:" address to become the new
       tentative reply-to mail address.  A few others are noted and logged to help track changes.

       After all the headers have been processed, the body of the mail  is  examined  for  commands.  The  first
       command  <b>must</b> be the <u>site</u> command. Any other data results in an error mail sent to the tentative reply-to
       mail address.  If the <u>site</u> command contains a name that matches an entry in the ``config'' file, then the
       tentative reply-to mail address is replaced with the mail address in the ``config'' file.

       The reason for these contortions with tentative reply-to mail  addresses  is  simply  to  deal  with  the
       problem of working out who to send a mail to in the event of an error. Ideally they should all go back to
       the  mail  address in the ``config'' file, but that information is not known for quite a significant part
       of <u>gup</u>'s initial processing.

       Once a valid <u>site</u> command has been accepted, <u>gup</u> changes to that site's directory in Sites_directory (see
       the -s option) making the Sites_directory and site's directory as necessary. The site's directory name is
       the same as the site's name. In the absence of the -s option this will be:

            $HOME/sites/$site

       Where $HOME is <u>gup</u>'s home directory and $site is the name of the site being  processed.   <u>Gup</u>  locks  the
       site  then  loads the site's current ``groups'' file and any xclusion list if present (see <b>EXCLUSIONS</b> for
       more details).

       From this point on <u>gup</u> accepts any command in any order until either the end of the mail, a quit  command
       a  help  command  or  a  serious  error  during  processing.  After all commands have been processed, <u>gup</u>
       update's the site's ``groups'' file if  changes  have  been  made.   This  update  includes  pruning  any
       superfluous  patterns  (unless the -P option is used).  <u>Gup</u> writes the new patterns to ``groups.new''. It
       then renames ``groups'' to ``group.old'' and finally renames ``groups.new'' to ``groups''.  The result of
       all this processing is mailed to the site administrator defined in the ``config'' file.

</pre><h4><b>CONFIG</b></h4><pre>
       Access to <u>gup</u> is controlled by the ``config'' file in <u>gup</u>'s home directory (see  the  -d  option).   This
       file  contains one line per site. Each line contains three white-space separated tokens. The site's name,
       password and mail address of the administrator.  Blank lines are allowed and comments  follow  the  ``#''
       character.  <u>Gup</u> uses a very simple tokenizer, thus no quoting or continuation is allow in this file.

       The  site  name and password are used to check an inbound <u>site</u> command. The password can be crypted or in
       <u>plain-text</u> so permissions should be carefully set to restrict access. Here's an example of  a  ``config''
       file.

            werple    Fert5566a__$1  <a href="mailto:andrew@werple.apana.org.au">andrew@werple.apana.org.au</a>
            torps     34fkr_&amp;&amp;11)Zz  <a href="mailto:zaph@torps.apana.org.au">zaph@torps.apana.org.au</a>
            uunet     R_S_1@@*(A-\   <a href="mailto:news@uunet.uu.net">news@uunet.uu.net</a>
            .test     flapper        markd

       Hopefully this is intuitively obvious...

</pre><h4><b>GROUPS</b></h4><pre>
       Each  site has it's own file of patterns. This file is called ``groups'' and is located in the site's own
       directory below the Sites_directory (see the -s option).   This  file  contains  one  pattern  per  line.
       Exclusion lists have a preceding ``!'' character. Here's an example:

       apana.*
       !apana.lists.*
       !apana.fido.*
       !apana.vortex.*
       alt.bbs.waffle
       alt.cult-movies
       alt.galactic-guide
       alt.sport.bowling
       aus.*
       !aus.ai
       !aus.religion
       !aus.radio
       !aus.stats.s
       ...

       Normally  this file should only be changed by <u>gup</u>, but assuming you cater for locking, there is no reason
       why some other process cannot change it too. Whenever <u>gup</u> has to apply changes, it renames this  file  to
       ``groups.old'' prior to re-writing the ``groups'' file. This gives you some measure of recovery.

</pre><h4><b>EXCLUSIONS</b></h4><pre>
       For  whatever  reason, you may wish to exclude particular groups from a site's selection list. You can do
       this by creating the file ``exclude'' in the site's directory. This file contains newsgroup patterns, one
       per line, that are used to filter the ``active'' file when verifying group patterns. The effect  of  this
       is that <u>gup</u> believes that such groups do not really exist, therefore a site cannot possibly include them.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       All error conditions are record in the log file and possibly the resultant mail - depending on the nature
       of  the  error.  A  particular  problem  that  is  hard  to  detect is when the .forward file invokes <u>gup</u>
       incorrectly. If <u>gup</u> is not invoked due to such an error, then notification depends on  the  mailer.  This
       should only be a problem to watch out for when first installing <u>gup</u>.

</pre><h4><b>RESTRICTIONS</b></h4><pre>
       <u>Gup</u>  does  not  understand  ``Distribution patterns''. Any such patterns must be generated and maintained
       independently of <u>gup</u>.

</pre><h4><b>BUGS</b></h4><pre>
       <u>Gup</u> does not know when the <u><a href="../man1/popen.1.html">popen</a></u>(1) fails when <u>Mail_command</u> is invoked. This is a limitation of <u><a href="../man1/popen.1.html">popen</a></u>(1).
       If the <u>Mail_command</u> is bogus, then the error will be pretty obscure and dependent on your mailer.  stderr
       is  redirected to the logfile prior to invoking the <u>Mail_Command</u> so hopefully <a href="file:/bin/sh">/bin/sh</a> (used by popen) has
       generated an appropriate message.

</pre><h4><b>HISTORY</b></h4><pre>
       <u>Gup</u> Version 0.3, dated 26 July, 1993.

       Initially created by Mark Delany &lt;<a href="mailto:markd@bushwire.apana.org.au">markd@bushwire.apana.org.au</a>&gt;.

       Numerous enhancements and optimizations by Andrew Herbert &lt;<a href="mailto:andrew@werple.apana.org.au">andrew@werple.apana.org.au</a>&gt;.

       Currently maintained by Marco d'Itri &lt;<a href="mailto:md@linux.it">md@linux.it</a>&gt;.

       The wildmat.c is taken directly from the INN sources, written by Rich Salz &lt;<a href="mailto:rsalz@osf.org">rsalz@osf.org</a>&gt;.

       The rfc822.[ch] parsing routines are taken directly from the newsgates sources, also written by Rich Salz
       &lt;<a href="mailto:rsalz@osf.org">rsalz@osf.org</a>&gt;.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man5/newsfeeds.5.html">newsfeeds</a></u>(5), <u><a href="../man8/sendmail.8.html">sendmail</a></u>(8)

                                                  25 July 1993                                            <u><a href="../man1/GUP.1.html">GUP</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>