<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbdkit-partitioning-plugin - create virtual disk from partitions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nbdkit">nbdkit_1.42.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nbdkit-partitioning-plugin - create virtual disk from partitions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        nbdkit partitioning [file=]part1 [[file=]part2 [file=]part3 ...]
                            [partition-type=mbr|gpt]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       "nbdkit-partitioning-plugin" is a plugin for <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1) which creates a partitioned virtual drive from a
       list of one or more files each containing single partitions.  The plugin concatenates the files together
       and generates a virtual partition table so that NBD clients see a single partitioned disk.

       If you just want to concatenate files together (without adding a partition table) use
       <b><a href="../man1/nbdkit-split-plugin.1.html">nbdkit-split-plugin</a></b>(1).  If you want to select a single partition from an existing disk, use
       <b><a href="../man1/nbdkit-partition-filter.1.html">nbdkit-partition-filter</a></b>(1).  If you want to create a complete disk with a filesystem, look at
       <b><a href="../man1/nbdkit-floppy-plugin.1.html">nbdkit-floppy-plugin</a></b>(1), <b><a href="../man1/nbdkit-iso-plugin.1.html">nbdkit-iso-plugin</a></b>(1) or <b><a href="../man1/nbdkit-linuxdisk-plugin.1.html">nbdkit-linuxdisk-plugin</a></b>(1).

       The plugin supports read/write access.  To limit clients to read-only access use the <u>-r</u> flag.

   <b>Partition</b> <b>table</b> <b>type</b>
       Using the "partition-type" parameter you can choose either an MBR or a GPT partition table.  If this
       parameter is <u>not</u> present then:

       number of files &gt; 4
           ⇒ GPT

       else, total file size is larger than supported by MBR (approx. 2 TB)
           ⇒ GPT

       otherwise
           ⇒ MBR (for maximum compatibility with clients)

   <b>Type</b> <b>of</b> <b>each</b> <b>partition</b>
       The type of each partition is controlled by a partition type byte (for MBR) or a partition type GUID (for
       GPT).   This can be set using the "mbr-id" or "type-guid" parameters respectively and affects the type of
       all following files.

   <b>Padding</b> <b>and</b> <b>alignment</b>
       Partition sizes are automatically rounded up to a multiple of the 512 byte sector size.

       Padding may be added between partitions to provide  the  best  alignment.   This  is  controlled  by  the
       "alignment" parameter, which affects the alignment of all following files.

   <b>Writing</b> <b>to</b> <b>the</b> <b>virtual</b> <b>disk</b>
       NBD  clients  may  read  and write freely to partitions.  Writes are propagated through to the underlying
       files.

       NBD clients may read from the virtual partition table, and padding  areas  of  the  virtual  disk.   When
       reading from padding areas, clients will see zeroes.

       NBD clients will get an I/O error if they try to change the virtual partition table or padding areas.

</pre><h4><b>EXAMPLES</b></h4><pre>
       From  a  bare  filesystem  stored in a file, create a virtual disk with a single partition containing the
       filesystem:

        nbdkit partitioning ext4fs.img

       Create a virtual disk containing boot, swap and root partitions:

        nbdkit partitioning \
                   boot.img \
                   mbr-id=0x82 swap.img mbr-id=default \
                   root.img

       This will not be bootable since the virtual partition table does  not  contain  a  boot  sector  or  boot
       loader.

       Notice  that  the swap partition is bracketed by "mbr-id=0x82" to set the MBR partition type byte to 0x82
       (Linux swap) for the swap partition, followed by "mbr-id=default" to set the MBR partition type byte back
       to the default (0x83, Linux filesystem) for the remaining partition.

       If <u>file.raw</u> has a size which is a multiple of 512 bytes then this is a  no-op  because  the  partitioning
       plugin adds a partition table which is then removed by <b><a href="../man1/nbdkit-partition-filter.1.html">nbdkit-partition-filter</a></b>(1):

        nbdkit --filter=partition partitioning file.raw partition=1

</pre><h4><b>PARAMETERS</b></h4><pre>
       [<b>file=</b>]FILENAME
           One or more files containing partition data.

           This parameter is required.

           "file=" is a magic config key and may be omitted in most cases.  See "Magic parameters" in <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1).

       <b>partition-type=mbr</b>
           Add an MBR (DOS-style) partition table.  The MBR format is maximally compatible with all clients.

           If  there are &gt; 4 partitions then the first three files are mapped to primary partitions, an extended
           partition (https://en.wikipedia.org/wiki/Extended_boot_record) is created as  partition  4,  and  the
           files starting from the 4th will appear as partition 5 and upwards.

       <b>partition-type=gpt</b>
           Add  a  GPT  partition  table.  Note that as well as the virtual primary partition table added at the
           beginning of the disk, a virtual secondary partition table is added at the end, as required  by  GPT.
           Also  this  adds  a  "protective  MBR"  as  defined  by the UEFI spec so that old clients which don't
           understand GPT will ignore the partitions.

       <b>alignment=</b>N
           Set the alignment of all following files to "N" bytes.  The default alignment is 1M (2048 sectors).

       <b>mbr-id=</b>0xN
           Set the MBR type byte of all following  files  to  "0xN".   Type  bytes  are  normally  specified  in
           hexadecimal, and you must use the "0x" prefix to indicate this.

       <b>mbr-id=default</b>
           Set the MBR type byte back to the default, 0x83 which indicates a Linux filesystem.

       <b>type-guid=</b>GUID
           Set the GPT partition type GUID of all following files to "GUID".

       <b>type-guid=default</b>
           Set  the  GPT  partition  type GUID back to the default, "0FC63DAF-8483-4772-8E79-3D69D8477DE4" which
           indicates a Linux filesystem.

</pre><h4><b>LIMITS</b></h4><pre>
       Although this plugin can create GPT partition tables containing more than 128 GPT  partitions  (in  fact,
       unlimited numbers of partitions), some clients will not be able to handle this.

       Zero length partitions are not allowed and will cause nbdkit to exit with an error when it starts up.

       The sector size is fixed at 512 bytes.

</pre><h4><b>FILES</b></h4><pre>
       <u>$plugindir/nbdkit-partitioning-plugin.so</u>
           The plugin.

           Use "nbdkit --dump-config" to find the location of $plugindir.

</pre><h4><b>VERSION</b></h4><pre>
       "nbdkit-partitioning-plugin" first appeared in nbdkit 1.8.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/nbdkit.1.html">nbdkit</a></b>(1),          <b><a href="../man1/nbdkit-file-plugin.1.html">nbdkit-file-plugin</a></b>(1),         <b><a href="../man1/nbdkit-floppy-plugin.1.html">nbdkit-floppy-plugin</a></b>(1),         <b><a href="../man1/nbdkit-iso-plugin.1.html">nbdkit-iso-plugin</a></b>(1),
       <b><a href="../man1/nbdkit-linuxdisk-plugin.1.html">nbdkit-linuxdisk-plugin</a></b>(1), <b><a href="../man1/nbdkit-partition-filter.1.html">nbdkit-partition-filter</a></b>(1), <b><a href="../man1/nbdkit-split-plugin.1.html">nbdkit-split-plugin</a></b>(1), <b><a href="../man3/nbdkit-plugin.3.html">nbdkit-plugin</a></b>(3).

</pre><h4><b>AUTHORS</b></h4><pre>
       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       Redistribution and use in source and binary forms, with or without modification, are  permitted  provided
       that the following conditions are met:

       •   Redistributions  of  source  code must retain the above copyright notice, this list of conditions and
           the following disclaimer.

       •   Redistributions in binary form must reproduce the above copyright notice, this list of conditions and
           the following disclaimer in the documentation and/or other materials provided with the distribution.

       •   Neither the name of Red Hat nor the names of its contributors may  be  used  to  endorse  or  promote
           products derived from this software without specific prior written permission.

       THIS  SOFTWARE  IS  PROVIDED BY RED HAT AND CONTRIBUTORS ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
       INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND  FITNESS  FOR  A  PARTICULAR
       PURPOSE  ARE  DISCLAIMED.  IN  NO EVENT SHALL RED HAT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
       INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,  PROCUREMENT  OF
       SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
       ON  ANY  THEORY  OF  LIABILITY,  WHETHER  IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
       OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
       DAMAGE.

nbdkit-1.42.2                                      2025-04-02                      <u><a href="../man1/nbdkit-partitioning-plugin.1.html">nbdkit-partitioning-plugin</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>