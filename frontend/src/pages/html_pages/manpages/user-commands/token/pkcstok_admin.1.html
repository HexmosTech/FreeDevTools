<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pkcstok_admin - utility to administrate token directories of the Opencryptoki token repository.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/opencryptoki">opencryptoki_3.24.0+git20250128.0462717+dfsg-0ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pkcstok_admin - utility to administrate token directories of the Opencryptoki token repository.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pkcstok_admin</b> <u>command</u> [<b>OPTIONS</b>]

       <b>pkcstok_admin</b> <b>--help</b>|<b>-h</b>
       <b>pkcstok_admin</b> <b>--version</b>|<b>-v</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>pkcstok_admin</b>  utility  can  be  used  to  administrate  token directories of the Opencryptoki token
       repository with proper permissions and owners.  By default token directories  are  owned  by  the  <b>pkcs11</b>
       group,  and every user that is a member of the <b>pkcs11</b> group has access to the token and its token objects
       (i.e. keys, certificates, etc.).

       A token directory can alternatively be owned by a token specific group.   Specify  the  group  name  with
       keyword  <b>usergroup</b>  in  the  slot  definition  in  the  <b>opencryptoki.conf</b>  configuration  file located in
       <b>/etc/opencryptoki/</b>.  With that, only users that are members of the configured token specific  group  have
       access  to  the token and its token objects. Users that are only members of the <b>pkcs11</b> group, but are not
       also members of the token specific group do not have access to the token. Users  of  the  token  specific
       group must still also be members of the <b>pkcs11</b> group to be able to use Opencryptoki.

       Token  specific  files  are  usually  stored  in  <b>/var/lib/opencryptoki/&lt;token-name&gt;/</b>. Additionally token
       specific lock files are stored in <b>/var/lock/opencryptoki/&lt;token-name&gt;/</b>.  Furthermore,  a  token  specific
       POSIX shared memory segment exists under <b><a href="file:/dev/shm/">/dev/shm/</a></b>. All files and directories within these token specific
       directories  as well as the shared memory segment are owned by the token specific group, or by the <b>pkcs11</b>
       group if no token specific group has been configured.

       The <b>pkcstok_admin</b> utility must be run as <b>root</b>, and the <b>pkcsslotd</b> must  be  stopped  before  running  this
       utility.

       <b>Note:</b>  Do  not  use  the  <b>pkcstok_admin</b>  utility on a <b>TPM</b> <b>token</b>. The <b>TPM</b> <b>token</b> uses a different directory
       structure, and stores token objects on a per user basis. The <b>pkcstok_admin</b>  utility  is  not  capable  of
       setting  the  owners  correctly  on such a directory structure. Furthermore, the <b>TPM</b> <b>token</b> is deprecated,
       because it supports only TPM version 1.2.  It does not work with TPM version 2.0.

</pre><h4><b>COMMANDS</b></h4><pre>
       The <b>pkcstok_admin</b> tool supports various commands to administrate token directories.

   <b>Creating</b> <b>a</b> <b>new</b> <b>token</b> <b>and</b> <b>its</b> <b>directories</b>
       <b>pkcstok_admin</b> <b>create</b> <b>--token</b>|<b>-t</b> <u>TOKNAME</u> [<b>--group</b>|<b>-g</b> <u>GROUP</u>] [<b>--force</b>] [<b>--verbose</b>]

       Use the <b>create</b> command to create a new token and its directories.

       Use the <b>--token</b>|<b>-t</b> <u>TOKNAME</u> option to specify the name of the token to create. The token name must also be
       specified  in  the  slot  definition   in   the   <b>opencryptoki.conf</b>   configuration   file   located   in
       <b>/etc/opencryptoki/</b> with keyword <b>tokname</b>.

       Use  the  [<b>--group</b>|<b>-g</b>  <u>GROUP</u>]  option to specify the token specific user group used as group owner of the
       token directories. If no group is specified, the token directories will be owned by the <b>pkcs11</b> group.  If
       a  group  is  specified,  then  it must also be specified in the slot definition in the <b>opencryptoki.conf</b>
       configuration file located in <b>/etc/opencryptoki/</b> with keyword <b>usergroup</b>.

       The <b>pkcstok_admin</b> tool prompts for a confirmation before the token directories are created. To  omit  the
       prompt, specify the <b>--force</b> option. Use this option with care!

       Specify the <b>--verbose</b> option to see more detailed messages about the actions the tool is performing.

   <b>Changing</b> <b>the</b> <b>owner</b> <b>of</b> <b>an</b> <b>existing</b> <b>token</b> <b>and</b> <b>its</b> <b>directories</b>
       <b>pkcstok_admin</b> <b>chown</b> <b>--token</b>|<b>-t</b> <u>TOKNAME</u> [<b>--group</b>|<b>-g</b> <u>GROUP</u>] [<b>--force</b>] [<b>--verbose</b>]

       Use the <b>chown</b> command to change the owner of an existing token and its directories.

       Use  the  <b>--token</b>|<b>-t</b>  <u>TOKNAME</u>  option to specify the name of the token to change the owner for. The token
       name is usually specified in the slot definition in the <b>opencryptoki.conf</b> configuration file  located  in
       <b>/etc/opencryptoki/</b> with keyword <b>tokname</b>.  If the slot definition does not specify a <b>tokname</b> keyword, then
       a  default  token  name  is  used, dependent on the token model. The <b>ICA</b> <b>token</b> uses <b>lite</b> as default token
       name, the <b>CCA</b> <b>token</b> uses <b>ccatok</b>, the <b>Soft</b> <b>token</b> uses <b>swtok</b>, the <b>EP11</b> <b>token</b> uses <b>ep11tok</b>, the  <b>ICSF</b>  <b>token</b>
       uses <b>icsf</b>, and the <b>TPM</b> <b>token</b> (deprecated) uses <b>tpm</b>.

       Use  the  [<b>--group</b>|<b>-g</b> <u>GROUP</u>] option to specify the token specific user group to set as group owner of the
       token directories. If no group is specified, the token directories will be changed to  be  owned  by  the
       <b>pkcs11</b>  group.  If  a  group  is  specified, then it must also be specified in the slot definition in the
       <b>opencryptoki.conf</b> configuration file located in <b>/etc/opencryptoki/</b> with keyword <b>usergroup</b>. If no group is
       specified, then remove the <b>usergroup</b> keyword from the slot definition, or change its value to <b>pkcs11</b>.

       The <b>pkcstok_admin</b> tool prompts for a confirmation before the owner of the token directories  is  changed.
       To omit the prompt, specify the <b>--force</b> option. Use this option with care!

       Specify the <b>--verbose</b> option to see more detailed messages about the actions the tool is performing.

   <b>Removing</b> <b>an</b> <b>existing</b> <b>token</b> <b>and</b> <b>its</b> <b>directories</b>
       <b>pkcstok_admin</b> <b>remove</b> <b>--token</b>|<b>-t</b> <u>TOKNAME</u> [<b>--force</b>] [<b>--verbose</b>]

       Use  the  <b>remove</b>  command  to  remove an existing token and its directories.  This also removes all token
       objects of that token. Use with care!

       Use the <b>--token</b>|<b>-t</b> <u>TOKNAME</u> option to specify the name of the token to remove. You must  also  remove  the
       corresponding    slot   definition   from   the   <b>opencryptoki.conf</b>   configuration   file   located   in
       <b>/etc/opencryptoki/</b>. The token name is usually specified in the slot definition in  the  <b>opencryptoki.conf</b>
       configuration  file. If the slot definition does not specify a <b>tokname</b> keyword, then a default token name
       is used, dependent on the token model. The <b>ICA</b> <b>token</b> uses <b>lite</b> as default token name, the <b>CCA</b> <b>token</b>  uses
       <b>ccatok</b>,  the  <b>Soft</b>  <b>token</b>  uses <b>swtok</b>, the <b>EP11</b> <b>token</b> uses <b>ep11tok</b>, the <b>ICSF</b> <b>token</b> uses <b>icsf</b>, and the <b>TPM</b>
       <b>token</b> (deprecated) uses <b>tpm</b>.

       The <b>pkcstok_admin</b> tool prompts for a confirmation before the token directories are removed. To  omit  the
       prompt, specify the <b>--force</b> option. Use this option with care!

       Specify the <b>--verbose</b> option to see more detailed messages about the actions the tool is performing.

   <b>Resetting</b> <b>a</b> <b>token</b> <b>to</b> <b>its</b> <b>initial</b> <b>state</b>
       <b>pkcstok_admin</b> <b>reset</b> <b>--token</b>|<b>-t</b> <u>TOKNAME</u> [<b>--force</b>] [<b>--verbose</b>]

       Use  the  <b>reset</b> command to reset a token to its initial state.  This also resets all PINs and removes all
       token objects. Use with care!

       Resetting a token can be required if you forgot the SO pin, or the SO pin got  locked  due  to  too  many
       login attempts using a wrong SO PIN.

       Use  the  <b>--token</b>|<b>-t</b>  <u>TOKNAME</u> option to specify the name of the token to reset. The token name is usually
       specified  in  the  slot  definition   in   the   <b>opencryptoki.conf</b>   configuration   file   located   in
       <b>/etc/opencryptoki/</b> with keyword <b>tokname</b>.  If the slot definition does not specify a <b>tokname</b> keyword, then
       a  default  token  name  is  used, dependent on the token model. The <b>ICA</b> <b>token</b> uses <b>lite</b> as default token
       name, the <b>CCA</b> <b>token</b> uses <b>ccatok</b>, the <b>Soft</b> <b>token</b> uses <b>swtok</b>, the <b>EP11</b> <b>token</b> uses <b>ep11tok</b>, the  <b>ICSF</b>  <b>token</b>
       uses <b>icsf</b>, and the <b>TPM</b> <b>token</b> (deprecated) uses <b>tpm</b>.

       The  <b>pkcstok_admin</b>  tool  prompts  for  a  confirmation before the token is resetted. To omit the prompt,
       specify the <b>--force</b> option. Use this option with care!

       Specify the <b>--verbose</b> option to see more detailed messages about the actions the tool is performing.

       After resetting a token, it must be initialized freshly using <b>pkcsconf</b>  <b>-I</b>,  setting  the  SO  pin  using
       <b>pkcsconf</b> <b>-P</b> and then initializing the USER pin using <b>pkcsconf</b> <b>-uP.</b>

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--token</b>|<b>-t</b> <u>TOKNAME</u>
               Specifies  the name of the token to operate on. The token name must also be specified in the slot
               definition in the <b>opencryptoki.conf</b> configuration file located in <b>/etc/opencryptoki/</b> with keyword
               <b>tokname</b>.  If the slot definition does not specify a <b>tokname</b> keyword, then a default token name is
               used, dependent on the token model. The <b>ICA</b> <b>token</b> uses <b>lite</b> as default token name, the <b>CCA</b>  <b>token</b>
               uses  <b>ccatok</b>,  the  <b>Soft</b> <b>token</b> uses <b>swtok</b>, the <b>EP11</b> <b>token</b> uses <b>ep11tok</b>, the <b>ICSF</b> <b>token</b> uses <b>icsf</b>,
               and the <b>TPM</b> <b>token</b> (deprecated) uses <b>tpm</b>.

       <b>--group</b>|<b>-g</b> <u>GROUP</u>
               Specifies the token specific user group used as group owner of the  token  directories.  If  this
               option  is  omitted,  the  token  directories  will  be  owned by the <b>pkcs11</b> group. If a group is
               specified, then it must also be  specified  in  the  slot  definition  in  the  <b>opencryptoki.conf</b>
               configuration file located in <b>/etc/opencryptoki/</b> with keyword <b>usergroup</b>.

       <b>--force</b>|<b>-f</b>
               The  <b>pkcstok_admin</b>  tool  prompts for a confirmation before the token directories are created. To
               omit the prompt, specify this option. Use this with care!

       <b>--verbose</b>|<b>-V</b>
               Turn on verbose mode to see more detailed messages about the actions the tool is performing.

       <b>--help</b>|<b>-h</b>
               Prints help for the usage of the <b>pkcstok_admin</b> tool and then exits.

       <b>--version</b>|<b>-v</b>
               Prints the version of the <b>pkcstok_admin</b> tool and then exits.

</pre><h4><b>FILES</b></h4><pre>
   <b>/var/lib/opencryptoki/&lt;token-name&gt;/</b>
       Contains the token specific data, like the token's master key encrypted with the SO and USER PINs  (<b>MK_SO</b>
       and <b>MK_USER</b>), as well as the non volatile token state data (<b>NVTOK.DAT</b>). Subdirectory <b>TOK_OBJ</b> contains the
       token objects and an index file (<b>OBJ.IDX</b>).

   <b>/var/lock/opencryptoki/&lt;token-name&gt;/</b>
       Contains a token specific lock file (<b>LCK..&lt;tokname&gt;</b>) that is used to synchronize access to the token data
       across multiple processes.

   <b>Token</b> <b>specific</b> <b>POSIX</b> <b>shared</b> <b>memory</b> <b>segment</b> <b>under</b> <b><a href="file:/dev/shm/">/dev/shm/</a></b>
       Contains  token  specific  shared state data for tracking updates to token objects done by processes. Its
       name is derived from the token specific directory under <b>/var/lib/opencryptoki/</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/opencryptoki.conf.5.html">opencryptoki.conf</a></b>(5).

@PACKAGE_VERSION@                                   July 2024                                   <u><a href="../man1/pkcstok_admin.1.html">pkcstok_admin</a></u>(1)
</pre>
 </div>
</div></section>
</div>
</body>
</html>