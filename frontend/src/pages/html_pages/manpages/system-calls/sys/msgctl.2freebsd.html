<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>msgctl — message control operations</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       msgctl — message control operations

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C Library (libc, -lc)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/types.h&gt;</b>
       <b>#include</b> <b>&lt;sys/ipc.h&gt;</b>
       <b>#include</b> <b>&lt;sys/msg.h&gt;</b>

       <u>int</u>
       <b>msgctl</b>(<u>int</u> <u>msqid</u>, <u>int</u> <u>cmd</u>, <u>struct</u> <u>msqid_ds</u> <u>*buf</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>msgctl</b>() system call performs some control operations on the message queue specified by <u>msqid</u>.

       Each message queue has a data structure associated with it, parts of which may be altered by <b>msgctl</b>() and
       parts  of  which  determine  the  actions  of <b>msgctl</b>().  The data structure is defined in &lt;<u>sys/msg.h</u>&gt; and
       contains (amongst others) the following members:

       struct msqid_ds {
               struct  ipc_perm msg_perm;      /* msg queue permission bits */
               msglen_t msg_cbytes;    /* number of bytes in use on the queue */
               msgqnum_t msg_qnum;     /* number of msgs in the queue */
               msglen_t msg_qbytes;    /* max # of bytes on the queue */
               pid_t   msg_lspid;      /* pid of last msgsnd() */
               pid_t   msg_lrpid;      /* pid of last msgrcv() */
               time_t  msg_stime;      /* time of last msgsnd() */
               time_t  msg_rtime;      /* time of last msgrcv() */
               time_t  msg_ctime;      /* time of last msgctl() */
       };

       The <u>ipc_perm</u> structure used inside the <u>msqid_ds</u> structure is defined in &lt;<u>sys/ipc.h</u>&gt; and looks like this:

       struct ipc_perm {
               uid_t           cuid;   /* creator user id */
               gid_t           cgid;   /* creator group id */
               uid_t           uid;    /* user id */
               gid_t           gid;    /* group id */
               mode_t          mode;   /* r/w permission */
               unsigned short  seq;    /* sequence # (to generate unique ipcid) */
               key_t           key;    /* user specified msg/sem/shm key */
       };

       The operation to be performed by <b>msgctl</b>() is specified in <u>cmd</u> and is one of:

       IPC_STAT   Gather information about the message queue and place it in the structure pointed to by <u>buf</u>.

       IPC_SET    Set the value of the <u>msg_perm.uid</u>, <u>msg_perm.gid</u>, <u>msg_perm.mode</u> and <u>msg_qbytes</u>  fields  in  the
                  structure  associated  with  <u>msqid</u>.  The values are taken from the corresponding fields in the
                  structure pointed to by <u>buf</u>.  This operation can only be executed  by  the  super-user,  or  a
                  process  that  has  an  effective user id equal to either <u>msg_perm.cuid</u> or <u>msg_perm.uid</u> in the
                  data structure associated with the message  queue.   The  value  of  <u>msg_qbytes</u>  can  only  be
                  increased  by the super-user.  Values for <u>msg_qbytes</u> that exceed the system limit (MSGMNB from
                  &lt;<u>sys/msg.h</u>&gt;) are silently truncated to that limit.

       IPC_RMID   Remove the message queue specified by <u>msqid</u> and destroy the data associated with it.  Only the
                  super-user or a process with an effective uid  equal  to  the  <u>msg_perm.cuid</u>  or  <u>msg_perm.uid</u>
                  values in the data structure associated with the queue can do this.

       The  permission  to  read from or write to a message queue (see <u><a href="../man2/msgsnd.2.html">msgsnd</a></u>(2) and <u><a href="../man2/msgrcv.2.html">msgrcv</a></u>(2)) is determined by
       the <u>msg_perm.mode</u> field in the same way as is done with files (see <u><a href="../man2/chmod.2.html">chmod</a></u>(2)), but the effective  uid  can
       match  either  the  <u>msg_perm.cuid</u> field or the <u>msg_perm.uid</u> field, and the effective gid can match either
       <u>msg_perm.cgid</u> or <u>msg_perm.gid</u>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The <b>msgctl</b>() function returns the value 0 if successful; otherwise the  value  -1  is  returned  and  the
       global variable <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       The <b>msgctl</b>() function will fail if:

       [EPERM]            The <u>cmd</u> argument is equal to IPC_SET or IPC_RMID and the caller is not the super-user,
                          nor  does  the  effective uid match either the <u>msg_perm.uid</u> or <u>msg_perm.cuid</u> fields of
                          the data structure associated with the message queue.

                          An attempt is made to increase the value of <u>msg_qbytes</u> through IPC_SET but the  caller
                          is not the super-user.

       [EACCES]           The command is IPC_STAT and the caller has no read permission for this message queue.

       [EINVAL]           The <u>msqid</u> argument is not a valid message queue identifier.

                          <u>cmd</u> is not a valid command.

       [EFAULT]           The <u>buf</u> argument specifies an invalid address.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/msgget.2.html">msgget</a></u>(2), <u><a href="../man2/msgrcv.2.html">msgrcv</a></u>(2), <u><a href="../man2/msgsnd.2.html">msgsnd</a></u>(2)

</pre><h4><b>HISTORY</b></h4><pre>
       Message queues appeared in the first release of AT&amp;T System V UNIX.

Debian                                            July 9, 2020                                         <u><a href="../man2/MSGCTL.2.html">MSGCTL</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>