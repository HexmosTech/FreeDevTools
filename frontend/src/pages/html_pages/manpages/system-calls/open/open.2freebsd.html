<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>open, openat — open or create a file for reading, writing or executing</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       open, openat — open or create a file for reading, writing or executing

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C Library (libc, -lc)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/fcntl.h">fcntl.h</a>&gt;</b>

       <u>int</u>
       <b>open</b>(<u>const</u> <u>char</u> <u>*path</u>, <u>int</u> <u>flags</u>, <u>...</u>);

       <u>int</u>
       <b>openat</b>(<u>int</u> <u>fd</u>, <u>const</u> <u>char</u> <u>*path</u>, <u>int</u> <u>flags</u>, <u>...</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  file name specified by <u>path</u> is opened for either execution or reading and/or writing as specified by
       the argument <u>flags</u> and the file descriptor returned to the  calling  process.   The  <u>flags</u>  argument  may
       indicate  the  file is to be created if it does not exist (by specifying the O_CREAT flag).  In this case
       <b>open</b>() and <b>openat</b>() require an additional argument <u>mode_t</u> <u>mode</u>, and the file is created with mode <u>mode</u> as
       described in <u><a href="../man2/chmod.2.html">chmod</a></u>(2) and modified by the process' umask value (see <u><a href="../man2/umask.2.html">umask</a></u>(2)).

       The <b>openat</b>() function is equivalent to the <b>open</b>() function except in the case where the <u>path</u> specifies  a
       relative  path.   In  this  case the file to be opened is determined relative to the directory associated
       with the file descriptor <u>fd</u> instead of the  current  working  directory.   The  <u>flag</u>  parameter  and  the
       optional  fourth  parameter  correspond  exactly  to the parameters of <b>open</b>().  If <b>openat</b>() is passed the
       special value AT_FDCWD in the <u>fd</u> parameter, the current working directory is used  and  the  behavior  is
       identical to a call to <b>open</b>().

       In  <u><a href="../man4/capsicum.4.html">capsicum</a></u>(4) capability mode, <b>open</b>() is not permitted.  The <u>path</u> argument to <b>openat</b>() must be strictly
       relative to a file descriptor <u>fd</u>, as defined in <u>sys/kern/vfs_lookup.c</u>.  <u>path</u> must not be an absolute path
       and must not contain ".." components.  Additionally, no symbolic link in <u>path</u> may contain ".." components
       either.  <u>fd</u> must not be AT_FDCWD.

       The flags specified are formed by <u>or</u>'ing the following values

             O_RDONLY        open for reading only
             O_WRONLY        open for writing only
             O_RDWR          open for reading and writing
             O_EXEC          open for execute only
             O_SEARCH        open for search only, an alias for O_EXEC
             O_NONBLOCK      do not block on open
             O_APPEND        append on each write
             O_CREAT         create file if it does not exist
             O_TRUNC         truncate size to 0
             O_EXCL          error if create and file exists
             O_SHLOCK        atomically obtain a shared lock
             O_EXLOCK        atomically obtain an exclusive lock
             O_DIRECT        eliminate or reduce cache effects
             O_FSYNC         synchronous writes
             O_SYNC          synchronous writes
             O_NOFOLLOW      do not follow symlinks
             O_NOCTTY        ignored
             O_TTY_INIT      ignored
             O_DIRECTORY     error if file is not a directory
             O_CLOEXEC       set FD_CLOEXEC upon open
             O_VERIFY        verify the contents of the file

       Opening a file with O_APPEND set causes each write on the file to be appended to the end.  If O_TRUNC  is
       specified  and  the file exists, the file is truncated to zero length.  If O_EXCL is set with O_CREAT and
       the file already exists, <b>open</b>() returns an error.  This may be  used  to  implement  a  simple  exclusive
       access  locking  mechanism.   If O_EXCL is set and the last component of the pathname is a symbolic link,
       <b>open</b>() will fail even if the symbolic link points to a non-existent name.   If  the  O_NONBLOCK  flag  is
       specified  and  the  <b>open</b>()  system call would result in the process being blocked for some reason (e.g.,
       waiting for carrier on a dialup line), <b>open</b>()  returns  immediately.   The  descriptor  remains  in  non-
       blocking mode for subsequent operations.

       If O_FSYNC is used in the mask, all writes will immediately and synchronously be written to disk.

       O_SYNC is a synonym for O_FSYNC required by POSIX.

       If O_NOFOLLOW is used in the mask and the target file passed to <b>open</b>() is a symbolic link then the <b>open</b>()
       will fail.

       When  opening  a  file,  a  lock with <u><a href="../man2/flock.2.html">flock</a></u>(2) semantics can be obtained by setting O_SHLOCK for a shared
       lock, or O_EXLOCK for an exclusive lock.  If creating a file with O_CREAT, the request for the lock  will
       never fail (provided that the underlying file system supports locking).

       O_DIRECT  may be used to minimize or eliminate the cache effects of reading and writing.  The system will
       attempt to avoid caching the data you read or write.  If it  cannot  avoid  caching  the  data,  it  will
       minimize  the  impact  the data has on the cache.  Use of this flag can drastically reduce performance if
       not used with care.

       O_NOCTTY may be used to ensure the OS does not assign this file as the controlling terminal when it opens
       a tty device.  This is the default on FreeBSD, but is present for POSIX compatibility.  The <b>open</b>() system
       call will not assign controlling terminals on FreeBSD.

       O_TTY_INIT may be used to ensure the OS restores the terminal attributes when initially  opening  a  TTY.
       This  is the default on FreeBSD, but is present for POSIX compatibility.  The initial call to <b>open</b>() on a
       TTY will always restore default terminal attributes on FreeBSD.

       O_DIRECTORY may be used to ensure the resulting file descriptor refers to a directory.  This flag can  be
       used  to  prevent  applications with elevated privileges from opening files which are even unsafe to open
       with O_RDONLY, such as device nodes.

       O_CLOEXEC may be used to set FD_CLOEXEC flag for the newly returned file descriptor.

       O_VERIFY may be used to indicate to the kernel that the contents of the file should  be  verified  before
       allowing the open to proceed.  The details of what “verified” means is implementation specific.  The run-
       time linker (rtld) uses this flag to ensure shared objects have been verified before operating on them.

       When  <u>fd</u>  is  opened with O_SEARCH, execute permissions are checked at open time.  The <u>fd</u> may not be used
       for any read operations like <u><a href="../man2/getdirentries.2.html">getdirentries</a></u>(2).  The primary use for this descriptor will be as the lookup
       descriptor for the <b>*at</b>() family of functions.

       If successful, <b>open</b>() returns a non-negative integer,  termed  a  file  descriptor.   It  returns  -1  on
       failure.   The  file pointer used to mark the current position within the file is set to the beginning of
       the file.

       If a sleeping open of a device node from <u><a href="../man5/devfs.5.html">devfs</a></u>(5) is interrupted by a signal, the call always fails  with
       EINTR,  even  if the SA_RESTART flag is set for the signal.  A sleeping open of a fifo (see <u><a href="../man2/mkfifo.2.html">mkfifo</a></u>(2)) is
       restarted as normal.

       When a new file is created it is given the group of the directory which contains it.

       Unless O_CLOEXEC flag was specified, the new descriptor is set to remain  open  across  <u><a href="../man2/execve.2.html">execve</a></u>(2)  system
       calls; see <u><a href="../man2/close.2.html">close</a></u>(2), <u><a href="../man2/fcntl.2.html">fcntl</a></u>(2) and O_CLOEXEC description.

       The  system  imposes  a  limit on the number of file descriptors open simultaneously by one process.  The
       <u><a href="../man2/getdtablesize.2.html">getdtablesize</a></u>(2) system call returns the current system limit.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       If successful, <b>open</b>() and <b>openat</b>() return a non-negative integer, termed a file descriptor.  They  return
       -1 on failure, and set <u>errno</u> to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       The named file is opened unless:

       [ENOTDIR]          A component of the path prefix is not a directory.

       [ENAMETOOLONG]     A  component  of  a  pathname exceeded 255 characters, or an entire path name exceeded
                          1023 characters.

       [ENOENT]           O_CREAT is not set and the named file does not exist.

       [ENOENT]           A component of the path name that must exist does not exist.

       [EACCES]           Search permission is denied for a component of the path prefix.

       [EACCES]           The required permissions (for reading and/or writing) are denied for the given flags.

       [EACCES]           O_TRUNC is specified and write permission is denied.

       [EACCES]           O_CREAT is specified, the file does not exist, and the directory in which it is to  be
                          created does not permit writing.

       [EPERM]            O_CREAT  is specified, the file does not exist, and the directory in which it is to be
                          created has  its  immutable  flag  set,  see  the  <u><a href="../man2/chflags.2.html">chflags</a></u>(2)  manual  page  for  more
                          information.

       [EPERM]            The named file has its immutable flag set and the file is to be modified.

       [EPERM]            The  named  file has its append-only flag set, the file is to be modified, and O_TRUNC
                          is specified or O_APPEND is not specified.

       [ELOOP]            Too many symbolic links were encountered in translating the pathname.

       [EISDIR]           The named file is a directory, and the arguments specify it is to be modified.

       [EISDIR]           The named file is a directory, and the flags specified O_CREAT without O_DIRECTORY.

       [EROFS]            The named file resides on a read-only file system, and the file is to be modified.

       [EROFS]            O_CREAT is specified and the named file would reside on a read-only file system.

       [EMFILE]           The process has already reached its limit for open file descriptors.

       [ENFILE]           The system file table is full.

       [EMLINK]           O_NOFOLLOW was specified and the target is a symbolic link.

       [ENXIO]            The named file is a character special or block special file, and the device associated
                          with this special file does not exist.

       [ENXIO]            O_NONBLOCK is set, the named file is a fifo, O_WRONLY is set, and no process  has  the
                          file open for reading.

       [EINTR]            The <b>open</b>() operation was interrupted by a signal.

       [EOPNOTSUPP]       O_SHLOCK  or  O_EXLOCK  is  specified  but the underlying file system does not support
                          locking.

       [EOPNOTSUPP]       The named file is a special file mounted through a file system that does  not  support
                          access to it (e.g. NFS).

       [EWOULDBLOCK]      O_NONBLOCK and one of O_SHLOCK or O_EXLOCK is specified and the file is locked.

       [ENOSPC]           O_CREAT  is  specified,  the file does not exist, and the directory in which the entry
                          for the new file is being placed cannot be extended because there is no space left  on
                          the file system containing the directory.

       [ENOSPC]           O_CREAT  is  specified,  the  file does not exist, and there are no free inodes on the
                          file system on which the file is being created.

       [EDQUOT]           O_CREAT is specified, the file does not exist, and the directory in  which  the  entry
                          for  the  new file is being placed cannot be extended because the user's quota of disk
                          blocks on the file system containing the directory has been exhausted.

       [EDQUOT]           O_CREAT is specified, the file does not exist, and the user's quota of inodes  on  the
                          file system on which the file is being created has been exhausted.

       [EIO]              An  I/O  error  occurred  while making the directory entry or allocating the inode for
                          O_CREAT.

       [EINTEGRITY]       Corrupted data was detected while reading from the file system.

       [ETXTBSY]          The file is a pure procedure (shared text) file that is being executed and the  <b>open</b>()
                          system call requests write access.

       [EFAULT]           The <u>path</u> argument points outside the process's allocated address space.

       [EEXIST]           O_CREAT and O_EXCL were specified and the file exists.

       [EOPNOTSUPP]       An attempt was made to open a socket (not currently implemented).

       [EINVAL]           An  attempt  was  made  to  open a descriptor with an illegal combination of O_RDONLY,
                          O_WRONLY, or O_RDWR, and O_EXEC or O_SEARCH.

       [EBADF]            The <u>path</u> argument does not specify an absolute path and the  <u>fd</u>  argument  is  neither
                          AT_FDCWD nor a valid file descriptor open for searching.

       [ENOTDIR]          The  <u>path</u>  argument  is  not  an  absolute  path and <u>fd</u> is neither AT_FDCWD nor a file
                          descriptor associated with a directory.

       [ENOTDIR]          O_DIRECTORY is specified and the file is not a directory.

       [ECAPMODE]         AT_FDCWD is specified and the process is in capability mode.

       [ECAPMODE]         <b>open</b>() was called and the process is in capability mode.

       [ENOTCAPABLE]      <u>path</u> is an absolute path or contained a ".." component leading to a directory  outside
                          of the directory hierarchy specified by <u>fd</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/chmod.2.html">chmod</a></u>(2),  <u><a href="../man2/close.2.html">close</a></u>(2),  <u><a href="../man2/dup.2.html">dup</a></u>(2),  <u><a href="../man2/fexecve.2.html">fexecve</a></u>(2),  <u><a href="../man2/fhopen.2.html">fhopen</a></u>(2),  <u><a href="../man2/getdtablesize.2.html">getdtablesize</a></u>(2),  <u><a href="../man2/getfh.2.html">getfh</a></u>(2), <u><a href="../man2/lgetfh.2.html">lgetfh</a></u>(2), <u><a href="../man2/lseek.2.html">lseek</a></u>(2),
       <u><a href="../man2/read.2.html">read</a></u>(2), <u><a href="../man2/umask.2.html">umask</a></u>(2), <u><a href="../man2/write.2.html">write</a></u>(2), <u><a href="../man3/fopen.3.html">fopen</a></u>(3), <u><a href="../man4/capsicum.4.html">capsicum</a></u>(4)

</pre><h4><b>STANDARDS</b></h4><pre>
       These functions are specified by IEEE Std 1003.1-2008 (“POSIX.1”).  FreeBSD sets <u>errno</u> to EMLINK  instead
       of  ELOOP  as specified by POSIX when O_NOFOLLOW is set in flags and the final component of pathname is a
       symbolic link to distinguish it from the case of too many symbolic link traversals in  one  of  its  non-
       final components.

</pre><h4><b>HISTORY</b></h4><pre>
       The  <b>open</b>()  function  appeared  in  Version  1  AT&amp;T  UNIX.   The  <b>openat</b>()  function  was introduced in
       FreeBSD 8.0.

</pre><h4><b>BUGS</b></h4><pre>
       The Open Group Extended API Set 2 specification requires that the test for whether <u>fd</u>  is  searchable  is
       based  on  whether  <u>fd</u>  is  open  for  searching,  not whether the underlying directory currently permits
       searches.  The present implementation of the <u>openat</u> checks the current permissions of directory instead.

Debian                                           March 30, 2020                                          <u><a href="../man2/OPEN.2.html">OPEN</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>