<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cap_ioctls_limit, cap_ioctls_get — manage allowed ioctl commands</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cap_ioctls_limit, cap_ioctls_get — manage allowed ioctl commands

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C Library (libc, -lc)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/capsicum.h&gt;</b>

       <u>int</u>
       <b>cap_ioctls_limit</b>(<u>int</u> <u>fd</u>, <u>const</u> <u>unsigned</u> <u>long</u> <u>*cmds</u>, <u>size_t</u> <u>ncmds</u>);

       <u>ssize_t</u>
       <b>cap_ioctls_get</b>(<u>int</u> <u>fd</u>, <u>unsigned</u> <u>long</u> <u>*cmds</u>, <u>size_t</u> <u>maxcmds</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       If a file descriptor is granted the CAP_IOCTL capability right, the list of allowed <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2) commands can
       be  selectively  reduced (but never expanded) with the <b>cap_ioctls_limit</b>() system call.  The <u>cmds</u> argument
       is an array of <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2) commands and the <u>ncmds</u> argument specifies the number of elements  in  the  array.
       There can be up to <u>256</u> elements in the array.  Including an element that has been previously revoked will
       generate an error.  After a successful call only those listed in the array may be used.

       The  list of allowed ioctl commands for a given file descriptor can be obtained with the <b>cap_ioctls_get</b>()
       system call.  The <u>cmds</u> argument points at memory that can  hold  up  to  <u>maxcmds</u>  values.   The  function
       populates  the  provided buffer with up to <u>maxcmds</u> elements, but always returns the total number of ioctl
       commands allowed for the given file descriptor.  The total number of ioctls commands for the  given  file
       descriptor  can  be  obtained by passing NULL as the <u>cmds</u> argument and <u>0</u> as the <u>maxcmds</u> argument.  If all
       ioctl commands are allowed (CAP_IOCTL capability right  is  assigned  to  the  file  descriptor  and  the
       <b>cap_ioctls_limit</b>()  system  call  was never called for this file descriptor), the <b>cap_ioctls_get</b>() system
       call will return CAP_IOCTLS_ALL and will not modify the buffer pointed to by the <u>cmds</u> argument.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The <b>cap_ioctls_limit</b>() function returns the value 0 if successful; otherwise the value -1 is returned and
       the global variable <u>errno</u> is set to indicate the error.

       The <b>cap_ioctls_get</b>() function, if successful, returns the total number of allowed ioctl commands  or  the
       value  CAP_IOCTLS_ALL  if  all  ioctls commands are allowed.  On failure the value <u>-1</u> is returned and the
       global variable errno is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>cap_ioctls_limit</b>() succeeds unless:

       [EBADF]            The <u>fd</u> argument is not a valid descriptor.

       [EFAULT]           The <u>cmds</u> argument points at an invalid address.

       [EINVAL]           The <u>ncmds</u> argument is greater than <u>256</u>.

       [ENOTCAPABLE]      <u>cmds</u> would expand the list of allowed <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2) commands.

       <b>cap_ioctls_get</b>() succeeds unless:

       [EBADF]            The <u>fd</u> argument is not a valid descriptor.

       [EFAULT]           The <u>cmds</u> argument points at invalid address.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/cap_fcntls_limit.2.html">cap_fcntls_limit</a></u>(2), <u><a href="../man2/cap_rights_limit.2.html">cap_rights_limit</a></u>(2), <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>cap_ioctls_get</b>() and <b>cap_ioctls_limit</b>() system calls first appeared  in  FreeBSD  8.3.   Support  for
       capabilities and capabilities mode was developed as part of the TrustedBSD Project.

</pre><h4><b>AUTHORS</b></h4><pre>
       This  function  was  created  by Pawel Jakub Dawidek &lt;<u><a href="mailto:pawel@dawidek.net">pawel@dawidek.net</a></u>&gt; under sponsorship of the FreeBSD
       Foundation.

Debian                                             May 5, 2020                               <u><a href="../man2/CAP_IOCTLS_LIMIT.2.html">CAP_IOCTLS_LIMIT</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>