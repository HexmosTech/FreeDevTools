<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ioctl_xfs_fsbulkstat - query information for a batch of XFS inodes</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/xfslibs-dev">xfslibs-dev_6.13.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ioctl_xfs_fsbulkstat - query information for a batch of XFS inodes

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;xfs/xfs_fs.h&gt;</b>

       <b>int</b> <b>ioctl(int</b> <u>fd</u><b>,</b> <b>XFS_IOC_FSBULKSTAT,</b> <b>struct</b> <b>xfs_fsop_bulkreq</b> <b>*</b><u>arg</u><b>);</b>
       <b>int</b> <b>ioctl(int</b> <u>fd</u><b>,</b> <b>XFS_IOC_FSBULKSTAT_SINGLE,</b> <b>struct</b> <b>xfs_fsop_bulkreq</b> <b>*</b><u>arg</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Query stat information for a group of XFS inodes.

       NOTE: This ioctl has been superseded.  Please see the <b><a href="../man2/ioctl_xfs_bulkstat.2.html">ioctl_xfs_bulkstat</a></b>(2) manpage for information about
       its replacement.

       These ioctls use <b>struct</b> <b>xfs_fsop_bulkreq</b> to set up a bulk transfer with the kernel:

           struct xfs_fsop_bulkreq {
                __u64             *lastip;
                __s32             count;
                void              *ubuffer;
                __s32             *ocount;
           };

       <u>lastip</u>  points  to  a  value that will receive the number of the "last inode."  This cannot be NULL.  For
       <b>FSBULKSTAT</b>, this should be set to one less than the number of the first inode for which the caller  wants
       information, or zero to start with the first inode in the filesystem.  For <b>FSBULKSTAT_SINGLE</b>, this should
       be  set  to  the  number of the inode for which the caller wants information.  After the call, this value
       will be set to the number of the last inode for which information was supplied.  This field will  not  be
       updated if <u>ocount</u> is NULL.

       <u>count</u>  is  the  number  of  elements in the <b>ubuffer</b> array and therefore the number of inodes for which to
       return stat information.  This value must be set to 1 for <b>FSBULKSTAT_SINGLE</b>.

       <u>ocount</u> points to a value that will receive the number of records returned.  If this value is  NULL,  then
       neither <u>ocount</u> nor <u>lastip</u> will be updated.

       <u>ubuffer</u>  points to a memory buffer into which inode stat information will be copied.  This buffer must be
       an array of <b>struct</b> <b>xfs_bstat</b> which is described below.  The array must have at least <u>count</u> elements.

           struct xfs_bstat {
                __u64             bs_ino;
                __u16             bs_mode;
                __u16             bs_nlink;
                __u32             bs_uid;
                __u32             bs_gid;
                __u32             bs_rdev;
                __s32             bs_blksize;
                __s64             bs_size;
                struct xfs_bstime bs_atime;
                struct xfs_bstime bs_mtime;
                struct xfs_bstime bs_ctime;
                int64_t           bs_blocks;
                __u32             bs_xflags;
                __s32             bs_extsize;
                __s32             bs_extents;
                __u32             bs_gen;
                __u16             bs_projid_lo;
                __u16             bs_forkoff;
                __u16             bs_projid_hi;
                uint16_t          bs_sick;
                uint16_t          bs_checked;
                unsigned char     bs_pad[2];
                __u32             bs_cowextsize;
                __u32             bs_dmevmask;
                __u16             bs_dmstate;
                __u16             bs_aextents;
           };

       The structure members are as follows:

       <u>bs_ino</u> is the inode number for this record.

       <u>bs_mode</u> is the file type and mode.

       <u>bs_nlink</u> is the number of hard links to this inode.

       <u>bs_uid</u> is the user id.

       <u>bs_gid</u> is the group id.

       <u>bs_rdev</u> is the encoded device id if this is a special file.

       <u>bs_blksize</u> is the size of a data block for this file, in units of bytes.

       <u>bs_size</u> is the size of the file, in bytes.

       <u>bs_atime</u> is the last time this file was accessed.

       <u>bs_mtime</u> is the last time the contents of this file were modified.

       <u>bs_ctime</u> is the last time this inode record was modified.

       <u>bs_blocks</u> is the number of filesystem blocks allocated to this file, including metadata.

       <u>bs_xflags</u> contains the extended flags that are set on this inode.  These flags are  the  same  values  as
       those defined in the <b>XFS</b> <b>INODE</b> <b>FLAGS</b> section of the <b><a href="../man2/ioctl_xfs_fsgetxattr.2.html">ioctl_xfs_fsgetxattr</a></b>(2) manpage.

       <u>bs_extsize</u> is the extent size hint for this file, in bytes.

       <u>bs_extents</u> is the number of storage mappings associated with this file's data.

       <u>bs_gen</u> is the generation number of the inode record.

       <u>bs_projid_lo</u> is the lower 16-bits of the project id.

       <u>bs_forkoff</u> is the offset of the attribute fork in the inode record, in bytes.

       <u>bs_projid_hi</u> is the upper 16-bits of the project id.

       <u>bs_pad[6]</u> is zeroed.

       <u>bs_cowextsize</u> is the Copy on Write extent size hint for this file, in bytes.

       <u>bs_dmevmask</u> is unused on Linux.

       <u>bs_dmstate</u> is unused on Linux.

       <u>bs_aextents</u> is the number of storage mappings associated with this file's extended attributes.

       The fields <u>bs_sick</u> and <u>bs_checked</u> indicate the relative health of various inode metadata:

       • If  a  given  sick flag is set in <u>bs_sick</u>, then that piece of metadata has been observed to be damaged.
         The same bit should be set in <u>bs_checked</u>.

       • If a given sick flag is set in <u>bs_checked</u> but is not set in <u>bs_sick</u>, then that piece  of  metadata  has
         been checked and is not faulty.

       • If a given sick flag is not set in <u>bs_checked</u>, then no conclusion can be made.

       The following flags apply to these fields:

           <b>XFS_BS_SICK_INODE</b>
                  The inode's record itself.

           <b>XFS_BS_SICK_BMBTD</b>
                  File data extent mappings.

           <b>XFS_BS_SICK_BMBTA</b>
                  Extended attribute extent mappings.

           <b>XFS_BS_SICK_BMBTC</b>
                  Copy on Write staging extent mappings.

           <b>XFS_BS_SICK_DIR</b>
                  Directory information.

           <b>XFS_BS_SICK_XATTR</b>
                  Extended attribute data.

           <b>XFS_BS_SICK_SYMLINK</b>
                  Symbolic link target.

           <b>XFS_BS_SICK_PARENT</b>
                  Parent pointers.

           <b>XFS_BS_SICK_DIRTREE</b>
                  Directory is the source of corruption in the directory tree.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       Error codes can be one of, but are not limited to, the following:

       <b>EFAULT</b> The kernel was not able to copy into the userspace buffer.

       <b>EFSBADCRC</b>
              Metadata checksum validation failed while performing the query.

       <b>EFSCORRUPTED</b>
              Metadata corruption was encountered while performing the query.

       <b>EINVAL</b> One of the arguments was not valid.

       <b>EIO</b>    An I/O error was encountered while performing the query.

       <b>ENOMEM</b> There was insufficient memory to perform the query.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       This API is specific to XFS filesystem on the Linux kernel.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/ioctl.2.html">ioctl</a></b>(2), <b><a href="../man2/ioctl_xfs_fsgetxattr.2.html">ioctl_xfs_fsgetxattr</a></b>(2)

XFS                                                2019-06-17                            <u><a href="../man2/IOCTL-XFS-FSBULKSTAT.2.html">IOCTL-XFS-FSBULKSTAT</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>