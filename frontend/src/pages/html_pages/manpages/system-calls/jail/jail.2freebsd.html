<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>jail, jail_get, jail_set, jail_remove, jail_attach — create and manage system jails</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       jail, jail_get, jail_set, jail_remove, jail_attach — create and manage system jails

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C Library (libc, -lc)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/param.h&gt;</b>
       <b>#include</b> <b>&lt;sys/jail.h&gt;</b>

       <u>int</u>
       <b>jail</b>(<u>struct</u> <u>jail</u> <u>*jail</u>);

       <u>int</u>
       <b>jail_attach</b>(<u>int</u> <u>jid</u>);

       <u>int</u>
       <b>jail_remove</b>(<u>int</u> <u>jid</u>);

       <b>#include</b> <b>&lt;sys/uio.h&gt;</b>

       <u>int</u>
       <b>jail_get</b>(<u>struct</u> <u>iovec</u> <u>*iov</u>, <u>u_int</u> <u>niov</u>, <u>int</u> <u>flags</u>);

       <u>int</u>
       <b>jail_set</b>(<u>struct</u> <u>iovec</u> <u>*iov</u>, <u>u_int</u> <u>niov</u>, <u>int</u> <u>flags</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>jail</b>() system call sets up a jail and locks the current process in it.

       The argument is a pointer to a structure describing the prison:

             struct jail {
                     uint32_t        version;
                     char            *path;
                     char            *hostname;
                     char            *jailname;
                     unsigned int    ip4s;
                     unsigned int    ip6s;
                     struct in_addr  *ip4;
                     struct in6_addr *ip6;
             };

       “<b>version</b>” defines the version of the API in use.  JAIL_API_VERSION is defined for the current version.

       The “<b>path</b>” pointer should be set to the directory which is to be the root of the prison.

       The  “<b>hostname</b>” pointer can be set to the hostname of the prison.  This can be changed from the inside of
       the prison.

       The “<b>jailname</b>” pointer is an optional name that can be assigned to the jail for  example  for  management
       purposes.

       The  “<b>ip4s</b>”  and  “<b>ip6s</b>”  give  the  numbers  of  IPv4  and  IPv6 addresses that will be passed via their
       respective pointers.

       The “<b>ip4</b>” and “<b>ip6</b>” pointers can be set to an arrays of IPv4 and IPv6 addresses to  be  assigned  to  the
       prison, or NULL if none.  IPv4 addresses must be in network byte order.

       This  is  equivalent  to,  and  deprecated  in favor of, the <b>jail_set</b>() system call (see below), with the
       parameters <u>path</u>, <u>host.hostname</u>, <u>name</u>, <u>ip4.addr</u>, and <u>ip6.addr</u>, and with the JAIL_ATTACH flag.

       The <b>jail_set</b>() system call creates a new jail, or modifies an existing  one,  and  optionally  locks  the
       current  process  in  it.   Jail  parameters are passed as an array of name-value pairs in the array <u>iov</u>,
       containing <u>niov</u> elements.  Parameter names are a null-terminated  string,  and  values  may  be  strings,
       integers, or other arbitrary data.  Some parameters are boolean, and do not have a value (their length is
       zero)  but  are  set  by  the  name alone with or without a “no” prefix, e.g.  <u>persist</u> or <u>nopersist</u>.  Any
       parameters not set will be given default values, generally based on the current environment.

       Jails have a set of core parameters, and modules can add their own jail parameters.  The current  set  of
       available  parameters,  and their formats, can be retrieved via the <u>security.jail.param</u> sysctl MIB entry.
       Notable parameters include those mentioned in the <b>jail</b>() description above, as  well  as  <u>jid</u>  and  <u>name</u>,
       which  identify  the  jail  being created or modified.  See <u><a href="../man8/jail.8.html">jail</a></u>(8) for more information on the core jail
       parameters.

       The <u>flags</u> arguments consists of one or more of the following flags:

       JAIL_CREATE
               Create a new jail.  If a <u>jid</u> or <u>name</u> parameters exists, they must not refer to an existing jail.

       JAIL_UPDATE
               Modify an existing jail.  One of the <u>jid</u> or <u>name</u> parameters must exist,  and  must  refer  to  an
               existing  jail.   If  both JAIL_CREATE and JAIL_UPDATE are set, a jail will be created if it does
               not yet exist, and modified if it does exist.

       JAIL_ATTACH
               In addition to creating or modifying the jail, attach the current process  to  it,  as  with  the
               <b>jail_attach</b>() system call.

       JAIL_DYING
               Allow setting a jail that is in the process of being removed.

       The <b>jail_get</b>() system call retrieves jail parameters, using the same name-value list as <b>jail_set</b>() in the
       <u>iov</u>  and  <u>niov</u>  arguments.   The  jail  to read can be specified by either <u>jid</u> or <u>name</u> by including those
       parameters in the list.  If they are included but are not intended to be the search key, they  should  be
       cleared (zero and the empty string respectively).

       The  special  parameter <u>lastjid</u> can be used to retrieve a list of all jails.  It will fetch the jail with
       the jid above and closest to the passed value.  The first jail (usually but not  always  jid  1)  can  be
       found by passing a <u>lastjid</u> of zero.

       The <u>flags</u> arguments consists of one or more following flags:

       JAIL_DYING
               Allow getting a jail that is in the process of being removed.

       The <b>jail_attach</b>() system call attaches the current process to an existing jail, identified by <u>jid</u>.

       The  <b>jail_remove</b>()  system call removes the jail identified by <u>jid</u>.  It will kill all processes belonging
       to the jail, and remove any children of that jail.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       If successful, <b>jail</b>(), <b>jail_set</b>(),  and  <b>jail_get</b>()  return  a  non-negative  integer,  termed  the  jail
       identifier (JID).  They return -1 on failure, and set <u>errno</u> to indicate the error.

       The <b>jail_attach</b>() and <b>jail_remove</b>() functions return the value 0 if successful; otherwise the value -1 is
       returned and the global variable <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       The <b>jail</b>() system call will fail if:

       [EPERM]            This process is not allowed to create a jail, either because it is not the super-user,
                          or because it would exceed the jail's <u>children.max</u> limit.

       [EFAULT]           <u>jail</u> points to an address outside the allocated address space of the process.

       [EINVAL]           The version number of the argument is not correct.

       [EAGAIN]           No free JID could be found.

       The <b>jail_set</b>() system call will fail if:

       [EPERM]            This process is not allowed to create a jail, either because it is not the super-user,
                          or because it would exceed the jail's <u>children.max</u> limit.

       [EPERM]            A jail parameter was set to a less restrictive value then the current environment.

       [EFAULT]           <u>Iov</u>,  or  one  of  the addresses contained within it, points to an address outside the
                          allocated address space of the process.

       [ENOENT]           The jail referred to by a <u>jid</u> or <u>name</u> parameter does not exist,  and  the  JAIL_CREATE
                          flag is not set.

       [ENOENT]           The jail referred to by a <u>jid</u> is not accessible by the process, because the process is
                          in a different jail.

       [EEXIST]           The  jail  referred  to by a <u>jid</u> or <u>name</u> parameter exists, and the JAIL_UPDATE flag is
                          not set.

       [EINVAL]           A supplied parameter is the wrong size.

       [EINVAL]           A supplied parameter is out of range.

       [EINVAL]           A supplied string parameter is not null-terminated.

       [EINVAL]           A supplied parameter name does not match any known parameters.

       [EINVAL]           One of the JAIL_CREATE or JAIL_UPDATE flags is not set.

       [ENAMETOOLONG]     A supplied string parameter is longer than allowed.

       [EAGAIN]           There are no jail IDs left.

       The <b>jail_get</b>() system call will fail if:

       [EFAULT]           <u>Iov</u>, or one of the addresses contained within it, points to  an  address  outside  the
                          allocated address space of the process.

       [ENOENT]           The jail referred to by a <u>jid</u> or <u>name</u> parameter does not exist.

       [ENOENT]           The jail referred to by a <u>jid</u> is not accessible by the process, because the process is
                          in a different jail.

       [ENOENT]           The <u>lastjid</u> parameter is greater than the highest current jail ID.

       [EINVAL]           A supplied parameter is the wrong size.

       [EINVAL]           A supplied parameter name does not match any known parameters.

       The <b>jail_attach</b>() and <b>jail_remove</b>() system calls will fail if:

       [EPERM]            A user other than the super-user attempted to attach to or remove a jail.

       [EINVAL]           The jail specified by <u>jid</u> does not exist.

       Further  <b>jail</b>(),  <b>jail_set</b>(),  and  <b>jail_attach</b>() call <u><a href="../man2/chroot.2.html">chroot</a></u>(2) internally, so they can fail for all the
       same reasons.  Please consult the <u><a href="../man2/chroot.2.html">chroot</a></u>(2) manual page for details.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/chdir.2.html">chdir</a></u>(2), <u><a href="../man2/chroot.2.html">chroot</a></u>(2), <u><a href="../man8/jail.8.html">jail</a></u>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>jail</b>() system call appeared in FreeBSD 4.0.  The <b>jail_attach</b>() system call appeared in  FreeBSD  5.1.
       The <b>jail_set</b>(), <b>jail_get</b>(), and <b>jail_remove</b>() system calls appeared in FreeBSD 8.0.

</pre><h4><b>AUTHORS</b></h4><pre>
       The jail feature was written by Poul-Henning Kamp for R&amp;D Associates who contributed it to FreeBSD.
       James Gritton added the extensible jail parameters and hierarchical jails.

Debian                                          February 8, 2012                                         <u><a href="../man2/JAIL.2.html">JAIL</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>