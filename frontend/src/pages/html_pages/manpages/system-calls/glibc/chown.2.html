<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chown, fchown, lchown, fchownat - change ownership of a file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       chown, fchown, lchown, fchownat - change ownership of a file

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;</b>

       <b>int</b> <b>chown(const</b> <b>char</b> <b>*</b><u>pathname</u><b>,</b> <b>uid_t</b> <u>owner</u><b>,</b> <b>gid_t</b> <u>group</u><b>);</b>
       <b>int</b> <b>fchown(int</b> <u>fd</u><b>,</b> <b>uid_t</b> <u>owner</u><b>,</b> <b>gid_t</b> <u>group</u><b>);</b>
       <b>int</b> <b>lchown(const</b> <b>char</b> <b>*</b><u>pathname</u><b>,</b> <b>uid_t</b> <u>owner</u><b>,</b> <b>gid_t</b> <u>group</u><b>);</b>

       <b>#include</b> <b>&lt;<a href="file:/usr/include/fcntl.h">fcntl.h</a>&gt;</b>           /* Definition of AT_* constants */
       <b>#include</b> <b>&lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;</b>

       <b>int</b> <b>fchownat(int</b> <u>dirfd</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>pathname</u><b>,</b>
                    <b>uid_t</b> <u>owner</u><b>,</b> <b>gid_t</b> <u>group</u><b>,</b> <b>int</b> <u>flags</u><b>);</b>

   Feature Test Macro Requirements for glibc (see <b><a href="../man7/feature_test_macros.7.html">feature_test_macros</a></b>(7)):

       <b>fchown</b>(), <b>lchown</b>():
           /* Since glibc 2.12: */ _POSIX_C_SOURCE &gt;= 200809L
               || _XOPEN_SOURCE &gt;= 500
               || /* glibc &lt;= 2.19: */ _BSD_SOURCE

       <b>fchownat</b>():
           Since glibc 2.10:
               _POSIX_C_SOURCE &gt;= 200809L
           Before glibc 2.10:
               _ATFILE_SOURCE

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These  system  calls  change  the  owner and group of a file.  The <b>chown</b>(), <b>fchown</b>(), and <b>lchown</b>() system
       calls differ only in how the file is specified:

       •  <b>chown</b>() changes the ownership of the file specified by <u>pathname</u>, which is  dereferenced  if  it  is  a
          symbolic link.

       •  <b>fchown</b>() changes the ownership of the file referred to by the open file descriptor <u>fd</u>.

       •  <b>lchown</b>() is like <b>chown</b>(), but does not dereference symbolic links.

       Only a privileged process (Linux: one with the <b>CAP_CHOWN</b> capability) may change the owner of a file.  The
       owner  of  a  file  may  change  the  group  of the file to any group of which that owner is a member.  A
       privileged process (Linux: with <b>CAP_CHOWN</b>) may change the group arbitrarily.

       If the <u>owner</u> or <u>group</u> is specified as -1, then that ID is not changed.

       When the owner or group of an executable file is changed by an unprivileged user, the <b>S_ISUID</b> and <b>S_ISGID</b>
       mode bits are cleared.  POSIX does not specify whether  this  also  should  happen  when  root  does  the
       <b>chown</b>();  the  Linux behavior depends on the kernel version, and since Linux 2.2.13, root is treated like
       other users.  In case of a non-group-executable file (i.e., one for which the <b>S_IXGRP</b> bit is not set) the
       <b>S_ISGID</b> bit indicates mandatory locking, and is not cleared by a <b>chown</b>().

       When the owner or group of an executable file is changed (by any user), all capability sets for the  file
       are cleared.

   <b>fchownat()</b>
       The  <b>fchownat</b>()  system  call  operates  in  exactly  the same way as <b>chown</b>(), except for the differences
       described here.

       If the pathname given in <u>pathname</u> is relative, then it is interpreted relative to the directory  referred
       to  by  the  file  descriptor <u>dirfd</u> (rather than relative to the current working directory of the calling
       process, as is done by <b>chown</b>() for a relative pathname).

       If <u>pathname</u> is relative and <u>dirfd</u> is the special value <b>AT_FDCWD</b>, then <u>pathname</u> is interpreted relative to
       the current working directory of the calling process (like <b>chown</b>()).

       If <u>pathname</u> is absolute, then <u>dirfd</u> is ignored.

       The <u>flags</u> argument is a bit mask created by ORing together 0 or more of the following values;

       <b>AT_EMPTY_PATH</b> (since Linux 2.6.39)
              If <u>pathname</u> is an empty string, operate on the file referred to by  <u>dirfd</u>  (which  may  have  been
              obtained  using  the <b><a href="../man2/open.2.html">open</a></b>(2) <b>O_PATH</b> flag).  In this case, <u>dirfd</u> can refer to any type of file, not
              just a directory.  If <u>dirfd</u> is <b>AT_FDCWD</b>, the call operates on the current working directory.  This
              flag is Linux-specific; define <b>_GNU_SOURCE</b> to obtain its definition.

       <b>AT_SYMLINK_NOFOLLOW</b>
              If <u>pathname</u> is a symbolic link, do not dereference it: instead operate on the  link  itself,  like
              <b>lchown</b>().  (By default, <b>fchownat</b>() dereferences symbolic links, like <b>chown</b>().)

       See <b><a href="../man2/openat.2.html">openat</a></b>(2) for an explanation of the need for <b>fchownat</b>().

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, zero is returned.  On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       Depending on the filesystem, errors other than those listed below can be returned.

       The more general errors for <b>chown</b>() are listed below.

       <b>EACCES</b> Search permission is denied on a component of the path prefix.  (See also <b><a href="../man7/path_resolution.7.html">path_resolution</a></b>(7).)

       <b>EBADF</b>  (<b>fchown</b>()) <u>fd</u> is not a valid open file descriptor.

       <b>EBADF</b>  (<b>fchownat</b>()) <u>pathname</u> is relative but <u>dirfd</u> is neither <b>AT_FDCWD</b> nor a valid file descriptor.

       <b>EFAULT</b> <u>pathname</u> points outside your accessible address space.

       <b>EINVAL</b> (<b>fchownat</b>()) Invalid flag specified in <u>flags</u>.

       <b>EIO</b>    (<b>fchown</b>()) A low-level I/O error occurred while modifying the inode.

       <b>ELOOP</b>  Too many symbolic links were encountered in resolving <u>pathname</u>.

       <b>ENAMETOOLONG</b>
              <u>pathname</u> is too long.

       <b>ENOENT</b> The file does not exist.

       <b>ENOMEM</b> Insufficient kernel memory was available.

       <b>ENOTDIR</b>
              A component of the path prefix is not a directory.

       <b>ENOTDIR</b>
              (<b>fchownat</b>())  <u>pathname</u> is relative and <u>dirfd</u> is a file descriptor referring to a file other than a
              directory.

       <b>EPERM</b>  The calling process did not have the required permissions  (see  above)  to  change  owner  and/or
              group.

       <b>EPERM</b>  The file is marked immutable or append-only.  (See <b><a href="../man2const/FS_IOC_SETFLAGS.2const.html">FS_IOC_SETFLAGS</a></b>(2const).)

       <b>EROFS</b>  The named file resides on a read-only filesystem.

</pre><h4><b>VERSIONS</b></h4><pre>
       The 4.4BSD version can be used only by the superuser (that is, ordinary users cannot give away files).

</pre><h4><b>STANDARDS</b></h4><pre>
       POSIX.1-2008.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>chown</b>()
       <b>fchown</b>()
       <b>lchown</b>()
              4.4BSD, SVr4, POSIX.1-2001.

       <b>fchownat</b>()
              POSIX.1-2008.  Linux 2.6.16, glibc 2.4.

</pre><h4><b>NOTES</b></h4><pre>
   <b>Ownership</b> <b>of</b> <b>new</b> <b>files</b>
       When  a  new  file  is  created (by, for example, <b><a href="../man2/open.2.html">open</a></b>(2) or <b><a href="../man2/mkdir.2.html">mkdir</a></b>(2)), its owner is made the same as the
       filesystem user ID of the creating process.  The group of  the  file  depends  on  a  range  of  factors,
       including  the  type of filesystem, the options used to mount the filesystem, and whether or not the set-
       group-ID mode bit is enabled on the parent directory.  If  the  filesystem  supports  the  <b>-o</b> <b>grpid</b>  (or,
       synonymously  <b>-o</b> <b>bsdgroups</b>)  and  <b>-o</b> <b>nogrpid</b>  (or, synonymously <b>-o</b> <b>sysvgroups</b>) <b><a href="../man8/mount.8.html">mount</a></b>(8) options, then the
       rules are as follows:

       •  If the filesystem is mounted with <b>-o</b> <b>grpid</b>, then the group of a new file is made the same as  that  of
          the parent directory.

       •  If  the  filesystem  is  mounted  with  <b>-o</b> <b>nogrpid</b>  and the set-group-ID bit is disabled on the parent
          directory, then the group of a new file is made the same as the process's filesystem GID.

       •  If the filesystem is mounted with <b>-o</b> <b>nogrpid</b> and  the  set-group-ID  bit  is  enabled  on  the  parent
          directory, then the group of a new file is made the same as that of the parent directory.

       As  at  Linux 4.12, the <b>-o</b> <b>grpid</b> and <b>-o</b> <b>nogrpid</b> mount options are supported by ext2, ext3, ext4, and XFS.
       Filesystems that don't support these mount options follow the <b>-o</b> <b>nogrpid</b> rules.

   <b>glibc</b> <b>notes</b>
       On older kernels where <b>fchownat</b>() is unavailable, the glibc wrapper function falls back  to  the  use  of
       <b>chown</b>()  and  <b>lchown</b>().   When  <u>pathname</u> is a relative pathname, glibc constructs a pathname based on the
       symbolic link in <u><a href="file:/proc/self/fd">/proc/self/fd</a></u> that corresponds to the <u>dirfd</u> argument.

   <b>NFS</b>
       The <b>chown</b>() semantics are deliberately violated on  NFS  filesystems  which  have  UID  mapping  enabled.
       Additionally,  the  semantics  of  all  system calls which access the file contents are violated, because
       <b>chown</b>() may cause immediate access revocation on already open files.  Client side caching may lead  to  a
       delay  between  the  time where ownership have been changed to allow access for a user and the time where
       the file can actually be accessed by the user on other clients.

   <b>Historical</b> <b>details</b>
       The original Linux <b>chown</b>(), <b>fchown</b>(), and <b>lchown</b>() system calls supported only 16-bit user and group IDs.
       Subsequently, Linux 2.4 added <b>chown32</b>(), <b>fchown32</b>(), and <b>lchown32</b>(), supporting 32-bit  IDs.   The  glibc
       <b>chown</b>(),  <b>fchown</b>(),  and  <b>lchown</b>() wrapper functions transparently deal with the variations across kernel
       versions.

       Before Linux 2.1.81 (except 2.1.46), <b>chown</b>() did not follow symbolic links.  Since Linux 2.1.81,  <b>chown</b>()
       does  follow symbolic links, and there is a new system call <b>lchown</b>() that does not follow symbolic links.
       Since Linux 2.1.86, this new call (that has the same semantics as the  old  <b>chown</b>())  has  got  the  same
       syscall number, and <b>chown</b>() got the newly introduced number.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The  following program changes the ownership of the file named in its second command-line argument to the
       value specified in its first command-line argument.  The new owner can be specified either as  a  numeric
       user  ID,  or  as a username (which is converted to a user ID by using <b><a href="../man3/getpwnam.3.html">getpwnam</a></b>(3) to perform a lookup in
       the system password file).

   <b>Program</b> <b>source</b>
       #include &lt;<a href="file:/usr/include/pwd.h">pwd.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
       #include &lt;sys/types.h&gt;
       #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;

       int
       main(int argc, char *argv[])
       {
           char           *endptr;
           uid_t          uid;
           struct passwd  *pwd;

           if (argc != 3 || argv[1][0] == '\0') {
               fprintf(stderr, "%s &lt;owner&gt; &lt;file&gt;\n", argv[0]);
               exit(EXIT_FAILURE);
           }

           uid = strtol(argv[1], &amp;endptr, 10);  /* Allow a numeric string */

           if (*endptr != '\0') {         /* Was not pure numeric string */
               pwd = getpwnam(argv[1]);   /* Try getting UID for username */
               if (pwd == NULL) {
                   perror("getpwnam");
                   exit(EXIT_FAILURE);
               }

               uid = pwd-&gt;pw_uid;
           }

           if (chown(argv[2], uid, -1) == -1) {
               perror("chown");
               exit(EXIT_FAILURE);
           }

           exit(EXIT_SUCCESS);
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/chgrp.1.html">chgrp</a></b>(1), <b><a href="../man1/chown.1.html">chown</a></b>(1), <b><a href="../man2/chmod.2.html">chmod</a></b>(2), <b><a href="../man2/flock.2.html">flock</a></b>(2), <b><a href="../man7/path_resolution.7.html">path_resolution</a></b>(7), <b><a href="../man7/symlink.7.html">symlink</a></b>(7)

Linux man-pages 6.9.1                              2024-06-15                                           <u><a href="../man2/chown.2.html">chown</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>