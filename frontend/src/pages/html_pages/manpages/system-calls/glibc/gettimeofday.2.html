<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gettimeofday, settimeofday - get / set time</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gettimeofday, settimeofday - get / set time

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/time.h&gt;</b>

       <b>int</b> <b>gettimeofday(struct</b> <b>timeval</b> <b>*restrict</b> <u>tv</u><b>,</b>
                        <b>struct</b> <b>timezone</b> <b>*_Nullable</b> <b>restrict</b> <u>tz</u><b>);</b>
       <b>int</b> <b>settimeofday(const</b> <b>struct</b> <b>timeval</b> <b>*</b><u>tv</u><b>,</b>
                        <b>const</b> <b>struct</b> <b>timezone</b> <b>*_Nullable</b> <u>tz</u><b>);</b>

   Feature Test Macro Requirements for glibc (see <b><a href="../man7/feature_test_macros.7.html">feature_test_macros</a></b>(7)):

       <b>settimeofday</b>():
           Since glibc 2.19:
               _DEFAULT_SOURCE
           glibc 2.19 and earlier:
               _BSD_SOURCE

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The functions <b>gettimeofday</b>() and <b>settimeofday</b>() can get and set the time as well as a timezone.

       The <u>tv</u> argument is a <u>struct</u> <u>timeval</u> (as specified in <u>&lt;sys/time.h&gt;</u>):

           struct timeval {
               time_t      tv_sec;     /* seconds */
               suseconds_t tv_usec;    /* microseconds */
           };

       and gives the number of seconds and microseconds since the Epoch (see <b><a href="../man2/time.2.html">time</a></b>(2)).

       The <u>tz</u> argument is a <u>struct</u> <u>timezone</u>:

           struct timezone {
               int tz_minuteswest;     /* minutes west of Greenwich */
               int tz_dsttime;         /* type of DST correction */
           };

       If  either  <u>tv</u>  or <u>tz</u> is NULL, the corresponding structure is not set or returned.  (However, compilation
       warnings will result if <u>tv</u> is NULL.)

       The use of the <u>timezone</u> structure is obsolete; the <u>tz</u> argument should  normally  be  specified  as  NULL.
       (See NOTES below.)

       Under  Linux,  there  are  some peculiar "warp clock" semantics associated with the <b>settimeofday</b>() system
       call if on the very first call (after booting) that has a non-NULL <u>tz</u> argument, the <u>tv</u> argument  is  NULL
       and the <u>tz_minuteswest</u> field is nonzero.  (The <u>tz_dsttime</u> field should be zero for this case.)  In such a
       case it is assumed that the CMOS clock is on local time, and that it has to be incremented by this amount
       to get UTC system time.  No doubt it is a bad idea to use this feature.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>gettimeofday</b>()  and  <b>settimeofday</b>()  return  0 for success.  On error, -1 is returned and <u>errno</u> is set to
       indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EFAULT</b> One of <u>tv</u> or <u>tz</u> pointed outside the accessible address space.

       <b>EINVAL</b> (<b>settimeofday</b>()): <u>timezone</u> is invalid.

       <b>EINVAL</b> (<b>settimeofday</b>()): <u>tv.tv_sec</u> is negative or <u>tv.tv_usec</u> is outside the range [0, 999,999].

       <b>EINVAL</b> (since Linux 4.3)
              (<b>settimeofday</b>()): An attempt was made to set the time to a value less than the  current  value  of
              the <b>CLOCK_MONOTONIC</b> clock (see <b><a href="../man2/clock_gettime.2.html">clock_gettime</a></b>(2)).

       <b>EPERM</b>  The   calling  process  has  insufficient  privilege  to  call  <b>settimeofday</b>();  under  Linux  the
              <b>CAP_SYS_TIME</b> capability is required.

</pre><h4><b>VERSIONS</b></h4><pre>
   <b>C</b> <b>library/kernel</b> <b>differences</b>
       On some architectures, an implementation of <b>gettimeofday</b>() is provided in the <b><a href="../man7/vdso.7.html">vdso</a></b>(7).

       The kernel accepts NULL for both <u>tv</u> and <u>tz</u>.  The timezone argument is ignored by glibc and musl, and  not
       passed to/from the kernel.  Android's bionic passes the timezone argument to/from the kernel, but Android
       does not update the kernel timezone based on the device timezone in Settings, so the kernel's timezone is
       typically UTC.

</pre><h4><b>STANDARDS</b></h4><pre>
       <b>gettimeofday</b>()
              POSIX.1-2008 (obsolete).

       <b>settimeofday</b>()
              None.

</pre><h4><b>HISTORY</b></h4><pre>
       SVr4,  4.3BSD.   POSIX.1-2001  describes  <b>gettimeofday</b>()  but  not  <b>settimeofday</b>().   POSIX.1-2008  marks
       <b>gettimeofday</b>() as obsolete, recommending the use of <b><a href="../man2/clock_gettime.2.html">clock_gettime</a></b>(2) instead.

       Traditionally, the fields of <u>struct</u> <u>timeval</u> were of type <u>long</u>.

   <b>The</b> <b>tz_dsttime</b> <b>field</b>
       On a non-Linux kernel, with glibc, the <u>tz_dsttime</u> field of <u>struct</u> <u>timezone</u> will be set to a nonzero value
       by <b>gettimeofday</b>() if the current timezone has ever had or will have a daylight saving rule  applied.   In
       this sense it exactly mirrors the meaning of <b><a href="../man3/daylight.3.html">daylight</a></b>(3) for the current zone.  On Linux, with glibc, the
       setting  of  the  <u>tz_dsttime</u>  field  of  <u>struct</u>  <u>timezone</u>  has  never  been  used  by  <b>settimeofday</b>()  or
       <b>gettimeofday</b>().  Thus, the following is purely of historical interest.

       On old systems, the field <u>tz_dsttime</u> contains a symbolic constant (values are given below) that indicates
       in which part of the year Daylight Saving Time is in force.  (Note: this value is constant throughout the
       year: it does not indicate that DST is in force, it just selects an algorithm.)  The daylight saving time
       algorithms defined are as follows:

           <b>DST_NONE</b>     /* not on DST */
           <b>DST_USA</b>      /* USA style DST */
           <b>DST_AUST</b>     /* Australian style DST */
           <b>DST_WET</b>      /* Western European DST */
           <b>DST_MET</b>      /* Middle European DST */
           <b>DST_EET</b>      /* Eastern European DST */
           <b>DST_CAN</b>      /* Canada */
           <b>DST_GB</b>       /* Great Britain and Eire */
           <b>DST_RUM</b>      /* Romania */
           <b>DST_TUR</b>      /* Turkey */
           <b>DST_AUSTALT</b>  /* Australian style with shift in 1986 */

       Of course it turned out that the period in which Daylight Saving Time is in force cannot be  given  by  a
       simple  algorithm,  one  per  country;  indeed,  this  period  is  determined  by unpredictable political
       decisions.  So this method of representing timezones has been abandoned.

</pre><h4><b>NOTES</b></h4><pre>
       The time returned by <b>gettimeofday</b>() <u>is</u> affected by discontinuous jumps in the system time (e.g.,  if  the
       system  administrator  manually  changes the system time).  If you need a monotonically increasing clock,
       see <b><a href="../man2/clock_gettime.2.html">clock_gettime</a></b>(2).

       Macros for operating on <u>timeval</u> structures are described in <b><a href="../man3/timeradd.3.html">timeradd</a></b>(3).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/date.1.html">date</a></b>(1),  <b><a href="../man2/adjtimex.2.html">adjtimex</a></b>(2),  <b><a href="../man2/clock_gettime.2.html">clock_gettime</a></b>(2),  <b><a href="../man2/time.2.html">time</a></b>(2),  <b><a href="../man3/ctime.3.html">ctime</a></b>(3),  <b><a href="../man3/ftime.3.html">ftime</a></b>(3),  <b><a href="../man3/timeradd.3.html">timeradd</a></b>(3),  <b><a href="../man7/capabilities.7.html">capabilities</a></b>(7),
       <b><a href="../man7/time.7.html">time</a></b>(7), <b><a href="../man7/vdso.7.html">vdso</a></b>(7), <b><a href="../man8/hwclock.8.html">hwclock</a></b>(8)

Linux man-pages 6.9.1                              2024-05-02                                    <u><a href="../man2/gettimeofday.2.html">gettimeofday</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>