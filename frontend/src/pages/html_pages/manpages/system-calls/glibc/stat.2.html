<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>stat, fstat, lstat, fstatat - get file status</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       stat, fstat, lstat, fstatat - get file status

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/stat.h&gt;</b>

       <b>int</b> <b>stat(const</b> <b>char</b> <b>*restrict</b> <u>pathname</u><b>,</b>
                <b>struct</b> <b>stat</b> <b>*restrict</b> <u>statbuf</u><b>);</b>
       <b>int</b> <b>fstat(int</b> <u>fd</u><b>,</b> <b>struct</b> <b>stat</b> <b>*</b><u>statbuf</u><b>);</b>
       <b>int</b> <b>lstat(const</b> <b>char</b> <b>*restrict</b> <u>pathname</u><b>,</b>
                <b>struct</b> <b>stat</b> <b>*restrict</b> <u>statbuf</u><b>);</b>

       <b>#include</b> <b>&lt;<a href="file:/usr/include/fcntl.h">fcntl.h</a>&gt;</b>           /* Definition of <b>AT_*</b> constants */
       <b>#include</b> <b>&lt;sys/stat.h&gt;</b>

       <b>int</b> <b>fstatat(int</b> <u>dirfd</u><b>,</b> <b>const</b> <b>char</b> <b>*restrict</b> <u>pathname</u><b>,</b>
                <b>struct</b> <b>stat</b> <b>*restrict</b> <u>statbuf</u><b>,</b> <b>int</b> <u>flags</u><b>);</b>

   Feature Test Macro Requirements for glibc (see <b><a href="../man7/feature_test_macros.7.html">feature_test_macros</a></b>(7)):

       <b>lstat</b>():
           /* Since glibc 2.20 */ _DEFAULT_SOURCE
               || _XOPEN_SOURCE &gt;= 500
               || /* Since glibc 2.10: */ _POSIX_C_SOURCE &gt;= 200112L
               || /* glibc 2.19 and earlier */ _BSD_SOURCE

       <b>fstatat</b>():
           Since glibc 2.10:
               _POSIX_C_SOURCE &gt;= 200809L
           Before glibc 2.10:
               _ATFILE_SOURCE

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These functions return information about a file, in the buffer pointed to by <u>statbuf</u>.  No permissions are
       required  on  the  file  itself,  but—in  the  case  of  <b>stat</b>(),  <b>fstatat</b>(), and <b>lstat</b>()—execute (search)
       permission is required on all of the directories in <u>pathname</u> that lead to the file.

       <b>stat</b>() and <b>fstatat</b>() retrieve information about the file pointed to  by  <u>pathname</u>;  the  differences  for
       <b>fstatat</b>() are described below.

       <b>lstat</b>()  is  identical to <b>stat</b>(), except that if <u>pathname</u> is a symbolic link, then it returns information
       about the link itself, not the file that the link refers to.

       <b>fstat</b>() is identical to <b>stat</b>(), except that the file about  which  information  is  to  be  retrieved  is
       specified by the file descriptor <u>fd</u>.

   <b>The</b> <b>stat</b> <b>structure</b>
       All of these system calls return a <u>stat</u> structure (see <b><a href="../man3type/stat.3type.html">stat</a></b>(3type)).

       <u>Note</u>:  for  performance  and simplicity reasons, different fields in the <u>stat</u> structure may contain state
       information from different moments during the execution of the system call.  For example, if  <u>st_mode</u>  or
       <u>st_uid</u> is changed by another process by calling <b><a href="../man2/chmod.2.html">chmod</a></b>(2) or <b><a href="../man2/chown.2.html">chown</a></b>(2), <b>stat</b>() might return the old <u>st_mode</u>
       together with the new <u>st_uid</u>, or the old <u>st_uid</u> together with the new <u>st_mode</u>.

   <b>fstatat()</b>
       The  <b>fstatat</b>()  system  call  is  a more general interface for accessing file information which can still
       provide exactly the behavior of each of <b>stat</b>(), <b>lstat</b>(), and <b>fstat</b>().

       If the pathname given in <u>pathname</u> is relative, then it is interpreted relative to the directory  referred
       to  by  the  file  descriptor <u>dirfd</u> (rather than relative to the current working directory of the calling
       process, as is done by <b>stat</b>() and <b>lstat</b>() for a relative pathname).

       If <u>pathname</u> is relative and <u>dirfd</u> is the special value <b>AT_FDCWD</b>, then <u>pathname</u> is interpreted relative to
       the current working directory of the calling process (like <b>stat</b>() and <b>lstat</b>()).

       If <u>pathname</u> is absolute, then <u>dirfd</u> is ignored.

       <u>flags</u> can either be 0, or include one or more of the following flags ORed:

       <b>AT_EMPTY_PATH</b> (since Linux 2.6.39)
              If <u>pathname</u> is an empty string, operate on the file referred to by  <u>dirfd</u>  (which  may  have  been
              obtained  using  the <b><a href="../man2/open.2.html">open</a></b>(2) <b>O_PATH</b> flag).  In this case, <u>dirfd</u> can refer to any type of file, not
              just a directory, and the behavior of <b>fstatat</b>() is similar  to  that  of  <b>fstat</b>().   If  <u>dirfd</u>  is
              <b>AT_FDCWD</b>, the call operates on the current working directory.  This flag is Linux-specific; define
              <b>_GNU_SOURCE</b> to obtain its definition.

       <b>AT_NO_AUTOMOUNT</b> (since Linux 2.6.38)
              Don't  automount  the  terminal  ("basename") component of <u>pathname.</u>  Since Linux 3.1 this flag is
              ignored.  Since Linux 4.11 this flag is implied.

       <b>AT_SYMLINK_NOFOLLOW</b>
              If <u>pathname</u> is a symbolic link, do not dereference it: instead return information about  the  link
              itself, like <b>lstat</b>().  (By default, <b>fstatat</b>() dereferences symbolic links, like <b>stat</b>().)

       See <b><a href="../man2/openat.2.html">openat</a></b>(2) for an explanation of the need for <b>fstatat</b>().

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, zero is returned.  On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EACCES</b> Search  permission is denied for one of the directories in the path prefix of <u>pathname</u>.  (See also
              <b><a href="../man7/path_resolution.7.html">path_resolution</a></b>(7).)

       <b>EBADF</b>  <u>fd</u> is not a valid open file descriptor.

       <b>EBADF</b>  (<b>fstatat</b>()) <u>pathname</u> is relative but <u>dirfd</u> is neither <b>AT_FDCWD</b> nor a valid file descriptor.

       <b>EFAULT</b> Bad address.

       <b>EINVAL</b> (<b>fstatat</b>()) Invalid flag specified in <u>flags</u>.

       <b>ELOOP</b>  Too many symbolic links encountered while traversing the path.

       <b>ENAMETOOLONG</b>
              <u>pathname</u> is too long.

       <b>ENOENT</b> A component of <u>pathname</u> does not exist or is a dangling symbolic link.

       <b>ENOENT</b> <u>pathname</u> is an empty string and <b>AT_EMPTY_PATH</b> was not specified in <u>flags</u>.

       <b>ENOMEM</b> Out of memory (i.e., kernel memory).

       <b>ENOTDIR</b>
              A component of the path prefix of <u>pathname</u> is not a directory.

       <b>ENOTDIR</b>
              (<b>fstatat</b>()) <u>pathname</u> is relative and <u>dirfd</u> is a file descriptor referring to a file other  than  a
              directory.

       <b>EOVERFLOW</b>
              <u>pathname</u>  or  <u>fd</u>  refers  to  a  file  whose  size,  inode  number,  or number of blocks cannot be
              represented in, respectively, the types <u>off_t</u>, <u>ino_t</u>, or <u>blkcnt_t</u>.  This error can occur when, for
              example, an application compiled on a 32-bit platform without <u>-D_FILE_OFFSET_BITS=64</u> calls  <b>stat</b>()
              on a file whose size exceeds <u>(1&lt;&lt;31)-1</u> bytes.

</pre><h4><b>STANDARDS</b></h4><pre>
       POSIX.1-2008.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>stat</b>()
       <b>fstat</b>()
       <b>lstat</b>()
              SVr4, 4.3BSD, POSIX.1-2001.

       <b>fstatat</b>()
              POSIX.1-2008.  Linux 2.6.16, glibc 2.4.

       According  to  POSIX.1-2001, <b>lstat</b>() on a symbolic link need return valid information only in the <u>st_size</u>
       field and the file type  of  the  <u>st_mode</u>  field  of  the  <u>stat</u>  structure.   POSIX.1-2008  tightens  the
       specification,  requiring  <b>lstat</b>()  to  return  valid  information  in all fields except the mode bits in
       <u>st_mode</u>.

       Use of the <u>st_blocks</u> and <u>st_blksize</u> fields may be less portable.  (They  were  introduced  in  BSD.   The
       interpretation differs between systems, and possibly on a single system when NFS mounts are involved.)

   <b>C</b> <b>library/kernel</b> <b>differences</b>
       Over  time,  increases in the size of the <u>stat</u> structure have led to three successive versions of <b>stat</b>():
       <u>sys_stat</u>() (slot <b>__</b><u>NR_oldstat</u>), <u>sys_newstat</u>() (slot <b>__</b><u>NR_stat</u>), and <u>sys_stat64()</u>  (slot  <b>__</b><u>NR_stat64</u>)  on
       32-bit  platforms  such  as  i386.  The first two versions were already present in Linux 1.0 (albeit with
       different names); the last was added in Linux 2.4.  Similar remarks apply for <b>fstat</b>() and <b>lstat</b>().

       The  kernel-internal  versions  of  the  <u>stat</u>  structure  dealt  with  by  the  different  versions  are,
       respectively:

       <b>__</b><u>old_kernel_stat</u>
              The original structure, with rather narrow fields, and no padding.

       <u>stat</u>   Larger  <u>st_ino</u>  field  and  padding  added  to  various parts of the structure to allow for future
              expansion.

       <u>stat64</u> Even larger <u>st_ino</u> field, larger <u>st_uid</u> and <u>st_gid</u> fields to accommodate the  Linux-2.4  expansion
              of  UIDs  and  GIDs  to  32  bits,  and  various  other enlarged fields and further padding in the
              structure.  (Various padding bytes were eventually consumed in  Linux  2.6,  with  the  advent  of
              32-bit device IDs and nanosecond components for the timestamp fields.)

       The glibc <b>stat</b>() wrapper function hides these details from applications, invoking the most recent version
       of  the  system  call  provided by the kernel, and repacking the returned information if required for old
       binaries.

       On modern 64-bit systems, life is simpler: there is a single <b>stat</b>() system call and the kernel deals with
       a <u>stat</u> structure that contains fields of a sufficient size.

       The underlying system  call  employed  by  the  glibc  <b>fstatat</b>()  wrapper  function  is  actually  called
       <b>fstatat64</b>() or, on some architectures, <b>newfstatat</b>().

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following program calls <b>lstat</b>() and displays selected fields in the returned <u>stat</u> structure.

       #include &lt;<a href="file:/usr/include/stdint.h">stdint.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
       #include &lt;sys/stat.h&gt;
       #include &lt;sys/sysmacros.h&gt;
       #include &lt;<a href="file:/usr/include/time.h">time.h</a>&gt;

       int
       main(int argc, char *argv[])
       {
           struct stat sb;

           if (argc != 2) {
               fprintf(stderr, "Usage: %s &lt;pathname&gt;\n", argv[0]);
               exit(EXIT_FAILURE);
           }

           if (lstat(argv[1], &amp;sb) == -1) {
               perror("lstat");
               exit(EXIT_FAILURE);
           }

           printf("ID of containing device:  [%x,%x]\n",
                  major(sb.st_dev),
                  minor(sb.st_dev));

           printf("File type:                ");

           switch (sb.st_mode &amp; S_IFMT) {
           case S_IFBLK:  printf("block device\n");            break;
           case S_IFCHR:  printf("character device\n");        break;
           case S_IFDIR:  printf("directory\n");               break;
           case S_IFIFO:  printf("FIFO/pipe\n");               break;
           case S_IFLNK:  printf("symlink\n");                 break;
           case S_IFREG:  printf("regular file\n");            break;
           case S_IFSOCK: printf("socket\n");                  break;
           default:       printf("unknown?\n");                break;
           }

           printf("I-node number:            %ju\n", (uintmax_t) sb.st_ino);

           printf("Mode:                     %jo (octal)\n",
                  (uintmax_t) sb.st_mode);

           printf("Link count:               %ju\n", (uintmax_t) sb.st_nlink);
           printf("Ownership:                UID=%ju   GID=%ju\n",
                  (uintmax_t) sb.st_uid, (uintmax_t) sb.st_gid);

           printf("Preferred I/O block size: %jd bytes\n",
                  (intmax_t) sb.st_blksize);
           printf("File size:                %jd bytes\n",
                  (intmax_t) sb.st_size);
           printf("Blocks allocated:         %jd\n",
                  (intmax_t) sb.st_blocks);

           printf("Last status change:       %s", ctime(&amp;sb.st_ctime));
           printf("Last file access:         %s", ctime(&amp;sb.st_atime));
           printf("Last file modification:   %s", ctime(&amp;sb.st_mtime));

           exit(EXIT_SUCCESS);
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/ls.1.html">ls</a></b>(1),   <b><a href="../man1/stat.1.html">stat</a></b>(1),   <b><a href="../man2/access.2.html">access</a></b>(2),   <b><a href="../man2/chmod.2.html">chmod</a></b>(2),   <b><a href="../man2/chown.2.html">chown</a></b>(2),   <b><a href="../man2/readlink.2.html">readlink</a></b>(2),  <b><a href="../man2/statx.2.html">statx</a></b>(2),  <b><a href="../man2/utime.2.html">utime</a></b>(2),  <b><a href="../man3type/stat.3type.html">stat</a></b>(3type),
       <b><a href="../man7/capabilities.7.html">capabilities</a></b>(7), <b><a href="../man7/inode.7.html">inode</a></b>(7), <b><a href="../man7/symlink.7.html">symlink</a></b>(7)

Linux man-pages 6.9.1                              2024-06-15                                            <u><a href="../man2/stat.2.html">stat</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>