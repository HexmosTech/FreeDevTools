<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>s390_guarded_storage - operations with z/Architecture guarded storage facility</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       s390_guarded_storage - operations with z/Architecture guarded storage facility

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;asm/guarded_storage.h&gt;</b> /* Definition of <b>GS_*</b> constants */
       <b>#include</b> <b>&lt;sys/syscall.h&gt;</b>         /* Definition of <b>SYS_*</b> constants */
       <b>#include</b> <b>&lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;</b>

       <b>int</b> <b>syscall(SYS_s390_guarded_storage,</b> <b>int</b> <u>command</u><b>,</b>
                   <b>struct</b> <b>gs_cb</b> <b>*</b><u>gs_cb</u><b>);</b>

       <u>Note</u>: glibc provides no wrapper for <b>s390_guarded_storage</b>(), necessitating the use of <b><a href="../man2/syscall.2.html">syscall</a></b>(2).

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>s390_guarded_storage</b>() system call enables the use of the Guarded Storage Facility (a z/Architecture-
       specific feature) for user-space processes.

       The  guarded  storage  facility  is a hardware feature that allows marking up to 64 memory regions (as of
       z14) as guarded; reading a pointer with a newly introduced "Load Guarded"  (LGG)  or  "Load  Logical  and
       Shift  Guarded"  (LLGFSG)  instructions  will  cause  a  range  check  on  the  loaded value and invoke a
       (previously set up) user-space handler if one of the guarded regions is affected.

       The <u>command</u> argument indicates which function to perform.  The following commands are supported:

       <b>GS_ENABLE</b>
              Enable the guarded storage facility for the calling task.  The  initial  content  of  the  guarded
              storage  control  block  will  be  all zeros.  After enablement, user-space code can use the "Load
              Guarded Storage Controls" (LGSC) instruction (or the <b>load_gs_cb</b>() function wrapper provided in the
              <u>asm/guarded_storage.h</u> header) to load an arbitrary control block.  While a task  is  enabled,  the
              kernel  will  save  and  restore  the  calling content of the guarded storage registers on context
              switch.

       <b>GS_DISABLE</b>
              Disables the use of the guarded storage facility for the calling task.  The kernel will  cease  to
              save  and restore the content of the guarded storage registers, the task-specific content of these
              registers is lost.

       <b>GS_SET_BC_CB</b>
              Set a broadcast guarded storage control block to the one provided in the <u>gs_cb</u> argument.  This  is
              called  per  thread and associates a specific guarded storage control block with the calling task.
              This control block will be used in the broadcast command <b>GS_BROADCAST</b>.

       <b>GS_CLEAR_BC_CB</b>
              Clears the broadcast guarded storage control block.  The guarded storage  control  block  will  no
              longer have the association established by the <b>GS_SET_BC_CB</b> command.

       <b>GS_BROADCAST</b>
              Sends  a broadcast to all thread siblings of the calling task.  Every sibling that has established
              a broadcast guarded storage control block will load this control block and  will  be  enabled  for
              guarded  storage.   The  broadcast  guarded  storage control block is consumed; a second broadcast
              without a refresh of the stored control block with <b>GS_SET_BC_CB</b> will not have any effect.

       The <u>gs_cb</u> argument specifies the address of a guarded storage control block structure  and  is  currently
       used only by the <b>GS_SET_BC_CB</b> command; all other aforementioned commands ignore this argument.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, the return value of <b>s390_guarded_storage</b>() is 0.

       On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EFAULT</b> <u>command</u> was <b>GS_SET_BC_CB</b> and the copying of the guarded storage control block structure pointed by
              the <u>gs_cb</u> argument has failed.

       <b>EINVAL</b> The value provided in the <u>command</u> argument was not valid.

       <b>ENOMEM</b> <u>command</u>  was one of <b>GS_ENABLE</b> or <b>GS_SET_BC_CB</b>, and the allocation of a new guarded storage control
              block has failed.

       <b>EOPNOTSUPP</b>
              The guarded storage facility is not supported by the hardware.

</pre><h4><b>STANDARDS</b></h4><pre>
       Linux on s390.

</pre><h4><b>HISTORY</b></h4><pre>
       Linux 4.12.  System z14.

</pre><h4><b>NOTES</b></h4><pre>
       The description of the guarded storage facility along  with  related  instructions  and  Guarded  Storage
       Control  Block and Guarded Storage Event Parameter List structure layouts is available in "z/Architecture
       Principles of Operations" beginning from the twelfth edition.

       The <u>gs_cb</u> structure has a field <u>gsepla</u> (Guarded Storage Event Parameter List Address), which is  a  user-
       space  pointer  to  a  Guarded  Storage  Event Parameter List structure (that contains the address of the
       aforementioned event handler in the <u>gseha</u> field), and its layout is available as a <b>gs_epl</b> structure  type
       definition in the <u>asm/guarded_storage.h</u> header.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/syscall.2.html">syscall</a></b>(2)

Linux man-pages 6.9.1                              2024-05-02                            <u><a href="../man2/s390_guarded_storage.2.html">s390_guarded_storage</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>