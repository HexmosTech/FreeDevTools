<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ioprio_get, ioprio_set - get/set I/O scheduling class and priority</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ioprio_get, ioprio_set - get/set I/O scheduling class and priority

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/linux/ioprio.h">linux/ioprio.h</a>&gt;</b>    /* Definition of <b>IOPRIO_*</b> constants */
       <b>#include</b> <b>&lt;sys/syscall.h&gt;</b>     /* Definition of <b>SYS_*</b> constants */
       <b>#include</b> <b>&lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;</b>

       <b>int</b> <b>syscall(SYS_ioprio_get,</b> <b>int</b> <u>which</u><b>,</b> <b>int</b> <u>who</u><b>);</b>
       <b>int</b> <b>syscall(SYS_ioprio_set,</b> <b>int</b> <u>which</u><b>,</b> <b>int</b> <u>who</u><b>,</b> <b>int</b> <u>ioprio</u><b>);</b>

       <u>Note</u>: glibc provides no wrappers for these system calls, necessitating the use of <b><a href="../man2/syscall.2.html">syscall</a></b>(2).

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>ioprio_get</b>()  and <b>ioprio_set</b>() system calls get and set the I/O scheduling class and priority of one
       or more threads.

       The <u>which</u> and <u>who</u> arguments identify the thread(s) on which the system calls operate.  The <u>which</u> argument
       determines how <u>who</u> is interpreted, and has one of the following values:

       <b>IOPRIO_WHO_PROCESS</b>
              <u>who</u> is a process ID or thread ID identifying a single process  or  thread.   If  <u>who</u>  is  0,  then
              operate on the calling thread.

       <b>IOPRIO_WHO_PGRP</b>
              <u>who</u>  is  a  process  group  ID  identifying all the members of a process group.  If <u>who</u> is 0, then
              operate on the process group of which the caller is a member.

       <b>IOPRIO_WHO_USER</b>
              <u>who</u> is a user ID identifying all of the processes that have a matching real UID.

       If <u>which</u> is specified as <b>IOPRIO_WHO_PGRP</b> or <b>IOPRIO_WHO_USER</b> when calling <b>ioprio_get</b>(), and more than  one
       process  matches  <u>who</u>, then the returned priority will be the highest one found among all of the matching
       processes.  One priority is said to be higher than another one if it belongs to a higher  priority  class
       (<b>IOPRIO_CLASS_RT</b>  is the highest priority class; <b>IOPRIO_CLASS_IDLE</b> is the lowest) or if it belongs to the
       same priority class as the other process but has a higher priority level (a lower priority number means a
       higher priority level).

       The <u>ioprio</u> argument given to <b>ioprio_set</b>() is a bit mask that specifies both the scheduling class and  the
       priority  to  be  assigned  to  the target process(es).  The following macros are used for assembling and
       dissecting <u>ioprio</u> values:

       <b>IOPRIO_PRIO_VALUE(</b><u>class</u><b>,</b> <u>data</u><b>)</b>
              Given a scheduling <u>class</u> and priority (<u>data</u>), this macro combines the two  values  to  produce  an
              <u>ioprio</u> value, which is returned as the result of the macro.

       <b>IOPRIO_PRIO_CLASS(</b><u>mask</u><b>)</b>
              Given  <u>mask</u>  (an  <u>ioprio</u>  value),  this macro returns its I/O class component, that is, one of the
              values <b>IOPRIO_CLASS_RT</b>, <b>IOPRIO_CLASS_BE</b>, or <b>IOPRIO_CLASS_IDLE</b>.

       <b>IOPRIO_PRIO_DATA(</b><u>mask</u><b>)</b>
              Given <u>mask</u> (an <u>ioprio</u> value), this macro returns its priority (<u>data</u>) component.

       See the NOTES section for more information on scheduling classes and priorities, as well as  the  meaning
       of specifying <u>ioprio</u> as 0.

       I/O priorities are supported for reads and for synchronous (<b>O_DIRECT</b>, <b>O_SYNC</b>) writes.  I/O priorities are
       not supported for asynchronous writes because they are issued outside the context of the program dirtying
       the memory, and thus program-specific priorities do not apply.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On  success, <b>ioprio_get</b>() returns the <u>ioprio</u> value of the process with highest I/O priority of any of the
       processes that match the criteria specified in <u>which</u> and <u>who</u>.  On error, -1 is returned, and <u>errno</u> is set
       to indicate the error.

       On success, <b>ioprio_set</b>() returns 0.  On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EINVAL</b> Invalid value for <u>which</u> or <u>ioprio</u>.  Refer to the NOTES section for available scheduler classes and
              priority levels for <u>ioprio</u>.

       <b>EPERM</b>  The calling process does not have the privilege needed to assign  this  <u>ioprio</u>  to  the  specified
              process(es).  See the NOTES section for more information on required privileges for <b>ioprio_set</b>().

       <b>ESRCH</b>  No process(es) could be found that matched the specification in <u>which</u> and <u>who</u>.

</pre><h4><b>STANDARDS</b></h4><pre>
       Linux.

</pre><h4><b>HISTORY</b></h4><pre>
       Linux 2.6.13.

</pre><h4><b>NOTES</b></h4><pre>
       Two  or  more  processes  or  threads  can share an I/O context.  This will be the case when <b><a href="../man2/clone.2.html">clone</a></b>(2) was
       called with the <b>CLONE_IO</b> flag.  However, by default, the distinct threads of a process will <b>not</b> share the
       same I/O context.  This means that if you want to change the I/O priority of all threads  in  a  process,
       you  may  need  to  call <b>ioprio_set</b>() on each of the threads.  The thread ID that you would need for this
       operation is the one that is returned by <b><a href="../man2/gettid.2.html">gettid</a></b>(2) or <b><a href="../man2/clone.2.html">clone</a></b>(2).

       These system calls have an effect only when used in conjunction with an I/O scheduler that  supports  I/O
       priorities.   As  at  kernel  2.6.17  the  only  such  scheduler is the Completely Fair Queuing (CFQ) I/O
       scheduler.

       If no I/O scheduler has been set for a thread, then by default the I/O priority will follow the CPU  nice
       value (<b><a href="../man2/setpriority.2.html">setpriority</a></b>(2)).  Before Linux 2.6.24, once an I/O priority had been set using <b>ioprio_set</b>(), there
       was no way to reset the I/O scheduling behavior to the default.  Since Linux 2.6.24, specifying <u>ioprio</u> as
       0 can be used to reset to the default I/O scheduling behavior.

   <b>Selecting</b> <b>an</b> <b>I/O</b> <b>scheduler</b>
       I/O schedulers are selected on a per-device basis via the special file <u><a href="file:/sys/block/">/sys/block/</a></u>device<u>/queue/scheduler</u>.

       One  can  view  the  current  I/O  scheduler via the <u><a href="file:/sys">/sys</a></u> filesystem.  For example, the following command
       displays a list of all schedulers currently loaded in the kernel:

           $ <b>cat</b> <b>/sys/block/sda/queue/scheduler</b>
           noop anticipatory deadline [cfq]

       The scheduler surrounded by brackets is the one actually in use for the  device  (<u>sda</u>  in  the  example).
       Setting  another  scheduler  is done by writing the name of the new scheduler to this file.  For example,
       the following command will set the scheduler for the <u>sda</u> device to <u>cfq</u>:

           $ <b>su</b>
           Password:
           # <b>echo</b> <b>cfq</b> <b>&gt;</b> <b>/sys/block/sda/queue/scheduler</b>

   <b>The</b> <b>Completely</b> <b>Fair</b> <b>Queuing</b> <b>(CFQ)</b> <b>I/O</b> <b>scheduler</b>
       Since version 3 (also known as CFQ Time Sliced), CFQ implements I/O nice levels similar to those  of  CPU
       scheduling.  These nice levels are grouped into three scheduling classes, each one containing one or more
       priority levels:

       <b>IOPRIO_CLASS_RT</b> (1)
              This  is  the  real-time I/O class.  This scheduling class is given higher priority than any other
              class: processes from this class are given first access to the disk every time.   Thus,  this  I/O
              class  needs  to  be  used with some care: one I/O real-time process can starve the entire system.
              Within the real-time class, there are 8 levels of class data (priority) that determine exactly how
              much time this process needs the disk for on each service.  The highest real-time  priority  level
              is  0;  the  lowest  is  7.   In  the  future,  this  might change to be more directly mappable to
              performance, by passing in a desired data rate instead.

       <b>IOPRIO_CLASS_BE</b> (2)
              This is the best-effort scheduling class, which is the default for any process that hasn't  set  a
              specific  I/O  priority.   The class data (priority) determines how much I/O bandwidth the process
              will get.  Best-effort priority levels are analogous to CPU nice values (see <b><a href="../man2/getpriority.2.html">getpriority</a></b>(2)).  The
              priority level determines a priority relative to other processes  in  the  best-effort  scheduling
              class.  Priority levels range from 0 (highest) to 7 (lowest).

       <b>IOPRIO_CLASS_IDLE</b> (3)
              This  is the idle scheduling class.  Processes running at this level get I/O time only when no one
              else needs the disk.  The idle class has no class data.  Attention is required when assigning this
              priority class to a process, since  it  may  become  starved  if  higher  priority  processes  are
              constantly accessing the disk.

       Refer  to  the  kernel  source  file  <u>Documentation/block/ioprio.txt</u>  for more information on the CFQ I/O
       Scheduler and an example program.

   <b>Required</b> <b>permissions</b> <b>to</b> <b>set</b> <b>I/O</b> <b>priorities</b>
       Permission to change a process's priority is granted or denied based on two criteria:

       <b>Process</b> <b>ownership</b>
              An unprivileged process may set the I/O priority only for a process whose  real  UID  matches  the
              real or effective UID of the calling process.  A process which has the <b>CAP_SYS_NICE</b> capability can
              change the priority of any process.

       <b>What</b> <b>is</b> <b>the</b> <b>desired</b> <b>priority</b>
              Attempts  to  set very high priorities (<b>IOPRIO_CLASS_RT</b>) require the <b>CAP_SYS_ADMIN</b> capability.  Up
              to Linux 2.6.24 also required <b>CAP_SYS_ADMIN</b> to set a very low  priority  (<b>IOPRIO_CLASS_IDLE</b>),  but
              since Linux 2.6.25, this is no longer required.

       A call to <b>ioprio_set</b>() must follow both rules, or the call will fail with the error <b>EPERM</b>.

</pre><h4><b>BUGS</b></h4><pre>
       glibc  does  not yet provide a suitable header file defining the function prototypes and macros described
       on this page.  Suitable definitions can be found in <u>linux/ioprio.h</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/ionice.1.html">ionice</a></b>(1), <b><a href="../man2/getpriority.2.html">getpriority</a></b>(2), <b><a href="../man2/open.2.html">open</a></b>(2), <b><a href="../man7/capabilities.7.html">capabilities</a></b>(7), <b><a href="../man7/cgroups.7.html">cgroups</a></b>(7)

       <u>Documentation/block/ioprio.txt</u> in the Linux kernel source tree

Linux man-pages 6.9.1                              2024-05-02                                      <u><a href="../man2/ioprio_set.2.html">ioprio_set</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>