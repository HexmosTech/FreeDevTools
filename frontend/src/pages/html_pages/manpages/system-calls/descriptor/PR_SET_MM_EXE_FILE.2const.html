<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PR_SET_MM_EXE_FILE - modify kernel memory map descriptor fields</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       PR_SET_MM_EXE_FILE - modify kernel memory map descriptor fields

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/linux/prctl.h">linux/prctl.h</a>&gt;</b>  /* Definition of <b>PR_*</b> constants */
       <b>#include</b> <b>&lt;sys/prctl.h&gt;</b>

       <b>int</b> <b>prctl(PR_SET_MM,</b> <b>PR_SET_MM_EXE_FILE,</b> <b>long</b> <u>fd</u><b>,</b> <b>0L,</b> <b>0L);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Supersede  the <u><a href="file:/proc/">/proc/</a></u>pid<u>/exe</u> symbolic link with a new one pointing to a new executable file identified by
       the file descriptor provided in the <u>fd</u> argument.  The file descriptor should be obtained with  a  regular
       <b><a href="../man2/open.2.html">open</a></b>(2) call.

       To  change  the  symbolic  link, one needs to unmap all existing executable memory areas, including those
       created by the kernel itself (for example the kernel usually creates at least one executable memory  area
       for the ELF <u>.text</u> section).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, 0 is returned.  On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EACCES</b> The file is not executable.

       <b>EBADF</b>  The file descriptor passed in <u>fd</u> is not valid.

       <b>EBUSY</b>  This the second attempt to change the <u><a href="file:/proc/">/proc/</a></u>pid<u>/exe</u> symbolic link.

</pre><h4><b>FILES</b></h4><pre>
       <u><a href="file:/proc/">/proc/</a></u>pid<u>/exe</u>

</pre><h4><b>STANDARDS</b></h4><pre>
       Linux.

</pre><h4><b>HISTORY</b></h4><pre>
       Linux 3.5.

       In  Linux  4.9  and  earlier,  the <b>PR_SET_MM_EXE_FILE</b> operation can be performed only once in a process's
       lifetime; attempting to perform the operation a second time results in the error <b>EPERM</b>.  This restriction
       was enforced for security reasons that were subsequently deemed specious, and the restriction was removed
       in Linux 4.10 because some user-space applications needed to perform this operation more than once.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/prctl.2.html">prctl</a></b>(2), <b><a href="../man2const/PR_SET_MM.2const.html">PR_SET_MM</a></b>(2const), <b><a href="../man5/proc_pid_exe.5.html">proc_pid_exe</a></b>(5)

Linux man-pages 6.9.1                              2024-06-01                         <u><a href="../man2const/PR_SET_MM_EXE_FILE.2const.html">PR_SET_MM_EXE_FILE</a></u>(2const)
</pre>
 </div>
</div></section>
</div>
</body>
</html>