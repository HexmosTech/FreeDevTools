<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>spu_create - create a new spu context</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       spu_create - create a new spu context

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/spu.h&gt;</b>          /* Definition of <b>SPU_*</b> constants */
       <b>#include</b> <b>&lt;sys/syscall.h&gt;</b>      /* Definition of <b>SYS_*</b> constants */
       <b>#include</b> <b>&lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;</b>

       <b>int</b> <b>syscall(SYS_spu_create,</b> <b>const</b> <b>char</b> <b>*</b><u>pathname</u><b>,</b> <b>unsigned</b> <b>int</b> <u>flags</u><b>,</b>
                   <b>mode_t</b> <u>mode</u><b>,</b> <b>int</b> <u>neighbor_fd</u><b>);</b>

       <u>Note</u>: glibc provides no wrapper for <b>spu_create</b>(), necessitating the use of <b><a href="../man2/syscall.2.html">syscall</a></b>(2).

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>spu_create</b>()  system  call  is  used  on  PowerPC  machines that implement the Cell Broadband Engine
       Architecture in order to access Synergistic Processor Units (SPUs).  It creates a new logical context for
       an SPU in <u>pathname</u> and returns  a  file  descriptor  associated  with  it.   <u>pathname</u>  must  refer  to  a
       nonexistent directory in the mount point of the SPU filesystem (<b>spufs</b>).  If <b>spu_create</b>() is successful, a
       directory is created at <u>pathname</u> and it is populated with the files described in <b><a href="../man7/spufs.7.html">spufs</a></b>(7).

       When  a  context  is  created, the returned file descriptor can only be passed to <b><a href="../man2/spu_run.2.html">spu_run</a></b>(2), used as the
       <u>dirfd</u> argument to the <b>*at</b> family of system calls (e.g., <b><a href="../man2/openat.2.html">openat</a></b>(2)), or closed; other operations  are  not
       defined.   A logical SPU context is destroyed (along with all files created within the context's <u>pathname</u>
       directory) once the last reference to the context has gone; this usually occurs when the file  descriptor
       returned by <b>spu_create</b>() is closed.

       The  <u>mode</u>  argument  (minus  any  bits  set in the process's <b><a href="../man2/umask.2.html">umask</a></b>(2)) specifies the permissions used for
       creating the new directory in <b>spufs</b>.  See <b><a href="../man2/stat.2.html">stat</a></b>(2) for a full list of the possible <u>mode</u> values.

       The <u>neighbor_fd</u> is used only when the <b>SPU_CREATE_AFFINITY_SPU</b> flag is specified; see below.

       The <u>flags</u> argument can be zero or any bitwise OR-ed combination of the following constants:

       <b>SPU_CREATE_EVENTS_ENABLED</b>
              Rather than using signals for reporting DMA errors, use the <u>event</u> argument to <b><a href="../man2/spu_run.2.html">spu_run</a></b>(2).

       <b>SPU_CREATE_GANG</b>
              Create an SPU gang instead of a context.  (A gang is a group of SPU contexts that are functionally
              related to each other and which share common scheduling parametersâ€”priority and  policy.   In  the
              future, gang scheduling may be implemented causing the group to be switched in and out as a single
              unit.)

              A new directory will be created at the location specified by the <u>pathname</u> argument.  This gang may
              be  used  to hold other SPU contexts, by providing a pathname that is within the gang directory to
              further calls to <b>spu_create</b>().

       <b>SPU_CREATE_NOSCHED</b>
              Create a context that is not affected by the SPU scheduler.  Once the context is run, it will  not
              be scheduled out until it is destroyed by the creating process.

              Because  the  context  cannot  be  removed  from  the  SPU,  some  functionality  is  disabled for
              <b>SPU_CREATE_NOSCHED</b> contexts.  Only a subset of  the  files  will  be  available  in  this  context
              directory  in  <b>spufs</b>.   Additionally,  <b>SPU_CREATE_NOSCHED</b>  contexts  cannot  dump a core file when
              crashing.

              Creating <b>SPU_CREATE_NOSCHED</b> contexts requires the <b>CAP_SYS_NICE</b> capability.

       <b>SPU_CREATE_ISOLATE</b>
              Create an isolated SPU context.  Isolated contexts are protected from some PPE (PowerPC Processing
              Element) operations, such as access to the SPU local store and the NPC register.

              Creating <b>SPU_CREATE_ISOLATE</b> contexts also requires the <b>SPU_CREATE_NOSCHED</b> flag.

       <b>SPU_CREATE_AFFINITY_SPU</b> (since Linux 2.6.23)
              Create a context with affinity to another SPU context.  This affinity information is  used  within
              the  SPU  scheduling  algorithm.  Using this flag requires that a file descriptor referring to the
              other SPU context be passed in the <u>neighbor_fd</u> argument.

       <b>SPU_CREATE_AFFINITY_MEM</b> (since Linux 2.6.23)
              Create a context with affinity to system memory.  This affinity information is used within the SPU
              scheduling algorithm.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, <b>spu_create</b>() returns a new file descriptor.  On failure, -1 is returned, and <u>errno</u> is set  to
       indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EACCES</b> The current user does not have write access to the <b><a href="../man7/spufs.7.html">spufs</a></b>(7) mount point.

       <b>EEXIST</b> An SPU context already exists at the given pathname.

       <b>EFAULT</b> <u>pathname</u> is not a valid string pointer in the calling process's address space.

       <b>EINVAL</b> <u>pathname</u> is not a directory in the <b><a href="../man7/spufs.7.html">spufs</a></b>(7) mount point, or invalid flags have been provided.

       <b>ELOOP</b>  Too many symbolic links were found while resolving <u>pathname</u>.

       <b>EMFILE</b> The per-process limit on the number of open file descriptors has been reached.

       <b>ENAMETOOLONG</b>
              <u>pathname</u> is too long.

       <b>ENFILE</b> The system-wide limit on the total number of open files has been reached.

       <b>ENODEV</b> An isolated context was requested, but the hardware does not support SPU isolation.

       <b>ENOENT</b> Part of <u>pathname</u> could not be resolved.

       <b>ENOMEM</b> The kernel could not allocate all resources required.

       <b>ENOSPC</b> There  are  not  enough SPU resources available to create a new context or the user-specific limit
              for the number of SPU contexts has been reached.

       <b>ENOSYS</b> The functionality is not provided by the current system, because  either  the  hardware  does  not
              provide SPUs or the spufs module is not loaded.

       <b>ENOTDIR</b>
              A part of <u>pathname</u> is not a directory.

       <b>EPERM</b>  The  <b>SPU_CREATE_NOSCHED</b>  flag  has  been  given,  but  the  user  does  not  have the <b>CAP_SYS_NICE</b>
              capability.

</pre><h4><b>FILES</b></h4><pre>
       <u>pathname</u> must point to a location beneath the mount point of <b>spufs</b>.  By convention, it  gets  mounted  in
       <u>/spu</u>.

</pre><h4><b>STANDARDS</b></h4><pre>
       Linux on PowerPC.

</pre><h4><b>HISTORY</b></h4><pre>
       Linux 2.6.16.

       Prior  to  the addition of the <b>SPU_CREATE_AFFINITY_SPU</b> flag in Linux 2.6.23, the <b>spu_create</b>() system call
       took only three arguments (i.e., there was no <u>neighbor_fd</u> argument).

</pre><h4><b>NOTES</b></h4><pre>
       <b>spu_create</b>() is meant to be used from libraries that implement a more abstract interface to SPUs, not  to
       be  used  from  regular  applications.  See <a href="http://www.bsc.es/projects/deepcomputing/linuxoncell/">http://www.bsc.es/projects/deepcomputing/linuxoncell/</a> for the
       recommended libraries.

</pre><h4><b>EXAMPLES</b></h4><pre>
       See <b><a href="../man2/spu_run.2.html">spu_run</a></b>(2) for an example of the use of <b>spu_create</b>()

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/close.2.html">close</a></b>(2), <b><a href="../man2/spu_run.2.html">spu_run</a></b>(2), <b><a href="../man7/capabilities.7.html">capabilities</a></b>(7), <b><a href="../man7/spufs.7.html">spufs</a></b>(7)

Linux man-pages 6.9.1                              2024-05-02                                      <u><a href="../man2/spu_create.2.html">spu_create</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>