<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aa_is_enabled - determine if apparmor is available</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libapparmor-dev">libapparmor-dev_4.1.1-0ubuntu6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       aa_is_enabled - determine if apparmor is available

       aa_find_mountpoint - find where the apparmor interface filesystem is mounted

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/apparmor.h&gt;</b>

       <b>int</b> <b>aa_is_enabled(void);</b>

       <b>int</b> <b>aa_find_mountpoint(char</b> <b>**mnt);</b>

       Link with <b>-lapparmor</b> when compiling.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The aa_is_enabled function returns true (1) if apparmor is enabled.  If it isn't it sets the <b><a href="../man3/errno.3.html">errno</a></b>(3) to
       reflect the reason it is not enabled and returns 0.

       The aa_find_mountpoint function finds where the apparmor filesystem is mounted on the system, and returns
       a string containing the mount path.  It is the caller's responsibility to <b><a href="../man3/free.3.html">free</a></b>(3) the returned path.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>aa_is_enabled</b> On success 1 is returned. On error, 0 is returned, and <b><a href="../man3/errno.3.html">errno</a></b>(3) is set appropriately.

       <b>aa_find_mountpoint</b> On success zero is returned. On error, -1 is returned, and <b><a href="../man3/errno.3.html">errno</a></b>(3) is set
       appropriately.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>aa_is_enabled</b>

       <b>ENOSYS</b>
           AppArmor extensions to the system are not available.

       <b>ECANCELED</b>
           AppArmor is available on the system but has been disabled at boot.

       <b>EBUSY</b>
           AppArmor is available but only via private interfaces.

       <b>ENOENT</b>
           AppArmor is available (and maybe even enforcing policy) but the interface is not available.

       <b>ENOMEM</b>
           Insufficient memory was available.

       <b>EPERM</b>
           Did not have sufficient permissions to determine if AppArmor is enabled.

       <b>EACCES</b>
           Did not have sufficient permissions to determine if AppArmor is enabled.

       <b>EBUSY</b>
           AppArmor  is  enabled  but does not have access to shared interfaces, and only private interfaces are
           available.

       <b>aa_find_mountpoint</b>

       <b>ENOMEM</b>
           Insufficient memory was available.

       <b>EACCES</b>
           Access to the required paths was denied.

       <b>ENOENT</b>
           The apparmor filesystem mount could not be found

</pre><h4><b>BUGS</b></h4><pre>
       None known. If you find any, please report them at &lt;https://gitlab.com/apparmor/apparmor/-/issues&gt;.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/apparmor.7.html">apparmor</a></b>(7), <b><a href="../man5/apparmor.d.5.html">apparmor.d</a></b>(5), <b><a href="../man8/apparmor_parser.8.html">apparmor_parser</a></b>(8), and &lt;https://wiki.apparmor.net&gt;.

AppArmor 4.1.1                                     2025-07-23                              <u><a href="../man2/AA_FIND_MOUNTPOINT.2.html">AA_FIND_MOUNTPOINT</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>