<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>execveat - execute program relative to a directory file descriptor</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       execveat - execute program relative to a directory file descriptor

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/linux/fcntl.h">linux/fcntl.h</a>&gt;</b>      /* Definition of <b>AT_*</b> constants */
       <b>#include</b> <b>&lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;</b>

       <b>int</b> <b>execveat(int</b> <u>dirfd</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>pathname</u><b>,</b>
                    <b>char</b> <b>*const</b> <b>_Nullable</b> <u>argv</u><b>[],</b>
                    <b>char</b> <b>*const</b> <b>_Nullable</b> <u>envp</u><b>[],</b>
                    <b>int</b> <u>flags</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>execveat</b>() system call executes the program referred to by the combination of <u>dirfd</u> and <u>pathname</u>.  It
       operates in exactly the same way as <b><a href="../man2/execve.2.html">execve</a></b>(2), except for the differences described in this manual page.

       If  the pathname given in <u>pathname</u> is relative, then it is interpreted relative to the directory referred
       to by the file descriptor <u>dirfd</u> (rather than relative to the current working  directory  of  the  calling
       process, as is done by <b><a href="../man2/execve.2.html">execve</a></b>(2) for a relative pathname).

       If <u>pathname</u> is relative and <u>dirfd</u> is the special value <b>AT_FDCWD</b>, then <u>pathname</u> is interpreted relative to
       the current working directory of the calling process (like <b><a href="../man2/execve.2.html">execve</a></b>(2)).

       If <u>pathname</u> is absolute, then <u>dirfd</u> is ignored.

       If  <u>pathname</u>  is  an empty string and the <b>AT_EMPTY_PATH</b> flag is specified, then the file descriptor <u>dirfd</u>
       specifies the file to be executed (i.e., <u>dirfd</u> refers to an executable file, rather than a directory).

       The <u>flags</u> argument is a bit mask that can include zero or more of the following flags:

       <b>AT_EMPTY_PATH</b>
              If <u>pathname</u> is an empty string, operate on the file referred to by  <u>dirfd</u>  (which  may  have  been
              obtained using the <b><a href="../man2/open.2.html">open</a></b>(2) <b>O_PATH</b> flag).

       <b>AT_SYMLINK_NOFOLLOW</b>
              If  the  file  identified by <u>dirfd</u> and a non-NULL <u>pathname</u> is a symbolic link, then the call fails
              with the error <b>ELOOP</b>.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, <b>execveat</b>() does not return.  On error, -1 is returned, and  <u>errno</u>  is  set  to  indicate  the
       error.

</pre><h4><b>ERRORS</b></h4><pre>
       The  same errors that occur for <b><a href="../man2/execve.2.html">execve</a></b>(2) can also occur for <b>execveat</b>().  The following additional errors
       can occur for <b>execveat</b>():

       <u>pathname</u>
              is relative but <u>dirfd</u> is neither <b>AT_FDCWD</b> nor a valid file descriptor.

       <b>EINVAL</b> Invalid flag specified in <u>flags</u>.

       <b>ELOOP</b>  <u>flags</u> includes <b>AT_SYMLINK_NOFOLLOW</b> and the file identified by <u>dirfd</u> and a non-NULL <u>pathname</u>  is  a
              symbolic link.

       <b>ENOENT</b> The program identified by <u>dirfd</u> and <u>pathname</u> requires the use of an interpreter program (such as a
              script starting with "#!"), but the file descriptor <u>dirfd</u> was opened with the <b>O_CLOEXEC</b> flag, with
              the result that the program file is inaccessible to the launched interpreter.  See BUGS.

       <b>ENOTDIR</b>
              <u>pathname</u> is relative and <u>dirfd</u> is a file descriptor referring to a file other than a directory.

</pre><h4><b>STANDARDS</b></h4><pre>
       Linux.

</pre><h4><b>HISTORY</b></h4><pre>
       Linux 3.19, glibc 2.34.

</pre><h4><b>NOTES</b></h4><pre>
       In  addition  to  the  reasons explained in <b><a href="../man2/openat.2.html">openat</a></b>(2), the <b>execveat</b>() system call is also needed to allow
       <b><a href="../man3/fexecve.3.html">fexecve</a></b>(3) to be implemented on systems that do not have the <u><a href="file:/proc">/proc</a></u> filesystem mounted.

       When asked to execute a script file, the <u>argv[0]</u> that is passed to the script interpreter is a string  of
       the  form  <u>/dev/fd/N</u>  or  <u>/dev/fd/N/P</u>,  where <u>N</u> is the number of the file descriptor passed via the <u>dirfd</u>
       argument.  A string of the first form occurs when <b>AT_EMPTY_PATH</b> is employed.  A string of the second form
       occurs when the script is specified via both <u>dirfd</u> and <u>pathname</u>; in this case, <u>P</u> is the  value  given  in
       <u>pathname</u>.

       For  the  same  reasons  described  in  <b><a href="../man3/fexecve.3.html">fexecve</a></b>(3), the natural idiom when using <b>execveat</b>() is to set the
       close-on-exec flag on <u>dirfd</u>.  (But see BUGS.)

</pre><h4><b>BUGS</b></h4><pre>
       The <b>ENOENT</b> error described above means that it is not possible to set the close-on-exec flag on the  file
       descriptor given to a call of the form:

           execveat(fd, "", argv, envp, AT_EMPTY_PATH);

       However, the inability to set the close-on-exec flag means that a file descriptor referring to the script
       leaks through to the script itself.  As well as wasting a file descriptor, this leakage can lead to file-
       descriptor exhaustion in scenarios where scripts recursively employ <b>execveat</b>().

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/execve.2.html">execve</a></b>(2), <b><a href="../man2/openat.2.html">openat</a></b>(2), <b><a href="../man3/fexecve.3.html">fexecve</a></b>(3)

Linux man-pages 6.9.1                              2024-05-02                                        <u><a href="../man2/execveat.2.html">execveat</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>