<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>epoll_ctl - control interface for an epoll file descriptor</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       epoll_ctl - control interface for an epoll file descriptor

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/epoll.h&gt;</b>

       <b>int</b> <b>epoll_ctl(int</b> <u>epfd</u><b>,</b> <b>int</b> <u>op</u><b>,</b> <b>int</b> <u>fd</u><b>,</b>
                     <b>struct</b> <b>epoll_event</b> <b>*_Nullable</b> <u>event</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  system call is used to add, modify, or remove entries in the interest list of the <b><a href="../man7/epoll.7.html">epoll</a></b>(7) instance
       referred to by the file descriptor <u>epfd</u>.  It requests that the operation <u>op</u> be performed for  the  target
       file descriptor, <u>fd</u>.

       Valid values for the <u>op</u> argument are:

       <b>EPOLL_CTL_ADD</b>
              Add an entry to the interest list of the epoll file descriptor, <u>epfd</u>.  The entry includes the file
              descriptor, <u>fd</u>, a reference to the corresponding open file description (see <b><a href="../man7/epoll.7.html">epoll</a></b>(7) and <b><a href="../man2/open.2.html">open</a></b>(2)),
              and the settings specified in <u>event</u>.

       <b>EPOLL_CTL_MOD</b>
              Change  the  settings  associated  with  <u>fd</u>  in the interest list to the new settings specified in
              <u>event</u>.

       <b>EPOLL_CTL_DEL</b>
              Remove (deregister) the target file descriptor <u>fd</u> from the interest list.  The <u>event</u>  argument  is
              ignored and can be NULL (but see BUGS below).

       The  <u>event</u>  argument  describes  the  object linked to the file descriptor <u>fd</u>.  The <u>struct</u> <u>epoll_event</u> is
       described in <b><a href="../man3type/epoll_event.3type.html">epoll_event</a></b>(3type).

       The <u>data</u> member of the <u>epoll_event</u> structure specifies data that the kernel should save and  then  return
       (via <b><a href="../man2/epoll_wait.2.html">epoll_wait</a></b>(2)) when this file descriptor becomes ready.

       The  <u>events</u>  member  of  the  <u>epoll_event</u> structure is a bit mask composed by ORing together zero or more
       event types, returned by <b><a href="../man2/epoll_wait.2.html">epoll_wait</a></b>(2), and input flags, which affect its behaviour, but aren't returned.
       The available event types are:

       <b>EPOLLIN</b>
              The associated file is available for <b><a href="../man2/read.2.html">read</a></b>(2) operations.

       <b>EPOLLOUT</b>
              The associated file is available for <b><a href="../man2/write.2.html">write</a></b>(2) operations.

       <b>EPOLLRDHUP</b> (since Linux 2.6.17)
              Stream socket peer closed connection, or shut down writing half  of  connection.   (This  flag  is
              especially  useful  for  writing  simple  code  to  detect peer shutdown when using edge-triggered
              monitoring.)

       <b>EPOLLPRI</b>
              There is an exceptional condition on the file  descriptor.   See  the  discussion  of  <b>POLLPRI</b>  in
              <b><a href="../man2/poll.2.html">poll</a></b>(2).

       <b>EPOLLERR</b>
              Error  condition  happened on the associated file descriptor.  This event is also reported for the
              write end of a pipe when the read end has been closed.

              <b><a href="../man2/epoll_wait.2.html">epoll_wait</a></b>(2) will always report for this event; it is not necessary to  set  it  in  <u>events</u>  when
              calling <b>epoll_ctl</b>().

       <b>EPOLLHUP</b>
              Hang up happened on the associated file descriptor.

              <b><a href="../man2/epoll_wait.2.html">epoll_wait</a></b>(2)  will  always  wait  for  this  event;  it is not necessary to set it in <u>events</u> when
              calling <b>epoll_ctl</b>().

              Note that when reading from a channel such as a  pipe  or  a  stream  socket,  this  event  merely
              indicates  that  the  peer  closed its end of the channel.  Subsequent reads from the channel will
              return 0 (end of file) only after all outstanding data in the channel has been consumed.

       And the available input flags are:

       <b>EPOLLET</b>
              Requests edge-triggered notification for the associated file descriptor.  The default behavior for
              <b>epoll</b> is level-triggered.  See <b><a href="../man7/epoll.7.html">epoll</a></b>(7) for more detailed  information  about  edge-triggered  and
              level-triggered notification.

       <b>EPOLLONESHOT</b> (since Linux 2.6.2)
              Requests one-shot notification for the associated file descriptor.  This means that after an event
              notified for the file descriptor by <b><a href="../man2/epoll_wait.2.html">epoll_wait</a></b>(2), the file descriptor is disabled in the interest
              list  and no other events will be reported by the <b>epoll</b> interface.  The user must call <b>epoll_ctl</b>()
              with <b>EPOLL_CTL_MOD</b> to rearm the file descriptor with a new event mask.

       <b>EPOLLWAKEUP</b> (since Linux 3.5)
              If <b>EPOLLONESHOT</b> and <b>EPOLLET</b> are clear and the process has the <b>CAP_BLOCK_SUSPEND</b> capability, ensure
              that the system does not enter "suspend" or "hibernate" while  this  event  is  pending  or  being
              processed.   The  event  is considered as being "processed" from the time when it is returned by a
              call to <b><a href="../man2/epoll_wait.2.html">epoll_wait</a></b>(2) until the next call to <b><a href="../man2/epoll_wait.2.html">epoll_wait</a></b>(2) on the same <b><a href="../man7/epoll.7.html">epoll</a></b>(7)  file  descriptor,
              the  closure of that file descriptor, the removal of the event file descriptor with <b>EPOLL_CTL_DEL</b>,
              or the clearing of <b>EPOLLWAKEUP</b> for the event file descriptor with <b>EPOLL_CTL_MOD</b>.  See also BUGS.

       <b>EPOLLEXCLUSIVE</b> (since Linux 4.5)
              Sets an exclusive wakeup mode for the epoll file descriptor that is being attached to  the  target
              file  descriptor, <u>fd</u>.  When a wakeup event occurs and multiple epoll file descriptors are attached
              to the same target file using <b>EPOLLEXCLUSIVE</b>, one or more  of  the  epoll  file  descriptors  will
              receive  an  event  with  <b><a href="../man2/epoll_wait.2.html">epoll_wait</a></b>(2).  The default in this scenario (when <b>EPOLLEXCLUSIVE</b> is not
              set) is for all epoll file descriptors to receive an event.  <b>EPOLLEXCLUSIVE</b>  is  thus  useful  for
              avoiding thundering herd problems in certain scenarios.

              If the same file descriptor is in multiple epoll instances, some with the <b>EPOLLEXCLUSIVE</b> flag, and
              others  without,  then  events  will  be  provided  to  all  epoll  instances that did not specify
              <b>EPOLLEXCLUSIVE</b>, and at least one of the epoll instances that did specify <b>EPOLLEXCLUSIVE</b>.

              The following values may be specified  in  conjunction  with  <b>EPOLLEXCLUSIVE</b>:  <b>EPOLLIN</b>,  <b>EPOLLOUT</b>,
              <b>EPOLLWAKEUP</b>,  and <b>EPOLLET</b>.  <b>EPOLLHUP</b> and <b>EPOLLERR</b> can also be specified, but this is not required:
              as usual, these events are always reported if they occur, regardless of whether they are specified
              in <u>events</u>.  Attempts to specify other values in <u>events</u> yield the error <b>EINVAL</b>.

              <b>EPOLLEXCLUSIVE</b> may be used only  in  an  <b>EPOLL_CTL_ADD</b>  operation;  attempts  to  employ  it  with
              <b>EPOLL_CTL_MOD</b> yield an error.  If <b>EPOLLEXCLUSIVE</b> has been set using <b>epoll_ctl</b>(), then a subsequent
              <b>EPOLL_CTL_MOD</b>  on  the  same  <u>epfd</u>, <u>fd</u> pair yields an error.  A call to <b>epoll_ctl</b>() that specifies
              <b>EPOLLEXCLUSIVE</b> in <u>events</u> and specifies the target file descriptor <u>fd</u> as  an  epoll  instance  will
              likewise fail.  The error in all of these cases is <b>EINVAL</b>.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       When successful, <b>epoll_ctl</b>() returns zero.  When an error occurs, <b>epoll_ctl</b>() returns -1 and <u>errno</u> is set
       to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EBADF</b>  <u>epfd</u> or <u>fd</u> is not a valid file descriptor.

       <b>EEXIST</b> <u>op</u>  was  <b>EPOLL_CTL_ADD</b>,  and the supplied file descriptor <u>fd</u> is already registered with this epoll
              instance.

       <b>EINVAL</b> <u>epfd</u> is not an <b>epoll</b> file descriptor, or <u>fd</u> is the same as <u>epfd</u>, or the requested operation <u>op</u>  is
              not supported by this interface.

       <b>EINVAL</b> An invalid event type was specified along with <b>EPOLLEXCLUSIVE</b> in <u>events</u>.

       <b>EINVAL</b> <u>op</u> was <b>EPOLL_CTL_MOD</b> and <u>events</u> included <b>EPOLLEXCLUSIVE</b>.

       <b>EINVAL</b> <u>op</u>  was  <b>EPOLL_CTL_MOD</b>  and  the  <b>EPOLLEXCLUSIVE</b> flag has previously been applied to this <u>epfd</u>, <u>fd</u>
              pair.

       <b>EINVAL</b> <b>EPOLLEXCLUSIVE</b> was specified in <u>event</u> and <u>fd</u> refers to an epoll instance.

       <b>ELOOP</b>  <u>fd</u> refers to an epoll instance and this <b>EPOLL_CTL_ADD</b> operation would result in a circular loop of
              epoll instances monitoring one another or a nesting depth of epoll instances greater than 5.

       <b>ENOENT</b> <u>op</u> was <b>EPOLL_CTL_MOD</b> or <b>EPOLL_CTL_DEL</b>, and <u>fd</u> is not registered with this epoll instance.

       <b>ENOMEM</b> There was insufficient memory to handle the requested <u>op</u> control operation.

       <b>ENOSPC</b> The limit imposed by <u><a href="file:/proc/sys/fs/epoll/max_user_watches">/proc/sys/fs/epoll/max_user_watches</a></u> was encountered while trying to  register
              (<b>EPOLL_CTL_ADD</b>) a new file descriptor on an epoll instance.  See <b><a href="../man7/epoll.7.html">epoll</a></b>(7) for further details.

       <b>EPERM</b>  The  target  file <u>fd</u> does not support <b>epoll</b>.  This error can occur if <u>fd</u> refers to, for example, a
              regular file or a directory.

</pre><h4><b>STANDARDS</b></h4><pre>
       Linux.

</pre><h4><b>HISTORY</b></h4><pre>
       Linux 2.6, glibc 2.3.2.

</pre><h4><b>NOTES</b></h4><pre>
       The <b>epoll</b> interface supports all file descriptors that support <b><a href="../man2/poll.2.html">poll</a></b>(2).

</pre><h4><b>BUGS</b></h4><pre>
       Before Linux 2.6.9, the <b>EPOLL_CTL_DEL</b> operation required a non-null pointer in <u>event</u>,  even  though  this
       argument  is  ignored.   Since  Linux  2.6.9,  <u>event</u>  can  be specified as NULL when using <b>EPOLL_CTL_DEL</b>.
       Applications that need to be portable to kernels before Linux 2.6.9 should specify a non-null pointer  in
       <u>event</u>.

       If <b>EPOLLWAKEUP</b> is specified in <u>flags</u>, but the caller does not have the <b>CAP_BLOCK_SUSPEND</b> capability, then
       the  <b>EPOLLWAKEUP</b>  flag  is  <u>silently</u> <u>ignored</u>.  This unfortunate behavior is necessary because no validity
       checks were performed on the <u>flags</u> argument in the original  implementation,  and  the  addition  of  the
       <b>EPOLLWAKEUP</b>  with  a  check that caused the call to fail if the caller did not have the <b>CAP_BLOCK_SUSPEND</b>
       capability caused a breakage in at least one existing user-space application that  happened  to  randomly
       (and  uselessly)  specify  this  bit.  A robust application should therefore double check that it has the
       <b>CAP_BLOCK_SUSPEND</b> capability if attempting to use the <b>EPOLLWAKEUP</b> flag.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/epoll_create.2.html">epoll_create</a></b>(2), <b><a href="../man2/epoll_wait.2.html">epoll_wait</a></b>(2), <b><a href="../man2/ioctl_eventpoll.2.html">ioctl_eventpoll</a></b>(2), <b><a href="../man2/poll.2.html">poll</a></b>(2), <b><a href="../man7/epoll.7.html">epoll</a></b>(7)

Linux man-pages 6.9.1                              2024-06-12                                       <u><a href="../man2/epoll_ctl.2.html">epoll_ctl</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>