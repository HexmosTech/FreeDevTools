<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ioctl_xfs_inumbers - query allocation information for groups of XFS inodes</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/xfslibs-dev">xfslibs-dev_6.13.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ioctl_xfs_inumbers - query allocation information for groups of XFS inodes

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;xfs/xfs_fs.h&gt;</b>

       <b>int</b> <b>ioctl(int</b> <u>fd</u><b>,</b> <b>XFS_IOC_INUMBERS,</b> <b>struct</b> <b>xfs_inumbers_req</b> <b>*</b><u>arg</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Query  inode allocation information for groups of XFS inodes.  This ioctl uses <b>struct</b> <b>xfs_inumbers_req</b> to
       set up a bulk transfer from the kernel:

           struct xfs_inumbers_req {
                struct xfs_bulk_ireq    hdr;
                struct xfs_inumbers     inumbers[];
           };

       See below for the <b>xfs_inumbers</b> structure definition.

           struct xfs_bulk_ireq {
                uint64_t                ino;
                uint32_t                flags;
                uint32_t                icount;
                uint32_t                ocount;
                uint32_t                agno;
                uint64_t                reserved[5];
           };

       <u>hdr</u>  describes  the  information  to  query.   The  layout   and   behavior   are   documented   in   the
       <b><a href="../man2/ioctl_xfs_bulkstat.2.html">ioctl_xfs_bulkstat</a></b>(2) manpage and will not be discussed further here.

       <u>inumbers</u>  is  an  array  of  <b>struct</b>  <b>xfs_inumbers</b> which is described below.  The array must have at least
       <u>icount</u> elements.

           struct xfs_inumbers {
                uint64_t                xi_startino;
                uint64_t                xi_allocmask;
                uint8_t                 xi_alloccount;
                uint8_t                 xi_version;
                uint8_t                 xi_padding[6];
           };

       This structure describes inode usage information for a group of 64 consecutive inode numbers.

       <u>xi_startino</u> is the first inode number of this group.

       <u>xi_allocmask</u> is a bitmask telling which inodes in this group are allocated.  To clarify, bit <b>N</b> is set  if
       inode <b>xi_startino</b>+<b>N</b> is allocated.

       <u>xi_alloccount</u>  is  the  number  of  inodes  in  this  group  that are allocated.  This should be equal to
       popcnt(xi_allocmask).

       <u>xi_version</u> is the version of this data structure.  This will be set  to  <u>XFS_INUMBERS_VERSION_V5</u>  by  the
       kernel.

       <u>xi_padding[6]</u> is zeroed.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       Error codes can be one of, but are not limited to, the following:

       <b>EFAULT</b> The kernel was not able to copy into the userspace buffer.

       <b>EFSBADCRC</b>
              Metadata checksum validation failed while performing the query.

       <b>EFSCORRUPTED</b>
              Metadata corruption was encountered while performing the query.

       <b>EINVAL</b> One of the arguments was not valid.

       <b>EIO</b>    An I/O error was encountered while performing the query.

       <b>ENOMEM</b> There was insufficient memory to perform the query.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       This API is specific to XFS filesystem on the Linux kernel.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/ioctl.2.html">ioctl</a></b>(2), <b><a href="../man2/ioctl_xfs_bulkstat.2.html">ioctl_xfs_bulkstat</a></b>(2).

XFS                                                2019-05-23                              <u><a href="../man2/IOCTL-XFS-INUMBERS.2.html">IOCTL-XFS-INUMBERS</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>