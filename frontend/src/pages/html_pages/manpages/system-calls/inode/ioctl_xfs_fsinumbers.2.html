<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ioctl_xfs_fsinumbers - extract a list of valid inode numbers from an XFS filesystem</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/xfslibs-dev">xfslibs-dev_6.13.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ioctl_xfs_fsinumbers - extract a list of valid inode numbers from an XFS filesystem

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;xfs/xfs_fs.h&gt;</b>

       <b>int</b> <b>ioctl(int</b> <u>fd</u><b>,</b> <b>XFS_IOC_FSINUMBERS,</b> <b>struct</b> <b>xfs_fsop_bulkreq</b> <b>*</b><u>arg</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Queries  inode allocation information from an XFS filesystem.  It is intended to be called iteratively to
       obtain the entire set of inodes.  These ioctls use <b>struct</b> <b>xfs_fsop_bulkreq</b> to set up a bulk transfer with
       the kernel:

           struct xfs_fsop_bulkreq {
                __u64   *lastip;
                __s32   count;
                void    *ubuffer;
                __s32   *ocount;
           };

       <u>lastip</u> points to a value that will receive the number of the "last inode."  This should  be  set  to  one
       less than the number of the first inode for which the caller wants information, or zero to start with the
       first  inode  in  the filesystem.  After the call, this value will be set to the number of the last inode
       for which information is supplied.  This field will not be updated if <u>ocount</u> is NULL.

       <u>count</u> is the number of elements in the <b>ubuffer</b> array and therefore the number of inode groups  for  which
       to return allocation information.

       <u>ocount</u> points to a value that will receive the number of records returned.  An output value of zero means
       that  there  are  no more inode groups left to enumerate.  If this value is NULL, then neither <u>ocount</u> nor
       <u>lastip</u> will be updated.

       <u>ubuffer</u> points to a memory buffer where inode group information will be copied.  This buffer must  be  an
       array of <b>struct</b> <b>xfs_inogrp</b> which is described below.  The array must have at least <u>count</u> elements.

           struct xfs_inogrp {
                __u64   xi_startino;
                __s32   xi_alloccount;
                __u64   xi_allocmask;
           }

       This structure describes inode usage information for a group of 64 consecutive inode numbers.  The fields
       are as follows:

       <u>xi_startino</u> is the first inode number of this group.

       <u>xi_alloccount</u> is the number of bits that are set in <u>xi_allocmask</u>.  This is the number of inodes allocated
       in this group.

       <u>xi_allocmask</u> is a bitmask of inodes that are allocated in this inode group.  The bitmask is 64 bits long,
       and the least significant bit corresponds to inode <b>xi_startino</b>.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       Error codes can be one of, but are not limited to, the following:

       <b>EFAULT</b> The kernel was not able to copy into the userspace buffer.

       <b>EFSBADCRC</b>
              Metadata checksum validation failed while performing the query.

       <b>EFSCORRUPTED</b>
              Metadata corruption was encountered while performing the query.

       <b>EINVAL</b> One of the arguments was not valid.

       <b>EIO</b>    An I/O error was encountered while performing the query.

       <b>ENOMEM</b> There was insufficient memory to perform the query.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       This API is specific to XFS filesystem on the Linux kernel.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/ioctl.2.html">ioctl</a></b>(2)

XFS                                                2019-06-17                            <u><a href="../man2/IOCTL-XFS-FSINUMBERS.2.html">IOCTL-XFS-FSINUMBERS</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>