<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>setaudit, setaudit_addr — set audit session state</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       setaudit, setaudit_addr — set audit session state

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;bsm/audit.h&gt;</b>

       <u>int</u>
       <b>setaudit</b>(<u>auditinfo_t</u> <u>*auditinfo</u>);

       <u>int</u>
       <b>setaudit_addr</b>(<u>auditinfo_addr_t</u> <u>*auditinfo_addr</u>, <u>u_int</u> <u>length</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>setaudit</b>()  system  call  sets  the  active  audit  session  state  for  the current process via the
       <u>auditinfo_t</u>  pointed  to  by  <u>auditinfo</u>.   The  <b>setaudit_addr</b>()  system  call  sets  extended  state  via
       <u>auditinfo_addr</u> and <u>length</u>.

       The <u>auditinfo_t</u> data structure is defined as follows:

           struct auditinfo {
                   au_id_t        ai_auid;         /* Audit user ID */
                   au_mask_t      ai_mask;         /* Audit masks */
                   au_tid_t       ai_termid;       /* Terminal ID */
                   au_asid_t      ai_asid;         /* Audit session ID */
           };
           typedef struct auditinfo        auditinfo_t;

       The  <u>ai_auid</u> variable contains the audit identifier which is recorded in the audit log for each event the
       process caused.

       The <u>au_mask_t</u> data structure defines the bit mask for auditing successful and failed events  out  of  the
       predefined list of event classes. It is defined as follows:

           struct au_mask {
                   unsigned int    am_success;     /* success bits */
                   unsigned int    am_failure;     /* failure bits */
           };
           typedef struct au_mask  au_mask_t;

       The  <u>au_termid_t</u>  data structure defines the Terminal ID recorded with every event caused by the process.
       It is defined as follows:

           struct au_tid {
                   dev_t           port;
                   u_int32_t       machine;
           };
           typedef struct au_tid   au_tid_t;

       The <u>ai_asid</u> variable contains the audit session ID which is recorded  with  every  event  caused  by  the
       process.

       The  <b>setaudit_addr</b>()  system call uses the expanded <u>auditinfo_addr_t</u> data structure supports Terminal IDs
       with larger addresses such as those used in IP version 6.  It is defined as follows:

           struct auditinfo_addr {
                   au_id_t         ai_auid;        /* Audit user ID. */
                   au_mask_t       ai_mask;        /* Audit masks. */
                   au_tid_addr_t   ai_termid;      /* Terminal ID. */
                   au_asid_t       ai_asid;        /* Audit session ID. */
           };
           typedef struct auditinfo_addr   auditinfo_addr_t;

       The <u>au_tid_addr_t</u> data structure which includes a larger address storage field and  an  additional  field
       with the type of address stored:

           struct au_tid_addr {
                   dev_t           at_port;
                   u_int32_t       at_type;
                   u_int32_t       at_addr[4];
           };
           typedef struct au_tid_addr      au_tid_addr_t;

       These system calls require an appropriate privilege to complete.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The  <b>setaudit</b>() and <b>setaudit_addr</b>() functions return the value 0 if successful; otherwise the value -1 is
       returned and the global variable <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       [EFAULT]           A failure occurred while data transferred to or from the kernel failed.

       [EINVAL]           Illegal argument was passed by a system call.

       [EPERM]            The process does not have sufficient permission to complete the operation.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/audit.2.html">audit</a></u>(2), <u><a href="../man2/auditon.2.html">auditon</a></u>(2), <u><a href="../man2/getaudit.2.html">getaudit</a></u>(2), <u><a href="../man2/getauid.2.html">getauid</a></u>(2), <u><a href="../man2/setauid.2.html">setauid</a></u>(2), <u><a href="../man3/libbsm.3.html">libbsm</a></u>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The OpenBSM implementation was created by McAfee Research, the security division of  McAfee  Inc.,  under
       contract  to  Apple  Computer Inc. in 2004.  It was subsequently adopted by the TrustedBSD Project as the
       foundation for the OpenBSM distribution.

</pre><h4><b>AUTHORS</b></h4><pre>
       This software was created by McAfee Research, the security  research  division  of  McAfee,  Inc.,  under
       contract to Apple Computer Inc.  Additional authors include Wayne Salamon, Robert Watson, and SPARTA Inc.

       The  Basic Security Module (BSM) interface to audit records and audit event stream format were defined by
       Sun Microsystems.

       This manual page was written by Robert Watson &lt;<a href="mailto:rwatson@FreeBSD.org">rwatson@FreeBSD.org</a>&gt;.

Debian                                           April 19, 2005                                      <u><a href="../man2/SETAUDIT.2.html">SETAUDIT</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>