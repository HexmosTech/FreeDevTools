<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>posix_fadvise - predeclare an access pattern for file data</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       posix_fadvise - predeclare an access pattern for file data

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/fcntl.h">fcntl.h</a>&gt;</b>

       <b>int</b> <b>posix_fadvise(int</b> <u>fd</u><b>,</b> <b>off_t</b> <u>offset</u><b>,</b> <b>off_t</b> <u>len</u><b>,</b> <b>int</b> <u>advice</u><b>);</b>

   Feature Test Macro Requirements for glibc (see <b><a href="../man7/feature_test_macros.7.html">feature_test_macros</a></b>(7)):

       <b>posix_fadvise</b>():
           _POSIX_C_SOURCE &gt;= 200112L

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Programs can use <b>posix_fadvise</b>() to announce an intention to access file data in a specific pattern in
       the future, thus allowing the kernel to perform appropriate optimizations.

       The <u>advice</u> applies to a (not necessarily existent) region starting at <u>offset</u> and extending for <u>len</u> bytes
       (or until the end of the file if <u>len</u> is 0) within the file referred to by <u>fd</u>.  The <u>advice</u> is not binding;
       it merely constitutes an expectation on behalf of the application.

       Permissible values for <u>advice</u> include:

       <b>POSIX_FADV_NORMAL</b>
              Indicates  that  the  application has no advice to give about its access pattern for the specified
              data.  If no advice is given for an open file, this is the default assumption.

       <b>POSIX_FADV_SEQUENTIAL</b>
              The application expects to access the specified data sequentially (with lower offsets read  before
              higher ones).

       <b>POSIX_FADV_RANDOM</b>
              The specified data will be accessed in random order.

       <b>POSIX_FADV_NOREUSE</b>
              The specified data will be accessed only once.

              Before  Linux  2.6.18, <b>POSIX_FADV_NOREUSE</b> had the same semantics as <b>POSIX_FADV_WILLNEED</b>.  This was
              probably a bug; since Linux 2.6.18, this flag is a no-op.

       <b>POSIX_FADV_WILLNEED</b>
              The specified data will be accessed in the near future.

              <b>POSIX_FADV_WILLNEED</b> initiates a nonblocking read of the specified region into the page cache.  The
              amount of data read may be decreased by the kernel depending  on  virtual  memory  load.   (A  few
              megabytes will usually be fully satisfied, and more is rarely useful.)

       <b>POSIX_FADV_DONTNEED</b>
              The specified data will not be accessed in the near future.

              <b>POSIX_FADV_DONTNEED</b>  attempts  to free cached pages associated with the specified region.  This is
              useful, for example, while streaming large files.  A program may periodically request  the  kernel
              to free cached data that has already been used, so that more useful cached pages are not discarded
              instead.

              Requests  to  discard  partial  pages  are ignored.  It is preferable to preserve needed data than
              discard unneeded data.  If the application requires that data be considered for  discarding,  then
              <u>offset</u> and <u>len</u> must be page-aligned.

              The  implementation <u>may</u> attempt to write back dirty pages in the specified region, but this is not
              guaranteed.  Any unwritten dirty pages will not be freed.  If the  application  wishes  to  ensure
              that dirty pages will be released, it should call <b><a href="../man2/fsync.2.html">fsync</a></b>(2) or <b><a href="../man2/fdatasync.2.html">fdatasync</a></b>(2) first.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, zero is returned.  On error, an error number is returned.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EBADF</b>  The <u>fd</u> argument was not a valid file descriptor.

       <b>EINVAL</b> An invalid value was specified for <u>advice</u>.

       <b>ESPIPE</b> The  specified file descriptor refers to a pipe or FIFO.  (<b>ESPIPE</b> is the error specified by POSIX,
              but before Linux 2.6.16, Linux returned <b>EINVAL</b> in this case.)

</pre><h4><b>VERSIONS</b></h4><pre>
       Under Linux, <b>POSIX_FADV_NORMAL</b> sets the readahead window to the default  size  for  the  backing  device;
       <b>POSIX_FADV_SEQUENTIAL</b>  doubles  this size, and <b>POSIX_FADV_RANDOM</b> disables file readahead entirely.  These
       changes affect the entire file, not just the specified region (but other open file handles  to  the  same
       file are unaffected).

   <b>C</b> <b>library/kernel</b> <b>differences</b>
       The  name  of  the  wrapper  function in the C library is <b>posix_fadvise</b>().  The underlying system call is
       called <b>fadvise64</b>() (or, on some architectures, <b>fadvise64_64</b>()); the difference between the  two  is  that
       the  former  system  call  assumes  that the type of the <u>len</u> argument is <u>size_t</u>, while the latter expects
       <u>loff_t</u> there.

   <b>Architecture-specific</b> <b>variants</b>
       Some architectures require 64-bit arguments to be aligned in a suitable pair of registers (see <b><a href="../man2/syscall.2.html">syscall</a></b>(2)
       for further detail).  On such architectures, the call signature of <b>posix_fadvise</b>() shown in the  SYNOPSIS
       would  force  a  register  to be wasted as padding between the <u>fd</u> and <u>offset</u> arguments.  Therefore, these
       architectures define a version of the system call that orders the arguments suitably,  but  is  otherwise
       exactly the same as <b>posix_fadvise</b>().

       For example, since Linux 2.6.14, ARM has the following system call:

           <b>long</b> <b>arm_fadvise64_64(int</b> <u>fd</u><b>,</b> <b>int</b> <u>advice</u><b>,</b>
                                 <b>loff_t</b> <u>offset</u><b>,</b> <b>loff_t</b> <u>len</u><b>);</b>

       These  architecture-specific  details are generally hidden from applications by the glibc <b>posix_fadvise</b>()
       wrapper function, which invokes the appropriate architecture-specific system call.

</pre><h4><b>STANDARDS</b></h4><pre>
       POSIX.1-2008.

</pre><h4><b>HISTORY</b></h4><pre>
       POSIX.1-2001.

       Kernel support first appeared in Linux 2.5.60; the underlying system call is called <b>fadvise64</b>().  Library
       support has been provided since glibc 2.2, via the wrapper function <b>posix_fadvise</b>().

       Since Linux 3.18, support for the underlying system call is optional, depending on  the  setting  of  the
       <b>CONFIG_ADVISE_SYSCALLS</b> configuration option.

       The type of the <u>len</u> argument was changed from <u>size_t</u> to <u>off_t</u> in POSIX.1-2001 TC1.

</pre><h4><b>NOTES</b></h4><pre>
       The  contents  of  the  kernel  buffer  cache  can  be cleared via the <u><a href="file:/proc/sys/vm/drop_caches">/proc/sys/vm/drop_caches</a></u> interface
       described in <b><a href="../man5/proc.5.html">proc</a></b>(5).

       One can obtain a snapshot of which pages of a file are resident in the buffer cache by  opening  a  file,
       mapping it with <b><a href="../man2/mmap.2.html">mmap</a></b>(2), and then applying <b><a href="../man2/mincore.2.html">mincore</a></b>(2) to the mapping.

</pre><h4><b>BUGS</b></h4><pre>
       Before  Linux  2.6.6,  if  <u>len</u>  was  specified as 0, then this was interpreted literally as "zero bytes",
       rather than as meaning "all bytes through to the end of the file".

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/fincore.1.html">fincore</a></b>(1), <b><a href="../man2/mincore.2.html">mincore</a></b>(2), <b><a href="../man2/readahead.2.html">readahead</a></b>(2), <b><a href="../man2/sync_file_range.2.html">sync_file_range</a></b>(2), <b><a href="../man3/posix_fallocate.3.html">posix_fallocate</a></b>(3), <b><a href="../man3/posix_madvise.3.html">posix_madvise</a></b>(3)

Linux man-pages 6.9.1                              2024-05-02                                   <u><a href="../man2/posix_fadvise.2.html">posix_fadvise</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>