<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>problem_mixed - linear solver (rheolef-7.2)</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/librheolef-dev">librheolef-dev_7.2-4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       problem_mixed - linear solver (rheolef-7.2)

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The problem_mixed class solves a given linear mixed system for PDEs in variational formulation.

       Mixed problem appear in many applications such as the Stokes or the nearly incompressible elasticity. Let
       Xh and Qh be two finite element <b><a href="../man2/space.2.html">space</a>(2)</b>. Let a: Xh*Xh --&gt; IR, b: Xh*Qh --&gt; IR and c: Xh*Qh --&gt; IR be
       three bilinear <b><a href="../man2/form.2.html">form</a>(2)</b>. The system writes:

           [ A  B^T ] [ uh ]   [ lh ]
           [        ] [    ] = [    ]
           [ B  -C  ] [ ph ]   [ kh ]

        where A, B and C are the three operators associated to a, b and c, respectively, and lh in Xh and kh in
       Qh are the two given right-hand-sides. The c bilinear form is called the stabilization, and could be
       zero.

       The degrees of freedom are split between <u>unknown</u> degrees of freedom and <u>blocked</u> one. See also <b><a href="../man2/form.2.html">form</a>(2)</b> and
       <b><a href="../man2/space.2.html">space</a>(2)</b>. The linear system expands as:

           [ a.uu  a.ub   b.uu^T b.bu^T ] [ uh.u ]   [ lh.u ]
           [                            ] [      ] = [      ]
           [ a.bu  a.bb   b.ub^T b.bb^T ] [ uh.b ]   [ lh.b ]
           [                            ] [      ] = [      ]
           [ b.uu  b.ub  -c.uu  -c.ub   ] [ ph.u ]   [ kh.u ]
           [                            ] [      ] = [      ]
           [ b.bu  a.bb  -c.bu  -c.bb   ] [ ph.b ]   [ kh.b ]

        Both the uh.b and ph.b are blocked degrees of freedom: their values are prescribed and the corresponding
       values are move to the right-hand-side of the system that reduces to:

           a.uu*uh.u + b.uu^T*ph.u = lh.u - a.ub*uh.b - b.bu^T*ph.b

           b.uu*uh.u -   c.uu*ph.u = kh.u - b.ub*uh.b +   c.ub*ph.b

        This writes:

           problem_mixed p (a, b, c);
           p.solve (lh, kh, uh, ph);

        When c is zero, the last c argument could be omitted, as:

           problem_mixed p (a, b);

        Observe that, during the p.solve call, uh is both an input variable, for the uh.b contribution to the
       right-hand-side, and an output variable, with uh.u. This is also true for ph when ph.b is non-empty. The
       previous linear system is solved via the <b><a href="../man4/solver_abtb.4.html">solver_abtb</a>(4)</b> class: the problem_mixed class is simply a
       convenient wrapper around the <b><a href="../man4/solver_abtb.4.html">solver_abtb</a>(4)</b> one.

</pre><h4><b>EXAMPLE</b></h4><pre>
       See <b>stokes_cavity.cc</b>

</pre><h4><b>OPTIONS</b></h4><pre>
       The <b><a href="../man4/solver_abtb.4.html">solver_abtb</a>(4)</b> could be customized via the constructor optional <b><a href="../man4/solver_option.4.html">solver_option</a>(4)</b> argument:

           problem p (a, b, sopt);

        or

           problem p (a, b, c, sopt);

        This <b><a href="../man4/solver_abtb.4.html">solver_abtb</a>(4)</b> is used to switch between a direct and an iterative method for solving the mixed
       system.

</pre><h4><b>METRIC</b></h4><pre>
       A <u>metric</u> in the Qh space could also be provided:

           p.set_metric (mp);

        By default, when nothing has been specified, this metric is the L2 scalar product for the Qh space.

       When using a direct <b><a href="../man4/solver.4.html">solver</a>(4)</b> method, this metric is used to add a constraint when the multiplier is
       known up to a constant. For instance, when the pressure is known up to a constant, a constraint for a
       zero average pressure is automatically added to the linear system.

       When using an iterative <b><a href="../man4/solver.4.html">solver</a>(4)</b> method, this metric is used as a Schur complement preconditionner, see
       <b><a href="../man4/solver_abtb.4.html">solver_abtb</a>(4)</b> for details. The <b><a href="../man4/solver.4.html">solver</a>(4)</b> associated to this Schur preconditionner could be customized by
       specifying the <b><a href="../man4/solver.4.html">solver</a>(4)</b> associated to the <b><a href="../man2/problem.2.html">problem</a>(2)</b> related to the mp operator:

       p.set_preconditionner (pmp);

        Note this preconditionner subproblem could be solved either by a direct or an iterative method, while
       the whole mixed problem solver is iterative.

</pre><h4><b>INNER</b> <b>SOLVER</b></h4><pre>
       When using an iterative <b><a href="../man4/solver_abtb.4.html">solver_abtb</a>(4)</b>, the inner <b><a href="../man2/problem.2.html">problem</a>(2)</b> related to the a operator could also be
       customized by specifying its <b><a href="../man4/solver.4.html">solver</a>(4)</b> :

           p.set_inner_problem (pa);

        Note this inner subproblem could be solved either by a direct or an iterative method, while the whole
       mixed problem solver is iterative.

</pre><h4><b>IMPLEMENTATION</b></h4><pre>
       This documentation has been generated from file main/lib/problem_mixed.h

       The problem_mixed class is simply an alias to the <b>problem_mixed_basic</b> <b>class</b>

       typedef problem_mixed_basic&lt;Float&gt; problem_mixed;

       The <b>problem_mixed_basic</b> <b>class</b> <b>provides</b> <b>a</b> <b>generic</b> <b>interface:</b>

       template &lt;class T, class M = rheo_default_memory_model&gt;
       class problem_mixed_basic {
       public:

       // typedefs:

         typedef typename solver_basic&lt;T,M&gt;::size_type         size_type;
         typedef typename solver_basic&lt;T,M&gt;::determinant_type  determinant_type;

       // allocators:

         problem_mixed_basic();

         problem_mixed_basic(
             const form_basic&lt;T,M&gt;&amp; a,
             const form_basic&lt;T,M&gt;&amp; b,
             const solver_option&amp; sopt = solver_option());

         problem_mixed_basic(
             const form_basic&lt;T,M&gt;&amp; a,
             const form_basic&lt;T,M&gt;&amp; b,
             const form_basic&lt;T,M&gt;&amp; c,
             const solver_option&amp; sopt = solver_option());

       // accessor:

         void solve (const field_basic&lt;T,M&gt;&amp; lh, const field_basic&lt;T,M&gt;&amp; kh,
                           field_basic&lt;T,M&gt;&amp; uh,       field_basic&lt;T,M&gt;&amp; ph) const;

         bool initialized() const;
         const solver_option&amp;     option() const;

       // modifiers:

         void set_metric          (const form&amp; mp);
         void set_preconditionner (const problem&amp; pmp);
         void set_inner_problem   (const problem&amp; pa);

       };

</pre><h4><b>AUTHOR</b></h4><pre>
       Pierre  Saramito  &lt;<a href="mailto:Pierre.Saramito@imag.fr">Pierre.Saramito@imag.fr</a>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright   (C)  2000-2018  Pierre  Saramito  &lt;<a href="mailto:Pierre.Saramito@imag.fr">Pierre.Saramito@imag.fr</a>&gt; GPLv3+: GNU GPL version 3 or
       later  &lt;<a href="http://gnu.org/licenses/gpl.html">http://gnu.org/licenses/gpl.html</a>&gt;.  This  is  free  software:  you  are free to change and
       redistribute it.  There is NO WARRANTY, to the extent permitted by law.

rheolef                                            Version 7.2                           <u><a href="../man2rheolef/problem_mixed.2rheolef.html">problem_mixed</a></u>(2rheolef)
</pre>
 </div>
</div></section>
</div>
</body>
</html>