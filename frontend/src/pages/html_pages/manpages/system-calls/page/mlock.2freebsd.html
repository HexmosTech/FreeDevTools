<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mlock, munlock — lock (unlock) physical pages in memory</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mlock, munlock — lock (unlock) physical pages in memory

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C Library (libc, -lc)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/mman.h&gt;</b>

       <u>int</u>
       <b>mlock</b>(<u>const</u> <u>void</u> <u>*addr</u>, <u>size_t</u> <u>len</u>);

       <u>int</u>
       <b>munlock</b>(<u>const</u> <u>void</u> <u>*addr</u>, <u>size_t</u> <u>len</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>mlock</b>()  system  call locks into memory the physical pages associated with the virtual address range
       starting at <u>addr</u> for <u>len</u> bytes.  The <b>munlock</b>() system call unlocks pages previously locked by one or more
       <b>mlock</b>() calls.  For both, the <u>addr</u> argument should be aligned to a multiple of the page size.  If the <u>len</u>
       argument is not a multiple of the page size, it will be rounded up to be so.  The entire  range  must  be
       allocated.

       After  an  <b>mlock</b>()  system  call, the indicated pages will cause neither a non-resident page nor address-
       translation fault until they are unlocked.  They may still cause protection-violation faults or  TLB-miss
       faults on architectures with software-managed TLBs.  The physical pages remain in memory until all locked
       mappings for the pages are removed.  Multiple processes may have the same physical pages locked via their
       own  virtual  address  mappings.   A single process may likewise have pages multiply-locked via different
       virtual mappings of the  same  physical  pages.   Unlocking  is  performed  explicitly  by  <b>munlock</b>()  or
       implicitly  by  a call to <b>munmap</b>() which deallocates the unmapped address range.  Locked mappings are not
       inherited by the child process after a <u><a href="../man2/fork.2.html">fork</a></u>(2).

       Since physical memory is a potentially scarce resource, processes are limited in how much they  can  lock
       down.   The  amount  of  memory  that  a  single  process  can <b>mlock</b>() is limited by both the per-process
       RLIMIT_MEMLOCK  resource   limit   and   the   system-wide   “wired   pages”   limit   <u>vm.max_user_wired</u>.
       <u>vm.max_user_wired</u>  applies  to  the system as a whole, so the amount available to a single process at any
       given time is the difference between <u>vm.max_user_wired</u> and <u>vm.stats.vm.v_user_wire_count</u>.

       If <u>security.bsd.unprivileged_mlock</u> is set to 0 these calls are only available to the super-user.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       Upon successful completion, the value 0 is returned; otherwise the value -1 is returned  and  the  global
       variable <u>errno</u> is set to indicate the error.

       If the call succeeds, all pages in the range become locked (unlocked); otherwise the locked status of all
       pages in the range remains unchanged.

</pre><h4><b>ERRORS</b></h4><pre>
       The <b>mlock</b>() system call will fail if:

       [EPERM]            <u>security.bsd.unprivileged_mlock</u> is set to 0 and the caller is not the super-user.

       [EINVAL]           The address range given wraps around zero.

       [ENOMEM]           Some  portion  of  the  indicated  address range is not allocated.  There was an error
                          faulting/mapping a page.  Locking the indicated range would exceed the per-process  or
                          system-wide limits for locked memory.
       The <b>munlock</b>() system call will fail if:

       [EPERM]            <u>security.bsd.unprivileged_mlock</u> is set to 0 and the caller is not the super-user.

       [EINVAL]           The address range given wraps around zero.

       [ENOMEM]           Some  or  all  of  the  address range specified by the addr and len arguments does not
                          correspond to valid mapped pages in the address space of the process.

       [ENOMEM]           Locking the pages mapped by the specified range would exceed a limit on the amount  of
                          memory that the process may lock.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/fork.2.html">fork</a></u>(2),   <u><a href="../man2/mincore.2.html">mincore</a></u>(2),   <u><a href="../man2/minherit.2.html">minherit</a></u>(2),   <u><a href="../man2/mlockall.2.html">mlockall</a></u>(2),  <u><a href="../man2/mmap.2.html">mmap</a></u>(2),  <u><a href="../man2/munlockall.2.html">munlockall</a></u>(2),  <u><a href="../man2/munmap.2.html">munmap</a></u>(2),  <u><a href="../man2/setrlimit.2.html">setrlimit</a></u>(2),
       <u><a href="../man3/getpagesize.3.html">getpagesize</a></u>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>mlock</b>() and <b>munlock</b>() system calls first appeared in 4.4BSD.

</pre><h4><b>BUGS</b></h4><pre>
       Allocating too much wired memory can lead to a memory-allocation deadlock  which  requires  a  reboot  to
       recover from.

       The  per-process  and  system-wide resource limits of locked memory apply to the amount of virtual memory
       locked, not the amount of locked physical pages.  Hence two distinct locked mappings of the same physical
       page counts as 2 pages aginst the system limit, and also against the per-process limit if  both  mappings
       belong to the same physical map.

       The per-process resource limit is not currently supported.

Debian                                            May 13, 2019                                          <u><a href="../man2/MLOCK.2.html">MLOCK</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>