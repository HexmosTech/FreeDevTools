<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aa_getprocattr_raw, aa_getprocattr - read and parse procattr data</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libapparmor-dev">libapparmor-dev_4.1.1-0ubuntu6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       aa_getprocattr_raw, aa_getprocattr - read and parse procattr data

       aa_getcon, aa_gettaskcon - get task confinement information

       aa_getpeercon - get the confinement of a socket's other end (peer)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/apparmor.h&gt;</b>

       <b>int</b> <b>aa_getprocattr_raw(pid_t</b> <b>tid,</b> <b>const</b> <b>char</b> <b>*attr,</b> <b>char</b> <b>*buf,</b> <b>int</b> <b>len,</b> <b>char</b> <b>**mode);</b>

       <b>int</b> <b>aa_getprocattr(pid_t</b> <b>tid,</b> <b>const</b> <b>char</b> <b>*attr,</b> <b>char</b> <b>**label,</b> <b>char</b> <b>**mode);</b>

       <b>int</b> <b>aa_gettaskcon(pid_t</b> <b>target,</b> <b>char</b> <b>**label,</b> <b>char</b> <b>**mode);</b>

       <b>int</b> <b>aa_getcon(char</b> <b>**label,</b> <b>char</b> <b>**mode);</b>

       <b>int</b> <b>aa_getpeercon_raw(int</b> <b>fd,</b> <b>char</b> <b>*buf,</b> <b>int</b> <b>*len,</b> <b>char</b> <b>**mode);</b>

       <b>int</b> <b>aa_getpeercon(int</b> <b>fd,</b> <b>char</b> <b>**label,</b> <b>char</b> <b>**mode);</b>

       Link with <b>-lapparmor</b> when compiling.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The aa_getcon function gets the current AppArmor confinement context for the current task. The
       confinement context consists of a label and a mode. The label is usually just the name of the AppArmor
       profile restricting the task, but it may include the profile namespace or in some cases a set of profile
       names (known as a stack of profiles). The mode is a string that describes how the kernel is enforcing the
       policy defined in the profile. Profiles loaded in "enforce" mode will result in enforcement of the policy
       defined in the profile as well as reporting policy violation attempts. Profiles in "complain" mode will
       not enforce policy but instead report policy violation attempts.

       Some examples of possible returned *label strings are "unconfined", "/sbin/dhclient", and "Firefox". The
       string can consist of any non-NUL characters but it will be NUL-terminated. The *label string must be
       freed using <b>free()</b>.

       The possible *mode strings are "enforce" and "complain". Additionally, *mode may be NULL when *label is
       "unconfined". <b>The</b> <b>*mode</b> <b>string</b> <b>must</b> <b>not</b> <b>be</b> <b>freed</b>. The *label and *mode strings come from a single buffer
       allocation and are separated by a NUL character.

       The aa_gettaskcon function is like the aa_getcon function except it will work for any arbitrary task in
       the system.

       The aa_getpeercon function is similar to that of aa_gettaskcon except that it returns the confinement
       information for task on the other end of a socket connection.

       The aa_getpeercon_raw function is the backend for the aa_getpeercon function and does not handle buffer
       allocation.

       The aa_getprocattr function is the backend for the aa_getcon and aa_gettaskcon functions and handles the
       reading and parsing of the confinement data from different arbitrary attr files and returns the processed
       results in an allocated buffer.

       The <b>aa_getprocattr_raw()</b> is the backend for the aa_getprocattr function and does not handle buffer
       allocation.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success size of data placed in the buffer is returned, this includes the mode if present and any
       terminating characters. On error, -1 is returned, and <b><a href="../man3/errno.3.html">errno</a></b>(3) is set appropriately.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EINVAL</b>
           The  apparmor  kernel  module  is  not  loaded or the communication via the <u><a href="file:/proc/">/proc/</a>*/attr/file</u> did not
           conform to protocol.

       <b>ENOMEM</b>
           Insufficient kernel memory was available.

       <b>EACCES</b>
           Access to the specified <u>file/task</u> was denied.

       <b>ENOENT</b>
           The specified <u>file/task</u> does not exist or is not visible.

       <b>ERANGE</b>
           The confinement data is too large to fit in the supplied buffer.

       <b>ENOPROTOOPT</b>
           The kernel doesn't support the SO_PEERLABEL option in sockets. This happens mainly  when  the  kernel
           lacks 'fine grained unix mediation' support. It also can happen on LSM stacking kernels where another
           LSM  has  claimed  this  interface and decides to return this error, although this is really a corner
           case.

</pre><h4><b>NOTES</b></h4><pre>
       If aa_getpeercon_raw returns -1 and errno is ERANGE, the value of *len can be used to reallocate  buf  so
       that it is sufficiently large enough to store the confinement data.

</pre><h4><b>BUGS</b></h4><pre>
       None known. If you find any, please report them at &lt;https://gitlab.com/apparmor/apparmor/-/issues&gt;.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/apparmor.7.html">apparmor</a></b>(7),     <b><a href="../man5/apparmor.d.5.html">apparmor.d</a></b>(5),     <b><a href="../man8/apparmor_parser.8.html">apparmor_parser</a></b>(8),    <b><a href="../man2/aa_change_profile.2.html">aa_change_profile</a></b>(2),    <b><a href="../man3/aa_splitcon.3.html">aa_splitcon</a></b>(3)    and
       &lt;https://wiki.apparmor.net&gt;.

AppArmor 4.1.1                                     2025-07-23                                       <u><a href="../man2/AA_GETCON.2.html">AA_GETCON</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>