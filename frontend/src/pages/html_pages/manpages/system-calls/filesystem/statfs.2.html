<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>statfs, fstatfs - get filesystem statistics</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       statfs, fstatfs - get filesystem statistics

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/vfs.h&gt;</b>    /* or &lt;sys/statfs.h&gt; */

       <b>int</b> <b>statfs(const</b> <b>char</b> <b>*</b><u>path</u><b>,</b> <b>struct</b> <b>statfs</b> <b>*</b><u>buf</u><b>);</b>
       <b>int</b> <b>fstatfs(int</b> <u>fd</u><b>,</b> <b>struct</b> <b>statfs</b> <b>*</b><u>buf</u><b>);</b>

       Unless you need the <u>f_type</u> field, you should use the standard <b><a href="../man3/statvfs.3.html">statvfs</a></b>(3) interface instead.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>statfs</b>()  system  call  returns information about a mounted filesystem.  <u>path</u> is the pathname of any
       file within the mounted filesystem.  <u>buf</u> is a pointer to a  <u>statfs</u>  structure  defined  approximately  as
       follows:

           struct statfs {
               __fsword_t f_type;    /* Type of filesystem (see below) */
               __fsword_t f_bsize;   /* Optimal transfer block size */
               fsblkcnt_t f_blocks;  /* Total data blocks in filesystem */
               fsblkcnt_t f_bfree;   /* Free blocks in filesystem */
               fsblkcnt_t f_bavail;  /* Free blocks available to
                                        unprivileged user */
               fsfilcnt_t f_files;   /* Total inodes in filesystem */
               fsfilcnt_t f_ffree;   /* Free inodes in filesystem */
               fsid_t     f_fsid;    /* Filesystem ID */
               __fsword_t f_namelen; /* Maximum length of filenames */
               __fsword_t f_frsize;  /* Fragment size (since Linux 2.6) */
               __fsword_t f_flags;   /* Mount flags of filesystem
                                        (since Linux 2.6.36) */
               __fsword_t f_spare[xxx];
                               /* Padding bytes reserved for future use */
           };

       The following filesystem types may appear in <u>f_type</u>:

           ADFS_SUPER_MAGIC      0xadf5
           AFFS_SUPER_MAGIC      0xadff
           AFS_SUPER_MAGIC       0x5346414f
           ANON_INODE_FS_MAGIC   0x09041934 /* Anonymous inode FS (for
                                               pseudofiles that have no name;
                                               e.g., epoll, signalfd, bpf) */
           AUTOFS_SUPER_MAGIC    0x0187
           BDEVFS_MAGIC          0x62646576
           BEFS_SUPER_MAGIC      0x42465331
           BFS_MAGIC             0x1badface
           BINFMTFS_MAGIC        0x42494e4d
           BPF_FS_MAGIC          0xcafe4a11
           BTRFS_SUPER_MAGIC     0x9123683e
           BTRFS_TEST_MAGIC      0x73727279
           CGROUP_SUPER_MAGIC    0x27e0eb   /* Cgroup pseudo FS */
           CGROUP2_SUPER_MAGIC   0x63677270 /* Cgroup v2 pseudo FS */
           CIFS_MAGIC_NUMBER     0xff534d42
           CODA_SUPER_MAGIC      0x73757245
           COH_SUPER_MAGIC       0x012ff7b7
           CRAMFS_MAGIC          0x28cd3d45
           DEBUGFS_MAGIC         0x64626720
           DEVFS_SUPER_MAGIC     0x1373     /* Linux 2.6.17 and earlier */
           DEVPTS_SUPER_MAGIC    0x1cd1
           ECRYPTFS_SUPER_MAGIC  0xf15f
           EFIVARFS_MAGIC        0xde5e81e4
           EFS_SUPER_MAGIC       0x00414a53
           EXT_SUPER_MAGIC       0x137d     /* Linux 2.0 and earlier */
           EXT2_OLD_SUPER_MAGIC  0xef51
           EXT2_SUPER_MAGIC      0xef53
           EXT3_SUPER_MAGIC      0xef53
           EXT4_SUPER_MAGIC      0xef53
           F2FS_SUPER_MAGIC      0xf2f52010
           FUSE_SUPER_MAGIC      0x65735546
           FUTEXFS_SUPER_MAGIC   0xbad1dea  /* Unused */
           HFS_SUPER_MAGIC       0x4244
           HOSTFS_SUPER_MAGIC    0x00c0ffee
           HPFS_SUPER_MAGIC      0xf995e849
           HUGETLBFS_MAGIC       0x958458f6
           ISOFS_SUPER_MAGIC     0x9660
           JFFS2_SUPER_MAGIC     0x72b6
           JFS_SUPER_MAGIC       0x3153464a
           MINIX_SUPER_MAGIC     0x137f     /* original minix FS */
           MINIX_SUPER_MAGIC2    0x138f     /* 30 char minix FS */
           MINIX2_SUPER_MAGIC    0x2468     /* minix V2 FS */
           MINIX2_SUPER_MAGIC2   0x2478     /* minix V2 FS, 30 char names */
           MINIX3_SUPER_MAGIC    0x4d5a     /* minix V3 FS, 60 char names */
           MQUEUE_MAGIC          0x19800202 /* POSIX message queue FS */
           MSDOS_SUPER_MAGIC     0x4d44
           MTD_INODE_FS_MAGIC    0x11307854
           NCP_SUPER_MAGIC       0x564c
           NFS_SUPER_MAGIC       0x6969
           NILFS_SUPER_MAGIC     0x3434
           NSFS_MAGIC            0x6e736673
           NTFS_SB_MAGIC         0x5346544e
           OCFS2_SUPER_MAGIC     0x7461636f
           OPENPROM_SUPER_MAGIC  0x9fa1
           OVERLAYFS_SUPER_MAGIC 0x794c7630
           PIPEFS_MAGIC          0x50495045
           PROC_SUPER_MAGIC      0x9fa0     /* <a href="file:/proc">/proc</a> FS */
           PSTOREFS_MAGIC        0x6165676c
           QNX4_SUPER_MAGIC      0x002f
           QNX6_SUPER_MAGIC      0x68191122
           RAMFS_MAGIC           0x858458f6
           REISERFS_SUPER_MAGIC  0x52654973
           ROMFS_MAGIC           0x7275
           SECURITYFS_MAGIC      0x73636673
           SELINUX_MAGIC         0xf97cff8c
           SMACK_MAGIC           0x43415d53
           SMB_SUPER_MAGIC       0x517b
           SMB2_MAGIC_NUMBER     0xfe534d42
           SOCKFS_MAGIC          0x534f434b
           SQUASHFS_MAGIC        0x73717368
           SYSFS_MAGIC           0x62656572
           SYSV2_SUPER_MAGIC     0x012ff7b6
           SYSV4_SUPER_MAGIC     0x012ff7b5
           TMPFS_MAGIC           0x01021994
           TRACEFS_MAGIC         0x74726163
           UDF_SUPER_MAGIC       0x15013346
           UFS_MAGIC             0x00011954
           USBDEVICE_SUPER_MAGIC 0x9fa2
           V9FS_MAGIC            0x01021997
           VXFS_SUPER_MAGIC      0xa501fcf5
           XENFS_SUPER_MAGIC     0xabba1974
           XENIX_SUPER_MAGIC     0x012ff7b4
           XFS_SUPER_MAGIC       0x58465342
           _XIAFS_SUPER_MAGIC    0x012fd16d /* Linux 2.0 and earlier */

       Most of these MAGIC constants are defined in <u><a href="file:/usr/include/linux/magic.h">/usr/include/linux/magic.h</a></u>, and some are hardcoded in kernel
       sources.

       The <u>f_flags</u> field is a bit mask indicating mount options for the filesystem.  It contains zero or more of
       the following bits:

       <b>ST_MANDLOCK</b>
              Mandatory locking is permitted on the filesystem (see <b><a href="../man2/fcntl.2.html">fcntl</a></b>(2)).

       <b>ST_NOATIME</b>
              Do not update access times; see <b><a href="../man2/mount.2.html">mount</a></b>(2).

       <b>ST_NODEV</b>
              Disallow access to device special files on this filesystem.

       <b>ST_NODIRATIME</b>
              Do not update directory access times; see <b><a href="../man2/mount.2.html">mount</a></b>(2).

       <b>ST_NOEXEC</b>
              Execution of programs is disallowed on this filesystem.

       <b>ST_NOSUID</b>
              The  set-user-ID  and  set-group-ID  bits  are  ignored  by  <b><a href="../man3/exec.3.html">exec</a></b>(3)  for executable files on this
              filesystem

       <b>ST_RDONLY</b>
              This filesystem is mounted read-only.

       <b>ST_RELATIME</b>
              Update atime relative to mtime/ctime; see <b><a href="../man2/mount.2.html">mount</a></b>(2).

       <b>ST_SYNCHRONOUS</b>
              Writes are synched to the filesystem immediately (see the description of <b>O_SYNC</b> in <b><a href="../man2/open.2.html">open</a></b>(2)).

       <b>ST_NOSYMFOLLOW</b> (since Linux 5.10)
              Symbolic links are not followed when resolving paths; see <b><a href="../man2/mount.2.html">mount</a></b>(2).

       Nobody knows what <u>f_fsid</u> is supposed to contain (but see below).

       Fields that are undefined for a particular filesystem are set to 0.

       <b>fstatfs</b>() returns the same information about an open file referenced by descriptor <u>fd</u>.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, zero is returned.  On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EACCES</b> (<b>statfs</b>()) Search permission is denied for a component of the path  prefix  of  <u>path</u>.   (See  also
              <b><a href="../man7/path_resolution.7.html">path_resolution</a></b>(7).)

       <b>EBADF</b>  (<b>fstatfs</b>()) <u>fd</u> is not a valid open file descriptor.

       <b>EFAULT</b> <u>buf</u> or <u>path</u> points to an invalid address.

       <b>EINTR</b>  The call was interrupted by a signal; see <b><a href="../man7/signal.7.html">signal</a></b>(7).

       <b>EIO</b>    An I/O error occurred while reading from the filesystem.

       <b>ELOOP</b>  (<b>statfs</b>()) Too many symbolic links were encountered in translating <u>path</u>.

       <b>ENAMETOOLONG</b>
              (<b>statfs</b>()) <u>path</u> is too long.

       <b>ENOENT</b> (<b>statfs</b>()) The file referred to by <u>path</u> does not exist.

       <b>ENOMEM</b> Insufficient kernel memory was available.

       <b>ENOSYS</b> The filesystem does not support this call.

       <b>ENOTDIR</b>
              (<b>statfs</b>()) A component of the path prefix of <u>path</u> is not a directory.

       <b>EOVERFLOW</b>
              Some values were too large to be represented in the returned struct.

</pre><h4><b>VERSIONS</b></h4><pre>
   <b>The</b> <b>f_fsid</b> <b>field</b>
       Solaris,  Irix,  and  POSIX  have  a  system  call  <b><a href="../man2/statvfs.2.html">statvfs</a></b>(2)  that returns a <u>struct</u> <u>statvfs</u> (defined in
       <u>&lt;sys/statvfs.h&gt;</u>) containing an <u>unsigned</u> <u>long</u> <u>f_fsid</u>.  Linux, SunOS, HP-UX,  4.4BSD  have  a  system  call
       <b>statfs</b>()  that  returns a <u>struct</u> <u>statfs</u> (defined in <u>&lt;sys/vfs.h&gt;</u>) containing a <u>fsid_t</u> <u>f_fsid</u>, where <u>fsid_t</u>
       is defined as <u>struct</u> <u>{</u> <u>int</u> <u>val[2];</u> <u>}</u>.  The same holds for FreeBSD, except that it uses the  include  file
       <u>&lt;sys/mount.h&gt;</u>.

       The  general  idea  is  that  <u>f_fsid</u>  contains some random stuff such that the pair (<u>f_fsid</u>,<u>ino</u>) uniquely
       determines a file.  Some operating systems use (a variation on) the device number, or the  device  number
       combined with the filesystem type.  Several operating systems restrict giving out the <u>f_fsid</u> field to the
       superuser  only (and zero it for unprivileged users), because this field is used in the filehandle of the
       filesystem when NFS-exported, and giving it out is a security concern.

       Under some operating systems, the <u>fsid</u> can be used as the second argument to the <b><a href="../man2/sysfs.2.html">sysfs</a></b>(2) system call.

</pre><h4><b>STANDARDS</b></h4><pre>
       Linux.

</pre><h4><b>HISTORY</b></h4><pre>
       The Linux <b>statfs</b>() was inspired by the 4.4BSD one (but they do not use the same structure).

       The original Linux <b>statfs</b>() and <b>fstatfs</b>() system calls were not designed with extremely large file  sizes
       in  mind.   Subsequently,  Linux  2.6 added new <b>statfs64</b>() and <b>fstatfs64</b>() system calls that employ a new
       structure, <u>statfs64</u>.  The new structure contains the same fields as the original  <u>statfs</u>  structure,  but
       the  sizes  of  various  fields  are  increased, to accommodate large file sizes.  The glibc <b>statfs</b>() and
       <b>fstatfs</b>() wrapper functions transparently deal with the kernel differences.

       LSB has deprecated the library  calls  <b>statfs</b>()  and  <b>fstatfs</b>()  and  tells  us  to  use  <b><a href="../man3/statvfs.3.html">statvfs</a></b>(3)  and
       <b><a href="../man3/fstatvfs.3.html">fstatvfs</a></b>(3) instead.

</pre><h4><b>NOTES</b></h4><pre>
       The  <b>__</b><u>fsword_t</u> type used for various fields in the <u>statfs</u> structure definition is a glibc internal type,
       not intended for public use.  This leaves the programmer in a bit of a conundrum when trying to  copy  or
       compare  these fields to local variables in a program.  Using <u>unsigned</u> <u>int</u> for such variables suffices on
       most systems.

       Some systems have only <u>&lt;sys/vfs.h&gt;</u>, other systems also have <u>&lt;sys/statfs.h&gt;</u>, where the former includes the
       latter.  So it seems including the former is the best choice.

</pre><h4><b>BUGS</b></h4><pre>
       From Linux 2.6.38 up to and including Linux  3.1,  <b>fstatfs</b>()  failed  with  the  error  <b>ENOSYS</b>  for  file
       descriptors created by <b><a href="../man2/pipe.2.html">pipe</a></b>(2).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/stat.2.html">stat</a></b>(2), <b><a href="../man3/statvfs.3.html">statvfs</a></b>(3), <b><a href="../man7/path_resolution.7.html">path_resolution</a></b>(7)

Linux man-pages 6.9.1                              2024-05-02                                          <u><a href="../man2/statfs.2.html">statfs</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>