<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>connect-haproxy-tcp-socket - Golf documentation (web-servers)</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/golf">golf_601.4.41-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       connect-haproxy-tcp-socket - Golf documentation (web-servers)

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  shows how to connect your application listening on TCP port &lt;port number&gt; (started with "-p" option
       in <b>mgrg</b>) to HAProxy load balancer.

       One use of HAProxy is to balance the load between different web servers, which in turn are  connected  to
       your  Golf  applications;  in this case HAProxy does not directly communicate with your Golf applications
       (which are behind other web servers).

       However, when you want HAProxy to directly communicate with your Golf application servers,  you  may  use
       configuration  similar  to  this  (shown  is  just  a bare-bone setup needed to accomplish the goal, note
       sections "frontend", "fcgi-app" and "backend" that are relevant to Golf). The HAProxy configuration  file
       is typically in "/etc/haproxy/haproxy.cfg":

           global
               user haproxy
               group haproxy
               daemon

           defaults
               mode    http
               timeout connect 5000
               timeout client  50000
               timeout server  50000
               errorfile 400 /etc/haproxy/errors/400.http
               errorfile 403 /etc/haproxy/errors/403.http
               errorfile 408 /etc/haproxy/errors/408.http
               errorfile 500 /etc/haproxy/errors/500.http
               errorfile 502 /etc/haproxy/errors/502.http
               errorfile 503 /etc/haproxy/errors/503.http
               errorfile 504 /etc/haproxy/errors/504.http

           frontend front_server
               mode http
               bind *:90
               use_backend backend_servers if { path_reg -i ^.*\/&lt;your golf app name&gt;\<a href="file:/.">/.</a>*$ }
               option forwardfor

           fcgi-app golf-fcgi
               log-stderr global
               docroot /var/lib/gg/&lt;your golf app name&gt;<a href="file:/app">/app</a>
               path-info ^.+(/&lt;your golf app name&gt;)(<a href="file:/.">/.</a>+)$

           backend backend_servers
               mode http
               filter fcgi-app golf-fcgi
               use-fcgi-app golf-fcgi
               server s1 127.0.0.1:3000 proto fcgi

       Restart HAProxy:

           sudo systemctl restart haproxy

       Note  that  Golf  application path is "/&lt;your golf app name&gt;" (and the application name may or may not be
       the same, see <b>request</b>). The TCP port of the application is "3000" (could be any port  number  you  choose
       that's greater than 1000 and lower than 65535).

       HAProxy  itself  is  bound  to  port  90  in  this example (see "frontend" section above), and "path_reg"
       specifies which URLs will be passed to your Golf application  (i.e.  they  must  have  "/&lt;your  golf  app
       name&gt;/"  in  the URL). "path-info" specifies SCRIPT_NAME and PATH_INFO (as "()" regular sub-expressions),
       which are as such passed to your Golf application. "docroot" is set to  the  application  home  directory
       (see  <b>directories</b>)  in  case you wish to serve HTML documents from it; however if you keep sensitive data
       there, specify another directory.

       A Golf application (named "&lt;your  golf  app  name&gt;")  would  have  been  started  with  (using  the  same
       application name "&lt;your golf app name&gt;" and TCP port "3000"):

           mgrg -p 3000 &lt;your golf app name&gt;

       Now  you  should  be able to connect and load-balance your Golf application servers directly from HAProxy
       (which in this example listens on port 90, so you'd refer  to  it  with  https://your-web-server:90/&lt;your
       golf app name&gt;/...).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        Web servers

       <b>connect-apache-tcp-socket</b>  <b>connect-apache-unix-socket</b> <b>connect-haproxy-tcp-socket</b> <b>connect-nginx-tcp-socket</b>
       <b>connect-nginx-unix-socket</b> See all <b>documentation</b>

$DATE                                               $VERSION                                           <u><a href="../man2gg/GOLF.2gg.html">GOLF</a></u>(2gg)
</pre>
 </div>
</div></section>
</div>
</body>
</html>