<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shm_open, shm_unlink — shared memory object operations</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       shm_open, shm_unlink — shared memory object operations

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C Library (libc, -lc)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/types.h&gt;</b>
       <b>#include</b> <b>&lt;sys/mman.h&gt;</b>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/fcntl.h">fcntl.h</a>&gt;</b>

       <u>int</u>
       <b>shm_open</b>(<u>const</u> <u>char</u> <u>*path</u>, <u>int</u> <u>flags</u>, <u>mode_t</u> <u>mode</u>);

       <u>int</u>
       <b>shm_unlink</b>(<u>const</u> <u>char</u> <u>*path</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>shm_open</b>()  system  call opens (or optionally creates) a POSIX shared memory object named <u>path</u>.  The
       <u>flags</u> argument contains a subset of the flags used by <u><a href="../man2/open.2.html">open</a></u>(2).  An access  mode  of  either  O_RDONLY  or
       O_RDWR must be included in <u>flags</u>.  The optional flags O_CREAT, O_EXCL, and O_TRUNC may also be specified.

       If O_CREAT is specified, then a new shared memory object named <u>path</u> will be created if it does not exist.
       In this case, the shared memory object is created with mode <u>mode</u> subject to the process' umask value.  If
       both  the  O_CREAT  and  O_EXCL flags are specified and a shared memory object named <u>path</u> already exists,
       then <b>shm_open</b>() will fail with EEXIST.

       Newly created objects start off with a size of zero.  If an existing shared memory object is opened  with
       O_RDWR  and  the  O_TRUNC flag is specified, then the shared memory object will be truncated to a size of
       zero.  The size of the object can be adjusted via <u><a href="../man2/ftruncate.2.html">ftruncate</a></u>(2) and queried via <u><a href="../man2/fstat.2.html">fstat</a></u>(2).

       The new descriptor is set to close during <u><a href="../man2/execve.2.html">execve</a></u>(2) system calls; see <u><a href="../man2/close.2.html">close</a></u>(2) and <u><a href="../man2/fcntl.2.html">fcntl</a></u>(2).

       As a FreeBSD extension, the constant SHM_ANON may be used for the <u>path</u> argument to <b>shm_open</b>().   In  this
       case,  an anonymous, unnamed shared memory object is created.  Since the object has no name, it cannot be
       removed via a subsequent call to <b>shm_unlink</b>().   Instead,  the  shared  memory  object  will  be  garbage
       collected  when  the last reference to the shared memory object is removed.  The shared memory object may
       be shared with other processes by sharing the file descriptor via <u><a href="../man2/fork.2.html">fork</a></u>(2) or <u><a href="../man2/sendmsg.2.html">sendmsg</a></u>(2).   Attempting  to
       open an anonymous shared memory object with O_RDONLY will fail with EINVAL.  All other flags are ignored.

       The <b>shm_unlink</b>() system call removes a shared memory object named <u>path</u>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       If  successful, <b>shm_open</b>() returns a non-negative integer, and <b>shm_unlink</b>() returns zero.  Both functions
       return -1 on failure, and set <u>errno</u> to indicate the error.

</pre><h4><b>COMPATIBILITY</b></h4><pre>
       The  <u>path</u>  argument  does  not  necessarily  represent  a  pathname  (although  it  does  in  most  other
       implementations).   Two  processes  opening the same <u>path</u> are guaranteed to access the same shared memory
       object if and only if <u>path</u> begins with a slash (‘/’) character.

       Only the O_RDONLY, O_RDWR, O_CREAT, O_EXCL, and O_TRUNC flags may be used in portable programs.

       POSIX specifications state that the result of using <u><a href="../man2/open.2.html">open</a></u>(2), <u><a href="../man2/read.2.html">read</a></u>(2), or  <u><a href="../man2/write.2.html">write</a></u>(2)  on  a  shared  memory
       object,  or  on  the  descriptor  returned  by  <b>shm_open</b>(),  is  undefined.   However, the FreeBSD kernel
       implementation explicitly includes support for <u><a href="../man2/read.2.html">read</a></u>(2) and <u><a href="../man2/write.2.html">write</a></u>(2).

       FreeBSD also supports zero-copy transmission of data from shared memory objects with <u><a href="../man2/sendfile.2.html">sendfile</a></u>(2).

       Neither shared memory objects nor their contents persist across reboots.

       Writes do not extend shared memory objects, so <u><a href="../man2/ftruncate.2.html">ftruncate</a></u>(2)  must  be  called  before  any  data  can  be
       written.  See “EXAMPLES”.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This example fails without the call to <u><a href="../man2/ftruncate.2.html">ftruncate</a></u>(2):

               uint8_t buffer[getpagesize()];
               ssize_t len;
               int fd;

               fd = shm_open(SHM_ANON, O_RDWR | O_CREAT, 0600);
               if (fd &lt; 0)
                       err(EX_OSERR, "%s: shm_open", __func__);
               if (ftruncate(fd, getpagesize()) &lt; 0)
                       err(EX_IOERR, "%s: ftruncate", __func__);
               len = pwrite(fd, buffer, getpagesize(), 0);
               if (len &lt; 0)
                       err(EX_IOERR, "%s: pwrite", __func__);
               if (len != getpagesize())
                       errx(EX_IOERR, "%s: pwrite length mismatch", __func__);

</pre><h4><b>ERRORS</b></h4><pre>
       <b>shm_open</b>() fails with these error codes for these conditions:

       [EINVAL]           A flag other than O_RDONLY, O_RDWR, O_CREAT, O_EXCL, or O_TRUNC was included in <u>flags</u>.

       [EMFILE]           The process has already reached its limit for open file descriptors.

       [ENFILE]           The system file table is full.

       [EINVAL]           O_RDONLY was specified while creating an anonymous shared memory object via SHM_ANON.

       [EFAULT]           The <u>path</u> argument points outside the process' allocated address space.

       [ENAMETOOLONG]     The entire pathname exceeded 1023 characters.

       [EINVAL]           The <u>path</u> does not begin with a slash (‘/’) character.

       [ENOENT]           O_CREAT is specified and the named shared memory object does not exist.

       [EEXIST]           O_CREAT and O_EXCL are specified and the named shared memory object does exist.

       [EACCES]           The required permissions (for reading or reading and writing) are denied.

       <b>shm_unlink</b>() fails with these error codes for these conditions:

       [EFAULT]           The <u>path</u> argument points outside the process' allocated address space.

       [ENAMETOOLONG]     The entire pathname exceeded 1023 characters.

       [ENOENT]           The named shared memory object does not exist.

       [EACCES]           The  required  permissions  are denied.  <b>shm_unlink</b>() requires write permission to the
                          shared memory object.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/close.2.html">close</a></u>(2), <u><a href="../man2/fstat.2.html">fstat</a></u>(2), <u><a href="../man2/ftruncate.2.html">ftruncate</a></u>(2), <u><a href="../man2/mmap.2.html">mmap</a></u>(2), <u><a href="../man2/munmap.2.html">munmap</a></u>(2), <u><a href="../man2/sendfile.2.html">sendfile</a></u>(2)

</pre><h4><b>STANDARDS</b></h4><pre>
       The <b>shm_open</b>() and <b>shm_unlink</b>() functions are believed to conform to IEEE Std 1003.1b-1993 (“POSIX.1”).

</pre><h4><b>HISTORY</b></h4><pre>
       The  <b>shm_open</b>()  and  <b>shm_unlink</b>()  functions  first  appeared  in  FreeBSD  4.3.   The  functions   were
       reimplemented as system calls using shared memory objects directly rather than files in FreeBSD 8.0.

</pre><h4><b>AUTHORS</b></h4><pre>
       Garrett A. Wollman &lt;<u><a href="mailto:wollman@FreeBSD.org">wollman@FreeBSD.org</a></u>&gt; (C library support and this manual page)

       Matthew Dillon &lt;<u><a href="mailto:dillon@FreeBSD.org">dillon@FreeBSD.org</a></u>&gt; (MAP_NOSYNC)

Debian                                          January 20, 2017                                     <u><a href="../man2/SHM_OPEN.2.html">SHM_OPEN</a></u>(2)
</pre>
 </div>
</div></section>
</div>
</body>
</html>