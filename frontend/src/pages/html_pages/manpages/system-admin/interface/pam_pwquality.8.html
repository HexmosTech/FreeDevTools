<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_pwquality - PAM module to perform password quality checking</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-pwquality">libpam-pwquality_1.4.5-5_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_pwquality - PAM module to perform password quality checking

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pam_pwquality.so</b> [<u>...</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module can be plugged into the <b>password</b> stack of a given service to provide some plug-in strength-
       checking for passwords.  The code was originally based on pam_cracklib module and the module is backwards
       compatible with its options.

       The action of this module is to prompt the user for a password and check its strength against a system
       dictionary and a set of rules for identifying poor choices.

       The first action is to prompt for a single password, check its strength and then, if it is considered
       strong, prompt for the password a second time (to verify that it was typed correctly on the first
       occasion). All being well, the password is passed on to subsequent modules to be installed as the new
       authentication token.

       The checks for strength are:

       Palindrome
           Is the new password a palindrome?

       Case Change Only
           Is the new password the same as the old one with only a change of case?

       Similar
           Is  the  new  password too much like the old one? This is primarily controlled by one argument, <b>difok</b>
           which is a number of character changes (inserts, removals, or replacements) between the old  and  new
           password that are enough to accept the new password.

       Simple
           Is  the  new  password  too small? This is controlled by 6 arguments <b>minlen</b>, <b>maxclassrepeat</b>, <b>dcredit</b>,
           <b>ucredit</b>, <b>lcredit</b>, and <b>ocredit</b>. See the section on the arguments for the details of how these work and
           there defaults.

       Rotated
           Is the new password a rotated version of the old password?

       Same consecutive characters
           Optional check for same consecutive characters.

       Too long monotonic character sequence
           Optional check for too long monotonic character sequence.

       Contains user name
           Check whether the password contains the user's name in some form.

       Dictionary check
           The <u>Cracklib</u> routine is called to check if the password is part of a dictionary.

       These  checks  are  configurable  either  by  use  of  the  module  arguments   or   by   modifying   the
       <u>/etc/security/pwquality.conf</u>  configuration  file.  The  module  arguments  override  the settings in the
       configuration file.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>debug</b>
           This option makes the module write information to <b><a href="../man3/syslog.3.html">syslog</a></b>(3) indicating the  behavior  of  the  module
           (this option does not write password information to the log file).

       <b>authtok_type=</b><u>XXX</u>
           The  default  action  is  for the module to use the following prompts when requesting passwords: "New
           UNIX password: " and "Retype UNIX password: ". The example  word  <u>UNIX</u>  can  be  replaced  with  this
           option, by default it is empty.

       <b>retry=</b><u>N</u>
           Prompt user at most <u>N</u> times before returning with error. The default is <u>1</u>.

       <b>difok=</b><u>N</u>
           This argument will change the default of <u>1</u> for the number of changes in the new password from the old
           password.

           The  special  value  of <u>0</u> disables all checks of similarity of the new password with the old password
           except the new password being exactly the same as the old one.

       <b>minlen=</b><u>N</u>
           The minimum acceptable size for the new password (plus one if credits are not disabled which  is  the
           default).  In  addition  to the number of characters in the new password, credit (of +1 in length) is
           given for each different kind of character (<u>other</u>, <u>upper</u>, <u>lower</u> and  <u>digit</u>).  The  default  for  this
           parameter  is  <u>8</u>.  Note  that  there  is  a pair of length limits also in <u>Cracklib</u>, which is used for
           dictionary checking, a "way too short" limit of <u>4</u> which is hard coded in and  a  build  time  defined
           limit (<u>6</u>) that will be checked without reference to <b>minlen</b>.

       <b>dcredit=</b><u>N</u>
           (N  &gt;= 0) This is the maximum credit for having digits in the new password.  If you have less than or
           <u>N</u> digits, each digit will count +1 towards meeting the current <b>minlen</b> value. The default for  <b>dcredit</b>
           is <u>0</u> which means there is no bonus for digits in password.

           (N &lt; 0) This is the minimum number of digits that must be met for a new password.

       <b>ucredit=</b><u>N</u>
           (N  &gt;=  0) This is the maximum credit for having upper case letters in the new password.  If you have
           less than or <u>N</u> upper case letters, each upper case letter will count +1 towards meeting  the  current
           <b>minlen</b>  value.  The  default for <b>ucredit</b> is <u>0</u> which means there is no bonus for upper case letters in
           password.

           (N &lt; 0) This is the minimum number of upper case letters that must be met for a new password.

       <b>lcredit=</b><u>N</u>
           (N &gt;= 0) This is the maximum credit for having lower case letters in the new password.  If  you  have
           less  than  or <u>N</u> lower case letters, each lower case letter will count +1 towards meeting the current
           <b>minlen</b> value. The default for <b>lcredit</b> is <u>0</u> which means there is no bonus for lower  case  letters  in
           password.

           (N &lt; 0) This is the minimum number of lower case letters that must be met for a new password.

       <b>ocredit=</b><u>N</u>
           (N  &gt;=  0)  This  is the maximum credit for having other characters in the new password.  If you have
           less than or <u>N</u> other characters, each other character will  count  +1  towards  meeting  the  current
           <b>minlen</b>  value.  The  default  for  <b>ocredit</b> is <u>0</u> which means there is no bonus for other characters in
           password.

           (N &lt; 0) This is the minimum number of other characters that must be met for a new password.

       <b>minclass=</b><u>N</u>
           The minimum number of required classes of characters for the new  password.   The  four  classes  are
           digits,  upper  and lower letters and other characters.  The difference to the <b>credit</b> check is that a
           specific class if of characters is not required. Instead <u>N</u> out of four of the classes  are  required.
           By default the check is disabled.

       <b>maxrepeat=</b><u>N</u>
           Reject passwords which contain more than <u>N</u> same consecutive characters.  The default is 0 which means
           that this check is disabled.

       <b>maxsequence=</b><u>N</u>
           Reject  passwords  which contain monotonic character sequences longer than <u>N</u>.  The default is 0 which
           means that this check is disabled.  Examples of such sequence are '12345' or 'fedcb'. Note that  most
           such  passwords  will  not  pass the simplicity check unless the sequence is only a minor part of the
           password.

       <b>maxclassrepeat=</b><u>N</u>
           Reject passwords which contain more than <u>N</u> consecutive characters of the same class. The default is 0
           which means that this check is disabled.

       <b>gecoscheck=</b><u>N</u>
           If nonzero, check whether the individual words longer than 3  characters  from  the  <b><a href="../man5/passwd.5.html">passwd</a></b>(5)  GECOS
           field  of the user are contained in the new password. The default is 0 which means that this check is
           disabled.

       <b>dictcheck=</b><u>N</u>
           If nonzero, check whether the password (with possible modifications) matches a word in a  dictionary.
           Currently  the dictionary check is performed using the <u>cracklib</u> library. The default is 1 which means
           that this check is enabled.

       <b>usercheck=</b><u>N</u>
           If nonzero, check whether the password (with possible modifications) contains the user name  in  some
           form.  The  default  is  1 which means that this check is enabled. It is not performed for user names
           shorter than 3 characters.

       <b>usersubstr=</b><u>N</u>
           If greater than 3 (due to the minimum length in usercheck), check whether  the  password  contains  a
           substring  of  the  user  name of at least <u>N</u> length in some form.  The default is 0, which means this
           check is disabled.

       <b>enforcing=</b><u>N</u>
           If nonzero, reject the password if it fails the checks, otherwise only print the warning. The default
           is 1 which means that the weak password is rejected (for non-root users).

       <b>badwords=</b><u>&lt;list</u> <u>of</u> <u>words&gt;</u>
           The words more than 3 characters long from this space separated list are  individually  searched  for
           and  forbidden  in  the  new  password.   By default the list is empty which means that this check is
           disabled.

       <b>dictpath=</b><u>/path/to/dict</u>
           This options allows for specification of non-default path to the cracklib dictionaries.

       <b>enforce_for_root</b>
           The module will return error on failed check even if the user changing the  password  is  root.  This
           option is off by default which means that just the message about the failed check is printed but root
           can  change  the  password anyway. Note that root is not asked for an old password so the checks that
           compare the old and new password are not performed.

       <b>local_users_only</b>
           The module will not test the password quality for users that are not present in the <u><a href="file:/etc/passwd">/etc/passwd</a></u> file.
           The module still asks for the password so the following modules in the stack can use the  <b>use_authtok</b>
           option.  This option is off by default.

       <b>use_authtok</b>
           This  argument  is used to <u>force</u> the module to not prompt the user for a new password but use the one
           provided by the previously stacked <b>password</b> module.

</pre><h4><b>MODULE</b> <b>TYPES</b> <b>PROVIDED</b></h4><pre>
       Only the <b>password</b> module type is provided.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       PAM_SUCCESS
           The new password passes all checks.

       PAM_AUTHTOK_ERR
           No new password was entered, the username could not be determined  or  the  new  password  fails  the
           strength checks.

       PAM_AUTHTOK_RECOVERY_ERR
           The  old  password  was not supplied by a previous stacked module or got not requested from the user.
           The first error can happen if <b>use_authtok</b> is specified.

       PAM_SERVICE_ERR
           A internal error occurred.

</pre><h4><b>EXAMPLES</b></h4><pre>
       For an example of the use of this module, we show how it may be stacked with the  password  component  of
       <b><a href="../man8/pam_unix.8.html">pam_unix</a></b>(8).

        #
        # These lines stack two password type modules. In this example the
        # user is given 3 opportunities to enter a strong password. The
        # "use_authtok" argument ensures that the pam_unix module does not
        # prompt for a password, but instead uses the one provided by
        # pam_pwquality.
        #
        password required pam_pwquality.so retry=3
        password required pam_unix.so use_authtok

       Another example is for the case that you want to use sha256 password encryption:

        #
        # These lines allow modern systems to support passwords of at least 14
        # bytes with extra credit of 2 for digits and 2 for others the new
        # password must have at least three bytes that are not present in the
        # old password
        #
        password required pam_pwquality.so \
                      difok=3 minlen=15 dcredit=2 ocredit=2
        password required pam_unix.so use_authtok nullok sha256

       And here is another example in case you don't want to use credits:

        #
        # These lines require the user to select a password with a minimum
        # length of 8 and with at least 1 digit number, 1 upper case letter,
        # and 1 other character
        #
        password required pam_pwquality.so \
                      dcredit=-1 ucredit=-1 ocredit=-1 lcredit=0 minlen=8
        password required pam_unix.so use_authtok nullok sha256

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/pwscore.1.html">pwscore</a></b>(1), <b><a href="../man5/pwquality.conf.5.html">pwquality.conf</a></b>(5), <b><a href="../man8/pam_pwquality.8.html">pam_pwquality</a></b>(8), <b><a href="../man5/pam.conf.5.html">pam.conf</a></b>(5), <b><a href="../man8/PAM.8.html">PAM</a></b>(8)

</pre><h4><b>AUTHORS</b></h4><pre>
       Tomas Mraz &lt;<a href="mailto:tmraz@redhat.com">tmraz@redhat.com</a>&gt;

       Original author of <b>pam_cracklib</b> module Cristian Gafton &lt;<a href="mailto:gafton@redhat.com">gafton@redhat.com</a>&gt;

Red Hat, Inc.                                      2022-11-18                                   <u><a href="../man8/PAM_PWQUALITY.8.html">PAM_PWQUALITY</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>