<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_alreadyloggedin — Already-logged-in PAM module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-alreadyloggedin">libpam-alreadyloggedin_0.3-14_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_alreadyloggedin — Already-logged-in PAM module

</pre><h4><b>SYNOPSIS</b></h4><pre>
       [<u>service-name</u>] <u>module-type</u> <u>control-flag</u> <u>pam_alreadyloggedin</u> [<u>options</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  Already-logged-in  authentication service module for PAM, <b>pam_alreadyloggedin</b> provides functionality
       for only one PAM category: authentication.  In terms of the <u>module-type</u> parameter,  this  is  the  “<b>auth</b>”
       feature.  It also provides null functions for other PAM categories.

   <b>Already-logged-in</b> <b>Authentication</b> <b>Module</b>
       The  Already-logged-in  authentication  component (<b>pam_sm_authenticate</b>()), returns success if and only if
       the target user's ID is identical to a current login specified in the <u><a href="../man5/utmp.5.html">utmp</a></u>(5) database and verified  with
       matching  permissions  on  that  login's respective terminal in <u><a href="file:/dev">/dev</a></u>.  If a user shows up in <u><a href="../man8/w.8.html">w</a></u>(8) output,
       they will generally be allowed to authenticate using this method.

       The following options may be passed to the authentication module:

       <b>debug</b>                           Enable verbose output to syslog at LOG_DEBUG level.

       <b>no_debug</b>                        Disable verbose output to syslog even it's enabled at compile time.

       <b>no_root</b>                         Never allow login with a target user ID of zero.

       <b>restrict_tty</b>=<u>ttyglob*</u>           Only allow login if the terminal device currently being authenticated  on
                                       matches  <u>ttyglob*</u>.   The  <u>ttyglob*</u> argument is specified as a shell glob,
                                       and   checked   using   the    <u><a href="../man3/fnmatch.3.html">fnmatch</a></u>(3)    function.    For    example,
                                       <b>restrict_tty=/dev/tty[1-6]</b>  allows logging from text consoles of physical
                                       terminal only.

       <b>restrict_loggedin_tty</b>=<u>ttyglob*</u>  Disallow recognition that the  user  is  already  logged  in  unless  the
                                       terminal device logged in upon matches <u>ttyglob*</u>.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Modify <b>auth</b> section of the <u><a href="file:/etc/pam.d/login">/etc/pam.d/login</a></u> file like following:

             auth required   /lib/security/pam_securetty.so
             auth sufficient /lib/security/pam_alreadyloggedin.so no_root
             auth required   /lib/security/pam_stack.so service=system-auth

</pre><h4><b>BUGS</b></h4><pre>
       FreeBSD  version expects <u><a href="file:/dev/">/dev/</a></u> prefix in <b>restrict_tty</b> value, but value of <b>restrict_loggedin_tty</b> should be
       without them.  Linux version expects <u><a href="file:/dev/">/dev/</a></u> in both cases.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/fnmatch.3.html">fnmatch</a></u>(3), <u><a href="../man2/getuid.2.html">getuid</a></u>(2), <u><a href="../man2/stat.2.html">stat</a></u>(2), <u><a href="../man5/utmp.5.html">utmp</a></u>(5), <u><a href="../man8/w.8.html">w</a></u>(8), <u><a href="../man5/pam.conf.5.html">pam.conf</a></u>(5), <u><a href="../man8/pam.8.html">pam</a></u>(8)

</pre><h4><b>AUTHORS</b></h4><pre>
       Adopted for Linux PAM by Ilya Evseev at Jan 2004.

       The original <b>pam_alreadyloggedin</b> module and this manual page were developed for the  FreeBSD  Project  by
       NAI  Labs and ThinkSec AS, the Security Research Division of Network Associates, Inc.  under DARPA/SPAWAR
       contract N66001-01-C-8035 (“CBOSS”), as part of the DARPA CHATS research program.

Linux-PAM                                       January 30, 2004                          <u><a href="../man8/PAM_ALREADYLOGGEDIN.8.html">PAM_ALREADYLOGGEDIN</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>