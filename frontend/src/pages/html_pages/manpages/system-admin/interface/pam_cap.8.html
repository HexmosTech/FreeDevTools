<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_cap - Capabilities PAM module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-cap">libpam-cap_2.75-7ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pam_cap</b> - Capabilities PAM module

</pre><h4><b>SYNOPSIS</b></h4><pre>
       [service-name] <b>auth</b> control-flag <b>pam_cap</b> [options]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>pam_so</b>  module  can  be  used to specify <u>Inheritable</u> capabilities to process trees rooted in the PAM
       application. The module also supports blocking <u>Bounding</u> vector capabilities  and  adding  <u>Ambient</u>  vector
       capabilities.

       For  general  PAM apps to work correctly, the application must be run with at least <b>CAP_SETPCAP</b> raised in
       its <u>Permitted</u> capability flag. Many PAM applications run as <u>root</u>, which  has  all  of  the  bits  in  the
       <u>Bounding</u>  set  raised,  so  this requirement is typically met. To grant an <u>Ambient</u> vector capability, the
       corresponding Permitted bit must be available to the application too.

       The <b>pam_so</b> module is a Linux-PAM <u>auth</u> module. It provides functionality to back <b>pam_sm_authenticate()</b> and
       <b>pam_sm_setcred()</b>. It is the latter that actually modifies the inheritable 3-tuple of capability  vectors:
       the configured <u>IAB</u>. In a typical application configuration you might have a line like this:

           auth    optional    pam_cap.so

       The module arguments are:

       ○   <b>debug</b>: While supported, this is a no-op at present.

       ○   <b>config=</b><u>/path/to/file</u>:  Override  the default config for the module. The unspecified default value for
           this file is <b><a href="file:/etc/security/capability.conf">/etc/security/capability.conf</a></b>. Note, <b>config=/dev/null</b> is a  valid  value.  See  <b>default=</b>
           below for situations in which this might be appropriate.

       ○   <b>keepcaps</b>:  This  is as much as the <b>pam_cap.so</b> module can do to help an application support use of the
           <u>Ambient</u> capability vector. The application support for the <u>Ambient</u> set is poor at the present time.

       ○   <b>autoauth</b>: This argument causes the <b>pam_cap.so</b> module to return  <b>PAM_SUCCESS</b>  if  the  <b>PAM_USER</b>  being
           authenticated  exists.  The absence of this argument will cause <b>pam_cap.so</b> to only return <b>PAM_SUCCESS</b>
           if the <b>PAM_USER</b> is covered by a specific rule in the prevailing config file.

       ○   <b>default=</b><u>IAB</u>: This argument is ignored if the prevailing configuration file contains a  "<b>*</b>"  rule.  If
           there  is  no such rule, the <u>IAB</u> 3-tuple is inserted at the end of the config file and applies to all
           <b>PAM_USER</b>s not covered by an earlier rule. Note, if you want all  <b>PAM_USER</b>s  to  be  covered  by  this
           default rule, you can supply the module argument <b>config=/dev/null</b>.

       ○   <b>defer</b>:  This  argument  arranges  for the <u>IAB</u> capabilities granted to a user to be added sufficiently
           late in the Linux-PAM authentication stack that they stick. That is, <u>after</u> the application  does  its
           <b>setuid(UID)</b>  call.  As  such,  in  conjunction  with  the  <b>keepcaps</b>  module  argument, such compliant
           applications can support granting <u>Ambient</u> vector capabilities with <b>pam_cap.so</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/pam.conf.5.html">pam.conf</a></b>(5), <b><a href="../man5/capability.conf.5.html">capability.conf</a></b>(5), <b><a href="../man8/pam.8.html">pam</a></b>(8).

                                                   April 2024                                         <u><a href="../man8/PAM_CAP.8.html">PAM_CAP</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>