<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hwmon_ina219 - Driver for UPS based on INA219</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/nut-i2c">nut-i2c_2.8.3-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       hwmon_ina219 - Driver for UPS based on INA219

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>hwmon_ina219</b> -h

       <b>hwmon_ina219</b> -a <u>UPS_NAME</u> [<u>OPTIONS</u>]

           <b>Note</b>

           This man page only documents the specific features of the <b>hwmon_ina219</b> driver. For information about
           the core driver, see <b><a href="../man8/nutupsdrv.8.html">nutupsdrv</a></b>(8).

       The driver implements reading of current and voltage from INA219 by using hwmon sysfs API of the Linux
       Kernel. There is no other UPS-like logic in there. Based on the measurements of the battery voltage and
       charging current, the driver makes assumptions of the current state of the system.

</pre><h4><b>SUPPORTED</b> <b>HARDWARE</b></h4><pre>
       The <b>hwmon_ina219</b> driver is based on setup with Raspberry PI Compute Module 4 and its baseboard Waveshare
       CM4-POE-UPS-BASE.

</pre><h4><b>EXTRA</b> <b>ARGUMENTS</b></h4><pre>
       The required parameter for this driver:

       <b>port</b>=<u>hwmon-dir</u>
           Path to appropriate /sys/hwmon/hwmonX or <u>auto</u> to detect automatically.

       Optional parameters:

       <b>default.battery.charge.low</b>=<u>low-battery-threshold</u>
           Threshold for low battery state (in percent).

       <b>default.battery.voltage.nominal</b>=<u>voltage-value</u>
           Nominal voltage (V) value of utilized batteries, used to derive their low and high watermark settings
           (see below). Default: 3.6.

           Known pre-sets include: 3.6, 3.7, 3.8, 3.85.

       <b>default.battery.voltage.low</b>=<u>voltage-value</u>
           Low voltage (V) value of used batteries. Practically, it denotes depleted batteries. If not given, it
           is derived from the <b>battery.voltage.nominal</b>.

       <b>default.battery.voltage.high</b>=<u>voltage-value</u>
           High voltage (V) value of used batteries. Practically, it denotes fully charged batteries. If not
           given, it is derived from the <b>battery.voltage.nominal</b>.

</pre><h4><b>INSTALLATION</b></h4><pre>
       This driver is specific to the Linux hwmon API.

       When using with the Waveshare CM4-POE-UPS-BASE baseboard, there are few steps to be done to enable access
       to the INA219 circuit:

        1. edit boot/config.txt:

                 dtparam=i2c_vc=on
                 dtoverlay=i2c-ina219

        2. create a new device tree overlay file i2c-ina219.dts:

               /dts-v1/;
               /plugin/;

               / {
                   compatible = "brcm,bcm2835";

                   fragment@0 {
                       target = &lt;&amp;i2c_csi_dsi&gt;;
                       __overlay__ {
                           #address-cells = <b>(1)</b>;
                           #size-cells = <b>(2)</b>;

                           ina219@43 {
                               status = "okay";
                               compatible = "ti,ina219";
                               reg = &lt;0x43&gt;;
                               shunt-resistor = <b>(3)</b>;  // R100
                           };
                       };
                   };
               };

        3. convert i2c-ina219.dts to dtbo and place it into /boot/overlays:

               $ dtc -@ -I dts -O dtb -o /boot/overlays/i2c-ina219.dtbo i2c-ina219.dts

        4. configure hwmon_ina219 UPS driver for NUT (ups.conf):

               [ina219]
               driver = hwmon_ina219
               port = auto

</pre><h4><b>KNOWN</b> <b>ISSUES</b> <b>AND</b> <b>BUGS</b></h4><pre>
       The driver shutdown function is not implemented.

</pre><h4><b>AUTHORS</b></h4><pre>
       Andrew Anderson &lt;<a href="mailto:aander07@gmail.com">aander07@gmail.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
   <b>The</b> <b>core</b> <b>driver:</b>
       <b><a href="../man8/nutupsdrv.8.html">nutupsdrv</a></b>(8)

   <b>Internet</b> <b>resources:</b>
       •   Initial pull requests adding this driver:

           •   https://github.com/networkupstools/nut/pull/2430

           •   https://github.com/networkupstools/nut/issues/2378

       •   Baseboard with INA219: https://www.waveshare.com/wiki/CM4-POE-UPS-BASE

       •   TI INA219: https://www.ti.com/lit/ds/symlink/ina219.pdf

       •   The NUT (Network UPS Tools) home page: https://www.networkupstools.org/historic/v2.8.3/

Network UPS Tools 2.8.3                            07/08/2025                                    <u><a href="../man8/HWMON_INA219.8.html">HWMON_INA219</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>