<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>generic_modbus - Driver for contact (direct) signal UPS devices connected via modbus remote I/O gateways</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/nut-modbus">nut-modbus_2.8.1-4ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       generic_modbus - Driver for contact (direct) signal UPS devices connected via modbus remote I/O gateways

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>generic_modbus</b> -h

       <b>generic_modbus</b> -a <u>DEVICE_NAME</u> [<u>OPTIONS</u>]

           <b>Note</b>

           This man page only documents the specific features of the <b>generic_modbus</b> driver. For information
           about the core driver, see <b><a href="../man8/nutupsdrv.8.html">nutupsdrv</a></b>(8).

</pre><h4><b>SUPPORTED</b> <b>HARDWARE</b></h4><pre>
       This is a generic modbus driver expected to work with contact (direct) signal UPS devices, connected via
       modbus RIO (remote I/O) either serial or TCP/IP.

       The driver has been tested against PULS UPS (model UB40.241) via MOXA ioLogikR1212 (RS485) and
       ioLogikE1212 (TCP/IP).

       More information about this UPS can be found here:
           https://products.pulspower.com/ca/ubc10-241-n1.html

       More information about Moxa ioLogik R1212, E1212 can be found here:
           https://www.moxa.com/en/products/industrial-edge-connectivity/controllers-and-ios

       The PULS UPS UB40.241 supports the following signals:

           Ready contact      (DO) &lt;--&gt; HB
           Buffering contact  (DO) &lt;--&gt; OL | OB
           Battery-low        (DO) &lt;--&gt; LB
           Replace Battery    (DO) &lt;--&gt; RB
           Inhibit            (DI) &lt;--&gt; FSD

       Digital port direction (DI/DO) assumes the device perspective

       The driver’s concept is to map the UPS states (as defined in NUT) onto UPS contacts' states. The driver
       has an extended configuration interface implemented using variables defined in ups.conf.

</pre><h4><b>HARDWARE</b> <b>INTERCONNECTION</b></h4><pre>
       The commission of modbus remote I/O server as well as UPS device is carried out following the
       corresponding instruction manuals. The following figure depicts the anticipated communication path and
       hardware interconnection:

           +------+       +----------------+       +------------+       +------------+
           | UPSD | &lt;---&gt; | GENERIC_MODBUS | &lt;---&gt; | MODBUS RIO | &lt;---&gt; | UPS DEVICE |
           +------+  (1)  +----------------+  (2)  +------------+  (3)  +------------+
              |                   |
              +-------------------+
                 HOST CONTROLLER

           (1) Unix IPC
           (2) RS232 | TCP/IP
           (3) contacts

</pre><h4><b>EXTRA</b> <b>ARGUMENTS</b></h4><pre>
       This driver supports the following optional settings in the <b><a href="../man5/ups.conf.5.html">ups.conf</a></b>(5) file:

   <b>Generic:</b>
       <b>device_mfr</b>=<u>value</u>
           A string specifying the manufacturer of the UPS device (default UNKNOWN).

       <b>device_model</b>=<u>value</u>
           A string specifying the model of the UPS device (default UNKNOWN).

   <b>Serial:</b>
       <b>ser_baud_rate</b>=<u>value</u>
           A integer specifying the serial port baud rate (default 9600).

       <b>ser_data_bit</b>=<u>value</u>
           A integer specifying the serial port data bit (default 8).

       <b>ser_parity</b>=<u>value</u>
           A character specifying the serial port parity (default N).

       <b>ser_stop_bit</b>=<u>value</u>
           An integer specifying the serial port stop bit (default 1).

   <b>Modbus:</b>
       <b>rio_slave_id</b>=<u>value</u>
           An integer specifying the RIO modbus slave ID (default 1).

   <b>States</b> <b>(X</b> <b>=</b> <b>OL,</b> <b>OB,</b> <b>LB,</b> <b>HB,</b> <b>RB,</b> <b>CHRG,</b> <b>DISCHRG,</b> <b>FSD)</b>
       <b>&lt;X&gt;_addr</b>=<u>value</u>
           A number specifying the modbus address for the X state.

       <b>&lt;X&gt;_regtype</b>=<u>value</u>
           A number specifying the modbus register type for the X state

       Default values:

               1 for X = OL, OB, LB ,HB, RB, CHRG, DISCHRG
               0 for X = FSD

       Valid values:

               0:COIL, 1:INPUT_B, 2:INPUT_R, 3:HOLDING

       <b>&lt;X&gt;_noro</b>=<u>value</u>
           A number specifying the contact configuration for the X state (default 1).

       Valid values:

               0:NC, 1:NO

               <b>Note</b>
               NO stands for normally open and NC for normally closed contact

   <b>Shutdown</b>
       <b>FSD_pulse_duration</b>=<u>value</u>
           A number specifying the duration in ms for the inhibit pulse. If it’s not defined, signal has only
           one transition depending on FSD_noro configuration.

           Examples for FSD signal configuration:

           FSD_noro = 1
           FSD_pulse_duration = 150

                                +-----+
                                |     |
           inhibit pulse  &gt;-----+     +------------------&gt;
                                 &lt;---&gt;
                                 150ms

           FSD_noro = 0

           inhibit pulse  &gt;-----+
                                |
                                +------------------------&gt;

</pre><h4><b>CONFIGURATION</b></h4><pre>
       Here is an example of generic_modbus driver configuration in <b>ups.conf</b> file:

           [generic_modbus]
             driver = generic_modbus
             port = /dev/ttyUSB0
             desc = "generic ups driver"
             # device info
             device_mfr = "PULS"
             device_model = "UB40.241"
             # serial settings
             ser_baud_rate = 9600
             ser_parity = N
             ser_data_bit = 8
             ser_stop_bit = 1
             # modbus slave id
             rio_slave_id = 5
             # UPS signal state attributes
             OB_addr = 0x0
             OB_regtype = 1
             OB_noro = 0
             LB_addr = 0x1
             LB_regtype = 1
             HB_addr = 0x2
             HB_regtype = 1
             RB_addr = 0x3
             RB_regtype = 1
             FSD_addr = 0x0
             FSD_regtype = 0
             FSD_pulse_duration = 150

</pre><h4><b>INSTANT</b> <b>COMMANDS</b></h4><pre>
       This driver support the following instant commands:

       load.off
           executes "instant poweroff"

</pre><h4><b>INSTALLATION</b></h4><pre>
       This driver is not built by default. You can build it by installing libmodbus and running configure
       --with-modbus=yes.

       You also need to give proper permissions on the local serial device file (/dev/ttyUSB0 for example) to
       allow the run-time NUT driver user account to access it.

</pre><h4><b>OTHER</b> <b>NOTES</b></h4><pre>
       The generic_modbus driver intends to support generic UPS devices with contact signals through modbus
       TCP/RTU gateways (also known as RIO — remote I/Os). The data and signal path looks like this:

           [UPSD] &lt;--- IPC ---&gt; [GENERIC_UPS] &lt;--- modbus TCP/RTU ---&gt; MODBUS-RIO &lt;--- contacts ---&gt; [UPS DEVICE]

       On the other hand, you can setup any kind of modbus server, and configure the generic_modbus driver to
       connect and read or write specific registers. Your application / modbus server could then drive NUT
       statuses (e.g. OL, OB, HB etc) by writing over those registers.

</pre><h4><b>AUTHOR</b></h4><pre>
       Dimitris Economou &lt;<a href="mailto:dimitris.s.economou@gmail.com">dimitris.s.economou@gmail.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
   <b>The</b> <b>core</b> <b>driver:</b>
       <b><a href="../man8/nutupsdrv.8.html">nutupsdrv</a></b>(8), <b><a href="../man5/ups.conf.5.html">ups.conf</a></b>(5)

   <b>Internet</b> <b>resources:</b>
       •   The NUT (Network UPS Tools) home page: https://www.networkupstools.org/

       •   libmodbus home page: <a href="http://libmodbus.org">http://libmodbus.org</a>

Network UPS Tools 2.8.1                            01/16/2025                                  <u><a href="../man8/GENERIC_MODBUS.8.html">GENERIC_MODBUS</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>