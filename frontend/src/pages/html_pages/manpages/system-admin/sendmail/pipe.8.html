<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pipe - Postfix delivery to external command</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/postfix">postfix_3.10.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pipe - Postfix delivery to external command

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pipe</b> [generic Postfix daemon options] command_attributes...

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b><a href="../man8/pipe.8.html">pipe</a></b>(8)  daemon  processes  requests  from the Postfix queue manager to deliver messages to external
       commands.  This program expects to be run from the <b><a href="../man8/master.8.html">master</a></b>(8) process manager.

       Message attributes such as sender address, recipient address and next-hop host name can be  specified  as
       command-line macros that are expanded before the external command is executed.

       The  <b><a href="../man8/pipe.8.html">pipe</a></b>(8) daemon updates queue files and marks recipients as finished, or it informs the queue manager
       that delivery should be tried again at a later time. Delivery status reports are sent to  the  <b><a href="../man8/bounce.8.html">bounce</a></b>(8),
       <b><a href="../man8/defer.8.html">defer</a></b>(8) or <b><a href="../man8/trace.8.html">trace</a></b>(8) daemon as appropriate.

</pre><h4><b>SINGLE-RECIPIENT</b> <b>DELIVERY</b></h4><pre>
       Some  destinations cannot handle more than one recipient per delivery request. Examples are pagers or fax
       machines.  In addition, multi-recipient delivery  is  undesirable  when  prepending  a  <b>Delivered-to:</b>  or
       <b>X-Original-To:</b> message header.

       To prevent Postfix from sending multiple recipients per delivery request, specify

           <u>transport</u><b>_destination_recipient_limit</b> <b>=</b> <b>1</b>

       in  the  Postfix  <b>main.cf</b>  file, where <u>transport</u> is the name in the first column of the Postfix <b>master.cf</b>
       entry for the pipe-based delivery transport.

</pre><h4><b>COMMAND</b> <b>ATTRIBUTE</b> <b>SYNTAX</b></h4><pre>
       The external command attributes are given in the <b>master.cf</b> file at the end of a service definition.   The
       syntax is as follows:

       <b>chroot=</b><u>pathname</u> (optional)
              Change  the  process  root  directory  and  working directory to the named directory. This happens
              before switching to the privileges specified with the <b>user</b> attribute,  and  before  executing  the
              optional <b>directory=</b><u>pathname</u> directive. Delivery is deferred in case of failure.

              This feature is available as of Postfix 2.3.

       <b>directory=</b><u>pathname</u> (optional)
              Change  to  the  named  directory  before  executing  the external command.  The directory must be
              accessible for the user specified with the  <b>user</b>  attribute  (see  below).   The  default  working
              directory is <b>$queue_directory</b>.  Delivery is deferred in case of failure.

              This feature is available as of Postfix 2.2.

       <b>eol=</b><u>string</u> (optional, default: <b>\n</b>)
              The  output  record  delimiter.  Typically  one  would  use  either  <b>\r\n</b> or <b>\n</b>. The usual C-style
              backslash escape sequences are recognized: <b>\a</b> <b>\b</b> <b>\f</b> <b>\n</b> <b>\r</b> <b>\t</b> <b>\v</b> <b>\</b><u>ddd</u> (up to  three  octal  digits)
              and <b>\\</b>.

       <b>flags=BDFORXhqu.&gt;</b> (optional)
              Optional message processing flags. By default, a message is copied unchanged.

              <b>B</b>      Append  a  blank line at the end of each message. This is required by some mail user agents
                     that recognize "<b>From</b> " lines only when preceded by a blank line.

              <b>D</b>      Prepend a "<b>Delivered-To:</b> <u>recipient</u>" message header with  the  envelope  recipient  address.
                     Note:   for  this  to  work,  the  <u>transport</u><b>_destination_recipient_limit</b>  must  be  1  (see
                     SINGLE-RECIPIENT DELIVERY above for details).

                     The <b>D</b> flag also enforces loop detection (Postfix 2.5  and  later):  if  a  message  already
                     contains  a  <b>Delivered-To:</b>  header  with  the  same  recipient address, then the message is
                     returned as undeliverable. The address comparison is case insensitive.

                     This feature is available as of Postfix 2.0.

              <b>F</b>      Prepend a "<b>From</b> <u>sender</u> <u>time_stamp</u>"  envelope  header  to  the  message  content.   This  is
                     expected by, for example, <b>UUCP</b> software.

              <b>O</b>      Prepend an "<b>X-Original-To:</b> <u>recipient</u>" message header with the recipient address as given to
                     Postfix.  Note:  for this to work, the <u>transport</u><b>_destination_recipient_limit</b> must be 1 (see
                     SINGLE-RECIPIENT DELIVERY above for details).

                     This feature is available as of Postfix 2.0.

              <b>R</b>      Prepend a <b>Return-Path:</b> message header with the envelope sender address.

              <b>X</b>      Indicate that the external command performs final delivery.  This flag affects  the  status
                     reported  in  "success"  DSN  (delivery  status notification) messages, and changes it from
                     "relayed" into "delivered".

                     This feature is available as of Postfix 2.5.

              <b>h</b>      Fold the command-line <b>$original_recipient</b> and <b>$recipient</b> address domain part (text  to  the
                     right  of  the  right-most <b>@</b> character) to lower case; fold the entire command-line <b>$domain</b>
                     and <b>$nexthop</b> host or domain information to lower case.  This is  recommended  for  delivery
                     via <b>UUCP</b>.

              <b>q</b>      Quote   white   space   and   other   special   characters  in  the  command-line  <b>$sender</b>,
                     <b>$original_recipient</b> and <b>$recipient</b> address localparts (text to the left of the right-most <b>@</b>
                     character), according to an 8-bit transparent version of RFC 822.  This is recommended  for
                     delivery via <b>UUCP</b> or <b>BSMTP</b>.

                     The result is compatible with the address parsing of command-line recipients by the Postfix
                     <b><a href="../man1/sendmail.1.html">sendmail</a></b>(1) mail submission command.

                     The  <b>q</b>  flag  affects  only  entire addresses, not the partial address information from the
                     <b>$user</b>, <b>$extension</b> or <b>$mailbox</b> command-line macros.

              <b>u</b>      Fold the command-line <b>$original_recipient</b> and <b>$recipient</b> address  localpart  (text  to  the
                     left  of  the  right-most <b>@</b> character) to lower case.  This is recommended for delivery via
                     <b>UUCP</b>.

              <b>.</b>      Prepend "<b>.</b>" to lines starting with "<b>.</b>". This is needed by, for example, <b>BSMTP</b> software.

              <b>&gt;</b>      Prepend "<b>&gt;</b>" to lines starting with  "<b>From</b>  ".  This  is  expected  by,  for  example,  <b>UUCP</b>
                     software.

       <b>null_sender</b>=<u>replacement</u> (default: MAILER-DAEMON)
              Replace  the  null  sender  address  (typically  used  for delivery status notifications) with the
              specified text when expanding the <b>$sender</b> command-line macro,  and  when  generating  a  From_  or
              Return-Path: message header.

              If  the  null  sender replacement text is a non-empty string then it is affected by the <b>q</b> flag for
              address quoting in command-line arguments.

              The null sender replacement text may be empty; this form is recommended for content  filters  that
              feed  mail  back  into Postfix. The empty sender address is not affected by the <b>q</b> flag for address
              quoting in command-line arguments.

              Caution: a null sender address is easily mis-parsed by  naive  software.  For  example,  when  the
              <b><a href="../man8/pipe.8.html">pipe</a></b>(8) daemon executes a command such as:

                  <u>Wrong</u>: command -f$sender -- $recipient

              the  command  will  mis-parse  the  -f option value when the sender address is a null string.  For
              correct parsing, specify <b>$sender</b> as an argument by itself:

                  <u>Right</u>: command -f $sender -- $recipient

              NOTE: DO NOT put quotes around the command, $sender, or $recipient.

              This feature is available as of Postfix 2.3.

       <b>size</b>=<u>size_limit</u> (optional)
              Don't deliver messages that exceed this size limit (in bytes); return them to the sender instead.

       <b>user</b>=<u>username</u> (required)

       <b>user</b>=<u>username</u>:<u>groupname</u>
              Execute the external command with the user ID  and  group  ID  of  the  specified  <u>username</u>.   The
              software  refuses  to  execute  commands  with root privileges, or with the privileges of the mail
              system owner. If <u>groupname</u> is specified, the corresponding group ID is used instead of  the  group
              ID of <u>username</u>.

       <b>argv</b>=<u>command</u>... (required)
              The  command to be executed. This must be specified as the last command attribute.  The command is
              executed directly, i.e. without interpretation  of  shell  meta  characters  by  a  shell  command
              interpreter.

              Specify  "{"  and  "}" around command arguments that contain whitespace, arguments that begin with
              "{", or arguments that must be an empty string (Postfix 3.0 and later). The outer "{" and "}" will
              be removed, together with any leading or trailing whitespace in the remaining text.

              In  the  command  argument  vector,  the  following  macros  are  recognized  and  replaced   with
              corresponding information from the Postfix queue manager delivery request.

              In  addition  to  the  form  ${<u>name</u>},  the  forms  $<u>name</u>  and the deprecated form $(<u>name</u>) are also
              recognized.  Specify <b>$$</b> where a single <b>$</b> is wanted.

              <b>${client_address}</b>
                     This macro expands to the remote client network address.

                     This feature is available as of Postfix 2.2.

              <b>${client_helo}</b>
                     This macro expands to the remote client HELO command parameter.

                     This feature is available as of Postfix 2.2.

              <b>${client_hostname}</b>
                     This macro expands to the remote client hostname.

                     This feature is available as of Postfix 2.2.

              <b>${client_port}</b>
                     This macro expands to the remote client TCP port number.

                     This feature is available as of Postfix 2.5.

              <b>${client_protocol}</b>
                     This macro expands to the remote client protocol.

                     This feature is available as of Postfix 2.2.

              <b>${domain}</b>
                     This macro expands to the domain portion of the recipient address.  For  example,  with  an
                     address <u>user+foo@domain</u> the domain is <u>domain</u>.

                     This information is modified by the <b>h</b> flag for case folding.

                     This feature is available as of Postfix 2.5.

              <b>${envid}</b>
                     This macro expands to the RFC 3461 envelope ID if available, otherwise the empty string.

                     This feature is available as of Postfix 3.9.

              <b>${extension}</b>
                     This  macro  expands  to  the  extension part of a recipient address.  For example, with an
                     address <u>user+foo@domain</u> the extension is <u>foo</u>.

                     A command-line argument that  contains  <b>${extension}</b>  expands  into  as  many  command-line
                     arguments as there are recipients.

                     This information is modified by the <b>u</b> flag for case folding.

              <b>${mailbox}</b>
                     This macro expands to the complete local part of a recipient address.  For example, with an
                     address <u>user+foo@domain</u> the mailbox is <u>user+foo</u>.

                     A  command-line argument that contains <b>${mailbox}</b> expands to as many command-line arguments
                     as there are recipients.

                     This information is modified by the <b>u</b> flag for case folding.

              <b>${nexthop}</b>
                     This macro expands to the next-hop hostname.

                     This information is modified by the <b>h</b> flag for case folding.

              <b>${original_recipient}</b>
                     This macro expands to the complete  recipient  address  before  any  address  rewriting  or
                     aliasing.

                     A command-line argument that contains <b>${original_recipient}</b> expands to as many command-line
                     arguments as there are recipients.

                     This information is modified by the <b>hqu</b> flags for quoting and case folding.

                     This feature is available as of Postfix 2.5.

              <b>${queue_id}</b>
                     This macro expands to the queue id.

                     This feature is available as of Postfix 2.11.

              <b>${recipient}</b>
                     This macro expands to the complete recipient address.

                     A  command-line  argument  that  contains  <b>${recipient}</b>  expands  to  as  many command-line
                     arguments as there are recipients.

                     This information is modified by the <b>hqu</b> flags for quoting and case folding.

              <b>${sasl_method}</b>
                     This macro expands to the name of the SASL authentication mechanism  in  the  AUTH  command
                     when the Postfix SMTP server received the message.

                     This feature is available as of Postfix 2.2.

              <b>${sasl_sender}</b>
                     This macro expands to the SASL sender name (i.e. the original submitter as per RFC 4954) in
                     the MAIL FROM command when the Postfix SMTP server received the message.

                     This feature is available as of Postfix 2.2.

              <b>${sasl_username}</b>
                     This  macro  expands to the SASL user name in the AUTH command when the Postfix SMTP server
                     received the message.

                     This feature is available as of Postfix 2.2.

              <b>${sender}</b>
                     This macro expands to the envelope sender address. By  default,  the  null  sender  address
                     expands  to MAILER-DAEMON; this can be changed with the <b>null_sender</b> attribute, as described
                     above.

                     This information is modified by the <b>q</b> flag for quoting.

              <b>${size}</b>
                     This macro expands to Postfix's idea of the message size, which is an approximation of  the
                     size of the message as delivered.

              <b>${user}</b>
                     This  macro  expands  to  the  username  part of a recipient address.  For example, with an
                     address <u>user+foo@domain</u> the username part is <u>user</u>.

                     A command-line argument that contains <b>${user}</b> expands into as many  command-line  arguments
                     as there are recipients.

                     This information is modified by the <b>u</b> flag for case folding.

</pre><h4><b>STANDARDS</b></h4><pre>
       RFC 3463 (Enhanced status codes)

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Command  exit status codes are expected to follow the conventions defined in &lt;<b>sysexits.h</b>&gt;.  Exit status 0
       means normal successful completion.

       In the case of a non-zero exit status, a limited amount of command output is logged, and  reported  in  a
       delivery  status  notification.   When  the output begins with a 4.X.X or 5.X.X enhanced status code, the
       status code takes precedence over the non-zero exit status (Postfix version 2.3 and later).

       After successful delivery (zero exit status) a limited amount of command output is logged,  and  reported
       in  "success" delivery status notifications (Postfix 3.0 and later).  This command output is not examined
       for the presence of an enhanced status code.

       Problems and transactions are logged to <b><a href="../man8/syslogd.8.html">syslogd</a></b>(8) or <b><a href="../man8/postlogd.8.html">postlogd</a></b>(8).  Corrupted message files are marked so
       that the queue manager can move them to the <b>corrupt</b> queue for further inspection.

</pre><h4><b>SECURITY</b></h4><pre>
       This program needs a dual personality 1) to access the private Postfix queue and IPC mechanisms,  and  2)
       to execute external commands as the specified user. It is therefore security sensitive.

</pre><h4><b>CONFIGURATION</b> <b>PARAMETERS</b></h4><pre>
       Changes  to  <b>main.cf</b>  are  picked  up automatically as <b><a href="../man8/pipe.8.html">pipe</a></b>(8) processes run for only a limited amount of
       time. Use the command "<b>postfix</b> <b>reload</b>" to speed up a change.

       The text below provides only a parameter summary. See <b><a href="../man5/postconf.5.html">postconf</a></b>(5) for more details including examples.

</pre><h4><b>RESOURCE</b> <b>AND</b> <b>RATE</b> <b>CONTROLS</b></h4><pre>
       In the text below, <u>transport</u> is the first field in a <b>master.cf</b> entry.

       <b>transport_time_limit</b> <b>($command_time_limit)</b>
              A transport-specific override for the command_time_limit parameter value, where <u>transport</u>  is  the
              master.cf name of the message delivery transport.

       Implemented in the <a href="../man8/qmgr.8.html">qmgr</a>(8) daemon:

       <b>transport_destination_concurrency_limit</b> <b>($default_destination_concurrency_limit)</b>
              A transport-specific override for the default_destination_concurrency_limit parameter value, where
              <u>transport</u> is the master.cf name of the message delivery transport.

       <b>transport_destination_recipient_limit</b> <b>($default_destination_recipient_limit)</b>
              A  transport-specific  override for the default_destination_recipient_limit parameter value, where
              <u>transport</u> is the master.cf name of the message delivery transport.

</pre><h4><b>MISCELLANEOUS</b> <b>CONTROLS</b></h4><pre>
       <b>config_directory</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              The default location of the Postfix main.cf and master.cf configuration files.

       <b>daemon_timeout</b> <b>(18000s)</b>
              How much time a Postfix daemon process may take to handle a request before it is terminated  by  a
              built-in watchdog timer.

       <b>delay_logging_resolution_limit</b> <b>(2)</b>
              The maximal number of digits after the decimal point when logging delay values.

       <b>export_environment</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              The list of environment variables that a Postfix process will export to non-Postfix processes.

       <b>ipc_timeout</b> <b>(3600s)</b>
              The time limit for sending or receiving information over an internal communication channel.

       <b>mail_owner</b> <b>(postfix)</b>
              The UNIX system account that owns the Postfix queue and most Postfix daemon processes.

       <b>max_idle</b> <b>(100s)</b>
              The  maximum  amount  of time that an idle Postfix daemon process waits for an incoming connection
              before terminating voluntarily.

       <b>max_use</b> <b>(100)</b>
              The maximal number of incoming connections that a  Postfix  daemon  process  will  service  before
              terminating voluntarily.

       <b>process_id</b> <b>(read-only)</b>
              The process ID of a Postfix command or daemon process.

       <b>process_name</b> <b>(read-only)</b>
              The process name of a Postfix command or daemon process.

       <b>queue_directory</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              The location of the Postfix top-level queue directory.

       <b>recipient_delimiter</b> <b>(empty)</b>
              The  set of characters that can separate an email address localpart, user name, or a .forward file
              name from its extension.

       <b>syslog_facility</b> <b>(mail)</b>
              The syslog facility of Postfix logging.

       <b>syslog_name</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              A prefix that is prepended to the process name in syslog records, so that,  for  example,  "smtpd"
              becomes "prefix/smtpd".

       Available in Postfix version 3.0 and later:

       <b>pipe_delivery_status_filter</b> <b>($default_delivery_status_filter)</b>
              Optional  filter  for the <b><a href="../man8/pipe.8.html">pipe</a></b>(8) delivery agent to change the delivery status code or explanatory
              text of successful or unsuccessful deliveries.

       Available in Postfix version 3.3 and later:

       <b>enable_original_recipient</b> <b>(yes)</b>
              Enable support for the original recipient address after an address is  rewritten  to  a  different
              address (for example with aliasing or with canonical mapping).

       <b>service_name</b> <b>(read-only)</b>
              The master.cf service name of a Postfix daemon process.

       Available in Postfix 3.5 and later:

       <b>info_log_address_format</b> <b>(external)</b>
              The email address form that will be used in non-debug logging (info, warning, etc.).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/qmgr.8.html">qmgr</a>(8), queue manager
       <a href="../man8/bounce.8.html">bounce</a>(8), delivery status reports
       <a href="../man5/postconf.5.html">postconf</a>(5), configuration parameters
       <a href="../man5/master.5.html">master</a>(5), generic daemon options
       <a href="../man8/master.8.html">master</a>(8), process manager
       <a href="../man8/postlogd.8.html">postlogd</a>(8), Postfix logging
       <a href="../man8/syslogd.8.html">syslogd</a>(8), system logging

</pre><h4><b>LICENSE</b></h4><pre>
       The Secure Mailer license must be distributed with this software.

</pre><h4><b>AUTHOR(S)</b></h4><pre>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA

       Wietse Venema
       Google, Inc.
       111 8th Avenue
       New York, NY 10011, USA

                                                                                                         <u><a href="../man8/PIPE.8.html">PIPE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>