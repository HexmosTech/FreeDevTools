<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>audispd-zos-remote - z/OS Remote-services Audit dispatcher plugin</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/audispd-plugins">audispd-plugins_4.0.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       audispd-zos-remote - z/OS Remote-services Audit dispatcher plugin

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>audispd-zos-remote</b> <b>[</b> <u>config-file</u> <b>]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>audispd-zos-remote</b>  is  a  remote-auditing  plugin  for  the Audit subsystem. It should be started by the
       <b><a href="../man8/auditd.8.html">auditd</a></b>(8) daemon and will forward all incoming audit events, as they happen, to  a  configured  z/OS  SMF
       (Service  Management  Facility)  database,  through  an IBM Tivoli Directory Server (ITDS) set for Remote
       Audit service.  See <b>SMF</b> <b>MAPPING</b> section below for more information about the resulting SMF record format.

       <b><a href="../man8/auditd.8.html">auditd</a></b>(8) must be configured to start the plugin. This is done by a configuration file usually located at
       <u>/etc/audit/plugins.d/audispd-zos-remote.conf</u>, but multiple instances can be spawned  by  having  multiple
       configuration files in <u>/etc/audit/plugins.d</u> for the same plugin executable (see <b><a href="../man8/auditd.8.html">auditd</a></b>(8)).

       Each  instance  needs  a  configuration  file,  located  by default at <u>/etc/audit/zos-remote.conf</u>.  Check
       <b><a href="../man5/zos-remote.conf.5.html">zos-remote.conf</a></b>(5) for details about the plugin configuration.

</pre><h4><b>OPTIONS</b></h4><pre>
       config-file
              Use an alternate configuration file instead of <u>/etc/audit/zos-remote.conf</u>.

</pre><h4><b>SIGNALS</b></h4><pre>
       <b>audispd-zos-remote</b> reacts to SIGTERM and SIGHUP signals (according to the <b><a href="../man8/auditd.8.html">auditd</a></b>(8) specification):

       <b>SIGHUP</b> Instructs the <b>audispd-zos-remote</b> plugin to re-read it's configuration and flush  existing  network
              connections.

       <b>SIGTERM</b>
              Performs  a  clean exit.  <b>audispd-zos-remote</b> will wait up to 10 seconds if there are queued events
              to be delivered, dropping any remaining queued events after that time.

</pre><h4><b>IBM</b> <b>z/OS</b> <b>ITDS</b> <b>Server</b> <b>and</b> <b>RACF</b> <b>configuration</b></h4><pre>
       In order to use this plugin, you must have an IBM z/OS v1R8 (or higher) server with IBM Tivoli  Directory
       Server  (ITDS)  configured for Remote Audit service. For more detailed information about how to configure
       the z/OS server for Remote Auditing, refer to <b>z/OS</b> <b>V1R8.0-9.0</b>  <b>Integrated</b>  <b>Security</b>  <b>Services</b>  <b>Enterprise</b>
       <b>Identity</b> <b>Mapping</b> <b>(EIM)</b> <b>Guide</b> <b>and</b> <b>Reference</b>
       (<u><a href="http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/FRAMESET/EIMA1140/CCONTENTS">http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/FRAMESET/EIMA1140/CCONTENTS</a>?DT=20070827115119</u>),
       chapter "2.0 - Working with remote services".

   <b>Enable</b> <b>ITDS</b> <b>to</b> <b>process</b> <b>Remote</b> <b>Audit</b> <b>requests</b>
       To  enable  ITSD  to process Remote Audit requests, the user ID associated with ITDS must be granted READ
       access to the IRR.AUDITX FACILITY Class profile (the profile used to protect the R_Auditx service).  This
       user ID can usually be found in the STARTED Class profile for the ITDS started procedure. If the identity
       associated  with  ITDS  is  <u>ITDSUSER</u>,  the  administrator  can  configure  RACF  to grant Remote Auditing
       processing to ITDS with the following TSO commands:

       <u>TSO</u> <u>Commands:</u> <u>Grant</u> <u>ITDSUSER</u> <u>READ</u> <u>access</u> <u>to</u> <u>IRR.AUDITX</u> <u>FACILITY</u> <u>Class</u> <u>profile</u>
              rdefine FACILITY IRR.RAUDITX uacc(none)
              permit IRR.RAUDITX class(FACILITY) id(ITDSUSER) access(READ)

   <b>Create/enable</b> <b>RACF</b> <b>user</b> <b>ID</b> <b>to</b> <b>perform</b> <b>Remote</b> <b>Audit</b> <b>requests</b>
       A z/OS RACF user ID is needed by the plugin - Every Audit request performed by the plugin will use a RACF
       user ID, as configured in the plugin configuration <b><a href="../man5/zos-remote.conf.5.html">zos-remote.conf</a></b>(5).  This user ID needs READ access to
       FACILITY Class resource IRR.LDAP.REMOTE.AUDIT.  If  the  user  ID  is  <u>BINDUSER</u>,  the  administrator  can
       configure RACF to enable this user to perform Remote Auditing requests with the following TSO commands:

       <u>TSO</u> <u>Commands:</u> <u>Enable</u> <u>BINDUSER</u> <u>to</u> <u>perform</u> <u>Remote</u> <u>Audit</u> <u>requests</u>
              rdefine FACILITY IRR.LDAP.REMOTE.AUDIT uacc(none)
              permit IRR.LDAP.REMOTE.AUDIT class(FACILITY) id(BINDUSER) access(READ)

   <b>Add</b> <b>@LINUX</b> <b>Class</b> <b>to</b> <b>RACF</b>
       When  performing  remote auditing requests, the <b>audispd-zos-remote</b> plugin will use the special <b>@LINUX</b> <u>CDT</u>
       <u>Class</u> and the audit record type (eg.: <b>SYSCALL</b>, <b>AVC</b>, <b>PATH</b>...)  as the <u>CDT</u> <u>Resource</u> <u>Class</u>  for  all  events
       processed.   To  make sure events are logged, the RACF server must be configured with a Dynamic CDT Class
       named <b>@LINUX</b> with correct sizes and attributes. The following TSO commands can be used to add this class:

       <u>TSO</u> <u>Commands:</u> <u>Add</u> <u>@LINUX</u> <u>CDT</u> <u>Class</u>
              rdefine cdt @LINUX cdtinfo(<a href="../man493/posit.493.html">posit</a>(493) FIRST(alpha,national,numeric,special) OTHER(alpha,national,numeric,special) RACLIST(REQUIRED) case(asis) generic(allowed) defaultuacc(none) <a href="../man246/maxlength.246.html">maxlength</a>(246))
              setr classact(cdt)
              setr raclist(cdt)
              setr raclist(cdt) refresh
              setr classact(@LINUX)
              setr raclist(@LINUX)
              setr generic(@LINUX)

   <b>Add</b> <b>profiles</b> <b>to</b> <b>the</b> <b>@LINUX</b> <b>Class</b>
       Once the CDT Class has been defined, you can add profiles to it, specifying resources (wildcards allowed)
       to log or ignore. The following are examples:

       <u>TSO</u> <u>Commands:</u> <u>Log</u> <u>only</u> <u>AVC</u> <u>records</u> <u>(One</u> <u>generic</u> <u>and</u> <u>one</u> <u>discrete</u> <u>profile):</u>
              rdefine @LINUX * uacc(none) audit(none(read))
              rdefine @LINUX AVC uacc(none) audit(all(read))
              setr raclist(@LINUX) refresh

       <u>TSO</u> <u>Commands:</u> <u>Log</u> <u>everything</u> <u>(One</u> <u>generic</u> <u>profile):</u>
              rdefine @LINUX * uacc(none) audit(all(read))
              setr raclist(@LINUX) refresh

       Resources always match the single profile with the <u>best</u> match.

       There are many other ways to define logging in RACF. Please refer to the server  documentation  for  more
       details.

</pre><h4><b>SMF</b> <b>Mapping</b></h4><pre>
       The  ITDS  Remote  Audit  service  will  cut  SMF  records of type 83 subtype 4 every time it processes a
       request. This plugin will issue a remote audit request for every incoming  Linux  Audit  record  (meaning
       that one Linux record will map to one SMF record), and fill this type's records with the following:

   <b>Link</b> <b>Value</b>
       The  Linux  event serial number, encoded in network-byte order hexadecimal representation. Records within
       the same Event share the same Link Value.

   <b>Violation</b>
       Always zero (0) - <u>False</u>

   <b>Event</b> <b>Code</b>
       Always two (2) - <u>Authorization</u> event

   <b>Event</b> <b>Qualifier</b>
       Zero (0) - <u>Success</u>, if the event reported <b>success=yes</b> or <b>res=success</b>, Three (3)  -  <u>Fail</u>,  if  the  event
       reported <b>success=no</b> or <b>res=failed</b>, or One (1) - <u>Info</u> otherwise.

   <b>Class</b>
       Always <u>@LINUX</u>

   <b>Resource</b>
       The Linux record type for the processed record. e.g.: <u>SYSCALL</u>,<u>AVC</u>,<u>PATH</u>,<u>CWD</u> etc.

   <b>Log</b> <b>String</b>
       Textual  message  bringing  the RACF user ID used to perform the request, plus the Linux hostname and the
       record type for the first record in the processed event. e.g.: <u>Remote</u> <u>audit</u> <u>request</u> <u>from</u> <u>RACFUSER.</u>  <u>Linux</u>
       <u>(hostname.localdomain):USER_AUTH</u>

   <b>Data</b> <b>Field</b> <b>List</b>
       Also known as <u>relocates</u>, this list will bring all the field names and values in a <b>fieldname=value</b> format,
       as a type 114 (<b>Application</b> <b>specific</b> <b>Data</b>) relocate. The plug-in will try to interpret those fields (i.e.:
       use  human-readable  username <b>root</b> instead of numeric userid <b>0</b>) whenever possible. Currently, this plugin
       will also add a relocate type 113 (<b>Date</b> <b>And</b> <b>Time</b> <b>Security</b> <b>Event</b> <b>Occurred</b>) with the Event Timestamp in the
       format as returned by <b><a href="../man3/ctime.3.html">ctime</a></b>(3).

</pre><h4><b>ERRORS</b></h4><pre>
       Errors and warnings are reported to syslog (under DAEMON facility). In situations  where  the  event  was
       submitted but the z/OS server returned an error condition, the logged message brings a name followed by a
       human-readable description. Below are some common errors conditions:

       <b>NOTREQ</b> <b>-</b> <b>No</b> <b>logging</b> <b>required</b>
              Resource (audit record type) is not set to be logged in the RACF server - The @LINUX Class profile
              governing this audit record type is set to ignore. See <b>IBM</b> <b>z/OS</b> <b>RACF</b> <b>Server</b> <b>configuration</b>

       <b>UNDETERMINED</b> <b>-</b> <b>Undetermined</b> <b>result</b>
              No  profile  found  for specified resource. There is no @LINUX Class configured or no @LINUX Class
              profile associated with this audit record type. See <b>IBM</b> <b>z/OS</b> <b>RACF</b> <b>Server</b> <b>configuration</b>

       <b>UNAUTHORIZED</b> <b>-</b> <b>The</b> <b>user</b> <b>does</b> <b>not</b> <b>have</b> <b>authority</b> <b>the</b> <b>R_auditx</b> <b>service</b>
              The user ID associated with the ITDS doesn't have READ access to  the  IRR.AUDITX  FACILITY  Class
              profile. See <b>IBM</b> <b>z/OS</b> <b>RACF</b> <b>Server</b> <b>configuration</b>

       <b>UNSUF_AUTH</b> <b>-</b> <b>The</b> <b>user</b> <b>has</b> <b>insufficient</b> <b>authority</b> <b>for</b> <b>the</b> <b>requested</b> <b>function</b>
              The RACF user ID used to perform Remote Audit requests (as configured in <b><a href="../man5/zos-remote.conf.5.html">zos-remote.conf</a></b>(5)) don't
              have  access  to  the  IRR.LDAP.REMOTE.AUDIT  FACILITY  Class  profile.  See  <b>IBM</b> <b>z/OS</b> <b>RACF</b> <b>Server</b>
              <b>configuration</b>

</pre><h4><b>BUGS</b></h4><pre>
       The plugin currently does remote auditing in a best-effort basis, and will discard  events  in  case  the
       z/OS server cannot be contacted (network failures) or in any other case that event submission fails.

</pre><h4><b>FILES</b></h4><pre>
       /etc/audit/plugins.d/audispd-zos-remote.conf /etc/audit/zos-remote.conf

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/auditd.8.html">auditd</a></b>(8), <b><a href="../man5/zos-remote.conf.5.html">zos-remote.conf</a></b>(5).

</pre><h4><b>AUTHOR</b></h4><pre>
       Klaus Heinrich Kiwi &lt;<a href="mailto:klausk@br.ibm.com">klausk@br.ibm.com</a>&gt;

IBM                                                 Oct 2007                               <u><a href="../man8/AUDISPD-ZOS-REMOTE.8.html">AUDISPD-ZOS-REMOTE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>