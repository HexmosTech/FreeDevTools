<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oscap-ssh - Tool for running oscap over SSH and collecting results.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openscap-utils">openscap-utils_1.4.2+dfsg-1ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       oscap-ssh - Tool for running oscap over SSH and collecting results.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       oscap-ssh  runs  oscap tool on a remote system through SSH connection. The input files are transferred to
       the target system and after the scan finishes result  files  are  transferred  back.  No  temporary  data
       remains on the remote machine.

       The  tool requires bash, ssh, scp and mktemp to perform OVAL and XCCDF evaluation of remote machines. The
       remote machine also has to have oscap installed and in $PATH. This  can  be  accomplished  by  installing
       openscap-scanner.

       Usage of the tool mimics usage and options of <a href="../man8/oscap.8.html">oscap</a>(8) tool.

</pre><h4><b>USAGE</b></h4><pre>
   <b>Evaluation</b> <b>of</b> <b>XCCDF</b> <b>content</b>
       $ oscap-ssh user@host 22 xccdf eval [options] INPUT_CONTENT

       Only source data streams are supported as INPUT_CONTENT!

       Supported options are:
         --profile
         --tailoring-file
         --tailoring-id
         --cpe
         --results
         --results-arf
         --report
         --skip-validation
         --fetch-remote-resources
         --local-files
         --progress
         --datastream-id
         --xccdf-id
         --benchmark-id
         --remediate

   <b>Evaluation</b> <b>of</b> <b>OVAL</b> <b>content</b>
       $ oscap-ssh user@host 22 oval eval [options] INPUT_CONTENT

       Supported options are:
         --id
         --variables
         --directives
         --results
         --report
         --skip-validation
         --datastream-id
         --oval-id

   <b>Collection</b> <b>of</b> <b>OVAL</b> <b>System</b> <b>Characteristic</b>
       $ oscap-ssh user@host 22 oval collect [options] INPUT_CONTENT

       Supported options are:
         --id
         --syschar
         --variables
         --skip-validation

       Specific option for oscap-ssh (must be first argument):
         --sudo

   <b>Environment</b> <b>variables</b>
       oscap-ssh  checks  out  the SSH_ADDITIONAL_OPTIONS environment variable, and pastes its contents into the
       command-line of ssh to the location where options are expected.  Supply the variable in form of a  string
       that corresponds to a section of the ssh command-line and that consists of options you want to pass.

   <b>Using</b> <b>--local-files</b> <b>option</b>
       The  oscap-ssh command supports the --local-files option, but it isn't possible to pass './' and '../' as
       an argument. Use a full directory path instead.

</pre><h4><b>EXAMPLE</b> <b>USAGE</b></h4><pre>
   <b>Simple</b> <b>XCCDF</b> <b>evaluation</b>
       The following command evaluates a  remote  Fedora  machine  as  root.  HTML  report  is  written  out  as
       report.html  on the local machine. Can be executed from any machine that has ssh, scp and bash. The local
       machine does not need to have openscap installed.  It also uses the  SSH_ADDITIONAL_OPTIONS  variable  to
       configure ssh in such way that contents of the known_hosts file are ignored.

       $ export SSH_ADDITIONAL_OPTIONS="-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null" $ oscap-ssh
       <a href="mailto:root@192.168.1.13">root@192.168.1.13</a>   22   xccdf   eval   --profile   xccdf_org.ssgproject.content_profile_common  --report
       report.html /usr/share/xml/scap/ssg/content/ssg-fedora-ds.xml

   <b>XCCDF</b> <b>Evaluation</b> <b>with</b> <b>tailoring</b> <b>file</b>
       The following command uses a tailoring file and also copies back ARF and  XCCDF  results.  The  tailoring
       file is automatically copied from local machine to remote.

       $       oscap-ssh       --sudo       <a href="mailto:oscap-user@192.168.1.13">oscap-user@192.168.1.13</a>       22      xccdf      eval      --profile
       xccdf_org.ssgproject.content_profile_common  --report  report.html  --results  results.xml  --results-arf
       arf.xml --tailoring-file ssg-fedora-ds-tailoring.xml /usr/share/xml/scap/ssg/content/ssg-fedora-ds.xml

   <b>Running</b> <b>remotely</b> <b>as</b> <b>root</b>
       Note  that the openscap scanner is best run by the 'root' user as in the first example above. To do this,
       the "PermitRootLogin" directive must be enabled in  <a href="file:/etc/ssh/sshd_config">/etc/ssh/sshd_config</a>,  which  is  itself  a  security
       violation. A safer approach is to enable a non-privileged user ('oscap-user' in the second example above)
       to  run only the oscap binary as root (with the '--sudo' flag) by updating the remote machine's 'sudoers'
       file or adding a file like /etc/sudoers.d/99-oscap-user:
         # allow oscap-user to run openscap scanner
         Defaults!/usr/bin/oscap !requiretty
         oscap-user ALL=(root) NOPASSWD: /usr/bin/oscap

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Please report bugs using https://github.com/OpenSCAP/openscap/issues

</pre><h4><b>AUTHORS</b></h4><pre>
       Martin Preisler &lt;<a href="mailto:mpreisle@redhat.com">mpreisle@redhat.com</a>&gt;
       Šimon Lukašík &lt;<a href="mailto:slukasik@redhat.com">slukasik@redhat.com</a>&gt;

Red Hat, Inc.                                     January 2016                                      <u><a href="../man8/oscap-ssh.8.html">oscap-ssh</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>