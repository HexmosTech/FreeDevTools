<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shorewall - Administration tool for Shoreline Firewall (Shorewall)</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/shorewall-core">shorewall-core_5.2.8-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       shorewall - Administration tool for Shoreline Firewall (Shorewall)

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>shorewall[6][-lite]</b> [options] <b>add</b> <b>{</b> <u>interface</u>[:<u>host-list</u>]... <u>zone</u> <b>|</b> <u>zone</u> <u>host-list</u> <b>}</b>

       <b>shorewall[6][-lite]</b> [options] <b>allow</b> <u>address</u>

       <b>shorewall[6][-lite]</b> [options] <b>blacklist[!]</b> <u>address</u> [<u>option</u> ...]

       <b>shorewall[6][-lite]</b> [options] <b>call</b> <u>function</u> [<u>parameter</u> ...]

       <b>shorewall[6]</b> [<b>trace</b>|<b>debug</b>] [options] [<b>check</b> <b>|</b> <b>ck</b> ]  [<b>-e</b>] [<b>-d</b>] [<b>-p</b>] [<b>-r</b>] [<b>-T</b>] [<b>-i</b>] [<u>directory</u>]

       <b>shorewall[6][-lite]</b> [options] <b>clear</b> [<b>-f</b>]

       <b>shorewall[6][-lite]</b> [options] <b>close</b> { <u>open-number</u> | <u>sourcedest</u> [<u>protocol</u> [ <u>port</u> ]]}

       <b>shorewall[6]</b> [<b>trace</b>|<b>debug</b>] [options] [<b>compile</b> <b>|</b> <b>co</b> ]  [<b>-e</b>] [<b>-c</b>] [<b>-d</b>] [<b>-p</b>] [<b>-T</b>] [<b>-i</b>] [<u>directory</u>]
                    [<u>pathname</u>]

       <b>shorewall[6][-lite]</b> [options] <b>delete</b> <b>{</b> <u>interface</u>[:<u>host-list</u>]... <u>zone</u> <b>|</b> <u>zone</u> <u>host-list</u> <b>}</b>

       <b>shorewall[6][-lite]</b> [options] <b>disable</b> { <u>interface</u> | <u>provider</u> }

       <b>shorewall[6][-lite]</b> [options] <b>drop</b> <u>address</u>

       <b>shorewall[6][-lite]</b> [options] <b>dump</b> [<b>-x</b>] [<b>-l</b>] [<b>-m</b>] [<b>-c</b>]

       <b>shorewall[6][-lite]</b> [options] <b>enable</b> { <u>interface</u> | <u>provider</u> }

       <b>shorewall[6]</b> [options] <b>export</b> [<u>directory1</u>] [<u>user</u>@]<u>system</u>[<b>:</b><u>directory2</u>]

       <b>shorewall[6][-lite]</b> [options] <b>forget</b> [<u>filename</u>]

       <b>shorewall[6][-lite]</b> [options] <b>help</b>

       <b>shorewall[-lite]</b> [options] <b>hits</b> [<b>-t</b>]

       <b>shorewall[-lite]</b> [options] <b>ipcalc</b> {<u>address</u> <u>mask</u> | <u>address</u>/<u>vlsm</u>}

       <b>shorewall[-lite]</b> [options] <b>iprange</b> <u>address1</u><b>-</b><u>address2</u>

       <b>shorewall[6][-lite]</b> [options] <b>iptrace</b> <u>iptables</u> <u>match</u> <u>expression</u>

       <b>shorewall[6][-lite]</b> [options] <b>logdrop</b> <u>address</u>

       <b>shorewall[6][-lite]</b> [options] <b>logwatch</b> [<b>-m</b>] [<u>refresh-interval</u>]

       <b>shorewall[6][-lite]</b> [options] <b>logreject</b> <u>address</u>

       <b>shorewall[6][-lite]</b> [options] <b>noiptrace</b> <u>iptables</u> <u>match</u> <u>expression</u>

       <b>shorewall[6][-lite]</b> [options] <b>open</b> <u>source</u> <u>dest</u> [ <u>protocol</u> [ <u>port</u> ] ]

       <b>shorewall[6][-lite]</b> [options] <b>reenable</b> { <u>interface</u> | <u>provider</u> }

       <b>shorewall[6][-lite]</b> [options] <b>reject</b> <u>address</u>

       <b>shorewall[6][-lite]</b> [options] <b>reload</b> [<b>-n</b>] [<b>-p</b> [<b>-d</b>]] [<b>-f</b>] [<b>-c</b>] [<b>-T</b>] [<b>-i</b>] [<b>-C</b>] [<u>directory</u>]

       <b>shorewall[6]</b> <b>remote-getcaps</b> [<b>-s</b>] [<b>-R</b>] [<b>-r</b> <u>root-user-name</u>] [<b>-T</b>] [<b>-i</b>] [[<b>-D</b>]<u>directory</u>] [<u>system</u>]

       <b>shorewall[6]</b> [options] <b>remote-getrc</b> [<b>-s</b>] [<b>-c</b>] [<b>-r</b> <u>root-user-name</u>] [<b>-T</b>] [<b>-i</b>] [[<b>-D</b>]<u>directory</u>] [<u>system</u>]

       <b>shorewall[6]</b> [options] <b>remote-start</b> [<b>-s</b>] [<b>-c</b>] [<b>-r</b> <u>root-user-name</u>] [<b>-T</b>] [<b>-i</b>] [[<b>-D</b>]<u>directory</u>] [<u>system</u>]

       <b>shorewall[6]</b> [options] <b>remote-reload</b> [<b>-s</b>] [<b>-c</b>] [<b>-r</b> <u>root-user-name</u>] [<b>-T</b>] [<b>-i</b>] [[<b>-D</b>]<u>directory</u>] [<u>system</u>]

       <b>shorewall[6]</b> [options] <b>remote-restart</b> [<b>-s</b>] [<b>-c</b>] [<b>-r</b> <u>root-user-name</u>] [<b>-T</b>] [<b>-i</b>] [[<b>-D</b>]<u>directory</u>] [<u>system</u>]

       <b>shorewall[6][-lite]</b> [options] <b>reset</b> [<u>chain</u> ...]

       <b>shorewall[6][-lite]</b> [options] <b>restart</b> [<b>-n</b>] [<b>-p</b> [<b>-d</b>]] [<b>-f</b>] [<b>-c</b>] [<b>-T</b>] [<b>-i</b>] [<b>-C</b>] [<u>directory</u>]

       <b>shorewall[6][-lite]</b> [options] <b>restore</b> [<b>-n</b>] [<b>-p</b>] [<b>-C</b>]  [<u>filename</u>]

       <b>shorewall[6][-lite]</b> [options] <b>run</b> <u>command</u> [<u>parameter</u> <u>...</u>]

       <b>shorewall[6]</b> [options] <b>safe-restart</b> [<b>-d</b>] [<b>-p</b>] [<b>-t</b> <u>timeout</u>] [<u>directory</u>]

       <b>shorewall[6]</b> [options] <b>safe-start</b> [<b>-d</b>] [<b>-p</b>] [<b>-t</b> <u>timeout</u>] [<u>directory</u>]

       <b>shorewall[6][-lite]</b> [options] <b>save</b> [<b>-C</b>]  [<u>filename</u>]

       <b>shorewall[6][-lite]</b> [options] <b>savesets</b>

       <b>shorewall[6][-lite]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } [<b>-x</b>] <b>{bl|blacklists}</b>

       <b>shorewall[6][-lite]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } [<b>-b</b>] [<b>-x</b>] [<b>-l</b>] [<b>-t</b> {<b>filter</b>|<b>mangle</b>|<b>nat</b>|<b>raw</b>}] [<u>chain</u>...]

       <b>shorewall[6][-lite]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } [<b>-f</b>] <b>capabilities</b>

       <b>shorewall[6]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } [<b>-f</b>] <b>{actions|macros}</b>

       <b>shorewall[6]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } <b>action</b> <u>action</u>

       <b>shorewall[6][-lite]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> }
                           {<b>classifiers|connections|config|events|filters|ip|ipa|ipsec|zones|policies|marks</b>}

       <b>shorewall[6][-lite]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } <b>event</b> <u>event</u>

       <b>shorewall[6][-lite]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } [<b>-c</b>] <b>routing</b>

       <b>shorewall[6]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } <b>macro</b> <u>macro</u>

       <b>shorewall[6][-lite]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } [<b>-x</b>] {<b>mangle|nat|raw</b>}

       <b>shorewall[6][-lite]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } <b>saves</b>

       <b>shorewall[6][-lite]</b> [options] {<b>show</b> <b>|</b> <b>list</b> <b>|</b> <b>ls</b> } [<b>-m</b>] <b>log</b>

       <b>shorewall[6][-lite]</b> [<b>trace</b>|<b>debug</b>] [options] <b>start</b> [<b>-n</b>] [<b>-f</b>] [<b>-p</b>] [<b>-c</b>] [<b>-T</b> [<b>-i</b>]] [<b>-C</b>] [<u>directory</u>]

       <b>shorewall[6][-lite]</b> [options] <b>stop</b> [<b>-f</b>]

       <b>shorewall[6][-lite]</b> [options] <b>status</b> [<b>-i</b>]

       <b>shorewall[6]</b> [options] <b>try</b> <u>directory</u> [<u>timeout</u>]

       <b>shorewall[6]</b> [options] <b>update</b> [<b>-b</b>] [<b>-d</b>] [<b>-r</b>] [<b>-T</b>] [<b>-a</b>] [<b>-i</b>] [<b>-A</b>] [<u>directory</u>]

       <b>shorewall[6][-lite]</b> [options] <b>version</b> [<b>-a</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Beginning with Shorewall 5.1.0, the <b>shorewall</b> utility is used to control the Shoreline Firewall
       (Shorewall), Shorewall Firewall 6 (Shorewall6), Shorewall Firewall Lite (Shorewall-lite) and Shorewall
       Firewall 6 Lite (Shorewall6-lite). The utility may be accessed under four different names:

       <b>shorewall</b>
           Controls the Shorewall configuration when Shorewall is installed. If Shorewall is not installed, the
           <b>shorewall</b> command controls Shorewall-lite if it is installed. If neither Shorewall nor Shorewall-lite
           is installed, the <b>shorewall</b> command controls Shorewall6-lite if it is installed.

       <b>shorewall6</b>
           The <b>shorewall6</b> command controls Shorewall6 when Shorewall6 is installed.

       shorewall-lite
           The <b>shorewall-lite</b> command controls Shorewall-lite when Shorewall-lite is installed.

       shorewall6-lite
           The <b>shorewall6-lite</b> command controls Shorewall6-lite when Shorewall6-lite is installed.

       Prior to Shorewall 5.1.0, these four commands were implemented as four separate program, each of which
       controlled only a single firewall package. This manpage serves to document both the Shorewall 5.1 and
       Shorewall 5.0 CLI.

</pre><h4><b>OPTIONS</b></h4><pre>
       The <u>options</u> are:

       <b>-4</b>
           Added in Shorewall 5.1.0. Causes the command to operate on the Shorewall configuration or the
           Shorewall-lite configuration. It is the default when either of those products is installed and when
           the command is <b>shorewall</b> or <b>shorewall-lite</b>.

       <b>-6</b>
           Added in Shorewall 5.1.0. Causes the command to operate on the Shorewall6 or Shorewall6-lite
           configuration. It is the default when only Shorewall6-lite is installed and when the command is
           <b>shorewall6</b> or <b>shorewall6-lite</b>.

       <b>-l</b>
           Added in Shorewall 5.1.0. Causes the command to operate on either Shorewall-lite or Shorewall-6 lite
           and is the default when Shorewall is not installed or when the command is <b>shorewall-lite</b> or
           <b>shorewall6-lite</b>.

           With all four firewall products (Shorewall, Shorewall6, Shorewall-lite and Shorewall6-lite)
           installed, the following table shows the correspondence between the name used to invoke the command
           and the <b>shorewall</b> command with the above three options.

           <b>Table</b> <b>1.</b> <b>All</b> <b>four</b> <b>products</b> <b>installed</b>

           The next table shows the correspondence when only Shorewall-lite and Shorewall6-lite are installed.

           <b>Table</b> <b>2.</b> <b>Only</b> <b>Shorewall-lite</b> <b>and</b> <b>Shorewall6-lite</b> <b>installed</b>

           Note that when Shorewall isn't installed, the 'shorewall' command behaves like shorewall-lite. The
           same is not true with respect to Shorewall6, "shorewall6" and 'shorewall6-lite". You can make
           'shorewall6' behave like 'shorewallt-lite' by adding the following command to root's .profile file
           (or to .bashrc, if root's shell is bash):

                   alias shorewall6=shorewall6-lite

       <b>-v</b>[<u>verbosity</u>]
           Alters the amount of output produced by the command. If neither the <b>-v</b> nor <b>-q</b> option are specified,
           the amount of output is determined by the VERBOSITY setting in <b>shorewall.conf</b>[1](5)
           (<b>shorewall6.conf</b>[1](5)).

           When no <u>verbosity</u> is specified, each instance of this option causes 1 to be added to the effective
           verbosity. When <u>verbosity</u> (-1,0,1 or 2) is given, the command is executed at the specified VERBOSITY.
           There may be no white-space between <b>-v</b> and the <u>verbosity</u>.

       <b>-q</b>
           Alters the amount of output produced by the command. If neither the <b>-v</b> nor <b>-q</b> option are specified,
           the amount of output is determined by the VERBOSITY setting in <b>shorewall.conf</b>[1](5)
           (<b>shorewall6.conf</b>[1](5)).

           Each instance of this option causes 1 to be subtracted from the effective verbosity.

       <b>-t</b>
           Causes all progress messages to be timestamped.

       -T
           Added in Shorewall 5.2.4 to replace the earlier <b>trace</b> keyword.. If the command invokes the generated
           firewall script, the script's execution will be traced to standard error.

       -D
           Added in Shorewall 5.2.4 to replace the earlier debug keyword. If the command invokes the generated
           firewall script, individual invocations of the ip[6]tables utility will be used to configure the
           ruleset rather than ip[6]tables-restore. This is useful for diagnosing ip[6]tables-restore failures
           on a *COMMIT command.

           <b>Note</b>

           Prior to Shorewall 5.2.4, the general syntax for a CLI command was:

           [<b>trace|debug</b>] [<b>nolock</b>] [<u>options</u>] <u>command</u> [<u>command-options</u>] [<u>command-arguments</u>]

           Examples:

                   shorewall debug -tv2 reload
                   shorewall trace check
                   shorewall nolock enable eth0

           In Shorewall 5.2.4 and later, those commands would be:

                   shorewall -Dtv2 reload
                   shorewall check -D
                   shorewall -N enable eth0

           While not shown in the command synopses at the top of this page, the <b>nolock</b> keyword is still
           supported in Shorewall 5.2.4 and later, but is deprecated in favor of the -<b>N</b> option.

</pre><h4><b>COMMANDS</b></h4><pre>
       The available commands are listed below.

       <b>add</b> { <u>interface</u>[:<u>host-list</u>]... <u>zone</u> | <u>zone</u> <u>host-list</u> }
           Adds a list of hosts or subnets to a dynamic zone usually used with VPN's.

           The <u>interface</u> argument names an interface defined in the <b>shorewall-interfaces</b>[2](5)
           (<b>shorewall6-interfaces</b>[2](5))file. A <u>host-list</u> is comma-separated list whose elements are host or
           network addresses..if n .sp
               <b>Caution</b>
               The <b>add</b> command is not very robust. If there are errors in the <u>host-list</u>, you may see a large
               number of error messages yet a subsequent <b>shorewall</b> <b>show</b> <b>zones</b> command will indicate that all
               hosts were added. If this happens, replace <b>add</b> by <b>delete</b> and run the same command again. Then
               enter the correct command.

           Beginning with Shorewall 4.5.9, the <b>dynamic_shared</b> zone option
           (<b>shorewall-zones</b>[3](5),<b>shorewall6-zones</b>[3](5)) allows a single ipset to handle entries for multiple
           interfaces. When that option is specified for a zone, the <b>add</b> command has the alternative syntax in
           which the <u>zone</u> name precedes the <u>host-list</u>.

       <b>allow</b> <u>address</u>
           Re-enables receipt of packets from hosts previously blacklisted by a <b>blacklist</b>, <b>drop</b>, <b>logdrop</b>,
           <b>reject</b>, or <b>logreject</b> command.

       <b>blacklist[!]</b> <u>address</u> [ <u>option</u> ... ]
           Added in Shorewall 5.0.8 and requires DYNAMIC_BLACKLIST=ipset.. in <b>shorewall.conf</b>[1](5). Causes
           packets from the given host or network <u>address</u> to be dropped, based on the setting of BLACKLIST in
           <b>shorewall.conf</b>[1](5). The <u>address</u> along with any <u>option</u>s are passed to the <b>ipset</b> <b>add</b> command.
           Probably the most useful <u>option</u> is the <b>timeout</b> option. For example, to permanently blacklist
           192.0.2.22, the command would be:

                   shorewall blacklist 192.0.2.22 timeout 0

           Beginning with Shorewall 5.2.5, the above command can be shortened to:

                   shorewall blacklist! 192.0.2.22

           If the <b>disconnect</b> option is specified in the DYNAMIC_BLACKLISTING setting, then the effective
           VERBOSITY determines the amount of information displayed:

           •   If the effective verbosity is &gt; 0, then a message giving the number of conntrack flows deleted by
               the command is displayed.

           •   If the effective verbosity is &gt; 1, then the conntrack table entries deleted by the command are
               also displayed.

       <b>call</b> <u>function</u> <b>[</b> <u>parameter</u> <b>...</b> <b>]</b>
           Added in Shorewall 4.6.10. Allows you to call a function in one of the Shorewall libraries or in your
           compiled script. function must name the shell function to be called. The listed parameters are passed
           to the function.

           The function is first searched for in lib.base, lib.common, lib.cli and lib.cli-std. If it is not
           found, the call command is passed to the generated script to be executed.

       <b>check</b> [-<b>e</b>] [-<b>d</b>] [-<b>p</b>] [-<b>r</b>] [-<b>T</b>] [-<b>i</b>] [-D][<u>directory</u>]
           Not available with Shorewall[6]-lite.

           Compiles the configuration in the specified <u>directory</u> and discards the compiled output script. If no
           <u>directory</u> is given, then /etc/shorewall is assumed.

           The <b>-e</b> option causes the compiler to look for a file named capabilities. This file is produced using
           the command <b>shorewall-lite</b> <b>show</b> <b>-f</b> <b>capabilities</b> <b>&gt;</b> <b>capabilities</b> on a system with Shorewall Lite
           installed.

           The <b>-d</b> option causes the compiler to be run under control of the Perl debugger.

           The <b>-p</b> option causes the compiler to be profiled via the Perl <b>-wd:DProf</b> command-line option.

           The <b>-r</b> option was added in Shorewall 4.5.2 and causes the compiler to print the generated ruleset to
           standard out.

           The <b>-T</b> option was added in Shorewall 4.4.20 and causes a Perl stack trace to be included with each
           compiler-generated error and warning message.

           The <b>-i</b> option was added in Shorewall 4.6.0 and causes a warning message to be issued if the current
           line contains alternative input specifications following a semicolon (";"). Such lines will be
           handled incorrectly if INLINE_MATCHES is set to Yes in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)).

           The <b>-D</b> option was added in Shoewall 5.2.4 and causes the compiler to write a large amount of
           debugging information to standard output.

       <b>clear</b> [-<b>f</b>]
           Clear will remove all rules and chains installed by Shorewall. The firewall is then wide open and
           unprotected. Existing connections are untouched. Clear is often used to see if the firewall is
           causing connection problems.

           If <b>-f</b> is given, the command will be processed by the compiled script that executed the last
           successful <b>start</b>, <b>restart</b> or <b>reload</b> command if that script exists.

       <b>close</b> { <u>open-number</u> | <u>source</u> <u>dest</u> [ <u>protocol</u> [ <u>port</u> ] ] }
           Added in Shorewall 4.5.8. This command closes a temporary open created by the <b>open</b> command. In the
           first form, an <u>open-number</u> specifies the open to be closed. Open numbers are displayed in the <b>num</b>
           column of the output of the <b>shorewall</b> <b>show</b> <b>opens</b> command.

           When the second form of the command is used, the parameters must match those given in the earlier
           <b>open</b> command.

           This command requires that the firewall be in the started state and that DYNAMIC_BLACKLIST=Yes in
           <b>shorewall.conf</b> <b>(5)</b>[1].

       <b>compile</b> [-<b>e</b>] [-<b>c</b>] [-<b>d</b>] [-<b>p</b>] [-<b>T</b>] [-<b>i</b>] [-D] [ <u>directory</u> ] [ <u>pathname</u> ]
           Not available with shorewall[6]-lite.

           Compiles the current configuration into the executable file <u>pathname</u>. If a <u>directory</u> is supplied,
           Shorewall will look in that directory first for configuration files. If the <u>pathname</u> is omitted, the
           file firewall in the VARDIR (normally /var/lib/shorewall/) is assumed. A <u>pathname</u> of '-' causes the
           compiler to send the generated script to it's standard output file. Note that '-v-1' is usually
           specified in this case (e.g., <b>shorewall</b> <b>-v-1</b> <b>compile</b> <b>--</b> <b>-</b>) to suppress the 'Compiling...' message
           normally generated by /sbin/shorewall.

           When <b>-e</b> is specified, the compilation is being performed on a system other than where the compiled
           script will run. This option disables certain configuration options that require the script to be
           compiled where it is to be run. The use of <b>-e</b> requires the presence of a configuration file named
           capabilities which may be produced using the command <b>shorewall-lite</b> <b>show</b> <b>-f</b> <b>capabilities</b> <b>&gt;</b>
           <b>capabilities</b> on a system with Shorewall Lite installed

           The <b>-c</b> option was added in Shorewall 4.5.17 and causes conditional compilation of a script. The
           script specified by <u>pathname</u> (or implied if <b>pathname</b> is omitted) is compiled if it doesn't exist or
           if there is any file in the <u>directory</u> or in a directory on the CONFIG_PATH that has a modification
           time later than the file to be compiled. When no compilation is needed, a message is issued and an
           exit status of zero is returned.

           The <b>-d</b> option causes the compiler to be run under control of the Perl debugger.

           The <b>-p</b> option causes the compiler to be profiled via the Perl <b>-wd:DProf</b> command-line option.

           The <b>-T</b> option was added in Shorewall 4.4.20 and causes a Perl stack trace to be included with each
           compiler-generated error and warning message.

           The <b>-i</b> option was added in Shorewall 4.6.0 and causes a warning message to be issued if the current
           line contains alternative input specifications following a semicolon (";"). Such lines will be
           handled incorrectly if INLINE_MATCHES is set to Yes in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)).

           The <b>-D</b> option was added in Shoewall 5.2.4 and causes the compiler to write a large amount of
           debugging information to standard output.

       <b>delete</b> { <u>interface</u>[:<u>host-list</u>]... <u>zone</u> | <u>zone</u> <u>host-list</u> }
           The delete command reverses the effect of an earlier <b>add</b> command.

           The <u>interface</u> argument names an interface defined in the <b>shorewall-interfaces</b>[2](5)
           (<b>shorewall6-interfaces</b>[2](5) file. A <u>host-list</u> is comma-separated list whose elements are a host or
           network address.

           Beginning with Shorewall 4.5.9, the <b>dynamic_shared</b> zone option (<b>shorewall-zones</b>[3](5),
           <b>shorewall6-zones</b>[3](5)) allows a single ipset to handle entries for multiple interfaces. When that
           option is specified for a zone, the <b>delete</b> command has the alternative syntax in which the <u>zone</u> name
           precedes the <u>host-list</u>.

       <b>disable</b> { <u>interface</u> | <u>provider</u> }
           Added in Shorewall 4.4.26. Disables the optional provider associated with the specified <u>interface</u> or
           <u>provider</u>. Where more than one provider share a single network interface, a <u>provider</u> name must be
           given.

           Beginning with Shorewall 4.5.10, this command may be used with any optional network interface.
           <u>interface</u> may be either the logical or physical name of the interface. The command removes any routes
           added from <b>shorewall-routes</b>[4](5) (<b>shorewall6-routes</b>[4](5))and any traffic shaping configuration for
           the interface.

       <b>drop</b> <u>address</u>
           Causes traffic from the listed <u>address</u>es to be silently dropped. This command requires that the
           firewall be in the started state and that DYNAMIC_BLACKLIST=Yes in <b>shorewall.conf</b> <b>(5)</b>[1].

       <b>dump</b>  [-<b>x</b>] [-<b>l</b>] [-<b>m</b>] [-<b>c</b>]
           Produces a verbose report about the firewall configuration for the purpose of problem analysis.

           The <b>-x</b> option causes actual packet and byte counts to be displayed. Without that option, these counts
           are abbreviated.

           The <b>-m</b> option causes any MAC addresses included in Shorewall log messages to be displayed.

           The <b>-l</b> option causes the rule number for each Netfilter rule to be displayed.

           The <b>-c</b> option causes the route cache to be dumped in addition to the other routing information.

       <b>enable</b> { <u>interface</u> | <u>provider</u> }
           Added in Shorewall 4.4.26. Enables the optional provider associated with the specified <u>interface</u> or
           <u>provider</u>. Where more than one provider share a single network interface, a <u>provider</u> name must be
           given.

           Beginning with Shorewall 4.5.10, this command may be used with any optional network interface.
           <u>interface</u> may be either the logical or physical name of the interface. The command sets <a href="file:/proc">/proc</a> entries
           for the interface, adds any route specified in <b>shorewall-routes</b>[4](5) (<b>shorewall6-routes</b>[4](5)) and
           installs the interface's traffic shaping configuration, if any.

       <b>export</b> [ <u>directory1</u> ] [ <u>user</u>@]<u>system</u>[:<u>directory2</u> ]
           Not available with Shorewall[6]-lite.

           If <u>directory1</u> is omitted, the current working directory is assumed.

           Allows a non-root user to compile a shorewall script and stage it on a system (provided that the user
           has access to the system via ssh). The command is equivalent to:

                   <b>/sbin/shorewall</b> <b>compile</b> <b>-e</b> <u>directory1</u> <u>directory1</u><b>/firewall</b> <b>&amp;&amp;\</b>
                   <b>scp</b> directory1<b>/firewall</b> <u>directory1</u><b>/firewall.conf</b> [<u>user</u>@]<b>system</b>:[<u>directory2</u>]

           In other words, the configuration in the specified (or defaulted) directory is compiled to a file
           called firewall in that directory. If compilation succeeds, then firewall and firewall.conf are
           copied to <u>system</u> using scp.

       <b>forget</b> [ <u>filename</u> ]
           Deletes /var/lib/shorewall/<u>filename</u> and /var/lib/shorewall/save. If no <u>filename</u> is given then the
           file specified by RESTOREFILE in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)) is assumed.

       <b>help</b>
           Displays a syntax summary.

       <b>hits</b> [-<b>t</b>]
           Generates several reports from Shorewall log messages in the current log file. If the <b>-t</b> option is
           included, the reports are restricted to log messages generated today. Not available with
           Shorewall6[-lite].

       <b>ipcalc</b> { address mask | address/vlsm }
           Ipcalc displays the network address, broadcast address, network in CIDR notation and netmask
           corresponding to the input[s]. Not available with Shorewall6[-lite].

       <b>iprange</b> <u>address1</u>-<u>address2</u>
           Iprange decomposes the specified range of IP addresses into the equivalent list of network/host
           addresses. Not available with Shorewall6[-lite].

       <b>iptrace</b> <u>iptables</u> <u>match</u> <u>expression</u>
           This is a low-level debugging command that causes iptables TRACE log records to be created. See
           <a href="../man8/iptables.8.html">iptables</a>(8) for details.

           The <u>iptables</u> <u>match</u> <u>expression</u> must be one or more matches that may appear in both the raw table
           OUTPUT and raw table PREROUTING chains.

           The log message destination is determined by the currently-selected IPv4 or IPv6 <b>logging</b> <b>backend</b>[5].

       <b>list</b>
           <b>list</b> is a synonym for <b>show</b> -- please see below.

       <b>logdrop</b> <u>address</u>
           Causes traffic from the listed <u>address</u>es to be logged then discarded. Logging occurs at the log level
           specified by the BLACKLIST_LOGLEVEL setting in <b>shorewall.conf</b>[1] (5) (<b>shorewall6.conf</b>[1](5)). This
           command requires that the firewall be in the started state and that DYNAMIC_BLACKLIST=Yes in
           <b>shorewall.conf</b> <b>(5)</b>[1].

       <b>logwatch</b> [-<b>m</b>] [ <u>refresh-interval</u> ]
           Monitors the log file specified by the LOGFILE option in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5))
           and produces an audible alarm when new Shorewall messages are logged. The <b>-m</b> option causes the MAC
           address of each packet source to be displayed if that information is available. The <u>refresh-interval</u>
           specifies the time in seconds between screen refreshes. You can enter a negative number by preceding
           the number with "--" (e.g., <b>shorewall</b> <b>logwatch</b> <b>--</b> <b>-30</b>). In this case, when a packet count changes,
           you will be prompted to hit any key to resume screen refreshes.

       <b>logreject</b> <u>address</u>
           Causes traffic from the listed <u>address</u>es to be logged then rejected. Logging occurs at the log level
           specified by the BLACKLIST_LOGLEVEL setting in <b>shorewall.conf</b>[1] (5), (<b>shorewall6.conf</b>[1](5)). This
           command requires that the firewall be in the started state and that DYNAMIC_BLACKLIST=Yes in
           <b>shorewall.conf</b> <b>(5)</b>[1].

       <b>ls</b>
           <b>ls</b> is a synonym for <b>show</b> -- please see below.

       <b>noiptrace</b> <u>iptables</u> <u>match</u> <u>expression</u>
           This is a low-level debugging command that cancels a trace started by a preceding <b>iptrace</b> command.

           The <u>iptables</u> <u>match</u> <u>expression</u> must be one given in the <b>iptrace</b> command being canceled.

       <b>open</b> <u>source</u> <u>dest</u> [ <u>protocol</u> [ <u>port</u> ] ]
           Added in Shorewall 4.6.8. This command requires that the firewall be in the started state and that
           DYNAMIC_BLACKLIST=Yes in <b>shorewall.conf</b> <b>(5)</b>[1]. The effect of the command is to temporarily open the
           firewall for connections matching the parameters.

           The <u>source</u> and <u>dest</u> parameters may each be specified as <b>all</b> if you don't wish to restrict the
           connection source or destination respectively. Otherwise, each must contain a host or network address
           or a valid DNS name.

           The <u>protocol</u> may be specified either as a number or as a name listed in /etc/protocols. The <u>port</u> may
           be specified numerically or as a name listed in /etc/services.

           To reverse the effect of a successful <b>open</b> command, use the <b>close</b> command with the same parameters or
           simply restart the firewall.

           Example: To open the firewall for SSH connections to address 192.168.1.1, the command would be:

                   shorewall open all 192.168.1.1 tcp 22

           To reverse that command, use:

                   shorewall close all 192.168.1.1 tcp 22

       <b>reenable</b>{ <u>interface</u> | <u>provider</u> }
           Added in Shorewall 4.6.9. This is equivalent to a <b>disable</b> command followed by an <b>enable</b> command on
           the specified <u>interface</u> or <u>provider</u>.

       <b>reject</b> <u>address</u>
           Causes traffic from the listed <u>address</u>es to be silently rejected. This command requires that the
           firewall be in the started state and that DYNAMIC_BLACKLIST=Yes in <b>shorewall.conf</b> <b>(5)</b>[1].

       <b>reload</b> [-<b>n</b>] [-<b>p</b>] [-<b>d</b>] [-<b>f</b>] [-<b>c</b>] [-<b>T</b>] [-<b>i</b>] [-<b>C</b>] [-D] [ <u>directory</u> ]
           This command was re-implemented in Shorewall 5.0.0. The pre-5.0.0 <b>reload</b> command is now called
           <b>remote-restart</b> (see below).

           Shorewall and Shorewall6
               Reload is similar to <b>shorewall</b> <b>start</b> except that it assumes that the firewall is already started.
               Existing connections are maintained. If a <u>directory</u> is included in the command, Shorewall will
               look in that <u>directory</u> first for configuration files.

               The <b>-n</b> option causes Shorewall to avoid updating the routing table(s).

               The <b>-p</b> option causes the connection tracking table to be flushed; the <b>conntrack</b> utility must be
               installed to use this option.

               The <b>-d</b> option causes the compiler to run under the Perl debugger.

               The <b>-f</b> option suppresses the compilation step and simply reused the compiled script which last
               started/restarted Shorewall, provided that /etc/shorewall and its contents have not been modified
               since the last start/restart.

               The <b>-c</b> option was added in Shorewall 4.4.20 and performs the compilation step unconditionally,
               overriding the AUTOMAKE setting in <b>shorewall.conf</b>[1](5) (Shorewall and Shorewall6 only). When
               both <b>-f</b> and <b>-c</b> are present, the result is determined by the option that appears last.

               The <b>-T</b> option was added in Shorewall 4.5.3 and causes a Perl stack trace to be included with each
               compiler-generated error and warning message.

               The <b>-i</b> option was added in Shorewall 4.6.0 and causes a warning message to be issued if the
               current line contains alternative input specifications following a semicolon (";"). Such lines
               will be handled incorrectly if INLINE_MATCHES is set to Yes in <b>shorewall.conf</b>[1](5)
               (<b>shorewall6.conf</b>[1](5))..

               The <b>-C</b> option was added in Shorewall 4.6.5 and is only meaningful when AUTOMAKE=Yes in
               <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)). If an existing firewall script is used and if that
               script was the one that generated the current running configuration, then the running netfilter
               configuration will be reloaded as is so as to preserve the iptables packet and byte counters.

               The <b>-D</b> option was added in Shoewall 5.2.4 and causes the compiler to write a large amount of
               debugging information to standard output.

           Shorewall-lite and Shorewall6-lite
               Reload is similar to <b>shorewall</b> <b>start</b> except that it assumes that the firewall is already started.
               Existing connections are maintained.

               The <b>-n</b> option causes Shorewall to avoid updating the routing table(s).

               The <b>-p</b> option causes the connection tracking table to be flushed; the <b>conntrack</b> utility must be
               installed to use this option.

               The <b>-C</b> option was added in Shorewall 4.6.5 If the existing firewall script is the one that
               generated the current running configuration, then the running netfilter configuration will be
               reloaded as is so as to preserve the iptables packet and byte counters.

       <b>remote-getcaps</b> [-<b>R</b>] [-<b>r</b> <u>root-user-name</u>] [ [ -D ] <u>directory</u> ] [ <u>system</u> ]
           Added in Shoreall 5.2.0, this command executes <b>shorewall[6]-lite</b> <b>show</b> <b>capabilities</b> <b>-f</b> <b>&gt;</b>
           <b>/var/lib/shorewall[6]-lite/capabilities</b> on the remote <u>system</u> via ssh then the generated file is
           copied to <u>directory</u> on the local system. If no <u>directory</u> is given, the current working directory is
           assumed.

           if <b>-R</b> is included, the remote shorewallrc file is also copied to <u>directory</u>.

           If <b>-r</b> is included, it specifies that the root user on <u>system</u> is named <u>root-user-name</u> rather than
           "root".

       <b>remote-getrc</b> [-<b>c</b>] [-<b>r</b> <u>root-user-name</u>] [ [ -D ] <u>directory</u> ] [ <u>system</u> ]
           Added in Shoreall 5.2.0, this command copies the shorewallrc file from the remote <u>system</u> to <u>directory</u>
           on the local system. If no <u>directory</u> is given, the current working directory is assumed.

           if <b>-c</b> is included, the remote capabilities are also copied to <u>directory</u>, as is done by the
           <b>remote-getcaps</b> command.

           If <b>-r</b> is included, it specifies that the root user on <u>system</u> is named <u>root-user-name</u> rather than
           "root".

       <b>remote-start</b> [-<b>n</b>] [-<b>s</b>] [-<b>c</b>] [-<b>r</b> <u>root-user-name</u>] [-<b>T</b>] [-<b>i</b>] [ [ -D ] <u>directory</u> ] [ <u>system</u> ]
           This command was renamed from <b>load</b> in Shorewall 5.0.0 and is only available in Shorewall and
           Shoreawall6.

           If <u>directory</u> is omitted, the current working directory is assumed. Allows a non-root user to compile
           a shorewall script and install it on a system (provided that the user has root access to the system
           via ssh). The command is equivalent to:

                   <b>/sbin/shorewall</b> <b>compile</b> <b>-e</b> <u>directory</u> <u>directory</u><b>/firewall</b> <b>&amp;&amp;\</b>
                   <b>scp</b> <u>directory</u><b>/firewall</b> <u>directory</u><b>/firewall.conf</b> <b>root@</b><u>system</u><b>:/var/lib/shorewall-lite/</b> <b>&amp;&amp;\</b>
                   <b>ssh</b> <b>root@</b><u>system</u> <b>'/sbin/shorewall-lite</b> <b>start'</b>

           In other words, the configuration in the specified (or defaulted) directory is compiled to a file
           called firewall in that directory. If compilation succeeds, then firewall is copied to <u>system</u> using
           scp. If the copy succeeds, Shorewall Lite on <u>system</u> is started via ssh. Beginning with Shorewall
           5.0.13, if <u>system</u> is omitted, then the FIREWALL option setting in <b>shorewall.conf</b>[6](5)
           (<b><a href="../man5/shorewall6.conf.5.html">shorewall6.conf</a>(5)</b>[1]) is assumed. In that case, if you want to specify a <u>directory</u>, then the <b>-D</b>
           option must be given.

           The <b>-n</b> option causes Shorewall to avoid updating the routing table(s).

           If <b>-s</b> is specified and the <b>start</b> command succeeds, then the remote Shorewall-lite configuration is
           saved by executing <b>shorewall-lite</b> <b>save</b> via ssh.

           if <b>-c</b> is included, the command <b>shorewall[6]-lite</b> <b>show</b> <b>capabilities</b> <b>-f</b> <b>&gt;</b>
           <b>/var/lib/shorewall[6]-lite/capabilities</b> is executed via ssh then the generated file is copied to
           <u>directory</u> using scp. This step is performed before the configuration is compiled.

           If <b>-r</b> is included, it specifies that the root user on <u>system</u> is named <u>root-user-name</u> rather than
           "root".

           The <b>-T</b> option was added in Shorewall 4.5.3 and causes a Perl stack trace to be included with each
           compiler-generated error and warning message.

       <b>remote-reload</b> [-<b>s</b>] [-<b>c</b>] [-<b>r</b> <u>root-user-name</u>] [-<b>T</b>] [-<b>i</b>] [ [ -D ] <u>directory</u> ] [ <u>system</u> ]
           This command was added in Shorewall 5.0.0 and is only available in Shorewall and Shorewall6.

           If <u>directory</u> is omitted, the current working directory is assumed. Allows a non-root user to compile
           a shorewall script and install it on a system (provided that the user has root access to the system
           via ssh). The command is equivalent to:

                   <b>/sbin/shorewall</b> <b>compile</b> <b>-e</b> <u>directory</u> <u>directory</u><b>/firewall</b> <b>&amp;&amp;\</b>
                   <b>scp</b> <u>directory</u><b>/firewall</b> <u>directory</u><b>/firewall.conf</b> <b>root@</b><u>system</u><b>:/var/lib/shorewall-lite/</b> <b>&amp;&amp;\</b>
                   <b>ssh</b> <b>root@</b><u>system</u> <b>'/sbin/shorewall-lite</b> <b>reload'</b>

           In other words, the configuration in the specified (or defaulted) directory is compiled to a file
           called firewall in that directory. If compilation succeeds, then firewall is copied to <u>system</u> using
           scp. If the copy succeeds, Shorewall Lite on <u>system</u> is restarted via ssh. Beginning with Shorewall
           5.0.13, if <u>system</u> is omitted, then the FIREWALL option setting in <b><a href="../man5/shorewall6.conf.5.html">shorewall6.conf</a>(5)</b>[1]
           (<b>shorewall6.conf</b>[1](5)) is assumed. In that case, if you want to specify a <u>directory</u>, then the <b>-D</b>
           option must be given.

           If <b>-s</b> is specified and the <b>restart</b> command succeeds, then the remote Shorewall-lite configuration is
           saved by executing <b>shorewall-lite</b> <b>save</b> via ssh.

           if <b>-c</b> is included, the command <b>shorewall-lite</b> <b>show</b> <b>capabilities</b> <b>-f</b> <b>&gt;</b>
           <b>/var/lib/shorewall-lite/capabilities</b> is executed via ssh then the generated file is copied to
           <u>directory</u> using scp. This step is performed before the configuration is compiled.

           If <b>-r</b> is included, it specifies that the root user on <u>system</u> is named <u>root-user-name</u> rather than
           "root".

           The <b>-T</b> option was added in Shorewall 4.5.3 and causes a Perl stack trace to be included with each
           compiler-generated error and warning message.

           The <b>-i</b> option was added in Shorewall 4.6.0 and causes a warning message to be issued if the current
           line contains alternative input specifications following a semicolon (";"). Such lines will be
           handled incorrectly if INLINE_MATCHES is set to Yes in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)).

       <b>remote-restart</b> [-<b>s</b>] [-<b>c</b>] [-<b>r</b> <u>root-user-name</u>] [-<b>T</b>] [-<b>i</b>] [ [ -D ] <u>directory</u> ] [ <u>system</u> ]
           This command was renamed from <b>reload</b> in Shorewall 5.0.0 and is available in Shorewall and Shorewall6
           only.

           If <u>directory</u> is omitted, the current working directory is assumed. Allows a non-root user to compile
           a shorewall script and install it on a system (provided that the user has root access to the system
           via ssh). The command is equivalent to:

                   <b>/sbin/shorewall</b> <b>compile</b> <b>-e</b> <u>directory</u> <u>directory</u><b>/firewall</b> <b>&amp;&amp;\</b>
                   <b>scp</b> <u>directory</u><b>/firewall</b> <u>directory</u><b>/firewall.conf</b> <b>root@</b><u>system</u><b>:/var/lib/shorewall-lite/</b> <b>&amp;&amp;\</b>
                   <b>ssh</b> <b>root@</b><u>system</u> <b>'/sbin/shorewall-lite</b> <b>restart'</b>

           In other words, the configuration in the specified (or defaulted) directory is compiled to a file
           called firewall in that directory. If compilation succeeds, then firewall is copied to <u>system</u> using
           scp. If the copy succeeds, Shorewall Lite on <u>system</u> is restarted via ssh. Beginning with Shorewall
           5.0.13, if <u>system</u> is omitted, then the FIREWALL option setting in <b><a href="../man5/shorewall6.conf.5.html">shorewall6.conf</a>(5)</b>[1]
           (<b>shorewall6.conf</b>[1](5)) is assumed. In that case, if you want to specify a <u>directory</u>, then the <b>-D</b>
           option must be given.

           If <b>-s</b> is specified and the <b>restart</b> command succeeds, then the remote Shorewall-lite configuration is
           saved by executing <b>shorewall-lite</b> <b>save</b> via ssh.

           if <b>-c</b> is included, the command <b>shorewall-lite</b> <b>show</b> <b>capabilities</b> <b>-f</b> <b>&gt;</b>
           <b>/var/lib/shorewall-lite/capabilities</b> is executed via ssh then the generated file is copied to
           <u>directory</u> using scp. This step is performed before the configuration is compiled.

           If <b>-r</b> is included, it specifies that the root user on <u>system</u> is named <u>root-user-name</u> rather than
           "root".

           The <b>-T</b> option was added in Shorewall 4.5.3 and causes a Perl stack trace to be included with each
           compiler-generated error and warning message.

           The <b>-i</b> option was added in Shorewall 4.6.0 and causes a warning message to be issued if the current
           line contains alternative input specifications following a semicolon (";"). Such lines will be
           handled incorrectly if INLINE_MATCHES is set to Yes in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5).

       <b>reset</b> <b>[</b><u>chain</u><b>,</b> <b>...]</b>
           Resets the packet and byte counters in the specified <u>chain</u>(s). If no <u>chain</u> is specified, all the
           packet and byte counters in the firewall are reset.

           Beginning with Shorewall 5.0.0, <u>chain</u> may be composed of both a table name and a chain name separated
           by a colon (e.g., mangle:PREROUTING). Chain names following that don't include a table name are
           assumed to be in that same table. If no table name is given in the command, the filter table is
           assumed.

       <b>restart</b> [-<b>n</b>] [-<b>p</b>] [-<b>d</b>] [-<b>f</b>] [-<b>c</b>] [-<b>T</b>] [-<b>i</b>] [-<b>C</b>] [-D] [ <u>directory</u> ]
           Beginning with Shorewall 5.0.0, this command performs a true restart. The firewall is completely
           stopped as if a <b>stop</b> command had been issued then it is started again.

           Shorewall and Shorewall6
               If a <u>directory</u> is included in the command, Shorewall will look in that <u>directory</u> first for
               configuration files.

               The <b>-n</b> option causes Shorewall to avoid updating the routing table(s).

               The <b>-p</b> option causes the connection tracking table to be flushed; the <b>conntrack</b> utility must be
               installed to use this option.

               The <b>-d</b> option causes the compiler to run under the Perl debugger.

               The <b>-f</b> option suppresses the compilation step and simply reused the compiled script which last
               started/restarted Shorewall, provided that /etc/shorewall and its contents have not been modified
               since the last start/restart.

               The <b>-c</b> option was added in Shorewall 4.4.20 and performs the compilation step unconditionally,
               overriding the AUTOMAKE setting in <b>shorewall.conf</b>[1](5). When both <b>-f</b> and <b>-c</b> are present, the
               result is determined by the option that appears last.

               The <b>-T</b> option was added in Shorewall 4.5.3 and causes a Perl stack trace to be included with each
               compiler-generated error and warning message.

               The <b>-i</b> option was added in Shorewall 4.6.0 and causes a warning message to be issued if the
               current line contains alternative input specifications following a semicolon (";"). Such lines
               will be handled incorrectly if INLINE_MATCHES is set to Yes in <b>shorewall.conf</b>[1](5).

               The <b>-C</b> option was added in Shorewall 4.6.5 and is only meaningful when AUTOMAKE=Yes in
               <b>shorewall.conf</b>[1](5). If an existing firewall script is used and if that script was the one that
               generated the current running configuration, then the running netfilter configuration will be
               reloaded as is so as to preserve the iptables packet and byte counters.

               The <b>-D</b> option was added in Shoewall 5.2.4 and causes the compiler to write a large amount of
               debugging information to standard output.

           Shorewall-lite and Shorewall6-lite
               The <b>-n</b> option causes Shorewall to avoid updating the routing table(s).

               The <b>-p</b> option causes the connection tracking table to be flushed; the <b>conntrack</b> utility must be
               installed to use this option.

               The <b>-C</b> option was added in Shorewall 4.6.5 If the existing firewall script is the one that
               generated the current running configuration, then the running netfilter configuration will be
               reloaded as is so as to preserve the iptables packet and byte counters.

       <b>restore</b>  [-<b>n</b>] [-<b>p</b>] [-<b>C</b>] [ <u>filename</u> ]
           Restore Shorewall to a state saved using the <b>shorewall</b> <b>save</b> command. Existing connections are
           maintained. The <u>filename</u> names a restore file in /var/lib/shorewall created using <b>shorewall</b> <b>save</b>; if
           no <u>filename</u> is given then Shorewall will be restored from the file specified by the RESTOREFILE
           option in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)).

               <b>Caution</b>
               If your iptables ruleset depends on variables that are detected at run-time, either in your
               params file or by Shorewall-generated code, <b>restore</b> will use the values that were current when
               the ruleset was saved, which may be different from the current values.
           The <b>-n</b> option causes Shorewall to avoid updating the routing table(s).

           The <b>-p</b> option, added in Shorewall 4.6.5, causes the connection tracking table to be flushed; the
           <b>conntrack</b> utility must be installed to use this option.

           The <b>-C</b> option was added in Shorewall 4.6.5. If the <b>-C</b> option was specified during <b>shorewall</b> <b>save</b>,
           then the counters saved by that operation will be restored.

       <b>run</b> <u>command</u> [ <u>parameter</u> ... ]
           Added in Shorewall 4.6.3. Executes <u>command</u> in the context of the generated script passing the
           supplied <u>parameter</u>s. Normally, the <u>command</u> will be a function declared in lib.private.

           Before executing the <u>command</u>, the script will detect the configuration, setting all SW_* variables
           and will run your init extension script with $COMMAND = 'run'.

           If there are files in the CONFIG_PATH that were modified after the current firewall script was
           generated, the following warning message is issued:
               WARNING: /var/lib/shorewall/firewall is not up to
                           date

       <b>safe-reload</b> [-<b>d</b>] [-<b>p</b>] [-<b>t</b> <u>timeout</u> ] [ <u>directory</u> ]
           Added in Shorewall 5.0.0, this command performs the same function as did <b>safe_restart</b> in earlier
           releases. The command is available in Shorewall and Shorewall6 only.

           Only allowed if Shorewall is running. The current configuration is saved in
           /var/lib/shorewall/safe-reload (see the save command below) then a <b>shorewall</b> <b>reload</b> is done. You will
           then be prompted asking if you want to accept the new configuration or not. If you answer "n" or if
           you fail to answer within 60 seconds (such as when your new configuration has disabled communication
           with your terminal), the configuration is restored from the saved configuration. If a directory is
           given, then Shorewall will look in that directory first when opening configuration files.

           Beginning with Shorewall 4.5.0, you may specify a different <u>timeout</u> value using the <b>-t</b> option. The
           numeric <u>timeout</u> may optionally be followed by an <b>s</b>, <b>m</b> or <b>h</b> suffix (e.g., 5m) to specify seconds,
           minutes or hours respectively. If the suffix is omitted, seconds is assumed.

       <b>safe-restart</b> [-<b>d</b>] [-<b>p</b>] [-<b>t</b> <u>timeout</u> ] [ <u>directory</u> ]
           Only allowed if Shorewall[6] is running and is not available in Shorewall-lite and Shorewall6-lite.
           The current configuration is saved in /var/lib/shorewall/safe-restart (see the save command below)
           then a <b>shorewall</b> <b>restart</b> is done. You will then be prompted asking if you want to accept the new
           configuration or not. If you answer "n" or if you fail to answer within 60 seconds (such as when your
           new configuration has disabled communication with your terminal), the configuration is restored from
           the saved configuration. If a directory is given, then Shorewall will look in that directory first
           when opening configuration files.

           Beginning with Shorewall 4.5.0, you may specify a different <u>timeout</u> value using the <b>-t</b> option. The
           numeric <u>timeout</u> may optionally be followed by an <b>s</b>, <b>m</b> or <b>h</b> suffix (e.g., 5m) to specify seconds,
           minutes or hours respectively. If the suffix is omitted, seconds is assumed.

       <b>safe-start</b> [-<b>d</b>] [-<b>p</b>] [-<b>t</b><u>timeout</u> ] [ <u>directory</u> ]
           Shorewall is started normally. You will then be prompted asking if everything went all right. If you
           answer "n" or if you fail to answer within 60 seconds (such as when your new configuration has
           disabled communication with your terminal), a shorewall clear is performed for you. If a directory is
           given, then Shorewall will look in that directory first when opening configuration files.

           Beginning with Shorewall 4.5.0, you may specify a different <u>timeout</u> value using the <b>-t</b> option. The
           numeric <u>timeout</u> may optionally be followed by an <b>s</b>, <b>m</b> or <b>h</b> suffix (e.g., 5m) to specify seconds,
           minutes or hours respectively. If the suffix is omitted, seconds is assumed.

           This command is available in Shorewall and Shorewall6 only.

       <b>save</b>  [-<b>C</b>] [ <u>filename</u> ]
           Creates a snapshot of the currently running firewall. The dynamic blacklist is stored in
           /var/lib/shorewall/save. The state of the firewall is stored in /var/lib/shorewall/<u>filename</u> for use
           by the <b>shorewall</b> <b>restore</b> command. If <u>filename</u> is not given then the state is saved in the file
           specified by the RESTOREFILE option in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)).

           The <b>-C</b> option, added in Shorewall 4.6.5, causes the iptables packet and byte counters to be saved
           along with the chains and rules.

       <b>savesets</b>
           Added in shorewall 4.6.8. Performs the same action as the <b>stop</b> command with respect to saving ipsets
           (see the SAVE_IPSETS option in <b>shorewall.conf</b>[1] (5) (<b>shorewall6.conf</b>[1](5)). This command may be
           used to proactively save your ipset contents in the event that a system failure occurs prior to
           issuing a <b>stop</b> command.

       <b>show</b>
           The show command can have a number of different arguments:

           <b>action</b> <u>action</u>
               Lists the named action file. Available on Shorewall and Shorewall6 only.

           <b>actions</b>
               Produces a report about the available actions (built-in, standard and user-defined). Available on
               Shorewall and Shorewall6 only.

           <b>bl|blacklists</b> [-<b>x</b>]
               Added in Shorewall 4.6.2. Displays the dynamic chain along with any chains produced by entries in
               <a href="../man5/shorewall-blrules.5.html">shorewall-blrules</a>(5). The <b>-x</b> option is passed directly through to iptables and causes actual
               packet and byte counts to be displayed. Without this option, those counts are abbreviated.

           [-<b>f</b>] <b>capabilities</b>
               Displays your kernel/iptables capabilities. The <b>-f</b> option causes the display to be formatted as a
               capabilities file for use with <b>compile</b> <b>-e</b>.

           [-<b>b</b>] [-<b>x</b>] [-<b>l</b>] [-<b>t</b> {<b>filter</b>|<b>mangle</b>|<b>nat</b>|<b>raw</b>}] [ <u>chain</u>... ]
               The rules in each <u>chain</u> are displayed using the <b>iptables</b> <b>-L</b> <u>chain</u> <b>-n</b> <b>-v</b> command. If no <u>chain</u> is
               given, all of the chains in the filter table are displayed. The <b>-x</b> option is passed directly
               through to iptables and causes actual packet and byte counts to be displayed. Without this
               option, those counts are abbreviated. The <b>-t</b> option specifies the Netfilter table to display. The
               default is <b>filter</b>.

               The <b>-b</b> ('brief') option causes rules which have not been used (i.e. which have zero packet and
               byte counts) to be omitted from the output. Chains with no rules displayed are also omitted from
               the output.

               The <b>-l</b> option causes the rule number for each Netfilter rule to be displayed.

               If the -<b>t</b> option and the <b>chain</b> keyword are both omitted and any of the listed <u>chain</u>s do not
               exist, a usage message is displayed.

           <b>classifiers|filters</b>
               Displays information about the packet classifiers defined on the system as a result of traffic
               shaping configuration. Beginning with Shorewall 5.2.8, this command is deprecated, as its output
               is included in the information displayed by the 'show tc' command.

           <b>config</b>
               Displays distribution-specific defaults.

           <b>connections</b> <b>[</b><u>filter_parameter</u> <b>...]</b>
               Displays the IP connections currently being tracked by the firewall.

               If the <b>conntrack</b> utility is installed, beginning with Shorewall 4.6.11 the set of connections
               displayed can be limited by including conntrack filter parameters (-p , -s, --dport, etc). See
               <a href="../man8/conntrack.8.html">conntrack</a>(8) for details.

           <b>event</b> <u>event</u>
               Added in Shorewall 4.5.19. Displays the named event.

           <b>events</b>
               Added in Shorewall 4.5.19. Displays all events.

           <b>ip</b>
               Displays the system's IPv4 configuration.

           <b>ipa</b>
               Added in Shorewall 4.4.17. Displays the per-IP accounting counters (<b>shorewall-accounting</b>[7] (5),
               <b>shorewall6-accounting</b>[7](5)).

           <b>ipsec</b>
               Added in Shorewall 5.1.0. Displays the contents of the IPSEC Security Policy Database (SPD) and
               Security Association Database (SAD). SAD keys are not displayed.

           [-<b>m</b>] <b>log</b>
               Displays the last 20 Shorewall messages from the log file specified by the LOGFILE option in
               <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)). The <b>-m</b> option causes the MAC address of each packet
               source to be displayed if that information is available.

           <b>macros</b>
               Displays information about each macro defined on the firewall system (Shorewall and Shorewall6
               only)

           <b>macro</b> <u>macro</u>
               Added in Shorewall 4.4.6. Displays the file that implements the specified <u>macro</u> (usually
               /usr/share/shorewall/macro.<u>macro</u>). Available only in Shorewall and Shorewall6.

           [-<b>x</b>] <b>mangle</b>
               Displays the Netfilter mangle table using the command <b>iptables</b> <b>-t</b> <b>mangle</b> <b>-L</b> <b>-n</b> <b>-v</b>. The <b>-x</b> option
               is passed directly through to iptables and causes actual packet and byte counts to be displayed.
               Without this option, those counts are abbreviated.

           <b>marks</b>
               Added in Shorewall 4.4.26. Displays the various fields in packet marks giving the min and max
               value (in both decimal and hex) and the applicable mask (in hex).

           [-<b>x</b>] <b>nat</b>
               Displays the Netfilter nat table using the command <b>iptables</b> <b>-t</b> <b>nat</b> <b>-L</b> <b>-n</b> <b>-v</b>. The <b>-x</b> option is
               passed directly through to iptables and causes actual packet and byte counts to be displayed.
               Without this option, those counts are abbreviated.

           <b>opens</b>
               Added in Shorewall 4.5.8. Displays the iptables rules in the 'dynamic' chain created through use
               of the <b>open</b> command..

           <b>policies</b>
               Added in Shorewall 4.4.4. Displays the applicable policy between each pair of zones. Note that
               implicit intrazone ACCEPT policies are not displayed for zones associated with a single network
               where that network doesn't specify <b>routeback</b>.

           <b>rc</b>
               Added in Shorewall 5.2.0. Displays the contents of $SHAREDIR/shorewall/shorewallrc.

           [-<b>c</b>] <b>routing</b>
               Displays the system's IPv4 routing configuration. The <b>-c</b> option causes the route cache to be
               displayed along with the other routing information.

           [-<b>x</b>] <b>raw</b>
               Displays the Netfilter raw table using the command <b>iptables</b> <b>-t</b> <b>raw</b> <b>-L</b> <b>-n</b> <b>-v</b>. The <b>-x</b> option is
               passed directly through to iptables and causes actual packet and byte counts to be displayed.
               Without this option, those counts are abbreviated.

           saves
               Added in Shorewall 5.2.0. Lists snapshots created by the <b>save</b> command. Each snapshot is listed
               with the date and time when it was taken. If there is a snapshot with the name specified in the
               RESTOREFILE option in <b>shorewall.conf(5</b>[6]), that snapshot is listed as the <u>default</u> snapshot for
               the <b>restore</b> command.

           <b>tc</b>
               Displays information about queuing disciplines, classes and filters.

           <b>zones</b>
               Displays the current composition of the Shorewall zones on the system.

       <b>start</b>  [-<b>n</b>] [-<b>p</b>] [-<b>d</b>] [-<b>f</b>] [-<b>c</b>] [-<b>T</b>] [-<b>i</b>] [-<b>C</b>] [-D] [ <u>directory</u> ]

           Shorewall and Shorewall6
               Start shorewall[6]. Existing connections through shorewall managed interfaces are untouched. New
               connections will be allowed only if they are allowed by the firewall rules or policies. If a
               <u>directory</u> is included in the command, Shorewall will look in that <u>directory</u> first for
               configuration files. If <b>-f</b> is specified, the saved configuration specified by the RESTOREFILE
               option in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)) will be restored if that saved
               configuration exists and has been modified more recently than the files in /etc/shorewall. When
               <b>-f</b> is given, a <u>directory</u> may not be specified.

               Update: In Shorewall 4.4.20, a new LEGACY_FASTSTART option was added to <b>shorewall.conf</b>[1](5)
               (<b>shorewall6.conf</b>[1](5)). When LEGACY_FASTSTART=No, the modification times of files in
               /etc/shorewall are compared with that of /var/lib/shorewall/firewall (the compiled script that
               last started/restarted the firewall).

               The <b>-n</b> option causes Shorewall to avoid updating the routing table(s).

               The <b>-p</b> option causes the connection tracking table to be flushed; the <b>conntrack</b> utility must be
               installed to use this option.

               The <b>-c</b> option was added in Shorewall 4.4.20 and performs the compilation step unconditionally,
               overriding the AUTOMAKE setting in <b>shorewall.conf</b>[1](5) (<b>shorewall6.conf</b>[1](5)). When both <b>-f</b> and
               <b>-c</b>are present, the result is determined by the option that appears last.

               The <b>-T</b> option was added in Shorewall 4.5.3 and causes a Perl stack trace to be included with each
               compiler-generated error and warning message.

               The -i option was added in Shorewall 4.6.0 and causes a warning message to be issued if the
               current line contains alternative input specifications following a semicolon (";"). Such lines
               will be handled incorrectly if INLINE_MATCHES is set to Yes in <b><a href="../man5/shorewall.conf.5.html">shorewall.conf</a>(5)</b>[1]
               (<b>shorewall6.conf</b>[1](5)).

               The <b>-C</b> option was added in Shorewall 4.6.5 and is only meaningful when the <b>-f</b> option is also
               specified. If the previously-saved configuration is restored, and if the <b>-C</b> option was also
               specified in the <b>save</b> command, then the packet and byte counters will be restored.

               The <b>-D</b> option was added in Shoewall 5.2.4 and causes the compiler to write a large amount of
               debugging information to standard output.

           Shorewall-lite and Shorewall6-lite
               Start Shorewall[6] Lite. Existing connections through shorewall[6]-lite managed interfaces are
               untouched. New connections will be allowed only if they are allowed by the firewall rules or
               policies.

               The <b>-p</b> option causes the connection tracking table to be flushed; the <b>conntrack</b> utility must be
               installed to use this option.

               The <b>-n</b> option prevents the firewall script from modifying the current routing configuration.

               The <b>-f</b> option was added in Shorewall 4.6.5. If the RESTOREFILE named in <b>shorewall.conf</b>[6](5)
               exists, is executable and is not older than the current filewall script, then that saved
               configuration is restored.

               The <b>-C</b> option was added in Shorewall 4.6.5 and is only meaningful when the <b>-f</b> option is also
               specified. If the previously-saved configuration is restored, and if the <b>-C</b> option was also
               specified in the <b>save</b> command, then the packet and byte counters will be restored.

       <b>stop</b>
           Stops the firewall. All existing connections, except those listed in <b>shorewall-stoppedrules</b>[8](5) or
           permitted by the ADMINISABSENTMINDED option in <b>shorewall.conf</b>[1], are taken down. The only new
           traffic permitted through the firewall is from systems listed in <b>shorewall-stoppedrules</b>[8](5) or by
           ADMINISABSENTMINDED.

       <b>status</b> [-<b>i</b>]
           Produces a short report about the state of the Shorewall-configured firewall.

           The <b>-i</b> option was added in Shorewall 4.6.2 and causes the status of each optional or provider
           interface to be displayed.

       <b>try</b> <u>directory</u> [ <u>timeout</u> ]
           This command is available in Shorewall and Shorewall6 only.

           If Shorewall[6] is started then the firewall state is saved to a temporary saved configuration
           (/var/lib/shorewall/.try). Next, if Shorewall[6] is currently started then a <b>restart</b> command is
           issued using the specified configuration <u>directory</u>; otherwise, a <b>start</b> command is performed using the
           specified configuration <u>directory</u>. if an error occurs during the compilation phase of the <b>restart</b> or
           <b>start</b>, the command terminates without changing the Shorewall[6] state. If an error occurs during the
           <b>restart</b> phase, then a <b>shorewall</b> <b>restore</b> is performed using the saved configuration. If an error
           occurs during the <b>start</b> phase, then Shorewall is cleared. If the <b>start</b>/<b>restart</b> succeeds and a <u>timeout</u>
           is specified then a <b>clear</b> or <b>restore</b> is performed after <u>timeout</u> seconds.

           Beginning with Shorewall 4.5.0, the numeric <u>timeout</u> may optionally be followed by an <b>s</b>, <b>m</b> or <b>h</b> suffix
           (e.g., 5m) to specify seconds, minutes or hours respectively. If the suffix is omitted, seconds is
           assumed.

       <b>update</b>  [-<b>d</b>] [-<b>r</b>] [-<b>T</b>] [-<b>a</b>] [-<b>i</b>] [-<b>A</b>] [ <u>directory</u> ]
           This command is available only in Shorewall and Shorewall6.

           Added in Shorewall 4.4.21 and causes the compiler to update /etc/shorewall/shorewall.conf then
           validate the configuration. The update will add options not present in the old file with their
           default values, and will move deprecated options with non-defaults to a deprecated options section at
           the bottom of the file. Your existing shorewall.conf file is renamed shorewall.conf.bak.

           The command was extended over the years with a set of options that caused additional configuration
           updates.

           •   Convert an existing blacklist file into an equivalent blrules file.

           •   Convert an existing routestopped file into an equivalent stoppedrules file.

           •   Convert existing tcrules and tos files into an equivalent mangle file.

           •   Convert an existing notrack file into an equivalent conntrack file.

           •   Convert FORMAT, SECTION and COMMENT entries into ?FORMAT, ?SECTION and ?COMMENT directives.

           In each case, the old file is renamed with a .bak suffix.

           In Shorewall 5.0.0, the options were eliminated and the <b>update</b> command performs all of the updates
           described above.

               <b>Important</b>
               There are some notable restrictions with the <b>update</b> command:

                1. Converted rules will be appended to the existing file; if there is no existing file in the
                   CONFIG_PATH, one will be created in the directory specified in the command or in the first
                   entry in the CONFIG_PATH (normally /etc/shorewall) otherwise.

                2. Existing comments in the file being converted will not be transferred to the output file.

                3. With the exception of the notrack-&gt;conntrack conversion, INCLUDEd files will be expanded
                   inline in the output file.

                4. Columns in the output file will be separated by a single tab character; there is no attempt
                   made to otherwise align the columns.

                5. Prior to Shorewall 5.0.15, shell variables will be expanded in the output file.

                6. Prior to Shorewall 5.0.15, lines omitted by compiler directives (?if ...., etc.) will not
                   appear in the output file.

                       <b>Important</b>
                       Because the translation of the 'blacklist' and 'routestopped' files is not 1:1, omitted
                       lines and compiler directives are not transferred to the converted files. If either are
                       present, the compiler issues a warning:

                            WARNING: "Omitted rules and compiler directives were not translated
           The <b>-a</b> option causes the updated shorewall.conf file to be annotated with documentation.

           The <b>-i</b> option was added in Shorewall 4.6.0 and causes a warning message to be issued if the current
           line contains alternative input specifications following a semicolon (";"). Such lines will be
           handled incorrectly if INLINE_MATCHES is set to Yes in <b>shorewall.conf</b>[1](5).

           The <b>-A</b> option is included for compatibility with Shorewall 4.6 and is equivalent to specifying the <b>-i</b>
           option.

           For a description of the other options, see the <b>check</b> command above.

       <b>version</b> [-<b>a</b>]
           Displays Shorewall's version. The <b>-a</b> option is included for compatibility with earlier Shorewall
           releases and is ignored.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       In general, when a command succeeds, status 0 is returned; when the command fails, a non-zero status is
       returned.

       The <b>status</b> command returns exit status as follows:

       0 - Firewall is started.

       3 - Firewall is stopped or cleared

       4 - Unknown state; usually means that the firewall has never been started.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       Two environmental variables are recognized by Shorewall:

       SHOREWALL_INIT_SCRIPT
           When set to 1, causes Std out to be redirected to the file specified in the STARTUP_LOG option in
           <b><a href="../man5/shorewall.conf.5.html">shorewall.conf</a>(5)</b>[6].

       SW_LOGGERTAG
           Added in Shorewall 5.0.8. When set to a non-empty value, that value is passed to the logger utility
           in its -t (--tag) option.

</pre><h4><b>FILES</b></h4><pre>
       /etc/shorewall/*

       /etc/shorewall6/*

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
           <b>https://shorewall.org/starting_and_stopping_shorewall.htm</b>[9]
                 - Describes operational aspects of Shorewall.
           <b><a href="../man5/shorewall-files.5.html">shorewall-files</a>(5)</b>[10] -
                 Describes the various configuration files along with features and
                 conventions common to those files.
           <b><a href="../man5/shorewall-names.5.html">shorewall-names</a>(5)</b>[11] -
                 Describes naming of objects within a Shorewall configuration.
           <b><a href="../man5/shorewall-addresses.5.html">shorewall-addresses</a>(5)</b>[12] -
                 Describes how to specify addresses within a Shorewall
                 configuration.
           <b><a href="../man5/shorewall-exclusion.5.html">shorewall-exclusion</a>(5)</b>[13] -
                 Describes how to exclude certain hosts and/or networks from matching a
                 rule.
           <b><a href="../man5/shorewall-nesting.5.html">shorewall-nesting</a>(5)</b>[14]
                 - Describes how to nest one Shorewall zone inside another.

</pre><h4><b>NOTES</b></h4><pre>
        1. shorewall.conf
           https://shorewall.org/manpages//manpages/shorewall.conf.html

        2. shorewall-interfaces
           https://shorewall.org/manpages//manpages/shorewall-interfaces.html

        3. shorewall-zones
           https://shorewall.org/manpages//manpages/shorewall-zones.html

        4. shorewall-routes
           https://shorewall.org/manpages//manpages/shorewall-routes.html

        5. logging backend
           https://shorewall.org/manpages//shorewall_logging.html#Backends

        6. shorewall.conf
           https://shorewall.org/manpages/shorewall.conf.html

        7. shorewall-accounting
           https://shorewall.org/manpages//manpages/shorewall-accounting.html

        8. shorewall-stoppedrules
           https://shorewall.org/manpages//manpages/shorewall-stoppedrules.html

        9. https://shorewall.org/starting_and_stopping_shorewall.htm
           https://shorewall.org/manpages//starting_and_stopping_shorewall.htm

       10. <a href="../man5/shorewall-files.5.html">shorewall-files</a>(5)
           https://shorewall.org/manpages/shorewall-files.html

       11. <a href="../man5/shorewall-names.5.html">shorewall-names</a>(5)
           https://shorewall.org/manpages/shorewall-names.html

       12. <a href="../man5/shorewall-addresses.5.html">shorewall-addresses</a>(5)
           https://shorewall.org/manpages/shorewall-addresses.html

       13. <a href="../man5/shorewall-exclusion.5.html">shorewall-exclusion</a>(5)
           https://shorewall.org/manpages/shorewall-exclusion.html

       14. <a href="../man5/shorewall-nesting.5.html">shorewall-nesting</a>(5)
           https://shorewall.org/manpages/shorewall-nesting.html

Administrative Commands                            09/24/2020                                       <u><a href="../man8/SHOREWALL.8.html">SHOREWALL</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>