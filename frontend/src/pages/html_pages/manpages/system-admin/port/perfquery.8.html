<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>perfquery - query InfiniBand port counters on a single port</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/infiniband-diags">infiniband-diags_56.1-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       perfquery - query InfiniBand port counters on a single port

</pre><h4><b>SYNOPSIS</b></h4><pre>
       perfquery [options] [&lt;lid|guid&gt; [[port(s)] [reset_mask]]]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       perfquery  uses  PerfMgt  GMPs  to  obtain  the  PortCounters  (basic  performance  and  error counters),
       PortExtendedCounters,   PortXmitDataSL,   PortRcvDataSL,   PortRcvErrorDetails,   PortXmitDiscardDetails,
       PortExtendedSpeedsCounters,  or  PortSamplesControl  from  the PMA at the node/port specified. Optionally
       shows aggregated counters for all ports of node.  Finally it can, reset after read,  or  just  reset  the
       counters.

       Note: In PortCounters, PortCountersExtended, PortXmitDataSL, and PortRcvDataSL, components that represent
       Data (e.g. PortXmitData and PortRcvData) indicate octets divided by 4 rather than just octets.

       Note: Inputting a port of 255 indicates an operation be performed on all ports.

       Note:  For  PortCounters, ExtendedCounters, and resets, multiple ports can be specified by either a comma
       separated list or a port range.  See examples below.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-x,</b> <b>--extended</b>
              show extended port counters rather than (basic) port counters.  Note that extended  port  counters
              attribute is optional.

       <b>-X,</b> <b>--xmtsl</b>
              show transmit data SL counter. This is an optional counter for QoS.

       <b>-S,</b> <b>--rcvsl</b>
              show receive data SL counter. This is an optional counter for QoS.

       <b>-D,</b> <b>--xmtdisc</b>
              show transmit discard details. This is an optional counter.

       <b>-E,</b> <b>--rcverr</b>
              show receive error details. This is an optional counter.

       <b>-D,</b> <b>--xmtdisc</b>
              show transmit discard details. This is an optional counter.

       <b>-T,</b> <b>--extended_speeds</b>
              show extended speeds port counters. This is an optional counter.

       <b>--oprcvcounters</b>
              show Rcv Counters per Op code. This is an optional counter.

       <b>--flowctlcounters</b>
              show flow control counters. This is an optional counter.

       <b>--vloppackets</b>
              show packets received per Op code per VL. This is an optional counter.

       <b>--vlopdata</b>
              show data received per Op code per VL. This is an optional counter.

       <b>--vlxmitflowctlerrors</b>
              show flow control update errors per VL. This is an optional counter.

       <b>--vlxmitcounters</b>
              show ticks waiting to transmit counters per VL. This is an optional counter.

       <b>--swportvlcong</b>
              show sw port VL congestion. This is an optional counter.

       <b>--rcvcc</b>
              show Rcv congestion control counters. This is an optional counter.

       <b>--slrcvfecn</b>
              show SL Rcv FECN counters. This is an optional counter.

       <b>--slrcvbecn</b>
              show SL Rcv BECN counters. This is an optional counter.

       <b>--xmitcc</b>
              show Xmit congestion control counters. This is an optional counter.

       <b>--vlxmittimecc</b>
              show VL Xmit Time congestion control counters. This is an optional counter.

       <b>-c,</b> <b>--smplctl</b>
              show port samples control.

       <b>-a,</b> <b>--all_ports</b>
              show  aggregated  counters for all ports of the destination lid, reset all counters for all ports,
              or if multiple ports are specified, aggregate  the  counters  of  the  specified  ports.   If  the
              destination  lid  does  not  support the AllPortSelect flag, all ports will be iterated through to
              emulate AllPortSelect behavior.

       <b>-l,</b> <b>--loop_ports</b>
              If all ports are selected by the user (either through the <b>-a</b> option or port 255) or multiple ports
              are specified iterate through each port rather than doing than aggregate operation.

       <b>-r,</b> <b>--reset_after_read</b>
              reset counters after read

       <b>-R,</b> <b>--Reset_only</b>
              only reset counters

   <b>Addressing</b> <b>Flags</b>
       <b>-G,</b> <b>--Guid</b>     The address specified is a Port GUID

       <b>-L,</b> <b>--Lid</b>   The address specified is a LID

       <b>-s,</b> <b>--sm_port</b> <b>&lt;smlid&gt;</b>     use 'smlid' as the target lid for SA queries.

   <b>Port</b> <b>Selection</b> <b>flags</b>
       <b>-C,</b> <b>--Ca</b> <b>&lt;ca_name&gt;</b>    use the specified ca_name.

       <b>-P,</b> <b>--Port</b> <b>&lt;ca_port&gt;</b>    use the specified ca_port.

   <b>Local</b> <b>port</b> <b>Selection</b>
       Multiple port/Multiple CA support: when  no  IB  device  or  port  is  specified  (see  the  "local  umad
       parameters" below), the libibumad library selects the port to use by the following criteria:

          1. the first port that is ACTIVE.

          2. if not found, the first port that is UP (physical link up).

          If a port and/or CA name is specified, the libibumad library attempts to fulfill the user request, and
          will fail if it is not possible.

          For example:

              ibaddr                 # use the first port (criteria #1 above)
              ibaddr -C mthca1       # pick the best port from "mthca1" only.
              ibaddr -P 2            # use the second (active/up) port from the first available IB device.
              ibaddr -C mthca0 -P 2  # use the specified port only.

   <b>Debugging</b> <b>flags</b>
       <b>-d</b>     raise the IB debugging level.  May be used several times (-ddd or -d -d -d).

       <b>-e</b>     show send and receive errors (timeouts and others)

       <b>-h,</b> <b>--help</b>      show the usage message

       <b>-v,</b> <b>--verbose</b>
              increase the application verbosity level.  May be used several times (-vv or -v -v -v)

       <b>-V,</b> <b>--version</b>     show the version info.

   <b>Configuration</b> <b>flags</b>
       <b>-t,</b> <b>--timeout</b> <b>&lt;timeout_ms&gt;</b> override the default timeout for the solicited mads.

       <b>-y,</b> <b>--m_key</b> <b>&lt;key&gt;</b>
              use  the  specified  M_key for requests. If non-numeric value (like 'x') is specified then a value
              will be prompted for.

       <b>--config,</b> <b>-z</b>  <b>&lt;config_file&gt;</b> Specify alternate config file.
          Default: /etc/infiniband-diags/ibdiag.conf

</pre><h4><b>FILES</b></h4><pre>
   <b>CONFIG</b> <b>FILE</b>
       /etc/infiniband-diags/ibdiag.conf

       A global config file is provided to set some of the common options for all tools.   See  supplied  config
       file for details.

</pre><h4><b>EXAMPLES</b></h4><pre>
          perfquery                # read local port performance counters
          perfquery 32 1           # read performance counters from lid 32, port 1
          perfquery -x 32 1        # read extended performance counters from lid 32, port 1
          perfquery -a 32          # read perf counters from lid 32, all ports
          perfquery -r 32 1        # read performance counters and reset
          perfquery -x -r 32 1     # read extended performance counters and reset
          perfquery -R 0x20 1      # reset performance counters of port 1 only
          perfquery -x -R 0x20 1   # reset extended performance counters of port 1 only
          perfquery -R -a 32       # reset performance counters of all ports
          perfquery -R 32 2 0x0fff # reset only error counters of port 2
          perfquery -R 32 2 0xf000 # reset only non-error counters of port 2
          perfquery -a 32 1-10     # read performance counters from lid 32, port 1-10, aggregate output
          perfquery -l 32 1-10     # read performance counters from lid 32, port 1-10, output each port
          perfquery -a 32 1,4,8    # read performance counters from lid 32, port 1, 4, and 8, aggregate output
          perfquery -l 32 1,4,8    # read performance counters from lid 32, port 1, 4, and 8, output each port

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>Hal</b> <b>Rosenstock</b>
              &lt;  &lt;<a href="mailto:hal.rosenstock@gmail.com">hal.rosenstock@gmail.com</a>&gt;  &gt;

                                                   2017-08-21                                       <u><a href="../man8/PERFQUERY.8.html">PERFQUERY</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>