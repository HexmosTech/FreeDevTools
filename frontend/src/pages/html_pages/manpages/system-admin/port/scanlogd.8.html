<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>scanlogd - detects and logs TCP port scans</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/scanlogd">scanlogd_2.2.8-0.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       scanlogd - detects and logs TCP port scans

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>scanlogd</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>scanlogd</b>  detects  port  scans  and  writes  one  line per scan via the <b><a href="../man3/syslog.3.html">syslog</a></b>(3) mechanism.  If a source
       address sends multiple packets to different ports in a short time, the event will be logged.  The  format
       of the messages is:

       <b>saddr</b>[:<b>sport</b>] to <b>daddr</b> [and others,] ports <b>port</b>[, <b>port</b>...], ..., <b>flags</b>[, TOS <b>TOS</b>][, TTL <b>TTL</b>] @<b>HH:MM:SS</b>

       The  fields  in  square  brackets  are  optional; <b>sport</b>, <b>TOS</b>, and <b>TTL</b> will only be displayed if they were
       constant during the scan.

       The <b>flags</b> field represents TCP control bits seen in packets coming to the system from the address of  the
       scan.  It is a combination of eight characters, with each corresponding to one of the six defined and two
       reserved TCP control bits (see RFC 793).  Control bits that were always set are encoded with an uppercase
       letter,  and a lowercase letter is used if the bit was always clear.  A question mark is used to indicate
       bits that changed from packet to packet.

</pre><h4><b>INTERFACES</b></h4><pre>
       In order to do its job, <b>scanlogd</b> needs a way to obtain raw IP packets that  either  come  to  the  system
       <b>scanlogd</b>  is  running  on,  or  travel across a network segment that is directly connected to the system.
       Current versions of <b>scanlogd</b> can be built with support for one of several packet capture interfaces.

       <b>scanlogd</b> is aware of the <b>raw</b> <b>socket</b> interface on Linux, <b>libnids</b>, and <b>libpcap</b>.

       The use of <b>libpcap</b> alone is discouraged.  If you're on a system other than Linux and/or want  to  monitor
       the  traffic  of  an entire network at once, you should be using <b>libnids</b> in order to handle fragmented IP
       packets.

</pre><h4><b>COMPILE-TIME</b> <b>DEFAULTS</b></h4><pre>
       At least 7 different privileged or 21 non-privileged ports, or a weighted combination of those,  have  to
       be  accessed  with no longer than 3 seconds between the accesses to be treated as a scan.  If more than 5
       scans are detected within 20 seconds, that event will be logged and logging will be stopped temporarily.

       Logging is done with a facility of <b>daemon</b> and a priority level <b>alert</b>.

       <b>scanlogd</b> should be started as root since it needs access to a packet capture interface.  By  default,  it
       chroots  to  <u>/var/empty</u>  and  switches  to running as user <b>scanlogd</b> after the packet capture interface is
       initialized.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       If the daemon couldn't start up successfully, it will exit with a status of 1.

</pre><h4><b>USAGE</b></h4><pre>
       You're expected to create a dummy user for <b>scanlogd</b> to run as.  Make sure you allocate unique UID and GID
       to the user.

       In most cases, <b>scanlogd</b> should be started from a rc.d script on system startup.

       In /etc/syslog.conf you may use something like:

       daemon.alert   /var/log/alert

</pre><h4><b>SECURITY</b> <b>NOTES</b></h4><pre>
       As the name indicates, <b>scanlogd</b> only logs port scans.  <b>It</b> <b>does</b> <b>not</b> <b>prevent</b> <b>them.</b>  You will  only  receive
       summarized information in the system's log.

       Obviously,  the source address of port scans can be spoofed.  <b>Don't</b> <b>take</b> <b>any</b> <b>action</b> <b>against</b> <b>the</b> <b>source</b> <b>of</b>
       <b>attacks</b> <b>unless</b> <b>other</b> <b>evidence</b> <b>is</b> <b>available.</b>  Sometimes IP addresses are shared between many people;  this
       is   the  case  for  ISP  shell  servers,  dynamic  dialup  pools,  and  corporate  networks  behind  NAT
       (masquerading).

</pre><h4><b>BUGS</b></h4><pre>
       Due to the nature of port scans, both false positives (detecting a scan when there isn't one)  and  false
       negatives  (not  detecting  a  scan when there's one) are possible.  In particular, false positives occur
       when many small files are transferred rapidly with passive mode FTP.

</pre><h4><b>AUTHORS</b></h4><pre>
       Solar Designer &lt;solar at openwall.com&gt;
       Steffen Dettmer &lt;steffen at dett.de&gt; wrote the initial version of this manual page.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/syslog.3.html">syslog</a></b>(3), <b><a href="../man5/syslog.conf.5.html">syslog.conf</a></b>(5), <b><a href="../man3/libnids.3.html">libnids</a></b>(3), <b><a href="../man3/pcap.3.html">pcap</a></b>(3)
       <b>scanlogd</b> home page: <a href="http://www.openwall.com/scanlogd/">http://www.openwall.com/scanlogd/</a>
       <b>Phrack</b> <b>Magazine</b>, issue 53, article 13

Openwall Project                                   2 June 2004                                       <u><a href="../man8/SCANLOGD.8.html">SCANLOGD</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>