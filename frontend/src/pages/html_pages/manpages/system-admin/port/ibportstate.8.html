<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IBPORTSTATE - handle port (physical) state and link speed of an InfiniBand port</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/infiniband-diags">infiniband-diags_56.1-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       IBPORTSTATE - handle port (physical) state and link speed of an InfiniBand port

</pre><h4><b>SYNOPSIS</b></h4><pre>
       ibportstate [options] &lt;dest dr_path|lid|guid&gt; &lt;portnum&gt; [&lt;op&gt;]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       ibportstate  allows  the  port  state and port physical state of an IB port to be queried (in addition to
       link width and speed being validated relative to the peer port when the port queried is a  switch  port),
       or  a  switch  port  to  be disabled, enabled, or reset. InfiniBand HCA port state may be changed locally
       without the knowledge of the Subnet Manager.  It also allows the link speed/width enabled on any IB  port
       to be adjusted.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>&lt;op&gt;</b>

              <b>Supported</b> <b>ops:</b> <b>enable,</b> <b>disable,</b> <b>reset,</b> <b>speed,</b> <b>espeed,</b> <b>fdr10,</b> <b>width,</b> <b>query,</b>
                     on,  off,  down, arm, active, vls, mtu, lid, smlid, lmc, mkey, mkeylease, mkeyprot (Default
                     is query)

              <b>enable,</b> <b>disable,</b> <b>and</b> <b>reset</b> change or reset a switch or HCA port state (You  must  specify  the  CA
              name and Port number when locally change CA port state.)

              <b>off</b> change the port state to disable.

              <b>on</b> change the port state to enable(only when the current state is disable).

              <b>speed</b> <b>and</b> <b>width</b> are allowed on any port

              <b>speed</b>  values  are  the  legal  values  for  PortInfo:LinkSpeedEnabled  (An  error is indicated if
              PortInfo:LinkSpeedSupported does not support this setting)

              <b>espeed</b> is allowed on any port supporting extended link speeds

              <b>fdr10</b> is allowed on any port supporting fdr10 (An error is indicated  if  port's  capability  mask
              indicates  extended  link  speeds  are not supported or if PortInfo:LinkSpeedExtSupported does not
              support this setting)

              <b>width</b>  values  are  legal  values  for  PortInfo:LinkWidthEnabled  (An  error  is   indicated   if
              PortInfo:LinkWidthSupported  does not support this setting) (NOTE: Speed and width changes are not
              effected until the port goes through link renegotiation)

              <b>query</b> also validates port characteristics (link width, speed, espeed, and fdr10) based on the peer
              port. This checking is done when the port queried is a  switch  port  as  it  relies  on  combined
              routing  (an  initial  LID  route  with  directed routing to the peer) which can only be done on a
              switch. This peer port validation feature of query op requires LID routing to  be  functioning  in
              the subnet.

              <b>mkey,</b>  <b>mkeylease,</b>  <b>and</b>  <b>mkeyprot</b>  are  only allowed on CAs, routers, or switch port 0 (An error is
              generated if attempted on external switch ports).  Hexadecimal and octal mkeys may be specified by
              prepending the key with '0x' or '0', respectively.  If a non-numeric value (like 'x') is specified
              for the mkey, then ibportstate will prompt for a value.

   <b>Addressing</b> <b>Flags</b>
       <b>-L,</b> <b>--Lid</b>   The address specified is a LID

       <b>-G,</b> <b>--Guid</b>     The address specified is a Port GUID

       <b>-D,</b> <b>--Direct</b>     The address specified is a directed route

          Examples:
             [options] -D [options] "0"          # self port
             [options] -D [options] "0,1,2,1,4"  # out via port 1, then 2, ...

             (Note the second number in the path specified must match the port being
             used.  This can be specified using the port selection flag '-P' or the
             port found through the automatic selection process.)

       <b>-s,</b> <b>--sm_port</b> <b>&lt;smlid&gt;</b>     use 'smlid' as the target lid for SA queries.

   <b>Port</b> <b>Selection</b> <b>flags</b>
       <b>-C,</b> <b>--Ca</b> <b>&lt;ca_name&gt;</b>    use the specified ca_name.

       <b>-P,</b> <b>--Port</b> <b>&lt;ca_port&gt;</b>    use the specified ca_port.

   <b>Local</b> <b>port</b> <b>Selection</b>
       Multiple port/Multiple CA support: when  no  IB  device  or  port  is  specified  (see  the  "local  umad
       parameters" below), the libibumad library selects the port to use by the following criteria:

          1. the first port that is ACTIVE.

          2. if not found, the first port that is UP (physical link up).

          If a port and/or CA name is specified, the libibumad library attempts to fulfill the user request, and
          will fail if it is not possible.

          For example:

              ibaddr                 # use the first port (criteria #1 above)
              ibaddr -C mthca1       # pick the best port from "mthca1" only.
              ibaddr -P 2            # use the second (active/up) port from the first available IB device.
              ibaddr -C mthca0 -P 2  # use the specified port only.

   <b>Configuration</b> <b>flags</b>
       <b>--config,</b> <b>-z</b>  <b>&lt;config_file&gt;</b> Specify alternate config file.
          Default: /etc/infiniband-diags/ibdiag.conf

       <b>-t,</b> <b>--timeout</b> <b>&lt;timeout_ms&gt;</b> override the default timeout for the solicited mads.

       <b>-y,</b> <b>--m_key</b> <b>&lt;key&gt;</b>
              use  the  specified  M_key for requests. If non-numeric value (like 'x') is specified then a value
              will be prompted for.

   <b>Debugging</b> <b>flags</b>
       <b>-h,</b> <b>--help</b>      show the usage message

       <b>-d</b>     raise the IB debugging level.  May be used several times (-ddd or -d -d -d).

       <b>-e</b>     show send and receive errors (timeouts and others)

       <b>-K,</b> <b>--show_keys</b>
              show security keys (mkey, smkey, etc.) associated with the request.

       <b>-v,</b> <b>--verbose</b>
              increase the application verbosity level.  May be used several times (-vv or -v -v -v)

       <b>-V,</b> <b>--version</b>     show the version info.

</pre><h4><b>FILES</b></h4><pre>
   <b>CONFIG</b> <b>FILE</b>
       /etc/infiniband-diags/ibdiag.conf

       A global config file is provided to set some of the common options for all tools.   See  supplied  config
       file for details.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>::</b>     ibportstate  -C  qib0 -P 1 3 1 disable     # by CA name, CA Port Number, lid, physical port number
              ibportstate -C qib0 -P 1 3 1 enable      # by CA name, CA Port Number, lid, physical  port  number
              ibportstate  -D  0  1                        #  (query)  by  direct  route  ibportstate  3 1 reset
              #  by  lid  ibportstate  3  1  speed  1                   #  by  lid  ibportstate  3  1  width   1
              # by lid ibportstate -D 0 1 lid 0x1234 arm        # by direct route

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>Hal</b> <b>Rosenstock</b>
              &lt;  &lt;<a href="mailto:hal.rosenstock@gmail.com">hal.rosenstock@gmail.com</a>&gt;  &gt;

                                                   2013-03-26                                     <u><a href="../man8/IBPORTSTATE.8.html">IBPORTSTATE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>