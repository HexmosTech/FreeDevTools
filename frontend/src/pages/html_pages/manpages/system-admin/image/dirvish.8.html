<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dirvish - Disk based virtual image network backup system</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/dirvish">dirvish_1.2.1-2.1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dirvish - Disk based virtual image network backup system

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>dirvish</b> <b>--vault</b> <u>vault</u> [ <u>OPTIONS</u> ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Create a backup image of a client directory tree.

       Each  image is a directory containing transfer <b>log,</b> <b>summary,</b> <b>tree</b> and if transfer errors were detected an
       <b>rsync_error</b> file.  The transfer <b>log</b> retains the the output of any pre and post  processing  commands  and
       the  rsync  log  listing  all  files  that  were changed or added with some statistical information.  The
       <b>summary</b> file contains all the information about how the image was created and meta-data for managing  the
       image in config file format.  Tree is the copy of the client tree.

       The  client directory tree is compared with an existing image to create a new image.  Unchanged files are
       shared between images.  For changed files only those parts that actually change are transfered  over  the
       network.  Unchanged portions of files are copied from the reference image.

       The  resulting  images  contain  complete  copies  of  the  original  trees preserving ownership and file
       permissions.  In this way even though the  backups  are  made  incrementally,  each  image  can  be  used
       independently for restores or to make removable-media off-site copies or archives.

       The removal of an image will have no effect on other images.

</pre><h4><b>OPTIONS</b></h4><pre>
       Each  option  on the command line may be specified any number of times.  Those options that support lists
       in the config files will accumulate all of their arguments otherwise each specification will override the
       ones before.

       As configuration files are loaded they may override options on the command line.

       Each option may be unambiguously abbreviated.

       <b>--branch</b> [<u>vault:</u>]<u>branch_name</u>
              Specify a branch to use.

              A branch is a sequence of images.

              If a vault has been specified either here or with <b>--vault</b> the first time this option  is  used  it
              will attempt to load the config file <u>branch_name</u> or <u>branch_name</u><b>.conf</b> from the vault.

       <b>--config</b> <u>config-file</u>
              Load options from the specified file.

              If this precedes <b>--vault</b> the <b>--vault</b> option will not load it's own config file.

              If  vault  has  been  set and <u>config-file</u> is a bare filename the presence of one in the vault will
              take precedence over one in the current directory.  To specify one in the current directory  after
              <b>--vault</b> use <b>./</b> to precede the name.

              The master configuration file will be read prior to processing options.

       <b>--expire</b> <u>expire_date</u>
              Specify a time for the image to expire.

              See <b>Time::<a href="../man3pm/ParseDate.3pm.html">ParseDate</a>(3pm)</b> for details.

              This  does  not  actually  expire  anything.  What it does do is add an <b>Expire:</b> field to the image
              summary file containing an absolute time so that a  <b>dirvish-expire</b>  or  another  tool  outside  of
              dirvish can decide when to remove old images.

       <b>--image</b> <u>image_name</u>
              Specify a name for the image.

              <u>image_name</u> is passed through <b>POSIX::strftime</b>

              See <b><a href="../man3/strftime.3.html">strftime</a>(3)</b> for details.

       <b>--image-time</b> <u>parsedate_expression</u>
              Time to use when creating the image name.

              If an absolute time without a date is provided it will be forced into the past.  If this isn't set
              the current time will be used.

              See <b>Time::<a href="../man3pm/ParseDate.3pm.html">ParseDate</a>(3pm)</b> for details.

       <b>--init</b> Create an initial image.

              Create the image entirely from the source tree without the use of a reference image.

       <b>--no-run</b>

       <b>--dry-run</b>
              Don't actually do anything.

              Process  all  configuration  files, options and tests then produce a summary/configuration file on
              standard output and exit.

       <b>--reference</b> <u>branch_name</u>|<u>image_name</u>
              Specify an existing image or a branch from which to create the new image.

              If a branch_name is specified, the last existing image from its history  file  will  be  used.   A
              branch will take precedence over an image of the same name.

       <b>--reset</b> <u>option</u>
              Reset the values in an accumulating <u>option</u>.

       <b>--summary</b>  <b>short</b>|<b>long</b>
              Specify summary format.

              A  short  summary  will  only  include  final  used  values.   A  long  summary  will  include all
              configuration values.

              Default value: <b>short</b>

       <b>--vault</b> <u>vault</u>[<u>:branch_name</u>]
              Specify the vault to store the image in.

              If not preceeded by <b>--config</b> this will attempt to load the config  file  <b>default</b>  or  <b>default.conf</b>
              within the <u>vault</u>.

              If <u>branch_name</u> is specified here this will behave exactly like the <b>--branch</b> option and <u>branch_name</u>
              or <u>branch_name</u>.conf will be attempted instead of <b>default.conf</b>.

       <b>--version</b>
              Print version string and exit.

</pre><h4><b>EXIT</b> <b>CODES</b></h4><pre>
       To  facilitate  further  automation  and  integration  of  <b>dirvish</b>  with  other  tools  <b>dirvish</b>  provides
       rationalised exit codes.  The exit codes are range based.  While the code for a specific error may change
       from one version to another it will remain within the specified range.  So don't test for  specific  exit
       codes  but  instead test for a range of values.  To the degree possible higher value ranges indicate more
       severe errors.

       0      success

       1-19   The backup job reported warnings.

       20-39  An error occurred during index generation and cleanup.

       40-49  A post-client or post-server command could not be run.

       50-59  The post-client command reported an error.  Its exit code modulo 10 is added to 50

       60-69  The post-server command reported an error.  Its exit code modulo 10 is added to 60

       70-79  A post-client or post-server command could not be run.

       80-89  The pre-server command reported an error.  Its exit code modulo 10 is added to 80

       90-99  The pre-server command reported an error.  Its exit code modulo 10 is added to 90

       100-149
              Rsync encountered a non-fatal error.

       150-199
              Rsync encountered a fatal error.

       200-219
              An error was encountered in loading a configuration file.

       220-254
              An error was detected in the configuration.

       255    Incorrect usage.

</pre><h4><b>FILES</b></h4><pre>
       <b>/etc/dirvish/master.conf</b>
              alternate master configuration file.

       <b>/etc/dirvish.conf</b>
              master configuration file.

       <b>/etc/dirvish/</b><u>client</u><b>[.conf]</b>
              client configuration file.

       <u>bank/vault/</u><b>dirvish/default[.conf]</b>
              default vault configuration file.

       <u>bank/vault/</u><b>dirvish</b><u>/branch</u><b>[.conf]</b>
              branch configuration file.

       <u>bank/vault/</u><b>dirvish</b><u>/branch</u><b>.hist</b>
              branch history file.

       <u>bank/vault/image/</u><b>summary</b>
              image creation summary.

       <u>bank/vault/image/</u><b>log</b>
              image creation log.

       <u>bank/vault/image/</u><b>tree</b>
              actual image of source directory tree.

       <u>bank/vault/image/</u><b>rsync_error</b>
              Error output from rsync if errors or warnings were detected.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man5/dirvish.conf.5.html">dirvish.conf</a>(5)
       <a href="../man8/dirvish-runall.8.html">dirvish-runall</a>(8)
       <a href="../man8/dirvish-expire.8.html">dirvish-expire</a>(8)
       <a href="../man8/dirvish-locate.8.html">dirvish-locate</a>(8)
       <a href="../man1/ssh.1.html">ssh</a>(1)
       <a href="../man1/rsync.1.html">rsync</a>(1)
       Time::<a href="../man3pm/ParseDate.3pm.html">ParseDate</a>(3pm)
       <a href="../man3/strftime.3.html">strftime</a>(3)

</pre><h4><b>AUTHOR</b></h4><pre>
       Dirvish was created by J.W. Schultz of Pegasystems Technologies.

</pre><h4><b>BUGS</b> <b>AND</b> <b>ISSUES</b></h4><pre>
       Fields set in configuration files will override command line options that have been set before  the  file
       is  read.   This  behaviour while consistent may occasionally confuse.  For this reason most command line
       options should be specified after any options that may cause a configuration file to be loaded.

       In order to preserve permissions it is necessary for dirvish to run as root on the backup server.

       The root user must have non-interactive ssh access to the client systems.  It is not necessary that  this
       access be as the root user on the client.

       File  ownership  is  preserved  using  numeric values so it is not necessary to have user accounts on the
       backup server.  Making the vaults network accessible using protocols that map UIDs based on names instead
       of number could allow access controls on files to be violated.

       Making the vaults writable by users will compromise the integrity of the backups.  Therefore  any  access
       to the vaults by users should be done through a read-only mount.

                                                                                                      <u><a href="../man8/DIRVISH.8.html">DIRVISH</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>