<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>systemd-nsresourced.service, systemd-nsresourced - User Namespace Resource Delegation Service</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/systemd-container">systemd-container_257.7-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       systemd-nsresourced.service, systemd-nsresourced - User Namespace Resource Delegation Service

</pre><h4><b>SYNOPSIS</b></h4><pre>
       systemd-nsresourced.service

       /usr/lib/systemd/systemd-nsresourced

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>systemd-nsresourced</b> is a system service that permits transient delegation of a UID/GID range to a user
       namespace (see <b><a href="../man7/user_namespaces.7.html">user_namespaces</a></b>(7)) allocated by a client, via a Varlink IPC API.

       Unprivileged clients may allocate a user namespace, and then request a UID/GID range to be assigned to it
       via this service. The user namespace may then be used to run containers and other sandboxes, and/or apply
       it to an id-mapped mount.

       Allocations of UIDs/GIDs this way are transient: when a user namespace goes away, its UID/GID range is
       returned to the pool of available ranges. In order to ensure that clients cannot gain persistency in
       their transient UID/GID range a BPF-LSM based policy is enforced that ensures that user namespaces set up
       this way can only write to file systems they allocate themselves or that are explicitly allowlisted via
       <b>systemd-nsresourced</b>.

       <b>systemd-nsresourced</b> automatically ensures that any registered UID ranges show up in the system's NSS
       database via the <b>User/Group</b> <b>Record</b> <b>Lookup</b> <b>API</b> <b>via</b> <b>Varlink</b>[1].

       Currently, only UID/GID ranges consisting of either exactly 1 or exactly 65536 UIDs/GIDs can be
       registered with this service. Moreover, UIDs and GIDs are always allocated together, and symmetrically.

       The service provides API calls to allowlist mounts (referenced via their mount file descriptors as per
       Linux <b>fsmount()</b> API), to pass ownership of a cgroup subtree to the user namespace and to delegate a
       virtual Ethernet device pair to the user namespace. When used in combination this is sufficient to
       implement fully unprivileged container environments, as implemented by <b><a href="../man1/systemd-nspawn.1.html">systemd-nspawn</a></b>(1), fully
       unprivileged <u>RootImage=</u> (see <b><a href="../man5/systemd.exec.5.html">systemd.exec</a></b>(5)) or fully unprivileged disk image tools such as <b><a href="../man1/systemddissect.1.html">systemd-</a></b>
       <b><a href="../man1/systemddissect.1.html">dissect</a></b>(1).

       This service provides one <b>Varlink</b>[2] service: <b>io.systemd.NamespaceResource</b> allows registering user
       namespaces, and assign mounts, cgroups and network interfaces to it.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man8/systemd-mountfsd.service.8.html">systemd-mountfsd.service</a></b>(8), <b><a href="../man1/systemd-nspawn.1.html">systemd-nspawn</a></b>(1), <b><a href="../man5/systemd.exec.5.html">systemd.exec</a></b>(5), <b><a href="../man1/systemd-dissect.1.html">systemd-dissect</a></b>(1),
       <b><a href="../man7/user_namespaces.7.html">user_namespaces</a></b>(7)

</pre><h4><b>NOTES</b></h4><pre>
        1. User/Group Record Lookup API via Varlink
           https://systemd.io/USER_GROUP_API

        2. Varlink
           https://varlink.org/

systemd 257.7                                                                     <u><a href="../man8/SYSTEMD-NSRESOURCED.SERVICE.8.html">SYSTEMD-NSRESOURCED.SERVICE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>