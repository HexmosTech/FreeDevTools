<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ipsec-pluto, pluto - Internet Key Exchange daemon</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libreswan">libreswan_5.2-2.2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ipsec-pluto, pluto - Internet Key Exchange daemon

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>ipsec</b> <b>pluto</b> [--help] [--version]
                   [--nofork] [--rundir <u>path</u>] [--leak-detective] [--efence-protect]
                   [--stderrlog] [--logfile <u>filename</u>] [--log-no-time] [--log-no-append] [--log-no-ip]
                   [--log-no-audit]
                   [--config <u>filename</u>] [--secretsfile <u>secrets-file</u>] [--ipsecdir <u>dirname</u>] [--nssdir <u>dirname</u>]
                   [--coredir <u>dirname</u>]
                   [--vendorid <u>VID</u>] [--uniqueids] [--virtual-private <u>network_list</u>] [--keep-alive <u>delay_sec</u>]
                   [--force-busy] [--crl-strict] [--crlcheckinterval] [--listen <u>ipaddr</u>] [--nhelpers <u>number</u>]
                   [--seedbits <u>numbits</u>] [--statsbin <u>filename</u>] [--secctx-attr-type <u>number</u>]
                   [--use-xfrm] [--use-bsdkame]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>pluto</b> is Libreswan's Internet Key Exchange (IKE) daemon.

       <b>pluto</b> is not normally run directly. Instead the daemon is controlled the hosts <b><a href="../man8/init.8.html">init</a></b>(8) system (such as
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1) or <b><a href="../man8/rc.8.html">rc</a></b>(8)) or the command <b>ipsec</b> (see <b><a href="../man8/ipsec.8.html">ipsec</a></b>(8)).

       For more general information on Libreswan see <b><a href="../man7/libreswan.7.html">libreswan</a></b>(7).

       For information on how to configure Libreswan and the <b>pluto</b> daemon see <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5).

   <b>Help</b> <b>Options</b>
       <b>--help</b>
           show <b>pluto's</b> usage message

       <b>--version</b>
           show Libreswan's version details

   <b>Starting</b> <b>pluto</b>
       When starting, <b>pluto</b> attempts to create a lockfile with the name /run/pluto/pluto.pid. If the lockfile
       cannot be created, <b>pluto</b> exits - this prevents multiple <b>pluto</b>s from competing. Any "leftover" lockfile
       must be manually removed before <b>pluto</b> will run.  <b>pluto</b> then writes its <u>PID</u> into this file so that scripts
       can find it.  <b>pluto</b> then forks and the parent exits (this is the conventional "daemon fork").

       The following options alter how <b>pluto</b> starts:

       <b>--nofork</b>
           disable "daemon fork"

           In addition, after the lock file and control socket are created, print the line "Pluto initialized"
           to standard out.

       <b>--rundir</b> <u>path</u>
           change the run directory from the default /run/pluto)

           The run directory contains:

           <u>path</u>/pluto.ctl
               the socket through which <b>whack</b> communicates with <b>pluto</b>

           <u>path</u>/pluto.pid
               the lockfile to prevent multiple <b>pluto</b> instances

       <b>--leak-detective</b>
           enable leak detective

       <b>--efence-protect</b>
           enable efence protection

   <b>Logging</b>
       All logging, including diagnostics, are sent to <b><a href="../man3/syslog.3.html">syslog</a></b>(3) with facility=authpriv; it decides where to put
       these messages. The following options alter this behaviour:

       <b>--stderrlog</b>
           direct logging to standard error instead of a log file

           Often combined with <b>--nofork</b> debugging <b>pluto</b>.

       <b>--logfile</b> <u>filename</u>
           direct logging to <u>filename</u> instead of <b><a href="../man3/syslog.3.html">syslog</a></b>(3)

           See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) and logfile=<u>filename</u>.

       <b>--log-no-time</b>
           do not include a timestamp prefix when logging to a file

           See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) and logtime=no.

       <b>--log-no-append</b>
           do not append to the end of an existing log file

           See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) and logappend=no.

       <b>--log-no-ip</b>
           do not include IP addresses when logging

           See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) and logip=no.

       <b>--log-no-audit</b>
           do not generate audit logs (on systems that support Linux Auditing)

           See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) and audit-log=no.

   <b>Configuration</b> <b>Files</b>
       The following options overide <b>pluto's</b> default configuration parameters:

       <b>--config</b> <u>filename</u>
           specify a <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) file containing additional configuration parameters

           The "config" section of <u>filename</u> will be loaded.

           Normally, <b>pluto</b> is started using <b>ipsec</b> <b>start</b>, and that passes the parameter <b>--config</b> <b>/etc/ipsec.conf</b>
           so that the default configuration is read.

       <b>--secretsfile</b> <u>secrets-file</u>
           specify the file for authentication secrets

           This name is subject to "globbing" as in <b><a href="../man1/sh.1.html">sh</a></b>(1), so every file with a matching name is processed.
           Quoting is generally needed to prevent the shell from doing the globbing.

           Default is /etc/ipsec.secrets. See <b><a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a></b>(5).

       <b>--ipsecdir</b> <u>dirname</u>
           the directory containing additional configuration files

           Default is /etc/ipsec.d.

       <b>--nssdir</b> <u>dirname</u>
           the directory containing the NSS trust store

           Default is /var/lib/ipsec/nss.

       <b>--coredir</b> <u>dirname</u>
           the directory to write a core file should <b>pluto</b> abort

           Default is /run/pluto.

   <b>Other</b> <b>Options</b>
       The following options tweak <b>pluto's</b> behaviour:

       <b>--vendorid</b> <u>VID</u>

       <b>--uniqueids</b>
           require all connections to have a unique identifier

           If this option has been selected, whenever a new ISAKMP SA is established, any connection with the
           same Peer ID but a different Peer IP address is unoriented (causing all its SAs to be deleted). This
           helps clean up dangling SAs when a connection is lost and then regained at another IP address.

       <b>--virtual-private</b> <u>network_list</u>
           Pluto supports RFC 3947 NAT-Traversal. The allowed range behind the NAT routers is submitted using
           the <b>--virtual-private</b> option.

           See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) for the syntax

       <b>--keep-alive</b> <u>delay_sec</u>
           The <b>--keep-alive</b> sets the delay (in seconds) of these keep-alive packets. The newer NAT-T standards
           support <u>port</u> <u>floating</u>, and Libreswan enables this per default.

       <b>--force-busy</b>
           If this option has been selected, pluto will be forced to be "busy". In this state, which happens
           when there is a Denial of Service attack, will force pluto to use cookies before accepting new
           incoming IKE packets. Cookies are send and required in ikev1 Aggressive Mode and in ikev2. This
           option is mostly used for testing purposes, but can be selected by paranoid administrators as well.

       <b>--crl-strict</b>
           reject authentication using X.509 until a valid certificate revocation list has been loaded

       <b>--crlcheckinterval</b>

       <b>--listen</b> <u>ipaddr</u>

       <b>--nhelpers</b> <u>number</u>
           specify the number of threads to use when offloading cryptographic operations

           Pluto can also use helper children to off-load cryptographic operations. This behavior can be fine
           tuned using the <b>--nhelpers</b>. Pluto will start <u>(n-1)</u> of them, where <u>n</u> is the number of CPU's you have
           (including hypherthreaded CPU's). A value of <u>0</u> forces pluto to do all operations in the main process.
           A value of <u>-1</u> tells pluto to perform the above calculation. Any other value forces the number to that
           amount.

           See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) and nhelpers=<u>number</u>.

       <b>--seedbits</b> <u>numbits</u>
           specify the number of seed bits to read from the RNG before starting

           Pluto uses the NSS crypto library as its random source. Some government Three Letter Agency requires
           that pluto reads 440 bits from /dev/random and feed this into the NSS RNG before drawing random from
           the NSS library, despite the NSS library itself already seeding its internal state. As this process
           can block pluto for an extended time, the default is to not perform this redundant seeding. The
           <b>--seedbits</b> option can be used to specify the number of bits that will be pulled from /dev/random and
           seeded into the NSS RNG.

           See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) and seedbits=<u>number</u>.

           This option should not be used by most people.

       <b>--statsbin</b> <u>filename</u>

       <b>--secctx-attr-type</b> <u>number</u>

       <b>Libreswan</b> supports different IPstacks on different operating systems. Since most IPstacks have died the
       list is very short:

       <b>--use-xfrm</b>
           linux only

       <b>--use-bsdkame</b>
           BSD only

   <b>Debugging</b>
       When running <b>pluto</b> under a debugger, the options <b>--nofork</b> and <b>--stderrlog</b> are recommended.

       <b>pluto</b> is willing to produce a prodigious amount of debugging information. There are several classes of
       debugging output, and <b>pluto</b> may be directed to produce a selection of them. All lines of debugging output
       are prefixed with "|" to distinguish them from normal diagnostic messages.

       See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) and plutodebug=<u>options</u>.

       Very occasionally it is necessary to enable debugging early in <b>pluto's</b> startup process. The follow
       options enable this:

       <b>--debug</b> <b>help</b> (whack only)
           List the debugging classes recognised by <b>pluto</b>.

       <b>--debug</b> <b>none</b>
           Disable logging for all debugging classes.

       <b>--debug</b> <b>base</b>
           Enable debug-logging.

       <b>--debug</b> <b>cpu-usage</b>
           Enable cpu-usage logging.

       <b>--debug</b> <u>class</u>, <b>--no-debug</b> <u>class</u>, <b>--debug</b> <b>no-</b><u>class</u>
           Enable (disable) logging of the specified debugging <u>class</u> (<b>--debug</b> <b>help</b> lists debugging classes
           supported by this version of <b>pluto</b>).

</pre><h4><b>SIGNALS</b></h4><pre>
       <b>pluto</b> responds to <b>SIGHUP</b> by issuing a suggestion that <b>ipsec</b> <b>listen</b> might have been intended.

       <b>pluto</b> exits when it receives <b>SIGTERM</b>.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <b>pluto</b> normally forks a daemon process, so the exit status is a very preliminary result.

       <b>0</b>
           means that all is OK so far.

       <b>1</b>
           means that something was wrong.

       <b>10</b>
           means that the lock file already exists.

</pre><h4><b>FILES</b></h4><pre>
       /run/pluto/pluto.pid /run/pluto/pluto.ctl /etc/ipsec.secrets /etc/ipsec.conf

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       <b>pluto</b> does not use any environment variables.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       The rest of the Libreswan distribution, in particular <b><a href="../man7/libreswan.7.html">libreswan</a></b>(7).

</pre><h4><b>HISTORY</b></h4><pre>
       This code is released under the GPL terms. See the accompanying files CHANGES COPYING and CREDITS.* for
       more details.

       Detailed history (including FreeS/WAN and Openswan) can be found in the docs/ directory.

</pre><h4><b>BUGS</b></h4><pre>
       Please see <b>https://github.com/libreswan/libreswan/issues</b> for a list of currently known bugs and missing
       features.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Wouters Andrew Cagney

Libreswan 5.2                                      07/30/2025                                     <u><a href="../man8/IPSEC-PLUTO.8.html">IPSEC-PLUTO</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>