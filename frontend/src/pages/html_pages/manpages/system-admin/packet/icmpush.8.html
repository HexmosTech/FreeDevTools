<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>icmpush - ICMP packet builder</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/icmpush">icmpush_2.2-6.1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       icmpush - ICMP packet builder

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>icmpush</b> <u>type</u> <u>[options]</u> <u>host</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>icmpush</b> is a tool that builds ICMP packets fully customized from command line.

       It  supports  the following ICMP error types: <u>Redirect</u>, <u>Source</u> <u>Quench</u>, <u>Time</u> <u>Exceeded</u>, <u>Destination</u> <u>Unreach</u>
       and <u>Parameter</u> <u>Problem</u>.

       And the following ICMP information types: <u>Address</u> <u>Mask</u>  <u>Request</u>,  <u>Timestamp</u>,  <u>Information</u>  <u>Request</u>,  <u>Echo</u>
       <u>Request</u>, <u>Router</u> <u>Solicitation</u> and <u>Router</u> <u>Advertisement</u>.

       Is  not of our concern to give a fully description of how ICMP protocol works, but the more knowledgement
       we have we can fully understand its management, use and posibilities of this tool.

       The quantity of arguments needed can appear excessive but his own author  reminds  that  some  imperative
       data  must be given through a command line for a fully adjustment to the protocol format on a ICMP packet
       construction.

       A long number of examples is given at the <u>EXAMPLES</u> section of this page that shows a  real  use  of  this
       program.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-h</b>, <b>--help</b>
              Help.

       <b>-V</b>, <b>--version</b>
              Program version.

       <b>-v</b>, <b>--verbose</b>
              Informative mode.

       <b>-vv</b>, <b>--more_verbose</b>
              More informative. Useful when debugging.

       The ICMP type <u>type</u> can be any of the following below:

       <b>-du</b>, <b>--dest_unreach</b>
              Destination Unreach. IP packet couldn't be given.  This ICMP type is <u>error</u>.

       <b>-sq</b>, <b>--src_quench</b>
              Source Quench. IP packet is not given do a congestion on the net.  This ICMP type is <u>error</u>.

       <b>-red</b>, <b>--redirect</b>
              Redirect. Request to forward IP packets through another router.  This ICMP type is <u>error</u>.

       <b>-echo</b>, <b>--echo_request</b>
              Echo Request. Request sent to a host to receive an echo reply.  This ICMP type is <u>information</u>.

       <b>-rta</b>, <b>--router_advert</b> <u>address</u>[<u>/preference</u>]
              Router  Advertisement.  Router  trasmits  one  or more routers with address <u>address</u> and preference
              <u>preference</u>.  If this is ommited, default preference 0 is given.  This ICMP type is <u>information</u>.

       <b>-rts</b>, <b>--router_solicit</b>
              Router Solicitation. Host requeriment for a message of one or more routers.  Like the previous, is
              a part of the messages exchange Router Discovery and this ICMP type is <u>information</u>.

       <b>-tx</b>, <b>--time_exc</b>
              Time Exceeded. Time Exceeded for an IP packet.  This ICMP type is <u>error</u>.

       <b>-param</b>, <b>--param_problem</b>
              Parameter Problem. Erroneous value on a variable of IP header.  This ICMP type is <u>error</u>.

       <b>-tstamp</b>, <b>--timestamp</b>
              Timestamp. Host request to receive the time of another host.  This ICMP type is <u>information</u>.

       <b>-info</b>, <b>--info_req</b>
              Information Request. Host request to receive an Info Reply from another host.  This ICMP  type  is
              <u>information</u>.

       <b>-mask</b>, <b>--mask_req</b>
              Address Mask Request. Used to find out a host network mask.  This ICMP type is <u>information</u>.

       The <u>options</u> can be any of the following:

       <b>-sp</b>, <b>--spoof</b> <u>address</u>
              IP address to be used as the source of the ICMP packet.

       <b>-to</b>, <b>--timeout</b> <u>secs</u>
              Timeout  in  seconds  to  read the answers. Only valid on ICMPs of <u>information</u> type but the Router
              Advertisement type (<b>-rta</b>).  Default is 5 seconds. If 0 is given answers can not be read.

       <b>-n</b>, <b>--no_resolve</b>
              Don't use name resolution.

       <b>-lt</b>, <b>--lifetime</b> <u>secs</u>
              Lifetime in seconds of the router announcement. Only valid with Router Advertisement (<u>-rta</u>)  type.
              1800 seconds on default (30').

       <b>-gw</b>, <b>--gateway</b> <u>address</u>
              Route  gateway address on an ICMP Redirect (<b>-red</b>).  On default will be the spoof address (<b>-sp</b>), if
              it has been specified, or the outgoing IP address if it has not been specified.

       <b>-dest</b>, <b>--route_dest</b> <u>address</u>
              Route destination address on an ICMP Redirect (<b>-red</b>). This is a required option  when  sending  an
              ICMP Redirect.

       <b>-orig</b>, <b>--orig_host</b> <u>address</u>
              Original  host  within  the IP header sent in the 64 bits data field of an ICMP <u>error</u>.  On default
              will be the same as the IP of the host that sends the ICMP packet.

       <b>-psrc</b>, <b>--port_src</b> <u>port</u>
              Source port (tcp or udp) within the IP header sent in the 64 bits data field of an ICMP  <u>error</u>.  0
              on default.

       <b>-pdst</b>, <b>--port_dest</b> <u>port</u>
              Destination  port  (tcp  or  udp)  within  the IP header sent in the 64 bits data field of an ICMP
              <u>error</u>. 0 on default.

       <b>-prot</b>, <b>--protocol</b> <u>icmp</u>|<u>tcp</u>|<u>udp</u>
              Protocol to be used within the IP header sent in the 64 bits data field of an ICMP <u>error</u>. Must  be
              one of the three listed above. Tcp on default.

       <b>-id</b>, <b>--echo_id</b> <u>identificator</u>
              Echo  identificator  within the IP header sent in the 64 bits data field of an ICMP <u>error</u> when the
              IP header protocol of the 64 bits data field (<b>-prot</b>) is icmp. 0 on default.

       <b>-seq</b>, <b>--echo_seq</b> <u>sequence</u>
              Echo sequence number within the IP header sent in the 64 bits data field of an ICMP <u>error</u> when the
              IP header protocol of the 64 bits data field (<b>-prot</b>) is icmp. 0 on default.

       <b>-pat</b>, <b>--pattern</b> <u>pattern</u>
              Data pattern to send on an Echo Request (<b>-echo</b>).

       <b>-gbg</b>, <b>--garbage</b> <u>bytes</u>|<u>max</u>
              Number of garbage bytes that will be sent on any ICMP packet. With <u>max</u> the maximum  possible  will
              be sent.

       <b>-ptr</b>, <b>--pointer</b> <u>byte</u>
              Pointer  to  erroneus  byte  <u>byte</u>  on  an  ICMP packet showing a parameter problem.  Valid only on
              Parameter Problem type (<b>-param</b>).

       <b>-c</b>, <b>--code</b> <u>code</u>|<u>num</u>|<u>max</u>
              ICMP code to send. Code <u>code</u> valid  for  Destination  Unreach  (<b>-du</b>),  Redirect  (<b>-red</b>)  and  Time
              Exceeded (<b>-tx</b>) types.

              Numerical  code  can  be specified for the ICMP types that doesn't have (Echo Request, Information
              Request, Address Mask Request, Router Solicitation, Router Advertisement, Source Quench, Parameter
              Problem and Timestamp).

              Using <u>max</u> an ICMP code bigger than the admited ones will be sent.

              Next <u>ICMP</u> <u>CODES</u> section enumerates the valid <u>code</u> types.

</pre><h4><b>ICMP</b> <b>CODES</b></h4><pre>
       Valid <u>codes</u> used with Destination Unreach, Redirect y Time Exceeded types are,

       - Used with <b>Destination</b> <b>Unreach</b> type (<b>-du</b>):

       <u>net-unreach</u> (Net Unreachable) The destination net is unreacheable.

       <u>host-unreach</u> (Host Unreachable) The destination host is unreacheable.

       <u>prot-unreach</u> (Protocol Unreachable) desired protocol is unreacheable to destination host.

       <u>port-unreach</u> (Port Unreachable) desired port is unreacheable to destination host.

       <u>frag-needed</u> (Fragmentation Needed and Don't Fragment was Set) Shows that IP packet had to  be  fragmented
       because of its size but the sender did not allowed it because of DF (DON'T FRAGMENT) flag.

       <u>sroute-fail</u> (Source Route Failed) could'nt follow the route indicated on IP packet.

       <u>net-unknown</u> (Destination Network Unknown) Destination network is unknown.

       <u>host-unknown</u> (Destination Host Unknown) Destination host unknown but network is.

       <u>host-isolated</u> (Source Host Isolated) Can't reach destination host.

       <u>net-ano</u>  (Communication with Destination Network is Administratively Prohibited) access network is denied
       through firewall or similar on receiver side.

       <u>host-ano</u> (Communication with Destination Host is  Administratively  Prohibited)  access  host  is  denied
       through firewall or similar on receiver side.

       <u>net-unr-tos</u>  (Destination  Network Unreachable for Type of Service) indicates on destination network that
       the Type Of Service (TOS) applied for is not allowed.

       <u>host-unr-tos</u> (Destination  Host  Unreachable  for  Type  of  Service)  shows  that  destination  host  is
       unreachable with applied TOS.

       <u>com-admin-prohib</u>  (Communication  Administratively Prohibited) a router can't forward a packet because of
       administrative filter.

       <u>host-precedence-viol</u> (Host Precedence Violation) IP packet procedence is not allowed.

       <u>precedence-cutoff</u> (Precedence cutoff in effect) a smaller IP packet precedence has tried to be sent  over
       the minimous impossed by network's manager.

       - To be used with <b>Redirect</b> type (<b>-red</b>):

       <u>net</u> (Redirect Datagram for the Network) shows that destination is a network.

       <u>host</u> (Redirect Datagram for the Host) shows that destination is a host.

       <u>serv-net</u>  (Redirect  Datagram  for  the Type Of Service and Network) destination is a type of service and
       network.

       <u>serv-host</u> (Redirect Datagram for the Type Of Service and Host) destination is a type of service and host.

       and

       - to be used with <b>Time</b> <b>Exceeded</b> type (<b>-tx</b>):

       <u>ttl</u> (Time to Live exceeded in Transit) time is over on an IP's header packet.

       <u>frag</u> (Fragment Reassembly Time Exceeded) could not put IP's packet fragment together again.

</pre><h4><b>RETURN</b> <b>CODES</b></h4><pre>
       <b>icmpush</b> can be easily used within shell scripts.  Program returns the following data to the shell:

       Value  Meaning
       -----  -----------
       0      Finished program OK.
       1      Incorrect argument number.
       2      Unkown ICMP protocol.
       3      Cannot create RAW socket type.
       4      Erroneous ICMP packet.
       5      Erroneous gateway.
       6      Erroneous destination route.
       7      Erroneous ICMP packet code.
       8      Erroneous source host.
       9      Error sending packet.
       10     Protocol still not implemented.
       11     Erroneous IP address or spoof host incorrect.
       12     Could not save memory for the data_hdr union.
       13     Erroneous IP address or packet destination host.
       14     Unkown protocol.
       16     Error reading RAW socket.
       17     Error initializing signal handler SIGALARM.
       18     Echo Request packet data too big.
       19     Source port incorrect.
       20     Destination port incorrect.
       21     Incorrect timeout value.
       22     Incorrect Echo ID.
       23     Incorrect sequence number.
       24     Erroneous Echo data.
       25     IP_HDRINCL error.
       26     Erroneous router address in Router Advertisement.
       27     Incorrect garbage bytes number.
       28     Incorrect ICMP pointer Parameter Problem.

</pre><h4><b>EXAMPLES</b></h4><pre>
       - In response to a packet send with TCP source port 100 and destination on port 90, we want to  send  and
       ICMP Redirect to asshole.es to modify its routing table with the following data: 10.12.12.12 as a gateway
       to the host death.es masking the packet source as if it was sent from infect.comx host:

       <b>icmpush</b>  <b>-red</b>  <b>-sp</b>  <u>infect.comx</u>  <b>-gw</b>  <u>10.12.12.12</u>  <b>-dest</b>  <u>death.es</u>  <b>-c</b>  <u>host</u> <b>-prot</b> <u>tcp</u> <b>-psrc</b> <u>100</u> <b>-pdst</b> <u>90</u>
       <u>asshole.es</u>

       - In response to an ICMP packet Echo Request sent with Echo Request id  100  and  Echo  Request  sequence
       number  90,  we  want to send an ICMP Redirect to the host hemorroids.es to modify its routing table with
       the following data: the host pizza.death as a gateway to the host death.es, masking the packet source  as
       if iit was sent from infect.comx host.

       <b>icmpush</b>  <b>-red</b>  <b>-sp</b>  <u>infect.comx</u>  <b>-gw</b>  <u>pizza.death</u>  <b>-dest</b>  <u>death.es</u>  <b>-c</b>  <u>host</u>  <b>-prot</b>  <u>icmp</u> <b>-id</b> <u>100</u> <b>-seq</b> <u>90</u>
       <u>hemorroids.es</u>

       - We want to send an ICMP packet Destination Unreach to the host 10.2.3.4 saying that our TCP port number
       20 connected with his TCP port 2100, is unreachable.  We mask ourselves as host 10.1.1.1:

       <b>icmpush</b> <b>-du</b> <b>-sp</b> <u>10.1.1.1</u> <b>-c</b> <u>port-unreach</u> <b>-prot</b> <u>tcp</u> <b>-psrc</b> <u>2100</u> <b>-pdst</b> <u>20</u> <u>10.2.3.4</u>

       - We want to send an ICMP packet Destination Unreach to host 10.2.3.4 saying that the  host  inferno.hell
       and  its  TCP  port  69,  connected  with  his port TCP 666 in unreacheable. We mask ourselves as gateway
       router.comx:

       <b>icmpush</b> <b>-du</b> <b>-sp</b> <u>router.comx</u> <b>-c</b> <u>host-unreach</u> <b>-prot</b> <u>tcp</u> <b>-psrc</b> <u>666</u> <b>-pdst</b> <u>69</u> <b>-orig</b> <u>inferno.hell</u> <u>10.2.3.4</u>

       - We want to send a packet ICMP Source Quench to host ldg02.hell in response to a  packet  destinated  to
       host  ldg00  with  UDP  protocol,  source port 100 and destination port 200. We mask ourselves as gateway
       10.10.10.1:

       <b>icmpush</b> <b>-sq</b> <b>-sp</b> <u>10.10.10.1</u> <b>-prot</b> <u>udp</u> <b>-psrc</b> <u>100</u> <b>-pdst</b> <u>200</u> <b>-orig</b> <u>ldg00</u> <u>ldg02.hell</u>

       - We want to send an ICMP packet Time Exceeded to host ldg02.hell in response to a packet  destinated  to
       host ldg00 with UDP protocol, source port 100 and destination port 200. We mask as gateway ldg04.hell:

       <b>icmpush</b> <b>-tx</b> <b>-sp</b> <u>ldg04.hell</u> <b>-c</b> <u>frag</u> <b>-prot</b> <u>udp</u> <b>-psrc</b> <u>100</u> <b>-pdst</b> <u>200</u> <b>-orig</b> <u>ldg00</u> <u>ldg02.hell</u>

       - We want to send an ICMP packet Address Mask Request and wait 10 seconds to see the replies. We mask the
       packet with source address of 10.2.3.4 and we send it to the address 10.0.1.255:

       <b>icmpush</b> <b>-mask</b> <b>-sp</b> <u>10.2.3.4</u> <b>-to</b> <u>10</u> <u>10.0.1.255</u>

       - We want to send an ICMP packet Timestamp to host sepultura.hell.  We mask the packet as if it were send
       from host 10.2.3.1. We use the default timeout (5 seconds):

       <b>icmpush</b> <b>-tstamp</b> <b>--spoof</b> <u>10.2.3.1</u> <u>sepultura.hell</u>

       -  We  want  to send an ICMP packet Information Request to host voucher.hell.  The source address will be
       our own IP address, and the timeout will be 20 seconds:

       <b>icmpush</b> <b>-info</b> <b>-to</b> <u>20</u> <u>voucher.hell</u>

       - We want to send an ICMP packet Router Solicitation to host lazy.hell. The source address  will  be  our
       own IP address and the timeout will be 20 seconds:

       <b>icmpush</b> <b>-rts</b> <b>--timeout</b> <u>20</u> <u>lazy.hell</u>

       - We want to send an ICMP packet Echo Request to host lazy.hell with the data pattern 'MyNameIsGump'. The
       source address will be our own IP address and the timeout to read the data will be 2 seconds:

       <b>icmpush</b> <b>-echo</b> <b>-data</b> <u>MyNameIsGump</u> <b>-to</b> <u>2</u> <u>lazy.hell</u>

       -  We want to send ICMP packet Echo Request to 10.12.0.255 with the following data pattern: and we do not
       want to read the answers:

       <b>icmpush</b> <b>-echo</b> <b>-sp</b> <u>192.168.0.255</u> <b>-data</b> <u>'D</u> <u>E</u> <u>A</u> <u>T</u> <u>H'</u> <b>-to</b> <u>0</u> <u>192.168.0.255</u>

       - We want to send an ICMP packet Destination Unreach to host destination.death but  sending  it  with  an
       ICMP code bigger to the legal ones adding also 60K of garbage data:

       <b>icmpush</b> <b>-du</b> <b>-c</b> <u>max</u> <b>-gbg</b> <u>60000</u> <u>destination.death</u>

       -  We  want  to  send  an ICMP Router Advertisement to host death.es, saying that the routers to use are:
       router1.xtc with preference 20, router2.xtc with preference 50 and router3.xtc  with  default  preference
       (0). We mask ourselves as fatherouter.xtc

       <b>icmpush</b> <b>-rta</b> <u>router1.xtc/20</u> <b>-rta</b> <u>router2.xtc/50</u> <b>-rta</b> <u>router3.xtc</u> <b>-sp</b> <u>fatherouter.xtc</u> <u>death.es</u>

       -  We send an ICMP Parameter Problem to host misery.es saying that the packet sent from the host hick.org
       with udp protocol, source port 13 and destination port 53, has an error on the IP header byte 13. We will
       also add all garbage bytes as possible:

       <b>icmpush</b> <b>-sp</b> <u>hick.org</u> <b>-param</b> <b>-ptr</b> <u>13</u> <b>-prot</b> <u>udp</u> <b>-psrc</b> <u>13</u> <b>-pdest</b> <u>53</u> <b>-gbg</b> <u>max</u> <u>misery.es</u>

       - We want to send an ICMP packet Timestamp to host www.hicks.org with code 38  instead  of  code  (0)  as
       usual:

       <b>icmpush</b> <b>-tstamp</b> <b>-c</b> <b>38</b> <u>www.hicks.org</u>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Postel,  John,  "Internet  Control Message Protocol - DARPA Internet Program Protocol Specification", <u>RFC</u>
       <u>792</u>, USC/Information Sciences Institute, September 1981.

       Mogul,  Jeffrey  and  John  Postel,  "Internet  Standard  Subnetting  Procedure",  <u>RFC</u>   <u>950</u>,   Stanford,
       USC/Information Sciences Institute, August 1985.

       Braden,  Robert,  "Requeriments  for  Internet  Hosts  - Communication Layers", <u>RFC</u> <u>1122</u>, USC/Information
       Sciences Institute, October 1989.

       Deering, Stephen, "ICMP Router Discovery Messages", <u>RFC</u> <u>1256</u>, Xerox PARC, September 1991.

       Baker, Fred, "Requeriments for IP Version 4 Routers", <u>RFC</u> <u>1812</u>, Cisco Systems, June 1995.

       The <u>Linux</u> <u>source</u> <u>code</u>, everything referent to network code and to ICMP protocol.

</pre><h4><b>AUTHOR</b></h4><pre>
       Slayer &lt;<a href="mailto:tcpbgp@softhome.net">tcpbgp@softhome.net</a>&gt;

icmpush v2.2                                    February 22, 1999                                     <u><a href="../man8/ICMPUSH.8.html">ICMPUSH</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>