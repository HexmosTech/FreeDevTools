<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iptstate - A top-like display of IP Tables state table entries</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/iptstate">iptstate_2.2.7-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>iptstate</b> - A top-like display of IP Tables state table entries

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>iptstate</b> [&lt;<b>options</b>&gt;]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>iptstate</b>  displays  information  held  in  the  IP  Tables state table in real-time in a top-like format.
       Output can be sorted by any field, or any field reversed. Users can choose to have the output only  print
       once  and  exit,  rather  than  the top-like system. Refresh rate is configurable, IPs can be resolved to
       names, output can be formatted, the display can be filtered, and color coding are among some of the  many
       features.

</pre><h4><b>COMMAND-LINE</b> <b>OPTIONS</b></h4><pre>
       <b>-c,</b> <b>--no-color</b>
              Toggle color-code by protocol

       <b>-C,</b> <b>--counters</b>
              Toggle display of bytes/packets counters

       <b>-d,</b> <b>--dst-filter</b> <u>IP[/NETMASK]</u>
              Only show states with a destination of <u>IP</u> and with optional <u>NETMASK</u>.
              Note, that this must be an IP, hostname matching is not yet supported.

       <b>-D</b> <b>--dstpt-filter</b> <u>port</u>
              Only show states with a destination port of <u>port</u>

       <b>-h,</b> <b>--help</b>
              Show help message

       <b>-i,</b> <b>--invert-filters</b>
              Invert filters to display non-matching results

       <b>-l,</b> <b>--lookup</b>
              Show  hostnames  instead  of  IP  addresses. Enabling this will also enable <b>-L</b> to prevent an ever-
              growing number of DNS requests.

       <b>-m,</b> <b>--mark-truncated</b>
              Mark truncated hostnames with a '+'

       <b>-o,</b> <b>--no-dynamic</b>
              Toggle dynamic formatting

       <b>-L,</b> <b>--no-dns</b>
              Skip outgoing DNS lookup states

       <b>-f,</b> <b>--no-loopback</b>
              Filter states on loopback

       <b>-p,</b> <b>--no-scroll</b>
              No scrolling (don't use a "pad"). See <b>SCROLLING</b> <b>AND</b> <b>PADS</b> for more information.

       <b>-r,</b> <b>--reverse</b>
              Reverse sort order

       <b>-R,</b> <b>--rate</b> <u>seconds</u>
              Refresh rate, followed by rate in <u>seconds</u>. Note that this is for statetop mode, and not applicable
              for single-run mode (--single).

       <b>-1,</b> <b>--single</b>
              Single run (no curses)

       <b>-b,</b> <b>--sort</b> <u>column</u>
              This determines what column to sort by. Options:
                   <b>S</b> Source Port
                   <b>d</b> Destination IP (or Name)
                   <b>D</b> Destination Port
                   <b>p</b> Protocol
                   <b>s</b> State
                   <b>t</b> TTL
                   <b>b</b> Bytes
                   <b>P</b> Packets
              To sort by Source IP (or Name), don't use -b. Sorting  by  bytes/packets  is  only  available  for
              kernels that support it, and only when compiled against libnetfilter_conntrack (the default).

       <b>-s,</b> <b>--src-filter</b> <u>IP[/NETMASK]</u>
              Only show states with a source of <u>IP</u> and with optional <u>NETMASK</u>.
              Note, that this must be an IP, hostname matching is not yet supported.

       <b>-S,</b> <b>--srcpt-filter</b> <u>port</u>
              Only show states with a source port of <u>port</u>

       <b>-t,</b> <b>--totals</b>
              Toggle display of totals

</pre><h4><b>INTERACTIVE</b> <b>OPTIONS</b></h4><pre>
       As  of  version  2.0,  all command-line options are now available interactively using the same key as the
       short-option. For example, <b>--sort</b> is also <b>-b</b>, so while <b>iptstate</b> is running, hitting  <b>b</b>  will  change  the
       sorting to the next column. Similarly, <b>t</b> toggles the display of totals, and so on.

       There  are  also  extra  interactive  options: <b>B</b> - change sorting to previous column (opposite of <b>b</b>); <b>q</b> -
       quit; and <b>x</b> - delete the currently highlighted state from the netfilter conntrack table.

       Additionally, the following keys are used to navigate within <b>iptstate</b>:

       <b>Up</b> or <b>j</b> - Move up one line

       <b>Down</b> or <b>k</b> - Move down one line

       <b>Left</b> or <b>h</b> - Move left one column

       <b>Right</b> or <b>l</b> - Move right one column

       <b>PageUp</b> or <b>^u</b> - Move up one page

       <b>PageDown</b> or <b>^d</b> - Move down one page

       <b>Home</b> - Go to the top

       <b>End</b> - Go to the end

       In many cases, <b>iptstate</b> needs to prompt you in order to change something. For example, if you want to set
       or change the source-ip filter, when you hit <b>s</b>, <b>iptstate</b> will pop up a prompt at the top of the window to
       ask you what you want to set it to.

       Note that like many UNIX applications, ctrl-G will tell <b>iptstate</b> "nevermind" - it'll  remove  the  prompt
       and forget you ever hit <b>s</b>.

       In most cases, a blank response means "clear" - clear the source IP filter, for example.

       At anytime while <b>iptstate</b> is running, you can hit <b>h</b> to get to the <b>interactive</b> <b>help</b> which will display all
       the current settings to you as well give you a list of all interactive commands available.

       While  running,  <b>space</b>  will immediately update the display. <b>Iptstate</b> should gracefully handle all window
       resizes, but if it doesn't, you can force it to re-calculate and re-draw the screen with a <b>ctrl-L</b>.

       Note that hitting <b>l</b> to enable hostname resolution while in interactive mode will also enable  <b>L</b>  to  skip
       all DNS entries (to prevent an ever-growing number of DNS requests).

</pre><h4><b>SCROLLING</b> <b>AND</b> <b>PADS</b></h4><pre>
       For  almost  any  user,  there  is  no  reason  to turn off scrolling. The ability to turn this off - and
       especially the ability to toggle this interactively - is done  more  for  theoretical  completeness  than
       anything else.

       But, nonetheless, here are the details. Typically in a curses application you create a "window." Windows
       don't scroll, however. They are, at most, the size of your terminal. Windows provide double-buffering to
       make refreshing as fast and seemless as possible. However, to enable scrolling, one has to use "pads"
       instead of windows. Pads can be bigger than the current terminal. Then all necessary data is written to
       the pad, and "scrolling" becomes a function of just showing the right part of that pad on the screen.

       However, pads do not have the double-buffering feature that windows have. Thus, there _might_ be some
       case where for some user using some very strange machine, having scrolling enabled could cause poor
       refreshing. Given the nature of the way <b>iptstate</b> uses the screen though, I find this highly unlikely. In
       addition, the scrolling method uses a little more memory. However, <b>iptstate</b> is not a memory intensive
       application, so this shouldn't be a problem even on low-memory systems.

       Nonetheless, if this does negatively affect you, the option to turn it off is there.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       Anything other than 0 indicates and error. A list of current exit statuses are below:

       <b>0</b>      Success

       <b>1</b>      Bad command-line arguments

       <b>2</b>      Error communicating with the netfilter subsystem.

       <b>3</b>      Terminal too narrow

</pre><h4><b>BUGS</b></h4><pre>
       We  don't support filtering on resolved names. IPv6 support is new and the dynamic formatting doesn't yet
       always handle IPv6 addresses as well as it should.

</pre><h4><b>BUG</b> <b>REPORTS</b></h4><pre>
       All bugs should be reported to Phil Dibowitz &lt;phil AT ipom DOT com&gt;. Please see the <b>README</b> and  <b>BUGS</b>  for
       more information on bug reports. Please read the <b>WISHLIST</b> before sending in features you hope to see.

</pre><h4><b>NOTES</b></h4><pre>
       <b>iptstate</b>  does  a  lot of work to try to fit everything on the screen in an easy-to-read way. However, in
       some cases, hostnames may need to be truncated (in lookup mode). Similarly, IPv6 addresses may need to be
       truncated. The truncation of names happens from the right for source because you most  likely  know  your
       own domain name, and from the left for destination because knowing your users are connection to "mail.a."
       doesn't help much. However, for addresses, this is reversed.

       <b>iptstate</b>  does  not  automatically  handle window-resizes while in the <b>interactive</b> <b>help</b> screen. If you do
       resize while in this window, you should return to the main window, hit <b>ctrl-L</b> to re-calculate and re-draw
       the screen, and then, if you choose, return to the <b>interactive</b> <b>help</b>.

       <b>iptstate</b> currently uses libnetfilter_conntrack to access the netfilter connection state  table.  However,
       older  versions  read  out of /proc/net/ip_conntrack, and the current version can still be compiled to do
       this. This deprecated method can be racy on SMP systems, and can hurt performance on very heavily  loaded
       firewalls. This deprecated method should be avoided - support will be removed in future versions.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/iptables.8.html">iptables</a></b>(8)

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>iptstate</b> was written by Phil Dibowitz &lt;phil AT ipom DOT com&gt;
       <a href="http://www.phildev.net/iptstate/">http://www.phildev.net/iptstate/</a>

                                                    JUNE 2012                                        <u><a href="../man8/IPTSTATE.8.html">IPTSTATE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>