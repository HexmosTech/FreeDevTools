<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>zpool-scrub — begin or resume scrub of ZFS storage pools</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/zfsutils-linux">zfsutils-linux_2.3.2-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       zpool-scrub — begin or resume scrub of ZFS storage pools

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>zpool</b> <b>scrub</b> [<b>-e</b> |<b>-p</b> | <b>-s</b>| <b>-C</b>][<b>-w</b>] <u>pool</u>…

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Begins  a  scrub or resumes a paused scrub.  The scrub examines all data in the specified pools to verify
       that it checksums correctly.  For replicated (mirror, raidz, or draid) devices, ZFS automatically repairs
       any damage discovered during the scrub.  The <b>zpool</b> <b>status</b> command reports the progress of the  scrub  and
       summarizes the results of the scrub upon completion.

       Scrubbing  and resilvering are very similar operations.  The difference is that resilvering only examines
       data that ZFS knows to be out of date (for example, when attaching a new device to a mirror or  replacing
       an existing device), whereas scrubbing examines all data to discover silent errors due to hardware faults
       or disk failure.

       When scrubbing a pool with encrypted filesystems the keys do not need to be loaded.  However, if the keys
       are  not  loaded  and  an unrepairable checksum error is detected the file name cannot be included in the
       <b>zpool</b> <b>status</b> <b>-v</b> verbose error report.

       Because scrubbing and resilvering are I/O-intensive operations, ZFS only allows one at a time.

       A scrub is split into two parts: metadata scanning and block  scrubbing.   The  metadata  scanning  sorts
       blocks  into  large sequential ranges which can then be read much more efficiently from disk when issuing
       the scrub I/O.

       If a scrub is paused, the <b>zpool</b> <b>scrub</b> resumes it.  If a resilver is in progress, ZFS  does  not  allow  a
       scrub to be started until the resilver completes.

       Note  that,  due to changes in pool data on a live system, it is possible for scrubs to progress slightly
       beyond 100% completion.  During this period, no completion time estimate will be provided.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-s</b>  Stop scrubbing.

       <b>-p</b>  Pause scrubbing.  Scrub pause state and progress are periodically synced to disk.  If the  system  is
           restarted  or  pool  is  exported  during a paused scrub, even after import, scrub will remain paused
           until it is resumed.  Once resumed the  scrub  will  pick  up  from  the  place  where  it  was  last
           checkpointed to disk.  To resume a paused scrub issue <b>zpool</b> <b>scrub</b> or <b>zpool</b> <b>scrub</b> <b>-e</b> again.

       <b>-w</b>  Wait until scrub has completed before returning.

       <b>-e</b>  Only  scrub  files  with  known  data errors as reported by <b>zpool</b> <b>status</b> <b>-v</b>.  The pool must have been
           scrubbed at least once with the <b>head_errlog</b> feature enabled to  use  this  option.   Error  scrubbing
           cannot  be run simultaneously with regular scrubbing or resilvering, nor can it be run when a regular
           scrub is paused.

       <b>-C</b>  Continue scrub from last saved txg (see zpool <b>last_scrubbed_txg</b> property).

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Example</b> <b>1</b>
       Status of pool with ongoing scrub:

       # <b>zpool</b> <b>status</b>
         ...
         scan: scrub in progress since Sun Jul 25 16:07:49 2021
               403M / 405M scanned at 100M/s, 68.4M / 405M issued at 10.0M/s
               0B repaired, 16.91% done, 00:00:04 to go
         ...

       Where metadata which references 403M of file data has been scanned at 100M/s, and 68.4M of that file data
       has been scrubbed sequentially at 10.0M/s.

</pre><h4><b>PERIODIC</b> <b>SCRUB</b></h4><pre>
       On machines using systemd, scrub timers can be enabled on per-pool basis.  <b>weekly</b> and <b>monthly</b> timer units
       are provided.

               <b>systemctl</b> <b>enable</b> <b>zfs-scrub-</b><u>weekly</u><b>@</b><u>rpool</u><b>.timer</b> <b>--now</b>

               <b>systemctl</b> <b>enable</b> <b>zfs-scrub-</b><u>monthly</u><b>@</b><u>otherpool</u><b>.timer</b> <b>--now</b>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>systemd.timer</u>(<b>5</b>)<b>,</b> <u>zpool-iostat</u>(<b>8</b>)<b>,</b> <u>zpool-resilver</u>(<b>8</b>)<b>,</b> <u>zpool-status</u>(<b>8</b>)

OpenZFS                                         November 18, 2024                                 <u><a href="../man8/ZPOOL-SCRUB.8.html">ZPOOL-SCRUB</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>