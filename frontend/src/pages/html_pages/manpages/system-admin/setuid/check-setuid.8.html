<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>check-setuid - check for changes to setuid programs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/checksecurity">checksecurity_2.0.18_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       check-setuid - check for changes to setuid programs

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>check-setuid</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>check-setuid</b>  is  a  plugin  run  by  the  <b>checksecurity</b> command. It scans the mounted files systems
       (subject to the filter defined in /etc/checksecurity.conf) and compares the list of  setuid  programs  to
       the  list  created  on the previous run. Any changes are printed to standard output. Also, it generates a
       list of <u>nfs</u> and <u>afs</u> filesystems that are mounted insecurely (i.e. they are missing the <u>nodev</u>  and  either
       the <u>noexec</u> or <u>nosuid</u> flags).

       <b>checksecurity</b> is run by <b>cron</b> on a daily basis, and the output stored in /var/log/setuid/setuid.changes.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       The    <b>checksecurity.conf</b>   file   defines   several   configuration   variables:   <b>CHECKSECURITY_FILTER</b>,
       <b>CHECKSECURITY_NOFINDERRORS</b>,  <b>CHECKSECURITY_NONFSAFS</b>,   <b>CHECKSECURITY_EMAIL</b>,   <b>CHECKSECURITY_DEVICEFILTER</b>,
       <b>CHECKSECURITY_PATHFILTER</b>, and <b>LOGDIR</b>.  Each is described below.

       The  <b>CHECKSECURITY_FILTER</b>  environment variable which is the argument of 'grep -vE' applied to the output
       of the <b>mount</b> command. In other words, the value of <b>CHECKSECURITY_FILTER</b>  is  a  regular  expression  that
       removes  matching  lines from those file systems that will be scanned. The default value removes all file
       systems of type <u>proc,</u> <u>bind,</u> <u>msdos,</u> <u>iso9660,</u> <u>ncpfs,</u> <u>nfs,</u>  <u>afs,</u>  <u>smbfs,</u>  <u>auto,</u>  <u>ntfs,</u>  <u>coda</u>  file  systems,
       anything  mounted  on <a href="file:/dev/fd">/dev/fd</a>*, anything mounted on <a href="file:/mnt">/mnt</a> or /amd, and anything mounted with option nosuid
       or noexec.

       The <b>checksecurity.conf</b> file is sourced from <b>checksecurity,</b> so you could do some fairly tricky  things  to
       define <b>CHECKSECURITY_FILTER</b>.

       The  <b>CHECKSECURITY_NOFINDERRORS</b>  environment variable, if set to the literal "TRUE", disables find errors
       from checksecurity (actually, it re-routes them to <b>/dev/null</b> ).

       The <b>CHECKSECURITY_NONFSAFS</b> environment variable, if set to the literal "TRUE", disables the message about
       <u>nfs</u> and <u>afs</u> file systems that are mounted without the <u>nodev</u> and either the <u>noexec</u> or <u>nosuid</u> options.

       If set, the <b>CHECKSECURITY_EMAIL</b> variable defines who is sent a copy of the setuid.changes file.

       The <b>CHECKSECURITY_DEVICEFILTER</b> variable specifies a <b>find</b> clause for which matching  block  and  character
       device files will not be monitored for changing owners and permissions. For example, if you don't want to
       check for permission changes on tty device files beneath <a href="file:/dev">/dev</a>, you could set the following:

              CHECKSECURITY_DEVICEFILTER='-path /dev/tty*'

       Note  that  any  added  or modified suid programs under that path would still be detected. If you want to
       specify multiple expressions, separate them with '-o', but there is no need to surround the whole  clause
       with parentheses. To disable this filter, specify it as '-false' (which is the default).

       Note  that  if  the  system  gets restarted often checksecurity will report a lot of changes in the <a href="file:/dev/">/dev/</a>
       subdirectory due to timestamp changes. In this case you might want to change it to:

              CHECKSECURITY_DEVICEFILTER='-path <a href="file:/dev/">/dev/</a>'

       The <b>CHECKSECURITY_PATHFILTER</b> variable specifies a <b>find</b> clause which will be pruned from the search  path.
       <b>This</b> <b>means</b> <b>that</b> <b>the</b> <b>entire</b> <b>subtree</b> <b>will</b> <b>be</b> <b>completely</b> <b>skipped.</b>  Thus, specifying

              CHECKSECURITY_PATHFILTER='-path /var/ftp'

       then  the  entire /var/ftp tree will be skipped. To disable this filter, specify it as '-false' (which is
       the default).

       <b>LOGDIR</b> sets the name of the directory which stores the files which track  the  permission  and  ownership
       changes. By default, they are in <b>/var/log/setuid</b>.

</pre><h4><b>FILES</b></h4><pre>
       <u>/etc/checksecurity.conf</u>
              checksecurity configuration file

       <u>/var/log/setuid/setuid.today</u>
              setuid files from the most recent run

       <u>/var/log/setuid/setuid.yesterday</u>
              setuid files from the previous run

Debian Linux                                     2 February 1997                                <u><a href="../man8/CHECKS-SETUID.8.html">CHECKS-SETUID</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>