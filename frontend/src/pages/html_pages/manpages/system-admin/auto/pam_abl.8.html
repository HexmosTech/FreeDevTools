<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_abl - PAM Auto Blacklist Module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-abl">libpam-abl_0.6.0-7build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_abl - PAM Auto Blacklist Module

</pre><h4><b>SYNOPSIS</b></h4><pre>
       Provides auto blacklisting of hosts and users responsible for repeated failed authentication attempts.
       Generally configured so that blacklisted users still see normal login prompts but are guaranteed to fail
       to authenticate.

       This functionality is only available to services which call PAM as root. If pam_abl is called for uid !=
       0 it will silently succeed.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Brute force password discovery attacks involve repeated attempts to authenticate against a service using
       a dictionary of common passwords. While it is desirable to enforce strong passwords for users this is not
       always possible and in cases where a weak password has been used brute force attacks can be effective.

       The pam_abl module monitors failed authentication attempts and automatically blacklists those hosts (and
       accounts) that are responsible for large numbers of failed attempts. Once a host is blacklisted it is
       guaranteed to fail authentication even if the correct credentials are provided.

       Blacklisting is triggered when the number of failed authentication attempts in a particular period of
       time exceeds a predefined limit. Hosts which stop attempting to authenticate will, after a period of
       time, be un-blacklisted.

       Commands can be specified which will be run when a host or user switches state from being blocked to
       clear or clear to blocked. See below or the <a href="../man5/pam_abl.conf.5.html">pam_abl.conf</a>(5) manpage for the details.

       If pam_abl is called for uid != 0 it will silently succeed. If this was not the case it would be possible
       for a malicious local user to poison the pam_abl data by, for example, discovering the names of the hosts
       from which root typically logs in and then constructing PAM authentication code to lock out root login
       attempts from those hosts.

</pre><h4><b>OPTIONS</b></h4><pre>
       <u>Name</u>              <u>Arguments</u>                      <u>Description</u>

       <b>debug</b>             None                           Enable debug output to
                                                        syslog.

       <b>expose_account</b>    None                           Ignored

       <b>no_warn</b>           None                           Disable warnings which are
                                                        otherwise output to syslog.
                                                        try_first_pass None Ignored

       <b>use_first_pass</b>    None                           Ignored

       <b>use_mapped_pass</b>   None                           Ignored

       <b>config</b>            Path to the configuration      The configuration file
                         file.                          contains additional
                                                        arguments. In order for the
                                                        pam_abl command line tool to
                                                        work correctly most of the
                                                        configuration should be
                                                        placed in the config file
                                                        rather than being provided
                                                        by arguments. The format of
                                                        the config file is described
                                                        below.

       <b>limits</b>            Minimum and maximum number     It’s value should have the
                         of attempts to keep.           following syntax
                                                        "&lt;minimum&gt;-&lt;maximum&gt;". If
                                                        you do not block machines
                                                        that do too many attempts,
                                                        the db can easily become
                                                        bloated. To prevent this we
                                                        introduced this setting. As
                                                        soon as there are a
                                                        &lt;maximum&gt; number of attempts
                                                        for a user/host, the number
                                                        of stored attempts is
                                                        reduced to &lt;minimum&gt;. A
                                                        &lt;maximum&gt; of 0 means no
                                                        limits. Make sure that
                                                        &lt;minimum&gt; is larger then any
                                                        rule specified. We recommend
                                                        a value of "1000-1200".

       <b>db_home</b>           Directory for db locking and   Path to a directory where
                         logging files.                 Berkeley DB can place it’s
                                                        locking and logging files.
                                                        Make sure this dir is
                                                        writable.

       <b>host_db</b>           Path to host database file.    Path to the Berkeley DB
                                                        which is used to log the
                                                        host responsible for failed
                                                        authentication attempts.

       <b>host_purge</b>        Purge time for the host        Defines how long failed
                         database.                      hosts are retained in the
                                                        host database. Defaults to 1
                                                        day.

       <b>host_rule</b>         Rule for host blacklisting.    The rule (see below for
                                                        format) which defines the
                                                        conditions under which a
                                                        failed hosts will be
                                                        blackisted.

       <b>host_whitelist</b>    Host that do not need to be    ;-seperated list of host
                         tracked.                       that do not need to be
                                                        tracked. You can specify
                                                        single IP addresses here or
                                                        use subnets. For example
                                                        1.1.1.1 or 1.1.1.1/24

       <b>host_blk_cmd</b>      Host block command             Deprecated for security
                                                        reasons. Please use
                                                        host_block_cmd

       <b>host_clr_cmd</b>      Host clear command             Deprecated for security
                                                        reasons. Please use
                                                        host_clear_cmd

       <b>host_block_cmd</b>    Host block command             Command that should be run
                                                        when a host is checked, and
                                                        is currently blocked. Within
                                                        the command, the strings %u,
                                                        %h and %s are substituted
                                                        with username, host and
                                                        service. Not all need to be
                                                        used. Please see the manpage
                                                        of pam_abl.conf for the
                                                        correct syntax.

       <b>host_clear_cmd</b>    Host clear command             Command that should be run
                                                        when a host is checked, and
                                                        is currently clear. Within
                                                        the command, the strings %u,
                                                        %h and %s are substituted
                                                        with username, host and
                                                        service. Not all need to be
                                                        used. Please see the manpage
                                                        of pam_abl.conf for the
                                                        correct syntax.

       <b>user_db</b>           Path to user database file.    Path to the Berkeley DB
                                                        which is used to log the
                                                        user responsible for failed
                                                        authentication attempts.

       <b>user_purge</b>        Purge time for the user        Defines how long failed
                         database.                      users are retained in the
                                                        user database. Defaults to 1
                                                        day.

       <b>user_rule</b>         Rule for user blacklisting.    The rule (see below for
                                                        format) which defines the
                                                        conditions under which a
                                                        failed users will be
                                                        blackisted.

       <b>user_whitelist</b>    Users that do not need to be   ;-seperated list of users
                         tracked.                       whose attempts do not need
                                                        to be recorded. This does
                                                        not prevent the machine they
                                                        are using from being
                                                        blocked.

       <b>user_blk_cmd</b>      User block command             Deprecated for security
                                                        reasons. Please use
                                                        user_block_cmd

       <b>user_clr_cmd</b>      User clear command             Deprecated for security
                                                        reasons. Please use
                                                        clear_block_cmd

       <b>user_blk_cmd</b>      User block command             Command that should be run
                                                        when a user is checked, and
                                                        is currently blocked. Within
                                                        the command, the strings %u,
                                                        %h and %s are substituted
                                                        with username, host and
                                                        service. Not all need to be
                                                        used.

       <b>user_clr_cmd</b>      User block command             Command that should be run
                                                        when a user is checked, and
                                                        is currently clear. Within
                                                        the command, the strings %u,
                                                        %h and %s are substituted
                                                        with username, host and
                                                        service. Not all need to be
                                                        used.

</pre><h4><b>USAGE</b></h4><pre>
       Typically pam_abl.so is added to the auth stack as a required module just before whatever modules
       actually perform authentication. Here’s a fragment of the PAM config for a production server that is
       running pam_abl:

           auth required   /lib/security/pam_env.so
           auth required   /lib/security/pam_abl.so
                           config=/etc/security/pam_abl.conf
           auth sufficient /lib/security/pam_unix.so likeauth nullok
           auth required   /lib/security/pam_deny.so

       Although all of accepted arguments can be supplied here they will usually be placed in a separate config
       file and linked to using the config argument as in the above example. The pam_abl command line tool reads
       the external config file (/etc/security/pam_abl.conf in this case) to find the databases so in order for
       it work correctly an external config should be used.

</pre><h4><b>EXAMPLES</b></h4><pre>
           auth required /lib/security/pam_env.so
           auth required /lib/security/pam_abl.so config=/etc/security/pam_abl.conf
           auth sufficient /lib/security/pam_unix.so likeauth nullok
           auth required /lib/security/pam_deny.so

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man5/pam_abl.conf.5.html">pam_abl.conf</a>(5), <a href="../man1/pam_abl.1.html">pam_abl</a>(1)

</pre><h4><b>AUTHORS</b></h4><pre>
       Lode Mertens &lt;<a href="mailto:pam-abl@danta.be">pam-abl@danta.be</a>&gt;

       Andy Armstrong &lt;<a href="mailto:andy@hexten.net">andy@hexten.net</a>&gt;

       Chris Tasma &lt;<a href="mailto:pam-abl@deksai.com">pam-abl@deksai.com</a>&gt;

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>Chris</b> <b>Tasma</b>
           Author.

GNU                                                03/31/2024                                         <u><a href="../man8/PAM_ABL.8.html">PAM_ABL</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>