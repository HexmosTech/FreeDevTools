<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fence_scsi - Fence agent for SCSI persistent reservation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/fence-agents-scsi">fence-agents-scsi_4.16.0-3ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fence_scsi - Fence agent for SCSI persistent reservation

</pre><h4><b>DESCRIPTION</b></h4><pre>
       fence_scsi  is  an I/O Fencing agent that uses SCSI-3 persistent reservations to control access to shared
       storage devices. These devices must support SCSI-3 persistent reservations (SPC-3 or greater) as well  as
       the  "preempt-and-abort"  subcommand.   The  fence_scsi  agent  works  by having each node in the cluster
       register a unique key with the SCSI device(s). Reservation key is generated from "node id"  (default)  or
       from "node name hash" (RECOMMENDED) by adjusting "key_value" option. Using hash is recommended to prevent
       issues when removing nodes from cluster without full cluster restart. Once registered, a single node will
       become  the  reservation  holder  by  creating  a  "write exclusive, registrants only" reservation on the
       device(s). The result is that only registered nodes may write to  the  device(s).  When  a  node  failure
       occurs,  the  fence_scsi  agent  will remove the key belonging to the failed node from the device(s). The
       failed node will no longer be able to write to the device(s). A manual reboot is required.

       When used as a watchdog device you can define e.g. retry=1, retry-sleep=2 and verbose=yes  parameters  in
       /etc/sysconfig/stonith if you have issues with it failing.

       The  fence  agent  accepts  options  on  the  command line as well as from stdin. Fenced sends parameters
       through stdin when it execs the agent. The agent can be run by itself with command line options.  This is
       useful for testing and for turning outlets on or off from scripts.

       Vendor URL:

</pre><h4><b>PARAMETERS</b></h4><pre>

       <b>-o,</b> <b>--action=[action]</b>
              Fencing action (Default Value: off)

       <b>-a,</b> <b>--aptpl</b>
              Use the APTPL flag for registrations. This option is only used for the 'on' action.

       <b>-d,</b> <b>--devices=[devices]</b>
              List of devices to use for current operation. Devices can be comma or space separated list of  raw
              devices  (eg.  /dev/sdc).  Each  device  must  support SCSI-3 persistent reservations. Optional if
              cluster is configured with clvm or lvmlockd.

       <b>-k,</b> <b>--key=[key]</b>
              Key to use for the current operation. This key should be unique to a node. For  the  "on"  action,
              the key specifies the key use to register the local node. For the "off" action, this key specifies
              the key to be removed from the device(s).

       <b>-n,</b> <b>--plug=[nodename]</b>
              Name  of  the  node  to  be  fenced.  The node name is used to generate the key value used for the
              current operation. This option will be ignored when used with the -k  option.  This  parameter  is
              always required.

       <b>--readonly</b>
              Open DEVICE read-only.

       <b>--suppress-errors</b>
              Error log suppression.

       <b>-f,</b> <b>--logfile</b>
              Log output (stdout and stderr) to file

       <b>-q,</b> <b>--quiet</b>
              Disable logging to stderr. Does not affect --verbose or --debug-file or logging to syslog.

       <b>-v,</b> <b>--verbose</b>
              Verbose  mode.  Multiple  -v  flags  can  be  stacked on the command line (e.g., -vvv) to increase
              verbosity.

       <b>--verbose-level</b>
              Level of debugging detail in output. Defaults to the number of --verbose flags  specified  on  the
              command  line,  or  to  1  if verbose=1 in a stonith device configuration (i.e., on stdin).

       <b>-D,</b> <b>--debug-file=[debugfile]</b>
              Write debug information to given file

       <b>-V,</b> <b>--version</b>
              Display version information and exit

       <b>-h,</b> <b>--help</b>
              Display help and exit

       <b>--plug-separator=[char]</b>
              Separator for plug parameter when specifying more than 1 plug (Default Value: ,)

       <b>--delay=[seconds]</b>
              Wait X seconds before fencing is started (Default Value: 0)

       <b>--disable-timeout=[true/false]</b>
              Disable timeout (true/false) (default: true when run from Pacemaker 2.0+)

       <b>--login-timeout=[seconds]</b>
              Wait X seconds for cmd prompt after login (Default Value: 5)

       <b>--power-timeout=[seconds]</b>
              Test X seconds for status change after ON/OFF (Default Value: 20)

       <b>--power-wait=[seconds]</b>
              Wait X seconds after issuing ON/OFF (Default Value: 0)

       <b>--shell-timeout=[seconds]</b>
              Wait X seconds for cmd prompt after issuing command (Default Value: 3)

       <b>--stonith-status-sleep=[seconds]</b>
              Sleep X seconds between status calls during a STONITH action (Default Value: 1)

       <b>--retry-on=[attempts]</b>
              Count of attempts to retry power on (Default Value: 1)

       <b>--corosync-cmap-path=[path]</b>
              Path to corosync-cmapctl binary (Default Value: /usr/sbin/corosync-cmapctl)

       <b>--key-value=&lt;id|hash&gt;</b>
              Method used to generate the SCSI key. "id" (default) uses the positional ID from  "corosync-cmactl
              nodelist"  output  which  can  get  inconsistent  when nodes are removed from cluster without full
              cluster restart. "hash" uses part of hash made out of node names which is not affected  over  time
              but  there  is  theoretical  chance  that hashes can collide as size of SCSI key is quite limited.
              (Default Value: id)

       <b>--sg_persist-path=[path]</b>
              Path to sg_persist binary (Default Value: <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sg_persist">/usr/bin/sg_persist</a>)

       <b>--sg_turs-path=[path]</b>
              Path to sg_turs binary (Default Value: <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sg_turs">/usr/bin/sg_turs</a>)

       <b>--vgs-path=[path]</b>
              Path to vgs binary (Default Value: <a href="file:/sbin/vgs">/sbin/vgs</a>)

</pre><h4><b>ACTIONS</b></h4><pre>

       <b>on</b>     Power on machine.

       <b>off</b>    Power off machine.

       <b>status</b> This returns the status of the plug/virtual machine.

       <b>monitor</b>
              Check the health of fence device

       <b>metadata</b>
              Display the XML metadata describing this resource.

       <b>manpage</b>
               The operational behavior of this is not known.

       <b>validate-all</b>
              Validate if all required parameters are entered.

</pre><h4><b>STDIN</b> <b>PARAMETERS</b></h4><pre>

       <b>action</b> Fencing action (Default Value: off)

       <b>aptpl</b>  Use the APTPL flag for registrations. This option is only used for the 'on' action.

       <b>devices</b>
              List of devices to use for current operation. Devices can be comma or space separated list of  raw
              devices  (eg.  /dev/sdc).  Each  device  must  support SCSI-3 persistent reservations. Optional if
              cluster is configured with clvm or lvmlockd.

       <b>key</b>    Key to use for the current operation. This key should be unique to a node. For  the  "on"  action,
              the key specifies the key use to register the local node. For the "off" action, this key specifies
              the key to be removed from the device(s).

       <b>plug</b>   Name  of  the  node  to  be  fenced.  The node name is used to generate the key value used for the
              current operation. This option will be ignored when used with the -k  option.  This  parameter  is
              always required. Obsoletes: port

       <b>readonly</b>
              Open DEVICE read-only.

       <b>suppress_errors</b>
              Error log suppression. Obsoletes: suppress-errors

       <b>logfile</b>
              Log output (stdout and stderr) to file

       <b>quiet</b>  Disable logging to stderr. Does not affect --verbose or --debug-file or logging to syslog.

       <b>verbose</b>
              Verbose  mode.  Multiple  -v  flags  can  be  stacked on the command line (e.g., -vvv) to increase
              verbosity.

       <b>verbose_level</b>
              Level of debugging detail in output. Defaults to the number of --verbose flags  specified  on  the
              command  line,  or  to  1  if verbose=1 in a stonith device configuration (i.e., on stdin).

       <b>debug_file</b>
              Write debug information to given file Obsoletes: debug

       <b>version</b>
              Display version information and exit

       <b>help</b>   Display help and exit

       <b>plug_separator</b>
              Separator for plug parameter when specifying more than 1 plug (Default Value: ,)

       <b>delay</b>  Wait X seconds before fencing is started (Default Value: 0)

       <b>disable_timeout</b>
              Disable timeout (true/false) (default: true when run from Pacemaker 2.0+)

       <b>login_timeout</b>
              Wait X seconds for cmd prompt after login (Default Value: 5)

       <b>power_timeout</b>
              Test X seconds for status change after ON/OFF (Default Value: 20)

       <b>power_wait</b>
              Wait X seconds after issuing ON/OFF (Default Value: 0)

       <b>shell_timeout</b>
              Wait X seconds for cmd prompt after issuing command (Default Value: 3)

       <b>stonith_status_sleep</b>
              Sleep X seconds between status calls during a STONITH action (Default Value: 1)

       <b>retry_on</b>
              Count of attempts to retry power on (Default Value: 1)

       <b>corosync_cmap_path</b>
              Path to corosync-cmapctl binary (Default Value: /usr/sbin/corosync-cmapctl)

       <b>key_value</b>
              Method used to generate the SCSI key. "id" (default) uses the positional ID from  "corosync-cmactl
              nodelist"  output  which  can  get  inconsistent  when nodes are removed from cluster without full
              cluster restart. "hash" uses part of hash made out of node names which is not affected  over  time
              but  there  is  theoretical  chance  that hashes can collide as size of SCSI key is quite limited.
              (Default Value: id)

       <b>sg_persist_path</b>
              Path to sg_persist binary (Default Value: <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sg_persist">/usr/bin/sg_persist</a>)

       <b>sg_turs_path</b>
              Path to sg_turs binary (Default Value: <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sg_turs">/usr/bin/sg_turs</a>)

       <b>vgs_path</b>
              Path to vgs binary (Default Value: <a href="file:/sbin/vgs">/sbin/vgs</a>)

fence_scsi (Fence Agent)                           2009-10-20                                     <u><a href="../man8/FENCE_AGENT.8.html">FENCE_AGENT</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>