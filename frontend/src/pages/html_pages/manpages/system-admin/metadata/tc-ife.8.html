<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IFE - encapsulate/decapsulate metadata</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/iproute2">iproute2_6.14.0-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       IFE - encapsulate/decapsulate metadata

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>tc</b> ...  <b>action</b> <b>ife</b> <u>DIRECTION</u> [ <u>ACTION</u> ] [ <b>dst</b> <u>DMAC</u> ] [ <b>src</b> <u>SMAC</u> ] [ <b>type</b> <u>TYPE</u> ] [ <u>CONTROL</u> ] [ <b>index</b> <u>INDEX</u>
               ]

       <u>DIRECTION</u> := { <b>decode</b> | <b>encode</b> }

       <u>ACTION</u> := { <b>allow</b> <u>ATTR</u> | <b>use</b> <u>ATTR</u> <u>value</u> }

       <u>ATTR</u> := { <b>mark</b> | <b>prio</b> | <b>tcindex</b> }

       <u>CONTROL</u> := { <b>reclassify</b> | <b>use</b> | <b>pipe</b> | <b>drop</b> | <b>continue</b> | <b>ok</b> | <b>goto</b> <b>chain</b> <b>CHAIN_INDEX</b> }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>ife</b> action allows for a sending side to encapsulate arbitrary metadata, which is then decapsulated by
       the  receiving  end.  The  sender  runs in encoding mode and the receiver in decode mode. Both sender and
       receiver must specify the same ethertype. In the future, a registered ethertype may  be  available  as  a
       default.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>decode</b> For the receiving side; decode the metadata if the packet matches.

       <b>encode</b> For the sending side. Encode the specified metadata if the packet matches.

       <b>allow</b>  Encode direction only. Allows encoding specified metadata.

       <b>use</b>    Encode direction only. Enforce static encoding of specified metadata.

       <b>mark</b> [ <u>u32_value</u>  ]  The  value  to  set  for  the  skb  mark. The u32 value is required only when <b>use</b> is
              specified. If <b>mark</b> value is  zero,  it  will  not  be  encoded,  instead  "overlimits"  statistics
              increment and <b>CONTROL</b> action is taken.

       <b>prio</b> [ <u>u32_value</u>  ]  The  value  to set for priority in the skb structure. The u32 value is required only
              when <b>use</b> is specified.

       <b>tcindex</b> [
              <u>u16_value</u> ] Value to set for the traffic control index in the skb  structure.  The  u16  value  is
              required only when <b>use</b> is specified.

       <b>dmac</b> <u>DMAC</u>
       <b>smac</b> <u>SMAC</u>
              Optional six byte destination or source MAC address to encode.

       <b>type</b> <u>TYPE</u>
              Optional 16-bit ethertype to encode. If not specified value of 0xED3E will be used.

       <b>CONTROL</b>
              Action to take following an encode/decode.

       <b>index</b> <u>INDEX</u>
              Assign  a  unique ID to this action instead of letting the kernel choose one automatically.  <u>INDEX</u>
              is a 32bit unsigned integer greater than zero.

</pre><h4><b>EXAMPLES</b></h4><pre>
       On the receiving side, match packets with ethertype 0xdead and restart classification  so  that  it  will
       match ICMP on the next rule, at prio 3:
              # tc qdisc add dev eth0 handle ffff: ingress
              # tc filter add dev eth0 parent ffff: prio 2 protocol 0xdead \
                   u32 match u32 0 0 flowid 1:1 \
                   action ife decode reclassify
              # tc filter add dev eth0 parent ffff: prio 3 protocol ip \
                   u32 match ip protocol 0xff flowid 1:1 \
                   action continue

       Match with skb mark of 17:

              # tc filter add dev eth0 parent ffff: prio 4 protocol ip \
                   handle 0x11 fw flowid 1:1 \
                   action ok

       Configure  the  sending  side  to  encode  for  the  filters  above.  Use  a  destination  IP  address of
       192.168.122.237/24, then tag with skb mark of decimal 17. Encode the packet with  ethertype  0xdead,  add
       skb-&gt;mark  to  allowed  list  of  meta  datum  to  send,  and  rewrite  the  destination  MAC  address to
       02:15:15:15:15:15.

              # tc qdisc add dev eth0 root handle 1: prio
              # tc filter add dev eth0 parent 1: protocol ip prio 10 u32 \
                   match ip dst 192.168.122.237/24 \
                   match ip protocol 1 0xff \
                   flowid 1:2 \
                   action skbedit mark 17 \
                   action ife encode \
                   type 0xDEAD \
                   allow mark \
                   dst 02:15:15:15:15:15

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/tc.8.html">tc</a></b>(8), <b><a href="../man8/tc-u32.8.html">tc-u32</a></b>(8)

iproute2                                           22 Apr 2016                               <u>IFE</u> <u>action</u> <u>in</u> <u><a href="../man8/tc.8.html">tc</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>