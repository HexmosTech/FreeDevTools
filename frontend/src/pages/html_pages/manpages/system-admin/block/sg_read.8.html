<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sg_read - read multiple blocks of data, optionally with SCSI READ commands</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/sg3-utils">sg3-utils_1.48-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sg_read - read multiple blocks of data, optionally with SCSI READ commands

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>sg_read</b>  [<u>blk_sgio=</u>0|1]  [<u>bpt=BPT</u>]  [<u>bs=BS</u>]  [<u>cdbsz=</u>6|10|12|16] <u>count=COUNT</u> [<u>dio=</u>0|1] [<u>dpo=</u>0|1] [<u>fua=</u>0|1]
       <u>if=IFILE</u> [<u>mmap=</u>0|1] [<u>no_dxfer=</u>0|1] [<u>odir=</u>0|1] [<u>skip=SKIP</u>] [<u>time=TI</u>] [<u>verbose=VERB</u>] [<u>--help</u>] [<u>--version</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Read data from a Linux SCSI generic (sg) device, a block device or a normal file with each  read  command
       issued  to  the  same  offset  or  logical  block  address (lba). This can be used to test (or time) disk
       caching, SCSI (or some other) transport throughput, and/or SCSI command overhead.

       When the <u>COUNT</u> value is positive, then up to <u>BPT</u> blocks are read at a time, until the <u>COUNT</u> is exhausted.
       Each read operation starts at the same lba which, if <u>SKIP</u> is not given, is the beginning of the  file  or
       device.

       The  <u>COUNT</u>  value  may  be negative when <u>IFILE</u> is a sg device or is a block device with 'blk_sgio=1' set.
       Alternatively 'bpt=0' may be given. In these cases |<u>COUNT</u>| "zero block" SCSI READ  commands  are  issued.
       "Zero  block"  means  "do  nothing"  for  SCSI  READ  10, 12 and 16 byte commands (but not for the 6 byte
       variant). In practice "zero block" SCSI READ commands have low latency and so are one way to measure SCSI
       command overhead.

       Please note: this is a very old utility that uses 32 bit integers for disk LBAs and the count.  Hence  it
       will  not  be  able  to address beyond 2 Terabytes on a disk with logical blocks that are 512 bytes long.
       Alternatives are the sg_dd and ddpt utilities.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>blk_sgio</b>=0 | 1
              The default action of this utility is to use the Unix read() command when the  <u>IFILE</u>  is  a  block
              device.  In lk 2.6 many block devices can handle SCSI commands issued via the SG_IO ioctl. So when
              this option is set the SG_IO ioctl sends SCSI READ commands to <u>IFILE</u> if it is a block device.

       <b>bpt</b>=<u>BPT</u>
              where <u>BPT</u> is the maximum number of blocks each read  operation  fetches.   Fewer  blocks  will  be
              fetched  when  the  remaining  <u>COUNT</u> is less than <u>BPT</u>. The default value for <u>BPT</u> is 128. Note that
              each read operation starts at the same lba (as given by <u>skip=SKIP</u> or  0).   If  'bpt=0'  then  the
              <u>COUNT</u> is interpreted as the number of zero block SCSI READ commands to issue.

       <b>bs</b>=<u>BS</u>  where  <u>BS</u>  is  the size (in bytes) of each block read. This <b>must</b> be the block size of the physical
              device (defaults to 512) if SCSI commands are being issued to <u>IFILE</u>.

       <b>cdbsz</b>=6 | 10 | 12 | 16
              size of SCSI READ commands issued on sg device names, or block devices if 'blk_sgio=1'  is  given.
              Default is 10 byte SCSI READ cdbs.

       <b>count</b>=<u>COUNT</u>
              when  <u>COUNT</u>  is  a  positive  number,  read  that  number  of blocks, typically with multiple read
              operations. When <u>COUNT</u> is negative then |<u>COUNT</u>| SCSI READ commands are performed  requesting  zero
              blocks to be transferred. This option is mandatory.

       <b>dio</b>=0 | 1
              default  is  0  which  selects indirect IO. Value of 1 attempts direct IO which, if not available,
              falls back to indirect IO and notes this at completion. This option is only active if <u>IFILE</u> is  an
              sg  device.   If  direct IO is selected and <a href="file:/sys/module/sg/parameters/allow_dio">/sys/module/sg/parameters/allow_dio</a> has the value of 0
              then a warning is issued (and indirect IO is performed)

       <b>dpo</b>=0 | 1
              when set the disable page out (DPO) bit in SCSI READ commands is set.  Otherwise the  DPO  bit  is
              cleared (default).

       <b>fua</b>=0 | 1
              when  set  the force unit access (FUA) bit in SCSI READ commands is set.  Otherwise the FUA bit is
              cleared (default).

       <b>if</b>=<u>IFILE</u>
              read from this <u>IFILE</u>. This argument must be given. If the <u>IFILE</u> is a normal file then it  must  be
              seekable  (if  (<u>COUNT</u> &gt; <u>BPT</u>) or <u>skip=SKIP</u> is given). Hence stdin is not acceptable (and giving "-"
              as the <u>IFILE</u> argument is reported as an error).

       <b>mmap</b>=0 | 1
              default is 0 which selects indirect IO. Value of 1  causes  memory  mapped  IO  to  be  performed.
              Selecting both dio and mmap is an error. This option is only active if <u>IFILE</u> is an sg device.

       <b>no_dxfer</b>=0 | 1
              when  set  then  DMA  transfers  from the device are made into kernel buffers but no further (i.e.
              there is no second copy into the user space). The default value is 0 in which case  transfers  are
              made  into  the  user  space.   When neither mmap nor dio is set then data transfer are copied via
              kernel buffers (i.e. a double copy). Mainly for testing.

       <b>odir</b>=0 | 1
              when set opens an <u>IFILE</u> which is a block device with an  additional  O_DIRECT  flag.  The  default
              value is 0 (i.e. don't open block devices O_DIRECT).

       <b>skip</b>=<u>SKIP</u>
              all read operations will start offset by <u>SKIP</u> bs-sized blocks from the start of the input file (or
              device).

       <b>time</b>=<u>TI</u>
              When  <u>TI</u>  is  0  (default)  doesn't  perform  timing.   When 1, times transfer and does throughput
              calculation, starting at the first issued command until completion. When  2,  times  transfer  and
              does  throughput calculation, starting at the second issued command until completion. When 3 times
              from third command, etc. An average number of commands (SCSI READs or Unix read()s)  executed  per
              second is also output.

       <b>verbose</b>=<u>VERB</u>
              as  <u>VERB</u> increases so does the amount of debug output sent to stderr.  Default value is zero which
              yields the minimum amount of debug output.  A value of 1 reports extra  information  that  is  not
              repetitive.

       <b>--help</b> Output the usage message then exit.

       <b>--version</b>
              Output the version string then exit.

</pre><h4><b>NOTES</b></h4><pre>
       Various numeric arguments (e.g. <u>SKIP</u>) may include multiplicative suffixes or be given in hexadecimal. See
       the "NUMERIC ARGUMENTS" section in the <a href="../man8/sg3_utils.8.html">sg3_utils</a>(8) man page.

       Data usually gets to the user space in a 2 stage process: first the SCSI adapter DMAs into kernel buffers
       and  then  the  sg driver copies this data into user memory.  This is called "indirect IO" and there is a
       "dio" option to select "direct IO" which will DMA directly into user memory. Due to some  issues  "direct
       IO"  is disabled in the sg driver and needs a configuration change to activate it. This is typically done
       with "echo 1 &gt; <a href="file:/sys/module/sg/parameters/allow_dio">/sys/module/sg/parameters/allow_dio</a>". An alternate way to avoid the 2  stage  copy  is  to
       select memory mapped IO with 'mmap=1'.

</pre><h4><b>SIGNALS</b></h4><pre>
       The signal handling has been borrowed from dd: SIGINT, SIGQUIT and SIGPIPE output the number of remaining
       blocks to be transferred; then they have their default action.  SIGUSR1 causes the same information to be
       output yet the copy continues.  All output caused by signals is sent to stderr.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Let us assume that /dev/sg0 is a disk and we wish to time the disk's cache performance.

          sg_read if=/dev/sg0 bs=512 count=1MB mmap=1 time=2

       This command will continually read 128  512 byte blocks from block 0.  The "128" is the default value for
       'bpt'  while  "block  0"  is  chosen  because the 'skip' argument was not given. This will continue until
       1,000,000 blocks are read. The idea behind using 'time=2' is that the first 64 KiB  read  operation  will
       involve  reading  the magnetic media while the remaining read operations will "hit" the disk's cache. The
       output of third command will look like this:

         time from second command to end was 4.50 secs, 113.70 MB/sec
         Average number of READ commands per second was 1735.27
         1000000+0 records in, SCSI commands issued: 7813

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       The exit status of sg_read is 0 when it is successful. Otherwise see the <a href="../man8/sg3_utils.8.html">sg3_utils</a>(8) man page.

</pre><h4><b>AUTHORS</b></h4><pre>
       Written by Douglas Gilbert.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;dgilbert at interlog dot com&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright © 2000-2019 Douglas Gilbert
       This software is distributed under the GPL version 2. There is NO warranty; not even for  MERCHANTABILITY
       or FITNESS FOR A PARTICULAR PURPOSE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       To time streaming media read or write time see <b>sg_dd</b> is in the sg3_utils package and <b>ddpt</b> in a package of
       the same name.  The lmbench package contains <b>lmdd</b> which is also interesting.  <b><a href="../man8/raw.8.html">raw</a>(8),</b> <b><a href="../man1/dd.1.html">dd</a>(1)</b>

sg3_utils-1.45                                   September 2019                                       <u><a href="../man8/SG_READ.8.html">SG_READ</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>