<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>idmap_ad - Samba's idmap_ad Backend for Winbind</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/winbind">winbind_4.22.3+dfsg-4ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       idmap_ad - Samba's idmap_ad Backend for Winbind

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The idmap_ad plugin provides a way for Winbind to read id mappings from an AD server that uses
       RFC2307/SFU schema extensions. This module implements only the "idmap" API, and is READONLY. Mappings
       must be provided in advance by the administrator by adding the uidNumber attributes for users and
       gidNumber attributes for groups in the AD. Winbind will only map users that have a uidNumber and whose
       primary group have a gidNumber attribute set. It is however recommended that all groups in use have
       gidNumber attributes assigned, otherwise they are not working.

       Currently, the <u>ad</u> backend does not work as the default idmap backend, but one has to configure it
       separately for each domain for which one wants to use it, using disjoint ranges. One usually needs to
       configure a writeable default idmap range, using for example the <u>tdb</u> or <u>ldap</u> backend, in order to be able
       to map the BUILTIN sids and possibly other trusted domains. The writeable default config is also needed
       in order to be able to create group mappings. This catch-all default idmap configuration should have a
       range that is disjoint from any explicitly configured domain with idmap backend <u>ad</u>. See the example
       below.

</pre><h4><b>IDMAP</b> <b>OPTIONS</b></h4><pre>
       range = low - high
           Defines the available matching UID and GID range for which the backend is authoritative. Note that
           the range acts as a filter. If specified any UID or GID stored in AD that fall outside the range is
           ignored and the corresponding map is discarded. It is intended as a way to avoid accidental UID/GID
           overlaps between local and remotely defined IDs.

       schema_mode = &lt;rfc2307 | sfu | sfu20&gt;
           Defines the schema that idmap_ad should use when querying Active Directory regarding user and group
           information. This can be either the RFC2307 schema support included in Windows Server 2003 R2 and
           newer or the Service for Unix (SFU) schema for versions before Windows Server 2003 R2. For SFU 3.0 or
           3.5 please choose "sfu", for SFU 2.0 please choose "sfu20". Please note that the behavior of primary
           group membership is controlled by the <u>unix_primary_group</u> option.

           Default: rfc2307

       unix_primary_group = yes/no
           Defines whether the user's primary group is fetched from the SFU attributes or the AD primary group.
           If set to <u>yes</u> the primary group membership is fetched from the LDAP attributes (gidNumber). If set to
           <u>no</u> the primary group membership is calculated via the "primaryGroupID" LDAP attribute.

           Default: no

       unix_nss_info = yes/no
           If set to <u>yes</u> winbind will retrieve the login shell and home directory from the LDAP attributes. If
           set to <u>no</u> or the AD LDAP entry lacks the SFU attributes the options <u>template</u> <u>shell</u> and <u>template</u>
           <u>homedir</u> are used.

           Default: no

       all_groupmem = yes/no
           If set to <u>yes</u> winbind will retrieve all group members for <a href="../man3/getgrnam.3.html">getgrnam</a>(3), <a href="../man3/getgrgid.3.html">getgrgid</a>(3) and <a href="../man3/getgrent.3.html">getgrent</a>(3)
           calls, including those with missing uidNumber.

           Default: no

       deny ous
           This parameter is a list of OUs from which objects will not be mapped via the ad idmap module. If
           <u>deny</u> <u>ous</u> is set but <u>allow</u> <u>ous</u> is not set, every object outside the OUs listed in <u>deny</u> <u>ous</u> is allowed.

           Default: none

       allow ous
           This parameter is a list of OUs from which objects will be mapped via the ad idmap module. If <u>allow</u>
           <u>ous</u> is set but <u>deny</u> <u>ous</u> is not set, every object outside the OUs <u>allow</u> <u>ous</u> is denied.

           If both <u>allow</u> <u>ous</u> and <u>deny</u> <u>ous</u> are set, <u>deny</u> <u>ous</u> is evaluated first, then <u>allow</u> <u>ous</u> is looked at. If
           an AD object matches neither, it is denied.

           Default: none

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following example shows how to retrieve idmappings from our principal and trusted AD domains. If
       trusted domains are present id conflicts must be resolved beforehand, there is no guarantee on the order
       conflicting mappings would be resolved at this point. This example also shows how to leave a small non
       conflicting range for local id allocation that may be used in internal backends like BUILTIN.

                [global]
                workgroup = CORP

                idmap config * : backend = tdb
                idmap config * : range = 1000000-1999999

                idmap config CORP : backend  = ad
                idmap config CORP : range = 1000-999999

</pre><h4><b>AUTHOR</b></h4><pre>
       The original Samba software and related utilities were created by Andrew Tridgell. Samba is now developed
       by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.

Samba 4.22.3-Ubuntu-4.22.3+dfs                     07/21/2025                                        <u><a href="../man8/IDMAP_AD.8.html">IDMAP_AD</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>