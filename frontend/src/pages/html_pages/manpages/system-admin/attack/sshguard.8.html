<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sshguard - block brute-force attacks by aggregating system logs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/sshguard">sshguard_2.4.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sshguard - block brute-force attacks by aggregating system logs

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>sshguard</b>   [<b>-hv</b>]   [<b>-a</b>   <u>threshold</u>]   [<b>-b</b>  <u>threshold</u>:<u>blacklist_file</u>]  [<b>-i</b>  <u>pidfile</u>]  [<b>-p</b>  <u>blocktime</u>]  [<b>-s</b>
       <u>detection_time</u>] [<b>-w</b> <u>address</u> | <u>whitelist_file</u>] [<u>file</u> ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sshguard</b> protects hosts from brute-force attacks against SSH and other  services.  It  aggregates  system
       logs and blocks repeat offenders using one of several firewall backends.

       <b>sshguard</b>  can  monitor  log  files  and  the standard output of running a shell command. Log messages are
       parsed line-by-line for recognized attack patterns.  Attackers are blocked when  enough  attack  patterns
       are  detected  in  a  configurable  time  interval.  Attackers  are  blocked  temporarily but can also be
       permanently blocked using the blacklist option.

       <b>sshguard</b> must be configured before its first run. See <b><a href="../man7/sshguard-setup.7.html">sshguard-setup</a>(7)</b>.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b> <u>threshold</u> <b>(default</b> <b>30)</b>
              Each detected attack increases an attacker's attack score, usually by 10.   Block  attackers  when
              their attack score exceeds <u>threshold</u>.

       <b>-b</b> <u>threshold</u><b>:</b><u>blacklist_file</u>
              Blacklist  an attacker when its attack score exceeds <u>threshold</u>.  Blacklisted addresses are written
              to <u>blacklist-file</u> and never unblocked, even after restarting <b>sshguard</b>.

       <b>-i</b> <u>pidfile</u>
              Write the PID of <b>sshguard</b> to <u>pidfile</u>. <u>pidfile</u> is removed when <b>sshguard</b> exits.

       <b>-p</b> <u>blocktime</u> <b>(default</b> <b>120)</b>
              Block first-time attackers for <u>blocktime</u> seconds. Subsequent blocks  increase  in  duration  by  a
              factor  of  1.5.  Since <b>sshguard</b> unblocks attackers at random intervals, actual block times may be
              somewhat longer.

       <b>-s</b> <u>detection_time</u> <b>(default</b> <b>1800)</b>
              Reset an attacker's attack score after <u>detection_time</u> seconds since the last  attack.  This  means
              that  attackers who attack every <u>detection_time</u> seconds are never blocked by <b>sshguard</b>. However, an
              increased <u>detection_time</u> may have an impact on legitimate users.

       <b>[-w</b> <u>address</u> <b>|</b> <u>whitelist_file</u><b>]</b>
              Whitelist a single address, hostname, or address block given as <u>address</u>. This option can be  given
              multiple  times.  Alternatively, provide an absolute path to a <u>whitelist_file</u> containing addresses
              to whitelist. See <u>WHITELISTING</u>.

       <b>-h</b>     Print usage information and exit.

       <b>-v</b>     Print version information and exit.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       <b>SSHGUARD_DEBUG</b>
              Set to enable verbose output from <b>sshg-blocker</b>.

</pre><h4><b>FILES</b></h4><pre>
       <b>%PREFIX%/etc/sshguard.conf</b>
              See sample configuration file.

</pre><h4><b>WHITELISTING</b></h4><pre>
       Whitelisted addresses are never blocked. Addresses can be specified on the command line or be stored in a
       file.

       On the command line, give the <b>-w</b> option one or more times with an IP  address,  CIDR  address  block,  or
       hostname  as  an  argument.  Hostnames  are  resolved once at startup. If a hostname resolves to multiple
       addresses, all of them are whitelisted. For example:

          sshguard -w 192.168.1.10 -w 192.168.0.0/24 -w friend.example.com
              -w 2001:0db8:85a3:0000:0000:8a2e:0370:7334
              -w 2002:836b:4179::836b:0000/126

       If the argument to <b>-w</b> begins with a forward slash ('/') or dot ('.'), the argument is treated as the path
       to a whitelist file.

       The whitelist file contains comments (lines beginning with '#'), addresses, address blocks, or hostnames,
       one per line.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man7/sshguard-setup.7.html">sshguard-setup</a>(7)

2.4                                              March 16, 2021                                      <u><a href="../man8/SSHGUARD.8.html">SSHGUARD</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>