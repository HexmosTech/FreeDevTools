<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>setuids.bt - Trace setuid family of syscalls. Uses bpftrace/eBPF.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bpftrace">bpftrace_0.23.2-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       setuids.bt - Trace setuid family of syscalls. Uses bpftrace/eBPF.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>setuids.bt</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  tool  traces  privilege  escalation  via  setuid syscalls, and can be used for debugging, whitelist
       creation, and intrusion detection.

       It works by tracing the <a href="../man2/setuid.2.html">setuid</a>(2), <a href="../man2/setfsuid.2.html">setfsuid</a>(2), and <a href="../man2/retresuid.2.html">retresuid</a>(2) syscalls using the syscall tracepoints.

       Since this uses BPF, only the root user can use this tool.

</pre><h4><b>REQUIREMENTS</b></h4><pre>
       CONFIG_BPF and bpftrace.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Trace setuid syscalls:
              # <b>setuids.bt</b>

</pre><h4><b>FIELDS</b></h4><pre>
       PID    The calling process ID.

       COMM   The calling process (thread) name.

       UID    The UID of the caller.

       SYSCALL
              The syscall name.

       ARGS   The arguments to the syscall

       (RET)  The return value for the syscall: 0 == success, other numbers indicate an error code.

</pre><h4><b>OVERHEAD</b></h4><pre>
       setuid calls are expected to be low frequency (&lt;&lt; 100/s), so the overhead of this tool is expected to  be
       negligible.

</pre><h4><b>SOURCE</b></h4><pre>
       This tool originated from the book "BPF Performance Tools", published by Addison Wesley (2019):

              <a href="http://www.brendangregg.com/bpf-performance-tools-book.html">http://www.brendangregg.com/bpf-performance-tools-book.html</a>

       See the book for more documentation on this tool.

       This version is in the bpftrace repository:

              https://github.com/bpftrace/bpftrace

       Also  look  in  the  bpftrace  distribution  for a companion _examples.txt file containing example usage,
       output, and commentary for this tool.

</pre><h4><b>OS</b></h4><pre>
       Linux

</pre><h4><b>STABILITY</b></h4><pre>
       Unstable - in development.

</pre><h4><b>AUTHOR</b></h4><pre>
       Brendan Gregg

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/capable.bt.8.html">capable.bt</a>(8)

USER COMMANDS                                      2019-07-05                                      <u><a href="../man8/setuids.bt.8.html">setuids.bt</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>