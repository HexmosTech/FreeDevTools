<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cyr_expire - Cyrus IMAP documentation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/cyrus-common">cyrus-common_3.10.2-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cyr_expire - Cyrus IMAP documentation

       Expire messages and duplicate delivery database entries

</pre><h4><b>SYNOPSIS</b></h4><pre>
          <b>cyr_expire</b> [ <b>-C</b> <u>config-file</u> ] [ <b>-A</b> <u>archive-duration</u> ]
          [ <b>-D</b> <u>delete-duration</u> ] [ <b>-E</b> <u>expire-duration</u> ] [ <b>-X</b> <u>expunge-duration</u> ]
          [ <b>-p</b> <u>mailbox-pre‐fix</u> ] [ <b>-u</b> <u>username</u> ] [ <b>-t</b> ] [ <b>-v</b> ]
          [ <b>-a</b> ] [ <b>-c</b> ] [ <b>-x</b> ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>cyr_expire</b> is used to run a number of regular maintenance tasks on Cyrus databases, specifically:

       • expire messages from mailboxes, and

       • expire entries from the duplicate delivery database, and

       • cleanse mailboxes of partially expunged messages (when using the "delayed" expunge mode), and

       • remove deleted mailboxes (when using the "delayed" delete mode), and

       • expire entries from conversations databases, and

       • archive messages from mailbox.

       There are various annotations that <b>cyr_expire</b> respects:

       • <b>/vendor/cmu/cyrus-imapd/expire</b> which controls the expirations of messages

       • <b>/vendor/cmu/cyrus-imapd/archive</b> which controls the archival of messages

       • <b>/vendor/cmu/cyrus-imapd/delete</b> which controls the deletion of messages

       • <b>/vendor/cmu/cyrus-imapd/noexpire_until</b> which disables the expire and delete operations per user

       The  first  three  mailbox  annotations  specify  the age of messages in the given mailbox that should be
       expired/archived/deleted. The age is specified as a duration, the default unit are  days.   The  duration
       format is defined in <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>.

       The  last  mailbox  annotation  specifies the UNIX epoch time in seconds until which expiring messages or
       removing deleted mailboxes is blocked.  The zero epoch time  represents  infinity.  This  annotation  has
       precedence over any of the other annotations or command line flags. It must only be set on the user inbox
       and applies to all mailboxes of that user.

       The value of the <b>/vendor/cmu/cyrus-imapd/expire</b> annotation is inherited by all children of the mailbox on
       which  it  is set, so an entire mailbox tree can be configured by setting a single annotation on the root
       of that tree.  If a mailbox does not have a <b>/vendor/cmu/cyrus-imapd/expire</b> annotation set on it (or  does
       not inherit one), then no messages are expired from the mailbox.

       The annotation can be examined using the <b>info</b> command of <u><a href="../man8/cyradm.8.html">cyradm</a>(8)</u>, and modified using the <b>mboxconfig</b> and
       <b>setinfo</b> commands of <u><a href="../man8/cyradm.8.html">cyradm</a>(8)</u>.

       Expiration  of  duplicate  delivery  database  entries  for  a  given  mailbox  is also controlled by the
       <b>/vendor/cmu/cyrus-imapd/expire</b> annotation which applies to that mailbox.  A value of 0 on the  annotation
       means  that no expiration is to be performed on that mailbox. Unlike message expiration, if no annotation
       applies to the mailbox then duplicate database entries are expired  using  the  value  given  to  the  <b>-E</b>
       option.

       Expiration  of  conversations  database  entries  occurs  if  the  <b>conversations</b>  option  is  present  in
       <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>.  Expiration can be disabled using the <b>-c</b> option.  The period used  to  expire  entries  is
       controlled by the <b>conversations_expire_days</b> option in <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>.

       <b>cyr_expire</b>  reads  its  configuration options out of the <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u> file unless specified otherwise by
       <b>-C</b>.

       <b>cyr_expire</b> requires at least one of <b>-A</b> <b>-D</b> <b>-E</b> <b>-X</b> or <b>-t</b> to be supplied.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-C</b> <b>config-file</b>
              Use the specified configuration file <u>config-file</u> rather than the default <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>.

       <b>-A</b> <b>archive-duration,</b> <b>--archive-duration=archive-duration</b>
              Archive non-flagged messages older  than  <u>archive-duration</u>  to  the  archive  partition,  allowing
              mailbox  messages  to be split between fast storage and slow large storage.  Only does anything if
              <b>archivepartition-*</b> has been set in your config.  This value is only used for entries which do  not
              have  a corresponding <b>/vendonr/cmu/cyrus-imapd/archive</b> mailbox annotation.  The duration format is
              defined in <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>. The default unit are days.

              This feature was introduced in version 3.0.

       <b>-D</b> <b>delete-duration,</b> <b>--delete-duration=delete-duration</b>
              Remove previously deleted mailboxes older than <u>delete-duration</u> (when using  the  "delayed"  delete
              mode).    This   value   is   only   used   for   entries   which  do  not  have  a  corresponding
              <b>/verdor/cmu/cyrus-imapd/delete</b>  mailbox  annotation.   The   duration   format   is   defined   in
              <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>. The default unit are days.

       <b>-E</b> <b>expire-duration,</b> <b>--expire-duration=expire-duration</b>
              Prune  the  duplicate database of entries older than <u>expire-duration</u>.  This value is only used for
              entries which do not have a corresponding <b>/vendor/cmu/cyrus-imapd/expire</b> mailbox annotation.   The
              duration format is defined in <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>. The default unit are days.

       <b>-X</b> <b>expunge-duration,</b> <b>--expunge-duration=expunge-duration</b>
              Expunge  previously deleted messages older than <u>expunge-duration</u> (when using the "delayed" expunge
              mode).  The duration format is defined in <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>. The default unit are days.

       <b>-c,</b> <b>--no-conversations</b>
              Do not expire conversation database entries, even if the conversations feature is enabled.

              This feature was introduced in version 3.0.

       <b>-x,</b> <b>--no-expunge</b>
              Do not expunge messages even if using delayed expunge mode.  This reduces IO traffic considerably,
              allowing <b>cyr_expire</b> to be run frequently to clean up the duplicate  database  without  overloading
              the machine.

       <b>-p</b> <b>mailbox-prefix,</b> <b>--prefix=mailbox-prefix</b>
              Only find mailboxes starting with this prefix,  e.g.  "user.justgotspammedlots".

       <b>-u</b> <b>userid,</b> <b>--userid=userid</b>
              Only find mailboxes belonging to this user,  e.g.  "<u><a href="mailto:justgotspammedlots@example.com">justgotspammedlots@example.com</a></u>".

       <b>-t,</b> <b>--prune-userflags</b>
              Remove any user flags which are not used by remaining (not expunged) messages.

       <b>-v,</b> <b>--verbose</b>
              Enable verbose output.

       <b>-a,</b> <b>--ignore-annotations</b>
              Skip  the  annotation  lookup,  so  all  <b>/vendor/cmu/cyrus-imapd/expire</b>  annotations  are  ignored
              entirely.  It behaves as if they  were  not  set,  so  only  <u>expire-days</u>  is  considered  for  all
              mailboxes.

</pre><h4><b>EXAMPLES</b></h4><pre>
          <b>cyr_expire</b> <b>-E</b> <u>3</u> <b>-D</b> <u>60</u> <b>-X</b> <u>60</u>
          <u>Purge</u>  <u>duplicates</u>  <u>database</u>  <u>of</u>  <u>all</u> <u>entries</u> <u>older</u> <u>than</u> <u>3</u> <u>days,</u> <u>remove</u> <u>deleted</u> <u>mailboxes</u> <u>older</u> <u>than</u> <u>60</u>
          <u>days</u> <u>and</u> <u>deleted</u> <u>messages</u> <u>older</u> <u>than</u> <u>60</u> <u>days.</u>

          <b>cyr_expire</b> <b>-x</b> <b>-c</b> <b>-A</b> <u>7d</u>
          <u>Perform</u> <u>migration</u> <u>of</u> <u>message</u> <u>older</u> <u>than</u> <u>7</u> <u>days</u> <u>to</u> <u>Archive</u> <u>partition</u> <u>whilst</u> <u>not</u>  <u>altering</u>  <u>conversation</u>
          <u>database</u> <u>nor</u> <u>expunging</u> <u>messages.</u>

</pre><h4><b>HISTORY</b></h4><pre>
       Archive partition and conversation support was first introduced in Cyrus version 3.0.

</pre><h4><b>FILES</b></h4><pre>
       /etc/imapd.conf

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>, <u><a href="../man8/master.8.html">master</a>(8)</u>, <u><a href="../man8/cyradm.8.html">cyradm</a>(8)</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       The Cyrus Team, Nic Bernstein (Onlight), Jeroen van Meeuwen (Kolab Systems)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       1993–2025, The Cyrus Team

3.10.2                                            Jun 27, 2025                                     <u><a href="../man8/CYR_EXPIRE.8.html">CYR_EXPIRE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>