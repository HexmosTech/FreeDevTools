<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mfsbdev - MooseFS block device daemon/management tool</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/moosefs-client">moosefs-client_4.57.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mfsbdev - <b>MooseFS</b> block device daemon/management tool

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>mfsbdev</b>  <b>start</b>  [<b>-H</b>  <u>masterhost</u>]  [<b>-P</b> <u>masterport</u>] [<b>-B</b> <u>masterbind</u>] [<b>-S</b> <u>masterpath</u>] [<b>-p</b> <u>masterpassword</u> | <b>-x</b>
       <u>passwordfile</u>] [<b>-l</b> <u>linksocket</u>] [<b>-i</b> <u>init_mappings_file</u>] [<b>-o</b> <u>options</u>]

       <b>mfsbdev</b> <b>stop</b> [<b>-l</b> <u>linksocket</u>]

       <b>mfsbdev</b> <b>map</b> [<b>-l</b> <u>linksocket</u>] <b>-f</b> <u>mfsfile</u> [<b>-d</b> <u>nbddevice</u>] [<b>-n</b> <u>linkname</u>] [<b>-s</b> <u>bdevsize</u>] [<b>-b</b> <u>blocksize</u> | <b>-5</b> | <b>-1</b>
       | <b>-2</b> | <b>-4</b>] [<b>-r</b>] [<b>-i</b>]

       <b>mfsbdev</b> <b>unmap</b> [<b>-l</b> <u>linksocket</u>] ( <b>-f</b> <u>mfsfile</u> | <b>-d</b> <u>nbddevice</u> | <b>-n</b> <u>linkname</u> )

       <b>mfsbdev</b> <b>list</b> [<b>-l</b> <u>linksocket</u>] [<b>-t</b> <b>m</b>|<b>u</b>|<b>i</b>]

       <b>mfsbdev</b> <b>resize</b> [<b>-l</b> <u>linksocket</u>] ( <b>-f</b> <u>mfsfile</u> | <b>-d</b> <u>nbddevice</u> | <b>-n</b> <u>linkname</u> ) [<b>-s</b> <u>bdevsize</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This tool is used to manage block devices. This tool works in Linux  ONLY.  Kernel  module  nbd  must  be
       loaded for this tool to work properly.

</pre><h4><b>COMMANDS</b></h4><pre>
       <b>start</b>  - starts the daemon; the daemon only listens on a socket at this point; all the other commands use
       the socket to communicate with the daemon; if no socket is specified via -l option, the default is  used:
       /dev/mfs/nbdsock

       <b>stop</b> - stops the daemon

       <b>map</b> - maps a file on mfs to be used as a block device

       <b>unmap</b> - removes a mapping

       <b>list</b> - lists current mappings

       <b>resize</b> - changes the size of a block device (requires kernel version 4.18 or higher)

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-H</b> - master host; default is 'mfsmaster'

       <b>-P</b> - master port; default is '9421'

       <b>-S</b> - master path (subfolder in MFS that will be used as a root for all block device mappings); default is
       '/'

       <b>-p</b>  -  master  password;  mutually  exclusive with -x option; if neither -p nor -x are supplied, the tool
       tries to connect without a password

       <b>-x</b> - path to a file containing master password; mutually exclusive with -p option; if neither -p  nor  -x
       are supplied, the tool tries to connect without a password

       <b>-l</b> - path to communication socket; default is /dev/mfs/nbdsock

       <b>-f</b> - path to mfs file used to map block device;

       <b>-d</b>  -  path  to  network block device ('/dev/nbdX'); by default (if this parameter is not supplied) first
       available device is used with the map command

       <b>-n</b> - name of symbolic link created in '/dev/mfs', pointing at the network block device created by the map
       command; default is a combination of master hostname, port and mfs file name

       <b>-s</b> - size of the block device, both SI and IEC suffixes can be used; default is the size of the file  the
       block device is mapped to

       <b>-b</b> - block size in bytes

       <b>-5</b> - use block size 512 bytes (eq to -b 512)

       <b>-1</b> - use block size 1024 bytes (eq to -b 1024)

       <b>-2</b> - use block size 2048 bytes (eq to -b 2048)

       <b>-4</b> - use block size 4096 bytes (eq to -b 4096)

       <b>-r</b> - maps block device as readonly (allows multiple mappings of the same file)

       <b>-i</b>  <b>(map)</b>  -  ignore locks; one file may be mapped to more than one block device, each map operation will
       try to obtain the appropriate lock (shared for ro, exclusive for rw) but will succed even if the lock  is
       not obtained

       <b>-t</b>  -  forces  the list command to display information in a format ready to use with map (m parameter) or
       unmap (u parameter) command or with MooseFS mfsbdev.cfg file format (i parameter)

       <b>-i</b> <b>(start)</b> - use config file supplied in parameter to start initial block devices; for formatting of  the
       config see <b><a href="../man5/mfsbdev.cfg.5.html">mfsbdev.cfg</a></b>(5)

       <b>-o</b> - additional params, mfsmount-style, many params can be defined, separated by coma:

       <b>mfswritecachesize=</b><u>N</u>
              specify write cache size in MiB (in range: 16..2048 - default: 128)

       <b>mfsreadaheadsize=</b><u>N</u>
              define size of all read ahead buffers in MiB (in range: 16..2048 - default: 128)

       <b>mfsreadaheadleng=</b><u>N</u>
              define amount of bytes to be additionally read (in range: 128KiB..2MiB - default: 2097152 = 2MiB)

       <b>mfsreadaheadtrigger=</b><u>N</u>
              define amount of bytes read sequentially that turns on read ahead (default: 20971520)

       <b>mfserroronlostchunk</b>
              when  all  known  chunkservers  are connected to the master and the required chunk is missing then
              immediately finish I/O and return an error

       <b>mfserroronnospace</b>
              when all known chunkservers are  connected  to  the  master  and  there  is  no  free  space  then
              immediately finish I/O and return an error

       <b>mfsioretries=</b><u>N</u>
              specify number of retries before I/O error is returned (default: 30)

       <b>mfstimeout=</b><u>N</u>
              define  maximum  timeout  in  seconds  before  I/O  error is returned (default: 0 - which means no
              timeout)

       <b>mfslogretry=</b><u>N</u>
              define minimal retry counter on which system will start log I/O messages (default: 5)

       <b>mfsmaster=</b><u>HOST</u>
              connect with MooseFS master on <u>HOST</u> (default is mfsmaster) - equivalent to <b>-H</b>

       <b>mfsport=</b><u>PORT</u>
              connect with MooseFS master on <u>PORT</u> (default is 9421) - equivalent to <b>-P</b>

       <b>mfsbind=</b><u>IP</u>
              local address to use for connecting with master instead of default one - equivalent to <b>-B</b>

       <b>mfssubfolder=</b><u>PATH</u>
              mount specified MooseFS directory (default is /, i.e. whole filesystem) - equivalent to <b>-S</b>

       <b>mfspassword=</b><u>PASSWORD</u>
              authenticate to MooseFS master with <u>PASSWORD</u>

       <b>mfspreflabels=</b><u>LABELEXPR</u>
              specify preferred labels for choosing chunkservers during I/O

       <b>mfsnbdtimeout=</b><u>N</u>
              define maximum timeout in seconds before kernel gives up (default: 1800)

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>mfsbdev</b> <b>start</b> - start nbd daemon with  default  options  (masterhost  =  <b>mfsmaster</b>,  masterport  =  <b>9421</b>,
       linksocket = <b>/dev/mfs/nbdsock</b>, authentication without password)

       <b>mfsbdev</b>  <b>start</b>  <b>-H</b>  <b>mfsmaster.my.domain</b>  <b>-P</b>  <b>9521</b>  <b>-x</b>  <b>/etc/mfs/mastersecret</b> - start nbd daemon that will
       connect to master <b>mfsmaster.my.domain</b> on port <b>9521</b> using password read from file <b>/etc/mfs/mastersecret</b>

       <b>mfsbdev</b>  <b>stop</b>  <b>-l</b>  <b>/tmp/mynbdinstance</b>  -  stop  nbd  daemon   using   for   communication   unix   socket
       <b>/tmp/mynbdinstance</b>

       <b>mfsbdev</b>  <b>map</b>  <b>-f</b>  <b>devices/mybdev1.bin</b>  <b>-s</b> <b>2Ti</b> <b>-n</b> <b>mytestvm</b> - add mapping to daemon using for communication
       default socket (<b>/dev/mfs/nbdsock</b>). Device will be assigned automatically, file  <b>devices/mybdev1.bin</b>  will
       be  mapped  to this device, link '/dev/mfs/mytestvm' to this device will be created and block device will
       have size of 2TiB.

       <b>mfsbdev</b> <b>unmap</b> <b>-n</b> <b>mytestvm</b> - remove mapping that has link named <b>mytestvm</b> (uses link <b>/dev/mfs/mytestvm</b>).

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<a href="mailto:bugs@moosefs.com">bugs@moosefs.com</a>&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2025 Jakub Kruszona-Zawadzki, Saglabs SA

       This file is part of MooseFS.

       MooseFS is free software; you can redistribute it and/or modify it under the terms  of  the  GNU  General
       Public License as published by the Free Software Foundation, version 2 (only).

       MooseFS  is  distributed  in  the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the
       implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE.  See  the  GNU  General  Public
       License for more details.

       You  should  have  received a copy of the GNU General Public License along with MooseFS; if not, write to
       the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston,  MA  02111-1301,  USA  or  visit
       <a href="http://www.gnu.org/licenses/gpl-2.0.html">http://www.gnu.org/licenses/gpl-2.0.html</a>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/mfsmount.8.html">mfsmount</a></b>(8), <b><a href="../man5/mfsbdev.cfg.5.html">mfsbdev.cfg</a></b>(5)

MooseFS 4.57.5-1                                  February 2025                                       <u><a href="../man8/mfsbdev.8.html">mfsbdev</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>