<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xfs_metadump - copy XFS filesystem metadata to a file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/xfsprogs">xfsprogs_6.13.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       xfs_metadump - copy XFS filesystem metadata to a file

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>xfs_metadump</b> [ <b>-aefFgow</b> ] [ <b>-m</b> <u>max_extents</u> ] [ <b>-l</b> <u>logdev</u> ] [ <b>-r</b> <u>rtdev</u> ] [ <b>-v</b> <u>version</u> ] <u>source</u> <u>target</u>
       <b>xfs_metadump</b> <b>-V</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>xfs_metadump</b>  is  a debugging tool that copies the metadata from an XFS filesystem to a file.  The <u>source</u>
       argument must be the pathname of the device or file containing the XFS filesystem and the <u>target</u> argument
       specifies the destination file name.  If <u>target</u> is -, then the output is sent to stdout. This allows  the
       output to be redirected to another program such as a compression application.

       <b>xfs_metadump</b> may only be used to copy unmounted filesystems, or read-only mounted filesystems.

       <b>xfs_metadump</b>  does  not  alter  the  source filesystem in any way. The <u>target</u> image is a contiguous (non-
       sparse) file containing all the filesystem's metadata and indexes to where the blocks were copied from.

       By default, <b>xfs_metadump</b> obfuscates most file (regular file,  directory  and  symbolic  link)  names  and
       extended  attribute  names  to  allow  the  dumps  to be sent without revealing confidential information.
       Extended attribute values are zeroed and no data is copied. The only exceptions  are  file  or  attribute
       names  that  are  4  or less characters in length. Also file names that span extents (this can only occur
       with the <b><a href="../man8/mkfs.xfs.8.html">mkfs.xfs</a></b>(8) options where <b>-n</b> <u>size</u> &gt;  <b>-b</b>  <u>size</u>)  are  not  obfuscated.  Names  between  5  and  8
       characters in length inclusively are partially obfuscated.

       <b>xfs_metadump</b>  cannot  obfuscate  metadata  in the filesystem log.  Log recovery of an obfuscated metadump
       image may expose clear-text metadata and/or cause filesystem corruption in the  restored  image.   It  is
       recommended  that  the  source filesystem first be mounted and unmounted, if possible, to ensure that the
       log is clean.  A subsequent invocation of <b>xfs_metadump</b>  will  capture  a  clean  log  and  obfuscate  all
       metadata correctly.

       If  a metadump must be produced from a filesystem with a dirty log, it is recommended that obfuscation be
       turned off with -o option, if metadata such as filenames is not considered sensitive.  If obfuscation  is
       required  on  a  metadump  with a dirty log, please inform the recipient of the metadump image about this
       situation.

       The contents of an external log device can be dumped only when using  the  v2  format.   Metadump  in  v2
       format  can  be generated by passing the "-v 2" option.  Metadump in v2 format is generated by default if
       the filesystem has an external log and the metadump version to use is not explicitly mentioned.

       <b>xfs_metadump</b> should not be used for any purposes  other  than  for  debugging  and  reporting  filesystem
       problems. The most common usage scenario for this tool is when <b><a href="../man8/xfs_repair.8.html">xfs_repair</a></b>(8) fails to repair a filesystem
       and a metadump image can be sent for analysis.

       The  file  generated  by  <b>xfs_metadump</b>  can  be  restored  to filesystem image (minus the data) using the
       <b><a href="../man8/xfs_mdrestore.8.html">xfs_mdrestore</a></b>(8) tool.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b>     Copies entire metadata blocks.  Normally, <b>xfs_metadump</b> will zero any stale bytes interspersed with
              in-use metadata.  Use this option  to  copy  full  metadata  blocks,  to  provide  more  debugging
              information for a corrupted filesystem.  Note that the extra data will be unobfuscated.

       <b>-e</b>     Stops  the  dump  on  a read error. Normally, it will ignore read errors and copy all the metadata
              that is accessible.

       <b>-f</b>     Specifies that the filesystem image to be processed is stored in a regular file (see the  <b>mkfs.xfs</b>
              <b>-d</b>  file  option).  This  can  also  happen if an image copy of a filesystem has been made into an
              ordinary file with <b><a href="../man8/xfs_copy.8.html">xfs_copy</a></b>(8).

       <b>-F</b>     Specifies that we want to continue even if the superblock magic is not correct.  If the source  is
              truly not an XFS filesystem, the resulting image will be useless, and xfs_metadump may crash.

       <b>-g</b>     Shows  dump progress. This is sent to stdout if the <u>target</u> is a file or to stderr if the <u>target</u> is
              stdout.

       <b>-l</b> <u>logdev</u>
              For filesystems which use an external log, this  specifies  the  device  where  the  external  log
              resides.   If  the v2 metadump format is selected, the contents of the external log will be copied
              to the metadump.  The v2 metadump  format  will  be  selected  automatically  if  this  option  is
              specified.

       <b>-m</b>     Set  the  maximum size of an allowed metadata extent.  Extremely large metadata extents are likely
              to be corrupt, and will be skipped if they exceed this value.  The default size is 2097151 blocks.

       <b>-o</b>     Disables obfuscation of file names and extended attributes.

       <b>-r</b> <u>rtdev</u>
              For filesystems that have a realtime section, this specifies the device where the realtime section
              resides.  If the v2 metadump format is selected, the realtime group superblocks will be copied  to
              the  metadump.   The  v2 metadump format will be selected automatically if the filesystem contains
              realtime groups.

       <b>-v</b>     The format of the metadump file to be produced.  Valid values are 1 and 2.  The  default  metadump
              format is 1.

       <b>-w</b>     Prints warnings of inconsistent metadata encountered to stderr. Bad metadata is still copied.

       <b>-V</b>     Prints the version number and exits.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       <b>xfs_metadump</b>  returns  an  exit code of 0 if all readable metadata is successfully copied or 1 if a write
       error occurs or a read error occurs and the <b>-e</b> option used.

</pre><h4><b>NOTES</b></h4><pre>
       As <b>xfs_metadump</b> copies metadata only, it does not matter if the <u>source</u> filesystem has a realtime  section
       or  not.  If  the  filesystem  has  an  external  log, it is not copied. Internal logs are copied and any
       outstanding log transactions are not obfuscated if they contain names.

       <b>xfs_metadump</b> is a shell wrapper around the <b><a href="../man8/xfs_db.8.html">xfs_db</a></b>(8) <b>metadump</b> command.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/xfs_repair.8.html">xfs_repair</a></b>(8), <b><a href="../man8/xfs_mdrestore.8.html">xfs_mdrestore</a></b>(8), <b><a href="../man8/xfs_freeze.8.html">xfs_freeze</a></b>(8), <b><a href="../man8/xfs_db.8.html">xfs_db</a></b>(8), <b><a href="../man8/xfs_copy.8.html">xfs_copy</a></b>(8), <b><a href="../man5/xfs.5.html">xfs</a></b>(5)

</pre><h4><b>BUGS</b></h4><pre>
       Email bug reports to <b><a href="mailto:linux-xfs@vger.kernel.org">linux-xfs@vger.kernel.org</a></b>.

                                                                                                 <u><a href="../man8/xfs_metadump.8.html">xfs_metadump</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>