<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fstrim - discard unused blocks on a mounted filesystem</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/util-linux">util-linux_2.41-4ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fstrim - discard unused blocks on a mounted filesystem

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>fstrim</b> [<b>-v</b>] [<b>-o</b> <u>offset</u>] [<b>-l</b> <u>length</u>] [<b>-m</b> <u>minimum-size</u>] <b>-A</b>|<b>-a</b>|<u>mountpoint</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>fstrim</b> is used on a mounted filesystem to discard (or "trim") blocks which are not in use by the
       filesystem. This is useful for solid-state drives (SSDs) and thinly-provisioned storage.

       By default, <b>fstrim</b> will discard all unused blocks in the filesystem. Options may be used to modify this
       behavior based on range or size, as explained below.

       The <u>mountpoint</u> argument is the pathname of the directory where the filesystem is mounted and is required
       when <u>-A,</u> <u>-a,</u> <u>--fstab,</u> <u>or</u> <u>--all</u> <u>are</u> <u>unspecified.</u>

       <u>Running</u> <b>fstrim</b> <u>frequently,</u> <u>or</u> <u>even</u> <u>using</u> <b>mount</b> <b>-o</b> <b>discard</b><u>,</u> <u>might</u> <u>negatively</u> <u>affect</u> <u>the</u> <u>lifetime</u> <u>of</u>
       <u>poor-quality</u> <u>SSD</u> <u>devices.</u> <u>For</u> <u>most</u> <u>desktop</u> <u>and</u> <u>server</u> <u>systems</u> <u>a</u> <u>sufficient</u> <u>trimming</u> <u>frequency</u> <u>is</u> <u>once</u> <u>a</u>
       <u>week.</u> <u>Note</u> <u>that</u> <u>not</u> <u>all</u> <u>devices</u> <u>support</u> <u>a</u> <u>queued</u> <u>trim,</u> <u>so</u> <u>each</u> <u>trim</u> <u>command</u> <u>incurs</u> <u>a</u> <u>performance</u> <u>penalty</u>
       <u>on</u> <u>whatever</u> <u>else</u> <u>might</u> <u>be</u> <u>trying</u> <u>to</u> <u>use</u> <u>the</u> <u>disk</u> <u>at</u> <u>the</u> <u>time.</u>

</pre><h4><b>OPTIONS</b></h4><pre>
       The <u>offset</u>, <u>length</u>, and <u>minimum-size</u> arguments may be followed by the multiplicative suffixes KiB
       (=1024), MiB (=1024*1024), and so on for GiB, TiB, PiB, EiB, ZiB and YiB (the "iB" is optional, e.g., "K"
       has the same meaning as "KiB") or the suffixes KB (=1000), MB (=1000*1000), and so on for GB, TB, PB, EB,
       ZB and YB.

       <b>-A,</b> <b>--fstab</b>
           Trim all mounted filesystems mentioned in <u><a href="file:/etc/fstab">/etc/fstab</a></u> on devices that support the discard operation.
           The root filesystem is determined from kernel command line if missing in the file. The other supplied
           options, like <b>--offset</b>, <b>--length</b> and <b>--minimum</b>, are applied to all these devices. Errors from
           filesystems that do not support the discard operation, read-only devices, autofs and read-only
           filesystems are silently ignored. Filesystems with "X-fstrim.notrim" mount option are skipped.

       <b>-a,</b> <b>--all</b>
           Trim all mounted filesystems on devices that support the discard operation. The other supplied
           options, like <b>--offset</b>, <b>--length</b> and <b>--minimum</b>, are applied to all these devices. Errors from
           filesystems that do not support the discard operation, read-only devices and read-only filesystems
           are silently ignored.

       <b>-n,</b> <b>--dry-run</b>
           This option does everything apart from actually call <b>FITRIM</b> ioctl.

       <b>-o,</b> <b>--offset</b> <u>offset</u>
           Byte offset in the filesystem from which to begin searching for free blocks to discard. The default
           value is zero, starting at the beginning of the filesystem.

       <b>-l,</b> <b>--length</b> <u>length</u>
           The number of bytes (after the starting point) to search for free blocks to discard. If the specified
           value extends past the end of the filesystem, <b>fstrim</b> will stop at the filesystem size boundary. The
           default value extends to the end of the filesystem.

       <b>-I,</b> <b>--listed-in</b> <u>list</u>
           Specifies a colon-separated list of files in fstab or kernel mountinfo format. All missing or empty
           files are silently ignored. The evaluation of the <u>list</u> stops after first non-empty file. For example:

           <b>--listed-in</b> <b><a href="file:/etc/fstab">/etc/fstab</a>:<a href="file:/proc/self/mountinfo">/proc/self/mountinfo</a></b>.

           Filesystems with "X-fstrim.notrim" mount option in fstab are skipped.

       <b>-m,</b> <b>--minimum</b> <u>minimum-size</u>
           Minimum contiguous free range to discard, in bytes. (This value is internally rounded up to a
           multiple of the filesystem block size.) Free ranges smaller than this will be ignored and <b>fstrim</b> will
           adjust the minimum if it’s smaller than the device’s minimum, and report that (fstrim_range.minlen)
           back to userspace. By increasing this value, the <b>fstrim</b> operation will complete more quickly for
           filesystems with badly fragmented freespace, although not all blocks will be discarded. The default
           value is zero, discarding every free block.

       <b>-t</b>, <b>--types</b> <u>list</u>
           Specifies allowed or forbidden filesystem types when used with <b>--all</b> or <b>--fstab</b>. The <u>list</u> is a
           comma-separated list of the filesystem names. The <u>list</u> follows how <b>mount</b> <b>-t</b> evaluates type patterns.
           Only specified filesystem types are allowed. All specified types are forbidden if the list is
           prefixed by "no" or each filesystem prefixed by "no" is forbidden. If the option is not used, then
           all filesystems (except "autofs") are allowed.

       <b>-v,</b> <b>--verbose</b>
           Verbose execution. With this option <b>fstrim</b> will output the number of bytes passed from the filesystem
           down the block stack to the device for potential discard. This number is a maximum discard amount
           from the storage device’s perspective, because <u>FITRIM</u> ioctl called repeated will keep sending the
           same sectors for discard repeatedly.

           <b>fstrim</b> will report the same potential discard bytes each time, but only sectors which had been
           written to between the discards would actually be discarded by the storage device. Further, the
           kernel block layer reserves the right to adjust the discard ranges to fit raid stripe geometry,
           non-trim capable devices in a LVM setup, etc. These reductions would not be reflected in
           fstrim_range.len (the <b>--length</b> option).

       <b>--quiet-unsupported</b>
           Suppress error messages if trim operation (ioctl) is unsupported. This option is meant to be used in
           <b>systemd</b> service file or in <b><a href="../man8/cron.8.html">cron</a></b>(8) scripts to hide warnings that are result of known problems, such
           as NTFS driver reporting <u>Bad</u> <u>file</u> <u>descriptor</u> when device is mounted read-only, or lack of file system
           support for ioctl <u>FITRIM</u> call. This option also cleans exit status when unsupported filesystem
           specified on <b>fstrim</b> command line.

       <b>-h</b>, <b>--help</b>
           Display help text and exit.

       <b>-V</b>, <b>--version</b>
           Display version and exit.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       0
           success

       1
           failure

       32
           all failed

       64
           some filesystem discards have succeeded, some failed

       The command <b>fstrim</b> <b>--all</b> returns 0 (all succeeded), 32 (all failed) or 64 (some failed, some succeeded).

</pre><h4><b>AUTHORS</b></h4><pre>
       Lukas Czerner &lt;<a href="mailto:lczerner@redhat.com">lczerner@redhat.com</a>&gt;, Karel Zak &lt;<a href="mailto:kzak@redhat.com">kzak@redhat.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/blkdiscard.8.html">blkdiscard</a></b>(8), <b><a href="../man8/mount.8.html">mount</a></b>(8)

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       For bug reports, use the issue tracker &lt;https://github.com/util-linux/util-linux/issues&gt;.

</pre><h4><b>AVAILABILITY</b></h4><pre>
       The <b>fstrim</b> command is part of the util-linux package which can be downloaded from Linux Kernel Archive
       &lt;https://www.kernel.org/pub/linux/utils/util-linux/&gt;.

util-linux 2.41                                    2025-02-26                                          <u><a href="../man8/FSTRIM.8.html">FSTRIM</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>