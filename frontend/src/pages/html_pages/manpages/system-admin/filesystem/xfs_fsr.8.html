<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xfs_fsr - filesystem reorganizer for XFS</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/xfsprogs">xfsprogs_6.13.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       xfs_fsr - filesystem reorganizer for XFS

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>xfs_fsr</b> [<b>-vdg</b>] [<b>-t</b> seconds] [<b>-p</b> passes] [<b>-f</b> leftoff] [<b>-m</b> mtab]
       <b>xfs_fsr</b> [<b>-vdg</b>] [xfsdev | file] ...
       <b>xfs_fsr</b> <b>-V</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>xfs_fsr</u> is applicable only to XFS filesystems.

       <u>xfs_fsr</u>  improves  the organization of mounted filesystems.  The reorganization algorithm operates on one
       file at a time, compacting or otherwise improving the layout of the file extents  (contiguous  blocks  of
       file data).

       The  following  options  are  accepted  by  <u>xfs_fsr</u>.   The  <b>-m</b>, <b>-t</b>, and <b>-f</b> options have no meaning if any
       filesystems or files are specified on the command line.

       <b>-m</b> <u>mtab</u>      Use this file for the list of filesystems to reorganize.  The default is to use <u><a href="file:/etc/mtab">/etc/mtab</a></u>.

       <b>-t</b> <u>seconds</u>   How long to reorganize.  The default is 7200 seconds (2 hours).

       <b>-p</b> <u>passes</u>    Number of passes before terminating global re-org.  The default is 10 passes.

       <b>-f</b> <u>leftoff</u>   Use this file instead of <u>/var/tmp/.fsrlast</u> to read the state of where to start  and  as  the
                    file to store the state of where reorganization left off.

       <b>-v</b>           Verbose.  Print cryptic information about each file being reorganized.

       <b>-d</b>           Debug.  Print even more cryptic information.

       <b>-g</b>           Print to syslog (default if stdout not a tty).

       <b>-V</b>           Prints the version number and exits.

       When invoked with no arguments <u>xfs_fsr</u> reorganizes all regular files in all mounted filesystems.  <u>xfs_fsr</u>
       makes many cycles over <u><a href="file:/etc/mtab">/etc/mtab</a></u> each time making a single pass over each XFS filesystem.  Each pass goes
       through and selects files that have the largest number of extents.  It attempts to defragment the top 10%
       of these files on each pass.

       It  runs  for  up  to  two hours after which it records the filesystem where it left off, so it can start
       there the next time.  This information is stored in the file <u>/var/tmp/.fsrlast_xfs.</u>  If  the  information
       found  here  is  somehow  inconsistent  or  out  of  date  it is ignored and reorganization starts at the
       beginning of the first filesystem found in <u><a href="file:/etc/mtab">/etc/mtab</a></u>.

       <u>xfs_fsr</u> can be called with one or more arguments naming filesystems (block device  name),  and  files  to
       reorganize.   In  this  mode  <u>xfs_fsr</u>  does not read or write <u>/var/tmp/.fsrlast_xfs</u> nor does it run for a
       fixed time interval.  It makes one pass through each specified regular file and all regular files in each
       specified filesystem.  A command line name referring to a symbolic link (except to a file system device),
       FIFO, or UNIX domain socket generates a warning message, but is otherwise ignored.  While traversing  the
       filesystem these types of files are silently skipped.

</pre><h4><b>FILES</b></h4><pre>
       <a href="file:/etc/mtab">/etc/mtab</a>            contains default list of filesystems to reorganize.
       /var/tmp/.fsrlast_xfs
                            records the state where reorganization left off.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/xfs_fsr.8.html">xfs_fsr</a>(8), <a href="../man8/mkfs.xfs.8.html">mkfs.xfs</a>(8), <a href="../man8/xfs_ncheck.8.html">xfs_ncheck</a>(8), <a href="../man5/xfs.5.html">xfs</a>(5).

</pre><h4><b>NOTES</b></h4><pre>
       <u>xfs_fsr</u>  improves  the layout of extents for each file by copying the entire file to a temporary location
       and then interchanging the data extents of the target and temporary files  in  an  atomic  manner.   This
       method  requires  that  enough  free disk space be available to copy any given file and that the space be
       less fragmented than the original file.  It also requires the owner of the file to have enough  remaining
       filespace  quota  to do the copy on systems running quotas.  <u>xfs_fsr</u> generates a warning message if space
       is not sufficient to improve the target file.

       A temporary file used in improving a file given on the  command  line  is  created  in  the  same  parent
       directory of the target file and is prefixed by the string '<b>.fsr</b>'.  The temporary files used in improving
       an  entire  XFS device are stored in a directory at the root of the target device and use the same naming
       scheme.  The temporary files are unlinked upon creation so  data  will  not  be  readable  by  any  other
       process.

       <u>xfs_fsr</u>  does  not operate on files that are currently mapped in memory.  A 'file busy' error can be seen
       for these files if the verbose flag (<b>-v</b>) is set.

       Files marked as no-defrag will be skipped. The <u><a href="../man8/xfs_io.8.html">xfs_io</a></u>(8) chattr command with the f attribute can be  used
       to  set  or  clear  this  flag. Files and directories created in a directory with the no-defrag flag will
       inherit the attribute.

       An entry in <u><a href="file:/etc/mtab">/etc/mtab</a></u> or the file specified using the <b>-m</b> option must have the  <b>rw</b>  option  specified  for
       read  and  write  access.   If this option is not present, then <u>xfs_fsr</u> skips the filesystem described by
       that line.  See the <u><a href="../man5/fstab.5.html">fstab</a></u>(5) reference page for more details.

       In general we do not foresee the need to run <u>xfs_fsr</u> on system partitions such as <u>/</u>, <u><a href="file:/boot">/boot</a></u> and <u><a href="file:/usr">/usr</a></u> as in
       general these will not suffer from fragmentation.  There are also issues with defragmenting files <u><a href="../man8/lilo.8.html">lilo</a></u>(8)
       uses to boot your system. It is recommended that these files should be  flagged  as  no-defrag  with  the
       <u><a href="../man8/xfs_io.8.html">xfs_io</a></u>(8)  chattr  command.  Should  these  files be moved by <u>xfs_fsr</u> then you must rerun <u>lilo</u> before you
       reboot or you may have an unbootable system.

                                                                                                      <u><a href="../man8/xfs_fsr.8.html">xfs_fsr</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>