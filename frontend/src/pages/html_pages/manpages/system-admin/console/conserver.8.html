<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>conserver - console server daemon</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/conserver-server">conserver-server_8.2.7-3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       conserver - console server daemon

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>conserver</b>  [<b>-7dDEFhinoRSuvV</b>] [<b>-a</b> <u>type</u>] [<b>-m</b> <u>max</u>] [<b>-M</b> <u>master</u>] [<b>-p</b> <u>port</u>] [<b>-b</b> <u>port</u>] [<b>-c</b> <u>cred</u>] [<b>-C</b> <u>config</u>] [<b>-P</b>
       <u>passwd</u>] [<b>-L</b> <u>logfile</u>] [<b>-O</b> <u>min</u>] [<b>-U</b> <u>logfile</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Conserver</b> is the daemon that manages  remote  access  to  system  consoles  by  multiple  users  via  the
       <b><a href="../man1/console.1.html">console</a></b>(1)  client program and (optionally) log the console output.  It can connect to consoles via local
       serial ports, Unix domain sockets, TCP sockets (for terminal servers  and  the  like),  or  any  external
       program.

       When  started,  <b>conserver</b>  reads the <b><a href="../man5/conserver.cf.5.html">conserver.cf</a></b>(5) file for details of each console.  The console type,
       logging options, serial or network parameters, and user access levels are just a few of the  things  that
       can  be  specified.  Command-line options are then applied, possibly overriding <b><a href="../man5/conserver.cf.5.html">conserver.cf</a></b>(5) settings.
       <b>Conserver</b> categorizes consoles into two types: those it should actively manage, and those it should  just
       know  about,  so  it  can  refer  clients to other <b>conserver</b> instances.  If the <b>master</b> value of a console
       matches the hostname or ip address of the local machine, <b>conserver</b>  will  actively  manage  the  console.
       Otherwise,  it's  considered  a  ``remote'' console and managed by a different server.  <b>Conserver</b> forks a
       child for each group of consoles it must manage and assigns each process a port number to listen on.  The
       maximum number of consoles managed by each child process is set using  the  <b>-m</b>  option.   The  <b><a href="../man1/console.1.html">console</a></b>(1)
       client  program  communicates  with  the  master  console server process to find the port (and host, in a
       multi-server configuration) on which the appropriate child is listening.  <b>Conserver</b> restricts connections
       from clients based on the host access section of its <b><a href="../man5/conserver.cf.5.html">conserver.cf</a></b>(5) file, restricts users based  on  the
       console access lists of the <b><a href="../man5/conserver.cf.5.html">conserver.cf</a></b>(5) file, and authenticates users against its <b><a href="../man5/conserver.passwd.5.html">conserver.passwd</a></b>(5)
       file.  <b>Conserver</b> can also restrict clients using the tcp-wrappers package (enabled using <b>--with-libwrap</b>).
       This authentication is done before consulting the <b><a href="../man5/conserver.cf.5.html">conserver.cf</a></b>(5) access list.

       When   Unix  domain  sockets  are  used  between  the  client  and  server  (enabled  using  <b>--with-uds</b>),
       authentication checks are done on the hardcoded address ``127.0.0.1''.  Automatic client  redirection  is
       also  disabled  (as  if  the <b>-R</b> option was used) since the client cannot communicate with remote servers.
       The directory used to hold the sockets is checked to make sure it's empty when the  server  starts.   The
       server  will  <b>not</b>  remove  any  files in the directory itself, just in case the directory is accidentally
       specified as ``<a href="file:/etc">/etc</a>'' or some other critical location.  The server will do its best  to  remove  all  the
       sockets  when  it  shuts  down,  but it could stop ungracefully (crash, ``kill -9'', etc) and leave files
       behind.  It would then be up to the admin (or a creative startup script) to clean up the directory before
       the server will start again.

       <b>Conserver</b> completely controls any connection to a console.  All escape sequences given  by  the  user  to
       <b>console</b>  are passed to the server without interpretation.  The server recognizes and processes all escape
       sequences.

       The <b>conserver</b> parent process will automatically respawn any  child  process  that  dies.   The  following
       signals are propagated by the parent process to its children.

       SIGTERM   Close all connections and exit.

       SIGHUP    Reread  the  configuration file.  New consoles are managed by forking off new children, deleted
                 consoles (and their clients) are  dropped,  and  changes  to  consoles  are  done  "in  place",
                 resetting  the console port (bringing it down and up) only when necessary.  The console name is
                 used to determine when consoles have been  added/removed/changed.   All  actions  performed  by
                 SIGUSR2 are also performed.

       SIGUSR1   Try  to  connect  to any consoles marked as down.  This can come in handy if you had a terminal
                 server (or more) that wasn't accepting connections at startup and you want <b>conserver</b> to try  to
                 reconnect to all those downed ports.

       SIGUSR2   Close  and  reopen  all  console logfiles and, if in daemon mode (<b>-d</b> option), the error logfile
                 (see the <b>-L</b> option).  All actions performed by SIGUSR1 are also performed.

       Consoles which have no current client connection might produce important error  messages.   With  the  <b>-u</b>
       option,  these  ``unloved''  errors  are  labeled with a machine name and output on stdout (or, in daemon
       mode, to the logfile).  This allows a live operator or an automated log scanner to find otherwise  unseen
       errors by watching in a single location.

       <b>Conserver</b> must be run as root if it is to bind to a port under 1024 or if it must read protected password
       files  (like shadow passwords) for authentication (see <b><a href="../man5/conserver.passwd.5.html">conserver.passwd</a></b>(5)).  Otherwise, it may be run by
       any user, with <b>-p</b> used to specify a port above 1024.

       If encryption has been built into  the  code  (<b>--with-openssl</b>),  encrypted  client  connections  (without
       certificate  exchanges)  happen  by  default.   To  add certificate exchanges, use the <b>-c</b> option with the
       client and server.  For authentication of the certificates to  work,  the  signing  certificate  must  be
       properly trusted, which usually means the public portion is in <u>OPENSSL_ROOT</u><b>/ssl/certs</b> (on both the client
       and  server  sides).   See  the  sample  self-signing certificate making script <b>contrib/maketestcerts</b> for
       further clues.  To allow non-encrypted client connections (in addition to encrypted client  connections),
       use the <b>-E</b> option.

</pre><h4><b>OPTIONS</b></h4><pre>
       Options  may  be  given  as separate arguments (e.g., <b>-n</b> <b>-d</b>) or clustered (e.g., <b>-nd</b>).  Options and their
       arguments may be separated by  optional  white  space.   Option  arguments  containing  spaces  or  other
       characters special to the shell must be quoted.

       <b>-7</b>          Strip  the  high  bit  off  of all data received, whether from the <b>console</b> client or from the
                   console device, before any processing occurs.

       <b>-a</b><u>type</u>      Set the default access type for incoming connections from <b>console</b> clients:  `<b>r</b>'  for  refused
                   (the  default),  `<b>a</b>'  for  allowed,  or  `<b>t</b>' for trusted.  This applies to hosts for which no
                   matching entry is found in the access section of <b><a href="../man5/conserver.cf.5.html">conserver.cf</a></b>(5).

       <b>-b</b><u>port</u>      Set the base port for children to listen on.  Each child starts looking  for  free  ports  at
                   <u>port</u>  and  working upward, trying a maximum number of ports equal to twice the maximum number
                   of groups.  If no free ports are available in  that  range,  <b>conserver</b>  exits.   By  default,
                   <b>conserver</b> lets the operating system choose a free port.

       <b>-c</b><u>cred</u>      Load an SSL certificate and key from the PEM encoded file <u>cred</u>.

       <b>-C</b><u>config</u>    Read  configuration  information  from the file <u>config</u>.  The default <u>config</u> may be changed at
                   compile time using the <b>--with-cffile</b> option.

       <b>-d</b>          Become a daemon.  Disconnects from the controlling terminal and sends all  output  (including
                   any debug output) to the logfile (see <b>-L</b>).

       <b>-D</b>          Enable debugging output, sent to stderr.  Multiple <b>-D</b> options increases debug output.

       <b>-E</b>          If encryption has been built into the code (<b>--with-openssl</b>), encrypted client connections are
                   a  requirement.   This  option allows non-encrypted clients (as well as encrypted clients) to
                   connect to consoles.

       <b>-F</b>          Do not automatically reinitialize failed (unexpectedly closed) consoles.  If the console is a
                   program (`|' syntax) and it closes with a zero exit  status,  the  console  is  reinitialized
                   regardless  of  this  option.  Without this option, a console is immediately reopened, and if
                   that fails, retried every minute until successful.  This option has no effect on the  <b>-o</b>  and
                   <b>-O</b> options.

       <b>-h</b>          Output a brief help message.

       <b>-i</b>          Initiate console connections on demand (and close them when not used).

       <b>-L</b><u>logfile</u>   Log  errors  and  informational  messages to <u>logfile</u> after startup in daemon mode (<b>-d</b>).  This
                   option does not apply when not running in daemon mode.  The default <u>logfile</u> may be changed at
                   compile time using the <b>--with-logfile</b> option.

       <b>-m</b><u>max</u>       Set the maximum consoles managed per process.  The default <u>max</u> may be changed at compile time
                   using the <b>--with-maxmemb</b> option.

       <b>-M</b><u>master</u>    Normally, this allows conserver to bind to a particular IP address (like `127.0.0.1') instead
                   of all interfaces.  The default is to bind to all addresses.  However, if <b>--with-uds</b> was used
                   to enable Unix domain sockets for client/server communication, this points conserver  to  the
                   directory   where   it   should   store   the   sockets.    The   default   <u>master</u>  directory
                   (``<b>/tmp/conserver</b>'') may be changed at compile time using the <b>--with-uds</b> option.

       <b>-n</b>          Obsolete (now a no-op); see <b>-u</b>.

       <b>-o</b>          Normally, a client connecting to a ``downed'' console does just that.  Using this option, the
                   server will automatically attempt  to  open  (``bring  up'')  the  console  when  the  client
                   connects.

       <b>-O</b><u>min</u>       Enable  periodic  attempts  (every  <u>min</u>  minutes)  to open (``bring up'') all downed consoles
                   (similar to sending a SIGUSR1).  Without this option, or if <u>min</u> is zero, no periodic attempts
                   occur.

       <b>-p</b><u>port</u>      Set the TCP port for the master process to listen on.  This may be either a port number or  a
                   service  name.   The  default  <u>port</u>, ``conserver'' (typically 782), may be changed at compile
                   time using the <b>--with-port</b> option.  If  the  <b>--with-uds</b>  option  was  used,  this  option  is
                   ignored.

       <b>-P</b><u>passwd</u>    Read  the  table  of  authorized  user  data from the file <u>passwd</u>.  The default <u>passwd</u> may be
                   changed at compile time using the <b>--with-pwdfile</b> option.

       <b>-R</b>          Disable automatic client redirection to other  conserver  hosts.   This  means  informational
                   commands like <b>-w</b> and <b>-i</b> will only show the status of the local conserver host and attempts to
                   connect to remote consoles will result in an informative message to the user.

       <b>-S</b>          Do not run the server, just perform a syntax check of configuration file and exit with a non-
                   zero  value  if  there  is  an  error.  Using more than one <b>-S</b> will cause conserver to output
                   various information about each console in 5 colon-separated fields, enclosed in curly-braces.
                   The philosophy behind the output is to provide information to  allow  external  detection  of
                   multiple  consoles access the same physical port.  Since this is <u>highly</u> environment-specific,
                   conserver cannot do the check internally.

                   <u>name</u>     The name of the console.

                   <u>master</u>   The hostname of the master conserver host for the console.

                   <u>aliases</u>  The console aliases in a comma-separated list.

                   <u>type</u>     The type of console.  Values will be a `/' for a local device, `|'  for  a  command,
                            `!' for a remote port, `%' for a Unix domain socket, and `#' for a noop console.

                   <u>details</u>  Multiple  values  are  comma-separated and depend on the type of the console.  Local
                            devices will have the values of the device file and baud rate/parity.  Commands will
                            have string to invoke.  Remote ports will have the values of the remote hostname and
                            port number.  Unix domain sockets will have the path to the socket.   Noop  consoles
                            will have nothing.

       <b>-u</b>          Send  unloved  console  output to <b>conserver</b>'s stdout (which, in daemon mode, is redirected to
                   the logfile).  This applies to all consoles to which no  user  is  attached,  independent  of
                   whether logging of individual consoles is enabled via <b>conserver.cf</b> entries.

       <b>-U</b><u>logfile</u>   Copy  all  console data to the ``unified'' <u>logfile</u>.  The output is the same as the <b>-u</b> output,
                   but all consoles, not just those without a user, are logged.  Each line of output is prefixed
                   with the console name.  If a user is attached read/write, a `*' is appended  to  the  console
                   name, to allow log watching utilities to ignore potential user-introduced alarms.

       <b>-v</b>          Echo the configuration as it is being read (be verbose).

       <b>-V</b>          Output the version number and settings of the <b>conserver</b> program and then exit.

</pre><h4><b>PROTOCOL</b></h4><pre>
       The  protocol  used  to  interact with the <b>conserver</b> daemon has two basic styles.  The first style is the
       initial line-based mode, which occurs before connecting to a console.  The second style is the character-
       based, escape-sequence mode, while connected to a console.

       The initial line-based mode begins the same for both  the  master  process  and  its  children.   Upon  a
       successful (non-rejected) client connection, an ``ok'' is sent.  The client then issues a command and the
       server  responds  to  it  with a result string (``ok'' being the sign of success for most commands).  The
       commands available are ``help'', ``ssl'' (if SSL was built  into  the  code),  ``login'',  and  ``exit''.
       Using the ``login'' command, the client authenticates and gains access to the extended command set.  This
       is  where  the  master  process  and  its children differ.  The master process gives the client access to
       global commands, and the child provides commands for interacting  with  the  consoles  it  manages.   The
       ``help'' command, in both cases, will provide a complete list of commands and a short description of what
       they do.

       The second, character-based, style of interaction occurs when the client issues the ``call'' command with
       a  child  process.   This command connects the client to a console and, at that point, relays all traffic
       between the client and the console.  There is no more command-based interaction between  the  client  and
       the server, any interaction with the server is done with the default escape sequence.

       This  is, by no means, a complete description of the entire client/server interaction.  It is, however, a
       brief explanation in order to give a idea of what the  program  does.   See  the  <b>PROTOCOL</b>  file  in  the
       distribution for further details.

</pre><h4><b>FILES</b></h4><pre>
       The  following  default  file  locations may be overridden at compile time or by the command-line options
       described above.  Run <b>conserver</b> <b>-V</b> to see the defaults set at compile time.

       <b>/etc/conserver.cf</b>        description of console  terminal  lines  and  client  host  access  levels;  see
                                <b><a href="../man5/conserver.cf.5.html">conserver.cf</a></b>(5).
       <b>/etc/conserver.passwd</b>    users allowed to access consoles; see <b><a href="../man5/conserver.passwd.5.html">conserver.passwd</a></b>(5).
       <b>/var/run/conserver.pid</b>   the master conserver process ID
       <b>/var/log/conserver</b>       log of errors and informational messages
       <b>/tmp/conserver</b>           directory to hold Unix domain sockets (if enabled)

       Additionally,   output   from   individual  consoles  may  be  logged  to  separate  files  specified  in
       <b><a href="../man5/conserver.cf.5.html">conserver.cf</a></b>(5).

</pre><h4><b>BUGS</b></h4><pre>
       I'm sure there are bugs, I just don't know where they are.  Please let me know if you find any.

</pre><h4><b>AUTHORS</b></h4><pre>
       Thomas A. Fine, Ohio State Computer Science
       Kevin S Braunsdorf, Purdue University Computing Center
       Bryan Stansell, conserver.com

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/console.1.html">console</a></b>(1), <b><a href="../man5/conserver.cf.5.html">conserver.cf</a></b>(5), <b><a href="../man5/conserver.passwd.5.html">conserver.passwd</a></b>(5)

conserver-8.2.7                                    2022/07/07                                       <u><a href="../man8/CONSERVER.8.html">CONSERVER</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>