<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>exim_lock - Mailbox maintenance</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/exim4-base">exim4-base_4.98.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       exim_lock - Mailbox maintenance

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>exim_lock</b> [<u>options</u>]<u>mailbox-file</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>exim_lock</b> utility locks a mailbox file using the same algorithm as Exim.  For a discussion of locking
       issues,  see  section  "appendfile  transport",  subsection  "Operational details for appending" the Exim
       specification.  <b>exim_lock</b> can be used to prevent any modification of a mailbox by Exim or  a  user  agent
       while  investigating a problem.  The utility requires the name of the file as its first argument.  If the
       locking is successful, the second argument is run as a command (using C's “system()” function); if  there
       is  no  second  argument, the value of the SHELL environment variable is used; if this is unset or empty,
       <a href="file:/bin/sh">/bin/sh</a> is run.  When the command finishes, the mailbox is unlocked and the utility ends.  The  following
       options are available:

       <u>-fcntl</u> Use “fcntl()” locking on the open mailbox.

       <u>-flock</u> Use “flock()” locking on the open mailbox, provided the operating system supports it.

       <u>-interval</u>
              This  must  be  followed  by a number, which is a number of seconds; it sets the interval to sleep
              between retries (default 3).

       <u>-lockfile</u>
              Create a lock file before opening the mailbox.

       <u>-mbx</u>   Lock the mailbox using MBX rules.

       <u>-q</u>     Suppress verification output.

       <u>-retries</u>
              This must be followed by a number; it sets the number of times to try to  get  the  lock  (default
              10).

       <u>-restore_time</u>
              This  option  causes  exim_lock  to  restore the modified and read times to the locked file before
              exiting. This allows you to access a locked mailbox (for example, to take a backup  copy)  without
              disturbing the times that the user subsequently sees.

       <u>-timeout</u>
              This must be followed by a number, which is a number of seconds; it sets a timeout to be used with
              a blocking “fcntl()” lock.  If it is not set (the default), a non-blocking call is used.

       <u>-v</u>     Generate verbose output.

              If  none  of <u>-fcntl,</u> <u>-flock,</u> <u>-lockfile</u> or <u>-mbx</u> are given, the default is to create a lock file and
              also use “fcntl()” locking on the mailbox, which is the same as <b>Exim's</b> default.  The use of <u>-fcntl</u>
              or <u>-flock</u> requires that the file be writable; the use of <u>-lockfile</u>  requires  that  the  directory
              containing the file be writable.  Locking by lock file does not last for ever; Exim assumes that a
              lock file is expired if it is more than 30 minutes old.

              The  <u>-mbx</u>  can be used with either or both of <u>-fcntl</u> or <u>-flock.</u>  It assumes <u>-fcntl</u> by default. MBX
              locking causes a shared lock to be taken out on the open mailbox, and an  exclusive  lock  on  the
              file  /tmp/.n.m where n and m are the device number and inode number of the mailbox file. When the
              locking is released, if an exclusive lock can be obtained for the mailbox, the  file  in  <a href="file:/tmp">/tmp</a>  is
              deleted.

              The  default  output  contains verification of the locking that takes place.  The <u>-v</u> option causes
              some additional information to be given.   The  <u>-q</u>  option  suppresses  all  output  except  error
              messages.

       A command such as

         exim_lock /var/spool/mail/spqr

       runs an interactive shell while the file is locked, whereas

         exim_lock -q /var/spool/mail/spqr &lt;&lt;End
         &lt;some commands&gt;
         End

       runs  a  specific  non-interactive  sequence  of  commands  while  the  file  is  locked, suppressing all
       verification output.  A single command can be run by a command such as

         exim_lock -q /var/spool/mail/spqr     "cp /var/spool/mail/spqr /some/where"

       Note that if a command is supplied, it must be entirely contained within the second argument - hence  the
       quotes.

</pre><h4><b>BUGS</b></h4><pre>
       This manual page needs a major re-work. If somebody knows better groff than us and has more experience in
       writing manual pages, any patches would be greatly appreciated.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/exim.8.html">exim</a></b>(8), /usr/share/doc/exim4-base/

</pre><h4><b>AUTHOR</b></h4><pre>
       This manual page was stitched together from spec.txt by Andreas Metzler &lt;ametzler at downhill.at.eu.org&gt;,
       for the Debian GNU/Linux system (but may be used by others).

                                                  May 12, 2020                                      <u><a href="../man8/EXIM_LOCK.8.html">EXIM_LOCK</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>