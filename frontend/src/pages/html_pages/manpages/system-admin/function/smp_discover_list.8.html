<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>smp_discover_list - invoke DISCOVER LIST SMP function</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/smp-utils">smp-utils_0.99-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       smp_discover_list - invoke DISCOVER LIST SMP function

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>smp_discover_list</b>  [<u>--adn</u>]  [<u>--brief</u>]  [<u>--cap</u>]  [<u>--descriptor=TY</u>]  [<u>--dsn</u>] [<u>--filter=FI</u>] [<u>--help</u>] [<u>--hex</u>]
       [<u>--ignore</u>]  [<u>--interface=PARAMS</u>]  [<u>--num=NUM</u>]  [<u>--one</u>]  [<u>--phy=ID</u>]  [<u>--raw</u>]  [<u>--sa=SAS_ADDR</u>]  [<u>--summary</u>]
       [<u>--verbose</u>] [<u>--version</u>] [<u>--zpi=FN</u>] <u>SMP_DEVICE[,N]</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Sends  one  or more SAS Serial Management Protocol (SMP) DISCOVER LIST function requests to an SMP target
       and decodes or outputs the responses. The SMP target is identified by the <u>SMP_DEVICE</u>  and  the  <u>SAS_ADDR</u>.
       Depending  on  the  interface,  the  <u>SAS_ADDR</u> may be deduced from the <u>SMP_DEVICE</u>.  The mpt interface uses
       <u>SMP_DEVICE</u> to identify a HBA (an SMP initiator) and needs the additional <u>,N</u> to differentiate between HBAs
       if there are multiple present.

       If the <u>--phy=ID</u> option is not given then <u>--summary</u> is assumed. When <u>--summary</u> is given or  assumed,  this
       utility  shows  the  disposition of each active expander phy in table form. One row is shown for each phy
       and is described in the SINGLE LINE PER PHY FORMAT section below. For this purpose disabled expander phys
       and those with errors are considered "active" and can be suppressed from the output by adding the <u>--brief</u>
       option.

       The DISCOVER LIST response may contain up to 8 descriptors  when  the  "descriptor  type"  field  in  the
       request  is  set  to 0 (e.g. <u>--descriptor=0</u>). The DISCOVER LIST response may contain up to 40 descriptors
       when the "descriptor type" field in the request is set to 1 (e.g. <u>--descriptor=1</u>). Multiple DISCOVER LIST
       requests will be made if more descriptors are requested (e.g. <u>--summary</u> requests 254)  and  the  previous
       response indicates that more descriptors may be available.

       Rather  than  supply  options and <u>SMP_DEVICE[,N]</u> on every invocation some can be supplied via environment
       variables. See the section on ENVIRONMENT VARIABLES below.

</pre><h4><b>OPTIONS</b></h4><pre>
       Mandatory arguments to long options are mandatory for short options as well.

       <b>-A</b>, <b>--adn</b>
              causes the "attached device name" field to be output when the <u>--one</u> or <u>--summary</u>  option  is  also
              given.  See the section below on SINGLE LINE PER PHY FORMAT. Note the "attached device name" field
              is not available in the short format (e.g. <u>--descriptor=1</u>).

       <b>-b</b>, <b>--brief</b>
              reduce the decoded response output.

       <b>-c</b>, <b>--cap</b>
              decode and print phy capabilities bits fields (see SNW-3 in draft). Each expander phy has three of
              these fields: programmed, current and attached.  By default these fields are only printed  out  in
              hex,  or  not  at  all  if  the  <u>--brief</u> option is given or implied. Of the three the attached phy
              capability field is probably the most interesting. If the <u>--verbose</u>  option  is  given,  then  the
              various "G" identifiers are expanded (e.g. instead of "G4:" it prints "G4 (12 Gbps):").

       <b>-d</b>, <b>--descriptor</b>=<u>TY</u>
              set the "descriptor type" field in the request. When <u>TY</u> is 0 then the 120 byte response defined by
              the  DISCOVER  function  response  (less  its  CRC  field)  is  placed  in the descriptors of this
              function's response. When <u>TY</u> is 1 the short format (i.e. 24 byte per  descriptor)  information  is
              placed in the descriptors of this function's response.

       <b>-D</b>, <b>--dsn</b>
              outputs the device slot number at the end of each summary line. In summary mode one line is output
              per  expander phy. It is output in the form "dsn=&lt;val&gt;" where &lt;val&gt; is decimal in the range from 0
              to 254 inclusive.  It is not output if it is not available or has the value 255. The  device  slot
              number  is  not  available  in  short  format,  so  with  this  option  in  summary  mode,  if the
              <u>--descriptor=1</u> is not given, then the longer format is chosen. An expander  typically  contains  a
              SES device which yields device slot numbers in its Additional Element Status diagnostic page.

       <b>-f</b>, <b>--filter</b>=<u>FI</u>
              set  the  filter field in the request. When <u>FI</u> is 0 (default) fetch descriptors for all phys. When
              <u>FI</u> is 1 only fetch descriptors for phys attached to (other) expanders. When <u>FI</u>  is  2  only  fetch
              descriptors  for phys attached to expanders, SAS or SATA devices. When <u>FI</u> is 1 or 2, expander phys
              that would yield "phy vacant" (indicating they are hidden by zoning) are filtered out.

       <b>-h</b>, <b>--help</b>
              output the usage message then exit.

       <b>-H</b>, <b>--hex</b>
              output the response (less the CRC field) in hexadecimal.

       <b>-i</b>, <b>--ignore</b>
              sets the Ignore Zone Group bit in the SMP Discover list request.

       <b>-I</b>, <b>--interface</b>=<u>PARAMS</u>
              interface specific parameters. In this case "interface" refers to the path through  the  operating
              system to the SMP initiator. See the smp_utils man page for more information.

       <b>-n</b>, <b>--num</b>=<u>NUM</u>
              maximum  number of descriptors fetch. If any descriptors are in the response the first phy id will
              be greater than or equal to the argument of <u>--phy=ID</u>. Note that maximum SMP  frame  size  is  1032
              bytes  (including  a  trailing  4  byte CRC) which may limit the number of descriptors that can be
              fetched by a single DISCOVER LIST function (especially when '--descriptor=0').

       <b>-o</b>, <b>--one</b>
              use one line (summarized) format for each descriptor in the response.   The  default  action  when
              this option is not given is to output multiple indented lines for each descriptor in the response.
              See the section below on SINGLE LINE PER PHY FORMAT.

       <b>-p</b>, <b>--phy</b>=<u>ID</u>
              phy identifier. <u>ID</u> is a value between 0 and 254.  This is the starting (lowest numbered) phy id to
              fetch  in  the  response.   Note  that  due  to  the filter field setting, the first phy id in the
              response may be greater than the argument to this option.

       <b>-r</b>, <b>--raw</b>
              send the response (less the CRC field) to stdout in binary. All error messages are sent to stderr.

       <b>-s</b>, <b>--sa</b>=<u>SAS_ADDR</u>
              specifies the SAS address of the SMP target device. Typically this is an expander. This option may
              not be needed if the <u>SMP_DEVICE</u> has the target's SAS address within it. The <u>SAS_ADDR</u> is in decimal
              but most SAS addresses are shown in hexadecimal. To give a number in hexadecimal either prefix  it
              with '0x' or put a trailing 'h' on it.

       <b>-S</b>, <b>--summary</b>
              output  a  multi line summary, with one line per active phy. Checks up to 254 phys starting at phy
              identifier <u>ID</u> (which defaults to 0).  Equivalent to '-o -d 1 -n 254 -b' unless  the  <u>--adn</u>  option
              was  also  given, in which case it is equivalent to '-o -d 0 -n 254 -b' . See the section below on
              SINGLE LINE PER PHY FORMAT.

       <b>-v</b>, <b>--verbose</b>
              increase the verbosity of the output. Can be used multiple times.

       <b>-V</b>, <b>--version</b>
              print the version string and then exit.

       <b>-Z</b>, <b>--zpi</b>=<u>FN</u>
              <u>FN</u> is a file that will be created or truncated then have zone phy information written to it  in  a
              format  suitable for input to the smp_conf_zone_phy_info utility's <u>--pconf=FN</u> option. If <u>--num=NUM</u>
              is not given it is set to 254. The output will start from phy_id 0 unless <u>--phy=ID</u> is given.

</pre><h4><b>SINGLE</b> <b>LINE</b> <b>PER</b> <b>PHY</b> <b>FORMAT</b></h4><pre>
       The <u>--summary</u> (or <u>--one</u>) option causes SMP DISCOVER LIST descriptors to be compressed  to  one  line  per
       phy.  To  save  space  SAS  addresses  are  shown in hex without a '0x' prefix or 'h' suffix.  The header
       section outputs information found in the DISCOVER LIST response's header section.

       For each descriptor in the DISCOVER LIST response, one line is output starting with "  phy   &lt;n&gt;:"  where
       &lt;n&gt;  is  the  phy  identifier  (and  they  are  origin  zero).  That is followed by the routing attribute
       represented by a single letter which is either "D" for direct routing, "S" for subtractive  routing,  "T"
       or  "U".  Both "T" and "U" imply table routing, the difference is that if REPORT GENERAL indicates "table
       to table supported" then "U" is output to indicate that phy can be part of an enclosure  <b>universal</b>  port;
       otherwise  "T"  is  used. Next comes the negotiated physical link rate which is either "disabled", "reset
       problem" or "spinup hold". Other states are mapped to "attached". This includes enabled phys with nothing
       connected which appear as "attached:[0000000000000000:00]".

       Information shown between the brackets is for the  attached  device.  Phys  that  are  connected  display
       something  like:  "attached:[5000c50000520a2a:01 " where the first number is the attached SAS address (in
       hex) and the second number is the attached device's phy identifier. If the attached device type is  other
       than  an  SAS  or SATA device then one of these abbreviations is output: "exp" (for expander), "fex" (for
       fanout expander) or "res" (for unknown attached device type). If a phy is flagged as "virtual"  then  the
       letter  "V"  appears  next.  Next  are  the protocols supported by the attached device which are shown as
       "i(&lt;list&gt;)" for initiator protocols and/or "t(&lt;list&gt;)" for target protocols. The &lt;list&gt;  is  made  up  of
       "PORT_SEL",  "SSP", "STP", "SMP" and "SATA" with "+" used as a separator.  For example a SAS host adapter
       will most likely appear as: "i(SSP+STP+SMP)".  This completes the information  about  the  attached  phy,
       hence the closing right bracket.

       If  appropriate, the negotiated physical link rate is shown in gigabits per second. Here is an example of
       a line for expander phy identifier 11 connected to a SATA target (or SATA "device"  to  use  the  t13.org
       term):

         phy  11:T:attached:[500605b000000afb:00  t(SATA)]  1.5 Gbps

       If  the  expander has zoning enabled (i.e. REPORT GENERAL response bit for 'zoning enabled' is set) and a
       phy's zone group is other than zg 1 then the phy's zone group is shown (e.g. "ZG:2").

       If the <u>--adn</u> option is given then after the attached SAS address and the attached device's phy identifier
       are output an extra field is inserted containing the "attached device name" field. For a  SAS  disk  this
       should  be  its  target  device  name (in NAA-5 format) and for a SATA disk its WWN (if provided, also in
       NAA-5 format). Also when the <u>--adn</u> option is given the phy speed and zone group are not output  in  order
       to keep the line length reasonable.

       If  the  <u>--dsn</u>  option is given and device slot number information is available for the current phy, then
       "dsn=&lt;num&gt;" is appended to the line.  Device slot numbers range from 0 to 254 with 255 meaning  there  is
       no corresponding slot so it is not listed.

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       If  <u>SMP_DEVICE[,N]</u>  is not given then the SMP_UTILS_DEVICE environment variable is checked and if present
       its contents are used instead.

       If the SAS address (of the SMP target) is not given and it is required  (i.e.   it  is  not  implicit  in
       <u>SMP_DEVICE[,N]</u>)  then  the SMP_UTILS_SAS_ADDR environment variable is checked and if present its contents
       are used as the SAS address. SAS addresses are usually given in  hex  indicated  by  a  leading  '0x'  or
       trailing 'h'.

       A  device  slot number (dsn) is important for establishing the relationship between an expander phy and a
       SES array element. Newer expanders (e.g. SAS-3)  support  dsn_s  in  the  DISCOVER  (and  DISCOVER  LIST)
       functions.  These can be shown, if available, with the --dsn option to smp_discover and smp_discover_list
       utilities.. To ease typing that option often, the SMP_UTILS_DSN environment variableriable,  if  present,
       has the same effect.

</pre><h4><b>NOTES</b></h4><pre>
       In  SAS-2  and  later  both  the  DISCOVER  and  DISCOVER LIST functions are available. The DISCOVER LIST
       function should be favoured for several reasons:  its  response  can  hold  up  to  40  descriptors  each
       describing  the  state  of one expander phy. The vast majority of expander chips on the market support 36
       phys or less so one DISCOVER LIST response will summarize the states of all its phys. With  the  DISCOVER
       function only one expander phy's state is returned in its response. Other advantages of the DISCOVER LIST
       function are its "phy filter" and "descriptor type" function request fields.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       The  SMP  DISCOVER  LIST function was introduced in SAS-2 . After SAS-2 the protocol sections of SAS were
       split into another document series known as the SAS Protocol Layer (SPL) and it was standardized  as  SPL
       ANSI  INCITS  476-2011.  Next came SPL-2 which was standardized as SPL-2 ANSI INCITS 505-2013.  Then came
       SPL-3 which was standardized as SPL-3 ANSI INCITS 492-2015. SPL-4 is near standardization  and  its  most
       recent draft is spl4r13.pdf while SPL-5 work has started and its most recent draft is spl5r03.pdf.

</pre><h4><b>AUTHORS</b></h4><pre>
       Written by Douglas Gilbert.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;dgilbert at interlog dot com&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright © 2006-2018 Douglas Gilbert
       This  software is distributed under a FreeBSD license. There is NO warranty; not even for MERCHANTABILITY
       or FITNESS FOR A PARTICULAR PURPOSE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>smp_utils,</b> <b>smp_discover,</b> <b>smp_phy_control,</b> <b>smp_conf_zone_phy_info</b>

smp_utils-0.99                                    February 2018                             <u><a href="../man8/SMP_DISCOVER_LIST.8.html">SMP_DISCOVER_LIST</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>