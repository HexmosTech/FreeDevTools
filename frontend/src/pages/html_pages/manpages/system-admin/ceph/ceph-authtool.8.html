<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ceph-authtool - ceph keyring manipulation tool</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ceph-common">ceph-common_19.2.1-0ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ceph-authtool - ceph keyring manipulation tool

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ceph-authtool</b> <u>keyringfile</u>
       [ -l | --list ]
       [ -p | --print-key ]
       [ -C | --create-keyring ]
       [ -g | --gen-key ]
       [ --gen-print-key ]
       [ --import-keyring <u>otherkeyringfile</u> ]
       [ -n | --name <u>entityname</u> ]
       [ -a | --add-key <u>base64_key</u> ]
       [ --cap <u>subsystem</u> <u>capability</u> ]
       [ --caps <u>capfile</u> ]
       [ --mode <u>mode</u> ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>ceph-authtool</b>  is a utility to create, view, and modify a Ceph keyring file. A keyring file stores one or
       more Ceph authentication keys and possibly an associated capability specification. Each key is associated
       with an entity name, of the form <b>{client,mon,mds,osd}.name</b>.

       <b>WARNING</b> Ceph provides authentication and protection against man-in-the-middle attacks  once  secret  keys
       are  in  place.   However,  data  over  the wire is not encrypted, which may include the messages used to
       configure said keys. The system is primarily intended to be used in trusted environments.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-l,</b> <b>--list</b>
              will list all keys and capabilities present in the keyring

       <b>-p,</b> <b>--print-key</b>
              will print an encoded key for the specified entityname. This is suitable for the <b>mount</b> <b>-o</b>  <b>secret=</b>
              argument

       <b>-C,</b> <b>--create-keyring</b>
              will create a new keyring, overwriting any existing keyringfile

       <b>-g,</b> <b>--gen-key</b>
              will generate a new secret key for the specified entityname

       <b>--gen-print-key</b>
              will  generate  a  new  secret key for the specified entityname, without altering the keyringfile,
              printing the secret to stdout

       <b>--import-keyring</b> <b>*secondkeyringfile*</b>
              will import the content of a given keyring to the keyringfile

       <b>-n,</b> <b>--name</b> <b>*name*</b>
              specify entityname to operate on

       <b>-a,</b> <b>--add-key</b> <b>*base64_key*</b>
              will add an encoded key to the keyring

       <b>--cap</b> <b>*subsystem*</b> <b>*capability*</b>
              will set the capability for given subsystem

       <b>--caps</b> <b>*capsfile*</b>
              will set all of capabilities associated with a given key, for all subsystems

       <b>--mode</b> <b>*mode*</b>
              will set the desired file mode to the keyring e.g: 0644, defaults to 0600

</pre><h4><b>CAPABILITIES</b></h4><pre>
       The subsystem is the name of a Ceph subsystem: <b>mon</b>, <b>mds</b>, or <b>osd</b>.

       The capability is a string describing what the given user is allowed to do. This  takes  the  form  of  a
       comma separated list of allow clauses with a permission specifier containing one or more of rwx for read,
       write, and execute permission. The <b>allow</b> <b>*</b> grants full superuser permissions for the given subsystem.

       For example:

          # can read, write, and execute objects
          osd = "allow rwx"

          # can access mds server
          mds = "allow"

          # can modify cluster state (i.e., is a server daemon)
          mon = "allow rwx"

       A librados user restricted to a single pool might look like:

          mon = "allow r"

          osd = "allow rw pool foo"

       A client using rbd with read access to one pool and read/write access to another:

          mon = "allow r"

          osd = "allow class-read object_prefix rbd_children, allow pool templates r class-read, allow pool vms rwx"

       A client mounting the file system with minimal permissions would need caps like:

          mds = "allow"

          osd = "allow rw pool data"

          mon = "allow r"

</pre><h4><b>OSD</b> <b>CAPABILITIES</b></h4><pre>
       In general, an osd capability follows the grammar:

          osdcap  := grant[,grant...]
          grant   := allow (match capspec | capspec match)
          match   := [ pool[=]&lt;poolname&gt; | object_prefix &lt;prefix&gt;
                      | namespace[=]&lt;rados-namespace&gt;
                      | tag &lt;application-name&gt; &lt;key&gt;=&lt;value&gt; ]
          capspec := * | [r][w][x] [class-read] [class-write]

       The capspec determines what kind of operations the entity can perform:

          r           = read access to objects
          w           = write access to objects
          x           = can call any class method (same as class-read class-write)
          class-read  = can call class methods that are reads
          class-write = can call class methods that are writes
          * or "all"  = equivalent to rwx, plus the ability to run osd admin commands,
                        i.e. ceph osd tell ...

       The  match criteria restrict a grant based on the pool being accessed.  Grants are additive if the client
       fulfills the match condition. For example, if a client has the osd capabilities: "allow  r  object_prefix
       prefix,  allow  w  pool foo, allow x pool bar", then it has rw access to pool foo, rx access to pool bar,
       and r access to objects whose names begin with 'prefix' in any pool.

</pre><h4><b>CAPS</b> <b>FILE</b> <b>FORMAT</b></h4><pre>
       The caps file format consists of zero or more key/value pairs, one  per  line.  The  key  and  value  are
       separated  by  an <b>=</b>, and the value must be quoted (with <b>'</b> or <b>"</b>) if it contains any whitespace. The key is
       the name of the Ceph subsystem (<b>osd</b>, <b>mds</b>, <b>mon</b>), and the value is the capability string (see above).

</pre><h4><b>EXAMPLE</b></h4><pre>
       To create a new keyring containing a key for client.foo with a 0644 file mode:

          ceph-authtool -C -n client.foo --gen-key keyring --mode 0644

       To associate some capabilities with the key (namely, the ability to mount a Ceph file system):

          ceph-authtool -n client.foo --cap mds 'allow' --cap osd 'allow rw pool=data' --cap mon 'allow r' keyring

       To display the contents of the keyring:

          ceph-authtool -l keyring

       When mounting a Ceph file system, you can grab the appropriately encoded secret key with:

          mount -t ceph serverhost:/ mountpoint -o name=foo,secret=`ceph-authtool -p -n client.foo keyring`

</pre><h4><b>AVAILABILITY</b></h4><pre>
       <b>ceph-authtool</b> is part of Ceph, a massively scalable,  open-source,  distributed  storage  system.  Please
       refer to the Ceph documentation at <u>https://docs.ceph.com</u> for more information.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/ceph.8.html">ceph</a></u>(8)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2010-2014,  Inktank  Storage,  Inc.  and  contributors. Licensed under Creative Commons Attribution Share
       Alike 3.0 (CC-BY-SA-3.0)

dev                                               May 22, 2025                                  <u><a href="../man8/CEPH-AUTHTOOL.8.html">CEPH-AUTHTOOL</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>