<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ceph-volume - Ceph OSD deployment and inspection tool</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ceph-volume">ceph-volume_19.2.1-0ubuntu3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ceph-volume - Ceph OSD deployment and inspection tool

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ceph-volume</b> [-h] [--cluster CLUSTER] [--log-level LOG_LEVEL] [--log-path LOG_PATH]

       <b>ceph-volume</b> <b>inventory</b>

       <b>ceph-volume</b> <b>lvm</b> [ <u>trigger</u> | <u>create</u> | <u>activate</u> | <u>prepare</u> | <u>zap</u> | <u>list</u> | <u>batch</u> | <u>new-wal</u> | <u>new-db</u> | <u>migrate</u>
       ]

       <b>ceph-volume</b> <b>simple</b> [ <u>trigger</u> | <u>scan</u> | <u>activate</u> ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>ceph-volume</b> is a single purpose command line tool to deploy logical volumes as OSDs, trying to maintain a
       similar API to <b>ceph-disk</b> when preparing, activating, and creating OSDs.

       It  deviates from <b>ceph-disk</b> by not interacting or relying on the udev rules that come installed for Ceph.
       These rules allow automatic detection of previously setup devices that are in turn fed into <b>ceph-disk</b>  to
       activate them.

</pre><h4><b>COMMANDS</b></h4><pre>
   <b>inventory</b>
       This  subcommand  provides  information about a host's physical disc inventory and reports metadata about
       these discs. Among this metadata one can find disc specific data items (like model, size,  rotational  or
       solid  state)  as  well as data items specific to ceph using a device, such as if it is available for use
       with ceph or if logical volumes are present.

       Examples:

          ceph-volume inventory
          ceph-volume inventory /dev/sda
          ceph-volume inventory --format json-pretty

       Optional arguments:

       <b>-h,</b> <b>--help</b>
              show the help message and exit

       <b>--format</b>
              report format, valid values are <b>plain</b> (default), <b>json</b> and <b>json-pretty</b>

   <b>lvm</b>
       By making use of LVM tags, the <b>lvm</b> sub-command is able to store and later re-discover and  query  devices
       associated with OSDs so that they can later activated.

       Subcommands:

   <b>batch</b>
       Creates  OSDs  from  a  list  of devices using a <b>bluestore</b> (default) setup.  It will create all necessary
       volume groups and logical volumes required to have a working OSD.

       Example usage with three devices:

          ceph-volume lvm batch --bluestore /dev/sda /dev/sdb /dev/sdc

       Optional arguments:

       <b>-h,</b> <b>--help</b>
              show the help message and exit

       <b>--bluestore</b>
              Use the bluestore objectstore (default)

       <b>--yes</b>  Skip the report and prompt to continue provisioning

       <b>--prepare</b>
              Only prepare OSDs, do not activate

       <b>--dmcrypt</b>
              Enable encryption for the underlying OSD devices

       <b>--crush-device-class</b>
              Define a CRUSH device class to assign the OSD to

       <b>--no-systemd</b>
              Do not enable or create any systemd units

       <b>--osds-per-device</b>
              Provision more than 1 (the default) OSD per device

       <b>--report</b>
              Report what the potential outcome would be for the current input (requires devices  to  be  passed
              in)

       <b>--format</b>
              Output  format  when  reporting  (used  along  with --report), can be one of 'pretty' (default) or
              'json'

       <b>--block-db-size</b>
              Set (or override) the "bluestore_block_db_size" value, in bytes

       <b>--journal-size</b>
              Override the "osd_journal_size" value, in megabytes

       Required positional arguments:

       <b>&lt;DEVICE&gt;</b>
              Full path to a raw device, like <b>/dev/sda</b>. Multiple <b>&lt;DEVICE&gt;</b> paths can be passed in.

   <b>activate</b>
       Enables a systemd unit that persists the OSD ID and its UUID (also called <b>fsid</b> in  Ceph  CLI  tools),  so
       that at boot time it can understand what OSD is enabled and needs to be mounted.

       Usage:

          ceph-volume lvm activate --bluestore &lt;osd id&gt; &lt;osd fsid&gt;

       Optional Arguments:

       <b>-h,</b> <b>--help</b>
              show the help message and exit

       <b>--auto-detect-objectstore</b>
              Automatically detect the objectstore by inspecting the OSD

       <b>--bluestore</b>
              bluestore objectstore (default)

       <b>--all</b>  Activate all OSDs found in the system

       <b>--no-systemd</b>
              Skip creating and enabling systemd units and starting of OSD services

       Multiple OSDs can be activated at once by using the (idempotent) <b>--all</b> flag:

          ceph-volume lvm activate --all

   <b>prepare</b>
       Prepares  a  logical  volume to be used as an OSD and journal using a <b>bluestore</b> (default) setup.  It will
       not create or modify the logical volumes except for adding extra metadata.

       Usage:

          ceph-volume lvm prepare --bluestore --data &lt;data lv&gt; --journal &lt;journal device&gt;

       Optional arguments:

       <b>-h,</b> <b>--help</b>
              show the help message and exit

       <b>--journal</b> <b>JOURNAL</b>
              logical group name, path to a logical volume, or path to a device

       <b>--bluestore</b>
              Use the bluestore objectstore (default)

       <b>--block.wal</b>
              Path to a bluestore block.wal logical volume or partition

       <b>--block.db</b>
              Path to a bluestore block.db logical volume or partition

       <b>--dmcrypt</b>
              Enable encryption for the underlying OSD devices

       <b>--osd-id</b> <b>OSD_ID</b>
              Reuse an existing OSD id

       <b>--osd-fsid</b> <b>OSD_FSID</b>
              Reuse an existing OSD fsid

       <b>--crush-device-class</b>
              Define a CRUSH device class to assign the OSD to

       Required arguments:

       <b>--data</b> A logical group name or a path to a logical volume

       For encrypting an OSD, the <b>--dmcrypt</b> flag must be added when preparing  (also  supported  in  the  <b>create</b>
       sub-command).

   <b>create</b>
       Wraps the two-step process to provision a new osd (calling <b>prepare</b> first and then <b>activate</b>) into a single
       one.  The  reason  to prefer <b>prepare</b> and then <b>activate</b> is to gradually introduce new OSDs into a cluster,
       and avoiding large amounts of data being rebalanced.

       The single-call process unifies exactly what <b>prepare</b> and <b>activate</b> do, with the convenience  of  doing  it
       all at once. Flags and general usage are equivalent to those of the <b>prepare</b> and <b>activate</b> subcommand.

   <b>trigger</b>
       This  subcommand  is not meant to be used directly, and it is used by systemd so that it proxies input to
       <b>ceph-volume</b> <b>lvm</b> <b>activate</b> by parsing the input from systemd, detecting the UUID and ID associated with  an
       OSD.

       Usage:

          ceph-volume lvm trigger &lt;SYSTEMD-DATA&gt;

       The systemd "data" is expected to be in the format of:

          &lt;OSD ID&gt;-&lt;OSD UUID&gt;

       The  lvs  associated  with  the  OSD  need  to have been prepared previously, so that all needed tags and
       metadata exist.

       Positional arguments:

       <b>&lt;SYSTEMD_DATA&gt;</b>
              Data from a systemd unit containing ID and UUID of the OSD.

   <b>list</b>
       List devices or logical volumes associated with Ceph. An  association  is  determined  if  a  device  has
       information  relating  to  an  OSD.  This  is verified by querying LVM's metadata and correlating it with
       devices.

       The lvs associated with the OSD need to have been prepared previously by ceph-volume so that  all  needed
       tags and metadata exist.

       Usage:

          ceph-volume lvm list

       List a particular device, reporting all metadata about it:

          ceph-volume lvm list /dev/sda1

       List  a  logical  volume,  along  with  all its metadata (vg is a volume group, and lv the logical volume
       name):

          ceph-volume lvm list {vg/lv}

       Positional arguments:

       <b>&lt;DEVICE&gt;</b>
              Either in the form of <b>vg/lv</b>  for  logical  volumes,  <b>/path/to/sda1</b>  or  <b>/path/to/sda</b>  for  regular
              devices.

   <b>zap</b>
       Zaps  the given logical volume or partition. If given a path to a logical volume it must be in the format
       of vg/lv. Any file systems present on the given lv or partition will be removed  and  all  data  will  be
       purged.

       However, the lv or partition will be kept intact.

       Usage, for logical volumes:

          ceph-volume lvm zap {vg/lv}

       Usage, for logical partitions:

          ceph-volume lvm zap /dev/sdc1

       For full removal of the device use the <b>--destroy</b> flag (allowed for all device types):

          ceph-volume lvm zap --destroy /dev/sdc1

       Multiple devices can be removed by specifying the OSD ID and/or the OSD FSID:

          ceph-volume lvm zap --destroy --osd-id 1
          ceph-volume lvm zap --destroy --osd-id 1 --osd-fsid C9605912-8395-4D76-AFC0-7DFDAC315D59

       Positional arguments:

       <b>&lt;DEVICE&gt;</b>
              Either  in  the  form  of  <b>vg/lv</b>  for  logical  volumes, <b>/path/to/sda1</b> or <b>/path/to/sda</b> for regular
              devices.

   <b>new-wal</b>
       Attaches the given logical volume to OSD as a WAL. Logical volume name format is vg/lv. Fails if OSD  has
       already got attached WAL.

       Usage:

          ceph-volume lvm new-wal --osd-id OSD_ID --osd-fsid OSD_FSID --target &lt;target lv&gt;

       Optional arguments:

       <b>-h,</b> <b>--help</b>
              show the help message and exit

       <b>--no-systemd</b>
              Skip checking OSD systemd unit

       Required arguments:

       <b>--target</b>
              logical volume name to attach as WAL

   <b>new-db</b>
       Attaches  the  given logical volume to OSD as a DB. Logical volume name format is vg/lv. Fails if OSD has
       already got attached DB.

       Usage:

          ceph-volume lvm new-db --osd-id OSD_ID --osd-fsid OSD_FSID --target &lt;target lv&gt;

       Optional arguments:

       <b>-h,</b> <b>--help</b>
              show the help message and exit

       <b>--no-systemd</b>
              Skip checking OSD systemd unit

       Required arguments:

       <b>--target</b>
              logical volume name to attach as DB

   <b>migrate</b>
       Moves BlueFS data from source volume(s) to the target one, source volumes (except the main, i.e. data  or
       block  one)  are  removed on success. LVM volumes are permitted for Target only, both already attached or
       new one. In the latter case it is attached to the OSD replacing one  of  the  source  devices.  Following
       replacement rules apply (in the order of precedence, stop on the first match):

          • if source list has DB volume - target device replaces it.

          • if source list has WAL volume - target device replace it.

          • if  source  list has slow volume only - operation is not permitted, requires explicit allocation via
            new-db/new-wal command.

       Usage:

          ceph-volume lvm migrate --osd-id OSD_ID --osd-fsid OSD_FSID --target &lt;target lv&gt; --from {data|db|wal} [{data|db|wal} ...]

       Optional arguments:

       <b>-h,</b> <b>--help</b>
              show the help message and exit

       <b>--no-systemd</b>
              Skip checking OSD systemd unit

       Required arguments:

       <b>--from</b> list of source device type names

       <b>--target</b>
              logical volume to move data to

   <b>simple</b>
       Scan legacy OSD directories or data devices that may have been created by ceph-disk, or manually.

       Subcommands:

   <b>activate</b>
       Enables a systemd unit that persists the OSD ID and its UUID (also called <b>fsid</b> in  Ceph  CLI  tools),  so
       that  at  boot  time  it  can  understand  what  OSD  is  enabled  and needs to be mounted, while reading
       information that was previously created and persisted at <b>/etc/ceph/osd/</b> in JSON format.

       Usage:

          ceph-volume simple activate --bluestore &lt;osd id&gt; &lt;osd fsid&gt;

       Optional Arguments:

       <b>-h,</b> <b>--help</b>
              show the help message and exit

       <b>--bluestore</b>
              bluestore objectstore (default)

       <b>NOTE:</b>
          It requires a matching JSON file with the following format:

              /etc/ceph/osd/&lt;osd id&gt;-&lt;osd fsid&gt;.json

   <b>scan</b>
       Scan a running OSD or data device for an OSD for metadata that can later be used to activate  and  manage
       the  OSD  with  ceph-volume.  The  scan method will create a JSON file with the required information plus
       anything found in the OSD directory as well.

       Optionally, the JSON blob can be sent to stdout for further inspection.

       Usage on all running OSDs:

          ceph-volume simple scan

       Usage on data devices:

          ceph-volume simple scan &lt;data device&gt;

       Running OSD directories:

          ceph-volume simple scan &lt;path to osd dir&gt;

       Optional arguments:

       <b>-h,</b> <b>--help</b>
              show the help message and exit

       <b>--stdout</b>
              Send the JSON blob to stdout

       <b>--force</b>
              If the JSON file exists at destination, overwrite it

       Optional Positional arguments:

       <b>&lt;DATA</b> <b>DEVICE</b> <b>or</b> <b>OSD</b> <b>DIR&gt;</b>
              Actual data partition or a path to the running OSD

   <b>trigger</b>
       This subcommand is not meant to be used directly, and it is used by systemd so that it proxies  input  to
       <b>ceph-volume</b>  <b>simple</b> <b>activate</b> by parsing the input from systemd, detecting the UUID and ID associated with
       an OSD.

       Usage:

          ceph-volume simple trigger &lt;SYSTEMD-DATA&gt;

       The systemd "data" is expected to be in the format of:

          &lt;OSD ID&gt;-&lt;OSD UUID&gt;

       The JSON file associated with the OSD need to have been persisted previously by a scan (or manually),  so
       that all needed metadata can be used.

       Positional arguments:

       <b>&lt;SYSTEMD_DATA&gt;</b>
              Data from a systemd unit containing ID and UUID of the OSD.

</pre><h4><b>AVAILABILITY</b></h4><pre>
       <b>ceph-volume</b>  is part of Ceph, a massively scalable, open-source, distributed storage system. Please refer
       to the documentation at <u><a href="http://docs.ceph.com/">http://docs.ceph.com/</a></u> for more information.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/ceph-osd.8.html">ceph-osd</a></u>(8),

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2010-2014, Inktank Storage, Inc. and contributors. Licensed  under  Creative  Commons  Attribution  Share
       Alike 3.0 (CC-BY-SA-3.0)

dev                                               May 22, 2025                                    <u><a href="../man8/CEPH-VOLUME.8.html">CEPH-VOLUME</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>