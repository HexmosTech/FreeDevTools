<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xdp-loader - an XDP program loader</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/xdp-tools">xdp-tools_1.5.1-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       xdp-loader - an XDP program loader

</pre><h4><b>SYNOPSIS</b></h4><pre>
       XDP-loader  is  a simple loader for XDP programs with support for attaching multiple programs to the same
       interface. To achieve this it exposes the same load and unload semantics exposed by the  libxdp  library.
       See the <u><a href="../man3/libxdp.3.html">libxdp</a>(3)</u> man page for details of how this works, and what kernel features it relies on.

   <b>Running</b> <b>xdp-loader</b>
       The syntax for running xdp-loader is:

              xdp-loader COMMAND [options]

              Where COMMAND can be one of:
                     load        - load an XDP program on an interface
                     unload      - unload an XDP program from an interface
                     status      - show current XDP program status
                     features    - show XDP features supported by the NIC
                     clean       - clean up detached program links in XDP bpffs directory
                     help        - show the list of available commands

       Each  command,  and  its options are explained below. Or use <u>xdp-loader</u> <u>COMMAND</u> <u>--help</u> to see the options
       for each command.

</pre><h4><b>The</b> <b>LOAD</b> <b>command</b></h4><pre>
       The <u>load</u> command loads one or more XDP programs onto an interface.

       The syntax for the <u>load</u> command is:

       <u>xdp-loader</u> <u>load</u> <u>[options]</u> <u>&lt;ifname&gt;</u> <u>&lt;programs&gt;</u>

       Where <u>&lt;ifname&gt;</u> is the name of the interface to load the programs onto, and the <u>&lt;programs&gt;</u> is one or  more
       file  names containing XDP programs. The programs will be loaded onto the interface in the order of their
       preference, as specified by the program metadata (see <b><a href="../man3/libxdp.3.html">libxdp</a>(3)</b>).

       The supported options are:

   <b>-m,</b> <b>--mode</b> <b>&lt;mode&gt;</b>
       Specifies which mode to load the XDP program to be loaded in. The valid values are 'native', which is the
       default in-driver XDP mode, 'skb', which causes the so-called <u>skb</u> <u>mode</u> (also known as <u>generic</u> <u>XDP</u>) to  be
       used,  'hw' which causes the program to be offloaded to the hardware, or 'unspecified' which leaves it up
       to the kernel to pick a mode (which it will do by picking native mode  if  the  driver  supports  it,  or
       generic  mode  otherwise).  Note  that  using  'unspecified' can make it difficult to predict what mode a
       program will end up being loaded in. For this reason, the default is 'native'. Note  that  hardware  with
       support for the 'hw' mode is rare: Netronome/Corigine cards (using the 'nfp' driver) are the only devices
       with support for this in the mainline Linux kernel.

   <b>-p,</b> <b>--pin-path</b> <b>&lt;path&gt;</b>
       This  specifies  a  root  path  under  which to pin any maps that define the 'pinning' attribute in their
       definitions. This path must be located on a <u>bpffs</u> file system. If not set, maps will not be pinned,  even
       if they specify pinning in their definitions. When pinning maps, if the pinned location for a map already
       exist, the map pinned there will be reused if it is compatible with the type of the map being loaded.

   <b>-s,</b> <b>--section</b> <b>&lt;section&gt;</b>
       Specify  which  ELF section to load the XDP program(s) from in each file. The default is to use the first
       program in each file. If this option is set, it applies to all programs being loaded.

   <b>-n,</b> <b>--prog-name</b> <b>&lt;prog_name&gt;</b>
       Specify which BPF program with the name to load the XDP program(s) from in each file. The default  is  to
       use  the  first  program  in  each  file. Only one of --section and --prog-name may be specified. If this
       option is set, it applies to all programs being loaded.

   <b>-P,</b> <b>--prio</b> <b>&lt;priority&gt;</b>
       Specify the priority to load the XDP program(s) with (this affects the order of programs running  on  the
       interface).  The  default is to use the value from the metadata in the program ELF file, or a value of 50
       if the program has no such metadata.  If this option is set, it applies to all programs being loaded.

   <b>-A,</b> <b>--actions</b> <b>&lt;actions&gt;</b>
       Specify the "chain call actions" of the loaded XDP program(s). These are the XDP actions that will  cause
       the  next  program loaded on the interface to be called, instead of returning immediately. The default is
       to use the value set in the metadata in the program ELF file, or XDP_PASS if no such metadata is set.  If
       this option is set, it applies to all programs being loaded.

   <b>-v,</b> <b>--verbose</b>
       Enable debug logging. Specify twice for even more verbosity.

   <b>-h,</b> <b>--help</b>
       Display a summary of the available options

</pre><h4><b>The</b> <b>UNLOAD</b> <b>command</b></h4><pre>
       The <u>unload</u> command is used for unloading programs from an interface.

       The syntax for the <u>unload</u> command is:

       <u>xdp-loader</u> <u>unload</u> <u>[options]</u> <u>&lt;ifname&gt;</u>

       Where  <u>&lt;ifname&gt;</u>  is the name of the interface to load the programs onto. Either the <u>--all</u> or <u>--id</u> options
       must be used to specify which program(s) to unload.

       The supported options are:

   <b>-i,</b> <b>--id</b> <b>&lt;id&gt;</b>
       Unload a single program from the interface by ID. Use <u>xdp-loader</u> <u>status</u> to obtain the ID of  the  program
       being  unloaded. If this program is the last program loaded on the interface, the dispatcher program will
       also be removed, which makes the operation equivalent to specifying <u>--all</u>.

   <b>-a,</b> <b>--all</b>
       Unload all XDP programs on the interface, as well as the multi-program dispatcher.

   <b>-v,</b> <b>--verbose</b>
       Enable debug logging. Specify twice for even more verbosity.

   <b>-h,</b> <b>--help</b>
       Display a summary of the available options

</pre><h4><b>The</b> <b>STATUS</b> <b>command</b></h4><pre>
       The <u>status</u> command displays a list of interfaces in the system, and the XDP  program(s)  loaded  on  each
       interface.  For  each  interface, a list of programs are shown, with the run priority and "chain actions"
       for each program. See the section on program metadata for the meaning of this metadata.

   <b>-v,</b> <b>--verbose</b>
       Enable debug logging. Specify twice for even more verbosity.

   <b>-h,</b> <b>--help</b>
       Display a summary of the available options

</pre><h4><b>The</b> <b>FEATURES</b> <b>command</b></h4><pre>
       The <u>features</u> command displays the XDP features supported by the NIC.

       Currently supported XDP features are:

   <b>NETDEV_XDP_ACT_BASIC</b>
       The networking device has basic support for running XDP programs, and can handle the base set  of  return
       codes (XDP_ABORTED, XDP_DROP, XDP_PASS, XDP_TX).

   <b>NETDEV_XDP_ACT_REDIRECT</b>
       The  network  device supports handling the XDP_REDIRECT return code. This means packets can be redirected
       from this device by XDP.

   <b>NETDEV_XDP_ACT_NDO_XMIT</b>
       The networking interfaces implements the ndo_xdp_xmit callback. This means packets can be  redirected  to
       this device by XDP.

   <b>NETDEV_XDP_ACT_XSK_ZEROCOPY</b>
       The networking device supports AF_XDP in zero copy mode.

   <b>NETDEV_XDP_ACT_HW_OFFLOAD</b>
       The networking device supports XDP hw offloading.

   <b>NETDEV_XDP_ACT_RX_SG</b>
       The  networking  device  supports  non-linear XDP frames on the receive side.  This means XDP can be used
       with big MTUs on this device (if the XDP program is compiled with fragments support)

   <b>NETDEV_XDP_ACT_NDO_XMIT_SG</b>
       The networking device supports non-linear XDP frames on the transmit side. This means  non-linear  frames
       can be redirected to this device.

</pre><h4><b>The</b> <b>CLEAN</b> <b>command</b></h4><pre>
       The syntax for the <u>clean</u> command is:

       <u>xdp-loader</u> <u>clean</u> <u>[options]</u> <u>[ifname]</u>

       The  <u>clean</u>  command  cleans  up  any  detached  program links in the XDP bpffs directory.  When a network
       interface disappears, any programs loaded in software mode (e.g. skb, native) remain pinned in the  bpffs
       directory,  but  become  detached  from the interface. These need to be unlinked from the filesystem. The
       <u>clean</u> command takes an optional interface parameter to only unlink detached programs corresponding to the
       interface.  By default, all detached programs for all interfaces are unlinked.

       The supported options are:

   <b>-v,</b> <b>--verbose</b>
       Enable debug logging. Specify twice for even more verbosity.

   <b>-h,</b> <b>--help</b>
       Display a summary of the available options

</pre><h4><b>Examples</b></h4><pre>
       To load an XDP program on the eth0 interface simply do:

              # xdp-loader load eth0 xdp_drop.o
              # xdp-loader status

              CURRENT XDP PROGRAM STATUS:

              Interface        Prio  Program name     Mode     ID   Tag               Chain actions
              -------------------------------------------------------------------------------------
              lo               &lt;no XDP program&gt;
              eth0                   xdp_dispatcher   native   50   d51e469e988d81da
               =&gt;              50    xdp_drop                  55   57cd311f2e27366b  XDP_PASS

       Which shows that a dispatcher program was loaded on the interface, and the xdp_drop program was installed
       as the first (and only) component program after it. In this instance, the program does not specify any of
       the metadata above, so the defaults (priority 50 and XDP_PASS as its chain call action) was used.

       To use the automatic map pinning, include the <u>pinning</u> attribute into the map definition in  the  program,
       something like:

              struct {
                      __uint(type, BPF_MAP_TYPE_ARRAY);
                      __uint(max_entries, 10);
                      __type(key, __u32);
                      __type(value, __u64);
                      __uint(pinning, LIBBPF_PIN_BY_NAME);
              } my_map SEC(".maps");

       And load it with the <u>--pin-path</u> attribute:

              # xdp-loader load eth0 my_prog.o --pin-path /sys/fs/bpf/my-prog

       This  will  pin  the  map  at  <u>/sys/fs/bpf/my-prog/my_map</u>. If this already exists, the pinned map will be
       reused instead of creating a new one, which allows different BPF programs to share the map.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/libxdp.3.html">libxdp</a>(3)</u> for details on the XDP loading semantics and kernel compatibility requirements.

</pre><h4><b>BUGS</b></h4><pre>
       Please report any bugs on Github: <u>https://github.com/xdp-project/xdp-tools/issues</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       xdp-loader and this man page were written by Toke Høiland-Jørgensen.

V1.5.1                                         SEPTEMBER 12, 2024                                  <u><a href="../man8/xdp-loader.8.html">xdp-loader</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>