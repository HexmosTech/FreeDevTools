<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>apt-move - move cache of Debian packages into a mirror hierarchy.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/apt-move">apt-move_4.2.27-7build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       apt-move - move cache of Debian packages into a mirror hierarchy.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>apt-move</b> [<b>-c</b> <u>conffile</u>] [<b>-d</b> <u>dist</u>] [<b>-afqt</b>] <u>command</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>apt-move</b> script is used to move a collection of Debian package files into a proper archive hierarchy
       of the form <b>$LOCALDIR/pool/...</b>  where <b>LOCALDIR</b> is specified in the configuration file.  It is intended as
       a tool to help manage the <b><a href="../man8/apt-get.8.html">apt-get</a></b>(8) file cache, but could be configured to work with any  collection  of
       Debian packages.

       Additionally,  using  the  <u>sync</u> and <u>mirror</u> commands, you can build your own local mirror of portions of a
       selected binary and/or source distribution.

       Running <b>apt-move</b> periodically will assist in  managing  the  resulting  partial  mirror  by  (optionally)
       removing obsolete packages and creating valid local Packages.gz and Sources.gz.

   <b>Commands</b>
       The following commands are accepted by <b>apt-move</b>:

       <b>get</b> [ <u>dir</u> ]
              This  generates  the  master  files  using  Packages and Sources files from the <b><a href="../man8/apt.8.html">apt</a></b>(8) cache.  The
              master files are used to keep track of what packages are available, and where packages  should  be
              installed.  If <u>dir</u> is specified, it will be used in lieu of the <b>LISTSTATE</b> variable.

       <b>getlocal</b> [ <u>dir</u> ]
              This is an alias of get.  It may be removed in future releases.

       <b>move</b>   Moves  a  collection of packages into the local mirror tree.  Uses existing master files (see <u>get</u>)
              to repair any mangling done to the package names.  Any packages that aren't listed in  the  master
              files  or  are  obsolete will be left in the file cache directory.  Obsolete packages will also be
              copied into the archive but they will be removed after the next delete operation.   In  the  these
              two cases, the package is considered to have been skipped.

       <b>delete</b> Delete  obsolete  package  files.   Configurable  through the <u>DELETE</u> and <u>MAXDELETE</u> settings in the
              <b>/etc/apt-move.conf</b> file (see the <u>CONFIGURATION</u> section below).  It also deletes any index files of
              packages that are no longer in the archive.  This means that you can simply delete  packages  from
              the archive without affecting its consistency as long as you run the <b>delete</b> command afterwards.

       <b>packages</b>
              Builds new local versions of Packages.gz and Sources.gz files.

       <b>fsck</b>   Rebuilds all index files used to make Packages and Sources files and reprocess all packages in the
              archive  by  calling <b>movefile</b> on them.  Use this if you are upgrading from an old version (&lt;&lt; 4.2)
              of <b>apt-move</b>.

       <b>update</b> This is an alias, equivalent to '<u>get</u> <u>move</u> <u>delete</u> <u>packages</u>'.  This  is  the  preferred  method  for
              moving package files from your cache into a local mirror.

       <b>local</b>  This is an alias, equivalent to '<u>move</u> <u>delete</u> <u>packages</u>'.

       <b>localupdate</b>
              This is an alias for update.  It may be removed in future releases.

       <b>mirror</b> This  command automatically runs <u>get</u>, then uses <b>/usr/lib/apt-move/fetch</b> and <b><a href="../man8/apt-get.8.html">apt-get</a></b>(8) to download
              any packages missing from your mirror.  The downloaded files will be installed into the repository
              using <u>move</u>.  Finally, it  runs  <u>packages</u>  and  exits.   See  the  <u>DIST</u>  and  <u>PKGTYPE</u>  settings  in
              <b>/etc/apt-move.conf</b>.   Before  using  this  command,  you  need to set up a <b>$LOCALDIR/.exclude</b> file
              containing patterns to exclude unwanted files from your mirror.  See the <b>SAMPLE.exclude</b>  file  for
              an  example.   See also the <u>Exclude</u> <u>file</u> section of <u>NOTES</u> below.  Note that this command will only
              mirror packages for the architecture that you are running on.  It will, however, mirror all source
              packages.

       <b>sync</b>   Similar to the <u>mirror</u> function, but only gets the packages that are currently  installed  on  your
              system.   It  uses  <b><a href="../man8/dpkg.8.html">dpkg</a></b>(8) <u>--get-selections</u> to find out what files to download.  It will skip any
              files that match one of the patterns in the <b>$LOCALDIR/.exclude</b> file (if it exists).  <b>sync</b> will get
              the latest versions of the packages, regardless of the version currently installed on your  system
              (think about it).

       <b>exclude</b>
              This  command is used to test your <b>$LOCALDIR/.exclude</b> pattern file.  It will go through the master
              lists and print any file that matches one of the patters in <b>$LOCALDIR/.exclude</b>.   This  will  show
              you  exactly  what  files you have EXCLUDED from your mirror.  The <b>-t</b> (test) flag has no affect on
              this command.  This uses your existing master files, and does not require an internet connection.

       <b>movefile</b> <u>files...</u>
              This command is similar to move.  Instead of moving files from <u>FILECACHE</u>, it will move  the  files
              specified on the command line.

       <b>copydir</b> <u>directory...</u>
              This  command is similar to movefile.  Instead of moving files from the command line, it will copy
              .deb files from the specified directory.  This is useful for copying the pool of a Debian CD to an
              apt repository.

       <b>listbin</b> [ <b>mirror</b> | <b>sync</b> | <b>repo</b> ]
              This command prints a list of packages which may serve as the input to mirrorbin or mirrorsrc.  If
              the argument is <b>mirror</b> or <b>sync</b>, it will produce the same lists that the <b>mirror</b> and  <b>sync</b>  commands
              use.   If  the argument is <b>repo</b>, the list produced will contain the packages that are currently in
              the apt-move repository.

       <b>mirrorbin</b>
              This command will fetch the list of packages specified on the standard input, and place them  into
              the archive in the same way as <b>mirror</b> does.

       <b>mirrorsrc</b>
              This commands acts like <b>mirrorbin</b>, except that it fetches source packages instead of binary ones.

   <b>Options</b>
       The following options are available from the command line:

       <b>-a</b>     Process  all packages.  By default, commands like <b>listbin</b> and <b>mirrorbin</b> only process packages that
              differ in version between the apt-move repository and the archive  being  mirrored.   This  option
              causes  all  packages to be considered even if the apt-move repository already contains the latest
              version.

       <b>-c</b> <u>conffile</u>
              Use <u>conffile</u> as the configuration file instead of <b>/etc/apt-move.conf</b>.

       <b>-d</b> <u>dist</u>
              Use <u>dist</u> as the default suite instead of the value of <u>DIST</u> from the configuration file.

       <b>-f</b>     Forces deletion of files even when the  percentage  of  files  to  delete  exceeds  the  <u>MAXDELETE</u>
              setting.   This  is  useful  if  <b>apt-move</b> aborts with an error saying that too many files would be
              deleted, and you want to delete the files anyway.  (Use with caution.)  If  you  get  this  error,
              using <b>-ft</b> will show you the complete list of files, so you can verify them before you use <b>-f.</b>

       <b>-q</b>     Suppresses  normal  output.   This  option  is  useful  when <b>apt-move</b> is used in a non-interactive
              script.

       <b>-t</b>     Makes a 'test run' and reports what WOULD be done for <b>option</b> but does not modify any of the  cache
              or mirror files.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       Before  using  <b>apt-move</b>,  edit the <b>/etc/apt-move.conf</b> file to match your local setup.  Always remember to
       use the <u>test</u> parameter after any change in your configuration to make sure it will work like you want  it
       to.   You  may also want to set the <u>DELETE</u> option to <u>no</u> to turn off file deletes until everything else is
       working successfully.

       The file is read as a Bourne shell script.  So  you  must  obey  the  syntactical  rules  of  <b><a href="../man1/sh.1.html">sh</a>(1)</b>.   In
       particular, values with spaces in them must be quoted with single or double quotes.

       The following settings are recognized by <b>apt-move</b> (shown here with their defaults):

       <b>APTSITES=</b>"debian.midco.net non-us.debian.org"
              Set  this  to the names of sites in your <b><a href="file:/etc/apt/sources.list">/etc/apt/sources.list</a></b> that you wish to mirror.  The value
              <b>/all/</b> refers to all non-file URIs.

       <b>LOCALDIR=</b>/mirrors/debian
              This is the full (absolute) path to your debian directory (the top of your local mirror).

       <b>DIST=</b>stable
              This is the default suite assigned to packages when the <u>Release</u> file is missing.  It does not have
              any effect on whether a suite is stored in the archive.

       <b>PKGTYPE=</b>binary
              Set this to your choice of: <u>binary</u>, <u>source</u> or <u>both</u> to tell the <u>mirror</u>,  <u>sync</u>  and  <u>movefile</u>  which
              type(s) of files to get.

       <b>FILECACHE=</b><a href="file:/var/cache/apt/archives">/var/cache/apt/archives</a>
              The  directory  where  your  local cache of packages are. The default will work for the <b><a href="../man8/apt-get.8.html">apt-get</a></b>(8)
              packages, unless you've changed the configuration in <b>/etc/apt/apt.conf</b>.

       <b>LISTSTATE=</b><a href="file:/var/lib/apt/lists">/var/lib/apt/lists</a>
              The directory to your local cache of Packages files. The default  will  work  for  the  <b><a href="../man8/apt-get.8.html">apt-get</a></b>(8)
              packages, unless you've changed the configuration in <b>/etc/apt/apt.conf</b>.

       <b>DELETE=</b>no
              Determines  whether  obsolete  packages  (packages not listed in the master file, or packages that
              have been superceded in the repository) are to be removed.

       <b>MAXDELETE=</b>20
              Maximum percentage of files <b>apt-move</b> is allowed to delete during a normal run.  Anything exceeding
              this will produce an error and abort the script.  I added this as a precaution so that  you  won't
              lose your entire mirror when a new distribution is released.  You can override this (with caution)
              using the <u>-f</u> parameter with <b>apt-move</b>.

       <b>COPYONLY=</b>no
              If  this  is set to yes, then <b>move</b> and <b>movefile</b> will copy instead of move.  That is, the originals
              will be left alone.

       <b>PKGCOMP=</b>gzip
              This should be set to a space-separated list of compression formats that apt-move  should  provide
              when  generating  Packages and Sources files.  The possible values are <b>none</b>, <b>gzip</b> and <b>bzip2</b>.  With
              the current <b>apt</b> package you should include at least <b>none</b>, as otherwise  <b>apt</b>  will  complain  about
              missing files.

       <b>CONTENTS=</b>no
              If this is set to yes, then <b>packages</b> will generate Contents files.

       <b>GPGKEY=</b>
              If  this  is  set  to  non-empty  string, then <b>packages</b> will sign generated Release files with the
              specified key.  You must install <b>gnupg</b> before enabling this option.

       For the <u>sync</u> and <u>mirror</u> commands to function correctly, you need to list your <b>apt-move</b> repository at  the
       top of <b><a href="file:/etc/apt/sources.list">/etc/apt/sources.list</a></b> as a <b>file</b> <b>URI</b>.

</pre><h4><b>FILES</b></h4><pre>
       <b>/usr/bin/apt-move</b>
              The script.

       <b>/etc/apt-move.conf</b>
              Configuration file for the script.

       <b>/usr/share/man/man8/apt-move.8.gz</b>
              The manpage.

       <b>/tmp/MOVE_*</b>
              The temporary files created at runtime.

       <b>/usr/lib/apt-move/fetch</b>
              Utility to fetch files just like <u>apt-get</u> <u>install</u> <u>-d</u>.  Except that no dependency analysis is done.

       <b>.apt-move/*.{binary,</b> <b>source}.local</b>
              Put  entries  of  local  packages  here.  The fields are ``package priority section source version
              task'' for the binary file, and ``package priority section version'' for  the  source  file.   The
              <b>version</b>  field  may  be set to a single dash to refer to the latest version in the archive.  Blank
              lines and lines beginning with a hash are ignored.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/dpkg.8.html">dpkg</a></b>(8), <b><a href="../man8/apt-get.8.html">apt-get</a></b>(8)

</pre><h4><b>NOTES</b></h4><pre>
   <b>Exclude</b> <b>file</b>
       The <u>mirror</u> command uses a file in the <b>$LOCALDIR/</b>  directory  called  '.exclude'  which  contains  exclude
       patterns  that  are  applied  against  the  files  to  be mirrored.  These patterns were created with the
       following limitation: they must work the same with with <b><a href="../man1/grep.1.html">grep</a></b>(1), after any '*'  characters  are  removed.
       Unless you're careful setting this up, you'll get unexpected results.  Run '<b>apt-move</b> <b>-t</b> <b>mirror</b>' first, to
       make  sure  you're  getting the results you intended.  Another way to verify your exclude file is the use
       the <u>exclude</u> command for <b>apt-move</b> to print a list of files your are excluding from your mirror.   See  the
       sample
        .exclude file (SAMPLE.exclude) for an example of an .exclude file.

   <b>Mirroring</b>
       The  <b>apt-move</b>  <b>mirror</b>  and  <b>sync</b> commands do not test for available disk space.  The current potato (main
       binary) distribution is over 1Gb in size.  Add the sources to that and it can  eat  up  the  space  on  a
       partition  really  fast.  I  would advise you to put your mirror somewhere other than the root partition.
       Set up your exclude file and run <b>apt-move</b> <b>-t</b> <b>mirror</b> and examine the result.

   <b>Code</b> <b>names</b>
       Since <b>apt-move</b> gets the suite names from <u>Release</u> files, which usually use the names <u>stable</u>,  <u>testing</u>  and
       <u>unstable</u>,  the  suites  in  the  repository  are  named  accordingly.  You can simulate the code names by
       creating symbolic links in the <u>dists</u> directory.  For example, in order  to  make  <u>testing</u>  equivalent  to
       <u>sarge</u>,  you  could  run <b>ln</b> <b>-s</b> <b>testing</b> <b>$LOCALDIR/dists/sarge</b>.  Alternatively, you could delete the <u>testing</u>
       subdirectory and run <b>ln</b> <b>-s</b> <b>sarge</b> <b>$LOCALDIR/dists/testing</b>.  This will cause future executions of  the  <u>get</u>
       operation to use <u>sarge</u> whenever it sees <u>testing</u> in the <u>Release</u> file.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       <b>apt-move</b> may exit with one of the following error messages:

       <b>Could</b> <b>not</b> <b>read</b> <b>configuration.</b>
              <b>apt-move</b> could not find the <b>/etc/apt-move.conf</b> file.  Run the install script.

       <b>Could</b> <b>not</b> <b>create</b> <b>directory.</b>
              For some reason, a necessary directory could not be created.

       <b>You</b> <b>failed</b> <b>to</b> <b>select</b> <b>a</b> <b>distribution.</b>
              You did not configure a <u>DIST</u> setting in /etc/apt-move.conf.

       <b>You</b> <b>specified</b> <b>an</b> <b>invalid</b> <b>package</b> <b>type.</b>
              You can only use <u>binary</u>, <u>source</u> or <u>both</u> for the PKGTYPE setting.

       <b>No</b> <b>master</b> <b>files</b> <b>exist!</b>
              You  need  to  run  <b>apt-ve</b>  with the <b>get</b> command at least once in order to create the master files
              which determine where packages are to be installed.

       <b>bc</b> <b>calculation</b> <b>returned</b> <b>invalid</b> <b>result</b>
              <b>apt-move</b> uses the <b><a href="../man1/bc.1.html">bc</a></b>(1) program to determine when the number of files to delete  will  exceed  the
              <u>MAXDELETE</u>  setting  in <b>apt-move.conf</b>.  If you get this error, make sure that <u>MAXDELETE</u> is set to a
              number in the range of 1 to 100, without the % sign.  Otherwise you need to report this as a bug.

       <b>Too</b> <b>many</b> <b>files</b> <b>to</b> <b>delete!</b>
              <b>apt-move</b> will report this error if the number of files to be deleted exceeds the <u>MAXDELETE</u> setting
              in <b>apt-move.conf</b>.  You need to study the output to determine if this is normal (in which case  you
              can  override  this using the <u>force</u> parameter), or if its due to some drastic change on the mirror
              site (like a new release) or possibly due to a partial  download  of  the  master  Packages.gz  or
              Sources.gz file.

       <b>Your</b> <b>current</b> <b>mirror</b> <b>directory</b> <b>is</b> <b>incompatible...</b>
              You  have just upgraded from an old version of apt-move.  Update your configuration, then run <u>apt-</u>
              <u>move</u> <u>fsck</u> and finally remove <b>.apt-move/ancient</b>.

       <b>Could</b> <b>not</b> <b>read</b> <b>Release</b> <b>files.</b>
              <b>apt-move</b> could not read the release files needed to build the master files.  Make  sure  you  have
              run <u>apt-get</u> <u>update</u> and try again.

       <b>Failed</b> <b>to</b> <b>remove</b> <b>original</b> <b>files.</b>
              <b>apt-move</b>  could  not  remove  the  original  copies  of  files that have just entered the <b>apt-move</b>
              archive.  Make sure that you have permission to delete those files.

       <b>Please</b> <b>remove</b> <b>$LOCALDIR/backup.</b>
              You must remove <b>LOCALDIR/backup</b> before running the <b>fsck</b> command.

       <b>Unknown</b> <b>DIST</b> <b>setting.</b>
              The value of <u>DIST</u> must match the <b>Archive</b> field in the <b>Release</b> file of the  distribution  that  you
              are trying to mirror.

       <b>Cannot</b> <b>find</b> <b>index</b> <b>files</b> <b>for</b> <b>APTSITES.</b>
              <b>apt-move</b>  could  not  find  any  index files for the <b>get</b> operation.  You should either run <u>apt-get</u>
              <u>update</u>, or run <b>apt-move</b> with <b>-f</b> if only the <u>*.local</u> files have been changed.

</pre><h4><b>BUGS</b></h4><pre>
       The exclusion system was designed prior to the introduction to the  package  pools.   Hence  its  content
       still  relates  to  the old structure of the Debian archive.  This is confusing and it should be replaced
       with a new exclusion system.

       The <u>DIST</u> variable does not control what is actually downloaded by the <b>fetch</b> utility.  It  should  have  a
       similar effect to that of <b>apt-get</b> <b>-t</b>.

</pre><h4><b>AUTHOR</b></h4><pre>
       Michael Merten &lt;<a href="mailto:mikemerten@yahoo.com">mikemerten@yahoo.com</a>&gt;

       Herbert Xu &lt;<a href="mailto:herbert@debian.org">herbert@debian.org</a>&gt;

APT-MOVE                                          2002 Oct 7th                                       <u><a href="../man8/APT-MOVE.8.html">APT-MOVE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>