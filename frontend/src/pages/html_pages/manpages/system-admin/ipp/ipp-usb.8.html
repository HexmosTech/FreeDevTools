<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ipp-usb - Daemon for IPP over USB printer support</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ipp-usb">ipp-usb_0.9.28-0ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>ipp-usb</b> - Daemon for IPP over USB printer support

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>ipp-usb</b>  daemon  enables  driver-less  printing and scanning on USB-only AirPrint-compatible printers and
       MFPs.

       It works by connecting to the device by USB using IPP-over-USB protocol, and exposing the device  to  the
       network, including DNS-SD (ZeroConf) advertising.

       IPP printing, eSCL scanning and web console are fully supported.

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Usage:</b>
       <b>ipp-usb</b> <b>mode</b> <b>[options]</b>

   <b>Modes</b> <b>are:</b>
       <b>standalone</b>
              run forever, automatically discover IPP-over-USB devices and serve them all

       <b>udev</b>   like standalone, but exit when last IPP-over-USB device is disconnected

       <b>debug</b>  logs duplicated on console, -bg option is ignored

       <b>check</b>  check configuration and exit. It also prints a list of all connected devices

       <b>status</b> print status of the running <b>ipp-usb</b> daemon, including information of all connected devices

   <b>Options</b> <b>are</b>
       <b>-bg</b>    run in background (ignored in debug mode)

</pre><h4><b>NETWORKING</b></h4><pre>
       Essentially,  <b>ipp-usb</b>  makes printer or scanner accessible from the network, converting network-side HTTP
       operations to the USB operations.

       By default, <b>ipp-usb</b> exposes device only to the loopback interface,  using  the  <b>localhost</b>  address  (both
       <b>127.0.0.1</b>  and  <b>::1</b>,  for  IPv4  and  IPv6,  respectively).  TCP  ports  are allocated automatically, and
       allocation is persisted in the association with the particular device, so the next  time  the  device  is
       plugged on, it will get the same port. The default port range for TCP ports allocation is <b>60000-65535</b>.

       This  default  behavior  can  be  changed,  using configuration file. See <b>CONFIGURATION</b> section below for
       details.

       If you decide to publish your device to the real network, the  following  things  should  be  taken  into
       consideration:

       1.  Your  <b>private</b>  device  will  become  <b>public</b> and it will become accessible by other computers from the
           network

       2.  Firewall rules needs to be updated appropriately. The <b>ipp-usb</b> daemon will not do it automatically  by
           itself

       3.  IPP  over  USB  specification  explicitly  require  that the <b>Host</b> field in the HTTP request is set to
           <b>localhost</b> or <b>localhost:port</b>. If device is accessed from the real network, <b>Host</b>  header  will  reflect
           the  real  network address. Most of devices allow it, but some are more restrictive and will not work
           in this configuration.

</pre><h4><b>DNS-SD</b> <b>(AVAHI</b> <b>INTEGRATION)</b></h4><pre>
       IPP over USB is intended to be used with the automatic device discovery, and  for  this  purpose  <b>ipp-usb</b>
       advertises  all  devices  it  handles,  using DNS-SD protocol. On Linux, DNS-SD is handled with a help of
       Avahi daemon.

       DNS-SD advertising can be disabled via configuration file.  Also,  if  Avahi  is  not  installed  or  not
       running, <b>ipp-usb</b> will still work correctly, although DNS-SD advertising will not work.

       For every device the following services will be advertised:
       ┌─────────────┬───────────────┬───────────────────────────┐
       │ Instance    │ Type          │ Subtypes                  │
       ├─────────────┼───────────────┼───────────────────────────┤
       │ Device name │ _ipp._tcp     │ _universal._sub._ipp._tcp │
       ├─────────────┼───────────────┼───────────────────────────┤
       │ Device name │ _printer._tcp │                           │
       ├─────────────┼───────────────┼───────────────────────────┤
       │ Device name │ _uscan._tcp   │                           │
       ├─────────────┼───────────────┼───────────────────────────┤
       │ Device name │ _http._tcp    │                           │
       ├─────────────┼───────────────┼───────────────────────────┤
       │ BBPP        │ _ipp-usb._tcp │                           │
       └─────────────┴───────────────┴───────────────────────────┘

       Notes:

       •   <b>Device</b>  <b>name</b> is the name under which device appears in the list of available devices, for example, in
           the printing dialog (it is DNS-SD device name, in another words), and for most of devices will  match
           the  device's  model  name.  It  is  appended with the <b>"</b> <b>(USB)"</b> suffix, so if device is connected via
           network and via USB simultaneously, these two connections can be easily distinguished. If  there  are
           two  devices  with  the same name connected simultaneously, the suffix becomes <b>"</b> <b>(USB</b> <b>NNN)"</b>, with NNN
           number unique for each device, for disambiguation. In  another  words,  the  single  <b>"Kyocera</b>  <b>ECOSYS</b>
           <b>M2040dn"</b>  device  will  be  listed  as <b>"Kyocera</b> <b>ECOSYS</b> <b>M2040dn</b> <b>(USB)"</b>, and two such a devices will be
           listed as <b>"Kyocera</b> <b>ECOSYS</b> <b>M2040dn</b> <b>(USB</b> <b>1)"</b> and <b>"Kyocera</b> <b>ECOSYS</b> <b>M2040dn</b> <b>(USB</b> <b>2)"</b>

       •   <b>_ipp._tcp</b> and <b>_printer._tcp</b> are only advertises for printer devices and MFPs

       •   <b>_uscan._tcp</b> is only advertised for scanner devices and MFPs

       •   for the  <b>_ipp._tcp</b>  service,  the  <b>_universal._sub._ipp._tcp</b>  subtype  is  also  advertised  for  iOS
           compatibility

       •   <b>_printer._tcp</b>  is  advertised  with  TCP port set to 0. Other services are advertised with the actual
           port number

       •   <b>_http._tcp</b> is device web-console. It is always advertises in assumption it is always exist

       •   <b>BBPP</b>, used for the <b>_ipp-usb._tcp</b> service, is the USB bus (BB) and  port  (PP)  numbers  in  hex.  The
           purpose  of  this advertising is to help CUPS and other possible "clients" to guess which devices are
           handled by the <b>ipp-usb</b> service, to avoid possible conflicts with the legacy USB drivers.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       <b>ipp-usb</b> searched for its configuration file in two places:

       1.  <b>/etc/ipp-usb/ipp-usb.conf</b>

       2.  <b>ipp-usb.conf</b> in the directory where executable file is located

       Configuration file syntax is very similar to .INI files syntax. It consist of named  sections,  and  each
       section  contains  a  set  of  named variables. Comments are started from # or ; characters and continues
       until end of line:

           # This is a comment
           [section 1]
           variable 1 = value 1  ; and another comment
           variable 2 = value 2

   <b>Network</b> <b>parameters</b>
       Network parameters are all in the <b>[network]</b> section:

           [network]
             # TCP ports for HTTP will be automatically allocated in the
             # following range
             http-min-port = 60000
             http-max-port = 65535

             # Enable or disable DNS-SD advertisement
             dns-sd = enable      # enable | disable

             # Network interface to use. Set to `all` if you want to expose you
             # printer to the local network. This way you can share your printer
             # with other computers in the network, as well as with iOS and
             # Android devices.
             interface = loopback # all | loopback

             # Enable or disable IPv6
             ipv6 = enable        # enable | disable

   <b>Authentication</b>
       By default, <b>ipp-usb</b> exposes locally connected USB printer to all users of the system.

       Though this is reasonable behavior in most cases, when computer and printer are both in personal use, for
       bigger installation this approach can be too simple and primitive.

       <b>ipp-usb</b> provides a mechanism, which allows to control local  clients  access  based  on  UID  the  client
       program runs under.

       Please  note,  this  mechanism  will not work for remote connections (disabled by default but supported).
       Authentication of remote users requires some different mechanism, which is under consideration but is not
       yet implemented.

       Note also, this mechanism may or may not work in containerized  installation  (i.e.,  snap,  flatpak  and
       similar).  The  container namespace may be isolated from the system and/or user's namespaces, so even for
       local clients the UID as seen by the <b>ipp-usb</b> may be different from the system-wide UID.

       Authentication parameters are all in the [auth uid] section:

           # Local user authentication by UID/GID
           [auth uid]
             # Syntax:
             #     operations = users
             #
             # Operations are comma-separated list of following operations:
             #     all    - all operations
             #     config - configuration web-console
             #     fax    - faxing
             #     print  - printing
             #     scan   - scanning
             #
             # Users have the following suntax:
             #     user   - user name
             #     @group - all users that belongs to the group
             #
             # Users and groups may be specified either by names or by
             # numbers. "*" means any
             #
             # Note, if user/group is not known in the context of request
             # (for example, in the case of non-local network connection),
             # "*" used for matching, which will only match wildcard
             # rules.
             #
             # User/group names are resolved at the moment of request
             # processing (and cached for a couple of seconds), so running
             # daemon will see changes to the <a href="file:/etc/passwd">/etc/passwd</a> and <a href="file:/etc/group">/etc/group</a>
             #
             # Examples:
             #     fax, print = lp, @lp   # Allow CUPS to do its work
             #     scan       = *         # Allow any user to scan
             #     config     = @wheel    # Only wheel group members can do that
             all = *

   <b>Logging</b> <b>configuration</b>
       Logging parameters are all in the <b>[logging]</b> section:

           [logging]
             # device-log  - what logs are generated per device
             # main-log    - what common logs are generated
             # console-log - what of generated logs goes to console
             #
             # parameter contains a comma-separated list of
             # the following keywords:
             #   error     - error messages
             #   info      - informative messages
             #   debug     - debug messages
             #   trace-ipp, trace-escl, trace-http - very detailed
             #               per-protocol traces
             #   trace-usb - hex dump of all USB traffic
             #   all       - all logs
             #   trace-all - alias to all
             #
             # Note, trace-* implies debug, debug implies info, info implies
             # error
             device-log    = all
             main-log      = debug
             console-log   = debug

             # Log rotation parameters:
             #   log-file-size    - max log file before rotation. Use suffix
             #                      M for megabytes or K for kilobytes
             #   log-backup-files - how many backup files to preserve during
             #                      rotation
             #
             max-file-size    = 256K
             max-backup-files = 5

             # Enable or disable ANSI colors on console
             console-color = enable # enable | disable

             # ipp-usb queries IPP printer attributes at the initialization time
             # for its own purposes and writes received attributes to the log.
             # By default, only necessary attributes are requested from device.
             #
             # If this parameter is set to true, all printer attributes will
             # be requested. Normally, it only affects the logging. However,
             # some enterprise-level HP printers returns such huge amount of
             # data and do it so slowly, so it can cause initialization timeout.
             # This is why this feature is not enabled by default
             get-all-printer-attrs = false # false | true

   <b>Quirks</b>
       Some devices, due to their firmware  bugs,  require  special  handling,  called  device-specific  <b>quirks</b>.
       <b>ipp-usb</b>    loads    quirks    from    the    <b>/usr/share/ipp-usb/quirks/*.conf</b>    files   and   from   the
       <b>/etc/ipp-usb/quirks/*.conf</b> files. The <b>/etc/ipp-usb/quirks</b> directory is for  system  quirks  overrides  or
       admin changes. These files have .INI-file syntax with the content that looks like this:

           [HP LaserJet MFP M28-M31]
             http-connection = keep-alive

           [HP OfficeJet Pro 8730]
             http-connection = close

           [HP Inc. HP Laser MFP 135a]
             blacklist = true

           # Default configuration
           [*]
             http-connection = ""

       For each discovered device, its model name is matched against sections of the quirks files. Section names
       may  contain  glob-style  wildcards:  <b>*</b>  that matches any sequence of characters and <b>?</b> , that matches any
       single character. To match one of these characters (<b>*</b> and <b>?</b>) literally, use backslash as escape.

       Note, the simplest way to guess the exact model name for the particular device is to  use  <b>ipp-usb</b>  <b>check</b>
       command, which prints a list of all connected devices.

       All  matching  sections  from all quirks files are taken in consideration, and applied in priority order.
       Priority is computed using the following algorithm:

       •   When matching model name against section name, amount of non-wildcard matched characters is  counted,
           and the longer match wins

       •   Otherwise,  section  loaded  first  wins.  Files  are  loaded  in  alphabetical  order, sections read
           sequentially

       If some parameter exist in multiple sections, used its value from the most priority section

       The following parameters are defined:

       •   <b>blacklist</b> <b>=</b> <b>true</b> <b>|</b> <b>false</b>
           If <b>true</b>, the matching device is ignored by the <b>ipp-usb</b>

       •   <b>buggy-ipp-responses</b> <b>=</b> <b>reject</b> <b>|</b> <b>allow</b> <b>|</b> <b>sanitize</b>
           Some devices send buggy (malformed) IPP responses that violate IPP specification. <b>ipp-usb</b> may  <b>reject</b>
           these  responses  (so  <b>ipp-usb</b>  initialization  will  fail),  <b>allow</b> them (<b>ipp-usb</b> initialization will
           succeed, but CUPS needs to accept them as well) or <b>sanitize</b> them (fix IPP specs violations).

       •   <b>disable-fax</b> <b>=</b> <b>true</b> <b>|</b> <b>false</b>
           If <b>true</b>, the matching device's fax capability is ignored

       •   <b>http-XXX</b> <b>=</b> <b>YYY</b>
           Set XXX header of the HTTP requests forwarded to device to YYY. If YYY is empty string, XXX header is
           removed

       •   <b>ignore-ipp-status</b> <b>=</b> <b>true</b> <b>|</b> <b>false</b>
           If <b>true</b>, IPP status of IPP requests sent by the <b>ipp-usb</b> by itself will  be  ignored.  This  quirk  is
           useful,  when  device correctly handles IPP request but returned status is not reliable. Affects only
           <b>ipp-usb</b> initialization.

       •   <b>init-delay</b> <b>=</b> <b>NNN</b>
           Delay, in milliseconds, between device is opened and, optionally, reset, and  the  first  request  is
           sent to device

       •   <b>init-reset</b> <b>=</b> <b>none</b> <b>|</b> <b>soft</b> <b>|</b> <b>hard</b>
           How to reset device during initialization. Default is <b>none</b>

       •   <b>request-delay</b> = NNN
           Delay, in milliseconds, between subsequent requests

       •   <b>usb-max-interfaces</b> <b>=</b> <b>N</b>
           Don't use more that N USB interfaces, even if more is available

       If  you  found  out  about  your  device  that it needs a quirk to work properly or it does not work with
       <b>ipp-usb</b>  at  all,  although  it  provides  IPP-over-USB   interface,   please   report   the   issue   at
       https://github.com/OpenPrinting/ipp-usb.  It  will  let us to update our collection of quirks, so helping
       other owners of such a device.

</pre><h4><b>FILES</b></h4><pre>
       •   <b>/etc/ipp-usb/ipp-usb.conf</b>: the daemon configuration file

       •   <b>/var/log/ipp-usb/main.log</b>: the main log file

       •   <b>/var/log/ipp-usb/&lt;DEVICE&gt;.log</b>: per-device log files

       •   <b>/var/ipp-usb/dev/&lt;DEVICE&gt;.state</b>: device state (HTTP port allocation, DNS-SD name)

       •   <b>/var/ipp-usb/lock/ipp-usb.lock</b>: lock file, that helps to prevent multiple copies  of  daemon  to  run
           simultaneously

       •   <b>/var/ipp-usb/ctrl</b>:  <b>ipp-usb</b>  control  socket.  Currently  only  used  to obtain the per-device status
           (printed by <b>ipp-usb</b> <b>status</b>), but its functionality may be extended in a future

       •   <b>/usr/share/ipp-usb/quirks/*.conf</b>: device-specific quirks (see above)

       •   <b>/etc/ipp-usb/quirks/*.conf</b>: device-specific quirks defined by sysadmin (see above)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) by Alexander Pevzner (<a href="mailto:pzz@apevzner.com">pzz@apevzner.com</a>, <a href="mailto:pzz@pzz.msk.ru">pzz@pzz.msk.ru</a>)
       All rights reserved.

       This program is licensed under 2-Clause BSD license. See LICENSE file for details.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/cups.1.html">cups</a>(1)</b>

                                                  February 2025                                       <u><a href="../man8/IPP-USB.8.html">IPP-USB</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>