<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NetworkManager-dispatcher - Dispatch user scripts for NetworkManager</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/network-manager">network-manager_1.52.0-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       NetworkManager-dispatcher - Dispatch user scripts for NetworkManager

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>NetworkManager</b> <b>[OPTIONS...]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       NetworkManager-dispatcher service is a D-Bus activated service that runs user provided scripts upon
       certain changes in NetworkManager.

       NetworkManager-dispatcher will execute scripts in the /{etc,usr/lib}/NetworkManager/dispatcher.d
       directory or subdirectories in alphabetical order in response to network events. Files in <a href="file:/etc">/etc</a> take
       precedence over identically-named files in /usr/lib. Each script should be a regular executable file
       owned by root. Furthermore, it must not be writable by group or other, and not setuid.

       Each script receives two arguments, the first being the interface name of the device an operation just
       happened on, and second the action. For device actions, the interface is the name of the kernel interface
       suitable for IP configuration. Thus it is either VPN_IP_IFACE, DEVICE_IP_IFACE, or DEVICE_IFACE, as
       applicable. For the <u>hostname</u> action the device name is always "none". For <u>connectivity-change</u> and
       <u>dns-change</u> it is empty.

       The actions are:

       <u>pre-up</u>
           The interface is connected to the network but is not yet fully activated. Scripts acting on this
           event must be placed or symlinked into the /etc/NetworkManager/dispatcher.d/pre-up.d directory, and
           NetworkManager will wait for script execution to complete before indicating to applications that the
           interface is fully activated.

       <u>up</u>
           The interface has been activated.

       <u>pre-down</u>
           The interface will be deactivated but has not yet been disconnected from the network. Scripts acting
           on this event must be placed or symlinked into the /etc/NetworkManager/dispatcher.d/pre-down.d
           directory, and NetworkManager will wait for script execution to complete before disconnecting the
           interface from its network. Note that this event is not emitted for forced disconnections, like when
           carrier is lost or a wireless signal fades. It is only emitted when there is an opportunity to
           cleanly handle a network disconnection event.

       <u>down</u>
           The interface has been deactivated.

       <u>vpn-pre-up</u>
           The VPN is connected to the network but is not yet fully activated. Scripts acting on this event must
           be placed or symlinked into the /etc/NetworkManager/dispatcher.d/pre-up.d directory, and
           NetworkManager will wait for script execution to complete before indicating to applications that the
           VPN is fully activated.

       <u>vpn-up</u>
           A VPN connection has been activated.

       <u>vpn-pre-down</u>
           The VPN will be deactivated but has not yet been disconnected from the network. Scripts acting on
           this event must be placed or symlinked into the /etc/NetworkManager/dispatcher.d/pre-down.d
           directory, and NetworkManager will wait for script execution to complete before disconnecting the VPN
           from its network. Note that this event is not emitted for forced disconnections, like when the VPN
           terminates unexpectedly or general connectivity is lost. It is only emitted when there is an
           opportunity to cleanly handle a VPN disconnection event.

       <u>vpn-down</u>
           A VPN connection has been deactivated.

       <u>hostname</u>
           The system hostname has been updated. Use <a href="../man2/gethostname.2.html">gethostname</a>(2) to retrieve it. The interface name (first
           argument) is empty and no environment variable is set for this action.

       <u>dhcp4-change</u>
           The DHCPv4 lease has changed (renewed, rebound, etc).

       <u>dhcp6-change</u>
           The DHCPv6 lease has changed (renewed, rebound, etc).

       <u>connectivity-change</u>
           The network connectivity state has changed (no connectivity, went online, etc).

       <u>reapply</u>
           The connection was reapplied on the device.

       <u>dns-change</u>
           The DNS configuration has changed. This action is raised even if NetworkManager is configured to not
           manage resolv.conf (for example, via dns=none). In such case, the dispatch script can discover the
           DNS configuration provided by currently active connections by looking at file
           /run/NetworkManager/resolv.conf

       <u>device-add</u>
           This action is called when a connection of type generic has the generic.device-handler property set.
           The property indicates the name of a dispatcher script to be executed in directory
           /{etc,usr/lib}/NetworkManager/dispatcher.d/device. Note that differently from other actions, only one
           script is executed.

           The script needs to perform any action needed to create the device for the generic connection. On
           successful termination, the script returns zero. Otherwise, it returns a non-zero value to indicate
           an error. The script can return values to NetworkManager by writing to standard output; each line
           should contain a key name followed by the equal sign '=' and a key value. The keys understood at the
           moment are:

           <u>IFINDEX</u>
               Indicates the interface index of the interface created by the script. This key is required when
               the script succeeds; if it is not set, the activation will fail. The key is ignored in case of
               script failure.

           <u>ERROR</u>
               Specifies an error message indicating the cause of the script failure. It is ignored when the
               script succeeds.

           Since the dispatcher service captures stdout for parsing those keys, anything written to stdout will
           not appear in the dispatcher service journal log. Use stderr if you want to print messages to the
           journal (for example, for debugging). Only the first 8KiB of stdout are considered and among those,
           only the first 64 lines; the rest is ignored.

       <u>device-delete</u>
           This action is the counterpart of device-add and is called to delete the device for a generic
           connection. All the aspects described for device-add also apply to this action, with the only
           exception that key <u>IFINDEX</u> is ignored. It is not necessary to delete the kernel link in the handler
           because NetworkManager already does that; therefore the action is useful for any additional cleanup
           needed.

       The environment contains more information about the interface and the connection. The following variables
       are available for the use in the dispatcher scripts:

       <u>NM_DISPATCHER_ACTION</u>
           The dispatcher action like "up" or "dhcp4-change", identical to the first command line argument.
           Since NetworkManager 1.12.0.

       <u>CONNECTION_UUID</u>
           The UUID of the connection profile.

       <u>CONNECTION_ID</u>
           The name (ID) of the connection profile.

       <u>CONNECTION_DBUS_PATH</u>
           The NetworkManager D-Bus path of the connection.

       <u>CONNECTION_FILENAME</u>
           The backing file name of the connection profile (if any).

       <u>CONNECTION_EXTERNAL</u>
           If "1", this indicates that the connection describes a network configuration created outside of
           NetworkManager.

       <u>DEVICE_IFACE</u>
           The interface name of the control interface of the device. Depending on the device type, this differs
           from <u>DEVICE_IP_IFACE</u>. For example for ADSL devices, this could be 'atm0' or for WWAN devices it might
           be 'ttyUSB0'.

       <u>DEVICE_IP_IFACE</u>
           The IP interface name of the device. This is the network interface on which IP addresses and routes
           will be configured.

       <u>IP4_ADDRESS_N</u>
           The IPv4 address in the format "address/prefix gateway", where N is a number from 0 to (# IPv4
           addresses - 1). gateway item in this variable is deprecated, use IP4_GATEWAY instead.

       <u>IP4_NUM_ADDRESSES</u>
           The variable contains the number of IPv4 addresses the script may expect.

       <u>IP4_GATEWAY</u>
           The gateway IPv4 address in traditional numbers-and-dots notation.

       <u>IP4_ROUTE_N</u>
           The IPv4 route in the format "address/prefix next-hop metric", where N is a number from 0 to (# IPv4
           routes - 1).

       <u>IP4_NUM_ROUTES</u>
           The variable contains the number of IPv4 routes the script may expect.

       <u>IP4_NAMESERVERS</u>
           The variable contains a space-separated list of the DNS servers.

       <u>IP4_DOMAINS</u>
           The variable contains a space-separated list of the search domains.

       <u>DHCP4_&lt;dhcp-option-name&gt;</u>
           If the connection used DHCP for address configuration, the received DHCP configuration is passed in
           the environment using standard DHCP option names, prefixed with "DHCP4_", like
           "DHCP4_HOST_NAME=foobar".

       <u>IP6_&lt;name&gt;</u> <u>and</u> <u>DHCP6_&lt;name&gt;</u>
           The same variables as for IPv4 are available for IPv6, but the prefixes are IP6_ and DHCP6_ instead.

       <u>CONNECTIVITY_STATE</u>
           The network connectivity state, which can take the values defined by the NMConnectivityState type,
           from the org.freedesktop.NetworkManager D-Bus API: UNKNOWN, NONE, PORTAL, LIMITED or FULL. Note: this
           variable will only be set for connectivity-change actions.

       In case of VPN, VPN_IP_IFACE is set, and IP4_*, IP6_* variables with VPN prefix are exported too, like
       VPN_IP4_ADDRESS_0, VPN_IP4_NUM_ADDRESSES.

       The content of the user setting for the connection being activated is also passed via environment
       variables. Each key is stored in a variable with name CONNECTION_USER_ concatenated with the encoding of
       the key name. The encoding works as follows:

       •   lowercase letters become uppercase

       •   uppercase letters are prefixed with an underscore

       •   numbers do not change

       •   a dot is replaced with a double underscore

       •   any other character is encoded with an underscore followed by its 3-digit octal representation

       For example, key test.foo-Bar2 is stored in a variable named CONNECTION_USER_TEST__FOO_055_BAR2.

       Dispatcher scripts are run one at a time, but asynchronously from the main NetworkManager process, and
       will be killed if they run for too long. If your script might take arbitrarily long to complete, you
       should spawn a child process and have the parent return immediately. Scripts that are symbolic links
       pointing inside the /etc/NetworkManager/dispatcher.d/no-wait.d/ directory are run immediately, without
       waiting for the termination of previous scripts, and in parallel. Also beware that once a script is
       queued, it will always be run, even if a later event renders it obsolete. (Eg, if an interface goes up,
       and then back down again quickly, it is possible that one or more "up" scripts will be run after the
       interface has gone down.)

</pre><h4><b>BUGS</b></h4><pre>
       Please report any bugs you find in NetworkManager at the <b>NetworkManager</b> <b>issue</b> <b>tracker</b>[1].

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>NetworkManager</b> <b>home</b> <b>page</b>[2], <b><a href="../man8/NetworkManager.8.html">NetworkManager</a></b>(8),

</pre><h4><b>NOTES</b></h4><pre>
        1. NetworkManager issue tracker
           https://gitlab.freedesktop.org/NetworkManager/NetworkManager/-/issues

        2. NetworkManager home page
           https://networkmanager.dev

NetworkManager-dispatcher 1                                                         <u><a href="../man8/NETWORKMANAGER-DISPATCHER.8.html">NETWORKMANAGER-DISPATCHER</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>