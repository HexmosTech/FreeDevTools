<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>md-mx-ctrl - Control mimedefang-multiplexor</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/mimedefang">mimedefang_3.6-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       md-mx-ctrl - Control mimedefang-multiplexor

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>md-mx-ctrl</b> [<u>options</u>] <u>command</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>md-mx-ctrl</b> is a command-line tool for communicating with <b><a href="../man8/mimedefang-multiplexor.8.html">mimedefang-multiplexor</a></b>(8).

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-h</b>     Displays usage information.

       <b>-s</b> <u>path</u>
              Specifies  the  path  to  the  <b>mimedefang-multiplexor</b>  socket.   If  not  specified,  defaults  to
              /var/spool/MIMEDefang/mimedefang-multiplexor.sock.

       <b>-i</b>     This flag causes <b>md-mx-ctrl</b> to sit in a loop, reading commands  on  standard  input  and  printing
              results  to  standard  output.   It  is  intended  for  use by a monitoring program such as <b>watch-</b>
              <b>mimedefang</b>.

</pre><h4><b>COMMANDS</b></h4><pre>
       The following commands are available:

       <b>status</b> Prints the status of all worker Perl processes in human-readable format.

       <b>rawstatus</b>
              Prints the status of all worker Perl processes in a format easy to parse by computer.  The  result
              is a single line with six words on it.  The words are separated by a single space character.

              Each character in the first word corresponds to a worker, and is "I" for an idle worker, "B" for a
              busy  worker,  "S"  for a worker which is not running, and "K" for a worker which has been killed,
              but has not yet exited.  A worker is "idle" if there is a running Perl process waiting to do work.
              "Busy" means the Perl process is currently filtering a message.  "S" means there is no  associated
              Perl process with the worker, but one can be started if the load warrants.  Finally, "K" means the
              worker Perl process has been killed, but has yet to terminate.

              The  second  word is the total number of messages processed since the multiplexor started up.  The
              third word is the total number of workers which have been activated since the multiplexor  started
              up.   (That is, it's a count of the number of times the multiplexor has forked and exec'd the Perl
              filter.)

              The fourth word is the size of the queue for request queuing, and the fifth  word  is  the  actual
              number  of  requests  in  the  queue.   The  sixth word is the number of seconds elapsed since the
              multiplexor was started.

       <b>barstatus</b>
              Prints the status of busy workers and queued requests in a nice "bar chart" format.  This lets you
              keep an eye on things with a script like this:

                   while true ; do
                        md-mx-ctrl barstatus
                        sleep 1
                   done

       <b>jsonstatus</b>
              Prints the status of all worker Perl processes in JSON format.

       <b>histo</b>  Prints a histogram showing the number of workers that were busy each time a request was processed.
              A single line is printed for the numbers from 1 up to the maximum number of  workers.   Each  line
              contains  the  count  of busy workers (1, 2, 3 up to MX_MAXIMUM), a space, and the number of times
              that many workers were busy when a request was processed.

       <b>load</b>   Prints a table showing "load averages" for the last  10  seconds,  1  minute,  5  minutes  and  10
              minutes.

              Each  row  in  the  table  corresponds  to  a  time  interval, displayed in the first column.  The
              remaining columns in the table are:

              <b>Msgs:</b> The number of messages scanned within the row's time interval.

              <b>Msgs/Sec:</b> The average number of messages scanned per second within the row's time interval.

              <b>Avg</b> <b>Busy</b> <b>Workers:</b> The average number of busy workers whenever a message was scanned.  (If you  are
              processing  any mail at all, this number will be at least 1, because there is always 1 busy worker
              when a message is scanned.)

              If you have the <b><a href="../man1/watch.1.html">watch</a></b>(1) command on your system, you can  keep  an  eye  on  the  load  with  this
              command:

                   watch -n 10 md-mx-ctrl load

              If you do not have <b>watch</b>, the following shell script is a less fancy equivalent:

                   #!<a href="file:/bin/sh">/bin/sh</a>
                   while true; do
                        clear
                        date
                        md-mx-ctrl load
                        sleep 10
                   done

       <b>rawload</b>

              Prints  the  load averages in computer-readable format.  The format consists of twenty-nine space-
              separated numbers:

              The first four are integers representing the number of messages scanned in the last 10 seconds,  1
              minute, 5 minutes and 10 minutes.

              The  second four are floating-point numbers representing the average number of busy workers in the
              last 10 seconds, 1 minute, 5 minutes and 10 minutes.

              The third four are floating-point numbers representing the average time per scan  in  milliseconds
              over the last 10 seconds, 1 minute, 5 minutes and 10 minutes.

              The  fourth  four  are  the  number  of  worker activations (new workers started) over the last 10
              seconds, 1 minute, 5 minutes and 10 minutes.

              The fifth four are the number of workers reaped (workers  that  have  exited)  over  the  last  10
              seconds, 1 minute, 5 minutes and 10 minutes.

              The sixth four are the number of busy, idle, stopped and killed workers.

              The  seventh four are the number of messages processed, the number of worker activations, the size
              of the request queue, and the number of requests actually on the queue.

              The final number is the number of seconds since the multiplexor was started.

       <b>load-relayok</b>
              Similar to <b>load</b>, but shows timings for <b>filter_relay</b> calls.

       <b>load-senderok</b>
              Similar to <b>load</b>, but shows timings for <b>filter_sender</b> calls.

       <b>load-recipok</b>
              Similar to <b>load</b>, but shows timings for <b>filter_recipient</b> calls.

       <b>rawload-relayok</b>
              Similar to <b>rawload</b>, but shows timings for <b>filter_relay</b> calls.  Note that the worker activation and
              reap statistics are present, but always 0.  They are only valid in a <b>rawload</b> command.

       <b>rawload-senderok</b>
              Similar to <b>rawload</b>, but shows timings for <b>filter_sender</b> calls.  Note that  the  worker  activation
              and reap statistics are present, but always 0.  They are only valid in a <b>rawload</b> command.

       <b>rawload-recipok</b>
              Similar to <b>rawload</b>, but shows timings for <b>filter_recipient</b> calls.  Note that the worker activation
              and reap statistics are present, but always 0.  They are only valid in a <b>rawload</b> command.

       <b>load1</b> <u>nsecs</u>
              The  <b>load1</b> command displays the load for various commands over the last <u>nsecs</u> seconds, where <u>nsecs</u>
              is an integer from 10 to 600.  The <b>load1</b> command combines the output of <b>load</b>, <b>load-relayok</b>,  <b>load-</b>
              <b>senderokf</b> and <b>load-recipok</b> into one display.

              You might use the command like this:

                   watch -n 10 md-mx-ctrl load1 60

       <b>rawload1</b> <u>nsecs</u>
              Returns  the  <b>load1</b>  data  in  human-readable  format.  The result is a line containing twenty-six
              space-separated numbers:

              The first three numbers are the number of scans performed in the last <u>nsecs</u> seconds,  the  average
              number of busy workers when a scan was initiated and the average number of milliseconds per scan.

              The second three are the same measurements for <b>filter_relay</b> calls.

              The third three are the same measurements for <b>filter_sender</b> calls.

              The fourth three are the same measurements for <b>filter_relay</b> calls.

              The thirteenth through sixteenth numbers are the number of busy, idle, stopped and killed workers,
              respectively.

              The seventeenth number is the number of scans since <b>mimedefang-multiplexor</b> was started.

              The  eighteenth  number  is  the  number  of  times  a new worker has been activated since program
              startup.

              The nineteenth number is the size of the request queue and the  twentieth  number  is  the  actual
              number of queued requests.

              The  twenty-first  number is the time since program startup and the twenty-second number is a copy
              of <u>nsecs</u> for convenience.

              The twenty-third through twenty-sixth numbers are the number  of  workers  currently  executing  a
              scan, relayok, senderok and recipok command respectively.

       <b>jsonload1</b> <u>nsecs</u>
              Returns the <b>load1</b> data in JSON format.

       <b>workers</b>
              Displays  a  list  of  workers  and  their  process IDs.  Each line of output consists of a worker
              number, a status (I, B, K, or S), and for idle or busy workers, the process-ID of the worker.  For
              busy workers, the line may contain additional information about what the  worker  is  doing.   The
              command <b>slaves</b> is a deprecated synonym for this command.

       <b>busyworkers</b>
              Similar  to  <b>workers</b>,  but  only outputs a line for each busy worker.  The command <b>busyslaves</b> is a
              deprecated synonym for this command.

       <b>workerinfo</b> <u>n</u>
              Displays information about worker number <u>n</u>.  The command <b>slaveinfo</b> is  a  deprecated  synonym  for
              this command.

       <b>reread</b> Forces  <b>mimedefang-multiplexor</b>  to  kill  all idle workers, and terminate and restart busy workers
              when they become idle.  This forces a reread of filter rules.

       <b>msgs</b>   Prints the total number of messages scanned since the multiplexor started.

</pre><h4><b>ADDITIONAL</b> <b>COMMANDS</b></h4><pre>
       You can supply any other command and arguments  to  <b>md-mx-ctrl</b>.   It  percent-encodes  each  command-line
       argument,  glues the encoded arguments together with a single space between each, and sends the result to
       the multiplexor as a command.  This allows you to send arbitrary commands to your Perl workers.  See  the
       section "EXTENDING MIMEDEFANG" in <b><a href="../man5/mimedefang-filter.5.html">mimedefang-filter</a></b>(5) for additional details.

</pre><h4><b>PERMISSIONS</b></h4><pre>
       <b>md-mx-ctrl</b> uses the multiplexor's socket; therefore, it probably needs to be run as <u>root</u> or the same user
       as <b>mimedefang-multiplexor</b>.

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>md-mx-ctrl</b>   was  written  by  Dianne  Skoll  &lt;<a href="mailto:dfs@roaringpenguin.com">dfs@roaringpenguin.com</a>&gt;.   The  <b>mimedefang</b>  home  page  is
       <u>https://www.mimedefang.org/</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/mimedefang.pl.8.html">mimedefang.pl</a>(8), <a href="../man5/mimedefang-filter.5.html">mimedefang-filter</a>(5), <a href="../man8/mimedefang.8.html">mimedefang</a>(8), <a href="../man7/mimedefang-protocol.7.html">mimedefang-protocol</a>(7), <a href="../man8/watch-mimedefang.8.html">watch-mimedefang</a>(8)

4th Berkeley Distribution                        8 February 2005                                   <u><a href="../man8/MD-MX-CTRL.8.html">MD-MX-CTRL</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>