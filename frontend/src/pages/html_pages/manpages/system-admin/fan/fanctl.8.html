<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fanctl - fan bridge administration</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ubuntu-fan">ubuntu-fan_0.12.17_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fanctl - fan bridge administration

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>fanctl</b> <b>up</b> <b>[&lt;options&gt;...]</b>
       <b>fanctl</b> <b>down</b> <b>[&lt;options&gt;...]</b>
       <b>fanctl</b> <b>up</b> <b>-a</b>
       <b>fanctl</b> <b>down</b> <b>-a</b>
       <b>fanctl</b> <b>down</b> <b>-e</b>
       <b>fanctl</b> <b>show</b>
       <b>fanctl</b> <b>help</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>fanctl</b> is used to set up, tear down, and inspect Fan bridge mappings and devices in the linux kernel.

       <b>NOTE:</b>  Future  versions  of the commands will make <b>fanatic</b> the primary interface for interacting with Fan
              networks.  For maximum portability <b>fanctl</b> should only be used if absolutely necessary.

       A network Fan is a mechanism for expanding the range of IP addresses available to a system.  It  is  most
       useful  for  containers  such  as  Docker and LXC/LXD, but it can be used in other contexts as well.  Fan
       works by creating a bridge that uses a mathematical  mapping  between  the  host's  (or  underlay's)  /16
       address and the Fan's (or overlay's) /8 address. By mapping addresses in this way, a 253-fold increase in
       address  space  can  be  achieved.   For  example, if the host machine uses a subnet of 172.16.0.0/16 and
       assigns a 250.0.0.0/8 Fan to an IP address of 172.16.3.4, the hosts's Fan overlay addresses  will  be  in
       the 250.3.4.0/24 subnet, where 250 is derived from the user defined overlay network prefix.

</pre><h4><b>COMMAND</b> <b>SYNTAX</b></h4><pre>
       <b>fanctl</b> <b>up</b> <b>-u</b> <b>&lt;underlay&gt;</b> <b>-o</b> <b>&lt;overlay&gt;</b> <b>[&lt;options&gt;]</b>
              Sets  up a new Fan bridge mapping <b>overlay</b> addresses to the corresponding <b>underlay</b> addresses on the
              local network.  Using the example, the new bridge is  named  <u>fan-250</u>  based  on  the  overlay  and
              underlay  addresses  specified  (see  ADDRESSING below).  The <b>options</b> are described in the OPTIONS
              section below.

       <b>fanctl</b> <b>down</b> <b>-u</b> <b>&lt;underlay&gt;</b> <b>-o</b> <b>&lt;overlay&gt;</b>
              Tears down a previously-configured Fan bridge and associated mapping.  This action  will  fail  if
              the bridge is still in use.

       <b>fanctl</b> <b>up</b> <b>-a</b>
              Sets up all Fans defined in <a href="file:/etc/network/fan">/etc/network/fan</a> if present.

       <b>fanctl</b> <b>down</b> <b>-a</b>
              Tears  down  all  automatically defined Fan bridges on the system.  These may be identified in the
              <u>fanctl</u> <u>show</u> output via the <u>auto</u> flag.

       <b>fanctl</b> <b>down</b> <b>-e</b>
              Tears down all defined Fan bridges on the system.

       <b>fanctl</b> <b>show</b>
              Lists all currently defined Fan bridges in the system; for instance:

              # fanctl show
              Bridge       Underlay        Overlay       Flags
              fan-250      172.16.3.4/16   250.0.0.0/8   dhcp host-reserve 1

       <b>fanctl</b> <b>config</b> <b>set</b> <b>-u</b> <b>&lt;underlay&gt;</b> <b>-o</b> <b>&lt;overlay&gt;</b> <b>[&lt;options&gt;...]</b>
              Sets  configuration  options  for  the  underlay/overlay  combination  specified  (or  clears  any
              individual configuration if no options are specified).
              To  add options, the current set of options has to be obtained via <b>fanctl</b> <b>config</b> <b>show</b> and added to
              the list of new options.

       <b>fanctl</b> <b>config</b> <b>show</b> <b>-u</b> <b>&lt;underlay&gt;</b> <b>-o</b> <b>&lt;overlay&gt;</b>
              Displays any additional configuration options for the underlay/overlay combination specified.

       <b>fanctl</b> <b>config</b> <b>list</b>
              Displays all underlay/overlay combinations which have additional configuration.

       <b>fanctl</b> <b>help</b> <b>[&lt;command&gt;]</b>
              Displays basic usage information for <b>fanctl</b>.  When used with a specific command limits  output  to
              that command.

</pre><h4><b>ADDRESSING</b></h4><pre>
       The  Fan mapping is defined by a combination of the <b>underlay</b> and <b>overlay</b> addresses.  Each is defined as a
       CIDR network address.  For example:

              # fanctl up -u 172.16.3.4/16 -o 250.0.0.0/8

       This example defines an overlay of <u>250.0.0.0/8</u> and an underlay of <u>172.16.3.4/16</u>.  When mapping an address
       in the 250.0.0.0/8 subnet, we take the 16 bits of destination address starting at bit 8 and  replace  the
       bottom  16  bits  of  the  underlay  address with it.  For example, attempting to talk to 250.3.4.15 will
       trigger the packet to be sent to 172.16.3.4 for delivery.

       It is not always possible to know the local underlay address at the time the configuration  is  generated
       (such  as  when  a  common  configuration  is  desired  on all systems).  In this case we can specify the
       underlay address using only the underlay prefix, or by reference to an interface.

       For example, to bring up a Fan bridge slice for each address in the 172.16.0.0/16 subnet,  the  following
       example  examines  each  interface  as it is currently configured and configures a matching slice at that
       time:

              # fanctl up -u 172.16.0.0/16 -o 250.0.0.0/8

       To bring up Fan slices corresponding to the addresses on a  specific  interface  we  can  substitute  the
       interface name:

              # fanctl up -u ens3/16 -o 250.0.0.0/8

       To  bring  up  Fan  slices corresponding to the addresses on the primary network interface (the interface
       with the default route), the keyword <u>default</u> can be substituted:

              # fanctl up -u default/16 -o 250.0.0.0/8

</pre><h4><b>LIMITATIONS</b></h4><pre>
       Currently Fan can only apply overlay addresses with a /8 network mask, and underlay addresses with a  /16
       network mask.  We expect to relax this limitation in a later update.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-u</b> <b>&lt;underlay&gt;|--underlay=&lt;underlay&gt;</b>
              Specify the underlay network address and mask.

       <b>-o</b> <b>&lt;overlay&gt;|--overlay=&lt;overlay&gt;</b>
              Specify the overlay network address and mask.

       <b>--type=&lt;type&gt;</b>
              Sets the encapsulation type for this Fan bridge.  May be ipip or vxlan (default) only.  You should
              not normally need to specify this.

       <b>--mode=&lt;mode&gt;</b>
              Sets  the  bridge  mode.   May  be compact (default) or sliced only.  In compact mode a single Fan
              bridge per overlay network is created.  In sliced mode a Fan bridge is created for each local  Fan
              slice.  sliced mode is considered legacy.  You should not normally need to specify this.

       <b>--dhcp</b> Turns  on automatic address allocation for the Fan bridge.  A dnsmasq instance is started attached
              to the bridge allocating the unreserved addresses to entities attached to the Fan bridge.

       <b>--host-reserve=&lt;count&gt;</b>
              By default the .1 address on the Fan bridge is allocated to the host, enabling it  to  communicate
              with  entities  on the Fan bridge. This option reserves additional addresses for host applications
              to use. A <u>host-reserve</u> <u>4</u> reserves .1 through .4 in the Fan bridge for host use.

       <b>--bridge=&lt;name&gt;</b>
              By default the bridge name  is  based  on  the  overlay  and  underlay  addresses  specified  (see
              ADDRESSING above). This option overrides the name to one you specify.

       <b>--enable</b>
              This  option  marks  the  Fan  bridge to be automatically configured when the underlying interface
              comes up.  This is primarily used in the local Fan persistent configuration  to  enable  centrally
              configured Fan mappings on a specific host.  (See PERSISTENT CONFIGURATION below).

</pre><h4><b>PERSISTENT</b> <b>CONFIGURATION</b></h4><pre>
       <b>NOTE:</b>  The  location  and  content of the configuration files should still be considered unstable as they
       could change in future. Use of <b>fanatic</b> is highly recommended as this  command  will  make  any  necessary
       changes to the right config files.

       Fan  mappings  are  configured  via  <u><a href="file:/etc/network/fan">/etc/network/fan</a></u>  by  pairs  of local (underlay) and overlay network
       addresses.  The first element of each pair specifies the underlay range which should be mapped  into  the
       overlay network specified by the second element. For example:

              # RFC1918 - we recommend you use these for easy interop with
              # other FAN users on small private networks. They provide
              # around 250 IP's per 192.168.0.0/16 address, or 16 per
              # 172.16.0.0/12 address.

              # local         overlay
              192.168.0.0/16  250.0.0.0/8
              172.16.0.0/12   251.0.0.0/8

       Comments are introduced via a hash (#), and blank lines are ignored.

       Note,  that the local (underlay) range does not need to match the subnet mask of the interface as long as
       all addresses of the larger  scope  are  routeable.  If  for  example  the  interface  is  configured  as
       192.168.122.2/24  but  can  reach  all 192.168.0.0/16 addresses that will be part of the Fan network, the
       local (underlay) address of 192.168.0.0/16 can be used regardless.

       It is expected that the <u><a href="file:/etc/network/fan">/etc/network/fan</a></u> configuration is globally managed ensuring that all  hosts  have
       consistent  overlay  to  underlay mappings.  Local deviation is managed via the <b>fanctl</b> <b>config</b> subcommand.
       This allow a local host to record additional flags against a specific overlay/underlay combination.   For
       example:

              # fanctl config set -u 172.16.0.0/16 -o 250.0.0.0/8 --enable

       will  set  the <b>--enable</b> option to the local host configuration, triggering this Fan to be configured when
       the host interface is configured.

</pre><h4><b>FAN</b> <b>BRIDGES</b></h4><pre>
       By default each Fan bridge represents a Fan overlay network which is expressed locally  on  the  machine.
       The Fan bridge will have the various slice addresses mapped to it.

       In  legacy  sliced  mode  each  Fan bridge represents a slice of a Fan overlay network which is expressed
       locally on the machine.  The Fan bridge will have the overlay addresses representing one local IP address
       mapped to it.  A machine may have more than one local address on the underlay  network,  enabling  it  to
       have  more  than  one  such  slice mapped.  It may also have more than one overlay range defined for each
       local IP address.

       Each Fan bridge is a separate broadcast domain,  with  routing  between  the  bridges  both  locally  and
       globally within the Fan.

       Each Fan bridge appears as a bridge on the system, named for the overlay subnet hosted by that particular
       Fan  bridge  and  the  underlay  address  prefix  for  which  it carries traffic.  For our <u>250.0.0.0/8</u> on
       <u>172.16.3.4</u> example, the bridge would be named <u>fan-250</u> and would carry all traffic for <u>250.3.4.0/24</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/fanatic.8.html">fanatic</a></u>(8), <b>/usr/share/doc/ubuntu-fan/README</b>

</pre><h4><b>AUTHOR(s)</b></h4><pre>
       Andy Whitcroft &lt;<a href="mailto:apw@canonical.com">apw@canonical.com</a>&gt;,
       Stefan Bader &lt;<a href="mailto:stefan.bader@canonical.com">stefan.bader@canonical.com</a>&gt;

                                                  July 24, 2017                                        <u><a href="../man8/FANCTL.8.html">FANCTL</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>