<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fai-cd - make a bootable CD-ROM or USB stick that performs an FAI</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/fai-server">fai-server_6.4.3ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fai-cd - make a bootable CD-ROM or USB stick that performs an FAI

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>fai-cd</b> [<u>OPTION</u>] -m MIRROR <u>ISOFILE</u>
       <b>fai-cd</b> [<u>OPTION</u>] -B <u>FILE</u>
       <b>fai-cd</b> [<u>OPTION</u>] -d <u>URL</u>
       <b>fai-cd</b> [<u>OPTION</u>] -S <u>IMAGEFILE</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  command creates a bootable ISO CD-ROM image that performs the fully automatic installation from the
       CD-ROM without an install server. The ISO image will be written to FILE. To create the image the  command
       requires  the  NFSROOT,  configuration  space,  and optionally a partial mirror (which is created by fai-
       mirror). The ISO image will contain a compressed squashfs filesystem. This hybrid CD image can be written
       to an USB stick using <a href="../man1/dd.1.html">dd</a>(1).

       NOTE: By default, fai-cd uses the grub file from /etc/fai/grub.cfg, which is designed for demo  purposes.
       This  grub  menu  passes  the  "menu"  flag  to the FAI_FLAGS parameter, which causes a menu with various
       installation and boot options to be displayed on each boot.  To avoid this, you  must  specify  your  own
       grub file using the -g flag, as described below.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-A</b>     Create a boot only CD image (also usable for an USB stick) with autodiscover functionality. The CD
              will scan the subnet for a FAI server. By default it shows a menu with all profiles available from
              which  you  can  select  a  type  of installation. This image only needs 25MB.  You can add the -J
              option to make the image smaller.

       <b>-B</b>     Create a boot only ISO image which does a network installation. It does not include  the  nfsroot,
              the partial mirror and the config space; however for it to automatically initiate the installation
              -d has to be set. By default CONFIG_SRC will be empty.

       <b>-b</b>     After creating the ISO image burn it by calling <a href="../man1/wodim.1.html">wodim</a>(1) (a version of cdrecord).

       <b>-c</b> <u>DIRECTORY</u>
              Override the value of FAI_CONFIGDIR set in nfsroot.conf.

       <b>-C</b> <u>DIRECTORY</u>
              Use DIRECTORY as the configuration directory instead of the default /etc/fai. You can also set the
              environment variable FAI_ETC_DIR.

       <b>-d</b> <u>URL</u> Do  not  include  the  config  space in the image. Instead set the variable to the location of the
              config space to URL. This sets FAI_CONFIG_SRC in the grub config, which is obtained from  the  FAI
              configuration  dir (see -C). Set it to "" to not set FAI_CONFIG_SRC at all. If not set, the config
              space is taken from FAI_CONFIGDIR and copied to /var/lib/fai/config in  the  image.  Currently  no
              file: is allowed here, instead set FAI_CONFIGDIR in <a href="../man5/nfsroot.conf.5.html">nfsroot.conf</a>(5).

       <b>-e</b>     Exclude  the  directory  <a href="file:/var/tmp">/var/tmp</a>  from  the  nfsroot.  You  may  put  the file base.tar.xz in the
              configuration space into the subdirectory basefiles. This option will  save  about  50MB  of  disk
              space. This option will exclude the directory even when -H is given.

       <b>-f</b>     Force removal of an existing ISO image before creating a new one.

       <b>-g</b> <u>FILE</u>
              Use  FILE  as  the  grub.cfg  file.  The script will look for FILE in CFDIR. If FILE is located in
              another directory then a full path must be specified. If not specified, use /etc/fai/grub.cfg.

       <b>-h</b>     Show simple help and version.

       <b>-H</b>     Do not hide directories. Using this option will consume about 45MB more disk space on your  media.
              By default, some directories like man pages and locales are hidden and will not be put onto the CD
              or the USB stick.

       <b>-J</b>     Use xz compression when calling mksquashfs. Default is zstd, which is much faster.

       <b>-M</b>     Do  not  add  the  package  mirror  to  the CD. Packages that would be fetched from the mirror are
              obtained from the normal sources configured elsewhere, usually remote repositories.

       <b>-m</b> <u>DIRECTORY</u>
              Use DIRECTORY as partial FAI mirror. This option is mandatory, unless you use -M or -B.

       <b>-n</b> <u>DIRECTORY</u>
              Override the value of NFSROOT set in nfsroot.conf.

       <b>-s</b> <u>blocks</u>
              Add additional disk space to the image. Increases the size by the number of 1M blocks specified.

       <b>-S</b>     Create a squashfs image file instead of a complete iso. The image contains the nfsroot and can  be
              fetched  through  various ways over the network. For an example, see the section "FAI without NFS"
              in the FAI Guide.

       <b>-V</b>     Set the volume id of the ISO.  Default  id  is  FAI_CD.  You  also  must  adjust  the  CDLABEL  in
              /etc/fai/grub.cfg, or use -g and specify your own grub.cfg.

</pre><h4><b>EXAMPLES</b></h4><pre>
       After you've created a mirror with fai-mirror in /media/mirror, you can create a CD using:

          # fai-cd -m /media/mirror fai-cd.iso

       If you want to create a bootable USB stick (here /dev/sdf), write the CD image to the stick via <a href="../man1/dd.1.html">dd</a>(1).

          # dd if=fai-cd.iso of=/dev/sdf bs=1M

       <b>Building</b> <b>a</b> <b>live</b> <b>ISO</b>:

       You  can  create  a  live ISO using two FAI commands. First, you need to build your own live environment,
       containing all software including configuration that you like to use. Using the command "fai  dirinstall"
       you  do  an  installation using the FAI config space into a directory which will become your live system.
       After that you create a bootable ISO which includes this directory tree.

       Define the FAI classes:

       cl="DEBIAN,BOOKWORM64,AMD64,FAIBASE,XFCE,XORG,DHCPC,DEMO,LIVEISO,LAST"

       Build the live environment directory tree:

         # LC_ALL=C fai -v dirinstall -u xfce33 -c $cl \
           -s file:///srv/fai/config /srv/xfce

       Then create the live ISO:

         # fai-cd -s500 -MH -d none -g /etc/fai/grub.cfg.live \
           -n /srv/xfce live.iso

       Hint: The FAI nfsroot is not needed when building a live ISO.

       <b>More</b> <b>advanced</b> <b>usage</b>:

       You can build a special installation ISO for an USB stick that contains the config space on  a  writeable
       partition  instead  inside  the  read-only  ISO.  The log files of the installations will be save to this
       partition.  After you have created the mirror in /tmp/mirror, build  the  ISO  using  the  following  two
       commands:

          # fai-cd -d detect:// -m /tmp/mirror fai.iso
          # mk-data-partition -c fai.iso /srv/fai/config

       After that copy this ISO onto the USB stick.

       It  is  possible  to  install over the network without using NFS, i.e. by getting the nfsroot via an http
       request. To do so you have to create a squashfs image using the following command:

          # fai-cd -S squashfs.img

       In addition to that you can create said image without a config space and without a mirror. This is useful
       for when you want to avoid creating a new image after  modifying  your  config  space  or  updating  your
       mirror:

          # fai-cd -d "" -SMeJ squashfs.img

       To fetch the image via http, use the following kernel command line option:

          root=live:<a href="http://your_server_or_IP/path/to/squashfs.img">http://your_server_or_IP/path/to/squashfs.img</a>

       Create the autodiscover boot image:

          # fai-cd -JAg /etc/fai/grub.cfg.autodiscover fai-autod.iso

       Create  a  minimalistic compressed network boot ISO image (~60MB) without nfsroot, the partial mirror and
       basefiles:

          # fai-cd -BMJe fai-cd.iso

       This ISO image can even be further reduced in size using the -s flag to <a href="../man8/fai-make-nfsroot.8.html">fai-make-nfsroot</a>(8).

       Specify your own grub file:

          # fai-cd -g /srv/fai/config/my_extras/grub.cfg -m /srv/fai/mirror /srv/fai/iso/fai-cd.iso

</pre><h4><b>NOTES</b></h4><pre>
       Additional kernel command line options can be found in the man page of  <a href="../man7/dracut.cmdline.7.html">dracut.cmdline</a>(7).  fai-cd  needs
       enough disk space in TMPDIR (<a href="file:/tmp">/tmp</a> by default) for creating the compressed filesystem. You may want to set
       it to another directories, before calling fai-cd.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/fai-mirror.1.html">fai-mirror</a>(1)</b>

       <b><a href="../man1/mksquashfs.1.html">mksquashfs</a>(1)</b>

       <b><a href="../man8/fai-make-nfsroot.8.html">fai-make-nfsroot</a>(8)</b>

</pre><h4><b>FILES</b></h4><pre>
       <u>/etc/fai/fai.conf</u>
              The FAI configuration file.
       <u>/etc/fai/grub.cfg</u>
              The default grub2 menu configuration file for fai-cd.
</pre><h4><b>AUTHOR</b></h4><pre>
       Thomas Lange &lt;<a href="mailto:lange@cs.uni-koeln.de">lange@cs.uni-koeln.de</a>&gt;

FAI 6                                               Mar 2025                                           <u><a href="../man8/fai-cd.8.html">fai-cd</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>