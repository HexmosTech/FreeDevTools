<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>zstream — manipulate ZFS send streams</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/zfsutils-linux">zfsutils-linux_2.3.2-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       zstream — manipulate ZFS send streams

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>zstream</b> <b>dump</b> [<b>-Cvd</b>] [<u>file</u>]
       <b>zstream</b> <b>decompress</b> [<b>-v</b>] [<u>object</u><b>,</b><u>offset</u>[<b>,</b><u>type</u>...]]
       <b>zstream</b> <b>redup</b> [<b>-v</b>] <u>file</u>
       <b>zstream</b> <b>token</b> <u>resume_token</u>
       <b>zstream</b> <b>recompress</b> [<b>-l</b> <u>level</u>] <u>algorithm</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>zstream</b> utility manipulates ZFS send streams output by the <b>zfs</b> <b>send</b> command.

       <b>zstream</b> <b>dump</b> [<b>-Cvd</b>] [<u>file</u>]
         Print  information  about  the  specified  send  stream, including headers and record counts.  The send
         stream may either be in the specified <u>file</u>, or provided on standard input.

         <b>-C</b>  Suppress the validation of checksums.

         <b>-v</b>  Verbose.  Print metadata for each record.

         <b>-d</b>  Dump data contained in each record.  Implies verbose.

         The <b>zstreamdump</b> alias is provided for compatibility and is equivalent to running <b>zstream</b> <b>dump</b>.

       <b>zstream</b> <b>token</b> <u>resume_token</u>
         Dumps zfs resume token information

       <b>zstream</b> <b>decompress</b> [<b>-v</b>] [<u>object</u><b>,</b><u>offset</u>[<b>,</b><u>type</u>...]]
         Decompress selected records in a ZFS send stream provided on standard input, when the compression  type
         recorded  in  ZFS  metadata may be incorrect.  Specify the object number and byte offset of each record
         that you wish to decompress.  Optionally specify the compression type.  Valid compression types include
         <b>off</b>, <b>gzip</b>, <b>lz4</b>, <b>lzjb</b>, <b>zstd</b>, and <b>zle</b>.  The default is <b>lz4</b>.  Every record for that  object  beginning  at
         that  offset  will  be  decompressed,  if  possible.  It may not be possible, because the record may be
         corrupted in some but not all of the stream's snapshots.  Specifying a compression  type  of  <b>off</b>  will
         change  the stream's metadata accordingly, without attempting decompression.  This can be useful if the
         record is already uncompressed but the metadata insists otherwise.  The repaired stream will be written
         to standard output.

         <b>-v</b>  Verbose.  Print summary of decompressed records.

       <b>zstream</b> <b>redup</b> [<b>-v</b>] <u>file</u>
         Deduplicated send streams can be generated by using the <b>zfs</b> <b>send</b>  <b>-D</b>  command.   The  ability  to  send
         deduplicated  send  streams  is  deprecated.  In the future, the ability to receive a deduplicated send
         stream with <b>zfs</b> <b>receive</b> will be removed.  However, deduplicated send streams can still be  received  by
         utilizing <b>zstream</b> <b>redup</b>.

         The  <b>zstream</b>  <b>redup</b>  command  is  provided a <u>file</u> containing a deduplicated send stream, and outputs an
         equivalent non-deduplicated send stream on standard output.  Therefore, a deduplicated send stream  can
         be received by running:
               <b>#</b> <b>zstream</b> <b>redup</b> <u>DEDUP_STREAM_FILE</u> | <b>zfs</b> <b>receive</b> …

         <b>-v</b>  Verbose.  Print summary of converted records.

       <b>zstream</b> <b>recompress</b> [<b>-l</b> <u>level</u>] <u>algorithm</u>
         Recompresses  a  send  stream,  provided  on  standard input, using the provided algorithm and optional
         level, and writes the modified stream to standard output.  All WRITE records in the send stream will be
         recompressed, unless they fail to result in size reduction compared to being  left  uncompressed.   The
         provided  algorithm  can be any valid value to the <b>compress</b> property.  Note that encrypted send streams
         cannot be recompressed.

         <b>-l</b> <u>level</u>
             Specifies compression level.  Only needed for algorithms where the level is not implied as part  of
             the name of the algorithm (e.g. gzip-3 does not require it, while zstd does, if a non-default level
             is desired).

</pre><h4><b>EXAMPLES</b></h4><pre>
       Heal a dataset that was corrupted due to OpenZFS bug #12762.  First, determine which records are corrupt.
       That  cannot  be  done  automatically;  it  requires information beyond ZFS's metadata.  If object <b>128</b> is
       corrupted at offset <b>0</b> and is compressed using <b>lz4</b>, then run this command:

       # <b>zfs</b> <u>send</u> <b>-c</b> <u>…</u> | <b>zstream</b> <b>decompress</b> <u>128,0,lz4</u> | <b>zfs</b> <b>recv</b> <u>…</u>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/zfs.8.html">zfs</a></u>(8), <u><a href="../man8/zfs-receive.8.html">zfs-receive</a></u>(8), <u><a href="../man8/zfs-send.8.html">zfs-send</a></u>(8), https://github.com/openzfs/zfs/issues/12762

OpenZFS                                          October 4, 2022                                      <u><a href="../man8/ZSTREAM.8.html">ZSTREAM</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>