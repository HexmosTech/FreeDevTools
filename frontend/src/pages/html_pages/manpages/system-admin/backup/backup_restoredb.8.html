<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>backup_restoredb - Restores a saved copy of the Backup Database</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openafs-client">openafs-client_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       backup_restoredb - Restores a saved copy of the Backup Database

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>backup</b> <b>restoredb</b> [<b>-portoffset</b> &lt;<u>TC</u> <u>port</u> <u>offset</u>&gt;]
           [<b>-localauth</b>] [<b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;] [<b>-help</b>]

       <b>backup</b> <b>res</b> [<b>-p</b> &lt;<u>TC</u> <u>port</u> <u>offset</u>&gt;]
           [<b>-l</b>] [<b>-c</b> &lt;<u>cell</u> <u>name</u>&gt;] [<b>-h</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>backup</b> <b>restoredb</b> command restores to the Backup Server machine's local disk a version of the Backup
       Database previously written to tape by using the <b>backup</b> <b>savedb</b> command.

       (If the "FILE YES" instruction appears in the <u>/var/lib/openafs/backup/CFG_device_name</u> file associated
       with the specified port offset, then the <b>backup</b> <b>restoredb</b> command restores data from the backup data file
       listed for that port offset in the Tape Coordinator's <u>/var/lib/openafs/backup/tapeconfig</u> file, instead of
       from tape. For the sake of clarity, the following text refers to tapes only, but the Backup System
       handles backup data files in much the same way.)

       The most common reason to run this command is to replace a corrupted or otherwise damaged Backup
       Database; use the <b>backup</b> <b>dbverify</b> command to determine the database's status. The command can also be
       used to restore records that were removed from the database when the <b>-archive</b> argument was included on a
       previous <b>backup</b> <b>savedb</b> command.

       The command completely overwrites the existing Backup Database records for volume sets, Tape
       Coordinators, and the dump hierarchy with the corresponding information from the saved version. It does
       not overwrite existing dump records, but instead interleaves the records from the copy being restored. If
       both the existing database (on the Backup Server machine's disk) and the copy being restored include a
       record about the same dump, the Backup System retains the one in the existing database.

       The Tape Coordinator's default response to this command is to access the first tape it needs by invoking
       the "MOUNT" instruction in the local <u>/var/lib/openafs/backup/CFG_device_name</u> file, or by prompting the
       backup operator to insert the tape if there is no "MOUNT" instruction. However, if the "AUTOQUERY NO"
       instruction appears in the <u>CFG_device_name</u> file, or if the issuer of the <b>butc</b> command included the
       <b>-noautoquery</b> flag, the Tape Coordinator instead expects the tape to be in the device already. If it is
       not, or is the wrong tape, the Tape Coordinator invokes the "MOUNT" instruction or prompts the operator.
       It also invokes the "MOUNT" instruction or prompts for any additional tapes needed to complete the
       restore operation; the backup operator must arrange to provide them.

</pre><h4><b>CAUTIONS</b></h4><pre>
       If the database is corrupted, do not attempt to restore a saved database on top of it. Instead, use the
       instructions for repairing a corrupted database in the <u>OpenAFS</u> <u>Administration</u> <u>Guide</u> chapter about
       performing backup operations.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-portoffset</b> &lt;<u>TC</u> <u>port</u> <u>offset</u>&gt;
           Specifies the port offset number of the Tape Coordinator handling the tapes for this operation.

       <b>-localauth</b>
           Constructs  a  server  ticket using a key from the local <u>/etc/openafs/server/KeyFile</u> file. The <b>backup</b>
           command interpreter presents it to the Backup Server, Volume  Server  and  VL  Server  during  mutual
           authentication. Do not combine this flag with the <b>-cell</b> argument. For more details, see <b><a href="../man8/backup.8.html">backup</a></b>(8).

       <b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;
           Names  the  cell  in which to run the command. Do not combine this argument with the <b>-localauth</b> flag.
           For more details, see <b><a href="../man8/backup.8.html">backup</a></b>(8).

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following example shows the Backup Database being restored from the Tape Coordinator with port offset
       0:

          % backup restoredb

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       The issuer must be listed in the <u>/etc/openafs/server/UserList</u> file on  every  machine  where  the  Backup
       Server  is  running,  or  must  be  logged  onto  a  server  machine as the local superuser "root" if the
       <b>-localauth</b> flag is included.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/butc.5.html">butc</a></b>(5), <b><a href="../man8/backup.8.html">backup</a></b>(8), <b><a href="../man8/backup_dbverify.8.html">backup_dbverify</a></b>(8), <b><a href="../man8/backup_savedb.8.html">backup_savedb</a></b>(8), <b><a href="../man8/butc.8.html">butc</a></b>(8)

       The <u>OpenAFS</u> <u>Administration</u> <u>Guide</u> at &lt;<a href="http://docs.openafs.org/AdminGuide/">http://docs.openafs.org/AdminGuide/</a>&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       IBM Corporation 2000. &lt;<a href="http://www.ibm.com/">http://www.ibm.com/</a>&gt; All Rights Reserved.

       This documentation is covered by the IBM Public License Version 1.0.  It was converted from HTML  to  POD
       by  software  written  by  Chas  Williams  and Russ Allbery, based on work by Alf Wachsmann and Elizabeth
       Cassell.

OpenAFS                                            2025-03-21                                <u><a href="../man8/BACKUP_RESTOREDB.8.html">BACKUP_RESTOREDB</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>