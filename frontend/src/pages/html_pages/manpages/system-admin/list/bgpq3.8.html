<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bgpq3 — bgp filtering automation tool</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bgpq3">bgpq3_0.1.36.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       bgpq3 — bgp filtering automation tool

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>bgpq3</b>  [<b>-h</b>  <u>host[:port]</u>]  [<b>-S</b>  <u>sources</u>] [<b>-EPz</b>] [<b>-f</b> <u>asn</u> | <b>-F</b> <u>fmt</u> | <b>-G</b> <u>asn</u> <b>-t</b>] [<b>-2346ABbDdJjNnsXU</b>] [<b>-a</b> <u>asn</u>]
             [<b>-r</b> <u>len</u>] [<b>-R</b> <u>len</u>] [<b>-m</b> <u>max</u>] [<b>-W</b> <u>len</u>] <u>OBJECTS</u> [...] [EXCEPT OBJECTS]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>bgpq3</b> utility used to generate configurations (prefix-lists, extended access-lists,  policy-statement
       terms and as-path lists) based on RADB data.

       The options are as follows:

       <b>-2</b>      accept routes registered for as23456 (transition-as) (default: false)

       <b>-3</b>      assume that your device is asn32-safe.

       <b>-4</b>      generate IPv4 prefix/access-lists (default).

       <b>-6</b>      generate IPv6 prefix/access-lists (IPv4 by default).

       <b>-A</b>      try to aggregate prefix-lists as much as possible (not all output formats supported).

       <b>-a</b> <u>asn</u>  specify what asn shall be denied in case of empty prefix-list (OpenBGPD)

       <b>-B</b>      generate output in OpenBGPD format (default: Cisco)

       <b>-b</b>      generate output in BIRD format (default: Cisco).

       <b>-d</b>      enable some debugging output.

       <b>-D</b>      use asdot notation for Cisco as-path access-lists.

       <b>-E</b>      generate  extended  access-list  (Cisco),  policy-statement  term  using route-filters (Juniper),
               [ip|ipv6]-prefix-list (Nokia) or prefix-sets (OpenBGPd).

       <b>-f</b> <u>number</u>
               generate input as-path access-list (use 0 to not enforce first AS)

       <b>-F</b> <u>fmt</u>  generate output in user-defined format.

       <b>-G</b> <u>number</u>
               generate output as-path access-list.

       <b>-h</b> <u>host[:port]</u>
               host running IRRD database (default: whois.radb.net).

       <b>-J</b>      generate config for Juniper (default: Cisco).

       <b>-j</b>      generate output in JSON format (default: Cisco).

       <b>-l</b> <u>name</u>
               name of generated entry.

       <b>-L</b> <u>limit</u>
               limit recursion depth when expanding as-sets.

       <b>-m</b> <u>len</u>  maximum prefix-length of accepted prefixes (default: 32 for IPv4 and 128 for IPv6).

       <b>-M</b> <u>match</u>
               extra match conditions for Juniper route-filters.

       <b>-n</b>      generate config for Nokia SR OS MD-CLI (Cisco IOS by default)

       <b>-N</b>      generate config for Nokia SR OS classic CLI (Cisco IOS by default).

       <b>-p</b>      accept routes registered for private ASNs (default: disabled)

       <b>-P</b>      generate prefix-list (default, backward compatibility).

       <b>-r</b> <u>len</u>  allow more specific routes starting with specified masklen too.

       <b>-R</b> <u>len</u>  allow more specific routes up to specified masklen too.

       <b>-s</b>      generate sequence numbers in IOS-style prefix-lists.

       <b>-S</b> <u>sources</u>
               use specified sources only (recommended: RADB,RIPE,APNIC).

       <b>-t</b>      generate as-sets for OpenBGPD (OpenBSD 6.4+), BIRD and JSON formats.

       <b>-T</b>      disable pipelining.

       <b>-W</b> <u>len</u>  generate as-path strings of no more than len items (use 0 for inifinity).

       <b>-U</b>      generate config for Huawei devices (Cisco IOS by default)

       <b>-X</b>      generate config for Cisco IOS XR devices (plain IOS by default).

       <b>-z</b>      generate route-filter-lists (JunOS 16.2+).

       <u>OBJECTS</u>
               means networks (in prefix format), autonomous systems, as-sets and route-sets.

       <u>EXCEPT</u> <u>OBJECTS</u>
               those objects will be excluded from expansion.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Generating named juniper prefix-filter for AS20597:
       ~&gt;bgpq3 -Jl eltel AS20597
       policy-options {
       replace:
        prefix-list eltel {
           81.9.0.0/20;
           81.9.32.0/20;
           81.9.96.0/20;
           81.222.128.0/20;
           81.222.192.0/18;
           85.249.8.0/21;
           85.249.224.0/19;
           89.112.0.0/19;
           89.112.4.0/22;
           89.112.32.0/19;
           89.112.64.0/19;
           217.170.64.0/20;
           217.170.80.0/20;
        }
       }

       For Cisco we can use aggregation (-A) flag to make this prefix-filter more compact:
       ~&gt;bgpq3 -Al eltel AS20597
       no ip prefix-list eltel
       ip prefix-list eltel permit 81.9.0.0/20
       ip prefix-list eltel permit 81.9.32.0/20
       ip prefix-list eltel permit 81.9.96.0/20
       ip prefix-list eltel permit 81.222.128.0/20
       ip prefix-list eltel permit 81.222.192.0/18
       ip prefix-list eltel permit 85.249.8.0/21
       ip prefix-list eltel permit 85.249.224.0/19
       ip prefix-list eltel permit 89.112.0.0/18 ge 19 le 19
       ip prefix-list eltel permit 89.112.4.0/22
       ip prefix-list eltel permit 89.112.64.0/19
       ip prefix-list eltel permit 217.170.64.0/19 ge 20 le 20
       - you see, prefixes 89.112.0.0/19 and 89.112.32.0/19 now aggregated into single entry 89.112.0.0/18 ge 19
       le 19.

       Well, for  Juniper  we  can  generate  even  more  interesting  policy-options,  using  -M  &lt;extra  match
       conditions&gt;, -R &lt;len&gt; and hierarchical names:
       ~&gt;bgpq3 -AJEl eltel/specifics -r 29 -R 32 -M "community blackhole" AS20597
       policy-options {
        policy-statement eltel {
         term specifics {
       replace:
          from {
           community blackhole;
           route-filter 81.9.0.0/20 prefix-length-range /29-/32;
           route-filter 81.9.32.0/20 prefix-length-range /29-/32;
           route-filter 81.9.96.0/20 prefix-length-range /29-/32;
           route-filter 81.222.128.0/20 prefix-length-range /29-/32;
           route-filter 81.222.192.0/18 prefix-length-range /29-/32;
           route-filter 85.249.8.0/21 prefix-length-range /29-/32;
           route-filter 85.249.224.0/19 prefix-length-range /29-/32;
           route-filter 89.112.0.0/17 prefix-length-range /29-/32;
           route-filter 217.170.64.0/19 prefix-length-range /29-/32;
          }
         }
        }
       }
       generated  policy-option  term  now allows all specifics with prefix-length between /29 and /32 for eltel
       networks if they match with special community blackhole (defined elsewhere in configuration).

       Of course, this version supports IPv6 (-6):
       ~&gt;bgpq3 -6l as-retn-6 AS-RETN6
       no ipv6 prefix-list as-retn-6
       ipv6 prefix-list as-retn-6 permit 2001:7fb:fe00::/48
       ipv6 prefix-list as-retn-6 permit 2001:7fb:fe01::/48
       [....]
       and support for ASN 32 is also here
       ~&gt;bgpq3 -J3f 112 AS-SPACENET
       policy-options {
       replace:
        as-path-group NN {
         as-path a0 "^<a href="../man112/112.112.html">112</a>(112)*$";
         as-path a1 "^112(.)*(1898|5539|8495|8763|8878|12136|12931|15909)$";
         as-path a2 "^112(.)*(21358|23456|23600|24151|25152|31529|34127|34906)$";
         as-path a3 "^112(.)*(35052|41720|43628|44450|196611)$";
        }
       }
       see AS196611 in the end of the list ? That's AS3.3 in 'asplain' notation.

       For non-ASN32 capable routers you should not use switch -3, and the result will be next:
       ~&gt;bgpq3 -f 112 AS-SPACENET
       no ip as-path access-list NN
       ip as-path access-list NN permit ^112(_112)*$
       ip as-path access-list NN permit ^112(_[0-9]+)*_(1898|5539|8495|8763)$
       ip as-path access-list NN permit ^112(_[0-9]+)*_(8878|12136|12931|15909)$
       ip as-path access-list NN permit ^112(_[0-9]+)*_(21358|23456|23600|24151)$
       ip as-path access-list NN permit ^112(_[0-9]+)*_(25152|31529|34127|34906)$
       ip as-path access-list NN permit ^112(_[0-9]+)*_(35052|41720|43628|44450)$

       AS196611 is no more in the list, however, AS23456 (transition AS) would be added to list if it  were  not
       present.

</pre><h4><b>USER-DEFINED</b> <b>FORMAT</b></h4><pre>
       If  you  want to generate configuration not for routers, but for some other programs/systems, you may use
       user-defined formatting, like in example below:
       user@host:~&gt;bgpq3 -F "ipfw add pass all from %n/%l to any\n" as3254
       ipfw add pass all from 62.244.0.0/18 to any
       ipfw add pass all from 91.219.29.0/24 to any
       ipfw add pass all from 91.219.30.0/24 to any
       ipfw add pass all from 193.193.192.0/19 to any

       Recognized format characters: %n - network, %l - mask length, %N - object name, %m - object mask and %i -
       inversed mask.  Recognized escape characters: \n - new line, \t - tabulation.  Please note  that  no  new
       lines  inserted  automatically  after  each  sentence,  you have to add them into format string manually,
       elsewhere output will be in one line (sometimes it makes sense):
       user@host:~&gt;bgpq3 -6F "%n/%l; " as-eltel
       2001:1b00::/32; 2620:4f:8000::/48; 2a04:bac0::/29; 2a05:3a80::/48;

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       When everything is OK, <b>bgpq3</b> generates access-list to standard output and exits with  status  ==  0.   In
       case of errors they are printed to stderr and program exits with non-zero status.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="http://www.radb.net/">http://www.radb.net/</a></b> Routing Arbiter project

       <b><a href="http://tools.ietf.org/html/draft-michaelson-4byte-as-representation-05">http://tools.ietf.org/html/draft-michaelson-4byte-as-representation-05</a></b>  for  information  on  'asdot' and
       'asplain' notations.

       <b><a href="http://www.cisco.com/en/US/docs/ios/12_0s/release/ntes/120SNEWF.html">http://www.cisco.com/en/US/docs/ios/12_0s/release/ntes/120SNEWF.html</a>#wp3521658</b> for information  on  Cisco
       implementation of ASN32.

</pre><h4><b>AUTHOR</b></h4><pre>
       Alexandre Snarskii &lt;<a href="mailto:snar@snar.spb.ru">snar@snar.spb.ru</a>&gt;

Debian                                            Oct 27, 2008                                          <u><a href="../man8/BGPQ3.8.html">BGPQ3</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>