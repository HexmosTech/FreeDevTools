<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_namespace - PAM module for configuring namespace for a session</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-runtime">libpam-runtime_1.7.0-5ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_namespace - PAM module for configuring namespace for a session

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>pam_namespace.so</b> [debug] [unmnt_remnt] [unmnt_only] [require_selinux] [gen_hash] [ignore_config_error]
                        [ignore_instance_parent_mode] [unmount_on_close] [use_current_context]
                        [use_default_context] [mount_private]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The pam_namespace PAM module sets up a private namespace for a session with polyinstantiated directories.
       A polyinstantiated directory provides a different instance of itself based on user name, or when using
       SELinux, user name, security context or both. If an executable script <a href="file:/etc/security/namespace.init">/etc/security/namespace.init</a>
       exists, it is used to initialize the instance directory after it is set up and mounted on the
       polyinstantiated directory. The script receives the polyinstantiated directory path, the instance
       directory path, flag whether the instance directory was newly created (0 for no, 1 for yes), and the user
       name as its arguments. The script is invoked with full root privileges and accessing the instance
       directory in this context needs to be done with caution, as it is controlled by the unprivileged user for
       which it has been created.

       The pam_namespace module disassociates the session namespace from the parent namespace. Any
       mounts/unmounts performed in the parent namespace, such as mounting of devices, are not reflected in the
       session namespace. To propagate selected mount/unmount events from the parent namespace into the
       disassociated session namespace, an administrator may use the special shared-subtree feature. For
       additional information on shared-subtree feature, please refer to the <a href="../man8/mount.8.html">mount</a>(8) man page and the
       shared-subtree description at <a href="http://lwn.net/Articles/159077">http://lwn.net/Articles/159077</a> and <a href="http://lwn.net/Articles/159092">http://lwn.net/Articles/159092</a>.

</pre><h4><b>OPTIONS</b></h4><pre>
       debug
           A lot of debug information is logged using syslog

       unmnt_remnt
           For programs such as su and newrole, the login session has already setup a polyinstantiated
           namespace. For these programs, polyinstantiation is performed based on new user id or security
           context, however the command first needs to undo the polyinstantiation performed by login. This
           argument instructs the command to first undo previous polyinstantiation before proceeding with new
           polyinstantiation based on new id/context

       unmnt_only
           For trusted programs that want to undo any existing bind mounts and process instance directories on
           their own, this argument allows them to unmount currently mounted instance directories

       require_selinux
           If selinux is not enabled, return failure

       gen_hash
           Instead of using the security context string for the instance name, generate and use its md5 hash.

       ignore_config_error
           If a line in the configuration file corresponding to a polyinstantiated directory contains format
           error, skip that line process the next line. Without this option, pam will return an error to the
           calling program resulting in termination of the session.

       ignore_instance_parent_mode
           Instance parent directories by default are expected to have the restrictive mode of 000. Using this
           option, an administrator can choose to ignore the mode of the instance parent. This option should be
           used with caution as it will reduce security and isolation goals of the polyinstantiation mechanism.

       unmount_on_close
           Explicitly unmount the polyinstantiated directories instead of relying on automatic namespace
           destruction after the last process in a namespace exits. This option should be used only in case it
           is ensured by other means that there cannot be any processes running in the private namespace left
           after the session close. It is also useful only in case there are multiple pam session calls in
           sequence from the same process.

       use_current_context
           Useful for services which do not change the SELinux context with setexeccon call. The module will use
           the current SELinux context of the calling process for the level and context polyinstantiation.

       use_default_context
           Useful for services which do not use pam_selinux for changing the SELinux context with setexeccon
           call. The module will use the default SELinux context of the user for the level and context
           polyinstantiation.

       mount_private
           This option can be used on systems where the / mount point or its submounts are made shared (for
           example with a <b>mount</b> <b>--make-rshared</b> <b>/</b> command). The module will mark the whole directory tree so any
           mount and unmount operations in the polyinstantiation namespace are private. Normally the
           pam_namespace will try to detect the shared / mount point and make the polyinstantiated directories
           private automatically. This option has to be used just when only a subtree is shared and / is not.

           Note that mounts and unmounts done in the private namespace will not affect the parent namespace if
           this option is used or when the shared / mount point is autodetected.

</pre><h4><b>MODULE</b> <b>TYPES</b> <b>PROVIDED</b></h4><pre>
       Only the <b>session</b> module type is provided. The module must not be called from multithreaded processes.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       PAM_SUCCESS
           Namespace setup was successful.

       PAM_SERVICE_ERR
           Unexpected system error occurred while setting up namespace.

       PAM_SESSION_ERR
           Unexpected namespace configuration error occurred.

</pre><h4><b>FILES</b></h4><pre>
       <a href="file:/etc/security/namespace.conf">/etc/security/namespace.conf</a>
           Main configuration file

       <a href="file:/etc/security/namespace.d">/etc/security/namespace.d</a>
           Directory for additional configuration files

       <a href="file:/etc/security/namespace.init">/etc/security/namespace.init</a>
           Init script for instance directories

</pre><h4><b>EXAMPLES</b></h4><pre>
       For the &lt;service&gt;s you need polyinstantiation (login for example) put the following line in
       <a href="file:/etc/pam.d/">/etc/pam.d/</a>&lt;service&gt; as the last line for session group:

       session required pam_namespace.so [arguments]

       To use polyinstantiation with graphical display manager gdm, please refer to gdm's documentation.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/namespace.conf.5.html">namespace.conf</a></b>(5), <b><a href="../man5/pam.d.5.html">pam.d</a></b>(5), <b><a href="../man8/mount.8.html">mount</a></b>(8), <b><a href="../man7/pam.7.html">pam</a></b>(7).

</pre><h4><b>AUTHORS</b></h4><pre>
       The namespace setup scheme was designed by Stephen Smalley, Janak Desai and Chad Sellers. The
       pam_namespace PAM module was developed by Janak Desai &lt;<a href="mailto:janak@us.ibm.com">janak@us.ibm.com</a>&gt;, Chad Sellers
       &lt;<a href="mailto:csellers@tresys.com">csellers@tresys.com</a>&gt; and Steve Grubb &lt;<a href="mailto:sgrubb@redhat.com">sgrubb@redhat.com</a>&gt;. Additional improvements by Xavier Toth
       &lt;<a href="mailto:txtoth@gmail.com">txtoth@gmail.com</a>&gt; and Tomas Mraz &lt;<a href="mailto:tmraz@redhat.com">tmraz@redhat.com</a>&gt;.

Linux-PAM                                          07/03/2025                                   <u><a href="../man8/PAM_NAMESPACE.8.html">PAM_NAMESPACE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>