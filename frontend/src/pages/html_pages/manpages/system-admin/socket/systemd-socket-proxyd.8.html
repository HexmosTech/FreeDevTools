<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>systemd-socket-proxyd - Bidirectionally proxy local sockets to another (possibly remote) socket</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/systemd">systemd_257.7-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       systemd-socket-proxyd - Bidirectionally proxy local sockets to another (possibly remote) socket

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>systemd-socket-proxyd</b> [<u>OPTIONS</u>...] <u>HOST</u>:<u>PORT</u>

       <b>systemd-socket-proxyd</b> [<u>OPTIONS</u>...] <u>UNIX-DOMAIN-SOCKET-PATH</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>systemd-socket-proxyd</b> is a generic socket-activated network socket forwarder proxy daemon for IPv4, IPv6
       and UNIX stream sockets. It may be used to bi-directionally forward traffic from a local listening socket
       to a local or remote destination socket.

       One use of this tool is to provide socket activation support for services that do not natively support
       socket activation. On behalf of the service to activate, the proxy inherits the socket from systemd,
       accepts each client connection, opens a connection to a configured server for each client, and then
       bidirectionally forwards data between the two.

       This utility's behavior is similar to <b><a href="../man1/socat.1.html">socat</a></b>(1). The main differences for <b>systemd-socket-proxyd</b> are
       support for socket activation with "Accept=no" and an event-driven design that scales better with the
       number of connections.

       Note that <b>systemd-socket-proxyd</b> will not forward socket side channel information, i.e. will not forward
       <b>SCM_RIGHTS</b>, <b>SCM_CREDENTIALS</b>, <b>SCM_SECURITY</b>, <b>SO_PEERCRED</b>, <b>SO_PEERPIDFD</b>, <b>SO_PEERSEC</b>, <b>SO_PEERGROUPS</b> and
       similar.

</pre><h4><b>OPTIONS</b></h4><pre>
       The following options are understood:

       <b>-h</b>, <b>--help</b>
           Print a short help text and exit.

       <b>--version</b>
           Print a short version string and exit.

       <b>--connections-max=</b>, <b>-c</b>
           Sets the maximum number of simultaneous connections, defaults to 256. If the limit of concurrent
           connections is reached further connections will be refused.

           Added in version 233.

       <b>--exit-idle-time=</b>
           Sets the time before exiting when there are no connections, defaults to <b>infinity</b>. Takes a unit-less
           value in seconds, or a time span value such as "5min 20s".

           Added in version 246.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       On success, 0 is returned, a non-zero failure code otherwise.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Simple</b> <b>Example</b>
       Use two services with a dependency and no namespace isolation.

       <b>Example</b> <b>1.</b> <b>proxy-to-nginx.socket</b>

           [Socket]
           ListenStream=80

           [Install]
           WantedBy=sockets.target

       <b>Example</b> <b>2.</b> <b>proxy-to-nginx.service</b>

           [Unit]
           Requires=nginx.service
           After=nginx.service
           Requires=proxy-to-nginx.socket
           After=proxy-to-nginx.socket

           [Service]
           Type=notify
           ExecStart=<a href="file:/usr/lib/systemd/systemd-socket-proxyd">/usr/lib/systemd/systemd-socket-proxyd</a> /run/nginx/socket
           PrivateTmp=yes
           PrivateNetwork=yes

       <b>Example</b> <b>3.</b> <b>nginx.conf</b>

           [...]
           server {
               listen       unix:/run/nginx/socket;
               [...]

       <b>Example</b> <b>4.</b> <b>Enabling</b> <b>the</b> <b>proxy</b>

           # systemctl enable --now proxy-to-nginx.socket
           $ curl <a href="http://localhost">http://localhost</a>:80/

       If nginx.service has <u>StopWhenUnneeded=</u> set, then passing <b>--exit-idle-time=</b> to <b>systemd-socket-proxyd</b>
       allows both services to stop during idle periods.

   <b>Namespace</b> <b>Example</b>
       Similar as above, but runs the socket proxy and the main service in the same private namespace, assuming
       that nginx.service has <u>PrivateTmp=</u> and <u>PrivateNetwork=</u> set, too.

       <b>Example</b> <b>5.</b> <b>proxy-to-nginx.socket</b>

           [Socket]
           ListenStream=80

           [Install]
           WantedBy=sockets.target

       <b>Example</b> <b>6.</b> <b>proxy-to-nginx.service</b>

           [Unit]
           Requires=nginx.service
           After=nginx.service
           Requires=proxy-to-nginx.socket
           After=proxy-to-nginx.socket
           JoinsNamespaceOf=nginx.service

           [Service]
           Type=notify
           ExecStart=<a href="file:/usr/lib/systemd/systemd-socket-proxyd">/usr/lib/systemd/systemd-socket-proxyd</a> 127.0.0.1:8080
           PrivateTmp=yes
           PrivateNetwork=yes

       <b>Example</b> <b>7.</b> <b>nginx.conf</b>

           [...]
           server {
               listen       8080;
               [...]

       <b>Example</b> <b>8.</b> <b>Enabling</b> <b>the</b> <b>proxy</b>

           # systemctl enable --now proxy-to-nginx.socket
           $ curl <a href="http://localhost">http://localhost</a>:80/

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man5/systemd.socket.5.html">systemd.socket</a></b>(5), <b><a href="../man5/systemd.service.5.html">systemd.service</a></b>(5), <b><a href="../man1/systemctl.1.html">systemctl</a></b>(1), <b><a href="../man1/socat.1.html">socat</a></b>(1), <b><a href="../man1/nginx.1.html">nginx</a></b>(1), <b><a href="../man1/curl.1.html">curl</a></b>(1)

systemd 257.7                                                                           <u><a href="../man8/SYSTEMD-SOCKET-PROXYD.8.html">SYSTEMD-SOCKET-PROXYD</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>