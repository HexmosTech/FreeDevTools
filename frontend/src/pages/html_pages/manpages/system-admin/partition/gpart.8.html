<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gpart - guess PC-type hard disk partitions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/gpart">gpart_0.3-10_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gpart - guess PC-type hard disk partitions

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>gpart</b> [options] <u>device</u>

       Options:   [-b  &lt;backup  MBR&gt;][-C  c,h,s][-c][-d][-E][-e][-f]  [-g][-h][-i][-K  &lt;last-sector&gt;][-k  &lt;#  of
       sectors&gt;] [-L] [-l &lt;log file&gt;][-n &lt;increment&gt;]  [-q][-s  &lt;sector-size&gt;]  [-t  &lt;module-name&gt;][-V][-v]  [-W
       &lt;device&gt;][-w &lt;module-name, weight&gt;]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>gpart</b>  tries to guess which partitions are on a hard disk.  If the primary partition table has been lost,
       overwritten or destroyed the partitions still exist on the disk but the operating  system  cannot  access
       them.

       <b>gpart</b>  ignores  the  primary partition table and scans the disk (or disk image, file) sector after sector
       for several filesystem/partition types. It does so by "asking" filesystem  recognition  modules  if  they
       think  a  given  sequence of sectors resembles the beginning of a filesystem or partition type. Currently
       the following filesystem types are known to <b>gpart</b> (listed by module names) :

       <u>beos</u>   BeOS filesystem type.

       <u>bsddl</u>  FreeBSD/NetBSD/386BSD disklabel sub-partitioning scheme used on Intel platforms.

       <u>ext2</u>   Linux second extended filesystem.

       <u>fat</u>    MS-DOS FAT12/16/32 "filesystems".

       <u>hpfs</u>   IBM OS/2 High Performance filesystem.

       <u>hmlvm</u>  Linux LVM physical volumes (LVM by Heinz Mauelshagen).

       <u>lswap</u>  Linux swap partitions (versions 0 and 1).

       <u>minix</u>  The Minix operating system filesystem type.

       <u>ntfs</u>   MS Windows NT/2000 filesystem.

       <u>qnx4</u>   QNX 4.x filesystem.

       <u>reiserfs</u>
              The Reiser filesystem (version 3.5.X, X &gt; 11, 3.6.X).

       <u>s86dl</u>  Sun Solaris on Intel platforms uses a sub-partitioning scheme on PC hard disks similar to the  BSD
              disklabels.

       <u>xfs</u>    Silicon Graphic's journalling filesystem for Linux.

       More  filesystem  guessing  modules can be added at runtime (see the <u>-t</u> option). Please consult the <b>gpart</b>
       README file for detailed explanations on how to create guessing modules. All modules are accompanied by a
       guessing weight factor which denotes how "educated" their guesses are compared  to  other  modules.  This
       weight can be changed if a certain module keeps on mis-identifying a partition.

       Naturally  only  partitions  which  have  been  formatted in some way can be recognized. If the type of a
       partition entry in the primary partition table is changed from x to y while the filesystem  is  still  of
       type x, <b>gpart</b> will also still guess a type x.

       No  checks are performed whether a found filesystem is clean or even consistent/mountable, so it is quite
       possible that <b>gpart</b> may identify partitions which existed prior to the current partitioning scheme of the
       disk. Especially on large disks old file system headers/superblocks may be present a long time until they
       are finally overwritten with user data.

       It should be stressed that <b>gpart</b> does a  very  heuristic  job,  never  believe  its  output  without  any
       plausability  checks. It can be easily right in its guesswork but it can also be terribly wrong. You have
       been warned.

       After having found a list of possible partition types, the list is checked for consistency. For  example,
       a partition which overlaps with the previous one will be discarded. All remaining partitions are labelled
       with one of the following attributes: "primary", "logical", "orphaned" or "invalid".

       A  partition  labelled  "orphaned"  is  a  logical partition which seems ok but is missed in the chain of
       logical partitions. This may occur if a logical partition is deleted from the  extended  partition  table
       without overwriting the actual disk space.

       An "invalid" partition is one that cannot be accepted because of various reasons. If a consistent primary
       partition table was created in this process it is printed and can be written to a file or device.

</pre><h4><b>EXTENDED</b> <b>PARTITIONS</b></h4><pre>
       If  the  disk/file  to  be examined consists of primary partitions only, <b>gpart</b> has quite a good chance to
       identify them. Extended partitions on the other hand can result in a lot of problems.

       Extended partitions are realized as a linked list of extended partition tables, each of which include  an
       entry  pointing  to  a  logical  partition.  The  size of an extended partition depends on where the last
       logical partition ends. This means that extended partitions may include "holes", unallocated  disk  space
       which should only be assigned to logical, not primary partitions.

       <b>gpart</b>  tries to do its best to check a found chain of logical partitions but there are very many possible
       points of failure. If "good" fdisk programs are used to create extended partitions, the resulting  tables
       consist  of  a  zeroed  boot record and the four partition entries of which at least two should be marked
       unused. Unfortunately e.g. the fdisk program shipped with Windows NT does not seem to zero out  the  boot
       record  area  so <b>gpart</b> has to be overly tolerant in recognizing extended partition tables. This tolerance
       may result in quite stupid guesses.

</pre><h4><b>DISK</b> <b>TRANSFERS</b></h4><pre>
       If you want to investigate hard disks from other systems you should note down  the  geometry  (number  of
       cylinders,  heads  per  cylinder  and  sectors  per  head)  used for that disk, and tell <b>gpart</b> about this
       geometry.

       Investigating disks from machines with a different endianness than the scanning one has not  been  tested
       at all, and is currently not recommended.

</pre><h4><b>LARGE</b> <b>DISKS</b></h4><pre>
       <b>gpart</b>  relies on the OS reporting the correct disk geometry.  Unfortunately sometimes the OS may report a
       geometry smaller the the actual one (e.g. disks with more than 1024 or 16384 cylinder).

       <b>gpart</b> checks if guessed partitions extend beyond the disk size and marks  those  "invalid",  but  may  be
       mistaken  in case the disk size is calculated from an incorrect geometry. For instance if a disk with the
       geometry 1028/255/63 should be scanned, and the OS reports 1024/255/63 <b>gpart</b> should be called like

              gpart -C 1028,255,63 &lt;other options&gt; &lt;device&gt;

</pre><h4><b>PRECAUTIONS</b></h4><pre>
       <b>gpart</b> may be of some help when the primary partition table was lost or destroyed  but  it  can  under  <b>no</b>
       circumstances  replace  proper  disk/partition  table  backups.   To  save  the  master boot record (MBR)
       including the primary partition table to a file type

              dd if=/dev/hda of=mbr bs=512 count=1

       exchanging /dev/hda with the block device name of the disk in question. This should be done for all disks
       in the system. To restore the primary partition table without overwriting the MBR type

              dd if=mbr of=/dev/hda bs=1 count=64 skip=446 seek=446

       <b>Warning:</b> make sure that all parameters are typed as shown and that the disk device is correct. Failing to
       do so may result in severe filesystem corruption. The saved file should be stored in a safe place like  a
       floppy disk.

</pre><h4><b>OPTIONS</b></h4><pre>
       -b backupfile
              If  the guessed primary partition table seems consistent and should be written (see the <u>-W</u> option)
              backup the current MBR into the specified file.

       -C c,h,s
              Set the disk geometry (cylinders, heads, sectors) for the scan. This is useful if a disk should be
              scanned which was partitioned using a different geometry, if the <u>device</u> is a disk-image or if  the
              disk geometry cannot be retrieved through the PCs BIOS. No spaces are allowed between the numbers,
              unless all three are enclosed in quotes.

       -c     Check/compare  mode  (implies  the <u>-q</u> quiet option). After the scan is done, the resulting primary
              partition table is compared to the existing one. The return code of <b>gpart</b> then contains the number
              of differences (0 if they are identical except for the boot/active flag which cannot be  guessed).
              This option has no effect if <u>-d</u> is given on the command line.

       -d     Do  not  start  the guessing loop. Useful if the partition table should be printed (in combination
              with the <u>-v</u> option) without actually scanning for partitions.

       -E     Do not try to identify extended partition tables. If there are extended partitions  on  the  given
              device  <b>gpart</b>  will most certainly complain about too many primary partitions because there can be
              only four primary partitions. Existing logical partitions will be listed as primary ones.

       -e     Do not skip disk read errors. If this option is given, and short disk reads or general  disk  read
              errors (EIO) are encountered, <b>gpart</b> will exit. If not given, the program tries to continue.

       -f     Full  scan.  When a possible partition is found, <b>gpart</b> normally skips all sectors this entry seems
              to occupy and continues the scan from the end of the last possible partition. The  disk  scan  can
              take quite a while if this option is given, be patient.

       -g     Do not try to get the disk geometry from the OS. If the <u>device</u> is no block or character device but
              a  plain file this option should be supplied. If the file to be scanned is an image of a disk, the
              geometry can be given by the <u>-C</u> option.

       -h     Show some help.

       -i     Run  interactively.  Each  time  a  possible  partition  is  identified  the  user  is  asked  for
              confirmation.

       -K last sector
              Scan only up to the given sector or the end of the file or device whichever comes first.

       -k sectors
              Skip  given  number of sectors before the scan. Potentially useful if a partition is looked for at
              the end of a large disk.

       -L     List available filesystem/partition type modules and their weights, then exit.

       -l logfile
              Log output to the given file (even if <u>-q</u> was supplied).

       -n increment
              Scan increment: number of sectors or "s" for single sector increment,  "h"  for  an  increment  of
              sectors per head (depends on geometry) or "c" for cylinder increment.

              The  increment  also influences the condition where extended partition tables are searched: if the
              scan increment is "s" (i.e. 1) extended partition tables are required to be on  a  head  boundary,
              otherwise they must be on a cylinder boundary.

              If  the  disk  geometry  could not be retrieved and no geometry was given on the command line, the
              default increment is one sector.

       -q     Quiet/no output mode. However if a logfile was specified (see <u>-l</u> option) all output is written  to
              that file. This option overrides the <u>-i</u> interactive mode.

       -s sector size
              Preset  medium  sector  size.   <b>gpart</b>  tries to find out the sector size but may fail in doing so.
              Probed sector sizes are 2^i, i=9..14 (512 to 16384 bytes). The default medium sector size  is  512
              bytes.

       -V     Show version number.

       -v     Be verbose. This option can be given more than once resulting in quite a lot of information.

       -W device
              Write  partition table. If a consistent primary partition table has been guessed it can be written
              to the specified file or device. The supplied device can be the same as the scanned one.

              Additionally the guessed partition entries can be edited. No checks are performed on  the  entered
              values, thus the resulting table is allowed to be highly inconsistent. Please beware.

              <b>Warning:</b>  The guessed partition table should be checked very carefully before writing it back. You
              can always write the guessed partition table into a plain file and write this into sector 0  using
              <b><a href="../man1/dd.1.html">dd</a></b>(1) (see section PRECAUTIONS above).

       -w module name,weight
              Put  the  given module at the head of the module chain and assign a new weight to that module. All
              modules are given an initial weight of 1.0. Again no spaces are allowed.

       Default settings are "-n h".

</pre><h4><b>EXAMPLES</b></h4><pre>
       - To scan the first IDE hard disk under Linux using default settings type

              gpart /dev/hda

       - To print the primary partition table of the third IDE drive without starting the scan loop  in  FreeBSD
       type

              gpart -vvd /dev/wd2

       - If  <b><a href="../man8/lilo.8.html">lilo</a>(8)</b>  was  installed in the master boot record (MBR) of a hard disk it saves the contents of the
       first sector in a file called /boot/boot.&lt;major/minor&gt;. To list the partitions contained in such  a  file
       type e.g.

              gpart -vdg /boot/boot.0300

       If  the  partition  table  contains  an  extended  partition,  <b>gpart</b> will complain about invalid extended
       partition tables because the extended entry points to sectors not within that file.

       - Usually the first primary partition starts on the second head.  If  <b>gpart</b>  cannot  identify  the  first
       partition  properly  this  may not be the case.  <b>gpart</b> can be told to start the scan directly from sector
       one of the disk, using the sector-wise scan mode:

              gpart -k 1 -n s /dev/hdb

       - Suppose <b>gpart</b> identifies an NTFS partition as FAT on a certain  disk.  In  this  situation  the  "ntfs"
       module  should  be  made the first module to be probed and given a weight higher than the usual weight of
       1.0:

              gpart -w ntfs,1.5 /dev/hdb

       To list the available modules and their weights use the <u>-L</u> option.

       - After having checked the output of <b>gpart</b> at least thrice, the primary partition table  can  be  written
       back to the device this way:

              gpart -W /dev/sdc /dev/sdc

       This of course may be extremely dangerous to your health and social security, so beware.

       - A  hard  disk  with 63 sectors per head is scanned in steps of 63 sectors. To perform the scan on every
       second head while skipping the first 1008 sectors type

              gpart -k 1008 -n 126 /dev/sda

       - If you want to see how easily <b>gpart</b> can be mislead, and how many probable partition  starts  are  on  a
       disk, search the whole disk really sector by sector, writing all output to a logfile:

              gpart -vvfn s -ql /tmp/gpart.log /dev/sd2 &amp;

       Usually  <b>gpart</b> will not be able to produce an educated guess of the primary partition table in this mode.
       The logfile however may contain enough hints to manually reconstruct the partition table.

</pre><h4><b>FILES</b></h4><pre>
       <u><a href="file:/dev/">/dev/</a>*</u>
              Hard disk block devices. The naming scheme of hard disk block devices  is  OS  dependent,  consult
              your system manuals for more information.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       There are many error message types, all of them should be self-explanatory. Complain if they are not.

</pre><h4><b>BUGS</b></h4><pre>
       <b>gpart</b> is beta software, so expect buggy behaviour.

       -   <b>gpart</b>  only  accepts extended partition links with one logical partition. There may be <b>fdisk</b> variants
       out there creating links with up to three logical partition entries but these are not accepted.

</pre><h4><b>TO</b> <b>DO</b></h4><pre>
       - Support big-endian architectures.
       - Test on 64-bit architectures.
       - Look for boot manager partitions (e.g. OS/2 BM).
       - Think about reconstructing logical partition chains.

</pre><h4><b>AUTHOR</b></h4><pre>
       Please send bug reports, suggestions, comments etc. to

              Michail Brzitwa &lt;<a href="mailto:michail@brzitwa.de">michail@brzitwa.de</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/fdisk.8.html">fdisk</a></b>(8).

Administration Tools                              January 2001                                          <u><a href="../man8/GPART.8.html">GPART</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>