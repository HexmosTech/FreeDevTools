<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tdx-util - Overview manipulation utility for tradindexed</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/inn2">inn2_2.7.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tdx-util - Overview manipulation utility for tradindexed

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>tdx-util</b> [<b>-AFcgioO</b>] [<b>-a</b> <u>article</u>] [<b>-f</b> <u>status</u>] [<b>-n</b> <u>newsgroup</u>] [<b>-p</b> <u>path</u>] [<b>-R</b> <u>path</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>tdx-util</b> is an administrative interface to the tradindexed overview method for INN.  It only works on
       tradindexed overview databases, not on any other type of INN overview.  (See dedicated <a href="../man8/ovdb_stat.8.html">ovdb_stat</a>(8) and
       <a href="../man8/ovsqlite-util.8.html">ovsqlite-util</a>(8) programs for ovdb and ovqslite overview methods.)  It allows the administrator to dump
       various information about the internal state of the overview, audit it for errors, and rebuild portions
       of the overview database.

       The tradindexed overview method should lock properly and therefore it should be safe to run this utility
       and perform any operation it performs, including full repairs or per-group overview rebuilds, while the
       server is running.  However, note that some of the operations performed by this utility can take an
       extended period of time and will hold locks in the overview database during that period, which depending
       on what the server is doing may cause the server to stall until <b>tdx-util</b> completes its operation.

       The dump operations are <b>-i</b>, which dumps the master index for the overview database, <b>-g</b>, which dumps the
       index for an individual group, and <b>-o</b> and <b>-O</b>, which dump the overview information for a particular group
       (including the additional metadata stored in the index) in two different formats.  For <b>-g</b>, <b>-o</b>, and <b>-O</b>,
       the <b>-n</b> option must also be given to specify a newsgroup to operate on.

       To add a new newsgroup to the overview database, use <b>-c</b>.  A group must be specified with <b>-n</b>.  If the
       group status is something other than "y", it should be specified with <b>-f</b>, and the low and high article
       numbers may be specified with <b>-a</b>.  If only one number is given rather than a range, it will be taken to
       be the high water mark and the low mark will be set to 1.

       To audit the entire overview database for problems, use <b>-A</b>.  Any problems found will be reported to
       standard error.  Use <b>-F</b> to correct the errors found.

       To rebuild the database for a particular newsgroup, use <b>-R</b>.  The <b>-R</b> option takes a path to a directory
       which contains all of the articles for that newsgroup, one per file.  The names of the files must be the
       numbers of the articles in that group.  (In other words, this directory must be a traditional spool
       directory for that group.)  The <b>-n</b> option must also be given to specify the newsgroup for which the
       overview is being rebuilt.

       For all operations performed by <b>tdx-util</b>, a different overview database than the one specified in
       <u>inn.conf</u> may be specified using the <b>-p</b> option.

       The number of overview records stored in the database can be obtained with the "inndf -n" command.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b> <u>article</u>
           The  article  number  or  numbers  to  act on.  <u>article</u> is a valid NNTP range, meaning that it can be
           either a single article number or a range of article numbers (like "1-5").  Either the start  or  the
           end  (or  both)  of  the  range  may  be omitted, in which case they will be set to the first or last
           article number in the group.  Passing "-" for <u>article</u> is therefore equivalent to  not  using  the  <b>-a</b>
           option at all.

           Only  useful  in  combination  with  the <b>-o</b> and <b>-O</b> options to dump overview information or with <b>-c</b> to
           specify the low and high article numbers when creating a group.

       <b>-A</b>  Audit the entire overview database for problems.  This runs the  internal  consistency  checks  built
           into  the  tradindexed overview implementation, checking such things as the validity and reachability
           of all group index entries, the format of the individual  overview  entries,  the  correspondence  of
           index  entries  to  overview data, and similar such things.  No changes will be made to the database,
           but problems will be reported to standard error.

       <b>-c</b>  Create a new group in the overview database.  The group must be specified  with  <b>-n</b>.   The  newsgroup
           status  defaults  to "y" but may be set with <b>-f</b>.  The low and high article numbers default to 1 and 0
           respectively, but may be set with <b>-a</b>.  If only one number is given to <b>-a</b>, it is  taken  as  the  high
           article number.

       <b>-F</b>  Audit  the  entire  overview  database  for problems, fixing them as they're detected where possible.
           This runs the internal  consistency  checks  built  into  the  tradindexed  overview  implementation,
           checking  such  things as the validity and reachability of all group index entries, the format of the
           individual overview entries, the correspondence of index entries to overview data, and  similar  such
           things.   The  strategy  used  when fixing problems is to throw away data that's unrecoverable, so be
           warned that using this option may result in inaccessible articles if their  overview  data  has  been
           corrupted.

           To see what would be changed by <b>-F</b>, run <b>tdx-util</b> with <b>-A</b> first.

       <b>-f</b> <u>status</u>
           When  creating  a  newsgroup  with <b>-c</b>, set the status of the newly created group to <u>status</u> instead of
           "y".  Only useful with <b>-c</b>.

       <b>-g</b>  Dump the index of a particular group.  The fields are, in order, the article number,  the  offset  of
           the  data for that article in the overview data file for that group, the length of the overview data,
           the time (in seconds since epoch) when the article arrived on the server, the time (in seconds  since
           epoch)  when the article should expire based on its Expires header field (or 0 if there is no Expires
           header field), and the storage API token of the article.

           If this option is given, the <b>-n</b> option must also be given to specify the newsgroup on which to act.

       <b>-i</b>  Dump the master index of the overview database.  This contains  similar  information  to  the  server
           <u>active</u>  file,  such  as  high  and low water marks and moderation status, and is the information that
           <b>nnrpd</b> hands out to clients.

           The fields are, in order, the newsgroup name, the high water mark,  the  low  water  mark,  the  base
           article  number  (the point at which the group index begins), the count of articles in the group, the
           group status, the time (in seconds since epoch) when that newsgroup was deleted or  0  if  it  hasn't
           been, and the inode of the index file for that group.

           A  particular  newsgroup  can be specified with the <b>-n</b> option.  If <b>-n</b> is not given, the entire master
           index will be dumped.

       <b>-n</b> <u>newsgroup</u>
           Specify the newsgroup on which to act, required for the <b>-c</b>, <b>-g</b>, <b>-o</b>, <b>-O</b>, and <b>-R</b> options, and  optional
           for the <b>-i</b> option.

       <b>-o</b>  Dump  the overview information for a newsgroup, in the same format as it would be returned to clients
           but with one modification.  Appended to the end of each entry will be four additional pieces of data:
           the article number according to the index file for that group labelled with "Article:",  the  storage
           API token for that article labelled with "Token:", the arrival date for that article on the server in
           RFC 5322  date  format  labelled  with "Arrived:", and the expiration date for that article (from the
           Expires header field) in RFC 5322 date format if there is any, labelled with "Expires:".

           If this option is given, the <b>-n</b> option must also be given to specify the newsgroup on which  to  act.
           By  default,  all  of the overview information for that newsgroup is dumped, but the <b>-a</b> option may be
           given to restrict the dump to the information for a single article or a range of article numbers.

       <b>-O</b>  Dump the overview information for a newsgroup in the format used by <b>overchan</b>  as  input.   Each  line
           will  start  with  the  storage  API token, the arrival timestamp in seconds since epoch, the expires
           timestamp in the same format (or 0 if there is no Expires header field), and then the overview data.

           If this option is given, the <b>-n</b> option must also be given to specify the newsgroup on which  to  act.
           By  default,  all  of the overview information for that newsgroup is dumped, but the <b>-a</b> option may be
           given to restrict the dump to the information for a single article or a range of article numbers.

       <b>-p</b> <u>path</u>
           Act on the overview database rooted in <u>path</u>, overriding the overview path specified in <u>inn.conf</u>.

       <b>-R</b> <u>path</u>
           Rebuild the overview for a given group from the articles stored in <u>path</u>.  The articles must be in the
           form of a traditional spool directory; in other words, each article must be in a  separate  file  and
           the name of the file must match the article number of the article.

           If this option is given, the <b>-n</b> option must also be given to specify the newsgroup on which to act.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Dump  the  master  index  for  the  overview  database in <u>/news/overview</u>, regardless of the overview path
       specified in <u>inn.conf</u>:

           tdx-util -i -p /news/overview

       Dump the group index for example.test:

           tdx-util -g -n example.test

       Dump the complete overview information for example.test:

           tdx-util -o -n example.test

       Dump the overview information for articles 45 and higher in example.test:


           tdx-util -o -n example.test -a 45-
       Create an entry for example.test with mode m and low and high article numbers of 4 and 23, respectively.

           tdx-util -c -n example.test -f m -a 4-23

       Audit the entire overview database for any problems:

           tdx-util -A

       Rebuild the overview information for example.test from a traditional spool directory:

           tdx-util -R &lt;patharticles in inn.conf&gt;/example/test -n example.test

       The last command may be useful for recovering from a bad crash or corrupted overview  information  for  a
       particular group, if you are also using the tradspool article storage method.

</pre><h4><b>HISTORY</b></h4><pre>
       Written by Russ Allbery &lt;<a href="mailto:eagle@eyrie.org">eagle@eyrie.org</a>&gt; for InterNetNews.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/inndf.8.html">inndf</a>(8), <a href="../man8/makehistory.8.html">makehistory</a>(8), <a href="../man8/nnrpd.8.html">nnrpd</a>(8).

INN 2.7.3                                          2025-05-19                                        <u><a href="../man8/TDX-UTIL.8.html">TDX-UTIL</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>