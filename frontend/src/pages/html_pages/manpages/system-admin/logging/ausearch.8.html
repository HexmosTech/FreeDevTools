<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ausearch - a tool to query audit daemon logs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/auditd">auditd_4.0.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ausearch - a tool to query audit daemon logs

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ausearch</b> [<u>options</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>ausearch</b>  is  a  tool  that  can  query  the audit daemon logs based for events based on different search
       criteria. The ausearch utility can also take input from stdin as long as the input is the raw  log  data.
       Each  commandline  option  given  forms  an "and" statement. For example, searching with <b>-m</b> and <b>-ui</b> means
       return events that have both the requested type and match the user id given. An exception is the <b>-m</b>   and
       <b>-n</b>  options;  multiple record types and nodes are allowed in a search which will return any matching node
       and record.

       It should also be noted that each syscall excursion from user space into the kernel and  back  into  user
       space  has one event ID that is unique. Any auditable event that is triggered during this trip share this
       ID so that they may be correlated.

       Different parts of the kernel may add supplemental records. For example, an audit event  on  the  syscall
       "open"  will  also  cause  the kernel to emit a PATH record with the file name. The ausearch utility will
       present all records that make up one event together. This could mean that even though you  search  for  a
       specific kind of record, the resulting events may contain SYSCALL records.

       Also  be  aware that not all record types have the requested information. For example, a PATH record does
       not have a hostname or a loginuid.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b>, <b>--event</b> <u>audit-event-id</u>
              Search for an event based on the given  <u>event</u>  <u>ID</u>.  Messages  always  start  with  something  like
              msg=audit(1116360555.329:2401771). The event ID is the number after the ':'. All audit events that
              are recorded from one application's syscall have the same audit event ID. A second syscall made by
              the same application will have a different event ID. This way they are unique.

       <b>--arch</b> <u>CPU</u>
              Search  for  events  based  on  a  specific CPU architecture.  If you do not know the arch of your
              machine but you want to use the 32 bit syscall table and your machine supports 32  bits,  you  can
              also  use  <b>b32</b>  for  the arch. The same applies to the 64 bit syscall table, you can use <b>b64.</b>  The
              arch of your machine can be found by doing 'uname -m'.

       <b>-c</b>, <b>--comm</b> <u>comm-name</u>
              Search for an event based on the given <u>comm</u> <u>name</u>. The comm name is the executable's name from  the
              task structure.

       <b>--debug</b>
              Write malformed events that are skipped to stderr.

       <b>--checkpoint</b> <u>checkpoint-file</u>
              Checkpoint  the  output  between  successive  invocations  of  ausearch  such that only events not
              previously output will print in subsequent invocations.

              An auditd event is made up of one or more records. When processing events, ausearch defines events
              as either complete or in-complete.  A complete event is either a single record event or one  whose
              event time occurred 2 seconds in the past compared to the event being currently processed.

              A checkpoint is achieved by recording the last completed event output along with the device number
              and  inode  of  the  file  the  last  completed event appeared in <u>checkpoint-file</u>. On a subsequent
              invocation, ausearch will load this checkpoint data and as it processes the  log  files,  it  will
              discard  all  complete  events until it matches the checkpointed one. At this point, it will start
              outputting complete events.

              Should the file or the last checkpointed event not be found, one of a number of errors will result
              and ausearch will terminate. See <b>EXIT</b> <b>STATUS</b> for detail.

       <b>--eoe-timeout</b> <u>seconds</u>
              Set the end of event parsing timeout. See <b>end_of_event_timeout</b> in <u><a href="../man5/auditd.conf.5.html">auditd.conf</a>(5)</u> for details. Note
              that setting this value will override any configured value found in /etc/auditd/auditd.conf.

       <b>-e,</b> --exit <u>exit-code-or-errno</u>
              Search for an event based on the given syscall <u>exit</u> <u>code</u> <u>or</u> <u>errno</u>.

       <b>--escape</b> <u>option</u>
              This option determines if the output is escaped to make the content safer for  certain  uses.  The
              options  are  <u>raw</u>  ,  <u>tty</u>  ,  <u>shell</u>  ,  and  <u>shell_quote</u>. Each mode includes the characters of the
              preceding mode and escapes more characters. That is to say <u>shell</u> includes all  characters  escaped
              by <u>tty</u> and adds more. <u>tty</u> is the default.

       <b>--extra-keys</b>
              When  the  <u>format</u>  mode  is  <u>csv</u>,  this option will add a final column with key information if its
              exists for the event. This would only occur on SYSCALL records which were the result of triggering
              an audit rule that defines a key.

       <b>--extra-labels</b>
              When the <u>format</u> mode is <u>csv</u>, this option will add columns of information about subject and  object
              labels when they exist.

       <b>--extra-obj2</b>
              When  the  <u>format</u>  mode  is <u>csv</u>, this option will add columns of information about a second object
              when it exists. It's rare that a second object is part of a record. Some examples are when a  file
              is renamed from one name to another or when a device is mounted to a path.

       <b>--extra-time</b>
              When the <u>format</u> mode is <u>csv</u>, this option will add columns of information about broken down time to
              make subsetting easier.

       <b>-f</b>, <b>--file</b> <u>file-name</u>
              Search  for  an event based on the given <u>filename</u>. The argument will match normal files as well as
              af_unix sockets.

       <b>--format</b> <u>option</u>
              Events that match the search criteria are formatted using this option. The supported formats  are:
              raw,  default,  interpret, csv, and text. The <u>raw</u> option is described under the <u>--raw</u> command line
              option. The <u>default</u> option is what you get when no formatting options are passed. It includes  one
              line  as  a  visual  separator  which  indicates  the time stamp and then the records of the event
              follow. The <u>interpret</u> option is explained under the <u>-i</u> command line option. The <u>csv</u> option outputs
              the results of the search as a normalized event in comma separated value (CSV) format suitable for
              import into analytical programs. The <u>text</u> option turns the event into an English sentence that  is
              easier  to  understand  than other options, but it comes at the expense of loss of detail. In most
              cases this is perfectly fine since the original event still retains all the original information.

       <b>-ga</b>, <b>--gid-all</b> <u>all-group-id</u>
              Search for an event with either effective group ID or group ID matching the given <u>group</u> <u>ID</u>.

       <b>-ge</b>, <b>--gid-effective</b> <u>effective-group-id</u>
              Search for an event with the given <u>effective</u> <u>group</u> <u>ID</u> or group name.

       <b>-gi</b>, <b>--gid</b> <u>group-id</u>
              Search for an event with the given <u>group</u> <u>ID</u> or group name.

       <b>-h</b>, <b>--help</b>
              Help

       <b>-hn</b>, <b>--host</b> <u>host-name</u>
              Search for an event with the given <u>host</u> <u>name</u>.  The  hostname  can  be  either  a  hostname,  fully
              qualified domain name, or numeric network address. No attempt is made to resolve numeric addresses
              to  domain  names  or aliases. This search typically correlates to the addr or host field of audit
              events. Also see the --node command which searches the node field.

       <b>-i</b>, <b>--interpret</b>
              Interpret numeric entities into text. For example, uid is converted to account name. If the  audit
              logs  are  unenriched, the conversion is done using the current resources of the machine where the
              search is being run. If you have renamed the accounts, or don't have the  same  accounts  on  your
              machine, you could get misleading results. If the logs are enriched, it uses the supplemental data
              to do the conversion. This allows accurate log reporting even when run on a different machine than
              the original logs came from.

       <b>-if</b>, <b>--input</b> <u>file-name</u> | <u>directory</u>
              Use  the  given <u>file</u> or <u>directory</u> instead of the logs. This is to aid analysis where the logs have
              been moved to another machine or only part of a log was saved. The path length is limited to  4064
              bytes.

       <b>--input-logs</b>
              Use the log file location from auditd.conf as input for searching. This is needed if you are using
              ausearch from a cron job.

       <b>--just-one</b>
              Stop after emitting the first event that matches the search criteria.

       <b>-k</b>, <b>--key</b> <u>key-string</u>
              Search for an event based on the given <u>key</u> <u>string</u>.

       <b>-l</b>, <b>--line-buffered</b>
              Flush  output  on every line. Most useful when stdout is connected to a pipe and the default block
              buffering strategy is undesirable. May impose a performance penalty.

       <b>-m</b>, <b>--message</b> <u>message-type</u> | <u>comma-sep-message-type-list</u>
              Search for an event matching the given <u>message</u> <u>type</u>. (Message  types  are  also  known  as  record
              types.)  You may also enter a <u>comma</u> <u>separated</u> <u>list</u> <u>of</u> <u>message</u> <u>types</u> or multiple individual message
              types each with its own <u>-m</u> option. There is an <b>ALL</b> message type that doesn't exist in  the  actual
              logs.  It  allows you to get all messages in the system. The list of valid messages types is long.
              The program will display the list whenever no message type is  passed  with  this  parameter.  The
              message  type  can be either text or numeric. If you enter a list, there can be only commas and no
              spaces separating the list.

       <b>-n</b>, <b>--node</b>
              Search for events originating from a specific machine. Multiple nodes  are  allowed,  and  if  any
              nodes  match,  the event is matched. This search uses the node field in audit events. Also see the
              --host command which search for events related to host information in the audit trail.

       <b>-o</b>, <b>--object</b> <u>SE-Linux-context-string</u>
              Search for event with <u>tcontext</u> (object) matching the string.

       <b>-p</b>, <b>--pid</b> <u>process-id</u>
              Search for an event matching the given <u>process</u> <u>ID</u>.

       <b>-pp</b>, <b>--ppid</b> <u>parent-process-id</u>
              Search for an event matching the given <u>parent</u> <u>process</u> <u>ID</u>.

       <b>-r</b>, <b>--raw</b>
              Output is completely unformatted. This is useful for extracting records to a file that  can  still
              be interpreted by audit tools or when piping to other audit tools.

       <b>-sc</b>, <b>--syscall</b> <u>syscall-name-or-value</u>
              Search  for  an event matching the given <u>syscall</u>. You may either give the numeric syscall value or
              the syscall name. If you give the syscall name, it will use the syscall table for the machine that
              you are using.

       <b>-se</b>, <b>--context</b> <u>SE-Linux-context-string</u>
              Search for events with either <u>scontext</u>/subject or <u>tcontext</u>/object matching the given string.

       <b>--session</b> <u>Login-Session-ID</u>
              Search for events matching the given Login Session ID. This process attribute is set when  a  user
              logs in and can tie any process to a particular user login.

       <b>-su</b>, <b>--subject</b> <u>SE-Linux-context-string</u>
              Search for event with <u>scontext</u> (subject) matching the string.

       <b>-sv</b>, <b>--success</b> <u>success-value</u>
              Search for an event matching the given <u>success</u> <u>value</u>. Legal values are <b>yes</b> and <b>no</b>.

       <b>-te</b>, <b>--end</b> [<u>end-date</u>] [<u>end-time</u>]
              Search  for  events with time stamps equal to or before the given end time. The format of end time
              depends on your locale. You can check the format of your locale by running  <b>date</b>  <b>'+%x'.</b>   If  the
              date  is omitted, <b>today</b> is assumed. If the time is omitted, <b>now</b> is assumed. Use 24 hour clock time
              rather than AM or PM to specify time. An example date using the en_US.utf8 locale  is  09/03/2009.
              An  example  of  time  is  18:00:00.  The  date  format  accepted  is  influenced  by  the LC_TIME
              environmental variable.

              You may also use the word: <b>now</b>, <b>recent</b>, <b>this-hour</b>, <b>boot</b>, <b>today</b>,  <b>yesterday</b>,  <b>this-week</b>,  <b>week-ago</b>,
              <b>this-month</b>, or <b>this-year</b>. <b>Now</b> means starting now. <b>Recent</b> is 10 minutes ago. <b>Boot</b> means the time of
              day  to  the  second  when  the  system  last booted. <b>Today</b> means now. <b>Yesterday</b> is 1 second after
              midnight the previous day. <b>This-week</b> means starting 1 second after midnight on day 0 of  the  week
              determined  by  your locale (see <b>localtime</b>). <b>Week-ago</b> means 1 second after midnight exactly 7 days
              ago. <b>This-month</b> means 1 second after midnight on day 1 of the month. <b>This-year</b> means the 1  second
              after midnight on the first day of the first month.

       <b>-ts</b>, <b>--start</b> [<u>start-date</u>] [<u>start-time</u>]
              Search  for  events  with  time stamps equal to or after the given start time. The format of start
              time depends on your locale. You can check the format of your locale by running  <b>date</b>  <b>'+%x'.</b>   If
              the  date  is  omitted, <b>today</b> is assumed. If the time is omitted, <b>midnight</b> is assumed. Use 24 hour
              clock time rather than AM or PM to specify time. An example date using the  en_US.utf8  locale  is
              09/03/2009.  An example of time is 18:00:00. The date format accepted is influenced by the LC_TIME
              environmental variable.

              You may also use the word: <b>now</b>, <b>recent</b>, <b>this-hour</b>, <b>boot</b>, <b>today</b>,  <b>yesterday</b>,  <b>this-week</b>,  <b>week-ago</b>,
              <b>this-month</b>,  <b>this-year</b>,  or  <b>checkpoint</b>.  <b>Boot</b> means the time of day to the second when the system
              last booted. <b>Today</b> means starting at 1 second after midnight. <b>Recent</b> is 10 minutes ago.  <b>Yesterday</b>
              is  1  second after midnight the previous day. <b>This-week</b> means starting 1 second after midnight on
              day 0 of the week determined by your locale (see <b>localtime</b>).  <b>Week-ago</b>  means  starting  1  second
              after midnight exactly 7 days ago. <b>This-month</b> means 1 second after midnight on day 1 of the month.
              <b>This-year</b> means the 1 second after midnight on the first day of the first month.

              <b>checkpoint</b> means <u>ausearch</u> will use the timestamp found within a valid checkpoint file ignoring the
              recorded  inode,  device,  serial,  node  and  event  type  also  found  within a checkpoint file.
              Essentially, this is the recovery action should an invocation of <u>ausearch</u> with a checkpoint option
              fail with an exit status of 10, 11 or 12. It could be used in a shell script something like:

                   ausearch --checkpoint /etc/audit/auditd_checkpoint.txt -i
                   _au_status=$?
                   if test ${_au_status} eq 10 -o ${_au_status} eq 11 -o ${_au_status} eq 12
                   then
                     ausearch --checkpoint /etc/audit/auditd_checkpoint.txt --start checkpoint -i
                   fi

       <b>-tm</b>, <b>--terminal</b> <u>terminal</u>
              Search for an event matching the given <u>terminal</u> value. Some daemons such as cron and atd  use  the
              daemon name for the terminal.

       <b>-ua</b>, <b>--uid-all</b> <u>all-user-id</u>
              Search  for  an event with either user ID, effective user ID, or login user ID (auid) matching the
              given <u>user</u> <u>ID</u>.

       <b>-ue</b>, <b>--uid-effective</b> <u>effective-user-id</u>
              Search for an event with the given <u>effective</u> <u>user</u> <u>ID</u>.

       <b>-ui</b>, <b>--uid</b> <u>user-id</u>
              Search for an event with the given <u>user</u> <u>ID</u>.

       <b>-ul</b>, <b>--loginuid</b> <u>login-id</u>
              Search for an event with the given <u>login</u> <u>user</u> <u>ID</u>. All entry point programs that are PAMified  need
              to be configured with pam_loginuid required for the session for searching on loginuid (auid) to be
              accurate.

       <b>-uu</b>, <b>--uuid</b> <u>guest-uuid</u>
              Search for an event with the given <u>guest</u> <u>UUID</u>.

       <b>-v</b>, <b>--version</b>
              Print the version and exit

       <b>-vm</b>, <b>--vm-name</b> <u>guest-name</u>
              Search for an event with the given <u>guest</u> <u>name</u>.

       <b>-w</b>, <b>--word</b>
              String  based  matches  must  match  the  whole  word. This category of matches include: filename,
              hostname, terminal, keys, and SE Linux context.

       <b>-x</b>, <b>--executable</b> <u>executable</u>
              Search for an event matching the given <u>executable</u> name.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       0    if OK,

       1    if nothing found, or argument errors or minor file access/read errors,

       10   invalid checkpoint data found in checkpoint file,

       11   checkpoint processing error

       12   checkpoint event not found in matching log file

</pre><h4><b>NOTE</b></h4><pre>
       The boot time option is a convenience function and has limitations. The time it calculates  is  based  on
       time  now  minus /proc/uptime. If after boot the system clock has been adjusted, perhaps by ntp, then the
       calculation may be wrong. In that case you'll need to fully specify the time. You can check the  time  it
       would use by running:

       date -d "`cut -f1 -d. <a href="file:/proc/uptime">/proc/uptime</a>` seconds ago"

</pre><h4><b>EXAMPLES</b></h4><pre>
       Search for a specific user:
       # ausearch --start today --loginuid john -i

       Check the SELinux log for any denials today
       # ausearch --start today -m avc -i

       Output any recent SELinux log
       # ausearch -m avc,user_avc,selinux_err,user_selinux_err -i -ts recent

       Output logs in text format
       # ausearch --start today --format text

       Output TTY events interpreted and shell escaped
       # ausearch --start today -m TTY -i --escape shell_quote

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/auditd.8.html">auditd</a></b>(8), <b><a href="../man5/auditd.conf.5.html">auditd.conf</a></b>(5), <b><a href="../man8/aureport.8.html">aureport</a></b>(8), <b><a href="../man8/pam_loginuid.8.html">pam_loginuid</a></b>(8).

Red Hat                                             July 2023                                        <u><a href="../man8/AUSEARCH.8.html">AUSEARCH</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>