<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fwlogwatch - a firewall log analyzer and realtime response agent</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/fwlogwatch">fwlogwatch_1.4-5_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fwlogwatch - a firewall log analyzer and realtime response agent

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>fwlogwatch</b> [<u>options</u>] [<u>input_files</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>fwlogwatch</b>  produces  Linux  ipchains,  Linux  netfilter/iptables, Solaris/BSD/IRIX/HP-UX ipfilter, ipfw,
       Cisco IOS, Cisco PIX/ASA, NetScreen, Elsa Lancom router and Snort IDS log summary reports in  plain  text
       and  HTML  form  and  has  a  lot of options to analyze and display relevant patterns. It also can run as
       daemon (with web interface) doing realtime log monitoring and  reporting  anomalies  or  starting  attack
       countermeasures.

</pre><h4><b>GENERAL</b> <b>OPTIONS</b></h4><pre>
       These options are independent from the main modes of operation.

       -h     Show the available options.

       -L     Show  time  of  the first and the last log entry. The input file(s) can be compressed or plain log
              file(s). Summary mode will show the time of the first and last packet log entry,  this  log  times
              mode will show the time of the first and last entry overall.

       -V     Show version and copyright information and the options used to compile fwlogwatch.

</pre><h4><b>GLOBAL</b> <b>OPTIONS</b></h4><pre>
       The global options for all modes are:

       -b     Show the amount of data in bytes this entry represents, this is the sum of total packet lengths of
              packets  matching  this  rule  (obviously  only  available  for  log  formats  that  contain  this
              information).

       -c <u>config</u>
              Use  the  alternate  configuration  file  <u>config</u>  instead  of  the  default   configuration   file
              <b>/etc/fwlogwatch/fwlogwatch.config</b>  (which  does  not need to exist). Only options not specified in
              the files can be overridden by command line options.

       -D     Do not differentiate destination IP addresses. Useful for finding scans in whole subnets.

       -d     Differentiate destination ports.

       -E <u>format</u>
              Specific hosts, ports, chains and branches (targets) can be selected or  excluded,  selections  an
              exclusions  can be added and combined. The <u>format</u> is composed of one of the functions <u>i</u> include or
              <u>e</u> exclude, then one of the parameters <u>h</u> host, <u>p</u> port, <u>c</u> chain or <u>b</u> branch. In case of  a  host  or
              port  a  third  parameter for <u>s</u> source or <u>d</u> destination is needed. Finally, the object is directly
              appended, in case of a host this is an IP address (networks can be specified in CIDR format), port
              is a number and chain and branch are strings. To show entries with destination port 25  you  would
              use  <b>-Eipd25</b> and to exclude entries which have the class C network 192.168.1.0 as source or belong
              to the chain INPUT: <b>-Eehs192.168.1.0/24</b> <b>-EecINPUT</b>

       -i <u>file</u>
              If your logs contain private IP addresses that are not resolvable through DNS but you want reports
              with meaningful host names or you have any other reason to influence the host names in reports you
              can initialize the DNS cache with your own list of IP/name pairs. The file should be in  the  same
              format as <a href="file:/etc/hosts">/etc/hosts</a> and will not be modified.

       -M <u>number</u>
              If  you  only  want  to see a fixed maximum amount of entries (e.g. the "top 20") this option will
              trim the output for you.

       -m <u>count</u>
              When analyzing large amounts of data you usually aren't interested in entries that  have  a  small
              count. You can hide entries below a certain threshold with this option.

       -N     Enable service lookups. The service name for a specific port number and protocol will be looked up
              in /etc/services.

       -n     Enable DNS lookups. Host names will be resolved (reverse and forward lookup with a warning if they
              don't  match).  If  this  makes summary generation very slow (this happens when a lot of different
              hosts appear in the log file) you should use a  version  of  fwlogwatch  compiled  with  GNU  adns
              support.   Resolved  host names are cached in memory for as long as fwlogwatch is running, the DNS
              cache can be initialized with the -i option.

       -O <u>order</u>
              This is the sort order of the summary and packet cache. Since entries often are equal  in  certain
              fields  you  can  sort by several fields one after another (the sort algorithm is stable, so equal
              entries will remain sorted in the order they were sorted before). The sort string can be  composed
              of up to 11 fields of the form <b>ab</b> where <b>a</b> is the sort criteria: <u>c</u> count, <u>t</u> start time, <u>e</u> end time,
              <u>z</u>  duration, <u>n</u> target name, <u>p</u> protocol, <u>b</u> byte count (sum of total packet lengths), <u>S</u> source host,
              <u>s</u> source port, <u>D</u> destination host and <u>d</u> destination port.  <b>b</b> is the direction: <u>a</u> ascending  and  <u>d</u>
              descending.   Sorting  is done in the order specified, so the last option is the primary criteria.
              The default in summary mode is <u>tacd</u> (start with the highest count, if two counts  match  list  the
              one  earlier  in  time  first)  of which <u>ta</u> is built in, so if you specify an empty sort string or
              everything else is equal entries will be sorted ascending by  time.  The  realtime  response  mode
              default is <u>cd</u> ( <u>ta</u> is not built in).

       -P <u>format</u>
              Only  use  certain  parsers,  where  the  log <u>format</u> can be one or a combination of: <u>i</u> ipchains, <u>n</u>
              netfilter, <u>f</u> ipfilter, <u>b</u> ipfw, <u>c</u> Cisco IOS, <u>p</u> Cisco PIX/ASA, <u>e</u> NetScreen,  <u>l</u>  Elsa  Lancom  and  <u>s</u>
              Snort.  The  default  is  to  use all parsers except the ones for NetScreen, Elsa Lancom and Snort
              logs.

       -p     Differentiate protocols. This is  activated  automatically  if  you  differentiate  source  and/or
              destination ports.

       -s     Differentiate source ports.

       -U <u>title</u>
              Set <u>title</u> as title of the report and status page.

       -v     Be verbose. You can specify it twice for more information.  In very verbose mode while parsing the
              log  file you will see "." for relevant packet filter log entries, "r" for 'last message repeated'
              entries concerning packet filter logs, "o" for packet filter log entries that are too old and  "_"
              for entries that are not packet filter logs.

       -y     Differentiate TCP options. All packets with a SYN are listed separately, other TCP flags are shown
              in full format if they are available (ipchains does not log them, netfilter and ipfilter do, Cisco
              IOS doesn't even log SYNs).

</pre><h4><b>LOG</b> <b>SUMMARY</b> <b>MODE</b></h4><pre>
       This are additional options that are only available in log summary mode:

       -C <u>email</u>
              A carbon copy of the summary will be sent by email to this address.

       -e     Show  timestamp of the last packet logged for this entry. End times are only available if there is
              more than one packet log entry with unique characteristics.

       -F <u>email</u>
              Set the sender address of the email.

       -l <u>time</u>
              Process recent events only. See <b>TIME</b> <b>FORMAT</b> below for the time options.

       -o <u>file</u>
              Specify an output file.

       -S     Do not differentiate source IP addresses.

       -T <u>email</u>
              The summary will be sent by email to this address. If HTML output is selected the report  will  be
              embedded as attachment so HTML-aware mail clients can show it directly.

       -t     Show timestamp of the first packet logged for this entry.

       -W     Look  up  information about the source addresses in the whois database. This is slow, please don't
              stress the registry with too many queries.

       -w     Produce output in HTML format (XHTML 1.1 with CSS).

       -z     Show time interval between start and end time of packet log entries. This  is  only  available  if
              there is more than one packet log entry with unique characteristics.

</pre><h4><b>REALTIME</b> <b>RESPONSE</b> <b>MODE</b></h4><pre>
       -R     Enter realtime response mode. This means: detach and run as daemon until the TERM signal (kill) is
              received.  The  HUP  signal  forces  a  reload  of  the configuration file, the USR1 signal forces
              fwlogwatch to reopen and read the input file from the beginning (useful e.g.  for  log  rotation).
              All output can be followed in the system log.

       -a <u>count</u>
              Alert threshold. Notify or start countermeasures if this limit is reached.  Defaults to 5.

       -l <u>time</u>
              Forget  events that happened this long ago (defaults to 1 day). See <b>TIME</b> <b>FORMAT</b> below for the time
              options.

       -k <u>IP/net</u>
              This option defines a host or network in CIDR notation that will never be blocked or other actions
              taken against. To specify more than one, use the -k parameter again for each IP address or network
              you want to add.

       -A     The notification script is invoked when the threshold is  reached.  A  few  examples  of  possible
              notifications are included in fwlw_notify, you can add your own ones as you see fit.

       -B     The  response  script  is  invoked  when  the  threshold  is  reached.  Using  the  example script
              fwlw_respond this will block the attacking host  with  a  new  firewall  rule.  A  new  chain  for
              fwlogwatch  actions  is inserted in the input chain and block rules added as needed. The chain and
              its content is removed if fwlogwatch is terminated normally. The example scripts  contain  actions
              for ipchains and netfilter, you can modify them or add others as you like.

       -X <u>port</u>
              Activate  the  internal  web  server  to  monitor and control the current status of the daemon. It
              listens on the specified <u>port</u> and by default only allows connections from localhost.  The  default
              user name is <b>admin</b> and the default password is <b>fwlogwat</b> (since DES can only encrypt 8 characters).
              All options related to the status web server can be changed in the configuration file.

</pre><h4><b>INPUT</b> <b>FILES</b></h4><pre>
       You  can  specify  one or more input files (if none is given it defaults to <b>/var/log/messages</b> ). Relevant
       entries are automatically detected so combined log  files  (e.g.   from  a  log  host)  are  no  problem.
       Compressed files are supported (except in realtime response mode where they don't make sense anyway). The
       '-' sign may be used for reading from standard input (stdin). In realtime response mode the file needs to
       be specified with an absolute path since the daemon uses the file system root (/) as working directory.

</pre><h4><b>TIME</b> <b>FORMAT</b></h4><pre>
       Time is specified as <b>nx</b> where <b>n</b> is a natural number and <b>x</b> is one of the following: <u>s</u> for seconds (this is
       the default), <u>m</u> for minutes, <u>h</u> for hours, <u>d</u> for days, <u>w</u> for weeks, <u>M</u> for months and <u>y</u> for years.

</pre><h4><b>FILES</b></h4><pre>
       <b>/etc/fwlogwatch/fwlogwatch.config</b>
              Default configuration file.

       <b>/var/log/messages</b>
              Default input log file.

       <b>/run/fwlogwatch.pid</b>
              Default PID file generated by the daemon in realtime response mode if configured to do so.

</pre><h4><b>FEATURES</b> <b>ONLY</b> <b>IN</b> <b>CONFIGURATION</b> <b>FILE</b></h4><pre>
       The following features are only available in the configuration file and not on the command line, they are
       presented and explained in more detail in the sample configuration file.

       HTML colors and stylesheet
              The  colors of the HTML output and status page can be customized, an external cascading stylesheet
              can be referenced.

       Realtime response options
              Verification of ipchains rules, PID file handling, the user fwlogwatch should run as, the location
              of the notification and response scripts, which address the status web server  listens  on,  which
              host  can  connect, the refresh interval of the status page and the admin name and password can be
              configured.

</pre><h4><b>SECURITY</b></h4><pre>
       Since fwlogwatch is a security tool special care was taken to make it secure. You can and should  run  it
       with  user  permissions for most functions, you can make it setgid for a group /var/log/messages is in if
       all you need is to be able to read this file. Only the realtime response  mode  with  activated  ipchains
       rule analysis needs superuser permissions but you might also need them to write the PID file, for actions
       in  the response script and for binding the default status port. However, you can configure fwlogwatch to
       drop root privileges as soon as possible after allocating these resources (the notification and  response
       scripts will still be executed with user privileges and log rotation might not work).

</pre><h4><b>AUTHOR</b></h4><pre>
       Boris Wesslowski &lt;<a href="mailto:bw@inside-security.de">bw@inside-security.de</a>&gt;

Boris Wesslowski                                November 11, 2011                                  <u><a href="../man8/FWLOGWATCH.8.html">FWLOGWATCH</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>