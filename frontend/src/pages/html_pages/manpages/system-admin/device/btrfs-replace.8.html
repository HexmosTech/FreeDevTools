<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>btrfs-replace - replace devices managed by btrfs with other device</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/btrfs-progs">btrfs-progs_6.14-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       btrfs-replace - replace devices managed by btrfs with other device

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>btrfs</b> <b>replace</b> &lt;subcommand&gt; &lt;args&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>btrfs</b> <b>replace</b> is used to replace btrfs managed devices with other device.

</pre><h4><b>SUBCOMMAND</b></h4><pre>
       <b>cancel</b> <b>&lt;mount_point&gt;</b>
              Cancel a running device replace operation.

       <b>start</b> <b>[options]</b> <b>&lt;srcdev&gt;|&lt;devid&gt;</b> <b>&lt;targetdev&gt;</b> <b>&lt;path&gt;</b>
              Replace device of a btrfs filesystem.

              On  a  live  filesystem,  duplicate the data to the target device which is currently stored on the
              source device.  If the source device is not available anymore, or if the -r  option  is  set,  the
              data  is  built only using the RAID redundancy mechanisms.  After completion of the operation, the
              source device is removed from the filesystem.  If the <u>srcdev</u> is a numerical value, it  is  assumed
              to  be  the  device id of the filesystem which is mounted at <u>path</u>, otherwise it is the path to the
              source device. If the source device is disconnected, from the system, you have to  use  the  devid
              parameter format.  The <u>targetdev</u> needs to be same size or larger than the <u>srcdev</u>.

              <b>NOTE:</b>
                 The filesystem has to be resized to fully take advantage of a larger target device; this can be
                 achieved with <b>btrfs</b> <b>filesystem</b> <b>resize</b> <b>&lt;devid&gt;:max</b> <b>/path</b>

              <b>Options</b>

              <b>-r</b>     only  read  from  <u>srcdev</u> if no other zero-defect mirror exists.  (enable this if your drive
                     has lots of read errors, the access would be very slow)

              <b>-f</b>     force using and overwriting <u>targetdev</u> even if it looks  like  it  contains  a  valid  btrfs
                     filesystem.

                     A  valid  filesystem  is  assumed  if  a btrfs superblock is found which contains a correct
                     checksum. Devices that are currently mounted are never allowed to be used as the <u>targetdev</u>.

              <b>-B</b>     no background replace.

              <b>--enqueue</b>
                     wait if there's another exclusive operation running, otherwise continue

              <b>-K|--nodiscard</b>
                     Do not perform whole device TRIM operation on devices that are capable of that.  This  does
                     not  affect  discard/trim  operation  when the filesystem is mounted.  Please see the mount
                     option <u>discard</u> for that in <u><a href="../man5/btrfs.5.html">btrfs</a>(5)</u>.

       <b>status</b> <b>[-1]</b> <b>&lt;mount_point&gt;</b>
              Print status and progress information of a running device replace operation.

              <b>Options</b>

              <b>-1</b>     print once instead of print continuously  until  the  replace  operation  finishes  (or  is
                     cancelled)

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Replacing</b> <b>an</b> <b>online</b> <b>drive</b> <b>with</b> <b>a</b> <b>bigger</b> <b>one</b>
       Given the following filesystem mounted at <b>/mnt/my-vault</b>

          Label: 'MyVault'  uuid: ae20903e-b72d-49ba-b944-901fc6d888a1
                  Total devices 2 FS bytes used 1TiB
                  devid    1 size 1TiB used 500.00GiB path /dev/sda
                  devid    2 size 1TiB used 500.00GiB path /dev/sdb

       In  order  to  replace  <b>/dev/sda</b>  (<u>devid</u>  <u>1</u>)  with  a  bigger drive located at <b>/dev/sdc</b> you would run the
       following:

          btrfs replace start 1 /dev/sdc /mnt/my-vault/

       You can monitor progress via:

          btrfs replace status /mnt/my-vault/

       After the replacement is complete, as per the docs at <u><a href="../man8/btrfs-filesystem.8.html">btrfs-filesystem</a>(8)</u> in  order  to  use  the  entire
       storage space of the new drive you need to run:

          btrfs filesystem resize 1:max /mnt/my-vault/

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <b>btrfs</b> <b>replace</b> returns a zero exit status if it succeeds. Non zero is returned in case of failure.

</pre><h4><b>AVAILABILITY</b></h4><pre>
       <b>btrfs</b> is part of btrfs-progs.  Please refer to the documentation at <u>https://btrfs.readthedocs.io</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/btrfs-device.8.html">btrfs-device</a>(8)</u>, <u><a href="../man8/btrfs-filesystem.8.html">btrfs-filesystem</a>(8)</u>, <u><a href="../man8/mkfs.btrfs.8.html">mkfs.btrfs</a>(8)</u>

6.14                                              Apr 17, 2025                                  <u><a href="../man8/BTRFS-REPLACE.8.html">BTRFS-REPLACE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>