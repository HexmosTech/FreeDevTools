<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>zpool-attach — attach new device to existing ZFS vdev</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/zfsutils-linux">zfsutils-linux_2.3.2-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       zpool-attach — attach new device to existing ZFS vdev

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>zpool</b> <b>attach</b> [<b>-fsw</b>] [<b>-o</b> <u>property</u>=<u>value</u>] <u>pool</u> <u>device</u> <u>new_device</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Attaches  <u>new_device</u> to the existing <u>device</u>.  The behavior differs depending on if the existing <u>device</u> is
       a RAID-Z device, or a mirror/plain device.

       If the existing device is a mirror or plain device (e.g. specified  as  "<b>sda</b>"  or  "<b>mirror-7</b>"),  the  new
       device  will  be mirrored with the existing device, a resilver will be initiated, and the new device will
       contribute to additional redundancy once the resilver completes.  If <u>device</u> is not currently  part  of  a
       mirrored  configuration,  <u>device</u> automatically transforms into a two-way mirror of <u>device</u> and <u>new_device</u>.
       If <u>device</u> is part of a two-way mirror, attaching <u>new_device</u> creates a three-way mirror, and  so  on.   In
       either case, <u>new_device</u> begins to resilver immediately and any running scrub is canceled.

       If the existing device is a RAID-Z device (e.g. specified as "<u>raidz2-0</u>"), the new device will become part
       of  that  RAID-Z group.  A "raidz expansion" will be initiated, and once the expansion completes, the new
       device will contribute additional space to the RAID-Z group.  The expansion entails reading all allocated
       space from existing disks in the RAID-Z group, and rewriting it to the new  disks  in  the  RAID-Z  group
       (including the newly added <u>device</u>).  Its progress can be monitored with <b>zpool</b> <b>status</b>.

       Data  redundancy is maintained during and after the expansion.  If a disk fails while the expansion is in
       progress, the expansion pauses until the health of the RAID-Z vdev is restored  (e.g.  by  replacing  the
       failed  disk  and  waiting  for  reconstruction  to  complete).   Expansion does not change the number of
       failures that can be tolerated without  data  loss  (e.g.  a  RAID-Z2  is  still  a  RAID-Z2  even  after
       expansion).  A RAID-Z vdev can be expanded multiple times.

       After  the expansion completes, old blocks retain their old data-to-parity ratio (e.g. 5-wide RAID-Z2 has
       3 data and 2 parity) but distributed among the larger set of disks.  New blocks will be written with  the
       new  data-to-parity ratio (e.g. a 5-wide RAID-Z2 which has been expanded once to 6-wide, has 4 data and 2
       parity).  However, the vdev's assumed parity ratio does not  change,  so  slightly  less  space  than  is
       expected may be reported for newly-written blocks, according to <b>zfs</b> <b>list</b>, <b>df</b>, <b>ls</b> <b>-s</b>, and similar tools.

       A pool-wide scrub is initiated at the end of the expansion in order to verify the checksums of all blocks
       which have been copied during the expansion.

       <b>-f</b>      Forces  use of <u>new_device</u>, even if it appears to be in use.  Not all devices can be overridden in
               this manner.

       <b>-o</b> <u>property</u>=<u>value</u>
               Sets the given pool properties.  See the <u><a href="../man7/zpoolprops.7.html">zpoolprops</a></u>(7) manual page for a list of valid properties
               that can be set.  The only property supported at the moment is <b>ashift</b>.

       <b>-s</b>      When attaching to a mirror or plain device,  the  <u>new_device</u>  is  reconstructed  sequentially  to
               restore  redundancy  as  quickly  as  possible.   Checksums  are  not  verified during sequential
               reconstruction so a scrub is started when the resilver completes.

       <b>-w</b>      Waits until <u>new_device</u> has finished resilvering or expanding before returning.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/zpool-add.8.html">zpool-add</a></u>(8), <u><a href="../man8/zpool-detach.8.html">zpool-detach</a></u>(8), <u><a href="../man8/zpool-import.8.html">zpool-import</a></u>(8), <u><a href="../man8/zpool-initialize.8.html">zpool-initialize</a></u>(8),  <u><a href="../man8/zpool-online.8.html">zpool-online</a></u>(8),  <u><a href="../man8/zpool-replace.8.html">zpool-replace</a></u>(8),
       <u><a href="../man8/zpool-resilver.8.html">zpool-resilver</a></u>(8)

OpenZFS                                           June 28, 2023                                  <u><a href="../man8/ZPOOL-ATTACH.8.html">ZPOOL-ATTACH</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>