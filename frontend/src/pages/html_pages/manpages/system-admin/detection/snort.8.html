<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snort - open source network intrusion detection system</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/snort">snort_2.9.15.1-6build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Snort - open source network intrusion detection system

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>snort</b>  <b>[-bCdDeEfHIMNOpqQsTUvVwWxXy?]</b>  <b>[-A</b> <u>alert-mode</u> <b>]</b> <b>[-B</b> <u>address-conversion-mask</u> <b>]</b> <b>[-c</b> <u>rules-file</u> <b>]</b> <b>[-F</b>
       <u>bpf-file</u> <b>]</b> <b>[-g</b> <u>group-name</u> <b>]</b> <b>[-G</b> <u>id</u> <b>]</b> <b>[-h</b> <u>home-net</u> <b>]</b> <b>[-i</b> <u>interface</u> <b>]</b> <b>[-k</b> <u>checksum-mode</u> <b>]</b> <b>[-K</b>  <u>logging-mode</u>
       <b>]</b>  <b>[-l</b>  <u>log-dir</u>  <b>]</b> <b>[-L</b> <u>bin-log-file</u> <b>]</b> <b>[-m</b> <u>umask</u> <b>]</b> <b>[-n</b> <u>packet-count</u> <b>]</b> <b>[-P</b> <u>snap-length</u> <b>]</b> <b>[-r</b> <u>tcpdump-file</u> <b>]</b>
       <b>[-R</b> <u>name</u> <b>]</b> <b>[-S</b> <u>variable=value</u> <b>]</b> <b>[-t</b> <u>chroot_directory</u> <b>]</b> <b>[-u</b> <u>user-name</u> <b>]</b>  <b>[-Z</b>  <u>pathname</u>  <b>]</b>  <b>[--logid</b>  <u>id</u>  <b>]</b>
       <b>[--perfmon-file</b>  <u>pathname</u>  <b>]</b>  <b>[--pid-path</b>  <u>pathname</u>  <b>]</b>  <b>[--snaplen</b>  <u>snap-length</u>  <b>]</b> <b>[--help</b> <b>]</b> <b>[--version</b> <b>]</b>
       <b>[--dynamic-engine-lib</b> <u>file</u>  <b>]</b>  <b>[--dynamic-engine-lib-dir</b>  <u>directory</u>  <b>]</b>  <b>[--dynamic-detection-lib</b>  <u>file</u>  <b>]</b>
       <b>[--dynamic-detection-lib-dir</b>  <u>directory</u>  <b>]</b>  <b>[--dump-dynamic-rules</b> <u>directory</u> <b>]</b> <b>[--dynamic-preprocessor-lib</b>
       <u>file</u> <b>]</b> <b>[--dynamic-preprocessor-lib-dir</b> <u>directory</u> <b>]</b> <b>[--dynamic-output-lib</b> <u>file</u> <b>]</b> <b>[--dynamic-output-lib-dir</b>
       <u>directory</u> <b>]</b> <b>[--alert-before-pass</b> <b>]</b> <b>[--treat-drop-as-alert</b>  <b>]</b>  <b>[--treat-drop-as-ignore</b>  <b>]</b>  <b>[--process-all-</b>
       <b>events</b>  <b>]</b>  <b>[--enable-inline-test</b>  <b>]</b>  <b>[--create-pidfile</b>  <b>]</b>  <b>[--nolock-pidfile</b>  <b>]</b> <b>[--no-interface-pidfile</b> <b>]</b>
       <b>[--disable-attribute-reload-thread</b> <b>]</b> <b>[--pcap-single=</b> <u>tcpdump-file</u> <b>]</b>  <b>[--pcap-filter=</b>  <u>filter</u>  <b>]</b>  <b>[--pcap-</b>
       <b>list=</b>  <u>list</u>  <b>]</b> <b>[--pcap-dir=</b> <u>directory</u> <b>]</b> <b>[--pcap-file=</b> <u>file</u> <b>]</b> <b>[--pcap-no-filter</b> <b>]</b> <b>[--pcap-reset</b> <b>]</b> <b>[--pcap-</b>
       <b>reload</b> <b>]</b> <b>[--pcap-show</b> <b>]</b> <b>[--exit-check</b> <u>count</u> <b>]</b> <b>[--conf-error-out</b> <b>]</b> <b>[--enable-mpls-multicast</b>  <b>]</b>  <b>[--enable-</b>
       <b>mpls-overlapping-ip</b>  <b>]</b>  <b>[--max-mpls-labelchain-len</b>  <b>]</b> <b>[--mpls-payload-type</b> <b>]</b> <b>[--require-rule-sid</b> <b>]</b> <b>[--daq</b>
       <u>type</u> <b>]</b> <b>[--daq-mode</b> <u>mode</u> <b>]</b> <b>[--daq-var</b> <u>name=value</u> <b>]</b> <b>[--daq-dir</b> <u>dir</u> <b>]</b> <b>[--daq-list</b>  <u>[dir]</u>  <b>]</b>  <b>[--dirty-pig</b>  <b>]</b>
       <b>[--cs-dir</b> <u>dir</u> <b>]</b> <b>[--ha-peer</b> <b>]</b> <b>[--ha-out</b> <u>file</u> <b>]</b> <b>[--ha-in</b> <u>file</u> <b>]</b> <u>expression</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Snort</b>  is  an  open  source  network  intrusion detection system, capable of performing real-time traffic
       analysis and packet logging on IP networks.  It can perform protocol analysis, content searching/matching
       and can be used to detect a variety of attacks and probes, such as buffer overflows, stealth port  scans,
       CGI attacks, SMB probes, OS fingerprinting attempts, and much more.  Snort uses a flexible rules language
       to describe traffic that it should collect or pass, as well as a detection engine that utilizes a modular
       plugin  architecture.  Snort also has a modular real-time alerting capability, incorporating alerting and
       logging plugins for syslog, a ASCII text files, UNIX sockets or XML.

       Snort has three primary uses.  It can be used as a straight packet  sniffer  like  <b><a href="../man1/tcpdump.1.html">tcpdump</a></b>(1),  a  packet
       logger  (useful  for  network  traffic  debugging,  etc),  or as a full blown network intrusion detection
       system.

       Snort logs packets in <b><a href="../man1/tcpdump.1.html">tcpdump</a></b>(1) binary format or in Snort's decoded  ASCII  format  to  a  hierarchy  of
       logging directories that are named based on the IP address of the "foreign" host.

</pre><h4><b>OPTIONS</b></h4><pre>
       -A alert-mode
              Alert  using  the  specified  <u>alert-mode.</u>  Valid alert modes include <b>fast,</b> <b>full,</b> <b>none,</b> and <b>unsock.</b>
              <b>Fast</b> writes alerts to the default "alert" file in a single-line, syslog style alert message.  <b>Full</b>
              writes the alert to the "alert" file with the full decoded header as well as  the  alert  message.
              <b>None</b> turns off alerting.  <b>Unsock</b> is an experimental mode that sends the alert information out over
              a UNIX socket to another process that attaches to that socket.

       -b     Log  packets in a <b><a href="../man1/tcpdump.1.html">tcpdump</a></b>(1) formatted file.   All packets are logged in their native binary state
              to a tcpdump formatted log file named with the snort start timestamp and "snort.log".  This option
              results in much faster operation of the program
               since it doesn't have to spend time in the packet binary-&gt;text converters.   Snort  can  keep  up
              pretty  well  with  100Mbps networks in '-b' mode.  To choose an alternate name for the binary log
              file, use the '-L' switch.

       -B address-conversion-mask
              Convert all IP addresses in <u>home-net</u> to addresses specified by <u>address-conversion-mask.</u>   Used  to
              obfuscate  IP  addresses  within binary logs. Specify <u>home-net</u> with the '-h' switch.  Note this is
              <b>not</b> the same as $HOME_NET.

       -c config-file
              Use the rules located in file <u>config-file.</u>

       -C     Print the character data from the packet payload only (no hex).

       -d     Dump the application layer data when displaying packets in verbose or packet logging mode.

       -D     Run Snort in daemon mode.  Alerts are sent to /var/log/snort/alert unless otherwise specified.

       -e     Display/log the link layer packet headers.

       -E     <b>*WIN32</b> <b>ONLY*</b> Log alerts to the Windows Event Log.

       -f     Activate PCAP line buffering

       -F bpf-file
              Read BPF filters from <u>bpf-file.</u>  This is handy for people running Snort as a SHADOW replacement or
              with a love Of super complex BPF filters.  See the "expressions" section of this man page for more
              info on writing BPF filters.

       -g group
              Change the group/GID Snort runs under to <u>group</u> after initialization.  This switch allows Snort  to
              drop root privileges after it's initialization phase has completed as a security measure.

       -G id  Use id as a base event ID when logging events.

       -h home-net
              Set  the "home network" to <u>home-net.</u>  The format of this address variable is a network prefix plus
              a CIDR block, such as 192.168.1.0/24.  Once this variable is set, all decoded packet logging  will
              be  done relative to the home network address space.  This is useful because of the way that Snort
              formats its ASCII log data.  With this value set to the local network, all decoded output will  be
              logged  into  decode  directories  with the address of the foreign computer as the directory name,
              which is very useful during traffic analysis. This option does not change "$HOME_NET" in IDS mode.

       -H     Force hash tables to be deterministic instead of using a random number generator for  the  seed  &amp;
              scale.  Useful for testing and generating repeatable results with the same traffic.

       -i interface
              Sniff packets on <u>interface.</u>

       -I     Print out the receiving interface name in alerts.

       -k checksum-mode
              Tune  the  internal  checksum  verification  functionality  with <u>alert-mode.</u>  Valid checksum modes
              include <b>all,</b> <b>noip,</b> <b>notcp,</b> <b>noudp,</b> <b>noicmp,</b> and <b>none.</b>  <b>All</b> activates checksum  verification  for  all
              supported  protocols.   <b>Noip</b>  turns  off  IP  checksum verification, which is handy if the gateway
              router is already dropping packets that fail their  IP  checksum  checks.   <b>Notcp</b>  turns  off  TCP
              checksum   verification,  all  other  checksum  modes  are  <b>on.</b>   <b>noudp</b>  turns  off  UDP  checksum
              verification.  <b>Noicmp</b> turns off ICMP checksum verification.  <b>None</b> turns off  the  entire  checksum
              verification subsystem.

       -K logging-mode
              Select  a  packet  logging mode.  The default is pcap.  <u>logging-mode.</u>  Valid logging modes include
              <b>pcap,</b> <b>ascii,</b> and <b>none.</b>  <b>Pcap</b> logs packets through the pcap library  into  pcap  (tcpdump)  format.
              <b>Ascii</b>  logs  packets in the old "directories and files" format with packet printouts in each file.
              <b>None</b> Turns off packet logging.

       -l log-dir
              Set the output logging directory to <u>log-dir.</u>  All plain text alerts and packet logs go  into  this
              directory.    If  this  option  is  not  specified,  the  default  logging  directory  is  set  to
              /var/log/snort.

       -L binary-log-file
              Set the filename of the binary log file to <u>binary-log-file.</u>  If  this  switch  is  not  used,  the
              default name is a timestamp for the time that the file is created plus "snort.log".

       -m umask
              Set the file mode creation mask to <u>umask</u>

       -M     Log  console  messages  to syslog when not running daemon mode. Using both -D and -M will send all
              messages to syslog including e.g. SIGUSR1 dump packet stats. This switch has no impact on  logging
              of alerts.

       -n packet-count
              Process <u>packet-count</u> packets and exit.

       -N     Turn off packet logging.  The program still generates alerts normally.

       -O     Obfuscate  the  IP addresses when in ASCII packet dump mode.  This switch changes the IP addresses
              that get printed to the screen/log file to "xxx.xxx.xxx.xxx".  If the homenet  address  switch  is
              set  (-h),  only  addresses  on the homenet will be obfuscated while non- homenet IPs will be left
              visible.  Perfect for posting to your favorite security mailing list!

       -p     Turn off promiscuous mode sniffing.

       -P snap-length
              Set the packet snaplen to <u>snap-length.</u>  By default, this is set to 1514.

       -q     Quiet operation. Don't display banner and initialization information. In daemon mode,  banner  and
              initialization information is not logged to syslog.

       -Q     Enable inline mode operation.

       -r tcpdump-file
              Read  the tcpdump-formatted file <u>tcpdump-file.</u>  This will cause Snort to read and process the file
              fed to it.  This is useful if, for instance, you've got a bunch of SHADOW files that you  want  to
              process for content, or even if you've got a bunch of reassembled packet fragments which have been
              written into a tcpdump formatted file.

       -R name
              Use name as a suffix to the snort pidfile.

       -s     Send   alert   messages  to  syslog.   On  linux  boxen,  they  will  appear  in  /var/log/secure,
              /var/log/messages on many other platforms.

       -S variable=value
              Set variable name "variable" to value "value".  This is useful for setting the value of a  defined
              variable  name  in  a  Snort  rules  file to a command line specified value.  For instance, if you
              define a HOME_NET variable name inside of a Snort rules file, you can set  this  value  from  it's
              predefined value at the command line.

       -t chroot
              Changes  Snort's  root  directory  to <u>chroot</u> after initialization.  Please note that all log/alert
              filenames are relative to the chroot directory if chroot is used.

       -T     Snort will start up in self-test mode, checking all the supplied command line switches  and  rules
              files  that  are  handed to it and indicating that everything is ready to proceed.  This is a good
              switch to use if daemon mode is going to be used, it verifies that the Snort configuration that is
              about to be used is valid and won't fail at run time. Note, Snort looks for either /etc/snort.conf
              or ./snort.conf.  If your config lives elsewhere, use the -c option to  specify  a  valid  <u>config-</u>
              <u>file.</u>

       -u user
              Change the user/UID Snort runs under to <u>user</u> after initialization.

       -U     Changes the timestamp in all logs to be in UTC

       -v     Be  verbose.  Prints packets out to the console.  There is one big problem with verbose mode: it's
              slow.  If you are doing IDS work with Snort, <b>don't</b> use the '-v' switch, you <b>WILL</b> drop packets.

       -V     Show the version number and exit.

       -w     Show management frames if running on an 802.11 (wireless) network.

       -W     <b>*WIN32</b> <b>ONLY*</b> Enumerate the network interfaces available.

       -x     Exit if Snort configuration problems occur such as duplicate gid/sid or flowbits without Stream5.

       -X     Dump the raw packet data starting at the link layer.  This switch overrides the '-d' switch.

       -y     Include the year in alert and log files

       -Z pathname
              Set the perfmonitor preprocessor path/filename to pathname.

       -?     Show the program usage statement and exit.

       --logid id
              Same as -G.

       --perfmon-file pathname
              Same as -Z.

       --pid-path directory
              Specify the directory for the Snort PID file.

       --snaplen snap-length
              Same as -P.

       --help Same as -?

       --version
              Same as -V

       --dynamic-engine-lib file
              Load a dynamic detection engine shared library specified by file.

       --dynamic-engine-lib-dir directory
              Load all dynamic detection engine shared libraries specified from directory.

       --dynamic-detection-lib file
              Load a dynamic detection rules shared library specified by file.

       --dynamic-detection-lib-dir directory
              Load all dynamic detection rules shared libraries specified from directory.

       --dump-dynamic-rules directory
              Create stub rule files from all loaded dynamic detection rules libraries.  Files will  be  created
              in  directory.  This is required to be done prior to running snort using those detection rules and
              the generated rules files must be included in snort.conf.

       --dynamic-preprocessor-lib file
              Load a dynamic preprocessor shared library specified by file.

       --dynamic-preprocessor-lib-dir directory
              Load all dynamic preprocessor shared libraries specified from directory.

       --alert-before-pass
              Process alert, drop, sdrop, or reject before pass.  Default is pass before alert, drop, etc.

       --treat-drop-as-alert
              Converts drop, sdrop, and reject rules into alert rules during startup.

       --treat-drop-as-ignore
              Use drop, sdrop, and reject rules to ignore session traffic when not inline.

       --process-all-events
              Process all triggered events in group order, per Rule Ordering configuration.  Default stops after
              first group.

       --enable-inline-test
              Enable Inline-Test Mode Operation.

       --pid-path directory
              Specify the path for Snort's PID file.

       --create-pidfile
              Create PID file, even when not in Daemon mode.

       --nolock-pidfile
              Do not try to lock Snort PID file.

       --no-interface-pidfile
              Do not include the interface name in Snort PID file

       --pcap-single=<u>tcpdump-file</u>
              Same as -r.  Added for completeness.

       --pcap-filter=<u>filter</u>
              Shell style filter to apply when getting pcaps from file or directory.  This filter will apply  to
              any  --pcap-file  or  --pcap-dir  arguments  following.  Use --pcap-no-filter to delete filter for
              following --pcap-file or --pcap-dir arguments or specify --pcap-filter again  to  forget  previous
              filter and to apply to following --pcap-file or --pcap-dir arguments.

       --pcap-list=<u>"list"</u>
              A space separated list of pcaps to read.

       --pcap-dir=<u>directory</u>
              A directory to recurse to look for pcaps.  Sorted in ascii order.

       --pcap-file=<u>file</u>
              File  that  contains a list of pcaps to read.  Can specify path to pcap or directory to recurse to
              get pcaps.

       --pcap-no-filter
              Reset to use no filter when getting pcaps from file or directory.

       --pcap-reset
              If reading multiple pcaps, reset snort to post-configuration state before reading next pcap.   The
              default, i.e. without this option, is not to reset state.

       --pcap-show
              Print a line saying what pcap is currently being read.

       --exit-check=<u>count</u>
              Signal  termination  after  &lt;count&gt;  callbacks  from DAQ_Acquire(), showing the time it takes from
              signaling until DAQ_Stop() is called.

       --conf-error-out
              Same as -x.

       --require-rule-sid
              Require an SID for every rule to be correctly threshold all rules.

       --daq &lt;type&gt;
              Select packet acquisition module (default is pcap).

       --daq-mode &lt;mode&gt;
              Select the DAQ operating mode.

       --daq-var &lt;name=value&gt;
              Specify extra DAQ configuration variable.

       --daq-dir &lt;dir&gt;
              Tell Snort where to find desired DAQ.

       --daq-list [&lt;dir&gt;]
              List packet acquisition modules available in dir.

       --cs-dir &lt;dir&gt;
              Tell Snort to use control socket and create the socket in dir.

        <u>expression</u>
              selects which packets will be dumped.  If no <u>expression</u> is given, all packets on the net  will  be
              dumped.  Otherwise, only packets for which <u>expression</u> is `true' will be dumped.

              The  <u>expression</u>  consists of one or more <u>primitives.</u>  Primitives usually consist of an <u>id</u> (name or
              number) preceded by one or more qualifiers.  There are three different kinds of qualifier:

              <u>type</u>   qualifiers say what kind of thing the id name or number  refers  to.   Possible  types  are
                     <b>host</b>,  <b>net</b>  and  <b>port</b>.   E.g.,  `host  foo',  `net  128.3', `port 20'.  If there is no type
                     qualifier, <b>host</b> is assumed.

              <u>dir</u>    qualifiers specify a particular transfer direction to and/or from <u>id.</u>  Possible  directions
                     are  <b>src</b>,  <b>dst</b>,  <b>src</b> <b>or</b> <b>dst</b> and <b>src</b> <b>and</b> <b>dst</b>.  E.g., `src foo', `dst net 128.3', `src or dst
                     port ftp-data'.  If there is no dir qualifier, <b>src</b> <b>or</b> <b>dst</b>  is  assumed.   For  `null'  link
                     layers (i.e. point to point protocols such as slip) the <b>inbound</b> and <b>outbound</b> qualifiers can
                     be used to specify a desired direction.

              <u>proto</u>  qualifiers  restrict the match to a particular protocol.  Possible protos are: <b>ether</b>, <b>fddi</b>,
                     <b>ip</b>, <b>arp</b>, <b>rarp</b>, <b>decnet</b>, <b>lat</b>, <b>sca</b>, <b>moprc</b>, <b>mopdl</b>, <b>tcp</b> and <b>udp</b>.  E.g., `ether  src  foo',  `arp
                     net  128.3',  `tcp port 21'.  If there is no proto qualifier, all protocols consistent with
                     the type are assumed.  E.g., `src foo' means `(ip or arp or  rarp)  src  foo'  (except  the
                     latter  is  not  legal syntax), `net bar' means `(ip or arp or rarp) net bar' and `port 53'
                     means `(tcp or udp) port 53'.

              [`fddi' is actually an alias for `ether'; the parser treats them identically as meaning ``the data
              link level used on the specified network interface.''  FDDI headers contain  Ethernet-like  source
              and  destination  addresses,  and  often  contain Ethernet-like packet types, so you can filter on
              these FDDI fields just as with the analogous Ethernet fields.  FDDI  headers  also  contain  other
              fields, but you cannot name them explicitly in a filter expression.]

              In  addition  to  the  above,  there  are  some special `primitive' keywords that don't follow the
              pattern: <b>gateway</b>, <b>broadcast</b>, <b>less</b>, <b>greater</b> and arithmetic expressions.  All of these are described
              below.

              More complex filter expressions are built up by using  the  words  <b>and</b>,  <b>or</b>  and  <b>not</b>  to  combine
              primitives.   E.g.,  `host foo and not port ftp and not port ftp-data'.  To save typing, identical
              qualifier lists can be omitted.  E.g., `tcp dst port ftp or ftp-data or  domain'  is  exactly  the
              same as `tcp dst port ftp or tcp dst port ftp-data or tcp dst port domain'.

              Allowable primitives are:

              <b>dst</b> <b>host</b> <u>host</u>
                     True if the IP destination field of the packet is <u>host</u>, which may be either an address or a
                     name.

              <b>src</b> <b>host</b> <u>host</u>
                     True if the IP source field of the packet is <u>host</u>.

              <b>host</b> <u>host</u>
                     True  if  either the IP source or destination of the packet is <u>host</u>.  Any of the above host
                     expressions can be prepended with the keywords, <b>ip</b>, <b>arp</b>, or <b>rarp</b> as in:
                          <b>ip</b> <b>host</b> <u>host</u>
                     which is equivalent to:
                          <b>ether</b> <b>proto</b> <u>\ip</u> <b>and</b> <b>host</b> <u>host</u>
                     If <u>host</u> is a name with multiple IP addresses, each address will be checked for a match.

              <b>ether</b> <b>dst</b> <u>ehost</u>
                     True if the ethernet destination address is  <u>ehost</u>.   <u>Ehost</u>  may  be  either  a  name  from
                     /etc/ethers or a number (see <u><a href="../man3N/ethers.3N.html">ethers</a></u>(3N) for numeric format).

              <b>ether</b> <b>src</b> <u>ehost</u>
                     True if the ethernet source address is <u>ehost</u>.

              <b>ether</b> <b>host</b> <u>ehost</u>
                     True if either the ethernet source or destination address is <u>ehost</u>.

              <b>gateway</b> <u>host</u>
                     True  if  the  packet  used  <u>host</u>  as  a gateway.  I.e., the ethernet source or destination
                     address was <u>host</u> but neither the IP source nor the IP destination was <u>host</u>.  <u>Host</u> must be a
                     name and must be found in both <a href="file:/etc/hosts">/etc/hosts</a> and /etc/ethers.  (An equivalent expression is
                          <b>ether</b> <b>host</b> <u>ehost</u> <b>and</b> <b>not</b> <b>host</b> <u>host</u>
                     which can be used with either names or numbers for <u>host</u> <u>/</u> <u>ehost</u>.)

              <b>dst</b> <b>net</b> <u>net</u>
                     True if the IP destination address of the packet has a network number of <u>net</u>.  <u>Net</u>  may  be
                     either a name from <a href="file:/etc/networks">/etc/networks</a> or a network number (see <u><a href="../man4/networks.4.html">networks</a>(4)</u> for details).

              <b>src</b> <b>net</b> <u>net</u>
                     True if the IP source address of the packet has a network number of <u>net</u>.

              <b>net</b> <u>net</u>
                     True  if  either the IP source or destination address of the packet has a network number of
                     <u>net</u>.

              <b>net</b> <u>net</u> <b>mask</b> <u>mask</u>
                     True if the IP address matches <u>net</u> with the specific netmask.  May be qualified with <b>src</b> or
                     <b>dst</b>.

              <b>net</b> <u>net</u>/<u>len</u>
                     True if the IP address matches <u>net</u> a netmask <u>len</u> bits wide.  May be qualified with  <b>src</b>  or
                     <b>dst</b>.

              <b>dst</b> <b>port</b> <u>port</u>
                     True  if the packet is ip/tcp or ip/udp and has a destination port value of <u>port</u>.  The <u>port</u>
                     can be a number or a name used in <a href="file:/etc/services">/etc/services</a> (see <u><a href="../man4P/tcp.4P.html">tcp</a></u>(4P) and <u><a href="../man4P/udp.4P.html">udp</a></u>(4P)).  If  a  name  is
                     used,  both  the  port  number  and protocol are checked.  If a number or ambiguous name is
                     used, only the port number is checked (e.g., <b>dst</b> <b>port</b> <b>513</b> will print both tcp/login traffic
                     and udp/who traffic, and <b>port</b> <b>domain</b> will print both tcp/domain and udp/domain traffic).

              <b>src</b> <b>port</b> <u>port</u>
                     True if the packet has a source port value of <u>port</u>.

              <b>port</b> <u>port</u>
                     True if either the source or destination port of the packet is <u>port</u>.  Any of the above port
                     expressions can be prepended with the keywords, <b>tcp</b> or <b>udp</b>, as in:
                          <b>tcp</b> <b>src</b> <b>port</b> <u>port</u>
                     which matches only tcp packets whose source port is <u>port</u>.

              <b>less</b> <u>length</u>
                     True if the packet has a length less than or equal to <u>length</u>.  This is equivalent to:
                          <b>len</b> <b>&lt;=</b> <u>length</u><b>.</b>

              <b>greater</b> <u>length</u>
                     True if the packet has a length greater than or equal to <u>length</u>.  This is equivalent to:
                          <b>len</b> <b>&gt;=</b> <u>length</u><b>.</b>

              <b>ip</b> <b>proto</b> <u>protocol</u>
                     True if the packet is an ip packet (see <u><a href="../man4P/ip.4P.html">ip</a></u>(4P)) of protocol type <u>protocol</u>.  <u>Protocol</u> can be
                     a number or one of the names <u>icmp</u>, <u>igrp</u>, <u>udp</u>, <u>nd</u>, or <u>tcp</u>.  Note that the  identifiers  <u>tcp</u>,
                     <u>udp</u>,  and  <u>icmp</u> are also keywords and must be escaped via backslash (\), which is \\ in the
                     C-shell.

              <b>ether</b> <b>broadcast</b>
                     True if the packet is an ethernet broadcast packet.  The <u>ether</u> keyword is optional.

              <b>ip</b> <b>broadcast</b>
                     True if the packet is an IP broadcast packet.  It checks for both the all-zeroes  and  all-
                     ones broadcast conventions, and looks up the local subnet mask.

              <b>ether</b> <b>multicast</b>
                     True  if  the packet is an ethernet multicast packet.  The <u>ether</u> keyword is optional.  This
                     is shorthand for `<b>ether[0]</b> <b>&amp;</b> <b>1</b> <b>!=</b> <b>0</b>'.

              <b>ip</b> <b>multicast</b>
                     True if the packet is an IP multicast packet.

              <b>ether</b> <b>proto</b> <u>protocol</u>
                     True if the packet is of ether type <u>protocol</u>.  <u>Protocol</u> can be a number or a name like  <u>ip</u>,
                     <u>arp</u>,  or  <u>rarp</u>.  Note these identifiers are also keywords and must be escaped via backslash
                     (\).  [In the case of FDDI (e.g., `<b>fddi</b> <b>protocol</b> <b>arp</b>'), the protocol  identification  comes
                     from  the  802.2  Logical Link Control (LLC) header, which is usually layered on top of the
                     FDDI header.  <u>Tcpdump</u> assumes, when filtering on the protocol  identifier,  that  all  FDDI
                     packets include an LLC header, and that the LLC header is in so-called SNAP format.]

              <b>decnet</b> <b>src</b> <u>host</u>
                     True  if the DECNET source address is <u>host</u>, which may be an address of the form ``10.123'',
                     or a DECNET host name.  [DECNET host name support is only available on Ultrix systems  that
                     are configured to run DECNET.]

              <b>decnet</b> <b>dst</b> <u>host</u>
                     True if the DECNET destination address is <u>host</u>.

              <b>decnet</b> <b>host</b> <u>host</u>
                     True if either the DECNET source or destination address is <u>host</u>.

              <b>ip</b>, <b>arp</b>, <b>rarp</b>, <b>decnet</b>
                     Abbreviations for:
                          <b>ether</b> <b>proto</b> <u>p</u>
                     where <u>p</u> is one of the above protocols.

              <b>lat</b>, <b>moprc</b>, <b>mopdl</b>
                     Abbreviations for:
                          <b>ether</b> <b>proto</b> <u>p</u>
                     where  <u>p</u>  is  one  of  the above protocols.  Note that <u>Snort</u> does not currently know how to
                     parse these protocols.

              <b>tcp</b>, <b>udp</b>, <b>icmp</b>
                     Abbreviations for:
                          <b>ip</b> <b>proto</b> <u>p</u>
                     where <u>p</u> is one of the above protocols.

              <u>expr</u> <u>relop</u> <u>expr</u>
                     True if the relation holds, where <u>relop</u> is one of &gt;, &lt;, &gt;=, &lt;=,  =,  !=,  and  <u>expr</u>  is  an
                     arithmetic  expression  composed of integer constants (expressed in standard C syntax), the
                     normal binary operators [+, -, *, /, &amp;, |], a length  operator,  and  special  packet  data
                     accessors.  To access data inside the packet, use the following syntax:
                          <u>proto</u> <b>[</b> <u>expr</u> <b>:</b> <u>size</u> <b>]</b>
                     <u>Proto</u>  is  one of <b>ether,</b> <b>fddi,</b> <b>ip,</b> <b>arp,</b> <b>rarp,</b> <b>tcp,</b> <b>udp,</b> or <b>icmp</b>, and indicates the protocol
                     layer for the index operation.  The byte offset, relative to the indicated protocol  layer,
                     is  given  by  <u>expr</u>.   <u>Size</u>  is  optional and indicates the number of bytes in the field of
                     interest; it can be either one, two, or four, and defaults to one.   The  length  operator,
                     indicated by the keyword <b>len</b>, gives the length of the packet.

                     For  example,  `<b>ether[0]</b>  <b>&amp;</b> <b>1</b> <b>!=</b> <b>0</b>' catches all multicast traffic.  The expression `<b>ip[0]</b> <b>&amp;</b>
                     <b>0xf</b> <b>!=</b> <b>5</b>' catches all IP packets with options.  The  expression  `<b>ip[6:2]</b>  <b>&amp;</b>  <b>0x1fff</b>  <b>=</b>  <b>0</b>'
                     catches  only  unfragmented datagrams and frag zero of fragmented datagrams.  This check is
                     implicitly applied to the <b>tcp</b> and <b>udp</b> index operations.  For instance, <b>tcp[0]</b> always  means
                     the  first  byte  of  the  TCP  <u>header</u>,  and  never  means the first byte of an intervening
                     fragment.

              Primitives may be combined using:

                     A parenthesized group of primitives and operators (parentheses are special to the Shell and
                     must be escaped).

                     Negation (`<b>!</b>' or `<b>not</b>').

                     Concatenation (`<b>&amp;&amp;</b>' or `<b>and</b>').

                     Alternation (`<b>||</b>' or `<b>or</b>').

              Negation has  highest  precedence.   Alternation  and  concatenation  have  equal  precedence  and
              associate  left  to right.  Note that explicit <b>and</b> tokens, not juxtaposition, are now required for
              concatenation.

              If an identifier is given without a keyword, the most recent keyword is assumed.  For example,
                   <b>not</b> <b>host</b> <b>vs</b> <b>and</b> <b>ace</b>
              is short for
                   <b>not</b> <b>host</b> <b>vs</b> <b>and</b> <b>host</b> <b>ace</b>
              which should not be confused with
                   <b>not</b> <b>(</b> <b>host</b> <b>vs</b> <b>or</b> <b>ace</b> <b>)</b>

              Expression arguments can be passed to Snort as either a single argument or as multiple  arguments,
              whichever  is  more convenient.  Generally, if the expression contains Shell metacharacters, it is
              easier to pass it as a single, quoted argument.  Multiple arguments are concatenated  with  spaces
              before being parsed.

</pre><h4><b>READING</b> <b>PCAPS</b></h4><pre>
       Instead  of  having  Snort  listen on an interface, you can give it a packet capture to read.  Snort will
       read and analyze the packets as if they came off the wire.  This can be useful for testing and  debugging
       Snort.

       <b>Read</b> <b>a</b> <b>single</b> <b>pcap</b>

            $ snort -r foo.pcap
            $ snort --pcap-single=foo.pcap

       <b>Read</b> <b>pcaps</b> <b>from</b> <b>a</b> <b>file</b>

            $ cat foo.txt
            foo1.pcap
            foo2.pcap
            /home/foo/pcaps

            $ snort --pcap-file=foo.txt

            This  will  read foo1.pcap, foo2.pcap and all files under /home/foo/pcaps.  Note that Snort will not
            try to determine whether the files under that directory are really pcap files or not.

       <b>Read</b> <b>pcaps</b> <b>from</b> <b>a</b> <b>command</b> <b>line</b> <b>list</b>

            $ snort --pcap-list="foo1.pcap foo2.pcap foo3.pcap"

            This will read foo1.pcap, foo2.pcap and foo3.pcap.

       <b>Read</b> <b>pcaps</b> <b>under</b> <b>a</b> <b>directory</b>

            $ snort --pcap-dir="/home/foo/pcaps"

            This will include all of the files under /home/foo/pcaps.

       <b>Using</b> <b>filters</b>

            $ cat foo.txt
            foo1.pcap
            foo2.pcap
            /home/foo/pcaps

            $ snort --pcap-filter="*.pcap" --pcap-file=foo.txt
            $ snort --pcap-filter="*.pcap" --pcap-dir=/home/foo/pcaps

            The above will only include files that match the shell pattern "*.pcap", in other  words,  any  file
            ending in ".pcap".

            $ snort --pcap-filter="*.pcap --pcap-file=foo.txt \
            &gt; --pcap-filter="*.cap" --pcap-dir=/home/foo/pcaps

            In the above, the first filter "*.pcap" will only be applied to the pcaps in the file "foo.txt" (and
            any  directories  that  are  recursed in that file).  The addition of the second filter "*.cap" will
            cause the first filter to be forgotten and then applied to the directory  /home/foo/pcaps,  so  only
            files ending in ".cap" will be included from that directory.

            $ snort --pcap-filter="*.pcap --pcap-file=foo.txt \
            &gt; --pcap-no-filter --pcap-dir=/home/foo/pcaps

            In  this example, the first filter will be applied to foo.txt, then no filter will be applied to the
            files found under /home/foo/pcaps, so all files found under /home/foo/pcaps will be included.

            $ snort --pcap-filter="*.pcap --pcap-file=foo.txt \
            &gt; --pcap-no-filter --pcap-dir=/home/foo/pcaps \
            &gt; --pcap-filter="*.cap" --pcap-dir=/home/foo/pcaps2

            In this example, the first filter will be applied to foo.txt, then no filter will be applied to  the
            files  found  under /home/foo/pcaps, so all files found under /home/foo/pcaps will be included, then
            the filter "*.cap" will be applied to files found under /home/foo/pcaps2.

       <b>Resetting</b> <b>state</b>

            $ snort --pcap-dir=/home/foo/pcaps --pcap-reset

            The above example will read all of the files under /home/foo/pcaps, but after  each  pcap  is  read,
            Snort  will  be reset to a post-configuration state, meaning all buffers will be flushed, statistics
            reset, etc.  For each pcap, it will be like Snort is seeing traffic for the first time.

       <b>Printing</b> <b>the</b> <b>pcap</b>

            $ snort --pcap-dir=/home/foo/pcaps --pcap-show

            The above example will read all of the files under /home/foo/pcaps and will print a line  indicating
            which pcap is currently being read.

</pre><h4><b>RULES</b></h4><pre>
       Snort  uses a simple but flexible rules language to describe network packet signatures and associate them
       with actions.  The current rules document can be found at <a href="http://www.snort.org/snort-rules">http://www.snort.org/snort-rules</a>.

</pre><h4><b>NOTES</b></h4><pre>
       The following signals have the specified effect when  sent  to  the  daemon  process  using  the  <b><a href="../man1/kill.1.html">kill</a>(1)</b>
       command:

       SIGHUP Causes  the daemon to close all opened files and restart.  Please <b>note</b> that this will only work if
              the <b>full</b> pathname is used to invoke snort in daemon mode, otherwise snort will just exit  with  an
              error message being sent to <b><a href="../man8/syslogd.8.html">syslogd</a>(8)</b>.

       SIGUSR1
              Causes the program to dump its current packet statistical information to the console or <b><a href="../man8/syslogd.8.html">syslogd</a>(8)</b>
              if in daemon mode.

       SIGUSR2
              Causes  the  program to rotate Perfmonitor statistical information to the console or <b><a href="../man8/syslogd.8.html">syslogd</a>(8)</b> if
              in daemon mode.

       SIGURG Causes the program to reload attribute table.

       SIGCHLD
              Used internally.

       Please refer to manual for more details. Any other signal might cause the  daemon  to  close  all  opened
       files and exit.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       In   Debian,  there  are  several  ways  in  which  Snort  can  be  configured.  The  configuration  file
       <u>/etc/snort/snort.conf</u> provides the configuration for  the  software  itself.  Users  can  customise  this
       configuration.   In  systems  which  have  multiple  interfaces, it is possible to have a different Snort
       instance  per  network  interface  and  adjust  the  specific  configuration  for  one  interface   using
       <u>/etc/snort/snort.INTERFACE.conf</u> (where <b>INTERFACE</b> should be replaced by the interface name).

       There  are  additional  configuration  files  in  /etc/snort which modify Snort behaviour. These include:
       attribute_table.dtd, file_magic.conf, threshold.conf and unicode.map

       In addition, Debian provides a specific configuration file to manage the startup  of  Snort  through  the
       <u>/etc/snort/snort.debian.conf</u>  configuration  file.  This  file is modified by the packaging system, using
       <b>debconf</b>, and defines whether Snort is to be started up on  system  boot  or  manually,  defines  specific
       options  for the Snort daemon when it is started and sets values to be used by the <b>snort-stat</b> cron script
       (if enabled).

       Finally, the configuration file <u>/etc/default/snort</u> is used to define parameters which are  applicable  to
       the  Snort  startup  (init.d) script. These include: daemon startup parameters, user and group Snort will
       run as, log directory and whether to run Snort when the interfaces to be monitored are not available.

</pre><h4><b>LOGS</b> <b>AND</b> <b>ALERTS</b></h4><pre>
       In Debian, the <b>Snort</b> logs are available  under  /var/log/snort/  and  includes  <u>/var/log/snort/snort.log</u>,
       <u>/var/log/snort/snort.alert</u> and <u>/var/log/snort/snort.alert.fast</u>

       The  first  two  of  these  logs are saved using the unified format which can be read using the <b>u2spewfoo</b>
       tool.  For more information read /usr/share/doc/snort/README.unified2 which is provided by the  snort-doc
       package.  The log files in unified2 format can also be converted to other formats (currently only pcap is
       supported) using the <b>u2boat</b> tool. The last log file (snort.alert.fast) is a one line format that provides
       fast alerts. These alerts are read by the <b>snort-stat</b> and sent by email to  a  designed  administrator  if
       eneabled in the Debian package configuration.

       The  location  of  the log directory can be adjusted through the configuration of the <b>LOGDIR</b> parameter in
       the <u>/etc/default/snort</u> configuration file.

       The log file <u>/var/log/snort/snort.log</u> contains the packets logged, while  the  <u>/var/log/snort/snort.alert</u>
       contains only the alerts generated.

       In addition to this, all alerts are logged into syslog using LOG_AUTH and LOG_ALERT.

       The logging and alerting  mode can be modified by configuring the /etc/snort/snort.conf file.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>Snort</b> has been freely available under the GPL license since 1998.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       <b>Snort</b> returns a 0 on a successful exit, 1 if it exits on an error.

</pre><h4><b>BUGS</b></h4><pre>
       After  consulting  the  BUGS file included with the source distributon and available in Debian systems in
       /usr/share/doc/BUGS, as well  as  the  Debian-specific  bugs  published  in  https://bugs.debian.org/cgi-
       bin/pkgreport.cgi?package=snort  please  send bug reports to Debian using the <b>reportbug</b> program. For more
       information about reporting bugs in Debian please read https://www.debian.org/Bugs/Reporting

       If you believe the bug lies with the upstream  package,  please  send  bug  reports  directly  to  snort-
       <a href="mailto:devel@lists.snort.org">devel@lists.snort.org</a>

</pre><h4><b>AUTHOR</b></h4><pre>
       The main author of Snort is Martin Roesch &lt;<a href="mailto:roesch@snort.org">roesch@snort.org</a>&gt;

       In  addition,  many  people  have  contributed  to  Snort  development.  For  a  full  list  please  read
       /usr/share/doc/snort/CREDITS.gz

       This Debian package was created by  Christian Hammers &lt;<a href="mailto:ch@debian.org">ch@debian.org</a>&gt; (from 1999 to 2001), Robert van der
       Meulen &lt;<a href="mailto:rvdm@debian.org">rvdm@debian.org</a>&gt; (2001 to 2002), Sander Smeenk &lt;<a href="mailto:ssmeenk@debian.org">ssmeenk@debian.org</a>&gt; (2002  to  2004)  and  Javier
       Fern√°ndez-Sanguino  &lt;<a href="mailto:jfs@debian.org">jfs@debian.org</a>&gt;  (2004  to 2020). It includes with contributions from many different
       Debian developers and users. All of them are credited in the Debian changelog file which can be found  at
       /usr/share/doc/snort/changelog.Debian.gz and /usr/share/doc/snort/copyright

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/tcpdump.1.html">tcpdump</a></b>(1), <b><a href="../man3/pcap.3.html">pcap</a></b>(3), <b><a href="../man8/u2boat.8.html">u2boat</a></b>(8), <b><a href="../man8/u2spewfoo.8.html">u2spewfoo</a></b>(8), <b><a href="../man8/snort-stat.8.html">snort-stat</a></b>(8)

                                                  December 2011                                         <u><a href="../man8/SNORT.8.html">SNORT</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>