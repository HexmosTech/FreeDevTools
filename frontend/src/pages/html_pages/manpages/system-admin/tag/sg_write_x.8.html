<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sg_write_x - SCSI WRITE normal/ATOMIC/SAME/SCATTERED/STREAM, ORWRITE commands</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/sg3-utils">sg3-utils_1.48-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sg_write_x - SCSI WRITE normal/ATOMIC/SAME/SCATTERED/STREAM, ORWRITE commands

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>sg_write_x</b>   [<u>--16</u>]   [<u>--32</u>]  [<u>--app-tag=AT</u>]  [<u>--atomic=AB</u>]  [<u>--bmop=OP,PGP</u>]  [<u>--bs=BS</u>]  [<u>--combined=DOF</u>]
       [<u>--dld=DLD</u>]  [<u>--dpo</u>]  [<u>--dry-run</u>]   [<u>--fua</u>]   [<u>--generation=EOG,NOG</u>]   [<u>--grpnum=GN</u>]   [<u>--help</u>]   <u>--in=IF</u>
       [<u>--lba=LBA[,LBA...]</u>]    [<u>--normal</u>]    [<u>--num=NUM[,NUM...]</u>]    [<u>--offset=OFF[,DLEN]</u>]    [<u>--or</u>]   [<u>--quiet</u>]
       [<u>--ref-tag=RT</u>] [<u>--same=NDOB</u>]  [<u>--scat-file=SF</u>]  [<u>--scat-raw</u>]  [<u>--scattered=RD</u>]  [<u>--stream=ID</u>]  [<u>--strict</u>]
       [<u>--tag-mask=TM</u>] [<u>--timeout=TO</u>] [<u>--unmap=U_A</u>] [<u>--verbose</u>] [<u>--version</u>] [<u>--wrprotect=WPR</u>] <u>DEVICE</u>

       Synopsis per supported command:

       <b>sg_write_x</b>   <u>--normal</u>   <u>--in=IF</u>  [<u>--16</u>]  [<u>--32</u>]  [<u>--app-tag=AT</u>]  [<u>--bs=BS</u>]  [<u>--dld=DLD</u>]  [<u>--dpo</u>]  [<u>--fua</u>]
       [<u>--grpnum=GN</u>] [<u>--lba=LBA</u>] [<u>--num=NUM</u>]  [<u>--offset=OFF[,DLEN]</u>]  [<u>--ref-tag=RT</u>]  [<u>--strict</u>]  [<u>--tag-mask=TM</u>]
       [<u>--timeout=TO</u>] [<u>--wrprotect=WPR</u>] <u>DEVICE</u>

       <b>sg_write_x</b>  <u>--or</u>  <u>--in=IF</u>  [<u>--16</u>] [<u>--32</u>] [<u>--bmop=OP,PGP</u>] [<u>--bs=BS</u>] [<u>--dpo</u>] [<u>--fua</u>] [<u>--generation=EOG,NOG</u>]
       [<u>--grpnum=GN</u>] [<u>--lba=LBA</u>] [<u>--num=NUM</u>] [<u>--offset=OFF[,DLEN]</u>] [<u>--strict</u>]  [<u>--timeout=TO</u>]  [<u>--wrprotect=OPR</u>]
       <u>DEVICE</u>

       <b>sg_write_x</b>  <u>--atomic=AB</u>  <u>--in=IF</u>  [<u>--16</u>]  [<u>--32</u>]  [<u>--app-tag=AT</u>]  [<u>--bs=BS</u>] [<u>--dpo</u>] [<u>--fua</u>] [<u>--grpnum=GN</u>]
       [<u>--lba=LBA</u>] [<u>--num=NUM</u>] [<u>--offset=OFF[,DLEN]</u>] [<u>--ref-tag=RT</u>] [<u>--strict</u>] [<u>--timeout=TO</u>]  [<u>--wrprotect=WPR</u>]
       <u>DEVICE</u>

       <b>sg_write_x</b>  <u>--same=NDOB</u>  [<u>--16</u>]  [<u>--32</u>]  [<u>--app-tag=AT</u>] [<u>--bs=BS</u>] [<u>--dpo</u>] [<u>--fua</u>] [<u>--grpnum=GN</u>] [<u>--in=IF</u>]
       [<u>--lba=LBA</u>] [<u>--num=NUM</u>]  [<u>--offset=OFF[,DLEN]</u>]  [<u>--ref-tag=RT</u>]  [<u>--strict</u>]  [<u>--timeout=TO</u>]  [<u>--unmap=U_A</u>]
       [<u>--wrprotect=WPR</u>] <u>DEVICE</u>

       <b>sg_write_x</b>  <u>--scattered=RD</u>  <u>--in=IF</u>  [<u>--16</u>]  [<u>--32</u>]  [<u>--app-tag=AT</u>] [<u>--bs=BS</u>] [<u>--dld=DLD</u>] [<u>--dpo</u>] [<u>--fua</u>]
       [<u>--grpnum=GN</u>]    [<u>--lba=LBA[,LBA...]</u>]     [<u>--num=NUM[,NUM...]</u>]    [<u>--offset=OFF[,DLEN]</u>]    [<u>--ref-tag=RT</u>]
       [<u>--scat-file=SF</u>] [<u>--scat-raw</u>] [<u>--strict</u>] [<u>--tag-mask=TM</u>] [<u>--timeout=TO</u>] [<u>--wrprotect=WPR</u>] <u>DEVICE</u>

       <b>sg_write_x</b>  <u>--stream=ID</u>  <u>--in=IF</u>  [<u>--16</u>]  [<u>--32</u>]  [<u>--app-tag=AT</u>]  [<u>--bs=BS</u>] [<u>--dpo</u>] [<u>--fua</u>] [<u>--grpnum=GN</u>]
       [<u>--lba=LBA</u>] [<u>--num=NUM</u>] [<u>--offset=OFF[,DLEN]</u>] [<u>--ref-tag=RT</u>]  [<u>--strict</u>]  [<u>--tag-mask=TM</u>]  [<u>--timeout=TO</u>]
       [<u>--wrprotect=WPR</u>] <u>DEVICE</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  utility  will  send one of six SCSI commands, all associated with writing data to the given <u>DEVICE</u>.
       They are a "normal" WRITE, ORWRITE, WRITE ATOMIC, WRITE SAME,  WRITE  SCATTERED  or  WRITE  STREAM.  This
       utility supports the 16 and 32 byte variants of all six commands. Hence some closely related commands are
       not  supported  (e.g.  <a href="../man10/WRITE.10.html">WRITE</a>(10)). All 32 byte variants, apart from <a href="../man32/ORWRITE.32.html">ORWRITE</a>(32), require the <u>DEVICE</u> to be
       formatted with type 1, 2 or 3 Protection Information (PI), making  all  logical  blocks  8  bytes  (or  a
       multiple of 8 bytes) longer on the media.

       The  command  line  interface  is  a  little  crowded with over thirty options. Hence the SYNOPSIS, after
       listing all the (long) options, lists those applicable  to  each  supported  command.  For  each  command
       synopsis, the option that selects the SCSI command is shown first followed by any required options. If no
       command  option  is  given then a "normal" WRITE is assumed. Even though the <u>--scat-file=SF</u> option can be
       given for every command, it is  only  shown  for  WRITE  SCATTERED  where  it  is  most  useful.  If  the
       <u>--scat-file=SF</u>  option  is  given  then neither the <u>--lba=LBA[,LBA...]</u> nor the <u>--num=NUM[,NUM...]</u> options
       should be given. Only the first item of the <u>--lba=LBA[,LBA...]</u> and  the  <u>--num=NUM[,NUM...]</u>  options  (or
       first  pair (or quintet) from the <u>--scat-file=SF</u> option) is used for all but the WRITE SCATTERED command.
       All commands can take <u>--dry-run</u> and <u>--verbose</u> in addition to those shown in the SYNOPSIS.

       The logical block size in bytes can be given explicitly with the <u>--bs=BS</u> option, as long as <u>BS</u> is greater
       than zero. It is typically a power of two, 512 or greater. If the <u>--bs=BS</u> option is not given  or  <u>BS</u>  is
       zero  then  the  SCSI  READ  CAPACITY  command  is  used  to  find the logical block size. First the READ
       <a href="../man16/CAPACITY.16.html">CAPACITY</a>(16) command is tried and if successful the logical block size in the response is typically  used
       as  the  actual block size for this utility. The exception is when PROT_EN is set in the response and the
       <u>--wrprotect=WPR</u> option is given and non-zero; in which case 8 (bytes) is added to the logical block  size
       to yield the actual block size used by this utility. If READ <a href="../man16/CAPACITY.16.html">CAPACITY</a>(16) fails then READ <a href="../man10/CAPACITY.10.html">CAPACITY</a>(10) is
       tried and if that works then the logical block size in the response is used as the actual block size.

       The  number  of  bytes  this utility will attempt to read from the file named by <u>IF</u> is the product of the
       actual block size and the number_of_blocks (<u>NUM</u> or the sum of <u>NUM</u> arguments). If less bytes are read from
       the file <u>IF</u> and  the  <u>--strict</u>  option  is  given  then  this  utility  exits  with  an  exit  status  of
       SG_LIB_FILE_ERROR.  If  less  bytes  are  read from the file <u>IF</u> and the <u>--strict</u> option is not given then
       bytes of zero are substituted for the "missing" bytes and this utility continues.

       Attempts to write multi megabyte data with a single command  are  likely  to  fail  for  one  of  several
       reasons.  First  the  operating  system  might  object  to  allocating a buffer that large. Next the SCSI
       pass-through usually limits data blocks to a few megabytes or less. Finally the storage device might have
       a limited amount of RAM to support a write operation such as atomic (as it may need to  roll  back).  The
       storage device can inform the application client of its limitations via the block limits VPD page (0xb0),
       with the maximum atomic transfer length field amongst others.

       A  degenerate  LBA  (Logical  Block  Address)  range  descriptor with no PI has an LBA and NUM of zero. A
       degenerate LBA range descriptor with PI additionally has its RT, AT and TM fields set to zero (note: that
       is not the default values for  RT,  AT  and  TM).  They  are  degenerate  in  the  sense  that  they  are
       indistinguishable  from  a  pad of zeros that follow the scatter list in the data-out buffer. SBC-4 makes
       clear that a degenerate LBA range descriptor is valid. This may become  an  issue  if  <u>RD</u>  given  in  the
       <u>--scattered=RD</u>  option has the value 0. In this case the logic may need to scan the user provided data to
       calculate the number of LBA range descriptors which is required  by  the  WRITE  SCATTERED  cdb.  In  the
       absence of other information the logic will take a degenerate LBA range descriptor as a terminator of the
       scatter list.

       The reference for these commands is SBC-4 (T10/BSR INCITS 506-2021) and draft SBC-5 INCITS 571 revision 1
       dated  21  May  2021.  All  six SCSI commands are described in those documents. WRITE ATOMIC was added in
       SBC-4 revision 3; WRITE STREAM was added in SBC-4 revision 7; WRITE SCATTERED was added in SBC-4 revision
       11 while the others are in the previous SBC-3 standard.

</pre><h4><b>OPTIONS</b></h4><pre>
       Arguments to long options are mandatory  for  short  options  as  well.   The  options  are  arranged  in
       alphabetical order based on the long option name.

       <b>-6</b>, <b>--16</b>
              send  the  16  byte  cdb  variant of the selected SCSI command. If no command is selected then the
              (normal) SCSI <a href="../man16/WRITE.16.html">WRITE</a>(16) command is sent. If neither this option nor the <u>--32</u> option is given  then
              this option is assumed.

       <b>-3</b>, <b>--32</b>
              send  the  32  byte  cdb  variant of the selected SCSI command. If no command is selected then the
              (normal) SCSI <a href="../man32/WRITE.32.html">WRITE</a>(32) command is sent. If neither this option nor the <u>--16</u> option is given  then
              then  the  <u>--16</u>  option  is  assumed.  If both this option and the <u>--16</u> option are given then this
              option takes precedence. Note that apart from <a href="../man32/ORWRITE.32.html">ORWRITE</a>(32) all other 32 byte cdb variants require a
              <u>DEVICE</u> formatted with type 1, 2 or 3 protection information.

       <b>-a</b>, <b>--app-tag</b>=<u>AT</u>
              where <u>AT</u> is the "expected logical block application tag" field found in most of the  32  byte  cdb
              variants  (the  exception  is  <a href="../man32/ORWRITE.32.html">ORWRITE</a>(32)). <u>AT</u> is a 16 bit field which means the maximum value is
              0xffff. The default value is 0xffff .

       <b>-A</b>, <b>--atomic</b>=<u>AB</u>
              selects the WRITE ATOMIC command and <u>AB</u> is placed in the Atomic Boundary field of its cdb. It is a
              16 bit field so the maximum value is 0xffff. If unsure what value to set, try 0 which will attempt
              to write the whole data-out buffer in a single atomic operation.

       <b>-B</b>, <b>--bmop</b>=<u>OP,PGP</u>
              where <u>OP</u> and <u>PGP</u> are the values to be  placed  in  <a href="../man32/ORWRITE.32.html">ORWRITE</a>(32)'s  BMOP  and  'Previous  Generation
              Processing'  fields  respectively.  BMOP  is a 3 bit field (ranges from 0 to 7) and PGP is a 4 bit
              field (ranges from 0 to 15). Both fields default to 0.

       <b>-b</b>, <b>--bs</b>=<u>BS</u>
              where <u>BS</u> is the logical block size or the actual block size which will  be  slightly  bigger.  The
              default  value  is  zero.  If this option is not given or is given with a <u>BS</u> of zero then the SCSI
              READ <a href="../man16/CAPACITY.16.html">CAPACITY</a>(16) command is sent to <u>DEVICE</u>. If that fails then the READ <a href="../man10/CAPACITY.10.html">CAPACITY</a>(10)  command  is
              sent.  The  logical  and  actual block size will be derived from the response of the READ CAPACITY
              command.
              This section assumes <u>BS</u> is greater than zero. If <u>BS</u> is less than 512 (bytes) or not a multiple  of
              8,  a  warning is issued and the utility continues unless the <u>--strict</u> option is also given. If <u>BS</u>
              is a power of two (e.g. 512) then the logical and actual block size is set to <u>BS</u> (e.g. 512). If <u>BS</u>
              is not a power of two (e.g. 520) then the logical block size is set to the closest  power  of  two
              less than <u>BS</u> (e.g. 512) and the actual block size is set to <u>BS</u> (e.g.  520).
              If the logical and actual block size are different then a later check will reduce the actual block
              size back to the logical block size unless <u>--wrprotect=WPR</u> is greater than zero.

       <b>-c</b>, <b>--combined</b>=<u>DOF</u>
              This option only applies to WRITE SCATTERED and assumes the whole data-out buffer can be read from
              <u>IF</u>  given  by the <u>--in=IF</u> option. The whole data-out buffer is the parameter list header, followed
              by zero or more LBA range descriptors, optionally followed by some pad bytes and then the data  to
              be  written  to the media. If the <u>--lba=LBA[,LBA...]</u>, <u>--num=NUM[,NUM...]</u> or <u>--scat-file=SF</u> options
              are also given then an error is generated. The <u>DOF</u> argument should be the value suitable  for  the
              'Logical  Block  Data Offset' field in the WRITE SCATTERED cdb. This is the offset in the data-out
              buffer where the data to write to the media commences. The unit of that field is the actual  block
              size which is the logical block size plus a multiple of 8, if protection information (PI) is being
              sent.  When <u>WPR</u> (from <u>--wrprotect=WPR</u>) is greater than zero then PI is expected. SBC-4 revision 15
              does not state it but it would appear that a <u>DOF</u> value of 0 is invalid. It is suggested that  this
              option be used with the <u>--strict</u> option while experimenting as random or incorrect data fed in via
              the  <u>--in=IF</u>  option could write a lot of "interesting" data all over the <u>DEVICE</u>.  If <u>DOF</u> is given
              as 0 the utility will scan the data in <u>IF</u> until <u>RD</u> LBA range descriptors are found; or  if  <u>RD</u>  is
              also 0 until a degenerate LBA range descriptor is found.

       <b>-D</b>, <b>--dld</b>=<u>DLD</u>
              where  <u>DLD</u>  is  the  duration limits descriptor spread across 3 bits in the SCSI <a href="../man16/WRITE.16.html">WRITE</a>(16) and the
              WRITE <a href="../man16/SCATTERED.16.html">SCATTERED</a>(16) cdbs. <u>DLD</u> is between 0 to 7 inclusive with a default of zero. The  DLD0  field
              in  <a href="../man16/WRITE.16.html">WRITE</a>(16)  and  WRITE  <a href="../man16/SCATTERED.16.html">SCATTERED</a>(16) is set if (0x1 &amp; <u>DLD</u>) is non-zero. The DLD1 field in both
              cdbs is set if (0x2 &amp; <u>DLD</u>) is non-zero. The DLD2 field in both cdbs is  set  if  (0x4  &amp;  <u>DLD</u>)  is
              non-zero.

       <b>-d</b>, <b>--dpo</b>
              if  this  option is given then the DPO (disable page out) bit field in the cdb is set. The default
              is to clear this bit field. Applies to all commands supported by thus utility except WRITE SAME.

       <b>-x</b>, <b>--dry-run</b>
              this option exits (with a status of 0) just before it would otherwise send the selected SCSI write
              command. It may still send a SCSI READ CAPACITY command (16  byte  variant  and  perhaps  10  byte
              variant  as  well)  so  the <u>DEVICE</u> is still required. It reads the data in and processes it if the
              <u>--in=IF</u> and/or the <u>--scat-file=SF</u> options are given. All command line processing and sanity checks
              (e.g. if the <u>--strict</u> option is given) will be performed and if there is an error then there  will
              be a non zero exit status value.
              If  this  option  is  given  twice  (e.g.  -xx) then instead of performing the selected write SCSI
              command, the data-out buffer is written to a file called sg_write_x.bin . If it doesn't exist then
              that file is created in the current directory and is truncated if it  previously  did  exist  with
              longer  contents.  The data-out buffer is written in binary with some information about it written
              to stdout. For writes other than scattered the filename and its  length  in  bytes  is  output  to
              stdout. For write scattered additionally its number of LBA range descriptors and its logical block
              data offset written to stdout.

       <b>-f</b>, <b>--fua</b>
              if  this option is given then the FUA (force unit access) bit field in the cdb is set. The default
              is to clear this bit field. Applies to all commands supported by thus utility except WRITE SAME.

       <b>-G</b>, <b>--generation</b>=<u>EOG,NOG</u>
              the arguments for this option are used by the <a href="../man32/ORWITE.32.html">ORWITE</a>(32) command  only.   <u>EOG</u>  is  placed  in  the
              "Expected  ORWgeneration"  field while <u>NOG</u> is placed in the "New ORWgeneration" field. Both are 32
              bits long and default to zero.

       <b>-g</b>, <b>--grpnum</b>=<u>GN</u>
              sets the 'Group number' field to <u>GN</u>. Defaults to a value of zero.  <u>GN</u> should be a value between  0
              and 63.

       <b>-h</b>, <b>--help</b>
              output  the  usage message then exit. Use multiple times for more help.  Currently '-h' to '-hhhh'
              provide different output.

       <b>-i</b>, <b>--in</b>=<u>IF</u>
              read data (in binary) from a file named <u>IF</u> in a single OS system call  (in  Unix:  <a href="../man2/read.2.html">read</a>(2)).  That
              data  is  placed  in  a  continuous buffer and then used as the data-out buffer for all SCSI write
              commands apart from WRITE SCATTERED(16 or 32) which may include other data in the data-out buffer.
              For WRITE SCATTERED (16 or 32) the data-out buffer is made up of 3 or 4 components in this  order:
              a  parameter  list header (32 zero bytes); zero or more LBA range descriptors, optionally some pad
              bytes (zeros) and then data to write to the media. For WRITE SCATTERED <u>IF</u> only provides  the  data
              to  write  to the media unless <u>--combined=DOF</u> is given. When the <u>--combined=DOF</u> option is given <u>IF</u>
              contains all components of the WRITE SCATTERED data-out buffer in binary. The data  read  from  <u>IF</u>
              starts  from byte offset <u>OFF</u> which defaults to zero and no more than <u>DLEN</u> bytes are read from that
              point (i.e. from the file byte offset <u>OFF</u>). If <u>DLEN</u> is zero or not given the rest of the  file  <u>IF</u>
              is  read. This option is mandatory apart from when --same=1 is given (that sets the NDOB bit which
              stands for "No Data Out Buffer"). In Unix based OSes, any number of zeros can be produced by using
              the /dev/zero device file.
              <u>IF</u> may be "-" which is taken as stdin. In this case the <u>--offset=OFF,DLEN</u> can be  given  with  <u>OFF</u>
              set  to  0  and  <u>LEN</u>  set to a non-zero value, preferably a multiple of the actual block size. The
              utility can also deduce how long the <u>IF</u> should be from <u>NUM</u> (or the sum of them in the  case  of  a
              scatter list).

       <b>-l</b>, <b>--lba</b>=<u>LBA[,LBA...]</u>
              where  the argument is a single Logical Block Address (LBA) or a comma separated list of <u>LBA</u>s each
              of which is the address of the first block written by the selected write command. Only  the  WRITE
              SCATTERED  command  can  usefully  take more than one <u>LBA</u>. Whatever number of <u>LBA</u>s is given, there
              needs to be an equal number of <u>NUM</u>s given to the <u>--num=NUM[,NUM...]</u> option. The  first  given  <u>LBA</u>
              joins  with the first given <u>NUM</u> to form the first LBA range descriptor (which T10 number from zero
              in SBC-4). The second <u>LBA</u> joins with the second <u>LBA</u> to form the second LBA range descriptor,  etc.
              A more convenient way to define a large number of LBA range descriptors is with the <u>--scat-file=SF</u>
              option. Defaults to logical block 0 (which could be dangerous) while <u>NUM</u> defaults to 0 which makes
              the  combination  harmless.   <u>LBA</u>  is  assumed to be in decimal unless prefixed with '0x' or has a
              trailing 'h'.

       <b>-N</b>, <b>--normal</b>
              the choice of a "normal" WRITE (16 or 32) command can be made explicitly with this option. In  the
              absence of selecting any other command (e.g.  <u>--atomic=AB</u> ), the choice of a "normal" WRITE is the
              default.

       <b>-n</b>, <b>--num</b>=<u>NUM[,NUM...]</u>
              where  the argument is a single NUMber of blocks (NUM) or a comma separated list of <u>NUM</u>s that pair
              with the corresponding entries in the <u>--lba=LBA[,LBA...]</u> option. If a <u>NUM</u>  is  given  and  is  not
              provided  by  another  method  (e.g.  by  using the <u>--scat-file=SF</u> option) then it defaults to the
              number of blocks derived from the size of the file named by <u>IF</u> (starting at byte offset <u>OFF</u> to the
              end or the file or <u>DLEN</u>). Apart from the <u>--combined=DOF</u> option, an LBA must  be  explicitly  given
              (either with <u>I--lba=LBA</u> or via <u>--scat-file=SF</u>), if not <u>NUM</u> defaults to 0 as a safety measure.

       <b>-o</b>, <b>--offset</b>=<u>OFF[,DLEN]</u>
              where  <u>OFF</u> is the byte offset within the file named <u>IF</u> to start reading from. The default value of
              <u>OFF</u> is zero which is the beginning of file named <u>IF</u>. <u>DLEN</u> is the maximum number of bytes to  read,
              starting  at  byte  offset  <u>OFF</u>, from the file named <u>IF</u>. Less bytes will be read if an end of file
              occurs before <u>DLEN</u> is exhausted. If <u>DLEN</u> is zero or not given then reading from byte offset <u>OFF</u> to
              the end of the file named <u>IF</u> is assumed.

       <b>-O</b>, <b>--or</b>
              selects the ORWRITE command. <a href="../man16/ORWRITE.16.html">ORWRITE</a>(16) has similar fields to <a href="../man16/WRITE.16.html">WRITE</a>(16) apart from the  WRPROTECT
              field  being  named  ORPROTECT  with slightly different semantics and the absence of the 3 DLD bit
              fields.  <a href="../man32/ORWRITE.32.html">ORWRITE</a>(32)  has  four  extra  fields  that  are   set   with   the   <u>--bmop=OP,PGP</u>   and
              <u>--generation=EOG,NOG</u>  options.  <a href="../man32/ORWRITE.32.html">ORWRITE</a>(32)  is  the only 32 byte cdb command in this utility that
              does not require a <u>DEVICE</u> formatted with type 1, 2 or 3 PI (although it will still work if  it  is
              formatted with PI).

       <b>-Q</b>, <b>--quiet</b>
              suppress  some  informational  messages such as the ones associated with detected errors when this
              utility is about to exit. The exit status value is still returned to  the  operating  system  when
              this utility exits.

       <b>-r</b>, <b>--ref-tag</b>=<u>RT</u>
              where  <u>RT</u>  is  the  "expected  initial logical block reference tag" field found in the 32 byte cdb
              variants of WRITE, WRITE ATOMIC, WRITE SAME and WRITE STREAM.  The field  is  also  found  in  the
              WRITE  <a href="../man32/SCATTERED.32.html">SCATTERED</a>(32)  LBA range descriptors. It is a 32 bit field which means the maximum value is
              0xffffffff. The default value is 0xffffffff.

       <b>-S</b>, <b>--same</b>=<u>NDOB</u>
              selects the WRITE SAME command with the NDOB field set  to  <u>NDOB</u>  which  stands  for  No  Data-Out
              Buffer.  <u>NDOB</u>  can  take  values 0 or 1 (i.e. it is a single bit field). When --same=1 all options
              associated with the data-out buffer are ignored.

       <b>-q</b>, <b>--scat-file</b>=<u>SF</u>
              where <u>SF</u> is the name of an auxiliary file containing the scatter  list  for  the  WRITE  SCATTERED
              command.  If  the <u>--scat-raw</u> option is also given then <u>SF</u> is assumed to contain both the parameter
              list header (32 bytes of zeros) followed by zero or more LBA range descriptors which are  also  32
              bytes  long  each.  These components are as defined by SBC-4 (i.e.  in binary with integers in big
              endian format). If the <u>--scat-raw</u> option is not given then a file of ACSII hexadecimal is expected
              as described in the SCATTERED FILE ASCII FORMAT section below.
              If this option is given with the <u>--combined=DOF</u> option then this utility will exit with  a  syntax
              error. <u>SF</u> must not be "-", a way of stopping the user trying to redirect stdin.

       <b>-R</b>, <b>--scat-raw</b>
              this  option  only effects the way that the file named <u>SF</u> from the <u>--scat-file=SF</u> option for WRITE
              SCATTERED is interpreted. By default (i.e. without this option), <u>SF</u> is parsed as ASCII hexadecimal
              with blank lines and line contents from and including '#' to the end of line ignored. Hence it can
              contain comments and other  indications.  When  this  option  is  given,  the  file  named  <u>SF</u>  is
              interpreted  as binary.  As binary it is assumed to contain 32 bytes of zeros (the WRITE SCATTERED
              parameter list header) followed by zero or more LBA range descriptors (which are 32  bytes  each).
              If  the  <u>--strict</u>  option  is given the reserved field in those two items are checked with any non
              zero bytes causing an error.

       <b>-S</b>, <b>--scattered</b>=<u>RD</u>
              selects the WRITE SCATTERED command with <u>RD</u> being the number of LBA range descriptors that will be
              placed in the data-out buffer. If <u>RD</u> is zero then the logic will try and determine the  number  of
              range descriptors by other means (e.g. by parsing the file named by <u>SF</u>, if there is one).  The LBA
              range  descriptors  differ  between  the 16 and 32 byte cdb variants of WRITE SCATTERED. In the 16
              byte cdb variant the 32 byte LBA range descriptor is made up of an 8 byte LBA,  followed  by  a  4
              byte  number_of_blocks  followed  by  20  bytes  of  zeros.  In  the  32  byte variant the LBA and
              number_of_blocks are followed by a RT (4 bytes), an AT (2 bytes) and a TM (2 bytes) then 12  bytes
              of zeros.
              This  paragraph  applies when <u>RD</u> is greater than zero.  If <u>RD</u> is less than the number of LBA range
              descriptors built from command line options, from the <u>--scat-file=SF</u> option  or  decoded  from  <u>IF</u>
              (when the <u>--combined=DOF</u> option is given) then <u>RD</u> takes precedence; so <u>RD</u> is placed in the "Number
              of  LBA  Range  Descriptors"  field  in  the  cdb.  If  <u>RD</u> is greater than the number of LBA range
              descriptors found from the provided data and options, then an error is generated.

       <b>-T</b>, <b>--stream</b>=<u>ID</u>
              selects the WRITE STREAM command with the STR_ID field set to <u>ID</u>.  <u>ID</u> can take values  from  0  to
              0xffff (i.e. it is a 16 bit field).

       <b>-s</b>, <b>--strict</b>
              when  this  option  is  present,  more  things  (e.g.  that reserved fields contain zeros) and any
              irregularities will terminate the utility with a message to stderr and an indicative exit  status.
              While experimenting with these commands, especially WRITE SCATTERED, it is recommended to use this
              option.

       <b>-t</b>, <b>--tag-mask</b>=<u>TM</u>
              where  <u>TM</u>  is the "logical block application tag mask" field  found in the 32 byte cdb variants of
              WRITE, WRITE ATOMIC, WRITE  SAME  and  WRITE  STREAM.  The  field  is  also  found  in  the  WRITE
              <a href="../man32/SCATTERED.32.html">SCATTERED</a>(32) LBA range descriptors. It is a 16 bit field which means the maximum value is 0xffff.
              The default value is 0xffff.

       <b>-I</b>, <b>--timeout</b>=<u>TO</u>
              where  <u>TO</u>  is  the  command  timeout value in seconds. The default value is 120 seconds. If <u>NUM</u> is
              large on slow media then these WRITE commands may require considerably more time than 120  seconds
              to complete. An alternate long option form is <u>--tmo=TO</u> .

       <b>-u</b>, <b>--unmap</b>=<u>U_A</u>
              where <u>U_A</u> is OR-ed bit values used to set the UNMAP and ANCHOR bit fields in the WRITE SAME (16 or
              32)  cdb.  If  <u>U_A</u>  is 1 then the UNMAP bit field is set; if <u>U_A</u> is 2 then the ANCHOR bit field is
              set; if <u>U_A</u> is 3 then both the UNMAP and ANCHOR bit fields are set. The default value for both bit
              fields is clear (0); setting <u>U_A</u> to 0 will also clear both bit fields.

       <b>-v</b>, <b>--verbose</b>
              increase the degree of verbosity (debug messages). These messages are usually written to stderr.

       <b>-V</b>, <b>--version</b>
              output version string then exit.

       <b>-w</b>, <b>--wrprotect</b>=<u>WPR</u>
              sets the WRPROTECT field (3 bits) in all sg_write_x commands apart from ORWRITE which has a 3  bit
              ORPROTECT  field  (and  the  synopsis  shows <u>OPR</u> to highlight the difference). In all cases <u>WPR</u> is
              placed in that 3 bit field. The default value is zero which does not send any PI in  the  data-out
              buffer. <u>WPR</u> should be a value between 0 and 7.

</pre><h4><b>SCATTERED</b> <b>FILE</b> <b>ASCII</b> <b>FORMAT</b></h4><pre>
       All  commands  in this utility can take a <u>--scat-file=SF</u> and that option can be seen as a replacement for
       the <u>--lba=LBA[,LBA...]</u> and <u>--num=NUM[,NUM...]</u> options. if both the <u>--scat-file=SF</u> and <u>--scat-raw</u>  options
       are given then the file named <u>SF</u> is expected to be binary and contain the parameter list header (32 bytes
       of zeros for both the 16 and 32 byte variants) followed by zero or more LBA range descriptors, each of 32
       bytes each. This section describes what is expected in <u>SF</u> when the <u>--scat-raw</u> option is not given.

       The  ASCII  hexadecimal  "scatter  file"  (named by <u>SF</u>) can contain comments, empty lines and numbers. If
       multiple numbers appear on one line they can be separated by spaces, tabs or a single comma. Numbers  are
       parsed  as  decimal  unless  prefixed  by  "0x"  (or  "0X")  or have a suffix of "h". Ox is the prefix of
       hexadecimal number is the C language while T10 uses the "h" suffix for the same  purpose.  Anything  from
       and including a "#" character to the end-of-line is ignored, so comments can be placed there.

       For  the  WRITE  SCATTERED (16) command, its LBA range descriptors contain two items per descriptor: an 8
       byte LBA followed by a 4 byte number_of_blocks.  The remaining 20 bytes of the descriptor are zeros.  The
       format  accepted  is  relatively  loose  with  each  decoded  value  being  placed  in  an LBA and then a
       number_of_blocks until the end-of-file is reached. The pattern starts with a LBA and if it doesn't finish
       with a number_of_blocks (i.e.  an odd number of values are parsed) an error occurs. So the number of  LBA
       range descriptors generated will be half the number of values parsed in <u>SF</u>.

       For  the  WRITE SCATTERED (32) command, its LBA range descriptors contain five items per descriptor: an 8
       byte LBA followed by a 4 byte number_of_blocks, then a 4 byte RT, a 2 byte AT, and a 2 byte TM. The  last
       three  items  are associated with protection information (PI). The accepted format in the <u>SF</u> file is more
       constrained than the 16 byte cdb variant. The items for each LBA range descriptor must be  found  on  one
       line  with  adjacent  items being comma separated. The first two items (LBA and number_of_blocks) must be
       given, and if no more items are on the line then RT, AT and TM are given their default values  (all  "ff"
       bytes).  Spaces and tabs may appear between items but commas are the separators. Two commas with no value
       between them will cause the "missing" item to receive its default value.

</pre><h4><b>NOTES</b></h4><pre>
       Various numeric arguments (e.g. <u>LBA</u>) may include multiplicative suffixes or be given in hexadecimal.  See
       the "NUMERIC ARGUMENTS" section in the <a href="../man8/sg3_utils.8.html">sg3_utils</a>(8) man page.

       In Linux, prior to lk 3.17, the sg driver did not support cdb sizes greater than 16 bytes. Hence a device
       node like /dev/sg1 which is associated with the sg driver would fail with this utility if the <u>--32</u> option
       was  given  (or  implied  by  other options). The bsg driver with device nodes like /dev/bsg/6:0:0:1 does
       support cdb sizes greater than 16 bytes since its introduction in lk 2.6.28 .

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       The exit status of sg_write_x is 0 when it is successful. Otherwise see the <a href="../man8/sg3_utils.8.html">sg3_utils</a>(8) man page.

</pre><h4><b>EXAMPLES</b></h4><pre>
       One simple usage is to write 4 blocks of zeros from (and including) a given LBA according to the rules of
       WRITE ATOMIC with an atomic boundary of 0.  Since no cdb size option is given, the 16 byte  cdb  will  be
       assumed (i.e.  WRITE <a href="../man16/ATOMIC.16.html">ATOMIC</a>(16)):

         sg_write_x --atomic=0 --in=/dev/zero --lba=0x1234 --num=4 /dev/sdc

       Since  <u>--bs=BS</u>  has not been given, then this utility will call the READ <a href="../man16/CAPACITY.16.html">CAPACITY</a>(16) command on /dev/sdc
       to determine the number of bytes in a logical block. If the READ <a href="../man16/CAPACITY.16.html">CAPACITY</a>(16) command fails then the READ
       <a href="../man10/CAPACITY.10.html">CAPACITY</a>(10) command is tried. Let us assume one of them works and that  the  number  of  bytes  in  each
       logical  block  is 512 bytes. So 4 blocks of zeros (each block containing 512 bytes) will be written from
       (and including) LBA 0x1234 . Now to bypass the need for the READ CAPACITY command(s) the  <u>--bs=BS</u>  option
       can be used:

         sg_write_x --atomic=0 --bs=512 --in=/dev/zero --lba=0x1234 --num=4 /dev/sdc

       Since  --bs=  is  given  and  its value (512) is a power of 2, then the actual block size is also 512. If
       instead 520 was given then the logical block size would be 512 (the highest power of 2 less than 520) and
       the actual block size would be 520 bytes. To send the 32 byte variant add --32 as in:

         sg_write_x --atomic=0 --32 --bs=512 --in=/dev/zero --lba=0x1234 --num=4 /dev/sdc

       For examples using 'sg_write_x --same=NDOB' see the manpage for <a href="../man8/sg_write_same.8.html">sg_write_same</a>(8). The syntax is a  little
       different but the semantics are the same.

       To send a WRITE <a href="../man32/STREAM.32.html">STREAM</a>(32) with a STR_ID of 1 use the following:

         sg_write_x --stream=1 --32 --bs=512 --in=/dev/zero --lba=0x1234 --num=4 /dev/sdc

       Next is a WRITE <a href="../man16/SCATTERED.16.html">SCATTERED</a>(16) command with the scatter list, split between the --lba= and --num= options,
       on the command line:

         sg_write_x  --scattered=2 --lba=2,0x33 --num=4,1 -i /dev/zero /dev/sg1

       Example  of a WRITE <a href="../man16/SCATTERED.16.html">SCATTERED</a>(16) command with a degenerate LBA range descriptor (first element to --lba=
       and --num=):

         sg_write_x  --scattered=2 --lba=0,0x33 --num=0,1 -i /dev/zero /dev/sg1

       Example of a WRITE <a href="../man16/SCATTERED.16.html">SCATTERED</a>(16) command with the scatter list in scat_file.txt

         sg_write_x  --scattered=3 -q scat_file.txt -i /dev/zero /dev/sg1

       Next a WRITE <a href="../man16/SCATTERED.16.html">SCATTERED</a>(16) command with its scatter list and  data  in  a  single  file.  Note  that  the
       argument to --scattered= is 0 so the number of LBA range descriptors is calculated by analyzing the first
       two blocks of scat_data.bin (because the argument to --combined= is 2) :

         sg_write_x  --scattered=0 --combined=2 -i scat_data.bin /dev/sg1

       When  the  -xx  option is used, a WRITE SCATTERED command is not executed but instead the contents of the
       data-out buffer are written to a file called sg_write_x.bin . In the case of WRITE SCATTERED that  binary
       file is suitable for supplying to a later invocation to do the actual write to media. For example:

         $ sg_write_x  --scattered=3 -q scat_file.txt -xx -i /dev/zero /dev/sg1
         Wrote 8192 bytes to sg_write_x.bin, LB data offset: 1
         Number of LBA range descriptors: 3

         sg_write_x  --scattered=0 --combined=1 -i sg_write_x.bin /dev/sg1

       Notice  when  the  sg_write_x.bin is written (and nothing is written to the media), a summary of what has
       happened is sent to stdout. The value shown for "LB data offset:" (1) should be given to the  --combined=
       option when the write to media actually occurs (i.e. the second invocation shown directly above).

</pre><h4><b>AUTHORS</b></h4><pre>
       Written by Douglas Gilbert.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;dgilbert at interlog dot com&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Â© 2017-2023 Douglas Gilbert
       This  software  is  distributed  under  a  BSD-2-Clause  license.  There  is  NO  warranty;  not even for
       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>sg_readcap,sg_vpd,sg_write_same,sg_stream_ctl(sg3_utils)</b>

sg3_utils-1.48                                      May 2023                                       <u><a href="../man8/SG_WRITE_X.8.html">SG_WRITE_X</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>