<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_cracklib - PAM module to check the password against dictionary words</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/libpam-cracklib">libpam-cracklib_1.4.0-11ubuntu2.6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_cracklib - PAM module to check the password against dictionary words

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>pam_cracklib.so</b> [<u>...</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module can be plugged into the <u>password</u> stack of a given application to provide some plug-in
       strength-checking for passwords.

       The action of this module is to prompt the user for a password and check its strength against a system
       dictionary and a set of rules for identifying poor choices.

       The first action is to prompt for a single password, check its strength and then, if it is considered
       strong, prompt for the password a second time (to verify that it was typed correctly on the first
       occasion). All being well, the password is passed on to subsequent modules to be installed as the new
       authentication token.

       The strength checks works in the following manner: at first the <b>Cracklib</b> routine is called to check if
       the password is part of a dictionary; if this is not the case an additional set of strength checks is
       done. These checks are:

       Palindrome
           Is the new password a palindrome?

       Case Change Only
           Is the new password the old one with only a change of case?

       Similar
           Is the new password too much like the old one? This is primarily controlled by one argument, <b>difok</b>
           which is a number of character changes (inserts, removals, or replacements) between the old and new
           password that are enough to accept the new password. This defaults to 5 changes.

       Simple
           Is the new password too small? This is controlled by 6 arguments <b>minlen</b>, <b>maxclassrepeat</b>, <b>dcredit</b>,
           <b>ucredit</b>, <b>lcredit</b>, and <b>ocredit</b>. See the section on the arguments for the details of how these work and
           there defaults.

       Rotated
           Is the new password a rotated version of the old password?

       Same consecutive characters
           Optional check for same consecutive characters.

       Too long monotonic character sequence
           Optional check for too long monotonic character sequence.

       Contains user name
           Optional check whether the password contains the user's name in some form.

       This module with no arguments will work well for standard unix password encryption. With md5 encryption,
       passwords can be longer than 8 characters and the default settings for this module can make it hard for
       the user to choose a satisfactory new password. Notably, the requirement that the new password contain no
       more than 1/2 of the characters in the old password becomes a non-trivial constraint. For example, an old
       password of the form "the quick brown fox jumped over the lazy dogs" would be difficult to change... In
       addition, the default action is to allow passwords as small as 5 characters in length. For a md5 systems
       it can be a good idea to increase the required minimum size of a password. One can then allow more credit
       for different kinds of characters but accept that the new password may share most of these characters
       with the old password.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>debug</b>
           This option makes the module write information to <b><a href="../man3/syslog.3.html">syslog</a></b>(3) indicating the behavior of the module
           (this option does not write password information to the log file).

       <b>authtok_type=</b><u>XXX</u>
           The default action is for the module to use the following prompts when requesting passwords: "New
           UNIX password: " and "Retype UNIX password: ". The example word <u>UNIX</u> can be replaced with this
           option, by default it is empty.

       <b>retry=</b><u>N</u>
           Prompt user at most <u>N</u> times before returning with error. The default is <u>1</u>.

       <b>difok=</b><u>N</u>
           This argument will change the default of <u>5</u> for the number of character changes in the new password
           that differentiate it from the old password.

       <b>minlen=</b><u>N</u>
           The minimum acceptable size for the new password (plus one if credits are not disabled which is the
           default). In addition to the number of characters in the new password, credit (of +1 in length) is
           given for each different kind of character (<u>other</u>, <u>upper</u>, <u>lower</u> and <u>digit</u>). The default for this
           parameter is <u>9</u> which is good for a old style UNIX password all of the same type of character but may
           be too low to exploit the added security of a md5 system. Note that there is a pair of length limits
           in <u>Cracklib</u> itself, a "way too short" limit of 4 which is hard coded in and a defined limit (6) that
           will be checked without reference to <b>minlen</b>. If you want to allow passwords as short as 5 characters
           you should not use this module.

       <b>dcredit=</b><u>N</u>
           (N &gt;= 0) This is the maximum credit for having digits in the new password. If you have less than or <u>N</u>
           digits, each digit will count +1 towards meeting the current <b>minlen</b> value. The default for <b>dcredit</b> is
           1 which is the recommended value for <b>minlen</b> less than 10.

           (N &lt; 0) This is the minimum number of digits that must be met for a new password.

       <b>ucredit=</b><u>N</u>
           (N &gt;= 0) This is the maximum credit for having upper case letters in the new password. If you have
           less than or <u>N</u> upper case letters each letter will count +1 towards meeting the current <b>minlen</b> value.
           The default for <b>ucredit</b> is <u>1</u> which is the recommended value for <b>minlen</b> less than 10.

           (N &lt; 0) This is the minimum number of upper case letters that must be met for a new password.

       <b>lcredit=</b><u>N</u>
           (N &gt;= 0) This is the maximum credit for having lower case letters in the new password. If you have
           less than or <u>N</u> lower case letters, each letter will count +1 towards meeting the current <b>minlen</b>
           value. The default for <b>lcredit</b> is 1 which is the recommended value for <b>minlen</b> less than 10.

           (N &lt; 0) This is the minimum number of lower case letters that must be met for a new password.

       <b>ocredit=</b><u>N</u>
           (N &gt;= 0) This is the maximum credit for having other characters in the new password. If you have less
           than or <u>N</u> other characters, each character will count +1 towards meeting the current <b>minlen</b> value.
           The default for <b>ocredit</b> is 1 which is the recommended value for <b>minlen</b> less than 10.

           (N &lt; 0) This is the minimum number of other characters that must be met for a new password.

       <b>minclass=</b><u>N</u>
           The minimum number of required classes of characters for the new password. The default number is
           zero. The four classes are digits, upper and lower letters and other characters. The difference to
           the <b>credit</b> check is that a specific class if of characters is not required. Instead <u>N</u> out of four of
           the classes are required.

       <b>maxrepeat=</b><u>N</u>
           Reject passwords which contain more than N same consecutive characters. The default is 0 which means
           that this check is disabled.

       <b>maxsequence=</b><u>N</u>
           Reject passwords which contain monotonic character sequences longer than N. The default is 0 which
           means that this check is disabled. Examples of such sequence are '12345' or 'fedcb'. Note that most
           such passwords will not pass the simplicity check unless the sequence is only a minor part of the
           password.

       <b>maxclassrepeat=</b><u>N</u>
           Reject passwords which contain more than N consecutive characters of the same class. The default is 0
           which means that this check is disabled.

       <b>reject_username</b>
           Check whether the name of the user in straight or reversed form is contained in the new password. If
           it is found the new password is rejected.

       <b>gecoscheck</b>
           Check whether the words from the GECOS field (usually full name of the user) longer than 3 characters
           in straight or reversed form are contained in the new password. If any such word is found the new
           password is rejected.

       <b>enforce_for_root</b>
           The module will return error on failed check also if the user changing the password is root. This
           option is off by default which means that just the message about the failed check is printed but root
           can change the password anyway. Note that root is not asked for an old password so the checks that
           compare the old and new password are not performed.

       <b>use_authtok</b>
           This argument is used to <u>force</u> the module to not prompt the user for a new password but use the one
           provided by the previously stacked <u>password</u> module.

       <b>dictpath=</b><u>/path/to/dict</u>
           Path to the cracklib dictionaries.

</pre><h4><b>MODULE</b> <b>TYPES</b> <b>PROVIDED</b></h4><pre>
       Only the <b>password</b> module type is provided.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       PAM_SUCCESS
           The new password passes all checks.

       PAM_AUTHTOK_ERR
           No new password was entered, the username could not be determined or the new password fails the
           strength checks.

       PAM_AUTHTOK_RECOVERY_ERR
           The old password was not supplied by a previous stacked module or got not requested from the user.
           The first error can happen if <b>use_authtok</b> is specified.

       PAM_SERVICE_ERR
           A internal error occurred.

</pre><h4><b>EXAMPLES</b></h4><pre>
       For an example of the use of this module, we show how it may be stacked with the password component of
       <b><a href="../man8/pam_unix.8.html">pam_unix</a></b>(8)

           #
           # These lines stack two password type modules. In this example the
           # user is given 3 opportunities to enter a strong password. The
           # "use_authtok" argument ensures that the pam_unix module does not
           # prompt for a password, but instead uses the one provided by
           # pam_cracklib.
           #
           passwd  password required       pam_cracklib.so retry=3
           passwd  password required       pam_unix.so use_authtok

       Another example (in the <a href="file:/etc/pam.d/passwd">/etc/pam.d/passwd</a> format) is for the case that you want to use md5 password
       encryption:

           #%PAM-1.0
           #
           # These lines allow a md5 systems to support passwords of at least 14
           # bytes with extra credit of 2 for digits and 2 for others the new
           # password must have at least three bytes that are not present in the
           # old password
           #
           password  required pam_cracklib.so \
                          difok=3 minlen=15 dcredit= 2 ocredit=2
           password  required pam_unix.so use_authtok nullok md5

       And here is another example in case you don't want to use credits:

           #%PAM-1.0
           #
           # These lines require the user to select a password with a minimum
           # length of 8 and with at least 1 digit number, 1 upper case letter,
           # and 1 other character
           #
           password  required pam_cracklib.so \
                          dcredit=-1 ucredit=-1 ocredit=-1 lcredit=0 minlen=8
           password  required pam_unix.so use_authtok nullok md5

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/pam.conf.5.html">pam.conf</a></b>(5), <b><a href="../man5/pam.d.5.html">pam.d</a></b>(5), <b><a href="../man7/pam.7.html">pam</a></b>(7)

</pre><h4><b>AUTHOR</b></h4><pre>
       pam_cracklib was written by Cristian Gafton &lt;<a href="mailto:gafton@redhat.com">gafton@redhat.com</a>&gt;

Linux-PAM Manual                                   06/08/2020                                    <u><a href="../man8/PAM_CRACKLIB.8.html">PAM_CRACKLIB</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>