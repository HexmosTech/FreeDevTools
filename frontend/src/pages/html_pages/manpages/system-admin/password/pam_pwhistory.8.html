<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_pwhistory - PAM module to remember last passwords</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-runtime">libpam-runtime_1.7.0-5ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_pwhistory - PAM module to remember last passwords

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>pam_pwhistory.so</b> [debug] [use_authtok] [enforce_for_root] [remember=<u>N</u>] [retry=<u>N</u>] [authtok_type=<u>STRING</u>]
                        [file=<u>/path/filename</u>] [conf=<u>/path/to/config-file</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module saves the last passwords for each user in order to force password change history and keep the
       user from alternating between the same password too frequently.

       This module does not work together with kerberos. In general, it does not make much sense to use this
       module in conjunction with NIS or LDAP, since the old passwords are stored on the local machine and are
       not available on another machine for password history checking.

</pre><h4><b>OPTIONS</b></h4><pre>
       debug
           Turns on debugging via <b><a href="../man3/syslog.3.html">syslog</a></b>(3).

       use_authtok
           When password changing enforce the module to use the new password provided by a previously stacked
           <b>password</b> module (this is used in the example of the stacking of the <b>pam_passwdqc</b> module documented
           below).

       enforce_for_root
           If this option is set, the check is enforced for root, too.

       remember=N
           The last <u>N</u> passwords for each user are saved. The default is <u>10</u>. Value of <u>0</u> makes the module to keep
           the existing contents of the opasswd file unchanged.

       retry=N
           Prompt user at most <u>N</u> times before returning with error. The default is <u>1</u>.

       authtok_type=STRING
           See <b><a href="../man3/pam_get_authtok.3.html">pam_get_authtok</a></b>(3) for more details.

       file=/path/filename
           Store password history in file /path/filename rather than the default location. The default location
           is /etc/security/opasswd.

       conf=/path/to/config-file
           Use another configuration file instead of the default /etc/security/pwhistory.conf.

       The options for configuring the module behavior are described in the <b><a href="../man5/pwhistory.conf.5.html">pwhistory.conf</a></b>(5) manual page. The
       options specified on the module command line override the values from the configuration file.

</pre><h4><b>MODULE</b> <b>TYPES</b> <b>PROVIDED</b></h4><pre>
       Only the <b>password</b> module type is provided.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       PAM_AUTHTOK_ERR
           No new password was entered, the user aborted password change or new password couldn't be set.

       PAM_IGNORE
           Password history was disabled.

       PAM_MAXTRIES
           Password was rejected too often.

       PAM_USER_UNKNOWN
           User is not known to system.

</pre><h4><b>EXAMPLES</b></h4><pre>
       An example password section would be:

           #%PAM-1.0
           password     required       pam_pwhistory.so
           password     required       pam_unix.so        use_authtok

       In combination with <b>pam_passwdqc</b>:

           #%PAM-1.0
           password     required       pam_passwdqc.so    config=/etc/passwdqc.conf
           password     required       pam_pwhistory.so   use_authtok
           password     required       pam_unix.so        use_authtok

</pre><h4><b>FILES</b></h4><pre>
       <a href="file:/etc/security/opasswd">/etc/security/opasswd</a>
           Default file with password history

       <a href="file:/etc/security/pwhistory.conf">/etc/security/pwhistory.conf</a>
           Config file for pam_pwhistory options

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/pwhistory.conf.5.html">pwhistory.conf</a></b>(5), <b><a href="../man5/pam.conf.5.html">pam.conf</a></b>(5), <b><a href="../man5/pam.d.5.html">pam.d</a></b>(5), <b><a href="../man7/pam.7.html">pam</a></b>(7) <b><a href="../man3/pam_get_authtok.3.html">pam_get_authtok</a></b>(3)

</pre><h4><b>AUTHOR</b></h4><pre>
       pam_pwhistory was written by Thorsten Kukuk &lt;<a href="mailto:kukuk@thkukuk.de">kukuk@thkukuk.de</a>&gt;

Linux-PAM                                          07/03/2025                                   <u><a href="../man8/PAM_PWHISTORY.8.html">PAM_PWHISTORY</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>