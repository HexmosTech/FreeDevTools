<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mount.lockfs - helper script for the mount command</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bilibop-lockfs">bilibop-lockfs_0.6.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mount.lockfs - helper script for the mount command

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>mount.lockfs</b> <u>FILESYSTEM</u> <u>MOUNTPOINT</u> [<b>MOUNTFLAGS</b>] <b>-o</b> <u>MOUNTOPTIONS</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>/usr/sbin/mount.lockfs</b> is a symlink to <u>/usr/libexec/bilibop/lockfs_mount_helper</u>.  It is used as an helper
       program  by  the  <b><a href="../man8/mount.8.html">mount</a></b>(8)  command  for the '<b>lockfs</b>' filesystem type entries in <u><a href="file:/etc/fstab">/etc/fstab</a></u>.  This script
       cannot be run manually, and fails if the root filesystem is not already managed by  <b>bilibop-lockfs</b>.   The
       expected way to run it and how it does its job are the followings:

       1. Enable  <b>bilibop-lockfs</b>:  set  the  BILIBOP_LOCKFS  variable  to <u>true</u> in <b><a href="../man5/bilibop.conf.5.html">bilibop.conf</a></b>(5) and reboot the
          computer; or reboot the computer and append the '<b>lockfs</b>' kernel parameter to the boot commandline.

       2. One time the future '/' is set as an union filesystem mountpoint from into the initramfs  environment,
          the  temporary  and writable <b><a href="../man5/fstab.5.html">fstab</a></b>(5) on it is modified to replace filesystem types of some entries by
          '<b>lockfs</b>'.  Options are also modified to remember the original fstype.

       3. One time the union mount is the new root filesystem, initscripts are executed: <b><a href="../man5/fstab.5.html">fstab</a></b>(5) is  parsed  by
          '<b>mount</b>  <b>-a</b>',  and then <b><a href="../man8/mount.8.html">mount</a></b>(8) calls <u>mount.lockfs</u> with the proper arguments when a '<b>lockfs</b>' fstype is
          encountered.

       4. <b>mount.lockfs</b> parses arguments and checks if the filesystem has been whitelisted in <b><a href="../man5/bilibop.conf.5.html">bilibop.conf</a></b>(5), or
          not. If it is the case, the filesystem is mounted normally and the fstab entry is modified to  reflect
          the  actual  mount  call. If neither the filesystem nor the mountpoint have been whitelisted, then the
          filesystem is mounted elsewhere and readonly, a temporary filesystem is mounted with  proper  options,
          size,  permissions  and ownership, and an aufs or overlay filesystem (depending on the version of your
          kernel) is mounted on the <u>MOUNTPOINT</u> given as argument  with  the  lower/readonly  and  upper/writable
          branches previously set. The fstab entry is replaced by three lines reflecting the actual mount calls.
          If    something   fails,   <b>mount.lockfs</b>   acts   as   if   the   filesystem   was   whitelisted.   See
          <u>/usr/share/doc/bilibop-lockfs/README.Debian</u> for details.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>lockfs_mount_helper</b> uses options and arguments as they are given by <b><a href="../man8/mount.8.html">mount</a></b>(8)  after  it  has  parsed  the
       corresponding  <b><a href="../man5/fstab.5.html">fstab</a></b>(5) entry. So, options and arguments are mandatory, mount flags are optional, and all
       come in the following order:

       <u>FILESYSTEM</u>
              Corresponding to the first field in fstab. This must be a block device, or a symlink  to  a  block
              device.  If  this field is given with one of the <b>UUID=*</b> or <b>LABEL=*</b> formats, then the mount command
              translates it to the corresponding device name before to call the helper program.

       <u>MOUNTPOINT</u>
              Corresponding to the second field in fstab.

       [<u>MOUNTFLAGS</u>]
              Generic flags passed to the mount commandline (the most usual being <b>-v</b> and <b>-n</b>).

       <u>-o</u> <u>MOUNTOPTIONS</u>
              Corresponding to the fourth field in fstab. The mount options are parsed by the helper script:  if
              <b>fstype=*</b> is encountered, it is removed from the options and used to mount the readonly branch with
              this  filesystem  type.  If <b>ro</b>, <b>noexec</b>, <b>nosuid</b> or <b>nodev</b> options are encountered, they are added to
              the list of mount options of the writable branch.

</pre><h4><b>FILES</b></h4><pre>
       <a href="file:/etc/fstab">/etc/fstab</a>
       /usr/libexec/bilibop/lockfs_mount_helper
       /usr/share/doc/bilibop-lockfs/README.Debian

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/aufs.5.html">aufs</a></b>(5), <b><a href="../man7/bilibop.7.html">bilibop</a></b>(7), <b><a href="../man5/bilibop.conf.5.html">bilibop.conf</a></b>(5), <b><a href="../man5/fstab.5.html">fstab</a></b>(5), <b><a href="../man8/mount.8.html">mount</a></b>(8)

</pre><h4><b>AUTHOR</b></h4><pre>
       This manual page has been written by Bilibop Project &lt;<a href="mailto:quidame@poivron.org">quidame@poivron.org</a>&gt;.

bilibop                                            2020-02-02                                    <u><a href="../man8/MOUNT.LOCKFS.8.html">MOUNT.LOCKFS</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>