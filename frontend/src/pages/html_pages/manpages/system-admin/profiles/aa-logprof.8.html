<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aa-logprof - utility for updating AppArmor security profiles</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/apparmor-utils">apparmor-utils_4.1.1-0ubuntu6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       aa-logprof - utility for updating AppArmor security profiles

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>aa-logprof</b> <b>[</b><u><b>-d</b></u>  <u><b>/path/to/profiles</b></u><b>]</b> <b>[</b><u><b>-f</b></u> <u><b>/path/to/logfile</b></u><b>]</b> <b>[</b><u><b>-m</b></u> <u><b>&lt;mark</b></u> <u><b>in</b></u> <u><b>logfile&gt;</b></u><b>]</b>

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-d</b> <b>--dir</b>   <b>/path/to/profiles</b>

          Specifies where to look for the AppArmor security profile set.
          Defaults to /etc/apparmor.d.

       <b>-f</b> <b>--file</b>   <b>/path/to/logfile</b>

           Specifies the location of logfile that contains AppArmor security events.
               Default locations are read from F&lt;/etc/apparmor/logprof.conf&gt;.
               Typical defaults are:
                        /var/log/audit/audit.log
                        <a href="file:/var/log/syslog">/var/log/syslog</a>
                        /var/log/messages

        <b>-m</b> <b>--logmark</b>    <b>"mark"</b>

          aa-logprof will ignore all events in the system log before the
          specified mark is seen.  If the mark contains spaces, it must
          be surrounded with quotes to work correctly.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>aa-logprof</b> is an interactive tool used to review AppArmor generated messages and update AppArmor security
       profiles.

       Running aa-logprof will scan the log file and if there are new AppArmor events that are not covered by
       the existing profile set, the user will be prompted with suggested modifications to augment the profile.

       When aa-logprof exits profile changes are saved to disk.  If AppArmor is running, the updated profiles
       are reloaded and if any processes that generated AppArmor events are still running in the null-complain-
       profile, those processes are set to run under their proper profiles.

   <b>Responding</b> <b>to</b> <b>AppArmor</b> <b>Events</b>
       <b>aa-logprof</b> will generate a list of suggested profile changes that the user can choose from, or they can
       create their own, to modify the permission set of the profile so that the generated access violation will
       not re-occur.

       The user is then presented with info about the access including profile, path, old mode if there was a
       previous entry in the profile for this path, new mode, the suggestion list, and given these options:

          (A)llow, (D)eny, (I)gnore, (N)ew, (G)lob last piece, (Q)uit

       If the AppArmor profile was in complain mode when the event was generated, the default for this option is
       (A)llow, otherwise, it's (D)eny.

       The (D)eny option adds a "deny" rule to the AppArmor profile, which silences logging.

       The (I)gnore option allows user to ignore the event, without making any changes to the AppArmor profile.

       The suggestion list is presented as a numbered list with includes at the top, the literal path in the
       middle, and the suggested globs at the bottom.  If any globs are being suggested, the shortest glob is
       the selected option, otherwise, the literal path is selected.  Picking includes from the list must be
       done manually.

       Hitting a numbered key will change the selected option to the corresponding numbered entry in the list.

       If the user selects (N)ew, they'll be prompted to enter their own globbed entry to match the path.  If
       the user-entered glob does not match the path for this event, they'll be informed and have the option to
       fix it.

       If the user selects (G)lob last piece then, taking the currently selected option, aa-logprof will remove
       the last path element and replace it with /*.

       If the last path element already was /*, aa-logprof will go up a directory level and replace it with /**.

       This new globbed entry is then added to the suggestion list and marked as the selected option.

       So /usr/share/themes/foo/bar/baz.gif can be turned into /usr/share/themes/** by hitting "g" three times.

       If the user selects (A)llow, aa-logprof will take the current selection and add it to the profile,
       deleting other entries in the profile that are matched by the new entry.

       Adding r access to /usr/share/themes/** would delete an entry for r access to /usr/share/themes/foo/*.gif
       if it exists in the profile.

       If (Q)uit is selected at this point, aa-logprof will ignore all new pending accesses.

       After all of the accesses have been handled, logrof will write all updated profiles to the disk and
       reload them if AppArmor is running.

   <b>New</b> <b>Process</b> <b>(Execution)</b> <b>Events</b>
       If there are unhandled x accesses generated by the <b><a href="../man2/execve.2.html">execve</a></b>(2) of a new process, aa-logprof will display
       the parent profile and the target program that's being executed and prompt the user to select an execute
       modifier. These modifiers will allow a choice for the target to: have it's own profile (px), inherit the
       parent's profile (ix), run unconstrained (ux), or deny access for the target. See <b><a href="../man5/apparmor.d.5.html">apparmor.d</a></b>(5) for
       details.

       If there is a corresponding entry for the target in the qualifiers section of /etc/apparmor/logprof.conf,
       the presented list will contain only the allowed modes.


       The default option for this question is selected using this logic--
         # if px mode is allowed and profile exists for the target
         #   px is default.
         # else if ix mode is allowed
         #   ix is default
         # else
         #   deny is default

       aa-logprof will never suggest "ux" as the default.

   <b>ChangeHat</b> <b>Events</b>
       If unknown <b><a href="../man2/aa_change_hat.2.html">aa_change_hat</a></b>(2) events are found, the user is prompted to add a new hat, if the events should
       go into the default hat for this profile based on the corresponding entry in the defaulthat section of
       logprof.conf, or if the following events that run under that hat should be denied altogether.

   <b>Capability</b> <b>Events</b>
       If there are capability accesses, the user is shown each capability access and asked if the capability
       should be allowed, denied, or if the user wants to quit. See <b><a href="../man7/capability.7.html">capability</a></b>(7) for details.

</pre><h4><b>BUGS</b></h4><pre>
       If you find any bugs, please report them at &lt;https://gitlab.com/apparmor/apparmor/-/issues&gt;.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/klogd.8.html">klogd</a></b>(8), <b><a href="../man8/auditd.8.html">auditd</a></b>(8), <b><a href="../man7/apparmor.7.html">apparmor</a></b>(7), <b><a href="../man5/apparmor.d.5.html">apparmor.d</a></b>(5), <b><a href="../man2/aa_change_hat.2.html">aa_change_hat</a></b>(2), <b><a href="../man5/logprof.conf.5.html">logprof.conf</a></b>(5), <b><a href="../man1/aa-genprof.1.html">aa-genprof</a></b>(1),
       <b><a href="../man1/aa-enforce.1.html">aa-enforce</a></b>(1), <b><a href="../man1/aa-complain.1.html">aa-complain</a></b>(1), <b><a href="../man1/aa-disable.1.html">aa-disable</a></b>(1), and &lt;https://wiki.apparmor.net&gt;.

AppArmor 4.1.1                                     2025-07-23                                      <u><a href="../man8/AA-LOGPROF.8.html">AA-LOGPROF</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>