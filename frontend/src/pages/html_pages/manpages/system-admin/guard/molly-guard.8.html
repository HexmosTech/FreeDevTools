<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>molly-guard - guard against accidental shutdowns/reboots</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/molly-guard">molly-guard_0.8.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       molly-guard - guard against accidental shutdowns/reboots

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>shutdown</b> [-<b>hV</b>] [<b>--molly-guard-do-nothing</b>] [-- <u>script_options</u>]

       <b>halt</b> [-<b>hV</b>] [<b>--molly-guard-do-nothing</b>] [-- <u>script_options</u>]

       <b>reboot</b> [-<b>hV</b>] [<b>--molly-guard-do-nothing</b>] [-- <u>script_options</u>]

       <b>poweroff</b> [-<b>hV</b>] [<b>--molly-guard-do-nothing</b>] [-- <u>script_options</u>]

       <b>coldreboot</b> [-<b>hV</b>] [<b>--molly-guard-do-nothing</b>] [-- <u>script_options</u>]

       <b>pm-hibernate</b> [-<b>hV</b>] [<b>--molly-guard-do-nothing</b>] [-- <u>script_options</u>]

       <b>pm-suspend</b> [-<b>hV</b>] [<b>--molly-guard-do-nothing</b>] [-- <u>script_options</u>]

       <b>pm-suspend-hybrid</b> [-<b>hV</b>] [<b>--molly-guard-do-nothing</b>] [-- <u>script_options</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>molly-guard</b> attempts to prevent you from accidentally shutting down or rebooting machines. It does this
       by injecting a couple of checks before the existing commands: <b>coldreboot</b>, <b>halt</b>, <b>reboot</b>, <b>shutdown</b>,
       <b>poweroff</b>, <b>pm-hibernate</b>,<b>pm-suspend</b> and <b>pm-suspend-hybrid</b>.

       Before <b>molly-guard</b> invokes the real command, all scripts in /etc/molly-guard/run.d/ have to run and exit
       successfully; else, it aborts the command.  <b><a href="../man1/run-parts.1.html">run-parts</a>(1)</b> is used to process the directory.

       <b>molly-guard</b> passes any <u>script_options</u> to the scripts, and also populates the environment with the
       following variables:

       •   <b>MOLLYGUARD_CMD</b> - the actual command invoked by the user.

       •   <b>MOLLYGUARD_DO_NOTHING</b> - set to <b>1</b> if this is a demo-run.

       •   <b>MOLLYGUARD_SETTINGS</b> - the path to a shell script snippet which scripts can source to obtain settings.

       <b>molly-guard</b> prints the contents of /etc/molly-guard/messages.d/COMMAND or
       /etc/molly-guard/messages.d/default to the console, if either exists. This is due to
       /etc/molly-guard/run.d/10-print-message.

</pre><h4><b>GUARDING</b> <b>SSH</b> <b>SESSIONS</b></h4><pre>
       <b>molly-guard</b> was primarily designed to shield SSH connections. This functionality (which should arguably
       be provided by the openssh-server package) is implemented in /etc/molly-guard/run.d/30-query-hostname.

       This script first tests whether the command is being executed from a tty which has been created by <b>sshd</b>.
       It also checks whether the variable <b>SSH_CONNECTION</b> is defined. If any of these tests are successful, test
       script queries the user for the machine's hostname, which should be sufficient to prevent the user from
       doing something by accident.

       You can pass the <b>--pretend-ssh</b> script option to <b>molly-guard</b> to pretend that those tests succeeds.
       Alternatively, setting <b>ALWAYS_QUERY_HOSTNAME</b> in /etc/molly-guard/rc causes the script to always query.

       The following situations are still UNGUARDED. If you can think of ways to protect against those, please
       let me know!

       •   running sudo within screen or screen within sudo; sudo eats the <b>SSH_CONNECTION</b> variable, and screen
           creates a new pty.

       •   executing those command in a remote terminal window, that is a XTerm started on a remote machine but
           displaying on the local X server.

       You have been warned. You can use the <b>--molly-guard-do-nothing</b> switch to prevent anything from happening,
       e.g.  <b>halt</b> <b>--molly-guard-do-nothing</b>.

</pre><h4><b>OPTIONS</b></h4><pre>
       --molly-guard-do-nothing
           Cause <b>molly-guard</b> to print the command which would be executed, after processing all scripts, instead
           of executing it.

       -h, --help
           Display usage information.

       -V, --version
           Display version information.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/shutdown.8.html">shutdown</a></b>(8), <b><a href="../man1/halt.1.html">halt</a></b>(1), <b><a href="../man8/reboot.8.html">reboot</a></b>(8), <b><a href="../man8/poweroff.8.html">poweroff</a></b>(8).  <b><a href="../man8/coldreboot.8.html">coldreboot</a></b>(8).  <b><a href="../man8/pm-hibernate.8.html">pm-hibernate</a></b>(8).  <b><a href="../man8/pm-suspend.8.html">pm-suspend</a></b>(8).  <b><a href="../man8/pmsuspend-hybrid.8.html">pm-</a></b>
       <b><a href="../man8/pmsuspend-hybrid.8.html">suspend-hybrid</a></b>(8).

</pre><h4><b>LEGALESE</b></h4><pre>
       molly-guard is copyright by martin f. krafft. Andrew Ruthven came up with the idea of using the scripts
       directory and submitted a patch, which I modified a bit.

       This manual page was written by martin f. krafft &lt;<a href="mailto:madduck@madduck.net">madduck@madduck.net</a>&gt;.

       Permission is granted to copy, distribute and/or modify this document under the terms of the Artistic
       License 2.0

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright © 2008 martin f. krafft

[FIXME: source]                                   Apr 19, 2008                                    <u><a href="../man8/MOLLY-GUARD.8.html">MOLLY-GUARD</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>