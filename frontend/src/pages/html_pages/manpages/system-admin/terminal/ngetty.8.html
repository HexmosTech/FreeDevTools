<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ngetty - daemon for virtual console terminals</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ngetty">ngetty_1.1-13_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>ngetty</b> - daemon for virtual console terminals

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ngetty</b> [ tty1 | vc/1 | 1 ] [ /dev/tty2 | vc/2 | 2 ] ...
       <b>ngetty-helper</b> /dev/ttyX [ login ]
       <b>ngetty-argv</b> :options:child:[name]:args [user [tty]]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>ngetty</b>  is  a  daemon  that  starts login sessions on virtual console terminals, on demand.  It opens the
       virtual console terminals specified by the <u>tty...</u>  arguments, displays a <u><a href="file:/etc/issue">/etc/issue</a></u> message,  prints  the
       login prompt on each terminal and waits for user name.  On user action, <b>ngetty</b> executes <b><a href="../man1/login.1.html">login</a></b>(1) in a new
       process with the terminal the user is typing in as the controlling terminal.

       <b><a href="../man1/login.1.html">login</a></b>(1)  then  prompts  for  a  password  to  login  with the system and finally, if the login succeeds,
       executes the user's login shell.

       When the user logs out, <b>ngetty</b> restarts the corresponding virtual console terminal.

       Actually almost the whole work is done by a <b>ngetty-helper</b> program.  It makes <u><a href="file:/var/run/utmp">/var/run/utmp</a></u>, <u><a href="file:/var/log/wtmp">/var/log/wtmp</a></u>
       records, prints <u><a href="file:/etc/issue">/etc/issue</a></u>, hostname, login prompt, waits for user  name.   <b>ngetty</b>  invokes  the  <b>ngetty-</b>
       <b>helper</b> by need.

</pre><h4><b>HISTORY</b></h4><pre>
       The  traditional  way  to  enable  logins  on  virtual  console terminals is to start a bunch of <b><a href="../man8/getty.8.html">getty</a></b>(8)
       programs, one for each virtual console terminal, from <b><a href="../man8/init.8.html">init</a></b>(8).  As most users  rarely  login  on  virtual
       console  terminals  nowadays,  preferring  graphical  logins instead, it seems wasteful to have all those
       <b><a href="../man8/getty.8.html">getty</a></b>(8) processes doing nothing but wasting memory.  Alternatively, <b>ngetty</b> manages logins on any  number
       of virtual console terminals from a single, light, process.

</pre><h4><b>INVOCATION</b></h4><pre>
       <b>ngetty</b> does not use stdin, stdout or stderr and closes them.

       When  running <b>ngetty</b> in the background, remember to disassociate it from the current controlling terminal
       by making it the process group leader of a new session, e.g.:

           setsid ngetty tty...  &amp;
           ngetty-argv :-D:-S:-e:--:/usr/sbin/ngetty::1:2:3:4

       To start <b>ngetty</b> from <b><a href="../man8/init.8.html">init</a></b>(8), add something like this to <u>/etc/inittab</u>:

              ng:2345:respawn:/usr/sbin/ngetty tty1 tty2 ... tty6

       If <b>ngetty-argv</b> is available use it to start ngetty from <u>/etc/inittab</u>.  See the example below.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       If <b>ngetty</b> can not open one of the virtual console terminals specified  in  the  <u>tty...</u>   arguments,  most
       likely  because  that  <u>tty</u>  device  node  does  not  exist, no greeting message will be displayed on that
       terminal, obviously, and <b>ngetty</b> will simply go on, ignoring the offending terminal.  Create  the  missing
       <u>tty</u>  device and send SIGCHLD to ngetty.  Then it will reopen the new <u>tty</u>.  Instead of sending SIGCHLD you
       can login and logout on some working <u>tty</u>.  This also forces ngetty to reopen the new <u>tty</u>.

       <b>ngetty</b> uses <b>ngetty-helper</b> program.  It's path  is  hard-coded  in  <b>ngetty</b>.   Never  remove  <b>ngetty-helper</b>
       program nor move it to other location.

       If,  on  user  action,  <b>ngetty-helper</b> can not execute <b><a href="../man1/login.1.html">login</a></b>(1), in all likelihood because the compiled-in
       <b>LOGIN</b> path does not match your system's <b><a href="../man1/login.1.html">login</a></b>(1) path, <b>ngetty</b> restarts the terminal  and  redisplays  the
       greeting message.

       In any case, <b>ngetty</b> does not output error messages.

</pre><h4><b>OPTIONS</b></h4><pre>
       It's possible to set different options for <b>ngetty-helper</b> program in file <u>/etc/ngetty/Conf</u>.  If the option
       begin  with  "=" it's applied for all tty.  If it start with a tty name it's applied only on current tty.
       Examples:

              <b>#</b> <b>options</b> <b>format:</b>
              <b>#</b> <b>[ttyX]=option[=value]</b>
              <b>#=debug</b>
              =environ=,TERM=linux
              tty3=long-hostname
              tty1=clear=\033c
              =newline=
              =timeout=180
              tty1=timeout=60
              tty1=delay=1

       For security reasons <b>ngetty-helper</b> evaluate the file <u>/etc/ngetty/Conf</u> only if it has mode:

              -rw-------    root   root   /etc/ngetty/Conf

       <b>ngetty-helper</b> recognizes the following options which might be embedded in the <u>/etc/ngetty/Conf</u> file:

       <b>#</b> <b>tty5=login-prog=/bin/login.test</b>
              If a line starts with <b>#</b>, <b>space</b> or <b>tab</b> it is a comment.

       <b>debug</b>  If debug is set <b>ngetty-helper</b> write on terminal all successfully applied options.  Set this on the
              fist line of <u>/etc/ngetty/Conf</u> file.

       <b>date-string</b>
              Escape <b>\d</b> (current day) in <u><a href="file:/etc/issue">/etc/issue</a></u> as:
              <b>Fri</b> <b>Jun</b> <b>01</b> <b>2007</b>.  Default is: <b>2007-06-01</b>.

       <b>days=string</b>
              Abbreviation for week days (21 bytes).  Default is:
              <b>=days=SunMonTueWedThuFriSat</b>

       <b>months=string</b>
              Abbreviation for months (36 bytes).  Default is:
              <b>=months=JanFebMarAprMayJunJulAugSepOctNovDec</b>

       <b>tz=string</b>
              Change the timezone offset.  If the string starts with slash it's the name of tzfile.  The  string
              is  positive  number  if  the  local time zone is east of the Prime Meridian and negative if it is
              west.  Default is <u><a href="file:/etc/localtime">/etc/localtime</a></u>.  Examples:
              <b>=tz=-18000</b>        -0500
              <b>=tz=7200</b>          +0200
              <b>=tz=<a href="file:/etc/localtime">/etc/localtime</a></b>
              <b>=tz=AUTO</b>

       <b>echo-off</b>
              Turn the echo off just before starting /bin/login.  It's similar to <b>stty</b> <b>-echo</b>.

       <b>newline=string</b>
              Print this <b>string</b> before writing out <u><a href="file:/etc/issue">/etc/issue</a></u>.  (default is <b>\012</b>).  Example:
              <b>tty3=newline=\012I</b> <b>am</b> <b>\l\012</b>

       <b>clear=string</b>
              Clear the screen before prompting  for  the  login  name  with  the  <b>string</b>  (default  is  <b>\033c</b>).
              Examples:
              <b>tty1=clear=</b>
              <b>tty3=clear=\033[H\033[J</b>

       <b>noclear-first=/etc/ngetty/.noclear</b>
              Do not clear the screen before prompting for the login name the first time after reboot.  Example:
              <b>tty1=noclear-first=/etc/ngetty/.noclear.tty1</b>

       <b>nohangup</b>
              Do not call vhangup() to disable writing to this tty by other applications.

       <b>long-hostname</b>
              By  default  the hostname is only printed until the first dot.  With this option enabled, the full
              text from gethostname() is shown.

       <b>nousername</b>
              Do not ask for user name.  Exec <a href="../man1/login.1.html">login</a>(1) immediately.  Example:
              <b>=nousername</b>
              <b>=login-prompt=</b> <b>Press</b> <b>ENTER</b> <b>to</b> <b>activate</b> <b>\l</b>

       <b>deny=,black,list,users...</b>
              Disable login process for some users.  The first char after "deny=" is split char.  Example:
              <b>tty1=deny=,root,nobody,guest</b>

       <b>allow=,white,list,users...</b>
              Enable login process only for the users.  The first char after "allow=" is split char.  Example:
              <b>=clear=</b>
              <b>=allow=,root,operator</b>

       <b>print=an:CM:PY:04:69</b>
              Accept only these chars in user name.  Default is  to  accept  only  "<b>,-._</b>  <b>0-9</b>  <b>a-z</b>  <b>A-Z</b>".   It's
              possible to insert here the output of
              <b>printf</b> <b>'tty3=print=az:AZ:\ABC\XYZ:__'</b>
              Here <b>ABC</b> and <b>XYZ</b> are octal numbers.  Examples:
              <b>tty1=print=az:AZ</b>
              <b>tty2=print=az:AZ:__:,.:09</b>

       <b>issue-file=<a href="file:/etc/issue">/etc/issue</a></b>
              Change the issue file.  Disable printing of the issue file with:
              <b>=issue-file=</b>

       <b>login-prog=<a href="file:/bin/login">/bin/login</a></b>
              Change the login app.  It's possible to use fgetty's <u>/bin/login1</u> application with:
              <b>=echo-off</b>
              <b>=login-prog=/bin/login1</b>

       <b>login-buffer=string</b>
              Read login name over the <b>string</b>.  Default string is 40 bytes long.  Example:
              <b>=login-buffer=12345678901234567</b>

       <b>login-prompt=\n</b> <b>login:</b>
              Change the login prompt string.  Example:
              <b>=login-prompt=\033[1;33m\l\033[0;39m</b>  <b>\n</b> <b>login:</b>

       <b>nice=10</b>
              Change the priority by calling nice().

       <b>delay=5</b>
              Sleep this many seconds before printing the file /etc/issue.

       <b>timeout=180</b>
              Wait at most this many seconds for user name.

       <b>chdir=<a href="file:/home">/home</a></b>
              Change into this directory before calling the login prog.

       <b>chroot=/chroot</b>
              Call chroot() with this directory name.

       <b>autologin-name=username</b>
              Log  the  specified user automatically in without asking for a login name and password.  Check the
              -f option from <b><a href="file:/bin/login">/bin/login</a></b> for this.  Example:
              <b>tty1=autologin-name=maria</b>

       <b>autologin-first=/etc/ngetty/.autologin</b>
              Log in automatically only the first time  after  reboot  without  asking  for  a  login  name  and
              password.  Example:
              <b>tty1=autologin-name=maria</b>
              <b>tty1=autologin-first=/etc/ngetty/.autologin</b>

       <b>environ=,TERM=linux</b>
              Replace the environ.  The first char after "environ=" is split char.  Examples:
              <b>=environ=,TERM=vt100,PATH=<a href="file:/bin">/bin</a>:<a href="file:/usr/bin">/usr/bin</a>,HOME=/</b>
              <b>tty3=environ=,TERM=linux,TTY=/dev/tty3</b>

       <b>sh-A=line</b>
              Exec this line before printing <u><a href="file:/etc/issue">/etc/issue</a></u>.  The line is executed using <b><a href="file:/bin/sh">/bin/sh</a></b> <b>-c</b> <u>line</u>.  It's good
              idea to use the full paths here.  Example:
              <b>tty4=sh-A=exec</b> <b><a href="file:/bin/ps">/bin/ps</a></b> <b>e</b> <b>-u</b> <b>root</b>
              <b>tty4=delay=8</b>

       <b>sh-B=line</b>
              Similar to option <b>sh-A.</b>  This is executed before asking for username.

       <b>login-argv=any_string</b>
              Ngetty starts login application with options
              <b>login</b> <b>--</b> <b>XYZ</b>      # default
              <b>login</b> <b>-f</b> <b>XYZ</b>      # if autologin-name=XYZ
              With this option it's possible to start login appl with <b>any_string</b> instead of <b>--</b> or <b>-f</b>.  Using the
              program  <b><a href="../man8/ngetty-argv.8.html">ngetty-argv</a></b>(8)  one  can  start  arbitrary  program  with  different arguments.  Two very
              dangerous examples are (never try them):
              <b>tty4=login-prog=/usr/sbin/ngetty-argv</b>
              <b>tty5=login-prog=/usr/sbin/ngetty-argv</b>
              <b>tty4=login-argv=,<a href="file:/bin/login">/bin/login</a>,,-f,%U</b>
              <b>tty5=login-argv=:-C:<a href="file:/bin/bash">/bin/bash</a>:-bash</b>

</pre><h4><b>WARNING</b></h4><pre>
       If ngetty-helper finds stdout or stderr open it exits immediately with  error  100.   Ngetty  invokes  it
       correctly.  See also the program test-helper.c in source package.

       Do not edit the file <u>/etc/ngetty/Conf</u> directly.  Put the configurations in <u>/etc/ngetty/Conf.sed</u> (the same
       syntax and permissions as <u>/etc/ngetty/Conf</u>) and after editing it, execute:

              <b>cd</b> <b>/etc/ngetty</b> <b>&amp;&amp;</b> <b>./setup</b>

       The  script  <u>/etc/ngetty/setup</u>  removes  comments,  merges  lines ending with a backslash and expands the
       string <b>=tz=AUTO</b> to numeric number.  Then it updates <u>/etc/ngetty/Conf</u>.

</pre><h4><b>SIGNALS</b></h4><pre>
       If ngetty receives SIGTERM it kill all child's PID (first with SIGTERM and then with  SIGKILL)  and  exit
       immediately.  It does not change UID, GID and mode of the controlling tty devices.  It does not catch the
       other  signals.   Sending  SIGCHLD to ngetty forces it to reread his internal cache tables and to restart
       failed tty devices.

</pre><h4><b>ISSUE</b> <b>ESCAPES</b></h4><pre>
       <b>ngetty-helper</b> recognizes the following escapes sequences which might be  embedded  after   <b>login-prompt=</b>,
       <b>newline=</b>, <b>clear=</b> or in the <u><a href="file:/etc/issue">/etc/issue</a></u> file:

       <b>\d</b>     insert current day (localtime),

       <b>\l</b>     insert line on which <b>ngetty</b> is running,

       <b>\m</b>     inserts machine architecture (uname -m),

       <b>\n</b>     inserts machine's network node hostname (uname -n),

       <b>\o</b>     inserts domain name,

       <b>\r</b>     inserts operating system release (uname -r),

       <b>\t</b>     insert current time (localtime),

       <b>\s</b>     inserts operating system name,

       <b>\u</b>     insert the number of users which are currently logged in,

       <b>\U</b>     insert  the   string   "1  user" or "&lt;n&gt; users", where &lt;n&gt; is the number of users currently logged
              in,

       <b>\v</b>     inserts operating system version (uname -v).

       <b>\XYZ</b>   inserts a letter with octal code XYZ.

</pre><h4><b>EXAMPLE</b></h4><pre>
       "<b>Linux</b> <b>eos</b> <b>i386</b> <b>#1</b> <b>Tue</b> <b>Mar</b> <b>19</b> <b>21:54:09</b> <b>MET</b> <b>1996</b>" was produced by putting "<b>\s</b> <b>\n</b> <b>\m</b> <b>\v</b>" into <u><a href="file:/etc/issue">/etc/issue</a></u>.

</pre><h4><b>NGETTY-ARGV</b></h4><pre>
       The program <b><a href="../man8/ngetty-argv.8.html">ngetty-argv</a></b>(8) splits argv[1] on strings, expands <b>%U</b> and <b>%T</b> to  username  and  tty  and  then
       start  the  the  application.   The  first char after "login-argv=" is split char.  In the examples above
       every user logs on tty4 without password and tty5 is always root.  To understand better  how  <b>ngetty-argv</b>
       works try as non-root:

       <b>ngetty-argv</b> <b>':<a href="file:/bin/echo">/bin/echo</a>:echo:%U:</b> <b>on</b> <b>%T'</b> <b>usr</b> <b>tty3</b>
       <b>ngetty-argv</b> <b>':<a href="file:/bin/sleep">/bin/sleep</a>:-hacker:39:I</b> <b>am</b> <b>%U</b> <b>on</b> <b>%T'</b> <b>123</b> <b>X</b>

       One can put also options for ngetty-argv at the beginning.

              <b>--</b>         last option

              <b>-u503</b>      setuid to 503

              <b>-g230</b>      setgid to 230

              <b>-a120</b>      exec <a href="../man120/alarm.120.html">alarm</a>(120) before starting child

              <b>-s10</b>       sleep 10 secs before starting child

              <b>-d/X/YZ</b>    chdir(/X/YZ)  before starting child

              <b>-r/A/BC</b>    chroot(/A/BC) before starting child

              <b>-D</b>         start the child in background and exit

              <b>-N</b> <b>-C</b>      NOTTY | SCTTY controlling tty

              <b>-S</b>         like <b><a href="../man8/setsid.8.html">setsid</a></b>(8)

              <b>-e,HOME=/,TERM=linux</b>     same as <b>environ=</b> above

              <b>-p/path/to/pid.file</b>      write the child pid here

       One possible example for <b>/etc/ngetty/Conf</b> is:
           tty9=clear=
           tty9=issue-file=
           tty9=login-prompt=\n  \d \t  qmail-qread:
           tty9=login-prog=/usr/sbin/ngetty-argv
           tty9=login-argv=:-u106:-g503:-d/var/qmail:--
             :./bin/qmail-qread:qread

       Another example is setting the TTY environ automatically:
           =login-prog=/usr/sbin/ngetty-argv
           =login-argv=:-e,TTY=<a href="file:/dev/">/dev/</a>%T,TERM=linux:--
             :<a href="file:/bin/login">/bin/login</a>:login-%T:--:%U

       I recommend using <b>ngetty-argv</b>  in <u>/etc/inittab</u> also.  Put as last argument runlevel string.  Then ps will
       show <b>ngetty-2345</b> instead of <b>ngetty</b>.  Next start tty1 ... tty6 on runlevels 2345.
           ng:<b>2345</b>:respawn:/usr/sbin/ngetty-argv
             .-e.-S.-d/.-s1.--.<a href="file:/usr/sbin/">/usr/sbin/</a>%U.%U-%T.1.2.3.4.5.6
             ngetty <b>2345</b>

       On a terminal (in scripts) start ngetty with
           ngetty-argv .-N.-S.-e.<a href="file:/usr/sbin/">/usr/sbin/</a>%U.%U.8.9.10 ngetty
           ngetty-argv .-D.-S.-e.<a href="file:/usr/sbin/">/usr/sbin/</a>%U.%U.8.9.10 ngetty

       This  program is a hack written for <b>ngetty-helper</b>.  There is no additional code in ngetty-helper and it's
       possible to start a program with any  args.   It  is  like  a  filter  between  ngetty-helper  and  login
       application.   One  can  easy  modify  it without touching ngetty-helper.  It's similar to DJB well known
       <b><a href="../man1/argv0.1.html">argv0</a></b>(1) and <b><a href="../man8/setuidgid.8.html">setuidgid</a></b>(8).  You can write own such programs and use them instead of ngetty-argv.

</pre><h4><b>FILES</b></h4><pre>
       /etc/ngetty/Conf        <b>ngetty-helper</b> configuration file
       /etc/ngetty/Conf.sed    private setup file
       /etc/ngetty/setup       updates <b>Conf.sed</b> <b>-&gt;</b> <b>Conf</b>
       <a href="file:/etc/issue">/etc/issue</a>              printed before the login prompt
       <a href="file:/var/run/utmp">/var/run/utmp</a>           the system status file
       <a href="file:/var/log/wtmp">/var/log/wtmp</a>           the system logging file
       /etc/inittab            <b><a href="../man8/init.8.html">init</a></b>(8) configuration file

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/getty.8.html">getty</a></b>(8) <b><a href="../man8/fgetty.8.html">fgetty</a></b>(8) <b><a href="../man8/mingetty.8.html">mingetty</a></b>(8)
       <b><a href="../man1/login.1.html">login</a></b>(1) <b><a href="../man1/nlogin.1.html">nlogin</a></b>(1) <b><a href="../man1/argv0.1.html">argv0</a></b>(1) <b><a href="../man8/setuidgid.8.html">setuidgid</a></b>(8) <b><a href="../man1/stty.1.html">stty</a></b>(1)
       <a href="http://sites.google.com/site/anbadeol/logind">http://sites.google.com/site/anbadeol/logind</a>

</pre><h4><b>AUTHOR</b></h4><pre>
       Nikola Vladov
       <a href="http://riemann.fmi.uni-sofia.bg/ngetty/">http://riemann.fmi.uni-sofia.bg/ngetty/</a>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2007,2008,2010 Nikola Vladov

       This program is free software; you can redistribute it and/or modify  it  under  the  terms  of  the  GNU
       General  Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This program is distributed in the hope that it will be useful, but WITHOUT ANY  WARRANTY;  without  even
       the  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

                                                    May 2010                                           <u><a href="../man8/NGETTY.8.html">NGETTY</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>