<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_tty_audit - Enable or disable TTY auditing for specified users</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-runtime">libpam-runtime_1.7.0-5ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_tty_audit - Enable or disable TTY auditing for specified users

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>pam_tty_audit.so</b> [disable=<u>patterns</u>] [enable=<u>patterns</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The pam_tty_audit PAM module is used to enable or disable TTY auditing. By default, the kernel does not
       audit input on any TTY.

</pre><h4><b>OPTIONS</b></h4><pre>
       disable=patterns
           For each user matching <u>patterns</u>, disable TTY auditing. This overrides any previous <b>enable</b> option
           matching the same user name on the command line. See NOTES for further description of <u>patterns</u>.

       enable=patterns
           For each user matching <u>patterns</u>, enable TTY auditing. This overrides any previous <b>disable</b> option
           matching the same user name on the command line. See NOTES for further description of <u>patterns</u>.

       open_only
           Set the TTY audit flag when opening the session, but do not restore it when closing the session.
           Using this option is necessary for some services that don't <b>fork()</b> to run the authenticated session,
           such as <b>sudo</b>.

       log_passwd
           Log keystrokes when ECHO mode is off but ICANON mode is active. This is the mode in which the tty is
           placed during password entry. By default, passwords are not logged. This option may not be available
           on older kernels (3.9?).

</pre><h4><b>MODULE</b> <b>TYPES</b> <b>PROVIDED</b></h4><pre>
       Only the <b>session</b> type is supported.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       PAM_SESSION_ERR
           Error reading or modifying the TTY audit flag. See the system log for more details.

       PAM_SUCCESS
           Success.

</pre><h4><b>NOTES</b></h4><pre>
       When TTY auditing is enabled, it is inherited by all processes started by that user. In particular,
       daemons restarted by a user will still have TTY auditing enabled, and audit TTY input even by other users
       unless auditing for these users is explicitly disabled. Therefore, it is recommended to use <b>disable=*</b> as
       the first option for most daemons using PAM.

       To view the data that was logged by the kernel to audit use the command <b>aureport</b> <b>--tty</b>.

       The <u>patterns</u> are comma separated lists of glob patterns or ranges of uids. A range is specified as
       <u>min_uid</u>:<u>max_uid</u> where one of these values can be empty. If <u>min_uid</u> is empty only user with the uid
       <u>max_uid</u> will be matched. If <u>max_uid</u> is empty users with the uid greater than or equal to <u>min_uid</u> will be
       matched.

       Please note that passwords in some circumstances may be logged by TTY auditing even if the <b>log_passwd</b> is
       not used. For example, all input to an ssh session will be logged - even if there is a password being
       typed into some software running at the remote host because only the local TTY state affects the local
       TTY auditing.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Audit all administrative actions.

           session   required pam_tty_audit.so disable=* enable=root

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/aureport.8.html">aureport</a></b>(8), <b><a href="../man5/pam.conf.5.html">pam.conf</a></b>(5), <b><a href="../man5/pam.d.5.html">pam.d</a></b>(5), <b><a href="../man7/pam.7.html">pam</a></b>(7)

</pre><h4><b>AUTHOR</b></h4><pre>
       pam_tty_audit was written by Miloslav Trmaƒç &lt;<a href="mailto:mitr@redhat.com">mitr@redhat.com</a>&gt;. The log_passwd option was added by Richard
       Guy Briggs &lt;<a href="mailto:rgb@redhat.com">rgb@redhat.com</a>&gt;.

Linux-PAM                                          07/03/2025                                   <u><a href="../man8/PAM_TTY_AUDIT.8.html">PAM_TTY_AUDIT</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>