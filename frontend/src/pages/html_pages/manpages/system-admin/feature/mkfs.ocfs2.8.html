<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mkfs.ocfs2 - Creates an OCFS2 file system.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ocfs2-tools">ocfs2-tools_1.8.8-3build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mkfs.ocfs2 - Creates an <u>OCFS2</u> file system.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>mkfs.ocfs2</b>  [<b>-b</b>  <u>block-size</u>] [<b>-C</b> <u>cluster-size</u>] [<b>-L</b> <u>volume-label</u>] [<b>-M</b> <u>mount-type</u>] [<b>-N</b> <u>number-of-nodes</u>] [<b>-J</b>
       <u>journal-options</u>] [<b>--fs-features=</b><u>[no]sparse...</u>]  [<b>--fs-feature-level=</b><u>feature-level</u>]  [<b>-T</b>  <u>filesystem-type</u>]
       [<b>--cluster-stack=</b><u>stackname</u>]  [<b>--cluster-name=</b><u>clustername</u>]  [<b>--global-heartbeat</b>] [<b>--discard</b> <b>|</b> <b>--nodiscard</b>]
       [<b>-FqvV</b>] <u>device</u> [<u>blocks-count]</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>mkfs.ocfs2</b> is used to create an <u>OCFS2</u> file system on a <u>device</u>, usually a partition on a shared  disk.  In
       order  to prevent data loss, <b>mkfs.ocfs2</b> will not format an existing <u>OCFS2</u> volume if it detects that it is
       mounted on another node in the cluster. This tool requires the cluster service to be online.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-b,</b> <b>--block-size</b> <u>block-size</u>
              Valid block size values are 512, 1K, 2K and 4K bytes per  block.  If  omitted,  a  value  will  be
              heuristically  determined  based  on  the expected usage of the file system (see the <b>-T</b> option). A
              block size of 512 bytes is never recommended. Choose 1K, 2K or 4K.

       <b>-C,</b> <b>--cluster-size</b> <u>cluster-size</u>
              Valid cluster size values are 4K, 8K, 16K, 32K, 64K, 128K, 256K, 512K and 1M. If omitted, a  value
              will  be  heuristically  determined  based  on  the  expected usage of the file system (see the <b>-T</b>
              option). For volumes expected to store large files, like database files, while a cluster  size  of
              128K  or  more is recommended, one can opt for a smaller size as long as that value is not smaller
              than the database block size.  For others, use 4K.

       <b>-F,</b> <b>--force</b>
              For existing <u>OCFS2</u> volumes, <u>mkfs.ocfs2</u> ensures the volume is  not  mounted  on  any  node  in  the
              cluster  before formatting. For that to work, <u>mkfs.ocfs2</u> expects the cluster service to be online.
              Specify this option to disable this check.

       <b>-J,</b> <b>--journal-options</b> <u>options</u>
              Create the journal using  options  specified  on  the  command-line.  Journal  options  are  comma
              separated,  and  may  take  an  argument  using  the  equals ('=') sign. The following options are
              supported:

              <b>size</b>=<u>journal-size</u>
                     Create a journal of size <u>journal-size</u>.  Minimum  size  is  4M.   If  omitted,  a  value  is
                     heuristically determined based upon the file system size.

              <b>block32</b>
                     Use  a  standard  32bit  journal.   The journal will be able to access up to 2^32-1 blocks.
                     This is the default.  It has been the journal format for <u>OCFS2</u> volumes since the beginning.
                     The journal is compatible with all versions of <u>OCFS2</u>.  Prepending <b>no</b> is equivalent  to  the
                     <b>block64</b> journal option.

              <b>block64</b>
                     Use  a 64bit journal.  The journal will be able to access up to 2^64-1 blocks.  This allows
                     large filesystems that can extend to the theoretical limits of <u>OCFS2</u>.  It requires  a  new-
                     enough  filesystem driver that uses the new journalled block device, <b>JBD2</b>. Prepending <b>no</b> is
                     equivalent to the <b>block32</b> journal option.

       <b>-L,</b> <b>--label</b> <u>volume-label</u>
              Set the volume label for the file system. This is useful for mounting-by-label. Limit the label to
              under 64 bytes.

       <b>-M,</b> <b>--mount</b> <u>mount-type</u>
              Valid types are <u>local</u> and <u>cluster</u>. Local mount allows  users  to  mount  the  volume  without  the
              cluster overhead and works only with <u>OCFS2</u> bundled with Linux kernels 2.6.20 or later. Defaults to
              <u>cluster</u>.

       <b>-N,</b> <b>--node-slots</b> <u>number-of-node-slots</u>
              Valid  number  ranges  from  1  to 255. This number specifies the maximum number of nodes that can
              concurrently mount the partition. If omitted, the number depends on volume size, for volume size &lt;
              2G, it's 2, for 2G &lt;= size &lt; 10G, it's 4, for 10G &lt;= size &lt; 1T, it's 8, for other size,  it's  16.
              The number of slots can be later tuned up or down using <u>tunefs.ocfs2</u>.

       <b>-T</b> <u>filesystem-type</u>
              Specify  how  the  filesystem is going to be used, so that <u>mkfs.ocfs2</u> can chose optimal filesystem
              parameters for that use. The supported filesystem types are:

              <b>mail</b>   Appropriate for file systems that will host lots of small files.

              <b>datafiles</b>
                     Appropriate for file systems that will host a relatively small number of very large files.

              <b>vmstore</b>
                     Appropriate for file systems that will host Virtual machine images.

       <b>--fs-features=</b><u>[no]sparse...</u>
              Turn specific file system features on or off. A comma separated  list  of  feature  flags  can  be
              provided,  and  <u>mkfs.ocfs2</u> will try to create the file system with those features set according to
              the list. To turn a feature on, include it in the list. To turn a feature off, prepend <b>no</b>  to  the
              name.  Choices here will override individual features set via the <b>--fs-feature-level</b> option. <b>Refer</b>
              <b>to</b> <b>the</b> <b>section</b> <b>titled</b> <b>feature</b> <b>compatibility</b> <b>before</b>  <b>selecting</b>  <b>specific</b>  <b>features.</b>  The  following
              flags are supported:

              <b>backup-super</b>
                     <u>mkfs.ocfs2</u>,  by  default, makes up to 6 backup copies of the super block at offsets 1G, 4G,
                     16G, 64G, 256G and 1T depending on the size of the volume.  This can be useful in  disaster
                     recovery.  This  feature  is  fully  compatible  with  all  versions of the file system and
                     generally should not be disabled.

              <b>local</b>  Create the file system as a local mount, so that it can be mounted without a cluster stack.

              <b>sparse</b> Enable support for sparse files. With this, <u>OCFS2</u> can avoid allocating (and  zeroing)  data
                     to  fill holes. Turn this feature on if you can, otherwise extends and some writes might be
                     less performant.

              <b>unwritten</b>
                     Enable unwritten extents support. With this turned on, an application can  request  that  a
                     range  of  clusters  be  pre-allocated  within a file. <u>OCFS2</u> will mark those extents with a
                     special flag so that expensive data zeroing doesn't have to be performed. Reads and  writes
                     to  a  pre-allocated region act as reads and writes to a hole, except a write will not fail
                     due to lack of data allocation. This feature requires <b>sparse</b> file support to be turned on.

              <b>inline-data</b>
                     Enable inline-data support. If this feature is turned on, <u>OCFS2</u> will store small files  and
                     directories inside the inode block. Data is transparently moved out to an extent when it no
                     longer  fits inside the inode block. In some cases, this can also make a positive impact on
                     cold-cache directory and file operations.

              <b>extended-slotmap</b>
                     The slot-map is a hidden file on an <u>OCFS2</u> fs which is used to map mounted nodes  to  system
                     file resources. The extended slot map allows a larger range of possible node numbers, which
                     is  useful  for userspace cluster stacks. If required, this feature is automatically turned
                     on by <u>mkfs.ocfs2</u>.

              <b>metaecc</b>
                     Enables metadata checksums. With this enabled, the file  system  computes  and  stores  the
                     checksums  in  all  metadata  blocks.  It also computes and stores an error correction code
                     capable of fixing single bit errors.

              <b>refcount</b>
                     Enables creation of reference counted trees. With this  enabled,  the  file  system  allows
                     users to create inode-based snapshots and clones known as <b>reflinks</b>.

              <b>xattr</b>  Enable extended attributes support. With this enabled, users can attach name:value pairs to
                     objects  within  the  file  system.  In  <u>OCFS2</u>, the names can be up to 255 bytes in length,
                     terminated by the first NUL byte. While it is not required,  printable  names  (ASCII)  are
                     recommended.  The  values  can  be  up  to 64KB of arbitrary binary data. Attributes can be
                     attached to all types of inodes: regular files, directories, symbolic links, device  nodes,
                     etc.  This  feature  is required for users wanting to use extended security facilities like
                     POSIX ACLs or SELinux.

              <b>usrquota</b>
                     Enable user quota support. With this feature enabled, filesystem will track amount of space
                     and number of inodes (files, directories, symbolic  links)  each  user  owns.  It  is  then
                     possible  to limit the maximum amount of space or inodes user can have. See a documentation
                     of quota-tools package for more details.

              <b>grpquota</b>
                     Enable group quota support. With this feature enabled,  filesystem  will  track  amount  of
                     space and number of inodes (files, directories, symbolic links) each group owns. It is then
                     possible  to limit the maximum amount of space or inodes user can have. See a documentation
                     of quota-tools package for more details.

              <b>indexed-dirs</b>
                     Enable directory indexing support. With this  feature  enabled,  the  file  system  creates
                     indexed tree for non-inline directory entries. For large scale directories, directory entry
                     lookup performance from the indexed tree is faster then from the legacy directory blocks.

              <b>discontig-bg</b>
                     Enables  discontiguous  block groups. With this feature enabled, the file system is able to
                     grow the inode and the extent allocators even  when  there  is  no  contiguous  free  chunk
                     available.  It  allows  the  file  system to grow the allocators in smaller (discontiguous)
                     chunks.

              <b>clusterinfo</b>
                     Enables storing the cluster stack information in the superblock. This feature is needed  to
                     support  userspace  cluster stacks and the global heartbeat mode in the <b>o2cb</b> cluster stack.
                     If needed, this feature is automatically turned on by <u>mkfs.ocfs2</u>.

       <b>--fs-feature-level=</b><u>feature-level</u>
              Choose from a set of pre-determined file-system features. This option is designed to  allow  users
              to  conveniently choose a set of file system features which fits their needs. There is no downside
              to trying a set of features which your module might not support - if it won't mount the  new  file
              system  simply  reformat  at a lower level. Feature levels can be fine-tuned via the <b>--fs-features</b>
              option. Currently, there are 3 types of feature levels:

              <b>max-compat</b>
                     Chooses fewer features but ensures that the file system can be mounted from older  versions
                     of the <u>OCFS2</u> module.

              <b>default</b>
                     The  default  feature  set  tries  to  strike  a balance between providing new features and
                     maintaining compatibility with relatively recent versions of <u>OCFS2</u>.  It  currently  enables
                     <b>sparse</b>,  <b>unwritten</b>,  <b>inline-data</b>,  <b>xattr</b>,  <b>indexed-dirs</b>,  <b>discontig-bg</b>, <b>refcount</b>, <b>extended-</b>
                     <b>slotmap</b> and <b>clusterinfo</b>.

              <b>max-features</b>
                     Choose the maximum amount of features available.  This  will  typically  provide  the  best
                     performance  from  <u>OCFS2</u>  at  the expense of creating a file system that is only compatible
                     with very recent versions of the <u>OCFS2</u> kernel module.

       <b>--cluster-stack</b>
              Specify the cluster stack. This  option  is  normally  not  required  as  <u>mkfs.ocfs2</u>  chooses  the
              currently  active  cluster  stack.  It is required only if the cluster stack is not online and the
              user wishes to use a stack other than the default, <b>o2cb</b>. Other supported cluster stacks  are  <b>pcmk</b>
              (Pacemaker)  and  <b>cman</b>  (rgmanager).  Once  set,  <u>OCFS2</u> will only allow mounting the volume if the
              active cluster stack and cluster name matches the one specified on-disk.

       <b>--cluster-name</b>
              Specify the name  of  the  cluster.  This  option  is  mandatory  if  the  user  has  specified  a
              <u>cluster-stack</u>.  This  name is restricted to a max of 16 characters. Additionally, the <b>o2cb</b> cluster
              stack allows only alpha-numeric characters.

       <b>--global-heartbeat</b>
              Enable the global heartbeat mode of the <b>o2cb</b> cluster stack. This option is  not  required  if  the
              <b>o2cb</b>  cluster  stack  with  global heartbeat is online as <u>mkfs.ocfs2</u> will detect the active stack.
              However, if the cluster stack is not up, then this option is required alongwith <u>cluster-stack</u>  and
              <u>cluster-name</u>.  For more, refer to <b><a href="../man7/o2cb.7.html">o2cb</a>(7)</b>.

       <b>--discard</b>
              Attempt  to  discard  blocks  at  mkfs  time (discarding blocks initially is useful on solid state
              devices and sparse / thin-provisioned storage). When  the  device  advertises  that  discard  also
              zeroes  data  (any subsequent read after the discard and before write returns zero), then mark all
              not-yet-zeroed blocks as zeroed. This significantly speeds up filesystem initialization.  This  is
              set as default.

       <b>--nodiscard</b>
              Do not attempt to discard blocks at mkfs time.

       <b>--no-backup-super</b>
              This option is deprecated, please use <b>--fs-features=nobackup-super</b> instead.

       <b>-n,</b> <b>--dry-run</b>
              Display the heuristically determined values without overwriting the existing file system.

       <b>-q,</b> <b>--quiet</b>
              Quiet mode.

       <b>-U</b> <u>uuid</u>
              Specify   a   custom   UUID   in   the  plain  (2A4D1C581FAA42A1A41D26EFC90C1315)  or  traditional
              (2a4d1c58-1faa-42a1-a41d-26efc90c1315) format. This option in <b>not</b>  recommended  because  the  file
              system uses the UUID to uniquely identify a file system. <b>If</b> <b>more</b> <b>than</b> <b>one</b> <b>file</b> <b>system</b> <b>were</b> <b>to</b> <b>have</b>
              <b>the</b>  <b>same</b>  <b>UUID,</b>  <b>one</b>  <b>is</b>  <b>very</b> <b>likely</b> <b>to</b> <b>encounter</b> <b>erratic</b> <b>behavior,</b> <b>if</b> <b>not,</b> <b>outright</b> <b>file</b> <b>system</b>
              <b>corruption.</b>

       <b>-v,</b> <b>--verbose</b>
              Verbose mode.

       <b>-V,</b> <b>--version</b>
              Print version and exit.

       <u>blocks-count</u>
              Usually <b>mkfs.ocfs2</b> automatically determines the size of the given device and creates a file system
              that uses all of the available space on the device.  This optional  argument  specifies  that  the
              file system should only consume the given number of file system blocks (see <b>-b</b>) on the device.

</pre><h4><b>FEATURE</b> <b>COMPATIBILITY</b></h4><pre>
       This section lists the file system features that have been added to the <u>OCFS2</u> file system and the version
       that  it  first  appeared  in.  The  table  below  lists  the  versions  of the mainline Linux kernel and
       ocfs2-tools. Users should use this information to enable only those features that are  available  in  the
       file  system  that  they  are  using.   Before  enabling new features, users are advised to review to the
       section titled <b>feature</b> <b>values</b>.

                               ┌──────────────────┬────────────────┬─────────────────┐
                               │ <b>Feature</b>          │ <b>Kernel</b> <b>Version</b> │ <b>Tools</b> <b>Version</b>   │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>local</u>            │  Linux 2.6.20  │ ocfs2-tools 1.2 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>sparse</u>           │  Linux 2.6.22  │ ocfs2-tools 1.4 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>unwritten</u>        │  Linux 2.6.23  │ ocfs2-tools 1.4 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>inline-data</u>      │  Linux 2.6.24  │ ocfs2-tools 1.4 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>extended-slotmap</u> │  Linux 2.6.27  │ ocfs2-tools 1.6 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>metaecc</u>          │  Linux 2.6.29  │ ocfs2-tools 1.6 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>grpquota</u>         │  Linux 2.6.29  │ ocfs2-tools 1.6 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>usrquota</u>         │  Linux 2.6.29  │ ocfs2-tools 1.6 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>xattr</u>            │  Linux 2.6.29  │ ocfs2-tools 1.6 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>indexed-dirs</u>     │  Linux 2.6.30  │ ocfs2-tools 1.6 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>refcount</u>         │  Linux 2.6.32  │ ocfs2-tools 1.6 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>discontig-bg</u>     │  Linux 2.6.35  │ ocfs2-tools 1.6 │
                               ├──────────────────┼────────────────┼─────────────────┤
                               │ <u>clusterinfo</u>      │  Linux 2.6.37  │ ocfs2-tools 1.8 │
                               └──────────────────┴────────────────┴─────────────────┘

       Users can query the features enabled in the file system as follows:

       # tunefs.ocfs2 -Q "Label: %V\nFeatures: %H %O\n" /dev/sdg1
       Label: apache_files_10
       Features: sparse inline-data unwritten

</pre><h4><b>FEATURE</b> <b>VALUES</b></h4><pre>
       This section lists the hex values that are associated with the file system features.  This information is
       useful when debugging mount failures that are due to feature incompatibility. When  a  user  attempts  to
       mount  an  <b>OCFS2</b>  volume  that  has  features  enabled  that are not supported by the running file system
       software, it will fail with an error like:

       ERROR: couldn't mount because of unsupported optional features (200).

       <b>By</b> <b>referring</b> <b>to</b> <b>the</b> <b>table</b> <b>below,</b> <b>it</b> <b>becomes</b> <b>apparent</b> <b>that</b> <b>the</b> <b>user</b> <b>attempted</b> <b>to</b> <b>mount</b> <b>a</b> <b>volume</b>  <b>with</b>  <b>the</b>
       <u>xattr</u>  (extended  attributes)  feature  enabled  with  a version of the file system software that did not
       support it. At this stage, the user has the option of either upgrading  the  file  system  software,  or,
       disabling that on-disk feature using <b>tunefs.ocfs2</b>.

       Some  features  allow  the  file  system to be mounted with an older version of the software provided the
       mount is read-only. If a user attempts to mount such a volume in a read-write mode, it will fail with  an
       error like:

       ERROR: couldn't mount RDWR because of unsupported optional features (1).

       <b>This</b>  <b>error</b>  <b>indicates</b>  <b>that</b>  <b>the</b> <b>volume</b> <b>had</b> <b>the</b> <u>unwritten</u> RO compat feature enabled.  This volume can be
       mounted by an older file system software only in the read-only mode.  In this  case,  the  user  has  the
       option  of  either mounting the volume with the <u>ro</u> mount option, or, disabling that on-disk feature using
       <b>tunefs.ocfs2</b>.

                                     ┌──────────────────┬───────────┬───────────┐
                                     │ <u>Feature</u>          │ <u>Category</u>  │ <u>Hex</u> <u>value</u> │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>local</u>            │ Incompat  │     8     │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>sparse</u>           │ Incompat  │    10     │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>inline-data</u>      │ Incompat  │    40     │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>extended-slotmap</u> │ Incompat  │    100    │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>xattr</u>            │ Incompat  │    200    │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>indexed-dirs</u>     │ Incompat  │    400    │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>metaecc</u>          │ Incompat  │    800    │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>refcount</u>         │ Incompat  │   1000    │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>discontig-bg</u>     │ Incompat  │   2000    │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>clusterinfo</u>      │ Incompat  │   4000    │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>unwritten</u>        │ RO Compat │     1     │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>usrquota</u>         │ RO Compat │     2     │
                                     ├──────────────────┼───────────┼───────────┤
                                     │ <u>grpquota</u>         │ RO Compat │     4     │
                                     └──────────────────┴───────────┴───────────┘

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/debugfs.ocfs2.8.html">debugfs.ocfs2</a>(8)</b> <b><a href="../man8/fsck.ocfs2.8.html">fsck.ocfs2</a>(8)</b> <b><a href="../man8/mount.ocfs2.8.html">mount.ocfs2</a>(8)</b> <b><a href="../man8/mounted.ocfs2.8.html">mounted.ocfs2</a>(8)</b> <b><a href="../man7/o2cb.7.html">o2cb</a>(7)</b> <b><a href="../man8/o2cluster.8.html">o2cluster</a>(8)</b> <b><a href="../man8/o2image.8.html">o2image</a>(8)</b>  <b><a href="../man1/o2info.1.html">o2info</a>(1)</b>
       <b><a href="../man8/tunefs.ocfs2.8.html">tunefs.ocfs2</a>(8)</b>

</pre><h4><b>AUTHORS</b></h4><pre>
       Oracle Corporation

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright © 2004, 2012 Oracle. All rights reserved.

Version 1.8.8                                     January 2012                                     <u><a href="../man8/mkfs.ocfs2.8.html">mkfs.ocfs2</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>