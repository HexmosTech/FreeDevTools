<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sg_rbuf - reads data using SCSI READ BUFFER command</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/sg3-utils">sg3-utils_1.48-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sg_rbuf - reads data using SCSI READ BUFFER command

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>sg_rbuf</b>  [<u>--buffer=EACH</u>]  [<u>--dio</u>]  [<u>--help</u>]  [<u>--mmap</u>]  [<u>--quick</u>] [<u>--size=OVERALL</u>] [<u>--verbose</u>] [<u>--version</u>]
       <u>DEVICE</u>

       <b>sg_rbuf</b> [<u>-b=EACH_KIB</u>] [<u>-d</u>] [<u>-m</u>] [<u>-q</u>] [<u>-s=OVERALL_MIB</u>] [<u>-t</u>] [<u>-v</u>] [<u>-V</u>] <u>DEVICE</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This command reads data with the SCSI READ BUFFER command and then discards it. Typically the data  being
       read  is from a disk's memory cache. It is assumed that the data is sourced quickly (although this is not
       guaranteed by the SCSI standards) so that it is faster than reading data from the media.  This command is
       designed for timing transfer speeds across a SCSI transport.

       To fetch the data with a SCSI READ BUFFER  command  and  optionally  decode  it  see  the  sg_read_buffer
       utility. There is also a sg_write_buffer utility useful for downloading firmware amongst other things.

       This  utility  supports  two  command line syntaxes, the preferred one is shown first in the synopsis and
       explained in this section. A later section on the old command line syntax outlines the  second  group  of
       options.

       This  is  a  Linux  only  utility  and  only  works  when  <u>DEVICE</u>  is an sg device (e.g. "/dev/sg1"). The
       sg_read_buffer utility has similar functionality and is ported to other OSes and within Linux can use bsg
       and normal block device names (e.g. "/dev/sdc").

</pre><h4><b>OPTIONS</b></h4><pre>
       Arguments to long options are mandatory for short options as well.

       <b>-b</b>, <b>--buffer</b>=<u>EACH</u>
              where <u>EACH</u> is the number of bytes to be transferred by each READ BUFFER command.  The  default  is
              the  actual available buffer size returned by the READ BUFFER (descriptor) command. The maximum is
              the same as the default, hence this argument can only be used to reduce the size of each  transfer
              to less than the device's actual available buffer size.

       <b>-d</b>, <b>--dio</b>
              use direct IO if available. This option is only available if the <u>DEVICE</u> is a sg driver device node
              (e.g.  /dev/sg1).  In  this  case  the  sg  driver will attempt to configure the DMA from the SCSI
              adapter to transfer directly into user memory. This will eliminate the copy via kernel buffers. If
              not available then this will be reported and indirect IO will be done instead.

       <b>-h</b>, <b>--help</b>
              print usage message then exit.

       <b>-m</b>, <b>--mmap</b>
              use memory mapped IO if available. This option is only available if the  <u>DEVICE</u>  is  a  sg  driver
              device node (e.g. /dev/sg1). In this case the sg driver will attempt to configure the DMA from the
              SCSI  adapter  to  transfer  directly  into  user  memory. This will eliminate the copy via kernel
              buffers.

       <b>-O</b>, <b>--old</b>
              Switch to older style options. Please use as first option.

       <b>-q</b>, <b>--quick</b>
              only transfer the data into kernel buffers (typically by DMA from the SCSI adapter  card)  and  do
              not move it into the user space. This option is only available if the <u>DEVICE</u> is a sg driver device
              node (e.g. /dev/sg1).

       <b>-s</b>, <b>--size</b>=<u>OVERALL</u>
              where  <u>OVERALL</u>  is  the  size  of  total  transfer in bytes. The default is 200 MiB (200*1024*1024
              bytes). The actual number of bytes transferred may be  slightly  less  than  requested  since  all
              transfers are the same size (and an integer division is involved rounding towards zero).

       <b>-t</b>, <b>--time</b>
              times  the  bulk  data  transfer component of this command. The elapsed time is printed out plus a
              MB/sec calculation. In this case "MB" is 1,000,000 bytes. The gettimeofday() system call  is  used
              internally for the time calculation.

       <b>-v</b>, <b>--verbose</b>
              increase level of verbosity. Can be used multiple times.

       <b>-V</b>, <b>--version</b>
              print out version string then exit.

</pre><h4><b>NOTES</b></h4><pre>
       This command is typically used on modern SCSI disks which have a RAM cache in their drive electronics. If
       no  IO  to the magnetic media, or slower devices like flash RAM, is involved then the disk may be able to
       source data fast enough to saturate the bandwidth of the SCSI transport. The bottleneck may then  be  the
       DMA element in the HBA, the Linux drivers or the host machine's hardware (e.g. speed of RAM).

       Various  numeric arguments (e.g. <u>OVERALL</u>) may include multiplicative suffixes or be given in hexadecimal.
       See the "NUMERIC ARGUMENTS" section in the <a href="../man8/sg3_utils.8.html">sg3_utils</a>(8) man page.

</pre><h4><b>EXAMPLES</b></h4><pre>
       On the test system /dev/sg0 corresponds to a fast disk on a U2W  SCSI  bus  (max  80  MB/sec).  The  disk
       specifications state that its cache is 4 MB.
          $ time ./sg_rbuf /dev/sg0
          READ BUFFER reports: buffer capacity=3434944,
            offset boundary=6
          Read 200 MiB (actual 199 MiB, 209531584 bytes),
            buffer size=3354 KiB
          real 0m5.072s, user 0m0.000s, sys 0m2.280s

       So  that  is  approximately  40 MB/sec at 40 % utilization. Now with the addition of the "-q" option this
       throughput improves and the utilization drops to 0%.
          $ time ./sg_rbuf -q /dev/sg0
          READ BUFFER reports: buffer capacity=3434944,
            offset boundary=6
          Read 200 MiB (actual 199 MiB, 209531584 bytes),
            buffer size=3354 KiB
          real 0m2.784s, user 0m0.000s, sys 0m0.000s

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       The exit status of sg_rbuf is 0 when it is successful. Otherwise see the <a href="../man8/sg3_utils.8.html">sg3_utils</a>(8) man page.

</pre><h4><b>OLDER</b> <b>COMMAND</b> <b>LINE</b> <b>OPTIONS</b></h4><pre>
       The options in this section were the only ones available prior to sg3_utils version  1.23  .  Since  then
       this utility defaults to the newer command line options which can be overridden by using <u>--old</u> (or <u>-O</u>) as
       the  first  option. See the ENVIRONMENT VARIABLES section for another way to force the use of these older
       command line options.

       <b>-b</b>=<u>EACH_KIB</u>
              where <u>EACH_KIB</u> is the number of Kilobytes (i.e. 1024 byte units) to be transferred  by  each  READ
              BUFFER  command.  Similar  to  the  <u>--buffer=EACH</u> option in the main description but the units are
              different.

       <b>-d</b>     use direct IO if available. Equivalent to the <u>--dio</u> option in the main description.

       <b>-m</b>     use memory mapped IO if available. Equivalent to the <u>--mmap</u> option in the main description.

       <b>-N</b>, <b>--new</b>
              Switch to the newer style options.

       <b>-q</b>     only transfer the data into kernel buffers (typically by DMA from the SCSI adapter  card)  and  do
              not move it into the user space.  Equivalent to the <u>--quick</u> option in the main description.

       <b>-s</b>=<u>OVERALL_MIB</u>
              where  <u>OVERALL_MIB</u>  is  the  size  of  total transfer in Megabytes (1048576 bytes). Similar to the
              <u>--size=OVERALL</u> option in the main description but the units are different.

       <b>-t</b>     times the bulk data transfer component of this command. Equivalent to the  <u>--time</u>  option  in  the
              main description.

       <b>-v</b>     increase level of verbosity. Can be used multiple times.

       <b>-V</b>     print out version string then exit.

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       Since sg3_utils version 1.23 the environment variable SG3_UTILS_OLD_OPTS can be given. When it is present
       this  utility will expect the older command line options. So the presence of this environment variable is
       equivalent to using <u>--old</u> (or <u>-O</u>) as the first command line option.

</pre><h4><b>AUTHOR</b></h4><pre>
       Written by Douglas Gilbert

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;dgilbert at interlog dot com&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Â© 2000-2017 Douglas Gilbert
       This software is distributed under the GPL version 2. There is NO warranty; not even for  MERCHANTABILITY
       or FITNESS FOR A PARTICULAR PURPOSE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>sg_read_buffer,</b> <b>sg_write_buffer,</b> <b>sg_test_rwbuf(all</b> <b>in</b> <b>sg3_utils)</b>

sg3_utils-1.43                                    October 2017                                        <u><a href="../man8/SG_RBUF.8.html">SG_RBUF</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>