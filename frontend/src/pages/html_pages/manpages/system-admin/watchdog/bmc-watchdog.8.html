<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bmc-watchdog - BMC watchdog timer daemon and control utility</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freeipmi-bmc-watchdog">freeipmi-bmc-watchdog_1.6.15-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       bmc-watchdog - BMC watchdog timer daemon and control utility

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>bmc-watchdog</b> command [<u>OPTION</u>...] [<u>COMMAND_OPTIONS</u>...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Bmc-watchdog</b>  controls  a  Baseboard  Management  Controller  (BMC) watchdog timer. The <b>bmc-watchdog</b> tool
       typically executes as a cronjob or daemon to manage the watchdog timer. A user must be root in  order  to
       run <b>bmc-watchdog.</b>

       Listed  below  are  <b>bmc-watchdog</b>  details,  option  details,  examples,  and  known issues. For a general
       introduction to FreeIPMI please see <b><a href="../man7/freeipmi.7.html">freeipmi</a>(7).</b>

</pre><h4><b>BMC</b> <b>WATCHDOG</b> <b>DETAILS</b></h4><pre>
       A BMC watchdog timer is part of the Intelligent Platform Management Interface (IPMI) specification and is
       only available to BMCs that are compliant with IPMI. When a BMC watchdog  timer  is  started,  it  begins
       counting  down  to  zero  from  some positive number of seconds. When the timer hits zero, the timer will
       execute a pre-configured pre-timeout interrupt and/or timeout action.

       In order to stop the pre-timeout interrupt or timeout action from being executed, the watchdog timer must
       be periodically reset back to its initial beginning value.

       The BMC watchdog timer automatically stops itself when the machine is rebooted. Therefore, when a machine
       is brought up, the BMC watchdog timer must be setup again before it can be used.

       Typically, a BMC watchdog timer is used to automatically reset a  machine  that  has  crashed.  When  the
       operating  system  first  starts  up,  the  BMC  timer is set to its initial countdown value. At periodic
       intervals, when the operating system is functioning properly, the watchdog timer can be reset by  the  OS
       or  a  userspace  program.  Thus, the timer never counts down to zero. When the system crashes, the timer
       cannot be reset by the OS or userspace program. Eventually, the timer will countdown to  zero  and  reset
       the machine.

       See EXAMPLES below for examples of how <b>bmc-watchdog</b> is commonly used.

</pre><h4><b>COMMANDS</b></h4><pre>
       The following commands are available to <b>bmc-watchdog.</b>

       <b>-s</b>, <b>--set</b>
              Set  BMC  Watchdog Configuration. BMC watchdog timer configuration values can be set using the set
              command options listed below under SET OPTIONS. If a particular  configuration  parameter  is  not
              specified on the command line, the current configuration of that parameter will not be changed.

       <b>-g</b>, <b>--get</b>
              Get  BMC  Watchdog  Configuration  and  State.  The  current configuration and state is printed to
              standard output.

       <b>-r</b>, <b>--reset</b>
              Reset BMC Watchdog Timer.

       <b>-t</b>, <b>--start</b>
              Start BMC Watchdog Timer. Does nothing if the timer is currently  running.  Identical  to  <b>--reset</b>
              command  when  the  timer  is stopped with the exception of the start command options listed below
              under START OPTIONS.

       <b>-y</b>, <b>--stop</b>
              Stop BMC Watchdog Timer. Stops the current timer.

       <b>-c</b>, <b>--clear</b>
              Clear BMC Watchdog Configuration. Clears all configuration values for the watchdog  timer,  except
              for timer use, which is kept at its current value.

       <b>-d</b>, <b>--daemon</b>
              Run  <b>bmc-watchdog</b>  as  a  daemon.  Configurable  BMC watchdog timer options are listed below under
              DAEMON OPTIONS. The configuration values are set once, then the daemon will  reset  the  timer  at
              specified periodic intervals. The daemon can be stopped using the <b>--stop</b> command, <b>--clear</b> command,
              or by setting the stop_timer flag on the <b>--set</b> command.

</pre><h4><b>GENERAL</b> <b>OPTIONS</b></h4><pre>
       The  following  options are general options for configuring IPMI communication and executing general tool
       commands.  These options are generic and can be used by any command.

       <b>-D</b> <u>IPMIDRIVER</u>, <b>--driver-type</b>=<u>IPMIDRIVER</u>
              Specify the driver type to use instead of doing an auto selection.  The currently available inband
              drivers are KCS, SSIF, OPENIPMI, SUNBMC, and INTELDCMI.

       <b>--disable-auto-probe</b>
              Do not probe in-band IPMI devices for default settings.

       <b>--driver-address</b>=<u>DRIVER-ADDRESS</u>
              Specify the in-band driver address to be used instead of the probed value.  <u>DRIVER-ADDRESS</u>  should
              be prefixed with "0x" for a hex value and '0' for an octal value.

       <b>--driver-device</b>=<u>DEVICE</u>
              Specify the in-band driver device path to be used instead of the probed path.

       <b>--register-spacing</b>=<u>REGISTER-SPACING</u>
              Specify  the  in-band  driver  register  spacing instead of the probed value. Argument is in bytes
              (i.e. 32bit register spacing = 4)

       <b>--target-channel-number</b>=<u>CHANNEL-NUMBER</u>
              Specify the in-band driver target channel number to send IPMI requests to.

       <b>--target-slave-address</b>=<u>SLAVE-ADDRESS</u>
              Specify the in-band driver target slave number to send IPMI requests to.

       <b>-v</b>, <b>--verbose-logging</b>
              Increase verbosity of logging.

       <b>-n</b>, <b>--no-logging</b>
              Turns off all logging done by <b>bmc-watchdog.</b>

       <b>--config-file</b>=<u>FILE</u>
              Specify an alternate configuration file.

       <b>-W</b> <u>WORKAROUNDS</u>, <b>--workaround-flags</b>=<u>WORKAROUNDS</u>
              Specify workarounds to vendor compliance issues. Multiple workarounds can be  specified  separated
              by  commas. A special command line flag of "none", will indicate no workarounds (may be useful for
              overriding configured defaults). See WORKAROUNDS below for a list of available workarounds.

       <b>--debug</b>
              Turn on debugging.

       <b>-?</b>, <b>--help</b>
              Output a help list and exit.

       <b>--usage</b>
              Output a usage message and exit.

       <b>-V</b>, <b>--version</b>
              Output the program version and exit.

</pre><h4><b>SET</b> <b>OPTIONS</b></h4><pre>
       The following options can be used by the set command to set or clear various BMC  watchdog  configuration
       parameters.

       <b>-u</b> <u>INT</u>, <b>--timer-use</b>=<u>INT</u>
              Set  timer  use.  The  timer use value can be set to one of the following: 1 = BIOS FRB2, 2 = BIOS
              POST, 3 = OS_LOAD, 4 = SMS OS, 5 = OEM.

       <b>-m</b> <u>INT</u>, <b>--stop-timer</b>=<u>INT</u>
              Set Stop Timer Flag. A flag value of 0 stops the current BMC watchdog timer. A value of 1  doesn't
              turn off the current watchdog timer.

       <b>-l</b> <u>INT</u>, <b>--log</b>=<u>INT</u>
              Set Log Flag. A flag value of 0 turns logging on. A value of 1 turns logging off.

       <b>-a</b> <u>INT</u>, <b>--timeout-action</b>=<u>INT</u>
              Set timeout action. The timeout action can be set to one of the following: 0 = No action, 1 = Hard
              Reset, 2 = Power Down, 3 = Power Cycle.

       <b>-p</b> <u>INT</u>, <b>--pre-timeout-interrupt</b>=<u>INT</u>
              Set pre-timeout interrupt. The pre timeout interrupt can be set to one of the following: 0 = None,
              1 = SMI, 2 = NMI, 3 = Messaging Interrupt.

       <b>-z</b> <u>SECONDS</u>, <b>--pre-timeout-interval=</b><u>SECONDS</u>
              Set pre-timeout interval in seconds.

       <b>-F</b>, <b>--clear-bios-frb2</b>
              Clear BIOS FRB2 Timer Use Flag.

       <b>-P</b>, <b>--clear-bios-post</b>
              Clear BIOS POST Timer Use Flag.

       <b>-L</b>, <b>--clear-os-load</b>
              Clear OS Load Timer Use Flag.

       <b>-S</b>, <b>--clear-sms-os</b>
              Clear SMS/OS Timer Use Flag.

       <b>-O</b>, <b>--clear-oem</b>
              Clear OEM Timer Use Flag.

       <b>-i</b> <u>SECONDS</u>, <b>--initial-countdown</b>=<u>SECONDS</u>
              Set initial countdown in seconds.

       <b>-w</b>, <b>--start-after-set</b>
              Start  timer  after  set  command if timer is stopped. This is typically used when <b>bmc-watchdog</b> is
              used as a cronjob. This can be used to automatically start the timer after it  has  been  set  the
              first time.

       <b>-x</b>, <b>--reset-after-set</b>
              Reset timer after set command if timer is running.

       <b>-j</b>, <b>--start-if-stopped</b>
              Don't execute set command if timer is stopped, just start timer.

       <b>-k</b>, <b>--reset-if-running</b>
              Don't  execute set command if timer is running, just reset timer. This is typically used when <b>bmc-</b>
              <b>watchdog</b> is used as a cronjob. This can be used to reset the timer after  it  has  been  initially
              started.

</pre><h4><b>START</b> <b>OPTIONS</b></h4><pre>
       The following options can be used by the start command.

       <b>-G</b> <u>INT</u>, <b>--gratuitous-arp</b>=<u>INT</u>
              Suspend  or  don't  suspend  gratuitous  ARPs  while  the  BMC timer is running. A flag value of 1
              suspends gratuitous ARPs. A value of 0 will not suspend gratuitous ARPs. If  this  option  is  not
              specified, gratuitous ARPs will not be suspended.

       <b>-A</b> <u>INT</u>, <b>--arp-response</b>=<u>INT</u>
              Suspend  or don't suspend BMC-generated ARP responses while the BMC timer is running. A flag value
              of 1 suspends ARP responses. A value of 0 will not suspend ARP responses. If this  option  is  not
              specified, ARP responses will not be suspended.

</pre><h4><b>DAEMON</b> <b>OPTIONS</b></h4><pre>
       The  following  options  can  be used by the daemon command to set the initial BMC watchdog configuration
       parameters.

       <b>-u</b> <u>INT</u>, <b>--timer-use</b>=<u>INT</u>
              Set timer use. The timer use value can be set to one of the following: 1 = BIOS  FRB2,  2  =  BIOS
              POST, 3 = OS_LOAD, 4 = SMS OS, 5 = OEM.

       <b>-l</b> <u>INT</u>, <b>--log</b>=<u>INT</u>
              Set Log Flag. A flag value of 0 turns logging on. A value of 1 turns logging off.

       <b>-a</b> <u>INT</u>, <b>--timeout-action</b>=<u>INT</u>
              Set timeout action. The timeout action can be set to one of the following: 0 = No action, 1 = Hard
              Reset, 2 = Power Down, 3 = Power Cycle.

       <b>-p</b> <u>INT</u>, <b>--pre-timeout-interrupt</b>=<u>INT</u>
              Set pre-timeout interrupt. The pre timeout interrupt can be set to one of the following: 0 = None,
              1 = SMI, 2 = NMI, 3 = Messaging Interrupt.

       <b>-z</b> <u>SECONDS</u>, <b>--pre-timeout-interval</b>=<u>SECONDS</u>
              Set pre-timeout interval in seconds.

       <b>-F</b>, <b>--clear-bios-frb2</b>
              Clear BIOS FRB2 Timer Use Flag.

       <b>-P</b>, <b>--clear-bios-post</b>
              Clear BIOS POST Timer Use Flag.

       <b>-L</b>, <b>--clear-os-load</b>
              Clear OS Load Timer Use Flag.

       <b>-S</b>, <b>--clear-sms-os</b>
              Clear SMS/OS Timer Use Flag.

       <b>-O</b>, <b>--clear-oem</b>
              Clear OEM Timer Use Flag.

       <b>-i</b> <u>SECONDS</u>, <b>--initial-countdown</b>=<u>SECONDS</u>
              Set initial countdown in seconds.

       <b>-G</b> <u>INT</u>, <b>--gratuitous-arp</b>=<u>INT</u>
              Suspend  or  don't  suspend  gratuitous  ARPs  while  the  BMC timer is running. A flag value of 1
              suspends gratuitous ARPs. A value of 0 will not suspend gratuitous ARPs. If  this  option  is  not
              specified, gratuitous ARPs will not be suspended.

       <b>-A</b> <u>INT</u>, <b>--arp-response</b>=<u>INT</u>
              Suspend  or don't suspend BMC-generated ARP responses while the BMC timer is running. A flag value
              of 1 suspends ARP responses. A value of 0 will not suspend ARP responses. If this  option  is  not
              specified, ARP responses will not be suspended.

       <b>-e</b>, <b>--reset-period</b>
              Time interval to wait before resetting timer. The default is 60 seconds.

</pre><h4><b>ERRORS</b></h4><pre>
       Errors are logged to syslog.

</pre><h4><b>WORKAROUNDS</b></h4><pre>
       With  so  many  different  vendors implementing their own IPMI solutions, different vendors may implement
       their IPMI protocols incorrectly. The following describes a number of workarounds currently available  to
       handle  discovered  compliance  issues.  When possible, workarounds have been implemented so they will be
       transparent to the user. However, some will require the user to specify a workaround be used via  the  -W
       option.

       The hardware listed below may only indicate the hardware that a problem was discovered on. Newer versions
       of  hardware  may  fix the problems indicated below. Similar machines from vendors may or may not exhibit
       the same problems. Different vendors may license their firmware from the same IPMI firmware developer, so
       it may be worthwhile to try workarounds listed below even if your motherboard is not listed.

       If you believe your  hardware  has  an  additional  compliance  issue  that  needs  a  workaround  to  be
       implemented,    please    contact    the    FreeIPMI    maintainers    on   &lt;<a href="mailto:freeipmi-users@gnu.org">freeipmi-users@gnu.org</a>&gt;   or
       &lt;<a href="mailto:freeipmi-devel@gnu.org">freeipmi-devel@gnu.org</a>&gt;.

       <u>assumeio</u> - This workaround flag will assume inband interfaces communicate with  system  I/O  rather  than
       being memory-mapped. This will work around systems that report invalid base addresses. Those hitting this
       issue  may  see  "device  not  supported" or "could not find inband device" errors.  Issue observed on HP
       ProLiant DL145 G1.

       <u>spinpoll</u> - This workaround flag will inform some inband drivers (most notably the  KCS  driver)  to  spin
       while  polling  rather  than  putting the process to sleep. This may significantly improve the wall clock
       running time of tools because an operating system scheduler's granularity may be  much  larger  than  the
       time  it  takes  to  perform  a single IPMI message transaction. However, by spinning, your system may be
       performing less useful work by not contexting out the tool for a more useful task.

       <u>ignorestateflag</u> - This workaround option will ignore the BMC timer state flag (indicating if the timer is
       running or stopped) when running in daemon mode. On some BMCs, the flag is broken and will  never  report
       that  a  BMC timer is running, even if it is. The workaround will take notice of changes in the countdown
       seconds to determine if a timer is running or stopped. With this type of implementation, the reset-period
       must be large enough to ensure minor fluctuations in the countdown will not affect the workaround. Due to
       the implementation of this workaround, if another process stops the watchdog timer, it may be detectable.
       This option is confirmed to work around compliances issues on Sun x4100, x4200, and x4500.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Setup a <b>bmc-watchdog</b> daemon that resets the machine after 15 minutes (900 seconds) if the OS has crashed:
               bmc-watchdog -d -u 4 -p 0 -a 1 -i 900

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Upon successful execution, exit status is 0. On error, exit status is 1.

</pre><h4><b>KNOWN</b> <b>ISSUES</b></h4><pre>
       <b>Bmc-watchdog</b> may fail to reset the watchdog timer  if  it  is  not  scheduled  properly.   It  is  always
       recommended that <b>bmc-watchdog</b> be executed with a high scheduling priority.

       On  some  machines, the hardware based SMI Handler may disable a processor after a watchdog timer timeout
       if the timer use is set to something other than SMS/OS.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<a href="mailto:freeipmi-users@gnu.org">freeipmi-users@gnu.org</a>&gt; or &lt;<a href="mailto:freeipmi-devel@gnu.org">freeipmi-devel@gnu.org</a>&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2007-2015 Lawrence Livermore National Security, LLC.
       Copyright (C) 2004-2007 The Regents of the University of California.

       This program is free software; you can redistribute it and/or modify  it  under  the  terms  of  the  GNU
       General  Public License as published by the Free Software Foundation; either version 3 of the License, or
       (at your option) any later version.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man7/freeipmi.7.html">freeipmi</a>(7)

       <a href="http://www.gnu.org/software/freeipmi/">http://www.gnu.org/software/freeipmi/</a>

bmc-watchdog 1.6.15                                2025-02-14                                    <u><a href="../man8/bmc-watchdog.8.html">bmc-watchdog</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>