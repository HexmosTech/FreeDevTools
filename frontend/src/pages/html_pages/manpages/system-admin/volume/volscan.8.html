<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>volscan - Produces detailed information about AFS volumes</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openafs-fileserver">openafs-fileserver_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       volscan - Produces detailed information about AFS volumes

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>volscan</b>
           [<b>-checkout</b>]
           [<b>-partition</b> &lt;<u>AFS</u> <u>partition</u> <u>name</u> <u>or</u> <u>id</u>&gt;]
           [<b>-volumeid</b> &lt;<u>Volume</u> <u>id</u>&gt;]
           [<b>-type</b> &lt;<u>Volume</u> <u>types</u> <u>(rw,</u> <u>ro,</u> <u>bk)</u>&gt;+]
           [<b>-find</b> &lt;<u>Objects</u> <u>to</u> <u>find</u> <u>(file,</u> <u>dir,</u> <u>mount,</u> <u>symlink,</u> <u>acl)</u>&gt;+]
           [<b>-output</b> &lt;<u>Column</u>&gt;+]
           [<b>-delim</b> &lt;<u>Output</u> <u>field</u> <u>delimiter</u>&gt;]
           [<b>-noheading</b>]
           [<b>-ignore-magic</b>]
           [<b>-help</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>volscan</b> command displays volume meta-data stored on AFS file servers.  The output is intended for
       debugging purposes and is meaningful to someone familiar with the internal structure of AFS volumes.  The
       <b>volscan</b> command must be issued directly on a file server machine as the root superuser.  The <b>volscan</b>
       command does not modify volume information.

       The <b>volscan</b> command will produce output for all the volumes on the file server by default. To display
       output for the volumes in one partition only, include the <b>-partition</b> argument. To display output for one
       volume only, include the <b>-partition</b> and <b>-volumeid</b> arguments.

       The <b>volscan</b> command will produce output for read-write, read-only, and backup volumes by default. To
       limit the output to particular types of volumes, include the <b>-type</b> argument with one or more volume types
       ("rw", "ro", "bk").

       The <b>volscan</b> command will produce output for each type of vnode object found in the volumes scanned. The
       command will output information for files, directories, AFS mount points, and symbolic links by default.
       The <b>volscan</b> command can output access control lists (ACLs) for directory vnode objects scanned.  To limit
       the output to particular types of vnode objects, or to output access control lists (ACLs), include the
       <b>-find</b> argument with one or more object types ("file", "dir", "mount", "symlink", "acl").

       The output of the <b>volscan</b> command is tabular. The output consists of an optional heading line, followed
       by zero or more lines of delimiter separated values.  By default, the output values are the file server
       hostname ("host"), the object type ("desc"), the vnode FID ("fid"), the vnode data version ("dv"), and
       the directory path ("path"). The directory path is relative to the root directory of the volume.  When
       "acl" is included as an argument to "-find", the default output values also include the user/group id
       ("aid") and the access rights ("arights").  To specify different output values, include the "-output"
       argument with one or more column names. See OUTPUT for the column names.

       Values are space delimited by default. To use a different delimiter character, include the <b>-delim</b>
       argument.  Include the <b>-noheading</b> flag to suppress the output heading line.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-checkout</b>
           Checkout  the  specified  volume  from  the running file server. This ensures that the file server or
           other processes will not be modifying volume meta-data at the same time we are  trying  to  read  it,
           leading to invalid or incorrect results.

       <b>-partition</b> &lt;<u>partition</u> <u>name</u> <u>or</u> <u>id</u>&gt;+
           Specifies the partition that houses each volume for which to produce output.  Use the format <u>/vicepxx</u>
           or <u>xx</u>, where <u>xx</u> is one or two lowercase letters.

           This argument can be omitted if the current working directory is the mount location for an AFS server
           partition.  If  the  current working directory is not the mount location for an AFS server partition,
           the command produces output for every volume on all local AFS server partitions.

       <b>-volumeid</b> &lt;<u>volume</u> <u>id</u>&gt;+
           Specifies the ID number of one volume for which to produce output.  The <b>-partition</b> argument  must  be
           provided  along  with this one unless the current working directory is the mount location for the AFS
           server partition that houses the volume.

       <b>-type</b> &lt;<u>Volume</u> <u>types:</u> <u>rw,</u> <u>ro,</u> <u>bk</u>&gt;+
           Limit the volumes to be scanned by read/write, read-only, or backup volumes.  Specify one or more  of
           "rw"&lt;rw&gt;, "ro", "bk".  The <b>volscan</b> command will scan all types of volumes by default.

       <b>-find</b> &lt;<u>Objects</u> <u>to</u> <u>find:</u> <u>file,</u> <u>dir,</u> <u>mount,</u> <u>symlink,</u> <u>acl</u>&gt;+
           Output the specified volume objects within the scanned volumes. Specify one or more of "file", "dir",
           "mount",  "symlink",  "acl".   By  default,  the  <b>volscan</b>  command  will find "file", "dir", "mount",
           "symlink" objects.

       <b>-output</b> &lt;<u>Column</u>&gt;+
           The <b>-output</b> argument specifies the output columns produced by the <b>volscan</b>  command.  See  the  OUTPUT
           section for &lt;<u>Column</u>&gt; names.

           The default output columns are the file server hostname ("host"), the object type ("desc"), the vnode
           FID  ("fid"), the vnode data version ("dv"), and the directory path ("path").  When "acl" is included
           as an argument to "-find", the default output values also include the user/group id ("aid")  and  the
           access rights ("arights").

       <b>-delim</b> &lt;<u>Output</u> <u>field</u> <u>delimiter</u>&gt;
           The  <b>-delim</b>  argument  specifies the record delimiter character. The default value is the space (' ')
           character.

       <b>-noheading</b>
           The <b>-noheading</b> flags prevents the <b>volscan</b> command from printing the heading line.

       <b>-ignore-magic</b>
           Display vnodes even with incorrect vnode magic numbers. By default,  the  <b>volscan</b>  command  will  not
           process vnodes objects with incorrect vnode magic numbers.

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>OUTPUT</b></h4><pre>
       The following column names are valid for the <b>-output</b> argument:

       "host"
           The  hostname of the current machine. This field may be useful when combining the <b>volscan</b> output from
           several hosts.

       "desc"
           The descriptive name of the type of volume object.  Values are "file", "dir", "symlink", "mount", and
           "acl".

       "vid"
           The numeric volume id.

       "offset"
           The vnode index table offset.

       "vtype"
           The volume type. Values are "RW", "RO", "BK".

       "vname"
           The volume name.

       "part"
           The partition path.

       "partid"
           The AFS partition id.

       "fid"
           The AFS File Identifier (FID).

       "path"
           The directory path and filename. The path is relative to the volume root directory.

       "target"
           The symlink target. Empty if the vnode is not a symlink.

       "mount"
           The mount point value. Empty if the vnode is not a mount point. See "fs lsmount" for the mount  point
           value format.

       "mtype"
           The  mount  point  type.  Empty  if  the vnode is not a mount point. Values are '#' for regular mount
           points and '%' for read-write mount points.

       "mcell"
           The mount point target cell. Empty if the vnode is not a cellular mount point.

       "mvol"
           The mount point target volume. Empty if the vnode is not a mount point.

       "aid"
           Access entry user or group id. Empty if the object is not an ACL.

       "arights"
           Access entry rights. Empty if the object is not an ACL.

       "vntype"
           The vnode type. Values are "file", "dir", "symlink".

       "cloned"
           The vnode cloned flag. Values are "y" or "n".

       "mode"
           The vnode Unix mode bits, as an octal number.

       "links"
           The vnode link count.

       "length"
           The vnode data length.

       "uniq"
           The vnode uniquifier number.

       "dv"
           The vnode data version number.

       "inode"
           The vnode inode number. This is an internally used number on namei file servers.

       "namei"
           The vnode namei path.

       "modtime"
           The vnode modification time.

       "author"
           The vnode author user id.

       "owner"
           The vnode Unix owner id.

       "parent"
           The parent directory vnode number.

       "magic"
           The vnode magic number.

       "lock"
           The vnode lock count and time. The format is &lt;<u>count</u>&gt;.&lt;<u>time</u>&gt;, where &lt;<u>time</u>&gt; is the epoch time.

       "smodtime"
           The vnode server modify time.

       "group"
           The vnode unix group id.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following command displays the FID, data version, and relative  path  for  each  vnode  object  in  a
       volume.

           # volscan -partition a -volumeid 536870916
           HOST DESC FID DV PATH
           fs1 dir 536870916.1.1 3 /
           fs1 mount 536870916.2.2 0 /test
           fs1 mount 536870916.4.3 0 /xyzzy

       The following command displays the AFS mount points in all the read-write volumes on the file server. For
       each  mount point the following is shown: the volume containing the mount point, the type of mount point,
       regular ("#") or read-write ("%"), the target cell (or "-" if not a cellular mount point),  the  name  of
       the target volume, the path of the mount point within the volume (relative to the volume root directory).

           # volscan -type rw -find mount -output vid mtype mcell mvol path -noheading
           536870915 # - test /test
           536870912 # example.com root.cell /example.com
           536870912 % example.com root.cell /.example.com

       The following command displays access control lists for a volume.

           # volscan -partition a -volumeid 536870918 -find acl \
               -output fid aid arights path -delim : -noheading
           536870918.1.1:-204:+rlidwka:/
           536870918.1.1:-101:+rl:/
           536870918.3.3:-204:+rlidwka:/xyzzy
           536870918.3.3:-101:+rl:/xyzzy
           536870918.3.3:1027:+rlidwk:/xyzzy

       The following commands find files which have unix permissions bit 04000 ("suid") or 02000 ("sgid"):

           # volscan -find file -output fid mode -noheading | \
              perl -lane 'print if oct($F[1]) &amp; 06000'

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       The issuer must be logged in as the local superuser "root".

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/volinfo.8.html">volinfo</a></b>(8), <b><a href="../man5/vldb.DB0.5.html">vldb.DB0</a></b>(5), <b><a href="../man8/volserver.8.html">volserver</a></b>(8)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2014 Sine Nomine Associates.  All Rights Reserved.

       This  documentation  is  covered by the BSD License as written in the doc/LICENSE file. This man page was
       written by Michael Meffie for OpenAFS.

OpenAFS                                            2025-03-21                                         <u><a href="../man8/VOLSCAN.8.html">VOLSCAN</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>