<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>backup_volrestore - Restores one or more volumes</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openafs-client">openafs-client_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       backup_volrestore - Restores one or more volumes

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>backup</b> <b>volrestore</b> <b>-server</b> &lt;<u>destination</u> <u>machine</u>&gt;
           <b>-partition</b> &lt;<u>destination</u> <u>partition</u>&gt;
           <b>-volume</b> &lt;<u>volume(s)</u> <u>to</u> <u>restore</u>&gt;+
           [<b>-extension</b> &lt;<u>new</u> <u>volume</u> <u>name</u> <u>extension</u>&gt;]
           [<b>-date</b> &lt;<u>date</u> <u>from</u> <u>which</u> <u>to</u> <u>restore</u>&gt;+]
           [<b>-portoffset</b> &lt;<u>TC</u> <u>port</u> <u>offsets</u>&gt;+] [<b>-dryrun</b> | <b>-n</b>]
           [<b>-usedump</b> &lt;<u>specify</u> <u>the</u> <u>dumpID</u> <u>to</u> <u>restore</u> <u>from</u>&gt;]
           [<b>-localauth</b>] [<b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;] [<b>-help</b>]

       <b>backup</b> <b>volr</b> <b>-s</b> &lt;<u>destination</u> <u>machine</u>&gt;
           <b>-pa</b> &lt;<u>destination</u> <u>partition</u>&gt;
           <b>-v</b> &lt;<u>volume(s)</u> <u>to</u> <u>restore</u>&gt;+
           [<b>-e</b> &lt;<u>new</u> <u>volume</u> <u>name</u> <u>extension</u>&gt;]
           [<b>-d</b> &lt;<u>date</u> <u>from</u> <u>which</u> <u>to</u> <u>restore</u>&gt;+]
           [<b>-po</b> &lt;<u>TC</u> <u>port</u> <u>offsets</u>&gt;+]
           [<b>-u</b> &lt;<u>specify</u> <u>the</u> <u>dumpID</u> <u>to</u> <u>restore</u> <u>from</u>&gt;]
           [<b>-dryrun</b> | <b>-n</b>] [<b>-l</b>] [<b>-c</b> &lt;<u>cell</u> <u>name</u>&gt;] [<b>-h</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>backup</b> <b>volrestore</b> command restores the contents of one or more volumes to the site indicated by the
       <b>-server</b> and <b>-partition</b> arguments. Use the command either to overwrite the contents of existing volumes
       with the restored data or to create new volumes while retaining the existing ones. The specified site
       does not have to be the current site for the volumes.

       (If the "FILE YES" instruction appears in the <u>/var/lib/openafs/backup/CFG_device_name</u> file associated
       with the specified port offset, then the <b>backup</b> <b>volrestore</b> command restores data from the backup data
       file listed for that port offset in the Tape Coordinator's <u>/var/lib/openafs/backup/tapeconfig</u> file,
       rather than from tape. For the sake of clarity, the following text refers to tapes only, but the Backup
       System handles backup data files in much the same way.)

       The command's arguments can be combined as indicated:

       •   To  preserve  a volume's current contents and also create a new volume to house the restored version,
           use the <b>-extension</b> argument.  The Backup System creates the new volume on the  server  and  partition
           named  by  the  <b>-server</b> and <b>-partition</b> arguments, assigns it the same name as the current volume with
           the addition of the specified extension, and creates a new Volume Location Database (VLDB) entry  for
           it.  Creating a new volume enables the administrator to compare the two versions.

       •   To  overwrite  a  volume's existing contents with the restored version, omit the <b>-extension</b> argument,
           and specify the site as indicated:

           •   To retain the current site, specify it with the <b>-server</b> and <b>-partition</b> arguments.

           •   To move the volume to a different site while overwriting  it,  specify  the  new  site  with  the
               <b>-server</b>  argument,  <b>-partition</b>  argument, or both. The Backup System creates a new volume at that
               site, removes the existing volume, and updates the site information in the volume's  VLDB  entry.
               The  backup  version  of  the  volume  is not removed automatically from the original site, if it
               exists. Use the <b>vos</b> <b>remove</b> command to remove it and the <b>vos</b> <b>backup</b> command  to  create  a  backup
               version at the new site.

       •   To  restore  a  volume  that  no  longer exists in the file system, specify its name with the <b>-volume</b>
           argument and use the <b>-server</b> and <b>-partition</b> arguments to place it at the  desired  site.  The  Backup
           System creates a new volume and new VLDB entry.

       In  each case, the command sets each volume's creation date to the date and time at which it restores it.
       The creation date appears in the "Creation" field in the output from the  <b>vos</b>  <b>examine</b>  and  <b>vos</b>  <b>listvol</b>
       commands.

       If  restoring  all of the volumes that resided on a single partition, it is usually more efficient to use
       the <b>backup</b> <b>diskrestore</b> command. If restoring multiple volumes to many different sites,  it  can  be  more
       efficient to use the <b>backup</b> <b>volsetrestore</b> command.

       By  default,  the  backup  volrestore  command  restores  the  most  recent  full dump and all subsequent
       incremental dumps for each volume, bringing the restored volumes to the most current possible  state.  To
       restore  the  volumes  to their state at some time in the past, use the <b>-date</b> argument. The Backup System
       restores the most recent full dump and each subsequent incremental dump for which the <u>clone</u> <u>date</u>  of  the
       volume  included  in  the dump is before the indicated date and time (the clone date timestamp appears in
       the "clone date" field of the output from the <b>backup</b> <b>volinfo</b> command). For backup and read-only  volumes,
       the  clone  date  represents  the  time  at  which  the volume was copied from its read/write source; for
       read/write volumes, it represents the time at which the volume was locked for inclusion in the dump.  The
       resemblance  of a restored volume to its actual state at the indicated time depends on the amount of time
       that elapsed between the volume's clone date in the last eligible dump and the specified time.

       If the <b>-volume</b> argument specifies the base (read/write) form  of  the  volume  name,  the  Backup  System
       searches the Backup Database for the newest dump set that includes a dump of either the read/write or the
       backup version of the volume. It restores the dumps of that version of the volume, starting with the most
       recent  full  dump.  If,  in  contrast,  the volume name explicitly includes the ".backup" or ".readonly"
       extension, the Backup System restores dumps of the corresponding volume version only.

       To generate a list of the tapes the Backup  System  needs  to  perform  the  restore  operation,  without
       actually performing it, combine the <b>-dryrun</b> flag with the options to be used on the actual command.

       If  all of the full and incremental dumps of all relevant volumes were not written to a type of tape that
       a single Tape Coordinator can read, use the <b>-portoffset</b> argument to list multiple port offset numbers  in
       the  order  in  which the tapes are needed (first list the port offset for the full dump, second the port
       offset for the level 1 incremental dump, and so on). If restoring multiple volumes, the same ordered list
       of port offsets must apply to all of them. If not, either issue this command separately for each  volume,
       or use the <b>vos</b> <b>volsetrestore</b> command after defining groups of volumes that were dumped to compatible tape
       types. For further discussion, see the <u>OpenAFS</u> <u>Administration</u> <u>Guide</u>.

       The  Tape Coordinator's default response to this command is to access the first tape it needs by invoking
       the <b>MOUNT</b> instruction in the local <u>/var/lib/openafs/backup/CFG_device_name</u>  file,  or  by  prompting  the
       backup  operator  to  insert  the tape if there is no "MOUNT" instruction. However, if the "AUTOQUERY NO"
       instruction appears in the <u>CFG_device_name</u> file, or if the  issuer  of  the  <b>butc</b>  command  included  the
       <b>-noautoquery</b>  flag,  the  Tape Coordinator instead expects the tape to be in the device already. If it is
       not, or is the wrong tape, the Tape Coordinator invokes the "MOUNT" instruction or prompts the  operator.
       It  also  invokes  the  "MOUNT"  instruction  or  prompts for any additional tapes needed to complete the
       restore operation; the backup operator must arrange to provide them.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-server</b> &lt;<u>destination</u> <u>machine</u>&gt;
           Names the file server machine on which to restore each volume. If this argument  and  the  <b>-partition</b>
           argument  indicate a site other than the current site for each volume, and the <b>-extension</b> argument is
           not also provided, the Backup System removes the existing volumes from their  current  sites,  places
           the  restored  contents  at the specified site, and changes the site information in the volume's VLDB
           entry.

       <b>-partition</b> &lt;<u>destination</u> <u>partition</u>&gt;
           Names the partition to which to restore each volume.  If  this  argument  and  the  <b>-server</b>  argument
           indicate  a site other than the current site for each volume, and the <b>-extension</b> argument is not also
           provided, the Backup System removes the  existing  volumes  from  their  current  sites,  places  the
           restored contents at the specified site, and changes the site information in the volume's VLDB entry.

       <b>-volume</b> &lt;<u>volume</u> <u>to</u> <u>restore</u>&gt;+
           Names one or more volumes to restore, using the volume name as listed in the Backup Database. Provide
           the  base  (read/write)  name of each volume to have the Backup System search the Backup Database for
           the newest dump set that includes a dump of either the  read/write  or  the  backup  version  of  the
           volume; it restores the dumps of that version of the volume, starting with the most recent full dump.
           If, in contrast, a volume name explicitly includes the ".backup" or ".readonly" extension, the Backup
           System restores dumps of the corresponding volume version only.

       <b>-extension</b> &lt;<u>new</u> <u>volume</u> <u>name</u> <u>extension</u>&gt;
           Creates  a  new  volume  to  house  the restored data, with a name derived by appending the specified
           string to each volume named by the <b>-volume</b> argument. The Backup System creates a new VLDB  entry  for
           the  volume. Any string other than ".readonly" or ".backup" is acceptable, but the combination of the
           existing volume name and extension cannot exceed 22 characters in length. To use a period to separate
           the extension from the name, specify it as the first character of  the  string  (as  in  ".rst",  for
           example).

       <b>-date</b> &lt;<u>date</u> <u>from</u> <u>which</u> <u>to</u> <u>restore</u>&gt;+
           Specifies  a  date and optionally time; the restored volume includes data from dumps performed before
           the date only. Provide a value in the  format  <u>mm/dd/yyyy</u>  [<u>hh</u>:<u>MM</u>],  where  the  required  <u>mm/dd/yyyy</u>
           portion indicates the month (<u>mm</u>), day (<u>dd</u>), and year (<u>yyyy</u>), and the optional <u>hh:MM</u> portion indicates
           the  hour  and  minutes  in  24-hour format (for example, the value "14:36" represents 2:36 p.m.). If
           omitted, the time defaults to 59 seconds after midnight (00:00:59 hours).

           Valid values for the year range from 1970 to 2037; higher values are not  valid  because  the  latest
           possible  date  in  the  standard  UNIX  representation  is in February 2038. The command interpreter
           automatically reduces any later date to the maximum value.

           If this argument is omitted, the Backup  System  restores  all  possible  dumps  including  the  most
           recently created.

       <b>-usedump</b> &lt;<u>dumpID</u>&gt;
           Specifies  the  dumpID  of  the  specific  dump  to  use to restore the volume. If this option is not
           specified, we will find the appropriate dump to restore, according to the logic in the <b>-date</b> option.

       <b>-portoffset</b> &lt;<u>TC</u> <u>port</u> <u>offest</u>&gt;+
           Specifies one or more port offset numbers (up to a maximum of 128),  each  corresponding  to  a  Tape
           Coordinator  to  use  in  the  operation. If there is more than one value, the Backup System uses the
           first one when restoring the full dump of each volume, the second one  when  restoring  the  level  1
           incremental  dump of each volume, and so on. It uses the final value in the list when restoring dumps
           at the corresponding depth in the dump hierarchy and all dumps at lower levels.

           Provide this argument unless the default value of 0 (zero) is appropriate for all dumps. If 0 is just
           one of the values in the list, provide it explicitly in the appropriate order.

       <b>-dryrun</b> | <b>-n</b>
           Displays the list of tapes that contain the dumps required by the restore operation, without actually
           performing the operation.

       <b>-localauth</b>
           Constructs a server ticket using a key from the local <u>/etc/openafs/server/KeyFile</u>  file.  The  <b>backup</b>
           command  interpreter  presents  it  to  the  Backup Server, Volume Server and VL Server during mutual
           authentication. Do not combine this flag with the <b>-cell</b> argument. For more details, see <b><a href="../man8/backup.8.html">backup</a></b>(8).

       <b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;
           Names the cell in which to run the command. Do not combine this argument with  the  <b>-localauth</b>  flag.
           For more details, see <b><a href="../man8/backup.8.html">backup</a></b>(8).

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>OUTPUT</b></h4><pre>
       If the issuer includes the <b>-dryrun</b> flag with the command, the following string appears at the head of the
       list of the tapes necessary to complete the restore operation.

          Tapes needed:

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following command restores the volume user.pat to partition <u>/vicepa</u> on machine "fs5.example.com":

          % backup volrestore -server fs5.example.com -partition a -volume user.pat

       The  following command restores the volumes "user.smith" and "user.terry" to partition <u>/vicepb</u> on machine
       "fs4.example.com", adding a ".rst" extension to each volume name and preserving the existing "user.smith"
       and "user.terry" volumes.  Only dumps created before 5:00 p.m. on 31  January  1998  are  restored.  (The
       command is shown here on multiple lines only for legibility reasons.)

          % backup volrestore -server fs4.example.com -partition b  \
                              -volume user.smith user.terry  \
                              -extension .rst -date 1/31/1998 17:00

       The following command restores the volume user.pat to partition <u>/vicepb</u> on machine "fs4.example.com". The
       Tape  Coordinator with port offset 1 handles the tape containing the full dump; the Tape Coordinator with
       port offset 0 handles all tapes containing incremental dumps. (The command is shown  here  on  two  lines
       only for legibility reasons.)

          % backup volrestore -server fs5.example.com -partition a  \
                              -volume user.pat -portoffset 1 0

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       The  issuer  must  be  listed  in the <u>/etc/openafs/server/UserList</u> file on every machine where the Backup
       Server or Volume Location (VL) Server is running, and  on  every  file  server  machine  that  houses  an
       affected  volume.  If  the  <b>-localauth</b> flag is included, the issuer must instead be logged on to a server
       machine as the local superuser "root".

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/butc.5.html">butc</a></b>(5),   <b><a href="../man8/backup.8.html">backup</a></b>(8),   <b><a href="../man8/backup_dump.8.html">backup_dump</a></b>(8),    <b><a href="../man8/backup_diskrestore.8.html">backup_diskrestore</a></b>(8),    <b><a href="../man8/backup_volsetrestore.8.html">backup_volsetrestore</a></b>(8),    <b><a href="../man8/butc.8.html">butc</a></b>(8),
       <b><a href="../man1/vos_backup.1.html">vos_backup</a></b>(1), <b><a href="../man1/vos_remove.1.html">vos_remove</a></b>(1)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       IBM Corporation 2000. &lt;<a href="http://www.ibm.com/">http://www.ibm.com/</a>&gt; All Rights Reserved.

       This  documentation  is covered by the IBM Public License Version 1.0.  It was converted from HTML to POD
       by software written by Chas Williams and Russ Allbery, based on  work  by  Alf  Wachsmann  and  Elizabeth
       Cassell.

OpenAFS                                            2025-03-21                               <u><a href="../man8/BACKUP_VOLRESTORE.8.html">BACKUP_VOLRESTORE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>