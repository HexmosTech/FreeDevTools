<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vfs_btrfs - Utilize features provided by the Btrfs filesystem</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/samba">samba_4.22.3+dfsg-4ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       vfs_btrfs - Utilize features provided by the Btrfs filesystem

</pre><h4><b>SYNOPSIS</b></h4><pre>

       vfs objects = btrfs

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This VFS module is part of the <b><a href="../man8/samba.8.html">samba</a></b>(8) suite.

       The vfs_btrfs VFS module exposes Btrfs specific features for use by Samba.

       Btrfs allows for multiple files to share the same on-disk data through the use cloned ranges. When an SMB
       client issues a request to copy duplicate data (via FSCTL_SRV_COPYCHUNK), this module maps the request to
       a Btrfs clone range IOCTL, instead of performing reads and writes required by a traditional copy. Doing
       so saves storage capacity and greatly reduces disk IO.

       This module also exposes Btrfs per-file compression support to SMB clients via the get/set compression
       fsctls.

       Btrfs snapshots can be manipulated by Samba's FSRVP server. Snapshot manipulation using this module is
       currently considered experimental, and is therefore disabled by default. The vfs_snapper module is
       instead recommended for this purpose.

       This module is stackable.

</pre><h4><b>OPTIONS</b></h4><pre>
       btrfs: manipulate snapshots = [yes|no]
           When set to <u>yes</u>, experimental support for the creation and deletion of snapshots via corresponding
           Btrfs IOCTLs will be enabled. The default is <u>no</u>, which means that such requests are passed through to
           any underlying VFS module.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       vfs_btrfs requires that the underlying share path is a Btrfs subvolume.

                     <u>[share]</u>
                     <b>vfs</b> <b>objects</b> <b>=</b> <b>btrfs</b>
                     <b>btrfs:</b> <b>manipulate</b> <b>snapshots</b> <b>=</b> <b>no</b>

       To use the experimental snapshot manipulation functionality provided by this module, it must be
       explicitly enabled, and Samba's FSRVP server must be running.

       The vfs_shadow_copy module can be used to expose snapshots created by vfs_btrfs to Windows Explorer as
       file / directory "previous versions".

                     <u>[global]</u>
                     <b>registry</b> <b>shares</b> <b>=</b> <b>yes</b>
                     <b>include</b> <b>=</b> <b>registry</b>

                     <u>[share]</u>
                     <b>vfs</b> <b>objects</b> <b>=</b> <b>btrfs</b> <b>shadow_copy</b>
                     <b>btrfs:</b> <b>manipulate</b> <b>snapshots</b> <b>=</b> <b>yes</b>

</pre><h4><b>VERSION</b></h4><pre>
       This man page is part of version 4.22.3-Ubuntu-4.22.3+dfsg-4ubuntu1 of the Samba suite.

</pre><h4><b>AUTHOR</b></h4><pre>
       The original Samba software and related utilities were created by Andrew Tridgell. Samba is now developed
       by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.

Samba 4.22.3-Ubuntu-4.22.3+dfs                     07/21/2025                                       <u><a href="../man8/VFS_BTRFS.8.html">VFS_BTRFS</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>