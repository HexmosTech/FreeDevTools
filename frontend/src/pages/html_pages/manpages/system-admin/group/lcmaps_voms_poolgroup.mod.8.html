<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lcmaps_voms_poolgroup.mod  -  LCMAPS  plugin  to  switch  user identity based on VOMS credentials by pool</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/lcmaps-plugins-voms">lcmaps-plugins-voms_1.7.1-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       lcmaps_voms_poolgroup.mod  -  LCMAPS  plugin  to  switch  user identity based on VOMS credentials by pool
       groups

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>lcmaps_voms_poolgroup.mod</b> [<b>-groupmapfile</b> <u>group-mapfile</u>] [<b>-groupmapdir</b> <u>groupmapdir</u>] [<b>--map-to-secondary-</b>
       <b>groups</b>] [<b>-override_inconsistency</b>] [<b>-mapall</b>] [<b>-mapmin</b> <u>number</u> <u>of</u> <u>minimal</u> <u>mappings</u>]
       [<b>-strict_poolprefix_match</b> <u>{yes|no}</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The VOMS poolgroup acquisition plugin  is  a  'VOMS-aware'  plugin  similar  to  the  <b>lcmaps_voms_poolac‐</b>
       <b>count.mod.8</b>  plugin,  but  for  groups  instead of accounts.  The plugin tries to find local groups (more
       specifically GroupIDs) based on the VOMS information that is available from  LCMAPS,  in  particular  the
       Fully  Qualified Attribute Names (FQANs).  The actual groups are acquired from a group pool.  The result‐
       ing list of groups will be looked up in the /etc/groups and/or LDAP directories to determine which  Group
       IDs should be added as a mapping result.

       It will first try to find an FQAN to pool name (starting with a dot '.'  instead of an alphanumeric char‐
       acter)  mapping in the group-mapfile which will provide it with a list of local groups. The group-mapfile
       is similar to a grid-mapfile.

       The <b>groupmapdir</b> directory is going to be used as a persistent and open mapping database. A  pool  is  de‐
       fined  as being a set of groups following a particular pattern in their naming, e.g. pool001 or atlas001.
       In the directory the plug-in will make a new filename consisting of the lowercase URL-encoded VOMS FQAN.

       For example, if the FQAN is mapped to <b>.atlas</b> in the group-mapfile, it will be mapped to the  pool  groups
       <b>atlas001</b>, <b>atlas002</b>, etc., the names of which can be found in the groupmapdir.

       If  there  is no pool group assigned to the FQAN yet, the plugin will try to find a free pool group (i.e.
       one for which the link count is 1) and make a new hardlink to it with the URL-encoded FQAN as name.

       When a user returns to this site the plugin will look for the FQAN of the user (URL encoded) in this  di‐
       rectory. If found, the corresponding pool group will be reassigned.

       Example showing the output of ls -li:
       1836080 -rw-r--r-- 2 root root %2fdteam%2f
       1836080 -rw-r--r-- 2 root root dteam001
       The  filename  is hardlinked to the mapped group name. Creating this hardlink is designed to be an atomic
       operation and verified to work on large installations serving multiple services from one NFS-share.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-groupmapfile</b> <u>group-mapfile</u>
              This file must contain FQAN to pool group name mappings, similar to  the  grid-mapfile.  The  same
              formatting rules of the grid-mapfile apply to the group-mapfile.  It is strongly advised to set it
              to an absolute path to avoid usage of the wrong file(path).  In a (setuid-)root application, rela‐
              tive  paths  are  taken with respect to <u>/etc/grid-security/</u>.  It is important to not mix the grid-
              mapfile and group-mapfile.

       <b>-groupmapdir</b> <u>groupmapdir"</u>
              A directory used for the group mapping database, similar to the gridmapdir.  If this option is un‐
              set, the plugin will try to obtain the value from the environment variable <b>GROUPMAPDIR</b> (see  <b>ENVI‐</b>
              <b>RONMENT</b>).   In a (setuid-)root application, relative paths are taken with respect to <u>/etc/grid-se‐</u>
              <u>curity/</u>.  It is important to not mix the gridmapdir and groupmapdir directories.

       <b>--map-to-secondary-groups</b>
              When enabled, the plug-in will map also the first FQAN of the user to secondary Group  IDs,  hence
              there  will  be  no primary Group ID set by this plug-in when enabled. Note that also if the first
              FQAN does not give a mapping, there will be no primary Group ID set by this plug-in.

       <b>-override_inconsistency</b>
              Moving a user from one pool to another (because of a VO change) should normally only  be  done  by
              changing  the  group-mapfile  indicating the new pool for this user.  If the resulting URL-encoded
              lease (hardlink) already exists but points to a different pool group then would  result  from  the
              running  of this plugin, the plugin would normally fail. This option instructs the plugin to remap
              to the new pool group.

       <b>-mapall</b>
              When enabled, a failure will be triggered if not all of the FQANs were successfully mapped to pri‐
              mary or secondary Group IDs.

       <b>-mapmin</b> <u>minimum</u> <u>number</u> <u>of</u> <u>mappings</u>
              This option will set a minimum amount of FQANs that have to be mapped for the plugin  to  succeed.
              Default  is  '0'.   Note: if the minimum is unset or set to 0 the plugin will succeed (if no other
              errors occur) even if no pool groups were found.

       <b>-strict_poolprefix_match</b> <u>{yes|no}</u>
              If this is set to 'yes', a line in the group-mapfile like <b>&lt;FQAN&gt;</b> <b>.poolgr</b> will  result  in  mapping
              pool  groups  matching  only  the  regexp <b>poolgr[0-9]+</b>.  Otherwise it will be allowed to match the
              wider range of <b>poolgr.*</b> (legacy behaviour).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>LCMAPS_MOD_SUCCESS</b>
              Success.

       <b>LCMAPS_MOD_FAIL</b>
              Failure.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       GROUPMAPDIR
              When no groupmapdir is specified as option to the plugin, it will try to obtain the file  location
              from this environment variable.

</pre><h4><b>BUGS</b></h4><pre>
       Please   report   any   errors  to  the  Nikhef  Grid  Middleware  Security  Team  &lt;grid-mw-security-sup‐
       <a href="mailto:port@nikhef.nl">port@nikhef.nl</a>&gt;.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/lcmaps.db.5.html">lcmaps.db</a></b>(5), <b><a href="../man3/lcmaps.3.html">lcmaps</a></b>(3).

</pre><h4><b>AUTHORS</b></h4><pre>
       LCMAPS and the LCMAPS plug-ins were  written  by  the  Grid  Middleware  Security  Team  &lt;grid-mw-securi‐
       <a href="mailto:ty@nikhef.nl">ty@nikhef.nl</a>&gt;.

Stichting FOM/Nikhef                            February 6, 2015                    <u><a href="../man8/LCMAPS_VOMS_POOLGROUP.MOD.8.html">LCMAPS_VOMS_POOLGROUP.MOD</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>