<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>swtpm - TPM Emulator for TPM 1.2 and 2.0</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/swtpm">swtpm_0.7.3-0ubuntu8_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       swtpm - TPM Emulator for TPM 1.2 and 2.0

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>swtpm</b> <b>socket</b> <b>[OPTIONS]</b>

       <b>swtpm</b> <b>chardev</b> <b>[OPTIONS]</b>

       <b>swtpm</b> <b>cuse</b> <b>[OPTIONS]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>swtpm</b> implements a TPM software emulator built on libtpms.  It provides access to TPM functionality over
       a TCP/IP socket interface or it can listend for commands on a character device, or create a CUSE
       (character device in userspace) interface for receiving of TPM commands.

       Unless corresponding command line parameters are used, the <b>swtpm</b> socket version requires that the
       environment variable <u>TPM_PORT</u> be set to the TCP/IP port the process is supposed to listen on for TPM
       request messages.

       Similarly, the environment variable <u>TPM_PATH</u> can be set and contain the name of a directory where the TPM
       can store its persistent state into.

       The <b>swtpm</b> process can be gracefully terminated by sending a <u>SIGTERM</u> signal to it.

       The <b>swtpm</b> cuse version requires root rights to start the TPM.

</pre><h4><b>Options</b> <b>for</b> <b>socket</b> <b>interface</b></h4><pre>
       The following options are supported if the <u>socket</u> interface is chosen:

       <b>-p|--port</b> <b>&lt;port</b>&gt;
           Use the given port rather than using the environment variable TPM_PORT.

       <b>-t|--terminate</b>
           Terminate the TPM after the client has closed the connection.

       <b>--server</b> <b>[type=tcp][,port=&lt;port&gt;[,bindaddr=&lt;address&gt;</b> <b>[,ifname=&lt;ifname&gt;]]][,fd=&lt;fd&gt;][,disconnect]</b>
           Expect  TCP connections on the given port; if a port is not provided a file descriptor must be passed
           with the fd parameter and the commands are read from  this  file  descriptor  then.   If  a  port  is
           provided the <u>bind</u> <u>address</u> on which to listen for TCP connections can be provided as well; the default
           bind  address  is  127.0.0.1.  If a link local IPv6 address is provided, the name of the interface to
           bind to must be provided with <u>ifname</u>.

           This parameter enables a persistent connection by default unless the disconnect option is given. This
           parameter should be used rather than the -p and --fd options.

       <b>--server</b> <b>type=unixio[,path=&lt;path&gt;][,fd=&lt;fd&gt;]</b> <b>[,mode=&lt;0...&gt;][,uid=&lt;uid&gt;][,gid=&lt;gid&gt;]</b>
           Expect UnixIO connections on the given path. If no path is provided, a file descriptor must be passed
           instead. The mode parameter allows a user to set the file mode bits of the UnixIO path. The mode bits
           value must be given as an octal number starting with a '0'.  The default value is 0770. uid  and  gid
           set the ownership of the UnixIO socket's path.  This operation requires root privileges.

</pre><h4><b>Options</b> <b>for</b> <b>character</b> <b>device</b> <b>interface</b></h4><pre>
       The following options are supported if the <u>chardev</u> interface is chosen:

       <b>-c|--chardev</b> <b>&lt;device</b> <b>path</b>&gt;
           Use the given device to listen for TPM commands and send response on.

       <b>--vtpm-proxy</b>
           Create a Linux vTPM proxy device instance and read TPM commands from its backend device.

</pre><h4><b>Options</b> <b>for</b> <b>the</b> <b>CUSE</b> <b>interface</b></h4><pre>
       The following options are supported if the <u>cuse</u> interface is chosen:

       <b>-n|--name</b> <b>&lt;NAME</b>&gt;
           The  TPM will use a device with the given name. A device with the given name will be created in /dev.
           This is a mandatory option.

       <b>-M|--maj</b> <b>&lt;MAJOR</b>&gt;
           Create the device with the given major number.

       <b>-m|--min</b> <b>&lt;MINOR</b>&gt;
           Create the device with the given minor number.

</pre><h4><b>Options</b> <b>for</b> <b>socket</b> <b>and</b> <b>character</b> <b>device</b> <b>interfaces:</b></h4><pre>
       The following options are supported by the socket and character device interfaces:

       <b>-f|--fd</b> <b>&lt;fd</b>&gt;
           Use the given socket file descriptor or character device file descriptor for receiving  TPM  commands
           and sending responses.  For the socket interface, this option automatically assumes -t.

       <b>-d|--daemon</b>
           Daemonize the process.

       <b>--ctrl</b> <b>type=[unixio|tcp][,path=&lt;path&gt;]</b> <b>[,port=&lt;port&gt;[,bindaddr=&lt;address&gt;[,ifname=&lt;ifname&gt;]]]</b>
       <b>[,fd=&lt;filedescriptor&gt;|clientfd=&lt;filedescriptor&gt;]</b> <b>[,mode=&lt;0...&gt;][,uid=&lt;uid&gt;][,gid=&lt;gid&gt;]</b>
           This  option  adds  a  control channel to the TPM. The control channel can either use a UnixIO socket
           with a given <u>path</u> or <u>filedescriptor</u> or it can use a TCP socket on the given <u>port</u>  or  <u>filedescriptor</u>.
           If  a  port  is  provided  the <u>bind</u> <u>address</u> on which to listen for TCP connections can be provided as
           well; the default bind address is 127.0.0.1. If a link local IPv6 address is provided,  the  name  of
           the interface to bind to must be provided with <u>ifname</u>.

           The  mode  parameter allows a user to set the file mode bits of the UnixIO path.  The mode bits value
           must be given as an octal number starting with a '0'.  The default value is 0770. uid and gid set the
           ownership of the UnixIO socket's path.  This operation requires root privileges.

           The control channel enables out-of-band control of the TPM, such as resetting the TPM.

</pre><h4><b>Options</b> <b>for</b> <b>all</b> <b>interfaces</b></h4><pre>
       The following options are support by all interfaces:

       <b>--tpmstate</b> <b>dir=&lt;dir&gt;[,mode=&lt;0...&gt;]|backend-uri=&lt;uri&gt;</b>
           Use the given path rather than using the environment variable TPM_PATH.

           If <u>dir</u> is specified, the TPM state files will be written to the <u>dir</u> with the given  file  <u>mode</u>  bits.
           This value must be given as an octal number starting with a '0'.  The default value is 0640.

           If   <u>backend-uri</u>   is  specified,  the  TPM  state  data  will  be  stored  to  the  URI.   Currently
           <u>backend-uri=dir://&lt;path_to_dir</u>&gt; and <u>backend-uri=file://&lt;path_to_dir</u>&gt; are available. For 'dir://', the
           URI should specify the path to the directory where files are stored. If <u>path_to_dir</u> starts with a '/'
           then the path is interpreted as an absolute path, otherwise it is a  path  relative  to  the  current
           directory.   For 'file://', the URI should specify a single file or block device where TPM state will
           be stored. A blockdevice must exist already and be big enough to store all state. (since v0.7)

       <b>--tpm2</b>
           Choose TPM 2 functionality; by default a TPM 1.2 is chosen.

       <b>--log</b> <b>[fd=&lt;fd&gt;|file=&lt;path&gt;][,level=&lt;n&gt;]</b> <b>[,prefix=&lt;prefix&gt;][,truncate]</b>
           Enable logging to a file given its file descriptor or its path. Use '-'  for  path  to  suppress  the
           logging.

           The  level  parameter  allows a user to choose the level of logging. Starting at log level 5, libtpms
           debug logging is activated.

           All logged lines will be prefixed with prefix. By default no prefix is prepended.

           If <u>truncate</u> is passed, the log file will be truncated.

       <b>--locality</b> <b>reject-locality-4[,allow-set-locality]</b>
           The <u>reject-locality-4</u> parameter will cause TPM error messages to be returned for requests to set  the
           TPM into locality 4.

           The  <u>allow-set-locality</u>  parameter allows the swtpm to receive TPM/TPM2_SetLocality commands. This is
           parameter is useful if the Linux VTPM proxy driver access is  enabled  by  file  descriptor  passing.
           This  option  is  implied by the <u>--vtpm-proxy</u> option and therefore need not be explicitly set if this
           option is passed. In all other cases care should be taken as to who can send the TPM/TPM2_SetLocality
           command.

       <b>--key</b> <b>file=&lt;keyfile&gt;|fd=&lt;fd&gt;</b> <b>[,format=&lt;hex|binary&gt;][,mode=aes-cbc|aes-256-cbc],</b> <b>[remove[=true|false]]</b>
           Enable encryption of the state files of the TPM. The keyfile must contain an  AES  key  of  supported
           size; 128 bit (16 bytes) and 256 bit (32 bytes) keys are supported.

           The key may be in binary format, in which case the file size must be 16 or 32 bytes. If the key is in
           hex format (default), the key may consist of 32 or 64 hex digits starting with an optional '0x'.

           The  <u>mode</u>  parameter  indicates  which  block  chaining  mode  is  to  be  used.   Currently  aes-cbc
           (aes-128-cbc) and aes-256-cbc are  supported.   The  encrypted  data  is  integrity  protected  using
           encrypt-then-mac.

           The <u>remove</u> parameter will attempt to remove the given keyfile once the key has been read.

       <b>--key</b> <b>pwdfile=&lt;passphrase</b> <b>file&gt;|pwdfd=&lt;fd&gt;</b>
       <b>[,mode=aes-cbc|aes-256-cbc][remove[=true|false]][,kdf=sha512|pbkdf2]</b>
           This  variant of the key parameter allows a user to provide a passphrase in a file.  The file is read
           and a key is derived from it using either a SHA512 hash or PBKDF2. By default PBKDF2 is used.

       <b>--migration-key</b> <b>file=&lt;keyfile&gt;|fd=&lt;fd&gt;</b> <b>[,format=&lt;hex|binary&gt;][,mode=aes-cbc|aes-256-cbc]</b>
       <b>[,remove[=true|false]]</b>
           The availability of a migration key ensures that the state  of  the  TPM  will  not  be  revealed  in
           unencrypted  form  when the TPM state blobs are retrieved through the ioctl interface.  The migration
           key is not used for encrypting TPM state written to files, this is what the <u>--key</u> parameter  is  used
           for.

           The migration key and the key used for encrypting the TPM state files may be the same.

           While  the  key for the TPM state files needs to stay with those files it encrypts, the migration key
           needs to stay with the TPM state blobs. If for example the state of the TPM is migrated between hosts
           in a data center, then the TPM migration key must be available at all the destinations, so in  effect
           it  may  have  to be a key shared across all machines in the datacenter. In contrast to that, the key
           used for encrypting the TPM state <b>files</b> can be different for each TPM and need only be  available  on
           the host where the TPM state resides.

           The migration key enables the encryption of the TPM state blobs.  The keyfile must contain an AES key
           of supported size; 128 bit (16 bytes) and 256 bit (32 bytes) keys are supported.

           The key may be in binary format, in which case the file size must be 16 or 32 bytes. If the key is in
           hex format (default), the key may consist of 32 or 64 hex digits starting with an optional '0x'.

           The  <u>mode</u>  parameter  indicates  which  block  chaining  mode  is  to  be  used.   Currently  aes-cbc
           (aes-128-cbc) and aes-256-cbc are  supported.   The  encrypted  data  is  integrity  protected  using
           encrypt-then-mac.

           The <u>remove</u> parameter will attempt to remove the given keyfile once the key has been read.

       <b>--migration-key</b> <b>pwdfile=&lt;passphrase</b> <b>file&gt;|pwdfd=&lt;fd&gt;</b>
       <b>[,mode=aes-cbc|aes-256-cbc][,remove[=true|false]][,pdf=sha512|pbkdf2]</b>
           This  variant of the key parameter allows a user to provide a passphrase in a file.  The file is read
           and a key is derived from it using either a SHA512 hash or PBKDF2. By default PBKDF2 is used.

       <b>--pid</b> <b>file=&lt;pidfile&gt;|fd=&lt;filedescriptor&gt;</b>
           This options allows a user to set the name of file where the process ID (pid)  of  the  TPM  will  be
           written  into.  It  is  also  possible  to  pass a file descriptor to a file that has been opened for
           writing.

       <b>-r|--runas</b> <b>&lt;owner&gt;</b>
           Switch to the given user. This option can only be used when swtpm is started as root.

       <b>--seccomp</b> <b>action=none|log|kill</b> (since v0.2)
           This option allows a user to select the action to take by the  seccomp  profile  when  a  syscall  is
           executed  that  is not allowed. The default is <u>kill</u>. To disable the seccomp profile, choose <u>none</u>. The
           <u>log</u> action logs offending syscalls.  The <u>log</u> action is only available if libseccomp supports logging.

           This option is only available on Linux and only if swtpm was compiled with libseccomp support.

       <b>--flags</b> <b>[not-need-init]</b> <b>[,startup-clear|startup-state|startup-deactivated|startup-none]</b>
           The <u>not-need-init</u> flag enables the TPM to accept TPM commands right after start without requiring  an
           INIT to be sent to it through the command channel (see the '-i' option of swtpm_ioctl).

           The  <u>startup</u>  options  cause  a  TPM_Startup  or  TPM2_Startup  command to automatically be sent. The
           <u>startup-deactivated</u> option is only valid for a TPM 1.2. These options imply <u>not-need-init</u>, except for
           the <u>startup-none</u> option, which results in no command being sent.

           If <u>--vtpm-proxy</u> is used, <u>startup-clear</u> is automatically chosen but this  can  be  changed  with  this
           option.

       <b>--print-capabilities</b> (since v0.2)
           Print capabilities that were added to swtpm after version 0.1. The output may contain the following:

               {
                 "type": "swtpm",
                 "features": [
                   "tpm-1.2",
                   "tpm-2.0",
                   "cmdarg-seccomp",
                   "cmdarg-key-fd",
                   "cmdarg-pwd-fd",
                   "cmdarg-print-states",
                   "nvram-backend-dir",
                   "nvram-backend-file",
                   "tpm-send-command-header",
                   "flags-opt-startup",
                   "rsa-keysize-1024",
                   "rsa-keysize-2048",
                   "rsa-keysize-3072"
                 ],
                 "version": "0.7.0"
               }

           The version field is available since v0.7.

           The meaning of the feature verbs is as follows:

           <b>tpm-1.2</b> (since v0.7)
               TPM 1.2 emulation is supported (libtpms is compiled with 1.2 support).

           <b>tpm-2.0</b> (since v0.7)
               TPM 2 emulation is supported (libtpms is compiled with 2.0 support).

               (the <u>--tpm2</u> option is supported)

           <b>cmdarg-seccomp</b> (since v0.2)
               The <u>--seccomp</u> option is supported.

           <b>cmdarg-key-fd</b> (since v0.2)
               The <u>--key</u> option supports the <u>fd=</u> parameter.

           <b>cmdarg-pwd-fd</b> (since v0.2)
               The <u>--key</u> option supports the <u>pwdfd=</u> parameter.

           <b>cmdarg-print-states</b> (since v0.7)
               The <u>--print-states</u> option is supported.

           <b>nvram-backend-dir</b> (since v0.7)
               The <u>--tpmstate</u> option supports the <u>backend-uri=dir://...</u>  parameter.

           <b>nvram-backend-file</b> (since v0.7)
               The <u>--tpmstate</u> option supports the <u>backend-uri=file://...</u>  parameter.

           <b>tpm-send-command-header</b> (since v0.2)
               The  TPM  2  commands  may  be  prefixed  by  a  header that carries a 4-byte command, 1 byte for
               locality, and 4-byte TPM 2 command length indicator.  The TPM 2 will  respond  by  preprending  a
               4-byte response indicator and a 4-byte trailer. All data is sent in big endian format.

           <b>flags-opt-startup</b> (since v0.3)
               The <u>--flags</u> option supports the <u>startup-...</u> options.

           <b>rsa-keysize-2048</b> (since v0.4)
               The  TPM  2 supports the shown RSA key sizes. If none of the rsa-keysize verbs is shown then only
               RSA 2048 bit keys are supported.

       <b>--print-states</b> (since v0.7)
           This option allows to print out the TPM 1.2 or TPM 2 state blobs  that  are  currently  stored  in  a
           storage  backend.  This  option  requires  that the storage backend be specified using the <u>--tpmstate</u>
           option and if TPM 2 state blobs are supposed to be shown, the <u>--tpm2</u> option must be passed.

           The following shows the JSON output of this option. It indicates that the  'permall'  and  'volatile'
           states are available.

               {
                 "type": "swtpm",
                 "states": [
                   {
                     "name": "permall",
                     "size": 6013
                   }, {
                     "name": "volatile",
                     "size": 1087
                   }
                 ]
               }

       <b>-h|--help</b>
           Display usage info.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>swtpm_bios</b>, <b>swtpm_cuse</b>

swtpm                                              2024-11-08                                           <u><a href="../man8/swtpm.8.html">swtpm</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>