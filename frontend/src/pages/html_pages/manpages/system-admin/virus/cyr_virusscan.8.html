<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cyr_virusscan - Cyrus IMAP documentation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/cyrus-common">cyrus-common_3.10.2-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cyr_virusscan - Cyrus IMAP documentation

       Scan for viruses using configured virus scanner or manage infected messages using search criteria.

</pre><h4><b>SYNOPSIS</b></h4><pre>
          <b>cyr_virusscan</b> [ <b>-C</b> <u>config-file</u> ] [ <b>-s</b> <u>imap-search-string</u> ] [ <b>-r</b> [ <b>-n</b>] ] [<b>-v</b>] [ <u>mboxpattern1</u> ... ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>cyr_virusscan</b>  can  be  used  to invoke an external virus scanner (currently only <u>ClamAV</u> is supported) to
       scan specified IMAP mailboxes. If no mboxpattern is given, <b>cyr_virusscan</b> works on all mailboxes.

       Alternately, with the <b>-s</b> option, the IMAP SEARCH string will be used as a specification of messages which
       are <u>assumed</u> to be infected, and will be treated as such.  The virus scanner is not  invoked.  Useful  for
       removing messages without a distinct signature, such as Phish.

       A table of infected messages will be output.

       To remove infected messages, use the <b>-r</b> flag. Infected messages will be expunged from the user's mailbox.

       With  the  notify  flag, <b>-n</b>, notifications will be appended to the inbox of the mailbox owner, containing
       message digest information for the affected mail.  This flag only works  in  combination  with  <b>-r</b>.   The
       notification message can by customised by template, for details see <u>Notifications</u> below.

       <b>cyr_virusscan</b>  can  be  configured to run periodically by <a href="../man8/cron.8.html">cron</a>(8) via <a href="../man5/crontab.5.html">crontab</a>(5) or your preferred method
       (i.e. <a href="file:/etc/cron.hourly">/etc/cron.hourly</a>), or by <u><a href="../man8/master.8.html">master</a>(8)</u> via the EVENTS{} section in <u><a href="../man5/cyrus.conf.5.html">cyrus.conf</a>(5)</u>.

       <b>cyr_virusscan</b> reads its configuration options out of the <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u> file unless specified otherwise by
       <b>-C</b>.

       Note that Cyrus does not ship with any virus scanners: you need to install one separately to make use  of
       it with Cyrus.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-C</b> <b>config-file</b>
              Use the specified configuration file <u>config-file</u> rather than the default <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>.

       <b>-n,</b> <b>--notify</b>
              Notify  mailbox  owner  of  deleted messages via email.  This flag is only operable in combination
              with <b>-r</b>.

       <b>-r,</b> <b>--remove-infected</b>
              Remove infected messages.

       <b>-s</b> <b>imap-search-string,</b> <b>--search=imap-search-string</b>
              Rather than scanning for viruses, messages  matching  the  search  criteria  will  be  treated  as
              infected.

       <b>-v,</b> <b>--verbose</b>
              Produce more verbose output

</pre><h4><b>NOTIFICATIONS</b></h4><pre>
       When  the  <b>-n</b>  flag  is  provided,  notifications  are  sent to mailbox owners when infected messages are
       removed.  One notification is sent per owner, containing a digest of each message that was  deleted  from
       any of their mailboxes.

       The  default  notification  subject  is  "Automatically deleted mail", which can be overridden by setting
       <b>virusscan_notification_subject</b> in <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u> to a UTF-8 value.

       Each infected message will be described according to the following template:

          The following message was deleted from mailbox '%MAILBOX%'
          because it was infected with virus '%VIRUS%'

              Message-ID: %MSG_ID%
              Date: %MSG_DATE%
              From: %MSG_FROM%
              Subject: %MSG_SUBJECT%
              IMAP UID: %MSG_UID%

       To use a custom template, create a UTF-8 file containing your desired text and using the same %-delimited
       substitutions as above, and set the <b>virusscan_notification_template</b> option in <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u> to its path.

       The notification message will be properly MIME-encoded at delivery. Do not pre-encode the  template  file
       or the subject!

       When  <b>cyr_virusscan</b>  starts  up,  if notifications have been requested (with the <b>-n</b> flag), a basic sanity
       check of the template will be performed prior to initialising the antivirus engine.  If it  appears  that
       the  resultant  notifications would be undeliverable for some reason, <b>cyr_virusscan</b> will exit immediately
       with an error, rather than risk deleting messages without notifying.

</pre><h4><b>EXAMPLES</b></h4><pre>
          <b>cyr_virusscan</b>
          <b>Scan</b> <b>all</b> <b>mailboxes,</b> <b>printing</b> <b>report</b> <b>on</b> <b>the</b> <b>screen.</b>  <b>Do</b> <b>not</b> <b>remove</b> <b>infected</b> <b>messages.</b>

          <b>cyr_virusscan</b> <b>-r</b> <b>-n</b> <b>user/bovik</b>
          <b>Scan</b> <b>mailbox</b> <u>user/bovik</u><b>,</b> <b>removing</b> <b>infected</b> <b>messages</b> <b>and</b> <b>append</b> <b>notifications</b> <b>to</b> <b>Bovik's</b> <b>inbox.</b>

          <b>cyr_virusscan</b> <b>-r</b> <b>-n</b> <b>-s</b> <b>'SUBJECT</b> <b>"Fedex"'</b> <b>user/bovik</b>
          <b>Search</b> <b>mailbox</b> <b>user/bovik</b> <b>for</b> <b>messages</b> <b>which</b> <b>have</b> <b>Fedex</b> <b>in</b> <b>the</b> <b>subject</b> <b>line,</b> <b>removing</b>  <b>them</b>  <b>all,</b>  <b>and</b>
          <b>appending</b> <b>notifications</b> <b>to</b> <b>Bovik's</b> <b>inbox.</b>

</pre><h4><b>HISTORY</b></h4><pre>
       Virus scan support was first introduced in Cyrus version 3.0.

</pre><h4><b>FILES</b></h4><pre>
       /etc/imapd.conf

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>, <u><a href="../man8/master.8.html">master</a>(8)</u>, <u>ClamAV</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       The Cyrus Team, Nic Bernstein (Onlight)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       1993â€“2025, The Cyrus Team

3.10.2                                            Jun 27, 2025                                  <u><a href="../man8/CYR_VIRUSSCAN.8.html">CYR_VIRUSSCAN</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>