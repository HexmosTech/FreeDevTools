<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oarnodecheck - OAR node health check mechanism</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/oar-node">oar-node_2.6.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       oarnodecheck - OAR node health check mechanism

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>oarnodecheckrun</b>

       <b>oarnodecheckquery</b>

       <b>oarnodechecklist</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       oarnodecheck is composed of 3 commands:

       <u>oarnodecheckrun</u>
           <u>oarnodecheckrun</u>  must  be run as root by cron or a systemd timer (on an hourly basis for instance) to
           execute all check scripts in the <u>//etc/oar/check.d/</u> directory.

           The <u>%%OARCONFDIR/check.d/</u> directory contains admin defined scripts, which perform checks with  regard
           to possible node health problems.

           If  and  only  if a problem is detected, a check-log file is to be created by the check script in the
           check-log directory. The check script must use the <u>CHECKLOGFILE</u> environment variable,  which  provide
           the pathname to the check-log to eventually create.

           If  the OAR cpuset mechanism is enabled, <u>oarnodecheckrun</u> does not launch checks when jobs are running
           on the node. A stamp file is created or updated when the scripts are actually run.

       <u>oarnodecheckquery</u>
           <u>oarnodecheckquery</u> is meant to be called by the OAR ping checker, to report the node health status.

           It can be configured so in the <u>/etc/oar/oar.conf</u> file of the OAR server:

               PINGCHECKER_TAKTUK_ARG_COMMAND="-t 3 broadcast exec [ /usr/bin/oarnodecheckquery ]

           The OAR node health status is reported bad as soon as  a  check-log  file  exists  in  the  check-log
           directory: <u>/var/lib/oar/checklogs/</u>.

           <u>oarnodecheckquery</u>  checks  for the existence and modification date of the <u>oarnodecheckrun</u> stamp file.
           If non-existent or older than one hour, <u>oarnodecheckrun</u>  is  run.  Then,  finally,  <u>oarnodecheckquery</u>
           reports an error if any check-log exists in the check-log directory.

           Since  <u>oarnodecheckquery</u>  may  run  the  check  scripts,  the  OAR ping checker timeout must be tuned
           accordingly in the OAR server configuration.

       <u>oarnodechecklist</u>
           <u>oarnodechecklist</u> lists the current recorded check-logs.

</pre><h4><b>EXAMPLE</b> <b>OF</b> <b>CHECK</b> <b>SCRIPT</b></h4><pre>
       The following is an example of check script to place in the check scripts directory: <u>/etc/oar/check.d</u>

           #!<a href="file:/bin/bash">/bin/bash</a>
           ###############################################################################
           # Perform a check and report to CHECKLOGFILE
           # WARNING:
           # The CHECKLOGFILE file must not be created unless the check really unveiled
           # a problem.

           # Print to stderr if CHECKLOGFILE is not defined yet (e.g. as the script is
           # not called from oarnodecheckcron the CHECKLOGFILE environment variable is
           # not defined)
           [ -n "$CHECKLOGFILE" ] || CHECKLOGFILE=/dev/stderr

           ###############################################################################
           # YOUR CHECK SCRIPT GOES BELOW

           # Example of check
           [ -d /var/lib/oar ] || echo "OAR runtime directory (/var/lib/oar) does not exist)" &gt; $CHECKLOGFILE

</pre><h4><b>COPYRIGHTS</b></h4><pre>
        Copyright 2003-2025 Laboratoire d'Informatique de Grenoble (<a href="http://www.liglab.fr">http://www.liglab.fr</a>). This software is licensed under the GNU General Public License Version 2 or above. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

oarnodecheckrun                                    2025-03-24                                 <u><a href="../man8/oarnodecheckrun.8.html">oarnodecheckrun</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>