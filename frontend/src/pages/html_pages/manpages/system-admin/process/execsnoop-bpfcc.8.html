<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>execsnoop - Trace new processes via exec() syscalls. Uses Linux eBPF/bcc.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bpfcc-tools">bpfcc-tools_0.31.0+ds-7ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       execsnoop - Trace new processes via exec() syscalls. Uses Linux eBPF/bcc.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>execsnoop</b>  <b>[-h]</b>  <b>[-T]</b> <b>[-t]</b> <b>[-x]</b> <b>[--cgroupmap</b> <b>CGROUPMAP]</b> <b>[--mntnsmap</b> <b>MAPPATH]</b> <b>[-u</b> <b>USER]</b> <b>[-q]</b> <b>[-n</b> <b>NAME]</b> <b>[-l</b>
       <b>LINE]</b> <b>[-U]</b> <b>[--max-args</b> <b>MAX_ARGS]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       execsnoop traces new processes, showing the filename executed and argument list.

       It works by traces the execve() system call (commonly used exec() variant).  This catches  new  processes
       that  follow  the  fork-&gt;exec sequence, as well as processes that re-exec() themselves. Some applications
       fork() but do not exec(), eg, for worker processes, which won't be included in the execsnoop output.

       This works by tracing the kernel sys_execve() function using dynamic tracing, and will need  updating  to
       match any changes to this function.

       Since this uses BPF, only the root user can use this tool.

</pre><h4><b>REQUIREMENTS</b></h4><pre>
       CONFIG_BPF and bcc.

</pre><h4><b>OPTIONS</b></h4><pre>
       -h     Print usage message.

       -T     Include a time column (HH:MM:SS).

       -U     Include UID column.

       -t     Include a timestamp column.

       -u USER
              Filter by UID (or username)

       -x     Include failed exec()s

       -q     Add  "quotemarks"  around  arguments. Escape quotemarks in arguments with a backslash. For tracing
              empty arguments or arguments that contain whitespace.

       -n NAME
              Only print command lines matching this name (regex)

       -l LINE
              Only print commands where arg contains this line (regex)

       --max-args MAXARGS
              Maximum number of arguments parsed and displayed, defaults to 20

       --cgroupmap MAPPATH
              Trace cgroups in this BPF map only (filtered in-kernel).

       --mntnsmap  MAPPATH
              Trace mount namespaces in this BPF map only (filtered in-kernel).

       -P PPID
              Trace this parent PID only.

       <b>EXAMPLES</b>

       Trace all exec() syscalls:
              # <b>execsnoop</b>

       Trace all exec() syscalls, and include timestamps:
              # <b>execsnoop</b> <b>-t</b>

       Display process UID:
              # <b>execsnoop</b> <b>-U</b>

       Trace only UID 1000:
              # <b>execsnoop</b> <b>-u</b> <b>1000</b>

       Trace only processes launched by root and display UID column:
              # <b>execsnoop</b> <b>-Uu</b> <b>root</b>

       Include failed exec()s:
              # <b>execsnoop</b> <b>-x</b>

       Put quotemarks around arguments.
              # <b>execsnoop</b> <b>-q</b>

       Only trace exec()s where the filename contains "mount":
              # <b>execsnoop</b> <b>-n</b> <b>mount</b>

       Only trace exec()s where argument's line contains "testpkg":
              # <b>execsnoop</b> <b>-l</b> <b>testpkg</b>

       Trace a set of cgroups only (see special_filtering.md from bcc sources for more details):
              # <b>execsnoop</b> <b>--cgroupmap</b> <b>/sys/fs/bpf/test01</b>

</pre><h4><b>FIELDS</b></h4><pre>
       TIME   Time of exec() return, in HH:MM:SS format.

       TIME(s)
              Time of exec() return, in seconds.

       UID    User ID

       PCOMM  Parent process/command name.

       PID    Process ID

       PPID   Parent process ID

       RET    Return value of exec(). 0 == successs. Failures are only shown when using the -x option.

       ARGS   Filename for the exec(), followed be up to 19  arguments.  An  ellipsis  "..."  is  shown  if  the
              argument list is known to be truncated.

</pre><h4><b>OVERHEAD</b></h4><pre>
       This traces the kernel execve function and prints output for each event. As the rate of this is generally
       expected to be low (&lt; 1000/s), the overhead is also expected to be negligible. If you have an application
       that is calling a high rate of exec()s, then test and understand overhead before use.

</pre><h4><b>SOURCE</b></h4><pre>
       This is from bcc.

              https://github.com/iovisor/bcc

       Also  look  in  the bcc distribution for a companion _examples.txt file containing example usage, output,
       and commentary for this tool.

</pre><h4><b>OS</b></h4><pre>
       Linux

</pre><h4><b>STABILITY</b></h4><pre>
       Unstable - in development.

</pre><h4><b>AUTHOR</b></h4><pre>
       Brendan Gregg, Rocky Xing

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/opensnoop.1.html">opensnoop</a>(1)

USER COMMANDS                                      2020-02-20                                       <u><a href="../man8/execsnoop.8.html">execsnoop</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>