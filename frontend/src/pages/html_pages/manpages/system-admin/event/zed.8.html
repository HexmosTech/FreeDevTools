<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZED — ZFS Event Daemon</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/zfs-zed">zfs-zed_2.3.2-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ZED — ZFS Event Daemon

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ZED</b> [<b>-fFhILMvVZ</b>] [<b>-d</b> <u>zedletdir</u>] [<b>-p</b> <u>pidfile</u>] [<b>-P</b> <u>path</u>] [<b>-s</b> <u>statefile</u>] [<b>-j</b> <u>jobs</u>] [<b>-b</b> <u>buflen</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>ZED</b> (ZFS Event Daemon) monitors events generated by the ZFS kernel module.  When a zevent (ZFS Event)
       is  posted,  the  <b>ZED</b> will run any ZEDLETs (ZFS Event Daemon Linkage for Executable Tasks) that have been
       enabled for the corresponding zevent class.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-h</b>  Display a summary of the command-line options.

       <b>-L</b>  Display license information.

       <b>-V</b>  Display version information.

       <b>-v</b>  Be verbose.

       <b>-f</b>  Force the daemon to run if at all possible, disabling security checks and  throwing  caution  to  the
           wind.  Not recommended for use in production.

       <b>-F</b>  Don't daemonize: remain attached to the controlling terminal, log to the standard I/O streams.

       <b>-M</b>  Lock  all  current  and  future  pages in the virtual memory address space.  This may help the daemon
           remain responsive when the system is under heavy memory pressure.

       <b>-I</b>  Request that the daemon idle rather than exit when the kernel modules are not loaded.  Processing  of
           events will start, or resume, when the kernel modules are (re)loaded.  Under Linux the kernel modules
           cannot be unloaded while the daemon is running.

       <b>-Z</b>  Zero the daemon's state, thereby allowing zevents still within the kernel to be reprocessed.

       <b>-d</b> <u>zedletdir</u>
           Read the enabled ZEDLETs from the specified directory.

       <b>-p</b> <u>pidfile</u>
           Write the daemon's process ID to the specified file.

       <b>-P</b> <u>path</u>
           Custom  $PATH  for zedlets to use.  Normally zedlets run in a locked-down environment, with hardcoded
           paths to the ZFS commands ($ZFS, $ZPOOL, $ZED, …), and a hard-coded $PATH.  This is done for security
           reasons.  However, the ZFS test suite uses a custom PATH for its ZFS commands, and passes it  to  <b>ZED</b>
           with <b>-P</b>.  In short, <b>-P</b> is only to be used by the ZFS test suite; never use it in production!

       <b>-s</b> <u>statefile</u>
           Write the daemon's state to the specified file.

       <b>-j</b> <u>jobs</u>
           Allow  at  most  <u>jobs</u>  ZEDLETs to run concurrently, delaying execution of new ones until they finish.
           Defaults to <b>16</b>.

       <b>-b</b> <u>buflen</u>
           Cap kernel event buffer growth to <u>buflen</u> entries.  This buffer is grown when  the  daemon  misses  an
           event,  but  results  in  unreclaimable  memory  use  in  the  kernel.  A value of <b>0</b> removes the cap.
           Defaults to <b>1048576</b>.

</pre><h4><b>ZEVENTS</b></h4><pre>
       A zevent is comprised of a list of nvpairs (name/value  pairs).   Each  zevent  contains  an  EID  (Event
       IDentifier) that uniquely identifies it throughout the lifetime of the loaded ZFS kernel module; this EID
       is  a  monotonically  increasing  integer  that  resets to 1 each time the kernel module is loaded.  Each
       zevent also contains a class string that identifies the type of event.  For brevity, a subclass string is
       defined that omits the leading components of the class string.  Additional nvpairs exist to provide event
       details.

       The kernel maintains a list of recent zevents that can be viewed (along with their  associated  lists  of
       nvpairs) using the <b>zpool</b> <b>events</b> <b>-v</b> command.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       ZEDLETs  to  be  invoked in response to zevents are located in the <u>enabled-zedlets</u> directory (<u>zedletdir</u>).
       These can be symlinked or copied from the  <u>installed-zedlets</u>  directory;  symlinks  allow  for  automatic
       updates  from the installed ZEDLETs, whereas copies preserve local modifications.  As a security measure,
       since ownership change is a privileged operation, ZEDLETs must be owned by root.  They must have  execute
       permissions  for  the  user,  but  they must not have write permissions for group or other.  Dotfiles are
       ignored.

       ZEDLETs are named after the zevent class for which they should be invoked.  In particular, a ZEDLET  will
       be  invoked for a given zevent if either its class or subclass string is a prefix of its filename (and is
       followed by a non-alphabetic character).  As  a  special  case,  the  prefix  <b>all</b>  matches  all  zevents.
       Multiple ZEDLETs may be invoked for a given zevent.

</pre><h4><b>ZEDLETS</b></h4><pre>
       ZEDLETs  are  executables invoked by the ZED in response to a given zevent.  They should be written under
       the presumption they can be invoked concurrently, and they should use appropriate locking to  access  any
       shared resources.  Common variables used by ZEDLETs can be stored in the default rc file which is sourced
       by scripts; these variables should be prefixed with <b>ZED_</b>.

       The  zevent  nvpairs are passed to ZEDLETs as environment variables.  Each nvpair name is converted to an
       environment variable in the following manner:
       1.   it is prefixed with <b>ZEVENT_</b>,
       2.   it is converted to uppercase, and
       3.   each non-alphanumeric character is converted to an underscore.

       Some additional environment variables have been defined to  present  certain  nvpair  values  in  a  more
       convenient form.  An incomplete list of zevent environment variables is as follows:
       <b>ZEVENT_EID</b>          The Event IDentifier.
       <b>ZEVENT_CLASS</b>        The zevent class string.
       <b>ZEVENT_SUBCLASS</b>     The zevent subclass string.
       <b>ZEVENT_TIME</b>         The time at which the zevent was posted as “<u>seconds</u> <u>nanoseconds</u>” since the Epoch.
       <b>ZEVENT_TIME_SECS</b>    The <u>seconds</u> component of <b>ZEVENT_TIME</b>.
       <b>ZEVENT_TIME_NSECS</b>   The <u>nanoseconds</u> component of <b>ZEVENT_TIME</b>.
       <b>ZEVENT_TIME_STRING</b>  An almost-RFC3339-compliant string for <b>ZEVENT_TIME</b>.

       Additionally, the following ZED &amp; ZFS variables are defined:
       <b>ZED_PID</b>             The daemon's process ID.
       <b>ZED_ZEDLET_DIR</b>      The daemon's current <u>enabled-zedlets</u> directory.
       <b>ZFS_ALIAS</b>           The  alias (“<u>name</u>-<u>version</u>-<u>release</u>”) string of the ZFS distribution the daemon is part
                           of.
       <b>ZFS_VERSION</b>         The ZFS version the daemon is part of.
       <b>ZFS_RELEASE</b>         The ZFS release the daemon is part of.

       ZEDLETs may need to call other ZFS commands.  The installation paths of  the  following  executables  are
       defined  as  environment variables: <b>ZDB</b>, <b>ZED</b>, <b>ZFS</b>, <b>ZINJECT</b>, and <b>ZPOOL</b>.  These variables may be overridden
       in the rc file.

</pre><h4><b>FILES</b></h4><pre>
       <u>/etc/zfs/zed.d</u>
           The default directory for enabled ZEDLETs.

       <u>/etc/zfs/zed.d/zed.rc</u>
           The default rc file for common variables used by ZEDLETs.

       <u>/usr/lib/zfs-linux/zed.d</u>
           The default directory for installed ZEDLETs.

       <u>/run/zed.pid</u>
           The default file containing the daemon's process ID.

       <u>/run/zed.state</u>
           The default file containing the daemon's state.

</pre><h4><b>SIGNALS</b></h4><pre>
       <b>SIGHUP</b>
           Reconfigure the daemon and rescan the directory for enabled ZEDLETs.

       <b>SIGTERM</b>, <b>SIGINT</b>
           Terminate the daemon.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/zfs.8.html">zfs</a></u>(8), <u><a href="../man8/zpool.8.html">zpool</a></u>(8), <u><a href="../man8/zpool-events.8.html">zpool-events</a></u>(8)

</pre><h4><b>NOTES</b></h4><pre>
       The <b>ZED</b> requires root privileges.

       Do not taunt the <b>ZED</b>.

</pre><h4><b>BUGS</b></h4><pre>
       ZEDLETs are unable to return state/status information to the kernel.

       Internationalization support via gettext has not been added.

OpenZFS                                           May 26, 2021                                            <u><a href="../man8/ZED.8.html">ZED</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>