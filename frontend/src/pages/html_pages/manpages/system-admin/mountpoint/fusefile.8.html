<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fusefile, fusedisk - FUSE file mount for combining file fragments</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/fusefile">fusefile_2.0-1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fusefile, fusedisk - FUSE file mount for combining file fragments

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>fusefile</b> [<u>fuse-opts</u>] <b>mountpoint</b> [<u>overlay</u>] <u>filename/from-to</u> ...
       <b>fusefile</b> <b>-dump</b> [<u>fuse-opts</u>] <b>mountpoint</b> [<u>overlay</u>] <u>filename/from-to</u> ...
       <b>fusefile</b> <b>-push</b> [<u>fuse-opts</u>] <b>mountpoint</b> [<u>overlay</u>] <u>filename/from-to</u> ...
       <b>fusedisk</b> [<u>fuse-opts</u>] <b>mountpoint</b> [<u>overlay</u>] <u>filename/from-to</u> ...

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>fusefile</b>  is  a  FUSE  <u>file</u>  <u>mount</u>  that  presents  a  series of fragments of other files as a contiguous
       concatenation. Technically it bind mounts a driver on top of the filename mountpoint to provide access to
       the given file fragments as if in a single, contiguous file.

       <b>fusefile</b> accepts over-writing on the fused file (i.e. the mountpoint) which gets distributed  accordingly
       to  the  fragments. But neither the fused file nor the fragments can change size; any writing thus merely
       over-writes content without truncating fragments. All fragment files are  held  open  while  <b>fusefile</b>  is
       active.

       By  using  the  optional <b>-overlay:</b><u>filename</u> argument between the mount point and the fragments, an overlay
       file may be set up. The overlay file will then be used by <b>fusefile</b> for capturing writes to the fused file
       (i.e. the mountpoint). The overlay file will contain any new written fused file regions followed by  meta
       data to distinguish between new, written content and old content that comes from the fragments.

       By  instead  using the <b>-overlay:</b><u>list</u> argument where <u>list</u> is a colon-separated list of filenames, <b>fusefile</b>
       will use those as an ordered stack of overlays and "inject" them as fragments on top of each other.

       The option <b>-dump</b> as first argument together with a fusefile setup will print the setup to standard output
       rather than establishing a fusefile mount. This is of most use with a prior overlay setup where then  the
       printout  includes  the  portions  of updates that have been captured in the overlay. The printout is the
       series of fusefile fragment argments to give in  order  to  intersperse  the  captured  overlay  portions
       according to the overlay table.

       The  option <b>-push</b> as first argument together with a fusefile setup will push the overlay into the sources
       (except for write-protected fragments). This is only of use with a prior overlay  setup  where  then  the
       updates that have been captured in the overlay get pushed into the fragments.

       <b>fusedisk</b>  is  a  helper  script  to set up a <b>fusefile</b> as a block device (via <u>fuseblk</u>) by using the device
       mapper (<b>dmsetup</b>) to manage an empty block device mapping where content is handled at the  mountpoint  via
       <b>fusefile</b>.  (Note that the same thing may be done with the device manager directly, but then all fragments
       need to be in sectors of N*512 bytes whereas with <b>fusedisk</b>, only the fused file as a whole  is  "clipped"
       at nearest N*512 bytes below actual size)

</pre><h4><b>FRAGMENT</b> <b>ARGUMENTS</b></h4><pre>
       The  fragment  arguments  include  the  filename  of  a  source  file,  and optionally start and end byte
       positions. All in all there five variations:

       <u>filename</u> or <u>filename/</u>
              include all of the file. A pathname that includes "/" must be ended with an extra "/"  since  that
              last "/" separates the filename from the range detail.

       <u>filename/start:end</u>
              include  the range from the given start to end. Either "start" or "end" or both may be omitted, to
              mean the beginning and end of the file respectively. If "start" or "end" are less than 0  then  it
              means relative to the end of the file.

       <u>filename/start+length</u>
              include  "length"  bytes from the given start. A negative "start" means relative to the end of the
              file. If "length" is negative or omitted it means that position relative to the end.

       <u>filename/start</u> include bytes from the given start. This is the
              same as "/start+"

       Note that a negative start position is clipped to 0 and a too large end position is clipped to the end of
       the file.

       Character devices are treated as being of any given finite size, but have size 0 by default. For example,
       "/dev/zero/:100" means a fragment of 100 NUL bytes.

</pre><h4><b>OPTIONS</b></h4><pre>
       This section enumerates the most interesting options to use with <b>fuesfile</b>. See "man fuse" and "man mount"
       for more options.

       <b>-dump</b>

              The <b>-dump</b> "option" tells <b>fusefile</b> to print out the applicable fragment sequence  for  the  current
              setup,  including  the  overlay  table, if any. The printout is done instead of setting up a mount
              point.

       <b>-o</b><u>allow_other</u>

              The fuse option <u>-oallow_other</u> is needed for sharing the fused file with other users who  otherwise
              will  not  have  access  to it (including "root"). Note however that this must first be enabled in
              <u><a href="file:/etc/fuse.conf">/etc/fuse.conf</a></u>.

       <b>-o</b><u>nonempty</u>

              The fuse option <u>-ononempty</u> may need to be used when reusing an existing file as mountpoint.

       <b>-o</b><u>uid=...</u> and <b>-o</b><u>gid=...</u>,

              These mount options, where <u>...</u> is a user or group id respectively, are useful for root when  using
              <b>fusedisk</b> and thereby give user or group ownership for the mount to the nominated user or group.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This section illustrates uses of <b>fusefile</b>.

   <b>Exanple</b> <b>1.</b>
       Insert a file "y" into a file "x" at position 1200.
              <b>$</b> <b>fusefile</b> <b>-ononempty</b> <b>x</b> <b>x/:1200</b> <b>y</b> <b>x/1200:</b>
       This also shadows the original file "x" and presents the fused file instead.

   <b>Example</b> <b>2.</b>
       Make fused file y be a swap of the beginning and end of file "x", at position 2442.
              <b>$</b> <b>fusefile</b> <b>y</b> <b>x/2442:</b> <b>x/:2442</b>

   <b>Example</b> <b>3.</b>
       Replace  partition  2 of an image file, <u>A</u>, with a different file, <u>X</u>. For this example the partition table
       looks as follows.
              <b>$</b> <b>partx</b> <b>-oNR,START,SECTORS</b> <u>A</u>
                  NR   START  SECTORS
                   1    2048  2097152
                   2 2099200   409600
                   3 2508800 14268383
       As each sector is 512 bytes the clipping points around partition 2 are 1074790400 and 1284505600 and  the
       insertion size is 209715200 bytes.  The <b>fusefile</b> comman will therefore be as follows.
              <b>$</b> <b>fusefile</b> <b>-ononempty</b> <u>A</u> <u>A</u><b>/:1074790400</b> <u>X</u><b>/:209715200</b> <u>A</u><b>/1284505600</b>
       Note that the fused file shadows the original file <u>A</u>.

   <b>Example</b> <b>4.</b>
       Protect raw disk image file with an overlay:
              <b>$</b> <b>fusefile</b> <b>-ononempty</b> <b>disk.raw</b> <b>-overlay:today</b> <b>disk.raw</b>
       By that set up, the overlay file, "today", will protect the disk image file, "disk.raw" from changes, and
       also override the pathname "disk.raw" to be the fused file.

   <b>Example</b> <b>5.</b>
       A  fusefile mount with an <u>overlay</u> <u>file</u> is writable regardless of the fused fragments, but all updates are
       written to the overlay file instead of to the fragments.

              <b>$</b> <b>fusefile</b> <b>-ononempty</b> <u>A</u> <b>-overlay:</b><u>B</u> <u>A</u>

       The overlay file, <u>B</u> in the example, contains all changes to the shadowed original file,  <u>A</u>.  The  overlay
       file contains only the newly written regions and content is otherwise obtained from the original file.

       To that end, the overlay file also contains a "marker table" at the end as if appended to the fused file.
       That part of the file is outside of the fused file; and it's simply an element count followed by pairs of
       byte  addresses  that tell which regions of the fused file have been captured into the overlay file. (The
       marker table is of course maintained so that adjoining regions are collapsed)

       Thus, an overlay file may be reused to later re-establish the same fused file with overlay as previously,
       to continue capturing more changes.

   <b>Example</b> <b>6.</b>
       As final example, we set up a fused block device <u>y</u> as a swap of the beginning and end  of  file  "x",  at
       position 2442:
              <b>$</b> <b>sudo</b> <b>fusedisk</b> <b>-ouid=1000</b> <b>y</b> <b>x/2442:</b> <b>x/:2442</b>
       Note  the  use  of  <b>sudo</b>  for  becoming  <u>root</u>,  which is required for block device handling, and also the
       <b>-ouid=1000</b> option so as to make the block device <u>y</u> be owned by the user with id 1000.

</pre><h4><b>NOTES</b></h4><pre>
       <b>fusefile</b> opens the nominated source files before any bind mounting. With the fuse  option  <u>-ononempty</u>  it
       will  bind  over  an  non-empty  file,  which may be useful. The source files remain open, but the source
       fragments are not recomputed. If a source file changes the fused file will present the new content. If  a
       source is reduced in size, access will be inconsistent.

       If the mountpoint file doesn't exist, then <b>fusefile</b> creates it.

       Unmounting  is done with "<b>fusermount</b> <b>-u</b> <u>mountpoint</u>" as usual. A <b>fusedisk</b> mount is unmounted by <u>root</u> using
       <b>umount</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>fuse,</b> <b>fusermount,</b> <b>mount,</b> <b>dmsetup</b>

</pre><h4><b>AUTHOR</b></h4><pre>
       Ralph Rönnquist &lt;<a href="mailto:ralph.ronnquist@gmail.com">ralph.ronnquist@gmail.com</a>&gt;.

                                                                                                     <u><a href="../man8/fusefile.8.html">fusefile</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>