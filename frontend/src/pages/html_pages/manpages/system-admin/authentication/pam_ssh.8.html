<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_ssh — authentication and session management with SSH private keys</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-ssh">libpam-ssh_2.3+ds-8_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_ssh — authentication and session management with SSH private keys

</pre><h4><b>SYNOPSIS</b></h4><pre>
       [<u>service-name</u>] <u>module-type</u> <u>control-flag</u> <u>pam_ssh</u> [<u>options</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  SSH  authentication  service  module for PAM, <b>pam_ssh</b> provides functionality for two PAM categories:
       authentication and session management.  In terms of the <u>module-type</u> parameter, they are  the  “<b>auth</b>”  and
       “<b>session</b>” features.  It also provides null functions for the remaining categories.

   <b>SSH</b> <b>Authentication</b> <b>Module</b>
       The  SSH  authentication component verifies the identity of a user by prompting the user for a passphrase
       and verifying that it can decrypt at least one of the user's SSH login  (or  authentication)  keys  using
       that passphrase.

       The  user's  SSH  login  keys  must  be either located or symbolically linked into the per-user dedicated
       folder <u><a href="file:~/.ssh/login-keys.d/">~/.ssh/login-keys.d/</a></u> in the user's home directory.

       The following options may be passed to the authentication module:
       <b>debug</b>   <u><a href="../man3/syslog.3.html">syslog</a></u>(3) debugging information at LOG_DEBUG level.
       <b>use_first_pass</b>
               If the authentication module is not the first in the stack, and a previous  module  obtained  the
               user's password, that password is used to decrypt the user's SSH login keys.  If this fails, then
               the authentication module returns failure without prompting the user for a passphrase.
       <b>try_first_pass</b>
               Similar  to  the  <b>use_first_pass</b> option, except that if the previously obtained password fails to
               decrypt any of the SSH login keys, then the user is prompted for an SSH passphrase.
       <b>nullok</b>  Allow SSH keys with no passphrase.

       If neither <b>use_first_pass</b> nor <b>try_first_pass</b> is specified, <b>pam_ssh</b> will unconditionally ask  for  an  SSH
       passphrase.

       The now deprecated name <b>allow_blank_passphrase</b> for <b>nullok</b> is kept for compatibility reasons.

   <b>SSH</b> <b>Session</b> <b>Management</b> <b>Module</b>
       The  SSH session management component initiates sessions by launching an SSH agent, passing it any user's
       SSH login keys successfully decrypted during the authentication phase and any additional user SSH session
       keys successfully decrypted, and  sets  dedicated  environment  variables  accordingly;  the  environment
       variable  TMPDIR,  which can be set through the pam_tmpdir module for instance, is also honoured by being
       passed to the SSH agent.

       The SSH session management component terminates the session by killing the previously launched SSH  agent
       by sending it a SIGTERM.

       The  traditional  SSH  keys  <u><a href="file:~/.ssh/id_rsa">~/.ssh/id_rsa</a></u>,  <u><a href="file:~/.ssh/id_dsa">~/.ssh/id_dsa</a></u>,  <u><a href="file:~/.ssh/id_ecdsa">~/.ssh/id_ecdsa</a></u>,  and  <u><a href="file:~/.ssh/id_ed25519">~/.ssh/id_ed25519</a></u> are
       considered as the default SSH session keys.  Nonetheless, extra user  SSH  session  keys  can  be  either
       located  or  symbolically  linked into the per-user dedicated folder <u><a href="file:~/.ssh/session-keys.d/">~/.ssh/session-keys.d/</a></u> in the user's
       home directory.

       Provided that they have been successfully decrypted, the SSH session management passes  to  the  launched
       SSH  agent  first  the session SSH keys in lexical order, second the login SSH keys in lexical order, and
       finally the traditional SSH keys in the reverse order cited above.  Since the  SSH  agent  keeps  in  its
       memory  for  each  passed  key its first position (but its last comment), each SSH key rank can be easily
       overwritten with an appropriate symbolic link placed in <u><a href="file:~/.ssh/session-keys.d/">~/.ssh/session-keys.d/</a></u>  or  <u><a href="file:~/.ssh/login-keys.d/">~/.ssh/login-keys.d/</a></u>;
       this  is  especially  true for the traditional SSH keys.  The involved lexical order is performed against
       the SSH key file basenames (according to the C/POSIX locale character collation rules).  Because actually
       their basenames are passed as comments, their effective order might be easily checked with an appropriate
       SSH agent helper as <u><a href="../man3/ssh-add.3.html">ssh-add</a></u>(3).  As final remark, keep in mind that the SSH agent may  place  itself  SSH
       keys with protocol 1 before SSH keys with protocol 2.

       The following option may be passed to the session management module:
       <b>debug</b>   <u><a href="../man3/syslog.3.html">syslog</a></u>(3) debugging information at LOG_DEBUG level.

</pre><h4><b>INFORMATION</b> <b>LEAKS</b></h4><pre>
       Be  careful  with  the  using  the  <b>try_first_pass</b> option when <b>pam_ssh</b> is the first authentication module
       because it will then leak information about existing users without login keys: such  users  will  not  be
       asked  for  a specific SSH passphrase, whereas non-existing users and existing users with login keys will
       be asked for a passphrase.

</pre><h4><b>FILES</b></h4><pre>
       <u><a href="file:~/.ssh/">~/.ssh/</a></u>
               This directory is the default per-user location for all user-specific SSH configuration  and  SSH
               authentication information as expected by SSH and its friends.

       <u><a href="file:~/.ssh/id_rsa">~/.ssh/id_rsa</a></u>
       <u><a href="file:~/.ssh/id_dsa">~/.ssh/id_dsa</a></u>
       <u><a href="file:~/.ssh/id_ecdsa">~/.ssh/id_ecdsa</a></u>
       <u><a href="file:~/.ssh/id_ed25519">~/.ssh/id_ed25519</a></u>
               Contains  the traditional private key for authentication.  These files contain sensitive data and
               should be readable by the user but not accessible by others: any  traditional  private  key  file
               that  is  accessible by others is simply ignored.  While the SSH authentication component ignores
               the traditional private keys, the  SSH  session  management  component  passes  any  successfully
               decrypted traditional key to the launched SSH agent.

       <u><a href="file:~/.ssh/login-keys.d/">~/.ssh/login-keys.d/</a></u>
               This  directory  is  the  dedicated  per-user  location for files or symbolic links to files that
               contains SSH private keys considered by the SSH authentication component.   <b>pam_ssh</b>  ignores  any
               private  key  file that is accessible by others or that possesses .disabled or .frozen as suffix.
               Each login key successfully decrypted is passed by the SSH session management  component  to  the
               launched SSH agent.

       <u><a href="file:~/.ssh/session-keys.d/">~/.ssh/session-keys.d/</a></u>
               This  directory  is  the  dedicated  per-user  location for files or symbolic links to files that
               contains (extra) SSH private keys considered  only  by  the  SSH  session  management  component.
               <b>pam_ssh</b>  ignores any private key file that is accessible by others or that possesses .disabled or
               .frozen as suffix.  Each session key successfully decrypted is passed to the launched SSH agent.

       <u><a href="file:/var/log/auth.log">/var/log/auth.log</a></u>
               Usual log file for <u><a href="../man3/syslog.3.html">syslog</a></u>(3).

       <u>/usr/share/pam-configs/ssh</u>
               <b>pam_ssh</b> Debian package supplied authentication profile as managed by <u><a href="../man8/pam-auth-update.8.html">pam-auth-update</a></u>(8).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/ssh.1.html">ssh</a></u>(1),   <u><a href="../man1/ssh-agent.1.html">ssh-agent</a></u>(1),   <u><a href="../man1/ssh-add.1.html">ssh-add</a></u>(1),   <u><a href="../man1/ssh-keygen.1.html">ssh-keygen</a></u>(1),   <u><a href="../man3/syslog.3.html">syslog</a></u>(3),   <u><a href="../man5/pam.conf.5.html">pam.conf</a></u>(5),   <u><a href="../man5/pam.d.5.html">pam.d</a></u>(5),    <u><a href="../man8/pam.8.html">pam</a></u>(8),
       <u><a href="../man8/pam-auth-update.8.html">pam-auth-update</a></u>(8), <u>pam_tmp</u>

</pre><h4><b>AUTHORS</b></h4><pre>
       Andrew J. Korty &lt;<a href="mailto:ajk@iu.edu">ajk@iu.edu</a>&gt; wrote <b>pam_ssh</b>.  Dag-Erling Smorgrav wrote the original OpenPAM support code.
       Mark  R V Murray wrote the original version of this manual page.  Jens Peter Secher introduced the login-
       key concept.  Refreshed  for  Debian  by  Jerome  Benoit  &lt;<a href="mailto:calculus@rezozer.net">calculus@rezozer.net</a>&gt;.  <b>pam_ssh</b>  is  currently
       maintained by Wolfgang Rosenauer.

                                                January 14, 2019                                      <u><a href="../man8/PAM_SSH.8.html">PAM_SSH</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>