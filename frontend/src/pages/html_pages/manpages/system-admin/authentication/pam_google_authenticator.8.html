<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_google_authenticator - PAM module for Google two-factor authentication</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-google-authenticator">libpam-google-authenticator_20191231-2.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_google_authenticator - PAM module for Google two-factor authentication

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pam_google_authenticator.so</b>  [secret=<u>file</u>] [authtok_prompt=<u>prompt</u>] [user=<u>username</u>] [no_strict_owner] [al‐
       lowed_perm=<u>0nnn</u>]  [debug]  [try_first_pass|use_first_pass|forward_pass]  [noskewadj]  [no_increment_hotp]
       [nullok] [echo_verification_code]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>pam_google_authenticator</b> module is designed to protect user authentication with a second factor, ei‐
       ther time-based (TOTP) or counter-based (HOTP).  Prior logging in, the user will be asked  for  both  its
       password  and a one-time code.  Such one-time codes can be generated with the Google Authenticator appli‐
       cation, installed on the user's Android device.  To  respectively  generate  and  verify  those  one-time
       codes,  a  secret  key (randomly generated) must be shared between the device on which one-time codes are
       generated and the system on which this PAM module is enabled.

       Depending on its configuration (see <u>options</u> section), this module requires that a secret file is manually
       set up for each account on the system.  This secret file holds the secret key and  user-specific  options
       (see  <b><a href="../man1/google-authenticator.1.html">google-authenticator</a></b>(1)).   Unless the <b>nullok</b> option is used, authentication tries will be rejected
       if such secret file doesn't exist.  Alternatively, a system administrator may create those  secret  files
       on behalf of the users and then communicates to them the secret keys.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>secret=</b><u>file</u>
              Specify a non-standard file location for the secret file.

              By  default, the PAM module looks for the secret file in the .google_authenticator file within the
              home of the user logging in.  This option overrides this location.

              The provided location may include the following short-hands:

              • <b>${USER}</b> that will be interpreted as the username.

              • <b>${HOME}</b> and <b>~</b> that will be interpreted as the user's home directory.

       <b>authtok_prompt=</b><u>prompt</u>
              Override default token prompt.

              Note that if spaces are present in the provided prompt, the whole  argument  must  be  wrapped  in
              square brackets.

       <b>user=</b><u>username</u>
              Switch to a hard-coded user prior to doing any file operation.

       <b>no_strict_owner</b>
              Disable the check against the secret file's owner.

              By  default,  the  secret  file  must  be owned by the user logging in.  This option disables this
              check.

       <b>allowed_perm=</b><u>0nnn</u>
              Override checked permissions of the secret file.

              By default, the secret file must be readable only by its owner (ie.  mode <u>0600</u>).  This option  al‐
              lows a different mode to be specified for this file.

       <b>debug</b>  Enable more verbose log messages in syslog.

       <b>try_first_pass|use_first_pass|forward_pass</b>
              Stacking options for this PAM module.

              Because  some  PAM  clients  cannot prompt the user for more than just the password, the following
              stacking options may be used:

              • <b>try_first_pass</b>: before prompting the user for the one-time code, this  module  first  tries  the
                previous stacked module's password in case that satisfies this module as well.

              • <b>use_first_pass</b>: force this module to use a previous stacked modules password.  With this option,
                this  module  will never prompt the user for the one-time code.  Thus, if no valid one-time code
                is available, the user will be denied access.

              • <b>forward_pass</b>: query the user for both the system password and the verification code in a  single
                prompt.   The  system  password  is then forwarded to the next PAM module, which will have to be
                configured with either the <b>use_first_pass</b> option, or the <b>try_first_pass</b> option.

       <b>noskewadj</b>
              Don't adjust time skew automatically.

              By default, the PAM module makes an attempt to compensate for time skew between the server and the
              device on which one-time passcodes are generated.  This option disable this behavior.

              Note that this option is only relevant for time-based (TOTP) mode.

       <b>no_increment_hotp</b>
              Don't increment the counter for failed attempts.

              In some circonstance, failed passwords still get an OTP prompt.  This option disables counter  in‐
              crementation is such situations.

              Note that this option is only relevant for counter-based (HOTP) mode.

       <b>nullok</b> Allow users to log in without OTP, if they haven't set up OTP yet.

              During the initial roll-out process, all users may not have created a secret key yet.  This option
              allows them to log in, even if the secret file doesn't exist.

       <b>echo_verification_code</b>
              Echo the verification code when it is entered by the user.

</pre><h4><b>MODULE</b> <b>TYPE</b> <b>PROVIDED</b></h4><pre>
       Only the <b>auth</b> module type is provided.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>PAM_SUCCESS</b>
              Either the provided one-time code is correct or is a valid emergency code.

       <b>PAM_IGNORE</b>
              This module is ignored.

       <b>PAM_AUTH_ERR</b>
              The provided one-time code isn't correct and isn't a valid emergency code, or an error was encoun‐
              tered.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following lines may be used to enable this PAM module:

       • auth required pam_google_authenticator.so no_increment_hotp  #  Make  sure  the counter (for HOTP mode)
         isn't incremented for failed attempts.

       • auth required pam_google_authenticator.so nullok # Allow users to log in if their  secret  files  don't
         exist

       • auth required pam_google_authenticator.so secret=/var/unencrypted-home/${USER}/.google_authenticator  #
         Store secret files in a specific location

       • auth required pam_google_authenticator.so [authtok_prompt=Your secret token: ] # Use a specific prompt

       • auth required pam_google_authenticator.so noskewadj # Don't compensate time skew automatically

</pre><h4><b>SECURITY</b> <b>NOTES</b></h4><pre>
       For highest security, make sure that both password and one-time code are being requested even if password
       and/or one-time code are incorrect.  This means that <u>at</u> <u>least</u> the first of pam_unix.so (or whatever other
       module is used to verify passwords) and pam_google_authenticator.so should be set as <b>required</b>, not <b>requi‐</b>
       <b>site</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/google-authenticator.1.html">google-authenticator</a></b>(1).

       The   Google   Authenticator   source   code   and   all   documentation   may   be    downloaded    from
       &lt;https://github.com/google/google-authenticator-libpam&gt;.

Google Authenticator PAM module manual                                               <u><a href="../man8/PAM_GOOGLE_AUTHENTICATOR.8.html">PAM_GOOGLE_AUTHENTICATOR</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>