<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>apt-secure - Archive authentication support for APT</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/apt">apt_3.1.3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       apt-secure - Archive authentication support for APT

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Starting with version 0.6, <b>APT</b> contains code that does signature checking of the Release file for all
       repositories. This ensures that data like packages in the archive can't be modified by people who have no
       access to the Release file signing key. Starting with version 1.1 <b>APT</b> requires repositories to provide
       recent authentication information for unimpeded usage of the repository. Since version 1.5 changes in the
       information contained in the Release file about the repository need to be confirmed before APT continues
       to apply updates from this repository.

       Note: All APT-based package management front-ends like <b><a href="../man8/apt-get.8.html">apt-get</a></b>(8), <b><a href="../man8/aptitude.8.html">aptitude</a></b>(8) and <b><a href="../man8/synaptic.8.html">synaptic</a></b>(8) support
       this authentication feature, so this manpage uses APT to refer to them all for simplicity only.

</pre><h4><b>USER</b> <b>CONFIGURATION</b></h4><pre>
       Keys should usually be included inside their corresponding .sources by embedding the ASCII-armored key in
       the Signed-By option. To do so, replace the empty line with a dot, and then indent all lines by two
       spaces. See <b><a href="../man5/sources.list.5.html">sources.list</a></b>(5) for more information.

       Alternatively, keys may be placed in <a href="file:/etc/apt/keyrings">/etc/apt/keyrings</a> for local keys, or <a href="file:/usr/share/keyrings">/usr/share/keyrings</a> for keys
       managed by packages, and then referenced by Signed-By: /etc/apt/keyrings/example-archive-keyring.asc
       option in a .sources file or using deb [signed-by=/etc/apt/keyrings/example-archive-keyring.asc] ...  in
       the legacy .list format. This may be useful for APT versions prior to 2.4, which do not support embedded
       keys. ASCII-armored keys must use an extension of .asc, and unarmored keys an extension of .gpg.

       To generate keys suitable for use in APT using GnuPG, you will need to use the <b>gpg</b> <b>--export-options</b>
       <b>export-minimal</b> <b>[--armor]</b> <b>--export</b> command. Earlier solutions involving <b>--keyring</b> <b>file</b> <b>--import</b> no longer
       work with recent GnuPG versions as they use a new internal format ("GPG keybox database").

       Note that a default installation already contains all keys to securely acquire packages from the default
       repositories, so managing keys is only needed if third-party repositories are added. The <b>extrepo</b> package
       can be used to manage several external repositories with ease.

</pre><h4><b>UNSIGNED</b> <b>REPOSITORIES</b></h4><pre>
       If an archive has an unsigned Release file or no Release file at all current APT versions will refuse to
       download data from them by default in <b>update</b> operations and even if forced to download front-ends like
       <b><a href="../man8/apt-get.8.html">apt-get</a></b>(8) will require explicit confirmation if an installation request includes a package from such an
       unauthenticated archive.

       You can force all APT clients to raise only warnings by setting the configuration option
       <b>Acquire::AllowInsecureRepositories</b> to true. Individual repositories can also be allowed to be insecure
       via the <b><a href="../man5/sources.list.5.html">sources.list</a></b>(5) option allow-insecure=yes. Note that insecure repositories are strongly
       discouraged and all options to force apt to continue supporting them will eventually be removed. Users
       also have the <b>Trusted</b> option available to disable even the warnings, but be sure to understand the
       implications as detailed in <b><a href="../man5/sources.list.5.html">sources.list</a></b>(5).

       A repository which previously was authenticated but would loose this state in an <b>update</b> operation raises
       an error in all APT clients irrespective of the option to allow or forbid usage of insecure repositories.
       The error can be overcome by additionally setting <b>Acquire::AllowDowngradeToInsecureRepositories</b> to true
       or for Individual repositories with the <b><a href="../man5/sources.list.5.html">sources.list</a></b>(5) option allow-downgrade-to-insecure=yes.

</pre><h4><b>SIGNED</b> <b>REPOSITORIES</b></h4><pre>
       The chain of trust from an APT archive to the end user is made up of several steps.  <b>apt-secure</b> is the
       last step in this chain; trusting an archive does not mean that you trust its packages not to contain
       malicious code, but means that you trust the archive maintainer. It's the archive maintainer's
       responsibility to ensure that the archive's integrity is preserved.

       apt-secure does not review signatures at a package level. If you require tools to do this you should look
       at <b>debsig-verify</b> and <b>debsign</b> (provided in the debsig-verify and devscripts packages respectively).

       The chain of trust in Debian starts (e.g.) when a maintainer uploads a new package or a new version of a
       package to the Debian archive. In order to become effective, this upload needs to be signed by a key
       contained in one of the Debian package maintainer keyrings (available in the debian-keyring package).
       Maintainers' keys are signed by other maintainers following pre-established procedures to ensure the
       identity of the key holder. Similar procedures exist in all Debian-based distributions.

       Once the uploaded package is verified and included in the archive, the maintainer signature is stripped
       off, and checksums of the package are computed and put in the Packages file. The checksums of all of the
       Packages files are then computed and put into the Release file. The Release file is then signed by the
       archive key for this Ubuntu release, and distributed alongside the packages and the Packages files on
       Ubuntu mirrors. The keys are in the Ubuntu archive keyring available in the ubuntu-keyring package.

       End users can check the signature of the Release file, extract a checksum of a package from it and
       compare it with the checksum of the package they downloaded by hand - or rely on APT doing this
       automatically.

       Notice that this is distinct from checking signatures on a per package basis. It is designed to prevent
       two possible attacks:

       •   Network "man in the middle" attacks. Without signature checking, malicious agents can introduce
           themselves into the package download process and provide malicious software either by controlling a
           network element (router, switch, etc.) or by redirecting traffic to a rogue server (through ARP or
           DNS spoofing attacks).

       •   Mirror network compromise. Without signature checking, a malicious agent can compromise a mirror host
           and modify the files in it to propagate malicious software to all users downloading packages from
           that host.

       However, it does not defend against a compromise of the master server itself (which signs the packages)
       or against a compromise of the key used to sign the Release files. In any case, this mechanism can
       complement a per-package signature.

</pre><h4><b>INFORMATION</b> <b>CHANGES</b></h4><pre>
       A Release file contains beside the checksums for the files in the repository also general information
       about the repository like the origin, codename or version number of the release.

       This information is shown in various places so a repository owner should always ensure correctness.
       Further more user configuration like <b><a href="../man5/apt_preferences.5.html">apt_preferences</a></b>(5) can depend and make use of this information.
       Since version 1.5 the user must therefore explicitly confirm changes to signal that the user is
       sufficiently prepared e.g. for the new major release of the distribution shipped in the repository (as
       e.g. indicated by the codename).

</pre><h4><b>REPOSITORY</b> <b>CONFIGURATION</b></h4><pre>
       If you want to provide archive signatures in an archive under your maintenance you have to:

       •   <u>Create</u> <u>a</u> <u>toplevel</u> <u>Release</u> <u>file</u>, if it does not exist already. You can do this by running
           <b>apt-ftparchive</b> <b>release</b> (provided in apt-utils).

       •   <u>Sign</u> <u>it</u>. You can do this by running <b>gpg</b> <b>--clearsign</b> <b>-o</b> <b>InRelease</b> <b>Release</b> and <b>gpg</b> <b>-abs</b> <b>-o</b> <b>Release.gpg</b>
           <b>Release</b>.

       •   <u>Publish</u> <u>the</u> <u>key</u> <u>fingerprint</u>, so that your users will know what key they need to import in order to
           authenticate the files in the archive. It is best to ship your key in its own keyring package like
           Ubuntu does with ubuntu-keyring to be able to distribute updates and key transitions automatically
           later.

       •   <u>Provide</u> <u>instructions</u> <u>on</u> <u>how</u> <u>to</u> <u>add</u> <u>your</u> <u>archive</u> <u>and</u> <u>key</u>. If your users can't acquire your key
           securely the chain of trust described above is broken. How you can help users add your key depends on
           your archive and target audience ranging from having your keyring package included in another archive
           users already have configured (like the default repositories of their distribution) to leveraging the
           web of trust.

       Whenever the contents of the archive change (new packages are added or removed) the archive maintainer
       has to follow the first two steps outlined above.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/apt.conf.5.html">apt.conf</a></b>(5), <b><a href="../man8/apt-get.8.html">apt-get</a></b>(8), <b><a href="../man5/sources.list.5.html">sources.list</a></b>(5), <b><a href="../man1/apt-ftparchive.1.html">apt-ftparchive</a></b>(1), <b><a href="../man1/debsign.1.html">debsign</a></b>(1), <b><a href="../man1/debsig-verify.1.html">debsig-verify</a></b>(1), <b><a href="../man1/gpg.1.html">gpg</a></b>(1)

       For more background information you might want to review the <b>Debian</b> <b>Security</b> <b>Infrastructure</b>[1] chapter of
       the Securing Debian Manual (also available in the harden-doc package) and the <b>Strong</b> <b>Distribution</b>
       <b>HOWTO</b>[2] by V. Alex Brennen.

</pre><h4><b>BUGS</b></h4><pre>
       <b>APT</b> <b>bug</b> <b>page</b>[3]. If you wish to report a bug in APT, please see /usr/share/doc/debian/bug-reporting.txt
       or the <b><a href="../man1/reportbug.1.html">reportbug</a></b>(1) command.

</pre><h4><b>AUTHOR</b></h4><pre>
       APT was written by the APT team &lt;<a href="mailto:apt@packages.debian.org">apt@packages.debian.org</a>&gt;.

</pre><h4><b>MANPAGE</b> <b>AUTHORS</b></h4><pre>
       This man-page is based on the work of Javier Fernández-Sanguino Peña, Isaac Jones, Colin Walters, Florian
       Weimer and Michael Vogt.

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>Jason</b> <b>Gunthorpe</b>

       <b>APT</b> <b>team</b>

</pre><h4><b>NOTES</b></h4><pre>
        1. Debian Security Infrastructure
           https://www.debian.org/doc/manuals/securing-debian-manual/ch07

        2. Strong Distribution HOWTO
           <a href="http://www.cryptnet.net/fdp/crypto/strong_distro.html">http://www.cryptnet.net/fdp/crypto/strong_distro.html</a>

        3. APT bug page
           https://bugs.debian.org/src:apt

APT 3.1.3                                       23 November 2024                                   <u><a href="../man8/APT-SECURE.8.html">APT-SECURE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>