<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dnf4-pre-transaction-actions - DNF pre transaction actions Plugin</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/dnf-plugins-core">dnf-plugins-core_4.10.1-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dnf4-pre-transaction-actions - DNF pre transaction actions Plugin

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  plugin  allows  to  define  actions to be executed upon starting an RPM transaction. Each action may
       define a (glob-like) filtering rule on the package NEVRA or package files, as well as whether the package
       was installed or removed. Actions are defined in action files.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       The plugin configuration is in <b>/etc/dnf/plugins/pre-transaction-actions.conf</b>. All  configuration  options
       are in the <b>[main]</b> section.

       <b>enabled</b>
              Whether the plugin is enabled. Default value is <b>True</b>.

       <b>actiondir</b>
              Path  to the directory with action files. Action files must have the “.action” extension.  Default
              value is “/etc/dnf/plugins/pre-transaction-actions.d/”.

</pre><h4><b>ACTION</b> <b>FILE</b> <b>FORMAT</b></h4><pre>
       Empty lines and lines that start with a ‘#’ character are ignored.   Each  non-comment  line  defines  an
       action and consists of three items separated by colons: <b>package_filter:transaction_state:command</b>.

       <b>package_filter</b>
              A (glob-like) filtering rule applied on the package NEVRA (also in the shortened forms) or package
              files.

       <b>transaction_state</b>
              Filters packages according to their state in the transaction.

              • <b>in</b>  -  packages  that  will  appeared  on  the  system (downgrade, install, obsolete, reinstall,
                upgrade)

              • <b>out</b> - packages that will disappeared from the system (downgraded, obsoleted, remove, upgraded)

              • <b>any</b> - all packages

       <b>command</b>
              Any shell command.  The following variables in the command will be substituted:

                 • <b>${name}</b>, <b>$name</b> - package name

                 • <b>${arch}</b>, <b>$arch</b> - package arch

                 • <b>${ver}</b>, <b>$ver</b> - package version

                 • <b>${rel}</b>, <b>$rel</b> - package release

                 • <b>${epoch}</b>, <b>$epoch</b> - package epoch

                 • <b>${repoid}</b>, <b>$repoid</b> - package repository id

                 •

                   <b>${state},</b> <b>$state</b> <b>-</b> <b>the</b> <b>change</b> <b>of</b> <b>package</b> <b>state</b> <b>in</b> <b>the</b> <b>transaction:</b>
                          “downgrade”,   “downgraded”,   “install”,   “obsolete”,   “obsoleted”,    “reinstall”,
                          “reinstalled”, “remove”, “upgrade”, “upgraded”

              The  shell  command  will  be  evaluated  for each package that matched the <b>package_filter</b> and the
              <b>transaction_state</b>. However, after variable substitution, any duplicate commands  will  be  removed
              and  each  command  will  only  be  executed  once  per transaction. The order of execution of the
              commands follows the order in the action files, but may differ from the order of packages  in  the
              transaction.   In  other  words,  when you define several action lines for the same <b>package_filter</b>
              these lines will be executed in  the  order  they  were  defined  in  the  action  file  when  the
              <b>package_filter</b>  matches a package during the <b>trasaction_state</b> state.  However, the order of when a
              particular <b>package_filter</b> is invoked depends on the position of the corresponding package  in  the
              transaction.

   <b>An</b> <b>example</b> <b>action</b> <b>file:</b>
          # log all packages (state, nevra, repo) in transaction into a file.
          *:any:echo '${state} ${name}-${epoch}:${ver}-${rel}.${arch} repo ${repoid}' &gt;&gt;/tmp/pre-trans-actions-trans.log

          # The same shell command (after variables substitution) is executed only once per transaction.
          *:any:echo '${repoid}' &gt;&gt;/tmp/pre-trans-actions-repos
          # will write each repo only once to /tmp/pre-trans-actions-repos, even if multiple packages from
          # the same repo were matched

</pre><h4><b>AUTHOR</b></h4><pre>
       See AUTHORS in your Core DNF Plugins distribution

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2014, Red Hat, Licensed under GPLv2+

4.10.1                                            Jun 20, 2025                   <u><a href="../man8/DNF4-PRE-TRANSACTION-ACTIONS.8.html">DNF4-PRE-TRANSACTION-ACTIONS</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>