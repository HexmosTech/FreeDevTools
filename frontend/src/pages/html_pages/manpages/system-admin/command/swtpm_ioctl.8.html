<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>swtpm_ioctl - Utility for sending control commands to swtpm</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/swtpm-tools">swtpm-tools_0.7.3-0ubuntu8_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       swtpm_ioctl - Utility for sending control commands to swtpm

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>swtpm_ioctl</b> <b>[COMMAND]</b> <b>[&lt;device&gt;</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>swtpm_ioctl</b> implements a client tool for controlling the <u>swtpm_cuse</u> and <u>swtpm</u> TPM software emulators,
       such as for example their initialization and shutdown. Once it has been initialized, TPM commands can be
       sent to it.

       Note: The environment variable SWTPM_IOCTL_BUFFERSIZE can be set to the size for the buffer for state
       blob transfer to use. If it is not set, the <b>ioctl()</b> interface is used for transferring the state. This
       environment variable is primarily used for testing purposes.

       The following commands are supported:

       <b>--tpm-device</b> <b>&lt;device&gt;</b>
           Use  the  given  device.  The full path to the character device must be provided, such as for example
           /dev/vtpm-200.

           This option can be used instead of providing the device as the last parameter.

       <b>--tcp</b> <b>&lt;server&gt;:&lt;port&gt;</b>
           Connect to the given server and port; if no server is given, 127.0.0.1 is used; if port is not given,
           the default port 6545 is used.

       <b>--unix</b> <b>&lt;path&gt;</b>
           Connect to the given UnixIO path.

       <b>-c</b>  Get the capability flags indicating which commands are supported.

       <b>-i</b>  Send a hardware initialization signal to the swtpm_cuse/swtpm. Volatile state previously  written  by
           the TPM will be read and the file automatically delete.

       <b>-s</b>  Initiate a graceful shut down.

       <b>--stop</b>
           Stop  the swtpm_cuse/swtpm. This does not shut it down. The <u>-i</u> command can again be sent to it. After
           a stop it is also possible to load TPM stateblobs into the TPM using the <u>--load</u> command.

       <b>-e</b>  Get the tpmEstablished bit.

       <b>-r</b> <b>locality</b>
           Reset the tpmEstablished bit using the given locality. Only localities 3 and 4 work.  This  operation
           will not permanently change the localty that was previously set using the <u>-l</u> option.

       <b>-l</b> <b>locality</b>
           Set the locality for the subsequent TPM commands.

       <b>-v</b>  Have  the TPM write the volatile state to a file. Upon a TPM_Init (-i) the TPM state will be read and
           the TPM can then resume operation without further intialization.

       <b>-C</b>  Cancel an ongoing TPM command.

       <b>-h</b> <b>data</b>
           Reset and extend PCR 17 with the hash of the given data. If data is the single  character  '-',  then
           all data are read from stdin.

       <b>--save</b> <b>&lt;TPM</b> <b>state</b> <b>blob</b> <b>name&gt;</b> <b>&lt;filename&gt;</b>
           Save  the TPM state blob into the given file. Valid TPM state blob names are 'permanent', 'volatile',
           and 'savestate'.

           Note that this command can be executed at any time. However, to retrieve the latest  volatile  state,
           the  <u>-v</u> command should have been run immediately before running this command. The savestate blob will
           only be returned if a TPM_SaveState command was executed in the TPM (TPM 1.2).

       <b>--load</b> <b>&lt;TPM</b> <b>state</b> <b>blob</b> <b>name&gt;</b> <b>&lt;filename&gt;</b>
           Load the given TPM state blob from the given file.  Valid  TPM  state  blob  names  are  'permanent',
           'volatile', and 'savestate'.

           Note  that  this command can only be executed on a TPM that is shut down.  To then start the TPM with
           the uploaded state, the <u>-i</u> command must be issued.

       <b>-g</b>  Get configuration flags that for example indicate which keys (file encryption or migration  key)  are
           in use by the TPM.

       <b>--info</b> <b>&lt;flag&gt;</b>
           Get  information  about the TPM implementation in JSON format. The flag <u>TPMLIB_INFO_TPMSPECIFICATION</u>,
           which has the value 1, returns information about the specification the TPM  implementation  followed.
           The   flag   <u>TPMLIB_INFO_TPMATTRIBUTES</u>,  which  has  the  value  2,  returns  information  about  the
           manufacturer, model, and version of the TPM.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Start swtpm on port 10000 for the control port and emulate a TPM 1.2:

          #&gt; swtpm socket --tpmstate dir=/tmp/myvtpm1 --log level=4 --ctrl type=tcp,port=10000 --server type=tcp,port=10001 --flags not-need-init

       Get information about the TPM implementation in JSON:

          #&gt; swtpm_ioctl --tcp :10000 --info 1
          {"TPMSpecification":{"family":"1.2","level":2,"revision":116}}
          #&gt; swtpm_ioctl --tcp :10000 --info 2
          {"TPMAttributes":{"manufacturer":"id:00001014","version":"id:00740001","model":"swtpm"}}

       Shut down the swtpm

          #&gt; swtpm_ioctl --tcp :10000 -s

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>swtpm_cuse</b>

swtpm                                              2024-11-08                                     <u><a href="../man8/swtpm_ioctl.8.html">swtpm_ioctl</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>