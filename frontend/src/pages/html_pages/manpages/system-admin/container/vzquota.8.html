<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vzquota - manipulate containers disk quotas</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/vzquota">vzquota_3.1-4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       vzquota - manipulate containers disk quotas

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>vzquota</b> [<u>quota_options</u>] <u>command</u> <u>quota_id</u> [<u>command_options</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>vzquota</b>  controls  disk  quotas  for Virtuozzo/OpenVZ container.  These are per-container disk quotas set
       from Virtuozzo/OpenVZ host system.

       The <u>command</u> can be one of the following: <b>init</b>, <b>drop</b>, <b>on</b>, <b>off</b>, <b>setlimit</b>, <b>setlimit2</b>, <b>reload2</b>, <b>stat</b>, <b>show</b>.

       The <u>quota_id</u> must be numeric-only identifier. Note, that quota ID is not the same as container ID (CTID).
       One container can mount several filesystems and each of them can have its own quotas.

</pre><h4><b>OPTIONS</b></h4><pre>
   <b>General</b>
       <b>-h</b>     Print usage information.

       <b>-V</b>     Print utility version.

       <b>-q</b>     Quiet mode. Causes all warning and diagnostic messages to be suppressed.  Only  fatal  errors  are
              displayed.

       <b>-v</b>     Verbose  mode.  Causes <b>vzquota</b> to print debugging messages about its progress. Multiple <b>-v</b> options
              increase verbosity. Maximum is 2.

       <b>-b</b>     Batch mode. in this mode outputs (usually on <b>stat</b> and <b>show</b> commands)  will  be  in  format  better
              suitable for parsing by a script.

   <b>Quota</b> <b>Commands</b>
       The following commands are available:

       <b>init</b>   A  necessary  preliminary  for  any other quota command work: create a new quota file, calculating
              current disk usage from given path.  This command requires full set of quota soft- and  hardlimits
              given  as  command-line  options.  Limits  are also stored in quota file, so subsequent <b>vzquota</b> <b>on</b>
              doesn't requires any quota limit as command-line parameter, although accepts  them  as  well.  New
              specified limits and flags will also be stored in the quota file.

              You  can  also  create  your  own  quota  files for arbitrary quota accounting points.  Quota file
              location and path to quota accounting point can be specified via <b>-c</b> and <b>-p</b>  options  (see  below).
              You can use also <b>-R</b> option instead of <b>-c</b> option, to set relative quota file location. In this case
              quota  file  resides  one  dirrectory  upper than quota accounting point and has special name (see
              below).

       <b>drop</b>   Remove quota file. Command checks if quota is running and refuses to remove  file  in  this  case,
              option <b>-f</b> allows to override that rule.

       <b>on</b>     Turn  quota  on. If previous quota session wasn't switched off properly (quota is not running, but
              quota file indicates it is), initialization procedure will be performed. <b>-f</b> option allow to  force
              initialization  procedure  regardless  of  the  shutdown  status.  Command <b>on</b> doesn't work in case
              specified quota id is running.

       <b>off</b>    Turn quota off, write usage statistic back to the quota file. Doesn't work if quota file cannot be
              accessed, also accepts <b>-f</b> option (force switching off, even if usage statistic will be lost). This
              is possible that quota will still be in a stopped state, even if <b>-f</b> flag is used.

       <b>setlimit</b>
              Set new quota parameters. Requires at least one quota parameter or  flag  specified.  Applies  new
              parameters immediately if quota with given quota_id is running. Stores new limits and flags in the
              quota  file.  Option <b>-f</b> specifies to mark quota as dirty, so at the next quota start, disk will be
              rescanned and usage updated.

       <b>setlimit2</b>
              Set second-level quota parameters. Applies new parameters immediately if quota with given quota_id
              is running and second-level quota is on. Stores new limits in the quota file.

       <b>reload2</b>
              Reload second-level quota limits from quota file for given quota_id.

       <b>stat</b>   Show usage statistics and update it in quota file. Option <b>-f</b> causes to  do  not  read  and  update
              quota  file, just print statistics from kernel.  Option <b>-t</b> specifies to show and update user/group
              based quota statistics for a container. Works on running containers  only.  The  command  with  <b>-t</b>
              option flushes all quota statistics from kernel to file and thus may be used for backup purposes.

       <b>show</b>   Show  usage  and  limits  info  from  quota  file.  Option  <b>-t</b>  specifies to show user/group quota
              information as well.

   <b>Setting</b> <b>quota</b> <b>limits</b>
       All these options are required in <b>init</b> command, and optionally accepted in <b>on</b> and <b>setlimit</b> commands.

       <b>-s</b>, <b>--sub-quotas</b> <b>1</b>|<b>0</b>
              Enables or disables user/group based quota inside the container. Here <b>1</b> means to enable, and  <b>0</b>  -
              to  disable.   By  default  user/group  quota is disabled. This option is accepted by <b>init</b>, <b>on</b> and
              <b>setlimit</b> commands.

       <b>-u</b> <u>user_id</u>
              For <b>setlimit2</b> command only. Limits will be applied to the specified <u>user_id</u>.

       <b>-g</b> <u>group_id</u>
              For <b>setlimit2</b> command only. Limits will be applied to the specified <u>group_id</u>.

       <b>-u</b>, <b>--ugid-limit</b> <u>limit</u>
              For <b>on</b> and <b>setlimit</b> commands only.  Specifies maximum number of user and group IDs allowed in  the
              container.   If the value is <b>0</b>, user/group quota will not be accounted.  Default value is <u>0</u>. There
              is one note concerning <b>setlimit</b> command.  If first-level quota is running, second-level  quota  is
              active  and  not  all  ugid  objects  were  loaded  into  kernel by <b>on</b> command due to insufficient
              <u>ugid_limit</u> value (this can be checked by issuing <b>stat</b> <b>-t</b> command and observing whether ugid  limit
              was  exceeded),  then  <b>setlimit</b> with new <u>limit</u> value updates it in kernel and file but this change
              does not take immediate effect. Modification will be applied after quota restart.

       <b>-b</b>, <b>--block-softlimit</b> <u>bsl</u>
              Disk quota block soft limit.  Soft limit is amount of blocks which excess is allowed in time equal
              <u>exptime</u>.  On the expiration of this time soft limit becomes hard limit.  Block limits are  set  in
              1k sized blocks.

       <b>-B</b>, <b>--block-hardlimit</b> <u>bhl</u>
              Disk quota block hard limit. Hard limit is amount of blocks which excess is not allowed.

       <b>-e</b>, <b>--block-exptime</b> <u>bet</u>
              Disk  quota  expiration time for excess of a block soft limit.  Time can be given in two different
              formats:
              1. <u>dd:hh:mm:ss</u>
              For instance: <u>30</u> - 30 seconds; <u>12:00</u> - 12 minutes; <u>20:15:11:00</u> - 20 days, 15 hours, 11 minutes
              2. <u>xxA</u>, where <u>A</u> - h/H(hour); d/D(day); w/W(week); m/<a href="../manmonth/M.month.html">M</a>(month); y/Y(year).
              For instance: <u>7D</u> - 7 days; <u>01w</u> - 1 week; <u>3m</u> - 3 months

       <b>-i</b>, <b>--inode-softlimit</b> <u>isl</u>
              Disk quota inode soft limit. Similarly to block soft limit.

       <b>-I</b>, <b>--inode-hardlimit</b> <u>ihl</u>
              Disk quota inode hard limit.

       <b>-n</b>, <b>--inode-exptime</b> <u>iet</u>
              Disk quota expiration time for excess of a inode soft limit.

   <b>Other</b> <b>options</b>
       <b>-p</b> <u>path</u>
              Point of quota accounting for given <u>quota_id</u>. This option required for <b>init</b>  command  and  can  be
              used  also  with  any  another command to override quota path obtained from quota file. For <b>on</b> and
              <b>setlimit</b> commands, this option can be used to set and save new quota  accounting  path  for  given
              <u>quota_id</u>

       <b>-R</b>     Set  special  relative  path  to <u>quota_file</u>. If this option is specified, quota file location will
              depends on path to quota accounting dir: if your quota accounting path is /path/to/<u>somewhere</u>/ than
              quota file will be /path/to/quota.<u>somewhere</u>. If this option is not specified, quota file  location
              is /var/lib/vzquota/quota.<u>quota_id</u>. All commands accept this option.

       <b>-c</b> <u>quota_file</u>
              This option allows to specify a <u>quota_file</u> to work with.  All commands accept this option. If this
              option  is  not  specified, default file location depends on whether <b>-R</b> option is specified or not
              (see above).

       <b>-f</b>     Force option. Accepted by <b>drop</b>, <b>on</b>, <b>off</b>, <b>stat</b>, <b>setlimit</b> and <b>setlimit2</b>  commands.  Action  of  this
              option differs for different commands and is described above for each command separately.

       <b>-t</b>     For  <b>stat</b> and <b>show</b> commands only. Processes user/group quota statistics. Specifies whether to show
              (update in file) user/group quota information.

       <b>-t</b>     For <b>setlimit2</b> command. Set second-level quota time grace parameters.

</pre><h4><b>LIMITATIONS</b></h4><pre>
       It is impossible to start or stop quota accounting if the directory given by <b>-p</b> option is busy.  This  is
       rather limitation of kernel part of disk quota implementation.

</pre><h4><b>DISPLAY</b></h4><pre>
       <b>vzquota</b> <b>stat</b> and <b>vzquota</b> <b>show</b> display the following information:

       <b>resource</b>
              Either 1k-blocks or inodes.

       <b>usage</b>  Current usage of resource.

       <b>softlimit</b>
              Resource limit. Current usage can exceed this limit up to hard limit during grace time.

       <b>hardlimit</b>
              Resource limit. Current usage can't exceed this limit.

       <b>grace</b>  During  this  amount of time usage can exceed softlimit. If a soft limit has not been exceeded the
              grace column is blank. If the grace period has expired, the  grace  column  contain  special  <b>none</b>
              value.

       In case option <b>-t</b> is specified, the following information is also displayed:

       <b>User/group</b> <b>quota:</b>
              Status of the 2nd level quota. This can be <b>on</b> or <b>off</b>, <b>active</b> or <b>inactive</b>. Values <b>on</b>/<b>off</b> define the
              state  of  the  2nd  level  quota  at  the  next start of container quota.  Values <b>active</b>/<b>inactive</b>
              indicate the current state of the 2nd level quota in the kernel.

       <b>Ugids:</b> Three values are shown: <u>loaded</u>, <u>total</u> and <u>limit</u>.  <u>loaded</u> is the number of records (uids  or  gids)
              in the kernel.  <u>total</u> is the number of unique records located in the kernel and quota file.  <u>limit</u>
              is  the  current  kernel  limit of records amount.  Note that <u>loaded</u> and <u>total</u> may be greater then
              <u>limit</u>.

       <b>Ugid</b> <b>limit</b> <b>was</b> <b>exceeded:</b>
              Can be <b>yes</b> or <b>no</b>. <b>yes</b> indicates that vzquota did not loaded all records into the kernel.  In  this
              case  you  should  reduce  the  number of unique records (remove files which belong to unnecessary
              users) or increase the ugid limit. After that you should restart quota.

       <b>User/group</b> <b>grace</b> <b>times</b> <b>and</b> <b>quotafile</b> <b>flags:</b>
              Grace times and quota file flags (internal parameters of standard linux kernel quota v.3).

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <b>0</b>      Command executed successfully

       <b>1</b>      System error

       <b>2</b>      Usage error

       <b>3</b>      Virtuozzo syscall error

       <b>4</b>      Quota file error

       <b>5</b>      Quota is already running

       <b>6</b>      Quota is not running

       <b>7</b>      Can not get lock on this quota id

       <b>8</b>      Directory tree crosses mount points

       <b>9</b>      Quota is running but user/group quota is inactive; this status is returned by <b>stat</b> <b>-t</b> command  for
              information purposes and does not indicate a error

       <b>10</b>     Quota is marked as dirty in file; this status is returned by <b>show</b> command for information purposes
              and does not indicate a error

       <b>11</b>     Quota file does not exist

       <b>12</b>     Internal error

       <b>13</b>     Can't obtain mount point

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2000-2011, Parallels, Inc. Licensed under GNU GPL.

Virtuozzo/OpenVZ                                   27 Jun 2011                                        <u><a href="../man8/vzquota.8.html">vzquota</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>