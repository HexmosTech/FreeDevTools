<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vzmigrate - migrate a container between two OpenVZ servers</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/vzctl">vzctl_4.9.4-6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       vzmigrate - migrate a container between two OpenVZ servers

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>vzmigrate</b> [<b>-r</b>|<b>--remove-area</b> <b>yes</b>|<b>no</b>] [<b>--ssh=</b><u>ssh_options</u>] [<b>--ssh-mux</b>] [<b>--rsync=</b><u>rsync_options</u>] [<b>--keep-dst</b>]
                 [<b>--live</b>] [<b>-c</b>|<b>--compact</b>] [<b>-s</b>|<b>--snapshot</b>] [<b>--check-only</b>|<b>--dry-run</b>]
                 [<b>-f</b>|<b>--nodeps</b>[<b>=</b><u>check</u>[<b>,</b><u>check</u> ...]]]  [<b>-t</b>|<b>--times</b>] [<b>-v</b>] <u>destination_address</u> <u>CTID</u>
       <b>vzmigrate</b> <b>-h</b>|<b>--help</b>|<b>--usage</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This utility is used to migrate a container from one (source) Hardware Node (HN) to another (destination)
       HN.  The  utility  can  migrate  either  stopped or running container. For a stopped container, simple CT
       private area transfer is performed (<b><a href="../man1/rsync.1.html">rsync</a></b>(1) is used for file transfer). For running  containers,  either
       traditional (with CT stop and start) or live migration is possible.

       This  program  uses <b>ssh</b> as a transport layer. You will need to put ssh public key to destination node and
       be able to connect to node without entering password.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-r</b>, <b>--remove-area</b> <b>yes</b> | <b>no</b>
              Whether to remove a container area on source HN for the successfully migrated  container.  Default
              is <b>yes</b>.

       <b>--ssh=</b><u>options</u>
              Additional <u>options</u> that will be passed to ssh while establishing connection to destination HN.

       <b>--ssh-mux</b>
              Enable  ssh  channel  multiplexing,  establishing  and  reusing  a single ssh connection to remote
              server. This speeds up live migration.

       <b>--rsync=</b><u>options</u>
              Additional <u>options</u> that will be passed to <b><a href="../man8/rsync.8.html">rsync</a></b>(8).  You may add options like <b>-z</b>  to  enable  data
              compression if you are migrating over a slow link.

       <b>--keep-dst</b>
              Do  not  clean  synced destination container private area in case of some error. It makes sense to
              use this option on big container migration to avoid syncing container private area again  in  case
              some error (on container stop for example) occurs during first migration attempt.

       <b>--live</b> Perform  live  migration:  instead  of restarting a container, checkpoint and restore are used, so
              there is no container downtime or service interruption. Additional steps are performed to minimize
              the time when a container is in suspended state.  Option <b>--online</b>  can  be  used  as  a  backward-
              compatible alias.

       <b>-c</b>, <b>--compact</b>
              Compact a container image (i.e. run <b>vzctl</b> <b>compact</b>) before migration. Works for ploop only, ignored
              otherwise.

       <b>-s</b>, <b>--snapshot</b>
              Create  a  container  snapshot  (i.e.  run <b>vzctl</b> <b>snapshot</b>) before migration. Works for ploop only,
              ignored otherwise.

       <b>--check-only</b>, <b>--dry-run</b>
              Do not perform actual migration, stop after preliminary checks.  This is used to check if a CT can
              possibly be migrated. Combine with <b>--live</b> to enable more checks for live migration case.

       <b>-f</b>|<b>--nodeps</b>[<b>=</b><u>check</u>[<b>,</b><u>check</u> ...]]
              Continue migration, ignoring some or all preliminary check failures.   Particular  checks  can  be
              ignored  by  providing  an  argument to <b>--nodeps</b> option. The following options can be used (comma-
              separated):
              • <b>cpu</b>     - ignore cpu capabilities check;
              • <b>ipv6</b>    - ignore ipv6 module check.

       <b>-t</b>, <b>--times</b>
              At the end of live migration, output various  timings  for  migration  stages  that  affect  total
              suspended CT time. Note that it only makes sense with <b>--live</b>.

       <b>-v</b>     Verbose  mode.  Causes  <b>vzmigrate</b>  to  print  debugging  messages about its progress. Note that <b>-v</b>
              automatically implies <b>-t</b>.  Multiple <b>-v</b> options increase the verbosity.

       <b>-h</b>|<b>--help</b>|<b>--usage</b>
              Print usage info and exit.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Migration of CT 101 to <b>192.168.1.130</b> with downtime:

          vzmigrate 192.168.1.130 101

       Online migration of CT 102 to <b>192.168.1.130</b>:

          vzmigrate --live 192.168.1.130 102

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <b>0</b> <b>EXIT_OK</b>
              Command completed successfully.

       <b>1</b> <b>EXIT_USAGE</b>
              Bad command line options.

       <b>2</b> <b>EXIT_VE_STOPPED</b>
              Container is stopped.

       <b>4</b> <b>EXIT_CONNECT</b>
              Can't connect to destination (source) HN.

       <b>6</b> <b>EXIT_COPY</b>
              Container private area copying/moving failed.

       <b>7</b> <b>EXIT_VE_START</b>
              Can't start or restore destination CT.

       <b>8</b> <b>EXIT_VE_STOP</b>
              Can't stop or checkpoint source CT.

       <b>9</b> <b>EXIT_EXISTS</b>
              Container already exists on destination HN.

       <b>10</b> <b>EXIT_NOTEXIST</b>
              Container does not exists on source HN.

       <b>12</b> <b>EXIT_IP_INUSE</b>
              You attempt to migrate CT which IP address(es) are already in use on the destination node.

       <b>13</b> <b>EXIT_QUOTA</b>
              Operation with CT quota failed.

       <b>14</b> <b>EXIT_OVZ_NOT_RUNNING</b>
              OpenVZ is not running, or some required kernel modules are not loaded.

       <b>15</b> <b>EXIT_APPLY_CONFIG</b>
              Unable to set CT name on destination node.

       <b>16</b> <b>EXIT_PLOOP_UNSUP</b>
              Ploop is not supported by destination node.

       <b>17</b> <b>EXIT_UNSUP_CPT_VER</b>
              CPT version incompatibility with the destination node.

       <b>18</b> <b>EXIT_UNSUP_CPU</b>
              Destination node CPU incompatibility.

       <b>19</b> <b>EXIT_CANT_READ_REMOTE_CONFIG</b>
              Unable to read remote vz.conf.

       <b>20</b> <b>EXIT_LOCKED</b>
              Can't lock container (already locked).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/rsync.1.html">rsync</a></b>(1), <b><a href="../man8/vzcptcheck.8.html">vzcptcheck</a></b>(8).

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2001-2013, Parallels, Inc. Licensed under GNU GPL.

OpenVZ                                             5 Mar 2013                                       <u><a href="../man8/vzmigrate.8.html">vzmigrate</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>