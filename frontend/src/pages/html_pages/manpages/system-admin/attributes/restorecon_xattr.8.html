<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>restorecon_xattr   -   manage   security.sehash  extended  attribute  entries  added  by  setfiles(8)  or</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/policycoreutils">policycoreutils_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       restorecon_xattr   -   manage   <u>security.sehash</u>  extended  attribute  entries  added  by  <b><a href="../man8/setfiles.8.html">setfiles</a></b>(8)  or
       <b><a href="../man8/restorecon.8.html">restorecon</a></b>(8).

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>restorecon_xattr</b> [<b>-d</b>] [<b>-D</b>] [<b>-m</b>] [<b>-n</b>] [<b>-r</b>] [<b>-v</b>] [<b>-e</b> <u>directory</u>] [<b>-f</b> <u>specfile</u>] <u>pathname</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>restorecon_xattr</b> will display the SHA1 digests added to extended attributes <u>security.sehash</u> or delete the
       attribute completely. These attributes are set by <b><a href="../man8/restorecon.8.html">restorecon</a></b>(8) or <b><a href="../man8/setfiles.8.html">setfiles</a></b>(8) to  specified  directories
       when relabeling recursively.

       <b>restorecon_xattr</b>  is  useful  for  managing the extended attribute entries particularly when users forget
       what directories they ran <b><a href="../man8/restorecon.8.html">restorecon</a></b>(8) or <b><a href="../man8/setfiles.8.html">setfiles</a></b>(8) from.

       <b>RAMFS</b> and <b>TMPFS</b> filesystems do not support the <u>security.sehash</u> extended attribute and  are  automatically
       excluded from searches.

       By default <b>restorecon_xattr</b> will display the SHA1 digests with "Match" appended if they match the default
       specfile  set  or  the  <u>specfile</u> set used with the <b>-f</b> option. Non-matching SHA1 digests will be displayed
       with "No Match" appended.  This feature can be disabled by the <b>-n</b> option.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-d</b>     delete all non-matching <u>security.sehash</u> directory digest entries.

       <b>-D</b>     delete all <u>security.sehash</u> directory digest entries.

       <b>-m</b>     do not read <b><a href="file:/proc/mounts">/proc/mounts</a></b> to obtain a list of non-seclabel mounts to be  excluded  from  relabeling
              checks.
              Setting  <b>-m</b>  is  useful  where  there is a non-seclabel fs mounted with a seclabel fs mounted on a
              directory below this.

       <b>-n</b>     Do not append "Match" or "No Match" to displayed digests.

       <b>-r</b>     recursively descend directories.

       <b>-v</b>     display SHA1 digest generated by specfile set (Note that this digest is  not  used  to  match  the
              <u>security.sehash</u> directory digest entries, and is shown for reference only).

       <b>-e</b>     <u>directory</u>
              directory to exclude (repeat option for more than one directory).

       <b>-f</b>     <u>specfile</u>
              an  optional  <u>specfile</u>  containing  file context entries as described in <b><a href="../man5/file_contexts.5.html">file_contexts</a></b>(5).  If the
              option is not specified, then the default file_contexts will be used.

</pre><h4><b>ARGUMENTS</b></h4><pre>
       <u>pathname</u>
              the pathname of the directory tree to be searched.

</pre><h4><b>EXAMPLE</b></h4><pre>
       List all paths that where assigned a checksum by "restorecon/setfiles -D"
       # restorecon_xattr -r /
       Remove all non-matching checksums
       # restorecon_xattr -rd /

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/restorecon.8.html">restorecon</a></b>(8), <b><a href="../man8/setfiles.8.html">setfiles</a></b>(8)

                                                  24 Sept 2016                               <u><a href="../man8/restorecon_xattr.8.html">restorecon_xattr</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>