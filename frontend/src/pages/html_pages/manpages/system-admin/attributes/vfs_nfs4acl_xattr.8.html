<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vfs_nfs4acl_xattr - Save NTFS-ACLs as NFS4 encoded blobs in extended attributes</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/samba">samba_4.22.3+dfsg-4ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       vfs_nfs4acl_xattr - Save NTFS-ACLs as NFS4 encoded blobs in extended attributes

</pre><h4><b>SYNOPSIS</b></h4><pre>

       vfs objects = nfs4acl_xattr

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This VFS module is part of the <b><a href="../man7/samba.7.html">samba</a></b>(7) suite.

       The vfs_nfs4acl_xattr VFS module provides an interoperability layer between the SMB ACLs that clients
       expect and an NFSv4 ACL implementation a file system might provide.

       This module is stackable.

</pre><h4><b>OPTIONS</b></h4><pre>
       nfs4:mode = [ simple | special ]
           Controls substitution of special IDs (OWNER@ and GROUP@) on NFS4 ACLs. The use of mode simple is
           recommended. In this mode only non inheriting ACL entries for the file owner and group are mapped to
           special IDs.

           The following MODEs are understood by the module:

                  •   simple(default) - use OWNER@ and GROUP@ special IDs for non inheriting ACEs only.

                  •   special(deprecated) - use OWNER@ and GROUP@ special IDs in ACEs for all file owner and
                      group ACEs.

       nfs4:acedup = [dontcare|reject|ignore|merge]
           This parameter configures how Samba handles duplicate ACEs encountered in NFS4 ACLs. They allow
           creating duplicate ACEs with different bits for same ID, which may confuse the Windows clients.

           Following is the behaviour of Samba for different values :

                  •   dontcare - copy the ACEs as they come

                  •   reject (deprecated) - stop operation and exit with error on ACL set op

                  •   ignore (deprecated) - don't include the second matching ACE

                  •   merge (default) - bitwise OR the 2 ace.flag fields and 2 ace.mask fields of the 2
                      duplicate ACEs into 1 ACE

       nfs4:chown = [yes|no]
           This parameter allows enabling or disabling the chown supported by the underlying filesystem. This
           parameter should be enabled with care as it might leave your system insecure.

           Some filesystems allow chown as a) giving b) stealing. It is the latter that is considered a risk.

           Following is the behaviour of Samba for different values :

                  •   yes - Enable chown if as supported by the under filesystem

                  •   no (default) - Disable chown

       nfs4acl_xattr:encoding = [nfs|ndr|xdr]
           This parameter configures the marshaling format used in the ACL blob and the default extended
           attribute name used to store the blob.

           When set to <u>nfs</u> - fetch and store the NT ACL in NFS 4.0 or 4.1 compatible XDR encoding. By default
           this uses the extended attribute "system.nfs4_acl". This setting also disables <u>validate_mode</u>.

           When set to <u>ndr</u> <u>(default)</u> - store the NT ACL with POSIX draft NFSv4 compatible NDR encoding. By
           default this uses the extended attribute "security.nfs4acl_ndr".

           When set to <u>xdr</u> - store the NT ACL in a format similar to NFS 4.1 RFC 5661 in XDR encoding. The main
           differences to RFC 5661 are the use of ids instead of strings as users and group identifiers and an
           additional attribute per nfsace4. By default this encoding stores the blob in the extended attribute
           "security.nfs4acl_xdr".

       nfs4acl_xattr:version = [40|41]
           This parameter configures the NFS4 ACL level. Only <u>41</u> fully supports mapping NT ACLs and should be
           used. The default is <u>41</u>.

       nfs4acl_xattr:default acl style = [posix|windows|everyone]
           This parameter determines the type of ACL that is synthesized in case a file or directory lacks an
           ACL extended attribute.

           When set to <u>posix</u>, an ACL will be synthesized based on the POSIX mode permissions for user, group and
           others, with an additional ACE for <u>NT</u> <u>Authority\SYSTEM</u> will full rights.

           When set to <u>windows</u>, an ACL is synthesized the same way Windows does it, only including permissions
           for the owner and <u>NT</u> <u>Authority\SYSTEM</u>.

           When set to <u>everyone</u>, an ACL is synthesized giving full permissions to everyone (S-1-1-0).

           The default for this option is <u>everyone</u>.

       nfs4acl_xattr:xattr_name = STRING
           This parameter configures the extended attribute name used to store the marshaled ACL.

           The default depends on the setting for <u>nfs4acl_xattr:encoding</u>.

       nfs4acl_xattr:nfs4_id_numeric = yes|no (default: no)
           This parameter tells the module how the NFS4 server encodes user and group identifiers on the
           network. With the default setting the module expects identifiers encoded as per the NFS4 RFC as
           user@domain.

           When set to <u>yes</u>, the module expects the identifiers as numeric string.

           The default for this options<u>no</u>.

       nfs4acl_xattr:validate_mode = yes|no
           This parameter configures whether the module enforces the POSIX mode is set to 0777 for directories
           and 0666 for files. If this constrained is not met, the xattr with the ACL blob is discarded.

           The default depends on the setting for <u>nfs4acl_xattr:encoding</u>: when set to <u>nfs</u> this setting is
           disabled by default, otherwise it is enabled.

</pre><h4><b>EXAMPLES</b></h4><pre>
       A directory can be exported via Samba using this module as follows:

                 <u>[samba_gpfs_share]</u>
                 <b>vfs</b> <b>objects</b> <b>=</b> <b>nfs4acl_xattr</b>
                 <b>path</b> <b>=</b> <b>/foo/bar</b>

</pre><h4><b>AUTHOR</b></h4><pre>
       The original Samba software and related utilities were created by Andrew Tridgell. Samba is now developed
       by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.

Samba 4.22.3-Ubuntu-4.22.3+dfs                     07/21/2025                               <u><a href="../man8/VFS_NFS4ACL_XATTR.8.html">VFS_NFS4ACL_XATTR</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>