<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>restore - Cyrus IMAP documentation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/cyrus-common">cyrus-common_3.10.2-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       restore - Cyrus IMAP documentation

       Restore content from Cyrus backups.

</pre><h4><b>SYNOPSIS</b></h4><pre>
          <b>restore</b> [OPTIONS] <u>server</u> [MODE] <u>backup</u> [ <u>mboxname</u> | <u>uniqueid</u> | <u>guid</u> ]...

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>NOTE:</b>
          Cyrus Backups are experimental, incomplete, and deprecated as of 3.10.

       <b>restore</b>  is  a  tool for restoring messages and mailboxes from a Cyrus backup to a Cyrus IMAP server.  It
       must be run from the server containing the backup storage.

       <b>restore</b> reads its configuration options out of the <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u> file unless specified otherwise by <b>-C</b>.

       <u>server</u> specifies the destination server to which content should be restored.  It should be  of  the  form
       '<u>host</u>[:<u>port</u>]',  where  <u>host</u>  is  either  a  hostname,  an IPv4 address, or an IPv6 address, and where the
       optional <u>port</u> is either a known service name (see <b><a href="../man5/services.5.html">services</a>(5)</b>) or a decimal  port  number.   If  <u>port</u>  is
       omitted, <b>imap</b> will be tried first, followed by <b>csync</b>.

       The destination server must point to either an <u><a href="../man8/imapd.8.html">imapd</a>(8)</u> instance with the replication capability enabled,
       or a <u><a href="../man8/sync_server.8.html">sync_server</a>(8)</u> instance.  In either case it must be Cyrus version 3.0 or newer.

       <b>restore</b>  will  authenticate to the destination server according to the <b>restore_authname</b>, <b>restore_password</b>
       and <b>restore_realm</b> configuration options.  The credentials should correspond with one of  the  destination
       server's <b>admins</b>.

       <u>backup</u> is interpreted according to the specified MODE.  See <u>Modes</u> below.

       If  neither <b>-a</b> nor <b>-F</b> options were provided, then the remaining arguments constitute a list of objects to
       be restored.  These may be mailboxes (specified by either <u>mboxname</u> or <u>uniqueid</u>) or messages (specified by
       their <u>guid</u>).  The objects may be specified in any order, and both mailboxes and individual  messages  may
       be restored in one go.  <u><a href="../man8/cyr_backup.8.html">cyr_backup</a>(8)</u> can be used to identify objects to restore from a Cyrus backup.

       Selected mailboxes will have their messages restored to a mailbox of the same name, which will be created
       if  necessary.  Individually-selected messages will be restored to the mailboxes in which they previously
       existed.  In both cases the <b>-M</b> option can be used to override the destination mailbox  (see  below),  but
       note  the  consequences  of  doing this when multiple mailbox objects have been specified, or when the <b>-r</b>
       option is in use.

       Mailboxes that are created during the restoration process will have their ACL set to the  one  stored  in
       the  backup.   The  <b>-A</b>  option  can  be used to override this.  Mailboxes that are not created during the
       restoration process (i.e. when restoring into mailboxes that already exists) will  not  have  their  ACLs
       altered.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-A</b> <b>[acl],</b> <b>--override-acl[=acl]</b>
              Apply specified <u>acl</u> to restored mailboxes, rather than their ACLs as stored in the backup.

              If  <u>acl</u>  is  the  empty string (e.g. <b>-A</b> <b>""</b>) or is unspecified, mailboxes will be restored with the
              default ACL for their destination owner.  This is mostly useful when restoring  folders  from  one
              user's backup into a different user's mailbox.

       <b>-C</b> <b>config-file</b>
              Use the specified configuration file <u>config-file</u> rather than the default <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>.

       <b>-D,</b> <b>--keep-deletedprefix</b>
              Don't  trim  <b>deletedprefix</b>  from  mailbox  names  prior  to  restoring.  This is mainly useful for
              rebuilding failed servers, where deleted mailboxes should be restored as deleted mailboxes, not as
              new ones.

              The default is to trim the prefix before restoring.

              If the original server from which the backups were produced had <b>delete_mode</b> set to <u>immediate</u>, then
              the mailboxes in the backup will not have such a prefix, and this option  won't  have  any  useful
              effect.

              See <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u> for information about the <b>deletedprefix</b> and <b>delete_mode</b> configuration options.

       <b>-F</b> <b>input-file,</b> <b>--input-file=input-file</b>
              Get the list of mailboxes or messages from <u>input-file</u> instead of from the command line arguments.

              <u>input-file</u> should contain one object specification (either an <u>mboxname</u>, a <u>uniqueid</u>, or a <u>guid</u>) per
              line.  Empty lines, and lines beginning with a '#' character, are ignored.

       <b>-L,</b> <b>--local-only</b>
              Local  operations  only.  Actions required to restore the requested mailboxes and messages will be
              performed on the destination server only.  <u><a href="../man8/mupdate.8.html">mupdate</a>(8)</u> actions will not occur.

              The default is for mupdate actions to occur if the destination server is part of a murder.

              This option has no effect if the destination server is not part of a murder.

       <b>-M</b> <b>mboxname,</b> <b>--dest-mailbox=mboxname</b>
              Messages are restored to the mailbox with the specified <u>mboxname</u>.  If  no  mailbox  of  this  name
              exists, one will be created.

              If  multiple  mailbox  objects  are  to be restored, whether due to being specified on the command
              line, in an <u>input-file</u>, or via the <b>-r</b> option, then the collective contents of all  such  mailboxes
              will be restored to the single mailbox <u>mboxname</u>.  This may not be what you want!

              The default when restoring mailboxes is to restore their respective contents into mailboxes of the
              same names.

              The default when restoring individual messages is to restore them into their original mailboxes.

       <b>-P</b> <b>partition,</b> <b>--dest-partition=partition</b>
              Restore mailboxes to the specified <u>partition</u>

       <b>-U,</b> <b>--keep-uidvalidity</b>
              Try  to  preserve  uidvalidity  and  other  related  fields,  such that the restored mailboxes and
              messages appear like they never left, and IMAP clients can avoid expensive state updates.

              This can only occur if the mailboxes to be restored  <b>do</b>  <b>not</b>  already  exist  on  the  destination
              server.  As such, this option is mainly useful when rebuilding a failed server.

              If  the  destination  mailboxes  already  exist,  restored  messages  will be appended as if newly
              delivered, regardless of whether the <b>-U</b> option was specified.

       <b>-X,</b> <b>--skip-expunged</b>
              Do not restore messages that are marked as expunged in the <u>backup</u>.

              See also <b>-x</b>.

       <b>-a,</b> <b>--all-mailboxes</b>
              Try to restore all mailboxes in the specified <u>backup</u>.

       <b>-n,</b> <b>--dry-run</b>
              Do nothing.  The work required to  perform  the  restoration  will  be  calculated  (and  reported
              depending  on verbosity level), but no restoration will take place, and no connection will be made
              to the destination server.

              Note that the <u>server</u> argument is still mandatory with this option.

       <b>-r,</b> <b>--recursive</b>
              Recurse into submailboxes.  When restoring mailboxes, also restore any mailboxes contained  within
              them.

              The default is to restore only explicitly-specified mailboxes.

       <b>-v,</b> <b>--verbose</b>
              Increase  the  verbosity  level.   This  option  can  be  specified  multiple times for additional
              verbosity.

       <b>-w</b> <b>seconds,</b> <b>--delayed-startup=seconds</b>
              Wait <u>seconds</u> before starting.  This is useful for attaching a debugger.

       <b>-x,</b> <b>--only-expunged</b>
              Only restore messages that are marked as expunged in the <u>backup</u>.

              This can be convenient for restoring messages that were accidentally deleted by the user,  without
              needing to track down individual message guids.

              See also <b>-X</b>.

       <b>-z,</b> <b>--require-compression</b>
              Require compression for server connection.  The restore will abort if compression is unavailable.

</pre><h4><b>MODES</b></h4><pre>
       <b>-f</b> <b>backup,</b> <b>--file=backup</b>
              <u>backup</u>  is  interpreted  as  a  filename.   The  named file does not need to be known about in the
              backups database.

       <b>-m</b> <b>backup,</b> <b>--mailbox=backup</b>
              <u>backup</u> is interpreted as a mailbox name.  There must be a known backup for the user whose  mailbox
              this is.

              Known  backups  are  recorded  in  the  database  specified  by  the  <b>backup_db</b> and <b>backup_db_path</b>
              configuration options.

       <b>-u</b> <b>backup,</b> <b>--userid=backup</b>
              <u>backup</u> is interpreted as a userid.  There must be a known backup for the specified user.

              This is the default if no mode is specified.

</pre><h4><b>EXAMPLES</b></h4><pre>
</pre><h4><b>HISTORY</b></h4><pre>
</pre><h4><b>FILES</b></h4><pre>
</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man5/imapd.conf.5.html">imapd.conf</a>(5)</u>, <b><a href="../man5/services.5.html">services</a>(5)</b>, <u><a href="../man8/cyr_backup.8.html">cyr_backup</a>(8)</u>, <u><a href="../man8/imapd.8.html">imapd</a>(8)</u>, <u><a href="../man8/mupdate.8.html">mupdate</a>(8)</u>, <u><a href="../man8/sync_server.8.html">sync_server</a>(8)</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       The Cyrus Team

</pre><h4><b>COPYRIGHT</b></h4><pre>
       1993–2025, The Cyrus Team

3.10.2                                            Jun 27, 2025                                        <u><a href="../man8/RESTORE.8.html">RESTORE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>