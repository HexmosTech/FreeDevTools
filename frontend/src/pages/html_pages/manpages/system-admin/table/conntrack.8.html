<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>conntrack - command line interface for netfilter connection tracking</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/conntrack">conntrack_1.4.8-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       conntrack - command line interface for netfilter connection tracking

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>conntrack</b> <b>-L</b> <b>[table]</b> <b>[options]</b> <b>[-z]</b>
       <b>conntrack</b> <b>-G</b> <b>[table]</b> <b>parameters</b>
       <b>conntrack</b> <b>-D</b> <b>[table]</b> <b>parameters</b>
       <b>conntrack</b> <b>-I</b> <b>[table]</b> <b>parameters</b>
       <b>conntrack</b> <b>-A</b> <b>[table]</b> <b>parameters</b>
       <b>conntrack</b> <b>-U</b> <b>[table]</b> <b>parameters</b>
       <b>conntrack</b> <b>-E</b> <b>[table]</b> <b>[options]</b>
       <b>conntrack</b> <b>-F</b> <b>[table]</b>
       <b>conntrack</b> <b>-C</b> <b>[table]</b>
       <b>conntrack</b> <b>-S</b>
       <b>conntrack</b> <b>-R</b> <b>file</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>conntrack</b>  utility provides a full-featured userspace interface to the Netfilter connection tracking
       system that is intended to replace the old /proc/net/ip_conntrack interface. This tool  can  be  used  to
       search, list, inspect and maintain the connection tracking subsystem of the Linux kernel.

       Using  <b>conntrack</b>,  you can dump a list of all (or a filtered selection of) currently tracked connections,
       delete connections from the state table, and even add new ones.

       In addition, you can also monitor connection tracking events, e.g. show an event message (one  line)  per
       newly established connection.

</pre><h4><b>TABLES</b></h4><pre>
       The connection tracking subsystem maintains several internal tables:

       <b>conntrack</b>:
              This  is  the  default table.  It contains a list of all currently tracked connections through the
              system.  If you don't use connection tracking exemptions (NOTRACK iptables target), this means all
              connections that go through the system.

       <b>expect</b>:
              This is the table of expectations.  Connection tracking expectations are  the  mechanism  used  to
              "expect"  <b>RELATED</b>  connections  to  existing ones.  Expectations are generally used by "connection
              tracking helpers" (sometimes called application level gateways [ALGs]) for more complex  protocols
              such as FTP, SIP or H.323.

       <b>dying</b>: This  table  shows  the  conntrack  entries, that have expired and that have been destroyed by the
              connection tracking system itself, or via the <b>conntrack</b> utility.

       <b>unconfirmed</b>:
              This table shows new entries, that are not yet inserted into the conntrack  table.  These  entries
              are attached to packets that are traversing the stack, but did not reach the confirmation point at
              the postrouting hook.

              The  tables  "dying"  and  "unconfirmed"  are  basically only useful for debugging purposes. Under
              normal operation, it is hard to see entries in any of them.  There are corner cases, where  it  is
              valid to see entries in the unconfirmed table, eg. when packets that are enqueued via nfqueue, and
              the dying table, eg. when <b><a href="../man8/conntrackd.8.html">conntrackd</a>(8)</b> runs in event reliable mode.

</pre><h4><b>OPTIONS</b></h4><pre>
       The options recognized by <b>conntrack</b> can be divided into several different groups.

   <b>COMMANDS</b>
       These  options  specify  the  particular  operation to perform.  Only one of them can be specified at any
       given time.

       <b>-L</b> <b>--dump</b>
              List connection tracking or expectation table

       <b>-G,</b> <b>--get</b>
              Search for and show a particular (matching) entry in the given table.

       <b>-D,</b> <b>--delete</b>
              Delete an entry from the given table.

       <b>-I,</b> <b>--create</b>
              Create a new entry from the given table, it fails if it already exists.

       <b>-A,</b> <b>--add</b>
              Add a new entry from the given table.

       <b>-U,</b> <b>--update</b>
              Update an entry from the given table.

       <b>-E,</b> <b>--event</b>
              Display a real-time event log.

       <b>-F,</b> <b>--flush</b>
              Flush the whole given table

       <b>-C,</b> <b>--count</b>
              Show the table counter.

       <b>-S,</b> <b>--stats</b>
              Show the in-kernel connection tracking system statistics.

       <b>-R,</b> <b>--load-file</b>
              Load entries from a given file. To read from stdin, "-" should be specified.

   <b>PARAMETERS</b>
       <b>-z,</b> <b>--zero</b>
              Atomically zero counters after reading them.  This option is only valid in  combination  with  the
              "-L, --dump" command options.

       <b>-o,</b> <b>--output</b> <b>[extended,xml,save,timestamp,id,ktimestamp,labels]</b>
              Display  output in a certain format. With the extended output option, this tool displays the layer
              3 information. With ktimestamp, it displays the in-kernel timestamp available  since  2.6.38  (you
              can  enable  it  via  the  <b><a href="../man8/sysctl.8.html">sysctl</a>(8)</b> key <b>net.netfilter.nf_conntrack_timestamp</b>).  The labels output
              option tells <b>conntrack</b> to show the names of connection tracking labels that might be present.  The
              userspace output option tells if the event has been triggered by a process.

       <b>-e,</b> <b>--event-mask</b> <u>[ALL|NEW|UPDATES|DESTROY][,...]</u>
              Set the bitmask of events that are to be generated by the in-kernel ctnetlink event  code.   Using
              this  parameter,  you  can reduce the event messages generated by the kernel to the types that you
              are actually interested in.  This option can only be used in conjunction with "-E, --event".

       <b>-b,</b> <b>--buffer-size</b> <u>value</u>
              Set the Netlink socket buffer size in bytes. This option  is  useful  if  the  command  line  tool
              reports  ENOBUFS  errors. If you do not pass this option, the default value available at <b><a href="../man8/sysctl.8.html">sysctl</a>(8)</b>
              key <b>net.core.rmem_default</b> is used. The tool reports this problem if your process is  too  slow  to
              handle all the event messages or, in other words, if the amount of events is big enough to overrun
              the  socket buffer. Note that using a big buffer reduces the chances to hit ENOBUFS, however, this
              results in more memory consumption.  This option  can  only  be  used  in  conjunction  with  "-E,
              --event".

   <b>FILTER</b> <b>PARAMETERS</b>
       <b>-s,</b> <b>--src,</b> <b>--orig-src</b> <u>IP_ADDRESS</u>
              Match  only  entries  whose  source  address in the original direction equals the one specified as
              argument. Implies "--mask-src" when CIDR notation is used.

       <b>-d,</b> <b>--dst,</b> <b>--orig-dst</b> <u>IP_ADDRESS</u>
              Match only entries whose destination address in the original direction equals the one specified as
              argument. Implies "--mask-dst" when CIDR notation is used.

       <b>-r,</b> <b>--reply-src</b> <u>IP_ADDRESS</u>
              Match only entries whose source address in  the  reply  direction  equals  the  one  specified  as
              argument.

       <b>-q,</b> <b>--reply-dst</b> <u>IP_ADDRESS</u>
              Match  only  entries  whose destination address in the reply direction equals the one specified as
              argument.

       <b>-p,</b> <b>--proto</b> <u>PROTO</u>
              Specify layer four (TCP, UDP, ...) protocol.

       <b>-f,</b> <b>--family</b> <u>PROTO</u>
              Specify layer three (ipv4, ipv6) protocol.  This option is only required in conjunction with  "-L,
              --dump". If this option is not passed, the default layer 3 protocol will be IPv4.

       <b>-t,</b> <b>--timeout</b> <u>TIMEOUT</u>
              Specify the timeout.

       <b>-m,</b> <b>--mark</b> <u>MARK[/MASK]</u>
              Specify  the conntrack mark.  Optionally, a mask value can be specified.  In "--update" mode, this
              mask specifies the bits that should be zeroed before  XORing  the  MARK  value  into  the  ctmark.
              Otherwise, the mask is logically ANDed with the existing mark before the comparison. In "--create"
              mode, the mask is ignored.

       <b>-l,</b> <b>--label</b> <u>LABEL</u>
              Specify  a  conntrack label.  This option is only available in conjunction with "-L, --dump", "-E,
              --event", "-U --update" or "-D --delete".  Match entries whose labels include those  specified  as
              arguments.  Use multiple -l options to specify multiple labels that need to be set.

       <b>--label-add</b> <u>LABEL</u>
              Specify  the  conntrack label to add to the selected conntracks.  This option is only available in
              conjunction with "-I, --create", "-A, --add" or "-U, --update".

       <b>--label-del</b> <u>[LABEL]</u>
              Specify the conntrack label to delete from the selected conntracks.  If no  label  is  given,  all
              labels are deleted.  This option is only available in conjunction with "-U, --update".

       <b>-c,</b> <b>--secmark</b> <u>SECMARK</u>
              Specify the conntrack selinux security mark.

       <b>-u,</b> <b>--status</b> <u>[ASSURED|SEEN_REPLY|FIXED_TIMEOUT|EXPECTED|OFFLOAD|UNSET][,...]</u>
              Specify the conntrack status.

       <b>-n,</b> <b>--src-nat</b>
              Filter source NAT connections.

       <b>-g,</b> <b>--dst-nat</b>
              Filter destination NAT connections.

       <b>-j,</b> <b>--any-nat</b>
              Filter any NAT connections.

       <b>-w,</b> <b>--zone</b>
              Filter by conntrack zone. See iptables CT target for more information.

       <b>--orig-zone</b>
              Filter by conntrack zone in original direction.  See iptables CT target for more information.

       <b>--reply-zone</b>
              Filter by conntrack zone in reply direction.  See iptables CT target for more information.

       <b>--tuple-src</b> <u>IP_ADDRESS</u>
              Specify  the  tuple  source address of an expectation.  Implies "--mask-src" when CIDR notation is
              used.

       <b>--tuple-dst</b> <u>IP_ADDRESS</u>
              Specify the tuple destination address of an expectation.  Implies "--mask-dst" when CIDR  notation
              is used.

       <b>--mask-src</b> <u>IP_ADDRESS</u>
              Specify the source address mask.  For conntracks this option is only available in conjunction with
              "-L, --dump", "-E, --event", "-U --update" or "-D --delete".  For expectations this option is only
              available in conjunction with "-I, --create".

       <b>--mask-dst</b> <u>IP_ADDRESS</u>
              Specify the destination address mask.  Same limitations as for "--mask-src".

   <b>PROTOCOL</b> <b>FILTER</b> <b>PARAMETERS</b>
       TCP-specific fields:

       <b>--sport,</b> <b>--orig-port-src</b> <u>PORT</u>
              Source port in original direction

       <b>--dport,</b> <b>--orig-port-dst</b> <u>PORT</u>
              Destination port in original direction

       <b>--reply-port-src</b> <u>PORT</u>
              Source port in reply direction

       <b>--reply-port-dst</b> <u>PORT</u>
              Destination port in reply direction

       <b>--state</b> <u>state</u>
              TCP  state,  one  of  NONE,  SYN_SENT,  SYN_RECV,  ESTABLISHED,  FIN_WAIT,  CLOSE_WAIT,  LAST_ACK,
              TIME_WAIT, CLOSE or LISTEN.

       UDP-specific fields:

       <b>--sport,</b> <b>--orig-port-src</b> <u>PORT</u>
              Source port in original direction

       <b>--dport,</b> <b>--orig-port-dst</b> <u>PORT</u>
              Destination port in original direction

       <b>--reply-port-src</b> <u>PORT</u>
              Source port in reply direction

       <b>--reply-port-dst</b> <u>PORT</u>
              Destination port in reply direction

       ICMP-specific fields:

       <b>--icmp-type</b> <u>TYPE</u>
              ICMP Type. Has to be specified numerically.

       <b>--icmp-code</b> <u>CODE</u>
              ICMP Code. Has to be specified numerically.

       <b>--icmp-id</b> <u>ID</u>
              ICMP Id. Has to be specified numerically (non-mandatory)

       UDPlite-specific fields:

       <b>--sport,</b> <b>--orig-port-src</b> <u>PORT</u>
              Source port in original direction

       <b>--dport,</b> <b>--orig-port-dst</b> <u>PORT</u>
              Destination port in original direction

       <b>--reply-port-src</b> <u>PORT</u>
              Source port in reply direction

       <b>--reply-port-dst</b> <u>PORT</u>
              Destination port in reply direction

       SCTP-specific fields:

       <b>--sport,</b> <b>--orig-port-src</b> <u>PORT</u>
              Source port in original direction

       <b>--dport,</b> <b>--orig-port-dst</b> <u>PORT</u>
              Destination port in original direction

       <b>--reply-port-src</b> <u>PORT</u>
              Source port in reply direction

       <b>--reply-port-dst</b> <u>PORT</u>
              Destination port in reply direction

       <b>--state</b> <u>state</u>
              SCTP  state,  one  of  NONE,  CLOSED,  COOKIE_WAIT,  COOKIE_ECHOED,  ESTABLISHED,   SHUTDOWN_SENT,
              SHUTDOWN_RECD, SHUTDOWN_ACK_SENT.

       <b>--orig-vtag</b> <u>value</u>
              Verification tag (32-bits value) in the original direction

       <b>--reply-vtag</b> <u>value</u>
              Verification tag (32-bits value) in the reply direction

       DCCP-specific fields (needs Linux &gt;= 2.6.30):

       <b>--sport,</b> <b>--orig-port-src</b> <u>PORT</u>
              Source port in original direction

       <b>--dport,</b> <b>--orig-port-dst</b> <u>PORT</u>
              Destination port in original direction

       <b>--reply-port-src</b> <u>PORT</u>
              Source port in reply direction

       <b>--reply-port-dst</b> <u>PORT</u>
              Destination port in reply direction

       <b>--state</b> <u>state</u>
              DCCP state, one of NONE, REQUEST, RESPOND, PARTOPEN, OPEN, CLOSEREQ, CLOSING, TIMEWAIT.

       <b>--role</b> <u>[client|server]</u>
              Role that the original conntrack tuple is tracking

       GRE-specific fields:

       <b>--srckey,</b> <b>--orig-key-src</b> <u>KEY</u>
              Source key in original direction (in hexadecimal or decimal)

       <b>--dstkey,</b> <b>--orig-key-dst</b> <u>KEY</u>
              Destination key in original direction (in hexadecimal or decimal)

       <b>--reply-key-src</b> <u>KEY</u>
              Source key in reply direction (in hexadecimal or decimal)

       <b>--reply-key-dst</b> <u>KEY</u>
              Destination key in reply direction (in hexadecimal or decimal)

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       The  exit  code  is  0  for  correct  function.  Errors which appear to be caused by invalid command line
       parameters cause an exit code of 2.  Any other errors cause an exit code of 1.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>conntrack</b> <b>-L</b>
              Show the connection tracking table in /proc/net/ip_conntrack format

       <b>conntrack</b> <b>-L</b> <b>-o</b> <b>extended</b>
              Show the connection tracking table in /proc/net/nf_conntrack format, with additional information.

       <b>conntrack</b> <b>-L</b> <b>-o</b> <b>xml</b>
              Show the connection tracking table in XML

       <b>conntrack</b> <b>-L</b> <b>-o</b> <b>save</b>
              Show the connection tracking table in conntrack syntax format

       <b>conntrack</b> <b>-L</b> <b>-f</b> <b>ipv6</b> <b>-o</b> <b>extended</b>
              Only dump IPv6 connections in /proc/net/nf_conntrack format, with additional information.

       <b>conntrack</b> <b>-L</b> <b>--src-nat</b>
              Show source NAT connections

       <b>conntrack</b> <b>-E</b> <b>-o</b> <b>timestamp</b>
              Show connection events together with the timestamp

       <b>conntrack</b> <b>-D</b> <b>-s</b> <b>1.2.3.4</b>
              Delete all flows whose source address is 1.2.3.4

       <b>conntrack</b> <b>-U</b> <b>-s</b> <b>1.2.3.4</b> <b>-m</b> <b>1</b>
              Set connmark to 1 of all the flows whose source address is 1.2.3.4

       <b>conntrack</b> <b>-L</b> <b>-w</b> <b>11</b> <b>-o</b> <b>save</b> <b>|</b> <b>sed</b> <b>s/-w</b> <b>11/-w</b> <b>12/g</b> <b>|</b> <b>conntrack</b> <b>--load-file</b> <b>-</b>
              Copy all entries from ct zone 11 to ct zone 12

</pre><h4><b>BUGS</b></h4><pre>
       Please,  report  them  to  <a href="mailto:netfilter-devel@vger.kernel.org">netfilter-devel@vger.kernel.org</a>  or  file  a  bug  in   Netfilter's   bugzilla
       (https://bugzilla.netfilter.org).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/nftables.8.html">nftables</a></b>(8),<b><a href="../man8/iptables.8.html">iptables</a></b>(8),<b><a href="../man8/conntrackd.8.html">conntrackd</a>(8)</b>
       See <b><a href="http://conntrack-tools.netfilter.org">http://conntrack-tools.netfilter.org</a></b>

</pre><h4><b>AUTHORS</b></h4><pre>
       Jay  Schulist,  Patrick  McHardy,  Harald  Welte and Pablo Neira Ayuso wrote the kernel-level "ctnetlink"
       interface that is used by the conntrack tool.

       Pablo Neira Ayuso wrote and maintains the conntrack tool, Harald Welte added support for  conntrack-based
       accounting counters.

       Man page written by Harald Welte &lt;<a href="mailto:laforge@netfilter.org">laforge@netfilter.org</a>&gt; and Pablo Neira Ayuso &lt;<a href="mailto:pablo@netfilter.org">pablo@netfilter.org</a>&gt;.

                                                   Aug 9, 2019                                      <u><a href="../man8/CONNTRACK.8.html">CONNTRACK</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>