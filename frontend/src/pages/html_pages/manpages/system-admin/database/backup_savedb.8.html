<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>backup_savedb - Creates a saved copy of the Backup Database</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openafs-client">openafs-client_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       backup_savedb - Creates a saved copy of the Backup Database

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>backup</b> <b>savedb</b> [<b>-portoffset</b> &lt;<u>TC</u> <u>port</u> <u>offset</u>&gt;]
           [<b>-archive</b> &lt;<u>date</u> <u>time</u>&gt;+] [<b>-localauth</b>]
           [<b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;] [<b>-help</b>]

       <b>backup</b> <b>sa</b> [<b>-p</b> &lt;<u>TC</u> <u>port</u> <u>offset</u>&gt;]
           [<b>-a</b> &lt;<u>date</u> <u>time</u>&gt;+]
           [<b>-l</b>] [<b>-c</b> &lt;<u>cell</u> <u>name</u>&gt;] [<b>-h</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>backup</b> <b>savedb</b> command creates a backup copy of the entire Backup Database and writes it to the tape
       in the device controlled by the Tape Coordinator indicated with the <b>-portoffset</b> argument. If the database
       is damaged (as reported by the <b>backup</b> <b>dbverify</b> command), this command repairs as much of the corruption
       as possible as it creates the saved copy. The Backup Server creates a dump record for the saved database
       in the Backup Database (but in the disk version of the database only, not in the version written to
       tape).

       If the "FILE YES" instruction appears in the <u>/var/lib/openafs/backup/CFG_device_name</u> file associated with
       the specified port offset, then the <b>backup</b> <b>savedb</b> command dumps the database copy to the backup data file
       listed for that port offset in the Tape Coordinator's <u>/var/lib/openafs/backup/tapeconfig</u> file, instead of
       to tape. For the sake of clarity, the following text refers to tapes only, but the Backup System handles
       backup data files in much the same way.

       If the <b>-archive</b> flag is provided, after writing the saved copy of the database the Backup System
       truncates the copy of the database on disk by deleting volume dump records with timestamps prior to the
       specified date and time (it does not delete the dump records created by previous <b>backup</b> <b>savedb</b> commands,
       however).

       If the tape to which the database copy is written has an AFS tape name, it must be "Ubik_db_dump.1" or
       "&lt;NULL&gt;". Any permanent name is acceptable.

       The Tape Coordinator's default response to this command is to access the first tape by invoking the
       "MOUNT" instruction in the local <u>/var/lib/openafs/backup/CFG_device_name</u> file, or by prompting the backup
       operator to insert the tape if there is no "MOUNT" instruction. However, if the "AUTOQUERY NO"
       instruction appears in the <u>CFG_device_name</u> file, or if the issuer of the <b>butc</b> command included the
       <b>-noautoquery</b> flag, the Tape Coordinator instead expects the tape to be in the device already.  If it is
       not, the Tape Coordinator invokes the "MOUNT" instruction or prompts the operator. It also invokes the
       "MOUNT" instruction or prompts for any additional tapes needed to complete the operation; the backup
       operator must arrange to provide them.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-portoffset</b> &lt;<u>TC</u> <u>port</u> <u>offset</u>&gt;
           Specifies the port offset number of the Tape Coordinator handling the tapes for this operation.

       <b>-archive</b> &lt;<u>date</u> <u>time</u>&gt;+
           Specifies a date and time; volume dump records with earlier timestamps are deleted from the disk copy
           of  the Backup Database after the Backup System dumps the database (a dump's timestamp appears in the
           "created" field of the output from the <b>backup</b> <b>dumpinfo</b> command). However, if a dump set contains  any
           dump  created  after  the  specified  date, none of the dump records associated with the dump set are
           deleted. Dump records for previous dumps of the database (created with the <b>backup</b> <b>savedb</b> command) are
           never deleted; use the <b>backup</b> <b>deletedump</b> command to remove them.

           Provide one of two values:

           •   The string "NOW" to indicate the current date and time, in which case the Backup  System  deletes
               all dump records except those for dumps of the Backup Database itself.

           •   A  date  value  in  the  format <u>mm/dd/yyyy</u> [<u>hh:MM</u>]. The month (<u>mm</u>), day (<u>dd</u>), and year (<u>yyyy</u>) are
               required, and valid values for the year range from 1970 to 2037;  higher  values  are  not  valid
               because  the  latest  possible  date in the standard UNIX representation is in February 2038. The
               Backup System automatically reduces any later date to the maximum value.

               The hour and minutes (<u>hh:MM</u>) are optional, but  if  provided  must  be  in  24-hour  format  (for
               example,  the  value  "14:36"  represents 2:36 p.m.). If omitted, the time defaults to 59 seconds
               after midnight (00:00:59 hours). Similarly, the <b>backup</b> command interpreter automatically adds  59
               seconds  to  any  time  value  provided. In both cases, adding 59 seconds compensates for how the
               Backup Database and <b>backup</b> <b>dumpinfo</b> command represent dump creation times in  hours  and  minutes
               only.  That is, the Database records a creation timestamp of "20:55" for any dump created between
               20:55:00 and 20:55:59. Automatically adding 59 seconds to a time thus includes  the  records  for
               all dumps created during that minute.

       <b>-localauth</b>
           Constructs  a  server  ticket using a key from the local <u>/etc/openafs/server/KeyFile</u> file. The <b>backup</b>
           command interpreter presents it to the Backup Server, Volume  Server  and  VL  Server  during  mutual
           authentication. Do not combine this flag with the <b>-cell</b> argument. For more details, see <b><a href="../man8/backup.8.html">backup</a></b>(8).

       <b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;
           Names  the  cell  in which to run the command. Do not combine this argument with the <b>-localauth</b> flag.
           For more details, see <b><a href="../man8/backup.8.html">backup</a></b>(8).

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following example writes a copy of the Backup Database to the tape  device  controlled  by  the  Tape
       Coordinator with port offset 1:

          % backup savedb -portoffset 1

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       The  issuer  must  be  listed  in the <u>/etc/openafs/server/UserList</u> file on every machine where the Backup
       Server is running, or must be logged onto  a  server  machine  as  the  local  superuser  "root"  if  the
       <b>-localauth</b> flag is included.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/butc.5.html">butc</a></b>(5), <b><a href="../man8/backup.8.html">backup</a></b>(8), <b><a href="../man8/backup_dbverify.8.html">backup_dbverify</a></b>(8), <b><a href="../man8/backup_restoredb.8.html">backup_restoredb</a></b>(8), <b><a href="../man8/butc.8.html">butc</a></b>(8)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       IBM Corporation 2000. &lt;<a href="http://www.ibm.com/">http://www.ibm.com/</a>&gt; All Rights Reserved.

       This  documentation  is covered by the IBM Public License Version 1.0.  It was converted from HTML to POD
       by software written by Chas Williams and Russ Allbery, based on  work  by  Alf  Wachsmann  and  Elizabeth
       Cassell.

OpenAFS                                            2025-03-21                                   <u><a href="../man8/BACKUP_SAVEDB.8.html">BACKUP_SAVEDB</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>