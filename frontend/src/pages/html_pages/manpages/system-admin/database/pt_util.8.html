<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pt_util - Load or dump a Protection Server database</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openafs-dbserver">openafs-dbserver_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pt_util - Load or dump a Protection Server database

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pt_util</b>
          [<b>-w</b>] [<b>-user</b>] [<b>-group</b>]
          [<b>-members</b>] [<b>-name</b>] [<b>-system</b>]
          [<b>-xtra</b>] [<b>-prdb</b> &lt;<u>prdb</u> <u>file</u>&gt;]
          [<b>-datafile</b> &lt;<u>data</u> <u>file</u>&gt;] [<b>-help</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>pt_util</b> command can be used to load or dump the protection database.  It should only be used when
       <b>ptserver</b> is not running.

       The most likely reason to use it is to initialize the protection database when bringing up a new cell.
       The current syntax for this, presented below, needs improvement.  <b>pt_util</b> can also be used when problems
       are suspected with the database.  It can be used to dump the database or portions thereof, in several
       different ways, and to reload it.

       The textual representation of the database has the following form: For users,

           name flags/quota viceid ownerid creatorid

       For groups,

           name flags/quota viceid ownerid creatorid
            a-username a-user-viceid

       The second line is repeated for each member of the group.  When reading the database, membership is not
       reported unless <b>-members</b> is also included.

</pre><h4><b>OPTIONS</b></h4><pre>
       If you don't specify any options, the only thing you'll learn is the ubik database epoch and version.

       <b>-w</b>  Write  to  the  protection  database  instead  of  reading.   Only  the  file arguments make sense in
           combination with this argument.

       <b>-user</b>
           When reading, display users.

       <b>-group</b>
           When reading, display groups (but not necessarily members).

       <b>-members</b>
           When reading, display groups and also group members.

       <b>-name</b>
           When reading, follow name hashes, instead of id hashes.  This may print different information if  the
           database  was  corrupted.   Otherwise,  it  should  print  exactly  the same information, except in a
           different order.

       <b>-system</b>
           When reading, display system data, or more precisely, do not display entries with a viced  &lt;=  -32768
           or &gt;= +97537.

       <b>-xtra</b>
           When  reading,  display extra users and groups, or more precisely, do not display entries that are in
           the range -32767...+97536 inclusive.

       <b>-prdb</b> &lt;<u>prdb</u> <u>file</u>&gt;
           Specifies the complete pathname of the file in which the Protection Database  resides.   Provide  the
           complete name, including the ending <u>.DB0</u>.

       <b>-datafile</b> &lt;<u>data</u> <u>file</u>&gt;
           Specify the file to which to dump (or <b>-w</b> from which to read) textual database records.

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>CAUTIONS</b></h4><pre>
       Entry timestamps and other information is not preserved when dumping the protection database.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following example shows how to initialize the database from scratch.

       Before  you do this, make sure <b>ptserver</b> is not running.  If you have multiple database servers, make sure
       <u>prdb.*</u> does not exist on any server machine.

       Now, type this in EXACTLY, including the leading space on the line indicated.  But do  use  Control-D  at
       the end, not up-arrow D.

           pt_util -w
           admin 128/20 1 -204 -204
           system:administrators 130/20 -204 -204 -204
            admin 1
           ^D

       You will see this:

           # pt_util -w
           pt_util: /var/lib/openafs/db/prdb.DB0: Bad UBIK_MAGIC. Is 0 should be 354545
           Ubik Version is: 2.0
           admin 128/20 1 -204 -204
           system:administrators 130/20 -204 -204 -204
           Error while creating system:administrators: Entry for id already exists
            admin 1
           pt_util: Ubik Version number changed during execution.
           Old Version = 2.0, new version = 33554432.0
           #

       To make a complete copy of the database,

           # pt_util -user -members -datafile /tmp/out

       To load from the complete copy,

           # pt_util -w -datafile /tmp/out

       Don't do this until you read cautions, above.

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       The issuer must be logged in as the superuser "root" on a database server machine to use <b>pt_util</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/prdb.DB0.5.html">prdb.DB0</a></b>(5), <b><a href="../man8/ptserver.8.html">ptserver</a></b>(8)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       The following copyright covers this documentation:

       Copyright (c) 2005 The Regents of the University of Michigan.  ALL RIGHTS RESERVED.

       Permission  is  granted  to  use,  copy,  create derivative works and redistribute this software and such
       derivative works for any purpose, so long as the name of the University of Michigan is not  used  in  any
       advertising or publicity pertaining to the use or distribution of this software without specific, written
       prior  authorization.   If  the  above  copyright notice or any other identification of the University of
       Michigan is included in any copy of any portion of this software, then the disclaimer below must also  be
       included.

       This software is provided as is, without representation from the University of Michigan as to its fitness
       for  any  purpose,  and  without  warranty  by  the University of Michigan of any kind, either express or
       implied, including without limitation the  implied  warranties  of  merchantability  and  fitness  for  a
       particular  purpose.   The  regents  of  the  University of Michigan shall not be liable for any damages,
       including special, indirect, incidental, or consequential damages, with respect to any claim arising  out
       of  or  in  connection  with  the use of the software, even if it has been or is hereafter advised of the
       possibility of such damages.

OpenAFS                                            2025-03-21                                         <u><a href="../man8/PT_UTIL.8.html">PT_UTIL</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>