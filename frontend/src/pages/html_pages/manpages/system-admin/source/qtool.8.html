<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>qtool - manipulate sendmail queues</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/sendmail-base">sendmail-base_8.15.2-22ubuntu3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       qtool - manipulate sendmail queues

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>qtool.pl</b> [options] target_directory source [source ...]

       <b>qtool.pl</b> <b>[-Q][-d|-b]</b> [options] source [source ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Qtool</b>  moves  the  queue  files  used  by  sendmail between queues. It uses the same locking mechanism as
       sendmail so can be safely used while sendmail is running.  However, it should  not  be  used  when  queue
       groups have been configured to move queue files into directories to which they do not belong according to
       the  queue  group  selections  made  in  the sendmail.cf file.  Unless you are absolutely sure you do not
       interfere with the queue group selection mechanism, do not move queue files around.

       With no options, <b>qtool</b> will move any queue files as specified by <u>source</u> into <u>target_directory</u>. <u>Source</u> can
       be either an individual queue control file, a queue file id, or a queue directory.

       If the -d option is specified, qtool will delete the messages specified by source instead of moving them.

       If the -b option is specified, the selected messages  will  be  bounced  by  running  sendmail  with  the
       -OTimeout.queuereturn=now option.

   <b>Options</b>
       <b>-b</b>     Bounce  all  of  the  messages  specified  by source. The messages will be bounced immediately. No
              attempt will be made to deliver the messages.

       <b>-C</b> configfile
              Specify the sendmail config file.  Defaults to /etc/mail/sendmail.cf.

       <b>-d</b>     Delete all of the messages specified by source.

       <b>-e</b> <u>perl_expression</u>
              Evaluate <u>perl_expression</u> for each queue file as specified by <u>source</u>. If <u>perl_expression</u>  evaluates
              to true, then that queue file is moved. See below for more detail on <u>perl_expression</u>.

       <b>-Q</b>     Operate on quarantined items (queue control file begins with hf instead of qf).

       <b>-s</b> <u>seconds</u>
              Move only the queue files specified by <u>source</u> that have a modification time older than <u>seconds</u>.

   <b>Perl</b> <b>Expressions</b>
       You can use any valid perl expression. Inside the expression you have access to a hash that contains many
       of  the  fields  in  the  control  file as well as some other data about that queued message. The hash is
       called <u>%msg</u>. If a field has multiple values  (e.g.  'Recipient'),  it  will  be  returned  as  an  array,
       otherwise it will be returned as a scalar. Through <u>%msg</u>, you can access the following variables:

       <b>auth</b>   AUTH= parameter.

       <b>body_type</b>
              Body type (<b>8BITMIME</b>, <b>7BIT</b>, or undefined).

       <b>body_last_mod_time</b>
              The last time the body was modified since the epoch in seconds.

       <b>body_size</b>
              The size of the body file in bytes.

       <b>content-length</b>
              Content-Length: header value (Solaris sendmail only).

       <b>controlling_user</b>
              The controlling user.

       <b>control_last_mod_time</b>
              The last time the control file was modified since the epoch in seconds.

       <b>control_size</b>
              The size of the control file in bytes.

       <b>creation_time</b>
              The time when the control file was created.

       <b>data_file_name</b>
              The data file name (deprecated).

       <b>deliver_by</b>
              Deliver by flag and deadline for DELIVERBY ESMTP extension.

       <b>envid</b>  Original envelope id form ESMTP.

       <b>error_recipient</b>
              The error recipient (deprecated).

       <b>final_recipient</b>
              Final recipient (for DSNs).

       <b>flags</b>  Array of characters that can be the following values:
               w       warning message has been sent
               r       This is an error response or DSN
               8       has 8 bit data in body
               b       delete Bcc: headers
               d       envelope has DSN RET= parameter
               n       don't return body

       <b>headers</b>
              This  is a Perl hash where the keys are rfc822 field names and the values are rfc822 field values.
              If a field has only one value it will be returned as a string. If a field has more than one  value
              (e.g. 'Received') it will be returned as a list of strings.

       <b>inode_number</b>
              The inode number for the data (body) file.

       <b>next_delivery_time</b>
              Earliest time of next delivery attempt.

       <b>num_delivery_attempts</b>
              Number of delivery attempts that have been made.

       <b>macro</b>  Defined macro.

       <b>message</b>
              Envelope status message.

       <b>original_recipient</b>
              Original recipient (ORCPT= parameter).

       <b>priority</b>
              Adjusted priority of message.

       <b>quarantine_reason</b>
              Quarantine reason for quarantined (held) envelopes.

       <b>recipient</b>
              Array of character flags followed by colon and recipient name. Flags:
               N       Has NOTIFY= parameter.
               S       Success DSN requested.
               F       Failure DSN requested.
               D       Delay DSN requested.
               P       Primary address (not the result of alias/forward expansion).

       <b>sender</b> Sender

       <b>version</b>
              Version of control file.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>qtool.pl</b> <b>q2</b> <b>q1</b>
              Moves all of the queue files in queue q1 to queue q2.

       <b>qtool.pl</b> <b>q2</b> <b>q1/d6CLQh100847</b>
              Moves the message with id d6CLQh100847 in queue q1 to queue q2.

       <b>qtool.pl</b> <b>q2</b> <b>q1/qfd6CLQh100847</b>
              Moves the message with id d6CLQh100847 in queue q1 to queue q2.

       <b>qtool.pl</b> <b>-e</b> <b>'$msg{num_delivery_attempts}</b> <b>==</b> <b>3'</b> <b>/q2</b> <b>/q1</b>
              Moves all of the queue files that have had three attempted deliveries from queue q1 to queue q2.

</pre><h4><b>BUGS</b></h4><pre>
       In  sendmail  8.12,  it  is  possible for a message's queue and data files (df) to be stored in different
       queues.  In this situation, you must give qtool the pathname of the queue file,  not  of  the  data  file
       (df).  To be safe, never feed qtool the pathname of a data file (df).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/sendmail.8.html">sendmail</a>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>qtool</b> command appeared in sendmail 8.10.

                                          $Date: 2013-11-22 20:51:18 $                                  <u><a href="../man8/QTOOL.8.html">QTOOL</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>