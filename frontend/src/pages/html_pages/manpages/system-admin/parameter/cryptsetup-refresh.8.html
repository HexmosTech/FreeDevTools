<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cryptsetup-refresh - refresh parameters of an active mapping</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/cryptsetup-bin">cryptsetup-bin_2.8.0-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cryptsetup-refresh - refresh parameters of an active mapping

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>cryptsetup</b> <u>refresh</u> <b>[&lt;options&gt;]</b> <b>&lt;name&gt;</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Refreshes parameters of active mapping &lt;name&gt;.

       Updates parameters of active device &lt;name&gt; without the need to deactivate the device (and umount
       filesystem). Currently, it supports parameters refresh on following devices: LUKS1, LUKS2 (including
       authenticated encryption), plain crypt and loop-AES.

       Mandatory parameters are identical to those of an open action for the respective device type.

       You may change following parameters on all devices --perf-same_cpu_crypt, --perf-submit_from_crypt_cpus,
       --perf-no_read_workqueue, --perf-no_write_workqueue and --allow-discards.

       Refreshing the device without any optional parameter will refresh the device with default setting
       (respective to device type).

       <b>LUKS2</b> <b>only:</b>

       The --integrity-no-journal parameter affects only LUKS2 devices with the underlying dm-integrity device.

       Adding option --persistent stores any combination of device parameters above in LUKS2 metadata (only
       after successful refresh operation).

       The --disable-keyring parameter refreshes a device with volume key passed in dm-crypt driver.

       <b>&lt;options&gt;</b> can be [--allow-discards, --perf-same_cpu_crypt, --perf-submit_from_crypt_cpus,
       --perf-no_read_workqueue, --perf-no_write_workqueue, --header, --disable-keyring, --disable-locks,
       --persistent, --integrity-no-journal].

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--allow-discards</b>
           Allow the use of discard (TRIM) requests for the device. This is also not supported for LUKS2 devices
           with data integrity protection.

           <b>WARNING:</b> This command can have a negative security impact because it can make filesystem-level
           operations visible on the physical device. For example, information leaking filesystem type, used
           space, etc. may be extractable from the physical device if the discarded blocks can be located later.
           If in doubt, do not use it.

           A kernel version of 3.1 or later is needed. For earlier kernels, this option is ignored.

       <b>--batch-mode,</b> <b>-q</b>
           Suppresses all confirmation questions. Use with care!

           If the --verify-passphrase option is not specified, this option also switches off the passphrase
           verification.

       <b>--debug</b> <b>or</b> <b>--debug-json</b>
           Run in debug mode with full diagnostic logs. Debug output lines are always prefixed by <b>#</b>.

           If --debug-json is used, additional LUKS2 JSON data structures are printed.

       <b>--disable-keyring</b>
           Do not load volume key in kernel keyring and store it directly in the dm-crypt target instead. This
           option is supported only for the LUKS2 type.

       <b>--disable-locks</b>
           Disable lock protection for metadata on disk. This option is valid only for LUKS2 and ignored for
           other formats.

           <b>WARNING:</b> Do not use this option unless you run cryptsetup in a restricted environment where locking
           is impossible to perform (where <a href="file:/run">/run</a> directory cannot be used).

       <b>--header</b> <b>&lt;device</b> <b>or</b> <b>file</b> <b>storing</b> <b>the</b> <b>LUKS</b> <b>header&gt;</b>
           Use a detached (separated) metadata device or file where the LUKS header is stored. This option
           allows one to store ciphertext and LUKS header on different devices.

           For commands that change the LUKS header (e.g. <u>luksAddKey</u>), specify the device or file with the LUKS
           header directly as the LUKS device.

       <b>--help,</b> <b>-?</b>
           Show help text and default parameters.

       <b>--integrity-no-journal</b>
           Activate device with integrity protection without using data journal (direct write of data and
           integrity tags). Note that without journal power fail can cause non-atomic write and data corruption.
           Use only if journalling is performed on a different storage layer.

       <b>--perf-high_priority</b>
           Set dm-crypt workqueues and the writer thread to high priority. This i mproves throughput and latency
           of dm-crypt while degrading general responsiveness of the system.

           <b>NOTE:</b> This option is available only for low-level dm-crypt performance tuning, use only if you need a
           change to default dm-crypt behaviour. Needs kernel 6.10 or later.

       <b>--perf-no_read_workqueue,</b> <b>--perf-no_write_workqueue</b>
           Bypass dm-crypt internal workqueue and process read or write requests synchronously.

           <b>NOTE:</b> These options are available only for low-level dm-crypt performance tuning, use only if you
           need a change to default dm-crypt behaviour. Needs kernel 5.9 or later.

       <b>--perf-same_cpu_crypt</b>
           Perform encryption using the same cpu that IO was submitted on. The default is to use an unbound
           workqueue so that encryption work is automatically balanced between available CPUs.

           <b>NOTE:</b> This option is available only for low-level dm-crypt performance tuning, use only if you need a
           change to default dm-crypt behaviour. Needs kernel 4.0 or later.

       <b>--perf-submit_from_crypt_cpus</b>
           Disable offloading writes to a separate thread after encryption. There are some situations where
           offloading write bios from the encryption threads to a single thread degrades performance
           significantly. The default is to offload write bios to the same thread.

           <b>NOTE:</b> This option is available only for low-level dm-crypt performance tuning, use only if you need a
           change to default dm-crypt behaviour. Needs kernel 4.0 or later.

       <b>--persistent</b>
           If used with LUKS2 devices and activation commands like <u>open</u> or <u>refresh</u>, the specified activation
           flags are persistently written into metadata and used next time automatically even for normal
           activation. (No need to use cryptab or other system configuration files.)

           If you need to remove a persistent flag, use <u>--persistent</u> without the flag you want to remove (e.g.
           to disable persistently stored discard flag, use <u>--persistent</u> without <u>--allow-discards</u>).

           Only <u>--allow-discards</u>, <u>--perf-same_cpu_crypt</u>, <u>--perf-submit_from_crypt_cpus</u>,
           <u>--perf-no_read_workqueue</u>, <u>--perf-no_write_workqueue</u> and <u>--integrity-no-journal</u> can be stored
           persistently.

       <b>--usage</b>
           Show short option help.

       <b>--version,</b> <b>-V</b>
           Show the program version.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs at <b>cryptsetup</b> <b>mailing</b> <b>list</b> &lt;<a href="mailto:cryptsetup@lists.linux.dev">cryptsetup@lists.linux.dev</a>&gt; or in <b>Issues</b> <b>project</b> <b>section</b>
       &lt;https://gitlab.com/cryptsetup/cryptsetup/-/issues/new&gt;.

       Please attach output of the failed command with --debug option added.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>Cryptsetup</b> <b>FAQ</b> &lt;https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions&gt;

       <b><a href="../man8/cryptsetup.8.html">cryptsetup</a></b>(8), <b><a href="../man8/integritysetup.8.html">integritysetup</a></b>(8) and <b><a href="../man8/veritysetup.8.html">veritysetup</a></b>(8)

</pre><h4><b>CRYPTSETUP</b></h4><pre>
       Part of <b>cryptsetup</b> <b>project</b> &lt;https://gitlab.com/cryptsetup/cryptsetup/&gt;.

cryptsetup 2.8.0                                   2025-07-25                              <u><a href="../man8/CRYPTSETUP-REFRESH.8.html">CRYPTSETUP-REFRESH</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>