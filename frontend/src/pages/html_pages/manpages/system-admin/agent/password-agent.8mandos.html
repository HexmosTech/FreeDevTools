<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>password-agent - Run Mandos client as a systemd password agent.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/mandos-client">mandos-client_1.8.19-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       password-agent - Run Mandos client as a systemd password agent.

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>password-agent</b> [<b>--agent-directory=</b><u>DIRECTORY</u>]
                      [<b>--helper-directory=</b><u>DIRECTORY</u>]
                      [<b>--user=</b><u>USERID</u>]
                      [<b>--group=</b><u>GROUPID</u>]
                      [--] [<u>MANDOS_CLIENT</u> [<u>OPTIONS</u>...]]

       <b>password-agent</b> <b>--test</b>

       <b>password-agent</b> {<b>--help</b> | <b>-?</b>}

       <b>password-agent</b> <b>--usage</b>

       <b>password-agent</b> {<b>--version</b> | <b>-V</b>}

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>password-agent</b> is a program which is meant to be a <b><a href="../man1/systemd.1.html">systemd</a></b>(1) “Password Agent” (See <b>Password</b> <b>Agents</b>[1]).
       The aim of this program is therefore to acquire and then send a password to some other program which will
       use the password to unlock the encrypted root disk.

       This program is not meant to be invoked directly, but can be in order to test it.

</pre><h4><b>PURPOSE</b></h4><pre>
       The purpose of this is to enable <u>remote</u> <u>and</u> <u>unattended</u> <u>rebooting</u> of client host computer with an
       <u>encrypted</u> <u>root</u> <u>file</u> <u>system</u>. See the section called “OVERVIEW” for details.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--agent-directory</b> <u>DIRECTORY</u>
           Specify a different agent directory. The default is “<a href="file:/run/systemd/ask-password">/run/systemd/ask-password</a>” as per the <b>Password</b>
           <b>Agents</b>[1] specification.

       <b>--helper-directory</b> <u>DIRECTORY</u>
           Specify a different helper directory. The default is “/lib/mandos/plugin-helpers”, which will exist
           in the initial RAM disk environment. (This will simply be passed to the <u>MANDOS_CLIENT</u> program via the
           <b>MANDOSPLUGINHELPERDIR</b> environment variable. See <b><a href="../man8mandos/mandos-client.8mandos.html">mandos-client</a></b>(8mandos).)

       <b>--user</b> <u>USERID</u>
           Change real user ID to <u>USERID</u> when running <u>MANDOS_CLIENT</u>. The default is 65534.  <u>Note:</u> This must be a
           number, not a name.

       <b>--group</b> <u>GROUPID</u>
           Change real group ID to <u>GROUPID</u> when running <u>MANDOS_CLIENT</u>. The default is 65534.  <u>Note:</u> This must be
           a number, not a name.

       <u>MANDOS_CLIENT</u>
           This specifies the file name for <b><a href="../man8mandos/mandos-client.8mandos.html">mandos-client</a></b>(8mandos). If the “<b>--</b>” option is given, any following
           options are passed to the <u>MANDOS_CLIENT</u> program. The default is “/lib/mandos/plugins.d/mandos-client”
           (which is the correct location for the initial RAM disk environment) without any options.

       <b>--help</b>, <b>-?</b>
           Gives a help message about options and their meanings.

       <b>--test</b>
           Ignore normal operation; instead only run self-tests. Adding the <b>--help</b> option may show more options
           possible in combination with <b>--test</b>.

       <b>--usage</b>
           Gives a short usage message.

       <b>--version</b>, <b>-V</b>
           Prints the program version.

</pre><h4><b>OVERVIEW</b></h4><pre>
       This is part of the Mandos system for allowing computers to have encrypted root file systems and at the
       same time be capable of remote and/or unattended reboots. The computers run a small client program in the
       initial RAM disk environment which will communicate with a server over a network. All network
       communication is encrypted using TLS. The clients are identified by the server using a TLS key; each
       client has one unique to it. The server sends the clients an encrypted password. The encrypted password
       is decrypted by the clients using a separate OpenPGP key, and the password is then used to unlock the
       root file system, whereupon the computers can continue booting normally.

       This program, password-agent, will run on the client side in the initial RAM disk environment, and is
       responsible for getting a password from the Mandos client program itself, and to send that password to
       whatever is currently asking for a password using the systemd <b>Password</b> <b>Agents</b>[1] mechanism.

       To accomplish this, password-agent runs the <b>mandos-client</b> program (which is the actual client program
       communicating with the Mandos server) or, alternatively, any executable file specified as <u>MANDOS_CLIENT</u>,
       and, as soon as a password is acquired from the <u>MANDOS_CLIENT</u> program, sends that password (as per the
       <b>Password</b> <b>Agents</b>[1] specification) to all currently unanswered password questions.

       This program should be started (normally as a systemd service, which in turn is normally started by a
       <b><a href="../man5/systemd.path.5.html">systemd.path</a></b>(5) file) as a reaction to files named “ask.<u>xxxx</u>” appearing in the agent directory
       “<a href="file:/run/systemd/ask-password">/run/systemd/ask-password</a>” (or the directory specified by <b>--agent-directory</b>).

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       Exit status of this program is zero if no errors were encountered, and otherwise not.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       This program does not use any environment variables itself, it only passes on its environment to
       <u>MANDOS_CLIENT</u>. Also, the <b>--helper-directory</b> option will affect the environment variable
       <b>MANDOSPLUGINHELPERDIR</b> for <u>MANDOS_CLIENT</u>.

</pre><h4><b>FILES</b></h4><pre>
       <a href="file:/run/systemd/ask-password">/run/systemd/ask-password</a>
           The default directory to watch for password questions as per the <b>Password</b> <b>Agents</b>[1] specification;
           can be changed by the <b>--agent-directory</b> option.

       /lib/mandos/plugin-helpers
           The helper directory as supplied to <u>MANDOS_CLIENT</u> via the <b>MANDOSPLUGINHELPERDIR</b> environment variable;
           can be changed by the <b>--helper-directory</b> option.

</pre><h4><b>BUGS</b></h4><pre>
       Please report bugs to the Mandos development mailing list: &lt;<a href="mailto:mandos-dev@recompile.se">mandos-dev@recompile.se</a>&gt; (subscription
       required). Note that this list is public. The developers can be reached privately at
       &lt;<a href="mailto:mandos@recompile.se">mandos@recompile.se</a>&gt; (OpenPGP key fingerprint 153A 37F1 0BBA 0435 987F 2C4A 7223 2973 CA34 C2C4 for
       encrypted mail).

</pre><h4><b>EXAMPLE</b></h4><pre>
       Normal invocation needs no options:

       <b>password-agent</b>

       Run an alternative <u>MANDOS_CLIENT</u> program::

       <b>password-agent</b> <b>/usr/local/sbin/alternate</b>

       Use alternative locations for the helper directory and the Mandos client, and add extra options suitable
       for running in the normal file system:

       <b>password-agent</b> <b>--helper-directory=/usr/lib/x86_64-linux-gnu/mandos/plugin-helpers</b> <b>--</b>
       <b>/usr/lib/x86_64-linux-gnu/mandos/plugins.d/mandos-client</b> <b>--pubkey=/etc/keys/mandos/pubkey.txt</b>
       <b>--seckey=/etc/keys/mandos/seckey.txt</b> <b>--tls-pubkey=/etc/keys/mandos/tls-pubkey.pem</b>
       <b>--tls-privkey=/etc/keys/mandos/tls-privkey.pem</b>

       Use the default location for <b><a href="../man8mandos/mandos-client.8mandos.html">mandos-client</a></b>(8mandos), but add many options to it:

       <b>password-agent</b> <b>--</b> <b>/lib/mandos/plugins.d/mandos-client</b> <b>--pubkey=/etc/mandos/keys/pubkey.txt</b>
       <b>--seckey=/etc/mandos/keys/seckey.txt</b> <b>--tls-pubkey=/etc/mandos/keys/tls-pubkey.pem</b>
       <b>--tls-privkey=/etc/mandos/keys/tls-privkey.pem</b>

       Only run the self-tests:

       <b>password-agent</b> <b>--test</b>

</pre><h4><b>SECURITY</b></h4><pre>
       This program will need to run as the root user in order to read the agent directory and the “ask.<u>xxxx</u>”
       files there, and will, when starting the Mandos client program, require the ability to set the “real”
       user and group ids to another user, by default user and group 65534, which are assumed to be
       non-privileged. This is done in order to match the expectations of <b><a href="../man8mandos/mandos-client.8mandos.html">mandos-client</a></b>(8mandos), which assumes
       that its executable file is owned by the root user and also has the set-user-ID bit set (see <b><a href="../man2/execve.2.html">execve</a></b>(2)).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8mandos/intro.8mandos.html">intro</a></b>(8mandos), <b><a href="../man8mandos/mandos-client.8mandos.html">mandos-client</a></b>(8mandos), <b><a href="../man1/systemd.1.html">systemd</a></b>(1),

       <b>Password</b> <b>Agents</b>[1]
           The specification for systemd “Password Agent” programs, which <b>password-agent</b> follows.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright © 2019-2020 Teddy Hogeborn, Björn Påhlsson

       This manual page is part of Mandos.

       Mandos is free software: you can redistribute it and/or modify it under the terms of the GNU General
       Public License as published by the Free Software Foundation, either version 3 of the License, or (at your
       option) any later version.

       Mandos is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the
       implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with Mandos. If not, see
       <b><a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a></b>.

</pre><h4><b>NOTES</b></h4><pre>
        1. Password Agents
           https://systemd.io/PASSWORD_AGENTS/

Mandos 1.8.19                                      2020-09-16                            <u><a href="../man8mandos/PASSWORD-AGENT.8mandos.html">PASSWORD-AGENT</a></u>(8mandos)
</pre>
 </div>
</div></section>
</div>
</body>
</html>