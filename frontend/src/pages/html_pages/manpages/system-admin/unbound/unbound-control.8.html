<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>unbound-control, unbound-control-setup - Unbound remote server control utility.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/unbound">unbound_1.22.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>unbound-control,</b> <b>unbound-control-setup</b> - Unbound remote server control utility.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>unbound-control</b> [<b>-hq</b>] [<b>-c</b> <u>cfgfile</u>] [<b>-s</b> <u>server</u>] <u>command</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Unbound-control</b>  performs remote administration on the <u><a href="../man8/unbound.8.html">unbound</a></u>(8) DNS server.  It reads the configuration
       file, contacts the Unbound server over SSL sends the command and displays the result.

       The available options are:

       <b>-h</b>     Show the version and commandline option help.

       <b>-c</b> <u>cfgfile</u>
              The  config  file  to  read   with   settings.    If   not   given   the   default   config   file
              /etc/unbound/unbound.conf is used.

       <b>-s</b> <u>server[@port]</u>
              IPv4  or IPv6 address of the server to contact.  If not given, the address is read from the config
              file.

       <b>-q</b>     quiet, if the option is given it does not print anything if it works ok.

</pre><h4><b>COMMANDS</b></h4><pre>
       There are several commands that the server understands.

       <b>start</b>  Start the server. Simply execs <u><a href="../man8/unbound.8.html">unbound</a></u>(8).  The Unbound executable is searched for in the <b>PATH</b> set
              in the environment.  It is started with the config file specified using <u>-c</u> or the  default  config
              file.

       <b>stop</b>   Stop the server. The server daemon exits.

       <b>reload</b> Reload the server. This flushes the cache and reads the config file fresh.

       <b>reload_keep_cache</b>
              Reload  the server but try to keep the RRset and message cache if (re)configuration allows for it.
              That means the caches sizes and the number of threads must not change between reloads.

       <b>verbosity</b> <u>number</u>
              Change verbosity value for logging. Same values as <b>verbosity</b> keyword in <u><a href="../man5/unbound.conf.5.html">unbound.conf</a></u>(5).  This new
              setting lasts until the server is issued a reload (taken from config  file  again),  or  the  next
              verbosity control command.

       <b>log_reopen</b>
              Reopen the logfile, close and open it.  Useful for logrotation to make the daemon release the file
              it is logging to.  If you are using syslog it will attempt to close and open the syslog (which may
              not work if chrooted).

       <b>stats</b>  Print  statistics.  Resets  the  internal  counters  to  zero,  this  can  be controlled using the
              <b>statistics-cumulative</b> config statement.  Statistics are printed with one [name]: [value] per line.

       <b>stats_noreset</b>
              Peek at statistics. Prints them like the <b>stats</b> command does,  but  does  not  reset  the  internal
              counters to zero.

       <b>status</b> Display  server  status.  Exit code 3 if not running (the connection to the port is refused), 1 on
              error, 0 if running.

       <b>local_zone</b> <u>name</u> <u>type</u>
              Add new local zone with name and type. Like <b>local-zone</b> config  statement.   If  the  zone  already
              exists, the type is changed to the given argument.

       <b>local_zone_remove</b> <u>name</u>
              Remove  the  local  zone with the given name.  Removes all local data inside it.  If the zone does
              not exist, the command succeeds.

       <b>local_data</b> <u>RR</u> <u>data...</u>
              Add new local data, the given resource record. Like <b>local-data</b> config statement, except  for  when
              no covering zone exists.  In that case this remote control command creates a transparent zone with
              the same name as this record.

       <b>local_data_remove</b> <u>name</u>
              Remove  all  RR  data  from local name.  If the name already has no items, nothing happens.  Often
              results in NXDOMAIN for the name (in a  static  zone),  but  if  the  name  has  become  an  empty
              nonterminal  (there  is still data in domain names below the removed name), NOERROR nodata answers
              are the result for that name.

       <b>local_zones</b>
              Add local zones read from stdin of unbound-control. Input is read per line, with name  space  type
              on a line. For bulk additions.

       <b>local_zones_remove</b>
              Remove  local  zones  read  from  stdin  of  unbound-control. Input is one name per line. For bulk
              removals.

       <b>local_datas</b>
              Add local data RRs read from stdin of  unbound-control.  Input  is  one  RR  per  line.  For  bulk
              additions.

       <b>local_datas_remove</b>
              Remove  local  data  RRs  read from stdin of unbound-control. Input is one name per line. For bulk
              removals.

       <b>dump_cache</b>
              The content of the cache is printed in a text format to stdout.  You can redirect it to a file  to
              store the cache in a file.  Not supported in remote Unbounds in multi-process operation.

       <b>load_cache</b>
              The  content of the cache is loaded from stdin.  Uses the same format as dump_cache uses.  Loading
              the cache with old, or wrong data can result in old or wrong data returned  to  clients.   Loading
              data  into  the  cache  in this way is supported in order to aid with debugging.  Not supported in
              remote Unbounds in multi-process operation.

       <b>lookup</b> <u>name</u>
              Print to stdout the name servers that would be used to look up the name specified.

       <b>flush</b> [<u>+c</u>] <u>name</u>
              Remove the name from the cache. Removes the types A, AAAA, NS, SOA, CNAME, DNAME,  MX,  PTR,  SRV,
              NAPTR,  SVCB  and  HTTPS.   Because  that  is  fast to do. Other record types can be removed using
              <b>flush_type</b> or <b>flush_zone</b>.

              The '+c' option removes the items also from the cachedb cache. If cachedb is in use.

       <b>flush_type</b> [<u>+c</u>] <u>name</u> <u>type</u>
              Remove the name, type information from the cache.

       <b>flush_zone</b> [<u>+c</u>] <u>name</u>
              Remove all information at or below the name from the  cache.   The  rrsets  and  key  entries  are
              removed  so  that new lookups will be performed.  This needs to walk and inspect the entire cache,
              and is a slow operation.  The entries are set to expired in the  implementation  of  this  command
              (so,  with  serve-expired  enabled,  it'll  serve that information but schedule a prefetch for new
              information).

       <b>flush_bogus</b> [<u>+c</u>]
              Remove all bogus data from the cache.

       <b>flush_negative</b> [<u>+c</u>]
              Remove all negative data from the cache.  This is nxdomain answers, nodata  answers  and  servfail
              answers.   Also removes bad key entries (which could be due to failed lookups) from the dnssec key
              cache, and iterator last-resort lookup failures from the rrset cache.

       <b>flush_stats</b>
              Reset statistics to zero.

       <b>flush_requestlist</b>
              Drop the queries that are worked on.  Stops working on the queries that the server is  working  on
              now.   The  cache  is unaffected.  No reply is sent for those queries, probably making those users
              request again later.  Useful to make the server restart working on queries with new settings, such
              as a higher verbosity level.

       <b>dump_requestlist</b>
              Show what is worked on.  Prints all queries that the server is currently working on.   Prints  the
              time  that  users  have been waiting.  For internal requests, no time is printed.  And then prints
              out the module status.  This prints the queries from the first thread, and not  queries  that  are
              being serviced from other threads.

       <b>flush_infra</b> <u>all|IP</u>
              If  all  then entire infra cache is emptied.  If a specific IP address, the entry for that address
              is removed from the cache.  It contains EDNS, ping and lameness data.

       <b>dump_infra</b>
              Show the contents of the infra cache.

       <b>set_option</b> <u>opt:</u> <u>val</u>
              Set the option to the given value without a reload.  The cache  is  therefore  not  flushed.   The
              option  must  end with a ':' and whitespace must be between the option and the value.  Some values
              may not have an effect if set this way, the new values are not written to the config file, not all
              options are supported.  This is different from the set_option call in libunbound, where all values
              work because Unbound has not been initialized.

              The values that  work  are:  statistics-interval,  statistics-cumulative,  do-not-query-localhost,
              harden-short-bufsize,       harden-large-queries,       harden-glue,       harden-dnssec-stripped,
              harden-below-nxdomain, harden-referral-path, prefetch, prefetch-key,  log-queries,  hide-identity,
              hide-version,  identity,  version,  val-log-level,  val-log-squelch, ignore-cd-flag, add-holddown,
              del-holddown, keep-missing, tcp-upstream,  ssl-upstream,  max-udp-size,  ratelimit,  ip-ratelimit,
              cache-max-ttl, cache-min-ttl, cache-max-negative-ttl.

       <b>get_option</b> <u>opt</u>
              Get  the value of the option.  Give the option name without a trailing ':'.  The value is printed.
              If the value is "", nothing is printed and the connection closes.  On error 'error ...' is printed
              (it gives a syntax error on unknown option).  For some options a list of values, one on each line,
              is printed.  The options are shown from the config file as modified  with  set_option.   For  some
              options  an override may have been taken that does not show up with this command, not results from
              e.g. the  verbosity  and  forward  control  commands.   Not  all  options  work,  see  list_stubs,
              list_forwards, list_local_zones and list_local_data for those.

       <b>list_stubs</b>
              List  the  stub zones in use.  These are printed one by one to the output.  This includes the root
              hints in use.

       <b>list_forwards</b>
              List the forward zones in use.  These are printed zone by zone to the output.

       <b>list_insecure</b>
              List the zones with domain-insecure.

       <b>list_local_zones</b>
              List the local zones in use.  These are printed one per line with zone type.

       <b>list_local_data</b>
              List the local data RRs in use.  The resource records are printed.

       <b>insecure_add</b> <u>zone</u>
              Add a <b>domain-insecure</b> for the given zone, like the statement in unbound.conf.  Adds to the running
              Unbound without affecting the cache contents (which may still be bogus, use <b>flush_zone</b>  to  remove
              it), does not affect the config file.

       <b>insecure_remove</b> <u>zone</u>
              Removes domain-insecure for the given zone.

       <b>forward_add</b> [<u>+it</u>] <u>zone</u> <u>addr</u> <u>...</u>
              Add  a  new  forward  zone to running Unbound.  With +i option also adds a <u>domain-insecure</u> for the
              zone (so it can resolve insecurely if you have a DNSSEC root trust  anchor  configured  for  other
              names).   The  addr can be IP4, IP6 or nameserver names, like <u>forward-zone</u> config in unbound.conf.
              The +t option sets it to use tls upstream, like <u>forward-tls-upstream</u>: yes.

       <b>forward_remove</b> [<u>+i</u>] <u>zone</u>
              Remove a forward zone from running Unbound.  The +i also removes a <u>domain-insecure</u> for the zone.

       <b>stub_add</b> [<u>+ipt</u>] <u>zone</u> <u>addr</u> <u>...</u>
              Add a new stub zone to running Unbound.  With +i option also adds a <u>domain-insecure</u> for the  zone.
              With +p the stub zone is set to prime, without it it is set to notprime.  The addr can be IP4, IP6
              or  nameserver names, like the <u>stub-zone</u> config in unbound.conf.  The +t option sets it to use tls
              upstream, like <u>stub-tls-upstream</u>: yes.

       <b>stub_remove</b> [<u>+i</u>] <u>zone</u>
              Remove a stub zone from running Unbound.  The +i also removes a <u>domain-insecure</u> for the zone.

       <b>forward</b> [<u>off</u> | <u>addr</u> <u>...</u> ]
              Setup forwarding mode.  Configures if the server should ask other upstream nameservers, should  go
              to  the  internet  root  nameservers  itself,  or  show  the  current  config.  You could pass the
              nameservers after a DHCP update.

              Without arguments the current list of addresses used to forward all queries  to  is  printed.   On
              startup  this  is  from  the  forward-zone "." configuration.  Afterwards it shows the status.  It
              prints off when no forwarding is used.

              If <u>off</u> is passed, forwarding is disabled and the root nameservers are used.  This can be  used  to
              avoid to avoid buggy or non-DNSSEC supporting nameservers returned from DHCP.  But may not work in
              hotels or hotspots.

              If  one  or more IPv4 or IPv6 addresses are given, those are then used to forward queries to.  The
              addresses must be separated with spaces.  With '@port' the  port  number  can  be  set  explicitly
              (default port is 53 (DNS)).

              By  default  the  forwarder information from the config file for the root "." is used.  The config
              file is not changed, so after a reload these changes are  gone.   Other  forward  zones  from  the
              config file are not affected by this command.

       <b>ratelimit_list</b> [<u>+a</u>]
              List  the  domains  that are ratelimited.  Printed one per line with current estimated qps and qps
              limit from config.  With +a it prints all domains, not just the ratelimited  domains,  with  their
              estimated  qps.   The  ratelimited  domains return an error for uncached (new) queries, but cached
              queries work as normal.

       <b>ip_ratelimit_list</b> [<u>+a</u>]
              List the ip addresses that are ratelimited.  Printed one per line with current estimated  qps  and
              qps  limit  from  config.   With  +a  it  prints all ips, not just the ratelimited ips, with their
              estimated qps.  The ratelimited ips are dropped before checking the cache.

       <b>list_auth_zones</b>
              List the auth zones that are configured.  Printed one per line with a status,  indicating  if  the
              zone is expired and current serial number.  Configured RPZ zones are included.

       <b>auth_zone_reload</b> <u>zone</u>
              Reload the auth zone (or RPZ zone) from zonefile.  The zonefile is read in overwriting the current
              contents  of  the  zone  in  memory.   This  changes  the auth zone contents itself, not the cache
              contents.  Such cache contents exists if you set Unbound to validate  with  for-upstream  yes  and
              that can be cleared with <b>flush_zone</b> <u>zone</u>.

       <b>auth_zone_transfer</b> <u>zone</u>
              Transfer  the auth zone (or RPZ zone) from master.  The auth zone probe sequence is started, where
              the masters are probed to see if they have an updated zone (with the SOA serial check).  And  then
              the zone is transferred for a newer zone version.

       <b>rpz_enable</b> <u>zone</u>
              Enable the RPZ zone if it had previously been disabled.

       <b>rpz_disable</b> <u>zone</u>
              Disable the RPZ zone.

       <b>view_list_local_zones</b> <u>view</u>
              <u>list_local_zones</u> for given view.

       <b>view_local_zone</b> <u>view</u> <u>name</u> <u>type</u>
              <u>local_zone</u> for given view.

       <b>view_local_zone_remove</b> <u>view</u> <u>name</u>
              <u>local_zone_remove</u> for given view.

       <b>view_list_local_data</b> <u>view</u>
              <u>list_local_data</u> for given view.

       <b>view_local_data</b> <u>view</u> <u>RR</u> <u>data...</u>
              <u>local_data</u> for given view.

       <b>view_local_data_remove</b> <u>view</u> <u>name</u>
              <u>local_data_remove</u> for given view.

       <b>view_local_datas_remove</b> <u>view</u>
              Remove a list of <u>local_data</u> for given view from stdin. Like local_datas_remove.

       <b>view_local_datas</b> <u>view</u>
              Add a list of <u>local_data</u> for given view from stdin.  Like local_datas.

       <b>add_cookie_secret</b> <b>&lt;secret&gt;</b>
              Add or replace a cookie secret persistently. &lt;secret&gt; needs to be an 128 bit hex string.

              Cookie  secrets  can  be  either  <u>active</u>  or <u>staging</u>. <u>Active</u> cookie secrets are used to create DNS
              Cookies, but verification of a DNS Cookie succeeds with  any  of  the  <u>active</u>  or  <u>staging</u>  cookie
              secrets.  The  state  of  the  current cookie secrets can be printed with the <b>print_cookie_secrets</b>
              command.

              When there are no cookie secrets configured yet, the &lt;secret&gt; is added  as  <u>active</u>.  If  there  is
              already an <u>active</u> cookie secret, the &lt;secret&gt; is added as <u>staging</u> or replacing an existing <u>staging</u>
              secret.

              To "roll" a cookie secret used in an anycast set. The new secret has to be added as staging secret
              to  <b>all</b>  nodes  in the anycast set. When <b>all</b> nodes can verify DNS Cookies with the new secret, the
              new secret can be activated with the <b>activate_cookie_secret</b> command. After <b>all</b> nodes have the  new
              secret   <u>active</u>   for   at   least  one  hour,  the  previous  secret  can  be  dropped  with  the
              <b>drop_cookie_secret</b> command.

              Persistence is accomplished by writing to a file which if configured with  the  <b>cookie-secret-file</b>
              option in the server section of the config file.  This is disabled by default, "".

       <b>drop_cookie_secret</b>
              Drop the <u>staging</u> cookie secret.

       <b>activate_cookie_secret</b>
              Make the current <u>staging</u> cookie secret <u>active</u>, and the current <u>active</u> cookie secret <u>staging</u>.

       <b>print_cookie_secrets</b>
              Show the current configured cookie secrets with their status.

</pre><h4><b>EXIT</b> <b>CODE</b></h4><pre>
       The unbound-control program exits with status code 1 on error, 0 on success.

</pre><h4><b>SET</b> <b>UP</b></h4><pre>
       The setup requires a self-signed certificate and private keys for both the server and client.  The script
       <u>unbound-control-setup</u>  generates these in the default run directory, or with -d in another directory.  If
       you change the access control permissions on the key files you can decide who can use unbound-control, by
       default owner and group but not all users.  Run the script under the same username as you have configured
       in unbound.conf or as root, so that the daemon is permitted to read the files, for example with:
           sudo -u unbound unbound-control-setup
       If you have not configured a username in unbound.conf,  the  keys  need  read  permission  for  the  user
       credentials  under  which  the  daemon  is  started.   The  script  preserves private keys present in the
       directory.  After running the script as root, turn on <b>control-enable</b> in <u>unbound.conf</u>.

</pre><h4><b>STATISTIC</b> <b>COUNTERS</b></h4><pre>
       The <u>stats</u> command shows a number of statistic counters.

       <u>threadX.num.queries</u>
              number of queries received by thread

       <u>threadX.num.queries_ip_ratelimited</u>
              number of queries rate limited by thread

       <u>threadX.num.queries_cookie_valid</u>
              number of queries with a valid DNS Cookie by thread

       <u>threadX.num.queries_cookie_client</u>
              number of queries with a client part only DNS Cookie by thread

       <u>threadX.num.queries_cookie_invalid</u>
              number of queries with an invalid DNS Cookie by thread

       <u>threadX.num.cachehits</u>
              number of queries that were successfully answered using a cache lookup

       <u>threadX.num.cachemiss</u>
              number of queries that needed recursive processing

       <u>threadX.num.dnscrypt.crypted</u>
              number of queries that were encrypted and successfully decapsulated by dnscrypt.

       <u>threadX.num.dnscrypt.cert</u>
              number of queries that were requesting dnscrypt certificates.

       <u>threadX.num.dnscrypt.cleartext</u>
              number of  queries  received  on  dnscrypt  port  that  were  cleartext  and  not  a  request  for
              certificates.

       <u>threadX.num.dnscrypt.malformed</u>
              number of request that were neither cleartext, not valid dnscrypt messages.

       <u>threadX.num.prefetch</u>
              number of cache prefetches performed.  This number is included in cachehits, as the original query
              had the unprefetched answer from cache, and resulted in recursive processing, taking a slot in the
              requestlist.  Not part of the recursivereplies (or the histogram thereof) or cachemiss, as a cache
              response was sent.

       <u>threadX.num.expired</u>
              number of replies that served an expired cache entry.

       <u>threadX.num.queries_timed_out</u>
              number of queries that are dropped because they waited in the UDP socket buffer for too long.

       <u>threadX.query.queue_time_us.max</u>
              The  maximum  wait  time  for packets in the socket buffer, in microseconds. This is only reported
              when sock-queue-timeout is enabled.

       <u>threadX.num.recursivereplies</u>
              The number of replies sent to queries that needed recursive  processing.  Could  be  smaller  than
              threadX.num.cachemiss if due to timeouts no replies were sent for some queries.

       <u>threadX.requestlist.avg</u>
              The  average  number  of requests in the internal recursive processing request list on insert of a
              new incoming recursive processing query.

       <u>threadX.requestlist.max</u>
              Maximum size attained by the internal recursive processing request list.

       <u>threadX.requestlist.overwritten</u>
              Number of requests in the request list that were overwritten by newer  entries.  This  happens  if
              there is a flood of queries that recursive processing and the server has a hard time.

       <u>threadX.requestlist.exceeded</u>
              Queries  that  were  dropped because the request list was full. This happens if a flood of queries
              need recursive processing, and the server can not keep up.

       <u>threadX.requestlist.current.all</u>
              Current size of the request list, includes internally generated queries (such as  priming  queries
              and glue lookups).

       <u>threadX.requestlist.current.user</u>
              Current size of the request list, only the requests from client queries.

       <u>threadX.recursion.time.avg</u>
              Average  time  it  took to answer queries that needed recursive processing. Note that queries that
              were answered from the cache are not in this average.

       <u>threadX.recursion.time.median</u>
              The median of the time it took to answer queries that needed  recursive  processing.   The  median
              means  that 50% of the user queries were answered in less than this time.  Because of big outliers
              (usually queries to non responsive servers), the average can be  bigger  than  the  median.   This
              median has been calculated by interpolation from a histogram.

       <u>threadX.tcpusage</u>
              The currently held tcp buffers for incoming connections.  A spot value on the time of the request.
              This helps you spot if the incoming-num-tcp buffers are full.

       <u>total.num.queries</u>
              summed over threads.

       <u>total.num.queries_ip_ratelimited</u>
              summed over threads.

       <u>total.num.queries_cookie_valid</u>
              summed over threads.

       <u>total.num.queries_cookie_client</u>
              summed over threads.

       <u>total.num.queries_cookie_invalid</u>
              summed over threads.

       <u>total.num.cachehits</u>
              summed over threads.

       <u>total.num.cachemiss</u>
              summed over threads.

       <u>total.num.dnscrypt.crypted</u>
              summed over threads.

       <u>total.num.dnscrypt.cert</u>
              summed over threads.

       <u>total.num.dnscrypt.cleartext</u>
              summed over threads.

       <u>total.num.dnscrypt.malformed</u>
              summed over threads.

       <u>total.num.prefetch</u>
              summed over threads.

       <u>total.num.expired</u>
              summed over threads.

       <u>total.num.queries_timed_out</u>
              summed over threads.

       <u>total.query.queue_time_us.max</u>
              the maximum of the thread values.

       <u>total.num.recursivereplies</u>
              summed over threads.

       <u>total.requestlist.avg</u>
              averaged over threads.

       <u>total.requestlist.max</u>
              the maximum of the thread requestlist.max values.

       <u>total.requestlist.overwritten</u>
              summed over threads.

       <u>total.requestlist.exceeded</u>
              summed over threads.

       <u>total.requestlist.current.all</u>
              summed over threads.

       <u>total.recursion.time.median</u>
              averaged over threads.

       <u>total.tcpusage</u>
              summed over threads.

       <u>time.now</u>
              current time in seconds since 1970.

       <u>time.up</u>
              uptime since server boot in seconds.

       <u>time.elapsed</u>
              time since last statistics printout, in seconds.

</pre><h4><b>EXTENDED</b> <b>STATISTICS</b></h4><pre>
       <u>mem.cache.rrset</u>
              Memory in bytes in use by the RRset cache.

       <u>mem.cache.message</u>
              Memory in bytes in use by the message cache.

       <u>mem.cache.dnscrypt_shared_secret</u>
              Memory in bytes in use by the dnscrypt shared secrets cache.

       <u>mem.cache.dnscrypt_nonce</u>
              Memory in bytes in use by the dnscrypt nonce cache.

       <u>mem.mod.iterator</u>
              Memory in bytes in use by the iterator module.

       <u>mem.mod.validator</u>
              Memory in bytes in use by the validator module. Includes the key cache and negative cache.

       <u>mem.streamwait</u>
              Memory  in  bytes in used by the TCP and TLS stream wait buffers.  These are answers waiting to be
              written back to the clients.

       <u>mem.http.query_buffer</u>
              Memory in bytes used by the HTTP/2 query buffers. Containing (partial)  DNS  queries  waiting  for
              request stream completion.

       <u>mem.http.response_buffer</u>
              Memory  in  bytes  used  by  the  HTTP/2  response buffers. Containing DNS responses waiting to be
              written back to the clients.

       <u>mem.quic</u>
              Memory in bytes used by QUIC. Containing connection information, stream information, queries  read
              and responses written back to the clients.

       <u>histogram.&lt;sec&gt;.&lt;usec&gt;.to.&lt;sec&gt;.&lt;usec&gt;</u>
              Shows a histogram, summed over all threads. Every element counts the recursive queries whose reply
              time  fit between the lower and upper bound.  Times larger or equal to the lowerbound, and smaller
              than the upper bound.  There are 40 buckets, with bucket sizes doubling.

       <u>num.query.type.A</u>
              The total number of queries over all threads with query type A.  Printed for the other query types
              as well, but only for the types for which queries were received, thus =0 entries are  omitted  for
              brevity.

       <u>num.query.type.other</u>
              Number of queries with query types 256-65535.

       <u>num.query.class.IN</u>
              The  total  number  of  queries over all threads with query class IN (internet).  Also printed for
              other classes (such as CH (CHAOS) sometimes used for debugging), or NONE,  ANY,  used  by  dynamic
              update.  num.query.class.other is printed for classes 256-65535.

       <u>num.query.opcode.QUERY</u>
              The  total  number  of  queries  over all threads with query opcode QUERY.  Also printed for other
              opcodes, UPDATE, ...

       <u>num.query.tcp</u>
              Number of queries that were made using TCP towards the Unbound server.

       <u>num.query.tcpout</u>
              Number of queries that the Unbound server made using TCP outgoing towards other servers.

       <u>num.query.udpout</u>
              Number of queries that the Unbound server made using UDP outgoing towards other servers.

       <u>num.query.tls</u>
              Number of queries that were made using TLS towards the Unbound server.  These are also counted  in
              num.query.tcp, because TLS uses TCP.

       <u>num.query.tls.resume</u>
              Number of TLS session resumptions, these are queries over TLS towards the Unbound server where the
              client negotiated a TLS session resumption key.

       <u>num.query.https</u>
              Number  of  queries that were made using HTTPS towards the Unbound server.  These are also counted
              in num.query.tcp and num.query.tls, because HTTPS uses TLS and TCP.

       <u>num.query.quic</u>
              Number of queries that were made using QUIC towards the Unbound server.  These are also counted in
              num.query.tls, because TLS is used for these queries.

       <u>num.query.ipv6</u>
              Number of queries that were made using IPv6 towards the Unbound server.

       <u>num.query.flags.RD</u>
              The number of queries that had the RD flag set in the header.  Also printed for flags QR, AA,  TC,
              RA, Z, AD, CD.  Note that queries with flags QR, AA or TC may have been rejected because of that.

       <u>num.query.edns.present</u>
              number of queries that had an EDNS OPT record present.

       <u>num.query.edns.DO</u>
              number  of queries that had an EDNS OPT record with the DO (DNSSEC OK) bit set.  These queries are
              also included in the num.query.edns.present number.

       <u>num.query.ratelimited</u>
              The number of queries that are turned away from being send to nameserver due to ratelimiting.

       <u>num.query.dnscrypt.shared_secret.cachemiss</u>
              The number of dnscrypt queries that did not find a shared secret in the cache.  This can  be  used
              to compute the shared secret hitrate.

       <u>num.query.dnscrypt.replay</u>
              The  number of dnscrypt queries that found a nonce hit in the nonce cache and hence are considered
              a query replay.

       <u>num.answer.rcode.NXDOMAIN</u>
              The number of answers to queries, from cache or from recursion, that had the return code NXDOMAIN.
              Also printed for the other return codes.

       <u>num.answer.rcode.nodata</u>
              The number of answers to queries that had the pseudo return code nodata.  This  means  the  actual
              return  code  was  NOERROR,  but  additionally,  no data was carried in the answer (making what is
              called a NOERROR/NODATA answer).  These queries are also included in the  num.answer.rcode.NOERROR
              number.  Common for AAAA lookups when an A record exists, and no AAAA.

       <u>num.answer.secure</u>
              Number  of  answers that were secure.  The answer validated correctly.  The AD bit might have been
              set in some of these answers, where the client signalled (with DO or AD bit  in  the  query)  that
              they were ready to accept the AD bit in the answer.

       <u>num.answer.bogus</u>
              Number  of  answers that were bogus.  These answers resulted in SERVFAIL to the client because the
              answer failed validation.

       <u>num.rrset.bogus</u>
              The number of rrsets marked bogus by the validator.  Increased for  every  RRset  inspection  that
              fails.

       <u>unwanted.queries</u>
              Number of queries that were refused or dropped because they failed the access control settings.

       <u>unwanted.replies</u>
              Replies  that  were  unwanted or unsolicited.  Could have been random traffic, delayed duplicates,
              very late answers, or could be spoofing attempts.  Some low level  of  late  answers  and  delayed
              duplicates  are  to  be  expected with the UDP protocol.  Very high values could indicate a threat
              (spoofing).

       <u>msg.cache.count</u>
              The number of items (DNS replies) in the message cache.

       <u>rrset.cache.count</u>
              The number of RRsets in the rrset cache.  This includes rrsets used by the messages in the message
              cache, but also delegation information.

       <u>infra.cache.count</u>
              The number of items in the infra cache.  These are IP addresses with  their  timing  and  protocol
              support information.

       <u>key.cache.count</u>
              The  number  of items in the key cache.  These are DNSSEC keys, one item per delegation point, and
              their validation status.

       <u>msg.cache.max_collisions</u>
              The maximum number of hash table collisions in the msg cache. This is the number  of  hashes  that
              are  identical  when a new element is inserted in the hash table. If the value is very large, like
              hundreds, something is wrong with the performance of the hash table, hash values are incorrect  or
              malicious.

       <u>rrset.cache.max_collisions</u>
              The  maximum number of hash table collisions in the rrset cache. This is the number of hashes that
              are identical when a new element is inserted in the hash table. If the value is very  large,  like
              hundreds,  something is wrong with the performance of the hash table, hash values are incorrect or
              malicious.

       <u>dnscrypt_shared_secret.cache.count</u>
              The number of items in the shared secret cache. These are precomputed shared secrets for  a  given
              client  public  key/server secret key pair. Shared secrets are CPU intensive and this cache allows
              Unbound to avoid recomputing the shared secret when multiple dnscrypt queries are  sent  from  the
              same client.

       <u>dnscrypt_nonce.cache.count</u>
              The  number  of  items  in  the client nonce cache. This cache is used to prevent dnscrypt queries
              replay. The client nonce must be unique for each client public key/server secret  key  pair.  This
              cache  should  be  able  to  host QPS * `replay window` interval keys to prevent replay of a query
              during `replay window` seconds.

       <u>num.query.authzone.up</u>
              The number of queries answered  from  auth-zone  data,  upstream  queries.   These  queries  would
              otherwise  have  been  sent (with fallback enabled) to the internet, but are now answered from the
              auth zone.

       <u>num.query.authzone.down</u>
              The number of queries for downstream  answered  from  auth-zone  data.   These  queries  are  from
              downstream clients, and have had an answer from the data in the auth zone.

       <u>num.query.aggressive.NOERROR</u>
              The  number  of queries answered using cached NSEC records with NODATA RCODE.  These queries would
              otherwise have been sent to the internet, but are now answered using cached data.

       <u>num.query.aggressive.NXDOMAIN</u>
              The number of queries answered using cached NSEC records with NXDOMAIN RCODE.  These queries would
              otherwise have been sent to the internet, but are now answered using cached data.

       <u>num.query.subnet</u>
              Number of queries that got an answer that contained EDNS client subnet data.

       <u>num.query.subnet_cache</u>
              Number of queries answered from the edns client subnet cache.  These are counted as  cachemiss  by
              the  main  counters,  but hit the client subnet specific cache after getting processed by the edns
              client subnet module.

       <u>num.query.cachedb</u>
              Number of queries answered from the external cache of cachedb.  These are counted as cachemiss  by
              the  main  counters,  but  hit  the  cachedb external cache after getting processed by the cachedb
              module.

       <u>num.rpz.action.&lt;rpz_action&gt;</u>
              Number of queries answered using configured RPZ policy, per RPZ  action  type.   Possible  actions
              are: nxdomain, nodata, passthru, drop, tcp-only, local-data, disabled, and cname-override.

</pre><h4><b>FILES</b></h4><pre>
       <u>/etc/unbound/unbound.conf</u>
              Unbound configuration file.

       <u>/etc/unbound</u>
              directory   with   private  keys  (unbound_server.key  and  unbound_control.key)  and  self-signed
              certificates (unbound_server.pem and unbound_control.pem).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man5/unbound.conf.5.html">unbound.conf</a></u>(5), <u><a href="../man8/unbound.8.html">unbound</a></u>(8).

NLnet Labs                                        Oct 17, 2024                                <u><a href="../man8/unbound-control.8.html">unbound-control</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>