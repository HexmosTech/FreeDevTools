<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vlan - vlan manipulation module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/iproute2">iproute2_6.14.0-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       vlan - vlan manipulation module

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>tc</b> ... <b>action</b> <b>vlan</b> { <b>pop</b> | <b>pop_eth</b> | <u>PUSH</u> | <u>MODIFY</u> | <u>PUSH_ETH</u> } [ <u>CONTROL</u> ]

       <u>PUSH</u> := <b>push</b> [ <b>protocol</b> <u>VLANPROTO</u> ]  <b>[</b> priority <u>VLANPRIO</u> ] <b>id</b> <u>VLANID</u>

       <u>MODIFY</u> := <b>modify</b> [ <b>protocol</b> <u>VLANPROTO</u> ]  <b>[</b> priority <u>VLANPRIO</u> ] <b>id</b> <u>VLANID</u>

       <u>PUSH_ETH</u> := <b>push_eth</b> <b>dst_mac</b> <u>LLADDR</u> <b>src_mac</b> <u>LLADDR</u>

       <u>CONTROL</u> := { <b>reclassify</b> | <b>pipe</b> | <b>drop</b> | <b>continue</b> | <b>pass</b> | <b>goto</b> <b>chain</b> <b>CHAIN_INDEX</b> }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>vlan</b> action allows one to perform 802.1Q en- or decapsulation on a packet, reflected by the operation
       modes  <u>POP</u>,  <u>PUSH</u> and <u>MODIFY</u>.  The <u>POP</u> mode is simple, as no further information is required to just drop
       the outer-most VLAN encapsulation. The <u>PUSH</u> and <u>MODIFY</u> modes require at least a <u>VLANID</u> and allow  one  to
       optionally choose the <u>VLANPROTO</u> to use.

       The <b>vlan</b> action can also be used to add or remove the base Ethernet header. The <b>pop_eth</b> mode, which takes
       no  argument,  is  used  to remove the base Ethernet header. All existing VLANs must have been previously
       dropped. The opposite operation, adding a base Ethernet header, is done with the <b>push_eth</b> mode.  In  that
       case,  the  packet  must  have no MAC header (stacking MAC headers is not permitted). This mode is mostly
       useful when a previous action has encapsulated the whole original frame behind a network header  and  one
       needs to prepend an Ethernet header before forwarding the resulting packet.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>pop</b>    Decapsulation mode, no further arguments allowed.

       <b>push</b>   Encapsulation mode. Requires at least <b>id</b> option.

       <b>modify</b> Replace mode. Existing 802.1Q tag is replaced. Requires at least <b>id</b> option.

       <b>pop_eth</b>
              Ethernet  header decapsulation mode. Only works on a plain Ethernet header: VLANs, if any, must be
              removed first.

       <b>push_eth</b>
              Ethernet header encapsulation mode. The Ethertype is automatically set using  the  network  header
              type. Chaining Ethernet headers is not allowed: the packet must have no MAC header when using this
              mode. Requires the <b>dst_mac</b> and <b>src_mac</b> options.

       <b>id</b> <u>VLANID</u>
              Specify  the  VLAN  ID  to  encapsulate  into.  <u>VLANID</u> is an unsigned 16bit integer, the format is
              detected automatically (e.g. prefix with '<b>0x</b>' for hexadecimal interpretation, etc.).

       <b>protocol</b> <u>VLANPROTO</u>
              Choose the VLAN protocol to use. At the time  of  writing,  the  kernel  accepts  only  <b>802.1Q</b>  or
              <b>802.1ad</b>.

       <b>priority</b> <u>VLANPRIO</u>
              Choose the VLAN priority to use. Decimal number in range of 0-7.

       <b>dst_mac</b> <u>LLADDR</u>
              Choose the destination MAC address to use.

       <b>src_mac</b> <u>LLADDR</u>
              Choose the source MAC address to use.

       <u>CONTROL</u>
              How to continue after executing this action.

              <b>reclassify</b>
                     Restarts  classification  by  jumping  back  to  the first filter attached to this action's
                     parent.

              <b>pipe</b>   Continue with the next action, this is the default.

              <b>drop</b>   Packet will be dropped without running further actions.

              <b>continue</b>
                     Continue classification with next filter in line.

              <b>pass</b>   Return to calling qdisc for packet processing. This ends the classification process.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following example encapsulates incoming ICMP packets on eth0 from 10.0.0.2 into VLAN ID 123:

              #tc qdisc add dev eth0 handle ffff: ingress
              #tc filter add dev eth0 parent ffff: pref 11 protocol ip \
                   u32 match ip protocol 1 0xff flowid 1:1 \
                       match ip src 10.0.0.2 flowid 1:1 \
                   action vlan push id 123

       Here is an example of the  <b>pop</b>  function:  Incoming  VLAN  packets  on  eth0  are  decapsulated  and  the
       classification process then restarted for the plain packet:

              #tc qdisc add dev eth0 handle ffff: ingress
              #tc filter add dev $ETH parent ffff: pref 1 protocol 802.1Q \
                   u32 match u32 0 0 flowid 1:1 \
                   action vlan pop reclassify

       For an example of the <b>pop_eth</b> and <b>push_eth</b> modes, see <b><a href="../man8/tc-mpls.8.html">tc-mpls</a></b>(8).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/tc.8.html">tc</a></b>(8), <b><a href="../man8/tc-mpls.8.html">tc-mpls</a></b>(8)

iproute2                                           12 Jan 2015                 <u>VLAN</u> <u>manipulation</u> <u>action</u> <u>in</u> <u><a href="../man8/tc.8.html">tc</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>