<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ipsec_pluto, ipsec_whack, pluto - ipsec whack : IPsec IKE keying daemon and control interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/libreswan">libreswan_4.14-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ipsec_pluto, ipsec_whack, pluto - ipsec whack : IPsec IKE keying daemon and control interface

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>ipsec</b> <u>pluto</u> [--help] [--version] [--leak-detective] [--efence-protect] [--config <u>filename</u>]
             [--vendorid <u>VID</u>] [--nofork] [--stderrlog] [--logfile <u>filename</u>] [--log-no-time] [--log-no-append]
             [--log-no-ip] [--log-no-audit] [--use-netkey] [--use-bsdkame] [--uniqueids]
             [--virtual-private <u>network_list</u>] [--keep-alive <u>delay_sec</u>] [--force-busy] [--crl-strict]
             [--crlcheckinterval] [--interface <u>interfacename</u>] [--listen <u>ipaddr</u>] [--ikeport <u>portnumber</u>]
             [--natikeport <u>portnumber</u>] [--rundir <u>path</u>] [--secretsfile <u>secrets-file</u>] [--nhelpers <u>number</u>]
             [--seedbits <u>numbits</u>] [--ipsecdir <u>dirname</u>] [--nssdir <u>dirname</u>] [--coredir <u>dirname</u>]
             [--statsbin <u>filename</u>] [--secctx-attr-type <u>number</u>]

       <b>ipsec</b> <u>whack</u> [--help] [--version]

       <b>ipsec</b> <u>whack</u> --name <u>connection-name</u> [[--ipv4] | [--ipv6]] [[--tunnelipv4] | [--tunnelipv6]]
             [--id <u>identity</u>] [--host <u>ip-address</u>] [--cert <u>friendly_name</u>] [--ckaid <u>CKAID</u>]
             [--ca <u>distinguished</u> <u>name</u>] [--groups <u>access</u> <u>control</u> <u>groups</u>]
             [--sendcert yes | forced | always | ifasked | no | never] [--sendca none | issuer | all]
             [--certtype <u>number</u>] [--ikeport <u>portnumber</u>] [--nexthop <u>ip-address</u>] [[--client <u>subnet</u>]]
             [--clientprotoport <u>protocol</u>/<u>port</u>] [--srcip <u>ip-address</u>] [--xauthserver] [--xauthclient]
             [--modecfgserver] [--modecfgclient] [--modecfgdns <u>ip-address,</u> <u>ip-address,</u> <u>...</u>]
             [--modecfgdomains <u>DNS-domain,</u> <u>DNS-domain,</u> <u>...</u>] [--modecfgbanner <u>login-banner</u>] [--dnskeyondemand]
             [--updown <u>updown</u>]
             --to
             [--id <u>identity</u>] [--host <u>ip-address</u>] [--cert <u>friendly_name</u>] [--ckaid <u>CKAID</u>]
             [--ca <u>distinguished</u> <u>name</u>] [--groups <u>access</u> <u>control</u> <u>groups</u>]
             [--sendcert yes | always | ifasked | no | never] [--certtype <u>number</u>] [--ikeport <u>port-number</u>]
             [--nexthop <u>ip-address</u>] [--client <u>subnet</u>] [--clientprotoport <u>protocol</u>/<u>port</u>] [--srcip <u>ip-address</u>]
             [--xauthserver] [--xauthclient] [--modecfgserver] [--modecfgclient]
             [--modecfgdns <u>ip-address,</u> <u>ip-address,</u> <u>...</u>] [--modecfgdomains <u>DNS-domain,</u> <u>DNS-domain,</u> <u>...</u>]
             [--dnskeyondemand] [--updown <u>updown</u>]

             [--tunnel] [--psk] [--rsasig] [--encrypt] [--authenticate] [--compress] [--pfs]
             [--pfsgroup [modp1024] | [modp1536] | [modp2048] | [modp3072] | [modp4096] | [modp6144] | [modp8192] | [dh22] | [dh23] | [dh24]]
             [--ikelifetime <u>seconds</u>] [--ipseclifetime <u>seconds</u>] [--rekeymargin <u>seconds</u>] [--rekeyfuzz <u>percentage</u>]
             [--keyingtries <u>count</u>] [--esp <u>esp-algos</u>] [--dontrekey] [--aggrmode] [--modecfgpull]
             [--metric <u>metric</u>] [--nflog-group <u>nflognum</u>] [--conn-mark <u>mark/mask</u>] [[--dpddelay <u>seconds</u>] |
             [--dpdtimeout <u>seconds</u>]] [--dpdaction [clear] | [hold] | [restart]] [--forceencaps]
             [--no-keep-alive] [[--initiateontraffic] | [--pass] | [--drop] | [--reject]]
             [[--failnone] | [--failpass] | [--faildrop] | [--failreject]] [--rundir <u>path</u>]
             [--ctlsocket <u>path/file</u>] [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> --keyid <u>id</u> [--addkey] [--pubkeyrsa <u>key</u>] [--rundir <u>path</u>] [--ctlsocket <u>path/file</u>]
             [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> --listen | --unlisten  [--rundir <u>path</u>] [--ctlsocket <u>path/file</u>] [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> --ddos-auto | --ddos-busy | --ddos-unlimited  [--rundir <u>path</u>] [--ctlsocket <u>path/file</u>]

       <b>ipsec</b> <u>whack</u> --route | --unroute  --name <u>connection-name</u> [--rundir <u>path</u>] [--ctlsocket <u>path/file</u>]
             [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> --initiate | [--remote-host <u>ip-address</u>] | --terminate | --rekey-ike | --rekey-ipsec
             --name <u>connection-name</u> [--xauthuser <u>user</u>] [--xauthpass <u>pass</u>] [--asynchronous] [--rundir <u>path</u>]
             [--ctlsocket <u>path/file</u>] [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> --global-redirect <u>yes|no|auto</u>

       <b>ipsec</b> <u>whack</u> --global-redirect-to <u>ip-address(es)</u>

       <b>ipsec</b> <u>whack</u> [--name <u>connection-name</u>] --redirect-to <u>ip-address(es)</u>

       <b>ipsec</b> <u>whack</u> [[--tunnelipv4] | [--tunnelipv6]] --oppohere <u>ip-address</u> --oppothere <u>ip-address</u>
             --opposport <u>port</u> --oppodport <u>port</u> --oppoproto <u>protocol</u>

       <b>ipsec</b> <u>whack</u> --crash [ipaddress]

       <b>ipsec</b> <u>whack</u> --name <u>connection-name</u> --delete [--ctlbase <u>path</u>] [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> --deletestate <u>state-number</u> [--rundir <u>path</u>] [--ctlsocket <u>path/file</u>] [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> --deleteuser --name <u>username</u> [--rundir <u>path</u>] [--ctlsocket <u>path/file</u>] [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> [--name <u>connection-name</u>] {--debug help | none | base | cpu-usage | <u>class</u>} |
             {--no-debug <u>class</u>} | {--impair help | none | <u>behaviour</u>} | {--no-impair <u>behaviour</u>}

       <b>ipsec</b> <u>whack</u> [--utc] [--listall] [--listpubkeys] [--listcerts] [--listcacerts] [--listcrls]

       <b>ipsec</b> <u>whack</u> [--utc] [--rereadsecrets] [--fetchcrls] [--rereadall]

       <b>ipsec</b> <u>whack</u> --ddns

       <b>ipsec</b> <u>whack</u> --listevents

       <b>ipsec</b> <u>whack</u> --purgeocsp

       <b>ipsec</b> <u>whack</u> --status --trafficstatus --shuntstatus --addresspoolstatus --processstatus [--rundir <u>path</u>]
             [--ctlsocket <u>path/file</u>] [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> --globalstats --clearstats [--rundir <u>path</u>] [--ctlsocket <u>path/file</u>] [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> [--ike-socket-bufsize <u>bufsize</u>] [--ike-socket-errqueue-toggle] [--rundir <u>path</u>]
             [--ctlsocket <u>path/file</u>] [--label <u>string</u>]

       <b>ipsec</b> <u>whack</u> --shutdown [--rundir <u>path</u>] [--ctlsocket <u>path/file</u>] [--label <u>string</u>] [--leave-state]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>pluto</b> is an IKE ("IPsec Key Exchange") daemon.  <b>whack</b> is an auxiliary program to allow requests to be
       made to a running <b>pluto</b>.

       <b>pluto</b> is used to automatically build shared "security associations" on a system that has IPsec, the
       secure IP protocol. In other words, <b>pluto</b> can eliminate much of the work of manual keying. The actual
       secure transmission of packets is the responsibility of other parts of the system - the kernel. Pluto can
       talk to various kernel implementations, such as the Linux <b>XFRM</b> and BSD <b>KAME</b> IPsec stacks.  <b><a href="../man8/ipsec_auto.8.html">ipsec_auto</a></b>(8)
       provides a more convenient interface to <b>pluto</b> and <b>whack</b>.

   <b>IKE's</b> <b>Job</b>
       A <u>Security</u> <u>Association</u> (<u>SA</u>) is an agreement between two network nodes on how to process certain traffic
       between them. This processing involves encapsulation, authentication, encryption, or compression.

       IKE can be deployed on a network node to negotiate Security Associations for that node. These IKE
       implementations can only negotiate with other IKE implementations, so IKE must be on each node that is to
       be an endpoint of an IKE-negotiated Security Association. No other nodes need to be running IKE.

       An IKE instance (i.e. an IKE implementation on a particular network node) communicates with another IKE
       instance using UDP IP packets, so there must be a route between the nodes in each direction.

       The negotiation of Security Associations requires a number of choices that involve tradeoffs between
       security, convenience, trust, and efficiency. These are policy issues and are normally specified to the
       IKE instance by the system administrator.

       IKE deals with two kinds of Security Associations. The first part of a negotiation between IKE instances
       is to build an ISAKMP SA. An ISAKMP SA is used to protect communication between the two IKEs. IPsec SAs
       can then be built by the IKEs - these are used to carry protected IP traffic between the systems.

       The negotiation of the ISAKMP SA is known as Phase 1. In theory, Phase 1 can be accomplished by a couple
       of different exchange types. Currently, Main Mode and Aggressive Mode are implemented.

       Any negotiation under the protection of an ISAKMP SA, including the negotiation of IPsec SAs, is part of
       Phase 2. The exchange type that we use to negotiate an IPsec SA is called Quick Mode.

       IKE instances must be able to authenticate each other as part of their negotiation of an ISAKMP SA. This
       can be done by several mechanisms described in the draft standards.

       IKE negotiation can be initiated by any instance with any other. If both can find an agreeable set of
       characteristics for a Security Association, and both recognize each others authenticity, they can set up
       a Security Association. The standards do not specify what causes an IKE instance to initiate a
       negotiation.

       In summary, an IKE instance is prepared to automate the management of Security Associations in an IPsec
       environment, but a number of issues are considered policy and are left in the system administrator's
       hands.

   <b>Pluto</b>
       <b>pluto</b> is an implementation of IKE. It runs as a daemon on a network node. Currently, this network node
       must be a Linux system running the <b>XFRM</b> IPsec stack, or a FreeBSD/NetBSD/Mac OSX system running the <b>KAME</b>
       IPsec stack.

       <b>pluto</b> implements a large subset of IKEv1 and IKEv2.

       The policy for acceptable characteristics for Security Associations is mostly hardwired into the code of
       <b>pluto</b> (spdb.c). Eventually this will be moved into a security policy database with reasonable expressive
       power and more convenience.

       <b>pluto</b> uses shared secrets or RSA signatures to authenticate peers with whom it is negotiating. These RSA
       signatures can come from DNS(SEC), a configuration file, or from X.509 and CA certificates.

       <b>pluto</b> initiates negotiation of a Security Association when it is manually prodded: the program <b>whack</b> is
       run to trigger this. It will also initiate a negotiation when IPsec traps an outbound packet for
       Opportunistic Encryption.

       <b>pluto</b> implements ISAKMP SAs itself. After it has negotiated the characteristics of an IPsec SA, it
       directs the <b>kernel</b> to implement it. If necessary, it also invokes a script to adjust any firewall and
       issue <b><a href="../man8/route.8.html">route</a></b>(8) commands to direct IP packets.

       When <b>pluto</b> shuts down, it closes all Security Associations.

   <b>Before</b> <b>Running</b> <b>Pluto</b>
       <b>pluto</b> runs as a daemon with userid root. Before running it, a few things must be set up.

       <b>pluto</b> requires a working IPsec stack.

       <b>pluto</b> supports multiple public networks (that is, networks that are considered insecure and thus need to
       have their traffic encrypted or authenticated). It discovers the public interfaces to use by looking at
       all interfaces that are configured (the <b>--interface</b> option can be used to limit the interfaces
       considered). It does this only when <b>whack</b> tells it to --listen, so the interfaces must be configured by
       then. The <b>--listen</b> can be used to limit listening on only 1 IP address of a certain interface.
       <b><a href="../man8/ifconfig.8.html">ifconfig</a></b>(8) or <b><a href="../man8/ip.8.html">ip</a></b>(8) with the <b>-a</b> flag will show the name and status of each network interface.

       <b>pluto</b> requires a database of preshared secrets and RSA private keys. This is described in the
       <b><a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a></b>(5).  <b>pluto</b> is told of RSA public keys via <b>whack</b> commands. If the connection is
       Opportunistic, and no RSA public key is known, <b>pluto</b> will attempt to fetch RSA keys using the Domain Name
       System.

   <b>Setting</b> <b>up</b> <b>XFRM</b> <b>for</b> <b>pluto</b>
       No special requirements are necessary to use XFRM - it ships with all modern versions of Linux 2.4 and
       later.

   <b>ipsec.secrets</b> <b>file</b>
       A <b>pluto</b> daemon and another IKE daemon (for example, another instance of <b>pluto</b>) must convince each other
       that they are who they are supposed to be before any negotiation can succeed. This authentication is
       accomplished by using either secrets that have been shared beforehand (manually) or by using RSA
       signatures. There are other techniques, but they have not been implemented in <b>pluto</b>.

       The file /etc/ipsec.secrets is used to keep preshared secret keys and XAUTH passwords. RSA private keys,
       X.509 certificates, CRLs, OCSP and smartcards are handled via NSS. For debugging, there is an argument to
       the <b>pluto</b> command to use a different file. This file is described in <b><a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a></b>(5).

   <b>Running</b> <b>Pluto</b>
       To fire up the daemon, just type <b>pluto</b> (be sure to be running as the superuser). The default IKE port
       number is 500, the UDP port assigned by IANA for IKE Daemons.  <b>pluto</b> must be run by the superuser to be
       able to use the UDP 500 port. If pluto is told to enable NAT-Traversal, then UDP port 4500 is also taken
       by pluto to listen on.

       Pluto supports different IPstacks on different operating systems. This can be configured using one of the
       options <b>--use-netkey</b> (Linux), <b>--use-bsdkame</b> (BSD). On startup, pluto might also read the <b>protostack=</b>
       option to select the IPsec stack to use if <b>--config</b> <b>/etc/ipsec.conf</b> is given as argument to pluto. If
       both <b>--use-XXX</b> and <b>--config</b> <b>/etc/ipsec.conf</b> are specified, the last command line argument specified takes
       precedence.

       Pluto supports RFC 3947 NAT-Traversal. The allowed range behind the NAT routers is submitted using the
       <b>--virtual-private</b> option. See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) for the syntax. The option <b>--force-keepalive</b> forces the
       sending of the <u>keep-alive</u> <u>packets</u>, which are send to prevent the NAT router from closing its port when
       there is not enough traffic on the IPsec connection. The <b>--keep-alive</b> sets the delay (in seconds) of
       these keep-alive packets. The newer NAT-T standards support <u>port</u> <u>floating</u>, and Libreswan enables this per
       default.

       Pluto supports the use of X.509 certificates and sends certificates when needed. Pluto uses NSS for all
       X.509 related data, including CAcerts, certs, CRLs and private keys. The <u>Certificate</u> <u>Revocation</u> <u>Lists</u> can
       also be retrieved from an URL. The option <b>--crlcheckinterval</b> sets the time between checking for CRL
       expiration and issuing new fetch commands. The first attempt to update a CRL is started at
       <u>2*crlcheckinterval</u> before the next update time. Pluto logs a warning if no valid CRL was loaded or
       obtained for a connection. If <b>--crl-strict</b> is given, the connection will be rejected until a valid CRL
       has been loaded.

       Pluto can also use helper children to off-load cryptographic operations. This behavior can be fine tuned
       using the <b>--nhelpers</b>. Pluto will start <u>(n-1)</u> of them, where <u>n</u> is the number of CPU's you have (including
       hypherthreaded CPU's). A value of <u>0</u> forces pluto to do all operations in the main process. A value of <u>-1</u>
       tells pluto to perform the above calculation. Any other value forces the number to that amount.

       Pluto uses the NSS crypto library as its random source. Some government Three Letter Agency requires that
       pluto reads 440 bits from /dev/random and feed this into the NSS RNG before drawing random from the NSS
       library, despite the NSS library itself already seeding its internal state. As this process can block
       pluto for an extended time, the default is to not perform this redundant seeding. The <b>--seedbits</b> option
       can be used to specify the number of bits that will be pulled from /dev/random and seeded into the NSS
       RNG. This can also be accomplished by specifying seedbits in the "config setup" section of ipsec.conf.
       This option should not be used by most people.

       <b>pluto</b> attempts to create a lockfile with the name /var/run/pluto/pluto.pid. If the lockfile cannot be
       created, <b>pluto</b> exits - this prevents multiple <b>pluto</b>s from competing Any "leftover" lockfile must be
       removed before <b>pluto</b> will run.  <b>pluto</b> writes its PID into this file so that scripts can find it. This
       lock will not function properly if it is on an NFS volume (but sharing locks on multiple machines doesn't
       make sense anyway).

       <b>pluto</b> then forks and the parent exits. This is the conventional "daemon fork". It can make debugging
       awkward, so there is an option to suppress this fork. In certain configurations, pluto might also launch
       helper programs to assist with DNS queries or to offload cryptographic operations.

       All logging, including diagnostics, is sent to <b><a href="../man3/syslog.3.html">syslog</a></b>(3) with facility=authpriv; it decides where to put
       these messages (possibly in /var/log/secure or <a href="file:/var/log/auth.log">/var/log/auth.log</a>). Since this too can make debugging
       awkward, the option <b>--stderrlog</b> is used to steer logging to stderr.

       Alternatively, <b>--logfile</b> can be used to send all logging information to a specific file.

       Once <b>pluto</b> is started, it waits for requests from <b>whack</b>.

   <b>Pluto's</b> <b>Internal</b> <b>State</b>
       To understand how to use <b>pluto</b>, it is helpful to understand a little about its internal state.
       Furthermore, the terminology is needed to decipher some of the diagnostic messages.

       Pluto supports <b>food</b> <b>groups</b> for Opportunistic IPsec. The policies for these are located in
       /etc/ipsec.d/policies, or another directory as specified by <b>--ipsecdir</b>.

       Pluto supports X.509 Certificates. All certificate handling is done using the NSS library and all
       certificate material is stored in an NSS database in /var/lib/ipsec/nss or another directory as specified
       by <b>--nssdir</b>.

       Pluto may core dump. It will normally do so into the current working directory. You can specify the
       --coredir option for pluto, or specify the dumpdir= option in ipsec.conf.

       If you are investigating a potential memory leak in pluto, start pluto with the --leak-detective option.
       Before the leak causes the system or pluto to die, shut down pluto in the regular way. pluto will display
       a list of leaks it has detected.

       If you are investigating a potential use-after-free or double-free in pluto, first build pluto with
       USE_EFENCE=true and then start pluto with --efence-protect. See <b><a href="../man2/efence.2.html">efence</a></b>(2) and EF_PROTECT_BELOW and
       EF_PROTECT_FREE.

       The <u>(potential)</u> <u>connection</u> database describes attributes of a connection. These include the IP addresses
       of the hosts and client subnets and the security characteristics desired.  <b>pluto</b> requires this
       information (simply called a connection) before it can respond to a request to build an SA. Each
       connection is given a name when it is created, and all references are made using this name.

       During the IKE exchange to build an SA, the information about the negotiation is represented in a <u>state</u>
       <u>object</u>. Each state object reflects how far the negotiation has reached. Once the negotiation is complete
       and the SA established, the state object remains to represent the SA. When the SA is terminated, the
       state object is discarded. Each State object is given a serial number and this is used to refer to the
       state objects in logged messages.

       Each state object corresponds to a connection and can be thought of as an instantiation of that
       connection. At any particular time, there may be any number of state objects corresponding to a
       particular connection. Often there is one representing an ISAKMP SA and another representing an IPsec SA.

       <b>XFRM</b> requires no special routing.

       Each connection may be routed, and must be while it has an IPsec SA. The connection specifies the
       characteristics of the route: the interface on this machine, the "gateway" (the nexthop), and the peer's
       client subnet. Two connections may not be simultaneously routed if they are for the same peer's client
       subnet but use different interfaces or gateways (<b>pluto</b>'s logic does not reflect any advanced routing
       capabilities).

       When <b>pluto</b> needs to install a route for a connection, it must make sure that no conflicting route is in
       use. If another connection has a conflicting route, that route will be taken down, as long as there is no
       IPsec SA instantiating that connection. If there is such an IPsec SA, the attempt to install a route will
       fail.

       There is an exception. If <b>pluto</b>, as Responder, needs to install a route to a fixed client subnet for a
       connection, and there is already a conflicting route, then the SAs using the route are deleted to make
       room for the new SAs. The rationale is that the new connection is probably more current. The need for
       this usually is a product of Road Warrior connections (these are explained later; they cannot be used to
       initiate).

       When <b>pluto</b> needs to install an eroute for an IPsec SA (for a state object), first the state object's
       connection must be routed (if this cannot be done, the eroute and SA will not be installed). If a
       conflicting eroute is already in place for another connection, the eroute and SA will not be installed
       (but note that the routing exception mentioned above may have already deleted potentially conflicting
       SAs). If another IPsec SA for the same connection already has an eroute, all its outgoing traffic is
       taken over by the new eroute. The incoming traffic will still be processed. This characteristic is
       exploited during rekeying.

   <b>Using</b> <b>whack</b>
       <b>whack</b> is used to command a running <b>pluto</b>.  <b>whack</b> uses a UNIX domain socket to speak to <b>pluto</b> (by default,
       /var/pluto.ctl).

       <b>whack</b> has an intricate argument syntax. This syntax allows many different functions to be specified. The
       help form shows the usage or version information. The connection form gives <b>pluto</b> a description of a
       potential connection. The public key form informs <b>pluto</b> of the RSA public key for a potential peer. The
       delete form deletes a connection description and all SAs corresponding to it. The listen form tells <b>pluto</b>
       to start or stop listening on the public interfaces for IKE requests from peers. The route form tells
       <b>pluto</b> to set up routing for a connection; the unroute form undoes this. The initiate form tells <b>pluto</b> to
       negotiate an SA corresponding to a connection. The terminate form tells <b>pluto</b> to remove all SAs
       corresponding to a connection, including those being negotiated. The status form displays the <b>pluto</b>'s
       internal state. The debug form tells <b>pluto</b> to change the selection of debugging output "on the fly". The
       shutdown form tells <b>pluto</b> to shut down, deleting all SAs.

       The crash option asks pluto to consider a particularly target IP to have crashed, and to attempt to
       restart all connections with that IP address as a gateway. In general, you should use Dead Peer Detection
       to detect this kind of situation automatically, but this is not always possible.

       Most options are specific to one of the forms, and will be described with that form. There are three
       options that apply to all forms.

       <b>--ctlsocket</b> <u>path/file</u>
           <u>file</u> is used as the UNIX domain socket for talking to <b>pluto</b>. Use either this option or <b>--rundir</b>, but
           not both.

       <b>--rundir</b> <u>path</u>
           <u>path</u> where the UNIX domain socket for talking to the <b>pluto</b>, the <b>pluto.pid</b> file and the <b>pluto.lock</b>
           files are found. Use either this option or <b>--ctlsocket</b>, but not both.

       <b>--label</b> <u>string</u>
           adds the string to all error messages generated by <b>whack</b>.

       The help form of <b>whack</b> is self-explanatory.

       <b>--help</b>
           display the usage message.

       <b>--version</b>
           display the version of <b>whack</b>.

       The connection form describes a potential connection to <b>pluto</b>.  <b>pluto</b> needs to know what connections can
       and should be negotiated. When <b>pluto</b> is the initiator, it needs to know what to propose. When <b>pluto</b> is
       the responder, it needs to know enough to decide whether is is willing to set up the proposed connection.

       The description of a potential connection can specify a large number of details. Each connection has a
       unique name. This name will appear in a updown shell command, so it should not contain punctuation that
       would make the command ill-formed.

       <b>--name</b> <u>connection-name</u>
           sets the name of the connection

       The topology of a connection is symmetric, so to save space here is half a picture:

          client_subnet&lt;--&gt;host:ikeport&lt;--&gt;nexthop&lt;---

       A similar trick is used in the flags. The same flag names are used for both ends. Those before the <b>--to</b>
       flag describe the left side and those afterwards describe the right side. When <b>pluto</b> attempts to use the
       connection, it decides whether it is the left side or the right side of the connection, based on the IP
       numbers of its interfaces.

       <b>--id</b> <u>id</u>
           the identity of the end. Currently, this can be an IP address (specified as dotted quad or as a Fully
           Qualified Domain Name, which will be resolved immediately) or as a Fully Qualified Domain Name itself
           (prefixed by "@" to signify that it should not be resolved), or as user@FQDN, or an X.509 DN.  <b>Pluto</b>
           only authenticates the identity, and does not use it for addressing, so, for example, an IP address
           need not be the one to which packets are to be sent. If the option is absent, the identity defaults
           to the IP address specified by <b>--host</b>.

       <b>--host</b> <u>ip-address</u>, <b>--host</b> <b>%any</b>, <b>--host</b> <b>%opportunistic</b>
           the IP address of the end (generally the public interface). If <b>pluto</b> is to act as a responder for IKE
           negotiations initiated from unknown IP addresses (the "Road Warrior" case), the IP address should be
           specified as <b>%any</b> (currently, the obsolete notation 0.0.0.0 is also accepted for this). If <b>pluto</b> is
           to opportunistically initiate the connection, use <b>%opportunistic</b>

       <b>--cert</b> <u>friendly_name</u>
           The friendly_name (or nickname) of the X.509 certificate that was used when imported the certificate
           into the NSS database. See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) on how to extract this from the PKCS#12 file.

       <b>--ckaid</b> <u>CKAID</u>
           The hex CKAID of the X.509 certificate. Certificates are stored in the NSS database.

       <b>--ca</b> <u>distinguished</u> <u>name</u>
           the X.509 Certificate Authority's Distinguished Name (DN) used as trust anchor for this connection.
           This is the CA certificate that signed the host certificate, as well as the certificate of the
           incoming client.

       <b>--groups</b> <u>access</u> <u>control</u> <u>groups</u>
           the access control groups used.

       <b>--sendcert</b> <u>yes|forced|always|ifasked|no|never</u>
           Whether or not to send our X.509 certificate credentials. This could potentially give an attacker too
           much information about which identities are allowed to connect to this host. The default is to use
           <b>ifasked</b> when we are a Responder, and to use <b>yes</b> (which is the same as <b>forced</b> and <b>always</b> if we are an
           Initiator. The values <b>no</b> and <b>never</b> are equivalent. NOTE: "forced" does not seem to be actually
           implemented - do not use it.

       <b>--sendca</b> <u>none|issuer|all</u>
           How much of our available X.509 trust chain to send with the end certificate, excluding any root CAs.
           Specifying <b>issuer</b> sends just the issuing intermediate CA, while
            <b>all</b> will send the entire chain of intermediate CAs.<b>none</b> will not send any CA certs. The default is
           <b>none</b> which maintains the current libreswan behavior.

       <b>--certtype</b> <u>number</u>
           The X.509 certificate type number.

       <b>--ikeport</b> <u>port-number</u>
           the UDP port that IKE listens to on that host. The default is 500. (<b>pluto</b> on this machine uses the
           port specified by its own command line argument, so this only affects where <b>pluto</b> sends messages.)

       <b>--nexthop</b> <u>ip-address</u>
           where to route packets for the peer's client (presumably for the peer too, but it will not be used
           for this). When <b>pluto</b> installs an IPsec SA, it issues a route command. It uses the nexthop as the
           gateway. The default is the peer's IP address (this can be explicitly written as <b>%direct</b>; the
           obsolete notation 0.0.0.0 is accepted). This option is necessary if <b>pluto</b>'s host's interface used for
           sending packets to the peer is neither point-to-point nor directly connected to the peer.

       <b>--client</b> <u>subnet</u>
           the subnet for which the IPsec traffic will be destined. If not specified, the host will be the
           client. The subnet can be specified in any of the forms supported by <b><a href="../man3/ipsec_atosubnet.3.html">ipsec_atosubnet</a></b>(3). The general
           form is <u>address</u>/<u>mask</u>. The <u>address</u> can be either a domain name or four decimal numbers (specifying
           octets) separated by dots. The most convenient form of the <u>mask</u> is a decimal integer, specifying the
           number of leading one bits in the mask. So, for example, 10.0.0.0/8 would specify the class A network
           "Net 10".

       <b>--clientprotoport</b> <u>protocol/port</u>
           specify the Port Selectors (filters) to be used on this connection. The general form is
           <u>protocol</u>/<u>port</u>. This is most commonly used to limit the connection to L2TP traffic only by specifying
           a value of <u>17/1701</u> for UDP (protocol 17) and port 1701. The notation <u>17/%any</u> can be used to allow all
           UDP traffic and is needed for L2TP connections with Windows XP machines before Service Pack 2.

       <b>--srcip</b> <u>ip-address</u>
           the IP address for this host to use when transmitting a packet to the remote IPsec gateway itself.
           This option is used to make the gateway itself use its internal IP, which is part of the <b>--client</b>
           <b>subnet</b>. Otherwise it will use its nearest IP address, which is its public IP address, which is not
           part of the subnet-subnet IPsec tunnel, and would therefore not get encrypted.

       <b>--xauthserver</b>
           this end is an xauthserver. It will lookup the xauth user name and password and verify this before
           allowing the connection to get established.

       <b>--xauthclient</b>
           this end is an xauthclient. To bring this connection up with the <b>--initiate</b> also requires the client
           to specify <b>--xauthuser</b> <b>username</b> and <b>--xauthpass</b> <b>password</b>

       <b>--xauthuser</b>
           The username for the xauth authentication.This option is normally passed along by <b><a href="../man8/ipsec_auto.8.html">ipsec_auto</a></b>(8) when
           an xauth connection is started using <u>ipsec</u> <u>auto</u> <u>--up</u> <u>conn</u>

       <b>--xauthpass</b>
           The password for the xauth authentication. This option is normally passed along by <b><a href="../man8/ipsec_auto.8.html">ipsec_auto</a></b>(8) when
           an xauth connection is started using <u>ipsec</u> <u>auto</u> <u>--up</u> <u>conn</u>

       <b>--modecfgserver</b>
           this end is an Mode Config server

       <b>--modecfgclient</b>
           this end is an Mode Config client

       <b>--modecfgdns</b>
           A comma separated list of DNS server IP's to pass along to connecting clients

       <b>--modecfgdomains</b>
           A comma separated list of internal DNS domains to pass along to connecting clients

       <b>--dnskeyondemand</b>
           specifies that when an RSA public key is needed to authenticate this host, and it isn't already
           known, fetch it from DNS.

       <b>--updown</b> <u>updown</u>
           specifies an external shell command to be run whenever <b>pluto</b> brings up or down a connection. The
           script is used to build a shell command, so it may contain positional parameters, but ought not to
           have punctuation that would cause the resulting command to be ill-formed. The default is <u>ipsec</u>
           <b>_</b><u>updown</u>. Pluto passes a dozen environment variables to the script about the connection involved.

       <b>--to</b>
           separates the specification of the left and right ends of the connection. Pluto tries to decide
           whether it is <u>left</u> or <u>right</u> based on the information provided on both sides of this option.

       The potential connection description also specifies characteristics of rekeying and security.

       <b>--psk</b>
           Propose and allow preshared secret authentication for IKE peers. This authentication requires that
           each side use the same secret. May be combined with <b>--rsasig</b>; at least one must be specified.

       <b>--rsasig</b>
           Propose and allow RSA signatures for authentication of IKE peers. This authentication requires that
           each side have have a private key of its own and know the public key of its peer. May be combined
           with <b>--psk</b>; at least one must be specified.

       <b>--encrypt</b>
           All proposed or accepted IPsec SAs will include non-null ESP. The actual choices of transforms are
           wired into <b>pluto</b>.

       <b>--authenticate</b>
           All proposed IPsec SAs will include AH. All accepted IPsec SAs will include AH or ESP with
           authentication. The actual choices of transforms are wired into <b>pluto</b>. Note that this has nothing to
           do with IKE authentication.

       <b>--compress</b>
           All proposed IPsec SAs will include IPCOMP (compression).

       <b>--tunnel</b>
           the IPsec SA should use tunneling. Implicit if the SA is for clients. Must only be used with
           <b>--authenticate</b> or <b>--encrypt</b>.

       <b>--ipv4</b>
           The host addresses will be interpreted as IPv4 addresses. This is the default. Note that for a
           connection, all host addresses must be of the same Address Family (IPv4 and IPv6 use different
           Address Families).

       <b>--ipv6</b>
           The host addresses (including nexthop) will be interpreted as IPv6 addresses. Note that for a
           connection, all host addresses must be of the same Address Family (IPv4 and IPv6 use different
           Address Families).

       <b>--tunnelipv4</b>
           The client addresses will be interpreted as IPv4 addresses. The default is to match what the host
           will be. This does not imply <b>--tunnel</b> so the flag can be safely used when no tunnel is actually
           specified. Note that for a connection, all tunnel addresses must be of the same Address Family.

       <b>--tunnelipv6</b>
           The client addresses will be interpreted as IPv6 addresses. The default is to match what the host
           will be. This does not imply <b>--tunnel</b> so the flag can be safely used when no tunnel is actually
           specified. Note that for a connection, all tunnel addresses must be of the same Address Family.

       <b>--pfs</b>
           There should be Perfect Forward Secrecy - new keying material will be generated for each IPsec SA
           when running Quick Mode in IKEv1 or Create Child in IKEv2. Without this option, the SAKMP SA keying
           material is used instead.  <b>pluto</b> will propose the same group that was used with the original IKE SA.

       <b>--pfsgroup</b> <u>modp-group</u>
           Sets the Diffie-Hellman group used. Currently the following values are supported: <b>modp1024</b> (DHgroup
           2), <b>modp1536</b> (DHgroup 5), <b>modp2048</b> (DHgroup 14), <b>modp3072</b> (DHgroup 15), <b>modp4096</b> (DHgroup 16),
           <b>modp6144</b> (DHgroup 17), and <b>modp8192</b> (DHgroup 18). It is possible to support the weak and broken
           <b>modp768</b> (DHgroup 1), but this requires a manual recompile and is strongly discouraged.

       <b>--esp</b> <u>esp-algos</u>
           ESP encryption/authentication algorithm to be used for the connection (phase2 aka IPsec SA). The
           options must be suitable as a value of <b><a href="../man8/ipsec_spi.8.html">ipsec_spi</a></b>(8). See <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) for a detailed description of
           the algorithm format.

       <b>--aggrmode</b>
           This tunnel is using aggressive mode ISAKMP negotiation. The default is main mode. Aggressive mode is
           less secure than main mode as it reveals your identity to an eavesdropper, but is needed to support
           road warriors using PSK keys or to interoperate with other buggy implementations insisting on using
           aggressive mode.

       <b>--modecfgpull</b>
           Pull the Mode Config network information from the peer.

       <b>--dpddelay</b> <u>seconds</u>
           Set the delay (in seconds) between Dead Peer Detection (RFC 3706) keepalives (R_U_THERE,
           R_U_THERE_ACK) that are sent for this connection (default 30 seconds).

       <b>--timeout</b> <u>seconds</u>
           Set the length of time (in seconds) we will idle without hearing either an R_U_THERE poll from our
           peer, or an R_U_THERE_ACK reply. After this period has elapsed with no response and no traffic, we
           will declare the peer dead, and remove the SA (default 120 seconds).

       <b>--dpdaction</b> <u>action</u>
           When a DPD enabled peer is declared dead, what action should be taken.  <b>hold</b>(default) means the
           eroute will be put into <u>%hold</u> status, while <b>clear</b>means the eroute and SA with both be cleared. Clear
           is really only useful on the server of a Road Warrior config. The action <b>restart</b> is used on tunnels
           that need to be permanently up, and have static IP addresses. The action <b>restart_by_peer</b>has been
           obsoleted and its functionality has been moved into the restart action.

       <b>--forceencaps</b>
           In some cases, for example when ESP packets are filtered or when a broken IPsec peer does not
           properly recognise NAT, it can be useful to force RFC-3948 encapsulation using this option. It causes
           pluto lie and tell the remote peer that RFC-3948 encapsulation (ESP in UDP port 4500 packets) is
           required.

       If none of the <b>--encrypt</b>, <b>--authenticate</b>, <b>--compress</b>, or <b>--pfs</b> flags is given, the initiating the
       connection will only build an ISAKMP SA. For such a connection, client subnets have no meaning and must
       not be specified.

       Apart from initiating directly using the <b>--initiate</b> option, a tunnel can be loaded with a different
       policy

       <b>--initiateontraffic</b>
           Only initiate the connection when we have traffic to send over the connection

       <b>--pass</b>
           Allow <b>unencrypted</b> traffic to flow until the tunnel is initiated.

       <b>--drop</b>
           Drop unencrypted traffic silently.

       <b>--reject</b>
           Drop unencrypted traffic silently, but send an ICMP message notifying the other end.

       These options need to be documented

       <b>--failnone</b>
           to be documented

       <b>--failpass</b>
           to be documented

       <b>--faildrop</b>
           to be documented

       <b>--failreject</b>
           to be documented

       <b>pluto</b> supports various X.509 Certificate related options.

       <b>--utc</b>
           display all times in UTC.

       <b>--listall</b>
           lists all of the X.509 information known to pluto.

       <b>--listpubkeys</b>
           list all the public keys that have been successfully loaded.

       <b>--listcerts</b>
           list all the X.509 certificates that are currently loaded.

       <b>--checkpubkeys</b>
           list all the loaded X.509 certificates that are about to expire or have expired.

       <b>--listcacerts</b>
           list all the Certificate Authority X.509 certificates that are currently loaded.

       <b>--listcrls</b>
           list all the loaded <u>Certificate</u> <u>Revocation</u> <u>Lists</u> (CRLs)

       The corresponding options <b>--rereadsecrets</b>, <b>--rereadall</b>, and <b>--rereadcrls</b> options reread this information
       from their respective sources, and purge all the online obtained information. The option <b>--listevents</b>
       lists all pending events, and the <b>--ddns</b> triggers the Dynamic DNS update event that is normally scheduled
       to run once every minute.

       <b>--ikelifetime</b> <u>seconds</u>
           how long <b>pluto</b> will propose that an ISAKMP SA be allowed to live. The default is 3600 (one hour) and
           the maximum is 86400 (1 day). This option will not affect what is accepted.  <b>pluto</b> will reject
           proposals that exceed the maximum.

       <b>--ipseclifetime</b> <u>seconds</u>
           how long <b>pluto</b> will propose that an IPsec SA be allowed to live. The default is 28800 (eight hours)
           and the maximum is 86400 (one day). This option will not affect what is accepted.  <b>pluto</b> will reject
           proposals that exceed the maximum.

       <b>--rekeymargin</b> <u>seconds</u>
           how long before an SA's expiration should <b>pluto</b> try to negotiate a replacement SA. This will only
           happen if <b>pluto</b> was the initiator. The default is 540 (nine minutes).

       <b>--rekeyfuzz</b> <u>percentage</u>
           maximum size of random component to add to rekeymargin, expressed as a percentage of rekeymargin.
           <b>pluto</b> will select a delay uniformly distributed within this range. By default, the percentage will be
           100. If greater determinism is desired, specify 0. It may be appropriate for the percentage to be
           much larger than 100.

       <b>--keyingtries</b> <u>count</u>
           how many times <b>pluto</b> should try to negotiate an SA, either for the first time or for rekeying. The
           default value of 0 means to keep trying forever.

       <b>--dontrekey</b>
           A misnomer. Only rekey a connection if we were the Initiator and there was recent traffic on the
           existing connection. This applies to Phase 1 and Phase 2. This is currently the only automatic way
           for a connection to terminate. It may be useful with Road Warrior or Opportunistic connections.
           Since SA lifetime negotiation is take-it-or-leave it, a Responder normally uses the shorter of the
           negotiated or the configured lifetime. This only works because if the lifetime is shorter than
           negotiated, the Responder will rekey in time so that everything works. This interacts badly with
           <b>--dontrekey</b>. In this case, the Responder will end up rekeying to rectify a shortfall in an IPsec SA
           lifetime; for an ISAKMP SA, the Responder will accept the negotiated lifetime.

       <b>--delete</b>
           when used in the connection form, it causes any previous connection with this name to be deleted
           before this one is added. Unlike a normal delete, no diagnostic is produced if there was no previous
           connection to delete. Any routing in place for the connection is undone.

       <b>--delete</b>, <b>--name</b> <u>connection-name</u>
           The delete form deletes a named connection description and any SAs established or negotiations
           initiated using this connection. Any routing in place for the connection is undone.

       <b>--deletestate</b> <u>state-number</u>
           The deletestate form deletes the state object with the specified serial number. This is useful for
           selectively deleting instances of connections.

       The route form of the <b>whack</b> command tells <b>pluto</b> to set up routing for a connection. Although like a
       traditional route, it uses an ipsec device as a virtual interface. Once routing is set up, no packets
       will be sent "in the clear" to the peer's client specified in the connection. A TRAP shunt eroute will be
       installed; if outbound traffic is caught, Pluto will initiate the connection. An explicit <b>whack</b> route is
       not always needed: if it hasn't been done when an IPsec SA is being installed, one will be automatically
       attempted.

       <b>--route</b>, <b>--name</b> <u>connection-name</u>
           When a routing is attempted for a connection, there must not already be a routing for a different
           connection with the same subnet but different interface or destination, or if there is, it must not
           be being used by an IPsec SA. Otherwise the attempt will fail.

       <b>--unroute</b>, <b>--name</b> <u>connection-name</u>
           The unroute form of the <b>whack</b> command tells <b>pluto</b> to undo a routing.  <b>pluto</b> will refuse if an IPsec
           SA is using the connection. If another connection is sharing the same routing, it will be left in
           place. Without a routing, packets will be sent without encryption or authentication.

       The initiate form tells <b>pluto</b> to initiate a negotiation with another <b>pluto</b> (or other IKE daemon)
       according to the named connection. Initiation requires a route that <b>--route</b> would provide; if none is in
       place at the time an IPsec SA is being installed, <b>pluto</b> attempts to set one up.

       <b>--initiate</b>, <b>--name</b> <u>connection-name</u>, <b>--asynchronous</b>
           The initiate form of the <b>whack</b> command will relay back from <b>pluto</b> status information via the UNIX
           domain socket (unless --asynchronous is specified). The status information is meant to look a bit
           like that from <b>FTP</b>. Currently <b>whack</b> simply copies this to stderr. When the request is finished (eg.
           the SAs are established or <b>pluto</b> gives up), <b>pluto</b> closes the channel, causing <b>whack</b> to terminate.

       The opportunistic initiate form is mainly used for debugging.

       <b>--tunnelipv4</b>, <b>--tunnelipv6</b>, <b>--oppohere</b>  <u>ip-address</u>, <b>--oppothere</b>  <u>ip-address</u>, <b>--opposport</b>  <u>port</u>,
       <b>--oppodport</b>  <u>port</u>, <b>--oppoproto</b>  <u>protocol</u>
           This will cause <b>pluto</b> to attempt to opportunistically initiate a connection from here to the there,
           even if a previous attempt had been made. The whack log will show the progress of this attempt.

       Rekeying a connection

       <b>--rekey-ipsec</b>, <b>--name</b> <u>connection-name</u>
           the rekey-ipsec form tells <u>pluto</u> to rekey the IPsec SA (child SA) of the specified connection. It
           does not affect the IKE SA (parent SA)

       <b>--rekey-ike</b>, <b>--name</b> <u>connection-name</u>
           the rekey-ike form tells <u>pluto</u> to rekey the IKE SA (parent SA) of the specified connection. It does
           not affect the IPsec SAs (child SAs)

       Ending a connection

       <b>--terminate</b>, <b>--name</b> <u>connection-name</u>
           the terminate form tells <u>pluto</u> to delete any SAs that use the specified connection and to stop any
           negotiations in process. it does not prevent new negotiations from starting (the delete form has this
           effect).

       <b>--crash</b> <u>ip-address</u>
           If the remote peer has crashed, and therefore did not notify us, we keep sending encrypted traffic,
           and rejecting all plaintext (non-IKE) traffic from that remote peer. The <b>--crash</b> brings our end down
           as well for all the known connections to the specified <u>ip-address</u>

       <u>ip-address</u>
           If the remote peer has crashed, and therefore did not notify us, we keep sending encrypted traffic,
           and rejecting all plaintext (non-IKE) traffic from that remote peer. The <b>--crash</b> brings our end down
           as well for all the known connections to the specified <u>ip-address</u>

       Redirecting clients can be done using IKEv2 redirect mechanism.

       <b>--global-redirect</b> <u>yes|no|auto</u>
           The --global-redirect option controls whether <u>pluto</u> will instruct remote peers to redirect IKE/IPsec
           SA's during IKE_SA_INIT. Valid options are <u>no</u>, <u>yes</u> and <u>auto</u>, where auto means remote peers will be
           redirected if DDoS mode is active.

       <b>--global-redirect-to</b> <u>ip-address(es)</u>
           The destination, or a list of destinations, where the peers will be redirected.

       <b>--name</b> <u>connection_name</u>, <b>--redirect-to</b> <u>ip-address(es)</u>
           The destination, or a list of destinations, where the peers will be redirected. Specifying the
           connection name is optional. If not specified the mechanism will redirect all currently active peers.
           If specified, only the peers from connection <u>connection_name</u> will be redirected.

       The public key for informs <b>pluto</b> of the RSA public key for a potential peer. Private keys must be kept
       secret, so they are kept in <b><a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a></b>(5).

       <b>--keyid</b> <u>id</u>
           specififies the identity of the peer for which a public key should be used. Its form is identical to
           the identity in the connection. If no public key is specified, <b>pluto</b> attempts to find KEY records
           from DNS for the id (if a FQDN) or through reverse lookup (if an IP address). Note that there several
           interesting ways in which this is not secure.

       <b>--addkey</b>
           specifies that the new key is added to the collection; otherwise the new key replaces any old ones.

       <b>--pubkeyrsa</b> <u>key</u>
           specifies the value of the RSA public key. It is a sequence of bytes as described in RFC 2537
           "RSA/MD5 KEYs and SIGs in the Domain Name System (DNS)". It is denoted in a way suitable for
           <b><a href="../man3/ipsec_ttodata.3.html">ipsec_ttodata</a></b>(3). For example, a base 64 numeral starts with 0s.

       The listen form tells <b>pluto</b> to start listening for IKE requests on its public interfaces. To avoid race
       conditions, it is normal to load the appropriate connections into <b>pluto</b> before allowing it to listen. If
       <b>pluto</b> isn't listening, it is pointless to initiate negotiations, so it will refuse requests to do so.
       Whenever the listen form is used, <b>pluto</b> looks for public interfaces and will notice when new ones have
       been added and when old ones have been removed. This is also the trigger for <b>pluto</b> to read the
       <u>ipsec.secrets</u> file. So listen may useful more than once.

       <b>--listen</b>
           start listening for IKE traffic on public interfaces.

       <b>--unlisten</b>
           stop listening for IKE traffic on public interfaces.

       The --ddos-auto, --ddos-busy and --ddos-unlimited options tells <b>pluto</b> to update the DDoS protection
       state. Normally, these measures are automatically activated or deactivated based on the number of states
       inside pluto. The busy and unlimited option tells pluto to activate or deactivate the DDoS protection
       mode manually. One of these DDoS protection methods is to activate IKEv2 DCOOKIEs to defend against
       spoofed IKE packets.

       <b>--ddos-busy</b>
           place pluto into busy mode and activate anti-DDoS measures.

       <b>--ddos-unlimited</b>
           pull pluto out of busy mode and deactivate anti-DDoS measures.

       <b>--ddos-auto</b>
           activate the built-in detection mechanism for the anti-DDoS measures.

       The status form will display information about the internal state of <b>pluto</b>: information about each
       potential connection, about each state object, and about each shunt that <b>pluto</b> is managing without an
       associated connection.

       Statistics can be seen using <b>ipsec</b> <b>whack</b> <b>--globalstats</b> and reset using <b>ipsec</b> <b>whack</b> <b>--clearstats</b>. This can
       be used with the munin software to monitor VPN services.

       <b>--status</b>

       The trafficstatus form will display the xauth username, add_time and the total in and out bytes of the
       IPsec SA's.

       <b>--trafficstatus</b>

       The shutdown form is the proper way to shut down <b>pluto</b>. It will tear down the SAs on this machine that
       <b>pluto</b> has negotiated. If the <b>--leave-state</b> option is given, it does not delete any connections, and
       leaves the kernel state in the kernel. Note that the init system used might clean up the kernel state
       regardless.

       <b>--shutdown</b>

   <b>Examples</b>
       It would be normal to start <b>pluto</b> in one of the system initialization scripts. It needs to be run by the
       superuser. Generally, no arguments are needed. To run in manually, the superuser can simply type

          ipsec pluto

       The command will immediately return, but a <b>pluto</b> process will be left running, waiting for requests from
       <b>whack</b> or a peer.

       Using <b>whack</b>, several potential connections would be described:

          ipsec whack --name silly --host 127.0.0.1 --to --host 127.0.0.2 --ikelifetime 900 --ipseclifetime 800
       --keyingtries 3

       Since this silly connection description specifies neither encryption, authentication, nor tunneling, it
       could only be used to establish an ISAKMP SA.

          ipsec whack --name conn_name --host 10.0.0.1 --client 10.0.1.0/24 --to --host 10.0.0.2
       --client 10.0.2.0/24 --encrypt

       This is something that must be done on both sides. If the other side is <b>pluto</b>, the same <b>whack</b> command
       could be used on it (the command syntax is designed to not distinguish which end is ours).

       Now that the connections are specified, <b>pluto</b> is ready to handle requests and replies via the public
       interfaces. We must tell it to discover those interfaces and start accepting messages from peers:

          ipsec whack --listen

       If we don't immediately wish to bring up a secure connection between the two clients, we might wish to
       prevent insecure traffic. The routing form asks <b>pluto</b> to cause the packets sent from our client to the
       peer's client to be routed through the ipsec0 device; if there is no SA, they will be discarded:

          ipsec whack --route conn_name

       Finally, we are ready to get <b>pluto</b> to initiate negotiation for an IPsec SA (and implicitly, an ISAKMP
       SA):

          ipsec whack --initiate --name conn_name

       A small log of interesting events will appear on standard output (other logging is sent to syslog).

       <b>whack</b> can also be used to terminate <b>pluto</b> cleanly, tearing down all SAs that it has negotiated.

          ipsec whack --shutdown

       Notification of any IPSEC SA deletion, but not ISAKMP SA deletion is sent to the peer. Unfortunately,
       such Notification is not reliable. Furthermore, <b>pluto</b> itself ignores Notifications.

   <b>XAUTH</b>
       If <b>pluto</b> needs additional authentication, such as defined by the XAUTH specifications, then it may ask
       <b>whack</b> to prompt the operator for username or passwords. Typically, these will be entered interactively. A
       GUI that wraps around <b>whack</b> may look for the 041 (username) or 040 (password) prompts, and display them
       to the user.

       For testing purposes, the options <b>--xauthuser</b> <u>user</u> <b>--xauthpass</b> <u>pass</u> may be be given prior to the
       <b>--initiate</b>  to provide responses to the username and password prompts.

   <b>The</b> <b>updown</b> <b>command</b>
       Whenever <b>pluto</b> brings a connection up or down, it invokes the updown command. This command is specified
       using the <b>--updown</b> option. This allows for customized control over routing and firewall manipulation.

       The updown is invoked for five different operations. Each of these operations can be for our client
       subnet or for our host itself.

       <b>prepare-host</b> or <b>prepare-client</b>
           is run before bringing up a new connection if no other connection with the same clients is up.
           Generally, this is useful for deleting a route that might have been set up before <b>pluto</b> was run or
           perhaps by some agent not known to <b>pluto</b>.

       <b>route-host</b> or <b>route-client</b>
           is run when bringing up a connection for a new peer client subnet (even if <b>prepare-host</b> or
           <b>prepare-client</b> was run). The command should install a suitable route. Routing decisions are based
           only on the destination (peer's client) subnet address, unlike eroutes which discriminate based on
           source too.

       <b>unroute-host</b> or <b>unroute-client</b>
           is run when bringing down the last connection for a particular peer client subnet. It should undo
           what the <b>route-host</b> or <b>route-client</b> did.

       <b>up-host</b> or <b>up-client</b>
           is run when bringing up a tunnel eroute with a pair of client subnets that does not already have a
           tunnel eroute. This command should install firewall rules as appropriate. It is generally a good idea
           to allow IKE messages (UDP port 500) travel between the hosts.

       <b>down-host</b> or <b>down-client</b>
           is run when bringing down the eroute for a pair of client subnets. This command should delete
           firewall rules as appropriate. Note that there may remain some inbound IPsec SAs with these client
           subnets.

       The script is passed a large number of environment variables to specify what needs to be done.

       <b>PLUTO_VERB</b>
           specifies the name of the operation to be performed (<b>prepare-host</b>,r <b>prepare-client</b>, <b>up-host</b>,
           <b>up-client</b>, <b>down-host</b>, or <b>down-client</b>). If the address family for security gateway to security gateway
           communications is IPv6, then a suffix of -v6 is added to the verb.

       <b>PLUTO_CONNECTION</b>
           is the name of the connection for which we are routing.

       <b>PLUTO_NEXT_HOP</b>
           is the next hop to which packets bound for the peer must be sent.

       <b>PLUTO_INTERFACE</b>
           is the name of the ipsec interface to be used.

       <b>PLUTO_ME</b>
           is the IP address of our host.

       <b>PLUTO_MY_CLIENT</b>
           is the IP address / count of our client subnet. If the client is just the host, this will be the
           host's own IP address / max (where max is 32 for IPv4 and 128 for IPv6).

       <b>PLUTO_MY_CLIENT_NET</b>
           is the IP address of our client net. If the client is just the host, this will be the host's own IP
           address.

       <b>PLUTO_MY_CLIENT_MASK</b>
           is the mask for our client net. If the client is just the host, this will be 255.255.255.255.

       <b>PLUTO_PEER</b>
           is the IP address of our peer.

       <b>PLUTO_PEER_CLIENT</b>
           is the IP address / count of the peer's client subnet. If the client is just the peer, this will be
           the peer's own IP address / max (where max is 32 for IPv4 and 128 for IPv6).

       <b>PLUTO_PEER_CLIENT_NET</b>
           is the IP address of the peer's client net. If the client is just the peer, this will be the peer's
           own IP address.

       <b>PLUTO_PEER_CLIENT_MASK</b>
           is the mask for the peer's client net. If the client is just the peer, this will be 255.255.255.255.

       <b>PLUTO_MY_PROTOCOL</b>
           lists the protocols allowed over this IPsec SA.

       <b>PLUTO_PEER_PROTOCOL</b>
           lists the protocols the peer allows over this IPsec SA.

       <b>PLUTO_MY_PORT</b>
           lists the ports allowed over this IPsec SA.

       <b>PLUTO_PEER_PORT</b>
           lists the ports the peer allows over this IPsec SA.

       <b>PLUTO_MY_ID</b>
           lists our id.

       <b>PLUTO_PEER_ID</b>
           Dlists our peer's id.

       <b>PLUTO_PEER_CA</b>
           lists the peer's CA.

       All output sent by the script to stderr or stdout is logged. The script should return an exit status of 0
       if and only if it succeeds.

       <b>Pluto</b> waits for the script to finish and will not do any other processing while it is waiting. The script
       may assume that <b>pluto</b> will not change anything while the script runs. The script should avoid doing
       anything that takes much time and it should not issue any command that requires processing by <b>pluto</b>.
       Either of these activities could be performed by a background subprocess of the script.

   <b>Rekeying</b>
       When an SA that was initiated by <b>pluto</b> has only a bit of lifetime left, <b>pluto</b> will initiate the creation
       of a new SA. This applies to ISAKMP and IPsec SAs. The rekeying will be initiated when the SA's remaining
       lifetime is less than the rekeymargin plus a random percentage, between 0 and rekeyfuzz, of the
       rekeymargin.

       Similarly, when an SA that was initiated by the peer has only a bit of lifetime left, <b>pluto</b> will try to
       initiate the creation of a replacement. To give preference to the initiator, this rekeying will only be
       initiated when the SA's remaining lifetime is half of rekeymargin. If rekeying is done by the responder,
       the roles will be reversed: the responder for the old SA will be the initiator for the replacement. The
       former initiator might also initiate rekeying, so there may be redundant SAs created. To avoid these
       complications, make sure that rekeymargin is generous.

       One risk of having the former responder initiate is that perhaps none of its proposals is acceptable to
       the former initiator (they have not been used in a successful negotiation). To reduce the chances of this
       happening, and to prevent loss of security, the policy settings are taken from the old SA (this is the
       case even if the former initiator is initiating). These may be stricter than those of the connection.

       <b>pluto</b> will not rekey an SA if that SA is not the most recent of its type (IPsec or ISAKMP) for its
       potential connection. This avoids creating redundant SAs.

       The random component in the rekeying time (rekeyfuzz) is intended to make certain pathological patterns
       of rekeying unstable. If both sides decide to rekey at the same time, twice as many SAs as necessary are
       created. This could become a stable pattern without the randomness.

       Another more important case occurs when a security gateway has SAs with many other security gateways.
       Each of these connections might need to be rekeyed at the same time. This would cause a high peek
       requirement for resources (network bandwidth, CPU time, entropy for random numbers). The rekeyfuzz can be
       used to stagger the rekeying times.

       Once a new set of SAs has been negotiated, <b>pluto</b> will never send traffic on a superseded one. Traffic
       will be accepted on an old SA until it expires.

   <b>Selecting</b> <b>a</b> <b>Connection</b> <b>When</b> <b>Responding:</b> <b>Road</b> <b>Warrior</b> <b>Support</b>
       When <b>pluto</b> receives an initial Main Mode message, it needs to decide which connection this message is
       for. It picks based solely on the source and destination IP addresses of the message. There might be
       several connections with suitable IP addresses, in which case one of them is arbitrarily chosen. (The
       ISAKMP SA proposal contained in the message could be taken into account, but it is not.)

       The ISAKMP SA is negotiated before the parties pass further identifying information, so all ISAKMP SA
       characteristics specified in the connection description should be the same for every connection with the
       same two host IP addresses. At the moment, the only characteristic that might differ is authentication
       method.

       Up to this point, all configuring has presumed that the IP addresses are known to all parties ahead of
       time. This will not work when either end is mobile (or assigned a dynamic IP address for other reasons).
       We call this situation "Road Warrior". It is fairly tricky and has some important limitations, most of
       which are features of the IKE protocol.

       Only the initiator may be mobile: the initiator may have an IP number unknown to the responder. When the
       responder doesn't recognize the IP address on the first Main Mode packet, it looks for a connection with
       itself as one end and <b>%any</b> as the other. If it cannot find one, it refuses to negotiate. If it does find
       one, it creates a temporary connection that is a duplicate except with the <b>%any</b> replaced by the source IP
       address from the packet; if there was no identity specified for the peer, the new IP address will be
       used.

       When <b>pluto</b> is using one of these temporary connections and needs to find the preshared secret or RSA
       private key in <u>ipsec.secrets</u>, and the connection specified no identity for the peer, <b>%any</b> is used as its
       identity. After all, the real IP address was apparently unknown to the configuration, so it is
       unreasonable to require that it be used in this table.

       Part way into the Phase 1 (Main Mode) negotiation using one of these temporary connection descriptions,
       <b>pluto</b> will receive an Identity Payload. At this point, <b>pluto</b> checks for a more appropriate connection,
       one with an identity for the peer that matches the payload and would use the same keys as so far used for
       authentication. If it finds one, it will switch to using this better connection (or a temporary one
       derived from this, if it has <b>%any</b> for the peer's IP address). It may even turn out that no connection
       matches the newly discovered identity, including the current connection; if so, <b>pluto</b> terminates
       negotiation.

       Unfortunately, if preshared secret authentication is being used, the Identity Payload is encrypted using
       this secret, so the secret must be selected by the responder without knowing this payload. This limits
       there to being at most one preshared secret for all Road Warrior systems connecting to a host. RSA
       Signature authentication does not require that the responder knows how to select the initiator's public
       key until after the initiator's Identity Payload is decoded (using the responder's private key, so that
       must be preselected).

       When <b>pluto</b> is responding to a Quick Mode negotiation via one of these temporary connection descriptions,
       it may well find that the subnets specified by the initiator don't match those in the temporary
       connection description. If so, it will look for a connection with matching subnets, its own host address,
       a peer address of <b>%any</b> and matching identities. If it finds one, a new temporary connection is derived
       from this one and used for the Quick Mode negotiation of IPsec SAs. If it does not find one, <b>pluto</b>
       terminates negotiation.

       Be sure to specify an appropriate nexthop for the responder to send a message to the initiator: <b>pluto</b> has
       no way of guessing it (if forwarding isn't required, use an explicit <b>%direct</b> as the nexthop and the IP
       address of the initiator will be filled in; the obsolete notation 0.0.0.0 is still accepted).

       <b>pluto</b> has no special provision for the initiator side. The current (possibly dynamic) IP address and
       nexthop must be used in defining connections. These must be properly configured each time the initiator's
       IP address changes.  <b>pluto</b> has no mechanism to do this automatically.

       Although we call this Road Warrior Support, it could also be used to support encrypted connections with
       anonymous initiators. The responder's organization could announce the preshared secret that would be used
       with unrecognized initiators and let anyone connect. Of course the initiator's identity would not be
       authenticated.

       If any Road Warrior connections are supported, <b>pluto</b> cannot reject an exchange initiated by an unknown
       host until it has determined that the secret is not shared or the signature is invalid. This must await
       the third Main Mode message from the initiator. If no Road Warrior connection is supported, the first
       message from an unknown source would be rejected. This has implications for ease of debugging
       configurations and for denial of service attacks.

       Although a Road Warrior connection must be initiated by the mobile side, the other side can and will
       rekey using the temporary connection it has created. If the Road Warrior wishes to be able to disconnect,
       it is probably wise to set <b>--keyingtries</b> to 1 in the connection on the non-mobile side to prevent it
       trying to rekey the connection. Unfortunately, there is no mechanism to unroute the connection
       automatically.

   <b>Debugging</b>
       <b>pluto</b> accepts several optional arguments, useful mostly for debugging. Except for <b>--interface</b>, each
       should appear at most once.

       <b>--interface</b> <u>interfacename</u>
           specifies that the named real public network interface should be considered. The interface name
           specified should not be <b>ipsec</b><u>N</u>. If the option doesn't appear, all interfaces are considered. To
           specify several interfaces, use the option once for each. One use of this option is to specify which
           interface should be used when two or more share the same IP address.

       <b>--ikeport</b> <u>port-number</u>
           changes the UDP port that <b>pluto</b> will use (default, specified by IANA: 500)

       <b>--ctlbase</b> <u>path</u>
           basename for control files.  <u>path</u>.ctl is the socket through which <b>whack</b> communicates with <b>pluto</b>.
           <u>path</u>.pid is the lockfile to prevent multiple <b>pluto</b> instances. The default is /var/run/pluto/pluto).

       <b>--secretsfile</b> <u>file</u>
           specifies the file for authentication secrets (default: /etc/ipsec.secrets). This name is subject to
           "globbing" as in <b><a href="../man1/sh.1.html">sh</a></b>(1), so every file with a matching name is processed. Quoting is generally needed
           to prevent the shell from doing the globbing.

       <b>--nofork</b>
           disable "daemon fork" (default is to fork). In addition, after the lock file and control socket are
           created, print the line "Pluto initialized" to standard out.

       <b>--uniqueids</b>
           if this option has been selected, whenever a new ISAKMP SA is established, any connection with the
           same Peer ID but a different Peer IP address is unoriented (causing all its SAs to be deleted). This
           helps clean up dangling SAs when a connection is lost and then regained at another IP address.

       <b>--force-busy</b>
           if this option has been selected, pluto will be forced to be "busy". In this state, which happens
           when there is a Denial of Service attack, will force pluto to use cookies before accepting new
           incoming IKE packets. Cookies are send and required in ikev1 Aggressive Mode and in ikev2. This
           option is mostly used for testing purposes, but can be selected by paranoid administrators as well.

       <b>--stderrlog</b>
           log goes to standard out {default is to use <b><a href="../man8/syslogd.8.html">syslogd</a></b>(8))

       <b>pluto</b> is willing to produce a prodigious amount of debugging information. There are several classes of
       debugging output, and <b>pluto</b> may be directed to produce a selection of them. All lines of debugging output
       are prefixed with "| " to distinguish them from normal diagnostic messages.

       When <b>pluto</b> is invoked, it may be given arguments to specify which debug classes to output. The current
       options are:

       <b>--debug</b> <b>help</b> (whack only)
           list the debugging classes recognised by <b>pluto</b>

       <b>--debug</b> <b>none</b>
           disable logging for all debugging classes

       <b>--debug</b> <b>base</b>
           enable debug-logging

       <b>--debug</b> <b>cpu-usage</b>
           enable cpu-usage logging

       <b>--debug</b> <u>class</u>, <b>--no-debug</b> <u>class</u>, <b>--debug</b> <b>no-</b><u>class</u>
           enable (disable) logging of the specified debugging <u>class</u> (<b>--debug</b> <b>help</b> lists debugging classes
           supported by this version of <b>pluto</b>)

       The debug form of the <b>whack</b> command will change the selection in a running <b>pluto</b>. If a connection name is
       specified, the flags are added whenever <b>pluto</b> has identified that it is dealing with that connection.
       Unfortunately, this is often part way into the operation being observed.

       For example, to start <b>pluto</b> with both <u>base</u> and <u>cpu-usage</u> debug-logging enabled:

                pluto --debug base --debug cpu-usage

       To later change this <b>pluto</b> to disable <u>base</u> debug-logging use either:

                whack --no-debug base

       or:

                whack --debug none --debug cpu-usage

   <b>Impairing</b>
       <b>pluto</b> and <b>whack</b> accept several optional arguments that alter (impair) correct behaviour.

       These options are solely intended for use by developers when testing <b>pluto</b>.

       <b>--impair</b> <b>help</b> (whack only)
           list all the behaviours that can be altered (impaired)

       <b>--impair</b> <b>list</b> (whack only)
           list all the behaviours that are currently altered (impaired)

       <b>--impair</b> <b>none</b>
           disable all altered (impaired) behaviours

       <b>--impair</b> <u>behaviour</u>, <b>--impair</b> <u>behaviour</u><b>:</b><u>how</u>, <b>--no-impair</b> <u>behaviour</u>
           alter (impair) <b>pluto</b> inducing the (possibly erroneous) <u>behaviour</u>

   <b>Pluto's</b> <b>Behaviour</b> <b>When</b> <b>Things</b> <b>Go</b> <b>Wrong</b>
       When <b>pluto</b> doesn't understand or accept a message, it just ignores the message. It is not yet capable of
       communicating the problem to the other IKE daemon (in the future it might use Notifications to accomplish
       this in many cases). It does log a diagnostic.

       When <b>pluto</b> gets no response from a message, it resends the same message (a message will be sent at most
       three times). This is appropriate: UDP is unreliable.

       When pluto gets a message that it has already seen, there are many cases when it notices and discards it.
       This too is appropriate for UDP.

       Combine these three rules, and you can explain many apparently mysterious behaviours. In a <b>pluto</b> log,
       retrying isn't usually the interesting event. The critical thing is either earlier (<b>pluto</b> got a message
       that it didn't like and so ignored, so it was still awaiting an acceptable message and got impatient) or
       on the other system (<b>pluto</b> didn't send a reply because it wasn't happy with the previous message).

   <b>Notes</b>
       Each IPsec SA is assigned an SPI, a 32-bit number used to refer to the SA. The IKE protocol lets the
       destination of the SA choose the SPI. The range 0 to 0xFF is reserved for IANA.  <b>Pluto</b> also avoids
       choosing an SPI in the range 0x100 to 0xFFF, leaving these SPIs free for manual keying. Remember that the
       peer, if not <b>pluto</b>, may well chose SPIs in this range.

   <b>Policies</b>
       This catalogue of policies may be of use when trying to configure <b>Pluto</b> and another IKE implementation to
       interoperate.

       In Phase 1, only Main Mode is supported. We are not sure that Aggressive Mode is secure. For one thing,
       it does not support identity protection. It may allow more severe Denial Of Service attacks.

       No Informational Exchanges are supported. These are optional and since their delivery is not assured,
       they must not matter. It is the case that some IKE implementations won't interoperate without
       Informational Exchanges, but we feel they are broken.

       No Informational Payloads are supported. These are optional, but useful. It is of concern that these
       payloads are not authenticated in Phase 1, nor in those Phase 2 messages authenticated with <a href="../man3/HASH.3.html">HASH</a>(3).

       •
           Diffie Hellman Groups MODP 1024 and MODP 1536 (2 and 5) are supported. Group MODP768 (1) is not
           supported because it is too weak.

       •
           Host authentication can be done by RSA Signatures or Pre-Shared Secrets.

       •
           3DES CBC (Cypher Block Chaining mode) is the only encryption supported, both for ISAKMP SAs and IPSEC
           SAs.

       •
           MD5 and SHA1 hashing are supported for packet authentication in both kinds of SAs.

       •
           The ESP, AH, or AH plus ESP are supported. If, and only if, AH and ESP are combined, the ESP need not
           have its own authentication component. The selection is controlled by the --encrypt and
           --authenticate flags.

       •
           Each of these may be combined with IPCOMP Deflate compression, but only if the potential connection
           specifies compression.

       •
           The IPSEC SAs may be tunnel or transport mode, where appropriate. The --tunnel flag controls this
           when <b>pluto</b> is initiating.

       •
           When responding to an ISAKMP SA proposal, the maximum acceptable lifetime is eight hours. The default
           is one hour. There is no minimum. The --ikelifetime flag controls this when <b>pluto</b> is initiating.

       •
           When responding to an IPSEC SA proposal, the maximum acceptable lifetime is one day. The default is
           eight hours. There is no minimum. The --ipseclifetime flag controls this when <b>pluto</b> is initiating.

       •
           PFS is acceptable, and will be proposed if the --pfs flag was specified. The DH group proposed will
           be the same as negotiated for Phase 1.

</pre><h4><b>SIGNALS</b></h4><pre>
       <b>Pluto</b> responds to <b>SIGHUP</b> by issuing a suggestion that ``<b>whack</b> --listen'' might have been intended.

       <b>Pluto</b> exits when it receives <b>SIGTERM</b>.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <b>pluto</b> normally forks a daemon process, so the exit status is normally a very preliminary result.

       0
           means that all is OK so far.

       1
           means that something was wrong.

       10
           means that the lock file already exists.

       If <b>whack</b> detects a problem, it will return an exit status of 1. If it received progress messages from
       <b>pluto</b>, it returns as status the value of the numeric prefix from the last such message that was not a
       message sent to syslog or a comment (but the prefix for success is treated as 0). Otherwise, the exit
       status is 0.

</pre><h4><b>FILES</b></h4><pre>
       /var/run/pluto/pluto.pid

       /var/run/pluto/pluto.ctl

       /etc/ipsec.secrets

       /dev/urandom

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       pluto does not use any environment variables

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       The rest of the Libreswan distribution, in particular <b><a href="../man8/ipsec.8.html">ipsec</a></b>(8).

       <b><a href="../man8/ipsec_auto.8.html">ipsec_auto</a></b>(8) is designed to make using <b>pluto</b> more pleasant. Use it!

       <b><a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a></b>(5) describes the format of the secrets file.

       <b><a href="../man3/ipsec_atoaddr.3.html">ipsec_atoaddr</a></b>(3), part of the Libreswan distribution, describes the forms that IP addresses may take.
       <b><a href="../man3/ipsec_atosubnet.3.html">ipsec_atosubnet</a></b>(3), part of the Libreswan distribution, describes the forms that subnet specifications.

       For more information on IPsec, the mailing list, and the relevant documents, see:

       <b>https://datatracker.ietf.org/wg/ipsecme/charter/</b>

       At the time of writing, the latest IETF IKE RFC is:

       RFC 7296 Internet Key Exchange Protocol Version 2 (IKEv2)

       The Libreswan web site &lt;https://libreswan.org&gt; and the mailing lists described there.

       The Libreswan wiki &lt;https://libreswan.org/wiki&gt; and the mailing lists described there.

       The Libreswan list of implemented RFCs &lt;https://libreswan.org/wiki/Implemented_Standards&gt;

</pre><h4><b>HISTORY</b></h4><pre>
       This code is released under the GPL terms. See the accompanying files CHANGES COPYING and CREDITS.* for
       more details.

       Detailed history (including FreeS/WAN and Openswan) can be found in the docs/ directory.

</pre><h4><b>BUGS</b></h4><pre>
       Please see &lt;<b>https://bugs.libreswan.org</b>&gt; for a list of currently known bugs and missing features.

       Bugs should be reported to the &lt;<a href="mailto:swan-dev@lists.libreswan.org">swan-dev@lists.libreswan.org</a>&gt; mailing list.

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>Paul</b> <b>Wouters</b>
           placeholder to suppress warning

libreswan                                          03/31/2024                                     <u><a href="../man8/IPSEC_PLUTO.8.html">IPSEC_PLUTO</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>