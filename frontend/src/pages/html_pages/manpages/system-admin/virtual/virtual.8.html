<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>virtual - Postfix virtual domain mail delivery agent</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/postfix">postfix_3.10.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       virtual - Postfix virtual domain mail delivery agent

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>virtual</b> [generic Postfix daemon options]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b><a href="../man8/virtual.8.html">virtual</a></b>(8)  delivery  agent  is  designed for virtual mail hosting services. Originally based on the
       Postfix <b><a href="../man8/local.8.html">local</a></b>(8) delivery agent, this agent looks up recipients with map lookups of their full  recipient
       address, instead of using hard-coded unix password file lookups of the address local part only.

       This  delivery  agent  only  delivers  mail.   Other  features  such  as  mail  forwarding, out-of-office
       notifications, etc., must be configured via virtual_alias maps or via similar lookup mechanisms.

</pre><h4><b>MAILBOX</b> <b>LOCATION</b></h4><pre>
       The mailbox location is controlled by the  <b>virtual_mailbox_base</b>  and  <b>virtual_mailbox_maps</b>  configuration
       parameters  (see below).  The <b>virtual_mailbox_maps</b> table is indexed by the recipient address as described
       under TABLE SEARCH ORDER below.

       The mailbox pathname is constructed as follows:

         <b>$virtual_mailbox_base/$virtual_mailbox_maps(</b><u>recipient</u><b>)</b>

       where <u>recipient</u> is the full recipient address.

</pre><h4><b>UNIX</b> <b>MAILBOX</b> <b>FORMAT</b></h4><pre>
       When the mailbox location does not end in <b>/</b>, the message is delivered  in  UNIX  mailbox  format.    This
       format stores multiple messages in one textfile.

       The  <b><a href="../man8/virtual.8.html">virtual</a></b>(8)  delivery  agent  prepends  a  "<b>From</b>  <u>sender</u> <u>time_stamp</u>" envelope header to each message,
       prepends a <b>Delivered-To:</b> message header with the envelope recipient address, prepends  an  <b>X-Original-To:</b>
       header  with  the  recipient address as given to Postfix, prepends a <b>Return-Path:</b> message header with the
       envelope sender address, prepends a <b>&gt;</b> character to lines beginning with "<b>From</b> ",  and  appends  an  empty
       line.

       The mailbox is locked for exclusive access while delivery is in progress. In case of problems, an attempt
       is made to truncate the mailbox to its original length.

</pre><h4><b>QMAIL</b> <b>MAILDIR</b> <b>FORMAT</b></h4><pre>
       When the mailbox location ends in <b>/</b>, the message is delivered in qmail <b>maildir</b> format. This format stores
       one message per file.

       The  <b><a href="../man8/virtual.8.html">virtual</a></b>(8)  delivery agent prepends a <b>Delivered-To:</b> message header with the final envelope recipient
       address, prepends an <b>X-Original-To:</b> header with the recipient address as given to Postfix, and prepends a
       <b>Return-Path:</b> message header with the envelope sender address.

       By definition, <b>maildir</b> format does not require application-level file locking  during  mail  delivery  or
       retrieval.

</pre><h4><b>MAILBOX</b> <b>OWNERSHIP</b></h4><pre>
       Mailbox  ownership  is  controlled  by the <b>virtual_uid_maps</b> and <b>virtual_gid_maps</b> lookup tables, which are
       indexed with the full recipient address. Each table provides a string with the numerical user  and  group
       ID, respectively.

       The <b>virtual_minimum_uid</b> parameter imposes a lower bound on numerical user ID values that may be specified
       in any <b>virtual_uid_maps</b>.

</pre><h4><b>CASE</b> <b>FOLDING</b></h4><pre>
       All delivery decisions are made using the full recipient address, folded to lower case. See also the next
       section for a few exceptions with optional address extensions.

</pre><h4><b>TABLE</b> <b>SEARCH</b> <b>ORDER</b></h4><pre>
       Normally,  a lookup table is specified as a text file that serves as input to the <b><a href="../man1/postmap.1.html">postmap</a></b>(1) command. The
       result, an indexed file in <b>dbm</b> or <b>db</b> format, is used for fast searching by the mail system.

       The search order is as follows. The search stops upon the first successful lookup.

       •      When the recipient has an optional address  extension  the  <u>user+<a href="mailto:extension@domain.tld">extension@domain.tld</a></u>  address  is
              looked up first.

              With Postfix versions before 2.1, the optional address extension is always ignored.

       •      The <u><a href="mailto:user@domain.tld">user@domain.tld</a></u> address, without address extension, is looked up next.

       •      Finally, the recipient <u>@domain</u> is looked up.

       When  the  table  is  provided via other means such as NIS, LDAP or SQL, the same lookups are done as for
       ordinary indexed files.

       Alternatively, a table can be provided as a regular-expression map where patterns are  given  as  regular
       expressions. In that case, only the full recipient address is given to the regular-expression map.

</pre><h4><b>SECURITY</b></h4><pre>
       The  <b><a href="../man8/virtual.8.html">virtual</a></b>(8)  delivery agent is not security sensitive, provided that the lookup tables with recipient
       user/group ID information are adequately protected. This program is not designed to run chrooted.

       The <b><a href="../man8/virtual.8.html">virtual</a></b>(8) delivery agent disallows regular expression substitution of $1 etc. in regular  expression
       lookup tables, because that would open a security hole.

       The  <b><a href="../man8/virtual.8.html">virtual</a></b>(8)  delivery  agent  will silently ignore requests to use the <b><a href="../man8/proxymap.8.html">proxymap</a></b>(8) server. Instead it
       will open the table directly. Before Postfix version 2.2, the virtual delivery agent will terminate  with
       a fatal error.

</pre><h4><b>STANDARDS</b></h4><pre>
       RFC 822 (ARPA Internet Text Messages)

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Mail  bounces  when  the  recipient has no mailbox or when the recipient is over disk quota. In all other
       problem cases, mail for an existing recipient is deferred and a warning is logged.

       Problems and transactions are logged to <b><a href="../man8/syslogd.8.html">syslogd</a></b>(8) or <b><a href="../man8/postlogd.8.html">postlogd</a></b>(8).  Corrupted message files are marked so
       that the queue manager can move them to the <b>corrupt</b> queue afterwards.

       Depending on the setting of the <b>notify_classes</b> parameter, the postmaster is notified of  bounces  and  of
       other trouble.

</pre><h4><b>BUGS</b></h4><pre>
       This delivery agent supports address extensions in email addresses and in lookup table keys, but does not
       propagate address extension information to the result of table lookup.

       Postfix  should  have  lookup  tables  that  can return multiple result attributes. In order to avoid the
       inconvenience of maintaining three tables, use an LDAP or MYSQL database.

</pre><h4><b>CONFIGURATION</b> <b>PARAMETERS</b></h4><pre>
       Changes to <b>main.cf</b> are picked up automatically, as <b><a href="../man8/virtual.8.html">virtual</a></b>(8) processes run for only a limited amount  of
       time. Use the command "<b>postfix</b> <b>reload</b>" to speed up a change.

       The text below provides only a parameter summary. See <b><a href="../man5/postconf.5.html">postconf</a></b>(5) for more details including examples.

</pre><h4><b>MAILBOX</b> <b>DELIVERY</b> <b>CONTROLS</b></h4><pre>
       <b>virtual_mailbox_base</b> <b>(empty)</b>
              A   prefix   that   the   <b><a href="../man8/virtual.8.html">virtual</a></b>(8)   delivery  agent  prepends  to  all  pathname  results  from
              $virtual_mailbox_maps table lookups.

       <b>virtual_mailbox_maps</b> <b>(empty)</b>
              Optional   lookup   tables   with   all   valid   addresses   in   the    domains    that    match
              $virtual_mailbox_domains.

       <b>virtual_minimum_uid</b> <b>(100)</b>
              The  minimum  user  ID  value  that  the  <b><a href="../man8/virtual.8.html">virtual</a></b>(8)  delivery  agent  accepts  as  a  result from
              $virtual_uid_maps table lookup.

       <b>virtual_uid_maps</b> <b>(empty)</b>
              Lookup tables with the per-recipient user ID that the <b><a href="../man8/virtual.8.html">virtual</a></b>(8) delivery agent uses while writing
              to the recipient's mailbox.

       <b>virtual_gid_maps</b> <b>(empty)</b>
              Lookup tables with the per-recipient group ID for <b><a href="../man8/virtual.8.html">virtual</a></b>(8) mailbox delivery.

       Available in Postfix version 2.0 and later:

       <b>virtual_mailbox_domains</b> <b>($virtual_mailbox_maps)</b>
              Postfix is the final destination for the specified list of domains;  mail  is  delivered  via  the
              $virtual_transport mail delivery transport.

       <b>virtual_transport</b> <b>(virtual)</b>
              The  default mail delivery transport and next-hop destination for final delivery to domains listed
              with $virtual_mailbox_domains.

       Available in Postfix version 2.5.3 and later:

       <b>strict_mailbox_ownership</b> <b>(yes)</b>
              Defer delivery when a mailbox file is not owned by its recipient.

</pre><h4><b>LOCKING</b> <b>CONTROLS</b></h4><pre>
       <b>virtual_mailbox_lock</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              How to lock a UNIX-style <b><a href="../man8/virtual.8.html">virtual</a></b>(8) mailbox before attempting delivery.

       <b>deliver_lock_attempts</b> <b>(20)</b>
              The maximal number of attempts to acquire an  exclusive  lock  on  a  mailbox  file  or  <b><a href="../man8/bounce.8.html">bounce</a></b>(8)
              logfile.

       <b>deliver_lock_delay</b> <b>(1s)</b>
              The time between attempts to acquire an exclusive lock on a mailbox file or <b><a href="../man8/bounce.8.html">bounce</a></b>(8) logfile.

       <b>stale_lock_time</b> <b>(500s)</b>
              The time after which a stale exclusive mailbox lockfile is removed.

</pre><h4><b>RESOURCE</b> <b>AND</b> <b>RATE</b> <b>CONTROLS</b></h4><pre>
       <b>virtual_mailbox_limit</b> <b>(51200000)</b>
              The maximal size in bytes of an individual <b><a href="../man8/virtual.8.html">virtual</a></b>(8) mailbox or maildir file, or zero (no limit).

       Implemented in the <a href="../man8/qmgr.8.html">qmgr</a>(8) daemon:

       <b>virtual_destination_concurrency_limit</b> <b>($default_destination_concurrency_limit)</b>
              The maximal number of parallel deliveries to the same destination via the virtual message delivery
              transport.

       <b>virtual_destination_recipient_limit</b> <b>($default_destination_recipient_limit)</b>
              The maximal number of recipients per message for the virtual message delivery transport.

</pre><h4><b>MISCELLANEOUS</b> <b>CONTROLS</b></h4><pre>
       <b>config_directory</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              The default location of the Postfix main.cf and master.cf configuration files.

       <b>daemon_timeout</b> <b>(18000s)</b>
              How  much  time a Postfix daemon process may take to handle a request before it is terminated by a
              built-in watchdog timer.

       <b>delay_logging_resolution_limit</b> <b>(2)</b>
              The maximal number of digits after the decimal point when logging sub-second delay values.

       <b>ipc_timeout</b> <b>(3600s)</b>
              The time limit for sending or receiving information over an internal communication channel.

       <b>max_idle</b> <b>(100s)</b>
              The maximum amount of time that an idle Postfix daemon process waits for  an  incoming  connection
              before terminating voluntarily.

       <b>max_use</b> <b>(100)</b>
              The  maximal  number  of  incoming  connections  that a Postfix daemon process will service before
              terminating voluntarily.

       <b>process_id</b> <b>(read-only)</b>
              The process ID of a Postfix command or daemon process.

       <b>process_name</b> <b>(read-only)</b>
              The process name of a Postfix command or daemon process.

       <b>queue_directory</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              The location of the Postfix top-level queue directory.

       <b>syslog_facility</b> <b>(mail)</b>
              The syslog facility of Postfix logging.

       <b>syslog_name</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              A prefix that is prepended to the process name in syslog records, so that,  for  example,  "smtpd"
              becomes "prefix/smtpd".

       Available in Postfix version 3.0 and later:

       <b>virtual_delivery_status_filter</b> <b>($default_delivery_status_filter)</b>
              Optional  filter  for  the  <b><a href="../man8/virtual.8.html">virtual</a></b>(8)  delivery  agent  to  change  the  delivery  status code or
              explanatory text of successful or unsuccessful deliveries.

       Available in Postfix version 3.3 and later:

       <b>enable_original_recipient</b> <b>(yes)</b>
              Enable support for the original recipient address after an address is  rewritten  to  a  different
              address (for example with aliasing or with canonical mapping).

       <b>service_name</b> <b>(read-only)</b>
              The master.cf service name of a Postfix daemon process.

       Available in Postfix 3.5 and later:

       <b>info_log_address_format</b> <b>(external)</b>
              The email address form that will be used in non-debug logging (info, warning, etc.).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/qmgr.8.html">qmgr</a>(8), queue manager
       <a href="../man8/bounce.8.html">bounce</a>(8), delivery status reports
       <a href="../man5/postconf.5.html">postconf</a>(5), configuration parameters
       <a href="../man8/postlogd.8.html">postlogd</a>(8), Postfix logging
       <a href="../man8/syslogd.8.html">syslogd</a>(8), system logging

</pre><h4><b>README_FILES</b></h4><pre>
       Use "<b>postconf</b> <b>readme_directory</b>" or
       "<b>postconf</b> <b>html_directory</b>" to locate this information.
       VIRTUAL_README, domain hosting howto

</pre><h4><b>LICENSE</b></h4><pre>
       The Secure Mailer license must be distributed with this software.

</pre><h4><b>HISTORY</b></h4><pre>
       This  delivery  agent  was  originally  based  on  the Postfix local delivery agent. Modifications mainly
       consisted of removing code that either was not applicable or that was not safe in this context:  aliases,
       ~user/.forward files, delivery to "|command" or to /file/name.

       The <b>Delivered-To:</b> message header appears in the <b>qmail</b> system by Daniel Bernstein.

       The <b>maildir</b> structure appears in the <b>qmail</b> system by Daniel Bernstein.

</pre><h4><b>AUTHOR(S)</b></h4><pre>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA

       Wietse Venema
       Google, Inc.
       111 8th Avenue
       New York, NY 10011, USA

       Andrew McNamara
       <a href="mailto:andrewm@connect.com.au">andrewm@connect.com.au</a>
       connect.com.au Pty. Ltd.
       Level 3, 213 Miller St
       North Sydney 2060, NSW, Australia

                                                                                                      <u><a href="../man8/VIRTUAL.8.html">VIRTUAL</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>