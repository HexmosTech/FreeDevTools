<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oscap-vm - Tool for offline SCAP evaluation of virtual machines.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openscap-utils">openscap-utils_1.4.2+dfsg-1ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       oscap-vm - Tool for offline SCAP evaluation of virtual machines.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>oscap-vm</b> <u>[--oscap=&lt;oscap_binary&gt;]</u> <b>domain</b> <u>VM_DOMAIN</u> <u>[OSCAP_OPTIONS]</u> <u>INPUT_CONTENT</u>

       <b>oscap-vm</b> <u>[--oscap=&lt;oscap_binary&gt;]</u> <b>image</b> <u>VM_STORAGE_IMAGE</u> <u>[OSCAP_OPTIONS]</u> <u>INPUT_CONTENT</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>oscap-vm</b> performs SCAP evaluation of virtual machine domains or virtual machine images.

       The  tool  mounts  the  filesystem  of  given  virtual  machine  and  runs  <b><a href="../man8/oscap.8.html">oscap</a>(8)</b> to asses the mounted
       filesystem. The virtual machine is mounted read only, which prevents  damaging  of  the  virtual  machine
       during  the  scan. The evaluation is performed offline which means that it is performed from the host and
       no additional software is installed in the virtual machine.

       <b>oscap-vm</b> is a convenience wrapper on the top of the <b><a href="../man8/oscap.8.html">oscap</a>(8)</b>  utility.  Most  of  the  SCAP  capabilities
       provided by <b><a href="../man8/oscap.8.html">oscap</a>(8)</b> are available in <b>oscap-vm</b> as well.

</pre><h4><b>NOTICE</b></h4><pre>
       To mount the virtual machine filesystem, <b>oscap-vm</b> uses libguestfs to access the filestystem and FUSE (the
       "filesystem in userspace") to make it a mountable device.

       The  tool  requires bash, guestmount, mktemp and umount to work properly. If <b><a href="../man1/guestmount.1.html">guestmount</a>(1)</b> command is not
       present on your system, the tool will try to use older <b><a href="../man1/fusermount.1.html">fusermount</a>(1)</b> utility instead.

</pre><h4><b>USAGE</b></h4><pre>
       Usage of the tool mimics usage and options of <b><a href="../man8/oscap.8.html">oscap</a>(8)</b> tool.

       The type of scan target (either <u>domain</u> or <u>image</u>) has to be specified first. Then identify the  target  by
       the  domain  name  (name of a named libvirt domain) or the image path, respectively.  Domain UUIDs can be
       used instead of names. Any domains including the running domains can be scanned.

       Optionally, as the very first argument, different <b><a href="../man8/oscap.8.html">oscap</a>(8)</b> binary could be chosen to  perform  the  scan,
       like --oscap=&lt;path/to/oscap&gt;.

       The  rest  of  the  options  are passed directly to <b><a href="../man8/oscap.8.html">oscap</a>(8)</b> utility. For the detailed description of its
       options please refer to <b><a href="../man8/oscap.8.html">oscap</a>(8)</b> manual page. However some of its options are not supported  in  <b>oscap-vm</b>
       because offline evaluation is used.

       Last argument is SCAP content input file.

       Supported common options are:
         --verbose &lt;verbosity_level&gt;
         --verbose-log-file &lt;file&gt;

   <b>Evaluation</b> <b>of</b> <b>XCCDF</b> <b>content</b>
       <b>xccdf</b>  <b>eval</b>  module  evaluates XCCDF files or SCAP source data streams. Result of each rule is printed to
       standard output, including rule title, rule id and security identifier (CVE, CCE).

              <b>oscap-vm</b> <b>image</b> <u>VM_STORAGE_IMAGE</u> <b>xccdf</b> <b>eval</b> <u>[options]</u> <u>INPUT_CONTENT</u>
              <b>oscap-vm</b> <b>domain</b> <u>VM_DOMAIN</u> <b>xccdf</b> <b>eval</b> <u>[options]</u> <u>INPUT_CONTENT</u>

       Supported oscap xccdf eval options are:
         --profile &lt;name&gt;
         --rule &lt;name&gt;
         --tailoring-file &lt;file&gt;
         --tailoring-id &lt;component-id&gt;
         --cpe &lt;name&gt; (external OVAL dependencies are not supported yet!)
         --oval-results
         --check-engine-results
         --results &lt;file&gt;
         --results-arf &lt;file&gt;
         --thin-results
         --without-syschar
         --report &lt;file&gt;
         --skip-validation
         --fetch-remote-resources
         --local-files
         --progress
         --datastream-id &lt;id&gt;
         --xccdf-id &lt;id&gt;
         --benchmark-id &lt;id&gt;

       Remediation of virtual machines is not supported.

   <b>Evaluation</b> <b>of</b> <b>OVAL</b> <b>content</b>
       <b>oval</b> <b>eval</b> module scans the system and evaluate definitions from given OVAL Definitions file.

              <b>oscap-vm</b> <b>image</b> <u>VM_STORAGE_IMAGE</u> <b>oval</b> <b>eval</b> <u>[options]</u> <u>INPUT_CONTENT</u>
              <b>oscap-vm</b> <b>domain</b> <u>VM_DOMAIN</u> <b>oval</b> <b>eval</b> <u>[options]</u> <u>INPUT_CONTENT</u>

       Supported oscap oval eval options are:
         --id &lt;definition-id&gt;
         --variables &lt;file&gt;
         --directives &lt;file&gt;
         --without-syschar
         --results &lt;file&gt;
         --report &lt;file&gt;
         --skip-validation
         --datastream-id &lt;id&gt;
         --oval-id &lt;id&gt;

   <b>Collection</b> <b>of</b> <b>OVAL</b> <b>System</b> <b>Characteristic</b>
       <b>oval</b> <b>collect</b> module scans the system and collects items according to given OVAL Definitions file.

              <b>oscap-vm</b> <b>image</b> <u>VM_STORAGE_IMAGE</u> <b>oval</b> <b>collect</b> <u>[options]</u> <u>INPUT_CONTENT</u>
              <b>oscap-vm</b> <b>domain</b> <u>VM_DOMAIN</u> <b>oval</b> <b>collect</b> <u>[options]</u> <u>INPUT_CONTENT</u>

       Supported oscap oval collect options are:
         --id &lt;object&gt;
         --syschar &lt;file&gt;
         --variables &lt;file&gt;
         --skip-validation

</pre><h4><b>EXAMPLES</b></h4><pre>
       Evaluate a Red Hat Enterprise Linux 7 virtual domain for compliance  with  the  DISA  STIG  for  Red  Hat
       Enterprise Linux and generate a report.

              oscap-vm domain rhel7 xccdf eval \
              --report report.html --results results.xml \
              --profile stig-rhel7-disa \
              /usr/share/xml/scap/ssg/content/ssg-rhel7-ds.xml

       Evaluate  a  Red  Hat  Enterprise  Linux  6 virtual machine image for software vulnerabilities using OVAL
       definitions and generate a report.

              oscap-vm image /var/lib/libvirt/images/rhel6.qcow2 oval eval \
              --report report.html --results results.xml \
              com.redhat.rhsa-RHEL6.xml

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       Normally, the exit status is 0 when operation finished successfully and 1 otherwise. In cases when oscap-
       vm performs evaluation of the system it may return 2 indicating success of the operation but incompliance
       of the assessed system.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Please report bugs using https://github.com/OpenSCAP/openscap/issues

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/oscap.8.html">oscap</a>(8), <a href="../man8/scap-security-guide.8.html">scap-security-guide</a>(8)

       For detailed information please visit OpenSCAP website: https://www.open-scap.org

</pre><h4><b>AUTHORS</b></h4><pre>
       Martin Preisler &lt;<a href="mailto:mpreisle@redhat.com">mpreisle@redhat.com</a>&gt;
       Jan Černý &lt;<a href="mailto:jcerny@redhat.com">jcerny@redhat.com</a>&gt;

Red Hat, Inc.                                    September 2017                                      <u><a href="../man8/oscap-vm.8.html">oscap-vm</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>