<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cryptsetup-luksFormat - initialize a LUKS partition and set the initial passphrase</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/cryptsetup-bin">cryptsetup-bin_2.7.5-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cryptsetup-luksFormat - initialize a LUKS partition and set the initial passphrase

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>cryptsetup</b> <u>luksFormat</u> <b>[&lt;options&gt;]</b> <b>&lt;device&gt;</b> <b>[&lt;key</b> <b>file&gt;]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Initializes a LUKS partition and sets the initial passphrase (for key-slot 0), either via prompting or
       via &lt;key file&gt;. Note that if the second argument is present, then the passphrase is taken from the file
       given there, without the need to use the --key-file option. Also note that for both forms of reading the
       passphrase from a file you can give '-' as file name, which results in the passphrase being read from
       stdin and the safety-question being skipped.

       You cannot call luksFormat on a device or filesystem that is mapped or in use, e.g., mounted filesystem,
       used in LVM, active RAID member, etc. The device or filesystem has to be un-mounted in order to call
       luksFormat.

       To use specific version of LUKS format, use <u>--type</u> <u>luks1</u> or <u>type</u> <u>luks2</u>.

       To use OPAL hardware encryption on a self-encrypting drive, use <u>--hw-opal</u> or <u>--hw-opal-only</u>. Note that
       some OPAL drives can require a PSID reset (with possible deletion of data) before using the LUKS format
       with OPAL options. See  <u>--hw-opal-factory-reset</u> option in cryptsetup <u>erase</u> command.

       <b>&lt;options&gt;</b> can be [--hash, --cipher, --verify-passphrase, --key-size, --key-slot, --key-file (takes
       precedence over optional second argument), --keyfile-offset, --keyfile-size, --use-random, --use-urandom,
       --uuid, --volume-key-file, --iter-time, --header, --pbkdf-force-iterations, --force-password,
       --disable-locks, --timeout, --type, --offset, --align-payload (deprecated)].

       For LUKS2, additional <b>&lt;options&gt;</b> can be [--integrity, --integrity-no-wipe, --sector-size, --label,
       --subsystem, --pbkdf, --pbkdf-memory, --pbkdf-parallel, --disable-locks, --disable-keyring,
       --luks2-metadata-size, --luks2-keyslots-size, --keyslot-cipher, --keyslot-key-size,
       --integrity-legacy-padding, --hw-opal, --hw-opal-only].

       <b>WARNING:</b> Doing a luksFormat on an existing LUKS container will make all data in the old container
       permanently irretrievable unless you have a header backup.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--align-payload</b> <b>&lt;number</b> <b>of</b> <b>512</b> <b>byte</b> <b>sectors&gt;</b>
           Align payload at a boundary of <u>value</u> 512-byte sectors.

           If not specified, cryptsetup tries to use the topology info provided by the kernel for the underlying
           device to get the optimal alignment. If not available (or the calculated value is a multiple of the
           default) data is by default aligned to a 1MiB boundary (i.e. 2048 512-byte sectors).

           For a detached LUKS header, this option specifies the offset on the data device. See also the
           --header option.

           <b>WARNING:</b> This option is DEPRECATED and has often unexpected impact to the data offset and keyslot
           area size (for LUKS2) due to the complex rounding. For fixed data device offset use <u>--offset</u> option
           instead.

       <b>--batch-mode,</b> <b>-q</b>
           Suppresses all confirmation questions. Use with care!

           If the --verify-passphrase option is not specified, this option also switches off the passphrase
           verification.

       <b>--cipher,</b> <b>-c</b> <u>&lt;cipher-spec&gt;</u>
           Set the cipher specification string.

           <u>cryptsetup</u> <u>--help</u> shows the compiled-in defaults.

           If a hash is part of the cipher specification, then it is used as part of the IV generation. For
           example, ESSIV needs a hash function, while "plain64" does not and hence none is specified.

           For XTS mode you can optionally set a key size of 512 bits with the -s option. Key size for XTS mode
           is twice that for other modes for the same security level.

       <b>--debug</b> <b>or</b> <b>--debug-json</b>
           Run in debug mode with full diagnostic logs. Debug output lines are always prefixed by <b>#</b>.

           If --debug-json is used, additional LUKS2 JSON data structures are printed.

       <b>--disable-blkid</b>
           Disable use of blkid library for checking and wiping on-disk signatures.

       <b>--disable-keyring</b>
           Do not load volume key in kernel keyring and store it directly in the dm-crypt target instead. This
           option is supported only for the LUKS2 type.

       <b>--disable-locks</b>
           Disable lock protection for metadata on disk. This option is valid only for LUKS2 and ignored for
           other formats.

           <b>WARNING:</b> Do not use this option unless you run cryptsetup in a restricted environment where locking
           is impossible to perform (where <a href="file:/run">/run</a> directory cannot be used).

       <b>--force-password</b>
           Do not use password quality checking for new LUKS passwords.

           This option is ignored if cryptsetup is built without password quality checking support.

           For more info about password quality check, see the manual page for <b><a href="../man5/pwquality.conf.5.html">pwquality.conf</a>(5)</b> and
           <b><a href="../man5/passwdqc.conf.5.html">passwdqc.conf</a>(5)</b>.

       <b>--hash,</b> <b>-h</b> <u>&lt;hash-spec&gt;</u>
           Specifies the hash used in the LUKS key setup scheme and volume key digest. The specified hash is
           used for PBKDF2 and AF splitter.

           The hash algorithm must provide at least 160 bits of output. Do not use a non-crypto hash like <b>xxhash</b>
           as this breaks security. Use <u>cryptsetup</u> <u>--help</u> to show the defaults.

       <b>--header</b> <b>&lt;device</b> <b>or</b> <b>file</b> <b>storing</b> <b>the</b> <b>LUKS</b> <b>header&gt;</b>
           Use a detached (separated) metadata device or file where the LUKS header is stored. This option
           allows one to store ciphertext and LUKS header on different devices.

           With a file name as the argument to --header, the file will be automatically created if it does not
           exist. See the cryptsetup FAQ for header size calculation.

           The --align-payload option is taken as absolute sector alignment on ciphertext device and can be
           zero.

       <b>--help,</b> <b>-?</b>
           Show help text and default parameters.

       <b>--hw-opal</b>
           Format LUKS2 device with dm-crypt encryption stacked on top HW based encryption configured on SED
           OPAL locking range. This option enables both SW and HW based data encryption.

       <b>--hw-opal-only</b>
           Format LUKS2 device with HW based encryption configured on SED OPAL locking range only. LUKS2 format
           only manages locking range unlock key. This option enables HW based data encryption managed by SED
           OPAL drive only.

           <b>NOTE</b>: Please note that with OPAL-only (--hw-opal-only) encryption, the configured OPAL administrator
           PIN (passphrase) allows unlocking all configured locking ranges without LUKS keyslot decryption
           (without knowledge of LUKS passphrase). Because of many observed problems with compatibility,
           cryptsetup currently DOES NOT use OPAL single-user mode, which would allow such decoupling of OPAL
           admin PIN access.

       <b>--integrity</b> <b>&lt;integrity</b> <b>algorithm&gt;</b>
           Specify integrity algorithm to be used for authenticated disk encryption in LUKS2.

           <b>WARNING:</b> <b>This</b> <b>extension</b> <b>is</b> <b>EXPERIMENTAL</b> and requires dm-integrity kernel target (available since
           kernel version 4.12). For native AEAD modes, also enable "User-space interface for AEAD cipher
           algorithms" in "Cryptographic API" section (CONFIG_CRYPTO_USER_API_AEAD .config option).

           For more info, see <u>AUTHENTICATED</u> <u>DISK</u> <u>ENCRYPTION</u> section in <b><a href="../man8/cryptsetup.8.html">cryptsetup</a></b>(8).

       <b>--integrity-legacy-padding</b>
           Use inefficient legacy padding.

           <b>WARNING</b>: Do not use this option until you need compatibility with specific old kernel.

       <b>--integrity-no-wipe</b>
           Skip wiping of device authentication (integrity) tags. If you skip this step, sectors will report
           invalid integrity tag until an application write to the sector.

           <b>NOTE:</b> Even some writes to the device can fail if the write is not aligned to page size and page-cache
           initiates read of a sector with invalid integrity tag.

       <b>--iter-time,</b> <b>-i</b> <b>&lt;number</b> <b>of</b> <b>milliseconds&gt;</b>
           The number of milliseconds to spend with PBKDF passphrase processing. Specifying 0 as parameter
           selects the compiled-in default.

       <b>--key-file,</b> <b>-d</b> <u>name</u>
           Read the passphrase from file.

           If the name given is "-", then the passphrase will be read from stdin. In this case, reading will not
           stop at newline characters.

           See section <u>NOTES</u> <u>ON</u> <u>PASSPHRASE</u> <u>PROCESSING</u> in <b><a href="../man8/cryptsetup.8.html">cryptsetup</a></b>(8) for more information.

       <b>--keyfile-offset</b> <u>value</u>
           Skip <u>value</u> bytes at the beginning of the key file.

       <b>--keyfile-size,</b> <b>-l</b> <u>value</u>
           Read a maximum of <u>value</u> bytes from the key file. The default is to read the whole file up to the
           compiled-in maximum that can be queried with --help. Supplying more data than the compiled-in maximum
           aborts the operation.

           This option is useful to cut trailing newlines, for example. If --keyfile-offset is also given, the
           size count starts after the offset.

       <b>--key-size,</b> <b>-s</b> <u>bits</u>
           Sets key size in <u>bits</u>. The argument has to be a multiple of 8. The possible key-sizes are limited by
           the cipher and mode used.

           See <a href="file:/proc/crypto">/proc/crypto</a> for more information. Note that key-size in <a href="file:/proc/crypto">/proc/crypto</a> is stated in bytes.

           This option can be used for <u>open</u> <u>--type</u> <u>plain</u> or <u>luksFormat</u>. All other LUKS actions will use the
           key-size specified in the LUKS header. Use <u>cryptsetup</u> <u>--help</u> to show the compiled-in defaults.

       <b>--key-slot,</b> <b>-S</b> <b>&lt;0-N&gt;</b>
           For LUKS operations that add key material, this option allows you to specify which key slot is
           selected for the new key.

           The maximum number of key slots depends on the LUKS version. LUKS1 can have up to 8 key slots. LUKS2
           can have up to 32 key slots based on key slot area size and key size, but a valid key slot ID can
           always be between 0 and 31 for LUKS2.

       <b>--keyslot-cipher</b> <b>&lt;cipher-spec&gt;</b>
           This option can be used to set specific cipher encryption for the LUKS2 keyslot area.

       <b>--keyslot-key-size</b> <b>&lt;bits&gt;</b>
           This option can be used to set specific key size for the LUKS2 keyslot area.

       <b>--label</b> <b>&lt;LABEL&gt;</b> <b>--subsystem</b> <b>&lt;SUBSYSTEM&gt;</b>
           Set label and subsystem description for LUKS2 device. The label and subsystem are optional fields and
           can be later used in udev scripts for triggering user actions once the device marked by these labels
           is detected.

       <b>--luks2-keyslots-size</b> <b>&lt;size&gt;</b>
           This option can be used to set specific size of the LUKS2 binary keyslot area (key material is
           encrypted there). The value must be aligned to multiple of 4096 bytes with maximum size 128MB. The
           &lt;size&gt; can be specified with unit suffix (for example 128k).

       <b>--luks2-metadata-size</b> <b>&lt;size&gt;</b>
           This option can be used to enlarge the LUKS2 metadata (JSON) area. The size includes 4096 bytes for
           binary metadata (usable JSON area is smaller of the binary area). According to LUKS2 specification,
           only these values are valid: 16, 32, 64, 128, 256, 512, 1024, 2048 and 4096 kB The &lt;size&gt; can be
           specified with unit suffix (for example 128k).

       <b>--offset,</b> <b>-o</b> <b>&lt;number</b> <b>of</b> <b>512</b> <b>byte</b> <b>sectors&gt;</b>
           Start offset in the backend device in 512-byte sectors.

           The --offset option sets the data offset (payload) of data device and must be aligned to 4096-byte
           sectors (must be multiple of 8). This option cannot be combined with --align-payload option.

       <b>--pbkdf</b> <b>&lt;PBKDF</b> <b>spec&gt;</b>
           Set Password-Based Key Derivation Function (PBKDF) algorithm for LUKS keyslot. The PBKDF can be:
           <u>pbkdf2</u> (for PBKDF2 according to RFC2898), <u>argon2i</u> for Argon2i or <u>argon2id</u> for Argon2id (see Argon2
           &lt;https://www.cryptolux.org/index.php/Argon2&gt; for more info).

           For LUKS1, only PBKDF2 is accepted (no need to use this option). The default PBKDF for LUKS2 is set
           during compilation time and is available in <u>cryptsetup</u> <u>--help</u> output.

           A PBKDF is used for increasing dictionary and brute-force attack cost for keyslot passwords. The
           parameters can be time, memory and parallel cost.

           For PBKDF2, only time cost (number of iterations) applies. For Argon2i/id, there is also memory cost
           (memory required during the process of key derivation) and parallel cost (number of threads that run
           in parallel during the key derivation.

           Note that increasing memory cost also increases time, so the final parameter values are measured by a
           benchmark. The benchmark tries to find iteration time (<u>--iter-time</u>) with required memory cost
           <u>--pbkdf-memory</u>. If it is not possible, the memory cost is decreased as well. The parallel cost
           <u>--pbkdf-parallel</u> is constant and is checked against available CPU cores.

           You can see all PBKDF parameters for particular LUKS2 keyslot with <b><a href="../man8/cryptsetup-luksDump.8.html">cryptsetup-luksDump</a></b>(8) command.

           <b>NOTE:</b> If you do not want to use benchmark and want to specify all parameters directly, use
           <u>--pbkdf-force-iterations</u> with <u>--pbkdf-memory</u> and <u>--pbkdf-parallel</u>. This will override the values
           without benchmarking. Note it can cause extremely long unlocking time or cause out-of-memory
           conditions with unconditional process termination. Use only in specific cases, for example, if you
           know that the formatted device will be used on some small embedded system.

           <b>MINIMAL</b> <b>AND</b> <b>MAXIMAL</b> <b>PBKDF</b> <b>COSTS:</b> For <b>PBKDF2</b>, the minimum iteration count is 1000 and maximum is
           4294967295 (maximum for 32bit unsigned integer). Memory and parallel costs are unused for PBKDF2. For
           <b>Argon2i</b> and <b>Argon2id</b>, minimum iteration count (CPU cost) is 4 and maximum is 4294967295 (maximum for
           32bit unsigned integer). Minimum memory cost is 32 KiB and maximum is 4 GiB. (Limited by addressable
           memory on some CPU platforms.) If the memory cost parameter is benchmarked (not specified by a
           parameter) it is always in range from 64 MiB to 1 GiB. The parallel cost minimum is 1 and maximum 4
           (if enough CPUs cores are available, otherwise it is decreased).

       <b>--pbkdf-force-iterations</b> <b>&lt;num&gt;</b>
           Avoid PBKDF benchmark and set time cost (iterations) directly. It can be used for LUKS/LUKS2 device
           only. See <u>--pbkdf</u> option for more info.

       <b>--pbkdf-memory</b> <b>&lt;number&gt;</b>
           Set the memory cost for PBKDF (for Argon2i/id the number represents kilobytes). Note that it is
           maximal value, PBKDF benchmark or available physical memory can decrease it. This option is not
           available for PBKDF2.

       <b>--pbkdf-parallel</b> <b>&lt;number&gt;</b>
           Set the parallel cost for PBKDF (number of threads, up to 4). Note that it is maximal value, it is
           decreased automatically if CPU online count is lower. This option is not available for PBKDF2.

       <b>--progress-frequency</b> <u>seconds</u>
           Print separate line every <u>seconds</u> with wipe progress.

       <b>--progress-json</b>
           Prints progress data in JSON format suitable mostly for machine processing. It prints separate line
           every half second (or based on <u>--progress-frequency</u> value). The JSON output looks as follows during
           progress (except it’s compact single line):

               {
                 "device":"/dev/sda",      // backing device or file
                 "device_bytes":"8192",    // bytes of I/O so far
                 "device_size":"44040192", // total bytes of I/O to go
                 "speed":"126877696",      // calculated speed in bytes per second (based on progress so far)
                 "eta_ms":"2520012",       // estimated time to finish an operation in milliseconds
                 "time_ms":"5561235"       // total time spent in IO operation in milliseconds
               }

           Note on numbers in JSON output: Due to JSON parsers limitations all numbers are represented in a
           string format due to need of full 64bit unsigned integers.

       <b>--sector-size</b> <u>bytes</u>
           Set sector size for use with disk encryption. It must be power of two and in range 512 - 4096 bytes.
           This option is available only with LUKS2 format.

           For LUKS2 devices it’s established based on parameters provided by underlying data device. For native
           4K block devices it’s 4096 bytes. For 4K/512e (4K physical sector size with 512 bytes emulation) it’s
           4096 bytes. For drives reporting only 512 bytes block size it remains 512 bytes. If data device is
           regular file put in filesystem it’s 4096 bytes.

           Note that if sector size is higher than underlying device hardware sector and there is not integrity
           protection that uses data journal, using this option can increase risk on incomplete sector writes
           during a power fail.

           If used together with <u>--integrity</u> option and dm-integrity journal, the atomicity of writes is
           guaranteed in all cases (but it cost write performance - data has to be written twice).

           Increasing sector size from 512 bytes to 4096 bytes can provide better performance on most of the
           modern storage devices and also with some hw encryption accelerators.

       <b>--timeout,</b> <b>-t</b> <b>&lt;number</b> <b>of</b> <b>seconds&gt;</b>
           The number of seconds to wait before timeout on passphrase input via terminal. It is relevant every
           time a passphrase is asked. It has no effect if used in conjunction with --key-file.

           This option is useful when the system should not stall if the user does not input a passphrase, e.g.
           during boot. The default is a value of 0 seconds, which means to wait forever.

       <b>--type</b> <b>&lt;device-type&gt;</b>
           Specifies required device type, for more info read <u>BASIC</u> <u>ACTIONS</u> section in <b><a href="../man8/cryptsetup.8.html">cryptsetup</a></b>(8).

       <b>--usage</b>
           Show short option help.

       <b>--use-random</b>, <b>--use-urandom</b>
           For <u>luksFormat</u> these options define which kernel random number generator will be used to create the
           volume key (which is a long-term key).

           See <b>NOTES</b> <b>ON</b> <b>RANDOM</b> <b>NUMBER</b> <b>GENERATORS</b> in <b><a href="../man8/cryptsetup.8.html">cryptsetup</a></b>(8) for more information. Use <u>cryptsetup</u> <u>--help</u> to
           show the compiled-in default random number generator.

           <b>WARNING:</b> In a low-entropy situation (e.g. in an embedded system) and older kernels, both selections
           are problematic. Using /dev/urandom can lead to weak keys. Using /dev/random can block a long time,
           potentially forever, if not enough entropy can be harvested by the kernel.

       <b>--uuid</b> <b>&lt;UUID&gt;</b>
           Use the provided <u>UUID</u> for the <u>luksFormat</u> command instead of generating a new one. Changes the
           existing <u>UUID</u> when used with the <u>luksUUID</u> command.

           The <u>UUID</u> must be provided in the standard UUID format, e.g. 12345678-1234-1234-1234-123456789abc.

       <b>--verify-passphrase,</b> <b>-y</b>
           When interactively asking for a passphrase, ask for it twice and complain if both inputs do not
           match. Ignored on input from file or stdin.

       <b>--version,</b> <b>-V</b>
           Show the program version.

       <b>--volume-key-file,</b> <b>--master-key-file</b> <b>(OBSOLETE</b> <b>alias)</b>
           Use a volume key stored in a file. <b>WARNING:</b> If you create your own volume key, you need to make sure
           to do it right. Otherwise, you can end up with a low-entropy or otherwise partially predictable
           volume key which will compromise security.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs at <b>cryptsetup</b> <b>mailing</b> <b>list</b> &lt;<a href="mailto:cryptsetup@lists.linux.dev">cryptsetup@lists.linux.dev</a>&gt; or in <b>Issues</b> <b>project</b> <b>section</b>
       &lt;https://gitlab.com/cryptsetup/cryptsetup/-/issues/new&gt;.

       Please attach output of the failed command with --debug option added.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>Cryptsetup</b> <b>FAQ</b> &lt;https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions&gt;

       <b><a href="../man8/cryptsetup.8.html">cryptsetup</a></b>(8), <b><a href="../man8/integritysetup.8.html">integritysetup</a></b>(8) and <b><a href="../man8/veritysetup.8.html">veritysetup</a></b>(8)

</pre><h4><b>CRYPTSETUP</b></h4><pre>
       Part of <b>cryptsetup</b> <b>project</b> &lt;https://gitlab.com/cryptsetup/cryptsetup/&gt;.

cryptsetup 2.7.5                                   2025-02-18                           <u><a href="../man8/CRYPTSETUP-LUKSFORMAT.8.html">CRYPTSETUP-LUKSFORMAT</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>