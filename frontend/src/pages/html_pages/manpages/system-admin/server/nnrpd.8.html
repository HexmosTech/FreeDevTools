<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nnrpd - NNTP server for reader clients</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/inn2">inn2_2.7.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nnrpd - NNTP server for reader clients

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>nnrpd</b> [<b>-BDfnoSt</b>] [<b>-4</b> <u>address</u>] [<b>-6</b> <u>address</u>] [<b>-b</b> <u>address</u>] [<b>-c</b> <u>configfile</u>] [<b>-i</b> <u>initial</u>] [<b>-I</b> <u>instance</u>] [<b>-p</b>
       <u>port</u>] [<b>-P</b> <u>prefork</u>] [<b>-r</b> <u>reason</u>] [<b>-s</b> <u>padding</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>nnrpd</b> is an NNTP server for newsreaders.  It accepts commands on its standard input and responds on its
       standard output.  It is normally invoked by <a href="../man8/innd.8.html">innd</a>(8) with those descriptors attached to a remote client
       connection.  <b>nnrpd</b> also supports running as a standalone daemon.

       Unlike <a href="../man8/innd.8.html">innd</a>(8), <b>nnrpd</b> supports all NNTP commands for user-oriented reading and posting.  <b>nnrpd</b> uses the
       <u>readers.conf</u> file to control who is authorized to access the Usenet database.

       On exit, <b>nnrpd</b> will report usage statistics through <a href="../man3/syslog.3.html">syslog</a>(3).

       <b>nnrpd</b> is run from <b>innd</b> (the default) or from <a href="../man8/inetd.8.html">inetd</a>(8), <a href="../man8/xinetd.8.html">xinetd</a>(8), or some equivalent.  As often as not,
       it is also run as a daemon, with the <b>-D</b> option, to provide TLS support on a dedicated port.

       <b>nnrpd</b> only reads config files (<u>readers.conf</u>, <u>inn.conf</u> and <u>inn-secrets.conf</u>) when it is spawned.  You can
       therefore never change the behaviour of a client that's already connected.  As a new <b>nnrpd</b> process is
       spawned for every connection, any changes to these configuration files will be immediately effective for
       all new connections.  There's only one exception: when <b>nnrpd</b> is run as a daemon with the <b>-D</b> option, any
       configuration changes in <u>inn.conf</u> won't take effect until <b>nnrpd</b> is restarted.

       The <u>inn.conf</u> setting <u>nnrpdflags</u> can be used to pass any of the options below to instances of <b>nnrpd</b> that
       are spawned directly from <b>innd</b>.  Many options only make sense when <b>-D</b> is used, so these options should
       not be used with <u>nnrpdflags</u>.  See also the discussion of <u>nnrpdflags</u> in <a href="../man5/inn.conf.5.html">inn.conf</a>(5).

       When <u>nnrpdloadlimit</u> in <u>inn.conf</u> is not "0", it will also reject connections if the load average is
       greater than that value (typically "16").  <b>nnrpd</b> can also prevent high-volume posters from abusing your
       resources.  See the discussion of exponential backoff in <a href="../man5/inn.conf.5.html">inn.conf</a>(5).

       <b>nnrpd</b> injects articles into the local server running <b>innd</b> through a UNIX domain socket, or an INET domain
       socket if not supported.  If another server should be used for injection, you can set it with the
       <u>nnrpdposthost</u> parameter in <u>inn.conf</u>.  In case authentication credentials are requested during the
       injection, <b>nnrpd</b> will use the <u>passwd.nntp</u> file in <u>pathetc</u>.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-4</b> <u>address</u>
           The  <b>-4</b>  parameter instructs <b>nnrpd</b> to bind to the specified IPv4 address when started as a standalone
           daemon using the <b>-D</b> flag.  This has to be a valid IPv4 address belonging to an interface of the local
           host.  It can also be "0.0.0.0", saying to bind to all addresses (this is the default).

       <b>-6</b> <u>address</u>
           The <b>-6</b> parameter instructs <b>nnrpd</b> to bind to the specified IPv6 address when started as  a  standalone
           daemon using the <b>-D</b> flag.  This has to be a valid IPv6 address belonging to an interface of the local
           host.  It can also be "::0", saying to bind to all IPv6 addresses.

           By  default, <b>nnrpd</b> in daemon mode listens to both IPv4 and IPv6 addresses.  With this option, it will
           listen only to the specified IPv6 addresses.  On some systems however, a value of "::0" will cause it
           to listen to all IPv4 addresses as well.

       <b>-b</b> <u>address</u>
           Similar to the <b>-4</b> flag.  <b>-b</b> is kept for backwards compatibility.

       <b>-B</b>  If specified, <b>nnrpd</b> will report login attempts to <a href="../man8/blacklistd.8.html">blacklistd</a>(8) for automatic blocking after a number
           of failed attempts.  To use this flag, the blacklist library must have been found at configure  time,
           or  <b>--with-blacklist</b>  specified  at  configure  time.  For more information, see "BLACKLISTD SUPPORT"
           below.

       <b>-c</b> <u>configfile</u>
           By default, <b>nnrpd</b> reads  the  <u>readers.conf</u>  configuration  file  to  determine  how  to  authenticate
           connections.  The <b>-c</b> flag specifies an alternate file for this purpose.  If the file name isn't fully
           qualified,  it  is  taken  to  be  relative  to <u>pathetc</u> in <u>inn.conf</u>.  (This is useful to have several
           instances of <b>nnrpd</b> running on different ports or IP addresses with different settings.)

       <b>-D</b>  If specified, this parameter causes <b>nnrpd</b> to operate as a daemon.  That is, it  detaches  itself  and
           runs  in  the  background,  forking a process for every connection.  By default, <b>nnrpd</b> listens on the
           NNTP port (119), so either <a href="../man8/innd.8.html">innd</a>(8) has to be started on another port or the <b>-p</b> parameter used.   Note
           that  with  this  parameter, <b>nnrpd</b> continues running until killed.  This means that it reads <u>inn.conf</u>
           once on startup and never again until restarted.  <b>nnrpd</b> should therefore be restarted if <u>inn.conf</u>  is
           changed.

           When started in daemon mode, <b>nnrpd</b> will write its PID into a file in the <u>pathrun</u> directory.  The file
           will  be  named  <u>nnrpd.pid</u>  if  <b>nnrpd</b>  listens  on port 119 (default), or <u>nnrpd-%d.pid</u>, where "%d" is
           replaced with the port that <b>nnrpd</b> is configured to listen on (<b>-p</b> option is given and its argument  is
           not "119").

           You may also want to use <b>-s</b> when running <b>nnrpd</b> as a daemon.

       <b>-f</b>  If  specified,  <b>nnrpd</b>  does not detach itself and runs in the foreground when started as a standalone
           daemon using the <b>-D</b> flag.

       <b>-i</b> <u>initial</u>
           Specify an initial command to <b>nnrpd</b>.  When used, <u>initial</u> is taken as if it  were  the  first  command
           received by <b>nnrpd</b>.  After having responded, <b>nnrpd</b> will close the connection.

       <b>-I</b> <u>instance</u>
           If specified, <u>instance</u> is used as an additional static portion within Message-IDs generated by <b>nnrpd</b>,
           when <u>virtualhost</u> is set in access groups in <u>readers.conf</u>; typically this option would be used where a
           cluster of machines exist with the same virtual hostname and must be disambiguated during posts.

       <b>-n</b>  The  <b>-n</b> flag turns off resolution of IP addresses to names.  If you only use IP-based restrictions in
           <u>readers.conf</u> and can handle IP addresses in your logs, using this flag may result in some  additional
           speed.

       <b>-o</b>  The  <b>-o</b> flag causes all articles to be spooled instead of sending them to <a href="../man8/innd.8.html">innd</a>(8).  <b>rnews</b> with the <b>-U</b>
           flag should be invoked from cron on a regular basis to take care of these  articles.   This  flag  is
           useful if <b>innd</b> is accepting articles and <b>nnrpd</b> is started standalone or using <a href="../man8/inetd.8.html">inetd</a>(8).

       <b>-p</b> <u>port</u>
           The  <b>-p</b>  parameter instructs <b>nnrpd</b> to listen on <u>port</u> when started as a standalone daemon using the <b>-D</b>
           flag.

       <b>-P</b> <u>prefork</u>
           The <b>-P</b> parameter instructs <b>nnrpd</b> to prefork <u>prefork</u> children awaiting connections when started  as  a
           standalone daemon using the <b>-D</b> flag.

       <b>-r</b> <u>reason</u>
           If  the  <b>-r</b>  flag  is used, then <b>nnrpd</b> will reject the incoming connection giving <u>reason</u> as the text.
           This flag is used by <a href="../man8/innd.8.html">innd</a>(8) when it is paused or throttled.  <u>reason</u> should be encoded in UTF-8.

       <b>-s</b> <u>padding</u>
           As each command is received from a client, <b>nnrpd</b> tries to change  its  "argv"  array  containing  the
           process title so that commands like <a href="../man1/ps.1.html">ps</a>(1) will print out the hostname of the connected client and the
           command  being  executed.   To  get a full display, the <b>-s</b> flag may be used with a long string as its
           argument, which will be overwritten when <b>nnrpd</b> changes its title.

           When <b>innd</b> spawns <b>nnrpd</b>, this flag is used with an argument made of 48 spaces.

       <b>-S</b>  If specified, <b>nnrpd</b> will start a negotiation for a TLS session as soon as  connected.   To  use  this
           flag,  the OpenSSL SSL and crypto libraries must have been found at configure time, or <b>--with-openssl</b>
           specified at configure time.  For more information on  running  <b>nnrpd</b>  with  TLS  support,  see  "TLS
           SUPPORT".

       <b>-t</b>  If  the  <b>-t</b>  flag is used, then all client commands and initial responses will be traced by reporting
           them in syslog.  This flag is set by <a href="../man8/innd.8.html">innd</a>(8) under the control of the <a href="../man8/ctlinnd.8.html">ctlinnd</a>(8) "trace" command, and
           is toggled upon receipt of a SIGHUP; see <a href="../man2/signal.2.html">signal</a>(2).

</pre><h4><b>TLS</b> <b>SUPPORT</b></h4><pre>
       If INN is built with <b>--with-openssl</b> or if the OpenSSL SSL and crypto libraries  are  found  at  configure
       time,  <b>nnrpd</b>  will  support news reading over TLS (also known as SSL).  For clients that use the STARTTLS
       command, no special configuration is needed beyond creating a TLS/SSL certificate for  the  server.   You
       should do this in exactly the same way that you would generate a certificate for a web server.

       If  you're  happy  with  a  self-signed  certificate  (which will generate warnings with some news reader
       clients), you can create and install one in the default path by running "make cert" after "make  install"
       when installing INN, or by running the following commands:

           umask 077
           openssl req -new -x509 -nodes -out &lt;pathetc&gt;/cert.pem \
               -days 366 -keyout &lt;pathetc&gt;/key.pem
           chown news:news &lt;pathetc&gt;/cert.pem
           chmod 640 &lt;pathetc&gt;/cert.pem
           chown news:news &lt;pathetc&gt;/key.pem
           chmod 600 &lt;pathetc&gt;/key.pem

       Replace  the  paths  with something appropriate to your INN installation.  This will create a self-signed
       certificate that will expire in a year.  The <b>openssl</b> program will ask you a variety  of  questions  about
       your  organization.   Enter  the  fully  qualified  domain  name  of your news service (either the server
       canonical name or a dedicated alias for the news service) as the name the certificate is for.

       You then have to set these <u>inn.conf</u> parameters with the right paths:

           tlscapath:      &lt;pathetc&gt;
           tlscertfile:    &lt;pathetc&gt;/cert.pem
           tlskeyfile:     &lt;pathetc&gt;/key.pem

       If you want to use a complete certificate chain, you can directly put it in  <u>tlscertfile</u>  (like  Apache's
       <u>SSLCertificateFile</u>  directive).   Alternately,  you  can  put a single certificate in <u>tlscertfile</u> and use
       <u>tlscafile</u> for additional certificates needed to complete  the  chain,  like  a  separate  authority  root
       certificate.

       More concretely, when using Let's Encrypt certificates, Certbot's files can be installed as follows:

           tlscapath:      /etc/letsencrypt/live/news.server.com
           tlscertfile:    /etc/letsencrypt/live/news.server.com/fullchain.pem
           tlskeyfile:     /etc/letsencrypt/live/news.server.com/privkey.pem

       or:

           tlscapath:      /etc/letsencrypt/live/news.server.com
           tlscafile:      /etc/letsencrypt/live/news.server.com/chain.pem
           tlscertfile:    /etc/letsencrypt/live/news.server.com/cert.pem
           tlskeyfile:     /etc/letsencrypt/live/news.server.com/privkey.pem

       Make  sure  that  the permission rights are properly set so that the news user or the news group can read
       these directories and  files  (typically,  he  should  access  <u>/etc/letsencrypt/live/news.server.com</u>  and
       <u>/etc/letsencrypt/archive/news.server.com</u>  where the real keys are located, and the private key should not
       be world-readable).

       If you prefer to point to files outside the directory of Let's Encrypt, you may add a  post-renewal  hook
       for Let's Encrypt to copy the generated files to another location, and give them the expected rights.

       There  are  two  common  ways  for  a  news client to negotiate a TLS connection: either via the use of a
       dedicated port (usually 563) on which TLS is immediately negotiated  upon  connection,  or  via  the  now
       discouraged  way  (per  RFC 8143) to use the STARTTLS command on the usual NNTP port (119) to dynamically
       upgrade from unencrypted to TLS-protected traffic during an NNTP session.  <b>innd</b> does not,  however,  know
       how  to listen for connections to that separate port (563).  You will therefore need to arrange for <b>nnrpd</b>
       to listen on that port through some other means.  This can be done with the <b>-D</b> flag along with  "-p  563"
       and put into your init scripts:

           su news -s <a href="file:/bin/sh">/bin/sh</a> -c '&lt;pathbin&gt;/nnrpd -D -p 563 -S'

       but the easiest way is probably to add a line like:

           nntps stream tcp nowait news &lt;pathbin&gt;/nnrpd nnrpd -S

       to  <u>/etc/inetd.conf</u>  or the equivalent on your system and let <b>inetd</b> run <b>nnrpd</b>.  (Change the path to <b>nnrpd</b>
       to match your installation.)  You may need to replace "nntps" with "563"  if  "nntps"  isn't  defined  in
       <u><a href="file:/etc/services">/etc/services</a></u>  on  your system.  You may also want to use the lowercase <b>-s</b> flag with a long string as its
       argument to see more information about incoming connections in <a href="../man1/ps.1.html">ps</a>(1) output.

       Optionally, you may set the <u>tlsciphers</u>, <u>tlsciphers13</u>, <u>tlscompression</u>, <u>tlseccurve</u>, <u>tlspreferserverciphers</u>,
       and <u>tlsprotocols</u> parameters in <u>inn.conf</u> to fine-tune the behaviour of the TLS/SSL negotiation whenever  a
       new attack on the TLS protocol or some supported cipher suite is discovered.

</pre><h4><b>BLACKLISTD</b> <b>SUPPORT</b></h4><pre>
       <a href="../man8/blacklistd.8.html">blacklistd</a>(8) is a FreeBSD/NetBSD daemon for preventing brute force attacks by blocking attackers after a
       number  of  failed  login  attempts.   When  <b>nnrpd</b> is built with blacklistd support, it will report login
       attempts to the blacklistd daemon for potential blocking.

       Adding the configuration below to <u>/etc/blacklistd.conf</u> under the "[local]"  section,  assuming  <b>nnrpd</b>  is
       listening  on  port  563,  would  lead  to  attackers  being  blocked for 10 minutes after 5 failed login
       attempts.

           # adr/mask:port type    proto owner name nfail disable
           563             stream  *     *     *    5     10m

       See the <a href="../man8/blacklistd.8.html">blacklistd</a>(8) documentation for more information.

</pre><h4><b>PROTOCOL</b> <b>DIFFERENCES</b></h4><pre>
       <b>nnrpd</b> implements the NNTP commands defined in RFC 3977 (NNTP), RFC 4642 updated by  RFC 8143  (TLS/NNTP),
       RFC 4643  (NNTP  authentication), RFC 6048 (NNTP LIST additions) and RFC 8054 (NNTP compression) with the
       following differences:

       1.  The XGTITLE [<u>wildmat</u>] command is provided.  This extension is used  by  ANU-News  and  documented  in
           RFC 2980.   It  returns a "282" reply code, followed by a one-line description of all newsgroups that
           match the pattern.  The default is the current group.

           Note that LIST NEWSGROUPS should be used instead of XGTITLE.

       2.  The XHDR <u>header</u> [<u>message-ID</u>|<u>range</u>] command is implemented.  It returns a "221" reply  code,  followed
           by  specific header fields for the specified range; the default is to return the data for the current
           article.  See RFC 2980.

           Note that HDR should be used instead of XHDR.

       3.  The XOVER [<u>range</u>] command is provided.  It returns a "224" reply code, followed by the overview  data
           for the specified range; the default is to return the data for the current article.  See RFC 2980.

           Note that OVER should be used instead of XOVER.

       4.  A  new  command, XPAT <u>header</u> <u>message-ID</u>|<u>range</u> <u>pattern</u> [<u>pattern</u> ...], is provided.  The first argument
           is the case-insensitive name of the header field to be searched.  The second argument  is  either  an
           article  range  or  a  single  message-ID,  as  specified  in  RFC 2980.   The  third  argument  is a
           <u>uwildmat</u>-style pattern; if there are additional arguments, they are joined together  separated  by  a
           single  space to form the complete pattern.  This command is similar to the XHDR command.  It returns
           a "221" response code, followed by the text response of all article numbers that match the pattern.

       5.  A newsgroup name is case-sensitive for <b>nnrpd</b>.

       6.  If IHAVE has been advertised, it will not necessarily be advertised for the entire session  (contrary
           to  section  3.4.1  of  RFC 3977).   <b>nnrpd</b>  only  advertises  the  IHAVE capability when it is really
           available.

       7.  <b>nnrpd</b> allows a wider syntax for wildmats and ranges (especially "-" and "-<u>article-number</u>").

       8.  When keyword generation is used, an experimental feature  enabled  with  the  <u>keywords</u>  parameter  in
           <u>inn.conf</u>,  "Keywords:full"  is  advertised  in  LIST OVERVIEW.FMT even though overview information is
           computed and does not necessarily come from Keywords header fields.

</pre><h4><b>HISTORY</b></h4><pre>
       Written by Rich $alz &lt;<a href="mailto:rsalz@uunet.uu.net">rsalz@uunet.uu.net</a>&gt; for InterNetNews.  Overview support  added  by  Rob  Robertston
       &lt;<a href="mailto:rob@violet.berkeley.edu">rob@violet.berkeley.edu</a>&gt;  and  Rich  in  January, 1993.  Exponential backoff (for posting) added by Dave
       Hayes in Febuary 1998.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/blacklistd.8.html">blacklistd</a>(8), <a href="../man8/ctlinnd.8.html">ctlinnd</a>(8), <a href="../man8/innd.8.html">innd</a>(8), <a href="../man5/inn.conf.5.html">inn.conf</a>(5), <a href="../man5/inn-secrets.conf.5.html">inn-secrets.conf</a>(5), <a href="../man3/libinn_uwildmat.3.html">libinn_uwildmat</a>(3), <a href="../man5/nnrpd.track.5.html">nnrpd.track</a>(5),
       <a href="../man5/passwd.nntp.5.html">passwd.nntp</a>(5), <a href="../man5/readers.conf.5.html">readers.conf</a>(5), <a href="../man2/signal.2.html">signal</a>(2).

INN 2.7.3                                          2025-05-19                                           <u><a href="../man8/NNRPD.8.html">NNRPD</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>