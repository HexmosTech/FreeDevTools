<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pki-server-upgrade - Tool for upgrading PKI server configuration.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/pki-server">pki-server_11.0.0-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pki-server-upgrade - Tool for upgrading PKI server configuration.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>pki-server</b> [<u>CLI-options</u>] <b>upgrade</b> [<u>OPTIONS</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       There  are  two  parts to upgrading PKI server: upgrading the system configuration files used by both the
       client and the server processes and upgrading the server configuration files.

       When upgrading PKI server, the existing server configuration files (e.g. <b>server.xml</b>, <b>web.xml</b>) may need to
       be upgraded because the content may have changed from one version to another.  The configuration  upgrade
       is  executed automatically during RPM upgrade.  However, in case there is a problem, the process can also
       be run manually using <b>pki-server</b> <b>upgrade</b>.

       The server upgrade process is done incrementally using upgrade scriptlets.   A  server  consists  of  the
       server  instance  itself  and  the subsystems running in that instance.  The upgrade process executes one
       scriptlet at a time, running through each component (server  instance  and  subsystem)  in  parallel  and
       completing  before executing the next scriptlet.  If one component encounters an error, that component is
       skipped in the subsequent upgrade scriptlets.  The upgrade  process  and  scriptlet  execution  for  each
       component  is  monitored  in  upgrade  trackers.   A  counter  shows the latest index number for the most
       recently executed scriptlet; when all scriptlets have  run,  the  component  tracker  shows  the  updated
       version number.

       The scriptlets are stored in the upgrade directory:

              /usr/share/pki/server/upgrade/&lt;version&gt;/&lt;index&gt;-&lt;name&gt;

       The  <b>version</b>  is the server version to be upgraded. The <b>index</b> is the script execution order.  The <b>name</b> is
       the scriptlet name.

       During upgrade, the scriptlets will back up all changes to the file system into the following folder:

              /var/log/pki/server/upgrade/&lt;version&gt;/&lt;index&gt;

       The <b>version</b> and <b>index</b> values indicate the scriptlet being executed.  A copy of the files and folders that
       are being modified or removed will be stored in <b>oldfiles</b>.  The names of the newly-added files and folders
       will be stored in <b>newfiles</b>.

       The instance upgrade process is tracked using this file:

              /var/lib/pki/&lt;instance&gt;/conf/tomcat.conf

       The subsystem upgrade process is tracked using this file:

              /var/lib/pki/&lt;instance&gt;/&lt;subsystem&gt;/conf/CS.cfg

       The file stores the current configuration version and the last successful scriptlet index.

</pre><h4><b>OPTIONS</b></h4><pre>
   <b>General</b> <b>options</b>
       <b>--status</b>
           Show upgrade status only <b>without</b> performing the upgrade.

       <b>--revert</b>
           Revert the last version.

       <b>-i</b>, <b>--instance</b> <u>instance</u>
           Upgrade a specific instance only.

       <b>-X</b>
           Show advanced options.

       <b>-v</b>, <b>--verbose</b>
           Run in verbose mode.

       <b>-h</b>, <b>--help</b>
           Show this help message.

   <b>Advanced</b> <b>options</b>
       The advanced options circumvent the normal upgrade process by changing the tracker information.

       <b>WARNING:</b> These options may render the system unusable.

       <b>--remove-tracker</b>
           Remove the tracker.

       <b>--reset-tracker</b>
           Reset the tracker to match the package version.

       <b>--set-tracker</b> <u>version</u>
           Set the tracker to a specific version.

</pre><h4><b>OPERATIONS</b></h4><pre>
   <b>Upgrade</b> <b>process</b>
       To start the upgrade process:

              $ pki-server upgrade

   <b>Upgrade</b> <b>status</b>
       To check the upgrade status:

              $ pki-server upgrade --status

   <b>Troubleshooting</b>
       Check the scriptlet to see which operations are  being  executed.   Once  the  error  is  identified  and
       corrected, the upgrade can be resumed by re-running <b>pki-server</b> <b>upgrade</b>.

       If necessary, the upgrade can be run in verbose mode:

              $ pki-server upgrade --verbose

       It is possible to rerun a failed upgrade for a specific instance:

              $ pki-server upgrade --instance pki-tomcat

   <b>Reverting</b> <b>an</b> <b>upgrade</b>
       If necessary, the upgrade can be reverted:

              $ pki-server upgrade --revert

       Files  and  folders  that  were  created  by  the scriptlet will be removed.  Files and folders that were
       modified or removed by the scriptlet will be restored.

</pre><h4><b>AUTHORS</b></h4><pre>
       Ade  Lee  lt;<a href="mailto:alee@redhat.comgt">alee@redhat.comgt</a>;,  Ella  Deon  Lackey  lt;<a href="mailto:dlackey@redhat.comgt">dlackey@redhat.comgt</a>;,  and   Endi   S.   Dewata
       lt;<a href="mailto:edewata@redhat.comgt">edewata@redhat.comgt</a>;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright  (c)  2013  Red  Hat,  Inc.   This  is licensed under the GNU General Public License, version 2
       (GPLv2).  A copy of this license is available at <a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt">http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt</a>.

PKI                                               Jul 22, 2013                             <u><a href="../man8/pki-server-upgrade.8.html">pki-server-upgrade</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>