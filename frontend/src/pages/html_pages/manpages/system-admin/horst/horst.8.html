<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>horst - Highly Optimized Radio Scanning Tool</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/horst">horst_5.1-3ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       horst - Highly Optimized Radio Scanning Tool

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>horst</b>  [<b>-v</b>]  [<b>-h</b>]  [<b>-q</b>]  [<b>-D</b>]  [<b>-a</b>]  [<b>-c</b> <u>file</u>] [<b>-C</b> <u>channel</u>] [<b>-i</b> <u>interface</u>] [<b>-t</b> <u>sec</u>] [<b>-V</b> <u>view</u>] [<b>-d</b> <u>ms</u>] [<b>-b</b>
       <u>bytes</u>] [<b>-M</b> <u>file</u>] [<b>-s</b>] [<b>-u</b>] [<b>-N</b>] [<b>-n</b> <u>IP</u>] [<b>-p</b> <u>port</u>] [<b>-o</b> <u>file</u>] [<b>-X</b> <u>name</u>] [<b>-x</b> <u>command</u>] [<b>-e</b> <u>mac</u>] [<b>-f</b> <u>pkt_name</u>]
       [<b>-m</b> <u>mode</u>] [<b>-B</b> <u>BSSID</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>horst</b> is a small, lightweight IEEE802.11 wireless LAN analyzer with a text interface. Its basic  function
       is  similar  to  tcpdump,  Wireshark  or  Kismet,  but  it's much smaller and shows different, aggregated
       information which is not easily available from other tools. It is mainly targeted at  debugging  wireless
       LANs with a focus on ad-hoc (IBSS) mode in larger mesh networks. It can be useful to get a quick overview
       of what's going on on all wireless LAN channels and to identify problems.

       • Shows signal values per station.

       • Calculates  channel  utilization  ("usage") by adding up the amount of time the packets actually occupy
         the medium.

       • "Spectrum Analyzer" shows signal levels and usage per channel.

       • Text-based "graphical" packet history, with signal, packet type and physical rate

       • Shows all stations per ESSID and the live TSF per node as it is counting.

       • Detects IBSS "splits" (same ESSID but different BSSID - this is a common driver problem).

       • Statistics of packets/bytes per physical rate and per packet type.

       • Has some support for mesh protocols (OLSR and batman).

       • Can filter specific packet types, source MAC addresses or BSSIDs.

       • Client/server support for monitoring on remote nodes.

       • Can be controlled via a named pipe.

       See MONITOR MODE below for more information about the network interface setup.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-v</b>     Show version.

       <b>-h</b>     Show summary of options.

       <b>-q</b>     Quiet mode. Don't show user interface. This is only useful in conjunction when running  in  server
              mode (-C) or writing to a file (-o).

       <b>-D</b>     Show  lot's  of debugging output, including a full package dump. Only available when compiled with
              DEBUG=1.

       <b>-a</b>     Always add virtual monitor interface. Don't try to set existing interface to monitor mode.

       <b>-c</b> <u>configfile</u>
              Use configfile instead of the default "/etc/horst.conf".

       <b>-C</b> <u>channel</u>
              Set inital channel (number not frequency).

       <b>-i</b> <u>intf</u>
              Operate on the given network interface instead of the default "wlan0".

       <b>-t</b> <u>sec</u> Timeout (remove) nodes after not receiving packets from them for this time in seconds (default: 60
              sec).

       <b>-V</b> <u>view</u>
              Display  'view'.  Valid  view  names  are  "history",  "hist",  "essid",  "statistics",   "stats",
              "spectrum", "spec".

       <b>-d</b> <u>ms</u>  Display  update interval. The default value of 100ms can be increased to reduce CPU load caused by
              redrawing the screen.

       <b>-b</b> <u>bytes</u>
              Receive buffer size. The receive buffer size can be set to tune memory consumption and reduce lost
              packets under load.

       <b>-M</b> <u>filename</u>
              MAC address to host name mapping file. The file can either be a dhcp.leases file from  dnsmasq  or
              contain  mappings  in  the  form  "MAC&lt;space&gt;name"  (e.g.:  "00:01:02:03:04:05 test") line by line
              (default filename: /tmp/dhcp.leases).

       <b>-s</b>     Show a poor mans "spectrum analyzer". The same can be achieved by  running  <b>horst</b>  as  normal  and
              pressing the button 's' (Spec); then 'c' (Chan) and 'a' (Automatically change channel).

       <b>-u</b>     Upper channel limit for the automatic channel change.

       <b>-N</b>     Allow  client  connections.  Server  mode.  Only  one client connection is supported at the moment
              (default: off).

       <b>-n</b> <u>IP</u>  Connect to a <b>horst</b> instance running in server-mode at the specified IP address.

       <b>-p</b> <u>port</u>
              Use the specified port (default: 4444) for client/server connections.

       <b>-o</b> <u>filename</u>
              Write a information about each received packet into file. Note that you  can  send  to  STDOUT  by
              using <b>-o</b> <b>/dev/stdout</b>. See OUTPUT FILE FORMAT below.

       <b>-X</b>     Accept control commands on a named pipe (default /tmp/horst).

       <b>-X</b> <u>name</u>
              Accept control commands on a named pipe with given name or set pipe name used with -x.

       <b>-x</b> <u>command</u>
              Send  control  command  to  another  <b>horst</b> process who was started with -X and then exit. Multiple
              commands can be concatenated with ';'. Currently implemented commands are:

              pause  Pause <b>horst</b> processing

              resume Resume <b>horst</b> processing

              reset  Reset all history, statistics and views

              channel=X
                     Set channel channel number

              channel_scan=X
                     Automatically change channels (1 or 0)

              channel_dwell=X
                     Set channel dwell time when automatically changing channel (ms)

              channel_upper=X
                     Set max channel when automatically changing channel

              outfile=X
                     Write to outfile named X. If the file is already open, it is cleared  and  re-openend.   If
                     filename is not specified ("outfile=") any existing file is closed and no file is written.

       <b>-e</b> <u>MAC</u> Filter  all  MAC  addresses  except these, to show only packets originating from the specified MAC
              addresses. This option can be specified multiple times.

       <b>-f</b> <u>pkt_type</u>
              Filter all packets except these. This option can be specified multiple  times.  For  valid  packet
              names see NAMES AND ABBREVIATIONS below.

       <b>-m</b> <u>(AP|STA|ADH|PRB|WDS|UNKNOWN)</u>
              Only show/include packets and nodes of this mode. Note that the mode is infered by the information
              of  packets we received and it may take some time until a node is properly classified. This option
              can be specified multiple times.

       <b>-B</b> <u>BSSID</u>
              Only show/include packets which belong to the given BSSID.

</pre><h4><b>TEXT</b> <b>USER</b> <b>INTERFACE</b></h4><pre>
       The ncurses-based text interface tries to display a lot of information,  so  it  may  look  confusing  at
       first. Below we describe the different screens and options.

       Main screen

              The  initial  (main)  screen  is split into three parts. The upper area shows a list of aggregated
              "node" information, the most useful information about each sender which was  discovered,  one  per
              line:

                     <b>/</b>      "Spinner" to show activity

                     <b>Pk</b>     Percentage of this node's packets in relation to all received packets

                     <b>Re%</b>    Percentage of retried frames of all frames this node sent

                     <b>Cha</b>    Channel number

                     <b>Sig</b>    Signal value (RSSI) in dBm

                     <b>RAT</b>    Physical data rate

                     <b>TRANSMITTER</b>
                            MAC address of sender

                     <b>MODE</b>   Operating Mode (AP, AHD, PRB, STA, WDS), see "NAMES AND ABBREVIATIONS"

                     <b>ENCR</b>   Encryption (WPA1, WPA2, WEP)

                     <b>ESSID</b>  ESSID

                     <b>INFO</b>   Additional info like "BATMAN", IP address...

              The lower area shows a scrolling list of packets as they come in:

                     <b>Cha</b>    Channel number

                     <b>Sig</b>    Signal value (RSSI) in dBm

                     <b>RAT</b>    Physical data rate

                     <b>TRANSMITTER</b>
                            MAC address of sender

                     <b>BSSID</b>  BSSID

                     <b>TYPE</b>   Packet type, see "NAMES AND ABBREVIATIONS"

                     <b>INFO</b>   Additional info like ESSID, TFS, IP address...

              The lower right box shows bar graphs for:

                     <b>Signal</b> of last received packet in green

                     <b>bps</b>    Bits per second of all received packets

                     <b>Usage</b>  Percentage of channel use

              The  lower  edge  is  the menu and status bar, it shows which keys to press for other screens. The
              status shows "&gt;" when <b>horst</b> is running or "=" when it is paused, then "F" when any kind of  filter
              is active, the Channel, the monitor interface in use and the time.

       Pause ('p' or &lt;space&gt;)

              Can be used to pause/resume <b>horst</b>. When <b>horst</b> is paused it will loose packets received in the mean
              time.

       Reset ('r')

              Clears all history and aggregated statistical data.

       History ('h')

              The  history  screen  scrolls  from  right  to left and shows a bar for each packet indicating the
              signal level. In the line below that, the packet type is indicated by one character (See NAMES AND
              ABBREVIATIONS below) and the rough physical data rate is indicated below that in blue.

       ESSID ('e')

              The ESSID screen groups information by ESSID and shows the mode (AP, IBSS), the MAC address of the
              sender, the BSSID, the TSF, the beacon interval, the channel, the signal, a "W" when encrytoion is
              used and the IP address if known.

       Statistics ('a')

              The statistics screen groups packets by physical rate and by packet type and shows other kinds  of
              aggregated and statistical information based on packets.

       Spectrum Analyzer ('s')

              The  "poor  mans spectrum analyzer" screen is only really useful when <b>horst</b> is started with the -s
              option or the "Automatically change channel" option is selected in the  "Chan"  settings,  or  the
              config option channel_scan is set.

              It shows the available channels horizontally and vertical bars for each channel:

                     <b>Signal</b> in green

                     <b>Physical</b> rate in blue

                     <b>Channel</b> usage in orange/brown

       By pressing the 'n' key, the display can be changed to show only the average signal level on each channel
       and  the  last  4  digits  of  the  MAC  address  of the individual nodes at the level (height) they were
       received. This can give a quick graphical overview of the distance of nodes.

       Filters ('f')

              This configuration dialog can be used to define the active filters.

       Channel Settings ('c')

              This configuration dialog can be used to change the channel changing  behaviour  of  <b>horst</b>  or  to
              change to a different channel manually.

       Sort ('o')

              Only  active  in  the  main screen, can be used to sort the node list in the upper area by Signal,
              Time, BSSID or Channel.

</pre><h4><b>NAMES</b> <b>AND</b> <b>ABBREVIATIONS</b></h4><pre>
       802.11 standard frames

                       <b>Management</b> <b>frames</b>
              ──┬────────┬────────────────────────
              a │ ASOCRQ │ Association request
              A │ ASOCRP │ Associaion response
              a │ REASRQ │ Reassociation request
              A │ REASRP │ Reassociation response
              p │ PROBRQ │ Probe request
              P │ PROBRP │ Probe response
              T │ TIMING │ Timing Advertisement
              B │ BEACON │ Beacon
              t │ ATIM   │ ATIM
              D │ DISASC │ Disassociation
              u │ AUTH   │ Authentication
              U │ DEAUTH │ Deauthentication
              C │ ACTION │ Action
              c │ ACTNOA │ Action No Ack

                      <b>Control</b> <b>frames</b>
              ──┬────────┬───────────────────
              w │ CTWRAP │ Control Wrapper
              b │ BACKRQ │ Block Ack Request
              B │ BACK   │ Block Ack
              s │ PSPOLL │ PS-Poll
              R │ RTS    │ RTS
              C │ CTS    │ CTS
              K │ ACK    │ ACK
              f │ CFEND  │ CF-End
              f │ CFENDK │ CF-End + CF-Ack

                              <b>Data</b> <b>frames</b>
              ──┬────────┬────────────────────────────────
              D │ DATA   │ Data
              F │ DCFACK │ Data + CF-Ack
              F │ DCFPLL │ Data + CF-Poll
              F │ DCFKPL │ Data + CF-Ack + CF-Poll
              n │ NULL   │ Null (no data)
              f │ CFACK  │ CF-Ack (no data)
              f │ CFPOLL │ CF-Poll (no data)
              f │ CFCKPL │ CF-Ack + CF-Poll (no data)
              Q │ QDATA  │ QoS Data
              F │ QDCFCK │ QoS Data + CF-Ack
              F │ QDCFPL │ QoS Data + CF-Poll
              F │ QDCFKP │ QoS Data + CF-Ack + CF-Poll
              N │ QDNULL │ QoS Null (no data)
              f │ QCFPLL │ QoS CF-Poll (no data)
              f │ QCFKPL │ QoS CF-Ack + CF-Poll (no data)
              * │ BADFCS │ Bad frame checksum

       Packet types

              Similar to 802.11 frames above but higher level and as a bit field (types can overlap, e.g. DATA +
              IP) and including more information, like IP, ARP, BATMAN, OLSR...

                                       <b>Packet</b> <b>types</b>
              ───────┬──────────┬────────────────────────────────────────────
              CTRL   │ 0x000001 │ WLAN Control frame
              MGMT   │ 0x000002 │ WLAN Management frame
              DATA   │ 0x000004 │ WLAN Data frame
              BADFCS │ 0x000008 │ WLAN frame checksum (FCS) bad
              BEACON │ 0x000010 │ WLAN beacon frame
              PROBE  │ 0x000020 │ WLAN probe request or response
              ASSOC  │ 0x000040 │ WLAN associaction request/response frame
              AUTH   │ 0x000080 │ WLAN authentication frame
              RTSCTS │ 0x000100 │ WLAN RTS or CTS
              ACK    │ 0x000200 │ WLAN ACK or BlockACK
              NULL   │ 0x000400 │ WLAN NULL Data frame
              QDATA  │ 0x000800 │ WLAN QoS Data frame (WME/WMM)
              ARP    │ 0x001000 │ ARP packet
              IP     │ 0x002000 │ IP packet
              ICMP   │ 0x004000 │ IP ICMP packet
              UDP    │ 0x008000 │ IP UDP
              TCP    │ 0x010000 │ IP TCP
              OLSR   │ 0x020000 │ OLSR protocol
              BATMAN │ 0x040000 │ BATMAND Layer3 or BATMAN-ADV Layer 2 frame
              MESHZ  │ 0x080000 │ MeshCruzer protocol

       Operating modes

              Bit field of operating mode type which is infered from received packets. Modes may  overlap,  i.e.
              it is common to see STA and PRB at the same time.

                            <b>Operating</b> <b>modes</b>
              ────────┬──────┬─────────────────────────────
              AP      │ 0x01 │ Access Point (AP)
              ADH     │ 0x02 │ Ad-hoc node
              STA     │ 0x04 │ Station (AP client)
              PRB     │ 0x08 │ Sent PROBE requests
              WDS     │ 0x10 │ WDS or 4 Address frames
              UNKNOWN │ 0x20 │ Unknown e.g. RTS/CTS or ACK

</pre><h4><b>MONITOR</b> <b>MODE</b></h4><pre>
       To  capture  and  analyze 802.11 traffic, the interface needs to be in monitor mode. You can either setup
       the interface manually beforehand  or  let  <b>horst</b>  setup  it  automatically  at  startup.  Usually,  root
       privileges are required to modify an interface setup.

       <b>horst</b>  should  work  with  any  wireleass  LAN  card  and driver which supports monitor mode, with either
       "prism2" or "radiotap" headers. This includes most modern mac80211-based drivers.

       If the interface is not in monitor mode at startup, <b>horst</b> first tries to put  the  interface  in  monitor
       mode.  If  it  fails  (for example when the interface is already in use), a new virtual monitor interface
       (horst0) is added and used instead. The virtual monitor interface is removed when <b>horst</b> exits. Note  that
       changing the channel via a virtual monitor interface is not allowed by the wireless driver, so options -C
       and -s do not work when virtual monitor interface is used.

       Examples of how to setup an interface manually:

       Using iw:
              iw wlan0 interface add mon0 type monitor

              or

              sudo iw wlan1 set type monitor
              sudo iw wlan1 set channel 6

       Using iwconfig:
              iwconfig wlan0 mode monitor
              iwconfig wlan0 channel 1
              ifconfig wlan0 up

       Using madwifi:
              wlanconfig wlan0 create wlandev wifi0 wlanmode monitor

       Using hostap:
              iwconfig wlan0 mode monitor
              iwpriv wlan0 monitor_type 1

</pre><h4><b>NOTES</b></h4><pre>
       Signal values and ranges may differ between wireless drivers and versions.

</pre><h4><b>OUTPUT</b> <b>FILE</b> <b>FORMAT</b></h4><pre>
       The  format  of  the  output  file  (-o  flag)  is  a comma separated list of the following fields in the
       following order, one packet each line.

       timestamp
              Local time, including microseconds (e.g. 2015-05-16 15:05:44.338806 +0300)

       packet_type
              802.11 MAC packet type name as defined in the section "NAMES AND ABBREVIATIONS".

       wlan_src
              Source MAC address

       wlan_dst
              Destination MAC address

       wlan_bssid
              BSSID

       pkt_types
              Higher level packet name as defined in section "NAMES AND ABBREVIATIONS".

       phy_signal
              Signal strength in dBm

       wlan_len
              Packet length (MAC)

       phy_rate
              Physical data rate

       phy_freq
              Received while tuned to this frequency.

       wlan_tsf
              TFS timer value

       wlan_essid
              ESSID, network name

       wlan_mode
              Operating modes as defined in "NAMES AND ABBREVIATIONS".

       wlan_channel
              Channel number

       wlan_wep
              Encryption in use

       wlan_wpa
              WPA1 Encryption in use

       wlan_rsn
              RSN (WPA2) Encryption in use

       ip_src IP source address (if available)

       ip_dst IP destionation address (if available)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/horst.conf.5.html">horst.conf</a></b>(5), <b><a href="../man1/tcpdump.1.html">tcpdump</a></b>(1), <b><a href="../man1/wireshark.1.html">wireshark</a></b>(1), <b><a href="../man1/kismet.1.html">kismet</a></b>(1), <b>README,</b> <b><a href="http://br1.einfach.org/tech/horst">http://br1.einfach.org/tech/horst</a></b>

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>horst</b> was written by Bruno Randolf &lt;<a href="mailto:br1@einfach.org">br1@einfach.org</a>&gt;.

       This manual page was written by Antoine Beaupré &lt;<a href="mailto:anarcat@debian.org">anarcat@debian.org</a>&gt;, for the Debian project (and may  be
       used by others).

                                                  July 22, 2015                                         <u><a href="../man8/HORST.8.html">HORST</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>