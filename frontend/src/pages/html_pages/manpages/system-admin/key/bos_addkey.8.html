<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bos_addkey - Adds a new server encryption key to the KeyFile file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openafs-client">openafs-client_1.8.13.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       bos_addkey - Adds a new server encryption key to the KeyFile file

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>bos</b> <b>addkey</b> <b>-server</b> &lt;<u>machine</u> <u>name</u>&gt; [<b>-key</b> &lt;<u>key</u>&gt;]
           <b>-kvno</b> &lt;<u>key</u> <u>version</u> <u>number</u>&gt; [<b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;]
           [<b>-noauth</b>] [<b>-localauth</b>] [<b>-help</b>]

       <b>bos</b> <b>addk</b> <b>-s</b> &lt;<u>machine</u> <u>name</u>&gt; [<b>-ke</b> &lt;<u>key</u>&gt;]
           <b>-kv</b> &lt;<u>key</u> <u>version</u> <u>number</u>&gt; [<b>-ce</b> &lt;<u>cell</u> <u>name</u>&gt;] [<b>-n</b>]
           [<b>-l</b>] [<b>-h</b>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>bos</b> <b>addkey</b> command constructs a server encryption key from the text string provided, assigns it the
       key version number specified with the <b>-kvno</b> argument, and adds it to the <u>/etc/openafs/server/KeyFile</u> file
       on the machine specified with the <b>-server</b> argument.

       Normally, <b>asetkey</b> <b>add</b> should be used instead of this command; see <b><a href="../man8/asetkey.8.html">asetkey</a></b>(8) for more details. The
       primary use of <b>bos</b> <b>addkey</b> is for cells that are still using the Authentication Server instead of a
       Kerberos v5 KDC. It may, however, also be useful in unusual circumstances where a key needs to be added
       based on a known password rather than via a Kerberos v5 keytab.

       When using <b>bos</b> <b>addkey</b> with an AFS cell that uses the Authentication Server, be sure to use the <b>kas</b>
       <b>setpassword</b> or <b>kas</b> <b>setkey</b> command to add the same key to the "afs" entry in the Authentication Database.

       Do not use the <b>-key</b> argument, which echoes the password string visibly on the screen. If the argument is
       omitted, the BOS Server prompts for the string and does not echo it visibly:

          Input key:
          Retype input key:

       The BOS Server prohibits reuse of any key version number already listed in the
       <u>/etc/openafs/server/KeyFile</u> file. This ensures that users who still have tickets sealed with the current
       key are not prevented from communicating with a server process because the current key is overwritten
       with a new key. Use the <b>bos</b> <b>listkeys</b> command to display the key version numbers in the
       <u>/etc/openafs/server/KeyFile</u> file.

</pre><h4><b>CAUTIONS</b></h4><pre>
       In the unusual case of using <b>bos</b> <b>addkey</b> to add a key with a known password matching a password used to
       generate Kerberos v5 keys, the key in the Kerberos v5 KDC database must have only the DES encryption type
       and must use "afs3" salt, not the default Kerberos v5 salt. Otherwise, the key generated by <b>bos</b> <b>addkey</b>
       will not match the key generated by the Kerberos v5 KDC.

       This command can only add keys to the <u>KeyFile</u>; these keys must be DES keys.  The stronger keys used by
       the rxkad-k5 extension are stored in the <u>KeyFileExt</u>, which is not supported by this command.

       As such, the use of this command is disrecommended; use <b><a href="../man8/asetkey.8.html">asetkey</a></b>(8) instead to benefit from the increased
       security of the rxkad-k5 extension.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-server</b> &lt;<u>machine</u> <u>name</u>&gt;
           Indicates  the  server  machine on which to change the <u>/etc/openafs/server/KeyFile</u> file. Identify the
           machine by IP address or its host name (either fully-qualified  or  abbreviated  unambiguously).  For
           details, see <b><a href="../man8/bos.8.html">bos</a></b>(8).

           In  cells that use the Update Server to distribute the contents of the <u>/etc/openafs/server</u> directory,
           it is conventional to specify only the system control machine as a value for  the  <b>-server</b>  argument.
           Otherwise, repeat the command for each file server machine. For further discussion, see <b><a href="../man8/bos.8.html">bos</a></b>(8).

       <b>-key</b> &lt;<u>key</u>&gt;
           Specifies  a character string just like a password; the BOS Server calls a DES conversion function to
           encode it into a form appropriate for use as an encryption key. Omit this argument to  have  the  BOS
           Server prompt for the string instead.

       <b>-kvno</b> &lt;<u>key</u> <u>version</u> <u>number</u>&gt;
           Defines  the  new  key's key version number. It must be an integer in the range from 0 (zero) through
           255.  For the sake of simplicity, use the number one higher than  the  current  highest  key  version
           number; use the <b>bos</b> <b>listkeys</b> command to display key version numbers.

       <b>-cell</b> &lt;<u>cell</u> <u>name</u>&gt;
           Names  the  cell  in which to run the command. Do not combine this argument with the <b>-localauth</b> flag.
           For more details, see <b><a href="../man8/bos.8.html">bos</a></b>(8).

       <b>-noauth</b>
           Assigns the unprivileged identity "anonymous" to the issuer.  Do  not  combine  this  flag  with  the
           <b>-localauth</b> flag. For more details, see <b><a href="../man8/bos.8.html">bos</a></b>(8).

       <b>-localauth</b>
           Constructs   a   server   ticket   using   a   key  from  the  local  <u>/etc/openafs/server/KeyFile</u>  or
           <u>/etc/openafs/server/KeyFileExt</u> file.  The <b>bos</b> command interpreter presents  the  ticket  to  the  BOS
           Server  during mutual authentication. Do not combine this flag with the <b>-cell</b> or <b>-noauth</b> options. For
           more details, see <b><a href="../man8/bos.8.html">bos</a></b>(8).

       <b>-help</b>
           Prints the online help for this command. All other valid options are ignored.

</pre><h4><b>OUTPUT</b></h4><pre>
       If the strings typed at the "Input key" and "Retype input  key"  prompts  do  not  match,  the  following
       message appears, and the command exits without adding a new key:

          Input key mismatch

</pre><h4><b>EXAMPLES</b></h4><pre>
       The  following  command  adds  a new server encryption key with key version number 14 to the <b>KeyFile</b> file
       kept on the machine "fs1.example.com" (the system control machine). The issuer omits the  <b>-key</b>  argument,
       as recommended, and provides the password at the prompts.

          % bos addkey -server fs1.example.com -kvno 14
          Input key:
          Retype input key:

</pre><h4><b>PRIVILEGE</b> <b>REQUIRED</b></h4><pre>
       The  issuer  must  be listed in the <u>/etc/openafs/server/UserList</u> file on the machine named by the <b>-server</b>
       argument, or must be logged onto a server machine as the local superuser "root" if the <b>-localauth</b> flag is
       included.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/KeyFile.5.html">KeyFile</a></b>(5), <b><a href="../man5/KeyFileExt.5.html">KeyFileExt</a></b>(5), <b><a href="../man5/UserList.5.html">UserList</a></b>(5), <b><a href="../man8/asetkey.8.html">asetkey</a></b>(8), <b><a href="../man8/bos.8.html">bos</a></b>(8), <b><a href="../man8/bos_listkeys.8.html">bos_listkeys</a></b>(8), <b><a href="../man8/bos_removekey.8.html">bos_removekey</a></b>(8)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       IBM Corporation 2000. &lt;<a href="http://www.ibm.com/">http://www.ibm.com/</a>&gt; All Rights Reserved.

       This documentation is covered by the IBM Public License Version 1.0.  It was converted from HTML  to  POD
       by  software  written  by  Chas  Williams  and Russ Allbery, based on work by Alf Wachsmann and Elizabeth
       Cassell.

OpenAFS                                            2025-03-21                                      <u><a href="../man8/BOS_ADDKEY.8.html">BOS_ADDKEY</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>