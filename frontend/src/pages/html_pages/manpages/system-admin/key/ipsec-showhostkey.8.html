<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ipsec-showhostkey - show host's authentication key</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libreswan">libreswan_5.2-2.2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ipsec-showhostkey - show host's authentication key

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>ipsec</b> <b>showhostkey</b> [--verbose] {--version | --list | --dump | --left | --right | --ipseckey | --pem}
                         [--ckaid <u>ckaid</u> | --rsaid <u>rsaid</u>]
                         [--gateway <u>gateway</u>] [--precedence <u>precedence</u>]
                         [--nssdir <u>nssdir</u>] [--password <u>password</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>Showhostkey</u> outputs (on standard output) a public key suitable for this host, in the format specified,
       using the host key information stored in the NSS database.

       In general, since only the super-user can access the NSS database, only the super-user can display the
       public key information.

   <b>Common</b> <b>Options</b>
       <b>--version</b>
           Print the libreswan version, then exit.

       <b>--verbose</b>
           Increase the verbosity.

       <b>--nssdir</b> <u>nssdir</u>
           Specify the libreswan directory that contains the NSS database (default /var/lib/ipsec/nss).

       <b>--password</b> <u>password</u>
           Specify the password to use when accessing the NSS database (default contained in
           /etc/ipsec.d/nsspassword).

   <b>List</b> <b>Options</b>
       <b>--list</b>
           List the private keys.

       <b>--dump</b>
           List, with more details, the private keys.

   <b>Public</b> <b>Key</b> <b>Options</b>
       <b>--ckaid</b> <u>ckaid</u>
           Select the public key to display using the NSS ckaid.

       <b>--rsaid</b> <u>rsaid</u>
           Select the public key to display using the RSA key ID.

       <b>--pem</b>
           Print the selected public key in PEM encoded ASN.1 format.

       <b>--left</b>, <b>--right</b>
           Print the selected public key in <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5) format, as a <u>leftrsasigkey</u> or <u>rightrsasigkey</u> parameter
           respectively. For example, <b>--left</b> might give (with the key data trimmed down for clarity):

               leftrsasigkey=0sAQOF8tZ2...+buFuFn/

       <b>--ipseckey</b>
           Print the selected public key in a format suitable for use as opportunistic-encryption DNS IPSECKEY
           record format (RFC 4025). A gateway can be specified with the <b>--gateway</b>, which currently supports
           IPv4 and IPv6 addresses. For the host name, the value returned by <u>gethostname</u> is used, with a <u>.</u>
           appended.

           For example, <b>--ipseckey</b> <b>--gateway</b> <b>10.11.12.13</b> might give (with the key data trimmed for clarity):

               IN    IPSECKEY  10 1 2 10.11.12.13  AQOF8tZ2...+buFuFn/"

       <b>--gateway</b> <u>gateway</u>
           For <b>--ipseckey</b>, specify the <u>gateway</u> to display with the DNS IPSECKEY record.

       <b>--precedence</b> <u>precedence</u>
           For <b>--ipseckey</b>, specify the <u>precedence</u> to display with the DNS IPSECKEY record.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       A complaint about “no pubkey line found” indicates that the host has a key but it was generated with an
       old version of FreeS/WAN and does not contain the information that <u>showhostkey</u> needs.

</pre><h4><b>FILES</b></h4><pre>
       /var/lib/ipsec/nss, /etc/ipsec.d/nsspassword

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5), <b><a href="../man8/ipsec-rsasigkey.8.html">ipsec-rsasigkey</a></b>(8), <b><a href="../man8/ipsec-newhostkey.8.html">ipsec-newhostkey</a></b>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       Written for the Linux FreeS/WAN project &lt;<b>https://www.freeswan.org</b>&gt; by Henry Spencer. Updated by Paul
       Wouters for the IPSECKEY format.

</pre><h4><b>BUGS</b></h4><pre>
       Arguably, rather than just reporting the no-IN-KEY-line-found problem, <b>showhostkey</b> should be smart enough
       to run the existing key through <u>rsasigkey</u> with the <b>--oldkey</b> option, to generate a suitable output line.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Wouters

Libreswan 5.2                                      07/30/2025                               <u><a href="../man8/IPSEC-SHOWHOSTKEY.8.html">IPSEC-SHOWHOSTKEY</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>