<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_listfile - deny or allow services based on an arbitrary file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-runtime">libpam-runtime_1.7.0-5ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_listfile - deny or allow services based on an arbitrary file

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>pam_listfile.so</b> item=[tty|user|rhost|ruser|group|shell] sense=[allow|deny] file=<u>/path/filename</u>
                       onerr=[succeed|fail] [apply=[<u>user</u>|<u>@group</u>]] [quiet]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       pam_listfile is a PAM module which provides a way to deny or allow services based on an arbitrary file.

       The module gets the <b>item</b> of the type specified -- <u>user</u> specifies the username, <u>PAM_USER</u>; <u>tty</u> specifies
       the name of the terminal (if any) over which the request has been made, <u>PAM_TTY</u>; <u>rhost</u> specifies the name
       of the remote host (if any) from which the request was made, <u>PAM_RHOST</u>; and <u>ruser</u> specifies the name of
       the remote user (if available) who made the request, <u>PAM_RUSER</u> -- and looks for an instance of that item
       in the <b>file=</b><u>filename</u>.  filename contains one line per item listed. If the item is found, then if
       <b>sense=allow</b>, <u>PAM_SUCCESS</u> is returned, causing the authorization request to succeed; else if <b>sense=deny</b>,
       <u>PAM_AUTH_ERR</u> is returned, causing the authorization request to fail.

       If an error is encountered (for instance, if filename does not exist, or a poorly-constructed argument is
       encountered), then if <b>onerr=succeed</b>, <u>PAM_SUCCESS</u> is returned, otherwise if <b>onerr=fail</b>, <u>PAM_AUTH_ERR</u> or
       <u>PAM_SERVICE_ERR</u> (as appropriate) will be returned.

       An additional argument, <b>apply=</b>, can be used to restrict the application of the above to a specific user
       (<b>apply=</b><u>username</u>) or a given group (<b>apply=</b><u>@groupname</u>). This added restriction is only meaningful when used
       with the <u>tty</u>, <u>rhost</u> and <u>shell</u> items.

       Besides this last one, all arguments should be specified; do not count on any default behavior.

       No credentials are awarded by this module.

</pre><h4><b>OPTIONS</b></h4><pre>
       item=[tty|user|rhost|ruser|group|shell]
           What is listed in the file and should be checked for.

       sense=[allow|deny]
           Action to take if the item is found in the file. If the item is NOT found in the file, then the
           opposite action is requested.

       file=/path/filename
           File containing one item per line. The file needs to be a plain file and not world writable.

       onerr=[succeed|fail]
           What to do if something weird happens like being unable to open the file.

       apply=[user|@group]
           Restrict the user class for which the restriction apply. Note that with <b>item=[user|ruser|group]</b> this
           does not make sense, but for <b>item=[tty|rhost|shell]</b> it has a meaning.

       quiet
           Do not treat service refusals or missing list files as errors that need to be logged.

</pre><h4><b>MODULE</b> <b>TYPES</b> <b>PROVIDED</b></h4><pre>
       All module types (<b>auth</b>, <b>account</b>, <b>password</b> and <b>session</b>) are provided.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       PAM_AUTH_ERR
           Authentication failure.

       PAM_BUF_ERR
           Memory buffer error.

       PAM_IGNORE
           The rule does not apply to the <b>apply</b> option.

       PAM_SERVICE_ERR
           Error in service module.

       PAM_SUCCESS
           Success.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Classic 'ftpusers' authentication can be implemented with this entry in /etc/pam.d/ftpd:

           #
           # deny ftp-access to users listed in the /etc/ftpusers file
           #
           auth    required       pam_listfile.so \
                   onerr=succeed item=user sense=deny file=/etc/ftpusers

       Note, users listed in /etc/ftpusers file are (counterintuitively) <u>not</u> allowed access to the ftp service.

       To allow login access only for certain users, you can use a <a href="file:/etc/pam.d/login">/etc/pam.d/login</a> entry like this:

           #
           # permit login to users listed in /etc/loginusers
           #
           auth    required       pam_listfile.so \
                   onerr=fail item=user sense=allow file=/etc/loginusers

       For this example to work, all users who are allowed to use the login service should be listed in the file
       /etc/loginusers. Unless you are explicitly trying to lock out root, make sure that when you do this, you
       leave a way for root to log in, either by listing root in /etc/loginusers, or by listing a user who is
       able to <u>su</u> to the root account.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/pam.conf.5.html">pam.conf</a></b>(5), <b><a href="../man5/pam.d.5.html">pam.d</a></b>(5), <b><a href="../man7/pam.7.html">pam</a></b>(7)

</pre><h4><b>AUTHOR</b></h4><pre>
       pam_listfile was written by Michael K. Johnson &lt;<a href="mailto:johnsonm@redhat.com">johnsonm@redhat.com</a>&gt; and Elliot Lee &lt;<a href="mailto:sopwith@cuc.edu">sopwith@cuc.edu</a>&gt;.

Linux-PAM                                          07/03/2025                                    <u><a href="../man8/PAM_LISTFILE.8.html">PAM_LISTFILE</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>