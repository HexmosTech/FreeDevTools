<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ip-xfrm - transform configuration</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/iproute2">iproute2_6.14.0-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ip-xfrm - transform configuration

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ip</b> [ <u>OPTIONS</u> ] <b>xfrm</b>  { <u>COMMAND</u> | <b>help</b> }

       <b>ip</b> <b>xfrm</b> <u>XFRM-OBJECT</u> { <u>COMMAND</u> | <b>help</b> }

       <u>XFRM-OBJECT</u> := <b>state</b> | <b>policy</b> | <b>monitor</b>

       <b>ip</b> <b>xfrm</b> <b>state</b> { <b>add</b> | <b>update</b> } <u>ID</u> [ <u>ALGO-LIST</u> ] [ <b>mode</b> <u>MODE</u> ] [ <b>mark</b> <u>MARK</u> [ <b>mask</b> <u>MASK</u> ] ] [ <b>reqid</b> <u>REQID</u> ]
               [ <b>dir</b> <u>SA-DIR</u> ] [ <b>seq</b> <u>SEQ</u> ] [ <b>replay-window</b> <u>SIZE</u> ] [ <b>replay-seq</b> <u>SEQ</u> ] [ <b>replay-oseq</b> <u>SEQ</u> ] [
               <b>replay-seq-hi</b> <u>SEQ</u> ] [ <b>replay-oseq-hi</b> <u>SEQ</u> ] [ <b>flag</b> <u>FLAG-LIST</u> ] [ <b>sel</b> <u>SELECTOR</u> ] [ <u>LIMIT-LIST</u> ] [
               <b>encap</b> <u>ENCAP</u> ] [ <b>coa</b> <u>ADDR</u>[/<u>PLEN</u>] ] [ <b>ctx</b> <u>CTX</u> ] [ <b>extra-flag</b> <u>EXTRA-FLAG-LIST</u> ] [ <b>output-mark</b>
               <u>OUTPUT-MARK</u> [ <b>mask</b> <u>MASK</u> ] ] [ <b>if_id</b> <u>IF-ID</u> ] [ <b>offload</b> [ <b>crypto</b>|<b>packet</b> ] dev <u>DEV</u> dir <u>DIR</u> ] [
               <b>tfcpad</b> <u>LENGTH</u> ]

       <b>ip</b> <b>xfrm</b> <b>state</b> <b>allocspi</b> <u>ID</u> [ <b>mode</b> <u>MODE</u> ] [ <b>mark</b> <u>MARK</u> [ <b>mask</b> <u>MASK</u> ] ] [ <b>reqid</b> <u>REQID</u> ] [ <b>seq</b> <u>SEQ</u> ] [ <b>min</b> <u>SPI</u>
               <b>max</b> <u>SPI</u> ]

       <b>ip</b> <b>xfrm</b> <b>state</b> { <b>delete</b> | <b>get</b> } <u>ID</u> [ <b>mark</b> <u>MARK</u> [ <b>mask</b> <u>MASK</u> ] ]

       <b>ip</b> [ <b>-4</b> | <b>-6</b> ] <b>xfrm</b> <b>state</b> <b>deleteall</b> [ <u>ID</u> ] [ <b>mode</b> <u>MODE</u> ] [ <b>reqid</b> <u>REQID</u> ] [ <b>flag</b> <u>FLAG-LIST</u> ]

       <b>ip</b> [ <b>-4</b> | <b>-6</b> ] <b>xfrm</b> <b>state</b> <b>list</b> [ <u>ID</u> ] [ <b>nokeys</b> ] [ <b>mode</b> <u>MODE</u> ] [ <b>reqid</b> <u>REQID</u> ] [ <b>flag</b> <u>FLAG-LIST</u> ]

       <b>ip</b> <b>xfrm</b> <b>state</b> <b>flush</b> [ <b>proto</b> <u>XFRM-PROTO</u> ]

       <b>ip</b> <b>xfrm</b> <b>state</b> <b>count</b>

       <u>ID</u> := [ <b>src</b> <u>ADDR</u> ] [ <b>dst</b> <u>ADDR</u> ] [ <b>proto</b> <u>XFRM-PROTO</u> ] [ <b>spi</b> <u>SPI</u> ]

       <u>XFRM-PROTO</u> := <b>esp</b> | <b>ah</b> | <b>comp</b> | <b>route2</b> | <b>hao</b>

       <u>ALGO-LIST</u> := [ <u>ALGO-LIST</u> ] <u>ALGO</u>

       <u>ALGO</u> := { <b>enc</b> | <b>auth</b> } <u>ALGO-NAME</u> <u>ALGO-KEYMAT</u> |
               <b>auth-trunc</b> <u>ALGO-NAME</u> <u>ALGO-KEYMAT</u> <u>ALGO-TRUNC-LEN</u> |
               <b>aead</b> <u>ALGO-NAME</u> <u>ALGO-KEYMAT</u> <u>ALGO-ICV-LEN</u> |
               <b>comp</b> <u>ALGO-NAME</u>

       <u>MODE</u> := <b>transport</b> | <b>tunnel</b> | <b>beet</b> | <b>ro</b> | <b>in_trigger</b>

       <u>SA-DIR</u> := <b>in</b> | <b>out</b>

       <u>FLAG-LIST</u> := [ <u>FLAG-LIST</u> ] <u>FLAG</u>

       <u>FLAG</u> := <b>noecn</b> | <b>decap-dscp</b> | <b>nopmtudisc</b> | <b>wildrecv</b> | <b>icmp</b> | <b>af-unspec</b> | <b>align4</b> | <b>esn</b>

       <u>SELECTOR</u> := [ <b>src</b> <u>ADDR</u>[/<u>PLEN</u>] ] [ <b>dst</b> <u>ADDR</u>[/<u>PLEN</u>] ] [ <b>dev</b> <u>DEV</u> ]
               [ <u>UPSPEC</u> ]

       <u>UPSPEC</u> := <b>proto</b> { <u>PROTO</u> |
               { <b>tcp</b> | <b>udp</b> | <b>sctp</b> | <b>dccp</b> } [ <b>sport</b> <u>PORT</u> ] [ <b>dport</b> <u>PORT</u> ] |
               { <b>icmp</b> | <b>ipv6-icmp</b> | <b>mobility-header</b> } [ <b>type</b> <u>NUMBER</u> ] [ <b>code</b> <u>NUMBER</u> ] |
               <b>gre</b> [ <b>key</b> { <u>DOTTED-QUAD</u> | <u>NUMBER</u> } ] }

       <u>LIMIT-LIST</u> := [ <u>LIMIT-LIST</u> ] <b>limit</b> <u>LIMIT</u>

       <u>LIMIT</u> := { <b>time-soft</b> | <b>time-hard</b> | <b>time-use-soft</b> | <b>time-use-hard</b> } <u>SECONDS</u> |
               { <b>byte-soft</b> | <b>byte-hard</b> } <u>SIZE</u> |
               { <b>packet-soft</b> | <b>packet-hard</b> } <u>COUNT</u>

       <u>ENCAP</u> := { <b>espinudp</b> | <b>espinudp-nonike</b> | <b>espintcp</b> } <u>SPORT</u> <u>DPORT</u> <u>OADDR</u>

       <u>EXTRA-FLAG-LIST</u> := [ <u>EXTRA-FLAG-LIST</u> ] <u>EXTRA-FLAG</u>

       <u>EXTRA-FLAG</u> := <b>dont-encap-dscp</b> | <b>oseq-may-wrap</b>

       <b>ip</b> <b>xfrm</b> <b>policy</b> { <b>add</b> | <b>update</b> } <u>SELECTOR</u> <b>dir</b> <u>DIR</u> [ <b>ctx</b> <u>CTX</u> ] [ <b>mark</b> <u>MARK</u> [ <b>mask</b> <u>MASK</u> ] ] [ <b>index</b> <u>INDEX</u> ]
               [ <b>ptype</b> <u>PTYPE</u> ] [ <b>action</b> <u>ACTION</u> ] [ <b>priority</b> <u>PRIORITY</u> ] [ <b>flag</b> <u>FLAG-LIST</u> ] [ <b>if_id</b> <u>IF-ID</u> ] [
               <b>offload</b> packet dev <u>DEV</u> ] [ <u>LIMIT-LIST</u> ] [ <u>TMPL-LIST</u> ]

       <b>ip</b> <b>xfrm</b> <b>policy</b> { <b>delete</b> | <b>get</b> } { <u>SELECTOR</u> | <b>index</b> <u>INDEX</u> } <b>dir</b> <u>DIR</u> [ <b>ctx</b> <u>CTX</u> ] [ <b>mark</b> <u>MARK</u> [ <b>mask</b> <u>MASK</u> ]
               ] [ <b>ptype</b> <u>PTYPE</u> ] [ <b>if_id</b> <u>IF-ID</u> ]

       <b>ip</b> [ <b>-4</b> | <b>-6</b> ] <b>xfrm</b> <b>policy</b> { <b>deleteall</b> | <b>list</b> } [ <b>nosock</b> ] [ <u>SELECTOR</u> ] [ <b>dir</b> <u>DIR</u> ] [ <b>index</b> <u>INDEX</u> ] [
               <b>ptype</b> <u>PTYPE</u> ] [ <b>action</b> <u>ACTION</u> ] [ <b>priority</b> <u>PRIORITY</u> ] [ <b>flag</b> <u>FLAG-LIST</u>]

       <b>ip</b> <b>xfrm</b> <b>policy</b> <b>flush</b> [ <b>ptype</b> <u>PTYPE</u> ]

       <b>ip</b> <b>xfrm</b> <b>policy</b> <b>count</b>

       <b>ip</b> <b>xfrm</b> <b>policy</b> <b>set</b> [ <b>hthresh4</b> <u>LBITS</u> <u>RBITS</u> ] [ <b>hthresh6</b> <u>LBITS</u> <u>RBITS</u> ]

       <b>ip</b> <b>xfrm</b> <b>policy</b> <b>setdefault</b> <u>DIR</u> <u>ACTION</u> [ <u>DIR</u> <u>ACTION</u> ] [ <u>DIR</u> <u>ACTION</u> ]

       <b>ip</b> <b>xfrm</b> <b>policy</b> <b>getdefault</b>

       <u>SELECTOR</u> := [ <b>src</b> <u>ADDR</u>[/<u>PLEN</u>] ] [ <b>dst</b> <u>ADDR</u>[/<u>PLEN</u>] ] [ <b>dev</b> <u>DEV</u> ] [ <u>UPSPEC</u> ]

       <u>UPSPEC</u> := <b>proto</b> { <u>PROTO</u> |
               { <b>tcp</b> | <b>udp</b> | <b>sctp</b> | <b>dccp</b> } [ <b>sport</b> <u>PORT</u> ] [ <b>dport</b> <u>PORT</u> ] |
               { <b>icmp</b> | <b>ipv6-icmp</b> | <b>mobility-header</b> } [ <b>type</b> <u>NUMBER</u> ] [ <b>code</b> <u>NUMBER</u> ] |
               <b>gre</b> [ <b>key</b> { <u>DOTTED-QUAD</u> | <u>NUMBER</u> } ] }

       <u>DIR</u> := <b>in</b> | <b>out</b> | <b>fwd</b>

       <u>PTYPE</u> := <b>main</b> | <b>sub</b>

       <u>ACTION</u> := <b>allow</b> | <b>block</b>

       <u>FLAG-LIST</u> := [ <u>FLAG-LIST</u> ] <u>FLAG</u>

       <u>FLAG</u> := <b>localok</b> | <b>icmp</b>

       <u>LIMIT-LIST</u> := [ <u>LIMIT-LIST</u> ] <b>limit</b> <u>LIMIT</u>

       <u>LIMIT</u> := { <b>time-soft</b> | <b>time-hard</b> | <b>time-use-soft</b> | <b>time-use-hard</b> } <u>SECONDS</u> |
               { <b>byte-soft</b> | <b>byte-hard</b> } <u>SIZE</u> |
               { <b>packet-soft</b> | <b>packet-hard</b> } <u>COUNT</u>

       <u>TMPL-LIST</u> := [ <u>TMPL-LIST</u> ] <b>tmpl</b> <u>TMPL</u>

       <u>TMPL</u> := <u>ID</u> [ <b>mode</b> <u>MODE</u> ] [ <b>reqid</b> <u>REQID</u> ] [ <b>level</b> <u>LEVEL</u> ]

       <u>ID</u> := [ <b>src</b> <u>ADDR</u> ] [ <b>dst</b> <u>ADDR</u> ] [ <b>proto</b> <u>XFRM-PROTO</u> ] [ <b>spi</b> <u>SPI</u> ]

       <u>XFRM-PROTO</u> := <b>esp</b> | <b>ah</b> | <b>comp</b> | <b>route2</b> | <b>hao</b>

       <u>MODE</u> := <b>transport</b> | <b>tunnel</b> | <b>beet</b> | <b>ro</b> | <b>in_trigger</b>

       <u>LEVEL</u> := <b>required</b> | <b>use</b>

       <b>ip</b> <b>xfrm</b> <b>monitor</b> [ <b>all-nsid</b> ] [ <b>nokeys</b> ] [ <b>all</b>
                | <u>LISTofXFRM-OBJECTS</u> ]

       <u>LISTofXFRM-OBJECTS</u> := [ <u>LISTofXFRM-OBJECTS</u> ] <u>XFRM-OBJECT</u>

       <u>XFRM-OBJECT</u> := <b>acquire</b> | <b>expire</b> | <b>SA</b> | <b>policy</b> | <b>aevent</b> | <b>report</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       xfrm  is  an IP framework for transforming packets (such as encrypting their payloads). This framework is
       used to implement the IPsec protocol suite (with the <b>state</b> object operating on the  Security  Association
       Database,  and  the  <b>policy</b> object operating on the Security Policy Database). It is also used for the IP
       Payload Compression Protocol and features of Mobile IPv6.

       ip xfrm state add         add new state into xfrm
       ip xfrm state update      update existing state in xfrm
       ip xfrm state allocspi    allocate an SPI value
       ip xfrm state delete      delete existing state in xfrm
       ip xfrm state get         get existing state in xfrm
       ip xfrm state deleteall   delete all existing state in xfrm
       ip xfrm state list        print out the list of existing state in xfrm
       ip xfrm state flush       flush all state in xfrm
       ip xfrm state count       count all existing state in xfrm

       <u>ID</u>     is specified by a source address,  destination  address,  transform  protocol  <u>XFRM-PROTO</u>,  and/or
              Security Parameter Index <u>SPI</u>.  (For IP Payload Compression, the Compression Parameter Index or CPI
              is used for <u>SPI</u>.)

       <u>XFRM-PROTO</u>
              specifies  a  transform protocol: IPsec Encapsulating Security Payload (<b>esp</b>), IPsec Authentication
              Header (<b>ah</b>), IP Payload Compression (<b>comp</b>), Mobile IPv6 Type 2 Routing Header (<b>route2</b>), or  Mobile
              IPv6 Home Address Option (<b>hao</b>).

       <u>ALGO-LIST</u>
              contains one or more algorithms to use. Each algorithm <u>ALGO</u> is specified by:

              •      the  algorithm  type:  encryption (<b>enc</b>), authentication (<b>auth</b> or <b>auth-trunc</b>), authenticated
                     encryption with associated data (<b>aead</b>), or compression (<b>comp</b>)

              •      the algorithm name <u>ALGO-NAME</u> (see below)

              •      (for all except <b>comp</b>) the keying material <u>ALGO-KEYMAT</u>, which may include both a key  and  a
                     salt or nonce value; refer to the corresponding RFC

              •      (for <b>auth-trunc</b> only) the truncation length <u>ALGO-TRUNC-LEN</u> in bits

              •      (for <b>aead</b> only) the Integrity Check Value length <u>ALGO-ICV-LEN</u> in bits

              Encryption    algorithms    include   <b>ecb(cipher_null)</b>,   <b>cbc(des)</b>,   <b>cbc(des3_ede)</b>,   <b>cbc(cast5)</b>,
              <b>cbc(blowfish)</b>, <b>cbc(aes)</b>, <b>cbc(serpent)</b>, <b>cbc(camellia)</b>, <b>cbc(twofish)</b>, and <b>rfc3686(ctr(aes))</b>.

              Authentication algorithms include <b>digest_null</b>, <b><a href="../manmd5/hmac.md5.html">hmac</a>(md5)</b>, <b>hmac(sha1)</b>, <b>hmac(sha256)</b>,  <b>hmac(sha384)</b>,
              <b>hmac(sha512)</b>, <b>hmac(rmd160)</b>, and <b>xcbc(aes)</b>.

              Authenticated  encryption  with  associated  data  (AEAD)  algorithms  include  <b>rfc4106(gcm(aes))</b>,
              <b>rfc4309(ccm(aes))</b>, and <b>rfc4543(gcm(aes))</b>.

              Compression algorithms include <b>deflate</b>, <b>lzs</b>, and <b>lzjh</b>.

       <u>MODE</u>   specifies a mode of operation for the transform protocol. IPsec and IP Payload  Compression  modes
              are <b>transport</b>, <b>tunnel</b>, and (for IPsec ESP only) Bound End-to-End Tunnel (<b>beet</b>).  Mobile IPv6 modes
              are route optimization (<b>ro</b>) and inbound trigger (<b>in_trigger</b>).

       <u>FLAG-LIST</u>
              contains  one  or  more  of the following optional flags: <b>noecn</b>, <b>decap-dscp</b>, <b>nopmtudisc</b>, <b>wildrecv</b>,
              <b>icmp</b>, <b>af-unspec</b>, <b>align4</b>, or <b>esn</b>.

       <u>SELECTOR</u>
              selects the traffic that will be controlled by the policy, based on the source address, the desti‐
              nation address, the network device, and/or <u>UPSPEC</u>.

       <u>UPSPEC</u> selects traffic by protocol. For the <b>tcp</b>, <b>udp</b>, <b>sctp</b>, or <b>dccp</b> protocols, the source and destination
              port can optionally be specified.  For the <b>icmp</b>, <b>ipv6-icmp</b>, or <b>mobility-header</b> protocols, the type
              and code numbers can optionally be specified.  For the <b>gre</b> protocol, the  key  can  optionally  be
              specified as a dotted-quad or number.  Other protocols can be selected by name or number <u>PROTO</u>.

       <u>LIMIT-LIST</u>
              sets limits in seconds, bytes, or numbers of packets.

       <u>ENCAP</u>  encapsulates  packets  with  protocol  <b>espinudp</b>,  <b>espinudp-nonike</b>,  or <b>espintcp</b>, using source port
              <u>SPORT</u>, destination port <u>DPORT</u> , and original address <u>OADDR</u>.

       <u>MARK</u>   used to match xfrm policies and states

       <u>OUTPUT-MARK</u>
              used to set the output mark to influence the routing of the packets emitted by the state

       <u>IF-ID</u>  xfrm interface identifier used to in both xfrm policies and states

       <u>DEV</u>    Network interface name used to offload policies and states

       ip xfrm policy add         add a new policy
       ip xfrm policy update      update an existing policy
       ip xfrm policy delete      delete an existing policy
       ip xfrm policy get         get an existing policy
       ip xfrm policy deleteall   delete all existing xfrm policies
       ip xfrm policy list        print out the list of xfrm policies
       ip xfrm policy flush       flush policies

       <b>nosock</b> filter (remove) all socket policies from the output.

       <u>SELECTOR</u>
              selects the traffic that will be controlled by the policy, based on the source address, the desti‐
              nation address, the network device, and/or <u>UPSPEC</u>.

       <u>UPSPEC</u> selects traffic by protocol. For the <b>tcp</b>, <b>udp</b>, <b>sctp</b>, or <b>dccp</b> protocols, the source and destination
              port can optionally be specified.  For the <b>icmp</b>, <b>ipv6-icmp</b>, or <b>mobility-header</b> protocols, the type
              and code numbers can optionally be specified.  For the <b>gre</b> protocol, the  key  can  optionally  be
              specified as a dotted-quad or number.  Other protocols can be selected by name or number <u>PROTO</u>.

       <u>DIR</u>    selects the policy direction as <b>in</b>, <b>out</b>, or <b>fwd</b>.

       <u>CTX</u>    sets the security context.

       <u>PTYPE</u>  can be <b>main</b> (default) or <b>sub</b>.

       <u>ACTION</u> can be <b>allow</b> (default) or <b>block</b>.

       <u>PRIORITY</u>
              is a number that defaults to zero.

       <u>FLAG-LIST</u>
              contains one or both of the following optional flags: <b>local</b> or <b>icmp</b>.

       <u>LIMIT-LIST</u>
              sets limits in seconds, bytes, or numbers of packets.

       <u>TMPL-LIST</u>
              is a template list specified using <u>ID</u>, <u>MODE</u>, <u>REQID</u>, and/or <u>LEVEL</u>.

       <u>ID</u>     is specified by a source address, destination address, transform protocol <u>XFRM-PROTO</u>, and/or Secu‐
              rity  Parameter Index <u>SPI</u>.  (For IP Payload Compression, the Compression Parameter Index or CPI is
              used for <u>SPI</u>.)

       <u>XFRM-PROTO</u>
              specifies a transform protocol: IPsec Encapsulating Security Payload (<b>esp</b>),  IPsec  Authentication
              Header  (<b>ah</b>), IP Payload Compression (<b>comp</b>), Mobile IPv6 Type 2 Routing Header (<b>route2</b>), or Mobile
              IPv6 Home Address Option (<b>hao</b>).

       <u>MODE</u>   specifies a mode of operation for the transform protocol. IPsec and IP Payload  Compression  modes
              are <b>transport</b>, <b>tunnel</b>, and (for IPsec ESP only) Bound End-to-End Tunnel (<b>beet</b>).  Mobile IPv6 modes
              are route optimization (<b>ro</b>) and inbound trigger (<b>in_trigger</b>).

       <u>LEVEL</u>  can be <b>required</b> (default) or <b>use</b>.

       ip xfrm policy count   count existing policies

       Use one or more -s options to display more details, including policy hash table information.

       ip xfrm policy set   configure the policy hash table

       Security policies whose address prefix lengths are greater than or equal policy hash table thresholds are
       hashed. Others are stored in the policy_inexact chained list.

       <u>LBITS</u>  specifies the minimum local address prefix length of policies that are stored in the Security Pol‐
              icy Database hash table.

       <u>RBITS</u>  specifies  the  minimum  remote  address prefix length of policies that are stored in the Security
              Policy Database hash table.

       ip xfrm monitor    state monitoring for xfrm objects

       The xfrm objects to monitor can be optionally specified.

       If the <b>all-nsid</b> option is set, the program listens to all network namespaces that have  a  nsid  assigned
       into  the network namespace were the program is running.  A prefix is displayed to show the network name‐
       space where the message originates. Example:

         [nsid 1]Flushed state proto 0

</pre><h4><b>AUTHOR</b></h4><pre>
       Manpage revised by David Ward &lt;<a href="mailto:david.ward@ll.mit.edu">david.ward@ll.mit.edu</a>&gt;
       Manpage revised by Christophe Gouault &lt;<a href="mailto:christophe.gouault@6wind.com">christophe.gouault@6wind.com</a>&gt;
       Manpage revised by Nicolas Dichtel &lt;<a href="mailto:nicolas.dichtel@6wind.com">nicolas.dichtel@6wind.com</a>&gt;

iproute2                                           20 Dec 2011                                        <u><a href="../man8/IP-XFRM.8.html">IP-XFRM</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>