<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vfs_shell_snap - Shell script callouts for snapshot creation and deletion</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/samba">samba_4.22.3+dfsg-4ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       vfs_shell_snap - Shell script callouts for snapshot creation and deletion

</pre><h4><b>SYNOPSIS</b></h4><pre>

       vfs objects = shell_snap

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This VFS module is part of the <b><a href="../man8/samba.8.html">samba</a></b>(8) suite.

       The vfs_shell_snap VFS provides shell-script callouts for snapshot creation and deletion operations
       issued by remote clients using the File Server Remote VSS Protocol (FSRVP).

       The following shell callouts may be configured in smb.conf:

       <b>shell_snap:check</b> <b>path</b> <b>command</b>

              •   Called when an FSRVP client wishes to check whether a given share supports snapshot
                  create/delete requests.

              •   The command is called with a single <u>share_path</u> argument.

              •   The command must return 0 if <u>share_path</u> is capable of being snapshotted.

       <b>shell_snap:create</b> <b>command</b>

              •   Called when an FSRVP client wishes to create a snapshot.

              •   The command is called with a single <u>share_path</u> argument.

              •   The command must return 0 status if the snapshot was successfully taken.

              •   The command must output the path of the newly created snapshot to stdout.

       <b>shell_snap:delete</b> <b>command</b>

              •   Called when an FSRVP client wishes to delete a snapshot.

              •   The command is called with <u>base_share_path</u> and <u>snapshot_share_path</u> arguments.

              •   The command must return 0 status if the snapshot was successfully removed.

       All commands are executed as the authenticated FSRVP client user.

       This module is stackable.

</pre><h4><b>CONFIGURATION</b></h4><pre>
                     <u>[share]</u>
                     <b>vfs</b> <b>objects</b> <b>=</b> <b>shell_snap</b>
                     <b>shell_snap:check</b> <b>path</b> <b>command</b> <b>=</b> <b>snap_check_path.sh</b>
                     <b>shell_snap:create</b> <b>command</b> <b>=</b> <b>snap_create.sh</b>
                     <b>shell_snap:delete</b> <b>command</b> <b>=</b> <b>snap_delete.sh</b>

       Samba's FSRVP server must be configured in the [global] section:

                     <u>[global]</u>
                     <b>registry</b> <b>shares</b> <b>=</b> <b>yes</b>
                     <b>include</b> <b>=</b> <b>registry</b>

</pre><h4><b>VERSION</b></h4><pre>
       This man page is part of version 4.22.3-Ubuntu-4.22.3+dfsg-4ubuntu1 of the Samba suite.

</pre><h4><b>AUTHOR</b></h4><pre>
       The original Samba software and related utilities were created by Andrew Tridgell. Samba is now developed
       by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.

Samba 4.22.3-Ubuntu-4.22.3+dfs                     07/21/2025                                  <u><a href="../man8/VFS_SHELL_SNAP.8.html">VFS_SHELL_SNAP</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>