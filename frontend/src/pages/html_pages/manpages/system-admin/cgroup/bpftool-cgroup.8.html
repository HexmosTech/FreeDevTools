<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bpftool-cgroup - tool for inspection and simple manipulation of eBPF progs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bpftool">bpftool_7.6.0+6.16.0-13.13_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       bpftool-cgroup - tool for inspection and simple manipulation of eBPF progs

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>bpftool</b> [<u>OPTIONS</u>] <b>cgroup</b> <u>COMMAND</u>

       <u>OPTIONS</u> := { { <b>-j</b> | <b>--json</b> } [{ <b>-p</b> | <b>--pretty</b> }] | { <b>-d</b> | <b>--debug</b> } | { <b>-f</b> | <b>--bpffs</b> } }

       <u>COMMANDS</u> := { <b>show</b> | <b>list</b> | <b>tree</b> | <b>attach</b> | <b>detach</b> | <b>help</b> }

</pre><h4><b>CGROUP</b> <b>COMMANDS</b></h4><pre>
       <b>bpftool</b> <b>cgroup</b> { <b>show</b> | <b>list</b> } <u>CGROUP</u> [<b>effective</b>]
       <b>bpftool</b> <b>cgroup</b> <b>tree</b> [<u>CGROUP_ROOT</u>] [<b>effective</b>]
       <b>bpftool</b> <b>cgroup</b> <b>attach</b> <u>CGROUP</u> <u>ATTACH_TYPE</u> <u>PROG</u> [<u>ATTACH_FLAGS</u>]
       <b>bpftool</b> <b>cgroup</b> <b>detach</b> <u>CGROUP</u> <u>ATTACH_TYPE</u> <u>PROG</u>
       <b>bpftool</b> <b>cgroup</b> <b>help</b>

       <u>PROG</u> := { <b>id</b> <u>PROG_ID</u> | <b>pinned</b> <u>FILE</u> | <b>tag</b> <u>PROG_TAG</u> | <b>name</b> <u>PROG_NAME</u> }
       <u>ATTACH_TYPE</u> := { <b>cgroup_inet_ingress</b> | <b>cgroup_inet_egress</b> |
         <b>cgroup_inet_sock_create</b> | <b>cgroup_sock_ops</b> |
         <b>cgroup_device</b> | <b>cgroup_inet4_bind</b> | <b>cgroup_inet6_bind</b> |
         <b>cgroup_inet4_post_bind</b> | <b>cgroup_inet6_post_bind</b> |
         <b>cgroup_inet4_connect</b> | <b>cgroup_inet6_connect</b> |
         <b>cgroup_unix_connect</b> | <b>cgroup_inet4_getpeername</b> |
         <b>cgroup_inet6_getpeername</b> | <b>cgroup_unix_getpeername</b> |
         <b>cgroup_inet4_getsockname</b> | <b>cgroup_inet6_getsockname</b> |
         <b>cgroup_unix_getsockname</b> | <b>cgroup_udp4_sendmsg</b> |
         <b>cgroup_udp6_sendmsg</b> | <b>cgroup_unix_sendmsg</b> |
         <b>cgroup_udp4_recvmsg</b> | <b>cgroup_udp6_recvmsg</b> |
         <b>cgroup_unix_recvmsg</b> | <b>cgroup_sysctl</b> |
         <b>cgroup_getsockopt</b> | <b>cgroup_setsockopt</b> |
         <b>cgroup_inet_sock_release</b> }
       <u>ATTACH_FLAGS</u> := { <b>multi</b> | <b>override</b> }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>bpftool</b> <b>cgroup</b> <b>{</b> <b>show</b> <b>|</b> <b>list</b> <b>}</b> <u>CGROUP</u> <b>[effective]</b>
              List all programs attached to the cgroup <u>CGROUP</u>.

              Output will start with program ID followed by attach type, attach flags and program name.

              If  <b>effective</b>  is  specified  retrieve  effective  programs  that will execute for events within a
              cgroup. This includes inherited along with attached ones.

       <b>bpftool</b> <b>cgroup</b> <b>tree</b> <b>[</b><u>CGROUP_ROOT</u><b>]</b> <b>[effective]</b>
              Iterate over all cgroups in <u>CGROUP_ROOT</u> and list all attached programs.   If  <u>CGROUP_ROOT</u>  is  not
              specified, bpftool uses cgroup v2 mountpoint.

              The  output  is similar to the output of cgroup show/list commands: it starts with absolute cgroup
              path, followed by program ID, attach type, attach flags and program name.

              If <b>effective</b> is specified retrieve effective programs  that  will  execute  for  events  within  a
              cgroup. This includes inherited along with attached ones.

       <b>bpftool</b> <b>cgroup</b> <b>attach</b> <u>CGROUP</u> <u>ATTACH_TYPE</u> <u>PROG</u> <b>[</b><u>ATTACH_FLAGS</u><b>]</b>
              Attach program <u>PROG</u> to the cgroup <u>CGROUP</u> with attach type <u>ATTACH_TYPE</u> and optional <u>ATTACH_FLAGS</u>.

              <u>ATTACH_FLAGS</u>  can  be  one  of: <b>override</b> if a sub-cgroup installs some bpf program, the program in
              this cgroup yields to sub-cgroup program; <b>multi</b> if a sub-cgroup installs some  bpf  program,  that
              cgroup program gets run in addition to the program in this cgroup.

              Only  one program is allowed to be attached to a cgroup with no attach flags or the <b>override</b> flag.
              Attaching another program will release old program and attach the new one.

              Multiple programs are allowed to be attached to a cgroup with <b>multi</b>.  They are  executed  in  FIFO
              order (those that were attached first, run first).

              Non-default <u>ATTACH_FLAGS</u> are supported by kernel version 4.14 and later.

              <u>ATTACH_TYPE</u> can be one of:

              • <b>ingress</b> ingress path of the inet socket (since 4.10)

              • <b>egress</b> egress path of the inet socket (since 4.10)

              • <b>sock_create</b> opening of an inet socket (since 4.10)

              • <b>sock_ops</b> various socket operations (since 4.12)

              • <b>device</b> device access (since 4.15)

              • <b>bind4</b> call to <a href="../man2/bind.2.html">bind</a>(2) for an inet4 socket (since 4.17)

              • <b>bind6</b> call to <a href="../man2/bind.2.html">bind</a>(2) for an inet6 socket (since 4.17)

              • <b>post_bind4</b> return from <a href="../man2/bind.2.html">bind</a>(2) for an inet4 socket (since 4.17)

              • <b>post_bind6</b> return from <a href="../man2/bind.2.html">bind</a>(2) for an inet6 socket (since 4.17)

              • <b>connect4</b> call to <a href="../man2/connect.2.html">connect</a>(2) for an inet4 socket (since 4.17)

              • <b>connect6</b> call to <a href="../man2/connect.2.html">connect</a>(2) for an inet6 socket (since 4.17)

              • <b>connect_unix</b> call to <a href="../man2/connect.2.html">connect</a>(2) for a unix socket (since 6.7)

              • <b>sendmsg4</b> call to <a href="../man2/sendto.2.html">sendto</a>(2), <a href="../man2/sendmsg.2.html">sendmsg</a>(2), <a href="../man2/sendmmsg.2.html">sendmmsg</a>(2) for an unconnected udp4 socket (since 4.18)

              • <b>sendmsg6</b> call to <a href="../man2/sendto.2.html">sendto</a>(2), <a href="../man2/sendmsg.2.html">sendmsg</a>(2), <a href="../man2/sendmmsg.2.html">sendmmsg</a>(2) for an unconnected udp6 socket (since 4.18)

              • <b>sendmsg_unix</b>  call  to  <a href="../man2/sendto.2.html">sendto</a>(2), <a href="../man2/sendmsg.2.html">sendmsg</a>(2), <a href="../man2/sendmmsg.2.html">sendmmsg</a>(2) for an unconnected unix socket (since
                6.7)

              • <b>recvmsg4</b> call to <a href="../man2/recvfrom.2.html">recvfrom</a>(2), <a href="../man2/recvmsg.2.html">recvmsg</a>(2), <a href="../man2/recvmmsg.2.html">recvmmsg</a>(2) for an unconnected udp4 socket (since 5.2)

              • <b>recvmsg6</b> call to <a href="../man2/recvfrom.2.html">recvfrom</a>(2), <a href="../man2/recvmsg.2.html">recvmsg</a>(2), <a href="../man2/recvmmsg.2.html">recvmmsg</a>(2) for an unconnected udp6 socket (since 5.2)

              • <b>recvmsg_unix</b> call to <a href="../man2/recvfrom.2.html">recvfrom</a>(2), <a href="../man2/recvmsg.2.html">recvmsg</a>(2), <a href="../man2/recvmmsg.2.html">recvmmsg</a>(2) for an unconnected unix socket  (since
                6.7)

              • <b>sysctl</b> sysctl access (since 5.2)

              • <b>getsockopt</b> call to getsockopt (since 5.3)

              • <b>setsockopt</b> call to setsockopt (since 5.3)

              • <b>getpeername4</b> call to <a href="../man2/getpeername.2.html">getpeername</a>(2) for an inet4 socket (since 5.8)

              • <b>getpeername6</b> call to <a href="../man2/getpeername.2.html">getpeername</a>(2) for an inet6 socket (since 5.8)

              • <b>getpeername_unix</b> call to <a href="../man2/getpeername.2.html">getpeername</a>(2) for a unix socket (since 6.7)

              • <b>getsockname4</b> call to <a href="../man2/getsockname.2.html">getsockname</a>(2) for an inet4 socket (since 5.8)

              • <b>getsockname6</b> call to <a href="../man2/getsockname.2.html">getsockname</a>(2) for an inet6 socket (since 5.8)

              • <b>getsockname_unix</b> call to <a href="../man2/getsockname.2.html">getsockname</a>(2) for a unix socket (since 6.7)

              • <b>sock_release</b> closing a userspace inet socket (since 5.9)

       <b>bpftool</b> <b>cgroup</b> <b>detach</b> <u>CGROUP</u> <u>ATTACH_TYPE</u> <u>PROG</u>
              Detach <u>PROG</u> from the cgroup <u>CGROUP</u> and attach type <u>ATTACH_TYPE</u>.

       <b>bpftool</b> <b>prog</b> <b>help</b>
              Print short help message.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-h</b>, <b>--help</b>
              Print short help message (similar to <b>bpftool</b> <b>help</b>).

       <b>-V</b>, <b>--version</b>
              Print  bpftool's  version number (similar to <b>bpftool</b> <b>version</b>), the number of the libbpf version in
              use, and optional features that were included when bpftool was compiled. Optional features include
              linking against LLVM or libbfd to provide the disassembler for JIT-ted programs (<b>bpftool</b> <b>prog</b> <b>dump</b>
              <b>jited</b>) and usage of BPF skeletons (some  features  like  <b>bpftool</b>  <b>prog</b>  <b>profile</b>  or  showing  pids
              associated to BPF objects may rely on it).

       <b>-j</b>, <b>--json</b>
              Generate JSON output. For commands that cannot produce JSON, this option has no effect.

       <b>-p</b>, <b>--pretty</b>
              Generate human-readable JSON output. Implies <b>-j</b>.

       <b>-d</b>, <b>--debug</b>
              Print  all logs available, even debug-level information. This includes logs from libbpf as well as
              from the verifier, when attempting to load programs.

       <b>-f</b>, <b>--bpffs</b>
              Show file names of pinned programs.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>#</b> <b>mount</b> <b>-t</b> <b>bpf</b> <b>none</b> <b><a href="file:/sys/fs/bpf/">/sys/fs/bpf/</a></b>
       <b>#</b> <b>mkdir</b> <b>/sys/fs/cgroup/test.slice</b>
       <b>#</b> <b>bpftool</b> <b>prog</b> <b>load</b> <b>./device_cgroup.o</b> <b>/sys/fs/bpf/prog</b>
       <b>#</b> <b>bpftool</b> <b>cgroup</b> <b>attach</b> <b>/sys/fs/cgroup/test.slice/</b> <b>device</b> <b>id</b> <b>1</b> <b>allow_multi</b>

       <b>#</b> <b>bpftool</b> <b>cgroup</b> <b>list</b> <b>/sys/fs/cgroup/test.slice/</b>

          ID       AttachType      AttachFlags     Name
          1        device          allow_multi     bpf_prog1

       <b>#</b> <b>bpftool</b> <b>cgroup</b> <b>detach</b> <b>/sys/fs/cgroup/test.slice/</b> <b>device</b> <b>id</b> <b>1</b>
       <b>#</b> <b>bpftool</b> <b>cgroup</b> <b>list</b> <b>/sys/fs/cgroup/test.slice/</b>

          ID       AttachType      AttachFlags     Name

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/bpf.2.html">bpf</a></b>(2), <b><a href="../man7/bpf-helpers.7.html">bpf-helpers</a></b>(7), <b><a href="../man8/bpftool.8.html">bpftool</a></b>(8), <b><a href="../man8/bpftool-btf.8.html">bpftool-btf</a></b>(8), <b><a href="../man8/bpftool-feature.8.html">bpftool-feature</a></b>(8), <b><a href="../man8/bpftool-gen.8.html">bpftool-gen</a></b>(8),  <b><a href="../man8/bpftool-iter.8.html">bpftool-iter</a></b>(8),
       <b><a href="../man8/bpftool-link.8.html">bpftool-link</a></b>(8), <b><a href="../man8/bpftool-map.8.html">bpftool-map</a></b>(8), <b><a href="../man8/bpftool-net.8.html">bpftool-net</a></b>(8), <b><a href="../man8/bpftool-perf.8.html">bpftool-perf</a></b>(8), <b><a href="../man8/bpftool-prog.8.html">bpftool-prog</a></b>(8), <b><a href="../man8/bpftool-struct_ops.8.html">bpftool-struct_ops</a></b>(8)

                                                                                               <u><a href="../man8/BPFTOOL-CGROUP.8.html">BPFTOOL-CGROUP</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>