<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bpftool-map - tool for inspection and simple manipulation of eBPF maps</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bpftool">bpftool_7.6.0+6.15.0-4.4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       bpftool-map - tool for inspection and simple manipulation of eBPF maps

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>bpftool</b> [<u>OPTIONS</u>] <b>map</b> <u>COMMAND</u>

       <u>OPTIONS</u> := { { <b>-j</b> | <b>--json</b> } [{ <b>-p</b> | <b>--pretty</b> }] | { <b>-d</b> | <b>--debug</b> } | { <b>-f</b> | <b>--bpffs</b> } | { <b>-n</b> | <b>--nomount</b>
       } }

       <u>COMMANDS</u> := { <b>show</b> | <b>list</b> | <b>create</b> | <b>dump</b> | <b>update</b> | <b>lookup</b> | <b>getnext</b> | <b>delete</b> | <b>pin</b> | <b>help</b> }

</pre><h4><b>MAP</b> <b>COMMANDS</b></h4><pre>
       <b>bpftool</b> <b>map</b> { <b>show</b> | <b>list</b> }   [<u>MAP</u>]
       <b>bpftool</b> <b>map</b> <b>create</b>     <u>FILE</u> <b>type</b> <u>TYPE</u> <b>key</b> <u>KEY_SIZE</u> <b>value</b> <u>VALUE_SIZE</u>
         <b>entries</b> <u>MAX_ENTRIES</u> <b>name</b> <u>NAME</u> [<b>flags</b> <u>FLAGS</u>] [<b>inner_map</b> <u>MAP</u>]
         [<b>offload_dev</b> <u>NAME</u>]
       <b>bpftool</b> <b>map</b> <b>dump</b>       <u>MAP</u>
       <b>bpftool</b> <b>map</b> <b>update</b>     <u>MAP</u> [<b>key</b> <u>DATA</u>] [<b>value</b> <u>VALUE</u>] [<u>UPDATE_FLAGS</u>]
       <b>bpftool</b> <b>map</b> <b>lookup</b>     <u>MAP</u> [<b>key</b> <u>DATA</u>]
       <b>bpftool</b> <b>map</b> <b>getnext</b>    <u>MAP</u> [<b>key</b> <u>DATA</u>]
       <b>bpftool</b> <b>map</b> <b>delete</b>     <u>MAP</u>  <b>key</b> <u>DATA</u>
       <b>bpftool</b> <b>map</b> <b>pin</b>        <u>MAP</u>  <u>FILE</u>
       <b>bpftool</b> <b>map</b> <b>event_pipe</b> <u>MAP</u> [<b>cpu</b> <u>N</u> <b>index</b> <u>M</u>]
       <b>bpftool</b> <b>map</b> <b>peek</b>       <u>MAP</u>
       <b>bpftool</b> <b>map</b> <b>push</b>       <u>MAP</u> <b>value</b> <u>VALUE</u>
       <b>bpftool</b> <b>map</b> <b>pop</b>        <u>MAP</u>
       <b>bpftool</b> <b>map</b> <b>enqueue</b>    <u>MAP</u> <b>value</b> <u>VALUE</u>
       <b>bpftool</b> <b>map</b> <b>dequeue</b>    <u>MAP</u>
       <b>bpftool</b> <b>map</b> <b>freeze</b>     <u>MAP</u>
       <b>bpftool</b> <b>map</b> <b>help</b>

       <u>MAP</u> := { <b>id</b> <u>MAP_ID</u> | <b>pinned</b> <u>FILE</u> | <b>name</b> <u>MAP_NAME</u> }
       <u>DATA</u> := { [<b>hex</b>] <u>BYTES</u> }
       <u>PROG</u> := { <b>id</b> <u>PROG_ID</u> | <b>pinned</b> <u>FILE</u> | <b>tag</b> <u>PROG_TAG</u> | <b>name</b> <u>PROG_NAME</u> }
       <u>VALUE</u> := { <u>DATA</u> | <u>MAP</u> | <u>PROG</u> }
       <u>UPDATE_FLAGS</u> := { <b>any</b> | <b>exist</b> | <b>noexist</b> }
       <u>TYPE</u> := { <b>hash</b> | <b>array</b> | <b>prog_array</b> | <b>perf_event_array</b> | <b>percpu_hash</b>
         | <b>percpu_array</b> | <b>stack_trace</b> | <b>cgroup_array</b> | <b>lru_hash</b>
         | <b>lru_percpu_hash</b> | <b>lpm_trie</b> | <b>array_of_maps</b> | <b>hash_of_maps</b>
         | <b>devmap</b> | <b>devmap_hash</b> | <b>sockmap</b> | <b>cpumap</b> | <b>xskmap</b> | <b>sockhash</b>
         | <b>cgroup_storage</b> | <b>reuseport_sockarray</b> | <b>percpu_cgroup_storage</b>
         | <b>queue</b> | <b>stack</b> | <b>sk_storage</b> | <b>struct_ops</b> | <b>ringbuf</b> | <b>inode_storage</b>
         | <b>task_storage</b> | <b>bloom_filter</b> | <b>user_ringbuf</b> | <b>cgrp_storage</b> | <b>arena</b> }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>bpftool</b> <b>map</b> <b>{</b> <b>show</b> <b>|</b> <b>list</b> <b>}</b> <b>[</b><u>MAP</u><b>]</b>
              Show  information  about loaded maps.  If <u>MAP</u> is specified show information only about given maps,
              otherwise list all maps currently loaded on the system.  In case of <b>name</b>, <u>MAP</u>  may  match  several
              maps which will all be shown.

              Output will start with map ID followed by map type and zero or more named attributes (depending on
              kernel version).

              Since  Linux  5.8  bpftool  is  able  to  discover information about processes that hold open file
              descriptors (FDs) against  BPF  maps.  On  such  kernels  bpftool  will  automatically  emit  this
              information as well.

       <b>bpftool</b> <b>map</b> <b>create</b> <u>FILE</u> <b>type</b> <u>TYPE</u> <b>key</b> <u>KEY_SIZE</u> <b>value</b> <u>VALUE_SIZE</u> <b>entries</b> <u>MAX_ENTRIES</u> <b>name</b> <u>NAME</u> <b>[flags</b>
       <u>FLAGS</u><b>]</b> <b>[inner_map</b> <u>MAP</u><b>]</b> <b>[offload_dev</b> <u>NAME</u><b>]</b>
              Create a new map with given parameters and pin it to <u>bpffs</u> as <u>FILE</u>.

              <u>FLAGS</u> should be an integer which is the combination of desired flags, e.g. 1024 for <b>BPF_F_MMAPABLE</b>
              (see bpf.h UAPI header for existing flags).

              To  create  maps of type array-of-maps or hash-of-maps, the <b>inner_map</b> keyword must be used to pass
              an inner map. The kernel needs it to collect metadata related to the inner maps that the  new  map
              will work with.

              Keyword  <b>offload_dev</b> expects a network interface name, and is used to request hardware offload for
              the map.

       <b>bpftool</b> <b>map</b> <b>dump</b> <u>MAP</u>
              Dump all entries in a given <u>MAP</u>.  In case of <b>name</b>, <u>MAP</u> may match several maps which  will  all  be
              dumped.

       <b>bpftool</b> <b>map</b> <b>update</b> <u>MAP</u> <b>[key</b> <u>DATA</u><b>]</b> <b>[value</b> <u>VALUE</u><b>]</b> <b>[</b><u>UPDATE_FLAGS</u><b>]</b>
              Update map entry for a given <u>KEY</u>.

              <u>UPDATE_FLAGS</u> can be one of: <b>any</b> update existing entry or add if doesn't exit; <b>exist</b> update only if
              entry already exists; <b>noexist</b> update only if entry doesn't exist.

              If the <b>hex</b> keyword is provided in front of the bytes sequence, the bytes are parsed as hexadecimal
              values, even if no "0x" prefix is added. If the keyword is not provided, then the bytes are parsed
              as decimal values, unless a "0x" prefix (for hexadecimal) or a "0" prefix (for octal) is provided.

       <b>bpftool</b> <b>map</b> <b>lookup</b> <u>MAP</u> <b>[key</b> <u>DATA</u><b>]</b>
              Lookup <b>key</b> in the map.

       <b>bpftool</b> <b>map</b> <b>getnext</b> <u>MAP</u> <b>[key</b> <u>DATA</u><b>]</b>
              Get next key.  If <u>key</u> is not specified, get first key.

       <b>bpftool</b> <b>map</b> <b>delete</b> <u>MAP</u> <b>key</b> <u>DATA</u>
              Remove entry from the map.

       <b>bpftool</b> <b>map</b> <b>pin</b> <u>MAP</u> <u>FILE</u>
              Pin map <u>MAP</u> as <u>FILE</u>.

              Note:  <u>FILE</u>  must  be  located in <u>bpffs</u> mount. It must not contain a dot character ('.'), which is
              reserved for future extensions of <u>bpffs</u>.

       <b>bpftool</b> <b>map</b> <b>event_pipe</b> <u>MAP</u> <b>[cpu</b> <u>N</u> <b>index</b> <u>M</u><b>]</b>
              Read events from a <b>BPF_MAP_TYPE_PERF_EVENT_ARRAY</b> map.

              Install perf rings into a perf event array map and dump output of any <b>bpf_perf_event_output</b>() call
              in the kernel. By default read the number of CPUs on the system and install perf ring for each CPU
              in the corresponding index in the array.

              If <b>cpu</b> and <b>index</b> are specified, install perf ring for given <b>cpu</b> at  <b>index</b>  in  the  array  (single
              ring).

              Note that installing a perf ring into an array will silently replace any existing ring.  Any other
              application will stop receiving events if it installed its rings earlier.

       <b>bpftool</b> <b>map</b> <b>peek</b> <u>MAP</u>
              Peek next value in the queue or stack.

       <b>bpftool</b> <b>map</b> <b>push</b> <u>MAP</u> <b>value</b> <u>VALUE</u>
              Push <u>VALUE</u> onto the stack.

       <b>bpftool</b> <b>map</b> <b>pop</b> <u>MAP</u>
              Pop and print value from the stack.

       <b>bpftool</b> <b>map</b> <b>enqueue</b> <u>MAP</u> <b>value</b> <u>VALUE</u>
              Enqueue <u>VALUE</u> into the queue.

       <b>bpftool</b> <b>map</b> <b>dequeue</b> <u>MAP</u>
              Dequeue and print value from the queue.

       <b>bpftool</b> <b>map</b> <b>freeze</b> <u>MAP</u>
              Freeze  the  map as read-only from user space. Entries from a frozen map can not longer be updated
              or deleted with the <b>bpf</b>() system call. This operation is  not  reversible,  and  the  map  remains
              immutable  from  user  space  until  its  destruction. However, read and write permissions for BPF
              programs to the map remain unchanged.

       <b>bpftool</b> <b>map</b> <b>help</b>
              Print short help message.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-h</b>, <b>--help</b>
              Print short help message (similar to <b>bpftool</b> <b>help</b>).

       <b>-V</b>, <b>--version</b>
              Print bpftool's version number (similar to <b>bpftool</b> <b>version</b>), the number of the libbpf  version  in
              use, and optional features that were included when bpftool was compiled. Optional features include
              linking against LLVM or libbfd to provide the disassembler for JIT-ted programs (<b>bpftool</b> <b>prog</b> <b>dump</b>
              <b>jited</b>)  and  usage  of  BPF  skeletons  (some  features  like <b>bpftool</b> <b>prog</b> <b>profile</b> or showing pids
              associated to BPF objects may rely on it).

       <b>-j</b>, <b>--json</b>
              Generate JSON output. For commands that cannot produce JSON, this option has no effect.

       <b>-p</b>, <b>--pretty</b>
              Generate human-readable JSON output. Implies <b>-j</b>.

       <b>-d</b>, <b>--debug</b>
              Print all logs available, even debug-level information. This includes logs from libbpf as well  as
              from the verifier, when attempting to load programs.

       <b>-f</b>, <b>--bpffs</b>
              Show file names of pinned maps.

       <b>-n</b>, <b>--nomount</b>
              Do not automatically attempt to mount any virtual file system (such as tracefs or BPF virtual file
              system) when necessary.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>#</b> <b>bpftool</b> <b>map</b> <b>show</b>

          10: hash  name some_map  flags 0x0
                key 4B  value 8B  max_entries 2048  memlock 167936B
                pids <a href="../man1/systemd.1.html">systemd</a>(1)

       The following three commands are equivalent:

       <b>#</b> <b>bpftool</b> <b>map</b> <b>update</b> <b>id</b> <b>10</b> <b>key</b> <b>hex</b>   <b>20</b>   <b>c4</b>   <b>b7</b>   <b>00</b> <b>value</b> <b>hex</b>   <b>0f</b>   <b>ff</b>   <b>ff</b>   <b>ab</b>   <b>01</b>   <b>02</b>   <b>03</b>   <b>4c</b>
       <b>#</b> <b>bpftool</b> <b>map</b> <b>update</b> <b>id</b> <b>10</b> <b>key</b>     <b>0x20</b> <b>0xc4</b> <b>0xb7</b> <b>0x00</b> <b>value</b>     <b>0x0f</b> <b>0xff</b> <b>0xff</b> <b>0xab</b> <b>0x01</b> <b>0x02</b> <b>0x03</b> <b>0x4c</b>
       <b>#</b> <b>bpftool</b> <b>map</b> <b>update</b> <b>id</b> <b>10</b> <b>key</b>       <b>32</b>  <b>196</b>  <b>183</b>    <b>0</b> <b>value</b>       <b>15</b>  <b>255</b>  <b>255</b>  <b>171</b>    <b>1</b>    <b>2</b>    <b>3</b>   <b>76</b>

       <b>#</b> <b>bpftool</b> <b>map</b> <b>lookup</b> <b>id</b> <b>10</b> <b>key</b> <b>0</b> <b>1</b> <b>2</b> <b>3</b>

          key: 00 01 02 03 value: 00 01 02 03 04 05 06 07

       <b>#</b> <b>bpftool</b> <b>map</b> <b>dump</b> <b>id</b> <b>10</b>

          key: 00 01 02 03  value: 00 01 02 03 04 05 06 07
          key: 0d 00 07 00  value: 02 00 00 00 01 02 03 04
          Found 2 elements

       <b>#</b> <b>bpftool</b> <b>map</b> <b>getnext</b> <b>id</b> <b>10</b> <b>key</b> <b>0</b> <b>1</b> <b>2</b> <b>3</b>

          key:
          00 01 02 03
          next key:
          0d 00 07 00

       <b>#</b> <b>mount</b> <b>-t</b> <b>bpf</b> <b>none</b> <b><a href="file:/sys/fs/bpf/">/sys/fs/bpf/</a></b>
       <b>#</b> <b>bpftool</b> <b>map</b> <b>pin</b> <b>id</b> <b>10</b> <b>/sys/fs/bpf/map</b>
       <b>#</b> <b>bpftool</b> <b>map</b> <b>del</b> <b>pinned</b> <b>/sys/fs/bpf/map</b> <b>key</b> <b>13</b> <b>00</b> <b>07</b> <b>00</b>

       Note  that  map update can also be used in order to change the program references hold by a program array
       map. This can be used, for example, to change the programs used for tail-call jumps at  runtime,  without
       having  to  reload  the  entry-point  program.  Below  is an example for this use case: we load a program
       defining a prog array map, and with a main function that contains a tail call to other programs that  can
       be used either to "process" packets or to "debug" processing. Note that the prog array map MUST be pinned
       into  the  BPF  virtual file system for the map update to work successfully, as kernel flushes prog array
       maps when they have no more references from user space (and the update would be lost as soon  as  bpftool
       exits).

       <b>#</b> <b>bpftool</b> <b>prog</b> <b>loadall</b> <b>tail_calls.o</b> <b>/sys/fs/bpf/foo</b> <b>type</b> <b>xdp</b>
       <b>#</b> <b>bpftool</b> <b>prog</b> <b>--bpffs</b>

          545: xdp  name main_func  tag 674b4b5597193dc3  gpl
                  loaded_at 2018-12-12T15:02:58+0000  uid 0
                  xlated 240B  jited 257B  memlock 4096B  map_ids 294
                  pinned /sys/fs/bpf/foo/xdp
          546: xdp  name bpf_func_process  tag e369a529024751fc  gpl
                  loaded_at 2018-12-12T15:02:58+0000  uid 0
                  xlated 200B  jited 164B  memlock 4096B
                  pinned /sys/fs/bpf/foo/process
          547: xdp  name bpf_func_debug  tag 0b597868bc7f0976  gpl
                  loaded_at 2018-12-12T15:02:58+0000  uid 0
                  xlated 200B  jited 164B  memlock 4096B
                  pinned /sys/fs/bpf/foo/debug

       <b>#</b> <b>bpftool</b> <b>map</b>

          294: prog_array  name jmp_table  flags 0x0
                  key 4B  value 4B  max_entries 1  memlock 4096B
                  owner_prog_type xdp  owner jited

       <b>#</b> <b>bpftool</b> <b>map</b> <b>pin</b> <b>id</b> <b>294</b> <b>/sys/fs/bpf/bar</b>
       <b>#</b> <b>bpftool</b> <b>map</b> <b>dump</b> <b>pinned</b> <b>/sys/fs/bpf/bar</b>

          Found 0 elements

       <b>#</b> <b>bpftool</b> <b>map</b> <b>update</b> <b>pinned</b> <b>/sys/fs/bpf/bar</b> <b>key</b> <b>0</b> <b>0</b> <b>0</b> <b>0</b> <b>value</b> <b>pinned</b> <b>/sys/fs/bpf/foo/debug</b>
       <b>#</b> <b>bpftool</b> <b>map</b> <b>dump</b> <b>pinned</b> <b>/sys/fs/bpf/bar</b>

          key: 00 00 00 00  value: 22 02 00 00
          Found 1 element

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/bpf.2.html">bpf</a></b>(2),    <b><a href="../man7/bpf-helpers.7.html">bpf-helpers</a></b>(7),    <b><a href="../man8/bpftool.8.html">bpftool</a></b>(8),    <b><a href="../man8/bpftool-btf.8.html">bpftool-btf</a></b>(8),    <b><a href="../man8/bpftool-cgroup.8.html">bpftool-cgroup</a></b>(8),    <b><a href="../man8/bpftool-feature.8.html">bpftool-feature</a></b>(8),
       <b><a href="../man8/bpftool-gen.8.html">bpftool-gen</a></b>(8),  <b><a href="../man8/bpftool-iter.8.html">bpftool-iter</a></b>(8),  <b><a href="../man8/bpftool-link.8.html">bpftool-link</a></b>(8),  <b><a href="../man8/bpftool-net.8.html">bpftool-net</a></b>(8),  <b><a href="../man8/bpftool-perf.8.html">bpftool-perf</a></b>(8),   <b><a href="../man8/bpftool-prog.8.html">bpftool-prog</a></b>(8),
       <b><a href="../man8/bpftool-struct_ops.8.html">bpftool-struct_ops</a></b>(8)

                                                                                                  <u><a href="../man8/BPFTOOL-MAP.8.html">BPFTOOL-MAP</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>