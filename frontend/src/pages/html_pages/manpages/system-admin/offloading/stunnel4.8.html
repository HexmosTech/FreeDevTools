<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>stunnel - TLS offloading and load-balancing proxy</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/stunnel4">stunnel4_5.74-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       stunnel - TLS offloading and load-balancing proxy

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>Unix:</b>
           <b>stunnel</b> [FILE] | -fd N | -help | -version | -sockets | -options

       <b>WIN32:</b>
           <b>stunnel</b> [ [ -install | -uninstall | -start | -stop |
               -reload | -reopen | -exit ] [-quiet] [FILE] ] |
               -help | -version | -sockets | -options

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>stunnel</b>  program  is  designed  to  work  as <u>TLS</u> encryption wrapper between remote clients and local
       (<u>inetd</u>-startable) or remote servers. The concept is that having non-TLS aware  daemons  running  on  your
       system you can easily set them up to communicate with clients over secure <u>TLS</u> channels.

       <b>stunnel</b>  can  be used to add <u>TLS</u> functionality to commonly used <u>Inetd</u> daemons like POP-2, POP-3, and IMAP
       servers, to standalone daemons like NNTP, SMTP and HTTP,  and  in  tunneling  PPP  over  network  sockets
       without changes to the source code.

       This product includes cryptographic software written by Eric Young (<a href="mailto:eay@cryptsoft.com">eay@cryptsoft.com</a>)

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>FILE</b>
           Use specified configuration file

       <b>-fd</b> <b>N</b> (Unix only)
           Read the config file from specified file descriptor

       <b>-help</b>
           Print <b>stunnel</b> help menu

       <b>-version</b>
           Print <b>stunnel</b> version and compile time defaults

       <b>-sockets</b>
           Print default socket options

       <b>-options</b>
           Print supported TLS options

       <b>-install</b> (Windows NT and later only)
           Install NT Service

       <b>-uninstall</b> (Windows NT and later only)
           Uninstall NT Service

       <b>-start</b> (Windows NT and later only)
           Start NT Service

       <b>-stop</b> (Windows NT and later only)
           Stop NT Service

       <b>-reload</b> (Windows NT and later only)
           Reload the configuration file of the running NT Service

       <b>-reopen</b> (Windows NT and later only)
           Reopen the log file of the running NT Service

       <b>-exit</b> (Win32 only)
           Exit an already started stunnel

       <b>-quiet</b> (Win32 only)
           Don't display any message boxes

</pre><h4><b>CONFIGURATION</b> <b>FILE</b></h4><pre>
       Each line of the configuration file can be either:

       •   An empty line (ignored).

       •   A comment starting with ';' (ignored).

       •   An 'option_name = option_value' pair.

       •   '[service_name]' indicating a start of a service definition.

       An address parameter of an option may be either:

       •   A port number.

       •   A colon-separated pair of IP address (either IPv4, IPv6, or domain name) and port number.

       •   A Unix socket path (Unix only).

   <b>GLOBAL</b> <b>OPTIONS</b>
       <b>chroot</b> = DIRECTORY (Unix only)
           directory to chroot <b>stunnel</b> process

           <b>chroot</b>  keeps  <b>stunnel</b> in a chrooted jail.  <u>CApath</u>, <u>CRLpath</u>, <u>pid</u> and <u>exec</u> are located inside the jail
           and the patches have to be relative to the directory specified with <b>chroot</b>.

           Several functions of the operating system also need their files to be located within the chroot jail,
           e.g.:

           •   Delayed resolver typically needs <a href="file:/etc/nsswitch.conf">/etc/nsswitch.conf</a> and /etc/resolv.conf.

           •   Local time in log files needs /etc/timezone.

           •   Some other functions may need devices, e.g. /dev/zero or /dev/null.

       <b>compression</b> = deflate | zlib
           select data compression algorithm

           default: no compression

           Deflate is the standard compression method as described in RFC 1951.

       <b>debug</b> = [FACILITY.]LEVEL
           debugging level

           Level is one of the syslog level names or numbers emerg (0), alert (1), crit (2),  err  (3),  warning
           (4), notice (5), info (6), or debug (7).  All logs for the specified level and all levels numerically
           less than it will be shown.

           The  <u>debug</u>  <u>=</u>  <u>debug</u>  (or the equivalent &lt;debug = 7&gt;) level produces for the most verbose log output.
           This logging level is only meant to be understood by stunnel developers, and not  by  users.   Please
           either use the debug level when requested to do so by an stunnel developer, or when you intend to get
           confused.

           The default logging level is notice (5).

           The  syslog  'daemon'  facility will be used unless a facility name is supplied.  (Facilities are not
           supported on Win32.)

           Case is ignored for both facilities and levels.

       <b>EGD</b> = EGD_PATH (Unix only)
           path to Entropy Gathering Daemon socket

           Entropy Gathering Daemon socket to use to feed the <b>OpenSSL</b> random number generator.

       <b>engine</b> = auto | ENGINE_ID
           select hardware or software cryptographic engine

           default: software-only cryptography

           See Examples section for an engine configuration to use the certificate and the corresponding private
           key from a cryptographic device.

       <b>engineCtrl</b> = COMMAND[:PARAMETER]
           control hardware engine

       <b>engineDefault</b> = TASK_LIST
           set OpenSSL tasks delegated to the current engine

           The parameter specifies a comma-separated list of task to be delegated to the current engine.

           The following tasks may be available, if supported by the engine: ALL, RSA,  DSA,  ECDH,  ECDSA,  DH,
           RAND, CIPHERS, DIGESTS, PKEY, PKEY_CRYPTO, PKEY_ASN1.

       <b>fips</b> = yes | no
           enable or disable FIPS 140-2 mode.

           This option allows you to disable entering FIPS mode if <b>stunnel</b> was compiled with FIPS 140-2 support.

           default: no (since version 5.00)

       <b>foreground</b> = yes | quiet | no (Unix only)
           foreground mode

           Stay in foreground (don't fork).

           With  the  <u>yes</u> parameter it also logs to stderr in addition to the destinations specified with <u>syslog</u>
           and <u>output</u>.

           default: background in daemon mode

       <b>iconActive</b> = ICON_FILE (GUI only)
           GUI icon to be displayed when there are established connections

           On Windows platform the parameter should be an .ico file containing a 16x16 pixel image.

       <b>iconError</b> = ICON_FILE (GUI only)
           GUI icon to be displayed when no valid configuration is loaded

           On Windows platform the parameter should be an .ico file containing a 16x16 pixel image.

       <b>iconIdle</b> = ICON_FILE (GUI only)
           GUI icon to be displayed when there are no established connections

           On Windows platform the parameter should be an .ico file containing a 16x16 pixel image.

       <b>log</b> = append | overwrite
           log file handling

           This option allows you to choose whether the log file (specified with the <u>output</u> option) is  appended
           or overwritten when opened or re-opened.

           default: append

       <b>output</b> = FILE
           append log messages to a file

           /dev/stdout  device  can be used to send log messages to the standard output (for example to log them
           with daemontools splogger).

       <b>pid</b> = FILE (Unix only)
           pid file location

           If the argument is empty, then no pid file will be created.

           <u>pid</u> path is relative to the <u>chroot</u> directory if specified.

       <b>RNDbytes</b> = BYTES
           bytes to read from random seed files

       <b>RNDfile</b> = FILE
           path to file with random seed data

           The OpenSSL library will use data from this file first to seed the random number generator.

       <b>RNDoverwrite</b> = yes | no
           overwrite the random seed files with new random data

           default: yes

       <b>service</b> = SERVICE (Unix only)
           stunnel service name

           The specified service name is used for syslog and as the <u>inetd</u> mode service name  for  TCP  Wrappers.
           While  this  option can technically be specified in the service sections, it is only useful in global
           options.

           default: stunnel

       <b>syslog</b> = yes | no (Unix only)
           enable logging via syslog

           default: yes

       <b>taskbar</b> = yes | no (WIN32 only)
           enable the taskbar icon

           default: yes

   <b>SERVICE-LEVEL</b> <b>OPTIONS</b>
       Each configuration section begins with a service name in square brackets.  The service name is  used  for
       libwrap (TCP Wrappers) access control and lets you distinguish <b>stunnel</b> services in your log files.

       Note  that  if  you  wish to run <b>stunnel</b> in <u>inetd</u> mode (where it is provided a network socket by a server
       such as <u>inetd</u>, <u>xinetd</u>, or <u>tcpserver</u>) then you should read the section entitled <u>INETD</u> <u>MODE</u> below.

       <b>accept</b> = [HOST:]PORT
           accept connections on specified address

           If no host specified, defaults to all IPv4 addresses for the local host.

           To listen on all IPv6 addresses use:

               accept = :::PORT

       <b>CAengine</b> = ENGINE-SPECIFIC_CA_CERTIFICATE_IDENTIFIER
           load a trusted CA certificate from an engine

           The loaded CA certificates will be used with the <u>verifyChain</u> and <u>verifyPeer</u> options.

           Multiple <u>CAengine</u> options are allowed in a single service section.

           Currently supported engines: pkcs11, cng.

       <b>CApath</b> = CA_DIRECTORY
           load trusted CA certificates from a directory

           The loaded CA certificates will be used with the <u>verifyChain</u> and <u>verifyPeer</u> options.  Note  that  the
           certificates in this directory should be named XXXXXXXX.0 where XXXXXXXX is the hash value of the DER
           encoded subject of the cert.

           This  parameter  can also be used to provide the root CA certificate needed to validate OCSP stapling
           in server mode.

           The hash algorithm has been changed in <b>OpenSSL</b> <b>1.0.0</b>.  It is required to c_rehash  the  directory  on
           upgrade from <b>OpenSSL</b> <b>0.x.x</b> to <b>OpenSSL</b> <b>1.x.x</b> or later.

           <u>CApath</u> path is relative to the <u>chroot</u> directory if specified.

       <b>CAfile</b> = CA_FILE
           load trusted CA certificates from a file

           The loaded CA certificates will be used with the <u>verifyChain</u> and <u>verifyPeer</u> options.

           This  parameter  can also be used to provide the root CA certificate needed to validate OCSP stapling
           in server mode.

       <b>cert</b> = CERT_FILE
           certificate chain file name

           The parameter specifies the file containing certificates  used  by  <b>stunnel</b>  to  authenticate  itself
           against  the  remote  client or server.  The file should contain the whole certificate chain starting
           from the actual server/client certificate, and ending with the self-signed root CA certificate.   The
           file must be either in PEM or P12 format.

           A certificate chain is required in server mode, and optional in client mode.

           This parameter is also used as the certificate identifier when a hardware engine is enabled.

       <b>checkEmail</b> = EMAIL
           verify the email address of the end-entity (leaf) peer certificate subject

           Certificates are accepted if no subject checks were specified, or the email address of the end-entity
           (leaf) peer certificate matches any of the email addresses specified with <u>checkEmail</u>.

           Multiple <u>checkEmail</u> options are allowed in a single service section.

           This option requires OpenSSL 1.0.2 or later.

       <b>checkHost</b> = HOST
           verify the host of the end-entity (leaf) peer certificate subject

           Certificates  are  accepted  if  no subject checks were specified, or the host name of the end-entity
           (leaf) peer certificate matches any of the hosts specified with <u>checkHost</u>.

           Multiple <u>checkHost</u> options are allowed in a single service section.

           This option requires OpenSSL 1.0.2 or later.

       <b>checkIP</b> = IP
           verify the IP address of the end-entity (leaf) peer certificate subject

           Certificates are accepted if no subject checks were specified, or the IP address  of  the  end-entity
           (leaf) peer certificate matches any of the IP addresses specified with <u>checkIP</u>.

           Multiple <u>checkIP</u> options are allowed in a single service section.

           This option requires OpenSSL 1.0.2 or later.

       <b>ciphers</b> = CIPHER_LIST
           select permitted TLS ciphers (TLSv1.2 and below)

           This option does not impact TLSv1.3 ciphersuites.

           A   colon-delimited   list   of   the   ciphers   to   allow  in  the  TLS  connection,  for  example
           DES-CBC3-SHA:IDEA-CBC-MD5.

       <b>ciphersuites</b> = CIPHERSUITES_LIST
           select permitted TLSv1.3 ciphersuites

           A colon-delimited list of TLSv1.3 ciphersuites names in order of preference.

           The <u>ciphersuites</u> option ignores unknown ciphers when compiled with <b>OpenSSL</b> <b>3.0</b> or later.

           This option requires OpenSSL 1.1.1 or later.

           default: TLS_CHACHA20_POLY1305_SHA256:TLS_AES_256_GCM_SHA384:TLS_AES_128_GCM_SHA256

       <b>client</b> = yes | no
           client mode (remote service uses TLS)

           default: no (server mode)

       <b>config</b> = COMMAND[:PARAMETER]
           <b>OpenSSL</b> configuration command

           The <b>OpenSSL</b> configuration command  is  executed  with  the  specified  parameter.   This  allows  any
           configuration  commands  to  be  invoked from the stunnel configuration file.  Supported commands are
           described on the <u><b><a href="../man3ssl/SSL_CONF_cmd.3ssl.html">SSL_CONF_cmd</a></b>(3ssl)</u> manual page.

           Several <u>config</u> lines can be used to specify multiple configuration commands.

           Use <u>curves</u> option instead of enabling <u>config</u> <u>=</u> <u>Curves:list_curves</u> to support elliptic curves.

           This option requires OpenSSL 1.0.2 or later.

       <b>connect</b> = [HOST:]PORT
           connect to a remote address

           If no host is specified, the host defaults to localhost.

           Multiple <u>connect</u> options are allowed in a single service  section.   If  host  resolves  to  multiple
           addresses and/or if multiple <u>connect</u> options are specified, then the remote address is chosen using a
           round-robin algorithm.

       <b>CRLpath</b> = DIRECTORY
           Certificate Revocation Lists directory

           This  is  the directory in which <b>stunnel</b> will look for CRLs when using the <u>verifyChain</u> and <u>verifyPeer</u>
           options. Note that the CRLs in this directory should be named XXXXXXXX.r0 where XXXXXXXX is the  hash
           value of the CRL.

           The  hash  algorithm  has been changed in <b>OpenSSL</b> <b>1.0.0</b>.  It is required to c_rehash the directory on
           upgrade from <b>OpenSSL</b> <b>0.x.x</b> to <b>OpenSSL</b> <b>1.x.x</b>.

           <u>CRLpath</u> path is relative to the <u>chroot</u> directory if specified.

       <b>CRLfile</b> = CRL_FILE
           Certificate Revocation Lists file

           This file contains multiple CRLs, used with the <u>verifyChain</u> and <u>verifyPeer</u> options.

       <b>curves</b> = list
           ECDH curves separated with ':'

           Only a single curve name is allowed for OpenSSL older than 1.1.1.

           To get a list of supported curves use:

               openssl ecparam -list_curves

           default:

               X25519:P-256:X448:P-521:P-384 (OpenSSL 1.1.1 or later)

               prime256v1 (OpenSSL older than 1.1.1)

       <b>logId</b> = TYPE
           connection identifier type

           This identifier allows you to distinguish log entries generated for each of the connections.

           Currently supported types:

           <u>sequential</u>
               The numeric sequential identifier is only unique within a single instance of  <b>stunnel</b>,  but  very
               compact.  It is most useful for manual log analysis.

           <u>unique</u>
               This  alphanumeric  identifier  is globally unique, but longer than the sequential number.  It is
               most useful for automated log analysis.

           <u>thread</u>
               The operating system thread identifier is neither  unique  (even  within  a  single  instance  of
               <b>stunnel</b>) nor short.  It is most useful for debugging software or configuration issues.

           <u>process</u>
               The operating system process identifier (PID) may be useful in the inetd mode.

           default: sequential

       <b>debug</b> = LEVEL
           debugging level

           Level  is a one of the syslog level names or numbers emerg (0), alert (1), crit (2), err (3), warning
           (4), notice (5), info (6), or debug (7).  All logs for the specified level and all levels numerically
           less than it will be shown.  The default is notice (5).

           While the <u>debug</u> <u>=</u> <u>debug</u> or <u>debug</u> <u>=</u> <u>7</u> level generates the most verbose output, it is only intended  to
           be  used  by stunnel developers.  Please only use this value if you are a developer, or you intend to
           send your logs to our technical support.  Otherwise, the generated logs <b>will</b> be confusing.

       <b>delay</b> = yes | no
           delay DNS lookup for the <u>connect</u> option

           This option is useful for dynamic DNS, or when DNS is not  available  during  <b>stunnel</b>  startup  (road
           warrior VPN, dial-up configurations).

           Delayed  resolver  mode  is automatically engaged when stunnel fails to resolve on startup any of the
           <u>connect</u> targets for a service.

           Delayed resolver inflicts <u>failover</u> <u>=</u> <u>prio</u>.

           default: no

       <b>engineId</b> = ENGINE_ID
           select engine ID for the service

       <b>engineNum</b> = ENGINE_NUMBER
           select engine number for the service

           The engines are numbered starting from 1.

       <b>exec</b> = EXECUTABLE_PATH
           execute a local inetd-type program

           <u>exec</u> path is relative to the <u>chroot</u> directory if specified.

           The  following  environmental  variables  are  set  on  Unix  platforms:  REMOTE_HOST,   REMOTE_PORT,
           SSL_CLIENT_DN, SSL_CLIENT_I_DN.

       <b>execArgs</b> = $0 $1 $2 ...
           arguments for <u>exec</u> including the program name ($0)

           Quoting is currently not supported.  Arguments are separated with an arbitrary amount of whitespace.

       <b>failover</b> = rr | prio
           Failover strategy for multiple "connect" targets.

           <u>rr</u>  round robin - fair load distribution

           <u>prio</u>
               priority - use the order specified in config file

           default: prio

       <b>ident</b> = USERNAME
           use IDENT (RFC 1413) username checking

       <b>include</b> = DIRECTORY
           include all configuration file parts located in DIRECTORY

           The  files  are included in the ascending alphabetical order of their names. The recommended filename
           convention is

           for global options:

                   00-global.conf

           for local service-level options:

                   01-service.conf

                   02-service.conf

       <b>key</b> = KEY_FILE
           private key for the certificate specified with <u>cert</u> option

           A private key is needed to authenticate the certificate owner.  Since this file should be kept secret
           it should only be readable by its owner.  On Unix systems you can use the following command:

               chmod 600 keyfile

           This parameter is also used as the private key identifier when a hardware engine is enabled.

           default: the value of the <u>cert</u> option

       <b>libwrap</b> = yes | no
           Enable or disable the use of <a href="file:/etc/hosts.allow">/etc/hosts.allow</a> and /etc/hosts.deny.

           default: no (since version 5.00)

       <b>local</b> = HOST
           By default, the IP address of the outgoing interface is used as the source  for  remote  connections.
           Use this option to bind a static local IP address instead.

       <b>OCSP</b> = URL
           select OCSP responder for the end-entity (leaf) peer certificate verification

       <b>OCSPaia</b> = yes | no
           validate certificates with their AIA OCSP responders

           This  option  enables <u>stunnel</u> to validate certificates with the list of OCSP responder URLs retrieved
           from their AIA (Authority Information Access) extension.

       <b>OCSPflag</b> = OCSP_FLAG
           specify OCSP responder flag

           Several <u>OCSPflag</u> can be used to specify multiple flags.

           currently supported flags:  NOCERTS,  NOINTERN,  NOSIGS,  NOCHAIN,  NOVERIFY,  NOEXPLICIT,  NOCASIGN,
           NODELEGATED, NOCHECKS, TRUSTOTHER, RESPID_KEY, NOTIME

       <b>OCSPnonce</b> = yes | no
           send and verify the OCSP nonce extension

           This  option  protects  the OCSP protocol against replay attacks.  Due to its computational overhead,
           the nonce extension is usually only supported on internal (e.g. corporate)  responders,  and  not  on
           public OCSP responders.

       <b>OCSPrequire</b> = yes | no
           require a conclusive OCSP response

           Disable  this option to allow a connection even though no conclusive OCSP response was retrieved from
           stapling and a direct request to the OCSP responder.

           default: yes

       <b>options</b> = SSL_OPTIONS
           <b>OpenSSL</b> library options

           The parameter is the <b>OpenSSL</b> option name as described in the  <u><b><a href="../man3ssl/SSL_CTX_set_options.3ssl.html">SSL_CTX_set_options</a></b>(3ssl)</u>  manual,  but
           without  <u>SSL_OP</u><b>_</b>  prefix.   <u>stunnel</u>  <u>-options</u>  lists  the  options found to be allowed in the current
           combination of <u>stunnel</u> and the <u>OpenSSL</u> library used to build it.

           Several <u>option</u> lines can be used to specify multiple options.  An option name can be prepended with a
           dash ("-") to disable the option.

           For example, for compatibility with the erroneous Eudora TLS implementation, the following option can
           be used:

               options = DONT_INSERT_EMPTY_FRAGMENTS

           default:

               options = NO_SSLv2
               options = NO_SSLv3

           Use <u>sslVersionMax</u> or <u>sslVersionMin</u> option instead of disabling specific TLS  protocol  versions  when
           compiled with <b>OpenSSL</b> <b>1.1.0</b> or later.

       <b>protocol</b> = PROTO
           application protocol to negotiate TLS

           This  option  enables  initial,  protocol-specific  negotiation  of the TLS encryption.  The <u>protocol</u>
           option should not be used with TLS encryption on a separate port.

           Currently supported protocols:

           <u>cifs</u>
               Proprietary (undocummented) extension of CIFS protocol implemented in Samba.   Support  for  this
               extension was dropped in Samba 3.0.0.

           <u>capwin</u>
               <a href="http://www.capwin.org/">http://www.capwin.org/</a> application support

           <u>capwinctrl</u>
               <a href="http://www.capwin.org/">http://www.capwin.org/</a> application support

               This protocol is only supported in client mode.

           <u>connect</u>
               Based  on  RFC  2817  -  <u>Upgrading</u> <u>to</u> <u>TLS</u> <u>Within</u> <u>HTTP/1.1</u>, section 5.2 - <u>Requesting</u> <u>a</u> <u>Tunnel</u> <u>with</u>
               <u>CONNECT</u>

               This protocol is only supported in client mode.

           <u>imap</u>
               Based on RFC 2595 - <u>Using</u> <u>TLS</u> <u>with</u> <u>IMAP,</u> <u>POP3</u> <u>and</u> <u>ACAP</u>

           <u>ldap</u>
               Based on RFC 2830 - <u>Lightweight</u> <u>Directory</u> <u>Access</u> <u>Protocol</u> <u>(v3):</u>  <u>Extension</u>  <u>for</u>  <u>Transport</u>  <u>Layer</u>
               <u>Security</u>

           <u>nntp</u>
               Based  on  RFC  4642  -  <u>Using</u> <u>Transport</u> <u>Layer</u> <u>Security</u> <u>(TLS)</u> <u>with</u> <u>Network</u> <u>News</u> <u>Transfer</u> <u>Protocol</u>
               <u>(NNTP)</u>

               This protocol is only supported in client mode.

           <u>pgsql</u>
               Based on <u><a href="http://www.postgresql.org/docs/8.3/static/protocol-flow.html">http://www.postgresql.org/docs/8.3/static/protocol-flow.html</a>#AEN73982</u>

           <u>pop3</u>
               Based on RFC 2449 - <u>POP3</u> <u>Extension</u> <u>Mechanism</u>

           <u>proxy</u>
               Passing  of  the  original  client  IP  address   with   HAProxy   PROXY   protocol   version   1
               <u>https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt</u>

           <u>smtp</u>
               Based on RFC 2487 - <u>SMTP</u> <u>Service</u> <u>Extension</u> <u>for</u> <u>Secure</u> <u>SMTP</u> <u>over</u> <u>TLS</u>

           <u>socks</u>
               SOCKS  versions 4, 4a, and 5 are supported.  The SOCKS protocol itself is encapsulated within TLS
               encryption layer to protect the final destination address.

               <u><a href="http://www.openssh.com/txt/socks4.protocol">http://www.openssh.com/txt/socks4.protocol</a></u>

               <u><a href="http://www.openssh.com/txt/socks4a.protocol">http://www.openssh.com/txt/socks4a.protocol</a></u>

               The BIND command of the SOCKS protocol is not supported.  The USERID parameter is ignored.

               See Examples section for sample configuration files for VPN based on SOCKS encryption.

       <b>protocolAuthentication</b> = AUTHENTICATION
           authentication type for the protocol negotiations

           Currently, this option is only supported in the client-side 'connect' and 'smtp' protocols.

           Supported authentication types for the  'connect'  protocol  are  'basic'  or  'ntlm'.   The  default
           'connect' authentication type is 'basic'.

           Supported  authentication  types  for the 'smtp' protocol are 'plain' or 'login'.  The default 'smtp'
           authentication type is 'plain'.

       <b>protocolDomain</b> = DOMAIN
           domain for the protocol negotiations

           Currently, this option is only supported in the client-side 'connect' protocol.

       <b>protocolHeader</b> = HEADER
           header for the protocol negotiations

           Currently, this option is only supported in the client-side 'connect' protocol.

       <b>protocolHost</b> = ADDRESS
           host address for the protocol negotiations

           For the 'connect' protocol negotiations, <u>protocolHost</u> specifies HOST:PORT of the final TLS server  to
           be  connected to by the proxy.  The proxy server directly connected by <b>stunnel</b> must be specified with
           the <u>connect</u> option.

           For the 'smtp' protocol negotiations, <u>protocolHost</u> controls the client SMTP HELO/EHLO value.

       <b>protocolPassword</b> = PASSWORD
           password for the protocol negotiations

           Currently, this option is only supported in the client-side 'connect' and 'smtp' protocols.

       <b>protocolUsername</b> = USERNAME
           username for the protocol negotiations

           Currently, this option is only supported in the client-side 'connect' and 'smtp' protocols.

       <b>PSKidentity</b> = IDENTITY
           PSK identity for the PSK client

           <u>PSKidentity</u> can be used on <b>stunnel</b> clients to select the PSK identity used for authentication.   This
           option is ignored in server sections.

           default: the first identity specified in the <u>PSKsecrets</u> file.

       <b>PSKsecrets</b> = FILE
           file with PSK identities and corresponding keys

           Each line of the file in the following format:

               IDENTITY:KEY

           Hexadecimal  keys  are  automatically  converted to binary form.  Keys are required to be at least 16
           bytes long, which implies at least 32 characters for hexadecimal keys.  The file  should  neither  be
           world-readable nor world-writable.

       <b>pty</b> = yes | no (Unix only)
           allocate a pseudoterminal for 'exec' option

       <b>redirect</b> = [HOST:]PORT
           redirect TLS client connections on certificate-based authentication failures

           This  option  only  works  in server mode.  Some protocol negotiations are also incompatible with the
           <u>redirect</u> option.

       <b>renegotiation</b> = yes | no
           support TLS renegotiation

           Applications of the TLS renegotiation  include  some  authentication  scenarios,  or  re-keying  long
           lasting connections.

           On the other hand this feature can facilitate a trivial CPU-exhaustion DoS attack:

           <u><a href="http://vincent.bernat.im/en/blog/2011-ssl-dos-mitigation.html">http://vincent.bernat.im/en/blog/2011-ssl-dos-mitigation.html</a></u>

           Please note that disabling TLS renegotiation does not fully mitigate this issue.

           default: yes (if supported by <b>OpenSSL</b>)

       <b>reset</b> = yes | no
           attempt to use the TCP RST flag to indicate an error

           This option is not supported on some platforms.

           default: yes

       <b>retry</b> = yes | no | DELAY
           reconnect a connect+exec section after it was disconnected

           The  DELAY  value  specifies  the number of milliseconds before retrying.  "retry = yes" has the same
           effect as "retry = 1000".

           default: no

       <b>securityLevel</b> = LEVEL
           set the security level

           The meaning of each level is described below:

           level 0
               Everything is permitted.

           level 1
               The security level corresponds to a minimum of 80 bits of security. Any parameters offering below
               80 bits of security are excluded. As a result RSA, DSA and DH keys shorter than 1024 bits and ECC
               keys shorter than 160 bits are prohibited. All export cipher suites are prohibited since they all
               offer less than 80 bits of security. SSL version 2 is prohibited. Any cipher suite using MD5  for
               the  MAC  is  also prohibited. Additionally, SSLv3, TLS 1.0, TLS 1.1 are all disabled for OpenSSL
               3.0 and later.

           level 2
               Security level set to 112 bits of security. As a result RSA, DSA and DH keys  shorter  than  2048
               bits and ECC keys shorter than 224 bits are prohibited. In addition to the level 1 exclusions any
               cipher  suite  using  RC4  is also prohibited. Compression is disabled. SSL version 3 is also not
               allowed for OpenSSL older than 3.0.

           level 3
               Security level set to 128 bits of security. As a result RSA, DSA and DH keys  shorter  than  3072
               bits  and  ECC  keys  shorter than 256 bits are prohibited. In addition to the level 2 exclusions
               cipher suites not offering forward secrecy are prohibited.  Session  tickets  are  disabled.  TLS
               versions below 1.1 are not permitted for OpenSSL older than 3.0.

           level 4
               Security  level  set  to 192 bits of security. As a result RSA, DSA and DH keys shorter than 7680
               bits and ECC keys shorter than 384 bits are prohibited.  Cipher suites using SHA1 for the MAC are
               prohibited. TLS versions below 1.2 are not permitted for OpenSSL older than 3.0.

           level 5
               Security level set to 256 bits of security. As a result RSA, DSA and DH keys shorter  than  15360
               bits and ECC keys shorter than 512 bits are prohibited.

           default: 2

           The <u>securityLevel</u> option is only available when compiled with <b>OpenSSL</b> <b>1.1.0</b> and later.

       <b>requireCert</b> = yes | no
           require a client certificate for <u>verifyChain</u> or <u>verifyPeer</u>

           With  <u>requireCert</u>  set  to  <u>no</u>,  the <b>stunnel</b> server accepts client connections that did not present a
           certificate.

           Both <u>verifyChain</u> <u>=</u> <u>yes</u> and <u>verifyPeer</u> <u>=</u> <u>yes</u> imply <u>requireCert</u> <u>=</u> <u>yes</u>.

           default: no

       <b>setgid</b> = GROUP (Unix only)
           Unix group id

           As a global option: <b>setgid()</b> to the specified group in daemon mode and clear all other groups.

           As a service-level option: set the group of the Unix socket specified with "accept".

       <b>setuid</b> = USER (Unix only)
           Unix user id

           As a global option: <b>setuid()</b> to the specified user in daemon mode.

           As a service-level option: set the owner of the Unix socket specified with "accept".

       <b>sessionCacheSize</b> = NUM_ENTRIES
           session cache size

           <u>sessionCacheSize</u> specifies the maximum number of the internal session cache entries.

           The value of 0 can be used for unlimited size.  It is not recommended for production use due  to  the
           risk of a memory exhaustion DoS attack.

       <b>sessionCacheTimeout</b> = TIMEOUT
           session cache timeout

           This is the number of seconds to keep cached TLS sessions.

       <b>sessionResume</b> = yes | no
           allow or disallow session resumption

           default: yes

       <b>sessiond</b> = HOST:PORT
           address of sessiond TLS cache server

       <b>sni</b> = SERVICE_NAME:SERVER_NAME_PATTERN (server mode)
           Use  the  service as a secondary service (a name-based virtual server) for Server Name Indication TLS
           extension (RFC 3546).

           <u>SERVICE_NAME</u> specifies the primary service that accepts client connections with  the  <u>accept</u>  option.
           <u>SERVER_NAME_PATTERN</u>  specifies  the  host  name to be redirected.  The pattern may start with the '*'
           character, e.g.  '*.example.com'.  Multiple secondary services are normally specified  for  a  single
           primary  service.   The  <u>sni</u>  option  can  also be specified more than once within a single secondary
           service.

           This service, as well as the primary service, may not be configured in client mode.

           The <u>connect</u> option of the secondary service is ignored when the  <u>protocol</u>  option  is  specified,  as
           <u>protocol</u> connects to the remote host before TLS handshake.

           Libwrap checks (Unix only) are performed twice: with the primary service name after TCP connection is
           accepted, and with the secondary service name during the TLS handshake.

           The <u>sni</u> option is only available when compiled with <b>OpenSSL</b> <b>1.0.0</b> and later.

       <b>sni</b> = SERVER_NAME (client mode)
           Use the parameter as the value of TLS Server Name Indication (RFC 3546) extension.

           Empty SERVER_NAME disables sending the SNI extension.

           The <u>sni</u> option is only available when compiled with <b>OpenSSL</b> <b>1.0.0</b> and later.

       <b>socket</b> = a|l|r:OPTION=VALUE[:VALUE]
           Set an option on the accept/local/remote socket

           The values for the linger option are l_onof:l_linger.  The values for the time are tv_sec:tv_usec.

           Examples:

               socket = l:SO_LINGER=1:60
                   set one minute timeout for closing local socket
               socket = r:SO_OOBINLINE=yes
                   place out-of-band data directly into the
                   receive data stream for remote sockets
               socket = a:SO_REUSEADDR=no
                   disable address reuse (enabled by default)
               socket = a:SO_BINDTODEVICE=lo
                   only accept connections on loopback interface

       <b>sslVersion</b> = SSL_VERSION
           select the TLS protocol version

           Supported versions: all, SSLv2, SSLv3, TLSv1, TLSv1.1, TLSv1.2, TLSv1.3

           Availability  of specific protocols depends on the linked OpenSSL library.  Older versions of OpenSSL
           do not support TLSv1.1, TLSv1.2 and TLSv1.3.  Newer versions of OpenSSL do not support SSLv2.

           Obsolete SSLv2 and SSLv3 are currently disabled by default.

           Setting the option

               sslVersion = SSL_VERSION

           is equivalent to options

               sslVersionMax = SSL_VERSION
               sslVersionMin = SSL_VERSION

           when compiled with <b>OpenSSL</b> <b>1.1.0</b> and later.

       <b>sslVersionMax</b> = SSL_VERSION
           maximum supported protocol versions

           Supported versions: all, SSLv3, TLSv1, TLSv1.1, TLSv1.2, TLSv1.3

           <u>all</u> enable protocol versions up to the highest version supported by the linked OpenSSL library.

           Availability of specific protocols depends on the linked OpenSSL library.

           The <u>sslVersionMax</u> option is only available when compiled with <b>OpenSSL</b> <b>1.1.0</b> and later.

           default: all

       <b>sslVersionMin</b> = SSL_VERSION
           minimum supported protocol versions

           Supported versions: all, SSLv3, TLSv1, TLSv1.1, TLSv1.2, TLSv1.3

           <u>all</u> enable protocol versions down to the lowest version supported by the linked OpenSSL library.

           Availability of specific protocols depends on the linked OpenSSL library.

           The <u>sslVersionMin</u> option is only available when compiled with <b>OpenSSL</b> <b>1.1.0</b> and later.

           default: TLSv1

       <b>stack</b> = BYTES (except for FORK model)
           CPU stack size of created threads

           Excessive thread stack size increases virtual memory usage.  Insufficient thread stack size may cause
           application crashes.

           default: 65536 bytes (sufficient for all platforms we tested)

       <b>ticketKeySecret</b> = SECRET
           hexadecimal symmetric key used for session ticket confidentiality protection

           Session tickets defined in RFC 5077 provide an enhanced  session  resumption  capability,  where  the
           server-side caching is not required to maintain per session state.

           Combining  <u>ticketKeySecret</u>  and <u>ticketMacSecret</u> options allow to resume a negotiated session on other
           cluster nodes, or to resume a negotiated session after server restart.

           The key is required to be either 16 or 32 bytes long, which implies  exactly  32  or  64  hexadecimal
           digits.  Colons may optionally be used between two-character hexadecimal bytes.

           This option only works in server mode.

           The <u>ticketKeySecret</u> option is only available when compiled with <b>OpenSSL</b> <b>1.0.0</b> and later.

           Disabling  <u>NO_TICKET</u>  option is required for the ticket support in OpenSSL older than 1.1.1, but note
           that this option is incompatible with the <u>redirect</u> option.

       <b>ticketMacSecret</b> = SECRET
           hexadecimal symmetric key used for session ticket integrity protection

           The key is required to be either 16 or 32 bytes long, which implies  exactly  32  or  64  hexadecimal
           digits.  Colons may optionally be used between two-character hexadecimal bytes.

           This option only works in server mode.

           The <u>ticketMacSecret</u> option is only available when compiled with <b>OpenSSL</b> <b>1.0.0</b> and later.

       <b>TIMEOUTbusy</b> = SECONDS
           time to wait for expected data

       <b>TIMEOUTclose</b> = SECONDS
           time to wait for close_notify (set to 0 for buggy MSIE)

       <b>TIMEOUTconnect</b> = SECONDS
           time to wait to connect a remote host

       <b>TIMEOUTidle</b> = SECONDS
           time to keep an idle connection

       <b>TIMEOUTocsp</b> = SECONDS
           time to wait to connect an OCSP responder

       <b>transparent</b> = none | source | destination | both (Unix only)
           enable transparent proxy support on selected platforms

           Supported values:

           <u>none</u>
               Disable transparent proxy support.  This is the default.

           <u>source</u>
               Re-write  the  address to appear as if a wrapped daemon is connecting from the TLS client machine
               instead of the machine running <b>stunnel</b>.

               This option is currently available in:

               Remote mode (<u>connect</u> option) on <u>Linux</u> <u>&gt;=2.6.28</u>
                   This configuration requires <b>stunnel</b> to be executed as root and without the <u>setuid</u> option.

                   This configuration requires the  following  setup  for  iptables  and  routing  (possibly  in
                   /etc/rc.local or equivalent file):

                       iptables -t mangle -N DIVERT
                       iptables -t mangle -A PREROUTING -p tcp -m socket -j DIVERT
                       iptables -t mangle -A DIVERT -j MARK --set-mark 1
                       iptables -t mangle -A DIVERT -j ACCEPT
                       ip rule add fwmark 1 lookup 100
                       ip route add local 0.0.0.0/0 dev lo table 100
                       echo 0 &gt;<a href="file:/proc/sys/net/ipv4/conf/lo/rp_filter">/proc/sys/net/ipv4/conf/lo/rp_filter</a>

                   <b>stunnel</b> must also to be executed as root and without the <u>setuid</u> option.

               Remote mode (<u>connect</u> option) on <u>Linux</u> <u>2.2.x</u>
                   This  configuration  requires  the  kernel  to be compiled with the <u>transparent</u> <u>proxy</u> option.
                   Connected service must be installed on a separate host.  Routing towards the clients  has  to
                   go through the <b>stunnel</b> box.

                   <b>stunnel</b> must also to be executed as root and without the <u>setuid</u> option.

               Remote mode (<u>connect</u> option) on <u>FreeBSD</u> <u>&gt;=8.0</u>
                   This  configuration  requires additional firewall and routing setup.  <b>stunnel</b> must also to be
                   executed as root and without the <u>setuid</u> option.

               Local mode (<u>exec</u> option)
                   This  configuration  works  by  pre-loading  the  <u>libstunnel.so</u>  shared  library.   _RLD_LIST
                   environment variable is used on Tru64, and LD_PRELOAD variable on other platforms.

           <u>destination</u>
               The original destination is used instead of the <u>connect</u> option.

               A service section for transparent destination may look like this:

                   [transparent]
                   client = yes
                   accept = &lt;stunnel_port&gt;
                   transparent = destination

               This configuration requires iptables setup to work, possibly in /etc/rc.local or equivalent file.

               For a connect target installed on the same host:

                   <a href="file:/sbin/iptables">/sbin/iptables</a> -t nat -I OUTPUT -p tcp --dport &lt;redirected_port&gt; \
                       -m ! --uid-owner &lt;stunnel_user_id&gt; \
                       -j DNAT --to-destination &lt;local_ip&gt;:&lt;stunnel_port&gt;

               For a connect target installed on a remote host:

                   <a href="file:/sbin/iptables">/sbin/iptables</a> -I INPUT -i eth0 -p tcp --dport &lt;stunnel_port&gt; -j ACCEPT
                   <a href="file:/sbin/iptables">/sbin/iptables</a> -t nat -I PREROUTING -p tcp --dport &lt;redirected_port&gt; \
                       -i eth0 -j DNAT --to-destination &lt;local_ip&gt;:&lt;stunnel_port&gt;

               The transparent destination option is currently only supported on Linux.

           <u>both</u>
               Use both <u>source</u> and <u>destination</u> transparent proxy.

           Two legacy options are also supported for backward compatibility:

           <u>yes</u> This option has been renamed to <u>source</u>.

           <u>no</u>  This option has been renamed to <u>none</u>.

       <b>verify</b> = LEVEL
           verify the peer certificate

           This option is obsolete and should be replaced with the <u>verifyChain</u> and <u>verifyPeer</u> options.

           level 0
               Request and ignore the peer certificate chain.

           level 1
               Verify the peer certificate chain if present.

           level 2
               Verify the peer certificate chain.

           level 3
               Verify  the  peer  certificate chain and the end-entity (leaf) peer certificate against a locally
               installed certificate.

           level 4
               Ignore the peer certificate chain and only verify the end-entity (leaf) peer certificate  against
               a locally installed certificate.

           default
               No verify.

       <b>verifyChain</b> = yes | no
           verify the peer certificate chain starting from the root CA

           For  server  certificate  verification  it  is  essential to also require a specific certificate with
           <u>checkHost</u> or <u>checkIP</u>.

           The self-signed root CA certificate needs to be stored either in the file specified with  <u>CAfile</u>,  or
           in the directory specified with <u>CApath</u>.

           default: no

       <b>verifyPeer</b> = yes | no
           verify the end-entity (leaf) peer certificate

           The  end-entity  (leaf) peer certificate needs to be stored either in the file specified with <u>CAfile</u>,
           or in the directory specified with <u>CApath</u>.

           default: no

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>stunnel</b> returns zero on success, non-zero on error.

</pre><h4><b>SIGNALS</b></h4><pre>
       The following signals can be used to control <b>stunnel</b> in Unix environment:

       SIGHUP
           Force a reload of the configuration file.

           Some global options will not be reloaded:

           •   chroot

           •   foreground

           •   pid

           •   setgid

           •   setuid

           The use of the 'setuid' option will also prevent <b>stunnel</b> from binding  to  privileged  (&lt;1024)  ports
           during configuration reloading.

           When  the  'chroot'  option is used, <b>stunnel</b> will look for all its files (including the configuration
           file, certificates, the log file and the pid file) within the chroot jail.

       SIGUSR1
           Close and reopen the <b>stunnel</b> log file.  This function can be used for log rotation.

       SIGUSR2
           Log the list of active connections.

       SIGTERM, SIGQUIT, SIGINT
           Shut <b>stunnel</b> down.

       The result of sending any other signals to the server is undefined.

</pre><h4><b>EXAMPLES</b></h4><pre>
       In order to provide TLS encapsulation to your local <u>imapd</u> service, use:

           [imapd]
           accept = 993
           exec = /usr/sbin/imapd
           execArgs = imapd

       or in remote mode:

           [imapd]
           accept = 993
           connect = 143

       In order to let your local e-mail client connect to  a  TLS-enabled  <u>imapd</u>  service  on  another  server,
       configure the e-mail client to connect to localhost on port 119 and use:

           [imap]
           client = yes
           accept = 143
           connect = servername:993

       If you want to provide tunneling to your <u>pppd</u> daemon on port 2020, use something like:

           [vpn]
           accept = 2020
           exec = /usr/sbin/pppd
           execArgs = pppd local
           pty = yes

       If you want to use <b>stunnel</b> in <u>inetd</u> mode to launch your imapd process, you'd use this <u>stunnel.conf</u>.  Note
       there must be no <u>[service_name]</u> section.

           exec = /usr/sbin/imapd
           execArgs = imapd

       To setup SOCKS VPN configure the following client service:

           [socks_client]
           client = yes
           accept = 127.0.0.1:1080
           connect = vpn_server:9080
           verifyPeer = yes
           CAfile = stunnel.pem

       The corresponding configuration on the vpn_server host:

           [socks_server]
           protocol = socks
           accept = 9080
           cert = stunnel.pem
           key = stunnel.key

       Now test your configuration on the client machine with:

           curl --socks4a localhost <a href="http://www.example.com/">http://www.example.com/</a>

       An example server mode SNI configuration:

           [virtual]
           ; primary service
           accept = 443
           cert =  default.pem
           connect = default.internal.mydomain.com:8080

           [sni1]
           ; secondary service 1
           sni = virtual:server1.mydomain.com
           cert = server1.pem
           connect = server1.internal.mydomain.com:8081

           [sni2]
           ; secondary service 2
           sni = virtual:server2.mydomain.com
           cert = server2.pem
           connect = server2.internal.mydomain.com:8082
           verifyPeer = yes
           CAfile = server2-allowed-clients.pem

       An  example  of  advanced  engine configuration allows for authentication with private keys stored in the
       Windows certificate store (Windows only).  With the CAPI engine you don't need  to  manually  select  the
       client  key  to  use.   The  client key is automatically selected based on the list of CAs trusted by the
       server.

           engine = capi

           [service]
           engineId = capi
           client = yes
           accept = 127.0.0.1:8080
           connect = example.com:8443

       An example of advanced engine configuration to use the certificate and the corresponding private key from
       a pkcs11 engine:

           engine = pkcs11
           engineCtrl = MODULE_PATH:opensc-pkcs11.so
           engineCtrl = PIN:123456

           [service]
           engineId = pkcs11
           client = yes
           accept = 127.0.0.1:8080
           connect = example.com:843
           cert = pkcs11:token=MyToken;object=MyCert
           key = pkcs11:token=MyToken;object=MyKey

       An example of advanced engine configuration to use the certificate and the corresponding private key from
       a SoftHSM token:

           engine = pkcs11
           engineCtrl = MODULE_PATH:softhsm2.dll
           engineCtrl = PIN:12345

           [service]
           engineId = pkcs11
           client = yes
           accept = 127.0.0.1:8080
           connect = example.com:843
           cert = pkcs11:token=MyToken;object=KeyCert

</pre><h4><b>NOTES</b></h4><pre>
   <b>RESTRICTIONS</b>
       <b>stunnel</b> cannot be used for the FTP daemon because of the  nature  of  the  FTP  protocol  which  utilizes
       multiple  ports  for data transfers.  There are available TLS-enabled versions of FTP and telnet daemons,
       however.

   <b>INETD</b> <b>MODE</b>
       The most common use of <b>stunnel</b> is to listen on a network port and establish communication with  either  a
       new  port  via the connect option, or a new program via the <u>exec</u> option.  However there is a special case
       when you wish to have some other program accept incoming connections and launch <b>stunnel</b>, for example with
       <u>inetd</u>, <u>xinetd</u>, or <u>tcpserver</u>.

       For example, if you have the following line in <u>inetd.conf</u>:

           imaps stream tcp nowait root /usr/bin/stunnel stunnel /etc/stunnel/imaps.conf

       In these cases, the <u>inetd</u>-style program is responsible for binding a network  socket  (<u>imaps</u>  above)  and
       handing  it  to  <b>stunnel</b>  when a connection is received.  Thus you do not want <b>stunnel</b> to have any <u>accept</u>
       option.  All the <u>Service</u>  <u>Level</u>  <u>Options</u>  should  be  placed  in  the  global  options  section,  and  no
       <u>[service_name]</u> section will be present.  See the <u>EXAMPLES</u> section for example configurations.

   <b>CERTIFICATES</b>
       Each  TLS-enabled  daemon needs to present a valid X.509 certificate to the peer. It also needs a private
       key to decrypt the incoming data. The easiest way to obtain a certificate and a key is to  generate  them
       with  the  free <b>OpenSSL</b> package. You can find more information on certificates generation on pages listed
       below.

       The <u>.pem</u> file should contain the unencrypted private  key  and  a  signed  certificate  (not  certificate
       request).  So the file should look like this:

           -----BEGIN RSA PRIVATE KEY-----
           [encoded key]
           -----END RSA PRIVATE KEY-----
           -----BEGIN CERTIFICATE-----
           [encoded certificate]

           -----END CERTIFICATE-----
   <b>RANDOMNESS</b>
       <b>stunnel</b>  needs to seed the PRNG (pseudo-random number generator) in order for TLS to use good randomness.
       The following sources are loaded in order until sufficient random data has been gathered:

       •   The file specified with the <u>RNDfile</u> flag.

       •   The file specified by the RANDFILE environment variable, if set.

       •   The file .rnd in your home directory, if RANDFILE not set.

       •   The file specified with '--with-random' at compile time.

       •   The contents of the screen if running on Windows.

       •   The egd socket specified with the <u>EGD</u> flag.

       •   The egd socket specified with '--with-egd-sock' at compile time.

       •   The /dev/urandom device.

       Note that on Windows machines that do not  have  console  user  interaction  (mouse  movements,  creating
       windows,  etc.)  the  screen  contents are not variable enough to be sufficient, and you should provide a
       random file for use with the <u>RNDfile</u> flag.

       Note that the file specified with the <u>RNDfile</u> flag should contain random data --  that  means  it  should
       contain  different  information  each  time  <b>stunnel</b>  is  run.   This is handled automatically unless the
       <u>RNDoverwrite</u> flag is used.  If you wish to update this file manually, the <u>openssl</u> <u>rand</u> command in  recent
       versions of <b>OpenSSL</b>, would be useful.

       Important  note:  If  /dev/urandom  is available, <b>OpenSSL</b> often seeds the PRNG with it while checking the
       random state.  On systems with /dev/urandom <b>OpenSSL</b> is likely to use it even though it is listed  at  the
       very bottom of the list above.  This is the behaviour of <b>OpenSSL</b> and not <b>stunnel</b>.

   <b>DH</b> <b>PARAMETERS</b>
       <b>stunnel</b>  4.40  and  later  contains  hardcoded 2048-bit DH parameters.  Starting with <b>stunnel</b> 5.18, these
       hardcoded DH parameters are replaced every 24 hours  with  autogenerated  temporary  DH  parameters.   DH
       parameter generation may take several minutes.

       Alternatively,  it  is  possible  to specify static DH parameters in the certificate file, which disables
       generating temporary DH parameters:

           openssl dhparam 2048 &gt;&gt; stunnel.pem

</pre><h4><b>FILES</b></h4><pre>
       <u>@sysconfdir@/stunnel/stunnel.conf</u>
           <b>stunnel</b> configuration file

</pre><h4><b>BUGS</b></h4><pre>
       The <u>execArgs</u> option and the Win32 command line do not support quoting.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/tcpd.8.html">tcpd</a></b>(8)
           access control facility for internet services

       <b><a href="../man8/inetd.8.html">inetd</a></b>(8)
           internet 'super-server'

       <u><a href="http://www.stunnel.org/">http://www.stunnel.org/</a></u>
           <b>stunnel</b> homepage

       <u><a href="http://www.openssl.org/">http://www.openssl.org/</a></u>
           <b>OpenSSL</b> project website

</pre><h4><b>AUTHOR</b></h4><pre>
       Michał Trojnara
           &lt;<u><a href="mailto:Michal.Trojnara@stunnel.org">Michal.Trojnara@stunnel.org</a></u>&gt;

5.74                                               2025.01.28                                         <u><a href="../man8/stunnel.8.html">stunnel</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>