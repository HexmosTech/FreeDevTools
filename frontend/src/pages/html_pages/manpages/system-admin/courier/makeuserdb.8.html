<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>makeuserdb - create /etc/courier/userdb</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/courier-authlib-userdb">courier-authlib-userdb_0.72.4-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       makeuserdb - create /etc/courier/userdb

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>makeuserdb</b> [-f <u>filename</u>]

       <b>pw2userdb</b>

       <b>vchkpw2userdb</b> [--vpopmailhome=<u>dir</u>] [--todir=<u>dir</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>makeuserdb</b> creates /etc/courier/userdb.dat from the contents of /etc/courier/userdb.
       /etc/courier/userdb's contents are described later in this document.  Maildrop, Courier, and other
       applications use /etc/courier/userdb.dat as a substitute/complement for your system password file. The
       usual purpose for /etc/courier/userdb.dat is to specify "virtual" accounts - accounts that do not have an
       associated system login. Usually (but not necessarily) all virtual accounts share the same system userid.
       /etc/courier/userdb.dat may also replace your system password file. Because the system password file is a
       text file, when there's a large number of accounts it will be significantly faster to search
       @userdb.dat@, which is a binary database, instead of a flat text file that the system password file
       usually is.

       The <b>makeuserdb</b> command can be safely executed during normal system activity.

       The <b>-f</b> option creates <u>filename</u>.dat from <u>filename</u>, instead of the default /etc/courier/userdb.dat from
       /etc/courier/userdb.

   <b>Format</b> <b>of</b> <b>/etc/courier/userdb</b>
       /etc/courier/userdb is a plain text file that can be created using any text editor. Blank lines are
       ignored. Lines that start with the # character are comments, and are also ignored. Other lines define
       properties of a single "account", one line per account.  /etc/courier/userdb may be a directory instead
       of a plain file. In that case all files in /etc/courier/userdb are essentially concatenated, and are
       treated as a single file. Each line takes the following format:

           <u>name</u>&lt;TAB&gt;<u>field</u>=<u>value</u>|<u>field</u>=<u>value</u>...

       <u>name</u> is the account name.  <u>name</u> MUST contain only lowercase characters If Courier is configured to treat
       lowercase and uppercase account names as identical, <u>name</u> is followed by exactly one tab character, then a
       list of field/value pairs separated by vertical slashes.  <u>field</u> is the name of the field, <u>value</u> is the
       field value. Fields and values themself cannot contain slashes or control characters. Fields may be
       specified in any order. Here are all the currently defined fields. Note that not every field is used by
       every application that reads /etc/courier/userdb.dat.

       <u>uid</u> - <u>value</u> is a (possibly) unique numerical user ID for this account.

       <u>gid</u> - <u>value</u> is a (possibly) unique numerical group ID for this account.

       <u>home</u> - <u>value</u> is the account's home directory.

       <u>shell</u> - <u>value</u> is the account's default login shell.

       <u>systempw</u> - <u>value</u> is the account's password. See <b><a href="../man8/userdbpw.8.html">userdbpw</a></b>(8)[1] for details on how to set up this field.

       <u>pop3pw,</u> <u>esmtppw,</u> <u>imappw...</u>  - <u>value</u> specifies a separate password used only for authenticating access
       using a specific service, such as POP3, IMAP, or anything else. If not defined, <u>systempw</u> is always used.
       This allows access to an account to be restricted only to certain services, such as POP3, even if other
       services are also enabled on the server.

       <u>mail</u> - <u>value</u> specifies the location of the account's Maildir mailbox. This is an optional field that is
       normally used when <b>userdb</b> is used to provide aliases for other mail accounts. For example, one particular
       multi-domain E-mail service configuration that's used by both Qmail and Courier servers is to deliver
       mail for a mailbox in a virtual domain, such as "<a href="mailto:user@example.com">user@example.com</a>", to a local mailbox called
       "example-user". Instead of requiring the E-mail account holder to log in as "example-user" to download
       mail from this account, a <b>userdb</b> entry for "<a href="mailto:user@example.com">user@example.com</a>" is set up with <u>mail</u> set to the location of
       example-user's Maildir mailbox, thus hiding the internal mail configuration from the E-mail account
       holder's view.

       <u>quota</u> - <u>value</u> specifies the maildir quota for the account's Maildir. This has nothing to do with actual
       filesystem quotas.  Courier has a software-based Maildir quota enforcement mechanism which requires
       additional setup and configuration. See <b><a href="../man7/maildirquota.7.html">maildirquota</a></b>(7)[2] for additional information.

   <b>/etc/courier/userdbshadow.dat</b>
       All fields whose name ends with 'pw' will NOT copied to /etc/courier/userdb.dat. These fields will be
       copied to /etc/courier/userdbshadow.dat.  <b>makeuserdb</b> creates /etc/courier/userdbshadow.dat without any
       group and world permissions. Note that <b>makeuserdb</b> reports an error if <b>/etc/courier/userdb</b> has any group
       or world permissions.

   <b>CONVERTING</b> <b><a href="file:/etc/passwd">/etc/passwd</a></b> <b>and</b> <b>vpopmail</b> <b>to</b> <b>/etc/courier/userdb</b> <b>format</b>
       <b>pw2userdb</b> reads the <a href="file:/etc/passwd">/etc/passwd</a> and <a href="file:/etc/shadow">/etc/shadow</a> files and converts all entries to the /etc/courier/userdb
       format, printing the result on standard output. The output of <b>pw2userdb</b> can be saved as
       <b>/etc/courier/userdb</b> (or as some file in this subdirectory). Linear searches of <a href="file:/etc/passwd">/etc/passwd</a> can be very
       slow when you have tens of thousands of accounts. Programs like <b>maildrop</b> always look in
       /etc/courier/userdb first. By saving the system password file in /etc/courier/userdb it is possible to
       significantly reduce the amount of time it takes to look up this information.

       After saving the output of <b>pw2userdb</b>, you must still run <b>makeuserdb</b> to create /etc/courier/userdb.dat.

       <b>vchkpw2userdb</b> converts a vpopmail-style directory hierarchy to the /etc/courier/userdb format. This is an
       external virtual domain management package that's often used with Qmail servers.

       Generally, an account named 'vpopmail' is reserved for this purpose. In that account the file
       users/vpasswd has the same layout as <a href="file:/etc/passwd">/etc/passwd</a>, and performs a similar function, except that all userid
       in users/vpasswd have the same userid. Additionally, the domains subdirectory stores virtual accounts for
       multiple domains. For example, domains/example.com/vpasswd has the passwd file for the domain
       <u>example.com</u>. Some systems also have a soft link, <u>domains/default</u>, that points to a domain that's
       considered a "default" domain.

       The <b>vchkpw2userdb</b> reads all this information, and tries to convert it into the /etc/courier/userdb
       format. The <u>--vpopmailhost</u> option specifies the top level directory, if it is not the home directory of
       the vpopmail account.

       The <b>vchkpw2userdb</b> script prints the results on standard output. If specified, the <u>--todir</u> option tries to
       convert all vpasswd files one at a time, saving each one individually in <u>dir</u>. For example:

           mkdir /etc/courier/userdb
           vchkpw2userdb --todir=/etc/courier/userdb/vpopmail
           makeuserdb

       It is still necessary to run <b>makeuserdb</b>, of course, to create the binary database file
       /etc/courier/userdb.dat

       NOTE: You are still required to create the <b>/etc/courier/userdb</b> entry which maps system userids back to
       accounts, "<u>uid</u>=&lt;TAB&gt;<u>name</u>", if that's applicable.  <b>vchkpw2userdb</b> will not do it for you.

       NOTE: <b>makeuserdb</b> may complain about duplicate entries, if your "default" entries in users/vpasswd or
       domains/default/vpasswd are the same as anything in any other /etc/courier/userdb file. It is also likely
       that you'll end up with duplicate, but distinct, entries for every account in the default domain. For
       example, if your default domain is example.com, you'll end up with duplicate entries - you'll have
       entries for both <u>user</u> and <u><a href="mailto:user@example.com">user@example.com</a></u>.

       If you intend to maintain the master set of accounts using vchkpw/vpopmail, in order to avoid cleaning
       this up every time, you might want to consider doing the following: run <b>vchkpw2userdb</b> once, using the
       <u>--todir</u> option. Then, go into the resulting directory, and replace one of the redundant files with a soft
       link to /dev/null. This allows you to run <b>vchkpw2userdb</b> without having to go in and cleaning up again,
       afterwards.

</pre><h4><b>FILES</b></h4><pre>
           /etc/courier/userdb
           /etc/courier/userdb.dat
           /etc/courier/userdbshadow.dat
           /etc/courier/userdb.tmp - temporary file
           /etc/courier/userdbshadow.tmp - temporary file

</pre><h4><b>BUGS</b></h4><pre>
       <b>makeuserdb</b> is a Perl script, and uses Perl's portable locking. Perl's documentation notes that certain
       combinations of locking options may not work with some networks.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/userdb.8.html">userdb</a></b>(8)[3], <b><a href="../man8/maildrop.8.html">maildrop</a></b>(8)[4], <b><a href="../man8/courier.8.html">courier</a></b>(8)[5], <b><a href="../man7/maildirquota.7.html">maildirquota</a></b>(7)[2].

</pre><h4><b>NOTES</b></h4><pre>
        1. <b><a href="../man8/userdbpw.8.html">userdbpw</a></b>(8)
           [set $man.base.url.for.relative.links]/userdbpw.html

        2. <b><a href="../man7/maildirquota.7.html">maildirquota</a></b>(7)
           [set $man.base.url.for.relative.links]/maildirquota.html

        3. <b><a href="../man8/userdb.8.html">userdb</a></b>(8)
           [set $man.base.url.for.relative.links]/userdb.html

        4. <b><a href="../man8/maildrop.8.html">maildrop</a></b>(8)
           [set $man.base.url.for.relative.links]/maildrop.html

        5. <b><a href="../man8/courier.8.html">courier</a></b>(8)
           [set $man.base.url.for.relative.links]/courier.html

Double Precision, Inc.                             10/28/2020                                      <u><a href="../man8/MAKEUSERDB.8.html">MAKEUSERDB</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>