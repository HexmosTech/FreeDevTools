<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gnt-filter - Ganeti job filter rule administration</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ganeti-3.1">ganeti-3.1_3.1.0~rc2-3_all</a> <br><br><pre>
</pre><h4><b>Name</b></h4><pre>
       gnt-filter - Ganeti job filter rule administration

</pre><h4><b>Synopsis</b></h4><pre>
       <b>gnt-filter</b> {command} [options...]  [arguments...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>gnt-filter</b> command is used for managing job filter rules in the Ganeti system.  Filter rules are used
       by the Ganeti job scheduler to determine which jobs should be accepted, rejected, paused or rate-limited.

       Filter rules consist of the following:

       • A UUID, used to refer to existing filters.

       • A watermark.  This is the highest job id ever used, as valid in the moment when the filter was added or
         replaced.

       • A  priority.   This  is a non-negative integer.  Filters are processed in order of increasing priority.
         While there is a well-defined order in which rules of  the  same  priority  are  evaluated  (increasing
         watermark,  then  the UUID, are taken as tie breakers), it is not recommended to have rules of the same
         priority that overlap and have different actions associated.

       • A list of predicates to be matched against the job.

         A predicate is a list, with the first element being the name  of  the  predicate  and  the  rest  being
         parameters  suitable  for  that predicate.  Most predicates take a single parameter, which is a boolean
         expression formulated in the of the Ganeti query language.  The  currently  supported  predicate  names
         are:

         • jobid.   Only  parameter  is  a  boolean  expression.   For  this expression, there is only one field
           available, id, which represents the id the job to be filtered.  In all value  positions,  the  string
           watermark is replaced by the value of the watermark of the filter rule.

         • opcode.   Only  parameter  is  a boolean expression.  For this expression, OP_ID and all other fields
           present in the opcode are available.  This predicate will hold true, if the expression is true for at
           least one opcode in the job.

         • reason.  Only parameter is a boolean expression.  For  this  expression,  the  three  fields  source,
           reason,  timestamp  of  reason  trail  entries  are available.  This predicate is true, if one of the
           entries of one of the opcodes in this job satisfies the expression.

       • An action.  One of:

         • ACCEPT.  The job will be accepted; no further filter rules are applied.

         • PAUSE.  The job will be accepted to the queue and remain there; however, it is not executed.  Has  no
           effect if the job is already running.

         • REJECT.  The job is rejected.  If it is already in the queue, it will be cancelled.

         • CONTINUE.   The  filtering  continues processing with the next rule.  Such a rule will never have any
           direct or indirect effect, but it can serve as documentation for a "normally present,  but  currently
           disabled" rule.

         • RATE_LIMIT  n, where n is a positive integer.  The job will be held in the queue while n or more jobs
           where this rule applies are running.  Jobs already running when this rule is added are  not  changed.
           Logically,  this  rule is applied job by job sequentially, so that the number of jobs where this rule
           applies is limited to n once the jobs running at rule addition have finished.

       • A reason trail, in the same format as reason trails  for  job  opcodes  (see  the  --reason  option  in
         <b><a href="../man7/ganeti.7.html">ganeti</a></b>(7)).   This  allows  to find out which maintenance (or other reason) caused the addition of this
         filter rule.

</pre><h4><b>COMMANDS</b></h4><pre>
   <b>ADD</b>
       <b>add</b>
       [--priority=*priority*]
       [--predicates=*predicates*]
       [--action=*action*]

       Creates a new filter rule.  A UUID is automatically assigned.

       The --priority option sets the priority of the filter.  It is a non-negative integer.   Default:  0  (the
       highest possible priority).

       The  --predicates  option  sets  the  predicates of the filter.  It is a list of predicates in the format
       described in the <b>DESCRIPTION</b> above.  Default: [] (no predicate, filter always matches).

       The --action option sets the action of the filter.  It is one  of  the  strings  ACCEPT,  PAUSE,  REJECT,
       CONTINUE, or RATE_LIMIT n (see the <b>DESCRIPTION</b> above).  Default: CONTINUE.

       See <b><a href="../man7/ganeti.7.html">ganeti</a></b>(7) for a description of --reason and other common options.

   <b>REPLACE</b>
       <b>replace</b>
       [--priority=*priority*]
       [--predicates=*predicates*]
       [--action=*action*]
       [--reason=*reason*]
       {<u>filter-uuid</u>}

       Replaces a filter rule, or creates one if it doesn't already exist.

       Accepts all options described above in ADD.

       When being replaced, the filter will be assigned an updated watermark.

       See <b><a href="../man7/ganeti.7.html">ganeti</a></b>(7) for a description of --reason and other common options.

   <b>DELETE</b>
       <b>delete</b> {<u>filter-uuid</u>}

       Deletes the indicated filter rule.

   <b>LIST</b>
       <b>list</b> [--no-headers] [--separator=*separator*] [-v]
       [-o <u>[+]field,...</u>] [filter-uuid...]

       Lists  all existing filters in the cluster.  If no filter UUIDs are given, then all filters are included.
       Otherwise, only the given filters will be listed.

       The --no-headers option will skip the initial header line.  The  --separator  option  takes  an  argument
       which denotes what will be used between the output fields.  Both these options are to help scripting.

       The -v option activates verbose mode, which changes the display of special field states (see <b><a href="../man7/ganeti.7.html">ganeti</a></b>(7)).

       The  -o option takes a comma-separated list of output fields.  If the value of the option starts with the
       character +, the new fields will be added to the default list.  This allows to quickly  see  the  default
       list plus a few other fields, instead of retyping the entire list of fields.

       The available fields and their meaning are:

       action Action

       predicates
              Predicates

       priority
              Priority

       reason_trail
              Reason trail

       uuid   Network UUID

       watermark
              Watermark

   <b>LIST-FIELDS</b>
       <b>list-fields</b> [field...]

       List available fields for filters.

   <b>INFO</b>
       <b>info</b> [filter-uuid...]

       Displays information about a given filter.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Draining the queue.  :

              gnt-filter add '--predicates=[["jobid", ["&gt;", "id", "watermark"]]]' --action=REJECT

       Soft draining could be achieved by replacing REJECT by PAUSE in the above example.

       Pausing all new jobs not belonging to a specific maintenance.  :

              gnt-filter add --priority=0 '--predicates=[["reason", ["=~", "reason", "maintenance pink bunny"]]]' --action=ACCEPT
              gnt-filter add --priority=1 '--predicates=[["jobid", ["&gt;", "id", "watermark"]]]' --action=PAUSE

       Cancelling all queued instance creations and disallowing new such jobs.  :

              gnt-filter add '--predicates=[["opcode", ["=", "OP_ID", "OP_INSTANCE_CREATE"]]]' --action=REJECT

       Limiting  the  number  of  simultaneous instance disk replacements to 10 in order to throttle replication
       traffic.  :

              gnt-filter add '--predicates=[["opcode", ["=", "OP_ID", "OP_INSTANCE_REPLACE_DISKS"]]]' '--action=RATE_LIMIT 10'

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to the project's issue tracker or contact the developers using the Ganeti mailing list.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Ganeti overview and  specifications:  <b><a href="../man7/ganeti.7.html">ganeti</a></b>(7)  (general  overview),  <b><a href="../man7/ganeti-os-interface.7.html">ganeti-os-interface</a></b>(7)  (guest  OS
       definitions), <b><a href="../man7/ganeti-extstorage-interface.7.html">ganeti-extstorage-interface</a></b>(7) (external storage providers).

       Ganeti  commands:  <b><a href="../man8/gnt-cluster.8.html">gnt-cluster</a></b>(8) (cluster-wide commands), <b><a href="../man8/gnt-job.8.html">gnt-job</a></b>(8) (job-related commands), <b><a href="../man8/gnt-node.8.html">gnt-node</a></b>(8)
       (node-related  commands),  <b><a href="../man8/gnt-instance.8.html">gnt-instance</a></b>(8)  (instance   commands),   <b><a href="../man8/gnt-os.8.html">gnt-os</a></b>(8)   (guest   OS   commands),
       <b><a href="../man8/gnt-storage.8.html">gnt-storage</a></b>(8)   (storage   commands),   <b><a href="../man8/gnt-group.8.html">gnt-group</a></b>(8)  (node  group  commands),  <b><a href="../man8/gnt-backup.8.html">gnt-backup</a></b>(8)  (instance
       import/export commands), <b><a href="../man8/gnt-debug.8.html">gnt-debug</a></b>(8) (debug commands).

       Ganeti daemons: <b><a href="../man8/ganeti-watcher.8.html">ganeti-watcher</a></b>(8) (automatic instance restarter), <b><a href="../man8/ganeti-cleaner.8.html">ganeti-cleaner</a></b>(8) (job queue  cleaner),
       <b><a href="../man8/ganeti-noded.8.html">ganeti-noded</a></b>(8) (node daemon), <b><a href="../man8/ganeti-rapi.8.html">ganeti-rapi</a></b>(8) (remote API daemon).

       Ganeti  htools: <b><a href="../man1/htools.1.html">htools</a></b>(1) (generic binary), <b><a href="../man1/hbal.1.html">hbal</a></b>(1) (cluster balancer), <b><a href="../man1/hspace.1.html">hspace</a></b>(1) (capacity calculation),
       <b><a href="../man1/hail.1.html">hail</a></b>(1) (IAllocator plugin), <b><a href="../man1/hscan.1.html">hscan</a></b>(1) (data gatherer from remote clusters), <b><a href="../man1/hinfo.1.html">hinfo</a></b>(1) (cluster information
       printer), <b><a href="../man7/mon-collector.7.html">mon-collector</a></b>(7) (data collectors interface).

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2006-2015 Google Inc.  All rights reserved.

       Redistribution and use in source and binary forms, with or without modification, are  permitted  provided
       that the following conditions are met:

       1.   Redistributions  of  source code must retain the above copyright notice, this list of conditions and
       the following disclaimer.

       2.  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and
       the following disclaimer in the documentation and/or other materials provided with the distribution.

       THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY  EXPRESS  OR  IMPLIED
       WARRANTIES,  INCLUDING,  BUT  NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
       PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE  FOR
       ANY  DIRECT,  INDIRECT,  INCIDENTAL,  SPECIAL,  EXEMPLARY,  OR  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
       LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF  USE,  DATA,  OR  PROFITS;  OR  BUSINESS
       INTERRUPTION)  HOWEVER  CAUSED  AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
       TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE  OF  THIS  SOFTWARE,  EVEN  IF
       ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

Ganeti                                                                                             <u><a href="../man8/gnt-filter.8.html">gnt-filter</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>