<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>inject  -  injects appropriate error into function if input call chain and predicates are satisfied. Uses</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bpfcc-tools">bpfcc-tools_0.31.0+ds-7ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       inject  -  injects appropriate error into function if input call chain and predicates are satisfied. Uses
       Linux eBPF/bcc.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>inject</b> <b>-h</b> <b>[-I</b> <b>header]</b> <b>[-P</b> <b>probability]</b> <b>[-v]</b> <b>[-c</b> <b>count]</b> <b>&lt;mode&gt;</b> <b>&lt;spec&gt;</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       inject injects errors into specified  kernel  functionality  when  a  given  call  chain  and  associated
       predicates are satisfied.

       WARNING:  This  tool injects failures into key kernel functions and may crash the kernel. You should know
       what you're doing if you're using this tool.

       This makes use of a Linux 4.16 feature (bpf_override_return())

       Since this uses BPF, only the root user can use this tool.

</pre><h4><b>OPTIONS</b></h4><pre>
       -h     Print usage message.

       -v     Display the generated BPF program, for debugging or modification.

       -I header
              Necessary headers to be included.

       -P probability
              Optional probability of failure, default 1.

       -c count
              Number of errors to inject before stopping, default never stops.

</pre><h4><b>MODE</b></h4><pre>
       <b>kmalloc</b>
              Make the following function indicate failure
                     int should_failslab(struct kmem_cache *s, gfp_t gfpflags)

       <b>bio</b>    Make the following function indicate failure
                     int should_fail_bio(struct bio *bio)

       <b>alloc_page</b>
              Make the following function indicate failure
                     bool should_fail_alloc_page(gfp_t gfp_mask, unsigned int order)

</pre><h4><b>SPEC</b></h4><pre>
       <b>FUNCTION([ARGS])[(TEST)]</b> <b>[=&gt;</b> <b>...]</b>

       A list of predicates separated by "=&gt;". A predicate is a function signature (name  and  arguments)  in  a
       call stack and a test on the function's arguments.

       Missing  predicates  are  implicitly  true.  Missing  tests are implicitly true.  Specifying the function
       arguments is optional if the test does not use them.  If the error injection function is  not  listed  as
       the first predicate, it is implicitly added.

       Functions  are  listed in the reverse order that they are called, ie. if a() calls b(), the spec would be
       "b() =&gt; a()".

</pre><h4><b>REQUIREMENTS</b></h4><pre>
       CONFIG_BPF, CONFIG_BPF_KPROBE_OVERRIDE, bcc

</pre><h4><b>EXAMPLES</b></h4><pre>
       inject kmalloc -v 'SyS_mount()'

       inject kmalloc -v 'mount_subtree() =&gt; btrfs_mount()'

       inject -P 0.5 -c 100 alloc_page "should_fail_alloc_page(gfp_t gfp_mask, unsigned int order) (order == 1) =&gt; qlge_refill_bq()"

       Please see the output of '-h' and tools/inject_example.txt for more examples.

</pre><h4><b>SOURCE</b></h4><pre>
       This is from bcc.

              https://github.com/iovisor/bcc

       Also look in the bcc distribution for a companion _examples.txt file containing  example  usage,  output,
       and commentary for this tool.

</pre><h4><b>OS</b></h4><pre>
       Linux

</pre><h4><b>STABILITY</b></h4><pre>
       Unstable - in development.

</pre><h4><b>AUTHOR</b></h4><pre>
       Howard McLauchlan

USER COMMANDS                                      2018-03-16                                          <u><a href="../man8/inject.8.html">inject</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>