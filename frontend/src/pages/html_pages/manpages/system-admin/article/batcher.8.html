<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>batcher - Article batching for InterNetNews</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/inn2">inn2_2.7.3-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       batcher - Article batching for InterNetNews

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>batcher</b> [<b>-rv</b>] [<b>-a</b> <u>articles</u>] [<b>-A</b> <u>total-articles</u>] [<b>-b</b> <u>size</u>] [<b>-B</b> <u>total-size</u>] [<b>-i</b> <u>string</u>] [<b>-N</b> <u>batches</u>] [<b>-p</b>
       <u>process</u>] [<b>-s</b> <u>separator</u>] <u>host</u> [<u>input</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>batcher</b> reads a list of files and prepares news batches for the specified host.  It is generally used to
       prepare UUCP feeds, but the resulting batches can be used by any application that uses <a href="../man1/rnews.1.html">rnews</a>(1) to inject
       the articles.  It is normally invoked by a script run out of cron that uses <b>shlock</b> to lock the host,
       followed by <b>ctlinnd</b> to flush the batch file.  See <a href="../man8/send-uucp.8.html">send-uucp</a>(8) for a front-end for <b>batcher</b>.

       <b>batcher</b> reads the file <u>input</u>, or standard input if no file is given.  If <u>input</u> is a relative file name,
       it is assumed to be in <u>pathoutgoing</u> as set in <u>inn.conf</u>.  Blank lines and lines starting with a number
       sign ("#") are ignored.  All other lines in the input should consist of one or two fields separated by a
       single space.  The first field is the storage API token of an article.  The second field, if present,
       specifies the size of the article in bytes.

       By default, batches are written to standard output (which isn't very useful if more than one batch is
       output), but see the <b>-p</b> option.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-a</b> <u>articles</u>
           This  flag  limits  the  number  of articles included in each batch.  The default is no limit.  A new
           batch will be started when either the total bytes or the  number  of  articles  written  exceeds  the
           specified limits.

       <b>-A</b> <u>total-articles</u>
           Limits the total number of articles written for all batches.  As soon as the total number of articles
           written  to  batches  reaches or exceeds <u>total-articles</u>, all additional articles in the input will be
           deferred.  The default is no limit.

       <b>-b</b> <u>size</u>
           This flag sets the size limit for each batch; as soon as at least this much  data  has  been  written
           out,  a  new  batch  will  be started.  The default size is 60 KB.  Using "-b 0" will allow unlimited
           batch sizes.

       <b>-B</b> <u>total-size</u>
           Limits the total number of bytes written for all batches.  As soon as  the  total  bytes  written  to
           batches  reaches  or  exceeds <u>total-size</u>, all additional articles in the input will be deferred.  The
           default is no limit.

       <b>-i</b> <u>string</u>
           A batch starts with an identifying line to specify the unpacking method to be used on  the  receiving
           end.   When  this  flag  is  used, <u>string</u>, followed by a newline, will be output at the start of each
           batch.  The default is to have no initial string (under the  assumption  that  either  the  processor
           specified with the <b>-p</b> flag or some other later process will add the appropriate line).

       <b>-N</b> <u>batches</u>
           Limits  the  total  number  of  batches written.  As soon as the number of batches written reaches or
           exceeds <u>batches</u>, all additional articles in the input will be deferred.  The default is no limit.

       <b>-p</b> <u>process</u>
           By default, batches are written to standard output, which is not useful when  more  than  one  output
           batch  is  created.   If this option is given, each batch will instead be fed via a pipe to the shell
           command <u>process</u>.  The <u>process</u> argument must be an <a href="../man3/sprintf.3.html">sprintf</a>(3) format string, which may have  a  single
           "%s" parameter that will be replaced with the host name.

           A common value is:

               ( echo '#! gunbatch' ; exec gzip -c ) | uux - -r -z %s!rnews

           which generates gzip-compressed batches and feeds them to <b>uux</b>.

       <b>-r</b>  By default, <b>batcher</b> reports errors to <u>pathlog</u>/errlog.  To suppress this redirection and report errors
           to standard error, use the <b>-r</b> flag.

       <b>-s</b> <u>separator</u>
           Each  article  in  a  batch  starts  with  a  separator  line that indicates the size of the article.
           <u>separator</u> must be an <a href="../man3/sprintf.3.html">sprintf</a>(3) string, which may have a single "%ld" in  the  string  that  will  be
           replaced  with  the  size  of  the  article.   If  the separator is not empty, a newline will also be
           appended to it when it is added to the beginning of each article.

           The default separator is:

               #! rnews %ld

           and this should rarely be changed.

       <b>-v</b>  Upon exit, <b>batcher</b> reports statistics via syslog.  With  this  flag,  the  statistics  will  also  be
           printed to standard output.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       If the input is exhausted and all batches are created successfully, <b>batcher</b> will exit with a zero status.

       If any of the limits specified with <b>-A</b>, <b>-B</b>, or <b>-N</b> flags are reached, or if there is an error in writing a
       batch, <b>batcher</b> will try to spool the remaining input by copying it to a file as follows:

       • If there was no input filename, the remaining input will be copied to <u>pathoutgoing</u>/<u>host</u>.

       • If  an  input  filename  was  given,  the  remaining  input will be copied to a temporary file named by
         appending ".bch" to the end of <u>input</u> (and qualified by adding <u>pathoutgoing</u> if <u>input</u>  was  not  a  fully
         qualified  path).  If this happens successfully, <b>batcher</b> will then try to rename this temporary file to
         <u>input</u> (thus replacing <u>input</u> with a copy of itself with  all  of  lines  for  the  successfully  batched
         articles removed).

       Upon  receipt  of  an  interrupt or termination signal, <b>batcher</b> will finish batching the current article,
       close the batch, and then rewrite the batch file as described above.

</pre><h4><b>HISTORY</b></h4><pre>
       Written by Rich $alz &lt;<a href="mailto:rsalz@uunet.uu.net">rsalz@uunet.uu.net</a>&gt; for InterNetNews.  Rewritten by Russ Allbery  &lt;<a href="mailto:eagle@eyrie.org">eagle@eyrie.org</a>&gt;
       in POD.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/ctlinnd.8.html">ctlinnd</a>(8), <a href="../man5/inn.conf.5.html">inn.conf</a>(5), <a href="../man5/newsfeeds.5.html">newsfeeds</a>(5), <a href="../man1/rnews.1.html">rnews</a>(1), <a href="../man8/send-uucp.8.html">send-uucp</a>(8), <a href="../man8/shlock.8.html">shlock</a>(8).

INN 2.7.3                                          2025-05-19                                         <u><a href="../man8/BATCHER.8.html">BATCHER</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>