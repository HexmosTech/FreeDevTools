<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lcmaps_poolaccount.mod - LCMAPS plugin to switch user identity by pool accounts</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/lcmaps-plugins-basic-poolaccount">lcmaps-plugins-basic-poolaccount_1.7.1-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       lcmaps_poolaccount.mod - LCMAPS plugin to switch user identity by pool accounts

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>lcmaps_poolaccount.mod</b> [<b>-gridmapfile</b> <u>grid-mapfile</u>] [<b>-gridmapdir</b> <u>gridmapdir</u>]
       [<b>-no_wildcard</b>|<b>-disablewildcard</b>] [<b>-override_inconsistency</b>] [<b>-max_mappings_per_credential</b> <u>max</u>nr<u>of</u>mappings<u>]</u>
       [<b>-strict_poolprefix_match</b> <u>{yes|no}</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  plugin is an acquisition plugin and will provide the LCMAPS system with Pool Account credential in‐
       formation.  The plugin tries to find a pool account (more specifically a UserID)  based  on  the  Distin‐
       guished  Name  (DN)  of the user's end-entity certificate.  The account is acquired from an account pool.
       The accounts in the account pool must exist on the system, either locally or through  a  centralised  ac‐
       count database, e.g. LDAP.

       It  will first try to find a DN to pool name (starting with a dot '.'  instead of an alphanumeric charac‐
       ter) mapping in the grid-mapfile which will provide it with a list of local accounts.

       The <b>gridmapdir</b> directory is going to be used as a persistent and open mapping database. A pool is defined
       as being a set of accounts following a particular pattern in their naming, e.g. test001.  In the directo‐
       ry the plug-in will make a new filename consisting of the lowercase URL-encoded Subject-DN of the user.

       For example, if the DN is mapped to <b>.test</b> in the grid-mapfile, it will be mapped  to  the  pool  accounts
       <b>test001</b>, <b>test002</b>, etc., the names of which can be found in the gridmapdir.

       If  there  is  no  pool account assigned to the user yet, the plugin will try to find a free pool account
       (i.e. one for which the link count is 1) and make a new hardlink to it with the URL-encoded subject DN as
       name.

       When a user returns to this site the plugin will look for the DN of the user (URL encoded) in this direc‐
       tory. If found, the corresponding pool account will be assigned to the user.

       Example showing the output of ls -li:
       1836080 -rw-r--r-- 2 root root %2fdc%3dorg%2fdc%3dterena%2fdc%3dtcs%2fc%3dnl%2fo%3dnikhef%2fcn%3doscar%20koeroo%20okoeroo%40nikhef%2enl
       1836080 -rw-r--r-- 2 root root test003
       The filename is hardlinked to the mapped account-name. Creating this hardlink is designed to be an atomic
       operation and verified to work on large installations serving multiple services from one NFS-share.

       The plugin will resolve the UID, GID and all the secondary GIDs of  the  mapped  local  (system)  account
       username.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>-gridmapfile</b> <u>grid-mapfile</u>
              This file must contain DN to pool name mappings.  It is strongly advised to set this option and to
              set  it  to  an absolute path to avoid usage of the wrong file(path).  When unset, the plugin will
              try to obtain the value from one of the environment variables (see <b>ENVIRONMENT</b>).  When  those  are
              also  unset, the default depends on whether the plugin runs inside a (setuid-)root application. In
              the (setuid-)root case, the default is <u>/etc/grid-security/grid-mapfile</u>.  In the  non-(setuid-)root
              case, the default is <u>&lt;homedir&gt;/.gridmap</u>.  In a (setuid-)root application, relative paths are taken
              with respect to <u>/etc/grid-security/</u>.

       <b>-gridmapdir</b> <u>gridmapdir</u>
              A directory used for the mapping database.  If this option is unset, the plugin will try to obtain
              the value from the environment variable <b>GRIDMAPDIR</b> (see <b>ENVIRONMENT</b>).  In a (setuid-)root applica‐
              tion, relative paths are taken with respect to <u>/etc/grid-security/</u>.

       <b>-override_inconsistency</b>
              Moving  a  user from one pool to another should normally only be done by changing the grid-mapfile
              indicating the new pool for this user.  If the resulting URL-encoded lease (hardlink) already  ex‐
              ists but points to a different pool account then would result from the running of this plugin, the
              plugin would normally fail. This option instructs the plugin to remap to the new pool account.

       <b>-max_mappings_per_credential</b> <u>maximum</u> <u>number</u> <u>of</u> <u>mappings</u>
              This  feature is deprecated. It was intended to work together with the Globus Dynamic Account Ser‐
              vice/Workspace Service.  This value indicates the maximum number  of  accounts  a  user,  or  more
              specifically a set of credentials (=DN + FQANs), can be mapped to. Normally this number is 1.  But
              if  each job should run under its own account the number should be increased.  Whether LCMAPS will
              actually use the mapcounter depends on the LCMAPS interface being used. The lease name (or poolin‐
              dex) in the case of mapcounters looks like:

                  url_encoded(&lt;DN&gt;):mapcount=&lt;mapnumber&gt;)

       <b>-no_wildcard</b>, <b>-disablewildcard</b>
              When  this  option  is  set  the  plug-in  will  only  match  exact  DNs,  i.e.   /DC=org/DC=tere‐
              na/DC=tcs/C=NL/* will <u>not</u> match.

       <b>-strict_poolprefix_match</b> <u>{yes|no}</u>
              If  this  is  set to 'yes', a line in the grid-mapfile like <b>&lt;DN&gt;</b> <b>.pool</b> will result in mapping pool
              accounts matching only the regexp <b>pool[0-9]+</b>.  Otherwise it will be allowed  to  match  the  wider
              range of <b>pool.*</b> (legacy behaviour).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>LCMAPS_MOD_SUCCESS</b>
              Success.

       <b>LCMAPS_MOD_FAIL</b>
              Failure.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       GRIDMAP | GLOBUSMAP | globusmap | GlobusMap
              When no grid-mapfile is specified as option to the plugin, it will try to obtain the file location
              from one of these environment variables.

       GRIDMAPDIR
              When  no  gridmapdir is specified as option to the plugin, it will try to obtain the file location
              from this environment variable.

</pre><h4><b>NOTES</b></h4><pre>
       Since version 1.6.0 the poolaccount plugin also takes the  <b>requested</b>  <b>username</b>   (such  as  forwarded  by
       gsissh)  into  consideration.  When  present, the resulting pool account has to match it in order for the
       plugin to succeed. This requires LCMAPS version 1.6.0 or newer.

</pre><h4><b>BUGS</b></h4><pre>
       Please  report  any  errors  to  the  Nikhef  Grid  Middleware   Security   Team   &lt;grid-mw-security-sup‐
       <a href="mailto:port@nikhef.nl">port@nikhef.nl</a>&gt;.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/lcmaps.db.5.html">lcmaps.db</a></b>(5), <b><a href="../man3/lcmaps.3.html">lcmaps</a></b>(3).

</pre><h4><b>AUTHORS</b></h4><pre>
       LCMAPS  and  the  LCMAPS  plug-ins  were  written  by  the Grid Middleware Security Team &lt;grid-mw-securi‐
       <a href="mailto:ty@nikhef.nl">ty@nikhef.nl</a>&gt;.

Stichting FOM/Nikhef                            February 6, 2015                       <u><a href="../man8/LCMAPS_POOLACCOUNT.MOD.8.html">LCMAPS_POOLACCOUNT.MOD</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>