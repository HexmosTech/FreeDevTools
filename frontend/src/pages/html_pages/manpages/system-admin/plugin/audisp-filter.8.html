<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>audisp-filter - plugin to filter audit events and forward them to other plugins</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/auditd">auditd_4.0.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       audisp-filter - plugin to filter audit events and forward them to other plugins

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>audisp-filter</b> <u>MODE</u> <u>CONFIG_FILE</u> <u>BINARY</u> [ <u>BINARY_ARGS</u> ]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>audisp-filter</b>  is  an  audit  event dispatcher plugin designed to filter out specific events based on its
       provided configuration. Moreover, it possesses the capability to forward  the  remaining  logs  to  other
       plugins.  The  plugin  is  universally  compatible, allowing seamless integration with any existing audit
       plugin that expects audit messages on its standard input. Currently it supports the following arguments:

              <b>MODE</b>   The operational mode can be either allowlist or blocklist. In allowlist  mode,  the  plugin
                     forwards  everything except for events that match the specified ausearch expressions in the
                     configuration. Conversely, in blocklist mode, it refrains from forwarding  anything  except
                     for events listed in the configuration.

              <b>CONFIG_FILE</b>
                     Path to the main configuration file containing ausearch expressions.

              <b>BINARY</b> Path  to  an  external program that will consistently receive filtered audit events through
                     its standard input.

              <b>BINARY_ARGS</b>
                     Optionally, you can pass additional arguments to the external program.

</pre><h4><b>CONFIGURATION</b> <b>AND</b> <b>RULES</b> <b>EVALUATION</b></h4><pre>
       Every single plugin that wants to benefit from the event filtering capability needs  to  create  its  own
       configuration  file. It's a good practice to place this file inside the audit config directory, following
       the naming convention audisp-filter-pluginname.conf, for instance,  <b>audisp-filter-syslog.conf</b>  to  filter
       audit events before sending them to syslog.

       Each line within a configuration represents an ausearch-expression (5). Internally, these expressions are
       joined  using  the  OR  operator.  Therefore,  every  expression is substituted with (PE || CE), where PE
       represents the previous expression and CE denotes the current expression being processed.  Lines starting
       with a <b>'#'</b> character are treated as comments and do not influence the final rule set.

       Upon the creation of an audit  event,  the  filtering  engine  goes  through  the  list  of  expressions,
       constructing the final expression representing our rule set. The event in question will be searched using
       this  expression. The decision to forward an audit event to the configured binary depends on two factors:
       the operational mode of audisp-filter and whether the expression matches the ongoing event.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Example1: Do not syslog audit events containing unsuccessful openat syscalls.

       First, in the plugin config, make sure that operation mode is set to  allowlist,  the  binary  points  to
       /sbin/audispFyslog  and  provide  any  additional  arguments  if needed. Next, create the plugin specific
       config file with the content below. Before enabling the audit plugin, always  make  sure  the  syntax  is
       correct. This can be checked by calling audisp-filter --check path/to/config/file.

       <b>(type</b> <b>r=</b> <b>SYSCALL</b> <b>&amp;&amp;</b> <b>syscall</b> <b>i=</b> <b>openat</b> <b>&amp;&amp;</b> <b>success</b> <b>r=</b> <b>yes)</b>

</pre><h4><b>FILES</b></h4><pre>
       /etc/audit/plugins/filter.conf /etc/audit/auditd.conf

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/auditd.conf.8.html">auditd.conf</a></b>(8), <b><a href="../man5/ausearch-expression.5.html">ausearch-expression</a></b>(5), <b><a href="../man5/auditd-plugins.5.html">auditd-plugins</a></b>(5).

</pre><h4><b>AUTHOR</b></h4><pre>
       Attila Lakatos

Red Hat                                           February 2024                                 <u><a href="../man8/AUDISP-SYSLOG.8.html">AUDISP-SYSLOG</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>