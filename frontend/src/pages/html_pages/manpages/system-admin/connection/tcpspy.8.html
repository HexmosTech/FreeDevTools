<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tcpspy - TCP/IP Connection Monitor</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcpspy">tcpspy_1.7d-16_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tcpspy - TCP/IP Connection Monitor

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>tcpspy</b> [<b>-dp</b>] [<b>-e</b> <u>rule</u>]...  [<b>-f</b> <u>rulefile</u>]...  [<b>-F</b> <u>facility</u>] [<b>-I</b> <u>interval</u>] [<b>-U</b> <u>user</u>] [<b>-G</b> <u>group</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>tcpspy</u>  logs information about selected incoming and outgoing TCP/IP connections to syslog. The following
       information is logged: username, local address  and  port,  remote  address,  port,  and  optionally  the
       filename of the executable.

   <b>Options</b>
       <b>-e</b> <u>'rule'</u>
              Log only connections matching the specified rule. Rule syntax is outlined below. If this option is
              specified  more  than once, connections matching any of the specified rules are logged. You should
              quote the rule, as shown above.

       <b>-f</b> <u>rulefile</u>
              Read rules from <u>rulefile</u>.  Each rule is on a new line. The  `#'  character  may  be  used  to  add
              comments; everything from this character to the end of the line is ignored.

              The <b>-e</b> and <b>-f</b> options may be used together.

       <b>-F</b> <u>facility</u>
              Log   to   syslog  facility  <u>facility</u>  instead  of  the  compile-time  default  setting.  See  the
              <b><a href="../man5/syslog.conf.5.html">syslog.conf</a></b>(5) manual page for a list of facilities.

       <b>-I</b> <u>interval</u>
              Update the internal state every  <u>interval</u>  milliseconds,  instead  of  the  default  of  1000  ms.
              Connections  that  last less than <u>interval</u> milliseconds may be missed, so you should experiment to
              find a value small enough that it catches most connections, but not so small that it causes tcpspy
              to use too much CPU time.

       <b>-U</b> <u>user</u>
              Switch to the specified user after startup.  <u>user</u> may be a numeric user id or a user name from the
              system password file.

       <b>-G</b> <u>group</u>
              Switch to the specified group after startup.  <u>group</u> may be a numeric group id or a group name from
              the system group file.  If a username to switch to with the <b>-U</b>  option  is  specified  but  <b>-G</b>  is
              omitted, tcpspy will switch to that specified user's primary group.

       <b>-d</b>     Debugging  mode;  if  this  option  is  specified,  tcpspy  will not detach from the console after
              initialisation, and will log connections to standard output instead of syslog.

       <b>-p</b>     Log the filename of  the  executable  that  created/accepted  the  connection.   You  may  require
              superuser  privileges  to  obtain  this information for processes you do not own (this is a kernel
              limitation).

              This  option  can  greatly  increase  the  amount  of  CPU   time   required   to   process   each
              connection/disconnection.

   <b>Rule</b> <b>Syntax</b>
       A  rule  may  be  specified  with  the <b>-e</b> option to log information about connections matching this rule,
       overriding the default of logging all connections.

       The following comparison operations are defined:

       <b>user</b> <u>uid</u>
              True if the local user initiating or accepting the connection has the <b>effective</b> user id <u>uid</u>.

       <b>user</b> <u>"username"</u>
              Same as above, but using a username instead of a user id.

       <b>ip</b>     True if the connection is IPv4.

       <b>ip6</b>    True if the connection is IPv6.

       <b>lport</b> <u>port</u>
              True if the local end of the connection has port number <u>port</u>.

       <b>lport</b> <u>[low]</u> <u>-</u> <u>[high]</u>
              True if the local end of the connection has a port number greater than or equal to  <u>low</u>  and  less
              than  or equal to <u>high</u>.  If the form <u>low-</u> is used, high is assumed to be 65535.  If the form <u>-high</u>
              is used, low is assumed to be 0. It is an error to omit both <u>low</u> and <u>high</u>.

       <b>lport</b> <u>"service"</u>
              Same as above, but using a service name from <u><a href="file:/etc/services">/etc/services</a></u> instead of a port number.

       <b>rport</b>  Same as <b>lport</b> but compares the port number of the remote end of the connection.

       <b>laddr</b> <u>n.n.n.n[/m.m.m.m]</u>

       <b>laddr</b> <u>n.n.n.n/m</u>

       <b>laddr</b> <u>ip6-addr[/m]</u>
              Interpreted as a "net/mask" expression; true if "net" is equal to the bitwise  AND  of  the  local
              address  of  the  connection and "mask". If no mask is specified, a default mask with all bits set
              (255.255.255.255) is used. The CIDR type netmask is also possible. With IPv6 only a prefix  length
              netmask  is  allowed, and the length defaults to 128. Depending on the address family, these rules
              contain an implicit match condition "ip" or "ip6", respectively.

       <b>raddr</b>  Same as <b>laddr</b> but compares the remote address.

       <b>exe</b> <u>"pattern"</u>
              True if the full filename (including  directory)  of  the  executable  that  created/accepted  the
              connection matches <u>pattern</u>, a <b><a href="../man7/glob.7.html">glob</a></b>(7)-style wildcard pattern.

              The  pattern  ""  (an  empty  string)  matches  connections  created/accepted  by  processes whose
              executable filename is unknown.

              If the <b>-p</b> option is not specified, a warning message will be  printed,  and  the  result  of  this
              comparison will always be true.

       Expressions  (including  the  comparisons listed above) may be joined together with the following logical
       operations:

       <u>expr1</u> <b>or</b> <u>expr2</u>
              True if either of <u>expr1</u> or <u>expr2</u> are true (logical OR).

       <u>expr1</u> <b>and</b> <u>expr2</u>
              True if both <u>expr1</u> and <u>expr2</u> are true (logical AND).

       <b>not</b> <u>expr</u>
              True if <u>expr</u> is false (logical NOT).

       Rules are evaluated from left to right. Whitespace  (space,  tab  and  newline)  characters  are  ignored
       between  "words".  Rules  consisting  of only whitespace match no connections, but do not cause an error.
       Parentheses, '(' and ')' may be placed around expressions to affect the order of evaluation.

       The Examples section contains some sample rules which further demonstrate how they are constructed.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       0      The daemon was successfully started

       &gt;0     An error occurred

</pre><h4><b>SIGNALS</b></h4><pre>
       <u>TERM</u>   Shut down at most <u>interval</u> milliseconds from now.

       <u>INT</u>    (Debugging mode only) Handled identically to <u>TERM</u>.

       All other signals retain their default behaviour, which is documented in <b><a href="../man7/signal.7.html">signal</a></b>(7).

</pre><h4><b>EXAMPLES</b></h4><pre>
       tcpspy -e 'user "joe" and rport "ssh"'
              Log connections made by user "joe" for the service "ssh".

       tcpspy -e 'not raddr 10.0.0.0/255.0.0.0 and rport 25 and (user "bob" or user "joe")'
              Log connections made by users "bob" and "joe" to remote port 25 on machines  not  on  a  fictional
              "intranet".

       tcpspy -e 'exe "/usr/bin/irc"'
              Log connections made by /usr/bin/irc (probably ircII).

</pre><h4><b>BUGS</b></h4><pre>
       Empty rule files cause <b>tcpspy</b> to log no connections instead of all connections.

</pre><h4><b>AUTHOR</b></h4><pre>
       Tim J. Robbins &lt;<a href="mailto:tim@robbins.dropbear.id.au">tim@robbins.dropbear.id.au</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/glob.7.html">glob</a></b>(7), <b><a href="../man5/proc.5.html">proc</a></b>(5), <b><a href="../man5/services.5.html">services</a></b>(5), <b><a href="../man7/signal.7.html">signal</a></b>(7), <b><a href="../man3/syslog.3.html">syslog</a></b>(3), <b><a href="../man5/syslog.conf.5.html">syslog.conf</a></b>(5), <b><a href="../man5/tcpspy.rules.5.html">tcpspy.rules</a></b>(5)

TJR                                                 May 2001                                           <u><a href="../man8/TCPSPY.8.html">TCPSPY</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>