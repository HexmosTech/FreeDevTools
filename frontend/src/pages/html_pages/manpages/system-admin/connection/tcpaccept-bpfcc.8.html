<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tcpaccept - Trace TCP passive connections (accept()). Uses Linux eBPF/bcc.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bpfcc-tools">bpfcc-tools_0.31.0+ds-7ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tcpaccept - Trace TCP passive connections (accept()). Uses Linux eBPF/bcc.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>tcpaccept</b> <b>[-h]</b> <b>[-T]</b> <b>[-t]</b> <b>[-p</b> <b>PID]</b> <b>[-P</b> <b>PORTS]</b> <b>[-4</b> <b>|</b> <b>-6]</b> <b>[--cgroupmap</b> <b>MAPPATH]</b> <b>[--mntnsmap</b> <b>MAPPATH]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This tool traces passive TCP connections (eg, via an accept() syscall; connect() are active connections).
       This can be useful for general troubleshooting to see what new connections the local server is accepting.

       This  uses  dynamic  tracing  of the kernel inet_csk_accept() socket function (from tcp_prot.accept), and
       will need to be modified to match kernel changes.

       This tool only traces successful TCP accept()s. Connection attempts to closed ports  will  not  be  shown
       (those can be traced via other functions).

       Since this uses BPF, only the root user can use this tool.

</pre><h4><b>REQUIREMENTS</b></h4><pre>
       CONFIG_BPF and bcc.

</pre><h4><b>OPTIONS</b></h4><pre>
       -h     Print usage message.

       -T     Include a time column on output (HH:MM:SS).

       -t     Include a timestamp column.

       -p PID Trace this process ID only (filtered in-kernel).

       -P PORTS
              Comma-separated list of local ports to trace (filtered in-kernel).

       -4     Trace IPv4 family only.

       -6     Trace IPv6 family only.

       --cgroupmap MAPPATH
              Trace cgroups in this BPF map only (filtered in-kernel).

       --mntnsmap  MAPPATH
              Trace mount namespaces in this BPF map only (filtered in-kernel).

</pre><h4><b>EXAMPLES</b></h4><pre>
       Trace all passive TCP connections (accept()s):
              # <b>tcpaccept</b>

       Trace all TCP accepts, and include timestamps:
              # <b>tcpaccept</b> <b>-t</b>

       Trace connections to local ports 80 and 81 only:
              # <b>tcpaccept</b> <b>-P</b> <b>80,81</b>

       Trace PID 181 only:
              # <b>tcpaccept</b> <b>-p</b> <b>181</b>

       Trace IPv4 family only:
              # <b>tcpaccept</b> <b>-4</b>

       Trace IPv6 family only:
              # <b>tcpaccept</b> <b>-6</b>

       Trace a set of cgroups only (see special_filtering.md from bcc sources for more details):
              # <b>tcpaccept</b> <b>--cgroupmap</b> <b>/sys/fs/bpf/test01</b>

</pre><h4><b>FIELDS</b></h4><pre>
       TIME   Time of the event, in HH:MM:SS format.

       TIME(s)
              Time of the event, in seconds.

       PID    Process ID

       COMM   Process name

       IP     IP address family (4 or 6)

       RADDR  Remote IP address.

       RPORT  Remote port

       LADDR  Local IP address.

       LPORT  Local port

</pre><h4><b>OVERHEAD</b></h4><pre>
       This  traces  the  kernel  inet_csk_accept  function  and prints output for each event.  The rate of this
       depends on your server application. If it is a web or proxy server accepting many tens  of  thousands  of
       connections  per  second,  then the overhead of this tool may be measurable (although, still a lot better
       than tracing every packet). If it is less than a thousand a second, then the overhead is expected  to  be
       negligible. Test and understand this overhead before use.

</pre><h4><b>SOURCE</b></h4><pre>
       This is from bcc.

              https://github.com/iovisor/bcc

       Also  look  in  the bcc distribution for a companion _examples.txt file containing example usage, output,
       and commentary for this tool.

</pre><h4><b>OS</b></h4><pre>
       Linux

</pre><h4><b>STABILITY</b></h4><pre>
       Unstable - in development.

</pre><h4><b>AUTHOR</b></h4><pre>
       Brendan Gregg

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/tcptracer.8.html">tcptracer</a>(8), <a href="../man8/tcpconnect.8.html">tcpconnect</a>(8), <a href="../man8/funccount.8.html">funccount</a>(8), <a href="../man8/tcpdump.8.html">tcpdump</a>(8)

USER COMMANDS                                      2020-02-20                                       <u><a href="../man8/tcpaccept.8.html">tcpaccept</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>