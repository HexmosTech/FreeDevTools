<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tcptracer - Trace TCP established connections. Uses Linux eBPF/bcc.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bpfcc-tools">bpfcc-tools_0.31.0+ds-7ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tcptracer - Trace TCP established connections. Uses Linux eBPF/bcc.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>tcptracer</b> <b>[-h]</b> <b>[-v]</b> <b>[-t]</b> <b>[-p</b> <b>PID]</b> <b>[-N</b> <b>NETNS]</b> <b>[--cgroupmap</b> <b>MAPPATH]</b> <b>[--mntnsmap</b> <b>MAPPATH]</b> <b>[-4</b> <b>|</b> <b>-6]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  tool  traces  established  TCP  connections that open and close while tracing, and prints a line of
       output per connect, accept and close events. This includes the type  of  event,  PID,  IP  addresses  and
       ports.

       This tool works by using kernel dynamic tracing, and will need to be updated if the kernel implementation
       changes. Only established TCP connections are traced, so it is expected that the overhead of this tool is
       rather low.

       Since this uses BPF, only the root user can use this tool.

</pre><h4><b>REQUIREMENTS</b></h4><pre>
       CONFIG_BPF and bcc.

</pre><h4><b>OPTIONS</b></h4><pre>
       -h     Print usage message.

       -v     Print full lines, with long event type names and network namespace numbers.

       -t     Include timestamp on output

       -p PID Trace this process ID only (filtered in-kernel).

       -N NETNS
              Trace this network namespace only (filtered in-kernel).

       --cgroupmap MAPPATH
              Trace cgroups in this BPF map only (filtered in-kernel).

       --mntnsmap  MAPPATH
              Trace mount namespaces in the map (filtered in-kernel).

       -4     Trace IPv4 family only.

       -6     Trace IPv6 family only.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Trace all TCP established connections:
              # <b>tcptracer</b>

       Trace all TCP established connections with verbose lines:
              # <b>tcptracer</b> <b>-v</b>

       Trace PID 181 only:
              # <b>tcptracer</b> <b>-p</b> <b>181</b>

       Trace connections in network namespace 4026531969 only:
              # <b>tcptracer</b> <b>-N</b> <b>4026531969</b>

       Trace a set of cgroups only (see special_filtering.md from bcc sources for more details):
              # <b>tcptracer</b> <b>--cgroupmap</b> <b>/sys/fs/bpf/test01</b>

       Trace IPv4 family only:
              # <b>tcptracer</b> <b>-4</b>

       Trace IPv6 family only:
              # <b>tcptracer</b> <b>-6</b>

</pre><h4><b>FIELDS</b></h4><pre>
       TYPE   Type of event. In non-verbose mode: C for connect, A for accept, X for close.

       PID    Process ID

       COMM   Process name

       IP     IP address family (4 or 6)

       SADDR  Source IP address.

       DADDR  Destination IP address.

       SPORT  Source port.

       DPORT  Destination port.

       NETNS  Network namespace where the event originated.

</pre><h4><b>OVERHEAD</b></h4><pre>
       This  traces  the  kernel  inet  accept  function,  and  the TCP connect, close, and set state functions.
       However, it only prints information for connections that are established, so it  shouldn't  have  a  huge
       overhead.

       As always, test and understand this tools overhead for your types of workloads before production use.

</pre><h4><b>SOURCE</b></h4><pre>
       This is from bcc.

              https://github.com/iovisor/bcc

       Also  look  in  the bcc distribution for a companion _examples.txt file containing example usage, output,
       and commentary for this tool.

</pre><h4><b>OS</b></h4><pre>
       Linux

</pre><h4><b>STABILITY</b></h4><pre>
       Unstable - in development.

</pre><h4><b>AUTHOR</b></h4><pre>
       Iago LÃ³pez Galeiras

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/tcpaccept.8.html">tcpaccept</a>(8), <a href="../man8/tcpconnect.8.html">tcpconnect</a>(8), <a href="../man8/tcptop.8.html">tcptop</a>(8), <a href="../man8/tcplife.8.html">tcplife</a>(8)

USER COMMANDS                                      2020-02-20                                       <u><a href="../man8/tcptracer.8.html">tcptracer</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>