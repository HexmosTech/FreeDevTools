<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>arpalert - ARP traffic monitoring</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/arpalert">arpalert_2.0.12-6build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       arpalert - ARP traffic monitoring

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Arpalert  uses  ARP  protocol monitoring to prevent unauthorized connections on the local network.  If an
       illegal connection is detected, a program or script could be launched, which could be  used  to  send  an
       alert message, for example.

</pre><h4><b>COMMAND</b> <b>LINE</b></h4><pre>
       <b>-f</b> <b>config_file</b>
              Specify the config file.

       <b>-i</b> <b>interface</b>
              Comma separated network interfaces listen to.

       <b>-p</b> <b>pid_file</b>
              Use this pid file. this file containis a pid number of the arpalert session. If the file exist and
              his locked, the daemon do not run.

       <b>-e</b> <b>exec_script</b>
              Script launched when an alert is send.

       <b>-D</b> <b>log_level</b>
              The  level logged. The levels are between 0 (emergency) and 7 (debug). If 3 is selected all levels
              bitween 0 and 3 are logged.

       <b>-l</b> <b>leases_file</b>
              This file contain a dump of the mac address in memory (see config file).

       <b>-m</b> <b>module</b> <b>file</b>
              Specify a module file to load

       <b>-d</b>     Run as daemon.

       <b>-F</b>     Run in foreground.

       <b>-v</b>     Watch on screen all the option selected (the options specified in  config  file  and  the  default
              options)

       <b>-h</b>     The help command line.

       <b>-w</b>     Debug option: print a dump of packets captured.

       <b>-P</b>     Set the interface in promiscuous mode (don't set this if only the arp analyse is used).

       <b>-V</b>     Print version and quit.

</pre><h4><b>CONFIGURATION</b> <b>FILE</b></h4><pre>
       The  config  file contains 3 types of data: integer, string and boolean. The boolean type can take values
       'oui', 'true', 'yes', '1' for the true values or 'non', 'no', 'false', '0' for the falses values.

       <b>user</b> = arpalert
              Use privileges separation with this user

       <b>umask</b> = 177
              Uses this umask for file creation.

       <b>chroot</b> <b>dir</b> = /home/thierry/arp_test/
              Use this directory for program jail
              If this option is commented out, the program does not use chroot.
              The program read the config file and open the syslog socket before the chroot:
              The kill -HUP does not work with chroot.
              If the syslog program is restarted, the socket change and the  arpalert  syslog  system  can't  be
              connect to the new socket: the logs with syslog are disabled. Prefere to use the log file.
              The file paths are relative to the chroot dir (except the config file)

       <b>log</b> <b>file</b> = /var/log/arpalert.log
              The program log into this file
              If this option is commented out, the internal system log is not used.
              The internal system logs can be used in same time that syslog.

       <b>log</b> <b>level</b> = 6
              The  level logged. The levels are between 0 (emergency) and 7 (debug). If 3 is selected all levels
              between 0 and 3 are logged.

       <b>use</b> <b>syslog</b> = true
              If this option is false, the syslog system is disabled

       <b>maclist</b> <b>file</b> = /etc/arpalert/maclist.allow
              White list

       <b>maclist</b> <b>alert</b> <b>file</b> = /etc/arpalert/maclist.deny
              Black list

       <b>maclist</b> <b>leases</b> <b>file</b> = /var/lib/arpalert/arpalert.leases
              Dump file

       <b>dump</b> <b>inter</b> = 5
              Minimum time to wait between two leases dump

       <b>auth</b> <b>request</b> <b>file</b> = /etc/arpalert/authrq.conf
              List of authorized request

       <b>lock</b> <b>file</b> = /var/run/arpalert.pid
              pid file

       <b>dump</b> <b>packet</b> = false
              Only for debugging: this dump packet received on standard output. The syntax "<b>dump</b> <b>paquet</b>" is also
              avalaible, but is deprecated

       <b>daemon</b> = false
              If is set to true, run the program as daemon

       <b>interface</b> = ""
              Comma separated network interfaces leisten to. If this value is not specified, the soft select the
              first interface.

       <b>catch</b> <b>only</b> <b>arp</b> = TRUE
              Configure the network for catch only arp request.  The  detection  type  "new_mac"  is  deactived.
              This mode is used for CPU saving if Arpalert is running on a router

       <b>mod</b> <b>on</b> <b>detect</b> = ""
              Module file loaded by arpalert. This module is launched on each valid alert.  This system avoids a
              costly fork/exec

       <b>mod</b> <b>config</b> = ""
              This chain is transferred to the init function of module loaded

       <b>action</b> <b>on</b> <b>detect</b> = ""
              Script launched on each detection. Parameters are:
               - <b>mac</b> <b>address</b> <b>of</b> <b>requestor</b>,
               - <b>ip</b> <b>of</b> <b>requestor</b>,
               - <b>supp.</b> <b>parm.</b>,
               - <b>ethernet</b> <b>device</b> <b>listening</b> <b>on</b>
               - <b>type</b> <b>of</b> <b>alert</b>,
               - optional: <b>ethernet</b> <b>vendor</b>

              type of alert:
              <b>0:</b> IP change
              <b>1:</b> Mac address already detected but not in white list
              <b>2:</b> Mac address in black list
              <b>3:</b> New mac address
              <b>4:</b> Unauthorized arp request
              <b>5:</b> Abusive number of arp request detected
              <b>6:</b> Ethernet mac address different from arp mac address
              <b>7:</b> Flood detected
              <b>8:</b> New mac address without ip address

       <b>execution</b> <b>timeout</b> = 10
              Script execution timeout (seconds)

       <b>max</b> <b>alert</b> = 20
              Maximun simultaneous lanched script

       <b>dump</b> <b>black</b> <b>list</b> = false
              Dump the black listed mac address in leases file

       <b>dump</b> <b>white</b> <b>list</b> = false
              Dump the white listed mac address in leases file

       <b>dump</b> <b>new</b> <b>address</b> = true
              Dump the new mac address in leases file

       <b>mac</b> <b>timeout</b> = 259200
              After this time a mac address is removed from memory (seconds) (default 1 month)

       <b>max</b> <b>entry</b> = 1000000
              After this limit the memory hash is cleaned (protect to arp flood)

       <b>anti</b> <b>flood</b> <b>interval</b> = 10
              This sends only one mismatch alert in this time (in seconds)

       <b>anti</b> <b>flood</b> <b>global</b> = 50
              If the number of arp request in seconds exceeds this value, all alerts are ignored for "anti flood
              interval" time

       <b>mac</b> <b>vendor</b> <b>file</b> = ""
              This  file  contain  the  association from mac address to vendor name. This file can be downloaded
              here: <a href="http://standards.ieee.org/regauth/oui/oui.txt">http://standards.ieee.org/regauth/oui/oui.txt</a>

       <b>log</b> <b>mac</b> <b>vendor</b> = false
              Log vendor name

       <b>alert</b> <b>mac</b> <b>vendor</b> = false
              Give vendor name to script

       <b>mod</b> <b>mac</b> <b>vendor</b> = false
              Give vendor name to module

       <b>log</b> <b>referenced</b> <b>address</b>, <b>alert</b> <b>on</b> <b>referenced</b> <b>address</b>, <b>mod</b> <b>on</b> <b>referenced</b> <b>address</b> = false
              Log/launch script/call module if the address is referenced in hash but is not in white list

       <b>log</b> <b>deny</b> <b>address</b>, <b>alert</b> <b>on</b> <b>deny</b> <b>address</b>, <b>mod</b> <b>on</b> <b>deny</b> <b>address</b> = true
              Log/launch script/call module if the mac address is in black list

       <b>log</b> <b>new</b> <b>address</b>, <b>alert</b> <b>on</b> <b>new</b> <b>address</b>, <b>mod</b> <b>on</b> <b>new</b> <b>address</b> = true
              Log/launch script/call module if the address isn't referenced

       <b>log</b> <b>mac</b> <b>change</b>, <b>alert</b> <b>on</b> <b>mac</b> <b>change</b>, <b>mod</b> <b>on</b> <b>mac</b> <b>change</b> = true
              Log/launch script/call module if the mac address is different from the last arp request  with  the
              same ip address

       <b>log</b> <b>ip</b> <b>change</b>, <b>alert</b> <b>on</b> <b>ip</b> <b>change</b>, <b>mod</b> <b>on</b> <b>ip</b> <b>change</b> = true
              Log/launch  script/call  module  if the ip address is different from the last arp request with the
              same mac address

       <b>log</b> <b>unauth</b> <b>request</b>, <b>alert</b> <b>on</b> <b>unauth</b> <b>request</b>, <b>mod</b> <b>on</b> <b>unauth</b> <b>request</b> = true
              Unauthorized arp request: launch if the request is not authorized in auth file

       <b>ignore</b> <b>unknown</b> <b>sender</b> = true
              Don't analyse arp request for unknown hosts (not in white list)

       <b>ignore</b> <b>self</b> <b>test</b> = true
              Ignore ARP self test generated by windows dhcp for unauthorized request detection

       <b>ignore</b> <b>me</b> = true
              Ignore arp request with mac addresse of the listing interfaces for the authorizations checks

       <b>unauth</b> <b>ignore</b> <b>time</b> <b>method</b> = 2
              Select suspend time method:
              1: ignore all unauth alerts during "anti flood interval" time
              2: ignore only tuple (mac address, ip address) during "anti flood interval" time

       <b>log</b> <b>request</b> <b>abus</b>, <b>alert</b> <b>on</b> <b>request</b> <b>abus</b>, <b>mod</b> <b>on</b> <b>request</b> <b>abus</b> = true
              Log/launch script/call module if the number of request per seconds are &gt; "max request"

       <b>max</b> <b>request</b> = 1000000
              Maximun request authorized by second

       <b>log</b> <b>mac</b> <b>error</b>, <b>alert</b> <b>on</b> <b>mac</b> <b>error</b>, <b>mod</b> <b>on</b> <b>mac</b> <b>error</b> = true
              Log/launch script/call module if the ethernet mac address is different than the  arp  mac  address
              (only for requestor)

       <b>log</b> <b>flood</b> = true, <b>alert</b> <b>on</b> <b>flood</b> = true, <b>mod</b> <b>on</b> <b>flood</b> = true
              Log/launch script/call module if have too many arp request per seconds

       <b>log</b> <b>expire</b> <b>mac</b> <b>address</b> = true, <b>alert</b> <b>on</b> <b>expire</b> <b>mac</b> <b>address</b> = true, <b>mod</b> <b>on</b> <b>expire</b> <b>mac</b> <b>address</b> = true
              Log/launch script/call module if the ethernet mac address expire

       <b>expire</b> <b>authorized</b> <b>mac</b> <b>addresses</b> = true
              Allow authorized mac addresses to expire

</pre><h4><b>DATA</b> <b>FILES</b> <b>FORMATS</b></h4><pre>
       <b>/etc/arpalert/maclist.allow</b> and <b>/etc/arpalert/maclist.deny</b>:
              All the line with # as a <b>first</b> caracter are ignored
              The data on this file take this form
              &lt;MAC_ADRESS&gt; &lt;IP_ADDRESS&gt; &lt;DEVICE&gt; [&lt;FLAG&gt; &lt;FLAG&gt; &lt;FLAG&gt; ...]
              The available flags are:
              <b>ip_change:</b> Ignore ip change alert for this mac address
              <b>black_listed:</b> Ignore black list alerts for this mac address
              <b>unauth_rq:</b> Ignore unauthorized requests for this mac address
              <b>rq_abus:</b> Ignore request abuse for this mac address
              <b>mac_error:</b> Ignore mac error for this mac address
              <b>mac_change:</b> Ignore mac change for this mac address
              <b>mac_expire:</b>  Never expire this mac address. Useful if the option "expire authorized mac addresses"
              is used

       <b>/etc/arpalert/authrq.conf</b>:
              All the words after # character are ignored
              All the blank characters are ignored
              The authorisations list for one mac address begins by the mac address into brackets
              All the next values are ip hosts addresses or ip networks addresses (with /xx notion)
              [&lt;MAC_ADRESS&gt; &lt;DEVICE&gt;] &lt;IP_ADRESS&gt;
              &lt;IP_ADRESS&gt;/&lt;BITS&gt;

</pre><h4><b>FILES</b></h4><pre>
       <b>sbin/arpalert</b>: binary file
       <b>etc/arpalert/arpalert.conf</b>: default config file
       <b>var/run/arpalert.pid</b>: pid file
       <b>var/state/arpalert.leases</b>: leases file

                                                   2006-05-09                                        <u><a href="../man8/ARPALERT.8.html">ARPALERT</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>