<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>volume_key - work with volume encryption secrets and escrow packets</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/volume-key">volume-key_0.3.12-9_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       volume_key - work with volume encryption secrets and escrow packets

</pre><h4><b>SYNOPIS</b></h4><pre>
       <b>volume_key</b> [<u>OPTION</u>]... <u>OPERAND</u>...

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>volume_key</b>  extracts  "secrets"  used  for volume encryption (for example keys or passphrases) and stores
       them into separate encrypted "escrow packets", uses a previously created escrow packet to restore  access
       to a volume (e.g. if the user forgets a passphrase), or manipulates the information in escrow packets.

       The  mode  of  operation  and  operands  of  <b>volume_key</b>  are  determined by specifying one of the <b>--save</b>,
       <b>--restore</b>, <b>--setup-volume</b>, <b>--reencrypt</b>, <b>--dump</b> or  <b>--secrets</b>  options.   See  the  OPTIONS  sections  for
       details.

</pre><h4><b>OPTIONS</b></h4><pre>
       In all options described below, <u>VOLUME</u> is a LUKS device, not the plaintext device contained within:
              <b>blkid</b> <b>-s</b> <b>TYPE</b> <u>VOLUME</u>
       should report <b>TYPE="crypto_LUKS"</b>.

       The following options determine the mode of operation and expected operands of <b>volume_key</b>:

       <b>--save</b> Expects  operands <u>VOLUME</u> [<u>PACKET</u>].  Open <u>VOLUME</u>.  If <u>PACKET</u> is provided, load the secrets from it.
              Otherwise, extract secrets from <u>VOLUME</u>, prompting the user  if  necessary.   In  any  case,  store
              secrets in one or more output packets.

       <b>--restore</b>
              Expects  operands  <u>VOLUME</u>  <u>PACKET</u>.   Open  <u>VOLUME</u>  and  use  the  secrets in <u>PACKET</u> to make <u>VOLUME</u>
              accessible again, prompting the  user  if  necessary  (e.g.  by  letting  the  user  enter  a  new
              passphrase).

       <b>--setup-volume</b>
              Expects  operands  <u>VOLUME</u> <u>PACKET</u> <u>NAME</u>.  Open <u>VOLUME</u> and use the secrets in <u>PACKET</u> to set up <u>VOLUME</u>
              for use of the decrypted data as <u>NAME</u>.

              Currently <u>NAME</u> is a name of a dm-crypt volume, and  this  operation  makes  the  decrypted  volume
              available as <b><a href="file:/dev/mapper/">/dev/mapper/</a></b><u>NAME</u>.

              This operation should not permanently alter <u>VOLUME</u> (e.g. by adding a new passphrase); the user can
              of course access and modify the decrypted volume, modifying <u>VOLUME</u> in the process.

       <b>--reencrypt</b>
              Expects operand <u>PACKET</u>.  Open <u>PACKET</u>, decrypting it if necessary, and store the information in one
              or more new output packets.

       <b>--dump</b> Expects  operand  <u>PACKET</u>.   Open  <u>PACKET</u>,  decrypting  it if necessary, and output the contents of
              <u>PACKET</u>.  The secrets are not output by default.

       <b>--secrets</b>
              Expects operand <u>PACKET</u>.  Open <u>PACKET</u>, decrypting it if necessary, and output secrets contained  in
              <u>PACKET</u>.

       <b>--help</b> Show usage information.

       <b>--version</b>
              Show version of <b>volume_key</b>.

       The following options alter the behavior of the specified operation:

       <b>-b</b>, <b>--batch</b>
              Run  in  batch mode.  Read passwords and passphrases from standard input, each terminated by a NUL
              character.  If a packet does not match a volume exactly, fail instead of prompting the user.

       <b>-d</b>, <b>--nss-dir</b> <u>DIR</u>
              Use private keys in NSS database in <u>DIR</u> to decrypt public key-encrypted packets.

       <b>-o</b>, <b>--output</b> <u>PACKET</u>
              Write the default secret to <u>PACKET</u>.

              Which secret is the default depends on volume format: it should not be likely to  expire,  and  it
              should allow restoring access to the volume using <b>--restore</b>.

       <b>--output-data-encryption-key</b> <u>PACKET</u>
              Write the data encryption key (the key directly used to encrypt the actual volume data) to <u>PACKET</u>.

       <b>--output-passphrase</b> <u>PACKET</u>
              Write a passphrase that can be used to access the volume to <u>PACKET</u>.

       <b>--create-random-passphrase</b> <u>PACKET</u>
              Generate  a random alphanumeric passphrase, add it to <u>VOLUME</u> (without affecting other passphrases)
              and store the random passphrase into <u>PACKET</u>.

       <b>-c</b>, <b>--certificate</b> <u>CERT</u>
              Load a certificate from the file specified by <u>CERT</u> and encrypt all output packets using the public
              key contained in the certificate.  If this  option  is  not  specified,  all  output  packets  are
              encrypted using a passphrase.

              Note that <u>CERT</u> is a certificate file name, not a NSS certificate nickname.

       <b>--output-format</b> <u>FORMAT</u>
              Use  <u>FORMAT</u> for all output packets.  <u>FORMAT</u> can currently be one of <b>asymmetric</b> (use CMS to encrypt
              the whole packet, requires a certificate),  <b>asymmetric_wrap_secret_only</b>  (wrap  only  the  secret,
              requires a certificate), <b>passphrase</b> (use GPG to encrypt the whole packet, requires a passphrase).

       <b>--unencrypted</b>
              Only dump the unencrypted parts of the packet, if any, with <b>--dump</b>.  Do not require any passphrase
              or private key access.

       <b>--with-secrets</b>
              Include secrets in the output of <b>--dump</b>

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <b>volume_key</b> returns with exit status 0 on success, 1 on error.

</pre><h4><b>NOTES</b></h4><pre>
       The only currently supported volume format is LUKS.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Typical  usage  of <b>volume_key</b> proceeds as follows.  During system installation or soon after, back up the
       default secret of a  volume,  and  add  a  system-specific  random  passphrase.   Encrypt  both  using  a
       certificate:
              <b>volume_key</b> <b>--save</b> <u>VOLUME</u> <b>-c</b> <u>CERT</u> <b>-o</b> <u>PACKET_DEFAULT</u> <b>--create-random-passphrase</b> <u>PACKET_PASSPHRASE</u>
       Store <u>PACKET_DEFAULT</u> and <u>PACKET_PASSPHRASE</u> outside of the computer.

       If  the  user  forgets  a  passphrase,  and you can access the computer, decrypt <u>PACKET_DEFAULT</u> using the
       certificate private key (which should never leave a secure machine):
              <b>volume_key</b> <b>--reencrypt</b> <b>-d</b> <u>NSS_DB</u> <u>PACKET_DEFAULT</u> <b>-o</b> <u>PACKET_DEFAULT_PW</u>
       Then boot the computer (e.g. using a "rescue mode"), copy <u>PACKET_DEFAULT_PW</u> to it, and restore access  to
       the volume:
              <b>volume_key</b> <b>--restore</b> <u>VOLUME</u> <u>PACKET_DEFAULT_PW</u>

       If the user forgets the passphrase, and you cannot access the computer, decrypt the backup passphrase:
              <b>volume_key</b> <b>--secrets</b> <u>PACKET_PASSPHRASE</u>
       and tell the backup passphrase to the user.  (You can later generate a new backup passphrase.)

volume_key                                          Jun 2011                                       <u><a href="../man8/volume_key.8.html">volume_key</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>