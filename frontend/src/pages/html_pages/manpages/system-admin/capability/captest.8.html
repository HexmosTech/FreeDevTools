<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>captest - a program to demonstrate capabilities</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcap-ng-utils">libcap-ng-utils_0.8.5-4build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       captest - a program to demonstrate capabilities

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>captest</b> <b>[</b> <b>--ambient</b> <b>--drop-all</b> <b>|</b> <b>--drop-caps</b> <b>|</b> <b>--id</b> <b>]</b> <b>[</b> <b>--init-grp</b> <b>]</b> <b>[</b> <b>--lock</b> <b>]</b> <b>[</b> <b>--text</b> <b>]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>captest</b>  is  a  program  that  demonstrates  and prints out the current process capabilities. Each option
       prints the same report. It will output current capabilities. then  it  will  try  to  access  <a href="file:/etc/shadow">/etc/shadow</a>
       directly  to  show if that can be done. Then it creates a child process that attempts to read <a href="file:/etc/shadow">/etc/shadow</a>
       and outputs the results of that. Then it outputs the capabilities that a child process would have.

       You can also apply file system capabilities to this program to study how they work. For example,  filecap
       /usr/bin/captest  chown.  Then  run captest as a normal user. Another interesting test is to make captest
       suid root so that you can see what the interaction is between root's credentials  and  capabilities.  For
       example,  chmod  4755  /usr/bin/captest.  When  run  as  a normal user, the program will see if privilege
       escalation is possible. But do not leave this app setuid root after  you  are  don  testing  so  that  an
       attacker cannot take advantage of it.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--ambient</b>
              This attempts to add CAP_CHOWN ambient capability.

       <b>--drop-all</b>
              This drops all capabilities including ambient and clears the bounding set.

       <b>--drop-caps</b>
              This drops just traditional capabilities.

       <b>--id</b>   This changes to uid and gid 99, drops supplemental groups, and clears the bounding set.

       <b>--init-grp</b>
              This changes to uid and gid 99 and then adds any supplemental groups that comes with that account.
              You  would  have  add them prior to testing because by default there are no supplemental groups on
              account 99.

       <b>--text</b> This option outputs the effective capabilities in text rather than numerically.

       <b>--lock</b> This prevents the ability for child processes to regain privileges if the uid is 0.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/filecap.8.html">filecap</a></b>(8), <b><a href="../man7/capabilities.7.html">capabilities</a></b>(7)

</pre><h4><b>AUTHOR</b></h4><pre>
       Steve Grubb

Red Hat                                             Sept 2020                                        <u>CAPTEST:</u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>