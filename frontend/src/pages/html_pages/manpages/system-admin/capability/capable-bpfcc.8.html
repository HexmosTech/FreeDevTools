<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>capable - Trace security capability checks (cap_capable()).</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/bpfcc-tools">bpfcc-tools_0.31.0+ds-7ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       capable - Trace security capability checks (cap_capable()).

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>capable</b> <b>[-h]</b> <b>[-v]</b> <b>[-p</b> <b>PID]</b> <b>[-K]</b> <b>[-U]</b> <b>[-x]</b> <b>[--cgroupmap</b> <b>MAPPATH]</b>
                  [--mntnsmap MAPPATH] [--unique]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  traces  security  capability  checks  in  the kernel, and prints details for each call. This can be
       useful for general debugging, and also security enforcement: determining a white list of capabilities  an
       application needs.

       Since this uses BPF, only the root user can use this tool.

</pre><h4><b>REQUIREMENTS</b></h4><pre>
       CONFIG_BPF, bcc.

</pre><h4><b>OPTIONS</b></h4><pre>
       -h USAGE message.

       -v     Include  non-audit  capability checks. These are those deemed not interesting and not necessary to
              audit, such as CAP_SYS_ADMIN checks on memory allocation to affect the behavior of overcommit.

       -K     Include kernel stack traces to the output.

       -U     Include user-space stack traces to the output.

       -x     Show extra fields in TID and INSETID columns.

       --cgroupmap MAPPATH
              Trace cgroups in this BPF map only (filtered in-kernel).

       --mntnsmap  MAPPATH
              Trace mount namespaces in this BPF map only (filtered in-kernel).

       --unique
              Don't repeat stacks for the same PID or cgroup.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Trace all capability checks system-wide:
              # <b>capable</b>

       Trace capability checks for PID 181:
              # <b>capable</b> <b>-p</b> <b>181</b>

       Trace capability checks in a set of cgroups only (see special_filtering.md
              from bcc sources for more details): # <b>capable</b> <b>--cgroupmap</b> <b>/sys/fs/bpf/test01</b>

</pre><h4><b>FIELDS</b></h4><pre>
       TIME(s)
              Time of capability check: HH:MM:SS.

       UID    User ID.

       PID    Process ID.

       COMM   Process name.  CAP Capability number.  NAME Capability name. See <a href="../man7/capabilities.7.html">capabilities</a>(7) for descriptions.

       AUDIT  Whether this was an audit event. Use -v to include non-audit events.  INSETID Whether the  INSETID
              bit was set (Linux &gt;= 5.1).

</pre><h4><b>OVERHEAD</b></h4><pre>
       This  adds  low-overhead  instrumentation  to  capability checks, which are expected to be low frequency,
       however, that depends on the application. Test in a lab environment before use.

</pre><h4><b>SOURCE</b></h4><pre>
       This is from bcc.

              https://github.com/iovisor/bcc

       Also look in the bcc distribution for a companion _examples.txt file containing  example  usage,  output,
       and commentary for this tool.

</pre><h4><b>OS</b></h4><pre>
       Linux

</pre><h4><b>STABILITY</b></h4><pre>
       Unstable - in development.

</pre><h4><b>AUTHOR</b></h4><pre>
       Brendan Gregg

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man7/capabilities.7.html">capabilities</a>(7)

USER COMMANDS                                      2020-03-08                                         <u><a href="../man8/capable.8.html">capable</a></u>(8)
</pre>
 </div>
</div></section>
</div>
</body>
</html>