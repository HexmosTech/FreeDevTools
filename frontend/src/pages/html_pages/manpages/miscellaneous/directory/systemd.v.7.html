<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>systemd.v - Directory with Versioned Resources</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/systemd">systemd_257.7-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       systemd.v - Directory with Versioned Resources

</pre><h4><b>DESCRIPTION</b></h4><pre>
       In various places systemd components accept paths whose trailing components have the ".v/" suffix,
       pointing to a directory. These components will then automatically look for suitable files inside the
       directory, do a version comparison and open the newest file found (by version). Available since version
       v256. Specifically, two expressions are supported:

       •   When looking for files with a suffix <u>.SUFFIX</u>, and a path ...<u>PATH</u>/<u>NAME.SUFFIX</u>.v/ is specified, then
           all files ...<u>PATH</u>/<u>NAME.SUFFIX</u>.v/<u>NAME</u>_*<u>.SUFFIX</u> are enumerated, filtered, sorted and the newest file
           used. The primary sorting key is the <u>variable</u> <u>part</u>, here indicated by the wildcard "*".

       •   When a path ...<u>PATH</u>.v/<u>NAME</u>___<u>.SUFFIX</u> is specified (i.e. the penultimate component of the path ends in
           ".v" and the final component contains a triple underscore), then all files ...<u>PATH</u>.v/<u>NAME</u>_*<u>.SUFFIX</u>
           are enumerated, filtered, sorted and the newest file used (again, by the <u>variable</u> <u>part</u>, here
           indicated by the wildcard "*").

       To illustrate this in an example, consider a directory /var/lib/machines/mymachine.raw.v/, which is
       populated with three files:

       •   mymachine_7.5.13.raw

       •   mymachine_7.5.14.raw

       •   mymachine_7.6.0.raw

       Invoke a tool such as <b><a href="../man1/systemd-nspawn.1.html">systemd-nspawn</a></b>(1) with a command line like the following:

           # systemd-nspawn --image=/var/lib/machines/mymachine.raw.v --boot

       Then this would automatically be resolved to the equivalent of:

           # systemd-nspawn --image=/var/lib/machines/mymachine.raw.v/mymachine_7.6.0.raw --boot

       Much of systemd's functionality that expects a path to a disk image or OS directory hierarchy support the
       ".v/" versioned directory mechanism, for example <b><a href="../man1/systemd-nspawn.1.html">systemd-nspawn</a></b>(1), <b><a href="../man1/systemd-dissect.1.html">systemd-dissect</a></b>(1) or the
       <u>RootDirectory=</u>/<u>RootImage=</u> settings of service files (see <b><a href="../man5/systemd.exec.5.html">systemd.exec</a></b>(5)).

       Use the <b><a href="../man1/systemd-vpick.1.html">systemd-vpick</a></b>(1) tool to resolve ".v/" paths from the command line, for example for usage in
       shell scripts.

</pre><h4><b>FILTERING</b> <b>AND</b> <b>SORTING</b></h4><pre>
       The variable part of the filenames in the ".v/" directories are filtered and compared primarily with a
       version comparison, implementing <b>Version</b> <b>Format</b> <b>Specification</b>[1]. However, additional rules apply:

       •   If the variable part is suffixed by one or two integer values ("tries left" and "tries done") in the
           formats +<u>LEFT</u> or +<u>LEFT</u>-<u>DONE</u>, then these indicate usage attempt counters. The idea is that each time
           before a file is attempted to be used, its "tries left" counter is decreased, and the "tries done"
           counter increased (simply by renaming the file). When the file is successfully used (which for
           example could mean for an OS image: successfully booted) the counters are removed from the file name,
           indicating that the file has been validated to work correctly. This mechanism mirrors the boot
           assessment counters defined by <b>Automatic</b> <b>Boot</b> <b>Assessment</b>[2]. Any filenames with no boot counters or
           with a non-zero "tries left" counter are sorted before filenames with a zero "tries left" counter.

       •   Preceding the use counters (if they are specified), an optional CPU architecture identifier may be
           specified in the filename (separated from the version with an underscore), as defined in the
           architecture vocabulary of the <u>ConditionArchitecture=</u> unit file setting, as documented in
           <b><a href="../man5/systemd.unit.5.html">systemd.unit</a></b>(5). Files whose name indicates an architecture not supported locally are filtered and
           not considered for the version comparison.

       •   The rest of the variable part is the version string.

       Or in other words, the files in the ".v/" directories should follow one of these naming structures:

       •   <u>NAME</u>_<u>VERSION.SUFFIX</u>

       •   <u>NAME</u>_<u>VERSION</u>_<u>ARCHITECTURE.SUFFIX</u>

       •   <u>NAME</u>_<u>VERSION</u>+<u>LEFT.SUFFIX</u>

       •   <u>NAME</u>_<u>VERSION</u>+<u>LEFT</u>-<u>DONE.SUFFIX</u>

       •   <u>NAME</u>_<u>VERSION</u>_<u>ARCHITECTURE</u>+<u>LEFT.SUFFIX</u>

       •   <u>NAME</u>_<u>VERSION</u>_<u>ARCHITECTURE</u>+<u>LEFT</u>-<u>DONE.SUFFIX</u>

</pre><h4><b>EXAMPLE</b></h4><pre>
       Here's a more comprehensive example, further extending the one described above. Consider a directory
       /var/lib/machines/mymachine.raw.v/, which is populated with the following files:

       •   mymachine_7.5.13.raw

       •   mymachine_7.5.14_x86-64.raw

       •   mymachine_7.6.0_arm64.raw

       •   mymachine_7.7.0_x86-64+0-5.raw

       Now invoke the following command on an x86-64 machine:

           $ systemd-vpick --suffix=.raw /var/lib/machines/mymachine.raw.v/

       This would resolve the specified path to /var/lib/machines/mymachine.raw.v/mymachine_7.5.14_x86-64.raw.
       Explanation: even though mymachine_7.7.0_x86-64+0-5.raw has the newest version, it is not preferred
       because its tries left counter is zero. And even though mymachine_7.6.0_arm64.raw has the second newest
       version it is also not considered in this case, because we operate on an x86_64 system and the image is
       intended for arm64 CPUs. Finally, the mymachine_7.5.13.raw image is not considered because it is older
       than mymachine_7.5.14_x86-64.raw.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man1/systemd-vpick.1.html">systemd-vpick</a></b>(1), <b><a href="../man1/systemd-nspawn.1.html">systemd-nspawn</a></b>(1), <b><a href="../man1/systemd-dissect.1.html">systemd-dissect</a></b>(1), <b><a href="../man5/systemd.exec.5.html">systemd.exec</a></b>(5), <b><a href="../man8/systemdsysupdate.8.html">systemd-</a></b>
       <b><a href="../man8/systemdsysupdate.8.html">sysupdate</a></b>(8)

</pre><h4><b>NOTES</b></h4><pre>
        1. Version Format Specification
           https://uapi-group.org/specifications/specs/version_format_specification/

        2. Automatic Boot Assessment
           https://systemd.io/AUTOMATIC_BOOT_ASSESSMENT/

systemd 257.7                                                                                       <u><a href="../man7/SYSTEMD.V.7.html">SYSTEMD.V</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>