<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>crypto-policies - system-wide crypto policies overview</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/crypto-policies">crypto-policies_20190816git-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       crypto-policies - system-wide crypto policies overview

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The security of cryptographic components of the operating system does not remain constant over time.
       Algorithms, such as cryptographic hashing and encryption, typically have a lifetime, after which they are
       considered either too risky to use or plain insecure. That means, we need to phase out such algorithms
       from the default settings or completely disable them if they could cause an irreparable problem.

       While in the past the algorithms were not disabled in a consistent way and different applications applied
       different policies, the system-wide crypto-policies followed by the crypto core components allow
       consistently deprecating and disabling algorithms system-wide.

       The individual policy levels (<b>DEFAULT</b>, <b>LEGACY</b>, <b>FUTURE</b>, and <b>FIPS</b>) are included in the <b><a href="../man7/crypto-policies.7.html">crypto-policies</a>(7)</b>
       package. In the future, there will be also a mechanism for easy creation and deployment of policies
       defined by the system administrator or a third party vendor.

       For rationale, see <b>RFC</b> <b>7457</b> for a list of attacks taking advantage of legacy crypto algorithms.

</pre><h4><b>COVERED</b> <b>APPLICATIONS</b></h4><pre>
       Crypto-policies apply to the configuration of the core cryptographic subsystems, covering <b>TLS</b>, <b>IKE</b>,
       <b>IPSec</b>, <b>DNSSec</b>, and <b>Kerberos</b> protocols; i.e., the supported secure communications protocols on the base
       operating system.

       Once an application runs in the operating system, it follows the default or selected policy and refuses
       to fall back to algorithms and protocols not within the policy, unless the user has explicitly requested
       the application to do so. That is, the policy applies to the default behavior of applications when
       running with the system-provided configuration but the user can override it on an application-specific
       basis.

       The policies currently provide settings for these applications and libraries:

       •   <b>BIND</b> DNS name server daemon

       •   <b>GnuTLS</b> TLS library

       •   <b>OpenJDK</b> runtime environment

       •   <b>Kerberos</b> <b>5</b> library

       •   <b>Libreswan</b> IPsec and IKE protocol implementation

       •   <b>NSS</b> TLS library

       •   <b>OpenSSH</b> SSH2 protocol implementation

       •   <b>OpenSSL</b> TLS library

       •   <b>libssh</b> SSH2 protocol implementation

       Applications using the above libraries and tools are covered by the cryptographic policies unless they
       are explicitly configured not to be so.

</pre><h4><b>PROVIDED</b> <b>POLICY</b> <b>LEVELS</b></h4><pre>
       <b>LEGACY</b>
           This policy ensures maximum compatibility with legacy systems; it is less secure and it includes
           support for <b>TLS</b> <b>1.0</b>, <b>TLS</b> <b>1.1</b>, and <b>SSH2</b> protocols or later. The algorithms <b>DSA</b>, <b>3DES</b>, and <b>RC4</b> are
           allowed, while <b>RSA</b> and <b>Diffie-Hellman</b> parameters are accepted if larger than 1023 bits. The level
           provides at least 64-bit security.

           •   MACs: all <b>HMAC</b> with <b>SHA-1</b> or better + all modern MACs (<b>Poly1305</b> etc.)

           •   Curves: all prime &gt;= 255 bits (including Bernstein curves)

           •   Signature algorithms: with <b>SHA1</b> hash or better (<b>DSA</b> allowed)

           •   <b>TLS</b> Ciphers: all available &gt;= 112-bit key, &gt;= 128-bit block (including <b>RC4</b> and <b>3DES</b>)

           •   Non-TLS Ciphers: same as <b>TLS</b> ciphers with added <b>Camellia</b>

           •   Key exchange: <b>ECDHE</b>, <b>RSA</b>, <b>DHE</b>

           •   <b>DH</b> params size: &gt;= 1023

           •   <b>RSA</b> keys size: &gt;= 1023

           •   <b>DSA</b> params size: &gt;= 1023

           •   <b>TLS</b> protocols: <b>TLS</b> &gt;= 1.0, <b>DTLS</b> &gt;= 1.0

       <b>DEFAULT</b>
           The <b>DEFAULT</b> policy is a reasonable default policy for today’s standards. It allows the <b>TLS</b> <b>1.0</b>, <b>TLS</b>
           <b>1.1</b>, <b>TLS</b> <b>1.2</b>, and <b>TLS</b> <b>1.3</b> protocols, as well as <b>IKEv2</b> and <b>SSH2</b>. The <b>Diffie-Hellman</b> parameters are
           accepted if they are at least 1023 bits long. The level provides at least 80-bit security.

           •   MACs: all <b>HMAC</b> with <b>SHA-1</b> or better + all modern MACs (<b>Poly1305</b> etc.)

           •   Curves: all prime &gt;= 255 bits (including Bernstein curves)

           •   Signature algorithms: with <b>SHA-1</b> hash or better (no <b>DSA</b>)

           •   <b>TLS</b> Ciphers: &gt;= 128-bit key, &gt;= 128-bit block (<b>AES</b>, <b>ChaCha20</b>, including <b>AES-CBC</b>)

           •   non-TLS Ciphers: as <b>TLS</b> Ciphers with added <b>Camellia</b>

           •   key exchange: <b>ECDHE</b>, <b>RSA</b>, <b>DHE</b> (no <b>DHE-DSS</b>)

           •   <b>DH</b> params size: &gt;= 1023

           •   <b>RSA</b> keys size: &gt;= 2048

           •   <b>TLS</b> protocols: <b>TLS</b> &gt;= 1.0, <b>DTLS</b> &gt;= 1.0

       <b>NEXT</b>
           The <b>NEXT</b> policy is a policy prepared for the upcoming release of the operating system so it can be
           easily tested. It allows the <b>TLS</b> <b>1.2</b> and <b>TLS</b> <b>1.3</b> protocols, as well as <b>IKEv2</b> and <b>SSH2</b>. The <b>RSA</b> and
           <b>Diffie-Hellman</b> parameters are accepted if larger than 2047 bits. The level provides at least 112-bit
           security with the exception of <b>SHA-1</b> signatures needed for <b>DNSSec</b> and other still prevalent legacy
           use of <b>SHA-1</b> signatures.

           •   MACs: all <b>HMAC</b> with <b>SHA-1</b> or better + all modern MACs (<b>Poly1305</b> etc.)

           •   Curves: all prime &gt;= 255 bits (including Bernstein curves)

           •   Signature algorithms: with <b>SHA-1</b> hash or better (no <b>DSA</b>)

           •   <b>TLS</b> Ciphers: &gt;= 128-bit key, &gt;= 128-bit block (<b>AES</b>, <b>ChaCha20</b>, including <b>AES-CBC</b>)

           •   non-TLS Ciphers: as <b>TLS</b> Ciphers with added <b>Camellia</b>

           •   key exchange: <b>ECDHE</b>, <b>RSA</b>, <b>DHE</b> (no <b>DHE-DSS</b>)

           •   <b>DH</b> params size: &gt;= 2048

           •   <b>RSA</b> keys size: &gt;= 2048

           •   <b>TLS</b> protocols: <b>TLS</b> &gt;= 1.2, <b>DTLS</b> &gt;= 1.2

       <b>FUTURE</b>
           A conservative security level that is believed to withstand any near-term future attacks. This level
           does not allow the use of <b>SHA-1</b> in signature algorithms. The level also provides some (not complete)
           preparation for post-quantum encryption support in form of 256-bit symmetric encryption requirement.
           The <b>RSA</b> and <b>Diffie-Hellman</b> parameters are accepted if larger than 3071 bits. The level provides at
           least 128-bit security.

           •   MACs: all <b>HMAC</b> with <b>SHA-256</b> or better + all modern MACs (<b>Poly1305</b> etc.)

           •   Curves: all prime &gt;= 255 bits (including Bernstein curves)

           •   Signature algorithms: with <b>SHA-256</b> hash or better (no <b>DSA</b>)

           •   <b>TLS</b> Ciphers: &gt;= 256-bit key, &gt;= 128-bit block, only Authenticated Encryption (AE) ciphers

           •   non-TLS Ciphers: same as <b>TLS</b> ciphers with added non AE ciphers and <b>Camellia</b>

           •   key exchange: <b>ECDHE</b>, <b>DHE</b> (no <b>DHE-DSS</b>, no <b>RSA</b>)

           •   <b>DH</b> params size: &gt;= 3072

           •   <b>RSA</b> keys size: &gt;= 3072

           •   <b>TLS</b> protocols: <b>TLS</b> &gt;= 1.2, <b>DTLS</b> &gt;= 1.2

       <b>FIPS</b>
           A level that conforms to the <b>FIPS</b> <b>140-2</b> requirements. This policy is used internally by the
           <b><a href="../man8/fips-mode-setup.8.html">fips-mode-setup</a>(8)</b> tool which can switch the system into the <b>FIPS</b> <b>140-2</b> compliance mode. The level
           provides at least 112-bit security.

           •   MACs: all <b>HMAC</b> with <b>SHA1</b> or better

           •   Curves: all prime &gt;= 256 bits

           •   Signature algorithms: with <b>SHA-256</b> hash or better (no <b>DSA</b>)

           •   <b>TLS</b> Ciphers: &gt;= 128-bit key, &gt;= 128-bit block (<b>AES</b>, including <b>AES-CBC</b>)

           •   non-TLS Ciphers: same as <b>TLS</b> Ciphers

           •   key exchange: <b>ECDHE</b>, <b>DHE</b> (no <b>DHE-DSS</b>, no <b>RSA</b>)

           •   <b>DH</b> params size: &gt;= 2048

           •   <b>RSA</b> params size: &gt;= 2048

           •   <b>TLS</b> protocols: <b>TLS</b> &gt;= 1.2, <b>DTLS</b> &gt;= 1.2

       <b>EMPTY</b>
           All cryptographic algorithms are disabled (used for debugging only, do not use).

</pre><h4><b>CRYPTO</b> <b>POLICY</b> <b>DEFINITON</b> <b>FORMAT</b></h4><pre>
       The crypto policy definiton files have a simple syntax following an <b>INI</b> file <b>key</b> = <b>value</b> syntax with
       these particular features:

       •   Comments are indicated by <u>#</u> character. Everything on the line following the character is ignored.

       •   Backslash <u>\</u> character followed immediately with the end-of-line character indicates line
           continuation. The following line is concatenated to the current line after the backslash and
           end-of-line characters are removed.

       •   Value types can be either decimal integers, arbitrary strings, or lists of strings without whitespace
           characters separated by any number of whitespaces.

       The allowed keys are:

       •   <b>mac</b>: List of allowed MAC algorithms

       •   <b>group</b>: List of allowed groups or elliptic curves for key exchanges

       •   <b>hash</b>: List of allowed cryptographic hash (message digest) algorithms

       •   <b>sign</b>: List of allowed signature algorithms

       •   <b>tls_cipher</b>: List of allowed symmetric encryption algorithms (including the modes) for use with the
           TLS protocol

       •   <b>cipher</b>: List of allowed symmetric encryption algorithms (including the modes) for use with other
           protocols

       •   <b>key_exchange</b>: List of allowed key exchange algorithms

       •   <b>protocol</b>: List of allowed TLS and DTLS protocol versions

       •   <b>ike_protocol</b>: List of allowed IKE protocol versions

       •   <b>min_tls_version</b>: Lowest allowed TLS protocol version

       •   <b>min_dtls_version</b>: Lowest allowed DTLS protocol version

       •   <b>min_dh_size</b>: Integer value of minimum number of bits of parameters for <b>DH</b> key exchange

       •   <b>min_dsa_size</b>: Integer value of minimum number of bits for <b>DSA</b> keys

       •   <b>min_rsa_size</b>: Integer value of minimum number of bits for <b>RSA</b> keys

       •   <b>sha1_in_certs</b>: Value of 1 if <b>SHA1</b> allowed in certificate signatures, 0 otherwise (Applies to <b>GnuTLS</b>
           back end only.)

       The full policy definition files have suffix <u>.pol</u>, the policy module definition files have suffix <u>.pmod</u>.
       The policy module files do not have to have values set for all the keys listed above.

       The lists as set in the base (full policy) are modified by the lists specified in the module files in
       following way:

       •   <b>-</b><u>list-item</u>: The <u>list-item</u> is removed from the list specified in the base policy.

       •   <b>+</b><u>list-item</u>: The <u>list-item</u> is inserted at the beginning of the list specified in the base policy. The
           inserts are done in the order of appearance in the policy module file so the actual order in the
           final list will be reversed.

       •   <u>list-item</u> or <u>list-item</u><b>+</b>: The list-item is appended to the end of the list specified in the base
           policy.

       Non-list key values in the policy module files are simply overridden.

</pre><h4><b>COMMANDS</b></h4><pre>
       <b><a href="../man8/update-crypto-policies.8.html">update-crypto-policies</a>(8)</b>
           This command manages the policies available to the various cryptographic back ends and allows the
           system administrator to change the active cryptographic policy level.

       <b><a href="../man8/fips-mode-setup.8.html">fips-mode-setup</a>(8)</b>
           This command allows the system administrator to enable, or disable the system FIPS mode and also
           apply the <b>FIPS</b> cryptographic policy level which limits the allowed algorithms and protocols to these
           allowed by the FIPS 140-2 requirements.

</pre><h4><b>NOTES</b></h4><pre>
       <b>Exceptions:</b>

       •   <b>Go-language</b> applications do not yet follow the system-wide policy.

       •   <b>GnuPG-2</b> application does not follow the system-wide policy.

       In general only the data-in-transit is currently covered by the system-wide policy.

       If the system administrator changes the system-wide policy level with the <b><a href="../man8/update-crypto-policies.8.html">update-crypto-policies</a>(8)</b>
       command it is advisable to restart the system as the individual back-end libraries read the configuration
       files usually during their initialization. The changes in the policy level thus take place in most cases
       only when the applications using the back-end libraries are restarted.

       <b>Removed</b> <b>cipher</b> <b>suites</b> <b>and</b> <b>protocols</b>

       The following cipher suites and protocols are completely removed from the core cryptographic libraries
       listed above:

       •   <b>DES</b>

       •   All export grade cipher suites

       •   <b>MD5</b> in signatures

       •   <b>SSLv2</b>

       •   <b>SSLv3</b>

       •   All <b>ECC</b> curves smaller than 224 bits

       •   All binary field <b>ECC</b> curves

       <b>Cipher</b> <b>suites</b> <b>and</b> <b>protocols</b> <b>disabled</b> <b>in</b> <b>all</b> <b>policy</b> <b>levels</b>

       The following ciphersuites and protocols are available but disabled in all crypto policy levels. They can
       be enabled only by explicit configuration of individual applications:

       •   <b>DH</b> with parameters &lt; 1024 bits

       •   <b>RSA</b> with key size &lt; 1024 bits

       •   <b>Camellia</b>

       •   <b>ARIA</b>

       •   <b>SEED</b>

       •   <b>IDEA</b>

       •   Integrity only ciphersuites

       •   <b>TLS</b> <b>CBC</b> <b>mode</b> ciphersuites using <b>SHA-384</b> HMAC

       •   <b>AES-CCM8</b>

       •   all <b>ECC</b> curves incompatible with <b>TLS</b> <b>1.3</b>, including secp256k1

       •   <b>IKEv1</b>

</pre><h4><b>FILES</b></h4><pre>
       /etc/crypto-policies/back-ends
           The individual cryptographical back-end configuration files. Usually linked to the configuration
           shipped in the crypto-policies package unless a configuration from <b>local.d</b> is added.

       /etc/crypto-policies/config
           The active crypto-policies level set on the system.

       /etc/crypto-policies/local.d
           Additional configuration shipped by other packages or created by the system administrator. The
           contents of the <b>&lt;back-end&gt;-file.config</b> is appended to the configuration from the policy back end as
           shipped in the crypto-policies package.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/update-crypto-policies.8.html">update-crypto-policies</a>(8), <a href="../man8/fips-mode-setup.8.html">fips-mode-setup</a>(8)

</pre><h4><b>AUTHOR</b></h4><pre>
       Written by Tomáš Mráz.

crypto-policies                                    08/24/2019                                 <u><a href="../man7/CRYPTO-POLICIES.7.html">CRYPTO-POLICIES</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>