<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAILOVER - Fail a broken replication set over to a backup node</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/slony1-2-doc">slony1-2-doc_2.2.11-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       FAILOVER - Fail a broken replication set over to a backup node

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>FAILOVER</b> <b>(options);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>FAILOVER</b> command causes the backup node to take over all sets that currently originate on the failed
       node. slonik will contact all other direct subscribers of the failed node to determine which node has the
       highest sync status for each set. If another node has a higher sync status  than  the  backup  node,  the
       replication  will  first be redirected so that the backup node replicates against that other node, before
       assuming the origin role and allowing update activity.

       After successful failover, all former direct subscribers of the failed node become direct subscribers  of
       the  backup node. The failed node is abandoned, and can and should be removed from the configuration with
       <b>SLONIK</b> <b>DROP</b> <b><a href="../man7/NODE.7.html">NODE</a></b>(7).

       If multiple set origin nodes have failed, then you should tell FAILOVER about all of them in one request.
       This is done by passing a list like NODE=(ID=val,BACKUP NODE=val), NODE=(ID=val2,  BACKUP  NODE=val2)  to
       FAILOVER.

       Nodes  that  are  forwarding  providers  can also be passed to the failover command as a failed node. The
       failover process will redirect the subscriptions from these nodes to the backup node.

       ID = ival
              ID of the failed node

       BACKUP NODE = ival
              Node ID of the node that will take over all sets originating on the failed node

       This uses “schemadocfailednode(p_failed_nodes integer, p_backup_node integer,  p_failed_node  integer[])”
       [not available as a man page].

</pre><h4><b>EXAMPLE</b></h4><pre>
       FAILOVER (
          ID = 1,
          BACKUP NODE = 2
       );

       #example of multiple nodes
       FAILOVER(
          NODE=(ID=1, BACKUP NODE=2),
          NODE=(ID=3, BACKUP NODE=4)
       );

</pre><h4><b>LOCKING</b> <b>BEHAVIOUR</b></h4><pre>
       Exclusive  locks  on  each  replicated table will be taken out on both the new origin node as replication
       triggers are changed.  If the new origin was not completely up to date,  and  replication  data  must  be
       drawn from some other node that is more up to date, the new origin will not become usable until those up‐
       dates are complete.

</pre><h4><b>DANGEROUS/UNINTUITIVE</b> <b>BEHAVIOUR</b></h4><pre>
       This  command  will abandon the status of the failed node. There is no possibility to let the failed node
       join the cluster again without rebuilding it from scratch as a slave. If at all possible, you would like‐
       ly prefer to use <b>SLONIK</b> <b>MOVE</b> <b><a href="../man7/SET.7.html">SET</a></b>(7) instead, as that does <u>not</u> abandon the failed node.

       If a second failure occours in the middle of a FAILOVER operation then recovery might be complicated.

</pre><h4><b>SLONIK</b> <b>EVENT</b> <b>CONFIRMATION</b> <b>BEHAVIOUR</b></h4><pre>
       Slonik will submit the FAILOVER_EVENT without waiting but wait until the most  ahead  node  has  received
       confirmations of the FAILOVER_EVENT from all nodes before completing.

</pre><h4><b>VERSION</b> <b>INFORMATION</b></h4><pre>
       This command was introduced in Slony-I 1.0

       In version 2.0, the default <b>BACKUP</b> <b>NODE</b> value of 1 was removed, so it is mandatory to provide a value for
       this parameter

       In version 2.2 support was added for passing multiple nodes to a single failover command

                                                19 September 2024                             <u>SLONIK</u> <u><a href="../man7/FAILOVER.7.html">FAILOVER</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>