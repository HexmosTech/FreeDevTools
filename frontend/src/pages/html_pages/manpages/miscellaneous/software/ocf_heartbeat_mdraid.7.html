<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ocf_heartbeat_mdraid - Manages Linux software RAID (MD) devices on shared storage</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/resource-agents-extra">resource-agents-extra_4.16.0-3ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ocf_heartbeat_mdraid - Manages Linux software RAID (MD) devices on shared storage

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>mdraid</b> [start | stop | monitor | meta-data | validate-all]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This resource agent manages Linux software RAID (MD) devices on a shared storage medium ensuring that
       non-clustered MD arrays are prohibited from starting cloned (which would cause data corruption (e.g., on
       raid6 arrays) unless forced (see force_clones parameter). Clustered MD RAID layouts (see below) will be
       discovered and allowed cloning by default; no need to set force_clones.

       It uses <a href="../man8/mdadm.8.html">mdadm</a>(8) to start, stop, and monitor the MD devices.

       Supported clustered (i.e., clonable active-active) arrays are linear, raid0, and clustered raid1/raid10
       (i.e. <a href="../man8/mdadm.8.html">mdadm</a>(8) created with

       --bitmap=clustered).

       Option: OCF_CHECK_LEVEL

       When OCF_CHECK_LEVEL is set to any number greater than 0, the standard monitor operation (including
       probe) will check the array and attempt recovery sequence to re-add devices if any failed device exists.
       By default, OCF_CHECK_LEVEL is unset, and this is disabled.

</pre><h4><b>SUPPORTED</b> <b>PARAMETERS</b></h4><pre>
       <b>mdadm_conf</b>
           The MD RAID configuration file (e.g., /etc/mdadm.conf).

           (required, string, no default)

       <b>md_dev</b>
           MD array block device to use (e.g., /dev/md0 or /dev/md/3). With shared access to the array's
           storage, this should preferably be a clustered raid1 or raid10 array created with --bitmap=clustered,
           assuming its resource will be cloned (i.e., active-active access).

           Be sure to disable auto-assembly for the resource-managed arrays!

           (required, string, no default)

       <b>force_stop</b>
           If processes or kernel threads are using the array, it cannot be stopped. We will try to stop
           processes, first by sending TERM and then, if that doesn't help in seconds, using KILL. The <a href="../man8/lsof.8.html">lsof</a>(8)
           program is required to get the list of array users. Of course, the kernel threads cannot be stopped
           this way. If the processes are critical for data integrity, then set this parameter to false. Note
           that in that case the stop operation will fail and the node will be fenced.

           (optional, boolean, default false)

       <b>wait_for_udev</b>
           Wait until udevd creates a device in the start operation. On a normally loaded host this should
           happen quickly, but you may be unlucky. If you are not using udev set this to "no".

           (optional, boolean, default true)

       <b>force_clones</b>
           Activating the same, non-clustered MD RAID array (i.e. single-host raid1/4/5/6/10) on multiple nodes
           at the same time will result in data corruption and thus is forbidden by default.

           A safe example could be an (exotic) array that is only named identically across all nodes, but is in
           fact based on distinct (non-shared) storage.

           Only set this to "true" if you know what you are doing!

           (optional, boolean, default false)

</pre><h4><b>SUPPORTED</b> <b>ACTIONS</b></h4><pre>
       This resource agent supports the following actions (operations):

       <b>start</b>
           Starts the resource. Suggested minimum timeout: 20s.

       <b>stop</b>
           Stops the resource. Suggested minimum timeout: 20s.

       <b>monitor</b>
           Performs a detailed status check. Suggested minimum timeout: 20s. Suggested interval: 10s.

       <b>validate-all</b>
           Performs a validation of the resource configuration. Suggested minimum timeout: 5s.

       <b>meta-data</b>
           Retrieves resource agent metadata (internal use only). Suggested minimum timeout: 5s.

</pre><h4><b>EXAMPLE</b> <b>CRM</b> <b>SHELL</b></h4><pre>
       The following is an example configuration for a mdraid resource using the <b><a href="../man8/crm.8.html">crm</a></b>(8) shell:

           primitive p_mdraid ocf:heartbeat:mdraid \
             params \
               mdadm_conf=<u>string</u> \
               md_dev=<u>string</u> \
             op monitor depth="0" timeout="20s" interval="10s"

</pre><h4><b>EXAMPLE</b> <b>PCS</b></h4><pre>
       The following is an example configuration for a mdraid resource using <b><a href="../man8/pcs.8.html">pcs</a></b>(8)

           pcs resource create p_mdraid ocf:heartbeat:mdraid \
             mdadm_conf=<u>string</u> \
             md_dev=<u>string</u> \
             op monitor OCF_CHECK_LEVEL="0" timeout="20s" interval="10s"

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="http://clusterlabs.org/">http://clusterlabs.org/</a></b>

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>ClusterLabs</b> <b>contributors</b> <b>(see</b> <b>the</b> <b>resource</b> <b>agent</b> <b>source</b> <b>for</b> <b>information</b> <b>about</b> <b>individual</b> <b>authors)</b>

resource-agents 4.16.0-3ubuntu                     06/25/2025                            <u><a href="../man7/OCF_HEARTBEAT_MDRAID.7.html">OCF_HEARTBEAT_MDRAID</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>