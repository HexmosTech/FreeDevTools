<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ocf_heartbeat_ethmonitor - Monitors network interfaces</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/resource-agents-extra">resource-agents-extra_4.16.0-3ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ocf_heartbeat_ethmonitor - Monitors network interfaces

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>ethmonitor</b> [start | stop | status | monitor | meta-data | validate-all]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Monitor the vitality of a local network interface.

       You may set up this RA as a clone resource to monitor the network interfaces on different nodes, with the
       same interface name. This is not related to the IP address or the network on which a interface is
       configured. You may use this RA to move resources away from a node, which has a faulty interface or
       prevent moving resources to such a node. This gives you independent control of the resources, without
       involving cluster intercommunication. But it requires your nodes to have more than one network interface.

       The resource configuration requires a monitor operation, because the monitor does the main part of the
       work. In addition to the resource configuration, you need to configure some location constraints, based
       on a CIB attribute value. The name of the attribute value is configured in the 'name' option of this RA.

       Example constraint configuration using crmsh location loc_connected_node my_resource_grp rule
       ="rule_loc_connected_node" -INF: ethmonitor eq 0

       Example constraint configuration using pcs. Only allow 'my_resource' to run on nodes where eth0 ethernet
       device is available. pcs constraint location my_resource rule score=-INFINITY ethmonitor-eth0 ne 1

       The ethmonitor works in 3 different modes to test the interface vitality. 1. call ip to see if the link
       status is up (if link is down -&gt; error) 2. call ip and watch the RX counter (if packages come around in a
       certain time -&gt; success) 3. call arping to check whether any of the IPs found in the local ARP cache
       answers an ARP REQUEST (one answer -&gt; success) 4. return error

</pre><h4><b>SUPPORTED</b> <b>PARAMETERS</b></h4><pre>
       <b>interface</b>
           The name of the network interface which should be monitored (e.g. eth0).

           (unique, required, string, no default)

       <b>name</b>
           The name of the CIB attribute to set. This is the name to be used in the constraints. Defaults to
           "ethmonitor-'interface_name'".

           (unique, optional, string, no default)

       <b>multiplier</b>
           Multiplier for the value of the CIB attriobute specified in parameter name.

           (optional, integer, default 1)

       <b>repeat_count</b>
           Specify how often the interface will be monitored, before the status is set to failed. You need to
           set the timeout of the monitoring operation to at least repeat_count * repeat_interval

           (optional, integer, default 5)

       <b>repeat_interval</b>
           Specify how long to wait in seconds between the repeat_counts.

           (optional, integer, default 10)

       <b>pktcnt_timeout</b>
           Timeout for the RX packet counter. Stop listening for packet counter changes after the given number
           of seconds.

           (optional, integer, default 5)

       <b>arping_count</b>
           Number of ARP REQUEST packets to send for every IP. Usually one ARP REQUEST (arping) is send

           (optional, integer, default 1)

       <b>arping_timeout</b>
           Time in seconds to wait for ARP REQUESTs (all packets of arping_count). This is to limit the time for
           arp requests, to be able to send requests to more than one node, without running in the monitor
           operation timeout.

           (optional, integer, default 1)

       <b>arping_cache_entries</b>
           Maximum number of IPs from ARP cache list to check for ARP REQUEST (arping) answers. Newest entries
           are tried first.

           (optional, integer, default 5)

       <b>infiniband_device</b>
           For interfaces that are infiniband devices.

           (optional, string, no default)

       <b>infiniband_port</b>
           For infiniband devices, this is the port to monitor.

           (optional, integer, no default)

       <b>link_status_only</b>
           Only report success based on link status. Do not perform RX counter or arping related connectivity
           tests.

           (optional, boolean, default false)

</pre><h4><b>SUPPORTED</b> <b>ACTIONS</b></h4><pre>
       This resource agent supports the following actions (operations):

       <b>start</b>
           Starts the resource. Suggested minimum timeout: 60s.

       <b>stop</b>
           Stops the resource. Suggested minimum timeout: 20s.

       <b>status</b>
           Performs a status check. Suggested minimum timeout: 60s. Suggested interval: 10s.

       <b>monitor</b>
           Performs a detailed status check. Suggested minimum timeout: 60s. Suggested interval: 10s.

       <b>meta-data</b>
           Retrieves resource agent metadata (internal use only). Suggested minimum timeout: 5s.

       <b>validate-all</b>
           Performs a validation of the resource configuration. Suggested minimum timeout: 20s.

</pre><h4><b>EXAMPLE</b> <b>CRM</b> <b>SHELL</b></h4><pre>
       The following is an example configuration for a ethmonitor resource using the <b><a href="../man8/crm.8.html">crm</a></b>(8) shell:

           primitive p_ethmonitor ocf:heartbeat:ethmonitor \
             params \
               interface=<u>string</u> \
             op monitor depth="0" timeout="60s" interval="10s"

</pre><h4><b>EXAMPLE</b> <b>PCS</b></h4><pre>
       The following is an example configuration for a ethmonitor resource using <b><a href="../man8/pcs.8.html">pcs</a></b>(8)

           pcs resource create p_ethmonitor ocf:heartbeat:ethmonitor \
             interface=<u>string</u> \
             op monitor OCF_CHECK_LEVEL="0" timeout="60s" interval="10s"

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="http://clusterlabs.org/">http://clusterlabs.org/</a></b>

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>ClusterLabs</b> <b>contributors</b> <b>(see</b> <b>the</b> <b>resource</b> <b>agent</b> <b>source</b> <b>for</b> <b>information</b> <b>about</b> <b>individual</b> <b>authors)</b>

resource-agents 4.16.0-3ubuntu                     06/25/2025                            <u><a href="../man7/OCF_HEARTBEAT_ETHMON.7.html">OCF_HEARTBEAT_ETHMON</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>