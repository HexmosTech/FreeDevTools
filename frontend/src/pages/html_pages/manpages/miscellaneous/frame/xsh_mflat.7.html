<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xsh_mflat - Create the master flat and the orders edges traces table frames</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/noble/+package/cpl-plugin-xshoo-doc">cpl-plugin-xshoo-doc_3.5.3+dfsg-1build4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       xsh_mflat - Create the master flat and the orders edges traces table frames

</pre><h4><b>SYNOPSIS</b></h4><pre>
       esorex <b>xsh_mflat</b> [OPTIONS] FILE.sof

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This recipe creates the master flat and the orders edges traces table frames.

         Input Frames :
           - [UVB] A set of n RAW frames (Format = RAW, n&gt;=3, Tag = FLAT_D2_mode_UVB, mode=SLIT/IFU)
           - [UVB] A set of n RAW frames (Format = RAW, n&gt;=3, Tag = FLAT_QTH_mode_UVB)
           - [VIS] A set of n RAW frames (Format = RAW, n&gt;=3, Tag = FLAT_mode_VIS)
           - [NIR] A set of n x n RAW frames ((Format = RAW, n&gt;=3, Tag = FLAT_mode_NIR_ON, FLAT_mode_NIR_OFF)
           - A spectral format table (Format = PRE, Tag = SPECTRAL_FORMAT_TAB_arm)
           - An order table (Format = TABLE, Tag = ORDER_TAB_CENTR_arm)
           - [UVB,VIS] A master bias (Format = PRE, Tag = MASTER_BIAS_arm)
           - [OPTIONAL] A map of reference bad pixel (Format = QUP,RAW, Tag = BP_MAP_RP_arm)
           - [OPTIONAL] A map of non linear pixel (Format = QUP,RAW, Tag = BP_MAP_NL_arm)
           - [OPTIONAL,UVB,VIS] A master dark (Format = PRE, Tag = MASTER_DARK_arm)
         Products :
           - An updated order table with edge UP and edge LOW (Format = TABLE, TAG = ORDER_TAB_EDGES_mode_arm)
           - A master flat (Format = PRE, PRO.CATG = MASTER_FLAT_mode_arm)
           - The inter-order background frame (Format = PRE, PRO.CATG = MFLAT_BACK_mode_arm)
           - The inter-order background sampling points grid table
             (Format = PRE, PRO.CATG = MFLAT_GRID_BACK_mode_arm)
         Prepare the flat frames.

         Stack and sigma clip all the flat frames.

         Subtract master bias.

         Subtract master dark.

         Detect order edge.

         Subtract background.

         Create the Master Flat.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--keep-temp</b> <u>&lt;str&gt;</u>
              If  ´no´,  temporary files are deleted. (str; default: ´no´). The full name of this option for the
              EsoRex configuration file is <b>xsh.xsh_mflat.keep-temp</b> [default = <u>no</u>].

       <b>--debug-level</b> <u>&lt;str&gt;</u>
              Additional xshooter debug level. One of ´none´, ´low´, ´medium´, ´high´  (str;  default:  ´none´).
              The  full  name  of  this  option  for  the EsoRex configuration file is <b>xsh.xsh_mflat.debug-level</b>
              [default = <u>none</u>].

       <b>--time-stamp</b> <u>&lt;bool&gt;</u>
              Add timestamp to product file name. (bool; default: False). The full name of this option  for  the
              EsoRex configuration file is <b>xsh.xsh_mflat.time-stamp</b> [default = <u>False</u>].

       <b>--decode-bp</b> <u>&lt;int&gt;</u>
              Integer  representation  of  the  bits to be considered bad when decoding the bad pixel mask pixel
              values.   Most frequent codes relevant for the user:   0: good pixel,   8:  pick-up  noise,    16:
              cosmic-ray  removed,    32:  cosmic-ray unremoved,   128: calibration file defect, 256: hot pixel,
              512:  dark  pixel,    4096:  A/D  converted  saturation,  32768:  non  linear  pixel,     1048576:
              extrapolated   flux   in  NIR,  4194304:  Interpolated  flux  during  extraction.  (int;  default:
              2144337919).  The  full  name  of   this   option   for   the   EsoRex   configuration   file   is
              <b>xsh.xsh_mflat.decode-bp</b> [default = <u>2144337919</u>].

       <b>--pre-overscan-corr</b> <u>&lt;int&gt;</u>
              pre-overscan  correction.  0: no correction 1: mean overscan correction 2: mean prescan correction
              3: (mean pre+mean overscan)/2 correction (int; default: 1). The full name of this option  for  the
              EsoRex configuration file is <b>xsh.xsh_mflat.pre-overscan-corr</b> [default = <u>1</u>].

       <b>--stack-method</b> <u>&lt;str&gt;</u>
              Method  used to build master frame. (str; default: ´median´). The full name of this option for the
              EsoRex configuration file is <b>xsh.xsh_mflat.stack-method</b> [default = <u>median</u>].

       <b>--klow</b> <u>&lt;float&gt;</u>
              Kappa used to clip low level values, when method is set to ´mean´ (float; default: 5.0). The  full
              name of this option for the EsoRex configuration file is <b>xsh.xsh_mflat.klow</b> [default = <u>5.0</u>].

       <b>--khigh</b> <u>&lt;float&gt;</u>
              Kappa used to clip high level values, when method is set to ´mean´ (float; default: 5.0). The full
              name of this option for the EsoRex configuration file is <b>xsh.xsh_mflat.khigh</b> [default = <u>5.0</u>].

       <b>--detectorder-edges-search-win-hsize</b> <u>&lt;int&gt;</u>
              During  extraction  the  local  spatial  profile  (=cross-order)  of the spectrum is determined by
              collapsing the 2-dimensional spectrum along the dispersion axis. This parameter defines  the  half
              size  of  the region across which the spectrum is collapsed. This parameter affects flagged pixels
              interpolation.  In  case  of  spectrum  gaps  the  recommended  optimal  value  is:   (size_of_gap
              [nm]/(2*size_of_pixel  [nm])+1)  (int;  default:  50). The full name of this option for the EsoRex
              configuration file is <b>xsh.xsh_mflat.detectorder-edges-search-win-hsize</b> [default = <u>50</u>].

       <b>--detectorder-edges-flux-thresh</b> <u>&lt;float&gt;</u>
              Threshold in relative flux (compared to the central flux) below which the order edges are  defined
              (float;  default:  0.4).  The  full  name  of  this  option  for  the EsoRex configuration file is
              <b>xsh.xsh_mflat.detectorder-edges-flux-thresh</b> [default = <u>0.4</u>].

       <b>--detectorder-min-sn</b> <u>&lt;float&gt;</u>
              Minimum signal-to-noise ratio at the centroid of the  orders  (60  for  SLIT-UVB,VIS,NIR,  20  for
              IFU-UVB,VIS,  4  for  IFU-NIR  (float; default: -1.0). The full name of this option for the EsoRex
              configuration file is <b>xsh.xsh_mflat.detectorder-min-sn</b> [default = <u>-1.0</u>].

       <b>--detectorder-min-order-size-x</b> <u>&lt;int&gt;</u>
              Minimum order size in pixels along X direction [60 for UVB,VIS, 40 for NIR]  (int;  default:  -1).
              The    full    name    of    this    option    for    the    EsoRex    configuration    file    is
              <b>xsh.xsh_mflat.detectorder-min-order-size-x</b> [default = <u>-1</u>].

       <b>--detectorder-chunk-half-size</b> <u>&lt;int&gt;</u>
              Half size in pixels of the chunks in Y direction (int; default: 1). The full name of  this  option
              for the EsoRex configuration file is <b>xsh.xsh_mflat.detectorder-chunk-half-size</b> [default = <u>1</u>].

       <b>--detectorder-slitlet-low-factor</b> <u>&lt;float&gt;</u>
              Factor for slitlet on lower edge slitlet (IFU) (float; default: 1.0). The full name of this option
              for the EsoRex configuration file is <b>xsh.xsh_mflat.detectorder-slitlet-low-factor</b> [default = <u>1.0</u>].

       <b>--detectorder-slitlet-up-factor</b> <u>&lt;float&gt;</u>
              Factor for slitlet on upper edge (IFU) (float; default: 1.0). The full name of this option for the
              EsoRex configuration file is <b>xsh.xsh_mflat.detectorder-slitlet-up-factor</b> [default = <u>1.0</u>].

       <b>--detectorder-fixed-slice</b> <u>&lt;bool&gt;</u>
              If true the size of slitlet is fixed (IFU) (bool; default: True). The full name of this option for
              the EsoRex configuration file is <b>xsh.xsh_mflat.detectorder-fixed-slice</b> [default = <u>True</u>].

       <b>--detectorder-slice-trace-method</b> <u>&lt;str&gt;</u>
              method  adopted  for  IFU  slice  tracing  (´fixed´  for SLIT and ´sobel´ for IFU): (str; default:
              ´auto´).   The   full   name   of   this   option   for   the   EsoRex   configuration   file   is
              <b>xsh.xsh_mflat.detectorder-slice-trace-method</b> [default = <u>auto</u>].

       <b>--detectorder-qc-mode</b> <u>&lt;bool&gt;</u>
              If  true  allows  one to skip edge detection on orders below detectorder- min-sn (oly for QC mode,
              not to be set by normal users) (bool; default: False). The full name of this option for the EsoRex
              configuration file is <b>xsh.xsh_mflat.detectorder-qc-mode</b> [default = <u>False</u>].

       <b>--detectorder-d2-min-sn</b> <u>&lt;float&gt;</u>
              minimum signal noise ratio in D2 lamp frame in order (float; default: 60.0). The full name of this
              option for the EsoRex configuration file is <b>xsh.xsh_mflat.detectorder-d2-min-sn</b> [default = <u>60.0</u>].

       <b>--background-edges-margin</b> <u>&lt;int&gt;</u>
              X margin to order edge to define background sampling points (int; default: 1). The  full  name  of
              this  option for the EsoRex configuration file is <b>xsh.xsh_mflat.background-edges-margin</b> [default =
              <u>1</u>].

       <b>--background-poly-deg-y</b> <u>&lt;int&gt;</u>
              Poly mode fit deg along Y. (int; default: 9).  The  full  name  of  this  option  for  the  EsoRex
              configuration file is <b>xsh.xsh_mflat.background-poly-deg-y</b> [default = <u>9</u>].

       <b>--background-poly-deg-x</b> <u>&lt;int&gt;</u>
              Poly  mode  fit  deg  along  X.  (int;  default:  9).  The full name of this option for the EsoRex
              configuration file is <b>xsh.xsh_mflat.background-poly-deg-x</b> [default = <u>9</u>].

       <b>--background-poly-kappa</b> <u>&lt;float&gt;</u>
              Poly mode kappa value of kappa-sigma-clip outliers removal. (float; default: 10.0). The full  name
              of this option for the EsoRex configuration file is <b>xsh.xsh_mflat.background-poly-kappa</b> [default =
              <u>10.0</u>].

       Note  that  it  is  possible to create a configuration file containing these options, along with suitable
       default values. Please refer to the details provided by the 'esorex --help' command.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       The full documentation for the xshoo pipeline can be downloaded as a PDF file using the following URL:

              <b><a href="ftp://ftp.eso.org/pub/dfs/pipelines/xshoo/xshoo-pipeline-manual-12.1.pdf">ftp://ftp.eso.org/pub/dfs/pipelines/xshoo/xshoo-pipeline-manual-12.1.pdf</a></b>

       An   overview   over   the   existing   ESO   pipelines    can    be    found    on    the    web    page
       <b>https://www.eso.org/sci/software/pipelines/</b>.

       Basic documentation about the EsoRex program can be found at the esorex (1) man page.

       It   is   possible   to   call   the   pipelines   from   python   using  the  python-cpl  package.   See
       <b>https://packages.python.org/python-cpl/index.html</b> for further information.

       The  other  recipes  of  the  xshoo  pipeline  are  <u><a href="../man7/xsh_2dmap.7.html">xsh_2dmap</a></u>(7),  <u><a href="../man7/xsh_cfg_recover.7.html">xsh_cfg_recover</a></u>(7),   <u><a href="../man7/xsh_flexcomp.7.html">xsh_flexcomp</a></u>(7),
       <u><a href="../man7/xsh_geom_ifu.7.html">xsh_geom_ifu</a></u>(7),    <u><a href="../man7/xsh_lingain.7.html">xsh_lingain</a></u>(7),    <u><a href="../man7/xsh_mbias.7.html">xsh_mbias</a></u>(7),   <u><a href="../man7/xsh_mdark.7.html">xsh_mdark</a></u>(7),   <u><a href="../man7/xsh_orderpos.7.html">xsh_orderpos</a></u>(7),   <u><a href="../man7/xsh_predict.7.html">xsh_predict</a></u>(7),
       <u><a href="../man7/xsh_respon_slit_nod.7.html">xsh_respon_slit_nod</a></u>(7),  <u><a href="../man7/xsh_respon_slit_offset.7.html">xsh_respon_slit_offset</a></u>(7),  <u><a href="../man7/xsh_respon_slit_stare.7.html">xsh_respon_slit_stare</a></u>(7),  <u><a href="../man7/xsh_scired_ifu_offset.7.html">xsh_scired_ifu_offset</a></u>(7),
       <u><a href="../man7/xsh_scired_ifu_offset_drl.7.html">xsh_scired_ifu_offset_drl</a></u>(7),            <u><a href="../man7/xsh_scired_ifu_stare.7.html">xsh_scired_ifu_stare</a></u>(7),            <u><a href="../man7/xsh_scired_ifu_stare_drl.7.html">xsh_scired_ifu_stare_drl</a></u>(7),
       <u><a href="../man7/xsh_scired_slit_nod.7.html">xsh_scired_slit_nod</a></u>(7),   <u><a href="../man7/xsh_scired_slit_offset.7.html">xsh_scired_slit_offset</a></u>(7),    <u><a href="../man7/xsh_scired_slit_stare.7.html">xsh_scired_slit_stare</a></u>(7),    <u><a href="../man7/xsh_util_physmod.7.html">xsh_util_physmod</a></u>(7),
       <u><a href="../man7/xsh_wavecal.7.html">xsh_wavecal</a></u>(7)

</pre><h4><b>VERSION</b></h4><pre>
       xsh_mflat 3.5.3

</pre><h4><b>AUTHOR</b></h4><pre>
       P.Goldoni, L.Guglielmi, R. Haigron, F. Royer, D. Bramich, A. Modigliani &lt;<a href="mailto:amodigli@eso.org">amodigli@eso.org</a>&gt;

</pre><h4><b>BUG</b> <b>REPORTS</b></h4><pre>
       Please  report  any  problems  to  <a href="mailto:amodigli@eso.org">amodigli@eso.org</a>. Alternatively, you may send a report to the ESO User
       Support Department &lt;<a href="mailto:usd-help@eso.org">usd-help@eso.org</a>&gt;.

</pre><h4><b>LICENSE</b></h4><pre>
       This file is part of the X-shooter Instrument Pipeline Copyright (C) 2006 European Southern Observatory

       This program is free software; you can redistribute it and/or modify  it  under  the  terms  of  the  GNU
       General  Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This program is distributed in the hope that it will be useful, but WITHOUT ANY  WARRANTY;  without  even
       the  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with this program; if not,  write
       to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

xsh_mflat                                             3.5.3                                         <u><a href="../man7/XSH_MFLAT.7.html">XSH_MFLAT</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>