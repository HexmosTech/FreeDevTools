<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>provider-asym_cipher - The asym_cipher library <-> provider functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       provider-asym_cipher - The asym_cipher library &lt;-&gt; provider functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/core_dispatch.h&gt;
        #include &lt;openssl/core_names.h&gt;

        /*
         * None of these are actual functions, but are displayed like this for
         * the function signatures for functions that are offered as function
         * pointers in OSSL_DISPATCH arrays.
         */

        /* Context management */
        void *OSSL_FUNC_asym_cipher_newctx(void *provctx);
        void OSSL_FUNC_asym_cipher_freectx(void *ctx);
        void *OSSL_FUNC_asym_cipher_dupctx(void *ctx);

        /* Encryption */
        int OSSL_FUNC_asym_cipher_encrypt_init(void *ctx, void *provkey,
                                               const OSSL_PARAM params[]);
        int OSSL_FUNC_asym_cipher_encrypt(void *ctx, unsigned char *out, size_t *outlen,
                                          size_t outsize, const unsigned char *in,
                                          size_t inlen);

        /* Decryption */
        int OSSL_FUNC_asym_cipher_decrypt_init(void *ctx, void *provkey,
                                               const OSSL_PARAM params[]);
        int OSSL_FUNC_asym_cipher_decrypt(void *ctx, unsigned char *out, size_t *outlen,
                                          size_t outsize, const unsigned char *in,
                                          size_t inlen);

        /* Asymmetric Cipher parameters */
        int OSSL_FUNC_asym_cipher_get_ctx_params(void *ctx, OSSL_PARAM params[]);
        const OSSL_PARAM *OSSL_FUNC_asym_cipher_gettable_ctx_params(void *provctx);
        int OSSL_FUNC_asym_cipher_set_ctx_params(void *ctx, const OSSL_PARAM params[]);
        const OSSL_PARAM *OSSL_FUNC_asym_cipher_settable_ctx_params(void *provctx);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This documentation is primarily aimed at provider authors. See <b><a href="../man7/provider.7.html">provider</a></b>(7) for further information.

       The asymmetric cipher (OSSL_OP_ASYM_CIPHER) operation enables providers to implement asymmetric cipher
       algorithms and make them available to applications via the API functions <b><a href="../man3/EVP_PKEY_encrypt.3.html">EVP_PKEY_encrypt</a></b>(3),
       <b><a href="../man3/EVP_PKEY_decrypt.3.html">EVP_PKEY_decrypt</a></b>(3) and other related functions).

       All "functions" mentioned here are passed as function pointers between <u>libcrypto</u> and the provider in
       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays via <b><a href="../man3/OSSL_ALGORITHM.3.html">OSSL_ALGORITHM</a></b>(3) arrays that are returned by the provider's
       <b>provider_query_operation()</b> function (see "Provider Functions" in <b><a href="../man7/provider-base.7.html">provider-base</a></b>(7)).

       All these "functions" have a corresponding function type definition named <b>OSSL_FUNC_{name}_fn</b>, and a
       helper function to retrieve the function pointer from an <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) element named <b>OSSL_FUNC_{name}</b>.
       For example, the "function" <b>OSSL_FUNC_asym_cipher_newctx()</b> has these:

        typedef void *(OSSL_FUNC_asym_cipher_newctx_fn)(void *provctx);
        static ossl_inline OSSL_FUNC_asym_cipher_newctx_fn
            OSSL_FUNC_asym_cipher_newctx(const OSSL_DISPATCH *opf);

       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays are indexed by numbers that are provided as macros in <b><a href="../man7/openssl-core_dispatch.h.7.html">openssl-core_dispatch.h</a></b>(7),
       as follows:

        OSSL_FUNC_asym_cipher_newctx               OSSL_FUNC_ASYM_CIPHER_NEWCTX
        OSSL_FUNC_asym_cipher_freectx              OSSL_FUNC_ASYM_CIPHER_FREECTX
        OSSL_FUNC_asym_cipher_dupctx               OSSL_FUNC_ASYM_CIPHER_DUPCTX

        OSSL_FUNC_asym_cipher_encrypt_init         OSSL_FUNC_ASYM_CIPHER_ENCRYPT_INIT
        OSSL_FUNC_asym_cipher_encrypt              OSSL_FUNC_ASYM_CIPHER_ENCRYPT

        OSSL_FUNC_asym_cipher_decrypt_init         OSSL_FUNC_ASYM_CIPHER_DECRYPT_INIT
        OSSL_FUNC_asym_cipher_decrypt              OSSL_FUNC_ASYM_CIPHER_DECRYPT

        OSSL_FUNC_asym_cipher_get_ctx_params       OSSL_FUNC_ASYM_CIPHER_GET_CTX_PARAMS
        OSSL_FUNC_asym_cipher_gettable_ctx_params  OSSL_FUNC_ASYM_CIPHER_GETTABLE_CTX_PARAMS
        OSSL_FUNC_asym_cipher_set_ctx_params       OSSL_FUNC_ASYM_CIPHER_SET_CTX_PARAMS
        OSSL_FUNC_asym_cipher_settable_ctx_params  OSSL_FUNC_ASYM_CIPHER_SETTABLE_CTX_PARAMS

       An asymmetric cipher algorithm implementation may not implement all of these functions.  In order to be a
       consistent set of functions a provider must implement OSSL_FUNC_asym_cipher_newctx and
       OSSL_FUNC_asym_cipher_freectx.  It must also implement both of OSSL_FUNC_asym_cipher_encrypt_init and
       OSSL_FUNC_asym_cipher_encrypt, or both of OSSL_FUNC_asym_cipher_decrypt_init and
       OSSL_FUNC_asym_cipher_decrypt.  OSSL_FUNC_asym_cipher_get_ctx_params is optional but if it is present
       then so must OSSL_FUNC_asym_cipher_gettable_ctx_params.  Similarly, OSSL_FUNC_asym_cipher_set_ctx_params
       is optional but if it is present then so must OSSL_FUNC_asym_cipher_settable_ctx_params.

       An asymmetric cipher algorithm must also implement some mechanism for generating, loading or importing
       keys via the key management (OSSL_OP_KEYMGMT) operation.  See <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7) for further details.

   <b>Context</b> <b>Management</b> <b>Functions</b>
       <b>OSSL_FUNC_asym_cipher_newctx()</b> should create and return a pointer to a provider side structure for
       holding context information during an asymmetric cipher operation.  A pointer to this context will be
       passed back in a number of the other asymmetric cipher operation function calls.  The parameter <u>provctx</u>
       is the provider context generated during provider initialisation (see <b><a href="../man7/provider.7.html">provider</a></b>(7)).

       <b>OSSL_FUNC_asym_cipher_freectx()</b> is passed a pointer to the provider side asymmetric cipher context in the
       <u>ctx</u> parameter.  This function should free any resources associated with that context.

       <b>OSSL_FUNC_asym_cipher_dupctx()</b> should duplicate the provider side asymmetric cipher context in the <u>ctx</u>
       parameter and return the duplicate copy.

   <b>Encryption</b> <b>Functions</b>
       <b>OSSL_FUNC_asym_cipher_encrypt_init()</b> initialises a context for an asymmetric encryption given a provider
       side asymmetric cipher context in the <u>ctx</u> parameter, and a pointer to a provider key object in the
       <u>provkey</u> parameter.  The <u>params</u>, if not NULL, should be set on the context in a manner similar to using
       <b>OSSL_FUNC_asym_cipher_set_ctx_params()</b>.  The key object should have been previously generated, loaded or
       imported into the provider using the key management (OSSL_OP_KEYMGMT) operation (see
       <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7)).  <b>OSSL_FUNC_asym_cipher_encrypt()</b> performs the actual encryption itself.  A
       previously initialised asymmetric cipher context is passed in the <u>ctx</u> parameter.  The data to be
       encrypted is pointed to by the <u>in</u> parameter which is <u>inlen</u> bytes long.  Unless <u>out</u> is NULL, the encrypted
       data should be written to the location pointed to by the <u>out</u> parameter and it should not exceed <u>outsize</u>
       bytes in length.  The length of the encrypted data should be written to <u>*outlen</u>.  If <u>out</u> is NULL then the
       maximum length of the encrypted data should be written to <u>*outlen</u>.

   <b>Decryption</b> <b>Functions</b>
       <b>OSSL_FUNC_asym_cipher_decrypt_init()</b> initialises a context for an asymmetric decryption given a provider
       side asymmetric cipher context in the <u>ctx</u> parameter, and a pointer to a provider key object in the
       <u>provkey</u> parameter.  The <u>params</u>, if not NULL, should be set on the context in a manner similar to using
       <b>OSSL_FUNC_asym_cipher_set_ctx_params()</b>.  The key object should have been previously generated, loaded or
       imported into the provider using the key management (OSSL_OP_KEYMGMT) operation (see
       <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7)).

       <b>OSSL_FUNC_asym_cipher_decrypt()</b> performs the actual decryption itself.  A previously initialised
       asymmetric cipher context is passed in the <u>ctx</u> parameter.  The data to be decrypted is pointed to by the
       <u>in</u> parameter which is <u>inlen</u> bytes long.  Unless <u>out</u> is NULL, the decrypted data should be written to the
       location pointed to by the <u>out</u> parameter and it should not exceed <u>outsize</u> bytes in length.  The length of
       the decrypted data should be written to <u>*outlen</u>.  If <u>out</u> is NULL then the maximum length of the decrypted
       data should be written to <u>*outlen</u>.

   <b>Asymmetric</b> <b>Cipher</b> <b>Parameters</b>
       See <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details on the parameters structure used by the
       <b>OSSL_FUNC_asym_cipher_get_ctx_params()</b> and <b>OSSL_FUNC_asym_cipher_set_ctx_params()</b> functions.

       <b>OSSL_FUNC_asym_cipher_get_ctx_params()</b> gets asymmetric cipher parameters associated with the given
       provider side asymmetric cipher context <u>ctx</u> and stores them in <u>params</u>.  Passing NULL for <u>params</u> should
       return true.

       <b>OSSL_FUNC_asym_cipher_set_ctx_params()</b> sets the asymmetric cipher parameters associated with the given
       provider side asymmetric cipher context <u>ctx</u> to <u>params</u>.  Any parameter settings are additional to any that
       were previously set.  Passing NULL for <u>params</u> should return true.

       Parameters currently recognised by built-in asymmetric cipher algorithms are as follows.  Not all
       parameters are relevant to, or are understood by all asymmetric cipher algorithms:

       "pad-mode" (<b>OSSL_ASYM_CIPHER_PARAM_PAD_MODE</b>) &lt;UTF8 string&gt; OR &lt;integer&gt;
           The type of padding to be used. The interpretation of this value will depend on the algorithm in use.

       "digest" (<b>OSSL_ASYM_CIPHER_PARAM_OAEP_DIGEST</b>) &lt;UTF8 string&gt;
           Gets or sets the name of the OAEP digest algorithm used when OAEP padding is in use.

       "digest" (<b>OSSL_ASYM_CIPHER_PARAM_DIGEST</b>) &lt;UTF8 string&gt;
           Gets or sets the name of the digest algorithm used by the algorithm (where applicable).

       "digest-props" (<b>OSSL_ASYM_CIPHER_PARAM_OAEP_DIGEST_PROPS</b>) &lt;UTF8 string&gt;
           Gets or sets the properties to use when fetching the OAEP digest algorithm.

       "digest-props" (<b>OSSL_ASYM_CIPHER_PARAM_DIGEST_PROPS</b>) &lt;UTF8 string&gt;
           Gets or sets the properties to use when fetching the cipher digest algorithm.

       "mgf1-digest" (<b>OSSL_ASYM_CIPHER_PARAM_MGF1_DIGEST</b>) &lt;UTF8 string&gt;
           Gets or sets the name of the MGF1 digest algorithm used when OAEP or PSS padding is in use.

       "mgf1-digest-props" (<b>OSSL_ASYM_CIPHER_PARAM_MGF1_DIGEST_PROPS</b>) &lt;UTF8 string&gt;
           Gets or sets the properties to use when fetching the MGF1 digest algorithm.

       "oaep-label" (<b>OSSL_ASYM_CIPHER_PARAM_OAEP_LABEL</b>) &lt;octet string ptr&gt;
           Gets the OAEP label used when OAEP padding is in use.

       "oaep-label" (<b>OSSL_ASYM_CIPHER_PARAM_OAEP_LABEL</b>) &lt;octet string&gt;
           Sets the OAEP label used when OAEP padding is in use.

       "tls-client-version" (<b>OSSL_ASYM_CIPHER_PARAM_TLS_CLIENT_VERSION</b>) &lt;unsigned integer&gt;
           The TLS protocol version first requested by the client.

       "tls-negotiated-version" (<b>OSSL_ASYM_CIPHER_PARAM_TLS_CLIENT_VERSION</b>) &lt;unsigned integer&gt;
           The negotiated TLS protocol version.

       "implicit-rejection" (<b>OSSL_ASYM_CIPHER_PARAM_IMPLICIT_REJECTION</b>) &lt;unsigned integer&gt;
           Gets  or  sets  the  use of the implicit rejection mechanism for RSA PKCS#1 v1.5 decryption. When set
           (non zero value), the decryption API will return a deterministically random value if the PKCS#1  v1.5
           padding check fails.  This makes exploitation of the Bleichenbacher significantly harder, even if the
           code  using  the RSA decryption API is not implemented in side-channel free manner. Set by default in
           OpenSSL providers.

       The OpenSSL FIPS provider also supports the following parameters:

       "fips-indicator" (<b>OSSL_ASYM_CIPHER_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           A getter that returns 1 if the operation is FIPS approved, or 0 otherwise.  This may  be  used  after
           calling either <b>OSSL_FUNC_asym_cipher_encrypt()</b> or <b>OSSL_FUNC_asym_cipher_decrypt()</b>. It may return 0 if
           "key-check" is set to 0.

       "key-check" (<b>OSSL_ASYM_CIPHER_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
           If  required  this  parameter  should  be  set  using  either <b>OSSL_FUNC_asym_cipher_encrypt_init()</b> or
           <b>OSSL_FUNC_asym_cipher_decrypt_init()</b>.  The default value of 1 causes an error during the init if  the
           key  is  not FIPS approved (e.g. The key has a security strength of less than 112 bits). Setting this
           to 0 will ignore the error and set the approved "fips-indicator"  to  0.   This  option  breaks  FIPS
           compliance if it causes the approved "fips-indicator" to return 0.

       <b>OSSL_FUNC_asym_cipher_gettable_ctx_params()</b>   and   <b>OSSL_FUNC_asym_cipher_settable_ctx_params()</b>   get   a
       constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array that describes the gettable and settable parameters,  i.e.  parameters  that
       can   be   used  with  <b>OSSL_FUNC_asym_cipherget_ctx_params()</b>  and  <b>OSSL_FUNC_asym_cipher_set_ctx_params()</b>
       respectively.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OSSL_FUNC_asym_cipher_newctx()</b>  and  <b>OSSL_FUNC_asym_cipher_dupctx()</b>  should  return  the  newly   created
       provider side asymmetric cipher context, or NULL on failure.

       All other functions should return 1 for success or 0 on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/provider.7.html">provider</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       The  provider  ASYM_CIPHER  interface  was  introduced  in OpenSSL 3.0.  The Asymmetric Cipher Parameters
       "fips-indicator" and "key-check" were added in OpenSSL 3.4.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                         <u><a href="../man7SSL/PROVIDER-ASYM_CIPHER.7SSL.html">PROVIDER-ASYM_CIPHER</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>