<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>provider-mac - The mac library <-> provider functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       provider-mac - The mac library &lt;-&gt; provider functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/core_dispatch.h&gt;
        #include &lt;openssl/core_names.h&gt;

        /*
         * None of these are actual functions, but are displayed like this for
         * the function signatures for functions that are offered as function
         * pointers in OSSL_DISPATCH arrays.
         */

        /* Context management */
        void *OSSL_FUNC_mac_newctx(void *provctx);
        void OSSL_FUNC_mac_freectx(void *mctx);
        void *OSSL_FUNC_mac_dupctx(void *src);

        /* Encryption/decryption */
        int OSSL_FUNC_mac_init(void *mctx, unsigned char *key, size_t keylen,
                               const OSSL_PARAM params[]);
        int OSSL_FUNC_mac_init_skey(void *mctx, const void *key, const OSSL_PARAM params[]);
        int OSSL_FUNC_mac_update(void *mctx, const unsigned char *in, size_t inl);
        int OSSL_FUNC_mac_final(void *mctx, unsigned char *out, size_t *outl, size_t outsize);

        /* MAC parameter descriptors */
        const OSSL_PARAM *OSSL_FUNC_mac_gettable_params(void *provctx);
        const OSSL_PARAM *OSSL_FUNC_mac_gettable_ctx_params(void *mctx, void *provctx);
        const OSSL_PARAM *OSSL_FUNC_mac_settable_ctx_params(void *mctx, void *provctx);

        /* MAC parameters */
        int OSSL_FUNC_mac_get_params(OSSL_PARAM params[]);
        int OSSL_FUNC_mac_get_ctx_params(void *mctx, OSSL_PARAM params[]);
        int OSSL_FUNC_mac_set_ctx_params(void *mctx, const OSSL_PARAM params[]);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This documentation is primarily aimed at provider authors. See <b><a href="../man7/provider.7.html">provider</a></b>(7) for further information.

       The MAC operation enables providers to implement mac algorithms and make them available to applications
       via the API functions <b><a href="../man3/EVP_MAC_init.3.html">EVP_MAC_init</a></b>(3), <b><a href="../man3/EVP_MAC_update.3.html">EVP_MAC_update</a></b>(3) and <b><a href="../man3/EVP_MAC_final.3.html">EVP_MAC_final</a></b>(3).

       All "functions" mentioned here are passed as function pointers between <u>libcrypto</u> and the provider in
       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays via <b><a href="../man3/OSSL_ALGORITHM.3.html">OSSL_ALGORITHM</a></b>(3) arrays that are returned by the provider's
       <b>provider_query_operation()</b> function (see "Provider Functions" in <b><a href="../man7/provider-base.7.html">provider-base</a></b>(7)).

       All these "functions" have a corresponding function type definition named <b>OSSL_FUNC_{name}_fn</b>, and a
       helper function to retrieve the function pointer from an <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) element named <b>OSSL_FUNC_{name}</b>.
       For example, the "function" <b>OSSL_FUNC_mac_newctx()</b> has these:

        typedef void *(OSSL_FUNC_mac_newctx_fn)(void *provctx);
        static ossl_inline OSSL_FUNC_mac_newctx_fn
            OSSL_FUNC_mac_newctx(const OSSL_DISPATCH *opf);

       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays are indexed by numbers that are provided as macros in <b><a href="../man7/openssl-core_dispatch.h.7.html">openssl-core_dispatch.h</a></b>(7),
       as follows:

        OSSL_FUNC_mac_newctx               OSSL_FUNC_MAC_NEWCTX
        OSSL_FUNC_mac_freectx              OSSL_FUNC_MAC_FREECTX
        OSSL_FUNC_mac_dupctx               OSSL_FUNC_MAC_DUPCTX

        OSSL_FUNC_mac_init                 OSSL_FUNC_MAC_INIT
        OSSL_FUNC_mac_init_skey            OSSL_FUNC_MAC_INIT_SKEY
        OSSL_FUNC_mac_update               OSSL_FUNC_MAC_UPDATE
        OSSL_FUNC_mac_final                OSSL_FUNC_MAC_FINAL

        OSSL_FUNC_mac_get_params           OSSL_FUNC_MAC_GET_PARAMS
        OSSL_FUNC_mac_get_ctx_params       OSSL_FUNC_MAC_GET_CTX_PARAMS
        OSSL_FUNC_mac_set_ctx_params       OSSL_FUNC_MAC_SET_CTX_PARAMS

        OSSL_FUNC_mac_gettable_params      OSSL_FUNC_MAC_GETTABLE_PARAMS
        OSSL_FUNC_mac_gettable_ctx_params  OSSL_FUNC_MAC_GETTABLE_CTX_PARAMS
        OSSL_FUNC_mac_settable_ctx_params  OSSL_FUNC_MAC_SETTABLE_CTX_PARAMS

       A mac algorithm implementation may not implement all of these functions.  In order to be a consistent set
       of functions, at least the following functions must be implemented: <b>OSSL_FUNC_mac_newctx()</b>,
       <b>OSSL_FUNC_mac_freectx()</b>, at least one of <b>OSSL_FUNC_mac_init()</b> or <b>OSSL_FUNC_mac_init_skey()</b>,
       <b>OSSL_FUNC_mac_update()</b>, <b>OSSL_FUNC_mac_final()</b>.  All other functions are optional.

   <b>Context</b> <b>Management</b> <b>Functions</b>
       <b>OSSL_FUNC_mac_newctx()</b> should create and return a pointer to a provider side structure for holding
       context information during a mac operation.  A pointer to this context will be passed back in a number of
       the other mac operation function calls.  The parameter <u>provctx</u> is the provider context generated during
       provider initialisation (see <b><a href="../man7/provider.7.html">provider</a></b>(7)).

       <b>OSSL_FUNC_mac_freectx()</b> is passed a pointer to the provider side mac context in the <u>mctx</u> parameter.  If
       it receives NULL as <u>mctx</u> value, it should not do anything other than return.  This function should free
       any resources associated with that context.

       <b>OSSL_FUNC_mac_dupctx()</b> should duplicate the provider side mac context in the <u>mctx</u> parameter and return
       the duplicate copy.

   <b>Encryption/Decryption</b> <b>Functions</b>
       <b>OSSL_FUNC_mac_init()</b> initialises a mac operation given a newly created provider side mac context in the
       <u>mctx</u> parameter.  The <u>params</u> are set before setting the MAC <u>key</u> of <u>keylen</u> bytes.

       <b>OSSL_FUNC_mac_init_skey()</b> is similar but uses an opaque provider-specific object to initialize the MAC
       context.

       <b>OSSL_FUNC_mac_update()</b> is called to supply data for MAC computation of a previously initialised mac
       operation.  The <u>mctx</u> parameter contains a pointer to a previously initialised provider side context.
       <b>OSSL_FUNC_mac_update()</b> may be called multiple times for a single mac operation.

       <b>OSSL_FUNC_mac_final()</b> completes the MAC computation started through previous <b>OSSL_FUNC_mac_init()</b> and
       <b>OSSL_FUNC_mac_update()</b> calls.  The <u>mctx</u> parameter contains a pointer to the provider side context.  The
       resulting MAC should be written to <u>out</u> and the amount of data written to <u>*outl</u>, which should not exceed
       <u>outsize</u> bytes.  The same expectations apply to <u>outsize</u> as documented for <b><a href="../man3/EVP_MAC_final.3.html">EVP_MAC_final</a></b>(3).

   <b>Mac</b> <b>Parameters</b>
       See <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details on the parameters structure used by these functions.

       <b>OSSL_FUNC_mac_get_params()</b> gets details of parameter values associated with the provider algorithm and
       stores them in <u>params</u>.

       <b>OSSL_FUNC_mac_set_ctx_params()</b> sets mac parameters associated with the given provider side mac context
       <u>mctx</u> to <u>params</u>.  Any parameter settings are additional to any that were previously set.  Passing NULL for
       <u>params</u> should return true.

       <b>OSSL_FUNC_mac_get_ctx_params()</b> gets details of currently set parameter values associated with the given
       provider side mac context <u>mctx</u> and stores them in <u>params</u>.  Passing NULL for <u>params</u> should return true.

       <b>OSSL_FUNC_mac_gettable_params()</b>, <b>OSSL_FUNC_mac_gettable_ctx_params()</b>, and
       <b>OSSL_FUNC_mac_settable_ctx_params()</b> all return constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) arrays as descriptors of the
       parameters that <b>OSSL_FUNC_mac_get_params()</b>, <b>OSSL_FUNC_mac_get_ctx_params()</b>, and
       <b>OSSL_FUNC_mac_set_ctx_params()</b> can handle, respectively.  <b>OSSL_FUNC_mac_gettable_ctx_params()</b> and
       <b>OSSL_FUNC_mac_settable_ctx_params()</b> will return the parameters associated with the provider side context
       <u>mctx</u> in its current state if it is not NULL.  Otherwise, they return the parameters associated with the
       provider side algorithm <u>provctx</u>.

       All MAC implementations are expected to handle the following parameters:

       with <b>OSSL_FUNC_set_ctx_params()</b>:
           "key" (<b>OSSL_MAC_PARAM_KEY</b>) &lt;octet string&gt;
               Sets  the  key  in  the  associated  MAC ctx.  This is identical to passing a <u>key</u> argument to the
               <b>OSSL_FUNC_mac_init()</b> function.

       with <b>OSSL_FUNC_get_params()</b>:
           "size" (<b>OSSL_MAC_PARAM_SIZE</b>) &lt;integer&gt;
               Can be used to get the default MAC size (which might be the  only  allowable  MAC  size  for  the
               implementation).

               Note that some implementations allow setting the size that the resulting MAC should have as well,
               see the documentation of the implementation.

           "size" (<b>OSSL_MAC_PARAM_BLOCK_SIZE</b>) &lt;integer&gt;
               Can be used to get the MAC block size (if supported by the algorithm).

       The OpenSSL FIPS provider may support the following parameters:

       "fips-indicator" (<b>OSSL_MAC_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;int&gt;
           A  getter  that  returns 1 if the operation is FIPS approved, or 0 otherwise.  This may be used after
           calling the final function. It may return 0 if either "no-short-mac" or "key-check" are set to 0.

       "no-short-mac" (<b>OSSL_MAC_PARAM_FIPS_NO_SHORT_MAC</b>) &lt;integer&gt;
           If required this parameter should be set early via an init function.  The default value of  1  causes
           an error when too short MAC output is asked for.  Setting this to 0 will ignore the error and set the
           approved  "fips-indicator" to 0.  This option breaks FIPS compliance if it causes the approved "fips-
           indicator" to return 0.

       "key-check" (<b>OSSL_MAC_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
           If required this parameter should be set before OSSL_FUNC_mac_init.  The default value of 1 causes an
           error when small key sizes are asked for.  Setting this to 0  will  ignore  the  error  and  set  the
           approved  "fips-indicator" to 0.  This option breaks FIPS compliance if it causes the approved "fips-
           indicator" to return 0.

</pre><h4><b>NOTES</b></h4><pre>
       The MAC life-cycle is  described  in  <b><a href="../man7/life_cycle-rand.7.html">life_cycle-rand</a></b>(7).   Providers  should  ensure  that  the  various
       transitions  listed  there  are  supported.   At some point the EVP layer will begin enforcing the listed
       transitions.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OSSL_FUNC_mac_newctx()</b> and <b>OSSL_FUNC_mac_dupctx()</b> should return  the  newly  created  provider  side  mac
       context, or NULL on failure.

       <b>OSSL_FUNC_mac_init()</b>,     <b>OSSL_FUNC_mac_init_skey()</b>,    <b>OSSL_FUNC_mac_update()</b>,    <b>OSSL_FUNC_mac_final()</b>,
       <b>OSSL_FUNC_mac_get_params()</b>,  <b>OSSL_FUNC_mac_get_ctx_params()</b>  and  <b>OSSL_FUNC_mac_set_ctx_params()</b>   should
       return 1 for success or 0 on error.

       <b>OSSL_FUNC_mac_gettable_params()</b>,                  <b>OSSL_FUNC_mac_gettable_ctx_params()</b>                 and
       <b>OSSL_FUNC_mac_settable_ctx_params()</b> should return a constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array,  or  NULL  if  none  is
       offered.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/provider.7.html">provider</a></b>(7),   <b><a href="../man7/EVP_MAC-BLAKE2.7.html">EVP_MAC-BLAKE2</a></b>(7),  <b><a href="../man7/EVP_MAC-CMAC.7.html">EVP_MAC-CMAC</a></b>(7),  <b><a href="../man7/EVP_MAC-GMAC.7.html">EVP_MAC-GMAC</a></b>(7),  <b><a href="../man7/EVP_MAC-HMAC.7.html">EVP_MAC-HMAC</a></b>(7),  <b><a href="../man7/EVP_MAC-KMAC.7.html">EVP_MAC-KMAC</a></b>(7),
       <b><a href="../man7/EVP_MAC-Poly1305.7.html">EVP_MAC-Poly1305</a></b>(7), <b><a href="../man7/EVP_MAC-Siphash.7.html">EVP_MAC-Siphash</a></b>(7), <b><a href="../man7/life_cycle-mac.7.html">life_cycle-mac</a></b>(7), <b><a href="../man3/EVP_MAC.3.html">EVP_MAC</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The provider MAC interface was introduced in OpenSSL  3.0.   The  parameters  "no-short-mac"  and  "fips-
       indicator" were added in OpenSSL 3.4.

       The function <b>OSSL_FUNC_mac_init_skey()</b> was introduced in OpenSSL 3.5.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                 <u><a href="../man7SSL/PROVIDER-MAC.7SSL.html">PROVIDER-MAC</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>