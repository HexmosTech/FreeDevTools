<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>provider-keyexch - The keyexch library <-> provider functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       provider-keyexch - The keyexch library &lt;-&gt; provider functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/core_dispatch.h&gt;
        #include &lt;openssl/core_names.h&gt;

        /*
         * None of these are actual functions, but are displayed like this for
         * the function signatures for functions that are offered as function
         * pointers in OSSL_DISPATCH arrays.
         */

        /* Context management */
        void *OSSL_FUNC_keyexch_newctx(void *provctx);
        void OSSL_FUNC_keyexch_freectx(void *ctx);
        void *OSSL_FUNC_keyexch_dupctx(void *ctx);

        /* Shared secret derivation */
        int OSSL_FUNC_keyexch_init(void *ctx, void *provkey,
                                   const OSSL_PARAM params[]);
        int OSSL_FUNC_keyexch_set_peer(void *ctx, void *provkey);
        int OSSL_FUNC_keyexch_derive(void *ctx, unsigned char *secret, size_t *secretlen,
                                     size_t outlen);

        /* Key Exchange parameters */
        int OSSL_FUNC_keyexch_set_ctx_params(void *ctx, const OSSL_PARAM params[]);
        const OSSL_PARAM *OSSL_FUNC_keyexch_settable_ctx_params(void *ctx,
                                                                void *provctx);
        int OSSL_FUNC_keyexch_get_ctx_params(void *ctx, OSSL_PARAM params[]);
        const OSSL_PARAM *OSSL_FUNC_keyexch_gettable_ctx_params(void *ctx,
                                                                void *provctx);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This documentation is primarily aimed at provider authors. See <b><a href="../man7/provider.7.html">provider</a></b>(7) for further information.

       The key exchange (OSSL_OP_KEYEXCH) operation enables providers to implement key exchange algorithms and
       make them available to applications via <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3) and other related functions).

       All "functions" mentioned here are passed as function pointers between <u>libcrypto</u> and the provider in
       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays via <b><a href="../man3/OSSL_ALGORITHM.3.html">OSSL_ALGORITHM</a></b>(3) arrays that are returned by the provider's
       <b>provider_query_operation()</b> function (see "Provider Functions" in <b><a href="../man7/provider-base.7.html">provider-base</a></b>(7)).

       All these "functions" have a corresponding function type definition named <b>OSSL_FUNC_{name}_fn</b>, and a
       helper function to retrieve the function pointer from an <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) element named <b>OSSL_FUNC_{name}</b>.
       For example, the "function" <b>OSSL_FUNC_keyexch_newctx()</b> has these:

        typedef void *(OSSL_FUNC_keyexch_newctx_fn)(void *provctx);
        static ossl_inline OSSL_FUNC_keyexch_newctx_fn
            OSSL_FUNC_keyexch_newctx(const OSSL_DISPATCH *opf);

       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays are indexed by numbers that are provided as macros in <b><a href="../man7/openssl-core_dispatch.h.7.html">openssl-core_dispatch.h</a></b>(7),
       as follows:

        OSSL_FUNC_keyexch_newctx                OSSL_FUNC_KEYEXCH_NEWCTX
        OSSL_FUNC_keyexch_freectx               OSSL_FUNC_KEYEXCH_FREECTX
        OSSL_FUNC_keyexch_dupctx                OSSL_FUNC_KEYEXCH_DUPCTX

        OSSL_FUNC_keyexch_init                  OSSL_FUNC_KEYEXCH_INIT
        OSSL_FUNC_keyexch_set_peer              OSSL_FUNC_KEYEXCH_SET_PEER
        OSSL_FUNC_keyexch_derive                OSSL_FUNC_KEYEXCH_DERIVE

        OSSL_FUNC_keyexch_set_ctx_params        OSSL_FUNC_KEYEXCH_SET_CTX_PARAMS
        OSSL_FUNC_keyexch_settable_ctx_params   OSSL_FUNC_KEYEXCH_SETTABLE_CTX_PARAMS
        OSSL_FUNC_keyexch_get_ctx_params        OSSL_FUNC_KEYEXCH_GET_CTX_PARAMS
        OSSL_FUNC_keyexch_gettable_ctx_params   OSSL_FUNC_KEYEXCH_GETTABLE_CTX_PARAMS

       A key exchange algorithm implementation may not implement all of these functions.  In order to be a
       consistent set of functions a provider must implement OSSL_FUNC_keyexch_newctx,
       OSSL_FUNC_keyexch_freectx, OSSL_FUNC_keyexch_init and OSSL_FUNC_keyexch_derive.  All other functions are
       optional.

       A key exchange algorithm must also implement some mechanism for generating, loading or importing keys via
       the key management (OSSL_OP_KEYMGMT) operation.  See <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7) for further details.

   <b>Context</b> <b>Management</b> <b>Functions</b>
       <b>OSSL_FUNC_keyexch_newctx()</b> should create and return a pointer to a provider side structure for holding
       context information during a key exchange operation.  A pointer to this context will be passed back in a
       number of the other key exchange operation function calls.  The parameter <u>provctx</u> is the provider context
       generated during provider initialisation (see <b><a href="../man7/provider.7.html">provider</a></b>(7)).

       <b>OSSL_FUNC_keyexch_freectx()</b> is passed a pointer to the provider side key exchange context in the <u>ctx</u>
       parameter.  This function should free any resources associated with that context.

       <b>OSSL_FUNC_keyexch_dupctx()</b> should duplicate the provider side key exchange context in the <u>ctx</u> parameter
       and return the duplicate copy.

   <b>Shared</b> <b>Secret</b> <b>Derivation</b> <b>Functions</b>
       <b>OSSL_FUNC_keyexch_init()</b> initialises a key exchange operation given a provider side key exchange context
       in the <u>ctx</u> parameter, and a pointer to a provider key object in the <u>provkey</u> parameter.  The <u>params</u>, if
       not NULL, should be set on the context in a manner similar to using <b>OSSL_FUNC_keyexch_set_params()</b>.  The
       key object should have been previously generated, loaded or imported into the provider using the key
       management (OSSL_OP_KEYMGMT) operation (see <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7)&gt;.

       <b>OSSL_FUNC_keyexch_set_peer()</b> is called to supply the peer's public key (in the <u>provkey</u> parameter) to be
       used when deriving the shared secret.  It is also passed a previously initialised key exchange context in
       the <u>ctx</u> parameter.  The key object should have been previously generated, loaded or imported into the
       provider using the key management (OSSL_OP_KEYMGMT) operation (see <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7)&gt;.

       <b>OSSL_FUNC_keyexch_derive()</b> performs the actual key exchange itself by deriving a shared secret.  A
       previously initialised key exchange context is passed in the <u>ctx</u> parameter.  The derived secret should be
       written to the location <u>secret</u> which should not exceed <u>outlen</u> bytes.  The length of the shared secret
       should be written to <u>*secretlen</u>.  If <u>secret</u> is NULL then the maximum length of the shared secret should
       be written to <u>*secretlen</u>.

   <b>Key</b> <b>Exchange</b> <b>Parameters</b> <b>Functions</b>
       <b>OSSL_FUNC_keyexch_set_ctx_params()</b> sets key exchange parameters associated with the given provider side
       key exchange context <u>ctx</u> to <u>params</u>, see "Common Key Exchange parameters".  Any parameter settings are
       additional to any that were previously set.  Passing NULL for <u>params</u> should return true.

       <b>OSSL_FUNC_keyexch_get_ctx_params()</b> gets key exchange parameters associated with the given provider side
       key exchange context <u>ctx</u> into <u>params</u>, see "Common Key Exchange parameters".  Passing NULL for <u>params</u>
       should return true.

       <b>OSSL_FUNC_keyexch_settable_ctx_params()</b> yields a constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array that describes the settable
       parameters, i.e. parameters that can be used with <b>OP_signature_set_ctx_params()</b>.  If
       <b>OSSL_FUNC_keyexch_settable_ctx_params()</b> is present, <b>OSSL_FUNC_keyexch_set_ctx_params()</b> must also be
       present, and vice versa.  Similarly, <b>OSSL_FUNC_keyexch_gettable_ctx_params()</b> yields a constant
       <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array that describes the gettable parameters, i.e. parameters that can be handled by
       <b>OP_signature_get_ctx_params()</b>.  If <b>OSSL_FUNC_keyexch_gettable_ctx_params()</b> is present,
       <b>OSSL_FUNC_keyexch_get_ctx_params()</b> must also be present, and vice versa.

       Notice that not all settable parameters are also gettable, and vice versa.

   <b>Common</b> <b>Key</b> <b>Exchange</b> <b>parameters</b>
       See <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details on the parameters structure used by the
       <b>OSSL_FUNC_keyexch_set_ctx_params()</b> and <b>OSSL_FUNC_keyexch_get_ctx_params()</b> functions.

       Common parameters currently recognised by built-in key exchange algorithms are as follows.

       "kdf-type" (<b>OSSL_EXCHANGE_PARAM_KDF_TYPE</b>) &lt;UTF8 string&gt;
           Sets or gets the Key Derivation Function type to apply within the associated key exchange ctx.

       "kdf-digest" (<b>OSSL_EXCHANGE_PARAM_KDF_DIGEST</b>) &lt;UTF8 string&gt;
           Sets  or  gets the Digest algorithm to be used as part of the Key Derivation Function associated with
           the given key exchange ctx.

       "kdf-digest-props" (<b>OSSL_EXCHANGE_PARAM_KDF_DIGEST_PROPS</b>) &lt;UTF8 string&gt;
           Sets properties to be used upon look up of the implementation for the selected Digest  algorithm  for
           the Key Derivation Function associated with the given key exchange ctx.

       "kdf-outlen" (<b>OSSL_EXCHANGE_PARAM_KDF_OUTLEN</b>) &lt;unsigned integer&gt;
           Sets  or  gets  the desired size for the output of the chosen Key Derivation Function associated with
           the given key exchange ctx.  The length of the "kdf-outlen" parameter should not  exceed  that  of  a
           <b>size_t</b>.

       "kdf-ukm" (<b>OSSL_EXCHANGE_PARAM_KDF_UKM</b>) &lt;octet string&gt;
           Sets the User Key Material to be used as part of the selected Key Derivation Function associated with
           the given key exchange ctx.

       "kdf-ukm" (<b>OSSL_EXCHANGE_PARAM_KDF_UKM</b>) &lt;octet string ptr&gt;
           Gets  a  pointer  to the User Key Material to be used as part of the selected Key Derivation Function
           associated with the given key exchange ctx. Providers usually do not need to  support  this  gettable
           parameter    as    its    sole    purpose   is   to   support   functionality   of   the   deprecated
           <b>EVP_PKEY_CTX_get0_ecdh_kdf_ukm()</b> and <b>EVP_PKEY_CTX_get0_dh_kdf_ukm()</b> functions.

       The OpenSSL FIPS provider also supports the following parameters:

       "fips-indicator" (<b>OSSL_EXCHANGE_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           A getter that returns 1 if the operation is FIPS approved, or 0 otherwise.  This may  be  used  after
           calling  <b>OSSL_FUNC_keyexch_derive()</b>.  It may return 0 if either the "digest-check" or the "key-check"
           are set to 0.

       "key-check" (<b>OSSL_EXCHANGE_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
           If required this parameter should be set using <b>OSSL_FUNC_keyexch_init()</b>.   The  default  value  of  1
           causes an error during the init if the key is not FIPS approved (e.g. The key has a security strength
           of less than 112 bits). Setting this to 0 will ignore the error and set the approved "fips-indicator"
           to 0.  This option breaks FIPS compliance if it causes the approved "fips-indicator" to return 0.

       "digest-check" (<b>OSSL_EXCHANGE_PARAM_FIPS_DIGEST_CHECK</b>) &lt;integer&gt;
           If  required  this parameter should be set before any optional digest is set.  The default value of 1
           causes an error when the digest is set if the digest is not FIPS approved. Setting  this  to  0  will
           ignore  the  error and set the approved "fips-indicator" to 0.  This option breaks FIPS compliance if
           it causes the approved "fips-indicator" to return 0.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OSSL_FUNC_keyexch_newctx()</b> and <b>OSSL_FUNC_keyexch_dupctx()</b> should return the newly created  provider  side
       key exchange context, or NULL on failure.

       <b>OSSL_FUNC_keyexch_init()</b>,            <b>OSSL_FUNC_keyexch_set_peer()</b>,            <b>OSSL_FUNC_keyexch_derive()</b>,
       <b>OSSL_FUNC_keyexch_set_params()</b>, and <b>OSSL_FUNC_keyexch_get_params()</b> should return 1 for success  or  0  on
       error.

       <b>OSSL_FUNC_keyexch_settable_ctx_params()</b>  and <b>OSSL_FUNC_keyexch_gettable_ctx_params()</b> should always return
       a constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/provider.7.html">provider</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       The provider KEYEXCH interface was introduced in OpenSSL 3.0.

       The Key Exchange Parameters "fips-indicator", "key-check" and "digest-check" were added in OpenSSL 3.4.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                             <u><a href="../man7SSL/PROVIDER-KEYEXCH.7SSL.html">PROVIDER-KEYEXCH</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>