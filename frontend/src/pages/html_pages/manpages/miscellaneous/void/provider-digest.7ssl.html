<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>provider-digest - The digest library <-> provider functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       provider-digest - The digest library &lt;-&gt; provider functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/core_dispatch.h&gt;
        #include &lt;openssl/core_names.h&gt;

        /*
         * Digests support the following function signatures in OSSL_DISPATCH arrays.
         * (The function signatures are not actual functions).
         */

        /* Context management */
        void *OSSL_FUNC_digest_newctx(void *provctx);
        void OSSL_FUNC_digest_freectx(void *dctx);
        void *OSSL_FUNC_digest_dupctx(void *dctx);
        void OSSL_FUNC_digest_copyctx(void *voutctx, void *vinctx);

        /* Digest generation */
        int OSSL_FUNC_digest_init(void *dctx, const OSSL_PARAM params[]);
        int OSSL_FUNC_digest_update(void *dctx, const unsigned char *in, size_t inl);
        int OSSL_FUNC_digest_final(void *dctx, unsigned char *out, size_t *outl,
                                   size_t outsz);
        int OSSL_FUNC_digest_digest(void *provctx, const unsigned char *in, size_t inl,
                                    unsigned char *out, size_t *outl, size_t outsz);

        /* Digest parameter descriptors */
        const OSSL_PARAM *OSSL_FUNC_digest_gettable_params(void *provctx);

        /* Digest operation parameter descriptors */
        const OSSL_PARAM *OSSL_FUNC_digest_gettable_ctx_params(void *dctx,
                                                               void *provctx);
        const OSSL_PARAM *OSSL_FUNC_digest_settable_ctx_params(void *dctx,
                                                               void *provctx);

        /* Digest parameters */
        int OSSL_FUNC_digest_get_params(OSSL_PARAM params[]);

        /* Digest operation parameters */
        int OSSL_FUNC_digest_set_ctx_params(void *dctx, const OSSL_PARAM params[]);
        int OSSL_FUNC_digest_get_ctx_params(void *dctx, OSSL_PARAM params[]);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This documentation is primarily aimed at provider authors. See <b><a href="../man7/provider.7.html">provider</a></b>(7) for further information.

       The DIGEST operation enables providers to implement digest algorithms and make them available to
       applications via the API functions <b><a href="../man3/EVP_DigestInit_ex.3.html">EVP_DigestInit_ex</a></b>(3), <b><a href="../man3/EVP_DigestUpdate.3.html">EVP_DigestUpdate</a></b>(3) and <b><a href="../man3/EVP_DigestFinal.3.html">EVP_DigestFinal</a></b>(3) (and
       other related functions).

       All "functions" mentioned here are passed as function pointers between <u>libcrypto</u> and the provider in
       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays via <b><a href="../man3/OSSL_ALGORITHM.3.html">OSSL_ALGORITHM</a></b>(3) arrays that are returned by the provider's
       <b>provider_query_operation()</b> function (see "Provider Functions" in <b><a href="../man7/provider-base.7.html">provider-base</a></b>(7)).

       All these "functions" have a corresponding function type definition named <b>OSSL_FUNC_{name}_fn</b>, and a
       helper function to retrieve the function pointer from an <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) element named <b>OSSL_FUNC_{name}</b>.
       For example, the "function" <b>OSSL_FUNC_digest_newctx()</b> has these:

        typedef void *(OSSL_FUNC_digest_newctx_fn)(void *provctx);
        static ossl_inline OSSL_FUNC_digest_newctx_fn
            OSSL_FUNC_digest_newctx(const OSSL_DISPATCH *opf);

       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays are indexed by numbers that are provided as macros in <b><a href="../man7/openssl-core_dispatch.h.7.html">openssl-core_dispatch.h</a></b>(7),
       as follows:

        OSSL_FUNC_digest_newctx               OSSL_FUNC_DIGEST_NEWCTX
        OSSL_FUNC_digest_freectx              OSSL_FUNC_DIGEST_FREECTX
        OSSL_FUNC_digest_dupctx               OSSL_FUNC_DIGEST_DUPCTX
        OSSL_FUNC_digest_copyctx              OSSL_FUNC_DIGEST_COPYCTX

        OSSL_FUNC_digest_init                 OSSL_FUNC_DIGEST_INIT
        OSSL_FUNC_digest_update               OSSL_FUNC_DIGEST_UPDATE
        OSSL_FUNC_digest_final                OSSL_FUNC_DIGEST_FINAL
        OSSL_FUNC_digest_digest               OSSL_FUNC_DIGEST_DIGEST

        OSSL_FUNC_digest_get_params           OSSL_FUNC_DIGEST_GET_PARAMS
        OSSL_FUNC_digest_get_ctx_params       OSSL_FUNC_DIGEST_GET_CTX_PARAMS
        OSSL_FUNC_digest_set_ctx_params       OSSL_FUNC_DIGEST_SET_CTX_PARAMS

        OSSL_FUNC_digest_gettable_params      OSSL_FUNC_DIGEST_GETTABLE_PARAMS
        OSSL_FUNC_digest_gettable_ctx_params  OSSL_FUNC_DIGEST_GETTABLE_CTX_PARAMS
        OSSL_FUNC_digest_settable_ctx_params  OSSL_FUNC_DIGEST_SETTABLE_CTX_PARAMS

       A digest algorithm implementation may not implement all of these functions.  In order to be usable all or
       none of OSSL_FUNC_digest_newctx, OSSL_FUNC_digest_freectx, OSSL_FUNC_digest_init,
       OSSL_FUNC_digest_update, OSSL_FUNC_digest_final and OSSL_FUNC_digest_get_params should be implemented.
       All other functions are optional.

   <b>Context</b> <b>Management</b> <b>Functions</b>
       <b>OSSL_FUNC_digest_newctx()</b> should create and return a pointer to a provider side structure for holding
       context information during a digest operation.  A pointer to this context will be passed back in a number
       of the other digest operation function calls.  The parameter <u>provctx</u> is the provider context generated
       during provider initialisation (see <b><a href="../man7/provider.7.html">provider</a></b>(7)).

       <b>OSSL_FUNC_digest_freectx()</b> is passed a pointer to the provider side digest context in the <u>dctx</u> parameter.
       This function should free any resources associated with that context.

       <b>OSSL_FUNC_digest_dupctx()</b> should duplicate the provider side digest context in the <u>dctx</u> parameter and
       return the duplicate copy.

       <b>OSSL_FUNC_digest_copyctx()</b> should copy the provider side digest context in the <u>vinctx</u> parameter to the
       <u>voutctx</u> parameter which is the another provider side context.  The OSSL_FUNC_digest_copyctx function is
       used in the EVP_MD_CTX_copy_ex function to speed up HMAC operations in the PBKDF2.  This function is
       optional, and dupctx will be used if there is no EVP_MD_CTX_copy_ex function.

   <b>Digest</b> <b>Generation</b> <b>Functions</b>
       <b>OSSL_FUNC_digest_init()</b> initialises a digest operation given a newly created provider side digest context
       in the <u>dctx</u> parameter.  The <u>params</u>, if not NULL, should be set on the context in a manner similar to
       using <b>OSSL_FUNC_digest_set_ctx_params()</b>.

       <b>OSSL_FUNC_digest_update()</b> is called to supply data to be digested as part of a previously initialised
       digest operation.  The <u>dctx</u> parameter contains a pointer to a previously initialised provider side
       context.  <b>OSSL_FUNC_digest_update()</b> should digest <u>inl</u> bytes of data at the location pointed to by <u>in</u>.
       <b>OSSL_FUNC_digest_update()</b> may be called multiple times for a single digest operation.

       <b>OSSL_FUNC_digest_final()</b> generates a digest started through previous <b>OSSL_FUNC_digest_init()</b> and
       <b>OSSL_FUNC_digest_update()</b> calls.  The <u>dctx</u> parameter contains a pointer to the provider side context.
       The digest should be written to <u>*out</u> and the length of the digest to <u>*outl</u>.  The digest should not exceed
       <u>outsz</u> bytes.

       <b>OSSL_FUNC_digest_digest()</b> is a "oneshot" digest function.  No provider side digest context is used.
       Instead the provider context that was created during provider initialisation is passed in the <u>provctx</u>
       parameter (see <b><a href="../man7/provider.7.html">provider</a></b>(7)).  <u>inl</u> bytes at <u>in</u> should be digested and the result should be stored at <u>out</u>.
       The length of the digest should be stored in <u>*outl</u> which should not exceed <u>outsz</u> bytes.

   <b>Digest</b> <b>Parameters</b>
       See <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details on the parameters structure used by these functions.

       <b>OSSL_FUNC_digest_get_params()</b> gets details of the algorithm implementation and stores them in <u>params</u>.

       <b>OSSL_FUNC_digest_set_ctx_params()</b> sets digest operation parameters for the provider side digest context
       <u>dctx</u> to <u>params</u>.  Any parameter settings are additional to any that were previously set.  Passing NULL for
       <u>params</u> should return true.

       <b>OSSL_FUNC_digest_get_ctx_params()</b> gets digest operation details details from the given provider side
       digest context <u>dctx</u> and stores them in <u>params</u>.  Passing NULL for <u>params</u> should return true.

       <b>OSSL_FUNC_digest_gettable_params()</b> returns a constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array containing descriptors of the
       parameters that <b>OSSL_FUNC_digest_get_params()</b> can handle.

       <b>OSSL_FUNC_digest_gettable_ctx_params()</b> and <b>OSSL_FUNC_digest_settable_ctx_params()</b> both return constant
       <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) arrays as descriptors of the parameters that <b>OSSL_FUNC_digest_get_ctx_params()</b> and
       <b>OSSL_FUNC_digest_set_ctx_params()</b> can handle, respectively.  The array is based on the current state of
       the provider side context if <u>dctx</u> is not NULL and on the provider side algorithm <u>provctx</u> otherwise.

       Parameters currently recognised by built-in digests with this function are as follows. Not all parameters
       are relevant to, or are understood by all digests:

       "blocksize" (<b>OSSL_DIGEST_PARAM_BLOCK_SIZE</b>) &lt;unsigned integer&gt;
           The digest block size.  The length of the "blocksize" parameter should not exceed that of a <b>size_t</b>.

       "size" (<b>OSSL_DIGEST_PARAM_SIZE</b>) &lt;unsigned integer&gt;
           The digest output size.  The length of the "size" parameter should not exceed that of a <b>size_t</b>.

       "flags" (<b>OSSL_DIGEST_PARAM_FLAGS</b>) &lt;unsigned integer&gt;
           Diverse flags that describe exceptional behaviour for the digest:

           <b>EVP_MD_FLAG_ONESHOT</b>
               This digest method can only handle one block of input.

           <b>EVP_MD_FLAG_XOF</b>
               This digest method is an extensible-output function (XOF).

           <b>EVP_MD_FLAG_DIGALGID_NULL</b>
               When  setting  up  a  DigestAlgorithmIdentifier, this flag will have the parameter set to NULL by
               default.  Use this for PKCS#1.  <u>Note:</u> <u>if</u> <u>combined</u> <u>with</u>  <u>EVP_MD_FLAG_DIGALGID_ABSENT,</u>  <u>the</u>  <u>latter</u>
               <u>will</u> <u>override.</u>

           <b>EVP_MD_FLAG_DIGALGID_ABSENT</b>
               When  setting up a DigestAlgorithmIdentifier, this flag will have the parameter be left absent by
               default.  <u>Note:</u> <u>if</u> <u>combined</u> <u>with</u> <u>EVP_MD_FLAG_DIGALGID_NULL,</u> <u>the</u> <u>latter</u> <u>will</u> <u>be</u> <u>overridden.</u>

           <b>EVP_MD_FLAG_DIGALGID_CUSTOM</b>
               Custom DigestAlgorithmIdentifier handling via ctrl, with <b>EVP_MD_FLAG_DIGALGID_ABSENT</b> as  default.
               <u>Note:</u>  <u>if</u>  <u>combined</u>  <u>with</u>  <u>EVP_MD_FLAG_DIGALGID_NULL,</u>  <u>the</u>  <u>latter</u> <u>will</u> <u>be</u> <u>overridden.</u>  Currently
               unused.

           The length of the "flags" parameter should equal that of an <b>unsigned</b> <b>long</b> <b>int</b>.

   <b>Digest</b> <b>Context</b> <b>Parameters</b>
       <b>OSSL_FUNC_digest_set_ctx_params()</b> sets digest parameters associated with the given provider  side  digest
       context  <u>dctx</u>  to  <u>params</u>.   Any  parameter settings are additional to any that were previously set.  See
       <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details on the parameters structure.

       <b>OSSL_FUNC_digest_get_ctx_params()</b> gets details of currently set parameters  values  associated  with  the
       give  provider side digest context <u>dctx</u> and stores them in <u>params</u>.  See <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details
       on the parameters structure.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OSSL_FUNC_digest_newctx()</b> and <b>OSSL_FUNC_digest_dupctx()</b> should return the  newly  created  provider  side
       digest context, or NULL on failure.

       <b>OSSL_FUNC_digest_init()</b>,  <b>OSSL_FUNC_digest_update()</b>, <b>OSSL_FUNC_digest_final()</b>, <b>OSSL_FUNC_digest_digest()</b>,
       <b>OSSL_FUNC_digest_set_params()</b> and <b>OSSL_FUNC_digest_get_params()</b> should return  1  for  success  or  0  on
       error.

       <b>OSSL_FUNC_digest_size()</b> should return the digest size.

       <b>OSSL_FUNC_digest_block_size()</b> should return the block size of the underlying digest algorithm.

</pre><h4><b>BUGS</b></h4><pre>
       The  <b>EVP_Q_digest()</b>,  <b>EVP_Digest()</b> and <b>EVP_DigestFinal_ex()</b> API calls do not expect the digest size to be
       larger than EVP_MAX_MD_SIZE. Any algorithm which produces larger  digests  is  unusable  with  those  API
       calls.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/provider.7.html">provider</a></b>(7),  <b><a href="../man7/OSSL_PROVIDER-FIPS.7.html">OSSL_PROVIDER-FIPS</a></b>(7), <b><a href="../man7/OSSL_PROVIDER-default.7.html">OSSL_PROVIDER-default</a></b>(7), <b><a href="../man7/OSSL_PROVIDER-legacy.7.html">OSSL_PROVIDER-legacy</a></b>(7), <b><a href="../man7/EVP_MD-common.7.html">EVP_MD-common</a></b>(7),
       <b><a href="../man7/EVP_MD-BLAKE2.7.html">EVP_MD-BLAKE2</a></b>(7),  <b><a href="../man7/EVP_MD-MD2.7.html">EVP_MD-MD2</a></b>(7),  <b><a href="../man7/EVP_MD-MD4.7.html">EVP_MD-MD4</a></b>(7),  <b><a href="../man7/EVP_MD-MD5.7.html">EVP_MD-MD5</a></b>(7),   <b><a href="../man7/EVP_MD-MD5-SHA1.7.html">EVP_MD-MD5-SHA1</a></b>(7),   <b><a href="../man7/EVP_MD-MDC2.7.html">EVP_MD-MDC2</a></b>(7),
       <b><a href="../man7/EVP_MD-RIPEMD160.7.html">EVP_MD-RIPEMD160</a></b>(7),  <b><a href="../man7/EVP_MD-SHA1.7.html">EVP_MD-SHA1</a></b>(7),  <b><a href="../man7/EVP_MD-SHA2.7.html">EVP_MD-SHA2</a></b>(7),  <b><a href="../man7/EVP_MD-SHA3.7.html">EVP_MD-SHA3</a></b>(7), <b><a href="../man7/EVP_MD-KECCAK.7.html">EVP_MD-KECCAK</a></b>(7) <b><a href="../man7/EVP_MD-SHAKE.7.html">EVP_MD-SHAKE</a></b>(7),
       <b><a href="../man7/EVP_MD-SM3.7.html">EVP_MD-SM3</a></b>(7), <b><a href="../man7/EVP_MD-WHIRLPOOL.7.html">EVP_MD-WHIRLPOOL</a></b>(7), <b><a href="../man7/EVP_MD-NULL.7.html">EVP_MD-NULL</a></b>(7), <b><a href="../man7/life_cycle-digest.7.html">life_cycle-digest</a></b>(7), <b><a href="../man3/EVP_DigestInit.3.html">EVP_DigestInit</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The provider DIGEST interface was introduced in OpenSSL 3.0.  <b>OSSL_FUNC_digest_copyctx()</b> was added in 3.5
       version.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                              <u><a href="../man7SSL/PROVIDER-DIGEST.7SSL.html">PROVIDER-DIGEST</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>