<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>provider-kdf - The KDF library <-> provider functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       provider-kdf - The KDF library &lt;-&gt; provider functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/core_dispatch.h&gt;
        #include &lt;openssl/core_names.h&gt;

        /*
         * None of these are actual functions, but are displayed like this for
         * the function signatures for functions that are offered as function
         * pointers in OSSL_DISPATCH arrays.
         */

        /* Context management */
        void *OSSL_FUNC_kdf_newctx(void *provctx);
        void OSSL_FUNC_kdf_freectx(void *kctx);
        void *OSSL_FUNC_kdf_dupctx(void *src);

        /* Encryption/decryption */
        int OSSL_FUNC_kdf_reset(void *kctx);
        int OSSL_FUNC_kdf_derive(void *kctx, unsigned char *key, size_t keylen,
                                 const OSSL_PARAM params[]);

        /* KDF parameter descriptors */
        const OSSL_PARAM *OSSL_FUNC_kdf_gettable_params(void *provctx);
        const OSSL_PARAM *OSSL_FUNC_kdf_gettable_ctx_params(void *kcxt, void *provctx);
        const OSSL_PARAM *OSSL_FUNC_kdf_settable_ctx_params(void *kcxt, void *provctx);

        /* KDF parameters */
        int OSSL_FUNC_kdf_get_params(OSSL_PARAM params[]);
        int OSSL_FUNC_kdf_get_ctx_params(void *kctx, OSSL_PARAM params[]);
        int OSSL_FUNC_kdf_set_ctx_params(void *kctx, const OSSL_PARAM params[]);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This documentation is primarily aimed at provider authors. See <b><a href="../man7/provider.7.html">provider</a></b>(7) for further information.

       The KDF operation enables providers to implement KDF algorithms and make them available to applications
       via the API functions <b><a href="../man3/EVP_KDF_CTX_reset.3.html">EVP_KDF_CTX_reset</a></b>(3), and <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3).

       All "functions" mentioned here are passed as function pointers between <u>libcrypto</u> and the provider in
       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays via <b><a href="../man3/OSSL_ALGORITHM.3.html">OSSL_ALGORITHM</a></b>(3) arrays that are returned by the provider's
       <b>provider_query_operation()</b> function (see "Provider Functions" in <b><a href="../man7/provider-base.7.html">provider-base</a></b>(7)).

       All these "functions" have a corresponding function type definition named <b>OSSL_FUNC_{name}_fn</b>, and a
       helper function to retrieve the function pointer from an <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) element named <b>OSSL_FUNC_{name}</b>.
       For example, the "function" <b>OSSL_FUNC_kdf_newctx()</b> has these:

        typedef void *(OSSL_FUNC_kdf_newctx_fn)(void *provctx);
        static ossl_inline OSSL_FUNC_kdf_newctx_fn
            OSSL_FUNC_kdf_newctx(const OSSL_DISPATCH *opf);

       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) array entries are identified by numbers that are provided as macros in
       <b><a href="../man7/openssl-core_dispatch.h.7.html">openssl-core_dispatch.h</a></b>(7), as follows:

        OSSL_FUNC_kdf_newctx               OSSL_FUNC_KDF_NEWCTX
        OSSL_FUNC_kdf_freectx              OSSL_FUNC_KDF_FREECTX
        OSSL_FUNC_kdf_dupctx               OSSL_FUNC_KDF_DUPCTX

        OSSL_FUNC_kdf_reset                OSSL_FUNC_KDF_RESET
        OSSL_FUNC_kdf_derive               OSSL_FUNC_KDF_DERIVE

        OSSL_FUNC_kdf_get_params           OSSL_FUNC_KDF_GET_PARAMS
        OSSL_FUNC_kdf_get_ctx_params       OSSL_FUNC_KDF_GET_CTX_PARAMS
        OSSL_FUNC_kdf_set_ctx_params       OSSL_FUNC_KDF_SET_CTX_PARAMS

        OSSL_FUNC_kdf_gettable_params      OSSL_FUNC_KDF_GETTABLE_PARAMS
        OSSL_FUNC_kdf_gettable_ctx_params  OSSL_FUNC_KDF_GETTABLE_CTX_PARAMS
        OSSL_FUNC_kdf_settable_ctx_params  OSSL_FUNC_KDF_SETTABLE_CTX_PARAMS

       A KDF algorithm implementation may not implement all of these functions.  In order to be a consistent set
       of functions, at least the following functions must be implemented: <b>OSSL_FUNC_kdf_newctx()</b>,
       <b>OSSL_FUNC_kdf_freectx()</b>, <b>OSSL_FUNC_kdf_set_ctx_params()</b>, <b>OSSL_FUNC_kdf_derive()</b>.  All other functions are
       optional.

   <b>Context</b> <b>Management</b> <b>Functions</b>
       <b>OSSL_FUNC_kdf_newctx()</b> should create and return a pointer to a provider side structure for holding
       context information during a KDF operation.  A pointer to this context will be passed back in a number of
       the other KDF operation function calls.  The parameter <u>provctx</u> is the provider context generated during
       provider initialisation (see <b><a href="../man7/provider.7.html">provider</a></b>(7)).

       <b>OSSL_FUNC_kdf_freectx()</b> is passed a pointer to the provider side KDF context in the <u>kctx</u> parameter.  If
       it receives NULL as <u>kctx</u> value, it should not do anything other than return.  This function should free
       any resources associated with that context.

       <b>OSSL_FUNC_kdf_dupctx()</b> should duplicate the provider side KDF context in the <u>kctx</u> parameter and return
       the duplicate copy.

   <b>Encryption/Decryption</b> <b>Functions</b>
       <b>OSSL_FUNC_kdf_reset()</b> initialises a KDF operation given a provider side KDF context in the <u>kctx</u>
       parameter.

       <b>OSSL_FUNC_kdf_derive()</b> performs the KDF operation after processing the <u>params</u> as per
       <b>OSSL_FUNC_kdf_set_ctx_params()</b>.  The <u>kctx</u> parameter contains a pointer to the provider side context.  The
       resulting key of the desired <u>keylen</u> should be written to <u>key</u>.  If the algorithm does not support the
       requested <u>keylen</u> the function must return error.

   <b>KDF</b> <b>Parameters</b>
       See <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details on the parameters structure used by these functions.

       <b>OSSL_FUNC_kdf_get_params()</b> gets details of parameter values associated with the provider algorithm and
       stores them in <u>params</u>.

       <b>OSSL_FUNC_kdf_set_ctx_params()</b> sets KDF parameters associated with the given provider side KDF context
       <u>kctx</u> to <u>params</u>.  Any parameter settings are additional to any that were previously set.  Passing NULL for
       <u>params</u> should return true.

       <b>OSSL_FUNC_kdf_get_ctx_params()</b> retrieves gettable parameter values associated with the given provider
       side KDF context <u>kctx</u> and stores them in <u>params</u>.  Passing NULL for <u>params</u> should return true.

       <b>OSSL_FUNC_kdf_gettable_params()</b>, <b>OSSL_FUNC_kdf_gettable_ctx_params()</b>, and
       <b>OSSL_FUNC_kdf_settable_ctx_params()</b> all return constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) arrays as descriptors of the
       parameters that <b>OSSL_FUNC_kdf_get_params()</b>, <b>OSSL_FUNC_kdf_get_ctx_params()</b>, and
       <b>OSSL_FUNC_kdf_set_ctx_params()</b> can handle, respectively.  <b>OSSL_FUNC_kdf_gettable_ctx_params()</b> and
       <b>OSSL_FUNC_kdf_settable_ctx_params()</b> will return the parameters associated with the provider side context
       <u>kctx</u> in its current state if it is not NULL.  Otherwise, they return the parameters associated with the
       provider side algorithm <u>provctx</u>.

       Parameters currently recognised by built-in KDFs are as follows. Not all parameters are relevant to, or
       are understood by all KDFs:

       "size" (<b>OSSL_KDF_PARAM_SIZE</b>) &lt;unsigned integer&gt;
           Gets  the  output  size  from the associated KDF ctx.  If the algorithm produces a variable amount of
           output, SIZE_MAX should be returned.  If the input parameters required to calculate the fixed  output
           size have not yet been supplied, 0 should be returned indicating an error.

       "key" (<b>OSSL_KDF_PARAM_KEY</b>) &lt;octet string&gt;
           Sets the key in the associated KDF ctx.

       "secret" (<b>OSSL_KDF_PARAM_SECRET</b>) &lt;octet string&gt;
           Sets the secret in the associated KDF ctx.

       "pass" (<b>OSSL_KDF_PARAM_PASSWORD</b>) &lt;octet string&gt;
           Sets the password in the associated KDF ctx.

       "cipher" (<b>OSSL_KDF_PARAM_CIPHER</b>) &lt;UTF8 string&gt;
       "digest" (<b>OSSL_KDF_PARAM_DIGEST</b>) &lt;UTF8 string&gt;
       "mac" (<b>OSSL_KDF_PARAM_MAC</b>) &lt;UTF8 string&gt;
           Sets  the name of the underlying cipher, digest or MAC to be used.  It must name a suitable algorithm
           for the KDF that's being used.

       "maclen" (<b>OSSL_KDF_PARAM_MAC_SIZE</b>) &lt;octet string&gt;
           Sets the length of the MAC in the associated KDF ctx.

       "properties" (<b>OSSL_KDF_PARAM_PROPERTIES</b>) &lt;UTF8 string&gt;
           Sets the properties to be queried when trying to fetch the underlying algorithm.  This must be  given
           together with the algorithm naming parameter to be considered valid.

       "iter" (<b>OSSL_KDF_PARAM_ITER</b>) &lt;unsigned integer&gt;
           Sets the number of iterations in the associated KDF ctx.

       "mode" (<b>OSSL_KDF_PARAM_MODE</b>) &lt;UTF8 string&gt;
           Sets the mode in the associated KDF ctx.

       "pkcs5" (<b>OSSL_KDF_PARAM_PKCS5</b>) &lt;integer&gt;
           Enables or disables the SP800-132 compliance checks.  A mode of 0 enables the compliance checks.

           The checks performed are:

           - the iteration count is at least 1000.
           - the salt length is at least 128 bits.
           - the derived key length is at least 112 bits.
       "ukm" (<b>OSSL_KDF_PARAM_UKM</b>) &lt;octet string&gt;
           Sets  an  optional  random string that is provided by the sender called "partyAInfo".  In CMS this is
           the user keying material.

       "cekalg" (<b>OSSL_KDF_PARAM_CEK_ALG</b>) &lt;UTF8 string&gt;
           Sets the CEK wrapping algorithm name in the associated KDF ctx.

       "n" (<b>OSSL_KDF_PARAM_SCRYPT_N</b>) &lt;unsigned integer&gt;
           Sets the scrypt work factor parameter N in the associated KDF ctx.

       "r" (<b>OSSL_KDF_PARAM_SCRYPT_R</b>) &lt;unsigned integer&gt;
           Sets the scrypt work factor parameter r in the associated KDF ctx.

       "p" (<b>OSSL_KDF_PARAM_SCRYPT_P</b>) &lt;unsigned integer&gt;
           Sets the scrypt work factor parameter p in the associated KDF ctx.

       "maxmem_bytes" (<b>OSSL_KDF_PARAM_SCRYPT_MAXMEM</b>) &lt;unsigned integer&gt;
           Sets the scrypt work factor parameter maxmem in the associated KDF ctx.

       "prefix" (<b>OSSL_KDF_PARAM_PREFIX</b>) &lt;octet string&gt;
           Sets the prefix string using by the TLS 1.3 version of HKDF in the associated KDF ctx.

       "label" (<b>OSSL_KDF_PARAM_LABEL</b>) &lt;octet string&gt;
           Sets the label string using by the TLS 1.3 version of HKDF in the associated KDF ctx.

       "data" (<b>OSSL_KDF_PARAM_DATA</b>) &lt;octet string&gt;
           Sets the context string using by the TLS 1.3 version of HKDF in the associated KDF ctx.

       "info" (<b>OSSL_KDF_PARAM_INFO</b>) &lt;octet string&gt;
           Sets the optional shared info in the associated KDF ctx.

       "seed" (<b>OSSL_KDF_PARAM_SEED</b>) &lt;octet string&gt;
           Sets the IV in the associated KDF ctx.

       "xcghash" (<b>OSSL_KDF_PARAM_SSHKDF_XCGHASH</b>) &lt;octet string&gt;
           Sets the xcghash in the associated KDF ctx.

       "session_id" (<b>OSSL_KDF_PARAM_SSHKDF_SESSION_ID</b>) &lt;octet string&gt;
           Sets the session ID in the associated KDF ctx.

       "type" (<b>OSSL_KDF_PARAM_SSHKDF_TYPE</b>) &lt;UTF8 string&gt;
           Sets the SSH KDF type parameter in the associated KDF ctx.  There are six supported types:

           EVP_KDF_SSHKDF_TYPE_INITIAL_IV_CLI_TO_SRV
               The Initial IV from client to server.  A single char of value 65 (ASCII char 'A').

           EVP_KDF_SSHKDF_TYPE_INITIAL_IV_SRV_TO_CLI
               The Initial IV from server to client A single char of value 66 (ASCII char 'B').

           EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_CLI_TO_SRV
               The Encryption Key from client to server A single char of value 67 (ASCII char 'C').

           EVP_KDF_SSHKDF_TYPE_ENCRYPTION_KEY_SRV_TO_CLI
               The Encryption Key from server to client A single char of value 68 (ASCII char 'D').

           EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_CLI_TO_SRV
               The Integrity Key from client to server A single char of value 69 (ASCII char 'E').

           EVP_KDF_SSHKDF_TYPE_INTEGRITY_KEY_SRV_TO_CLI
               The Integrity Key from client to server A single char of value 70 (ASCII char 'F').

       "constant" (<b>OSSL_KDF_PARAM_CONSTANT</b>) &lt;octet string&gt;
           Sets the constant value in the associated KDF ctx.

       "id" (<b>OSSL_KDF_PARAM_PKCS12_ID</b>) &lt;integer&gt;
           Sets the intended usage of the output bits in the associated KDF ctx.  It is defined as per RFC  7292
           section B.3.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OSSL_FUNC_kdf_newctx()</b>  and  <b>OSSL_FUNC_kdf_dupctx()</b>  should  return  the  newly created provider side KDF
       context, or NULL on failure.

       <b>OSSL_FUNC_kdf_derive()</b>,       <b>OSSL_FUNC_kdf_get_params()</b>,       <b>OSSL_FUNC_kdf_get_ctx_params()</b>        and
       <b>OSSL_FUNC_kdf_set_ctx_params()</b> should return 1 for success or 0 on error.

       <b>OSSL_FUNC_kdf_gettable_params()</b>,                  <b>OSSL_FUNC_kdf_gettable_ctx_params()</b>                 and
       <b>OSSL_FUNC_kdf_settable_ctx_params()</b> should return a constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array,  or  NULL  if  none  is
       offered.

</pre><h4><b>NOTES</b></h4><pre>
       The  KDF  life-cycle  is  described  in  <b><a href="../man7/life_cycle-kdf.7.html">life_cycle-kdf</a></b>(7).   Providers  should  ensure  that the various
       transitions listed there are supported.  At some point the EVP layer  will  begin  enforcing  the  listed
       transitions.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/provider.7.html">provider</a></b>(7), <b><a href="../man7/life_cycle-kdf.7.html">life_cycle-kdf</a></b>(7), <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3).

</pre><h4><b>HISTORY</b></h4><pre>
       The provider KDF interface was introduced in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020-2022 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                 <u><a href="../man7SSL/PROVIDER-KDF.7SSL.html">PROVIDER-KDF</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>