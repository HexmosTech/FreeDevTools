<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>provider-kem - The kem library <-> provider functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       provider-kem - The kem library &lt;-&gt; provider functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/core_dispatch.h&gt;
        #include &lt;openssl/core_names.h&gt;

        /*
         * None of these are actual functions, but are displayed like this for
         * the function signatures for functions that are offered as function
         * pointers in OSSL_DISPATCH arrays.
         */

        /* Context management */
        void *OSSL_FUNC_kem_newctx(void *provctx);
        void OSSL_FUNC_kem_freectx(void *ctx);
        void *OSSL_FUNC_kem_dupctx(void *ctx);

        /* Encapsulation */
        int OSSL_FUNC_kem_encapsulate_init(void *ctx, void *provkey,
                                           const OSSL_PARAM params[]);
        int OSSL_FUNC_kem_auth_encapsulate_init(void *ctx, void *provkey,
                                                void *provauthkey,
                                                const OSSL_PARAM params[]);
        int OSSL_FUNC_kem_encapsulate(void *ctx, unsigned char *out, size_t *outlen,
                                      unsigned char *secret, size_t *secretlen);

        /* Decapsulation */
        int OSSL_FUNC_kem_decapsulate_init(void *ctx, void *provkey);
        int OSSL_FUNC_kem_auth_decapsulate_init(void *ctx, void *provkey,
                                                void *provauthkey,
                                                const OSSL_PARAM params[]);
        int OSSL_FUNC_kem_decapsulate(void *ctx, unsigned char *out, size_t *outlen,
                                      const unsigned char *in, size_t inlen);

        /* KEM parameters */
        int OSSL_FUNC_kem_get_ctx_params(void *ctx, OSSL_PARAM params[]);
        const OSSL_PARAM *OSSL_FUNC_kem_gettable_ctx_params(void *ctx, void *provctx);
        int OSSL_FUNC_kem_set_ctx_params(void *ctx, const OSSL_PARAM params[]);
        const OSSL_PARAM *OSSL_FUNC_kem_settable_ctx_params(void *ctx, void *provctx);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This documentation is primarily aimed at provider authors. See <b><a href="../man7/provider.7.html">provider</a></b>(7) for further information.

       The asymmetric kem (OSSL_OP_KEM) operation enables providers to implement asymmetric kem algorithms and
       make them available to applications via the API functions <b><a href="../man3/EVP_PKEY_encapsulate.3.html">EVP_PKEY_encapsulate</a></b>(3),
       <b><a href="../man3/EVP_PKEY_decapsulate.3.html">EVP_PKEY_decapsulate</a></b>(3) and other related functions.

       All "functions" mentioned here are passed as function pointers between <u>libcrypto</u> and the provider in
       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays via <b><a href="../man3/OSSL_ALGORITHM.3.html">OSSL_ALGORITHM</a></b>(3) arrays that are returned by the provider's
       <b>provider_query_operation()</b> function (see "Provider Functions" in <b><a href="../man7/provider-base.7.html">provider-base</a></b>(7)).

       All these "functions" have a corresponding function type definition named <b>OSSL_FUNC_{name}_fn</b>, and a
       helper function to retrieve the function pointer from an <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) element named <b>OSSL_FUNC_{name}</b>.
       For example, the "function" <b>OSSL_FUNC_kem_newctx()</b> has these:

        typedef void *(OSSL_FUNC_kem_newctx_fn)(void *provctx);
        static ossl_inline OSSL_FUNC_kem_newctx_fn
            OSSL_FUNC_kem_newctx(const OSSL_DISPATCH *opf);

       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays are indexed by numbers that are provided as macros in <b><a href="../man7/openssl-core_dispatch.h.7.html">openssl-core_dispatch.h</a></b>(7),
       as follows:

        OSSL_FUNC_kem_newctx                OSSL_FUNC_KEM_NEWCTX
        OSSL_FUNC_kem_freectx               OSSL_FUNC_KEM_FREECTX
        OSSL_FUNC_kem_dupctx                OSSL_FUNC_KEM_DUPCTX

        OSSL_FUNC_kem_encapsulate_init      OSSL_FUNC_KEM_ENCAPSULATE_INIT
        OSSL_FUNC_kem_auth_encapsulate_init OSSL_FUNC_KEM_AUTH_ENCAPSULATE_INIT
        OSSL_FUNC_kem_encapsulate           OSSL_FUNC_KEM_ENCAPSULATE

        OSSL_FUNC_kem_decapsulate_init      OSSL_FUNC_KEM_DECAPSULATE_INIT
        OSSL_FUNC_kem_auth_decapsulate_init OSSL_FUNC_KEM_AUTH_DECAPSULATE_INIT
        OSSL_FUNC_kem_decapsulate           OSSL_FUNC_KEM_DECAPSULATE

        OSSL_FUNC_kem_get_ctx_params        OSSL_FUNC_KEM_GET_CTX_PARAMS
        OSSL_FUNC_kem_gettable_ctx_params   OSSL_FUNC_KEM_GETTABLE_CTX_PARAMS
        OSSL_FUNC_kem_set_ctx_params        OSSL_FUNC_KEM_SET_CTX_PARAMS
        OSSL_FUNC_kem_settable_ctx_params   OSSL_FUNC_KEM_SETTABLE_CTX_PARAMS

       An asymmetric kem algorithm implementation may not implement all of these functions.  In order to be a
       consistent set of functions a provider must implement OSSL_FUNC_kem_newctx and OSSL_FUNC_kem_freectx.  It
       must also implement both of OSSL_FUNC_kem_encapsulate_init and OSSL_FUNC_kem_encapsulate, or both of
       OSSL_FUNC_kem_decapsulate_init and OSSL_FUNC_kem_decapsulate.  OSSL_FUNC_kem_auth_encapsulate_init is
       optional but if it is present then so must OSSL_FUNC_kem_auth_decapsulate_init.
       OSSL_FUNC_kem_get_ctx_params is optional but if it is present then so must
       OSSL_FUNC_kem_gettable_ctx_params.  Similarly, OSSL_FUNC_kem_set_ctx_params is optional but if it is
       present then OSSL_FUNC_kem_settable_ctx_params must also be present.

       An asymmetric kem algorithm must also implement some mechanism for generating, loading or importing keys
       via the key management (OSSL_OP_KEYMGMT) operation.  See <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7) for further details.

   <b>Context</b> <b>Management</b> <b>Functions</b>
       <b>OSSL_FUNC_kem_newctx()</b> should create and return a pointer to a provider side structure for holding
       context information during an asymmetric kem operation.  A pointer to this context will be passed back in
       a number of the other asymmetric kem operation function calls.  The parameter <u>provctx</u> is the provider
       context generated during provider initialisation (see <b><a href="../man7/provider.7.html">provider</a></b>(7)).

       <b>OSSL_FUNC_kem_freectx()</b> is passed a pointer to the provider side asymmetric kem context in the <u>ctx</u>
       parameter.  This function should free any resources associated with that context.

       <b>OSSL_FUNC_kem_dupctx()</b> should duplicate the provider side asymmetric kem context in the <u>ctx</u> parameter and
       return the duplicate copy.

   <b>Asymmetric</b> <b>Key</b> <b>Encapsulation</b> <b>Functions</b>
       <b>OSSL_FUNC_kem_encapsulate_init()</b> initialises a context for an asymmetric encapsulation given a provider
       side asymmetric kem context in the <u>ctx</u> parameter, a pointer to a provider key object in the <u>provkey</u>
       parameter and the <u>name</u> of the algorithm.  The <u>params</u>, if not NULL, should be set on the context in a
       manner similar to using <b>OSSL_FUNC_kem_set_ctx_params()</b>.  The key object should have been previously
       generated, loaded or imported into the provider using the key management (OSSL_OP_KEYMGMT) operation (see
       <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7)&gt;.

       <b>OSSL_FUNC_kem_auth_encapsulate_init()</b> is similar to <b>OSSL_FUNC_kem_encapsulate_init()</b>, but also passes an
       additional authentication key <u>provauthkey</u> which cannot be NULL.

       <b>OSSL_FUNC_kem_encapsulate()</b> performs the actual encapsulation itself.  A previously initialised
       asymmetric kem context is passed in the <u>ctx</u> parameter.  Unless <u>out</u> is NULL, the data to be encapsulated
       is internally generated, and returned into the buffer pointed to by the <u>secret</u> parameter and the
       encapsulated data should also be written to the location pointed to by the <u>out</u> parameter. The length of
       the encapsulated data should be written to <u>*outlen</u> and the length of the generated secret should be
       written to <u>*secretlen</u>.

       If <u>out</u> is NULL then the maximum length of the encapsulated data should be written to <u>*outlen</u>, and the
       maximum length of the generated secret should be written to <u>*secretlen</u>.

   <b>Decapsulation</b> <b>Functions</b>
       <b>OSSL_FUNC_kem_decapsulate_init()</b> initialises a context for an asymmetric decapsulation given a provider
       side asymmetric kem context in the <u>ctx</u> parameter, a pointer to a provider key object in the <u>provkey</u>
       parameter, and a <u>name</u> of the algorithm.  The key object should have been previously generated, loaded or
       imported into the provider using the key management (OSSL_OP_KEYMGMT) operation (see
       <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7)&gt;.

       <b>OSSL_FUNC_kem_auth_decapsulate_init()</b> is similar to <b>OSSL_FUNC_kem_decapsulate_init()</b>, but also passes an
       additional authentication key <u>provauthkey</u> which cannot be NULL.

       <b>OSSL_FUNC_kem_decapsulate()</b> performs the actual decapsulation itself.  A previously initialised
       asymmetric kem context is passed in the <u>ctx</u> parameter.  The data to be decapsulated is pointed to by the
       <u>in</u> parameter which is <u>inlen</u> bytes long.  Unless <u>out</u> is NULL, the decapsulated data should be written to
       the location pointed to by the <u>out</u> parameter.  The length of the decapsulated data should be written to
       <u>*outlen</u>.  If <u>out</u> is NULL then the maximum length of the decapsulated data should be written to <u>*outlen</u>.

   <b>Asymmetric</b> <b>Key</b> <b>Encapsulation</b> <b>Parameters</b>
       See <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details on the parameters structure used by the
       <b>OSSL_FUNC_kem_get_ctx_params()</b> and <b>OSSL_FUNC_kem_set_ctx_params()</b> functions.

       The OpenSSL FIPS provider also supports the following parameters:

       "fips-indicator" (<b>OSSL_KEM_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           A  getter  that  returns 1 if the operation is FIPS approved, or 0 otherwise.  This may be used after
           calling either <b>OSSL_FUNC_kem_encapsulate()</b> or <b>OSSL_FUNC_kem_decapsulate()</b>. It may  return  0  if  the
           "key-check" is set to 0.

       "key-check" (<b>OSSL_KEM_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
           If    required   this   parameter   should   be   set   using   <b>OSSL_FUNC_kem_encapsulate_init()</b>   or
           <b>OSSL_FUNC_kem_decapsulate_init()</b>.  The default value of 1 causes an error during the init if the  key
           is  not FIPS approved (e.g. The key has a security strength of less than 112 bits). Setting this to 0
           will ignore the error and set the approved "fips-indicator" to 0.  This option breaks FIPS compliance
           if it causes the approved "fips-indicator" to return 0.

   <b>Asymmetric</b> <b>Key</b> <b>Encapsulation</b> <b>Parameter</b> <b>Functions</b>
       <b>OSSL_FUNC_kem_get_ctx_params()</b> gets asymmetric KEM parameters associated with  the  given  provider  side
       asymmetric kem context <u>ctx</u> and stores them in <u>params</u>.  Passing NULL for <u>params</u> should return true.

       <b>OSSL_FUNC_kem_set_ctx_params()</b> sets the asymmetric KEM parameters associated with the given provider side
       asymmetric  kem context <u>ctx</u> to <u>params</u>.  Any parameter settings are additional to any that were previously
       set.  Passing NULL for <u>params</u> should return true.

       No parameters are currently recognised by built-in asymmetric kem algorithms.

       <b>OSSL_FUNC_kem_gettable_ctx_params()</b> and <b>OSSL_FUNC_kem_settable_ctx_params()</b> get a constant  <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3)
       array  that  describes  the  gettable  and  settable  parameters,  i.e.  parameters that can be used with
       <b>OSSL_FUNC_kem_get_ctx_params()</b> and <b>OSSL_FUNC_kem_set_ctx_params()</b> respectively.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OSSL_FUNC_kem_newctx()</b>  and  <b>OSSL_FUNC_kem_dupctx()</b>  should  return  the  newly  created  provider   side
       asymmetric kem context, or NULL on failure.

       All other functions should return 1 for success or 0 on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/provider.7.html">provider</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       The provider KEM interface was introduced in OpenSSL 3.0.

       <b>OSSL_FUNC_kem_auth_encapsulate_init()</b>  and  <b>OSSL_FUNC_kem_auth_decapsulate_init()</b>  were  added in OpenSSL
       3.2.

       The Asymmetric Key Encapsulation Parameters "fips-indicator" and "key-check" were added in OpenSSL 3.4.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                 <u><a href="../man7SSL/PROVIDER-KEM.7SSL.html">PROVIDER-KEM</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>