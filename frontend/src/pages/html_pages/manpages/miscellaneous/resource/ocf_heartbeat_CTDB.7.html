<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ocf_heartbeat_CTDB - CTDB Resource Agent</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/resource-agents-extra">resource-agents-extra_4.16.0-3ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ocf_heartbeat_CTDB - CTDB Resource Agent

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>CTDB</b> [start | stop | monitor | meta-data | validate-all]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This resource agent manages CTDB, allowing one to use Clustered Samba in a Linux-HA/Pacemaker cluster.
       You need a shared filesystem (e.g. OCFS2 or GFS2) on which the CTDB lock will be stored. Create
       /etc/ctdb/nodes containing a list of private IP addresses of each node in the cluster, then configure
       this RA as a clone. This agent expects the samba and windbind resources to be managed outside of CTDB's
       control as a separate set of resources controlled by the cluster manager. The optional support for
       enabling CTDB management of these daemons will be depreciated.

       For more information see <a href="http://linux-ha.org/wiki/CTDB_">http://linux-ha.org/wiki/CTDB_</a>(resource_agent)

</pre><h4><b>SUPPORTED</b> <b>PARAMETERS</b></h4><pre>
       <b>ctdb_recovery_lock</b>
           The location of a shared lock file or helper binary, common across all nodes. See CTDB documentation
           for details.

           (unique, required, string, no default)

       <b>ctdb_manages_samba</b>
           Should CTDB manage starting/stopping the Samba service for you? This will be deprecated in future, in
           favor of configuring a separate Samba resource.

           (optional, boolean, default no)

       <b>ctdb_manages_winbind</b>
           Should CTDB manage starting/stopping the Winbind service for you? This will be deprecated in future,
           in favor of configuring a separate Winbind resource.

           (optional, boolean, default no)

       <b>ctdb_service_smb</b>
           Name of smb init script. Only necessary if CTDB is managing Samba directly. Will usually be
           auto-detected.

           (optional, string, no default)

       <b>ctdb_service_nmb</b>
           Name of nmb init script. Only necessary if CTDB is managing Samba directly. Will usually be
           auto-detected.

           (optional, string, no default)

       <b>ctdb_service_winbind</b>
           Name of winbind init script. Only necessary if CTDB is managing Winbind directly. Will usually be
           auto-detected.

           (optional, string, no default)

       <b>ctdb_samba_skip_share_check</b>
           If there are very many shares it may not be feasible to check that all of them are available during
           each monitoring interval. In that case this check can be disabled.

           (optional, boolean, default yes)

       <b>ctdb_monitor_free_memory</b>
           If the amount of free memory drops below this value the node will become unhealthy and ctdb and all
           managed services will be shutdown. Once this occurs, the administrator needs to find the reason for
           the OOM situation, rectify it and restart ctdb with "service ctdb start". With CTDB 4.4.0 and later
           this parameter is ignored.

           (optional, integer, default 100)

       <b>ctdb_start_as_disabled</b>
           When set to yes, the CTDB node will start in DISABLED mode and not host any public ip addresses.

           (optional, boolean, default no)

       <b>ctdb_config_dir</b>
           The directory containing various CTDB configuration files. The "nodes" and "notify.sh" scripts are
           expected to be in this directory.

           (optional, string, default "/etc/ctdb")

       <b>ctdb_binary</b>
           Full path to the CTDB binary.

           (optional, string, default "/usr/bin/ctdb")

       <b>ctdbd_binary</b>
           Full path to the CTDB cluster daemon binary.

           (optional, string, default "/usr/sbin/ctdbd")

       <b>ctdb_socket</b>
           Full path to the domain socket that ctdbd will create, used for local clients to attach and
           communicate with the ctdb daemon. With CTDB 4.9.0 and later the socket path is hardcoded at build
           time, so this parameter is ignored.

           (unique, optional, string, default "/run/ctdb/ctdbd.socket")

       <b>ctdb_dbdir</b>
           The directory to put the local CTDB database files in. Persistent database files will be put in
           ctdb_dbdir/persistent.

           (unique, optional, string, default "<a href="file:/var/run">/var/run</a>")

       <b>ctdb_logfile</b>
           Full path to log file. To log to syslog instead, use the value "syslog".

           (optional, string, default "/var/log/ctdb/log.ctdb")

       <b>ctdb_rundir</b>
           Full path to ctdb runtime directory, used for storage of socket lock state.

           (optional, string, default "/run/ctdb")

       <b>ctdb_timeout</b>
           Indicates that ctdb should wait up to TIMEOUT seconds for a response to most commands sent to the
           CTDB daemon.

           (unique, optional, integer, default 10)

       <b>ctdb_debuglevel</b>
           What debug level to run at (0-10). Higher means more verbose.

           (optional, integer, default 2)

       <b>ctdb_max_open_files</b>
           Maximum number of open files (for ulimit -n)

           (optional, integer, no default)

       <b>smb_conf</b>
           Path to default samba config file. Only necessary if CTDB is managing Samba.

           (optional, string, default "/etc/samba/smb.conf")

       <b>smb_private_dir</b>
           The directory for smbd to use for storing such files as smbpasswd and secrets.tdb. Old versions of
           CTBD (prior to 1.0.50) required this to be on shared storage. This parameter should not be set for
           current versions of CTDB, and only remains in the RA for backwards compatibility.

           (unique, optional, string, no default)

       <b>smb_passdb_backend</b>
           Which backend to use for storing user and possibly group information. Only necessary if CTDB is
           managing Samba.

           (optional, string, default "tdbsam")

       <b>smb_idmap_backend</b>
           Which backend to use for SID/uid/gid mapping. Only necessary if CTDB is managing Samba.

           (optional, string, default "tdb2")

       <b>smb_fileid_algorithm</b>
           Which fileid:algorithm to use with vfs_fileid. The correct value depends on which clustered
           filesystem is in use, e.g.: for OCFS2, this should be set to "fsid". Only necessary if CTDB is
           managing Samba.

           (optional, string, no default)

</pre><h4><b>SUPPORTED</b> <b>ACTIONS</b></h4><pre>
       This resource agent supports the following actions (operations):

       <b>start</b>
           Starts the resource. Suggested minimum timeout: 90s.

       <b>stop</b>
           Stops the resource. Suggested minimum timeout: 100s.

       <b>monitor</b>
           Performs a detailed status check. Suggested minimum timeout: 20s. Suggested interval: 10s.

       <b>meta-data</b>
           Retrieves resource agent metadata (internal use only). Suggested minimum timeout: 5s.

       <b>validate-all</b>
           Performs a validation of the resource configuration. Suggested minimum timeout: 30s.

</pre><h4><b>EXAMPLE</b> <b>CRM</b> <b>SHELL</b></h4><pre>
       The following is an example configuration for a CTDB resource using the <b><a href="../man8/crm.8.html">crm</a></b>(8) shell:

           primitive p_CTDB ocf:heartbeat:CTDB \
             params \
               ctdb_recovery_lock=<u>string</u> \
             op monitor timeout="20s" interval="10s" depth="0"

</pre><h4><b>EXAMPLE</b> <b>PCS</b></h4><pre>
       The following is an example configuration for a CTDB resource using <b><a href="../man8/pcs.8.html">pcs</a></b>(8)

           pcs resource create p_CTDB ocf:heartbeat:CTDB \
             ctdb_recovery_lock=<u>string</u> \
             op monitor timeout="20s" interval="10s" OCF_CHECK_LEVEL="0"

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="http://clusterlabs.org/">http://clusterlabs.org/</a></b>

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>ClusterLabs</b> <b>contributors</b> <b>(see</b> <b>the</b> <b>resource</b> <b>agent</b> <b>source</b> <b>for</b> <b>information</b> <b>about</b> <b>individual</b> <b>authors)</b>

resource-agents 4.16.0-3ubuntu                     06/25/2025                              <u><a href="../man7/OCF_HEARTBEAT_CTDB.7.html">OCF_HEARTBEAT_CTDB</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>