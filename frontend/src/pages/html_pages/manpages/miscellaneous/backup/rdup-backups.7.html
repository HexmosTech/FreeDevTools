<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rdup-backups - introduction into making backups with rdup</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/noble/+package/rdup">rdup_1.1.15-1ubuntu4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rdup-backups - introduction into making backups with rdup

</pre><h4><b>INTRODUCTION</b></h4><pre>
       <b>rdup</b>  is  a  simple program that prints out a list of files and directories that are changed changed on a
       filesystem. It is more sophisticated than for instance <u>find</u>,  because  <b>rdup</b>  will  find  files  that  are
       removed or directories that are renamed.

       A  long  time ago <b>rdup</b> included a bunch of shell and Perl scripts that implemented a backup policy. These
       could be used in a pipeline to perform a backup.

       Currently <b>rdup</b> consists out of three basic utilities:

       <b>rdup</b>   With <b>rdup</b> you create the file list on which later programs in the pipeline can work.  The  default
              output  format  also  includes  the  files' content. <b>rdup</b> can be seen as a tar replacement in this
              respect, but <b>rdup</b> also allows for  all  kinds  of  transformations  of  the  content  (encryption,
              compression, reversal), see the -P switch in <a href="../man1/rdup.1.html">rdup</a>(1) for more information.

       <b>rdup-tr</b>
              With  <b>rdup-tr</b>  you  can transform the files rdup delivers to you.  You can create tar, cpio or pax
              files. You can encrypt pathnames. <b>rdup-tr</b> is filter that reads from standard input and  writes  to
              standard  output.   See  <a href="../man1/rdup-tr.1.html">rdup-tr</a>(1)  for more information. With <b>rdup</b> and <b>rdup-tr</b> you can create an
              encrypted archive which is put in a directory structure that is also encrypted.

       <b>rdup-up</b>
              With <b>rdup-up</b> you can update an existing directory structure with the updates as described by rdup.

              <b>rdup-up</b> reads <b>rdup</b> input and will create the files, symbolic links,  hard  links  and  directories
              (and sockets, pipes and devices) in the file system. See <a href="../man1/rdup-up.1.html">rdup-up</a>(1) for more information.

       So the general backup pipeline for <b>rdup</b> will look something like this:

           create filelist  |  transform |  update filesystem
           ( rdup           |  rdup-tr   |  rdup-up )

       <b>Note</b> <b>1:</b>
              The  same  sequence is used for restoring. In both cases you want to move files from location A to
              B. The only difference is that the transformation is reversed when you restore.

       <b>Note</b> <b>2:</b>
              The use of <b>rdup-tr</b> is optional.

</pre><h4><b>BACKUPS</b> <b>AND</b> <b>RESTORES</b></h4><pre>
       For <b>rdup</b> there is <u>no</u> difference between backups and restores. If you think about this for  a  minute  you
       understand why.

       Making  a backup means copying a list of files somewhere else. Restoring files is copying a list of files
       back to the place they came from. Same difference. So  <b>rdup</b>  can  be  used  for  both,  if  you  did  any
       transformation with <b>rdup</b> during the backup you just need to reverse those operations during the restore.

</pre><h4><b>BACKUPS</b></h4><pre>
       It  is  always  best  to backup to <u>another</u> medium, be it a different local harddisk or a NFS/CIFS mounted
       filesystem.  You can also use <u>ssh</u> to store file on a remote server, ala rsync (although  not  as  network
       efficient).

       If  you  backup  to  a  local disk you can just as well use <b>rsync</b> or plain old tar, but if you store your
       files at somebody else's disk you will need encryption. This is where you go beyond <b>rsync</b> and <b>rdup</b>  comes
       in.  Rsync  cannot  do per-file encryption, sure you can encrypt the network traffic with ssh, but at the
       remote side your files are kept in plain view.        If you implement remote backups, the easy route  is
       to  allow root access on the backup medium. If the backup runs without root access the created files will
       not have their original ownership.  For NFS this can be achieved by using  <b>no_root_squash</b>,  for  <b>ssh</b>  you
       could enable <u>PermitRootLogin</u>. Note that this may be a security risk.

</pre><h4><b>SNAPSHOT</b> <b>BACKUPS</b></h4><pre>
       We  need  a  little  help  here  in  the form of the <b>rdup-simple</b> script.  Keep in mind that the following
       scripts can also be run remotely with the help of <b>ssh</b>.

       The following script implements the algorithm of <b>rdup-simple</b>.

              #!<a href="file:/bin/bash">/bin/bash</a>
              # some tmp files are saved in <a href="file:~/.rdup.">~/.rdup.</a> This directory must exist
              DIR=<a href="file:/home">/home</a>     # what to backup
              BACKUP=/vol/backup
              TODAY=$(date +%Y%m/%d)
              LIST=<a href="file:~/.rdup/list-">~/.rdup/list-</a>$HOSTNAME
              STAMP=<a href="file:~/.rdup/timestamp-">~/.rdup/timestamp-</a>$HOSTNAME

              # for remote backup, this has to run on the remote host!
              BUGBUG
              RET=$?

              case $RET in
                  2|*)
                   echo Error &gt;&amp;2
                   exit 1
                   ;;
                  1)
                   # full dump, remove file-list and time-stamp file
                   rm $LIST $STAMP
                   ;;
                  0)
                   # inc dump
                   # do nothing here
                   ;;
              esac
              # this is the place where you want to modify the command line
              # right now, nothing is translated we just use 'cat'
              rdup -N $STAMP -Pcat $LIST $DIR | rdup-up $BACKUP/$HOSTNAME/$TODAY

              # or do a remote backup
              #rdup -N $STAMP -Pcat $LIST $DIR | ssh root@remotehost \
              #    rdup-up $BACKUP/$HOSTNAME/$TODAY

</pre><h4><b>LOCAL</b> <b>BACKUPS</b></h4><pre>
       With <b>rdup-simple</b> you can easily create backups.  Backing up my home directory to a backup directory:

              rdup-simple ~ /vol/backup/$HOSTNAME

       This will create a backup in /vol/backup/$HOSTNAME/200705/15. So each day will have  its  own  directory.
       Multiple sources are allowed, so:

              rdup-simple ~ <a href="file:/etc/">/etc/</a> <a href="file:/var/lib">/var/lib</a> /vol/backup/$HOSTNAME

       Will  backup  your home directory, <a href="file:/etc">/etc</a> and <a href="file:/var/lib">/var/lib</a> to the backup location. Also if you need to compress
       your backup, simple add a '-z' switch:

              rdup-simple -z ~ <a href="file:/etc/">/etc/</a> <a href="file:/var/lib">/var/lib</a> /vol/backup/$HOSTNAME

</pre><h4><b>REMOTE</b> <b>BACKUPS</b></h4><pre>
       For a remote backup to work, both the sending machine and the receiving machine must have <b>rdup</b> installed.
       The currently implemented protocol is <u>ssh</u>.

       Dumping my homedir to the remote server:

              rdup-simple ~ ssh://miekg@remote/vol/backup/$HOSTNAME

       The syntax is almost identical, only the destination starts with the magic string  'ssh://'.  Compression
       and  encryption  are  just  as easily enabled as with a local backup, just add '-z' and/or a '-k keyfile'
       argument:

              rdup-simple -z -k 'secret-file' ~ ssh://miekg@remote/vol/backup/$HOSTNAME

       Remember though, that because of these advanced features (compression, encryption, etc, ...) the  network
       transfer can never be as efficient as <b>rsync</b>.

</pre><h4><b>ALSO</b> <b>SEE</b></h4><pre>
       <a href="../man1/rdup.1.html">rdup</a>(1), <a href="../man1/rdup-tr.1.html">rdup-tr</a>(1), <a href="../man1/rdup-up.1.html">rdup-up</a>(1) and <a href="http://www.miek.nl/projects/rdup/">http://www.miek.nl/projects/rdup/</a>

1.1.x                                              15 Dec 2008                                   <u><a href="../man7/RDUP-BACKUPS.7.html">RDUP-BACKUPS</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>