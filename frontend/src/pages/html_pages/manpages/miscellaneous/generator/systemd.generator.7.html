<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>systemd.generator - systemd unit generators</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/systemd">systemd_257.7-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       systemd.generator - systemd unit generators

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>/path/to/generator</b> <u>normal-dir</u> [<u>early-dir</u>] [<u>late-dir</u>]

           /run/systemd/system-generators/*
           <a href="file:/etc/systemd/system-generators/">/etc/systemd/system-generators/</a>*
           /usr/local/lib/systemd/system-generators/*
           <a href="file:/usr/lib/systemd/system-generators/">/usr/lib/systemd/system-generators/</a>*

           /run/systemd/user-generators/*
           /etc/systemd/user-generators/*
           /usr/local/lib/systemd/user-generators/*
           <a href="file:/usr/lib/systemd/user-generators/">/usr/lib/systemd/user-generators/</a>*

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Generators are small executables placed in <a href="file:/usr/lib/systemd/system-generators/">/usr/lib/systemd/system-generators/</a> and other directories
       listed above.  <b><a href="../man1/systemd.1.html">systemd</a></b>(1) will execute these binaries very early at bootup and at configuration reload
       time â€” before unit files are loaded. Their main purpose is to convert configuration and execution context
       parameters that are not native to the service manager into dynamically generated unit files, symlinks or
       unit file drop-ins, so that they can extend the unit file hierarchy the service manager subsequently
       loads and operates on.

       <b>systemd</b> will call each generator with three directory paths that are to be used for generator output. In
       these three directories, generators may dynamically generate unit files (regular ones, instances, as well
       as templates), unit file .d/ drop-ins, and create symbolic links to unit files to add additional
       dependencies, create aliases, or instantiate existing templates. Those directories are included in the
       unit load path, allowing generated configuration to extend or override existing definitions. For tests,
       generators may be called with just one argument; the generator should assume that all three paths are the
       same in that case.

       Generators executed by the system manager are invoked in a sandbox with a private writable <a href="file:/tmp/">/tmp/</a>
       directory and where most of the file system is read-only except for the generator output directories.

       Directory paths for generator output differ by priority: .../generator.early has priority higher than the
       admin configuration in <a href="file:/etc/">/etc/</a>, while .../generator has lower priority than <a href="file:/etc/">/etc/</a> but higher than vendor
       configuration in <a href="file:/usr/">/usr/</a>, and .../generator.late has priority lower than all other configuration. See the
       next section and the discussion of unit load paths and unit overriding in <b><a href="../man5/systemd.unit.5.html">systemd.unit</a></b>(5).

       Generators are loaded from a set of paths determined during compilation, as listed above. System and user
       generators are loaded from directories with names ending in system-generators/ and user-generators/,
       respectively. Generators found in directories listed earlier override the ones with the same name in
       directories lower in the list [1]. A symlink to /dev/null or an empty file can be used to mask a
       generator, thereby preventing it from running. Please note that the order of the two directories with the
       highest priority is reversed with respect to the unit load path, and generators in <a href="file:/run/">/run/</a> overwrite those
       in <a href="file:/etc/.">/etc/.</a>

       After installing new generators or updating the configuration, <b>systemctl</b> <b>daemon-reload</b> may be executed.
       This will delete the previous configuration created by generators, re-run all generators, and cause
       <b>systemd</b> to reload units from disk. See <b><a href="../man1/systemctl.1.html">systemctl</a></b>(1) for more information.

</pre><h4><b>OUTPUT</b> <b>DIRECTORIES</b></h4><pre>
       Generators are invoked with three arguments: paths to directories where generators can place their
       generated unit files or symlinks. By default, those paths are runtime directories that are included in
       the search path of <b>systemd</b>, but a generator may be called with different paths for debugging purposes. If
       only one argument is provided, the generator should use the same directory as the three output paths.

        1. <u>normal-dir</u>

           In normal use this is <a href="file:/run/systemd/generator">/run/systemd/generator</a> in case of the system generators and
           $XDG_RUNTIME_DIR/systemd/generator in case of the user generators. Unit files placed in this
           directory take precedence over vendor unit configuration but not over native user/administrator unit
           configuration.

        2. <u>early-dir</u>

           In normal use this is <a href="file:/run/systemd/generator.early">/run/systemd/generator.early</a> in case of the system generators and
           $XDG_RUNTIME_DIR/systemd/generator.early in case of the user generators. Unit files placed in this
           directory override unit files in <a href="file:/usr/">/usr/</a>, <a href="file:/run/">/run/</a> and <a href="file:/etc/.">/etc/.</a> This means that unit files placed in this
           directory take precedence over all normal configuration, both vendor and user/administrator.

        3. <u>late-dir</u>

           In normal use this is /run/systemd/generator.late in case of the system generators and
           $XDG_RUNTIME_DIR/systemd/generator.late in case of the user generators. This directory may be used to
           extend the unit file tree without overriding any other unit files. Any native configuration files
           supplied by the vendor or user/administrator take precedence.

       Note: generators <u>must</u> <u>not</u> write to other locations or otherwise make changes to system state. Generator
       output is supposed to last only until the next <b>daemon-reload</b> or <b>daemon-reexec</b>; if the generator is
       replaced or masked, its effects should vanish.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       The service manager sets a number of environment variables when invoking generator executables. They
       carry information about the execution context of the generator, in order to simplify conditionalizing
       generators to specific environments. The following environment variables are set:

       <u>$SYSTEMD_SCOPE</u>
           If the generator is invoked from the system service manager this variable is set to "system"; if
           invoked from the per-user service manager it is set to "user".

           Added in version 251.

       <u>$SYSTEMD_IN_INITRD</u>
           If the generator is run as part of an initrd this is set to "1". If it is run from the regular host
           (i.e. after the transition from initrd to host) it is set to "0". This environment variable is only
           set for system generators.

           Added in version 251.

       <u>$SYSTEMD_SOFT_REBOOTS_COUNT</u>
           If the system has soft-rebooted, this variable is set to the count of soft-reboots. This environment
           variable is only set for system generators.

           Added in version 257.

       <u>$SYSTEMD_FIRST_BOOT</u>
           If this boot-up cycle is considered a "first boot", this is set to "1"; if it is a subsequent,
           regular boot it is set to "0". For details see the documentation of <u>ConditionFirstBoot=</u> in
           <b><a href="../man5/systemd.unit.5.html">systemd.unit</a></b>(5). This environment variable is only set for system generators.

           Added in version 251.

       <u>$SYSTEMD_VIRTUALIZATION</u>
           If the service manager is run in a virtualized environment, <u>$SYSTEMD_VIRTUALIZATION</u> is set to a pair
           of strings, separated by a colon. The first string is either "vm" or "container", categorizing the
           type of virtualization. The second string identifies the implementation of the virtualization
           technology. If no virtualization is detected this variable will not be set. This data is identical to
           what <b><a href="../man1/systemd-detect-virt.1.html">systemd-detect-virt</a></b>(1) detects and reports, and uses the same vocabulary of virtualization
           implementation identifiers.

           Added in version 251.

       <u>$SYSTEMD_ARCHITECTURE</u>
           This variable is set to a short identifier of the reported architecture of the system. For details
           about defined values, see documentation of <u>ConditionArchitecture=</u> in <b><a href="../man5/systemd.unit.5.html">systemd.unit</a></b>(5).

           Added in version 251.

       <u>$CREDENTIALS_DIRECTORY</u>, <u>$ENCRYPTED_CREDENTIALS_DIRECTORY</u>
           If set, refers to the directory system credentials have been placed in. Credentials passed into the
           system in plaintext form will be placed in <u>$CREDENTIALS_DIRECTORY</u>, and those passed in in encrypted
           form will be placed in <u>$ENCRYPTED_CREDENTIALS_DIRECTORY</u>. Use the <b><a href="../man1/systemd-creds.1.html">systemd-creds</a></b>(1) command to
           automatically decrypt/authenticate credentials passed in, if needed. Specifically, use the
           <b>systemd-creds</b> <b>--system</b> <b>cat</b> command.

           Added in version 254.

       <u>$SYSTEMD_CONFIDENTIAL_VIRTUALIZATION</u>
           If the service manager is run in a confidential virtualized environment,
           <u>$SYSTEMD_CONFIDENTIAL_VIRTUALIZATION</u> is set to a string that identifies the confidential
           virtualization hardware technology. If no confidential virtualization is detected this variable will
           not be set. This data is identical to what <b><a href="../man1/systemd-detect-virt.1.html">systemd-detect-virt</a></b>(1) detects and reports, and uses the
           same vocabulary of confidential virtualization technology identifiers.

           Added in version 254.

</pre><h4><b>NOTES</b> <b>ABOUT</b> <b>WRITING</b> <b>GENERATORS</b></h4><pre>
       â€¢   All generators are executed in parallel. That means all executables are started at the very same time
           and need to be able to cope with this parallelism.

       â€¢   Generators are run very early at boot and cannot rely on any external services. They may not talk to
           any other process. That includes simple things such as logging to <b><a href="../man3/syslog.3.html">syslog</a></b>(3), or <b>systemd</b> itself (this
           means: no <b><a href="../man1/systemctl.1.html">systemctl</a></b>(1))! Non-essential file systems like <a href="file:/var/">/var/</a> and <a href="file:/home/">/home/</a> are mounted after
           generators have run. Generators can however rely on the most basic kernel functionality to be
           available, as well as mounted <a href="file:/sys/">/sys/</a>, <a href="file:/proc/">/proc/</a>, <a href="file:/dev/">/dev/</a>, <a href="file:/usr/">/usr/</a> and <a href="file:/run/">/run/</a> file systems.

       â€¢   Units written by generators are removed when the configuration is reloaded. That means the lifetime
           of the generated units is closely bound to the reload cycles of <b>systemd</b> itself.

       â€¢   Generators should only be used to generate unit files, .d/*.conf drop-ins for them and symlinks to
           them, not any other kind of non-unit related configuration. Due to the lifecycle logic mentioned
           above, generators are not a good fit to generate dynamic configuration for other services. If you
           need to generate dynamic configuration for other services, do so in normal services you order before
           the service in question.

           Note that using the <u>StandardInputData=</u>/<u>StandardInputText=</u> settings of service unit files (see
           <b><a href="../man5/systemd.exec.5.html">systemd.exec</a></b>(5)), it is possible to make arbitrary input data (including daemon-specific
           configuration) part of the unit definitions, which often might be sufficient to embed data or
           configuration for other programs into unit files in a native fashion.

       â€¢   Since <b><a href="../man3/syslog.3.html">syslog</a></b>(3) is not available (see above), log messages have to be written to /dev/kmsg instead.

       â€¢   The generator should always include its own name in a comment at the top of the generated file, so
           that the user can easily figure out which component created or amended a particular unit.

           The <u>SourcePath=</u> directive should be used in generated files to specify the source configuration file
           they are generated from. This makes things more easily understood by the user and also has the
           benefit that systemd can warn the user about configuration files that changed on disk but have not
           been read yet by systemd. The <u>SourcePath=</u> value does not have to be a file in a physical filesystem.
           For example, in the common case of the generator looking at the kernel command line,
           <b>SourcePath=<a href="file:/proc/cmdline">/proc/cmdline</a></b> should be used.

       â€¢   Generators may write out dynamic unit files or just hook unit files into other units with the usual
           .wants/ or .requires/ symlinks. Often, it is nicer to simply instantiate a template unit file from
           <a href="file:/usr/">/usr/</a> with a generator instead of writing out entirely dynamic unit files. Of course, this works only
           if a single parameter is to be used.

       â€¢   If you are careful, you can implement generators in shell scripts. We do recommend C code however,
           since generators are executed synchronously and hence delay the entire boot if they are slow.

       â€¢   Regarding overriding semantics: there are two rules we try to follow when thinking about the
           overriding semantics:

            1. User configuration should override vendor configuration. This (mostly) means that stuff from
               <a href="file:/etc/">/etc/</a> should override stuff from <a href="file:/usr/.">/usr/.</a>

            2. Native configuration should override non-native configuration. This (mostly) means that stuff you
               generate should never override native unit files for the same purpose.

           Of these two rules the first rule is probably the more important one and breaks the second one
           sometimes. Hence, when deciding whether to use argv[1], argv[2], or argv[3], your default choice
           should probably be argv[1].

       â€¢   Instead of heading off now and writing all kind of generators for legacy configuration file formats,
           please think twice! It is often a better idea to just deprecate old stuff instead of keeping it
           artificially alive.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>Example</b> <b>1.</b> <b>systemd-fstab-generator</b>

       <b><a href="../man8/systemd-fstab-generator.8.html">systemd-fstab-generator</a></b>(8) converts <a href="file:/etc/fstab">/etc/fstab</a> into native mount units. It uses argv[1] as location to
       place the generated unit files in order to allow the user to override <a href="file:/etc/fstab">/etc/fstab</a> with their own native
       unit files, but also to ensure that <a href="file:/etc/fstab">/etc/fstab</a> overrides any vendor default from <a href="file:/usr/.">/usr/.</a>

       After editing <a href="file:/etc/fstab">/etc/fstab</a>, the user should invoke <b>systemctl</b> <b>daemon-reload</b>. This will re-run all generators
       and cause <b>systemd</b> to reload units from disk. To actually mount new directories added to fstab, <b>systemctl</b>
       <b>start</b> <u>/path/to/mountpoint</u> or <b>systemctl</b> <b>start</b> <b>local-fs.target</b> may be used.

       <b>Example</b> <b>2.</b> <b>systemd-system-update-generator</b>

       <b><a href="../man8/systemd-system-update-generator.8.html">systemd-system-update-generator</a></b>(8) temporarily redirects default.target to system-update.target, if a
       system update is scheduled. Since this needs to override the default user configuration for
       default.target, it uses argv[2]. For details about this logic, see <b><a href="../man7/systemd.offline-updates.7.html">systemd.offline-updates</a></b>(7).

       <b>Example</b> <b>3.</b> <b>Debugging</b> <b>a</b> <b>generator</b>

           dir=$(mktemp -d)
           SYSTEMD_LOG_LEVEL=debug <a href="file:/usr/lib/systemd/system-generators/systemd-fstab-generator">/usr/lib/systemd/system-generators/systemd-fstab-generator</a> \
                   "$dir" "$dir" "$dir"
           find $dir

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man8/systemd-cryptsetup-generator.8.html">systemd-cryptsetup-generator</a></b>(8), <b><a href="../man8/systemd-debug-generator.8.html">systemd-debug-generator</a></b>(8), <b><a href="../man8/systemd-fstab-generator.8.html">systemd-fstab-generator</a></b>(8),
       <b><a href="../man5/fstab.5.html">fstab</a></b>(5), <b><a href="../man8/systemd-getty-generator.8.html">systemd-getty-generator</a></b>(8), <b><a href="../man8/systemd-gpt-auto-generator.8.html">systemd-gpt-auto-generator</a></b>(8), <b><a href="../man8/systemd-hibernate-resumegenerator.8.html">systemd-hibernate-resume-</a></b>
       <b><a href="../man8/systemd-hibernate-resumegenerator.8.html">generator</a></b>(8), <b><a href="../man8/systemd-rc-local-generator.8.html">systemd-rc-local-generator</a></b>(8), <b><a href="../man8/systemd-system-update-generator.8.html">systemd-system-update-generator</a></b>(8), <b><a href="../man8/systemd-sysvgenerator.8.html">systemd-sysv-</a></b>
       <b><a href="../man8/systemd-sysvgenerator.8.html">generator</a></b>(8), <b><a href="../man8/systemd-xdg-autostart-generator.8.html">systemd-xdg-autostart-generator</a></b>(8), <b><a href="../man5/systemd.unit.5.html">systemd.unit</a></b>(5), <b><a href="../man1/systemctl.1.html">systemctl</a></b>(1), <b><a href="../man7/systemd.environmentgenerator.7.html">systemd.environment-</a></b>
       <b><a href="../man7/systemd.environmentgenerator.7.html">generator</a></b>(7)

</pre><h4><b>NOTES</b></h4><pre>
        1. ðŸ’£ðŸ’¥ðŸ§¨ðŸ’¥ðŸ’¥ðŸ’£  Please  note  that  those  configuration  files  must  be  available  at  all times. If
           <a href="file:/usr/local/">/usr/local/</a> is a separate partition, it may not be available during early boot, and must not be  used
           for configuration.

systemd 257.7                                                                               <u><a href="../man7/SYSTEMD.GENERATOR.7.html">SYSTEMD.GENERATOR</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>