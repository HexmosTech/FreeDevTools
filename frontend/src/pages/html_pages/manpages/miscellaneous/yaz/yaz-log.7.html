<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>yaz-log - Log handling in all yaz-based programs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/yaz">yaz_5.34.4-1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       yaz-log - Log handling in all yaz-based programs

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>yaz-XXXX</b> [<b>-v</b> <u>loglevel,...</u>] [<b>-l</b> <u>logfile</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       All YAZ-based programs use a common log subsystem, and should support common command line options for
       controlling it. This man page documents those.

</pre><h4><b>OPTIONS</b></h4><pre>
       -l <u>logfile</u>
           Specify the file where the log is to be written. If none is specified, stderr is used. The log is
           appended to this file. If the file grows overly large, it is silently rotated: It is renamed to
           <u>logfile</u>.1, <u>logfile</u>.2, .., 9 (old such file is deleted), and a new file is opened. The limit defaults
           to 1GB, but can be set by the program. The rotating limit can be specified with option -r for the YAZ
           frontend server (yaz-ztest).

           Rotation can also be implicitly enabled by using a filename which gets changed for a given date, due
           to substitutions as given by the <a href="../man3/strftime.3.html">strftime</a>(3) function.

       -v <u>loglevel</u>
           Specify the logging level. The argument is a set of log level names, separated by commas (no
           whitespace!), optionally preceded by a '-' to negate that level. Most programs have their own
           default, often containing fatal,warn,log, and some application-specific values. The default list can
           be cleared with the word none, or individual bits can be removed by prefixing them with a dash '-'.

</pre><h4><b>LOG</b> <b>LEVELS</b> <b>TO</b> <b>CONTROL</b> <b>LOGGING</b></h4><pre>
       Some of the log levels control the way the log is written.

       flush causes the log to be flushed after every write. This can have serious implications to performance,
       and should not be used in production. On the other hand, when debugging a program crash, this can be
       extremely useful. The option debug implies flush as well.

       notime prevents the writing of time stamps. This is intended for automatic test scripts, which should
       produce predictable log files that are easy to compare.

</pre><h4><b>GENERAL</b> <b>LOG</b> <b>LEVELS</b> <b>IN</b> <b>YAZ</b> <b>ITSELF</b></h4><pre>
       YAZ itself uses the following log levels:

       fatal for fatal errors, that prevent further execution of the program.

       warn for warnings about things that should be corrected.

       debug for debugging. This flag may be used temporarily when developing or debugging yaz, or a program
       that uses yaz. It is practically deprecated, you should be defining and using your own log levels (see
       below).

       all turns on almost all hard-coded log levels.

       loglevel logs information about the log levels used by the program. Every time the log level is changed,
       lists all bits that are on. Every time a module asks for its log bits, this is logged. This can be used
       for getting an idea of what log levels are available in any program that uses yaz-log. Start the program
       with -v none,loglevel, and do some common operations with it. Another way is to grep for
       <b>yaz_log_module_level</b> in the source code, as in

                 find . -name '*.[ch]' -print |
                    xargs grep yaz_log_module_level |
                    grep '"' |
                    cut -d'"' -f2 |
                    sort -u

       eventl, malloc, nmem, odr are used internally for debugging yaz.

</pre><h4><b>LOG</b> <b>LEVELS</b> <b>FOR</b> <b>CLIENTS</b></h4><pre>
       zoom logs the calls to the zoom API, which may be useful in debugging client applications.

</pre><h4><b>LOG</b> <b>LEVELS</b> <b>FOR</b> <b>SERVERS</b></h4><pre>
       server logs the server functions on a high level, starting up, listening on a port, etc.

       session logs individual sessions (connections).

       request logs a one-liner for each request (init, search, etc.).

       requestdetail logs the details of every request, before it is passed to the back-end, and the results
       received from it.

       Each server program (zebra, etc.) is supposed to define its own log levels in addition to these. As they
       depend on the server in question, they can not be described here. See above how to find out about them.

</pre><h4><b>LOGGING</b> <b>EXAMPLES</b></h4><pre>
       See what log levels yaz-ztest is using:

               yaz-ztest -1 -v none,loglevel
               14:43:29-23/11 [loglevel] Setting log level to 4096 = 0x00001000
               14:43:29-23/11 [loglevel] Static  log bit 00000001 'fatal' is off
               14:43:29-23/11 [loglevel] Static  log bit 00000002 'debug' is off
               14:43:29-23/11 [loglevel] Static  log bit 00000004 'warn' is off
               14:43:29-23/11 [loglevel] Static  log bit 00000008 'log' is off
               14:43:29-23/11 [loglevel] Static  log bit 00000080 'malloc' is off
               14:43:29-23/11 [loglevel] Static  log bit 00000800 'flush' is off
               14:43:29-23/11 [loglevel] Static  log bit 00001000 'loglevel' is ON
               14:43:29-23/11 [loglevel] Static  log bit 00002000 'server' is off
               14:43:29-23/11 [loglevel] Dynamic log bit 00004000 'session' is off
               14:43:29-23/11 [loglevel] Dynamic log bit 00008000 'request' is off
               14:44:13-23/11 yaz-ztest [loglevel] returning log bit 0x4000 for 'session'
               14:44:13-23/11 yaz-ztest [loglevel] returning log bit 0x2000 for 'server'
               14:44:13-23/11 yaz-ztest [loglevel] returning NO log bit for 'eventl'
               14:44:20-23/11 yaz-ztest [loglevel] returning log bit 0x4000 for 'session'
               14:44:20-23/11 yaz-ztest [loglevel] returning log bit 0x8000 for 'request'
               14:44:20-23/11 yaz-ztest [loglevel] returning NO log bit for 'requestdetail'
               14:44:20-23/11 yaz-ztest [loglevel] returning NO log bit for 'odr'
               14:44:20-23/11 yaz-ztest [loglevel] returning NO log bit for 'ztest'

       See the details of the requests for yaz-ztest

              ./yaz-ztest -1 -v requestdetail
              14:45:35-23/11 yaz-ztest [server] Adding static Z3950 listener on tcp:@:9999
              14:45:35-23/11 yaz-ztest [server] Starting server ./yaz-ztest pid=32200
              14:45:38-23/11 yaz-ztest [session] Starting session from tcp:127.0.0.1 (pid=32200)
              14:45:38-23/11 yaz-ztest [requestdetail] Got initRequest
              14:45:38-23/11 yaz-ztest [requestdetail] Id:        81
              14:45:38-23/11 yaz-ztest [requestdetail] Name:      YAZ
              14:45:38-23/11 yaz-ztest [requestdetail] Version:   2.0.28
              14:45:38-23/11 yaz-ztest [requestdetail] Negotiated to v3: srch prst del extendedServices namedresults scan sort
              14:45:38-23/11 yaz-ztest [request] Init from 'YAZ' (81) (ver 2.0.28) OK
              14:45:39-23/11 yaz-ztest [requestdetail] Got SearchRequest.
              14:45:39-23/11 yaz-ztest [requestdetail] ResultSet '1'
              14:45:39-23/11 yaz-ztest [requestdetail] Database 'Default'
              14:45:39-23/11 yaz-ztest [requestdetail] RPN query. Type: Bib-1
              14:45:39-23/11 yaz-ztest [requestdetail]  term 'foo' (general)
              14:45:39-23/11 yaz-ztest [requestdetail] resultCount: 7
              14:45:39-23/11 yaz-ztest [request] Search Z: @attrset Bib-1 foo  OK:7 hits
              14:45:41-23/11 yaz-ztest [requestdetail] Got PresentRequest.
              14:45:41-23/11 yaz-ztest [requestdetail] Request to pack 1+1 1
              14:45:41-23/11 yaz-ztest [requestdetail] pms=1048576, mrs=1048576
              14:45:41-23/11 yaz-ztest [request] Present: [1] 1+1  OK 1 records returned

</pre><h4><b>LOG</b> <b>FILENAME</b> <b>EXAMPLES</b></h4><pre>
       A file with format my_YYYYMMDD.log (where Y, M, D is year, month, and day digits) is given as follows: -l
       my_%Y%m%d.log . And since the filename is depending on day, rotation will occur on midnight.

       A weekly log could be specified as -l my_%Y%U.log.

</pre><h4><b>FILES</b></h4><pre>
       <u>prefix</u>/include/yaz/log.h <u>prefix</u>/src/log.c

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/yaz.7.html">yaz</a></b>(7) <b><a href="../man8/yaz-ztest.8.html">yaz-ztest</a></b>(8) <b><a href="../man1/yaz-client.1.html">yaz-client</a></b>(1) <b><a href="../man3/strftime.3.html">strftime</a></b>(3)

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>Index</b> <b>Data</b>

YAZ 5.34.4                                         05/21/2025                                         <u><a href="../man7/YAZ-LOG.7.html">YAZ-LOG</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>