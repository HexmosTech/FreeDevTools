<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>provider-cipher - The cipher library <-> provider functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       provider-cipher - The cipher library &lt;-&gt; provider functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/core_dispatch.h&gt;
        #include &lt;openssl/core_names.h&gt;

        /*
         * None of these are actual functions, but are displayed like this for
         * the function signatures for functions that are offered as function
         * pointers in OSSL_DISPATCH arrays.
         */

        /* Context management */
        void *OSSL_FUNC_cipher_newctx(void *provctx);
        void OSSL_FUNC_cipher_freectx(void *cctx);
        void *OSSL_FUNC_cipher_dupctx(void *cctx);

        /* Encryption/decryption */
        int OSSL_FUNC_cipher_encrypt_init(void *cctx, const unsigned char *key,
                                          size_t keylen, const unsigned char *iv,
                                          size_t ivlen, const OSSL_PARAM params[]);
        int OSSL_FUNC_cipher_decrypt_init(void *cctx, const unsigned char *key,
                                          size_t keylen, const unsigned char *iv,
                                          size_t ivlen, const OSSL_PARAM params[]);
        int OSSL_FUNC_cipher_encrypt_skey_init(void *cctx, void *skeydata,
                                               const unsigned char *iv, size_t ivlen,
                                               const OSSL_PARAM params[]);
        int OSSL_FUNC_cipher_encrypt_skey_init(void *cctx, void *skeydata,
                                               const unsigned char *iv, size_t ivlen,
                                               const OSSL_PARAM params[]);
        int OSSL_FUNC_cipher_update(void *cctx, unsigned char *out, size_t *outl,
                                    size_t outsize, const unsigned char *in, size_t inl);
        int OSSL_FUNC_cipher_final(void *cctx, unsigned char *out, size_t *outl,
                                   size_t outsize);
        int OSSL_FUNC_cipher_cipher(void *cctx, unsigned char *out, size_t *outl,
                                    size_t outsize, const unsigned char *in, size_t inl);

        /* Encryption/decryption using cipher pipeline */
        int OSSL_FUNC_cipher_pipeline_encrypt_init(void *cctx, const unsigned char *key,
                                                   size_t keylen, size_t numpipes,
                                                   const unsigned char **iv, size_t ivlen,
                                                   const OSSL_PARAM params[]))
        int OSSL_FUNC_cipher_pipeline_decrypt_init(void *cctx, const unsigned char *key,
                                                   size_t keylen, size_t numpipes,
                                                   const unsigned char **iv, size_t ivlen,
                                                   const OSSL_PARAM params[]))
        int OSSL_FUNC_cipher_pipeline_update(void *cctx, size_t numpipes,
                                             unsigned char **out, size_t *outl,
                                             const size_t *outsize,
                                             const unsigned char **in, const size_t *inl))
        int OSSL_FUNC_cipher_pipeline_final(void *cctx, size_t numpipes,
                                            unsigned char **out, size_t *outl,
                                            const size_t *outsize))

        /* Cipher parameter descriptors */
        const OSSL_PARAM *OSSL_FUNC_cipher_gettable_params(void *provctx);

        /* Cipher operation parameter descriptors */
        const OSSL_PARAM *OSSL_FUNC_cipher_gettable_ctx_params(void *cctx,
                                                               void *provctx);
        const OSSL_PARAM *OSSL_FUNC_cipher_settable_ctx_params(void *cctx,
                                                               void *provctx);

        /* Cipher parameters */
        int OSSL_FUNC_cipher_get_params(OSSL_PARAM params[]);

        /* Cipher operation parameters */
        int OSSL_FUNC_cipher_get_ctx_params(void *cctx, OSSL_PARAM params[]);
        int OSSL_FUNC_cipher_set_ctx_params(void *cctx, const OSSL_PARAM params[]);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This documentation is primarily aimed at provider authors. See <b><a href="../man7/provider.7.html">provider</a></b>(7) for further information.

       The CIPHER operation enables providers to implement cipher algorithms and make them available to
       applications via the API functions <b><a href="../man3/EVP_EncryptInit_ex.3.html">EVP_EncryptInit_ex</a></b>(3), <b><a href="../man3/EVP_EncryptUpdate.3.html">EVP_EncryptUpdate</a></b>(3) and <b><a href="../man3/EVP_EncryptFinal.3.html">EVP_EncryptFinal</a></b>(3)
       (as well as the decrypt equivalents and other related functions).

       All "functions" mentioned here are passed as function pointers between <u>libcrypto</u> and the provider in
       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays via <b><a href="../man3/OSSL_ALGORITHM.3.html">OSSL_ALGORITHM</a></b>(3) arrays that are returned by the provider's
       <b>provider_query_operation()</b> function (see "Provider Functions" in <b><a href="../man7/provider-base.7.html">provider-base</a></b>(7)).

       All these "functions" have a corresponding function type definition named <b>OSSL_FUNC_{name}_fn</b>, and a
       helper function to retrieve the function pointer from an <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) element named <b>OSSL_FUNC_{name}</b>.
       For example, the "function" <b>OSSL_FUNC_cipher_newctx()</b> has these:

        typedef void *(OSSL_FUNC_cipher_newctx_fn)(void *provctx);
        static ossl_inline OSSL_FUNC_cipher_newctx_fn
            OSSL_FUNC_cipher_newctx(const OSSL_DISPATCH *opf);

       <b><a href="../man3/OSSL_DISPATCH.3.html">OSSL_DISPATCH</a></b>(3) arrays are indexed by numbers that are provided as macros in <b><a href="../man7/openssl-core_dispatch.h.7.html">openssl-core_dispatch.h</a></b>(7),
       as follows:

        OSSL_FUNC_cipher_newctx                    OSSL_FUNC_CIPHER_NEWCTX
        OSSL_FUNC_cipher_freectx                   OSSL_FUNC_CIPHER_FREECTX
        OSSL_FUNC_cipher_dupctx                    OSSL_FUNC_CIPHER_DUPCTX

        OSSL_FUNC_cipher_encrypt_init              OSSL_FUNC_CIPHER_ENCRYPT_INIT
        OSSL_FUNC_cipher_decrypt_init              OSSL_FUNC_CIPHER_DECRYPT_INIT
        OSSL_FUNC_cipher_encrypt_skey_init         OSSL_FUNC_CIPHER_ENCRYPT_SKEY_INIT
        OSSL_FUNC_cipher_decrypt_skey_init         OSSL_FUNC_CIPHER_DECRYPT_SKEY_INIT
        OSSL_FUNC_cipher_update                    OSSL_FUNC_CIPHER_UPDATE
        OSSL_FUNC_cipher_final                     OSSL_FUNC_CIPHER_FINAL
        OSSL_FUNC_cipher_cipher                    OSSL_FUNC_CIPHER_CIPHER

        OSSL_FUNC_cipher_pipeline_encrypt_init     OSSL_FUNC_CIPHER_PIPELINE_ENCRYPT_INIT
        OSSL_FUNC_cipher_pipeline_decrypt_init     OSSL_FUNC_CIPHER_PIPELINE_DECRYPT_INIT
        OSSL_FUNC_cipher_pipeline_update           OSSL_FUNC_CIPHER_PIPELINE_UPDATE
        OSSL_FUNC_cipher_pipeline_final            OSSL_FUNC_CIPHER_PIPELINE_FINAL

        OSSL_FUNC_cipher_get_params                OSSL_FUNC_CIPHER_GET_PARAMS
        OSSL_FUNC_cipher_get_ctx_params            OSSL_FUNC_CIPHER_GET_CTX_PARAMS
        OSSL_FUNC_cipher_set_ctx_params            OSSL_FUNC_CIPHER_SET_CTX_PARAMS

        OSSL_FUNC_cipher_gettable_params           OSSL_FUNC_CIPHER_GETTABLE_PARAMS
        OSSL_FUNC_cipher_gettable_ctx_params       OSSL_FUNC_CIPHER_GETTABLE_CTX_PARAMS
        OSSL_FUNC_cipher_settable_ctx_params       OSSL_FUNC_CIPHER_SETTABLE_CTX_PARAMS

       A cipher algorithm implementation may not implement all of these functions.  In order to be a consistent
       set of functions there must at least be a complete set of "encrypt" functions, or a complete set of
       "decrypt" functions, or a single "cipher" function. Similarly, there can be a complete set of pipeline
       "encrypt" functions, and/or a complete set of pipeline "decrypt" functions.  In all cases both the
       OSSL_FUNC_cipher_newctx and OSSL_FUNC_cipher_freectx functions must be present.  All other functions are
       optional.

   <b>Context</b> <b>Management</b> <b>Functions</b>
       <b>OSSL_FUNC_cipher_newctx()</b> should create and return a pointer to a provider side structure for holding
       context information during a cipher operation.  A pointer to this context will be passed back in a number
       of the other cipher operation function calls.  The parameter <u>provctx</u> is the provider context generated
       during provider initialisation (see <b><a href="../man7/provider.7.html">provider</a></b>(7)).

       <b>OSSL_FUNC_cipher_freectx()</b> is passed a pointer to the provider side cipher context in the <u>cctx</u> parameter.
       This function should free any resources associated with that context.

       <b>OSSL_FUNC_cipher_dupctx()</b> should duplicate the provider side cipher context in the <u>cctx</u> parameter and
       return the duplicate copy.

   <b>Encryption/Decryption</b> <b>Functions</b>
       <b>OSSL_FUNC_cipher_encrypt_init()</b> initialises a cipher operation for encryption given a newly created
       provider side cipher context in the <u>cctx</u> parameter.  The key to be used is given in <u>key</u> which is <u>keylen</u>
       bytes long.  The IV to be used is given in <u>iv</u> which is <u>ivlen</u> bytes long.  The <u>params</u>, if not NULL, should
       be set on the context in a manner similar to using <b>OSSL_FUNC_cipher_set_ctx_params()</b>.

       <b>OSSL_FUNC_cipher_decrypt_init()</b> is the same as <b>OSSL_FUNC_cipher_encrypt_init()</b> except that it initialises
       the context for a decryption operation.

       <b>OSSL_FUNC_cipher_encrypt_skey_init()</b> and <b>OSSL_FUNC_cipher_decrypt_skey_init()</b> are variants of
       <b>OSSL_FUNC_cipher_encrypt_init()</b> and <b>OSSL_FUNC_cipher_decrypt_init()</b> for working with opaque objects
       containing provider-specific key handles instead of raw bytes.

       <b>OSSL_FUNC_cipher_update()</b> is called to supply data to be encrypted/decrypted as part of a previously
       initialised cipher operation.  The <u>cctx</u> parameter contains a pointer to a previously initialised provider
       side context.  <b>OSSL_FUNC_cipher_update()</b> should encrypt/decrypt <u>inl</u> bytes of data at the location pointed
       to by <u>in</u>.  The encrypted data should be stored in <u>out</u> and the amount of data written to <u>*outl</u> which
       should not exceed <u>outsize</u> bytes.  <b>OSSL_FUNC_cipher_update()</b> may be called multiple times for a single
       cipher operation.  It is the responsibility of the cipher implementation to handle input lengths that are
       not multiples of the block length.  In such cases a cipher implementation will typically cache partial
       blocks of input data until a complete block is obtained.  The pointers <u>out</u> and <u>in</u> may point to the same
       location, in which case the encryption must be done in-place. If <u>out</u> and <u>in</u> point to different locations,
       the requirements of <b><a href="../man3/EVP_EncryptUpdate.3.html">EVP_EncryptUpdate</a></b>(3) and <b><a href="../man3/EVP_DecryptUpdate.3.html">EVP_DecryptUpdate</a></b>(3) guarantee that the two buffers are
       disjoint.  Similarly, the requirements of <b><a href="../man3/EVP_EncryptUpdate.3.html">EVP_EncryptUpdate</a></b>(3) and <b><a href="../man3/EVP_DecryptUpdate.3.html">EVP_DecryptUpdate</a></b>(3) ensure that the
       buffer pointed to by <u>out</u> contains sufficient room for the operation being performed.

       <b>OSSL_FUNC_cipher_final()</b> completes an encryption or decryption started through previous
       <b>OSSL_FUNC_cipher_encrypt_init()</b> or <b>OSSL_FUNC_cipher_decrypt_init()</b>, and <b>OSSL_FUNC_cipher_update()</b> calls.
       The <u>cctx</u> parameter contains a pointer to the provider side context.  Any final encryption/decryption
       output should be written to <u>out</u> and the amount of data written to <u>*outl</u> which should not exceed <u>outsize</u>
       bytes.  The same expectations apply to <u>outsize</u> as documented for <b><a href="../man3/EVP_EncryptFinal.3.html">EVP_EncryptFinal</a></b>(3) and
       <b><a href="../man3/EVP_DecryptFinal.3.html">EVP_DecryptFinal</a></b>(3).

       <b>OSSL_FUNC_cipher_cipher()</b> performs encryption/decryption using the provider side cipher context in the
       <u>cctx</u> parameter that should have been previously initialised via a call to <b>OSSL_FUNC_cipher_encrypt_init()</b>
       or <b>OSSL_FUNC_cipher_decrypt_init()</b>.  This should call the raw underlying cipher function without any
       padding.  This will be invoked in the provider as a result of the application calling <b><a href="../man3/EVP_Cipher.3.html">EVP_Cipher</a></b>(3).  The
       application is responsible for ensuring that the input is a multiple of the block length.  The data to be
       encrypted/decrypted will be in <u>in</u>, and it will be <u>inl</u> bytes in length.  The output from the
       encryption/decryption should be stored in <u>out</u> and the amount of data stored should be put in <u>*outl</u> which
       should be no more than <u>outsize</u> bytes.

       <b>OSSL_FUNC_cipher_pipeline_encrypt_init()</b>, <b>OSSL_FUNC_cipher_pipeline_decrypt_init()</b>
       <b>OSSL_FUNC_cipher_pipeline_update()</b>, and <b>OSSL_FUNC_cipher_pipeline_final()</b> are similar to the non-pipeline
       variants, but are used when the application is using cipher pipelining.  The <u>numpipes</u> parameter is the
       number of pipes in the pipeline. The <u>iv</u> parameter is an array of buffers with IVs, each <u>ivlen</u> bytes long.
       The <u>in</u> and <u>out</u> are arrays of buffer pointers. The <u>inl</u> and <u>outl</u>, <u>outsize</u> are arrays of size_t representing
       corresponding buffer length as similar to the non-pipeline variants.  All arrays are of length <u>numpipes</u>.
       See <b><a href="../man3/EVP_CipherPipelineEncryptInit.3.html">EVP_CipherPipelineEncryptInit</a></b>(3) for more information.

   <b>Cipher</b> <b>Parameters</b>
       See <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details on the parameters structure used by these functions.

       <b>OSSL_FUNC_cipher_get_params()</b> gets details of the algorithm implementation and stores them in <u>params</u>.

       <b>OSSL_FUNC_cipher_set_ctx_params()</b> sets cipher operation parameters for the provider side cipher context
       <u>cctx</u> to <u>params</u>.  Any parameter settings are additional to any that were previously set.  Passing NULL for
       <u>params</u> should return true.

       <b>OSSL_FUNC_cipher_get_ctx_params()</b> gets cipher operation details details from the given provider side
       cipher context <u>cctx</u> and stores them in <u>params</u>.  Passing NULL for <u>params</u> should return true.

       <b>OSSL_FUNC_cipher_gettable_params()</b>, <b>OSSL_FUNC_cipher_gettable_ctx_params()</b>, and
       <b>OSSL_FUNC_cipher_settable_ctx_params()</b> all return constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) arrays as descriptors of the
       parameters that <b>OSSL_FUNC_cipher_get_params()</b>, <b>OSSL_FUNC_cipher_get_ctx_params()</b>, and
       <b>OSSL_FUNC_cipher_set_ctx_params()</b> can handle, respectively.  <b>OSSL_FUNC_cipher_gettable_ctx_params()</b> and
       <b>OSSL_FUNC_cipher_settable_ctx_params()</b> will return the parameters associated with the provider side
       context <u>cctx</u> in its current state if it is not NULL.  Otherwise, they return the parameters associated
       with the provider side algorithm <u>provctx</u>.

       Parameters currently recognised by built-in ciphers are listed in "PARAMETERS" in <b><a href="../man3/EVP_EncryptInit.3.html">EVP_EncryptInit</a></b>(3).
       Not all parameters are relevant to, or are understood by all ciphers.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OSSL_FUNC_cipher_newctx()</b> and <b>OSSL_FUNC_cipher_dupctx()</b> should return the newly created provider side
       cipher context, or NULL on failure.

       <b>OSSL_FUNC_cipher_encrypt_init()</b>, <b>OSSL_FUNC_cipher_decrypt_init()</b>, <b>OSSL_FUNC_cipher_update()</b>,
       <b>OSSL_FUNC_cipher_final()</b>, <b>OSSL_FUNC_cipher_cipher()</b>, <b>OSSL_FUNC_cipher_encrypt_skey_init()</b>,
       <b>OSSL_FUNC_cipher_decrypt_skey_init()</b>, <b>OSSL_FUNC_cipher_pipeline_encrypt_init()</b>,
       <b>OSSL_FUNC_cipher_pipeline_decrypt_init()</b>, <b>OSSL_FUNC_cipher_pipeline_update()</b>,
       <b>OSSL_FUNC_cipher_pipeline_final()</b>, <b>OSSL_FUNC_cipher_get_params()</b>, <b>OSSL_FUNC_cipher_get_ctx_params()</b> and
       <b>OSSL_FUNC_cipher_set_ctx_params()</b> should return 1 for success or 0 on error.

       <b>OSSL_FUNC_cipher_gettable_params()</b>, <b>OSSL_FUNC_cipher_gettable_ctx_params()</b> and
       <b>OSSL_FUNC_cipher_settable_ctx_params()</b> should return a constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array, or NULL if none is
       offered.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/provider.7.html">provider</a></b>(7), <b><a href="../man7/OSSL_PROVIDER-FIPS.7.html">OSSL_PROVIDER-FIPS</a></b>(7), <b><a href="../man7/OSSL_PROVIDER-default.7.html">OSSL_PROVIDER-default</a></b>(7), <b><a href="../man7/OSSL_PROVIDER-legacy.7.html">OSSL_PROVIDER-legacy</a></b>(7), <b><a href="../man7/EVP_CIPHER-AES.7.html">EVP_CIPHER-AES</a></b>(7),
       <b><a href="../man7/EVP_CIPHER-ARIA.7.html">EVP_CIPHER-ARIA</a></b>(7), <b><a href="../man7/EVP_CIPHER-BLOWFISH.7.html">EVP_CIPHER-BLOWFISH</a></b>(7), <b><a href="../man7/EVP_CIPHER-CAMELLIA.7.html">EVP_CIPHER-CAMELLIA</a></b>(7), <b><a href="../man7/EVP_CIPHER-CAST.7.html">EVP_CIPHER-CAST</a></b>(7),
       <b><a href="../man7/EVP_CIPHER-CHACHA.7.html">EVP_CIPHER-CHACHA</a></b>(7), <b><a href="../man7/EVP_CIPHER-DES.7.html">EVP_CIPHER-DES</a></b>(7), <b><a href="../man7/EVP_CIPHER-IDEA.7.html">EVP_CIPHER-IDEA</a></b>(7), <b><a href="../man7/EVP_CIPHER-RC2.7.html">EVP_CIPHER-RC2</a></b>(7), <b><a href="../man7/EVP_CIPHER-RC4.7.html">EVP_CIPHER-RC4</a></b>(7),
       <b><a href="../man7/EVP_CIPHER-RC5.7.html">EVP_CIPHER-RC5</a></b>(7), <b><a href="../man7/EVP_CIPHER-SEED.7.html">EVP_CIPHER-SEED</a></b>(7), <b><a href="../man7/EVP_CIPHER-SM4.7.html">EVP_CIPHER-SM4</a></b>(7), <b><a href="../man7/EVP_CIPHER-NULL.7.html">EVP_CIPHER-NULL</a></b>(7), <b><a href="../man7/life_cycle-cipher.7.html">life_cycle-cipher</a></b>(7),
       <b><a href="../man3/EVP_EncryptInit.3.html">EVP_EncryptInit</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The provider CIPHER interface was introduced in OpenSSL 3.0.

       The <b>OSSL_FUNC_cipher_encrypt_skey_init()</b> and <b>OSSL_FUNC_cipher_decrypt_skey_init()</b> were introduced in
       OpenSSL 3.5.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                              <u><a href="../man7SSL/PROVIDER-CIPHER.7SSL.html">PROVIDER-CIPHER</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>