<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>provider-rand - The random number generation library <-> provider functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       provider-rand - The random number generation library &lt;-&gt; provider functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/core_dispatch.h&gt;
        #include &lt;openssl/core_names.h&gt;

        /*
         * None of these are actual functions, but are displayed like this for
         * the function signatures for functions that are offered as function
         * pointers in OSSL_DISPATCH arrays.
         */

        /* Context management */
        void *OSSL_FUNC_rand_newctx(void *provctx, void *parent,
                                    const OSSL_DISPATCH *parent_calls);
        void OSSL_FUNC_rand_freectx(void *ctx);

        /* Random number generator functions: NIST */
        int OSSL_FUNC_rand_instantiate(void *ctx, unsigned int strength,
                                       int prediction_resistance,
                                       const unsigned char *pstr, size_t pstr_len,
                                       const OSSL_PARAM params[]);
        int OSSL_FUNC_rand_uninstantiate(void *ctx);
        int OSSL_FUNC_rand_generate(void *ctx, unsigned char *out, size_t outlen,
                                    unsigned int strength, int prediction_resistance,
                                    const unsigned char *addin, size_t addin_len);
        int OSSL_FUNC_rand_reseed(void *ctx, int prediction_resistance,
                                  const unsigned char *ent, size_t ent_len,
                                  const unsigned char *addin, size_t addin_len);

        /* Random number generator functions: additional */
        size_t OSSL_FUNC_rand_nonce(void *ctx, unsigned char *out, size_t outlen,
                                    int strength, size_t min_noncelen,
                                    size_t max_noncelen);
        size_t OSSL_FUNC_rand_get_seed(void *ctx, unsigned char **buffer,
                                       int entropy, size_t min_len, size_t max_len,
                                       int prediction_resistance,
                                       const unsigned char *adin, size_t adin_len);
        void OSSL_FUNC_rand_clear_seed(void *ctx, unsigned char *buffer, size_t b_len);
        int OSSL_FUNC_rand_verify_zeroization(void *ctx);

        /* Context Locking */
        int OSSL_FUNC_rand_enable_locking(void *ctx);
        int OSSL_FUNC_rand_lock(void *ctx);
        void OSSL_FUNC_rand_unlock(void *ctx);

        /* RAND parameter descriptors */
        const OSSL_PARAM *OSSL_FUNC_rand_gettable_params(void *provctx);
        const OSSL_PARAM *OSSL_FUNC_rand_gettable_ctx_params(void *ctx, void *provctx);
        const OSSL_PARAM *OSSL_FUNC_rand_settable_ctx_params(void *ctx, void *provctx);

        /* RAND parameters */
        int OSSL_FUNC_rand_get_params(OSSL_PARAM params[]);
        int OSSL_FUNC_rand_get_ctx_params(void *ctx, OSSL_PARAM params[]);
        int OSSL_FUNC_rand_set_ctx_params(void *ctx, const OSSL_PARAM params[]);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This documentation is primarily aimed at provider authors. See <b><a href="../man7/provider.7.html">provider</a></b>(7) for further information.

       The RAND operation enables providers to implement random number generation algorithms and random number
       sources and make them available to applications via the API function <b><a href="../man3/EVP_RAND.3.html">EVP_RAND</a></b>(3).

   <b>Context</b> <b>Management</b> <b>Functions</b>
       <b>OSSL_FUNC_rand_newctx()</b> should create and return a pointer to a provider side structure for holding
       context information during a rand operation.  A pointer to this context will be passed back in a number
       of the other rand operation function calls.  The parameter <u>provctx</u> is the provider context generated
       during provider initialisation (see <b><a href="../man7/provider.7.html">provider</a></b>(7)).  The parameter <u>parent</u> specifies another rand instance
       to be used for seeding purposes.  If NULL and the specific instance supports it, the operating system
       will be used for seeding.  The parameter <u>parent_calls</u> points to the dispatch table for <u>parent</u>.  Thus, the
       parent need not be from the same provider as the new instance.

       <b>OSSL_FUNC_rand_freectx()</b> is passed a pointer to the provider side rand context in the <u>mctx</u> parameter.  If
       it receives NULL as <u>ctx</u> value, it should not do anything other than return.  This function should free
       any resources associated with that context.

   <b>Random</b> <b>Number</b> <b>Generator</b> <b>Functions:</b> <b>NIST</b>
       These functions correspond to those defined in NIST SP 800-90A and SP 800-90C.

       <b>OSSL_FUNC_rand_instantiate()</b> is used to instantiate the DRBG <u>ctx</u> at a requested security <u>strength</u>.  In
       addition, <u>prediction_resistance</u> can be requested.  Additional input <u>addin</u> of length <u>addin_len</u> bytes can
       optionally be provided.  The parameters specified in <u>params</u> configure the DRBG and these should be
       processed before instantiation.

       <b>OSSL_FUNC_rand_uninstantiate()</b> is used to uninstantiate the DRBG <u>ctx</u>.  After being uninstantiated, a DRBG
       is unable to produce output until it is instantiated anew.

       <b>OSSL_FUNC_rand_generate()</b> is used to generate random bytes from the DRBG <u>ctx</u>.  It will generate <u>outlen</u>
       bytes placing them into the buffer pointed to by <u>out</u>.  The generated bytes will meet the specified
       security <u>strength</u> and, if <u>prediction_resistance</u> is true, the bytes will be produced after reseeding from
       a live entropy source.  Additional input <u>addin</u> of length <u>addin_len</u> bytes can optionally be provided.

   <b>Random</b> <b>Number</b> <b>Generator</b> <b>Functions:</b> <b>Additional</b>
       <b>OSSL_FUNC_rand_nonce()</b> is used to generate a nonce of the given <u>strength</u> with a length from <u>min_noncelen</u>
       to <u>max_noncelen</u>. If the output buffer <u>out</u> is NULL, the length of the nonce should be returned.

       <b>OSSL_FUNC_rand_get_seed()</b> is used by deterministic generators to obtain their seeding material from their
       parent.  The seed bytes will meet the specified security level of <u>entropy</u> bits and there will be between
       <u>min_len</u> and <u>max_len</u> inclusive bytes in total.  If <u>prediction_resistance</u> is true, the bytes will be
       produced from a live entropy source.  Additional input <u>addin</u> of length <u>addin_len</u> bytes can optionally be
       provided.  A pointer to the seed material is returned in <u>*buffer</u> and this must be freed by a later call
       to <b>OSSL_FUNC_rand_clear_seed()</b>.

       <b>OSSL_FUNC_rand_clear_seed()</b> frees a seed <u>buffer</u> of length <u>b_len</u> bytes which was previously allocated by
       <b>OSSL_FUNC_rand_get_seed()</b>.

       <b>OSSL_FUNC_rand_verify_zeroization()</b> is used to determine if the internal state of the DRBG is zero.  This
       capability is mandated by NIST as part of the self tests, it is unlikely to be useful in other
       circumstances.

   <b>Context</b> <b>Locking</b>
       When DRBGs are used by multiple threads, there must be locking employed to ensure their proper operation.
       Because locking introduces an overhead, it is disabled by default.

       <b>OSSL_FUNC_rand_enable_locking()</b> allows locking to be turned on for a DRBG and all of its parent DRBGs.
       From this call onwards, the DRBG can be used in a thread safe manner.

       <b>OSSL_FUNC_rand_lock()</b> is used to lock a DRBG.  Once locked, exclusive access is guaranteed.

       <b>OSSL_FUNC_rand_unlock()</b> is used to unlock a DRBG.

   <b>Rand</b> <b>Parameters</b>
       See <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) for further details on the parameters structure used by these functions.

       <b>OSSL_FUNC_rand_get_params()</b> gets details of parameter values associated with the provider algorithm and
       stores them in <u>params</u>.

       <b>OSSL_FUNC_rand_set_ctx_params()</b> sets rand parameters associated with the given provider side rand context
       <u>ctx</u> to <u>params</u>.  Any parameter settings are additional to any that were previously set.  Passing NULL for
       <u>params</u> should return true.

       <b>OSSL_FUNC_rand_get_ctx_params()</b> gets details of currently set parameter values associated with the given
       provider side rand context <u>ctx</u> and stores them in <u>params</u>.  Passing NULL for <u>params</u> should return true.

       <b>OSSL_FUNC_rand_gettable_params()</b>, <b>OSSL_FUNC_rand_gettable_ctx_params()</b>, and
       <b>OSSL_FUNC_rand_settable_ctx_params()</b> all return constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) arrays as descriptors of the
       parameters that <b>OSSL_FUNC_rand_get_params()</b>, <b>OSSL_FUNC_rand_get_ctx_params()</b>, and
       <b>OSSL_FUNC_rand_set_ctx_params()</b> can handle, respectively.  <b>OSSL_FUNC_rand_gettable_ctx_params()</b> and
       <b>OSSL_FUNC_rand_settable_ctx_params()</b> will return the parameters associated with the provider side context
       <u>ctx</u> in its current state if it is not NULL.  Otherwise, they return the parameters associated with the
       provider side algorithm <u>provctx</u>.

       Parameters currently recognised by built-in rands are as follows. Not all parameters are relevant to, or
       are understood by all rands:

       "state" (<b>OSSL_RAND_PARAM_STATE</b>) &lt;integer&gt;
           Returns the state of the random number generator.

       "strength" (<b>OSSL_RAND_PARAM_STRENGTH</b>) &lt;unsigned integer&gt;
           Returns the bit strength of the random number generator.

       "fips-indicator" (<b>OSSL_RAND_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           A  getter  that  returns 1 if the operation is FIPS approved, or 0 otherwise.  This option is used by
           the OpenSSL FIPS provider and is not supported by all EVP_RAND sources.

       For rands that are also deterministic random bit generators  (DRBGs),  these  additional  parameters  are
       recognised. Not all parameters are relevant to, or are understood by all DRBG rands:

       "reseed_requests" (<b>OSSL_DRBG_PARAM_RESEED_REQUESTS</b>) &lt;unsigned integer&gt;
           Reads or set the number of generate requests before reseeding the associated RAND ctx.

       "reseed_time_interval" (<b>OSSL_DRBG_PARAM_RESEED_TIME_INTERVAL</b>) &lt;integer&gt;
           Reads or set the number of elapsed seconds before reseeding the associated RAND ctx.

       "max_request" (<b>OSSL_DRBG_PARAM_RESEED_REQUESTS</b>) &lt;unsigned integer&gt;
           Specifies   the   maximum   number   of   bytes   that   can   be  generated  in  a  single  call  to
           OSSL_FUNC_rand_generate.

       "min_entropylen" (<b>OSSL_DRBG_PARAM_MIN_ENTROPYLEN</b>) &lt;unsigned integer&gt;
       "max_entropylen" (<b>OSSL_DRBG_PARAM_MAX_ENTROPYLEN</b>) &lt;unsigned integer&gt;
           Specify the minimum and maximum number of bytes of random material that can be used to seed the DRBG.

       "min_noncelen" (<b>OSSL_DRBG_PARAM_MIN_NONCELEN</b>) &lt;unsigned integer&gt;
       "max_noncelen" (<b>OSSL_DRBG_PARAM_MAX_NONCELEN</b>) &lt;unsigned integer&gt;
           Specify the minimum and maximum number of bytes of nonce that can be used to instantiate the DRBG.

       "max_perslen" (<b>OSSL_DRBG_PARAM_MAX_PERSLEN</b>) &lt;unsigned integer&gt;
       "max_adinlen" (<b>OSSL_DRBG_PARAM_MAX_ADINLEN</b>) &lt;unsigned integer&gt;
           Specify the minimum and maximum number of bytes of personalisation string that can be used  with  the
           DRBG.

       "reseed_counter" (<b>OSSL_DRBG_PARAM_RESEED_COUNTER</b>) &lt;unsigned integer&gt;
           Specifies the number of times the DRBG has been seeded or reseeded.

       "digest" (<b>OSSL_DRBG_PARAM_DIGEST</b>) &lt;UTF8 string&gt;
       "cipher" (<b>OSSL_DRBG_PARAM_CIPHER</b>) &lt;UTF8 string&gt;
       "mac" (<b>OSSL_DRBG_PARAM_MAC</b>) &lt;UTF8 string&gt;
           Sets  the name of the underlying cipher, digest or MAC to be used.  It must name a suitable algorithm
           for the DRBG that's being used.

       "properties" (<b>OSSL_DRBG_PARAM_PROPERTIES</b>) &lt;UTF8 string&gt;
           Sets the properties to be queried when trying to fetch an underlying algorithm.  This must  be  given
           together with the algorithm naming parameter to be considered valid.

       The OpenSSL FIPS provider also supports the following parameters:

       "fips-indicator" (<b>OSSL_DRBG_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           A  getter  that  returns 1 if the operation is FIPS approved, or 0 otherwise.  This may be used after
           calling <b>OSSL_FUNC_rand_generate()</b>. It may return 0 if the "digest-check" is set to 0.

       "digest-check" (<b>OSSL_DRBG_PARAM_FIPS_DIGEST_CHECK</b>) &lt;integer&gt;
           If required this parameter should be set before the digest is set.  The default value of 1 causes  an
           error  when  the  digest  is set if the digest is not FIPS approved (e.g. truncated digests). Setting
           this to 0 will ignore the error and set the approved "fips-indicator" to 0.  This option breaks  FIPS
           compliance if it causes the approved "fips-indicator" to return 0.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OSSL_FUNC_rand_newctx()</b> should return the newly created provider side rand context, or NULL on failure.

       <b>OSSL_FUNC_rand_gettable_params()</b>,                 <b>OSSL_FUNC_rand_gettable_ctx_params()</b>                and
       <b>OSSL_FUNC_rand_settable_ctx_params()</b> should return a constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array, or  NULL  if  none  is
       offered.

       <b>OSSL_FUNC_rand_nonce()</b> returns the size of the generated nonce, or 0 on error.

       <b>OSSL_FUNC_rand_get_seed()</b> returns the size of the generated seed, or 0 on error.

       All of the remaining functions should return 1 for success or 0 on error.

</pre><h4><b>NOTES</b></h4><pre>
       The  RAND  life-cycle  is  described  in  <b><a href="../man7/life_cycle-rand.7.html">life_cycle-rand</a></b>(7).   Providers  should ensure that the various
       transitions listed there are supported.  At some point the EVP layer  will  begin  enforcing  the  listed
       transitions.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/provider.7.html">provider</a></b>(7), <b><a href="../man7/RAND.7.html">RAND</a></b>(7), <b><a href="../man7/EVP_RAND.7.html">EVP_RAND</a></b>(7), <b><a href="../man7/life_cycle-rand.7.html">life_cycle-rand</a></b>(7), <b><a href="../man3/EVP_RAND.3.html">EVP_RAND</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The  provider  RAND  interface  was  introduced in OpenSSL 3.0.  The Rand Parameters "fips-indicator" and
       "digest-check" were added in OpenSSL 3.4.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                <u><a href="../man7SSL/PROVIDER-RAND.7SSL.html">PROVIDER-RAND</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>