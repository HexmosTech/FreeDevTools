<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MERGE SET - Merge Slony-I replication sets together</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/slony1-2-doc">slony1-2-doc_2.2.11-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       MERGE SET - Merge Slony-I replication sets together

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>MERGE</b> <b>SET</b> <b>(options);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Merge  a set of tables and sequences into another one. This function is a workaround for the problem that
       it is not possible to add tables/sequences to already-subscribed sets. One may create  a  temporary  set,
       add  the  new objects to that, subscribe all nodes currently subscribed to the other set to this new one,
       and then merge the two together, eliminating the set ID that was being added.

       This operation will refuse to be run if the two sets do not have <u>exactly</u> the same set of subscribers.

       ID = ival
              Unique ID of the set to contain the union of the two formerly separate sets.

       ADD ID = ival
              Unique ID of the set whose objects should be transferred into the above set.

       ORIGIN = ival
              Current origin node for both sets.

       This uses “schemadocmergeset(p_add_id integer, p_set_id integer)” [not available as a man page].

</pre><h4><b>EXAMPLE</b></h4><pre>
            # Assuming that node 1 is the origin of set 999 that has direct subscribers 2 and 3
            SUBSCRIBE SET (ID = 999, PROVIDER = 1, RECEIVER = 2);
            SUBSCRIBE SET (ID = 999, PROVIDER = 1, RECEIVER = 3);
            MERGE SET ( ID = 1, ADD ID = 999, ORIGIN = 1 );

</pre><h4><b>LOCKING</b> <b>BEHAVIOUR</b></h4><pre>
       No application-visible locking should take place.

</pre><h4><b>DANGEROUS/UNINTUITIVE</b> <b>BEHAVIOUR</b></h4><pre>
       Merging takes place based on the configuration on the origin node. If a merge  is  requested  while  sub‐
       scriptions  are  still  being processed, this can cause in-progress subscribers' replication to break, as
       they'll be looking for configuration for this set which the merge request deletes. Do not be too quick to
       merge sets.

</pre><h4><b>SLONIK</b> <b>EVENT</b> <b>CONFIRMATION</b> <b>BEHAVIOUR</b></h4><pre>
       Slonik waits for the command submitted to the previous event node to be confirmed on the specified  event
       node  before  submitting  this command. Slonik will also wait for any in progress subscriptions involving
       the ADD ID to be subscribed before submitting the MERGE SET command.

</pre><h4><b>VERSION</b> <b>INFORMATION</b></h4><pre>
       This command was introduced in Slony-I 1.0.5. In 1.2.1, a race condition was rectified  where  the  merge
       request  would be submitted while subscriptions were still in process on subscribers; it refuses to merge
       before subscriptions are complete.

                                                19 September 2024                            <u>SLONIK</u> <u>MERGE</u> <u><a href="../man7/SET.7.html">SET</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>