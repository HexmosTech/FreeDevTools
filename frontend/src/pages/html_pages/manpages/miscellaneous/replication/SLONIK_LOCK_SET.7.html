<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOCK SET - Guard Slony-I replication set to prepare for MOVE SET</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/slony1-2-doc">slony1-2-doc_2.2.11-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       LOCK SET - Guard Slony-I replication set to prepare for MOVE SET

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>LOCK</b> <b>SET</b> <b>(options);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Guards  a replication set against client application updates in preparation for a <b>SLONIK</b> <b>MOVE</b> <b><a href="../man7/SET.7.html">SET</a></b>(7) com‐
       mand.

       This command must be the first in a possible statement group (<b>try</b>). The reason for this is that it  needs
       to commit the changes made to the tables (adding a special trigger function) before it can wait for every
       concurrent  transaction  to finish. At the same time it cannot hold an open transaction to the same data‐
       base itself since this would result in blocking itself forever.

       Note that this is a locking operation, which means that it can get stuck behind other database activity.

       The operation waits for transaction IDs to advance in order that data is not missed on  the  new  origin.
       Thus,  if  you  have  long-running  transactions running on the source node, this operation will wait for
       those transactions to complete.  Unfortunately, if you have another database on the  same  postmaster  as
       the  origin node, long running transactions on that database will also be considered even though they are
       essentially independent.

       ID = ival
              ID of the set to lock

       ORIGIN = ival
              Node ID of the current set origin

       This uses “schemadoclockset(p_set_id integer)” [not available as a man page].

</pre><h4><b>EXAMPLE</b></h4><pre>
       LOCK SET (
          ID = 1,
          ORIGIN = 3
       );

</pre><h4><b>LOCKING</b> <b>BEHAVIOUR</b></h4><pre>
       Exclusive locks on each replicated table will be taken out on the origin node, and triggers are added  to
       each such table that reject table updates.

</pre><h4><b>SLONIK</b> <b>EVENT</b> <b>CONFIRMATION</b> <b>BEHAVIOUR</b></h4><pre>
       Slonik does not wait for event confirmations before performing this command.

</pre><h4><b>VERSION</b> <b>INFORMATION</b></h4><pre>
       This command was introduced in Slony-I 1.0

                                                19 September 2024                             <u>SLONIK</u> <u>LOCK</u> <u><a href="../man7/SET.7.html">SET</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>