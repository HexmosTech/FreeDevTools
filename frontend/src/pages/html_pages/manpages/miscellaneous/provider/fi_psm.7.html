<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fi_psm - The PSM Fabric Provider</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/libfabric-dev">libfabric-dev_1.17.0-3.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fi_psm - The PSM Fabric Provider

</pre><h4><b>OVERVIEW</b></h4><pre>
       The  <u>psm</u> provider runs over the PSM 1.x interface that is currently supported by the Intel TrueScale Fab‐
       ric.  PSM provides tag-matching message queue functions that are optimized for MPI implementations.   PSM
       also  has  limited Active Message support, which is not officially published but is quite stable and well
       documented in the source code (part of the OFED release).  The <u>psm</u> provider makes use of  both  the  tag-
       matching  message queue functions and the Active Message functions to support a variety of libfabric data
       transfer APIs, including tagged message queue, message queue, RMA, and atomic operations.

       The <u>psm</u> provider can work with the psm2-compat library, which exposes a PSM 1.x interface over the  Intel
       Omni-Path Fabric.

</pre><h4><b>LIMITATIONS</b></h4><pre>
       The  <u>psm</u>  provider  doesn’t  support all the features defined in the libfabric API.  Here are some of the
       limitations:

       Endpoint types
              Only support non-connection based types <u>FI_DGRAM</u> and <u>FI_RDM</u>

       Endpoint capabilities
              Endpoints can support any combination of data transfer capabilities <u>FI_TAGGED</u>, <u>FI_MSG</u>, <u>FI_ATOMICS</u>,
              and <u>FI_RMA</u>.  These capabilities can be further refined by  <u>FI_SEND</u>,  <u>FI_RECV</u>,  <u>FI_READ</u>,  <u>FI_WRITE</u>,
              <u>FI_REMOTE_READ</u>,  and <u>FI_REMOTE_WRITE</u> to limit the direction of operations.  The limitation is that
              no two endpoints can have overlapping receive or RMA target capabilities in any of the above cate‐
              gories.  For example it is fine to have two endpoints with <u>FI_TAGGED</u> | <u>FI_SEND</u>, one endpoint  with
              <u>FI_TAGGED</u>  |  <u>FI_RECV</u>, one endpoint with <u>FI_MSG</u>, one endpoint with <u>FI_RMA</u> | <u>FI_ATOMICS</u>.  But it is
              not allowed to have two endpoints with <u>FI_TAGGED</u>, or two endpoints with <u>FI_RMA</u>.

       <u>FI_MULTI_RECV</u> is supported for non-tagged message queue only.

       Other supported capabilities include <u>FI_TRIGGER</u>.

       Modes  <u>FI_CONTEXT</u> is required for the <u>FI_TAGGED</u> and <u>FI_MSG</u> capabilities.  That means, any request belong‐
              ing to these two categories that generates a completion must pass as the operation context a valid
              pointer to type <u>struct</u> <u>fi_context</u>, and the space referenced by the pointer must  remain  untouched
              until  the  request  has  completed.  If none of <u>FI_TAGGED</u> and <u>FI_MSG</u> is asked for, the <u>FI_CONTEXT</u>
              mode is not required.

       Progress
              The <u>psm</u> provider requires manual progress.  The application is  expected  to  call  <u>fi_cq_read</u>  or
              <u>fi_cntr_read</u>  function  from  time  to  time  when no other libfabric function is called to ensure
              progress is made in a timely manner.  The provider does support auto progress mode.  However,  the
              performance  can  be  significantly  impacted if the application purely depends on the provider to
              make auto progress.

       Unsupported features
              These features are unsupported: connection management, scalable endpoint, passive endpoint, shared
              receive context, send/inject with immediate data.

</pre><h4><b>RUNTIME</b> <b>PARAMETERS</b></h4><pre>
       The <u>psm</u> provider checks for the following environment variables:

       <u>FI_PSM_UUID</u>
              PSM requires that each job has a unique ID (UUID).  All the processes in the same job need to  use
              the same UUID in order to be able to talk to each other.  The PSM reference manual advises to keep
              UUID unique to each job.  In practice, it generally works fine to reuse UUID as long as (1) no two
              jobs  with  the  same  UUID are running at the same time; and (2) previous jobs with the same UUID
              have exited normally.  If running into “resource busy” or “connection failure” issues with unknown
              reason, it is advisable to manually set the UUID to a value different from the default.

       The default UUID is 0FFF0FFF-0000-0000-0000-0FFF0FFF0FFF.

       <u>FI_PSM_NAME_SERVER</u>
              The <u>psm</u> provider has a simple built-in name server that can be used to resolve an  IP  address  or
              host name into a transport address needed by the <u>fi_av_insert</u> call.  The main purpose of this name
              server  is to allow simple client-server type applications (such as those in <u>fabtests</u>) to be writ‐
              ten purely with libfabric, without using any out-of-band communication mechanism.  For such appli‐
              cations, the server would run first to allow endpoints be created and  registered  with  the  name
              server, and then the client would call <u>fi_getinfo</u> with the <u>node</u> parameter set to the IP address or
              host  name of the server.  The resulting <u>fi_info</u> structure would have the transport address of the
              endpoint created by the server in the <u>dest_addr</u> field.  Optionally the <u>service</u>  parameter  can  be
              used  in  addition  to <u>node</u>.  Notice that the <u>service</u> number is interpreted by the provider and is
              not a TCP/IP port number.

       The name server is on by default.  It can be turned off by setting the variable to 0.  This  may  save  a
       small amount of resource since a separate thread is created when the name server is on.

       The provider detects OpenMPI and MPICH runs and changes the default setting to off.

       <u>FI_PSM_TAGGED_RMA</u>
              The  RMA functions are implemented on top of the PSM Active Message functions.  The Active Message
              functions have limit on the size of data can be transferred in a single message.  Large  transfers
              can  be divided into small chunks and be pipe-lined.  However, the bandwidth is sub-optimal by do‐
              ing this way.

       The <u>psm</u> provider use PSM tag-matching message queue functions to achieve higher bandwidth for large  size
       RMA.  For this purpose, a bit is reserved from the tag space to separate the RMA traffic from the regular
       tagged message queue.

       The option is on by default.  To turn it off set the variable to 0.

       <u>FI_PSM_AM_MSG</u>
              The  <u>psm</u> provider implements the non-tagged message queue over the PSM tag-matching message queue.
              One tag bit is reserved for this purpose.  Alternatively, the non-tagged message queue can be  im‐
              plemented over Active Message.  This experimental feature has slightly larger latency.

       This option is off by default.  To turn it on set the variable to 1.

       <u>FI_PSM_DELAY</u>
              Time (seconds) to sleep before closing PSM endpoints.  This is a workaround for a bug in some ver‐
              sions of PSM library.

       The default setting is 1.

       <u>FI_PSM_TIMEOUT</u>
              Timeout  (seconds) for gracefully closing PSM endpoints.  A forced closing will be issued if time‐
              out expires.

       The default setting is 5.

       <u>FI_PSM_PROG_INTERVAL</u>
              When auto progress is enabled (asked via the hints to <u>fi_getinfo</u>), a progress thread is created to
              make progress calls from time to time.   This  option  set  the  interval  (microseconds)  between
              progress calls.

       The default setting is 1 if affinity is set, or 1000 if not.  See <u>FI_PSM_PROG_AFFINITY</u>.

       <u>FI_PSM_PROG_AFFINITY</u>
              When  set,  specify  the  set  of CPU cores to set the progress thread affinity to.  The format is
              &lt;start&gt;[:&lt;end&gt;[:&lt;stride&gt;]][,&lt;start&gt;[:&lt;end&gt;[:&lt;stride&gt;]]]*,        where        each         triplet
              &lt;start&gt;:&lt;end&gt;:&lt;stride&gt;  defines  a  block  of  core_ids.  Both &lt;start&gt; and &lt;end&gt; can be either the
              core_id (when &gt;=0) or core_id - num_cores (when &lt;0).

       By default affinity is not set.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man7/fabric.7.html">fabric</a>(7), <a href="../man7/fi_provider.7.html">fi_provider</a>(7), <a href="../man7/fi_psm2.7.html">fi_psm2</a>(7), <a href="../man7/fi_psm3.7.html">fi_psm3</a>(7),

</pre><h4><b>AUTHORS</b></h4><pre>
       OpenFabrics.

Libfabric Programmer’s Manual                      2022-12-11                                          <u><a href="../man7/fi_psm.7.html">fi_psm</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>