<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gammu-smsd-tables - description of tables for database backends of gammu-smsd(1)</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/gammu-smsd">gammu-smsd_1.42.0-10_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gammu-smsd-tables - description of tables for database backends of <a href="../man1/gammu-smsd.1.html">gammu-smsd</a>(1)

       The  backends  themselves  are  described  in  their  sections,  this document describes general database
       structure and required tables.

       More SMS daemons can share single database. If you do not specify PhoneID in their configuration, all are
       treated equally and you have no guarantee which one sends outgoing message. If you configure PhoneID  and
       use  it  when  inserting  message to the <b>outbox</b> table (gammu-smsd-inject does this), each SMS daemon will
       have separate outbox queue. See also smsd-multi.

</pre><h4><b>RECEIVING</b> <b>OF</b> <b>MESSAGES</b></h4><pre>
       Received messages are stored in <u>inbox</u> table.

</pre><h4><b>TRANSMITTING</b> <b>OF</b> <b>MESSAGES</b></h4><pre>
       Transmitted messages are read from table <u>outbox</u> and possible subsequent parts of the  same  message  from
       <u>outbox_multipart</u>.

</pre><h4><b>DESCRIPTION</b> <b>OF</b> <b>TABLES</b></h4><pre>
   <b>gammu</b>
       Table  holding single field <b>Version</b> - version of a database schema. See <u>History</u> <u>of</u> <u>database</u> <u>structure</u> for
       details what has changed.

   <b>inbox</b>
       Table where received messages will be stored.

       Fields description:

       <b>UpdatedInDB</b> <b>(timestamp)</b>
              when somebody (daemon, user, etc.) updated it

       <b>ReceivingDateTime</b> <b>(timestamp)</b>
              when SMS was received

       <b>Text</b> <b>(text)</b>
              encoded SMS text (for all SMS)

       <b>SenderNumber</b> <b>(<a href="../man20/varchar.20.html">varchar</a>(20))</b>
              decoded SMS sender number

       <b>Coding</b> <b>(enum('Default_No_Compression',</b> <b>'Unicode_No_Compression',</b> <b>'8bit',</b> <b>'Default_Compression',</b>
       <b>'Unicode_Compression'))</b>
              SMS text coding

       <b>UDH</b> <b>(text)</b>
              encoded User Data Header text

       <b>SMSCNumber</b> <b>(<a href="../man20/varchar.20.html">varchar</a>(20))</b>
              decoded SMSC number

       <b>Class</b> <b>(integer)</b>
              SMS class or -1 (0 is flash SMS, 1 is normal one, 127 is USSD)

       <b>TextDecoded</b> <b>(<a href="../man160/varchar.160.html">varchar</a>(160))</b>
              decoded SMS text (for Default Alphabet/Unicode SMS)

       <b>ID</b> <b>(integer</b> <b>unsigned)</b>
              SMS identificator (for using with external applications)

       <b>RecipientID</b> <b>(text)</b>
              which Gammu daemon has added it

       <b>Processed</b> <b>(enum('false',</b> <b>'true'))</b>
              you can use for marking, whether SMS was processed or not

       <b>Status</b> <b>(integer)</b>
              Status of incoming message. Currently only used for  <b>Class</b>  127  (USSD)  messages  with  following
              meaning:

              <b>1</b>      Unknown status.

              <b>2</b>      No action is needed, maybe network initiated USSD.

              <b>3</b>      Reply is expected.

              <b>4</b>      USSD dialog terminated.

              <b>5</b>      Another client replied.

              <b>6</b>      Operation not supported.

              <b>7</b>      Network timeout.

              New in version 1.38.5.

   <b>outbox</b>
       Messages  enqueued  for sending should be placed in this table. If message is multipart, subsequent parts
       are stored in table <u>outbox_multipart</u>.

       Fields description:

       <b>UpdatedInDB</b> <b>(timestamp)</b>
              when somebody (daemon, user, etc.) updated it

       <b>InsertIntoDB</b> <b>(timestamp)</b>
              when message was inserted into database

       <b>SendingDateTime</b> <b>(timestamp)</b>
              set it to some value, when want to force sending after some planned time

       <b>SendBefore</b> <b>(time)</b>
              Send message before specified time, can be used to  limit  messages  from  being  sent  in  night.
              Default value is 23:59:59

              New in version 1.29.90.

       <b>SendAfter</b> <b>(time)</b>
              Send message after specified time, can be used to limit messages from being sent in night. Default
              value is 00:00:00

              New in version 1.29.90.

       <b>Text</b> <b>(text)</b>
              SMS  text  encoded  using  hex values in proper coding. If you want to use TextDecoded field, keep
              this NULL (or empty).

       <b>DestinationNumber</b> <b>(<a href="../man20/varchar.20.html">varchar</a>(20))</b>
              recipient number

       <b>Coding</b> <b>(enum('Default_No_Compression',</b> <b>'Unicode_No_Compression',</b> <b>'8bit',</b> <b>'Default_Compression',</b>
       <b>'Unicode_Compression'))</b>
              SMS text coding

       <b>UDH</b> <b>(text)</b>
              User Data Header encoded using hex values which will be used for constructing the message. Without
              this, message will be sent as plain text.

       <b>Class</b> <b>(integer)</b>
              SMS class or -1 (0 is normal SMS, 1 is flash one, 127 is USSD)

       <b>TextDecoded</b> <b>(<a href="../man160/varchar.160.html">varchar</a>(160))</b>
              SMS text in "human readable" form

       <b>ID</b> <b>(integer</b> <b>unsigned)</b>
              SMS/SMS sequence ID

              Please note that this number has to be unique also for sentitems table,  so  reusing  message  IDs
              might not be a good idea.

       <b>MultiPart</b> <b>(enum('false','true'))</b>
              info, whether there are more SMS from this sequence in outbox_multipart

       <b>RelativeValidity</b> <b>(integer)</b>
              SMS relative validity like encoded using GSM specs

       <b>SenderID</b> <b>(text)</b>
              which  SMSD  instance  should  send this one sequence, see <b>PhoneID</b> and smsd-multi. If blank, first
              SMSD who sees this message first will process it.

       <b>SendingTimeOut</b> <b>(timestamp)</b>
              used by SMSD instance for own targets

       <b>DeliveryReport</b> <b>(enum('default','yes','no'))</b>
              when default is used, Delivery Report is used or not according  to  SMSD  instance  settings;  yes
              forces Delivery Report.

       <b>CreatorID</b> <b>(text)</b>
              identification of program created the message

       <b>Retries</b> <b>(integer)</b>
              number of attempted retries when sending this message

       <b>Priority</b> <b>(integer)</b>
              priority of message, messages with higher priority are processed first

       <b>Status</b> <b>(enum('SendingOK',</b> <b>'SendingOKNoReport',</b> <b>'SendingError',</b> <b>'DeliveryOK',</b> <b>'DeliveryFailed',</b>
       <b>'DeliveryPending',</b> <b>'DeliveryUnknown',</b> <b>'Error',</b> <b>'Reserved'))</b>
              Status  of  message  sending.  SendingError  means  that  phone  failed to send the message, Error
              indicates some other error while processing message.

              <b>SendingOK</b>
                     Message has been sent, waiting for delivery report.

              <b>SendingOKNoReport</b>
                     Message has been sent without asking for delivery report.

              <b>SendingError</b>
                     Sending has failed.

              <b>DeliveryOK</b>
                     Delivery report arrived and reported success.

              <b>DeliveryFailed</b>
                     Delivery report arrived and reports failure.

              <b>DeliveryPending</b>
                     Delivery report announced pending deliver.

              <b>DeliveryUnknown</b>
                     Delivery report reported unknown status.

              <b>Error</b>  Some other error happened during sending (usually bug in SMSD).

              <b>Reserved</b>
                     Initial value, meaning the status has not been set.

              New in version 1.38.5.

       <b>StatusCode</b> <b>(integer)</b>
              GSM status code

              New in version 1.38.5.

   <b>outbox_multipart</b>
       Data for outgoing multipart messages.

       Fields description:

       <b>ID</b> <b>(integer</b> <b>unsigned)</b>
              the same meaning as values in outbox table

       <b>Text</b> <b>(text)</b>
              the same meaning as values in outbox table

       <b>Coding</b> <b>(enum('Default_No_Compression',</b> <b>'Unicode_No_Compression',</b> <b>'8bit',</b> <b>'Default_Compression',</b>
       <b>'Unicode_Compression'))</b>
              the same meaning as values in outbox table

       <b>UDH</b> <b>(text)</b>
              the same meaning as values in outbox table

       <b>Class</b> <b>(integer)</b>
              the same meaning as values in outbox table

       <b>TextDecoded</b> <b>(<a href="../man160/varchar.160.html">varchar</a>(160))</b>
              the same meaning as values in outbox table

       <b>ID</b> <b>(integer</b> <b>unsigned)</b>
              the same meaning as values in outbox table

       <b>SequencePosition</b> <b>(integer)</b>
              info, what is SMS number in SMS sequence (start at 2, first part is in <u>outbox</u> table).

       <b>Status</b> <b>(enum('SendingOK',</b> <b>'SendingOKNoReport',</b> <b>'SendingError',</b> <b>'DeliveryOK',</b> <b>'DeliveryFailed',</b>
       <b>'DeliveryPending',</b> <b>'DeliveryUnknown',</b> <b>'Error',</b> <b>'Reserved'))</b>
              Status of message sending. SendingError means  that  phone  failed  to  send  the  message,  Error
              indicates some other error while processing message.

              <b>SendingOK</b>
                     Message has been sent, waiting for delivery report.

              <b>SendingOKNoReport</b>
                     Message has been sent without asking for delivery report.

              <b>SendingError</b>
                     Sending has failed.

              <b>DeliveryOK</b>
                     Delivery report arrived and reported success.

              <b>DeliveryFailed</b>
                     Delivery report arrived and reports failure.

              <b>DeliveryPending</b>
                     Delivery report announced pending deliver.

              <b>DeliveryUnknown</b>
                     Delivery report reported unknown status.

              <b>Error</b>  Some other error happened during sending (usually bug in SMSD).

              <b>Reserved</b>
                     Initial value, meaning the status has not been set.

              New in version 1.38.5.

       <b>StatusCode</b> <b>(integer)</b>
              GSM status code

              New in version 1.38.5.

   <b>phones</b>
       Information about connected phones. This table is periodically refreshed and you can get information such
       as battery or signal level from here.

       Fields description:

       <b>ID</b> <b>(text)</b>
              PhoneID value

       <b>UpdatedInDB</b> <b>(timestamp)</b>
              when this record has been updated

       <b>InsertIntoDB</b> <b>(timestamp)</b>
              when this record has been created (when phone has been connected)

       <b>TimeOut</b> <b>(timestamp)</b>
              when this record expires

       <b>Send</b> <b>(boolean)</b>
              indicates whether SMSD is sending messages, depends on configuration directive <b>Send</b>

       <b>Receive</b> <b>(boolean)</b>
              indicates whether SMSD is receiving messages, depends on configuration directive <b>Receive</b>

       <b>IMEI</b> <b>(text)</b>
              IMEI of phone

       <b>IMSI</b> <b>(text)</b>
              SIM IMSI

       <b>Client</b> <b>(text)</b>
              client name, usually string Gammu with version

       <b>Battery</b> <b>(integer)</b>
              battery level in percent (or -1 if unknown)

       <b>Signal</b> <b>(integer)</b>
              signal level in percent (or -1 if unknown)

       <b>Sent</b> <b>(integer)</b>
              Number of sent SMS messages (SMSD does not reset this counter, so it might overflow).

       <b>Received</b> <b>(integer)</b>
              Number of received SMS messages (SMSD does not reset this counter, so it might overflow).

   <b>sentitems</b>
       Log  of  sent  messages  (and unsent ones with error code). Also if delivery reports are enabled, message
       state is updated after receiving delivery report.

       Fields description:

       <b>UpdatedInDB</b> <b>(timestamp)</b>
              when somebody (daemon, user, etc.) updated it

       <b>InsertIntoDB</b> <b>(timestamp)</b>
              when message was inserted into database

       <b>SendingDateTime</b> <b>(timestamp)</b>
              when message has been sent

       <b>DeliveryDateTime</b> <b>(timestamp)</b>
              Time of receiving delivery report (if it has been enabled).

       <b>Status</b> <b>(enum('SendingOK',</b> <b>'SendingOKNoReport',</b> <b>'SendingError',</b> <b>'DeliveryOK',</b> <b>'DeliveryFailed',</b>
       <b>'DeliveryPending',</b> <b>'DeliveryUnknown',</b> <b>'Error'))</b>
              Status of message sending. SendingError means  that  phone  failed  to  send  the  message,  Error
              indicates some other error while processing message.

              <b>SendingOK</b>
                     Message has been sent, waiting for delivery report.

              <b>SendingOKNoReport</b>
                     Message has been sent without asking for delivery report.

              <b>SendingError</b>
                     Sending has failed.

              <b>DeliveryOK</b>
                     Delivery report arrived and reported success.

              <b>DeliveryFailed</b>
                     Delivery report arrived and reports failure.

              <b>DeliveryPending</b>
                     Delivery report announced pending deliver.

              <b>DeliveryUnknown</b>
                     Delivery report reported unknown status.

              <b>Error</b>  Some other error happened during sending (usually bug in SMSD).

       <b>StatusError</b> <b>(integer)</b>
              Status  of  delivery  from  delivery  report message, codes are defined in GSM specification 03.40
              section 9.2.3.15 (TP-Status).

       <b>Text</b> <b>(text)</b>
              SMS text encoded using hex values

       <b>DestinationNumber</b> <b>(<a href="../man20/varchar.20.html">varchar</a>(20))</b>
              decoded destination number for SMS

       <b>Coding</b> <b>(enum('Default_No_Compression',</b> <b>'Unicode_No_Compression',</b> <b>'8bit',</b> <b>'Default_Compression',</b>
       <b>'Unicode_Compression'))</b>
              SMS text coding

       <b>UDH</b> <b>(text)</b>
              User Data Header encoded using hex values

       <b>SMSCNumber</b> <b>(<a href="../man20/varchar.20.html">varchar</a>(20))</b>
              decoded number of SMSC, which sent SMS

       <b>Class</b> <b>(integer)</b>
              SMS class or -1 (0 is normal SMS, 1 is flash one, 127 is USSD)

       <b>TextDecoded</b> <b>(<a href="../man160/varchar.160.html">varchar</a>(160))</b>
              SMS text in "human readable" form

       <b>ID</b> <b>(integer</b> <b>unsigned)</b>
              SMS ID

       <b>SenderID</b> <b>(text)</b>
              which SMSD instance sent this one sequence, see <b>PhoneID</b>

       <b>SequencePosition</b> <b>(integer)</b>
              SMS number in SMS sequence

       <b>TPMR</b> <b>(integer)</b>
              Message Reference like in GSM specs

       <b>RelativeValidity</b> <b>(integer)</b>
              SMS relative validity like encoded using GSM specs

       <b>CreatorID</b> <b>(text)</b>
              copied from CreatorID from outbox table

       <b>StatusCode</b> <b>(integer)</b>
              GSM status code

              New in version 1.38.5.

</pre><h4><b>HISTORY</b> <b>OF</b> <b>DATABASE</b> <b>STRUCTURE</b></h4><pre>
       <b>NOTE:</b>
          Testing versions (see versioning) do not have to keep same table structure as  final  releases.  Below
          mentioned  versions  are  for  informational  purposes  only, you should always use stable versions in
          production environment.

       History of schema versions:

       17

              • Added <b>Status</b> field to <u>outbox</u> and <u>outbox_multipart</u>.

              • Added <b>StatusCode</b> field to <u>sentitems</u>, <u>outbox</u> and <u>outbox_multipart</u>.

              • Added <b>Status</b> field to <u>inbox</u>.

          Changed in version 1.38.5.

       16

          • Removed unused <b>daemons</b>, <b>pbk</b> and <b>pbk_groups</b> tables.

          • Added primary key to the <b>gammu</b> table.

          • Added <b>Priority</b> field to the <u>outbox</u>.

          • Added <b>IMSI</b> field to the <u>phones</u>.

          Changed in version 1.37.90.

       15
          Added <b>Retries</b> field to the <u>outbox</u>.

          Changed in version 1.36.7.

       14
          Added <b>NetCode</b> and <b>NetName</b> fields.

          Changed in version 1.34.0.

       <b>13</b>     Added <b>SendBefore</b> and <b>SendAfter</b> fields.

              Changed in version 1.29.90.

              Also PostgreSQL fields are now case sensitive (same as other backends).

              Changed in version 1.29.93.

       <b>12</b>     the changes only affect MySQL structure changing default values  for  timestamps  from  <b>0000-00-00</b>
              <b>00:00:00</b>  to  <b>CURRENT_TIMESTAMP()</b>  by  using  triggers,  to  update  to this version, just execute
              triggers definition at the end of SQL file.

              Changed in version 1.28.94.

       <b>11</b>     all fields for storing message text are no longer limited to 160 chars, but are  arbitrary  length
              text fields.

              Changed in version 1.25.92.

       <b>10</b>     <b>DeliveryDateTime</b> is now NULL when message is not delivered, added several indexes

              Changed in version 1.22.95.

       <b>9</b>      added sent/received counters to phones table

              Changed in version 1.22.93.

       <b>8</b>      Signal and battery state are now stored in database.

              Changed in version 1.20.94.

       <b>7</b>      Added <b>CreatorID</b> to several tables.

              Changed in version 1.07.00.

       <b>6</b>      Many fields in outbox can now be NULL.

              Changed in version 1.06.00.

       <b>5</b>      Introduced daemons table and various other changes.

              Changed in version 1.03.00.

       <b>3</b>      Introduced phones table and various other changes.

              Changed in version 0.98.0.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Creating</b> <b>tables</b>
       SQL  scripts  to  create  all  needed  tables  for  most  databases  are  included in Gammu documentation
       (docs/sql). As well as some PHP scripts interacting with the database.

       For example to create SQLite tables, issue following command:

          sqlite3 smsd.db &lt; docs/sql/sqlite.sql

   <b>Injecting</b> <b>a</b> <b>message</b> <b>using</b> <b>SQL</b>
       To send a message, you can either use gammu-smsd-inject, which does all the magic for  you,  or  you  can
       insert the message manually. The simplest example is short text message:

          INSERT INTO outbox (
              DestinationNumber,
              TextDecoded,
              CreatorID,
              Coding
          ) VALUES (
              '800123465',
              'This is a SQL test message',
              'Program',
              'Default_No_Compression'
          );

       Please note usage of <b>TextDecoded</b> field, for <b>Text</b> field, you would have to hex encode the unicode text:

          INSERT INTO outbox (
              DestinationNumber,
              Text,
              CreatorID,
              Coding
          ) VALUES (
              '800123465',
              '005400680069007300200069007300200061002000530051004c002000740065007300740020006d006500730073006100670065',
              'Program',
              'Default_No_Compression'
          );

   <b>Injecting</b> <b>long</b> <b>message</b> <b>using</b> <b>SQL</b>
       Inserting  multipart  messages  is  a bit more tricky, you need to construct also UDH header and store it
       hexadecimally written into  UDH  field.  Unless  you  have  a  good  reason  to  do  this  manually,  use
       gammu-smsd-inject, C library (<b>SMSD_InjectSMS()</b>) or Python library (<b>gammu.smsd.SMSD.InjectSMS()</b>).

       For  long  text  message, the UDH starts with <b>050003</b> followed by byte as a message reference (you can put
       any hex value there, but it should be <b>different</b> <b>for</b> <b>each</b> <b>message</b>, <b>D3</b>  in  following  example),  byte  for
       number  of  messages  (<b>02</b> in example, it should be unique for each message you send to same phone number)
       and byte for number of current message (<b>01</b> for first message, <b>02</b> for second, etc.).

       I most cases, the mutlipart message has to be class 1.

       For example long text message of two parts could look like following:

          INSERT INTO outbox (
              CreatorID,
              MultiPart,
              DestinationNumber,
              UDH,
              TextDecoded,
              Coding,
              Class
          ) VALUES (
              'Gammu 1.23.91',
              'true',
              '123465',
              '050003D30201',
              'Mqukqirip ya konej eqniu rejropocejor hugiygydewl tfej nrupxujob xuemymiyliralj. Te tvyjuh qaxumur ibewfoiws zuucoz tdygu gelum L ejqigqesykl kya jdytbez',
              'Default_No_Compression',
              1
          )

          INSERT INTO outbox_multipart (
              SequencePosition,
              UDH,
              Class,
              TextDecoded,
              ID,
              Coding,
              Class
          ) VALUES (
              2,
              '050003D30202',
              'u xewz qisubevumxyzk ufuylehyzc. Nse xobq dfolizygqysj t bvowsyhyhyemim ovutpapeaempye giuuwbib.',
              &lt;ID_OF_INSERTED_RECORD_IN_OUBOX_TABLE&gt;,
              'Default_No_Compression',
              1
          )

       <b>NOTE:</b>
          Adding UDH means that you have less space for text, in above example you can use only  153  characters
          in single message.

</pre><h4><b>AUTHOR</b></h4><pre>
       Michal Čihař &lt;<a href="mailto:michal@cihar.com">michal@cihar.com</a>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2009-2015, Michal Čihař &lt;<a href="mailto:michal@cihar.com">michal@cihar.com</a>&gt;

1.42.0                                            Oct 03, 2020                              <u><a href="../man7/GAMMU-SMSD-TABLES.7.html">GAMMU-SMSD-TABLES</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>