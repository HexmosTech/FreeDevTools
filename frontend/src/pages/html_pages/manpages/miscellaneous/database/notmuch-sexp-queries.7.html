<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>notmuch-sexp-queries - s-expression syntax for notmuch queries</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/notmuch">notmuch_0.39-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       notmuch-sexp-queries - s-expression syntax for notmuch queries

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>notmuch</b> <u>subcommand</u> <b>--query=sexp</b> [option ...]  <b>--</b> '(and (to santa) (date december))'

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Notmuch supports an alternative query syntax based on <u>S-expressions</u> . It can be selected with the command
       line     <b>--query=sexp</b>     or     with    the    appropriate    option    to    the    library    function
       <b>notmuch_query_create_with_syntax()</b>.  Support for this syntax is currently optional, you can test if  your
       build of notmuch supports it with

          $ notmuch config get built_with.sexp_queries

   <b>S-EXPRESSIONS</b>
       An  <u>s-expression</u>  is  either  an  atom, or list of whitespace delimited s-expressions inside parentheses.
       Atoms are either

       <u>basic</u> <u>value</u>
          A basic value is an unquoted string containing no whitespace, double quotes, or parentheses.

       <u>quoted</u> <u>string</u>
          Double quotes (") delimit strings possibly containing whitespace or  parentheses.  These  can  contain
          double quote characters by escaping with backslash. E.g. <b>"this</b> <b>is</b> <b>a</b> <b>quote</b> <b>\""</b>.

   <b>S-EXPRESSION</b> <b>QUERIES</b>
       An  s-expression query is either an atom, the empty list, or a <u>compound</u> <u>query</u> consisting of a prefix atom
       (first element) defining a <u>field</u>, <u>logical</u> <u>operation</u>, or <u>modifier</u>, and 0 or more subqueries.

       <b>*</b>
          "*" matches any non-empty string in the current field.

       <b>()</b>
          The empty list matches all messages

       <u>term</u>
          Match all messages containing <u>term</u>, possibly after stemming or phrase  splitting.  For  discussion  of
          stemming  in  notmuch see <u>notmuch-search-terms</u>. Stemming only applies to unquoted terms (basic values)
          in s-expression queries.  For information on phrase splitting see <u>FIELDS</u>.

       <b>(</b> <u>field</u> <u>q</u>1 <u>q</u>2 ... <u>q</u>n <b>)</b>
          Restrict the queries <u>q</u>1 to <u>q</u>n to <u>field</u>, and combine with <u>and</u> (for most fields) or <u>or</u>. See  <u>FIELDS</u>  for
          more information.

       <b>(</b> <u>operator</u> <u>q</u>1 <u>q</u>2 ... <u>q</u>n <b>)</b>
          Combine  queries  <u>q</u>1  to  <u>q</u>n.  Currently supported operators are <b>and</b>, <b>or</b>, and <b>not</b>. <b>(not</b> <u>q</u>1 ... <u>q</u>n <b>)</b> is
          equivalent to <b>(and</b> <b>(not</b> <u>q</u>1 <b>)</b> <b>...</b> <b>(not</b> <u>q</u>n <b>))</b>.

       <b>(</b> <u>modifier</u> <u>q</u>1 <u>q</u>2 ... <u>q</u>n <b>)</b>
          Combine queries <u>q</u>1 to <u>q</u>n, and reinterpret the result (e.g. as a regular  expression).   See  <u>MODIFIERS</u>
          for more information.

       <b>(macro</b> <b>(</b> <u>p</u>1 ... <u>p</u>n <b>)</b> <b>body)</b>
          Define  saved  query  with parameter substitution. The syntax is recognized only in saved s-expression
          queries (see <b>squery.*</b> in <u>notmuch-config</u>). Parameter names in <b>body</b>  must  be  prefixed  with  <b>,</b>  to  be
          expanded  (see  <u>MACRO</u>  <u>EXAMPLES</u>).   Macros may refer to other macros, but only to their own parameters
          [1].

   <b>FIELDS</b>
       <u>Fields</u> [2] correspond to attributes of mail messages. Some are inherent  (and  immutable)  like  <b>subject</b>,
       while  others  <b>tag</b>  and  <b>property</b>  are  settable  by the user.  Each concrete field in <u>the</u> <u>table</u> <u>below</u> is
       discussed further under "Search prefixes" in <u>notmuch-search-terms</u>. The row <u>user</u> refers  to  user  defined
       fields, described in <u>notmuch-config</u>.

       Most  fields  are  either  <u>phrase</u>  <u>fields</u> [3] (which match sequences of words), or <u>term</u> <u>fields</u> [4] (which
       match exact strings). <u>Phrase</u> <u>splitting</u> breaks the term (basic value or quoted string) into words,  ignore
       punctuation. Phrase splitting is applied to terms in phrase (probabilistic) fields. Both phrase splitting
       and stemming apply only in phrase fields.

       Each  term  or  phrase field has an associated combining operator (<b>and</b> or <b>or</b>) used to combine the queries
       from each element of the tail of the list. This is generally <b>or</b> for those fields where a message has  one
       such attribute, and <b>and</b> otherwise.

       Term  or  phrase  fields  can  contain  arbitrarily  complex  queries  made up from terms, operators, and
       modifiers, but not other fields.

       Range fields take one or two arguments specifying lower and upper bounds.  One argument is interpreted as
       identical upper and lower bounds. Either upper or lower bound may be specified as <b>""</b> or <b>*</b> to specify  the
       lowest possible lower bound or highest possible upper bound.

       <b>lastmod</b> ranges support negative arguments, interpreted relative to the most recent database revision (see
       <u>count</u> <u>--lastmod</u>).

   <b>Fields</b> <b>with</b> <b>supported</b> <b>modifiers</b>
                            ┌────────────┬─────────┬────────┬────────┬──────────┬───────┐
                            │ field      │ combine │ type   │ expand │ wildcard │ regex │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ <u>none</u>       │ and     │        │ no     │ yes      │ no    │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ <u>user</u>       │ and     │ phrase │ no     │ yes      │ no    │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ attachment │ and     │ phrase │ yes    │ yes      │ no    │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ body       │ and     │ phrase │ no     │ no       │ no    │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ date       │         │ range  │ no     │ no       │ no    │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ folder     │ or      │ phrase │ yes    │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ from       │ and     │ phrase │ yes    │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ id         │ or      │ term   │ no     │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ is         │ and     │ term   │ yes    │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ lastmod    │         │ range  │ no     │ no       │ no    │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ mid        │ or      │ term   │ no     │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ mimetype   │ or      │ phrase │ yes    │ yes      │ no    │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ path       │ or      │ term   │ no     │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ property   │ and     │ term   │ yes    │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ subject    │ and     │ phrase │ yes    │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ tag        │ and     │ term   │ yes    │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ thread     │ or      │ term   │ yes    │ yes      │ yes   │
                            ├────────────┼─────────┼────────┼────────┼──────────┼───────┤
                            │ to         │ and     │ phrase │ yes    │ yes      │ no    │
                            └────────────┴─────────┴────────┴────────┴──────────┴───────┘

   <b>MODIFIERS</b>
       <u>Modifiers</u>  refer  to  any  prefixes  (first  elements of compound queries) that are neither operators nor
       fields.

       <b>(infix</b> <u>atom</u> <b>)</b>
          Interpret <u>atom</u> as an infix notmuch query (see <u>notmuch-search-terms</u>). Not supported inside fields.

       <b>(matching</b> <u>q</u>1 <u>q</u>2 ... <u>q</u>n <b>)</b> <b>(of</b> <u>q</u>1 <u>q</u>2 ... <u>q</u>n  <b>)</b>
          Match all messages have the same values of the current field as those  matching  all  of  <u>q</u>1  ...  <u>q</u>n.
          Supported in most term [7] or phrase fields. Most commonly used in the <b>thread</b> field.

       <b>(query</b> <u>atom</u> <b>)</b>
          Expand  to  the saved query named by <u>atom</u>. See <u>notmuch-config</u> for more. Note that the saved query must
          be in infix syntax (<u>notmuch-search-terms</u>). Not supported inside fields.

       <b>(regex</b> <u>atom</u> <b>)</b> <b>(rx</b> <u>atom</u> <b>)</b>
          Interpret <u>atom</u> as a POSIX.2 regular expression (see <u><a href="../man7/regex.7.html">regex</a>(7)).</u> <u>This</u>  <u>applies</u>  <u>in</u>  <u>term</u>  <u>fields</u>  <u>and</u>  <u>a</u>
          <u>subset</u> <u>[5]</u> <u>of</u> <u>phrase</u> <u>fields</u> <u>(see</u> <u>Fields</u> <u>with</u> <u>supported</u> <u>modifiers).</u>

       <b>(starts-with</b> <u>subword</u> <b>)</b>
          <u>Matches</u>  <u>any</u>  <u>term</u> <u>starting</u> <u>with</u> <u>subword.</u>  <u>This</u> <u>applies</u> <u>in</u> <u>either</u> <u>phrase</u> <u>or</u> <u>term</u> <u>fields,</u> <u>or</u> <u>outside</u> <u>of</u>
          <u>fields</u> <u>[6].</u> <u>Note</u> <u>that</u> <u>a</u> <b>starts-with</b> <u>query</u> <u>cannot</u> <u>be</u> <u>part</u> <u>of</u> <u>a</u> <u>phrase.</u> <u>The</u> <u>atom</u>  <b>*</b>  <u>is</u>  <u>a</u>  <u>synonym</u>  <u>for</u>
          <b>(starts-with</b> <b>"")</b><u>.</u>

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>Wizard</b>
          Match all messages containing the word "wizard", ignoring case.

       <b>added</b>
          Match  all  messages  containing "added", but also those containing "add", "additional", "Additional",
          "adds", etc... via stemming.

       <b>(and</b> <b>Bob</b> <b>Marley)</b>
          Match messages containing words "Bob" and "Marley", or their stems The words need not be adjacent.

       <b>(not</b> <b>Bob</b> <b>Marley)</b>
          Match messages containing neither "Bob" nor "Marley", nor their stems.

       <b>"quick</b> <b>fox"</b> <b>quick-fox</b> <b>quick@fox</b>
          Match the <u>phrase</u> "quick" followed by "fox" in phrase fields (or outside a field).  Match  the  literal
          string in a term field.

       <b>(folder</b> <b>(of</b> <b>(id</b> <b>1234@invalid)))</b>
          Match any message in the same folder as the one with Message-Id "1234@invalid".

       <b>(id</b> <b>1234@invalid</b> <b>blah@test)</b>
          Matches Message-Id "1234@invalid" <u>or</u> Message-Id "blah@test".

       <b>(and</b> <b>(infix</b> <b>"date:2009-11-18..2009-11-18")</b> <b>(tag</b> <b>unread))</b>
          Match messages in the given date range with tag unread.

       <b>(and</b> <b>(date</b> <b>2009-11-18</b> <b>2009-11-18)</b> <b>(tag</b> <b>unread))</b>
          Match messages in the given date range with tag unread.

       <b>(and</b> <b>(date</b> <b>2009-11-18</b> <b>*)</b> <b>(tag</b> <b>unread))</b>
          Match messages from 2009-11-18 or later with tag unread.

       <b>(and</b> <b>(date</b> <b>*</b> <b>2009-11-18)</b> <b>(tag</b> <b>unread))</b>
          Match messages from 2009-11-18 or earlier with tag unread.

       <b>(starts-with</b> <b>prelim)</b>
          Match any words starting with "prelim".

       <b>(subject</b> <b>quick</b> <b>"brown</b> <b>fox")</b>
          Match messages whose subject contains "quick" (anywhere, stemmed) and the phrase "brown fox".

       <b>(subject</b> <b>(starts-with</b> <b>prelim))</b>
          Matches any word starting with "prelim", inside a message subject.

       <b>(subject</b> <b>(starts-with</b> <b>quick)</b> <b>"brown</b> <b>fox")</b>
          Match messages whose subject contains "quick brown fox", but also "brown fox quicksand".

       <b>(thread</b> <b>(of</b> <b>(id</b> <b>1234@invalid)))</b>
          Match any message in the same thread as the one with Message-Id "1234@invalid".

       <b>(thread</b> <b>(matching</b> <b>(from</b> <b><a href="mailto:bob@example.com">bob@example.com</a>)</b> <b>(to</b> <b><a href="mailto:bob@example.com">bob@example.com</a>)))</b>
          Match any (messages in) a thread containing a message from "<a href="mailto:bob@example.com">bob@example.com</a>" and a (possibly distinct)
          message to "<a href="mailto:bob@example.com">bob@example.com</a>".

       <b>(to</b> <b>(or</b> <b><a href="mailto:bob@example.com">bob@example.com</a></b> <b><a href="mailto:mallory@example.org">mallory@example.org</a>))</b> <b>(or</b> <b>(to</b> <b><a href="mailto:bob@example.com">bob@example.com</a>)</b> <b>(to</b> <b><a href="mailto:mallory@example.org">mallory@example.org</a>))</b>
          Match   in   the   "To"   or   "Cc"   headers,   "<a href="mailto:bob@example.com">bob@example.com</a>",  "<a href="mailto:mallory@example.org">mallory@example.org</a>",  and  also
          "<a href="mailto:bob@example.com.au">bob@example.com.au</a>" since it contains the adjacent triple "bob", "example", "com".

       <b>(not</b> <b>(to</b> <b>*))</b>
          Match messages with an empty or invalid 'To' and 'Cc' field.

       <b>(List</b> <b>*)</b>
          Match messages with a non-empty List-Id header, assuming configuration <b>index.header.List=List-Id</b>.

   <b>MACRO</b> <b>EXAMPLES</b>
       A macro that takes two parameters and applies different fields to them.

          $ notmuch config set squery.TagSubject '(macro (tagname subj) (and (tag ,tagname) (subject ,subj)))'
          $ notmuch search --query=sexp '(TagSubject inbox maildir)'

       Nested macros are allowed.

          $ notmuch config set squery.Inner '(macro (x) (subject ,x))'
          $ notmuch config set squery.Outer  '(macro (x y) (and (tag ,x) (Inner ,y)))'
          $ notmuch search --query=sexp '(Outer inbox maildir)'

       Parameters can be re-used to reduce boilerplate. Any field, including user defined  fields  is  permitted
       within a macro.

          $ notmuch config set squery.About '(macro (name) (or (subject ,name) (List ,name)))'
          $ notmuch search --query=sexp '(About notmuch)'

</pre><h4><b>NOTES</b></h4><pre>
       [1]  Technically  macros  implement  lazy  evaluation  and  lexical  scope.  There is one top level scope
            containing all macro definitions, but all parameter definitions are local to a given macro.

       [2]  a.k.a. prefixes

       [3]  a.k.a. probabilistic prefixes

       [4]  a.k.a. boolean prefixes

       [5]  Due to the implementation of phrase fields in Xapian, regex  queries  could  only  match  individual
            words.

       [6]  Due to the way <b>body</b> is implemented in notmuch, this modifier is not supported in the <b>body</b> field.

       [7]  Due  to the way recursive <b>path</b> queries are implemented in notmuch, this modifier is not supported in
            the <b>path</b> field.

</pre><h4><b>AUTHOR</b></h4><pre>
       Carl Worth and many others

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2009-2025, Carl Worth and many others

0.39                                              May 01, 2025                           <u><a href="../man7/NOTMUCH-SEXP-QUERIES.7.html">NOTMUCH-SEXP-QUERIES</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>