<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>muse_flat  -  Combine  several separate flat images into one master flat file, trace slice locations, and</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/noble/+package/cpl-plugin-muse-doc">cpl-plugin-muse-doc_2.8.7+dfsg-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       muse_flat  -  Combine  several separate flat images into one master flat file, trace slice locations, and
       locate dark pixels.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       esorex <b>muse_flat</b> [OPTIONS] FILE.sof

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This recipe combines several separate flat-field images into one master flat-field file  and  traces  the
       location  of  the  slices  on the CCD. The master flat contains the combined pixel values of the raw flat
       exposures, with respect to the image combination method used, normalized to  the  mean  flux.  The  trace
       table  contains polynomials defining the location of the slices on the CCD. Processing trims the raw data
       and records the overscan statistics, subtracts the bias (taking account of the overscan, if --overscan is
       not "none"), and optionally, the dark from each raw input image, converts them from adu to count,  scales
       them  according  to  their exposure time, and combines the exposures using input parameters. To trace the
       position of the slices on the CCD, their edges are located using a threshold method. The  edge  detection
       is repeated at given intervals thereby tracing the central position (the mean of both edges) and width of
       each  slit  vertically  across  the  CCD. Deviant positions of detections on CCD rows can be detected and
       excluded before fitting a polynomial to all positions measured for one slice. The  polynomial  parameters
       for  each  slice are saved in the output trace table. Finally, the area between the now known slice edges
       is searched for dark (and bright) pixels, using statistics in each row of the master flat.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--nifu</b> <u>&lt;int&gt;</u>
              IFU to handle. If set to 0, all IFUs are processed serially. If set to -1, all IFUs are  processed
              in  parallel. (int; default: 0). The full name of this option for the EsoRex configuration file is
              <b>muse.muse_flat.nifu</b> [default = <u>0</u>].

       <b>--overscan</b> <u>&lt;str&gt;</u>
              If this is "none", stop when detecting discrepant overscan levels (see ovscsigma), for "offset" it
              assumes that the mean overscan level represents  the  real  offset  in  the  bias  levels  of  the
              exposures  involved,  and  adjusts  the  data accordingly; for "vpoly", a polynomial is fit to the
              vertical overscan and subtracted from the whole quadrant. (str; default: ´vpoly´). The  full  name
              of this option for the EsoRex configuration file is <b>muse.muse_flat.overscan</b> [default = <u>vpoly</u>].

       <b>--ovscreject</b> <u>&lt;str&gt;</u>
              This influences how values are rejected when computing overscan statistics. Either no rejection at
              all  ("none"), rejection using the DCR algorithm ("dcr"), or rejection using an iterative constant
              fit ("fit"). (str; default: ´dcr´). The full name of this option for the EsoRex configuration file
              is <b>muse.muse_flat.ovscreject</b> [default = <u>dcr</u>].

       <b>--ovscsigma</b> <u>&lt;float&gt;</u>
              If the deviation of mean overscan levels between a raw input image  and  the  reference  image  is
              higher  than  |ovscsigma x stdev|, stop the processing. If overscan="vpoly", this is used as sigma
              rejection level for the iterative polynomial fit (the level comparison  is  then  done  afterwards
              with  |100 x stdev| to guard against incompatible settings).  Has no effect for overscan="offset".
              (float; default: 30.0). The full name  of  this  option  for  the  EsoRex  configuration  file  is
              <b>muse.muse_flat.ovscsigma</b> [default = <u>30.0</u>].

       <b>--ovscignore</b> <u>&lt;int&gt;</u>
              The number of pixels of the overscan adjacent to the data section of the CCD that are ignored when
              computing  statistics  or  fits.  (int;  default:  3). The full name of this option for the EsoRex
              configuration file is <b>muse.muse_flat.ovscignore</b> [default = <u>3</u>].

       <b>--combine</b> <u>&lt;str&gt;</u>
              Type of combination to use (str; default: ´sigclip´). The full name of this option for the  EsoRex
              configuration file is <b>muse.muse_flat.combine</b> [default = <u>sigclip</u>].

       <b>--nlow</b> <u>&lt;int&gt;</u>
              Number of minimum pixels to reject with minmax (int; default: 1). The full name of this option for
              the EsoRex configuration file is <b>muse.muse_flat.nlow</b> [default = <u>1</u>].

       <b>--nhigh</b> <u>&lt;int&gt;</u>
              Number of maximum pixels to reject with minmax (int; default: 1). The full name of this option for
              the EsoRex configuration file is <b>muse.muse_flat.nhigh</b> [default = <u>1</u>].

       <b>--nkeep</b> <u>&lt;int&gt;</u>
              Number  of  pixels  to  keep  with  minmax (int; default: 1). The full name of this option for the
              EsoRex configuration file is <b>muse.muse_flat.nkeep</b> [default = <u>1</u>].

       <b>--lsigma</b> <u>&lt;float&gt;</u>
              Low sigma for pixel rejection with sigclip (float; default: 3.0). The full name of this option for
              the EsoRex configuration file is <b>muse.muse_flat.lsigma</b> [default = <u>3.0</u>].

       <b>--hsigma</b> <u>&lt;float&gt;</u>
              High sigma for pixel rejection with sigclip (float; default: 3.0). The full name  of  this  option
              for the EsoRex configuration file is <b>muse.muse_flat.hsigma</b> [default = <u>3.0</u>].

       <b>--scale</b> <u>&lt;bool&gt;</u>
              Scale  the  individual  images  to  a  common exposure time before combining them. (bool; default:
              True). The full name of this option for the  EsoRex  configuration  file  is  <b>muse.muse_flat.scale</b>
              [default = <u>True</u>].

       <b>--normalize</b> <u>&lt;bool&gt;</u>
              Normalize  the master flat to the average flux (bool; default: True). The full name of this option
              for the EsoRex configuration file is <b>muse.muse_flat.normalize</b> [default = <u>True</u>].

       <b>--trace</b> <u>&lt;bool&gt;</u>
              Trace the position of the slices on the master flat (bool; default: True). The full name  of  this
              option for the EsoRex configuration file is <b>muse.muse_flat.trace</b> [default = <u>True</u>].

       <b>--nsum</b> <u>&lt;int&gt;</u>
              Number  of  lines  over  which  to  average when tracing (int; default: 32). The full name of this
              option for the EsoRex configuration file is <b>muse.muse_flat.nsum</b> [default = <u>32</u>].

       <b>--order</b> <u>&lt;int&gt;</u>
              Order of polynomial fit to the trace (int; default: 5). The full  name  of  this  option  for  the
              EsoRex configuration file is <b>muse.muse_flat.order</b> [default = <u>5</u>].

       <b>--edgefrac</b> <u>&lt;float&gt;</u>
              Fractional  change  required to identify edge when tracing (float; default: 0.5). The full name of
              this option for the EsoRex configuration file is <b>muse.muse_flat.edgefrac</b> [default = <u>0.5</u>].

       <b>--losigmabadpix</b> <u>&lt;float&gt;</u>
              Low sigma to find dark pixels in the master flat (float; default: 5.0).  The  full  name  of  this
              option for the EsoRex configuration file is <b>muse.muse_flat.losigmabadpix</b> [default = <u>5.0</u>].

       <b>--hisigmabadpix</b> <u>&lt;float&gt;</u>
              High  sigma  to find bright pixels in the master flat (float; default: 5.0). The full name of this
              option for the EsoRex configuration file is <b>muse.muse_flat.hisigmabadpix</b> [default = <u>5.0</u>].

       <b>--samples</b> <u>&lt;bool&gt;</u>
              Create a table containing all tracing sample points. (bool; default: False). The full name of this
              option for the EsoRex configuration file is <b>muse.muse_flat.samples</b> [default = <u>False</u>].

       <b>--merge</b> <u>&lt;bool&gt;</u>
              Merge output products from different IFUs into a common file. (bool;  default:  False).  The  full
              name of this option for the EsoRex configuration file is <b>muse.muse_flat.merge</b> [default = <u>False</u>].

       Note  that  it  is  possible to create a configuration file containing these options, along with suitable
       default values. Please refer to the details provided by the 'esorex --help' command.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       The full documentation for the muse pipeline can be downloaded as a PDF file using the following URL:

              <b><a href="ftp://ftp.eso.org/pub/dfs/pipelines/muse/muse-pipeline-cookbook-2.8.7.pdf">ftp://ftp.eso.org/pub/dfs/pipelines/muse/muse-pipeline-cookbook-2.8.7.pdf</a></b>

       An   overview   over   the   existing   ESO   pipelines    can    be    found    on    the    web    page
       <b>https://www.eso.org/sci/software/pipelines/</b>.

       Basic documentation about the EsoRex program can be found at the esorex (1) man page.

       It   is   possible   to   call   the   pipelines   from   python   using  the  python-cpl  package.   See
       <b>https://packages.python.org/python-cpl/index.html</b> for further information.

       The  other  recipes  of  the  muse   pipeline   are   <u><a href="../man7/muse_ampl.7.html">muse_ampl</a></u>(7),   <u><a href="../man7/muse_astrometry.7.html">muse_astrometry</a></u>(7),   <u><a href="../man7/muse_bias.7.html">muse_bias</a></u>(7),
       <u><a href="../man7/muse_create_sky.7.html">muse_create_sky</a></u>(7),     <u><a href="../man7/muse_dark.7.html">muse_dark</a></u>(7),     <u><a href="../man7/muse_exp_align.7.html">muse_exp_align</a></u>(7),    <u><a href="../man7/muse_exp_combine.7.html">muse_exp_combine</a></u>(7),    <u><a href="../man7/muse_geometry.7.html">muse_geometry</a></u>(7),
       <u><a href="../man7/muse_illum.7.html">muse_illum</a></u>(7),  <u><a href="../man7/muse_lingain.7.html">muse_lingain</a></u>(7),   <u><a href="../man7/muse_lsf.7.html">muse_lsf</a></u>(7),   <u><a href="../man7/muse_qi_mask.7.html">muse_qi_mask</a></u>(7),   <u><a href="../man7/muse_scibasic.7.html">muse_scibasic</a></u>(7),   <u><a href="../man7/muse_scipost.7.html">muse_scipost</a></u>(7),
       <u><a href="../man7/muse_scipost_apply_astrometry.7.html">muse_scipost_apply_astrometry</a></u>(7),    <u><a href="../man7/muse_scipost_calibrate_flux.7.html">muse_scipost_calibrate_flux</a></u>(7),   <u><a href="../man7/muse_scipost_combine_pixtables.7.html">muse_scipost_combine_pixtables</a></u>(7),
       <u><a href="../man7/muse_scipost_correct_dar.7.html">muse_scipost_correct_dar</a></u>(7),            <u><a href="../man7/muse_scipost_correct_rv.7.html">muse_scipost_correct_rv</a></u>(7),            <u><a href="../man7/muse_scipost_make_cube.7.html">muse_scipost_make_cube</a></u>(7),
       <u><a href="../man7/muse_scipost_raman.7.html">muse_scipost_raman</a></u>(7),         <u><a href="../man7/muse_scipost_subtract_sky.7.html">muse_scipost_subtract_sky</a></u>(7),         <u><a href="../man7/muse_scipost_subtract_sky_simple.7.html">muse_scipost_subtract_sky_simple</a></u>(7),
       <u><a href="../man7/muse_standard.7.html">muse_standard</a></u>(7), <u><a href="../man7/muse_twilight.7.html">muse_twilight</a></u>(7), <u><a href="../man7/muse_wavecal.7.html">muse_wavecal</a></u>(7)

</pre><h4><b>VERSION</b></h4><pre>
       muse_flat 2.8.7

</pre><h4><b>AUTHOR</b></h4><pre>
       Peter Weilbacher (based on Joris Gerssen's draft) &lt;https://support.eso.org&gt;

</pre><h4><b>BUG</b> <b>REPORTS</b></h4><pre>
       Please report any problems to https://support.eso.org. Alternatively, you may send a report  to  the  ESO
       User Support Department &lt;<a href="mailto:usd-help@eso.org">usd-help@eso.org</a>&gt;.

</pre><h4><b>LICENSE</b></h4><pre>
       This file is part of the MUSE Instrument Pipeline Copyright (C) 2005, 2019 European Southern Observatory

       This  program  is  free  software;  you  can  redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation; either version 2 of the License,  or
       (at your option) any later version.

       This  program  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General  Public
       License for more details.

       You  should have received a copy of the GNU General Public License along with this program; if not, write
       to the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02111-1307  USA

muse_flat                                             2.8.7                                         <u><a href="../man7/MUSE_FLAT.7.html">MUSE_FLAT</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>