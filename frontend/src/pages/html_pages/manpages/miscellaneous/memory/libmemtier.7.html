<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>libmemtier.so - interposer library which enables the memkind memory tiering</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/libmemkind-dev">libmemkind-dev_1.14.0-3.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       libmemtier.so - interposer library which enables the memkind memory tiering

</pre><h4><b>SYNOPSIS</b></h4><pre>
       In  order  to  use  the  memkind  memory  tiering with pre-built binaries, pass the following environment
       variables along with the command:

              <b>LD_PRELOAD=libmemtier.so</b> <b>MEMKIND_MEM_TIERS="..."</b>  command {arguments ...}

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This library enables the memkind memory tiering mechanism. With this funcionality,  allocations  will  be
       split  between  different  types  of memory automatically. The library allows making allocations with the
       usage of multiple kinds keeping a specified ratio between them. This ratio determines  how  much  of  the
       total  allocated  memory  should  be  allocated  with  each  kind.  Both <b>LD_PRELOAD</b> and <b>MEMKIND_MEM_TIERS</b>
       environment variables are mandatory for enabling the memkind memory tiering.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       <b>MEMKIND_MEM_TIERS</b>
              A semicolon-separated list of tier configurations ended with a policy parameter. Each of the  tier
              configurations  is a comma-separated list of tier parameters in the format: <b>param_name:value,(...)</b>
              For the list of available tier parameters, please see the <b>TIER</b> <b>PARAMETERS</b> section below.

       <b>MEMKIND_MEM_THRESHOLDS</b>
              Semicolon-separated list of threshold configurations. Each  configuration  consists  of  a  comma-
              separated  list  of  threshold  parameters  in  the  same  format as <b>MEMKIND_MEM_TIERS</b> , where the
              <b>param_name</b> is one of the <u>INIT_VAL,</u> <u>MIN_VAL</u> and <u>MAX_VAL.</u>  Each parameter can be set only once. When
              any of the  parameters  are  missing,  they  will  be  set  to  a  default  value.   If  threshold
              configuration  is  missing,  threshold  with  default  configuration  will  be used. If any of the
              parameters  is  set  more  than  once,  the  application  will  be  aborted.  Order  of   provided
              configurations  is  important  -  configuration of Nth threshold defines threshold between Nth and
              (N+1)th tier. Note that for N+1 tiers there should be at most  N  thresholds  defined.   Set  this
              variable  only  when  <b>DYNAMIC_THRESHOLD</b>  policy is used. For more details about <b>param_name</b> see the
              <b>THRESHOLD</b>  <b>PARAMETERS</b>  section   below.   See   also   <b>EXAMPLES</b>   section   for   the   usage   of
              <b>MEMKIND_MEM_THRESHOLDS</b> environment variable.

</pre><h4><b>TIER</b> <b>PARAMETERS</b></h4><pre>
       <b>KIND</b>   (required)  -  kind  of  memory used in memory tier. Allowed kind names are <u>'DRAM',</u> <u>'KMEM_DAX'</u> and
              <u>'FS_DAX'.</u>   There  can  be  multiple  different  kind  names  provided  in  the  <b>MEMKIND_MEM_TIERS</b>
              environment  variable  -  one in each tier configuration. Additionally, in this variable more than
              one <u>'FS_DAX'</u> kind name is allowed.  More information about available kinds can  be  found  in  the
              <b><a href="../man3/memkind.3.html">memkind</a>(3)</b>   manual,  where  the  <u>'DRAM'</u>  kind  name  allocates  memory  with  the  usage  of  the
              <b>MEMKIND_DEFAULT</b> kind, the <u>'KMEM_DAX'</u> with the <b>MEMKIND_DAX_KMEM</b> kind and the <u>'FS_DAX'</u> with a  file-
              backed kind of memory created with the <b>memkind_create_pmem()</b> function.

       <b>PATH</b>   (required  only  for  the <u>FS_DAX</u> kind) - the path to the location where pmem file will be created.
              The path has to exist. For other kinds, if set, will cause an error.

       <b>PMEM_SIZE_LIMIT</b>
              (optional, only for the FS_DAX kind) - if set, it limits the size of pmem  file  and  the  maximum
              size  of  total  allocations from persistent memory. By default, no limit is introduced. Pass this
              option only with <u>FS_DAX</u> kind. For other kinds, if set, will cause an error.  The accepted  formats
              are:  1,  1K,  1M,  1G.  See the <b><a href="../man3/memkind.3.html">memkind</a>(3)</b> manual for information about limitations to this value
              which are the same as for the <b>max_size</b> value of the <b>memkind_create_pmem()</b> function.

       <b>RATIO</b>  (required) - the part of the ratio tied to the given kind. It's an <u>unsigned</u> type in a range from 1
              to <u>UINT_MAX.</u>  See <b>EXAMPLES</b> section.

       <b>POLICY</b> (required, only one in the  whole  environment  variable)  -  determines  the  algorithm  used  to
              distribute  allocations between provided memory kinds. This parameter has to be the last parameter
              in <b>MEMKIND_MEM_TIERS</b> configuration  string.  Currently  only  <u>STATIC_RATIO</u>  and  <u>DYNAMIC_THRESHOLD</u>
              policies are valid. See the <b>POLICIES</b> section.

       <b>NOTE:</b> The application will fail when provided environment variable string is not in the correct format.

</pre><h4><b>POLICIES</b></h4><pre>
       <b>STATIC_RATIO</b>
              All  allocations  are  made  in  such  a  way  that the ratio between memory tiers is constant. No
              threshold is used.

       <b>DYNAMIC_THRESHOLD</b>
              The ratio between memory tiers is kept with a help  of  a  threshold  between  kinds  which  value
              changes  in  time.  Minimum two tiers are required for this policy, otherwise the application will
              be aborted. The threshold value can change in time to keep the desired ratio between tiers, but it
              will not be lesser than <u>MIN_VAL</u> and it will not be greater than <u>MAX_VAL.</u>  For every allocation, if
              its size is greater than or equal to <u>INIT_VAL,</u> it will come from the (N+1)th tier.

              Default values for a threshold between  first  two  tiers  in  the  <b>MEMKIND_MEM_TIERS</b>  environment
              variable are:

              <b>INIT_VAL</b> <b>=</b> <b>1024,</b> <b>MIN_VAL</b> <b>=</b> <b>513,</b> <b>MAX_VAL</b> <b>=</b> <b>1536.</b>

              If  there are more tiers defined, each next undefined threshold will have all parameters increased
              by 1024, so the next undefined threshold between the next two tiers will have:

              <b>INIT_VAL</b> <b>=</b> <b>2048,</b> <b>MIN_VAL</b> <b>=</b> <b>1537,</b> <b>MAX_VAL</b> <b>=</b> <b>2560.</b>

</pre><h4><b>THRESHOLD</b> <b>PARAMETERS</b></h4><pre>
       <b>INIT_VAL</b>
              (optional) - the initial value of the threshold between two adjacent Nth  and  (N+1)th  tiers.  It
              must be greater than or equal to <u>MIN_VAL</u> and less than or equal to <u>MAX_VAL.</u>

       <b>MIN_VAL</b>
              (optional) - the minimum value of the threshold.

       <b>MAX_VAL</b>
              (optional) - the maximum value of the threshold.

       <b>NOTE:</b>  Because  setting the above parameters is optional, they will be set to default values in case they
       are not defined.

</pre><h4><b>DRAM</b> <b>FALLBACK</b> <b>POLICY</b></h4><pre>
       With the usage of both <u>DRAM</u> and <u>KMEM_DAX</u> tiers, if there is not enough memory to satisfy  the  <u>DRAM</u>  tier
       memory allocation request, the allocation will fall back to PMEM memory.

       With  the  usage  of  both  <u>DRAM</u> and <u>FS_DAX</u> tiers, if there is not enough memory to satisfy the <u>DRAM</u> tier
       memory allocation request, the allocation will fail.

       If there is not enough memory to satisfy the <u>FS_DAX</u> or  <u>KMEM_DAX</u>  tier  memory  allocation  request,  the
       allocation will fail.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The  following  example will run <b>ls</b> with the memkind memory tiering library. Make sure that paths to both
       <b>libmemtier.so</b> and <b>libmemkind.so</b> are included in <b>LD_LIBRARY_PATH.</b>  During the application run, 20% of  the
       allocated memory will come from PMEM memory and 80% will come from DRAM ( <u>FS_DAX:DRAM</u> ratio is 1:4):

              <b>LD_PRELOAD=libmemtier.so</b>
              <b>MEMKIND_MEM_TIERS="KIND:FS_DAX,PATH:/mnt/pmem0,PMEM_SIZE_LIMIT:10G,RATIO:1;KIND:DRAM,RATIO:4;POLICY:STATIC_RATIO"</b>
              <b><a href="file:/bin/ls">/bin/ls</a></b> <b>-l</b>

       The  example  value  of  <b>MEMKIND_MEM_TIERS</b> environment variable where all allocations will come from PMEM
       memory with filesystem created with the path /mnt/pmem0 (PMEM file size is limited only by the  specified
       filesystem):

              <b>LD_PRELOAD=libmemtier.so</b>
              <b>MEMKIND_MEM_TIERS="KIND:FS_DAX,PATH:/mnt/pmem0,RATIO:1;POLICY:STATIC_RATIO"</b>

       The  example  value  of <b>MEMKIND_MEM_THRESHOLDS</b> environment variable. With <u>INIT_VAL=64,</u> on the application
       start all allocations lower than 64 bytes threshold will come from DRAM and equal to or greater than this
       value will come from PMEM memory NUMA nodes. The threshold value changes during the runtime in  order  to
       maintain  the  ratio.  <u>MIN_VAL=1</u> and <u>MAX_VAL=10000</u> set the lower and upper limits of the threshold value.
       Note that the <u>DYNAMIC_THRESHOLD</u> policy has to be set in <b>MEMKIND_MEM_TIERS</b> environment variable:

              <b>LD_PRELOAD=libmemtier.so</b>
              <b>MEMKIND_MEM_TIERS="KIND:DRAM,RATIO:1;KIND:KMEM_DAX,RATIO:4;POLICY:DYNAMIC_THRESHOLD"</b>
              <b>MEMKIND_MEM_THRESHOLDS="INIT_VAL:64,MIN_VAL:1,MAX_VAL:10000"</b>

</pre><h4><b>NOTES</b></h4><pre>
       <b>libmemtier</b> works for applications that do not statically link a <b>malloc</b> implementation.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2021 Intel Corporation. All rights reserved.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/memkind.3.html">memkind</a>(3),</b> <b><a href="../man3/malloc.3.html">malloc</a>(3)</b>

Intel Corporation                                  2021-06-23                       <u>LIBMEMTIER</u> <u>LD_PRELOAD</u> <u><a href="../man7/API.7.html">API</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>