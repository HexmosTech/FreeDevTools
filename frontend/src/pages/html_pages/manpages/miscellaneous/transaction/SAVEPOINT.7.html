<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAVEPOINT - define a new savepoint within the current transaction</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/postgresql-client-17">postgresql-client-17_17.5-1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SAVEPOINT - define a new savepoint within the current transaction

</pre><h4><b>SYNOPSIS</b></h4><pre>
       SAVEPOINT <u>savepoint_name</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SAVEPOINT</b> establishes a new savepoint within the current transaction.

       A savepoint is a special mark inside a transaction that allows all commands that are executed after it
       was established to be rolled back, restoring the transaction state to what it was at the time of the
       savepoint.

</pre><h4><b>PARAMETERS</b></h4><pre>
       <u>savepoint_name</u>
           The name to give to the new savepoint. If savepoints with the same name already exist, they will be
           inaccessible until newer identically-named savepoints are released.

</pre><h4><b>NOTES</b></h4><pre>
       Use <b>ROLLBACK</b> <b>TO</b> to rollback to a savepoint. Use <b>RELEASE</b> <b>SAVEPOINT</b> to destroy a savepoint, keeping the
       effects of commands executed after it was established.

       Savepoints can only be established when inside a transaction block. There can be multiple savepoints
       defined within a transaction.

</pre><h4><b>EXAMPLES</b></h4><pre>
       To establish a savepoint and later undo the effects of all commands executed after it was established:

           BEGIN;
               INSERT INTO table1 VALUES (1);
               SAVEPOINT my_savepoint;
               INSERT INTO table1 VALUES (2);
               ROLLBACK TO SAVEPOINT my_savepoint;
               INSERT INTO table1 VALUES (3);
           COMMIT;

       The above transaction will insert the values 1 and 3, but not 2.

       To establish and later destroy a savepoint:

           BEGIN;
               INSERT INTO table1 VALUES (3);
               SAVEPOINT my_savepoint;
               INSERT INTO table1 VALUES (4);
               RELEASE SAVEPOINT my_savepoint;
           COMMIT;

       The above transaction will insert both 3 and 4.

       To use a single savepoint name:

           BEGIN;
               INSERT INTO table1 VALUES (1);
               SAVEPOINT my_savepoint;
               INSERT INTO table1 VALUES (2);
               SAVEPOINT my_savepoint;
               INSERT INTO table1 VALUES (3);

               -- rollback to the second savepoint
               ROLLBACK TO SAVEPOINT my_savepoint;
               SELECT * FROM table1;               -- shows rows 1 and 2

               -- release the second savepoint
               RELEASE SAVEPOINT my_savepoint;

               -- rollback to the first savepoint
               ROLLBACK TO SAVEPOINT my_savepoint;
               SELECT * FROM table1;               -- shows only row 1
           COMMIT;

       The above transaction shows row 3 being rolled back first, then row 2.

</pre><h4><b>COMPATIBILITY</b></h4><pre>
       SQL requires a savepoint to be destroyed automatically when another savepoint with the same name is
       established. In PostgreSQL, the old savepoint is kept, though only the more recent one will be used when
       rolling back or releasing. (Releasing the newer savepoint with <b>RELEASE</b> <b>SAVEPOINT</b> will cause the older one
       to again become accessible to <b>ROLLBACK</b> <b>TO</b> <b>SAVEPOINT</b> and <b>RELEASE</b> <b>SAVEPOINT</b>.) Otherwise, <b>SAVEPOINT</b> is fully
       SQL conforming.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/BEGIN.7.html">BEGIN</a></b>(7), <b><a href="../man7/COMMIT.7.html">COMMIT</a></b>(7), RELEASE SAVEPOINT (<b><a href="../man7/RELEASE_SAVEPOINT.7.html">RELEASE_SAVEPOINT</a></b>(7)), <b><a href="../man7/ROLLBACK.7.html">ROLLBACK</a></b>(7), ROLLBACK TO SAVEPOINT
       (<b><a href="../man7/ROLLBACK_TO_SAVEPOINT.7.html">ROLLBACK_TO_SAVEPOINT</a></b>(7))

PostgreSQL 17.5                                       2025                                          <u><a href="../man7/SAVEPOINT.7.html">SAVEPOINT</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>