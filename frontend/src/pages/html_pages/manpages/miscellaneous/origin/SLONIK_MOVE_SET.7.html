<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOVE SET - Change origin of a Slony-I replication set</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/slony1-2-doc">slony1-2-doc_2.2.11-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       MOVE SET - Change origin of a Slony-I replication set

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>MOVE</b> <b>SET</b> <b>(options);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Changes  the origin of a set from one node to another. The new origin must be a current subscriber of the
       set. The set must currently be locked on the old origin.

       After this command, the set cannot be unlocked on the old origin any more. The old origin  will  continue
       as  a  forwarding  subscriber of the set and the subscription chain from the old origin to the new origin
       will be reversed, hop by hop. As soon as the new origin has finished processing the event (that  includes
       any  outstanding sync events that happened before, <u>i.e.</u> fully catching up), the new origin will take over
       and open all tables in the set for client application update activity.

       This is <u>not</u> failover, as it requires a functioning old origin node (you needed to lock the set on the old
       origin). You would probably prefer to <b>MOVE</b> <b>SET</b> instead of <b>FAILOVER</b>, if at all possible, as <b>FAILOVER</b> winds
       up discarding the old origin node as being corrupted. Before <b>MOVE</b> <b>SET</b> will function a <b>LOCK</b> <b>SET</b> is needed.

       Note that this is a locking operation, which means that it can get stuck behind other database activity.

       ID = ival
              ID of the set to transfer

       OLD ORIGIN = ival
              Node ID of the current set origin

       NEW ORIGIN = ival
              Node ID of the new set origin

       This uses “schemadocmoveset(p_new_origin integer, p_set_id integer)” [not available as a man page].

</pre><h4><b>EXAMPLE</b></h4><pre>
       LOCK SET (
          ID = 1,
          ORIGIN = 1
       );
       MOVE SET (
          ID = 1,
          OLD ORIGIN = 1,
          NEW ORIGIN = 3
       );

</pre><h4><b>LOCKING</b> <b>BEHAVIOUR</b></h4><pre>
       Exclusive locks on each replicated table will be taken out on both the old origin node and the new origin
       node, as replication triggers are changed on both nodes: on the former origin, each table has  two  trig‐
       gers  (logtrigger  and lockset) dropped and a denyaccess trigger added; on the new origin, the denyaccess
       trigger is dropped and a logtrigger trigger added.

</pre><h4><b>SLONIK</b> <b>EVENT</b> <b>CONFIRMATION</b> <b>BEHAVIOUR</b></h4><pre>
       Slonik waits for the command submitted to the previous event node to be confirmed on the specified  event
       node before submitting this command.

</pre><h4><b>VERSION</b> <b>INFORMATION</b></h4><pre>
       This command was introduced in Slony-I 1.0

                                                19 September 2024                             <u>SLONIK</u> <u>MOVE</u> <u><a href="../man7/SET.7.html">SET</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>