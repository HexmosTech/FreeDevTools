<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_KDF-HKDF - The HKDF EVP_KDF implementation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_KDF-HKDF - The HKDF EVP_KDF implementation

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Support for computing the <b>HKDF</b> KDF through the <b>EVP_KDF</b> API.

       The EVP_KDF-HKDF algorithm implements the HKDF key derivation function.  HKDF follows the "extract-then-
       expand" paradigm, where the KDF logically consists of two modules. The first stage takes the input keying
       material and "extracts" from it a fixed-length pseudorandom key K. The second stage "expands" the key K
       into several additional pseudorandom keys (the output of the KDF).

       The output is considered to be keying material.

   <b>Identity</b>
       "HKDF" is the name for this implementation; it can be used with the <b>EVP_KDF_fetch()</b> function.

   <b>Supported</b> <b>parameters</b>
       The supported parameters are:

       "properties" (<b>OSSL_KDF_PARAM_PROPERTIES</b>) &lt;UTF8 string&gt;
       "digest" (<b>OSSL_KDF_PARAM_DIGEST</b>) &lt;UTF8 string&gt;
       "key" (<b>OSSL_KDF_PARAM_KEY</b>) &lt;octet string&gt;
       "salt" (<b>OSSL_KDF_PARAM_SALT</b>) &lt;octet string&gt;
           These parameters work as described in "PARAMETERS" in <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3).

       "info" (<b>OSSL_KDF_PARAM_INFO</b>) &lt;octet string&gt;
           This  parameter sets the info value.  The length of the context info buffer cannot exceed 1024 bytes;
           this should be more than enough for any normal use of HKDF.

       "mode" (<b>OSSL_KDF_PARAM_MODE</b>) &lt;UTF8 string&gt; or &lt;integer&gt;
           This parameter sets the mode for the HKDF operation.   There  are  three  modes  that  are  currently
           defined:

           "EXTRACT_AND_EXPAND" or <b>EVP_KDF_HKDF_MODE_EXTRACT_AND_EXPAND</b>
               This  is  the  default  mode.   Calling  <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3) on an EVP_KDF_CTX set up for HKDF will
               perform an extract followed by an expand operation in one go.  The derived key returned  will  be
               the  result  after  the expand operation. The intermediate fixed-length pseudorandom key K is not
               returned.

               In this mode the digest, key, salt and info values must be set before a key is derived  otherwise
               an error will occur.

           "EXTRACT_ONLY" or <b>EVP_KDF_HKDF_MODE_EXTRACT_ONLY</b>
               In  this  mode  calling  <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3)  will  just  perform  the extract operation. The value
               returned will be the intermediate fixed-length pseudorandom key K.   The  <u>keylen</u>  parameter  must
               match  the  size of K, which can be looked up by calling <b>EVP_KDF_CTX_get_kdf_size()</b> after setting
               the mode and digest.

               The digest, key and salt values must be set before a key  is  derived  otherwise  an  error  will
               occur.

           "EXPAND_ONLY" or <b>EVP_KDF_HKDF_MODE_EXPAND_ONLY</b>
               In  this  mode  calling  <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3)  will just perform the expand operation. The input key
               should be set to the intermediate fixed-length  pseudorandom  key  K  returned  from  a  previous
               extract operation.

               The  digest,  key  and  info  values  must be set before a key is derived otherwise an error will
               occur.

       The OpenSSL FIPS provider also supports the following parameters:

       "fips-indicator" (<b>OSSL_KDF_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           A getter that returns 1 if the operation is FIPS approved, or 0 otherwise.  This may  be  used  after
           calling EVP_KDF_derive. It returns 0 if "key-check" is set to 0 and the check fails.

       "key-check" (<b>OSSL_KDF_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
           The  default  value  of  1 causes an error during <b>EVP_KDF_CTX_set_params()</b> if the length of used key-
           derivation key (<b>OSSL_KDF_PARAM_KEY</b>) is shorter than 112 bits.  Setting this to zero will  ignore  the
           error  and  set  the approved "fips-indicator" to 0.  This option breaks FIPS compliance if it causes
           the approved "fips-indicator" to return 0.

</pre><h4><b>NOTES</b></h4><pre>
       A context for HKDF can be obtained by calling:

        EVP_KDF *kdf = EVP_KDF_fetch(NULL, "HKDF", NULL);
        EVP_KDF_CTX *kctx = EVP_KDF_CTX_new(kdf);

       The  output  length  of  an  HKDF  expand  operation  is  specified  via  the  <u>keylen</u>  parameter  to  the
       <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3)  function.   When  using EVP_KDF_HKDF_MODE_EXTRACT_ONLY the <u>keylen</u> parameter must equal
       the size of the intermediate fixed-length pseudorandom key otherwise an error will occur.  For that mode,
       the fixed output size can be looked up by calling <b>EVP_KDF_CTX_get_kdf_size()</b> after setting the  mode  and
       digest on the <b>EVP_KDF_CTX</b>.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This  example  derives  10  bytes  using SHA-256 with the secret key "secret", salt value "salt" and info
       value "label":

        EVP_KDF *kdf;
        EVP_KDF_CTX *kctx;
        unsigned char out[10];
        OSSL_PARAM params[5], *p = params;

        kdf = EVP_KDF_fetch(NULL, "HKDF", NULL);
        kctx = EVP_KDF_CTX_new(kdf);
        EVP_KDF_free(kdf);

        *p++ = OSSL_PARAM_construct_utf8_string(OSSL_KDF_PARAM_DIGEST,
                                                SN_sha256, strlen(SN_sha256));
        *p++ = OSSL_PARAM_construct_octet_string(OSSL_KDF_PARAM_KEY,
                                                 "secret", (size_t)6);
        *p++ = OSSL_PARAM_construct_octet_string(OSSL_KDF_PARAM_INFO,
                                                 "label", (size_t)5);
        *p++ = OSSL_PARAM_construct_octet_string(OSSL_KDF_PARAM_SALT,
                                                 "salt", (size_t)4);
        *p = OSSL_PARAM_construct_end();
        if (EVP_KDF_derive(kctx, out, sizeof(out), params) &lt;= 0) {
            error("EVP_KDF_derive");
        }

        EVP_KDF_CTX_free(kctx);

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       RFC 5869

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3),         <b><a href="../man3/EVP_KDF_CTX_new.3.html">EVP_KDF_CTX_new</a></b>(3),         <b><a href="../man3/EVP_KDF_CTX_free.3.html">EVP_KDF_CTX_free</a></b>(3),         <b><a href="../man3/EVP_KDF_CTX_get_kdf_size.3.html">EVP_KDF_CTX_get_kdf_size</a></b>(3),
       <b><a href="../man3/EVP_KDF_CTX_set_params.3.html">EVP_KDF_CTX_set_params</a></b>(3), <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3), "PARAMETERS" in <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3), <b><a href="../man7/EVP_KDF-TLS13_KDF.7.html">EVP_KDF-TLS13_KDF</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       This functionality was added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2016-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                 <u><a href="../man7SSL/EVP_KDF-HKDF.7SSL.html">EVP_KDF-HKDF</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>