<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cmap_keys - Overview of keys stored in the Configuration Map</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/corosync">corosync_3.1.9-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cmap_keys - Overview of keys stored in the Configuration Map

</pre><h4><b>OVERVIEW</b></h4><pre>
       There are 3 main types of keys stored in CMAP:

       * Mapping of values stored in the config file.

       * Runtime statistics.

       * Other user created values.

       In this man page, wild-cards have the usual meaning.

</pre><h4><b>ICMAP</b> <b>KEYS</b></h4><pre>
       These keys are in the icmap (default) map

       internal_configuration.*
              Internal  configuration data. All keys in this prefix are read only.  It's only useful for getting
              a list of loaded services.

       logging.*
              Values read from the configuration file. It's possible to change them at  runtime.   If  subsystem
              specific  configuration  is needed, the key must be in the form logging.logger_subsys.SERVICE.key,
              where SERVICE is upper case name of the service and key is same as in the configuration file.  All
              values are of string type.

       nodelist.*
              Values  are  read  from  the configuration file only (dynamic updates are not allowed).  Each node
              element in the configuration file gets assigned its position starting from zero. So the first node
              from the config file has nodelist.node.0. prefix. To  be  a  valid  entry,  each  node  must  have
              <b>ring0_addr</b> key.  To change the <b>nodeid</b> key, use a u32 data type.

              Local  node  position  is  stored in <b>local_node_pos</b> key (RO), so it's easy to find out nodeid/ring
              addresses of the local node directly from cmap.

       runtime.blackbox.*
              Trigger keys for storing fplay data. It's recommended that you use the  corosync-blackbox  command
              to change keys in this prefix.

       runtime.force_gather
              Set  to  'yes'  to force the processor to move into the GATHER state.  This operation is dangerous
              and is not recommended.

       runtime.config.*
              Contains the values actually in use by the totem membership  protocol.   Values  here  are  either
              taken  from the Corosync configuration file, defaults or computed from entries in the config file.
              For information on individual keys please refer to the man page <b><a href="../man5/corosync.conf.5.html">corosync.conf</a></b>(5).

       runtime.services.*
              Prefix with statistics for service engines. Each service has its own <b>service_id</b> key in the  prefix
              with  the  name  runtime.services.SERVICE.,  where  SERVICE is the lower case name of the service.
              Inside the service prefix is the number of messages received and sent by the  corosync  engine  in
              the  format runtime.services.SERVICE.EXEC_CALL.rx and runtime.services.SERVICE.EXEC_CALL.tx, where
              EXEC_CALL is the internal id of the service call (so for example 3 in cpg service  is  receive  of
              multicast message from other nodes).

       runtime.totem.members.*
              Prefix  containing  members  of  the  totem  single  ring  protocol.  Each  member keys has format
              runtime.totem.members.NODEID.KEY, where key is one of:

              <b>config_version</b> Config version of the member node.

       resources.process.PID.*
              Prefix created by applications using SAM with CMAP integration.  It contains the following keys:

              <b>recovery</b> Recovery policy of the process. Can be one of quit or restart.

              <b>poll_period</b> Value passed in sam_initialize as a time_interval.

              <b>last_updated</b> Last time SAM received a heartbeat from the client.

              <b>state</b> State of the client. Can be one of failed, stopped, running and waiting for quorum.

       uidgid.*
              Information about users/groups which are allowed to make  IPC  connections  to  corosync.  Entries
              loaded  from  configuration  file  are  stored  with  uidgid.config.*  prefix  and  are  pruned on
              configuration file reload. Dynamic entries has uidgid.* prefix and  a  configuration  file  reload
              doesn't affect them.

       quorum.cancel_wait_for_all
              Tells votequorum to cancel waiting for all nodes at cluster startup. Can be used to unblock quorum
              if notes are known to be down. For pcs use only.

       cfg.shutdown_timeout
              Sets  the  timeout  within  which  daemons that are registered for cfg callbacks must respond to a
              corosync_cfg_try_shutdown() request. the default is 5000 mS

       config.reload_in_progress
              This value will be set to 1 (or created) when a corosync.conf reload is started, and set to 0 when
              the reload is completed. This allows interested subsystems to  do  atomic  reconfiguration  rather
              than  changing  each  key. Note that individual add/change/delete notifications will still be sent
              during a reload.

       config.totemconfig_reload_in_progress
              This key is similar to <b>config.totemconfig_reload_in_progress</b> but changed after  the  totem  config
              trigger  is  processed.  It is useful (mainly) for situations when <b>nodelist.local_node_pos</b> must be
              correctly reinstated before anything else.

</pre><h4><b>STATS</b> <b>KEYS</b></h4><pre>
       These keys are in the stats map. All keys in this map are read-only.  Modification tracking of individual
       keys is supported in the stats map, but not prefixes. Add/Delete operations  are  supported  on  prefixes
       though so you can track for new ipc connections or knet interfaces.

       stats.srp.*
              Prefix containing statistics about totem.  Typical key prefixes:

              <b>commit_entered</b> Number of times the processor entered COMMIT state.

              <b>commit_token_lost</b> Number of times the processor lost token in COMMIT state.

              <b>consensus_timeouts</b> How many times the processor timed out forming a consensus about membership.

              <b>continuous_gather</b> How many times the processor was not able to reach consensus.

              <b>firewall_enabled_or_nic_failure</b>  Set  to 1 when processor was not able to reach consensus for long
              time. The usual reason is a badly configured firewall or connection failure.

              <b>gather_entered</b> Number of times the processor entered GATHER state.

              <b>gather_token_lost</b> Number of times the processor lost token in GATHER state.

              <b>mcast_retx</b> Number of retransmitted messages.

              <b>mcast_rx</b> Number of received multicast messages.

              <b>mcast_tx</b> Number of transmitted multicast messages.

              <b>memb_commit_token_rx</b> Number of received commit tokens.

              <b>memb_commit_token_tx</b> Number of transmitted commit tokens.

              <b>memb_join_rx</b> Number of received join messages.

              <b>memb_join_tx</b> Number of transmitted join messages.

              <b>memb_merge_detect_rx</b> Number of received member merge messages.

              <b>memb_merge_detect_tx</b> Number of transmitted member merge messages.

              <b>orf_token_rx</b> Number of received orf tokens.

              <b>orf_token_tx</b> Number of transmitted orf tokens.

              <b>recovery_entered</b> Number of times the processor entered recovery.

              <b>recovery_token_lost</b> Number of times the token was lost in recovery state.

              <b>rx_msg_dropped</b> Number of received messages which were dropped because they were not  expected  (as
              example multicast message in commit state).

              <b>token_hold_cancel_rx</b> Number of received token hold cancel messages.

              <b>token_hold_cancel_tx</b> Number of transmitted token hold cancel messages.

              <b>mtt_rx_token</b>  Mean  transit  time  of  token  in  milliseconds.  In  other words, time between two
              consecutive token receives.

              <b>avg_token_workload</b> Average time in milliseconds of holding time of token on the current processor.

              <b>avg_backlog_calc</b> Average number of not yet sent messages on the current processor.

       stats.knet.nodeX.linkY.*
              Statistics about the network traffic to and from each node  and  link  when  using  tke  kronosnet
              transport

              <b>connected</b> Whether the link is connected or not

              <b>up_count</b> Number of times this link has changed state to UP

              <b>down_count</b> Number of times this link has changed state to DOWN

              <b>latency_ave</b>  <b>/</b> <b>latency_max</b> <b>/</b> <b>latency_max</b> Calculated latencies of this link. Note that if there has
              been no traffic on the link then latency_min will show a very large number.

              <b>latency_samples</b> The number of samples used to calculate the latency figures, so you have some idea
              of their precision.

              <b>rx_data_packets</b> <b>/</b> <b>tx_data_packets</b> The number of packets sent/received on this link

              <b>rx_data_bytes</b> <b>/</b> <b>tx_data_bytes</b> The number of bytes sent/received on this link

              <b>rx_pmtu_packets</b> <b>/</b> <b>tx_pmtu_packets</b> The number of packets sent/received by the PMTUd subsystem

              <b>rx_pmtu_bytes</b> <b>/</b> <b>tx_pmtu_bytes</b> The number of bytes sent/received by the PMTUd subsystem

              <b>rx_ping_packets</b> <b>/</b> <b>tx_ping_packets</b> The number of packets sent/received as pings

              <b>rx_ping_bytes</b> <b>/</b> <b>tx_ping_bytes</b> The number of bytes sent/received as pings

              <b>rx_pong_packets</b> <b>/</b> <b>tx_pong_packets</b> The number of packets sent/received as pongs

              <b>rx_pong_bytes</b> <b>/</b> <b>tx_pong_bytes</b> The number of bytes sent/received as pongs

              <b>rx_total_packets</b> <b>/</b> <b>tx_total_packets</b> The total number of packets sent/received.  The  aggregate  of
              all of the above packet stats

              <b>rx_total_bytes</b>  <b>/</b>  <b>tx_total_bytes</b> The total number of bytes sent/received. The aggregate of all of
              the above bytes stats

              <b>tx_data_retries</b> <b>/</b> <b>tx_pmtu_retries</b> <b>/</b> <b>tx_ping_retries</b> <b>/</b> <b>tx_pong_retries</b> <b>/</b> <b>tx_total_retries</b> Number of
              times a transmit operation had to be retried due to the socket returning EAGAIN

       stats.ipcs.*
              There is information about total number of active connections from client programs at the time the
              request was made.  <b>active</b> number of closed connections during whole  runtime  of  corosync  <b>closed</b>
              Total number of connections that have been made since corosync was started

       stats.ipcs.ID.*
              Each IPC connection has a unique ID. This is in the form [[serviceX:][PID:]internal_id.

              Typical keys in this prefix are:

              <b>proc_name</b> process name of connected process (unavailable on some platforms)

              <b>dispatched</b> number of dispatched messages.

              <b>invalid_request</b> number of requests made by IPC which are invalid (calling non-existing call, ...).

              <b>name</b> contains short name of the IPC connection (unavailable on some platforms).

              <b>overload</b> is number of requests which were not processed because of overload.

              <b>queue_size</b> contains the number of messages in the queue waiting for send.

              <b>recv_retries</b> is the total number of interrupted receives.

              <b>requests</b> contains the number of requests made by IPC.

              <b>responses</b> is the number of responses sent to the IPC client.

              <b>send_retries</b> contains the total number of interrupted sends.

              <b>service_id</b> contains the ID of service which the IPC is connected to.

       stats.schedmiss.&lt;n&gt;.*
              If  corosync  is  not  scheduled after the required period of time it will log this event and also
              write an entry to the stats cmap under this key.  There can be up to 10 entries  (0..9)  in  here,
              when an 11th event happens the earliest will be removed.

              These  events  will  always  be in reverse order, so stats.schedmiss.0.* will always be the latest
              event kept and 9 the oldest. If you want to listen for notifications then you are  recommended  to
              listen for changes to stats.schedmiss.0.timestamp or stats.schedmiss.0.delay.

              <b>timestamp</b>  The  time  of  the  event  in  ms  since  the  Epoch  (ie  time_t * 1000 but with valid
              milliseconds).

              <b>delay</b> The time that corosync was paused (in ms, float value).

       stats.clear.*
              These are write-only keys used to clear the stats for various subsystems

              <b>totem</b> Clears the pg &amp; srp totem stats.

              <b>knet</b> Clears the knet stats

              <b>ipc</b> Clears the ipc stats

              <b>schedmiss</b> Clears the schedmiss stats

              <b>all</b> Clears all of the above stats

</pre><h4><b>DYNAMIC</b> <b>CHANGE</b> <b>USER/GROUP</b> <b>PERMISSION</b> <b>TO</b> <b>USE</b> <b>COROSYNC</b> <b>IPC</b></h4><pre>
       Is the same as in the configuration file. eg: to add UID 500 use

       # corosync-cmapctl -s uidgid.uid.500 u8 1

       GID is similar, so to add a GID use

       # corosync-cmapctl -s uidgid.gid.500 u8 1

       For removal of permissions, simply delete the key

       # corosync-cmapctl -d uidgid.gid.500

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/corosync_overview.7.html">corosync_overview</a></b>(7), <b><a href="../man5/corosync.conf.5.html">corosync.conf</a></b>(5), <b><a href="../man8/corosync-cmapctl.8.html">corosync-cmapctl</a></b>(8)

corosync Man Page                                  2018-10-08                                       <u><a href="../man7/CMAP_KEYS.7.html">CMAP_KEYS</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>