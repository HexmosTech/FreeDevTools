<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kernel_lockdown - kernel image access prevention feature</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages">manpages_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       kernel_lockdown - kernel image access prevention feature

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  Kernel  Lockdown  feature is designed to prevent both direct and indirect access to a running kernel
       image, attempting to protect against unauthorized modification of the kernel image and to prevent  access
       to security and cryptographic data located in kernel memory, whilst still permitting driver modules to be
       loaded.

       If  a  prohibited  or  restricted  feature is accessed or used, the kernel will emit a message that looks
       like:

           Lockdown: X: Y is restricted, see man kernel_lockdown.7

       where X indicates the process name and Y indicates what is restricted.

       On an EFI-enabled x86 or arm64 machine, lockdown will be automatically enabled if the system boots in EFI
       Secure Boot mode.

   <b>Coverage</b>
       When lockdown is in effect, a number of features  are  disabled  or  have  their  use  restricted.   This
       includes special device files and kernel services that allow direct access of the kernel image:

              /dev/mem
              /dev/kmem
              /dev/kcore
              /dev/ioports
              BPF
              kprobes

       and the ability to directly configure and control devices, so as to prevent the use of a device to access
       or modify a kernel image:

       •  The  use  of module parameters that directly specify hardware parameters to drivers through the kernel
          command line or when loading a module.

       •  The use of direct PCI BAR access.

       •  The use of the ioperm and iopl instructions on x86.

       •  The use of the KD*IO console ioctls.

       •  The use of the TIOCSSERIAL serial ioctl.

       •  The alteration of MSR registers on x86.

       •  The replacement of the PCMCIA CIS.

       •  The overriding of ACPI tables.

       •  The use of ACPI error injection.

       •  The specification of the ACPI RDSP address.

       •  The use of ACPI custom methods.

       Certain facilities are restricted:

       •  Only validly signed modules may be loaded (waived if the module file being loaded is  vouched  for  by
          IMA appraisal).

       •  Only validly signed binaries may be kexec'd (waived if the binary image file to be executed is vouched
          for by IMA appraisal).

       •  Unencrypted  hibernation/suspend  to swap are disallowed as the kernel image is saved to a medium that
          can then be accessed.

       •  Use of debugfs is not permitted as this allows a whole range of actions including direct configuration
          of, access to and driving of hardware.

       •  IMA requires the addition of the "secure_boot" rules to the policy, whether or not they are  specified
          on the command line, for both the built-in and custom policies in secure boot lockdown mode.

</pre><h4><b>VERSIONS</b></h4><pre>
       The Kernel Lockdown feature was added in Linux 5.4.

</pre><h4><b>NOTES</b></h4><pre>
       The  Kernel  Lockdown  feature is enabled by CONFIG_SECURITY_LOCKDOWN_LSM.  The <u>lsm=lsm1,...,lsmN</u> command
       line parameter controls the sequence of the initialization of Linux Security Modules.   It  must  contain
       the  string  <u>lockdown</u>  to  enable  the  Kernel  Lockdown  feature.   If the command line parameter is not
       specified, the initialization falls back to the value of the deprecated <u>security=</u> command line  parameter
       and further to the value of CONFIG_LSM.

Linux man-pages 6.9.1                              2024-05-02                                 <u><a href="../man7/kernel_lockdown.7.html">kernel_lockdown</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>