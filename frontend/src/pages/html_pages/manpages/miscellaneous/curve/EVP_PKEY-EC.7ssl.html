<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_PKEY-EC, EVP_KEYMGMT-EC - EVP_PKEY EC keytype and algorithm support</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_PKEY-EC, EVP_KEYMGMT-EC - EVP_PKEY EC keytype and algorithm support

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>EC</b> keytype is implemented in OpenSSL's default provider.

   <b>Common</b> <b>EC</b> <b>parameters</b>
       The normal way of specifying domain parameters for an EC curve is via the curve name "group". For curves
       with no curve name, explicit parameters can be used that specify "field-type", "p", "a", "b", "generator"
       and "order".  Explicit parameters are supported for backwards compatibility reasons, but they are not
       compliant with multiple standards (including RFC5915) which only allow named curves.

       The following Key generation/Gettable/Import/Export types are available for the built-in EC algorithm:

       "group" (<b>OSSL_PKEY_PARAM_GROUP_NAME</b>) &lt;UTF8 string&gt;
           The curve name.

       "field-type" (<b>OSSL_PKEY_PARAM_EC_FIELD_TYPE</b>) &lt;UTF8 string&gt;
           The  value  should  be  either "prime-field" or "characteristic-two-field", which correspond to prime
           field Fp and binary field F2^m.

       "p" (<b>OSSL_PKEY_PARAM_EC_P</b>) &lt;unsigned integer&gt;
           For a curve over Fp <u>p</u> is the prime for the field. For a curve over F2^m <u>p</u> represents the  irreducible
           polynomial  -  each bit represents a term in the polynomial. Therefore, there will either be three or
           five bits set dependent on whether the polynomial is a trinomial or a pentanomial.

       "a" (<b>OSSL_PKEY_PARAM_EC_A</b>) &lt;unsigned integer&gt;
       "b" (<b>OSSL_PKEY_PARAM_EC_B</b>) &lt;unsigned integer&gt;
       "seed" (<b>OSSL_PKEY_PARAM_EC_SEED</b>) &lt;octet string&gt;
           <u>a</u> and <u>b</u> represents the coefficients of the curve For Fp:   y^2 mod p = x^3 +ax + b mod p OR For F2^m:
           y^2 + xy = x^3 + ax^2 + b

           <u>seed</u> is an optional value that is for information purposes only.  It  represents  the  random  number
           seed used to generate the coefficient <u>b</u> from a random number.

       "generator" (<b>OSSL_PKEY_PARAM_EC_GENERATOR</b>) &lt;octet string&gt;
       "order" (<b>OSSL_PKEY_PARAM_EC_ORDER</b>) &lt;unsigned integer&gt;
       "cofactor" (<b>OSSL_PKEY_PARAM_EC_COFACTOR</b>) &lt;unsigned integer&gt;
           The  <u>generator</u> is a well defined point on the curve chosen for cryptographic operations. The encoding
           conforms  with  Sec.  2.3.3  of  the  SECG  SEC  1  ("Elliptic  Curve  Cryptography")  standard.  See
           <b>EC_POINT_oct2point()</b>.   Integers  used  for  point  multiplications  will be between 0 and <u>order</u> - 1.
           <u>cofactor</u> is an optional value.  <u>order</u> multiplied by the <u>cofactor</u> gives the number of  points  on  the
           curve.

       "decoded-from-explicit" (<b>OSSL_PKEY_PARAM_EC_DECODED_FROM_EXPLICIT_PARAMS</b>) &lt;integer&gt;
           Gets a flag indicating whether the key or parameters were decoded from explicit curve parameters. Set
           to 1 if so or 0 if a named curve was used.

       "use-cofactor-flag" (<b>OSSL_PKEY_PARAM_USE_COFACTOR_ECDH</b>) &lt;integer&gt;
           Enable Cofactor DH (ECC CDH) if this value is 1, otherwise it uses normal EC DH if the value is zero.
           The  cofactor  variant  multiplies the shared secret by the EC curve's cofactor (note for some curves
           the cofactor is 1).

           See also <b><a href="../man7/EVP_KEYEXCH-ECDH.7.html">EVP_KEYEXCH-ECDH</a></b>(7) for the related <b>OSSL_EXCHANGE_PARAM_EC_ECDH_COFACTOR_MODE</b> parameter that
           can be set on a per-operation basis.

       "encoding" (<b>OSSL_PKEY_PARAM_EC_ENCODING</b>) &lt;UTF8 string&gt;
           Set the format used for serializing  the  EC  group  parameters.   Valid  values  are  "explicit"  or
           "named_curve". The default value is "named_curve".

       "point-format" (<b>OSSL_PKEY_PARAM_EC_POINT_CONVERSION_FORMAT</b>) &lt;UTF8 string&gt;
           Sets  or  gets  the  point_conversion_form  for  the <u>key</u>. For a description of point_conversion_forms
           please see <b><a href="../man3/EC_POINT_new.3.html">EC_POINT_new</a></b>(3). Valid values are "uncompressed" or "compressed".  The  default  value  is
           "uncompressed".

       "group-check" (<b>OSSL_PKEY_PARAM_EC_GROUP_CHECK_TYPE</b>) &lt;UTF8 string&gt;
           Sets  or  Gets  the type of group check done when <b>EVP_PKEY_param_check()</b> is called.  Valid values are
           "default", "named" and "named-nist".  The "named" type checks that the domain  parameters  match  the
           inbuilt  curve  parameters,  "named-nist"  is  similar but also checks that the named curve is a nist
           curve.  The "default" type does domain parameter validation for the OpenSSL default provider, but  is
           equivalent to "named-nist" for the OpenSSL FIPS provider.

       "include-public" (<b>OSSL_PKEY_PARAM_EC_INCLUDE_PUBLIC</b>) &lt;integer&gt;
           Setting  this  value  to  0  indicates  that  the public key should not be included when encoding the
           private key. The default value of 1 will include the public key.

       "pub" (<b>OSSL_PKEY_PARAM_PUB_KEY</b>) &lt;octet string&gt;
           The public key value in encoded EC point format conforming to Sec. 2.3.3 and 2.3.4 of the SECG SEC  1
           ("Elliptic  Curve  Cryptography")  standard.   This parameter is used when importing or exporting the
           public key value with the <b>EVP_PKEY_fromdata()</b> and <b>EVP_PKEY_todata()</b> functions.

           Note, in particular, that the choice of point compression format used for encoding the exported value
           via <b>EVP_PKEY_todata()</b> depends on the underlying provider implementation.  Before OpenSSL  3.0.8,  the
           implementation  of providers included with OpenSSL always opted for an encoding in compressed format,
           unconditionally.   Since  OpenSSL  3.0.8,  the  implementation  has  been  changed   to   honor   the
           <b>OSSL_PKEY_PARAM_EC_POINT_CONVERSION_FORMAT</b> parameter, if set, or to default to uncompressed format.

       "priv" (<b>OSSL_PKEY_PARAM_PRIV_KEY</b>) &lt;unsigned integer&gt;
           The private key value.

       "encoded-pub-key" (<b>OSSL_PKEY_PARAM_ENCODED_PUBLIC_KEY</b>) &lt;octet string&gt;
           Used  for  getting  and  setting the encoding of an EC public key. The public key is expected to be a
           point conforming to Sec. 2.3.4 of the SECG SEC 1 ("Elliptic Curve Cryptography") standard.

       "qx" (<b>OSSL_PKEY_PARAM_EC_PUB_X</b>) &lt;unsigned integer&gt;
           Used for getting the EC public key X component.

       "qy" (<b>OSSL_PKEY_PARAM_EC_PUB_Y</b>) &lt;unsigned integer&gt;
           Used for getting the EC public key Y component.

       "default-digest" (<b>OSSL_PKEY_PARAM_DEFAULT_DIGEST</b>) &lt;UTF8 string&gt;
           Getter that returns the default digest name.  (Currently returns "SHA256" as of OpenSSL 3.0).

       "dhkem-ikm" (<b>OSSL_PKEY_PARAM_DHKEM_IKM</b>) &lt;octet string&gt;
           DHKEM requires the generation of a keypair using an input key material (seed).  Use this  to  specify
           the  key  material used for generation of the private key.  This value should not be reused for other
           purposes. It can only be used for the curves "P-256", "P-384" and "P-521" and should have a length of
           at least the size of the encoded private key (i.e. 32, 48 and 66 for the listed curves).

       The following Gettable types are also available for the built-in EC algorithm:

       "basis-type" (<b>OSSL_PKEY_PARAM_EC_CHAR2_TYPE</b>) &lt;UTF8 string&gt;
           Supports the values "tpBasis" for a trinomial or "ppBasis" for a pentanomial.   This  field  is  only
           used for a binary field F2^m.

       "m" (<b>OSSL_PKEY_PARAM_EC_CHAR2_M</b>) &lt;integer&gt;
       "tp" (<b>OSSL_PKEY_PARAM_EC_CHAR2_TP_BASIS</b>) &lt;integer&gt;
       "k1" (<b>OSSL_PKEY_PARAM_EC_CHAR2_PP_K1</b>) &lt;integer&gt;
       "k2" (<b>OSSL_PKEY_PARAM_EC_CHAR2_PP_K2</b>) &lt;integer&gt;
       "k3" (<b>OSSL_PKEY_PARAM_EC_CHAR2_PP_K3</b>) &lt;integer&gt;
           These fields are only used for a binary field F2^m.  <u>m</u> is the degree of the binary field.

           <u>tp</u> is the middle bit of a trinomial so its value must be in the range m &gt; tp &gt; 0.

           <u>k1</u>, <u>k2</u> and <u>k3</u> are used to get the middle bits of a pentanomial such that m &gt; k3 &gt; k2 &gt; k1 &gt; 0

       The  following  key  generation  settable  parameter is also available for the OpenSSL FIPS provider's EC
       algorithm:

       "key-check" (<b>OSSL_PKEY_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
           See "Common Information Parameters" in <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7) for further information.

       The following key generation  Gettable  parameter  is  available  for  the  OpenSSL  FIPS  provider's  EC
       algorithm:

       "fips-indicator" (<b>OSSL_PKEY_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           See "Common Information Parameters" in <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7) for further information.

   <b>EC</b> <b>key</b> <b>validation</b>
       For  EC  keys,  <b><a href="../man3/EVP_PKEY_param_check.3.html">EVP_PKEY_param_check</a></b>(3) behaves in the following way: For the OpenSSL default provider it
       uses   either   <b><a href="../man3/EC_GROUP_check.3.html">EC_GROUP_check</a></b>(3)   or    <b><a href="../man3/EC_GROUP_check_named_curve.3.html">EC_GROUP_check_named_curve</a></b>(3)    depending    on    the    flag
       EC_FLAG_CHECK_NAMED_GROUP.   The  OpenSSL  FIPS  provider  uses <b><a href="../man3/EC_GROUP_check_named_curve.3.html">EC_GROUP_check_named_curve</a></b>(3) in order to
       conform to SP800-56Ar3 <u>Assurances</u> <u>of</u> <u>Domain-Parameter</u> <u>Validity</u>.

       For EC keys, <b><a href="../man3/EVP_PKEY_param_check_quick.3.html">EVP_PKEY_param_check_quick</a></b>(3) is equivalent to <b><a href="../man3/EVP_PKEY_param_check.3.html">EVP_PKEY_param_check</a></b>(3).

       For EC keys, <b><a href="../man3/EVP_PKEY_public_check.3.html">EVP_PKEY_public_check</a></b>(3) and <b><a href="../man3/EVP_PKEY_public_check_quick.3.html">EVP_PKEY_public_check_quick</a></b>(3) conform to SP800-56Ar3 <u>ECC</u>  <u>Full</u>
       <u>Public-Key</u> <u>Validation</u> and <u>ECC</u> <u>Partial</u> <u>Public-Key</u> <u>Validation</u> respectively.

       For  EC Keys, <b><a href="../man3/EVP_PKEY_private_check.3.html">EVP_PKEY_private_check</a></b>(3) and <b><a href="../man3/EVP_PKEY_pairwise_check.3.html">EVP_PKEY_pairwise_check</a></b>(3) conform to SP800-56Ar3 <u>Private</u> <u>key</u>
       <u>validity</u> and <u>Owner</u> <u>Assurance</u> <u>of</u> <u>Pair-wise</u> <u>Consistency</u> respectively.

</pre><h4><b>EXAMPLES</b></h4><pre>
       An <b>EVP_PKEY</b> context can be obtained by calling:

           EVP_PKEY_CTX *pctx =
               EVP_PKEY_CTX_new_from_name(NULL, "EC", NULL);

       An <b>EVP_PKEY</b> ECDSA or ECDH key can be generated with a "P-256" named group by calling:

           pkey = EVP_EC_gen("P-256");

       or like this:

           EVP_PKEY *key = NULL;
           OSSL_PARAM params[2];
           EVP_PKEY_CTX *gctx =
               EVP_PKEY_CTX_new_from_name(NULL, "EC", NULL);

           EVP_PKEY_keygen_init(gctx);

           params[0] = OSSL_PARAM_construct_utf8_string(OSSL_PKEY_PARAM_GROUP_NAME,
                                                        "P-256", 0);
           params[1] = OSSL_PARAM_construct_end();
           EVP_PKEY_CTX_set_params(gctx, params);

           EVP_PKEY_generate(gctx, &amp;key);

           EVP_PKEY_print_private(bio_out, key, 0, NULL);
           ...
           EVP_PKEY_free(key);
           EVP_PKEY_CTX_free(gctx);

       An <b>EVP_PKEY</b> EC CDH (Cofactor Diffie-Hellman) key can be generated with a "K-571" named group by calling:

           int use_cdh = 1;
           EVP_PKEY *key = NULL;
           OSSL_PARAM params[3];
           EVP_PKEY_CTX *gctx =
               EVP_PKEY_CTX_new_from_name(NULL, "EC", NULL);

           EVP_PKEY_keygen_init(gctx);

           params[0] = OSSL_PARAM_construct_utf8_string(OSSL_PKEY_PARAM_GROUP_NAME,
                                                        "K-571", 0);
           /*
            * This curve has a cofactor that is not 1 - so setting CDH mode changes
            * the behaviour. For many curves the cofactor is 1 - so setting this has
            * no effect.
            */
           params[1] = OSSL_PARAM_construct_int(OSSL_PKEY_PARAM_USE_COFACTOR_ECDH,
                                                &amp;use_cdh);
           params[2] = OSSL_PARAM_construct_end();
           EVP_PKEY_CTX_set_params(gctx, params);

           EVP_PKEY_generate(gctx, &amp;key);
           EVP_PKEY_print_private(bio_out, key, 0, NULL);
           ...
           EVP_PKEY_free(key);
           EVP_PKEY_CTX_free(gctx);

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_EC_gen.3.html">EVP_EC_gen</a></b>(3),     <b><a href="../man3/EVP_KEYMGMT.3.html">EVP_KEYMGMT</a></b>(3),     <b><a href="../man3/EVP_PKEY.3.html">EVP_PKEY</a></b>(3),     <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7),      <b><a href="../man7/EVP_SIGNATURE-ECDSA.7.html">EVP_SIGNATURE-ECDSA</a></b>(7),
       <b><a href="../man7/EVP_KEYEXCH-ECDH.7.html">EVP_KEYEXCH-ECDH</a></b>(7)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                  <u><a href="../man7SSL/EVP_PKEY-EC.7SSL.html">EVP_PKEY-EC</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>