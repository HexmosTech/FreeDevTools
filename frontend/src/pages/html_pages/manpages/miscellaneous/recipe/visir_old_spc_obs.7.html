<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>visir_old_spc_obs - Old DRS detector: Spectroscopic Observation recipe</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/noble/+package/cpl-plugin-visir-doc">cpl-plugin-visir-doc_4.4.2+dfsg-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       visir_old_spc_obs - Old DRS detector: Spectroscopic Observation recipe

</pre><h4><b>SYNOPSIS</b></h4><pre>
       esorex <b>visir_old_spc_obs</b> [OPTIONS] FILE.sof

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  recipe estimates the dispersion relation using the atmospheric spectrum in a long-slit spectroscopy
       half-cycle frame.

       It also extracts the spectrum of an observed object using a combined frame.

       The files listed in the Set Of Frames (sof-file) must be  tagged:  VISIR-Long-Slit-Spectroscopy-file.fits
       SPEC_OBS_LMR                 VISIR-Quantum-Efficiency-Calibration-file.fits                 SPEC_CAL_QEFF
       VISIR-Atmospheric-Emission-Lines-Calibration-file.fits SPEC_CAL_LINES

       Additionally, a bad pixel map with a PRO.CATG of SPEC_BPM may be added to the Set  Of  Frames  with  tag:
       BPM.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>--nod</b> <u>&lt;str&gt;</u>
              An  optional  ASCII  specification  of  the  nodding  positions (in case they are missing from the
              FITS-file). The file must consist of one line per input FITS-file and each line must consist of an
              integer (which is ignored) followed by a 0 or 1 (to  indicate  object  or  sky).   (str;  default:
              ´NONE´).   The   full   name   of   this   option   for   the   EsoRex   configuration   file   is
              <b>visir.visir_old_spc_obs.nodding</b> [default = <u>NONE</u>].

       <b>--auto_bpm</b> <u>&lt;bool&gt;</u>
              Automatic detection and correction of bad pixels (bool; default: True).  The  full  name  of  this
              option for the EsoRex configuration file is <b>visir.visir_old_spc_obs.auto_bpm</b> [default = <u>True</u>].

       <b>--g</b> <u>&lt;bool&gt;</u>
              Automatic  filtering  of  glitches  (bool;  default:  False). The full name of this option for the
              EsoRex configuration file is <b>visir.visir_old_spc_obs.rem_glitch</b> [default = <u>False</u>].

       <b>--p</b> <u>&lt;bool&gt;</u>
              Automatic purging of half-cycle images whose median deviates more than a  factor  three  from  the
              mean  of  the medians of half-cycle images or whose standard deviation deviates more than a factor
              three from the mean of their standard deviations (bool; default: False). The  full  name  of  this
              option for the EsoRex configuration file is <b>visir.visir_old_spc_obs.purge_bad</b> [default = <u>False</u>].

       <b>--union</b> <u>&lt;bool&gt;</u>
              Combine  images  using  their union, as opposed to their intersection (deprecated and ignored, see
              --combine_method) (bool; default: True). The full name of this option for the EsoRex configuration
              file is <b>visir.visir_old_spc_obs.union</b> [default = <u>True</u>].

       <b>--rej</b> <u>&lt;str&gt;</u>
              Each resulting pixel is the average of  the  corresponding  (interpolated)  pixel  value  in  each
              jittered  image.  A  positive value, n1, for the first of the two integers specifies that for each
              pixel the smallest n1 pixel values shall be ignored  in  the  averaging.   Similarly,  a  positive
              value,  n2,  for the second of the two integers specifies that for each pixel the largest n2 pixel
              values shall be ignored in the averaging. (str; default: ´0-0´). The full name of this option  for
              the EsoRex configuration file is <b>visir.visir_old_spc_obs.rej</b> [default = <u>0-0</u>].

       <b>--bkgcorrect</b> <u>&lt;bool&gt;</u>
              Subtract  the  median  from the spectral column before extracting the wavelength. This is required
              when the skylines do not correctly cancel due to gratting oscillations (bool; default: True).  The
              full  name  of this option for the EsoRex configuration file is <b>visir.visir_old_spc_obs.bkgcorrect</b>
              [default = <u>True</u>].

       <b>--plot</b> <u>&lt;int&gt;</u>
              The recipe can produce a number of predefined plots.  Zero  means  that  none  of  the  plots  are
              produced,  while  increasing  values  (e.g. 1 or 2) increases the number of plots produced. If the
              plotting fails a warning is produced, and the recipe  continues.  The  default  behaviour  of  the
              plotting  is  to  use gnuplot (with option -persist). The recipe currently produces 1D-plots using
              gnuplot commands. The recipe user can control the actual plotting-command used by  the  recipe  to
              create  the plot by setting the environment variable CPL_PLOTTER. Currently, if CPL_PLOTTER is set
              it must contain the string ´gnuplot´. Setting it to ´cat &gt; my_gnuplot_$$.txt´ causes a  number  of
              ASCII-files to be created, which each produce a plot when given as standard input to gnuplot (e.g.
              later  or  on  a  different  computer). A finer control of the plotting options can be obtained by
              writing an executable script, e.g. my_gnuplot.pl, that executes gnuplot after setting the  desired
              gnuplot  options  (e.g. set terminal pslatex color) and then setting CPL_PLOTTER to my_gnuplot.pl.
              The predefined plots include plotting of images. Images can be plotted not only with gnuplot,  but
              also  using  the  pnm  format.  This  is  controlled  with the environment variable CPL_IMAGER. If
              CPL_IMAGER is set to a string that does not contain the word gnuplot, the recipe will generate the
              plot in pnm format. E.g.  setting CPL_IMAGER to ´display - &amp;´  will  produce  a  gray-scale  image
              using  the  image  viewer  display. (int; default: 0). The full name of this option for the EsoRex
              configuration file is <b>visir.visir_old_spc_obs.plot</b> [default = <u>0</u>].

       <b>--slit_skew</b> <u>&lt;float&gt;</u>
              Distortion correction: Skew of slit (degrees) (clockwise) (float; default: 0.52). The full name of
              this option for the EsoRex configuration file is <b>visir.visir_old_spc_obs.phi</b> [default = <u>0.52</u>].

       <b>--spectrum_skew</b> <u>&lt;float&gt;</u>
              Distortion correction: LMR Skew of spectrum (degrees)  (counter-  clockwise).  Not  used  in  High
              Resolution  (float; default: 1.73). The full name of this option for the EsoRex configuration file
              is <b>visir.visir_old_spc_obs.ksi</b> [default = <u>1.73</u>].

       <b>--vert_arc</b> <u>&lt;float&gt;</u>
              Distortion correction: LR Detector vertical curvature (pixel). Reduced by a factor 4  in  MR.  Not
              used in HR A-side. Increased by a factor 115/52 in HR B-side (float; default: -0.8). The full name
              of this option for the EsoRex configuration file is <b>visir.visir_old_spc_obs.eps</b> [default = <u>-0.8</u>].

       <b>--hori_arc</b> <u>&lt;float&gt;</u>
              Distortion correction: LMR Detector horizontal curvature (pixel).  Increased by a factor 1.5 in HR
              A-side. Reduced by a factor 2 in HR B-side (float; default: 0.0). The full name of this option for
              the EsoRex configuration file is <b>visir.visir_old_spc_obs.delta</b> [default = <u>0.0</u>].

       <b>--off</b> <u>&lt;str&gt;</u>
              An  optional  ASCII  specification  of  the  offsets in case those in FITS- headers are missing or
              wrong. The file must consist of one line per input pair of FITS-files, and each line must  consist
              of  two numbers which represent the shift in pixels of that image relative to the first image. The
              first line should thus comprise two zeros. Correct FITS-header offsets mean that the i´th X offset
              can be gotten from Xoffset_0 - Xoffset_i, where Xoffset_i is the value of ESO SEQ  CUMOFFSETX  and
              likewise  for Y. (str; default: ´NONE´). The full name of this option for the EsoRex configuration
              file is <b>visir.visir_old_spc_obs.offsets</b> [default = <u>NONE</u>].

       <b>--ref</b> <u>&lt;bool&gt;</u>
              User-defined refining of the image offsets. See options objs and xcorr (bool; default: False). The
              full name of this option for  the  EsoRex  configuration  file  is  <b>visir.visir_old_spc_obs.refine</b>
              [default = <u>False</u>].

       <b>--objs</b> <u>&lt;str&gt;</u>
              The  shift  and  add  of  images  needs anchor points that typically are bright objects. These are
              normally detected automatically but with user-defined refining of offsets enabled,  they  must  be
              provided  by  the  user  through an ASCII file containing one line per anchor point with each line
              consisting of its x and y coordinate (in pixels). This file is ignored with user-defined  refining
              of  offsets  disabled.  (str;  default:  ´NONE´).  The  full  name  of  this option for the EsoRex
              configuration file is <b>visir.visir_old_spc_obs.objects</b> [default = <u>NONE</u>].

       <b>--xcorr</b> <u>&lt;str&gt;</u>
              If user-defined refining of offsets is enabled a cross-correlation of the images is performed.  In
              order  to  speed  up  this process, this cross-correlation is performed only on smaller rectangles
              around the anchor points. The first two parameters is the half-size of this rectangle  in  pixels.
              The second pair is the maximum shift in x and y (pixels) evaluated by the cross-correlation on the
              rectangle.   Used   only   if   user-defined  refining  of  offsets  is  enabled.  (str;  default:
              ´10-10-25-25´).  The  full  name  of  this  option  for   the   EsoRex   configuration   file   is
              <b>visir.visir_old_spc_obs.xcorr</b> [default = <u>10-10-25-25</u>].

       <b>--fixcombi</b> <u>&lt;bool&gt;</u>
              Perform  the  distortion correction on the combined image, and not on each of the jittered images.
              This will reduce excution time and degrade the quality  of  the  combined  image  (bool;  default:
              False).    The   full   name   of   this   option   for   the   EsoRex   configuration   file   is
              <b>visir.visir_old_spc_obs.fixcombi</b> [default = <u>False</u>].

       <b>--emis_tol</b> <u>&lt;float&gt;</u>
              The computation of the mean and standard deviation of the sensitivity is done for wavelengths with
              an atmospheric emissivity of at most emis_min + emis_tol * (emis_max - emis_min),  where  emis_min
              is the minimum emissivity in the observed wavelength range and emis_max is the ditto maximum. Thus
              emis_tol = 1 means that all wavelengths are included. (float; default: 1.0). The full name of this
              option for the EsoRex configuration file is <b>visir.visir_old_spc_obs.emis_tol</b> [default = <u>1.0</u>].

       <b>--destripe_iterations</b> <u>&lt;int&gt;</u>
              Max  number  of  destriping  iterations  (0 to disable destriping).  Horizontal destriping is done
              first and if no horizontal striping is detected, vertical destriping is performed  (int;  default:
              15).    The    full    name    of   this   option   for   the   EsoRex   configuration   file   is
              <b>visir.visir_old_spc_obs.nstripe</b> [default = <u>15</u>].

       <b>--destripe_morpho</b> <u>&lt;bool&gt;</u>
              Destripe with morphological cleaning (bool; default: False). The full name of this option for  the
              EsoRex configuration file is <b>visir.visir_old_spc_obs.mstripe</b> [default = <u>False</u>].

       <b>--rl</b> <u>&lt;int&gt;</u>
              Reject  leftmost  columns  in spectrum extraction, zero means all columns on the left are used. In
              cross-dispersion mode a (small) negative number may be used (pixel) (int; default:  0).  The  full
              name  of  this  option  for  the  EsoRex configuration file is <b>visir.visir_old_spc_obs.reject_left</b>
              [default = <u>0</u>].

       <b>--rr</b> <u>&lt;int&gt;</u>
              Reject rightmost columns in spectrum extraction, zero means all columns on the right are used.  In
              cross-dispersion  mode  a  (small) negative number may be used (pixel) (int; default: 0). The full
              name of this option for the  EsoRex  configuration  file  is  <b>visir.visir_old_spc_obs.reject_right</b>
              [default = <u>0</u>].

       <b>--apfile</b> <u>&lt;str&gt;</u>
              An  optional  ASCII  file  specification  of  the  aperture  definitions  to  use  during spectral
              extraction. Each line must contain either 3 fields for optimal extraction, or an  even  number  of
              fields  greater  than  5  for aperture extraction. For optimal extraction, the 1st field should be
              ´O´, and for aperture extraction it should be ´A´. In both cases the next pair of fields  indicate
              the  left  &amp;  right  edges  of  the source aperture in pixel coordinates. For aperture extraction,
              fields after the 3rd define the sky apertures coordinates,  with  the  4th  field  indicating  the
              method  used  to  determine  the  sky  background  [one of ´A´ (average), ´F´ (linear fit), or ´M´
              (median)] followed by at least one pair of pixel coordinates representing the left &amp; right edge of
              a sky aperture. You may supply more sky apertures by supplying additional pixel  coordinate  pairs
              after the first.  Multiple lines targeting the same order are allowed. (str; default: ´NONE´). The
              full  name  of  this  option  for  the EsoRex configuration file is <b>visir.visir_old_spc_obs.apfile</b>
              [default = <u>NONE</u>].

       <b>--ro_noise</b> <u>&lt;float&gt;</u>
              Readout noise of the detector (float; default: 14.5). The full name of this option for the  EsoRex
              configuration file is <b>visir.visir_old_spc_obs.ron</b> [default = <u>14.5</u>].

       <b>--ox_sigma</b> <u>&lt;float&gt;</u>
              Sigma  to  use  for  clipping  in  optimal extraction (float; default: 5.0). The full name of this
              option for the EsoRex configuration file is <b>visir.visir_old_spc_obs.optex_sigma</b> [default = <u>5.0</u>].

       <b>--ox_niters</b> <u>&lt;int&gt;</u>
              Number of optimal extraction iterations to perform (int; default: 2). The full name of this option
              for the EsoRex configuration file is <b>visir.visir_old_spc_obs.optex_niters</b> [default = <u>2</u>].

       <b>--ox_smooth</b> <u>&lt;int&gt;</u>
              Width of smoothing window to use along spectral dimension  during  optimal  extraction.  A  median
              filter is used. (int; default: 31). The full name of this option for the EsoRex configuration file
              is <b>visir.visir_old_spc_obs.optex_smooth</b> [default = <u>31</u>].

       <b>--gain</b> <u>&lt;float&gt;</u>
              Detector  gain  (float;  default: 0.75). The full name of this option for the EsoRex configuration
              file is <b>visir.visir_old_spc_obs.gain</b> [default = <u>0.75</u>].

       <b>--ox_kernel</b> <u>&lt;int&gt;</u>
              Size of square smoothing kernel, in pixels, to apply to science frame  before  optimal  extraction
              (ignored during aperture extraction). A median filter is used. (int; default: 3). The full name of
              this  option  for the EsoRex configuration file is <b>visir.visir_old_spc_obs.optex_kernel</b> [default =
              <u>3</u>].

       <b>--respcal</b> <u>&lt;str&gt;</u>
              An optional path to a FITS file containing a 1-D fringe model to be divided into the 1-D extracted
              spectra in order to remove the fringes.  (str; default: ´NONE´). The full name of this option  for
              the EsoRex configuration file is <b>visir.visir_old_spc_obs.respcal</b> [default = <u>NONE</u>].

       Note  that  it  is  possible to create a configuration file containing these options, along with suitable
       default values. Please refer to the details provided by the 'esorex --help' command.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       The full documentation for the visir pipeline can be downloaded as a PDF file using the following URL:

              <b><a href="ftp://ftp.eso.org/pub/dfs/pipelines/visir/visir-pipeline-manual-1.4.pdf">ftp://ftp.eso.org/pub/dfs/pipelines/visir/visir-pipeline-manual-1.4.pdf</a></b>

       An   overview   over   the   existing   ESO   pipelines    can    be    found    on    the    web    page
       <b>https://www.eso.org/sci/software/pipelines/</b>.

       Basic documentation about the EsoRex program can be found at the esorex (1) man page.

       It   is   possible   to   call   the   pipelines   from   python   using  the  python-cpl  package.   See
       <b>https://packages.python.org/python-cpl/index.html</b> for further information.

       The other recipes of the visir  pipeline  are  <u><a href="../man7/visir_img_dark.7.html">visir_img_dark</a></u>(7),  <u><a href="../man7/visir_img_ff.7.html">visir_img_ff</a></u>(7),  <u><a href="../man7/visir_img_reduce.7.html">visir_img_reduce</a></u>(7),
       <u><a href="../man7/visir_img_trans.7.html">visir_img_trans</a></u>(7),     <u><a href="../man7/visir_old_img_combine.7.html">visir_old_img_combine</a></u>(7),     <u><a href="../man7/visir_old_img_phot.7.html">visir_old_img_phot</a></u>(7),    <u><a href="../man7/visir_old_spc_obs_ech.7.html">visir_old_spc_obs_ech</a></u>(7),
       <u><a href="../man7/visir_old_spc_phot.7.html">visir_old_spc_phot</a></u>(7),   <u><a href="../man7/visir_old_spc_phot_ech.7.html">visir_old_spc_phot_ech</a></u>(7),   <u><a href="../man7/visir_old_spc_wcal.7.html">visir_old_spc_wcal</a></u>(7),   <u><a href="../man7/visir_old_spc_wcal_ech.7.html">visir_old_spc_wcal_ech</a></u>(7),
       <u><a href="../man7/visir_old_util_destripe.7.html">visir_old_util_destripe</a></u>(7),     <u><a href="../man7/visir_spc_reduce.7.html">visir_spc_reduce</a></u>(7),    <u><a href="../man7/visir_util_apply_calib.7.html">visir_util_apply_calib</a></u>(7),    <u><a href="../man7/visir_util_clip.7.html">visir_util_clip</a></u>(7),
       <u><a href="../man7/visir_util_convert_weight.7.html">visir_util_convert_weight</a></u>(7), <u><a href="../man7/visir_util_detect_shift.7.html">visir_util_detect_shift</a></u>(7), <u><a href="../man7/visir_util_img_std_cat.7.html">visir_util_img_std_cat</a></u>(7),  <u><a href="../man7/visir_util_join.7.html">visir_util_join</a></u>(7),
       <u><a href="../man7/visir_util_qc.7.html">visir_util_qc</a></u>(7),      <u><a href="../man7/visir_util_repack.7.html">visir_util_repack</a></u>(7),      <u><a href="../man7/visir_util_run_swarp.7.html">visir_util_run_swarp</a></u>(7),     <u><a href="../man7/visir_util_spc_std_cat.7.html">visir_util_spc_std_cat</a></u>(7),
       <u><a href="../man7/visir_util_spc_txt2fits.7.html">visir_util_spc_txt2fits</a></u>(7), <u><a href="../man7/visir_util_undistort.7.html">visir_util_undistort</a></u>(7)

</pre><h4><b>VERSION</b></h4><pre>
       visir_old_spc_obs 4.4.2

</pre><h4><b>AUTHOR</b></h4><pre>
       Lars Lundin &lt;https://support.eso.org&gt;

</pre><h4><b>BUG</b> <b>REPORTS</b></h4><pre>
       Please report any problems to https://support.eso.org. Alternatively, you may send a report  to  the  ESO
       User Support Department &lt;<a href="mailto:usd-help@eso.org">usd-help@eso.org</a>&gt;.

</pre><h4><b>LICENSE</b></h4><pre>
       This file is part of the VISIR Instrument Pipeline Copyright (C) 2004, 2005 European Southern Observatory

       This  program  is  free  software;  you  can  redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation; either version 2 of the License,  or
       (at your option) any later version.

       This  program  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General  Public
       License for more details.

       You  should have received a copy of the GNU General Public License along with this program; if not, write
       to the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02111-1307  USA

visir_old_spc_obs                                     4.4.2                                 <u><a href="../man7/VISIR_OLD_SPC_OBS.7.html">VISIR_OLD_SPC_OBS</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>