<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>apparmor_xattrs - AppArmor profile xattr(7) matching</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/apparmor">apparmor_4.1.1-0ubuntu6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       apparmor_xattrs - AppArmor profile <a href="../man7/xattr.7.html">xattr</a>(7) matching

</pre><h4><b>DESCRIPTION</b></h4><pre>
       AppArmor profiles can conditionally match files based on the presence and value of extended attributes in
       addition to file path. The following profile applies to any file under "<a href="file:/usr/bin">/usr/bin</a>" where the
       "security.apparmor" extended attribute has the value "trusted":

               profile trusted <a href="file:/usr/bin/">/usr/bin/</a>* xattrs=(security.apparmor="trusted") {
                       # ...
               }

       Note that "security.apparmor" and "trusted" are arbitrary, and profiles can match based on the value of
       any attribute.

       The xattrs value may also contain a path regex:

               profile trusted <a href="file:/usr/bin/">/usr/bin/</a>* xattrs=(user.trust="tier/*") {

                       # ...
               }

       The <b><a href="../man1/getfattr.1.html">getfattr</a></b>(1) and <b><a href="../man1/setfattr.1.html">setfattr</a></b>(1) tools can be used to view and manage xattr values:

               $ setfattr -n 'security.apparmor' -v 'trusted' /usr/bin/example-tool
               $ getfattr --absolute-names -d -m - /usr/bin/example-tool
               # file: usr/bin/example-tool
               security.apparmor="trusted"

       The priority of each profile is determined by the length of the path, then the number of xattrs
       specified. A more specific path is preferred over xattr matches:

               # Highest priority, longest path.
               profile example1 /usr/bin/example-tool {
                       # ...
               }

               # Lower priority than the longer path, but higher priority than a rule
               # with fewer xattr matches.
               profile example2 <a href="file:/usr/">/usr/</a>** xattrs=(
                       security.apparmor="trusted"
                       user.domain="**"
               ) {
                       # ...
               }

               # Lowest priority. Same path length as the second profile, but has
               # fewer xattr matches.
               profile example2 <a href="file:/usr/">/usr/</a>** {
                       # ...
               }

       xattr matching requires the following kernel feature:

               <a href="file:/sys/kernel/security/apparmor/features/domain/attach_conditions/xattr">/sys/kernel/security/apparmor/features/domain/attach_conditions/xattr</a>

</pre><h4><b>KNOWN</b> <b>ISSUES</b></h4><pre>
       AppArmor profiles currently can't reliably match extended attributes with binary values such as
       security.evm and security.ima. In the future AppArmor may gain the ability to match based on the presence
       of certain attributes while ignoring their values.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/apparmor.8.html">apparmor</a></b>(8), <b><a href="../man8/apparmor_parser.8.html">apparmor_parser</a></b>(8), <b><a href="../man5/apparmor.d.5.html">apparmor.d</a></b>(5), <b><a href="../man7/xattr.7.html">xattr</a></b>(7), <b><a href="../man1/aa-autodep.1.html">aa-autodep</a></b>(1), <b><a href="../man1/clean.1.html">clean</a></b>(1), <b><a href="../man8/auditd.8.html">auditd</a></b>(8),
       <b><a href="../man1/getfattr.1.html">getfattr</a></b>(1), <b><a href="../man1/setfattr.1.html">setfattr</a></b>(1), and &lt;https://wiki.apparmor.net&gt;.

AppArmor 4.1.1                                     2025-07-23                                 <u><a href="../man7/APPARMOR_XATTRS.7.html">APPARMOR_XATTRS</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>