<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_KDF-TLS1_PRF - The TLS1 PRF EVP_KDF implementation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_KDF-TLS1_PRF - The TLS1 PRF EVP_KDF implementation

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Support for computing the <b>TLS1</b> PRF through the <b>EVP_KDF</b> API.

       The EVP_KDF-TLS1_PRF algorithm implements the PRF used by TLS versions up to and including TLS 1.2.

       The output is considered to be keying material.

   <b>Identity</b>
       "TLS1-PRF" is the name for this implementation; it can be used with the <b>EVP_KDF_fetch()</b> function.

   <b>Supported</b> <b>parameters</b>
       The supported parameters are:

       "properties" (<b>OSSL_KDF_PARAM_PROPERTIES</b>) &lt;UTF8 string&gt;
       "digest" (<b>OSSL_KDF_PARAM_DIGEST</b>) &lt;UTF8 string&gt;
           These parameters work as described in "PARAMETERS" in <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3).

           The  <b>OSSL_KDF_PARAM_DIGEST</b>  parameter  is used to set the message digest associated with the TLS PRF.
           <b>EVP_md5_sha1()</b> is treated as a special case which uses the PRF algorithm using both <b>MD5</b> and  <b>SHA1</b>  as
           used in TLS 1.0 and 1.1.

       "secret" (<b>OSSL_KDF_PARAM_SECRET</b>) &lt;octet string&gt;
           This parameter sets the secret value of the TLS PRF.  Any existing secret value is replaced.

       "seed" (<b>OSSL_KDF_PARAM_SEED</b>) &lt;octet string&gt;
           This  parameter sets the context seed.  The length of the context seed cannot exceed 1024 bytes; this
           should be more than enough for any normal use of the TLS PRF.

       The OpenSSL FIPS provider also supports the following parameters:

       "fips-indicator" (<b>OSSL_KDF_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           A getter that returns 1 if the operation is FIPS approved, or 0 otherwise.  This may  be  used  after
           calling  EVP_KDF_derive.  It returns 0 if any "***-check" related parameter is set to 0 and the check
           fails.

       "ems_check" (<b>OSSL_KDF_PARAM_FIPS_EMS_CHECK</b>) &lt;integer&gt;
           The default value of 1 causes an error during <b>EVP_KDF_derive()</b> if "master secret" is used instead  of
           "extended  master  secret"  Setting  this  to  zero will ignore the error and set the approved "fips-
           indicator" to 0.  This option breaks FIPS compliance if it causes the  approved  "fips-indicator"  to
           return 0.

       "digest-check" (<b>OSSL_KDF_PARAM_FIPS_DIGEST_CHECK</b>) &lt;integer&gt;
           The  default  value  of  1  causes  an  error  during  <b>EVP_KDF_CTX_set_params()</b> if used digest is not
           approved.  Setting this to zero will ignore the error and set the  approved  "fips-indicator"  to  0.
           This option breaks FIPS compliance if it causes the approved "fips-indicator" to return 0.

           According  to  SP  800-135r1,  the  following  are  approved  digest  algorithms: SHA2-256, SHA2-384,
           SHA2-512.

       "key-check" (<b>OSSL_KDF_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
           The default value of 1 causes an error during <b>EVP_KDF_CTX_set_params()</b> if the  length  of  used  key-
           derivation  key  (<b>OSSL_KDF_PARAM_SECRET</b>)  is shorter than 112 bits.  Setting this to zero will ignore
           the error and set the approved "fips-indicator" to 0.  This  option  breaks  FIPS  compliance  if  it
           causes the approved "fips-indicator" to return 0.

</pre><h4><b>NOTES</b></h4><pre>
       A context for the TLS PRF can be obtained by calling:

        EVP_KDF *kdf = EVP_KDF_fetch(NULL, "TLS1-PRF", NULL);
        EVP_KDF_CTX *kctx = EVP_KDF_CTX_new(kdf);

       The digest, secret value and seed must be set before a key is derived otherwise an error will occur.

       The output length of the PRF is specified by the <u>keylen</u> parameter to the <b>EVP_KDF_derive()</b> function.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This example derives 10 bytes using SHA-256 with the secret key "secret" and seed value "seed":

        EVP_KDF *kdf;
        EVP_KDF_CTX *kctx;
        unsigned char out[10];
        OSSL_PARAM params[4], *p = params;

        kdf = EVP_KDF_fetch(NULL, "TLS1-PRF", NULL);
        kctx = EVP_KDF_CTX_new(kdf);
        EVP_KDF_free(kdf);

        *p++ = OSSL_PARAM_construct_utf8_string(OSSL_KDF_PARAM_DIGEST,
                                                SN_sha256, strlen(SN_sha256));
        *p++ = OSSL_PARAM_construct_octet_string(OSSL_KDF_PARAM_SECRET,
                                                 "secret", (size_t)6);
        *p++ = OSSL_PARAM_construct_octet_string(OSSL_KDF_PARAM_SEED,
                                                 "seed", (size_t)4);
        *p = OSSL_PARAM_construct_end();
        if (EVP_KDF_derive(kctx, out, sizeof(out), params) &lt;= 0) {
            error("EVP_KDF_derive");
        }
        EVP_KDF_CTX_free(kctx);

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       RFC 2246, RFC 5246 and NIST SP 800-135 r1

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3),   <b><a href="../man3/EVP_KDF_CTX_new.3.html">EVP_KDF_CTX_new</a></b>(3),   <b><a href="../man3/EVP_KDF_CTX_free.3.html">EVP_KDF_CTX_free</a></b>(3),   <b><a href="../man3/EVP_KDF_CTX_set_params.3.html">EVP_KDF_CTX_set_params</a></b>(3),  <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3),
       "PARAMETERS" in <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       This functionality was added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2018-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                             <u><a href="../man7SSL/EVP_KDF-TLS1_PRF.7SSL.html">EVP_KDF-TLS1_PRF</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>