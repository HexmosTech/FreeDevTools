<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_KDF-TLS13_KDF - The TLS 1.3 EVP_KDF implementation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_KDF-TLS13_KDF - The TLS 1.3 EVP_KDF implementation

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Support for computing the TLS 1.3 version of the <b>HKDF</b> KDF through the <b>EVP_KDF</b> API.

       The EVP_KDF-TLS13_KDF algorithm implements the HKDF key derivation function as used by TLS 1.3.

       The output is considered to be keying material.

   <b>Identity</b>
       "TLS13-KDF" is the name for this implementation; it can be used with the <b>EVP_KDF_fetch()</b> function.

   <b>Supported</b> <b>parameters</b>
       The supported parameters are:

       "properties" (<b>OSSL_KDF_PARAM_PROPERTIES</b>) &lt;UTF8 string&gt;
       "digest" (<b>OSSL_KDF_PARAM_DIGEST</b>) &lt;UTF8 string&gt;
       "key" (<b>OSSL_KDF_PARAM_KEY</b>) &lt;octet string&gt;
       "salt" (<b>OSSL_KDF_PARAM_SALT</b>) &lt;octet string&gt;
           These parameters work as described in "PARAMETERS" in <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3).

       "prefix" (<b>OSSL_KDF_PARAM_PREFIX</b>) &lt;octet string&gt;
           This  parameter  sets the label prefix on the specified TLS 1.3 KDF context.  For TLS 1.3 this should
           be set to the ASCII string "tls13 " without a trailing zero byte.  Refer to RFC 8446 section 7.1 "Key
           Schedule" for details.

       "label" (<b>OSSL_KDF_PARAM_LABEL</b>) &lt;octet string&gt;
           This parameter sets the label on the specified TLS 1.3 KDF context.  Refer to RFC  8446  section  7.1
           "Key Schedule" for details.

       "data" (<b>OSSL_KDF_PARAM_DATA</b>) &lt;octet string&gt;
           This parameter sets the context data on the specified TLS 1.3 KDF context.  Refer to RFC 8446 section
           7.1 "Key Schedule" for details.

       "mode" (<b>OSSL_KDF_PARAM_MODE</b>) &lt;UTF8 string&gt; or &lt;integer&gt;
           This  parameter  sets the mode for the TLS 1.3 KDF operation.  There are two modes that are currently
           defined:

           "EXTRACT_ONLY" or <b>EVP_KDF_HKDF_MODE_EXTRACT_ONLY</b>
               In this mode calling <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3)  will  just  perform  the  extract  operation.  The  value
               returned  will  be  the  intermediate fixed-length pseudorandom key K.  The <u>keylen</u> parameter must
               match the size of K, which can be looked up by calling <b>EVP_KDF_CTX_get_kdf_size()</b>  after  setting
               the mode and digest.

               The  digest,  key  and  salt  values  must be set before a key is derived otherwise an error will
               occur.

           "EXPAND_ONLY" or <b>EVP_KDF_HKDF_MODE_EXPAND_ONLY</b>
               In this mode calling <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3) will just perform the  expand  operation.  The  input  key
               should  be  set  to  the  intermediate  fixed-length  pseudorandom key K returned from a previous
               extract operation.

               The digest, key and info values must be set before a key  is  derived  otherwise  an  error  will
               occur.

       The OpenSSL FIPS provider also supports the following parameters:

       "fips-indicator" (<b>OSSL_KDF_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           A  getter  that  returns 1 if the operation is FIPS approved, or 0 otherwise.  This may be used after
           calling EVP_KDF_derive. It returns 0 if any "***-check" related parameter is set to 0 and  the  check
           fails.

       "digest-check" (<b>OSSL_KDF_PARAM_FIPS_DIGEST_CHECK</b>) &lt;integer&gt;
           The  default  value  of  1  causes  an  error  during  <b>EVP_KDF_CTX_set_params()</b> if used digest is not
           approved.  Setting this to zero will ignore the error and set the  approved  "fips-indicator"  to  0.
           This option breaks FIPS compliance if it causes the approved "fips-indicator" to return 0.

           According to RFC 8446, the following are approved digest algorithms: SHA2-256, SHA2-384.

       "key-check" (<b>OSSL_KDF_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
           The  default  value  of  1 causes an error during <b>EVP_KDF_CTX_set_params()</b> if the length of used key-
           derivation key (<b>OSSL_KDF_PARAM_KEY</b>) is shorter than 112 bits.  Setting this to zero will  ignore  the
           error  and  set  the approved "fips-indicator" to 0.  This option breaks FIPS compliance if it causes
           the approved "fips-indicator" to return 0.

</pre><h4><b>NOTES</b></h4><pre>
       This KDF is intended for use by the TLS 1.3 implementation in  libssl.   It  does  not  support  all  the
       options and capabilities that HKDF does.

       The  <u>OSSL_PARAM</u>  array  passed  to <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3) or <b><a href="../man3/EVP_KDF_CTX_set_params.3.html">EVP_KDF_CTX_set_params</a></b>(3) must specify all of the
       parameters required.  This KDF does not support a piecemeal approach to providing these.

       A context for a TLS 1.3 KDF can be obtained by calling:

        EVP_KDF *kdf = EVP_KDF_fetch(NULL, "TLS13-KDF", NULL);
        EVP_KDF_CTX *kctx = EVP_KDF_CTX_new(kdf);

       The output length of a TLS 1.3 KDF expand  operation  is  specified  via  the  <u>keylen</u>  parameter  to  the
       <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3)  function.   When  using EVP_KDF_HKDF_MODE_EXTRACT_ONLY the <u>keylen</u> parameter must equal
       the size of the intermediate fixed-length pseudorandom key otherwise an error will occur.  For that mode,
       the fixed output size can be looked up by calling <b>EVP_KDF_CTX_get_kdf_size()</b> after setting the  mode  and
       digest on the <b>EVP_KDF_CTX</b>.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       RFC 8446

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3),         <b><a href="../man3/EVP_KDF_CTX_new.3.html">EVP_KDF_CTX_new</a></b>(3),         <b><a href="../man3/EVP_KDF_CTX_free.3.html">EVP_KDF_CTX_free</a></b>(3),         <b><a href="../man3/EVP_KDF_CTX_get_kdf_size.3.html">EVP_KDF_CTX_get_kdf_size</a></b>(3),
       <b><a href="../man3/EVP_KDF_CTX_set_params.3.html">EVP_KDF_CTX_set_params</a></b>(3), <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3), "PARAMETERS" in <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3), <b><a href="../man7/EVP_KDF-HKDF.7.html">EVP_KDF-HKDF</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       This functionality was added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2021-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                            <u><a href="../man7SSL/EVP_KDF-TLS13_KDF.7SSL.html">EVP_KDF-TLS13_KDF</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>