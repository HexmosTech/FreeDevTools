<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Elvish Package Manager (epm) is a module bundled with Elvish for managing third-party packages.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/elvish">elvish_0.17.0-1ubuntu0.1_amd64</a> <br><br><pre>
</pre><h4><b>Introduction</b></h4><pre>
       The Elvish Package Manager (epm) is a module bundled with Elvish for managing third-party packages.

       In Elvish terminology, a <b>module</b> is a .elv file that can be imported with the use command, while a <b>package</b>
       is  a  collection of modules that are usually kept in the same repository as one coherent project and may
       have interdependencies.  The Elvish language itself only deals with modules; the concept of package is  a
       matter of how to organize modules.

       Like the go command, Elvish does <b>not</b> have a central registry of packages.  A package is simply identified
       by  the  URL  of its code repository, e.g.  github.com/elves/sample-pkg (https://github.com/elves/sample-
       pkg).  To install the package, one simply uses the following:

              use epm
              epm:install github.com/elves/sample-pkg

       epm knows out-of-the-box how to manage packages hosted in GitHub, BitBucket and GitLab, and requires  the
       git  command to be available.  It can also copy files via git or rsync from arbitrary locations (see Cus‐
       tom package domains for details).

       Once installed, modules in this package can be imported with use  github.com/elves/sample-pkg/....   This
       package has a module named sample-mod containing a function sample-fn, and can be used like this:

              ~&gt; use github.com/elves/sample-pkg/sample-mod
              ~&gt; sample-mod:sample-fn
              This is a sample function in a sample module in a sample package

<b>The</b> <b>epm</b>-managed directory
       Elvish searches for modules in multiple directories, and epm only manages one of them:

       • On  UNIX,  epm  manages  $XDG_DATA_HOME/elvish/lib, defaulting to <a href="file:~/.local/share/elvish/lib">~/.local/share/elvish/lib</a> if $XDG_DA‐
         TA_HOME is unset or empty;

       • On Windows, epm manages %LocalAppData%\elvish\lib.

       This directory is called the epm-managed directory, and its path is available as $epm:managed-dir.

</pre><h4><b>Custom</b> <b>package</b> <b>domains</b></h4><pre>
       Package names in epm have the following structure: domain/path.  The domain is usually the hostname  from
       where  the  package is to be fetched, such as github.com.  The path can have one or more components sepa‐
       rated by slashes.  Usually, the full name of the package corresponds with the URL from where  it  can  be
       fetched.      For     example,     the     package    hosted    at    https://github.com/elves/sample-pkg
       (https://github.com/elves/sample-pkg) is identified as github.com/elves/sample-pkg.

       Packages are stored under the epm-managed directory in a path identical to their name.  For example,  the
       package mentioned above is stored at $epm:managed-dir/github.com/elves/sample-pkg.

       Each domain must be configured with the following information:

       • The method to use to fetch packages from the domain.  The two supported methods are git and rsync.

       • The  number  of directory levels under the domain directory in which the packages are found.  For exam‐
         ple, for github.com the number of levels is 2, since package paths have two levels (e.g.  elves/sample-
         pkg).  All packages from a given domain have the same number of levels.

       • Depending on the method, other attributes are needed:

         • git needs a protocol attribute, which can be https or http, and determines how the URL is  construct‐
           ed.

         • rsync needs a location attribute, which must be a valid source directory recognized by the rsync com‐
           mand.

       epm includes default domain configurations for github.com, gitlab.com and bitbucket.org.  These three do‐
       mains share the same configuration:

              {
                  "method": "git",
                  "protocol": "https",
                  "levels": "2"
              }

       You can define your own domain by creating a file named epm-domain.cfg in the appropriate directory under
       $epm:managed-dir.   For  example, if you want to define an elvish-dev domain which installs packages from
       your local <a href="file:~/dev/elvish/">~/dev/elvish/</a> directory, you must create the  file  $epm:managed-dir/elvish-dev/epm-domain.cfg
       with the following JSON content:

              {
                  "method": "rsync",
                  "location": "<a href="file:~/dev/elvish">~/dev/elvish</a>",
                  "levels": "1"
              }

       You can then install any directory under <a href="file:~/dev/elvish/">~/dev/elvish/</a> as a package.  For example, if you have a directo‐
       ry <a href="file:~/dev/elvish/utilities/">~/dev/elvish/utilities/</a>, the following command will install it under $epm:managed-dir/elvish-dev/util‐
       ities:

              epm:install elvish-dev/utilities

       When  you  make  any  changes  to  your  source  directory, epm:upgrade will synchronize those changes to
       $epm:managed-dir.

</pre><h4><b>Variables</b></h4><pre>
   <b>$epm:managed-dir</b> <b>{#epm:managed-dir}</b>
       The path of the epm-managed directory.

</pre><h4><b>Functions</b></h4><pre>
   <b>epm:install</b> <b>{#epm:install}</b>
              epm:install &amp;silent-if-installed=$false $pkg...

       Install the named packages.  By default, if a package is already installed,  a  message  will  be  shown.
       This  can  be  disabled  by  passing  &amp;silent-if-installed=$true,  so that already-installed packages are
       silently ignored.

   <b>epm:installed</b> <b>{#epm:installed}</b>
              epm:installed

       Return an array with all installed packages.  epm:list can be used as an alias for epm:installed.

   <b>epm:is-installed</b> <b>{#epm:is-installed}</b>
              epm:is-installed $pkg

       Returns a boolean value indicating whether the given package is installed.

   <b>epm:metadata</b> <b>{#epm:metadata}</b>
              epm:metadata $pkg

       Returns a hash containing the metadata for the given package.  Metadata for a package includes  the  fol‐
       lowing base attributes:

       • name: name of the package

       • installed: a boolean indicating whether the package is currently installed

       • method: method by which it was installed (git or rsync)

       • src: source URL of the package

       • dst:  where  the  package is (or would be) installed.  Note that this attribute is returned even if in‐
         stalled is $false.

       Additionally, packages can define arbitrary metadata attributes in a file called metadata.json  in  their
       top directory.  The following attributes are recommended:

       • description: a human-readable description of the package

       • maintainers: an array containing the package maintainers, in Name &lt;email&gt; format.

       • homepage: URL of the homepage for the package, if it has one.

       • dependencies:  an  array  listing dependencies of the current package.  Any packages listed will be in‐
         stalled automatically by epm:install if they are not yet installed.

   <b>epm:query</b> <b>{#epm:query}</b>
              epm:query $pkg

       Pretty print the available metadata of the given package.

   <b>epm:uninstall</b> <b>{#epm:uninstall}</b>
              epm:uninstall $pkg...

       Uninstall named packages.

   <b>epm:upgrade</b> <b>{#epm:upgrade}</b>
              epm:upgrade $pkg...

       Upgrade named packages.  If no package name is given, upgrade all installed packages.

Elvish 0.17.0                                     Nov 18, 2024                                     <u><a href="../man7/elvish-epm.7.html">elvish-epm</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>