<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>git-secret - bash tool to store private data inside a git repo.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/git-secret">git-secret_0.5.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>git-secret</b> - bash tool to store private data inside a git repo.

</pre><h4><b>Usage:</b> <b>Setting</b> <b>up</b> <b>git-secret</b> <b>in</b> <b>a</b> <b>repository</b></h4><pre>
       These  steps  cover  the  basic process of using <b>git-secret</b> to specify users and files that will interact
       with <b>git-secret</b>, and to encrypt and decrypt secrets.

       1.  Before starting, <u>make</u> <u>sure</u> <u>you</u> <u>have</u> <u>created</u> <u>a</u> <b>gpg</b> RSA key-pair: which are a public key and  a  secret
           key pair, identified by your email address and stored with your gpg configuration. Generally this gpg
           configuration and keys will be stored somewhere in your home directory.

       2.  Begin with an existing or new git repository.

       3.  Initialize  the  <b>git-secret</b>  repository  by  running  <b>git</b> <b>secret</b> <b>init</b>. The <b>.gitsecret/</b> folder will be
           created,  with  subdirectories  <b>keys/</b>  and  <b>paths/</b>,  <b>.gitsecret/keys/random_seed</b>  will  be  added  to
           <b>.gitignore</b>, and <b>.gitignore</b> will be configured to <u>not</u> ignore <b>.secret</b> files.

       <b>Note</b> all the contents of the <b>.gitsecret/</b> folder should be checked in, <b>/except/</b> the <b>random_seed</b> file. This
       also  means  that  of all the files in <b>.gitsecret/</b>, only the <b>random_seed</b> file should be mentioned in your
       <b>.gitignore</b> file.

       1.  Add the first user to the <b>git-secret</b> repo keyring by running <b>git</b> <b>secret</b> <b>tell</b> <b><a href="mailto:your@email.id">your@email.id</a></b>.

       2.  Now it´s time to add files you wish to encrypt inside the <b>git-secret</b> repository. This can be done  by
           running  <b>git</b>  <b>secret</b>  <b>add</b>  <b>&lt;filenames...&gt;</b>  command,  which  will  also  (as  of 0.2.6) add entries to
           <b>.gitignore</b>, stopping those files from being be added or committed to the repo unencrypted.

       3.  Then run <b>git</b> <b>secret</b> <b>hide</b> to encrypt the files you added with  <b>git</b>  <b>secret</b>  <b>add</b>.  The  files  will  be
           encrypted  with  the  public  keys  in your git-secret repo´s keyring, each corresponding to a user´s
           email that you used with <b>tell</b>.

       After using <b>git</b> <b>secret</b> <b>hide</b> to encrypt your  data,  it  is  safe  to  commit  your  changes.  <b>NOTE:</b>  It´s
       recommended to add the <b>git</b> <b>secret</b> <b>hide</b> command to your <b>pre-commit</b> hook, so you won´t miss any changes.

       1.  Later  you  can  decrypt  files with the <b>git</b> <b>secret</b> <b>reveal</b> command, or print their contents to stdout
           with the <b>git</b> <b>secret</b> <b>cat</b> command. If you used a password on your GPG key (always recommended), it will
           ask you for your password. And you´re done!

   <b>Usage:</b> <b>Adding</b> <b>someone</b> <b>to</b> <b>a</b> <b>repository</b> <b>using</b> <b>git-secret</b>
       1.  <u>Get</u> <u>their</u> <b>gpg</b> public-key. <b>You</b> <b>won´t</b> <b>need</b> <b>their</b> <b>secret</b> <b>key.</b> They can export their public key  for  you
           using a command like:

       <b>gpg</b> <b>--armor</b> <b>--export</b> <b><a href="mailto:their@email.com">their@email.com</a></b> <b>&gt;</b> <b>public_key.txt</b> <b>#</b> <b>armor</b> <b>here</b> <b>makes</b> <b>it</b> <b>ascii</b>

       1.  Import this key into your <b>gpg</b> keyring (in <b><a href="file:~/.gnupg">~/.gnupg</a></b> or similar) by running <b>gpg</b> <b>--import</b> <b>public_key.txt</b>

       2.  Now  add this person to your secrets repo by running <b>git</b> <b>secret</b> <b>tell</b> <b><a href="mailto:their@email.id">their@email.id</a></b> (this will be the
           email address associated with their public key)

       3.  Now  remove  the  other  user´s  public  key  from  your  personal  keyring  with  <b>gpg</b>  <b>--delete-keys</b>
           <b><a href="mailto:their@email.id">their@email.id</a></b>

       4.  The  newly added user cannot yet read the encrypted files. Now, re-encrypt the files using <b>git</b> <b>secret</b>
           <b>reveal;</b> <b>git</b> <b>secret</b> <b>hide</b> <b>-d</b>, and then commit and push the  newly  encrypted  files.  (The  -d  options
           deletes  the  unencrypted  file  after  re-encrypting  it).  Now the newly added user will be able to
           decrypt the files in the repo using <b>git-secret</b> <b>reveal</b>.

       Note that when you first add a user to a git-secret repo, they will not be able to decrypt existing files
       until another user re-encrypts the files with the new keyring.

       If you do not want unexpected keys added, you can configure some server-side  security  policy  with  the
       <b>pre-receive</b> hook.

   <b>Using</b> <b>gpg</b>
       You  can  follow a quick <b>gpg</b> tutorial at devdungeon <u>https://www.devdungeon.com/content/gpg-tutorial</u>. Here
       are the most useful commands to get started:

       To generate a RSA key-pair, run:

           gpg --gen-key

       To export your public key, run:

           gpg --armor --export <a href="mailto:your.email@address.com">your.email@address.com</a> &gt; public-key.gpg

       To import the public key of someone else (to share the secret with them for instance), run:

           gpg --import public-key.gpg

       To make sure you get the original public keys of the indicated persons, be sure to use a  secure  channel
       to  transfer  it,  or  use  a  service you trust, preferably one that uses encryption such as Keybase, to
       retrieve their public key. Otherwise you could grant the wrong person access to your secrets by mistake!

   <b>Using</b> <b>git-secret</b> <b>for</b> <b>Continuous</b> <b>Integration</b> <b>/</b> <b>Continuous</b> <b>Deployment</b> <b>(CI/CD)</b>
       When using <b>git-secret</b> for CI/CD, you get the benefit that any deployment is  necessarily  done  with  the
       correct configuration, since it is collocated with the changes in your code.

       One way of doing it is the following:

       1.  <u>create</u>  <u>a</u>  <u>gpg</u> <u>key</u> for your CI/CD environment. You can chose any name and email address you want: for
           instance <b>MyApp</b> <b>Example</b> <b>&lt;<a href="mailto:myapp@example.com">myapp@example.com</a>&gt;</b> if your app is called MyApp and  your  CI/CD  provider  is
           Example.  It  is easier not to define a passphrase for that key. However, if defining a passphrase is
           unavoidable, use a unique passphrase for the private key.

       2.  run <b>gpg</b> <b>--armor</b> <b>--export-secret-key</b> <b><a href="mailto:myapp@example.com">myapp@example.com</a></b> to get your private key value

       3.  Create an env var on your CI/CD server <b>GPG_PRIVATE_KEY</b> and assign it the  private  key  value.  If  a
           passphrase  has  been  setup  for  the  private  key,  create  another  env  var  on the CI/CD server
           <b>GPG_PASSPHRASE</b> and assign it the passphrase of the private key.

       4.  Then write your Continuous Deployment build script. For instance:

           # As the first step: install git-secret,
           # see: https://git-secret.io/installation

           # Create private key file
           echo "$GPG_PRIVATE_KEY" &gt; ./private_key.gpg
           # Import private key and avoid the "Inappropriate ioctl for device" error
           gpg --batch --yes --pinentry-mode loopback --import private_key.gpg
           # Reveal secrets without user interaction and with passphrase. If no passphrase
           # is created for the key, remove `-p $GPG_PASSPHRASE`
           git secret reveal -p "$GPG_PASSPHRASE"
           # carry on with your build script, secret files are available ...

       Note: your CI/CD might not allow you to create a multiline value. In that case, you can export it on  one
       line with

           gpg --armor --export-secret-key <a href="mailto:myapp@example.com">myapp@example.com</a> | tr ´\n´ ´,´

       You can then create your private key file with:

           echo "$GPG_PRIVATE_KEY" | tr ´,´ ´\n´ &gt; ./private_key.gpg

       Also  note:  the  <b>gpg</b> version on the CI/CD server <b>MUST</b> <b>INTEROPERATE</b> with the one used locally. Otherwise,
       <b>gpg</b> decryption can fail, which leads to <b>git</b> <b>secret</b> <b>reveal</b> reporting <b>cannot</b> <b>find</b> <b>decrypted</b> <b>version</b> <b>of</b> <b>file</b>
       error. The best way to ensure this is to use the same version of gnupg on different systems.

</pre><h4><b>Environment</b> <b>Variables</b> <b>and</b> <b>Configuration</b></h4><pre>
       You can configure the version of <b>gpg</b> used, or the extension  your  encrypted  files  use,  to  suit  your
       workflow better. To do so, just set the required variable to the value you need. This can be done in your
       shell  environment  file or with each <b>git-secret</b> command. See below, or the man page of <b>git-secret</b> for an
       explanation of the environment variables <b>git-secret</b> uses.

       The settings available to be changed are:

       •   <b>$SECRETS_VERBOSE</b> - sets the verbose flag to on for all <b>git-secret</b> commands; is identical to using  <b>-v</b>
           on each command that supports it.

       •   <b>$SECRETS_GPG_COMMAND</b>  -  sets  the <b>gpg</b> alternatives, defaults to <b>gpg</b>. It can be changed to <b>gpg</b>, <b>gpg2</b>,
           <b>pgp</b>, <b>/usr/local/gpg</b> or any other value. After doing so rerun the tests to be sure that it won´t break
           anything. Tested with <b>gpg</b> and <b>gpg2</b>.

       •   <b>$SECRETS_GPG_ARMOR</b> - sets the <b>gpg</b> <b>--armor</b> mode <u>https://www.gnupg.org/gph/en/manual/r1290.html</u>. Can be
           set to <b>1</b> to store secrets file as text. By default is <b>0</b> and store files as binaries.

       •   <b>$SECRETS_EXTENSION</b> - sets the secret files extension, defaults to <b>.secret</b>. It can be changed  to  any
           valid file extension.

       •   <b>$SECRETS_DIR</b>  -  sets the directory where <b>git-secret</b> stores its files, defaults to <b>.gitsecret</b>. It can
           be changed to any valid directory name.

       •   <b>$SECRETS_PINENTRY</b> - allows user to specify a setting  for  <b>gpg</b>´s  <b>--pinentry</b>  option.  See  <b>gpg</b>  docs
           <u>https://github.com/gpg/pinentry</u> for details about gpg´s <b>--pinentry</b> option.

</pre><h4><b>The</b> <b>&lt;code&gt;.gitsecret&lt;/code&gt;</b> <b>folder</b> <b>(can</b> <b>be</b> <b>overridden</b> <b>with</b> <b>&lt;code&gt;SECRETS_DIR&lt;/code&gt;)</b></h4><pre>
       This  folder contains information about the files encrypted by git-secret, and about which public/private
       key sets can access the encrypted data.

       You can change the name of this directory using the SECRETS_DIR environment variable.

       Use the various <b>git-secret</b> commands to manipulate the files in <b>.gitsecret</b>, you should not change the data
       in these files directly.

       Exactly which files exist in the <b>.gitsecret</b> folder and what  their  contents  are  vary  slightly  across
       different  versions  of  gpg.  Also,  some  versions  of gpg might not work well with keyrings created or
       modified with newer versions of gpg. Thus it is best to use git-secret with the same version of gpg being
       used  by  all  users.  This  can  be  forced  by  installing  matching  versions   of   gpg   and   using
       <b>SECRETS_GPG_COMMAND</b> environment variable.

       For  example,  there  is  an issue between <b>gpg</b> version 2.1.20 and later versions which can cause problems
       reading and writing keyring files between systems (this shows up in errors like ´gpg: skipped  packet  of
       type 12 in keybox´).

       This  is  not the only issue it is possible to encounter sharing files between different versions of <b>gpg</b>.
       Generally you are most likely to encounter issues between <b>gpg</b> versions if  you  use  <b>git-secret</b>  <b>tell</b>  or
       <b>git-secret</b>  <b>removeperson</b>  to modify your repo´s <b>git-secret</b> keyring using a newer version of <b>gpg</b>, and then
       try to operate on that keyring using an older version of <b>gpg</b>.

       The <b>git-secret</b> internal data is separated into two directories:

   <b>&lt;code&gt;.gitsecret/paths&lt;/code&gt;</b>
       This directory currently contains only the file <b>mapping.cfg</b>, which  lists  all  the  files  your  storing
       encrypted. In other words, the path mappings: what files are tracked to be hidden and revealed.

       All the other internal data is stored in the directory:

   <b>&lt;code&gt;.gitsecret/keys&lt;/code&gt;</b>
       This  directory contains data used by <b>git-secret</b> and <b>gpg</b> to encrypt files to be accessed by the permitted
       users.

       In particular, this directory contains a <b>gnupg</b> <b>keyring</b> with public keys for the emails used with <b>tell</b>.

       This is the keyring used to encrypt files with <b>git-secret-hide</b>.

       <b>git-secret-reveal</b> and <b>git-secret-cat</b>, which decrypt secrets, instead use the user´s <u>private</u>  <u>keys</u>  (which
       probably  reside somewhere like <a href="file:~/.gnupg/">~/.gnupg/</a>). Note that user´s private keys, needed for decryption, are <u>not</u>
       in the <b>.gitsecret/keys</b> directory.

       Generally speaking, all the files in this directory <u>except</u> <b>random_seed</b> should be checked into your  repo.
       By default, <b>git</b> <b>secret</b> <b>init</b> will add the file <b>.gitsecret/keys/random_seed</b> to your <b>.gitignore</b> file.

       Again, you can change the name of this directory using the SECRETS_DIR environment variable.

sobolevn                                           April 2022                                      <u><a href="../man7/GIT-SECRET.7.html">GIT-SECRET</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>