<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_KEYEXCH-ECDH - ECDH Key Exchange algorithm support</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_KEYEXCH-ECDH - ECDH Key Exchange algorithm support

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Key exchange support for the <b>ECDH</b> key type.

   <b>ECDH</b> <b>Key</b> <b>Exchange</b> <b>parameters</b>
       "ecdh-cofactor-mode" (<b>OSSL_EXCHANGE_PARAM_EC_ECDH_COFACTOR_MODE</b>) &lt;integer&gt;
           Sets or gets the ECDH mode of operation for the associated key exchange ctx.

           In the context of an Elliptic Curve Diffie-Hellman key exchange, this parameter can be used to select
           between  the  plain Diffie-Hellman (DH) or Cofactor Diffie-Hellman (CDH) variants of the key exchange
           algorithm.

           When setting, the value should be 1, 0  or  -1,  respectively  forcing  cofactor  mode  on,  off,  or
           resetting it to the default for the private key associated with the given key exchange ctx.

           When getting, the value should be either 1 or 0, respectively signaling if the cofactor mode is on or
           off.

           See  also <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7) for the related <b>OSSL_PKEY_PARAM_USE_COFACTOR_ECDH</b> parameter that can be
           set on a per-key basis.

       "kdf-type" (<b>OSSL_EXCHANGE_PARAM_KDF_TYPE</b>) &lt;UTF8 string&gt;
       "kdf-digest" (<b>OSSL_EXCHANGE_PARAM_KDF_DIGEST</b>) &lt;UTF8 string&gt;
       "kdf-digest-props" (<b>OSSL_EXCHANGE_PARAM_KDF_DIGEST_PROPS</b>) &lt;UTF8 string&gt;
       "kdf-outlen" (<b>OSSL_EXCHANGE_PARAM_KDF_OUTLEN</b>) &lt;unsigned integer&gt;
       "kdf-ukm" (<b>OSSL_EXCHANGE_PARAM_KDF_UKM</b>) &lt;octet string&gt;

       The OpenSSL FIPS provider also supports the following parameters:

       "fips-indicator" (<b>OSSL_EXCHANGE_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
       "key-check" (<b>OSSL_EXCHANGE_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
       "digest-check" (<b>OSSL_EXCHANGE_PARAM_FIPS_DIGEST_CHECK</b>) &lt;integer&gt;
           See "Common Key Exchange parameters" in <b><a href="../man7/provider-keyexch.7.html">provider-keyexch</a></b>(7).

       "ecdh-cofactor-check" (<b>OSSL_EXCHANGE_PARAM_FIPS_ECDH_COFACTOR_CHECK</b>) &lt;integer&gt;
           If required this parameter should before <b>OSSL_FUNC_keyexch_derive()</b>.  The default value of  1  causes
           an  error  during  the OSSL_FUNC_keyexch_derive if the EC curve has a cofactor that is not 1, and the
           cofactor is not used.  Setting this to 0 will ignore the error and set the approved  "fips-indicator"
           to 0.  This option breaks FIPS compliance if it causes the approved "fips-indicator" to return 0.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Examples of key agreement can be found in demos/keyexch.

       Keys  for  the  host  and  peer must be generated as shown in "Examples" in <b><a href="../man7/EVP_PKEY-EC.7.html">EVP_PKEY-EC</a></b>(7) using the same
       curve name.

       The code to generate a shared secret for the normal case is identical to "Examples" in <b><a href="../man7/EVP_KEYEXCH-DH.7.html">EVP_KEYEXCH-DH</a></b>(7).

       To derive a shared secret on the host using the host's key and the  peer's  public  key  but  also  using
       X963KDF with a user key material:

           /* It is assumed that the host_key, peer_pub_key and ukm are set up */
           void derive_secret(EVP_PKEY *host_key, EVP_PKEY *peer_key,
                              unsigned char *ukm, size_t ukm_len)
           {
               unsigned char secret[64];
               size_t out_len = sizeof(secret);
               size_t secret_len = out_len;
               unsigned int pad = 1;
               OSSL_PARAM params[6];
               EVP_PKEY_CTX *dctx = EVP_PKEY_CTX_new_from_pkey(NULL, host_key, NULL);

               EVP_PKEY_derive_init(dctx);

               params[0] = OSSL_PARAM_construct_uint(OSSL_EXCHANGE_PARAM_PAD, &amp;pad);
               params[1] = OSSL_PARAM_construct_utf8_string(OSSL_EXCHANGE_PARAM_KDF_TYPE,
                                                            "X963KDF", 0);
               params[2] = OSSL_PARAM_construct_utf8_string(OSSL_EXCHANGE_PARAM_KDF_DIGEST,
                                                            "SHA1", 0);
               params[3] = OSSL_PARAM_construct_size_t(OSSL_EXCHANGE_PARAM_KDF_OUTLEN,
                                                       &amp;out_len);
               params[4] = OSSL_PARAM_construct_octet_string(OSSL_EXCHANGE_PARAM_KDF_UKM,
                                                             ukm, ukm_len);
               params[5] = OSSL_PARAM_construct_end();
               EVP_PKEY_CTX_set_params(dctx, params);

               EVP_PKEY_derive_set_peer(dctx, peer_pub_key);
               EVP_PKEY_derive(dctx, secret, &amp;secret_len);
               ...
               OPENSSL_clear_free(secret, secret_len);
               EVP_PKEY_CTX_free(dctx);
           }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/EVP_PKEY-EC.7.html">EVP_PKEY-EC</a></b>(7)    <b><a href="../man3/EVP_PKEY.3.html">EVP_PKEY</a></b>(3),    <b><a href="../man7/provider-keyexch.7.html">provider-keyexch</a></b>(7),   <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7),   <b><a href="../man7/OSSL_PROVIDER-default.7.html">OSSL_PROVIDER-default</a></b>(7),
       <b><a href="../man7/OSSL_PROVIDER-FIPS.7.html">OSSL_PROVIDER-FIPS</a></b>(7),

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                             <u><a href="../man7SSL/EVP_KEYEXCH-ECDH.7SSL.html">EVP_KEYEXCH-ECDH</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>