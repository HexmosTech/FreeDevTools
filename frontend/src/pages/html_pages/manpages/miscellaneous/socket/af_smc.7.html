<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AF_SMC - Sockets for SMC communication</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/smc-tools">smc-tools_1.8.5-0ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       AF_SMC - Sockets for SMC communication

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/socket.h&gt;</b>

       <b>#define</b> <b>AF_SMC</b> <b>43</b>

       <b>#define</b> <b>SMCPROTO_SMC</b>  <b>0</b>

       <b>#define</b> <b>SMCPROTO_SMC6</b> <b>1</b>

       <u>tcp_sockfd</u> <b>=</b> <b>socket(</b><u>AF_SMC</u><b>,</b> <u>SOCK_STREAM</u><b>,</b> <u>SMCPROTO_SMC</u><b>);</b>

       <u>tcp_sockfd</u> <b>=</b> <b>socket(</b><u>AF_SMC</u><b>,</b> <u>SOCK_STREAM</u><b>,</b> <u>SMCPROTO_SMC6</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>Shared</u>  <u>Memory</u>  <u>Communication</u> <u>via</u> <u>RDMA</u> (SMC) is a socket over the RDMA communication protocol that allows
       existing TCP socket applications to transparently benefit from RDMA when exchanging  data  over  an  <u>RDMA</u>
       <u>over</u>  <u>Converged</u>  <u>Ethernet</u>  (RoCE)  network.  Those  networks are not routable.  SMC provides host-to-host
       direct memory access without traditional TCP/IP processing overhead.  SMC offers preservation of existing
       IP topology and IP  security,  and  introduces  minimal  administrative  and  operational  changes.   The
       exploitation of SMC is transparent to TCP socket applications.

       The new address family <b>AF_SMC</b> supports the SMC protocol on Linux.  It keeps the address format of <b>AF_INET</b>
       and <b>AF_INET6</b> sockets and supports streaming socket types only.

   <b>Usage</b> <b>modes</b>
       Two usage modes are possible:

       AF_SMC native usage
              uses  the  socket domain <b>AF_SMC</b> instead of <b>AF_INET</b> and <b>AF_INET6</b>.  Specify <b>SMCPROTO_SMC</b> for <b>AF_INET</b>
              compatible socket semantics, and <b>SMC_PROTO_SMC6</b> for <b>AF_INET6</b> respectively.

       Usage of AF_INET socket applications with SMC preload library
              converts <b>AF_INET</b> and <b>AF_INET6</b> sockets to <b>AF_SMC</b> sockets.  The SMC preload library is part  of  the
              SMC tools package.

       SMC  socket  capabilities  are  negotiated  at  connection setup. If one peer is not SMC capable, further
       socket processing falls back to TCP usage automatically.

   <b>Implementation</b> <b>details:</b> <b>Links</b> <b>and</b> <b>Link</b> <b>Groups</b>
       To run RDMA traffic to a peer, a so-called <u>link</u> is established between a local RoCE  card  and  a  remote
       RoCE  card. To enhance availability, you can configure alternate links with automatic fail over.  Primary
       and backup links to a certain peer are combined in a so-called <u>link</u> <u>group</u>.

   <b>RoCE</b> <b>adapter</b> <b>mapping:</b> <b>Creation</b> <b>of</b> <b>a</b> <b>pnet</b> <b>table</b>
       The SMC protocol requires grouping of multiple physical networks - standard Ethernet and  RoCE  networks.
       Such  groups  are  called <u>Physical</u> <u>Networks</u> (PNets). For SMC, RoCE adapter mapping is configured within a
       table called <b>pnet</b> <b>table</b>.  Any available Ethernet interface can be combined  with  available  <u>RDMA-capable</u>
       <u>network</u> <u>interface</u> <u>cards</u> (RNICs), if they belong to the same Converged Ethernet fabric.  To configure RoCE
       Adapter mapping, you must create a pnet table.  Modify the table with the smc-tools command <u>smc_pnet</u>.

       For details see <b><a href="../man8/smc_pnet.8.html">smc_pnet</a></b>(8).

   <b>Displaying</b> <b>SMC</b> <b>socket</b> <b>state</b> <b>information</b>
       SMC socket state information can be obtained with the smc-tools command <u>smcss</u>.  For details see <b><a href="../man8/smcss.8.html">smcss</a></b>(8).

   <b>Starting</b> <b>a</b> <b>TCP</b> <b>application</b> <b>to</b> <b>work</b> <b>with</b> <b>SMC</b>
       To  use an existing TCP application to work with SMC, use the SMC preload library.  The SMC Tools package
       provides the command <u>smc_run</u> to convert <b>AF_INET</b> and <b>AF_INET6</b> socket calls to <b>AF_SMC</b> socket calls by means
       of the preload technique.  For more information about the preload mechanism, see also <b><a href="../man8/ld.so.8.html">ld.so</a></b>(8).

       Example:

              <b>smc_run</b> <b>ftp</b>

       This command-line example starts an FTP client over SMC.

   <b>MTU</b> <b>and</b> <b>Infiniband</b> <b>data</b> <b>transfer</b>
       Infiniband traffic may use MTU values 256, 512, 1024, 2048, or 4096.  SMC determines the  configured  MTU
       size  of the RoCE Ethernet port, announces this MTU size to the peer during connection start, and chooses
       the minimum MTU size of both peers.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/socket.2.html">socket</a></b>(2), <b><a href="../man7/ip.7.html">ip</a></b>(7), <b><a href="../man7/tcp.7.html">tcp</a></b>(7), <b><a href="../man7/socket.7.html">socket</a></b>(7), <b><a href="../man8/smc_chk.8.html">smc_chk</a></b>(8) <b><a href="../man8/smc_run.8.html">smc_run</a></b>(8), <b><a href="../man8/smcss.8.html">smcss</a></b>(8), <b><a href="../man8/smc_pnet.8.html">smc_pnet</a></b>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>AF_SMC,</b> <b>version</b> <b>1.0.0</b>

             Initial version.

smc-tools                                         January 2017                                         <u><a href="../man7/AF_SMC.7.html">AF_SMC</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>