<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>openssl-threads - Overview of thread safety in OpenSSL</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       openssl-threads - Overview of thread safety in OpenSSL

</pre><h4><b>DESCRIPTION</b></h4><pre>
       In this man page, we use the term <b>thread-safe</b> to indicate that an object or function can be used by
       multiple threads at the same time.

       OpenSSL can be built with or without threads support. The most important use of this support is so that
       OpenSSL itself can use a single consistent API, as shown in "EXAMPLES" in <b><a href="../man3/CRYPTO_THREAD_run_once.3.html">CRYPTO_THREAD_run_once</a></b>(3).
       Multi-platform applications can also use this API.

       In particular, being configured for threads support does not imply that all OpenSSL objects are thread-
       safe.  To emphasize: <u>most</u> <u>objects</u> <u>are</u> <u>not</u> <u>safe</u> <u>for</u> <u>simultaneous</u> <u>use</u>.  Exceptions to this should be
       documented on the specific manual pages, and some general high-level guidance is given here.

       One major use of the OpenSSL thread API is to implement reference counting.  Many objects within OpenSSL
       are reference-counted, so resources are not released, until the last reference is removed.  References
       are often increased automatically (such as when an <b>X509</b> certificate object is added into an <b>X509_STORE</b>
       trust store).  There is often an <u><b>object</b></u><b>_up_ref</b>() function that can be used to increase the reference
       count.  Failure to match <u><b>object</b></u><b>_up_ref</b>() calls with the right number of <u><b>object</b></u><b>_free</b>() calls is a common
       source of memory leaks when a program exits.

       Many objects have set and get API's to set attributes in the object.  A "set0" passes ownership from the
       caller to the object and a "get0" returns a pointer but the attribute ownership remains with the object
       and a reference to it is returned.  A "set1" or "get1" function does not change the ownership, but
       instead updates the attribute's reference count so that the object is shared between the caller and the
       object; the caller must free the returned attribute when finished.  Functions that involve attributes
       that have reference counts themselves, but are named with just "set" or "get" are historical; and the
       documentation must state how the references are handled.  Get methods are often thread-safe as long as
       the ownership requirements are met and shared objects are not modified.  Set methods, or modifying shared
       objects, are generally not thread-safe as discussed below.

       Objects are thread-safe as long as the API's being invoked don't modify the object; in this case the
       parameter is usually marked in the API as "const".  Not all parameters are marked this way.  Note that a
       "const" declaration does not mean immutable; for example <b><a href="../man3/X509_cmp.3.html">X509_cmp</a></b>(3) takes pointers to "const" objects,
       but the implementation uses a C cast to remove that so it can lock objects, generate and cache a DER
       encoding, and so on.

       Another instance of thread-safety is when updates to an object's internal state, such as cached values,
       are done with locks.  One example of this is the reference counting API's described above.

       In all cases, however, it is generally not safe for one thread to mutate an object, such as setting
       elements of a private or public key, while another thread is using that object, such as verifying a
       signature.

       The same API's can usually be used simultaneously on different objects without interference.  For
       example, two threads can calculate a signature using two different <b>EVP_PKEY_CTX</b> objects.

       For implicit global state or singletons, thread-safety depends on the facility.  The
       <b><a href="../man3/CRYPTO_secure_malloc.3.html">CRYPTO_secure_malloc</a></b>(3) and related API's have their own lock, while <b><a href="../man3/CRYPTO_malloc.3.html">CRYPTO_malloc</a></b>(3) assumes the
       underlying platform allocation will do any necessary locking.  Some API's, such as <b><a href="../man3/NCONF_load.3.html">NCONF_load</a></b>(3) and
       related do no locking at all; this can be considered a bug.

       A separate, although related, issue is modifying "factory" objects when other objects have been created
       from that.  For example, an <b>SSL_CTX</b> object created by <b><a href="../man3/SSL_CTX_new.3.html">SSL_CTX_new</a></b>(3) is used to create per-connection <b>SSL</b>
       objects by calling <b><a href="../man3/SSL_new.3.html">SSL_new</a></b>(3).  In this specific case, and probably for factory methods in general, it is
       not safe to modify the factory object after it has been used to create other objects.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/CRYPTO_THREAD_run_once.3.html">CRYPTO_THREAD_run_once</a></b>(3), local system threads documentation.

</pre><h4><b>BUGS</b></h4><pre>
       This page is admittedly very incomplete.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                              <u><a href="../man7SSL/OPENSSL-THREADS.7SSL.html">OPENSSL-THREADS</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>