<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ocf_heartbeat_mariadb - Manages a MariaDB promotable instance</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/resource-agents-extra">resource-agents-extra_4.16.0-3ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ocf_heartbeat_mariadb - Manages a MariaDB promotable instance

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>mariadb</b> [start | stop | status | monitor | promote | demote | meta-data | validate-all]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Resource script for MariaDB.

       Manages a complete promotable replication setup with GTID, for simpler uses look at the mysql resource
       agent which supports older replication forms which mysql and mariadb have in common.

       The resource must be setup to use notifications. Set 'notify=true' in the metadata attributes when
       defining a MariaDB promotable instance.

       The default behavior is to use uname -n values in the change promoted to command. Other IPs can be
       specified manually by adding a node attribute ${INSTANCE_ATTR_NAME}_mysql_master_IP giving the IP to use
       for replication. For example, if the mariadb primitive you are using is p_mariadb, the attribute to set
       will be p_mariadb_mysql_master_IP.

</pre><h4><b>SUPPORTED</b> <b>PARAMETERS</b></h4><pre>
       <b>binary</b>
           Location of the MariaDB server binary

           (optional, string, default "/usr/bin/mysqld_safe")

       <b>client_binary</b>
           Location of the MariaDB client binary

           (optional, string, default "mysql")

       <b>config</b>
           Configuration file

           (optional, string, default "/etc/mysql/my.cnf")

       <b>datadir</b>
           Directory containing databases

           (optional, string, default "/var/lib/mysql")

       <b>user</b>
           User running MariaDB daemon

           (optional, string, default "mysql")

       <b>group</b>
           Group running MariaDB daemon (for logfile and directory permissions)

           (optional, string, default "mysql")

       <b>log</b>
           The logfile to be used for mysqld.

           (optional, string, default "/var/log/mysql/error.log")

       <b>node_list</b>
           All node names of nodes that will execute mariadb. Please separate each node name with a space. This
           is required for the promoted selection to function.

           (required, string, no default)

       <b>pid</b>
           The pidfile to be used for mysqld.

           (optional, string, default "/var/run/mysqld/mysqld.pid")

       <b>socket</b>
           The socket to be used for mysqld.

           (optional, string, default "/var/run/mysqld/mysqld.sock")

       <b>test_table</b>
           Table to be tested in monitor statement (in database.table notation)

           (optional, string, default "mysql.user")

       <b>test_user</b>
           MariaDB test user, must have select privilege on test_table

           (optional, string, default "root")

       <b>test_passwd</b>
           MariaDB test user password

           (optional, string, no default)

       <b>enable_creation</b>
           If the MariaDB database does not exist, it will be created

           (optional, boolean, default 0)

       <b>additional_parameters</b>
           Additional parameters which are passed to the mysqld on startup. (e.g. --skip-external-locking or
           --skip-grant-tables)

           (optional, string, no default)

       <b>replication_user</b>
           MariaDB replication user. This user is used for starting and stopping MariaDB replication, for
           setting and resetting the promoted host, and for setting and unsetting read-only mode. Because of
           that, this user must have SUPER, REPLICATION SLAVE, REPLICATION CLIENT, PROCESS and RELOAD privileges
           on all nodes within the cluster. Mandatory if you define a promotable resource.

           (optional, string, default "root")

       <b>replication_passwd</b>
           MariaDB replication password. Used for replication client and unpromoted. Mandatory if you define a
           promotable resource.

           (optional, string, no default)

       <b>replication_port</b>
           The port on which the Promoted MariaDB instance is listening.

           (optional, string, default "3306")

</pre><h4><b>SUPPORTED</b> <b>ACTIONS</b></h4><pre>
       This resource agent supports the following actions (operations):

       <b>start</b>
           Starts the resource. Suggested minimum timeout: 120s.

       <b>stop</b>
           Stops the resource. Suggested minimum timeout: 120s.

       <b>status</b>
           Performs a status check. Suggested minimum timeout: 60s.

       <b>monitor</b>
           Performs a detailed status check. Suggested minimum timeout: 30s. Suggested interval: 20s.

       <b>monitor</b> <b>(Promoted</b> <b>role)</b>
           Performs a detailed status check. Suggested minimum timeout: 30s. Suggested interval: 10s.

       <b>promote</b>
           Promotes the resource to the Master role. Suggested minimum timeout: 120s.

       <b>demote</b>
           Demotes the resource to the Slave role. Suggested minimum timeout: 120s.

       <b>notify</b>
           Suggested minimum timeout: 90s.

       <b>validate-all</b>
           Performs a validation of the resource configuration. Suggested minimum timeout: 5s.

       <b>meta-data</b>
           Retrieves resource agent metadata (internal use only). Suggested minimum timeout: 5s.

</pre><h4><b>EXAMPLE</b> <b>CRM</b> <b>SHELL</b></h4><pre>
       The following is an example configuration for a mariadb resource using the <b><a href="../man8/crm.8.html">crm</a></b>(8) shell:

           primitive p_mariadb ocf:heartbeat:mariadb \
             params \
               node_list=<u>string</u> \
             op monitor depth="0" timeout="30s" interval="20s" \
             op monitor role="Promoted" depth="0" timeout="30s" interval="10s"

           ms ms_mariadb p_mariadb \
             meta notify="true" interleave="true"

</pre><h4><b>EXAMPLE</b> <b>PCS</b></h4><pre>
       The following is an example configuration for a mariadb resource using <b><a href="../man8/pcs.8.html">pcs</a></b>(8)

           pcs resource create p_mariadb ocf:heartbeat:mariadb \
             node_list=<u>string</u> \
             op monitor OCF_CHECK_LEVEL="0" timeout="30s" interval="20s" \
             op monitor role="Promoted" OCF_CHECK_LEVEL="0" timeout="30s" interval="10s" promotable

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="http://clusterlabs.org/">http://clusterlabs.org/</a></b>

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>ClusterLabs</b> <b>contributors</b> <b>(see</b> <b>the</b> <b>resource</b> <b>agent</b> <b>source</b> <b>for</b> <b>information</b> <b>about</b> <b>individual</b> <b>authors)</b>

resource-agents 4.16.0-3ubuntu                     06/25/2025                            <u><a href="../man7/OCF_HEARTBEAT_MARIAD.7.html">OCF_HEARTBEAT_MARIAD</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>