<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pytest-mpi - pytest-mpi Documentation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/python-pytest-mpi-doc">python-pytest-mpi-doc_0.6-8_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pytest-mpi - pytest-mpi Documentation

       <u>pytest-mpi</u> provides a number of things to assist with using pytest with MPI-using code, specifically:

          • Displaying of the current MPI configuration (e.g. the MPI version, the number of processes)

          • Sharing temporary files/folders across the MPI processes

          • Markers  which  allow  for skipping or xfailing tests based on whether the tests are being run under
            MPI

       Further features will be added in the future, and contribution of features is very much welcomed.

</pre><h4><b>USAGE</b></h4><pre>
       The important thing to remember is that <u>pytest-mpi</u> assists with running tests when <u>pytest</u>  is  run  under
       MPI,  rather  than  launching <u>pytest</u> under MPI. To actually run the tests under MPI, you will want to run
       something like:

          $ mpirun -n 2 python -m pytest --with-mpi

       Note that by default the MPI tests are not run—this makes it easy to run the  non-MPI  parts  of  a  test
       suite without having to worry about installing MPI and mpi4py.

       An simple test using the <u>mpi</u> marker managed by <u>pytest-mpi</u> is:

          import pytest
          @pytest.mark.mpi
          def test_size():
              from mpi4py import MPI
              comm = MPI.COMM_WORLD
              assert comm.size &gt; 0

       This  test  will  be  automatically  be  skipped unless <u>--with-mpi</u> is used. We can also specify a minimum
       number of processes required to run the test:

          import pytest
          @pytest.mark.mpi(min_size=2)
          def test_size():
              from mpi4py import MPI
              comm = MPI.COMM_WORLD
              assert comm.size &gt;= 2

       There are also <u>mpi_skip</u>, for when a test should not be  run  under  MPI  (e.g.  it  causes  a  lockup  or
       segmentation  fault),  and <u>mpi_xfail</u>, for when a test should succeed when run normally, but fail when run
       under MPI.

</pre><h4><b>MARKERS</b></h4><pre>
       <b>pytest.mark.mpi(min_size=None)</b>
              Mark that this test must be run under MPI.

              <b>Parameters</b>
                     <b>min_size</b> (<u>int</u>) --

                     Specify that this  test  requires  at  least  <u>min_size</u>  processes  to  run.  If  there  are
                     insufficient processes, skip this test.

                     For example:

                        import pytest

                        @pytest.mark.mpi(minsize=4)
                        def test_mpi_feature():
                            ...

       <b>pytest.mark.mpi_skip()</b>
              Mark that this test should be skipped when run under MPI.

       <b>pytest.mark.mpi_xfail()</b>
              Mark that this test should be xfailed when run under MPI.

</pre><h4><b>FIXTURES</b></h4><pre>
       <b>pytest_mpi.mpi_file_name(tmpdir,</b> <b>request)</b>
              Provides a temporary file name which can be used under MPI from all MPI processes.

              This  function  avoids  the  need  to ensure that only one process handles the naming of temporary
              files.

       <b>pytest_mpi.mpi_tmp_path(tmp_path)</b>
              Wraps <u>pytest.tmp_path</u> so that it can be used under MPI from all MPI processes.

              This function avoids the need to ensure that only one process  handles  the  naming  of  temporary
              folders.

       <b>pytest_mpi.mpi_tmpdir(tmpdir)</b>
              Wraps <u>pytest.tmpdir</u> so that it can be used under MPI from all MPI processes.

              This  function  avoids  the  need  to ensure that only one process handles the naming of temporary
              folders.

</pre><h4><b>CHANGELOG</b></h4><pre>
   <b>0.6</b>
       • Again no codebase changes, testing/CI and packaging fixes only.

       • Update Azure Pipelines to use latest images (so CI runs again)

       • Update versioneer to work on future Python versions.

       • Fix doctests infrastructure

   <b>0.5</b>
       • No codebase changes, only testing/CI changes needed to support pytest 6.

       • We use Azure Pipelines now for CI, rather than Travis

       • Autouploads to PyPI are done via Azure Pipelines

       • We test on both pytest&lt;6 and pytest&gt;=6, due to the need to support both for now.

   <b>0.4</b>
       • Added license and contributing details

       • Added fixtures to enable sharing code across files

       • Numerous testing fixes/improvements

   <b>0.3</b>
       • Fixed pylint failures

       • Added testing of examples in documentation

       • Added proper tests

       • Fix bugs found via tests

   <b>0.2</b>
       • Add proper documentation of features

       • Display more MPI related information on test run

       • Add <u>mpi_skip</u> and <u>mpi_xfail</u> markers

       • Add <u>mpi_tmpdir</u> and <u>mpi_tmp_path</u>

   <b>0.1.1</b>
       • Fix plugin as the pytest command line parsing logic needs to be outside main plugin class

   <b>0.1</b>
       Initial version

</pre><h4><b>CONTRIBUTING</b> <b>TO</b> <b>PYTEST-MPI</b></h4><pre>
       We welcome contributions to pytest-mpi, subject to our <u>code</u> <u>of</u> <u>conduct</u> whether it is improvements to  the
       documentation or examples, bug reports or code improvements.

   <b>Reporting</b> <b>Bugs</b>
       Bugs  should be reported to <u>https://github.com/aragilar/pytest-mpi</u>. Please include what version of Python
       this occurs on, as well as which operating system. Information about your h5py and HDF5 configuration  is
       also helpful.

   <b>Patches</b> <b>and</b> <b>Pull</b> <b>Requests</b>
       The  main  repository  is  <u>https://github.com/aragilar/pytest-mpi</u>, please make pull requests against that
       repository, and the branch that pull requests should be made on is master (backporting fixes will be done
       separately if necessary).

   <b>Running</b> <b>the</b> <b>tests</b>
       pytest-mpi uses <u>tox</u> to run its tests.  See  <u>https://tox.readthedocs.io/en/latest/</u>  for  more  information
       about tox, but the simplest method is to run:

          tox

       in the top level of the git repository.

       <b>NOTE:</b>
          If  you want to run pytest directly, remember to include <b>-p</b> <b>pytester</b>, as pytester needs to be manually
          activated.

   <b>Making</b> <b>a</b> <b>release</b>
       Current minimal working method (this doesn't produce a release commit,  deal  with  DOIs  needing  to  be
       preregistered, not automated, not signed etc.):

       1. Checkout  the  latest  commit  on  the  <b>master</b>  branch on the main repository locally. Ensure the work
          directory is clean (<b>git</b> <b>purge</b>/<b>git</b> <b>clean</b> <b>-xfd</b>).

       2. Tag this commit with an annotated tag, with the format being <b>v*.*.*</b>  (<b>git</b> <b>tag</b> <b>-a</b> <b>v*.*.*</b>; I should sign
          these...). The tag should mention the changes in this release.

       3. Push tag to github.

       4. Create a release on github using the web interface, copying the content of the tag.

       5. Build sdist and wheel (<b>python</b> <b>setup.py</b> <b>sdist</b> <b>bdist_wheel</b>), and upload to PyPI (<b>twine</b> <b>upload</b> <b>dist/*</b>).

       • <u>Index</u>

       • <u>Module</u> <u>Index</u>

       • <u>Search</u> <u>Page</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       James Tocknell

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2019, James Tocknell

0.6                                               Dec 20, 2024                                     <u><a href="../man7/PYTEST-MPI.7.html">PYTEST-MPI</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>