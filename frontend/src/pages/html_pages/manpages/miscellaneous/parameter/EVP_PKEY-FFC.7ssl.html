<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_PKEY-FFC - EVP_PKEY DSA and DH/DHX shared FFC parameters.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_PKEY-FFC - EVP_PKEY DSA and DH/DHX shared FFC parameters.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Finite field cryptography (FFC) is a method of implementing discrete logarithm cryptography using finite
       field mathematics. DSA is an example of FFC and Diffie-Hellman key establishment algorithms specified in
       SP800-56A can also be implemented as FFC.

       The <b>DSA</b>, <b>DH</b> and <b>DHX</b> keytypes are implemented in OpenSSL's default and FIPS providers.  The
       implementations support the basic DSA, DH and DHX keys, containing the public and private keys <u>pub</u> and
       <u>priv</u> as well as the three main domain parameters <u>p</u>, <u>q</u> and <u>g</u>.

       For <b>DSA</b> (and <b>DH</b> that is not a named group) the FIPS186-4 standard specifies that the values used for FFC
       parameter generation are also required for parameter validation.  This means that optional FFC domain
       parameter values for <u>seed</u>, <u>pcounter</u> and <u>gindex</u> may need to be stored for validation purposes.  For <b>DH</b> the
       <u>seed</u> and <u>pcounter</u> can be stored in ASN1 data (but the <u>gindex</u> is not). For <b>DSA</b> however, these fields are
       not stored in the ASN1 data so they need to be stored externally if validation is required.

       The <b>DH</b> key type uses PKCS#3 format which saves p and g, but not the 'q' value.  The <b>DHX</b> key type uses
       X9.42 format which saves the value of 'q' and this must be used for FIPS186-4.

   <b>FFC</b> <b>parameters</b>
       In addition to the common parameters that all keytypes should support (see "Common parameters" in
       <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7)), the <b>DSA</b>, <b>DH</b> and <b>DHX</b> keytype implementations support the following.

       "pub" (<b>OSSL_PKEY_PARAM_PUB_KEY</b>) &lt;unsigned integer&gt;
           The public key value.

       "priv" (<b>OSSL_PKEY_PARAM_PRIV_KEY</b>) &lt;unsigned integer&gt;
           The private key value.

   <b>FFC</b> <b>DSA,</b> <b>DH</b> <b>and</b> <b>DHX</b> <b>domain</b> <b>parameters</b>
       "p" (<b>OSSL_PKEY_PARAM_FFC_P</b>) &lt;unsigned integer&gt;
           A DSA or Diffie-Hellman prime "p" value.

       "g" (<b>OSSL_PKEY_PARAM_FFC_G</b>) &lt;unsigned integer&gt;
           A DSA or Diffie-Hellman generator "g" value.

   <b>FFC</b> <b>DSA</b> <b>and</b> <b>DHX</b> <b>domain</b> <b>parameters</b>
       "q" (<b>OSSL_PKEY_PARAM_FFC_Q</b>) &lt;unsigned integer&gt;
           A DSA or Diffie-Hellman prime "q" value.

       "seed" (<b>OSSL_PKEY_PARAM_FFC_SEED</b>) &lt;octet string&gt;
           An  optional  domain parameter <u>seed</u> value used during generation and validation of <u>p</u>, <u>q</u> and canonical
           <u>g</u>.  For validation this needs to set the <u>seed</u> that was produced during generation.

       "gindex" (<b>OSSL_PKEY_PARAM_FFC_GINDEX</b>) &lt;integer&gt;
           Sets the index to use for canonical generation and verification of the generator <u>g</u>.  Set  this  to  a
           positive  value  from 0..FF to use this mode. This <u>gindex</u> can then be reused during key validation to
           verify the value of <u>g</u>. If this value is not  set  or  is  -1  then  unverifiable  generation  of  the
           generator <u>g</u> will be used.

       "pcounter" (<b>OSSL_PKEY_PARAM_FFC_PCOUNTER</b>) &lt;integer&gt;
           An  optional domain parameter <u>counter</u> value that is output during generation of <u>p</u>. This value must be
           saved if domain parameter validation is required.

       "hindex" (<b>OSSL_PKEY_PARAM_FFC_H</b>) &lt;integer&gt;
           For unverifiable generation of the generator <u>g</u> this value is output during generation of <u>g</u>. Its value
           is the first integer larger than one that satisfies g = h^j mod p (where  g  !=  1  and  "j"  is  the
           cofactor).

       "j" (<b>OSSL_PKEY_PARAM_FFC_COFACTOR</b>) &lt;unsigned integer&gt;
           An optional informational cofactor parameter that should equal to (p - 1) / q.

       "validate-pq" (<b>OSSL_PKEY_PARAM_FFC_VALIDATE_PQ</b>) &lt;unsigned integer&gt;
       "validate-g" (<b>OSSL_PKEY_PARAM_FFC_VALIDATE_G</b>) &lt;unsigned integer&gt;
           These   boolean   values   are  used  during  FIPS186-4  or  FIPS186-2  key  validation  checks  (See
           <b><a href="../man3/EVP_PKEY_param_check.3.html">EVP_PKEY_param_check</a></b>(3)) to select validation options. By default <u>validate-pq</u> and <u>validate-g</u> are both
           set to 1 to check that p,q and g are valid. Either of these may be set to 0 to skip a test, which  is
           mainly useful for testing purposes.

       "validate-legacy" (<b>OSSL_PKEY_PARAM_FFC_VALIDATE_LEGACY</b>) &lt;unsigned integer&gt;
           This  boolean  value is used during key validation checks (See <b><a href="../man3/EVP_PKEY_param_check.3.html">EVP_PKEY_param_check</a></b>(3)) to select the
           validation type. The default value of 0 selects FIPS186-4 validation. Setting this value to 1 selects
           FIPS186-2 validation.

   <b>FFC</b> <b>key</b> <b>generation</b> <b>parameters</b>
       The following key generation types are available for DSA and DHX algorithms:

       "type" (<b>OSSL_PKEY_PARAM_FFC_TYPE</b>) &lt;UTF8 string&gt;
           Sets the type of parameter generation. The shared valid values are:

           "fips186_4"
               The current standard.

           "fips186_2"
               The old standard that should only be used for legacy purposes.

           "default"
               This can choose one of "fips186_4" or "fips186_2" depending on other parameters set for parameter
               generation.

       "pbits" (<b>OSSL_PKEY_PARAM_FFC_PBITS</b>) &lt;unsigned integer&gt;
           Sets the size (in bits) of the prime 'p'.

       "qbits" (<b>OSSL_PKEY_PARAM_FFC_QBITS</b>) &lt;unsigned integer&gt;
           Sets the size (in bits) of the prime 'q'.

           For "fips186_4" this can be either 224 or 256.  For "fips186_2" this has a size of 160.

       "digest" (<b>OSSL_PKEY_PARAM_FFC_DIGEST</b>)  &lt;UTF8 string&gt;
           Sets the Digest algorithm to be used as part of the Key Generation Function associated with the given
           Key Generation <u>ctx</u>.  This must also be set for key validation.

       "properties" (<b>OSSL_PKEY_PARAM_FFC_DIGEST_PROPS</b>) &lt;UTF8 string&gt;
           Sets properties to be used upon look up of the implementation for the selected Digest  algorithm  for
           the  Key  Generation  Function associated with the given key generation <u>ctx</u>. This may also be set for
           key validation.

       "seed" (<b>OSSL_PKEY_PARAM_FFC_SEED</b>) &lt;octet string&gt;
           For "fips186_4" or "fips186_2" generation this sets the <u>seed</u> data to  use  instead  of  generating  a
           random seed internally. This should be used for testing purposes only. This will either produce fixed
           values for the generated parameters OR it will fail if the seed did not generate valid primes.

       "gindex" (<b>OSSL_PKEY_PARAM_FFC_GINDEX</b>) &lt;integer&gt;
       "pcounter" (<b>OSSL_PKEY_PARAM_FFC_PCOUNTER</b>) &lt;integer&gt;
       "hindex" (<b>OSSL_PKEY_PARAM_FFC_H</b>) &lt;integer&gt;
           These types are described above.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       The following sections of SP800-56Ar3:

       5.5.1.1 FFC Domain Parameter Selection/Generation

       The following sections of FIPS186-4:

       A.1.1.2 Generation of Probable Primes p and q Using an Approved Hash Function.
       A.2.3 Generation of canonical generator g.
       A.2.1 Unverifiable Generation of the Generator g.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/EVP_PKEY-DSA.7.html">EVP_PKEY-DSA</a></b>(7),  <b><a href="../man7/EVP_PKEY-DH.7.html">EVP_PKEY-DH</a></b>(7),  <b><a href="../man7/EVP_SIGNATURE-DSA.7.html">EVP_SIGNATURE-DSA</a></b>(7),  <b><a href="../man7/EVP_KEYEXCH-DH.7.html">EVP_KEYEXCH-DH</a></b>(7)  <b><a href="../man3/EVP_KEYMGMT.3.html">EVP_KEYMGMT</a></b>(3), <b><a href="../man3/EVP_PKEY.3.html">EVP_PKEY</a></b>(3),
       <b><a href="../man7/provider-keymgmt.7.html">provider-keymgmt</a></b>(7), <b><a href="../man7/OSSL_PROVIDER-default.7.html">OSSL_PROVIDER-default</a></b>(7), <b><a href="../man7/OSSL_PROVIDER-FIPS.7.html">OSSL_PROVIDER-FIPS</a></b>(7),

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                 <u><a href="../man7SSL/EVP_PKEY-FFC.7SSL.html">EVP_PKEY-FFC</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>