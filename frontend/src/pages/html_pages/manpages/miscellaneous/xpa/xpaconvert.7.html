<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XPAConvert - Converting the XPA API to 2.0</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libxpa-dev">libxpa-dev_2.1.20-3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>XPAConvert</b> <b>-</b> <b>Converting</b> <b>the</b> <b>XPA</b> <b>API</b> <b>to</b> <b>2.0</b>

</pre><h4><b>SYNOPSIS</b></h4><pre>
       This document describes tips for converting from xpa 1.0 (Xt-based xpa) to xpa 2.0 (socket-based xpa).

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The following are tips for converting from xpa 1.0 (Xt-based xpa) to xpa 2.0 (socket-based xpa). The
       changes are straight-forward and almost can be done automatically (we used editor macros for most of the
       conversion).

       •   The  existence  of the cpp XPA_VERSION directive to distinguish between 1.0 (where it is not defined)
           and 2.0 (where it is defined).

       •   Remove the first widget argument from all send and receive server callbacks.   Also  change  first  2
           arguments from XtPointer to void *. For example:

           #ifdef XPA_VERSION static void XPAReceiveFile(client_data, call_data, paramlist, buf, len)
                void *client_data;
                void *call_data;
                char *paramlist;
                char *buf;
                int len; #else static void XPAReceiveFile(w, client_data, call_data, paramlist, buf, len)
                Widget w;
                XtPointer client_data;
                XtPointer call_data;
                char *paramlist;
                char *buf;
                int len; #endif

       •   Server callbacks should be declared as returning int instead of void. They now should return 0 for no
           errors, -1 for error.

       •   The  mode  flags  have  changed  when defining XPA server callbacks.  The old <u>S</u> flag (save buffer) is
           replaced by <u>freebuf=false</u>.  The old <u>E</u> flag (empty buffer is OK) is no longer used (it was an artifact
           of the X implementation).

       •   Change <u>NewXPACommand()</u> to <u>XPAcmdNew()</u>, with the new calling sequence:

             xpa = NewXPACommand(toplevel, NULL, prefix, NULL);

           is changed to:

             xpa = XPACmdNew(xclass, name);

       •   Change the <u>AddXPACommand()</u> subroutine name to XPACmdAdd (with the same calling sequence):

             AddXPACommand(xpa, "file",
               "\tdisplay a new file\n\t\t  requires: filename",
               NULL, NULL, NULL, XPAReceiveFile, text, NULL);

           is changed to:

             XPACmdAdd(xpa, "file",
               "\tdisplay a new file\n\t\t  requires: filename",
               NULL, NULL, NULL, XPAReceiveFile, text, NULL);

       •   The <u>XPAXtAppInput()</u> routine should be called just before <u>XtAppMainLoop()</u> to add xpa  fds  to  the  Xt
           event loop:

             /* add the xpas to the Xt loop */
             XPAXtAddInput(app, NULL);

             /* process events */
             XtAppMainLoop(app);

       •   Change  <u>NewXPA()</u>  to  <u>XPANew()</u> and call <u>XPAXtAddInput()</u> if the XtAppMainLoop routine already has been
           entered:

             xpa = NewXPA(saotng-&gt;xim-&gt;toplevel, prefix, xparoot,
                          "FITS data or image filename\n\t\t  options: file type",
                          XPASendData, new, NULL,
                          XPAReceiveData, new, "SE");

           is changed to:

             sprintf(tbuf, "%s.%s", prefix, xparoot);
             xpa = XPANew("SAOTNG", tbuf,
                          "FITS data or image filename\n\t\t  options: file type",
                          XPASendData, new, NULL,
                          XPAReceiveData, new, "SE");
             XPAXtAddInput(XtWidgetToApplicationContext(saotng-&gt;xim-&gt;toplevel), xpa);

       •   Change <u>XPAInternalReceiveCommand()</u> to <u>XPACmdInternalReceive()</u> remove first argument  in  the  calling
           sequence):

             XPAInternalReceiveCommand(im-&gt;saotng-&gt;xim-&gt;toplevel,
                                       im-&gt;saotng, im-&gt;saotng-&gt;commands,
                                       "zoom reset", NULL, 0);

           is changed to:

             XPACmdInternalReceive(im-&gt;saotng, im-&gt;saotng-&gt;commands,
                                   "zoom reset", NULL, 0);

       •   Change DestroyXPA to XPAFree:

             DestroyXPA(im-&gt;dataxpa);

           is changed to:

             XPAFree(im-&gt;dataxpa);

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       See xpa(n) for a list of XPA help pages

version 2.1.15                                    July 23, 2013                                    <u><a href="../man7/xpaconvert.7.html">xpaconvert</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>