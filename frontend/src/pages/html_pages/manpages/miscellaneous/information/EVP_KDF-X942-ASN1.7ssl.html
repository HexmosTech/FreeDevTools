<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_KDF-X942-ASN1 - The X9.42-2003 asn1 EVP_KDF implementation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_KDF-X942-ASN1 - The X9.42-2003 asn1 EVP_KDF implementation

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The EVP_KDF-X942-ASN1 algorithm implements the key derivation function X942KDF-ASN1. It is used by DH
       KeyAgreement, to derive a key using input such as a shared secret key and other info. The other info is
       DER encoded data that contains a 32 bit counter as well as optional fields for "partyu-info", "partyv-
       info", "supp-pubinfo" and "supp-privinfo".  This kdf is used by Cryptographic Message Syntax (CMS).

       The output is considered to be keying material.

   <b>Identity</b>
       "X942KDF-ASN1" or "X942KDF" is the name for this implementation; it can be used with the <b>EVP_KDF_fetch()</b>
       function.

   <b>Supported</b> <b>parameters</b>
       The supported parameters are:

       "properties" (<b>OSSL_KDF_PARAM_PROPERTIES</b>) &lt;UTF8 string&gt;
       "digest" (<b>OSSL_KDF_PARAM_DIGEST</b>) &lt;UTF8 string&gt;
           These parameters work as described in "PARAMETERS" in <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3).

       "secret" (<b>OSSL_KDF_PARAM_SECRET</b>) &lt;octet string&gt;
           The shared secret used for key derivation.  This parameter sets the secret.

       "acvp-info" (<b>OSSL_KDF_PARAM_X942_ACVPINFO</b>) &lt;octet string&gt;
           This  value  should  not  be  used  in  production and should only be used for ACVP testing. It is an
           optional octet string containing a combined DER encoded blob of any of the optional fields related to
           "partyu-info", "partyv-info", "supp-pubinfo" and "supp-privinfo". If it is  specified  then  none  of
           these other fields should be used.

       "partyu-info" (<b>OSSL_KDF_PARAM_X942_PARTYUINFO</b>) &lt;octet string&gt;
           An optional octet string containing public info contributed by the initiator.

       "ukm" (<b>OSSL_KDF_PARAM_UKM</b>) &lt;octet string&gt;
           An alias for "partyu-info".  In CMS this is the user keying material.

       "partyv-info" (<b>OSSL_KDF_PARAM_X942_PARTYVINFO</b>) &lt;octet string&gt;
           An optional octet string containing public info contributed by the responder.

       "supp-pubinfo" (<b>OSSL_KDF_PARAM_X942_SUPP_PUBINFO</b>) &lt;octet string&gt;
           An  optional octet string containing some additional, mutually-known public information. Setting this
           value also sets "use-keybits" to 0.

       "use-keybits" (<b>OSSL_KDF_PARAM_X942_USE_KEYBITS</b>) &lt;integer&gt;
           The default value of 1 will use the KEK key length (in bits) as the  "supp-pubinfo".  A  value  of  0
           disables setting the "supp-pubinfo".

       "supp-privinfo" (<b>OSSL_KDF_PARAM_X942_SUPP_PRIVINFO</b>) &lt;octet string&gt;
           An optional octet string containing some additional, mutually-known private information.

       "cekalg" (<b>OSSL_KDF_PARAM_CEK_ALG</b>) &lt;UTF8 string&gt;
           This   parameter   sets   the   CEK  wrapping  algorithm  name.   Valid  values  are  "AES-128-WRAP",
           "AES-192-WRAP", "AES-256-WRAP" and "DES3-WRAP".

       The OpenSSL FIPS provider also supports the following parameters:

       "fips-indicator" (<b>OSSL_KDF_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;
           A getter that returns 1 if the operation is FIPS approved, or 0 otherwise.  This may  be  used  after
           calling EVP_KDF_derive. It returns 0 if "key-check" parameter is set to 0 and the check fails.

       "key-check" (<b>OSSL_KDF_PARAM_FIPS_KEY_CHECK</b>) &lt;integer&gt;
           The  default  value  of  1 causes an error during <b>EVP_KDF_CTX_set_params()</b> if the length of used key-
           derivation key (<b>OSSL_KDF_PARAM_KEY</b>) is shorter than 112 bits.  Setting this to zero will  ignore  the
           error  and  set  the approved "fips-indicator" to 0.  This option breaks FIPS compliance if it causes
           the approved "fips-indicator" to return 0.

</pre><h4><b>NOTES</b></h4><pre>
       A context for X942KDF can be obtained by calling:

        EVP_KDF *kdf = EVP_KDF_fetch(NULL, "X942KDF", NULL);
        EVP_KDF_CTX *kctx = EVP_KDF_CTX_new(kdf);

       The output length of an X942KDF is specified via the <u>keylen</u> parameter to the <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3) function.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This example derives 24 bytes, with the secret key "secret" and random user keying material:

         EVP_KDF_CTX *kctx;
         EVP_KDF_CTX *kctx;
         unsigned char out[192/8];
         unsignred char ukm[64];
         OSSL_PARAM params[5], *p = params;

         if (RAND_bytes(ukm, sizeof(ukm)) &lt;= 0)
             error("RAND_bytes");

         kdf = EVP_KDF_fetch(NULL, "X942KDF", NULL);
         if (kctx == NULL)
             error("EVP_KDF_fetch");
         kctx = EVP_KDF_CTX_new(kdf);
         EVP_KDF_free(kdf);
         if (kctx == NULL)
             error("EVP_KDF_CTX_new");

         *p++ = OSSL_PARAM_construct_utf8_string(OSSL_KDF_PARAM_DIGEST, "SHA256", 0);
         *p++ = OSSL_PARAM_construct_octet_string(OSSL_KDF_PARAM_SECRET,
                                                  "secret", (size_t)6);
         *p++ = OSSL_PARAM_construct_octet_string(OSSL_KDF_PARAM_UKM, ukm, sizeof(ukm));
         *p++ = OSSL_PARAM_construct_utf8_string(OSSL_KDF_PARAM_CEK_ALG, "AES-256-WRAP, 0);
         *p = OSSL_PARAM_construct_end();
         if (EVP_KDF_derive(kctx, out, sizeof(out), params) &lt;= 0)
             error("EVP_KDF_derive");

         EVP_KDF_CTX_free(kctx);

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       ANS1 X9.42-2003 RFC 2631

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3),         <b><a href="../man3/EVP_KDF_CTX_new.3.html">EVP_KDF_CTX_new</a></b>(3),          <b><a href="../man3/EVP_KDF_CTX_free.3.html">EVP_KDF_CTX_free</a></b>(3),          <b><a href="../man3/EVP_KDF_CTX_set_params.3.html">EVP_KDF_CTX_set_params</a></b>(3),
       <b><a href="../man3/EVP_KDF_CTX_get_kdf_size.3.html">EVP_KDF_CTX_get_kdf_size</a></b>(3), <b><a href="../man3/EVP_KDF_derive.3.html">EVP_KDF_derive</a></b>(3), "PARAMETERS" in <b><a href="../man3/EVP_KDF.3.html">EVP_KDF</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       This functionality was added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                            <u><a href="../man7SSL/EVP_KDF-X942-ASN1.7SSL.html">EVP_KDF-X942-ASN1</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>