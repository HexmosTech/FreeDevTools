<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ocf_heartbeat_rabbitmq-server-ha - Resource agent for RabbitMQ HA cluster</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/resource-agents-extra">resource-agents-extra_4.16.0-3ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ocf_heartbeat_rabbitmq-server-ha - Resource agent for RabbitMQ HA cluster

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>rabbitmq-server-ha</b> [start | stop | status | monitor | promote | demote | meta-data | validate-all]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Resource agent for RabbitMQ promotes a node, then cluster nodes can join it

</pre><h4><b>SUPPORTED</b> <b>PARAMETERS</b></h4><pre>
       <b>binary</b>
           RabbitMQ binary

           (optional, string, default "/usr/sbin/rabbitmq-server")

       <b>ctl</b>
           rabbitctl binary

           (optional, string, default "/usr/sbin/rabbitmqctl")

       <b>pid_file</b>
           RabbitMQ PID file

           (optional, string, default "/var/run/rabbitmq/pid")

       <b>log_dir</b>
           RabbitMQ log directory

           (optional, string, default "/var/log/rabbitmq")

       <b>username</b>
           RabbitMQ user name

           (optional, string, default "rabbitmq")

       <b>groupname</b>
           RabbitMQ group name

           (optional, string, default "rabbitmq")

       <b>admin_user</b>
           RabbitMQ default admin user for API

           (optional, string, default "guest")

       <b>admin_password</b>
           RabbitMQ default admin user password for API

           (optional, string, default "guest")

       <b>definitions_dump_file</b>
           RabbitMQ default definitions dump file

           (optional, string, default "/etc/rabbitmq/definitions")

       <b>command_timeout</b>
           Timeout command arguments for issued commands termination (value is auto evaluated)

           (optional, string, no default)

       <b>start_time</b>
           Timeout for start rabbitmq server

           (optional, string, default "7")

       <b>stop_time</b>
           Timeout for stopping rabbitmq server

           (optional, string, default "7")

       <b>debug</b>
           The debug flag for agent (/usr/sbin/rabbitmq-server) instance. In the <a href="file:/tmp/">/tmp/</a> directory will be created
           rmq-* files for log some operations and ENV values inside OCF-script.

           (optional, boolean, default false)

       <b>mnesia_base</b>
           Base directory for storing Mnesia files

           (optional, boolean, default /var/lib/rabbitmq/mnesia)

       <b>mnesia_schema_base</b>
           Parent directory for Mnesia schema directory

           (optional, string, default "/var/lib/rabbitmq")

       <b>host_ip</b>
           /usr/sbin/rabbitmq-server should listen on this IP address

           (optional, boolean, default 127.0.0.1)

       <b>node_port</b>
           /usr/sbin/rabbitmq-server should listen on this port

           (optional, boolean, default 5672)

       <b>default_vhost</b>
           Default virtual host used for monitoring if a node is fully synchronized with the rest of the
           cluster. In normal operation, the resource agent will wait for queues from this virtual host on this
           node to be synchronized elsewhere before stopping RabbitMQ. This also means queues in other virtual
           hosts may not be fully synchronized on stop operations.

           (optional, string, default "/")

       <b>erlang_cookie</b>
           Erlang cookie for clustering. If specified, will be updated at the mnesia reset

           (optional, boolean, default false)

       <b>erlang_cookie_file</b>
           Erlang cookie file path where the cookie will be put, if requested

           (optional, boolean, default /var/lib/rabbitmq/.erlang.cookie)

       <b>use_fqdn</b>
           Either to use FQDN or a shortname for the rabbitmq node

           (optional, boolean, default false)

       <b>fqdn_prefix</b>
           Optional FQDN prefix for RabbitMQ nodes in cluster. FQDN prefix can be specified to host multiple
           RabbitMQ instances on a node or in case of RabbitMQ running in dedicated network/interface.

           (optional, string, no default)

       <b>max_rabbitmqctl_timeouts</b>
           If during monitor call rabbitmqctl times out, the timeout is ignored unless it is Nth timeout in a
           row. Here N is the value of the current parameter. If too many timeouts happen in a raw, the monitor
           call will return with error.

           (optional, string, default "3")

       <b>policy_file</b>
           A path to the shell script to setup RabbitMQ policies

           (optional, string, default "/usr/local/sbin/set_rabbitmq_policy")

       <b>rmq_feature_health_check</b>
           Since rabbit 3.6.4 list_queues/list_channels-based monitoring should be replaced with
           "node_health_check" command, as it creates no network load at all.

           (optional, boolean, default true)

       <b>rmq_feature_local_list_queues</b>
           For rabbit version that implements --local flag for list_queues, this can greatly reduce network
           overhead in cases when node is stopped/demoted.

           (optional, boolean, default true)

       <b>limit_nofile</b>
           Soft and hard limit for NOFILE

           (optional, string, default "65535")

       <b>avoid_using_iptables</b>
           When set to true the iptables calls to block client access become noops. This is useful when we run
           inside containers.

           (optional, boolean, default false)

       <b>allowed_cluster_nodes</b>
           When set to anything other than the empty string it must container the list of cluster node names,
           separated by spaces, where the rabbitmq resource is allowed to run. Tis is needed when rabbitmq is
           running on a subset of nodes part of a larger cluster. The default ("") is to assume that all nodes
           part of the cluster will run the rabbitmq resource.

           (optional, string, no default)

</pre><h4><b>SUPPORTED</b> <b>ACTIONS</b></h4><pre>
       This resource agent supports the following actions (operations):

       <b>start</b>
           Starts the resource. Suggested minimum timeout: 20s.

       <b>stop</b>
           Stops the resource. Suggested minimum timeout: 20s.

       <b>status</b>
           Performs a status check. Suggested minimum timeout: 20s.

       <b>monitor</b>
           Performs a detailed status check. Suggested minimum timeout: 30s. Suggested interval: 5s.

       <b>monitor</b> <b>(Promoted</b> <b>role)</b>
           Performs a detailed status check. Suggested minimum timeout: 30s. Suggested interval: 3s.

       <b>promote</b>
           Promotes the resource to the Master role. Suggested minimum timeout: 30s.

       <b>demote</b>
           Demotes the resource to the Slave role. Suggested minimum timeout: 30s.

       <b>notify</b>
           Suggested minimum timeout: 20s.

       <b>validate-all</b>
           Performs a validation of the resource configuration. Suggested minimum timeout: 5s.

       <b>meta-data</b>
           Retrieves resource agent metadata (internal use only). Suggested minimum timeout: 5s.

</pre><h4><b>EXAMPLE</b> <b>CRM</b> <b>SHELL</b></h4><pre>
       The following is an example configuration for a rabbitmq-server-ha resource using the <b><a href="../man8/crm.8.html">crm</a></b>(8) shell:

           primitive p_rabbitmq-server-ha ocf:heartbeat:rabbitmq-server-ha \
             op monitor depth="0" timeout="30s" interval="5s" \
             op monitor depth="0" timeout="30s" interval="3s" role="Promoted"

           ms ms_rabbitmq-server-ha p_rabbitmq-server-ha \
             meta notify="true" interleave="true"

</pre><h4><b>EXAMPLE</b> <b>PCS</b></h4><pre>
       The following is an example configuration for a rabbitmq-server-ha resource using <b><a href="../man8/pcs.8.html">pcs</a></b>(8)

           pcs resource create p_rabbitmq-server-ha ocf:heartbeat:rabbitmq-server-ha \
             op monitor OCF_CHECK_LEVEL="0" timeout="30s" interval="5s" \
             op monitor OCF_CHECK_LEVEL="0" timeout="30s" interval="3s" role="Promoted" promotable

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="http://clusterlabs.org/">http://clusterlabs.org/</a></b>

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>ClusterLabs</b> <b>contributors</b> <b>(see</b> <b>the</b> <b>resource</b> <b>agent</b> <b>source</b> <b>for</b> <b>information</b> <b>about</b> <b>individual</b> <b>authors)</b>

resource-agents 4.16.0-3ubuntu                     06/25/2025                            <u><a href="../man7/OCF_HEARTBEAT_RABBIT.7.html">OCF_HEARTBEAT_RABBIT</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>