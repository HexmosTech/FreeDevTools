<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_SIGNATURE-ML-DSA, EVP_SIGNATURE-ML-DSA-44, EVP_SIGNATURE-ML-DSA-65, EVP_SIGNATURE-ML-DSA-87, -</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssl">openssl_3.5.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_SIGNATURE-ML-DSA, EVP_SIGNATURE-ML-DSA-44, EVP_SIGNATURE-ML-DSA-65, EVP_SIGNATURE-ML-DSA-87, -
       EVP_SIGNATURE ML-DSA support

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>ML-DSA-44</b>, <b>ML-DSA-65</b> and <b>ML-DSA-87</b> EVP_PKEY implementations support key generation, and one-shot sign
       and verify using the ML-DSA signature schemes described in FIPS 204
       &lt;https://csrc.nist.gov/pubs/fips/204/final&gt;.

       The different algorithms names correspond to the parameter sets defined in FIPS 204
       &lt;https://csrc.nist.gov/pubs/fips/204/final&gt; Section 4 Table 1.  (The signatures range in size from ~2.5K
       to ~4.5K depending on the type chosen).  There are 3 different security categories also depending on the
       type.

       <b><a href="../man3/EVP_SIGNATURE_fetch.3.html">EVP_SIGNATURE_fetch</a></b>(3) can be used to explicitely fetch one of the 3 algorithms which can then be used
       with <b><a href="../man3/EVP_PKEY_sign_message_init.3.html">EVP_PKEY_sign_message_init</a></b>(3), <b><a href="../man3/EVP_PKEY_sign.3.html">EVP_PKEY_sign</a></b>(3), <b><a href="../man3/EVP_PKEY_verify_message_init.3.html">EVP_PKEY_verify_message_init</a></b>(3), and
       <b><a href="../man3/EVP_PKEY_verify.3.html">EVP_PKEY_verify</a></b>(3) to perform one-shot message signing or signature verification.

       The normal signing process (called Pure ML-DSA Signature Generation) encodes the message internally as
       0x00 || len(ctx) || ctx || message.  where <b>ctx</b> is some optional value of size 0x00..0xFF.  This process
       is defined in FIPS 204 &lt;https://csrc.nist.gov/pubs/fips/204/final&gt; Algorithm 2 step 10 and Algorithm 3
       step 5.  OpenSSL also allows the message to not be encoded which is required for testing. OpenSSL does
       not support Pre Hash ML-DSA Signature Generation, but this may be done by the user by doing Pre hash
       encoding externally and then choosing the option to not encode the message.

   <b>ML-DSA</b> <b>Signature</b> <b>Parameters</b>
       The following parameter can be used for both signing and verification.  it may be set by passing an
       OSSL_PARAM array to <b><a href="../man3/EVP_PKEY_sign_message_init.3.html">EVP_PKEY_sign_message_init</a></b>(3) or <b><a href="../man3/EVP_PKEY_verify_message_init.3.html">EVP_PKEY_verify_message_init</a></b>(3)

       "context-string" (<b>OSSL_SIGNATURE_PARAM_CONTEXT_STRING</b>) &lt;octet string&gt;
           A string of octets with length at most 255. By default it is the empty string.

       The  following  parameters  can  be  used when signing: They can be set by passing an OSSL_PARAM array to
       <b><a href="../man3/EVP_PKEY_sign_init_ex2.3.html">EVP_PKEY_sign_init_ex2</a></b>(3).

       "message-encoding" (<b>OSSL_SIGNATURE_PARAM_MESSAGE_ENCODING</b>) &lt;integer&gt;
           The default value of 1 uses 'Pure ML-DSA Signature Generation' as described above. Setting  it  to  0
           does  not  encode  the message, which is used for testing.  The message encoding steps are defined in
           FIPS 204 &lt;https://csrc.nist.gov/pubs/fips/204/final&gt; Algorithm 2 step 10 and Algorithm 3 step 5.

       "test-entropy" (<b>OSSL_SIGNATURE_PARAM_TEST_ENTROPY</b>) &lt;octet string&gt;
           Used for testing to pass an optional deterministic per message random value.  If set the size must be
           32 bytes.

       "deterministic" (<b>OSSL_SIGNATURE_PARAM_DETERMINISTIC</b>) &lt;integer&gt;
           The default value of 0 causes the per message randomness to  be  randomly  generated  using  a  DRBG.
           Setting  this  to  1  causes the per message randomness to be set to 32 bytes of zeros. This value is
           ignored if "test-entropy" is set.

       "mu" (<b>OSSL_SIGNATURE_PARAM_MU</b>) &lt;integer&gt;
           The default value of 0 causes sign and verify operations to process a raw message.  Setting this to 1
           causes   those   operations   to   assume   the   input   is   the   "mu"   value   from   FIPS   204
           &lt;https://csrc.nist.gov/pubs/fips/204/final&gt; Algorithm 7 step 6 and Algorithm 8 step 7.

           Note  that  the  message  encoding  steps  from  FIPS 204 &lt;https://csrc.nist.gov/pubs/fips/204/final&gt;
           Algorithm 2 step 10 and Algorithm 3 step 5 are omitted when this setting is 1.

       See <b><a href="../man7/EVP_PKEY-ML-DSA.7.html">EVP_PKEY-ML-DSA</a></b>(7) for information related to <b>ML-DSA</b> keys.

</pre><h4><b>NOTES</b></h4><pre>
       For backwards compatability reasons <b>EVP_DigestSignInit_ex()</b>, <b>EVP_DigestSign()</b>,  <b>EVP_DigestVerifyInit_ex()</b>
       and <b>EVP_DigestVerify()</b> may also be used, but the digest passed in <u>mdname</u> must be NULL.

</pre><h4><b>EXAMPLES</b></h4><pre>
       To sign a message using an ML-DSA EVP_PKEY structure:

           void do_sign(EVP_PKEY *key, unsigned char *msg, size_t msg_len)
           {
               size_t sig_len;
               unsigned char *sig = NULL;
               const OSSL_PARAM params[] = {
                   OSSL_PARAM_octet_string("context-string", (unsigned char *)"A context string", 16),
                   OSSL_PARAM_END
               };
               EVP_PKEY_CTX *sctx = EVP_PKEY_CTX_new_from_pkey(NULL, pkey, NULL);
               EVP_SIGNATURE *sig_alg = EVP_SIGNATURE_fetch(NULL, "ML-DSA-65", NULL);

               EVP_PKEY_sign_message_init(sctx, sig_alg, params);
               /* Calculate the required size for the signature by passing a NULL buffer. */
               EVP_PKEY_sign(sctx, NULL, &amp;sig_len, msg, msg_len);
               sig = OPENSSL_zalloc(sig_len);
               EVP_PKEY_sign(sctx, sig, &amp;sig_len, msg, msg_len);
               ...
               OPENSSL_free(sig);
               EVP_SIGNATURE(sig_alg);
               EVP_PKEY_CTX_free(sctx);
           }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/EVP_PKEY-ML-DSA.7.html">EVP_PKEY-ML-DSA</a></b>(7)     <b><a href="../man7/provider-signature.7.html">provider-signature</a></b>(7),     <b><a href="../man3/EVP_PKEY_sign.3.html">EVP_PKEY_sign</a></b>(3),    <b><a href="../man3/EVP_PKEY_verify.3.html">EVP_PKEY_verify</a></b>(3),    FIPS    204
       &lt;https://csrc.nist.gov/pubs/fips/204/final&gt;

</pre><h4><b>HISTORY</b></h4><pre>
       This functionality was added in OpenSSL 3.5.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                         <u><a href="../man7SSL/EVP_SIGNATURE-ML-DSA.7SSL.html">EVP_SIGNATURE-ML-DSA</a></u>(7SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>