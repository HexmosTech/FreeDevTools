<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nng_surveyor - surveyor protocol</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnng-dev">libnng-dev_1.10.1-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nng_surveyor - surveyor protocol

</pre><h4><b>SYNOPSIS</b></h4><pre>
           #include &lt;nng/nng.h&gt;
           #include &lt;nng/protocol/survey0/survey.h&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <u>surveyor</u> protocol is one half of a survey pattern. In this pattern, a surveyor sends a survey, which
       is broadcast to all peer respondents. The respondents then have a chance to reply (but are not obliged to
       reply). The survey itself is a timed event, so that responses received after the survey has finished are
       discarded.

           <b>Tip</b>

           This protocol is useful in solving voting problems, such as leader election in cluster
           configurations, as well as certain kinds of service discovery problems.

       The <u>surveyor</u> protocol is the surveyor side, and the <u>respondent</u> protocol is the respondent side.

   <b>Socket</b> <b>Operations</b>
       The nng_surveyor0_open() functions create a surveyor socket. This socket may be used to send messages
       (surveys), and then to receive replies. A reply can only be received after sending a survey. A surveyor
       can normally expect to receive at most one reply from each responder. (Messages can be duplicated in some
       topologies, so there is no guarantee of this.)

       Attempts to receive on a socket with no outstanding survey will result in NNG_ESTATE. If the survey times
       out while the surveyor is waiting for replies, then the result will be NNG_ETIMEDOUT.

       Only one survey can be outstanding at a time; sending another survey will cancel the prior one, and any
       responses from respondents from the prior survey that arrive after this will be discarded.

       Raw mode sockets ignore all these restrictions.

   <b>Context</b> <b>Operations</b>
       This protocol supports the creation of contexts for concurrent use cases using nng_ctx_open().

       Each context can initiate its own surveys, and it will receive only responses to its own outstanding
       surveys. Other contexts on the same socket may have overlapping surveys operating at the same time.

       Each of these may have their own timeouts established with NNG_OPT_SURVEYOR_SURVEYTIME.

       Additionally, sending a survey on a context will only cancel an outstanding survey on the same context.

           <b>Note</b>

           Due to the best-effort nature of this protocol, if too may contexts are attempting to perform surveys
           simultaneously, it is possible for either individual outgoing surveys or incoming responses to be
           lost.

   <b>Protocol</b> <b>Versions</b>
       Only version 0 of this protocol is supported. (At the time of writing, no other versions of this protocol
       have been defined. An earlier and incompatible version of the protocol was used in older pre-releases of
       nanomsg &lt;<a href="http://nanomsg.org">http://nanomsg.org</a>&gt;, but was not released in any production version.)

   <b>Protocol</b> <b>Options</b>
       The following protocol-specific options is available.

       NNG_OPT_SURVEYOR_SURVEYTIME
           (nng_duration) Duration of surveys. When a new survey is started, a timer of this duration is also
           started. Any responses arriving this time will be discarded. Attempts to receive after the timer
           expires with no other surveys started will result in NNG_ESTATE. Attempts to receive when this timer
           expires will result in NNG_ETIMEDOUT.

   <b>Protocol</b> <b>Headers</b>
       This form uses a stack of 32-bit big-endian identifiers. There <b>must</b> be at least one identifier, the
       <u>survey</u> <u>ID</u>, which will be the last element in the array, and <b>must</b> have the most significant bit set.

       There may be additional <u>peer</u> <u>ID</u>s preceding the survey ID. These will be distinguishable from the survey
       ID by having their most significant bit clear.

       When a survey message is received by a forwarding node (see nng_device()), the forwarding node prepends a
       32-bit peer ID (which <b>must</b> have the most significant bit clear), which is the forwarderâ€™s way of
       identifying the directly connected peer from which it received the message. (This peer ID, except for the
       most significant bit, has meaning only to the forwarding node itself.)

       It may help to think of prepending a peer ID as pushing a peer ID onto the front of the stack of headers
       for the message. (It will use the peer ID it popped from the front to determine the next intermediate
       destination for the response.)

       When a response message is created, it is created using the same headers that the survey contained.

       A forwarding node can pop the peer ID it originally pushed on the message, stripping it from the front of
       the message as it does so.

       When the response finally arrives back at the initiating surveyor, it should have only a single element
       in the message, which will be the survey ID it originally used for the request.

       More detail can be found in the RFC sp-surveyor-01
       &lt;https://github.com/nanomsg/nanomsg/blob/master/rfc/sp-surveyor-01.txt&gt; document.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3/nng_surveyor_open.3.html">nng_surveyor_open</a>(3), <a href="../man7/nng_respondent.7.html">nng_respondent</a>(7), <a href="../man7/nng.7.html">nng</a>(7)

                                                   2025-04-20                                    <u><a href="../man7/NNG_SURVEYOR.7.html">NNG_SURVEYOR</a></u>(7)
</pre>
 </div>
</div></section>
</div>
</body>
</html>