<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyrus::Annotator::Message - representation of a message to annotate</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcyrus-imap-perl">libcyrus-imap-perl_3.10.2-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Cyrus::Annotator::Message - representation of a message to annotate

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use warnings;
         use strict;
         package MyAnnotatorDaemon;
         use base Cyrus::Annotator::Daemon;

         sub annotate_message
         {
             my ($message) = @_;

             $message-&gt;set_flag('\Flagged');
             $message-&gt;set_shared_annotation('/comment', 'Hello!!');
         }

         MyAnnotatorDaemon-&gt;run();

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module encapsulates a message which is being processed by the annotator daemon.

</pre><h4><b>METHODS</b></h4><pre>
       Cyrus::Annotator::Message has the following methods.

       <u>new(%args)</u>
           Takes the following args:

            # required
            * BODYSTRUCTURE =&gt; parsed bodystructure

            # optional (but you need to provide SOMETHING if your code uses any
            # of the accessors)
            * GUID =&gt; 40 character sha1
            * HEADER =&gt; Mail::Header object with headers pre-parsed
            * FILENAME =&gt; path to rfc822 file

            # totally optional (will be considered empty if not set)
            * FLAGS =&gt; array of already set flags
            * ANNOTATIONS =&gt; array of already set annotations

       <u><b>fh()</b></u>
           returns a read-only filehandle to the raw (rfc822) representation of the full message.

       <u>decode_part($Part,</u> <u>$Content)</u>
           Given some content, decode it from the part's content encoding and charset.

       <u>read_part_content($Part,</u> <u>$nbytes)</u>
           returns  the first n bytes of the bodypart passed.  This is a section of the bodystructure (hashref).
           If no part is passed, it's the raw message.

           If no 'nbytes' is passed, read the entire part.

       <u><b>header()</b></u>
           returns a Mail::Header object containing all the headers of the message.

       <u><b>bodystructure()</b></u>
           returns a structure

           is a structure closely based on the IMAP BODYSTRUCTURE, decoded into a  hash,  including  recursively
           all MIME sections.  In general, the following items are defined for all body structures:

           •   MIME-Type

           •   MIME-Subtype

           •   Content-Type

           •   Content-Description

           •   Content-Disposition

           •   Content-Language

           Body structures which have a MIME-Type of 'multipart' contain the following items:

           •   MIME-Subparts

           For body structures <b>except</b> those that have a MIME-Type of 'multipart', the following are defined:

           •   Content-ID

           •   Content-Description

           •   Content-Transfer-Encoding

           •   Content-MD5

           •   Size

           •   Lines

           •   Offset

           •   HeaderSize

       <u><b>guid()</b></u>
           returns the hex encoded (40 character) sha1 of the rfc822 representation.

       <u>has_flag($name)</u>
       <u>set_flag($name)</u>
       <u>clear_flag($name)</u>
           Check for the boolean value of a flag with $name, set the flag and remove the flag respectively.

           Note that changes are not immediate.  They will be applied by the annotator at the end.

           For example:

             $message-&gt;set_flag("\\Flagged");

       <u>get_shared_annotation($entry)</u>
       <u>get_private_annotation($entry)</u>
       <u>set_shared_annotation($entry,</u> <u>$value)</u>
       <u>set_private_annotation($entry,</u> <u>$value)</u>
       <u>clear_shared_annotation($entry)</u>
       <u>clear_private_annotation($entry)</u>
           Get,  set and clear the value of an annotation, either shared or private.  The "get" accessors return
           a string with the value.  Clear is the same as set with $value of the empty string ('').

           For example:

             $message-&gt;set_shared_annotation('/comment', 'Hello World');

       <u><b>get_changed()</b></u>
           returns two arrayrefs - [['flagname', 'bool']] and [['entry', 'type', 'value']], e.g.

           [["\\Flagged", 1]], [['/comment', 'value.shared', 'Hello World']]

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>RFC3501</u>, <u>RFC5257</u>.

</pre><h4><b>AUTHOR</b></h4><pre>
       Greg Banks &lt;<a href="mailto:gnb@fastmail.fm">gnb@fastmail.fm</a>&gt;.  Bron Gondwana &lt;<a href="mailto:brong@fastmail.fm">brong@fastmail.fm</a>&gt;.

perl v5.40.1                                       2025-06-27                                       <u><a href="../man3pm/Message.3pm.html">Message</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>