<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::Box::Manager - manage a set of folders</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmail-box-perl">libmail-box-perl_3.011-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::Box::Manager - manage a set of folders

</pre><h4><b>INHERITANCE</b></h4><pre>
        Mail::Box::Manager
          is a Mail::Reporter

        Mail::Box::Manager is extended by
          Mail::Box::Manage::User

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Mail::Box::Manager;
        my $mgr     = new Mail::Box::Manager;

        # Create folder objects.
        my $folder   = $mgr-&gt;open(folder =&gt; $ENV{MAIL});
        my $message1 = $folder-&gt;<a href="../man0/message.0.html">message</a>(0);
        $mgr-&gt;copyMessage('Draft', $message);

        my @messages = $folder-&gt;message(0,3);
        $mgr-&gt;moveMessage('Outbox', @messages, create =&gt; 1 );
        $mgr-&gt;close($folder);

        # Create thread-detectors (see Mail::Box::Thread::Manager)
        my $t       = $mgr-&gt;threads($inbox, $outbox);

        my $threads = $mgr-&gt;threads(folder =&gt; $folder);
        foreach my $thread ($threads-&gt;all)
        {   $thread-&gt;print;
        }

        $mgr-&gt;registerType(mbox =&gt; 'Mail::Box::MyType');

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The manager keeps track on a set of open folders and a set of message-thread supporting objects.  You are
       not obliged to use this object (you can directly create a Mail::Box::Mbox if you prefer), but you will
       create more portable and safer code if you do use it.

       Extends "DESCRIPTION" in Mail::Reporter.

</pre><h4><b>METHODS</b></h4><pre>
       Extends "METHODS" in Mail::Reporter.

   <b>Constructors</b>
       Extends "Constructors" in Mail::Reporter.

       Mail::Box::Manager-&gt;<b>new</b>($args)
            -Option             --Defined in     --Default
             autodetect                            undef
             default_folder_type                   'mbox'
             folder_types                          &lt;all standard types&gt;
             folderdir                             [ '.' ]
             folderdirs                            &lt;synonym for C&lt;folderdir&gt;&gt;
             log                  Mail::Reporter   'WARNINGS'
             trace                Mail::Reporter   'WARNINGS'

           autodetect =&gt; TYPE|ARRAY-OF-TYPES
             Select  only  a  subset  of  the  folder  types  which  are  implemented  by MailBox to be detected
             automatically.  This may improve the auto-detection of folder types.  Normally,  all  folder  types
             will be tried when a folder's name is incorrect, but this option limits the types which are checked
             and therefore may respond faster.

           default_folder_type =&gt; NAME|CLASS
             Specifies  the default folder type for newly created folders.  If this option is not specified, the
             most recently registered type is used (see <b>registerType()</b> and the new(folder_types) option.

           folder_types =&gt; NEW-TYPE | ARRAY-OF-NEW-TYPES
             Add one or more new folder types to the list of known types.  The order is important: when you open
             a file without specifying its type, the manager will start trying the last added list of types,  in
             order.

             Each  TYPE  is  specified  as  an  array which contains name, class, and defaults for options which
             overrule the usual defaults.  You may specify folder-specific defaults as OPTIONS.   They  override
             the settings of the manager.

           folderdir =&gt; DIRECTORY
             The  default  directory,  or  directories,  where folders are located. The "Mail::Box::Manager" can
             autodetect the existing folder-types.  There may be different kinds of folders opened at  the  same
             time,  and  messages  can  be  moved  between  those  types,  although that may result in a loss of
             information depending on the folder types.

           folderdirs =&gt; [DIRECTORIES]
           log =&gt; LEVEL
           trace =&gt; LEVEL

   <b>Attributes</b>
       $obj-&gt;<b>defaultFolderType</b>()
           Returns the default folder type, some class name.

       $obj-&gt;<b>folderTypes</b>()
           Returns the list of currently defined folder types.

           example:

            print join("\n", $manager-&gt;folderTypes), "\n";

       $obj-&gt;<b>folderdir</b>()
           In list context, this returns all folderdirs specified.  In SCALAR context only the first.

       $obj-&gt;<b>registerType</b>($type, $class, %options)
           With "registerType" you can register one $type of folders.  The $class is compiled automatically,  so
           you do not need to "use" them in your own modules.  The $type is just an arbitrary name.

           The  added types are prepended to the list of known types, so they are checked first when a folder is
           opened in autodetect mode.

           example:

            $manager-&gt;registerType(mbox =&gt; 'Mail::Box::Mbox',
                save_on_exit =&gt; 0, folderdir =&gt; '<a href="file:/tmp">/tmp</a>');

   <b>Manage</b> <b>open</b> <b>folders</b>
       $obj-&gt;<b>close</b>($folder, %options)
           "close" removes the specified folder from the list of open folders.  Indirectly it  will  update  the
           files  on disk if needed (depends on the Mail::Box::new(save_on_exit) flag for each folder). %options
           are passed to <b>Mail::Box::close()</b> of the folder.

           The folder's messages will also be withdrawn from the known message threads.  You may also close  the
           folder directly. The manager will be informed about this event and take appropriate actions.

            -Option       --Default
             close_by_self  &lt;false&gt;

           close_by_self =&gt; BOOLEAN
             Used internally to avoid confusion about how the close was started.  Do not change this.

           example:

            my $inbox = $mgr-&gt;open('inbox');
            $mgr-&gt;close($inbox);
            $inbox-&gt;close;        # alternative

       $obj-&gt;<b>closeAllFolders</b>(, %options)
           "closeAllFolders" calls <b>close()</b> for each folder managed by this object.  It is called just before the
           program stops (before global cleanup).

       $obj-&gt;<b>isOpenFolder</b>($folder)
           Returns true if the $folder is currently open.

           example:

            print "Yes\n" if $mgr-&gt;isOpenFolder('Inbox');

       $obj-&gt;<b>open</b>( [$foldername], %options )
           Open  a  folder  which  name  is  specified as first parameter or with the option flag "folder".  The
           folder type is autodetected unless the "type" is specified.

           "open" carries options for the manager which are described here, but may also have additional options
           for the folder type.  For a description of the folder options, see the  options  to  the  constructor
           <b>Mail::Box::new()</b> for each type of mail box.

            -Option      --Default
             authenticate  'AUTO'
             create        &lt;false&gt;
             folder        $ENV{MAIL}
             folderdir     '.'
             type          &lt;first, usually C&lt;mbox&gt;&gt;

           authenticate =&gt; TYPE|ARRAY-OF-TYPES|'AUTO'
             The TYPE of authentication to be used, or a list of TYPES which the client prefers.  The server may
             provide preferences as well, and that order will be kept.  This option is only supported by a small
             subset of folder types, especially by POP and IMAP.

           create =&gt; BOOLEAN
             Create  the folder if it does not exist. By default, this is not done.  The "type" option specifies
             which type of folder is created.

           folder =&gt; NAME|URL
             Which folder to open, specified by NAME or special URL.  The URL format is composed as

              type://username:password@hostname:port/foldername

             Like real URLs, all fields are optional and have smart defaults, as long as the string starts  with
             a  known  folder  type.  Far from all folder types support all these options, but at least they are
             always split-out.  Be warned that special characters  in  the  password  should  be  properly  url-
             encoded.

             When  you  specify anything which does not match the URL format, it is passed directly to the "new"
             method of the folder which is opened.

           folderdir =&gt; DIRECTORY
             The directory where the folders are usually stored.

           type =&gt; FOLDERTYPENAME|FOLDERTYPE
             Specify the type of the folder.  If you do not specify this  option  while  opening  a  folder  for
             reading,  the  manager  checks  all  registered  folder  types in order for the ability to open the
             folder. If you open a new folder for writing, then the default will be the most recently registered
             type. (If you add more than one type at once, the first of the list is used.)

             Currently, the types are "mbox", "mh", "maildir", "pop3", "pop3s", "imap4", and "imap4s".  You  may
             also use names "pop", "pops", "imap", and "imaps".

           example: opening folders via the manager

            my $jack  = $manager-&gt;open(folder =&gt; '=jack',
               type =&gt; 'mbox');

            my $rcvd  = $manager-&gt;open('myMail',
               type =&gt; 'Mail::Box::Mbox', access =&gt; 'rw');

            my $inbox = $manager-&gt;open('Inbox')
               or die "Cannot open Inbox.\n";

            my $pop   = 'pop3://myself:<a href="mailto:secret@pop3.server.com">secret@pop3.server.com</a>:120/x';
            my $send  = $manager-&gt;open($url);

            my $send  = $manager-&gt;open(folder =&gt; '/x',
              type =&gt; 'pop3', username =&gt; 'myself', password =&gt; 'secret'
              server_name =&gt; 'pop3.server.com', server_port =&gt; '120');

       $obj-&gt;<b>openFolders</b>()
           Returns a list of all open folders.

   <b>Manage</b> <b>existing</b> <b>folders</b>
       $obj-&gt;<b>delete</b>($foldername, %options)
           Remove the named folder.  The %options are the same as those for <b>open()</b>.

           The  deletion  of  a  folder can take some time.  Dependent on the type of folder, the folder must be
           read first.  For some folder-types this will be fast.

            -Option   --Default
             recursive  &lt;folder's default&gt;

           recursive =&gt; BOOLEAN
             Some folder can only be recursively deleted, other have more flexibility.

   <b>Move</b> <b>messages</b> <b>to</b> <b>folders</b>
       $obj-&gt;<b>appendMessage</b>( [$folder|$foldername], $messages, %options )
           Append one or more messages to a folder (therefore, an appendMessages() is defined as well). You  may
           specify  a  $foldername  or  an opened folder as the first argument. When the name is that of an open
           folder, it is treated as if the folder-object was specified, and  not  directly  access  the  folder-
           files.  You may also specify the foldername as part of the options list.

           If  a  message  is added to an already opened folder, it is only added to the structure internally in
           the program.  The data will not be written to disk until a write of that folder  takes  place.   When
           the  name of an unopened folder is given, the folder is opened, the messages stored on disk, and then
           the folder is closed.

           A message must be an instance of a Mail::Message.  The actual message type does not have to match the
           folder type--the folder will try to resolve the differences with minimal loss  of  information.   The
           coerced messages (how the were actually written) are returned as list.

           The  %options  is  a  list of key/values, which are added to (overriding) the default options for the
           detected folder type.

           example:

            $mgr-&gt;appendMessage('=send', $message, folderdir =&gt; '/');
            $mgr-&gt;appendMessage($received, $inbox-&gt;messages);

            my @appended = $mgr-&gt;appendMessages($inbox-&gt;messages,
               folder =&gt; 'Drafts');
            $_-&gt;label(seen =&gt; 1) foreach @appended;

       $obj-&gt;<b>copyMessage</b>( [$folder|$foldername], $messages, %options )
           Copy a message from one folder into another folder.  If the destination  folder  is  already  opened,
           <b>Mail::Box::copyTo()</b> is used.  Otherwise, <b>Mail::Box::appendMessages()</b> is called.

           You  need  to specify a folder's name or folder object as the first argument, or in the options list.
           The options are the same as those which can be specified when opening a folder.

            -Option--Default
             share   &lt;false&gt;

           share =&gt; BOOLEAN
             Try to share the physical storage of the messages.  The folder types may be different, but  it  all
             depends on the actual folder where the message is copied to.  Silently ignored when not possible to
             share.

           example:

            my $drafts = $mgr-&gt;open(folder =&gt; 'Drafts');
            my $outbox = $mgr-&gt;open(folder =&gt; 'Outbox');
            $mgr-&gt;copyMessage($outbox, $drafts-&gt;<a href="../man0/message.0.html">message</a>(0));

            my @messages = $drafts-&gt;message(1,2);
            $mgr-&gt;copyMessage('=Trash', @messages,
               folderdir =&gt; '<a href="file:/tmp">/tmp</a>', create =&gt; 1);

            $mgr-&gt;copyMessage($drafts-&gt;<a href="../man1/message.1.html">message</a>(1),
               folder =&gt; '=Drafts' folderdir =&gt; '<a href="file:/tmp">/tmp</a>',
               create =&gt; 1);

       $obj-&gt;<b>moveMessage</b>( [$folder|$foldername], $messages, %options )
           Move a message from one folder to another.

           BE  WARNED  that  removals from a folder only take place when the folder is closed, so the message is
           only flagged to be deleted in the opened source folder.

           BE WARNED that message labels may get lost when a message is moved from one folder type to an  other.
           An  attempt  is  made  to  translate  labels,  but  there  are  many differences in interpretation by
           applications.

            $mgr-&gt;moveMessage($received, $inbox-&gt;<a href="../man1/message.1.html">message</a>(1))

           is equivalent to

            $mgr-&gt;copyMessage($received, $inbox-&gt;<a href="../man1/message.1.html">message</a>(1), share =&gt; 1);
            $inbox-&gt;<a href="../man1/message.1.html">message</a>(1)-&gt;delete;

            -Option--Default
             share   &lt;true&gt;

           share =&gt; BOOLEAN

   <b>Manage</b> <b>message</b> <b>threads</b>
       $obj-&gt;<b>threads</b>( [$folders], %options )
           Create a new object which keeps track of message threads.  You can read about the possible options in
           Mail::Box::Thread::Manager.  As %options specify one folder or an array  of  $folders.   It  is  also
           permitted to specify folders before the options.

           example:

            my $t1 = $mgr-&gt;threads(folders =&gt; [ $inbox, $send ]);
            my $t2 = $mgr-&gt;threads($inbox);
            my $t3 = $mgr-&gt;threads($inbox, $send);

   <b>Internals</b>
       $obj-&gt;<b>decodeFolderURL</b>($url)
           Try  to  decompose  a  folder  name  which  is  specified as $url (see <b>open()</b>) into separate options.
           Special characters like @-sign, colon, and slash used in the user or password parts  must  be  passed
           $url-encoded.

       $obj-&gt;<b>toBeThreaded</b>($folder, $messages)
           Signal  to the manager that all thread managers which are using the specified folder must be informed
           that new messages are coming in.

       $obj-&gt;<b>toBeUnthreaded</b>($folder, $messages)
           Signal to the manager that all thread managers which are using the specified folder must be  informed
           that new messages are or going out.

   <b>Error</b> <b>handling</b>
       Extends "Error handling" in Mail::Reporter.

       $obj-&gt;<b>AUTOLOAD</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>addReport</b>($object)
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>defaultTrace</b>( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )
       Mail::Box::Manager-&gt;<b>defaultTrace</b>( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>errors</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>log</b>( [$level, [$strings]] )
       Mail::Box::Manager-&gt;<b>log</b>( [$level, [$strings]] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>logPriority</b>($level)
       Mail::Box::Manager-&gt;<b>logPriority</b>($level)
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>logSettings</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>notImplemented</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>report</b>( [$level] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>reportAll</b>( [$level] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>trace</b>( [$level] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>warnings</b>()
           Inherited, see "Error handling" in Mail::Reporter

   <b>Cleanup</b>
       Extends "Cleanup" in Mail::Reporter.

       $obj-&gt;<b>DESTROY</b>()
           Inherited, see "Cleanup" in Mail::Reporter

</pre><h4><b>DETAILS</b></h4><pre>
       On  many  places in the documentation you can read that it is useful to have a manager object.  There are
       two of them: the Mail::Box::Manager, which maintains a set of open folders, and an extension of  it:  the
       Mail::Box::Manage::User.

   <b>Managing</b> <b>open</b> <b>folders</b>
       It  is  useful  to  start  your  program by creating a folder manager object, an Mail::Box::Manager.  The
       object takes a few burdons from your neck:

       •   autodetect the type of folder which is used.

           This means that your application can be fully folder type independent.

       •   autoload the required modules

           There are so many modules involved in MailBox, that it is useful to have  some  lazy  autoloading  of
           code.  The manager knows which modules belong to which type of folder.

       •   avoid double openings

           Your  programming mistakes may cause the same folder to be opened twice.  The result of that could be
           very destructive.  Therefore, the manager keeps track on all open folders and avoids the same  folder
           to be opened for the second time.

       •   close folders at clean-up

           When the program is ending, the manager will cleanly close all folders which are still open.  This is
           required, because the autodestruct sequence of Perl works in an unpredicatable order.

       •   message thread detection

           MailBox  can  discover  message  threads  which span multiple folders. Any set of open folders may be
           grouped in a tree of replies on replies on replies.  When a folder is closed, it  will  automatically
           be removed from the threads, and a new folder can dynamically be added to the structure.

       The  manager  is really simplifying things, and should therefore be the base of all programs. However, it
       is possible to write useful programs without it.

   <b>Managing</b> <b>a</b> <b>user</b>
       One step further is the Mail::Box::Manage::User object (since MailBox v2.057), which not only keeps track
       on open folders, but also collects information about not-open folders.

       The user class is, as the name says, targeted on managing one single user.  Where the  Mail::Box::Manager
       will  open  any  set  of  folder files, probably from multiple users, the user class want one root folder
       directory.

       In many aspects, the user manager simplifies the task  for  user-based  servers  and  other  user-centric
       applications by setting smart defaults.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Error: Folder $name is already open.
           You cannot ask the manager for a folder which is already open. In some older releases (before MailBox
           2.049),  this  was  permitted,  but then behaviour changed, because many nasty side-effects are to be
           expected.  For instance, an <b>Mail::Box::update()</b> on one folder  handle  would  influence  the  second,
           probably unexpectedly.

       Error: Folder $name is not a Mail::Box; cannot add a message.
           The  folder  where  the  message  should be appended to is an object which is not a folder type which
           extends Mail::Box.  Probably, it is not a folder at all.

       Warning: Folder does not exist, failed opening $type folder $name.
           The folder does not exist and creating is not permitted (see open(create)) or did not succeed.   When
           you  do  not have sufficient access rights to the folder (for instance wrong password for POP3), this
           warning will be produced as well.

           The manager tried to open a folder of the specified type.  It may help to explicitly state  the  type
           of your folder with the "type" option.  There will probably be another warning or error message which
           is  related  to  this  report and provides more details about its cause.  You may also have a look at
           new(autodetect) and new(folder_types).

       Warning: Folder type $type is unknown, using autodetect.
           The specified folder type (see open(type), possibly derived from the folder name  when  specified  as
           url)  is  not known to the manager.  This may mean that you forgot to require the Mail::Box extension
           which implements this folder type, but probably it is a  typo.   Usually,  the  manager  is  able  to
           figure-out which type to use by itself.

       Error: Illegal folder URL '$url'.
           The  folder name was specified as URL, but not according to the syntax.  See <b>decodeFolderURL()</b> for an
           description of the syntax.

       Error: No foldername specified to open.
           open() needs a folder name as first argument (before the list  of  options),  or  with  the  "folder"
           option  within  the list.  If no name was found, the MAIL environment variable is checked.  When even
           that does not result in a usable folder, then this error is produced.  The error may be caused by  an
           accidental odd-length option list.

       Error: Package $package does not implement $method.
           Fatal  error:  the specific package (or one of its superclasses) does not implement this method where
           it should. This message means that some other related classes do implement this  method  however  the
           class  at  hand does not.  Probably you should investigate this and probably inform the author of the
           package.

       Error: Use <b>appendMessage()</b> to add messages which are not in a folder.
           You do not need to copy this message into the folder, because you do not share  the  message  between
           folders.

       Warning: Use <b>moveMessage()</b> or <b>copyMessage()</b> to move between open folders.
           The  message  is  already part of a folder, and now it should be appended to a different folder.  You
           need to decide between copy or move, which both will clone the message (not the  body,  because  they
           are immutable).

       Warning: Will never create a folder $name without having write access.
           You have set open(create), but only want to read the folder.  Create is only useful for folders which
           have write or append access modes (see Mail::Box::new(access)).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       This  module  is  part  of  Mail-Box  distribution  version  3.011,  built  on  April  18, 2025. Website:
       <u><a href="http://perl.overmeer.net/CPAN/">http://perl.overmeer.net/CPAN/</a></u>

</pre><h4><b>LICENSE</b></h4><pre>
       Copyrights 2001-2025 by [Mark Overmeer]. For other contributors see ChangeLog.

       This program is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself.  See <u><a href="http://dev.perl.org/licenses/">http://dev.perl.org/licenses/</a></u>

perl v5.40.1                                       2025-04-25                            <u>Mail::Box::<a href="../man3pm/Manager.3pm.html">Manager</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>