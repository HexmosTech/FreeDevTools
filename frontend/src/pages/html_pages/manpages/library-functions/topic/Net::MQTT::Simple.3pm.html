<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::MQTT::Simple - Minimal MQTT version 3 interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-mqtt-simple-perl">libnet-mqtt-simple-perl_1.29-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::MQTT::Simple - Minimal MQTT version 3 interface

</pre><h4><b>SYNOPSIS</b></h4><pre>
           # One-liner that publishes sensor values from STDIN

           perl -MNet::MQTT::Simple=mosquitto.example.org \
                -nle'retain "topic/here" =&gt; $_'

           # Functional (single server only)

           use Net::MQTT::Simple "mosquitto.example.org";

           publish "topic/here" =&gt; "Message here";
           retain  "topic/here" =&gt; "Retained message here";

           # Object oriented (supports subscribing to topics)

           use Net::MQTT::Simple;

           my $mqtt = Net::MQTT::Simple-&gt;new("mosquitto.example.org");

           $mqtt-&gt;publish("topic/here" =&gt; "Message here");
           $mqtt-&gt;retain( "topic/here" =&gt; "Message here");

           $mqtt-&gt;run(
               "sensors/+/temperature" =&gt; sub {
                   my ($topic, $message) = @_;
                   die "The building's on fire" if $message &gt; 150;
               },
               "#" =&gt; sub {
                   my ($topic, $message) = @_;
                   print "[$topic] $message\n";
               },
           );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module consists of only one file and has no dependencies except core Perl modules, making it
       suitable for embedded installations where CPAN installers are unavailable and resources are limited.

       Only basic MQTT functionality is provided; if you need more, you'll have to use the full-featured
       Net::MQTT instead.

       Connections are set up on demand, automatically reconnecting to the server if a previous connection had
       been lost.

       Because sensor scripts often run unattended, connection failures will result in warnings (on STDERR if
       you didn't override that) without throwing an exception.

       Please refer to Net::MQTT::Simple::SSL for more information about encrypted and authenticated
       connections.

   <b>Functional</b> <b>interface</b>
       This will suffice for most simple sensor scripts. A socket is kept open for reuse until the script has
       finished. The functional interface cannot be used for subscriptions, only for publishing.

       Instead of requesting symbols to be imported, provide the MQTT server on the "use Net::MQTT::Simple"
       line. A non-standard port can be specified with a colon. The functions "publish" and "retain" will be
       exported.

   <b>Object</b> <b>oriented</b> <b>interface</b>
       <u>new(server[,</u> <u>sockopts])</u>

       Specify the server (possibly with a colon and port number) to the constructor, "Net::MQTT::Simple-&gt;new".
       The socket is disconnected when the object goes out of scope.

       Optionally, a reference to a hash of socket options can be passed. Options specified in this hash are
       passed on to the socket constructor.

       <u>last_will([$topic,</u> <u>$message[,</u> <u>$retain]])</u>

       Set a "Last Will and Testament", to be used on subsequent connections. Note that the last will cannot be
       updated for a connection that is already established.

       A last will is a message that is published by the broker on behalf of the client, if the connection is
       dropped without an explicit call to "disconnect".

       Without arguments, returns the current values without changing the active configuration.

       When the given topic and message are both undef, the last will is deconfigured.  In other cases, only
       arguments which are "defined" are updated with the given value. For the first setting, the topic is
       mandatory, the message defaults to an empty string, and the retain flag defaults to false.

       Returns a list of the three values in the same order as the arguments.

       <u>login($username[,</u> <u>$password])</u>

       Sets authentication credentials, to be used on subsequent connections. Note that the credentials cannot
       be updated for a connection that is already established.

       The username is text, the password is binary.

       See Net::MQTT::Simple::SSL for information about secure connections. To enable insecure password
       authenticated connections, set the environment variable MQTT_SIMPLE_ALLOW_INSECURE_LOGIN to a true value.

       Returns the username.

</pre><h4><b>DISCONNECTING</b> <b>GRACEFULLY</b></h4><pre>
   <b>disconnect</b>
       Performs a graceful disconnect, which ensures that the server does NOT send the registered "Last Will"
       message.

       Subsequent calls that require a connection, will cause a new connection to be set up.

</pre><h4><b>PUBLISHING</b> <b>MESSAGES</b></h4><pre>
       The two methods for publishing messages are the same, except for the state of the "retain" flag.

   <b>retain(topic,</b> <b>message)</b>
       Publish the message with the "retain" flag on. Use this for sensor values or anything else where the
       message indicates the current status of something.

       To discard a retained topic, provide an empty or undefined message.

   <b>publish(topic,</b> <b>message)</b>
       Publishes the message with the "retain" flag off. Use this for ephemeral messages about events that occur
       (like that a button was pressed).

</pre><h4><b>SUBSCRIPTIONS</b></h4><pre>
   <b>subscribe(topic,</b> <b>handler[,</b> <b>topic,</b> <b>handler,</b> <b>...])</b>
       Subscribes to the given topic(s) and registers the callbacks. Note that only the first matching handler
       will be called for every message, even if filter patterns overlap.

   <b>unsubscribe(topic[,</b> <b>topic,</b> <b>...])</b>
       Unsubscribes from the given topic(s) and unregisters the corresponding callbacks. The given topics must
       exactly match topics that were previously used with the "subscribe" method.

   <b>run(...)</b>
       Enters an infinite loop, which calls "tick" repeatedly. If any arguments are given, they will be passed
       to "subscribe" first.

   <b>tick(timeout)</b>
       Test the socket to see if there's any incoming message, waiting at most <u>timeout</u> seconds (can be
       fractional). Use a timeout of 0 to avoid blocking, but note that blocking automatic reconnection may take
       place, which may take much longer.

       If "tick" returns false, this means that the socket was no longer connected and that the next call will
       cause a reconnection attempt. However, a true value does not necessarily mean that the socket is still
       functional. The only way to reliably determine that a TCP stream is still connected, is to actually
       communicate with the server, e.g. with a ping, which is only done periodically.

</pre><h4><b>UTILITY</b> <b>FUNCTIONS</b></h4><pre>
   <b>Net::MQTT::Simple::filter_as_regex(topic_filter)</b>
       Given a valid MQTT topic filter, returns the corresponding regular expression.

</pre><h4><b>IPv6</b> <b>PREREQUISITE</b></h4><pre>
       For IPv6 support, the module IO::Socket::IP needs to be installed. It comes with Perl 5.20 and is
       available from CPAN for older Perls. If this module is not available, the older IO::Socket::INET will be
       used, which only supports Legacy IP (IPv4).

</pre><h4><b>MANUAL</b> <b>INSTALLATION</b></h4><pre>
       If you can't use the CPAN installer, you can actually install this module by creating a directory
       "Net/MQTT" and putting "Simple.pm" in it. Please note that this method does not work for every Perl
       module and should be used only as a last resort on systems where proper installers are not available.

       To view the list of @INC paths where Perl searches for modules, run "perl -V". This list includes the
       current working directory ("."). Additional include paths can be specified in the "PERL5LIB" environment
       variable; see perlenv.

</pre><h4><b>NOT</b> <b>SUPPORTED</b></h4><pre>
       QoS (Quality of Service)
           Every message is published at QoS level 0, that is, "at most once", also known as "fire and forget".

       DUP (Duplicate message)
           Since  QoS  is  not  supported, no retransmissions are done, and no message will indicate that it has
           already been sent before.

       Authentication
           No username and password are sent to the server.

       Large data
           Because everything is handled in memory and there's no way to  indicate  to  the  server  that  large
           messages  are  not desired, the connection is dropped as soon as the server announces a packet larger
           than 2 megabytes.

       Validation of server-to-client communication
           The MQTT spec prescribes mandatory validation of all incoming data,  and  disconnecting  if  anything
           (really,  anything)  is wrong with it. However, this minimal implementation silently ignores anything
           it doesn't specifically handle, which may result in weird behaviour if the server sends out bad data.

           Most clients do not adhere to this part of the specifications.

</pre><h4><b>CAVEATS</b></h4><pre>
   <b>Automatic</b> <b>reconnection</b>
       Connection and reconnection are handled automatically, but without retries. If anything goes wrong,  this
       will  cause  a single reconnection attempt before the following action. For example, if sending a message
       fails because of a disconnected socket, the message will not  be  resent,  but  the  next  message  might
       succeed.  Only  one  new  connection  attempt  is  done  per  approximately 5 seconds.  This behaviour is
       intended.

   <b>Unicode</b>
       This module uses the proper Perl Unicode abstractions for parts that according to the MQTT  specification
       are  UTF-8 encoded. This includes <u>topic</u>s, but not <u>message</u>s. Published messages are binary data, which you
       may have to encode and decode yourself.

       This means that if you have UTF-8 encoded string literals in your code, you should "use utf8;"  and  that
       any  of  those  strings  which  is  a  <u>message</u>  will  need  to  be  encoded  by  you,  for  example  with
       "utf8::encode($message);".

       It also means that a <u>message</u> should never contain any character with an ordinal  value  of  greater  than
       255,  because  those  cannot  be  used in binary communication. If you're passing non-ASCII text strings,
       encode them before publishing, decode them after receiving. A character greater than  255  results  in  a
       warning

           Wide character in publish at yourfile.pl line 42.

       while the UTF-8 encoded data is passed through. To get rid of the warning, use "utf8::encode($message);".

</pre><h4><b>LICENSE</b></h4><pre>
       This  software  may be redistributed under the terms of the GPL, LGPL, modified BSD, or Artistic license,
       or any of the other OSI  approved  licenses  listed  at  <a href="http://www.opensource.org/licenses/alphabetical">http://www.opensource.org/licenses/alphabetical</a>.
       Distribution  is allowed under all of these these licenses, or any smaller subset of multiple or just one
       of these licenses.

       When using a packaged version, please refer to the package metadata to see under which license  terms  it
       was  distributed.  Alternatively,  a  distributor  may  choose  to  replace  the  LICENSE  section of the
       documentation and/or include a LICENSE file to reflect the license(s) they chose to redistribute under.

</pre><h4><b>AUTHOR</b></h4><pre>
       Juerd Waalboer &lt;<a href="mailto:juerd@tnx.nl">juerd@tnx.nl</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Net::MQTT, Net::MQTT::Simple::SSL

perl v5.36.0                                       2023-10-30                             <u>Net::MQTT::<a href="../man3pm/Simple.3pm.html">Simple</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>