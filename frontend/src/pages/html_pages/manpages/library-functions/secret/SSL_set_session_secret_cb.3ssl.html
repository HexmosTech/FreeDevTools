<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_set_session_secret_cb, tls_session_secret_cb_fn - set the session secret callback</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_set_session_secret_cb, tls_session_secret_cb_fn - set the session secret callback

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        typedef int (*tls_session_secret_cb_fn)(SSL *s, void *secret, int *secret_len,
                                                STACK_OF(SSL_CIPHER) *peer_ciphers,
                                                const SSL_CIPHER **cipher, void *arg);

        int SSL_set_session_secret_cb(SSL *s,
                                      tls_session_secret_cb_fn session_secret_cb,
                                      void *arg);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_set_session_secret_cb()</b> sets the session secret callback to be used (<u>session_secret_cb</u>), and an
       optional argument (<u>arg</u>) to be passed to that callback when it is called. This is only useful for an
       implementation of EAP-FAST (RFC4851). The presence of the callback also modifies the internal OpenSSL TLS
       state machine to match the modified TLS behaviour as described in RFC4851. Therefore this callback should
       not be used except when implementing EAP-FAST.

       The callback is expected to set the master secret to be used by filling in the data pointed to by
       <u>*secret</u>. The size of the secret buffer is initially available in <u>*secret_len</u> and may be updated by the
       callback (but must not be larger than the initial value).

       On the server side the set of ciphersuites offered by the peer is provided in the <u>peer_ciphers</u> stack.
       Optionally the callback may select the preferred ciphersuite by setting it in <u>*cipher</u>.

       On the client side the <u>peer_ciphers</u> stack will always be NULL. The callback may specify the preferred
       cipher in <u>*cipher</u> and this will be associated with the <b>SSL_SESSION</b> - but it does not affect the
       ciphersuite selected by the server.

       The callback is also supplied with an additional argument in <u>arg</u> which is the argument that was provided
       to the original <b>SSL_set_session_secret_cb()</b> call.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_set_session_secret_cb()</b> returns 1 on success and 0 on failure.

       If the callback returns 1 then this indicates it has successfully set the secret. A return value of 0
       indicates that the secret has not been set. On the client this will cause an immediate abort of the
       handshake.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_get_session.3.html">SSL_get_session</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                    <u><a href="../man3SSL/SSL_SET_SESSION_SECRET_CB.3SSL.html">SSL_SET_SESSION_SECRET_CB</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>