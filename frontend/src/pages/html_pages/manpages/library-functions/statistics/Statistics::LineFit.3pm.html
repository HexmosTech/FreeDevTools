<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statistics::LineFit - Least squares line fit, weighted or unweighted</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libstatistics-linefit-perl">libstatistics-linefit-perl_0.07-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Statistics::LineFit - Least squares line fit, weighted or unweighted

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Statistics::LineFit;
        $lineFit = Statistics::LineFit-&gt;new();
        $lineFit-&gt;setData (\@xValues, \@yValues) or die "Invalid data";
        ($intercept, $slope) = $lineFit-&gt;coefficients();
        defined $intercept or die "Can't fit line if x values are all equal";
        $rSquared = $lineFit-&gt;rSquared();
        $meanSquaredError = $lineFit-&gt;meanSqError();
        $durbinWatson = $lineFit-&gt;durbinWatson();
        $sigma = $lineFit-&gt;sigma();
        ($tStatIntercept, $tStatSlope) = $lineFit-&gt;tStatistics();
        @predictedYs = $lineFit-&gt;predictedYs();
        @residuals = $lineFit-&gt;residuals();
        (varianceIntercept, $varianceSlope) = $lineFit-&gt;varianceOfEstimates();

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The Statistics::LineFit module does weighted or unweighted least-squares line fitting to two-dimensional
       data (y = a + b * x).  (This is also called linear regression.)  In addition to the slope and
       y-intercept, the module can return the square of the correlation coefficient (R squared), the Durbin-
       Watson statistic, the mean squared error, sigma, the t statistics, the variance of the estimates of the
       slope and y-intercept, the predicted y values and the residuals of the y values.  (See the METHODS
       section for a description of these statistics.)

       The module accepts input data in separate x and y arrays or a single 2-D array (an array of arrayrefs).
       The optional weights are input in a separate array.  The module can optionally verify that the input data
       and weights are valid numbers.  If weights are input, the line fit minimizes the weighted sum of the
       squared errors and the following statistics are weighted: the correlation coefficient, the Durbin-Watson
       statistic, the mean squared error, sigma and the t statistics.

       The module is state-oriented and caches its results.  Once you call the <b>setData()</b> method, you can call
       the other methods in any order or call a method several times without invoking redundant calculations.
       After calling <b>setData()</b>, you can modify the input data or weights without affecting the module's results.

       The decision to use or not use weighting could be made using your a priori knowledge of the data or using
       supplemental data.  If the data is sparse or contains non-random noise, weighting can degrade the
       solution.  Weighting is a good option if some points are suspect or less relevant (e.g., older terms in a
       time series, points that are known to have more noise).

</pre><h4><b>ALGORITHM</b></h4><pre>
       The least-square line is the line that minimizes the sum of the squares of the y residuals:

        Minimize SUM((y[i] - (a + b * x[i])) ** 2)

       Setting the parial derivatives of a and b to zero yields a solution that can be expressed in terms of the
       means, variances and covariances of x and y:

        b = SUM((x[i] - meanX) * (y[i] - meanY)) / SUM((x[i] - meanX) ** 2)

        a = meanY - b * meanX

       Note that a and b are undefined if all the x values are the same.

       If you use weights, each term in the above sums is multiplied by the value of the weight for that index.
       The program normalizes the weights (after copying the input values) so that the sum of the weights equals
       the number of points.  This minimizes the differences between the weighted and unweighted equations.

       Statistics::LineFit uses equations that are mathematically equivalent to the above equations and
       computationally more efficient.  The module runs in O(N) (linear time).

</pre><h4><b>LIMITATIONS</b></h4><pre>
       The regression fails if the input x values are all equal or the only unequal x values have zero weights.
       This is an inherent limit to fitting a line of the form y = a + b * x.  In this case, the module issues
       an error message and methods that return statistical values will return undefined values.  You can also
       use the return value of the <b>regress()</b> method to check the status of the regression.

       As the sum of the squared deviations of the x values approaches zero, the module's results becomes
       sensitive to the precision of floating point operations on the host system.

       If the x values are not all the same and the apparent "best fit" line is vertical, the module will fit a
       horizontal line.  For example, an input of (1, 1), (1, 7), (2, 3), (2, 5) returns a slope of zero, an
       intercept of 4 and an R squared of zero.  This is correct behavior because this line is the best least-
       squares fit to the data for the given parameterization (y = a + b * x).

       On a 32-bit system the results are accurate to about 11 significant digits, depending on the input data.
       Many of the installation tests will fail on a system with word lengths of 16 bits or fewer.  (You might
       want to upgrade your old 80286 IBM PC.)

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Alternate</b> <b>calling</b> <b>sequence:</b>
        use Statistics::LineFit;
        $lineFit = Statistics::LineFit-&gt;new();
        $lineFit-&gt;setData(\@x, \@y) or die "Invalid regression data\n";
        if (defined $lineFit-&gt;rSquared()
            and $lineFit-&gt;rSquared() &gt; $threshold)
        {
            ($intercept, $slope) = $lineFit-&gt;coefficients();
            print "Slope: $slope  Y-intercept: $intercept\n";
        }

   <b>Multiple</b> <b>calls</b> <b>with</b> <b>same</b> <b>object,</b> <b>validate</b> <b>input,</b> <b>suppress</b> <b>error</b> <b>messages:</b>
        use Statistics::LineFit;
        $lineFit = Statistics::LineFit-&gt;new(1, 1);
        while (1) {
            @xy = read2Dxy();  # User-supplied subroutine
            $lineFit-&gt;setData(\@xy);
            ($intercept, $slope) = $lineFit-&gt;coefficients();
            if (defined $intercept) {
                print "Slope: $slope  Y-intercept: $intercept\n";
            }
        }

</pre><h4><b>METHODS</b></h4><pre>
       The module is state-oriented and caches its results.  Once you call the <b>setData()</b> method, you can call
       the other methods in any order or call a method several times without invoking redundant calculations.

       The regression fails if the x values are all the same.  In this case, the module issues an error message
       and methods that return statistical values will return undefined values.  You can also use the return
       value of the <b>regress()</b> method to check the status of the regression.

   <b>new()</b> <b>-</b> <b>create</b> <b>a</b> <b>new</b> <b>Statistics::LineFit</b> <b>object</b>
        $lineFit = Statistics::LineFit-&gt;new();
        $lineFit = Statistics::LineFit-&gt;new($validate);
        $lineFit = Statistics::LineFit-&gt;new($validate, $hush);

        $validate = 1 -&gt; Verify input data is numeric (slower execution)
                    0 -&gt; Don't verify input data (default, faster execution)
        $hush = 1 -&gt; Suppress error messages
              = 0 -&gt; Enable error messages (default)

   <b>coefficients()</b> <b>-</b> <b>Return</b> <b>the</b> <b>slope</b> <b>and</b> <b>y</b> <b>intercept</b>
        ($intercept, $slope) = $lineFit-&gt;coefficients();

       The returned list is undefined if the regression fails.

   <b>durbinWatson()</b> <b>-</b> <b>Return</b> <b>the</b> <b>Durbin-Watson</b> <b>statistic</b>
        $durbinWatson = $lineFit-&gt;durbinWatson();

       The Durbin-Watson test is a test for first-order autocorrelation in the residuals of a time series
       regression. The Durbin-Watson statistic has a range of 0 to 4; a value of 2 indicates there is no
       autocorrelation.

       The return value is undefined if the regression fails.  If weights are input, the return value is the
       weighted Durbin-Watson statistic.

   <b>meanSqError()</b> <b>-</b> <b>Return</b> <b>the</b> <b>mean</b> <b>squared</b> <b>error</b>
        $meanSquaredError = $lineFit-&gt;meanSqError();

       The return value is undefined if the regression fails.  If weights are input, the return value is the
       weighted mean squared error.

   <b>predictedYs()</b> <b>-</b> <b>Return</b> <b>the</b> <b>predicted</b> <b>y</b> <b>values</b>
        @predictedYs = $lineFit-&gt;predictedYs();

       The returned list is undefined if the regression fails.

   <b>regress()</b> <b>-</b> <b>Do</b> <b>the</b> <b>least</b> <b>squares</b> <b>line</b> <b>fit</b> <b>(if</b> <b>not</b> <b>already</b> <b>done)</b>
        $lineFit-&gt;regress() or die "Regression failed"

       You don't need to call this method because it is invoked by the other methods as needed.  After you call
       <b>setData()</b>, you can call <b>regress()</b> at any time to get the status of the regression for the current data.

   <b>residuals()</b> <b>-</b> <b>Return</b> <b>predicted</b> <b>y</b> <b>values</b> <b>minus</b> <b>input</b> <b>y</b> <b>values</b>
        @residuals = $lineFit-&gt;residuals();

       The returned list is undefined if the regression fails.

   <b>rSquared()</b> <b>-</b> <b>Return</b> <b>the</b> <b>square</b> <b>of</b> <b>the</b> <b>correlation</b> <b>coefficient</b>
        $rSquared = $lineFit-&gt;rSquared();

       R squared, also called the square of the Pearson product-moment correlation coefficient, is a measure of
       goodness-of-fit.  It is the fraction of the variation in Y that can be attributed to the variation in X.
       A perfect fit will have an R squared of 1; fitting a line to the vertices of a regular polygon will yield
       an R squared of zero.  Graphical displays of data with an R squared of less than about 0.1 do not show a
       visible linear trend.

       The return value is undefined if the regression fails.  If weights are input, the return value is the
       weighted correlation coefficient.

   <b>setData()</b> <b>-</b> <b>Initialize</b> <b>(x,y)</b> <b>values</b> <b>and</b> <b>optional</b> <b>weights</b>
        $lineFit-&gt;setData(\@x, \@y) or die "Invalid regression data";
        $lineFit-&gt;setData(\@x, \@y, \@weights) or die "Invalid regression data";
        $lineFit-&gt;setData(\@xy) or die "Invalid regression data";
        $lineFit-&gt;setData(\@xy, \@weights) or die "Invalid regression data";

       @xy is an array of arrayrefs; x values are $xy[$i][0], y values are $xy[$i][1].  (The module does not
       access any indices greater than $xy[$i][1], so the arrayrefs can point to arrays that are longer than two
       elements.)  The method identifies the difference between the first and fourth calling signatures by
       examining the first argument.

       The optional weights array must be the same length as the data array(s).  The weights must be non-
       negative numbers; at least two of the weights must be nonzero.  Only the relative size of the weights is
       significant: the program normalizes the weights (after copying the input values) so that the sum of the
       weights equals the number of points.  If you want to do multiple line fits using the same weights, the
       weights must be passed to each call to <b>setData()</b>.

       The method will return zero if the array lengths don't match, there are less than two data points, any
       weights are negative or less than two of the weights are nonzero. If the <b>new()</b> method was called with
       validate = 1, the method will also verify that the data and weights are valid numbers.  Once you
       successfully call <b>setData()</b>, the next call to any method other than <b>new()</b> or <b>setData()</b> invokes the
       regression.  You can modify the input data or weights after calling <b>setData()</b> without affecting the
       module's results.

   <b>sigma()</b> <b>-</b> <b>Return</b> <b>the</b> <b>standard</b> <b>error</b> <b>of</b> <b>the</b> <b>estimate</b>
       $sigma = $lineFit-&gt;<b>sigma()</b>;

       Sigma is an estimate of the homoscedastic standard deviation of the error.  Sigma is also known as the
       standard error of the estimate.

       The return value is undefined if the regression fails.  If weights are input, the return value is the
       weighted standard error.

   <b>tStatistics()</b> <b>-</b> <b>Return</b> <b>the</b> <b>t</b> <b>statistics</b>
        (tStatIntercept, $tStatSlope) = $lineFit-&gt;tStatistics();

       The t statistic, also called the t ratio or Wald statistic, is used to accept or reject a hypothesis
       using a table of cutoff values computed from the t distribution.  The t-statistic suggests that the
       estimated value is (reasonable, too small, too large) when the t-statistic is (close to zero, large and
       positive, large and negative).

       The returned list is undefined if the regression fails.  If weights are input, the returned values are
       the weighted t statistics.

   <b>varianceOfEstimates()</b> <b>-</b> <b>Return</b> <b>variances</b> <b>of</b> <b>estimates</b> <b>of</b> <b>intercept,</b> <b>slope</b>
        (varianceIntercept, $varianceSlope) = $lineFit-&gt;varianceOfEstimates();

       Assuming the data are noisy or inaccurate, the intercept and slope returned by the <b>coefficients()</b> method
       are only estimates of the true intercept and slope.  The <b>varianceofEstimate()</b> method returns the
       variances of the estimates of the intercept and slope, respectively.  See Numerical Recipes in C, section
       15.2 (Fitting Data to a Straight Line), equation 15.2.9.

       The returned list is undefined if the regression fails.  If weights are input, the returned values are
       the weighted variances.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        Mendenhall, W., and Sincich, T.L., 2003, A Second Course in Statistics:
          Regression Analysis, 6th ed., Prentice Hall.
        Press, W. H., Flannery, B. P., Teukolsky, S. A., Vetterling, W. T., 1992,
          Numerical Recipes in C : The Art of Scientific Computing, 2nd ed.,
          Cambridge University Press.
        The man page for <a href="../man1/perl.1.html">perl</a>(1).
        The CPAN modules Statistics::OLS, Statistics::GaussHelmert and
          Statistics::Regression.

       Statistics::LineFit is simpler to use than Statistics::GaussHelmert or Statistics::Regression.
       Statistics::LineFit was inspired by and borrows some ideas from the venerable Statistics::OLS module.

       The significant differences between Statistics::LineFit and Statistics::OLS (version 0.07) are:

       <b>Statistics::LineFit</b> <b>is</b> <b>more</b> <b>robust.</b>
           Statistics::OLS  returns incorrect results for certain input datasets.  Statistics::OLS does not deep
           copy its input arrays, which can lead to subtle bugs.  The Statistics::OLS installation test has only
           one  test  and  does  not  verify  that  the  regression  returns  correct  results.   In   contrast,
           Statistics::LineFit  has  over  200 installation tests that use various datasets/calling sequences to
           verify the accuracy of the regression to within 1.0e-10.

       <b>Statistics::LineFit</b> <b>is</b> <b>faster.</b>
           For a sequence of calls to <b>new()</b>, setData(\@x, \@y) and <b>regress()</b>, Statistics::LineFit is faster than
           Statistics::OLS by factors of 2.0, 1.6 and 2.4 for array lengths of 5, 100 and 10000, respectively.

       <b>Statistics::LineFit</b> <b>can</b> <b>do</b> <b>weighted</b> <b>or</b> <b>unweighted</b> <b>regression.</b>
           Statistics::OLS lacks this option.

       <b>Statistics::LineFit</b> <b>has</b> <b>a</b> <b>better</b> <b>interface.</b>
           Once you call the <b>Statistics::LineFit::setData()</b> method, you can call the other methods in any  order
           and  call  methods  multiple times without invoking redundant calculations.  Statistics::LineFit lets
           you enable or disable data verification or error messages.

       <b>Statistics::LineFit</b> <b>has</b> <b>better</b> <b>code</b> <b>and</b> <b>documentation.</b>
           The code in Statistics::LineFit is more readable, more object oriented and more compliant  with  Perl
           coding standards than the code in Statistics::OLS.  The documentation for Statistics::LineFit is more
           detailed and complete.

</pre><h4><b>AUTHOR</b></h4><pre>
       Richard Anderson, cpan(AT)richardanderson(DOT)org, <a href="http://www.richardanderson.org">http://www.richardanderson.org</a>

</pre><h4><b>LICENSE</b></h4><pre>
       This  program  is  free  software;  you can redistribute it and/or modify it under the same terms as Perl
       itself.

       The full text of the license can be found in the LICENSE file included in the distribution and  available
       in the CPAN listing for Statistics::LineFit (see www.cpan.org or search.cpan.org).

</pre><h4><b>DISCLAIMER</b></h4><pre>
       To  the  maximum  extent permitted by applicable law, the author of this module disclaims all warranties,
       either express or implied, including but not limited to implied warranties of merchantability and fitness
       for a particular purpose, with regard to the software and the accompanying documentation.

perl v5.36.0                                       2022-12-12                           <u>Statistics::<a href="../man3pm/LineFit.3pm.html">LineFit</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>