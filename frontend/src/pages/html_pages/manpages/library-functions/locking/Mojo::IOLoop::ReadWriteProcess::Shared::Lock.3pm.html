<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mojo::IOLoop::ReadWriteProcess::Shared::Lock - IPC Lock</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmojo-ioloop-readwriteprocess-perl">libmojo-ioloop-readwriteprocess-perl_1.1.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mojo::IOLoop::ReadWriteProcess::Shared::Lock - IPC Lock

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Mojo::IOLoop::ReadWriteProcess qw(process queue lock);

           my $q = queue; # Create a Queue
           $q-&gt;pool-&gt;<a href="../man10/maximum_processes.10.html">maximum_processes</a>(10); # 10 Concurrent processes at maximum
           $q-&gt;queue-&gt;<a href="../man50/maximum_processes.50.html">maximum_processes</a>(50); # 50 is maximum total to be allowed in the queue

           $q-&gt;add(
             process(
               sub {
                 my $l = lock(key =&gt; 42); # IPC Lock
                 my $e = 1;
                 if ($l-&gt;lock) { # Blocking lock acquire
                   # Critical section
                   $e = 0;
                   $l-&gt;unlock;
                 }
                 exit($e);
               }
             )-&gt;<a href="../man0/set_pipes.0.html">set_pipes</a>(0)-&gt;<a href="../man0/internal_pipes.0.html">internal_pipes</a>(0)) for 1 .. 20; # Fill with 20 processes

           $q-&gt;consume(); # Consume the processes

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Mojo::IOLoop::ReadWriteProcess::Shared::Lock uses IPC::Semaphore internally and creates a Lock from a
       semaphore that is available across different processes.

</pre><h4><b>METHODS</b></h4><pre>
       Mojo::IOLoop::ReadWriteProcess::Shared::Lock inherits all events from
       Mojo::IOLoop::ReadWriteProcess::Shared::Semaphore and implements the following new ones.

   <b>lock/unlock</b>
           use Mojo::IOLoop::ReadWriteProcess qw(lock);

           my $l = lock(key =&gt; "42"); # Create Lock with key 42

           if ($l-&gt;lock) { # Blocking call
             # Critical section
             ...

             $l-&gt;unlock; # Release the lock
           }

       Acquire access to the lock and unlocks it.

       lock() has the same arguments as Mojo::IOLoop::ReadWriteProcess::Shared::Semaphore acquire().

   <b>try_lock</b>
           use Mojo::IOLoop::ReadWriteProcess qw(lock);

           my $l = lock(key =&gt; "42"); # Create Lock with key 42

           if ($l-&gt;try_lock) { # Non Blocking call
             # Critical section
             ...

             $l-&gt;unlock; # Release the lock
           }

       Try to acquire lock in a non-blocking way.

   <b>lock_section</b>
           use Mojo::IOLoop::ReadWriteProcess qw(lock);
           my $l = lock(key =&gt; 3331);
           my $e = 1;
           $l-&gt;lock_section(sub { $e = 0; die; }); # or also $l-&gt;section(sub { $e = 0 });

           $l-&gt;locked; # is 0

       Executes a function inside a locked section. Errors are caught so lock is released in case of failures.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       Mojo::IOLoop::ReadWriteProcess::Shared::Lock inherits all attributes from
       Mojo::IOLoop::ReadWriteProcess::Shared::Semaphore and provides the following new ones.

   <b>flags</b>
           use Mojo::IOLoop::ReadWriteProcess qw(lock);
           use IPC::SysV qw(IPC_CREAT IPC_EXCL S_IRUSR S_IWUSR);

           my $l = lock(flags=&gt; IPC_CREAT | IPC_EXCL | S_IRUSR | S_IWUSR);

       Sets flag for the lock. In such way you can limit the access to the lock, e.g. to specific user/group
       process.

   <b>key</b>
           use Mojo::IOLoop::ReadWriteProcess qw(lock);
           my $l = lock(key =&gt; 42);

       Sets the lock key that is used to retrieve the lock among different processes, must be an integer.

   <b>locked</b>
           use Mojo::IOLoop::ReadWriteProcess qw(lock);

           my $l = lock(key =&gt; 42);

           $l-&gt;lock_section(sub {
             $l-&gt;locked; # 1
           });

           $l-&gt;locked; # 0

       Returns the lock status

</pre><h4><b>DEBUGGING</b></h4><pre>
       You can set MOJO_PROCESS_DEBUG environment variable to get diagnostics about the process execution.

           MOJO_PROCESS_DEBUG=1

</pre><h4><b>LICENSE</b></h4><pre>
       Copyright (C) Ettore Di Giacinto.

       This library is free software; you can redistribute it and/or modify it under the same terms as Perl
       itself.

</pre><h4><b>AUTHOR</b></h4><pre>
       Ettore Di Giacinto &lt;<a href="mailto:edigiacinto@suse.com">edigiacinto@suse.com</a>&gt;

perl v5.40.1                                       2025-08-10             <u>Mojo::IOLoop::R...s::Shared::<a href="../man3pm/Lock.3pm.html">Lock</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>