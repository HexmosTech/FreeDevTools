<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio::SCF - Perl extension for reading and writing SCF sequence files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libbio-scf-perl">libbio-scf-perl_1.03-7build3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Bio::SCF - Perl extension for reading and writing SCF sequence files

</pre><h4><b>SYNOPSIS</b></h4><pre>
       use Bio::SCF;

       # tied interface tie %hash,'Bio::SCF','my_scf_file.scf';

       my $sequence_length            = $hash{bases_length}; my $chromatogram_sample_length =
       $hash{samples_length}; my $third_base                 = $hash{bases}[2]; my $quality_score              =
       $hash{$third_base}[2]; my $sample_A_at_time_1400      = $hash{samples}{A}[1400];

       # change the third base and write out new file $hash{bases}[2] = 'C'; tied (%hash)-&gt;write('new.scf');

       # object-oriented interface my $scf                        = Bio::SCF-&gt;new('my_scf_file.scf'); my
       $sequence_length            = $scf-&gt;bases_length; my $chromatogram_sample_length = $scf-&gt;samples_length;
       my $third_base                 = $scf-&gt;<b><a href="../man2/bases.2.html">bases</a></b>(2); my $quality_score              = $scf-&gt;<b><a href="../man2/score.2.html">score</a></b>(2); my
       $sample_A_at_time_1400      = $scf-&gt;sample('A',1400);

       # change the third base and write out new file $scf-&gt;bases(2,'C'); $scf-&gt;write('new.scf');

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module provides a perl interface to SCF DNA sequencing files. It has both tied hash and an object-
       oriented interfaces. It provides the ability to read fields from SCF files and limited ability to modify
       them and write them back.

   <b>Tied</b> <b>Methods</b>
       $obj = tie %hash,'Bio::SCF',$filename_or_handle
           Tie the Bio::SCF module to a filename or filehandle. If successful, <b>tie()</b> will return the object.

       $value = $hash{'key'}
           Fetch a field from the SCF file. Valid keys are as follows:

             Key             Value
             ---             -----

             bases_length    Number of called bases in the sequence (read-only)

             samples_length  Number of samples in the file (read-only)

             version         SCF version (read-only)

             code_set        Code set used to code bases (read-only)

             comments        Structured comments (read-only)

             bases           Array reference to a list of the base calls

             index           Array reference to a list of the sample position
                               for each of the base calls (e.g. the position of
                               the base calling peak)

             A               An array reference that can be used to determine the
                               probability that the base in position $i is an "A".

             G               An array reference that can be used to determine the
                               probability that the base in position $i is a "G".

             C               An array reference that can be used to determine the
                               probability that the base in position $i is a "C".

             T               An array reference that can be used to determine the
                               probability that the base in position $i is a "T".

             samples         A hash reference with keys "A", "C", "G" and "T". The
                               value of each hash is an array reference to the list
                               of intensity values for each sample.

           To get the length of the called sequence:              $scf{bases_length}

           To get the value of the called sequence at position 3: $scf{bases}[3]

           To get the sample position at which base 3 was called: $scf{index}[3]

           To get the value of the "C" curve under base 3:        $scf{samples}{C}[$scf{index}[3]]

           To get the probability that base 3 is a "C":           $scf{C}[3]

           To print out the chromatogram as a four-column list:

               my $samples = $scf{samples};
               for (my $i = 0; $i&lt;$scf{samples_length}; $i++) {
                  print join "\t",$samples-&gt;{C}[$i],$samples-&gt;{G}[$i],
                                  $samples-&gt;{A}[$i],$samples-&gt;{T}[$i],"\n";
               }

       $scf{bases}[$index] = $new_value
           The  base  call  probability scores, base call values, base call positions, and sample values are all
           read/write, so that you can change them:

              $samples-&gt;{C}[500] = 0;

       each %scf
           Will return keys and values for the tied object.

       delete $scf{$key}
       %scf = ()
           These operations are not supported and will return a run-time error

   <b>Object</b> <b>Methods</b>
       $scf = Bio::SCF-&gt;new($scf_file_or_filehandle)
           Create a new Bio::SCF object. The single argument is the  name  of  a  file  or  a  previously-opened
           filehandle. If successful, <b>new()</b> returns the Bio::SCF object.

       $length = $scf-&gt;bases_length
           Return the length of the called sequence.

       $samples = $scf-&gt;samples_length
           Return  the length of the list of chromatogram samples in the file. There are four sample series, one
           for each base.

       $sample_size = $scf-&gt;sample_size
           Returns the size of each sample (bytes).

       $code_set = $scf-&gt;code_set
           Return the code set used for base calling.

       $base = $scf-&gt;base($base_no [,$new_base])
           Get the base call at the indicated position. If a new value is provided, will change the base call to
           the indicated base.

       $index = $scf-&gt;index($base_no [,$new_index])
           Translates the indicated base position into the sample index for that called base.  Here  is  how  to
           fetch the intensity values at base number 5:

             my $sample_index = $scf-&gt;<a href="../man5/index.5.html">index</a>(5);
             my ($g,$a,$t,$c) = map { $scf-&gt;sample($_,$sample_index) } qw(G A T C);

           If you provide a new value for the sample index, it will be updated.

       $base_score = $scf-&gt;base_score($base,$base_no [,$new_score])
           Get  the  probability  that  the indicated base occurs at position $base_no. Here is how to fetch the
           probabilities for the four bases at base position 5:

             my ($g,$a,$t,$c) = map { $scf-&gt;base_score($_,5) } qw(G A T C);

           If you provide a new value for the base probability score, it will be updated.

       $score = $scf-&gt;score($base_no)
           Get the quality score for the called base at the indicated position.

       $intensity = $scf-&gt;sample($base,$sample_index [,$new_value])
           Get the intensity value for the channel corresponding to the indicated base at the  indicated  sample
           index. You may update the intensity by providing a new value.

       $scf-&gt;write('file_path')
           Write the updated SCF file to the indicated file path.

       $scf-&gt;fwrite($file_handle)
           Write the updated SCF file to the indicated filehandle. The file must previously have been opened for
           writing.  The filehandle is actually reopened in append mode, so you can call <b>fwrite()</b> multiple times
           and interperse your own record separators.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Reading information from a preexisting file:

          tie %scf, 'Bio::SCF', "data.scf";
          print "Base calls:\n";
          for ( my $i=0; $i&lt;$scf{bases}; $i++ ){
             print "$scf{base}[$i] ";
          }
          print "\n";

          print "Intensity values for the A curve\n";
          for ( my $i=0; $i&lt;$scf{samples}; $i++ ){
             print "$scf{sample}{A}[$i];
          }
          print "\n";

       Another example, where we set all bases to "A", indexes to 10 and write the file back:

          my $obj = tie %scf,'Bio::SCF','data.scf';
          for (0...@{$scf{bases}}-1){
             $scf{base}[$_] = "A";
             $obj-&gt;set('index', $_, 10);
          }
          $obj-&gt;write('data.scf');

</pre><h4><b>AUTHOR</b></h4><pre>
       Dmitri Priimak, <a href="mailto:priimak@cshl.org">priimak@cshl.org</a> (1999)

       with some cleanups by Lincoln Stein, <a href="mailto:lstein@cshl.edu">lstein@cshl.edu</a> (2006)

       This package and its accompanying libraries is free software; you can redistribute it  and/or  modify  it
       under  the  terms  of  the  GPL  (either version 1, or at your option, any later version) or the Artistic
       License 2.0.  Refer to LICENSE for the  full  license  text.  In  addition,  please  see  DISCLAIMER  for
       disclaimers of warranty.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/perl.1.html">perl</a></b>(1).

perl v5.40.0                                       2024-10-20                                           <u><a href="../man3pm/SCF.3pm.html">SCF</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>