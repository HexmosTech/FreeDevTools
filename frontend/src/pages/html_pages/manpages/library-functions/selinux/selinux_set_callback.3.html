<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>selinux_set_callback - userspace SELinux callback facilities</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libselinux1-dev">libselinux1-dev_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       selinux_set_callback - userspace SELinux callback facilities

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/selinux.h&gt;</b>

       <b>void</b> <b>selinux_set_callback(int</b> <u>type</u><b>,</b> <b>union</b> <b>selinux_callback</b> <u>callback</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>selinux_set_callback</b>()  sets  the  callback  indicated  by <u>type</u> to the value of <u>callback</u>, which should be
       passed as a function pointer cast to type <b>union</b> <b>selinux_callback</b>.

       All callback functions should return a negative value with <u>errno</u> set appropriately on error.

       The available values for <u>type</u> are:

       <b>SELINUX_CB_LOG</b>
              <b>int</b> <b>(*</b><u>func_log</u><b>)</b> <b>(int</b> <u>type</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>fmt</u><b>,</b> <b>...);</b>

              This callback is used for logging and should process the <b><a href="../man3/printf.3.html">printf</a></b>(3) style <u>fmt</u> string and  arguments
              as  appropriate.   The  <u>type</u>  argument indicates the type of message and will be set to one of the
              following:

              <b>SELINUX_ERROR</b>

              <b>SELINUX_WARNING</b>

              <b>SELINUX_INFO</b>

              <b>SELINUX_AVC</b>

              <b>SELINUX_POLICYLOAD</b>

              <b>SELINUX_SETENFORCE</b>

              SELINUX_ERROR, SELINUX_WARNING, and SELINUX_INFO indicate standard log severity levels and are not
              auditable messages.

              The SELINUX_AVC, SELINUX_POLICYLOAD, and SELINUX_SETENFORCE message  types  can  be  audited  with
              AUDIT_USER_AVC,   AUDIT_USER_MAC_POLICY_LOAD,  and  AUDIT_USER_MAC_STATUS  values  from  libaudit,
              respectively.   If  they  are  not  audited,  SELINUX_AVC  should  be  considered  equivalent   to
              SELINUX_ERROR;   similarly,   SELINUX_POLICYLOAD   and  SELINUX_SETENFORCE  should  be  considered
              equivalent to SELINUX_INFO.

       <b>SELINUX_CB_AUDIT</b>
              <b>int</b> <b>(*</b><u>func_audit</u><b>)</b> <b>(void</b> <b>*</b><u>auditdata</u><b>,</b> <b>security_class_t</b> <u>cls</u><b>,</b>
                                 <b>char</b> <b>*</b><u>msgbuf</u><b>,</b> <b>size_t</b> <u>msgbufsize</u><b>);</b>

              This callback is used for supplemental auditing in AVC messages.  The <u>auditdata</u> and <u>cls</u>  arguments
              are  the  values  passed to <b><a href="../man3/avc_has_perm.3.html">avc_has_perm</a></b>(3).  A human-readable interpretation should be printed to
              <u>msgbuf</u> using no more than <u>msgbufsize</u> characters.

       <b>SELINUX_CB_VALIDATE</b>
              <b>int</b> <b>(*</b><u>func_validate</u><b>)</b> <b>(char</b> <b>**</b><u>ctx</u><b>);</b>

              This callback is used for context validation.   The  callback  may  optionally  modify  the  input
              context  by  setting  the target of the <u>ctx</u> pointer to a new context.  In this case, the old value
              should be freed with <b><a href="../man3/freecon.3.html">freecon</a></b>(3).  The value of <u>errno</u> should  be  set  to  <b>EINVAL</b>  to  indicate  an
              invalid context.

       <b>SELINUX_CB_SETENFORCE</b>
              <b>int</b> <b>(*</b><u>func_setenforce</u><b>)</b> <b>(int</b> <u>enforcing</u><b>);</b>

              This  callback  is  invoked  when  the  system  enforcing  state  changes.  The <u>enforcing</u> argument
              indicates the new value and is set to <u>1</u> for enforcing mode, and <u>0</u> for permissive mode.

       <b>SELINUX_CB_POLICYLOAD</b>
              <b>int</b> <b>(*</b><u>func_policyload</u><b>)</b> <b>(int</b> <u>seqno</u><b>);</b>

              This callback is invoked when the system security policy is reloaded.  The <u>seqno</u> argument  is  the
              current sequential number of the policy generation in the system.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       None.

</pre><h4><b>ERRORS</b></h4><pre>
       None.

</pre><h4><b>AUTHOR</b></h4><pre>
       Eamon Walsh &lt;<a href="mailto:ewalsh@tycho.nsa.gov">ewalsh@tycho.nsa.gov</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3), <b><a href="../man3/avc_init.3.html">avc_init</a></b>(3), <b><a href="../man3/avc_netlink_open.3.html">avc_netlink_open</a></b>(3), <b><a href="../man8/selinux.8.html">selinux</a></b>(8)

                                                   20 Jun 2007                           <u><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>