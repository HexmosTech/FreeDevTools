<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>security_compute_av,  security_compute_av_flags,  security_compute_create,  security_compute_create_name,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libselinux1-dev">libselinux1-dev_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       security_compute_av,  security_compute_av_flags,  security_compute_create,  security_compute_create_name,
       security_compute_relabel,   security_compute_member,    security_compute_user,    security_validatetrans,
       security_get_initial_context - query the SELinux policy database in the kernel

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/selinux.h&gt;</b>

       <b>int</b>  <b>security_compute_av(const</b>  <b>char</b>  <b>*</b><u>scon</u><b>,</b>  <b>const</b>  <b>char</b> <b>*</b><u>tcon</u><b>,</b> <b>security_class_t</b> <u>tclass</u><b>,</b> <b>access_vector_t</b>
       <u>requested</u><b>,</b> <b>struct</b> <b>av_decision</b> <b>*</b><u>avd</u><b>);</b>

       <b>int</b> <b>security_compute_av_raw(const</b> <b>char</b> <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>tcon</u><b>,</b> <b>security_class_t</b> <u>tclass</u><b>,</b>  <b>access_vector_t</b>
       <u>requested</u><b>,</b> <b>struct</b> <b>av_decision</b> <b>*</b><u>avd</u><b>);</b>

       <b>int</b>   <b>security_compute_av_flags(const</b>   <b>char</b>   <b>*</b><u>scon</u><b>,</b>   <b>const</b>   <b>char</b>   <b>*</b><u>tcon</u><b>,</b>   <b>security_class_t</b>  <u>tclass</u><b>,</b>
       <b>access_vector_t</b> <u>requested</u><b>,</b> <b>struct</b> <b>av_decision</b> <b>*</b><u>avd</u><b>);</b>

       <b>int</b>  <b>security_compute_av_flags_raw(const</b>  <b>char</b>  <b>*</b><u>scon</u><b>,</b>  <b>const</b>  <b>char</b>   <b>*</b><u>tcon</u><b>,</b>   <b>security_class_t</b>   <u>tclass</u><b>,</b>
       <b>access_vector_t</b> <u>requested</u><b>,</b> <b>struct</b> <b>av_decision</b> <b>*</b><u>avd</u><b>);</b>

       <b>int</b> <b>security_compute_create(const</b> <b>char</b> <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>tcon</u><b>,</b> <b>security_class_t</b> <u>tclass</u><b>,</b> <b>char</b> <b>**</b><u>newcon</u><b>);</b>

       <b>int</b>  <b>security_compute_create_raw(const</b>  <b>char</b>  <b>*</b><u>scon</u><b>,</b>  <b>const</b>  <b>char</b>  <b>*</b><u>tcon</u><b>,</b>  <b>security_class_t</b>  <u>tclass</u><b>,</b> <b>char</b>
       <b>**</b><u>newcon</u><b>);</b>

       <b>int</b> <b>security_compute_create_name(const</b> <b>char</b> <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>tcon</u><b>,</b> <b>security_class_t</b> <u>tclass</u><b>,</b> <b>const</b>  <b>char</b>
       <b>*</b><u>objname</u><b>,</b> <b>char</b> <b>**</b><u>newcon</u><b>);</b>

       <b>int</b>  <b>security_compute_create_name_raw(const</b>  <b>char</b> <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>tcon</u><b>,</b> <b>security_class_t</b> <u>tclass</u><b>,</b> <b>const</b>
       <b>char</b> <b>*</b><u>objname</u><b>,</b> <b>char</b> <b>**</b><u>newcon</u><b>);</b>

       <b>int</b> <b>security_compute_relabel(const</b> <b>char</b> <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>tcon</u><b>,</b> <b>security_class_t</b> <u>tclass</u><b>,</b> <b>char</b> <b>**</b><u>newcon</u><b>);</b>

       <b>int</b> <b>security_compute_relabel_raw(const</b> <b>char</b>  <b>*</b><u>scon</u><b>,</b>  <b>const</b>  <b>char</b>  <b>*</b><u>tcon</u><b>,</b>  <b>security_class_t</b>  <u>tclass</u><b>,</b>  <b>char</b>
       <b>**</b><u>newcon</u><b>);</b>

       <b>int</b> <b>security_compute_member(const</b> <b>char</b> <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>tcon</u><b>,</b> <b>security_class_t</b> <u>tclass</u><b>,</b> <b>char</b> <b>**</b><u>newcon</u><b>);</b>

       <b>int</b>  <b>security_compute_member_raw(const</b>  <b>char</b>  <b>*</b><u>scon</u><b>,</b>  <b>const</b>  <b>char</b>  <b>*</b><u>tcon</u><b>,</b>  <b>security_class_t</b>  <u>tclass</u><b>,</b> <b>char</b>
       <b>**</b><u>newcon</u><b>);</b>

       <b>int</b> <b>security_compute_user(const</b> <b>char</b> <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>username</u><b>,</b> <b>char</b> <b>***</b><u>con</u><b>);</b>

       <b>int</b> <b>security_compute_user_raw(const</b> <b>char</b> <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>username</u><b>,</b> <b>char</b> <b>***</b><u>con</u><b>);</b>

       <b>int</b> <b>security_validatetrans(const</b> <b>char</b> <b>*</b><u>scon</u><b>,</b>  <b>const</b>  <b>char</b>  <b>*</b><u>tcon</u><b>,</b>  <b>security_class_t</b>  <u>tclass</u><b>,</b>  <b>const</b>  <b>char</b>
       <b>*</b><u>newcon</u><b>);</b>

       <b>int</b>  <b>security_validatetrans_raw(const</b>  <b>char</b>  <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>tcon</u><b>,</b> <b>security_class_t</b> <u>tclass</u><b>,</b> <b>const</b> <b>char</b>
       <b>*</b><u>newcon</u><b>);</b>

       <b>int</b> <b>security_get_initial_context(const</b> <b>char</b> <b>*</b><u>name</u><b>,</b> <b>char</b> <b>**</b><u>con</u><b>);</b>

       <b>int</b> <b>security_get_initial_context_raw(const</b> <b>char</b> <b>*</b><u>name</u><b>,</b> <b>char</b> <b>**</b><u>con</u><b>);</b>

       <b>int</b> <b>selinux_check_access(const</b> <b>char</b> <b>*</b><u>scon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>tcon</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>class</u><b>,</b> <b>const</b>  <b>char</b>  <b>*</b><u>perm</u><b>,</b>  <b>void</b>
       <b>*</b><u>auditdata);</u>

       <b>int</b> <b>selinux_check_passwd_access(access_vector_t</b> <u>requested</u><b>);</b>

       <b>int</b> <b>checkPasswdAccess(access_vector_t</b> <u>requested</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  family  of  functions  is  used  to obtain policy decisions from the SELinux kernel security server
       (policy engine).  In  general,  direct  use  of  <b>security_compute_av</b>()  and  its  variant  interfaces  is
       discouraged  in  favor of using <b>selinux_check_access</b>() since the latter automatically handles the dynamic
       mapping of class and permission names to their policy values, initialization and use of the Access Vector
       Cache (AVC), and proper handling of per-domain and global permissive mode and allow_unknown.

       When using any of the functions that take policy integer values for classes or permissions as inputs, use
       <b><a href="../man3/string_to_security_class.3.html">string_to_security_class</a>(3)</b> and <b><a href="../man3/string_to_av_perm.3.html">string_to_av_perm</a>(3)</b> to map the  class  and  permission  names  to  their
       policy  values.   These  values may change across a policy reload, so they should be re-acquired on every
       use or using a <b>SELINUX_CB_POLICYLOAD</b> callback set via <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a>(3).</b>

       An alternative approach is to use <b><a href="../man3/selinux_set_mapping.3.html">selinux_set_mapping</a>(3)</b> to create a mapping from  class  and  permission
       index  values  used by the application to the policy values, thereby allowing the application to pass its
       own fixed constants for the classes and permissions to these functions and  internally  mapping  them  on
       demand.  However, this also requires setting up a callback as above to address policy reloads.

       <b>security_compute_av</b>()  queries  whether  the  policy permits the source context <u>scon</u> to access the target
       context <u>tcon</u> via class <u>tclass</u> with the <u>requested</u> access vector.  The decision is returned in <u>avd</u>.

       <b>security_compute_av_flags</b>() is identical to <b>security_compute_av</b> but additionally sets the <u>flags</u> field  of
       <u>avd</u>.   Currently  one  flag  is  supported: <b>SELINUX_AVD_FLAGS_PERMISSIVE</b>, which indicates the decision is
       computed on a permissive domain.

       <b>security_compute_create</b>() is used to compute a context to use for labeling a new object in  a  particular
       class based on a SID pair.

       <b>security_compute_create_name</b>()  is  identical to <b>security_compute_create</b>() but also takes name of the new
       object in creation as an argument.  When <b>TYPE_TRANSITION</b> rule on the given  class  and  a  SID  pair  has
       object name extension, we shall be able to obtain a correct <u>newcon</u> according to the security policy. Note
       that this interface is only supported on the linux 2.6.40 or later.  In the older kernel, the object name
       will be simply ignored.

       <b>security_compute_relabel</b>()  is  used  to  compute the new context to use when relabeling an object, it is
       used in the pam_selinux.so source and the newrole source to determine the correct label for  the  tty  at
       login time, but can be used for other things.

       <b>security_compute_member</b>()  is  used to compute the context to use when labeling a polyinstantiated object
       instance.

       <b>security_compute_user</b>() is used to determine the set of user contexts that can be reached from  a  source
       context. This function is deprecated; use <b><a href="../man3/get_ordered_context_list.3.html">get_ordered_context_list</a></b>(3) instead.

       <b>security_validatetrans</b>()  is  used  to  determine  if  a transition from scon to newcon using tcon as the
       object is valid for object class tclass. This  checks  against  the  mlsvalidatetrans  and  validatetrans
       constraints in the loaded policy. Returns 0 if allowed, and -1 if an error occurred with errno set.

       <b>security_get_initial_context</b>()  is  used  to  get  the  context  of  a kernel initial security identifier
       specified by <u>name</u>

       <b>security_compute_av_raw</b>(),        <b>security_compute_av_flags_raw</b>(),         <b>security_compute_create_raw</b>(),
       <b>security_compute_create_name_raw</b>(),     <b>security_compute_relabel_raw</b>(),    <b>security_compute_member_raw</b>(),
       <b>security_compute_user_raw</b>() <b>security_validatetrans_raw</b>()  and  <b>security_get_initial_context_raw</b>()  behave
       identically to their non-raw counterparts but do not perform context translation.

       <b>selinux_check_access</b>() is used to check if the source context has the access permission for the specified
       class on the target context.

       <b>selinux_check_passwd_access</b>()   is   used   to   check   for   a   permission   in   the   <u>passwd</u>  class.
       <b>selinux_check_passwd_access</b>() uses <b><a href="../man3/getprevcon.3.html">getprevcon</a>(3)</b> for the source and target security contexts.

       <b>checkPasswdAccess</b>() is a deprecated alias of the <b>selinux_check_passwd_access</b>() function.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Returns zero on success or -1 on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/string_to_security_class.3.html">string_to_security_class</a></b>(3),   <b><a href="../man3/string_to_av_perm.3.html">string_to_av_perm</a></b>(3),   <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3),   <b><a href="../man3/selinux_set_mapping.3.html">selinux_set_mapping</a></b>(3),
       <b><a href="../man3/getprevcon.3.html">getprevcon</a></b>(3), <b><a href="../man3/get_ordered_context_list.3.html">get_ordered_context_list</a></b>(3), <b><a href="../man8/selinux.8.html">selinux</a></b>(8)

<a href="mailto:russell@coker.com.au">russell@coker.com.au</a>                             1 January 2004                           <u><a href="../man3/security_compute_av.3.html">security_compute_av</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>