<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>selabel_lookup_best_match  -  obtain  a  best  match  SELinux  security  context - Only supported on file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libselinux1-dev">libselinux1-dev_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       selabel_lookup_best_match  -  obtain  a  best  match  SELinux  security  context - Only supported on file
       backend.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/selinux.h&gt;</b>
       <b>#include</b> <b>&lt;selinux/label.h&gt;</b>

       <b>int</b> <b>selabel_lookup_best_match(struct</b> <b>selabel_handle</b> <b>*</b><u>hnd</u><b>,</b>
                                     <b>char</b> <b>**</b><u>context</u><b>,</b>
                                     <b>const</b> <b>char</b> <b>*</b><u>key</u><b>,</b>
                                     <b>const</b> <b>char</b> <b>**</b><u>links</u><b>,</b>
                                     <b>int</b> <u>type</u><b>);</b>

       <b>int</b> <b>selabel_lookup_best_match_raw(struct</b> <b>selabel_handle</b> <b>*</b><u>hnd</u><b>,</b>
                                         <b>char</b> <b>**</b><u>context</u><b>,</b>
                                         <b>const</b> <b>char</b> <b>*</b><u>key</u><b>,</b>
                                         <b>const</b> <b>char</b> <b>**</b><u>links</u><b>,</b>
                                         <b>int</b> <u>type</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>selabel_lookup_best_match</b>() performs a best match lookup operation  on  the  handle  <u>hnd</u>,  returning  the
       result  in the memory pointed to by <u>context</u>, which must be freed by the caller using <b><a href="../man3/freecon.3.html">freecon</a></b>(3).  The <u>key</u>
       parameter is a file path to check for best match using zero or more <u>link</u> (aliases) parameters. The  order
       of precedence for best match is:

              1.  An exact match for the real path (<u>key</u>) or

              2.  An exact match for any of the <u>link</u>s (aliases), or

              3.  The longest fixed prefix match.

       The  <u>type</u> parameter is an optional file <u>mode</u> argument that should be set to the mode bits of the file, as
       determined by <b><a href="../man2/lstat.2.html">lstat</a></b>(2).  <u>mode</u> may be zero, however full matching may not occur.

       <b>selabel_lookup_best_match_raw</b>() behaves identically to <b>selabel_lookup_best_match</b>() but does  not  perform
       context translation.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, zero is returned.  On error, -1 is returned and <u>errno</u> is set appropriately.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>ENOENT</b> No context corresponding to the input <u>key</u> and <u>type</u> was found.

       <b>EINVAL</b> The  <u>key</u>  and/or  <u>type</u>  inputs  are invalid, or the context being returned failed validation, or a
              regular expression in the database failed to compile.

       <b>ENOMEM</b> An attempt to allocate memory failed.

</pre><h4><b>NOTES</b></h4><pre>
       Example usage - When a service creates a device node, it may also create one  or  more  symlinks  to  the
       device  node.   These  symlinks  may  be  the  only  stable name for the device, e.g. if the partition is
       dynamically assigned.  The file label backend supports this by looking up the "best match" for  a  device
       node  based  on its real path (<u>key</u>) and any <u>link</u>s to it (aliases). The order of precedence for best match
       is described above.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3), <b><a href="../man3/selabel_stats.3.html">selabel_stats</a></b>(3), <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3), <b><a href="../man8/selinux.8.html">selinux</a></b>(8), <b><a href="../man2/lstat.2.html">lstat</a></b>(2), <b><a href="../man5/selabel_file.5.html">selabel_file</a></b>(5)

Security Enhanced Linux                            05 May 2015                      <u><a href="../man3/selabel_lookup_best_match.3.html">selabel_lookup_best_match</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>