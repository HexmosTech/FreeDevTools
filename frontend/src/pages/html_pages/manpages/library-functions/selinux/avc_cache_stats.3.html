<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>avc_cache_stats, avc_av_stats, avc_sid_stats - obtain userspace SELinux AVC statistics</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libselinux1-dev">libselinux1-dev_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       avc_cache_stats, avc_av_stats, avc_sid_stats - obtain userspace SELinux AVC statistics

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/selinux.h&gt;</b>
       <b>#include</b> <b>&lt;selinux/avc.h&gt;</b>

       <b>void</b> <b>avc_av_stats(void);</b>

       <b>void</b> <b>avc_sid_stats(void);</b>

       <b>void</b> <b>avc_cache_stats(struct</b> <b>avc_cache_stats</b> <b>*</b><u>stats</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  userspace AVC maintains two internal hash tables, one to store security ID's and one to cache access
       decisions.

       <b>avc_av_stats</b>() and <b>avc_sid_stats</b>() produce log messages indicating the status of the access decision  and
       SID  tables,  respectively.   The  messages  contain  the  number of entries in the table, number of hash
       buckets and number of buckets used, and maximum number of entries in a single bucket.

       <b>avc_cache_stats</b>() populates a structure whose fields reflect cache activity:

              struct avc_cache_stats {
                  unsigned  entry_lookups;
                  unsigned  entry_hits;
                  unsigned  entry_misses;
                  unsigned  entry_discards;
                  unsigned  cav_lookups;
                  unsigned  cav_hits;
                  unsigned  cav_probes;
                  unsigned  cav_misses;
              };

       <u>entry_lookups</u>
              Number of queries made.

       <u>entry_hits</u>
              Number of times a decision was found in the <u>aeref</u> argument.

       <u>entry_misses</u>
              Number of times a decision was not found in the <u>aeref</u> argument.

       <u>entry_discards</u>
              Number of times a decision was not found in the <u>aeref</u> argument and the  <u>aeref</u>  argument  was  non-
              NULL.

       <u>cav_lookups</u>
              Number of cache lookups.

       <u>cav_hits</u>
              Number of cache hits.

       <u>cav_misses</u>
              Number of cache misses.

       <u>cav_probes</u>
              Number of entries examined while searching the cache.

</pre><h4><b>NOTES</b></h4><pre>
       When  the  cache  is  flushed  as  a result of a call to <b>avc_reset</b>() or a policy change notification, the
       statistics returned by <b>avc_cache_stats</b>() are reset to zero.  The SID table, however, is left unchanged.

       When a policy change notification is received, a call to <b>avc_av_stats</b>()  is  made  before  the  cache  is
       flushed.

</pre><h4><b>AUTHOR</b></h4><pre>
       Eamon Walsh &lt;<a href="mailto:ewalsh@tycho.nsa.gov">ewalsh@tycho.nsa.gov</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/avc_init.3.html">avc_init</a></b>(3), <b><a href="../man3/avc_has_perm.3.html">avc_has_perm</a></b>(3), <b><a href="../man3/avc_context_to_sid.3.html">avc_context_to_sid</a></b>(3), <b><a href="../man3/avc_add_callback.3.html">avc_add_callback</a></b>(3), <b><a href="../man8/selinux.8.html">selinux</a></b>(8)

                                                   27 May 2004                                <u><a href="../man3/avc_cache_stats.3.html">avc_cache_stats</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>