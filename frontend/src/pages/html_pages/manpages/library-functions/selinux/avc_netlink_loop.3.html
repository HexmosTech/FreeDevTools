<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>avc_netlink_open,        avc_netlink_close,        avc_netlink_acquire_fd,        avc_netlink_release_fd,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libselinux1-dev">libselinux1-dev_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       avc_netlink_open,        avc_netlink_close,        avc_netlink_acquire_fd,        avc_netlink_release_fd,
       avc_netlink_check_nb, avc_netlink_loop - SELinux netlink processing

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/selinux.h&gt;</b>
       <b>#include</b> <b>&lt;selinux/avc.h&gt;</b>

       <b>int</b> <b>avc_netlink_open(int</b> <u>blocking</u><b>);</b>

       <b>void</b> <b>avc_netlink_close(void);</b>

       <b>int</b> <b>avc_netlink_acquire_fd(void);</b>

       <b>void</b> <b>avc_netlink_release_fd(void);</b>

       <b>void</b> <b>avc_netlink_loop(void);</b>

       <b>int</b> <b>avc_netlink_check_nb(void);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These functions enable applications to handle notification of SELinux events via netlink.  The  userspace
       AVC  normally  checks  for  netlink  messages  on each call to <b><a href="../man3/avc_has_perm.3.html">avc_has_perm</a></b>(3).  Applications may wish to
       override this behavior and check for notification separately, for example in  a  <b><a href="../man2/select.2.html">select</a></b>(2)  loop.   These
       functions also permit netlink monitoring without requiring a call to <b><a href="../man3/avc_open.3.html">avc_open</a></b>(3).

       <b>avc_netlink_open</b>()  opens  a  netlink  socket to receive SELinux notifications.  The socket descriptor is
       stored internally; use <b><a href="../man3/avc_netlink_acquire_fd.3.html">avc_netlink_acquire_fd</a></b>(3) to take  ownership  of  it  in  application  code.   The
       <u>blocking</u>  argument  controls  whether  the  O_NONBLOCK flag is set on the socket descriptor.  <b><a href="../man3/avc_open.3.html">avc_open</a></b>(3)
       calls this function internally, specifying non-blocking behavior.

       <b>avc_netlink_close</b>() closes the netlink socket.  This function is called automatically by <b><a href="../man3/avc_destroy.3.html">avc_destroy</a></b>(3).

       <b>avc_netlink_acquire_fd</b>() returns the netlink socket descriptor number and informs the userspace  AVC  not
       to  check  the socket descriptor automatically on calls to <b><a href="../man3/avc_has_perm.3.html">avc_has_perm</a></b>(3).  If no such socket descriptor
       exists, <b><a href="../man3/avc_netlink_acquire_fd.3.html">avc_netlink_acquire_fd</a></b>(3) will first call <b><a href="../man3/avc_netlink_open.3.html">avc_netlink_open</a></b>(3) and then return the resulting fd.

       <b>avc_netlink_release_fd</b>() returns control  of  the  netlink  socket  to  the  userspace  AVC,  re-enabling
       automatic processing of notifications.

       <b>avc_netlink_check_nb</b>()  checks the netlink socket for pending messages and processes them.  Callbacks for
       policyload and enforcing changes will be called; see <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3).   This  function  does  not
       block.

       <b>avc_netlink_loop</b>()  enters  a  loop  blocking  on  the netlink socket and processing messages as they are
       received.  This function will not return unless an error occurs on the socket, in which case  the  socket
       is closed.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>avc_netlink_acquire_fd</b>()  returns a non-negative file descriptor number on success.  Other functions with
       a return value return zero on success.  On error, -1 is returned and <u>errno</u> is set appropriately.

</pre><h4><b>AUTHOR</b></h4><pre>
       Originally KaiGai Kohei. Updated by Mike Palmiotto &lt;<a href="mailto:mike.palmiotto@crunchydata.com">mike.palmiotto@crunchydata.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/avc_open.3.html">avc_open</a></b>(3), <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3), <b><a href="../man8/selinux.8.html">selinux</a></b>(8)

                                                   30 Mar 2009                               <u><a href="../man3/avc_netlink_loop.3.html">avc_netlink_loop</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>