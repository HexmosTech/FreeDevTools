<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio::Tools::Run::Phylo::Phylip::Neighbor - Wrapper for the phylip program neighbor by Joseph Felsenstein</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/libbio-perl-run-perl">libbio-perl-run-perl_1.7.3-8_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Bio::Tools::Run::Phylo::Phylip::Neighbor - Wrapper for the phylip program neighbor by Joseph Felsenstein
       for creating a phylogenetic tree(either through Neighbor or UPGMA) based on protein distances based on
       amino substitution rate.

       14 Nov 2002 Shawn Works with Phylip version 3.6

</pre><h4><b>SYNOPSIS</b></h4><pre>
         #Create a SimpleAlign object
         @params = ('ktuple' =&gt; 2, 'matrix' =&gt; 'BLOSUM');
         $factory = Bio::Tools::Run::Alignment::Clustalw-&gt;new(@params);
         $inputfilename = 't/data/cysprot.fa';
         $aln = $factory-&gt;run($inputfilename); # $aln is a SimpleAlign object.

         # Create the Distance Matrix
         # using a default PAM matrix and id name lengths limit of 30 note to
         # use id name length greater than the standard 10 in neighbor, you
         # will need to modify the neighbor source code

         $protdist_factory = Bio::Tools::Run::Phylo::Phylip::ProtDist-&gt;new(@params);
         my $matrix  = $protdist_factory-&gt;run($aln);

         #Create the tree passing in the distance matrix
         @params = ('type'=&gt;'NJ','outgroup'=&gt;2,'lowtri'=&gt;1,
                    'upptri'=&gt;1,'subrep'=&gt;1);

         my $neighbor_factory =
            Bio::Tools::Run::Phylo::Phylip::Neighbor-&gt;new(@params);

         #you can set your outgroup using either a number specifying
         #the rank in the matrix or you can just use the name of the
         #species

         $neighbor_factory-&gt;outgroup('ENSP00001');
         #or
         $neighbor_factory-&gt;<a href="../man1/outgroup.1.html">outgroup</a>(1);

         my ($tree) = $neighbor_factory-&gt;run($matrix);

         # Alternatively, one can create the tree by passing in a file name
         # containing a phylip formatted distance matrix(using protdist)
         my $neighbor_factory =
           Bio::Tools::Run::Phylo::Phylip::Neighbor-&gt;new(@params);
         my ($tree) = $neighbor_factory-&gt;run('/home/shawnh/prot.dist');

         # To prevent PHYLIP from truncating sequence names:
         # Step 1. Shelf the original names:
           my ($aln_safe, $ref_name)=                    #   $aln_safe has serial names
                      $aln-&gt;set_displayname_safe();      #   $ref_name holds original names
         # Step 2. Run ProtDist and Neighbor:
           $matrix  = $protdist_factory-&gt;
                       creat_distance_matrix($aln_safe); #  Use $aln_safe instead of $aln
           $tree = $neighbor_factory-&gt;run($matrix);
         # Step 3. Retrieve orgininal OTU names:
           use Bio::Tree::Tree;
           my @nodes=$tree-&gt;get_nodes();
           foreach my $nd (@nodes){
              $nd-&gt;id($ref_name-&gt;{$nd-&gt;id_output}) if $nd-&gt;is_Leaf;
           }

</pre><h4><b>PARAMTERS</b> <b>FOR</b> <b>NEIGHBOR</b> <b>COMPUTATION</b></h4><pre>
   <b>TYPE</b>
         Title         : TYPE
         Description   : (optional)
                         This sets the type of tree to construct, using
                         neighbor joining or UPGMA.

                         NJ    Neighbor Joining
                         UPGMA UPGMA

         Usage         : @params = ('type'=&gt;'X');#where X is one of the values above
                         Defaults to NJ

                         For more information on the usage of the different
                         models, please refer to the documentation found in
                         the phylip package.

   <b>OUTGROUP</b> <b>(*ONLY</b> <b>AVAILABLE</b> <b>FOR</b> <b>NEIGHBOR</b> <b>JOINING)</b>
         Title         : OUTGROUP
         Description   : (optional)
                         This option selects the species to be used as the outgroup
         Acceptable Values: integer
         Usage         : @params = ('outgroup'=&gt;'X');
                         where X is an positive integer not more than the
                         number of sequences
                         Defaults to 1

   <b>LOWTRI</b>
         Title         : LOWTRI
         Description   : (optional)
                         This indicates that the distance matrix is
                         input  in  Lower-triangular form  (the  lower-left
                         half of the distance matrix only, without the zero
                         diagonal elements)
         Usage         : @params = ('lowtri'=&gt;'X'); where X is either 1 or 0
                         Defaults to 0

   <b>UPPTRI</b>
         Title         : UPPTRI
         Description   : (optional)
                         This indicates that the distance matrix is input  in
                         upper-triangular form  (the  upper-right half of the
                         distance matrix only, without the zero diagonal elements.)
       Usage           : @params = ('upptri'=&gt;'X'); where X is either 1 or 0
                         Defaults to 0

   <b>SUBREP</b>
         Title         : SUBREP
         Description   : (optional)
                         This is the Subreplication option.

                         It informs the program that after each distance will
                         be provided an integer indicating that the distance
                         is a mean of that many replicates.

         Usage         : @params = ('subrep'=&gt;'X'); where X is either 1 or 0
                         Defaults to 0

   <b>JUMBLE</b>
         Title        : JUMBLE
         Description  : (optional)

                        This enables you to tell the program to use a random
                        number generator to choose the input order of
                        species.  seed: an integer between 1 and 32767 and of
                        the form 4n+1 which means that it must give a
                        remainder of 1 when divided by 4.  Each different
                        seed leads to a different sequence of addition of
                        species.  By simply changing the random number seed
                        and re-running programs one can look for other, and
                        better trees.  iterations:

         Usage        : @params = ('jumble'=&gt;'17); where 17 is the random seed
                        Defaults to no jumble

</pre><h4><b>FEEDBACK</b></h4><pre>
   <b>Mailing</b> <b>Lists</b>
       User feedback is an integral part of the evolution of this and other Bioperl modules. Send your comments
       and suggestions preferably to one of the Bioperl mailing lists.  Your participation is much appreciated.

         <a href="mailto:bioperl-l@bioperl.org">bioperl-l@bioperl.org</a>                  - General discussion
         <a href="http://bioperl.org/wiki/Mailing_lists">http://bioperl.org/wiki/Mailing_lists</a>  - About the mailing lists

   <b>Support</b>
       Please direct usage questions or support issues to the mailing list:

       <u><a href="mailto:bioperl-l@bioperl.org">bioperl-l@bioperl.org</a></u>

       rather than to the module maintainer directly. Many experienced and reponsive experts will be able look
       at the problem and quickly address it. Please include a thorough description of the problem with code and
       data examples if at all possible.

   <b>Reporting</b> <b>Bugs</b>
       Report bugs to the Bioperl bug tracking system to help us keep track the bugs and their resolution.  Bug
       reports can be submitted via the web:

         <a href="http://redmine.open-bio.org/projects/bioperl/">http://redmine.open-bio.org/projects/bioperl/</a>

</pre><h4><b>AUTHOR</b> <b>-</b> <b>Shawn</b> <b>Hoon</b></h4><pre>
       Email <a href="mailto:shawnh@fugu-sg.org">shawnh@fugu-sg.org</a>

</pre><h4><b>CONTRIBUTORS</b></h4><pre>
       Email:jason-at-bioperl.org

</pre><h4><b>APPENDIX</b></h4><pre>
       The rest of the documentation details each of the object methods. Internal methods are usually preceded
       with a _

   <b>program_name</b>
        Title   : program_name
        Usage   : &gt;program_name()
        Function: holds the program name
        Returns:  string
        Args    : None

   <b>program_dir</b>
        Title   : program_dir
        Usage   : -&gt;program_dir()
        Function: returns the program directory, obtained from ENV variable.
        Returns:  string
        Args    :

   <b>idlength</b>
        Title   : idlength
        Usage   : $obj-&gt;idlength ($newval)
        Function:
        Returns : value of idlength
        Args    : newvalue (optional)

   <b>run</b>
        Title   : run
        Usage   :
               $inputfilename = 't/data/prot.dist';
               $tree = $neighborfactory-&gt;run($inputfilename);
        or
               $protdist_factory = Bio::Tools::Run::Phylo::Phylip::ProtDist-&gt;new(@params);
               $matrix  = $protdist_factory-&gt;create_distance_matrix($aln);
               $tree= $neighborfactory-&gt;run($matrix);

        Function: a Bio:Tree from a protein distance matrix created by protidst
        Example :
        Returns : Bio::Tree
        Args    : Name of a file containing a protein distance matrix in Phylip format
                  or a hash ref to a matrix

        Throws an exception if argument is not either a string (eg a
        filename) or a Hash. If argument is string, throws exception
        if file corresponding to string name can not be found.

   <b>create_tree</b>
        Title   : create_tree
        Usage   : my $file = $app-&gt;create_tree($treefile);
        Function: This method is deprecated. Please use run method.
        Returns : File containing the rendered tree
        Args    : either a Bio::Tree::TreeI
                   OR
                  filename of a tree in newick format

   <b>_run</b>
        Title   :  _run
        Usage   :  Internal function, not to be called directly
        Function:   makes actual system call to neighbor program
        Example :
        Returns : Bio::Tree object
        Args    : Name of a file containing protein distances in Phylip format
                  and a parameter string to be passed to neighbor

   <b>_setinput()</b>
        Title   : _setinput
        Usage   : Internal function, not to be called directly
        Function: Create input file for neighbor program
        Example :
        Returns : name of file containing the protein distance matrix in Phylip format
        Args    : name of file created by protdist or ref to hash created by
                  Bio::Tools:Run::Phylo::Phylip::ProtDist

   <b>names()</b>
        Title   :  names
        Usage   :  $tree-&gt;names(\%names)
        Function:  get/set for a hash ref for storing names in matrix
                   with rank as values.
        Example :
        Returns : hash reference
        Args    : hash reference

   <b>_setparams()</b>
        Title   :  _setparams
        Usage   :  Internal function, not to be called directly
        Function:   Create parameter inputs for neighbor program
        Example :
        Returns : parameter string to be passed to neighbor
        Args    : name of calling object

   <b>outfile</b>
        Title   : outfile
        Usage   : $obj-&gt;outfile($newval)
        Function: Get/Set default PHYLIP outfile name ('outfile' usually)
        Returns : value of outfile
        Args    : newvalue (optional)

   <b>treefile</b>
        Title   : treefile
        Usage   : $obj-&gt;treefile($newval)
        Function: Get/Set the default PHYLIP treefile name ('treefile' usually)
        Returns : value of treefile
        Args    : newvalue (optional)

perl v5.34.0                                       2022-02-10             <u>Bio::Tools::Run...hylip::<a href="../man3pm/Neighbor.3pm.html">Neighbor</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>