<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plack::Middleware::AccessLog - Logs requests like Apache's log format</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libplack-perl">libplack-perl_1.0051-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Plack::Middleware::AccessLog - Logs requests like Apache's log format

</pre><h4><b>SYNOPSIS</b></h4><pre>
         # in app.psgi
         use Plack::Builder;

         builder {
             enable "Plack::Middleware::AccessLog", format =&gt; "combined";
             $app;
         };

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Plack::Middleware::AccessLog forwards the request to the given app and logs request and response details
       to the logger callback. The format can be specified using Apache-like format strings (or "combined" or
       "common" for the default formats). If none is specified "combined" is used.

       This middleware uses calculable Content-Length by checking body type, and cannot log the time taken to
       serve requests. It also logs the request <b>before</b> the response is actually sent to the client. Use
       Plack::Middleware::AccessLog::Timed if you want to log details <b>after</b> the response is transmitted (more
       like a real web server) to the client.

       This middleware is enabled by default when you run plackup as a default "development" environment.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       format
             enable "Plack::Middleware::AccessLog",
                 format =&gt; '%h %l %u %t "%r" %&gt;s %b "%{Referer}i" "%{User-agent}i"';

           Takes  a  format string (or a preset template "combined" or "custom") to specify the log format. This
           middleware uses Apache::LogFormat::Compiler to generate access_log lines. See more details on perldoc
           Apache::LogFormat::Compiler

              %%    a percent sign
              %h    REMOTE_ADDR from the PSGI environment, or -
              %l    remote logname not implemented (currently always -)
              %u    REMOTE_USER from the PSGI environment, or -
              %t    [local timestamp, in default format]
              %r    REQUEST_METHOD, REQUEST_URI and SERVER_PROTOCOL from the PSGI environment
              %s    the HTTP status code of the response
              %b    content length of the response
              %T    custom field for handling times in subclasses
              %D    custom field for handling sub-second times in subclasses
              %v    SERVER_NAME from the PSGI environment, or -
              %V    HTTP_HOST or SERVER_NAME from the PSGI environment, or -
              %p    SERVER_PORT from the PSGI environment
              %P    the worker's process id
              %m    REQUEST_METHOD from the PSGI environment
              %U    PATH_INFO from the PSGI environment
              %q    QUERY_STRING from the PSGI environment
              %H    SERVER_PROTOCOL from the PSGI environment

           Some of these format fields are only supported by middleware that subclasses "AccessLog".

           In addition, custom values can be referenced, using "%{name}", with one  of  the  mandatory  modifier
           flags "i", "o" or "t":

              %{variable-name}i    HTTP_VARIABLE_NAME value from the PSGI environment
              %{header-name}o      header-name header in the response
              %{time-format]t      localtime in the specified strftime format

       logger
             my $logger = Log::Dispatch-&gt;new(...);
             enable "Plack::Middleware::AccessLog",
                 logger =&gt; sub { $logger-&gt;log(level =&gt; 'debug', message =&gt; @_) };

           Sets a callback to print log message to. It prints to the "psgi.errors" output stream by default.

       char_handlers
             my $handlers = {
                 'z' =&gt; sub {
                     my ($env,$req) = @_;
                     return $env-&gt;{HTTP_X_FORWARDED_FOR};
                 }
             };

             enable "Plack::Middleware::AccessLog",
                 format =&gt; '%z %{HTTP_X_FORWARDED_FOR|REMOTE_ADDR}Z',
                 char_handlers =&gt; $handlers;

           Takes a hash reference and passes it to the underlying Apache::LogFormat::Compiler's "char_handlers".
           For more details see "ADD CUSTOM FORMAT STRING" in Apache::LogFormat::Compiler.

       block_handlers
             my $handlers = {
                 'Z' =&gt; sub {
                     my ($block,$env,$req) = @_;
                     # block eq 'HTTP_X_FORWARDED_FOR|REMOTE_ADDR'
                     my ($main, $alt) = split('\|', $args);
                     return exists $env-&gt;{$main} ? $env-&gt;{$main} : $env-&gt;{$alt};
                 }
             };

             enable "Plack::Middleware::AccessLog",
                 format =&gt; '%z %{HTTP_X_FORWARDED_FOR|REMOTE_ADDR}Z',
                 block_handlers =&gt; $handlers;

           Takes   a   hash   reference   and   passes   it   to  the  underlying  Apache::LogFormat::Compiler's
           "block_handlers".  For more details see "ADD CUSTOM FORMAT STRING" in Apache::LogFormat::Compiler.

</pre><h4><b>AUTHORS</b></h4><pre>
       Tatsuhiko Miyagawa

       Masahiro Nagano

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Apache::LogFormat::Compiler,                   &lt;<a href="http://httpd.apache.org/docs/2.2/mod/mod_log_config.html">http://httpd.apache.org/docs/2.2/mod/mod_log_config.html</a>&gt;
       Rack::CustomLogger

perl v5.38.2                                       2024-01-20                  <u>Plack::Middleware::<a href="../man3pm/AccessLog.3pm.html">AccessLog</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>