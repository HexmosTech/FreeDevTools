<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PQspecPrepare - Prepares a libpqtypes specifier format string.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/libpqtypes-dev">libpqtypes-dev_1.5.1-9.1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       PQspecPrepare - Prepares a libpqtypes specifier format string.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;libpqtypes.h&gt;</b>

       <b>int</b> <b>PQspecPrepare(PGconn</b> <b>*</b><u>conn</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>name</u><b>,</b>
                             <b>const</b> <b>char</b> <b>*</b><u>format</u><b>,</b> <b>int</b> <u>is_stmt</u><b>);</b>
       <b>void</b> <b>PQclearSpecs(PGconn</b> <b>*</b><u>conn</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       PQspecPrepare allows an application to prepare specifier format strings that will be used frequently.  By
       preparing  a specifier format string, one avoids the parsing and type handler lookup costs.  This becomes
       a significant win when managing large result sets or arrays, where  the  specifier  format,  like  "%int4
       %text %bytea", must be prepared for each tuple/element.

       As  with  PQregisterXXX,  only  specifier  format strings prepared prior to the creation of a PGresult or
       PGparam, will be available for use.  This is because the prepared type spec is  cached  within  a  PGconn
       object and copied to all subsequent PGparam and PGresult objects.

       Every prepared type spec is given a <u>name</u>, which is used as its unique identifier.  To use a prepared type
       spec,  the  <u>name</u>  is  provided  where  ever  a regular specifier format string is allowed, like PQputf or
       PQgetf.  The <u>name</u> must be proceeded by a ´@´ AT sign.  For more information about  the  syntax,  see  the
       <u><a href="../man3/pqt-specs.3.html">pqt-specs</a>(3)</u> man page.

       The  <u>format</u> argument is the specifier format string being prepared.  When this is NULL, the <u>name</u> prepared
       type spec is removed from the PGconn´s internal array.

       The <u>is_stmt</u> argument indicates if a parementerized statement version of <u>format</u>  should  be  cached  along
       with  the  prepared type spec.  This means all type specifiers in <u>format</u>, like "%int4", will be converted
       to "$1" syntax.  When is_stmt is non-zero, a statement will created and cached.  For more information  on
       specifer  format  string to paremterized statements, see the <u><a href="../man3/PQputf.3.html">PQputf</a>(3)</u> man page.  NOTE: to use a prepared
       type spec with execution functions like PQexecf, <u>is_stmt</u> must be set to non-zero.

       PQclearSpecs removes all prepared specifiers from the given PGconn, as opposed to removing  them  one  by
       one  by  setting PQspecPrepare's format argument to NULL.  A good use for this is after a PQresetXXX call
       when it might be desired to re-prepare all type specifiers.

       Functions that support the use of a prepared type spec are: <u>PQputf</u>, <u>PQputvf</u>,  <u>PQgetf</u>,  <u>PQgetvf</u>,  <u>PQexecf</u>,
       <u>PQexecvf</u>, <u>PQsendf</u>, <u>PQsendvf</u>, <u>PQparamExec</u>, <u>PQparamSendQuery</u>.

       <b>HINT:</b>  A  good  rule  of  thumb  for  using  prepared  type  specs,  is  when there are a large number of
       PQputf/PQgetf calls per statement execution.  This commonly occurs when dealing with  large  result  sets
       and arrays.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       PQspecPrepare  and PQclearSpecs return a nonzero value on success and zero if it fails.  Use PQgeterror()
       to get an error message.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This example prepares a type spec and issues some PQputf calls.

              <b>int</b> <b>i;</b>
              <b>PQparam</b> <b>*param;</b>

              <b>if(!PQspecPrepare(conn,</b> <b>"prepared_spec",</b> <b>"%int4</b> <b>%text",</b> <b>0))</b>
              <b>{</b>
                   <b>fprintf(stderr,</b> <b>"PQspecPrepare:</b> <b>%s0,</b> <b>PQgeterror());</b>
                   <b><a href="../man1/exit.1.html">exit</a>(1);</b>
              <b>}</b>

              <b>/*</b> <b>create</b> <b>after</b> <b>preparing</b> <b>spec</b> <b>*/</b>
              <b>param</b> <b>=</b> <b>PQparamCreate(conn);</b>

              <b>for(i=0;</b> <b>i</b> <b>&lt;</b> <b>100000;</b> <b>i++)</b>
              <b>{</b>
                   <b>/*</b> <b>NOTE:</b> <b>nothing</b> <b>else</b> <b>can</b> <b>be</b> <b>in</b> <b>format</b> <b>string</b> <b>*/</b>
                   <b>PQputf(param,</b> <b>"@prepared_spec",</b> <b>4,</b> <b>"text");</b>
              <b>}</b>

              <b>/*</b> <b>This</b> <b>elects</b> <b>to</b> <b>prepare</b> <b>a</b> <b>statement</b> <b>as</b> <b>well.</b>  <b>After</b> <b>this</b> <b>returns,</b>
               <b>*</b> <b>"SELECT</b> <b>myfunc($1,</b> <b>$2)"</b> <b>will</b> <b>be</b> <b>cached</b> <b>along</b> <b>with</b> <b>the</b> <b>prepared</b> <b>spec.</b>
               <b>*/</b>
              <b>PQspecPrepare(conn,</b> <b>"myfunc",</b> <b>"SELECT</b> <b>myfunc(%int4,</b> <b>%text)",</b> <b>1);</b>

              <b>/*</b> <b>"myfunc"</b> <b>tells</b> <b>execf</b> <b>to</b> <b>execute</b> <b>"SELECT</b> <b>myfunc($1,</b> <b>$2)".</b>  <b>If</b> <b>is_stmt</b>
               <b>*</b> <b>was</b> <b>set</b> <b>to</b> <b>zero</b> <b>during</b> <b>the</b> <b>PQspecPrepare,</b> <b>the</b> <b>below</b> <b>would</b> <b>be</b> <b>invalid</b>
               <b>*</b> <b>because</b> <b>execf</b> <b>doesn't</b> <b>know</b> <b>what</b> <b>to</b> <b>execute.</b>
               <b>*/</b>
              <b>PQexecf(conn,</b> <b>"@myfunc",</b> <b>123,</b> <b>"text");</b>

              <b>/*</b> <b>clear'm</b> <b>all</b> <b>*/</b>
              <b>PQclearSpecs(conn);</b>

</pre><h4><b>RATIONALE</b></h4><pre>
       None.

</pre><h4><b>AUTHOR</b></h4><pre>
       A contribution of eSilo, LLC. for the PostgreSQL Database Management System.  Written by Andrew Chernow.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<a href="mailto:libpqtypes@esilo.com">libpqtypes@esilo.com</a>&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2011 eSilo, LLC. All rights reserved.
       This is free software; see the source for copying  conditions.   There  is  NO  warranty;  not  even  for
       MERCHANTABILITY or  FITNESS FOR A PARTICULAR PURPOSE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/pqt-specs.3.html">pqt-specs</a>(3)</u>, <u><a href="../man3/PQgetf.3.html">PQgetf</a>(3)</u>, <u><a href="../man3/PQputf.3.html">PQputf</a>(3)</u>.

libpqtypes                                            2011                                      <u><a href="../man3/PQspecPrepare.3.html">PQspecPrepare</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>