<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSAPI - introduction to the Apache Traffic Server API</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/trafficserver-dev">trafficserver-dev_9.2.5+ds-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       TSAPI - introduction to the Apache Traffic Server API

</pre><h4><b>SYNOPSIS</b></h4><pre>
          #include &lt;ts/ts.h&gt;
          #include &lt;ts/remap.h&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  Apache  Traffic  Server  API  enables  you to create plugins, using the C programming language, that
       customize the behavior of your Traffic Server installation.

       Traffic Server enables sophisticated caching and processing of web-related traffic, such as DNS and  HTTP
       requests and responses.  Traffic Server itself consists of an event-driven loop that can be simplified as
       follows:

          for (;;) {
              event = get_next_event();
              handle_event (event);
          }

       You  compile  your  plugin  source  code  to create a shared library that Traffic Server loads when it is
       started. Your plugin contains callback functions that are registered for specific Traffic Server  events.
       When  Traffic  Server  needs  to  process  an  event,  it  invokes any and all call-back functions you've
       registered for that event type.

       Possible uses for plugins include the following:

       • HTTP processing plugins can filter, denylist, authorize users or transform content.

       • Protocol plugins can enable Traffic Server to proxy-cache new protocol content.

       • A denylisting plugin denies attempts to access web sites that are off-limits.

       • Append transform plugins add data to HTTP response content.

       • An image conversion plugin transforms JPEG images to GIF images.

       • Compression  plugins  send  response  content  to  a  compression  server  that  compresses  the   data
         (alternatively,  a  compression  library  local  to  the  Traffic  Server  host  machine  could  do the
         compression).

       • Authorization plugins check a user's permissions to access  particular  web  sites.  The  plugin  could
         consult a local authorization program or send queries to an authorization server.

       • A  plugin  that  gathers  client  information  from  request  headers  and enters this information in a
         database.

       • A protocol plugin listen for specific protocol requests on a designated  port  and  then  uses  Traffic
         Server's proxy server and cache to serve client requests.

</pre><h4><b>NAMING</b> <b>CONVENTIONS</b></h4><pre>
       The Traffic Server API adheres to the following naming conventions:

       • The  TS  prefix  is  used  for  all  function and variable names defined in the Traffic Server API. For
         example, <u>TS_EVENT_NONE</u>, <u>TSMutex</u>, and <u>TSContCreate()</u>.

       • Enumerated values are always  written  in  all  uppercase  letters.   For  example,  <u>TS_EVENT_NONE</u>  and
         <u>TS_VC_CLOSE_ABORT</u>.

       • Constant values are all uppercase; enumerated values can be seen as a subset of constants. For example,
         <u>TS_URL_SCHEME_FILE</u> and <u>TS_MIME_FIELD_ACCEPT</u>.

       • The names of defined types are mixed-case. For example, <u>TSHttpSsn</u> and <u>TSHttpTxn()</u>. <u>TSDebug()</u>

       • Function names are mixed-case. For example, <u>TSUrlCreate()</u> and <u>TSContDestroy()</u>.

       • Function  names  use the following subject-verb naming style: TS-&lt;subject&gt;-&lt;verb&gt;, where &lt;subject&gt; goes
         from general to specific.  This makes it easier to determine what a function does by reading its  name.
         For example, the function to retrieve the password field (the specific subject) from a URL (the general
         subject) is <u>TSUrlPasswordGet()</u>.

       • Common  verbs like Create, Destroy, Get, Set, Copy, Find, Retrieve, Insert, Remove, and Delete are used
         only when appropriate.

</pre><h4><b>PLUGIN</b> <b>LOADING</b> <b>AND</b> <b>CONFIGURATION</b></h4><pre>
       When Traffic Server is first started, it consults the plugin.config file to determine the  names  of  all
       shared plugin libraries that need to be loaded. The plugin.config file also defines arguments that are to
       be  passed  to each plugin's initialization function, <u>TSPluginInit()</u>. The <u>records.config</u> file defines the
       path to each plugin shared library.

       The sample <u>plugin.config</u> file below contains a comment line, a blank line, and two plugin configurations:

          # This is a comment line.
          my-plugin.so www.junk.com www.trash.com www.garbage.com
          some-plugin.so arg1 arg2 $proxy.config.http.cache.on

       Each plugin configuration in the <u>plugin.config</u> file resembles a UNIX or DOS shell command; each  line  in
       <u>plugin.config</u> cannot exceed 1023 characters.

       The  first plugin configuration is for a plugin named my-plugin.so.  It contains three arguments that are
       to be passed to that plugin's initialization routine. The second configuration  is  for  a  plugin  named
       some-plugin.so;  it contains three arguments. The last argument, $proxy.config.http.cache.on, is actually
       a configuration variable.   Traffic  Server  will  look  up  the  specified  configuration  variable  and
       substitute its value.

       Plugins are loaded and initialized by Traffic Server in the order they appear in the <u>plugin.config</u> file.

</pre><h4><b>PLUGIN</b> <b>INITIALIZATION</b></h4><pre>
       Each  plugin must define an initialization function named <u>TSPluginInit()</u> that Traffic Server invokes when
       the plugin is loaded. <u>TSPluginInit()</u> is commonly used to  read  configuration  information  and  register
       hooks for event notification.

</pre><h4><b>FILES</b></h4><pre>
       <u>plugin.config</u>, <u>records.config</u>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3ts/TSPluginInit.3ts.html">TSPluginInit</a>(3ts)</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2025, <a href="mailto:dev@trafficserver.apache.org">dev@trafficserver.apache.org</a>

9.2                                               May 22, 2025                                        <u><a href="../man3ts/TSAPI.3ts.html">TSAPI</a></u>(3ts)
</pre>
 </div>
</div></section>
</div>
</body>
</html>