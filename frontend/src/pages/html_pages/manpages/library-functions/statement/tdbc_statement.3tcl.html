<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tdbc::statement - TDBC statement object</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl8.6-tdbc">tcl8.6-tdbc_1.1.10-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tdbc::statement - TDBC statement object

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>tdbc</b> <b>1.0</b>
       package require <b>tdbc::</b><u>driver</u> <u>version</u>

       <b>tdbc::</b><u>driver</u><b>::connection</b> <b>create</b> <u>db</u> <u>?-option</u> <u>value</u>...?

       <b>set</b> <u>stmt</u> <b>[</b><u>db</u> <b>prepare</b> <u>sql-code</u><b>]</b>
       <b>set</b> <u>stmt</u> <b>[</b><u>db</u> <b>preparecall</b> <u>call</u><b>]</b>

       <u>$stmt</u> <b>params</b>
       <u>$stmt</u> <b>paramtype</b> ?<u>direction</u>? <u>type</u> ?<u>precision</u>? ?<u>scale</u>?
       <u>$stmt</u> <b>execute</b> ?<u>dict</u>?
       <u>$stmt</u> <b>resultsets</b>
       <u>$stmt</u> <b>allrows</b> ?<b>-as</b> <b>lists|dicts</b>? ?<b>-columnsvariable</b> <u>name</u>? ?<b>--</b>? ?<u>dict</u>
       <u>$stmt</u> <b>foreach</b> ?<b>-as</b> <b>lists|dicts</b>? ?<b>-columnsvariable</b> <u>name</u>? ?<b>--</b>? <u>varName</u> ?<u>dict</u>? <u>script</u>
       <u>$stmt</u> <b>close</b>
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Every  database driver for TDBC (Tcl DataBase Connectivity) implements a <u>statement</u> object that represents
       a SQL statement in a database. Instances  of  this  object  are  created  by  executing  the  <b>prepare</b>  or
       <b>preparecall</b> object command on a database connection.

       The  <b>prepare</b>  object command against the connection accepts arbitrary SQL code to be executed against the
       database. The SQL code may contain <u>bound</u> <u>variables</u>, which  are  strings  of  alphanumeric  characters  or
       underscores (the first character of the string may not be numeric), prefixed with a colon (<b>:</b>). If a bound
       variable  appears in the SQL statement, and is not in a string set off by single or double quotes, nor in
       a comment introduced by <b>--</b>, it becomes a value that is substituted when  the  statement  is  executed.  A
       bound  variable  becomes  a  single  value  (string  or  numeric) in the resulting statement. <u>Drivers</u> <u>are</u>
       <u>responsible</u> <u>for</u> <u>ensuring</u> <u>that</u> <u>the</u> <u>mechanism</u> <u>for</u> <u>binding</u> <u>variables</u> <u>prevents</u> <u>SQL</u> <u>injection.</u>

       The <b>preparecall</b> object command against the connection accepts a stylized statement in the form:

              <u>procname</u> <b>(</b>?<b>:</b><u>varname</u>? ?<b>,:</b><u>varname</u>...?<b>)</b>

       or

              <u>varname</u> <b>=</b> <u>procname</u> <b>(</b>?<b>:</b><u>varname</u>? ?<b>,:</b><u>varname</u>...?<b>)</b>

       This statement represents a call to a stored procedure <u>procname</u> in the database. The variable name to the
       left of the equal sign (if present), and all variable  names  that  are  parameters  inside  parentheses,
       become bound variables.

       The <b>params</b> method against a statement object enumerates the bound variables that appear in the statement.
       The  result  returned  from the <b>params</b> method is a dictionary whose keys are the names of bound variables
       (listed in the order in which the variables  first  appear  in  the  statement),  and  whose  values  are
       dictionaries.  The  subdictionaries  include  at  least  the  following  keys  (database  drivers may add
       additional keys that are not in this list).

       <b>direction</b>
              Contains one of the keywords, <b>in</b>, <b>out</b> or <b>inout</b> according to whether the variable is an input to or
              output from the statement. Only stored procedure calls will have <b>out</b> or <b>inout</b> parameters.

       <b>type</b>   Contains the data type of the column, and will generally be chosen from the set,  <b>bigint</b>,  <b>binary</b>,
              <b>bit</b>, <b>char</b>, <b>date</b>, <b>decimal</b>, <b>double</b>, <b>float</b>, <b>integer</b>, <b>longvarbinary</b>, <b>longvarchar</b>, <b>numeric</b>, <b>real</b>, <b>time</b>,
              <b>timestamp</b>,  <b>smallint</b>,  <b>tinyint</b>, <b>varbinary</b>, and <b>varchar</b>. (If the variable has a type that cannot be
              represented as one of the above, <b>type</b> will contain a driver-dependent description of the type.)

       <b>precision</b>
              Contains the precision of the column  in  bits,  decimal  digits,  or  the  width  in  characters,
              according to the type.

       <b>scale</b>  Contains  the  scale  of  the  column (the number of digits after the radix point), for types that
              support the concept.

       <b>nullable</b>
              Contains 1 if the column can contain NULL values, and 0 otherwise.

       The <b>paramtype</b> object  command  allows  the  script  to  specify  the  type  and  direction  of  parameter
       transmission  of  a  variable  in  a  statement.  (Some  databases  provide  no  method to determine this
       information automatically and place the burden on the caller to do so.) The <u>direction</u>,  <u>type</u>,  <u>precision</u>,
       <u>scale</u>,  and <u>nullable</u> arguments have the same meaning as the corresponding dictionary values in the <b>params</b>
       object command.

       The <b>execute</b> object command executes the statement. Prior to executing the statement, values are  provided
       for  the  bound variables that appear in it.  If the <u>dict</u> parameter is supplied, it is searched for a key
       whose name matches the name of the bound  variable.  If  the  key  is  present,  its  value  becomes  the
       substituted  variable.  If  not,  the  value  of the substituted variable becomes a SQL NULL. If the <u>dict</u>
       parameter is <u>not</u> supplied, the <b>execute</b> object command searches for a variable in the caller's scope whose
       name matches the name of the bound variable. If one is found, its  value  becomes  the  bound  variable's
       value.  If  none  is found, the bound variable is assigned a SQL NULL as its value.  Once substitution is
       finished,  the  resulting  statement  is  executed.  The  return  value  is  a  result  set  object  (see
       <b>tdbc::resultset</b> for details).

       The  <b>resultsets</b>  method  returns  a  list of all the result sets that have been returned by executing the
       statement and have not yet been closed.

       The <b>allrows</b> object command executes the statement as  with  the  <b>execute</b>  object  command,  accepting  an
       optional  <u>dict</u> parameter giving bind variables. After executing the statement, it uses the <u>allrows</u> object
       command on the result set (see <b>tdbc::resultset</b>) to construct a list of the results. Finally,  the  result
       set is closed. The return value is the list of results.

       The  <b>foreach</b>  object  command  executes  the  statement  as with the <b>execute</b> object command, accepting an
       optional <u>dict</u> parameter giving bind variables. After executing the statement, it uses the <u>foreach</u>  object
       command on the result set (see <b>tdbc::resultset</b>) to evaluate the given <u>script</u> for each row of the results.
       Finally,  the result set is closed, even if the given <u>script</u> results in a <b>return</b>, an error, or an unusual
       return code.

       The <b>close</b> object command removes a statement and  any  result  sets  that  it  has  created.  All  system
       resources associated with the objects are freed.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following code would look up a telephone number in a directory, assuming an appropriate SQL schema:

              package require tdbc::sqlite3
              tdbc::sqlite3::connection create db phonebook.sqlite3
              set statement [db prepare {
                  select phone_num from directory
                  where first_name = :firstname and last_name = :lastname
              }]
              set firstname Fred
              set lastname Flintstone
              $statement foreach row {
                  puts [dict get $row phone_num]
              }
              $statement close
              db close

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/encoding.3tcl.html">encoding</a>(3tcl), <a href="../man3tcl/tdbc.3tcl.html">tdbc</a>(3tcl), tdbc::<a href="../man3tcl/connection.3tcl.html">connection</a>(3tcl), tdbc::<a href="../man3tcl/resultset.3tcl.html">resultset</a>(3tcl), tdbc::<a href="../man3tcl/tokenize.3tcl.html">tokenize</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       TDBC,  SQL,  database,  connectivity, connection, resultset, statement, bound variable, stored procedure,
       call

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2008 by Kevin B. Kenny.

Tcl                                                    8.6                                 <u>tdbc::<a href="../man3tcl/statement.3tcl.html">statement</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>