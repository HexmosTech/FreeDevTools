<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongoDB::ReadPreference - Encapsulate and validate read preferences</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmongodb-perl">libmongodb-perl_2.2.2-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       MongoDB::ReadPreference - Encapsulate and validate read preferences

</pre><h4><b>VERSION</b></h4><pre>
       version v2.2.2

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use MongoDB::ReadPreference;

           $rp = MongoDB::ReadPreference-&gt;new(); # mode: primary

           $rp = MongoDB::ReadPreference-&gt;new(
               mode     =&gt; 'primaryPreferred',
               tag_sets =&gt; [ { dc =&gt; 'useast' }, {} ],
           );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A read preference indicates which servers should be used for read operations.

       For core documentation on read preference see &lt;<a href="http://docs.mongodb.org/manual/core/read-preference/">http://docs.mongodb.org/manual/core/read-preference/</a>&gt;.

</pre><h4><b>USAGE</b></h4><pre>
       Read preferences work via two attributes: "mode" and "tag_sets".  The "mode" parameter controls the types
       of servers that are candidates for a read operation as well as the logic for applying the "tag_sets"
       attribute to further restrict the list.

       The following terminology is used in describing read preferences:

       •   candidates – based on "mode", servers that could be suitable, based on "tag_sets" and other logic

       •   eligible – these are candidates that match "tag_sets"

       •   suitable – servers that meet all criteria for a read operation

   <b>Read</b> <b>preference</b> <b>modes</b>
       <u>primary</u>

       Only  an available primary is suitable.  "tag_sets" do not apply and must not be provided or an exception
       is thrown.

       <u>secondary</u>

       All secondaries (and <b>only</b> secondaries) are candidates, but only eligible candidates (i.e. after  applying
       "tag_sets") are suitable.

       <u>primaryPreferred</u>

       Try  to  find  a  server using mode "primary" (with no "tag_sets").  If that fails, try to find one using
       mode "secondary" and the "tag_sets" attribute.

       <u>secondaryPreferred</u>

       Try to find a server using mode "secondary" and the "tag_sets" attribute.  If that fails, try to  find  a
       server using mode "primary" (with no "tag_sets").

       <u>nearest</u>

       The  primary  and  all  secondaries  are  candidates,  but  only eligible candidates (i.e. after applying
       "tag_sets" to all candidates) are suitable.

       <b>NOTE</b>: in retrospect, the name "nearest" is misleading, as it implies a choice based  on  lowest  absolute
       latency or geographic proximity, neither which are true.

       The "nearest" mode merely includes both primaries and secondaries without any preference between the two.
       All  are filtered on "tag_sets".  Because of filtering, servers might not be "closest" in any sense.  And
       if multiple servers are suitable, one is randomly chosen based on the rules for server  selection,  which
       again might not be the closest in absolute latency terms.

   <b>Tag</b> <b>set</b> <b>matching</b>
       The "tag_sets" parameter is a list of tag sets (i.e. key/value pairs) to try in order.  The first tag set
       in  the  list  to  match  <b>any</b>  candidate  server  is  used  as the filter for all candidate servers.  Any
       subsequent tag sets are ignored.

       A read preference tag set ("T") matches a server tag set ("S") – or equivalently a server tag  set  ("S")
       matches a read preference tag set ("T") — if "T" is a subset of "S" (i.e. "T ⊆ S").

       For  example, the read preference tag set "{ dc =&gt; 'ny', rack =&gt; 2 }" matches a secondary server with tag
       set "{ dc =&gt; 'ny', rack =&gt; 2, size =&gt; 'large' }".

       A tag set that is an empty document – "{}" – matches any server, because the empty tag set is a subset of
       any tag set.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
   <b>mode</b>
       The read preference mode determines which server types are candidates for a read operation.  Valid values
       are:

       •   primary

       •   primaryPreferred

       •   secondary

       •   secondaryPreferred

       •   nearest

   <b>tag_sets</b>
       The "tag_sets" parameter is an ordered list of tag sets used to restrict the eligibility of servers, such
       as for data center awareness.

       The application of "tag_sets" varies depending on the "mode" parameter.  If the "mode" is 'primary', then
       "tag_sets" must not be supplied.

   <b>max_staleness_seconds</b>
       The "max_staleness_seconds" parameter represents the maximum replication lag in seconds (wall clock time)
       that a secondary can suffer and still be eligible for reads. The default is -1, which disables  staleness
       checks.

       If the "mode" is 'primary', then "max_staleness_seconds" must not be supplied.

</pre><h4><b>AUTHORS</b></h4><pre>
       •   David Golden &lt;<a href="mailto:david@mongodb.com">david@mongodb.com</a>&gt;

       •   Rassi &lt;<a href="mailto:rassi@mongodb.com">rassi@mongodb.com</a>&gt;

       •   Mike Friedman &lt;<a href="mailto:friedo@friedo.com">friedo@friedo.com</a>&gt;

       •   Kristina Chodorow &lt;<a href="mailto:k.chodorow@gmail.com">k.chodorow@gmail.com</a>&gt;

       •   Florian Ragwitz &lt;<a href="mailto:rafl@debian.org">rafl@debian.org</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       This software is Copyright (c) 2020 by MongoDB, Inc.

       This is free software, licensed under:

         The Apache License, Version 2.0, January 2004

perl v5.40.1                                       2025-04-03                       <u>MongoDB::<a href="../man3pm/ReadPreference.3pm.html">ReadPreference</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>