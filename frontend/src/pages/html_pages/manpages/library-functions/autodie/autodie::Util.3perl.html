<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>autodie::Util - Internal Utility subroutines for autodie and Fatal</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/perl-doc">perl-doc_5.40.1-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       autodie::Util - Internal Utility subroutines for autodie and Fatal

</pre><h4><b>SYNOPSIS</b></h4><pre>
           # INTERNAL API for autodie and Fatal only!

           use autodie::Util qw(on_end_of_compile_scope);
           on_end_of_compile_scope(sub { print "Hallo world\n"; });

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Internal Utilities for autodie and Fatal!  This module is not a part of autodie's public API.

       This module contains utility subroutines for abstracting away the underlying magic of autodie and
       (ab)uses of "%^H" to call subs at the end of a (compile-time) scopes.

       Note that due to how "%^H" works, some of these utilities are only useful during the compilation phase of
       a perl module and relies on the internals of how perl handles references in "%^H".

   <b>Methods</b>
       <u>on_end_of_compile_scope</u>

         on_end_of_compile_scope(sub { print "Hallo world\n"; });

       Will invoke a sub at the end of a (compile-time) scope.  The sub is called once with no arguments.  Can
       be called multiple times (even in the same "compile-time" scope) to install multiple subs.  Subs are
       called in a "first-in-last-out"-order (FILO or "stack"-order).

       <u>fill_protos</u>

         fill_protos('*$$;$@')

       Given a Perl subroutine prototype, return a list of invocation specifications.  Each specification is a
       listref, where the first member is the (minimum) number of arguments for this invocation specification.
       The remaining arguments are a string representation of how to pass the arguments correctly to a sub with
       the given prototype, when called with the given number of arguments.

       The specifications are returned in increasing order of arguments starting at 0 (e.g.  ';$') or 1 (e.g.
       '$@').  Note that if the prototype is "slurpy" (e.g. ends with a "@"), the number of arguments for the
       last specification is a "minimum" number rather than an exact number.  This can be detected by the last
       member of the last specification matching m/[@#]_/.

       <u>make_core_trampoline</u>

         make_core_trampoline('CORE::open', 'main', prototype('CORE::open'))

       Creates a trampoline for calling a core sub.  Essentially, a tiny sub that figures out how we should be
       calling our core sub, puts in the arguments in the right way, and bounces our control over to it.

       If we could reliably use `goto &amp;` on core builtins, we wouldn't need this subroutine.

       <u>install_subs</u>

         install_subs('My::Module', { 'read' =&gt; sub { die("Hallo\n"), ... }})

       Given a package name and a hashref mapping names to a subroutine reference (or "undef"), this subroutine
       will install said subroutines on their given name in that module.  If a name mapes to "undef", any
       subroutine with that name in the target module will be removed (possibly "unshadowing" a CORE sub of same
       name).

</pre><h4><b>AUTHOR</b></h4><pre>
       Copyright 2013-2014, Niels Thykier &lt;<a href="mailto:niels@thykier.net">niels@thykier.net</a>&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       This module is free software.  You may distribute it under the same terms as Perl itself.

perl v5.40.1                                       2025-07-03                               <u>autodie::<a href="../man3perl/Util.3perl.html">Util</a></u>(3perl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>