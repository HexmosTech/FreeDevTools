<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_set_stateless_cookie_generate_cb, SSL_CTX_set_stateless_cookie_verify_cb,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_set_stateless_cookie_generate_cb, SSL_CTX_set_stateless_cookie_verify_cb,
       SSL_CTX_set_cookie_generate_cb, SSL_CTX_set_cookie_verify_cb - Callback functions for stateless TLS1.3
       cookies

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        void SSL_CTX_set_stateless_cookie_generate_cb(
            SSL_CTX *ctx,
            int (*gen_stateless_cookie_cb) (SSL *ssl,
                                            unsigned char *cookie,
                                            size_t *cookie_len));
        void SSL_CTX_set_stateless_cookie_verify_cb(
            SSL_CTX *ctx,
            int (*verify_stateless_cookie_cb) (SSL *ssl,
                                               const unsigned char *cookie,
                                               size_t cookie_len));

        void SSL_CTX_set_cookie_generate_cb(SSL_CTX *ctx,
                                            int (*app_gen_cookie_cb) (SSL *ssl,
                                                                      unsigned char
                                                                      *cookie,
                                                                      unsigned int
                                                                      *cookie_len));
        void SSL_CTX_set_cookie_verify_cb(SSL_CTX *ctx,
                                          int (*app_verify_cookie_cb) (SSL *ssl,
                                                                       const unsigned
                                                                       char *cookie,
                                                                       unsigned int
                                                                       cookie_len));

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_CTX_set_stateless_cookie_generate_cb()</b> sets the callback used by <b><a href="../man3/SSL_stateless.3.html">SSL_stateless</a></b>(3) to generate the
       application-controlled portion of the cookie provided to clients in the HelloRetryRequest transmitted as
       a response to a ClientHello with a missing or invalid cookie. <b>gen_stateless_cookie_cb()</b> must write at
       most SSL_COOKIE_LENGTH bytes into <b>cookie</b>, and must write the number of bytes written to <b>cookie_len</b>. If a
       cookie cannot be generated, a zero return value can be used to abort the handshake.

       <b>SSL_CTX_set_stateless_cookie_verify_cb()</b> sets the callback used by <b><a href="../man3/SSL_stateless.3.html">SSL_stateless</a></b>(3) to determine whether
       the application-controlled portion of a ClientHello cookie is valid. The cookie data is pointed to by
       <b>cookie</b> and is of length <b>cookie_len</b>. A nonzero return value from <b>verify_stateless_cookie_cb()</b> communicates
       that the cookie is valid. The integrity of the entire cookie, including the application-controlled
       portion, is automatically verified by HMAC before <b>verify_stateless_cookie_cb()</b> is called.

       <b>SSL_CTX_set_cookie_generate_cb()</b> sets the callback used by <b><a href="../man3/DTLSv1_listen.3.html">DTLSv1_listen</a></b>(3) to generate the cookie
       provided to clients in the HelloVerifyRequest transmitted as a response to a ClientHello with a missing
       or invalid cookie.  <b>app_gen_cookie_cb()</b>  must write at most DTLS1_COOKIE_LENGTH bytes into <b>cookie</b>, and
       must write the number of bytes written to <b>cookie_len</b>. If a cookie cannot be generated, a zero return
       value can be used to abort the handshake.

       <b>SSL_CTX_set_cookie_verify_cb()</b> sets the callback used by <b><a href="../man3/DTLSv1_listen.3.html">DTLSv1_listen</a></b>(3) to determine whether the cookie
       in a ClientHello is valid. The cookie data is pointed to by <b>cookie</b> and is of length <b>cookie_len</b>. A nonzero
       return value from <b>app_verify_cookie_cb()</b> communicates that the cookie is valid. The integrity of the
       cookie is not verified by OpenSSL. This is an application responsibility.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       Neither function returns a value.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_stateless.3.html">SSL_stateless</a></b>(3), <b><a href="../man3/DTLSv1_listen.3.html">DTLSv1_listen</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>SSL_CTX_set_stateless_cookie_generate_cb()</b> and <b>SSL_CTX_set_stateless_cookie_verify_cb()</b> were added in
       OpenSSL 1.1.1.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2018 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04     <u><a href="../man3SSL/SSL_CTX_SET_STATELESS_COOKIE_GENERATE_CB.3SSL.html">SSL_CTX_SET_STATELESS_COOKIE_GENERATE_CB</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>