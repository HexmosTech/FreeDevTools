<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DBIx::Safe - Safer access to your database through a DBI database handle</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libdbix-safe-perl">libdbix-safe-perl_1.2.5-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       DBIx::Safe - Safer access to your database through a DBI database handle

</pre><h4><b>VERSION</b></h4><pre>
       This documents version 1.2.5 of the DBIx::Safe module

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use DBIx::Safe;

         $dbh = DBI-&gt;connect($dbn, $user, $pass, {AutoCommit =&gt; 0});

         my $safedbh = DBIx::Safe-&gt;new({ dbh =&gt; $dbh });

         $safedbh-&gt;allow_command('SELECT INSERT UPDATE');

         $safedbh-&gt;allow_regex(qr{LOCK TABLE \w+ IN EXCLUSIVE MODE});

         $safedbh-&gt;deny_regex(qr{LOCK TABLE pg_});

         $safedbh-&gt;allow_attribute('PrintError RaiseError');

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The purpose of this module is to give controlled, limited access to an application, rather than simply
       passing it a raw database handle through DBI. DBIx::Safe acts as a wrapper to the database, by only
       allowing through the commands you tell it to. It filters all things related to the database handle -
       methods and attributes.

       The typical usage is for your application to create a database handle via a normal DBI call to <b>new()</b>,
       then pass that to DBIx::Safe-&gt;<b>new()</b>, which will return you a DBIx::Safe object. After specifying exactly
       what is and what is not allowed, you can pass the object to the untrusted application. The object will
       act very similar to a DBI database handle, and in most cases can be used interchangeably.

       By default, nothing is allowed to run at all. There are many things you can control.  You can specify
       which SQL commands are allowed, by indicating the first word in the SQL statement (e.g. 'SELECT'). You
       can specify which database methods are allowed to run (e.g. 'ping'). You can specify a regular expression
       that allows matching SQL statements to run (e.g. 'qr{SET TIMEZONE}'). You can specify a regular
       expression that is NOT allowed to run (e.g. qr(UPDATE xxx}). Finally, you can indicate which database
       attributes are allowed to be read and changed (e.g. 'PrintError'). For all of the above, there are
       matching methods to remove them as well.

   <b>Deciding</b> <b>what</b> <b>statements</b> <b>to</b> <b>allow</b>
       Anytime a statement is sent to the server via the DBIx::Safe database handle, it is first examined to see
       if it is allowed to run or not. There are three major checks that occur when a statement is sent. First,
       the initial word of the statement, known as the command, is extracted. Next, the entire statement is
       checked against the list of denied regular expressions.  Next, the command is checked against the list of
       allowed commands. If there is no match, the statement is checked against the list of allowed regular
       expressions.

       Each DBD may implement additional or slightly different checks. For example, if using Postgres, no semi-
       colons are allowed unless the command is one of SELECT, INSERT, UPDATE, or DELETE, to prevent multiple
       commands from running. (The four listed commands can be checked in another way for multiple commands, so
       they are allowed to have semicolons).

   <b>Deciding</b> <b>what</b> <b>attributes</b> <b>to</b> <b>allow</b>
       Database handle attributes are controlled by a single list of allowed keys. If the key is allowed, the
       underlying database handle value is returned or changed (or both).  Note that the attribute "AutoCommit"
       is never allowed to be changed.

   <b>Methods</b>
       <u><b>new()</b></u>

       Creates a new DBIx::Safe object. Requires a mandatory "dbh" argument containing an active database
       handle. Optional arguments are "allow_command", "allow_regex", "deny_regex", and "allow_attribute".

       <u><b>allow_command()</b></u>

       Specifies which commands are allowed to be used. Can be a whitespace-separated list of words in a string,
       or an arrayref of such strings. Returns the current list of allowed commands. Duplicate commands will
       throw an error.

       <u><b>unallow_command()</b></u>

       Same as allow_command, but will remove words from the list.

       <u><b>allow_regex()</b></u>

       Specifies regular expressions which are allowed to run. Argument must be a regular expression, or an
       arrayref of regular expressions. Returns the current list.

       <u><b>unallow_regex()</b></u>

       Same as allow_regex, but will remove regexes from the list.

       <u><b>deny_regex()</b></u>

       Specifies regular expressions which are NOT allowed to run. Arguments and return the same as
       <b>allow_regex()</b>.

       <u>undeny</u> <u><b>regex()</b></u>

       Same as deny_regex, but will remove regexes from the list.

       <u><b>allow_attribute()</b></u>

       Specifies database handle attributes that are allowed to be changed. By default, nothing can be read.
       Argument is a whitespace-separated list of words in a string, or an arrayref of such strings. Returns the
       current list.

       <u><b>unallow_attribute()</b></u>

       Same as allow_attributes, but removes attributes from the list.

   <b>Testing</b>
       DBIx::Safe has a very comprehensive test suite, so please use it! The only thing you should need is a
       database connection, by setting the environment variables DBI_DSN and DBI_USER (and DBI_PASS if needed).

       You can optionally run the module through Perl::Critic by setting the TEST_AUTHOR environment variable.
       You will need to have the modules Perl::Critic and Test::Perl::Critic installed.

       Please report any test failures to the author or <a href="mailto:bucardo-general@bucardo.org">bucardo-general@bucardo.org</a>.

   <b>Supported</b> <b>Databases</b>
       Due to the difficulty of ensuring safe access to the database, each type of database must be specifically
       written into DBIx::Safe. Current databases supported are: Postgres (DBD::Pg).

</pre><h4><b>WEBSITE</b></h4><pre>
       The latest version and other information about DBIx::Safe can be found at: <a href="http://bucardo.org/dbix_safe/">http://bucardo.org/dbix_safe/</a>

</pre><h4><b>DEVELOPMENT</b></h4><pre>
       The latest development version can be checked out by using git:

         git clone <a href="http://bucardo.org/dbixsafe.git/">http://bucardo.org/dbixsafe.git/</a>

</pre><h4><b>BUGS</b></h4><pre>
       Bugs should be reported to the author or <a href="mailto:bucardo-general@bucardo.org">bucardo-general@bucardo.org</a>.

</pre><h4><b>AUTHOR</b></h4><pre>
       Greg Sabino Mullane &lt;<a href="mailto:greg@endpoint.com">greg@endpoint.com</a>&gt;

</pre><h4><b>LICENSE</b> <b>AND</b> <b>COPYRIGHT</b></h4><pre>
       Copyright 2006-2007 Greg Sabino Mullane &lt;<a href="mailto:greg@endpoint.com">greg@endpoint.com</a>&gt;.

       This software is free to use: see the LICENSE file for details.

perl v5.38.2                                       2024-03-04                                          <u><a href="../man3pm/Safe.3pm.html">Safe</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>