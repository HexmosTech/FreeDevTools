<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>memsup - A Memory Supervisor Process</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/erlang-manpages">erlang-manpages_24.2.1+dfsg-1ubuntu0.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       memsup - A Memory Supervisor Process

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>memsup</u>  is a process which supervises the memory usage for the system and for individual processes. It is
       part of the OS_Mon application, see <a href="../man7/os_mon.7.html">os_mon</a>(7). Available for Unix and Windows.

       Periodically performs a memory check:

         * If more than a certain amount of available system memory is allocated, as reported by the  underlying
           operating system, the alarm <u>{system_memory_high_watermark,</u> <u>[]}</u> is set.

         * If  any  Erlang  process  <u>Pid</u>  in the system has allocated more than a certain amount of total system
           memory, the alarm <u>{process_memory_high_watermark,</u> <u>Pid}</u> is set.

       Alarms  are  reported  to  the  SASL  alarm  handler,  see  <a href="../man3erl/alarm_handler.3erl.html">alarm_handler</a>(3erl).   To   set   an   alarm,
       <u>alarm_handler:set_alarm(Alarm)</u> is called where <u>Alarm</u> is either of the alarms specified above.

       The alarms are cleared automatically when the alarm cause is no longer valid.

       The function get_memory_data() can be used to retrieve the result of the latest periodic memory check.

       There is also a interface to system dependent memory data, get_system_memory_data(). The result is highly
       dependent  on the underlying operating system and the interface is targeted primarily for systems without
       virtual memory. However, the output on other systems is still valid, although sparse.

       A call to <u>get_system_memory_data/0</u> is more costly than a call to <u>get_memory_data/0</u> as data  is  collected
       synchronously when this function is called.

       The  total  system  memory  reported  under UNIX is the number of physical pages of memory times the page
       size, and the available memory is the number of available physical pages times the page size. This  is  a
       reasonable  measure  as  swapping  should  be  avoided  anyway, but the task of defining total memory and
       available memory is difficult because of virtual memory and swapping.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       The following configuration parameters can be used to change the default values for  time  intervals  and
       thresholds:

         <u>memory_check_interval</u> <u>=</u> <u>int()&gt;0</u>:
           The time interval, in minutes, for the periodic memory check. The default is one minute.

         <u>system_memory_high_watermark</u> <u>=</u> <u>float()</u>:
           The threshold, as percentage of system memory, for how much system memory can be allocated before the
           corresponding alarm is set. The default is 0.80 (80%).

         <u>process_memory_high_watermark</u> <u>=</u> <u>float()</u>:
           The  threshold,  as  percentage  of system memory, for how much system memory can be allocated by one
           Erlang process before the corresponding alarm is set. The default is 0.05 (5%).

         <u>memsup_helper_timeout</u> <u>=</u> <u>int()&gt;0</u>:
           A timeout, in seconds, for how long the <u>memsup</u> process should wait for a result from a memory  check.
           If  the  timeout  expires, a warning message <u>"OS_MON</u> <u>(memsup)</u> <u>timeout"</u> is issued via <u>error_logger</u> and
           any pending, synchronous client calls will return a dummy value. Normally, this situation should  not
           occur.  There have been cases on Linux, however, where the pseudo file from which system data is read
           is temporarily unavailable when the system is heavily loaded.

           The default is 30 seconds.

         <u>memsup_system_only</u> <u>=</u> <u>bool()</u>:
           Specifies whether the <u>memsup</u> process should only check system memory usage (<u>true</u>) or not. The default
           is <u>false</u>, meaning that information regarding both system memory usage and Erlang process memory usage
           is collected.

           It is recommended to set this parameter to <u>false</u> on systems with many concurrent processes,  as  each
           process memory check makes a traversal of the entire list of processes.

       See <a href="../man5/config.5.html">config</a>(5) for information about how to change the value of configuration parameters.

</pre><h4><b>EXPORTS</b></h4><pre>
       <b>get_memory_data()</b> <b>-&gt;</b> <b>{Total,Allocated,Worst}</b>

              Types:

                 Total = Allocated = int()
                 Worst = {Pid, PidAllocated} | undefined
                  Pid = pid()
                  PidAllocated = int()

              Returns  the result of the latest memory check, where <u>Total</u> is the total memory size and <u>Allocated</u>
              the allocated memory size, in bytes.

              <u>Worst</u> is the pid and number of allocated bytes of the largest  Erlang  process  on  the  node.  If
              <u>memsup</u>  should not collect process data, that is if the configuration parameter <u>memsup_system_only</u>
              was set to <u>true</u>, <u>Worst</u> is <u>undefined</u>.

              The function is normally asynchronous in the sense that it does not invoke  a  memory  check,  but
              returns  the latest available value. The one exception if is the function is called before a first
              memory check is finished, in which case it does not return a  value  until  the  memory  check  is
              finished.

              Returns  <u>{0,0,{pid(),0}}</u> or <u>{0,0,undefined}</u> if <u>memsup</u> is not available, or if all memory checks so
              far have timed out.

       <b>get_system_memory_data()</b> <b>-&gt;</b> <b>MemDataList</b>

              Types:

                 MemDataList = [{Tag, Size}]
                  Tag = atom()
                  Size = int()

              Invokes a memory check and returns the resulting, system dependent,  data  as  a  list  of  tagged
              tuples, where <u>Tag</u> currently can be one of the following:

                <u>total_memory</u>:
                  The  total  amount  of memory available to the Erlang emulator, allocated and free. May or may
                  not be equal to the amount of memory configured in the system.

                <u>available_memory</u>:
                  Informs about the amount memory that is available for increased usage if there is an increased
                  memory need. This value is not based on a calculation of the other provided values and  should
                  give  a  better  value  of  the amount of memory that actually is available than calculating a
                  value based on the other values reported. This value is currently only present on newer  Linux
                  kernels.  If  this  value  is  not  available  on Linux, you can use the sum of <u>cached_memory</u>,
                  <u>buffered_memory</u>, and <u>free_memory</u> as an approximation.

                <u>free_memory</u>:
                  The amount of free memory available to the Erlang emulator for allocation.

                <u>system_total_memory</u>:
                  The amount of memory available to the whole operating  system.  This  may  well  be  equal  to
                  <u>total_memory</u> but not necessarily.

                <u>buffered_memory</u>:
                   The amount of memory the system uses for temporary storing raw disk blocks.

                <u>cached_memory</u>:
                   The  amount  of memory the system uses for cached files read from disk. On Linux, also memory
                  marked as reclaimable in the kernel slab allocator will be added to this value.

                <u>total_swap</u>:
                   The amount of total amount of memory the system has available for disk swap.

                <u>free_swap</u>:
                   The amount of memory the system has available for disk swap.

          <b>Note:</b>
              Note that new tagged tuples may be introduced in the result at any time without prior notice

              Note that the order of the tuples in the resulting list is undefined and may change at any time.

              All memory sizes are presented as number of <u>bytes</u>.

              Returns the empty list [] if <u>memsup</u> is not available, or if the memory check times out.

       <b>get_os_wordsize()</b> <b>-&gt;</b> <b>Wordsize</b>

              Types:

                 Wordsize = 32 | 64 | unsupported_os

              Returns the wordsize of the current running operating system.

       <b>get_check_interval()</b> <b>-&gt;</b> <b>MS</b>

              Types:

                 MS = int()

              Returns the time interval, in milliseconds, for the periodic memory check.

       <b>set_check_interval(Minutes)</b> <b>-&gt;</b> <b>ok</b>

              Types:

                 Minutes = int()&gt;0

              Changes the time interval, given in minutes, for the periodic memory check.

              The change will take effect after the next memory check and is non-persistent. That is, in case of
              a process restart, this value is forgotten and the default value will be used.  See  Configuration
              above.

       <b>get_procmem_high_watermark()</b> <b>-&gt;</b> <b>int()</b>

              Returns the threshold, in percent, for process memory allocation.

       <b>set_procmem_high_watermark(Float)</b> <b>-&gt;</b> <b>ok</b>

              Changes the threshold, given as a float, for process memory allocation.

              The  change will take effect during the next periodic memory check and is non-persistent. That is,
              in case of a process restart, this value is forgotten and the default  value  will  be  used.  See
              Configuration above.

       <b>get_sysmem_high_watermark()</b> <b>-&gt;</b> <b>int()</b>

              Returns the threshold, in percent, for system memory allocation.

       <b>set_sysmem_high_watermark(Float)</b> <b>-&gt;</b> <b>ok</b>

              Changes the threshold, given as a float, for system memory allocation.

              The  change will take effect during the next periodic memory check and is non-persistent. That is,
              in case of a process restart, this value is forgotten and the default  value  will  be  used.  See
              Configuration above.

       <b>get_helper_timeout()</b> <b>-&gt;</b> <b>Seconds</b>

              Types:

                 Seconds = int()

              Returns the timeout value, in seconds, for memory checks.

       <b>set_helper_timeout(Seconds)</b> <b>-&gt;</b> <b>ok</b>

              Types:

                 Seconds = int() (&gt;= 1)

              Changes the timeout value, given in seconds, for memory checks.

              The  change will take effect for the next memory check and is non-persistent. That is, in the case
              of a process  restart,  this  value  is  forgotten  and  the  default  value  will  be  used.  See
              Configuration above.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3erl/alarm_handler.3erl.html">alarm_handler</a>(3erl), <a href="../man3erl/os_mon.3erl.html">os_mon</a>(3erl)

Ericsson AB                                       os_mon 2.7.1                                      <u><a href="../man3erl/memsup.3erl.html">memsup</a></u>(3erl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>