<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::Box::IMAP4 - handle IMAP4 folders as client</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmail-box-imap4-perl">libmail-box-imap4-perl_3.009-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::Box::IMAP4 - handle IMAP4 folders as client

</pre><h4><b>INHERITANCE</b></h4><pre>
        Mail::Box::IMAP4
          is a Mail::Box::Net
          is a Mail::Box
          is a Mail::Reporter

        Mail::Box::IMAP4 is extended by
          Mail::Box::IMAP4s

</pre><h4><b>SYNOPSIS</b></h4><pre>
        my $url = 'imap4://user:passwd@host:port/INBOX';
        my $url = 'imap://user:passwd@host:port/INBOX';

        use Mail::Box::IMAP4;
        my $folder = Mail::Box::IMAP4-&gt;new(folder =&gt; $url, ...);

        use Mail::Box::Manager;
        my $mgr    = Mail::Box::Manager-&gt;new;
        my $folder = $msg-&gt;open($url, retry =&gt; 3, interval =&gt; 5);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Maintain a folder which has its messages stored on a remote server.  The communication between the client
       application and the server is implemented using the IMAP4 protocol.  See also Mail::Server::IMAP4.

       This class uses Mail::Transport::IMAP4 to hide the transport of information, and focusses solely on the
       correct handling of messages within a IMAP4 folder.  More than one IMAP4 folder can be handled by one
       single IMAP4 connection.

       Extends "DESCRIPTION" in Mail::Box::Net.

</pre><h4><b>OVERLOADED</b></h4><pre>
       Extends "OVERLOADED" in Mail::Box::Net.

       overload: <b>""</b>
           Inherited, see "OVERLOADED" in Mail::Box

       overload: <b>@{}</b>
           Inherited, see "OVERLOADED" in Mail::Box

       overload: <b>cmp</b>
           Inherited, see "OVERLOADED" in Mail::Box

</pre><h4><b>METHODS</b></h4><pre>
       Extends "METHODS" in Mail::Box::Net.

   <b>Constructors</b>
       Extends "Constructors" in Mail::Box::Net.

       Mail::Box::IMAP4-&gt;<b>new</b>(%options)
           The "new" can have many %options.  Not only the ones listed here below, but also all the %options for
           <b>Mail::Transport::IMAP4::new()</b> can be passed.

           The default depends on the value of new(cache_head).

           Without  folder  name,  no  folder  is  selected.   Only  few methods are available now, for instance
           <b>listSubFolders()</b> to get the top-level folder names.   Usually,  the  folder  named  "INBOX"  will  be
           present.

            -Option           --Defined in     --Default
             access             Mail::Box        'r'
             body_delayed_type  Mail::Box        Mail::Message::Body::Delayed
             body_type          Mail::Box        Mail::Message::Body::Lines
             cache_body                          NO
             cache_head                          NO or DELAY
             cache_labels                        NO or DELAY
             coerce_options     Mail::Box        []
             create             Mail::Box        &lt;false&gt;
             extract            Mail::Box        10240
             field_type         Mail::Box        undef
             fix_headers        Mail::Box        &lt;false&gt;
             folder             Mail::Box        /
             folderdir          Mail::Box        &lt;network location&gt;
             head_delayed_type  Mail::Box        Mail::Message::Head::Delayed
             head_type          Mail::Box        Mail::Box::IMAP4::Head or Mail::Message::Head::Complete
             join_connection                     true
             keep_dups          Mail::Box        &lt;false&gt;
             lock_file          Mail::Box        undef
             lock_timeout       Mail::Box        1 hour
             lock_type          Mail::Box        'NONE'
             lock_wait          Mail::Box        10 seconds
             locker             Mail::Box        undef
             log                Mail::Reporter   'WARNINGS'
             manager            Mail::Box        undef
             message_type       Mail::Box        Mail::Box::IMAP4::Message
             multipart_type     Mail::Box        Mail::Message::Body::Multipart
             password           Mail::Box::Net   undef
             remove_when_empty  Mail::Box        &lt;false&gt;
             save_on_exit       Mail::Box        &lt;true&gt;
             server_name        Mail::Box::Net   undef
             server_port        Mail::Box::Net   143
             trace              Mail::Reporter   'WARNINGS'
             transporter                         Mail::Transport::IMAP4
             trusted            Mail::Box        &lt;false&gt;
             username           Mail::Box::Net   undef

           access =&gt; MODE
           body_delayed_type =&gt; CLASS
           body_type =&gt; CLASS|CODE
           cache_body =&gt; 'NO'|'YES'|'DELAY'
             Body  objects are immutable, but may still cached or not.  In common case, the body of a message is
             requested via <b>Mail::Message::body()</b> or <b>Mail::Message::decoded()</b>.  This returns a handle to  a  body
             object.   You  may  decide whether that body object can be reused or not.  "NO" means: retrieve the
             data each time again, "YES" will cache the body data, "DELAY" will send the whole message when  the
             folder is closed.

                     [local cache]  [write]
              NO         no           no
              YES        yes          no
              DELAY      yes          yes

           cache_head =&gt; 'NO'|'PARTIAL'|'DELAY'
             For  a  read-only folder, "DELAY" is the default, otherwise "NO" is chosen.  The four configuration
             parameter have subtile consequences.  To start with a table:

                     [local cache]  [write]  [default head_type]
              NO         no           no     Mail::Box::IMAP4::Head
              PARTIAL    yes          no     Mail::Box::IMAP4::Head
              DELAY      yes          yes    Mail::Message::Head::Complete

             The  default   "head_type"   is   Mail::Box::IMAP4::Head,   the   default   "cached_head_type"   is
             Mail::Message::Head::Complete.

             Having a local cache means that a lookup for a field is first done in a local data-structure (which
             extends  Mail::Message::Head::Partial), and only on the remote server if it was not found.  This is
             dangerous, because your locally cached data can be out-of-sync with the server.   However,  it  may
             give you a nice performance benefit.

             "DELAY"  will  always collect the whole header for you.  This is required when you want to look for
             Resent Groups (See Mail::Message::Head::ResentGroup) or other field order dependent header  access.
             A Mail::Message::Head::Delayed will be created first.

           cache_labels =&gt; 'NO'|'WRITE'|'DELAY'
             When  labels  from  a message are received, these values can be kept. However, this imposes dangers
             where the server's internal label storage may get out of sync with your data.

             With "NO", no caching will take place (but the performance will be worse). With "WRITE", all  label
             access  will  be  cached, but written to the server as well.  Both "NO" and "WRITE" will update the
             labels on the served, even when the folder was  opened  read-only.   "DELAY"  will  not  write  the
             changed  information  to  the server, but delay that till the moment that the folder is closed.  It
             only works when the folder is opened read/write or write is enforced.

             The default is "DELAY" for folders which where opened read-only.  This means  that  you  still  can
             force  an  update  with  close(write).  For folders which are opened read-write, the default is the
             safeset setting, which is "NO".

           coerce_options =&gt; ARRAY
           create =&gt; BOOLEAN
           extract =&gt; INTEGER | CODE | METHOD | 'LAZY'|'ALWAYS'
           field_type =&gt; CLASS
           fix_headers =&gt; BOOLEAN
           folder =&gt; FOLDERNAME
           folderdir =&gt; DIRECTORY
           head_delayed_type =&gt; CLASS
           head_type =&gt; CLASS
           join_connection =&gt; BOOLEAN
             Within this Mail::Box::IMAP4 class is registered which transporters are already in use, i.e.  which
             connections  to  the  IMAP  server  are  already in established.  When this option is set, multiple
             folder openings on the same server will try to reuse one connection.

           keep_dups =&gt; BOOLEAN
           lock_file =&gt; FILENAME
           lock_timeout =&gt; SECONDS
           lock_type =&gt; CLASS|STRING|ARRAY
           lock_wait =&gt; SECONDS
           locker =&gt; OBJECT
           log =&gt; LEVEL
           manager =&gt; MANAGER
           message_type =&gt; CLASS
           multipart_type =&gt; CLASS
           password =&gt; STRING
           remove_when_empty =&gt; BOOLEAN
           save_on_exit =&gt; BOOLEAN
           server_name =&gt; HOSTNAME
           server_port =&gt; INTEGER
           trace =&gt; LEVEL
           transporter =&gt; OBJECT|CLASS
             The name of the CLASS which will interface with  the  connection.   When  you  implement  your  own
             extension  to  Mail::Transport::IMAP4,  you  can  either  specify  a fully instantiated transporter
             OBJECT, or the name of your own CLASS.  When an  OBJECT  is  given,  most  other  options  will  be
             ignored.

           trusted =&gt; BOOLEAN
           username =&gt; STRING

           example:

            my $imap   = Mail::Box::IMAP4-&gt;new(username =&gt; 'myname',
               password =&gt; 'mypassword', server_name =&gt; 'imap.xs4all.nl');

            my $url    = 'imap4://user:<a href="mailto:password@imap.xs4all.nl">password@imap.xs4all.nl</a>';
            my $imap   = $mgr-&gt;open($url);

            my $client = Mail::IMAPClient-&gt;new(...);
            my $imap   = Mail::Box::IMAP4-&gt;new(imap_client =&gt; $client);

   <b>The</b> <b>folder</b>
       Extends "The folder" in Mail::Box::Net.

       $obj-&gt;<b>addMessage</b>($message, %options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>addMessages</b>(@messages)
           Inherited, see "The folder" in Mail::Box

       Mail::Box::IMAP4-&gt;<b>appendMessages</b>(%options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>close</b>(%options)
           Close  the folder.  In the case of IMAP, more than one folder can use the same connection, therefore,
           closing a folder does not always close the connection to the server.  Only when no  folder  is  using
           the connection anymore, a logout will be invoked by <b>Mail::Transport::IMAP4::DESTROY()</b>

            -Option      --Defined in     --Default
             force         Mail::Box        &lt;false&gt;
             save_deleted  Mail::Box        false
             write         Mail::Box        MODIFIED

           force =&gt; BOOLEAN
           save_deleted =&gt; BOOLEAN
           write =&gt; 'ALWAYS'|'NEVER'|'MODIFIED'
       $obj-&gt;<b>copyTo</b>($folder, %options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>delete</b>(%options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>folderdir</b>( [$directory] )
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>name</b>()
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>organization</b>()
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>size</b>()
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>type</b>()
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>update</b>(%options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>url</b>()
           Inherited, see "The folder" in Mail::Box

   <b>Folder</b> <b>flags</b>
       Extends "Folder flags" in Mail::Box::Net.

       $obj-&gt;<b>access</b>()
           Inherited, see "Folder flags" in Mail::Box

       $obj-&gt;<b>isModified</b>()
           Inherited, see "Folder flags" in Mail::Box

       $obj-&gt;<b>modified</b>( [BOOLEAN] )
           Inherited, see "Folder flags" in Mail::Box

       $obj-&gt;<b>writable</b>()
           Inherited, see "Folder flags" in Mail::Box

   <b>The</b> <b>messages</b>
       Extends "The messages" in Mail::Box::Net.

       $obj-&gt;<b>current</b>( [$number|$message|$message_id] )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>find</b>($message_id)
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>findFirstLabeled</b>( $label, [BOOLEAN, [$msgs]] )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>message</b>( $index, [$message] )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>messageId</b>( $message_id, [$message] )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>messageIds</b>()
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>messages</b>( &lt;'ALL'|$range|'ACTIVE'|'DELETED'|$label| !$label|$filter&gt; )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>nrMessages</b>(%options)
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>scanForMessages</b>($message, $message_ids, $timespan, $window)
           Inherited, see "The messages" in Mail::Box

   <b>Sub-folders</b>
       Extends "Sub-folders" in Mail::Box::Net.

       $obj-&gt;<b>listSubFolders</b>(%options)
       Mail::Box::IMAP4-&gt;<b>listSubFolders</b>(%options)
           Inherited, see "Sub-folders" in Mail::Box

       $obj-&gt;<b>nameOfSubFolder</b>( $subname, [$parentname] )
       Mail::Box::IMAP4-&gt;<b>nameOfSubFolder</b>( $subname, [$parentname] )
           Inherited, see "Sub-folders" in Mail::Box

       $obj-&gt;<b>openRelatedFolder</b>(%options)
           Inherited, see "Sub-folders" in Mail::Box

       $obj-&gt;<b>openSubFolder</b>($subname, %options)
           Inherited, see "Sub-folders" in Mail::Box

       $obj-&gt;<b>topFolderWithMessages</b>()
       Mail::Box::IMAP4-&gt;<b>topFolderWithMessages</b>()
           Inherited, see "Sub-folders" in Mail::Box

   <b>Internals</b>
       Extends "Internals" in Mail::Box::Net.

       $obj-&gt;<b>body</b>( [$body] )
       $obj-&gt;<b>coerce</b>($message, %options)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>create</b>($folder, %options)
       Mail::Box::IMAP4-&gt;<b>create</b>($folder, %options)
           Inherited, see "METHODS" in Mail::Box::Net

       $obj-&gt;<b>createTransporter</b>($class, %options)
           Create  a  transporter object (an instance of Mail::Transport::IMAP4), where $class defines the exact
           object type.  As %options, everything which is acceptable to a transporter  initiation  can  be  used
           (see <b>Mail::Transport::IMAP4::new()</b>.

            -Option         --Default
             join_connection  true

           join_connection =&gt; BOOLEAN
             See  new(join_connection).   When  false,  the connection will never be shared with other IMAP mail
             boxes.

       $obj-&gt;<b>determineBodyType</b>($message, $head)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>fetch</b>( &lt;$messages|$selection&gt;, $info )
           Low-level data retreival about one or more messages via IMAP4 from the remote server.  Some  of  this
           data  may  differ  from  the  information which is stored in the message objects which are created by
           MailBox, so you should avoid the use of this method for your own purposes.  The  IMAP  implementation
           provides some wrappers around this, providing the correct behavior.

           An   ARRAY   of   $messages   may   be   specified   or   some   message  $selection,  acceptable  to
           <b>Mail::Box::messages()</b>.  Examples of the latter are 'ALL', 'DELETED', or "spam" (messages labelled  to
           contain spam).

           The $info contains one or more attributes as defined by the IMAP protocol.  You have to read the full
           specs of the related RFCs to see these.

       Mail::Box::IMAP4-&gt;<b>foundIn</b>( [$foldername], %options )
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>getHead</b>($message)
           Read  the  header  for the specified message from the remote server.  "undef" is returned in case the
           message disappeared.

       $obj-&gt;<b>getHeadAndBody</b>($message)
           Read all data for the specified message from the remote server.  Return head and body of the  mesasge
           as list, or an empty list if the $message disappeared from the server.

       $obj-&gt;<b>lineSeparator</b>( [&lt;STRING|'CR'|'LF'|'CRLF'&gt;] )
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>locker</b>()
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>read</b>(%options)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>readMessages</b>(%options)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>storeMessage</b>($message)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>toBeThreaded</b>($messages)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>toBeUnthreaded</b>($messages)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>transporter</b>( [$object] )
           Returns  the  object which is the interface to the IMAP4 protocol handler.  The IMAP4 handler has the
           current folder selected.  When an $object is specified, it is set to be  the  transporter  from  that
           moment on.  The $object must extend Mail::Transport::IMAP4.

       $obj-&gt;<b>updateMessages</b>(%options)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>write</b>(%options)
           The  IMAP  protocol usually writes the data immediately to the remote server, because that's what the
           protocol wants.  However, some options to <b>new()</b> may delay that to  boost  performance.   This  method
           will, when the folder is being closed, write that info after all.

            -Option      --Defined in     --Default
             force         Mail::Box        &lt;false&gt;
             save_deleted                   &lt;false&gt;

           force =&gt; BOOLEAN
           save_deleted =&gt; BOOLEAN
             You  may  be able to save the messages which are flagged for deletion now, but they will be removed
             anyway when the folder is closed.

       $obj-&gt;<b>writeMessages</b>(%options)
            -Option     --Defined in     --Default
             messages     Mail::Box        &lt;required&gt;
             transporter                   &lt;required&gt;

           messages =&gt; ARRAY
           transporter =&gt; OBJECT

   <b>Other</b> <b>methods</b>
       Extends "Other methods" in Mail::Box::Net.

       $obj-&gt;<b>timespan2seconds</b>($time)
       Mail::Box::IMAP4-&gt;<b>timespan2seconds</b>($time)
           Inherited, see "Other methods" in Mail::Box

   <b>Error</b> <b>handling</b>
       Extends "Error handling" in Mail::Box::Net.

       $obj-&gt;<b>AUTOLOAD</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>addReport</b>($object)
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>defaultTrace</b>( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )
       Mail::Box::IMAP4-&gt;<b>defaultTrace</b>( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>errors</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>log</b>( [$level, [$strings]] )
       Mail::Box::IMAP4-&gt;<b>log</b>( [$level, [$strings]] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>logPriority</b>($level)
       Mail::Box::IMAP4-&gt;<b>logPriority</b>($level)
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>logSettings</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>notImplemented</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>report</b>( [$level] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>reportAll</b>( [$level] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>trace</b>( [$level] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>warnings</b>()
           Inherited, see "Error handling" in Mail::Reporter

   <b>Cleanup</b>
       Extends "Cleanup" in Mail::Box::Net.

       $obj-&gt;<b>DESTROY</b>()
           Inherited, see "Cleanup" in Mail::Box

</pre><h4><b>DETAILS</b></h4><pre>
       Extends "DETAILS" in Mail::Box::Net.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Warning: Cannot find head back for $uidl in $folder.
           The header was read before, but now seems empty: the IMAP4 server does not produce the  header  lines
           anymore.

       Warning: Cannot read body for $uidl in $folder.
           The  header  of  the  message  was  retrieved from the IMAP4 server, but the body is not read, for an
           unknown reason.

       Error: Copying failed for one message.
           For some reason, for instance disc full, removed by  external  process,  or  read-protection,  it  is
           impossible to copy one of the messages.  Copying will proceed for the other messages.

       Error: Couldn't select IMAP4 folder $name
       Error: Destination folder $name is not writable.
           The  folder where the messages are copied to is not opened with write access (see new(access)).  This
           has no relation with write permission to the folder which is controlled by your operating system.

       Warning: Different messages with id $msgid
           The message id is discovered more than once within the same folder, but the content  of  the  message
           seems to be different.  This should not be possible: each message must be unique.

       Error: Folder $name not deleted: not writable.
           The  folder  must be opened with write access via new(access), otherwise removing it will be refused.
           So, you may have write-access according to the operating system, but that will not automatically mean
           that this "delete" method permits you to.  The reverse remark is valid as well.

       Notice: Impossible to keep deleted messages in IMAP
           Some folder type have a 'deleted' flag which can be stored in the folder to be performed later.   The
           folder keeps that knowledge even when the folder is rewritten.  Well, IMAP4 cannot play that trick.

       Error: Invalid timespan '$timespan' specified.
           The string does not follow the strict rules of the time span syntax which is permitted as parameter.

       Warning: Message $uidl disappeared from $folder.
           Trying to get the specific message from the server, but it appears to be gone.

       Warning: Message $uidl disappeared from $folder.
           Trying to get the specific message from the server, but it appears to be gone.

       Warning: Message-id '$msgid' does not contain a domain.
           According  to  the  RFCs,  message-ids  need to contain a unique random part, then an "@", and then a
           domain name.  This is made to avoid the creation of two messages  with  the  same  id.   The  warning
           emerges when the "@" is missing from the string.

       Error: No IMAP4 transporter configured
       Error: Package $package does not implement $method.
           Fatal  error:  the specific package (or one of its superclasses) does not implement this method where
           it should. This message means that some other related classes do implement this  method  however  the
           class  at  hand does not.  Probably you should investigate this and probably inform the author of the
           package.

       Error: Unable to create subfolder $name of $folder.
           The copy includes the subfolders, but for some reason it was not  possible  to  copy  one  of  these.
           Copying will proceed for all other sub-folders.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       This  module  is  part  of  Mail-Box-IMAP4  distribution version 3.009, built on April 18, 2025. Website:
       <u><a href="http://perl.overmeer.net/CPAN/">http://perl.overmeer.net/CPAN/</a></u>

</pre><h4><b>LICENSE</b></h4><pre>
       Copyrights 2001-2025 by [Mark Overmeer]. For other contributors see ChangeLog.

       This program is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself.  See <u><a href="http://dev.perl.org/licenses/">http://dev.perl.org/licenses/</a></u>

perl v5.40.1                                       2025-04-19                              <u>Mail::Box::<a href="../man3pm/IMAP4.3pm.html">IMAP4</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>