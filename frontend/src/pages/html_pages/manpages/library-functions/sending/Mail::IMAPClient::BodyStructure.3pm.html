<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::IMAPClient::BodyStructure - parse fetched results</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmail-imapclient-perl">libmail-imapclient-perl_3.43-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::IMAPClient::BodyStructure - parse fetched results

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Mail::IMAPClient;
         use Mail::IMAPClient::BodyStructure;

         my $imap = Mail::IMAPClient-&gt;new(
             Server =&gt; $server, User =&gt; $login, Password =&gt; $pass
         );

         $imap-&gt;select("INBOX") or die "Could not select INBOX: $@\n";

         my @recent = $imap-&gt;search("recent") or die "No recent msgs in INBOX\n";

         foreach my $id (@recent) {
             my $bsdat = $imap-&gt;fetch( $id, "bodystructure" );
             my $bso   = Mail::IMAPClient::BodyStructure-&gt;new( join("", $imap-&gt;History) );
             my $mime  = $bso-&gt;bodytype . "/" . $bso-&gt;bodysubtype;
             my $parts = map( "\n\t" . $_, $bso-&gt;parts );
             print "Msg $id (Content-type: $mime) contains these parts:$parts\n";
         }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This extension will parse the result of an IMAP FETCH BODYSTRUCTURE command into a perl data structure.
       It also provides helper methods to help pull information out of the data structure.

       This module requires Parse::RecDescent.

</pre><h4><b>Class</b> <b>Methods</b></h4><pre>
       The following class method is available:

   <b>new</b>
       This class method is the constructor method for instantiating new Mail::IMAPClient::BodyStructure
       objects.  The <b>new</b> method accepts one argument, a string containing a server response to a FETCH
       BODYSTRUCTURE directive.

       The module <b>Mail::IMAPClient</b> provides the <b>get_bodystructure</b> convenience method to simplify use of this
       module when starting with just a messages sequence number or unique ID (UID).

</pre><h4><b>Object</b> <b>Methods</b></h4><pre>
       The following object methods are available:

   <b>bodytype</b>
       The <b>bodytype</b> object method requires no arguments.  It returns the bodytype for the message whose
       structure is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>bodysubtype</b>
       The <b>bodysubtype</b> object method requires no arguments.  It returns the bodysubtype for the message whose
       structure is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>bodyparms</b>
       The <b>bodyparms</b> object method requires no arguments.  It returns the bodyparms for the message whose
       structure is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>bodydisp</b>
       The <b>bodydisp</b> object method requires no arguments.  It returns the bodydisp for the message whose
       structure is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>bodyid</b>
       The <b>bodyid</b> object method requires no arguments.  It returns the bodyid for the message whose structure is
       described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>bodydesc</b>
       The <b>bodydesc</b> object method requires no arguments.  It returns the bodydesc for the message whose
       structure is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>bodyenc</b>
       The <b>bodyenc</b> object method requires no arguments.  It returns the bodyenc for the message whose structure
       is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>bodysize</b>
       The <b>bodysize</b> object method requires no arguments.  It returns the bodysize for the message whose
       structure is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>bodylang</b>
       The <b>bodylang</b> object method requires no arguments.  It returns the bodylang for the message whose
       structure is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>bodystructure</b>
       The <b>bodystructure</b> object method requires no arguments.  It returns the bodystructure for the message
       whose structure is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>envelopestruct</b>
       The <b>envelopestruct</b> object method requires no arguments.  It returns a
       <b>Mail::IMAPClient::BodyStructure::Envelope</b> object for the message from the calling
       <b>Mail::IMAPClient::Bodystructure</b> object.

   <b>textlines</b>
       The <b>textlines</b> object method requires no arguments.  It returns the textlines for the message whose
       structure is described by the calling <b>Mail::IMAPClient::Bodystructure</b> object.

</pre><h4><b>Mail::IMAPClient::BodyStructure::Envelope</b></h4><pre>
       The IMAP standard specifies that output from the IMAP <b>FETCH</b> <b>ENVELOPE</b> command will be an RFC2060 envelope
       structure.  It further specifies that output from the <b>FETCH</b> <b>BODYSTRUCTURE</b> command may also contain
       embedded envelope structures (if, for example, a message's subparts contain one or more included
       messages).  Objects belonging to <b>Mail::IMAPClient::BodyStructure::Envelope</b> are Perl representations of
       these envelope structures, which is to say the nested parenthetical lists of RFC2060 translated into a
       Perl datastructure.

       Note that all of the fields relate to the specific part to which they belong.  In other words, output
       from a FETCH nnnn ENVELOPE command (or, in <b>Mail::IMAPClient</b>, "$imap-"fetch($msgid,"ENVELOPE")&gt; or "my
       $env = $imap-"get_envelope($msgid)&gt;) are for the message, but fields from within a bodystructure relate
       to the message subpart and not the parent message.

       An envelope structure's <b>Mail::IMAPClient::BodyStructure::Envelope</b> representation is a hash of thingies
       that looks like this:

         {
            subject   =&gt; "subject",
            inreplyto =&gt; "reference_message_id",
            from      =&gt; [ addressStruct1 ],
            messageid =&gt; "message_id",
            bcc       =&gt; [ addressStruct1, addressStruct2 ],
            date      =&gt; "Tue, 09 Jul 2002 14:15:53 -0400",
            replyto   =&gt; [ adressStruct1, addressStruct2 ],
            to        =&gt; [ adressStruct1, addressStruct2 ],
            sender    =&gt; [ adressStruct1 ],
            cc        =&gt; [ adressStruct1, addressStruct2 ],
         }

       The <b>...::Envelope</b> object also has methods for accessing data in the structure. They are:

       date
           Returns the date of the message.

       inreplyto
           Returns the message id of the message to which this message is a reply.

       subject
           Returns the subject of the message.

       messageid
           Returns the message id of the message.

       You  can  also use the following methods to get addressing information.  Each of these methods returns an
       array of <b>Mail::IMAPClient::BodyStructure::Address</b> objects, which are perl  data  structures  representing
       RFC2060  address  structures.   Some  of  these arrays would naturally contain one element (such as <b>from</b>,
       which normally contains a single "From:" address); others will  often  contain  more  than  one  address.
       However,  because  RFC2060 defines all of these as "lists of address structures", they are all translated
       into arrays of <b>...::Address</b> objects.

       See the section on <b>Mail::IMAPClient::BodyStructure::Address</b>, below, for alternate (and preferred) ways of
       accessing these data.

       The methods available are:

       bcc Returns an array of blind cc'ed recipients' address structures.  (Don't expect much  in  here  unless
           the message was sent from the mailbox you're poking around in, by the way.)

       cc  Returns an array of cc'ed recipients' address structures.

       from
           Returns an array of "From:" address structures--usually just one.

       replyto
           Returns  an array of "Reply-to:" address structures.  Once again there is usually just one address in
           the list.

       sender
           Returns an array of senders' address structures--usually just one and usually the same as <b>from</b>.

       to  Returns an array of recipients' address structures.

       Each   of   the   methods   that   returns   a   list   of   address   structures   (i.e.   a   list   of
       <b>Mail::IMAPClient::BodyStructure::Address</b>  arrays) also has an analogous method that will return a list of
       E-Mail addresses instead.  The addresses are in the format "personalname &lt;mailboxname@hostname&gt;" (see the
       section on <b>Mail::IMAPClient::BodyStructure::Address</b>, below) However, if the personal name is  'NIL'  then
       it is omitted from the address.

       These methods are:

       bcc_addresses
           Returns  a  list (or an array reference if called in scalar context) of blind cc'ed recipients' email
           addresses.  (Don't expect much in here unless the message was sent from  the  mailbox  you're  poking
           around in, by the way.)

       cc_addresses
           Returns  a  list  of  cc'ed  recipients' email addresses.  If called in a scalar context it returns a
           reference to an array of email addresses.

       from_addresses
           Returns a list of "From:" email addresses.  If called in a scalar context it returns the first  email
           address in the list.  (It's usually a list of just one anyway.)

       replyto_addresses
           Returns  a  list  of "Reply-to:" email addresses.  If called in a scalar context it returns the first
           email address in the list.

       sender_addresses
           Returns a list of senders' email addresses.  If called in a scalar context it returns the first email
           address in the list.

       to_addresses
           Returns a list of recipients' email addresses.  If called in a scalar context it returns a  reference
           to an array of email addresses.

       Note that context affects the behavior of all of the above methods.

       Those  fields that will commonly contain multiple entries (i.e. they are recipients) will return an array
       reference when called in scalar context.  You can use this behavior to optimize performance.

       Those fields that will commonly contain just one address  (the  sender's)  will  return  the  first  (and
       usually only) address.  You can use this behavior to optimize your development time.

</pre><h4><b>Addresses</b> <b>and</b> <b>the</b> <b>Mail::IMAPClient::BodyStructure::Address</b></h4><pre>
       Several  components of an envelope structure are address structures.  They are each parsed into their own
       object, <b>Mail::IMAPClient::BodyStructure::Address</b>, which looks like this:

          {
             mailboxname  =&gt; 'somebody.special',
             hostname     =&gt; 'somplace.weird.com'
             personalname =&gt; 'Somebody Special
             sourceroute  =&gt; 'NIL'
          }

       RFC2060 specifies that each address component of a bodystructure is a  list  of  address  structures,  so
       <b>Mail::IMAPClient::BodyStructure</b>      parses      each      of      these     into     an     array     of
       <b>Mail::IMAPClient::BodyStructure::Address</b> objects.

       Each of these objects has the following methods available to it:

       mailboxname
           Returns the "mailboxname" portion of the address, which is the part to the left of the '@' sign.

       hostname
           Returns the "hostname" portion of the address, which is the part to the right of the '@' sign.

       personalname
           Returns the "personalname" portion of the address, which is the part of the  address  that's  treated
           like a comment.

       sourceroute
           Returns the "sourceroute" portion of the address, which is typically "NIL".

       Taken together, the parts of an address structure form an address that will look something like this:

       "personalname &lt;mailboxname@hostname&gt;"

       Note  that  because  the  <b>Mail::IMAPClient::BodyStructure::Address</b> objects come in arrays, it's generally
       easier to use the methods available to <b>Mail::IMAPClient::BodyStructure::Envelope</b> to  obtain  all  of  the
       addresses  in  a  particular  array in one operation.  These methods are provided, however, in case you'd
       rather   do   things   the   hard   way.    (And   also   because   the   aforementioned   methods   from
       <b>Mail::IMAPClient::BodyStructure::Envelope</b> need them anyway.)

</pre><h4><b>AUTHOR</b></h4><pre>
       Original author: David J. Kernen; Reworked by: Mark Overmeer; Maintained by Phil Pearl.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/perl.1.html">perl</a></b>(1), Mail::IMAPClient, Parse::RecDescent, and RFC2060.

perl v5.32.1                                       2021-09-11               <u>Mail::IMAPClient::<a href="../man3pm/BodyStructure.3pm.html">BodyStructure</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>