<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::Box::MH - handle MH folders</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmail-box-perl">libmail-box-perl_3.011-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::Box::MH - handle MH folders

</pre><h4><b>INHERITANCE</b></h4><pre>
        Mail::Box::MH
          is a Mail::Box::Dir
          is a Mail::Box
          is a Mail::Reporter

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Mail::Box::MH;
        my $folder = Mail::Box::MH-&gt;new(folder =&gt; $ENV{MAIL}, ...);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This documentation describes how MH mailboxes work, and what you can do with the MH folder object
       "Mail::Box::MH".

       Extends "DESCRIPTION" in Mail::Box::Dir.

</pre><h4><b>OVERLOADED</b></h4><pre>
       Extends "OVERLOADED" in Mail::Box::Dir.

       overload: <b>""</b>
           Inherited, see "OVERLOADED" in Mail::Box

       overload: <b>@{}</b>
           Inherited, see "OVERLOADED" in Mail::Box

       overload: <b>cmp</b>
           Inherited, see "OVERLOADED" in Mail::Box

</pre><h4><b>METHODS</b></h4><pre>
       Extends "METHODS" in Mail::Box::Dir.

   <b>Constructors</b>
       Extends "Constructors" in Mail::Box::Dir.

       Mail::Box::MH-&gt;<b>new</b>(%options)
            -Option           --Defined in     --Default
             access             Mail::Box        'r'
             body_delayed_type  Mail::Box        Mail::Message::Body::Delayed
             body_type          Mail::Box        Mail::Message::Body::Lines
             coerce_options     Mail::Box        []
             create             Mail::Box        &lt;false&gt;
             directory          Mail::Box::Dir   &lt;derived from folder name&gt;
             extract            Mail::Box        10240
             field_type         Mail::Box        undef
             fix_headers        Mail::Box        &lt;false&gt;
             folder             Mail::Box        $ENV{MAIL}
             folderdir          Mail::Box        $ENV{HOME}/.mh
             head_delayed_type  Mail::Box        Mail::Message::Head::Delayed
             head_type          Mail::Box        Mail::Message::Head::Complete
             index                               undef
             index_filename                      &lt;foldername&gt;/.index
             index_type                          Mail::Box::MH::Index
             keep_dups          Mail::Box        &lt;false&gt;
             keep_index                          0
             labels                              undef
             labels_filename                     &lt;foldername&gt;/.mh_sequence
             labels_type                         Mail::Box::MH::Labels
             lock_file          Mail::Box        &lt;index_file&gt;
             lock_timeout       Mail::Box        1 hour
             lock_type          Mail::Box        Mail::Box::Locker::DotLock
             lock_wait          Mail::Box        10 seconds
             locker             Mail::Box        undef
             log                Mail::Reporter   'WARNINGS'
             manager            Mail::Box        undef
             message_type       Mail::Box        &lt;folder-class&gt;::Message
             multipart_type     Mail::Box        Mail::Message::Body::Multipart
             remove_when_empty  Mail::Box        &lt;true&gt;
             save_on_exit       Mail::Box        &lt;true&gt;
             trace              Mail::Reporter   'WARNINGS'
             trusted            Mail::Box        &lt;depends on folder location&gt;

           access =&gt; MODE
           body_delayed_type =&gt; CLASS
           body_type =&gt; CLASS|CODE
           coerce_options =&gt; ARRAY
           create =&gt; BOOLEAN
           directory =&gt; DIRECTORY
           extract =&gt; INTEGER | CODE | METHOD | 'LAZY'|'ALWAYS'
           field_type =&gt; CLASS
           fix_headers =&gt; BOOLEAN
           folder =&gt; FOLDERNAME
           folderdir =&gt; DIRECTORY
           head_delayed_type =&gt; CLASS
           head_type =&gt; CLASS
           index =&gt; OBJECT
             You may specify an OBJECT of a type which extends Mail::Box::MH::Index (at least implements a get()
             method), as alternative for an index file reader as created by "Mail::Box::MH".

           index_filename =&gt; FILENAME
             The  FILENAME which is used in each directory to store the headers of all mails. The filename shall
             not contain a directory path. (e.g. Do not use "/usr/people/jan/.index", nor  "subdir/.index",  but
             say ".index".)

           index_type =&gt; CLASS
           keep_dups =&gt; BOOLEAN
           keep_index =&gt; BOOLEAN
             Keep  an  index  file  of  the specified mailbox, one file per directory.  Using an index file will
             speed up things considerably, because it avoids reading all the message files the moment  that  you
             open  the  folder.  When you open a folder, you can use the index file to retrieve information such
             as the subject of each message, instead of having to read possibly thousands of messages.

           labels =&gt; OBJECT
             You may specify an OBJECT of a type which extends Mail::Box::MH::Labels (at  least  implements  the
             get() method), as alternative for labels file reader as created by "Mail::Box::MH".

           labels_filename =&gt; FILENAME
             In  MH-folders,  messages can be labeled, for instance based on the sender or whether it is read or
             not.  This status is kept in a file which is usually called ".mh_sequences", but that name  can  be
             overruled with this flag.

           labels_type =&gt; CLASS
           lock_file =&gt; FILENAME
           lock_timeout =&gt; SECONDS
           lock_type =&gt; CLASS|STRING|ARRAY
           lock_wait =&gt; SECONDS
           locker =&gt; OBJECT
           log =&gt; LEVEL
           manager =&gt; MANAGER
           message_type =&gt; CLASS
           multipart_type =&gt; CLASS
           remove_when_empty =&gt; BOOLEAN
           save_on_exit =&gt; BOOLEAN
           trace =&gt; LEVEL
           trusted =&gt; BOOLEAN

   <b>The</b> <b>folder</b>
       Extends "The folder" in Mail::Box::Dir.

       $obj-&gt;<b>addMessage</b>($message, %options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>addMessages</b>(@messages)
           Inherited, see "The folder" in Mail::Box

       Mail::Box::MH-&gt;<b>appendMessages</b>(%options)
           Append a message to a folder which is not open.

            -Option  --Defined in     --Default
             folder    Mail::Box        &lt;required&gt;
             message   Mail::Box        undef
             messages  Mail::Box        undef
             share     Mail::Box        &lt;false&gt;

           folder =&gt; FOLDERNAME
           message =&gt; MESSAGE
           messages =&gt; ARRAY-OF-MESSAGES
           share =&gt; BOOLEAN
       $obj-&gt;<b>close</b>(%options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>copyTo</b>($folder, %options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>delete</b>(%options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>directory</b>()
           Inherited, see "The folder" in Mail::Box::Dir

       $obj-&gt;<b>folderdir</b>( [$directory] )
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>name</b>()
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>organization</b>()
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>size</b>()
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>type</b>()
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>update</b>(%options)
           Inherited, see "The folder" in Mail::Box

       $obj-&gt;<b>url</b>()
           Inherited, see "The folder" in Mail::Box

   <b>Folder</b> <b>flags</b>
       Extends "Folder flags" in Mail::Box::Dir.

       $obj-&gt;<b>access</b>()
           Inherited, see "Folder flags" in Mail::Box

       $obj-&gt;<b>isModified</b>()
           Inherited, see "Folder flags" in Mail::Box

       $obj-&gt;<b>modified</b>( [BOOLEAN] )
           Inherited, see "Folder flags" in Mail::Box

       $obj-&gt;<b>writable</b>()
           Inherited, see "Folder flags" in Mail::Box

   <b>The</b> <b>messages</b>
       Extends "The messages" in Mail::Box::Dir.

       $obj-&gt;<b>current</b>( [$number|$message|$message_id] )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>find</b>($message_id)
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>findFirstLabeled</b>( $label, [BOOLEAN, [$msgs]] )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>message</b>( $index, [$message] )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>messageId</b>( $message_id, [$message] )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>messageIds</b>()
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>messages</b>( &lt;'ALL'|$range|'ACTIVE'|'DELETED'|$label| !$label|$filter&gt; )
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>nrMessages</b>(%options)
           Inherited, see "The messages" in Mail::Box

       $obj-&gt;<b>scanForMessages</b>($message, $message_ids, $timespan, $window)
           Inherited, see "The messages" in Mail::Box

   <b>Sub-folders</b>
       Extends "Sub-folders" in Mail::Box::Dir.

       $obj-&gt;<b>listSubFolders</b>(%options)
       Mail::Box::MH-&gt;<b>listSubFolders</b>(%options)
           Inherited, see "Sub-folders" in Mail::Box

       $obj-&gt;<b>nameOfSubFolder</b>( $subname, [$parentname] )
       Mail::Box::MH-&gt;<b>nameOfSubFolder</b>( $subname, [$parentname] )
           Inherited, see "Sub-folders" in Mail::Box

       $obj-&gt;<b>openRelatedFolder</b>(%options)
           Inherited, see "Sub-folders" in Mail::Box

       $obj-&gt;<b>openSubFolder</b>($subname, %options)
           Inherited, see "Sub-folders" in Mail::Box

       $obj-&gt;<b>topFolderWithMessages</b>()
       Mail::Box::MH-&gt;<b>topFolderWithMessages</b>()
           Inherited, see "Sub-folders" in Mail::Box

   <b>Internals</b>
       Extends "Internals" in Mail::Box::Dir.

       $obj-&gt;<b>coerce</b>($message, %options)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>create</b>($foldername, %options)
       Mail::Box::MH-&gt;<b>create</b>($foldername, %options)
            -Option   --Defined in--Default
             folderdir  Mail::Box   undef

           folderdir =&gt; DIRECTORY
       $obj-&gt;<b>determineBodyType</b>($message, $head)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>folderToDirectory</b>($foldername, $folderdir)
           Inherited, see "Internals" in Mail::Box::Dir

       Mail::Box::MH-&gt;<b>foundIn</b>( [$foldername], %options )
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>highestMessageNumber</b>()
           Returns  the  highest  number which is used in the folder to store a file.  This method may be called
           when the folder is read (then this number can be derived without file-system access), but  also  when
           the folder is not read (yet).

       $obj-&gt;<b>index</b>()
           Create a index reader/writer object.

       $obj-&gt;<b>labels</b>()
           Create a label reader/writer object.

       $obj-&gt;<b>lineSeparator</b>( [&lt;STRING|'CR'|'LF'|'CRLF'&gt;] )
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>locker</b>()
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>messageInFile</b>($filename)
           Inherited, see "Internals" in Mail::Box::Dir

       $obj-&gt;<b>read</b>(%options)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>readMessageFilenames</b>($directory)
           Inherited, see "Internals" in Mail::Box::Dir

       $obj-&gt;<b>readMessages</b>(%options)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>storeMessage</b>($message)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>toBeThreaded</b>($messages)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>toBeUnthreaded</b>($messages)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>updateMessages</b>(%options)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>write</b>(%options)
           Inherited, see "Internals" in Mail::Box

       $obj-&gt;<b>writeMessages</b>(%options)
            -Option  --Defined in     --Default
             messages  Mail::Box        &lt;required&gt;
             renumber                   &lt;true&gt;

           messages =&gt; ARRAY
           renumber =&gt; BOOLEAN
             Permit  renumbering  of  message.  By default this is true, but for some unknown reason, you may be
             thinking that messages should not be renumbered.

   <b>Other</b> <b>methods</b>
       Extends "Other methods" in Mail::Box::Dir.

       $obj-&gt;<b>timespan2seconds</b>($time)
       Mail::Box::MH-&gt;<b>timespan2seconds</b>($time)
           Inherited, see "Other methods" in Mail::Box

   <b>Error</b> <b>handling</b>
       Extends "Error handling" in Mail::Box::Dir.

       $obj-&gt;<b>AUTOLOAD</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>addReport</b>($object)
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>defaultTrace</b>( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )
       Mail::Box::MH-&gt;<b>defaultTrace</b>( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>errors</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>log</b>( [$level, [$strings]] )
       Mail::Box::MH-&gt;<b>log</b>( [$level, [$strings]] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>logPriority</b>($level)
       Mail::Box::MH-&gt;<b>logPriority</b>($level)
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>logSettings</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>notImplemented</b>()
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>report</b>( [$level] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>reportAll</b>( [$level] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>trace</b>( [$level] )
           Inherited, see "Error handling" in Mail::Reporter

       $obj-&gt;<b>warnings</b>()
           Inherited, see "Error handling" in Mail::Reporter

   <b>Cleanup</b>
       Extends "Cleanup" in Mail::Box::Dir.

       $obj-&gt;<b>DESTROY</b>()
           Inherited, see "Cleanup" in Mail::Box

</pre><h4><b>DETAILS</b></h4><pre>
       Extends "DETAILS" in Mail::Box::Dir.

   <b>Different</b> <b>kinds</b> <b>of</b> <b>folders</b>
       Extends "Different kinds of folders" in Mail::Box::Dir.

   <b>Available</b> <b>folder</b> <b>types</b>
       Extends "Available folder types" in Mail::Box::Dir.

   <b>Folder</b> <b>class</b> <b>implementation</b>
       Extends "Folder class implementation" in Mail::Box::Dir.

   <b>How</b> <b>MH</b> <b>folders</b> <b>work</b>
       MH-type folders use a directory to store the messages of  one  folder.   Each  message  is  stored  in  a
       separate file.  This seems useful, because changes in a folder change only a few of these small files, in
       contrast with file-based folders where changes in a folder cause rewrites of huge folder files.

       However, MH-based folders perform very bad if you need header information of all messages.  For instance,
       if  you  want  to  have  full knowledge about all message-threads (see Mail::Box::Thread::Manager) in the
       folder, it requires to read all header lines in all message files.  And usually, reading your messages in
       threads is desired.

       So, each message is written in a separate file.  The filenames are numbers, which count from 1.  Next  to
       these message files, a directory may contain a file named ".mh_sequences", storing labels which relate to
       the  messages.   Furthermore,  a  folder-directory  may  contain  sub-directories, which are seen as sub-
       folders.

   <b>This</b> <b>implementation</b>
       This implementation supports the ".mh-sequences" file and sub-folders.  Next to this, considerable effort
       it made to avoid reading each message-file.  This should boost performance of  the  MailBox  distribution
       over other Perl-modules which are able to read folders.

       Folder  types  which  store  their  messages  each  in  one  file, together in one directory, are bad for
       performance.  Consider that you want to know the subjects of all messages, while browser through a folder
       with your mail-reading client.  This would cause all message-files to be read.

       Mail::Box::MH has two ways to try improve performance.  You can use an  index-file,  and  use  on  delay-
       loading.  The combination performs even better.  Both are explained in the next sections.

   <b>An</b> <b>index-file</b>
       If  you  specify  new(keep_index),  then all header-lines of all messages from the folder which have been
       read once, will also be written into one  dedicated  index-file  (one  file  per  folder).   The  default
       filename is ".index"

       However,  index-files are not supported by any other reader which supports MH (as far as I know).  If you
       read the folders with such I client, it will not cause unrecoverable conflicts with this index-file,  but
       at most be bad for performance.

       If you do not (want to) use an index-file, then delay-loading may save your day.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Error: Cannot append message without lock on $folder.
           It is impossible to append one or more messages to the folder which is not opened, because locking it
           fails.   The  folder  may  be  in  use  by an other application, or you may need to specify some lock
           related options (see <b>new()</b>).

       Error: Cannot create MH folder $name: $!
           For some reason, it is impossible to create the folder.  Check the permissions and the  name  of  the
           folder.  Does the path to the directory to be created exist?

       Error: Cannot write folder $name without lock.
           It  is impossible to get a lock on the folder, which means that the changes can not be made.  You may
           need to tune the lock related options which are available at folder creation.

       Warning: Changes not written to read-only folder $self.
           You have opened the folder read-only --which is the default set by new(access)--, made modifications,
           and now want to close it.  Set close(force) if you want to overrule the access  mode,  or  close  the
           folder with close(write) set to "NEVER".

       Error: Copying failed for one message.
           For  some  reason,  for  instance  disc  full, removed by external process, or read-protection, it is
           impossible to copy one of the messages.  Copying will proceed for the other messages.

       Error: Destination folder $name is not writable.
           The folder where the messages are copied to is not opened with write access (see new(access)).   This
           has no relation with write permission to the folder which is controlled by your operating system.

       Warning: Different messages with id $msgid
           The  message  id  is discovered more than once within the same folder, but the content of the message
           seems to be different.  This should not be possible: each message must be unique.

       Error: Folder $name is opened read-only
           You can not write to this folder  unless  you  have  opened  the  folder  to  write  or  append  with
           new(access), or the "force" option is set true.

       Error: Folder $name not deleted: not writable.
           The  folder  must be opened with write access via new(access), otherwise removing it will be refused.
           So, you may have write-access according to the operating system, but that will not automatically mean
           that this "delete" method permits you to.  The reverse remark is valid as well.

       Error: Invalid timespan '$timespan' specified.
           The string does not follow the strict rules of the time span syntax which is permitted as parameter.

       Warning: Message-id '$msgid' does not contain a domain.
           According to the RFCs, message-ids need to contain a unique random part, then  an  "@",  and  then  a
           domain  name.   This  is  made  to  avoid the creation of two messages with the same id.  The warning
           emerges when the "@" is missing from the string.

       Error: Package $package does not implement $method.
           Fatal error: the specific package (or one of its superclasses) does not implement this  method  where
           it  should.  This  message means that some other related classes do implement this method however the
           class at hand does not.  Probably you should investigate this and probably inform the author  of  the
           package.

       Error: Unable to create subfolder $name of $folder.
           The  copy  includes  the  subfolders,  but  for some reason it was not possible to copy one of these.
           Copying will proceed for all other sub-folders.

       Error: Unable to write message for $folder to $filename: $!
           The new message could not be written to its new file, for the specific reason.

       Error: Writing folder $name failed
           For some reason (you probably got more error messages about this problem) it is impossible  to  write
           the folder, although you should because there were changes made.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       This  module  is  part  of  Mail-Box  distribution  version  3.011,  built  on  April  18, 2025. Website:
       <u><a href="http://perl.overmeer.net/CPAN/">http://perl.overmeer.net/CPAN/</a></u>

</pre><h4><b>LICENSE</b></h4><pre>
       Copyrights 2001-2025 by [Mark Overmeer]. For other contributors see ChangeLog.

       This program is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself.  See <u><a href="http://dev.perl.org/licenses/">http://dev.perl.org/licenses/</a></u>

perl v5.40.1                                       2025-04-25                                 <u>Mail::Box::<a href="../man3pm/MH.3pm.html">MH</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>