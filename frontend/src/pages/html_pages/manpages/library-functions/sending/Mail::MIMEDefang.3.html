<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::MIMEDefang - email filtering milter</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/mimedefang">mimedefang_3.6-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::MIMEDefang - email filtering milter

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Mail::MIMEDefang is a framework for filtering e-mail.  It uses Sendmail's "Milter" API, some C glue code,
       and some Perl code to let you write high-performance mail filters in Perl.

       People use MIMEDefang to:

           Block viruses
           Block or tag spam
           Remove HTML mail parts
           Add boilerplate disclaimers to outgoing mail
           Remove or alter attachments
           Replace attachments with URL's
           Implement sophisticated access controls.

       You're limited only by your imagination. If you can think of it and code it in Perl, you can do it with
       MIMEDefang.

</pre><h4><b>METHODS</b></h4><pre>
       init_globals
           Initialize global variables used across MIMEDefang instance and filter.

       print_and_flush(text)
           Prints to stdout and flush buffer.

       md_openlog(tag, facility)
           Initialize e syslog object using Sys::Syslog or Unix::Syslog as appropriate.

       md_syslog(facility, msg)
           Prints a message to <b><a href="../man3/syslog.3.html">syslog</a></b>(3) using the specified facility

       md_graphdefang_log
           This  is  called  to  log  events  that occur during mimedefang processing.  It should be called from
           mimedefang-filter with appropriate event names and values.

           Possible examples:

           "md_graphdefang_log('virus',$VirusName,$filename);"

           "md_graphdefang_log('spam',$hits);"

           "md_graphdefang_log('bad_filename',$filename,$extension);"

           If you need to log UTF-8 strings you can call the sub as:

           "md_graphdefang_log('spam',$hits, undef, 1);"

       detect_and_load_perl_modules
           Automatically detect and load Perl modules needed for some features like  SpamAssassin,  rbl  checks,
           zip file listing and HTML parsing.

       detect_antivirus_support
           Check if antivirus support should be loaded by looking at %Features

       init_status_tag
           Open the status file descriptor

       set_status_tag(depth, tag)
           Sets the status tag for this worker inside the multiplexor.

       push_status_tag(tag)
           Updates status tag inside multiplexor and pushes onto stack.

       pop_status_tag
           Pops previous status of stack and sets tag in multiplexor.

       percent_encode(str)
           Encode a string with unsafe chars as "%XY" where X and Y are hex digits.

       percent_encode_for_graphdefang(str)
           Encode a string with unsafe chars as "%XY" where X and Y are hex digits.

           Quotes or spaces are not encoded but commas are encoded.

       percent_decode(str)
           Decode a string previously encoded by <b>percent_encode()</b>.

       write_result_line ( $cmd, @args )
           Writes a result line to the RESULTS file.

           $cmd should be a one-letter command for the RESULTS file

           @args  are  the arguments for $cmd, if any.  They will be <b>percent_encode()</b>'ed before being written to
           the file.

           Returns 0 or 1 and an optional warning message.

       signal_unchanged
           Tells mimedefang C program message has not been altered.

       signal_changed
           Tells mimedefang C program message has been altered.

       in_message_context(name)
           Returns 1 if we are processing a message; 0 otherwise.

       in_filter_wrapup(name)
           Returns 1 if we are not in filter wrapup; 0 otherwise.

       in_filter_context
           Returns 1 if we are inside filter or filter_multipart, 0 otherwise.

       in_filter_end(name)
           Returns 1 if we are inside filter_end 0 otherwise.

       send_quarantine_notifications
           Sends quarantine notification message, if anything was quarantined.

       signal_complete
           Tells mimedefang C program Perl filter has finished successfully.

           Also mails any quarantine notifications and sender notifications.

       send_mail(fromAddr, fromFull, recipient, body, deliverymode)
           Sends a mail message using Sendmail.

           Invokes Sendmail without involving the shell, so  that  shell  metacharacters  won't  cause  security
           problems.

           Delivery mode parameter is the optional sendmail delivery mode arg (default "-odd").

       send_multipart_mail(fromAddr, fromName, recipient, subject, body_text, body_html, extra_headers)
           Sends a multipart mail message using Sendmail.

           Invokes  Sendmail  without  involving  the  shell,  so that shell metacharacters won't cause security
           problems.

       send_admin_mail(subject, body)
           Sends a mail message to the administrator

       <b>read_commands_file()</b>
           This function should only be called from "filter_sender" and "filter_recipient". This will  read  the
           "COMMANDS"  file  (as  described  in  <b><a href="../man7/mimedefang-protocol.7.html">mimedefang-protocol</a></b>(7)),  and will fill or update the following
           global   variables:   $Sender,   @Recipients,    %RecipientMailers,    $RelayAddr,    $RealRelayAddr,
           $RelayHostname, $RealRelayHostname, $QueueID, $Helo, %SendmailMacros.

           If  you  do not call "read_commands_file", then the only information available in "filter_sender" and
           "filter_recipient" is that which is passed as an argument to the function.

   <b>SEE</b> <b>ALSO</b>
       <b>Mail::MIMEDefang::<a href="../man3/Actions.3.html">Actions</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/Antispam.3.html">Antispam</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/Antivirus.3.html">Antivirus</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/DKIM.3.html">DKIM</a></b>(3)

       <b>Mail::MIMEDefang::DKIM::<a href="../man3/ARC.3.html">ARC</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/Authres.3.html">Authres</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/Mail.3.html">Mail</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/MIME.3.html">MIME</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/Net.3.html">Net</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/RFC2822.3.html">RFC2822</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/Unit.3.html">Unit</a></b>(3)

       <b>Mail::MIMEDefang::<a href="../man3/Utils.3.html">Utils</a></b>(3)

3.6                                                2025-05-19                                <u>Mail::<a href="../man3/MIMEDefang.3.html">MIMEDefang</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>