<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>diameter_transport - Diameter transport interface.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/erlang-manpages">erlang-manpages_24.2.1+dfsg-1ubuntu0.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       diameter_transport - Diameter transport interface.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A  module  specified  as  a  <u>transport_module</u>  to  diameter:add_transport/2  must implement the interface
       documented here. The interface consists of a function with which diameter starts a transport process  and
       a  message  interface  with which the transport process communicates with the process that starts it (aka
       its parent).

</pre><h4><b>DATA</b> <b>TYPES</b></h4><pre>
         <u>message()</u> <u>=</u> <u>binary()</u> <u>|</u> <u>diameter_codec:packet()</u>:
           A Diameter message as passed over the transport interface.

           For an inbound message from a transport process, a diameter_codec:packet() must contain the  received
           message  in  its  <u>bin</u>  field.  In the case of an inbound request, any value set in the <u>transport_data</u>
           field will passed back to the transport module in the corresponding answer message, unless the sender
           supplies another value.

           For an outbound message to a transport process, a diameter_codec:packet()  has  a  value  other  than
           <u>undefined</u> in its <u>transport_data</u> field and has the binary() to send in its <u>bin</u> field.

</pre><h4><b>EXPORTS</b></h4><pre>
       <b>Mod:start({Type,</b> <b>Ref},</b> <b>Svc,</b> <b>Config)</b> <b>-&gt;</b> <b>{ok,</b> <b>Pid}</b> <b>|</b> <b>{ok,</b> <b>Pid,</b> <b>LAddrs}</b> <b>|</b> <b>{error,</b> <b>Reason}</b>

              Types:

                 Type = connect | accept
                 Ref = diameter:transport_ref()
                 Svc = #diameter_service{}
                 Config = term()
                 Pid = pid()
                 LAddrs = [inet:ip_address()]
                 Reason = term()

              Start   a   transport   process.   Called   by   diameter   as   a   consequence   of  a  call  to
              diameter:add_transport/2 in order to establish or accept a transport  connection  respectively.  A
              transport process maintains a connection with a single remote peer.

              <u>Type</u>  indicates  whether  the  transport  process  in  question  is being started for a connecting
              (<u>Type=connect</u>) or listening (<u>Type=accept</u>) transport. In the latter case, transport  processes  are
              started as required to accept connections from multiple peers.

              Ref  is  the  value  that  was returned from the call to diameter:add_transport/2 that has lead to
              starting of a transport process.

              <u>Svc</u> contains capabilities passed to diameter:start_service/2 and diameter:add_transport/2,  values
              passed to the latter overriding those passed to the former.

              <u>Config</u>  is  as  passed  in  <u>transport_config</u>  tuple in the diameter:transport_opt() list passed to
              diameter:add_transport/2.

              The start function should use the <u>Host-IP-Address</u> list in <u>Svc</u> and/or <u>Config</u> to select  and  return
              an  appropriate  list  of  local  IP addresses. In the connecting case, the local address list can
              instead be  communicated  in  a  <u>connected</u>  message  (see  MESSAGES  below)  following  connection
              establishment.  In either case, the local address list is used to populate <u>Host-IP-Address</u> AVPs in
              outgoing capabilities exchange messages if <u>Host-IP-Address</u> is unspecified.

              A transport process must implement the message interface documented below. It  should  retain  the
              pid  of its parent, monitor the parent and terminate if it dies. It should not link to the parent.
              It should exit if its transport connection with its peer is lost.

</pre><h4><b>MESSAGES</b></h4><pre>
       All messages sent over the transport interface are of the form <u>{diameter,</u> <u>term()}</u>.

       A transport process can expect messages of the following types from its parent.

         <u>{diameter,</u> <u>{send,</u> <u>message()</u> <u>|</u> <u>false}}</u>:
           An outbound Diameter message. The atom <u>false</u> can only be received when request acknowledgements  have
           been requests: see the <u>ack</u> message below.

         <u>{diameter,</u> <u>{close,</u> <u>Pid}}</u>:
           A  request  to  terminate  the  transport  process  after having received DPA in response to DPR. The
           transport process should exit. <u>Pid</u> is the pid() of the parent process.

         <u>{diameter,</u> <u>{tls,</u> <u>Ref,</u> <u>Type,</u> <u>Bool}}</u>:
           Indication of whether or not capabilities exchange has selected inband security using TLS. <u>Ref</u>  is  a
           reference()  that  must  be  included  in the <u>{diameter,</u> <u>{tls,</u> <u>Ref}}</u> reply message to the transport's
           parent process (see below). <u>Type</u> is either <u>connect</u> or <u>accept</u> depending on  whether  the  process  has
           been  started  for  a  connecting or listening transport respectively. <u>Bool</u> is a boolean() indicating
           whether or not the transport connection should be upgraded to TLS.

           If TLS is requested (<u>Bool=true</u>) then a connecting process should initiate a TLS  handshake  with  the
           peer  and an accepting process should prepare to accept a handshake. A successful handshake should be
           followed by a <u>{diameter,</u> <u>{tls,</u> <u>Ref}}</u> message to the parent process. A failed handshake  should  cause
           the process to exit.

           This  message  is  only  sent  to a transport process over whose <u>Inband-Security-Id</u> configuration has
           indicated support for TLS.

       A transport process should send messages of the following types to its parent.

         <u>{diameter,</u> <u>{self(),</u> <u>connected}}</u>:
           Inform the parent that the transport process with <u>Type=accept</u> has established a connection  with  the
           peer. Not sent if the transport process has <u>Type=connect</u>.

         <u>{diameter,</u> <u>{self(),</u> <u>connected,</u> <u>Remote}}</u>:

         <u>{diameter,</u> <u>{self(),</u> <u>connected,</u> <u>Remote,</u> <u>[LocalAddr]}}</u>:
           Inform  the  parent  that the transport process with <u>Type=connect</u> has established a connection with a
           peer. Not sent if the transport process has <u>Type=accept</u>. <u>Remote</u> is an arbitrary  term  that  uniquely
           identifies  the  remote  endpoint to which the transport has connected. A <u>LocalAddr</u> list has the same
           semantics as one returned from start/3.

         <u>{diameter,</u> <u>ack}</u>:
           Request acknowledgements of unanswered requests. A transport process should  send  this  once  before
           passing  incoming  Diameter  messages  into diameter. As a result, every Diameter request passed into
           diameter with a <u>recv</u> message (below) will be answered with a <u>send</u> message (above), either a message()
           for the transport process to send or the atom <u>false</u> if the request has been  discarded  or  otherwise
           not answered.

           This  is  to  allow a transport process to keep count of the number of incoming request messages that
           have not yet been answered or discarded, to allow it to regulate the amount of incoming traffic. Both
           diameter_tcp and diameter_sctp request acknowledgements when  a  <u>message_cb</u>  is  configured,  turning
           send/recv message into callbacks that can be used to regulate traffic.

         <u>{diameter,</u> <u>{recv,</u> <u>message()}}</u>:
           An inbound Diameter message.

         <u>{diameter,</u> <u>{tls,</u> <u>Ref}}</u>:
           Acknowledgment of a successful TLS handshake. <u>Ref</u> is the reference() received in the <u>{diameter,</u> <u>{tls,</u>
           <u>Ref,</u>  <u>Type,</u>  <u>Bool}}</u>  message  in  response  to  which  the  reply is sent. A transport must exit if a
           handshake is not successful.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3erl/diameter_tcp.3erl.html">diameter_tcp</a>(3erl), <a href="../man3erl/diameter_sctp.3erl.html">diameter_sctp</a>(3erl)

Ericsson AB                                      diameter 2.2.4                         <u><a href="../man3erl/diameter_transport.3erl.html">diameter_transport</a></u>(3erl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>