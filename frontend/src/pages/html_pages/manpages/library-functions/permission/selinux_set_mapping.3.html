<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>selinux_set_mapping - establish dynamic object class and permission mapping</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libselinux1-dev">libselinux1-dev_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       selinux_set_mapping - establish dynamic object class and permission mapping

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/selinux.h&gt;</b>

       struct security_class_mapping {
            const char *name;
            const char *perms[];
       };

       <b>int</b> <b>selinux_set_mapping(const</b> <b>struct</b> <b>security_class_mapping</b> <b>*</b><u>map</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>selinux_set_mapping</b>()  establishes  a  mapping  from  a  user-provided  ordering  of  object  classes and
       permissions to the  numbers  actually  used  by  the  loaded  system  policy.  If  using  this  function,
       applications should also set a <b>SELINUX_CB_POLICYLOAD</b> callback via <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a>(3)</b> that calls this
       function  again  upon  a  policy  reload  to re-create the mapping in case the class or permission values
       change in the new policy.  Generally it is preferred to instead use  <b><a href="../man3/selinux_check_access.3.html">selinux_check_access</a>(3)</b>  instead  of
       <b><a href="../man3/avc_has_perm.3.html">avc_has_perm</a>(3)</b> or <b><a href="../man3/security_compute_av.3.html">security_compute_av</a>(3)</b> and not use this function at all.

       After  the  mapping  is established, all libselinux functions that operate on class and permission values
       take the user-provided numbers, which are determined as follows:

       The <u>map</u> argument consists of an array of <b>security_class_mapping</b> structures, which must be terminated by a
       structure having a NULL name field.  Except for this last structure, the <u>name</u> field should refer  to  the
       string  name of an object class, and the corresponding <u>perms</u> field should refer to an array of permission
       bit names terminated by a NULL string.

       The object classes named in the mapping and the bit indexes of each set of permission bits named  in  the
       mapping  are  numbered  in  order starting from 1.  These numbers are the values that should be passed to
       subsequent libselinux calls.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Zero is returned on success.  On error, -1 is returned and <u>errno</u> is set appropriately.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EINVAL</b> One of the class or permission names requested in the mapping is not present in the loaded policy.

       <b>ENOMEM</b> An attempt to allocate memory failed.

</pre><h4><b>EXAMPLE</b></h4><pre>
              struct security_class_mapping map[] = {
                  { "file", { "create", "unlink", "read", "write", NULL } },
                  { "socket", { "bind", NULL } },
                  { "process", { "signal", NULL } },
                  { NULL }
              };

              if (<a href="../manmap/selinux_set_mapping.map.html">selinux_set_mapping</a>(map) &lt; 0)
                  <a href="../man1/exit.1.html">exit</a>(1);

       In this example, after the call has succeeded, classes <b>file</b>, <b>socket</b>, and <b>process</b> will be identified by 1,
       2 and 3, respectively.  Permissions <u>create</u>, <u>unlink</u>,  <u>read</u>,  and  <u>write</u>  (for  the  <b>file</b>  class)  will  be
       identified  by  1, 2, 4, and 8 respectively.  Classes and permissions not listed in the mapping cannot be
       used.

</pre><h4><b>AUTHOR</b></h4><pre>
       Originally Eamon Walsh.  Updated by Stephen Smalley &lt;<a href="mailto:stephen.smalley.work@gmail.com">stephen.smalley.work@gmail.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/selinux_check_access.3.html">selinux_check_access</a></b>(3), <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3), <b><a href="../man3/avc_has_perm.3.html">avc_has_perm</a></b>(3), <b><a href="../man8/selinux.8.html">selinux</a></b>(8)

                                                   12 Jun 2008                            <u><a href="../man3/selinux_set_mapping.3.html">selinux_set_mapping</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>