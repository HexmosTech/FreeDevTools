<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>io_uring_clone_buffers - Clones registered buffers between rings</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/liburing-dev">liburing-dev_2.11-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       io_uring_clone_buffers - Clones registered buffers between rings

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;liburing.h&gt;</b>

       <b>int</b> <b>io_uring_clone_buffers(struct</b> <b>io_uring</b> <b>*</b><u>dst</u><b>,</b>
                                  <b>struct</b> <b>io_uring</b> <b>*</b> <u>src</u><b>);</b>

       <b>int</b> <b>__io_uring_clone_buffers(struct</b> <b>io_uring</b> <b>*</b><u>dst</u><b>,</b>
                                    <b>struct</b> <b>io_uring</b> <b>*</b> <u>src</u><b>,</b>
                                    <b>unsigned</b> <b>int</b> <u>flags</u><b>);</b>

       <b>int</b> <b>io_uring_clone_buffers_offset(struct</b> <b>io_uring</b> <b>*</b><u>dst</u><b>,</b>
                                         <b>struct</b> <b>io_uring</b> <b>*</b> <u>src</u><b>,</b>
                                         <b>unsigned</b> <b>int</b> <u>dst_off</u><b>,</b>
                                         <b>unsigned</b> <b>int</b> <u>src_off</u><b>,</b>
                                         <b>unsigned</b> <b>int</b> <u>nr</u><b>,</b>
                                         <b>unsigned</b> <b>int</b> <u>flags</u><b>);</b>

       <b>int</b> <b>__io_uring_clone_buffers_offset(struct</b> <b>io_uring</b> <b>*</b><u>dst</u><b>,</b>
                                           <b>struct</b> <b>io_uring</b> <b>*</b> <u>src</u><b>,</b>
                                           <b>unsigned</b> <b>int</b> <u>dst_off</u><b>,</b>
                                           <b>unsigned</b> <b>int</b> <u>src_off</u><b>,</b>
                                           <b>unsigned</b> <b>int</b> <u>nr</u><b>,</b>
                                           <b>unsigned</b> <b>int</b> <u>flags</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b><a href="../man3/io_uring_clone_buffers.3.html">io_uring_clone_buffers</a></b>(3)  function  clones registered buffers from the ring indicated by <u>src</u> to the
       ring indicated by <u>dst</u>.  Upon successful completion of this operation, <u>src</u> and <u>dst</u> will have the same  set
       of registered buffers. This operation is identical to performing a <b><a href="../man3/io_uring_register_buffers.3.html">io_uring_register_buffers</a></b>(3) operation
       on the <u>dst</u> ring, if the <u>src</u> ring previously had that same buffer registration operating done.

       The  <u>dst</u>  ring must not have any buffers currently registered. If buffers are currently registered on the
       destination ring, they must be unregistered with <b><a href="../man3/io_uring_unregister_buffers.3.html">io_uring_unregister_buffers</a></b>(3) first.

       For <b><a href="../man3/__io_uring_clone_buffers.3.html">__io_uring_clone_buffers</a></b>(3)<b>,</b> the only difference is that it takes a <u>flags</u> argument.  By  default,  if
       the  destination  ring  has  a  registered  file  descriptor through <b><a href="../man3/io_uring_register_ring_fd.3.html">io_uring_register_ring_fd</a></b>(3) AND the
       calling application is not the thread that registered that ring, then the kernel doesn't know how to look
       up the destination. This is problematic as <b><a href="../man3/io_uring_clone_buffers.3.html">io_uring_clone_buffers</a></b>(3) defaults  to  using  the  registered
       index  if  the  destination  is  setup  as  such.   Use  <b><a href="../man3/__io_uring_clone_buffers.3.html">__io_uring_clone_buffers</a></b>(3)  which  doesn't  set
       <b>IORING_REGISTER_SRC_REGISTERED</b> by default. This requires the application to still have the original  ring
       file descriptor open. See below for the flag definition.

       Available since kernel 6.12.

       The  <b><a href="../man3/io_uring_clone_buffers_offset.3.html">io_uring_clone_buffers_offset</a></b>(3)  function  also  clones  buffers from the <u>src</u> ring to the <u>dst</u> ring,
       however it supports cloning only a subset of the buffers, where <b><a href="../man3/io_uring_clone_buffers.3.html">io_uring_clone_buffers</a></b>(3)  always  clones
       all of them.  <u>dst_off</u> indicates at what offset cloning should start in the destination, <u>src_off</u> indicates
       at  what  offset  cloning  should  start in the source, and <u>nr</u> indicates how many buffers to clone at the
       given offset. If both <u>dst_off</u>, <u>src_off</u>, and <u>nr</u> are given as  <b>0</b>  <b>,</b>  then  <b><a href="../man3/io_uring_clone_buffers_offset.3.html">io_uring_clone_buffers_offset</a></b>(3)
       performs the same action as <b><a href="../man3/io_uring_clone_buffers.3.html">io_uring_clone_buffers</a></b>(3)<b>.</b>

       While    <b><a href="../man3/io_uring_clone_buffers_offset.3.html">io_uring_clone_buffers_offset</a></b>(3)    sets    <b>IORING_REGISTER_SRC_REGISTERED</b>   by   default,   the
       <b><a href="../man3/__io_uring_clone_buffers_offset.3.html">__io_uring_clone_buffers_offset</a></b>(3) does not. See  the  explanation  for  <b><a href="../man3/__io_uring_clone_buffers.3.html">__io_uring_clone_buffers</a></b>(3)  for
       details.

       <u>flags</u> may be set to the following value:

       <b>IORING_REGISTER_SRC_REGISTERED</b>
              If  the source ring is registered AND the calling thread is the one that originally registered its
              ring fd, then this flag may be set to lookup the registered index rather than use the normal  file
              descriptor.  If  the normal file descriptor wasn't closed after registering it, there's no need to
              set this flag.

       <b>IORING_REGISTER_DST_REPLACE</b>
              If set, cloning may happen for a destination ring that already has a  buffer  table  assigned.  In
              that   case,  existing  nodes  that  overlap  with  the  specified  range  will  be  released  and
              replaced.IORING_REGISTER_DST_REPLACE If set, cloning  may  happen  for  a  destination  ring  that
              already  has a buffer table assigned. In that case, existing nodes that overlap with the specified
              range will be released and replaced.

       Available since kernel 6.13.

</pre><h4><b>NOTES</b></h4><pre>
       The source and target ring must shared address spaces, and hence internal kernel accounting.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success <b><a href="../man3/io_uring_clone_buffers.3.html">io_uring_clone_buffers</a></b>(3) and <b><a href="../man3/io_uring_clone_buffers_offset.3.html">io_uring_clone_buffers_offset</a></b>(3) return  0.   On  failure,  they
       returns <b>-errno</b>, specifically

       <b>-EBUSY</b> The destination ring already has buffers registered, and <b>IORING_REGISTER_DST_REPLACE</b> wasn't set.

       <b>-ENOMEM</b>
              The kernel ran out of memory.

       <b>-ENXIO</b> The source ring doesn't have any buffers registered.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/io_uring_register.2.html">io_uring_register</a></b>(2),            <b><a href="../man3/io_uring_unregister_buffers.3.html">io_uring_unregister_buffers</a></b>(3),            <b><a href="../man3/io_uring_register_buffers.3.html">io_uring_register_buffers</a></b>(3),
       <b><a href="../man3/io_uring_prep_read_fixed.3.html">io_uring_prep_read_fixed</a></b>(3), <b><a href="../man3/io_uring_prep_write_fixed.3.html">io_uring_prep_write_fixed</a></b>(3)

liburing-2.9                                   September 12, 2024                      <u><a href="../man3/io_uring_clone_buffers.3.html">io_uring_clone_buffers</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>