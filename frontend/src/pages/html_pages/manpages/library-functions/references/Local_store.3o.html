<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local_store  -  This  module provides some facilities for creating references (and hash tables) which can</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ocaml-man">ocaml-man_5.3.0-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Local_store  -  This  module provides some facilities for creating references (and hash tables) which can
       easily be snapshotted and restored to an arbitrary version.

</pre><h4><b>Module</b></h4><pre>
       Module   Local_store

</pre><h4><b>Documentation</b></h4><pre>
       Module <b>Local_store</b>
        : <b>sig</b> <b>end</b>

       This module provides some facilities for creating references  (and  hash  tables)  which  can  easily  be
       snapshotted and restored to an arbitrary version.

       It  is  used  throughout  the  frontend (read: typechecker), to register all (well, hopefully) the global
       state. Thus making it easy for tools like Merlin to go back and forth typechecking different files.

   <b>Creators</b>
       <u>val</u> <u>s_ref</u> : <b>'a</b> <b>-&gt;</b> <b>'a</b> <b>ref</b>

       Similar to <b>ref</b> , except the allocated reference is registered into the store.

       <u>val</u> <u>s_table</u> : <b>('a</b> <b>-&gt;</b> <b>'b)</b> <b>-&gt;</b> <b>'a</b> <b>-&gt;</b> <b>'b</b> <b>ref</b>

       Used to register hash tables. Those also need to be placed into refs to be easily swapped  out,  but  one
       can't just "snapshot" the initial value to create fresh instances, so instead an initializer is required.

       Use it like this:
             <b>let</b> <b>my_table</b> <b>=</b> <b>s_table</b> <b>Hashtbl.create</b> <b>42</b>

   <b>State</b> <b>management</b>
       Note: all the following functions are currently unused inside the compiler codebase. Merlin is their only
       user at the moment.

       <u>type</u> <u>store</u>

       <u>val</u> <u>fresh</u> : <b>unit</b> <b>-&gt;</b> <b>store</b>

       Returns a fresh instance of the store.

       The  first  time  this function is called, it snapshots the value of all the registered references, later
       calls to <b>fresh</b> will return instances initialized to those values.

       <u>val</u> <u>with_store</u> : <b>store</b> <b>-&gt;</b> <b>(unit</b> <b>-&gt;</b> <b>'a)</b> <b>-&gt;</b> <b>'a</b>

       <b>with_store</b> <b>s</b> <b>f</b> resets all the registered references to the value they have in <b>s</b> for the run of <b>f</b> .  If  <b>f</b>
       updates any of the registered refs, <b>s</b> is updated to remember those changes.

       <u>val</u> <u>reset</u> : <b>unit</b> <b>-&gt;</b> <b>unit</b>

       Resets  all  the  references  to  the  initial snapshot (i.e. to the same values that new instances start
       with).

       <u>val</u> <u>is_bound</u> : <b>unit</b> <b>-&gt;</b> <b>bool</b>

       Returns <b>true</b> when a store is active (i.e. when called from the callback passed to  <b>Local_store.with_store</b>
       ), <b>false</b> otherwise.

OCamldoc                                           2025-06-12                                    <u><a href="../man3o/Local_store.3o.html">Local_store</a></u>(3o)
</pre>
 </div>
</div></section>
</div>
</body>
</html>