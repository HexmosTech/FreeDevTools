<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::Nessus::XMLRPC - Communicate with Nessus scanner(v4.2+) via XMLRPC</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-nessus-xmlrpc-perl">libnet-nessus-xmlrpc-perl_0.30-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::Nessus::XMLRPC - Communicate with Nessus scanner(v4.2+) via XMLRPC

</pre><h4><b>VERSION</b></h4><pre>
       Version 0.30

</pre><h4><b>SYNOPSIS</b></h4><pre>
       This is Perl interface for communication with Nessus scanner over XMLRPC.  You can start, stop, pause and
       resume scan. Watch progress and status of scan, download report, etc.

               use Net::Nessus::XMLRPC;

               # '' is same as https://localhost:8834/
               my $n = Net::Nessus::XMLRPC-&gt;new ('','user','pass');

               die "Cannot login to: ".$n-&gt;nurl."\n" unless ($n-&gt;logged_in);

               print "Logged in\n";
               my $polid=$n-&gt;policy_get_first;
               print "Using policy ID: $polid ";
               my $polname=$n-&gt;policy_get_name($polid);
               print "with name: $polname\n";
               my $scanid=$n-&gt;scan_new($polid,"perl-test","127.0.0.1");

               while (not $n-&gt;scan_finished($scanid)) {
                       print "$scanid: ".$n-&gt;scan_status($scanid)."\n";
                       sleep 15;
               }
               print "$scanid: ".$n-&gt;scan_status($scanid)."\n";
               my $reportcont=$n-&gt;report_file_download($scanid);
               my $reportfile="report.xml";
               open (FILE,"&gt;$reportfile") or die "Cannot open file $reportfile: $!";
               print FILE $reportcont;
               close (FILE);

</pre><h4><b>NOTICE</b></h4><pre>
       This CPAN module uses LWP for communicating with Nessus over XMLRPC via https.  Therefore, make sure that
       you have Net::SSL (provided by Crypt::SSLeay): <a href="http://search.cpan.org/perldoc">http://search.cpan.org/perldoc</a>?Crypt::SSLeay or
       IO::Socket::SSL: <a href="http://search.cpan.org/perldoc">http://search.cpan.org/perldoc</a>?IO::Socket::SSL

       If you think you have login problems, check this first!

</pre><h4><b>METHODS</b></h4><pre>
   <b>new</b> <b>([$nessus_url],</b> <b>[$user],</b> <b>[$pass])</b>
       creates new object Net::Nessus::XMLRPC

   <b>DESTROY</b>
       destructor, calls logout method on destruction

   <b>nurl</b> <b>(</b> <b>[$nessus_url]</b> <b>)</b>
       get/set Nessus base URL

   <b>token</b> <b>(</b> <b>[$nessus_token]</b> <b>)</b>
       get/set Nessus login token

   <b>nessus_http_request</b> <b>(</b> <b>$uri,</b> <b>$post_data</b> <b>)</b>
       low-level function, makes HTTP request to Nessus URL

   <b>nessus_request</b> <b>($uri,</b> <b>$post_data)</b>
       low-level function, makes XMLRPC request to Nessus URL and returns XML

   <b>login</b> <b>(</b> <b>$user,</b> <b>$password</b> <b>)</b>
       login to Nessus server via $user and $password

   <b>logout</b>
       logout from Nessus server

   <b>logged_in</b>
       returns true if we're logged in

   <b>scan_new</b> <b>(</b> <b>$policy_id,</b> <b>$scan_name,</b> <b>$targets</b> <b>)</b>
       initiates new scan

   <b>scan_new_file</b> <b>(</b> <b>$policy_id,</b> <b>$scan_name,</b> <b>$targets,</b> <b>$filename</b> <b>)</b>
       initiates new scan with hosts from file named $filename

   <b>scan_stop</b> <b>(</b> <b>$scan_id</b> <b>)</b>
       stops the scan identified by $scan_id

   <b>scan_stop_all</b>
       stops all scans

   <b>scan_pause</b> <b>(</b> <b>$scan_id</b> <b>)</b>
       pauses the scan identified by $scan_id

   <b>scan_pause_all</b>
       pauses all scans

   <b>scan_resume</b> <b>(</b> <b>$scan_id</b> <b>)</b>
       resumes the scan identified by $scan_id

   <b>scan_resume_all</b>
       resumes all scans

   <b>scan_list_uids</b>
       returns array of IDs of (active) scans

   <b>scan_get_name</b> <b>(</b> <b>$uuid</b> <b>)</b>
       returns name of the scan identified by $uuid

   <b>scan_status</b> <b>(</b> <b>$uuid</b> <b>)</b>
       returns status of the scan identified by $uuid

   <b>scan_finished</b> <b>(</b> <b>$uuid</b> <b>)</b>
       returns true if scan is finished/completed (identified by $uuid)

   <b>nessus_http_upload_request</b> <b>(</b> <b>$uri,</b> <b>$post_data</b> <b>)</b>
       low-level function, makes HTTP upload request to URI specified

   <b>file_upload</b> <b>(</b> <b>$filename</b> <b>)</b>
       uploads $filename to nessus server, returns filename of file uploaded or '' if failed

       Note that uploaded file is per session (i.e. it will be there until logout/attack.)  So, don't logout or
       login again and use the filename! You need to upload it again!

   <b>upload</b> <b>(</b> <b>$filename,</b> <b>$content</b> <b>)</b>
       uploads $filename to nessus server using $content as content of file, returns filename of file uploaded
       or '' if failed

       Note that uploaded file is per session (i.e. it will be there until logout/attack.)  So, don't logout or
       login again and use the filename! You need to upload it again!

   <b>policy_get_first</b>
       returns policy id for the first policy found

   <b>policy_get_firsth</b>
       returns ref to hash %value with basic info of first policy/scan returned by the server

       $value{'id'}, $value{'name'}, $value{'owner'}, $value{'visibility'}, $value{'comment'}

   <b>policy_list_hash</b>
       returns ref to array of hashes %value with basic info of first policy/scan returned by the server

       $value{'id'}, $value{'name'}, $value{'owner'}, $value{'visibility'}, $value{'comment'}

   <b>policy_list_uids</b>
       returns ref to array of IDs of policies available

   <b>policy_list_names</b>
       returns ref to array of names of policies available

   <b>policy_get_info</b> <b>(</b> <b>$policy_id</b> <b>)</b>
       returns ref to hash %value with basic info of policy/scan identified by $policy_id

       $value{'id'}, $value{'name'}, $value{'owner'}, $value{'visibility'}, $value{'comment'}

   <b>policy_get_id</b> <b>(</b> <b>$policy_name</b> <b>)</b>
       returns ID of the scan/policy identified by $policy_name

   <b>policy_get_name</b> <b>(</b> <b>$policy_id</b> <b>)</b>
       returns name of the scan/policy identified by $policy_id

   <b>policy_delete</b> <b>(</b> <b>$policy_id</b> <b>)</b>
       delete policy identified by $policy_id

   <b>policy_copy</b> <b>(</b> <b>$policy_id</b> <b>)</b>
       copy policy identified by $policy_id, returns $policy_id of new copied policy

   <b>policy_rename</b> <b>(</b> <b>$policy_id,</b> <b>$policy_name</b> <b>)</b>
       rename policy to $policy_name identified by $policy_id

   <b>policy_edit</b> <b>(</b> <b>$policy_id,</b> <b>$params</b> <b>)</b>
       edit policy identified by $policy_id

       %params (must be present): policy_name =&gt; name policy_shared =&gt; 1

       %params can be (examples) max_hosts =&gt; 50, max_checks=&gt; 10, use_mac_addr =&gt; no, throttle_scan =&gt; yes,
       optimize_test =&gt; yes, log_whole_attack =&gt; no, ssl_cipher_list =&gt; strong, save_knowledge_base =&gt; no,
       port_range =&gt; 1-65535

   <b>policy_new</b> <b>(</b> <b>$params</b> <b>)</b>
       create new policy with $params, %params must be present: policy_name policy_shared

       the others parameters are same as policy_edit

   <b>policy_get_opts</b> <b>(</b> <b>$policy_id</b> <b>)</b>
       returns hashref with different options for policy identified by $policy_id

   <b>policy_set_opts</b> <b>(</b> <b>$policy_id</b> <b>,</b> <b>$params</b> <b>)</b>
       sets policy options via hashref $params identified by $policy_id

   <b>report_list_uids</b>
       returns ref to array of IDs of reports available

   <b>report_list_hash</b>
       returns ref to array of hashes with basic info of reports hash has following keys: name status
       readableName timestamp

   <b>report_file_download</b> <b>($report_id)</b>
       returns XML report identified by $report_id (Nessus XML v2)

   <b>report_file1_download</b> <b>($report_id)</b>
       returns XML report identified by $report_id (Nessus XML v1)

   <b>report_delete</b> <b>($report_id)</b>
       delete report identified by $report_id

   <b>report_import</b> <b>(</b> <b>$filename</b> <b>)</b>
       tells nessus server to import already uploaded file named $filename ( i.e. you already uploaded the file
       via <b>file_upload()</b> )

   <b>report_import_file</b> <b>(</b> <b>$filename</b> <b>)</b>
       uploads $filename to nessus server and imports it as nessus report

   <b>users_list</b>
       returns ref to array of hash %values with users info $values{'name'} $values{'admin'}
       $values{'lastlogin'}

   <b>users_delete</b> <b>(</b> <b>$login</b> <b>)</b>
       deletes user with $login

   <b>users_add</b> <b>(</b> <b>$login,</b> <b>$password</b> <b>)</b>
       deletes user with $login and $password, return username created, '' if not

   <b>users_passwd</b> <b>(</b> <b>$login,</b> <b>$password</b> <b>)</b>
       change user password to $password identified with $login, return username, '' if not

</pre><h4><b>AUTHOR</b></h4><pre>
       Vlatko Kosturjak, "&lt;kost at linux.hr&gt;"

</pre><h4><b>BUGS</b></h4><pre>
       Please report any bugs or feature requests to "bug-net-nessus-xmlrpc at rt.cpan.org", or through the web
       interface at &lt;<a href="http://rt.cpan.org/NoAuth/ReportBug.html">http://rt.cpan.org/NoAuth/ReportBug.html</a>?Queue=Net-Nessus-XMLRPC&gt;.  I will be notified, and
       then you'll automatically be notified of progress on your bug as I make changes.

</pre><h4><b>SUPPORT</b></h4><pre>
       You can find documentation for this module with the perldoc command.

           perldoc Net::Nessus::XMLRPC

       You can also look for information at:

       •   RT: CPAN's request tracker

           &lt;<a href="http://rt.cpan.org/NoAuth/Bugs.html">http://rt.cpan.org/NoAuth/Bugs.html</a>?Dist=Net-Nessus-XMLRPC&gt;

       •   AnnoCPAN: Annotated CPAN documentation

           &lt;<a href="http://annocpan.org/dist/Net-Nessus-XMLRPC">http://annocpan.org/dist/Net-Nessus-XMLRPC</a>&gt;

       •   CPAN Ratings

           &lt;<a href="http://cpanratings.perl.org/d/Net-Nessus-XMLRPC">http://cpanratings.perl.org/d/Net-Nessus-XMLRPC</a>&gt;

       •   Search CPAN

           &lt;<a href="http://search.cpan.org/dist/Net-Nessus-XMLRPC">http://search.cpan.org/dist/Net-Nessus-XMLRPC</a>&gt;

</pre><h4><b>REPOSITORY</b></h4><pre>
       Repository is available on GitHub: <a href="http://github.com/kost/nessus-xmlrpc-perl">http://github.com/kost/nessus-xmlrpc-perl</a>

</pre><h4><b>ACKNOWLEDGEMENTS</b></h4><pre>
       I have made Ruby library as well: <a href="http://nessus-xmlrpc.rubyforge.org/">http://nessus-xmlrpc.rubyforge.org/</a>

       There you can find some early documentation about XMLRPC protocol used.

</pre><h4><b>COPYRIGHT</b> <b>&amp;</b> <b>LICENSE</b></h4><pre>
       Copyright 2010 Vlatko Kosturjak, all rights reserved.

       This  program  is  free  software;  you can redistribute it and/or modify it under the same terms as Perl
       itself.

perl v5.40.1                                       2025-05-03                           <u>Net::Nessus::<a href="../man3pm/XMLRPC.3pm.html">XMLRPC</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>