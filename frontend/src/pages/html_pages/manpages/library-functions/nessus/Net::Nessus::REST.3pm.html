<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::Nessus::REST - REST interface for Nessus 6.0</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-nessus-rest-perl">libnet-nessus-rest-perl_0.7.0-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::Nessus::REST - REST interface for Nessus 6.0

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module provides a Perl interface for communication with Nessus scanner using REST interface.

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Net::Nessus::REST;

           my $nessus = Net::Nessus::REST-&gt;new(
               url =&gt; 'https://my.nessus:8834'
           ):

           $nessus-&gt;create_session(
               username =&gt; 'user',
               password =&gt; 's3cr3t',
           );

           my $policy_template_id = $nessus-&gt;get_template_id(
               name =&gt; 'basic',
               type =&gt; 'policy'
           );

           my $scan = $nessus-&gt;create_scan(
               uuid     =&gt; $policy_template_id,
               settings =&gt; {
                   text_targets =&gt; '127.0.0.1',
                   name         =&gt; 'localhost scan'
               }
           );

           $nessus-&gt;launch_scan(scan_id =&gt; $scan-&gt;{id});
           while ($nessus-&gt;get_scan_status(scan_id =&gt; $scan-&gt;{id}) ne 'completed') {
               sleep 10;
           }

           my $file_id = $nessus-&gt;export_scan(
               scan_id =&gt; $scan-&gt;{id},
               format  =&gt; 'pdf'
           );

           while ($nessus-&gt;get_scan_export_status(
               scan_id =&gt; $scan-&gt;{id},
               file_id =&gt; $file_id
           ) ne 'ready') {
               sleep 1;
           }

           $nessus-&gt;download_scan(
               scan_id  =&gt; $scan-&gt;{id},
               file_id  =&gt; $file_id,
               filename =&gt; 'localhost.pdf'
           );

</pre><h4><b>CLASS</b> <b>METHODS</b></h4><pre>
   <b>Net::Nessus::REST-&gt;new(url</b> <b>=&gt;</b> <b>$url,</b> <b>[ssl_opts</b> <b>=&gt;</b> <b>$opts,</b> <b>timeout</b> <b>=&gt;</b> <b>$timeout])</b>
       Creates a new Net::Nessus::Rest instance.

</pre><h4><b>INSTANCE</b> <b>METHODS</b></h4><pre>
   <b>$nessus-&gt;create_session(username</b> <b>=&gt;</b> <b>$username,</b> <b>password</b> <b>=&gt;</b> <b>$password)</b>
       Creates a new session token for the given user.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/session/create&gt; for details.

   <b>$nessus-&gt;destroy_session()</b>
       Logs the current user out and destroys the session.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/session/destroy&gt; for details.

   <b>$nessus-&gt;list_policies()</b>
       Returns the policy list.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/policies/list&gt; for details.

   <b>$nessus-&gt;get_policy_id(name</b> <b>=&gt;</b> <b>$name)</b>
       Returns the identifier for the policy with given name.

   <b>$nessus-&gt;get_policy_details(id</b> <b>=&gt;</b> <b>$policy_id)</b>
       Returns a reference to a hash with all settings and parameters for a given scan policy.

       See &lt;https://your.nessus.server:8834/api#/resources/policies/details&gt; for details.

   <b>$nessus-&gt;import_policy(file</b> <b>=&gt;</b> <b>$file_id)</b>
       Returns reference to hash with name and identifier of the policy imported.  NB $file_id must be a valid
       identifier to a file uploaded to the Nessus server, e.g. with method <b>file_upload()</b>

       Example: $result = $nessus-&gt;import_policy(file =&gt; $fileuploaded); print "Policy imported: " .
       $result-&gt;{'name'} . "\n";

       See &lt;https://your.nessus.server:8834/api#/resources/policies/import&gt; for details.

   <b>$nessus-&gt;delete_policy(id</b> <b>=&gt;</b> <b>$policy_id)</b>
       Deletes a given scan policy off the Nessus server

       See &lt;https://your.nessus.server:8834/api#/resources/policies/delete&gt; for details.

   <b>$nessus-&gt;configure_policy(id</b> <b>=&gt;</b> <b>$policy_id,</b> <b>uuid</b> <b>=&gt;</b> <b>$uuid,</b> <b>settings</b> <b>=&gt;</b> <b>$settings)</b>
       See &lt;https://your.nessus.server:8834/api#/resources/policies/configure&gt; for details.

   <b>$nessus-&gt;create_policy(uuid</b> <b>=&gt;</b> <b>$uuid,</b> <b>settings</b> <b>=&gt;</b> <b>$settings)</b>
       See &lt;https://your.nessus.server:8834/api#/resources/policies/create&gt; for details.

   <b>$nessus-&gt;list_scanners()</b>
       Returns the scanner list.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scanners/list&gt; for details.

   <b>$nessus-&gt;list_folders()</b>
       Returns the current user's scan folders.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/folders/list&gt; for details.

   <b>$nessus-&gt;get_folder_id(name</b> <b>=&gt;</b> <b>$name)</b>
       Returns the identifier for the folder with given name.

   <b>$nessus-&gt;create_scan(uuid</b> <b>=&gt;</b> <b>$uuid,</b> <b>settings</b> <b>=&gt;</b> <b>$settings)</b>
       Creates a scan

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/create&gt; for details.

   <b>$nessus-&gt;configure_scan(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>uuid</b> <b>=&gt;</b> <b>$uuid,</b> <b>settings</b> <b>=&gt;</b> <b>$settings)</b>
       Changes the schedule or policy parameters of a scan.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/configure&gt; for details.

   <b>$nessus-&gt;delete_scan(scan_id</b> <b>=&gt;</b> <b>$scan_id)</b>
       Deletes a scan.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/delete&gt; for details.

   <b>$nessus-&gt;delete_scan_history(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>history_id</b> <b>=&gt;</b> <b>$history_id)</b>
       Deletes historical results from a scan.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/delete-history&gt; for details.

   <b>$nessus-&gt;download_scan(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>file_id</b> <b>=&gt;</b> <b>$file_id,</b> <b>filename</b> <b>=&gt;</b> <b>$filename)</b>
       Download an exported scan.  Without filename parameter it will return the content of the file.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/download&gt; for details.

   <b>$nessus-&gt;export_scan(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>format</b> <b>=&gt;</b> <b>$format)</b>
       Export the given scan.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/export&gt; for details.

   <b>$nessus-&gt;launch_scan(scan_id</b> <b>=&gt;</b> <b>$scan_id)</b>
       Launches a scan.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/launch&gt; for details.

   <b>$nessus-&gt;list_scans([folder_id</b> <b>=&gt;</b> <b>$id,</b> <b>last_modification_date</b> <b>=&gt;</b> <b>$date])</b>
       Returns the scan list.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/list&gt; for details.

   <b>$nessus-&gt;set_scan_read_status(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>status</b> <b>=&gt;</b> <b>$status)</b>
       Changes the status of a scan.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/read-status&gt; for details.

   <b>$nessus-&gt;get_scan_details(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>[history_id</b> <b>=&gt;</b> <b>$history_id])</b>
       Returns details for the given scan.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/details&gt; for details.

   <b>$nessus-&gt;get_scan_host_details(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>host_id</b> <b>=&gt;</b> <b>$host_id,</b> <b>[history_id</b> <b>=&gt;</b> <b>$history_id])</b>
       Returns details for the given host.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/host-details&gt; for details.

   <b>$nessus-&gt;get_scan_export_status(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>file_id</b> <b>=&gt;</b> <b>$file_id)</b>
       Check the file status of an exported scan.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/export-status&gt; for details.

   <b>$nessus-&gt;get_scan_plugin_output(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>host_id</b> <b>=&gt;</b> <b>$host_id,</b> <b>plugin_id</b> <b>=&gt;</b> <b>$plugin_id,</b>
       <b>[history_id</b> <b>=&gt;</b> <b>$history_id])</b>
       Returns the output for a given plugin.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/plugin-output&gt; for details.

   <b>$nessus-&gt;get_scan_id(name</b> <b>=&gt;</b> <b>$name)</b>
       Returns the identifier for the scan with given name.

   <b>$nessus-&gt;get_scan_status(scan_id</b> <b>=&gt;</b> <b>$scan_id)</b>
       Returns the status for given scan.

   <b>$nessus-&gt;get_scan_history_id(scan_id</b> <b>=&gt;</b> <b>$scan_id,</b> <b>scan_uuid</b> <b>=&gt;</b> <b>$scan_uuid)</b>
       Returns the identifier for the historical results for given scan and run.

   <b>$nessus-&gt;list_templates(type</b> <b>=&gt;</b> <b>$type)</b>
       Returns the template list.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/editor/list&gt; for details.

   <b>$nessus-&gt;get_template_id(type</b> <b>=&gt;</b> <b>$type,</b> <b>name</b> <b>=&gt;</b> <b>$name)</b>
       Returns the identifier for template with given name.

   <b>$nessus-&gt;get_plugin_details(</b> <b>id</b> <b>=&gt;</b> <b>$plugin_id</b> <b>)</b>
       returns the details of a plugin

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/plugins/plugin-details&gt; for details.

   <b>$nessus-&gt;list_plugin_families(</b> <b>)</b>
       returns a list of plugin families

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/plugins/families&gt; for details.

   <b>$nessus-&gt;get_plugin_family_details(</b> <b>id</b> <b>=&gt;</b> <b>$family_id</b> <b>)</b>
       returns the details about a plugin family

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/plugins/family-details&gt; for details.

   <b>$nessus-&gt;get_scanner_id(</b> <b>name</b> <b>=&gt;</b> <b>$name</b> <b>)</b>
       returns the identifier for the scanner with given name.

   <b>$nessus-&gt;file_upload(file</b> <b>=&gt;</b> <b>$file)</b>
       Uploads a file to the Nessus server.  Returns a reference to hash with identifier to the uploaded file.

       Example: my $result = $nessus-&gt;file_upload(file =&gt; $file); my $fileuploaded = $result-&gt;{'fileuploaded'};

       See &lt;https://your.nessus.server:8834/api#/resources/file/upload&gt; for details.

   <b>$nessus-&gt;stop_scan(scan_id</b> <b>=&gt;</b> <b>$scan_id</b> <b>)</b>
       Returns details for the given scan.

       See &lt;https://your.nessus.server:8834/nessus6-api.html#/resources/scans/stop&gt; for details.

</pre><h4><b>LICENSE</b></h4><pre>
       This program is free software: you can redistribute it and/or modify it under the terms of the GNU
       General Public License as published by the Free Software Foundation, either version 3 of the License, or
       (at your option) any later version.

       This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with this program.  If not, see
       &lt;<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.

perl v5.36.0                                       2022-10-13                             <u>Net::Nessus::<a href="../man3pm/REST.3pm.html">REST</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>