<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tk_CreateItemType, Tk_GetItemTypes - define new kind of canvas item</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tk9.0-doc">tk9.0-doc_9.0.1-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Tk_CreateItemType, Tk_GetItemTypes - define new kind of canvas item

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tk.h&gt;</b>

       <b>Tk_CreateItemType</b>(<u>typePtr</u>)

       Tk_ItemType *
       <b>Tk_GetItemTypes</b>()

</pre><h4><b>ARGUMENTS</b></h4><pre>
       Tk_ItemType <u>*typePtr</u> (in)          Structure that defines the new type of canvas item.  Note that this is
                                          not <u>const</u>; Tk may write to these structures.
________________________________________________________________________________________________________________

</pre><h4><b>INTRODUCTION</b></h4><pre>
       <b>Tk_CreateItemType</b>  is  invoked to define a new kind of canvas item described by the <u>typePtr</u> argument.  An
       item type corresponds to a particular value of the  <u>type</u>  argument  to  the  <b>create</b>  widget  command  for
       canvases,  and  the code that implements a canvas item type is called a <u>type</u> <u>manager</u>.  Tk defines several
       built-in item types, such as <b>rectangle</b> and <b>text</b> and <b>image</b>, but <b>Tk_CreateItemType</b> allows  additional  item
       types  to  be  defined.  Once <b>Tk_CreateItemType</b> returns, the new item type may be used in new or existing
       canvas widgets just like the built-in item types.

       <b>Tk_GetItemTypes</b> returns a pointer to the first in the list  of  all  item  types  currently  defined  for
       canvases.   The entries in the list are linked together through their <u>nextPtr</u> fields, with the end of the
       list marked by a NULL <u>nextPtr</u>.

       You may find it easier to understand the rest of this manual entry by looking at the code for an existing
       canvas item type such as bitmap (in the file tkCanvBmap.c) or text (tkCanvText.c).  The  easiest  way  to
       create a new type manager is to copy the code for an existing type and modify it for the new type.

       Tk  provides  a number of utility procedures for the use of canvas type managers, such as <b>Tk_CanvasCoords</b>
       and <b>Tk_CanvasPsColor</b>; these are described in separate manual entries.

</pre><h4><b>DATA</b> <b>STRUCTURES</b></h4><pre>
       A type manager consists of a collection of procedures that provide a standard set of operations on  items
       of that type.  The type manager deals with three kinds of data structures.  The first data structure is a
       Tk_ItemType; it contains information such as the name of the type and pointers to the standard procedures
       implemented by the type manager:

              typedef struct Tk_ItemType {
                  const char *<u>name</u>;
                  Tcl_Size <u>itemSize</u>;
                  Tk_ItemCreateProc *<u>createProc</u>;
                  const Tk_ConfigSpec *<u>configSpecs</u>;
                  Tk_ItemConfigureProc *<u>configProc</u>;
                  Tk_ItemCoordProc *<u>coordProc</u>;
                  Tk_ItemDeleteProc *<u>deleteProc</u>;
                  Tk_ItemDisplayProc *<u>displayProc</u>;
                  int <u>flags</u>;
                  Tk_ItemPointProc *<u>pointProc</u>;
                  Tk_ItemAreaProc *<u>areaProc</u>;
                  Tk_ItemPostscriptProc *<u>postscriptProc</u>;
                  Tk_ItemScaleProc *<u>scaleProc</u>;
                  Tk_ItemTranslateProc *<u>translateProc</u>;
                  Tk_ItemIndexProc *<u>indexProc</u>;
                  Tk_ItemCursorProc *<u>icursorProc</u>;
                  Tk_ItemSelectionProc *<u>selectionProc</u>;
                  Tk_ItemInsertProc *<u>insertProc</u>;
                  Tk_ItemDCharsProc *<u>dCharsProc</u>;
                  struct Tk_ItemType *<u>nextPtr</u>;
                  Tk_ItemRotateProc *<u>rotateProc</u>;                                                                 2
              } <b>Tk_ItemType</b>;

       The  fields  of  a  Tk_ItemType  structure are described in more detail later in this manual entry.  When
       <b>Tk_CreateItemType</b> is called, its <u>typePtr</u> argument must point to  a  structure  with  all  of  the  fields
       initialized except <u>nextPtr</u>, which Tk sets to link all the types together into a list.  The structure must
       be in permanent memory (either statically allocated or dynamically allocated but never freed); Tk retains
       a pointer to this structure.

       The  second  data  structure  manipulated by a type manager is an <u>item</u> <u>record</u>.  For each item in a canvas
       there exists one item record.  All of the items of a given type generally have item records with the same
       structure, but different types usually have different formats for their item records.  The first part  of
       each  item  record  is a header with a standard structure defined by Tk via the type Tk_Item; the rest of
       the item record is defined by the type manager.  A type manager must  define  its  item  records  with  a
       Tk_Item as the first field.  For example, the item record for bitmap items is defined as follows:

              typedef struct {
                  Tk_Item <u>header</u>;
                  double <u>x</u>, <u>y</u>;
                  Tk_Anchor <u>anchor</u>;
                  Pixmap <u>bitmap</u>;
                  XColor *<u>fgColor</u>;
                  XColor *<u>bgColor</u>;
                  GC <u>gc</u>;
              } <b>BitmapItem</b>;

       The  <u>header</u>  substructure contains information used by Tk to manage the item, such as its identifier, its
       tags, its type, and its bounding box.  The fields starting with <u>x</u> belong to the  type  manager:  Tk  will
       never  read  or  write  them.  The type manager should not need to read or write any of the fields in the
       header except for four fields whose names are <u>x1</u>, <u>y1</u>, <u>x2</u>, and <u>y2</u>.  These fields give a bounding  box  for
       the  items using integer canvas coordinates: the item should not cover any pixels with x-coordinate lower
       than <u>x1</u> or y-coordinate lower than <u>y1</u>, nor should it cover any pixels with x-coordinate greater  than  or
       equal  to  <u>x2</u>  or  y-coordinate  greater  than  or equal to <u>y2</u>.  It is up to the type manager to keep the
       bounding box up to date as the item is moved and reconfigured.

       Whenever Tk calls a procedure in a type manager it passes in a pointer to an item record.   The  argument
       is  always  passed as a pointer to a Tk_Item; the type manager will typically cast this into a pointer to
       its own specific type, such as BitmapItem.

       The third data structure used by type managers has type Tk_Canvas; it serves as an opaque handle for  the
       canvas  widget as a whole.  Type managers need not know anything about the contents of this structure.  A
       Tk_Canvas handle is typically passed in to the procedures of a type manager, and  the  type  manager  can
       pass the handle back to library procedures such as Tk_CanvasTkwin to fetch information about the canvas.

</pre><h4><b>TK_ITEMTYPE</b> <b>FIELDS</b></h4><pre>
   <b>NAME</b>
       This  section  and the ones that follow describe each of the fields in a Tk_ItemType structure in detail.
       The <u>name</u> field provides a string name for the item type.  Once <b>Tk_CreateImageType</b> returns, this name  may
       be used in <b>create</b> widget commands to create items of the new type.  If there already existed an item type
       by this name then the new item type replaces the old one.

   <b>FLAGS</b> <b>(IN</b> <b>ALWAYSREDRAW)</b>
       The  <u>typePtr-&gt;flags</u>  field  contains  a collection of flag bits that modify how the canvas core interacts
       with the item. The following bits are defined:

       <b>TK_ALWAYS_REDRAW</b>
              Indicates that the item should always be redrawn when any part of the canvas  is  redrawn,  rather
              than  only  when  the  bounding  box  of the item overlaps the area being redrawn. This is used by
              window items, for example, which need to unmap subwindows that are not on the screen.

       <b>TK_MOVABLE_POINTS</b>
              Indicates that the item supports the <u>dCharsProc</u>, <u>indexProc</u> and <u>insertProc</u> with the same  semantics 2
              as Tk's built-in line and polygon types, and that hence individual coordinate points can be moved. 2
              Must not be set if any of the above methods is NULL.

   <b>ITEMSIZE</b>
       <u>typePtr-&gt;itemSize</u> gives the size in bytes of item records of this type, including the Tk_Item header.  Tk
       uses  this size to allocate memory space for items of the type.  All of the item records for a given type
       must have the same size.  If variable length fields are needed for an item (such as a list of points  for
       a  polygon),  the type manager can allocate a separate object of variable length and keep a pointer to it
       in the item record.

   <b>CREATEPROC</b>
       <u>typePtr-&gt;createProc</u> points to a procedure for Tk to call whenever a new item of  this  type  is  created.
       <u>typePtr-&gt;createProc</u> must match the following prototype:

              typedef int <b>Tk_ItemCreateProc</b>(
                      Tcl_Interp *<u>interp</u>,
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      int <u>objc</u>,
                      Tcl_Obj *const <u>objv</u>[]);

       The  <u>interp</u>  argument  is  the  interpreter  in which the canvas's <b>create</b> widget command was invoked, and
       <u>canvas</u> is a handle for the canvas widget.  <u>itemPtr</u> is  a  pointer  to  a  newly-allocated  item  of  size
       <u>typePtr-&gt;itemSize</u>.   Tk  has already initialized the item's header (the first <b>sizeof(Tk_ItemType)</b> bytes).
       The <u>objc</u> and <u>objv</u> arguments describe all of the arguments to the <b>create</b> command after the <u>type</u>  argument.
       For example, in the widget command:

              <b>.c</b> <b>create</b> <b>rectangle</b> <b>10</b> <b>20</b> <b>50</b> <b>50</b> <b>-fill</b> <b>black</b>

       <u>objc</u> will be <b>6</b> and <u>objv</u>[0] will contain the integer object <b>10</b>.

       <u>createProc</u>  should  use <u>objc</u> and <u>objv</u> to initialize the type-specific parts of the item record and set an
       initial value for the bounding box in the item's header.  It should return a standard Tcl completion code
       and leave an error message in the interpreter result if an error occurs.  If an error occurs Tk will free
       the item record, so <u>createProc</u> must be sure to leave the item record in a clean state if  it  returns  an
       error (e.g., it must free any additional memory that it allocated for the item).

   <b>CONFIGSPECS</b>
       Each  type manager must provide a standard table describing its configuration options, in a form suitable
       for  use  with  <b>Tk_ConfigureWidget</b>.   This  table  will  normally  be  used  by  <u>typePtr-&gt;createProc</u>  and
       <u>typePtr-&gt;configProc</u>,  but  Tk  also  uses  it directly to retrieve option information in the <b>itemcget</b> and
       <b>itemconfigure</b> widget commands.  <u>typePtr-&gt;configSpecs</u> must point to the configuration table for this type.

       Note that Tk provides a custom option type <b>tk_CanvasTagsOption</b> for implementing the <b>-tags</b> option; see  an
       existing type manager for an example of how to use it in <u>configSpecs</u>.

   <b>CONFIGPROC</b>
       <u>typePtr-&gt;configProc</u>  is  called  by Tk whenever the <b>itemconfigure</b> widget command is invoked to change the
       configuration options for a canvas item.  This procedure must match the following prototype:

              typedef int <b>Tk_ItemConfigureProc</b>(
                      Tcl_Interp *<u>interp</u>,
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      int <u>objc</u>,
                      Tcl_Obj *const <u>objv</u>[],
                      int <u>flags</u>);

       The <u>interp</u> argument identifies the interpreter in which the widget  command  was  invoked,  <u>canvas</u>  is  a
       handle  for  the  canvas  widget,  and  <u>itemPtr</u> is a pointer to the item being configured.  <u>objc</u> and <u>objv</u>
       contain the configuration options.  For example, if the following command is invoked:

              <b>.c</b> <b>itemconfigure</b> <b>2</b> <b>-fill</b> <b>red</b> <b>-outline</b> <b>black</b>

       <u>objc</u> is <b>4</b> and <u>objv</u> contains the string objects <b>-fill</b> through <b>black</b>.  <u>objc</u> will always be an  even  value.
       The  <u>flags</u>  argument  contains  flags  to  pass  to  <b>Tk_ConfigureWidget</b>;  currently  this value is always
       <b>TK_CONFIG_ARGV_ONLY</b> when Tk invokes <u>typePtr-&gt;configProc</u>, but the type manager's <u>createProc</u> procedure will
       usually invoke <u>configProc</u> with different flag values.

       <u>typePtr-&gt;configProc</u> returns a standard Tcl completion code and leaves an error message in the interpreter
       result if an error occurs.  It must update the item's bounding  box  to  reflect  the  new  configuration
       options.

   <b>COORDPROC</b>
       <u>typePtr-&gt;coordProc</u>  is  invoked  by Tk to implement the <b>coords</b> widget command for an item.  It must match
       the following prototype:

              typedef int <b>Tk_ItemCoordProc</b>(
                      Tcl_Interp *<u>interp</u>,
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      int <u>objc</u>,
                      Tcl_Obj *const <u>objv</u>[]);

       The arguments <u>interp</u>, <u>canvas</u>, and <u>itemPtr</u> all have the standard meanings, and <u>objc</u> and <u>objv</u> describe  the
       coordinate arguments.  For example, if the following widget command is invoked:

              <b>.c</b> <b>coords</b> <b>2</b> <b>30</b> <b>90</b>

       <u>objc</u> will be <b>2</b> and <b>objv</b> will contain the integer objects <b>30</b> and <b>90</b>.

       The  <u>coordProc</u> procedure should process the new coordinates, update the item appropriately (e.g., it must
       reset the bounding box in the item's header), and return a standard Tcl completion  code.   If  an  error
       occurs, <u>coordProc</u> must leave an error message in the interpreter result.

   <b>DELETEPROC</b>
       <u>typePtr-&gt;deleteProc</u>  is  invoked by Tk to delete an item and free any resources allocated to it.  It must
       match the following prototype:

              typedef void <b>Tk_ItemDeleteProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      Display *<u>display</u>);

       The <u>canvas</u> and <u>itemPtr</u> arguments have the usual interpretations, and <u>display</u>  identifies  the  X  display
       containing the canvas.  <u>deleteProc</u> must free up any resources allocated for the item, so that Tk can free
       the  item  record.   <u>deleteProc</u>  should  not  actually free the item record; this will be done by Tk when
       <u>deleteProc</u> returns.

   <b>DISPLAYPROC</b>
       <u>typePtr-&gt;displayProc</u> is invoked by Tk to redraw an item on the  screen.   It  must  match  the  following
       prototype:

              typedef void <b>Tk_ItemDisplayProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      Display *<u>display</u>,
                      Drawable <u>dst</u>,
                      int <u>x</u>,
                      int <u>y</u>,
                      int <u>width</u>,
                      int <u>height</u>);

       The  <u>canvas</u>  and <u>itemPtr</u> arguments have the usual meaning.  <u>display</u> identifies the display containing the
       canvas, and <u>dst</u> specifies a drawable in which the item should be rendered;  typically  this  is  an  off-
       screen  pixmap,  which Tk will copy into the canvas's window once all relevant items have been drawn.  <u>x</u>,
       <u>y</u>, <u>width</u>, and <u>height</u> specify a rectangular region in canvas coordinates, which is the area to be redrawn;
       only information that overlaps this area needs to be redrawn.  Tk will not call  <u>displayProc</u>  unless  the
       item's  bounding  box  overlaps  the redraw area, but the type manager may wish to use the redraw area to
       optimize the redisplay of the item.

       Because of scrolling and the  use  of  off-screen  pixmaps  for  double-buffered  redisplay,  the  item's
       coordinates  in  <u>dst</u>  will  not  necessarily be the same as those in the canvas.  <u>displayProc</u> should call
       <b>Tk_CanvasDrawableCoords</b> to transform coordinates from those of the canvas to those of <u>dst</u>.

       Normally an item's <u>displayProc</u> is only invoked if the item overlaps the area being  displayed.   However,
       if  bit  zero of <u>typePtr-&gt;flags</u> is 1, (i.e. “<u>typePtr-&gt;flags</u> <u>&amp;</u> <u>1</u> <u>==</u> <u>1</u>”) then <u>displayProc</u> is invoked during
       every redisplay operation, even if the item does not overlap the area of redisplay; this  is  useful  for
       cases such as window items, where the subwindow needs to be unmapped when it is off the screen.

   <b>POINTPROC</b>
       <u>typePtr-&gt;pointProc</u>  is  invoked  by  Tk to find out how close a given point is to a canvas item.  Tk uses
       this procedure for purposes such as locating the item under the mouse or finding the closest  item  to  a
       given point.  The procedure must match the following prototype:

              typedef double <b>Tk_ItemPointProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      double *<u>pointPtr</u>);

       <u>canvas</u> and <u>itemPtr</u> have the usual meaning.  <u>pointPtr</u> points to an array of two numbers giving the x and y
       coordinates  of  a  point.   <u>pointProc</u> must return a real value giving the distance from the point to the
       item, or 0 if the point lies inside the item.

   <b>AREAPROC</b>
       <u>typePtr-&gt;areaProc</u> is invoked by Tk to find out the relationship between an item and a  rectangular  area.
       It must match the following prototype:

              typedef int <b>Tk_ItemAreaProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      double *<u>rectPtr</u>);

       <u>canvas</u>  and  <u>itemPtr</u>  have the usual meaning.  <u>rectPtr</u> points to an array of four real numbers; the first
       two give the x and y coordinates of the upper left corner of a rectangle, and the second two give  the  x
       and  y  coordinates of the lower right corner.  <u>areaProc</u> must return -1 if the item lies entirely outside
       the given area, 0 if it lies partially inside and partially outside the area, and 1 if it  lies  entirely
       inside the area.

   <b>POSTSCRIPTPROC</b>
       <u>typePtr-&gt;postscriptProc</u>  is invoked by Tk to generate Postscript for an item during the <b>postscript</b> widget
       command.  If the type manager is not capable of generating Postscript then <u>typePtr-&gt;postscriptProc</u> should
       be NULL.  The procedure must match the following prototype:

              typedef int <b>Tk_ItemPostscriptProc</b>(
                      Tcl_Interp *<u>interp</u>,
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      int <u>prepass</u>);

       The <u>interp</u>, <u>canvas</u>, and <u>itemPtr</u> arguments all have standard meanings; <u>prepass</u> will  be  described  below.
       If  <u>postscriptProc</u> completes successfully, it should append Postscript for the item to the information in
       the interpreter result (e.g. by calling <b>Tcl_AppendResult</b>, not <b>Tcl_SetResult</b>) and return  <b>TCL_OK</b>.   If  an
       error occurs, <u>postscriptProc</u> should clear the result and replace its contents with an error message; then
       it should return <b>TCL_ERROR</b>.

       Tk provides a collection of utility procedures to simplify <u>postscriptProc</u>.  For example, <b>Tk_CanvasPsColor</b>
       will  generate  Postscript  to  set the current color to a given Tk color and <b>Tk_CanvasPsFont</b> will set up
       font information.  When generating Postscript, the type manager is free to change the graphics  state  of
       the  Postscript  interpreter,  since  Tk places <b>gsave</b> and <b>grestore</b> commands around the Postscript for the
       item.  The type manager can use canvas x coordinates  directly  in  its  Postscript,  but  it  must  call
       <b>Tk_CanvasPsY</b>  to  convert  y  coordinates  from the space of the canvas (where the origin is at the upper
       left) to the space of Postscript (where the origin is at the lower left).

       In order to generate Postscript that  complies  with  the  Adobe  Document  Structuring  Conventions,  Tk
       actually generates Postscript in two passes.  It calls each item's <u>postscriptProc</u> in each pass.  The only
       purpose  of  the first pass is to collect font information (which is done by <b>Tk_CanvasPsFont</b>); the actual
       Postscript is discarded.  Tk sets the <u>prepass</u> argument to <u>postscriptProc</u> to 1 during the first pass;  the
       type  manager  can  use  <u>prepass</u>  to  skip all Postscript generation except for calls to <b>Tk_CanvasPsFont</b>.
       During the second pass <u>prepass</u> will be 0, so the type manager must generate complete Postscript.

   <b>SCALEPROC</b>
       <u>typePtr-&gt;scaleProc</u> is invoked by Tk to rescale a canvas  item  during  the  <b>scale</b>  widget  command.   The
       procedure must match the following prototype:

              typedef void <b>Tk_ItemScaleProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      double <u>originX</u>,
                      double <u>originY</u>,
                      double <u>scaleX</u>,
                      double <u>scaleY</u>);

       The  <u>canvas</u> and <u>itemPtr</u> arguments have the usual meaning.  <u>originX</u> and <u>originY</u> specify an origin relative
       to which the item is to be scaled, and <u>scaleX</u> and <u>scaleY</u> give the x and y scale factors.  The item should
       adjust its coordinates so that a point in the item that used to have coordinates <u>x</u> and <u>y</u>  will  have  new
       coordinates <u>x′</u> and <u>y′</u>, where

              <u>x′</u> = <u>originX</u> + <u>scaleX</u> × (<u>x</u> − <u>originX</u>)
              <u>y′</u> = <u>originY</u> + <u>scaleY</u> × (<u>y</u> − <u>originY</u>)

       <u>scaleProc</u> must also update the bounding box in the item's header.

   <b>TRANSLATEPROC</b>
       <u>typePtr-&gt;translateProc</u>  is  invoked by Tk to translate a canvas item during the <b>move</b> widget command.  The
       procedure must match the following prototype:

              typedef void <b>Tk_ItemTranslateProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      double <u>deltaX</u>,
                      double <u>deltaY</u>);

       The <u>canvas</u> and <u>itemPtr</u> arguments have the usual meaning, and <u>deltaX</u> and  <u>deltaY</u>  give  the  amounts  that
       should  be  added  to each x and y coordinate within the item.  The type manager should adjust the item's
       coordinates and update the bounding box in the item's header.

   <b>ROTATEPROC</b>
       <u>typePtr-&gt;rotateProc</u> is invoked by Tk to rotate a canvas item  during  the  <b>rotate</b>  widget  command.   The 2
       procedure must match the following prototype:                                                             2

              typedef void <b>Tk_ItemRotateProc</b>(                                                                    2
                      Tk_Canvas <u>canvas</u>,                                                                          2
                      Tk_Item *<u>itemPtr</u>,                                                                          2
                      double <u>originX</u>,                                                                            2
                      double <u>originY</u>,                                                                            2
                      double <u>angleRad</u>);                                                                          2

       The  <u>canvas</u> and <u>itemPtr</u> arguments have the usual meaning.  <u>originX</u> and <u>originY</u> specify an origin relative 2
       to which the item is to be rotated, and <u>angleRad</u> gives  the  anticlockwise  rotation  to  be  applied  in 2
       radians.   The  item  should adjust the coordinates of its control points so that where they used to have 2
       coordinates <u>x</u> and <u>y</u>, they will have new coordinates <u>x′</u> and <u>y′</u>, where                                      2

              <u>relX</u> = <u>x</u> − <u>originX</u>                                                                                 2
              <u>relY</u> = <u>y</u> − <u>originY</u>                                                                                 2
              <u>x′</u> = <u>originX</u> + <u>relX</u> × cos(<u>angleRad</u>) + <u>relY</u> × sin(<u>angleRad</u>)                                         2
              <u>y′</u> = <u>originY</u> − <u>relX</u> × sin(<u>angleRad</u>) + <u>relY</u> × cos(<u>angleRad</u>)                                         2

       The control points for an item are not necessarily the coordinates  provided  to  the  item  when  it  is 2
       created  (or  via  the <u>typePtr-&gt;coordProc</u>), but could instead be derived from them.  <u>rotateProc</u> must also 2
       update the bounding box in the item's header.                                                             2

       Item types do not need to  provide  a  <u>typePtr-&gt;rotateProc</u>.  If  the  <u>typePtr-&gt;rotateProc</u>  is  NULL,  the 2
       <u>typePtr-&gt;coordProc</u> will be used instead to retrieve and update the list of coordinates.

   <b>INDEXPROC</b>
       <u>typePtr-&gt;indexProc</u> is invoked by Tk to translate a string index specification into a numerical index, for
       example  during the <b>index</b> widget command.  It is only relevant for item types that support indexable text
       or coordinates; <u>typePtr-&gt;indexProc</u> may be specified as NULL for non-textual item types  if  they  do  not
       support detailed coordinate addressing.  The procedure must match the following prototype:

              typedef int <b>Tk_ItemIndexProc</b>(
                      Tcl_Interp *<u>interp</u>,
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      Tcl_Obj *<u>indexObj</u>,
                      int *<u>indexPtr</u>);

       The  <u>interp</u>,  <u>canvas</u>,  and  <u>itemPtr</u>  arguments  all  have the usual meaning.  <u>indexObj</u> contains a textual
       description of an index, and <u>indexPtr</u> points to an  integer  value  that  should  be  filled  in  with  a
       numerical  index.   It  is  up  to  the  type  manager to decide what forms of index are supported (e.g.,
       numbers, <b>insert</b>, <b>sel.first</b>, <b>end</b>, etc.).  <u>indexProc</u> should return  a  Tcl  completion  code  and  set  the
       interpreter result in the event of an error.

   <b>ICURSORPROC</b>
       <u>typePtr-&gt;icursorProc</u>  is  invoked  by  Tk  during  the  <b>icursor</b> widget command to set the position of the
       insertion cursor in a textual item.  It is only relevant for item types that support an insertion cursor;
       <u>typePtr-&gt;icursorProc</u> may be specified as NULL for item types that do not  support  an  insertion  cursor.
       The procedure must match the following prototype:

              typedef void <b>Tk_ItemCursorProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      int <u>index</u>);

       <u>canvas</u>  and <u>itemPtr</u> have the usual meanings, and <u>index</u> is an index into the item's text, as returned by a
       previous call to <u>typePtr-&gt;insertProc</u>.  The type manager should position the insertion cursor in the  item
       just  before  the  character  given by <u>index</u>.  Whether or not to actually display the insertion cursor is
       determined by other information provided by <b>Tk_CanvasGetTextInfo</b>.

   <b>SELECTIONPROC</b>
       <u>typePtr-&gt;selectionProc</u> is invoked by Tk during selection retrievals; it must return part or  all  of  the
       selected  text  in  the  item  (if  any).   It  is  only  relevant  for  item  types  that  support text;
       <u>typePtr-&gt;selectionProc</u> may be specified as NULL for non-textual item types.  The procedure must match the
       following prototype:

              typedef int <b>Tk_ItemSelectionProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      int <u>offset</u>,
                      char *<u>buffer</u>,
                      int <u>maxBytes</u>);

       <u>canvas</u> and <u>itemPtr</u> have the usual meanings.  <u>offset</u> is an offset in bytes  into  the  selection  where  0
       refers  to  the  first byte of the selection; it identifies the first character that is to be returned in
       this call.  <u>buffer</u> points to an area of memory in which  to  store  the  requested  bytes,  and  <u>maxBytes</u>
       specifies  the maximum number of bytes to return.  <u>selectionProc</u> should extract up to <u>maxBytes</u> characters
       from the selection and copy them to <u>maxBytes</u>; it should return a count of the number  of  bytes  actually
       copied, which may be less than <u>maxBytes</u> if there are not <u>offset+maxBytes</u> bytes in the selection.

   <b>INSERTPROC</b>
       <u>typePtr-&gt;insertProc</u>  is  invoked by Tk during the <b>insert</b> widget command to insert new text or coordinates
       into  a  canvas  item.   It  is  only  relevant  for  item  types  that  support   the   <b>insert</b>   method;
       <u>typePtr-&gt;insertProc</u>  may  be  specified  as  NULL  for  other  item  types.  The procedure must match the
       following prototype:

              typedef void <b>Tk_ItemInsertProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      int <u>index</u>,
                      Tcl_Obj *<u>obj</u>);

       <u>canvas</u> and <u>itemPtr</u> have the usual meanings.  <u>index</u> is an index into the item's text,  as  returned  by  a
       previous call to <u>typePtr-&gt;insertProc</u>, and <u>obj</u> contains new text to insert just before the character given
       by <u>index</u>.  If the item supports modification of the coordinates list by this

       The type manager should insert the text and recompute the bounding box in the item's header.

   <b>DCHARSPROC</b>
       <u>typePtr-&gt;dCharsProc</u>  is  invoked  by Tk during the <b>dchars</b> widget command to delete a range of text from a
       canvas item or a range of coordinates from a pathed item.  It  is  only  relevant  for  item  types  that
       support text; <u>typePtr-&gt;dCharsProc</u> may be specified as NULL for non-textual item types that do not want to
       support coordinate deletion.  The procedure must match the following prototype:

              typedef void <b>Tk_ItemDCharsProc</b>(
                      Tk_Canvas <u>canvas</u>,
                      Tk_Item *<u>itemPtr</u>,
                      int <u>first</u>,
                      int <u>last</u>);

       <u>canvas</u>  and <u>itemPtr</u> have the usual meanings.  <u>first</u> and <u>last</u> give the indices of the first and last bytes
       to be deleted, as returned by previous calls to <u>typePtr-&gt;indexProc</u>.  The type manager should  delete  the
       specified characters and update the bounding box in the item's header.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Tk_CanvasPsY, Tk_CanvasTextInfo, Tk_CanvasTkwin

</pre><h4><b>KEYWORDS</b></h4><pre>
       canvas, focus, item type, selection, type manager

Tk                                                     4.0                                <u><a href="../man3tk/Tk_CreateItemType.3tk.html">Tk_CreateItemType</a></u>(3tk)
</pre>
 </div>
</div></section>
</div>
</body>
</html>