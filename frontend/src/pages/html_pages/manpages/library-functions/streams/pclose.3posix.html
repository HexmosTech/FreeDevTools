<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-posix-dev">manpages-posix-dev_2017a-2_all</a> <br><br><pre>
</pre><h4><b>PROLOG</b></h4><pre>
       This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface
       may differ (consult the corresponding Linux manual page for details of Linux behavior), or the  interface
       may not be implemented on Linux.

</pre><h4><b>NAME</b></h4><pre>
       pclose — close a pipe stream to or from a process

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;

       int pclose(FILE *<u>stream</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <u>pclose</u>() function shall close a stream that was opened by <u>popen</u>(), wait for the command to terminate,
       and  return  the  termination  status  of  the process that was running the command language interpreter.
       However, if a call caused the termination status to be  unavailable  to  <u>pclose</u>(),  then  <u>pclose</u>()  shall
       return  -1  with <u>errno</u> set to <b>[ECHILD]</b> to report this situation. This can happen if the application calls
       one of the following functions:

        *  <u>wait</u>()

        *  <u>waitpid</u>() with a <u>pid</u> argument less than or equal to 0 or equal to the process ID of the command  line
           interpreter

        *  Any other function not defined in this volume of POSIX.1‐2017 that could do one of the above

       In any case, <u>pclose</u>() shall not return before the child process created by <u>popen</u>() has terminated.

       If the command language interpreter cannot be executed, the child termination status returned by <u>pclose</u>()
       shall be as if the command language interpreter terminated using <u><a href="../man127/exit.127.html">exit</a></u>(127) or <b>_</b><u><a href="../man127/exit.127.html">exit</a></u>(127).

       The  <u>pclose</u>()  function shall not affect the termination status of any child of the calling process other
       than the one created by <u>popen</u>() for the associated stream.

       If the argument <u>stream</u> to <u>pclose</u>() is not a pointer to  a  stream  created  by  <u>popen</u>(),  the  result  of
       <u>pclose</u>() is undefined.

       If a thread is canceled during execution of <u>pclose</u>(), the behavior is undefined.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Upon successful return, <u>pclose</u>() shall return the termination status of the command language interpreter.
       Otherwise, <u>pclose</u>() shall return -1 and set <u>errno</u> to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       The <u>pclose</u>() function shall fail if:

       <b>ECHILD</b> The status of the child process could not be obtained, as described above.

       <u>The</u> <u>following</u> <u>sections</u> <u>are</u> <u>informative.</u>

</pre><h4><b>EXAMPLES</b></h4><pre>
       None.

</pre><h4><b>APPLICATION</b> <b>USAGE</b></h4><pre>
       None.

</pre><h4><b>RATIONALE</b></h4><pre>
       There  is a requirement that <u>pclose</u>() not return before the child process terminates. This is intended to
       disallow implementations that return <b>[EINTR]</b> if a signal is received while waiting. If <u>pclose</u>()  returned
       before the child terminated, there would be no way for the application to discover which child used to be
       associated with the stream, and it could not do the cleanup itself.

       If  the  stream  pointed  to by <u>stream</u> was not created by <u>popen</u>(), historical implementations of <u>pclose</u>()
       return -1 without setting <u>errno</u>.  To avoid requiring <u>pclose</u>() to set <u>errno</u>  in  this  case,  POSIX.1‐2008
       makes  the  behavior unspecified. An application should not use <u>pclose</u>() to close any stream that was not
       created by <u>popen</u>().

       Some historical implementations of <u>pclose</u>() either block or  ignore  the  signals  SIGINT,  SIGQUIT,  and
       SIGHUP  while  waiting  for  the child process to terminate. Since this behavior is not described for the
       <u>pclose</u>() function in POSIX.1‐2008,  such  implementations  are  not  conforming.  Also,  some  historical
       implementations return <b>[EINTR]</b> if a signal is received, even though the child process has not terminated.
       Such implementations are also considered non-conforming.

       Consider, for example, an application that uses:

           popen("command", "r")

       to  start  <u>command</u>,  which  is  part  of the same application. The parent writes a prompt to its standard
       output (presumably the terminal) and then reads from the <u>popen</u>()ed stream. The child reads  the  response
       from  the  user,  does  some  transformation on the response (pathname expansion, perhaps) and writes the
       result to its standard output. The parent process reads the result from the pipe, does something with it,
       and prints another prompt. The  cycle  repeats.  Assuming  that  both  processes  do  appropriate  buffer
       flushing, this would be expected to work.

       To conform to POSIX.1‐2008, <u>pclose</u>() must use <u>waitpid</u>(), or some similar function, instead of <u>wait</u>().

       The  code  sample below illustrates how the <u>pclose</u>() function might be implemented on a system conforming
       to POSIX.1‐2008.

           int pclose(FILE *stream)
           {
               int stat;
               pid_t pid;

               pid = &lt;pid for process created for stream by popen()&gt;
               (void) fclose(stream);
               while (waitpid(pid, &amp;stat, 0) == -1) {
                   if (errno != EINTR){
                       stat = -1;
                       break;
                   }
               }
               return(stat);
           }

</pre><h4><b>FUTURE</b> <b>DIRECTIONS</b></h4><pre>
       None.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>fork</u>(), <u>popen</u>(), <u>wait</u>()

       The Base Definitions volume of POSIX.1‐2017, <b>&lt;stdio.h&gt;</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1-2017, Standard
       for Information  Technology  --  Portable  Operating  System  Interface  (POSIX),  The  Open  Group  Base
       Specifications  Issue  7, 2018 Edition, Copyright (C) 2018 by the Institute of Electrical and Electronics
       Engineers, Inc and The Open Group.  In the event of any discrepancy between this version and the original
       IEEE and The Open Group Standard, the original IEEE and The Open Group Standard is the referee  document.
       The original Standard can be obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any  typographical  or formatting errors that appear in this page are most likely to have been introduced
       during  the  conversion  of  the  source  files  to  man  page  format.  To  report  such   errors,   see
       https://www.kernel.org/doc/man-pages/reporting_bugs.html .

IEEE/The Open Group                                   2017                                        <u><a href="../man3POSIX/PCLOSE.3POSIX.html">PCLOSE</a></u>(3POSIX)
</pre>
 </div>
</div></section>
</div>
</body>
</html>