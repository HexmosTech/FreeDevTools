<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rpmem_persist(), rpmem_deep_persist(), rpmem_flush(), rpmem_drain(), rpmem_read() - functions to copy and</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/librpmem-dev">librpmem-dev_1.11.1-3build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>rpmem_persist</b>(), <b>rpmem_deep_persist</b>(), <b>rpmem_flush</b>(), <b>rpmem_drain</b>(), <b>rpmem_read</b>() - functions to copy and
       read remote pools

</pre><h4><b>SYNOPSIS</b></h4><pre>
              #include &lt;librpmem.h&gt;

              int rpmem_persist(RPMEMpool *rpp, size_t offset,
                  size_t length, unsigned lane, unsigned flags);
              int rpmem_deep_persist(RPMEMpool *rpp, size_t offset,
                  size_t length, unsigned lane);

              int rpmem_flush(RPMEMpool *rpp, size_t offset,
                  size_t length, unsigned lane, unsigned flags);
              int rpmem_drain(RPMEMpool *rpp, unsigned lane, unsigned flags);

              int rpmem_read(RPMEMpool *rpp, void *buff, size_t offset,
                  size_t length, unsigned lane);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>rpmem_persist</b>() function copies data of given <u>length</u> at given <u>offset</u> from the associated local memory
       pool  and  makes  sure the data is persistent on the remote node before the function returns.  The remote
       node is identified by the <u>rpp</u> handle which must be returned from either <b><a href="../man3/rpmem_open.3.html">rpmem_open</a></b>(3) or <b><a href="../man3/rpmem_create.3.html">rpmem_create</a></b>(3).
       The <u>offset</u> is relative to the <u>pool_addr</u> specified in the <b><a href="../man3/rpmem_open.3.html">rpmem_open</a></b>(3) or <b><a href="../man3/rpmem_create.3.html">rpmem_create</a></b>(3) call.   If  the
       remote pool was created using <b>rpmem_create</b>() with non-NULL <u>create_attr</u> argument, <u>offset</u> has to be greater
       or  equal  to  4096.  In that case the first 4096 bytes of the pool is used for storing the pool metadata
       and cannot be overwritten.  If the pool was created with NULL <u>create_attr</u> argument, the pool metadata  is
       not  stored  with the pool and <u>offset</u> can be any nonnegative number.  The <u>offset</u> and <u>length</u> combined must
       not exceed the <u>pool_size</u> passed to <b><a href="../man3/rpmem_open.3.html">rpmem_open</a></b>(3) or <b><a href="../man3/rpmem_create.3.html">rpmem_create</a></b>(3).  The  <b>rpmem_persist</b>()  operation  is
       performed using the given <u>lane</u> number.  The lane must be less than the value returned by <b><a href="../man3/rpmem_open.3.html">rpmem_open</a></b>(3) or
       <b><a href="../man3/rpmem_create.3.html">rpmem_create</a></b>(3) through the <u>nlanes</u> argument (so it can take a value from 0 to <u>nlanes</u> - 1).  The <u>flags</u> ar‐
       gument can be 0 or RPMEM_PERSIST_RELAXED which means the persist operation will be done without any guar‐
       antees regarding atomicity of memory transfer.

       The <b>rpmem_deep_persist</b>() function works in the same way as <b><a href="../man3/rpmem_persist.3.html">rpmem_persist</a></b>(3) function, but additionally it
       flushes  the  data  to  the  lowest  possible  persistency  domain  available  from software.  Please see
       <b><a href="../man3/pmem_deep_persist.3.html">pmem_deep_persist</a></b>(3) for details.

       The <b>rpmem_flush</b>() and <b>rpmem_drain</b>() functions are two halves of  the  single  <b>rpmem_persist</b>().   The  <b>rp‐</b>
       <b>mem_persist</b>()  copies data and makes it persistent in the one shot, where <b>rpmem_flush</b>() and <b>rpmem_drain</b>()
       split this operation into two stages.  The <b>rpmem_flush</b>() copies data of given <u>length</u> at  a  given  <u>offset</u>
       from  the  associated local memory pool to the remote node.  The <b>rpmem_drain</b>() makes sure the data copied
       in all preceding <b>rpmem_flush</b>() calls is persistent on the remote node before the function returns.   Data
       copied using <b>rpmem_flush</b>() can not be considered persistent on the remote node before return from follow‐
       ing  <b>rpmem_drain</b>().   Single  <b>rpmem_drain</b>() confirms persistence on the remote node of data copied by all
       <b>rpmem_flush</b>() functions called before it and using the same <u>lane</u>.  The last <b>rpmem_flush</b>() + <b>rpmem_drain</b>()
       can be replaced with <b>rpmem_persist</b>() at no cost.

       The <u>flags</u> argument for <b>rpmem_flush</b>() can be 0 or RPMEM_FLUSH_RELAXED which means the flush operation will
       be done without any guarantees regarding atomicity of  memory  transfer.   The  <u>flags</u>  argument  for  <b>rp‐</b>
       <b>mem_drain</b>() must be 0.

       The <b>rpmem_flush</b>() function performance is affected by <b>RPMEM_WORK_QUEUE_SIZE</b> environment variable (see <b>li‐</b>
       <b><a href="../man7/brpmem.7.html">brpmem</a></b>(7) for more details).

       The  <b>rpmem_read</b>()  function  reads <u>length</u> bytes of data from a remote pool at <u>offset</u> and copies it to the
       buffer <u>buff</u>.  The operation is performed on the specified <u>lane</u>.  The lane must be less than the value re‐
       turned by <b><a href="../man3/rpmem_open.3.html">rpmem_open</a></b>(3) or <b><a href="../man3/rpmem_create.3.html">rpmem_create</a></b>(3) through the <u>nlanes</u> argument (so it can take a value from 0  to
       <u>nlanes</u>  -  1).   The <u>rpp</u> must point to a remote pool opened or created previously by <b><a href="../man3/rpmem_open.3.html">rpmem_open</a></b>(3) or <b>rp‐</b>
       <b><a href="../man3/mem_create.3.html">mem_create</a></b>(3).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>rpmem_persist</b>() function returns 0 if the entire memory area was made persistent on the remote  node.
       Otherwise it returns a non-zero value and sets <u>errno</u> appropriately.

       The <b>rpmem_flush</b>() function returns 0 if duplication of the memory area to the remote node was initialized
       successfully.  Otherwise, it returns a non-zero value and sets <u>errno</u> appropriately.

       The  <b>rpmem_drain</b>() function returns 0 if the memory areas duplicated by all <b>rpmem_flush</b>() calls preceding
       the <b>rpmem_drain</b>() are made persistent on the remote node.  Otherwise, it returns  a  non-zero  value  and
       sets <u>errno</u> appropriately.

       The <b>rpmem_read</b>() function returns 0 if the data was read entirely.  Otherwise it returns a non-zero value
       and sets <u>errno</u> appropriately.

</pre><h4><b>CAVEATS</b></h4><pre>
       Ordering  of  <b>rpmem_flush</b>()  and  <b>rpmem_persist</b>() operations which are using different <u>lane</u> values is not
       guaranteed.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/rpmem_create.3.html">rpmem_create</a></b>(3),  <b><a href="../man3/rpmem_open.3.html">rpmem_open</a></b>(3),  <b><a href="../man3/rpmem_persist.3.html">rpmem_persist</a></b>(3),   <b><a href="../man3/sysconf.3.html">sysconf</a></b>(3),   <b><a href="../man5/limits.conf.5.html">limits.conf</a></b>(5),   <b><a href="../man7/libpmemobj.7.html">libpmemobj</a></b>(7)   and
       <b>&lt;https://pmem.io&gt;</b>

PMDK - rpmem API version 1.3                       2021-09-24                                   <u><a href="../man3/RPMEM_PERSIST.3.html">RPMEM_PERSIST</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>