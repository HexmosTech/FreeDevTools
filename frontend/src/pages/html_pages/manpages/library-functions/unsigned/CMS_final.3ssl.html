<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS_final, CMS_final_digest - finalise a CMS_ContentInfo structure</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CMS_final, CMS_final_digest - finalise a CMS_ContentInfo structure

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/cms.h&gt;

        int CMS_final(CMS_ContentInfo *cms, BIO *data, BIO *dcont, unsigned int flags);
        int CMS_final_digest(CMS_ContentInfo *cms, const unsigned char *md,
                             unsigned int mdlen, BIO *dcont, unsigned int flags);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>CMS_final()</b> finalises the structure <b>cms</b>. Its purpose is to perform any operations necessary on <b>cms</b>
       (digest computation for example) and set the appropriate fields. The parameter <b>data</b> contains the content
       to be processed. The <b>dcont</b> parameter contains a BIO to write content to after processing: this is only
       used with detached data and will usually be set to NULL.

       <b>CMS_final_digest()</b> finalises the structure <b>cms</b> using a pre-computed digest, rather than computing the
       digest from the original data.

</pre><h4><b>NOTES</b></h4><pre>
       These functions will normally be called when the <b>CMS_PARTIAL</b> flag is used. It should only be used when
       streaming is not performed because the streaming I/O functions perform finalisation operations
       internally.

       To sign a pre-computed digest, <b><a href="../man3/CMS_sign.3.html">CMS_sign</a></b>(3) or <b>CMS_sign_ex()</b> is called with the <b>data</b> parameter set to NULL
       before the CMS structure is finalised with the digest provided to <b>CMS_final_digest()</b> in binary form.
       When signing a pre-computed digest, the security relies on the digest and its computation from the
       original message being trusted.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>CMS_final()</b> and <b>CMS_final_digest()</b> return 1 for success or 0 for failure.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3), <b><a href="../man3/CMS_sign.3.html">CMS_sign</a></b>(3), <b><a href="../man3/CMS_encrypt.3.html">CMS_encrypt</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>CMS_final_digest()</b> was added in OpenSSL 3.2.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2008-2022 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                    <u><a href="../man3SSL/CMS_FINAL.3SSL.html">CMS_FINAL</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>