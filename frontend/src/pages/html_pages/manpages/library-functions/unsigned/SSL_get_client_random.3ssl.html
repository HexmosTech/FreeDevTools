<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_get_client_random, SSL_get_server_random, SSL_SESSION_get_master_key, SSL_SESSION_set1_master_key -</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_get_client_random, SSL_get_server_random, SSL_SESSION_get_master_key, SSL_SESSION_set1_master_key -
       get internal TLS/SSL random values and get/set master key

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        size_t SSL_get_client_random(const SSL *ssl, unsigned char *out, size_t outlen);
        size_t SSL_get_server_random(const SSL *ssl, unsigned char *out, size_t outlen);
        size_t SSL_SESSION_get_master_key(const SSL_SESSION *session,
                                          unsigned char *out, size_t outlen);
        int SSL_SESSION_set1_master_key(SSL_SESSION *sess, const unsigned char *in,
                                        size_t len);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_get_client_random()</b> extracts the random value sent from the client to the server during the initial
       SSL/TLS handshake.  It copies as many bytes as it can of this value into the buffer provided in <b>out</b>,
       which must have at least <b>outlen</b> bytes available. It returns the total number of bytes that were actually
       copied.  If <b>outlen</b> is zero, <b>SSL_get_client_random()</b> copies nothing, and returns the total size of the
       client_random value.

       <b>SSL_get_server_random()</b> behaves the same, but extracts the random value sent from the server to the
       client during the initial SSL/TLS handshake.

       <b>SSL_SESSION_get_master_key()</b> behaves the same, but extracts the master secret used to guarantee the
       security of the SSL/TLS session.  This one can be dangerous if misused; see NOTES below.

       <b>SSL_SESSION_set1_master_key()</b> sets the master key value associated with the SSL_SESSION <b>sess</b>. For
       example, this could be used to set up a session based PSK (see <b><a href="../man3/SSL_CTX_set_psk_use_session_callback.3.html">SSL_CTX_set_psk_use_session_callback</a></b>(3)).
       The master key of length <b>len</b> should be provided at <b>in</b>. The supplied master key is copied by the function,
       so the caller is responsible for freeing and cleaning any memory associated with <b>in</b>. The caller must
       ensure that the length of the key is suitable for the ciphersuite associated with the SSL_SESSION.

</pre><h4><b>NOTES</b></h4><pre>
       You probably shouldn't use these functions.

       These functions expose internal values from the TLS handshake, for use in low-level protocols.  You
       probably should not use them, unless you are implementing something that needs access to the internal
       protocol details.

       Despite the names of <b>SSL_get_client_random()</b> and <b>SSL_get_server_random()</b>, they ARE NOT random number
       generators.  Instead, they return the mostly-random values that were already generated and used in the
       TLS protocol.  Using them in place of <b>RAND_bytes()</b> would be grossly foolish.

       The security of your TLS session depends on keeping the master key secret: do not expose it, or any
       information about it, to anybody.  If you need to calculate another secret value that depends on the
       master secret, you should probably use <b>SSL_export_keying_material()</b> instead, and forget that you ever saw
       these functions.

       In current versions of the TLS protocols, the length of client_random (and also server_random) is always
       SSL3_RANDOM_SIZE bytes. Support for other outlen arguments to the SSL_get_*<b>_random()</b> functions is
       provided in case of the unlikely event that a future version or variant of TLS uses some other length
       there.

       Finally, though the "client_random" and "server_random" values are called "random", many TLS
       implementations will generate four bytes of those values based on their view of the current time.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_SESSION_set1_master_key()</b> returns 1 on success or 0 on failure.

       For the other functions, if <b>outlen</b> is greater than 0 then these functions return the number of bytes
       actually copied, which will be less than or equal to <b>outlen</b>. If <b>outlen</b> is 0 then these functions return
       the maximum number of bytes they would copy -- that is, the length of the underlying field.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/RAND_bytes.3.html">RAND_bytes</a></b>(3), <b><a href="../man3/SSL_export_keying_material.3.html">SSL_export_keying_material</a></b>(3), <b><a href="../man3/SSL_CTX_set_psk_use_session_callback.3.html">SSL_CTX_set_psk_use_session_callback</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2015-2017 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                        <u><a href="../man3SSL/SSL_GET_CLIENT_RANDOM.3SSL.html">SSL_GET_CLIENT_RANDOM</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>