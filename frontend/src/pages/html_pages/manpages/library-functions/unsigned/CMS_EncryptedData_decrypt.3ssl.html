<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS_EncryptedData_decrypt, CMS_EnvelopedData_decrypt - Decrypt CMS EncryptedData or EnvelopedData</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CMS_EncryptedData_decrypt, CMS_EnvelopedData_decrypt - Decrypt CMS EncryptedData or EnvelopedData

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/cms.h&gt;

        int CMS_EncryptedData_decrypt(CMS_ContentInfo *cms,
                                      const unsigned char *key, size_t keylen,
                                      BIO *dcont, BIO *out, unsigned int flags);

        BIO *CMS_EnvelopedData_decrypt(CMS_EnvelopedData *env, BIO *detached_data,
                                       EVP_PKEY *pkey, X509 *cert,
                                       ASN1_OCTET_STRING *secret, unsigned int flags,
                                       OSSL_LIB_CTX *libctx, const char *propq);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>CMS_EncryptedData_decrypt()</b> decrypts a <u>cms</u> EncryptedData object using the symmetric <u>key</u> of size <u>keylen</u>
       bytes. <u>out</u> is a BIO to write the content to and <u>flags</u> is an optional set of flags.  <u>dcont</u> is used in the
       rare case where the encrypted content is detached. It will normally be set to NULL.

       The following flags can be passed in the <u>flags</u> parameter.

       If the <b>CMS_TEXT</b> flag is set MIME headers for type "text/plain" are deleted from the content. If the
       content is not of type "text/plain" then an error is returned.

       <b>CMS_EnvelopedData_decrypt()</b> decrypts, similarly to <b><a href="../man3/CMS_decrypt.3.html">CMS_decrypt</a></b>(3), a CMS EnvelopedData object <u>env</u> using
       the symmetric key <u>secret</u> if it is not NULL, otherwise the private key of the recipient <u>pkey</u>.  If <u>pkey</u> is
       given, it is recommended to provide also the associated certificate in <u>cert</u> - see <b><a href="../man3/CMS_decrypt.3.html">CMS_decrypt</a></b>(3) and the
       NOTES on <u>cert</u> there.  The optional parameters <u>flags</u> and <u>dcont</u> are used as described above.  The optional
       parameters library context <u>libctx</u> and property query <u>propq</u> are used when retrieving algorithms from
       providers.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>CMS_EncryptedData_decrypt()</b> returns 0 if an error occurred otherwise returns 1.

       <b>CMS_EnvelopedData_decrypt()</b> returns NULL if an error occurred, otherwise a BIO containing the decypted
       content.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3), <b><a href="../man3/CMS_EncryptedData_encrypt.3.html">CMS_EncryptedData_encrypt</a></b>(3), <b><a href="../man3/CMS_decrypt.3.html">CMS_decrypt</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>CMS_EnvelopedData_decrypt()</b> was added in OpenSSL 3.2.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                    <u><a href="../man3SSL/CMS_ENCRYPTEDDATA_DECRYPT.3SSL.html">CMS_ENCRYPTEDDATA_DECRYPT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>