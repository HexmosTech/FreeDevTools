<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS_add1_recipient, CMS_add1_recipient_cert, CMS_add0_recipient_key - add recipients to a CMS enveloped</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CMS_add1_recipient, CMS_add1_recipient_cert, CMS_add0_recipient_key - add recipients to a CMS enveloped
       data structure

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/cms.h&gt;

        CMS_RecipientInfo *CMS_add1_recipient(CMS_ContentInfo *cms, X509 *recip,
                                              EVP_PKEY *originatorPrivKey,
                                              X509 *originator, unsigned int flags);

        CMS_RecipientInfo *CMS_add1_recipient_cert(CMS_ContentInfo *cms,
                                                   X509 *recip, unsigned int flags);

        CMS_RecipientInfo *CMS_add0_recipient_key(CMS_ContentInfo *cms, int nid,
                                                  unsigned char *key, size_t keylen,
                                                  unsigned char *id, size_t idlen,
                                                  ASN1_GENERALIZEDTIME *date,
                                                  ASN1_OBJECT *otherTypeId,
                                                  ASN1_TYPE *otherType);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>CMS_add1_recipient()</b> adds recipient <b>recip</b> and provides the originator pkey <b>originatorPrivKey</b> and
       originator certificate <b>originator</b> to CMS_ContentInfo.  The originator-related fields are relevant only in
       case when the keyAgreement method of providing of the shared key is in use.

       <b>CMS_add1_recipient_cert()</b> adds recipient <b>recip</b> to CMS_ContentInfo enveloped data structure <b>cms</b> as a
       KeyTransRecipientInfo structure.

       <b>CMS_add0_recipient_key()</b> adds symmetric key <b>key</b> of length <b>keylen</b> using wrapping algorithm <b>nid</b>, identifier
       <b>id</b> of length <b>idlen</b> and optional values <b>date</b>, <b>otherTypeId</b> and <b>otherType</b> to CMS_ContentInfo enveloped data
       structure <b>cms</b> as a KEKRecipientInfo structure.

       The CMS_ContentInfo structure should be obtained from an initial call to <b>CMS_encrypt()</b> with the flag
       <b>CMS_PARTIAL</b> set.

</pre><h4><b>NOTES</b></h4><pre>
       The main purpose of this function is to provide finer control over a CMS enveloped data structure where
       the simpler <b>CMS_encrypt()</b> function defaults are not appropriate. For example if one or more
       KEKRecipientInfo structures need to be added. New attributes can also be added using the returned
       CMS_RecipientInfo structure and the CMS attribute utility functions.

       OpenSSL will by default identify recipient certificates using issuer name and serial number. If
       <b>CMS_USE_KEYID</b> is set it will use the subject key identifier value instead. An error occurs if all
       recipient certificates do not have a subject key identifier extension.

       Currently only AES based key wrapping algorithms are supported for <b>nid</b>, specifically: NID_id_aes128_wrap,
       NID_id_aes192_wrap and NID_id_aes256_wrap.  If <b>nid</b> is set to <b>NID_undef</b> then an AES wrap algorithm will be
       used consistent with <b>keylen</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>CMS_add1_recipient_cert()</b> and <b>CMS_add0_recipient_key()</b> return an internal pointer to the
       CMS_RecipientInfo structure just added or NULL if an error occurs.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3), <b><a href="../man3/CMS_decrypt.3.html">CMS_decrypt</a></b>(3), <b><a href="../man3/CMS_final.3.html">CMS_final</a></b>(3),

</pre><h4><b>HISTORY</b></h4><pre>
       <b>CMS_add1_recipient_cert</b> and <b>CMS_add0_recipient_key</b> were added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2008-2020 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                      <u><a href="../man3SSL/CMS_ADD1_RECIPIENT_CERT.3SSL.html">CMS_ADD1_RECIPIENT_CERT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>