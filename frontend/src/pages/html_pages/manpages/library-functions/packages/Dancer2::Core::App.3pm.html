<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dancer2::Core::App - encapsulation of Dancer2 packages</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libdancer2-perl">libdancer2-perl_1.1.2+dfsg-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Dancer2::Core::App - encapsulation of Dancer2 packages

</pre><h4><b>VERSION</b></h4><pre>
       version 1.1.2

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Everything a package that uses Dancer2 does is encapsulated into a "Dancer2::Core::App" instance. This
       class defines all that can be done in such objects.

       Mainly, it will contain all the route handlers, the configuration settings and the hooks that are defined
       in the calling package.

       Note that with Dancer2, everything that is done within a package is scoped to that package, thanks to
       that encapsulation.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
   <b>plugins</b>
   <b>runner_config</b>
   <b>default_config</b>
   <b>with_return</b>
       Used to cache the coderef that will return from back to the dispatcher, across an arbitrary number of
       stack frames.

   <b>destroyed_session</b>
       We cache a destroyed session here; once this is set we must not attempt to retrieve the session from the
       cookie in the request.  If no new session is created, this is set (with expiration) as a cookie to force
       the browser to expire the cookie.

</pre><h4><b>METHODS</b></h4><pre>
   <b>has_session</b>
       Returns true if session engine has been defined and if either a session object has been instantiated or
       if a session cookie was found and not subsequently invalidated.

   <b>change_session_id</b>
       Changes the session ID used by the current session. This should be used on any change of privilege level,
       for example on login. Returns the new session ID.

   <b>destroy_session</b>
       Destroys the current session and ensures any subsequent session is created from scratch and not from the
       request session cookie

   <b>register_plugin</b>
   <b>with_plugins(</b> <b>@plugin_names</b> <b>)</b>
       Creates instances of the given plugins and tie them to the app.  The plugin classes are automatically
       loaded.  Returns the newly created plugins.

       The plugin names are expected to be without the leading "Dancer2::Plugin".  I.e., use "Foo" to mean
       "Dancer2::Plugin::Foo".

       If a given plugin is already tied to the app, the already-existing instance will be used and returned by
       "with_plugins" (think of it as using a role).

           my @plugins = $app-&gt;with_plugins( 'Foo', 'Bar' );

           # now $app uses the plugins Dancer2::Plugin::Foo
           # and Dancer2::Plugin::Bar

   <b>with_plugin(</b> <b>$plugin_name</b> <b>)</b>
       Just like "with_plugin", but for a single plugin.

           my $plugin = $app-&gt;with_plugin('Foo');

   <b>add_route</b>
       Register a new route handler.

           $app-&gt;add_route(
               method  =&gt; 'get',
               regexp  =&gt; '/somewhere',
               code    =&gt; sub { ... },
               options =&gt; $conditions,
           );

       Returns a new Dancer2::Core::Route object created with the passed arguments.

   <b>route_exists</b>
       Returns a true value if a route already exists, otherwise false.

           my $route = Dancer2::Core::Route-&gt;new(...);
           if ($app-&gt;route_exists($route)) {
               ...
           }

   <b>routes_regexps_for</b>
       Sugar for getting the ordered list of all registered route regexps by method.

           my $regexps = $app-&gt;routes_regexps_for( 'get' );

       Returns an ArrayRef with the results.

   <b>redirect($destination,</b> <b>$status)</b>
       Sets a redirect in the response object.  If $destination is not an absolute URI, then it will be made
       into an absolute URI, relative to the URI in the request.

   <b>halt</b>
       Flag the response object as 'halted'.

       If called during request dispatch, immediately returns the response to the dispatcher and after hooks
       will not be run.

   <b>pass</b>
       Flag the response object as 'passed'.

       If called during request dispatch, immediately returns the response to the dispatcher.

   <b>forward</b>
       Create a new request which is a clone of the current one, apart from the path location, which points
       instead to the new location.  This is used internally to chain requests using the forward keyword.

       This method takes 3 parameters: the url to forward to, followed by an optional hashref of parameters
       added to the current request parameters, followed by a hashref of options regarding the redirect, such as
       "method" to change the request method.

       For example:

           forward '/login', { login_failed =&gt; 1 }, { method =&gt; 'GET' });

   <b>app</b>
       Returns itself. This is simply available as a shim to help transition from a previous version in which
       hooks were sent a context object (originally "Dancer2::Core::Context") which has since been removed.

           # before
           hook before =&gt; sub {
               my $ctx = shift;
               my $app = $ctx-&gt;app;
           };

           # after
           hook before =&gt; sub {
               my $app = shift;
           };

       This meant that "$app-&gt;app" would fail, so this method has been provided to make it work.

           # now
           hook before =&gt; sub {
               my $WannaBeCtx = shift;
               my $app        = $WannaBeContext-&gt;app; # works
           };

   <b>lexical_prefix</b>
       Allow for setting a lexical prefix

           $app-&gt;lexical_prefix('/blog', sub {
               ...
           });

       All the route defined within the callback will have a prefix appended to the current one.

    <b>$SIG{__DIE__}</b>  <b>Compatibility</b> <b>via</b>  <b>$Dancer2::Core::App::EVAL_SHIM</b>
       If an installation wishes to use  $SIG{__DIE__}  hooks to enhance their error handling then it may be
       required to ensure that certain bookkeeping code is executed within every "eval BLOCK" that Dancer2
       performs. This can be accomplished by overriding the global variable $Dancer2::Core::App::EVAL_SHIM with
       a subroutine which does whatever logic is required.

       This routine must perform the equivalent of the following subroutine:

           our $EVAL_SHIM = sub {
               my $code = shift;
               return $code-&gt;(@_);
           };

       An example of overriding this sub might be as follows:

           $Dancer2::Core::App::EVAL_SHIM = sub {
               my $code = shift;
               local $IGNORE_EVAL_COUNTER = $IGNORE_EVAL_COUNTER + 1;
               return $code-&gt;(@_);
           };

       <b>Note:</b> that this is a GLOBAL setting, which must be set up before any form of dispatch or use of Dancer2.

</pre><h4><b>AUTHOR</b></h4><pre>
       Dancer Core Developers

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       This software is copyright (c) 2024 by Alexis Sukrieh.

       This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5
       programming language system itself.

perl v5.40.0                                       2024-12-08                            <u>Dancer2::Core::<a href="../man3pm/App.3pm.html">App</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>