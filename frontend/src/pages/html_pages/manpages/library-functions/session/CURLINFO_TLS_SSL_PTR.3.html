<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CURLINFO_TLS_SESSION, CURLINFO_TLS_SSL_PTR - get TLS session info</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcurl4-doc">libcurl4-doc_8.14.1-1ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CURLINFO_TLS_SESSION, CURLINFO_TLS_SSL_PTR - get TLS session info

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;curl/curl.h&gt;

       CURLcode curl_easy_getinfo(CURL *handle, CURLINFO_TLS_SSL_PTR,
                                  struct curl_tlssessioninfo **session);

       /* if you need compatibility with libcurl &lt; 7.48.0 use
          CURLINFO_TLS_SESSION instead: */

       CURLcode curl_easy_getinfo(CURL *handle, CURLINFO_TLS_SESSION,
                                  struct curl_tlssessioninfo **session);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Pass  a  pointer  to  a  <u>struct</u>  <u>curl_tlssessioninfo</u>  *.  The pointer is initialized to refer to a <u>struct</u>
       <u>curl_tlssessioninfo</u> * that contains an enum indicating the SSL library  used  for  the  handshake  and  a
       pointer to the respective internal TLS session structure of this underlying SSL library.

       This  option  may  be  useful  for  example to extract certificate information in a format convenient for
       further processing, such as manual validation. Refer to the <b>LIMITATIONS</b> section.

       struct curl_tlssessioninfo {
         curl_sslbackend backend;
         void *internals;
       };

       The <u>backend</u> struct member is one of these defines: CURLSSLBACKEND_NONE (when built without TLS  support),
       CURLSSLBACKEND_WOLFSSL,  CURLSSLBACKEND_SECURETRANSPORT,  CURLSSLBACKEND_GNUTLS,  CURLSSLBACKEND_MBEDTLS,
       CURLSSLBACKEND_NSS, CURLSSLBACKEND_OPENSSL or CURLSSLBACKEND_SCHANNEL. (Note that the OpenSSL  forks  are
       all reported as just OpenSSL here.)

       The  <u>internals</u>  struct  member  points  to  a  TLS library specific pointer for the active ("in use") SSL
       connection, with the following underlying types:

       GnuTLS <b>gnutls_session_t</b>

       OpenSSL
              <u><a href="../man3/CURLINFO_TLS_SESSION.3.html">CURLINFO_TLS_SESSION</a>(3)</u>: <b>SSL_CTX</b> *

              <u><a href="../man3/CURLINFO_TLS_SSL_PTR.3.html">CURLINFO_TLS_SSL_PTR</a>(3)</u>: <b>SSL</b> * Since 7.48.0 the <u>internals</u> member can  point  to  these  other  SSL
              backends as well:

       mbedTLS
              <b>mbedTLS_ssl_context</b> *

       Secure Channel
              <b>CtxtHandle</b> *

       Secure Transport
              <b>SSLContext</b> *

       wolfSSL
              <b>SSL</b> *

       If the <u>internals</u> pointer is NULL then either the SSL backend is not supported, an SSL session has not yet
       been   established   or   the   connection   is   no   longer  associated  with  the  easy  handle  (e.g.
       <u><a href="../man3/curl_easy_perform.3.html">curl_easy_perform</a>(3)</u> has returned).

</pre><h4><b>LIMITATIONS</b></h4><pre>
       This option has some limitations that could make it unsafe when it comes to the  manual  verification  of
       certificates.

       This  option  only retrieves the first in-use SSL session pointer for your easy handle, however your easy
       handle may have more than one in-use SSL session if using FTP over SSL. That is because the FTP  protocol
       has  a  control  channel and a data channel and one or both may be over SSL. Currently there is no way to
       retrieve a second in-use SSL session associated with an easy handle.

       This option has not been thoroughly tested with clear text  protocols  that  can  be  upgraded/downgraded
       to/from  SSL: FTP, SMTP, POP3, IMAP when used with <u><a href="../man3/CURLOPT_USE_SSL.3.html">CURLOPT_USE_SSL</a>(3)</u>. Though you can to retrieve the SSL
       pointer, it is possible that before you can do that, data (including auth) may  have  already  been  sent
       over a connection after it was upgraded.

       Renegotiation.  If  unsafe  renegotiation  or  renegotiation  in a way that the certificate is allowed to
       change is allowed by your SSL library this may occur  and  the  certificate  may  change,  and  data  may
       continue to be sent or received after renegotiation but before you are able to get the (possibly) changed
       SSL pointer, with the (possibly) changed certificate information.

       Instead  of  using  this  option to poll for certificate changes use <u><a href="../man3/CURLOPT_SSL_CTX_FUNCTION.3.html">CURLOPT_SSL_CTX_FUNCTION</a>(3)</u> to set a
       verification callback, if supported.  That is safer and does not suffer from any of the problems above.

       How are you using this option? Are you affected by any of these  limitations?   Please  let  us  know  by
       making a comment at https://github.com/curl/curl/issues/685

</pre><h4><b>PROTOCOLS</b></h4><pre>
       This functionality affects all TLS based protocols: HTTPS, FTPS, IMAPS, POP3S, SMTPS etc.

       This  option  works  only  with  the  following  TLS backends: BearSSL, GnuTLS, OpenSSL, Schannel, Secure
       Transport, mbedTLS and wolfSSL

</pre><h4><b>EXAMPLE</b></h4><pre>
       #include &lt;curl/curl.h&gt;
       #include &lt;openssl/ssl.h&gt;

       CURL *curl;
       static size_t wf(void *ptr, size_t size, size_t nmemb, void *stream)
       {
         const struct curl_tlssessioninfo *info = NULL;
         CURLcode res = curl_easy_getinfo(curl, CURLINFO_TLS_SSL_PTR, &amp;info);
         if(info &amp;&amp; !res) {
           if(CURLSSLBACKEND_OPENSSL == info-&gt;backend) {
             printf("OpenSSL ver. %s\n", SSL_get_version((SSL*)info-&gt;internals));
           }
         }
         return size * nmemb;
       }

       int main(int argc, char **argv)
       {
         CURLcode res;
         curl = curl_easy_init();
         if(curl) {
           curl_easy_setopt(curl, CURLOPT_URL, "https://example.com");
           curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, wf);
           res = curl_easy_perform(curl);
           curl_easy_cleanup(curl);
         }
         return res;
       }

</pre><h4><b>HISTORY</b></h4><pre>
       This option supersedes <u><a href="../man3/CURLINFO_TLS_SESSION.3.html">CURLINFO_TLS_SESSION</a>(3)</u> which was added in 7.34.0.  This  option  is  exactly  the
       same as that option except in the case of OpenSSL.

</pre><h4><b>AVAILABILITY</b></h4><pre>
       Added in curl 7.48.0

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <u><a href="../man3/curl_easy_getinfo.3.html">curl_easy_getinfo</a>(3)</u> returns a CURLcode indicating success or error.

       CURLE_OK (0) means everything was OK, non-zero means an error occurred, see <u><a href="../man3/libcurl-errors.3.html">libcurl-errors</a>(3)</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/CURLINFO_TLS_SESSION.3.html">CURLINFO_TLS_SESSION</a></b>(3), <b><a href="../man3/curl_easy_getinfo.3.html">curl_easy_getinfo</a></b>(3), <b><a href="../man3/curl_easy_setopt.3.html">curl_easy_setopt</a></b>(3)

libcurl                                            2025-06-16                            <u><a href="../man3/CURLINFO_TLS_SSL_PTR.3.html">CURLINFO_TLS_SSL_PTR</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>