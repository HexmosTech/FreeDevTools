<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>coap_session, coap_session_reference, coap_session_release, coap_session_disconnected,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcoap3t64">libcoap3t64_4.3.4-1.1build4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       coap_session, coap_session_reference, coap_session_release, coap_session_disconnected,
       coap_session_set_type_client, coap_session_set_app_data, coap_session_get_app_data,
       coap_session_get_addr_local, coap_session_get_addr_mcast, coap_session_get_addr_remote,
       coap_session_get_context, coap_session_get_ifindex, coap_session_get_proto, coap_session_get_state,
       coap_session_get_tls, coap_session_get_type, coap_session_get_psk_hint, coap_session_get_psk_key - Work
       with CoAP sessions

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;coap3/coap.h&gt;</b>

       <b>coap_session_t</b> <b>*coap_session_reference(coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>void</b> <b>coap_session_release(coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>void</b> <b>coap_session_disconnected(coap_session_t</b> <b>*</b><u>session</u><b>,</b> <b>coap_nack_reason_t</b> <u>reason</u><b>);</b>

       <b>int</b> <b>coap_session_set_type_client(coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>void</b> <b>coap_session_set_app_data(coap_session_t</b> <b>*</b><u>session</u><b>,</b> <b>void</b> <b>*</b><u>data</u><b>);</b>

       <b>void</b> <b>*coap_session_get_app_data(const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>const</b> <b>coap_address_t</b> <b>*coap_session_get_addr_local(</b> <b>const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>const</b> <b>coap_address_t</b> <b>*coap_session_get_addr_mcast(</b> <b>const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>const</b> <b>coap_address_t</b> <b>*coap_session_get_addr_remote(</b> <b>const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>coap_context_t</b> <b>*coap_session_get_context(const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>int</b> <b>coap_session_get_ifindex(const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>coap_proto_t</b> <b>coap_session_get_proto(const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>coap_session_state_t</b> <b>coap_session_get_state(const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>void</b> <b>*coap_session_get_tls(const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>,</b> <b>coap_tls_library_t</b> <b>*tls_lib);</b>

       <b>coap_session_type_t</b> <b>coap_session_get_type(const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>const</b> <b>coap_bin_const_t</b> <b>*coap_session_get_psk_hint(</b> <b>const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       <b>const</b> <b>coap_bin_const_t</b> <b>*coap_session_get_psk_key(</b> <b>const</b> <b>coap_session_t</b> <b>*</b><u>session</u><b>);</b>

       For specific (D)TLS library support, link with <b>-lcoap-3-notls</b>, <b>-lcoap-3-gnutls</b>, <b>-lcoap-3-openssl</b>,
       <b>-lcoap-3-mbedtls</b> or <b>-lcoap-3-tinydtls</b>. Otherwise, link with <b>-lcoap-3</b> to get the default (D)TLS library
       support.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This man page focuses on the CoAP Session and how to update or get information from the opaque
       coap_session_t structure.

       A CoAP Session maintains the state of an ongoing connection between a Client and Server which is stored
       in a coap_session_t Session object. A CoAP session is tracked by local port, CoAP protocol, remote IP
       address and remote port.

       The Session network traffic can be encrypted or un-encrypted if there is an underlying TLS library.

</pre><h4><b>FUNCTIONS</b></h4><pre>
       <b>Function:</b> <b>coap_session_reference()</b>

       The <b>coap_session_reference</b>() function is used to increment the reference count of the <u>session</u>.
       Incrementing the reference count by an application means that the library will not inadvertently remove
       the session when it has finished processing the session.

       <b>Function:</b> <b>coap_session_release()</b>

       The <b>coap_session_release</b>() function is be used to decrement the <u>session</u> reference count, which when it
       gets to 0, will:-

       If type Client, free off the session which then clears all entries from the receive queue and send queue.
       <b>NOTE:</b> All client sessions start off with a reference count of 1.

       If type Server, then the <u>session</u> is added to an idle pool ready for subsequent re-use. If the Server
       <u>session</u> is not used for 5 minutes, then it will get completely freed off. <b>NOTE:</b> Unless the application
       increments the reference count, this is the case for all type server sessions as they start with a
       reference count of 0.

       <b>Function:</b> <b>coap_session_disconnected()</b>

       The <b>coap_session_disconnected</b>() function is used to force the closure of a <u>session</u> for the reason <u>reason</u>.
       It will cause any outstanding traffic to get dropped.

       <b>Function:</b> <b>coap_session_set_type_client()</b>

       The <b>coap_session_set_type_client</b>() function is used to convert the <u>session</u> frrm a session endpoint type
       of Server to Client. This typically is used in a Call-Home type environment where the roles have to
       change following the establishment of a session. The reference count is incremented by 1.

       <b>Function:</b> <b>coap_session_set_app_data()</b>

       The <b>coap_session_set_app_data</b>() function is used to define a <u>data</u> pointer for the <u>session</u> which can then
       be retrieved at a later date.

       <b>Function:</b> <b>coap_session_get_app_data()</b>

       The <b>coap_session_get_app_data</b>() function is used to retrieve the data pointer previously defined by
       <b>coap_session_set_app_data</b>().

       <b>Function:</b> <b>coap_session_get_addr_local()</b>

       The <b>coap_session_get_addr_local</b>() function is used to get the local IP address and port information from
       the <u>session</u>.

       <b>Function:</b> <b>coap_session_get_addr_mcast()</b>

       The <b>coap_session_get_addr_mcast</b>() function is used to get the remote (peer) multicast IP address and port
       information from the <u>session</u> if the <u>session</u> was originally set up to send requests to a multicast IP.

       <b>Function:</b> <b>coap_session_get_addr_remote()</b>

       The <b>coap_session_get_addr_remote</b>() function is used to get the remote (peer) IP address and port
       information from the <u>session</u>. If the <u>session</u> was originally set up to send requests to a multicast IP,
       then the returned IP will be that of the unicast response from a peer. The returned IP will get set back
       to the multicast IP when the next <b><a href="../man3/coap_send.3.html">coap_send</a></b>(3) is called.

       <b>Function:</b> <b>coap_session_get_context()</b>

       The <b>coap_session_get_context</b>() function is used to get the CoAP context associated with the <u>session</u>.

       <b>Function:</b> <b>coap_session_get_ifindex()</b>

       The <b>coap_session_get_ifindex</b>() function is used to get the network interface index that the traffic came
       in over from the <u>session</u>.

           COAP_PROTO_UDP
           COAP_PROTO_DTLS
           COAP_PROTO_TCP
           COAP_PROTO_TLS
           COAP_PROTO_WS
           COAP_PROTO_WSS

       The <b>coap_session_get_proto</b>() function is used to get the CoAP protocol from the <u>session</u>.

           COAP_SESSION_STATE_NONE
           COAP_SESSION_STATE_CONNECTING
           COAP_SESSION_STATE_HANDSHAKE
           COAP_SESSION_STATE_CSM
           COAP_SESSION_STATE_ESTABLISHED

       The <b>coap_session_get_state</b>() function is used to get the current state of the <u>session</u>.

           OpenSSL:  SSL*
           GnuTLS:   gnutls_session_t (implicit *)
           Mbed TLS: mbedtls_ssl_context*
           TinyDTLS: struct dtls_context*

       The <b>coap_session_get_tls</b>() function is used to get the pointer to the TLS information from the <u>session</u>.
       This is TLS library specific. <u>tls_lib</u> is updated with the underlying (D)TLS library type.

           COAP_SESSION_TYPE_CLIENT
           COAP_SESSION_TYPE_SERVER
           COAP_SESSION_TYPE_HELLO  /* Negotiating a (D)TLS session */

       The <b>coap_session_get_type</b>() function is used to get the session type from the <u>session</u>.

       The <b>coap_session_get_psk_hint</b>() function is used to get the current server <u>session</u>'s pre-shared-key
       identity hint.

       The <b>coap_session_get_psk_key</b>() function is used to get the current <u>session</u>'s pre-shared-key key
       information.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>coap_session_reference</b>() returns a pointer to the session.

       <b>coap_session_set_type_client</b>() returns 1 on success, otherwise 0.

       <b>coap_session_get_app_data</b>() returns a previously defined pointer.

       <b>coap_session_get_addr_local</b>() and <b>coap_session_get_addr_remote</b>() return a pointer to the IP address /
       port or NULL on error.

       <b>coap_session_get_addr_mcast</b>() returns a pointer to the remote multicast IP address / port or NULL on
       error or this is not a multicast session.

       <b>coap_session_get_context</b>() returns a pointer to the current CoAP Context or NULL on error.

       <b>coap_session_get_ifindex</b>() returns the network interface the traffic last came in over, or -1 on error.

       <b>coap_session_get_proto</b>() returns the current session’s protocol or 0 on error.

       <b>coap_session_get_state</b>() returns the current session’s state or 0 on error.

       <b>coap_session_get_tls</b>() returns a pointer to the current session’s TLS information (TLS library dependent)
       or NULL if there is none or there is an error.

       <b>coap_session_get_type</b>() returns the current session’s type or 0 on error.

       <b>coap_session_get_psk_hint</b>() returns the current server session’s pre-shared-key identity hint, or NULL if
       not defined.

       <b>coap_session_get_psk_key</b>() returns the current session’s pre-shared-key key information, or NULL if not
       defined.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/coap_context.3.html">coap_context</a></b>(3), <b><a href="../man3/coap_endpoint_client.3.html">coap_endpoint_client</a></b>(3) and <b><a href="../man3/coap_endpoint_server.3.html">coap_endpoint_server</a></b>(3)

</pre><h4><b>FURTHER</b> <b>INFORMATION</b></h4><pre>
       See

       "RFC7252: The Constrained Application Protocol (CoAP)"

       for further information.

</pre><h4><b>BUGS</b></h4><pre>
       Please report bugs on the mailing list for libcoap: <a href="mailto:libcoap-developers@lists.sourceforge.net">libcoap-developers@lists.sourceforge.net</a> or raise an
       issue on GitHub at https://github.com/obgm/libcoap/issues

</pre><h4><b>AUTHORS</b></h4><pre>
       The libcoap project &lt;<a href="mailto:libcoap-developers@lists.sourceforge.net">libcoap-developers@lists.sourceforge.net</a>&gt;

coap_session 4.3.4                                 04/15/2024                                    <u><a href="../man3/COAP_SESSION.3.html">COAP_SESSION</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>