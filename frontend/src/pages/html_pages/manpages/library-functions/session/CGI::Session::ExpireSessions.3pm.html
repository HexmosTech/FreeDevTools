<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CGI::Session::ExpireSessions - Expires CGI::Session db-based and file-based sessions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcgi-session-expiresessions-perl">libcgi-session-expiresessions-perl_1.14-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CGI::Session::ExpireSessions - Expires CGI::Session db-based and file-based sessions

</pre><h4><b>Synopsis</b></h4><pre>
               #!<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?env">/usr/bin/env</a> perl

               use strict;
               use warnings;

               use CGI::Session::ExpireSessions;
               use DBI;

               # -----------------------------------------------

               my($dbh) = DBI -&gt; connect
               (
                 'dbi:mysql:aussi:127.0.0.1',
                 'root',
                 'pass',
                 {
                   AutoCommit         =&gt; 1,
                   PrintError         =&gt; 0,
                   RaiseError         =&gt; 1,
                   ShowErrorStatement =&gt; 1,
                 }
               );

               CGI::Session::ExpireSessions -&gt; new(dbh =&gt; $dbh, verbose =&gt; 1) -&gt; expire_db_sessions();
               CGI::Session::ExpireSessions -&gt; new(temp_dir =&gt; '<a href="file:/tmp">/tmp</a>', verbose =&gt; 1) -&gt; expire_file_sessions();
               CGI::Session::ExpireSessions -&gt; new(verbose =&gt; 1) -&gt; expire_sessions();

               # Note: You are strongly urged to use method expire_sessions() (it requires CGI::Session V 4 or later),
               # since it does not eval the session data, and hence avoids the security issues of evaling a string
               # which comes from outside the program. See examples/expire-set.pl, which contains extensive comments.

</pre><h4><b>Description</b></h4><pre>
       "CGI::Session::ExpireSessions" is a pure Perl module.

       It deletes "CGI::Session"-type sessions which have passed their use-by date.

       It works with "CGI::Session"-type sessions in a database or in disk files, but does not appear to work
       with "CGI::Session::PureSQL"-type sessions.

       The recommended way to use this module is via method "expire_sessions()", which requires "CGI::Session" V
       4 or later.

       Sessions can be expired under one of three conditions:

       o You deem the session to be expired as of now
           o Methods: "expire_db_sessions()" and "expire_file_sessions()"
               You  want the session to be expired and hence deleted now because it's last access time is longer
               ago than the time you specify in the call to new, using the delta parameter.

               That is, delete the session because the time span, between the "last access"  time  and  now,  is
               greater than delta.

               In other words, force sessions to expire.

               The module has always used this condition to delete sessions.

           o Method: "expire_sessions()"
               You  want  the  session  to  be  expired and hence deleted now because it's "last access" time is
               longer ago than the time you specify in the call to new, using the delta parameter.

       o The session has already expired
           This  section  applies  to  all  3  methods:  "expire_db_sessions()",  "expire_file_sessions()"   and
           "expire_sessions()".

           This condition is new as of V 1.02.

           You want the session to be deleted now because it has already expired.

           That is, you want this module to delete the session, rather than getting "CGI::Session" to delete it,
           when "CGI::Session" would delete the session automatically if you used "CGI::Session" to retrieve the
           session.

           Note: This condition assumes the session's expiration time is defined (it does not have to be).

       o The file size is &lt;= 5 bytes and was accessed more than 'delta' seconds ago
           This condition is new as of V 1.03.

           This section applies to method: "expire_file_sessions()".

           See below for how to provide a value of delta to the constructor.

           Old  versions of "CGI::Session" sometimes create a file of size 0 bytes, so this test checks for such
           files, and deletes them if they are old enough.

       Sessions are deleted if any of these conditions is true.

       Sessions are deleted from the 'sessions' table in the database, or from the temp directory, depending  on
       how you use "CGI::Session".

</pre><h4><b>Distributions</b></h4><pre>
       This module is available both as a Unix-style distro (*.tgz) and an ActiveState-style distro (*.ppd). The
       latter is shipped in a *.zip file.

       See <a href="http://savage.net.au/Perl-modules.html">http://savage.net.au/Perl-modules.html</a> for details.

       See  <a href="http://savage.net.au/Perl-modules/html/installing-a-module.html">http://savage.net.au/Perl-modules/html/installing-a-module.html</a> for help on unpacking and installing
       each type of distro.

</pre><h4><b>Security</b></h4><pre>
       For file-based sessions, method "expire_file_sessions()" parses the contents of the file,  using  eval{},
       in an attempt to determine the access and expiration times recorded within the file.

       So,  if  you are uneasy about the security implication of this (as you should be), don't use this method.
       Use method "expire_sessions()" instead. The latter is a much more sophisticated way of expiring sessions,
       but it does require "CGI::Session" V 4 or later.

</pre><h4><b>Constructor</b> <b>and</b> <b>initialization</b></h4><pre>
       new(...) returns a "CGI::Session::ExpireSessions" object.

       This is the class's contructor.

       Usage: CGI::Session::ExpireSessions -&gt; <b>new()</b>.

       This method takes a set of parameters. Only some of these parameters are mandatory.

       For each parameter, call method "new()" as new(param_1 =&gt; value_1, param_2 =&gt; value_2, ...).

       Note: As of V 1.07 of this module, you may call method "set()" to set  parameters  after  calling  method
       "new()".

       Not   only   that,   but   you   may   pass   into   all   of   the   3  methods  "expire_db_sessions()",
       "expire_file_sessions()" and "expire_sessions()" any of the parameters accepted by "new()", since these 3
       methods call "set()" if their caller provides parameters.

       Parameters which can be used with "new()", "set()", or "expire_*()":

       o cgi_session_dsn
           This is the DSN (Data Source Name) used by "CGI::Session"  to  control  what  type  of  sessions  you
           previously created and what type of sessions you now wish to expire.

           Do  not confuse this with the DSN used by "CGI::Session"'s method find(param_1, \&amp;sub, {DataSource =&gt;
           other_dsn...}, ...)  when referring to db-based sessions.

           Method "expire_sessions()" is the only method in this module which uses this parameter.

           So, when you call "expire_sessions()", this parameter -  cgi_session_dsn  -  determines  the  set  of
           sessions processed by, and possibly expired by, the call to "expire_sessions()".

           The default value is undef, which means "CGI::Session" defaults to file-based sessions.

           This parameter is optional for file-based sessions, and mandatory for db-based sessions.

       o dbh
           This is a database handle for the database containing the table 'sessions'.

           Either this parameter is mandatory, or the temp_dir parameter is mandatory.

       o delta
           o Methods: "expire_db_sessions()" and "expire_file_sessions()"
               This is the number of seconds since the "last access" to the session, which determines whether or
               not the session will be expired.

           o Method: "expire_sessions()"
               This  is  the  number  of  seconds  since the "last access" time of the session, which determines
               whether or not the session will be expired.

           The default value is 2 * 24 * 60 * 60, which is the number of seconds in 2 days.

           By default, then, sessions which were last accessed more than 2 days ago are expired.

           This parameter is optional.

       o dsn_args
           If your cgi_session_dsn uses file-based storage, then this hashref might contain keys such as:

                   {
                           Directory =&gt; Value 1,
                           NoFlock   =&gt; Value 2,
                           UMask     =&gt; Value 3
                   }

           If your cgi_session_dsn uses db-based storage, then this hashref contains (up to) 3 keys,  and  looks
           like:

                   {
                           DataSource =&gt; Value 1,
                           User       =&gt; Value 2,
                           Password   =&gt; Value 3
                   }

           These  3  form  the DSN, username and password used by DBI to control access to your database server,
           and hence are only relevant when using db-based sessions.

           Method "expire_sessions()" is the only method in this module which uses the parameter dsn_args.

           The default value for this parameter is undef.

           These parameters are optional for file-based sessions, and mandatory for db-based sessions.

       o table_name
           This is the name of the database table used to hold the sessions.

           The default value is 'sessions'.

           This parameter is optional.

       o temp_dir
           This is the name of the temp directory where you store CGI::Session-type session files.

           The default value is '<a href="file:/tmp">/tmp</a>'.

           Either this parameter is mandatory, or the dbh parameter is mandatory.

       o time
           The session's "last access" time is subtracted from the value of this parameter, and if the result is
           greater than or equal to the value of parameter 'delta', then the session is expired.

           Method "expire_sessions()" is the only method in this module which uses this parameter.

           The default value is obtained by calling <b>time()</b>.

           This parameter is optional.

       o verbose
           This is a integer, 0 or 1, which - when set to 1 - causes progress messages to be written to STDOUT.

           The default value is 0.

           This parameter is optional.

</pre><h4><b>Method:</b> <b>expire_db_sessions()</b></h4><pre>
       Returns nothing.

       This method uses the dbh parameter passed to "new()" to delete database-type sessions.

</pre><h4><b>Method:</b> <b>expire_file_sessions()</b></h4><pre>
       Returns nothing.

       This method uses the temp_dir parameter passed to "new()" to delete file-type sessions.

</pre><h4><b>Method:</b> <b>expire_sessions()</b></h4><pre>
       Return value:

       o undef
           Returns undef if your version of "CGI::Session" does not support method "find()".

           Also, returns undef when "CGI::Session"'s method "find()" failed for some reason.

       o 1 Returns 1 when "find()" succeeds.

       Returns the result of calling CGI::Session's method <b>find()</b>, which will be undef for some sort of failure,
       and 1 for success.

       This method handles both file-based and db-based sessions.

</pre><h4><b>Example</b> <b>code</b></h4><pre>
       See the examples/ directory in the distro.

       There are 2 demo programs: expire-sessions.pl and expire-set.pl.

</pre><h4><b>SUPPORT</b></h4><pre>
       Bugs should be reported via the CPAN bug tracker at

       &lt;https://github.com/ronsavage/CGI-Session-ExpireSessions/issues&gt;

</pre><h4><b>REPOSITORY</b></h4><pre>
       &lt;https://github.com/ronsavage/CGI-Session-ExpireSessions&gt;.

</pre><h4><b>Author</b></h4><pre>
       "CGI::Session::ExpireSessions" was written by Ron Savage <u>&lt;<a href="mailto:ron@savage.net.au">ron@savage.net.au</a>&gt;</u> in 2004.

       Home page: <a href="http://savage.net.au/index.html">http://savage.net.au/index.html</a>

</pre><h4><b>Copyright</b></h4><pre>
       Australian copyright (c) 2004, Ron Savage.       All Programs of mine  are  'OSI  Certified  Open  Source
       Software';       you  can  redistribute  them  and/or  modify  them  under the terms of      The Artistic
       License, a copy of which is available at:      <a href="http://www.opensource.org/licenses/index.html">http://www.opensource.org/licenses/index.html</a>

perl v5.32.1                                       2021-09-25                  <u>CGI::Session::<a href="../man3pm/ExpireSessions.3pm.html">ExpireSessions</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>