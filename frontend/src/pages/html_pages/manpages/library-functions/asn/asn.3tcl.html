<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>asn - ASN.1 BER encoder/decoder</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       asn - ASN.1 BER encoder/decoder

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>asn</b> <b>?0.8.5?</b>

       <b>::asn::asnSequence</b> <u>evalue</u>...

       <b>::asn::asnSequenceFromList</b> <u>elist</u>

       <b>::asn::asnSet</b> <u>evalue</u>...

       <b>::asn::asnSetFromList</b> <u>elist</u>

       <b>::asn::asnApplicationConstr</b> <u>appNumber</u> <u>evalue</u>...

       <b>::asn::asnApplication</b> <u>appNumber</u> <u>data</u>

       <b>::asn::asnChoice</b> <u>appNumber</u> <u>evalue</u>...

       <b>::asn::asnChoiceConstr</b> <u>appNumber</u> <u>evalue</u>...

       <b>::asn::asnInteger</b> <u>number</u>

       <b>::asn::asnEnumeration</b> <u>number</u>

       <b>::asn::asnBoolean</b> <u>bool</u>

       <b>::asn::asnContext</b> <u>context</u> <u>data</u>

       <b>::asn::asnContextConstr</b> <u>context</u> <u>evalue</u>...

       <b>::asn::asnObjectIdentifier</b> <u>idlist</u>

       <b>::asn::asnUTCTime</b> <u>utcstring</u>

       <b>::asn::asnNull</b>

       <b>::asn::asnBitString</b> <u>string</u>

       <b>::asn::asnOctetString</b> <u>string</u>

       <b>::asn::asnNumericString</b> <u>string</u>

       <b>::asn::asnPrintableString</b> <u>string</u>

       <b>::asn::asnIA5String</b> <u>string</u>

       <b>::asn::asnBMPString</b> <u>string</u>

       <b>::asn::asnUTF8String</b> <u>string</u>

       <b>::asn::asnString</b> <u>string</u>

       <b>::asn::defaultStringType</b> ?<u>type</u>?

       <b>::asn::asnPeekByte</b> <u>data_var</u> <u>byte_var</u>

       <b>::asn::asnGetLength</b> <u>data_var</u> <u>length_var</u>

       <b>::asn::asnGetResponse</b> <u>chan</u> <u>data_var</u>

       <b>::asn::asnGetInteger</b> <u>data_var</u> <u>int_var</u>

       <b>::asn::asnGetEnumeration</b> <u>data_var</u> <u>enum_var</u>

       <b>::asn::asnGetOctetString</b> <u>data_var</u> <u>string_var</u>

       <b>::asn::asnGetString</b> <u>data_var</u> <u>string_var</u> ?<u>type_var</u>?

       <b>::asn::asnGetNumericString</b> <u>data_var</u> <u>string_var</u>

       <b>::asn::asnGetPrintableString</b> <u>data_var</u> <u>string_var</u>

       <b>::asn::asnGetIA5String</b> <u>data_var</u> <u>string_var</u>

       <b>::asn::asnGetBMPString</b> <u>data_var</u> <u>string_var</u>

       <b>::asn::asnGetUTF8String</b> <u>data_var</u> <u>string_var</u>

       <b>::asn::asnGetUTCTime</b> <u>data_var</u> <u>utc_var</u>

       <b>::asn::asnGetBitString</b> <u>data_var</u> <u>bits_var</u>

       <b>::asn::asnGetObjectIdentifier</b> <u>data_var</u> <u>oid_var</u>

       <b>::asn::asnGetBoolean</b> <u>data_var</u> <u>bool_var</u>

       <b>::asn::asnGetNull</b> <u>data_var</u>

       <b>::asn::asnGetSequence</b> <u>data_var</u> <u>sequence_var</u>

       <b>::asn::asnGetSet</b> <u>data_var</u> <u>set_var</u>

       <b>::asn::asnGetApplication</b> <u>data_var</u> <u>appNumber_var</u> ?<u>content_var</u>? ?<u>encodingType_var</u>?

       <b>::asn::asnGetContext</b> <u>data_var</u> <u>contextNumber_var</u> ?<u>content_var</u>? ?<u>encodingType_var</u>?

       <b>::asn::asnPeekTag</b> <u>data_var</u> <u>tag_var</u> <u>tagtype_var</u> <u>constr_var</u>

       <b>::asn::asnTag</b> <u>tagnumber</u> ?<u>class</u>? ?<u>tagstyle</u>?

       <b>::asn::asnRetag</b> <u>data_var</u> <u>newTag</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>asn</b> package provides <u>partial</u> de- and encoder commands for BER encoded ASN.1 data. It can also be used
       for decoding DER, which is a restricted subset of BER.

       ASN.1 is a standard <u>Abstract</u> <u>Syntax</u> <u>Notation</u>, and BER are its <u>Basic</u> <u>Encoding</u> <u>Rules</u>.

       See <u><a href="http://asn1.elibel.tm.fr/en/standards/index.htm">http://asn1.elibel.tm.fr/en/standards/index.htm</a></u> for more information about the standard.

       Also  see <u><a href="http://luca.ntop.org/Teaching/Appunti/asn1.html">http://luca.ntop.org/Teaching/Appunti/asn1.html</a></u> for <u>A</u> <u>Layman's</u> <u>Guide</u> <u>to</u> <u>a</u> <u>Subset</u> <u>of</u> <u>ASN.1,</u> <u>BER,</u>
       <u>and</u> <u>DER</u>, an RSA Laboratories Technical Note by Burton S. Kaliski Jr. (Revised November 1, 1993).  A  text
       version of this note is part of the module sources and should be read by any implementor.

</pre><h4><b>PUBLIC</b> <b>API</b></h4><pre>
   <b>ENCODER</b>
       <b>::asn::asnSequence</b> <u>evalue</u>...
              Takes  zero or more encoded values, packs them into an ASN sequence and returns its encoded binary
              form.

       <b>::asn::asnSequenceFromList</b> <u>elist</u>
              Takes a list of encoded values, packs them into an ASN sequence and  returns  its  encoded  binary
              form.

       <b>::asn::asnSet</b> <u>evalue</u>...
              Takes zero or more encoded values, packs them into an ASN set and returns its encoded binary form.

       <b>::asn::asnSetFromList</b> <u>elist</u>
              Takes a list of encoded values, packs them into an ASN set and returns its encoded binary form.

       <b>::asn::asnApplicationConstr</b> <u>appNumber</u> <u>evalue</u>...
              Takes  zero  or  more encoded values, packs them into an ASN application construct and returns its
              encoded binary form.

       <b>::asn::asnApplication</b> <u>appNumber</u> <u>data</u>
              Takes a single encoded value <u>data</u>, packs it into an ASN  application  construct  and  returns  its
              encoded binary form.

       <b>::asn::asnChoice</b> <u>appNumber</u> <u>evalue</u>...
              Takes zero or more encoded values, packs them into an ASN choice construct and returns its encoded
              binary form.

       <b>::asn::asnChoiceConstr</b> <u>appNumber</u> <u>evalue</u>...
              Takes zero or more encoded values, packs them into an ASN choice construct and returns its encoded
              binary form.

       <b>::asn::asnInteger</b> <u>number</u>
              Returns the encoded form of the specified integer <u>number</u>.

       <b>::asn::asnEnumeration</b> <u>number</u>
              Returns the encoded form of the specified enumeration id <u>number</u>.

       <b>::asn::asnBoolean</b> <u>bool</u>
              Returns the encoded form of the specified boolean value <u>bool</u>.

       <b>::asn::asnContext</b> <u>context</u> <u>data</u>
              Takes  an  encoded  value  and packs it into a constructed value with application tag, the <u>context</u>
              number.

       <b>::asn::asnContextConstr</b> <u>context</u> <u>evalue</u>...
              Takes zero or more encoded values and packs them into a constructed value  with  application  tag,
              the <u>context</u> number.

       <b>::asn::asnObjectIdentifier</b> <u>idlist</u>
              Takes  a  list of at least 2 integers describing an object identifier (OID) value, and returns the
              encoded value.

       <b>::asn::asnUTCTime</b> <u>utcstring</u>
              Returns the encoded form of the specified UTC time string.

       <b>::asn::asnNull</b>
              Returns the NULL encoding.

       <b>::asn::asnBitString</b> <u>string</u>
              Returns the encoded form of the specified <u>string</u>.

       <b>::asn::asnOctetString</b> <u>string</u>
              Returns the encoded form of the specified <u>string</u>.

       <b>::asn::asnNumericString</b> <u>string</u>
              Returns the <u>string</u> encoded as  ASN.1  NumericString.  Raises  an  error  if  the  <u>string</u>  contains
              characters other than decimal numbers and space.

       <b>::asn::asnPrintableString</b> <u>string</u>
              Returns  the  <u>string</u>  encoding  as  ASN.1  PrintableString. Raises an error if the <u>string</u> contains
              characters which are not allowed by the Printable String datatype. The allowed characters are A-Z,
              a-z, 0-9, space, apostrophe, colon,  parentheses,  plus,  minus,  comma,  period,  forward  slash,
              question mark, and the equals sign.

       <b>::asn::asnIA5String</b> <u>string</u>
              Returns  the  <u>string</u>  encoded  as  ASN.1  IA5String.  Raises  an  error if the <u>string</u> contains any
              characters outside of the US-ASCII range.

       <b>::asn::asnBMPString</b> <u>string</u>
              Returns the <u>string</u> encoded as ASN.1 Basic Multilingual Plane  string  (Which  is  essentialy  big-
              endian UCS2).

       <b>::asn::asnUTF8String</b> <u>string</u>
              Returns  the  <u>string</u>  encoded  as  UTF8 String. Note that some legacy applications such as Windows
              CryptoAPI do not like UTF8 strings. Use BMPStrings if you are not sure.

       <b>::asn::asnString</b> <u>string</u>
              Returns an encoded form of <u>string</u>, choosing the most restricted ASN.1 string type possible. If the
              string contains non-ASCII characters, then there is more than one string type which can  be  used.
              See <b>::asn::defaultStringType</b>.

       <b>::asn::defaultStringType</b> ?<u>type</u>?
              Selects the string type to use for the encoding of non-ASCII strings. Returns current default when
              called  without  argument.  If  the  argument <u>type</u> is supplied, it should be either <b>UTF8</b> or <b>BMP</b> to
              choose UTF8String or BMPString respectively.

   <b>DECODER</b>
       General notes:

       [1]    Nearly all decoder commands take two arguments. These arguments are  variable  names,  except  for
              <b>::asn::asnGetResponse</b>.  The  first  variable  contains  the  encoded  ASN  value  to decode at the
              beginning, and more, and the second variable is where the value is stored to. The remainder of the
              input after the decoded value is stored back into the datavariable.

       [2]    After extraction the data variable is always modified first, before by writing the extracted value
              to its variable. This means that if both arguments refer to the  same  variable,  it  will  always
              contain the extracted value after the call, and not the remainder of the input.

       <b>::asn::asnPeekByte</b> <u>data_var</u> <u>byte_var</u>
              Retrieve  the  first  byte  of the data, without modifing <u>data_var</u>.  This can be used to check for
              implicit tags.

       <b>::asn::asnGetLength</b> <u>data_var</u> <u>length_var</u>
              Decode the length information for a block of BER data. The tag has already to be removed from  the
              data.

       <b>::asn::asnGetResponse</b> <u>chan</u> <u>data_var</u>
              Reads  an  encoded  ASN  <u>sequence</u>  from  the channel <u>chan</u> and stores it into the variable named by
              <u>data_var</u>.

       <b>::asn::asnGetInteger</b> <u>data_var</u> <u>int_var</u>
              Assumes that an encoded integer value is at the front of the data stored  in  the  variable  named
              <u>data_var</u>,  extracts  and  stores  it  into the variable named by <u>int_var</u>. Additionally removes all
              bytes associated with the value from the data for further  processing  by  the  following  decoder
              commands.

       <b>::asn::asnGetEnumeration</b> <u>data_var</u> <u>enum_var</u>
              Assumes  that an enumeration id is at the front of the data stored in the variable named <u>data_var</u>,
              and stores it into the variable named by <u>enum_var</u>. Additionally removes all bytes associated  with
              the value from the data for further processing by the following decoder commands.

       <b>::asn::asnGetOctetString</b> <u>data_var</u> <u>string_var</u>
              Assumes  that  a  string  is  at  the front of the data stored in the variable named <u>data_var</u>, and
              stores it into the variable named by <u>string_var</u>. Additionally removes all  bytes  associated  with
              the value from the data for further processing by the following decoder commands.

       <b>::asn::asnGetString</b> <u>data_var</u> <u>string_var</u> ?<u>type_var</u>?
              Decodes  a  user-readable  string.  This  is a convenience function which is able to automatically
              distinguish all supported ASN.1 string types and  convert  the  input  value  appropriately.   See
              <b>::asn::asnGetPrintableString</b>,  <b>::asnGetIA5String</b>,  etc.   below  for  the type-specific conversion
              commands.

              If the optional third argument <u>type_var</u> is supplied, then the  type  of  the  incoming  string  is
              stored in the variable named by it.

              The   function  throws  the  error  "Invalid  command  name  asnGetSome<b>UnsupportedString</b>"  if  the
              unsupported string type <b>Unsupported</b> is  encountered.  You  can  create  the  appropriate  function
              "asn::asnGetSome<b>UnsupportedString</b>" in your application if neccessary.

       <b>::asn::asnGetNumericString</b> <u>data_var</u> <u>string_var</u>
              Assumes  that  a  numeric  string  value  is at the front of the data stored in the variable named
              <u>data_var</u>, and stores it into the variable named by  <u>string_var</u>.  Additionally  removes  all  bytes
              associated with the value from the data for further processing by the following decoder commands.

       <b>::asn::asnGetPrintableString</b> <u>data_var</u> <u>string_var</u>
              Assumes  that  a  printable  string value is at the front of the data stored in the variable named
              <u>data_var</u>, and stores it into the variable named by  <u>string_var</u>.  Additionally  removes  all  bytes
              associated with the value from the data for further processing by the following decoder commands.

       <b>::asn::asnGetIA5String</b> <u>data_var</u> <u>string_var</u>
              Assumes  that  a IA5 (ASCII) string value is at the front of the data stored in the variable named
              <u>data_var</u>, and stores it into the variable named by  <u>string_var</u>.  Additionally  removes  all  bytes
              associated with the value from the data for further processing by the following decoder commands.

       <b>::asn::asnGetBMPString</b> <u>data_var</u> <u>string_var</u>
              Assumes  that  a  BMP  (two-byte  unicode)  string value is at the front of the data stored in the
              variable named <u>data_var</u>, and stores it into the variable named by <u>string_var</u>, converting it into a
              proper Tcl string. Additionally removes all bytes associated with the  value  from  the  data  for
              further processing by the following decoder commands.

       <b>::asn::asnGetUTF8String</b> <u>data_var</u> <u>string_var</u>
              Assumes  that  a  UTF8  string  value  is  at  the  front of the data stored in the variable named
              <u>data_var</u>, and stores it into the variable named by <u>string_var</u>, converting it  into  a  proper  Tcl
              string.   Additionally  removes  all  bytes  associated  with  the value from the data for further
              processing by the following decoder commands.

       <b>::asn::asnGetUTCTime</b> <u>data_var</u> <u>utc_var</u>
              Assumes that a UTC time value is at the front of the data stored in the variable  named  <u>data_var</u>,
              and  stores it into the variable named by <u>utc_var</u>. The UTC time value is stored as a string, which
              has to be decoded with the usual clock scan commands.  Additionally removes all  bytes  associated
              with the value from the data for further processing by the following decoder commands.

       <b>::asn::asnGetBitString</b> <u>data_var</u> <u>bits_var</u>
              Assumes that a bit string value is at the front of the data stored in the variable named <u>data_var</u>,
              and  stores  it  into  the  variable  named  by  <u>bits_var</u>  as  a  string  containing only 0 and 1.
              Additionally removes all bytes associated with the value from the data for further  processing  by
              the following decoder commands.

       <b>::asn::asnGetObjectIdentifier</b> <u>data_var</u> <u>oid_var</u>
              Assumes  that  a  object identifier (OID) value is at the front of the data stored in the variable
              named <u>data_var</u>, and stores it  into  the  variable  named  by  <u>oid_var</u>  as  a  list  of  integers.
              Additionally  removes  all bytes associated with the value from the data for further processing by
              the following decoder commands.

       <b>::asn::asnGetBoolean</b> <u>data_var</u> <u>bool_var</u>
              Assumes that a boolean value is at the front of the data stored in the  variable  named  <u>data_var</u>,
              and  stores it into the variable named by <u>bool_var</u>. Additionally removes all bytes associated with
              the value from the data for further processing by the following decoder commands.

       <b>::asn::asnGetNull</b> <u>data_var</u>
              Assumes that a NULL value is at the front of the data stored in the variable  named  <u>data_var</u>  and
              removes the bytes used to encode it from the data.

       <b>::asn::asnGetSequence</b> <u>data_var</u> <u>sequence_var</u>
              Assumes  that  an  ASN sequence is at the front of the data stored in the variable named <u>data_var</u>,
              and stores it into the variable named by <u>sequence_var</u>. Additionally removes all  bytes  associated
              with the value from the data for further processing by the following decoder commands.

              The  data  in  <u>sequence_var</u>  is  encoded  binary  and  has  to be further decoded according to the
              definition of the sequence, using the decoder commands here.

       <b>::asn::asnGetSet</b> <u>data_var</u> <u>set_var</u>
              Assumes that an ASN set is at the front of the data stored in the  variable  named  <u>data_var</u>,  and
              stores  it  into the variable named by <u>set_var</u>. Additionally removes all bytes associated with the
              value from the data for further processing by the following decoder commands.

              The data in <u>set_var</u> is encoded binary and has to be further decoded according to the definition of
              the set, using the decoder commands here.

       <b>::asn::asnGetApplication</b> <u>data_var</u> <u>appNumber_var</u> ?<u>content_var</u>? ?<u>encodingType_var</u>?
              Assumes that an ASN application construct is at the front of the data stored in the variable named
              <u>data_var</u>, and stores its id into the variable named by  <u>appNumber_var</u>.  Additionally  removes  all
              bytes  associated  with  the  value  from the data for further processing by the following decoder
              commands.  If a <u>content_var</u> is specified, then the command places all data associated with it into
              the named variable, in the binary form which can be processed using the decoder commands  of  this
              package.   If  a  <u>encodingType_var</u>  is  specified,  then  that  var is set to 1 if the encoding is
              constructed and 0 if it is primitive.

              Otherwise it is the responsibility of the caller  to  decode  the  remainder  of  the  application
              construct based on the id retrieved by this command, using the decoder commands of this package.

       <b>::asn::asnGetContext</b> <u>data_var</u> <u>contextNumber_var</u> ?<u>content_var</u>? ?<u>encodingType_var</u>?
              Assumes that an ASN context tag construct is at the front of the data stored in the variable named
              <u>data_var</u>, and stores its id into the variable named by <u>contextNumber_var</u>. Additionally removes all
              bytes  associated  with  the  value  from the data for further processing by the following decoder
              commands.  If a <u>content_var</u> is specified, then the command places all data associated with it into
              the named variable, in the binary form which can be processed using the decoder commands  of  this
              package.   If  a  <u>encodingType_var</u>  is  specified,  then  that  var is set to 1 if the encoding is
              constructed and 0 if it is primitive.

              Otherwise it is the responsibility of the caller to decode the remainder of the construct based on
              the id retrieved by this command, using the decoder commands of this package.

   <b>HANDLING</b> <b>TAGS</b>
       Working with ASN.1 you often need to decode tagged values, which use  a  tag  thats  different  from  the
       universal  tag for a type. In those cases you have to replace the tag with the universal tag used for the
       type, to decode the value.  To decode a tagged value use the <b>::asn::asnRetag</b> to change  the  tag  to  the
       appropriate  type to use one of the decoders for primitive values.  To help with this the module contains
       three functions:

       <b>::asn::asnPeekTag</b> <u>data_var</u> <u>tag_var</u> <u>tagtype_var</u> <u>constr_var</u>
              The <b>::asn::asnPeekTag</b> command can be used to take a peek at the data and  decode  the  tag  value,
              without  removing  it from the data. The <u>tag_var</u> gets set to the tag number, while the <u>tagtype_var</u>
              gets set to the class of the  tag.  (Either  UNIVERSAL,  CONTEXT,  APPLICATION  or  PRIVATE).  The
              <u>constr_var</u>  is  set  to  1 if the tag is for a constructed value, and to 0 for not constructed. It
              returns the length of the tag.

       <b>::asn::asnTag</b> <u>tagnumber</u> ?<u>class</u>? ?<u>tagstyle</u>?
              The <b>::asn::asnTag</b> can be used to create a tag value. The <u>tagnumber</u> gives the number  of  the  tag,
              while the <u>class</u> gives one of the classes (UNIVERSAL,CONTEXT,APPLICATION or PRIVATE). The class may
              be abbreviated to just the first letter (U,C,A,P), default is UNIVERSAL.  The <u>tagstyle</u> is either C
              for Constructed encoding, or P for primitve encoding. It defaults to P. You can also use 1 instead
              of C and 0 instead of P for direct use of the values returned by <b>::asn::asnPeekTag</b>.

       <b>::asn::asnRetag</b> <u>data_var</u> <u>newTag</u>
              Replaces  the  tag  in front of the data in <u>data_var</u> with <u>newTag</u>. The new Tag can be created using
              the <b>::asn::asnTag</b> command.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Examples for the usage of this package can be found in the implementation of package <b>ldap</b>.

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This document, and the package it describes, will undoubtedly contain bugs and  other  problems.   Please
       report  such  in  the category <u>asn</u> of the <u>Tcllib</u> <u>Trackers</u> [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].  Please
       also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note further that <u>attachments</u> are strongly preferred over inlined patches. Attachments  can  be  made  by
       going  to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most button
       in the secondary navigation bar.

</pre><h4><b>KEYWORDS</b></h4><pre>
       asn, ber, cer, der, internet, protocol, x.208, x.209

</pre><h4><b>CATEGORY</b></h4><pre>
       Networking

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2004 Andreas Kupries &lt;<a href="mailto:andreas_kupries@users.sourceforge.net">andreas_kupries@users.sourceforge.net</a>&gt;
       Copyright (c) 2004 Jochen Loewer &lt;<a href="mailto:loewerj@web.de">loewerj@web.de</a>&gt;
       Copyright (c) 2004-2011 Michael Schlenker &lt;<a href="mailto:mic42@users.sourceforge.net">mic42@users.sourceforge.net</a>&gt;

tcllib                                                 0.8                                             <u><a href="../man3tcl/asn.3tcl.html">asn</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>