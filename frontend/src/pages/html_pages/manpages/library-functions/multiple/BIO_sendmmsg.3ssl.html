<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIO_sendmmsg, BIO_recvmmsg, BIO_dgram_set_local_addr_enable, BIO_dgram_get_local_addr_enable,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       BIO_sendmmsg, BIO_recvmmsg, BIO_dgram_set_local_addr_enable, BIO_dgram_get_local_addr_enable,
       BIO_dgram_get_local_addr_cap, BIO_err_is_non_fatal - send and receive multiple datagrams in a single call

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/bio.h&gt;

        typedef struct bio_msg_st {
            void *data;
            size_t data_len;
            BIO_ADDR *peer, *local;
            uint64_t flags;
        } BIO_MSG;

        int BIO_sendmmsg(BIO *b, BIO_MSG *msg,
                         size_t stride, size_t num_msg, uint64_t flags,
                         size_t *msgs_processed);
        int BIO_recvmmsg(BIO *b, BIO_MSG *msg,
                         size_t stride, size_t num_msg, uint64_t flags,
                         size_t *msgs_processed);

        int BIO_dgram_set_local_addr_enable(BIO *b, int enable);
        int BIO_dgram_get_local_addr_enable(BIO *b, int *enable);
        int BIO_dgram_get_local_addr_cap(BIO *b);
        int BIO_err_is_non_fatal(unsigned int errcode);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>BIO_sendmmsg()</b> and <b>BIO_recvmmsg()</b> functions can be used to send and receive multiple messages in a single
       call to a BIO. They are analogous to <b><a href="../man2/sendmmsg.2.html">sendmmsg</a></b>(2) and <b><a href="../man2/recvmmsg.2.html">recvmmsg</a></b>(2) on operating systems which provide those
       functions.

       The <b>BIO_MSG</b> structure provides a subset of the functionality of the <b>struct</b> <b>msghdr</b> structure defined by
       POSIX. These functions accept an array of <b>BIO_MSG</b> structures. On any particular invocation, these
       functions may process all of the passed structures, some of them, or none of them. This is indicated by
       the value stored in <u>*msgs_processed</u>, which expresses the number of messages processed.

       The caller should set the <u>data</u> member of a <b>BIO_MSG</b> to a buffer containing the data to send, or to be
       filled with a received message. <u>data_len</u> should be set to the size of the buffer in bytes. If the given
       <b>BIO_MSG</b> is processed (in other words, if the integer returned by the function is greater than or equal to
       that <b>BIO_MSG</b>'s array index), <u>data_len</u> will be modified to specify the actual amount of data sent or
       received.

       The <u>flags</u> field of a <b>BIO_MSG</b> provides input per-message flags to the invocation. If the invocation
       processes that <b>BIO_MSG</b>, the <u>flags</u> field is written with output per-message flags, or zero if no such
       flags are applicable.

       Currently, no input or output per-message flags are defined and this field should be set to zero before
       calling <b>BIO_sendmmsg()</b> or <b>BIO_recvmmsg()</b>.

       The <u>flags</u> argument to <b>BIO_sendmmsg()</b> and <b>BIO_recvmmsg()</b> provides global flags which affect the entire
       invocation. No global flags are currently defined and this argument should be set to zero.

       When these functions are used to send and receive datagrams, the <u>peer</u> field of a <b>BIO_MSG</b> allows the
       destination address of sent datagrams to be specified on a per-datagram basis, and the source address of
       received datagrams to be determined. The <u>peer</u> field should be set to point to a <b>BIO_ADDR</b>, which will be
       read by <b>BIO_sendmmsg()</b> and used as the destination address for sent datagrams, and written by
       <b>BIO_recvmmsg()</b> with the source address of received datagrams.

       Similarly, the <u>local</u> field of a <b>BIO_MSG</b> allows the source address of sent datagrams to be specified on a
       per-datagram basis, and the destination address of received datagrams to be determined. Unlike <u>peer</u>,
       support for <u>local</u> must be explicitly enabled on a <b>BIO</b> before it can be used; see
       <b>BIO_dgram_set_local_addr_enable()</b>. If <u>local</u> is non-NULL in a <b>BIO_MSG</b> and support for <u>local</u> has not been
       enabled, processing of that <b>BIO_MSG</b> fails.

       <u>peer</u> and <u>local</u> should be set to NULL if they are not required. Support for <u>local</u> may not be available on
       all platforms; on these platforms, these functions always fail if <u>local</u> is non-NULL.

       If <u>local</u> is specified and local address support is enabled, but the operating system does not report a
       local address for a specific received message, the <b>BIO_ADDR</b> it points to will be cleared (address family
       set to "AF_UNSPEC").  This is known to happen on Windows when a packet is received which was sent by the
       local system, regardless of whether the packet's destination address was the loopback address or the IP
       address of a local non-loopback interface. This is also known to happen on macOS in some circumstances,
       such as for packets sent before local address support was enabled for a receiving socket. These are OS-
       specific limitations. As such, users of this API using local address support should expect to sometimes
       receive a cleared local <b>BIO_ADDR</b> instead of the correct value.

       The <u>stride</u> argument must be set to sizeof(BIO_MSG). This argument facilitates backwards compatibility if
       fields are added to <b>BIO_MSG</b>. Callers must zero-initialize <b>BIO_MSG</b>.

       <u>num_msg</u> should be sent to the maximum number of messages to send or receive, which is also the length of
       the array pointed to by <u>msg</u>.

       <u>msgs_processed</u> must be non-NULL and points to an integer written with the number of messages successfully
       processed; see the RETURN VALUES section for further discussion.

       Unlike most BIO functions, these functions explicitly support multi-threaded use. Multiple concurrent
       writers and multiple concurrent readers of the same BIO are permitted in any combination. As such, these
       functions do not clear, set, or otherwise modify BIO retry flags. The return value must be used to
       determine whether an operation should be retried; see below.

       The support for concurrent use extends to <b>BIO_sendmmsg()</b> and <b>BIO_recvmmsg()</b> only, and no other function
       may be called on a given BIO while any call to <b>BIO_sendmmsg()</b> or <b>BIO_recvmmsg()</b> is in progress, or vice
       versa.

       <b>BIO_dgram_set_local_addr_enable()</b> and <b>BIO_dgram_get_local_addr_enable()</b> control whether local address
       support is enabled. To enable local address support, call <b>BIO_dgram_set_local_addr_enable()</b> with an
       argument of 1. The call will fail if local address support is not available for the platform.
       <b>BIO_dgram_get_local_addr_enable()</b> retrieves the value set by <b>BIO_dgram_set_local_addr_enable()</b>.

       <b>BIO_dgram_get_local_addr_cap()</b> determines if the <b>BIO</b> is capable of supporting local addresses.

       <b>BIO_err_is_non_fatal()</b> determines if a packed error code represents an error which is transient in
       nature.

</pre><h4><b>NOTES</b></h4><pre>
       Some implementations of the <b>BIO_sendmmsg()</b> and <b>BIO_recvmmsg()</b> BIO methods might always process at most
       one message at a time, for example when OS-level functionality to transmit or receive multiple messages
       at a time is not available.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       On success, the functions <b>BIO_sendmmsg()</b> and <b>BIO_recvmmsg()</b> return 1 and write the number of messages
       successfully processed (which need not be nonzero) to <u>msgs_processed</u>. Where a positive value n is written
       to <u>msgs_processed</u>, all entries in the <b>BIO_MSG</b> array from 0 through n-1 inclusive have their <u>data_len</u> and
       <u>flags</u> fields updated with the results of the operation on that message. If the call was to <b>BIO_recvmmsg()</b>
       and the <u>peer</u> or <u>local</u> fields of that message are non-NULL, the <b>BIO_ADDR</b> structures they point to are
       written with the relevant address.

       On failure, the functions <b>BIO_sendmmsg()</b> and <b>BIO_recvmmsg()</b> return 0 and write zero to <u>msgs_processed</u>.
       Thus <u>msgs_processed</u> is always written regardless of the outcome of the function call.

       If <b>BIO_sendmmsg()</b> and <b>BIO_recvmmsg()</b> fail, they always raise an <b>ERR_LIB_BIO</b> error using <b><a href="../man3/ERR_raise.3.html">ERR_raise</a></b>(3). Any
       error may be raised, but the following in particular may be noted:

       <b>BIO_R_LOCAL_ADDR_NOT_AVAILABLE</b>
         The  <u>local</u> field was set to a non-NULL value, but local address support is not available or not enabled
         on the BIO.

       <b>BIO_R_PEER_ADDR_NOT_AVAILABLE</b>
         The <u>peer</u> field was set to a non-NULL value, but peer address support is not available on the BIO.

       <b>BIO_R_UNSUPPORTED_METHOD</b>
         The <b>BIO_sendmmsg()</b> or <b>BIO_recvmmsg()</b> method is not supported on the BIO.

       <b>BIO_R_NON_FATAL</b>
         The call failed due to a transient, non-fatal error (for example, because the  BIO  is  in  nonblocking
         mode and the call would otherwise have blocked).

         Implementations  of this interface which do not make system calls and thereby pass through system error
         codes using <b>ERR_LIB_SYS</b> (for example, memory-based implementations) should issue this  reason  code  to
         indicate  a  transient  failure.  However, users of this interface should not test for this reason code
         directly, as there are multiple possible packed error  codes  representing  a  transient  failure;  use
         <b>BIO_err_is_non_fatal()</b> instead (discussed below).

       Socket errors
         OS-level  socket  errors  are reported using an error with library code <b>ERR_LIB_SYS</b>; for a packed error
         code <b>errcode</b> where "ERR_SYSTEM_ERROR(errcode) == 1", the OS-level socket error code  can  be  retrieved
         using ERR_GET_REASON(errcode). The packed error code can be retrieved by calling <b><a href="../man3/ERR_peek_last_error.3.html">ERR_peek_last_error</a></b>(3)
         after the call to <b>BIO_sendmmsg()</b> or <b>BIO_recvmmsg()</b> returns 0.

       Non-fatal errors
         Whether   an   error   is   transient   can   be  determined  by  passing  the  packed  error  code  to
         <b>BIO_err_is_non_fatal()</b>. Callers should do this instead of testing the reason code  directly,  as  there
         are many possible error codes which can indicate a transient error, many of which are system specific.

       Third  parties  implementing  custom  BIOs supporting the <b>BIO_sendmmsg()</b> or <b>BIO_recvmmsg()</b> methods should
       note that it is a required part of the API contract that an error is always raised when either  of  these
       functions return 0.

       <b>BIO_dgram_set_local_addr_enable()</b> returns 1 if local address support was successfully enabled or disabled
       and 0 otherwise.

       <b>BIO_dgram_get_local_addr_enable()</b>  returns  1  if  the local address support enable flag was successfully
       retrieved.

       <b>BIO_dgram_get_local_addr_cap()</b> returns 1 if the <b>BIO</b> can support local addresses.

       <b>BIO_err_is_non_fatal()</b> returns 1 if the passed packed error code represents an error which  is  transient
       in nature.

</pre><h4><b>HISTORY</b></h4><pre>
       These functions were added in OpenSSL 3.2.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2023 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                 <u><a href="../man3SSL/BIO_SENDMMSG.3SSL.html">BIO_SENDMMSG</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>