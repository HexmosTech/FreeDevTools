<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C Syntax</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openmpi-doc">openmpi-doc_5.0.7-1build1_all</a> <br><br><pre>
</pre><h4><b>SYNTAX</b></h4><pre>
   <b>C</b> <b>Syntax</b>
          #include &lt;mpi.h&gt;
          #include &lt;mpi-ext.h&gt;

          int MPIX_Comm_agree(MPI_Comm comm, int *flag)

          int MPIX_Comm_iagree(MPI_Comm comm, int *flag, MPI_Request *request)

   <b>Fortran</b> <b>Syntax</b>
          USE MPI
          USE MPI_EXT
          ! or the older form: INCLUDE 'mpif.h'

          MPIX_COMM_AGREE(COMM, FLAG, IERROR)
               INTEGER COMM, FLAG, IERROR

          MPIX_COMM_IAGREE(COMM, FLAG, REQUEST, IERROR)
               INTEGER COMM, FLAG, REQUEST, IERROR

   <b>Fortran</b> <b>2008</b> <b>Syntax</b>
          USE mpi_f08
          USE mpi_ext_f08

          MPIX_Comm_agree(comm, flag, ierror)
               TYPE(MPI_Comm), INTENT(IN) :: comm
               INTEGER, INTENT(INOUT) :: flag
               INTEGER, OPTIONAL, INTENT(OUT) :: ierror

          MPIX_COMM_IAGREE(COMM, FLAG, REQUEST, IERROR)
               TYPE(MPI_Comm), INTENT(IN) :: comm
               INTEGER, INTENT(INOUT), ASYNCHRONOUS :: flag
               TYPE(MPI_Request), INTENT(OUT) :: request
               INTEGER, OPTIONAL, INTENT(OUT) :: ierror

</pre><h4><b>INPUT</b> <b>PARAMETERS</b></h4><pre>
       • <b>comm</b>: Communicator (handle).

       • <b>flag</b>: Binary flags (integer).

</pre><h4><b>OUTPUT</b> <b>PARAMETERS</b></h4><pre>
       • <b>flag</b>: Reduced binary flags (integer).

       • <b>request</b>: Request (handle, non-blocking only).

       • <b>ierror</b>: Fortran only: Error status (integer).

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This collective communication agrees on the integer value <u>flag</u> and (implicitly) on the  group  of  failed
       processes in <u>comm</u>.

       On  completion,  all  non-failed MPI processes have agreed to set the output integer value of <u>flag</u> to the
       result of a <u>bitwise</u> <u>AND</u> operation over the contributed input values of <u>flag</u>.

       <u>MPIX_Comm_iagree</u> is the non-blocking variant of <u>MPIX_Comm_agree</u>.

</pre><h4><b>PROCESS</b> <b>FAILURES</b></h4><pre>
       When an MPI process fails before contributing to the agree operation, the <u>flag</u> is computed  ignoring  its
       contribution, and the operation raises an error of class MPIX_ERR_PROC_FAILED.

       When  an error of class MPIX_ERR_PROC_FAILED is raised, it is consistently raised at all MPI processes in
       the group(s) of <u>comm</u>.

       After <u>MPIX_Comm_agree</u> raised an error of class MPIX_ERR_PROC_FAILED, the group produced by  a  subsequent
       call to <u>MPIX_Comm_get_failed</u> on <u>comm</u> contains every MPI process that didn’t contribute to the computation
       of <u>flag</u>.

</pre><h4><b>WHEN</b> <b>THE</b> <b>COMMUNICATOR</b> <b>CONTAINS</b> <b>ACKNOWLEDGED</b> <b>FAILURES</b></h4><pre>
       If  <b>all</b>  MPI  processes  in  the  group  of  <u>comm</u>  have acknowledged the failure of an MPI process (using
       <u>MPIX_Comm_ack_failed</u>)   prior   to   the   call   to   <u>MPIX_Comm_agree</u>   (or    <u>MPIX_Comm_iagree</u>),    the
       MPIX_ERR_PROC_FAILED  error  is not raised when the output value of <u>flag</u> ignores the contribution of that
       failed process. Note that this is an uniform property: if a  non-contributing  process  is  found  to  be
       not-acknowledged at any live process in <u>comm</u>, all processes raise an error of class MPIX_ERR_PROC_FAILED.

       <b>Example</b>  <b>1:</b>  Using  a  combination  of  <u>MPIX_Comm_ack_failed</u>  and <u>MPIX_Comm_agree</u> users can propagate and
       synchronize the knowledge of failures across all MPI processes in <u>comm</u>.

          Comm_get_failed_consistent(MPI_Comm c, MPI_Group * g) {
              int rc; int T=1;
              int size; int num_acked;
              MPI_Group gf;
              int ranges[3] = {0, 0, 1};

              MPI_Comm_size(c, &amp;size);

              do {
                  /* this routine is not pure: calling MPI_Comm_ack_failed
                   * affects the state of the communicator c */
                  MPIX_Comm_ack_failed(c, size, &amp;num_acked);
                  /* we simply ignore the T value in this example */
                  rc = MPIX_Comm_agree(c, &amp;T);
              } while( rc != MPI_SUCCESS );
              /* after this loop, MPIX_Comm_agree has returned MPI_SUCCESS at
               * all processes, so all processes have Acknowledged the same set of
               * failures. Let's get that set of failures in the g group. */
              if( 0 == num_acked ) {
                  *g = MPI_GROUP_EMPTY;
              }
              else {
                  MPIX_Comm_get_failed(c, &amp;gf);
                  ranges[1] = num_acked - 1;
                  MPI_Group_range_incl(gf, 1, ranges, g);
                  MPI_Group_free(&amp;gf);
              }
          }

</pre><h4><b>WHEN</b> <b>THE</b> <b>COMMUNICATOR</b> <b>IS</b> <b>REVOKED</b></h4><pre>
       This function never raises an error of class MPIX_ERR_REVOKED.  The defined semantics of  <u>MPIX_Comm_agree</u>
       are  maintained  when  <u>comm</u>  is  revoked,  or  when  the group of <u>comm</u> contains failed MPI processes.  In
       particular, <u>MPIX_Comm_agree</u> is a collective operation, even when <u>comm</u> is revoked.

</pre><h4><b>WHEN</b> <b>COMMUNICATOR</b> <b>IS</b> <b>AN</b> <b>INTER-COMMUNICATOR</b></h4><pre>
       When the communicator is an inter-communicator, the value of <u>flag</u> is a <u>bitwise</u>  <u>AND</u>  operation  over  the
       values contributed by the remote group.

       When  an error of class MPIX_ERR_PROC_FAILED is raised, it is consistently raised at all MPI processes in
       the group(s) of <u>comm</u>, that is, both the local and remote groups of the inter-communicator.

</pre><h4><b>ERRORS</b></h4><pre>
       Almost all MPI routines return an error value; C routines as  the  return  result  of  the  function  and
       Fortran routines in the last argument.

       Before  the  error  value  is  returned,  the current MPI error handler associated with the communication
       object (e.g., communicator, window, file) is called.  If no communication object is associated  with  the
       MPI  call,  then  the call is considered attached to MPI_COMM_SELF and will call the associated MPI error
       handler.  When  MPI_COMM_SELF  is  not  initialized   (i.e.,   before   <u>MPI_Init</u>/<u>MPI_Init_thread</u>,   after
       <u>MPI_Finalize</u>,  or  when using the Sessions Model exclusively) the error raises the initial error handler.
       The initial error handler can be changed by calling <u>MPI_Comm_set_errhandler</u> on MPI_COMM_SELF  when  using
       the  World  model,  or the mpi_initial_errhandler CLI argument to mpiexec or info key to <u>MPI_Comm_spawn</u>/‐
       <u>MPI_Comm_spawn_multiple</u>.  If no other appropriate error handler has been set, then the  MPI_ERRORS_RETURN
       error  handler  is  called for MPI I/O functions and the MPI_ERRORS_ABORT error handler is called for all
       other MPI functions.

       Open MPI includes three predefined error handlers that can be used:

       • <b>MPI_ERRORS_ARE_FATAL</b> Causes the program to abort all connected MPI processes.

       • <b>MPI_ERRORS_ABORT</b> An error handler that can be invoked on a communicator, window, file, or session. When
         called on a communicator, it acts as if <u>MPI_Abort</u> was called on  that  communicator.  If  called  on  a
         window  or file, acts as if <u>MPI_Abort</u> was called on a communicator containing the group of processes in
         the corresponding window or file. If called on a session, aborts only the local process.

       • <b>MPI_ERRORS_RETURN</b> Returns an error code to the application.

       MPI applications can also implement their own error handlers by calling:

       • <u>MPI_Comm_create_errhandler</u> then <u>MPI_Comm_set_errhandler</u>

       • <u>MPI_File_create_errhandler</u> then <u>MPI_File_set_errhandler</u>

       • <u>MPI_Session_create_errhandler</u> then <u>MPI_Session_set_errhandler</u> or at <u>MPI_Session_init</u>

       • <u>MPI_Win_create_errhandler</u> then <u>MPI_Win_set_errhandler</u>

       Note that MPI does not guarantee that an MPI program can continue past an error.

       See the <u>MPI</u> <u>man</u> <u>page</u> for a full list of <u>MPI</u> <u>error</u> <u>codes</u>.

       See the Error Handling section of the MPI-3.1 standard for more information.

       <b>SEE</b> <b>ALSO:</b>

          • <u>MPIX_Comm_is_revoked</u>

          • <u>MPIX_Comm_ack_failed</u>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2003-2025, The Open MPI Community

                                                  Jun 07, 2025                               <u><a href="../man3/MPIX_COMM_IAGREE.3.html">MPIX_COMM_IAGREE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>