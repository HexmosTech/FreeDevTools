<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cmdline - Procedures to process command lines and options.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cmdline - Procedures to process command lines and options.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>cmdline</b> <b>?1.5.3?</b>

       <b>::cmdline::getopt</b> <u>argvVar</u> <u>optstring</u> <u>optVar</u> <u>valVar</u>

       <b>::cmdline::getKnownOpt</b> <u>argvVar</u> <u>optstring</u> <u>optVar</u> <u>valVar</u>

       <b>::cmdline::getoptions</b> <u>argvVar</u> <u>optlist</u> ?<u>usage</u>?

       <b>::cmdline::getKnownOptions</b> <u>argvVar</u> <u>optlist</u> ?<u>usage</u>?

       <b>::cmdline::usage</b> <u>optlist</u> ?<u>usage</u>?

       <b>::cmdline::getfiles</b> <u>patterns</u> <u>quiet</u>

       <b>::cmdline::getArgv0</b>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This package provides commands to parse command lines and options.

</pre><h4><b>::ARGV</b> <b>HANDLING</b></h4><pre>
       One  of  the most common variables this package will be used with is <b>::argv</b>, which holds the command line
       of the current application. This variable has a companion <b>::argc</b> which is initialized to  the  number  of
       elements in <b>::argv</b> at the beginning of the application.

       The  commands  in  this package will <u>not</u> modify the <b>::argc</b> companion when called with <b>::argv</b>. Keeping the
       value consistent, if such is desired or required, is the responsibility of the caller.

</pre><h4><b>API</b></h4><pre>
       <b>::cmdline::getopt</b> <u>argvVar</u> <u>optstring</u> <u>optVar</u> <u>valVar</u>
              This command works in a fashion like the standard C based <b>getopt</b> function.  Given an option string
              and a pointer to an array of args this command will process the <u>first</u> <u>argument</u> and return info  on
              how to proceed. The command returns 1 if an option was found, 0 if no more options were found, and
              -1 if an error occurred.

              <u>argvVar</u>  contains  the  name of the list of arguments to process. If options are found the list is
              modified and the processed arguments are removed from the start of the list.

              <u>optstring</u> contains a list of command options that the application will accept.  If the option ends
              in ".arg" the command will use the next argument as an argument to the option, or extract it  from
              the current argument, if it is of the form "option=value".  Otherwise the option is a boolean that
              is set to 1 if present.

              <u>optVar</u>  refers  to  the variable the command will store the found option into (without the leading
              '-' and without the .arg extension).

              <u>valVar</u> refers to the variable to store either the value for the specified option into upon success
              or an error message in the case of failure. The stored value comes from the command line for  .arg
              options, otherwise the value is 1.

       <b>::cmdline::getKnownOpt</b> <u>argvVar</u> <u>optstring</u> <u>optVar</u> <u>valVar</u>
              Like <b>::cmdline::getopt</b>, except it ignores any unknown options in the input.

       <b>::cmdline::getoptions</b> <u>argvVar</u> <u>optlist</u> ?<u>usage</u>?
              Processes  the  entire set of command line options found in the list variable named by <u>argvVar</u> and
              fills in defaults for those not specified.  This also generates an error message  that  lists  the
              allowed flags if an incorrect flag is specified.  The optional <u>usage</u>-argument contains a string to
              include in front of the generated message. If not present it defaults to "options:".

              <u>argvVar</u>  contains  the name of the list of arguments to process.  If options are found the list is
              modified and the processed arguments are removed from the start of the list.

              <u>optlist</u> contains a list of lists where each element specifies an option in the form: <u>flag</u>  <u>default</u>
              <u>comment</u>.

              If  <u>flag</u>  ends  in ".arg" then the value is taken from the command line. Otherwise it is a boolean
              and appears in the result if present on the command line. If <u>flag</u> ends in ".secret", it  will  not
              be displayed in the usage.

              The  options <b>-?</b>, <b>-help</b>, and <b>--</b> are implicitly understood. The first two abort option processing by
              throwing an error and force the generation of the usage  message,  whereas  the  the  last  aborts
              option  processing  without  an  error, leaving all arguments coming after for regular processing,
              even if starting with a dash.

              The result of the command is a dictionary mapping all options  to  their  values,  be  they  user-
              specified or defaults.

       <b>::cmdline::getKnownOptions</b> <u>argvVar</u> <u>optlist</u> ?<u>usage</u>?
              Like <b>::cmdline::getoptions</b>, but ignores any unknown options in the input.

       <b>::cmdline::usage</b> <u>optlist</u> ?<u>usage</u>?
              Generates  and  returns  an  error message that lists the allowed flags. <u>optlist</u> is defined as for
              <b>::cmdline::getoptions</b>. The optional <u>usage</u>-argument contains a string to include in  front  of  the
              generated message. If not present it defaults to "options:".

       <b>::cmdline::getfiles</b> <u>patterns</u> <u>quiet</u>
              Given  a  list  of  file  <u>patterns</u> this command computes the set of valid files.  On windows, file
              globbing is performed on each argument.  On Unix, only  file  existence  is  tested.   If  a  file
              argument produces no valid files, a warning is optionally generated (set <u>quiet</u> to true).

              This  code  also  uses  the full path for each file.  If not given it prepends the current working
              directory to the filename. This ensures that these files will  never  conflict  with  files  in  a
              wrapped zip file. The last sentence refers to the pro-tools.

       <b>::cmdline::getArgv0</b>
              This  command  returns  the  "sanitized" version of <u>argv0</u>.  It will strip off the leading path and
              removes the extension ".bin". The latter is used by the TclPro applications because they  must  be
              wrapped by a shell script.

   <b>ERROR</b> <b>CODES</b>
       Starting  with  version 1.5 all errors thrown by the package have a proper <b>::errorCode</b> for use with Tcl's
       <b>try</b> command. This code always has the word <b>CMDLINE</b> as its first element.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>CMDLINE::GETOPTIONS</b>
       This  example,  taken  from  the  package  <b>fileutil</b>  and  slightly  modified,  demonstrates  how  to  use
       <b>cmdline::getoptions</b>.   First, a list of options is created, then the 'args' list is passed to cmdline for
       processing.  Subsequently, different options are checked to see if they have been passed to  the  script,
       and what their value is.

                      package require Tcl 8.5
                      package require try         ;# Tcllib.
                      package require cmdline 1.5 ;# First version with proper error-codes.

                      # Notes:
                      # - Tcl 8.6+ has 'try' as a builtin command and therefore does not
                      #   need the 'try' package.
                      # - Before Tcl 8.5 we cannot support 'try' and have to use 'catch'.
                      #   This then requires a dedicated test (if) on the contents of
                      #   ::errorCode to separate the CMDLINE USAGE signal from actual errors.

                      set options {
                          {a          "set the atime only"}
                          {m          "set the mtime only"}
                          {c          "do not create non-existent files"}
                          {r.arg  ""  "use time from ref_file"}
                          {t.arg  -1  "use specified time"}
                      }
                      set usage ": MyCommandName \[options] filename ...\noptions:"

                      try {
                          array set params [::cmdline::getoptions argv $options $usage]

                    # Note: argv is modified now. The recognized options are
                    # removed from it, leaving the non-option arguments behind.
                      } trap {CMDLINE USAGE} {msg o} {
                          # Trap the usage signal, print the message, and exit the application.
                          # Note: Other errors are not caught and passed through to higher levels!
                    puts $msg
                    exit 1
                      }

                      if {  $params(a) } { set set_atime "true" }
                      set has_t [expr {$params(t) != -1}]
                      set has_r [expr {[string length $params(r)] &gt; 0}]
                      if {$has_t &amp;&amp; $has_r} {
                          return -code error "Cannot specify both -r and -t"
                      } elseif {$has_t} {
                    ...
                      }

   <b>CMDLINE::GETOPT</b>
       This example shows the core loop of <b>cmdline::getoptions</b> from the previous example. It demonstrates how it
       uses <b>cmdline::get</b> to process the options one at a time.

                  while {[set err [getopt argv $opts opt arg]]} {
                if {$err &lt; 0} {
                          set result(?) ""
                          break
                }
                set result($opt) $arg
                  }

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This  document,  and  the package it describes, will undoubtedly contain bugs and other problems.  Please
       report such in the  category  <u>cmdline</u>  of  the  <u>Tcllib</u>  <u>Trackers</u>  [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].
       Please also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note  further  that  <u>attachments</u>  are strongly preferred over inlined patches. Attachments can be made by
       going to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most  button
       in the secondary navigation bar.

</pre><h4><b>KEYWORDS</b></h4><pre>
       argument processing, argv, argv0, cmdline processing, command line processing

</pre><h4><b>CATEGORY</b></h4><pre>
       Programming tools

tcllib                                                1.5.3                                        <u><a href="../man3tcl/cmdline.3tcl.html">cmdline</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>