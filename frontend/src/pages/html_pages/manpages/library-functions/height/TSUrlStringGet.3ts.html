<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSUrlStringGet - traffic Server URL string representations API</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/trafficserver-dev">trafficserver-dev_9.2.5+ds-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       TSUrlStringGet - traffic Server URL string representations API

</pre><h4><b>SYNOPSIS</b></h4><pre>
          #include &lt;ts/ts.h&gt;

       <b>char</b> <b>*TSUrlStringGet(</b><u>TSMBuffer</u> <b>bufp,</b> <u>TSMLoc</u> <b>offset,</b> <b>int</b> <b>*length)</b>

       <b>char</b> <b>*TSHttpTxnEffectiveUrlStringGet(</b><u>TSHttpTxn</u> <b>txn,</b> <b>int</b> <b>*length)</b>

       <u>TSReturnCode</u> <b>TSHttpHdrEffectiveUrlBufGet(</b><u>TSMBuffer</u> <b>hdr_buf,</b> <u>TSMLoc</u> <b>hdr_loc,</b> <b>char</b> <b>*buf,</b> <b>int64_t</b> <b>size,</b>
       <b>int64_t</b> <b>*length)</b>

       <b>int</b> <b>TSUrlLengthGet(</b><u>TSMBuffer</u> <b>bufp,</b> <u>TSMLoc</u> <b>offset)</b>

       <b>void</b> <b>TSUrlPrint(</b><u>TSMBuffer</u> <b>bufp,</b> <u>TSMLoc</u> <b>offset,</b> <u>TSIOBuffer</u> <b>iobufp)</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  URL  data  structure  is  a  parsed  version  of a standard internet URL. The Traffic Server URL API
       provides access to URL data stored in marshal buffers. The URL functions can create,  copy,  retrieve  or
       delete entire URLs, and retrieve or modify parts of URLs, such as their host, port or scheme information.

       <u>TSUrlStringGet()</u>  constructs  a  string  representation  of  the URL located at <u>offset</u> within the marshal
       buffer <u>bufp</u>.  (However <u>bufp</u> is actually superfluous and may be null.)  <u>TSUrlStringGet()</u> stores the length
       of the allocated string in the parameter <u>length</u>.  This is the same length that <u>TSUrlLengthGet()</u>  returns.
       The  returned  string  is  allocated  by a call to <u>TSmalloc()</u> and must be freed by a call to <u>TSfree()</u>. If
       length is <b>NULL</b> then no attempt is made to de-reference it. The returned string is not guaranteed to  have
       a null terminator - <u>length</u> must be used to correctly display the string.

       <u>TSHttpTxnEffectiveUrlStringGet()</u> is similar to <u>TSUrlStringGet()</u>. The two differences are:

       • The source is transaction <u>txn</u> and the URL is retrieved from the client request in that transaction.

       • If  the  client request URL has a host, that URL is returned, Otherwise, if there is a "Host" field the
         value of that field is used as the host in the returned URL.

       This function is useful to guarantee a URL that is as complete as possible given the specific request.

       <u>TSHttpHdrEffectiveUrlBufGet()</u> returns the effective URL  for  any  HTTP  request  (not  just  the  client
       request).   If  the  request has a Host header field (and the URL does not contain a host specifier), the
       host specifier the header provides is inserted into the URL.  The host and scheme  in  the  returned  URL
       will  be  normalized  to  lower  case letters (to make URL comparisons simple and fast).  This prints the
       effective URL for the header specified by <u>hdr_buf</u> and <u>hdr_loc</u> to the  buffer  starting  at  <u>buf</u>.  If  the
       effective  URL is longer than <u>size</u>, nothing is written to <u>buf</u>.  Note that this is not considered an error
       case, the function will still return <u>TS_SUCCESS</u>.  It is the responsibility of the caller  to  check  this
       result  to  determine  if output was generated.  The full length of the URL is always returned in <u>*length</u>
       when the function returns <u>TS_SUCCESS</u>.

       The typical usage would be

          TSMBuffer hdr_buf;
          TSMLoc hdr_loc;
          TSHttpTxnServerReqGet(txn, &amp;hdr_buf, &amp;hdr_loc);
          int64_t length;
          char store[2048];
          char *buf = store;
          TSHttpHdrEffectiveUrlBufGet(hdr_buf, hdr_loc, buf, sizeof(store), &amp;length);
          if (length &gt; sizeof(store)) {
            buf = static_cast&lt;char *&gt;(malloc(length));
            TSHttpHdrEffectiveUrlBufGet(hdr_buf, hdr_loc, buf, length, &amp;length);
          }

       <u>TSUrlLengthGet()</u> calculates the length of the URL located at <u>offset</u> within the marshal buffer bufp as  if
       it were returned as a string. This length will be the same as the length returned by <u>TSUrlStringGet()</u>.

       <u>TSUrlPrint()</u>  formats  a  URL stored in an <u>TSMBuffer</u> to an <u>TSIOBuffer</u>. Capacity is added as needed to the
       <u>iobufp</u> to print the entire URL.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3ts/TSAPI.3ts.html">TSAPI</a>(3ts)</b>,      <b><a href="../man3ts/TSmalloc.3ts.html">TSmalloc</a>(3ts)</b>,       <b><a href="../man3ts/TSUrlCreate.3ts.html">TSUrlCreate</a>(3ts)</b>,       <b><a href="../man3ts/TSUrlHostGet.3ts.html">TSUrlHostGet</a>(3ts)</b>,       <b><a href="../man3ts/TSUrlHostSet.3ts.html">TSUrlHostSet</a>(3ts)</b>,
       <b><a href="../man3ts/TSUrlPercentEncode.3ts.html">TSUrlPercentEncode</a>(3ts)</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2025, <a href="mailto:dev@trafficserver.apache.org">dev@trafficserver.apache.org</a>

9.2                                               May 22, 2025                               <u><a href="../man3ts/TSURLSTRINGGET.3ts.html">TSURLSTRINGGET</a></u>(3ts)
</pre>
 </div>
</div></section>
</div>
</body>
</html>