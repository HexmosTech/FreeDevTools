<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lasd7 - lasd7: D&C step: deflation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/liblapack-doc">liblapack-doc_3.12.1-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       lasd7 - lasd7: D&amp;C step: deflation

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Functions</b>
       subroutine <b>dlasd7</b> (icompq, nl, nr, sqre, k, d, z, zw, vf, vfw, vl, vlw, alpha, beta, dsigma, idx, idxp,
           idxq, perm, givptr, givcol, ldgcol, givnum, ldgnum, c, s, info)
           <b>DLASD7</b> merges the two sets of singular values together into a single sorted set. Then it tries to
           deflate the size of the problem. Used by sbdsdc.
       subroutine <b>slasd7</b> (icompq, nl, nr, sqre, k, d, z, zw, vf, vfw, vl, vlw, alpha, beta, dsigma, idx, idxp,
           idxq, perm, givptr, givcol, ldgcol, givnum, ldgnum, c, s, info)
           <b>SLASD7</b> merges the two sets of singular values together into a single sorted set. Then it tries to
           deflate the size of the problem. Used by sbdsdc.

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>subroutine</b> <b>dlasd7</b> <b>(integer</b> <b>icompq,</b> <b>integer</b> <b>nl,</b> <b>integer</b> <b>nr,</b> <b>integer</b> <b>sqre,</b> <b>integer</b> <b>k,</b> <b>double</b> <b>precision,</b>
       <b>dimension(</b> <b>*</b> <b>)</b> <b>d,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>z,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>zw,</b> <b>double</b>
       <b>precision,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>vf,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>vfw,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>vl,</b>
       <b>double</b> <b>precision,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>vlw,</b> <b>double</b> <b>precision</b> <b>alpha,</b> <b>double</b> <b>precision</b> <b>beta,</b> <b>double</b> <b>precision,</b>
       <b>dimension(</b> <b>*</b> <b>)</b> <b>dsigma,</b> <b>integer,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>idx,</b> <b>integer,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>idxp,</b> <b>integer,</b> <b>dimension(</b> <b>*</b> <b>)</b>
       <b>idxq,</b> <b>integer,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>perm,</b> <b>integer</b> <b>givptr,</b> <b>integer,</b> <b>dimension(</b> <b>ldgcol,</b> <b>*</b> <b>)</b> <b>givcol,</b> <b>integer</b>
       <b>ldgcol,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>ldgnum,</b> <b>*</b> <b>)</b> <b>givnum,</b> <b>integer</b> <b>ldgnum,</b> <b>double</b> <b>precision</b> <b>c,</b> <b>double</b>
       <b>precision</b> <b>s,</b> <b>integer</b> <b>info)</b>
       <b>DLASD7</b> merges the two sets of singular values together into a single sorted set. Then it tries to deflate
       the size of the problem. Used by sbdsdc.

       <b>Purpose:</b>

            DLASD7 merges the two sets of singular values together into a single
            sorted set. Then it tries to deflate the size of the problem. There
            are two ways in which deflation can occur:  when two or more singular
            values are close together or if there is a tiny entry in the Z
            vector. For each such occurrence the order of the related
            secular equation problem is reduced by one.

            DLASD7 is called from DLASD6.

       <b>Parameters</b>
           <u>ICOMPQ</u>

                     ICOMPQ is INTEGER
                     Specifies whether singular vectors are to be computed
                     in compact form, as follows:
                     = 0: Compute singular values only.
                     = 1: Compute singular vectors of upper
                          bidiagonal matrix in compact form.

           <u>NL</u>

                     NL is INTEGER
                    The row dimension of the upper block. NL &gt;= 1.

           <u>NR</u>

                     NR is INTEGER
                    The row dimension of the lower block. NR &gt;= 1.

           <u>SQRE</u>

                     SQRE is INTEGER
                    = 0: the lower block is an NR-by-NR square matrix.
                    = 1: the lower block is an NR-by-(NR+1) rectangular matrix.

                    The bidiagonal matrix has
                    N = NL + NR + 1 rows and
                    M = N + SQRE &gt;= N columns.

           <u>K</u>

                     K is INTEGER
                    Contains the dimension of the non-deflated matrix, this is
                    the order of the related secular equation. 1 &lt;= K &lt;=N.

           <u>D</u>

                     D is DOUBLE PRECISION array, dimension ( N )
                    On entry D contains the singular values of the two submatrices
                    to be combined. On exit D contains the trailing (N-K) updated
                    singular values (those which were deflated) sorted into
                    increasing order.

           <u>Z</u>

                     Z is DOUBLE PRECISION array, dimension ( M )
                    On exit Z contains the updating row vector in the secular
                    equation.

           <u>ZW</u>

                     ZW is DOUBLE PRECISION array, dimension ( M )
                    Workspace for Z.

           <u>VF</u>

                     VF is DOUBLE PRECISION array, dimension ( M )
                    On entry, VF(1:NL+1) contains the first components of all
                    right singular vectors of the upper block; and VF(NL+2:M)
                    contains the first components of all right singular vectors
                    of the lower block. On exit, VF contains the first components
                    of all right singular vectors of the bidiagonal matrix.

           <u>VFW</u>

                     VFW is DOUBLE PRECISION array, dimension ( M )
                    Workspace for VF.

           <u>VL</u>

                     VL is DOUBLE PRECISION array, dimension ( M )
                    On entry, VL(1:NL+1) contains the  last components of all
                    right singular vectors of the upper block; and VL(NL+2:M)
                    contains the last components of all right singular vectors
                    of the lower block. On exit, VL contains the last components
                    of all right singular vectors of the bidiagonal matrix.

           <u>VLW</u>

                     VLW is DOUBLE PRECISION array, dimension ( M )
                    Workspace for VL.

           <u>ALPHA</u>

                     ALPHA is DOUBLE PRECISION
                    Contains the diagonal element associated with the added row.

           <u>BETA</u>

                     BETA is DOUBLE PRECISION
                    Contains the off-diagonal element associated with the added
                    row.

           <u>DSIGMA</u>

                     DSIGMA is DOUBLE PRECISION array, dimension ( N )
                    Contains a copy of the diagonal elements (K-1 singular values
                    and one zero) in the secular equation.

           <u>IDX</u>

                     IDX is INTEGER array, dimension ( N )
                    This will contain the permutation used to sort the contents of
                    D into ascending order.

           <u>IDXP</u>

                     IDXP is INTEGER array, dimension ( N )
                    This will contain the permutation used to place deflated
                    values of D at the end of the array. On output IDXP(2:K)
                    points to the nondeflated D-values and IDXP(K+1:N)
                    points to the deflated singular values.

           <u>IDXQ</u>

                     IDXQ is INTEGER array, dimension ( N )
                    This contains the permutation which separately sorts the two
                    sub-problems in D into ascending order.  Note that entries in
                    the first half of this permutation must first be moved one
                    position backward; and entries in the second half
                    must first have NL+1 added to their values.

           <u>PERM</u>

                     PERM is INTEGER array, dimension ( N )
                    The permutations (from deflation and sorting) to be applied
                    to each singular block. Not referenced if ICOMPQ = 0.

           <u>GIVPTR</u>

                     GIVPTR is INTEGER
                    The number of Givens rotations which took place in this
                    subproblem. Not referenced if ICOMPQ = 0.

           <u>GIVCOL</u>

                     GIVCOL is INTEGER array, dimension ( LDGCOL, 2 )
                    Each pair of numbers indicates a pair of columns to take place
                    in a Givens rotation. Not referenced if ICOMPQ = 0.

           <u>LDGCOL</u>

                     LDGCOL is INTEGER
                    The leading dimension of GIVCOL, must be at least N.

           <u>GIVNUM</u>

                     GIVNUM is DOUBLE PRECISION array, dimension ( LDGNUM, 2 )
                    Each number indicates the C or S value to be used in the
                    corresponding Givens rotation. Not referenced if ICOMPQ = 0.

           <u>LDGNUM</u>

                     LDGNUM is INTEGER
                    The leading dimension of GIVNUM, must be at least N.

           <u>C</u>

                     C is DOUBLE PRECISION
                    C contains garbage if SQRE =0 and the C-value of a Givens
                    rotation related to the right null space if SQRE = 1.

           <u>S</u>

                     S is DOUBLE PRECISION
                    S contains garbage if SQRE =0 and the S-value of a Givens
                    rotation related to the right null space if SQRE = 1.

           <u>INFO</u>

                     INFO is INTEGER
                    = 0:  successful exit.
                    &lt; 0:  if INFO = -i, the i-th argument had an illegal value.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Contributors:</b>
           Ming Gu and Huan Ren, Computer Science Division, University of California at Berkeley, USA

   <b>subroutine</b> <b>slasd7</b> <b>(integer</b> <b>icompq,</b> <b>integer</b> <b>nl,</b> <b>integer</b> <b>nr,</b> <b>integer</b> <b>sqre,</b> <b>integer</b> <b>k,</b> <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>d,</b>
       <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>z,</b> <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>zw,</b> <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>vf,</b> <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>vfw,</b> <b>real,</b>
       <b>dimension(</b> <b>*</b> <b>)</b> <b>vl,</b> <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>vlw,</b> <b>real</b> <b>alpha,</b> <b>real</b> <b>beta,</b> <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>dsigma,</b> <b>integer,</b>
       <b>dimension(</b> <b>*</b> <b>)</b> <b>idx,</b> <b>integer,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>idxp,</b> <b>integer,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>idxq,</b> <b>integer,</b> <b>dimension(</b> <b>*</b> <b>)</b>
       <b>perm,</b> <b>integer</b> <b>givptr,</b> <b>integer,</b> <b>dimension(</b> <b>ldgcol,</b> <b>*</b> <b>)</b> <b>givcol,</b> <b>integer</b> <b>ldgcol,</b> <b>real,</b> <b>dimension(</b> <b>ldgnum,</b> <b>*</b>
       <b>)</b> <b>givnum,</b> <b>integer</b> <b>ldgnum,</b> <b>real</b> <b>c,</b> <b>real</b> <b>s,</b> <b>integer</b> <b>info)</b>
       <b>SLASD7</b> merges the two sets of singular values together into a single sorted set. Then it tries to deflate
       the size of the problem. Used by sbdsdc.

       <b>Purpose:</b>

            SLASD7 merges the two sets of singular values together into a single
            sorted set. Then it tries to deflate the size of the problem. There
            are two ways in which deflation can occur:  when two or more singular
            values are close together or if there is a tiny entry in the Z
            vector. For each such occurrence the order of the related
            secular equation problem is reduced by one.

            SLASD7 is called from SLASD6.

       <b>Parameters</b>
           <u>ICOMPQ</u>

                     ICOMPQ is INTEGER
                     Specifies whether singular vectors are to be computed
                     in compact form, as follows:
                     = 0: Compute singular values only.
                     = 1: Compute singular vectors of upper
                          bidiagonal matrix in compact form.

           <u>NL</u>

                     NL is INTEGER
                    The row dimension of the upper block. NL &gt;= 1.

           <u>NR</u>

                     NR is INTEGER
                    The row dimension of the lower block. NR &gt;= 1.

           <u>SQRE</u>

                     SQRE is INTEGER
                    = 0: the lower block is an NR-by-NR square matrix.
                    = 1: the lower block is an NR-by-(NR+1) rectangular matrix.

                    The bidiagonal matrix has
                    N = NL + NR + 1 rows and
                    M = N + SQRE &gt;= N columns.

           <u>K</u>

                     K is INTEGER
                    Contains the dimension of the non-deflated matrix, this is
                    the order of the related secular equation. 1 &lt;= K &lt;=N.

           <u>D</u>

                     D is REAL array, dimension ( N )
                    On entry D contains the singular values of the two submatrices
                    to be combined. On exit D contains the trailing (N-K) updated
                    singular values (those which were deflated) sorted into
                    increasing order.

           <u>Z</u>

                     Z is REAL array, dimension ( M )
                    On exit Z contains the updating row vector in the secular
                    equation.

           <u>ZW</u>

                     ZW is REAL array, dimension ( M )
                    Workspace for Z.

           <u>VF</u>

                     VF is REAL array, dimension ( M )
                    On entry, VF(1:NL+1) contains the first components of all
                    right singular vectors of the upper block; and VF(NL+2:M)
                    contains the first components of all right singular vectors
                    of the lower block. On exit, VF contains the first components
                    of all right singular vectors of the bidiagonal matrix.

           <u>VFW</u>

                     VFW is REAL array, dimension ( M )
                    Workspace for VF.

           <u>VL</u>

                     VL is REAL array, dimension ( M )
                    On entry, VL(1:NL+1) contains the  last components of all
                    right singular vectors of the upper block; and VL(NL+2:M)
                    contains the last components of all right singular vectors
                    of the lower block. On exit, VL contains the last components
                    of all right singular vectors of the bidiagonal matrix.

           <u>VLW</u>

                     VLW is REAL array, dimension ( M )
                    Workspace for VL.

           <u>ALPHA</u>

                     ALPHA is REAL
                    Contains the diagonal element associated with the added row.

           <u>BETA</u>

                     BETA is REAL
                    Contains the off-diagonal element associated with the added
                    row.

           <u>DSIGMA</u>

                     DSIGMA is REAL array, dimension ( N )
                    Contains a copy of the diagonal elements (K-1 singular values
                    and one zero) in the secular equation.

           <u>IDX</u>

                     IDX is INTEGER array, dimension ( N )
                    This will contain the permutation used to sort the contents of
                    D into ascending order.

           <u>IDXP</u>

                     IDXP is INTEGER array, dimension ( N )
                    This will contain the permutation used to place deflated
                    values of D at the end of the array. On output IDXP(2:K)
                    points to the nondeflated D-values and IDXP(K+1:N)
                    points to the deflated singular values.

           <u>IDXQ</u>

                     IDXQ is INTEGER array, dimension ( N )
                    This contains the permutation which separately sorts the two
                    sub-problems in D into ascending order.  Note that entries in
                    the first half of this permutation must first be moved one
                    position backward; and entries in the second half
                    must first have NL+1 added to their values.

           <u>PERM</u>

                     PERM is INTEGER array, dimension ( N )
                    The permutations (from deflation and sorting) to be applied
                    to each singular block. Not referenced if ICOMPQ = 0.

           <u>GIVPTR</u>

                     GIVPTR is INTEGER
                    The number of Givens rotations which took place in this
                    subproblem. Not referenced if ICOMPQ = 0.

           <u>GIVCOL</u>

                     GIVCOL is INTEGER array, dimension ( LDGCOL, 2 )
                    Each pair of numbers indicates a pair of columns to take place
                    in a Givens rotation. Not referenced if ICOMPQ = 0.

           <u>LDGCOL</u>

                     LDGCOL is INTEGER
                    The leading dimension of GIVCOL, must be at least N.

           <u>GIVNUM</u>

                     GIVNUM is REAL array, dimension ( LDGNUM, 2 )
                    Each number indicates the C or S value to be used in the
                    corresponding Givens rotation. Not referenced if ICOMPQ = 0.

           <u>LDGNUM</u>

                     LDGNUM is INTEGER
                    The leading dimension of GIVNUM, must be at least N.

           <u>C</u>

                     C is REAL
                    C contains garbage if SQRE =0 and the C-value of a Givens
                    rotation related to the right null space if SQRE = 1.

           <u>S</u>

                     S is REAL
                    S contains garbage if SQRE =0 and the S-value of a Givens
                    rotation related to the right null space if SQRE = 1.

           <u>INFO</u>

                     INFO is INTEGER
                    = 0:  successful exit.
                    &lt; 0:  if INFO = -i, the i-th argument had an illegal value.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Contributors:</b>
           Ming Gu and Huan Ren, Computer Science Division, University of California at Berkeley, USA

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for LAPACK from the source code.

Version 3.12.0                              Sun Jul 20 2025 01:40:05                                    <u><a href="../man3/lasd7.3.html">lasd7</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>