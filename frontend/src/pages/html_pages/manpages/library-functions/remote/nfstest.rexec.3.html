<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nfstest.rexec - Remote procedure module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/nfstest">nfstest_3.2-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nfstest.rexec - Remote procedure module

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Provides  a  set  of tools for executing a wide range commands, statements, expressions or functions on a
       remote host by running a server process on the remote host serving requests without  disconnecting.  This
       allows  for  a  sequence  of operations to be done remotely and not losing state.  A file could be opened
       remotely, do some other things and then write to the same opened file without opening the file again.

       The remote server can be executed as a different user by using the sudo option and sending  seteuid.  The
       server  can  be executed locally as well using fork when running as the same user or using the shell when
       the sudo option is used.

       In order to use this module the user id must be able to 'ssh' to the remote host without the need  for  a
       password.

</pre><h4><b>CLASSES</b></h4><pre>
   <b>class</b> <b>RemoteServer(builtins.object)</b>
       <b>Methods</b> <b>defined</b> <b>here:</b>
       ---------------------

       <b>__del__(self)</b>
       Destructor

       <b>__init__(self,</b> <b>port,</b> <b>logfile=None)</b>
       Remote procedure server

       <b>log(self,</b> <b>msg)</b>
       Write message to log file

       <b>start(self)</b>

   <b>class</b> <b>Rexec(baseobj.BaseObj)</b>
       Rexec object

              Rexec() -&gt; New remote procedure object

              Arguments:
                  servername:
                      Name or IP address of remote server
                  logfile:
                      Name of logfile to create on remote server
                  sudo:
                      Run remote server as root

              Usage:
                  from nfstest.rexec import Rexec

                  # Function to be defined at remote host
                  def add_one(n):
                      return n + 1

                  # Function to be defined at remote host
                  def get_time(delay=0):
                      time.sleep(delay)
                      return time.time()

                  # Create remote procedure object
                  x = Rexec("192.168.0.85")

                  # Define function at remote host
                  x.rcode(add_one)

                  # Evaluate the expression calling add_one()
                  out = x.reval("<a href="../man67/add_one.67.html">add_one</a>(67)")

                  # Run the function with the given argument
                  out = x.run("add_one", 7)

                  # Run built-in functions
                  import time
                  out = x.run(time.time)

                  # Import libraries and symbols
                  x.rimport("time", ["sleep"])
                  x.run("sleep", 2)

                  # Define function at remote host -- since function uses the
                  # time module, this module must be first imported
                  x.rimport("time")
                  x.rcode(get_time)

                  # Evaluate the expression calling get_time()
                  out = x.reval("get_time()")

                  # Run the function with the given argument
                  out = x.run("get_time", 10)

                  # Open file on remote host
                  fd = x.run(os.open, "/tmp/testfile", os.O_WRONLY|os.O_CREAT|os.O_TRUNC)
                  count = x.run(os.write, fd, "hello there
       ")
                  x.run(os.close, fd)

                  # Use of positional arguments
                  out = x.run("get_time", 2)

                  # Use of named arguments
                  out = x.run("get_time", delay=2)

                  # Use of NOWAIT option for long running functions so other things
                  # can be done while waiting
                  x.run("get_time", 2, NOWAIT=True)
                  while True:
                      # Poll every 0.1 secs to see if function has finished
                      if x.poll(0.1):
                          # Get results
                          out = x.results()
                          break

                  # Create remote procedure object as a different user
                  # First, run the remote server as root
                  x = Rexec("192.168.0.85", sudo=True)
                  # Then set the effective user id
                  x.run(os.seteuid, 1000)

       <b>Methods</b> <b>defined</b> <b>here:</b>
       ---------------------

       <b>__del__(self)</b>
       Destructor

       <b>__init__(self,</b> <b>servername=None,</b> <b>logfile=None,</b> <b>sudo=False,</b> <b>timeout=30.0)</b>
       Constructor

       Initialize object's private data.

              <b>servername:</b>
                     Host name or IP address of host where remote server will run
                     [Default: None (run locally)]

              <b>logfile:</b>
                     Pathname of log file to be created on remote host
                     [Default: None]

              <b>sudo:</b>  Run remote procedure server as root
                     [Default: False]

              <b>timeout:</b>
                     Timeout for synchronous calls
                     [Default: 30.0]

       <b>close(self)</b>
       Close connection to remote server

       <b>poll(self,</b> <b>timeout=0)</b>
       Return whether there is any data available to be read

              <b>timeout:</b>
                     Maximum time in seconds to block, if timeout is None then
                     an infinite timeout is used

       <b>rcode(self,</b> <b>code)</b>
       Define function on remote server

       <b>results(self,</b> <b>xid=None)</b>
       Return pending results

       <b>reval(self,</b> <b>expr)</b>
       Evaluate expression on remote server

       <b>rexec(self,</b> <b>expr)</b>
       Execute statement on remote server

       <b>rimport(self,</b> <b>module,</b> <b>symbols=[])</b>
       Import module on remote server

              <b>module:</b>
                     Module to import in the remote server

              <b>symbols:</b>
                     If given, import only these symbols from the module

       <b>run(self,</b> <b>*kwts,</b> <b>**kwds)</b>
       Run function on remote server

       The first positional argument is the function to be executed.
       All other positional arguments and any named arguments are treated
       as arguments to the function

       <b>wait(self,</b> <b>objlist=None,</b> <b>timeout=0)</b>
       Return a list of Rexec objects where data is available to be read

              <b>objlist:</b>
                     List of Rexec objects to poll, if not given use current object

              <b>timeout:</b>
                     Maximum time in seconds to block, if timeout is None then
                     an infinite timeout is used

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/baseobj.3.html">baseobj</a>(3)</b>

</pre><h4><b>BUGS</b></h4><pre>
       No known bugs.

</pre><h4><b>AUTHOR</b></h4><pre>
       Jorge Mora (<a href="mailto:mora@netapp.com">mora@netapp.com</a>)

NFStest 3.2                                       21 March 2023                                         <u><a href="../man3/REXEC.3.html">REXEC</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>