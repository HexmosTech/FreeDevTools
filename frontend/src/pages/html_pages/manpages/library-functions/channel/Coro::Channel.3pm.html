<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coro::Channel - message queues</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcoro-perl">libcoro-perl_6.570-4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Coro::Channel - message queues

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Coro;

        $q1 = new Coro::Channel &lt;maxsize&gt;;

        $q1-&gt;put ("xxx");
        print $q1-&gt;get;

        die unless $q1-&gt;size;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A Coro::Channel is the equivalent of a unix pipe (and similar to amiga message ports): you can put things
       into it on one end and read things out of it from the other end. If the capacity of the Channel is maxed
       out writers will block. Both ends of a Channel can be read/written from by as many coroutines as you want
       concurrently.

       You don't have to load "Coro::Channel" manually, it will be loaded automatically when you "use Coro" and
       call the "new" constructor.

       $q = new Coro:Channel $maxsize
           Create  a  new  channel with the given maximum size (practically unlimited if "maxsize" is omitted or
           zero). Giving a size of one gives you a traditional channel, i.e. a  queue  that  can  store  only  a
           single  element  (which  means  there  will  be  no  buffering,  and "put" will wait until there is a
           corresponding "get" call). To buffer one element you have to specify 2, and so on.

       $q-&gt;put ($scalar)
           Put the given scalar into the queue.

       $q-&gt;get
           Return the next element from the queue, waiting if necessary.

       $q-&gt;shutdown
           Shuts down the Channel by pushing a virtual end marker onto it: This changes  the  behaviour  of  the
           Channel  when it becomes or is empty to return "undef", almost as if infinitely many "undef" elements
           had been put into the queue.

           Specifically, this function wakes up any pending "get" calls and lets them return "undef",  the  same
           on future "get" calls. "size" will return the real number of stored elements, though.

           Another way to describe the behaviour is that "get" calls will not block when the queue becomes empty
           but  immediately  return "undef". This means that calls to "put" will work normally and the data will
           be returned on subsequent "get" calls.

           This method is useful to signal the end of data to any consumers, quite similar to an end  of  stream
           on e.g. a tcp socket: You have one or more producers that "put" data into the Channel and one or more
           consumers  who  "get"  them.  When  all  producers have finished producing data, a call to "shutdown"
           signals this fact to any consumers.

           A common implementation uses one or more threads that "get" from a channel until it returns  "undef".
           To clean everything up, first "shutdown" the channel, then "join" the threads.

       $q-&gt;size
           Return the number of elements waiting to be consumed. Please note that:

             if ($q-&gt;size) {
                my $data = $q-&gt;get;
                ...
             }

           is  <u>not</u>  a race condition but instead works just fine. Note that the number of elements that wait can
           be larger than $maxsize, as it includes any coroutines waiting to put data into the channel (but  not
           any shutdown condition).

           This  means  that  the  number  returned  is <u>precisely</u> the number of calls to "get" that will succeed
           instantly and return some data. Calling "shutdown" has no effect on this number.

</pre><h4><b>AUTHOR/SUPPORT/CONTACT</b></h4><pre>
          Marc A. Lehmann &lt;<a href="mailto:schmorp@schmorp.de">schmorp@schmorp.de</a>&gt;
          <a href="http://software.schmorp.de/pkg/Coro.html">http://software.schmorp.de/pkg/Coro.html</a>

perl v5.40.1                                       2025-03-21                                       <u><a href="../man3pm/Channel.3pm.html">Channel</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>