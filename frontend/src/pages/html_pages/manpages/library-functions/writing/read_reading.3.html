<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>read_reading, fread_reading - Read a trace file into a Read structure.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libstaden-read-dev">libstaden-read-dev_1.15.0-1.1build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>read_reading</b>, <b>fread_reading</b> - Read a trace file into a <b>Read</b> structure.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;Read.h&gt;</b>

       <b>Read</b> <b>*read_reading(</b>
            <b>char</b> <b>*filename,</b>
            <b>int</b> <b>format);</b>

       <b>Read</b> <b>*fread_reading(</b>
            <b>FILE</b> <b>*fp,</b>
            <b>char</b> <b>*filename,</b>
            <b>int</b> <b>format);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These functions read trace files into a <b>Read</b> structure. A variety of formats are supported including ABI,
       ALF  and  SCF. (Note that the first two are only supported when the library is used as part of the Staden
       Package.)  Additionally, support for reading the plain (old) staden format files and Experiment files  is
       included.  Compressed  trace  files may also be read.  Decompression is performed using either <b>gzip</b> <b>-d</b> or
       <b>uncompress</b> and is written to a temporary file for further processing. The temporary file is then read and
       removed.

       When reading an experiment file the trace file referenced by the LN and LT line types is read. The QL, QR
       (left and right quality clips), SL and SR (left and right vector clips) are  taken  from  the  Experiment
       file  to  produce the cutoff information held within the <b>Read</b> structure. The <b>orig_trace</b> field of the <b>Read</b>
       structure will then contain the pointer to the experiment file structure and the <b>orig_trace_format</b>  field
       will be set to <b>TT_EXP</b>.

       The  functions  allocate  a  <b>Read</b>  structure  which  is  returned.  To  deallocate this structure use the
       <b>read_deallocate()</b> function.

       <b>read_reading()</b> reads a trace from the specified  filename  and  format.  Formats  available  are  <b>TT_SCF</b>,
       <b>TT_ABI</b>,  <b>TT_ALF</b>, <b>TT_PLN</b>, <b>TT_EXP</b>and <b>TT_ANY</b>.  Specifying format <b>TT_ANY</b> will attempt to automatically detect
       the corret format type by analysing the trace file for magic numbers and composition. The <b>format</b> field of
       the structure can then be used to determine the real trace type.

       <b>fread_reading()</b> reads a trace from the specified file pointer. The filename argument is used for  setting
       the  <b>trace_name</b>  field  of  the  resulting  structure,  and for error messages. Otherwise the function is
       identical to the <b>read_reading()</b> function.

       The <b>Read</b> structure itself is as follows.
       <b>typedef</b> <b>uint_2</b> <b>TRACE;</b>        <b>/*</b> <b>for</b> <b>trace</b> <b>heights</b> <b>*/</b>

       <b>typedef</b> <b>struct</b>
       <b>{</b>
           <b>int</b>         <b>format;</b>      <b>/*</b> <b>Trace</b> <b>file</b> <b>format</b> <b>*/</b>
           <b>char</b>       <b>*trace_name;</b>  <b>/*</b> <b>Trace</b> <b>file</b> <b>name</b>   <b>*/</b>

           <b>int</b>         <b>NPoints;</b>     <b>/*</b> <b>No.</b> <b>of</b> <b>points</b> <b>of</b> <b>data</b> <b>*/</b>
           <b>int</b>         <b>NBases;</b>      <b>/*</b> <b>No.</b> <b>of</b> <b>bases</b>          <b>*/</b>

           <b>/*</b> <b>Traces</b> <b>*/</b>
           <b>TRACE</b>      <b>*traceA;</b>      <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>`NPoints'</b> <b>*/</b>
           <b>TRACE</b>      <b>*traceC;</b>      <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>`NPoints'</b> <b>*/</b>
           <b>TRACE</b>      <b>*traceG;</b>      <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>`NPoints'</b> <b>*/</b>
           <b>TRACE</b>      <b>*traceT;</b>      <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>`NPoints'</b> <b>*/</b>
           <b>TRACE</b>       <b>maxTraceVal;</b> <b>/*</b> <b>The</b> <b>maximal</b> <b>value</b> <b>in</b> <b>any</b> <b>trace</b> <b>*/</b>

           <b>/*</b> <b>Bases</b> <b>*/</b>
           <b>char</b>       <b>*base;</b>        <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>`NBases'</b> <b>*/</b>
           <b>uint_2</b>     <b>*basePos;</b>     <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>`NBases'</b> <b>*/</b>

           <b>/*</b> <b>Cutoffs</b> <b>*/</b>
           <b>int</b>         <b>leftCutoff;</b>  <b>/*</b> <b>Number</b> <b>of</b> <b>unwanted</b> <b>bases</b> <b>*/</b>
           <b>int</b>         <b>rightCutoff;</b> <b>/*</b> <b>Number</b> <b>of</b> <b>unwanted</b> <b>bases</b> <b>*/</b>

           <b>/*</b> <b>Miscellaneous</b> <b>Sequence</b> <b>Information</b> <b>*/</b>
           <b>char</b>       <b>*info;</b>        <b>/*</b> <b>misc</b> <b>seq</b> <b>info,</b> <b>eg</b> <b>comments</b> <b>*/</b>

           <b>/*</b> <b>Probability</b> <b>information</b> <b>*/</b>
           <b>char</b>       <b>*prob_A;</b>      <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>'NBases'</b> <b>*/</b>
           <b>char</b>       <b>*prob_C;</b>      <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>'NBases'</b> <b>*/</b>
           <b>char</b>       <b>*prob_G;</b>      <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>'NBases'</b> <b>*/</b>
           <b>char</b>       <b>*prob_T;</b>      <b>/*</b> <b>Array</b> <b>of</b> <b>length</b> <b>'NBases'</b> <b>*/</b>

           <b>/*</b> <b>The</b> <b>original</b> <b>input</b> <b>format</b> <b>data,</b> <b>or</b> <b>NULL</b> <b>if</b> <b>inapplicable</b> <b>*/</b>
           <b>int</b> <b>orig_trace_format;</b>
           <b>void</b> <b>*orig_trace;</b>

       <b>}</b> <b>Read;</b>

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       On successful completion, the <b>read_reading()</b> and <b>fread_reading()</b> functions return a  pointer  to  a  <b>Read</b>
       structure. Otherwise these functions return NULLRead (which is a null pointer).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/write_reading.3.html">write_reading</a></b>(3), <b><a href="../man3/fwrite_reading.3.html">fwrite_reading</a></b>(3), <b><a href="../man3/deallocate_reading.3.html">deallocate_reading</a></b>(3), <b><a href="../man4/scf.4.html">scf</a></b>(4),
       <b><a href="../man4/ExperimentFile.4.html">ExperimentFile</a></b>(4)

                                                                                                 <u><a href="../man3/read_reading.3.html">read_reading</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>