<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ibv_post_send - post a list of work requests (WRs) to a send queue</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libibverbs-dev">libibverbs-dev_56.1-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ibv_post_send - post a list of work requests (WRs) to a send queue

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;infiniband/verbs.h&gt;</b>

       <b>int</b> <b>ibv_post_send(struct</b> <b>ibv_qp</b> <u>*qp</u><b>,</b> <b>struct</b> <b>ibv_send_wr</b> <u>*wr</u><b>,</b>
                         <b>struct</b> <b>ibv_send_wr</b> <u>**bad_wr</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>ibv_post_send()</b>  posts  the  linked list of work requests (WRs) starting with <u>wr</u> to the send queue of the
       queue pair <u>qp</u>.  It stops processing WRs from this list  at  the  first  failure  (that  can  be  detected
       immediately while requests are being posted), and returns this failing WR through <u>bad_wr</u>.

       The argument <u>wr</u> is an ibv_send_wr struct, as defined in &lt;infiniband/verbs.h&gt;.

       struct ibv_send_wr {
               uint64_t                wr_id;                  /* User defined WR ID */
               struct ibv_send_wr     *next;                   /* Pointer to next WR in list, NULL if last WR */
               struct ibv_sge         *sg_list;                /* Pointer to the s/g array */
               int                     num_sge;                /* Size of the s/g array */
               enum ibv_wr_opcode      opcode;                 /* Operation type */
               unsigned int            send_flags;             /* Flags of the WR properties */
               union {
                       __be32                  imm_data;               /* Immediate data (in network byte order) */
                       uint32_t                invalidate_rkey;        /* Remote rkey to invalidate */
               };
               union {
                       struct {
                               uint64_t        remote_addr;    /* Start address of remote memory buffer */
                               uint32_t        rkey;           /* Key of the remote Memory Region */
                       } rdma;
                       struct {
                               uint64_t        remote_addr;    /* Start address of remote memory buffer */
                               uint64_t        compare_add;    /* Compare operand */
                               uint64_t        swap;           /* Swap operand */
                               uint32_t        rkey;           /* Key of the remote Memory Region */
                       } atomic;
                       struct {
                               struct ibv_ah  *ah;             /* Address handle (AH) for the remote node address */
                               uint32_t        remote_qpn;     /* QP number of the destination QP */
                               uint32_t        remote_qkey;    /* Q_Key number of the destination QP */
                       } ud;
               } wr;
               union {
                       struct {
                               uint32_t remote_srqn;            /* Number of the remote SRQ */
                       } xrc;
               } qp_type;
               union {
                       struct {
                               struct ibv_mw            *mw;             /* Memory window (MW) of type 2 to bind */
                               uint32_t                 rkey;            /* The desired new rkey of the MW */
                               struct ibv_mw_bind_info  bind_info;       /* MW additional bind information */
                       } bind_mw;
                       struct {
                               void           *hdr;     /* Pointer address of inline header */
                               uint16_t       hdr_sz;   /* Inline header size */
                               uint16_t       mss; /* Maximum segment size for each TSO fragment */
                       } tso;
               };
       };

       struct ibv_mw_bind_info {
               struct ibv_mr            *mr;             /* The Memory region (MR) to bind the MW to */
               uint64_t                 addr;           /* The address the MW should start at */
               uint64_t                 length;          /* The length (in bytes) the MW should span */
               unsigned int             mw_access_flags; /* Access flags to the MW. Use ibv_access_flags */
       };

       struct ibv_sge {
               uint64_t                addr;                   /* Start address of the local memory buffer or number of bytes from the
                                                                  start of the MR for MRs which are IBV_ACCESS_ZERO_BASED */
               uint32_t                length;                 /* Length of the buffer */
               uint32_t                lkey;                   /* Key of the local Memory Region */
       };

       Each QP Transport Service Type supports a specific set of opcodes, as shown in the following table:

       OPCODE                      | IBV_QPT_UD | IBV_QPT_UC | IBV_QPT_RC | IBV_QPT_XRC_SEND | IBV_QPT_RAW_PACKET
       ----------------------------+------------+------------+------------+------------------+--------------------
       IBV_WR_SEND                 |     X      |     X      |     X      |         X        |         X
       IBV_WR_SEND_WITH_IMM        |     X      |     X      |     X      |         X        |
       IBV_WR_RDMA_WRITE           |            |     X      |     X      |         X        |
       IBV_WR_RDMA_WRITE_WITH_IMM  |            |     X      |     X      |         X        |
       IBV_WR_RDMA_READ            |            |            |     X      |         X        |
       IBV_WR_ATOMIC_CMP_AND_SWP   |            |            |     X      |         X        |
       IBV_WR_ATOMIC_FETCH_AND_ADD |            |            |     X      |         X        |
       IBV_WR_LOCAL_INV            |            |     X      |     X      |         X        |
       IBV_WR_BIND_MW              |            |     X      |     X      |         X        |
       IBV_WR_SEND_WITH_INV        |            |     X      |     X      |         X        |
       IBV_WR_TSO                  |     X      |            |            |                  |         X

       The  attribute  send_flags describes the properties of the WR. It is either 0 or the bitwise OR of one or
       more of the following flags:

       <b>IBV_SEND_FENCE</b>  Set the fence indicator. Valid only for QPs with Transport Service Type <b>IBV_QPT_RC</b>

       <b>IBV_SEND_SIGNALED</b>  Set the completion notification indicator. Relevant only if QP was created with
       sq_sig_all=0

       <b>IBV_SEND_SOLICITED</b>  Set the solicited event indicator. Valid only for Send and RDMA Write with immediate

       <b>IBV_SEND_INLINE</b>  Send data in given gather list as inline data
              in a send WQE.  Valid only for Send and RDMA Write.  The L_Key will not be checked.

       <b>IBV_SEND_IP_CSUM</b>  Offload the IPv4 and TCP/UDP checksum calculation.
              Valid only when <b>device_cap_flags</b> in device_attr indicates current  QP  is  supported  by  checksum
              offload.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>ibv_post_send()</b>  returns  0  on  success,  or  the value of errno on failure (which indicates the failure
       reason).

</pre><h4><b>NOTES</b></h4><pre>
       The user should not alter or destroy AHs associated with WRs until request is fully executed and  a  work
       completion has been retrieved from the corresponding completion queue (CQ) to avoid unexpected behavior.

       The  buffers  used  by  a  WR can only be safely reused after WR the request is fully executed and a work
       completion  has  been  retrieved  from  the  corresponding  completion  queue  (CQ).  However,   if   the
       IBV_SEND_INLINE flag was set, the buffer can be reused immediately after the call returns.

       IBV_WR_DRIVER1 is an opcode that should be used to issue a specific driver operation.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ibv_create_qp.3.html">ibv_create_qp</a></b>(3), <b><a href="../man3/ibv_create_ah.3.html">ibv_create_ah</a></b>(3), <b><a href="../man3/ibv_post_recv.3.html">ibv_post_recv</a></b>(3), <b><a href="../man3/ibv_post_srq_recv.3.html">ibv_post_srq_recv</a></b>(3), <b><a href="../man3/ibv_poll_cq.3.html">ibv_poll_cq</a></b>(3)

</pre><h4><b>AUTHORS</b></h4><pre>
       Dotan Barak &lt;<a href="mailto:dotanba@gmail.com">dotanba@gmail.com</a>&gt;

       Majd Dibbiny &lt;<a href="mailto:majd@mellanox.com">majd@mellanox.com</a>&gt;

       Yishai Hadas &lt;<a href="mailto:yishaih@mellanox.com">yishaih@mellanox.com</a>&gt;

libibverbs                                         2006-10-31                                   <u><a href="../man3/IBV_POST_SEND.3.html">IBV_POST_SEND</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>