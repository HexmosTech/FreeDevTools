<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnyEvent::HTTPD::Request - A web application request handle for AnyEvent::HTTPD</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libanyevent-httpd-perl">libanyevent-httpd-perl_0.93-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       AnyEvent::HTTPD::Request - A web application request handle for AnyEvent::HTTPD

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This is the request object as generated by AnyEvent::HTTPD and given in the request callbacks.

</pre><h4><b>METHODS</b></h4><pre>
       <b>url</b> This method returns the URL of the current request as URI object.

       <b>respond</b> <b>([$res])</b>
           $res can be:

           •   an array reference

               Then the array reference has these elements:

                  my ($code, $message, $header_hash, $content) =
                        [200, 'ok', { 'Content-Type' =&gt; 'text/html' }, '&lt;h1&gt;Test&lt;/h1&gt;' }]

               You   can   remove   most   headers  added  by  default  (like  "Cache-Control",  "Expires",  and
               "Content-Length") by setting them to undef, like so:

                  $req-&gt;respond([
                     200, 'OK', {
                       'Content-Type'  =&gt; 'text/html',
                       'Cache-Control' =&gt; 'max-age=3600',
                       'Expires'       =&gt; undef,
                     },
                     'This data will be cached for one hour.'
                  ]);

           •   a hash reference

               If it was a hash reference the hash is first searched for the "redirect" key and if that key does
               not exist for the "content" key.

               The value for the "redirect" key should contain the URL that you want to redirect the request to.

               The value for the "content" key should contain an array reference with the first value being  the
               content type and the second the content.

           Here is an example:

              $httpd-&gt;reg_cb (
                 '/image/elmex' =&gt; sub {
                    my ($httpd, $req) = @_;

                    open IMG, "$ENV{HOME}/media/images/elmex.png"
                       or $req-&gt;respond (
                             [404, 'not found', { 'Content-Type' =&gt; 'text/plain' }, 'not found']
                          );

                    $req-&gt;respond ({ content =&gt; ['image/png', do { local $/; &lt;IMG&gt; }] });
                 }
              );

           <b>How</b> <b>to</b> <b>send</b> <b>large</b> <b>files:</b>

           For  longer  responses  you  can give a callback instead of a string to the response function for the
           value of the $content.

              $req-&gt;respond ({ content =&gt; ['video/x-ms-asf', sub {
                 my ($data_cb) = @_;

                 # start some async retrieve operation, for example use
                 # IO::AIO (with AnyEvent::AIO). Or retrieve chunks of data
                 # to send somehow else.

              } });

           The given callback will receive as first argument either another  callback  ($data_cb  in  the  above
           example)  or an undefined value, which means that there is no more data required and the transfer has
           been completed (either by you sending no more data, or by a disconnect of the client).

           The callback given to "respond" will be called whenever the send queue of the HTTP connection becomes
           empty (meaning that the data is written out to the kernel).  If  it  is  called  you  have  to  start
           delivering the next chunk of data.

           That  doesn't  have to be immediately, before the callback returns.  This means that you can initiate
           for instance an IO::AIO request (see also AnyEvent::AIO) and send the data later.  That is  what  the
           $data_cb  callback  is  for. You have to call it once you got the next chunk of data. Once you sent a
           chunk of data via $data_cb you can just wait until your callback is called again to deliver the  next
           chunk.

           If  you  are done transferring all data call the $data_cb with an empty string or with no argument at
           all.

           Please consult the example script "large_response_example"  from  the  "samples/"  directory  of  the
           AnyEvent::HTTPD distribution for an example of how to use this mechanism.

           <b>NOTE:</b>  You  should  supply  a  'Content-Length' header if you are going to send a larger file. If you
           don't do that the client will have no chance  to  know  if  the  transfer  was  complete.  To  supply
           additional  header  fields  the hash argument format will not work. You should use the array argument
           format for this case.

       <b>responded</b>
           Returns true if this request already has been responded to.

       <b>parm</b> <b>($key)</b>
           Returns the first value of the form parameter $key or undef.

       <b>params</b>
           Returns list of parameter names.

       <b>vars</b>
           Returns a hash of form parameters. The value is either the value of the parameter, and in case  there
           are multiple values present it will contain an array reference of values.

       <b>method</b>
           This method returns the method of the current request.

       <b>content</b>
           Returns the request content or undef if only parameters for a form were transmitted.

       <b>headers</b>
           This method will return a hash reference containing the HTTP headers for this HTTP request.

       <b>client_host</b>
           This method returns the host/IP of the HTTP client this request was received from.

       <b>client_port</b>
           This method returns the TCP port number of the HTTP client this request was received from.

</pre><h4><b>COPYRIGHT</b> <b>&amp;</b> <b>LICENSE</b></h4><pre>
       Copyright 2008-2011 Robin Redeker, all rights reserved.

       This  program  is  free  software;  you can redistribute it and/or modify it under the same terms as Perl
       itself.

perl v5.34.0                                       2022-06-05                      <u>AnyEvent::HTTPD::<a href="../man3pm/Request.3pm.html">Request</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>