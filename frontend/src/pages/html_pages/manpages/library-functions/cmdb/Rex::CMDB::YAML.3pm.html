<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rex::CMDB::YAML - YAML-based CMDB provider for Rex</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/rex">rex_1.16.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Rex::CMDB::YAML - YAML-based CMDB provider for Rex

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module collects and merges data from a set of YAML files to provide configuration management
       database for Rex.

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Rex::CMDB;

        set cmdb =&gt; {
          type           =&gt; 'YAML',
          path           =&gt; [ 'cmdb/{hostname}.yml', 'cmdb/default.yml', ],
          merge_behavior =&gt; 'LEFT_PRECEDENT',
        };

        task 'prepare', 'server1', sub {
          my %all_information          = get cmdb;
          my $specific_item            = get cmdb('item');
          my $specific_item_for_server = get cmdb( 'item', 'server' );
        };

</pre><h4><b>CONFIGURATION</b> <b>AND</b> <b>ENVIRONMENT</b></h4><pre>
   <b>path</b>
       The path used to look for CMDB files. It supports various use cases depending on the type of data passed
       to it.

       •   Scalar

            set cmdb =&gt; {
              type =&gt; 'YAML',
              path =&gt; 'path/to/cmdb',
            };

           If a scalar is used, it tries to look up a few files under the given path:

            path/to/cmdb/{environment}/{hostname}.yml
            path/to/cmdb/{environment}/default.yml
            path/to/cmdb/{hostname}.yml
            path/to/cmdb/default.yml

       •   Array reference

            set cmdb =&gt; {
              type =&gt; 'YAML',
              path =&gt; [ 'cmdb/{hostname}.yml', 'cmdb/default.yml', ],
            };

           If an array reference is used, it tries to look up the mentioned files in the given order.

       •   Code reference

            set cmdb =&gt; {
              type =&gt; 'YAML',
              path =&gt; sub {
                my ( $provider, $item, $server ) = @_;
                my @files = ( "$server.yml", "$item.yml" );
                return @files;
              },
            };

           If  a  code reference is passed, it should return a list of files that would be looked up in the same
           order. The code reference gets the CMDB provider instance, the item, and the server as parameters.

       When the 0.51 feature flag or later is used, the default value of the "path" option is:

        [qw(
          cmdb/{operatingsystem}/{hostname}.yml
          cmdb/{operatingsystem}/default.yml
          cmdb/{environment}/{hostname}.yml
          cmdb/{environment}/default.yml
          cmdb/{hostname}.yml
          cmdb/default.yml
        )]

       The path specification supports macros enclosed within  curly  braces,  which  are  dynamically  expanded
       during  runtime. By default, the valid macros are Rex::Hardware variables, "{server}" for the server name
       of the current connection, and "{environment}" for the current environment.

       Please note that the default environment is, well, "default".

       You can define additional CMDB paths via the "-O" command line option by using a semicolon-separated list
       of "cmdb_path=$path" key-value pairs:

        rex -O 'cmdb_path=cmdb/{domain}.yml;cmdb_path=cmdb/{domain}/{hostname}.yml;' taskname

       Those additional paths will be prepended to the current list of CMDB paths (so  the  last  one  specified
       will get on top, and thus checked first).

   <b>merge_behavior</b>
       This  CMDB  provider  looks  up the specified files in order, and returns the requested data. If multiple
       files specify the same data for a given item, then the first instance of the data  will  be  returned  by
       default.

       Rex  uses  Hash::Merge  internally to merge the data found on different levels of the CMDB hierarchy. Any
       merge strategy supported by that module can be specified to override the default one. For example one  of
       the built-in strategies:

        set cmdb =&gt; {
          type           =&gt; 'YAML',
          path           =&gt; 'cmdb',
          merge_behavior =&gt; 'LEFT_PRECEDENT',
        };

       Or even custom ones:

        set cmdb =&gt; {
          type           =&gt; 'YAML',
          path           =&gt; 'cmdb',
          merge_behavior =&gt; {
            SCALAR =&gt; sub {},
            ARRAY  =&gt; sub {},
            HASH   =&gt; sub {},
        };

       For the full list of options, please see the documentation of Hash::Merge.

perl v5.40.0                                       2025-02-06                               <u>Rex::CMDB::<a href="../man3pm/YAML.3pm.html">YAML</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>