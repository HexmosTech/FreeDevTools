<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-posix-dev">manpages-posix-dev_2017a-2_all</a> <br><br><pre>
</pre><h4><b>PROLOG</b></h4><pre>
       This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface
       may differ (consult the corresponding Linux manual page for details of Linux behavior), or the  interface
       may not be implemented on Linux.

</pre><h4><b>NAME</b></h4><pre>
       poll — input/output multiplexing

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/poll.h">poll.h</a>&gt;

       int poll(struct pollfd <u>fds</u>[], nfds_t <u>nfds</u>, int <u>timeout</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <u>poll</u>()  function  provides applications with a mechanism for multiplexing input/output over a set of
       file descriptors. For each member of the array pointed to by <u>fds</u>, <u>poll</u>() shall  examine  the  given  file
       descriptor  for  the  event(s)  specified in <u>events</u>.  The number of <b>pollfd</b> structures in the <u>fds</u> array is
       specified by <u>nfds</u>.  The <u>poll</u>() function shall identify those file descriptors on which an application can
       read or write data, or on which certain events have occurred.

       The <u>fds</u> argument specifies the file descriptors to be examined and the events of interest for  each  file
       descriptor.  It  is  a pointer to an array with one member for each open file descriptor of interest. The
       array's members are <b>pollfd</b> structures within which <u>fd</u> specifies an open file descriptor  and  <u>events</u>  and
       <u>revents</u> are bitmasks constructed by OR'ing a combination of the following event flags:

       POLLIN      Data other than high-priority data may be read without blocking.

                   For  STREAMS,  this  flag  is set in <u>revents</u> even if the message is of zero length. This flag
                   shall be equivalent to POLLRDNORM | POLLRDBAND.

       POLLRDNORM  Normal data may be read without blocking.

                   For STREAMS, data on priority band 0 may be read  without  blocking.  This  flag  is  set  in
                   <u>revents</u> even if the message is of zero length.

       POLLRDBAND  Priority data may be read without blocking.

                   For STREAMS, data on priority bands greater than 0 may be read without blocking. This flag is
                   set in <u>revents</u> even if the message is of zero length.

       POLLPRI     High-priority data may be read without blocking.

                   For STREAMS, this flag is set in <u>revents</u> even if the message is of zero length.

       POLLOUT     Normal data may be written without blocking.

                   For STREAMS, data on priority band 0 may be written without blocking.

       POLLWRNORM  Equivalent to POLLOUT.

       POLLWRBAND  Priority data may be written.

                   For  STREAMS,  data  on priority bands greater than 0 may be written without blocking. If any
                   priority band has been written to on this STREAM, this event only examines  bands  that  have
                   been written to at least once.

       POLLERR     An  error  has  occurred  on  the  device  or  stream. This flag is only valid in the <u>revents</u>
                   bitmask; it shall be ignored in the <u>events</u> member.

       POLLHUP     A device has been disconnected, or a pipe or FIFO has been closed by the  last  process  that
                   had  it  open  for  writing.  Once  set,  the hangup state of a FIFO shall persist until some
                   process opens the FIFO for writing or until all read-only file descriptors for the  FIFO  are
                   closed.  This  event  and POLLOUT are mutually-exclusive; a stream can never be writable if a
                   hangup has occurred. However, this event and POLLIN, POLLRDNORM, POLLRDBAND, or  POLLPRI  are
                   not  mutually-exclusive.  This flag is only valid in the <u>revents</u> bitmask; it shall be ignored
                   in the <u>events</u> member.

       POLLNVAL    The specified <u>fd</u> value is invalid. This flag is only valid in the <u>revents</u>  member;  it  shall
                   ignored in the <u>events</u> member.

       The significance and semantics of normal, priority, and high-priority data are file and device-specific.

       If  the  value of <u>fd</u> is less than 0, <u>events</u> shall be ignored, and <u>revents</u> shall be set to 0 in that entry
       on return from <u>poll</u>().

       In each <b>pollfd</b> structure, <u>poll</u>() shall clear the  <u>revents</u>  member,  except  that  where  the  application
       requested a report on a condition by setting one of the bits of <u>events</u> listed above, <u>poll</u>() shall set the
       corresponding  bit  in  <u>revents</u>  if  the  requested  condition is true. In addition, <u>poll</u>() shall set the
       POLLHUP, POLLERR, and POLLNVAL flag in <u>revents</u> if the condition is true, even if the application did  not
       set the corresponding bit in <u>events</u>.

       If  none  of the defined events have occurred on any selected file descriptor, <u>poll</u>() shall wait at least
       <u>timeout</u> milliseconds for an event to occur on any of the selected  file  descriptors.  If  the  value  of
       <u>timeout</u>  is 0, <u>poll</u>() shall return immediately. If the value of <u>timeout</u> is -1, <u>poll</u>() shall block until a
       requested event occurs or until the call is interrupted.

       Implementations may place limitations on the granularity of timeout intervals. If the  requested  timeout
       interval requires a finer granularity than the implementation supports, the actual timeout interval shall
       be rounded up to the next supported value.

       The <u>poll</u>() function shall not be affected by the O_NONBLOCK flag.

       The  <u>poll</u>()  function  shall  support  regular files, terminal and pseudo-terminal devices, FIFOs, pipes,
       sockets and STREAMS-based files.  The behavior of <u>poll</u>() on elements of <u>fds</u> that refer to other types  of
       file is unspecified.

       Regular files shall always poll TRUE for reading and writing.

       A  file  descriptor  for  a  socket that is listening for connections shall indicate that it is ready for
       reading,  once  connections  are  available.   A  file  descriptor  for  a  socket  that  is   connecting
       asynchronously shall indicate that it is ready for writing, once a connection has been established.

       Provided  the  application does not perform any action that results in unspecified or undefined behavior,
       the value of the <u>fd</u> and <u>events</u> members of each element of <u>fds</u> shall not be modified by <u>poll</u>().

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Upon successful completion, <u>poll</u>() shall return a non-negative value.  A  positive  value  indicates  the
       total  number of <b>pollfd</b> structures that have selected events (that is, those for which the <u>revents</u> member
       is non-zero). A value of 0 indicates that the call timed out and no file descriptors have been  selected.
       Upon failure, <u>poll</u>() shall return -1 and set <u>errno</u> to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       The <u>poll</u>() function shall fail if:

       <b>EAGAIN</b> The allocation of internal data structures failed but a subsequent request may succeed.

       <b>EINTR</b>  A signal was caught during <u>poll</u>().

       <b>EINVAL</b> The  <u>nfds</u>  argument  is  greater  than  {OPEN_MAX}, or one of the <u>fd</u> members refers to a STREAM or
              multiplexer that is linked (directly or indirectly) downstream from a multiplexer.

       <u>The</u> <u>following</u> <u>sections</u> <u>are</u> <u>informative.</u>

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Checking</b> <b>for</b> <b>Events</b> <b>on</b> <b>a</b> <b>Stream</b>
       The following example opens a pair of STREAMS devices and then waits for either one to  become  writable.
       This example proceeds as follows:

        1. Sets the <u>timeout</u> parameter to 500 milliseconds.

        2. Opens  the  STREAMS  devices  <b>/dev/dev0</b>  and  <b>/dev/dev1</b>,  and then polls them, specifying POLLOUT and
           POLLWRBAND as the events of interest.

           The STREAMS device names <b>/dev/dev0</b> and <b>/dev/dev1</b> are only examples of  how  STREAMS  devices  can  be
           named; STREAMS naming conventions may vary among systems conforming to the POSIX.1‐2008.

        3. Uses  the  <u>ret</u>  variable to determine whether an event has occurred on either of the two STREAMS. The
           <u>poll</u>() function is given 500 milliseconds to wait for an event to occur (if it has not occurred prior
           to the <u>poll</u>() call).

        4. Checks the returned value of <u>ret</u>.  If a positive value is returned, one of the following can be done:

            a. Priority data can be written to the open STREAM on priority bands greater  than  0,  because  the
               POLLWRBAND event occurred on the open STREAM (<u>fds</u>[0] or <u>fds</u>[1]).

            b. Data  can be written to the open STREAM on priority-band 0, because the POLLOUT event occurred on
               the open STREAM (<u>fds</u>[0] or <u>fds</u>[1]).

        5. If the returned value is not a positive value, permission to write data to the open  STREAM  (on  any
           priority band) is denied.

        6. If  the POLLHUP event occurs on the open STREAM (<u>fds</u>[0] or <u>fds</u>[1]), the device on the open STREAM has
           disconnected.

           #include &lt;stropts.h&gt;
           #include &lt;<a href="file:/usr/include/poll.h">poll.h</a>&gt;
           ...
           struct pollfd fds[2];
           int timeout_msecs = 500;
           int ret;
               int i;

           /* Open STREAMS device. */
           fds[0].fd = open("/dev/dev0", ...);
           fds[1].fd = open("/dev/dev1", ...);
           fds[0].events = POLLOUT | POLLWRBAND;
           fds[1].events = POLLOUT | POLLWRBAND;

           ret = poll(fds, 2, timeout_msecs);

           if (ret &gt; 0) {
               /* An event on one of the fds has occurred. */
               for (i=0; i&lt;2; i++) {
                   if (fds[i].revents &amp; POLLWRBAND) {
                   /* Priority data may be written on device number i. */
           ...
                   }
                   if (fds[i].revents &amp; POLLOUT) {
                   /* Data may be written on device number i. */
           ...
                   }
                   if (fds[i].revents &amp; POLLHUP) {
                   /* A hangup has occurred on device number i. */
           ...
                   }
               }
           }

</pre><h4><b>APPLICATION</b> <b>USAGE</b></h4><pre>
       None.

</pre><h4><b>RATIONALE</b></h4><pre>
       The POLLHUP event does not occur for FIFOs just because the FIFO is not open for writing. It only  occurs
       when  the FIFO is closed by the last writer and persists until some process opens the FIFO for writing or
       until all read-only file descriptors for the FIFO are closed.

</pre><h4><b>FUTURE</b> <b>DIRECTIONS</b></h4><pre>
       None.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>Section</u> <u>2.6</u>, <u>STREAMS</u>, <u>getmsg</u>(), <u>pselect</u>(), <u>putmsg</u>(), <u>read</u>(), <u>write</u>()

       The Base Definitions volume of POSIX.1‐2017, <b>&lt;poll.h&gt;</b>, <b>&lt;stropts.h&gt;</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1-2017, Standard
       for Information  Technology  --  Portable  Operating  System  Interface  (POSIX),  The  Open  Group  Base
       Specifications  Issue  7, 2018 Edition, Copyright (C) 2018 by the Institute of Electrical and Electronics
       Engineers, Inc and The Open Group.  In the event of any discrepancy between this version and the original
       IEEE and The Open Group Standard, the original IEEE and The Open Group Standard is the referee  document.
       The original Standard can be obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any  typographical  or formatting errors that appear in this page are most likely to have been introduced
       during  the  conversion  of  the  source  files  to  man  page  format.  To  report  such   errors,   see
       https://www.kernel.org/doc/man-pages/reporting_bugs.html .

IEEE/The Open Group                                   2017                                          <u><a href="../man3POSIX/POLL.3POSIX.html">POLL</a></u>(3POSIX)
</pre>
 </div>
</div></section>
</div>
</body>
</html>