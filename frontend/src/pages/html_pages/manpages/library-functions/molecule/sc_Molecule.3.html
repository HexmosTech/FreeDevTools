<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sc::Molecule - The Molecule class contains information about molecules.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/libsc-doc">libsc-doc_2.3.1-21_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sc::Molecule - The <b>Molecule</b> class contains information about molecules.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;molecule.h&gt;

       Inherits <b>sc::SavableState</b>.

   <b>Public</b> <b>Member</b> <b>Functions</b>
       <b>Molecule</b> (const <b>Molecule</b> &amp;)
       <b>Molecule</b> (<b>StateIn</b> &amp;)
       <b>Molecule</b> (const <b>Ref</b>&lt; <b>KeyVal</b> &gt; &amp;input)
           The <b>Molecule</b> <b>KeyVal</b> constructor is used to generate a <b>Molecule</b> object from the input.
       <b>Molecule</b> &amp; <b>operator=</b> (const <b>Molecule</b> &amp;)
       void <b>add_atom</b> (int Z, double x, double y, double z, const char *=0, double mass=0.0, int have_charge=0,
           double <b>charge</b>=0.0)
           Add an AtomicCenter to the <b>Molecule</b>.
       virtual void <b>print</b> (std::ostream &amp;=<b>ExEnv::out0</b>()) const
           Print information about the molecule.
       virtual void <b>print_parsedkeyval</b> (std::ostream &amp;=<b>ExEnv::out0</b>(), int print_pg=1, int print_unit=1, int
           number_atoms=1) const
       int <b>natom</b> () const
           Returns the number of atoms in the molcule.
       int <b>Z</b> (int atom) const
       double &amp; <b>r</b> (int atom, int xyz)
       const double &amp; <b>r</b> (int atom, int xyz) const
       double * <b>r</b> (int atom)
       const double * <b>r</b> (int atom) const
       double <b>mass</b> (int atom) const
       const char * <b>label</b> (int atom) const
           Returns the label explicitly assigned to atom.
       int <b>atom_at_position</b> (double *, double tol=0.05) const
           Takes an (x, y, z) postion and finds an atom within the given tolerance distance.
       int <b>atom_label_to_index</b> (const char *<b>label</b>) const
           Returns the index of the atom with the given label.
       double * <b>charges</b> () const
           Returns a double* containing the nuclear charges of the atoms.
       double <b>charge</b> (int iatom) const
           Return the charge of the atom.
       double <b>nuclear_charge</b> () const
           Returns the total nuclear charge.
       void <b>set_point_group</b> (const <b>Ref</b>&lt; <b>PointGroup</b> &gt; &amp;, double tol=1.0e-7)
           Sets the <b>PointGroup</b> of the molecule.
       <b>Ref</b>&lt; <b>PointGroup</b> &gt; <b>point_group</b> () const
           Returns the <b>PointGroup</b> of the molecule.
       <b>Ref</b>&lt; <b>PointGroup</b> &gt; <b>highest_point_group</b> (double tol=1.0e-8) const
           Find this molecules true point group (limited to abelian groups).
       int <b>is_axis</b> (<b>SCVector3</b> &amp;origin, <b>SCVector3</b> &amp;udirection, int order, double tol=1.0e-8) const
           Return 1 if this given axis is a symmetry element for the molecule.
       int <b>is_plane</b> (<b>SCVector3</b> &amp;origin, <b>SCVector3</b> &amp;uperp, double tol=1.0e-8) const
           Return 1 if the given plane is a symmetry element for the molecule.
       int <b>has_inversion</b> (<b>SCVector3</b> &amp;origin, double tol=1.0e-8) const
           Return 1 if the molecule has an inversion center.
       int <b>is_linear</b> (double tolerance=1.0e-5) const
           Returns 1 if the molecule is linear, 0 otherwise.
       int <b>is_planar</b> (double tolerance=1.0e-5) const
           Returns 1 if the molecule is planar, 0 otherwise.
       void <b>is_linear_planar</b> (int &amp;linear, int &amp;planar, double tol=1.0e-5) const
           Sets linear to 1 if the molecular is linear, 0 otherwise.
       <b>SCVector3</b> <b>center_of_mass</b> () const
           Returns a <b>SCVector3</b> containing the cartesian coordinates of the center of mass for the molecule.
       double <b>nuclear_repulsion_energy</b> ()
           Returns the nuclear repulsion energy for the molecule.
       void <b>nuclear_repulsion_1der</b> (int center, double xyz[3])
           <b>Compute</b> the nuclear repulsion energy first derivative with respect to the given center.
       void <b>nuclear_efield</b> (const double *position, double *efield)
           <b>Compute</b> the electric field due to the nuclei at the given point.
       void <b>nuclear_charge_efield</b> (const double *<b>charges</b>, const double *position, double *efield)
           <b>Compute</b> the electric field due to the given charges at the positions of the nuclei at the given
           point.
       void <b>symmetrize</b> (double tol=0.5)
           If the molecule contains only symmetry unique atoms, this function will generate the other, redundant
           atoms.
       void <b>symmetrize</b> (const <b>Ref</b>&lt; <b>PointGroup</b> &gt; &amp;pg, double tol=0.5)
           Set the point group and then symmetrize.
       void <b>cleanup_molecule</b> (double tol=0.1)
           This will try to carefully correct symmetry errors in molecules.
       void <b>translate</b> (const double *r)
       void <b>move_to_com</b> ()
       void <b>transform_to_principal_axes</b> (int trans_frame=1)
       void <b>transform_to_symmetry_frame</b> ()
       void <b>print_pdb</b> (std::ostream &amp;=<b>ExEnv::out0</b>(), char *title=0) const
       void <b>read_pdb</b> (const char *filename)
       void <b>principal_moments_of_inertia</b> (double *evals, double **evecs=0) const
           <b>Compute</b> the principal moments of inertia and, possibly, the principal axes.
       int <b>nunique</b> () const
           Return information about symmetry unique and equivalent atoms.
       int <b>unique</b> (int iuniq) const
           Returns the overall number of the iuniq'th unique atom.
       int <b>nequivalent</b> (int iuniq) const
           Returns the number of atoms equivalent to iuniq.
       int <b>equivalent</b> (int iuniq, int j) const
           Returns the j'th atom equivalent to iuniq.
       int <b>atom_to_unique</b> (int iatom) const
           Converts an atom number to the number of its generating unique atom.
       int <b>atom_to_unique_offset</b> (int iatom) const
           Converts an atom number to the offset of this atom in the list of generated atoms.
       int <b>n_core_electrons</b> ()
           Return the number of core electrons.
       int <b>max_z</b> ()
           Return the maximum atomic number.
       <b>Ref</b>&lt; <b>AtomInfo</b> &gt; <b>atominfo</b> () const
           Return the molecule's <b>AtomInfo</b> object.
       std::string <b>atom_name</b> (int iatom) const
           Returns the element name of the atom.
       std::string <b>atom_symbol</b> (int iatom) const
           Returns the element symbol of the atom.
       void <b>set_include_q</b> (bool iq)
           If include_q is true, then include the 'Q' atoms in the charge and efield routines.
       bool <b>include_q</b> () const
           Returns include_q. See set_include_q.
       void <b>set_include_qq</b> (bool iqq)
           If include_qq is true, include the coupling between pairs of 'Q' atoms when computing nuclear
           repulsion energy and gradients.
       bool <b>include_qq</b> () const
           Returns include_qq. See set_include_qq.
       int <b>n_q_atom</b> () const
           Retrieve the number of 'Q' atoms.
       int <b>q_atom</b> (int i) const
           Retrieve the 'Q' atoms.
       int <b>n_non_q_atom</b> () const
           Retrieve the number of non-'Q' atoms.
       int <b>non_q_atom</b> (int i) const
           Retrieve the of non-'Q' atoms.
       void <b>save_data_state</b> (<b>StateOut</b> &amp;)
           Save the base classes (with save_data_state) and the members in the same order that the <b>StateIn</b> CTOR
           initializes them.

   <b>Protected</b> <b>Member</b> <b>Functions</b>
       void <b>init_symmetry_info</b> (double tol=0.5)
       void <b>clear_symmetry_info</b> ()
       void <b>clear</b> ()
       void <b>throw_if_atom_duplicated</b> (int begin=0, double tol=1e-3)

   <b>Protected</b> <b>Attributes</b>
       int <b>natoms_</b>
       <b>Ref</b>&lt; <b>AtomInfo</b> &gt; <b>atominfo_</b>
       <b>Ref</b>&lt; <b>PointGroup</b> &gt; <b>pg_</b>
       <b>Ref</b>&lt; <b>Units</b> &gt; <b>geometry_units_</b>
       double ** <b>r_</b>
       int * <b>Z_</b>
       double * <b>charges_</b>
       int <b>nuniq_</b>
       int * <b>nequiv_</b>
       int ** <b>equiv_</b>
       int * <b>atom_to_uniq_</b>
       double * <b>mass_</b>
       char ** <b>labels_</b>
       int <b>q_Z_</b>
       bool <b>include_q_</b>
       bool <b>include_qq_</b>
       std::vector&lt; int &gt; <b>q_atoms_</b>
       std::vector&lt; int &gt; <b>non_q_atoms_</b>

   <b>Additional</b> <b>Inherited</b> <b>Members</b>
</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       The <b>Molecule</b> class contains information about molecules.

       It has a <b>KeyVal</b> constructor that can create a new molecule from either a PDB file or from a list of
       Cartesian coordinates.

       The following <b>ParsedKeyVal</b> input reads from the PDB file h2o.pdb:

       molecule&lt;Molecule&gt;: (
          pdb_file = 'h2o.pdb'
        )

       The following input explicitly gives the atom coordinates, using the <b>ParsedKeyVal</b> table notation:

       molecule&lt;Molecule&gt;: (
           unit=angstrom
           { atom_labels atoms           geometry            } = {
                 O1         O   [ 0.000000000 0  0.369372944 ]
                 H1         H   [ 0.783975899 0 -0.184686472 ]
                 H2         H   [-0.783975899 0 -0.184686472 ]
            }
           )
         )

        The default units are Bohr which can be overridden with unit=angstrom. The atom_labels array can be
       omitted. The atoms and geometry arrays are required.

       As a special case, an atom can be given with the symbol Q or the name charge. Such centers are treated as
       point charges and not given basis functions. The values of the charges must be specified with a charge
       vector in the <b>Molecule</b> input. Since the charge vector assign charges to all centers, including atoms, it
       is easiest to place all point charge centers first in the geometry, and then give a charge vector with a
       number of elements equal to the number of point charges. The following example shows a water molecule
       interacting with a point charge having value 0.1:

       molecule&lt;Molecule&gt;: (
           unit=angstrom
           charge = [ 0.1 ]
           { atom_labels atoms           geometry            } = {
                 Q1         Q   [ 0.0         0 10.0         ]
                 O1         O   [ 0.000000000 0  0.369372944 ]
                 H1         H   [ 0.783975899 0 -0.184686472 ]
                 H2         H   [-0.783975899 0 -0.184686472 ]
            }
           )
         )

       This feature is designed for doing QM/MM calculations, so, by default, methods will not include
       interactions between the Q centers when computing the energy or the gradient. To include these
       interactions, set include_qq=1.

       The <b>Molecule</b> class has a <b>PointGroup</b> member object, which also has a <b>KeyVal</b> constructor that is called
       when a <b>Molecule</b> is made. The following example constructs a molecule with $C_{2v}$ symmetry:

       molecule&lt;Molecule&gt;: (
           symmetry=c2v
           unit=angstrom
           { atoms         geometry            } = {
               O   [0.000000000 0  0.369372944 ]
               H   [0.783975899 0 -0.184686472 ]
            }
           )
         )

        Only the symmetry unique atoms need to be specified. Nonunique atoms can be given too, however,
       numerical errors in the geometry specification can result in the generation of extra atoms so be careful.

</pre><h4><b>Constructor</b> <b>&amp;</b> <b>Destructor</b> <b>Documentation</b></h4><pre>
   <b>sc::Molecule::Molecule</b> <b>(const</b> <b>Ref&lt;</b> <b>KeyVal</b> <b>&gt;</b> <b>&amp;</b> <b>input)</b>
       The <b>Molecule</b> <b>KeyVal</b> constructor is used to generate a <b>Molecule</b> object from the input. Several examples
       are given in the <b>Molecule</b> class overview. The full list of keywords that are accepted is below.

       KeywordTypeDefaultDescription

       include_qbooleanfalseSome of the atoms can be specified as Q and given a customizable charge. Such atoms
       are a point charge that do not have basis functions. If this option is true, then the Q atoms are
       included when computing the nuclear charge and the electric field due to the nuclear charge.

       include_qqbooleanfalseSome of the atoms can be specified as Q and given a customizable charge. Such atoms
       are a point charge that do not have basis functions. If this option is true, then the Q atoms are
       included when computing the nuclear repulsion energy and its derivatives.

       atominfo<b>AtomInfo</b>library valuesThis gives information about each atom, such as the symbol, name, and
       various atomic radii.

       symmetrystringC1The Schoenflies symbol of the point group. This is case insensitive. It should be a
       subgroup of D2h . If it is auto, then the appropriate subgroup of D2h  will be found.

       symmetry_tolerancedouble1.0e-4When a molecule has symmetry, some atoms may be related by symmetry
       operations. The distance between given atoms and atoms generated by symmetry operations is compared to
       this threshold to determine if they are the same. If they are the same, then the coordinates are cleaned
       up to make them exactly symmetry equivalent. If the given molecule was produced by a optimization that
       started in C1 symmetry, but produced a roughly symmetric structure and you would like to begin using
       symmetry, then this may need to be increased a bit to properly symmetrize the molecule.

       symmetry_framedouble[3][3][[1 0 0][0 1 0][0 0 1]]The symmetry frame. Ignored for symmetry = auto.

       origindouble[3][0 0 0]The origin of the symmetry frame. Ignored for symmetry = auto.

       redundant_atomsbooleanfalseIf true, do not generate symmetry equivalent atoms; they are already given in
       the input. It should not be necessary to specify this option, since, by default, if a symmetry operation
       duplicates an atom, the generated atom will not be added to the list of atoms. Ignored for symmetry =
       auto.

       pdb_filestringundefinedThis gives the name of a PDB file, from which the nuclear coordinates will be
       read. If this is given, the following options will be ignored.

       unitstringbohrThis gives the name of the units used for the geometry. See the <b>Units</b> class for information
       about the known units. This replaces deprecated keywords that are still recognized: angstrom and
       angstroms. This is ignored if pdb_file is given.

       geometrydouble[][3]noneThis gives the Cartesian coordinates of the molecule. This is ignored if pdb_file
       is given.

       atomsstring[]noneThis gives the Cartesian coordinates of the molecule. This is ignored if pdb_file is
       given.

       ghostboolean[]noneIf true, the atom will be given zero charge. It will still have basis functions,
       however. This is used to estimate basis set superposition error. This is ignored if pdb_file is given.

       chargedouble[]Z for each atomAllows specification of the charge for each atom. This is ignored if
       pdb_file is given.

       atom_labelsstring[]noneThis gives a user defined atom label for each atom. This is ignored if pdb_file is
       given.

       massdouble[]Taken from <b>AtomInfo</b> given by the atominfo keyword. This gives a user defined mass for each
       atom. This is ignored if pdb_file is given.

</pre><h4><b>Member</b> <b>Function</b> <b>Documentation</b></h4><pre>
   <b>int</b> <b>sc::Molecule::atom_at_position</b> <b>(double</b> <b>*,</b> <b>double</b> <b>tol</b> <b>=</b> <b>0.05)</b> <b>const</b>
       Takes an (x, y, z) postion and finds an atom within the given tolerance distance. If no atom is found -1
       is returned.

   <b>int</b> <b>sc::Molecule::atom_label_to_index</b> <b>(const</b> <b>char</b> <b>*</b> <b>label)</b> <b>const</b>
       Returns the index of the atom with the given label. If the label cannot be found -1 is returned.

   <b>int</b> <b>sc::Molecule::atom_to_unique</b> <b>(int</b> <b>iatom)</b> <b>const</b> <b>[inline]</b>
       Converts an atom number to the number of its generating unique atom. The return value is in [0, nunique).

   <b>int</b> <b>sc::Molecule::atom_to_unique_offset</b> <b>(int</b> <b>iatom)</b> <b>const</b>
       Converts an atom number to the offset of this atom in the list of generated atoms. The unique atom itself
       is allows offset 0.

   <b>double*</b> <b>sc::Molecule::charges</b> <b>()</b> <b>const</b>
       Returns a double* containing the nuclear charges of the atoms. The caller is responsible for freeing the
       return value.

   <b>void</b> <b>sc::Molecule::cleanup_molecule</b> <b>(double</b> <b>tol</b> <b>=</b> <b>0.1)</b>
       This will try to carefully correct symmetry errors in molecules. If any atom is out of place by more then
       tol, abort will be called.

   <b>Ref&lt;PointGroup&gt;</b> <b>sc::Molecule::highest_point_group</b> <b>(double</b> <b>tol</b> <b>=</b> <b>1.0e-8)</b> <b>const</b>
       Find this molecules true point group (limited to abelian groups). If the point group of this molecule is
       set to the highest point group, then the origin must first be set to the center of mass.

   <b>int</b> <b>sc::Molecule::is_axis</b> <b>(SCVector3</b> <b>&amp;</b> <b>origin,</b> <b>SCVector3</b> <b>&amp;</b> <b>udirection,</b> <b>int</b> <b>order,</b> <b>double</b> <b>tol</b> <b>=</b> <b>1.0e-8)</b> <b>const</b>
       Return 1 if this given axis is a symmetry element for the molecule. The direction vector must be a unit
       vector.

   <b>void</b> <b>sc::Molecule::is_linear_planar</b> <b>(int</b> <b>&amp;</b> <b>linear,</b> <b>int</b> <b>&amp;</b> <b>planar,</b> <b>double</b> <b>tol</b> <b>=</b> <b>1.0e-5)</b> <b>const</b>
       Sets linear to 1 if the molecular is linear, 0 otherwise. Sets planar to 1 if the molecular is planar, 0
       otherwise.

   <b>int</b> <b>sc::Molecule::is_plane</b> <b>(SCVector3</b> <b>&amp;</b> <b>origin,</b> <b>SCVector3</b> <b>&amp;</b> <b>uperp,</b> <b>double</b> <b>tol</b> <b>=</b> <b>1.0e-8)</b> <b>const</b>
       Return 1 if the given plane is a symmetry element for the molecule. The perpendicular vector must be a
       unit vector.

   <b>const</b> <b>char*</b> <b>sc::Molecule::label</b> <b>(int</b> <b>atom)</b> <b>const</b>
       Returns the label explicitly assigned to atom. If no label has been assigned, then null is returned.

   <b>void</b> <b>sc::Molecule::save_data_state</b> <b>(StateOut</b> <b>&amp;)</b> <b>[virtual]</b>
       Save the base classes (with save_data_state) and the members in the same order that the <b>StateIn</b> CTOR
       initializes them. This must be implemented by the derived class if the class has data.

       Reimplemented from <b>sc::SavableState</b>.

   <b>void</b> <b>sc::Molecule::symmetrize</b> <b>(double</b> <b>tol</b> <b>=</b> <b>0.5)</b>
       If the molecule contains only symmetry unique atoms, this function will generate the other, redundant
       atoms. The redundant atom will only be generated if there is no other atoms within a distance of tol. If
       the is another atom and it is not identical, then abort will be called.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for MPQC from the source code.

Version 2.3.1                                    Sun Oct 4 2020                                  <u>sc::<a href="../man3/Molecule.3.html">Molecule</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>