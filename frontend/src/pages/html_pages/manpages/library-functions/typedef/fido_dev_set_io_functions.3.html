<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fido_dev_set_io_functions,  fido_dev_set_sigmask, fido_dev_set_timeout, fido_dev_set_transport_functions,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libfido2-doc">libfido2-doc_1.15.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fido_dev_set_io_functions,  fido_dev_set_sigmask, fido_dev_set_timeout, fido_dev_set_transport_functions,
       fido_dev_io_handle â€” FIDO2 device I/O interface

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;fido.h&gt;</b>

       typedef void *fido_dev_io_open_t(const char *);
       typedef void  fido_dev_io_close_t(void *);
       typedef int   fido_dev_io_read_t(void *, unsigned char *, size_t, int);
       typedef int   fido_dev_io_write_t(void *, const unsigned char *, size_t);

       typedef struct fido_dev_io {
               fido_dev_io_open_t  *open;
               fido_dev_io_close_t *close;
               fido_dev_io_read_t  *read;
               fido_dev_io_write_t *write;
       } fido_dev_io_t;

       #ifdef _WIN32
       typedef int fido_sigset_t;
       #else
       typedef sigset_t fido_sigset_t;
       #endif

       typedef int   fido_dev_rx_t(struct fido_dev *,
                         uint8_t, unsigned char *, size_t, int);
       typedef int   fido_dev_tx_t(struct fido_dev *,
                         uint8_t, const unsigned char *, size_t);

       typedef struct fido_dev_transport {
               fido_dev_rx_t *rx;
               fido_dev_tx_t *tx;
       } fido_dev_transport_t;

       <u>int</u>
       <b>fido_dev_set_io_functions</b>(<u>fido_dev_t</u> <u>*dev</u>, <u>const</u> <u>fido_dev_io_t</u> <u>*io</u>);

       <u>int</u>
       <b>fido_dev_set_sigmask</b>(<u>fido_dev_t</u> <u>*dev</u>, <u>const</u> <u>fido_sigset_t</u> <u>*sigmask</u>);

       <u>int</u>
       <b>fido_dev_set_timeout</b>(<u>fido_dev_t</u> <u>*dev</u>, <u>int</u> <u>ms</u>);

       <u>int</u>
       <b>fido_dev_set_transport_functions</b>(<u>fido_dev_t</u> <u>*dev</u>, <u>const</u> <u>fido_dev_transport_t</u> <u>*t</u>);

       <u>void</u> <u>*</u>
       <b>fido_dev_io_handle</b>(<u>const</u> <u>fido_dev_t</u> <u>*dev</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>fido_dev_set_io_functions</b>() function sets the I/O handlers used by  <u>libfido2</u>  to  talk  to  <u>dev</u>.   By
       default, these handlers are set to the operating system's native HID or NFC interfaces.  They are defined
       as follows:

       <u>fido_dev_open_t</u>
               Receives  a  <u>const</u> <u>char</u> <u>*</u> holding a path and opens the corresponding device, returning a non-NULL
               opaque pointer on success and NULL on error.

       <u>fido_dev_close_t</u>
               Receives the opaque pointer returned by <u>fido_dev_open_t</u> and closes the device.

       <u>fido_dev_read_t</u>
               Reads a single transmission unit (HID report, APDU) from a device.  The first  parameter  is  the
               opaque  pointer  returned  by  <u>fido_dev_open_t</u>.  The second parameter is the read buffer, and the
               third parameter is the read buffer size.  The fourth parameter is the number of milliseconds  the
               caller  is  willing  to  sleep,  should  the  call  need  to  block.   If  this  value  holds -1,
               <u>fido_dev_read_t</u> may block indefinitely.  On success, the number of bytes read  is  returned.   On
               error, -1 is returned.

       <u>fido_dev_write_t</u>
               Writes  a  single transmission unit (HID report, APDU) to <u>dev</u>.  The first parameter is the opaque
               pointer returned by <u>fido_dev_open_t</u>.  The second parameter is the write  buffer,  and  the  third
               parameter  is  the number of bytes to be written.  A <u>fido_dev_write_t</u> may block.  On success, the
               number of bytes written is returned.  On error, -1 is returned.

       When calling <b>fido_dev_set_io_functions</b>(), the <u>open</u>, <u>close</u>, <u>read</u>, and <u>write</u> fields of <u>io</u> may not be NULL.

       No references to <u>io</u> are held by <b>fido_dev_set_io_functions</b>().

       The <b>fido_dev_set_sigmask</b>() function may be used to specify a non-NULL signal  mask  <u>sigmask</u>  to  be  used
       while  <u>libfido2's</u>  default  I/O  handlers  wait on <u>dev</u>.  On UNIX-like operating systems, <u>fido_sigset_t</u> is
       defined as <u>sigset_t</u>.  On Windows, <u>fido_sigset_t</u> is defined as <u>int</u> and <b>fido_dev_set_sigmask</b>() is a no-op.

       No references to <u>sigmask</u> are held by <b>fido_dev_set_sigmask</b>().

       The <b>fido_dev_set_timeout</b>() function informs <u>libfido2</u> not to block for more  than  <u>ms</u>  milliseconds  while
       communicating  with  <u>dev</u>.   If  a  timeout  occurs,  the corresponding <u>fido_dev_*</u> function will fail with
       FIDO_ERR_RX.  If <u>ms</u> is -1, then <u>libfido2</u> may block indefinitely.  This is the  default  behaviour.   When
       using the Windows Hello backend, <u>ms</u> is used as a guidance and may be overwritten by the platform.

       The  <b>fido_dev_set_transport_functions</b>() function sets the transport functions used by <u>libfido2</u> to talk to
       <u>dev</u>.   While  the  I/O  handlers  are  responsible  for  sending  and  receiving  transmission  units  of
       initialization  and  continuation  packets  already  formatted  by  <u>libfido2</u>,  the transport handlers are
       responsible for sending and receiving the CTAPHID commands and data directly,  as  defined  in  the  FIDO
       Client to Authenticator Protocol (CTAP) standard.  They are defined as follows:

       <u>fido_dev_tx_t</u>
               Receives  a  device,  a CTAPHID command to transmit, a data buffer to transmit, and the length of
               the data buffer.  On success, 0 is returned.  On error, -1 is returned.

       <u>fido_dev_rx_t</u>
               Receives a device, a CTAPHID command whose response the caller expects to receive, a data  buffer
               to  receive  into,  the size of the data buffer determining the maximum length of a response, and
               the maximum number of milliseconds to wait for a response.  On success, the number of bytes  read
               into the data buffer is returned.  On error, -1 is returned.

       When transport functions are specified, <u>libfido2</u> will use them instead of the read and write functions of
       the I/O handlers.  However, the I/O handlers must still be specified to open and close the device.

       The  <b>fido_dev_io_handle</b>()  function  returns  the opaque pointer returned by the open function of the I/O
       handlers.  This is useful mainly for the transport functions, which unlike the I/O  handlers  are  passed
       the <u>fido_dev_t</u> pointer instead of the opaque I/O handle.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       On  success, <b>fido_dev_set_io_functions</b>(), <b>fido_dev_set_transport_functions</b>(), <b>fido_dev_set_sigmask</b>(), and
       <b>fido_dev_set_timeout</b>() return FIDO_OK.  On error, a different  error  code  defined  in  &lt;<u>fido/err.h</u>&gt;  is
       returned.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/fido_dev_info_manifest.3.html">fido_dev_info_manifest</a></u>(3), <u><a href="../man3/fido_dev_open.3.html">fido_dev_open</a></u>(3)

       Client   to  Authenticator  Protocol  (CTAP),  https://fidoalliance.org/specs/fido-v2.1-ps-20210615/fido-
       client-to-authenticator-protocol-v2.1-ps-20210615.html, FIDO  Alliance,  2021-06-15,  Proposed  Standard,
       Version 2.1.

Debian                                            May 25, 2018                      <u><a href="../man3/FIDO_DEV_SET_IO_FUNCTIONS.3.html">FIDO_DEV_SET_IO_FUNCTIONS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>