<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authen::Passphrase::DESCrypt - passphrases using the DES-based Unix crypt()</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libauthen-passphrase-perl">libauthen-passphrase-perl_0.008-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Authen::Passphrase::DESCrypt - passphrases using the DES-based Unix crypt()

</pre><h4><b>SYNOPSIS</b></h4><pre>
               use Authen::Passphrase::DESCrypt;

               $ppr = Authen::Passphrase::DESCrypt-&gt;new(
                               salt_base64 =&gt; "my",
                               hash_base64 =&gt; "TYK.j.88/9s");

               $ppr = Authen::Passphrase::DESCrypt-&gt;new(
                               salt_random =&gt; 12,
                               passphrase =&gt; "passphrase");

               $ppr = Authen::Passphrase::DESCrypt
                       -&gt;from_crypt('myTYK.j.88/9s');

               $ppr = Authen::Passphrase::DESCrypt-&gt;new(
                               fold =&gt; 1,
                               initial =&gt; "xyzzy!!!",
                               nrounds =&gt; 500,
                               salt_base64 =&gt; "quux",
                               hash_base64 =&gt; "QCKcHlgVsRY");

               $fold = $ppr-&gt;fold;
               $initial = $ppr-&gt;initial;
               $initial_base64 = $ppr-&gt;initial_base64;
               $nrounds = $ppr-&gt;nrounds;
               $nrounds_base64 = $ppr-&gt;nrounds_base64_4;
               $salt = $ppr-&gt;salt;
               $salt_base64 = $ppr-&gt;salt_base64_2;
               $salt_base64 = $ppr-&gt;salt_base64_4;
               $hash = $ppr-&gt;hash;
               $hash_base64 = $ppr-&gt;hash_base64;

               if($ppr-&gt;match($passphrase)) { ...

               $passwd = $ppr-&gt;as_crypt;
               $userPassword = $ppr-&gt;as_rfc2307;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       An object of this class encapsulates a passphrase hashed using some form of the DES-based Unix <b>crypt()</b>
       hash function.  This is a subclass of Authen::Passphrase, and this document assumes that the reader is
       familiar with the documentation for that class.

       The <b>crypt()</b> function in a modern Unix actually supports several different passphrase schemes.  That is
       not what this class is about.  This class is concerned only with one family of schemes, variants of the
       DES-based scheme that <b>crypt()</b> originally implemented, which confusingly is usually referred to merely as
       "<b>crypt()</b>".  To handle the whole range of passphrase schemes supported by the modern <b>crypt()</b>, see the
       from_crypt constructor and the as_crypt method in Authen::Passphrase.

       <u>Warning:</u> this password scheme is weak by modern standards, and in any case does not support a large
       password space.  Cracking <b>crypt()</b>ed passwords has been a routine activity since the early 1990s.  This
       scheme is supported for compatibility reasons only, and should not be used except when compatibility is
       required.  Do not use this in the design of any new system or for new passwords in any system that
       supports better passphrase schemes.

   <b>The</b> <b>traditional</b> <b>DES-based</b> <b>Unix</b> <b>crypt()</b> <b>password</b> <b>scheme</b>
       The traditional Unix <b>crypt()</b> password scheme is based on the DES block encryption algorithm.  Using the
       password as a 56-bit key, it passes a 64-bit data block, initialised to zero, through the encryption
       function 25 times, and the hash is the 64-bit output of this process.  A 12-bit salt is used to tweak the
       encryption algorithm.

       The 56-bit key is extracted from the password in a very poor way.  Only the first eight bytes of the
       password are used, and any remainder is ignored.  This makes it impossible to use a passphrase, rather
       than a password, hence the terminology in this section.  Of the eight bytes used, the top bit is also
       ignored; this function hails from the days of pure ASCII.

       A password hash of this scheme is conventionally represented in ASCII as a 13-character string using a
       base 64 encoding.  The base 64 digits are "<b>.</b>", "<b>/</b>", "<b>0</b>" to "<b>9</b>", "<b>A</b>" to "<b>Z</b>", "<b>a</b>" to "<b>z</b>" (in ASCII order).
       The first two characters give the 12-bit salt.  The remaining eleven characters give the 64-bit hash.
       Because the base 64 encoding can represent 66 bits in eleven digits, more than the 64 required, the last
       character of the string can only take sixteen of the base 64 digit values.

   <b>Variant</b> <b>DES-based</b> <b>Unix</b> <b>crypt()</b> <b>passphrase</b> <b>schemes</b>
       To make password cracking more difficult, historically some Unix sites modified the <b>crypt()</b> function to
       be incompatible with the standard one.  This was easily achieved by initialising the data block to
       something other than the standard all-bits-zero.  Another variation used was to increase the number of
       encryption rounds, which makes cracking take longer in addition to being non-standard.  Password hashes
       on such a system looked normal but were not interoperable with standard <b>crypt()</b> implementations.  To
       interpret them properly it is necessary to know the modified parameters.

       BSDi standardised an extended DES-based scheme.  The salt is extended to 24 bits, and the number of
       encryption rounds is variable.  Passphrases longer than 8 characters are handled by an additional step
       that folds (hashes) them down to 8 characters, rather than just throwing away the characters after the
       eighth.  Passphrase hashes in this scheme are conventionally represented in ASCII as a "<b>_</b>" followed by 19
       characters of base 64.  The first four base 64 digits give the number of encryption rounds, the next four
       give the salt, and the remaining eleven give the hash.

</pre><h4><b>CONSTRUCTORS</b></h4><pre>
       Authen::Passphrase::DESCrypt-&gt;new(ATTR =&gt; VALUE, ...)
           Generates  a new passphrase recogniser object using the generalised DES-based <b>crypt()</b> algorithm.  The
           following attributes may be given:

           <b>fold</b>
               Truth value indicating whether the BSDi  passphrase  folding  scheme  should  be  used  for  long
               passphrases.  Default false, for compatibility with the original DES-based scheme.

           <b>initial</b>
               The  initial  data  block to encrypt, as a string of exactly eight bytes.  Default all bits zero,
               for compatibility with the original DES-based scheme.

           <b>initial_base64</b>
               The initial data block to encrypt, as a string of eleven base 64 digits.

           <b>nrounds</b>
               The number of encryption rounds to use, as a Perl integer.  Default 25,  for  compatibility  with
               the original DES-based scheme.

           <b>nrounds_base64</b>
               The number of encryption rounds to use, as a string of four base 64 digits.

           <b>salt</b>
               The salt, as an integer in the range [0, 16777216).

           <b>salt_base64</b>
               The salt, as a string of two or four base 64 digits.

           <b>salt_random</b>
               Causes  salt  to  be generated randomly.  The value given for this attribute must be either 12 or
               24, giving the number of bits of salt to generate.  The source of randomness may be controlled by
               the facility described in Data::Entropy.

           <b>hash</b>
               The hash (output of encryption), as a string of exactly eight bytes.

           <b>hash_base64</b>
               The hash, as a string of eleven base 64 digits.

           <b>passphrase</b>
               A passphrase that will be accepted.

           The salt must be given, and either the hash or the passphrase.  The other parameters default to those
           used in the original DES-based <b>crypt()</b>.

       Authen::Passphrase::DESCrypt-&gt;from_crypt(PASSWD)
           Generates a new passphrase recogniser object using the DES-based  <b>crypt()</b>  algorithm,  from  a  crypt
           string.  Two forms of crypt string are supported.

           The  first  form of crypt string must consist of 13 base 64 digits.  The first two give the salt, and
           the next eleven give the hash.  Long passphrases are not folded, the initial block is all bits  zero,
           and 25 encryption rounds are performed.

           The second form of crypt string must consist of an "<b>_</b>" followed by 19 base 64 digits.  The first four
           give the number of encryption rounds, the next four give the salt, and the next eleven give the hash.
           Long passphrases are folded, and the initial block is all bits zero.

       Authen::Passphrase::DESCrypt-&gt;from_rfc2307(USERPASSWORD)
           Generates  a new passphrase recogniser object using the DES-based <b>crypt()</b> algorithm, from an RFC 2307
           string.  The string must consist of "<b>{CRYPT}</b>" (case insensitive)  followed  by  an  acceptable  crypt
           string.

</pre><h4><b>METHODS</b></h4><pre>
       $ppr-&gt;fold
           Returns a truth value indicating whether passphrase folding is used.

       $ppr-&gt;initial
           Returns the initial block, as a string of eight bytes.

       $ppr-&gt;initial_base64
           Returns the initial block, as a string of eleven base 64 digits.

       $ppr-&gt;nrounds
           Returns the number of encryption rounds, as a Perl integer.

       $ppr-&gt;nrounds_base64_4
           Returns the number of encryption rounds, as a string of four base 64 digits.

       $ppr-&gt;salt
           Returns the salt, as a Perl integer.

       $ppr-&gt;salt_base64_2
           Returns the salt, as a string of two base 64 digits.  "die"s if it doesn't fit into two digits.

       $ppr-&gt;salt_base64_4
           Returns the salt, as a string of four base 64 digits.

       $ppr-&gt;hash
           Returns the hash value, as a string of eight bytes.

       $ppr-&gt;hash_base64
           Returns the hash value, as a string of eleven base 64 digits.

       $ppr-&gt;match(PASSPHRASE)
       $ppr-&gt;as_crypt
       $ppr-&gt;as_rfc2307
           These methods are part of the standard Authen::Passphrase interface.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Authen::Passphrase, Crypt::UnixCrypt_XS

</pre><h4><b>AUTHOR</b></h4><pre>
       Andrew Main (Zefram) &lt;<a href="mailto:zefram@fysh.org">zefram@fysh.org</a>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2006, 2007, 2009, 2010, 2012 Andrew Main (Zefram) &lt;<a href="mailto:zefram@fysh.org">zefram@fysh.org</a>&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       This  module  is  free  software;  you  can redistribute it and/or modify it under the same terms as Perl
       itself.

perl v5.34.0                                       2022-06-08                  <u>Authen::Passphrase::<a href="../man3pm/DESCrypt.3pm.html">DESCrypt</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>