<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>return - Return from a procedure, or set return code of a script</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl9.0-doc">tcl9.0-doc_9.0.1+dfsg-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       return - Return from a procedure, or set return code of a script

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>return</b> ?<u>result</u>?
       <b>return</b> ?<b>-code</b> <u>code</u>? ?<u>result</u>?
       <b>return</b> ?<u>option</u> <u>value</u> ...? ?<u>result</u>?
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       In  its  simplest  usage,  the  <b>return</b>  command  is  used  without  options in the body of a procedure to
       immediately return control to the caller of the procedure.  If a <u>result</u> argument is provided,  its  value
       becomes  the result of the procedure passed back to the caller.  If <u>result</u> is not specified then an empty
       string will be returned to the caller as the result of the procedure.

       The <b>return</b> command serves a similar function within  script  files  that  are  evaluated  by  the  <b>source</b>
       command.   When  <b>source</b> evaluates the contents of a file as a script, an invocation of the <b>return</b> command
       will cause script evaluation to immediately cease, and the value <u>result</u> (or  an  empty  string)  will  be
       returned as the result of the <b>source</b> command.

</pre><h4><b>EXCEPTIONAL</b> <b>RETURN</b> <b>CODES</b></h4><pre>
       In  addition  to  the  result  of  a  procedure, the return code of a procedure may also be set by <b>return</b>
       through use of the <b>-code</b> option.  In the usual case where the <b>-code</b> option is not specified the procedure
       will return normally.  However, the <b>-code</b> option may be used to generate an exceptional return  from  the
       procedure.  <u>Code</u> may have any of the following values:

       <b>ok</b> (or <b>0</b>)    Normal  return:   same  as  if the option is omitted.  The return code of the procedure is 0
                    (<b>TCL_OK</b>).

       <b>error</b> (or <b>1</b>) Error return: the return code of the procedure is  1  (<b>TCL_ERROR</b>).   The  procedure  command
                    behaves  in  its  calling  context  as  if  it were the command <b>error</b> <u>result</u>.  See below for
                    additional options.

       <b>return</b> (or <b>2</b>)
                    The return code of the procedure is 2 (<b>TCL_RETURN</b>).  The procedure command  behaves  in  its
                    calling context as if it were the command <b>return</b> (with no arguments).

       <b>break</b> (or <b>3</b>) The  return  code  of  the procedure is 3 (<b>TCL_BREAK</b>).  The procedure command behaves in its
                    calling context as if it were the command <b>break</b>.

       <b>continue</b> (or <b>4</b>)
                    The return code of the procedure is 4 (<b>TCL_CONTINUE</b>).  The procedure command behaves in  its
                    calling context as if it were the command <b>continue</b>.

       <u>value</u>        <u>Value</u> must be an integer;  it will be returned as the return code for the current procedure.
                    Applications  and  packages  should use values in the range 5 to 1073741823 (0x3fffffff) for
                    their own purposes. Values outside this range are reserved for use by Tcl.

       When a procedure wants to signal that it has received invalid arguments  from  its  caller,  it  may  use
       <b>return</b>  <b>-code</b>  <b>error</b>  with  <u>result</u>  set to a suitable error message.  Otherwise usage of the <b>return</b> <b>-code</b>
       option is mostly limited to procedures that implement a new control structure.

       The <b>return</b> <b>-code</b> command acts similarly within script files that are evaluated  by  the  <b>source</b>  command.
       During  the evaluation of the contents of a file as a script by <b>source</b>, an invocation of the <b>return</b> <b>-code</b>
       <u>code</u> command will cause the return code of <b>source</b> to be <u>code</u>.

</pre><h4><b>RETURN</b> <b>OPTIONS</b></h4><pre>
       In addition to a result and a return code, evaluation of a command in Tcl also produces a  dictionary  of
       return  options.  In general usage, all <u>option</u> <u>value</u> pairs given as arguments to <b>return</b> become entries in
       the return options dictionary, and any values at all are acceptable except as  noted  below.   The  <b>catch</b>
       command  may  be  used  to  capture all of this information — the return code, the result, and the return
       options dictionary — that arise from evaluation of a script.

       As documented above, the <b>-code</b> entry in the return options dictionary receives special treatment by  Tcl.
       There are other return options also recognized and treated specially by Tcl.  They are:

       <b>-errorcode</b> <u>list</u>
              The  <b>-errorcode</b>  option  receives  special  treatment  only  when the value of the <b>-code</b> option is
              <b>TCL_ERROR</b>.  Then the <u>list</u> value is meant to be additional information about the  error,  presented
              as  a  Tcl list for further processing by programs.  If no <b>-errorcode</b> option is provided to <b>return</b>
              when the <b>-code</b> <b>error</b> option is provided, Tcl will set the value of the  <b>-errorcode</b>  entry  in  the
              return options dictionary to the default value of <b>NONE</b>.  The <b>-errorcode</b> return option will also be
              stored in the global variable <b>errorCode</b>.

       <b>-errorinfo</b> <u>info</u>
              The  <b>-errorinfo</b>  option  receives  special  treatment  only  when the value of the <b>-code</b> option is
              <b>TCL_ERROR</b>.  Then <u>info</u> is the initial stack trace, meant to provide to a  human  reader  additional
              information about the context in which the error occurred.  The stack trace will also be stored in
              the global variable <b>errorInfo</b>.  If no <b>-errorinfo</b> option is provided to <b>return</b> when the <b>-code</b> <b>error</b>
              option  is  provided,  Tcl  will  provide  its  own  initial  stack  trace  value in the entry for
              <b>-errorinfo</b>.  Tcl's initial stack trace will include only the call  to  the  procedure,  and  stack
              unwinding  will  append  information  about  higher stack levels, but there will be no information
              about the context of the error within the procedure.  Typically the <u>info</u> value  is  supplied  from
              the  value of <b>-errorinfo</b> in a return options dictionary captured by the <b>catch</b> command (or from the
              copy of that information stored in the global variable <b>errorInfo</b>).

       <b>-errorstack</b> <u>list</u>
              The <b>-errorstack</b> option receives special treatment only when the  value  of  the  <b>-code</b>  option  is
              <b>TCL_ERROR</b>.   Then <u>list</u> is the initial error stack, recording actual argument values passed to each
              proc level.  The error stack will also be reachable through <b>info</b> <b>errorstack</b>.   If  no  <b>-errorstack</b>
              option  is  provided  to  <b>return</b> when the <b>-code</b> <b>error</b> option is provided, Tcl will provide its own
              initial error stack in the entry for <b>-errorstack</b>.  Tcl's initial error stack will include only the
              call to the procedure, and stack unwinding will append information about higher stack levels,  but
              there  will  be no information about the context of the error within the procedure.  Typically the
              <u>list</u> value is supplied from the value of <b>-errorstack</b> in a return options  dictionary  captured  by
              the <b>catch</b> command (or from the copy of that information from <b>info</b> <b>errorstack</b>).

       <b>-level</b> <u>level</u>
              The  <b>-level</b>  and  <b>-code</b>  options work together to set the return code to be returned by one of the
              commands currently being evaluated.  The <u>level</u> value must be a non-negative integer representing a
              number of levels on the call stack.  It defines the number of levels up the  stack  at  which  the
              return  code  of  a  command  currently  being  evaluated  should be <u>code</u>.  If no <b>-level</b> option is
              provided, the default value of <u>level</u> is 1, so that <b>return</b> sets the return code  that  the  current
              procedure  returns to its caller, 1 level up the call stack.  The mechanism by which these options
              work is described in more detail below.

       <b>-options</b> <u>options</u>
              The value <u>options</u> must be a valid dictionary.  The entries  of  that  dictionary  are  treated  as
              additional <u>option</u> <u>value</u> pairs for the <b>return</b> command.

</pre><h4><b>RETURN</b> <b>CODE</b> <b>HANDLING</b> <b>MECHANISMS</b></h4><pre>
       Return  codes  are  used in Tcl to control program flow.  A Tcl script is a sequence of Tcl commands.  So
       long as each command evaluation returns a return code of <b>TCL_OK</b>, evaluation will  continue  to  the  next
       command  in the script.  Any exceptional return code (non-<b>TCL_OK</b>) returned by a command evaluation causes
       the flow on to the next command to be interrupted.  Script evaluation ceases, and the exceptional  return
       code  from  the  command becomes the return code of the full script evaluation.  This is the mechanism by
       which errors during script evaluation cause an interruption and unwinding of the call stack.  It is  also
       the  mechanism  by  which  commands like <b>break</b>, <b>continue</b>, and <b>return</b> cause script evaluation to terminate
       without evaluating all commands in sequence.

       Some of Tcl's built-in commands evaluate scripts as part of their functioning.  These commands  can  make
       use  of exceptional return codes to enable special features.  For example, the built-in Tcl commands that
       provide loops — such as <b>while</b>, <b>for</b>, and <b>foreach</b> — evaluate a script that is the body  of  the  loop.   If
       evaluation  of  the  loop body returns the return code of <b>TCL_BREAK</b> or <b>TCL_CONTINUE</b>, the loop command can
       react in such a way as to give the <b>break</b> and <b>continue</b> commands their documented interpretation in loops.

       Procedure invocation also involves evaluation  of  a  script,  the  body  of  the  procedure.   Procedure
       invocation  provides  special  treatment  when  evaluation  of the procedure body returns the return code
       <b>TCL_RETURN</b>.  In that circumstance, the <b>-level</b> entry in the return options dictionary is decremented.   If
       after  decrementing,  the  value  of the <b>-level</b> entry is 0, then the value of the <b>-code</b> entry becomes the
       return code of the procedure.  If after decrementing, the value of the <b>-level</b> entry is greater than zero,
       then the return code of the procedure is <b>TCL_RETURN</b>.  If the procedure  invocation  occurred  during  the
       evaluation  of  the  body  of  another  procedure,  the  process  will  repeat  itself up the call stack,
       decrementing the value of the <b>-level</b> entry at each level, so that the <u>code</u> will be the return code of the
       current command <u>level</u> levels up the call stack.  The <b>source</b> command performs the  same  handling  of  the
       <b>TCL_RETURN</b>  return  code,  which  explains  the similarity of <b>return</b> invocation during a <b>source</b> to <b>return</b>
       invocation within a procedure.

       The return code of the <b>return</b> command itself triggers this special handling by procedure invocation.   If
       <b>return</b>  is  provided  the  option <b>-level</b> <b>0</b>, then the return code of the <b>return</b> command itself will be the
       value <u>code</u> of the <b>-code</b> option (or <b>TCL_OK</b> by default).  Any other value for the <b>-level</b> option  (including
       the  default  value  of  1)  will  cause  the  return code of the <b>return</b> command itself to be <b>TCL_RETURN</b>,
       triggering a return from the enclosing procedure.

</pre><h4><b>EXAMPLES</b></h4><pre>
       First, a simple example of using <b>return</b> to return from a procedure, interrupting the procedure body.

              proc printOneLine {} {
                  puts "line 1"    ;# This line will be printed.
                  <b>return</b>
                  puts "line 2"    ;# This line will not be printed.
              }

       Next, an example of using <b>return</b> to set the value returned by the procedure.

              proc returnX {} {<b>return</b> X}
              puts [returnX]    ;# prints "X"

       Next, a more complete example, using <b>return</b> <b>-code</b> <b>error</b> to report invalid arguments.

              proc factorial {n} {
                  if {![string is integer $n] || ($n &lt; 0)} {
                      <b>return</b> -code error \
                              "expected non-negative integer,\
                              but got \"$n\""
                  }
                  if {$n &lt; 2} {
                      <b>return</b> 1
                  }
                  set m [expr {$n - 1}]
                  set code [catch {factorial $m} factor]
                  if {$code != 0} {
                      <b>return</b> -code $code $factor
                  }
                  set product [expr {$n * $factor}]
                  if {$product &lt; 0} {
                      <b>return</b> -code error \
                              "overflow computing factorial of $n"
                  }
                  <b>return</b> $product
              }

       Next, a procedure replacement for <b>break</b>.

              proc myBreak {} {
                  <b>return</b> -code break
              }

       With the <b>-level</b> <b>0</b> option, <b>return</b> itself can serve as a replacement for <b>break</b>, with  the  help  of  <b>interp</b>
       <b>alias</b>.

              interp alias {} Break {} <b>return</b> -level 0 -code break

       An example of using <b>catch</b> and <b>return</b> <b>-options</b> to re-raise a caught error:

              proc doSomething {} {
                  set resource [allocate]
                  catch {
                      # Long script of operations
                      # that might raise an error
                  } result options
                  deallocate $resource
                  <b>return</b> -options $options $result
              }

       Finally  an  example  of  advanced use of the <b>return</b> options to create a procedure replacement for <b>return</b>
       itself:

              proc myReturn {args} {
                  set result ""
                  if {[llength $args] % 2} {
                      set result [lindex $args end]
                      set args [lrange $args 0 end-1]
                  }
                  set options [dict merge {-level 1} $args]
                  dict incr options -level
                  <b>return</b> -options $options $result
              }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/break.3tcl.html">break</a>(3tcl), <a href="../man3tcl/catch.3tcl.html">catch</a>(3tcl),  <a href="../man3tcl/continue.3tcl.html">continue</a>(3tcl),  <a href="../man3tcl/dict.3tcl.html">dict</a>(3tcl),  <a href="../man3tcl/error.3tcl.html">error</a>(3tcl),  <a href="../man3tcl/errorCode.3tcl.html">errorCode</a>(3tcl),  <a href="../man3tcl/errorInfo.3tcl.html">errorInfo</a>(3tcl),
       <a href="../man3tcl/proc.3tcl.html">proc</a>(3tcl), <a href="../man3tcl/source.3tcl.html">source</a>(3tcl), <a href="../man3tcl/throw.3tcl.html">throw</a>(3tcl), <a href="../man3tcl/try.3tcl.html">try</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       break, catch, continue, error, exception, procedure, result, return

Tcl                                                    8.5                                          <u><a href="../man3tcl/return.3tcl.html">return</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>