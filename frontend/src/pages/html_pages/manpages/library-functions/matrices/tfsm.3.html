<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tfsm - tfsm: triangular-matrix solve, RFP format</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/liblapack-doc">liblapack-doc_3.12.1-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tfsm - tfsm: triangular-matrix solve, RFP format

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Functions</b>
       subroutine <b>ctfsm</b> (transr, side, uplo, trans, diag, m, n, alpha, a, b, ldb)
           <b>CTFSM</b> solves a matrix equation (one operand is a triangular matrix in RFP format).
       subroutine <b>dtfsm</b> (transr, side, uplo, trans, diag, m, n, alpha, a, b, ldb)
           <b>DTFSM</b> solves a matrix equation (one operand is a triangular matrix in RFP format).
       subroutine <b>stfsm</b> (transr, side, uplo, trans, diag, m, n, alpha, a, b, ldb)
           <b>STFSM</b> solves a matrix equation (one operand is a triangular matrix in RFP format).
       subroutine <b>ztfsm</b> (transr, side, uplo, trans, diag, m, n, alpha, a, b, ldb)
           <b>ZTFSM</b> solves a matrix equation (one operand is a triangular matrix in RFP format).

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>subroutine</b> <b>ctfsm</b> <b>(character</b> <b>transr,</b> <b>character</b> <b>side,</b> <b>character</b> <b>uplo,</b> <b>character</b> <b>trans,</b> <b>character</b> <b>diag,</b> <b>integer</b>
       <b>m,</b> <b>integer</b> <b>n,</b> <b>complex</b> <b>alpha,</b> <b>complex,</b> <b>dimension(</b> <b>0:</b> <b>*</b> <b>)</b> <b>a,</b> <b>complex,</b> <b>dimension(</b> <b>0:</b> <b>ldb-1,</b> <b>0:</b> <b>*</b> <b>)</b> <b>b,</b>
       <b>integer</b> <b>ldb)</b>
       <b>CTFSM</b> solves a matrix equation (one operand is a triangular matrix in RFP format).

       <b>Purpose:</b>

            Level 3 BLAS like routine for A in RFP Format.

            CTFSM solves the matrix equation

               op( A )*X = alpha*B  or  X*op( A ) = alpha*B

            where alpha is a scalar, X and B are m by n matrices, A is a unit, or
            non-unit,  upper or lower triangular matrix  and  op( A )  is one  of

               op( A ) = A   or   op( A ) = A**H.

            A is in Rectangular Full Packed (RFP) Format.

            The matrix X is overwritten on B.

       <b>Parameters</b>
           <u>TRANSR</u>

                     TRANSR is CHARACTER*1
                     = 'N':  The Normal Form of RFP A is stored;
                     = 'C':  The Conjugate-transpose Form of RFP A is stored.

           <u>SIDE</u>

                     SIDE is CHARACTER*1
                      On entry, SIDE specifies whether op( A ) appears on the left
                      or right of X as follows:

                         SIDE = 'L' or 'l'   op( A )*X = alpha*B.

                         SIDE = 'R' or 'r'   X*op( A ) = alpha*B.

                      Unchanged on exit.

           <u>UPLO</u>

                     UPLO is CHARACTER*1
                      On entry, UPLO specifies whether the RFP matrix A came from
                      an upper or lower triangular matrix as follows:
                      UPLO = 'U' or 'u' RFP A came from an upper triangular matrix
                      UPLO = 'L' or 'l' RFP A came from a  lower triangular matrix

                      Unchanged on exit.

           <u>TRANS</u>

                     TRANS is CHARACTER*1
                      On entry, TRANS  specifies the form of op( A ) to be used
                      in the matrix multiplication as follows:

                         TRANS  = 'N' or 'n'   op( A ) = A.

                         TRANS  = 'C' or 'c'   op( A ) = conjg( A' ).

                      Unchanged on exit.

           <u>DIAG</u>

                     DIAG is CHARACTER*1
                      On entry, DIAG specifies whether or not RFP A is unit
                      triangular as follows:

                         DIAG = 'U' or 'u'   A is assumed to be unit triangular.

                         DIAG = 'N' or 'n'   A is not assumed to be unit
                                             triangular.

                      Unchanged on exit.

           <u>M</u>

                     M is INTEGER
                      On entry, M specifies the number of rows of B. M must be at
                      least zero.
                      Unchanged on exit.

           <u>N</u>

                     N is INTEGER
                      On entry, N specifies the number of columns of B.  N must be
                      at least zero.
                      Unchanged on exit.

           <u>ALPHA</u>

                     ALPHA is COMPLEX
                      On entry,  ALPHA specifies the scalar  alpha. When  alpha is
                      zero then  A is not referenced and  B need not be set before
                      entry.
                      Unchanged on exit.

           <u>A</u>

                     A is COMPLEX array, dimension (NT)
                      NT = N*(N+1)/2 if SIDE='R' and NT = M*(M+1)/2 otherwise.
                      On entry, the matrix A in RFP Format.
                      RFP Format is described by TRANSR, UPLO and N as follows:
                      If TRANSR='N' then RFP A is (0:N,0:K-1) when N is even;
                      K=N/2. RFP A is (0:N-1,0:K) when N is odd; K=N/2. If
                      TRANSR = 'C' then RFP is the Conjugate-transpose of RFP A as
                      defined when TRANSR = 'N'. The contents of RFP A are defined
                      by UPLO as follows: If UPLO = 'U' the RFP A contains the NT
                      elements of upper packed A either in normal or
                      conjugate-transpose Format. If UPLO = 'L' the RFP A contains
                      the NT elements of lower packed A either in normal or
                      conjugate-transpose Format. The LDA of RFP A is (N+1)/2 when
                      TRANSR = 'C'. When TRANSR is 'N' the LDA is N+1 when N is
                      even and is N when is odd.
                      See the Note below for more details. Unchanged on exit.

           <u>B</u>

                     B is COMPLEX array, dimension (LDB,N)
                      Before entry,  the leading  m by n part of the array  B must
                      contain  the  right-hand  side  matrix  B,  and  on exit  is
                      overwritten by the solution matrix  X.

           <u>LDB</u>

                     LDB is INTEGER
                      On entry, LDB specifies the first dimension of B as declared
                      in  the  calling  (sub)  program.   LDB  must  be  at  least
                      max( 1, m ).
                      Unchanged on exit.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

             We first consider Standard Packed Format when N is even.
             We give an example where N = 6.

                 AP is Upper             AP is Lower

              00 01 02 03 04 05       00
                 11 12 13 14 15       10 11
                    22 23 24 25       20 21 22
                       33 34 35       30 31 32 33
                          44 45       40 41 42 43 44
                             55       50 51 52 53 54 55

             Let TRANSR = 'N'. RFP holds AP as follows:
             For UPLO = 'U' the upper trapezoid A(0:5,0:2) consists of the last
             three columns of AP upper. The lower triangle A(4:6,0:2) consists of
             conjugate-transpose of the first three columns of AP upper.
             For UPLO = 'L' the lower trapezoid A(1:6,0:2) consists of the first
             three columns of AP lower. The upper triangle A(0:2,0:2) consists of
             conjugate-transpose of the last three columns of AP lower.
             To denote conjugate we place -- above the element. This covers the
             case N even and TRANSR = 'N'.

                    RFP A                   RFP A

                                           -- -- --
                   03 04 05                33 43 53
                                              -- --
                   13 14 15                00 44 54
                                                 --
                   23 24 25                10 11 55

                   33 34 35                20 21 22
                   --
                   00 44 45                30 31 32
                   -- --
                   01 11 55                40 41 42
                   -- -- --
                   02 12 22                50 51 52

             Now let TRANSR = 'C'. RFP A in both UPLO cases is just the conjugate-
             transpose of RFP A above. One therefore gets:

                      RFP A                   RFP A

                -- -- -- --                -- -- -- -- -- --
                03 13 23 33 00 01 02    33 00 10 20 30 40 50
                -- -- -- -- --                -- -- -- -- --
                04 14 24 34 44 11 12    43 44 11 21 31 41 51
                -- -- -- -- -- --                -- -- -- --
                05 15 25 35 45 55 22    53 54 55 22 32 42 52

             We next  consider Standard Packed Format when N is odd.
             We give an example where N = 5.

                AP is Upper                 AP is Lower

              00 01 02 03 04              00
                 11 12 13 14              10 11
                    22 23 24              20 21 22
                       33 34              30 31 32 33
                          44              40 41 42 43 44

             Let TRANSR = 'N'. RFP holds AP as follows:
             For UPLO = 'U' the upper trapezoid A(0:4,0:2) consists of the last
             three columns of AP upper. The lower triangle A(3:4,0:1) consists of
             conjugate-transpose of the first two   columns of AP upper.
             For UPLO = 'L' the lower trapezoid A(0:4,0:2) consists of the first
             three columns of AP lower. The upper triangle A(0:1,1:2) consists of
             conjugate-transpose of the last two   columns of AP lower.
             To denote conjugate we place -- above the element. This covers the
             case N odd  and TRANSR = 'N'.

                    RFP A                   RFP A

                                              -- --
                   02 03 04                00 33 43
                                                 --
                   12 13 14                10 11 44

                   22 23 24                20 21 22
                   --
                   00 33 34                30 31 32
                   -- --
                   01 11 44                40 41 42

             Now let TRANSR = 'C'. RFP A in both UPLO cases is just the conjugate-
             transpose of RFP A above. One therefore gets:

                      RFP A                   RFP A

                -- -- --                   -- -- -- -- -- --
                02 12 22 00 01             00 10 20 30 40 50
                -- -- -- --                   -- -- -- -- --
                03 13 23 33 11             33 11 21 31 41 51
                -- -- -- -- --                   -- -- -- --
                04 14 24 34 44             43 44 22 32 42 52

   <b>subroutine</b> <b>dtfsm</b> <b>(character</b> <b>transr,</b> <b>character</b> <b>side,</b> <b>character</b> <b>uplo,</b> <b>character</b> <b>trans,</b> <b>character</b> <b>diag,</b> <b>integer</b>
       <b>m,</b> <b>integer</b> <b>n,</b> <b>double</b> <b>precision</b> <b>alpha,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>0:</b> <b>*</b> <b>)</b> <b>a,</b> <b>double</b> <b>precision,</b> <b>dimension(</b>
       <b>0:</b> <b>ldb-1,</b> <b>0:</b> <b>*</b> <b>)</b> <b>b,</b> <b>integer</b> <b>ldb)</b>
       <b>DTFSM</b> solves a matrix equation (one operand is a triangular matrix in RFP format).

       <b>Purpose:</b>

            Level 3 BLAS like routine for A in RFP Format.

            DTFSM  solves the matrix equation

               op( A )*X = alpha*B  or  X*op( A ) = alpha*B

            where alpha is a scalar, X and B are m by n matrices, A is a unit, or
            non-unit,  upper or lower triangular matrix  and  op( A )  is one  of

               op( A ) = A   or   op( A ) = A**T.

            A is in Rectangular Full Packed (RFP) Format.

            The matrix X is overwritten on B.

       <b>Parameters</b>
           <u>TRANSR</u>

                     TRANSR is CHARACTER*1
                     = 'N':  The Normal Form of RFP A is stored;
                     = 'T':  The Transpose Form of RFP A is stored.

           <u>SIDE</u>

                     SIDE is CHARACTER*1
                      On entry, SIDE specifies whether op( A ) appears on the left
                      or right of X as follows:

                         SIDE = 'L' or 'l'   op( A )*X = alpha*B.

                         SIDE = 'R' or 'r'   X*op( A ) = alpha*B.

                      Unchanged on exit.

           <u>UPLO</u>

                     UPLO is CHARACTER*1
                      On entry, UPLO specifies whether the RFP matrix A came from
                      an upper or lower triangular matrix as follows:
                      UPLO = 'U' or 'u' RFP A came from an upper triangular matrix
                      UPLO = 'L' or 'l' RFP A came from a  lower triangular matrix

                      Unchanged on exit.

           <u>TRANS</u>

                     TRANS is CHARACTER*1
                      On entry, TRANS  specifies the form of op( A ) to be used
                      in the matrix multiplication as follows:

                         TRANS  = 'N' or 'n'   op( A ) = A.

                         TRANS  = 'T' or 't'   op( A ) = A'.

                      Unchanged on exit.

           <u>DIAG</u>

                     DIAG is CHARACTER*1
                      On entry, DIAG specifies whether or not RFP A is unit
                      triangular as follows:

                         DIAG = 'U' or 'u'   A is assumed to be unit triangular.

                         DIAG = 'N' or 'n'   A is not assumed to be unit
                                             triangular.

                      Unchanged on exit.

           <u>M</u>

                     M is INTEGER
                      On entry, M specifies the number of rows of B. M must be at
                      least zero.
                      Unchanged on exit.

           <u>N</u>

                     N is INTEGER
                      On entry, N specifies the number of columns of B.  N must be
                      at least zero.
                      Unchanged on exit.

           <u>ALPHA</u>

                     ALPHA is DOUBLE PRECISION
                      On entry,  ALPHA specifies the scalar  alpha. When  alpha is
                      zero then  A is not referenced and  B need not be set before
                      entry.
                      Unchanged on exit.

           <u>A</u>

                     A is DOUBLE PRECISION array, dimension (NT)
                      NT = N*(N+1)/2 if SIDE='R' and NT = M*(M+1)/2 otherwise.
                      On entry, the matrix A in RFP Format.
                      RFP Format is described by TRANSR, UPLO and N as follows:
                      If TRANSR='N' then RFP A is (0:N,0:K-1) when N is even;
                      K=N/2. RFP A is (0:N-1,0:K) when N is odd; K=N/2. If
                      TRANSR = 'T' then RFP is the transpose of RFP A as
                      defined when TRANSR = 'N'. The contents of RFP A are defined
                      by UPLO as follows: If UPLO = 'U' the RFP A contains the NT
                      elements of upper packed A either in normal or
                      transpose Format. If UPLO = 'L' the RFP A contains
                      the NT elements of lower packed A either in normal or
                      transpose Format. The LDA of RFP A is (N+1)/2 when
                      TRANSR = 'T'. When TRANSR is 'N' the LDA is N+1 when N is
                      even and is N when is odd.
                      See the Note below for more details. Unchanged on exit.

           <u>B</u>

                     B is DOUBLE PRECISION array, dimension (LDB,N)
                      Before entry,  the leading  m by n part of the array  B must
                      contain  the  right-hand  side  matrix  B,  and  on exit  is
                      overwritten by the solution matrix  X.

           <u>LDB</u>

                     LDB is INTEGER
                      On entry, LDB specifies the first dimension of B as declared
                      in  the  calling  (sub)  program.   LDB  must  be  at  least
                      max( 1, m ).
                      Unchanged on exit.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

             We first consider Rectangular Full Packed (RFP) Format when N is
             even. We give an example where N = 6.

                 AP is Upper             AP is Lower

              00 01 02 03 04 05       00
                 11 12 13 14 15       10 11
                    22 23 24 25       20 21 22
                       33 34 35       30 31 32 33
                          44 45       40 41 42 43 44
                             55       50 51 52 53 54 55

             Let TRANSR = 'N'. RFP holds AP as follows:
             For UPLO = 'U' the upper trapezoid A(0:5,0:2) consists of the last
             three columns of AP upper. The lower triangle A(4:6,0:2) consists of
             the transpose of the first three columns of AP upper.
             For UPLO = 'L' the lower trapezoid A(1:6,0:2) consists of the first
             three columns of AP lower. The upper triangle A(0:2,0:2) consists of
             the transpose of the last three columns of AP lower.
             This covers the case N even and TRANSR = 'N'.

                    RFP A                   RFP A

                   03 04 05                33 43 53
                   13 14 15                00 44 54
                   23 24 25                10 11 55
                   33 34 35                20 21 22
                   00 44 45                30 31 32
                   01 11 55                40 41 42
                   02 12 22                50 51 52

             Now let TRANSR = 'T'. RFP A in both UPLO cases is just the
             transpose of RFP A above. One therefore gets:

                      RFP A                   RFP A

                03 13 23 33 00 01 02    33 00 10 20 30 40 50
                04 14 24 34 44 11 12    43 44 11 21 31 41 51
                05 15 25 35 45 55 22    53 54 55 22 32 42 52

             We then consider Rectangular Full Packed (RFP) Format when N is
             odd. We give an example where N = 5.

                AP is Upper                 AP is Lower

              00 01 02 03 04              00
                 11 12 13 14              10 11
                    22 23 24              20 21 22
                       33 34              30 31 32 33
                          44              40 41 42 43 44

             Let TRANSR = 'N'. RFP holds AP as follows:
             For UPLO = 'U' the upper trapezoid A(0:4,0:2) consists of the last
             three columns of AP upper. The lower triangle A(3:4,0:1) consists of
             the transpose of the first two columns of AP upper.
             For UPLO = 'L' the lower trapezoid A(0:4,0:2) consists of the first
             three columns of AP lower. The upper triangle A(0:1,1:2) consists of
             the transpose of the last two columns of AP lower.
             This covers the case N odd and TRANSR = 'N'.

                    RFP A                   RFP A

                   02 03 04                00 33 43
                   12 13 14                10 11 44
                   22 23 24                20 21 22
                   00 33 34                30 31 32
                   01 11 44                40 41 42

             Now let TRANSR = 'T'. RFP A in both UPLO cases is just the
             transpose of RFP A above. One therefore gets:

                      RFP A                   RFP A

                02 12 22 00 01             00 10 20 30 40 50
                03 13 23 33 11             33 11 21 31 41 51
                04 14 24 34 44             43 44 22 32 42 52

   <b>subroutine</b> <b>stfsm</b> <b>(character</b> <b>transr,</b> <b>character</b> <b>side,</b> <b>character</b> <b>uplo,</b> <b>character</b> <b>trans,</b> <b>character</b> <b>diag,</b> <b>integer</b>
       <b>m,</b> <b>integer</b> <b>n,</b> <b>real</b> <b>alpha,</b> <b>real,</b> <b>dimension(</b> <b>0:</b> <b>*</b> <b>)</b> <b>a,</b> <b>real,</b> <b>dimension(</b> <b>0:</b> <b>ldb-1,</b> <b>0:</b> <b>*</b> <b>)</b> <b>b,</b> <b>integer</b> <b>ldb)</b>
       <b>STFSM</b> solves a matrix equation (one operand is a triangular matrix in RFP format).

       <b>Purpose:</b>

            Level 3 BLAS like routine for A in RFP Format.

            STFSM  solves the matrix equation

               op( A )*X = alpha*B  or  X*op( A ) = alpha*B

            where alpha is a scalar, X and B are m by n matrices, A is a unit, or
            non-unit,  upper or lower triangular matrix  and  op( A )  is one  of

               op( A ) = A   or   op( A ) = A**T.

            A is in Rectangular Full Packed (RFP) Format.

            The matrix X is overwritten on B.

       <b>Parameters</b>
           <u>TRANSR</u>

                     TRANSR is CHARACTER*1
                     = 'N':  The Normal Form of RFP A is stored;
                     = 'T':  The Transpose Form of RFP A is stored.

           <u>SIDE</u>

                     SIDE is CHARACTER*1
                      On entry, SIDE specifies whether op( A ) appears on the left
                      or right of X as follows:

                         SIDE = 'L' or 'l'   op( A )*X = alpha*B.

                         SIDE = 'R' or 'r'   X*op( A ) = alpha*B.

                      Unchanged on exit.

           <u>UPLO</u>

                     UPLO is CHARACTER*1
                      On entry, UPLO specifies whether the RFP matrix A came from
                      an upper or lower triangular matrix as follows:
                      UPLO = 'U' or 'u' RFP A came from an upper triangular matrix
                      UPLO = 'L' or 'l' RFP A came from a  lower triangular matrix

                      Unchanged on exit.

           <u>TRANS</u>

                     TRANS is CHARACTER*1
                      On entry, TRANS  specifies the form of op( A ) to be used
                      in the matrix multiplication as follows:

                         TRANS  = 'N' or 'n'   op( A ) = A.

                         TRANS  = 'T' or 't'   op( A ) = A'.

                      Unchanged on exit.

           <u>DIAG</u>

                     DIAG is CHARACTER*1
                      On entry, DIAG specifies whether or not RFP A is unit
                      triangular as follows:

                         DIAG = 'U' or 'u'   A is assumed to be unit triangular.

                         DIAG = 'N' or 'n'   A is not assumed to be unit
                                             triangular.

                      Unchanged on exit.

           <u>M</u>

                     M is INTEGER
                      On entry, M specifies the number of rows of B. M must be at
                      least zero.
                      Unchanged on exit.

           <u>N</u>

                     N is INTEGER
                      On entry, N specifies the number of columns of B.  N must be
                      at least zero.
                      Unchanged on exit.

           <u>ALPHA</u>

                     ALPHA is REAL
                      On entry,  ALPHA specifies the scalar  alpha. When  alpha is
                      zero then  A is not referenced and  B need not be set before
                      entry.
                      Unchanged on exit.

           <u>A</u>

                     A is REAL array, dimension (NT)
                      NT = N*(N+1)/2 if SIDE='R' and NT = M*(M+1)/2 otherwise.
                      On entry, the matrix A in RFP Format.
                      RFP Format is described by TRANSR, UPLO and N as follows:
                      If TRANSR='N' then RFP A is (0:N,0:K-1) when N is even;
                      K=N/2. RFP A is (0:N-1,0:K) when N is odd; K=N/2. If
                      TRANSR = 'T' then RFP is the transpose of RFP A as
                      defined when TRANSR = 'N'. The contents of RFP A are defined
                      by UPLO as follows: If UPLO = 'U' the RFP A contains the NT
                      elements of upper packed A either in normal or
                      transpose Format. If UPLO = 'L' the RFP A contains
                      the NT elements of lower packed A either in normal or
                      transpose Format. The LDA of RFP A is (N+1)/2 when
                      TRANSR = 'T'. When TRANSR is 'N' the LDA is N+1 when N is
                      even and is N when is odd.
                      See the Note below for more details. Unchanged on exit.

           <u>B</u>

                     B is REAL array, dimension (LDB,N)
                      Before entry,  the leading  m by n part of the array  B must
                      contain  the  right-hand  side  matrix  B,  and  on exit  is
                      overwritten by the solution matrix  X.

           <u>LDB</u>

                     LDB is INTEGER
                      On entry, LDB specifies the first dimension of B as declared
                      in  the  calling  (sub)  program.   LDB  must  be  at  least
                      max( 1, m ).
                      Unchanged on exit.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

             We first consider Rectangular Full Packed (RFP) Format when N is
             even. We give an example where N = 6.

                 AP is Upper             AP is Lower

              00 01 02 03 04 05       00
                 11 12 13 14 15       10 11
                    22 23 24 25       20 21 22
                       33 34 35       30 31 32 33
                          44 45       40 41 42 43 44
                             55       50 51 52 53 54 55

             Let TRANSR = 'N'. RFP holds AP as follows:
             For UPLO = 'U' the upper trapezoid A(0:5,0:2) consists of the last
             three columns of AP upper. The lower triangle A(4:6,0:2) consists of
             the transpose of the first three columns of AP upper.
             For UPLO = 'L' the lower trapezoid A(1:6,0:2) consists of the first
             three columns of AP lower. The upper triangle A(0:2,0:2) consists of
             the transpose of the last three columns of AP lower.
             This covers the case N even and TRANSR = 'N'.

                    RFP A                   RFP A

                   03 04 05                33 43 53
                   13 14 15                00 44 54
                   23 24 25                10 11 55
                   33 34 35                20 21 22
                   00 44 45                30 31 32
                   01 11 55                40 41 42
                   02 12 22                50 51 52

             Now let TRANSR = 'T'. RFP A in both UPLO cases is just the
             transpose of RFP A above. One therefore gets:

                      RFP A                   RFP A

                03 13 23 33 00 01 02    33 00 10 20 30 40 50
                04 14 24 34 44 11 12    43 44 11 21 31 41 51
                05 15 25 35 45 55 22    53 54 55 22 32 42 52

             We then consider Rectangular Full Packed (RFP) Format when N is
             odd. We give an example where N = 5.

                AP is Upper                 AP is Lower

              00 01 02 03 04              00
                 11 12 13 14              10 11
                    22 23 24              20 21 22
                       33 34              30 31 32 33
                          44              40 41 42 43 44

             Let TRANSR = 'N'. RFP holds AP as follows:
             For UPLO = 'U' the upper trapezoid A(0:4,0:2) consists of the last
             three columns of AP upper. The lower triangle A(3:4,0:1) consists of
             the transpose of the first two columns of AP upper.
             For UPLO = 'L' the lower trapezoid A(0:4,0:2) consists of the first
             three columns of AP lower. The upper triangle A(0:1,1:2) consists of
             the transpose of the last two columns of AP lower.
             This covers the case N odd and TRANSR = 'N'.

                    RFP A                   RFP A

                   02 03 04                00 33 43
                   12 13 14                10 11 44
                   22 23 24                20 21 22
                   00 33 34                30 31 32
                   01 11 44                40 41 42

             Now let TRANSR = 'T'. RFP A in both UPLO cases is just the
             transpose of RFP A above. One therefore gets:

                      RFP A                   RFP A

                02 12 22 00 01             00 10 20 30 40 50
                03 13 23 33 11             33 11 21 31 41 51
                04 14 24 34 44             43 44 22 32 42 52

   <b>subroutine</b> <b>ztfsm</b> <b>(character</b> <b>transr,</b> <b>character</b> <b>side,</b> <b>character</b> <b>uplo,</b> <b>character</b> <b>trans,</b> <b>character</b> <b>diag,</b> <b>integer</b>
       <b>m,</b> <b>integer</b> <b>n,</b> <b>complex*16</b> <b>alpha,</b> <b>complex*16,</b> <b>dimension(</b> <b>0:</b> <b>*</b> <b>)</b> <b>a,</b> <b>complex*16,</b> <b>dimension(</b> <b>0:</b> <b>ldb-1,</b> <b>0:</b> <b>*</b> <b>)</b>
       <b>b,</b> <b>integer</b> <b>ldb)</b>
       <b>ZTFSM</b> solves a matrix equation (one operand is a triangular matrix in RFP format).

       <b>Purpose:</b>

            Level 3 BLAS like routine for A in RFP Format.

            ZTFSM  solves the matrix equation

               op( A )*X = alpha*B  or  X*op( A ) = alpha*B

            where alpha is a scalar, X and B are m by n matrices, A is a unit, or
            non-unit,  upper or lower triangular matrix  and  op( A )  is one  of

               op( A ) = A   or   op( A ) = A**H.

            A is in Rectangular Full Packed (RFP) Format.

            The matrix X is overwritten on B.

       <b>Parameters</b>
           <u>TRANSR</u>

                     TRANSR is CHARACTER*1
                     = 'N':  The Normal Form of RFP A is stored;
                     = 'C':  The Conjugate-transpose Form of RFP A is stored.

           <u>SIDE</u>

                     SIDE is CHARACTER*1
                      On entry, SIDE specifies whether op( A ) appears on the left
                      or right of X as follows:

                         SIDE = 'L' or 'l'   op( A )*X = alpha*B.

                         SIDE = 'R' or 'r'   X*op( A ) = alpha*B.

                      Unchanged on exit.

           <u>UPLO</u>

                     UPLO is CHARACTER*1
                      On entry, UPLO specifies whether the RFP matrix A came from
                      an upper or lower triangular matrix as follows:
                      UPLO = 'U' or 'u' RFP A came from an upper triangular matrix
                      UPLO = 'L' or 'l' RFP A came from a  lower triangular matrix

                      Unchanged on exit.

           <u>TRANS</u>

                     TRANS is CHARACTER*1
                      On entry, TRANS  specifies the form of op( A ) to be used
                      in the matrix multiplication as follows:

                         TRANS  = 'N' or 'n'   op( A ) = A.

                         TRANS  = 'C' or 'c'   op( A ) = conjg( A' ).

                      Unchanged on exit.

           <u>DIAG</u>

                     DIAG is CHARACTER*1
                      On entry, DIAG specifies whether or not RFP A is unit
                      triangular as follows:

                         DIAG = 'U' or 'u'   A is assumed to be unit triangular.

                         DIAG = 'N' or 'n'   A is not assumed to be unit
                                             triangular.

                      Unchanged on exit.

           <u>M</u>

                     M is INTEGER
                      On entry, M specifies the number of rows of B. M must be at
                      least zero.
                      Unchanged on exit.

           <u>N</u>

                     N is INTEGER
                      On entry, N specifies the number of columns of B.  N must be
                      at least zero.
                      Unchanged on exit.

           <u>ALPHA</u>

                     ALPHA is COMPLEX*16
                      On entry,  ALPHA specifies the scalar  alpha. When  alpha is
                      zero then  A is not referenced and  B need not be set before
                      entry.
                      Unchanged on exit.

           <u>A</u>

                     A is COMPLEX*16 array, dimension (N*(N+1)/2)
                      NT = N*(N+1)/2 if SIDE='R' and NT = M*(M+1)/2 otherwise.
                      On entry, the matrix A in RFP Format.
                      RFP Format is described by TRANSR, UPLO and N as follows:
                      If TRANSR='N' then RFP A is (0:N,0:K-1) when N is even;
                      K=N/2. RFP A is (0:N-1,0:K) when N is odd; K=N/2. If
                      TRANSR = 'C' then RFP is the Conjugate-transpose of RFP A as
                      defined when TRANSR = 'N'. The contents of RFP A are defined
                      by UPLO as follows: If UPLO = 'U' the RFP A contains the NT
                      elements of upper packed A either in normal or
                      conjugate-transpose Format. If UPLO = 'L' the RFP A contains
                      the NT elements of lower packed A either in normal or
                      conjugate-transpose Format. The LDA of RFP A is (N+1)/2 when
                      TRANSR = 'C'. When TRANSR is 'N' the LDA is N+1 when N is
                      even and is N when is odd.
                      See the Note below for more details. Unchanged on exit.

           <u>B</u>

                     B is COMPLEX*16 array, dimension (LDB,N)
                      Before entry,  the leading  m by n part of the array  B must
                      contain  the  right-hand  side  matrix  B,  and  on exit  is
                      overwritten by the solution matrix  X.

           <u>LDB</u>

                     LDB is INTEGER
                      On entry, LDB specifies the first dimension of B as declared
                      in  the  calling  (sub)  program.   LDB  must  be  at  least
                      max( 1, m ).
                      Unchanged on exit.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

             We first consider Standard Packed Format when N is even.
             We give an example where N = 6.

                 AP is Upper             AP is Lower

              00 01 02 03 04 05       00
                 11 12 13 14 15       10 11
                    22 23 24 25       20 21 22
                       33 34 35       30 31 32 33
                          44 45       40 41 42 43 44
                             55       50 51 52 53 54 55

             Let TRANSR = 'N'. RFP holds AP as follows:
             For UPLO = 'U' the upper trapezoid A(0:5,0:2) consists of the last
             three columns of AP upper. The lower triangle A(4:6,0:2) consists of
             conjugate-transpose of the first three columns of AP upper.
             For UPLO = 'L' the lower trapezoid A(1:6,0:2) consists of the first
             three columns of AP lower. The upper triangle A(0:2,0:2) consists of
             conjugate-transpose of the last three columns of AP lower.
             To denote conjugate we place -- above the element. This covers the
             case N even and TRANSR = 'N'.

                    RFP A                   RFP A

                                           -- -- --
                   03 04 05                33 43 53
                                              -- --
                   13 14 15                00 44 54
                                                 --
                   23 24 25                10 11 55

                   33 34 35                20 21 22
                   --
                   00 44 45                30 31 32
                   -- --
                   01 11 55                40 41 42
                   -- -- --
                   02 12 22                50 51 52

             Now let TRANSR = 'C'. RFP A in both UPLO cases is just the conjugate-
             transpose of RFP A above. One therefore gets:

                      RFP A                   RFP A

                -- -- -- --                -- -- -- -- -- --
                03 13 23 33 00 01 02    33 00 10 20 30 40 50
                -- -- -- -- --                -- -- -- -- --
                04 14 24 34 44 11 12    43 44 11 21 31 41 51
                -- -- -- -- -- --                -- -- -- --
                05 15 25 35 45 55 22    53 54 55 22 32 42 52

             We next  consider Standard Packed Format when N is odd.
             We give an example where N = 5.

                AP is Upper                 AP is Lower

              00 01 02 03 04              00
                 11 12 13 14              10 11
                    22 23 24              20 21 22
                       33 34              30 31 32 33
                          44              40 41 42 43 44

             Let TRANSR = 'N'. RFP holds AP as follows:
             For UPLO = 'U' the upper trapezoid A(0:4,0:2) consists of the last
             three columns of AP upper. The lower triangle A(3:4,0:1) consists of
             conjugate-transpose of the first two   columns of AP upper.
             For UPLO = 'L' the lower trapezoid A(0:4,0:2) consists of the first
             three columns of AP lower. The upper triangle A(0:1,1:2) consists of
             conjugate-transpose of the last two   columns of AP lower.
             To denote conjugate we place -- above the element. This covers the
             case N odd  and TRANSR = 'N'.

                    RFP A                   RFP A

                                              -- --
                   02 03 04                00 33 43
                                                 --
                   12 13 14                10 11 44

                   22 23 24                20 21 22
                   --
                   00 33 34                30 31 32
                   -- --
                   01 11 44                40 41 42

             Now let TRANSR = 'C'. RFP A in both UPLO cases is just the conjugate-
             transpose of RFP A above. One therefore gets:

                      RFP A                   RFP A

                -- -- --                   -- -- -- -- -- --
                02 12 22 00 01             00 10 20 30 40 50
                -- -- -- --                   -- -- -- -- --
                03 13 23 33 11             33 11 21 31 41 51
                -- -- -- -- --                   -- -- -- --
                04 14 24 34 44             43 44 22 32 42 52

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for LAPACK from the source code.

Version 3.12.0                               Thu Aug 7 2025 17:26:25                                     <u><a href="../man3/tfsm.3.html">tfsm</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>