<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>"Net::Async::Matrix::Room" - a single Matrix room</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-async-matrix-perl">libnet-async-matrix-perl_0.19-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       "Net::Async::Matrix::Room" - a single Matrix room

</pre><h4><b>DESCRIPTION</b></h4><pre>
       An instances in this class are used by Net::Async::Matrix to represent a single Matrix room.

</pre><h4><b>EVENTS</b></h4><pre>
       The following events are invoked, either using subclass methods or "CODE" references in parameters:

   <b>on_synced_state</b>
       Invoked after the initial sync of the room has been completed as far as the state.

   <b>on_message</b> <b>$member,</b> <b>$content,</b> <b>$event</b>
   <b>on_back_message</b> <b>$member,</b> <b>$content,</b> <b>$event</b>
       Invoked on receipt of a new message from the given member, either "live" from the event stream, or from
       backward pagination.

   <b>on_membership</b> <b>$member,</b> <b>$event,</b> <b>$subject_member,</b> <b>%changes</b>
   <b>on_back_membership</b> <b>$member,</b> <b>$event,</b> <b>$subject_member,</b> <b>%changes</b>
       Invoked on receipt of a membership change event for the given member, either "live" from the event
       stream, or from backward pagination. %changes will be a key/value list of state field names that were
       changed, whose values are 2-element ARRAY references containing the before/after values of those fields.

        on_membership:      $field_name =&gt; [ $old_value, $new_value ]
        on_back_membership: $field_name =&gt; [ $new_value, $old_value ]

       Note carefully that the second value in each array gives the "updated" value, in the direction of the
       change - that is, for "on_membership" it gives the new value after the change but for "on_back_message"
       it gives the old value before. Fields whose values did not change are not present in the %changes list;
       the values of these can be inspected on the $member object.

       It is unspecified what values the $member object has for fields present in the change list - client code
       should not rely on these fields.

       In most cases when users change their own membership status (such as normal join or leave), the $member
       and $subject_member parameters refer to the same object. In other cases, such as invites or kicks, the
       $member parameter refers to the member performing the change, and the $subject_member refers to member
       that the change is about.

   <b>on_state_changed</b> <b>$member,</b> <b>$event,</b> <b>%changes</b>
   <b>on_back_state_changed</b> <b>$member,</b> <b>$event,</b> <b>%changes</b>
       Invoked on receipt of a change of room state (such as name or topic).

       In the special case of room aliases, because they are considered "state" but are stored per-homeserver,
       the changes value will consist of three fields; the old and new values <u>from</u> <u>that</u> <u>home</u> <u>server</u>, and a list
       of the known aliases from all the other servers:

        on_state_changed:      aliases =&gt; [ $old, $new, $other ]
        on_back_state_changed: aliases =&gt; [ $new, $old, $other ]

       This allows a client to detect deletions and additions by comparing the before and after lists, while
       still having access to the full set of before or after aliases, should it require it.

   <b>on_presence</b> <b>$member,</b> <b>%changes</b>
       Invoked when a member of the room changes membership or presence state. The $member object will already
       be in the new state. %changes will be a key/value list of state fields names that were changed, and
       references to 2-element ARRAYs containing the old and new values for this field.

   <b>on_typing</b> <b>$member,</b> <b>$is_typing</b>
       Invoked on receipt of a typing notification change, when the given member either starts or stops typing.

   <b>on_members_typing</b> <b>@members</b>
       Invoked on receipt of a typing notification change to give the full set of currently-typing members. This
       is invoked after the individual "on_typing" events.

   <b>on_read_receipt</b> <b>$member,</b> <b>$event_id,</b> <b>$content</b>
       Invoked on receipt of a "m.read" type of receipt message.

</pre><h4><b>METHODS</b></h4><pre>
   <b>await_synced</b>
          $f = $room-&gt;await_synced

       Returns a Future stored within the room that will complete (with no value) once the room initial state
       sync has been completed. This completes just <u>before</u> the "on_synced_state" event.

   <b>live_state</b>
          $state = $room-&gt;live_state

       Returns a Net::Async::Matrix::Room::State instance representing the current live-tracking state of the
       room.

       This instance will mutate and change as new state events are received.

   <b>room_id</b>
          $id = $room-&gt;room_id

       Returns the opaque room ID string for the room. Usually this would not be required, except for long-term
       persistence uniqueness purposes, or for inclusion in direct protocol URLs.

   <b>name</b>
          $name = $room-&gt;name

       Returns the room name, if defined, otherwise the opaque room ID.

   <b>set_name</b>
          $room-&gt;set_name( $name )-&gt;get

       Requests to set a new room name.

   <b>aliases</b>
          @aliases = $room-&gt;aliases

       Returns a list of all the known room alias names taken from the "m.room.alias" events. Note that these
       are simply names <u>claimed</u> to have aliases from the alias events; a client ought to still check that these
       are valid before presenting them to the user as such, or in other ways relying on their values.

   <b>join_rule</b>
          $rule = $room-&gt;join_rule

       Returns the current "join_rule" for the room; a string giving the type of access new members may get:

       •   public

           Any user may join without further permission

       •   invite

           Users may only join if explicitly invited

       •   knock

           Any user may send a knock message to request access; may only join if invited

       •   private

           No new users may join the room

   <b>topic</b>
          $topic = $room-&gt;topic

       Returns the room topic, if defined

   <b>set_topic</b>
          $room-&gt;set_topic( $topic )-&gt;get

       Requests to set a new room topic.

   <b>levels</b>
          %levels = $room-&gt;levels

       Returns  a key/value list of the room levels; that is, the member power level required to perform each of
       the named actions.

   <b>change_levels</b>
          $room-&gt;change_levels( %levels )-&gt;get

       Performs a room levels change, submitting new  values  for  the  given  keys  while  leaving  other  keys
       unchanged.

   <b>members</b>
          @members = $room-&gt;members

       Returns  a  list  of  member structs containing the currently known members of the room, in no particular
       order. This list will include users who are not yet members of the room, but simply have been invited.

   <b>joined_members</b>
          @members = $room-&gt;joined_members

       Returns the subset of "all_members" who actually in the "join" state - i.e. are  not  invitees,  or  have
       left.

   <b>member_level</b>
          $level = $room-&gt;member_level( $user_id )

       Returns  the  current  cached  value for the power level of the given user ID, or the default value if no
       specific value exists for the given ID.

   <b>change_member_levels</b>
          $room-&gt;change_member_levels( %levels )-&gt;get

       Performs a member power level change, submitting new values for user IDs to the home server. As there  is
       no  server API to make individual mutations, this is done by taking the currently cached values, applying
       the changes given by the %levels key/value list, and submitting the resulting whole as the new value  for
       the "m.room.power_levels" room state.

       The  %levels key/value list should provide new values for keys giving user IDs, or the special user ID of
       "default" to change the overall default value for users not  otherwise  mentioned.  Setting  the  special
       value of "undef" for a user ID will remove that ID from the set, reverting them to the default.

   <b>leave</b>
          $room-&gt;leave-&gt;get

       Requests to leave the room. After this completes, the user will no longer be a member of the room.

   <b>invite</b>
          $room-&gt;invite( $user_id )-&gt;get

       Sends an invitation for the user with the given User ID to join the room.

   <b>kick</b>
          $room-&gt;kick( $user_id, $reason )-&gt;get

       Requests to remove the user with the given User ID from the room.

       Optionally, a textual description reason can also be provided.

   <b>send_message</b>
          $event_id = $room-&gt;send_message( %args )-&gt;get

       Sends  a  new message to the room. Requires a "type" named argument giving the message type. Depending on
       the type, further keys will be required that specify the message contents:

       m.text, m.emote, m.notice
           Require "body"

       m.image, m.audio, m.video, m.file
           Require "url"

       m.location
           Require "geo_uri"

       If an additional argument called "txn_id" is provided, this  is  used  as  the  transaction  ID  for  the
       message, which is then sent as a "PUT" request instead of a "POST".

          $event_id = $room-&gt;send_message( $text )-&gt;get

       A convenient shortcut to sending an "text" message with a body string and no additional content.

   <b>paginate_messages</b>
          $room-&gt;paginate_messages( limit =&gt; $n )-&gt;get

       Requests more messages of back-pagination history.

       There is no need to maintain a reference on the returned "Future"; it will be adopted by the room object.

   <b>typing_start</b>
          $room-&gt;typing_start

       Sends  a  typing  notification  that  the  user is currently typing in this room.  This notification will
       periodically be re-sent as required by the protocol until the "typing_stop" method is called.

   <b>typing_stop</b>
          $room-&gt;typing_stop

       Sends a typing notification that the user is no longer typing in this room.  This method also cancels the
       repeating re-send behaviour created by "typing_start".

   <b>send_read_receipt</b>
          $room-&gt;send_read_receipt( event_id =&gt; $event_id, ... )-&gt;get

       Sends a "m.read" receipt to the given room for the given event ID.

</pre><h4><b>MEMBERSHIP</b> <b>STRUCTURES</b></h4><pre>
       Parameters documented as $member receive a membership struct, which supports the following methods:

   <b>$user</b> <b>=</b> <b>$member-&gt;user</b>
       User object of the member.

   <b>$displayname</b> <b>=</b> <b>$member-&gt;displayname</b>
       Profile displayname of the user.

   <b>$membership</b> <b>=</b> <b>$member-&gt;membership</b>
       Membership state. One of "invite" or "join".

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Evans &lt;<a href="mailto:leonerd@leonerd.org.uk">leonerd@leonerd.org.uk</a>&gt;

perl v5.36.0                                       2022-12-10                      <u>Net::Async::Matrix::<a href="../man3pm/Room.3pm.html">Room</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>