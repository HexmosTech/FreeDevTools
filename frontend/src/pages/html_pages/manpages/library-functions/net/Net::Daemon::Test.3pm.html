<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::Daemon::Test - support functions for testing Net::Daemon servers</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-daemon-perl">libnet-daemon-perl_0.49-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::Daemon::Test - support functions for testing Net::Daemon servers

</pre><h4><b>SYNOPSIS</b></h4><pre>
           # This is the server, stored in the file "servertask".
           #
           # Create a subclass of Net::Daemon::Test, which in turn is
           # a subclass of Net::Daemon
           use Net::Daemon::Test ();
           package MyDaemon;
           our @ISA = qw(Net::Daemon::Test);

           sub Run {
               # Overwrite this and other methods, as you like.
           }

           my $self = Net::Daemon-&gt;new(\%attr, \@options);
           eval { $self-&gt;Bind() };
           if ($@) {
               die "Server cannot bind: $!";
           }
           eval { $self-&gt;Run() };
           if ($@) {
               die "Unexpected server termination: $@";
           }

           # This is the client, the real test script, note we call the
           # "servertask" file below:
           #
           # Call the Child method to spawn a child. Don't forget to use
           # the timeout option.
           use Net::Daemon::Test ();

           my($handle, $port) = eval {
               Net::Daemon::Test-&gt;Child(5, # Number of subtests
                                        'servertask', '--timeout', '20')
           };
           if ($@) {
               print "not ok 1 $@\n";
               exit 0;
           }
           print "ok 1\n";

           # Real tests following here
           ...

           # Terminate the server
           $handle-&gt;Terminate();

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module is a frame for creating test scripts of Net::Daemon based server packages, preferrably using
       Test::Harness, but that's your choice.

       A test consists of two parts: The client part and the server part.  The test is executed by the child
       part which invokes the server part, by spawning a child process and invoking an external Perl script.
       (Of course we woultn't need this external file with <b>fork()</b>, but that's the best possibility to make the
       test scripts portable to Windows without requiring threads in the test script.)

       The server part is a usual Net::Daemon application, for example a script like dbiproxy. The only
       difference is that it derives from Net::Daemon::Test and not from Net::Daemon, the main difference is
       that the <b>Bind</b> method attempts to allocate a port automatically. Once a port is allocated, the number is
       stored in the file "ndtest.prt".

       After spawning the server process, the child will wait ten seconds (hopefully sufficient) for the
       creation of ndtest.prt.

</pre><h4><b>AVAILABLE</b> <b>METHODS</b></h4><pre>
   <b>Server</b> <b>part</b>
       Options Adds  an  option  <b>--timeout</b>  to  Net::Daemon:  The  server's Run method will die after at most 20
               seconds.

       Bind    (Instance method) This is mainly the default Bind method, but it attempts to find and allocate  a
               free  port  in  two  ways:  First  of  all,  it tries to call Bind with port 0, most systems will
               automatically choose a port in that case. If that seems to fail, ports 30000-30049 are tried.  We
               hope, one of these will succeed. :-)

       Run     (Instance method) Overwrites the Net::Daemon's method by adding a timeout.

       sub Run ($) {
           my $self = shift;
           $self-&gt;<b>Run()</b>; }

   <b>Client</b> <b>part</b>
       Child   (Class  method)  Attempts to spawn a server process. The server process is expected to create the
               file 'ndtest.prt' with the port number.

               The method returns a process handle and a  port  number.  The  process  handle  offers  a  method
               <b>Terminate</b> that may later be used to stop the server process.

</pre><h4><b>AUTHOR</b> <b>AND</b> <b>COPYRIGHT</b></h4><pre>
         Net::Daemon is Copyright (C) 1998, Jochen Wiedmann
                                            Am Eisteich 9
                                            72555 Metzingen
                                            Germany

                                            Phone: +49 7123 14887
                                            Email: <a href="mailto:joe@ispsoft.de">joe@ispsoft.de</a>

         All rights reserved.

       You  may  distribute under the terms of either the GNU General Public License or the Artistic License, as
       specified in the Perl README file.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>Net::<a href="../man3/Daemon.3.html">Daemon</a></b>(3), <b>Test::<a href="../man3/Harness.3.html">Harness</a></b>(3)

perl v5.38.2                                       2024-03-07                             <u>Net::Daemon::<a href="../man3pm/Test.3pm.html">Test</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>