<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::NBName - NetBIOS Name Service Requests</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-nbname-perl">libnet-nbname-perl_0.26-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::NBName - NetBIOS Name Service Requests

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Net::NBName;
         my $nb = Net::NBName-&gt;new;

         # a unicast node status request
         my $ns = $nb-&gt;node_status("10.0.0.1");
         if ($ns) {
             print $ns-&gt;as_string;
         }

         # a unicast name query request
         my $nq = $nb-&gt;name_query("10.0.1.80", "SPARK", 0x00);
         if ($nq) {
             print $nq-&gt;as_string;
         }

         # a broadcast name query request
         my $nq = $nb-&gt;name_query(undef, "SPARK", 0x00);
         if ($nq) {
             print $nq-&gt;as_string;
         }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Net::NBName is a class that allows you to perform simple NetBIOS Name Service Requests in your Perl code.
       It performs these NetBIOS operations over TCP/IP using Perl's built-in socket support.

       I've currently implemented two NBNS requests: the node status request and the name query request.

       NetBIOS Node Status Request
           This allows you to determine the registered NetBIOS names for a specified remote host.

           The decoded response is returned as a "Net::NBName::NodeStatus" object.

               querying 192.168.0.10 for node status...
               SPARK          &lt;20&gt; UNIQUE M-node Registered Active
               SPARK          &lt;00&gt; UNIQUE M-node Registered Active
               PLAYGROUND     &lt;00&gt; GROUP  M-node Registered Active
               PLAYGROUND     &lt;1C&gt; GROUP  M-node Registered Active
               PLAYGROUND     &lt;1B&gt; UNIQUE M-node Registered Active
               PLAYGROUND     &lt;1E&gt; GROUP  M-node Registered Active
               SPARK          &lt;03&gt; UNIQUE M-node Registered Active
               PLAYGROUND     &lt;1D&gt; UNIQUE M-node Registered Active
               ..__MSBROWSE__.&lt;01&gt; GROUP  M-node Registered Active
               MAC Address = 00-1C-2B-3A-49-58

       NetBIOS Name Query Request
           This  allows you to resolve a name to an IP address using NetBIOS Name Resolution. These requests can
           either be unicast (e.g. if you are querying an NBNS server) or broadcast on the local subnet.

           In either case, the decoded response is returned as an "Net::NBName::NameQuery" object.

               querying 192.168.0.10 for playground&lt;00&gt;...
               255.255.255.255 GROUP  B-node
               ttl = 0 (default is 300000)
               RA set, this was an NBNS server

               broadcasting for playground&lt;1C&gt;...
               192.168.0.10    GROUP  B-node
               ttl = 0 (default is 300000)
               RA set, this was an NBNS server

               broadcasting for spark&lt;20&gt;...
               192.168.0.10    UNIQUE H-node
               ttl = 0 (default is 300000)
               RA set, this was an NBNS server

</pre><h4><b>CONSTRUCTOR</b></h4><pre>
       $nb = Net::NBName-&gt;new
           Creates a new "Net::NBName" object. This can be used to perform NetBIOS Name Service requests.

</pre><h4><b>METHODS</b></h4><pre>
       $ns = $nb-&gt;node_status( $host [, $timeout] )
           This  will  query  the  host  for  its  node  status.  The   response   will   be   returned   as   a
           "Net::NBName::NodeStatus" object.

           If no response is received from the host, the method will return undef.

           You  can  also  optionally  specify  the  timeout in seconds for the node status request. The timeout
           defaults to .25 seconds.

       $nq = $nb-&gt;name_query( $host, $name, $suffix [, $flags [, $timeout] ] )
           This  will  query  the  host  for  the  specified  name.  The  response  will  be   returned   as   a
           "Net::NBName::NameQuery" object.

           If  $host  is  undef,  then a broadcast name query will be performed; otherwise, a unicast name query
           will be performed.

           Broadcast name queries can sometimes receive multiple responses.  Only the  first  positive  response
           will be decoded and returned as a "Net::NBName::NameQuery" object.

           If  no  response  is  received  or a negative name query response is received, the method will return
           undef.

           You can override the flags in the NetBIOS name request, if you *really* want to.  See  the  notes  on
           Hacking Name Query Flags.

           You can also optionally specify the timeout in seconds for the name query request. It defaults to .25
           seconds for unicast name queries and 1 second for broadcast name queries.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Querying</b> <b>NetBIOS</b> <b>Names</b>
       You  can  use  this example to query for a NetBIOS name. If you specify a host, it will perform a unicast
       query; if you don't specify a host, it will perform  a  broadcast  query.  I've  used  the  shorthand  of
       specifying the name as &lt;name&gt;#&lt;suffix&gt; where the suffix should be in hex.

       "namequery.pl spark#0"

       "namequery.pl spark#20 192.168.0.10"

           use strict;
           use Net::NBName;

           my $nb = Net::NBName-&gt;new;
           my $param = shift;
           my $host = shift;
           if ($param =~ /^([\w-]+)\#(\w{1,2})$/) {
               my $name = $1;
               my $suffix = hex $2;

               my $nq;
               if (defined($host) &amp;&amp; $host =~ /\d+\.\d+\.\d+\.\d+/) {
                   printf "querying %s for %s&lt;%02X&gt;...\n", $host, $name, $suffix;
                   $nq = $nb-&gt;name_query($host, $name, $suffix);
               } else {
                   printf "broadcasting for %s&lt;%02X&gt;...\n", $name, $suffix;
                   $nq = $nb-&gt;name_query(undef, $name, $suffix);
               }
               if ($nq) {
                   print $nq-&gt;as_string;
               }
           } else {
               die "expected: &lt;name&gt;#&lt;suffix&gt; [&lt;host&gt;]\n";
           }

   <b>Querying</b> <b>Remote</b> <b>Name</b> <b>Table</b>
       This  example  emulates  the windows nbtstat -A command. By specifying the ip address of the remote host,
       you can check its NetBIOS Name Table.

       "nodestat.pl 192.168.0.10"

           use Net::NBName;

           my $nb = Net::NBName-&gt;new;
           my $host = shift;
           if (defined($host) &amp;&amp; $host =~ /\d+\.\d+\.\d+\.\d+/) {
               my $ns = $nb-&gt;node_status($host);
               if ($ns) {
                   print $ns-&gt;as_string;
               } else {
                   print "no response\n";
               }
           } else {
               die "expected: &lt;host&gt;\n";
           }

   <b>Scanning</b> <b>for</b> <b>NetBIOS</b> <b>hosts</b>
       This example can be used to scan for NetBIOS hosts on a subnet. It uses Net::Netmask to parse the  subnet
       parameter and enumerate the hosts in that subnet.

       "nodescan.pl 192.168.0.0/24"

           use Net::NBName;
           use Net::Netmask;

           $mask = shift or die "expected: &lt;subnet&gt;\n";

           $nb = Net::NBName-&gt;new;
           $subnet = Net::Netmask-&gt;new2($mask);
           for $ip ($subnet-&gt;enumerate) {
               print "$ip ";
               $ns = $nb-&gt;node_status($ip);
               if ($ns) {
                   for my $rr ($ns-&gt;names) {
                       if ($rr-&gt;suffix == 0 &amp;&amp; $rr-&gt;G eq "GROUP") {
                           $domain = $rr-&gt;name;
                       }
                       if ($rr-&gt;suffix == 3 &amp;&amp; $rr-&gt;G eq "UNIQUE") {
                           $user = $rr-&gt;name;
                       }
                       if ($rr-&gt;suffix == 0 &amp;&amp; $rr-&gt;G eq "UNIQUE") {
                           $machine = $rr-&gt;name unless $rr-&gt;name =~ /^IS~/;
                       }
                   }
                   $mac_address = $ns-&gt;mac_address;
                   print "$mac_address $domain\\$machine $user";
               }
               print "\n";
           }

</pre><h4><b>NOTES</b></h4><pre>
   <b>Microsoft's</b> <b>WINS</b> <b>Server</b> <b>Implementation</b>
       When  performing  name  queries,  you  should note that when Microsoft implemented their NBNS Name Server
       (Microsoft WINS Server) they mapped group names to the single IP  address  255.255.255.255  (the  limited
       broadcast  address). In order to support <u>real</u> group names, Microsoft modified WINS to provide support for
       special groups. These groups appear differently in WINS. For example, the Domain Controllers (0x1C) group
       appears as "Domain Name" instead of "Group".

       The complete set of WINS mapping types is:

           Unique
           Group
           Domain Name
           Internet group
           Multihomed

       Unique and Group map to a single IP address. Domain Name, Internet  group,  and  Multihomed  are  special
       groups that can include up to 25 IP addresses.

   <b>Hacking</b> <b>Name</b> <b>Query</b> <b>Flags</b>
       NetBIOS  Name  Service  Requests  have a number of flags associated with them.  These are set to sensible
       defaults by the code when sending node status and name query requests.

       However, it is possible to override these settings by calling the name_query method  of  a  "Net::NBName"
       object with a fourth parameter:

           $nb-&gt;name_query( $host, $name, $suffix, $flags );

       For  a  unicast name query, the flags default to 0x0100 which sets the RD (recursion desired) flag. For a
       broadcast name query, the flags default to 0x0010 which sets the B (broadcast) flag.

       Experimentation gave the following results:

       •   If B is set, the remote name table will be used. There will be no response if the queried name is not
           present.

       •   If B is not set and the host is an NBNS server, the NBNS server will be used before the  remote  name
           table  and  you  will  get a negative response if the name is not present; if the host is not an NBNS
           server, you will get no response if the name is not present.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2002, 2003, 2004 James Macfarlane. All rights reserved. This program is free software;  you
       can redistribute it and/or modify it under the same terms as Perl itself.

perl v5.36.0                                       2022-10-15                                   <u>Net::<a href="../man3pm/NBName.3pm.html">NBName</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>