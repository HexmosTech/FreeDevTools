<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::DNS::RR::TSIG - DNS TSIG resource record</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-dns-perl">libnet-dns-perl_1.50-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::DNS::RR::TSIG - DNS TSIG resource record

</pre><h4><b>SYNOPSIS</b></h4><pre>
               use Net::DNS;
               $tsig = Net::DNS::RR::TSIG-&gt;create( $keyfile );

               $tsig = Net::DNS::RR::TSIG-&gt;create(
                                       $keyfile,
                                       fudge =&gt; 300
                                       );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Class for DNS Transaction Signature (TSIG) resource records.

</pre><h4><b>METHODS</b></h4><pre>
       The available methods are those inherited from the base class augmented by the type-specific methods
       defined in this package.

       Use of undocumented package features or direct access to internal data structures is discouraged and
       could result in program termination or other unpredictable behaviour.

   <b>algorithm</b>
               $algorithm = $rr-&gt;algorithm;
               $rr-&gt;algorithm( $algorithm );

       A domain name which specifies the name of the algorithm.

   <b>key</b>
               $rr-&gt;key( $key );

       Base64 representation of the key material.

   <b>keybin</b>
               $rr-&gt;keybin( $keybin );

       Binary representation of the key material.

   <b>time_signed</b>
               $time_signed = $rr-&gt;time_signed;
               $rr-&gt;time_signed( $time_signed );

       Signing time as the number of seconds since 1 Jan 1970 00:00:00 UTC.  The default signing time is the
       current time.

   <b>fudge</b>
               $fudge = $rr-&gt;fudge;
               $rr-&gt;fudge( $fudge );

       "fudge" represents the permitted error in the signing time.  The default fudge is 300 seconds.

   <b>mac</b>
               $rr-&gt;mac( $mac );

       Message authentication code (MAC).  The programmer must call the Net::DNS::Packet <b>data()</b> object method
       before this will return anything meaningful.

   <b>macbin</b>
               $macbin = $rr-&gt;macbin;
               $rr-&gt;macbin( $macbin );

       Binary message authentication code (MAC).

   <b>prior_mac</b>
               $prior_mac = $rr-&gt;prior_mac;
               $rr-&gt;prior_mac( $prior_mac );

       Prior message authentication code (MAC).

   <b>prior_macbin</b>
               $prior_macbin = $rr-&gt;prior_macbin;
               $rr-&gt;prior_macbin( $prior_macbin );

       Binary prior message authentication code.

   <b>request_mac</b>
               $request_mac = $rr-&gt;request_mac;
               $rr-&gt;request_mac( $request_mac );

       Request message authentication code (MAC).

   <b>request_macbin</b>
               $request_macbin = $rr-&gt;request_macbin;
               $rr-&gt;request_macbin( $request_macbin );

       Binary request message authentication code.

   <b>original_id</b>
               $original_id = $rr-&gt;original_id;
               $rr-&gt;original_id( $original_id );

       The message ID from the header of the original packet.

   <b>error</b>
   <b>vrfyerrstr</b>
               $rcode = $tsig-&gt;error;

       Returns the RCODE covering TSIG processing.  Common values are NOERROR, BADSIG, BADKEY, and BADTIME.  See
       RFC8945 for details.

   <b>other</b>
               $other = $tsig-&gt;other;

       This field should be empty unless the error is BADTIME, in which case it will contain the server time as
       the number of seconds since 1 Jan 1970 00:00:00 UTC.

   <b>sig_function</b>
               sub signing_function {
                       my ( $keybin, $data ) = @_;

                       my $hmac = Digest::HMAC-&gt;new( $keybin, 'Digest::MD5' );
                       hmac-&gt;add( $data );
                       return $hmac-&gt;digest;
               }

               $tsig-&gt;sig_function( \&amp;signing_function );

       This sets the signing function to be used for this TSIG record.  The default signing function is
       HMAC-MD5.

   <b>sig_data</b>
               $sigdata = $tsig-&gt;sig_data($packet);

       Returns the packet packed according to RFC8945 in a form for signing. This is only needed if you want to
       supply an external signing function, such as is needed for TSIG-GSS.

   <b>create</b>
               $tsig = Net::DNS::RR::TSIG-&gt;create( $keyfile );

               $tsig = Net::DNS::RR::TSIG-&gt;create(
                                       $keyfile,
                                       fudge =&gt; 300
                                       );

       Returns a TSIG RR constructed using the parameters in the specified key file, which is assumed to have
       been generated by tsig-keygen.

   <b>verify</b>
               $verify = $tsig-&gt;verify( $data );
               $verify = $tsig-&gt;verify( $packet );

               $verify = $tsig-&gt;verify( $reply,  $query );

               $verify = $tsig-&gt;verify( $packet, $prior );

       The boolean verify method will return true if the hash over the packet data conforms to the data in the
       TSIG itself

</pre><h4><b>TSIG</b> <b>Keys</b></h4><pre>
       The TSIG authentication mechanism employs a shared secret key to establish a trust relationship between
       two entities.

       It should be noted that it is possible for more than one key to be in use simultaneously between any such
       pair of entities.

       TSIG keys are generated using the tsig-keygen utility distributed with ISC BIND:

               tsig-keygen -a HMAC-SHA256 host1-host2.example.

       Other algorithms may be substituted for HMAC-SHA256 in the above example.

       These keys must be protected in a manner similar to private keys, lest a third party masquerade as one of
       the intended parties by forging the message authentication code (MAC).

</pre><h4><b>Configuring</b> <b>BIND</b> <b>Nameserver</b></h4><pre>
       The generated key must be added to the /etc/named.conf configuration or a separate file introduced by the
       $INCLUDE directive:

               key "host1-host2.example. {
                       algorithm hmac-sha256;
                       secret "Secret+known+only+by+participating+entities=";
               };

</pre><h4><b>ACKNOWLEDGMENT</b></h4><pre>
       Most of the code in the Net::DNS::RR::TSIG module was contributed by Chris Turbeville.

       Support for external signing functions was added by Andrew Tridgell.

       Support for HMAC-SHA1, HMAC-SHA224, HMAC-SHA256, HMAC-SHA384, HMAC-SHA512 and BIND keyfile handling was
       added by Dick Franks.

</pre><h4><b>BUGS</b></h4><pre>
       A 32-bit representation of time is used, contrary to RFC8945 which demands 48 bits.  This design decision
       will need to be reviewed before the code stops working on 7 February 2106.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c)2000,2001 Michael Fuhr.

       Portions Copyright (c)2002,2003 Chris Reinhardt.

       Portions Copyright (c)2013,2020 Dick Franks.

       All rights reserved.

       Package template (c)2009,2012 O.M.Kolkman and R.W.Franks.

</pre><h4><b>LICENSE</b></h4><pre>
       Permission to use, copy, modify, and distribute this software and its documentation for any purpose and
       without fee is hereby granted, provided that the original copyright notices appear in all copies and that
       both copyright notice and this permission notice appear in supporting documentation, and that the name of
       the author not be used in advertising or publicity pertaining to distribution of the software without
       specific prior written permission.

       THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT
       LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO
       EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
       IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR
       THE USE OR OTHER DEALINGS IN THE SOFTWARE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       perl Net::DNS Net::DNS::RR RFC8945 &lt;https://iana.org/go/rfc8945&gt;

       TSIG Algorithm Names &lt;https://iana.org/assignments/tsig-algorithm-names&gt;

       BIND Administrator Reference Manual &lt;https://bind9.readthedocs.io/en/latest/&gt;

perl v5.40.1                                       2025-03-05                            <u>Net::DNS::RR::<a href="../man3pm/TSIG.3pm.html">TSIG</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>