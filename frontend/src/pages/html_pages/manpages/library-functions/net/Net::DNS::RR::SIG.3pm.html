<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::DNS::RR::SIG - DNS SIG resource record</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-dns-perl">libnet-dns-perl_1.50-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::DNS::RR::SIG - DNS SIG resource record

</pre><h4><b>SYNOPSIS</b></h4><pre>
               use Net::DNS;
               $rr = Net::DNS::RR-&gt;new('name SIG typecovered algorithm labels
                                       orgttl sigexpiration siginception
                                       keytag signame signature');

               use Net::DNS::SEC;
               $sigrr = Net::DNS::RR::SIG-&gt;create(
                                       $string, $keypath,
                                       sigval =&gt; 10    # minutes
                                       );

               $sigrr-&gt;verify( $string, $keyrr ) || die $sigrr-&gt;vrfyerrstr;
               $sigrr-&gt;verify( $packet, $keyrr ) || die $sigrr-&gt;vrfyerrstr;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Class for DNS digital signature (SIG) resource records.

       In addition to the regular methods inherited from Net::DNS::RR the class contains a method to sign
       packets and scalar data strings using private keys (create) and a method for verifying signatures.

       The SIG RR is an implementation of RFC2931.  See Net::DNS::RR::RRSIG for an implementation of RFC4034.

</pre><h4><b>METHODS</b></h4><pre>
       The available methods are those inherited from the base class augmented by the type-specific methods
       defined in this package.

       Use of undocumented package features or direct access to internal data structures is discouraged and
       could result in program termination or other unpredictable behaviour.

   <b>algorithm</b>
               $algorithm = $rr-&gt;algorithm;

       The algorithm number field identifies the cryptographic algorithm used to create the signature.

       <b>algorithm()</b> may also be invoked as a class method or simple function to perform mnemonic and numeric code
       translation.

   <b>sigexpiration</b> <b>and</b> <b>siginception</b> <b>times</b>
   <b>sigex</b> <b>sigin</b> <b>sigval</b>
               $expiration = $rr-&gt;sigexpiration;
               $expiration = $rr-&gt;sigexpiration( $value );

               $inception = $rr-&gt;siginception;
               $inception = $rr-&gt;siginception( $value );

       The signature expiration and inception fields specify a validity time interval for the signature.

       The value may be specified by a string with format 'yyyymmddhhmmss' or a Perl <b>time()</b> value.

       Return values are dual-valued, providing either a string value or numerical Perl <b>time()</b> value.

   <b>keytag</b>
               $keytag = $rr-&gt;keytag;
               $rr-&gt;keytag( $keytag );

       The keytag field contains the key tag value of the KEY RR that validates this signature.

   <b>signame</b>
               $signame = $rr-&gt;signame;
               $rr-&gt;signame( $signame );

       The signer name field value identifies the owner name of the KEY RR that a validator is supposed to use
       to validate this signature.

   <b>signature</b>
   <b>sig</b>
               $sig = $rr-&gt;sig;
               $rr-&gt;sig( $sig );

       The Signature field contains the cryptographic signature that covers the SIG RDATA (excluding the
       Signature field) and the subject data.

   <b>sigbin</b>
               $sigbin = $rr-&gt;sigbin;
               $rr-&gt;sigbin( $sigbin );

       Binary representation of the cryptographic signature.

   <b>create</b>
       Create a signature over scalar data.

               use Net::DNS::SEC;

               $keypath = '/home/olaf/keys/Kbla.foo.+001+60114.private';

               $sigrr = Net::DNS::RR::SIG-&gt;create( $data, $keypath );

               $sigrr = Net::DNS::RR::SIG-&gt;create(
                                       $data, $keypath,
                                       sigval =&gt; 10
                                       );
               $sigrr-&gt;print;

               # Alternatively use Net::DNS::SEC::Private

               $private = Net::DNS::SEC::Private-&gt;new($keypath);

               $sigrr= Net::DNS::RR::SIG-&gt;create( $data, $private );

       <b>create()</b> is an alternative constructor for a SIG RR object.

       This method returns a SIG with the signature over the data made with the private key stored in the key
       file.

       The first argument is a scalar that contains the data to be signed.

       The second argument is a string which specifies the path to a file containing the private key as
       generated using dnssec-keygen, a program that comes with the ISC BIND distribution.

       The optional remaining arguments consist of ( name =&gt; value ) pairs as follows:

               sigin  =&gt; 20241201010101,       # signature inception
               sigex  =&gt; 20241201011101,       # signature expiration
               sigval =&gt; 10,                   # validity window (minutes)

       The sigin and sigex values may be specified as Perl time values or as a string with the format
       'yyyymmddhhmmss'. The default for sigin is the time of signing.

       The sigval argument specifies the signature validity window in minutes ( sigex = sigin + sigval ).

       By default the signature is valid for 10 minutes.

   <b>verify</b>
               $verify = $sigrr-&gt;verify( $data, $keyrr );
               $verify = $sigrr-&gt;verify( $data, [$keyrr, $keyrr2, $keyrr3] );

       The <b>verify()</b> method performs SIG0 verification of the specified data against the signature contained in
       the $sigrr object itself using the public key in $keyrr.

       If a reference to a Net::DNS::Packet is supplied, the method performs a SIG0 verification on the packet
       data.

       The second argument can either be a Net::DNS::RR::KEYRR object or a reference to an array of such
       objects. Verification will return successful as soon as one of the keys in the array leads to positive
       validation.

       Returns false on error and sets $sig-&gt;vrfyerrstr

   <b>vrfyerrstr</b>
               $sig0 = $packet-&gt;sigrr || die 'not signed';
               print $sig0-&gt;vrfyerrstr unless $sig0-&gt;verify( $packet, $keyrr );

               $sigrr-&gt;verify( $packet, $keyrr ) || die $sigrr-&gt;vrfyerrstr;

</pre><h4><b>KEY</b> <b>GENERATION</b></h4><pre>
       Private key files and corresponding public DNSKEY records are most conveniently generated using dnssec-
       keygen, a program that comes with the ISC BIND distribution.

               dnssec-keygen -a 10 -b 2048 rsa.example.

               dnssec-keygen -a 13 -f ksk  ecdsa.example.
               dnssec-keygen -a 13         ecdsa.example.

       Do not change the name of the private key file.  The create method uses the filename as generated by
       dnssec-keygen to determine the keyowner, algorithm, and the keyid (keytag).

</pre><h4><b>REMARKS</b></h4><pre>
       The code is not optimised for speed.

       If this code is still around in 2100 (not a leap year) you will need to check for proper handling of
       times after 28th February.

</pre><h4><b>ACKNOWLEDGMENTS</b></h4><pre>
       Although their original code may have disappeared following redesign of Net::DNS, Net::DNS::SEC and the
       OpenSSL API, the following individual contributors deserve to be recognised for their significant
       influence on the development of the SIG package.

       Andy Vaskys (Network Associates Laboratories) supplied code for RSA.

       T.J. Mather provided support for the DSA algorithm.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c)2001-2005 RIPE NCC,   Olaf M. Kolkman

       Copyright (c)2007-2008 NLnet Labs, Olaf M. Kolkman

       Portions Copyright (c)2014 Dick Franks

       All rights reserved.

       Package template (c)2009,2012 O.M.Kolkman and R.W.Franks.

</pre><h4><b>LICENSE</b></h4><pre>
       Permission to use, copy, modify, and distribute this software and its documentation for any purpose and
       without fee is hereby granted, provided that the original copyright notices appear in all copies and that
       both copyright notice and this permission notice appear in supporting documentation, and that the name of
       the author not be used in advertising or publicity pertaining to distribution of the software without
       specific prior written permission.

       THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT
       LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO
       EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
       IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR
       THE USE OR OTHER DEALINGS IN THE SOFTWARE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       perl Net::DNS Net::DNS::RR Net::DNS::SEC <b><a href="../man4/RFC2535.4.html">RFC2535</a></b>(4) &lt;https://iana.org/go/rfc2535#section-4&gt; RFC2936
       &lt;https://iana.org/go/rfc2936&gt; RFC2931 &lt;https://iana.org/go/rfc2931&gt; RFC3110 &lt;https://iana.org/go/rfc3110&gt;
       RFC4034 &lt;https://iana.org/go/rfc4034&gt;

       Algorithm Numbers &lt;https://iana.org/assignments/dns-sec-alg-numbers&gt;

       BIND Administrator Reference Manual &lt;https://bind9.readthedocs.io/en/latest/&gt;

perl v5.40.1                                       2025-03-05                             <u>Net::DNS::RR::<a href="../man3pm/SIG.3pm.html">SIG</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>