<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>unload - Unload machine code</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl9.0-doc">tcl9.0-doc_9.0.1+dfsg-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       unload - Unload machine code

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>unload</b> ?<u>switches</u>? <u>fileName</u>
       <b>unload</b> ?<u>switches</u>? <u>fileName</u> <u>prefix</u>
       <b>unload</b> ?<u>switches</u>? <u>fileName</u> <u>prefix</u> <u>interp</u>
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  command tries to unload shared libraries previously loaded with <b>load</b> from the application's address
       space.  <u>fileName</u> is the name of the file containing the library file to be unload;  it must be  the  same
       as  the  filename  provided  to  <b>load</b>  for  loading  the  library.  The <u>prefix</u> argument is the prefix (as
       determined by or passed to <b>load</b>), and is used to compute  the  name  of  the  unload  procedure;  if  not
       supplied,  it is computed from <u>fileName</u> in the same manner as <b>load</b>.  The <u>interp</u> argument is the path name
       of the interpreter from which to unload the package (see the <b>interp</b> manual entry for details); if  <u>interp</u>
       is omitted, it defaults to the interpreter in which the <b>unload</b> command was invoked.

       If  the  initial  arguments  to  <b>unload</b>  start  with  <b>-</b> then they are treated as switches.  The following
       switches are currently supported:

       <b>-nocomplain</b>
              Suppresses all error messages. If this switch is given, <b>unload</b> will never report an error.

       <b>-keeplibrary</b>
              This switch will prevent <b>unload</b> from issuing the  operating  system  call  that  will  unload  the
              library from the process.

       <b>--</b>     Marks  the end of switches.  The argument following this one will be treated as a <u>fileName</u> even if
              it starts with a <b>-</b>.

   <b>UNLOAD</b> <b>OPERATION</b>
       When a file containing a shared library is loaded through the <b>load</b> command, Tcl associates two  reference
       counts  to  the  library  file.  The  first counter shows how many times the library has been loaded into
       normal (trusted) interpreters while the second describes how many times the library has been loaded  into
       safe  interpreters.  As a file containing a shared library can be loaded only once by Tcl (with the first
       <b>load</b> call on the file), these counters track how many interpreters use the library.  Each subsequent call
       to <b>load</b> after the first simply increments the proper reference count.

       <b>unload</b> works in the opposite direction. As a first  step,  <b>unload</b>  will  check  whether  the  library  is
       unloadable: an unloadable library exports a special unload procedure. The name of the unload procedure is
       determined  by  <u>prefix</u>  and whether or not the target interpreter is a safe one.  For normal interpreters
       the name of the initialization procedure will have the form <u>pfx</u><b>_Unload</b>, where <u>pfx</u> is the same  as  <u>prefix</u>
       except  that  the  first  letter  is converted to upper case and all other letters are converted to lower
       case.  For example, if <u>prefix</u> is <b>foo</b> or <b>FOo</b>, the initialization procedure's name will be <b>Foo_Unload</b>.   If
       the  target  interpreter  is  a  safe  interpreter, then the name of the initialization procedure will be
       <u>pkg</u><b>_SafeUnload</b> instead of <u>pkg</u><b>_Unload</b>.

       If <b>unload</b> determines that a library is not unloadable (or unload functionality has been  disabled  during
       compilation),  an error will be returned.  If the library is unloadable, then <b>unload</b> will call the unload
       procedure. If the unload procedure returns <b>TCL_OK</b>, <b>unload</b> will proceed and decrease the proper  reference
       count  (depending on the target interpreter type). When both reference counts have reached 0, the library
       will be detached from the process.

   <b>UNLOAD</b> <b>HOOK</b> <b>PROTOTYPE</b>
       The unload procedure must match the following prototype:

              typedef int <b>Tcl_LibraryUnloadProc</b>(
                      Tcl_Interp *<u>interp</u>,
                      int <u>flags</u>);

       The <u>interp</u> argument identifies the interpreter from which the library is  to  be  unloaded.   The  unload
       procedure  must  return <b>TCL_OK</b> or <b>TCL_ERROR</b> to indicate whether or not it completed successfully;  in the
       event of an error it should set the interpreter's result to point to an error message.  In this case, the
       result of the <b>unload</b> command will be the result returned by the unload procedure.

       The <u>flags</u> argument can be either <b>TCL_UNLOAD_DETACH_FROM_INTERPRETER</b> or <b>TCL_UNLOAD_DETACH_FROM_PROCESS</b>. In
       case the library will remain attached to the process after the unload procedure returns (i.e. because the
       library is used by other interpreters), <b>TCL_UNLOAD_DETACH_FROM_INTERPRETER</b> will be defined.  However,  if
       the  library is used only by the target interpreter and the library will be detached from the application
       as   soon   as   the   unload   procedure   returns,   the   <u>flags</u>    argument    will    be    set    to
       <b>TCL_UNLOAD_DETACH_FROM_PROCESS</b>.

   <b>NOTES</b>
       The  <b>unload</b> command cannot unload libraries that are statically linked with the application.  If <u>fileName</u>
       is an empty string, then the <u>prefix</u> argument must be specified.

       If <u>prefix</u> is omitted or specified as an empty string, Tcl tries to guess the prefix.  This  may  be  done
       differently  on  different platforms. The default guess, which is used on most UNIX platforms, is to take
       the last element of <u>fileName</u>, strip off the first three characters if they are <b>lib</b>, then  strip  off  the
       next  three  characters  if  they  are <b>tcl9</b>, and use any following wordchars but not digits, converted to
       titlecase as the prefix.  For example, the command <b>unload</b>  <b>libxyz4.2.so</b>  uses  the  prefix  <b>Xyz</b>  and  the
       command <b>unload</b> <b>bin/last.so</b> <b>{}</b> uses the prefix <b>Last</b>.

</pre><h4><b>PORTABILITY</b> <b>ISSUES</b></h4><pre>
       <b>Unix</b>   Not  all  unix  operating systems support library unloading. Under such an operating system <b>unload</b>
              returns an error (unless <b>-nocomplain</b> has been specified).

</pre><h4><b>BUGS</b></h4><pre>
       If the same file is <b>load</b>ed by different <u>fileName</u>s, it will be loaded into  the  process's  address  space
       multiple times.  The behavior of this varies from system to system (some systems may detect the redundant
       loads,  others  may  not). In case a library has been silently detached by the operating system (and as a
       result Tcl thinks the library is still loaded), it may be dangerous to use <b>unload</b> on such a  library  (as
       the library will be completely detached from the application while some interpreters will continue to use
       it).

</pre><h4><b>EXAMPLE</b></h4><pre>
       If  an  unloadable  module  in  the  file <b>foobar.dll</b> had been loaded using the <b>load</b> command like this (on
       Windows):

              load c:/some/dir/foobar.dll

       then it would be unloaded like this:

              <b>unload</b> c:/some/dir/foobar.dll

       This allows a C code module to be installed temporarily into a long-running Tcl program and then  removed
       again  (either  because it is no longer needed or because it is being updated with a new version) without
       having to shut down the overall Tcl process.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       info sharedlibextension, <a href="../man3tcl/load.3tcl.html">load</a>(3tcl), <a href="../man3tcl/safe.3tcl.html">safe</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       binary code, unloading, safe interpreter, shared library

Tcl                                                    8.5                                          <u><a href="../man3tcl/unload.3tcl.html">unload</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>