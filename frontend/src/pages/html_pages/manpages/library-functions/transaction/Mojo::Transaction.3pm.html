<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mojo::Transaction - Transaction base class</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmojolicious-perl">libmojolicious-perl_9.39+dfsg-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mojo::Transaction - Transaction base class

</pre><h4><b>SYNOPSIS</b></h4><pre>
         package Mojo::Transaction::MyTransaction;
         use Mojo::Base 'Mojo::Transaction';

         sub client_read  {...}
         sub client_write {...}
         sub server_read  {...}
         sub server_write {...}

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Mojo::Transaction is an abstract base class for transactions, like Mojo::Transaction::HTTP and
       Mojo::Transaction::WebSocket.

</pre><h4><b>EVENTS</b></h4><pre>
       Mojo::Transaction inherits all events from Mojo::EventEmitter and can emit the following new ones.

   <b>connection</b>
         $tx-&gt;on(connection =&gt; sub ($tx, $connection) {...});

       Emitted when a connection has been assigned to transaction.

   <b>finish</b>
         $tx-&gt;on(finish =&gt; sub ($tx) {...});

       Emitted when transaction is finished.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       Mojo::Transaction implements the following attributes.

   <b>kept_alive</b>
         my $bool = $tx-&gt;kept_alive;
         $tx      = $tx-&gt;kept_alive($bool);

       Connection has been kept alive.

   <b>local_address</b>
         my $address = $tx-&gt;local_address;
         $tx         = $tx-&gt;local_address('127.0.0.1');

       Local interface address.

   <b>local_port</b>
         my $port = $tx-&gt;local_port;
         $tx      = $tx-&gt;<a href="../man8080/local_port.8080.html">local_port</a>(8080);

       Local interface port.

   <b>original_remote_address</b>
         my $address = $tx-&gt;original_remote_address;
         $tx         = $tx-&gt;original_remote_address('127.0.0.1');

       Remote interface address.

   <b>remote_port</b>
         my $port = $tx-&gt;remote_port;
         $tx      = $tx-&gt;<a href="../man8081/remote_port.8081.html">remote_port</a>(8081);

       Remote interface port.

   <b>req</b>
         my $req = $tx-&gt;req;
         $tx     = $tx-&gt;req(Mojo::Message::Request-&gt;new);

       HTTP request, defaults to a Mojo::Message::Request object.

         # Access request information
         my $method = $tx-&gt;req-&gt;method;
         my $url    = $tx-&gt;req-&gt;url-&gt;to_abs;
         my $info   = $tx-&gt;req-&gt;url-&gt;to_abs-&gt;userinfo;
         my $host   = $tx-&gt;req-&gt;url-&gt;to_abs-&gt;host;
         my $agent  = $tx-&gt;req-&gt;headers-&gt;user_agent;
         my $custom = $tx-&gt;req-&gt;headers-&gt;header('Custom-Header');
         my $bytes  = $tx-&gt;req-&gt;body;
         my $str    = $tx-&gt;req-&gt;text;
         my $hash   = $tx-&gt;req-&gt;params-&gt;to_hash;
         my $all    = $tx-&gt;req-&gt;uploads;
         my $value  = $tx-&gt;req-&gt;json;
         my $foo    = $tx-&gt;req-&gt;json('/23/foo');
         my $dom    = $tx-&gt;req-&gt;dom;
         my $bar    = $tx-&gt;req-&gt;dom('div.bar')-&gt;first-&gt;text;

   <b>res</b>
         my $res = $tx-&gt;res;
         $tx     = $tx-&gt;res(Mojo::Message::Response-&gt;new);

       HTTP response, defaults to a Mojo::Message::Response object.

         # Access response information
         my $code    = $tx-&gt;res-&gt;code;
         my $message = $tx-&gt;res-&gt;message;
         my $server  = $tx-&gt;res-&gt;headers-&gt;server;
         my $custom  = $tx-&gt;res-&gt;headers-&gt;header('Custom-Header');
         my $bytes   = $tx-&gt;res-&gt;body;
         my $str     = $tx-&gt;res-&gt;text;
         my $value   = $tx-&gt;res-&gt;json;
         my $foo     = $tx-&gt;res-&gt;json('/23/foo');
         my $dom     = $tx-&gt;res-&gt;dom;
         my $bar     = $tx-&gt;res-&gt;dom('div.bar')-&gt;first-&gt;text;

</pre><h4><b>METHODS</b></h4><pre>
       Mojo::Transaction inherits all methods from Mojo::EventEmitter and implements the following new ones.

   <b>client_read</b>
         $tx-&gt;client_read($bytes);

       Read data client-side, used to implement user agents such as Mojo::UserAgent. Meant to be overloaded in a
       subclass.

   <b>client_write</b>
         my $bytes = $tx-&gt;client_write;

       Write data client-side, used to implement user agents such as Mojo::UserAgent. Meant to be overloaded in
       a subclass.

   <b>closed</b>
         $tx = $tx-&gt;closed;

       Same as "completed", but also indicates that all transaction data has been sent.

   <b>completed</b>
         $tx = $tx-&gt;completed;

       Low-level method to finalize transaction.

   <b>connection</b>
         my $id = $tx-&gt;connection;
         $tx    = $tx-&gt;connection($id);

       Connection identifier.

   <b>error</b>
         my $err = $tx-&gt;error;

       Get request or response error and return "undef" if there is no error.

         # Longer version
         my $err = $tx-&gt;req-&gt;error || $tx-&gt;res-&gt;error;

         # Check for 4xx/5xx response and connection errors
         if (my $err = $tx-&gt;error) {
           die "$err-&gt;{code} response: $err-&gt;{message}" if $err-&gt;{code};
           die "Connection error: $err-&gt;{message}";
         }

   <b>is_finished</b>
         my $bool = $tx-&gt;is_finished;

       Check if transaction is finished.

   <b>is_websocket</b>
         my $bool = $tx-&gt;is_websocket;

       False, this is not a Mojo::Transaction::WebSocket object.

   <b>remote_address</b>
         my $address = $tx-&gt;remote_address;
         $tx         = $tx-&gt;remote_address('127.0.0.1');

       Same as "original_remote_address" unless "req" has been performed via a "reverse_proxy" in
       Mojo::Message::Request.  If so then the last value of "X-Forwarded-For" header is returned. Additionally
       if "trusted_proxies" in Mojo::Message::Request are also provided then the original address must be
       trusted and any "X-Forwarded-For" entries that are trusted are ignored, returning the last untrusted
       address or the first address if all are trusted.

   <b>result</b>
         my $res = $tx-&gt;result;

       Returns the Mojo::Message::Response object from "res" or dies if a connection error has occurred.

         # Fine grained response handling (dies on connection errors)
         my $res = $tx-&gt;result;
         if    ($res-&gt;is_success)  { say $res-&gt;body }
         elsif ($res-&gt;is_error)    { say $res-&gt;message }
         elsif ($res-&gt;code == 301) { say $res-&gt;headers-&gt;location }
         else                      { say 'Whatever...' }

   <b>server_read</b>
         $tx-&gt;server_read($bytes);

       Read data server-side, used to implement web servers such as Mojo::Server::Daemon. Meant to be overloaded
       in a subclass.

   <b>server_write</b>
         my $bytes = $tx-&gt;server_write;

       Write data server-side, used to implement web servers such as Mojo::Server::Daemon. Meant to be
       overloaded in a subclass.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Mojolicious, Mojolicious::Guides, &lt;https://mojolicious.org&gt;.

perl v5.40.0                                       2024-12-07                             <u>Mojo::<a href="../man3pm/Transaction.3pm.html">Transaction</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>