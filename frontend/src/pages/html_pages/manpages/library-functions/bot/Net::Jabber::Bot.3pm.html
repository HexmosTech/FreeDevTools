<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::Jabber::Bot - Automated Bot creation with safeties</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-jabber-bot-perl">libnet-jabber-bot-perl_2.1.7-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::Jabber::Bot - Automated Bot creation with safeties

</pre><h4><b>VERSION</b></h4><pre>
       Version 2.1.7

</pre><h4><b>SYNOPSIS</b></h4><pre>
       Program design: This is a Moose based Class.

       The idea behind the module is that someone creating a bot should not really have to know a whole lot
       about how the Jabber protocol works in order to use it. It also allows us to abstract away all the things
       that can get a bot maker into trouble. Essentially the object helps protect the coders from their own
       mistakes.

       All someone should have to know and define in the program away from the object is:

       1. Config - Where to connect, how often to do things, timers, etc
       2. A subroutine to be called by the bot object when a new message comes in.
       3. A subroutine to be called by the bot object every so often that lets the user do background activities
       (check logs, monitor web pages, etc.),

       The object at present has the following enforced safeties as long as you do not override safety mode:

       1. Limits messages per second, configurable at start up, (Max is 5 per second) by requiring a sleep timer
       in the message sending subroutine each time one is sent.
       2. Endless loops of responding to self prevented by now allowing the bot message processing subroutine to
       know about messages from self
       3. Forum join grace period to prevent bot from reacting to historical messages
       4. Configurable aliases the bot will respond to per forum
       5. Limits maximum message size, preventing messages that are too large from being sent (largest
       configurable message size limit is 1000).
       6. Automatic chunking of messages to split up large messages in message sending subroutine
       7. Limit on messages per hour. (max configurable limit of 125) Messages are visible via log4perl, but not
       ever be sent once the message limit is reached for that hour.

</pre><h4><b>FUNCTIONS</b></h4><pre>
       <b>new</b> Minimal:

               my $bot = Net::Jabber::Bot-&gt;new(
                   server               =&gt; 'host.domain.com', # Name of server when sending messages internally.
                   conference_server    =&gt; 'conference.host.domain.com',
                   port                 =&gt; 522,
                   username             =&gt; 'username',
                   password             =&gt; 'pasword',
                   safety_mode          =&gt; 1,
                   message_function     =&gt; \&amp;new_bot_message,
                   background_function  =&gt; \&amp;background_checks,
                   forums_and_responses =&gt; \%forum_list
               );

           All options:

               my $bot = Net::Jabber::Bot-&gt;new(
                   server                  =&gt; 'host.domain.com', # Name of server when sending messages internally.
                   conference_server       =&gt; 'conference.host.domain.com',
                   server_host             =&gt; 'talk.domain.com', # used to specify what jabber server to connect to on connect?
                   tls                     =&gt; 0,                    # set to 1 for google
                   ssl_ca_path             =&gt; '',  # path to your CA cert bundle
                   ssl_verify              =&gt; 0,   # for testing and for self-signed certificates
                   connection_type         =&gt; 'tcpip',
                   port                    =&gt; 522,
                   username                =&gt; 'username',
                   password                =&gt; 'pasword',
                   alias                   =&gt; 'cpan_bot',
                   message_function        =&gt; \&amp;new_bot_message,
                   background_function     =&gt; \&amp;background_checks,
                   loop_sleep_time         =&gt; 15,
                   process_timeout         =&gt; 5,
                   forums_and_responses    =&gt; \%forum_list,
                   ignore_server_messages  =&gt; 1,
                   ignore_self_messages    =&gt; 1,
                   out_messages_per_second =&gt; 4,
                   max_message_size        =&gt; 1000,
                   max_messages_per_hour   =&gt; 100
               );

           Set up the object and connect to the server. Hash values are passed to new as a hash.

           The following initialization variables can be passed. Only marked variables are required (TODO)

           <b>safety_mode</b>
                    safety_mode = (1,0)

                Determines  if  the  bot safety features are turned on and enforced. This mode is on by default.
                Many of the safety features are here to assure you do not crash your favorite jabber server with
                floods, etc. DO NOT turn it off unless you're sure you know what you're doing (not  just  Sledge
                Hammer ceratin)

           <b>server</b>
                Jabber server name

           <b>server_host</b>
                Defaults  to  the  same value set for 'server' above.  This is where the bot initially connects.
                For google for instance, you should set this to 'gmail.com'

           <b>conference_server</b>
                conferencee server (usually conference.$server_name)

           <b>port</b> Defaults to 5222

           <b>tls</b>  Boolean value. defaults to 0. for google, it is know that this value must be 1 to work.

           <b>ssl_ca_path</b>
                The path to your CA cert bundle. This is passed on to XML::Stream eventually.

           <b>ssl_verify</b>
                Enable or disable server certificate validity check when connecting to server. This is passed on
                to XML::Stream eventually.

           <b>connection_type</b>
                defaults to 'tcpip' also takes 'http'

           <b>username</b>
                The user you authenticate with to access the server. Not full name, just the stuff to  the  left
                of the @...

           <b>password</b>
                password to get into the server

           <b>alias</b>
                This  will  be  your  nickname  in  rooms,  as  well  as  the  login  resource (which can't have
                duplicates). I couldn't come up with any reason these should not be the same so  hardcoded  them
                to be the same.

           <b>forums_and_responses</b>
                A hash ref which lists the forum names to join as the keys and the values are an array reference
                to a list of strings they are supposed to be responsive to.  The array is order sensitive and an
                empty string means it is going to respond to all messages in this forum. Make sure you list this
                last.

                The   found  'response  string'  is  assumed  to  be  at  the  beginning  of  the  message.  The
                message_funtion function will be called with the modified string.

                    alias = jbot:, attention:

                example1:

                    message: 'jbot: help'

                    passed to callback: 'help'

           <b>message_function</b>
                The subroutine the bot will call when a new message is recieved by the bot. Only called  if  the
                bot's logic decides it's something you need to know about.

           <b>background_function</b>
                The  subroutine  the  bot  will  call  when  every so often (loop_sleep_time) to allow you to do
                background activities outside jabber stuff (check logs, web pages, etc.)

           <b>loop_sleep_time</b>
                Frequency background function is called.

           <b>process_timeout</b>
                Time <b>Process()</b> will wait if no new activity is received from the server

           <b>ignore_server_messages</b>
                Boolean value as to whether we should  ignore  messages  sent  to  us  from  the  jabber  server
                (addresses can be a little cryptic and hard to process)

           <b>ignore_self_messages</b>
                Boolean value as to whether we should ignore messages sent by us.

                BE  CAREFUL  if  you  turn this on!!! Turning this on risks potentially endless loops. If you're
                going to do this, please be sure safety is turned on at least initially.

           <b>out_messages_per_second</b>
                Limits the number of messages per second. Number must be &lt;gt&gt; 0

                default: 5

                safety: 5

           <b>max_message_size</b>
                Specify maximimum size a message can be before it's split and sent in pieces.

                default: 1,000,000

                safety: 1,000

           <b>max_messages_per_hour</b>
                Limits the number of messages per hour before we refuse to send them

                default: 125

                safety: 166

       <b>JoinForum</b>
           Joins a jabber forum and sleeps safety time. Also prevents the object from responding to messages for
           a grace period in efforts to get it to not respond to historical messages. This has failed sometimes.

           NOTE: No error detection for join failure is present at the moment. (TODO)

       <b>Process</b>
           Mostly calls it's client connection's "Process" call.  Also assures a timeout is enforced if not  fed
           to  the  subroutine You really should not have to call this very often.  You should mostly be calling
           <b>Start()</b> and just let the Bot kernel handle all this.

       <b>Start</b>
           Primary subroutine save new called by the program. Does an endless loop of:

           1. Process
           2. If Process failed, Reconnect to server over larger and larger timeout
           3. run background process fed from new, telling it who I am and how many loops we have been through.
           4. Enforce a sleep to prevent server floods.
       <b>ReconnectToServer</b>
           You should not ever need to use this. the <b>Start()</b> kernel usually figures this out and calls it.

           Internal process:

               1. Disconnects
               3. Re-initializes

       <b>Disconnect</b>
           Disconnects from server if client object is defined. Assures the client object is deleted.

       <b>IsConnected</b>
           Reports connect state (true/false) based on the status of client_start_time.

       <b>_process_jabber_message</b> - DO NOT CALL
           Handles incoming messages.

       <b>get_responses</b>
               $bot-&gt;get_ident($forum_name);

           Returns the array of messages we are monitoring for in supplied forum or replies with undef.

       <b>_jabber_in_iq_message</b> - DO NOT CALL
           Called when the client receives new messages during Process of this type.

       <b>_jabber_presence_message</b> - DO NOT CALL
           Called when the client receives new presence messages during Process.  Mostly we are just pushing the
           data down into the client DB for later processing.

       <b>respond_to_self_messages</b>
               $bot-&gt;respond_to_self_messages($value = 1);

           Tells the bot to start reacting to it\'s own messages if non-zero is passed. Default is 1.

       <b>get_messages_this_hour</b>
               $bot-&gt;get_messages_this_hour();

           replys with number of messages sent so far this hour.

       <b>get_safety_mode</b>
           Validates that we are in safety mode. Returns a bool as long as we are an object,  otherwise  returns
           undef

       <b>SendGroupMessage</b>
               $bot-&gt;SendGroupMessage($name, $message);

           Tells the bot to send a message to the recipient room name

       <b>SendPersonalMessage</b>
               $bot-&gt;SendPersonalMessage($recipient, $message);

           How to send an individual message to someone.

           $recipient must read as user@server/Resource or it will not send.

       <b>SendJabberMessage</b>
               $bot-&gt;SendJabberMessage($recipient, $message, $message_type, $subject);

           The  master  subroutine  to  send  a  message.  Called  either  by  the user, SendPersonalMessage, or
           SendGroupMessage. Sometimes there is call to call it directly when you do not feel like figuring  you
           messaged you.  Assures message size does not exceed a limit and chops it into pieces if need be.

           NOTE: non-printable characters (unicode included) will be stripped before sending to the server via:
               s/[^[:print:]]+/./xmsg

       <b>SetForumSubject</b>
               $bot-&gt;SetForumSubject($recipient, $subject);

           Sets the subject of a forum

       <b>ChangeStatus</b>
               $bot-&gt;ChangeStatus($presence_mode, $status_string);

           Sets the Bot's presence status.  $presence mode could be something like: (Chat, Available, Away, Ext.
           Away,  Do  Not  Disturb).  $status_string is an optional comment to go with your presence mode. It is
           not required.

       <b>GetRoster</b>
               $bot-&gt;GetRoster();

           Returns a list of the people logged into the server.  I suspect we really want to know who  is  in  a
           paticular forum right?  In which case we need another sub for this.

       <b>GetStatus</b>
           Need documentation from Yago on this sub.

       <b>AddUser</b>
           Need documentation from Yago on this sub.

       <b>RmUser</b>
           Need documentation from Yago on this sub.

</pre><h4><b>AUTHOR</b></h4><pre>
       Todd Rinaldo "&lt;<a href="mailto:perl-net-jabber-bot@googlegroups.com">perl-net-jabber-bot@googlegroups.com</a>) &gt;"

</pre><h4><b>BUGS</b></h4><pre>
       Please  report any bugs or feature requests to "<a href="mailto:perl-net-jabber-bot@googlegroups.com">perl-net-jabber-bot@googlegroups.com</a>", or through the web
       interface at &lt;<a href="http://code.google.com/p/perl-net-jabber-bot/issues/entry">http://code.google.com/p/perl-net-jabber-bot/issues/entry</a>&gt;.  I will be notified,  and  then
       you'll automatically be notified of progress on your bug as I make changes.

</pre><h4><b>SUPPORT</b></h4><pre>
       You can find documentation for this module with the perldoc command.

           perldoc Net::Jabber::Bot

       You can also look for information at:

       •   AnnoCPAN: Annotated CPAN documentation

           &lt;<a href="http://annocpan.org/dist/Net-Jabber-Bot">http://annocpan.org/dist/Net-Jabber-Bot</a>&gt;

       •   CPAN Ratings

           &lt;<a href="http://cpanratings.perl.org/d/Net-Jabber-Bot">http://cpanratings.perl.org/d/Net-Jabber-Bot</a>&gt;

       •   Metacpan

           &lt;https://metacpan.org/pod/Net::Jabber::Bot&gt;

       •   Github

           &lt;https://github.com/toddr/perl-net-jabber-bot&gt;

</pre><h4><b>ACKNOWLEDGEMENTS</b></h4><pre>
</pre><h4><b>COPYRIGHT</b> <b>&amp;</b> <b>LICENSE</b></h4><pre>
       Copyright 2007 Todd E Rinaldo, all rights reserved.

       This  program  is  free  software;  you can redistribute it and/or modify it under the same terms as Perl
       itself.

perl v5.34.0                                       2022-05-28                              <u>Net::Jabber::<a href="../man3pm/Bot.3pm.html">Bot</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>