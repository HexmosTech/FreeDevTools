<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::DMARC::Policy - a DMARC policy in object format</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmail-dmarc-perl">libmail-dmarc-perl_1.20240314-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::DMARC::Policy - a DMARC policy in object format

</pre><h4><b>VERSION</b></h4><pre>
       version 1.20240314

</pre><h4><b>SYNOPSIS</b></h4><pre>
        my $pol = Mail::DMARC::Policy-&gt;new(
           'v=DMARC1; p=none; rua=<a href="mailto:dmarc@example.com">mailto:dmarc@example.com</a>'
           );

        print "not a valid DMARC version!"    if $pol-&gt;v ne 'DMARC1';
        print "take no action"                if $pol-&gt;p eq 'none';
        print "reject that unaligned message" if $pol-&gt;p eq 'reject';
        print "do not send aggregate reports" if ! $pol-&gt;rua;
        print "do not send forensic reports"  if ! $pol-&gt;ruf;

</pre><h4><b>EXAMPLES</b></h4><pre>
       A DMARC record in DNS format looks like this:

           v=DMARC1; p=reject; adkim=s; aspf=s; rua=<a href="mailto:dmarc@example.com">mailto:dmarc@example.com</a>; pct=100;

       DMARC records are stored in TXT resource records in the DNS, at _dmarc.example.com. To retrieve a DMARC
       record for a domain:

   <b>dig</b>
           dig +short _dmarc.example.com TXT

   <b>perlishly</b>
           print $_-&gt;txtdata."\n"
             for Net::DNS::Resolver-&gt;new(dnsrch=&gt;0)-&gt;send('_dmarc.example.com','TXT')-&gt;answer;

   <b>dmarc_lookup</b>
           dmarc_lookup example.com

</pre><h4><b>METHODS</b></h4><pre>
       All methods validate their input against the 2013 DMARC specification. Attempts to set invalid values
       will throw exceptions.

   <b>new</b>
       Create a new empty policy:

        my $pol = Mail::DMARC::Policy-&gt;new;

       Create a new policy from named arguments:

        my $pol = Mail::DMARC::Policy-&gt;new(
                v   =&gt; 'DMARC1',
                p   =&gt; 'none',
                pct =&gt; 50,
                );

       Create a new policy from a DMARC DNS resource record:

        my $pol = Mail::DMARC::Policy-&gt;new(
                'v=DMARC1; p=reject; rua=<a href="mailto:dmarc@example.com">mailto:dmarc@example.com</a>; pct=50;'
                );

       If a policy is passed in (the latter two examples), the resulting policy object will be an exact
       representation of the record as returned from DNS.

   <b>apply_defaults</b>
       Several of the DMARC tags (adkim,aspf,fo,ri,rf) have default values when not specified in the published
       DNS record. Calling <u>apply_defaults</u> will apply those default values to the DMARC tags that were not
       specified in the DNS record. The resulting Policy object will be a perfect representation of the DMARC
       policy that is/was applied.

   <b>parse</b>
       Accepts a string containing a DMARC Resource Record, as it would be retrieved via DNS.

           my $pol = Mail::DMARC::Policy-&gt;new;
           $pol-&gt;parse( 'v=DMARC1; p=none; rua=<a href="mailto:dmarc@example.com">mailto:dmarc@example.com</a>' );
           $pol-&gt;parse( 'v=DMARC1' );       # external reporting record

</pre><h4><b>Record</b> <b>Tags</b></h4><pre>
   <b>Tag</b> <b>Overview</b>
        v=DMARC1;    (version)
        p=none;      (disposition policy : reject, quarantine, none (monitor))
        sp=reject;   (subdomain policy: same as p)
        adkim=s;     (dkim alignment: s=strict, r=relaxed)
        aspf=r;      (spf  alignment: s=strict, r=relaxed)
        rua=<a href="mailto:dmarc-feedback@example.com">mailto:dmarc-feedback@example.com</a>; (aggregate reports)
        ruf=<a href="mailto:dmarc-feedback@example.com">mailto:dmarc-feedback@example.com</a>; (forensic reports)
        rf=afrf;     (report format: afrf, iodef)
        ri=8400;     (report interval)
        pct=50;      (percent of messages to filter)

   <b>Tags</b> <b>in</b> <b>Detail</b>
       The descriptions of each DMARC record tag and its corresponding values is from the March 31, 2013 draft
       of the DMARC spec:

       https://datatracker.ietf.org/doc/draft-kucherawy-dmarc-base/?include_text=1

       Each tag has a mutator that's a setter and getter. To set any of the tag values, pass in the new value.
       Examples:

         $pol-&gt;p('none');                         set policy action to none
         print "do nothing" if $pol-&gt;p eq 'none'; get policy action

   <b>v</b>
       Version (plain-text; REQUIRED).  Identifies the record retrieved as a DMARC record.  It MUST have the
       value of "DMARC1".  The value of this tag MUST match precisely; if it does not or it is absent, the
       entire retrieved record MUST be ignored.  It MUST be the first tag in the list.

   <b>p</b>
       Requested Mail Receiver policy (plain-text; REQUIRED for policy records).  Indicates the policy to be
       enacted by the Receiver at the request of the Domain Owner.  Policy applies to the domain queried and to
       sub-domains unless sub-domain policy is explicitly described using the "sp" tag.  This tag is mandatory
       for policy records only, but not for third-party reporting records (see Section 8.2).

   <b>sp</b>
       {R6} Requested Mail Receiver policy for subdomains (plain-text; OPTIONAL).  Indicates the policy to be
       enacted by the Receiver at the request of the Domain Owner.  It applies only to subdomains of the domain
       queried and not to the domain itself.  Its syntax is identical to that of the "p" tag defined above.  If
       absent, the policy specified by the "p" tag MUST be applied for subdomains.

   <b>adkim</b>
       (plain-text; OPTIONAL, default is "r".)  Indicates whether or not strict DKIM identifier alignment is
       required by the Domain Owner.  If and only if the value of the string is "s", strict mode is in use.  See
       Section 4.3.1 for details.

   <b>aspf</b>
       (plain-text; OPTIONAL, default is "r".)  Indicates whether or not strict SPF identifier alignment is
       required by the Domain Owner.  If and only if the value of the string is "s", strict mode is in use.  See
       Section 4.3.2 for details.

   <b>fo</b>
       Failure reporting options (plain-text; OPTIONAL, default "0")) Provides requested options for generation
       of failure reports.  Report generators MAY choose to adhere to the requested options.  This tag's content
       MUST be ignored if a "ruf" tag (below) is not also specified.  The value of this tag is a colon-separated
       list of characters that indicate failure reporting options as follows:

         0: Generate a DMARC failure report if all underlying
            authentication mechanisms failed to produce an aligned "pass"
            result.

         1: Generate a DMARC failure report if any underlying
            authentication mechanism failed to produce an aligned "pass"
            result.

         d: Generate a DKIM failure report if the message had a signature
            that failed evaluation, regardless of its alignment.  DKIM-
            specific reporting is described in [AFRF-DKIM].

         s: Generate an SPF failure report if the message failed SPF
            evaluation, regardless of its alignment. SPF-specific
            reporting is described in [AFRF-SPF].

   <b>rua</b>
       Addresses to which aggregate feedback is to be sent (comma- separated plain-text list of DMARC URIs;
       OPTIONAL). {R11} A comma or exclamation point that is part of such a DMARC URI MUST be encoded per
       Section 2.1 of [URI] so as to distinguish it from the list delimiter or an OPTIONAL size limit.  Section
       8.2 discusses considerations that apply when the domain name of a URI differs from that of the domain
       advertising the policy.  See Section 15.6 for additional considerations.  Any valid URI can be specified.
       A Mail Receiver MUST implement support for a "mailto:" URI, i.e. the ability to send a DMARC report via
       electronic mail.  If not provided, Mail Receivers MUST NOT generate aggregate feedback reports.  URIs not
       supported by Mail Receivers MUST be ignored.  The aggregate feedback report format is described in
       Section 8.3.

   <b>ruf</b>
       Addresses to which message-specific failure information is to be reported (comma-separated plain-text
       list of DMARC URIs; OPTIONAL). {R11} If present, the Domain Owner is requesting Mail Receivers to send
       detailed failure reports about messages that fail the DMARC evaluation in specific ways (see the "fo" tag
       above).  The format of the message to be generated MUST follow that specified in the "rf" tag.  Section
       8.2 discusses considerations that apply when the domain name of a URI differs from that of the domain
       advertising the policy.  A Mail Receiver MUST implement support for a "mailto:" URI, i.e. the ability to
       send a DMARC report via electronic mail.  If not provided, Mail Receivers MUST NOT generate failure
       reports.  See Section 15.6 for additional considerations.

   <b>rf</b>
       Format to be used for message-specific failure reports (comma- separated plain-text list of values;
       OPTIONAL; default "afrf").  The value of this tag is a list of one or more report formats as requested by
       the Domain Owner to be used when a message fails both [SPF] and [DKIM] tests to report details of the
       individual failure.  The values MUST be present in the registry of reporting formats defined in Section
       14; a Mail Receiver observing a different value SHOULD ignore it, or MAY ignore the entire DMARC record.
       Initial default values are "afrf" (defined in [AFRF]) and "iodef" (defined in [IODEF]).  See Section 8.4
       for details.

   <b>ri</b>
       Interval requested between aggregate reports (plain-text, 32-bit unsigned integer; OPTIONAL; default
       86400). {R14} Indicates a request to Receivers to generate aggregate reports separated by no more than
       the requested number of seconds.  DMARC implementations MUST be able to provide daily reports and SHOULD
       be able to provide hourly reports when requested.  However, anything other than a daily report is
       understood to be accommodated on a best- effort basis.

   <b>pct</b>
       (plain-text integer between 0 and 100, inclusive; OPTIONAL; default is 100). {R8} Percentage of messages
       from the DNS domain's mail stream to which the DMARC mechanism is to be applied.  However, this MUST NOT
       be applied to the DMARC-generated reports, all of which must be sent and received unhindered.  The
       purpose of the "pct" tag is to allow Domain Owners to enact a slow rollout enforcement of the DMARC
       mechanism.  The prospect of "all or nothing" is recognized as preventing many organizations from
       experimenting with strong authentication-based mechanisms.  See Section 7.1 for details.

</pre><h4><b>AUTHORS</b></h4><pre>
       •   Matt Simerson &lt;<a href="mailto:msimerson@cpan.org">msimerson@cpan.org</a>&gt;

       •   Davide Migliavacca &lt;<a href="mailto:shari@cpan.org">shari@cpan.org</a>&gt;

       •   Marc Bradshaw &lt;<a href="mailto:marc@marcbradshaw.net">marc@marcbradshaw.net</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       This software is copyright (c) 2024 by Matt Simerson.

       This  is  free  software;  you  can  redistribute  it and/or modify it under the same terms as the Perl 5
       programming language system itself.

perl v5.38.2                                       2024-08-21                           <u>Mail::DMARC::<a href="../man3pm/Policy.3pm.html">Policy</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>