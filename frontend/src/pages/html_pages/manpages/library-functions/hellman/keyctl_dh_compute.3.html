<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>keyctl_dh_compute - Compute a Diffie-Hellman shared secret or public key</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libkeyutils-dev">libkeyutils-dev_1.6.3-6ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       keyctl_dh_compute - Compute a Diffie-Hellman shared secret or public key
       keyctl_dh_compute_kdf - Derive key from a Diffie-Hellman shared secret

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;keyutils.h&gt;</b>

       <b>long</b> <b>keyctl_dh_compute(key_serial_t</b> <u>private</u><b>,</b> <b>key_serial_t</b> <u>prime</u><b>,</b>
       <b>key_serial_t</b> <u>base</u><b>,</b> <b>char</b> <b>*</b><u>buffer</u><b>,</b> <b>size_t</b> <u>buflen</u><b>);</b>

       <b>long</b> <b>keyctl_dh_compute_alloc(key_serial_t</b> <u>private,</u>
       <b>key_serial_t</b> <u>prime</u><b>,</b> <b>key_serial_t</b> <u>base</u><b>,</b> <b>void</b> <b>**_</b><u>buffer</u><b>);</b>

       <b>long</b> <b>keyctl_dh_compute_kdf(key_serial_t</b> <u>private</u><b>,</b> <b>key_serial_t</b> <u>prime</u><b>,</b>
       <b>key_serial_t</b> <u>base</u><b>,</b> <b>char</b> <b>*</b><u>hashname</u><b>,</b> <b>char</b> <b>*</b><u>otherinfo</u><b>,</b>
       <b>size_t</b> <u>otherinfolen</u><b>,</b> <b>char</b> <b>*</b><u>buffer</u><b>,</b> <b>size_t</b> <u>buflen</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>keyctl_dh_compute</b>() computes a Diffie-Hellman public key or shared secret.  That computation is:

              <u>base</u> ^ <u>private</u> ( mod <u>prime</u> )

       When  <u>base</u>  is a key containing the shared generator value, the remote public key is computed.  When <u>base</u>
       is a key containing the remote public key, the shared secret is computed.

       <u>base</u>, <u>private</u>, and <u>prime</u> must all refer to <b>user</b>-type keys containing the parameters for the  computation.
       Each of these keys must grant the caller <b>read</b> permission in order for them to be used.

       <u>buffer</u>  and <u>buflen</u> specify the buffer into which the computed result will be placed.  <u>buflen</u> may be zero,
       in which case the buffer is not used and the minimum buffer length is fetched.

       <b>keyctl_dh_compute_alloc</b>() is similar to <b>keyctl_dh_compute</b>() except that it allocates a buffer big  enough
       to  hold the payload data and places the data in it.  If successful, a pointer to the buffer is placed in
       <u>*_buffer</u>.  The caller must free the buffer.

       <b>keyctl_dh_compute_kdf</b>() derives a key from a Diffie-Hellman  shared  secret  according  to  the  protocol
       specified  in  SP800-56A. The Diffie-Hellman computation is based on the same primitives as discussed for
       <b>keyctl_dh_compute</b>().

       To implement the protocol of SP800-56A <u>base</u> is a key containing the remote  public  key  to  compute  the
       Diffie-Hellman shared secret. That shared secret is post-processed with a key derivation function.

       The  <u>hashname</u>  specifies  the  Linux  kernel  crypto  API  name for a hash that shall be used for the key
       derivation function, such as sha256.  The <u>hashname</u> must be a NULL terminated  string.   See  <u><a href="file:/proc/crypto">/proc/crypto</a></u>
       for available hashes on the system.

       Following  the  specification  of  SP800-56A section 5.8.1.2 the <u>otherinfo</u> parameter may be provided. The
       format of the OtherInfo field is defined by the caller. The caller may  also  specify  NULL  as  a  valid
       argument  when  no  OtherInfo data shall be processed. The length of the <u>otherinfo</u> parameter is specified
       with <u>otherinfolen</u> and is restricted to a maximum length by the kernel.

       The KDF returns the requested number of bytes specified with the <u>genlen</u> or the <u>buflen</u> parameter depending
       on the invoked function.

       <u>buffer</u> and <u>buflen</u> specify the buffer into which the computed result will be placed.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success <b>keyctl_dh_compute</b>() returns the amount of data placed into the buffer when <u>buflen</u> is non-zero.
       When <u>buflen</u> is zero, the minimum buffer length to hold the data is returned.

       On success <b>keyctl_dh_compute_alloc</b>() returns the amount of data in the buffer.

       On error, both functions set errno to an appropriate code and return the value <b>-1</b>.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>ENOKEY</b> One of the keys specified is invalid or not readable.

       <b>EINVAL</b> The buffer pointer is invalid or buflen is too small.

       <b>EOPNOTSUPP</b>
              One of the keys was not a valid user key.

       <b>EMSGSIZE</b>
              When using <b>keyctl_dh_compute_kdf</b>(), the size of either <u>otherinfolen</u> or <u>buflen</u> is too big.

</pre><h4><b>LINKING</b></h4><pre>
       This is a library function that can  be  found  in  <u>libkeyutils</u>.   When  linking,  <b>-lkeyutils</b>  should  be
       specified to the linker.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/keyctl.1.html">keyctl</a></b>(1),
       <b><a href="../man2/keyctl.2.html">keyctl</a></b>(2),
       <b><a href="../man3/keyctl.3.html">keyctl</a></b>(3),
       <b><a href="../man7/keyutils.7.html">keyutils</a></b>(7)

Linux                                              07 Apr 2016                              <u><a href="../man3/KEYCTL_DH_COMPUTE.3.html">KEYCTL_DH_COMPUTE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>