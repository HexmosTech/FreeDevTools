<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hwlocality_tinker - Modifying a loaded Topology</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libhwloc-doc">libhwloc-doc_2.12.0-4build1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       hwlocality_tinker - Modifying a loaded Topology

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Enumerations</b>
       enum <b>hwloc_restrict_flags_e</b> { <b>HWLOC_RESTRICT_FLAG_REMOVE_CPULESS</b>, <b>HWLOC_RESTRICT_FLAG_BYNODESET</b> =
           (1UL&lt;&lt;3), <b>HWLOC_RESTRICT_FLAG_REMOVE_MEMLESS</b>, <b>HWLOC_RESTRICT_FLAG_ADAPT_MISC</b>,
           <b>HWLOC_RESTRICT_FLAG_ADAPT_IO</b> }
       enum <b>hwloc_allow_flags_e</b> { <b>HWLOC_ALLOW_FLAG_ALL</b>, <b>HWLOC_ALLOW_FLAG_LOCAL_RESTRICTIONS</b>,
           <b>HWLOC_ALLOW_FLAG_CUSTOM</b> }

   <b>Functions</b>
       int <b>hwloc_topology_restrict</b> (<b>hwloc_topology_t</b> restrict topology, <b>hwloc_const_bitmap_t</b> set, unsigned long
           flags)
       int <b>hwloc_topology_allow</b> (<b>hwloc_topology_t</b> restrict topology, <b>hwloc_const_cpuset_t</b> cpuset,
           <b>hwloc_const_nodeset_t</b> nodeset, unsigned long flags)
       <b>hwloc_obj_t</b> <b>hwloc_topology_insert_misc_object</b> (<b>hwloc_topology_t</b> topology, <b>hwloc_obj_t</b> parent, const char
           *name)
       <b>hwloc_obj_t</b> <b>hwloc_topology_alloc_group_object</b> (<b>hwloc_topology_t</b> topology)
       int <b>hwloc_topology_free_group_object</b> (<b>hwloc_topology_t</b> topology, <b>hwloc_obj_t</b> group)
       <b>hwloc_obj_t</b> <b>hwloc_topology_insert_group_object</b> (<b>hwloc_topology_t</b> topology, <b>hwloc_obj_t</b> group)
       int <b>hwloc_obj_add_other_obj_sets</b> (<b>hwloc_obj_t</b> dst, <b>hwloc_obj_t</b> src)
       int <b>hwloc_topology_refresh</b> (<b>hwloc_topology_t</b> topology)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
</pre><h4><b>Enumeration</b> <b>Type</b> <b>Documentation</b></h4><pre>
   <b>enum</b> <b>hwloc_allow_flags_e</b>
       Flags to be given to <b>hwloc_topology_allow()</b>.

       <b>Enumerator</b>

       <u>HWLOC_ALLOW_FLAG_ALL</u>
              Mark  all  objects  as allowed in the topology. cpuset and nođeset given to <b>hwloc_topology_allow()</b>
              must be NULL.

       <u>HWLOC_ALLOW_FLAG_LOCAL_RESTRICTIONS</u>
              Only  allow  objects  that  are  available  to  the  current  process.  The  topology  must   have
              <b>HWLOC_TOPOLOGY_FLAG_IS_THISSYSTEM</b> so that the set of available resources can actually be retrieved
              from the operating system.

       cpuset and nođeset given to <b>hwloc_topology_allow()</b> must be NULL.

       <u>HWLOC_ALLOW_FLAG_CUSTOM</u>
              Allow  a  custom  set  of  objects,  given  to  <b>hwloc_topology_allow()</b>  as  cpuset  and/or nodeset
              parameters.

   <b>enum</b> <b>hwloc_restrict_flags_e</b>
       Flags to be given to <b>hwloc_topology_restrict()</b>.

       <b>Enumerator</b>

       <u>HWLOC_RESTRICT_FLAG_REMOVE_CPULESS</u>
              Remove all objects that became CPU-less. By default, only objects that contain no PU and no memory
              are removed. This flag may not be used with <b>HWLOC_RESTRICT_FLAG_BYNODESET</b>.

       <u>HWLOC_RESTRICT_FLAG_BYNODESET</u>
              Restrict by nodeset instead of CPU set. Only keep objects whose nodeset is included  or  partially
              included in the given set. This flag may not be used with <b>HWLOC_RESTRICT_FLAG_REMOVE_CPULESS</b>.

       <u>HWLOC_RESTRICT_FLAG_REMOVE_MEMLESS</u>
              Remove  all  objects  that  became Memory-less. By default, only objects that contain no PU and no
              memory are removed. This flag may only be used with <b>HWLOC_RESTRICT_FLAG_BYNODESET</b>.

       <u>HWLOC_RESTRICT_FLAG_ADAPT_MISC</u>
              Move Misc objects to ancestors if their parents are removed during restriction. If  this  flag  is
              not set, Misc objects are removed when their parents are removed.

       <u>HWLOC_RESTRICT_FLAG_ADAPT_IO</u>
              Move I/O objects to ancestors if their parents are removed during restriction. If this flag is not
              set, I/O devices and bridges are removed when their parents are removed.

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>int</b> <b>hwloc_obj_add_other_obj_sets</b> <b>(hwloc_obj_t</b> <b>dst,</b> <b>hwloc_obj_t</b> <b>src)</b>
       Setup object cpusets/nodesets by OR'ing another object's sets. For each defined cpuset or nodeset in src,
       allocate the corresponding set in dst and add src to it by OR'ing sets.

       This      function      is      convenient      between      <b>hwloc_topology_alloc_group_object()</b>      and
       <b>hwloc_topology_insert_group_object()</b>. It builds the sets of the new Group that will be inserted as a  new
       intermediate parent of several objects.

       <b>Returns</b>
           0 on success.

           -1 with errno set to ENOMEM if some internal reallocation failed.

   <b>hwloc_obj_t</b> <b>hwloc_topology_alloc_group_object</b> <b>(hwloc_topology_t</b> <b>topology)</b>
       Allocate  a Group object to insert later with <b>hwloc_topology_insert_group_object()</b>. This function returns
       a new Group object.

       The caller should (at least) initialize its sets  before  inserting  the  object  in  the  topology,  see
       <b>hwloc_topology_insert_group_object()</b>.  Or  it  may decide not to insert and just free the group object by
       calling <b>hwloc_topology_free_group_object()</b>.

       <b>Returns</b>
           The allocated object on success.

           NULL on error.

       <b>Note</b>
           If successfully inserted by <b>hwloc_topology_insert_group_object()</b>, the object will be freed  when  the
           entire  topology  is  freed.  If insertion failed (e.g. NULL or empty CPU and node-sets), it is freed
           before returning the error.

   <b>int</b>    <b>hwloc_topology_allow</b>    <b>(hwloc_topology_t</b>    <b>restrict</b>    <b>topology,</b>    <b>hwloc_const_cpuset_t</b>     <b>cpuset,</b>
       <b>hwloc_const_nodeset_t</b> <b>nodeset,</b> <b>unsigned</b> <b>long</b> <b>flags)</b>
       Change  the  sets  of  allowed  PUs  and  NUMA  nodes  in  the  topology. This function only works if the
       <b>HWLOC_TOPOLOGY_FLAG_INCLUDE_DISALLOWED</b> was set on the topology. It does not modify any  object,  it  only
       changes        the       sets       returned       by       <b>hwloc_topology_get_allowed_cpuset()</b>       and
       <b>hwloc_topology_get_allowed_nodeset()</b>.

       It is notably useful when importing a topology from another process running in a different Linux Cgroup.

       flags must be set to one flag among <b>hwloc_allow_flags_e</b>.

       <b>Returns</b>
           0 on success, -1 on error.

       <b>Note</b>
           Removing objects from a topology should rather be performed with <b>hwloc_topology_restrict()</b>.

   <b>int</b> <b>hwloc_topology_free_group_object</b> <b>(hwloc_topology_t</b> <b>topology,</b> <b>hwloc_obj_t</b> <b>group)</b>
       Free a group object allocated with <b>hwloc_topology_alloc_group_object()</b>. This function is only  useful  if
       the group object was not given to <b>hwloc_topology_insert_group_object()</b> as planned.

       <b>Note</b>
           topology must be the same as the one previously passed to <b>hwloc_topology_alloc_group_object()</b>.

       <b>Returns</b>
           0 on success.

           -1 on error, for instance if an invalid topology is given.

   <b>hwloc_obj_t</b> <b>hwloc_topology_insert_group_object</b> <b>(hwloc_topology_t</b> <b>topology,</b> <b>hwloc_obj_t</b> <b>group)</b>
       Add  more  structure  to the topology by adding an intermediate Group. The caller should first allocate a
       new Group object with <b>hwloc_topology_alloc_group_object()</b>. Then it must setup at least one of its CPU  or
       node  sets  to  specify the final location of the Group in the topology. Then the object can be passed to
       this function for actual insertion in the topology.

       The main use case for this function is to group a subset of siblings among the list of children  below  a
       single  parent.  For instance, if grouping 4 cores out of a 8-core socket, the logical list of cores will
       be reordered so that the 4 grouped ones are consecutive. Then, if needed, a new depth  is  added  between
       the  parent  and those children, and the Group is inserted there. At the end, the 4 grouped cores are now
       children of the Group, which replaces them as a child of the original parent.

       In practice, the grouped objects are specified  through  cpusets  and/or  nodesets,  for  instance  using
       <b>hwloc_obj_add_other_obj_sets()</b>  iteratively.  Hence it is possible to group objects that are not children
       of the same parent, for instance some PUs below the 4 cores in example above. However this  general  case
       may  fail  if the expected Group conflicts with the existing hierarchy. For instance if each core has two
       PUs, it is not possible to insert a Group containing a single PU of each core.

       To specify the objects to group, either the cpuset or nodeset field (or both, if compatible) must be  set
       to  a  non-empty  bitmap.  The  complete_cpuset  or complete_nodeset may be set instead if inserting with
       respect to the complete topology (including disallowed, offline or unknown objects). These sets cannot be
       larger than the current topology, or they would get restricted silently. The core will  setup  the  other
       sets after actual insertion.

       The  subtype  object attribute may be defined with <b>hwloc_obj_set_subtype()</b> to display something else than
       'Group' as the type name for this object in lstopo. Custom  name-value  info  pairs  may  be  added  with
       <b>hwloc_obj_add_info()</b> after insertion.

       The  group  dont_merge  attribute may be set to 1 to prevent the hwloc core from ever merging this object
       with another hierarchically-identical object. This is useful when the Group itself describes an important
       feature that cannot be exposed anywhere else in the hierarchy.

       The group kind attribute may be set to a high value such as 0xffffffff to tell hwloc that this new  Group
       should always be discarded in favor of any existing Group with the same locality.

       <b>Note</b>
           Inserting  a group adds some locality information to the topology, hence the existing objects may get
           reordered (including PUs and NUMA nodes), and their logical indexes may change.

           If the insertion fails, the input group object is freed.

           If  the  group  object  should  be  discarded  instead   of   inserted,   it   may   be   passed   to
           <b>hwloc_topology_free_group_object()</b> instead.

           topology must be the same as the one previously passed to <b>hwloc_topology_alloc_group_object()</b>.

       <b>Returns</b>
           The inserted object if it was properly inserted.

           An  existing  object  if  the Group was merged or discarded because the topology already contained an
           object at the same location (the Group did not add any hierarchy information).

           NULL if the insertion failed because of conflicting sets in topology tree.

           NULL if Group objects are filtered-out of the topology (<b>HWLOC_TYPE_FILTER_KEEP_NONE</b>).

           NULL if the object was discarded because no set was initialized in the Group before insert, or all of
           them were empty.

   <b>hwloc_obj_t</b> <b>hwloc_topology_insert_misc_object</b> <b>(hwloc_topology_t</b> <b>topology,</b> <b>hwloc_obj_t</b> <b>parent,</b>  <b>const</b>  <b>char</b>  <b>*</b>
       <b>name)</b>
       Add  a  MISC  object  as  a leaf of the topology. A new MISC object will be created and inserted into the
       topology at the position given by parent. It is appended to the list of existing Misc  children,  without
       ever adding any intermediate hierarchy level. This is useful for annotating the topology without actually
       changing the hierarchy.

       name is supposed to be unique across all Misc objects in the topology. It will be duplicated to setup the
       new object attributes.

       The new leaf object will not have any cpuset.

       The subtype object attribute may be defined with <b>hwloc_obj_set_subtype()</b> after successful insertion.

       <b>Returns</b>
           the newly-created object

           NULL on error.

           NULL if Misc objects are filtered-out of the topology (<b>HWLOC_TYPE_FILTER_KEEP_NONE</b>).

       <b>Note</b>
           If  name  contains  some  non-printable  characters,  they will be dropped when exporting to XML, see
           <b>hwloc_topology_export_xml()</b> in <b>hwloc/export.h</b>.

   <b>int</b> <b>hwloc_topology_refresh</b> <b>(hwloc_topology_t</b> <b>topology)</b>
       Refresh internal structures after topology modification. Modifying the topology (by  restricting,  adding
       objects,  modifying  structures  such  as  distances  or memory attributes, etc.) may cause some internal
       caches to become invalid. These caches are automatically refreshed when accessed but this  refreshing  is
       not thread-safe.

       This  function is not thread-safe either, but it is a good way to end a non-thread-safe phase of topology
       modification. Once this refresh is done, multiple threads may concurrently consult the topology, objects,
       distances, attributes, etc.

       See also <b>Thread</b> <b>Safety</b>

       <b>Returns</b>
           0 on success.

           -1 on error, for instance if some internal reallocation failed.

   <b>int</b> <b>hwloc_topology_restrict</b> <b>(hwloc_topology_t</b> <b>restrict</b>  <b>topology,</b>  <b>hwloc_const_bitmap_t</b>  <b>set,</b>  <b>unsigned</b>  <b>long</b>
       <b>flags)</b>
       Restrict  the topology to the given CPU set or nodeset. Topology topology is modified so as to remove all
       objects that are not included (or partially included) in the CPU set set. All objects CPU and  node  sets
       are restricted accordingly.

       By  default,  set is a CPU set. It means that the set of PUs in the topology is restricted. Once some PUs
       got removed, their parents may also get removed recursively if they became child-less.

       If <b>HWLOC_RESTRICT_FLAG_BYNODESET</b> is passed in flags, set is considered a nodeset instead of a CPU set. It
       means that the set of NUMA nodes in the topology is restricted (instead of PUs). Once some NUMA nodes got
       removed, their parents may also get removed recursively if they became child-less.

       flags is a OR'ed set of <b>hwloc_restrict_flags_e</b>.

       <b>Note</b>
           Restricting the topology removes some locality information,  hence  the  remaining  objects  may  get
           reordered (including PUs and NUMA nodes), and their logical indexes may change.

           This  call  may not be reverted by restricting back to a larger set. Once dropped during restriction,
           objects may not be brought back, except by loading another topology with <b>hwloc_topology_load()</b>.

       <b>Returns</b>
           0 on success.

           -1 with errno set to EINVAL if the input set is invalid. The topology is not modified in this case.

           -1 with errno set to ENOMEM on failure to allocate internal data. The topology  is  reinitialized  in
           this  case.  It  should  be  either  destroyed with <b>hwloc_topology_destroy()</b> or configured and loaded
           again.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for Hardware Locality (hwloc) from the source code.

Hardware Locality (hwloc)                        Version 2.12.0                             <u><a href="../man3/hwlocality_tinker.3.html">hwlocality_tinker</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>