<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_set_mode, SSL_CTX_clear_mode, SSL_set_mode, SSL_clear_mode, SSL_CTX_get_mode, SSL_get_mode -</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_set_mode, SSL_CTX_clear_mode, SSL_set_mode, SSL_clear_mode, SSL_CTX_get_mode, SSL_get_mode -
       manipulate SSL engine mode

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        long SSL_CTX_set_mode(SSL_CTX *ctx, long mode);
        long SSL_CTX_clear_mode(SSL_CTX *ctx, long mode);
        long SSL_set_mode(SSL *ssl, long mode);
        long SSL_clear_mode(SSL *ssl, long mode);

        long SSL_CTX_get_mode(SSL_CTX *ctx);
        long SSL_get_mode(SSL *ssl);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_CTX_set_mode()</b> adds the mode set via bit-mask in <b>mode</b> to <b>ctx</b>.  Options already set before are not
       cleared.  <b>SSL_CTX_clear_mode()</b> removes the mode set via bit-mask in <b>mode</b> from <b>ctx</b>.

       <b>SSL_set_mode()</b> adds the mode set via bit-mask in <b>mode</b> to <b>ssl</b>.  Options already set before are not
       cleared.  <b>SSL_clear_mode()</b> removes the mode set via bit-mask in <b>mode</b> from <b>ssl</b>.

       <b>SSL_CTX_get_mode()</b> returns the mode set for <b>ctx</b>.

       <b>SSL_get_mode()</b> returns the mode set for <b>ssl</b>.

</pre><h4><b>NOTES</b></h4><pre>
       The following mode changes are available:

       SSL_MODE_ENABLE_PARTIAL_WRITE
           Allow  SSL_write_ex(...,  n,  &amp;r)  to  return  with 0 &lt; r &lt; n (i.e. report success when just a single
           record has been written). This works in a similar way for <b>SSL_write()</b>. When not  set  (the  default),
           <b>SSL_write_ex()</b>  or  <b>SSL_write()</b>  will  only  report success once the complete chunk was written. Once
           <b>SSL_write_ex()</b> or <b>SSL_write()</b> returns successful, <b>r</b> bytes have been written  and  the  next  call  to
           <b>SSL_write_ex()</b> or <b>SSL_write()</b> must only send the n-r bytes left, imitating the behaviour of <b>write()</b>.

           This mode cannot be enabled while in the middle of an incomplete write operation.

       SSL_MODE_ACCEPT_MOVING_WRITE_BUFFER
           Make  it  possible  to  retry  <b>SSL_write_ex()</b> or <b>SSL_write()</b> with changed buffer location (the buffer
           contents must stay the same). This is not the default to avoid  the  misconception  that  nonblocking
           <b>SSL_write()</b> behaves like nonblocking <b>write()</b>.

       SSL_MODE_AUTO_RETRY
           During  normal  operations,  non-application  data records might need to be sent or received that the
           application is not aware of.  If a non-application data  record  was  processed,  <b><a href="../man3/SSL_read_ex.3.html">SSL_read_ex</a></b>(3)  and
           <b><a href="../man3/SSL_read.3.html">SSL_read</a></b>(3)  can  return  with a failure and indicate the need to retry with <b>SSL_ERROR_WANT_READ</b>.  If
           such a non-application data record was processed, the flag <b>SSL_MODE_AUTO_RETRY</b> causes it  to  try  to
           process the next record instead of returning.

           In  a  nonblocking  environment  applications  must  be  prepared  to  handle  incomplete  read/write
           operations.  Setting <b>SSL_MODE_AUTO_RETRY</b> for a nonblocking  <b>BIO</b>  will  process  non-application  data
           records until either no more data is available or an application data record has been processed.

           In  a blocking environment, applications are not always prepared to deal with the functions returning
           intermediate reports such as retry requests, and setting the <b>SSL_MODE_AUTO_RETRY</b> flag will cause  the
           functions to only return after successfully processing an application data record or a failure.

           Turning off <b>SSL_MODE_AUTO_RETRY</b> can be useful with blocking <b>BIO</b>s in case they are used in combination
           with something like <b>select()</b> or <b>poll()</b>.  Otherwise the call to <b>SSL_read()</b> or <b>SSL_read_ex()</b> might hang
           when a non-application record was sent and no application data was sent.

       SSL_MODE_RELEASE_BUFFERS
           When  we  no  longer need a read buffer or a write buffer for a given SSL, then release the memory we
           were using to hold it.  Using this flag can save around 34k per idle SSL connection.  This  flag  has
           no effect on SSL v2 connections, or on DTLS connections.

       SSL_MODE_SEND_FALLBACK_SCSV
           Send  TLS_FALLBACK_SCSV  in  the  ClientHello.   To be set only by applications that reconnect with a
           downgraded protocol version; see draft-ietf-tls-downgrade-scsv-00 for details.

           DO NOT ENABLE THIS if your application attempts a  normal  handshake.   Only  use  this  in  explicit
           fallback retries, following the guidance in draft-ietf-tls-downgrade-scsv-00.

       SSL_MODE_ASYNC
           Enable  asynchronous  processing.  TLS  I/O operations may indicate a retry with SSL_ERROR_WANT_ASYNC
           with this mode set if an asynchronous capable engine is used to perform cryptographic operations. See
           <b><a href="../man3/SSL_get_error.3.html">SSL_get_error</a></b>(3).

       SSL_MODE_DTLS_SCTP_LABEL_LENGTH_BUG
           Older versions of OpenSSL had a bug in the computation of the label length  used  for  computing  the
           endpoint-pair  shared secret. The bug was that the terminating zero was included in the length of the
           label. Setting this option  enables  this  behaviour  to  allow  interoperability  with  such  broken
           implementations.   Please  note  that  setting  this  option  breaks  interoperability  with  correct
           implementations. This option only applies to DTLS over SCTP.

       All modes are off by default except for SSL_MODE_AUTO_RETRY which is on by default since 1.1.1.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_CTX_set_mode()</b> and <b>SSL_set_mode()</b> return the new mode bit-mask after adding <b>mode</b>.

       <b>SSL_CTX_get_mode()</b> and <b>SSL_get_mode()</b> return the current bit-mask.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_read_ex.3.html">SSL_read_ex</a></b>(3), <b><a href="../man3/SSL_read.3.html">SSL_read</a></b>(3), <b><a href="../man3/SSL_write_ex.3.html">SSL_write_ex</a></b>(3) or <b><a href="../man3/SSL_write.3.html">SSL_write</a></b>(3), <b><a href="../man3/SSL_get_error.3.html">SSL_get_error</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       SSL_MODE_ASYNC was added in OpenSSL 1.1.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2001-2023 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                             <u><a href="../man3SSL/SSL_CTX_SET_MODE.3SSL.html">SSL_CTX_SET_MODE</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>