<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proc::PID::File - a module to manage process id files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libproc-pid-file-perl">libproc-pid-file-perl_1.27-4.1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Proc::PID::File - a module to manage process id files

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Proc::PID::File;
         die "Already running!" if Proc::PID::File-&gt;running();

       Process that spawn child processes may want to protect each separately by using multiple <u>pidfiles</u>.

         my $child1 = Proc::PID::File-&gt;new(name =&gt; "lock.1");
         my $child2 = Proc::PID::File-&gt;new(name =&gt; "lock.2");

       which may be checked like this:

         &lt;do-something&gt; if $child1-&gt;alive();

       and should be released manually:

         $child1-&gt;release();

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This Perl module is useful for writers of daemons and other processes that need to tell whether they are
       already running, in order to prevent multiple process instances.  The module accomplishes this via
       *nix-style <u>pidfiles</u>, which are files that store a process identifier.

       The module provides two interfaces: 1) a simple call, and 2) an object-oriented interface

</pre><h4><b>Simple</b> <b>Interface</b></h4><pre>
       The simple interface consists of a call as indicated in the first example of the <b>Synopsis</b> section above.
       This approach avoids causing race conditions whereby one instance of a daemon could read the <u>pidfile</u>
       after a previous instance has read it but before it has had a chance to write to it.

   <b>running</b> <b>[hash[-ref]]</b>
       The parameter signature for this function is identical to that of the <u>-&gt;<b>new()</b></u> method described below in
       the <b>OO</b> <b>Interface</b> section of this document. The method's return value is the same as that of <u>-&gt;<b>alive()</b></u>.

</pre><h4><b>OO</b> <b>Interface</b></h4><pre>
       The following methods are provided:

   <b>new</b> <b>[hash[-ref]]</b>
       This method is used to create an instance object.  It automatically calls the <u>-&gt;<b>file()</b></u> method described
       below and receives the same paramters.  For a listing of valid keys in this hash please refer to the
       aforementioned method documentation below.

       In addition to the above, the following constitute valid keys:

       <u>verify</u> = 1 | string
           This parameter implements the second solution outlined in the WARNING section of this document and is
           used  to  verify that an existing <u>pidfile</u> correctly represents a live process other than the current.
           If set to a string, it will be interpreted as a <u>regular</u> <u>expression</u> and used to search within the name
           of the running process.  Alternatively, a 1 may be passed: For Linux/FreeBSD, this indicates that the
           value of <u>$0</u> will be used (stripped of  its  full  path);  for  Cygwin,  <u>$^X</u>  (stripped  of  path  and
           extension) will be used.

           If  the parameter is not passed, no verification will take place.  Please note that verification will
           only work for the operating systems listed below and that the  OS  will  be  auto-sensed.   See  also
           DEPENDENCIES section below.

           Supported platforms: Linux, FreeBSD, Cygwin

       <u>debug</u>
           Any  non-zero  value  turns  debugging output on.  Additionally, if a string is passed containing the
           character <b>M</b>, the module name will be prefixed to the debugging output.

   <b>file</b> <b>[hash[-ref]]</b>
       Use this method to set the path of the <u>pidfile</u>.  The method receives an optional hash (or hash reference)
       with the keys listed below, from which it makes a path of the format: <u>$dir/$name.pid</u>.

       <u>dir</u> Specifies the directory to place the pid file.  If left unspecified, defaults to <u><a href="file:/var/run">/var/run</a></u>.

       <u>name</u>
           Indicates the name of the current process.  When not specified, defaults to <u>basename($0)</u>.

   <b>alive</b>
       Returns true when the process is already running.  Please note  that  this  call  must  be  made  *after*
       daemonisation  i.e.  subsequent  to  the  call  to <b>fork()</b>. If the <b>verify</b> flag was set during the instance
       creation, the process id is verified, alternatively the flag may be passed directly to this method.

   <b>touch</b>
       Causes for the current process id to be written to the <u>pidfile</u>.

   <b>release</b>
       This method is used to delete the <u>pidfile</u> and is automatically called by DESTROY method.  It should  thus
       be unnecessary to call it directly.

   <b>locktime</b> <b>[hash[-ref]]</b>
       This method returns the <u>mtime</u> of the <u>pidfile</u>.

</pre><h4><b>AUTHOR</b></h4><pre>
       Erick Calder &lt;<a href="mailto:ecalder@cpan.org">ecalder@cpan.org</a>&gt;

</pre><h4><b>ACKNOWLEDGEMENTS</b></h4><pre>
       1k thx to Steven Haryanto &lt;<a href="mailto:steven@haryan.to">steven@haryan.to</a>&gt; whose package (Proc::RID_File) inspired this implementation.

       Our  gratitude  also  to  Alan  Ferrency &lt;<a href="mailto:alan@pair.com">alan@pair.com</a>&gt; for fingering the boot-up problem and suggesting
       possible solutions.

</pre><h4><b>DEPENDENCIES</b></h4><pre>
       For Linux, FreeBSD and Cygwin, support of the <u>verify</u> option requires availability of the <b>ps</b> utility.  For
       Linux/FreeBSD This is typically found in the <b>procps</b> package. Cygwin users need to run version  1.5.20  or
       later for this to work.

</pre><h4><b>WARNING</b></h4><pre>
       This  module  may  prevent  daemons  from  starting  at system boot time.  The problem occurs because the
       process id written to the <u>pidfile</u> by an instance of the daemon may coincidentally be  reused  by  another
       process after a system restart, thus making the daemon think it's already running.

       Some  ideas  on  how to fix this problem are catalogued below, but unfortunately, no platform-independent
       solutions have yet been gleaned.

       - leaving the <u>pidfile</u> open for the duration of the daemon's life
       - checking a "ps" to make sure the pid is what one expects (current implementation)
       - looking at <a href="file:/proc/">/proc/</a>$PID/stat for a process name
       - check mtime of the pidfile versus uptime; don't trust old pidfiles
       - try to get the script to nuke its pidfile when it exits (this is vulnerable to hardware resets and hard
       reboots)
       - try to nuke the pidfile at boot time before the script runs; this solution suffers from a race
       condition wherein two instances read the <u>pidfile</u> before one manages to lock it, thus allowing two
       instances to run simultaneously.

</pre><h4><b>SUPPORT</b></h4><pre>
       For help and thank you notes, e-mail the author directly.  To report a bug, submit a patch or add to  our
       wishlist please visit the CPAN bug manager at: <u><a href="http://rt.cpan.org">http://rt.cpan.org</a></u>

</pre><h4><b>AVAILABILITY</b></h4><pre>
       The  latest  version  of  the  tarball,  RPM  and  SRPM  may  always  be  found at: <u><a href="http://perl.arix.com/">http://perl.arix.com/</a></u>
       Additionally the module is available from CPAN.

</pre><h4><b>LICENCE</b></h4><pre>
       This utility is free and distributed under GPL, the Gnu Public License.   A  copy  of  this  license  was
       included  in  a  file  called  LICENSE.  If  for  some  reason,  this  file  was not included, please see
       <u><a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a></u> to obtain a copy of this license.

       $Id: File.pm,v 1.16 2004-04-08 02:27:25 ekkis Exp $

perl v5.32.0                                       2021-01-01                                          <u><a href="../man3pm/File.3pm.html">File</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>