<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rte_mbuf_dyn.h</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/dpdk-doc">dpdk-doc_24.11.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rte_mbuf_dyn.h

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdint.h">stdint.h</a>&gt;

   <b>Data</b> <b>Structures</b>
       struct <b>rte_mbuf_dynfield</b>
       struct <b>rte_mbuf_dynflag</b>

   <b>Macros</b>
       #define <b>RTE_MBUF_DYN_NAMESIZE</b>   64
       #define <b>RTE_MBUF_DYNFIELD</b>(m,  offset,  type)   ((type)((uintptr_t)(m) + (offset)))
       #define <b>RTE_MBUF_DYNFIELD_TIMESTAMP_NAME</b>   'rte_dynfield_timestamp'
       #define <b>RTE_MBUF_DYNFLAG_RX_TIMESTAMP_NAME</b>   'rte_dynflag_rx_timestamp'
       #define <b>RTE_MBUF_DYNFLAG_TX_TIMESTAMP_NAME</b>   'rte_dynflag_tx_timestamp'
       #define <b>RTE_MBUF_DYNFIELD_IP_REASSEMBLY_NAME</b>   'rte_dynfield_ip_reassembly'

   <b>Functions</b>
       int <b>rte_mbuf_dynfield_register</b> (const struct <b>rte_mbuf_dynfield</b> *params)
       int <b>rte_mbuf_dynfield_register_offset</b> (const struct <b>rte_mbuf_dynfield</b> *params, size_t offset)
       int <b>rte_mbuf_dynfield_lookup</b> (const char *name, struct <b>rte_mbuf_dynfield</b> *params)
       int <b>rte_mbuf_dynflag_register</b> (const struct <b>rte_mbuf_dynflag</b> *params)
       int <b>rte_mbuf_dynflag_register_bitnum</b> (const struct <b>rte_mbuf_dynflag</b> *params, unsigned int bitnum)
       int <b>rte_mbuf_dynflag_lookup</b> (const char *name, struct <b>rte_mbuf_dynflag</b> *params)
       void <b>rte_mbuf_dyn_dump</b> (FILE *out)
       int <b>rte_mbuf_dyn_rx_timestamp_register</b> (int *field_offset, uint64_t *rx_flag)
       int <b>rte_mbuf_dyn_tx_timestamp_register</b> (int *field_offset, uint64_t *tx_flag)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       RTE Mbuf dynamic fields and flags

       Many DPDK features require to store data inside the mbuf. As the room in mbuf structure is limited, it is
       not possible to have a field for each feature. Also, changing fields in the mbuf structure can break the
       API or ABI.

       This module addresses this issue, by enabling the dynamic registration of fields or flags:

       • a  dynamic field is a named area in the <b>rte_mbuf</b> structure, with a given size (&gt;= 1 byte) and alignment
         constraint.

       • a dynamic flag is a named bit in the <b>rte_mbuf</b> structure, stored in mbuf-&gt;ol_flags.

       The placement of the field or flag can be automatic, in this case the zones that have the  smallest  size
       and  alignment  constraint are selected in priority. Else, a specific field offset or flag bit number can
       be requested through the API.

       The typical use case is when a specific offload feature requires to register a dedicated offload field in
       the mbuf structure, and adding a static field or flag is not justified.

       Example of use:

       • A <b>rte_mbuf_dynfield</b> structure is defined,  containing  the  parameters  of  the  dynamic  field  to  be
         registered: const struct <b>rte_mbuf_dynfield</b> rte_dynfield_my_feature = { ... };

       • The  application  initializes  the  PMD,  and  asks  for this feature at port initialization by passing
         RTE_ETH_RX_OFFLOAD_MY_FEATURE in rxconf. This will make the  PMD  to  register  the  field  by  calling
         rte_mbuf_dynfield_register(&amp;rte_dynfield_my_feature). The PMD stores the returned offset.

       • The application that uses the offload feature also registers the field to retrieve the same offset.

       • When the PMD receives a packet, it can set the field: *RTE_MBUF_DYNFIELD(m, offset, &lt;type *&gt;) = value;

       • In the main loop, the application can retrieve the value with the same macro.

       To  avoid wasting space, the dynamic fields or flags must only be reserved on demand, when an application
       asks for the related feature.

       The registration can be done at any moment, but it is not possible to unregister fields or flags for now.

       A dynamic field can be reserved and used by an application only. It can for instance be a packet mark.

       To avoid namespace collisions, the dynamic mbuf field or flag names have to be chosen with  care.  It  is
       advised to use the same conventions than function names in dpdk:

       •

       •

       •

       • any name that does not start with 'rte_' in an application

       Definition in file <b>rte_mbuf_dyn.h</b>.

</pre><h4><b>Macro</b> <b>Definition</b> <b>Documentation</b></h4><pre>
   <b>#define</b> <b>RTE_MBUF_DYN_NAMESIZE</b>   <b>64</b>
       Maximum length of the dynamic field or flag string.

       Definition at line <b>80</b> of file <b>rte_mbuf_dyn.h</b>.

   <b>#define</b> <b>RTE_MBUF_DYNFIELD(m,</b> <b>offset,</b> <b>type)</b>   <b>((type)((uintptr_t)(m)</b> <b>+</b> <b>(offset)))</b>
       Helper macro to access to a dynamic field.

       Definition at line <b>227</b> of file <b>rte_mbuf_dyn.h</b>.

   <b>#define</b> <b>RTE_MBUF_DYNFIELD_TIMESTAMP_NAME</b>   <b>'rte_dynfield_timestamp'</b>
       The  timestamp  dynamic  field  provides  some timing information, the units and time references (initial
       phase) are not explicitly defined but are maintained always the same for a given port. Some devices allow
       to query <b>rte_eth_read_clock()</b> that will return the current device timestamp.  The  dynamic  Tx  timestamp
       flag  tells  whether the field contains actual timestamp value for the packets being sent, this value can
       be used by PMD to schedule packet sending.

       Definition at line <b>262</b> of file <b>rte_mbuf_dyn.h</b>.

   <b>#define</b> <b>RTE_MBUF_DYNFLAG_RX_TIMESTAMP_NAME</b>   <b>'rte_dynflag_rx_timestamp'</b>
       Indicate that the timestamp field in the mbuf was filled by the driver.

       Definition at line <b>268</b> of file <b>rte_mbuf_dyn.h</b>.

   <b>#define</b> <b>RTE_MBUF_DYNFLAG_TX_TIMESTAMP_NAME</b>   <b>'rte_dynflag_tx_timestamp'</b>
       When PMD sees the RTE_MBUF_DYNFLAG_TX_TIMESTAMP_NAME flag set on  the  packet  being  sent  it  tries  to
       synchronize  the  time  of  packet  appearing  on  the  wire  with the specified packet timestamp. If the
       specified one is in the past it should be ignored, if one is in the distant future it  should  be  capped
       with some reasonable value (in range of seconds).

       There  is  no  any  packet  reordering according to timestamps is supposed, neither for packet within the
       burst, nor for the whole bursts, it is an entirely application responsibility to generate packets and its
       timestamps in desired order. The timestamps might be put only in the first packet in the burst  providing
       the entire burst scheduling.

       Definition at line <b>301</b> of file <b>rte_mbuf_dyn.h</b>.

   <b>#define</b> <b>RTE_MBUF_DYNFIELD_IP_REASSEMBLY_NAME</b>   <b>'rte_dynfield_ip_reassembly'</b>
       For   the   PMDs   which   support   IP   reassembly   of  packets,  PMD  will  update  the  packet  with
       RTE_MBUF_DYNFLAG_IP_REASSEMBLY_INCOMPLETE_NAME to denote that IP reassembly is incomplete and application
       can retrieve the packets back using RTE_MBUF_DYNFIELD_IP_REASSEMBLY_NAME.

       Definition at line <b>327</b> of file <b>rte_mbuf_dyn.h</b>.

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>int</b> <b>rte_mbuf_dynfield_register</b> <b>(const</b> <b>struct</b> <b>rte_mbuf_dynfield</b> <b>*</b> <b>params)</b>
       Register space for a dynamic field in the mbuf structure.

       If the field is already registered (same name and parameters), its offset is returned.

       <b>Parameters</b>
           <u>params</u> A structure containing the requested parameters (name, size, alignment constraint and flags).

       <b>Returns</b>
           The offset in the mbuf structure, or -1 on error. Possible values for rte_errno:

           • EINVAL: invalid parameters (size, align, or flags).

           • EEXIST: this name is already register with different parameters.

           • EPERM: called from a secondary process.

           • ENOENT: not enough room in mbuf.

           • ENOMEM: allocation failure.

           • ENAMETOOLONG: name does not ends with \0.

   <b>int</b> <b>rte_mbuf_dynfield_register_offset</b> <b>(const</b> <b>struct</b> <b>rte_mbuf_dynfield</b> <b>*</b> <b>params,</b> <b>size_t</b> <b>offset)</b>
       Register space for a dynamic field in the mbuf structure at offset.

       If the field is already registered (same name, parameters and offset), the offset is returned.

       <b>Parameters</b>
           <u>params</u> A structure containing the requested parameters (name, size, alignment constraint and flags).
           <u>offset</u> The requested offset. Ignored if SIZE_MAX is passed.

       <b>Returns</b>
           The offset in the mbuf structure, or -1 on error. Possible values for rte_errno:

           • EINVAL: invalid parameters (size, align, flags, or offset).

           • EEXIST: this name is already register with different parameters.

           • EBUSY: the requested offset cannot be used.

           • EPERM: called from a secondary process.

           • ENOENT: not enough room in mbuf.

           • ENOMEM: allocation failure.

           • ENAMETOOLONG: name does not ends with \0.

   <b>int</b> <b>rte_mbuf_dynfield_lookup</b> <b>(const</b> <b>char</b> <b>*</b> <b>name,</b> <b>struct</b> <b>rte_mbuf_dynfield</b> <b>*</b> <b>params)</b>
       Lookup for a registered dynamic mbuf field.

       <b>Parameters</b>
           <u>name</u> A string identifying the dynamic field.
           <u>params</u> If not NULL, and if the lookup is successful, the structure is filled with the  parameters  of
           the dynamic field.

       <b>Returns</b>
           The offset of this field in the mbuf structure, or -1 on error. Possible values for rte_errno:

           • ENOENT: no dynamic field matches this name.

   <b>int</b> <b>rte_mbuf_dynflag_register</b> <b>(const</b> <b>struct</b> <b>rte_mbuf_dynflag</b> <b>*</b> <b>params)</b>
       Register a dynamic flag in the mbuf structure.

       If the flag is already registered (same name and parameters), its bitnum is returned.

       <b>Parameters</b>
           <u>params</u> A structure containing the requested parameters of the dynamic flag (name and options).

       <b>Returns</b>
           The number of the reserved bit, or -1 on error. Possible values for rte_errno:

           • EINVAL: invalid parameters (size, align, or flags).

           • EEXIST: this name is already register with different parameters.

           • EPERM: called from a secondary process.

           • ENOENT: no more flag available.

           • ENOMEM: allocation failure.

           • ENAMETOOLONG: name is longer than RTE_MBUF_DYN_NAMESIZE - 1.

   <b>int</b> <b>rte_mbuf_dynflag_register_bitnum</b> <b>(const</b> <b>struct</b> <b>rte_mbuf_dynflag</b> <b>*</b> <b>params,</b> <b>unsigned</b> <b>int</b> <b>bitnum)</b>
       Register a dynamic flag in the mbuf structure specifying bitnum.

       If the flag is already registered (same name, parameters and bitnum), the bitnum is returned.

       <b>Parameters</b>
           <u>params</u> A structure containing the requested parameters of the dynamic flag (name and options).
           <u>bitnum</u> The requested bitnum. Ignored if UINT_MAX is passed.

       <b>Returns</b>
           The number of the reserved bit, or -1 on error. Possible values for rte_errno:

           • EINVAL: invalid parameters (size, align, or flags).

           • EEXIST: this name is already register with different parameters.

           • EBUSY: the requested bitnum cannot be used.

           • EPERM: called from a secondary process.

           • ENOENT: no more flag available.

           • ENOMEM: allocation failure.

           • ENAMETOOLONG: name is longer than RTE_MBUF_DYN_NAMESIZE - 1.

   <b>int</b> <b>rte_mbuf_dynflag_lookup</b> <b>(const</b> <b>char</b> <b>*</b> <b>name,</b> <b>struct</b> <b>rte_mbuf_dynflag</b> <b>*</b> <b>params)</b>
       Lookup for a registered dynamic mbuf flag.

       <b>Parameters</b>
           <u>name</u> A string identifying the dynamic flag.
           <u>params</u>  If  not NULL, and if the lookup is successful, the structure is filled with the parameters of
           the dynamic flag.

       <b>Returns</b>
           The offset of this flag in the mbuf structure, or -1 on error. Possible values for rte_errno:

           • ENOENT: no dynamic flag matches this name.

   <b>void</b> <b>rte_mbuf_dyn_dump</b> <b>(FILE</b> <b>*</b> <b>out)</b>
       Dump the status of dynamic fields and flags.

       <b>Parameters</b>
           <u>out</u> The stream where the status is displayed.

   <b>int</b> <b>rte_mbuf_dyn_rx_timestamp_register</b> <b>(int</b> <b>*</b> <b>field_offset,</b> <b>uint64_t</b> <b>*</b> <b>rx_flag)</b>
       Register dynamic mbuf field and flag for Rx timestamp.

       <b>Parameters</b>
           <u>field_offset</u> Pointer to the offset of the registered mbuf field, can  be  NULL.  The  same  field  is
           shared for Rx and Tx timestamp.
           <u>rx_flag</u> Pointer to the mask of the registered offload flag, can be NULL.

       <b>Returns</b>
           0 on success, -1 otherwise. Possible values for rte_errno:

           • EEXIST: already registered with different parameters.

           • EPERM: called from a secondary process.

           • ENOENT: no more field or flag available.

           • ENOMEM: allocation failure.

   <b>int</b> <b>rte_mbuf_dyn_tx_timestamp_register</b> <b>(int</b> <b>*</b> <b>field_offset,</b> <b>uint64_t</b> <b>*</b> <b>tx_flag)</b>
       Register dynamic mbuf field and flag for Tx timestamp.

       <b>Parameters</b>
           <u>field_offset</u>  Pointer  to  the  offset  of  the registered mbuf field, can be NULL. The same field is
           shared for Rx and Tx timestamp.
           <u>tx_flag</u> Pointer to the mask of the registered offload flag, can be NULL.

       <b>Returns</b>
           0 on success, -1 otherwise. Possible values for rte_errno:

           • EEXIST: already registered with different parameters.

           • EPERM: called from a secondary process.

           • ENOENT: no more field or flag available.

           • ENOMEM: allocation failure.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for DPDK from the source code.

DPDK                                             Version 24.11.2                               <u><a href="../man3/rte_mbuf_dyn.h.3.html">rte_mbuf_dyn.h</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>