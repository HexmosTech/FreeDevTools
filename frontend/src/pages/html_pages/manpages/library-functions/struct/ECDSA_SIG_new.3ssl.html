<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECDSA_SIG_new, ECDSA_SIG_free, ECDSA_SIG_get0, ECDSA_SIG_get0_r, ECDSA_SIG_get0_s, ECDSA_SIG_set0 -</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ECDSA_SIG_new, ECDSA_SIG_free, ECDSA_SIG_get0, ECDSA_SIG_get0_r, ECDSA_SIG_get0_s, ECDSA_SIG_set0 -
       Functions for creating, destroying and manipulating ECDSA_SIG objects

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ecdsa.h&gt;

        ECDSA_SIG *ECDSA_SIG_new(void);
        void ECDSA_SIG_free(ECDSA_SIG *sig);
        void ECDSA_SIG_get0(const ECDSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps);
        const BIGNUM *ECDSA_SIG_get0_r(const ECDSA_SIG *sig);
        const BIGNUM *ECDSA_SIG_get0_s(const ECDSA_SIG *sig);
        int ECDSA_SIG_set0(ECDSA_SIG *sig, BIGNUM *r, BIGNUM *s);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>ECDSA_SIG</b> is an opaque structure consisting of two BIGNUMs for the <u>r</u> and <u>s</u> value of an Elliptic Curve
       Digital Signature Algorithm (ECDSA) signature (see FIPS186-4 or X9.62).  The <b>ECDSA_SIG</b> object was mainly
       used by the deprecated low level functions described in <b><a href="../man3/ECDSA_sign.3.html">ECDSA_sign</a></b>(3), it is still required in order to
       be able to set or get the values of <u>r</u> and <u>s</u> into or from a signature. This is mainly used for testing
       purposes as shown in the "EXAMPLES".

       <b>ECDSA_SIG_new()</b> allocates an empty <b>ECDSA_SIG</b> structure.  Note: before OpenSSL 1.1.0, the <u>r</u> and <u>s</u>
       components were initialised.

       <b>ECDSA_SIG_free()</b> frees the <b>ECDSA_SIG</b> structure <u>sig</u>.  If the argument is NULL, nothing is done.

       <b>ECDSA_SIG_get0()</b> returns internal pointers the <u>r</u> and <u>s</u> values contained in <u>sig</u> and stores them in <u>*pr</u> and
       <u>*ps</u>, respectively.  The pointer <u>pr</u> or <u>ps</u> can be NULL, in which case the corresponding value is not
       returned.

       The values <u>r</u>, <u>s</u> can also be retrieved separately by the corresponding function <b>ECDSA_SIG_get0_r()</b> and
       <b>ECDSA_SIG_get0_s()</b>, respectively.

       Non-NULL <u>r</u> and <u>s</u> values can be set on the <u>sig</u> by calling <b>ECDSA_SIG_set0()</b>. Calling this function
       transfers the memory management of the values to the <b>ECDSA_SIG</b> object, and therefore the values that have
       been passed in should not be freed by the caller.

       See <b><a href="../man3/i2d_ECDSA_SIG.3.html">i2d_ECDSA_SIG</a></b>(3) and <b><a href="../man3/d2i_ECDSA_SIG.3.html">d2i_ECDSA_SIG</a></b>(3) for information about encoding and decoding ECDSA signatures
       to/from DER.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>ECDSA_SIG_new()</b> returns NULL if the allocation fails.

       <b>ECDSA_SIG_set0()</b> returns 1 on success or 0 on failure.

       <b>ECDSA_SIG_get0_r()</b> and <b>ECDSA_SIG_get0_s()</b> return the corresponding value, or NULL if it is unset.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Extract signature <u>r</u> and <u>s</u> values from a ECDSA <u>signature</u> of size <u>signaturelen</u>:

        ECDSA_SIG *obj;
        const BIGNUM *r, *s;

        /* Load a signature into the ECDSA_SIG object */
        obj = d2i_ECDSA_SIG(NULL, &amp;signature, signaturelen);
        if (obj == NULL)
            /* error */

        r = ECDSA_SIG_get0_r(obj);
        s = ECDSA_SIG_get0_s(obj);
        if (r == NULL || s == NULL)
            /* error */

        /* Use BN_bn2binpad() here to convert to r and s into byte arrays */

        /*
         * Do not try to access I&lt;r&gt; or I&lt;s&gt; after calling ECDSA_SIG_free(),
         * as they are both freed by this call.
         */
        ECDSA_SIG_free(obj);

       Convert <u>r</u> and <u>s</u> byte arrays into an ECDSA_SIG <u>signature</u> of size <u>signaturelen</u>:

        ECDSA_SIG *obj = NULL;
        unsigned char *signature = NULL;
        size_t signaturelen;
        BIGNUM *rbn = NULL, *sbn = NULL;

        obj = ECDSA_SIG_new();
        if (obj == NULL)
            /* error */
        rbn = BN_bin2bn(r, rlen, NULL);
        sbn = BN_bin2bn(s, slen, NULL);
        if (rbn == NULL || sbn == NULL)
            /* error */

        if (!ECDSA_SIG_set0(obj, rbn, sbn))
            /* error */
        /* Set these to NULL since they are now owned by obj */
        rbn = sbn = NULL;

        signaturelen = i2d_ECDSA_SIG(obj, &amp;signature);
        if (signaturelen &lt;= 0)
            /* error */

        /*
         * This signature could now be passed to L&lt;<a href="../man3/EVP_DigestVerify.3.html">EVP_DigestVerify</a>(3)&gt;
         * or L&lt;<a href="../man3/EVP_DigestVerifyFinal.3.html">EVP_DigestVerifyFinal</a>(3)&gt;
         */

        BN_free(rbn);
        BN_free(sbn);
        OPENSSL_free(signature);
        ECDSA_SIG_free(obj);

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       ANSI X9.62, US Federal Information Processing Standard FIPS186-4 (Digital Signature Standard, DSS)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EC_KEY_new.3.html">EC_KEY_new</a></b>(3), <b><a href="../man3/EVP_DigestSignInit.3.html">EVP_DigestSignInit</a></b>(3), <b><a href="../man3/EVP_DigestVerifyInit.3.html">EVP_DigestVerifyInit</a></b>(3), <b><a href="../man3/EVP_PKEY_sign.3.html">EVP_PKEY_sign</a></b>(3) <b><a href="../man3/i2d_ECDSA_SIG.3.html">i2d_ECDSA_SIG</a></b>(3),
       <b><a href="../man3/d2i_ECDSA_SIG.3.html">d2i_ECDSA_SIG</a></b>(3), <b><a href="../man3/ECDSA_sign.3.html">ECDSA_sign</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2004-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                <u><a href="../man3SSL/ECDSA_SIG_NEW.3SSL.html">ECDSA_SIG_NEW</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>