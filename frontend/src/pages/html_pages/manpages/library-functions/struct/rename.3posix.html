<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-posix-dev">manpages-posix-dev_2017a-2_all</a> <br><br><pre>
</pre><h4><b>PROLOG</b></h4><pre>
       This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface
       may differ (consult the corresponding Linux manual page for details of Linux behavior), or the  interface
       may not be implemented on Linux.

</pre><h4><b>NAME</b></h4><pre>
       rename, renameat — rename file

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;

       int rename(const char *<u>old</u>, const char *<u>new</u>);

       #include &lt;<a href="file:/usr/include/fcntl.h">fcntl.h</a>&gt;

       int renameat(int <u>oldfd</u>, const char *<u>old</u>, int <u>newfd</u>,
           const char *<u>new</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       For  <u>rename</u>(): The functionality described on this reference page is aligned with the ISO C standard. Any
       conflict between the requirements described here and the ISO C standard is unintentional. This volume  of
       POSIX.1‐2017 defers to the ISO C standard.

       The  <u>rename</u>()  function  shall  change the name of a file. The <u>old</u> argument points to the pathname of the
       file to be renamed. The <u>new</u> argument points to the new pathname of the file.  If the  <u>new</u>  argument  does
       not  resolve to an existing directory entry for a file of type directory and the <u>new</u> argument contains at
       least one non-&lt;slash&gt; character and ends with one or more trailing &lt;slash&gt; characters after all  symbolic
       links have been processed, <u>rename</u>() shall fail.

       If  either  the  <u>old</u>  or  <u>new</u> argument names a symbolic link, <u>rename</u>() shall operate on the symbolic link
       itself, and shall not resolve the last component of the  argument.  If  the  <u>old</u>  argument  and  the  <u>new</u>
       argument  resolve to either the same existing directory entry or different directory entries for the same
       existing file, <u>rename</u>() shall return successfully and perform no other action.

       If the <u>old</u> argument points to the pathname of a file that is not a directory, the <u>new</u> argument shall  not
       point  to  the pathname of a directory. If the link named by the <u>new</u> argument exists, it shall be removed
       and <u>old</u> renamed to <u>new</u>.  In this case, a link named <u>new</u> shall remain visible to other threads  throughout
       the renaming operation and refer either to the file referred to by <u>new</u> or <u>old</u> before the operation began.
       Write  access  permission  is required for both the directory containing <u>old</u> and the directory containing
       <u>new</u>.

       If the <u>old</u> argument points to the pathname of a directory, the  <u>new</u>  argument  shall  not  point  to  the
       pathname  of  a file that is not a directory. If the directory named by the <u>new</u> argument exists, it shall
       be removed and <u>old</u> renamed to <u>new</u>.  In this case, a link named <u>new</u> shall exist  throughout  the  renaming
       operation  and  shall refer either to the directory referred to by <u>new</u> or <u>old</u> before the operation began.
       If <u>new</u> names an existing directory, it shall be required to be an empty directory.

       If either <u>pathname</u> argument refers to a path whose final component is either  dot  or  dot-dot,  <u>rename</u>()
       shall fail.

       If  the  <u>old</u> argument points to a pathname of a symbolic link, the symbolic link shall be renamed. If the
       <u>new</u> argument points to a pathname of a symbolic link, the symbolic link shall be removed.

       The <u>old</u> pathname shall not name an ancestor directory of the <u>new</u> pathname.  Write  access  permission  is
       required  for  the directory containing <u>old</u> and the directory containing <u>new</u>.  If the <u>old</u> argument points
       to the pathname of a directory, write access permission may be required for the directory named  by  <u>old</u>,
       and, if it exists, the directory named by <u>new</u>.

       If  the  link named by the <u>new</u> argument exists and the file's link count becomes 0 when it is removed and
       no process has the file open, the space occupied by the file shall be freed and the file shall no  longer
       be  accessible. If one or more processes have the file open when the last link is removed, the link shall
       be removed before <u>rename</u>() returns, but the removal of the file contents shall  be  postponed  until  all
       references to the file are closed.

       Upon  successful  completion,  <u>rename</u>()  shall  mark  for update the last data modification and last file
       status change timestamps of the parent directory of each file.

       If the <u>rename</u>() function fails for any  reason  other  than  <b>[EIO]</b>,  any  file  named  by  <u>new</u>  shall  be
       unaffected.

       The  <u>renameat</u>() function shall be equivalent to the <u>rename</u>() function except in the case where either <u>old</u>
       or <u>new</u> specifies a relative path. If <u>old</u> is a relative path, the file to be renamed is  located  relative
       to  the  directory associated with the file descriptor <u>oldfd</u> instead of the current working directory. If
       <u>new</u> is a relative path, the same happens only relative to the directory associated with  <u>newfd</u>.   If  the
       access  mode  of  the  open  file  description  associated  with the file descriptor is not O_SEARCH, the
       function shall check whether directory searches are  permitted  using  the  current  permissions  of  the
       directory  underlying the file descriptor. If the access mode is O_SEARCH, the function shall not perform
       the check.

       If <u>renameat</u>() is passed the special value AT_FDCWD in the <u>oldfd</u> or <u>newfd</u> parameter, the  current  working
       directory shall be used in the determination of the file for the respective <u>path</u> parameter.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Upon  successful  completion,  the <u>rename</u>() function shall return 0. Otherwise, it shall return -1, <u>errno</u>
       shall be set to indicate the error, and neither the file named by <u>old</u> nor the file named by <u>new</u> shall  be
       changed or created.

       Upon successful completion, the <u>renameat</u>() function shall return 0. Otherwise, it shall return -1 and set
       <u>errno</u> to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       The <u>rename</u>() and <u>renameat</u>() functions shall fail if:

       <b>EACCES</b> A  component  of either path prefix denies search permission; or one of the directories containing
              <u>old</u> or <u>new</u> denies write permissions; or,  write  permission  is  required  and  is  denied  for  a
              directory pointed to by the <u>old</u> or <u>new</u> arguments.

       <b>EBUSY</b>  The  directory  named  by <u>old</u> or <u>new</u> is currently in use by the system or another process, and the
              implementation considers this an error.

       [EEXIST] or [ENOTEMPTY]
                   The link named by <u>new</u> is a directory that is not an empty directory.

       <b>EINVAL</b>      The <u>old</u> pathname names an ancestor directory of the <u>new</u> pathname, or either pathname argument
                   contains a final component that is dot or dot-dot.

       <b>EIO</b>         A physical I/O error has occurred.

       <b>EISDIR</b>      The <u>new</u> argument points to a directory and the <u>old</u> argument points to a file that  is  not  a
                   directory.

       <b>ELOOP</b>       A loop exists in symbolic links encountered during resolution of the <u>path</u> argument.

       <b>EMLINK</b>      The file named by <u>old</u> is a directory, and the link count of the parent directory of <u>new</u> would
                   exceed {LINK_MAX}.

       <b>ENAMETOOLONG</b>
                   The length of a component of a pathname is longer than {NAME_MAX}.

       <b>ENOENT</b>      The  link  named by <u>old</u> does not name an existing file, a component of the path prefix of <u>new</u>
                   does not exist, or either <u>old</u> or <u>new</u> points to an empty string.

       <b>ENOSPC</b>      The directory that would contain <u>new</u> cannot be extended.

       <b>ENOTDIR</b>     A component of either path prefix names an existing file that is neither a  directory  nor  a
                   symbolic  link  to  a  directory;  or the <u>old</u> argument names a directory and the <u>new</u> argument
                   names a non-directory file; or the <u>old</u> argument contains at least one  non-&lt;slash&gt;  character
                   and  ends  with one or more trailing &lt;slash&gt; characters and the last pathname component names
                   an existing file that is neither a directory nor a symbolic link to a directory; or  the  <u>old</u>
                   argument  names an existing non-directory file and the <u>new</u> argument names a nonexistent file,
                   contains at least one non-&lt;slash&gt; character, and ends  with  one  or  more  trailing  &lt;slash&gt;
                   characters;  or  the <u>new</u> argument names an existing non-directory file, contains at least one
                   non-&lt;slash&gt; character, and ends with one or more trailing &lt;slash&gt; characters.

       <b>EPERM</b> or <b>EACCES</b>
                   The S_ISVTX flag is set on the directory containing the file  referred  to  by  <u>old</u>  and  the
                   process  does  not  satisfy  the  criteria  specified  in  the  Base  Definitions  volume  of
                   POSIX.1‐2017, <u>Section</u> <u>4.3</u>, <u>Directory</u> <u>Protection</u> with respect to <u>old</u>;  or  <u>new</u>  refers  to  an
                   existing file, the S_ISVTX flag is set on the directory containing this file, and the process
                   does  not  satisfy  the  criteria  specified  in the Base Definitions volume of POSIX.1‐2017,
                   <u>Section</u> <u>4.3</u>, <u>Directory</u> <u>Protection</u> with respect to this file.

       <b>EROFS</b>       The requested operation requires writing in a directory on a read-only file system.

       <b>EXDEV</b>       The links named by <u>new</u> and <u>old</u> are on different file systems and the implementation does  not
                   support links between file systems.

       In addition, the <u>renameat</u>() function shall fail if:

       <b>EACCES</b> The  access  mode  of the open file description associated with <u>oldfd</u> or <u>newfd</u> is not O_SEARCH and
              the permissions of the directory underlying <u>oldfd</u> or <u>newfd</u>, respectively, do not permit  directory
              searches.

       <b>EBADF</b>  The  <u>old</u> argument does not specify an absolute path and the <u>oldfd</u> argument is neither AT_FDCWD nor
              a valid file descriptor open for reading or searching, or the <u>new</u> argument  does  not  specify  an
              absolute  path  and  the  <u>newfd</u>  argument is neither AT_FDCWD nor a valid file descriptor open for
              reading or searching.

       <b>ENOTDIR</b>
              The <u>old</u> or <u>new</u> argument is not an absolute path and  <u>oldfd</u>  or  <u>newfd</u>,  respectively,  is  a  file
              descriptor associated with a non-directory file.

       The <u>rename</u>() and <u>renameat</u>() functions may fail if:

       <b>EBUSY</b>  The file named by the <u>old</u> or <u>new</u> arguments is a named STREAM.

       <b>ELOOP</b>  More than {SYMLOOP_MAX} symbolic links were encountered during resolution of the <u>path</u> argument.

       <b>ENAMETOOLONG</b>
              The length of a pathname exceeds {PATH_MAX}, or pathname resolution of a symbolic link produced an
              intermediate result with a length that exceeds {PATH_MAX}.

       <b>ETXTBSY</b>
              The  file  named  by  <u>new</u> exists and is the last directory entry to a pure procedure (shared text)
              file that is being executed.

       <u>The</u> <u>following</u> <u>sections</u> <u>are</u> <u>informative.</u>

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Renaming</b> <b>a</b> <b>File</b>
       The following example shows how to rename a file named <b>/home/cnd/mod1</b> to <b>/home/cnd/mod2</b>.

           #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;

           int status;
           ...
           status = rename("/home/cnd/mod1", "/home/cnd/mod2");

</pre><h4><b>APPLICATION</b> <b>USAGE</b></h4><pre>
       Some implementations mark for update the last file status change timestamp of renamed files and  some  do
       not.  Applications  which  make  use of the last file status change timestamp may behave differently with
       respect to renamed files unless they are designed to allow for either behavior.

</pre><h4><b>RATIONALE</b></h4><pre>
       This <u>rename</u>() function is equivalent for regular files to  that  defined  by  the  ISO C  standard.   Its
       inclusion  here expands that definition to include actions on directories and specifies behavior when the
       <u>new</u> parameter names a file that already exists. That  specification  requires  that  the  action  of  the
       function be atomic.

       One  of  the  reasons  for  introducing  this  function was to have a means of renaming directories while
       permitting implementations to prohibit the use of <u>link</u>() and <u>unlink</u>() with directories, thus constraining
       links to directories to those made by <u>mkdir</u>().

       The specification that if <u>old</u> and <u>new</u> refer to the same file is intended to guarantee that:

           rename("x", "x");

       does not remove the file.

       Renaming dot or dot-dot is prohibited in order to prevent cyclical file system paths.

       See also the descriptions of <b>[ENOTEMPTY]</b> and <b>[ENAMETOOLONG]</b> in <u>rmdir</u>() and <b>[EBUSY]</b> in  <u>unlink</u>().   For  a
       discussion of <b>[EXDEV]</b>, see <u>link</u>().

       The  purpose  of the <u>renameat</u>() function is to rename files in directories other than the current working
       directory without exposure to race conditions. Any part of the  path  of  a  file  could  be  changed  in
       parallel  to  a  call to <u>rename</u>(), resulting in unspecified behavior. By opening file descriptors for the
       source and target directories and using the <u>renameat</u>() function it can be guaranteed  that  that  renamed
       file is located correctly and the resulting file is in the desired directory.

</pre><h4><b>FUTURE</b> <b>DIRECTIONS</b></h4><pre>
       None.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>link</u>(), <u>rmdir</u>(), <u>symlink</u>(), <u>unlink</u>()

       The Base Definitions volume of POSIX.1‐2017, <u>Section</u> <u>4.3</u>, <u>Directory</u> <u>Protection</u>, <b>&lt;fcntl.h&gt;</b>, <b>&lt;stdio.h&gt;</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1-2017, Standard
       for  Information  Technology  --  Portable  Operating  System  Interface  (POSIX),  The  Open  Group Base
       Specifications Issue 7, 2018 Edition, Copyright (C) 2018 by the Institute of Electrical  and  Electronics
       Engineers, Inc and The Open Group.  In the event of any discrepancy between this version and the original
       IEEE  and The Open Group Standard, the original IEEE and The Open Group Standard is the referee document.
       The original Standard can be obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any typographical or formatting errors that appear in this page are most likely to have  been  introduced
       during   the   conversion  of  the  source  files  to  man  page  format.  To  report  such  errors,  see
       https://www.kernel.org/doc/man-pages/reporting_bugs.html .

IEEE/The Open Group                                   2017                                        <u><a href="../man3POSIX/RENAME.3POSIX.html">RENAME</a></u>(3POSIX)
</pre>
 </div>
</div></section>
</div>
</body>
</html>