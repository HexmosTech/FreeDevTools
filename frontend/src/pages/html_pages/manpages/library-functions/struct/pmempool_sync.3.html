<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmempool_sync(), pmempool_transform() - pool set synchronization and transformation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpmempool-dev">libpmempool-dev_1.13.1-1.1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmempool_sync</b>(), <b>pmempool_transform</b>() - pool set synchronization and transformation

</pre><h4><b>SYNOPSIS</b></h4><pre>
              #include &lt;libpmempool.h&gt;

              int pmempool_sync(const char *poolset_file,
                  unsigned flags); (EXPERIMENTAL)
              int pmempool_transform(const char *poolset_file_src,
                  const char *poolset_file_dst, unsigned flags); (EXPERIMENTAL)

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>pmempool_sync</b>() function synchronizes data between replicas within a pool set.

       <b>pmempool_sync</b>() accepts two arguments:

       • <u>poolset_file</u> - a path to a pool set file,

       • <u>flags</u> - a combination of flags (ORed) which modify how synchronization is performed.

         NOTE: Only the pool set file used to create the pool should be used for syncing the pool.

         NOTE:  The <b>pmempool_sync</b>() cannot do anything useful if there are no replicas in the pool set.  In such
         case, it fails with an error.

         NOTE: At the moment, replication is only supported for <b><a href="../man7/libpmemobj.7.html">libpmemobj</a></b>(7) pools, so  <b>pmempool_sync</b>()  cannot
         be used with other pool types (<b><a href="../man7/libpmemlog.7.html">libpmemlog</a></b>(7), <b><a href="../man7/libpmemblk.7.html">libpmemblk</a></b>(7)).

       The following flags are available:

       • <b>PMEMPOOL_SYNC_DRY_RUN</b> - do not apply changes, only check for viability of synchronization.

       <b>pmempool_sync</b>()  checks that the metadata of all replicas in a pool set is consistent, i.e. all parts are
       healthy, and if any of them is not, the corrupted or missing parts are recreated  and  filled  with  data
       from one of the healthy replicas.

       If a pool set has the option <u>SINGLEHDR</u> (see <b><a href="../man5/poolset.5.html">poolset</a></b>(5)), the internal metadata of each replica is limited
       to the beginning of the first part in the replica.  If the option <u>NOHDRS</u> is used, replicas contain no in‐
       ternal  metadata.  In both cases, only the missing parts or the ones which cannot be opened are recreated
       with the <b>pmempool_sync</b>() function.

       <b>pmempool_transform</b>() modifies the internal structure of a pool set.  It  supports  the  following  opera‐
       tions:

       • adding one or more replicas,

       • removing one or more replicas ,

       • adding or removing pool set options.

       Only one of the above operations can be performed at a time.

       <b>pmempool_transform</b>() accepts three arguments:

       • <u>poolset_file_src</u> - pathname of the pool <u>set</u> file for the source pool set to be changed,

       • <u>poolset_file_dst</u> - pathname of the pool <u>set</u> file that defines the new structure of the pool set,

       • <u>flags</u> - a combination of flags (ORed) which modify how synchronization is performed.

       The following flags are available:

       • <b>PMEMPOOL_TRANSFORM_DRY_RUN</b> - do not apply changes, only check for viability of transformation.

         NOTE:  At the moment, <u>transform</u> operation is only supported for <b><a href="../man7/libpmemobj.7.html">libpmemobj</a></b>(7) pools, so <b>pmempool_trans‐</b>
         <b>form</b>() cannot be used with other pool types (<b><a href="../man7/libpmemlog.7.html">libpmemlog</a></b>(7), <b><a href="../man7/libpmemblk.7.html">libpmemblk</a></b>(7)).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>pmempool_sync</b>() and <b>pmempool_transform</b>() return 0 on success.  Otherwise, they return -1  and  set  <u>errno</u>
       appropriately.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EINVAL</b> Invalid format of the input/output pool set file.

       <b>EINVAL</b> Unsupported <u>flags</u> value.

       <b>EINVAL</b> There is only master replica defined in the input pool set passed to <b>pmempool_sync</b>().

       <b>EINVAL</b> The source pool set passed to <b>pmempool_transform</b>() is not a <b>libpmemobj</b> pool.

       <b>EINVAL</b> The input and output pool sets passed to <b>pmempool_transform</b>() are identical.

       <b>EINVAL</b> Attempt to perform more than one transform operation at a time.

</pre><h4><b>NOTES</b></h4><pre>
       The <b>pmempool_sync</b>() API is experimental and it may change in future versions of the library.

       The <b>pmempool_transform</b>() API is experimental and it may change in future versions of the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/libpmemlog.7.html">libpmemlog</a></b>(7), <b><a href="../man7/libpmemobj.7.html">libpmemobj</a></b>(7) and <b>&lt;https://pmem.io&gt;</b>
</pre>
 </div>
</div></section>
</div>
</body>
</html>