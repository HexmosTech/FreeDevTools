<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cap_clear, cap_clear_flag, cap_get_flag, cap_set_flag, cap_fill_flag, cap_fill, cap_compare, cap_max_bits</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcap-dev">libcap-dev_2.75-7ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cap_clear, cap_clear_flag, cap_get_flag, cap_set_flag, cap_fill_flag, cap_fill, cap_compare, cap_max_bits
       - capability data object manipulation

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;sys/capability.h&gt;

       int cap_clear(cap_t cap_p);
       int cap_clear_flag(cap_t cap_p, cap_flag_t flag);
       int cap_get_flag(cap_t cap_p, cap_value_t cap,
                        cap_flag_t flag, cap_flag_value_t *value_p);
       int cap_set_flag(cap_t cap_p, cap_flag_t flag, int ncap,
                        const cap_value_t *caps, cap_flag_value_t value);
       int cap_fill_flag(cap_t cap_p, cap_flag_t to,
                         const cap_t ref, cap_flag_t from);
       int cap_fill(cap_t cap_p, cap_flag_t to, cap_flag_t from);
       int cap_compare(cap_t cap_a, cap_t cap_b);
       cap_value_t cap_max_bits();

       Link with <u>-lcap</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These  functions work on a capability state held in working storage.  A <u>cap_t</u> holds information about the
       capabilities in each of the three flags, Permitted, Inheritable, and Effective.  Each capability in a set
       may be clear (disabled, 0) or set (enabled, 1).

       These functions work with the following data types:

       <u>cap_value_t</u>       identifies a capability, such as <b>CAP_CHOWN</b>.

       <u>cap_flag_t</u>        identifies one of the three flags associated with a capability (i.e., it identifies one
                         of the three capability dimensions).  Valid values for  this  type  are  <b>CAP_EFFECTIVE</b>,
                         <b>CAP_INHERITABLE</b> or <b>CAP_PERMITTED</b>.

       <u>cap_flag_value_t</u>  identifies  the setting of a particular capability flag (i.e, the value of a capability
                         in a set).  Valid values for this type are <b>CAP_CLEAR</b> (0) or <b>CAP_SET</b> (1).

       <b>cap_clear</b>() initializes the capability  state  in  working  storage  identified  by  <u>cap_p</u>  so  that  all
       capability flags are cleared.

       <b>cap_clear_flag</b>() clears all of the capabilities of the specified capability flag, <u>flag</u>.

       <b>cap_get_flag</b>()  obtains  the current value of the capability flag, <u>flag</u>, of the capability, <u>cap</u>, from the
       capability state identified by <u>cap_p</u> and places it in the location pointed to by <u>value_p</u>.

       <b>cap_set_flag</b>() sets the flag, <u>flag</u>, of each  capability  in  the  array  <u>caps</u>  in  the  capability  state
       identified  by  <u>cap_p</u> to <u>value</u>.  The argument, <u>ncap</u>, is used to specify the number of capabilities in the
       array, <u>caps</u>.

       <b>cap_fill_flag</b>() fills the to flag of one capability set, with the values in the from flag of a  reference
       capability set.

       <b>cap_fill</b>() fills the to flag values by copying all of the from flag values.

       <b>cap_compare</b>()  compares  two full capability sets and, in the spirit of <b>memcmp</b>(), returns zero if the two
       capability sets are identical. A positive return <u>value</u> indicates there is a difference between them.  The
       returned <u>value</u> carries further information about the <b>cap_flag_t</b> <u>flag</u> differences. Specifically, the macro
       <b>CAP_DIFFERS</b> (<u>value</u>, <u>flag</u>) evaluates to non-zero if the returned <u>value</u> differs in its <u>flag</u> components.

       <b>cap_max_bits</b>()  returns the number of capability values known to the running kernel. This may differ from
       libcap's list known at compilation time. Unnamed, at compilation time, capabilites  can  be  referred  to
       numerically  and  libcap  will  handle  them  appropriately. Note, the running kernel wins and it gets to
       define what "all" capabilities means.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>cap_clear</b>(), <b>cap_clear_flag</b>(), <b>cap_get_flag</b>() <b>cap_set_flag</b>() and <b>cap_compare</b>() return  zero  on  success,
       and -1 on failure. Other return values for <b>cap_compare</b>() are described above. The function <b>cap_max_bits</b>()
       returns a numeric value of type <b>cap_value_t</b> that is one larger than the largest actual value known to the
       running kernel.

       On failure, <u>errno</u> is set to <b>EINVAL</b>, indicating that one of the arguments is invalid.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       These functions are mostly as per specified in the withdrawn POSIX.1e draft specification.  The following
       are Linux extensions: <b>cap_fill</b>(), <b>cap_fill_flag</b>(), <b>cap_clear_flag</b>(), <b>cap_compare</b>() and <b>cap_max_bits</b>().

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libcap.3.html">libcap</a></b>(3),    <b><a href="../man3/cap_copy_ext.3.html">cap_copy_ext</a></b>(3),    <b><a href="../man3/cap_from_text.3.html">cap_from_text</a></b>(3),    <b><a href="../man3/cap_get_file.3.html">cap_get_file</a></b>(3),   <b><a href="../man3/cap_get_proc.3.html">cap_get_proc</a></b>(3),   <b><a href="../man3/cap_init.3.html">cap_init</a></b>(3),
       <b><a href="../man7/capabilities.7.html">capabilities</a></b>(7)

                                                   2022-10-16                                       <u><a href="../man3/CAP_CLEAR.3.html">CAP_CLEAR</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>