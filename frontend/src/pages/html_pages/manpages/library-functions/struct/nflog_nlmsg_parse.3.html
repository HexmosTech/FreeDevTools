<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nflog_nlmsg_put_header, nflog_attr_put_cfg_mode, nflog_attr_put_cfg_cmd, nflog_nlmsg_parse,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnetfilter-log-doc">libnetfilter-log-doc_1.0.2-4build1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nflog_nlmsg_put_header, nflog_attr_put_cfg_mode, nflog_attr_put_cfg_cmd, nflog_nlmsg_parse,
       nflog_nlmsg_snprintf - Netlink message helper functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/netinet/in.h">netinet/in.h</a>&gt;</b>
       <b>#include</b> <b>&lt;libnetfilter_log/libnetfilter_log.h&gt;</b>

       struct nlmsghdr * <b>nflog_nlmsg_put_header</b> (char *buf, uint8_t type, uint8_t family, uint16_t gnum)
       int <b>nflog_attr_put_cfg_mode</b> (struct nlmsghdr *nlh, uint8_t mode, uint32_t range)
       int <b>nflog_attr_put_cfg_cmd</b> (struct nlmsghdr *nlh, uint8_t cmd)
       int <b>nflog_nlmsg_parse</b> (const struct nlmsghdr *nlh, struct nlattr **attr)
       int <b>nflog_nlmsg_snprintf</b> (char *buf, size_t bufsiz, const struct nlmsghdr *nlh, struct nlattr **attr, enum nflog_output_type type, uint32_t flags)

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>int</b> <b>nflog_attr_put_cfg_cmd</b> <b>(struct</b> <b>nlmsghdr</b> <b>*</b> <b>nlh,</b> <b>uint8_t</b> <b>cmd)</b>
       nflog_attr_put_cfg_cmd - add a command attribute to nflog netlink message

       <b>Parameters</b>
           <u>nlh</u> pointer to netlink message
           <u>cmd</u> one of the enum nfulnl_msg_config_cmds

       <b>Returns</b>
           0

       Definition at line <b>84</b> of file <b>nlmsg.c</b>.

   <b>int</b> <b>nflog_attr_put_cfg_mode</b> <b>(struct</b> <b>nlmsghdr</b> <b>*</b> <b>nlh,</b> <b>uint8_t</b> <b>mode,</b> <b>uint32_t</b> <b>range)</b>
       nflog_attr_put_cfg_mode - add a mode attribute to nflog netlink message

       <b>Parameters</b>
           <u>nlh</u> pointer to netlink message
           <u>mode</u> copy mode: NFULNL_COPY_NONE, NFULNL_COPY_META or NFULNL_COPY_PACKET
           <u>range</u> copy range

       <b>Returns</b>
           0

       Definition at line <b>64</b> of file <b>nlmsg.c</b>.

   <b>int</b> <b>nflog_nlmsg_parse</b> <b>(const</b> <b>struct</b> <b>nlmsghdr</b> <b>*</b> <b>nlh,</b> <b>struct</b> <b>nlattr</b> <b>**</b> <b>attr)</b>
       nflog_nlmsg_parse - set nlattrs from netlink message

       <b>Parameters</b>
           <u>nlh</u> pointer to netlink message
           <u>attr</u> pointer to an array of nlattr of size NFULA_MAX + 1

       <b>Returns</b>
           0

       Definition at line <b>162</b> of file <b>nlmsg.c</b>.

   <b>struct</b> <b>nlmsghdr</b> <b>*</b> <b>nflog_nlmsg_put_header</b> <b>(char</b> <b>*</b> <b>buf,</b> <b>uint8_t</b> <b>type,</b> <b>uint8_t</b> <b>family,</b> <b>uint16_t</b> <b>gnum)</b>
       nflog_nlmsg_put_header - populate memory buffer with nflog Netlink headers

       <b>Parameters</b>
           <u>buf</u> pointer to memory buffer
           <u>type</u> either NFULNL_MSG_PACKET or NFULNL_MSG_CONFIG (enum nfulnl_msg_types)
           <u>family</u> protocol family
           <u>gnum</u> group number

       Initialises <u>buf</u> to start with a netlink header for the log subsystem followed by an nfnetlink header with
       the log group

       <b>Returns</b>
           pointer to created Netlink header structure

       Definition at line <b>39</b> of file <b>nlmsg.c</b>.

   <b>int</b> <b>nflog_nlmsg_snprintf</b> <b>(char</b> <b>*</b> <b>buf,</b> <b>size_t</b> <b>bufsiz,</b> <b>const</b> <b>struct</b> <b>nlmsghdr</b> <b>*</b> <b>nlh,</b> <b>struct</b> <b>nlattr</b> <b>**</b> <b>attr,</b> <b>enum</b>
       <b>nflog_output_type</b> <b>type,</b> <b>uint32_t</b> <b>flags)</b>
       nflog_nlmsg_snprintf - print a nflog nlattrs to a buffer

       <b>Parameters</b>
           <u>buf</u> buffer used to build the printable nflog
           <u>bufsiz</u> size of the buffer
           <u>nlh</u> pointer to netlink message (to get queue num in the future)
           <u>attr</u> pointer to an array of nlattr of size NFULA_MAX + 1
           <u>type</u> print message type in enum nflog_output_type
           <u>flags</u> The flag that tell what to print into the buffer

       This function supports the following types / flags:

       type: NFLOG_OUTPUT_XML

       • NFLOG_XML_PREFIX: include the string prefix

       • NFLOG_XML_HW: include the hardware link layer address

       • NFLOG_XML_MARK: include the packet mark

       • NFLOG_XML_DEV: include the device information

       • NFLOG_XML_PHYSDEV: include the physical device information

       • NFLOG_XML_PAYLOAD: include the payload (in hexadecimal)

       • NFLOG_XML_TIME: include the timestamp

       • NFLOG_XML_ALL: include all the logging information (all flags set)

       You can combine these flags with a bitwise OR.

       <b>Returns</b>
           -1 on failure else same as snprintf

       <b>Errors</b>
           <b>EOPNOTSUPP</b> <u>type</u> is unsupported (i.e. not <b>NFLOG_OUTPUT_XML</b>)

       <b>See</b> <b>also</b>
           <b><a href="../man3/snprintf.3.html">snprintf</a></b>(3)

       Definition at line <b>196</b> of file <b>nlmsg.c</b>.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for libnetfilter_log from the source code.

libnetfilter_log                                  Version 1.0.2                                         <u><a href="../man3/nlmsg.3.html">nlmsg</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>