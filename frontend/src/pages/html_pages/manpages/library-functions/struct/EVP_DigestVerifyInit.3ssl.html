<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_DigestVerifyInit_ex, EVP_DigestVerifyInit, EVP_DigestVerifyUpdate, EVP_DigestVerifyFinal,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_DigestVerifyInit_ex, EVP_DigestVerifyInit, EVP_DigestVerifyUpdate, EVP_DigestVerifyFinal,
       EVP_DigestVerify - EVP signature verification functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/evp.h&gt;

        int EVP_DigestVerifyInit_ex(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
                                    const char *mdname, OSSL_LIB_CTX *libctx,
                                    const char *props, EVP_PKEY *pkey,
                                    const OSSL_PARAM params[]);
        int EVP_DigestVerifyInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
                                 const EVP_MD *type, ENGINE *e, EVP_PKEY *pkey);
        int EVP_DigestVerifyUpdate(EVP_MD_CTX *ctx, const void *d, size_t cnt);
        int EVP_DigestVerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sig,
                                  size_t siglen);
        int EVP_DigestVerify(EVP_MD_CTX *ctx, const unsigned char *sig,
                             size_t siglen, const unsigned char *tbs, size_t tbslen);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The EVP signature routines are a high-level interface to digital signatures.  Input data is digested
       first before the signature verification takes place.

       <b>EVP_DigestVerifyInit_ex()</b> sets up verification context <b>ctx</b> to use a digest with the name <b>mdname</b> and
       public key <b>pkey</b>. The name of the digest to be used is passed to the provider of the signature algorithm
       in use. How that provider interprets the digest name is provider specific. The provider may implement
       that digest directly itself or it may (optionally) choose to fetch it (which could result in a digest
       from a different provider being selected). If the provider supports fetching the digest then it may use
       the <b>props</b> argument for the properties to be used during the fetch. Finally, the passed parameters <u>params</u>,
       if not NULL, are set on the context before returning.

       The <u>pkey</u> algorithm is used to fetch a <b>EVP_SIGNATURE</b> method implicitly, to be used for the actual signing.
       See "Implicit fetch" in <b><a href="../man7/provider.7.html">provider</a></b>(7) for more information about implicit fetches.

       The OpenSSL default and legacy providers support fetching digests and can fetch those digests from any
       available provider. The OpenSSL FIPS provider also supports fetching digests but will only fetch digests
       that are themselves implemented inside the FIPS provider.

       <b>ctx</b> must be created with <b>EVP_MD_CTX_new()</b> before calling this function. If <b>pctx</b> is not NULL, the
       EVP_PKEY_CTX of the verification operation will be written to <b>*pctx</b>: this can be used to set alternative
       verification options.  Note that any existing value in <b>*pctx</b> is overwritten. The EVP_PKEY_CTX value
       returned must not be freed directly by the application if <b>ctx</b> is not assigned an EVP_PKEY_CTX value
       before being passed to <b>EVP_DigestVerifyInit_ex()</b> (which means the EVP_PKEY_CTX is created inside
       <b>EVP_DigestVerifyInit_ex()</b> and it will be freed automatically when the EVP_MD_CTX is freed). If the
       EVP_PKEY_CTX to be used is created by EVP_DigestVerifyInit_ex then it will use the <b>OSSL_LIB_CTX</b> specified
       in <u>libctx</u> and the property query string specified in <u>props</u>.

       No <b>EVP_PKEY_CTX</b> will be created by <b>EVP_DigestVerifyInit_ex()</b> if the passed <b>ctx</b> has already been assigned
       one via <b><a href="../man3/EVP_MD_CTX_set_pkey_ctx.3.html">EVP_MD_CTX_set_pkey_ctx</a></b>(3).  See also <b><a href="../man7/SM2.7.html">SM2</a></b>(7).

       Not all digests can be used for all key types. The following combinations apply.

       DSA Supports SHA1, SHA224, SHA256, SHA384 and SHA512

       ECDSA
           Supports SHA1, SHA224, SHA256, SHA384, SHA512 and SM3

       RSA with no padding
           Supports no digests (the digest <b>type</b> must be NULL)

       RSA with X931 padding
           Supports SHA1, SHA256, SHA384 and SHA512

       All other RSA padding types
           Support  SHA1,  SHA224,  SHA256,  SHA384,  SHA512, MD5, MD5_SHA1, MD2, MD4, MDC2, SHA3-224, SHA3-256,
           SHA3-384, SHA3-512

       Ed25519 and Ed448
           Support no digests (the digest <b>type</b> must be NULL)

       HMAC
           Supports any digest

       CMAC, Poly1305 and Siphash
           Will ignore any digest provided.

       If RSA-PSS is used and restrictions apply then the digest must match.

       <b>EVP_DigestVerifyInit()</b> works in  the  same  way  as  <b>EVP_DigestVerifyInit_ex()</b>  except  that  the  <b>mdname</b>
       parameter  will  be  inferred  from  the supplied digest <b>type</b>, and <b>props</b> will be NULL. Where supplied the
       ENGINE <b>e</b> will be used for the signature verification and digest algorithm implementations. <b>e</b> may be NULL.

       <b>EVP_DigestVerifyUpdate()</b> hashes <b>cnt</b> bytes of data at <b>d</b> into the verification context <b>ctx</b>.  This  function
       can be called several times on the same <b>ctx</b> to include additional data.

       <b>EVP_DigestVerifyFinal()</b> verifies the data in <b>ctx</b> against the signature in <b>sig</b> of length <b>siglen</b>.

       <b>EVP_DigestVerify()</b> verifies <b>tbslen</b> bytes at <b>tbs</b> against the signature in <b>sig</b> of length <b>siglen</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>EVP_DigestVerifyInit()</b> and <b>EVP_DigestVerifyUpdate()</b> return 1 for success and 0 for failure.

       <b>EVP_DigestVerifyFinal()</b>  and  <b>EVP_DigestVerify()</b> return 1 for success; any other value indicates failure.
       A return value of zero indicates that the signature did not verify successfully (that  is,  <b>tbs</b>  did  not
       match the original data or the signature had an invalid form), while other values indicate a more serious
       error (and sometimes also indicate an invalid signature form).

       The error codes can be obtained from <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3).

</pre><h4><b>NOTES</b></h4><pre>
       The  <b>EVP</b>  interface  to  digital  signatures  should almost always be used in preference to the low-level
       interfaces. This is because the code then becomes  transparent  to  the  algorithm  used  and  much  more
       flexible.

       <b>EVP_DigestVerify()</b>  is  a  one  shot operation which verifies a single block of data in one function. For
       algorithms  that  support  streaming  it  is   equivalent   to   calling   <b>EVP_DigestVerifyUpdate()</b>   and
       <b>EVP_DigestVerifyFinal()</b>.  For  algorithms  which do not support streaming (e.g. PureEdDSA) it is the only
       way to verify data.

       In previous versions of OpenSSL there was a link between message digest types and public key  algorithms.
       This  meant that "clone" digests such as <b>EVP_dss1()</b> needed to be used to sign using SHA1 and DSA. This is
       no longer necessary and the use of clone digest is now discouraged.

       For some key types and parameters the random number generator must be seeded.  If the  automatic  seeding
       or  reseeding of the OpenSSL CSPRNG fails due to external circumstances (see <b><a href="../man7/RAND.7.html">RAND</a></b>(7)), the operation will
       fail.

       The call to <b>EVP_DigestVerifyFinal()</b> internally finalizes a copy of the digest context.  This  means  that
       <b>EVP_VerifyUpdate()</b>  and  <b>EVP_VerifyFinal()</b>  can  be  called  later  to digest and verify additional data.
       Applications may  disable  this  behavior  by  setting  the  EVP_MD_CTX_FLAG_FINALISE  context  flag  via
       <b><a href="../man3/EVP_MD_CTX_set_flags.3.html">EVP_MD_CTX_set_flags</a></b>(3).

       Note  that  not  all  providers  support  continuation,  in  case the selected provider does not allow to
       duplicate contexts <b>EVP_DigestVerifyFinal()</b> will finalize the digest context  and  attempting  to  process
       additional data via <b>EVP_DigestVerifyUpdate()</b> will result in an error.

       <b>EVP_DigestVerifyInit()</b>  and <b>EVP_DigestVerifyInit_ex()</b> functions can be called multiple times on a context
       and the parameters set by previous calls should be preserved if the <u>pkey</u> parameter is NULL. The call then
       just resets the state of the <u>ctx</u>.

       <b>EVP_DigestVerify()</b> can only be  called  once,  and  cannot  be  used  again  without  reinitialising  the
       <b>EVP_MD_CTX</b> by calling <b>EVP_DigestVerifyInit_ex()</b>.

       Ignoring  failure  returns  of <b>EVP_DigestVerifyInit()</b> and <b>EVP_DigestVerifyInit_ex()</b> functions can lead to
       subsequent  undefined  behavior  when  calling  <b>EVP_DigestVerifyUpdate()</b>,   <b>EVP_DigestVerifyFinal()</b>,   or
       <b>EVP_DigestVerify()</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_DigestSignInit.3.html">EVP_DigestSignInit</a></b>(3),   <b><a href="../man3/EVP_DigestInit.3.html">EVP_DigestInit</a></b>(3),  <b><a href="../man7/evp.7.html">evp</a></b>(7),  <b><a href="../man3/HMAC.3.html">HMAC</a></b>(3),  <b><a href="../man3/MD2.3.html">MD2</a></b>(3),  <b><a href="../man3/MD5.3.html">MD5</a></b>(3),  <b><a href="../man3/MDC2.3.html">MDC2</a></b>(3),  <b><a href="../man3/RIPEMD160.3.html">RIPEMD160</a></b>(3),
       <b><a href="../man3/SHA1.3.html">SHA1</a></b>(3), <b><a href="../man1/openssl-dgst.1.html">openssl-dgst</a></b>(1), <b><a href="../man7/RAND.7.html">RAND</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>EVP_DigestVerifyInit()</b>, <b>EVP_DigestVerifyUpdate()</b> and <b>EVP_DigestVerifyFinal()</b> were added in OpenSSL 1.0.0.

       <b>EVP_DigestVerifyInit_ex()</b> was added in OpenSSL 3.0.

       <b>EVP_DigestVerifyUpdate()</b> was converted from a macro to a function in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2006-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                         <u><a href="../man3SSL/EVP_DIGESTVERIFYINIT.3SSL.html">EVP_DIGESTVERIFYINIT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>