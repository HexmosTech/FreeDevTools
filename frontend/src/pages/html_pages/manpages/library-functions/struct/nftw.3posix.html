<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-posix-dev">manpages-posix-dev_2017a-2_all</a> <br><br><pre>
</pre><h4><b>PROLOG</b></h4><pre>
       This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface
       may differ (consult the corresponding Linux manual page for details of Linux behavior), or the  interface
       may not be implemented on Linux.

</pre><h4><b>NAME</b></h4><pre>
       nftw — walk a file tree

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/ftw.h">ftw.h</a>&gt;

       int nftw(const char *<u>path</u>, int (*<u>fn</u>)(const char *,
           const struct stat *, int, struct FTW *), int <u>fd_limit</u>, int <u>flags</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <u>nftw</u>()  function  shall  recursively  descend  the  directory  hierarchy rooted in <u>path</u>.  The <u>nftw</u>()
       function has a similar effect to <u>ftw</u>() except that it takes an additional  argument  <u>flags</u>,  which  is  a
       bitwise-inclusive OR of zero or more of the following flags:

       FTW_CHDIR   If  set,  <u>nftw</u>()  shall  change the current working directory to each directory as it reports
                   files in that directory. If clear, <u>nftw</u>() shall not change the current working directory.

       FTW_DEPTH   If set, <u>nftw</u>() shall report all files in a directory before reporting the  directory  itself.
                   If clear, <u>nftw</u>() shall report any directory before reporting the files in that directory.

       FTW_MOUNT   If  set,  <u>nftw</u>()  shall  only report files in the same file system as <u>path</u>.  If clear, <u>nftw</u>()
                   shall report all files encountered during the walk.

       FTW_PHYS    If set, <u>nftw</u>() shall perform a physical walk and shall not follow symbolic links.

       If FTW_PHYS is clear and FTW_DEPTH is set, <u>nftw</u>() shall follow links instead of reporting them, but shall
       not report any directory that would be a descendant of itself. If FTW_PHYS  is  clear  and  FTW_DEPTH  is
       clear,  <u>nftw</u>()  shall  follow  links  instead of reporting them, but shall not report the contents of any
       directory that would be a descendant of itself.

       At each file it encounters, <u>nftw</u>() shall call the user-supplied function <u>fn</u> with four arguments:

        *  The first argument is the pathname of the object.

        *  The second argument is a pointer to the <b>stat</b> buffer containing information on the object,  filled  in
           as if <u>fstatat</u>(), <u>stat</u>(), or <u>lstat</u>() had been called to retrieve the information.

        *  The third argument is an integer giving additional information. Its value is one of the following:

           FTW_D     The object is a directory.

           FTW_DNR   The  object is a directory that cannot be read. The <u>fn</u> function shall not be called for any
                     of its descendants.

           FTW_DP    The object is a directory and subdirectories have been visited. (This condition shall  only
                     occur if the FTW_DEPTH flag is included in <u>flags</u>.)

           FTW_F     The object is a non-directory file.

           FTW_NS    The  <u>stat</u>()  function  failed  on the object because of lack of appropriate permission. The
                     <b>stat</b> buffer passed to <u>fn</u> is undefined. Failure of <u>stat</u>() for any other reason is considered
                     an error and <u>nftw</u>() shall return -1.

           FTW_SL    The object is a symbolic link. (This condition shall only occur if  the  FTW_PHYS  flag  is
                     included in <u>flags</u>.)

           FTW_SLN   The  object  is a symbolic link that does not name an existing file.  (This condition shall
                     only occur if the FTW_PHYS flag is not included in <u>flags</u>.)

        *  The fourth argument is a pointer to an <b>FTW</b> structure.  The  value  of  <b>base</b>  is  the  offset  of  the
           object's  filename  in the pathname passed as the first argument to <u>fn</u>.  The value of <b>level</b> indicates
           depth relative to the root of the walk, where the root level is 0.

       The results are unspecified if the application-supplied <u>fn</u> function does not preserve the current working
       directory.

       The argument <u>fd_limit</u> sets the maximum number of file descriptors that shall  be  used  by  <u>nftw</u>()  while
       traversing the file tree. At most one file descriptor shall be used for each directory level.

       The <u>nftw</u>() function need not be thread-safe.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <u>nftw</u>() function shall continue until the first of the following conditions occurs:

        *  An invocation of <u>fn</u> shall return a non-zero value, in which case <u>nftw</u>() shall return that value.

        *  The  <u>nftw</u>()  function  detects  an error other than <b>[EACCES]</b> (see FTW_DNR and FTW_NS above), in which
           case <u>nftw</u>() shall return -1 and set <u>errno</u> to indicate the error.

        *  The tree is exhausted, in which case <u>nftw</u>() shall return 0.

</pre><h4><b>ERRORS</b></h4><pre>
       The <u>nftw</u>() function shall fail if:

       <b>EACCES</b> Search permission is denied for any component of <u>path</u> or read permission is denied for <u>path</u>, or <u>fn</u>
              returns -1 and does not reset <u>errno</u>.

       <b>ELOOP</b>  A loop exists in symbolic links encountered during resolution of the <u>path</u> argument.

       <b>ENAMETOOLONG</b>
              The length of a component of a pathname is longer than {NAME_MAX}.

       <b>ENOENT</b> A component of <u>path</u> does not name an existing file or <u>path</u> is an empty string.

       <b>ENOTDIR</b>
              A component of <u>path</u> names an existing file that is neither a directory nor a symbolic  link  to  a
              directory.

       <b>EOVERFLOW</b>
              A  field  in  the  <b>stat</b>  structure  cannot  be  represented  correctly  in the current programming
              environment for one or more files found in the file hierarchy.

       The <u>nftw</u>() function may fail if:

       <b>ELOOP</b>  More than {SYMLOOP_MAX} symbolic links were encountered during resolution of the <u>path</u> argument.

       <b>EMFILE</b> All file descriptors available to the process are currently open.

       <b>ENAMETOOLONG</b>
              The length of a pathname exceeds {PATH_MAX}, or pathname resolution of a symbolic link produced an
              intermediate result with a length that exceeds {PATH_MAX}.

       <b>ENFILE</b> Too many files are currently open in the system.

       In addition, <u>errno</u> may be set if the function pointed to by <u>fn</u> causes <u>errno</u> to be set.

       <u>The</u> <u>following</u> <u>sections</u> <u>are</u> <u>informative.</u>

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following program traverses the directory tree  under  the  path  named  in  its  first  command-line
       argument,  or  under  the  current  directory if no argument is supplied. It displays various information
       about each file. The second command-line argument can be used to  specify  characters  that  control  the
       value assigned to the <u>flags</u> argument when calling <u>nftw</u>().

           #include &lt;<a href="file:/usr/include/ftw.h">ftw.h</a>&gt;
           #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
           #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
           #include &lt;<a href="file:/usr/include/string.h">string.h</a>&gt;
           #include &lt;<a href="file:/usr/include/stdint.h">stdint.h</a>&gt;

           static int
           display_info(const char *fpath, const struct stat *sb,
               int tflag, struct FTW *ftwbuf)
           {
               printf("%-3s %2d %7jd   %-40s %d %s\n",
                   (tflag == FTW_D) ?   "d"   : (tflag == FTW_DNR) ? "dnr" :
                   (tflag == FTW_DP) ?  "dp"  : (tflag == FTW_F) ?
                       (S_ISBLK(sb-&gt;st_mode) ? "f b" :
                        S_ISCHR(sb-&gt;st_mode) ? "f c" :
                        S_ISFIFO(sb-&gt;st_mode) ? "f p" :
                        S_ISREG(sb-&gt;st_mode) ? "f r" :
                        S_ISSOCK(sb-&gt;st_mode) ? "f s" : "f ?") :
                   (tflag == FTW_NS) ?  "ns"  : (tflag == FTW_SL) ?  "sl" :
                   (tflag == FTW_SLN) ? "sln" : "?",
                   ftwbuf-&gt;level, (intmax_t) sb-&gt;st_size,
                   fpath, ftwbuf-&gt;base, fpath + ftwbuf-&gt;base);
               return 0;           /* To tell nftw() to continue */
           }

           int
           main(int argc, char *argv[])
           {
               int flags = 0;

               if (argc &gt; 2 &amp;&amp; strchr(argv[2], 'd') != NULL)
                   flags |= FTW_DEPTH;
               if (argc &gt; 2 &amp;&amp; strchr(argv[2], 'p') != NULL)
                   flags |= FTW_PHYS;

               if (nftw((argc &lt; 2) ? "." : argv[1], display_info, 20, flags) == -1)
               {
                   perror("nftw");
                   exit(EXIT_FAILURE);
               }

               exit(EXIT_SUCCESS);
           }

</pre><h4><b>APPLICATION</b> <b>USAGE</b></h4><pre>
       The  <u>nftw</u>() function may allocate dynamic storage during its operation. If <u>nftw</u>() is forcibly terminated,
       such as by <u>longjmp</u>() or <u>siglongjmp</u>() being executed by the function pointed to  by  <u>fn</u>  or  an  interrupt
       routine,  <u>nftw</u>() does not have a chance to free that storage, so it remains permanently allocated. A safe
       way to handle interrupts is to store the fact that an interrupt has occurred, and  arrange  to  have  the
       function pointed to by <u>fn</u> return a non-zero value at its next invocation.

</pre><h4><b>RATIONALE</b></h4><pre>
       None.

</pre><h4><b>FUTURE</b> <b>DIRECTIONS</b></h4><pre>
       None.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>fdopendir</u>(), <u>fstatat</u>(), <u>readdir</u>()

       The Base Definitions volume of POSIX.1‐2017, <b>&lt;ftw.h&gt;</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1-2017, Standard
       for  Information  Technology  --  Portable  Operating  System  Interface  (POSIX),  The  Open  Group Base
       Specifications Issue 7, 2018 Edition, Copyright (C) 2018 by the Institute of Electrical  and  Electronics
       Engineers, Inc and The Open Group.  In the event of any discrepancy between this version and the original
       IEEE  and The Open Group Standard, the original IEEE and The Open Group Standard is the referee document.
       The original Standard can be obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any typographical or formatting errors that appear in this page are most likely to have  been  introduced
       during   the   conversion  of  the  source  files  to  man  page  format.  To  report  such  errors,  see
       https://www.kernel.org/doc/man-pages/reporting_bugs.html .

IEEE/The Open Group                                   2017                                          <u><a href="../man3POSIX/NFTW.3POSIX.html">NFTW</a></u>(3POSIX)
</pre>
 </div>
</div></section>
</div>
</body>
</html>