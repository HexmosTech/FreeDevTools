<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_get_shared_sigalgs, SSL_get_sigalgs - get supported signature algorithms</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_get_shared_sigalgs, SSL_get_sigalgs - get supported signature algorithms

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        int SSL_get_shared_sigalgs(SSL *s, int idx,
                                   int *psign, int *phash, int *psignhash,
                                   unsigned char *rsig, unsigned char *rhash);

        int SSL_get_sigalgs(SSL *s, int idx,
                            int *psign, int *phash, int *psignhash,
                            unsigned char *rsig, unsigned char *rhash);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_get_shared_sigalgs()</b> returns information about the shared signature algorithms supported by peer <b>s</b>.
       The parameter <b>idx</b> indicates the index of the shared signature algorithm to return starting from zero. The
       signature algorithm NID is written to <b>*psign</b>, the hash NID to <b>*phash</b> and the sign and hash NID to
       <b>*psignhash</b>. The raw signature and hash values are written to <b>*rsig</b> and <b>*rhash</b>.

       <b>SSL_get_sigalgs()</b> is similar to <b>SSL_get_shared_sigalgs()</b> except it returns information about all
       signature algorithms supported by <b>s</b> in the order they were sent by the peer.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_get_shared_sigalgs()</b> and <b>SSL_get_sigalgs()</b> return the number of signature algorithms or <b>0</b> if the <b>idx</b>
       parameter is out of range.

</pre><h4><b>NOTES</b></h4><pre>
       These functions are typically called for debugging purposes (to report the peer's preferences) or where
       an application wants finer control over certificate selection. Most applications will rely on internal
       handling and will not need to call them.

       If an application is only interested in the highest preference shared signature algorithm it can just set
       <b>idx</b> to zero.

       Any or all of the parameters <b>psign</b>, <b>phash</b>, <b>psignhash</b>, <b>rsig</b> or <b>rhash</b> can be set to <b>NULL</b> if the value is
       not required. By setting them all to <b>NULL</b> and setting <b>idx</b> to zero the total number of signature
       algorithms can be determined: which can be zero.

       These functions must be called after the peer has sent a list of supported signature algorithms: after a
       client hello (for servers) or a certificate request (for clients). They can (for example) be called in
       the certificate callback.

       Only TLS 1.2, TLS 1.3 and DTLS 1.2 currently support signature algorithms.  If these functions are called
       on an earlier version of TLS or DTLS zero is returned.

       The shared signature algorithms returned by <b>SSL_get_shared_sigalgs()</b> are ordered according to
       configuration and peer preferences.

       The raw values correspond to the on the wire form as defined by RFC5246 et al.  The NIDs are OpenSSL
       equivalents. For example if the peer sent <b><a href="../man4/sha256.4.html">sha256</a></b>(4) and <b><a href="../man1/rsa.1.html">rsa</a></b>(1) then <b>*rhash</b> would be 4, <b>*rsign</b> 1, <b>*phash</b>
       NID_sha256, <b>*psig</b> NID_rsaEncryption and <b>*psignhash</b> NID_sha256WithRSAEncryption.

       If a signature algorithm is not recognised the corresponding NIDs will be set to <b>NID_undef</b>. This may be
       because the value is not supported, is not an appropriate combination (for example MD5 and DSA) or the
       signature algorithm does not use a hash (for example Ed25519).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/SSL_CTX_set_cert_cb.3.html">SSL_CTX_set_cert_cb</a></b>(3), <b><a href="../man7/ssl.7.html">ssl</a></b>(7)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2015-2018 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                       <u><a href="../man3SSL/SSL_GET_SHARED_SIGALGS.3SSL.html">SSL_GET_SHARED_SIGALGS</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>