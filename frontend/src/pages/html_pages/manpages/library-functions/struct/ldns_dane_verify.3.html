<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ldns_dane_verify, ldns_dane_verify_rr - TLSA RR verification functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libldns-dev">libldns-dev_1.8.4-2build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ldns_dane_verify, ldns_dane_verify_rr - TLSA RR verification functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/stdint.h">stdint.h</a>&gt;
       #include &lt;stdbool.h&gt;

       #include &lt;ldns/ldns.h&gt;

       ldns_status   ldns_dane_verify(const   ldns_rr_list*  tlsas,  X509*  cert,  STACK_OF(X509)*  extra_certs,
       X509_STORE* pkix_validation_store);

       ldns_status  ldns_dane_verify_rr(const  ldns_rr*  tlsa_rr,  X509*  cert,   STACK_OF(X509)*   extra_certs,
       X509_STORE* pkix_validation_store);

</pre><h4><b>DESCRIPTION</b></h4><pre>

       <u>ldns_dane_verify</u>()  BEWARE!   We  strongly  recommend  to  use  OpenSSL 1.1.0 dane verification functions
              instead of the ones provided by ldns.  When OpenSSL 1.1.0 was available ldns will use the  OpenSSL
              1.1.0 dane verification functions under the hood.  When ldns was linked with OpenSSL &lt; 1.1.0, this
              function will not be able to verify TLSA records with DANE-TA usage types.

              BEWARE!  The  ldns  dane  verification  functions do *not* do server name checks.  The user has to
              perform additional server name checks themselves!

              Verify if any of the given TLSA resource records matches the given certificate.

              <b>tlsas</b>: The resource records that specify what and how to match the certificate. One must match for
              this function to succeed. With tlsas == NULL or the number of TLSA records in tlsas == 0,  regular
              PKIX validation is performed.
              <b>cert</b>: The certificate to match (and validate)
              <b>extra_certs</b>: Intermediate certificates that might be necessary creating the validation chain.
              <b>pkix_validation_store</b>:  Used when the certificate usage is "CA constraint" or "Service Certificate
              Constraint" to validate the certificate.

              Returns LDNS_STATUS_OK on success, LDNS_STATUS_DANE_NEED_OPENSSL_GE_1_1_FOR_DANE_TA when at  least
              one  of  the  TLSA's  had  usage  type  DANE-TA  and none of the TLSA's matched or PKIX validated,
              LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE when one of the TLSA's  matched  but  the  PKIX  validation
              failed,  LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH when none of the TLSA's matched, or other ldns_status
              errors.

       <u>ldns_dane_verify_rr</u>() BEWARE!  We strongly recommend to use OpenSSL  1.1.0  dane  verification  functions
              instead  of the ones provided by ldns.  When OpenSSL 1.1.0 was available ldns will use the OpenSSL
              1.1.0 dane verification functions under the hood.  When ldns was linked with OpenSSL &lt; 1.1.0, this
              function will not be able to verify TLSA records with DANE-TA usage types.

              BEWARE! The ldns dane verification functions do *not* do server name  checks.   The  user  has  to
              perform additional server name checks themselves!

              Verify  if  the  given TLSA resource record matches the given certificate.  Reporting on a TLSA rr
              mismatch   (LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH)   is   preferred   over    PKIX    failure     (‚Äê
              LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE).   So  when  PKIX  validation  is  required  by  the  TLSA
              Certificate usage, but the  TLSA  data  does  not  match,  LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH  is
              returned whether the PKIX validated or not.

              When  ldns  is  linked with OpenSSL &lt; 1.1.0 and this function is available, then the DANE-TA usage
              type   will   not   be    verified,    and    on    a    tlsa_rr    with    this    usage    type,
              LDNS_STATUS_DANE_NEED_OPENSSL_GE_1_1_FOR_DANE_TA will be returned.

              <b>tlsa_rr</b>: The resource record that specifies what and how to match the certificate. With tlsa_rr ==
              NULL, regular PKIX validation is performed.
              <b>cert</b>: The certificate to match (and validate)
              <b>extra_certs</b>: Intermediate certificates that might be necessary creating the validation chain.
              <b>pkix_validation_store</b>:  Used when the certificate usage is "CA constraint" or "Service Certificate
              Constraint" to validate the certificate.

              Returns  LDNS_STATUS_OK  on  success,  LDNS_STATUS_DANE_NEED_OPENSSL_GE_1_1_FOR_DANE_TA  when  the
              provided  TLSA  had  the  DANE-TA  usage  type,  LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH  on TLSA data
              mismatch, LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE  when  TLSA  matched,  but  the  PKIX  validation
              failed, or other ldns_status errors.

</pre><h4><b>AUTHOR</b></h4><pre>
       The ldns team at NLnet Labs.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Please report bugs to <a href="mailto:dns-team@nlnetlabs.nl">dns-team@nlnetlabs.nl</a> or on GitHub at https://github.com/NLnetLabs/ldns/issues

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2004 - 2006 NLnet Labs.

       Licensed  under  the  BSD  License.  There  is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A
       PARTICULAR PURPOSE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>ldns_dane_create_tlsa_owner</u>, <u>ldns_dane_cert2rdf</u>, <u>ldns_dane_select_certificate</u>,  <u>ldns_dane_create_tlsa_rr</u>.
       And <b>perldoc</b> <b>Net::DNS</b>, <b>RFC1034</b>, <b>RFC1035</b>, <b>RFC4033</b>, <b>RFC4034</b>  and <b>RFC4035</b>.

</pre><h4><b>REMARKS</b></h4><pre>
       This manpage was automatically generated from the ldns source code.

                                                   30 May 2006                                           <u><a href="../man3/ldns.3.html">ldns</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>