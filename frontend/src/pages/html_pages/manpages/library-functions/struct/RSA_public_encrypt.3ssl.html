<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA_public_encrypt, RSA_private_decrypt - RSA public key cryptography</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       RSA_public_encrypt, RSA_private_decrypt - RSA public key cryptography

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/rsa.h&gt;

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        int RSA_public_encrypt(int flen, const unsigned char *from,
                               unsigned char *to, RSA *rsa, int padding);

        int RSA_private_decrypt(int flen, const unsigned char *from,
                                unsigned char *to, RSA *rsa, int padding);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Both of the functions described on this page are deprecated.  Applications should instead use
       <b><a href="../man3/EVP_PKEY_encrypt_init_ex.3.html">EVP_PKEY_encrypt_init_ex</a></b>(3), <b><a href="../man3/EVP_PKEY_encrypt.3.html">EVP_PKEY_encrypt</a></b>(3), <b><a href="../man3/EVP_PKEY_decrypt_init_ex.3.html">EVP_PKEY_decrypt_init_ex</a></b>(3) and <b><a href="../man3/EVP_PKEY_decrypt.3.html">EVP_PKEY_decrypt</a></b>(3).

       <b>RSA_public_encrypt()</b> encrypts the <b>flen</b> bytes at <b>from</b> (usually a session key) using the public key <b>rsa</b> and
       stores the ciphertext in <b>to</b>. <b>to</b> must point to RSA_size(<b>rsa</b>) bytes of memory.

       <b>padding</b> denotes one of the following modes:

       RSA_PKCS1_PADDING
           PKCS #1 v1.5 padding. This currently is the most widely used mode.  However, it is highly recommended
           to use RSA_PKCS1_OAEP_PADDING in new applications. SEE WARNING BELOW.

       RSA_PKCS1_OAEP_PADDING
           EME-OAEP  as  defined  in PKCS #1 v2.0 with SHA-1, MGF1 and an empty encoding parameter. This mode is
           recommended for all new applications.

       RSA_NO_PADDING
           Raw RSA encryption. This mode should <u>only</u> be used to implement cryptographically sound padding  modes
           in the application code.  Encrypting user data directly with RSA is insecure.

       When  encrypting  <b>flen</b> must not be more than RSA_size(<b>rsa</b>) - 11 for the PKCS #1 v1.5 based padding modes,
       not more than RSA_size(<b>rsa</b>) - 42 for RSA_PKCS1_OAEP_PADDING and exactly RSA_size(<b>rsa</b>) for RSA_NO_PADDING.
       When a padding mode other than RSA_NO_PADDING is in use,  then  <b>RSA_public_encrypt()</b>  will  include  some
       random  bytes  into  the ciphertext and therefore the ciphertext will be different each time, even if the
       plaintext and the public key are exactly identical.  The returned ciphertext in <b>to</b> will  always  be  zero
       padded to exactly RSA_size(<b>rsa</b>) bytes.  <b>to</b> and <b>from</b> may overlap.

       <b>RSA_private_decrypt()</b>  decrypts the <b>flen</b> bytes at <b>from</b> using the private key <b>rsa</b> and stores the plaintext
       in <b>to</b>. <b>flen</b> should be equal to RSA_size(<b>rsa</b>) but may be smaller, when  leading  zero  bytes  are  in  the
       ciphertext.  Those  are  not  important and may be removed, but <b>RSA_public_encrypt()</b> does not do that. <b>to</b>
       must point to a memory section large enough to hold the maximal possible decrypted data (which  is  equal
       to  RSA_size(<b>rsa</b>)  for  RSA_NO_PADDING,  RSA_size(<b>rsa</b>)  - 11 for the PKCS #1 v1.5 based padding modes and
       RSA_size(<b>rsa</b>) - 42 for RSA_PKCS1_OAEP_PADDING).  <b>padding</b> is the padding mode that was used to encrypt the
       data.  <b>to</b> and <b>from</b> may overlap.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>RSA_public_encrypt()</b> returns the size of the encrypted data (i.e., RSA_size(<b>rsa</b>)).  <b>RSA_private_decrypt()</b>
       returns  the size of the recovered plaintext. A return value of 0 is not an error and means only that the
       plaintext was empty.

       On error, -1 is returned; the error codes can be obtained by <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3).

</pre><h4><b>WARNINGS</b></h4><pre>
       Decryption failures in the RSA_PKCS1_PADDING mode leak information which can potentially be used to mount
       a Bleichenbacher padding oracle attack. This is an inherent weakness in the PKCS #1 v1.5 padding  design.
       Prefer RSA_PKCS1_OAEP_PADDING.

       In  OpenSSL before version 3.2.0, both the return value and the length of returned value could be used to
       mount the Bleichenbacher attack.  Since version 3.2.0, the default provider in OpenSSL does not return an
       error when padding checks fail. Instead it generates a random message  based  on  used  private  key  and
       provided  ciphertext  so  that  application  code  doesn't  have to implement a side-channel secure error
       handling.  Applications that want to be secure against side-channel attacks  with  providers  that  don't
       implement  implicit  rejection,  still  need  to handle the returned values using side-channel free code.
       Side-channel free handling of the error stack can be performed  using  either  a  pair  of  unconditional
       <b><a href="../man3/ERR_set_mark.3.html">ERR_set_mark</a></b>(3) and <b><a href="../man3/ERR_pop_to_mark.3.html">ERR_pop_to_mark</a></b>(3) calls or by using the <b><a href="../man3/ERR_clear_error.3.html">ERR_clear_error</a></b>(3) call.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       SSL, PKCS #1 v2.0

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3), <b><a href="../man3/RAND_bytes.3.html">RAND_bytes</a></b>(3), <b><a href="../man3/RSA_size.3.html">RSA_size</a></b>(3), <b><a href="../man3/EVP_PKEY_decrypt.3.html">EVP_PKEY_decrypt</a></b>(3), <b><a href="../man3/EVP_PKEY_encrypt.3.html">EVP_PKEY_encrypt</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       Both of these functions were deprecated in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                           <u><a href="../man3SSL/RSA_PUBLIC_ENCRYPT.3SSL.html">RSA_PUBLIC_ENCRYPT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>