<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_use_serverinfo_ex, SSL_CTX_use_serverinfo, SSL_CTX_use_serverinfo_file - use serverinfo extension</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_use_serverinfo_ex, SSL_CTX_use_serverinfo, SSL_CTX_use_serverinfo_file - use serverinfo extension

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        int SSL_CTX_use_serverinfo_ex(SSL_CTX *ctx, unsigned int version,
                                      const unsigned char *serverinfo,
                                      size_t serverinfo_length);

        int SSL_CTX_use_serverinfo(SSL_CTX *ctx, const unsigned char *serverinfo,
                                   size_t serverinfo_length);

        int SSL_CTX_use_serverinfo_file(SSL_CTX *ctx, const char *file);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These functions load "serverinfo" TLS extensions into the SSL_CTX. A "serverinfo" extension is returned
       in response to an empty ClientHello Extension.

       <b>SSL_CTX_use_serverinfo_ex()</b> loads one or more serverinfo extensions from a byte array into <b>ctx</b>. The
       <b>version</b> parameter specifies the format of the byte array provided in <b>*serverinfo</b> which is of length
       <b>serverinfo_length</b>.

       If <b>version</b> is <b>SSL_SERVERINFOV2</b> then the extensions in the array must consist of a 4-byte context, a
       2-byte Extension Type, a 2-byte length, and then length bytes of extension_data. The context and type
       values have the same meaning as for <b><a href="../man3/SSL_CTX_add_custom_ext.3.html">SSL_CTX_add_custom_ext</a></b>(3). If serverinfo is being loaded for
       extensions to be added to a Certificate message, then the extension will only be added for the first
       certificate in the message (which is always the end-entity certificate).

       If <b>version</b> is <b>SSL_SERVERINFOV1</b> then the extensions in the array must consist of a 2-byte Extension Type,
       a 2-byte length, and then length bytes of extension_data. The type value has the same meaning as for
       <b><a href="../man3/SSL_CTX_add_custom_ext.3.html">SSL_CTX_add_custom_ext</a></b>(3). The following default context value will be used in this case:

        SSL_EXT_TLS1_2_AND_BELOW_ONLY | SSL_EXT_CLIENT_HELLO
        | SSL_EXT_TLS1_2_SERVER_HELLO | SSL_EXT_IGNORE_ON_RESUMPTION

       <b>SSL_CTX_use_serverinfo()</b> does the same thing as <b>SSL_CTX_use_serverinfo_ex()</b> except that there is no
       <b>version</b> parameter so a default version of SSL_SERVERINFOV1 is used instead.

       <b>SSL_CTX_use_serverinfo_file()</b> loads one or more serverinfo extensions from <b>file</b> into <b>ctx</b>.  The extensions
       must be in PEM format.  Each extension must be in a format as described above for
       <b>SSL_CTX_use_serverinfo_ex()</b>.  Each PEM extension name must begin with the phrase "BEGIN SERVERINFOV2 FOR
       " for SSL_SERVERINFOV2 data or "BEGIN SERVERINFO FOR " for SSL_SERVERINFOV1 data.

       If more than one certificate (RSA/DSA) is installed using <b>SSL_CTX_use_certificate()</b>, the serverinfo
       extension will be loaded into the last certificate installed.  If e.g. the last item was an RSA
       certificate, the loaded serverinfo extension data will be loaded for that certificate.  To use the
       serverinfo extension for multiple certificates, <b>SSL_CTX_use_serverinfo()</b> needs to be called multiple
       times, once <b>after</b> each time a certificate is loaded via a call to <b>SSL_CTX_use_certificate()</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       On success, the functions return 1.  On failure, the functions return 0.  Check out the error stack to
       find out the reason.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2013-2017 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                       <u><a href="../man3SSL/SSL_CTX_USE_SERVERINFO.3SSL.html">SSL_CTX_USE_SERVERINFO</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>