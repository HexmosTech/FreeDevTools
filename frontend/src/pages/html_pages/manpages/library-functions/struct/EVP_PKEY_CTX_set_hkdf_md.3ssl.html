<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_PKEY_CTX_set_hkdf_md, EVP_PKEY_CTX_set1_hkdf_salt, EVP_PKEY_CTX_set1_hkdf_key,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_PKEY_CTX_set_hkdf_md, EVP_PKEY_CTX_set1_hkdf_salt, EVP_PKEY_CTX_set1_hkdf_key,
       EVP_PKEY_CTX_add1_hkdf_info, EVP_PKEY_CTX_set_hkdf_mode - HMAC-based Extract-and-Expand key derivation
       algorithm

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/kdf.h&gt;

        int EVP_PKEY_CTX_set_hkdf_mode(EVP_PKEY_CTX *pctx, int mode);

        int EVP_PKEY_CTX_set_hkdf_md(EVP_PKEY_CTX *pctx, const EVP_MD *md);

        int EVP_PKEY_CTX_set1_hkdf_salt(EVP_PKEY_CTX *pctx, unsigned char *salt,
                                        int saltlen);

        int EVP_PKEY_CTX_set1_hkdf_key(EVP_PKEY_CTX *pctx, unsigned char *key,
                                       int keylen);

        int EVP_PKEY_CTX_add1_hkdf_info(EVP_PKEY_CTX *pctx, unsigned char *info,
                                        int infolen);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The EVP_PKEY_HKDF algorithm implements the HKDF key derivation function.  HKDF follows the "extract-then-
       expand" paradigm, where the KDF logically consists of two modules. The first stage takes the input keying
       material and "extracts" from it a fixed-length pseudorandom key K. The second stage "expands" the key K
       into several additional pseudorandom keys (the output of the KDF).

       <b>EVP_PKEY_CTX_set_hkdf_mode()</b> sets the mode for the HKDF operation. There are three modes that are
       currently defined:

       EVP_PKEY_HKDEF_MODE_EXTRACT_AND_EXPAND
           This  is the default mode. Calling <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3) on an EVP_PKEY_CTX set up for HKDF will perform
           an extract followed by an expand operation in one go.  The derived key returned will  be  the  result
           after the expand operation. The intermediate fixed-length pseudorandom key K is not returned.

           In  this  mode  the digest, key, salt and info values must be set before a key is derived or an error
           occurs.

       EVP_PKEY_HKDEF_MODE_EXTRACT_ONLY
           In this mode calling <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3) will just perform the extract operation. The  value  returned
           will be the intermediate fixed-length pseudorandom key K.

           The digest, key and salt values must be set before a key is derived or an error occurs.

       EVP_PKEY_HKDEF_MODE_EXPAND_ONLY
           In  this mode calling <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3) will just perform the expand operation. The input key should
           be set to the  intermediate  fixed-length  pseudorandom  key  K  returned  from  a  previous  extract
           operation.

           The digest, key and info values must be set before a key is derived or an error occurs.

       <b>EVP_PKEY_CTX_set_hkdf_md()</b> sets the message digest associated with the HKDF.

       <b>EVP_PKEY_CTX_set1_hkdf_salt()</b>  sets  the  salt to <b>saltlen</b> bytes of the buffer <b>salt</b>. Any existing value is
       replaced.

       <b>EVP_PKEY_CTX_set1_hkdf_key()</b> sets the key to <b>keylen</b> bytes of  the  buffer  <b>key</b>.  Any  existing  value  is
       replaced.

       <b>EVP_PKEY_CTX_add1_hkdf_info()</b>  sets  the  info  value  to <b>infolen</b> bytes of the buffer <b>info</b>. If a value is
       already set, it is appended to the existing value.

</pre><h4><b>STRING</b> <b>CTRLS</b></h4><pre>
       HKDF also supports string based control operations via <b><a href="../man3/EVP_PKEY_CTX_ctrl_str.3.html">EVP_PKEY_CTX_ctrl_str</a></b>(3).  The <b>type</b> parameter "md"
       uses the supplied <b>value</b> as the name of the digest algorithm to use.  The <b>type</b> parameter "mode"  uses  the
       values  "EXTRACT_AND_EXPAND",  "EXTRACT_ONLY"  and  "EXPAND_ONLY" to determine the mode to use.  The <b>type</b>
       parameters "salt", "key" and "info" use the supplied <b>value</b> parameter as a <b>seed</b>, <b>key</b> or <b>info</b>  value.   The
       names  "hexsalt",  "hexkey" and "hexinfo" are similar except they take a hex string which is converted to
       binary.

</pre><h4><b>NOTES</b></h4><pre>
       A context for HKDF can be obtained by calling:

        EVP_PKEY_CTX *pctx = EVP_PKEY_CTX_new_id(EVP_PKEY_HKDF, NULL);

       The total length of the info buffer cannot exceed 2048 bytes in length: this should be more  than  enough
       for any normal use of HKDF.

       The  output  length  of  an  HKDF  expand  operation  is  specified  via  the  length  parameter  to  the
       <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3) function.  Since the HKDF output length is variable, passing a <b>NULL</b> buffer as a  means
       to obtain the requisite length is not meaningful with HKDF in any mode that performs an expand operation.
       Instead,   the  caller  must  allocate  a  buffer  of  the  desired  length,  and  pass  that  buffer  to
       <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3) along with (a pointer initialized to) the desired length. Passing  a  <b>NULL</b>  buffer  to
       obtain the length is allowed when using EVP_PKEY_HKDEF_MODE_EXTRACT_ONLY.

       Optimised versions of HKDF can be implemented in an ENGINE.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       All  these  functions return 1 for success and 0 or a negative value for failure.  In particular a return
       value of -2 indicates the operation is not supported by the public key algorithm.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This example derives 10 bytes using SHA-256 with the secret key "secret",  salt  value  "salt"  and  info
       value "label":

        EVP_PKEY_CTX *pctx;
        unsigned char out[10];
        size_t outlen = sizeof(out);
        pctx = EVP_PKEY_CTX_new_id(EVP_PKEY_HKDF, NULL);

        if (EVP_PKEY_derive_init(pctx) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_set_hkdf_md(pctx, EVP_sha256()) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_set1_hkdf_salt(pctx, "salt", 4) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_set1_hkdf_key(pctx, "secret", 6) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_add1_hkdf_info(pctx, "label", 5) &lt;= 0)
            /* Error */
        if (EVP_PKEY_derive(pctx, out, &amp;outlen) &lt;= 0)
            /* Error */

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       RFC 5869

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_PKEY_CTX_new.3.html">EVP_PKEY_CTX_new</a></b>(3), <b><a href="../man3/EVP_PKEY_CTX_ctrl_str.3.html">EVP_PKEY_CTX_ctrl_str</a></b>(3), <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       All of the functions described here were converted from macros to functions in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2016-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                     <u><a href="../man3SSL/EVP_PKEY_CTX_SET_HKDF_MD.3SSL.html">EVP_PKEY_CTX_SET_HKDF_MD</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>