<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKCS12_add_cert, PKCS12_add_key, PKCS12_add_key_ex, PKCS12_add_secret - Add an object to a set of PKCS#12</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       PKCS12_add_cert, PKCS12_add_key, PKCS12_add_key_ex, PKCS12_add_secret - Add an object to a set of PKCS#12
       safeBags

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/pkcs12.h&gt;

        PKCS12_SAFEBAG *PKCS12_add_cert(STACK_OF(PKCS12_SAFEBAG) **pbags, X509 *cert);
        PKCS12_SAFEBAG *PKCS12_add_key(STACK_OF(PKCS12_SAFEBAG) **pbags,
                                      EVP_PKEY *key, int key_usage, int iter,
                                      int key_nid, const char *pass);
        PKCS12_SAFEBAG *PKCS12_add_key_ex(STACK_OF(PKCS12_SAFEBAG) **pbags,
                                          EVP_PKEY *key, int key_usage, int iter,
                                          int key_nid, const char *pass,
                                          OSSL_LIB_CTX *ctx, const char *propq);

        PKCS12_SAFEBAG *PKCS12_add_secret(STACK_OF(PKCS12_SAFEBAG) **pbags,
                                         int nid_type, const unsigned char *value, int len);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These functions create a new <b>PKCS12_SAFEBAG</b> and add it to the set of safeBags in <u>pbags</u>.

       <b>PKCS12_add_cert()</b> creates a PKCS#12 certBag containing the supplied certificate and adds this to the set
       of PKCS#12 safeBags.

       <b>PKCS12_add_key()</b> creates a PKCS#12 keyBag (unencrypted) or a pkcs8shroudedKeyBag (encrypted) containing
       the supplied <b>EVP_PKEY</b> and adds this to the set of PKCS#12 safeBags. If <u>key_nid</u> is not -1 then the key is
       encrypted with the supplied algorithm, using <u>pass</u> as the passphrase and <u>iter</u> as the iteration count. If
       <u>iter</u> is zero then a default value for iteration count of 2048 is used.

       <b>PKCS12_add_key_ex()</b> is identical to <b>PKCS12_add_key()</b> but allows for a library context <u>ctx</u> and property
       query <u>propq</u> to be used to select algorithm implementations.

       <b>PKCS12_add_secret()</b> creates a PKCS#12 secretBag with an OID corresponding to the supplied <u>nid_type</u>
       containing the supplied value as an ASN1 octet string.  This is then added to the set of PKCS#12
       safeBags.

</pre><h4><b>NOTES</b></h4><pre>
       If a certificate contains an <u>alias</u> or a <u>keyid</u> then this will be used for the corresponding <b>friendlyName</b>
       or <b>localKeyID</b> in the PKCS12 structure.

       <b>PKCS12_add_key()</b> makes assumptions regarding the encoding of the given pass phrase.  See
       <b><a href="../man7/passphrase-encoding.7.html">passphrase-encoding</a></b>(7) for more information.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       A valid <b>PKCS12_SAFEBAG</b> structure or NULL if an error occurred.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       IETF RFC 7292 (&lt;https://tools.ietf.org/html/rfc7292&gt;)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/PKCS12_create.3.html">PKCS12_create</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>PKCS12_add_secret()</b> and <b>PKCS12_add_key_ex()</b> were added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                              <u><a href="../man3SSL/PKCS12_ADD_CERT.3SSL.html">PKCS12_ADD_CERT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>