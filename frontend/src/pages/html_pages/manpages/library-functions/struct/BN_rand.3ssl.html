<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BN_rand_ex, BN_rand, BN_priv_rand_ex, BN_priv_rand, BN_pseudo_rand, BN_rand_range_ex, BN_rand_range,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       BN_rand_ex, BN_rand, BN_priv_rand_ex, BN_priv_rand, BN_pseudo_rand, BN_rand_range_ex, BN_rand_range,
       BN_priv_rand_range_ex, BN_priv_rand_range, BN_pseudo_rand_range - generate pseudo-random number

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/bn.h&gt;

        int BN_rand_ex(BIGNUM *rnd, int bits, int top, int bottom,
                       unsigned int strength, BN_CTX *ctx);
        int BN_rand(BIGNUM *rnd, int bits, int top, int bottom);

        int BN_priv_rand_ex(BIGNUM *rnd, int bits, int top, int bottom,
                            unsigned int strength, BN_CTX *ctx);
        int BN_priv_rand(BIGNUM *rnd, int bits, int top, int bottom);

        int BN_rand_range_ex(BIGNUM *rnd, const BIGNUM *range, unsigned int strength,
                             BN_CTX *ctx);
        int BN_rand_range(BIGNUM *rnd, const BIGNUM *range);

        int BN_priv_rand_range_ex(BIGNUM *rnd, const BIGNUM *range, unsigned int strength,
                                  BN_CTX *ctx);
        int BN_priv_rand_range(BIGNUM *rnd, const BIGNUM *range);

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        int BN_pseudo_rand(BIGNUM *rnd, int bits, int top, int bottom);
        int BN_pseudo_rand_range(BIGNUM *rnd, const BIGNUM *range);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>BN_rand_ex()</b> generates a cryptographically strong pseudo-random number of <u>bits</u> in length and security
       strength at least <u>strength</u> bits using the random number generator for the library context associated with
       <u>ctx</u>. The function stores the generated data in <u>rnd</u>. The parameter <u>ctx</u> may be NULL in which case the
       default library context is used.  If <u>bits</u> is less than zero, or too small to accommodate the requirements
       specified by the <u>top</u> and <u>bottom</u> parameters, an error is returned.  The <u>top</u> parameters specifies
       requirements on the most significant bit of the generated number.  If it is <b>BN_RAND_TOP_ANY</b>, there is no
       constraint.  If it is <b>BN_RAND_TOP_ONE</b>, the top bit must be one.  If it is <b>BN_RAND_TOP_TWO</b>, the two most
       significant bits of the number will be set to 1, so that the product of two such random numbers will
       always have 2*<u>bits</u> length.  If <u>bottom</u> is <b>BN_RAND_BOTTOM_ODD</b>, the number will be odd; if it is
       <b>BN_RAND_BOTTOM_ANY</b> it can be odd or even.  If <u>bits</u> is 1 then <u>top</u> cannot also be <b>BN_RAND_TOP_TWO</b>.

       <b>BN_rand()</b> is the same as <b>BN_rand_ex()</b> except that the default library context is always used.

       <b>BN_rand_range_ex()</b> generates a cryptographically strong pseudo-random number <u>rnd</u>, of security strength at
       least <u>strength</u> bits, in the range 0 &lt;= <u>rnd</u> &lt; <u>range</u> using the random number generator for the library
       context associated with <u>ctx</u>. The parameter <u>ctx</u> may be NULL in which case the default library context is
       used.

       <b>BN_rand_range()</b> is the same as <b>BN_rand_range_ex()</b> except that the default library context is always used.

       <b>BN_priv_rand_ex()</b>, <b>BN_priv_rand()</b>, <b>BN_priv_rand_rand_ex()</b> and <b>BN_priv_rand_range()</b> have the same
       semantics as <b>BN_rand_ex()</b>, <b>BN_rand()</b>, <b>BN_rand_range_ex()</b> and <b>BN_rand_range()</b> respectively.  They are
       intended to be used for generating values that should remain private, and mirror the same difference
       between <b><a href="../man3/RAND_bytes.3.html">RAND_bytes</a></b>(3) and <b><a href="../man3/RAND_priv_bytes.3.html">RAND_priv_bytes</a></b>(3).

</pre><h4><b>NOTES</b></h4><pre>
       Always check the error return value of these functions and do not take randomness for granted: an error
       occurs if the CSPRNG has not been seeded with enough randomness to ensure an unpredictable byte sequence.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The functions return 1 on success, 0 on error.  The error codes can be obtained by <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3), <b><a href="../man3/RAND_add.3.html">RAND_add</a></b>(3), <b><a href="../man3/RAND_bytes.3.html">RAND_bytes</a></b>(3), <b><a href="../man3/RAND_priv_bytes.3.html">RAND_priv_bytes</a></b>(3), <b><a href="../man7/RAND.7.html">RAND</a></b>(7), <b><a href="../man7/EVP_RAND.7.html">EVP_RAND</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       • Starting   with   OpenSSL   release  1.1.0,  <b>BN_pseudo_rand()</b>  has  been  identical  to  <b>BN_rand()</b>  and
         <b>BN_pseudo_rand_range()</b>   has   been   identical   to   <b>BN_rand_range()</b>.    The   <b>BN_pseudo_rand()</b>   and
         <b>BN_pseudo_rand_range()</b> functions were deprecated in OpenSSL 3.0.

       • The <b>BN_priv_rand()</b> and <b>BN_priv_rand_range()</b> functions were added in OpenSSL 1.1.1.

       • The  <b>BN_rand_ex()</b>,  <b>BN_priv_rand_ex()</b>,  <b>BN_rand_range_ex()</b>  and  <b>BN_priv_rand_range_ex()</b> functions were
         added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2022 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                      <u><a href="../man3SSL/BN_RAND.3SSL.html">BN_RAND</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>