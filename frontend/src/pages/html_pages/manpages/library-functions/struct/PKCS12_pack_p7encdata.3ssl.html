<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKCS12_pack_p7encdata, PKCS12_pack_p7encdata_ex - Pack a set of PKCS#12 safeBags into a PKCS#7 encrypted</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       PKCS12_pack_p7encdata, PKCS12_pack_p7encdata_ex - Pack a set of PKCS#12 safeBags into a PKCS#7 encrypted
       data object

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/pkcs12.h&gt;

        PKCS7 *PKCS12_pack_p7encdata(int pbe_nid, const char *pass, int passlen,
                                     unsigned char *salt, int saltlen, int iter,
                                     STACK_OF(PKCS12_SAFEBAG) *bags);
        PKCS7 *PKCS12_pack_p7encdata_ex(int pbe_nid, const char *pass, int passlen,
                                        unsigned char *salt, int saltlen, int iter,
                                        STACK_OF(PKCS12_SAFEBAG) *bags,
                                        OSSL_LIB_CTX *ctx, const char *propq);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>PKCS12_pack_p7encdata()</b> generates a PKCS#7 ContentInfo object of encrypted-data type from the set of
       safeBags <u>bags</u>. The algorithm ID in <u>pbe_nid</u> can be a PKCS#12 or PKCS#5 password based encryption
       algorithm, or a cipher algorithm.  If a cipher algorithm is passed, the PKCS#5 PBES2 algorithm will be
       used with this cipher as a parameter.  The password <u>pass</u> of length <u>passlen</u>, salt <u>salt</u> of length <u>saltlen</u>
       and iteration count <u>iter</u> are inputs into the encryption operation.

       <b>PKCS12_pack_p7encdata_ex()</b> operates similar to the above but allows for a library context <u>ctx</u> and
       property query <u>propq</u> to be used to select the algorithm implementation.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       A <b>PKCS7</b> object if successful, or NULL if an error occurred.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       IETF RFC 2315 (&lt;https://tools.ietf.org/html/rfc2315&gt;)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/PKCS12_pbe_crypt_ex.3.html">PKCS12_pbe_crypt_ex</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>PKCS12_pack_p7encdata_ex()</b> was added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                        <u><a href="../man3SSL/PKCS12_PACK_P7ENCDATA.3SSL.html">PKCS12_PACK_P7ENCDATA</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>