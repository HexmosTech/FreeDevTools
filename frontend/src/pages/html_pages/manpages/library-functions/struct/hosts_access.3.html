<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hosts_access, hosts_ctl, request_init, request_set - access control library</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libwrap0-dev">libwrap0-dev_7.6.q-36_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       hosts_access, hosts_ctl, request_init, request_set - access control library

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;tcpd.h&gt;

       extern int allow_severity;
       extern int deny_severity;

       struct request_info *request_init(request, key, value, ..., 0)
       struct request_info *request;

       struct request_info *request_set(request, key, value, ..., 0)
       struct request_info *request;

       void fromhost(request)
       struct request_info *request;

       int hosts_access(request)
       struct request_info *request;

       int hosts_ctl(daemon, client_name, client_addr, client_user)
       char *daemon;
       char *client_name;
       char *client_addr;
       char *client_user;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  routines  described  in this document are part of the <u>libwrap.a</u> library. They implement a rule-based
       access control language with optional shell commands that are executed when a rule fires.

       request_init() initializes a structure with information about a client request. request_set() updates  an
       already  initialized request structure. Both functions take a variable-length list of key-value pairs and
       return their first argument.  The argument lists are terminated with a zero key value. All  string-valued
       arguments are copied. The expected keys (and corresponding value types) are:

       RQ_FILE (int)
              The file descriptor associated with the request.

       RQ_CLIENT_NAME (char *)
              The client host name.

       RQ_CLIENT_ADDR (char *)
              A printable representation of the client network address.

       RQ_CLIENT_SIN (struct sockaddr_in *)
              An  internal representation of the client network address and port.  The contents of the structure
              are not copied.

       RQ_SERVER_NAME (char *)
              The hostname associated with the server endpoint address.

       RQ_SERVER_ADDR (char *)
              A printable representation of the server endpoint address.

       RQ_SERVER_SIN (struct sockaddr_in *)
              An internal representation of the server endpoint address and port.  The contents of the structure
              are not copied.

       RQ_DAEMON (char *)
              The name of the daemon process running on the server host.

       RQ_USER (char *)
              The name of the user on whose behalf the client host makes the request.

       hosts_access() consults the access control tables described in the  <u><a href="../man5/hosts_access.5.html">hosts_access</a>(5)</u>  manual  page.   When
       internal  endpoint  information  is  available, host names and client user names are looked up on demand,
       using the request structure as a  cache.   hosts_access()  returns  zero  if  access  should  be  denied.
       fromhost() must be called before hosts_access().

       hosts_ctl()  is  a  wrapper  around  the  request_init()  and hosts_access() routines with a perhaps more
       convenient interface (though it does not pass on enough information to support automated client  username
       lookups).   The client host address, client host name and username arguments should contain valid data or
       STRING_UNKNOWN.  hosts_ctl() returns zero if access should be denied.

       The <u>allow_severity</u> and <u>deny_severity</u> variables determine  how  accepted  and  rejected  requests  may  be
       logged. They must be provided by the caller and may be modified by rules in the access control tables.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Problems are reported via the syslog daemon.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man5/hosts_access.5.html">hosts_access</a>(5),  format of the access control tables.  <a href="../man5/hosts_options.5.html">hosts_options</a>(5), optional extensions to the base
       language.

</pre><h4><b>FILES</b></h4><pre>
       <a href="file:/etc/hosts.allow">/etc/hosts.allow</a>, <a href="file:/etc/hosts.deny">/etc/hosts.deny</a>, access control tables.

</pre><h4><b>BUGS</b></h4><pre>
       hosts_access() uses the strtok() library function. This may interfere with  other  code  that  relies  on
       strtok().

</pre><h4><b>AUTHOR</b></h4><pre>
       Wietse Venema (<a href="mailto:wietse@wzv.win.tue.nl">wietse@wzv.win.tue.nl</a>)
       Department of Mathematics and Computing Science
       Eindhoven University of Technology
       Den Dolech 2, P.O. Box 513,
       5600 MB Eindhoven, The Netherlands

                                                                                                 <u><a href="../man3/HOSTS_ACCESS.3.html">HOSTS_ACCESS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>