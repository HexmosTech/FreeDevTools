<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GDBM_File - Perl5 access to the gdbm library.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/perl-doc">perl-doc_5.40.1-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       GDBM_File - Perl5 access to the gdbm library.

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use GDBM_File;
           [$db =] tie %hash, 'GDBM_File', $filename, GDBM_WRCREAT, 0640
                       or die "$GDBM_File::gdbm_errno";
           # Use the %hash...

           $e = $db-&gt;errno;
           $e = $db-&gt;syserrno;
           $str = $db-&gt;strerror;
           $bool = $db-&gt;needs_recovery;

           $db-&gt;clear_error;

           $db-&gt;reorganize;
           $db-&gt;sync;

           $n = $db-&gt;count;

           $n = $db-&gt;flags;

           $str = $db-&gt;dbname;

           $db-&gt;cache_size;
           $db-&gt;cache_size($newsize);

           $n = $db-&gt;block_size;

           $bool = $db-&gt;sync_mode;
           $db-&gt;sync_mode($bool);

           $bool = $db-&gt;centfree;
           $db-&gt;centfree($bool);

           $bool = $db-&gt;coalesce;
           $db-&gt;coalesce($bool);

           $bool = $db-&gt;mmap;

           $size = $db-&gt;mmapsize;
           $db-&gt;mmapsize($newsize);

           $db-&gt;recover(%args);

           untie %hash ;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>GDBM_File</b> is a module which allows Perl programs to make use of the facilities provided by the GNU gdbm
       library.  If you intend to use this module you should really have a copy of the <b>GDBM</b> <b>manual</b> at hand.  The
       manual is avaialble online at &lt;https://www.gnu.org.ua/software/gdbm/manual&gt;.

       Most of the <b>gdbm</b> functions are available through the <b>GDBM_File</b> interface.

       Unlike Perl's built-in hashes, it is not safe to "delete" the current item from a GDBM_File tied hash
       while iterating over it with "each".  This is a limitation of the gdbm library.

   <b>Tie</b>
       Use the Perl built-in <b>tie</b> to associate a <b>GDBM</b> database with a Perl hash:

          tie %hash, 'GDBM_File', $filename, $flags, $mode;

       Here, <u>$filename</u> is the name of the database file to open or create.  <u>$flags</u> is a bitwise OR of <u>access</u>
       <u>mode</u> and optional <u>modifiers</u>.  Access mode is one of:

       <b>GDBM_READER</b>
           Open existing database file in read-only mode.

       <b>GDBM_WRITER</b>
           Open existing database file in read-write mode.

       <b>GDBM_WRCREAT</b>
           If  the  database  file  exists, open it in read-write mode.  If it doesn't, create it first and open
           read-write.

       <b>GDBM_NEWDB</b>
           Create new database and open it read-write.  If the database already exists, truncate it first.

       A number of  modifiers  can  be  OR'd  to  the  access  mode.   Most  of  them  are  rarely  needed  (see
       &lt;https://www.gnu.org.ua/software/gdbm/manual/Open.html&gt;   for   a   complete  list),  but  one  is  worth
       mentioning.  The <b>GDBM_NUMSYNC</b> modifier, when used with <b>GDBM_NEWDB</b>, instructs <b>GDBM</b> to create the  database
       in  <u>extended</u>  (so called <u>numsync</u>) format.  This format is best suited for crash-tolerant implementations.
       See <b>CRASH</b> <b>TOLERANCE</b> below for more information.

       The <u>$mode</u> parameter is the file mode for creating  new  database  file.   Use  an  octal  constant  or  a
       combination of "S_I*" constants from the <b>Fcntl</b> module.  This parameter is used if <u>$flags</u> is <b>GDBM_NEWDB</b> or
       <b>GDBM_WRCREAT</b>.

       On  success,  <b>tie</b> returns an object of class <b>GDBM_File</b>.  On failure, it returns <b>undef</b>.  It is recommended
       to always check the return value, to make sure your hash is successfully  associated  with  the  database
       file.  See <b>ERROR</b> <b>HANDLING</b> below for examples.

</pre><h4><b>STATIC</b> <b>METHODS</b></h4><pre>
   <b>GDBM_version</b>
           $str = GDBM_File-&gt;GDBM_version;
           @ar = GDBM_File-&gt;GDBM_version;

       Returns  the  version  number  of  the underlying <b>libgdbm</b> library. In scalar context, returns the library
       version formatted as string:

           MINOR.MAJOR[.PATCH][ (GUESS)]

       where <u>MINOR</u>, <u>MAJOR</u>, and <u>PATCH</u> are version numbers, and <u>GUESS</u> is a guess level (see below).

       In list context, returns a list:

           ( MINOR, MAJOR, PATCH [, GUESS] )

       The <u>GUESS</u> component is present only if <b>libgdbm</b> version is 1.8.3  or  earlier.  This  is  because  earlier
       releases  of  <b>libgdbm</b>  did  not  include  information about their version and the <b>GDBM_File</b> module has to
       implement certain guesswork in order to determine it. <u>GUESS</u> is a textual description in  string  context,
       and a positive number indicating how rough the guess is in list context. Possible values are:

       1  - exact guess
           The  major  and  minor  version  numbers  are guaranteed to be correct. The actual patchlevel is most
           probably guessed right, but can be 1-2 less than indicated.

       2  - approximate
           The major and minor number are guaranteed to be correct. The patchlevel is set to the upper bound.

       3  - rough guess
           The version is guaranteed to be not newer than <u><b>MAJOR</b></u><b>.</b><u><b>MINOR</b></u>.

</pre><h4><b>ERROR</b> <b>HANDLING</b></h4><pre>
   <b>$GDBM_File::gdbm_errno</b>
       When referenced in numeric context, retrieves the current  value  of  the  <b>gdbm_errno</b>  variable,  i.e.  a
       numeric  code  describing the state of the most recent operation on any <b>gdbm</b> database.  Each numeric code
       has  a  symbolic   name   associated   with   it.     For   a   comprehensive   list    of   these,   see
       &lt;https://www.gnu.org.ua/software/gdbm/manual/Error-codes.html&gt;.   Notice,  that  this  list  includes all
       error codes defined for the most recent version of <b>gdbm</b>.  Depending on the actual version of the  library
       <b>GDBM_File</b> is built with, some of these may be missing.

       In  string  context,  <b>$gdbm_errno</b>  returns a human-readable description of the error.  If necessary, this
       description includes the value of <b>$!</b>.  This makes it possible to use  it  in  diagnostic  messages.   For
       example, the usual tying sequence is

           tie %hash, 'GDBM_File', $filename, GDBM_WRCREAT, 0640
                or die "$GDBM_File::gdbm_errno";

       The  following, more complex, example illustrates how you can fall back to read-only mode if the database
       file permissions forbid read-write access:

           use Errno qw(EACCES);
           unless (tie(%hash, 'GDBM_File', $filename, GDBM_WRCREAT, 0640)) {
               if ($GDBM_File::gdbm_errno == GDBM_FILE_OPEN_ERROR
                   &amp;&amp; $!{EACCES}) {
                   if (tie(%hash, 'GDBM_File', $filename, GDBM_READER, 0640)) {
                       die "$GDBM_File::gdbm_errno";
                   }
               } else {
                   die "$GDBM_File::gdbm_errno";
               }
           }

   <b>gdbm_check_syserr</b>
           if (gdbm_check_syserr(gdbm_errno)) ...

       Returns true if the system error number (<b>$!</b>) gives more information on the cause of the error.

</pre><h4><b>DATABASE</b> <b>METHODS</b></h4><pre>
   <b>close</b>
           $db-&gt;close;

       Closes the database.  Normally you would just do <b>untie</b>.  However, you will need to use this  function  if
       you have explicitly assigned the result of <b>tie</b> to a variable, and wish to release the database to another
       users.  Consider the following code:

           $db = tie %hash, 'GDBM_File', $filename, GDBM_WRCREAT, 0640;
           # Do something with %hash or $db...
           untie %hash;
           $db-&gt;close;

       In this example, doing <b>untie</b> alone is not enough, since the database would remain referenced by <b>$db</b>, and,
       as a consequence, the database file would remain locked.  Calling <b>$db-&gt;close</b> ensures the database file is
       closed and unlocked.

   <b>errno</b>
           $db-&gt;errno

       Returns the last error status associated with this database.  In string context, returns a human-readable
       description of the error.  See also <b>$GDBM_File::gdbm_errno</b> variable above.

   <b>syserrno</b>
           $db-&gt;syserrno

       Returns the last system error status (C "errno" variable), associated with this database,

   <b>strerror</b>
           $db-&gt;strerror

       Returns textual description of the last error that occurred in this database.

   <b>clear_error</b>
           $db-&gt;clear_error

       Clear error status.

   <b>needs_recovery</b>
           $db-&gt;needs_recovery

       Returns true if the database needs recovery.

   <b>reorganize</b>
           $db-&gt;reorganize;

       Reorganizes the database.

   <b>sync</b>
           $db-&gt;sync;

       Synchronizes recent changes to the database with its disk copy.

   <b>count</b>
           $n = $db-&gt;count;

       Returns number of keys in the database.

   <b>flags</b>
           $db-&gt;flags;

       Returns flags passed as 4th argument to <b>tie</b>.

   <b>dbname</b>
           $db-&gt;dbname;

       Returns the database name (i.e. 3rd argument to <b>tie</b>.

   <b>cache_size</b>
           $db-&gt;cache_size;
           $db-&gt;cache_size($newsize);

       Returns the size of the internal <b>GDBM</b> cache for that database.

       Called with argument, sets the size to <u>$newsize</u>.

   <b>block_size</b>
           $db-&gt;block_size;

       Returns the block size of the database.

   <b>sync_mode</b>
           $db-&gt;sync_mode;
           $db-&gt;sync_mode($bool);

       Returns  the  status of the automatic synchronization mode. Called with argument, enables or disables the
       sync mode, depending on whether $bool is <b>true</b> or <b>false</b>.

       When synchronization mode is on (<b>true</b>), any changes to the database are immediately written to the  disk.
       This  ensures database consistency in case of any unforeseen errors (e.g. power failures), at the expense
       of considerable slowdown of operation.

       Synchronization mode is off by default.

   <b>centfree</b>
           $db-&gt;centfree;
           $db-&gt;centfree($bool);

       Returns status of the central free block pool (<b>0</b> - disabled, <b>1</b> - enabled).

       With argument, changes its status.

       By default, central free block pool is disabled.

   <b>coalesce</b>
           $db-&gt;coalesce;
           $db-&gt;coalesce($bool);

   <b>mmap</b>
           $db-&gt;mmap;

       Returns true if memory mapping is enabled.

       This method will <b>croak</b> if the <b>libgdbm</b> library is complied without memory mapping support.

   <b>mmapsize</b>
           $db-&gt;mmapsize;
           $db-&gt;mmapsize($newsize);

       If memory mapping is enabled, returns the size of  memory  mapping.  With  argument,  sets  the  size  to
       <b>$newsize</b>.

       This method will <b>croak</b> if the <b>libgdbm</b> library is complied without memory mapping support.

   <b>recover</b>
           $db-&gt;recover(%args);

       Recovers data from a failed database. <b>%args</b> is optional and can contain following keys:

       err =&gt; sub { ... }
           Reference  to  code  for detailed error reporting. Upon encountering an error, <b>recover</b> will call this
           sub with a single argument - a description of the error.

       backup =&gt; \$str
           Creates a backup copy of the database before recovery and returns its filename in <b>$str</b>.

       max_failed_keys =&gt; $n
           Maximum allowed number of failed keys. If the actual number becomes equal to <u>$n</u>, <b>recover</b>  aborts  and
           returns error.

       max_failed_buckets =&gt; $n
           Maximum  allowed  number  of failed buckets. If the actual number becomes equal to <u>$n</u>, <b>recover</b> aborts
           and returns error.

       max_failures =&gt; $n
           Maximum allowed number of failures during recovery.

       stat =&gt; \%hash
           Return recovery statistics in <u>%hash</u>. Upon return, the following keys will be present:

           recovered_keys
                   Number of successfully recovered keys.

           recovered_buckets
                   Number of successfully recovered buckets.

           failed_keys
                   Number of keys that failed to be retrieved.

           failed_buckets
                   Number of buckets that failed to be retrieved.

   <b>convert</b>
           $db-&gt;convert($format);

       Changes the format of the database file referred to by <b>$db</b>.

       Starting from version 1.20, <b>gdbm</b> supports two database file formats: <u>standard</u> and <u>extended</u>.   The  former
       is  the  traditional  database  format,  used  by  previous  <b>gdbm</b> versions.  The <u>extended</u> format contains
       additional data and is recommended for use in crash tolerant applications.

       &lt;https://www.gnu.org.ua/software/gdbm/manual/Numsync.html&gt;, for the discussion of both formats.

       The <b>$format</b> argument sets the new desired database format.  It is <b>GDBM_NUMSYNC</b> to  convert  the  database
       from standard to extended format, and <b>0</b> to convert it from extended to standard format.

       If the database is already in the requested format, the function returns success without doing anything.

   <b>dump</b>
           $db-&gt;dump($filename, %options)

       Creates  a dump of the database file in <u>$filename</u>.  Such file can be used as a backup copy or sent over a
       wire to recreate the database on another machine.  To create a database from the dump file, use the  <b>load</b>
       method.

       <b>GDBM</b>  supports  two  dump  formats:  old  <u>binary</u> and new <u>ascii</u>.  The binary format is not portable across
       architectures and is deprecated.  It is supported  for  backward  compatibility.   The  ascii  format  is
       portable  and  stores  additional meta-data about the file.  It was introduced with the <b>gdbm</b> version 1.11
       and is the preferred dump format.  The <b>dump</b> method creates ascii dumps by default.

       If the named file already exists, the function will refuse to overwrite and will croak an error.   If  it
       doesn't exist, it will be created with the mode <b>0666</b> modified by the current <b>umask</b>.

       These defaults can be altered using the following <u>%options</u>:

       <b>binary</b> =&gt; 1
           Create dump in <u>binary</u> format.

       <b>mode</b> =&gt; <u>MODE</u>
           Set file mode to <u>MODE</u>.

       <b>overwrite</b> =&gt; 1
           Silently overwrite existing files.

   <b>load</b>
           $db-&gt;load($filename, %options)

       Load  the  data  from  the dump file <u>$filename</u> into the database <u>$db</u>.  The file must have been previously
       created using the <b>dump</b> method.  File format is recognized automatically.  By default, the  function  will
       croak  if  the  dump  contains  a  key  that already exists in the database.  It will silently ignore the
       failure to restore database mode and/or ownership.  These defaults can be  altered  using  the  following
       <u>%options</u>:

       <b>replace</b> =&gt; 1
           Replace existing keys.

       <b>restore_mode</b> =&gt; 0 | 1
           If <u>0</u>, don't try to restore the mode of the database file to that stored in the dump.

       <b>restore_owner</b> =&gt; 0 | 1
           If <u>0</u>, don't try to restore the owner of the database file to that stored in the dump.

       <b>strict_errors</b> =&gt; 1
           Croak if failed to restore ownership and/or mode.

       The usual sequence to recreate a database from the dump file is:

           my %hash;
           my $db = tie %hash, 'GDBM_File', 'a.db', GDBM_NEWDB, 0640;
           $db-&gt;load('a.dump');

</pre><h4><b>CRASH</b> <b>TOLERANCE</b></h4><pre>
       Crash  tolerance  is  a  new  feature  that,  given  appropriate  support from the OS and the filesystem,
       guarantees that a logically consistent recent state of the database can be recovered following  a  crash,
       such as power outage, OS kernel panic, or the like.

       Crash  tolerance  support  appeared  in  <b>gdbm</b>  version  1.21.   The  theory  behind  it  is  explained in
       "Crashproofing     the     Original     NoSQL      Key-Value      Store",      by      Terence      Kelly
       (&lt;https://queue.acm.org/detail.cfm?id=3487353&gt;).   A  detailed  discussion  of the <b>gdbm</b> implementation is
       available in the <b>GDBM</b> <b>Manual</b>  (&lt;https://www.gnu.org.ua/software/gdbm/manual/Crash-Tolerance.html&gt;).   The
       information below describes the Perl interface.

       For  maximum  robustness,  we recommend to use <u>extended</u> <u>database</u> <u>format</u> for crash tolerant databases.  To
       create a database in extended format, use the <b>GDBM_NEWDB|GDBM_NUMSYNC</b> when opening the database, e.g.:

           $db = tie %hash, 'GDBM_File', $filename,
                     GDBM_NEWDB|GDBM_NUMSYNC, 0640;

       To convert existing database to the extended format, use the <b>convert</b> method, described above, e.g.:

           $db-&gt;convert(GDBM_NUMSYNC);

   <b>crash_tolerance_status</b>
           GDBM_File-&gt;crash_tolerance_status;

       This static method returns the status of crash tolerance support.  A non-zero value means crash tolerance
       is compiled in and supported by the operating system.

   <b>failure_atomic</b>
           $db-&gt;failure_atomic($even, $odd)

       Enables crash tolerance for the database <b>$db</b>,  Arguments are the pathnames of  two  files  that  will  be
       created and filled with <u>snapshots</u> of the database file.  The two files must not exist when this method is
       called  and must reside on the same filesystem as the database file.  This filesystem must be support the
       <u>reflink</u>                                                                                         operation
       (https://www.gnu.org.ua/software/gdbm/manual/Filesystems-supporting-crash-tolerance.html&gt;.

       After  a successful call to <b>failure_atomic</b>, every call to <b>$db-</b>sync&gt; method will make an efficient reflink
       snapshot of the database file in one of these files; consecutive calls to <b>sync</b> alternate between the two,
       hence the names.

       The most recent of these files can be used to recover the database after a crash.  To  select  the  right
       snapshot, use the <b>latest_snapshot</b> static method.

   <b>latest_snapshot</b>
           $file = GDBM_File-&gt;latest_snapshot($even, $odd);

           ($file, $error) = GDBM_File-&gt;latest_snapshot($even, $odd);

       Given  the two snapshot names (the ones used previously in a call to <b>failure_atomic</b>), this method selects
       the one suitable for database recovery, i.e. the file which contains the most recent database snapshot.

       In scalar context, it returns the selected file name or <b>undef</b> in case of failure.

       In array context, the returns a list of two elements: the file name and status  code.   On  success,  the
       file  name is defined and the code is <b>GDBM_SNAPSHOT_OK</b>.  On error, the file name is <b>undef</b>, and the status
       is one of the following:

       GDBM_SNAPSHOT_BAD
           Neither snapshot file is applicable. This means  that  the  crash  has  occurred  before  a  call  to
           <b>failure_atomic</b>  completed.   In  this case, it is best to fall back on a safe backup copy of the data
           file.

       GDBM_SNAPSHOT_ERR
           A      system       error       occurred.        Examine       <b>$!</b>       for       details.        See
           &lt;https://www.gnu.org.ua/software/gdbm/manual/Crash-recovery.html&gt;  for  a comprehensive list of error
           codes and their meaning.

       GDBM_SNAPSHOT_SAME
           The file modes and modification dates of both snapshot files are exactly the same.  This  can  happen
           only for databases in standard format.

       GDBM_SNAPSHOT_SUSPICIOUS
           The  <u>numsync</u>  counters  of  the  two  snapshots differ by more than one.  The most probable reason is
           programmer's error: the two parameters refer to snapshots belonging to different database files.

</pre><h4><b>AVAILABILITY</b></h4><pre>
       gdbm is available from any GNU archive.  The master site is "ftp.gnu.org", but you are strongly urged  to
       use    one    of    the    many    mirrors.    You   can   obtain   a   list   of   mirror   sites   from
       &lt;<a href="http://www.gnu.org/order/ftp.html">http://www.gnu.org/order/ftp.html</a>&gt;.

</pre><h4><b>SECURITY</b> <b>AND</b> <b>PORTABILITY</b></h4><pre>
       GDBM files are not portable across platforms.  If you wish to transfer a GDBM file over the wire, dump it
       to a portable format first.

       <b>Do</b> <b>not</b> <b>accept</b> <b>GDBM</b> <b>files</b> <b>from</b> <b>untrusted</b> <b>sources.</b>

       Robustness of GDBM against corrupted databases depends highly on its version.  Versions prior to 1.15 did
       not implement any validity checking, so that a corrupted or maliciously crafted database file could cause
       perl to crash or even expose a security vulnerability.  Versions between 1.15 and 1.20 were progressively
       strengthened against invalid inputs.  Finally, version 1.21 had undergone extensive fuzzy checking  which
       proved its ability to withstand any kinds of inputs without crashing.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/perl.1.html">perl</a></b>(1), <b><a href="../man3/DB_File.3.html">DB_File</a></b>(3), perldbmfilter, <b><a href="../man3/gdbm.3.html">gdbm</a></b>(3), &lt;https://www.gnu.org.ua/software/gdbm/manual.html&gt;.

perl v5.40.1                                       2025-07-03                                   <u><a href="../man3perl/GDBM_File.3perl.html">GDBM_File</a></u>(3perl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>