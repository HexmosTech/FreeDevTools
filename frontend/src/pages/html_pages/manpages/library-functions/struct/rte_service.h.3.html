<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rte_service.h</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/dpdk-doc">dpdk-doc_24.11.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rte_service.h

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdint.h">stdint.h</a>&gt;
       #include &lt;rte_config.h&gt;
       #include &lt;rte_lcore.h&gt;

   <b>Macros</b>
       #define <b>RTE_SERVICE_CAP_MT_SAFE</b>   (1 &lt;&lt; 0)
       #define <b>RTE_SERVICE_ATTR_CYCLES</b>   0
       #define <b>RTE_SERVICE_ATTR_CALL_COUNT</b>   1
       #define <b>RTE_SERVICE_ATTR_IDLE_CALL_COUNT</b>   2
       #define <b>RTE_SERVICE_ATTR_ERROR_CALL_COUNT</b>   3
       #define <b>RTE_SERVICE_LCORE_ATTR_LOOPS</b>   0
       #define <b>RTE_SERVICE_LCORE_ATTR_CYCLES</b>   1

   <b>Functions</b>
       uint32_t <b>rte_service_get_count</b> (void)
       int32_t <b>rte_service_get_by_name</b> (const char *name, uint32_t *service_id)
       const char * <b>rte_service_get_name</b> (uint32_t id)
       int32_t <b>rte_service_probe_capability</b> (uint32_t id, uint32_t capability)
       int32_t <b>rte_service_map_lcore_set</b> (uint32_t service_id, uint32_t lcore, uint32_t enable)
       int32_t <b>rte_service_map_lcore_get</b> (uint32_t service_id, uint32_t lcore)
       int32_t <b>rte_service_runstate_set</b> (uint32_t id, uint32_t runstate)
       int32_t <b>rte_service_runstate_get</b> (uint32_t id)
       int32_t <b>rte_service_may_be_active</b> (uint32_t id)
       int32_t <b>rte_service_set_runstate_mapped_check</b> (uint32_t id, int32_t enable)
       int32_t <b>rte_service_run_iter_on_app_lcore</b> (uint32_t id, uint32_t serialize_multithread_unsafe)
       int32_t <b>rte_service_lcore_start</b> (uint32_t lcore_id)
       int32_t <b>rte_service_lcore_stop</b> (uint32_t lcore_id)
       int32_t <b>rte_service_lcore_may_be_active</b> (uint32_t lcore_id)
       int32_t <b>rte_service_lcore_add</b> (uint32_t lcore)
       int32_t <b>rte_service_lcore_del</b> (uint32_t lcore)
       int32_t <b>rte_service_lcore_count</b> (void)
       int32_t <b>rte_service_lcore_reset_all</b> (void)
       int32_t <b>rte_service_set_stats_enable</b> (uint32_t id, int32_t enable)
       int32_t <b>rte_service_lcore_list</b> (uint32_t array[], uint32_t n)
       int32_t <b>rte_service_lcore_count_services</b> (uint32_t lcore)
       int32_t <b>rte_service_dump</b> (FILE *f, uint32_t id)
       int32_t <b>rte_service_attr_get</b> (uint32_t id, uint32_t attr_id, uint64_t *attr_value)
       int32_t <b>rte_service_attr_reset_all</b> (uint32_t id)
       int32_t <b>rte_service_lcore_attr_get</b> (uint32_t lcore, uint32_t attr_id, uint64_t *attr_value)
       int32_t <b>rte_service_lcore_attr_reset_all</b> (uint32_t lcore)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       Service functions

       The service functionality provided by this header allows a DPDK component to indicate that it requires a
       function call in order for it to perform its processing.

       An example usage of this functionality would be a component that registers a service to perform a
       particular packet processing duty: for example the eventdev software PMD. At startup the application
       requests all services that have been registered, and the cores in the service-coremask run the required
       services. The EAL removes these number of cores from the available runtime cores, and dedicates them to
       performing service-core workloads. The application has access to the remaining lcores as normal.

       Definition in file <b>rte_service.h</b>.

</pre><h4><b>Macro</b> <b>Definition</b> <b>Documentation</b></h4><pre>
   <b>#define</b> <b>RTE_SERVICE_CAP_MT_SAFE</b>   <b>(1</b> <b>&lt;&lt;</b> <b>0)</b>
       When set, the service is capable of having multiple threads run it at the same time.

       Definition at line <b>46</b> of file <b>rte_service.h</b>.

   <b>#define</b> <b>RTE_SERVICE_ATTR_CYCLES</b>   <b>0</b>
       Returns the number of cycles that this service has consumed. Only cycles spent in non-idle calls (i.e.,
       calls not returning -EAGAIN) count.

       Definition at line <b>381</b> of file <b>rte_service.h</b>.

   <b>#define</b> <b>RTE_SERVICE_ATTR_CALL_COUNT</b>   <b>1</b>
       Returns the total number of invocations of this service function (regardless of return value).

       Definition at line <b>387</b> of file <b>rte_service.h</b>.

   <b>#define</b> <b>RTE_SERVICE_ATTR_IDLE_CALL_COUNT</b>   <b>2</b>
       Returns the number of invocations of this service function where the service reported having not
       performed any useful work (i.e., returned -EAGAIN).

       Definition at line <b>394</b> of file <b>rte_service.h</b>.

   <b>#define</b> <b>RTE_SERVICE_ATTR_ERROR_CALL_COUNT</b>   <b>3</b>
       Returns the number of invocations of this service function where the service reported an error (i.e., the
       return value was neither 0 nor -EAGAIN).

       Definition at line <b>401</b> of file <b>rte_service.h</b>.

   <b>#define</b> <b>RTE_SERVICE_LCORE_ATTR_LOOPS</b>   <b>0</b>
       Returns the number of times the service runner has looped.

       Definition at line <b>424</b> of file <b>rte_service.h</b>.

   <b>#define</b> <b>RTE_SERVICE_LCORE_ATTR_CYCLES</b>   <b>1</b>
       Returns the total number of cycles that the lcore has spent on running services. Only non-idle calls
       (i.e., calls not returning -EAGAIN) count toward this total.

       Definition at line <b>431</b> of file <b>rte_service.h</b>.

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>uint32_t</b> <b>rte_service_get_count</b> <b>(void)</b>
       Return the number of services registered.

       <b>Returns</b>
           The number of services registered.

   <b>int32_t</b> <b>rte_service_get_by_name</b> <b>(const</b> <b>char</b> <b>*</b> <b>name,</b> <b>uint32_t</b> <b>*</b> <b>service_id)</b>
       Return the id of a service by name.

       This function provides the id of the service using the service name as lookup key. The service id is to
       be passed to other functions in the rte_service_* API.

       Example usage:

       uint32_t service_id;
       int32_t ret = rte_service_get_by_name("service_X", &amp;service_id);
       if (ret) {
               // handle error
       }

       <b>Parameters</b>
           <u>name</u> The name of the service to retrieve
           <u>service_id</u> A pointer to a uint32_t, to be filled in with the id.

       <b>Return</b> <b>values</b>
           <u>0</u> Success. The service id is provided in <u>service_id</u>.
           <u>-EINVAL</u> Null <u>service_id</u> pointer provided
           <u>-ENODEV</u> No such service registered

   <b>const</b> <b>char</b> <b>*</b> <b>rte_service_get_name</b> <b>(uint32_t</b> <b>id)</b>
       Return the name of the service.

       <b>Returns</b>
           A pointer to the name of the service. The returned pointer remains in ownership of the service, and
           the application must not free it.

   <b>int32_t</b> <b>rte_service_probe_capability</b> <b>(uint32_t</b> <b>id,</b> <b>uint32_t</b> <b>capability)</b>
       Check if a service has a specific capability.

       This function returns if <u>service</u> has implements <u>capability</u>. See RTE_SERVICE_CAP_* defines for a list of
       valid capabilities.

       <b>Return</b> <b>values</b>
           <u>1</u> Capability supported by this service instance
           <u>0</u> Capability not supported by this service instance

   <b>int32_t</b> <b>rte_service_map_lcore_set</b> <b>(uint32_t</b> <b>service_id,</b> <b>uint32_t</b> <b>lcore,</b> <b>uint32_t</b> <b>enable)</b>
       Map or unmap a lcore to a service.

       Each core can be added or removed from running a specific service. This function enables or disables
       <u>lcore</u> to run <u>service_id</u>.

       If multiple cores are enabled on a service, a lock is used to ensure that only one core runs the service
       at a time. The exception to this is when a service indicates that it is multi-thread safe by setting the
       capability called RTE_SERVICE_CAP_MT_SAFE. With the multi-thread safe capability set, the service
       function can be run on multiple threads at the same time.

       If the service is known to be mapped to a single lcore, setting the capability of the service to
       RTE_SERVICE_CAP_MT_SAFE can achieve better performance by avoiding the use of lock.

       <b>Parameters</b>
           <u>service_id</u> the service to apply the lcore to
           <u>lcore</u> The lcore that will be mapped to service
           <u>enable</u> Zero to unmap or disable the core, non-zero to enable

       <b>Return</b> <b>values</b>
           <u>0</u> lcore map updated successfully
           <u>-EINVAL</u> An invalid service or lcore was provided.

   <b>int32_t</b> <b>rte_service_map_lcore_get</b> <b>(uint32_t</b> <b>service_id,</b> <b>uint32_t</b> <b>lcore)</b>
       Retrieve the mapping of an lcore to a service.

       <b>Parameters</b>
           <u>service_id</u> the service to apply the lcore to
           <u>lcore</u> The lcore that will be mapped to service

       <b>Return</b> <b>values</b>
           <u>1</u> lcore is mapped to service
           <u>0</u> lcore is not mapped to service
           <u>-EINVAL</u> An invalid service or lcore was provided.

   <b>int32_t</b> <b>rte_service_runstate_set</b> <b>(uint32_t</b> <b>id,</b> <b>uint32_t</b> <b>runstate)</b>
       Set the runstate of the service.

       Each service is either running or stopped. Setting a non-zero runstate enables the service to run, while
       setting runstate zero disables it.

       <b>Parameters</b>
           <u>id</u> The id of the service
           <u>runstate</u> The run state to apply to the service

       <b>Return</b> <b>values</b>
           <u>0</u> The service was successfully started
           <u>-EINVAL</u> Invalid service id

   <b>int32_t</b> <b>rte_service_runstate_get</b> <b>(uint32_t</b> <b>id)</b>
       Get the runstate for the service with <u>id</u>. See <b>rte_service_runstate_set()</b> for details of runstates. A
       service can call this function to ensure that the application has indicated that it will receive CPU
       cycles. Either a service-core is mapped (default case), or the application has explicitly disabled the
       check that a service-cores is mapped to the service and takes responsibility to run the service manually
       using the available function <b>rte_service_run_iter_on_app_lcore()</b> to do so.

       <b>Return</b> <b>values</b>
           <u>1</u> Service is running
           <u>0</u> Service is stopped
           <u>-EINVAL</u> Invalid service id

   <b>int32_t</b> <b>rte_service_may_be_active</b> <b>(uint32_t</b> <b>id)</b>
       This function returns whether the service may be currently executing on at least one lcore, or definitely
       is not. This function can be used to determine if, after setting the service runstate to stopped, the
       service is still executing a service lcore.

       Care must be taken if calling this function when the service runstate is running, since the result of
       this function may be incorrect by the time the function returns due to service cores running in parallel.

       <b>Return</b> <b>values</b>
           <u>1</u> Service may be running on one or more lcores
           <u>0</u> Service is not running on any lcore
           <u>-EINVAL</u> Invalid service id

   <b>int32_t</b> <b>rte_service_set_runstate_mapped_check</b> <b>(uint32_t</b> <b>id,</b> <b>int32_t</b> <b>enable)</b>
       Enable or disable the check for a service-core being mapped to the service. An application can disable
       the check when takes the responsibility to run a service itself using
       <b>rte_service_run_iter_on_app_lcore()</b>.

       <b>Parameters</b>
           <u>id</u> The id of the service to set the check on
           <u>enable</u> When zero, the check is disabled. Non-zero enables the check.

       <b>Return</b> <b>values</b>
           <u>0</u> Success
           <u>-EINVAL</u> Invalid service ID

   <b>int32_t</b> <b>rte_service_run_iter_on_app_lcore</b> <b>(uint32_t</b> <b>id,</b> <b>uint32_t</b> <b>serialize_multithread_unsafe)</b>
       This function runs a service callback from a non-service lcore.

       This function is designed to enable gradual porting to service cores, and to enable unit tests to verify
       a service behaves as expected.

       When called, this function ensures that the service identified by <u>id</u> is safe to run on this lcore. Multi-
       thread safe services are invoked even if other cores are simultaneously running them as they are multi-
       thread safe.

       Multi-thread unsafe services are handled depending on the variable <u>serialize_multithread_unsafe</u>:

       • When  set,  the function will check if a service is already being invoked on another lcore, refusing to
         run it and returning -EBUSY.

       • When zero, the application takes responsibility to ensure that the service indicated by <u>id</u> is not going
         to be invoked by another lcore. This setting  avoids  atomic  operations,  so  is  likely  to  be  more
         performant.

       <b>Parameters</b>
           <u>id</u> The ID of the service to run
           <u>serialize_multithread_unsafe</u>  This parameter indicates to the service cores library if it is required
           to use atomics to serialize access to mult-thread unsafe services. As there is an overhead  in  using
           atomics, applications can choose to enable or disable this feature

       Note  that  any thread calling this function MUST be a DPDK EAL thread, as the <b>rte_lcore_id()</b> function is
       used to access internal data structures.

       <b>Return</b> <b>values</b>
           <u>0</u> Service was run on the calling thread successfully
           <u>-EBUSY</u> Another lcore is executing the service, and it is not a  multi-thread  safe  service,  so  the
           service was not run on this lcore
           <u>-ENOEXEC</u> Service is not in a run-able state
           <u>-EINVAL</u> Invalid service id

   <b>int32_t</b> <b>rte_service_lcore_start</b> <b>(uint32_t</b> <b>lcore_id)</b>
       Start a service core.

       Starting  a  core  makes  the  core  begin  polling.  Any  services assigned to it will be run as fast as
       possible.  The  application  must  ensure  that  the  lcore  is  in  a  launchable   state:   e.g.   call
       rte_eal_lcore_wait() on the lcore_id before calling this function.

       <b>Return</b> <b>values</b>
           <u>0</u> Success
           <u>-EINVAL</u> Failed to start core. The <u>lcore_id</u> passed in is not currently assigned to be a service core.

   <b>int32_t</b> <b>rte_service_lcore_stop</b> <b>(uint32_t</b> <b>lcore_id)</b>
       Stop a service core.

       Stopping a core makes the core become idle, but remains assigned as a service core. Note that the service
       lcore thread may not have returned from the service it is running when this API returns.

       The <b>rte_service_lcore_may_be_active()</b> API can be used to check if the service lcore is * still active.

       <b>Return</b> <b>values</b>
           <u>0</u> Success
           <u>-EINVAL</u> Invalid <u>lcore_id</u> provided
           <u>-EALREADY</u> Already stopped core
           <u>-EBUSY</u>  Failed  to  stop  core,  as  it would cause a service to not be run, as this is the only core
           currently running the service. The application must stop the service first, and then stop the lcore.

   <b>int32_t</b> <b>rte_service_lcore_may_be_active</b> <b>(uint32_t</b> <b>lcore_id)</b>
       Reports if a service lcore is currently running.

       This function returns if the core has finished service cores code, and has returned to  EAL  control.  If
       <b>rte_service_lcore_stop()</b>  has been called but the lcore has not returned to EAL yet, it might be required
       to wait and call this function again. The amount of time to wait before the core returns depends  on  the
       duration of the services being run.

       <b>Return</b> <b>values</b>
           <u>0</u> Service thread is not active, and lcore has been returned to EAL.
           <u>1</u> Service thread is in the service core polling loop.
           <u>-EINVAL</u> Invalid <u>lcore_id</u> provided.

   <b>int32_t</b> <b>rte_service_lcore_add</b> <b>(uint32_t</b> <b>lcore)</b>
       Adds lcore to the list of service cores.

       This functions can be used at runtime in order to modify the service core mask.

       <b>Return</b> <b>values</b>
           <u>0</u> Success
           <u>-EBUSY</u> lcore is busy, and not available for service core duty
           <u>-EALREADY</u> lcore is already added to the service core list
           <u>-EINVAL</u> Invalid lcore provided

   <b>int32_t</b> <b>rte_service_lcore_del</b> <b>(uint32_t</b> <b>lcore)</b>
       Removes lcore from the list of service cores.

       This can fail if the core is not stopped, see rte_service_core_stop().

       <b>Return</b> <b>values</b>
           <u>0</u> Success
           <u>-EBUSY</u> Lcore is not stopped, stop service core before removing.
           <u>-EINVAL</u> failed to add lcore to service core mask.

   <b>int32_t</b> <b>rte_service_lcore_count</b> <b>(void)</b>
       Retrieve the number of service cores currently available.

       This function returns the integer count of service cores available. The service core count can be used in
       mapping logic when creating mappings from service cores to services.

       See <b>rte_service_lcore_list()</b> for details on retrieving the lcore_id of each service core.

       <b>Returns</b>
           The number of service cores currently configured.

   <b>int32_t</b> <b>rte_service_lcore_reset_all</b> <b>(void)</b>
       Resets  all  service  core  mappings.  This  does not remove the service cores from duty, just unmaps all
       services / cores, and stops() the service cores. The runstate of services is not modified.

       The cores that are stopped with this call, are in WAIT state.

       <b>Return</b> <b>values</b>
           <u>0</u> Success

   <b>int32_t</b> <b>rte_service_set_stats_enable</b> <b>(uint32_t</b> <b>id,</b> <b>int32_t</b> <b>enable)</b>
       Enable or disable statistics collection for <u>service</u>.

       This function enables per core, per-service cycle count collection.

       <b>Parameters</b>
           <u>id</u> The service to enable statistics gathering on.
           <u>enable</u> Zero to disable statistics, non-zero to enable.

       <b>Return</b> <b>values</b>
           <u>0</u> Success
           <u>-EINVAL</u> Invalid service pointer passed

   <b>int32_t</b> <b>rte_service_lcore_list</b> <b>(uint32_t</b> <b>array[],</b> <b>uint32_t</b> <b>n)</b>
       Retrieve the list of currently enabled service cores.

       This function fills in an application supplied array, with each element  indicating  the  lcore_id  of  a
       service core.

       Adding    and   removing   service   cores   can   be   performed   using   <b>rte_service_lcore_add()</b>   and
       <b>rte_service_lcore_del()</b>.

       <b>Parameters</b>
           <u>array</u> An array of at least <b>rte_service_lcore_count()</b> items. If statically allocating the buffer,  use
           RTE_MAX_LCORE.
           <u>n</u> The size of <u>array</u>.

       <b>Return</b> <b>values</b>
           <u>&gt;=0</u> Number of service cores that have been populated in the array
           <u>-ENOMEM</u>  The  provided array is not large enough to fill in the service core list. No items have been
           populated, call this function with a size of at least rte_service_core_count() items.

   <b>int32_t</b> <b>rte_service_lcore_count_services</b> <b>(uint32_t</b> <b>lcore)</b>
       Get the number of services running on the supplied lcore.

       <b>Parameters</b>
           <u>lcore</u> Id of the service core.

       <b>Return</b> <b>values</b>
           <u>&gt;=0</u> Number of services registered to this core.
           <u>-EINVAL</u> Invalid lcore provided
           <u>-ENOTSUP</u> The provided lcore is not a service core.

   <b>int32_t</b> <b>rte_service_dump</b> <b>(FILE</b> <b>*</b> <b>f,</b> <b>uint32_t</b> <b>id)</b>
       Dumps any information available about the service. When id is UINT32_MAX, this function  dumps  info  for
       all services.

       <b>Return</b> <b>values</b>
           <u>0</u> Statistics have been successfully dumped
           <u>-EINVAL</u> Invalid service id provided

   <b>int32_t</b> <b>rte_service_attr_get</b> <b>(uint32_t</b> <b>id,</b> <b>uint32_t</b> <b>attr_id,</b> <b>uint64_t</b> <b>*</b> <b>attr_value)</b>
       Get an attribute from a service.

       <b>Return</b> <b>values</b>
           <u>0</u>  Success,  the  attribute  value  has  been  written  to <u>attr_value</u>. -EINVAL Invalid id, attr_id or
           attr_value was NULL.

   <b>int32_t</b> <b>rte_service_attr_reset_all</b> <b>(uint32_t</b> <b>id)</b>
       Reset all attribute values of a service.

       <b>Parameters</b>
           <u>id</u> The service to reset all statistics of

       <b>Return</b> <b>values</b>
           <u>0</u> Successfully reset attributes -EINVAL Invalid service id provided

   <b>int32_t</b> <b>rte_service_lcore_attr_get</b> <b>(uint32_t</b> <b>lcore,</b> <b>uint32_t</b> <b>attr_id,</b> <b>uint64_t</b> <b>*</b> <b>attr_value)</b>
       Get an attribute from a service core.

       <b>Parameters</b>
           <u>lcore</u> Id of the service core.
           <u>attr_id</u> Id of the attribute to be retrieved.
           <u>attr_value</u> Pointer to storage in which to write retrieved value.

       <b>Return</b> <b>values</b>
           <u>0</u> Success, the attribute value has been written to <u>attr_value</u>.  -EINVAL  Invalid  lcore,  attr_id  or
           attr_value was NULL. -ENOTSUP lcore is not a service core.

   <b>int32_t</b> <b>rte_service_lcore_attr_reset_all</b> <b>(uint32_t</b> <b>lcore)</b>
       Reset all attribute values of a service core.

       <b>Parameters</b>
           <u>lcore</u> The service core to reset all the statistics of

       <b>Return</b> <b>values</b>
           <u>0</u>  Successfully  reset attributes -EINVAL Invalid service id provided -ENOTSUP lcore is not a service
           core.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for DPDK from the source code.

DPDK                                             Version 24.11.2                                <u><a href="../man3/rte_service.h.3.html">rte_service.h</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>