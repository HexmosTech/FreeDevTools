<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>libwget-io - I/O helper routines</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/wget2-dev">wget2-dev_2.2.0+ds-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       libwget-io - I/O helper routines

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Functions</b>
       ssize_t <b>wget_fdgetline</b> (char **buf, size_t *bufsize, int fd)
       ssize_t <b>wget_getline</b> (char **buf, size_t *bufsize, FILE *fp)
       int <b>wget_ready_2_transfer</b> (int fd, int timeout, int mode)
       int <b>wget_ready_2_read</b> (int fd, int timeout)
       int <b>wget_ready_2_write</b> (int fd, int timeout)
       char * <b>wget_read_file</b> (const char *fname, size_t *size)
       int <b>wget_update_file</b> (const char *fname, wget_update_load_fn *load_func, wget_update_save_fn *save_func,
           void *context)
       int <b>wget_truncate</b> (const char *path, off_t length)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       Some general I/O helper functions that could be handy for developers.

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>ssize_t</b> <b>wget_fdgetline</b> <b>(char</b> <b>**</b> <b>buf,</b> <b>size_t</b> <b>*</b> <b>bufsize,</b> <b>int</b> <b>fd)</b>
       <b>Parameters</b>
           <u>buf</u> Pointer to a pointer that will be set up by the function to point to the read line
           <u>bufsize</u> Pointer to a variable where the length of the read line will be put
           <u>fd</u> File descriptor for an open file

       <b>Returns</b>
           The length of the last line read or a WGET_E_* error code (&lt; 0)

       Behaves identically as <b>wget_getline()</b>, but uses a file descriptor instead of a stream.

   <b>ssize_t</b> <b>wget_getline</b> <b>(char</b> <b>**</b> <b>buf,</b> <b>size_t</b> <b>*</b> <b>bufsize,</b> <b>FILE</b> <b>*</b> <b>fp)</b>
       <b>Parameters</b>
           <u>buf</u> Pointer to a pointer that will be set up by the function to point to the read line
           <u>bufsize</u> Pointer to a variable where the length of the read line will be put
           <u>fp</u> Pointer to an open file's stream handle (FILE *)

       <b>Returns</b>
           The length of the last line read or a WGET_E_* error code (&lt; 0)

       This function will read a line from the open file handle fp. This function reads input characters until
       either a newline character (\\n) is found or EOF is reached. A block of memory large enough to hold the
       read line will be implicitly allocated by the function, and its address placed at the pointer pointed to
       by buf. The length of the aforementioned memory block will be stored in the variable pointed at by
       bufsize.

       The caller is not expected to allocate memory as that will be automatically done by <b>wget_getline()</b>, but
       it is responsibility of the caller free the memory allocated by a previous invocation of this function.
       The caller is also responsible for opening and closing the file to read from.

       Subsequent calls to <b>wget_getline()</b> that use the same block of memory allocated by previous calls (that
       is, the caller did not free the buffer returned by a previous call to <b>wget_getline()</b>) will try to reuse
       as much as possible from the available memory. The block of memory allocated by <b>wget_getline()</b> may be
       larger than the length of the line read, and might even contain additional lines in it. When
       <b>wget_getline()</b> returns, the contents of the buffer (pointed at by buf) are guaranteed to start with the
       first character of the last line read, and such line is also guaranteed to end with a NULL termination
       character (\0). The length of the last read line will be returned by <b>wget_getline()</b>, whereas the actual
       length of the buffer will be placed in the variable pointed at by bufsize. The newline character (\\n)
       will not be included in the last read line.

   <b>int</b> <b>wget_ready_2_transfer</b> <b>(int</b> <b>fd,</b> <b>int</b> <b>timeout,</b> <b>int</b> <b>mode)</b>
       <b>Parameters</b>
           <u>fd</u> File descriptor to wait for
           <u>timeout</u> Max. duration in milliseconds to wait
           <u>mode</u> Either WGET_IO_WRITABLE or WGET_IO_READABLE

       <b>Returns</b>
           -1 on error
            0 on timeout - the file descriptor is not ready for reading or writing
            &gt;0 The file descriptor is ready for reading or writing. Check for the bitwise or of WGET_IO_WRITABLE
           and WGET_IO_READABLE.

       Wait for a file descriptor to become ready to read or write.

       A timeout value of 0 means the function returns immediately.
        A timeout value of -1 means infinite timeout.

   <b>int</b> <b>wget_ready_2_read</b> <b>(int</b> <b>fd,</b> <b>int</b> <b>timeout)</b>
       <b>Parameters</b>
           <u>fd</u> File descriptor to wait for
           <u>timeout</u> Max. duration in milliseconds to wait

       <b>Returns</b>
           -1 on error
            0 on timeout - the file descriptor is not ready for reading
            1 on success - the file descriptor is ready for reading

       Wait for a file descriptor to become ready to read.

       A timeout value of 0 means the function returns immediately.
        A timeout value of -1 means infinite timeout.

   <b>int</b> <b>wget_ready_2_write</b> <b>(int</b> <b>fd,</b> <b>int</b> <b>timeout)</b>
       <b>Parameters</b>
           <u>fd</u> File descriptor to wait for
           <u>timeout</u> Max. duration in milliseconds to wait

       <b>Returns</b>
           -1 on error
            0 on timeout - the file descriptor is not ready for writing
            1 on success - the file descriptor is ready for writing

       Wait for a file descriptor to become ready to write.

       A timeout value of 0 means the function returns immediately.
        A timeout value of -1 means infinite timeout.

   <b>char</b> <b>*</b> <b>wget_read_file</b> <b>(const</b> <b>char</b> <b>*</b> <b>fname,</b> <b>size_t</b> <b>*</b> <b>size)</b>
       <b>Parameters</b>
           <u>fname</u> The name of the file to read from, or a dash (-) to read from STDIN
           <u>size</u> Pointer to a variable where the length of the contents read will be stored

       <b>Returns</b>
           Pointer to the read data, as a NULL-terminated C string

       Reads the content of a file, or from STDIN. When reading from STDIN, the behavior is the same as for
       regular files: input is read until an EOF character is found.

       Memory will be accordingly allocated by <b>wget_read_file()</b> and a pointer to it returned when the read
       finishes, but the caller is responsible for freeing that memory. The length of the allocated block of
       memory, which is guaranteed to be the same as the length of the data read, will be placed in the variable
       pointed at by size.

       The read data is guaranteed to be appended a NUL termination character (\0).

   <b>int</b> <b>wget_update_file</b> <b>(const</b> <b>char</b> <b>*</b> <b>fname,</b> <b>wget_update_load_fn</b> <b>*</b> <b>load_func,</b> <b>wget_update_save_fn</b> <b>*</b> <b>save_func,</b>
       <b>void</b> <b>*</b> <b>context)</b>
       <b>Parameters</b>
           <u>fname</u> File name to update
           <u>load_func</u> Pointer to the loader function
           <u>save_func</u> Pointer to the saver function
           <u>context</u> Context data

       <b>Returns</b>
           0 on success, or WGET_E_* on error

       This function updates the file named fname atomically. It lets two caller-provided functions do the
       actual updating. A lock file is created first under <a href="file:/tmp">/tmp</a> to ensure exclusive access to the file. Other
       processes attempting to call <b>wget_update_file()</b> with the same fname parameter will block until the
       current calling process has finished (that is, until <b>wget_update_file()</b> has returned).
        Then, the file is opened with read access first, and the load_func function is called. When it returns,
       the file is closed and opened again with write access, and the save_func function is called. Both
       callback functions are passed the context data context, and a stream descriptor for the file. If either
       function load_func or save_func returns a non-zero value, <b>wget_update_file()</b> closes the file and returns
       -1, performing no further actions.

   <b>int</b> <b>wget_truncate</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>off_t</b> <b>length)</b>
       <b>Parameters</b>
           <u>path</u> File path
           <u>length</u> New file size

       <b>Returns</b>
           0 on success, or -1 on error

       Set path to a size of exactly length bytes.

       If the file was previously larger, the extra data is lost. If the file was previously shorter, extra zero
       bytes are added.

       On POSIX, this is a wrapper around ftruncate() (see 'man ftruncate' for details).

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for wget2 from the source code.

wget2                                             Version 2.2.0                                    <u><a href="../man3/libwget-io.3.html">libwget-io</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>