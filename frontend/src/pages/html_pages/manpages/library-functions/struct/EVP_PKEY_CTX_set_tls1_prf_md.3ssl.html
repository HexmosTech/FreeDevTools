<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_PKEY_CTX_set_tls1_prf_md, EVP_PKEY_CTX_set1_tls1_prf_secret, EVP_PKEY_CTX_add1_tls1_prf_seed - TLS</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_PKEY_CTX_set_tls1_prf_md, EVP_PKEY_CTX_set1_tls1_prf_secret, EVP_PKEY_CTX_add1_tls1_prf_seed - TLS
       PRF key derivation algorithm

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/kdf.h&gt;

        int EVP_PKEY_CTX_set_tls1_prf_md(EVP_PKEY_CTX *pctx, const EVP_MD *md);
        int EVP_PKEY_CTX_set1_tls1_prf_secret(EVP_PKEY_CTX *pctx,
                                              unsigned char *sec, int seclen);
        int EVP_PKEY_CTX_add1_tls1_prf_seed(EVP_PKEY_CTX *pctx,
                                            unsigned char *seed, int seedlen);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>EVP_PKEY_TLS1_PRF</b> algorithm implements the PRF key derivation function for TLS. It has no associated
       private key and only implements key derivation using <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3).

       <b>EVP_PKEY_set_tls1_prf_md()</b> sets the message digest associated with the TLS PRF. <b>EVP_md5_sha1()</b> is treated
       as a special case which uses the PRF algorithm using both <b>MD5</b> and <b>SHA1</b> as used in TLS 1.0 and 1.1.

       <b>EVP_PKEY_CTX_set_tls1_prf_secret()</b> sets the secret value of the TLS PRF to <b>seclen</b> bytes of the buffer
       <b>sec</b>. Any existing secret value is replaced and any seed is reset.

       <b>EVP_PKEY_CTX_add1_tls1_prf_seed()</b> sets the seed to <b>seedlen</b> bytes of <b>seed</b>.  If a seed is already set it is
       appended to the existing value.

</pre><h4><b>STRING</b> <b>CTRLS</b></h4><pre>
       The TLS PRF also supports string based control operations using <b><a href="../man3/EVP_PKEY_CTX_ctrl_str.3.html">EVP_PKEY_CTX_ctrl_str</a></b>(3).  The <b>type</b>
       parameter "md" uses the supplied <b>value</b> as the name of the digest algorithm to use.  The <b>type</b> parameters
       "secret" and "seed" use the supplied <b>value</b> parameter as a secret or seed value.  The names "hexsecret"
       and "hexseed" are similar except they take a hex string which is converted to binary.

</pre><h4><b>NOTES</b></h4><pre>
       A context for the TLS PRF can be obtained by calling:

        EVP_PKEY_CTX *pctx = EVP_PKEY_CTX_new_id(EVP_PKEY_TLS1_PRF, NULL);

       The digest, secret value and seed must be set before a key is derived or an error occurs.

       The total length of all seeds cannot exceed 1024 bytes in length: this should be more than enough for any
       normal use of the TLS PRF.

       The output length of the PRF is specified by the length parameter in the <b>EVP_PKEY_derive()</b> function.
       Since the output length is variable, setting the buffer to <b>NULL</b> is not meaningful for the TLS PRF.

       Optimised versions of the TLS PRF can be implemented in an ENGINE.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       All these functions return 1 for success and 0 or a negative value for failure.  In particular a return
       value of -2 indicates the operation is not supported by the public key algorithm.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This example derives 10 bytes using SHA-256 with the secret key "secret" and seed value "seed":

        EVP_PKEY_CTX *pctx;
        unsigned char out[10];
        size_t outlen = sizeof(out);

        pctx = EVP_PKEY_CTX_new_id(EVP_PKEY_TLS1_PRF, NULL);
        if (EVP_PKEY_derive_init(pctx) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_set_tls1_prf_md(pctx, EVP_sha256()) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_set1_tls1_prf_secret(pctx, "secret", 6) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_add1_tls1_prf_seed(pctx, "seed", 4) &lt;= 0)
            /* Error */
        if (EVP_PKEY_derive(pctx, out, &amp;outlen) &lt;= 0)
            /* Error */

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_PKEY_CTX_new.3.html">EVP_PKEY_CTX_new</a></b>(3), <b><a href="../man3/EVP_PKEY_CTX_ctrl_str.3.html">EVP_PKEY_CTX_ctrl_str</a></b>(3), <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       All of the functions described here were converted from macros to functions in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2016-2020 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                 <u><a href="../man3SSL/EVP_PKEY_CTX_SET_TLS1_PRF_MD.3SSL.html">EVP_PKEY_CTX_SET_TLS1_PRF_MD</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>