<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_add_expected_rpk, SSL_get_negotiated_client_cert_type, SSL_get_negotiated_server_cert_type,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_add_expected_rpk, SSL_get_negotiated_client_cert_type, SSL_get_negotiated_server_cert_type,
       SSL_get0_peer_rpk, SSL_SESSION_get0_peer_rpk - raw public key (RFC7250) support

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        int SSL_add_expected_rpk(SSL *s, EVP_PKEY *rpk);
        int SSL_get_negotiated_client_cert_type(const SSL *s);
        int SSL_get_negotiated_server_cert_type(const SSL *s);
        EVP_PKEY *SSL_get0_peer_rpk(const SSL *s);
        EVP_PKEY *SSL_SESSION_get0_peer_rpk(const SSL_SESSION *ss);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_add_expected_rpk()</b> adds a DANE TLSA record matching public key <b>rpk</b> to SSL <b>s</b>'s DANE validation policy.

       <b>SSL_get_negotiated_client_cert_type()</b> returns the connection's negotiated client certificate type.

       <b>SSL_get_negotiated_server_cert_type()</b> returns the connection's negotiated server certificate type.

       <b>SSL_get0_peer_rpk()</b> returns the peer's raw public key from SSL <b>s</b>.

       <b>SSL_SESSION_get0_peer_rpk()</b> returns the peer's raw public key from SSL_SESSION <b>ss</b>.

</pre><h4><b>NOTES</b></h4><pre>
       Raw public keys are used in place of certificates when the option is negotiated.  <b>SSL_add_expected_rpk()</b>
       may be called multiple times to configure multiple trusted keys, this makes it possible to allow for key
       rotation, where a peer might be expected to offer an "old" or "new" key and the endpoint must be able to
       accept either one.

       When raw public keys are used, the certificate verify callback is called, and may be used to inspect the
       public key via <b><a href="../man3/X509_STORE_CTX_get0_rpk.3.html">X509_STORE_CTX_get0_rpk</a></b>(3).  Raw public keys have no subject, issuer, validity dates nor
       digital signature to verify. They can, however, be matched verbatim or by their digest value, this is
       done by specifying one or more TLSA records, see <b><a href="../man3/SSL_CTX_dane_enable.3.html">SSL_CTX_dane_enable</a></b>(3).

       The raw public key is typically taken from the certificate assigned to the connection (e.g. via
       <b><a href="../man3/SSL_use_certificate.3.html">SSL_use_certificate</a></b>(3)), but if a certificate is not configured, then the public key will be extracted
       from the assigned private key.

       The <b>SSL_add_expected_rpk()</b> function is a wrapper around <b><a href="../man3/SSL_dane_tlsa_add.3.html">SSL_dane_tlsa_add</a></b>(3).  When DANE is enabled via
       <b><a href="../man3/SSL_dane_enable.3.html">SSL_dane_enable</a></b>(3), the configured TLSA records will be used to validate the peer's public key or
       certificate.  If DANE is not enabled, then no validation will occur.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_add_expected_rpk()</b> returns 1 on success and 0 on failure.

       <b>SSL_get0_peer_rpk()</b> and <b>SSL_SESSION_get0_peer_rpk()</b> return the peer's raw public key as an EVP_PKEY or
       NULL when the raw public key is not available.

       <b>SSL_get_negotiated_client_cert_type()</b> and <b>SSL_get_negotiated_server_cert_type()</b> return one of the
       following values:

       TLSEXT_cert_type_x509
       TLSEXT_cert_type_rpk

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/SSL_CTX_dane_enable.3.html">SSL_CTX_dane_enable</a></b>(3),     <b><a href="../man3/SSL_CTX_set_options.3.html">SSL_CTX_set_options</a></b>(3),     <b><a href="../man3/SSL_dane_enable.3.html">SSL_dane_enable</a></b>(3),     <b><a href="../man3/SSL_get_verify_result.3.html">SSL_get_verify_result</a></b>(3),
       <b><a href="../man3/SSL_set_verify.3.html">SSL_set_verify</a></b>(3), <b><a href="../man3/SSL_use_certificate.3.html">SSL_use_certificate</a></b>(3), <b><a href="../man3/X509_STORE_CTX_get0_rpk.3.html">X509_STORE_CTX_get0_rpk</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       These functions were added in OpenSSL 3.2.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2023 The OpenSSL Project Authors. All Rights Reserved.

3.5.0                                              2025-06-04                            <u><a href="../man3SSL/SSL_GET0_PEER_RPK.3SSL.html">SSL_GET0_PEER_RPK</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>