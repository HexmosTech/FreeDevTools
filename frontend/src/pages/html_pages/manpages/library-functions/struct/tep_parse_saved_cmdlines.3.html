<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tep_parse_saved_cmdlines, tep_parse_printk_formats, tep_parse_kallsyms - Parsing functions to load</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtraceevent-doc">libtraceevent-doc_1.8.4-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tep_parse_saved_cmdlines, tep_parse_printk_formats, tep_parse_kallsyms - Parsing functions to load
       mappings

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;event-parse.h&gt;</b>

       int <b>tep_parse_saved_cmdlines</b>(struct tep_handle *<u>tep</u>, const char *<u>buf</u>);
       int <b>tep_parse_printk_formats</b>(struct tep_handle *<u>tep</u>, const char *<u>buf</u>);
       int <b>tep_parse_kallsyms</b>(struct tep_handle *<u>tep</u>, const char *<u>buf</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>tep_parse_saved_cmdlines()</b> is a helper function to parse content in the tracefs file system of the
       "saved_cmdlines" file (stored in a string buffer passed in by <u>buf</u>) and loads the mapping of the process
       IDs (pid) to the comm names in the <u>tep</u> handler. The events store the pid and this is used to be able to
       show the process names associated to those process ids. It parses the string <u>buf</u> that holds the content
       of saved_cmdlines and ends with a nul character (<u>\0</u>).

       <b>tep_parse_printk_formats()</b> is a helper function to parse content in the tracefs file system of the
       "printk_formats" file (stored in a string buffer passed in by <u>buf</u>) and loads the mapping of addresses of
       strings that may be referenced by events. Events only store the address of constant strings in the
       kernel, and the mapping of their address to the string is exported to user space in the printk_formats
       file. It parses the string <u>buf</u> that holds the content of printk_formats and ends with a nul character
       (<u>\0</u>).

       <b>tep_parse_kallsyms()</b> is a helper function to parse the Linux kernel <a href="file:/proc/kallsyms">/proc/kallsyms</a> format (stored in a
       string buffer passed in by <u>buf</u>) and load the functions into the <u>tep</u> handler such that function IP
       addresses can be mapped to their name when parsing events with %pS in the print format field. It parses
       the string <u>buf</u> that holds the content of <a href="file:/proc/kallsyms">/proc/kallsyms</a> and ends with a nul character (<u>\0</u>).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>tep_parse_saved_cmdlines</b>() function returns 0 in case of success, or -1 in case of an error.

       The <b>tep_parse_printk_formats</b>() function returns 0 in case of success, or -1 in case of an error.

       The <b>tep_parse_kallsyms</b>() function returns 0 in case of success, or -1 in case of an error.

</pre><h4><b>EXAMPLE</b></h4><pre>
           ...
           #include &lt;event-parse.h&gt;
           #include &lt;tracefs.h&gt;
           #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;

           int load_cmdlines(struct tep_handle *tep)
           {
                   char *buf = NULL;
                   int r;

                   buf = tracefs_instance_file_read(NULL, "saved_cmdlines", NULL);
                   if (!buf)
                           return -1;
                   r = tep_parse_saved_cmdlines(tep, buf);
                   free(buf);
                   return r;
           }

           int load_print_strings(struct tep_handle *tep)
           {
                   char *buf = NULL;
                   int r;

                   buf = tracefs_instance_file_read(NULL, "printk_formats", NULL);
                   if (!buf)
                           return -1;
                   r = tep_parse_printk_formats(tep, buf);
                   free(buf);
                   return r;
           }

           int load_kallsyms(struct tep_handle *tep)
           {
                   char *line = NULL;
                   char *buf = NULL;
                   size_t sz = 0;
                   FILE *fp;
                   int len = 0;
                   int r;

                   fp = fopen("<a href="file:/proc/kallsyms">/proc/kallsyms</a>", "r");
                   while ((r = getline(&amp;line, &amp;sz, fp)) &gt;= 0) {
                           buf = realloc(buf, len + r + 1);
                           memcpy(buf + len, line, r);
                           len += r;
                   }
                   free(line);
                   fclose(fp);
                   if (!buf)
                           return -1;
                   buf[len] = 0;

                   r = tep_parse_kallsyms(tep, buf);
                   free(buf);
                   return r;
           }
           ...

</pre><h4><b>FILES</b></h4><pre>
           <b>event-parse.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>-ltraceevent</b>
                   Linker switch to add when building a program that uses the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libtraceevent.3.html">libtraceevent</a></b>(3), <b><a href="../man1/trace-cmd.1.html">trace-cmd</a></b>(1), <b><a href="../man3/tep_register_comm.3.html">tep_register_comm</a></b>(3), <b><a href="../man3/tep_register_function.3.html">tep_register_function</a></b>(3),
       <b><a href="../man3/tep_register_print_string.3.html">tep_register_print_string</a></b>(3)

</pre><h4><b>AUTHOR</b></h4><pre>
           <b>Steven</b> <b>Rostedt</b> &lt;<b><a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a></b>[1]&gt;, author of <b>libtraceevent</b>.
           <b>Tzvetomir</b> <b>Stoyanov</b> &lt;<b><a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a></b>[2]&gt;, coauthor of <b>libtraceevent</b>.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<b><a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a></b>[3]&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       libtraceevent is Free Software licensed under the GNU LGPL 2.1

</pre><h4><b>RESOURCES</b></h4><pre>
       <b>https://git.kernel.org/pub/scm/libs/libtrace/libtraceevent.git/</b>

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a>
           <a href="mailto:rostedt@goodmis.org">mailto:rostedt@goodmis.org</a>

        2. <a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a>
           <a href="mailto:tz.stoyanov@gmail.com">mailto:tz.stoyanov@gmail.com</a>

        3. <a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a>
           <a href="mailto:linux-trace-devel@vger.kernel.org">mailto:linux-trace-devel@vger.kernel.org</a>

libtraceevent 1.8.4                                12/24/2024                                   <u><a href="../man3/LIBTRACEEVENT.3.html">LIBTRACEEVENT</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>