<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmem2_source_from_fd(),  pmem2_source_from_handle(),  pmem2_source_delete()  -  creates or deletes an in‐</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpmem2-dev">libpmem2-dev_1.13.1-1.1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmem2_source_from_fd</b>(),  <b>pmem2_source_from_handle</b>(),  <b>pmem2_source_delete</b>()  -  creates or deletes an in‐
       stance of persistent memory data source

</pre><h4><b>SYNOPSIS</b></h4><pre>
              #include &lt;libpmem2.h&gt;

              int pmem2_source_from_fd(struct pmem2_source *src, int fd);
              int pmem2_source_from_handle(struct pmem2_source *src, HANDLE handle); /* Windows only */
              int pmem2_source_delete(struct pmem2_source **src);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       On Linux the <b>pmem2_source_from_fd</b>() function validates the file descriptor and instantiates a new *struct
       pmem2_source** object describing the data source.

       On Windows the <b>pmem2_source_from_fd</b>() function converts  a  file  descriptor  to  a  file  handle  (using
       **_get_osfhandle<b>()),</b>  <b>and</b>  <b>passes</b>  <b>it</b>  <b>to</b>  pmem2_source_from_handle<b>().</b>  <b>By</b> <b>default</b> _get_osfhandle<b>()</b> <b>calls</b>
       <b>abort()</b> <b>in</b> <b>case</b> <b>of</b> <b>invalid</b> <b>file</b> <b>descriptor,</b> <b>but</b> <b>this</b> <b>behavior</b> <b>can</b> <b>be</b> <b>suppressed</b> <b>by</b>  _set_abort_behavior<b>()</b>
       <b>and</b>  SetErrorMode**()  functions.  Please check MSDN documentation for more information about Windows CRT
       error handling.

       <u>fd</u> must be opened with <u>O_RDONLY</u> or <u>O_RDWR</u> mode, but on Windows it is not validated.

       If <u>fd</u> is invalid, then the function fails.

       The <b>pmem2_source_from_handle</b>() function validates the handle and instantiates a new *struct  pmem2_source
       <b>object</b> <b>describing</b> <b>the</b> <b>data</b> <b>source.</b> <b>If</b> <u><b>handle</b></u> <b>is</b> <u><b>INVALID_HANDLE_VALUE</b></u><b>,</b> <b>then</b> <b>the</b> <b>function</b> <b>fails.</b> <b>The</b> <b>handle</b>
       <b>has</b>  <b>to</b>  <b>be</b>  <b>created</b>  <b>with</b>  <b>an</b> <b>access</b> <b>mode</b> <b>of</b> <u><b>GENERIC_READ</b></u> <b>or</b> <u><b>(GENERIC_READ</b></u> <u><b>|</b></u> <u><b>GENERIC_WRITE)</b></u><b>.</b> <b>For</b> <b>details</b>
       <b>please</b> <b>see</b> <b>the</b> CreateFile**() documentation.

       The   <b>pmem2_source_delete</b>()   function    frees    <u>*src</u>    returned    by    <b>pmem2_source_from_fd</b>()    or
       <b>pmem2_source_from_handle</b>() and sets <u>*src</u> to NULL.  If <u>*src</u> is NULL, no operation is performed.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>pmem2_source_from_fd</b>() and <b>pmem2_source_from_handle</b>() functions return 0 on success or a negative er‐
       ror code on failure.

       The <b>pmem2_source_delete</b>() function always returns 0.

</pre><h4><b>ERRORS</b></h4><pre>
       The <b>pmem2_source_from_fd</b>()/<b>pmem2_source_from_handle</b>() functions can fail with the following errors:

       • <b>PMEM2_E_INVALID_FILE_HANDLE</b> - <u>fd</u> is not an open and valid file descriptor.  On Windows the function can
         <b>abort</b>() on this failure based on CRT’s abort() behavior.

       • <b>PMEM2_E_INVALID_FILE_HANDLE</b> - <u>fd</u> is opened in O_WRONLY mode.

       On Linux:

       • <b>PMEM2_E_INVALID_FILE_TYPE</b> - <u>fd</u> points to a directory, block device, pipe, or socket.

       • <b>PMEM2_E_INVALID_FILE_TYPE</b> - <u>fd</u> points to a character device other than Device DAX.

       On Windows:

       • <b>PMEM2_E_INVALID_FILE_TYPE</b> - <u>handle</u> points to a resource that is not a regular file.

       On  Windows  <b>pmem2_source_from_fd</b>()  can return all errors from the underlying <b>pmem2_source_from_handle</b>()
       function.

       The <b>pmem2_source_from_handle</b>() can return the following errors:

       • <b>PMEM2_E_INVALID_FILE_HANDLE</b> - <u>handle</u> points to a resource that is not a file.

       • <b>PMEM2_E_INVALID_FILE_TYPE</b> - <u>handle</u> points to a directory.

       The <b>pmem2_source_from_fd</b>() and <b>pmem2_source_from_handle</b>() functions can also return <b>-ENOMEM</b>  in  case  of
       insufficient memory to allocate an instance of <u>struct</u> <u>pmem2_source</u>.

</pre><h4><b>CAVEATS</b></h4><pre>
       On non-DAX Windows volumes, <u>fd</u>/<u>handle</u> must remain open while the mapping is in use.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/errno.3.html">errno</a></b>(3), <b><a href="../man3/pmem2_map_new.3.html">pmem2_map_new</a></b>(3), <b><a href="../man7/libpmem2.7.html">libpmem2</a></b>(7) and <b>&lt;https://pmem.io&gt;</b>
</pre>
 </div>
</div></section>
</div>
</body>
</html>