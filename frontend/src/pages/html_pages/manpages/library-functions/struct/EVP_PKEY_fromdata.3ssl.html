<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_PKEY_fromdata_init, EVP_PKEY_fromdata, EVP_PKEY_fromdata_settable - functions to create keys and key</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_PKEY_fromdata_init, EVP_PKEY_fromdata, EVP_PKEY_fromdata_settable - functions to create keys and key
       parameters from user data

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/evp.h&gt;

        int EVP_PKEY_fromdata_init(EVP_PKEY_CTX *ctx);
        int EVP_PKEY_fromdata(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey, int selection,
                              OSSL_PARAM params[]);
        const OSSL_PARAM *EVP_PKEY_fromdata_settable(EVP_PKEY_CTX *ctx, int selection);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The functions described here are used to create new keys from user provided key data, such as <u>n</u>, <u>e</u> and <u>d</u>
       for a minimal RSA keypair.

       These functions use an <b>EVP_PKEY_CTX</b> context, which should primarily be created with
       <b><a href="../man3/EVP_PKEY_CTX_new_from_name.3.html">EVP_PKEY_CTX_new_from_name</a></b>(3) or <b><a href="../man3/EVP_PKEY_CTX_new_id.3.html">EVP_PKEY_CTX_new_id</a></b>(3).

       The exact key data that the user can pass depends on the key type.  These are passed as an <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3)
       array.

       <b>EVP_PKEY_fromdata_init()</b> initializes a public key algorithm context for creating a key or key parameters
       from user data.

       <b>EVP_PKEY_fromdata()</b> creates the structure to store a key or key parameters, given data from <u>params</u>,
       <u>selection</u> and a context that's been initialized with <b>EVP_PKEY_fromdata_init()</b>.  The result is written to
       <u>*ppkey</u>.  <u>selection</u> is described in "Selections".  The parameters that can be used for various types of
       key are as described by the various "Common parameters" sections of the <b><a href="../man7/EVP_PKEY-RSA.7.html">EVP_PKEY-RSA</a></b>(7), <b><a href="../man7/EVP_PKEY-DSA.7.html">EVP_PKEY-DSA</a></b>(7),
       <b><a href="../man7/EVP_PKEY-DH.7.html">EVP_PKEY-DH</a></b>(7), <b><a href="../man7/EVP_PKEY-EC.7.html">EVP_PKEY-EC</a></b>(7), <b><a href="../man7/EVP_PKEY-ED448.7.html">EVP_PKEY-ED448</a></b>(7), <b><a href="../man7/EVP_PKEY-X25519.7.html">EVP_PKEY-X25519</a></b>(7), <b><a href="../man7/EVP_PKEY-X448.7.html">EVP_PKEY-X448</a></b>(7),
       <b><a href="../man7/EVP_PKEY-ED25519.7.html">EVP_PKEY-ED25519</a></b>(7), <b><a href="../man7/EVP_PKEY-ML-DSA.7.html">EVP_PKEY-ML-DSA</a>(7)</b> and <b><a href="../man7/EVP_PKEY-ML-KEM.7.html">EVP_PKEY-ML-KEM</a>(7)</b> pages.

       <b>EVP_PKEY_fromdata_settable()</b> gets a constant <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) array that describes the settable parameters
       that can be used with <b>EVP_PKEY_fromdata()</b>.  <u>selection</u> is described in "Selections".

       Parameters in the <u>params</u> array that are not among the settable parameters for the given <u>selection</u> are
       ignored.

   <b>Selections</b>
       The following constants can be used for <u>selection</u>:

       <b>EVP_PKEY_KEY_PARAMETERS</b>
           Only key parameters will be selected.

       <b>EVP_PKEY_PUBLIC_KEY</b>
           Only public key components will be selected. This includes optional key parameters.

       <b>EVP_PKEY_KEYPAIR</b>
           Any  keypair  components  will  be  selected.  This  includes  the  private  key,  public key and key
           parameters.

</pre><h4><b>NOTES</b></h4><pre>
       These functions only work with key management methods  coming  from  a  provider.   This  is  the  mirror
       function to <b><a href="../man3/EVP_PKEY_todata.3.html">EVP_PKEY_todata</a></b>(3).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>EVP_PKEY_fromdata_init()</b>  and  <b>EVP_PKEY_fromdata()</b>  return  1  for  success and 0 or a negative value for
       failure.  In particular a return value of -2 indicates the operation is not supported by the  public  key
       algorithm.

</pre><h4><b>EXAMPLES</b></h4><pre>
       These  examples  are very terse for the sake of staying on topic, which is the <b>EVP_PKEY_fromdata()</b> set of
       functions.   In  real  applications,  BIGNUMs  would  be  handled  and  converted  to  byte  arrays  with
       <b>BN_bn2nativepad()</b>, but that's off topic here.

   <b>Creating</b> <b>an</b> <b>RSA</b> <b>keypair</b> <b>using</b> <b>raw</b> <b>key</b> <b>data</b>
        #include &lt;openssl/evp.h&gt;

        /*
         * These are extremely small to make this example simple.  A real
         * and secure application will not use such small numbers.  A real
         * and secure application is expected to use BIGNUMs, and to build
         * this array dynamically.
         */
        unsigned long rsa_n = 0xbc747fc5;
        unsigned long rsa_e = 0x10001;
        unsigned long rsa_d = 0x7b133399;
        OSSL_PARAM params[] = {
            OSSL_PARAM_ulong("n", &amp;rsa_n),
            OSSL_PARAM_ulong("e", &amp;rsa_e),
            OSSL_PARAM_ulong("d", &amp;rsa_d),
            OSSL_PARAM_END
        };

        int main()
        {
            EVP_PKEY_CTX *ctx = EVP_PKEY_CTX_new_from_name(NULL, "RSA", NULL);
            EVP_PKEY *pkey = NULL;

            if (ctx == NULL
                || EVP_PKEY_fromdata_init(ctx) &lt;= 0
                || EVP_PKEY_fromdata(ctx, &amp;pkey, EVP_PKEY_KEYPAIR, params) &lt;= 0)
                <a href="../man1/exit.1.html">exit</a>(1);

            /* Do what you want with |pkey| */
        }

   <b>Creating</b> <b>an</b> <b>ECC</b> <b>keypair</b> <b>using</b> <b>raw</b> <b>key</b> <b>data</b>
        #include &lt;openssl/evp.h&gt;
        #include &lt;openssl/param_build.h&gt;
        #include &lt;openssl/ec.h&gt;

        /*
         * Fixed data to represent the private and public key.
         */
        const unsigned char priv_data[] = {
            0xb9, 0x2f, 0x3c, 0xe6, 0x2f, 0xfb, 0x45, 0x68,
            0x39, 0x96, 0xf0, 0x2a, 0xaf, 0x6c, 0xda, 0xf2,
            0x89, 0x8a, 0x27, 0xbf, 0x39, 0x9b, 0x7e, 0x54,
            0x21, 0xc2, 0xa1, 0xe5, 0x36, 0x12, 0x48, 0x5d
        };
        /* UNCOMPRESSED FORMAT */
        const unsigned char pub_data[] = {
            POINT_CONVERSION_UNCOMPRESSED,
            0xcf, 0x20, 0xfb, 0x9a, 0x1d, 0x11, 0x6c, 0x5e,
            0x9f, 0xec, 0x38, 0x87, 0x6c, 0x1d, 0x2f, 0x58,
            0x47, 0xab, 0xa3, 0x9b, 0x79, 0x23, 0xe6, 0xeb,
            0x94, 0x6f, 0x97, 0xdb, 0xa3, 0x7d, 0xbd, 0xe5,
            0x26, 0xca, 0x07, 0x17, 0x8d, 0x26, 0x75, 0xff,
            0xcb, 0x8e, 0xb6, 0x84, 0xd0, 0x24, 0x02, 0x25,
            0x8f, 0xb9, 0x33, 0x6e, 0xcf, 0x12, 0x16, 0x2f,
            0x5c, 0xcd, 0x86, 0x71, 0xa8, 0xbf, 0x1a, 0x47
        };

        int main()
        {
            EVP_PKEY_CTX *ctx;
            EVP_PKEY *pkey = NULL;
            BIGNUM *priv;
            OSSL_PARAM_BLD *param_bld;
            OSSL_PARAM *params = NULL;
            int exitcode = 0;

            priv = BN_bin2bn(priv_data, sizeof(priv_data), NULL);

            param_bld = OSSL_PARAM_BLD_new();
            if (priv != NULL &amp;&amp; param_bld != NULL
                &amp;&amp; OSSL_PARAM_BLD_push_utf8_string(param_bld, "group",
                                                   "prime256v1", 0)
                &amp;&amp; OSSL_PARAM_BLD_push_BN(param_bld, "priv", priv)
                &amp;&amp; OSSL_PARAM_BLD_push_octet_string(param_bld, "pub",
                                                    pub_data, sizeof(pub_data)))
                params = OSSL_PARAM_BLD_to_param(param_bld);

            ctx = EVP_PKEY_CTX_new_from_name(NULL, "EC", NULL);
            if (ctx == NULL
                || params == NULL
                || EVP_PKEY_fromdata_init(ctx) &lt;= 0
                || EVP_PKEY_fromdata(ctx, &amp;pkey, EVP_PKEY_KEYPAIR, params) &lt;= 0) {
                exitcode = 1;
            } else {
                /* Do what you want with |pkey| */
            }

            EVP_PKEY_free(pkey);
            EVP_PKEY_CTX_free(ctx);
            OSSL_PARAM_free(params);
            OSSL_PARAM_BLD_free(param_bld);
            BN_free(priv);

            exit(exitcode);
        }

   <b>Finding</b> <b>out</b> <b>params</b> <b>for</b> <b>an</b> <b>unknown</b> <b>key</b> <b>type</b>
        #include &lt;openssl/evp.h&gt;
        #include &lt;openssl/core.h&gt;

        /* Program expects a key type as first argument */
        int main(int argc, char *argv[])
        {
            EVP_PKEY_CTX *ctx = EVP_PKEY_CTX_new_from_name(NULL, argv[1], NULL);
            const OSSL_PARAM *settable_params = NULL;

            if (ctx == NULL)
               <a href="../man1/exit.1.html">exit</a>(1);
           settable_params = EVP_PKEY_fromdata_settable(ctx, EVP_PKEY_KEYPAIR);
           if (settable_params == NULL)
                <a href="../man1/exit.1.html">exit</a>(1);

            for (; settable_params-&gt;key != NULL; settable_params++) {
                const char *datatype = NULL;

                switch (settable_params-&gt;data_type) {
                case OSSL_PARAM_INTEGER:
                    datatype = "integer";
                    break;
                case OSSL_PARAM_UNSIGNED_INTEGER:
                    datatype = "unsigned integer";
                    break;
                case OSSL_PARAM_UTF8_STRING:
                    datatype = "printable string (utf-8 encoding expected)";
                    break;
                case OSSL_PARAM_UTF8_PTR:
                    datatype = "printable string pointer (utf-8 encoding expected)";
                    break;
                case OSSL_PARAM_OCTET_STRING:
                    datatype = "octet string";
                    break;
                case OSSL_PARAM_OCTET_PTR:
                    datatype = "octet string pointer";
                    break;
                }
                printf("%s : %s ", settable_params-&gt;key, datatype);
                if (settable_params-&gt;data_size == 0)
                    printf("(unlimited size)\n");
                else
                    printf("(maximum size %zu)\n", settable_params-&gt;data_size);
            }
        }

       The  descriptor <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3) returned by <b>EVP_PKEY_fromdata_settable()</b> may also be used programmatically,
       for example with <b><a href="../man3/OSSL_PARAM_allocate_from_text.3.html">OSSL_PARAM_allocate_from_text</a></b>(3).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_PKEY_CTX_new.3.html">EVP_PKEY_CTX_new</a></b>(3),   <b><a href="../man3/EVP_PKEY_todata.3.html">EVP_PKEY_todata</a></b>(3),   <b><a href="../man3/EVP_PKEY_gettable_params.3.html">EVP_PKEY_gettable_params</a></b>(3),   <b><a href="../man3/OSSL_PARAM.3.html">OSSL_PARAM</a></b>(3),   <b><a href="../man7/provider.7.html">provider</a></b>(7),
       <b><a href="../man7/EVP_PKEY-RSA.7.html">EVP_PKEY-RSA</a></b>(7), <b><a href="../man7/EVP_PKEY-EC.7.html">EVP_PKEY-EC</a></b>(7), <b><a href="../man7/EVP_PKEY-ED25519.7.html">EVP_PKEY-ED25519</a></b>(7), <b><a href="../man7/EVP_PKEY-ED448.7.html">EVP_PKEY-ED448</a></b>(7), <b><a href="../man7/EVP_PKEY-DSA.7.html">EVP_PKEY-DSA</a></b>(7), <b><a href="../man7/EVP_PKEY-DH.7.html">EVP_PKEY-DH</a></b>(7),
       <b><a href="../man7/EVP_PKEY-X25519.7.html">EVP_PKEY-X25519</a></b>(7), <b><a href="../man7/EVP_PKEY-X448.7.html">EVP_PKEY-X448</a></b>(7), <b><a href="../man7/EVP_PKEY-ML-DSA.7.html">EVP_PKEY-ML-DSA</a></b>(7), <b><a href="../man7/EVP_PKEY-ML-KEM.7.html">EVP_PKEY-ML-KEM</a></b>(7), <b><a href="../man7/EVP_PKEY-SLH-DSA.7.html">EVP_PKEY-SLH-DSA</a></b>(7).

</pre><h4><b>HISTORY</b></h4><pre>
       These functions were added in OpenSSL 3.0.

       Support for <b>ML-DSA</b>, <b>ML-KEM</b> and <b>SLH-DSA</b> was added in OpenSSL 3.5.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                            <u><a href="../man3SSL/EVP_PKEY_FROMDATA.3SSL.html">EVP_PKEY_FROMDATA</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>