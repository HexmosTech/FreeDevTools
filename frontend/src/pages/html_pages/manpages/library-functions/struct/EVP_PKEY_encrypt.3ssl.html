<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_PKEY_encrypt_init_ex, EVP_PKEY_encrypt_init, EVP_PKEY_encrypt - encrypt using a public key algorithm</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_PKEY_encrypt_init_ex, EVP_PKEY_encrypt_init, EVP_PKEY_encrypt - encrypt using a public key algorithm

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/evp.h&gt;

        int EVP_PKEY_encrypt_init(EVP_PKEY_CTX *ctx);
        int EVP_PKEY_encrypt_init_ex(EVP_PKEY_CTX *ctx, const OSSL_PARAM params[]);
        int EVP_PKEY_encrypt(EVP_PKEY_CTX *ctx,
                             unsigned char *out, size_t *outlen,
                             const unsigned char *in, size_t inlen);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>EVP_PKEY_encrypt_init()</b> function initializes a public key algorithm context using key <b>pkey</b> for an
       encryption operation.

       The <b>EVP_PKEY_encrypt_init_ex()</b> function initializes a public key algorithm context using key <b>pkey</b> for an
       encryption operation and sets the algorithm specific <b>params</b>.

       The <b>EVP_PKEY_encrypt()</b> function performs a public key encryption operation using <b>ctx</b>. The data to be
       encrypted is specified using the <b>in</b> and <b>inlen</b> parameters. If <b>out</b> is <b>NULL</b> then the maximum size of the
       output buffer is written to the <b>outlen</b> parameter. If <b>out</b> is not <b>NULL</b> then before the call the <b>outlen</b>
       parameter should contain the length of the <b>out</b> buffer, if the call is successful the encrypted data is
       written to <b>out</b> and the amount of data written to <b>outlen</b>.

</pre><h4><b>NOTES</b></h4><pre>
       After the call to <b>EVP_PKEY_encrypt_init()</b> algorithm specific control operations can be performed to set
       any appropriate parameters for the operation.  These operations can be included in the
       <b>EVP_PKEY_encrypt_init_ex()</b> call.

       The function <b>EVP_PKEY_encrypt()</b> can be called more than once on the same context if several operations
       are performed using the same parameters.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>EVP_PKEY_encrypt_init()</b>, <b>EVP_PKEY_encrypt_init_ex()</b> and <b>EVP_PKEY_encrypt()</b> return 1 for success and 0 or
       a negative value for failure. In particular a return value of -2 indicates the operation is not supported
       by the public key algorithm.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Encrypt data using OAEP (for RSA keys). See also <b><a href="../man3/PEM_read_PUBKEY.3.html">PEM_read_PUBKEY</a></b>(3) or <b><a href="../man3/d2i_X509.3.html">d2i_X509</a></b>(3) for means to load a
       public key. You may also simply set 'eng = NULL;' to start with the default OpenSSL RSA implementation:

        #include &lt;openssl/evp.h&gt;
        #include &lt;openssl/rsa.h&gt;
        #include &lt;openssl/engine.h&gt;

        EVP_PKEY_CTX *ctx;
        ENGINE *eng;
        unsigned char *out, *in;
        size_t outlen, inlen;
        EVP_PKEY *key;

        /*
         * NB: assumes eng, key, in, inlen are already set up,
         * and that key is an RSA public key
         */
        ctx = EVP_PKEY_CTX_new(key, eng);
        if (!ctx)
            /* Error occurred */
        if (EVP_PKEY_encrypt_init(ctx) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_set_rsa_padding(ctx, RSA_PKCS1_OAEP_PADDING) &lt;= 0)
            /* Error */

        /* Determine buffer length */
        if (EVP_PKEY_encrypt(ctx, NULL, &amp;outlen, in, inlen) &lt;= 0)
            /* Error */

        out = OPENSSL_malloc(outlen);

        if (!out)
            /* malloc failure */

        if (EVP_PKEY_encrypt(ctx, out, &amp;outlen, in, inlen) &lt;= 0)
            /* Error */

        /* Encrypted data is outlen bytes written to buffer out */

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/d2i_X509.3.html">d2i_X509</a></b>(3), <b><a href="../man3/ENGINE_by_id.3.html">ENGINE_by_id</a></b>(3), <b><a href="../man3/EVP_PKEY_CTX_new.3.html">EVP_PKEY_CTX_new</a></b>(3), <b><a href="../man3/EVP_PKEY_decrypt.3.html">EVP_PKEY_decrypt</a></b>(3), <b><a href="../man3/EVP_PKEY_sign.3.html">EVP_PKEY_sign</a></b>(3),
       <b><a href="../man3/EVP_PKEY_verify.3.html">EVP_PKEY_verify</a></b>(3), <b><a href="../man3/EVP_PKEY_verify_recover.3.html">EVP_PKEY_verify_recover</a></b>(3), <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       These functions were added in OpenSSL 1.0.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2006-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                             <u><a href="../man3SSL/EVP_PKEY_ENCRYPT.3SSL.html">EVP_PKEY_ENCRYPT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>