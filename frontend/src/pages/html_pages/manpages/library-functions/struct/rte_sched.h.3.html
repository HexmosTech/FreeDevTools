<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rte_sched.h</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/dpdk-doc">dpdk-doc_24.11.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rte_sched.h

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;rte_mbuf.h&gt;
       #include &lt;rte_meter.h&gt;
       #include 'rte_red.h'
       #include 'rte_pie.h'

   <b>Data</b> <b>Structures</b>
       struct <b>rte_sched_subport_stats</b>
       struct <b>rte_sched_queue_stats</b>
       struct <b>rte_sched_port_params</b>

   <b>Macros</b>
       #define <b>RTE_SCHED_QUEUES_PER_PIPE</b>   16
       #define <b>RTE_SCHED_BE_QUEUES_PER_PIPE</b>   4
       #define <b>RTE_SCHED_TRAFFIC_CLASSES_PER_PIPE</b>   (<b>RTE_SCHED_QUEUES_PER_PIPE</b> - <b>RTE_SCHED_BE_QUEUES_PER_PIPE</b> +
           1)
       #define <b>RTE_SCHED_TRAFFIC_CLASS_BE</b>   (<b>RTE_SCHED_TRAFFIC_CLASSES_PER_PIPE</b> - 1)

   <b>Enumerations</b>
       enum <b>rte_sched_cman_mode</b> { <b>RTE_SCHED_CMAN_RED</b>, <b>RTE_SCHED_CMAN_PIE</b> }

   <b>Functions</b>
       struct rte_sched_port * <b>rte_sched_port_config</b> (struct <b>rte_sched_port_params</b> *params)
       void <b>rte_sched_port_free</b> (struct rte_sched_port *port)
       int <b>rte_sched_subport_pipe_profile_add</b> (struct rte_sched_port *port, uint32_t subport_id, struct
           rte_sched_pipe_params *params, uint32_t *pipe_profile_id)
       int <b>rte_sched_port_subport_profile_add</b> (struct rte_sched_port *port, struct
           rte_sched_subport_profile_params *profile, uint32_t *subport_profile_id)
       int <b>rte_sched_subport_config</b> (struct rte_sched_port *port, uint32_t subport_id, struct
           rte_sched_subport_params *params, uint32_t subport_profile_id)
       int <b>rte_sched_pipe_config</b> (struct rte_sched_port *port, uint32_t subport_id, uint32_t pipe_id, int32_t
           pipe_profile)
       uint32_t <b>rte_sched_port_get_memory_footprint</b> (struct <b>rte_sched_port_params</b> *port_params, struct
           rte_sched_subport_params **subport_params)
       int <b>rte_sched_subport_read_stats</b> (struct rte_sched_port *port, uint32_t subport_id, struct
           <b>rte_sched_subport_stats</b> *stats, uint32_t *tc_ov)
       int <b>rte_sched_queue_read_stats</b> (struct rte_sched_port *port, uint32_t queue_id, struct
           <b>rte_sched_queue_stats</b> *stats, uint16_t *qlen)
       void <b>rte_sched_port_pkt_write</b> (struct rte_sched_port *port, struct <b>rte_mbuf</b> *pkt, uint32_t subport,
           uint32_t pipe, uint32_t traffic_class, uint32_t queue, enum <b>rte_color</b> color)
       void <b>rte_sched_port_pkt_read_tree_path</b> (struct rte_sched_port *port, const struct <b>rte_mbuf</b> *pkt, uint32_t
           *subport, uint32_t *pipe, uint32_t *traffic_class, uint32_t *queue)
       int <b>rte_sched_port_enqueue</b> (struct rte_sched_port *port, struct <b>rte_mbuf</b> **pkts, uint32_t n_pkts)
       int <b>rte_sched_port_dequeue</b> (struct rte_sched_port *port, struct <b>rte_mbuf</b> **pkts, uint32_t n_pkts)
       int <b>rte_sched_subport_tc_ov_config</b> (struct rte_sched_port *port, uint32_t subport_id, bool tc_ov_enable)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       RTE Hierarchical Scheduler

       The hierarchical scheduler prioritizes the transmission of packets from different users and traffic
       classes according to the Service Level Agreements (SLAs) defined for the current network node.

       The scheduler supports thousands of packet queues grouped under a 5-level hierarchy:

       1.  Port:

         • Typical usage: output Ethernet port;

         • Multiple ports are scheduled in round robin order with equal priority;

       2.  Subport:

         • Typical usage: group of users;

         • Traffic shaping using the token bucket algorithm (one bucket per subport);

         • Upper limit enforced per traffic class at subport level;

         • Lower  priority  traffic  classes able to reuse subport bandwidth currently unused by higher priority
           traffic classes of the same subport;

         • When any subport traffic class is oversubscribed (configuration time event),  the  usage  of  subport
           member  pipes  with  high  demand for that traffic class pipes is truncated to a dynamically adjusted
           value with no impact to low demand pipes;

       3.  Pipe:

         • Typical usage: individual user/subscriber;

         • Traffic shaping using the token bucket algorithm (one bucket per pipe);

       4.  Traffic class:

         • Traffic classes of the same pipe handled in strict priority order;

         • Upper limit enforced per traffic class at the pipe level;

         • Lower priority traffic classes able to reuse pipe  bandwidth  currently  unused  by  higher  priority
           traffic classes of the same pipe;

       5.  Queue:

         • Typical usage: queue hosting packets from one or multiple connections of same traffic class belonging
           to the same user;

         • Weighted  Round  Robin  (WRR)  is used to service the queues within same pipe lowest priority traffic
           class (best-effort).

       Definition in file <b>rte_sched.h</b>.

</pre><h4><b>Macro</b> <b>Definition</b> <b>Documentation</b></h4><pre>
   <b>#define</b> <b>RTE_SCHED_QUEUES_PER_PIPE</b>   <b>16</b>
       Congestion Management Maximum number of queues per pipe. Note that the multiple queues (power of  2)  can
       only  be  assigned  to lowest priority (best-effort) traffic class. Other higher priority traffic classes
       can only have one queue. Can not change.

       <b>See</b> <b>also</b>
           struct <b>rte_sched_port_params</b>

       Definition at line <b>73</b> of file <b>rte_sched.h</b>.

   <b>#define</b> <b>RTE_SCHED_BE_QUEUES_PER_PIPE</b>   <b>4</b>
       Number of WRR queues for best-effort traffic class per pipe.

       <b>See</b> <b>also</b>
           struct rte_sched_pipe_params

       Definition at line <b>79</b> of file <b>rte_sched.h</b>.

   <b>#define</b> <b>RTE_SCHED_TRAFFIC_CLASSES_PER_PIPE</b>   <b>(RTE_SCHED_QUEUES_PER_PIPE</b> <b>-</b> <b>RTE_SCHED_BE_QUEUES_PER_PIPE</b> <b>+</b> <b>1)</b>
       Number of traffic classes per pipe (as well as subport).

       <b>See</b> <b>also</b>
           struct rte_sched_subport_params

           struct rte_sched_pipe_params

       Definition at line <b>85</b> of file <b>rte_sched.h</b>.

   <b>#define</b> <b>RTE_SCHED_TRAFFIC_CLASS_BE</b>   <b>(RTE_SCHED_TRAFFIC_CLASSES_PER_PIPE</b> <b>-</b> <b>1)</b>
       Best-effort traffic class ID Can not change.

       Definition at line <b>91</b> of file <b>rte_sched.h</b>.

</pre><h4><b>Enumeration</b> <b>Type</b> <b>Documentation</b></h4><pre>
   <b>enum</b> <b>rte_sched_cman_mode</b>
       Congestion Management (CMAN) mode

       This is used for controlling the admission of packets into a packet queue or group of  packet  queues  on
       congestion.

       The  <u>Random</u>  <u>Early</u> <u>Detection</u> <u>(RED)</u> algorithm works by proactively dropping more and more input packets as
       the queue occupancy builds up. When the queue is full or almost full, RED effectively works as <u>tail</u> <u>drop</u>.
       The <u>Weighted</u> <u>RED</u> algorithm uses a separate set of RED thresholds for each packet color.

       Similar to RED, Proportional Integral Controller Enhanced (PIE) randomly drops a packet at the  onset  of
       the  congestion  and  tries  to  control  the  latency around the target value. The congestion detection,
       however, is based on the queueing latency instead of the queue length like  RED.  For  more  information,
       refer RFC8033.

       <b>Enumerator</b>

       <u>RTE_SCHED_CMAN_RED</u>
              Random Early Detection (RED)

       <u>RTE_SCHED_CMAN_PIE</u>
              Proportional Integral Controller Enhanced (PIE)

       Definition at line <b>126</b> of file <b>rte_sched.h</b>.

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>struct</b> <b>rte_sched_port</b> <b>*</b> <b>rte_sched_port_config</b> <b>(struct</b> <b>rte_sched_port_params</b> <b>*</b> <b>params)</b>
       Hierarchical scheduler port configuration

       <b>Parameters</b>
           <u>params</u> Port scheduler configuration parameter structure

       <b>Returns</b>
           Handle to port scheduler instance upon success or NULL otherwise.

   <b>void</b> <b>rte_sched_port_free</b> <b>(struct</b> <b>rte_sched_port</b> <b>*</b> <b>port)</b>
       Hierarchical scheduler port free

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance. If port is NULL, no operation is performed.

   <b>int</b>   <b>rte_sched_subport_pipe_profile_add</b>   <b>(struct</b>   <b>rte_sched_port</b>   <b>*</b>  <b>port,</b>  <b>uint32_t</b>  <b>subport_id,</b>  <b>struct</b>
       <b>rte_sched_pipe_params</b> <b>*</b> <b>params,</b> <b>uint32_t</b> <b>*</b> <b>pipe_profile_id)</b>
       Hierarchical scheduler pipe profile add

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>subport_id</u> Subport ID
           <u>params</u> Pipe profile parameters
           <u>pipe_profile_id</u> Set to valid profile id when profile is added successfully.

       <b>Returns</b>
           0 upon success, error code otherwise

   <b>int</b> <b>rte_sched_port_subport_profile_add</b> <b>(struct</b> <b>rte_sched_port</b> <b>*</b> <b>port,</b> <b>struct</b> <b>rte_sched_subport_profile_params</b>
       <b>*</b> <b>profile,</b> <b>uint32_t</b> <b>*</b> <b>subport_profile_id)</b>
       Hierarchical scheduler subport bandwidth profile add Note that this function is safe to  use  in  runtime
       for  adding  new subport bandwidth profile as it doesn't have any impact on hierarchical structure of the
       scheduler.

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>profile</u> Subport bandwidth profile
           <u>subport_profile_id</u> Subport profile id

       <b>Returns</b>
           0 upon success, error code otherwise

   <b>int</b>   <b>rte_sched_subport_config</b>   <b>(struct</b>    <b>rte_sched_port</b>    <b>*</b>    <b>port,</b>    <b>uint32_t</b>    <b>subport_id,</b>    <b>struct</b>
       <b>rte_sched_subport_params</b> <b>*</b> <b>params,</b> <b>uint32_t</b> <b>subport_profile_id)</b>
       Hierarchical  scheduler  subport  configuration  Note  that  this  function  is safe to use at runtime to
       configure subport bandwidth profile.

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>subport_id</u> Subport ID
           <u>params</u> Subport configuration parameters. Must be non-NULL for first invocation  (i.e  initialization)
           for  a  given  subport. Ignored (recommended value is NULL) for all subsequent invocation on the same
           subport.
           <u>subport_profile_id</u> ID of subport bandwidth profile

       <b>Returns</b>
           0 upon success, error code otherwise

   <b>int</b> <b>rte_sched_pipe_config</b> <b>(struct</b> <b>rte_sched_port</b> <b>*</b>  <b>port,</b>  <b>uint32_t</b>  <b>subport_id,</b>  <b>uint32_t</b>  <b>pipe_id,</b>  <b>int32_t</b>
       <b>pipe_profile)</b>
       Hierarchical scheduler pipe configuration

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>subport_id</u> Subport ID
           <u>pipe_id</u> Pipe ID within subport
           <u>pipe_profile</u> ID of subport-level pre-configured pipe profile

       <b>Returns</b>
           0 upon success, error code otherwise

   <b>uint32_t</b>    <b>rte_sched_port_get_memory_footprint</b>   <b>(struct</b>   <b>rte_sched_port_params</b>   <b>*</b>   <b>port_params,</b>   <b>struct</b>
       <b>rte_sched_subport_params</b> <b>**</b> <b>subport_params)</b>
       Hierarchical scheduler memory footprint size per port

       <b>Parameters</b>
           <u>port_params</u> Port scheduler configuration parameter structure
           <u>subport_params</u> Array of subport parameter structures

       <b>Returns</b>
           Memory footprint size in bytes upon success, 0 otherwise

   <b>int</b>   <b>rte_sched_subport_read_stats</b>   <b>(struct</b>   <b>rte_sched_port</b>   <b>*</b>   <b>port,</b>   <b>uint32_t</b>    <b>subport_id,</b>    <b>struct</b>
       <b>rte_sched_subport_stats</b> <b>*</b> <b>stats,</b> <b>uint32_t</b> <b>*</b> <b>tc_ov)</b>
       Hierarchical scheduler subport statistics read

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>subport_id</u> Subport ID
           <u>stats</u>  Pointer  to pre-allocated subport statistics structure where the statistics counters should be
           stored
           <u>tc_ov</u>   Pointer   to   pre-allocated   RTE_SCHED_TRAFFIC_CLASSES_PER_PIPE-entry   array   where   the
           oversubscription status for each of the subport traffic classes should be stored.

       <b>Returns</b>
           0 upon success, error code otherwise

   <b>int</b> <b>rte_sched_queue_read_stats</b> <b>(struct</b> <b>rte_sched_port</b> <b>*</b> <b>port,</b> <b>uint32_t</b> <b>queue_id,</b> <b>struct</b> <b>rte_sched_queue_stats</b>
       <b>*</b> <b>stats,</b> <b>uint16_t</b> <b>*</b> <b>qlen)</b>
       Hierarchical scheduler queue statistics read

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>queue_id</u> Queue ID within port scheduler
           <u>stats</u>  Pointer  to pre-allocated subport statistics structure where the statistics counters should be
           stored
           <u>qlen</u> Pointer to pre-allocated variable where the current queue length should be stored.

       <b>Returns</b>
           0 upon success, error code otherwise

   <b>void</b> <b>rte_sched_port_pkt_write</b> <b>(struct</b> <b>rte_sched_port</b>  <b>*</b>  <b>port,</b>  <b>struct</b>  <b>rte_mbuf</b>  <b>*</b>  <b>pkt,</b>  <b>uint32_t</b>  <b>subport,</b>
       <b>uint32_t</b> <b>pipe,</b> <b>uint32_t</b> <b>traffic_class,</b> <b>uint32_t</b> <b>queue,</b> <b>enum</b> <b>rte_color</b> <b>color)</b>
       Scheduler hierarchy path write to packet descriptor. Typically called by the packet classification stage.

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>pkt</u> Packet descriptor handle
           <u>subport</u> Subport ID
           <u>pipe</u> Pipe ID within subport
           <u>traffic_class</u> Traffic class ID within pipe (0 .. RTE_SCHED_TRAFFIC_CLASS_BE)
           <u>queue</u>   Queue   ID   within   pipe   traffic   class,   0   for   high   priority   TCs,   and  0  ..
           (RTE_SCHED_BE_QUEUES_PER_PIPE - 1) for best-effort TC
           <u>color</u> Packet color set

   <b>void</b> <b>rte_sched_port_pkt_read_tree_path</b> <b>(struct</b> <b>rte_sched_port</b> <b>*</b> <b>port,</b> <b>const</b> <b>struct</b> <b>rte_mbuf</b> <b>*</b> <b>pkt,</b> <b>uint32_t</b> <b>*</b>
       <b>subport,</b> <b>uint32_t</b> <b>*</b> <b>pipe,</b> <b>uint32_t</b> <b>*</b> <b>traffic_class,</b> <b>uint32_t</b> <b>*</b> <b>queue)</b>
       Scheduler hierarchy path read from packet descriptor (struct <b>rte_mbuf</b>). Typically called as part  of  the
       hierarchical  scheduler  enqueue operation. The subport, pipe, traffic class and queue parameters need to
       be pre-allocated by the caller.

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>pkt</u> Packet descriptor handle
           <u>subport</u> Subport ID
           <u>pipe</u> Pipe ID within subport
           <u>traffic_class</u> Traffic class ID within pipe (0 .. RTE_SCHED_TRAFFIC_CLASS_BE)
           <u>queue</u>  Queue  ID   within   pipe   traffic   class,   0   for   high   priority   TCs,   and   0   ..
           (RTE_SCHED_BE_QUEUES_PER_PIPE - 1) for best-effort TC

   <b>int</b> <b>rte_sched_port_enqueue</b> <b>(struct</b> <b>rte_sched_port</b> <b>*</b> <b>port,</b> <b>struct</b> <b>rte_mbuf</b> <b>**</b> <b>pkts,</b> <b>uint32_t</b> <b>n_pkts)</b>
       Hierarchical  scheduler  port  enqueue.  Writes  up to n_pkts to port scheduler and returns the number of
       packets actually written. For each packet, the port scheduler queue to write the packet to is  identified
       by  reading  the  hierarchy  path  from  the packet descriptor; if the queue is full or congested and the
       packet is not written to the queue, then the packet is automatically dropped without any action  required
       from the caller.

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>pkts</u> Array storing the packet descriptor handles
           <u>n_pkts</u> Number of packets to enqueue from the pkts array into the port scheduler

       <b>Returns</b>
           Number of packets successfully enqueued

   <b>int</b> <b>rte_sched_port_dequeue</b> <b>(struct</b> <b>rte_sched_port</b> <b>*</b> <b>port,</b> <b>struct</b> <b>rte_mbuf</b> <b>**</b> <b>pkts,</b> <b>uint32_t</b> <b>n_pkts)</b>
       Hierarchical  scheduler  port  dequeue. Reads up to n_pkts from the port scheduler and stores them in the
       pkts array and returns the number of packets actually read. The pkts array needs to be  pre-allocated  by
       the caller with at least n_pkts entries.

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>pkts</u>  Pre-allocated packet descriptor array where the packets dequeued from the port scheduler should
           be stored
           <u>n_pkts</u> Number of packets to dequeue from the port scheduler

       <b>Returns</b>
           Number of packets successfully dequeued and placed in the pkts array

   <b>int</b> <b>rte_sched_subport_tc_ov_config</b> <b>(struct</b> <b>rte_sched_port</b> <b>*</b> <b>port,</b> <b>uint32_t</b> <b>subport_id,</b> <b>bool</b> <b>tc_ov_enable)</b>
       Hierarchical scheduler subport traffic class oversubscription enable/disable.  This  function  should  be
       called at the time of subport initialization.

       <b>Parameters</b>
           <u>port</u> Handle to port scheduler instance
           <u>subport_id</u> Subport ID
           <u>tc_ov_enable</u> Boolean flag to enable/disable TC OV

       <b>Returns</b>
           0 upon success, error code otherwise

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for DPDK from the source code.

DPDK                                             Version 24.11.2                                  <u><a href="../man3/rte_sched.h.3.html">rte_sched.h</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>