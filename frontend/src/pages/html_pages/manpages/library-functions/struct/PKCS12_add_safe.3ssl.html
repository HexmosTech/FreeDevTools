<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKCS12_add_safe, PKCS12_add_safe_ex, PKCS12_add_safes, PKCS12_add_safes_ex - Create and add objects to a</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       PKCS12_add_safe, PKCS12_add_safe_ex, PKCS12_add_safes, PKCS12_add_safes_ex - Create and add objects to a
       PKCS#12 structure

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/pkcs12.h&gt;

        int PKCS12_add_safe(STACK_OF(PKCS7) **psafes, STACK_OF(PKCS12_SAFEBAG) *bags,
                           int safe_nid, int iter, const char *pass);
        int PKCS12_add_safe_ex(STACK_OF(PKCS7) **psafes, STACK_OF(PKCS12_SAFEBAG) *bags,
                               int safe_nid, int iter, const char *pass,
                               OSSL_LIB_CTX *ctx, const char *propq);

        PKCS12 *PKCS12_add_safes(STACK_OF(PKCS7) *safes, int p7_nid);
        PKCS12 *PKCS12_add_safes_ex(STACK_OF(PKCS7) *safes, int p7_nid,
                                    OSSL_LIB_CTX *ctx, const char *propq);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>PKCS12_add_safe()</b> creates a new PKCS7 contentInfo containing the supplied <b>PKCS12_SAFEBAG</b>s and adds this
       to a set of PKCS7 contentInfos. Its type depends on the value of <b>safe_nid</b>:

       •   If <u>safe_nid</u> is -1, a plain PKCS7 <u>data</u> contentInfo is created.

       •   If <u>safe_nid</u> is a valid PBE algorithm NID, a PKCS7 <b>encryptedData</b> contentInfo is created. The algorithm
           uses <u>pass</u> as the passphrase and <u>iter</u> as the iteration count. If <u>iter</u> is zero then a default value for
           iteration count of 2048 is used.

       •   If  <u>safe_nid</u> is 0, a PKCS7 <b>encryptedData</b> contentInfo is created using a default encryption algorithm,
           currently <b>NID_pbe_WithSHA1And3_Key_TripleDES_CBC</b>.

       <b>PKCS12_add_safe_ex()</b> is identical to <b>PKCS12_add_safe()</b> but allows for a library context <u>ctx</u> and  property
       query <u>propq</u> to be used to select algorithm implementations.

       <b>PKCS12_add_safes()</b>  creates  a  <b>PKCS12</b>  structure  containing the supplied set of PKCS7 contentInfos. The
       <u>safes</u> are enclosed first within a PKCS7 contentInfo of type <u>p7_nid</u>. Currently the only supported type  is
       <b>NID_pkcs7_data</b>.

       <b>PKCS12_add_safes_ex()</b>  is  identical  to  <b>PKCS12_add_safes()</b>  but  allows  for  a library context <u>ctx</u> and
       property query <u>propq</u> to be used to select algorithm implementations.

</pre><h4><b>NOTES</b></h4><pre>
       <b>PKCS12_add_safe()</b>  makes  assumptions  regarding  the  encoding  of   the   given   pass   phrase.    See
       <b><a href="../man7/passphrase-encoding.7.html">passphrase-encoding</a></b>(7) for more information.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>PKCS12_add_safe()</b> returns a value of 1 indicating success or 0 for failure.

       <b>PKCS12_add_safes()</b> returns a valid <b>PKCS12</b> structure or NULL if an error occurred.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       IETF RFC 7292 (&lt;https://tools.ietf.org/html/rfc7292&gt;)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/PKCS12_create.3.html">PKCS12_create</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>PKCS12_add_safe_ex()</b> and <b>PKCS12_add_safes_ex()</b> were added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                              <u><a href="../man3SSL/PKCS12_ADD_SAFE.3SSL.html">PKCS12_ADD_SAFE</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>