<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-posix-dev">manpages-posix-dev_2017a-2_all</a> <br><br><pre>
</pre><h4><b>PROLOG</b></h4><pre>
       This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface
       may differ (consult the corresponding Linux manual page for details of Linux behavior), or the  interface
       may not be implemented on Linux.

</pre><h4><b>NAME</b></h4><pre>
       link, linkat — link one file to another file

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;

       int link(const char *<u>path1</u>, const char *<u>path2</u>);

       #include &lt;<a href="file:/usr/include/fcntl.h">fcntl.h</a>&gt;

       int linkat(int <u>fd1</u>, const char *<u>path1</u>, int <u>fd2</u>,
           const char *<u>path2</u>, int <u>flag</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <u>link</u>() function shall create a new link (directory entry) for the existing file, <u>path1</u>.

       The  <u>path1</u> argument points to a pathname naming an existing file. The <u>path2</u> argument points to a pathname
       naming the new directory entry to be created. The <u>link</u>() function shall atomically create a new link  for
       the existing file and the link count of the file shall be incremented by one.

       If  <u>path1</u>  names  a  directory,  <u>link</u>()  shall fail unless the process has appropriate privileges and the
       implementation supports using <u>link</u>() on directories.

       If <u>path1</u> names a symbolic link, it is implementation-defined whether <u>link</u>() follows the symbolic link, or
       creates a new link to the symbolic link itself.

       Upon successful completion, <u>link</u>() shall mark for update the last file status  change  timestamp  of  the
       file.  Also,  the  last  data  modification  and last file status change timestamps of the directory that
       contains the new entry shall be marked for update.

       If <u>link</u>() fails, no link shall be created and the link count of the file shall remain unchanged.

       The implementation may require that the calling process has permission to access the existing file.

       The <u>linkat</u>() function shall be equivalent to the <u>link</u>() function except  that  symbolic  links  shall  be
       handled  as specified by the value of <u>flag</u> (see below) and except in the case where either <u>path1</u> or <u>path2</u>
       or both are relative paths. In this case a relative path <u>path1</u> is interpreted relative to  the  directory
       associated  with the file descriptor <u>fd1</u> instead of the current working directory and similarly for <u>path2</u>
       and the file descriptor <u>fd2</u>.  If the access mode of the open file description associated  with  the  file
       descriptor  is  not O_SEARCH, the function shall check whether directory searches are permitted using the
       current permissions of the directory underlying the file descriptor. If the access mode is O_SEARCH,  the
       function shall not perform the check.

       Values  for  <u>flag</u>  are constructed by a bitwise-inclusive OR of flags from the following list, defined in
       <u>&lt;fcntl.h&gt;</u>:

       AT_SYMLINK_FOLLOW
             If <u>path1</u> names a symbolic link, a new link for the target of the symbolic link is created.

       If <u>linkat</u>() is passed the special value AT_FDCWD in  the  <u>fd1</u>  or  <u>fd2</u>  parameter,  the  current  working
       directory  shall  be  used for the respective <u>path</u> argument. If both <u>fd1</u> and <u>fd2</u> have value AT_FDCWD, the
       behavior shall be identical to a call to <u>link</u>(), except that symbolic links shall be handled as specified
       by the value of <u>flag</u>.

       If the AT_SYMLINK_FOLLOW flag is clear in the <u>flag</u> argument and the <u>path1</u> argument names a symbolic link,
       a new link is created for the symbolic link <u>path1</u> and not its target.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Upon successful completion, these functions shall return 0. Otherwise, these functions  shall  return  -1
       and set <u>errno</u> to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       These functions shall fail if:

       <b>EACCES</b> A component of either path prefix denies search permission, or the requested link requires writing
              in  a  directory  that denies write permission, or the calling process does not have permission to
              access the existing file and this is required by the implementation.

       <b>EEXIST</b> The <u>path2</u> argument resolves to an existing directory entry or refers to a symbolic link.

       <b>ELOOP</b>  A loop exists in symbolic links encountered during resolution of the <u>path1</u> or <u>path2</u> argument.

       <b>EMLINK</b> The number of links to the file named by <u>path1</u> would exceed {LINK_MAX}.

       <b>ENAMETOOLONG</b>
              The length of a component of a pathname is longer than {NAME_MAX}.

       <b>ENOENT</b> A component of either path prefix does not exist; the file named by <u>path1</u> does not exist; or <u>path1</u>
              or <u>path2</u> points to an empty string.

       <b>ENOENT</b> or <b>ENOTDIR</b>
              The <u>path1</u> argument names an existing non-directory file, and the <u>path2</u> argument contains at  least
              one  non-&lt;slash&gt; character and ends with one or more trailing &lt;slash&gt; characters. If <u>path2</u> without
              the trailing &lt;slash&gt; characters would name an existing file, an <b>[ENOENT]</b> error shall not occur.

       <b>ENOSPC</b> The directory to contain the link cannot be extended.

       <b>ENOTDIR</b>
              A component of either path prefix names an existing  file  that  is  neither  a  directory  nor  a
              symbolic  link  to  a directory, or the <u>path1</u> argument contains at least one non-&lt;slash&gt; character
              and ends with one or more trailing &lt;slash&gt; characters and the last  pathname  component  names  an
              existing  file  that  is  neither  a  directory  nor  a symbolic link to a directory, or the <u>path1</u>
              argument names an existing non-directory file and the <u>path2</u> argument  names  a  nonexistent  file,
              contains  at  least  one  non-&lt;slash&gt;  character,  and  ends  with  one  or  more trailing &lt;slash&gt;
              characters.

       <b>EPERM</b>  The file named by <u>path1</u> is a directory and either the calling process does  not  have  appropriate
              privileges or the implementation prohibits using <u>link</u>() on directories.

       <b>EROFS</b>  The requested link requires writing in a directory on a read-only file system.

       <b>EXDEV</b>  The  link  named  by  <u>path2</u>  and  the  file  named  by <u>path1</u> are on different file systems and the
              implementation does not support links between file systems.

       <b>EXDEV</b>  <u>path1</u> refers to a named STREAM.

       The <u>linkat</u>() function shall fail if:

       <b>EACCES</b> The access mode of the open file description associated with <u>fd1</u> or <u>fd2</u> is not  O_SEARCH  and  the
              permissions  of  the  directory  underlying  <u>fd1</u>  or  <u>fd2</u>,  respectively,  do not permit directory
              searches.

       <b>EBADF</b>  The <u>path1</u> or <u>path2</u> argument does not specify an  absolute  path  and  the  <u>fd1</u>  or  <u>fd2</u>  argument,
              respectively, is neither AT_FDCWD nor a valid file descriptor open for reading or searching.

       <b>ENOTDIR</b>
              The  <u>path1</u>  or  <u>path2</u>  argument  is  not  an absolute path and <u>fd1</u> or <u>fd2</u>, respectively, is a file
              descriptor associated with a non-directory file.

       These functions may fail if:

       <b>ELOOP</b>  More than {SYMLOOP_MAX} symbolic links were encountered during resolution of the  <u>path1</u>  or  <u>path2</u>
              argument.

       <b>ENAMETOOLONG</b>
              The length of a pathname exceeds {PATH_MAX}, or pathname resolution of a symbolic link produced an
              intermediate result with a length that exceeds {PATH_MAX}.

       The <u>linkat</u>() function may fail if:

       <b>EINVAL</b> The value of the <u>flag</u> argument is not valid.

       <u>The</u> <u>following</u> <u>sections</u> <u>are</u> <u>informative.</u>

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Creating</b> <b>a</b> <b>Link</b> <b>to</b> <b>a</b> <b>File</b>
       The  following  example  shows  how  to  create  a  link to a file named <b>/home/cnd/mod1</b> by creating a new
       directory entry named <b>/modules/pass1</b>.

           #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;

           char *path1 = "/home/cnd/mod1";
           char *path2 = "/modules/pass1";
           int   status;
           ...
           status = link (path1, path2);

   <b>Creating</b> <b>a</b> <b>Link</b> <b>to</b> <b>a</b> <b>File</b> <b>Within</b> <b>a</b> <b>Program</b>
       In the following program example, the <u>link</u>() function links the <b><a href="file:/etc/passwd">/etc/passwd</a></b> file (defined as  <b>PASSWDFILE</b>)
       to  a  file  named  <b>/etc/opasswd</b>  (defined as <b>SAVEFILE</b>), which is used to save the current password file.
       Then, after removing the current password file (defined as <b>PASSWDFILE</b>), the new password file is saved as
       the current password file using the <u>link</u>() function again.

           #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;

           #define LOCKFILE "/etc/ptmp"
           #define PASSWDFILE "<a href="file:/etc/passwd">/etc/passwd</a>"
           #define SAVEFILE "/etc/opasswd"
           ...
           /* Save current password file */
           link (PASSWDFILE, SAVEFILE);

           /* Remove current password file. */
           unlink (PASSWDFILE);

           /* Save new password file as current password file. */
           link (LOCKFILE,PASSWDFILE);

</pre><h4><b>APPLICATION</b> <b>USAGE</b></h4><pre>
       Some implementations do allow links between file systems.

       If <u>path1</u> refers to a symbolic link, application developers should use <u>linkat</u>() with appropriate flags  to
       select whether or not the symbolic link should be resolved.

</pre><h4><b>RATIONALE</b></h4><pre>
       Linking  to  a  directory  is restricted to the superuser in most historical implementations because this
       capability may produce loops in the file hierarchy or otherwise corrupt the file system. This  volume  of
       POSIX.1‐2017  continues  that  philosophy  by  prohibiting  <u>link</u>()  and  <u>unlink</u>()  from doing this. Other
       functions could do it if the implementor designed such an extension.

       Some historical implementations allow linking of files on different file systems. Wording  was  added  to
       explicitly allow this optional behavior.

       The  exception  for  cross-file system links is intended to apply only to links that are programmatically
       indistinguishable from ``hard'' links.

       The purpose of the <u>linkat</u>() function is to link files in  directories  other  than  the  current  working
       directory  without  exposure  to  race  conditions.  Any  part  of the path of a file could be changed in
       parallel to a call to <u>link</u>(), resulting in unspecified behavior. By opening a  file  descriptor  for  the
       directory  of  both  the  existing file and the target location and using the <u>linkat</u>() function it can be
       guaranteed that the both filenames are in the desired directories.

       The AT_SYMLINK_FOLLOW flag allows for implementing both common behaviors  of  the  <u>link</u>()  function.  The
       POSIX  specification requires that if <u>path1</u> is a symbolic link, a new link for the target of the symbolic
       link is created. Many systems by default or as an alternative provide a mechanism to avoid  the  implicit
       symbolic link lookup and create a new link for the symbolic link itself.

       Earlier  versions  of  this  standard  specified only the <u>link</u>() function, and required it to behave like
       <u>linkat</u>() with the AT_SYMLINK_FOLLOW flag. However, historical practice from SVR4 and  Linux  kernels  had
       <u>link</u>()  behaving  like  <u>linkat</u>()  with  no flags, and many systems that attempted to provide a conforming
       <u>link</u>() function did so in a way that was rarely used, and when  it  was  used  did  not  conform  to  the
       standard  (e.g.,  by  not  being  atomic,  or  by  dereferencing  the  symbolic  link incorrectly). Since
       applications could not rely on <u>link</u>() following links in practice, the <u>linkat</u>() function was added taking
       a flag to specify the desired behavior for the application.

</pre><h4><b>FUTURE</b> <b>DIRECTIONS</b></h4><pre>
       None.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>rename</u>(), <u>symlink</u>(), <u>unlink</u>()

       The Base Definitions volume of POSIX.1‐2017, <b>&lt;fcntl.h&gt;</b>, <b>&lt;unistd.h&gt;</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1-2017, Standard
       for Information  Technology  --  Portable  Operating  System  Interface  (POSIX),  The  Open  Group  Base
       Specifications  Issue  7, 2018 Edition, Copyright (C) 2018 by the Institute of Electrical and Electronics
       Engineers, Inc and The Open Group.  In the event of any discrepancy between this version and the original
       IEEE and The Open Group Standard, the original IEEE and The Open Group Standard is the referee  document.
       The original Standard can be obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any  typographical  or formatting errors that appear in this page are most likely to have been introduced
       during  the  conversion  of  the  source  files  to  man  page  format.  To  report  such   errors,   see
       https://www.kernel.org/doc/man-pages/reporting_bugs.html .

IEEE/The Open Group                                   2017                                          <u><a href="../man3POSIX/LINK.3POSIX.html">LINK</a></u>(3POSIX)
</pre>
 </div>
</div></section>
</div>
</body>
</html>