<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCSP_request_add1_nonce, OCSP_basic_add1_nonce, OCSP_check_nonce, OCSP_copy_nonce - OCSP nonce functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       OCSP_request_add1_nonce, OCSP_basic_add1_nonce, OCSP_check_nonce, OCSP_copy_nonce - OCSP nonce functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ocsp.h&gt;

        int OCSP_request_add1_nonce(OCSP_REQUEST *req, unsigned char *val, int len);
        int OCSP_basic_add1_nonce(OCSP_BASICRESP *resp, unsigned char *val, int len);
        int OCSP_copy_nonce(OCSP_BASICRESP *resp, OCSP_REQUEST *req);
        int OCSP_check_nonce(OCSP_REQUEST *req, OCSP_BASICRESP *resp);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>OCSP_request_add1_nonce()</b> adds a nonce of value <b>val</b> and length <b>len</b> to OCSP request <b>req</b>. If <b>val</b> is <b>NULL</b> a
       random nonce is used. If <b>len</b> is zero or negative a default length will be used (currently 16 bytes).

       <b>OCSP_basic_add1_nonce()</b> is identical to <b>OCSP_request_add1_nonce()</b> except it adds a nonce to OCSP basic
       response <b>resp</b>.

       <b>OCSP_check_nonce()</b> compares the nonce value in <b>req</b> and <b>resp</b>.

       <b>OCSP_copy_nonce()</b> copies any nonce value present in <b>req</b> to <b>resp</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OCSP_request_add1_nonce()</b> and <b>OCSP_basic_add1_nonce()</b> return 1 for success and 0 for failure.

       <b>OCSP_copy_nonce()</b> returns 1 if a nonce was successfully copied, 2 if no nonce was present in <b>req</b> and 0 if
       an error occurred.

       <b>OCSP_check_nonce()</b> returns the result of the nonce comparison between <b>req</b> and <b>resp</b>. The return value
       indicates the result of the comparison.  If nonces are present and equal 1 is returned. If the nonces are
       absent 2 is returned. If a nonce is present in the response only 3 is returned. If nonces are present and
       unequal 0 is returned. If the nonce is present in the request only then -1 is returned.

</pre><h4><b>NOTES</b></h4><pre>
       For most purposes the nonce value in a request is set to a random value so the <b>val</b> parameter in
       <b>OCSP_request_add1_nonce()</b> is usually NULL.

       An OCSP nonce is typically added to an OCSP request to thwart replay attacks by checking the same nonce
       value appears in the response.

       Some responders may include a nonce in all responses even if one is not supplied.

       Some responders cache OCSP responses and do not sign each response for performance reasons. As a result
       they do not support nonces.

       The return values of <b>OCSP_check_nonce()</b> can be checked to cover each case.  A positive return value
       effectively indicates success: nonces are both present and match, both absent or present in the response
       only. A nonzero return additionally covers the case where the nonce is present in the request only: this
       will happen if the responder doesn't support nonces. A zero return value indicates present and mismatched
       nonces: this should be treated as an error condition.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/crypto.7.html">crypto</a></b>(7), <b><a href="../man3/OCSP_cert_to_id.3.html">OCSP_cert_to_id</a></b>(3), <b><a href="../man3/OCSP_REQUEST_new.3.html">OCSP_REQUEST_new</a></b>(3), <b><a href="../man3/OCSP_resp_find_status.3.html">OCSP_resp_find_status</a></b>(3), <b><a href="../man3/OCSP_response_status.3.html">OCSP_response_status</a></b>(3),
       <b><a href="../man3/OCSP_sendreq_new.3.html">OCSP_sendreq_new</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2015-2020 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                      <u><a href="../man3SSL/OCSP_REQUEST_ADD1_NONCE.3SSL.html">OCSP_REQUEST_ADD1_NONCE</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>