<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>audit_add_rule_data - Add new audit rule</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libaudit-dev">libaudit-dev_4.0.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       audit_add_rule_data - Add new audit rule

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;libaudit.h&gt;</b>

       int audit_add_rule_data(int fd, struct audit_rule_data *rule, int flags, int action);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       audit_add_rule_data adds an audit rule previously constructed with <a href="../man3/audit_rule_fieldpair_data.3.html">audit_rule_fieldpair_data</a>(3) to one of
       several  kernel  event  filters. The filter is specified by the flags argument. Possible values for flags
       are:

       •  AUDIT_FILTER_USER - Apply rule to userspace generated messages. This is the user filter. Normally  all
          user  space  originating  events  are  accepted.  Rules  on this filter are typically written to block
          specific events.

       •  AUDIT_FILTER_TASK - Apply rule at task creation (not syscall). This is the task filter. It's  normally
          used to exclude an application from being audited.

       •  AUDIT_FILTER_EXIT  - Apply rule at syscall exit. This is the main filter that is used for syscalls and
          filesystem watches. Normally all syscall do not trigger events, so this is normally  used  to  specify
          events that are of interest.

       •  AUDIT_FILTER_EXCLUDE  -  Apply  rule at audit_log_start. This is the exclude filter which discards any
          records that match.  The action type is ignored for this filter, defaulting to "never".

       •      AUDIT_FILTER_FS - Apply rule when adding PATH auxiliary records to SYSCALL  events.  This  is  the
              filesystem filter. This is used to ignore PATH records that are not of interest.

       The rule's action has two possible values:

       •  AUDIT_NEVER - Do not build context if rule matches.

       •  AUDIT_ALWAYS - Generate audit record if rule matches.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The return value is &lt;= 0 on error, otherwise it is the netlink sequence id number. This function can have
       any error that sendto would encounter.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/audit_rule_fieldpair_data.3.html">audit_rule_fieldpair_data</a></b>(3), <b><a href="../man3/audit_delete_rule_data.3.html">audit_delete_rule_data</a></b>(3), <b><a href="../man8/auditctl.8.html">auditctl</a></b>(8).

</pre><h4><b>AUTHOR</b></h4><pre>
       Steve Grubb.

Red Hat                                             Aug 2009                              <u><a href="../man3/AUDIT_ADD_RULE_DATA.3.html">AUDIT_ADD_RULE_DATA</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>