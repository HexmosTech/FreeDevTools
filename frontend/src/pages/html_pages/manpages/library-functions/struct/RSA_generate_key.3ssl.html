<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_RSA_gen, RSA_generate_key_ex, RSA_generate_key, RSA_generate_multi_prime_key - generate RSA key pair</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_RSA_gen, RSA_generate_key_ex, RSA_generate_key, RSA_generate_multi_prime_key - generate RSA key pair

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/rsa.h&gt;

        EVP_PKEY *EVP_RSA_gen(unsigned int bits);

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        int RSA_generate_key_ex(RSA *rsa, int bits, BIGNUM *e, BN_GENCB *cb);
        int RSA_generate_multi_prime_key(RSA *rsa, int bits, int primes, BIGNUM *e, BN_GENCB *cb);

       The following function has been deprecated since OpenSSL 0.9.8, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        RSA *RSA_generate_key(int bits, unsigned long e,
                              void (*callback)(int, int, void *), void *cb_arg);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>EVP_RSA_gen()</b> generates a new RSA key pair with modulus size <u>bits</u>.

       All of the functions described below are deprecated.  Applications should instead use <b>EVP_RSA_gen()</b>,
       <b><a href="../man3/EVP_PKEY_Q_keygen.3.html">EVP_PKEY_Q_keygen</a></b>(3), or <b><a href="../man3/EVP_PKEY_keygen_init.3.html">EVP_PKEY_keygen_init</a></b>(3) and <b><a href="../man3/EVP_PKEY_keygen.3.html">EVP_PKEY_keygen</a></b>(3).

       <b>RSA_generate_key_ex()</b> generates a 2-prime RSA key pair and stores it in the <b>RSA</b> structure provided in
       <u>rsa</u>.

       <b>RSA_generate_multi_prime_key()</b> generates a multi-prime RSA key pair and stores it in the <b>RSA</b> structure
       provided in <u>rsa</u>. The number of primes is given by the <u>primes</u> parameter.  If the automatic seeding or
       reseeding of the OpenSSL CSPRNG fails due to external circumstances (see <b><a href="../man7/RAND.7.html">RAND</a></b>(7)), the operation will
       fail.

       The modulus size will be of length <u>bits</u>, the number of primes to form the modulus will be <u>primes</u>, and the
       public exponent will be <u>e</u>. Key sizes with <u>num</u> &lt; 1024 should be considered insecure. The exponent is an
       odd number, typically 3, 17 or 65537.

       In order to maintain adequate security level, the maximum number of permitted <u>primes</u> depends on modulus
       bit length:

          &lt;1024 | &gt;=1024 | &gt;=4096 | &gt;=8192
          ------+--------+--------+-------
            2   |   3    |   4    |   5

       A callback function may be used to provide feedback about the progress of the key generation. If <u>cb</u> is
       not NULL, it will be called as follows using the <b>BN_GENCB_call()</b> function described on the
       <b><a href="../man3/BN_generate_prime.3.html">BN_generate_prime</a></b>(3) page.

       <b>RSA_generate_key()</b> is similar to <b>RSA_generate_key_ex()</b> but expects an old-style callback function; see
       <b><a href="../man3/BN_generate_prime.3.html">BN_generate_prime</a></b>(3) for information on the old-style callback.

       • While a random prime number is generated, it is called as described in <b><a href="../man3/BN_generate_prime.3.html">BN_generate_prime</a></b>(3).

       • When the n-th randomly generated prime is rejected as not suitable for the key, <u>BN_GENCB_call(cb,</u> <u>2,</u> <u>n)</u>
         is called.

       • When a random p has been found with p-1 relatively prime to <u>e</u>, it is called as <u>BN_GENCB_call(cb,</u> <u>3,</u> <u>0)</u>.

       The  process  is then repeated for prime q and other primes (if any) with <u>BN_GENCB_call(cb,</u> <u>3,</u> <u>i)</u> where <u>i</u>
       indicates the i-th prime.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>EVP_RSA_gen()</b> returns an <u>EVP_PKEY</u> or NULL on failure.

       <b>RSA_generate_multi_prime_key()</b> returns 1 on success or 0 on error.  <b>RSA_generate_key_ex()</b>  returns  1  on
       success or 0 on error.  The error codes can be obtained by <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3).

       <b>RSA_generate_key()</b> returns a pointer to the RSA structure or NULL if the key generation fails.

</pre><h4><b>BUGS</b></h4><pre>
       <u>BN_GENCB_call(cb,</u> <u>2,</u> <u>x)</u> is used with two different meanings.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_PKEY_Q_keygen.3.html">EVP_PKEY_Q_keygen</a></b>(3) <b><a href="../man3/BN_generate_prime.3.html">BN_generate_prime</a></b>(3), <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3), <b><a href="../man3/RAND_bytes.3.html">RAND_bytes</a></b>(3), <b><a href="../man7/RAND.7.html">RAND</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>EVP_RSA_gen()</b>  was  added  in OpenSSL 3.0.  All other functions described here were deprecated in OpenSSL
       3.0.  For replacement see <b><a href="../man7/EVP_PKEY-RSA.7.html">EVP_PKEY-RSA</a></b>(7).

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                             <u><a href="../man3SSL/RSA_GENERATE_KEY.3SSL.html">RSA_GENERATE_KEY</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>