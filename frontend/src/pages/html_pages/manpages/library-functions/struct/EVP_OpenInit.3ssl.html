<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_OpenInit, EVP_OpenUpdate, EVP_OpenFinal - EVP envelope decryption</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_OpenInit, EVP_OpenUpdate, EVP_OpenFinal - EVP envelope decryption

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/evp.h&gt;

        int EVP_OpenInit(EVP_CIPHER_CTX *ctx, EVP_CIPHER *type, unsigned char *ek,
                         int ekl, unsigned char *iv, EVP_PKEY *priv);
        int EVP_OpenUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out,
                           int *outl, unsigned char *in, int inl);
        int EVP_OpenFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The EVP envelope routines are a high-level interface to envelope decryption. They decrypt a public key
       encrypted symmetric key and then decrypt data using it.

       <b>EVP_OpenInit()</b> initializes a cipher context <b>ctx</b> for decryption with cipher <b>type</b>. It decrypts the
       encrypted symmetric key of length <b>ekl</b> bytes passed in the <b>ek</b> parameter using the private key <b>priv</b>.  The
       IV is supplied in the <b>iv</b> parameter.

       <b>EVP_OpenUpdate()</b> and <b>EVP_OpenFinal()</b> have exactly the same properties as the <b>EVP_DecryptUpdate()</b> and
       <b>EVP_DecryptFinal()</b> routines, as documented on the <b><a href="../man3/EVP_EncryptInit.3.html">EVP_EncryptInit</a></b>(3) manual page.

</pre><h4><b>NOTES</b></h4><pre>
       It is possible to call <b>EVP_OpenInit()</b> twice in the same way as <b>EVP_DecryptInit()</b>. The first call should
       have <b>priv</b> set to NULL and (after setting any cipher parameters) it should be called again with <b>type</b> set
       to NULL.

       If the cipher passed in the <b>type</b> parameter is a variable length cipher then the key length will be set to
       the value of the recovered key length. If the cipher is a fixed length cipher then the recovered key
       length must match the fixed cipher length.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>EVP_OpenInit()</b> returns 0 on error or a non zero integer (actually the recovered secret key size) if
       successful.

       <b>EVP_OpenUpdate()</b> returns 1 for success or 0 for failure.

       <b>EVP_OpenFinal()</b> returns 0 if the decrypt failed or 1 for success.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/evp.7.html">evp</a></b>(7), <b><a href="../man3/RAND_bytes.3.html">RAND_bytes</a></b>(3), <b><a href="../man3/EVP_EncryptInit.3.html">EVP_EncryptInit</a></b>(3), <b><a href="../man3/EVP_SealInit.3.html">EVP_SealInit</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2020 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                 <u><a href="../man3SSL/EVP_OPENINIT.3SSL.html">EVP_OPENINIT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>