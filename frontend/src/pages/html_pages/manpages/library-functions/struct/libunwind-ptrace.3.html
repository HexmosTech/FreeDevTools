<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>libunwind-ptrace -- ptrace() support in libunwind</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libunwind-dev">libunwind-dev_1.6.2-3.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       libunwind-ptrace -- ptrace() support in libunwind

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;libunwind-ptrace.h&gt;

       unw_accessors_t _UPT_accessors;

       void *_UPT_create(pid_t);
       void _UPT_destroy(void *);

       int _UPT_find_proc_info(unw_addr_space_t, unw_word_t, unw_proc_info_t *, int, void *);
       void _UPT_put_unwind_info(unw_addr_space_t, unw_proc_info_t *, void *);
       int _UPT_get_dyn_info_list_addr(unw_addr_space_t, unw_word_t *, void *);
       int _UPT_access_mem(unw_addr_space_t, unw_word_t, unw_word_t *, int, void *);
       int _UPT_access_reg(unw_addr_space_t, unw_regnum_t, unw_word_t *, int, void *);
       int _UPT_access_fpreg(unw_addr_space_t, unw_regnum_t, unw_fpreg_t *, int, void *);
       int _UPT_get_proc_name(unw_addr_space_t, unw_word_t, char *, size_t, unw_word_t *, void *);
       int _UPT_resume(unw_addr_space_t, unw_cursor_t *, void *);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <a href="../man2/ptrace.2.html">ptrace</a>(2) system-call makes it possible for a process to gain access to the machine-state and virtual
       memory  of <u>another</u> process. With the right set of call-back routines, it is therefore possible to hook up
       libunwind to another process via <a href="../man2/ptrace.2.html">ptrace</a>(2).  While it's not very difficult to do so  directly,  libunwind
       further  facilitates  this  task  by  providing ready-to-use callbacks for this purpose. The routines and
       variables  implementing  this   facility   use   a   name-prefix   of   _UPT,   which   is   stands   for
       ``unwind-via-ptrace''.

       An  application  that  wants to use the _UPT-facility first needs to create a new libunwind address-space
       that represents the target process. This is done by calling unw_create_addr_space().  In many cases,  the
       application will simply want to pass the address of _UPT_accessors as the first argument to this routine.
       Doing  so  will  ensure  that  libunwind will be able to properly unwind the target process.  However, in
       special circumstances, an application may prefer to use only portions of  the  _UPT-facility.   For  this
       reason,  the  individual callback routines (_UPT_find_proc_info(), _UPT_put_unwind_info(), etc.) are also
       available for direct use. Of course, the addresses of  these  routines  could  also  be  picked  up  from
       _UPT_accessors,  but  doing  so would prevent static initialization. Also, when using _UPT_accessors, <u>all</u>
       the callback routines will be linked into the application, even if they are never actually called.

       Next, the application can turn on ptrace-mode on the target process, either by  forking  a  new  process,
       invoking  PTRACE_TRACEME,  and then starting the target program (via <a href="../man2/execve.2.html">execve</a>(2)), or by directly attaching
       to an already running process (via PTRACE_ATTACH).  Either way, once the process-ID (pid) of  the  target
       process  is  known, a _UPT-info-structure can be created by calling _UPT_create(), passing the pid of the
       target process as the  only  argument.  The  returned  void-pointer  then  needs  to  be  passed  as  the
       ``argument'' pointer (third argument) to unw_init_remote().

       The  _UPT_resume()  routine  can  be  used  to  resume execution of the target process. It simply invokes
       <a href="../man2/ptrace.2.html">ptrace</a>(2) with a command value of PTRACE_CONT.

       When the application is done using libunwind on the target process, _UPT_destroy() needs  to  be  called,
       passing  it  the void-pointer that was returned by the corresponding call to _UPT_create().  This ensures
       that all memory and other resources are freed up.

</pre><h4><b>AVAILABILITY</b></h4><pre>
       Since <a href="../man2/ptrace.2.html">ptrace</a>(2) works within a single machine only, the _UPT-facility by definition is not  available  in
       libunwind-versions configured for cross-unwinding.

</pre><h4><b>THREAD</b> <b>SAFETY</b></h4><pre>
       The  _UPT-facility  assumes that a single _UPT-info structure is never shared between threads. Because of
       this, no explicit locking is used. As long as only one thread uses a _UPT-info  structure  at  any  given
       time, this facility is thread-safe.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       _UPT_create() may return a NULL pointer if it fails to create the _UPT-info-structure for any reason. For
       the current implementation, the only reason this call may fail is when the system is out of memory.

</pre><h4><b>FILES</b></h4><pre>
       libunwind-ptrace.h
               Headerfile to include when using the interface defined by this library.

       <b>-l</b>unwind-ptrace <b>-l</b>unwind-generic
               Linker-switches to add when building a program that uses the functions defined by this library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man2/execve.2.html">execve</a>(2), <a href="../man3/libunwind.3.html">libunwind</a>(3), <a href="../man2/ptrace.2.html">ptrace</a>(2)

</pre><h4><b>AUTHOR</b></h4><pre>
       David Mosberger-Tang
       Email: <b><a href="mailto:dmosberger@gmail.com">dmosberger@gmail.com</a></b>
       WWW: <b><a href="http://www.nongnu.org/libunwind/">http://www.nongnu.org/libunwind/</a></b>.

Programming Library                              16 August 2007                              <u><a href="../man3/LIBUNWIND-PTRACE.3.html">LIBUNWIND-PTRACE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>