<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_PKEY_decrypt_init, EVP_PKEY_decrypt_init_ex, EVP_PKEY_decrypt - decrypt using a public key algorithm</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_PKEY_decrypt_init, EVP_PKEY_decrypt_init_ex, EVP_PKEY_decrypt - decrypt using a public key algorithm

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/evp.h&gt;

        int EVP_PKEY_decrypt_init(EVP_PKEY_CTX *ctx);
        int EVP_PKEY_decrypt_init_ex(EVP_PKEY_CTX *ctx, const OSSL_PARAM params[]);
        int EVP_PKEY_decrypt(EVP_PKEY_CTX *ctx,
                             unsigned char *out, size_t *outlen,
                             const unsigned char *in, size_t inlen);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>EVP_PKEY_decrypt_init()</b> function initializes a public key algorithm context using key <u>pkey</u> for a
       decryption operation.

       The <b>EVP_PKEY_decrypt_init_ex()</b> function initializes a public key algorithm context using key <u>pkey</u> for a
       decryption operation and sets the algorithm specific <u>params</u>.

       The <b>EVP_PKEY_decrypt()</b> function performs a public key decryption operation using <u>ctx</u>. The data to be
       decrypted is specified using the <u>in</u> and <u>inlen</u> parameters. If <u>out</u> is NULL then the minimum required size
       of the output buffer is written to the <u>*outlen</u> parameter.

       If <u>out</u> is not NULL then before the call the <u>*outlen</u> parameter must contain the length of the <u>out</u> buffer.
       If the call is successful the decrypted data is written to <u>out</u> and the amount of the decrypted data
       written to <u>*outlen</u>, otherwise an error is returned.

</pre><h4><b>NOTES</b></h4><pre>
       After the call to <b>EVP_PKEY_decrypt_init()</b> algorithm specific control operations can be performed to set
       any appropriate parameters for the operation.  These operations can be included in the
       <b>EVP_PKEY_decrypt_init_ex()</b> call.

       The function <b>EVP_PKEY_decrypt()</b> can be called more than once on the same context if several operations
       are performed using the same parameters.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>EVP_PKEY_decrypt_init()</b>, <b>EVP_PKEY_decrypt_init_ex()</b> and <b>EVP_PKEY_decrypt()</b> return 1 for success and 0 or
       a negative value for failure. In particular a return value of -2 indicates the operation is not supported
       by the public key algorithm.

</pre><h4><b>WARNINGS</b></h4><pre>
       In OpenSSL versions before 3.2.0, when used in PKCS#1 v1.5 padding, both the return value from the
       <b>EVP_PKEY_decrypt()</b> and the <b>outlen</b> provided information useful in mounting a Bleichenbacher attack against
       the used private key. They had to be processed in a side-channel free way.

       Since version 3.2.0, the <b>EVP_PKEY_decrypt()</b> method when used with PKCS#1 v1.5 padding as implemented in
       the <b>default</b> provider implements the implicit rejection mechanism (see
       <b>OSSL_ASYM_CIPHER_PARAM_IMPLICIT_REJECTION</b> in <b><a href="../man7/provider-asym_cipher.7.html">provider-asym_cipher</a></b>(7)).  That means it doesn't return an
       error when it detects an error in padding, instead it returns a pseudo-randomly generated message,
       removing the need of side-channel secure code from applications using OpenSSL.  If OpenSSL is configured
       to use a provider that doesn't implement implicit rejection, the code still needs to handle the returned
       values using side-channel free code.  Side-channel free handling of the error stack can be performed
       using either a pair of unconditional <b><a href="../man3/ERR_set_mark.3.html">ERR_set_mark</a></b>(3) and <b><a href="../man3/ERR_pop_to_mark.3.html">ERR_pop_to_mark</a></b>(3) calls or by using the
       <b><a href="../man3/ERR_clear_error.3.html">ERR_clear_error</a></b>(3) call.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Decrypt data using OAEP (for RSA keys):

        #include &lt;openssl/evp.h&gt;
        #include &lt;openssl/rsa.h&gt;

        EVP_PKEY_CTX *ctx;
        ENGINE *eng;
        unsigned char *out, *in;
        size_t outlen, inlen;
        EVP_PKEY *key;

        /*
         * NB: assumes key, eng, in, inlen are already set up
         * and that key is an RSA private key
         */
        ctx = EVP_PKEY_CTX_new(key, eng);
        if (!ctx)
            /* Error occurred */
        if (EVP_PKEY_decrypt_init(ctx) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_set_rsa_padding(ctx, RSA_PKCS1_OAEP_PADDING) &lt;= 0)
            /* Error */

        /* Determine buffer length */
        if (EVP_PKEY_decrypt(ctx, NULL, &amp;outlen, in, inlen) &lt;= 0)
            /* Error */

        out = OPENSSL_malloc(outlen);

        if (!out)
            /* malloc failure */

        if (EVP_PKEY_decrypt(ctx, out, &amp;outlen, in, inlen) &lt;= 0)
            /* Error */

        /* Decrypted data is outlen bytes written to buffer out */

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_PKEY_CTX_new.3.html">EVP_PKEY_CTX_new</a></b>(3), <b><a href="../man3/EVP_PKEY_encrypt.3.html">EVP_PKEY_encrypt</a></b>(3), <b><a href="../man3/EVP_PKEY_sign.3.html">EVP_PKEY_sign</a></b>(3), <b><a href="../man3/EVP_PKEY_verify.3.html">EVP_PKEY_verify</a></b>(3),
       <b><a href="../man3/EVP_PKEY_verify_recover.3.html">EVP_PKEY_verify_recover</a></b>(3), <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       These functions were added in OpenSSL 1.0.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2006-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                             <u><a href="../man3SSL/EVP_PKEY_DECRYPT.3SSL.html">EVP_PKEY_DECRYPT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>