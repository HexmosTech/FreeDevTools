<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKCS7_sign_add_signer, PKCS7_add_certificate, PKCS7_add_crl - add information to PKCS7 structure</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       PKCS7_sign_add_signer, PKCS7_add_certificate, PKCS7_add_crl - add information to PKCS7 structure

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/pkcs7.h&gt;

        PKCS7_SIGNER_INFO *PKCS7_sign_add_signer(PKCS7 *p7, X509 *signcert,
                                                 EVP_PKEY *pkey, const EVP_MD *md, int flags);
        int PKCS7_add_certificate(PKCS7 *p7, X509 *cert);
        int PKCS7_add_crl(PKCS7 *p7, X509_CRL *crl);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>PKCS7_sign_add_signer()</b> adds a signer with certificate <u>signcert</u> and private key <u>pkey</u> using message digest
       <u>md</u> to a PKCS7 signed data structure <u>p7</u>.

       The <b>PKCS7</b> structure should be obtained from an initial call to <b>PKCS7_sign()</b> with the flag <b>PKCS7_PARTIAL</b>
       set or in the case or re-signing a valid PKCS#7 signed data structure.

       If the <u>md</u> parameter is NULL then the default digest for the public key algorithm will be used.

       Unless the <b>PKCS7_REUSE_DIGEST</b> flag is set the returned <b>PKCS7</b> structure is not complete and must be
       finalized either by streaming (if applicable) or a call to <b>PKCS7_final()</b>.

</pre><h4><b>NOTES</b></h4><pre>
       The main purpose of this function is to provide finer control over a PKCS#7 signed data structure where
       the simpler <b>PKCS7_sign()</b> function defaults are not appropriate. For example if multiple signers or non
       default digest algorithms are needed.

       Any of the following flags (ored together) can be passed in the <u>flags</u> parameter.

       If <b>PKCS7_REUSE_DIGEST</b> is set then an attempt is made to copy the content digest value from the <b>PKCS7</b>
       structure: to add a signer to an existing structure.  An error occurs if a matching digest value cannot
       be found to copy. The returned <b>PKCS7</b> structure will be valid and finalized when this flag is set.

       If <b>PKCS7_PARTIAL</b> is set in addition to <b>PKCS7_REUSE_DIGEST</b> then the <b>PKCS7_SIGNER_INO</b> structure will not be
       finalized so additional attributes can be added. In this case an explicit call to
       <b>PKCS7_SIGNER_INFO_sign()</b> is needed to finalize it.

       If <b>PKCS7_NOCERTS</b> is set the signer's certificate will not be included in the <b>PKCS7</b> structure, the
       signer's certificate must still be supplied in the <u>signcert</u> parameter though. This can reduce the size of
       the signature if the signers certificate can be obtained by other means: for example a previously signed
       message.

       The signedData structure includes several PKCS#7 authenticatedAttributes including the signing time, the
       PKCS#7 content type and the supported list of ciphers in an SMIMECapabilities attribute. If <b>PKCS7_NOATTR</b>
       is set then no authenticatedAttributes will be used. If <b>PKCS7_NOSMIMECAP</b> is set then just the
       SMIMECapabilities are omitted.

       If present the SMIMECapabilities attribute indicates support for the following algorithms: triple DES,
       128 bit RC2, 64 bit RC2, DES and 40 bit RC2. If any of these algorithms is disabled then it will not be
       included.

       <b>PKCS7_sign_add_signers()</b> returns an internal pointer to the <b>PKCS7_SIGNER_INFO</b> structure just added, which
       can be used to set additional attributes before it is finalized.

       <b>PKCS7_add_certificate()</b> adds to the <b>PKCS7</b> structure <u>p7</u> the certificate <u>cert</u>, which may be an end-entity
       (signer) certificate or a CA certificate useful for chain building.  This is done internally by
       <b><a href="../man3/PKCS7_sign_ex.3.html">PKCS7_sign_ex</a></b>(3) and similar signing functions.  It may have to be used before calling <b><a href="../man3/PKCS7_verify.3.html">PKCS7_verify</a></b>(3) in
       order to provide any missing certificate(s) needed for verification.

       <b>PKCS7_add_crl()</b> adds the CRL <u>crl</u> to the <b>PKCS7</b> structure <u>p7</u>.  This may be called to provide certificate
       status information to be included when signing or to use when verifying the <b>PKCS7</b> structure.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>PKCS7_sign_add_signers()</b> returns an internal pointer to the <b>PKCS7_SIGNER_INFO</b> structure just added or
       NULL if an error occurs.

       <b>PKCS7_add_certificate()</b> and <b>PKCS7_add_crl()</b> return 1 on success, 0 on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3), <b><a href="../man3/PKCS7_sign_ex.3.html">PKCS7_sign_ex</a></b>(3), <b><a href="../man3/PKCS7_final.3.html">PKCS7_final</a></b>(3), <b><a href="../man3/PKCS7_verify.3.html">PKCS7_verify</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>PPKCS7_sign_add_signer()</b> function was added in OpenSSL 1.0.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2007-2016 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                        <u><a href="../man3SSL/PKCS7_SIGN_ADD_SIGNER.3SSL.html">PKCS7_SIGN_ADD_SIGNER</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>