<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pktbuff - User-space network packet buffer</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnetfilter-queue-doc">libnetfilter-queue-doc_1.0.5-4build1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pktbuff - User-space network packet buffer

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Modules</b>
       <b>Other</b> <b>functions</b>

   <b>Functions</b>
       struct pkt_buff * <b>pktb_alloc</b> (int family, void *data, size_t len, size_t extra)
       uint8_t * <b>pktb_data</b> (struct pkt_buff *pktb)
       uint32_t <b>pktb_len</b> (struct pkt_buff *pktb)
       void <b>pktb_free</b> (struct pkt_buff *pktb)
       int <b>pktb_mangle</b> (struct pkt_buff *pktb, int dataoff, unsigned int match_offset, unsigned int match_len,
           const char *rep_buffer, unsigned int rep_len)
       bool <b>pktb_mangled</b> (const struct pkt_buff *pktb)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       This library provides the user-space network packet buffer. This abstraction is strongly inspired by
       Linux kernel network buffer, the so-called sk_buff.

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>struct</b> <b>pkt_buff</b> <b>*</b> <b>pktb_alloc</b> <b>(int</b> <b>family,</b> <b>void</b> <b>*</b> <b>data,</b> <b>size_t</b> <b>len,</b> <b>size_t</b> <b>extra)</b>
       pktb_alloc - allocate a new packet buffer

       <b>Parameters</b>
           <u>family</u> Indicate what family. Currently supported families are AF_BRIDGE, AF_INET &amp; AF_INET6.
           <u>data</u> Pointer to packet data
           <u>len</u> Packet length
           <u>extra</u> Extra memory in the tail to be allocated (for mangling)

       This function returns a packet buffer that contains the packet data and some extra memory room in the
       tail (if requested).

       <b>Returns</b>
           Pointer to a new userspace packet buffer or NULL on failure.

       <b>Errors</b>
           <b>ENOMEM</b> From <b>calloc</b>()
           <b>EPROTONOSUPPORT</b> <u>family</u> was <b>AF_BRIDGE</b> and this is not an IP packet (v4 or v6)

       <b>See</b> <b>also</b>
           <b><a href="../man3/calloc.3.html">calloc</a></b>(3)

       Definition at line <b>52</b> of file <b>pktbuff.c</b>.

   <b>uint8_t</b> <b>*</b> <b>pktb_data</b> <b>(struct</b> <b>pkt_buff</b> <b>*</b> <b>pktb)</b>
       pktb_data - get pointer to network packet

       <b>Parameters</b>
           <u>pktb</u> Pointer to userspace packet buffer

       <b>Returns</b>
           Pointer to start of network packet data within <b>pktb</b>

           It is appropriate to use <u>pktb_data</u> as the second argument of <b>nfq_nlmsg_verdict_put_pkt()</b>

       Definition at line <b>105</b> of file <b>pktbuff.c</b>.

   <b>void</b> <b>pktb_free</b> <b>(struct</b> <b>pkt_buff</b> <b>*</b> <b>pktb)</b>
       pktb_free - release packet buffer

       <b>Parameters</b>
           <u>pktb</u> Pointer to userspace packet buffer

       Definition at line <b>129</b> of file <b>pktbuff.c</b>.

   <b>uint32_t</b> <b>pktb_len</b> <b>(struct</b> <b>pkt_buff</b> <b>*</b> <b>pktb)</b>
       pktb_len - get length of packet buffer

       <b>Parameters</b>
           <u>pktb</u> Pointer to userspace packet buffer

       <b>Returns</b>
           Length of packet contained within <b>pktb</b>

           It is appropriate to use <u>pktb_len</u> as the third argument of <b>nfq_nlmsg_verdict_put_pkt()</b>

       Definition at line <b>119</b> of file <b>pktbuff.c</b>.

   <b>int</b> <b>pktb_mangle</b> <b>(struct</b> <b>pkt_buff</b> <b>*</b> <b>pktb,</b> <b>int</b> <b>dataoff,</b> <b>unsigned</b> <b>int</b> <b>match_offset,</b> <b>unsigned</b> <b>int</b> <b>match_len,</b>
       <b>const</b> <b>char</b> <b>*</b> <b>rep_buffer,</b> <b>unsigned</b> <b>int</b> <b>rep_len)</b>
       pktb_mangle - adjust contents of a packet

       <b>Parameters</b>
           <u>pktb</u> Pointer to userspace packet buffer
           <u>dataoff</u> Supplementary offset, usually offset from layer 3 (IP) header to the layer 4 (TCP or UDP)
           header. Specify zero to access the layer 3 header. If <b>pktb</b> was created in family <b>AF_BRIDGE</b>, specify
           <b>-ETH_HLEN</b> (a negative offset) to access the layer 2 (MAC) header.
           <u>match_offset</u> Further offset to content that you want to mangle
           <u>match_len</u> Length of the existing content you want to mangle
           <u>rep_buffer</u> Pointer to data you want to use to replace current content
           <u>rep_len</u> Length of data you want to use to replace current content

       <b>Returns</b>
           1 for success and 0 for failure. Failure will occur if the <b>extra</b> argument to the <b>pktb_alloc()</b> call
           that created <b>pktb</b> is less than the excess of <b>rep_len</b> over <b>match_len</b>

       <b>Warning</b>
           pktb_mangle does not update any checksums. Developers should use the appropriate mangler for the
           protocol level: <b>nfq_ip_mangle()</b>, <b>nfq_tcp_mangle_ipv4()</b> or <b>nfq_udp_mangle_ipv4()</b>. IPv6 versions are
           planned.
           It is appropriate to use pktb_mangle to change the MAC header.

       Definition at line <b>314</b> of file <b>pktbuff.c</b>.

   <b>bool</b> <b>pktb_mangled</b> <b>(const</b> <b>struct</b> <b>pkt_buff</b> <b>*</b> <b>pktb)</b>
       pktb_mangled - test whether packet has been mangled

       <b>Parameters</b>
           <u>pktb</u> Pointer to userspace packet buffer

       <b>Returns</b>
           <b>true</b> if packet has been mangled (modified), else <b>false</b>

           When assembling a verdict, it is not necessary to return the contents of un-modified packets. Use
           <u>pktb_mangled</u> to decide whether packet contents need to be returned.

       Definition at line <b>359</b> of file <b>pktbuff.c</b>.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for libnetfilter_queue from the source code.

libnetfilter_queue                                Version 1.0.5                                       <u><a href="../man3/pktbuff.3.html">pktbuff</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>