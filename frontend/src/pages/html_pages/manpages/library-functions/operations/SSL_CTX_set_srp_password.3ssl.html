<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_set_srp_username, SSL_CTX_set_srp_password, SSL_CTX_set_srp_strength, SSL_CTX_set_srp_cb_arg,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_set_srp_username, SSL_CTX_set_srp_password, SSL_CTX_set_srp_strength, SSL_CTX_set_srp_cb_arg,
       SSL_CTX_set_srp_username_callback, SSL_CTX_set_srp_client_pwd_callback,
       SSL_CTX_set_srp_verify_param_callback, SSL_set_srp_server_param, SSL_set_srp_server_param_pw,
       SSL_get_srp_g, SSL_get_srp_N, SSL_get_srp_username, SSL_get_srp_userinfo - SRP control operations

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        int SSL_CTX_set_srp_username(SSL_CTX *ctx, char *name);
        int SSL_CTX_set_srp_password(SSL_CTX *ctx, char *password);
        int SSL_CTX_set_srp_strength(SSL_CTX *ctx, int strength);
        int SSL_CTX_set_srp_cb_arg(SSL_CTX *ctx, void *arg);
        int SSL_CTX_set_srp_username_callback(SSL_CTX *ctx,
                                              int (*cb) (SSL *s, int *ad, void *arg));
        int SSL_CTX_set_srp_client_pwd_callback(SSL_CTX *ctx,
                                                char *(*cb) (SSL *s, void *arg));
        int SSL_CTX_set_srp_verify_param_callback(SSL_CTX *ctx,
                                                  int (*cb) (SSL *s, void *arg));

        int SSL_set_srp_server_param(SSL *s, const BIGNUM *N, const BIGNUM *g,
                                     BIGNUM *sa, BIGNUM *v, char *info);
        int SSL_set_srp_server_param_pw(SSL *s, const char *user, const char *pass,
                                        const char *grp);

        BIGNUM *SSL_get_srp_g(SSL *s);
        BIGNUM *SSL_get_srp_N(SSL *s);

        char *SSL_get_srp_username(SSL *s);
        char *SSL_get_srp_userinfo(SSL *s);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       All of the functions described on this page are deprecated. There are no available replacement functions
       at this time.

       These functions provide access to SRP (Secure Remote Password) parameters, an alternate authentication
       mechanism for TLS. SRP allows the use of usernames and passwords over unencrypted channels without
       revealing the password to an eavesdropper. SRP also supplies a shared secret at the end of the
       authentication sequence that can be used to generate encryption keys.

       The SRP protocol, version 3 is specified in RFC 2945. SRP version 6 is described in RFC 5054 with
       applications to TLS authentication.

       The <b>SSL_CTX_set_srp_username()</b> function sets the SRP username for <b>ctx</b>. This should be called on the
       client prior to creating a connection to the server.  The length of <b>name</b> must be shorter or equal to 255
       characters.

       The <b>SSL_CTX_set_srp_password()</b> function sets the SRP password for <b>ctx</b>. This may be called on the client
       prior to creating a connection to the server.  This overrides the effect of
       <b>SSL_CTX_set_srp_client_pwd_callback()</b>.

       The <b>SSL_CTX_set_srp_strength()</b> function sets the SRP strength for <b>ctx</b>. This is the minimal length of the
       SRP prime in bits. If not specified 1024 is used.  If not satisfied by the server key exchange the
       connection will be rejected.

       The <b>SSL_CTX_set_srp_cb_arg()</b> function sets an extra parameter that will be passed to all following
       callbacks as <b>arg</b>.

       The <b>SSL_CTX_set_srp_username_callback()</b> function sets the server side callback that is invoked when an
       SRP username is found in a ClientHello.  The callback parameters are the SSL connection <b>s</b>, a writable
       error flag <b>ad</b> and the extra argument <b>arg</b> set by <b>SSL_CTX_set_srp_cb_arg()</b>.  This callback should setup the
       server for the key exchange by calling <b>SSL_set_srp_server_param()</b> with the appropriate parameters for the
       received username. The username can be obtained by calling <b>SSL_get_srp_username()</b>.  See <b><a href="../man3/SRP_VBASE_init.3.html">SRP_VBASE_init</a></b>(3)
       to parse the verifier file created by <b><a href="../man1/openssl-srp.1.html">openssl-srp</a></b>(1) or <b><a href="../man3/SRP_create_verifier.3.html">SRP_create_verifier</a></b>(3) to generate it.  The
       callback should return <b>SSL_ERROR_NONE</b> to proceed with the server key exchange, <b>SSL3_AL_FATAL</b> for a fatal
       error or any value &lt; 0 for a retryable error.  In the event of a <b>SSL3_AL_FATAL</b> the alert flag given by
       <b>*al</b> will be sent back. By default this will be <b>SSL_AD_UNKNOWN_PSK_IDENTITY</b>.

       The <b>SSL_CTX_set_srp_client_pwd_callback()</b> function sets the client password callback on the client.  The
       callback parameters are the SSL connection <b>s</b> and the extra argument <b>arg</b> set by <b>SSL_CTX_set_srp_cb_arg()</b>.
       The callback will be called as part of the generation of the client secrets.  It should return the client
       password in text form or NULL to abort the connection.  The resulting memory will be freed by the library
       as part of the callback resolution.  This overrides the effect of <b>SSL_CTX_set_srp_password()</b>.

       The <b>SSL_CTX_set_srp_verify_param_callback()</b> sets the SRP gN parameter verification callback on the
       client. This allows the client to perform custom verification when receiving the server SRP proposed
       parameters.  The callback parameters are the SSL connection <b>s</b> and the extra argument <b>arg</b> set by
       <b>SSL_CTX_set_srp_cb_arg()</b>.  The callback should return a positive value to accept the server parameters.
       Returning 0 or a negative value will abort the connection. The server parameters can be obtained by
       calling <b>SSL_get_srp_N()</b> and <b>SSL_get_srp_g()</b>.  Sanity checks are already performed by the library after
       the handshake (B % N non zero, check against the strength parameter) and are not necessary.  If no
       callback is set the g and N parameters will be checked against known RFC 5054 values.

       The <b>SSL_set_srp_server_param()</b> function sets all SRP parameters for the connection <b>s</b>. <b>N</b> and <b>g</b> are the SRP
       group parameters, <b>sa</b> is the user salt, <b>v</b> the password verifier and <b>info</b> is the optional user info.

       The <b>SSL_set_srp_server_param_pw()</b> function sets all SRP parameters for the connection <b>s</b> by generating a
       random salt and a password verifier.  <b>user</b> is the username, <b>pass</b> the password and <b>grp</b> the SRP group
       parameters identifier for <b><a href="../man3/SRP_get_default_gN.3.html">SRP_get_default_gN</a></b>(3).

       The <b>SSL_get_srp_g()</b> function returns the SRP group generator for <b>s</b>, or from the underlying SSL_CTX if it
       is NULL.

       The <b>SSL_get_srp_N()</b> function returns the SRP prime for <b>s</b>, or from the underlying SSL_CTX if it is NULL.

       The <b>SSL_get_srp_username()</b> function returns the SRP username for <b>s</b>, or from the underlying SSL_CTX if it
       is NULL.

       The <b>SSL_get_srp_userinfo()</b> function returns the SRP user info for <b>s</b>, or from the underlying SSL_CTX if it
       is NULL.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       All SSL_CTX_set_* functions return 1 on success and 0 on failure.

       <b>SSL_set_srp_server_param()</b> returns 1 on success and -1 on failure.

       The SSL_get_SRP_* functions return a pointer to the requested data, the memory is owned by the library
       and should not be freed by the caller.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Setup SRP parameters on the client:

        #include &lt;openssl/ssl.h&gt;

        const char *username = "username";
        const char *password = "password";

        SSL_CTX *ctx = SSL_CTX_new(TLS_client_method());
        if (!ctx)
            /* Error */
        if (!SSL_CTX_set_srp_username(ctx, username))
            /* Error */
        if (!SSL_CTX_set_srp_password(ctx, password))
            /* Error */

       Setup SRP server with verifier file:

        #include &lt;openssl/srp.h&gt;
        #include &lt;openssl/ssl.h&gt;

        const char *srpvfile = "password.srpv";

        int srpServerCallback(SSL *s, int *ad, void *arg)
        {
            SRP_VBASE *srpData = (SRP_VBASE*) arg;
            char *username = SSL_get_srp_username(s);

            SRP_user_pwd *user_pwd = SRP_VBASE_get1_by_user(srpData, username);
            if (!user_pwd)
                /* Error */
                return SSL3_AL_FATAL;

            if (SSL_set_srp_server_param(s, user_pwd-&gt;N, user_pwd-&gt;g,
                user_pwd-&gt;s, user_pwd-&gt;v, user_pwd-&gt;info) &lt; 0)
                /* Error */

            SRP_user_pwd_free(user_pwd);
            return SSL_ERROR_NONE;
        }

        SSL_CTX *ctx = SSL_CTX_new(TLS_server_method());
        if (!ctx)
            /* Error */

        /*
         * seedKey should contain a NUL terminated sequence
         * of random non NUL bytes
         */
        const char *seedKey;

        SRP_VBASE *srpData = SRP_VBASE_new(seedKey);
        if (SRP_VBASE_init(srpData, (char*) srpvfile) != SRP_NO_ERROR)
           /* Error */

        SSL_CTX_set_srp_cb_arg(ctx, srpData);
        SSL_CTX_set_srp_username_callback(ctx, srpServerCallback);

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man1/openssl-srp.1.html">openssl-srp</a></b>(1), <b><a href="../man3/SRP_VBASE_new.3.html">SRP_VBASE_new</a></b>(3), <b><a href="../man3/SRP_create_verifier.3.html">SRP_create_verifier</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       These functions were added in OpenSSL 1.0.1 and deprecated in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2018-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                     <u><a href="../man3SSL/SSL_CTX_SET_SRP_PASSWORD.3SSL.html">SSL_CTX_SET_SRP_PASSWORD</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>