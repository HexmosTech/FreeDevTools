<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_check_chain - check certificate chain suitability</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_check_chain - check certificate chain suitability

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        int SSL_check_chain(SSL *s, X509 *x, EVP_PKEY *pk, STACK_OF(X509) *chain);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_check_chain()</b> checks whether certificate <b>x</b>, private key <b>pk</b> and certificate chain <b>chain</b> is suitable
       for use with the current session <b>s</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_check_chain()</b> returns a bitmap of flags indicating the validity of the chain.

       <b>CERT_PKEY_VALID</b>: the chain can be used with the current session.  If this flag is <b>not</b> set then the
       certificate will never be used even if the application tries to set it because it is inconsistent with
       the peer preferences.

       <b>CERT_PKEY_SIGN</b>: the EE key can be used for signing.

       <b>CERT_PKEY_EE_SIGNATURE</b>: the signature algorithm of the EE certificate is acceptable.

       <b>CERT_PKEY_CA_SIGNATURE</b>: the signature algorithms of all CA certificates are acceptable.

       <b>CERT_PKEY_EE_PARAM</b>: the parameters of the end entity certificate are acceptable (e.g. it is a supported
       curve).

       <b>CERT_PKEY_CA_PARAM</b>: the parameters of all CA certificates are acceptable.

       <b>CERT_PKEY_EXPLICIT_SIGN</b>: the end entity certificate algorithm can be used explicitly for signing (i.e. it
       is mentioned in the signature algorithms extension).

       <b>CERT_PKEY_ISSUER_NAME</b>: the issuer name is acceptable. This is only meaningful for client authentication.

       <b>CERT_PKEY_CERT_TYPE</b>: the certificate type is acceptable. Only meaningful for client authentication.

       <b>CERT_PKEY_SUITEB</b>: chain is suitable for Suite B use.

</pre><h4><b>NOTES</b></h4><pre>
       <b>SSL_check_chain()</b> must be called in servers after a client hello message or in clients after a
       certificate request message. It will typically be called in the certificate callback.

       An application wishing to support multiple certificate chains may call this function on each chain in
       turn: starting with the one it considers the most secure. It could then use the chain of the first set
       which returns suitable flags.

       As a minimum the flag <b>CERT_PKEY_VALID</b> must be set for a chain to be usable. An application supporting
       multiple chains with different CA signature algorithms may also wish to check <b>CERT_PKEY_CA_SIGNATURE</b> too.
       If no chain is suitable a server should fall back to the most secure chain which sets <b>CERT_PKEY_VALID</b>.

       The validity of a chain is determined by checking if it matches a supported signature algorithm,
       supported curves and in the case of client authentication certificate types and issuer names.

       Since the supported signature algorithms extension is only used in TLS 1.2, TLS 1.3 and DTLS 1.2 the
       results for earlier versions of TLS and DTLS may not be very useful. Applications may wish to specify a
       different "legacy" chain for earlier versions of TLS or DTLS.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/SSL_CTX_set_cert_cb.3.html">SSL_CTX_set_cert_cb</a></b>(3), <b><a href="../man7/ssl.7.html">ssl</a></b>(7)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2015-2018 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                              <u><a href="../man3SSL/SSL_CHECK_CHAIN.3SSL.html">SSL_CHECK_CHAIN</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>