<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>libnbd-ocaml - how to use libnbd from OCaml</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnbd-dev">libnbd-dev_1.22.2-1build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       libnbd-ocaml - how to use libnbd from OCaml

</pre><h4><b>SYNOPSIS</b></h4><pre>
        let nbd = NBD.create () in
        NBD.connect_uri nbd "nbd://localhost";
        let size = NBD.get_size nbd in
        printf "%Ld\n" size;
        NBD.close ()

       Alternate syntax which ensures that close is called even if an exception is thrown:

        let size =
          NBD.with_handle (
            fun nbd -&gt;
              NBD.connect_uri nbd "nbd://localhost";
              NBD.get_size nbd
          ) in
        printf "%Ld\n" size

       To compile:

        ocamlopt -I +nbd mlnbd.cmxa prog.ml -o prog

       or using findlib:

        ocamlfind opt -package nbd -linkpkg prog.ml -o prog

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This manual page documents how to use libnbd to access Network Block Device (NBD) servers from the OCaml
       programming language.

       The OCaml bindings work very similarly to the C bindings so you should start by reading <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3).

       For OCaml API documentation see <b><a href="../man3/NBD.3.html">NBD</a></b>(3).

</pre><h4><b>HANDLES</b></h4><pre>
       Create a libnbd handle of type "NBD.t" by calling "NBD.create ()".

       You can either close the handle explicitly by calling "NBD.close" or it will be closed automatically when
       it is garbage collected.  If you call any other method on a handle which you have explicitly closed then
       the API will throw an "NBD.Closed" exception.

       "NBD.with_handle" can be used to make sure the handle is closed in a timely manner.  See the example in
       the "SYNOPSIS" above.

</pre><h4><b>ERRORS</b></h4><pre>
       Libnbd errors are turned automatically into exceptions of type:

        NBD.Error (str, Unix.error option)

       The first exception parameter is a string which is the printable error message.  The second is the OCaml
       "Unix.error" code, if available (see <b><a href="../man3/nbd_get_errno.3.html">nbd_get_errno</a></b>(3)).

   <b>Callbacks</b> <b>with</b> <b>"int</b> <b>ref"</b> <b>error</b> <b>parameter</b>
       Some callbacks take an error parameter of type "int ref", corresponding to the "int *error" passed to
       those callbacks in C.  See also: "Callbacks with "int *error" parameter" in <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3)

       If an error occurs during the callback you can update the "int" in the reference, setting it to a
       <u>C-compatible</u> <u>errno</u>.  To convert an OCaml "Unix.error" into a C-compatible errno call
       "NBD.errno_of_unix_error".

</pre><h4><b>EXAMPLES</b></h4><pre>
       This directory contains examples written in OCaml:

       https://gitlab.com/nbdkit/libnbd/tree/master/ocaml/examples

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3), <b><a href="../man3/NBD.3.html">NBD</a></b>(3).

</pre><h4><b>AUTHORS</b></h4><pre>
       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
       General Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General
       Public License for more details.

       You should have received a copy of the GNU Lesser General Public License along with this library; if not,
       write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA

libnbd-1.22.2                                      2025-06-16                                    <u><a href="../man3/libnbd-ocaml.3.html">libnbd-ocaml</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>