<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rte_ptr_compress.h</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/dpdk-doc">dpdk-doc_24.11.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rte_ptr_compress.h

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/stdint.h">stdint.h</a>&gt;
       #include &lt;<a href="file:/usr/include/inttypes.h">inttypes.h</a>&gt;
       #include &lt;rte_bitops.h&gt;
       #include &lt;rte_branch_prediction.h&gt;
       #include &lt;rte_common.h&gt;
       #include &lt;rte_debug.h&gt;
       #include &lt;rte_vect.h&gt;

   <b>Macros</b>
       #define <b><a href="../manmem_length/RTE_PTR_COMPRESS_BITS_NEEDED_FOR_POINTER_WITHIN_RANGE.mem_length.html">RTE_PTR_COMPRESS_BITS_NEEDED_FOR_POINTER_WITHIN_RANGE</a></b>(mem_length)
       #define <b>RTE_PTR_COMPRESS_BIT_SHIFT_FROM_ALIGNMENT</b>(alignment)     ((alignment) == 0 ? 0 :
           <b>rte_ctz64</b>((uint64_t)alignment))
       #define <b>RTE_PTR_COMPRESS_CAN_COMPRESS_16_SHIFT</b>(mem_length,  obj_alignment)
       #define <b>RTE_PTR_COMPRESS_CAN_COMPRESS_32_SHIFT</b>(mem_length,  obj_alignment)

   <b>Functions</b>
       static <b>__rte_always_inline</b> void <b>rte_ptr_compress_32_shift</b> (void *ptr_base, void *const *src_table,
           uint32_t *dest_table, size_t n, uint8_t bit_shift)
       static <b>__rte_always_inline</b> void <b>rte_ptr_decompress_32_shift</b> (void *ptr_base, uint32_t const *src_table,
           void **dest_table, size_t n, uint8_t bit_shift)
       static <b>__rte_always_inline</b> void <b>rte_ptr_compress_16_shift</b> (void *ptr_base, void *const *src_table,
           uint16_t *dest_table, size_t n, uint8_t bit_shift)
       static <b>__rte_always_inline</b> void <b>rte_ptr_decompress_16_shift</b> (void *ptr_base, uint16_t const *src_table,
           void **dest_table, size_t n, uint8_t bit_shift)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       Pointer compression and decompression functions.

       When passing arrays full of pointers between threads, memory containing the pointers is copied multiple
       times which is especially costly between cores. These functions allow us to compress the pointers.

       Compression takes advantage of the fact that pointers are usually located in a limited memory region. We
       compress them by converting them to offsets from a base memory address. Offsets can be stored in fewer
       bytes.

       The compression functions come in two varieties: 32-bit and 16-bit.

       To determine how many bits are needed to compress the pointer, calculate the biggest offset possible
       (highest value pointer - base pointer) and shift the value right according to alignment (shift by
       exponent of the power of 2 of alignment: aligned by 4 - shift by 2, aligned by 8 - shift by 3, etc.). The
       resulting value must fit in either 32 or 16 bits. You may use the macros provided in this file to do it
       programmatically.

       For usage example and further explanation please see this library's documentation in the programming
       guide.

       Definition in file <b>rte_ptr_compress.h</b>.

</pre><h4><b>Macro</b> <b>Definition</b> <b>Documentation</b></h4><pre>
   <b>#define</b> <b><a href="../manmem_length/RTE_PTR_COMPRESS_BITS_NEEDED_FOR_POINTER_WITHIN_RANGE.mem_length.html">RTE_PTR_COMPRESS_BITS_NEEDED_FOR_POINTER_WITHIN_RANGE</a>(mem_length)</b>
       <b>Value:</b>.PP
           (((uint64_t)mem_length) &lt; 2 ? 1 : \
               (sizeof(uint64_t) * CHAR_BIT - \
                rte_clz64((uint64_t)mem_length - 1)))
       Calculate how many bits are required to store pointers within a given memory region as offsets. This can
       help decide which pointer compression functions can be used.

       <b>Parameters</b>
           <u>mem_length</u> Length of the memory region the pointers are constrained to.

       <b>Returns</b>
           Number of bits required to store a value.

       Definition at line <b>56</b> of file <b>rte_ptr_compress.h</b>.

   <b>#define</b> <b>RTE_PTR_COMPRESS_BIT_SHIFT_FROM_ALIGNMENT(alignment)</b>     <b>((alignment)</b> <b>==</b> <b>0</b> <b>?</b> <b>0</b> <b>:</b>
       <b>rte_ctz64((uint64_t)alignment))</b>
       Calculate how many bits in the address can be dropped without losing any information thanks to the
       alignment of the address.

       <b>Parameters</b>
           <u>alignment</u> Memory alignment.

       <b>Returns</b>
           Size of shift allowed without dropping any information from the pointer.

       Definition at line <b>70</b> of file <b>rte_ptr_compress.h</b>.

   <b>#define</b> <b>RTE_PTR_COMPRESS_CAN_COMPRESS_16_SHIFT(mem_length,</b> <b>obj_alignment)</b>
       <b>Value:</b>.PP
           ((<a href="../manmem_length/RTE_PTR_COMPRESS_BITS_NEEDED_FOR_POINTER_WITHIN_RANGE.mem_length.html">RTE_PTR_COMPRESS_BITS_NEEDED_FOR_POINTER_WITHIN_RANGE</a>(mem_length) - \
           RTE_PTR_COMPRESS_BIT_SHIFT_FROM_ALIGNMENT(obj_alignment)) &lt;= 16 ? 1 : 0)
       Determine if rte_ptr_compress_16_shift can be used to compress pointers that contain addresses of memory
       objects whose memory is aligned by a given amount and contained in a given memory region.

       <b>Parameters</b>
           <u>mem_length</u> The length of the memory region that contains the objects pointed to.
           <u>obj_alignment</u> The alignment of objects pointed to.

       <b>Returns</b>
           1 if function can be used, 0 otherwise.

       Definition at line <b>85</b> of file <b>rte_ptr_compress.h</b>.

   <b>#define</b> <b>RTE_PTR_COMPRESS_CAN_COMPRESS_32_SHIFT(mem_length,</b> <b>obj_alignment)</b>
       <b>Value:</b>.PP
           ((<a href="../manmem_length/RTE_PTR_COMPRESS_BITS_NEEDED_FOR_POINTER_WITHIN_RANGE.mem_length.html">RTE_PTR_COMPRESS_BITS_NEEDED_FOR_POINTER_WITHIN_RANGE</a>(mem_length) - \
           RTE_PTR_COMPRESS_BIT_SHIFT_FROM_ALIGNMENT(obj_alignment)) &lt;= 32 ? 1 : 0)
       Determine if rte_ptr_compress_32_shift can be used to compress pointers that contain addresses of memory
       objects whose memory is aligned by a given amount and contained in a given memory region.

       <b>Parameters</b>
           <u>mem_length</u> The length of the memory region that contains the objects pointed to.
           <u>obj_alignment</u> The alignment of objects pointed to.

       <b>Returns</b>
           1 if function can be used, 0 otherwise.

       Definition at line <b>101</b> of file <b>rte_ptr_compress.h</b>.

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>static</b> <b>__rte_always_inline</b> <b>void</b> <b>rte_ptr_compress_32_shift</b> <b>(void</b> <b>*</b> <b>ptr_base,</b> <b>void</b> <b>*const</b> <b>*</b> <b>src_table,</b> <b>uint32_t</b>
       <b>*</b> <b>dest_table,</b> <b>size_t</b> <b>n,</b> <b>uint8_t</b> <b>bit_shift)</b> <b>[static]</b>
       Compress pointers into 32-bit offsets from base pointer.

       <b>Note</b>
           It is programmer's responsibility to ensure the resulting offsets fit into 32 bits. Alignment of the
           structures pointed to by the pointers allows us to drop bits from the offsets. This is controlled by
           the bit_shift parameter. This means that if structures are aligned by 8 bytes they must be within
           32GB of the base pointer. If there is no such alignment guarantee they must be within 4GB.

       <b>Parameters</b>
           <u>ptr_base</u> A pointer used to calculate offsets of pointers in src_table.
           <u>src_table</u> A pointer to an array of pointers.
           <u>dest_table</u> A pointer to an array of compressed pointers returned by this function.
           <u>n</u> The number of objects to compress, must be strictly positive.
           <u>bit_shift</u> Byte alignment of memory pointed to by the pointers allows for bits to be dropped from the
           offset and hence widen the memory region that can be covered. This controls how many bits are right
           shifted.

       Definition at line <b>129</b> of file <b>rte_ptr_compress.h</b>.

   <b>static</b> <b>__rte_always_inline</b> <b>void</b> <b>rte_ptr_decompress_32_shift</b> <b>(void</b> <b>*</b> <b>ptr_base,</b> <b>uint32_t</b> <b>const</b> <b>*</b> <b>src_table,</b>
       <b>void</b> <b>**</b> <b>dest_table,</b> <b>size_t</b> <b>n,</b> <b>uint8_t</b> <b>bit_shift)</b> <b>[static]</b>
       Decompress pointers from 32-bit offsets from base pointer.

       <b>Parameters</b>
           <u>ptr_base</u> A pointer which was used to calculate offsets in src_table.
           <u>src_table</u> A pointer to an array to compressed pointers.
           <u>dest_table</u> A pointer to an array of decompressed pointers returned by this function.
           <u>n</u> The number of objects to decompress, must be strictly positive.
           <u>bit_shift</u> Byte alignment of memory pointed to by the pointers allows for bits to be dropped from the
           offset and hence widen the memory region that can be covered. This controls how many bits are left
           shifted when pointers are recovered from the offsets.

       Definition at line <b>190</b> of file <b>rte_ptr_compress.h</b>.

   <b>static</b> <b>__rte_always_inline</b> <b>void</b> <b>rte_ptr_compress_16_shift</b> <b>(void</b> <b>*</b> <b>ptr_base,</b> <b>void</b> <b>*const</b> <b>*</b> <b>src_table,</b> <b>uint16_t</b>
       <b>*</b> <b>dest_table,</b> <b>size_t</b> <b>n,</b> <b>uint8_t</b> <b>bit_shift)</b> <b>[static]</b>
       Compress pointers into 16-bit offsets from base pointer.

       <b>Note</b>
           It is programmer's responsibility to ensure the resulting offsets fit into 16 bits. Alignment of the
           structures pointed to by the pointers allows us to drop bits from the offsets. This is controlled by
           the bit_shift parameter. This means that if structures are aligned by 8 bytes they must be within
           256KB of the base pointer. If there is no such alignment guarantee they must be within 64KB.

       <b>Parameters</b>
           <u>ptr_base</u> A pointer used to calculate offsets of pointers in src_table.
           <u>src_table</u> A pointer to an array of pointers.
           <u>dest_table</u> A pointer to an array of compressed pointers returned by this function.
           <u>n</u> The number of objects to compress, must be strictly positive.
           <u>bit_shift</u> Byte alignment of memory pointed to by the pointers allows for bits to be dropped from the
           offset and hence widen the memory region that can be covered. This controls how many bits are right
           shifted.

       Definition at line <b>254</b> of file <b>rte_ptr_compress.h</b>.

   <b>static</b> <b>__rte_always_inline</b> <b>void</b> <b>rte_ptr_decompress_16_shift</b> <b>(void</b> <b>*</b> <b>ptr_base,</b> <b>uint16_t</b> <b>const</b> <b>*</b> <b>src_table,</b>
       <b>void</b> <b>**</b> <b>dest_table,</b> <b>size_t</b> <b>n,</b> <b>uint8_t</b> <b>bit_shift)</b> <b>[static]</b>
       Decompress pointers from 16-bit offsets from base pointer.

       <b>Parameters</b>
           <u>ptr_base</u> A pointer which was used to calculate offsets in src_table.
           <u>src_table</u> A pointer to an array to compressed pointers.
           <u>dest_table</u> A pointer to an array of decompressed pointers returned by this function.
           <u>n</u> The number of objects to decompress, must be strictly positive.
           <u>bit_shift</u> Byte alignment of memory pointed to by the pointers allows for bits to be dropped from the
           offset and hence widen the memory region that can be covered. This controls how many bits are left
           shifted when pointers are recovered from the offsets.

       Definition at line <b>298</b> of file <b>rte_ptr_compress.h</b>.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for DPDK from the source code.

DPDK                                             Version 24.11.2                           <u><a href="../man3/rte_ptr_compress.h.3.html">rte_ptr_compress.h</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>