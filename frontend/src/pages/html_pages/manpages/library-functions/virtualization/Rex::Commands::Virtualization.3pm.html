<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rex::Commands::Virtualization - Virtualization module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/rex">rex_1.16.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Rex::Commands::Virtualization - Virtualization module

</pre><h4><b>DESCRIPTION</b></h4><pre>
       With this module you can manage your virtualization.

       Version &lt;= 1.0: All these functions will not be reported.

       All these functions are not idempotent.

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Rex::Commands::Virtualization;

        set virtualization =&gt; "LibVirt";
        set virtualization =&gt; "VBox";

        use Data::Dumper;

        print Dumper vm list =&gt; "all";
        print Dumper vm list =&gt; "running";

        vm destroy =&gt; "vm01";

        vm delete =&gt; "vm01";

        vm start =&gt; "vm01";

        vm shutdown =&gt; "vm01";

        vm reboot =&gt; "vm01";

        vm option =&gt; "vm01",
              max_memory =&gt; 1024*1024,
              memory    =&gt; 512*1024;

        print Dumper vm info =&gt; "vm01";

        # creating a vm on a kvm host
        vm create =&gt; "vm01",
           storage    =&gt; [
             {
               file  =&gt; "/mnt/data/libvirt/images/vm01.img",
               dev   =&gt; "vda",
             }
           ];

        print Dumper vm hypervisor =&gt; "capabilities";

</pre><h4><b>EXPORTED</b> <b>FUNCTIONS</b></h4><pre>
   <b>vm($action</b> <b>=&gt;</b> <b>$name,</b> <b>%option)</b>
       This module only exports the <u>vm</u> function. You can manage everything with this function.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Creating</b> <b>a</b> <b>Virtual</b> <b>Machine</b>
       Create a (VirtualBox) VM named "vm01" with 512 MB ram and 1 cpu. One harddrive, 10 GB in size being a
       file on disk.  With a cdrom as an iso image and a natted network. The bootorder is set to "dvd".

        vm create =&gt; "vm01",
           storage    =&gt; [
             {
               file  =&gt; "/mnt/data/vbox/vm01.img",
               size  =&gt; "10G",
             },
             {
               file =&gt; "/mnt/iso/debian6.iso",
             }
           ],
           memory =&gt; 512,
           type =&gt; "Linux26",
           cpus =&gt; 1,
           boot =&gt; "dvd";

       Create a (KVM) VM named "vm01" with 512 MB ram and 1 cpu. One harddrive, 10 GB in size being a file on
       disk.  With a cdrom as an iso image and a bridged network on the bridge virbr0. The Bootorder is set to
       "cdrom".

        vm create =&gt; "vm01",
           boot =&gt; "cdrom",
           storage    =&gt; [
             {
               size  =&gt; "10G",
               file  =&gt; "/mnt/data/libvirt/images/vm01.img",
             },

             {
               file    =&gt; "/mnt/data/iso/debian-6.0.2.1-amd64-netinst.iso",
             },
           ];

       This is the same as above, but with all options in use.

        vm create =&gt; "vm01",
           memory  =&gt; 512*1024,
           cpus    =&gt; 1,
           arch    =&gt; "x86_64",
           boot    =&gt; "cdrom",
           clock   =&gt; "utc",
           emulator =&gt; "/usr/bin/qemu-system-x86_64",
           on_poweroff =&gt; "destroy",
           on_reboot  =&gt; "restart",
           on_crash   =&gt; "restart",
           storage    =&gt; [
             {  type  =&gt; "file",
               size  =&gt; "10G",
               device =&gt; "disk",
               driver_type =&gt; "qcow2",      # supports all formats qemu-img supports.
               file  =&gt; "/mnt/data/libvirt/images/vm01.img",
               dev   =&gt; "vda",
               bus   =&gt; "virtio",
               address =&gt; {
                 type    =&gt; "pci",
                 domain  =&gt; "0x0000",
                 bus    =&gt; "0x00",
                 slot    =&gt; "0x05",
                 function =&gt; "0x0",
               },
             },
             {  type    =&gt; "file",
               device  =&gt; "cdrom",
               file    =&gt; "/mnt/data/iso/debian-6.0.2.1-amd64-netinst.iso",
               dev    =&gt; "hdc",
               bus    =&gt; "ide",
               readonly =&gt; 1,
               address  =&gt; {
                 type     =&gt; "drive",
                 controller =&gt; 0,
                 bus      =&gt; 1,
                 unit     =&gt; 0,
               },
             },
           ],
           network =&gt; [
             {  type   =&gt; "bridge",
               bridge  =&gt; "virbr0",
               model  =&gt; "virtio",
               address =&gt; {
                 type    =&gt; "pci",
                 domain  =&gt; "0x0000",
                 bus    =&gt; "0x00",
                 slot    =&gt; "0x03",
                 function =&gt; "0x0",
               },
             },
           ],
           serial_devices =&gt; [
             {
               type =&gt; 'tcp',
               host =&gt; '127.0.0.1',
               port =&gt; 12345,
             },
           ];

       Create a (Xen/HVM) VM named "vm01" with 512 MB ram and 1 cpu. One harddrive, cloned from an existing one.

        vm create =&gt; "vm01",
           type  =&gt; "hvm",
           storage    =&gt; [
             {
               file    =&gt; "/mnt/data/libvirt/images/vm01.img",
               template =&gt; "/mnt/data/libvirt/images/svn01.img",
             },
           ];

       This is the same as above, but with all options in use.

        vm create =&gt; "vm01",
           memory =&gt; 512*1024,
           cpus  =&gt; 1,
           boot  =&gt; "hd",
           clock  =&gt; "utc",
           on_poweroff =&gt; "destroy",
           on_reboot  =&gt; "restart",
           on_crash   =&gt; "restart",
           storage    =&gt; [
             {  type  =&gt; "file",
               size  =&gt; "10G",
               device =&gt; "disk",
               file  =&gt; "/mnt/data/libvirt/images/vm01.img",
               dev   =&gt; "hda",
               bus   =&gt; "ide",
               template =&gt; "/mnt/data/libvirt/images/svn01.img",
             },
             {  type    =&gt; "file",
               device  =&gt; "cdrom",
               dev    =&gt; "hdc",
               bus    =&gt; "ide",
               readonly =&gt; 1,
             },
           ],
           network =&gt; [
             {  type   =&gt; "bridge",
               bridge  =&gt; "virbr0",
             },
           ],
           type =&gt; "hvm";

       Create a (Xen/PVM) VM named "vm01" with 512 MB ram and 1 cpu. With one root partition (10GB in size) and
       one swap parition (1GB in size).

        vm create =&gt; "vm01",
           type  =&gt; "pvm",
           storage    =&gt; [
             {
               file   =&gt; "/mnt/data/libvirt/images/domains/vm01/disk.img",
               dev    =&gt; "xvda2",
               is_root =&gt; 1,
             },
             {
               file  =&gt; "/mnt/data/libvirt/images/domains/vm01/swap.img",
               dev   =&gt; "xvda1",
             },
           ];

       This is the same as above, but with all options in use.

        vm create =&gt; "vm01",
           type  =&gt; "pvm",
           memory =&gt; 512*1024,
           cpus  =&gt; 1,
           clock  =&gt; "utc",
           on_poweroff =&gt; "destroy",
           on_reboot  =&gt; "restart",
           on_crash   =&gt; "restart",
           os       =&gt; {
             type  =&gt; "linux",
             kernel =&gt; "/boot/vmlinuz-2.6.32-5-xen-amd64",
             initrd =&gt; "/boot/initrd.img-2.6.32-5-xen-amd64",
             cmdline =&gt; "root=/dev/xvda2 ro",
           },
           storage    =&gt; [
             {  type  =&gt; "file",
               size  =&gt; "10G",
               device =&gt; "disk",
               file  =&gt; "/mnt/data/libvirt/images/domains/vm01/disk.img",
               dev   =&gt; "xvda2",
               bus   =&gt; "xen",
               aio   =&gt; 1, # if you want to use aio
             },
             {  type  =&gt; "file",
               size  =&gt; "4G",
               device =&gt; "disk",
               file  =&gt; "/mnt/data/libvirt/images/domains/vm01/swap.img",
               dev   =&gt; "xvda1",
               bus   =&gt; "xen",
               aio   =&gt; 1, # if you want to use aio
             },
           ],
           network =&gt; [
             {  type   =&gt; "bridge",
               bridge  =&gt; "virbr0",
             },
           ];

   <b>Start/Stop/Destroy</b>
       Start a stopped vm

        vm start =&gt; "name";

       Stop a running vm (send shutdown signal)

        vm shutdown =&gt; "name";

       Hard Stop a running vm

        vm destroy =&gt; "name";

   <b>Delete</b>
        vm delete =&gt; "name";

   <b>Modifying</b> <b>a</b> <b>VM</b>
       Currently you can only modify the memory.

        vm option =&gt; "name",
             max_memory =&gt; 1024*1024, # in bytes
             memory    =&gt; 512*1024;

   <b>Request</b> <b>information</b> <b>of</b> <b>a</b> <b>vm</b>
        vm info =&gt; "name";

   <b>Request</b> <b>info</b> <b>from</b> <b>the</b> <b>underlying</b> <b>hypervisor</b>
        vm hypervisor =&gt; "capabilities";

perl v5.40.0                                       2025-02-06                 <u>Rex::Commands::<a href="../man3pm/Virtualization.3pm.html">Virtualization</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>