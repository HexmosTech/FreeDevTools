<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test::Valgrind - Generate suppressions, analyse and test any command with valgrind.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtest-valgrind-perl">libtest-valgrind-perl_1.19-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Test::Valgrind - Generate suppressions, analyse and test any command with valgrind.

</pre><h4><b>VERSION</b></h4><pre>
       Version 1.19

</pre><h4><b>SYNOPSIS</b></h4><pre>
           # From the command-line
           perl -MTest::Valgrind leaky.pl

           # From the command-line, snippet style
           perl -MTest::Valgrind -e 'leaky()'

           # In a test file
           use Test::More;
           eval 'use Test::Valgrind';
           plan skip_all =&gt; 'Test::Valgrind is required to test your distribution with valgrind' if $@;
           leaky();

           # In all the test files of a directory
           prove --exec 'perl -Iblib/lib -Iblib/arch -MTest::Valgrind' t/*.t

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module is a front-end to the "Test::Valgrind::*" API that lets you run Perl code through the
       "memcheck" tool of the "valgrind" memory debugger, to test for memory errors and leaks.  If they aren't
       available yet, it will first generate suppressions for the current "perl" interpreter and store them in
       the portable flavour of <u><a href="file:~/.perl/Test-Valgrind/suppressions/">~/.perl/Test-Valgrind/suppressions/</a>$VERSION</u>.  The actual run will then take
       place, and tests will be passed or failed according to the result of the analysis.

       The complete API is much more versatile than this.  By declaring an appropriate Test::Valgrind::Command
       class, you can run any executable (that is, not only Perl scripts) under valgrind, generate the
       corresponding suppressions on-the-fly and convert the analysis result to TAP output so that it can be
       incorporated into your project's testsuite.  If you're not interested in producing TAP, you can output
       the results in whatever format you like (for example HTML pages) by defining your own
       Test::Valgrind::Action class.

       Due to the nature of perl's memory allocator, this module can't track leaks of Perl objects.  This
       includes non-mortalized scalars and memory cycles.  However, it can track leaks of chunks of memory
       allocated in XS extensions with "Newx" and friends or "malloc".  As such, it's complementary to the other
       very good leak detectors listed in the "SEE ALSO" section.

</pre><h4><b>METHODS</b></h4><pre>
   <b>"analyse"</b>
           Test::Valgrind-&gt;analyse(%options);

       Run a "valgrind" analysis configured by %options :

       •   "command =&gt; $command"

           The Test::Valgrind::Command object (or class name) to use.

           Defaults to Test::Valgrind::Command::PerlScript.

       •   "tool =&gt; $tool"

           The Test::Valgrind::Tool object (or class name) to use.

           Defaults to Test::Valgrind::Tool::memcheck.

       •   "action =&gt; $action"

           The Test::Valgrind::Action object (or class name) to use.

           Defaults to Test::Valgrind::Action::Test.

       •   "file =&gt; $file"

           The file name of the script to analyse.

           Ignored if you supply your own custom "command", but mandatory otherwise.

       •   "callers =&gt; $number"

           Specify  the  maximum  stack  depth  studied  when valgrind encounters an error.  Raising this number
           improves granularity.

           Ignored if you supply your own custom "tool", otherwise  defaults  to  24  (the  maximum  allowed  by
           "valgrind").

       •   "diag =&gt; $bool"

           If true, print the output of the test script as diagnostics.

           Ignored if you supply your own custom "action", otherwise defaults to false.

       •   "regen_def_supp =&gt; $bool"

           If true, forcefully regenerate the default suppression file.

           Defaults to false.

       •   "no_def_supp =&gt; $bool"

           If true, do not use the default suppression file.

           Defaults to false.

       •   "allow_no_supp =&gt; $bool"

           If  true, force running the analysis even if the suppression files do not refer to any "perl"-related
           symbol.

           Defaults to false.

       •   "extra_supps =&gt; \@files"

           Also use suppressions from @files besides "perl"'s.

           Defaults to empty.

   <b>"import"</b>
           use Test::Valgrind %options;

       In the parent process, "import" calls "analyse" with the arguments it received itself - except that if no
       "file" option was supplied, it tries to pick the first caller context that looks like a script.  When the
       analysis ends, it exits with the status returned by the action (for  the  default  TAP-generator  action,
       it's the number of failed tests).

       In the child process, it just "return"s so that the calling code is actually run under "valgrind", albeit
       two side-effects :

       •   Perl::Destruct::Level is loaded and the destruction level is set to 3.

       •   Autoflush on "STDOUT" is turned on.

</pre><h4><b>VARIABLES</b></h4><pre>
   <b>$dl_unload</b>
       When  set  to true, all dynamic extensions that were loaded during the analysis will be unloaded at "END"
       time by "dl_unload_file" in DynaLoader.

       Since this obfuscates error stack traces, it's disabled by default.

</pre><h4><b>CAVEATS</b></h4><pre>
       Perl 5.8 is notorious for leaking like there's no tomorrow, so the suppressions are very likely not to be
       complete on it.  You also have a better chance to get more accurate results if your perl  is  built  with
       debugging enabled.  Using the latest "valgrind" available will also help.

       This  module is not really secure.  It's definitely not taint safe.  That shouldn't be a problem for test
       files.

       What your tests output to "STDOUT" and "STDERR" is eaten unless you pass the "diag" option, in which case
       it will be reprinted as diagnostics.

</pre><h4><b>DEPENDENCIES</b></h4><pre>
       XML::Twig, File::HomeDir, Env::Sanctify, Perl::Destruct::Level.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       All   the   "Test::Valgrind::*"    API,    including    Test::Valgrind::Command,    Test::Valgrind::Tool,
       Test::Valgrind::Action and Test::Valgrind::Session.

       The <a href="../man1/valgrind.1.html">valgrind</a>(1) man page.

       Test::LeakTrace.

       Devel::Leak, Devel::LeakTrace, Devel::LeakTrace::Fast.

</pre><h4><b>AUTHOR</b></h4><pre>
       Vincent Pit, "&lt;perl at profvince.com&gt;", &lt;<a href="http://www.profvince.com">http://www.profvince.com</a>&gt;.

       You can contact me by mail or on "irc.perl.org" (vincent).

</pre><h4><b>BUGS</b></h4><pre>
       Please  report  any  bugs  or  feature requests to "bug-test-valgrind at rt.cpan.org", or through the web
       interface at &lt;<a href="http://rt.cpan.org/NoAuth/ReportBug.html">http://rt.cpan.org/NoAuth/ReportBug.html</a>?Queue=Test-Valgrind&gt;.  I  will  be  notified,  and
       then you'll automatically be notified of progress on your bug as I make changes.

</pre><h4><b>SUPPORT</b></h4><pre>
       You can find documentation for this module with the perldoc command.

           perldoc Test::Valgrind

</pre><h4><b>ACKNOWLEDGEMENTS</b></h4><pre>
       Rafaël  Garcia-Suarez,  for  writing  and  instructing  me  about  the existence of Perl::Destruct::Level
       (Elizabeth Mattijsen is a close second).

       H.Merijn Brand, for daring to test this thing.

       David Cantrell, for providing shell access to one of his smokers where the tests were failing.

       The Debian-perl team, for offering all the feedback they could regarding the build issues they met.

       All you people that showed interest in this module, which motivated me into completely rewriting it.

</pre><h4><b>COPYRIGHT</b> <b>&amp;</b> <b>LICENSE</b></h4><pre>
       Copyright 2008,2009,2010,2011,2013,2015,2016 Vincent Pit, all rights reserved.

       This program is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself.

perl v5.40.1                                       2025-04-13                                <u>Test::<a href="../man3pm/Valgrind.3pm.html">Valgrind</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>