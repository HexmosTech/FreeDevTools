<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-posix-dev">manpages-posix-dev_2017a-2_all</a> <br><br><pre>
</pre><h4><b>PROLOG</b></h4><pre>
       This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface
       may differ (consult the corresponding Linux manual page for details of Linux behavior), or the  interface
       may not be implemented on Linux.

</pre><h4><b>NAME</b></h4><pre>
       dup, dup2 — duplicate an open file descriptor

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;

       int dup(int <u>fildes</u>);
       int dup2(int <u>fildes</u>, int <u>fildes2</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <u>dup</u>() function provides an alternative interface to the service provided by <u>fcntl</u>() using the F_DUPFD
       command. The call <u>dup</u>(<u>fildes</u>) shall be equivalent to:

           fcntl(fildes, F_DUPFD, 0);

       The <u>dup2</u>() function shall cause the file descriptor <u>fildes2</u> to refer to the same open file description as
       the  file  descriptor  <u>fildes</u>  and to share any locks, and shall return <u>fildes2</u>.  If <u>fildes2</u> is already a
       valid open file descriptor, it shall be closed first, unless <u>fildes</u> is equal to  <u>fildes2</u>  in  which  case
       <u>dup2</u>()  shall  return  <u>fildes2</u>  without closing it. If the close operation fails to close <u>fildes2</u>, <u>dup2</u>()
       shall return -1 without changing the open file description to which <u>fildes2</u> refers. If <u>fildes</u>  is  not  a
       valid  file descriptor, <u>dup2</u>() shall return -1 and shall not close <u>fildes2</u>.  If <u>fildes2</u> is less than 0 or
       greater than or equal to {OPEN_MAX}, <u>dup2</u>() shall return -1 with <u>errno</u> set to <b>[EBADF]</b>.

       Upon successful completion, if <u>fildes</u> is not equal  to  <u>fildes2</u>,  the  FD_CLOEXEC  flag  associated  with
       <u>fildes2</u>  shall  be  cleared.  If  <u>fildes</u> is equal to <u>fildes2</u>, the FD_CLOEXEC flag associated with <u>fildes2</u>
       shall not be changed.

       If <u>fildes</u> refers to a typed memory object, the result of the <u>dup2</u>() function is unspecified.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Upon successful completion a non-negative  integer,  namely  the  file  descriptor,  shall  be  returned;
       otherwise, -1 shall be returned and <u>errno</u> set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       The <u>dup</u>() function shall fail if:

       <b>EBADF</b>  The <u>fildes</u> argument is not a valid open file descriptor.

       <b>EMFILE</b> All file descriptors available to the process are currently open.

       The <u>dup2</u>() function shall fail if:

       <b>EBADF</b>  The  <u>fildes</u>  argument  is  not a valid open file descriptor or the argument <u>fildes2</u> is negative or
              greater than or equal to {OPEN_MAX}.

       <b>EINTR</b>  The <u>dup2</u>() function was interrupted by a signal.

       The <u>dup2</u>() function may fail if:

       <b>EIO</b>    An I/O error occurred while attempting to close <u>fildes2</u>.

       <u>The</u> <u>following</u> <u>sections</u> <u>are</u> <u>informative.</u>

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Redirecting</b> <b>Standard</b> <b>Output</b> <b>to</b> <b>a</b> <b>File</b> <b>S</b>
       The following example closes standard output for the current processes, re-assigns standard output to  go
       to the file referenced by <u>pfd</u>, and closes the original file descriptor to clean up.

           #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;
           ...
           int pfd;
           ...
           <a href="../man1/close.1.html">close</a>(1);
           dup(pfd);
           close(pfd);
           ...

   <b>Redirecting</b> <b>Error</b> <b>Messages</b>
       The following example redirects messages from <u>stderr</u> to <u>stdout</u>.

           #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;
           ...
           dup2(1, 2);
           ...

</pre><h4><b>APPLICATION</b> <b>USAGE</b></h4><pre>
       Implementations  may  use  file  descriptors  that  must  be inherited into child processes for the child
       process to remain conforming, such as for message catalog or tracing purposes. Therefore, an  application
       that  calls  <u>dup2</u>()  with  an arbitrary integer for <u>fildes2</u> risks non-conforming behavior, and <u>dup2</u>() can
       only portably be used to overwrite file descriptor values  that  the  application  has  obtained  through
       explicit  actions, or for the three file descriptors corresponding to the standard file streams. In order
       to avoid a race condition of leaking an unintended file descriptor into a child process,  an  application
       should  consider  opening  all file descriptors with the FD_CLOEXEC bit set unless the file descriptor is
       intended to be inherited across <u>exec</u>.

</pre><h4><b>RATIONALE</b></h4><pre>
       The <u>dup</u>() function is redundant. Its services are also provided by the  <u>fcntl</u>()  function.  It  has  been
       included  in  this  volume  of  POSIX.1‐2017  primarily  for  historical  reasons,  since  many  existing
       applications use it. On the other hand, the  <u>dup2</u>()  function  provides  unique  services,  as  no  other
       interface is able to atomically replace an existing file descriptor.

       The  <u>dup2</u>()  function  is not marked obsolescent because it presents a type-safe version of functionality
       provided in a type-unsafe version by <u>fcntl</u>().  It is used in the POSIX Ada binding.

       The <u>dup2</u>() function is not intended for use in critical regions as a synchronization mechanism.

       In the description of <b>[EBADF]</b>, the case of <u>fildes</u> being out of range is covered  by  the  given  case  of
       <u>fildes</u>  not  being  valid. The descriptions for <u>fildes</u> and <u>fildes2</u> are different because the only kind of
       invalidity that is relevant for <u>fildes2</u> is whether it is out of  range;  that  is,  it  does  not  matter
       whether <u>fildes2</u> refers to an open file when the <u>dup2</u>() call is made.

</pre><h4><b>FUTURE</b> <b>DIRECTIONS</b></h4><pre>
       None.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>close</u>(), <u>fcntl</u>(), <u>open</u>()

       The Base Definitions volume of POSIX.1‐2017, <b>&lt;unistd.h&gt;</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1-2017, Standard
       for  Information  Technology  --  Portable  Operating  System  Interface  (POSIX),  The  Open  Group Base
       Specifications Issue 7, 2018 Edition, Copyright (C) 2018 by the Institute of Electrical  and  Electronics
       Engineers, Inc and The Open Group.  In the event of any discrepancy between this version and the original
       IEEE  and The Open Group Standard, the original IEEE and The Open Group Standard is the referee document.
       The original Standard can be obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any typographical or formatting errors that appear in this page are most likely to have  been  introduced
       during   the   conversion  of  the  source  files  to  man  page  format.  To  report  such  errors,  see
       https://www.kernel.org/doc/man-pages/reporting_bugs.html .

IEEE/The Open Group                                   2017                                           <u><a href="../man3POSIX/DUP.3POSIX.html">DUP</a></u>(3POSIX)
</pre>
 </div>
</div></section>
</div>
</body>
</html>