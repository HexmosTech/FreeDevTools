<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aes - Implementation of the AES block cipher</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       aes - Implementation of the AES block cipher

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>aes</b> <b>?1.2.2?</b>

       <b>::aes::aes</b>  ?<u>-mode</u>  <u>[ecb|cbc]</u>?  ?<u>-dir</u>  <u>[encrypt|decrypt]</u>? <u>-key</u> <u>keydata</u> ?<u>-iv</u> <u>vector</u>? ?<u>-hex</u>? ?<u>-out</u> <u>channel</u>?
       ?<u>-chunksize</u> <u>size</u>? [ <u>-in</u> <u>channel</u> | ?<b>--</b>? <u>data</u> ]

       <b>::aes::Init</b> <u>mode</u> <u>keydata</u> <u>iv</u>

       <b>::aes::Encrypt</b> <u>Key</u> <u>data</u>

       <b>::aes::Decrypt</b> <u>Key</u> <u>data</u>

       <b>::aes::Reset</b> <u>Key</u> <u>iv</u>

       <b>::aes::Final</b> <u>Key</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This is an implementation in Tcl of the Advanced Encryption Standard  (AES)  as  published  by  the  U.S.
       National  Institute  of  Standards  and Technology [1]. AES is a 128-bit block cipher with a variable key
       size of 128, 192 or 256 bits. This implementation supports ECB and CBC modes.

</pre><h4><b>COMMANDS</b></h4><pre>
       <b>::aes::aes</b> ?<u>-mode</u> <u>[ecb|cbc]</u>? ?<u>-dir</u> <u>[encrypt|decrypt]</u>? <u>-key</u> <u>keydata</u> ?<u>-iv</u> <u>vector</u>? ?<u>-hex</u>? ?<u>-out</u> <u>channel</u>?
       ?<u>-chunksize</u> <u>size</u>? [ <u>-in</u> <u>channel</u> | ?<b>--</b>? <u>data</u> ]
              Perform the <b>aes</b> algorithm on either the data provided by the argument or on the data read from the
              <u>-in</u> channel. If an <u>-out</u> channel is given then the result will be written to this channel.

              The <u>-key</u> option must be given. This parameter takes a binary string of either 16, 24 or  32  bytes
              in length and is used to generate the key schedule.

              The  <u>-mode</u>  and  <u>-dir</u>  options  are optional and default to cbc mode and encrypt respectively. The
              initialization vector <u>-iv</u> takes a 16 byte binary argument which defaults to all zeros.  See  <b>MODES</b>
              <b>OF</b> <b>OPERATION</b> for more about available modes and their uses.

              AES  is  a  128-bit  block  cipher.  This means that the data must be provided in units that are a
              multiple of 16 bytes.

</pre><h4><b>PROGRAMMING</b> <b>INTERFACE</b></h4><pre>
       Internal state is maintained in an opaque structure that is returned from the <b>Init</b> function. In ECB  mode
       the  state is not affected by the input but for CBC mode some input dependent state is maintained and may
       be reset by calling the <b>Reset</b> function with a new initialization vector value.

       <b>::aes::Init</b> <u>mode</u> <u>keydata</u> <u>iv</u>
              Construct a new AES key schedule using the specified key data and the given initialization vector.
              The initialization vector is not used with ECB mode but is important for CBC mode.  See  <b>MODES</b>  <b>OF</b>
              <b>OPERATION</b> for details about cipher modes.

       <b>::aes::Encrypt</b> <u>Key</u> <u>data</u>
              Use a prepared key acquired by calling <b>Init</b> to encrypt the provided data. The data argument should
              be  a  binary  array  that is a multiple of the AES block size of 16 bytes. The result is a binary
              array the same size as the input of encrypted data.

       <b>::aes::Decrypt</b> <u>Key</u> <u>data</u>
              Decipher data using the key. Note that the same key may  be  used  to  encrypt  and  decrypt  data
              provided that the initialization vector is reset appropriately for CBC mode.

       <b>::aes::Reset</b> <u>Key</u> <u>iv</u>
              Reset the initialization vector. This permits the programmer to re-use a key and avoid the cost of
              re-generating the key schedule where the same key data is being used multiple times.

       <b>::aes::Final</b> <u>Key</u>
              This  should  be  called  to  clean up resources associated with <u>Key</u>.  Once this function has been
              called the key may not be used again.

</pre><h4><b>MODES</b> <b>OF</b> <b>OPERATION</b></h4><pre>
       Electronic Code Book (ECB)
              ECB is the basic mode of all block ciphers. Each block is encrypted independently and so identical
              plain text will produce identical output when encrypted with the same key. Any  encryption  errors
              will only affect a single block however this is vulnerable to known plaintext attacks.

       Cipher Block Chaining (CBC)
              CBC  mode  uses  the  output  of  the  last  block  encryption  to  affect  the  current block. An
              initialization vector of the same size as the cipher block size is used to handle the first block.
              The initialization vector should be chosen randomly and transmitted as  the  first  block  of  the
              output.  Errors  in  encryption affect the current block and the next block after which the cipher
              will correct itself. CBC is the most commonly used  mode  in  software  encryption.  This  is  the
              default mode of operation for this module.

</pre><h4><b>EXAMPLES</b></h4><pre>
              % set nil_block [string repeat \\0 16]
              % aes::aes -hex -mode cbc -dir encrypt -key $nil_block $nil_block
              66e94bd4ef8a2c3b884cfa59ca342b2e

              set Key [aes::Init cbc $sixteen_bytes_key_data $sixteen_byte_iv]
              append ciphertext [aes::Encrypt $Key $plaintext]
              append ciphertext [aes::Encrypt $Key $additional_plaintext]
              aes::Final $Key

</pre><h4><b>REFERENCES</b></h4><pre>
       [1]    "Advanced  Encryption  Standard",  Federal  Information Processing Standards Publication 197, 2001
              (<u><a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf</a></u>)

</pre><h4><b>AUTHORS</b></h4><pre>
       Thorsten Schloermann, Pat Thoyts

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This document, and the package it describes, will undoubtedly contain bugs and  other  problems.   Please
       report  such  in  the category <u>aes</u> of the <u>Tcllib</u> <u>Trackers</u> [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].  Please
       also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note further that <u>attachments</u> are strongly preferred over inlined patches. Attachments  can  be  made  by
       going  to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most button
       in the secondary navigation bar.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/blowfish.3tcl.html">blowfish</a>(3tcl), <a href="../man3tcl/des.3tcl.html">des</a>(3tcl), <a href="../man3tcl/md5.3tcl.html">md5</a>(3tcl), <a href="../man3tcl/sha1.3tcl.html">sha1</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       aes, block cipher, data integrity, encryption, security

</pre><h4><b>CATEGORY</b></h4><pre>
       Hashes, checksums, and encryption

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2005, Pat Thoyts &lt;<a href="mailto:patthoyts@users.sourceforge.net">patthoyts@users.sourceforge.net</a>&gt;
       Copyright (c) 2012-2014, Andreas Kupries &lt;<a href="mailto:andreas_kupries@users.sourceforge.net">andreas_kupries@users.sourceforge.net</a>&gt;

tcllib                                                1.2.2                                            <u><a href="../man3tcl/aes.3tcl.html">aes</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>