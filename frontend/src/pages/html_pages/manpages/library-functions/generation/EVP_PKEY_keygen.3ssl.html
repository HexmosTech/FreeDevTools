<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_PKEY_Q_keygen, EVP_PKEY_keygen_init, EVP_PKEY_paramgen_init, EVP_PKEY_generate, EVP_PKEY_CTX_set_cb,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_PKEY_Q_keygen, EVP_PKEY_keygen_init, EVP_PKEY_paramgen_init, EVP_PKEY_generate, EVP_PKEY_CTX_set_cb,
       EVP_PKEY_CTX_get_cb, EVP_PKEY_CTX_get_keygen_info, EVP_PKEY_CTX_set_app_data, EVP_PKEY_CTX_get_app_data,
       EVP_PKEY_gen_cb, EVP_PKEY_paramgen, EVP_PKEY_keygen - key and parameter generation and check functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/evp.h&gt;

        EVP_PKEY *EVP_PKEY_Q_keygen(OSSL_LIB_CTX *libctx, const char *propq,
                                    const char *type, ...);

        int EVP_PKEY_keygen_init(EVP_PKEY_CTX *ctx);
        int EVP_PKEY_paramgen_init(EVP_PKEY_CTX *ctx);
        int EVP_PKEY_generate(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey);
        int EVP_PKEY_paramgen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey);
        int EVP_PKEY_keygen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey);

        typedef int EVP_PKEY_gen_cb(EVP_PKEY_CTX *ctx);

        void EVP_PKEY_CTX_set_cb(EVP_PKEY_CTX *ctx, EVP_PKEY_gen_cb *cb);
        EVP_PKEY_gen_cb *EVP_PKEY_CTX_get_cb(EVP_PKEY_CTX *ctx);

        int EVP_PKEY_CTX_get_keygen_info(EVP_PKEY_CTX *ctx, int idx);

        void EVP_PKEY_CTX_set_app_data(EVP_PKEY_CTX *ctx, void *data);
        void *EVP_PKEY_CTX_get_app_data(EVP_PKEY_CTX *ctx);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Generating keys is sometimes straight forward, just generate the key's numbers and be done with it.
       However, there are certain key types that need key parameters, often called domain parameters but not
       necessarily limited to that, that also need to be generated.  In addition to this, the caller may want to
       set user provided generation parameters that further affect key parameter or key generation, such as the
       desired key size.

       To flexibly allow all that's just been described, key parameter and key generation is divided into an
       initialization of a key algorithm context, functions to set user provided parameters, and finally the key
       parameter or key generation function itself.

       The key algorithm context must be created using <b><a href="../man3/EVP_PKEY_CTX_new.3.html">EVP_PKEY_CTX_new</a></b>(3) or variants thereof, see that manual
       for details.

       <b>EVP_PKEY_keygen_init()</b> initializes a public key algorithm context <u>ctx</u> for a key generation operation.

       <b>EVP_PKEY_paramgen_init()</b> is similar to <b>EVP_PKEY_keygen_init()</b> except key parameters are generated.

       After initialization, generation parameters may be provided with <b><a href="../man3/EVP_PKEY_CTX_ctrl.3.html">EVP_PKEY_CTX_ctrl</a></b>(3) or
       <b><a href="../man3/EVP_PKEY_CTX_set_params.3.html">EVP_PKEY_CTX_set_params</a></b>(3), or any other function described in those manuals.

       <b>EVP_PKEY_generate()</b> performs the generation operation, the resulting key parameters or key are written to
       <u>*ppkey</u>.  If <u>*ppkey</u> is NULL when this function is called, it will be allocated, and should be freed by the
       caller when no longer useful, using <b><a href="../man3/EVP_PKEY_free.3.html">EVP_PKEY_free</a></b>(3).

       <b>EVP_PKEY_paramgen()</b> and <b>EVP_PKEY_keygen()</b> do exactly the same thing as <b>EVP_PKEY_generate()</b>, after
       checking that the corresponding <b>EVP_PKEY_paramgen_init()</b> or <b>EVP_PKEY_keygen_init()</b> was used to initialize
       <u>ctx</u>.  These are older functions that are kept for backward compatibility.  It is safe to use
       <b>EVP_PKEY_generate()</b> instead.

       The function <b>EVP_PKEY_set_cb()</b> sets the key or parameter generation callback to <u>cb</u>. The function
       <b>EVP_PKEY_CTX_get_cb()</b> returns the key or parameter generation callback.

       The function <b>EVP_PKEY_CTX_get_keygen_info()</b> returns parameters associated with the generation operation.
       If <u>idx</u> is -1 the total number of parameters available is returned. Any non negative value returns the
       value of that parameter. <b>EVP_PKEY_CTX_gen_keygen_info()</b> with a nonnegative value for <u>idx</u> should only be
       called within the generation callback.

       If the callback returns 0 then the key generation operation is aborted and an error occurs. This might
       occur during a time consuming operation where a user clicks on a "cancel" button.

       The functions <b>EVP_PKEY_CTX_set_app_data()</b> and <b>EVP_PKEY_CTX_get_app_data()</b> set and retrieve an opaque
       pointer. This can be used to set some application defined value which can be retrieved in the callback:
       for example a handle which is used to update a "progress dialog".

       <b>EVP_PKEY_Q_keygen()</b> abstracts from the explicit use of <b>EVP_PKEY_CTX</b> while providing a 'quick' but limited
       way of generating a new asymmetric key pair.  It provides shorthands for simple and common cases of key
       generation.  As usual, the library context <u>libctx</u> and property query <u>propq</u> can be given for fetching
       algorithms from providers.  If <u>type</u> is "RSA", a <b>size_t</b> parameter must be given to specify the size of the
       RSA key.  If <u>type</u> is "EC", a string parameter must be given to specify the name of the EC curve.  If <u>type</u>
       is: "ED25519", "ED448", "SM2", "X25519", "X448", "ML-DSA-44", "ML-DSA-65", "ML-DSA-87", "ML-KEM-512",
       "ML-KEM-768", or "ML-KEM-1024" no further parameters are needed. Other key types may be possible if they
       are supplied by the loaded providers. <b>EVP_PKEY_Q_keygen()</b> may be usable with such key types as long as
       they do not require further parameters.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>EVP_PKEY_keygen_init()</b>, <b>EVP_PKEY_paramgen_init()</b>, <b>EVP_PKEY_keygen()</b> and <b>EVP_PKEY_paramgen()</b> return 1 for
       success and 0 or a negative value for failure.  In particular a return value of -2 indicates the
       operation is not supported by the public key algorithm.

       <b>EVP_PKEY_Q_keygen()</b> returns an <b>EVP_PKEY</b>, or NULL on failure.

</pre><h4><b>NOTES</b></h4><pre>
       After the call to <b>EVP_PKEY_keygen_init()</b> or <b>EVP_PKEY_paramgen_init()</b> algorithm specific control
       operations can be performed to set any appropriate parameters for the operation.

       The functions <b>EVP_PKEY_keygen()</b> and <b>EVP_PKEY_paramgen()</b> can be called more than once on the same context
       if several operations are performed using the same parameters.

       The meaning of the parameters passed to the callback will depend on the algorithm and the specific
       implementation of the algorithm. Some might not give any useful information at all during key or
       parameter generation. Others might not even call the callback.

       The operation performed by key or parameter generation depends on the algorithm used. In some cases (e.g.
       EC with a supplied named curve) the "generation" option merely sets the appropriate fields in an EVP_PKEY
       structure.

       In OpenSSL an EVP_PKEY structure containing a private key also contains the public key components and
       parameters (if any). An OpenSSL private key is equivalent to what some libraries call a "key pair". A
       private key can be used in functions which require the use of a public key or parameters.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Generate a 2048 bit RSA key:

        #include &lt;openssl/evp.h&gt;
        #include &lt;openssl/rsa.h&gt;

        EVP_PKEY_CTX *ctx;
        EVP_PKEY *pkey = NULL;

        ctx = EVP_PKEY_CTX_new_id(EVP_PKEY_RSA, NULL);
        if (!ctx)
            /* Error occurred */
        if (EVP_PKEY_keygen_init(ctx) &lt;= 0)
            /* Error */
        if (EVP_PKEY_CTX_set_rsa_keygen_bits(ctx, 2048) &lt;= 0)
            /* Error */

        /* Generate key */
        if (EVP_PKEY_keygen(ctx, &amp;pkey) &lt;= 0)
            /* Error */

       Generate a key from a set of parameters:

        #include &lt;openssl/evp.h&gt;
        #include &lt;openssl/rsa.h&gt;

        EVP_PKEY_CTX *ctx;
        ENGINE *eng;
        EVP_PKEY *pkey = NULL, *param;

        /* Assumed param, eng are set up already */
        ctx = EVP_PKEY_CTX_new(param, eng);
        if (!ctx)
            /* Error occurred */
        if (EVP_PKEY_keygen_init(ctx) &lt;= 0)
            /* Error */

        /* Generate key */
        if (EVP_PKEY_keygen(ctx, &amp;pkey) &lt;= 0)
            /* Error */

       Example of generation callback for OpenSSL public key implementations:

        /* Application data is a BIO to output status to */

        EVP_PKEY_CTX_set_app_data(ctx, status_bio);

        static int genpkey_cb(EVP_PKEY_CTX *ctx)
        {
            char c = '*';
            BIO *b = EVP_PKEY_CTX_get_app_data(ctx);
            int p = EVP_PKEY_CTX_get_keygen_info(ctx, 0);

            if (p == 0)
                c = '.';
            if (p == 1)
                c = '+';
            if (p == 2)
                c = '*';
            if (p == 3)
                c = '\n';
            BIO_write(b, &amp;c, 1);
            (void)BIO_flush(b);
            return 1;
        }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_RSA_gen.3.html">EVP_RSA_gen</a></b>(3), <b><a href="../man3/EVP_EC_gen.3.html">EVP_EC_gen</a></b>(3), <b><a href="../man3/EVP_PKEY_CTX_new.3.html">EVP_PKEY_CTX_new</a></b>(3), <b><a href="../man3/EVP_PKEY_encrypt.3.html">EVP_PKEY_encrypt</a></b>(3), <b><a href="../man3/EVP_PKEY_decrypt.3.html">EVP_PKEY_decrypt</a></b>(3),
       <b><a href="../man3/EVP_PKEY_sign.3.html">EVP_PKEY_sign</a></b>(3), <b><a href="../man3/EVP_PKEY_verify.3.html">EVP_PKEY_verify</a></b>(3), <b><a href="../man3/EVP_PKEY_verify_recover.3.html">EVP_PKEY_verify_recover</a></b>(3), <b><a href="../man3/EVP_PKEY_derive.3.html">EVP_PKEY_derive</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>EVP_PKEY_keygen_init()</b>, int <b>EVP_PKEY_paramgen_init()</b>, <b>EVP_PKEY_keygen()</b>, <b>EVP_PKEY_paramgen()</b>,
       <b>EVP_PKEY_gen_cb()</b>, <b>EVP_PKEY_CTX_set_cb()</b>, <b>EVP_PKEY_CTX_get_cb()</b>, <b>EVP_PKEY_CTX_get_keygen_info()</b>,
       <b>EVP_PKEY_CTX_set_app_data()</b> and <b>EVP_PKEY_CTX_get_app_data()</b> were added in OpenSSL 1.0.0.

       <b>EVP_PKEY_Q_keygen()</b> and <b>EVP_PKEY_generate()</b> were added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2006-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                              <u><a href="../man3SSL/EVP_PKEY_KEYGEN.3SSL.html">EVP_PKEY_KEYGEN</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>