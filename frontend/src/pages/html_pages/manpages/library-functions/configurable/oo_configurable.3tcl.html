<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oo::configurable,  configure,  property - class that makes configurable classes and objects, and supports</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl9.0-doc">tcl9.0-doc_9.0.1+dfsg-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       oo::configurable,  configure,  property - class that makes configurable classes and objects, and supports
       making configurable properties

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require TclOO

       <b>oo::configurable</b> <b>create</b> <u>class</u> ?<u>definitionScript</u>?

       <b>oo::define</b> <u>class</u> <b>{</b>
           <b>property</b> <u>propName</u> ?<u>options...</u>? ?<u>propName</u> ?<u>options...</u>?...?
       <b>}</b>

       <b>oo::objdefine</b> <u>object</u> <b>{</b>
           <b>property</b> <u>propName</u> ?<u>options...</u>? ?<u>propName</u> ?<u>options...</u>?...?
       <b>}</b>

       <u>objectName</u> <b>configure</b>
       <u>objectName</u> <b>configure</b> <u>-prop</u>
       <u>objectName</u> <b>configure</b> <u>-prop</u> <u>value</u> ?<u>-prop</u> <u>value</u>...

</pre><h4><b>CLASS</b> <b>HIERARCHY</b></h4><pre>
       <b>oo::object</b>
          → <b>oo::class</b>
              → <b>oo::configurable</b>

       <b>oo::object</b>
          → <b>oo::class</b>
              → <b>oo::configurablesupport::configurable</b>
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Configurable objects are objects that support being configured with  a  <b>configure</b>  method.  Each  of  the
       configurable  entities  of  the object is known as a property of the object. Properties may be defined on
       classes or instances; when configuring an object, any of the properties defined by its classes (direct or
       indirect) or by the instance itself may be configured.

       The <b>oo::configurable</b> metaclass installs basic support for making configurable objects into a class.  This
       consists  of  making  a  <b>property</b>  definition  command  available in definition scripts for the class and
       instances (e.g., from the class's constructor, within <b>oo::define</b> and within <b>oo::objdefine</b>) and  making  a
       <b>configure</b> method available within the instances.

   <b>CONFIGURE</b> <b>METHOD</b>
       The behavior of the <b>configure</b> method is modelled after the <b>fconfigure</b>/<b>chan</b> <b>configure</b> command.

       If  passed  no  additional arguments, the <b>configure</b> method returns an alphabetically sorted dictionary of
       all <u>readable</u> and <u>read-write</u> properties and their current values.

       If passed a single additional argument, that argument to the <b>configure</b> method  must  be  the  name  of  a
       property to read (or an unambiguous prefix thereof); its value is returned.

       Otherwise,  if  passed  an even number of arguments then each pair of arguments specifies a property name
       (or an unambiguous prefix thereof) and the value to set it to. The properties will be set  in  the  order
       specified,  including  duplicates.  If  the  setting  of any property fails, the overall <b>configure</b> method
       fails, the preceding pairs (if any) will continue to have been applied, and the succeeding pairs (if any)
       will be not applied. On success, the result of the <b>configure</b> method in this mode  operation  will  be  an
       empty string.

   <b>PROPERTY</b> <b>DEFINITIONS</b>
       When a class has been manufactured by the <b>oo::configurable</b> metaclass (or one of its subclasses), it gains
       an  extra  definition,  <b>property</b>.  The  <b>property</b>  definition  defines one or more properties that will be
       exposed by the class's instances.

       The <b>property</b> command takes the name of a property to define first, <u>without</u> <u>a</u> <u>leading</u> <u>hyphen</u>, followed  by
       a  number of option-value pairs that modify the basic behavior of the property. This can then be followed
       by an arbitrary number of other property definitions. The supported options are:

       <b>-get</b> <u>getterScript</u>
              This defines the implementation of how to read from the property; the <u>getterScript</u> will become the
              body of a method (taking no arguments) defined on the class, if the kind of the property  is  such
              that  the  property  can  be read from. The method will be named <b>&lt;ReadProp-</b><u>propertyName</u><b>&gt;</b>, and will
              default to being a simple read of the instance variable with the same name as the property  (e.g.,
              “<b>property</b> xyz” will result in a method “&lt;ReadProp-xyz&gt;” being created).

       <b>-kind</b> <u>propertyKind</u>
              This  defines  what  sort  of  property  is being created. The <u>propertyKind</u> must be exactly one of
              <b>readable</b>, <b>writable</b>, or <b>readwrite</b> (which is the default) which will make  the  property  read-only,
              write-only  or  read-write, respectively.  Read-only properties can only ever be read from, write-
              only properties can only ever be written to, and  read-write  properties  can  be  both  read  and
              written.

              Note  that  write-only  properties are not particularly discoverable as they are never reported by
              the <b>configure</b> method other than by error messages when attempting to write to a property that does
              not exist.

       <b>-set</b> <u>setterScript</u>
              This defines the implementation of how to write to the property; the <u>setterScript</u> will become  the
              body  of  a  method  taking  a  single  argument,  <u>value</u>, defined on the class, if the kind of the
              property is such that the property can be  written  to.  The  method  will  be  named  <b>&lt;WriteProp-</b>
              <u>propertyName</u><b>&gt;</b>,  and  will  default  to being a simple write of the instance variable with the same
              name as the property (e.g., “<b>property</b>  xyz”  will  result  in  a  method  “&lt;WriteProp-xyz&gt;”  being
              created).

       Instances  of  the class that was created by <b>oo::configurable</b> will also support <b>property</b> definitions; the
       semantics will be exactly as above except that the properties will be defined on the instance alone.

       Note that the property implementation methods that <b>property</b> defines should not be private, as this  makes
       them  inaccessible  from the implementation of <b>configure</b> (by design; the property configuration mechanism
       is intended for use mainly from outside a class, whereas a class  may  access  variables  directly).  The
       variables accessed by the default implementations of the properties <u>may</u> be private, if so declared.

</pre><h4><b>ADVANCED</b> <b>USAGE</b></h4><pre>
       The  configurable  class  system  is comprised of several pieces. The <b>oo::configurable</b> metaclass works by
       mixing in a class and setting definition namespaces during object creation that provide  the  other  bits
       and  pieces  of  machinery.  The key pieces of the implementation are enumerated here so that they can be
       used by other code:

       <b>oo::configuresupport::configurable</b>
              This is a class that provides the implementation of  the  <b>configure</b>  method  (described  above  in
              <b>CONFIGURE</b> <b>METHOD</b>).

       <b>oo::configuresupport::configurableclass</b>
              This  is  a  namespace that contains the definition dialect that provides the <b>property</b> declaration
              for use in classes (i.e., via <b>oo::define</b>, and class constructors under normal  circumstances),  as
              described  above in <b>PROPERTY</b> <b>DEFINITIONS</b>. It <b>namespace</b> <b>export</b>s its <b>property</b> command so that it may
              be used easily in user definition dialects.

       <b>oo::configuresupport::configurableobject</b>
              This is a namespace that contains the definition dialect that provides  the  <b>property</b>  declaration
              for  use in instance objects (i.e., via <b>oo::objdefine</b>, and the <b>self</b> declaration in <b>oo::define</b>), as
              described above in <b>PROPERTY</b> <b>DEFINITIONS</b>. It <b>namespace</b> <b>export</b>s its <b>property</b> command so that it  may
              be used easily in user definition dialects.

       The  underlying  property discovery mechanism relies on four slots (see <b>oo::define</b> for what that implies)
       that list the properties that can be configured. These slots do not themselves impose  any  semantics  on
       what  the  slots  mean  other  than that they have unique names, no important order, can be inherited and
       discovered on classes and instances.

       These slots, and their intended semantics, are:

       <b>oo::configuresupport::readableproperties</b>
              The set of properties of a class (not including those from its superclasses) that may be read from
              when configuring an instance of the class. This  slot  can  also  be  read  with  the  <b>info</b>  <b>class</b>
              <b>properties</b> command.

       <b>oo::configuresupport::writableproperties</b>
              The  set  of properties of a class (not including those from its superclasses) that may be written
              to when configuring an instance of the class. This slot can also  be  read  with  the  <b>info</b>  <b>class</b>
              <b>properties</b> command.

       <b>oo::configuresupport::objreadableproperties</b>
              The  set  of  properties  of an object instance (not including those from its classes) that may be
              read from when configuring the object. This slot can also be read with the <b>info</b> <b>object</b>  <b>properties</b>
              command.

       <b>oo::configuresupport::objwritableproperties</b>
              The  set  of  properties  of an object instance (not including those from its classes) that may be
              written to when configuring the object. This slot can also be read with the <b>info</b> <b>object</b> <b>properties</b>
              command.

       Note that though these are slots, they are <u>not</u> in the standard <b>oo::define</b> or <b>oo::objdefine</b> namespaces; in
       order to use them inside a definition script, they need to be referred to by full name. This  is  because
       they  are intended to be building bricks of configurable property system, and not directly used by normal
       user code.

   <b>IMPLEMENTATION</b> <b>NOTE</b>
       The implementation of the <b>configure</b> method uses <b>info</b> <b>object</b> <b>properties</b> with the <b>-all</b> option  to  discover
       what properties it may manipulate.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Here we create a simple configurable class and demonstrate how it can be configured:

              <b>oo::configurable</b> create Point {
                  <b>property</b> x y
                  constructor args {
                      my <b>configure</b> -x 0 -y 0 {*}$args
                  }
                  variable x y
                  method print {} {
                      puts "x=$x, y=$y"
                  }
              }

              set pt [Point new -x 27]
              $pt print;   <u>#</u> <u>x=27,</u> <u>y=0</u>
              $pt <b>configure</b> -y 42
              $pt print;   <u>#</u> <u>x=27,</u> <u>y=42</u>
              puts "distance from origin: [expr {
                  hypot([$pt <b>configure</b> -x], [$pt <b>configure</b> -y])
              }]";         <u>#</u> <u>distance</u> <u>from</u> <u>origin:</u> <u>49.92995093127971</u>
              puts [$pt <b>configure</b>]
                           <u>#</u> <u>-x</u> <u>27</u> <u>-y</u> <u>42</u>

       Such a configurable class can be extended by subclassing, though the subclass needs to also be created by
       <b>oo::configurable</b> if it will use the <b>property</b> definition:

              <b>oo::configurable</b> create Point3D {
                  superclass Point
                  <b>property</b> z
                  constructor args {
                      next -z 0 {*}$args
                  }
              }

              set pt2 [Point3D new -x 2 -y 3 -z 4]
              puts [$pt2 <b>configure</b>]
                           <u>#</u> <u>-x</u> <u>2</u> <u>-y</u> <u>3</u> <u>-z</u> <u>4</u>

       Once  you  have  a configurable class, you can also add instance properties to it. (The backing variables
       for all properties start unset.) Note below that we are using an unambiguous prefix of  a  property  name
       when  setting it; this is supported for all properties though full names are normally recommended because
       subclasses will not make an unambiguous prefix become ambiguous in that case.

              oo::objdefine $pt {
                  <b>property</b> color
              }
              $pt <b>configure</b> -c bisque
              puts [$pt <b>configure</b>]
                           <u>#</u> <u>-color</u> <u>bisque</u> <u>-x</u> <u>27</u> <u>-y</u> <u>42</u>

       You can also do derived properties by making them read-only and supplying a script that computes them.

              <b>oo::configurable</b> create PointMk2 {
                  <b>property</b> x y
                  <b>property</b> distance -kind readable -get {
                      return [expr {hypot($x, $y)}]
                  }
                  variable x y
                  constructor args {
                      my <b>configure</b> -x 0 -y 0 {*}$args
                  }
              }

              set pt3 [PointMk2 new -x 3 -y 4]
              puts [$pt3 <b>configure</b> -distance]
                           <u>#</u> <u>5.0</u>
              $pt3 <b>configure</b> -distance 10
                           <u>#</u> <u>ERROR:</u> <u>bad</u> <u>property</u> <u>"-distance":</u> <u>must</u> <u>be</u> <u>-x</u> <u>or</u> <u>-y</u>

       Setters are used to validate the type of a property:

              <b>oo::configurable</b> create PointMk3 {
                  <b>property</b> x -set {
                      if {![string is double -strict $value]} {
                          error "-x property must be a number"
                      }
                      set x $value
                  }
                  <b>property</b> y -set {
                      if {![string is double -strict $value]} {
                          error "-y property must be a number"
                      }
                      set y $value
                  }
                  variable x y
                  constructor args {
                      my <b>configure</b> -x 0 -y 0 {*}$args
                  }
              }

              set pt4 [PointMk3 new]
              puts [$pt4 <b>configure</b>]
                           <u>#</u> <u>-x</u> <u>0</u> <u>-y</u> <u>0</u>
              $pt4 <b>configure</b> -x 3 -y 4
              puts [$pt4 <b>configure</b>]
                           <u>#</u> <u>-x</u> <u>3</u> <u>-y</u> <u>4</u>
              $pt4 <b>configure</b> -x "obviously not a number"
                           <u>#</u> <u>ERROR:</u> <u>-x</u> <u>property</u> <u>must</u> <u>be</u> <u>a</u> <u>number</u>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/info.3tcl.html">info</a>(3tcl), oo::<a href="../man3tcl/class.3tcl.html">class</a>(3tcl), oo::<a href="../man3tcl/define.3tcl.html">define</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       class, object, properties, configuration

TclOO                                                  0.4                                    <u><a href="../man3tcl/configurable.3tcl.html">configurable</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>