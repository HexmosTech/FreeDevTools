<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tepam - An introduction into TEPAM, Tcl's Enhanced Procedure and Argument Manager</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tepam - An introduction into TEPAM, Tcl's Enhanced Procedure and Argument Manager

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  document is an informal introduction into TEPAM, the Tcl's Enhanced Procedure and Argument Manager.
       Detailed   information   to   the   TEPAM   package   is   provided   in   the    <u>tepam::procedure</u>    and
       <u>tepam::argument_dialogbox</u> reference manuals.

</pre><h4><b>OVERVIEW</b></h4><pre>
       This  package  provides  a  new  Tcl  procedure  declaration syntax that simplifies the implementation of
       procedure subcommands and the handling of the different  types  of  procedure  arguments  like  flags  or
       switches,  options, unnamed arguments, optional and mandatory options and arguments, default values, etc.
       Procedure declarations can be enriched with detailed information about the procedure and  its  arguments.
       This information is used for the following purposes:

       First  of  all, a preamble is added in front of the body of a procedure that is declared with TEPAM. This
       preamble calls an argument manager that that uses the provided information to check the validity  of  the
       argument  types  and  values  before  the  procedure  body  is executed. Then, the information is used to
       generate help and usage texts if requested, or to generate  clear  error  message  in  case  an  argument
       validation  fails.  The  information  also allows generating automatically graphical forms that allows an
       interactive definition of all arguments, in case a procedure is called interactively.  And  finally,  the
       additional information helps self-commenting in a clean way the declaration of a procedure and of all its
       arguments.

       The  graphical form generator that creates the necessary argument specification forms for the interactive
       procedure calls is also available for other purposes  than  for  procedure  argument  specifications.  It
       allows creating code efficiently complex parameter entry forms that are usable independently from TEPAM's
       new procedure definition method.

       Here is a short overview about all major TEPAM features:

       •      New  self-documenting procedure declaration syntax: The additional information to declare properly
              a procedure has not to be provided with additional statements, but  can  be  added  in  a  natural
              syntax directly into the procedure header.

       •      Easy  way  to  specify  subcommands:  A  subcommand  is  declared  like a procedure, simply with a
              procedure name composed by a base name followed by a subcommand name. Sub-subcommands are  created
              identically using simply procedure names composed by 3 words.

       •      Flexible  usage of flags (switches), options (named arguments) and unnamed arguments. Option names
              are optionally automatically completed.

       •      Support for default values, mandatory/optional options and arguments, choice lists, value  ranges,
              multiple usable options/arguments.

       •      Choice  of  a  <u>named</u> <u>arguments</u> <u>first,</u> <u>unnamed</u> <u>arguments</u> <u>later</u> procedure calling style (typical for
              Tcl commands) or of an <u>unnamed</u> <u>arguments</u> <u>first,</u> <u>named</u>  <u>arguments</u>  <u>later</u>  procedure  calling  style
              (typical for Tk commands).

       •      In  case  the  <u>named</u>  <u>arguments</u>  <u>first,</u>  <u>unnamed</u>  <u>arguments</u>  <u>later</u> style (Tcl) is selected:  Clear
              separation between options and arguments via the "--" flag. The unnamed arguments  can  optionally
              be accessed as options (named arguments).

       •      Automatic  type  and  value  check  before  the  procedure  body  is executed, taking into account
              validation ranges, choice lists and custom validation commands. Generation of clear error  message
              if necessary.

       •      Many  predefined types exist (integer, boolean, double, color, file, font, ...). Other application
              specific types can easily be added.

       •      Automatic help and usage text generation if a procedure is called with the <u>-help</u> flag.

       •      Automatic generation of an interactive argument definition form, in case  a  procedure  is  called
              with the <u>-interactive</u> flag.

       •      Procedure  calls  can  be  logged  which  is useful to get for interactively called procedures the
              command call lines.

       •      Powerful and code efficient generation of complex parameter definition forms.

</pre><h4><b>PROCEDURE</b> <b>DECLARATION</b></h4><pre>
       TEPAM's procedure declaration syntax is simple and self-explaining. Instead of declaring a procedure with
       the Tcl key word <b>proc</b>, a procedure is declared with the TEPAM command <b>procedure</b> which takes as <b>proc</b>  also
       3 arguments: The procedure name, the procedure header and the procedure body.

       The  following example declares the subcommand <b>message</b> of the procedure <b>display</b>. This command has several
       named and unnamed arguments:

              <b>tepam::procedure</b> {display message} {
                 -return            -
                 -short_description "Displays a simple message box"
                 -description       "This procedure allows displaying a configurable message box."
                 -args {
                    {-mtype -default Warning -choices {Info Warning Error} -description "Message type"}
                    {-font -type font -default {Arial 10 italic} -description "Message text font"}
                    {-level -type integer -optional -range {1 10} -description "Message level"}
                    {-fg -type color -default black -description "Message color"}
                    {-bg -type color -optional -description "Background color"}
                    {-no_border -type none -description "Use a splash window style (no border)"}
                    {-log_file -type file -optional -description "Optional message log file"}
                    {text -type string -multiple -description "Multiple text lines to display"}
                 }
              } {
                 <u>puts</u> <u>"display</u> <u>message:"</u>
                 <u>foreach</u> <u>var</u> <u>{mtype</u> <u>font</u> <u>level</u> <u>fg</u> <u>bg</u> <u>no_border</u> <u>log_file</u> <u>text}</u> <u>{</u>
                    <u>if</u> <u>{[info</u> <u>exists</u> <u>$var]}</u> <u>{</u>
                       <u>puts</u>  <u>"</u>  <u>$var=[set</u> <u>$var]"</u>
                    <u>}</u>
                 <u>}</u>
              }
       A call of procedure that has been declared in this way will first  invoke  the  TEPAM  argument  manager,
       before  the  procedure  body  is  executed. The argument manager parses the provided arguments, validates
       them, completes them eventually with some default  values,  and  makes  them  finally  available  to  the
       procedure  body  as  local  variables.  In  case an argument is missing or has a wrong type, the argument
       manager generates an error message that explains the reason for the error.

       As the example above shows, the TEPAM command <b>procedure</b> accepts subcommand definitions as procedure  name
       and  allows  defining  much more information than just the argument list inside the procedure header. The
       procedure body on the other hand is identical between a command declared with <b>proc</b> and a command declared
       with <b>procedure</b>.

       The procedure header allows defining in addition to the  arguments  some  procedure  attributes,  like  a
       description,  information  concerning  the  return value, etc. This information is basically used for the
       automatic generation of comprehensive help and usage texts.

       A list of argument definition statements assigned  to  the  <u>-args</u>  argument  is  defining  the  procedure
       arguments.  Each argument definition statement starts with the argument name, optionally followed by some
       argument attributes.

       Three types of arguments can be defined: Unnamed arguments, named arguments and  flags.  The  distinction
       between  the named and unnamed arguments is made by the first argument name character which is simply "-"
       for named arguments. A flag is defined as named argument that has the type  <u>none</u>.

       Named and unnamed arguments are mandatory, unless they are declared with the <u>-optional</u>  flag  and  unless
       they  have  a  default  value  specified  with  the <u>-default</u> option. Named arguments and the last unnamed
       argument can have the attribute <u>-multiple</u>, which means that they  can  be  defined  multiple  times.  The
       expected  argument  data  type  is specified with the <u>-type</u> option. TEPAM defines a large set of standard
       data types which can easily be completed with application specific data types.

       The argument declaration order has only an importance for unnamed arguments that are  by  default  parsed
       after  the  named  arguments  (Tcl style). A variable allows changing this behavior in a way that unnamed
       arguments are parsed first, before the named arguments (Tk style).

</pre><h4><b>PROCEDURE</b> <b>HELP</b></h4><pre>
       The declared procedure can simply be called with the <u>-help</u> option to get the information about the  usage
       of the procedure and its arguments:

              <b>display</b> <b>message</b> -help
                <u>-&gt;</u>
              <u>NAME</u>
                    <u>display</u> <u>message</u> <u>-</u> <u>Displays</u> <u>a</u> <u>simple</u> <u>message</u> <u>box</u>
              <u>SYNOPSYS</u>
                    <u>display</u> <u>message</u>
                          <u>[-mtype</u> <u>&lt;mtype&gt;]</u> <u>:</u>
                             <u>Message</u> <u>type,</u> <u>default:</u> <u>"Warning",</u> <u>choices:</u> <u>{Info</u> <u>Warning</u> <u>Error}</u>
                          <u>[-font</u> <u>&lt;font&gt;]</u> <u>:</u>
                             <u>Message</u> <u>text</u> <u>font,</u> <u>type:</u> <u>font,</u> <u>default:</u> <u>Arial</u> <u>10</u> <u>italic</u>
                          <u>[-level</u> <u>&lt;level&gt;]</u> <u>:</u>
                             <u>Message</u> <u>level,</u> <u>type:</u> <u>integer,</u> <u>range:</u> <u>1..10</u>
                          <u>[-fg</u> <u>&lt;fg&gt;]</u> <u>:</u>
                             <u>Message</u> <u>color,</u> <u>type:</u> <u>color,</u> <u>default:</u> <u>black</u>
                          <u>[-bg</u> <u>&lt;bg&gt;]</u> <u>:</u>
                             <u>Background</u> <u>color,</u> <u>type:</u> <u>color</u>
                          <u>[-no_border</u> <u>]</u> <u>:</u>
                             <u>Use</u> <u>a</u> <u>splash</u> <u>window</u> <u>style</u> <u>(no</u> <u>border)</u>
                          <u>[-log_file</u> <u>&lt;log_file&gt;]</u> <u>:</u>
                             <u>Optional</u> <u>message</u> <u>log</u> <u>file,</u> <u>type:</u> <u>file</u>
                          <u>&lt;text&gt;</u> <u>:</u>
                             <u>Multiple</u> <u>text</u> <u>lines</u> <u>to</u> <u>display,</u> <u>type:</u> <u>string</u>
              <u>DESCRIPTION</u>
                    <u>This</u> <u>procedure</u> <u>allows</u> <u>displaying</u> <u>a</u> <u>configurable</u> <u>message</u> <u>box.</u>

</pre><h4><b>PROCEDURE</b> <b>CALL</b></h4><pre>
       The  specified  procedure  can  be  called in many ways. The following listing shows some valid procedure
       calls:

              <b>display</b> <b>message</b> "The document hasn't yet been saved!"
              <u>-&gt;</u> <u>display</u> <u>message:</u>
                   <u>mtype=Warning</u>
                   <u>font=Arial</u> <u>10</u> <u>italic</u>
                   <u>fg=black</u>
                   <u>no_border=0</u>
                   <u>text={The</u> <u>document</u> <u>hasn't</u> <u>yet</u> <u>been</u> <u>saved!}</u>

              <b>display</b> <b>message</b> -fg red -bg black "Please save first the document"
              <u>-&gt;</u> <u>display</u> <u>message:</u>
                   <u>mtype=Warning</u>
                   <u>font=Arial</u> <u>10</u> <u>italic</u>
                   <u>fg=red</u>
                   <u>bg=black</u>
                   <u>no_border=0</u>
                   <u>text={Please</u> <u>save</u> <u>first</u> <u>the</u> <u>document}</u>

              <b>display</b> <b>message</b> -mtype Error -no_border "Why is here no border?"
              <u>-&gt;</u> <u>display</u> <u>message:</u>
                   <u>mtype=Error</u>
                   <u>font=Arial</u> <u>10</u> <u>italic</u>
                   <u>fg=black</u>
                   <u>no_border=1</u>
                   <u>text={Why</u> <u>is</u> <u>here</u> <u>no</u> <u>border?}</u>

              <b>display</b> <b>message</b> -font {Courier 12} -level 10 \
                 "Is there enough space?" "Reduce otherwise the font size!"
              <u>-&gt;</u> <u>display</u> <u>message:</u>
                   <u>mtype=Warning</u>
                   <u>font=Courier</u> <u>12</u>
                   <u>level=10</u>
                   <u>fg=black</u>
                   <u>no_border=0</u>
                   <u>text={Is</u> <u>there</u> <u>enough</u> <u>space?}</u> <u>{Reduce</u> <u>otherwise</u> <u>the</u> <u>font</u> <u>size!}</u>
       The next lines show how wrong arguments are recognized. The <u>text</u> argument that is mandatory is missing in
       the first procedure call:

              <b>display</b> <b>message</b> -font {Courier 12}
                <u>-&gt;</u> <u>display</u> <u>message:</u> <u>Required</u> <u>argument</u> <u>is</u> <u>missing:</u> <u>text</u>
       Only known arguments are accepted:

              <b>display</b> <b>message</b> -category warning Hello
                <u>-&gt;</u> <u>display</u> <u>message:</u> <u>Argument</u> <u>'-category'</u> <u>not</u> <u>known</u>
       Argument types are automatically checked and an error message is generated in case the argument value has
       not the expected type:

              <b>display</b> <b>message</b> -fg MyColor "Hello"
                <u>-&gt;</u> <u>display</u> <u>message:</u> <u>Argument</u> <u>'fg'</u> <u>requires</u> <u>type</u> <u>'color'.</u>  <u>Provided</u> <u>value:</u> <u>'MyColor'</u>
       Selection choices have to be respected ...

              <b>display</b> <b>message</b> -mtype Fatal Hello
                <u>-&gt;</u> <u>display</u> <u>message:</u> <u>Argument</u> <u>(mtype)</u> <u>has</u> <u>to</u> <u>be</u> <u>one</u> <u>of</u> <u>the</u>  <u>following</u> <u>elements:</u> <u>Info,</u> <u>Warning,</u> <u>Error</u>
       ... as well as valid value ranges:

              <b>display</b> <b>message</b> -level 12 Hello
                <u>-&gt;</u> <u>display</u> <u>message:</u> <u>Argument</u> <u>(level)</u> <u>has</u> <u>to</u> <u>be</u> <u>between</u> <u>1</u> <u>and</u> <u>10</u>

</pre><h4><b>INTERACTIVE</b> <b>PROCEDURE</b> <b>CALLS</b></h4><pre>
       The most intuitive way to call the procedure is using  an  form  that  allows  specifying  all  arguments
       interactively.  This  form  will  automatically be generated if the declared procedure is called with the
       <u>-interactive</u> flag. To use this feature the Tk library has to be loaded.

              <b>display</b> <b>message</b> -interactive
       The generated form contains for each argument a data entry widget that is adapted to the  argument  type.
       Check  buttons  are  used  to  specify  flags, radio boxes for tiny choice lists, disjoint list boxes for
       larger choice lists and files, directories, fonts and colors can be selected with dedicated browsers.

       After acknowledging the specified argument data via an OK button, the entered data are  first  validated,
       before the provided arguments are transformed into local variables and the procedure body is executed. In
       case the entered data are invalid, a message appears and the user can correct them until they are valid.

       The procedure calls can optionally be logged in a variable. This is for example useful to get the command
       call lines of interactively called procedures.

</pre><h4><b>FLEXIBLE</b> <b>ARGUMENT</b> <b>DIALOG</b> <b>BOX</b></h4><pre>
       The  form  generator  that  creates  in  the previous example the argument dialog box for the interactive
       procedure call is also available for other purposes than for the definition of procedure arguments. If Tk
       has been loaded TEPAM provides and argument dialog box that allows creating complex parameter  definition
       forms in a very efficient way.

       The  following  example tries to illustrate the simplicity to create complex data entry forms. It creates
       an input mask that allows specifying a file to copy, a destination folder as  well  as  a  checkbox  that
       allows  specifying  if  an eventual existing file can be overwritten. Comfortable browsers can be used to
       select files and directories. And finally, the form offers also the possibility to accept and decline the
       selection. Here is the code snippet that is doing all this:

              <b>tepam::argument_dialogbox</b> \
                 <b>-existingfile</b> {-label "Source file" -variable SourceFile} \
                 <b>-existingdirectory</b> {-label "Destination folder" -variable DestDir} \
                 <b>-checkbutton</b> {-label "Overwrite existing file" -variable Overwrite}
       The <b>argument_dialogbox</b> returns <b>ok</b> if the entered data are validated. It will return <b>cancel</b>  if  the  data
       entry has been canceled. After the validation of the entered data, the <b>argument_dialogbox</b> defines all the
       specified variables with the entered data inside the calling context.

       An  <b>argument_dialogbox</b>  requires  a  pair of arguments for each variable that it has to handle. The first
       argument defines the entry widget type used to select the variable's value and the second one is a  lists
       of attributes related to the variable and the entry widget.

       Many  entry  widget  types are available: Beside the simple generic entries, there are different kinds of
       list and combo boxes available, browsers for existing and new files  and  directories,  check  and  radio
       boxes  and  buttons,  as  well  as  color and font pickers. If necessary, additional entry widgets can be
       defined.

       The attribute list contains pairs of attribute  names  and  attribute  data.  The  primary  attribute  is
       <u>-variable</u>  used  to  specify  the  variable  in the calling context into which the entered data has to be
       stored. Another often used attribute is <u>-label</u> that allows adding a label to the data entry widget. Other
       attributes are available that allow specifying default  values,  the  expected  data  types,  valid  data
       ranges, etc.

       The  next  example  of  a  more  complex argument dialog box provides a good overview about the different
       available entry widget types  and  parameter  attributes.  The  example  contains  also  some  formatting
       instructions  like  <u>-frame</u>  and  <u>-sep</u>  which  allows organizing the different entry widgets in frames and
       sections:

              set ChoiceList {"Choice 1" "Choice 2" "Choice 3" "Choice 4" "Choice 5" "Choice 6"}

              set Result [<b>tepam::argument_dialogbox</b> \
                 <b>-title</b> "System configuration" \
                 <b>-context</b> test_1 \
                 <b>-frame</b> {-label "Entries"} \
                    <b>-entry</b> {-label Entry1 -variable Entry1} \
                    <b>-entry</b> {-label Entry2 -variable Entry2 -default "my default"} \
                 <b>-frame</b> {-label "Listbox &amp; combobox"} \
                    <b>-listbox</b> {-label "Listbox, single selection" -variable Listbox1 \
                              -choices {1 2 3 4 5 6 7 8} -default 1 -height 3} \
                    <b>-listbox</b> {-label "Listbox, multiple selection" -variable Listbox2
                              -choicevariable ChoiceList -default {"Choice 2" "Choice 3"}
                              -multiple_selection 1 -height 3} \
                    <b>-disjointlistbox</b> {-label "Disjoined listbox" -variable DisJntListbox
                                      -choicevariable ChoiceList \
                                      -default {"Choice 3" "Choice 5"} -height 3} \
                    <b>-combobox</b> {-label "Combobox" -variable Combobox \
                               -choices {1 2 3 4 5 6 7 8} -default 3} \
                 <b>-frame</b> {-label "Checkbox, radiobox and checkbutton"} \
                    <b>-checkbox</b> {-label Checkbox -variable Checkbox
                               -choices {bold italic underline} -choicelabels {Bold Italic Underline} \
                               -default italic} \
                    <b>-radiobox</b> {-label Radiobox -variable Radiobox
                               -choices {bold italic underline} -choicelabels {Bold Italic Underline} \
                               -default underline} \
                    <b>-checkbutton</b> {-label CheckButton -variable Checkbutton -default 1} \
                 <b>-frame</b> {-label "Files &amp; directories"} \
                    <b>-existingfile</b> {-label "Input file" -variable InputFile} \
                    <b>-file</b> {-label "Output file" -variable OutputFile} \
                    <b>-sep</b> {} \
                    <b>-existingdirectory</b> {-label "Input directory" -variable InputDirectory} \
                    <b>-directory</b> {-label "Output irectory" -variable OutputDirectory} \
                 <b>-frame</b> {-label "Colors and fonts"} \
                    <b>-color</b> {-label "Background color" -variable Color -default red} \
                    <b>-sep</b> {} \
                    <b>-font</b> {-label "Font" -variable Font -default {Courier 12 italic}}]
       The <b>argument_dialogbox</b> defines all the specified variables with the entered data and returns  <b>ok</b>  if  the
       data  have  been  validated  via  the  Ok button. If the data entry is cancelled by activating the Cancel
       button, the <b>argument_dialogbox</b> returns <b>cancel</b>.

              if {$Result=="cancel"} {
                 puts "Canceled"
              } else { # $Result=="ok"
                 puts "Arguments: "
                 foreach Var {
                    Entry1 Entry2
                    Listbox1 Listbox2 DisJntListbox
                    Combobox Checkbox Radiobox Checkbutton
                    InputFile OutputFile InputDirectory OutputDirectory
                    Color Font
                 } {
                    puts "  $Var: '[set $Var]'"
                 }
              }
              <u>-&gt;</u> <u>Arguments:</u>
                 <u>Entry1:</u> <u>'Hello,</u> <u>this</u> <u>is</u> <u>a</u> <u>trial'</u>
                 <u>Entry2:</u> <u>'my</u> <u>default'</u>
                 <u>Listbox1:</u> <u>'1'</u>
                 <u>Listbox2:</u> <u>'{Choice</u> <u>2}</u> <u>{Choice</u> <u>3}'</u>
                 <u>DisJntListbox:</u> <u>'{Choice</u> <u>3}</u> <u>{Choice</u> <u>5}'</u>
                 <u>Combobox:</u> <u>'3'</u>
                 <u>Checkbox:</u> <u>'italic'</u>
                 <u>Radiobox:</u> <u>'underline'</u>
                 <u>Checkbutton:</u> <u>'1'</u>
                 <u>InputFile:</u> <u>'c:\tepam\in.txt'</u>
                 <u>OutputFile:</u> <u>'c:\tepam\out.txt'</u>
                 <u>InputDirectory:</u> <u>'c:\tepam\input'</u>
                 <u>OutputDirectory:</u> <u>'c:\tepam\output'</u>
                 <u>Color:</u> <u>'red'</u>
                 <u>Font:</u> <u>'Courier</u> <u>12</u> <u>italic'</u>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       tepam::<a href="../man3tcl/argument_dialogbox.3tcl.html">argument_dialogbox</a>(3tcl), tepam::<a href="../man3tcl/procedure.3tcl.html">procedure</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       argument integrity,  argument  validation,  arguments,  entry  mask,  parameter  entry  form,  procedure,
       subcommand

</pre><h4><b>CATEGORY</b></h4><pre>
       Procedures, arguments, parameters, options

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2009-2013, Andreas Drollinger

tcllib                                                0.5.4                                          <u><a href="../man3tcl/tepam.3tcl.html">tepam</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>