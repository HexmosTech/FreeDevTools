<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_set_tlsext_use_srtp, SSL_set_tlsext_use_srtp, SSL_get_srtp_profiles,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_set_tlsext_use_srtp, SSL_set_tlsext_use_srtp, SSL_get_srtp_profiles,
       SSL_get_selected_srtp_profile - Configure and query SRTP support

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/srtp.h&gt;

        int SSL_CTX_set_tlsext_use_srtp(SSL_CTX *ctx, const char *profiles);
        int SSL_set_tlsext_use_srtp(SSL *ssl, const char *profiles);

        STACK_OF(SRTP_PROTECTION_PROFILE) *SSL_get_srtp_profiles(SSL *ssl);
        SRTP_PROTECTION_PROFILE *SSL_get_selected_srtp_profile(SSL *s);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       SRTP is the Secure Real-Time Transport Protocol. OpenSSL implements support for the "use_srtp" DTLS
       extension defined in RFC5764. This provides a mechanism for establishing SRTP keying material, algorithms
       and parameters using DTLS. This capability may be used as part of an implementation that conforms to
       RFC5763.  OpenSSL does not implement SRTP itself or RFC5763. Note that OpenSSL does not support the use
       of SRTP Master Key Identifiers (MKIs). Also note that this extension is only supported in DTLS. Any SRTP
       configuration will be ignored if a TLS connection is attempted.

       An OpenSSL client wishing to send the "use_srtp" extension should call <b>SSL_CTX_set_tlsext_use_srtp()</b> to
       set its use for all SSL objects subsequently created from an SSL_CTX. Alternatively a client may call
       <b>SSL_set_tlsext_use_srtp()</b> to set its use for an individual SSL object. The <b>profiles</b> parameters should
       point to a NUL-terminated, colon delimited list of SRTP protection profile names.

       The currently supported protection profile names are:

       SRTP_AES128_CM_SHA1_80
           This corresponds to SRTP_AES128_CM_HMAC_SHA1_80 defined in RFC5764.

       SRTP_AES128_CM_SHA1_32
           This corresponds to SRTP_AES128_CM_HMAC_SHA1_32 defined in RFC5764.

       SRTP_AEAD_AES_128_GCM
           This corresponds to the profile of the same name defined in RFC7714.

       SRTP_AEAD_AES_256_GCM
           This corresponds to the profile of the same name defined in RFC7714.

       SRTP_DOUBLE_AEAD_AES_128_GCM_AEAD_AES_128_GCM
           This corresponds to the profile of the same name defined in RFC8723.

       SRTP_DOUBLE_AEAD_AES_256_GCM_AEAD_AES_256_GCM
           This corresponds to the profile of the same name defined in RFC8723.

       SRTP_ARIA_128_CTR_HMAC_SHA1_80
           This corresponds to the profile of the same name defined in RFC8269.

       SRTP_ARIA_128_CTR_HMAC_SHA1_32
           This corresponds to the profile of the same name defined in RFC8269.

       SRTP_ARIA_256_CTR_HMAC_SHA1_80
           This corresponds to the profile of the same name defined in RFC8269.

       SRTP_ARIA_256_CTR_HMAC_SHA1_32
           This corresponds to the profile of the same name defined in RFC8269.

       SRTP_AEAD_ARIA_128_GCM
           This corresponds to the profile of the same name defined in RFC8269.

       SRTP_AEAD_ARIA_256_GCM
           This corresponds to the profile of the same name defined in RFC8269.

       Supplying an unrecognised protection profile name will result in an error.

       An    OpenSSL    server    wishing    to    support   the   "use_srtp"   extension   should   also   call
       <b>SSL_CTX_set_tlsext_use_srtp()</b> or <b>SSL_set_tlsext_use_srtp()</b> to indicate the protection profiles that it is
       willing to negotiate.

       The currently configured list of protection profiles for either a client or a server can be  obtained  by
       calling  <b>SSL_get_srtp_profiles()</b>.  This  returns  a  stack of SRTP_PROTECTION_PROFILE objects. The memory
       pointed to in the return value of this function should not be freed by the caller.

       After a handshake has been completed the negotiated SRTP protection profile (if any) can be obtained  (on
       the  client  or the server) by calling <b>SSL_get_selected_srtp_profile()</b>. This function will return NULL if
       no SRTP protection profile was negotiated. The memory returned from this function should not be freed  by
       the caller.

       If an SRTP protection profile has been successfully negotiated then the SRTP keying material (on both the
       client  and  server)  should  be  obtained  via a call to <b><a href="../man3/SSL_export_keying_material.3.html">SSL_export_keying_material</a></b>(3). This call should
       provide a label value of "EXTRACTOR-dtls_srtp" and a NULL context value (use_context  is  0).  The  total
       length  of keying material obtained should be equal to two times the sum of the master key length and the
       salt length as defined for the protection profile in use. This provides the client write master key,  the
       server write master key, the client write master salt and the server write master salt in that order.

       These functions cannot be used with QUIC SSL objects.  <b>SSL_CTX_set_tlsext_use_srtp()</b> fails if called on a
       QUIC SSL context.  <b>SSL_set_tlsext_use_srtp()</b> fails if called on a QUIC SSL object.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_CTX_set_tlsext_use_srtp()</b> and <b>SSL_set_tlsext_use_srtp()</b> return 0 on success or 1 on error.

       <b>SSL_get_srtp_profiles()</b> returns a stack of SRTP_PROTECTION_PROFILE objects on success or NULL on error or
       if no protection profiles have been configured.

       <b>SSL_get_selected_srtp_profile()</b>  returns  a  pointer to an SRTP_PROTECTION_PROFILE object if one has been
       negotiated or NULL otherwise.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_export_keying_material.3.html">SSL_export_keying_material</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2017-2023 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                  <u><a href="../man3SSL/SSL_CTX_SET_TLSEXT_USE_SRTP.3SSL.html">SSL_CTX_SET_TLSEXT_USE_SRTP</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>