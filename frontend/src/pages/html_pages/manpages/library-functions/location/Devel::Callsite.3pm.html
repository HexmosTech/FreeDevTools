<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Devel::Callsite - Get caller return OP address and Perl interpreter context</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libdevel-callsite-perl">libdevel-callsite-perl_1.0.1-2build5_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Devel::Callsite - Get caller return OP address and Perl interpreter context

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Devel::Callsite;
         my $site = sub { return callsite() };
         my $op_addr = $site-&gt;();
         printf "OP location: 0x%x\n", $op_addr;   # prints caller OP location
         printf "OP location: 0x%x\n", $site-&gt;(); # prints a different OP location

         sub foo { return <a href="../man1/callsite.1.html">callsite</a>(1) };
         sub bar { foo() };
         # print this OP location even though it is 2 levels up the call chain.
         printf "OP location: 0x%x\n", bar();

         if ($] &gt;= 5.025) {
           printf "OP is: %s\n", addr_to_op($addr);
           my $get_op = sub { return caller_nextop() };
           printf "OP is now: %s\n", $get_op-&gt;();
         }

         print context(), "\n"; # prints the interpreter context, an unsigned number

       Running the above gives:

         OP location: 0x5572e41f89f8
         OP location: 0x5572e421f5b0
         OP is: B::NULL=<a href="../man0x5572e41d0578/SCALAR.0x5572e41d0578.html">SCALAR</a>(0x5572e41d0578)
         OP location: 0x5572e421f010
         OP is now: B::LISTOP=<a href="../man0x5572e41d0578/SCALAR.0x5572e41d0578.html">SCALAR</a>(0x5572e41d0578)
         93951941730912

</pre><h4><b>DESCRIPTION</b></h4><pre>
   <b>callsite</b>
           $callsite = callsite();
           $callsite = callsite($level);

       This function returns the the OP address of the caller, a number. It can take an optional integer
       specifying the number of levels back to get the OP address. If no parameter is given, a value of 0 is
       used which means to go up one level in the call chain. This behavior is like the built-in function
       "caller".

       This value is useful for functions that need to uniquely know where they were called, such as
       Every::every(); see Every. Or it can be used to pinpoint a location with finer granularity than a line
       number &lt;<a href="http://www.perlmonks.com/">http://www.perlmonks.com/</a>?node_id=987268&gt;. In conjunction with an OP tree disassembly you can
       know exactly where the caller is located in the Perl source.

       As of version 0.08, this function will return the expected call site for functions called via "DB::sub".
       (Previously it returned a call site inside the debugger.) If "callsite" is called from package "DB" in
       list context, it will return two numbers. The first is the ordinary return value; the second is the
       'true' call site of the function in question, which may be different if "DB::sub" is in use.

   <b>addr_to_op</b>
       <u>For</u> <u>now</u> <u>this</u> <u>is</u> <u>only</u> <u>in</u> <u>5.026</u> <u>or</u> <u>greater</u>.

           $op = caller_nextop();
           $op = caller_nextop($level);

   <b>caller_nextop</b>
       <u>For</u> <u>now</u> <u>this</u> <u>is</u> <u>only</u> <u>in</u> <u>5.026</u> <u>or</u> <u>greater</u>.

           $op = caller_nextop();
           $op = caller_nextop($level);

       This function returns the the "B::OP", not the address, of the next OP to get run after the call is made.
       It is equivalent to:

           addr_to_op(callsite($level));

   <b>context</b>
           $context = context()

       This function returns the interpreter context as a number. Using "callsite" alone to identify the call
       site is not reliable in programs which may include multiple Perl interpreters, such as when using
       ithreads. Combining "callsite" with "context" gives a unique location.

</pre><h4><b>HISTORY</b></h4><pre>
       Ben Morrow conceived this and posted it to perl5-porters. Ted Zlatanov then turned it into a CPAN module
       which he maintained for the first 3 revisions. Ben also added the level parameter to callsite.

       ikegami provided the function to turn the address into a real "B::OP".

       It is currently maintained (or not) by Rocky Bernstein.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       B::Concise to disassemble the OP tree. Devel::Trepan optionally uses <u>Devel::Callsite</u> to show you exactly
       where you are stopped inside the debugger.

</pre><h4><b>AUTHORS</b></h4><pre>
       Rocky Bernstein &lt;<a href="mailto:rocky@cpan.org">rocky@cpan.org</a>&gt; (current maintainer) Ted Zlatanov &lt;<a href="mailto:tzz@lifelogs.com">tzz@lifelogs.com</a>&gt; Ben Morrow ikegami

</pre><h4><b>LICENSE</b> <b>AND</b> <b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2013, 2018 Rocky Bernstein &lt;<a href="mailto:rocky@cpan.org">rocky@cpan.org</a>&gt;, Ted Zlatanov, &lt;<a href="mailto:tzz@lifelogs.com">tzz@lifelogs.com</a>&gt;, Ben Morrow

       This program is distributed WITHOUT ANY WARRANTY, including but not limited to the implied warranties of
       merchantability or fitness for a particular purpose.

       The program is free software. You may distribute it and/or modify it under the terms of the GNU General
       Public License as published by the Free Software Foundation (either version 2 or any later version) and
       the Perl Artistic License as published by Oâ€™Reilly Media, Inc. Please open the files named gpl-2.0.txt
       and Artistic for a copy of these licenses.

perl v5.40.0                                       2024-10-20                                      <u><a href="../man3pm/Callsite.3pm.html">Callsite</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>