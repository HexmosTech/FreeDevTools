<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>curl_ws_send - send WebSocket data</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcurl4-doc">libcurl4-doc_8.14.1-1ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       curl_ws_send - send WebSocket data

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;curl/curl.h&gt;

       CURLcode curl_ws_send(CURL *curl, const void *buffer, size_t buflen,
                             size_t *sent, curl_off_t fragsize,
                             unsigned int flags);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Send  the  specific  message chunk over an established WebSocket connection. <u>buffer</u> must point to a valid
       memory location containing (at least) <u>buflen</u> bytes of payload memory.

       <u>sent</u> is set to the number of payload bytes actually sent. If the return value is  <b>CURLE_OK</b>  but  <u>sent</u>  is
       less  than the given <u>buflen</u>, libcurl was unable to consume the complete payload in a single call. In this
       case the application must call this function again until all payload is processed. <u>buffer</u> and <u>buflen</u> must
       be updated on every following invocation to only point to the remaining piece of the payload.

       <u>fragsize</u> should always be set to zero unless a (huge) frame shall  be  sent  using  multiple  calls  with
       partial content per call explicitly. In that case you must set the <u>CURLWS_OFFSET</u> bit and set the <u>fragsize</u>
       as documented in the section on <u>CURLWS_OFFSET</u> below.

       <u>flags</u>  must  contain  at least one flag indicating the type of the message.  To send a fragmented message
       consisting of multiple frames, additionally set the <u>CURLWS_CONT</u> bit in all frames except the  final  one.
       The  appropriate message type bit should be set in every frame of a fragmented message without exemption.
       Omitting the message type for continuation frames of a fragmented message is only supported for backwards
       compatibility and highly discouraged.

       For more details on the supported flags see below and in <u><a href="../man3/curl_ws_meta.3.html">curl_ws_meta</a>(3)</u>.

       If <u>CURLWS_RAW_MODE</u> is enabled in <u><a href="../man3/CURLOPT_WS_OPTIONS.3.html">CURLOPT_WS_OPTIONS</a>(3)</u>, the <u>flags</u> argument should be set to 0.

       Warning: while it is possible to invoke this function from a callback, such a call is  blocking  in  this
       situation, e.g. only returns after all data has been sent or an error is encountered.

</pre><h4><b>FLAGS</b></h4><pre>
       Supports all flags documented in <u><a href="../man3/curl_ws_meta.3.html">curl_ws_meta</a>(3)</u> and additionally the following flags.

       CURLWS_OFFSET
              The  provided  data  is  only  a  partial  frame  and  there is more coming in a following call to
              <u>curl_ws_send()</u>. When sending only a piece of the frame like this, the <u>fragsize</u>  must  be  provided
              with the total expected frame size in the first call and must be zero in all subsequent calls.

</pre><h4><b>PROTOCOLS</b></h4><pre>
       This functionality affects ws only

</pre><h4><b>EXAMPLE</b></h4><pre>
       #include &lt;<a href="file:/usr/include/string.h">string.h</a>&gt; /* for strlen */

       int main(void)
       {
         const char *buffer = "PAYLOAD";
         size_t offset = 0;
         CURLcode res = CURLE_OK;
         CURL *curl = curl_easy_init();

         curl_easy_setopt(curl, CURLOPT_URL, "wss://example.com/");
         curl_easy_setopt(curl, CURLOPT_CONNECT_ONLY, 2L);
         /* start HTTPS connection and upgrade to WSS, then return control */
         curl_easy_perform(curl);

         while(!res) {
           size_t sent;
           res = curl_ws_send(curl, buffer + offset, strlen(buffer) - offset, &amp;sent,
                              0, CURLWS_TEXT);
           offset += sent;

           if(res == CURLE_OK) {
             if(offset == strlen(buffer))
               break; /* finished sending */
           }

           if(res == CURLE_AGAIN)
             /* in real application: wait for socket here, e.g. using select() */
             res = CURLE_OK;
         }

         curl_easy_cleanup(curl);
         return (int)res;
       }

</pre><h4><b>AVAILABILITY</b></h4><pre>
       Added in curl 7.86.0

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       This function returns a CURLcode indicating success or error.

       CURLE_OK  (0)  means  everything  was  OK,  non-zero  means  an error occurred, see <u><a href="../man3/libcurl-errors.3.html">libcurl-errors</a>(3)</u>. If
       <u><a href="../man3/CURLOPT_ERRORBUFFER.3.html">CURLOPT_ERRORBUFFER</a>(3)</u> was set with <u><a href="../man3/curl_easy_setopt.3.html">curl_easy_setopt</a>(3)</u> there can be an error message stored in the error
       buffer when non-zero is returned.

       Instead of blocking, the function returns <b>CURLE_AGAIN</b>. The correct behavior  is  then  to  wait  for  the
       socket to signal readability before calling this function again.

       Any  other non-zero return value indicates an error. See the <u><a href="../man3/libcurl-errors.3.html">libcurl-errors</a>(3)</u> man page for the full list
       with descriptions.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/curl_easy_getinfo.3.html">curl_easy_getinfo</a></b>(3), <b><a href="../man3/curl_easy_perform.3.html">curl_easy_perform</a></b>(3), <b><a href="../man3/curl_easy_setopt.3.html">curl_easy_setopt</a></b>(3), <b><a href="../man3/curl_ws_recv.3.html">curl_ws_recv</a></b>(3), <b><a href="../man3/libcurl-ws.3.html">libcurl-ws</a></b>(3)

libcurl                                            2025-06-16                                    <u><a href="../man3/curl_ws_send.3.html">curl_ws_send</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>