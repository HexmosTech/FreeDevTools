<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gesvj - gesvj: SVD, Jacobi, low-level</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/liblapack-doc">liblapack-doc_3.12.1-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gesvj - gesvj: SVD, Jacobi, low-level

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Functions</b>
       subroutine <b>cgesvj</b> (joba, jobu, jobv, m, n, a, lda, sva, mv, v, ldv, cwork, lwork, rwork, lrwork, info)
            <b>CGESVJ</b>
       subroutine <b>dgesvj</b> (joba, jobu, jobv, m, n, a, lda, sva, mv, v, ldv, work, lwork, info)
           <b>DGESVJ</b>
       subroutine <b>sgesvj</b> (joba, jobu, jobv, m, n, a, lda, sva, mv, v, ldv, work, lwork, info)
           <b>SGESVJ</b>
       subroutine <b>zgesvj</b> (joba, jobu, jobv, m, n, a, lda, sva, mv, v, ldv, cwork, lwork, rwork, lrwork, info)
            <b>ZGESVJ</b>

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>subroutine</b> <b>cgesvj</b> <b>(character*1</b> <b>joba,</b> <b>character*1</b> <b>jobu,</b> <b>character*1</b> <b>jobv,</b> <b>integer</b> <b>m,</b> <b>integer</b> <b>n,</b> <b>complex,</b>
       <b>dimension(</b> <b>lda,</b> <b>*</b> <b>)</b> <b>a,</b> <b>integer</b> <b>lda,</b> <b>real,</b> <b>dimension(</b> <b>n</b> <b>)</b> <b>sva,</b> <b>integer</b> <b>mv,</b> <b>complex,</b> <b>dimension(</b> <b>ldv,</b> <b>*</b> <b>)</b> <b>v,</b>
       <b>integer</b> <b>ldv,</b> <b>complex,</b> <b>dimension(</b> <b>lwork</b> <b>)</b> <b>cwork,</b> <b>integer</b> <b>lwork,</b> <b>real,</b> <b>dimension(</b> <b>lrwork</b> <b>)</b> <b>rwork,</b> <b>integer</b>
       <b>lrwork,</b> <b>integer</b> <b>info)</b>
        <b>CGESVJ</b>

       <b>Purpose:</b>

            CGESVJ computes the singular value decomposition (SVD) of a complex
            M-by-N matrix A, where M &gt;= N. The SVD of A is written as
                                               [++]   [xx]   [x0]   [xx]
                         A = U * SIGMA * V^*,  [++] = [xx] * [ox] * [xx]
                                               [++]   [xx]
            where SIGMA is an N-by-N diagonal matrix, U is an M-by-N orthonormal
            matrix, and V is an N-by-N unitary matrix. The diagonal elements
            of SIGMA are the singular values of A. The columns of U and V are the
            left and the right singular vectors of A, respectively.

       <b>Parameters</b>
           <u>JOBA</u>

                     JOBA is CHARACTER*1
                     Specifies the structure of A.
                     = 'L': The input matrix A is lower triangular;
                     = 'U': The input matrix A is upper triangular;
                     = 'G': The input matrix A is general M-by-N matrix, M &gt;= N.

           <u>JOBU</u>

                     JOBU is CHARACTER*1
                     Specifies whether to compute the left singular vectors
                     (columns of U):
                     = 'U' or 'F': The left singular vectors corresponding to the nonzero
                            singular values are computed and returned in the leading
                            columns of A. See more details in the description of A.
                            The default numerical orthogonality threshold is set to
                            approximately TOL=CTOL*EPS, CTOL=SQRT(M), EPS=SLAMCH('E').
                     = 'C': Analogous to JOBU='U', except that user can control the
                            level of numerical orthogonality of the computed left
                            singular vectors. TOL can be set to TOL = CTOL*EPS, where
                            CTOL is given on input in the array WORK.
                            No CTOL smaller than ONE is allowed. CTOL greater
                            than 1 / EPS is meaningless. The option 'C'
                            can be used if M*EPS is satisfactory orthogonality
                            of the computed left singular vectors, so CTOL=M could
                            save few sweeps of Jacobi rotations.
                            See the descriptions of A and <a href="../man1/WORK.1.html">WORK</a>(1).
                     = 'N': The matrix U is not computed. However, see the
                            description of A.

           <u>JOBV</u>

                     JOBV is CHARACTER*1
                     Specifies whether to compute the right singular vectors, that
                     is, the matrix V:
                     = 'V' or 'J': the matrix V is computed and returned in the array V
                     = 'A':  the Jacobi rotations are applied to the MV-by-N
                             array V. In other words, the right singular vector
                             matrix V is not computed explicitly; instead it is
                             applied to an MV-by-N matrix initially stored in the
                             first MV rows of V.
                     = 'N':  the matrix V is not computed and the array V is not
                             referenced

           <u>M</u>

                     M is INTEGER
                     The number of rows of the input matrix A. 1/SLAMCH('E') &gt; M &gt;= 0.

           <u>N</u>

                     N is INTEGER
                     The number of columns of the input matrix A.
                     M &gt;= N &gt;= 0.

           <u>A</u>

                     A is COMPLEX array, dimension (LDA,N)
                     On entry, the M-by-N matrix A.
                     On exit,
                     If JOBU = 'U' .OR. JOBU = 'C':
                            If INFO = 0 :
                            RANKA orthonormal columns of U are returned in the
                            leading RANKA columns of the array A. Here RANKA &lt;= N
                            is the number of computed singular values of A that are
                            above the underflow threshold SLAMCH('S'). The singular
                            vectors corresponding to underflowed or zero singular
                            values are not computed. The value of RANKA is returned
                            in the array RWORK as RANKA=NINT(<a href="../man2/RWORK.2.html">RWORK</a>(2)). Also see the
                            descriptions of SVA and RWORK. The computed columns of U
                            are mutually numerically orthogonal up to approximately
                            TOL=SQRT(M)*EPS (default); or TOL=CTOL*EPS (JOBU = 'C'),
                            see the description of JOBU.
                            If INFO &gt; 0,
                            the procedure CGESVJ did not converge in the given number
                            of iterations (sweeps). In that case, the computed
                            columns of U may not be orthogonal up to TOL. The output
                            U (stored in A), SIGMA (given by the computed singular
                            values in SVA(1:N)) and V is still a decomposition of the
                            input matrix A in the sense that the residual
                            || A - SCALE * U * SIGMA * V^* ||_2 / ||A||_2 is small.
                     If JOBU = 'N':
                            If INFO = 0 :
                            Note that the left singular vectors are 'for free' in the
                            one-sided Jacobi SVD algorithm. However, if only the
                            singular values are needed, the level of numerical
                            orthogonality of U is not an issue and iterations are
                            stopped when the columns of the iterated matrix are
                            numerically orthogonal up to approximately M*EPS. Thus,
                            on exit, A contains the columns of U scaled with the
                            corresponding singular values.
                            If INFO &gt; 0 :
                            the procedure CGESVJ did not converge in the given number
                            of iterations (sweeps).

           <u>LDA</u>

                     LDA is INTEGER
                     The leading dimension of the array A.  LDA &gt;= max(1,M).

           <u>SVA</u>

                     SVA is REAL array, dimension (N)
                     On exit,
                     If INFO = 0 :
                     depending on the value SCALE = <a href="../man1/RWORK.1.html">RWORK</a>(1), we have:
                            If SCALE = ONE:
                            SVA(1:N) contains the computed singular values of A.
                            During the computation SVA contains the Euclidean column
                            norms of the iterated matrices in the array A.
                            If SCALE .NE. ONE:
                            The singular values of A are SCALE*SVA(1:N), and this
                            factored representation is due to the fact that some of the
                            singular values of A might underflow or overflow.

                     If INFO &gt; 0 :
                     the procedure CGESVJ did not converge in the given number of
                     iterations (sweeps) and SCALE*SVA(1:N) may not be accurate.

           <u>MV</u>

                     MV is INTEGER
                     If JOBV = 'A', then the product of Jacobi rotations in CGESVJ
                     is applied to the first MV rows of V. See the description of JOBV.

           <u>V</u>

                     V is COMPLEX array, dimension (LDV,N)
                     If JOBV = 'V', then V contains on exit the N-by-N matrix of
                                    the right singular vectors;
                     If JOBV = 'A', then V contains the product of the computed right
                                    singular vector matrix and the initial matrix in
                                    the array V.
                     If JOBV = 'N', then V is not referenced.

           <u>LDV</u>

                     LDV is INTEGER
                     The leading dimension of the array V, LDV &gt;= 1.
                     If JOBV = 'V', then LDV &gt;= max(1,N).
                     If JOBV = 'A', then LDV &gt;= max(1,MV) .

           <u>CWORK</u>

                     CWORK is COMPLEX array, dimension (max(1,LWORK))
                     Used as workspace.

           <u>LWORK</u>

                     LWORK is INTEGER.
                     Length of CWORK.
                     LWORK &gt;= 1, if MIN(M,N) = 0, and LWORK &gt;= M+N, otherwise.

                     If on entry LWORK = -1, then a workspace query is assumed and
                     no computation is done; <a href="../man1/CWORK.1.html">CWORK</a>(1) is set to the minial (and optimal)
                     length of CWORK.

           <u>RWORK</u>

                     RWORK is REAL array, dimension (max(6,LRWORK))
                     On entry,
                     If JOBU = 'C' :
                     <a href="../man1/RWORK.1.html">RWORK</a>(1) = CTOL, where CTOL defines the threshold for convergence.
                               The process stops if all columns of A are mutually
                               orthogonal up to CTOL*EPS, EPS=SLAMCH('E').
                               It is required that CTOL &gt;= ONE, i.e. it is not
                               allowed to force the routine to obtain orthogonality
                               below EPSILON.
                     On exit,
                     <a href="../man1/RWORK.1.html">RWORK</a>(1) = SCALE is the scaling factor such that SCALE*SVA(1:N)
                               are the computed singular values of A.
                               (See description of SVA().)
                     <a href="../man2/RWORK.2.html">RWORK</a>(2) = NINT(<a href="../man2/RWORK.2.html">RWORK</a>(2)) is the number of the computed nonzero
                               singular values.
                     <a href="../man3/RWORK.3.html">RWORK</a>(3) = NINT(<a href="../man3/RWORK.3.html">RWORK</a>(3)) is the number of the computed singular
                               values that are larger than the underflow threshold.
                     <a href="../man4/RWORK.4.html">RWORK</a>(4) = NINT(<a href="../man4/RWORK.4.html">RWORK</a>(4)) is the number of sweeps of Jacobi
                               rotations needed for numerical convergence.
                     <a href="../man5/RWORK.5.html">RWORK</a>(5) = max_{i.NE.j} |COS(A(:,i),A(:,j))| in the last sweep.
                               This is useful information in cases when CGESVJ did
                               not converge, as it can be used to estimate whether
                               the output is still useful and for post festum analysis.
                     <a href="../man6/RWORK.6.html">RWORK</a>(6) = the largest absolute value over all sines of the
                               Jacobi rotation angles in the last sweep. It can be
                               useful for a post festum analysis.

           <u>LRWORK</u>

                    LRWORK is INTEGER
                    Length of RWORK.
                    LRWORK &gt;= 1, if MIN(M,N) = 0, and LRWORK &gt;= MAX(6,N), otherwise

                    If on entry LRWORK = -1, then a workspace query is assumed and
                    no computation is done; <a href="../man1/RWORK.1.html">RWORK</a>(1) is set to the minial (and optimal)
                    length of RWORK.

           <u>INFO</u>

                     INFO is INTEGER
                     = 0:  successful exit.
                     &lt; 0:  if INFO = -i, then the i-th argument had an illegal value
                     &gt; 0:  CGESVJ did not converge in the maximal allowed number
                           (NSWEEP=30) of sweeps. The output may still be useful.
                           See the description of RWORK.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

            The orthogonal N-by-N matrix V is obtained as a product of Jacobi plane
            rotations. In the case of underflow of the tangent of the Jacobi angle, a
            modified Jacobi transformation of Drmac [3] is used. Pivot strategy uses
            column interchanges of de Rijk [1]. The relative accuracy of the computed
            singular values and the accuracy of the computed singular vectors (in
            angle metric) is as guaranteed by the theory of Demmel and Veselic [2].
            The condition number that determines the accuracy in the full rank case
            is essentially min_{D=diag} kappa(A*D), where kappa(.) is the
            spectral condition number. The best performance of this Jacobi SVD
            procedure is achieved if used in an  accelerated version of Drmac and
            Veselic [4,5], and it is the kernel routine in the SIGMA library [6].
            Some tuning parameters (marked with [TP]) are available for the
            implementer.
            The computational range for the nonzero singular values is the  machine
            number interval ( UNDERFLOW , OVERFLOW ). In extreme cases, even
            denormalized singular values can be computed with the corresponding
            gradual loss of accurate digits.

       <b>Contributor:</b>

             ============

             Zlatko Drmac (Zagreb, Croatia)

       <b>References:</b>

            [1] P. P. M. De Rijk: A one-sided Jacobi algorithm for computing the
               singular value decomposition on a vector computer.
               SIAM J. Sci. Stat. Comp., Vol. 10 (1998), pp. 359-371.
            [2] J. Demmel and K. Veselic: Jacobi method is more accurate than QR.
            [3] Z. Drmac: Implementation of Jacobi rotations for accurate singular
               value computation in floating point arithmetic.
               SIAM J. Sci. Comp., Vol. 18 (1997), pp. 1200-1222.
            [4] Z. Drmac and K. Veselic: New fast and accurate Jacobi SVD algorithm I.
               SIAM J. Matrix Anal. Appl. Vol. 35, No. 2 (2008), pp. 1322-1342.
               LAPACK Working note 169.
            [5] Z. Drmac and K. Veselic: New fast and accurate Jacobi SVD algorithm II.
               SIAM J. Matrix Anal. Appl. Vol. 35, No. 2 (2008), pp. 1343-1362.
               LAPACK Working note 170.
            [6] Z. Drmac: SIGMA - mathematical software library for accurate SVD, PSV,
               QSVD, (H,K)-SVD computations.
               Department of Mathematics, University of Zagreb, 2008, 2015.

       <b>Bugs,</b> <b>examples</b> <b>and</b> <b>comments:</b>

             ===========================
             Please report all bugs and send interesting test examples and comments to
             <a href="mailto:drmac@math.hr">drmac@math.hr</a>. Thank you.

   <b>subroutine</b> <b>dgesvj</b> <b>(character*1</b> <b>joba,</b> <b>character*1</b> <b>jobu,</b> <b>character*1</b> <b>jobv,</b> <b>integer</b> <b>m,</b> <b>integer</b> <b>n,</b> <b>double</b>
       <b>precision,</b> <b>dimension(</b> <b>lda,</b> <b>*</b> <b>)</b> <b>a,</b> <b>integer</b> <b>lda,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>n</b> <b>)</b> <b>sva,</b> <b>integer</b> <b>mv,</b> <b>double</b>
       <b>precision,</b> <b>dimension(</b> <b>ldv,</b> <b>*</b> <b>)</b> <b>v,</b> <b>integer</b> <b>ldv,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>lwork</b> <b>)</b> <b>work,</b> <b>integer</b> <b>lwork,</b>
       <b>integer</b> <b>info)</b>
       <b>DGESVJ</b>

       <b>Purpose:</b>

            DGESVJ computes the singular value decomposition (SVD) of a real
            M-by-N matrix A, where M &gt;= N. The SVD of A is written as
                                               [++]   [xx]   [x0]   [xx]
                         A = U * SIGMA * V^t,  [++] = [xx] * [ox] * [xx]
                                               [++]   [xx]
            where SIGMA is an N-by-N diagonal matrix, U is an M-by-N orthonormal
            matrix, and V is an N-by-N orthogonal matrix. The diagonal elements
            of SIGMA are the singular values of A. The columns of U and V are the
            left and the right singular vectors of A, respectively.
            DGESVJ can sometimes compute tiny singular values and their singular vectors much
            more accurately than other SVD routines, see below under Further Details.

       <b>Parameters</b>
           <u>JOBA</u>

                     JOBA is CHARACTER*1
                     Specifies the structure of A.
                     = 'L': The input matrix A is lower triangular;
                     = 'U': The input matrix A is upper triangular;
                     = 'G': The input matrix A is general M-by-N matrix, M &gt;= N.

           <u>JOBU</u>

                     JOBU is CHARACTER*1
                     Specifies whether to compute the left singular vectors
                     (columns of U):
                     = 'U': The left singular vectors corresponding to the nonzero
                            singular values are computed and returned in the leading
                            columns of A. See more details in the description of A.
                            The default numerical orthogonality threshold is set to
                            approximately TOL=CTOL*EPS, CTOL=DSQRT(M), EPS=DLAMCH('E').
                     = 'C': Analogous to JOBU='U', except that user can control the
                            level of numerical orthogonality of the computed left
                            singular vectors. TOL can be set to TOL = CTOL*EPS, where
                            CTOL is given on input in the array WORK.
                            No CTOL smaller than ONE is allowed. CTOL greater
                            than 1 / EPS is meaningless. The option 'C'
                            can be used if M*EPS is satisfactory orthogonality
                            of the computed left singular vectors, so CTOL=M could
                            save few sweeps of Jacobi rotations.
                            See the descriptions of A and <a href="../man1/WORK.1.html">WORK</a>(1).
                     = 'N': The matrix U is not computed. However, see the
                            description of A.

           <u>JOBV</u>

                     JOBV is CHARACTER*1
                     Specifies whether to compute the right singular vectors, that
                     is, the matrix V:
                     = 'V':  the matrix V is computed and returned in the array V
                     = 'A':  the Jacobi rotations are applied to the MV-by-N
                             array V. In other words, the right singular vector
                             matrix V is not computed explicitly, instead it is
                             applied to an MV-by-N matrix initially stored in the
                             first MV rows of V.
                     = 'N':  the matrix V is not computed and the array V is not
                             referenced

           <u>M</u>

                     M is INTEGER
                     The number of rows of the input matrix A. 1/DLAMCH('E') &gt; M &gt;= 0.

           <u>N</u>

                     N is INTEGER
                     The number of columns of the input matrix A.
                     M &gt;= N &gt;= 0.

           <u>A</u>

                     A is DOUBLE PRECISION array, dimension (LDA,N)
                     On entry, the M-by-N matrix A.
                     On exit :
                     If JOBU = 'U' .OR. JOBU = 'C' :
                            If INFO = 0 :
                            RANKA orthonormal columns of U are returned in the
                            leading RANKA columns of the array A. Here RANKA &lt;= N
                            is the number of computed singular values of A that are
                            above the underflow threshold DLAMCH('S'). The singular
                            vectors corresponding to underflowed or zero singular
                            values are not computed. The value of RANKA is returned
                            in the array WORK as RANKA=NINT(<a href="../man2/WORK.2.html">WORK</a>(2)). Also see the
                            descriptions of SVA and WORK. The computed columns of U
                            are mutually numerically orthogonal up to approximately
                            TOL=DSQRT(M)*EPS (default); or TOL=CTOL*EPS (JOBU = 'C'),
                            see the description of JOBU.
                            If INFO &gt; 0 :
                            the procedure DGESVJ did not converge in the given number
                            of iterations (sweeps). In that case, the computed
                            columns of U may not be orthogonal up to TOL. The output
                            U (stored in A), SIGMA (given by the computed singular
                            values in SVA(1:N)) and V is still a decomposition of the
                            input matrix A in the sense that the residual
                            ||A-SCALE*U*SIGMA*V^T||_2 / ||A||_2 is small.

                     If JOBU = 'N' :
                            If INFO = 0 :
                            Note that the left singular vectors are 'for free' in the
                            one-sided Jacobi SVD algorithm. However, if only the
                            singular values are needed, the level of numerical
                            orthogonality of U is not an issue and iterations are
                            stopped when the columns of the iterated matrix are
                            numerically orthogonal up to approximately M*EPS. Thus,
                            on exit, A contains the columns of U scaled with the
                            corresponding singular values.
                            If INFO &gt; 0 :
                            the procedure DGESVJ did not converge in the given number
                            of iterations (sweeps).

           <u>LDA</u>

                     LDA is INTEGER
                     The leading dimension of the array A.  LDA &gt;= max(1,M).

           <u>SVA</u>

                     SVA is DOUBLE PRECISION array, dimension (N)
                     On exit :
                     If INFO = 0 :
                     depending on the value SCALE = <a href="../man1/WORK.1.html">WORK</a>(1), we have:
                            If SCALE = ONE :
                            SVA(1:N) contains the computed singular values of A.
                            During the computation SVA contains the Euclidean column
                            norms of the iterated matrices in the array A.
                            If SCALE .NE. ONE :
                            The singular values of A are SCALE*SVA(1:N), and this
                            factored representation is due to the fact that some of the
                            singular values of A might underflow or overflow.
                     If INFO &gt; 0 :
                     the procedure DGESVJ did not converge in the given number of
                     iterations (sweeps) and SCALE*SVA(1:N) may not be accurate.

           <u>MV</u>

                     MV is INTEGER
                     If JOBV = 'A', then the product of Jacobi rotations in DGESVJ
                     is applied to the first MV rows of V. See the description of JOBV.

           <u>V</u>

                     V is DOUBLE PRECISION array, dimension (LDV,N)
                     If JOBV = 'V', then V contains on exit the N-by-N matrix of
                                    the right singular vectors;
                     If JOBV = 'A', then V contains the product of the computed right
                                    singular vector matrix and the initial matrix in
                                    the array V.
                     If JOBV = 'N', then V is not referenced.

           <u>LDV</u>

                     LDV is INTEGER
                     The leading dimension of the array V, LDV &gt;= 1.
                     If JOBV = 'V', then LDV &gt;= max(1,N).
                     If JOBV = 'A', then LDV &gt;= max(1,MV) .

           <u>WORK</u>

                     WORK is DOUBLE PRECISION array, dimension (MAX(1,LWORK))
                     On entry :
                     If JOBU = 'C' :
                     <a href="../man1/WORK.1.html">WORK</a>(1) = CTOL, where CTOL defines the threshold for convergence.
                               The process stops if all columns of A are mutually
                               orthogonal up to CTOL*EPS, EPS=DLAMCH('E').
                               It is required that CTOL &gt;= ONE, i.e. it is not
                               allowed to force the routine to obtain orthogonality
                               below EPS.
                     On exit :
                     <a href="../man1/WORK.1.html">WORK</a>(1) = SCALE is the scaling factor such that SCALE*SVA(1:N)
                               are the computed singular values of A.
                               (See description of SVA().)
                     <a href="../man2/WORK.2.html">WORK</a>(2) = NINT(<a href="../man2/WORK.2.html">WORK</a>(2)) is the number of the computed nonzero
                               singular values.
                     <a href="../man3/WORK.3.html">WORK</a>(3) = NINT(<a href="../man3/WORK.3.html">WORK</a>(3)) is the number of the computed singular
                               values that are larger than the underflow threshold.
                     <a href="../man4/WORK.4.html">WORK</a>(4) = NINT(<a href="../man4/WORK.4.html">WORK</a>(4)) is the number of sweeps of Jacobi
                               rotations needed for numerical convergence.
                     <a href="../man5/WORK.5.html">WORK</a>(5) = max_{i.NE.j} |COS(A(:,i),A(:,j))| in the last sweep.
                               This is useful information in cases when DGESVJ did
                               not converge, as it can be used to estimate whether
                               the output is still useful and for post festum analysis.
                     <a href="../man6/WORK.6.html">WORK</a>(6) = the largest absolute value over all sines of the
                               Jacobi rotation angles in the last sweep. It can be
                               useful for a post festum analysis.

           <u>LWORK</u>

                     LWORK is INTEGER
                     The length of the array WORK.
                     LWORK &gt;= 1, if MIN(M,N) = 0, and LWORK &gt;= MAX(6,M+N), otherwise.

                     If on entry LWORK = -1, then a workspace query is assumed and
                     no computation is done; <a href="../man1/WORK.1.html">WORK</a>(1) is set to the minial (and optimal)
                     length of WORK.

           <u>INFO</u>

                     INFO is INTEGER
                     = 0:  successful exit.
                     &lt; 0:  if INFO = -i, then the i-th argument had an illegal value
                     &gt; 0:  DGESVJ did not converge in the maximal allowed number (30)
                           of sweeps. The output may still be useful. See the
                           description of WORK.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

             The orthogonal N-by-N matrix V is obtained as a product of Jacobi plane
             rotations. The rotations are implemented as fast scaled rotations of
             Anda and Park [1]. In the case of underflow of the Jacobi angle, a
             modified Jacobi transformation of Drmac [4] is used. Pivot strategy uses
             column interchanges of de Rijk [2]. The relative accuracy of the computed
             singular values and the accuracy of the computed singular vectors (in
             angle metric) is as guaranteed by the theory of Demmel and Veselic [3].
             The condition number that determines the accuracy in the full rank case
             is essentially min_{D=diag} kappa(A*D), where kappa(.) is the
             spectral condition number. The best performance of this Jacobi SVD
             procedure is achieved if used in an  accelerated version of Drmac and
             Veselic [5,6], and it is the kernel routine in the SIGMA library [7].
             Some tuning parameters (marked with [TP]) are available for the
             implementer.
             The computational range for the nonzero singular values is the  machine
             number interval ( UNDERFLOW , OVERFLOW ). In extreme cases, even
             denormalized singular values can be computed with the corresponding
             gradual loss of accurate digits.

       <b>Contributors:</b>

             ============

             Zlatko Drmac (Zagreb, Croatia) and Kresimir Veselic (Hagen, Germany)

       <b>References:</b>

            [1] A. A. Anda and H. Park: Fast plane rotations with dynamic scaling.
                SIAM J. matrix Anal. Appl., Vol. 15 (1994), pp. 162-174.
            [2] P. P. M. De Rijk: A one-sided Jacobi algorithm for computing the
                singular value decomposition on a vector computer.
                SIAM J. Sci. Stat. Comp., Vol. 10 (1998), pp. 359-371.
            [3] J. Demmel and K. Veselic: Jacobi method is more accurate than QR.
            [4] Z. Drmac: Implementation of Jacobi rotations for accurate singular
                value computation in floating point arithmetic.
                SIAM J. Sci. Comp., Vol. 18 (1997), pp. 1200-1222.
            [5] Z. Drmac and K. Veselic: New fast and accurate Jacobi SVD algorithm I.
                SIAM J. Matrix Anal. Appl. Vol. 35, No. 2 (2008), pp. 1322-1342.
                LAPACK Working note 169.
            [6] Z. Drmac and K. Veselic: New fast and accurate Jacobi SVD algorithm II.
                SIAM J. Matrix Anal. Appl. Vol. 35, No. 2 (2008), pp. 1343-1362.
                LAPACK Working note 170.
            [7] Z. Drmac: SIGMA - mathematical software library for accurate SVD, PSV,
                QSVD, (H,K)-SVD computations.
                Department of Mathematics, University of Zagreb, 2008.

       <b>Bugs,</b> <b>examples</b> <b>and</b> <b>comments:</b>

             ===========================
             Please report all bugs and send interesting test examples and comments to
             <a href="mailto:drmac@math.hr">drmac@math.hr</a>. Thank you.

   <b>subroutine</b> <b>sgesvj</b> <b>(character*1</b> <b>joba,</b> <b>character*1</b> <b>jobu,</b> <b>character*1</b> <b>jobv,</b> <b>integer</b> <b>m,</b> <b>integer</b> <b>n,</b> <b>real,</b>
       <b>dimension(</b> <b>lda,</b> <b>*</b> <b>)</b> <b>a,</b> <b>integer</b> <b>lda,</b> <b>real,</b> <b>dimension(</b> <b>n</b> <b>)</b> <b>sva,</b> <b>integer</b> <b>mv,</b> <b>real,</b> <b>dimension(</b> <b>ldv,</b> <b>*</b> <b>)</b> <b>v,</b>
       <b>integer</b> <b>ldv,</b> <b>real,</b> <b>dimension(</b> <b>lwork</b> <b>)</b> <b>work,</b> <b>integer</b> <b>lwork,</b> <b>integer</b> <b>info)</b>
       <b>SGESVJ</b>

       <b>Purpose:</b>

            SGESVJ computes the singular value decomposition (SVD) of a real
            M-by-N matrix A, where M &gt;= N. The SVD of A is written as
                                               [++]   [xx]   [x0]   [xx]
                         A = U * SIGMA * V^t,  [++] = [xx] * [ox] * [xx]
                                               [++]   [xx]
            where SIGMA is an N-by-N diagonal matrix, U is an M-by-N orthonormal
            matrix, and V is an N-by-N orthogonal matrix. The diagonal elements
            of SIGMA are the singular values of A. The columns of U and V are the
            left and the right singular vectors of A, respectively.
            SGESVJ can sometimes compute tiny singular values and their singular vectors much
            more accurately than other SVD routines, see below under Further Details.

       <b>Parameters</b>
           <u>JOBA</u>

                     JOBA is CHARACTER*1
                     Specifies the structure of A.
                     = 'L': The input matrix A is lower triangular;
                     = 'U': The input matrix A is upper triangular;
                     = 'G': The input matrix A is general M-by-N matrix, M &gt;= N.

           <u>JOBU</u>

                     JOBU is CHARACTER*1
                     Specifies whether to compute the left singular vectors
                     (columns of U):
                     = 'U': The left singular vectors corresponding to the nonzero
                            singular values are computed and returned in the leading
                            columns of A. See more details in the description of A.
                            The default numerical orthogonality threshold is set to
                            approximately TOL=CTOL*EPS, CTOL=SQRT(M), EPS=SLAMCH('E').
                     = 'C': Analogous to JOBU='U', except that user can control the
                            level of numerical orthogonality of the computed left
                            singular vectors. TOL can be set to TOL = CTOL*EPS, where
                            CTOL is given on input in the array WORK.
                            No CTOL smaller than ONE is allowed. CTOL greater
                            than 1 / EPS is meaningless. The option 'C'
                            can be used if M*EPS is satisfactory orthogonality
                            of the computed left singular vectors, so CTOL=M could
                            save few sweeps of Jacobi rotations.
                            See the descriptions of A and <a href="../man1/WORK.1.html">WORK</a>(1).
                     = 'N': The matrix U is not computed. However, see the
                            description of A.

           <u>JOBV</u>

                     JOBV is CHARACTER*1
                     Specifies whether to compute the right singular vectors, that
                     is, the matrix V:
                     = 'V':  the matrix V is computed and returned in the array V
                     = 'A':  the Jacobi rotations are applied to the MV-by-N
                             array V. In other words, the right singular vector
                             matrix V is not computed explicitly; instead it is
                             applied to an MV-by-N matrix initially stored in the
                             first MV rows of V.
                     = 'N':  the matrix V is not computed and the array V is not
                             referenced

           <u>M</u>

                     M is INTEGER
                     The number of rows of the input matrix A. 1/SLAMCH('E') &gt; M &gt;= 0.

           <u>N</u>

                     N is INTEGER
                     The number of columns of the input matrix A.
                     M &gt;= N &gt;= 0.

           <u>A</u>

                     A is REAL array, dimension (LDA,N)
                     On entry, the M-by-N matrix A.
                     On exit,
                     If JOBU = 'U' .OR. JOBU = 'C':
                            If INFO = 0:
                            RANKA orthonormal columns of U are returned in the
                            leading RANKA columns of the array A. Here RANKA &lt;= N
                            is the number of computed singular values of A that are
                            above the underflow threshold SLAMCH('S'). The singular
                            vectors corresponding to underflowed or zero singular
                            values are not computed. The value of RANKA is returned
                            in the array WORK as RANKA=NINT(<a href="../man2/WORK.2.html">WORK</a>(2)). Also see the
                            descriptions of SVA and WORK. The computed columns of U
                            are mutually numerically orthogonal up to approximately
                            TOL=SQRT(M)*EPS (default); or TOL=CTOL*EPS (JOBU = 'C'),
                            see the description of JOBU.
                            If INFO &gt; 0,
                            the procedure SGESVJ did not converge in the given number
                            of iterations (sweeps). In that case, the computed
                            columns of U may not be orthogonal up to TOL. The output
                            U (stored in A), SIGMA (given by the computed singular
                            values in SVA(1:N)) and V is still a decomposition of the
                            input matrix A in the sense that the residual
                            ||A-SCALE*U*SIGMA*V^T||_2 / ||A||_2 is small.
                     If JOBU = 'N':
                            If INFO = 0:
                            Note that the left singular vectors are 'for free' in the
                            one-sided Jacobi SVD algorithm. However, if only the
                            singular values are needed, the level of numerical
                            orthogonality of U is not an issue and iterations are
                            stopped when the columns of the iterated matrix are
                            numerically orthogonal up to approximately M*EPS. Thus,
                            on exit, A contains the columns of U scaled with the
                            corresponding singular values.
                            If INFO &gt; 0:
                            the procedure SGESVJ did not converge in the given number
                            of iterations (sweeps).

           <u>LDA</u>

                     LDA is INTEGER
                     The leading dimension of the array A.  LDA &gt;= max(1,M).

           <u>SVA</u>

                     SVA is REAL array, dimension (N)
                     On exit,
                     If INFO = 0 :
                     depending on the value SCALE = <a href="../man1/WORK.1.html">WORK</a>(1), we have:
                            If SCALE = ONE:
                            SVA(1:N) contains the computed singular values of A.
                            During the computation SVA contains the Euclidean column
                            norms of the iterated matrices in the array A.
                            If SCALE .NE. ONE:
                            The singular values of A are SCALE*SVA(1:N), and this
                            factored representation is due to the fact that some of the
                            singular values of A might underflow or overflow.

                     If INFO &gt; 0 :
                     the procedure SGESVJ did not converge in the given number of
                     iterations (sweeps) and SCALE*SVA(1:N) may not be accurate.

           <u>MV</u>

                     MV is INTEGER
                     If JOBV = 'A', then the product of Jacobi rotations in SGESVJ
                     is applied to the first MV rows of V. See the description of JOBV.

           <u>V</u>

                     V is REAL array, dimension (LDV,N)
                     If JOBV = 'V', then V contains on exit the N-by-N matrix of
                                    the right singular vectors;
                     If JOBV = 'A', then V contains the product of the computed right
                                    singular vector matrix and the initial matrix in
                                    the array V.
                     If JOBV = 'N', then V is not referenced.

           <u>LDV</u>

                     LDV is INTEGER
                     The leading dimension of the array V, LDV &gt;= 1.
                     If JOBV = 'V', then LDV &gt;= max(1,N).
                     If JOBV = 'A', then LDV &gt;= max(1,MV) .

           <u>WORK</u>

                     WORK is REAL array, dimension (MAX(1,LWORK))
                     On entry,
                     If JOBU = 'C' :
                     <a href="../man1/WORK.1.html">WORK</a>(1) = CTOL, where CTOL defines the threshold for convergence.
                               The process stops if all columns of A are mutually
                               orthogonal up to CTOL*EPS, EPS=SLAMCH('E').
                               It is required that CTOL &gt;= ONE, i.e. it is not
                               allowed to force the routine to obtain orthogonality
                               below EPSILON.
                     On exit,
                     <a href="../man1/WORK.1.html">WORK</a>(1) = SCALE is the scaling factor such that SCALE*SVA(1:N)
                               are the computed singular vcalues of A.
                               (See description of SVA().)
                     <a href="../man2/WORK.2.html">WORK</a>(2) = NINT(<a href="../man2/WORK.2.html">WORK</a>(2)) is the number of the computed nonzero
                               singular values.
                     <a href="../man3/WORK.3.html">WORK</a>(3) = NINT(<a href="../man3/WORK.3.html">WORK</a>(3)) is the number of the computed singular
                               values that are larger than the underflow threshold.
                     <a href="../man4/WORK.4.html">WORK</a>(4) = NINT(<a href="../man4/WORK.4.html">WORK</a>(4)) is the number of sweeps of Jacobi
                               rotations needed for numerical convergence.
                     <a href="../man5/WORK.5.html">WORK</a>(5) = max_{i.NE.j} |COS(A(:,i),A(:,j))| in the last sweep.
                               This is useful information in cases when SGESVJ did
                               not converge, as it can be used to estimate whether
                               the output is still useful and for post festum analysis.
                     <a href="../man6/WORK.6.html">WORK</a>(6) = the largest absolute value over all sines of the
                               Jacobi rotation angles in the last sweep. It can be
                               useful for a post festum analysis.

           <u>LWORK</u>

                     LWORK is INTEGER
                     Length of WORK.
                     LWORK &gt;= 1, if MIN(M,N) = 0, and LWORK &gt;= MAX(6,M+N), otherwise.

                     If on entry LWORK = -1, then a workspace query is assumed and
                     no computation is done; <a href="../man1/WORK.1.html">WORK</a>(1) is set to the minial (and optimal)
                     length of WORK.

           <u>INFO</u>

                     INFO is INTEGER
                     = 0:  successful exit.
                     &lt; 0:  if INFO = -i, then the i-th argument had an illegal value
                     &gt; 0:  SGESVJ did not converge in the maximal allowed number (30)
                           of sweeps. The output may still be useful. See the
                           description of WORK.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>
           The orthogonal N-by-N matrix V is obtained as a product of Jacobi plane rotations. The rotations are
           implemented as fast scaled rotations of Anda and Park [1]. In the case of underflow of the Jacobi
           angle, a modified Jacobi transformation of Drmac [4] is used. Pivot strategy uses column interchanges
           of de Rijk [2]. The relative accuracy of the computed singular values and the accuracy of the
           computed singular vectors (in angle metric) is as guaranteed by the theory of Demmel and Veselic [3].
           The condition number that determines the accuracy in the full rank case is essentially min_{D=diag}
           kappa(A*D), where kappa(.) is the spectral condition number. The best performance of this Jacobi SVD
           procedure is achieved if used in an accelerated version of Drmac and Veselic [5,6], and it is the
           kernel routine in the SIGMA library [7]. Some tuning parameters (marked with [TP]) are available for
           the implementer.
            The computational range for the nonzero singular values is the machine number interval ( UNDERFLOW ,
           OVERFLOW ). In extreme cases, even denormalized singular values can be computed with the
           corresponding gradual loss of accurate digits.

       <b>Contributors:</b>
           Zlatko Drmac (Zagreb, Croatia) and Kresimir Veselic (Hagen, Germany)

       <b>References:</b>
           [1] A. A. Anda and H. Park: Fast plane rotations with dynamic scaling.
            SIAM J. matrix Anal. Appl., Vol. 15 (1994), pp. 162-174.

            [2] P. P. M. De Rijk: A one-sided Jacobi algorithm for computing the singular value decomposition on
           a vector computer.
            SIAM J. Sci. Stat. Comp., Vol. 10 (1998), pp. 359-371.

            [3] J. Demmel and K. Veselic: Jacobi method is more accurate than QR.
            [4] Z. Drmac: Implementation of Jacobi rotations for accurate singular value computation in floating
           point arithmetic.
            SIAM J. Sci. Comp., Vol. 18 (1997), pp. 1200-1222.

            [5] Z. Drmac and K. Veselic: New fast and accurate Jacobi SVD algorithm I.
            SIAM J. Matrix Anal. Appl. Vol. 35, No. 2 (2008), pp. 1322-1342.
            LAPACK Working note 169.

            [6] Z. Drmac and K. Veselic: New fast and accurate Jacobi SVD algorithm II.
            SIAM J. Matrix Anal. Appl. Vol. 35, No. 2 (2008), pp. 1343-1362.
            LAPACK Working note 170.

            [7] Z. Drmac: SIGMA - mathematical software library for accurate SVD, PSV, QSVD, (H,K)-SVD
           computations.
            Department of Mathematics, University of Zagreb, 2008.

       <b>Bugs,</b> <b>Examples</b> <b>and</b> <b>Comments:</b>
           Please report all bugs and send interesting test examples and comments to <a href="mailto:drmac@math.hr">drmac@math.hr</a>. Thank you.

   <b>subroutine</b> <b>zgesvj</b> <b>(character*1</b> <b>joba,</b> <b>character*1</b> <b>jobu,</b> <b>character*1</b> <b>jobv,</b> <b>integer</b> <b>m,</b> <b>integer</b> <b>n,</b> <b>complex*16,</b>
       <b>dimension(</b> <b>lda,</b> <b>*</b> <b>)</b> <b>a,</b> <b>integer</b> <b>lda,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>n</b> <b>)</b> <b>sva,</b> <b>integer</b> <b>mv,</b> <b>complex*16,</b>
       <b>dimension(</b> <b>ldv,</b> <b>*</b> <b>)</b> <b>v,</b> <b>integer</b> <b>ldv,</b> <b>complex*16,</b> <b>dimension(</b> <b>lwork</b> <b>)</b> <b>cwork,</b> <b>integer</b> <b>lwork,</b> <b>double</b>
       <b>precision,</b> <b>dimension(</b> <b>lrwork</b> <b>)</b> <b>rwork,</b> <b>integer</b> <b>lrwork,</b> <b>integer</b> <b>info)</b>
        <b>ZGESVJ</b>

       <b>Purpose:</b>

            ZGESVJ computes the singular value decomposition (SVD) of a complex
            M-by-N matrix A, where M &gt;= N. The SVD of A is written as
                                               [++]   [xx]   [x0]   [xx]
                         A = U * SIGMA * V^*,  [++] = [xx] * [ox] * [xx]
                                               [++]   [xx]
            where SIGMA is an N-by-N diagonal matrix, U is an M-by-N orthonormal
            matrix, and V is an N-by-N unitary matrix. The diagonal elements
            of SIGMA are the singular values of A. The columns of U and V are the
            left and the right singular vectors of A, respectively.

       <b>Parameters</b>
           <u>JOBA</u>

                     JOBA is CHARACTER*1
                     Specifies the structure of A.
                     = 'L': The input matrix A is lower triangular;
                     = 'U': The input matrix A is upper triangular;
                     = 'G': The input matrix A is general M-by-N matrix, M &gt;= N.

           <u>JOBU</u>

                     JOBU is CHARACTER*1
                     Specifies whether to compute the left singular vectors
                     (columns of U):
                     = 'U' or 'F': The left singular vectors corresponding to the nonzero
                            singular values are computed and returned in the leading
                            columns of A. See more details in the description of A.
                            The default numerical orthogonality threshold is set to
                            approximately TOL=CTOL*EPS, CTOL=SQRT(M), EPS=DLAMCH('E').
                     = 'C': Analogous to JOBU='U', except that user can control the
                            level of numerical orthogonality of the computed left
                            singular vectors. TOL can be set to TOL = CTOL*EPS, where
                            CTOL is given on input in the array WORK.
                            No CTOL smaller than ONE is allowed. CTOL greater
                            than 1 / EPS is meaningless. The option 'C'
                            can be used if M*EPS is satisfactory orthogonality
                            of the computed left singular vectors, so CTOL=M could
                            save few sweeps of Jacobi rotations.
                            See the descriptions of A and <a href="../man1/WORK.1.html">WORK</a>(1).
                     = 'N': The matrix U is not computed. However, see the
                            description of A.

           <u>JOBV</u>

                     JOBV is CHARACTER*1
                     Specifies whether to compute the right singular vectors, that
                     is, the matrix V:
                     = 'V' or 'J': the matrix V is computed and returned in the array V
                     = 'A':  the Jacobi rotations are applied to the MV-by-N
                             array V. In other words, the right singular vector
                             matrix V is not computed explicitly; instead it is
                             applied to an MV-by-N matrix initially stored in the
                             first MV rows of V.
                     = 'N':  the matrix V is not computed and the array V is not
                             referenced

           <u>M</u>

                     M is INTEGER
                     The number of rows of the input matrix A. 1/DLAMCH('E') &gt; M &gt;= 0.

           <u>N</u>

                     N is INTEGER
                     The number of columns of the input matrix A.
                     M &gt;= N &gt;= 0.

           <u>A</u>

                     A is COMPLEX*16 array, dimension (LDA,N)
                     On entry, the M-by-N matrix A.
                     On exit,
                     If JOBU = 'U' .OR. JOBU = 'C':
                            If INFO = 0 :
                            RANKA orthonormal columns of U are returned in the
                            leading RANKA columns of the array A. Here RANKA &lt;= N
                            is the number of computed singular values of A that are
                            above the underflow threshold DLAMCH('S'). The singular
                            vectors corresponding to underflowed or zero singular
                            values are not computed. The value of RANKA is returned
                            in the array RWORK as RANKA=NINT(<a href="../man2/RWORK.2.html">RWORK</a>(2)). Also see the
                            descriptions of SVA and RWORK. The computed columns of U
                            are mutually numerically orthogonal up to approximately
                            TOL=SQRT(M)*EPS (default); or TOL=CTOL*EPS (JOBU = 'C'),
                            see the description of JOBU.
                            If INFO &gt; 0,
                            the procedure ZGESVJ did not converge in the given number
                            of iterations (sweeps). In that case, the computed
                            columns of U may not be orthogonal up to TOL. The output
                            U (stored in A), SIGMA (given by the computed singular
                            values in SVA(1:N)) and V is still a decomposition of the
                            input matrix A in the sense that the residual
                            || A - SCALE * U * SIGMA * V^* ||_2 / ||A||_2 is small.
                     If JOBU = 'N':
                            If INFO = 0 :
                            Note that the left singular vectors are 'for free' in the
                            one-sided Jacobi SVD algorithm. However, if only the
                            singular values are needed, the level of numerical
                            orthogonality of U is not an issue and iterations are
                            stopped when the columns of the iterated matrix are
                            numerically orthogonal up to approximately M*EPS. Thus,
                            on exit, A contains the columns of U scaled with the
                            corresponding singular values.
                            If INFO &gt; 0:
                            the procedure ZGESVJ did not converge in the given number
                            of iterations (sweeps).

           <u>LDA</u>

                     LDA is INTEGER
                     The leading dimension of the array A.  LDA &gt;= max(1,M).

           <u>SVA</u>

                     SVA is DOUBLE PRECISION array, dimension (N)
                     On exit,
                     If INFO = 0 :
                     depending on the value SCALE = <a href="../man1/RWORK.1.html">RWORK</a>(1), we have:
                            If SCALE = ONE:
                            SVA(1:N) contains the computed singular values of A.
                            During the computation SVA contains the Euclidean column
                            norms of the iterated matrices in the array A.
                            If SCALE .NE. ONE:
                            The singular values of A are SCALE*SVA(1:N), and this
                            factored representation is due to the fact that some of the
                            singular values of A might underflow or overflow.

                     If INFO &gt; 0:
                     the procedure ZGESVJ did not converge in the given number of
                     iterations (sweeps) and SCALE*SVA(1:N) may not be accurate.

           <u>MV</u>

                     MV is INTEGER
                     If JOBV = 'A', then the product of Jacobi rotations in ZGESVJ
                     is applied to the first MV rows of V. See the description of JOBV.

           <u>V</u>

                     V is COMPLEX*16 array, dimension (LDV,N)
                     If JOBV = 'V', then V contains on exit the N-by-N matrix of
                                    the right singular vectors;
                     If JOBV = 'A', then V contains the product of the computed right
                                    singular vector matrix and the initial matrix in
                                    the array V.
                     If JOBV = 'N', then V is not referenced.

           <u>LDV</u>

                     LDV is INTEGER
                     The leading dimension of the array V, LDV &gt;= 1.
                     If JOBV = 'V', then LDV &gt;= MAX(1,N).
                     If JOBV = 'A', then LDV &gt;= MAX(1,MV) .

           <u>CWORK</u>

                     CWORK is COMPLEX*16 array, dimension (MAX(1,LWORK))
                     Used as workspace.

           <u>LWORK</u>

                     LWORK is INTEGER.
                     Length of CWORK.
                     LWORK &gt;= 1, if MIN(M,N) = 0, and LWORK &gt;= M+N, otherwise.

                     If on entry LWORK = -1, then a workspace query is assumed and
                     no computation is done; <a href="../man1/CWORK.1.html">CWORK</a>(1) is set to the minial (and optimal)
                     length of CWORK.

           <u>RWORK</u>

                     RWORK is DOUBLE PRECISION array, dimension (max(6,LRWORK))
                     On entry,
                     If JOBU = 'C' :
                     <a href="../man1/RWORK.1.html">RWORK</a>(1) = CTOL, where CTOL defines the threshold for convergence.
                               The process stops if all columns of A are mutually
                               orthogonal up to CTOL*EPS, EPS=DLAMCH('E').
                               It is required that CTOL &gt;= ONE, i.e. it is not
                               allowed to force the routine to obtain orthogonality
                               below EPSILON.
                     On exit,
                     <a href="../man1/RWORK.1.html">RWORK</a>(1) = SCALE is the scaling factor such that SCALE*SVA(1:N)
                               are the computed singular values of A.
                               (See description of SVA().)
                     <a href="../man2/RWORK.2.html">RWORK</a>(2) = NINT(<a href="../man2/RWORK.2.html">RWORK</a>(2)) is the number of the computed nonzero
                               singular values.
                     <a href="../man3/RWORK.3.html">RWORK</a>(3) = NINT(<a href="../man3/RWORK.3.html">RWORK</a>(3)) is the number of the computed singular
                               values that are larger than the underflow threshold.
                     <a href="../man4/RWORK.4.html">RWORK</a>(4) = NINT(<a href="../man4/RWORK.4.html">RWORK</a>(4)) is the number of sweeps of Jacobi
                               rotations needed for numerical convergence.
                     <a href="../man5/RWORK.5.html">RWORK</a>(5) = max_{i.NE.j} |COS(A(:,i),A(:,j))| in the last sweep.
                               This is useful information in cases when ZGESVJ did
                               not converge, as it can be used to estimate whether
                               the output is still useful and for post festum analysis.
                     <a href="../man6/RWORK.6.html">RWORK</a>(6) = the largest absolute value over all sines of the
                               Jacobi rotation angles in the last sweep. It can be
                               useful for a post festum analysis.

           <u>LRWORK</u>

                    LRWORK is INTEGER
                    Length of RWORK.
                    LRWORK &gt;= 1, if MIN(M,N) = 0, and LRWORK &gt;= MAX(6,N), otherwise.

                    If on entry LRWORK = -1, then a workspace query is assumed and
                    no computation is done; <a href="../man1/RWORK.1.html">RWORK</a>(1) is set to the minial (and optimal)
                    length of RWORK.

           <u>INFO</u>

                     INFO is INTEGER
                     = 0:  successful exit.
                     &lt; 0:  if INFO = -i, then the i-th argument had an illegal value
                     &gt; 0:  ZGESVJ did not converge in the maximal allowed number
                           (NSWEEP=30) of sweeps. The output may still be useful.
                           See the description of RWORK.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

            The orthogonal N-by-N matrix V is obtained as a product of Jacobi plane
            rotations. In the case of underflow of the tangent of the Jacobi angle, a
            modified Jacobi transformation of Drmac [3] is used. Pivot strategy uses
            column interchanges of de Rijk [1]. The relative accuracy of the computed
            singular values and the accuracy of the computed singular vectors (in
            angle metric) is as guaranteed by the theory of Demmel and Veselic [2].
            The condition number that determines the accuracy in the full rank case
            is essentially min_{D=diag} kappa(A*D), where kappa(.) is the
            spectral condition number. The best performance of this Jacobi SVD
            procedure is achieved if used in an  accelerated version of Drmac and
            Veselic [4,5], and it is the kernel routine in the SIGMA library [6].
            Some tuning parameters (marked with [TP]) are available for the
            implementer.
            The computational range for the nonzero singular values is the  machine
            number interval ( UNDERFLOW , OVERFLOW ). In extreme cases, even
            denormalized singular values can be computed with the corresponding
            gradual loss of accurate digits.

       <b>Contributor:</b>

             ============

             Zlatko Drmac (Zagreb, Croatia)

       <b>References:</b>

            [1] P. P. M. De Rijk: A one-sided Jacobi algorithm for computing the
               singular value decomposition on a vector computer.
               SIAM J. Sci. Stat. Comp., Vol. 10 (1998), pp. 359-371.
            [2] J. Demmel and K. Veselic: Jacobi method is more accurate than QR.
            [3] Z. Drmac: Implementation of Jacobi rotations for accurate singular
               value computation in floating point arithmetic.
               SIAM J. Sci. Comp., Vol. 18 (1997), pp. 1200-1222.
            [4] Z. Drmac and K. Veselic: New fast and accurate Jacobi SVD algorithm I.
               SIAM J. Matrix Anal. Appl. Vol. 35, No. 2 (2008), pp. 1322-1342.
               LAPACK Working note 169.
            [5] Z. Drmac and K. Veselic: New fast and accurate Jacobi SVD algorithm II.
               SIAM J. Matrix Anal. Appl. Vol. 35, No. 2 (2008), pp. 1343-1362.
               LAPACK Working note 170.
            [6] Z. Drmac: SIGMA - mathematical software library for accurate SVD, PSV,
               QSVD, (H,K)-SVD computations.
               Department of Mathematics, University of Zagreb, 2008, 2015.

       <b>Bugs,</b> <b>examples</b> <b>and</b> <b>comments:</b>

             ===========================
             Please report all bugs and send interesting test examples and comments to
             <a href="mailto:drmac@math.hr">drmac@math.hr</a>. Thank you.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for LAPACK from the source code.

Version 3.12.0                              Sun Jul 20 2025 01:40:05                                    <u><a href="../man3/gesvj.3.html">gesvj</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>