<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hal_port - a HAL pin type that acts as an asynchronous one way byte stream</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/linuxcnc-uspace-dev">linuxcnc-uspace-dev_2.9.4-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       hal_port - a HAL pin type that acts as an asynchronous one way byte stream

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>#include</b> <b>&lt;hal.h&gt;</b>

   bool hal_port_read(hal_port_t port, char* dest, unsigned count);
   bool hal_port_peek(hal_port_t port, char* dest, unsigned count);
   bool hal_port_peek_commit(hal_port_t port, unsigned count);
   unsigned hal_port_readable(hal_port_t port);
   void hal_port_clear(hal_port_t port);

   bool hal_port_write(hal_port_t port, const char* src, unsigned count);
   unsigned hal_port_writable(hal_port_t port);

   unsigned hal_port_buffer_size(hal_port_t port);

   <b>#ifdef</b> <b>ULAPI</b>
   void hal_port_wait_readable(hal_port_t **port, unsigned count, sig_atomic_t *stop);
   void hal_port_wait_writable(hal_port_t **port, unsigned count, sig_atomic_t *stop);
   <b>#endif</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A  HAL  port  pin  is a HAL pin that acts as a one way byte oriented data stream in real-time.  An output
       port on any component may be connected to an input port on  any  other  component  via  a  signal.   Data
       written  on the output pin becomes accessible to the input pin.  A HAL port signal may link only a single
       writer and a single reader.

       A port also buffers data. Users should determine  the  proper  buffer  size  based  upon  their  intended
       application.

   <b>hal_port_read</b>
       Reads count bytes from the port into destination buffer dest.  hal_port_read will read <u>count</u> bytes if and
       only  if  <u>count</u> bytes are available for reading and otherwise it will leave the port unaffected.  Returns
       true if count bytes were read and false otherwise.  This function should only be called by the  component
       that owns the IN PORT pin.

   <b>hal_port_peek</b>
       Behaves  the  same as hal_port_read, however it does not consume bytes from the HAL port.  Repeated calls
       to hal_port_peek will return the same data.  Returns true if count bytes were read and  false  otherwise.
       This function should only be called by the component that owns the IN PORT pin.

   <b>hal_port_peek_commit</b>
       Advances  the  read  position  in  the  port  buffer  by  count  bytes.   A  hal_port_peek  followed by a
       hal_port_peek_commit would function equivalently to hal_port_read given the same  count  value.   Returns
       true if count readable bytes were skipped and are no longer accessible and false if no bytes wer skipped.
       This function should only be called by the component that owns the IN PORT pin.

   <b>hal_port_readable</b>
       Returns  the  number  of bytes available for reading from port. It is safe to call this function from any
       component.

   <b>hal_port_clear</b>
       Emptys a given port of all data.  hal_port_clear should only be called by the component that owns the  IN
       PORT pin.

   <b>hal_port_write</b>
       Writes count bytes from src into the port.  Returns true if count bytes were written and false otherwise.
       This function should only be called by the component that owns the OUT PORT pin.

   <b>hal_port_writable</b>
       Returns the number of bytes that can be written into the port.  It is safe to call this function from any
       component.

   <b>hal_port_buffer_size</b>
       Returns  the  maximum  number of bytes that a port can buffer.  It is safe to call this function from any
       component.

   <b>hal_port_wait_readable</b>
       Waits until the port has count bytes or more available for reading or the stop flag is set.

   <b>hal_port_wait_writable</b>
       Waits until the port has count bytes or more available for writing or the stop flag is set.

</pre><h4><b>ARGUMENTS</b></h4><pre>
       <b>hal_port_t</b>
              A handle to a port object. Created by hal_pin_new

       <b>dest</b>   An array of bytes that hal_port_read and hal_port_peek will copy data into. This must be allocated
              by the caller and be at least count bytes long.

       <b>count</b>  The number of bytes that hal_port_read, hal_port_peek, and hal_port_write will copy in to dest  or
              out from src

       <b>src</b>    An  array  of  bytes that hal_port_write will copy data from into the port buffer. This must be of
              size count bytes or larger.

       <b>stop</b>   A pointer to a value which is monitored while waiting.  If  it  is  nonzero,  the  wait  operation
              returns early.  This allows a wait call to be safely terminated in the case of a signal.

</pre><h4><b>SAMPLE</b> <b>CODE</b></h4><pre>
       In the source tree under
        src/hal/components/raster.comp is a realtime component intended for laser control.
        src/tests/raster is a test program that also programs the raster component from python.

</pre><h4><b>REALTIME</b> <b>CONSIDERATIONS</b></h4><pre>
       <b>hal_port_read</b>,  <b>hal_port_peek</b>,  <b>hal_port_peek_commit</b>,  <b>hal_port_readable</b>, <b>hal_port_clear</b>, <b>hal_port_write</b>,
       <b>hal_port_writable</b>, <b>hal_port_buffer_size</b> may be called from realtime code.

       <b>hal_port_wait_writable</b>, <b>hal_port_wait_readable</b> may be called from ULAPI code.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man9/raster.9.html">raster</a></b>(9),

LinuxCNC Documentation                             2006-10-12                                     <u><a href="../man3hal/hal_port.3hal.html">hal_port</a></u>(3hal)
</pre>
 </div>
</div></section>
</div>
</body>
</html>