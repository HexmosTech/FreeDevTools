<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>avr_sleep - <avr/sleep.h>: Power Management and Sleep Modes</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/avr-libc">avr-libc_2.2.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       avr_sleep - &lt;avr/sleep.h&gt;: Power Management and Sleep Modes

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Functions</b>
       void <b>sleep_enable</b> (void)
       void <b>sleep_disable</b> (void)
       void <b>sleep_cpu</b> (void)
       void <b>sleep_mode</b> (void)
       void <b>sleep_bod_disable</b> (void)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>void</b> <b>sleep_bod_disable</b> <b>(void)</b> <b>[extern]</b>
       Disable BOD before going to sleep. Not available on all devices.

   <b>void</b> <b>sleep_cpu</b> <b>(void)</b> <b>[extern]</b>
       Put the device into sleep mode. The SE bit must be set beforehand, and it is recommended to clear it
       afterwards.

   <b>void</b> <b>sleep_disable</b> <b>(void)</b> <b>[extern]</b>
       Clear the SE (sleep enable) bit.

   <b>void</b> <b>sleep_enable</b> <b>(void)</b> <b>[extern]</b>
       #include &lt;avr/sleep.h&gt;

       Use of the SLEEP instruction can allow an application to reduce its power comsumption considerably. AVR
       devices can be put into different sleep modes. Refer to the datasheet for the details relating to the
       device you are using.

       There are several macros provided in this header file to actually put the device into sleep mode. The
       simplest way is to optionally set the desired sleep mode using set_sleep_mode() (it usually defaults to
       idle mode where the CPU is put on sleep but all peripheral clocks are still running), and then call
       <b>sleep_mode().</b> <b>This</b> <b>macro</b> <b>automatically</b> <b>sets</b> <b>the</b> <b>sleep</b> <b>enable</b> <b>bit,</b> <b>goes</b> <b>to</b> <b>sleep,</b> <b>and</b> <b>clears</b> <b>the</b> <b>sleep</b>
       <b>enable</b> <b>bit.</b>

       Example:

       #include &lt;avr/sleep.h&gt;

       ...
         set_sleep_mode(&lt;mode&gt;);
         sleep_mode();

       Note that unless your purpose is to completely lock the CPU (until a hardware reset), interrupts need to
       be enabled before going to sleep.

       As the <b>sleep_mode()</b> <b>macro</b> <b>might</b> <b>cause</b> <b>race</b> <b>conditions</b> <b>in</b> <b>some</b> <b>situations,</b> <b>the</b> <b>individual</b> <b>steps</b> <b>of</b>
       <b>manipulating</b> <b>the</b> <b>sleep</b> <b>enable</b> <b>(SE)</b> <b>bit,</b> <b>and</b> <b>actually</b> <b>issuing</b> <b>the</b> <b>SLEEP</b> <b>instruction,</b> <b>are</b> <b>provided</b> <b>in</b> <b>the</b>
       <b>macros</b> <b>sleep_enable(),</b> <b>sleep_disable(),</b> <b>and</b> <b>sleep_cpu().</b> <b>This</b> <b>also</b> <b>allows</b> <b>for</b> <b>test-and-sleep</b> <b>scenarios</b>
       <b>that</b> <b>take</b> <b>care</b> <b>of</b> <b>not</b> <b>missing</b> <b>the</b> <b>interrupt</b> <b>that</b> <b>will</b> <b>awake</b> <b>the</b> <b>device</b> <b>from</b> <b>sleep.</b>

       Example:

       #include &lt;avr/interrupt.h&gt;
       #include &lt;avr/sleep.h&gt;

       ...
         set_sleep_mode(&lt;mode&gt;);
         cli();
         if (some_condition)
         {
           sleep_enable();
           sei();
           sleep_cpu();
           sleep_disable();
         }
         sei();

       This sequence ensures an atomic test of some_condition with interrupts being disabled. If the condition
       is met, sleep mode will be prepared, and the SLEEP instruction will be scheduled immediately after an SEI
       instruction. As the intruction right after the SEI is guaranteed to be executed before an interrupt could
       trigger, it is sure the device will really be put to sleep.

       Some devices have the ability to disable the Brown Out Detector (BOD) before going to sleep. This will
       also reduce power while sleeping. If the specific AVR device has this ability then an additional macro is
       defined: <b>sleep_bod_disable().</b> <b>This</b> <b>macro</b> <b>generates</b> <b>inlined</b> <b>assembly</b> <b>code</b> <b>that</b> <b>will</b> <b>correctly</b> <b>implement</b>
       <b>the</b> <b>timed</b> <b>sequence</b> <b>for</b> <b>disabling</b> <b>the</b> <b>BOD</b> <b>before</b> <b>sleeping.</b> <b>However,</b> <b>there</b> <b>is</b> <b>a</b> <b>limited</b> <b>number</b> <b>of</b> <b>cycles</b>
       <b>after</b> <b>the</b> <b>BOD</b> <b>has</b> <b>been</b> <b>disabled</b> <b>that</b> <b>the</b> <b>device</b> <b>can</b> <b>be</b> <b>put</b> <b>into</b> <b>sleep</b> <b>mode,</b> <b>otherwise</b> <b>the</b> <b>BOD</b> <b>will</b> <b>not</b>
       <b>truly</b> <b>be</b> <b>disabled.</b> <b>Recommended</b> <b>practice</b> <b>is</b> <b>to</b> <b>disable</b> <b>the</b> <b>BOD</b> <b>(sleep_bod_disable()),</b> <b>set</b> <b>the</b> <b>interrupts</b>
       <b>(sei()),</b> <b>and</b> <b>then</b> <b>put</b> <b>the</b> <b>device</b> <b>to</b> <b>sleep</b> <b>(sleep_cpu()),</b> <b>like</b> <b>so:</b>

       #include &lt;avr/interrupt.h&gt;
       #include &lt;avr/sleep.h&gt;

       ...
         set_sleep_mode(&lt;mode&gt;);
         cli();
         if (some_condition)
         {
           sleep_enable();
           sleep_bod_disable();
           sei();
           sleep_cpu();
           sleep_disable();
         }
         sei();

       Put the device in sleep mode. How the device is brought out of sleep mode depends on the specific mode
       selected with the set_sleep_mode() function. See the data sheet for your device for more details.

       Set the SE (sleep enable) bit.

   <b>void</b> <b>sleep_mode</b> <b>(void)</b> <b>[extern]</b>
       Put the device into sleep mode, taking care of setting the SE bit before, and clearing it afterwards.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for AVR-LibC from the source code.

AVR-LibC                                          Version 2.2.1                                  <u><a href="../man3avr/avr_sleep.3avr.html">avr_sleep</a></u>(3avr)
</pre>
 </div>
</div></section>
</div>
</body>
</html>