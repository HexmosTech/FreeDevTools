<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbd_create, nbd_close, nbd_get_error, nbd_get_errno - create libnbd handles and fetch errors</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnbd-dev">libnbd-dev_1.22.2-1build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nbd_create, nbd_close, nbd_get_error, nbd_get_errno - create libnbd handles and fetch errors

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;libnbd.h&gt;

        struct nbd_handle *nbd;

        struct nbd_handle *nbd_create (void);

        void nbd_close (struct nbd_handle *nbd);

        const char *nbd_get_error (void);

        int nbd_get_errno (void);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>struct</b> <b>nbd_handle</b> is an opaque structure which describes an NBD client handle and the connection to an
       NBD server.

   <b>Creating</b> <b>a</b> <b>libnbd</b> <b>handle</b>
       <b>nbd_create</b> creates a new handle.  It returns a pointer to the opaque handle structure.

       On error this returns "NULL".  See "ERROR HANDLING" in <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3) for how to get further details of the
       error.

   <b>Closing</b> <b>a</b> <b>handle</b>
       <b>nbd_close</b> closes the handle, closing and freeing any associated resources.

       The final status of any command that has not been retired (whether by <b><a href="../man3/nbd_aio_command_completed.3.html">nbd_aio_command_completed</a></b>(3) or by
       a low-level completion callback returning 1) is lost.

       This function is not safe to call while any other thread is still using any "nbd_*" API on the same
       handle.  This function can block in the case where we wait for a subprocess (eg. one created with
       <b><a href="../man3/nbd_connect_command.3.html">nbd_connect_command</a></b>(3)).

   <b>Getting</b> <b>the</b> <b>latest</b> <b>error</b> <b>message</b> <b>in</b> <b>the</b> <b>thread</b>
       <b>nbd_get_error</b> returns the most recent error message in the current thread.  The error message is only
       valid if called immediately after the failing call, from the same thread.  The error string returned will
       be freed up next time any libnbd API is called from the same thread, so if you need to keep it you must
       make a copy.

       This should never return "NULL" provided there was an error returned from the immediately preceding
       libnbd call in the current thread.

       <b>nbd_get_errno</b> returns the most recent "errno" in the current thread.  Not all errors have corresponding
       errnos, so even if there has been an error this may return 0.  Error codes are the standard ones from
       "&lt;errno.h&gt;".

       See "ERROR HANDLING" in <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3) for more discussion of how error handling works in libnbd.

</pre><h4><b>EXAMPLE</b></h4><pre>
        #include &lt;libnbd.h&gt;

        main ()
        {
          struct nbd_handle *nbd;

          nbd = nbd_create ();
          if (nbd == NULL) {
            fprintf (stderr, "%s\n", nbd_get_error ());
            nbd_close (nbd);
            exit (EXIT_FAILURE);
          }
          nbd_close (nbd);
          exit (EXIT_SUCCESS);
        }

</pre><h4><b>VERSION</b></h4><pre>
       These functions were all present in libnbd 1.0.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/nbd_shutdown.3.html">nbd_shutdown</a></b>(3), <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3).

</pre><h4><b>AUTHORS</b></h4><pre>
       Eric Blake

       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
       General Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General
       Public License for more details.

       You should have received a copy of the GNU Lesser General Public License along with this library; if not,
       write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA

libnbd-1.22.2                                      2025-06-16                                      <u><a href="../man3/nbd_create.3.html">nbd_create</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>