<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fduserdata_create,    fduserdata_destroy,    fduserdata_destroy_cb,    fduserdata_new,    fduserdata_get,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libfduserdata-dev">libfduserdata-dev_0.1.2-3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fduserdata_create,    fduserdata_destroy,    fduserdata_destroy_cb,    fduserdata_new,    fduserdata_get,
       fduserdata_put, fduserdata_del - associate file descriptors with user defined data

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;fduserdata.h&gt;</b>

       <b>FDUSERDATA</b> <b>*fduserdata_create(int</b> <u>size</u><b>);</b>

       <b>void</b> <b>fduserdata_destroy(FDUSERDATA</b> <b>*</b><u>fdtable</u><b>);</b>

       <b>typedef</b> <b>void</b> <b>(*fduserdata_destr_cb_t)(int</b> <b>fd,</b> <b>void</b> <b>*data,</b> <b>void</b> <b>*arg);</b>
       <b>void</b> <b>fduserdata_destroy_cb(FDUSERDATA</b> <b>*</b><u>fdtable</u><b>,</b> <b>fduserdata_destr_cb_t</b> <u>callback</u><b>,</b> <b>void</b> <b>*</b><u>arg</u><b>);</b>

       <b>void</b> <b>*fduserdata_new(FDUSERDATA</b> <b>*</b><u>fdtable</u><b>,</b> <b>int</b> <u>fd</u><b>,</b> <u>type</u><b>);</b>

       <b>void</b> <b>*fduserdata_get(FDUSERDATA</b> <b>*</b><u>fdtable</u><b>,</b> <b>int</b> <u>fd</u><b>);</b>

       <b>void</b> <b>fduserdata_put(void</b> <b>*</b><u>data</u><b>);</b>

       <b>int</b> <b>fduserdata_del(void</b> <b>*</b><u>data</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This library permits one to associate file descriptors with user defined data, more precisely it  manages
       a data structure whose searching key is a file descriptor.

       <b>fduserdata_create</b>  and  <b>fduserdata_destroy</b>  are  the  constructor  and  destructor of the data structure,
       respectively.  The  data  structure  has  been  implemented  as  a  hash  table,  the  argument  <u>size</u>  of
       <b>fduserdata_create</b>  is  the  size of the hash array. When <u>size</u> is zero the hash array has its default size
       (64).

       <b>fduserdata_destroy_cb</b> is an alternative destructor which calls the function  <u>callback</u>  for  each  element
       still in the data structure.

       <b>fduserdata_new</b> creates a new element. It is a macro: <u>type</u> is the type of the user data.

       <b>fduserdata_get</b> search the user data associated to the <u>fd</u>.

       Both <b>fduserdata_new</b> and <b>fduserdata_get</b> lock the access to the element, so that fduserdata is thread safe.
       <b>fduserdata_put</b> unlocks the element and makes it available for further requests.

       <b>fduserdata_del</b> can be used instead of <b>fduserdata_put</b> to delete the element.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>fduserdata_create</b> returns the descriptor of the data structure (NULL in case of error).

       <b>fduserdata_new</b> returns the element of type <u>type</u> just created (NULL in case of error).

       <b>fduserdata_get</b> returns the element or NULL if no data corresponds to the file descriptor <u>fd</u>.

       <b>fduserdata_del</b> On success, zero is returned. On error, -1 is returned.

       On error, <u>errno</u> is set appropriately.

</pre><h4><b>EXAMPLE</b></h4><pre>
       fduserdata uses a trivial hash table, the optional arg is the
       size of the hash table: default value = 64

           FDUSERDATA table = <a href="../man0/fduserdata_create.0.html">fduserdata_create</a>(0);

           struct mydata {
           // fd data fields ...
           };

       create a struct mydata for the file descriptor fd.

           struct mydata *data = fduserdata_new(table, fd, struct mydata);

       .... set user defined data (data-&gt;fields)

           fduserdata_put(data);

       search for data
       there is mutual exclusion between new/put, get/put (or new/del, get/del)
       so do not insert time consuming or blocking ops.

           struct mydata *fddata = fduserdata_get(table, fd);
           if (fddata) {

       ... read/update user defined data (data-&gt;fields)
       (use fduserdata_del instead of fduserdata_put to delete the element)

                 fduserdata_put(data);
           }

       at the end... when table is no longer required

           fduserdata_destroy(table);

</pre><h4><b>AUTHOR</b></h4><pre>
       VirtualSquare. Project leader: Renzo Davoli.

VirtualSquare                                     November 2019                                    <u><a href="../man3/FDUSERDATA.3.html">FDUSERDATA</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>