<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbd_opt_list_meta_context - list available meta contexts, using implicit query list</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnbd-dev">libnbd-dev_1.22.2-1build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nbd_opt_list_meta_context - list available meta contexts, using implicit query list

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;libnbd.h&gt;

        typedef struct {
          int (*callback) (void *user_data, const char *name);
          void *user_data;
          void (*free) (void *user_data);
        } nbd_context_callback;

        int nbd_opt_list_meta_context (
              struct nbd_handle *h,
              nbd_context_callback context_callback
            );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Request that the server list available meta contexts associated with the export previously specified by
       the most recent <b><a href="../man3/nbd_set_export_name.3.html">nbd_set_export_name</a></b>(3) or <b><a href="../man3/nbd_connect_uri.3.html">nbd_connect_uri</a></b>(3), and with a list of queries from prior calls
       to <b><a href="../man3/nbd_add_meta_context.3.html">nbd_add_meta_context</a></b>(3) (see <b><a href="../man3/nbd_opt_list_meta_context_queries.3.html">nbd_opt_list_meta_context_queries</a></b>(3) if you want to supply an explicit
       query list instead).  This can only be used if <b><a href="../man3/nbd_set_opt_mode.3.html">nbd_set_opt_mode</a></b>(3) enabled option mode.

       The NBD protocol allows a client to decide how many queries to ask the server.  Rather than taking that
       list of queries as a parameter to this function, libnbd reuses the current list of requested meta
       contexts as set by <b><a href="../man3/nbd_add_meta_context.3.html">nbd_add_meta_context</a></b>(3); you can use <b><a href="../man3/nbd_clear_meta_contexts.3.html">nbd_clear_meta_contexts</a></b>(3) to set up a different
       list of queries.  When the list is empty, a server will typically reply with all contexts that it
       supports; when the list is non-empty, the server will reply only with supported contexts that match the
       client's request.  Note that a reply by the server might be encoded to represent several feasible
       contexts within one string, rather than multiple strings per actual context name that would actually
       succeed during <b><a href="../man3/nbd_opt_go.3.html">nbd_opt_go</a></b>(3); so it is still necessary to use <b><a href="../man3/nbd_can_meta_context.3.html">nbd_can_meta_context</a></b>(3) after connecting to
       see which contexts are actually supported.

       The "context" function is called once per server reply, with any "user_data" passed to this function, and
       with "name" supplied by the server.  Remember that it is not safe to call <b><a href="../man3/nbd_add_meta_context.3.html">nbd_add_meta_context</a></b>(3) from
       within the context of the callback function; rather, your code must copy any "name" needed for later use
       after this function completes.  At present, the return value of the callback is ignored, although a
       return of -1 should be avoided.

       For convenience, when this function succeeds, it returns the number of replies returned by the server.

       Not all servers understand this request, and even when it is understood, the server might intentionally
       send an empty list because it does not support the requested context, or may encounter a failure after
       delivering partial results.  Thus, this function may succeed even when no contexts are reported, or may
       fail but have a non-empty list.  Likewise, the NBD protocol does not specify an upper bound for the
       number of replies that might be advertised, so client code should be aware that a server may send a
       lengthy list.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       This call returns an integer ≥ 0.

</pre><h4><b>ERRORS</b></h4><pre>
       On error -1 is returned.

       Refer to "ERROR HANDLING" in <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3) for how to get further details of the error.

       The following parameters must not be NULL: "h".  For more information see "Non-NULL parameters" in
       <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3).

</pre><h4><b>HANDLE</b> <b>STATE</b></h4><pre>
       nbd_opt_list_meta_context can be called when the handle is in the following state:

        ┌─────────────────────────────────────┬─────────────────────────┐
        │ Handle created, before connecting   │ ❌ error                │
        │ Connecting                          │ ❌ error                │
        │ Connecting &amp; handshaking (opt_mode) │ ✅ allowed              │
        │ Connected to the server             │ ❌ error                │
        │ Connection shut down                │ ❌ error                │
        │ Handle dead                         │ ❌ error                │
        └─────────────────────────────────────┴─────────────────────────┘

</pre><h4><b>VERSION</b></h4><pre>
       This function first appeared in libnbd 1.6.

       If you need to test if this function is available at compile time check if the following macro is
       defined:

        #define LIBNBD_HAVE_NBD_OPT_LIST_META_CONTEXT 1

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/nbd_add_meta_context.3.html">nbd_add_meta_context</a></b>(3), <b><a href="../man3/nbd_aio_opt_list_meta_context.3.html">nbd_aio_opt_list_meta_context</a></b>(3), <b><a href="../man3/nbd_can_meta_context.3.html">nbd_can_meta_context</a></b>(3),
       <b><a href="../man3/nbd_clear_meta_contexts.3.html">nbd_clear_meta_contexts</a></b>(3), <b><a href="../man3/nbd_connect_uri.3.html">nbd_connect_uri</a></b>(3), <b><a href="../man3/nbd_create.3.html">nbd_create</a></b>(3), <b><a href="../man3/nbd_opt_go.3.html">nbd_opt_go</a></b>(3),
       <b><a href="../man3/nbd_opt_list_meta_context_queries.3.html">nbd_opt_list_meta_context_queries</a></b>(3), <b><a href="../man3/nbd_opt_set_meta_context.3.html">nbd_opt_set_meta_context</a></b>(3), <b><a href="../man3/nbd_set_export_name.3.html">nbd_set_export_name</a></b>(3),
       <b><a href="../man3/nbd_set_opt_mode.3.html">nbd_set_opt_mode</a></b>(3), <b><a href="../man3/libnbd.3.html">libnbd</a></b>(3).

</pre><h4><b>AUTHORS</b></h4><pre>
       Eric Blake

       Richard W.M. Jones

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Red Hat

</pre><h4><b>LICENSE</b></h4><pre>
       This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
       General Public License as published by the Free Software Foundation; either version 2 of the License, or
       (at your option) any later version.

       This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General
       Public License for more details.

       You should have received a copy of the GNU Lesser General Public License along with this library; if not,
       write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA

libnbd-1.22.2                                      2025-06-16                       <u><a href="../man3/nbd_opt_list_meta_context.3.html">nbd_opt_list_meta_context</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>