<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>arc4random,  arc4random_uniform,  arc4random_buf,  arc4random_stir,  arc4random_addrandom — random number</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libbsd-dev">libbsd-dev_0.12.2-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       arc4random,  arc4random_uniform,  arc4random_buf,  arc4random_stir,  arc4random_addrandom — random number
       generator

</pre><h4><b>LIBRARY</b></h4><pre>
       Utility functions from BSD systems (libbsd, -lbsd)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;</b>
       (See <u><a href="../man7/libbsd.7.html">libbsd</a></u>(7) for include usage.)

       <u>uint32_t</u>
       <b>arc4random</b>(<u>void</u>);

       <u>uint32_t</u>
       <b>arc4random_uniform</b>(<u>uint32_t</u> <u>bound</u>);

       <u>void</u>
       <b>arc4random_buf</b>(<u>void</u> <u>*buf</u>, <u>size_t</u> <u>len</u>);

       <u>void</u>
       <b>arc4random_stir</b>(<u>void</u>);

       <u>void</u>
       <b>arc4random_addrandom</b>(<u>unsigned</u> <u>char</u> <u>*buf</u>, <u>int</u> <u>len</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>arc4random</b> family of functions provides a cryptographic pseudorandom number  generator  automatically
       seeded  from  the  system  entropy pool and safe to use from multiple threads.  <b>arc4random</b> is designed to
       prevent an adversary from guessing outputs,  unlike  <u><a href="../man3/rand.3.html">rand</a></u>(3)  and  <u><a href="../man3/random.3.html">random</a></u>(3),  and  is  faster  and  more
       convenient than reading from <u>/dev/urandom</u> directly.

       <b>arc4random</b>() returns an integer in [0, 2^32) chosen independently with uniform distribution.

       <b>arc4random_uniform</b>() returns an integer in [0, <u>bound</u>) chosen independently with uniform distribution.

       <b>arc4random_buf</b>()  stores <u>len</u> bytes into the memory pointed to by <u>buf</u>, each byte chosen independently from
       [0, 256) with uniform distribution.

       <b>arc4random_stir</b>() draws entropy from the operating system and incorporates it  into  the  library's  PRNG
       state to influence future outputs.

       <b>arc4random_addrandom</b>()  incorporates  <u>len</u> bytes, which must be nonnegative, from the buffer <u>buf</u>, into the
       library's PRNG state to influence future outputs.

       It is not necessary for an application to call <b>arc4random_stir</b>() or <b>arc4random_addrandom</b>() before calling
       other <b>arc4random</b> functions.  The first call to any <b>arc4random</b> function will  initialize  the  PRNG  state
       unpredictably from the system entropy pool.

</pre><h4><b>SECURITY</b> <b>MODEL</b></h4><pre>
       The  <b>arc4random</b>  functions  provide  the following security properties against three different classes of
       attackers, assuming enough entropy is provided by the operating system:

           1.   An attacker who has seen some outputs of any of the <b>arc4random</b> functions cannot predict past  or
                future unseen outputs.

           2.   An attacker who has seen the library's PRNG state in memory cannot predict past outputs.

           3.   An attacker who has seen one process's PRNG state cannot predict past or future outputs in other
                processes, particularly its parent or siblings.

       One ‘output’ means the result of any single request to an <b>arc4random</b> function, no matter how short it is.

       The  second  property  is  sometimes called ‘forward secrecy’, ‘backtracking resistance’, or ‘key erasure
       after each output’.

</pre><h4><b>IMPLEMENTATION</b> <b>NOTES</b></h4><pre>
       The <b>arc4random</b> functions are currently implemented using the ChaCha20 pseudorandom function family.   For
       any  32-byte  string  <u>s</u>,  ChaCha20_<u>s</u>  is  a  function  from  16-byte  strings  to 64-byte strings.  It is
       conjectured that if <u>s</u> is chosen with  uniform  distribution,  then  the  distribution  on  ChaCha20_<u>s</u>  is
       indistinguishable  to  a  computationally  bounded adversary from a uniform distribution on all functions
       from 16-byte strings to 64-byte strings.

       The PRNG state is a 32-byte ChaCha20 key <u>s</u>.  Each request to an <b>arc4random</b> function
           <b>•</b>   computes the 64-byte quantity <u>x</u> = ChaCha20_<u><a href="../man0/s.0.html">s</a></u>(0),
           <b>•</b>   splits <u>x</u> into two 32-byte quantities <u>s'</u> and <u>k</u>,
           <b>•</b>   replaces <u>s</u> by <u>s'</u>, and
           <b>•</b>   uses <u>k</u> as output.

       <b>arc4random</b>() yields the first four bytes of <u>k</u> as output directly.  <b>arc4random_buf</b>() either yields  up  to
       32  bytes  of  <u>k</u>  as  output  directly,  or, for longer requests, uses <u>k</u> as a ChaCha20 key and yields the
       concatenation ChaCha20_<u><a href="../man0/k.0.html">k</a></u>(0) || ChaCha20_<u><a href="../man1/k.1.html">k</a></u>(1) || ... as output.  <b>arc4random_uniform</b>() repeats <b>arc4random</b>()
       until it obtains an integer in [2^32 % <u>bound</u>, 2^32), and reduces that modulo <u>bound</u>.

       The PRNG state is per-thread, unless memory allocation fails inside  the  library,  in  which  case  some
       threads  may share global PRNG state with a mutex.  The global PRNG state is zeroed on fork in the parent
       via <u><a href="../man3/pthread_atfork.3.html">pthread_atfork</a></u>(3), and the per-thread PRNG state is zeroed on fork in the child via <u><a href="../man2/minherit.2.html">minherit</a></u>(2)  with
       MAP_INHERIT_ZERO,  so  that  the  child  cannot  reuse or see the parent's PRNG state.  The PRNG state is
       reseeded automatically from the system entropy pool on the first use  of  an  <b>arc4random</b>  function  after
       zeroing.

       The  first  use of an <b>arc4random</b> function may abort the process in the highly unlikely event that library
       initialization necessary to implement the security  model  fails.   Additionally,  <b>arc4random_stir</b>()  and
       <b>arc4random_addrandom</b>() may abort the process in the highly unlikely event that the operating system fails
       to provide entropy.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/rand.3.html">rand</a></u>(3), <u><a href="../man3/random.3.html">random</a></u>(3), <u><a href="../man4/rnd.4.html">rnd</a></u>(4), <u><a href="../man9/cprng.9.html">cprng</a></u>(9)

       Daniel  J.  Bernstein,  <u>ChaCha,</u>  <u>a</u>  <u>variant</u>  <u>of</u>  <u>Salsa20</u>, <a href="http://cr.yp.to/papers.html">http://cr.yp.to/papers.html</a>#chacha, 2008-01-28,
       Document ID: 4027b5256e17b9796842e6d0f68b0b5e.

</pre><h4><b>HISTORY</b></h4><pre>
       These functions first appeared in OpenBSD 2.1, FreeBSD 3.0, NetBSD 1.6, and DragonFly 1.0.  The functions
       <b>arc4random</b>(), <b>arc4random_buf</b>() and <b>arc4random_uniform</b>() appeared in glibc 2.36.

</pre><h4><b>BUGS</b></h4><pre>
       There is no way to get deterministic, reproducible results out of <b>arc4random</b> for testing purposes.

       The name ‘arc4random’ was chosen for hysterical raisins -- it was originally implemented  using  the  RC4
       stream  cipher,  which  has  been  known  since shortly after it was published in 1994 to have observable
       biases in the output, and is now known to be broken badly enough to admit practical attacks in  the  real
       world.   Unfortunately, the library found widespread adoption and the name stuck before anyone recognized
       that it was silly.

       The signature of <b>arc4random_addrandom</b>() is silly.  There is no reason to require casts or accept negative
       lengths: it should take a <u>void</u> <u>*</u> buffer and a <u>size_t</u> length.  But it's too late to change that now.

       <b>arc4random_uniform</b>() does not help to choose integers in [0, <u>n</u>) uniformly at random when <u>n</u> &gt; 2^32.

       The security model of <b>arc4random</b> is stronger  than  many  applications  need,  and  stronger  than  other
       operating  systems  provide.   For example, applications encrypting messages with random, but not secret,
       initialization vectors need only prevent an adversary from guessing future outputs,  since  past  outputs
       will have been published already.

       On  the  one hand, <b>arc4random</b> could be marginally faster if it were not necessary to prevent an adversary
       who sees the state from predicting past outputs.  On the other hand, there are applications in  the  wild
       that  use  <b>arc4random</b> to generate key material, such as OpenSSH, so for the sake of NetBSD users it would
       be imprudent to weaken the security model.   On  the  third  hand,  relying  on  the  security  model  of
       <b>arc4random</b>  in  NetBSD  may  lead  you  to  an  unpleasant  surprise  on  another  operating system whose
       implementation of <b>arc4random</b> has a weaker security model.

       One may be tempted  to  create  new  APIs  to  accommodate  different  security  models  and  performance
       constraints  without  unpleasant  surprises  on  different  operating  systems.   This should not be done
       lightly, though, because there are already too many different choices, and  too  many  opportunities  for
       programmers to reach for one and pick the wrong one.

Debian                                          November 16, 2014                               <u><a href="../man3bsd/arc4random.3bsd.html">arc4random</a></u>(3bsd)
</pre>
 </div>
</div></section>
</div>
</body>
</html>