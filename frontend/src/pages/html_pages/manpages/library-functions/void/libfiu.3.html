<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>libfiu - Fault injection in userspace</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libfiu-dev">libfiu-dev_1.2-3build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       libfiu - Fault injection in userspace

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>/*</b> <b>Core</b> <b>API</b> <b>*/</b>
       <b>#include</b> <b>&lt;fiu.h&gt;</b>

       <b>int</b> <b>fiu_init(unsigned</b> <b>int</b> <u>flags</u><b>);</b>
       <b>int</b> <b>fiu_fail(const</b> <b>char</b> <b>*</b><u>name</u><b>);</b>
       <b>void</b> <b>*fiu_failinfo(void);</b>
       <b>[void]</b> <b>fiu_do_on(char</b> <b>*</b><u>name</u><b>,</b> <u>action</u><b>);</b> <b>[macro]</b>
       <b>[void]</b> <b>fiu_exit_on(char</b> <b>*</b><u>name</u><b>);</b> <b>[macro]</b>
       <b>[void]</b> <b>fiu_return_on(char</b> <b>*</b><u>name</u><b>,</b> <u>retval</u><b>);</b> <b>[macro]</b>

       <b>/*</b> <b>Control</b> <b>API</b> <b>*/</b>
       <b>#include</b> <b>&lt;fiu-control.h&gt;</b>

       <b>int</b> <b>fiu_enable(const</b> <b>char</b> <b>*</b><u>name</u><b>,</b> <b>int</b> <u>failnum</u><b>,</b>
                 <b>void</b> <b>*</b><u>failinfo</u><b>,</b> <b>unsigned</b> <b>int</b> <u>flags</u><b>);</b>
       <b>int</b> <b>fiu_enable_random(const</b> <b>char</b> <b>*</b><u>name</u><b>,</b> <b>int</b> <u>failnum</u><b>,</b>
                 <b>void</b> <b>*</b><u>failinfo</u><b>,</b> <b>unsigned</b> <b>int</b> <u>flags</u><b>,</b> <b>float</b> <u>probability</u><b>);</b>
       <b>typedef</b> <b>int</b> <b>external_cb_t(const</b> <b>char</b> <b>*</b><u>name</u><b>,</b> <b>int</b> <b>*</b><u>failnum</u><b>,</b>
                 <b>void</b> <b>**</b><u>failinfo</u><b>,</b> <b>unsigned</b> <b>int</b> <b>*</b><u>flags</u><b>);</b>
       <b>int</b> <b>fiu_enable_external(const</b> <b>char</b> <b>*</b><u>name</u><b>,</b> <b>int</b> <u>failnum</u><b>,</b>
                 <b>void</b> <b>*</b><u>failinfo</u><b>,</b> <b>unsigned</b> <b>int</b> <u>flags</u><b>,</b>
                 <b>external_cb_t</b> <b>*</b><u>external_cb</u><b>);</b>
       <b>int</b> <b>fiu_enable_stack(const</b> <b>char</b> <b>*</b><u>name</u><b>,</b> <b>int</b> <u>failnum</u><b>,</b>
                 <b>void</b> <b>*</b><u>failinfo</u><b>,</b> <b>unsigned</b> <b>int</b> <u>flags</u><b>,</b>
                 <b>void</b> <b>*</b><u>func</u><b>,</b> <b>int</b> <u>func_pos_in_stack</u><b>);</b>
       <b>int</b> <b>fiu_enable_stack_by_name(const</b> <b>char</b> <b>*</b><u>name</u><b>,</b> <b>int</b> <u>failnum</u><b>,</b>
                 <b>void</b> <b>*</b><u>failinfo</u><b>,</b> <b>unsigned</b> <b>int</b> <u>flags</u><b>,</b>
                 <b>const</b> <b>char</b> <b>*</b><u>func_name</u><b>,</b> <b>int</b> <u>func_pos_in_stack</u><b>);</b>
       <b>int</b> <b>fiu_disable(const</b> <b>char</b> <b>*</b><u>name</u><b>);</b>
       <b>int</b> <b>fiu_rc_fifo(const</b> <b>char</b> <b>*</b><u>basename</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       libfiu  is  a  library for fault injection. It provides functions to mark "points of failure" inside your
       code (the "core API"), and functions to enable/disable the failure of those points (the "control API").

       The core API is used inside the code wanting to perform fault injection on.   The  control  API  is  used
       inside the testing code, in order to control the injection of failures.

       This page is an API reference and not a complete manual, and as such does not go into detail about how to
       use the library. The library's manual can be found in the distribution.

   <b>CORE</b> <b>API</b>
       To use the core API, you should <u>#include</u> <u>&lt;fiu.h&gt;</u> (or <u>&lt;fiu-local.h&gt;</u>, see below).

       Because  fault  injection  is  usually  a  debugging/testing  facility, unwanted at runtime, some special
       considerations were taken to minimize the impact of the core API. First of  all,  if  <u>FIU_ENABLE</u>  is  not
       defined,  then  fiu.h will define empty stubs for all the core API, effectively disabling fault injection
       completely.

       Also, the special header <u>fiu-local.h</u> is shipped with libfiu. It is meant to be included in  your  project
       to avoid having libfiu as a mandatory build-time dependency. You can add it to your project, and #include
       it  instead  of <u>fiu.h</u>.  It will take care of including the real <u>fiu.h</u> only when <u>FIU_ENABLE</u> is defined. It
       is entirely optional, but recommended. See the library's manual for more details.

       <b>fiu_init(</b><u>flags</u><b>)</b>
              Initializes the library. Ideally, you should only call  this  once,  although  it  can  cope  with
              multiple  calls.  The  flags  parameter  is  currently  unused  and must be set to 0. Returns 0 on
              success, &lt; 0 on error.

       <b>fiu_fail(</b><u>name</u><b>)</b>
              Returns the failure status of the given point of failure. 0 means it should not fail. By  default,
              all points of failure do not fail; they're enabled in runtime using the control API.

       <b>fiu_failinfo()</b>
              Returns  the  information  associated  with  the  last  failure,  or NULL if there isn't one. This
              function is thread-aware and will only return information about failures in the calling thread.

       <b>fiu_do_on(</b><u>name</u><b>,</b> <u>action</u><b>)</b> <b>[macro]</b>
              This is a macro that uses <b>fiu_fail()</b> to perform the given action when the given point  of  failure
              fails. The action can be any valid C statement.

       <b>fiu_exit_on(</b><u>name</u><b>)</b> <b>[macro]</b>
              This  is  a  macro that uses <b>fiu_fail()</b> to exit the process when the given point of failure fails.
              The process is exit using <a href="../man3/exit.3.html">exit</a>(3), which is given the status EXIT_FAILURE.

       <b>fiu_return_on(</b><u>name</u><b>,</b> <u>retval</u><b>)</b> <b>[macro]</b>
              This is a macro that uses <b>fiu_fail()</b> to make the current function return the  given  value  (whose
              type obviously depends on the return type of the function).

   <b>CONTROL</b> <b>API</b>
       To use the control API, you should <u>#include</u> <u>&lt;fiu-control.h&gt;</u>.

       <b>fiu_enable(</b><u>name</u><b>,</b> <u>failnum</u><b>,</b> <u>failinfo</u><b>,</b> <u>flags</u><b>)</b>
              Enables  the  given  point  of failure.  <u>failnum</u> is what <b>fiu_fail()</b> will return, and must be != 0.
              <u>failinfo</u> is what <b>fiu_failinfo()</b> will return when called after  the  given  point  of  failure  has
              failed.   <u>flags</u>  can be either 0 or <u>FIU_ONETIME</u>, which indicates that this point of failure should
              only fail once.  Returns 0 if success, &lt; 0 otherwise. If the point of failure was already enabled,
              this overwrites the previous values.

              Successive calls to <b>fiu_fail()</b> will return <u>failnum</u> until this point of  failure  is  disabled.  If
              <u>FIU_ONETIME</u>  was  passed in the flags, this point of failure is disabled immediately after failing
              once.

              If the name ends with an asterisk, then it this will match all points of failure that  begin  with
              the given name (excluding the asterisk, of course).

       <b>fiu_enable_random(</b><u>name</u><b>,</b> <u>failnum</u><b>,</b> <u>failinfo</u><b>,</b> <u>flags</u><b>,</b> <u>probability</u><b>)</b>
              Enables  the given point of failure, with the given probability (between 0 and 1). The rest of the
              parameters, as well as the return value, are the same as the ones in <b>fiu_enable()</b>.

       <b>fiu_enable_external(</b><u>name</u><b>,</b> <u>failnum</u><b>,</b> <u>failinfo</u><b>,</b> <u>flags</u><b>,</b> <u>external_cb</u><b>)</b>
              Enables the given point of failure, leaving the decision whether to  fail  or  not  to  the  given
              external  function,  which  should  return 0 if it is not to fail, or 1 otherwise. The rest of the
              parameters, as well as the return value, are the same as the ones in <b>fiu_enable()</b>.

       <b>int</b> <b>fiu_enable_stack(</b><u>name</u><b>,</b> <u>failnum</u><b>,</b> <u>failinfo</u><b>,</b> <u>flags</u><b>,</b> <u>func</u><b>,</b> <u>func_pos_in_stack</u><b>)</b>
              Enables the given point of failure, but only if <u>func</u> is in the stack at <u>func_pos_in_stack</u>.

              <u>func</u> must be a function pointer, and  <u>func_pos_in_stack</u>  is  the  position  where  we  expect  the
              function  to  be,  or  -1  for "any" (values other than -1 are not yet supported). The rest of the
              parameters, as well as the return value, are the same as the ones in <b>fiu_enable()</b>.

              This function relies on some GNU extensions, so it may be not available in all platforms.

       <b>int</b> <b>fiu_enable_stack_by_name(</b><u>name</u><b>,</b> <u>failnum</u><b>,</b> <u>failinfo</u><b>,</b> <u>flags</u><b>,</b> <u>func_name</u><b>,</b> <u>func_pos_in_stack</u><b>)</b>
              Enables the given point of failure, but only if <u>func_name</u> is in the stack at <u>func_pos_in_stack</u>.

              <u>func</u> must be the name of a  function  (resolved  at  runtime  using  dlsym());  the  rest  of  the
              parameters, as well as the return value, are the same as the ones in <b>fiu_enable_stack</b>.

              This function relies on some GNU extensions, so it may be not available in all platforms.

       <b>fiu_disable(</b><u>name</u><b>)</b>
              Disables the given point of failure, undoing the actions of the <b>fiu_enable*()</b> functions.

       <b>fiu_rc_fifo(</b><u>basename</u><b>)</b>
              Enables  remote  control  over  named  pipes  with  the  given  basename.  See  the remote control
              documentation that comes with the library for more detail.

   <b>THREAD</b> <b>SAFETY</b>
       The library is thread-safe. The list of enabled failure points is shared among all threads.

       Care should be taken in the user-provided functions given to <b>fiu_enable_external()</b>, as they can be run in
       parallel.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/fiu-run.1.html">fiu-run</a></b>(1), <b><a href="../man1/fiu-ctrl.1.html">fiu-ctrl</a></b>(1).

</pre><h4><b>BUGS</b></h4><pre>
       If  you  want  to  report  bugs,  or  have  any  questions   or   comments,   just   let   me   know   at
       <a href="mailto:albertito@blitiri.com.ar">albertito@blitiri.com.ar</a>.     For     more     information     about    libfiu,    you    can    go    to
       <a href="http://blitiri.com.ar/p/libfiu">http://blitiri.com.ar/p/libfiu</a>.

                                                   17/Feb/2009                                         <u><a href="../man3/libfiu.3.html">libfiu</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>