<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_set_cert_cb, SSL_set_cert_cb - handle certificate callback function</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_set_cert_cb, SSL_set_cert_cb - handle certificate callback function

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        void SSL_CTX_set_cert_cb(SSL_CTX *c, int (*cert_cb)(SSL *ssl, void *arg),
                                 void *arg);
        void SSL_set_cert_cb(SSL *s, int (*cert_cb)(SSL *ssl, void *arg), void *arg);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_CTX_set_cert_cb()</b> and <b>SSL_set_cert_cb()</b> sets the <u>cert_cb</u> callback, <u>arg</u> value is pointer which is
       passed to the application callback.

       When <u>cert_cb</u> is NULL, no callback function is used.

       <u>cert_cb</u> is the application defined callback. It is called before a certificate will be used by a client
       or server. The callback can then inspect the passed <u>ssl</u> structure and set or clear any appropriate
       certificates. If the callback is successful it <b>MUST</b> return 1 even if no certificates have been set. A
       zero is returned on error which will abort the handshake with a fatal internal error alert. A negative
       return value will suspend the handshake and the handshake function will return immediately.
       <b><a href="../man3/SSL_get_error.3.html">SSL_get_error</a></b>(3) will return SSL_ERROR_WANT_X509_LOOKUP to indicate, that the handshake was suspended.
       The next call to the handshake function will again lead to the call of <u>cert_cb</u>. It is the job of the
       <u>cert_cb</u> to store information about the state of the last call, if required to continue.

</pre><h4><b>NOTES</b></h4><pre>
       An application will typically call <b>SSL_use_certificate()</b> and <b>SSL_use_PrivateKey()</b> to set the end entity
       certificate and private key.  It can add intermediate and optionally the root CA certificates using
       <b>SSL_add1_chain_cert()</b>.

       It might also call <b>SSL_certs_clear()</b> to delete any certificates associated with the <b>SSL</b> object.

       The certificate callback functionality supersedes the (largely broken) functionality provided by the old
       client certificate callback interface.  It is <b>always</b> called even is a certificate is already set so the
       callback can modify or delete the existing certificate.

       A more advanced callback might examine the handshake parameters and set whatever chain is appropriate.
       For example a legacy client supporting only TLSv1.0 might receive a certificate chain signed using SHA1
       whereas a TLSv1.2 or later client which advertises support for SHA256 could receive a chain using SHA256.

       Normal server sanity checks are performed on any certificates set by the callback. So if an EC chain is
       set for a curve the client does not support it will <b>not</b> be used.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_CTX_set_cert_cb()</b> and <b>SSL_set_cert_cb()</b> do not return values.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_use_certificate.3.html">SSL_use_certificate</a></b>(3), <b><a href="../man3/SSL_add1_chain_cert.3.html">SSL_add1_chain_cert</a></b>(3), <b><a href="../man3/SSL_get_client_CA_list.3.html">SSL_get_client_CA_list</a></b>(3), <b><a href="../man3/SSL_clear.3.html">SSL_clear</a></b>(3),
       <b><a href="../man3/SSL_free.3.html">SSL_free</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2014-2020 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                          <u><a href="../man3SSL/SSL_CTX_SET_CERT_CB.3SSL.html">SSL_CTX_SET_CERT_CB</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>