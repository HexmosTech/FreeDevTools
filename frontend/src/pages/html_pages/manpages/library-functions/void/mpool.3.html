<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mpool - shared memory buffer pool</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mpool - shared memory buffer pool

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;db.h&gt;</b>
       <b>#include</b> <b>&lt;mpool.h&gt;</b>

       <b>MPOOL</b> <b>*mpool_open(DBT</b> <b>*</b><u>key</u><b>,</b> <b>int</b> <u>fd</u><b>,</b> <b>pgno_t</b> <u>pagesize</u><b>,</b> <b>pgno_t</b> <u>maxcache</u><b>);</b>

       <b>void</b> <b>mpool_filter(MPOOL</b> <b>*</b><u>mp</u><b>,</b> <b>void</b> <b>(*pgin)(void</b> <b>*,</b> <b>pgno_t,</b> <b>void</b> <b>*),</b>
                         <b>void</b> <b>(*</b><u>pgout</u><b>)(void</b> <b>*,</b> <b>pgno_t,</b> <b>void</b> <b>*),</b>
                         <b>void</b> <b>*</b><u>pgcookie</u><b>);</b>

       <b>void</b> <b>*mpool_new(MPOOL</b> <b>*</b><u>mp</u><b>,</b> <b>pgno_t</b> <b>*</b><u>pgnoaddr</u><b>);</b>
       <b>void</b> <b>*mpool_get(MPOOL</b> <b>*</b><u>mp</u><b>,</b> <b>pgno_t</b> <u>pgno</u><b>,</b> <b>unsigned</b> <b>int</b> <u>flags</u><b>);</b>
       <b>int</b> <b>mpool_put(MPOOL</b> <b>*</b><u>mp</u><b>,</b> <b>void</b> <b>*</b><u>pgaddr</u><b>,</b> <b>unsigned</b> <b>int</b> <u>flags</u><b>);</b>

       <b>int</b> <b>mpool_sync(MPOOL</b> <b>*</b><u>mp</u><b>);</b>
       <b>int</b> <b>mpool_close(MPOOL</b> <b>*</b><u>mp</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>Note</u>  <u>well</u>: This page documents interfaces provided up until glibc 2.1.  Since glibc 2.2, glibc no longer
       provides these interfaces.  Probably, you are looking for the APIs provided by the <u>libdb</u> library instead.

       <u>Mpool</u> is the library interface intended to provide page oriented buffer management of files.  The buffers
       may be shared between processes.

       The function <b>mpool_open</b>() initializes a memory pool.  The  <u>key</u>  argument  is  the  byte  string  used  to
       negotiate  between multiple processes wishing to share buffers.  If the file buffers are mapped in shared
       memory, all processes using the same key will share the buffers.  If <u>key</u> is NULL, the buffers are  mapped
       into  private  memory.   The  <u>fd</u>  argument  is  a  file descriptor for the underlying file, which must be
       seekable.  If <u>key</u> is non-NULL and matches a file already being mapped, the <u>fd</u> argument is ignored.

       The <u>pagesize</u> argument is the size, in bytes, of the pages into which the file is broken up.  The <u>maxcache</u>
       argument is the maximum number of pages from the underlying file to cache at any one time.  This value is
       not relative to the number of processes which share a file's buffers,  but  will  be  the  largest  value
       specified by any of the processes sharing the file.

       The  <b>mpool_filter</b>()  function  is  intended  to make transparent input and output processing of the pages
       possible.  If the <u>pgin</u> function is specified, it is called each time a buffer is  read  into  the  memory
       pool  from  the  backing  file.   If  the <u>pgout</u> function is specified, it is called each time a buffer is
       written into the backing file.  Both functions are called with the <u>pgcookie</u> pointer, the page number  and
       a pointer to the page to being read or written.

       The  function  <b>mpool_new</b>()  takes  an  <u>MPOOL</u>  pointer  and an address as arguments.  If a new page can be
       allocated, a pointer to the page is returned and the page number is stored  into  the  <u>pgnoaddr</u>  address.
       Otherwise, NULL is returned and <u>errno</u> is set.

       The  function  <b>mpool_get</b>()  takes an <u>MPOOL</u> pointer and a page number as arguments.  If the page exists, a
       pointer to the page is returned.  Otherwise, NULL is returned and <u>errno</u> is set.  The  <u>flags</u>  argument  is
       not currently used.

       The  function  <b>mpool_put</b>()  unpins  the  page referenced by <u>pgaddr</u>.  <u>pgaddr</u> must be an address previously
       returned by <b>mpool_get</b>() or <b>mpool_new</b>().  The flag value is  specified  by  ORing  any  of  the  following
       values:

       <b>MPOOL_DIRTY</b>
              The page has been modified and needs to be written to the backing file.

       <b>mpool_put</b>() returns 0 on success and -1 if an error occurs.

       The  function  <b>mpool_sync</b>()  writes  all  modified pages associated with the <u>MPOOL</u> pointer to the backing
       file.  <b>mpool_sync</b>() returns 0 on success and -1 if an error occurs.

       The <b>mpool_close</b>() function free's up any  allocated  memory  associated  with  the  memory  pool  cookie.
       Modified  pages  are  <b>not</b>  written  to the backing file.  <b>mpool_close</b>() returns 0 on success and -1 if an
       error occurs.

</pre><h4><b>ERRORS</b></h4><pre>
       The <b>mpool_open</b>() function may fail and set <u>errno</u> for any of the errors specified for the library  routine
       <b><a href="../man3/malloc.3.html">malloc</a></b>(3).

       The <b>mpool_get</b>() function may fail and set <u>errno</u> for the following:

       <b>EINVAL</b>         The requested record doesn't exist.

       The  <b>mpool_new</b>() and <b>mpool_get</b>() functions may fail and set <u>errno</u> for any of the errors specified for the
       library routines <b><a href="../man2/read.2.html">read</a></b>(2), <b><a href="../man2/write.2.html">write</a></b>(2), and <b><a href="../man3/malloc.3.html">malloc</a></b>(3).

       The <b>mpool_sync</b>() function may fail and set <u>errno</u> for any of the errors specified for the library  routine
       <b><a href="../man2/write.2.html">write</a></b>(2).

       The <b>mpool_close</b>() function may fail and set <u>errno</u> for any of the errors specified for the library routine
       <b><a href="../man3/free.3.html">free</a></b>(3).

</pre><h4><b>STANDARDS</b></h4><pre>
       BSD.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/btree.3.html">btree</a></b>(3), <b><a href="../man3/dbopen.3.html">dbopen</a></b>(3), <b><a href="../man3/hash.3.html">hash</a></b>(3), <b><a href="../man3/recno.3.html">recno</a></b>(3)

4.4 Berkeley Distribution                          2024-05-02                                           <u><a href="../man3/mpool.3.html">mpool</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>