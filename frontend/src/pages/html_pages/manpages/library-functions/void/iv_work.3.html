<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IV_WORK_POOL_INIT,  iv_work_pool_create,  iv_work_pool_put,  IV_WORK_ITEM_INIT, iv_work_pool_submit_work,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libivykis-dev">libivykis-dev_0.43.2-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       IV_WORK_POOL_INIT,  iv_work_pool_create,  iv_work_pool_put,  IV_WORK_ITEM_INIT, iv_work_pool_submit_work,
       iv_work_pool_submit_continuation - ivykis worker thread management

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;iv_work.h&gt;</b>

       struct iv_work_pool {
               int             max_threads;
               void            *cookie;
               void            (*thread_start)(void *cookie);
               void            (*thread_stop)(void *cookie);
       };

       struct iv_work_item {
               void            *cookie;
               void            (*work)(void *cookie);
               void            (*completion)(void *cookie);
       };

       <b>void</b> <b>IV_WORK_POOL_INIT(struct</b> <b>iv_work_pool</b> <b>*</b><u>this</u><b>);</b>
       <b>int</b> <b>iv_work_pool_create(struct</b> <b>iv_work_pool</b> <b>*</b><u>this</u><b>);</b>
       <b>int</b> <b>iv_work_pool_put(struct</b> <b>iv_work_pool</b> <b>*</b><u>this</u><b>);</b>
       <b>void</b> <b>IV_WORK_ITEM_INIT(struct</b> <b>iv_work_item</b> <b>*</b><u>work</u><b>);</b>
       <b>int</b> <b>iv_work_pool_submit_work(struct</b> <b>iv_work_pool</b> <b>*</b><u>this</u><b>,</b> <b>struct</b> <b>iv_work_item</b> <b>*</b><u>work</u><b>);</b>
       <b>int</b> <b>iv_work_pool_submit_continuation(struct</b> <b>iv_work_pool</b> <b>*</b><u>this</u><b>,</b> <b>struct</b> <b>iv_work_item</b> <b>*</b><u>work</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Calling <b>iv_work_pool_create</b> on a <b>struct</b> <b>iv_work_pool</b> object previously initialised  by  <b>IV_WORK_POOL_INIT</b>
       creates  a  pool  of  worker threads that can be used to offload CPU intensive tasks to, so as to prevent
       negatively influencing event handling latency in the calling thread, and to enable the  use  of  multiple
       host CPUs for CPU intensive tasks.

       <b>iv_work</b>  dynamically adjusts the number of threads in the pool to the amount of work there is to do.  The
       <b>-&gt;max_threads</b> member of <b>struct</b> <b>iv_work_pool</b> specifies the maximum number of threads that will be  created
       in this pool.

       Calling   <b>iv_work_pool_submit_work</b>   on   a   <b>struct</b>   <b>iv_work_item</b>   object  previously  initialised  by
       <b>IV_WORK_ITEM_INIT</b> submits a work item to a pool.  The <b>-&gt;work</b> member of <b>struct</b> <b>iv_work_item</b> specifies  the
       function  that will be called in one of the worker threads in the pool specified by <b>-&gt;this,</b> with <b>-&gt;cookie</b>
       as its sole argument.  When the work function has completed, <b>iv_work</b> will call the <b>-&gt;completion</b>  callback
       to  indicate  this,  also  with <b>-&gt;cookie</b> as its sole argument, in the thread that <b>iv_work_pool_create</b> was
       called in for this pool object.

       Calling <b>iv_work_pool_submit_continuation</b> from a worker thread allows submitting a work item similarly  to
       <b>iv_work_pool_submit_work.</b>   But  while <b>iv_work_pool_submit_work</b> can only be called from the thread owning
       <b>iv_work,</b> <b>iv_work_pool_submit_continuation</b> can be called from any of the worker threads. The  <b>-&gt;completion</b>
       callback of these jobs will be executed from the thread owning <b>iv_work.</b>

       As  a  special  case,  calling <b>iv_work_pool_submit_work</b> with a <b>NULL</b> work pool pointer will cause the work
       item to be processed in the local thread, from an <b><a href="../man3/iv_task.3.html">iv_task</a></b>(3) callback.

       If the <b>-&gt;thread_start</b> function pointer specified in <b>struct</b> <b>iv_work_pool</b> is not NULL, it  will  be  called
       upon  creation  of a new worker thread, in the context of the created worker thread, with <b>-&gt;cookie</b> as its
       sole argument.  Calls to <b>-&gt;thread_start</b> are not explicitly serialised, which should be kept in mind  when
       manipulating state shared between threads from within that callback function.

       Similarly,  if <b>iv_work</b> decides to terminate a worker thread, for example due to inactivity, <b>-&gt;thread_stop</b>
       will be called in the context of the terminating thread, with <b>-&gt;cookie</b> as its sole  argument.   Calls  to
       <b>-&gt;thread_stop</b> are also not explicitly serialised.

       <b>iv_work_pool_submit_work</b> can only be called from the thread that <b>iv_work_pool_create</b> for this pool object
       was called in.  <b>iv_work_pool_submit_continuation</b> can called from any of the worker threads.

       There is no way to cancel submitted work items.

       There  is  no  guaranteed  order,  FIFO  or otherwise, between different work items submitted to the same
       worker thread pool.

       When the user has no more work items to submit to the pool, its reference to the pool can be  dropped  by
       calling <b>iv_work_pool_put.</b>

       If  there  are still pending or running work items assigned to this pool when <b>iv_work_pool_put</b> is called,
       those work items will not be canceled, but will be allowed to run to completion, and  their  <b>-&gt;completion</b>
       callbacks  will  be  called  as  usual.   A  similar thing holds for the <b>-&gt;thread_start</b> and <b>-&gt;thread_stop</b>
       callbacks -- they can also  still  be  called  after  <b>iv_work_pool_put</b>  returns.   Even  so,  the  memory
       corresponding  to  the  <b>struct</b> <b>iv_work_pool</b> can immediately be freed or reused by the user upon return of
       the <b>iv_work_pool_put</b> call.

       Internally, <b>iv_work</b> uses <b><a href="../man3/iv_thread.3.html">iv_thread</a></b>(3) for its thread management.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ivykis.3.html">ivykis</a></b>(3), <b><a href="../man3/iv_thread.3.html">iv_thread</a></b>(3)

ivykis                                             2010-09-14                                         <u><a href="../man3/iv_work.3.html">iv_work</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>