<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ares_getaddrinfo - Initiate a host query by name and service</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libc-ares-dev">libc-ares-dev_1.34.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ares_getaddrinfo - Initiate a host query by name and service

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;ares.h&gt;

       typedef void (*ares_addrinfo_callback)(void *<u>arg</u>, int <u>status</u>,
                                              int <u>timeouts</u>,
                                              struct ares_addrinfo *<u>result</u>)

       void ares_getaddrinfo(ares_channel_t *<u>channel</u>, const char *<u>name</u>,
                             const char* <u>service</u>,
                             const struct ares_addrinfo_hints *<u>hints</u>,
                             ares_addrinfo_callback <u>callback</u>, void *<u>arg</u>)

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b><a href="../man3/ares_getaddrinfo.3.html">ares_getaddrinfo</a>(3)</b> function initiates a host query by name on the name service channel identified by
       <u>channel</u>.   The  <u>name</u>  and  <u>service</u> parameters give the hostname and service as NULL-terminated C strings.
       The <u>hints</u> parameter is an <b>ares_addrinfo_hints</b> structure:

              struct ares_addrinfo_hints {
                int ai_flags;
                int ai_family;
                int ai_socktype;
                int ai_protocol;
              };

       <u>ai_family</u>
              Specifies desired address family. AF_UNSPEC means return both AF_INET and AF_INET6.

       <u>ai_socktype</u>
              Specifies desired socket type, for example SOCK_STREAM or SOCK_DGRAM.  Setting this to 0 means any
              type.

       <u>ai_protocol</u>
              Setting this to 0 means any protocol.

       <u>ai_flags</u>
              Specifies additional options, see below.

       <b>ARES_AI_NUMERICSERV</b>
                          If this option is set <u>service</u> field will be treated as a numeric value.

       <b>ARES_AI_CANONNAME</b>  The ares_addrinfo structure will return a canonical names list.

       <b>ARES_AI_NOSORT</b>     Result addresses will not be sorted and no connections to resolved addresses  will  be
                          attempted.

       <b>ARES_AI_ENVHOSTS</b>   Read hosts file path from the environment variable <u>CARES_HOSTS</u> <u>.</u>

       When  the  query is complete or has failed, the ares library will invoke <u>callback</u>.  Completion or failure
       of  the  query  may  happen  immediately,  or  may  happen  during  a  later  call  to   <u><a href="../man3/ares_process.3.html">ares_process</a>(3)</u>,
       <u><a href="../man3/ares_destroy.3.html">ares_destroy</a>(3)</u> or <u><a href="../man3/ares_cancel.3.html">ares_cancel</a>(3)</u>.

       When  the associated callback is called, it is called with a channel lock so care must be taken to ensure
       any processing is minimal to prevent DNS channel stalls.

       The callback may be triggered from a different thread than the one which called <u><a href="../man3/ares_getaddrinfo.3.html">ares_getaddrinfo</a>(3)</u>.

       For integrators running their own event loops and not using <b>ARES_OPT_EVENT_THREAD</b>, care needs to be taken
       to ensure any file descriptor lists are updated immediately within the eventloop when notified.

       The callback argument <u>arg</u> is copied from the <b><a href="../man3/ares_getaddrinfo.3.html">ares_getaddrinfo</a>(3)</b> argument  <u>arg</u>.   The  callback  argument
       <u>status</u>  indicates  whether  the  query  succeeded  and,  if  not,  how it failed.  It may have any of the
       following values:

       <b>ARES_SUCCESS</b>       The host lookup completed successfully.

       <b>ARES_ENOTIMP</b>       The ares library does not know how to find addresses of type <u>family</u>.

       <b>ARES_ENOTFOUND</b>     The <u>name</u> was not found.

       <b>ARES_ENOMEM</b>        Memory was exhausted.

       <b>ARES_ESERVICE</b>      The textual service name provided could not be dereferenced into a port.

       <b>ARES_ECANCELLED</b>    The query was cancelled.

       <b>ARES_EDESTRUCTION</b>  The name service channel <u>channel</u> is being destroyed; the query will not be completed.

       On successful completion of the query, the callback argument <u>result</u>  points  to  a  <b>struct</b>  <b>ares_addrinfo</b>
       which  contains  two  linked  lists,  one with resolved addresses and another with canonical names.  Also
       included is the official name of the host (analogous to gethostbyname() h_name).

              struct ares_addrinfo {
                struct ares_addrinfo_cname *cnames;
                struct ares_addrinfo_node  *nodes;
                char *name;
              };

       <u>ares_addrinfo_node</u> structure is similar to RFC3493 addrinfo, but without canonname  and  with  extra  ttl
       field.

              struct ares_addrinfo_node {
                int                        ai_ttl;
                int                        ai_flags;
                int                        ai_family;
                int                        ai_socktype;
                int                        ai_protocol;
                ares_socklen_t             ai_addrlen;
                struct sockaddr           *ai_addr;
                struct ares_addrinfo_node *ai_next;
              };

       <u>ares_addrinfo_cname</u>  structure  is  a linked list of CNAME records where <u>ttl</u> is a time to live <u>alias</u> is a
       label of the resource record and <u>name</u> is a value (canonical name) of the resource  record.   See  RFC2181
       10.1.1. CNAME terminology.

              struct ares_addrinfo_cname {
                int                         ttl;
                char                       *alias;
                char                       *name;
                struct ares_addrinfo_cname *next;
              };

       The reserved memory has to be deleted by <b><a href="../man3/ares_freeaddrinfo.3.html">ares_freeaddrinfo</a>(3)</b>.

       The result is sorted according to RFC6724 except:
        - Rule 3 (Avoid deprecated addresses)
        - Rule 4 (Prefer home addresses)
        - Rule 7 (Prefer native transport)

       Please note that the function will attempt a connection on each of the resolved addresses as per RFC6724.

</pre><h4><b>AVAILABILITY</b></h4><pre>
       This function was added in c-ares 1.16.0, released in March 2020.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ares_freeaddrinfo.3.html">ares_freeaddrinfo</a></b>(3)

                                                 4 November 2018                             <u><a href="../man3/ARES_GETADDRINFO.3.html">ARES_GETADDRINFO</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>