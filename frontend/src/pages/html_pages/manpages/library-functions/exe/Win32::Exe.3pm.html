<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Win32::Exe - Manipulate Win32 executable files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libwin32-exe-perl">libwin32-exe-perl_0.17-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Win32::Exe - Manipulate Win32 executable files

</pre><h4><b>VERSION</b></h4><pre>
       This document describes version 0.17 of Win32::Exe, released July 19, 2011.

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Win32::Exe;
           my $exe = Win32::Exe-&gt;new('c:/windows/notepad.exe');

           # add a default resource structure if none exists
           # create_resource_section only works on MSWin and
           # does not work on Windows XP - requires Vista or
           # above

           $exe = $exe-&gt;create_resource_section if $exe-&gt;can_create_resource_section;

           # Get version information
           my $info = $exe-&gt;get_version_info;
           print qq($_ = $info-&gt;{$_}\n) for (sort keys(%$info));

           # Extract icons from an executable
           my @iconnames = $exe-&gt;get_group_icon_names;
           for ( my $i = 0; $i &lt; @iconnames; $i++ ) {
               my $filename = 'icon' . $i . '.ico';
               my $iconname = $iconnames[$i];
               $exe-&gt;extract_group_icon($iconname,$filename);
           }

           # Import icons from a .exe or .ico file and write back the file
           $exe-&gt;update( icon =&gt; '/c/windows/taskman.exe' );
           $exe-&gt;update( icon =&gt; 'myicon.ico' );

           # Change it to a console application, then save to another .exe
           $exe-&gt;set_subsystem_console;
           $exe-&gt;write('c:/windows/another.exe');

           # Add a manifest section
           $exe-&gt;update( manifest =&gt; $mymanifestxml );
           # or a default
           $exe-&gt;update( defaultmanifest =&gt; 1 );

           # or specify manifest args
           $exe-&gt;update( manifestargs =&gt; { ExecLevel =&gt; 'requireAdministrator' } );

           # Get manifest object
           $manifest = $exe-&gt;get_manifest if $exe-&gt;has_manifest;

           # change execution level
           $manifest-&gt;set_execution_level('requireAdministrator');
           $exe-&gt;set_manifest($manifest);
           $exe-&gt;write;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module parses and manipulating Win32 PE/COFF executable headers, including version information,
       icons, manifest and other resources.  The module Win32::Exe::Manifest can be used for manifest handling.

       A script exe_update.pl is provided for simple file updates.

       Also, please see the test files in the source distributions <u>t/</u> directory for examples of using this
       module.

</pre><h4><b>METHODS</b></h4><pre>
   <b>new</b>
           my $exe = Win32::Exe-&gt;new($filename);

       Create a Win32::Exe object from $filename. Filename can be an executable or a DLL.

   <b>update</b>
           $exe-&gt;update( icon         =&gt; 'c:/my/icon.ico',
                         gui          =&gt; 1,
                         info         =&gt; [ 'FileDescription=My File', 'FileVersion=1.4.3.3567' ],
                         manifest     =&gt; 'c:/my/manifest.xml',
                         manifestargs =&gt; [ 'ExecLevel=asInvoker', 'CommonControls=1' ],
                         );

       The <b>update</b> method provides a convenience method for the most common actions. It writes the information
       you provide to the file opened by Win32::Exe-&gt;new($filename).  You do not have to call $exe-&gt;write - the
       method automatically updates the opened file.

       Param detail:

       <b>icon</b> Pass the name of an executable, dll or ico file to extract the icon and make it the main icon for
       the Win32 executable.

       <b>info</b> Pass a reference to an array of strings containing key - value pairs separated by '='.

       e.g. info =&gt; [ 'FileDescription=My File', 'FileVersion=1.4.3.3567' ]

       Recognised keys are

           Comments        CompanyName     FileDescription FileVersion
           InternalName    LegalCopyright  LegalTrademarks OriginalFilename
           ProductName     ProductVersion

       <b>gui</b>  <b>or</b>  <b>console</b> Use parameter 'gui' or 'console' to set the executable subsystem to Windows or Console.
       You can, of course, only use one or the other of gui / console, not both.

       <b>manifest</b> Specify a manifest file to add to the executable resources.

       <b>manifestargs</b> As an alternative to specifying a manifest file, pass a reference to an array of strings
       containing key - value pairs separated by '='.

       e.g. manifestargs =&gt; [ 'ExecLevel=asInvoker', 'CommonControls=1' ]

       Recognised keys are

           ExecutionLevel  UIAccess     ExecName   Description
           CommonControls  Version

   <b>create_resource_section</b>
           $exe = $exe-&gt;create_resource_section if $exe-&gt;can_create_resource_section;

       If an executable file does not have an existing resource section, you must create one before attempting
       to add version, icon or manifest resources. The method create_resource_section is only available on MSWin
       platforms. Also, the method will fail if your windows version is Windows XP or below. You can check if it
       is possible to call create_resource_section by calling $exe-&gt;can_create_resource_section.  After calling
       create_resource_section, the original Win32::Exe object does not reference the updated data. The method
       therefore returns a reference to a new Win32::Exe object that references the updated data.

       Always call as :

       $exe = $exe-&gt;create_resource_section if $exe-&gt;can_create_resource_section;

       if the $exe already has a resource section, this call will safely return a reference to the original
       object without updating the original exe.

   <b>can_create_resource_section</b>
           $exe = $exe-&gt;create_resource_section if $exe-&gt;can_create_resource_section;

       Check if the operating system and version allow addition of a resource section when none exists in the
       target executable.

   <b>get_manifest</b>
           my $manifest = $exe-&gt;get_manifest;

       Retrieves a Win32::Exe::Manifest object. (See docs for Win32::Exe::Manifest)

   <b>set_manifest</b>
           $exe-&gt;set_manifest($manifest);
           $exe-&gt;write;

       Takes a Win32::Exe::Manifest object. You must explicitly call 'write' to commit changes to file. Also
       takes a filepath to an xml file containing raw manifest information.

   <b>set_manifest_args</b>
           $exe-&gt;set_manifest_args($argref);
           $exe-&gt;write;

       Accepts a reference to a hash with one or more of the the keys

           ExecutionLevel  UIAccess     ExecName   Description
           CommonControls  Version

       Also accepts a reference to an array of strings of the format:
           [ 'key1=value1', 'key2=value2' ]

       Example Values:

           ExecutionLevel=asInvoker
           UIAccess=false
           CommonControls=1
           Version=6.8.67.334534
           ExecName=My.Application
           Description=My Application

       The CommonControls argument can be specified to add a dependency on Common Controls Library version
       6.0.0.0

   <b>get_version_info</b>
           my $inforef = $exe-&gt;get_version_info;

       Returns a reference to a hash with the keys:

           Comments        CompanyName     FileDescription FileVersion
           InternalName    LegalCopyright  LegalTrademarks OriginalFilename
           ProductName     ProductVersion

   <b>set_version_info</b>
           $exe-&gt;set_version_info($inforef);
           $exe-&gt;write;

       Accepts a reference to a hash with one or more of the the keys

           Comments        CompanyName     FileDescription FileVersion
           InternalName    LegalCopyright  LegalTrademarks OriginalFilename
           ProductName     ProductVersion

       Also accepts a reference to an array of strings of the format:
           [ 'key1=value1', 'key2=value2' ]

   <b>set_subsystem_windows</b>
           $exe-&gt;set_subsystem_windows;
           $exe-&gt;write;

       Sets the executable system as 'windows'. (GUI).  You may also call $exe-&gt;SetSubsystem('windows); This is
       the equivalent of $exe-&gt;update( gui =&gt; 1);

   <b>set_subsystem_console</b>
           $exe-&gt;set_subsystem_console;
           $exe-&gt;write;

       Sets the executable system as 'console'.  You may also call $exe-&gt;SetSubsystem('console); This is the
       equivalent of $exe-&gt;update( console =&gt; 1);

   <b>get_subsystem</b>
           my $subsys = $exe-&gt;get_subsystem;

       Returns a descriptive string for the subsystem.  Possible values:  windows | console | posix | windowsce
       | native You can usefully update executables with the windows or console subsystem

   <b>set_single_group_icon</b>
           $exe-&gt;set_single_group_icon($iconfile);
           $exe-&gt;write;

       Accepts the path to an icon file. Replaces all the icons in the exec with the icons from the file.

   <b>get_group_icon_names</b>
           my @iconnames = $exe-&gt;get_group_icon_names;

       Returns a list of the names of all the group icons in the executable or dll. If there are no group icons,
       returns an empty list. The names returned can be used as parameters to other icon handling methods.

   <b>get_group_icon</b>
           $exe-&gt;get_group_icon($groupiconname);

       Accepts a group icon name as returned by get_group_icon_names.  Returns the Wx::Exe::Resource::GroupIcon
       object for the named GroupIcon

   <b>add_group_icon</b>
           $exe-&gt;add_group_icon($groupiconname, $iconfilepath);
           $exe-&gt;write;

       Accepts a group icon name and a path to an icon file. Adds the icon to the exec without affecting
       existing icons. The group icon name must not already exist.

   <b>replace_group_icon</b>
           $exe-&gt;replace_group_icon($groupiconname, $iconfilepath);
           $exe-&gt;write;

       Accepts a group icon name and a path to an icon file.  Replaces the groupicon named with the contents of
       the icon file.

   <b>remove_group_icon</b>
           $exe-&gt;remove_group_icon($groupiconname);
           $exe-&gt;write;

       Accepts a group icon name. Removes the group icon with that name from the exec or dll.

   <b>export_group_icon</b>
           $exe-&gt;export_group_icon($groupiconname, $iconfilepath);

       Accepts a group icon name and a .ico filepath. Writes the named icon group to the file in filepath.

</pre><h4><b>AUTHORS</b></h4><pre>
       Audrey Tang &lt;<a href="mailto:cpan@audreyt.org">cpan@audreyt.org</a>&gt;

       Mark Dootson &lt;<a href="mailto:mdootson@cpan.org">mdootson@cpan.org</a>&gt;

       Steffen Mueller &lt;<a href="mailto:smueller@cpan.org">smueller@cpan.org</a>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2004-2007, 2010 by Audrey Tang &lt;<a href="mailto:cpan@audreyt.org">cpan@audreyt.org</a>&gt;.

       This program is free software; you can redistribute it and/or modify it under the same terms as Perl
       itself.

       See &lt;<a href="http://www.perl.com/perl/misc/Artistic.html">http://www.perl.com/perl/misc/Artistic.html</a>&gt;

perl v5.34.0                                       2022-08-14                                    <u>Win32::<a href="../man3pm/Exe.3pm.html">Exe</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>