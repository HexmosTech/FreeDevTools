<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text::MicroMason::Safe - Compile all Templates in a Safe Compartment</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtext-micromason-perl">libtext-micromason-perl_2.23-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Text::MicroMason::Safe - Compile all Templates in a Safe Compartment

</pre><h4><b>SYNOPSIS</b></h4><pre>
       Instead of using this class directly, pass its name to be mixed in:

         use Text::MicroMason;
         my $mason = Text::MicroMason-&gt;new( -Safe );

       Use the standard compile and execute methods to parse and evaluate templates:

         print $mason-&gt;compile( text=&gt;$template )-&gt;( @%args );
         print $mason-&gt;execute( text=&gt;$template, @args );

       Safe usage restricts templates from accessing your files or data:

         print $mason-&gt;execute( text=&gt;"&lt;% qx! cat <a href="file:/etc/passwd">/etc/passwd</a> ! %&gt;" ); # dies

         print $mason-&gt;execute( text=&gt;"The time is &lt;% time() %&gt;." ); # dies

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This package adds support for Safe compartments to MicroMason, allowing you to  restrict the operations
       that a template can perform.

       By default, these safe calls prevent the code in a template from performing any system activity or
       accessing any of your other Perl code.  Violations may result in either compile-time or run-time errors,
       so make sure you are using an eval block or the CatchErrors trait to catch exceptions.

         use Text::MicroMason;
         my $mason = Text::MicroMason-&gt;new( -Safe );

         $result = eval { $mason-&gt;execute( text =&gt; $template ) };

       <b>Caution:</b> Although this appears to provide a significant amount of security for untrusted templates,
       please take this with a grain of salt. A bug in either this module or in the core Safe module could allow
       a clever attacker to defeat the protection. At least one bug in the Safe module has been found and fixed
       in years past, and there could be others.

   <b>Supported</b> <b>Attributes</b>
       safe
           Optional reference to a Safe compartment. If you do not provide this, one is generated for you.

           To  enable  some  operations  or  share  variables or functions with the template code, create a Safe
           compartment and configure it before passing it in as the value of the "safe" attribute:

             $safe = Safe-&gt;new();
             $safe-&gt;permit('time');
             $safe-&gt;share('$foo');

             $mason = Text::MicroMason-&gt;new( -Safe, safe =&gt; $safe );

             $result = eval { $mason-&gt;execute( text =&gt; $template ) };

       safe_methods
           <b>IMPORTANT</b> <b>NOTE:</b> The "safe_methods" parameter is deprecated and will be removed in future versions  of
           Text::MicroMason  (unless  a  Safe  and  future-proof  implementation can be found).  If you use this
           parameter, you will receive a warning via carp:

           "* WARNING: safe_methods is deprecated; please see the pod"

           This parameter works correctly with sufficiently old versions  of  the  Safe  module  (prior  to  the
           release of perl 5.12.1), but modern versions of Safe make it impossible for a Safe compartment to run
           any  code outside the compartment.  Even with the object shared within the Safe compartment, there is
           currently no known way to call methods on it without defining the whole class within the  compartment
           (which isn't safe).

           If  anyone has an appropriately safe solution that will allow "safe_methods" to work, please submit a
           patch to the module maintainer.  Also see t/32-safe.t for tests related to  "safe_methods"  that  are
           currently being skipped.

           The  following  pod is provided for legacy purposes only.  It is strongly recommended that you do not
           use this method.  It is no longer allowed to call methods from within a "Safe" template,  because  it
           isn't actually safe.

           A space-separated string of methods names to be supported by the Safe::Facade.

           To  control  which Mason methods are available within the template, pass a "safe_methods" argument to
           <b>new()</b> followed by the method names in a space-separated string.

           For example, to allow templates to include other templates, using $m-&gt;execute or  the  "&lt;&amp;  file  &amp;&gt;"
           include  syntax,  you  would  need to allow the execute method. We'll also load the TemplateDir mixin
           with strict_root on to prevent inclusion of templates from outside the current directory.

             # safe_methods is DEPRECATED, please see above
             $mason = Text::MicroMason-&gt;new( -Safe, safe_methods =&gt; 'execute',
                                             -TemplateDir, strict_root =&gt; 1 );

           If you're combining this with the Filters mixin, you'll also  need  to  allow  calls  to  the  filter
           method; to allow multiple methods, join their names with spaces:

             # safe_methods is DEPRECATED, please see above
             $mason = Text::MicroMason-&gt;new( -Safe, safe_methods =&gt; 'execute filter',
                                             -TemplateDir, strict_root =&gt; 1,
                                             -Filters );

   <b>Private</b> <b>Methods</b>
       <b>eval_sub()</b>
           Instead of the <b>eval()</b> used by the base class, this calls <b>reval()</b> on a Safe compartment.

       <b>safe_compartment()</b>
           Returns the Safe compartment passed by the user or generates a new one.

       <b>safe_facade()</b>
           Generates  an  instance of the Safe::Facade equipped with only the methods listed in the safe_methods
           attribute.

   <b>Private</b> <b>Safe::Facade</b> <b>class</b>
       Code compiled in a Safe compartment only has access to a limited version of the template compiler in  the
       $m  variable,  and  can  not  make  changes to the attributes of the real MicroMason object. This limited
       object is an instance of the Text::MicroMason::Safe::Facade class  and  can  only  perform  certain  pre-
       defined methods.

       <b>new()</b>
           Creates a new hash-based instance mapping method names to subroutine references.

       <b>facade_method()</b>
           Calls a named method by looking up the corresponding subroutine and calling it.

       <b>AUTOLOAD()</b>
           Generates wrapper methods that call the <b>facade_method()</b> for any lowercase method name.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       For an overview of this templating framework, see Text::MicroMason.

       This is a mixin class intended for use with Text::MicroMason::Base.

       For     distribution,     installation,    support,    copyright    and    license    information,    see
       Text::MicroMason::Docs::ReadMe.

perl v5.36.0                                       2023-08-10                        <u>Text::MicroMason::<a href="../man3pm/Safe.3pm.html">Safe</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>