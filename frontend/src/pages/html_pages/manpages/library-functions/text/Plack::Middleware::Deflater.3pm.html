<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plack::Middleware::Deflater - Compress response body with Gzip or Deflate</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libplack-middleware-deflater-perl">libplack-middleware-deflater-perl_0.14-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Plack::Middleware::Deflater - Compress response body with Gzip or Deflate

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Plack::Builder;

         builder {
           enable sub {
               my $app = shift;
               sub {
                   my $env = shift;
                   my $ua = $env-&gt;{HTTP_USER_AGENT} || '';
                   # Netscape has some problem
                   $env-&gt;{"psgix.compress-only-text/html"} = 1 if $ua =~ m!^Mozilla/4!;
                   # Netscape 4.06-4.08 have some more problems
                    $env-&gt;{"psgix.no-compress"} = 1 if $ua =~ m!^Mozilla/4\.0[678]!;
                   # MSIE (7|8) masquerades as Netscape, but it is fine
                   if ( $ua =~ m!\bMSIE (?:7|8)! ) {
                       $env-&gt;{"psgix.no-compress"} = 0;
                       $env-&gt;{"psgix.compress-only-text/html"} = 0;
                   }
                   $app-&gt;($env);
               }
           };
           enable "Deflater",
               content_type =&gt; ['text/css','text/html','text/javascript','application/javascript'],
               vary_user_agent =&gt; 1;
           sub { [200,['Content-Type','text/html'],["OK"]] }
         };

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Plack::Middleware::Deflater is a middleware to encode your response body in gzip or deflate, based on
       "Accept-Encoding" HTTP request header. It would save the bandwidth a little bit but should increase the
       Plack server load, so ideally you should handle this on the frontend reverse proxy servers.

       This middleware removes "Content-Length" and streams encoded content, which means the server should
       support HTTP/1.1 chunked response or downgrade to HTTP/1.0 and closes the connection.

</pre><h4><b>CONFIGURATIONS</b></h4><pre>
       content_type
             content_type =&gt; 'text/html',
             content_type =&gt; [ 'text/html', 'text/css', 'text/javascript', 'application/javascript', 'application/x-javascript' ]

           Content-Type  header  to apply deflater. if content-type is not defined, Deflater will try to deflate
           all contents.

       vary_user_agent
             vary_user_agent =&gt; 1

           Add "User-Agent" to Vary header.

</pre><h4><b>ENVIRONMENT</b> <b>VALUE</b></h4><pre>
       psgix.no-compress
           Do not apply deflater

       psgix.compress-only-text/html
           Apply deflater only if content_type is "text/html"

       plack.skip-deflater
           Skip all Deflater features

   <b>Compare</b> <b>psgix.no-compress</b> <b>with</b> <b>plack.skip-deflater</b>
       If no-compress is true, PM::Deflater skips gzip or deflate. But  adds  Vary:  Accept-Encoding  and  Vary:
       User-Agent  header.  skip-deflater  forces  to  skip  all PM::Deflater feature, doesn't allow to add Vary
       header.

</pre><h4><b>LICENSE</b></h4><pre>
       This software is licensed under the same terms as Perl itself.

</pre><h4><b>AUTHOR</b></h4><pre>
       Tatsuhiko Miyagawa

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Plack, &lt;<a href="http://httpd.apache.org/docs/2.2/en/mod/mod_deflate.html">http://httpd.apache.org/docs/2.2/en/mod/mod_deflate.html</a>&gt;

perl v5.38.2                                       2024-05-15                   <u>Plack::Middleware::<a href="../man3pm/Deflater.3pm.html">Deflater</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>