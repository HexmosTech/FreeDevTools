<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_DigestSignInit_ex, EVP_DigestSignInit, EVP_DigestSignUpdate, EVP_DigestSignFinal, EVP_DigestSign -</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_DigestSignInit_ex, EVP_DigestSignInit, EVP_DigestSignUpdate, EVP_DigestSignFinal, EVP_DigestSign -
       EVP signing functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/evp.h&gt;

        int EVP_DigestSignInit_ex(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
                                  const char *mdname, OSSL_LIB_CTX *libctx,
                                  const char *props, EVP_PKEY *pkey,
                                  const OSSL_PARAM params[]);
        int EVP_DigestSignInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
                               const EVP_MD *type, ENGINE *e, EVP_PKEY *pkey);
        int EVP_DigestSignUpdate(EVP_MD_CTX *ctx, const void *d, size_t cnt);
        int EVP_DigestSignFinal(EVP_MD_CTX *ctx, unsigned char *sig, size_t *siglen);

        int EVP_DigestSign(EVP_MD_CTX *ctx, unsigned char *sig,
                           size_t *siglen, const unsigned char *tbs,
                           size_t tbslen);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The EVP signature routines are a high-level interface to digital signatures.  Input data is digested
       first before the signing takes place.

       <b>EVP_DigestSignInit_ex()</b> sets up signing context <u>ctx</u> to use a digest with the name <u>mdname</u> and private key
       <u>pkey</u>. The name of the digest to be used is passed to the provider of the signature algorithm in use. How
       that provider interprets the digest name is provider specific. The provider may implement that digest
       directly itself or it may (optionally) choose to fetch it (which could result in a digest from a
       different provider being selected). If the provider supports fetching the digest then it may use the
       <u>props</u> argument for the properties to be used during the fetch. Finally, the passed parameters <u>params</u>, if
       not NULL, are set on the context before returning.

       The <u>pkey</u> algorithm is used to fetch a <b>EVP_SIGNATURE</b> method implicitly, to be used for the actual signing.
       See "Implicit fetch" in <b><a href="../man7/provider.7.html">provider</a></b>(7) for more information about implicit fetches.

       The OpenSSL default and legacy providers support fetching digests and can fetch those digests from any
       available provider. The OpenSSL FIPS provider also supports fetching digests but will only fetch digests
       that are themselves implemented inside the FIPS provider.

       <u>ctx</u> must be created with <b>EVP_MD_CTX_new()</b> before calling this function. If <u>pctx</u> is not NULL, the
       EVP_PKEY_CTX of the signing operation will be written to <u>*pctx</u>: this can be used to set alternative
       signing options. Note that any existing value in <u>*pctx</u> is overwritten. The EVP_PKEY_CTX value returned
       must not be freed directly by the application if <u>ctx</u> is not assigned an EVP_PKEY_CTX value before being
       passed to <b>EVP_DigestSignInit_ex()</b> (which means the EVP_PKEY_CTX is created inside <b>EVP_DigestSignInit_ex()</b>
       and it will be freed automatically when the EVP_MD_CTX is freed). If the EVP_PKEY_CTX to be used is
       created by EVP_DigestSignInit_ex then it will use the <b>OSSL_LIB_CTX</b> specified in <u>libctx</u> and the property
       query string specified in <u>props</u>.

       The digest <u>mdname</u> may be NULL if the signing algorithm supports it. The <u>props</u> argument can always be
       NULL.

       No <b>EVP_PKEY_CTX</b> will be created by <b>EVP_DigestSignInit_ex()</b> if the passed <u>ctx</u> has already been assigned
       one via <b><a href="../man3/EVP_MD_CTX_set_pkey_ctx.3.html">EVP_MD_CTX_set_pkey_ctx</a></b>(3).  See also <b><a href="../man7/SM2.7.html">SM2</a></b>(7).

       Only EVP_PKEY types that support signing can be used with these functions. This includes MAC algorithms
       where the MAC generation is considered as a form of "signing". Built-in EVP_PKEY types supported by these
       functions are CMAC, Poly1305, DSA, ECDSA, HMAC, RSA, SipHash, Ed25519 and Ed448.

       Not all digests can be used for all key types. The following combinations apply.

       DSA Supports SHA1, SHA224, SHA256, SHA384 and SHA512

       ECDSA
           Supports SHA1, SHA224, SHA256, SHA384, SHA512 and SM3

       RSA with no padding
           Supports no digests (the digest <u>type</u> must be NULL)

       RSA with X931 padding
           Supports SHA1, SHA256, SHA384 and SHA512

       All other RSA padding types
           Support  SHA1,  SHA224,  SHA256,  SHA384,  SHA512, MD5, MD5_SHA1, MD2, MD4, MDC2, SHA3-224, SHA3-256,
           SHA3-384, SHA3-512

       Ed25519 and Ed448
           Support no digests (the digest <u>type</u> must be NULL)

       HMAC
           Supports any digest

       CMAC, Poly1305 and SipHash
           Will ignore any digest provided.

       If RSA-PSS is used and restrictions apply then the digest must match.

       <b>EVP_DigestSignInit()</b> works in the same way as <b>EVP_DigestSignInit_ex()</b> except that  the  <u>mdname</u>  parameter
       will  be inferred from the supplied digest <u>type</u>, and <u>props</u> will be NULL. Where supplied the ENGINE <u>e</u> will
       be used for the signing and digest algorithm implementations. <u>e</u> may be NULL.

       <b>EVP_DigestSignUpdate()</b> hashes <u>cnt</u> bytes of data at <u>d</u> into the signature context <u>ctx</u>. This function can be
       called several times on the same <u>ctx</u> to include additional data. <u>ctx</u> <b>MUST</b> <b>NOT</b> be NULL.

       Unless <u>sig</u> is NULL <b>EVP_DigestSignFinal()</b> signs  the  data  in  <u>ctx</u>  and  places  the  signature  in  <u>sig</u>.
       Otherwise  the  maximum necessary size of the output buffer is written to the <u>siglen</u> parameter. If <u>sig</u> is
       not NULL then before the call the <u>siglen</u> parameter should contain the length of the <u>sig</u>  buffer.  If  the
       call is successful the signature is written to <u>sig</u> and the amount of data written to <u>siglen</u>.

       <b>EVP_DigestSign()</b> is similar to a single call to <b>EVP_DigestSignUpdate()</b> and <b>EVP_DigestSignFinal()</b>.  Unless
       <u>sig</u>  is  NULL,  <b>EVP_DigestSign()</b>  signs the data <u>tbs</u> of length <u>tbslen</u> bytes and places the signature in a
       buffer <u>sig</u> of size <u>siglen</u>.  If <u>sig</u> is NULL, the maximum necessary size of the signature buffer is written
       to the <u>siglen</u> parameter.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>EVP_DigestSignInit()</b>, <b>EVP_DigestSignUpdate()</b>, <b>EVP_DigestSignFinal()</b> and  <b>EVP_DigestSign()</b>  return  1  for
       success and 0 for failure.

       The error codes can be obtained from <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3).

</pre><h4><b>NOTES</b></h4><pre>
       The  <b>EVP</b>  interface  to  digital  signatures  should almost always be used in preference to the low-level
       interfaces. This is because the code then becomes  transparent  to  the  algorithm  used  and  much  more
       flexible.

       <b>EVP_DigestSign()</b>  is  a  one  shot  operation  which  signs  a  single block of data in one function. For
       algorithms  that  support  streaming   it   is   equivalent   to   calling   <b>EVP_DigestSignUpdate()</b>   and
       <b>EVP_DigestSignFinal()</b>.  For algorithms which do not support streaming (e.g. PureEdDSA) it is the only way
       to sign data.

       In previous versions of OpenSSL there was a link between message digest types and public key  algorithms.
       This  meant that "clone" digests such as <b>EVP_dss1()</b> needed to be used to sign using SHA1 and DSA. This is
       no longer necessary and the use of clone digest is now discouraged.

       For some key types and parameters the random number generator must be seeded.  If the  automatic  seeding
       or  reseeding of the OpenSSL CSPRNG fails due to external circumstances (see <b><a href="../man7/RAND.7.html">RAND</a></b>(7)), the operation will
       fail.

       The call to <b>EVP_DigestSignFinal()</b> internally finalizes a copy of the  digest  context.  This  means  that
       calls  to  <b>EVP_DigestSignUpdate()</b>  and  <b>EVP_DigestSignFinal()</b>  can  be  called  later  to digest and sign
       additional data.  Applications may disable this behavior by setting the EVP_MD_CTX_FLAG_FINALISE  context
       flag via <b><a href="../man3/EVP_MD_CTX_set_flags.3.html">EVP_MD_CTX_set_flags</a></b>(3).

       Note  that  not  all  providers  support  continuation,  in  case the selected provider does not allow to
       duplicate contexts <b>EVP_DigestSignFinal()</b> will finalize the  digest  context  and  attempting  to  process
       additional data via <b>EVP_DigestSignUpdate()</b> will result in an error.

       <b>EVP_DigestSignInit()</b>  and <b>EVP_DigestSignInit_ex()</b> functions can be called multiple times on a context and
       the parameters set by previous calls should be preserved if the <u>pkey</u> parameter is  NULL.  The  call  then
       just resets the state of the <u>ctx</u>.

       <b>EVP_DigestSign()</b>  can  not  be  called again, once a signature is generated (by passing <u>sig</u> as non NULL),
       unless the <b>EVP_MD_CTX</b> is reinitialised by calling <b>EVP_DigestSignInit_ex()</b>.

       Ignoring failure returns of  <b>EVP_DigestSignInit()</b>  and  <b>EVP_DigestSignInit_ex()</b>  functions  can  lead  to
       subsequent   undefined   behavior   when   calling   <b>EVP_DigestSignUpdate()</b>,   <b>EVP_DigestSignFinal()</b>,  or
       <b>EVP_DigestSign()</b>.

       The use of <b>EVP_PKEY_get_size()</b> with these functions is discouraged because some signature operations  may
       have  a  signature length which depends on the parameters set. As a result <b>EVP_PKEY_get_size()</b> would have
       to return a value which indicates the maximum possible signature for any set of parameters.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_DigestVerifyInit.3.html">EVP_DigestVerifyInit</a></b>(3), <b><a href="../man3/EVP_DigestInit.3.html">EVP_DigestInit</a></b>(3),  <b><a href="../man7/evp.7.html">evp</a></b>(7),  <b><a href="../man3/HMAC.3.html">HMAC</a></b>(3),  <b><a href="../man3/MD2.3.html">MD2</a></b>(3),  <b><a href="../man3/MD5.3.html">MD5</a></b>(3),  <b><a href="../man3/MDC2.3.html">MDC2</a></b>(3),  <b><a href="../man3/RIPEMD160.3.html">RIPEMD160</a></b>(3),
       <b><a href="../man3/SHA1.3.html">SHA1</a></b>(3), <b><a href="../man1/openssl-dgst.1.html">openssl-dgst</a></b>(1), <b><a href="../man7/RAND.7.html">RAND</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>EVP_DigestSignInit()</b>, <b>EVP_DigestSignUpdate()</b> and <b>EVP_DigestSignFinal()</b> were added in OpenSSL 1.0.0.

       <b>EVP_DigestSignInit_ex()</b> was added in OpenSSL 3.0.

       <b>EVP_DigestSignUpdate()</b> was converted from a macro to a function in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2006-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                           <u><a href="../man3SSL/EVP_DIGESTSIGNINIT.3SSL.html">EVP_DIGESTSIGNINIT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>