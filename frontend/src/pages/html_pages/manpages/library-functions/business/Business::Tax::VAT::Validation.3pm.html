<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business::Tax::VAT::Validation - Validate EU VAT numbers against VIES/HMRC</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libbusiness-tax-vat-validation-perl">libbusiness-tax-vat-validation-perl_1.24-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Business::Tax::VAT::Validation - Validate EU VAT numbers against VIES/HMRC

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Business::Tax::VAT::Validation;

         my $hvatn=Business::Tax::VAT::Validation-&gt;new();

         # Check number
         if ($hvatn-&gt;check($VAT, [$member_state])){
               print "OK\n";
         } else {
               print $hvatn-&gt;get_last_error;
         }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This class provides an easy API to check European VAT numbers' syntax, and check if they have been
       registered by the competent authorities.

       It asks the EU database (VIES) for this, using its SOAP API.  Basic checks that the supplied VAT number
       fit the expected format for the specified EU member state are performed first, to avoid unnecessarily
       sending queries to VIES for input that could never be valid.

       It also supports looking up VAT codes from the United Kingdom by using the REST API provided by their
       HMRC.

</pre><h4><b>CONSTRUCTOR</b></h4><pre>
       <b>new</b> Class constructor.
               $hvatn=Business::Tax::VAT::Validation-&gt;new();

               # If your system is located behind a proxy :

               $hvatn=Business::Tax::VAT::Validation-&gt;new(-proxy =&gt; ['http', '<a href="http://example.com">http://example.com</a>:8001/']);

               # Note : See LWP::UserAgent for proxy options.

</pre><h4><b>PROPERTIES</b></h4><pre>
       <b>member_states</b> Returns all supported country codes.
           These  are  ISO 3166-1 alpha-2 country codes with two exceptions. This module supports VAT codes from
           all current European Union member states and  The  United  Kingdom  of  Great  Britain  and  Northern
           Ireland.

           "EL" Greece
               Must be used in place of Greece's proper code.

           "XI" Northern Ireland
               May be used rather than "GB" for checking a Northern Irish company.

               @ms=$hvatn-&gt;member_states;

       <b>regular_expressions</b> - Returns a hash list containing one regular expression for each country
           If  you  want  to  test  a VAT number format ouside this module, e.g. embedded as javascript in a web
           form.

               %re=$hvatn-&gt;regular_expressions;

           returns

               (
               AT      =&gt;  'U[0-9]{8}',
               ...
               SK        =&gt;  '[0-9]{10}',
               );

</pre><h4><b>METHODS</b></h4><pre>
       <b>check</b> - Checks if a VAT number exists in the VIES database
               $ok=$hvatn-&gt;check($vatNumber, [$countryCode]);

           You may either provide the VAT number under its complete form  (e.g.  BE-123456789,  BE123456789)  or
           specify the VAT and MSC (vatNumber and countryCode) individually.

           Valid MS values are :

            AT, BE, BG, CY, CZ, DE, DK, EE, EL, ES,
            FI, FR, GB, HR, HU, IE, IT, LU, LT, LV,
            MT, NL, PL, PT, RO, SE, SI, SK, XI

       <b>local_check</b> - Checks if a VAT number format is valid This method is based on regexps only and DOES NOT
       ask the VIES database
               $ok=$hvatn-&gt;local_check($VAT, [$member_state]);

       <b>information</b> - Returns information related to the last checked VAT number
               # Get all available information as a hashref:
               my $info = $hvatn-&gt;information();

               # Get a particular key:
               my $address = $hvatn-&gt;information('address');

           Which  information  is offered depends on the checker used - for UK VAT numbers, checked via the HMRC
           API, "address" is the only key which will be set.

           For EU VAT numbers checked via VIES, you can expect "name" and "address".  This hashref will be reset
           every time you call <b>check()</b> or <b>local_check()</b>

       <b>get_last_error_code</b> - Returns the last recorded error code
       <b>get_last_error</b> - Returns the last recorded error
               my $err = $hvatn-&gt;get_last_error_code();
               my $txt = $hvatn-&gt;get_last_error();

           Possible errors are :

           •   -1  The provided VAT number is valid (so, no error occurred)

           •   0  Unknown MS code : Internal checkup failed (Specified Member State does not exist)

           •   1  Invalid VAT number format : Internal checkup failed (bad syntax)

           •   2  This VAT number doesn't exist in EU database : distant checkup

           •   3  This VAT number contains errors : distant checkup

           •   17  Time out connecting to the database : Temporary error when the  connection  to  the  database
               times out

           •   18   Member  Sevice  Unavailable:  The  EU  database  is  unable  to reach the requested member's
               database.

           •   19  The EU database is too busy.

           •   20  Connexion to the VIES database failed.

           •   21  The VIES interface failed to parse a stream. This error occurs unpredictabely, so you  should
               retry your validation request.

           •   257   Invalid response, please contact the author of this module. : This normally only happens if
               this software doesn't recognize any valid pattern into  the  response  document:  this  generally
               means  that  the  database  interface  has  been  modified,  and  you'll make the author happy by
               submitting the returned response !!!

           •   500  The VIES server encountered an internal server error.  Error 500 : soap:Server TIMEOUT Error
               500 : soap:Server MS_UNAVAILABLE

           If error_code &gt; 16,  you should temporarily accept the provided number, and periodically perform  new
           checks  until  response  is  OK  or error &lt; 17 If error_code &gt; 256, you should temporarily accept the
           provided number, contact the author, and perform a new check when the software is updated.

       <b>get_last_response</b> - Returns the full last response

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       LWP::UserAgent

       &lt;https://ec.europa.eu/taxation_customs/vies/#/faq&gt; for the FAQs related to the VIES service.

       &lt;https://www.api.gov.uk/ch/companies-house&gt; for details of the service provided by the UK's HMRC.

</pre><h4><b>FEEDBACK</b></h4><pre>
       If you find this module useful, or have any comments, suggestions or improvements, feel free  to  let  me
       know.

</pre><h4><b>AUTHOR</b></h4><pre>
       Original author: Bernard Nauwelaerts &lt;<a href="mailto:bpgn@cpan.org">bpgn@cpan.org</a>&gt;

       Maintainership since 2015: David Precious (BIGPRESH) &lt;<a href="mailto:davidp@preshweb.co.uk">davidp@preshweb.co.uk</a>&gt;

</pre><h4><b>CREDITS</b></h4><pre>
       Many  thanks to the following people, actively involved in the development of this software by submitting
       patches, bug reports, new members regexps, VIES interface changes,... (sorted by last intervention) :

       •   Gregor Herrmann, Debian.

       •   Graham Knop.

       •   Bart Heupers, Netherlands.

       •   Martin H. Sluka, noris network AG, Germany.

       •   Simon Williams, UK2 Limited, United Kingdom

       •   Benoît Galy, Greenacres, France

       •   Raluca Boboia, Evozon, Romania

       •   Dave O., POBox, U.S.A.

       •   Kaloyan Iliev, Digital Systems, Bulgaria.

       •   Tom Kirkpatrick, Virus Bulletin, United Kingdom.

       •   Andy Wardley, individual, United Kingdom.

       •   Robert Alloway, Service Centre, United Kingdom.

       •   Torsten Mueller, Archesoft, Germany

       •   Dave Lambley (davel), GoDaddy, United Kingdom

           item * Tatu Wikman (tswfi)

</pre><h4><b>LICENSE</b></h4><pre>
       GPL3. Enjoy! See COPYING for further information on the GPL.

</pre><h4><b>DISCLAIMER</b></h4><pre>
       See &lt;<a href="http://ec.europa.eu/taxation_customs/vies/viesdisc.do">http://ec.europa.eu/taxation_customs/vies/viesdisc.do</a>&gt; to known the limitations of the EU validation
       service.

         This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
         without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

perl v5.40.1                                       2025-05-25                <u>Business::Tax::VAT::<a href="../man3pm/Validation.3pm.html">Validation</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>