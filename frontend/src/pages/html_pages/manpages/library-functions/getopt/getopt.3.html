<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>getopt, getopt_long, getopt_long_only, optarg, optind, opterr, optopt - Parse command-line options</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       getopt, getopt_long, getopt_long_only, optarg, optind, opterr, optopt - Parse command-line options

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;</b>

       <b>int</b> <b>getopt(int</b> <u>argc</u><b>,</b> <b>char</b> <b>*</b><u>argv</u><b>[],</b>
                  <b>const</b> <b>char</b> <b>*</b><u>optstring</u><b>);</b>

       <b>extern</b> <b>char</b> <b>*</b><u>optarg</u><b>;</b>
       <b>extern</b> <b>int</b> <u>optind</u><b>,</b> <u>opterr</u><b>,</b> <u>optopt</u><b>;</b>

       <b>#include</b> <b>&lt;<a href="file:/usr/include/getopt.h">getopt.h</a>&gt;</b>

       <b>int</b> <b>getopt_long(int</b> <u>argc</u><b>,</b> <b>char</b> <b>*</b><u>argv</u><b>[],</b>
                  <b>const</b> <b>char</b> <b>*</b><u>optstring</u><b>,</b>
                  <b>const</b> <b>struct</b> <b>option</b> <b>*</b><u>longopts</u><b>,</b> <b>int</b> <b>*</b><u>longindex</u><b>);</b>
       <b>int</b> <b>getopt_long_only(int</b> <u>argc</u><b>,</b> <b>char</b> <b>*</b><u>argv</u><b>[],</b>
                  <b>const</b> <b>char</b> <b>*</b><u>optstring</u><b>,</b>
                  <b>const</b> <b>struct</b> <b>option</b> <b>*</b><u>longopts</u><b>,</b> <b>int</b> <b>*</b><u>longindex</u><b>);</b>

   Feature Test Macro Requirements for glibc (see <b><a href="../man7/feature_test_macros.7.html">feature_test_macros</a></b>(7)):

       <b>getopt</b>():
           _POSIX_C_SOURCE &gt;= 2 || _XOPEN_SOURCE

       <b>getopt_long</b>(), <b>getopt_long_only</b>():
           _GNU_SOURCE

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>getopt</b>()  function  parses the command-line arguments.  Its arguments <u>argc</u> and <u>argv</u> are the argument
       count and array as passed to the <u>main</u>() function on program invocation.  An element of <u>argv</u>  that  starts
       with  '-'  (and  is not exactly "-" or "--") is an option element.  The characters of this element (aside
       from the initial '-') are option characters.  If <b>getopt</b>() is called repeatedly, it  returns  successively
       each of the option characters from each of the option elements.

       The  variable  <u>optind</u>  is  the index of the next element to be processed in <u>argv</u>.  The system initializes
       this value to 1.  The caller can reset it to 1 to restart scanning of the same <u>argv</u>, or when  scanning  a
       new argument vector.

       If  <b>getopt</b>()  finds  another  option character, it returns that character, updating the external variable
       <u>optind</u> and a static variable <u>nextchar</u> so that the next call to <b>getopt</b>() can  resume  the  scan  with  the
       following option character or <u>argv</u>-element.

       If  there  are  no  more option characters, <b>getopt</b>() returns -1.  Then <u>optind</u> is the index in <u>argv</u> of the
       first <u>argv</u>-element that is not an option.

       <u>optstring</u> is a string containing the legitimate option characters.  A legitimate option character is  any
       visible  one byte <b><a href="../man7/ascii.7.html">ascii</a></b>(7) character (for which <b><a href="../man3/isgraph.3.html">isgraph</a></b>(3) would return nonzero) that is not '-', ':', or
       ';'.  If such a character is followed by a colon, the option requires an argument, so <b>getopt</b>()  places  a
       pointer  to  the  following  text in the same <u>argv</u>-element, or the text of the following <u>argv</u>-element, in
       <u>optarg</u>.  Two colons mean an option takes an optional arg; if there is text in  the  current  <u>argv</u>-element
       (i.e.,  in the same word as the option name itself, for example, "-oarg"), then it is returned in <u>optarg</u>,
       otherwise <u>optarg</u> is set to zero.  This is a GNU  extension.   If  <u>optstring</u>  contains  <b>W</b>  followed  by  a
       semicolon,  then  <b>-W</b>  <b>foo</b> is treated as the long option <b>--foo</b>.  (The <b>-W</b> option is reserved by POSIX.2 for
       implementation extensions.)  This behavior is a GNU extension, not available with libraries before  glibc
       2.

       By default, <b>getopt</b>() permutes the contents of <u>argv</u> as it scans, so that eventually all the nonoptions are
       at  the  end.  Two other scanning modes are also implemented.  If the first character of <u>optstring</u> is '+'
       or the environment variable <b>POSIXLY_CORRECT</b> is set, then option processing stops as soon as  a  nonoption
       argument  is  encountered.   If  '+'  is  not the first character of <u>optstring</u>, it is treated as a normal
       option.  If <b>POSIXLY_CORRECT</b> behaviour is required in this case <u>optstring</u> will contain  two  '+'  symbols.
       If the first character of <u>optstring</u> is '-', then each nonoption <u>argv</u>-element is handled as if it were the
       argument  of  an  option  with  character  code 1.  (This is used by programs that were written to expect
       options and other <u>argv</u>-elements in any order and that care about the ordering of the two.)   The  special
       argument "--" forces an end of option-scanning regardless of the scanning mode.

       While  processing  the option list, <b>getopt</b>() can detect two kinds of errors: (1) an option character that
       was not specified in <u>optstring</u> and (2) a missing option argument (i.e., an  option  at  the  end  of  the
       command line without an expected argument).  Such errors are handled and reported as follows:

       •  By  default, <b>getopt</b>() prints an error message on standard error, places the erroneous option character
          in <u>optopt</u>, and returns '?' as the function result.

       •  If the caller has set the global variable <u>opterr</u> to zero,  then  <b>getopt</b>()  does  not  print  an  error
          message.   The  caller  can  determine  that there was an error by testing whether the function return
          value is '?'.  (By default, <u>opterr</u> has a nonzero value.)

       •  If the first character (following any optional '+' or '-' described above) of  <u>optstring</u>  is  a  colon
          (':'), then <b>getopt</b>() likewise does not print an error message.  In addition, it returns ':' instead of
          '?'  to  indicate  a missing option argument.  This allows the caller to distinguish the two different
          types of errors.

   <b>getopt_long()</b> <b>and</b> <b>getopt_long_only()</b>
       The <b>getopt_long</b>() function works like <b>getopt</b>() except that it also accepts long options, started with two
       dashes.  (If the program accepts only long options, then <u>optstring</u> should be specified as an empty string
       (""), not NULL.)  Long option names may be abbreviated if the abbreviation is unique or is an exact match
       for some defined option.  A long option may take a parameter, of the form <b>--arg=param</b> or <b>--arg</b> <b>param</b>.

       <u>longopts</u> is a pointer to the first element of an array of <u>struct</u> <u>option</u> declared in <u>&lt;getopt.h&gt;</u> as

           struct option {
               const char *name;
               int         has_arg;
               int        *flag;
               int         val;
           };

       The meanings of the different fields are:

       <u>name</u>   is the name of the long option.

       <u>has_arg</u>
              is: <b>no_argument</b> (or 0) if the option does not take an argument; <b>required_argument</b> (or  1)  if  the
              option requires an argument; or <b>optional_argument</b> (or 2) if the option takes an optional argument.

       <u>flag</u>   specifies how results are returned for a long option.  If <u>flag</u> is NULL, then <b>getopt_long</b>() returns
              <u>val</u>.   (For  example,  the  calling program may set <u>val</u> to the equivalent short option character.)
              Otherwise, <b>getopt_long</b>() returns 0, and <u>flag</u> points to a variable which  is  set  to  <u>val</u>  if  the
              option is found, but left unchanged if the option is not found.

       <u>val</u>    is the value to return, or to load into the variable pointed to by <u>flag</u>.

       The last element of the array has to be filled with zeros.

       If  <u>longindex</u>  is not NULL, it points to a variable which is set to the index of the long option relative
       to <u>longopts</u>.

       <b>getopt_long_only</b>() is like <b>getopt_long</b>(), but '-' as well as "--" can indicate  a  long  option.   If  an
       option  that starts with '-' (not "--") doesn't match a long option, but does match a short option, it is
       parsed as a short option instead.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       If an option was successfully found, then <b>getopt</b>() returns the option  character.   If  all  command-line
       options  have been parsed, then <b>getopt</b>() returns -1.  If <b>getopt</b>() encounters an option character that was
       not in <u>optstring</u>, then '?' is returned.  If <b>getopt</b>() encounters an option with a missing  argument,  then
       the  return  value  depends  on  the  first  character  in <u>optstring</u>: if it is ':', then ':' is returned;
       otherwise '?' is returned.

       <b>getopt_long</b>() and <b>getopt_long_only</b>() also return the option character when a short option is  recognized.
       For  a  long option, they return <u>val</u> if <u>flag</u> is NULL, and 0 otherwise.  Error and -1 returns are the same
       as for <b>getopt</b>(), plus '?' for an ambiguous match or an extraneous parameter.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       <b>POSIXLY_CORRECT</b>
              If this is set, then option processing stops as soon as a nonoption argument is encountered.

       <b>_&lt;PID&gt;_GNU_nonoption_argv_flags_</b>
              This variable was used by <b><a href="../man1/bash.1.html">bash</a></b>(1) 2.0 to communicate to glibc which arguments are the  results  of
              wildcard  expansion  and  so  should  not  be considered as options.  This behavior was removed in
              <b><a href="../man1/bash.1.html">bash</a></b>(1) 2.01, but the support remains in glibc.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       For an explanation of the terms used in this section, see <b><a href="../man7/attributes.7.html">attributes</a></b>(7).
       ┌──────────────────────────┬───────────────┬────────────────────────────────────────────────────────────┐
       │ <b>Interface</b>                │ <b>Attribute</b>     │ <b>Value</b>                                                      │
       ├──────────────────────────┼───────────────┼────────────────────────────────────────────────────────────┤
       │ <b>getopt</b>(), <b>getopt_long</b>(), │ Thread safety │ MT-Unsafe race:getopt env                                  │
       │ <b>getopt_long_only</b>()       │               │                                                            │
       └──────────────────────────┴───────────────┴────────────────────────────────────────────────────────────┘

</pre><h4><b>VERSIONS</b></h4><pre>
       POSIX specifies that the <u>argv</u> array argument should be <u>const</u>, but these functions  permute  its  elements
       unless  the  environment  variable  <b>POSIXLY_CORRECT</b>  is set.  <u>const</u> is used in the actual prototype to be
       compatible with other systems; however, this page doesn't show the qualifier, to avoid confusing readers.

</pre><h4><b>STANDARDS</b></h4><pre>
       <b>getopt</b>()
              POSIX.1-2008.

       <b>getopt_long</b>()
       <b>getopt_long_only</b>()
              GNU.

              The use of '+' and '-' in <u>optstring</u> is a GNU extension.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>getopt</b>()
              POSIX.1-2001, and POSIX.2.

       On some older implementations, <b>getopt</b>() was declared in <u>&lt;stdio.h&gt;</u>.  SUSv1 permitted  the  declaration  to
       appear  in  either <u>&lt;unistd.h&gt;</u> or <u>&lt;stdio.h&gt;</u>.  POSIX.1-1996 marked the use of <u>&lt;stdio.h&gt;</u> for this purpose as
       LEGACY.  POSIX.1-2001 does not require the declaration to appear in <u>&lt;stdio.h&gt;</u>.

</pre><h4><b>NOTES</b></h4><pre>
       A program that scans multiple argument vectors, or rescans the same vector more than once, and  wants  to
       make  use  of  GNU  extensions  such  as  '+'  and '-' at the start of <u>optstring</u>, or changes the value of
       <b>POSIXLY_CORRECT</b> between scans, must reinitialize <b>getopt</b>() by resetting  <u>optind</u>  to  0,  rather  than  the
       traditional value of 1.  (Resetting to 0 forces the invocation of an internal initialization routine that
       rechecks <b>POSIXLY_CORRECT</b> and checks for GNU extensions in <u>optstring</u>.)

       Command-line  arguments  are  parsed  in  strict  order meaning that an option requiring an argument will
       consume the next argument, regardless of whether that argument is the correctly specified option argument
       or simply the next option (in the scenario the user mis-specifies the command  line).   For  example,  if
       <u>optstring</u>  is  specified  as  "1n:"  and  the  user  specifies  the command line arguments incorrectly as
       <u>prog</u> <u>-n</u> <u>-1</u>, the <u>-n</u> option will be given the <b>optarg</b> value "-1", and the <u>-1</u> option will  be  considered  to
       have not been specified.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>getopt()</b>
       The following trivial example program uses <b>getopt</b>() to handle two program options: <u>-n</u>, with no associated
       value; and <u>-t</u> <u>val</u>, which expects an associated value.

       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
       #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;

       int
       main(int argc, char *argv[])
       {
           int flags, opt;
           int nsecs, tfnd;

           nsecs = 0;
           tfnd = 0;
           flags = 0;
           while ((opt = getopt(argc, argv, "nt:")) != -1) {
               switch (opt) {
               case 'n':
                   flags = 1;
                   break;
               case 't':
                   nsecs = atoi(optarg);
                   tfnd = 1;
                   break;
               default: /* '?' */
                   fprintf(stderr, "Usage: %s [-t nsecs] [-n] name\n",
                           argv[0]);
                   exit(EXIT_FAILURE);
               }
           }

           printf("flags=%d; tfnd=%d; nsecs=%d; optind=%d\n",
                  flags, tfnd, nsecs, optind);

           if (optind &gt;= argc) {
               fprintf(stderr, "Expected argument after options\n");
               exit(EXIT_FAILURE);
           }

           printf("name argument = %s\n", argv[optind]);

           /* Other code omitted */

           exit(EXIT_SUCCESS);
       }

   <b>getopt_long()</b>
       The following example program illustrates the use of <b>getopt_long</b>() with most of its features.

       #include &lt;<a href="file:/usr/include/getopt.h">getopt.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;     /* for printf */
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;    /* for exit */

       int
       main(int argc, char *argv[])
       {
           int c;
           int digit_optind = 0;

           while (1) {
               int this_option_optind = optind ? optind : 1;
               int option_index = 0;
               static struct option long_options[] = {
                   {"add",     required_argument, 0,  0 },
                   {"append",  no_argument,       0,  0 },
                   {"delete",  required_argument, 0,  0 },
                   {"verbose", no_argument,       0,  0 },
                   {"create",  required_argument, 0, 'c'},
                   {"file",    required_argument, 0,  0 },
                   {0,         0,                 0,  0 }
               };

               c = getopt_long(argc, argv, "abc:d:012",
                               long_options, &amp;option_index);
               if (c == -1)
                   break;

               switch (c) {
               case 0:
                   printf("option %s", long_options[option_index].name);
                   if (optarg)
                       printf(" with arg %s", optarg);
                   printf("\n");
                   break;

               case '0':
               case '1':
               case '2':
                   if (digit_optind != 0 &amp;&amp; digit_optind != this_option_optind)
                     printf("digits occur in two different argv-elements.\n");
                   digit_optind = this_option_optind;
                   printf("option %c\n", c);
                   break;

               case 'a':
                   printf("option a\n");
                   break;

               case 'b':
                   printf("option b\n");
                   break;

               case 'c':
                   printf("option c with value '%s'\n", optarg);
                   break;

               case 'd':
                   printf("option d with value '%s'\n", optarg);
                   break;

               case '?':
                   break;

               default:
                   printf("?? getopt returned character code 0%o ??\n", c);
               }
           }

           if (optind &lt; argc) {
               printf("non-option ARGV-elements: ");
               while (optind &lt; argc)
                   printf("%s ", argv[optind++]);
               printf("\n");
           }

           exit(EXIT_SUCCESS);
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/getopt.1.html">getopt</a></b>(1), <b><a href="../man3/getsubopt.3.html">getsubopt</a></b>(3)

Linux man-pages 6.9.1                              2024-06-15                                          <u><a href="../man3/getopt.3.html">getopt</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>