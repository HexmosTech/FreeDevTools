<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypt::SMIME - S/MIME message signing, verification, encryption and decryption</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcrypt-smime-perl">libcrypt-smime-perl_0.31-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Crypt::SMIME - S/MIME message signing, verification, encryption and decryption

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Crypt::SMIME;

         my $plain = &lt;&lt;'EOF';
         From: <a href="mailto:alice@example.org">alice@example.org</a>
         To: <a href="mailto:bob@example.com">bob@example.com</a>
         Subject: Crypt::SMIME test

         This is a test mail. Please ignore...
         EOF

         my $smime = Crypt::SMIME-&gt;new();
         $smime-&gt;setPrivateKey($privkey, $crt);
         # $smime-&gt;setPublicKey([$icacert]); # if need be.

         my $signed = $smime-&gt;sign($plain);
         print $signed;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module provides a class for handling S/MIME messages. It can sign, verify, encrypt and decrypt
       messages. It requires libcrypto (&lt;<a href="http://www.openssl.org">http://www.openssl.org</a>&gt;).

</pre><h4><b>EXPORTS</b></h4><pre>
       No symbols are exported by default. The following symbols can optionally be exported:

       "NO_CHECK_CERTIFICATE"
           See "<b>check()</b>".

       "FORMAT_SMIME"
       "FORMAT_ASN1"
       "FORMAT_PEM"
           See "<b>extractCertificates()</b>".

       ":constants"
           Export all of the above.

</pre><h4><b>METHODS</b></h4><pre>
       <b>new()</b>
             my $smime = Crypt::SMIME-&gt;new();

           The constructor takes no arguments.

       <b>setPrivateKey()</b>
             $smime-&gt;setPrivateKey($key, $crt);
             $smime-&gt;setPrivateKey($key, $crt, $password);

           Store  a  private  key  and its X.509 certificate into the instance. The private key will be used for
           signing and decryption. Note that this method takes a PEM string, not a name of a file which contains
           a key or a certificate.

           The private key and certificate must be encoded in PEM format. The method dies if it  fails  to  load
           the key.

       <b>setPrivateKeyPkcs12()</b>
             $smime-&gt;setPrivateKeyPkcs12($key, $pkcs12);
             $smime-&gt;setPrivateKeyPkcs12($key, $pkcs12, $password);

           Load a private key and its X.509 certificate from PKCS#12 into the instance.  The private key will be
           used for signing and decryption. The method dies if it fails to load PKCS12.

       <b>setPublicKey()</b>
             $smime-&gt;setPublicKey($crt);
             $smime-&gt;setPublicKey([$crt1, $crt2, ...]);

           Store  one  or  more  X.509 certificates into the instance. The public keys will be used for signing,
           verification and encryption.

           The certificates must be encoded in PEM format. The method dies if it fails to load the certificates.

       <b>setPublicKeyStore()</b>
             $smime-&gt;setPublicKeyStore($path, ...);

           Set the paths of file or directory containing trusted certificates.  The certificate stores  will  be
           used for verification.

           The method dies if it fails to load the certificate stores.

       <b>sign()</b>
             $signed_mime = $smime-&gt;sign($raw_mime);

           Sign a MIME message and return an S/MIME message. The signature is always detached.

           Any  headers  except  "Content-*",  "MIME-*" and "Subject" will be moved to the top-level of the MIME
           message. "Subject" header will be copied to both of the plain text part and the  top-level  for  mail
           clients which can't properly handle S/MIME messages.

           The  resulting  message  will  be tainted if any of the original MIME message, the private key or its
           certificate is tainted.

       <b>signonly()</b>
             $sign = $smime-&gt;signonly($prepared_mime);

           Generate a signature from a MIME message. The resulting signature is  encoded  in  Base64.  The  MIME
           message  to  be  passed to this method should be preprocessed beforehand by the <b>prepareSmimeMessage()</b>
           method. You would rarely need to call this method directly.

           The resulting signature will be tainted if any of the original MIME message, the private key  or  its
           certificate is tainted.

       <b>prepareSmimeMessage()</b>
             ($prepared_mime, $outer_header)
                 = $smime-&gt;prepareSmimeMessage($source_mime);

           Preprocess a MIME message to be signed. $prepared_mime will be a string containing the processed MIME
           message, and $outer_header will be a string that is a list of headers to be moved to the top-level of
           MIME message. You would rarely need to call this method directly.

           The  entity  body  of  $source_mime  will  be  directly  copied  to  $prepared_mime.  Any  headers of
           $source_mime except "Content-*", "MIME-*" and "Subject" will be copied to $prepared_mime,  and  those
           excluded  headers  will  be copied to $outer_header. Note that the "Subject" header will be copied to
           both side exceptionally.

       <b>check()</b>
             use Crypt::SMIME qw(:constants);

             $source_mime = $smime-&gt;check($signed_mime);
             $source_mime = $smime-&gt;check($signed_mime, $flags);

           Verify a signature of S/MIME message and return a MIME message. The method dies if it fails to verify
           it.

           When the option "Crypt::SMIME::NO_CHECK_CERTIFICATE" is given as  $flags,  the  signer's  certificate
           chain is not verified. The default value for $flags is 0, which performs all the verifications.

           The  resulting  message will be tainted if the original S/MIME message, the $flags, verification time
           ("<b>setAtTime()</b>") or at least one of the provided public keys are tainted.

       <b>encrypt()</b>
             $encrypted_mime = $smime-&gt;encrypt($raw_mime);

           Encrypt a MIME message and return a S/MIME message.

           Any headers except "Content-*", "MIME-*" and "Subject" will be moved to the  top-level  of  the  MIME
           message.  "Subject"  header  will be copied to both of the plain text part and the top-level for mail
           clients which can't properly handle S/MIME messages.

           The resulting message will be tainted if the original MIME message or at  least  one  public  key  is
           tainted.

       <b>decrypt()</b>
             $decrypted_mime = $smime-&gt;decrypt($encrypted_mime);

           Decrypt an S/MIME and return a MIME message. This method dies if it fails to decrypt it.

           The  resulting  message will be tainted if any of the original S/MIME message, the private key or its
           certificate is tainted.

       <b>isSigned()</b>
             $is_signed = $smime-&gt;isSigned($mime);

           Return true if the given string is a signed S/MIME message. Note that if the  message  was  encrypted
           after  signing,  this  method  returns  false  because  in  that  case the signature is hidden in the
           encrypted message.

       <b>isEncrypted()</b>
             $is_encrypted = $smime-&gt;isEncrypted($mime);

           Return true if the given string is an encrypted S/MIME message. Note that if the message  was  signed
           with  non-detached  signature  after  encryption,  this method returns false because in that case the
           encrypted message is hidden in the signature.

       <b>setAtTime()</b>
             $yesterday = time - (60*60*24);
             $smime-&gt;setAtTime($yesterday);

           Set the time to use for verification. Default is to use the current time.   Must  be  an  unix  epoch
           timestamp.

</pre><h4><b>FUNCTIONS</b></h4><pre>
       <b>extractCertificates()</b>
             use Crypt::SMIME qw(:constants);

             @certs = @{Crypt::SMIME::extractCertificates($data)};
             @certs = @{Crypt::SMIME::extractCertificates($data, FORMAT_SMIME)};

           Get  all  X.509  certificates  (and  CRLs, if any) included in S/MIME message or PKCS#7 object $data.
           Optional $type parameter may specify type of data: "Crypt::SMIME::FORMAT_SMIME" (default) for  S/MIME
           message; "Crypt::SMIME::FORMAT_ASN1" for binary format; "Crypt::SMIME::FORMAT_PEM" for PEM format.

       <b>getSigners()</b>
             @certs = @{Crypt::SMIME::getSigners($data)};
             @certs = @{Crypt::SMIME::getSigners($data, $type)};

           Get  X.509  certificates  of  signers  included  in  S/MIME message or PKCS#7 object.  Optional $type
           parameter may specify type of data.

           Note that any public keys returned by this function are not verified.  <b>check()</b> should be executed  to
           ensure public keys are valid.

</pre><h4><b>AUTHOR</b></h4><pre>
       Copyright 2006-2014 YMIRLINK Inc. All Rights Reserved.

       This  library  is  free  software;  you can redistribute it and/or modify it under the same terms as Perl
       itself

       Bug reports and comments to: <a href="mailto:tl@tripletail.jp">tl@tripletail.jp</a>

perl v5.40.1                                       2025-03-21                                         <u><a href="../man3pm/SMIME.3pm.html">SMIME</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>