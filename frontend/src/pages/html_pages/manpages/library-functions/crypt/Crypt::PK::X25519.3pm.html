<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypt::PK::X25519 - Asymmetric cryptography based on X25519</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcryptx-perl">libcryptx-perl_0.087-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Crypt::PK::X25519 - Asymmetric cryptography based on X25519

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Crypt::PK::X25519;

        #Shared secret
        my $priv = Crypt::PK::X25519-&gt;new('Alice_priv_x25519.der');
        my $pub = Crypt::PK::X25519-&gt;new('Bob_pub_x25519.der');
        my $shared_secret = $priv-&gt;shared_secret($pub);

        #Load key
        my $pk = Crypt::PK::X25519-&gt;new;
        my $pk_hex = "EA7806F721A8570512C8F6EFB4E8D620C49A529E4DF5EAA77DEC646FB1E87E41";
        $pk-&gt;import_key_raw(pack("H*", $pk_hex), "public");
        my $sk = Crypt::PK::X25519-&gt;new;
        my $sk_hex = "002F93D10BA5728D8DD8E9527721DABA3261C0BB1BEFDE7B4BBDAC631D454651";
        $sk-&gt;import_key_raw(pack("H*", $sk_hex), "private");

        #Key generation
        my $pk = Crypt::PK::X25519-&gt;new-&gt;generate_key;
        my $private_der = $pk-&gt;export_key_der('private');
        my $public_der  = $pk-&gt;export_key_der('public');
        my $private_pem = $pk-&gt;export_key_pem('private');
        my $public_pem  = $pk-&gt;export_key_pem('public');
        my $private_raw = $pk-&gt;export_key_raw('private');
        my $public_raw  = $pk-&gt;export_key_raw('public');
        my $private_jwk = $pk-&gt;export_key_jwk('private');
        my $public_jwk  = $pk-&gt;export_key_jwk('public');

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>Since:</u> <u>CryptX-0.067</u>

</pre><h4><b>METHODS</b></h4><pre>
   <b>new</b>
        my $pk = Crypt::PK::X25519-&gt;new();
        #or
        my $pk = Crypt::PK::X25519-&gt;new($priv_or_pub_key_filename);
        #or
        my $pk = Crypt::PK::X25519-&gt;new(\$buffer_containing_priv_or_pub_key);

       Support for password protected PEM keys

        my $pk = Crypt::PK::X25519-&gt;new($priv_pem_key_filename, $password);
        #or
        my $pk = Crypt::PK::X25519-&gt;new(\$buffer_containing_priv_pem_key, $password);

   <b>generate_key</b>
       Uses Yarrow-based cryptographically strong random number generator seeded with random data taken from
       "/dev/random" (UNIX) or "CryptGenRandom" (Win32).

        $pk-&gt;generate_key;

   <b>import_key</b>
       Loads private or public key in DER or PEM format.

        $pk-&gt;import_key($filename);
        #or
        $pk-&gt;import_key(\$buffer_containing_key);

       Support for password protected PEM keys:

        $pk-&gt;import_key($filename, $password);
        #or
        $pk-&gt;import_key(\$buffer_containing_key, $password);

       Loading private or public keys form perl hash:

        $pk-&gt;import_key($hashref);

        # the $hashref is either a key exported via key2hash
        $pk-&gt;import_key({
             curve =&gt; "x25519",
             pub   =&gt; "EA7806F721A8570512C8F6EFB4E8D620C49A529E4DF5EAA77DEC646FB1E87E41",
             priv  =&gt; "002F93D10BA5728D8DD8E9527721DABA3261C0BB1BEFDE7B4BBDAC631D454651",
        });

        # or a hash with items corresponding to JWK (JSON Web Key)
        $pk-&gt;import_key({
              kty =&gt; "OKP",
              crv =&gt; "X25519",
              d   =&gt; "AC-T0Qulco2N2OlSdyHaujJhwLsb7957S72sYx1FRlE",
              x   =&gt; "6ngG9yGoVwUSyPbvtOjWIMSaUp5N9eqnfexkb7HofkE",
        });

       Supported key formats:

        # all formats can be loaded from a file
        my $pk = Crypt::PK::X25519-&gt;new($filename);

        # or from a buffer containing the key
        my $pk = Crypt::PK::X25519-&gt;new(\$buffer_with_key);

       •   X25519 private keys in PEM format

            -----BEGIN X25519 PRIVATE KEY-----
            MC4CAQAwBQYDK2VuBCIEIAAvk9ELpXKNjdjpUnch2royYcC7G+/ee0u9rGMdRUZR

            -----END X25519 PRIVATE KEY-----
       •   X25519 private keys in password protected PEM format

            -----BEGIN X25519 PRIVATE KEY-----
            Proc-Type: 4,ENCRYPTED
            DEK-Info: DES-CBC,DEEFD3D6B714E75A

            dfFWP5bKn49aZ993NVAhQQPdFWgsTb4j8CWhRjGBVTPl6ITstAL17deBIRBwZb7h
            pAyIka81Kfs=

            -----END X25519 PRIVATE KEY-----
       •   X25519 public keys in PEM format

            -----BEGIN PUBLIC KEY-----
            MCowBQYDK2VuAyEA6ngG9yGoVwUSyPbvtOjWIMSaUp5N9eqnfexkb7HofkE=

            -----END PUBLIC KEY-----
       •   PKCS#8 private keys

            -----BEGIN PRIVATE KEY-----
            MC4CAQAwBQYDK2VuBCIEIAAvk9ELpXKNjdjpUnch2royYcC7G+/ee0u9rGMdRUZR

            -----END PRIVATE KEY-----
       •   PKCS#8 encrypted private keys

            -----BEGIN ENCRYPTED PRIVATE KEY-----
            MIGHMEsGCSqGSIb3DQEFDTA+MCkGCSqGSIb3DQEFDDAcBAiS0NOFZmjJswICCAAw
            DAYIKoZIhvcNAgkFADARBgUrDgMCBwQIGd40Hdso8Y4EONSRCTrqvftl9hl3zbH9
            2QmHF1KJ4HDMdLDRxD7EynonCw2SV7BO+XNRHzw2yONqiTybfte7nk9t

            -----END ENCRYPTED PRIVATE KEY-----
       •   X25519 private keys in JSON Web Key (JWK) format

           See &lt;https://tools.ietf.org/html/rfc8037&gt;

            {
             "kty":"OKP",
             "crv":"X25519",
             "x":"6ngG9yGoVwUSyPbvtOjWIMSaUp5N9eqnfexkb7HofkE",
             "d":"AC-T0Qulco2N2OlSdyHaujJhwLsb7957S72sYx1FRlE",
            }

           <b>BEWARE:</b> For JWK support you need to have JSON module installed.

       •   X25519 public keys in JSON Web Key (JWK) format

            {
             "kty":"OKP",
             "crv":"X25519",
             "x":"6ngG9yGoVwUSyPbvtOjWIMSaUp5N9eqnfexkb7HofkE",
            }

           <b>BEWARE:</b> For JWK support you need to have JSON module installed.

   <b>import_key_raw</b>
       Import raw public/private key - can load raw key data exported by "export_key_raw".

        $pk-&gt;import_key_raw($key, 'public');
        $pk-&gt;import_key_raw($key, 'private');

   <b>export_key_der</b>
        my $private_der = $pk-&gt;export_key_der('private');
        #or
        my $public_der = $pk-&gt;export_key_der('public');

   <b>export_key_pem</b>
        my $private_pem = $pk-&gt;export_key_pem('private');
        #or
        my $public_pem = $pk-&gt;export_key_pem('public');

       Support for password protected PEM keys

        my $private_pem = $pk-&gt;export_key_pem('private', $password);
        #or
        my $private_pem = $pk-&gt;export_key_pem('private', $password, $cipher);

        # supported ciphers: 'DES-CBC'
        #                    'DES-EDE3-CBC'
        #                    'SEED-CBC'
        #                    'CAMELLIA-128-CBC'
        #                    'CAMELLIA-192-CBC'
        #                    'CAMELLIA-256-CBC'
        #                    'AES-128-CBC'
        #                    'AES-192-CBC'
        #                    'AES-256-CBC' (DEFAULT)

   <b>export_key_jwk</b>
       Exports public/private keys as a JSON Web Key (JWK).

        my $private_json_text = $pk-&gt;export_key_jwk('private');
        #or
        my $public_json_text = $pk-&gt;export_key_jwk('public');

       Also exports public/private keys as a perl HASH with JWK structure.

        my $jwk_hash = $pk-&gt;export_key_jwk('private', 1);
        #or
        my $jwk_hash = $pk-&gt;export_key_jwk('public', 1);

       <b>BEWARE:</b> For JWK support you need to have JSON module installed.

   <b>export_key_raw</b>
       Export raw public/private key

        my $private_bytes = $pk-&gt;export_key_raw('private');
        #or
        my $public_bytes = $pk-&gt;export_key_raw('public');

   <b>shared_secret</b>
         # Alice having her priv key $pk and Bob's public key $pkb
         my $pk  = Crypt::PK::X25519-&gt;new($priv_key_filename);
         my $pkb = Crypt::PK::X25519-&gt;new($pub_key_filename);
         my $shared_secret = $pk-&gt;shared_secret($pkb);

         # Bob having his priv key $pk and Alice's public key $pka
         my $pk = Crypt::PK::X25519-&gt;new($priv_key_filename);
         my $pka = Crypt::PK::X25519-&gt;new($pub_key_filename);
         my $shared_secret = $pk-&gt;shared_secret($pka);  # same value as computed by Alice

   <b>is_private</b>
        my $rv = $pk-&gt;is_private;
        # 1 .. private key loaded
        # 0 .. public key loaded
        # undef .. no key loaded

   <b>key2hash</b>
        my $hash = $pk-&gt;key2hash;

        # returns hash like this (or undef if no key loaded):
        {
          curve =&gt; "x25519",
          # raw public key as a hexadecimal string
          pub   =&gt; "EA7806F721A8570512C8F6EFB4E8D620C49A529E4DF5EAA77DEC646FB1E87E41",
          # raw private key as a hexadecimal string. undef if key is public only
          priv  =&gt; "002F93D10BA5728D8DD8E9527721DABA3261C0BB1BEFDE7B4BBDAC631D454651",
        }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       •   &lt;https://en.wikipedia.org/wiki/Curve25519&gt;

       •   &lt;https://tools.ietf.org/html/rfc7748&gt;

perl v5.40.1                                       2025-08-10                             <u>Crypt::PK::<a href="../man3pm/X25519.3pm.html">X25519</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>