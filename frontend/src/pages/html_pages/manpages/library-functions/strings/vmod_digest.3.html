<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vmod_digest - Varnish Digest Module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/varnish-vmod-digest">varnish-vmod-digest_6.4+20230816-3build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       vmod_digest - Varnish Digest Module

</pre><h4><b>SYNOPSIS</b></h4><pre>
          import digest;

          digest.hmac_md5(&lt;key&gt;,&lt;message&gt;);
          digest.hmac_sha1(&lt;key&gt;, &lt;message&gt;);
          digest.hmac_sha256(&lt;key&gt;, &lt;message));

          digest.base64(&lt;string&gt;);
          digest.base64url(&lt;string&gt;);
          digest.base64url_nopad(&lt;string&gt;);
          digest.base64_hex(&lt;string&gt;);
          digest.base64url_hex(&lt;string&gt;);
          digest.base64url_nopad_hex(&lt;string&gt;);
          digest.base64_decode(&lt;string&gt;);
          digest.base64url_decode(&lt;string&gt;);
          digest.base64url_nopad_decode(&lt;string&gt;);

          digest.version()

          digest.hash_sha1(&lt;string&gt;);
          digest.hash_sha224(&lt;string&gt;);
          digest.hash_sha256(&lt;string&gt;);
          digest.hash_sha384(&lt;string&gt;);
          digest.hash_sha512(&lt;string&gt;);
          digest.hash_gost(&lt;string&gt;);
          digest.hash_md2(&lt;string&gt;);
          digest.hash_md4(&lt;string&gt;);
          digest.hash_md5(&lt;string&gt;);
          digest.hash_crc32(&lt;string&gt;);
          digest.hash_crc32b(&lt;string&gt;);
          digest.hash_adler32(&lt;string&gt;);
          digest.hash_haval128(&lt;string&gt;);
          digest.hash_haval160(&lt;string&gt;);
          digest.hash_haval192(&lt;string&gt;);
          digest.hash_haval224(&lt;string&gt;);
          digest.hash_haval256(&lt;string&gt;);
          digest.hash_ripemd128(&lt;string&gt;);
          digest.hash_ripemd160(&lt;string&gt;);
          digest.hash_ripemd256(&lt;string&gt;);
          digest.hash_ripemd320(&lt;string&gt;);
          digest.hash_tiger(&lt;string&gt;);
          digest.hash_tiger128(&lt;string&gt;);
          digest.hash_tiger160(&lt;string&gt;);
          digest.hash_snefru128(&lt;string&gt;);
          digest.hash_snefru256(&lt;string&gt;);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Varnish Module (vmod) for computing HMAC, message digests and working with base64.

       All HMAC- and hash-functionality is provided by libmhash, while base64 is implemented locally.

</pre><h4><b>FUNCTIONS</b></h4><pre>
       Example VCL:

          backend foo { ... };

          import digest;

          sub vcl_recv {
                  if (digest.hmac_sha256("key",req.http.x-data) != req.http.x-data-sig)
                  {
                          return (synth(401, "Naughty user!"));
                  }
          }

   <b>hmac_(hash)</b>
       <b>Prototype</b>

                 digest.hmac_md5(&lt;key&gt;,&lt;message&gt;);
                 digest.hmac_sha1(&lt;key&gt;, &lt;message&gt;);
                 digest.hmac_sha256(&lt;key&gt;, &lt;message));

       <b>Returns</b>
              String. Hex-encoded prepended with 0x.

       <b>Description</b>
              All the various hmac-functions work the same, but use a different hash mechanism.

       <b>Example</b>

                 set resp.http.x-data-sig =
                         digest.hmac_sha256("secretkey",resp.http.x-data);

   <b>base64,</b> <b>base64url,</b> <b>base64url_nopad</b>
       <b>Prototype</b>

                 digest.base64(&lt;string&gt;);
                 digest.base64url(&lt;string&gt;);
                 digest.base64url_nopad(&lt;string&gt;);

       <b>Returns</b>
              String

       <b>Description</b>
              Returns  the  base64-encoded  version  of  the  input-string.  The  base64url-variant  uses base64
              url-encoding (+/ replaced by -_) and the base64url_nopad does the same, but avoids adding padding.
              The latter is more commonly used, though an (allowed) exception to the RFC4648.

       <b>Example</b>

                 set resp.http.x-data-sig =
                         digest.base64({"content with
                         newline in it"});

   <b>base64_hex,</b> <b>base64url_hex,</b> <b>base64url_nopad_hex</b>
       <b>Prototype</b>

                 digest.base64_hex(&lt;string&gt;);
                 digest.base64url_hex(&lt;string&gt;);
                 digest.base64url_nopad_hex(&lt;string&gt;);

       <b>Returns</b>
              String

       <b>Description</b>
              Returns the base64-encoded version of the hex encoded input-string.  The  input-string  can  start
              with  an  optional  0x.  Input is hex-decoded into binary and the encoding is identical to base64,
              base64url, and base64url_nopad.

       <b>Example</b>

                 set resp.http.x-data-sig =
                         digest.base64_hex("0xdd26bfddf122c1055d4c");

   <b>hash_(algorithm)</b>
       <b>Prototype</b>

                 digest.hash_sha1(&lt;string&gt;);
                 digest.hash_sha224(&lt;string&gt;);
                 digest.hash_sha256(&lt;string&gt;);
                 digest.hash_sha384(&lt;string&gt;);
                 digest.hash_sha512(&lt;string&gt;);
                 digest.hash_gost(&lt;string&gt;);
                 digest.hash_md2(&lt;string&gt;);
                 digest.hash_md4(&lt;string&gt;);
                 digest.hash_md5(&lt;string&gt;);
                 digest.hash_crc32(&lt;string&gt;);
                 digest.hash_crc32b(&lt;string&gt;);
                 digest.hash_adler32(&lt;string&gt;);
                 digest.hash_haval128(&lt;string&gt;);
                 digest.hash_haval160(&lt;string&gt;);
                 digest.hash_haval192(&lt;string&gt;);
                 digest.hash_haval224(&lt;string&gt;);
                 digest.hash_haval256(&lt;string&gt;);
                 digest.hash_ripemd128(&lt;string&gt;);
                 digest.hash_ripemd160(&lt;string&gt;);
                 digest.hash_ripemd256(&lt;string&gt;);
                 digest.hash_ripemd320(&lt;string&gt;);
                 digest.hash_tiger(&lt;string&gt;);
                 digest.hash_tiger128(&lt;string&gt;);
                 digest.hash_tiger160(&lt;string&gt;);
                 digest.hash_snefru128(&lt;string&gt;);
                 digest.hash_snefru256(&lt;string&gt;);

       <b>Returns</b>
              String

       <b>Description</b>
              Computes the digest/hash of the supplied, using the specified hash algorithm. If in  doubt  as  to
              which to pick, use SHA256. For detailed discussions, see The Internet.

       <b>Example</b>

                 set resp.http.x-data-md5 =
                         digest.hash_md5(resp.http.x-data);

   <b>base64_decode,</b> <b>base64url_decode,</b> <b>base64url_nopad_decode</b>
       <b>Prototype</b>

                 digest.base64_decode(&lt;string&gt;);
                 digest.base64url_decode(&lt;string&gt;);
                 digest.base64url_nopad_decode(&lt;string&gt;);

       <b>Returns</b>
              String

       <b>Description</b>
              Decodes  the  bas64  and  base64url-encoded strings. All functions treat padding the same, meaning
              base64url_decode and base64url_nopad_decode are  identical,  but  available  for  consistency  and
              practicality.

       <b>Example</b>

              <b>::</b>     synthetic(digest.base64_decode(req.http.x-parrot));

   <b>version</b>
       <b>Prototype</b>

                 digest.version()

       <b>Returns</b>
              string

       <b>Description</b>
              Returns the string constant version-number of the digest vmod.

       <b>Example</b>

                 set resp.http.X-digest-version = digest.version();

</pre><h4><b>INSTALLATION</b></h4><pre>
       The source tree is based on autotools to configure the building, and does also have the necessary bits in
       place to do functional unit tests using the <b>varnishtest</b> tool.

       Building requires the Varnish header files and uses pkg-config to find the necessary paths.

       Usage:

          ./autogen.sh
          ./configure

       If  you  have  installed  Varnish  to  a  non-standard  directory,  call  <b>autogen.sh</b>  and  <b>configure</b> with
       <b>PKG_CONFIG_PATH</b> pointing to the appropriate path. For example, when varnishd configure  was  called  with
       <b>--prefix=$PREFIX</b>, use
          PKG_CONFIG_PATH=${PREFIX}/lib/pkgconfig export PKG_CONFIG_PATH

       Make targets:

       • make - builds the vmod.

       • make install - installs your vmod.

       • make check - runs the unit tests in <b>src/tests/*.vtc</b>

       • make distcheck - run check and prepare a tarball of the vmod.

</pre><h4><b>AUTHOR</b></h4><pre>
       Original author: Kristian Lyngstøl &lt; &lt;<a href="mailto:opensource@varnish-software.com">opensource@varnish-software.com</a>&gt; &gt;.

       This Vmod was written for Media Norge, Schibsted and others.

       The bulk of the functionality is acquired through libmhash.

</pre><h4><b>BUGS</b></h4><pre>
       No bugs at all!

       If  the  key  is  NULL  for  hmac-functions,  the  function  will  fail and return NULL itself, and do no
       hmac-computation at all. This should be used as an indication of some greater flaw in your  software/VCL.
       (I.e.: Your key should be under your control, not user-supplied without verification).

       The  <u>base64url_nopad_decode()</u>  and <u>base64url_decode()</u> functions do not differ much. The exception is that
       nopad_decode() does not know about padding at all, and might  get  confused  if  the  input  actually  is
       padded.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       • libmhash

       • <a href="../man1/varnishd.1.html">varnishd</a>(1)

       • <a href="../man7/vcl.7.html">vcl</a>(7)

       •
          &lt;https://github.com/varnish/libvmod-digest&gt;

</pre><h4><b>AUTHOR</b></h4><pre>
       Kristian Lyngstøl

1.0.3                                              2016-03-16                                     <u><a href="../man3/VMOD_DIGEST.3.html">VMOD_DIGEST</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>