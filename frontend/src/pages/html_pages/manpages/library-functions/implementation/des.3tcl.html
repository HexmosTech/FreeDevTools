<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>des - Implementation of the DES and triple-DES ciphers</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       des - Implementation of the DES and triple-DES ciphers

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>des</b> <b>1.2</b>

       <b>::DES::des</b>  ?<u>-mode</u>  <u>[ecb|cbc|cfb|ofb]</u>?  ?<u>-dir</u> <u>[encrypt|decrypt]</u>? <u>-key</u> <u>keydata</u> ?<u>-iv</u> <u>vector</u>? ?<u>-hex</u>? ?<u>-weak</u>?
       ?<u>-out</u> <u>channel</u>? ?<u>-chunksize</u> <u>size</u>? [ <u>-in</u> <u>channel</u> | <u>data</u> ]

       <b>::DES::Init</b> <u>mode</u> <u>keydata</u> <u>iv</u> ?<u>weak</u>?

       <b>::DES::Encrypt</b> <u>Key</u> <u>data</u>

       <b>::DES::Decrypt</b> <u>Key</u> <u>data</u>

       <b>::DES::Reset</b> <u>Key</u> <u>iv</u>

       <b>::DES::Final</b> <u>Key</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This is an implementation in Tcl of the Data Encryption Standard (DES) as published by the U.S.  National
       Institute  of  Standards  and  Technology (NIST) [1]. This implementation also supports triple DES (3DES)
       extension to DES. DES is a 64-bit block cipher that uses a 56-bit key. 3DES uses a 168-bit key.  DES  has
       now officially been superceeded by AES but is in common use in many protocols.

       The  tcllib  implementation  of  DES  and  3DES  uses an implementation by Mac Cody and is available as a
       separate download from [2]. For anyone concerned about the details of exporting this code please see  the
       TclDES  web pages. The tcllib specific code is a wrapper to the TclDES API that presents same API for the
       DES cipher as for other ciphers in the library.

</pre><h4><b>COMMANDS</b></h4><pre>
       <b>::DES::des</b> ?<u>-mode</u> <u>[ecb|cbc|cfb|ofb]</u>? ?<u>-dir</u> <u>[encrypt|decrypt]</u>? <u>-key</u> <u>keydata</u> ?<u>-iv</u> <u>vector</u>? ?<u>-hex</u>? ?<u>-weak</u>?
       ?<u>-out</u> <u>channel</u>? ?<u>-chunksize</u> <u>size</u>? [ <u>-in</u> <u>channel</u> | <u>data</u> ]
              Perform the <b>DES</b> algorithm on either the data provided by the argument or on the data read from the
              <u>-in</u> channel. If an <u>-out</u> channel is given then the result will be written to this channel.

              The <u>-key</u> option must be given. This parameter takes a binary string of 8 bytes in  length  and  is
              used to generate the key schedule.  In DES only 56 bits of key data are used. The highest bit from
              each byte is discarded.

              The  <u>-mode</u>  and  <u>-dir</u>  options  are optional and default to cbc mode and encrypt respectively. The
              initialization vector <u>-iv</u> takes an 8 byte binary argument. This defaults to all zeros.  See  <b>MODES</b>
              <b>OF</b> <b>OPERATION</b> for more about <u>-mode</u> and the use of the initialization vector.

              DES  is  a  64-bit  block  cipher.  This  means that the data must be provided in units that are a
              multiple of 8 bytes.

</pre><h4><b>PROGRAMMING</b> <b>INTERFACE</b></h4><pre>
       Internal state is maintained in an opaque structure that is returned from the <b>Init</b> function. In ECB  mode
       the  state  is not affected by the input but for other modes some input dependent state is maintained and
       may be reset by calling the <b>Reset</b> function with a new initialization vector value.

       <b>::DES::Init</b> <u>mode</u> <u>keydata</u> <u>iv</u> ?<u>weak</u>?
              Construct a new DES key schedule using the specified key data and the given initialization vector.
              The initialization vector is not used with ECB mode but is important for other usage  modes.   See
              <b>MODES</b> <b>OF</b> <b>OPERATION</b>.

              There  are a small number of keys that are known to be weak when used with DES. By default if such
              a key is passed in then an error will be raised. If there is a need to accept such keys  then  the
              <u>weak</u> parameter can be set true to avoid the error being thrown.

       <b>::DES::Encrypt</b> <u>Key</u> <u>data</u>
              Use a prepared key acquired by calling <b>Init</b> to encrypt the provided data. The data argument should
              be  a  binary  array  that  is a multiple of the DES block size of 8 bytes. The result is a binary
              array the same size as the input of encrypted data.

       <b>::DES::Decrypt</b> <u>Key</u> <u>data</u>
              Decipher data using the key. Note that the same key may  be  used  to  encrypt  and  decrypt  data
              provided that the initialization vector is reset appropriately for CBC mode.

       <b>::DES::Reset</b> <u>Key</u> <u>iv</u>
              Reset the initialization vector. This permits the programmer to re-use a key and avoid the cost of
              re-generating the key schedule where the same key data is being used multiple times.

       <b>::DES::Final</b> <u>Key</u>
              This  should  be  called  to  clean up resources associated with <u>Key</u>.  Once this function has been
              called the key may not be used again.

</pre><h4><b>MODES</b> <b>OF</b> <b>OPERATION</b></h4><pre>
       Electronic Code Book (ECB)
              ECB is the basic mode of all block ciphers. Each block is encrypted independently and so identical
              plain text will produce identical output when encrypted with the same key. Any  encryption  errors
              will only affect a single block however this is vulnerable to known plaintext attacks.

       Cipher Block Chaining (CBC)
              CBC  mode  uses  the  output  of  the  last  block  encryption  to  affect  the  current block. An
              initialization vector of the same size as the cipher block size is used to handle the first block.
              The initialization vector should be chosen randomly and transmitted as  the  first  block  of  the
              output.  Errors  in  encryption affect the current block and the next block after which the cipher
              will correct itself. CBC is the most commonly used mode in software encryption.

       Cipher Feedback (CFB)
              CFB mode can be used to convert block ciphers into stream ciphers. In CFB mode the  initialization
              vector  is  encrypted  and  the output is then xor'd with the plaintext stream. The result is then
              used as the initialization vector for the next round. Errors will affect the current block and the
              next block.

       Output Feedback (OFB)
              OFB is similar to CFB except that the output of the cipher is fed back into the next round and not
              the xor'd plain text. This means that errors only affect a single block but  the  cipher  is  more
              vulnerable to attack.

</pre><h4><b>EXAMPLES</b></h4><pre>
              % set ciphertext [DES::des -mode cbc -dir encrypt -key $secret $plaintext]
              % set plaintext [DES::des -mode cbc -dir decrypt -key $secret $ciphertext]

              set iv [string repeat \\0 8]
              set Key [DES::Init cbc \\0\\1\\2\\3\\4\\5\\6\\7 $iv]
              set ciphertext [DES::Encrypt $Key "somedata"]
              append ciphertext [DES::Encrypt $Key "moredata"]
              DES::Reset $Key $iv
              set plaintext [DES::Decrypt $Key $ciphertext]
              DES::Final $Key

</pre><h4><b>REFERENCES</b></h4><pre>
       [1]    "Data  Encryption  Standard",  Federal  Information  Processing  Standards Publication 46-3, 1999,
              (<u><a href="http://csrc.nist.gov/publications/fips/fips46-3/fips46-3.pdf">http://csrc.nist.gov/publications/fips/fips46-3/fips46-3.pdf</a></u>)

       [2]    "TclDES: munitions-grade Tcl scripting" <u><a href="http://tcldes.sourceforge.net/">http://tcldes.sourceforge.net/</a></u>

</pre><h4><b>AUTHORS</b></h4><pre>
       Jochen C Loewer, Mac Cody, Pat Thoyts

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This document, and the package it describes, will undoubtedly contain bugs and  other  problems.   Please
       report  such  in  the category <u>des</u> of the <u>Tcllib</u> <u>Trackers</u> [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].  Please
       also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note further that <u>attachments</u> are strongly preferred over inlined patches. Attachments  can  be  made  by
       going  to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most button
       in the secondary navigation bar.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/aes.3tcl.html">aes</a>(3tcl), <a href="../man3tcl/blowfish.3tcl.html">blowfish</a>(3tcl), <a href="../man3tcl/md5.3tcl.html">md5</a>(3tcl), <a href="../man3tcl/rc4.3tcl.html">rc4</a>(3tcl), <a href="../man3tcl/sha1.3tcl.html">sha1</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       3DES, DES, block cipher, data integrity, encryption, security

</pre><h4><b>CATEGORY</b></h4><pre>
       Hashes, checksums, and encryption

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2005, Pat Thoyts &lt;<a href="mailto:patthoyts@users.sourceforge.net">patthoyts@users.sourceforge.net</a>&gt;

tcllib                                                 1.2                                             <u><a href="../man3tcl/des.3tcl.html">des</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>