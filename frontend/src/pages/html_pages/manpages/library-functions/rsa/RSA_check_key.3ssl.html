<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA_check_key_ex, RSA_check_key - validate private RSA keys</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       RSA_check_key_ex, RSA_check_key - validate private RSA keys

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/rsa.h&gt;

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        int RSA_check_key_ex(const RSA *rsa, BN_GENCB *cb);

        int RSA_check_key(const RSA *rsa);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Both of the functions described on this page are deprecated.  Applications should instead use
       <b><a href="../man3/EVP_PKEY_public_check.3.html">EVP_PKEY_public_check</a></b>(3), <b><a href="../man3/EVP_PKEY_private_check.3.html">EVP_PKEY_private_check</a></b>(3) and <b><a href="../man3/EVP_PKEY_pairwise_check.3.html">EVP_PKEY_pairwise_check</a></b>(3).

       <b>RSA_check_key_ex()</b> function validates RSA keys.  It checks that <b>p</b> and <b>q</b> are in fact prime, and that <b>n</b> <b>=</b>
       <b>p*q</b>.

       It does not work on RSA public keys that have only the modulus and public exponent elements populated.
       It also checks that <b>d*e</b> <b>=</b> <b>1</b> <b>mod</b> <b>(p-1*q-1)</b>, and that <b>dmp1</b>, <b>dmq1</b> and <b>iqmp</b> are set correctly or are <b>NULL</b>.
       It performs integrity checks on all the RSA key material, so the RSA key structure must contain all the
       private key data too.  Therefore, it cannot be used with any arbitrary RSA key object, even if it is
       otherwise fit for regular RSA operation.

       The <b>cb</b> parameter is a callback that will be invoked in the same manner as <b><a href="../man3/BN_is_prime_ex.3.html">BN_is_prime_ex</a></b>(3).

       <b>RSA_check_key()</b> is equivalent to <b>RSA_check_key_ex()</b> with a NULL <b>cb</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>RSA_check_key_ex()</b> and <b>RSA_check_key()</b> return 1 if <b>rsa</b> is a valid RSA key, and 0 otherwise.  They return
       -1 if an error occurs while checking the key.

       If the key is invalid or an error occurred, the reason code can be obtained using <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3).

</pre><h4><b>NOTES</b></h4><pre>
       Unlike most other RSA functions, this function does <b>not</b> work transparently with any underlying ENGINE
       implementation because it uses the key data in the RSA structure directly. An ENGINE implementation can
       override the way key data is stored and handled, and can even provide support for HSM keys - in which
       case the RSA structure may contain <b>no</b> key data at all! If the ENGINE in question is only being used for
       acceleration or analysis purposes, then in all likelihood the RSA key data is complete and untouched, but
       this can't be assumed in the general case.

</pre><h4><b>BUGS</b></h4><pre>
       A method of verifying the RSA key using opaque RSA API functions might need to be considered. Right now
       <b>RSA_check_key()</b> simply uses the RSA structure elements directly, bypassing the RSA_METHOD table
       altogether (and completely violating encapsulation and object-orientation in the process).  The best fix
       will probably be to introduce a "<b>check_key()</b>" handler to the RSA_METHOD function table so that
       alternative implementations can also provide their own verifiers.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/BN_is_prime_ex.3.html">BN_is_prime_ex</a></b>(3), <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       All of these functions were deprecated in OpenSSL 3.0.

       <b>RSA_check_key_ex()</b> appeared after OpenSSL 1.0.2.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2020 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                <u><a href="../man3SSL/RSA_CHECK_KEY.3SSL.html">RSA_CHECK_KEY</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>