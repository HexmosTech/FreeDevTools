<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mlx5dv_init_obj - Initialize mlx5 direct verbs object from ibv_xxx or mlx5dv_xxx structures</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libibverbs-dev">libibverbs-dev_56.1-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mlx5dv_init_obj - Initialize mlx5 direct verbs object from ibv_xxx or mlx5dv_xxx structures

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;infiniband/mlx5dv.h&gt;</b>

       <b>int</b> <b>mlx5dv_init_obj(struct</b> <b>mlx5dv_obj</b> <b>*obj,</b> <b>uint64_t</b> <b>obj_type);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>mlx5dv_init_obj()</b>  This  function  will  initialize  mlx5dv_xxx  structs  based  on  supplied  type.  The
       information for initialization is taken from ibv_xx or mlx5dv_xxx structs supplied as part of input.

       Request information of CQ marks its owned by direct verbs for all consumer  index  related  actions.  The
       initialization type can be combination of several types together.

       struct mlx5dv_qp {
               uint32_t                *dbrec;
               struct {
                       void            *buf;
                       uint32_t        wqe_cnt;
                       uint32_t        stride;
               } sq;
               struct {
                       void            *buf;
                       uint32_t        wqe_cnt;
                       uint32_t        stride;
               } rq;
               struct {
                       void            *reg;
                       uint32_t        size;
               } bf;
               uint64_t                comp_mask;
               off_t               uar_mmap_offset;
               uint32_t       tirn;
               uint32_t       tisn;
               uint32_t       rqn;
               uint32_t       sqn;
               uint64_t       tir_icm_address;
       };

       struct mlx5dv_cq {
               void                    *buf;
               uint32_t                *dbrec;
               uint32_t                cqe_cnt;
               uint32_t                cqe_size;
               void                    *cq_uar;
               uint32_t                cqn;
               uint64_t                comp_mask;
       };

       struct mlx5dv_srq {
               void                    *buf;
               uint32_t                *dbrec;
               uint32_t                stride;
               uint32_t                head;
               uint32_t                tail;
               uint64_t                comp_mask;
               uint32_t                srqn;
       };

       struct mlx5dv_rwq {
               void            *buf;
               uint32_t        *dbrec;
               uint32_t        wqe_cnt;
               uint32_t        stride;
               uint64_t        comp_mask;
       };

       struct mlx5dv_dm {
               void      *buf;
               uint64_t  length;
               uint64_t  comp_mask;
               uint64_t  remote_va;
       };

       struct mlx5dv_ah {
               struct mlx5_wqe_av    *av;
               uint64_t              comp_mask;
       };

       struct mlx5dv_pd {
               uint32_t              pdn;
               uint64_t              comp_mask;
       };

       struct mlx5dv_devx {
               uint32_t              handle; /* The kernel handle, can be used upon direct ioctl destroy */
       };

       struct mlx5dv_obj {
               struct {
                       struct ibv_qp           *in;
                       struct mlx5dv_qp        *out;
               } qp;
               struct {
                       struct ibv_cq           *in;
                       struct mlx5dv_cq        *out;
               } cq;
               struct {
                       struct ibv_srq          *in;
                       struct mlx5dv_srq       *out;
               } srq;
               struct {
                       struct ibv_wq           *in;
                       struct mlx5dv_rwq       *out;
               } rwq;
               struct {
                       struct ibv_dm       *in;
                       struct mlx5dv_dm    *out;
               } dm;
               struct {
                       struct ibv_ah       *in;
                       struct mlx5dv_ah    *out;
               } ah;
               struct {
                       struct ibv_pd           *in;
                       struct mlx5dv_pd        *out;
               } pd;
               struct {
                       struct mlx5dv_devx_obj  *in;
                       struct mlx5dv_devx      *out;
               } devx;
       };

       enum mlx5dv_obj_type {
               MLX5DV_OBJ_QP   = 1 &lt;&lt; 0,
               MLX5DV_OBJ_CQ   = 1 &lt;&lt; 1,
               MLX5DV_OBJ_SRQ  = 1 &lt;&lt; 2,
               MLX5DV_OBJ_RWQ  = 1 &lt;&lt; 3,
               MLX5DV_OBJ_DM   = 1 &lt;&lt; 4,
               MLX5DV_OBJ_AH   = 1 &lt;&lt; 5,
               MLX5DV_OBJ_PD   = 1 &lt;&lt; 6,
               MLX5DV_OBJ_DEVX = 1 &lt;&lt; 7,
       };

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       0 on success or the value of errno on failure (which indicates the failure reason).

</pre><h4><b>NOTES</b></h4><pre>
        * The information if doorbell is blueflame is based on mlx5dv_qp-&gt;bf-&gt;size, in case of 0 it's not a BF.
        * Compatibility masks (comp_mask) are in/out fields.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/mlx5dv.7.html">mlx5dv</a></b>(7)

</pre><h4><b>AUTHORS</b></h4><pre>
       Leon Romanovsky &lt;<a href="mailto:leonro@mellanox.com">leonro@mellanox.com</a>&gt;

1.0.0                                              2017-02-02                                 <u><a href="../man3/MLX5DV_INIT_OBJ.3.html">MLX5DV_INIT_OBJ</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>