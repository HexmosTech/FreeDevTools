<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sympa::LockedFile - Filehandle with locking</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/sympa">sympa_6.2.76~dfsg-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Sympa::LockedFile - Filehandle with locking

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Sympa::LockedFile;

         # Create filehandle acquiring lock.
         my $fh = Sympa::LockedFile-&gt;new('/path/to/file', 20, '+&lt;') or die;
         # or,
         my $fh = Sympa::LockedFile-&gt;new();
         $fh-&gt;open('/path/to/file', 20, '+&lt;') or die;

         # Operations...
         while (&lt;$fh&gt;) { ... }
         seek $fh, 0, 0;
         truncate $fh, 0;
         print $fh "blah blah\n";
         # et cetera.

         # Close filehandle releasing lock.
         $fh-&gt;close;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This class implements a filehandle with locking.

   <b>Class</b> <b>Methods</b>
       new ( [ $file, [ $blocking_timeout, [ $mode ] ] ] )
           Creates new object.  If any of optional parameters are specified, opens a file acquiring lock.

           Parameters:

           See <b>open()</b>.

           Returns:

           New object or, if something went wrong, false value.

       last_error ( )
           Get a string describing the most recent error.

           Parameters:

           None.

           Returns:

           String or, if recent operation was success, "undef".

   <b>Instance</b> <b>Methods</b>
       Instances of Sympa::LockedFile support the methods provided by IO::File.

       open ( $file, [ $blocking_timeout, [ $mode ] ] )
           Opens a file specified by $file acquiring lock.

           Parameters:

           $file
               Path of file to be locked and opened.

           $blocking_timeout
               Programs  will  block up to the number of seconds specified by this option before returning undef
               (could not get a lock).   If  negative  value  was  given,  programs  will  not  block  but  fail
               immediately ("LOCK_NB").

               Default is 30.

               However, if existing lock is older than 1200 seconds i.e. 20 minutes, lock will be stolen.

           $mode
               Mode to open file.  If it implies any writing operations ('&gt;', '&gt;&gt;', '+&lt;', ...), tries to acquire
               exclusive lock ("LOCK_EX"), otherwise shared lock ("LOCK_SH").

               Default is '&lt;'.

               Additionally,  a special mode '+' will acquire exclusive lock without opening file.  In this case
               the file does not have to exist.

               The numeric modes used for <b>sysopen()</b> (e.g. "O_CREAT") are not supported.

           Returns:

           New filehandle.  If acquiring lock failed,  won't  open  file.   If  opening  file  failed,  releases
           acquired lock.  In both cases returns false value.

       close ( )
           Closes filehandle and releases lock on it.

           Note that destruction of instance will safely close filehandle and release lock.

           Parameters:

           None.

           Returns:

           If close succeeded, returns true value, otherwise false value.

           If filehandle had not been locked by current process, this method will safely close it and die.

       Following methods are specific to this module.

       basename ( [ $level ] )
           Gets base name of locked file.

       extend ( )
           Extends stale lock timeout.  The lock will never be stolen in 1200 seconds again.

           Parameters:

           None.

           Returns:

           If extension succeeded, returns true value, otherwise false value.

           If filehandle had not been locked by current process, this method will die doing nothing.

       rename ( $destfile )
           Renames  file,  closes  filehandle  and releases lock on it.  Filehandle must have acquired exclusive
           lock.

           Parameter:

           $destfile
               Destination path of renaming.

           Returns:

           If renaming succeeded, returns true value, otherwise false value and does not release lock.  In  both
           cases filehandle is closed anyway.

           If filehandle had not been locked by current process, this method will die doing nothing.

       unlink ( )
           Deletes file and releases lock on it.

           Parameters:

           None.

           Returns:

           If unlink succeeded, returns true value, otherwise false value and does not release lock.

           If filehandle had not been locked by current process, this method will die without deleting file.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       "Functions  for  filehandles,  files  or  directories"  in perlfunc, "I/O Operators" in perlop, IO::File,
       File::NFSLock.

</pre><h4><b>HISTORY</b></h4><pre>
       Lock module written by Olivier Sala√ºn appeared on Sympa 5.3.

       Support for NFS was added by Kazuo Moriwaka.

       Rewritten Sympa::LockedFile module was initially written by IKEDA Soji for Sympa 6.2.

6.2.76                                             2025-02-12                          <u>Sympa::<a href="../man3Sympa/LockedFile.3Sympa.html">LockedFile</a></u>(3Sympa)
</pre>
 </div>
</div></section>
</div>
</body>
</html>