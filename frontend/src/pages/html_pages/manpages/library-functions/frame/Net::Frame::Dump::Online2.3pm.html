<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::Frame::Dump::Online2 - tcpdump like implementation, online mode and non-blocking</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-frame-dump-perl">libnet-frame-dump-perl_1.18-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::Frame::Dump::Online2 - tcpdump like implementation, online mode and non-blocking

</pre><h4><b>SYNOPSIS</b></h4><pre>
          use Net::Frame::Dump::Online2;

          #
          # Simply create a Dump object
          #
          my $oDump = Net::Frame::Dump::Online2-&gt;new(
             dev =&gt; 'eth0',
          );

          $oDump-&gt;start;

          # Gather frames
          while (1) {
             if (my $f = $oDump-&gt;next) {
                my $raw            = $f-&gt;{raw};
                my $firstLayerType = $f-&gt;{firstLayer};
                my $timestamp      = $f-&gt;{timestamp};
             }
          }

          $oDump-&gt;stop;

          #
          # Default parameters on creation
          #
          my $oDumpDefault = Net::Frame::Dump::Online2-&gt;new(
             timeoutOnNext =&gt; 3,
             timeout       =&gt; 0,
             promisc       =&gt; 0,
             snaplen       =&gt; 1514,
             file          =&gt; '',
             overwrite     =&gt; 0,
          );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module implements a tcpdump-like program, for live capture from networks.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       <b>dev</b> The network interface to listen on. No default value.

       <b>timeoutOnNext</b>
           Each  time  you  call <b>next</b> method, an internal counter is updated. This counter tells you if you have
           not received any data since <b>timeoutOnNext</b> seconds. When a timeout occurred, <b>timeout</b> is set to true.

       <b>timeout</b>
           When <b>timeoutOnNext</b> seconds has been reached, this variable is set  to  true,  and  never  reset.  See
           <b>timeoutReset</b> if you want to reset it.

       <b>snaplen</b>
           If you want to capture a different snaplen, set it a number. Default to 1514.

       <b>promisc</b>
           By default, interface is not put into promiscuous mode, set this parameter to true if you want it.

       The following are inherited attributes:

       <b>filter</b>
           Pcap filter to use. Default to no filter.

       <b>firstLayer</b>
           Stores  information about the first layer type contained on read frame. This attribute is filled only
           after a call to <b>start</b> method.

       <b>isRunning</b>
           Returns true if a call to <b>start</b> has been done, false otherwise or if a call to <b>stop</b> has been done.

       <b>keepTimestamp</b>
           Sometimes, when frames are captured and saved to a .pcap file, timestamps sucks. That is, you send  a
           frame,  and  receive  the  reply,  but  your request appear to have been sent after the reply. So, to
           correct that, you can use <b>Net::Frame::Dump</b> own timestamping system. The default is 0. Set it manually
           to 1 if you need original .pcap frames timestamps.

</pre><h4><b>METHODS</b></h4><pre>
       <b>new</b>
       <b>new</b> (hash)
           Object constructor. You can pass attributes that  will  overwrite  default  ones.  See  <b>SYNOPSIS</b>  for
           default values.

       <b>start</b>
           When you want to start reading frames from network, call this method.

       <b>stop</b>
           When you want to stop reading frames from network, call this method.

       <b>next</b>
           Returns  the  next  captured  frame;  undef  if  none  awaiting.  Each  time this method is called, a
           comparison is done to see if no frame has been captured during <b>timeoutOnNext</b> number  of  seconds.  If
           so, <b>timeout</b> attribute is set to 1 to reflect the pending timeout.

       <b>store</b> (<b>Net::Frame::Simple</b> object)
           This  method  will  store  internally,  sorted,  the  <b>Net::Frame::Simple</b>  object  passed  as a single
           parameter. <b>getKey</b>  methods,  implemented  in  various  <b>Net::Frame::Layer</b>  objects  will  be  used  to
           efficiently retrieve (via <b>getKeyReverse</b> method) frames.

           Basically,  it  is  used  to make <b>recv</b> method (from <b>Net::Frame::Simple</b>) to retrieve quickly the reply
           frame for a request frame.

       <b>getFramesFor</b> (<b>Net::Frame::Simple</b> object)
           This will return an array of possible reply frames for the specified <b>Net::Frame::Simple</b>  object.  For
           example,  reply  frames  for  a  UDP probe will be all the frames which have the same source port and
           destination port as the request.

       <b>flush</b>
           Will flush stored frames, the one which have been stored via <b>store</b> method.

       <b>timeoutReset</b>
           Reset the internal timeout state (<b>timeout</b> attribute).

       <b>getStats</b>
           Tries to get packet statistics on an open descriptor. It returns a reference to a hash  that  has  to
           following fields: <b>ps_recv</b>, <b>ps_drop</b>, <b>ps_ifdrop</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Net::Frame::Dump

</pre><h4><b>AUTHOR</b></h4><pre>
       Patrice &lt;GomoR&gt; Auffret

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       Copyright (c) 2006-2020, Patrice &lt;GomoR&gt; Auffret

       You may distribute this module under the terms of the Artistic license.  See LICENSE.Artistic file in the
       source distribution archive.

perl v5.36.0                                       2022-11-19                     <u>Net::Frame::Dump::<a href="../man3pm/Online2.3pm.html">Online2</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>