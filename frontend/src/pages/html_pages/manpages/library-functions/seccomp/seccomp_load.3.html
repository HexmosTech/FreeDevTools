<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>seccomp_load - Load the current seccomp filter into the kernel</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libseccomp-dev">libseccomp-dev_2.6.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       seccomp_load - Load the current seccomp filter into the kernel

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;seccomp.h&gt;</b>

       <b>typedef</b> <b>void</b> <b>*</b> <b>scmp_filter_ctx;</b>

       <b>int</b> <b>seccomp_load(scmp_filter_ctx</b> <u>ctx</u><b>);</b>

       Link with <u>-lseccomp</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Loads the seccomp filter provided by <u>ctx</u> into the kernel; if the function succeeds the new seccomp filter
       will  be  active  when  the function returns.  If <b><a href="../man3/seccomp_precompute.3.html">seccomp_precompute</a></b>(3) was called prior to attempting to
       load the seccomp filter, and no changes have been made to the filter, <b>seccomp_load</b>() can be considered to
       be async-signal-safe.

       As it is possible to have multiple stacked seccomp filters for a given task (defined as either a  process
       or  a  thread), it is important to remember that each of the filters loaded for a given task are executed
       when a syscall is made and the "strictest" rule is the rule that is applied.  In  the  case  of  seccomp,
       "strictest"  is  defined  as  the  action  with  the lowest value (e.g.  <u>SCMP_ACT_KILL</u> is "stricter" than
       <u>SCMP_ACT_ALLOW</u>).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Returns zero on success or one of the following error codes on failure:

       <b>-ECANCELED</b>
              There was a system failure beyond the control of the library.

       <b>-EFAULT</b>
              Internal libseccomp failure.

       <b>-EINVAL</b>
              Invalid input, either the context or architecture token is invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.

       <b>-ESRCH</b> Unable to load the filter due to thread issues.

       If the <u>SCMP_FLTATR_API_SYSRAWRC</u> filter attribute is non-zero then additional error codes may be  returned
       to  the  caller;  these  additional  error  codes  are  the negative <u>errno</u> values returned by the system.
       Unfortunately libseccomp can make no guarantees about these return values.

</pre><h4><b>EXAMPLES</b></h4><pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx;

            ctx = seccomp_init(SCMP_ACT_KILL);
            if (ctx == NULL)
                 goto out;

            /* ... */

            rc = seccomp_load(ctx);
            if (rc &lt; 0)
                 goto out;

            /* ... */

       out:
            seccomp_release(ctx);
            return -rc;
       }

</pre><h4><b>NOTES</b></h4><pre>
       While the seccomp filter can be generated independent of the kernel, kernel support is required  to  load
       and enforce the seccomp filter generated by libseccomp.

       The  libseccomp  project  site,  with  more  information  and the source code repository, can be found at
       https://github.com/seccomp/libseccomp.  This tool, as well as the libseccomp library, is currently  under
       development, please report any bugs at the project site or directly to the author.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Moore &lt;<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3),  <b><a href="../man3/seccomp_reset.3.html">seccomp_reset</a></b>(3),  <b><a href="../man3/seccomp_release.3.html">seccomp_release</a></b>(3),  <b><a href="../man3/seccomp_rule_add.3.html">seccomp_rule_add</a></b>(3),  <b><a href="../man3/seccomp_rule_add_exact.3.html">seccomp_rule_add_exact</a></b>(3)
       <b><a href="../man3/seccomp_precompute.3.html">seccomp_precompute</a></b>(3) <b><a href="../man7/signal-safety.7.html">signal-safety</a></b>(7)

<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>                                30 May 2020                                   <u><a href="../man3/seccomp_load.3.html">seccomp_load</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>