<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>seccomp_export_bpf, seccomp_export_pfc - Export the seccomp filter</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libseccomp-dev">libseccomp-dev_2.6.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       seccomp_export_bpf, seccomp_export_pfc - Export the seccomp filter

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;seccomp.h&gt;</b>

       <b>typedef</b> <b>void</b> <b>*</b> <b>scmp_filter_ctx;</b>

       <b>int</b> <b>seccomp_export_bpf(const</b> <b>scmp_filter_ctx</b> <u>ctx</u><b>,</b> <b>int</b> <u>fd</u><b>);</b>
       <b>int</b> <b>seccomp_export_pfc(const</b> <b>scmp_filter_ctx</b> <u>ctx</u><b>,</b> <b>int</b> <u>fd</u><b>);</b>
       <b>int</b> <b>seccomp_export_bpf_mem(const</b> <b>scmp_filter_ctx</b> <u>ctx</u><b>,</b> <b>void</b> <b>*</b><u>buf</u><b>,</b> <b>size_t</b> <b>*</b><u>len</u><b>);</b>

       Link with <u>-lseccomp</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>seccomp_export_bpf</b>()  and  <b>seccomp_export_pfc</b>()  functions  generate  and output the current seccomp
       filter  in  either  BPF  (Berkeley  Packet  Filter)  or  PFC  (Pseudo  Filter  Code).   The   output   of
       <b>seccomp_export_bpf</b>() is suitable for loading into the kernel, while the output of <b>seccomp_export_pfc</b>() is
       human  readable  and  is  intended  primarily  as a debugging tool for developers using libseccomp.  Both
       functions write the filter to the <u>fd</u> file descriptor.

       The filter context <u>ctx</u> is the value returned by the call to <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3).

       While the two output formats are guaranteed to be functionally equivalent for the  given  seccomp  filter
       configuration, the filter instructions, and their ordering, are not guaranteed to be the same in both the
       BPF and PFC formats.

       The <b>seccomp_export_bpf_mem</b>() function is largely the same as <b>seccomp_export_bpf</b>(), but instead of writing
       to  a  file  descriptor,  the program will be written to the <u>buf</u> pointer provided by the caller.  The <u>len</u>
       argument must be initialized with the size of the <u>buf</u> buffer.  If the program  was  valid,  <u>len</u>  will  be
       updated  with  its  size  in  bytes.   If  <u>buf</u> was too small to hold the program, <u>len</u> can be consulted to
       determine the required size.  Passing a NULL <u>buf</u> may also be used to query the  required  size  ahead  of
       time.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Return zero on success or one of the following error codes on failure:

       <b>-ECANCELED</b>
              There was a system failure beyond the control of the library.

       <b>-EFAULT</b>
              Internal libseccomp failure.

       <b>-EINVAL</b>
              Invalid input, either the context or architecture token is invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.

       <b>-ERANGE</b>
              The provided buffer was too small.

       If  the <u>SCMP_FLTATR_API_SYSRAWRC</u> filter attribute is non-zero then additional error codes may be returned
       to the caller; these additional error codes are  the  negative  <u>errno</u>  values  returned  by  the  system.
       Unfortunately libseccomp can make no guarantees about these return values.

</pre><h4><b>EXAMPLES</b></h4><pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx;
            int filter_fd;

            ctx = seccomp_init(SCMP_ACT_KILL);
            if (ctx == NULL)
                 goto out;

            /* ... */

            filter_fd = open("/tmp/seccomp_filter.bpf", O_WRONLY);
            if (filter_fd == -1) {
                 rc = -errno;
                 goto out;
            }

            rc = seccomp_export_bpf(ctx, filter_fd);
            if (rc &lt; 0) {
                 close(filter_fd);
                 goto out;
            }
            close(filter_fd);

            /* ... */

       out:
            seccomp_release(ctx);
            return -rc;
       }

</pre><h4><b>NOTES</b></h4><pre>
       While  the  seccomp filter can be generated independent of the kernel, kernel support is required to load
       and enforce the seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the  source  code  repository,  can  be  found  at
       https://github.com/seccomp/libseccomp.   This tool, as well as the libseccomp library, is currently under
       development, please report any bugs at the project site or directly to the author.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Moore &lt;<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3), <b><a href="../man3/seccomp_release.3.html">seccomp_release</a></b>(3)

<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>                                30 May 2020                             <u><a href="../man3/seccomp_export_bpf.3.html">seccomp_export_bpf</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>