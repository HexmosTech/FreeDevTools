<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>seccomp_arch_add,  seccomp_arch_remove,  seccomp_arch_exist,  seccomp_arch_native - Manage seccomp filter</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libseccomp-dev">libseccomp-dev_2.6.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       seccomp_arch_add,  seccomp_arch_remove,  seccomp_arch_exist,  seccomp_arch_native - Manage seccomp filter
       architectures

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;seccomp.h&gt;</b>

       <b>typedef</b> <b>void</b> <b>*</b> <b>scmp_filter_ctx;</b>

       <b>#define</b> <b>SCMP_ARCH_NATIVE</b>
       <b>#define</b> <b>SCMP_ARCH_X86</b>
       <b>#define</b> <b>SCMP_ARCH_X86_64</b>
       <b>#define</b> <b>SCMP_ARCH_X32</b>
       <b>#define</b> <b>SCMP_ARCH_ARM</b>
       <b>#define</b> <b>SCMP_ARCH_AARCH64</b>
       <b>#define</b> <b>SCMP_ARCH_LOONGARCH64</b>
       <b>#define</b> <b>SCMP_ARCH_M68K</b>
       <b>#define</b> <b>SCMP_ARCH_MIPS</b>
       <b>#define</b> <b>SCMP_ARCH_MIPS64</b>
       <b>#define</b> <b>SCMP_ARCH_MIPS64N32</b>
       <b>#define</b> <b>SCMP_ARCH_MIPSEL</b>
       <b>#define</b> <b>SCMP_ARCH_MIPSEL64</b>
       <b>#define</b> <b>SCMP_ARCH_MIPSEL64N32</b>
       <b>#define</b> <b>SCMP_ARCH_PPC</b>
       <b>#define</b> <b>SCMP_ARCH_PPC64</b>
       <b>#define</b> <b>SCMP_ARCH_PPC64LE</b>
       <b>#define</b> <b>SCMP_ARCH_S390</b>
       <b>#define</b> <b>SCMP_ARCH_S390X</b>
       <b>#define</b> <b>SCMP_ARCH_SH</b>
       <b>#define</b> <b>SCMP_ARCH_SHEB</b>
       <b>#define</b> <b>SCMP_ARCH_PARISC</b>
       <b>#define</b> <b>SCMP_ARCH_PARISC64</b>
       <b>#define</b> <b>SCMP_ARCH_RISCV64</b>

       <b>uint32_t</b> <b>seccomp_arch_resolve_name(const</b> <b>char</b> <b>*</b><u>arch_name</u><b>);</b>
       <b>uint32_t</b> <b>seccomp_arch_native();</b>
       <b>int</b> <b>seccomp_arch_exist(const</b> <b>scmp_filter_ctx</b> <u>ctx</u><b>,</b> <b>uint32_t</b> <u>arch_token</u><b>);</b>
       <b>int</b> <b>seccomp_arch_add(scmp_filter_ctx</b> <u>ctx</u><b>,</b> <b>uint32_t</b> <u>arch_token</u><b>);</b>
       <b>int</b> <b>seccomp_arch_remove(scmp_filter_ctx</b> <u>ctx</u><b>,</b> <b>uint32_t</b> <u>arch_token</u><b>);</b>

       Link with <u>-lseccomp</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>seccomp_arch_exist</b>() function tests to see if a given architecture has  been  added  to  the  seccomp
       filter  in  <u>ctx</u>,  where  the  <b>seccomp_arch_add</b>()  and <b>seccomp_arch_remove</b>() add and remove, respectively,
       architectures from the seccomp filter.   In  all  three  functions,  the  architecture  values  given  in
       <u>arch_token</u>  should  be  the  <b>SCMP_ARCH_*</b>  defined  constants;  with  the <b>SCMP_ARCH_NATIVE</b> constant always
       referring to the native compiled architecture.  The <b>seccomp_arch_native</b>() function returns  the  system's
       architecture   such   that   it   will   match   one   of   the   <b>SCMP_ARCH_*</b>   constants.    While   the
       <b>seccomp_arch_resolve_name</b>() function also returns a <b>SCMP_ARCH_*</b> constant, the returned token matches  the
       name of the architecture passed as an argument to the function.

       When  a  seccomp  filter  is  initialized  with  the  call  to <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3) the native architecture is
       automatically added to the filter.

       While it is possible to remove all architectures from a filter, most of the libseccomp APIs will fail  if
       the filter does not contain at least one architecture.

       When  adding  a  new  architecture to an existing filter, the existing rules will not be added to the new
       architecture.  However, rules added after adding the new  architecture  will  be  added  to  all  of  the
       architectures in the filter.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The  <b>seccomp_arch_add</b>(), <b>seccomp_arch_remove</b>(), and <b>seccomp_arch_exist</b>() functions return zero on success
       or one of the following error codes on failure:

       <b>-EDOM</b>  Architecture specific failure.

       <b>-EEXIST</b>
              In  the  case  of  <b>seccomp_arch_add</b>()  the  architecture  already  exists  and  in  the  case   of
              <b>seccomp_arch_remove</b>() the architecture does not exist.

       <b>-EINVAL</b>
              Invalid input, either the context or architecture token is invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.

</pre><h4><b>EXAMPLES</b></h4><pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx;

            ctx = seccomp_init(SCMP_ACT_KILL);
            if (ctx == NULL)
                 goto out;

            if (seccomp_arch_exist(ctx, SCMP_ARCH_X86) == -EEXIST) {
                 rc = seccomp_arch_add(ctx, SCMP_ARCH_X86);
                 if (rc != 0)
                      goto out_all;
                 rc = seccomp_arch_remove(ctx, SCMP_ARCH_NATIVE);
                 if (rc != 0)
                      goto out_all;
            }

            /* ... */

       out:
            seccomp_release(ctx);
            return -rc;
       }

</pre><h4><b>NOTES</b></h4><pre>
       While  the  seccomp filter can be generated independent of the kernel, kernel support is required to load
       and enforce the seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the  source  code  repository,  can  be  found  at
       https://github.com/seccomp/libseccomp.   This tool, as well as the libseccomp library, is currently under
       development, please report any bugs at the project site or directly to the author.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Moore &lt;<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3), <b><a href="../man3/seccomp_reset.3.html">seccomp_reset</a></b>(3), <b><a href="../man3/seccomp_merge.3.html">seccomp_merge</a></b>(3)

<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>                               15 June 2020                               <u><a href="../man3/seccomp_arch_add.3.html">seccomp_arch_add</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>