<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>seccomp_syscall_priority - Prioritize syscalls in the seccomp filter</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libseccomp-dev">libseccomp-dev_2.6.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       seccomp_syscall_priority - Prioritize syscalls in the seccomp filter

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;seccomp.h&gt;</b>

       <b>typedef</b> <b>void</b> <b>*</b> <b>scmp_filter_ctx;</b>

       <b>int</b> <b>SCMP_SYS(</b><u>syscall_name</u><b>);</b>

       <b>int</b> <b>seccomp_syscall_priority(scmp_filter_ctx</b> <u>ctx</u><b>,</b>
                                    <b>int</b> <u>syscall</u><b>,</b> <b>uint8_t</b> <u>priority</u><b>);</b>

       Link with <u>-lseccomp</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>seccomp_syscall_priority</b>()  function  provides  a  priority  hint to the seccomp filter generator in
       libseccomp such that higher priority syscalls are placed earlier in the seccomp filter code so that  they
       incur  less  overhead  at  the  expense  of  lower  priority  syscalls.   A syscall's priority can be set
       regardless of if any rules currently exist for that syscall; the library will remember the  priority  and
       it will be assigned to the syscall if and when a rule for that syscall is created.

       While  it  is  possible  to specify the <u>syscall</u> value directly using the standard <b>__NR_syscall</b> values, in
       order to ensure proper operation across multiple architectures  it  is  highly  recommended  to  use  the
       <b>SCMP_SYS</b>() macro instead.  See the EXAMPLES section below.

       The  <u>priority</u>  parameter  takes  an  8-bit value ranging from 0 - 255; a higher value represents a higher
       priority.

       The filter context <u>ctx</u> is the value returned by the call to <b>seccomp_init</b>().

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>SCMP_SYS</b>() macro returns a value suitable for use as the <u>syscall</u> value in <b>seccomp_syscall_priority</b>().

       The <b>seccomp_syscall_priority</b>() function returns zero on success or one of the following  error  codes  on
       failure:

       <b>-EDOM</b>  Architecture specific failure.

       <b>-EFAULT</b>
              Internal libseccomp failure.

       <b>-EINVAL</b>
              Invalid input, either the context or architecture token is invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.

</pre><h4><b>EXAMPLES</b></h4><pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx;

            ctx = seccomp_init(SCMP_ACT_KILL);
            if (ctx == NULL)
                 goto out;

            /* ... */

            rc = seccomp_syscall_priority(ctx, SCMP_SYS(read), 200);
            if (rc &lt; 0)
                 goto out;

            /* ... */

       out:
            seccomp_release(ctx);
            return -rc;
       }

</pre><h4><b>NOTES</b></h4><pre>
       While  the  seccomp filter can be generated independent of the kernel, kernel support is required to load
       and enforce the seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the  source  code  repository,  can  be  found  at
       https://github.com/seccomp/libseccomp.   This tool, as well as the libseccomp library, is currently under
       development, please report any bugs at the project site or directly to the author.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Moore &lt;<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/seccomp_rule_add.3.html">seccomp_rule_add</a></b>(3), <b><a href="../man3/seccomp_rule_add_exact.3.html">seccomp_rule_add_exact</a></b>(3)

<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>                                30 May 2020                       <u><a href="../man3/seccomp_syscall_priority.3.html">seccomp_syscall_priority</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>