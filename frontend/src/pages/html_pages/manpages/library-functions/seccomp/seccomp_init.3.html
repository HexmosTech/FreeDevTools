<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>seccomp_init, seccomp_reset - Initialize the seccomp filter state</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libseccomp-dev">libseccomp-dev_2.6.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       seccomp_init, seccomp_reset - Initialize the seccomp filter state

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;seccomp.h&gt;</b>

       <b>typedef</b> <b>void</b> <b>*</b> <b>scmp_filter_ctx;</b>

       <b>scmp_filter_ctx</b> <b>seccomp_init(uint32_t</b> <u>def_action</u><b>);</b>
       <b>int</b> <b>seccomp_reset(scmp_filter_ctx</b> <u>ctx</u><b>,</b> <b>uint32_t</b> <u>def_action</u><b>);</b>

       Link with <u>-lseccomp</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>seccomp_init</b>()  and  <b>seccomp_reset</b>()  functions  (re)initialize  the  internal seccomp filter state,
       prepares it for use, and sets the default action based on the <u>def_action</u> parameter.   The  <b>seccomp_init</b>()
       function must be called before any other libseccomp functions as the rest of the library API will fail if
       the  filter  context  is  not  initialized  properly.  The <b>seccomp_reset</b>() function releases the existing
       filter context state before reinitializing it and can only be called after a call to  <b>seccomp_init</b>()  has
       succeeded.   If  <b>seccomp_reset</b>() is called with a NULL filter, it resets the library's global task state,
       including any notification file descriptors retrieved by  <b><a href="../man3/seccomp_notify_fd.3.html">seccomp_notify_fd</a></b>(3).   Normally  this  is  not
       needed, but it may be required to continue using the library after a <b>fork</b>() or <b>clone</b>() call to ensure the
       API level and user notification state is properly reset.

       When  the caller is finished configuring the seccomp filter and has loaded it into the kernel, the caller
       should call <b><a href="../man3/seccomp_release.3.html">seccomp_release</a></b>(3) to release all of the filter context state.

       Valid <u>def_action</u> values are as follows:

       <b>SCMP_ACT_KILL</b>
              The thread will be terminated by the kernel with SIGSYS when it calls  a  syscall  that  does  not
              match  any  of  the  configured  seccomp  filter  rules.  The thread will not be able to catch the
              signal.

       <b>SCMP_ACT_KILL_PROCESS</b>
              The entire process will be terminated by the kernel with SIGSYS when it calls a syscall that  does
              not match any of the configured seccomp filter rules.

       <b>SCMP_ACT_TRAP</b>
              The  thread  will  be  sent a SIGSYS signal when it calls a syscall that does not match any of the
              configured seccomp filter rules.  It may catch this and change  its  behavior  accordingly.   When
              using  SA_SIGINFO with <b><a href="../man2/sigaction.2.html">sigaction</a></b>(2), si_code will be set to SYS_SECCOMP, si_syscall will be set to
              the syscall that failed the rules, and si_arch will be set to the AUDIT_ARCH for the active ABI.

       <b>SCMP_ACT_ERRNO(uint16_t</b> <b>errno)</b>
              The thread will receive a return value of <u>errno</u> when it calls a syscall that does not match any of
              the configured seccomp filter rules.

       <b>SCMP_ACT_TRACE(uint16_t</b> <b>msg_num)</b>
              If the thread is being traced and the tracing process specified the  <b>PTRACE_O_TRACESECCOMP</b>  option
              in  the call to <b><a href="../man2/ptrace.2.html">ptrace</a></b>(2), the tracing process will be notified, via <b>PTRACE_EVENT_SECCOMP</b>, and the
              value provided in <u>msg_num</u> can be retrieved using the <b>PTRACE_GETEVENTMSG</b> option.

       <b>SCMP_ACT_LOG</b>
              The seccomp filter will have no effect on the thread calling the syscall if it does not match  any
              of the configured seccomp filter rules but the syscall will be logged.

       <b>SCMP_ACT_ALLOW</b>
              The  seccomp filter will have no effect on the thread calling the syscall if it does not match any
              of the configured seccomp filter rules.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>seccomp_init</b>() function returns a filter context on success, NULL on  failure.   The  <b>seccomp_reset</b>()
       function returns zero on success or one of the following error codes on failure:

       <b>-EINVAL</b>
              Invalid input, either the context or action is invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.

</pre><h4><b>EXAMPLES</b></h4><pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx;

            ctx = seccomp_init(SCMP_ACT_KILL);
            if (ctx == NULL)
                 goto out;

            /* ... */

            rc = seccomp_reset(ctx, SCMP_ACT_KILL);
            if (rc &lt; 0)
                 goto out;

            /* ... */

       out:
            seccomp_release(ctx);
            return -rc;
       }

</pre><h4><b>NOTES</b></h4><pre>
       While  the  seccomp filter can be generated independent of the kernel, kernel support is required to load
       and enforce the seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the  source  code  repository,  can  be  found  at
       https://github.com/seccomp/libseccomp.   This tool, as well as the libseccomp library, is currently under
       development, please report any bugs at the project site or directly to the author.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Moore &lt;<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/seccomp_release.3.html">seccomp_release</a></b>(3)

<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>                                30 May 2020                                   <u><a href="../man3/seccomp_init.3.html">seccomp_init</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>