<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>seccomp_attr_set, seccomp_attr_get - Manage the seccomp filter attributes</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libseccomp-dev">libseccomp-dev_2.6.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       seccomp_attr_set, seccomp_attr_get - Manage the seccomp filter attributes

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;seccomp.h&gt;</b>

       <b>typedef</b> <b>void</b> <b>*</b> <b>scmp_filter_ctx;</b>
       <b>enum</b> <b>scmp_filter_attr;</b>

       <b>int</b> <b>seccomp_attr_set(scmp_filter_ctx</b> <u>ctx</u><b>,</b>
                            <b>enum</b> <b>scmp_filter_attr</b> <u>attr</u><b>,</b> <b>uint32_t</b> <u>value</u><b>);</b>
       <b>int</b> <b>seccomp_attr_get(scmp_filter_ctx</b> <u>ctx</u><b>,</b>
                            <b>enum</b> <b>scmp_filter_attr</b> <u>attr</u><b>,</b> <b>uint32_t</b> <b>*</b><u>value</u><b>);</b>

       Link with <u>-lseccomp</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>seccomp_attr_set</b>() function sets the different seccomp filter attributes while the <b>seccomp_attr_get</b>()
       function fetches the filter attributes.  The seccomp filter attributes are tunable values that affect how
       the  library  behaves when generating and loading the seccomp filter into the kernel.  The attributes are
       reset to their default values whenever  the  filter  is  initialized  or  reset  via  <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3)  or
       <b><a href="../man3/seccomp_reset.3.html">seccomp_reset</a></b>(3).

       The filter context <u>ctx</u> is the value returned by the call to <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3).

       Valid <u>attr</u> values are as follows:

       <b>SCMP_FLTATR_ACT_DEFAULT</b>
              The  default  filter action as specified in the call to <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3) or <b><a href="../man3/seccomp_reset.3.html">seccomp_reset</a></b>(3).  This
              attribute is read-only.

       <b>SCMP_FLTATR_ACT_BADARCH</b>
              The filter action taken when the loaded filter does not match the architecture  of  the  executing
              application.  Defaults to the <b>SCMP_ACT_KILL</b> action.

       <b>SCMP_FLTATR_CTL_NNP</b>
              A  flag  to specify if the NO_NEW_PRIVS functionality should be enabled before loading the seccomp
              filter into the kernel.  Setting this to off (<u>value</u> == 0)  results  in  no  action,  meaning  that
              loading  the seccomp filter into the kernel will fail if CAP_SYS_ADMIN is missing and NO_NEW_PRIVS
              has not been externally set.  Defaults to on (<u>value</u> == 1).

       <b>SCMP_FLTATR_CTL_TSYNC</b>
              A flag to specify if the kernel should attempt to synchronize the filters across  all  threads  on
              <b><a href="../man3/seccomp_load.3.html">seccomp_load</a></b>(3).  If the kernel is unable to synchronize all of the thread then the load operation
              will fail.  This flag is only available on Linux Kernel 3.17 or greater; attempting to enable this
              flag on earlier kernels will result in an error being returned.  Defaults to off (<u>value</u> == 0).

       <b>SCMP_FLTATR_API_TSKIP</b>
              A  flag  to specify if libseccomp should allow filter rules to be created for the -1 syscall.  The
              -1 syscall value can be used  by  tracer  programs  to  skip  specific  syscall  invocations,  see
              <b><a href="../man2/seccomp.2.html">seccomp</a></b>(2) for more information.  Defaults to off (<u>value</u> == 0).

       <b>SCMP_FLTATR_CTL_LOG</b>
              A  flag to specify if the kernel should log all filter actions taken except for the <b>SCMP_ACT_ALLOW</b>
              action. Defaults to off (<u>value</u> == 0).

       <b>SCMP_FLTATR_CTL_SSB</b>
              A flag to disable Speculative Store Bypass mitigations for this filter.  Defaults to off (<u>value</u> ==
              0).

       <b>SCMP_FLTATR_CTL_OPTIMIZE</b>
              A flag to specify the optimization level of the seccomp filter.  By default libseccomp generates a
              set of sequential ´if´ statements for each rule in the filter.  <b><a href="../man3/seccomp_syscall_priority.3.html">seccomp_syscall_priority</a></b>(3) can be
              used to prioritize the order for the default cause.  The binary tree optimization sorts by syscall
              numbers and generates consistent <b>O(log</b> <b>n)</b> filter traversal for every  rule  in  the  filter.   The
              binary  tree  may  be  advantageous  for  large filters.  Note that <b><a href="../man3/seccomp_syscall_priority.3.html">seccomp_syscall_priority</a></b>(3) is
              ignored when SCMP_FLTATR_CTL_OPTIMIZE == 2.

              The different optimization levels are described below:

              <b>0</b>      Reserved value, not currently used.

              <b>1</b>      Rules sorted by priority and complexity (DEFAULT).

              <b>2</b>      Binary tree sorted by syscall number.

       <b>SCMP_FLTATR_API_SYSRAWRC</b>
              A flag to specify if libseccomp should pass system error codes back to the caller instead  of  the
              default -ECANCELED.  Defaults to off (<u>value</u> == 0).

       <b>SCMP_FLTATR_CTL_WAITKILL</b>
              A flag to specify if libseccomp should request wait killable semantics when possible.  Defaults to
              off (<u>value</u> == 0).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Returns zero on success or one of the following error codes on failure:

       <b>-EACCES</b>
              Setting the attribute with the given value is not allowed.

       <b>-EEXIST</b>
              The attribute does not exist.

       <b>-EINVAL</b>
              Invalid input, either the context or architecture token is invalid.

       <b>-EOPNOTSUPP</b>
              The library doesn't support the particular operation.

</pre><h4><b>EXAMPLES</b></h4><pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx;

            ctx = seccomp_init(SCMP_ACT_ALLOW);
            if (ctx == NULL)
                 goto out;

            /* ... */

            rc = seccomp_attr_set(ctx, SCMP_FLTATR_ACT_BADARCH, SCMP_ACT_TRAP);
            if (rc &lt; 0)
                 goto out;

            /* ... */

       out:
            seccomp_release(ctx);
            return -rc;
       }

</pre><h4><b>NOTES</b></h4><pre>
       While  the  seccomp filter can be generated independent of the kernel, kernel support is required to load
       and enforce the seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the  source  code  repository,  can  be  found  at
       https://github.com/seccomp/libseccomp.   This tool, as well as the libseccomp library, is currently under
       development, please report any bugs at the project site or directly to the author.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Moore &lt;<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3), <b><a href="../man3/seccomp_reset.3.html">seccomp_reset</a></b>(3), <b><a href="../man3/seccomp_load.3.html">seccomp_load</a></b>(3), <b><a href="../man2/seccomp.2.html">seccomp</a></b>(2)

<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>                             21 September 2022                            <u><a href="../man3/seccomp_attr_set.3.html">seccomp_attr_set</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>