<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>matherr - SVID math library exception handling</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       matherr - SVID math library exception handling

</pre><h4><b>LIBRARY</b></h4><pre>
       Math library (<u>libm</u>, <u>-lm</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/math.h">math.h</a>&gt;</b>

       <b>[[deprecated]]</b> <b>int</b> <b>matherr(struct</b> <b>exception</b> <b>*</b><u>exc</u><b>);</b>

       <b>[[deprecated]]</b> <b>extern</b> <b>_LIB_VERSION_TYPE</b> <b>_LIB_VERSION;</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>Note</u>:  the  mechanism  described in this page is no longer supported by glibc.  Before glibc 2.27, it had
       been marked as obsolete.  Since glibc 2.27, the mechanism has been removed altogether.  New  applications
       should  use  the  techniques  described  in <b><a href="../man7/math_error.7.html">math_error</a></b>(7) and <b><a href="../man3/fenv.3.html">fenv</a></b>(3).  This page documents the <b>matherr</b>()
       mechanism as an aid for maintaining and porting older applications.

       The System V Interface Definition (SVID) specifies that various math functions should invoke  a  function
       called  <b>matherr</b>()  if  a  math  exception  is detected.  This function is called before the math function
       returns; after <b>matherr</b>() returns, the system then returns to the math function, which in turn returns  to
       the caller.

       To employ <b>matherr</b>(), the programmer must define the <b>_SVID_SOURCE</b> feature test macro (before including <u>any</u>
       header files), and assign the value <b>_SVID_</b> to the external variable <b>_LIB_VERSION</b>.

       The  system  provides  a  default version of <b>matherr</b>().  This version does nothing, and returns zero (see
       below for the significance of this).  The default <b>matherr</b>() can be  overridden  by  a  programmer-defined
       version,  which  will  be invoked when an exception occurs.  The function is invoked with one argument, a
       pointer to an <u>exception</u> structure, defined as follows:

           struct exception {
               int    type;      /* Exception type */
               char  *name;      /* Name of function causing exception */
               double arg1;      /* 1st argument to function */
               double arg2;      /* 2nd argument to function */
               double retval;    /* Function return value */
           }

       The <u>type</u> field has one of the following values:

       <b>DOMAIN</b>      A domain error occurred (the function argument was outside the range for which  the  function
                   is defined).  The return value depends on the function; <u>errno</u> is set to <b>EDOM</b>.

       <b>SING</b>        A  pole  error occurred (the function result is an infinity).  The return value in most cases
                   is <b>HUGE</b> (the largest single precision floating-point number), appropriately signed.  In  most
                   cases, <u>errno</u> is set to <b>EDOM</b>.

       <b>OVERFLOW</b>    An overflow occurred.  In most cases, the value <b>HUGE</b> is returned, and <u>errno</u> is set to <b>ERANGE</b>.

       <b>UNDERFLOW</b>   An underflow occurred.  0.0 is returned, and <u>errno</u> is set to <b>ERANGE</b>.

       <b>TLOSS</b>       Total loss of significance.  0.0 is returned, and <u>errno</u> is set to <b>ERANGE</b>.

       <b>PLOSS</b>       Partial loss of significance.  This value is unused on glibc (and many other systems).

       The <u>arg1</u> and <u>arg2</u> fields are the arguments supplied to the function (<u>arg2</u> is undefined for functions that
       take only one argument).

       The  <u>retval</u>  field  specifies  the  return  value  that the math function will return to its caller.  The
       programmer-defined <b>matherr</b>() can modify this field to change the return value of the math function.

       If the <b>matherr</b>() function returns zero, then the system sets <u>errno</u> as described above, and may  print  an
       error message on standard error (see below).

       If  the <b>matherr</b>() function returns a nonzero value, then the system does not set <u>errno</u>, and doesn't print
       an error message.

   <b>Math</b> <b>functions</b> <b>that</b> <b>employ</b> <b>matherr()</b>
       The table below lists the functions and circumstances in which <b>matherr</b>() is called.   The  "Type"  column
       indicates  the  value  assigned  to <u>exc-&gt;type</u> when calling <b>matherr</b>().  The "Result" column is the default
       return value assigned to <u>exc-&gt;retval</u>.

       The "Msg?" and "errno" columns describe the default behavior if <b>matherr</b>() returns zero.   If  the  "Msg?"
       columns contains "y", then the system prints an error message on standard error.

       The table uses the following notations and abbreviations:

              x        first argument to function
              y        second argument to function
              fin      finite value for argument
              neg      negative value for argument
              int      integral value for argument
              o/f      result overflowed
              u/f      result underflowed
              |x|      absolute value of x
              X_TLOSS  is a constant defined in <u>&lt;math.h&gt;</u>
       <b>Function</b>             <b>Type</b>        <b>Result</b>         <b>Msg?</b>   <b>errno</b>
       acos(|x|&gt;1)          DOMAIN      HUGE            y     EDOM
       asin(|x|&gt;1)          DOMAIN      HUGE            y     EDOM
       atan2(0,0)           DOMAIN      HUGE            y     EDOM
       acosh(x&lt;1)           DOMAIN      NAN             y     EDOM
       atanh(|x|&gt;1)         DOMAIN      NAN             y     EDOM
       atanh(|x|==1)        SING        (x&gt;0.0)?        y     EDOM
                                        HUGE_VAL :
                                        -HUGE_VAL
       cosh(fin) o/f        OVERFLOW    HUGE            n     ERANGE
       sinh(fin) o/f        OVERFLOW    (x&gt;0.0) ?       n     ERANGE
                                        HUGE : -HUGE
       sqrt(x&lt;0)            DOMAIN      0.0             y     EDOM
       hypot(fin,fin) o/f   OVERFLOW    HUGE            n     ERANGE
       exp(fin) o/f         OVERFLOW    HUGE            n     ERANGE
       exp(fin) u/f         UNDERFLOW   0.0             n     ERANGE
       exp2(fin) o/f        OVERFLOW    HUGE            n     ERANGE
       exp2(fin) u/f        UNDERFLOW   0.0             n     ERANGE
       exp10(fin) o/f       OVERFLOW    HUGE            n     ERANGE
       exp10(fin) u/f       UNDERFLOW   0.0             n     ERANGE
       j0(|x|&gt;X_TLOSS)      TLOSS       0.0             y     ERANGE
       j1(|x|&gt;X_TLOSS)      TLOSS       0.0             y     ERANGE
       jn(|x|&gt;X_TLOSS)      TLOSS       0.0             y     ERANGE
       y0(x&gt;X_TLOSS)        TLOSS       0.0             y     ERANGE
       y1(x&gt;X_TLOSS)        TLOSS       0.0             y     ERANGE
       yn(x&gt;X_TLOSS)        TLOSS       0.0             y     ERANGE
       <a href="../man0/y0.0.html">y0</a>(0)                DOMAIN      -HUGE           y     EDOM
       y0(x&lt;0)              DOMAIN      -HUGE           y     EDOM
       <a href="../man0/y1.0.html">y1</a>(0)                DOMAIN      -HUGE           y     EDOM
       y1(x&lt;0)              DOMAIN      -HUGE           y     EDOM
       yn(n,0)              DOMAIN      -HUGE           y     EDOM
       yn(x&lt;0)              DOMAIN      -HUGE           y     EDOM
       lgamma(fin) o/f      OVERFLOW    HUGE            n     ERANGE
       lgamma(-int) or      SING        HUGE            y     EDOM
         <a href="../man0/lgamma.0.html">lgamma</a>(0)
       tgamma(fin) o/f      OVERFLOW    HUGE_VAL        n     ERANGE
       tgamma(-int)         SING        NAN             y     EDOM
       <a href="../man0/tgamma.0.html">tgamma</a>(0)            SING        copysign(       y     ERANGE
                                        HUGE_VAL,x)
       <a href="../man0/log.0.html">log</a>(0)               SING        -HUGE           y     EDOM
       log(x&lt;0)             DOMAIN      -HUGE           y     EDOM
       <a href="../man0/log2.0.html">log2</a>(0)              SING        -HUGE           n     EDOM
       log2(x&lt;0)            DOMAIN      -HUGE           n     EDOM
       <a href="../man0/log10.0.html">log10</a>(0)             SING        -HUGE           y     EDOM
       log10(x&lt;0)           DOMAIN      -HUGE           y     EDOM
       pow(0.0,0.0)         DOMAIN      0.0             y     EDOM
       pow(x,y) o/f         OVERFLOW    HUGE            n     ERANGE
       pow(x,y) u/f         UNDERFLOW   0.0             n     ERANGE
       pow(NaN,0.0)         DOMAIN      x               n     EDOM
       0**neg               DOMAIN      0.0             y     EDOM
       neg**non-int         DOMAIN      0.0             y     EDOM
       scalb() o/f          OVERFLOW    (x&gt;0.0) ?       n     ERANGE
                                        HUGE_VAL :
                                        -HUGE_VAL
       scalb() u/f          UNDERFLOW   copysign(       n     ERANGE
                                          0.0,x)
       fmod(x,0)            DOMAIN      x               y     EDOM
       remainder(x,0)       DOMAIN      NAN             y     EDOM

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       For an explanation of the terms used in this section, see <b><a href="../man7/attributes.7.html">attributes</a></b>(7).
       ┌─────────────────────────────────────────────────────────────────────────────┬───────────────┬─────────┐
       │ <b>Interface</b>                                                                   │ <b>Attribute</b>     │ <b>Value</b>   │
       ├─────────────────────────────────────────────────────────────────────────────┼───────────────┼─────────┤
       │ <b>matherr</b>()                                                                   │ Thread safety │ MT-Safe │
       └─────────────────────────────────────────────────────────────────────────────┴───────────────┴─────────┘

</pre><h4><b>EXAMPLES</b></h4><pre>
       The example program demonstrates the use of <b>matherr</b>() when calling <b><a href="../man3/log.3.html">log</a></b>(3).  The program takes up to three
       command-line  arguments.   The first argument is the floating-point number to be given to <b><a href="../man3/log.3.html">log</a></b>(3).  If the
       optional second argument is provided, then <b>_LIB_VERSION</b> is set to <b>_SVID_</b> so that <b>matherr</b>() is called, and
       the integer supplied in the command-line argument is used as the return value  from  <b>matherr</b>().   If  the
       optional  third  command-line  argument  is  supplied, then it specifies an alternative return value that
       <b>matherr</b>() should assign as the return value of the math function.

       The following example run, where <b><a href="../man3/log.3.html">log</a></b>(3) is given an argument of 0.0, does not use <b>matherr</b>():

           $ <b>./a.out</b> <b>0.0</b>
           errno: Numerical result out of range
           x=-inf

       In the following run, <b>matherr</b>() is called, and returns 0:

           $ <b>./a.out</b> <b>0.0</b> <b>0</b>
           matherr SING exception in log() function
                   args:   0.000000, 0.000000
                   retval: -340282346638528859811704183484516925440.000000
           log: SING error
           errno: Numerical argument out of domain
           x=-340282346638528859811704183484516925440.000000

       The message "log: SING error" was printed by the C library.

       In the following run, <b>matherr</b>() is called, and returns a nonzero value:

           $ <b>./a.out</b> <b>0.0</b> <b>1</b>
           matherr SING exception in log() function
                   args:   0.000000, 0.000000
                   retval: -340282346638528859811704183484516925440.000000
           x=-340282346638528859811704183484516925440.000000

       In this case, the C library did not print a message, and <u>errno</u> was not set.

       In the following run, <b>matherr</b>() is called, changes the return value of the math function, and  returns  a
       nonzero value:

           $ <b>./a.out</b> <b>0.0</b> <b>1</b> <b>12345.0</b>
           matherr SING exception in log() function
                   args:   0.000000, 0.000000
                   retval: -340282346638528859811704183484516925440.000000
           x=12345.000000

   <b>Program</b> <b>source</b>

       #define _SVID_SOURCE
       #include &lt;<a href="file:/usr/include/errno.h">errno.h</a>&gt;
       #include &lt;<a href="file:/usr/include/math.h">math.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;

       static int matherr_ret = 0;     /* Value that matherr()
                                          should return */
       static int change_retval = 0;   /* Should matherr() change
                                          function's return value? */
       static double new_retval;       /* New function return value */

       int
       matherr(struct exception *exc)
       {
           fprintf(stderr, "matherr %s exception in %s() function\n",
                   (exc-&gt;type == DOMAIN) ?    "DOMAIN" :
                   (exc-&gt;type == OVERFLOW) ?  "OVERFLOW" :
                   (exc-&gt;type == UNDERFLOW) ? "UNDERFLOW" :
                   (exc-&gt;type == SING) ?      "SING" :
                   (exc-&gt;type == TLOSS) ?     "TLOSS" :
                   (exc-&gt;type == PLOSS) ?     "PLOSS" : "???",
                   exc-&gt;name);
           fprintf(stderr, "        args:   %f, %f\n",
                   exc-&gt;arg1, exc-&gt;arg2);
           fprintf(stderr, "        retval: %f\n", exc-&gt;retval);

           if (change_retval)
               exc-&gt;retval = new_retval;

           return matherr_ret;
       }

       int
       main(int argc, char *argv[])
       {
           double x;

           if (argc &lt; 2) {
               fprintf(stderr, "Usage: %s &lt;argval&gt;"
                       " [&lt;matherr-ret&gt; [&lt;new-func-retval&gt;]]\n", argv[0]);
               exit(EXIT_FAILURE);
           }

           if (argc &gt; 2) {
               _LIB_VERSION = _SVID_;
               matherr_ret = atoi(argv[2]);
           }

           if (argc &gt; 3) {
               change_retval = 1;
               new_retval = atof(argv[3]);
           }

           x = log(atof(argv[1]));
           if (errno != 0)
               perror("errno");

           printf("x=%f\n", x);
           exit(EXIT_SUCCESS);
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/fenv.3.html">fenv</a></b>(3), <b><a href="../man7/math_error.7.html">math_error</a></b>(7), <b><a href="../man7/standards.7.html">standards</a></b>(7)

Linux man-pages 6.9.1                              2024-06-15                                         <u><a href="../man3/matherr.3.html">matherr</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>