<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inline::Files::Virtual - Multiple virtual files in a single file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libinline-files-perl">libinline-files-perl_0.71-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Inline::Files::Virtual - Multiple virtual files in a single file

</pre><h4><b>VERSION</b></h4><pre>
       This document describes version 0.53 of Inline::Files::Virtual, released May 25, 2001.

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Inline::Files::Virtual;

           # Load actual file, extracting virtual files that start with "^&lt;VF&gt;\n"
           @virtual_filenames = vf_load($actual_file, "^&lt;VF&gt;\n");

           # Open one of the virtual files for reading
           open(FILE, $virtual_filenames[0]) or die;

           print while &lt;FILE&gt;;

           close(FILE);

           # Open one of the virtual files for appending
           open(FILE, "&gt;&gt; $virtual_filenames[1]") or die;

           print FILE "extra text";
           printf FILE "%6.2", $number;

           close(FILE);

           # Actual file will be updated at this point

</pre><h4><b>WARNING</b></h4><pre>
       This module is still experimental. Careless use of it will almost certainly cause the source code in
       files that use it to be overwritten.  You are <u>strongly</u> advised to use the Inline::Files module instead.

       If you chose to use this module anyway, you thereby agree that the authors will b&lt;under no circumstances&gt;
       be responsible for any loss of data, code, time, money, or limbs, or for any other disadvantage incurred
       as a result of using Inline::Files.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module allows you to treat a single disk file as a collection of virtual files, which may then be
       individually opened for reading or writing. Virtual files which have been modified are written back to
       their actual disk at the end of the program's execution (or earlier if the "vf_save" subroutine is
       explicitly called).

       Each such virtual file is introduced by a start-of-virtual-file marker (SOVFM). This may be any sequence
       (or pattern) of characters that marks the beginning of the content of a virtual file. For example, the
       string "--" might be used:

               --
               Contents of virtual
               file number 1
               --
               Contents of virtual
               file number 2
               --
               Contents of virtual
               file number 3

       or the pattern "/##### \w+ #####/":

               ##### VF1 #####
               Contents of virtual
               file number 1
               ##### VF2 #####
               Contents of virtual
               file number 2
               ##### VF3 #####
               Contents of virtual
               file number 3

       Note that the SOVFM is not considered to be part of the file contents.

   <b>Interface</b>
       The module exports the following methods:

       "vf_load $file, $SOVFM_pattern"
           This subroutine is called to load an actual disk file containing one or more virtual files. The first
           argument  specifies  the  name  of the file to be loaded as a string. The second argument specifies a
           pattern (as either a string or "qr" regex) that matches each start-of-virtual-file marker within  the
           file. For example, if the file "/usr/local/details.dat" contains:

                   =info names

                   Damian
                   Nathan
                   Mephistopheles

                   =info numbers

                   555-1212
                   555-6874
                   555-3452

                   =info comment

                   Mad
                   Bad
                   Dangerous to know

           then you could load it as three virtual files with:

                   @virtual_filenames =
                           vf_load("/usr/local/details.dat", qr/^=info\s+\S+\s*?\n/);

           Note that, because the actual file is decomposed into virtual files using a "split", it is vital that
           the pattern does not contain any capturing parentheses.

           On  success,  "vf_load"  returns  a  list  of  <u>virtual</u>  <u>filenames</u> for the virtual files. Each virtual
           filename consists of the actual name of the file containing the virtual file, concatenated  with  the
           offset  of  the virtual file's SOVFM within the actual file. For example, the above call to "vf_load"
           would return three virtual filenames:

                   /usr/local/<a href="../man00000000000000000000/details.dat.00000000000000000000.html">details.dat</a>(00000000000000000000)
                   /usr/local/<a href="../man00000000000000000048/details.dat.00000000000000000048.html">details.dat</a>(00000000000000000048)
                   /usr/local/<a href="../man00000000000000000097/details.dat.00000000000000000097.html">details.dat</a>(00000000000000000097)

           When any of these virtual filenames is subsequently used in an "open", the corresponding virtual file
           is opened.

       "vf_save @actual_filenames"
       "vf_save"
           This subroutine causes the virtual files belonging to the nominated actual  file  (or  files)  to  be
           written  back  to  disk.  If "vf_save" is called without arguments, then <u>all</u> currently loaded virtual
           files are saved to their respective actual files at that point.

           "vf_save" is automatically called in an "END" block at the  termination  of  any  program  using  the
           module.

       "vf_marker $virtual_filename"
           This subroutine returns the SOVFM that preceded the nominated virtual file.

       The  module  also  modifies  the  "open",  "close", "print", "printf", "read", "getline", "getc", "seek",
       "tell", and "truncate" built-in functions so that they operate correctly on virtual files.

       As a special case, it is also possible to use the raw SOVFM as a virtual file name:

           use Inline::Files::Virtual;

           vf_load $filename, qr/__[A-Z]+__/;

           open FILE, "__MARKER__";

           # and in the file that was vf_load-ed

           __MARKER__
           file contents here

       However, this always opens the very first virtual file with that SOVFM, no matter how often it is called,
       or how many such markers appear in the file.

   <b>Handling</b> <b>"implicit"</b> <b>virtual</b> <b>start-of-virtual-file</b> <b>markers</b>
       Sometimes an SOVFM is "implicit". That is, rather thanb being a  separate  marker  for  the  start  of  a
       virtual  file,  it  is  the  first part of the actual data of the virtual file. For example, consider the
       following XML file:

               &lt;DATA&gt;
                       &lt;DESC&gt;This is data set 1&lt;/DESC&gt;
                       &lt;DATUM/&gt;datum 1
                       &lt;DATUM/&gt;datum 2
                       &lt;DATUM/&gt;datum 3
               &lt;/DATA&gt;
               &lt;DATA&gt;
                       &lt;DESC&gt;This is data set 2&lt;/DESC&gt;
                       &lt;DATUM/&gt;datum 4
                       &lt;DATUM/&gt;datum 5
                       &lt;DATUM/&gt;datum 6
               &lt;/DATA&gt;

       Each of the "&lt;DATA&gt;...&lt;/DATA&gt;" blocks could be treated as a separate virtual file by specifying:

               @datasets = vf_load("data.xml", '&lt;DATA&gt;');

       But this would cause the individual virtual files to contain invalid XML, such as:

                       &lt;DESC&gt;This is data set 1&lt;/DESC&gt;
                       &lt;DATUM/&gt;datum 1
                       &lt;DATUM/&gt;datum 2
                       &lt;DATUM/&gt;datum 3
               &lt;/DATA&gt;

       One can indicate that the nominated  SOVFMs are also part of the virtual files' contents,  by  specifying
       the markers as a look-ahead pattern:

               @datasets = vf_load("data.xml", '(?=&lt;DATA&gt;)');

       This causes "vf_load" to identify the sequence "&lt;DATA&gt;" as a start-of-virtual-file marker but not consume
       it, thereby leaving it as the initial sequence of the virtual file's content.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       "Could not vf_load '%s'"
           The module could not open the specified disk file and read it in as a set of virtual files.

       "Unable to complete vf_save"
           The  module  could  not  open  the  specified disk file and write it out as a set of virtual files. A
           preceding warning may indicate which virtual file caused the problem.

       "Virtual file not open for input"
           An attempt was made to "getline", "getc", or "read" a virtual file that was opened for  output  only.
           (Warning only)

       "Virtual file not open for output"
           An  attempt  was  made to "print" or "printf" a virtual file that was opened for input only. (Warning
           only)

</pre><h4><b>AUTHOR</b></h4><pre>
       Damian Conway  (<a href="mailto:damian@conway.org">damian@conway.org</a>)

</pre><h4><b>EVIL</b> <b>GENIUS</b> <b>WHO</b> <b>MADE</b> <b>HIM</b> <b>DO</b> <b>IT</b></h4><pre>
       Brian Ingerson (<a href="mailto:INGY@cpan.org">INGY@cpan.org</a>)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2001. Damian Conway. All rights reserved.

       This module is free software; you can redistribute it and/or modify it  under  the  same  terms  as  Perl
       itself.

       See <a href="http://www.perl.com/perl/misc/Artistic.html">http://www.perl.com/perl/misc/Artistic.html</a>

perl v5.36.0                                       2022-12-06                        <u>Inline::Files::<a href="../man3pm/Virtual.3pm.html">Virtual</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>