<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CGI::Application::Plugin::LogDispatch - Add Log::Dispatch support to CGI::Application</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcgi-application-plugin-logdispatch-perl">libcgi-application-plugin-logdispatch-perl_1.02-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CGI::Application::Plugin::LogDispatch - Add Log::Dispatch support to CGI::Application

</pre><h4><b>SYNOPSIS</b></h4><pre>
        package My::App;

        use CGI::Application::Plugin::LogDispatch;

        sub cgiapp_init {
          my $self = shift;

          # calling log_config is optional as
          # some simple defaults will be used
          $self-&gt;log_config(
            LOG_DISPATCH_MODULES =&gt; [
              {    module =&gt; 'Log::Dispatch::File',
                     name =&gt; 'debug',
                 filename =&gt; '/tmp/debug.log',
                min_level =&gt; 'debug',
              },
            ]
          );
        }

        sub myrunmode {
          my $self = shift;

          $self-&gt;log-&gt;info('Information message');
          $self-&gt;log-&gt;debug('Debug message');
        }

        - or as a class based singleton -

        package My::App;

        use CGI::Application::Plugin::LogDispatch (
          LOG_DISPATCH_MODULES =&gt; [
            {    module =&gt; 'Log::Dispatch::File',
                   name =&gt; 'debug',
               filename =&gt; '/tmp/debug.log',
              min_level =&gt; 'debug',
            },
          ]
        );

        My::App-&gt;log-&gt;info('Information message');

        sub myrunmode {
          my $self = shift;

          $self-&gt;log-&gt;info('This also works');
        }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       CGI::Application::Plugin::LogDispatch adds logging support to your CGI::Application modules by providing
       a Log::Dispatch dispatcher object that is accessible from anywhere in the application.

       If you have CGI::Application::Plugin::DevPopup installed, a "Log Entries" report is added to the popup
       window, containing all of the entries that were logged during the execution of the runmode.

</pre><h4><b>METHODS</b></h4><pre>
   <b>log</b>
       This method will return the current Log::Dispatch dispatcher object.  The Log::Dispatch object is created
       on the first call to this method, and any subsequent calls will return the same object.  This effectively
       creates a singleton log dispatcher for the duration of the request.  If "log_config" has not been called
       before the first call to "log", then it will choose some sane defaults to create the dispatcher object
       (the exact default values are defined below).

         # retrieve the log object
         my $log = $self-&gt;log;
         $log-&gt;warning("something's not right!");
         $log-&gt;emergency("It's all gone pear shaped!");

         - or -

         # use the log object directly
         $self-&gt;log-&gt;debug(Data::Dumper::Dumper(\%hash));

         - or -

         # if you configured it as a singleton
         My::App-&gt;log-&gt;debug('This works too');

   <b>log_config</b>
       This method can be used to customize the functionality of the CGI::Application::Plugin::LogDispatch
       module.  Calling this method does not mean that a new Log::Dispatch object will be immediately created.
       The log object will not be created until the first call to $self-&gt;log.

       The recommended place to call "log_config" is in the "cgiapp_init" stage of CGI::Application.  If this
       method is called after the log object has already been accessed, then it will die with an error message.

       If this method is not called at all then a reasonable set of defaults will be used (the exact default
       values are defined below).

       The following parameters are accepted:

       LOG_DISPATCH_OPTIONS
           This  allows  you to customize how the Log::Dispatch object is created by providing a hash of options
           that will be passed to the Log::Dispatch constructor.  Please see the documentation for Log::Dispatch
           for the exact syntax of the parameters.  Surprisingly enough you will usually not need  to  use  this
           option, instead look at the LOG_DISPATCH_MODULES option.

            LOG_DISPATCH_OPTIONS =&gt; {
                 callbacks =&gt; sub { my %h = @_; return time().': '.$h{message}; },
            }

       LOG_DISPATCH_MODULES
           This  option allows you to specify the Log::Dispatch::* modules that you wish to use to log messages.
           You can list multiple dispatch modules, each with their own set of options.  Format the options in an
           array of hashes, where each hash  contains  the  options  for  the  Log::Dispatch::  module  you  are
           configuring  and  also  include a 'module' parameter containing the name of the dispatch module.  See
           below for an example.  You can also add an 'append_newline' option to automatically append a  newline
           to  each  log  entry for this dispatch module (this option is not needed if you already specified the
           APPEND_NEWLINE option listed below which will add a newline for all dispatch modules).

            LOG_DISPATCH_MODULES =&gt; [
              {         module =&gt; 'Log::Dispatch::File',
                          name =&gt; 'messages',
                      filename =&gt; '/tmp/messages.log',
                     min_level =&gt; 'info',
                append_newline =&gt; 1
              },
              {         module =&gt; 'Log::Dispatch::Email::MailSend',
                          name =&gt; 'email',
                            to =&gt; [ qw(<a href="mailto:foo@bar.com">foo@bar.com</a> <a href="mailto:bar@baz.org">bar@baz.org</a> ) ],
                        subject =&gt; 'Oh No!!!!!!!!!!',
                     min_level =&gt; 'emerg'
              }
            ]

       APPEND_NEWLINE
           By default Log::Dispatch does not append a newline to the end of the log messages.  By  setting  this
           option  to  a  true  value,  a  newline  character  will automatically be added to the end of the log
           message.

            APPEND_NEWLINE =&gt; 1

       LOG_METHOD_EXECUTION (EXPERIMENTAL)
           This option will allow you to log the execution path of your program.  Set LOG_METHOD_EXECUTION to  a
           list  of  all the modules you want to be logged.  This will automatically send a debug message at the
           start and end of each method/function that is called in  the  modules  you  listed.   The  parameters
           passed,  and the return value will also be logged.  This can be useful by tracing the program flow in
           the logfile without having to resort to the debugger.

            LOG_METHOD_EXECUTION =&gt; [qw(__PACKAGE__ CGI::Application CGI)],

           WARNING:  This hasn't been heavily tested, although it seems to work fine for me.  Also, a closure is
           created around the log object, so some care may need to be taken when  using  this  in  a  persistent
           environment like mod_perl.  This feature depends on the Sub::WrapPackages module.

   <b>DEFAULT</b> <b>OPTIONS</b>
       The  following example shows what options are set by default (ie this is what you would get if you do not
       call log_config).  A single Log::Dispatch::Screen module that writes error  messages  to  STDERR  with  a
       minimum log level of debug.

        $self-&gt;log_config(
          LOG_DISPATCH_MODULES =&gt; [
            {        module =&gt; 'Log::Dispatch::Screen',
                       name =&gt; 'screen',
                     stderr =&gt; 1,
                  min_level =&gt; 'debug',
             append_newline =&gt; 1
            }
          ],
        );

       Here  is  a  more  customized example that uses two file appenders, and an email gateway.  Here all debug
       messages are sent to /tmp/debug.log, and all messages above are sent  to  /tmp/messages.log.   Also,  any
       emergency messages are emailed to <a href="mailto:foo@bar.com">foo@bar.com</a> and <a href="mailto:bar@baz.org">bar@baz.org</a>.

        $self-&gt;log_config(
          LOG_DISPATCH_MODULES =&gt; [
            {    module =&gt; 'Log::Dispatch::File',
                   name =&gt; 'debug',
               filename =&gt; '/tmp/debug.log',
              min_level =&gt; 'debug',
              max_level =&gt; 'debug'
            },
            {    module =&gt; 'Log::Dispatch::File',
                   name =&gt; 'messages',
               filename =&gt; '/tmp/messages.log',
              min_level =&gt; 'info'
            },
            {    module =&gt; 'Log::Dispatch::Email::MailSend',
                   name =&gt; 'email',
                     to =&gt; [ qw(<a href="mailto:foo@bar.com">foo@bar.com</a> <a href="mailto:bar@baz.org">bar@baz.org</a> ) ],
                 subject =&gt; 'Oh No!!!!!!!!!!',
              min_level =&gt; 'emerg'
            }
          ],
          APPEND_NEWLINE =&gt; 1,
        );

</pre><h4><b>EXAMPLE</b></h4><pre>
       In a CGI::Application module:

         # configure the log modules once during the init stage
         sub cgiapp_init {
           my $self = shift;

           # Configure the session
           $self-&gt;log_config(
             LOG_DISPATCH_MODULES =&gt; [
               {    module =&gt; 'Log::Dispatch::File',
                      name =&gt; 'messages',
                  filename =&gt; '/tmp/messages.log',
                 min_level =&gt; 'error'
               },
               {    module =&gt; 'Log::Dispatch::Email::MailSend',
                      name =&gt; 'email',
                        to =&gt; [ qw(<a href="mailto:foo@bar.com">foo@bar.com</a> <a href="mailto:bar@baz.org">bar@baz.org</a> ) ],
                    subject =&gt; 'Oh No!!!!!!!!!!',
                 min_level =&gt; 'emerg'
               }
             ],
             APPEND_NEWLINE =&gt; 1,
           );

         }

         sub cgiapp_prerun {
           my $self = shift;

           $self-&gt;log-&gt;debug("Current runmode:  ".$self-&gt;get_current_runmode);
         }

         sub my_runmode {
           my $self = shift;
           my $log  = $self-&gt;log;

           if ($ENV{'REMOTE_USER'}) {
             $log-&gt;info("user ".$ENV{'REMOTE_USER'});
           }

           # etc...
         }

</pre><h4><b>SINGLETON</b> <b>SUPPORT</b></h4><pre>
       This  module  can  be  used  as  a singleton object.  This means that when the object is created, it will
       remain accessible for the duration of the process.  This can be useful in  persistent  environments  like
       mod_perl  and PersistentPerl, since the object only has to be created one time, and will remain in memory
       across multiple requests.  It can also be useful if you want to setup a DIE  handler,  or  WARN  handler,
       since you will not have access to the $self object.

       To  use this module as a singleton you need to provide all configuration parameters as options to the use
       statement.  The use statement will accept all the same parameters that the log_config method accepts,  so
       see the documentation above for more details.

       When creating the singleton, the log object will be saved in the namespace of the module that created it.
       The singleton will also be inherited by any subclasses of this module.

       NOTE:   Singleton  support  requires  the  Class::ISA module which is not installed automatically by this
       module.

</pre><h4><b>SINGLETON</b> <b>EXAMPLE</b></h4><pre>
         package My::App;

         use base qw(CGI::Application);
         use CGI::Application::Plugin::LogDispatch(
             LOG_DISPATCH_MODULES =&gt; [
               {    module =&gt; 'Log::Dispatch::File',
                      name =&gt; 'messages',
                  filename =&gt; '/tmp/messages.log',
                 min_level =&gt; 'error'
               },
             ],
             APPEND_NEWLINE =&gt; 1,
           );

         }

         sub cgiapp_prerun {
           my $self = shift;

           $self-&gt;log-&gt;debug("Current runmode:  ".$self-&gt;get_current_runmode);
         }

         sub my_runmode {
           my $self = shift;
           my $log  = $self-&gt;log;

           if ($ENV{'REMOTE_USER'}) {
             $log-&gt;info("user ".$ENV{'REMOTE_USER'});
           }

           # etc...
         }

         package My::App::Subclass;

         use base qw(My::App);

         # Setup a die handler that uses the logger
         $SIG{__DIE__} = sub { My::App::Subclass-&gt;log-&gt;emerg(@_); CORE::die(@_); };

         sub my_other_runmode {
           my $self = shift;

           $self-&gt;log-&gt;info("This will log to the logger configured in My::App");
         }

</pre><h4><b>BUGS</b></h4><pre>
       Please report any bugs or feature requests  to  "<a href="mailto:bug-cgi-application-plugin-logdispatch@rt.cpan.org">bug-cgi-application-plugin-logdispatch@rt.cpan.org</a>",  or
       through  the web interface at &lt;<a href="http://rt.cpan.org">http://rt.cpan.org</a>&gt;.  I will be notified, and then you'll automatically be
       notified of progress on your bug as I make changes.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       CGI::Application, Log::Dispatch, Log::Dispatch::Screen, Sub::WrapPackages, <b><a href="../man1/perl.1.html">perl</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
       Cees Hek &lt;<a href="mailto:ceeshek@gmail.com">ceeshek@gmail.com</a>&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       Copyright (C) 2004 Cees Hek &lt;<a href="mailto:ceeshek@gmail.com">ceeshek@gmail.com</a>&gt;

       This library is free software. You can modify and or distribute it under the same terms as Perl itself.

perl v5.34.0                                       2022-06-09              <u>CGI::Applicati...in::<a href="../man3pm/LogDispatch.3pm.html">LogDispatch</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>