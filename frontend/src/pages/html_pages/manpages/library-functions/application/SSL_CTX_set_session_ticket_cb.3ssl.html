<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_set_session_ticket_cb, SSL_SESSION_get0_ticket_appdata, SSL_SESSION_set1_ticket_appdata,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_set_session_ticket_cb, SSL_SESSION_get0_ticket_appdata, SSL_SESSION_set1_ticket_appdata,
       SSL_CTX_generate_session_ticket_fn, SSL_CTX_decrypt_session_ticket_fn - manage session ticket application
       data

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        typedef int (*SSL_CTX_generate_session_ticket_fn)(SSL *s, void *arg);
        typedef SSL_TICKET_RETURN (*SSL_CTX_decrypt_session_ticket_fn)(SSL *s, SSL_SESSION *ss,
                                                                       const unsigned char *keyname,
                                                                       size_t keyname_len,
                                                                       SSL_TICKET_STATUS status,
                                                                       void *arg);
        int SSL_CTX_set_session_ticket_cb(SSL_CTX *ctx,
                                          SSL_CTX_generate_session_ticket_fn gen_cb,
                                          SSL_CTX_decrypt_session_ticket_fn dec_cb,
                                          void *arg);
        int SSL_SESSION_set1_ticket_appdata(SSL_SESSION *ss, const void *data, size_t len);
        int SSL_SESSION_get0_ticket_appdata(SSL_SESSION *ss, void **data, size_t *len);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_CTX_set_set_session_ticket_cb()</b> sets the application callbacks <b>gen_cb</b> and <b>dec_cb</b> that are used by a
       server to set and get application data stored with a session, and placed into a session ticket. Either
       callback function may be set to NULL. The value of <b>arg</b> is passed to the callbacks.

       <b>gen_cb</b> is the application defined callback invoked when a session ticket is about to be created. The
       application can call <b>SSL_SESSION_set1_ticket_appdata()</b> at this time to add application data to the
       session ticket. The value of <b>arg</b> is the same as that given to <b>SSL_CTX_set_session_ticket_cb()</b>. The <b>gen_cb</b>
       callback is defined as type <b>SSL_CTX_generate_session_ticket_fn</b>.

       <b>dec_cb</b> is the application defined callback invoked after session ticket decryption has been attempted and
       any session ticket application data is available. If ticket decryption was successful then the <b>ss</b>
       argument contains the session data. The <b>keyname</b> and <b>keyname_len</b> arguments identify the key used to
       decrypt the session ticket. The <b>status</b> argument is the result of the ticket decryption. See the "NOTES"
       section below for further details. The value of <b>arg</b> is the same as that given to
       <b>SSL_CTX_set_session_ticket_cb()</b>. The <b>dec_cb</b> callback is defined as type
       <b>SSL_CTX_decrypt_session_ticket_fn</b>.

       <b>SSL_SESSION_set1_ticket_appdata()</b> sets the application data specified by <b>data</b> and <b>len</b> into <b>ss</b> which is
       then placed into any generated session tickets. It can be called at any time before a session ticket is
       created to update the data placed into the session ticket. However, given that sessions and tickets are
       created by the handshake, the <b>gen_cb</b> is provided to notify the application that a session ticket is about
       to be generated.

       <b>SSL_SESSION_get0_ticket_appdata()</b> assigns <b>data</b> to the session ticket application data and assigns <b>len</b> to
       the length of the session ticket application data from <b>ss</b>. The application data can be set via
       <b>SSL_SESSION_set1_ticket_appdata()</b> or by a session ticket. NULL will be assigned to <b>data</b> and 0 will be
       assigned to <b>len</b> if there is no session ticket application data. <b>SSL_SESSION_get0_ticket_appdata()</b> can be
       called any time after a session has been created. The <b>dec_cb</b> is provided to notify the application that a
       session ticket has just been decrypted.

</pre><h4><b>NOTES</b></h4><pre>
       When the <b>dec_cb</b> callback is invoked, the SSL_SESSION <b>ss</b> has not yet been assigned to the SSL <b>s</b>. The
       <b>status</b> indicates the result of the ticket decryption. The callback must check the <b>status</b> value before
       performing any action, as it is called even if ticket decryption fails.

       The <b>keyname</b> and <b>keyname_len</b> arguments to <b>dec_cb</b> may be used to identify the key that was used to encrypt
       the session ticket.

       The <b>status</b> argument can be any of these values:

       SSL_TICKET_EMPTY
           Empty ticket present. No ticket data will be used and a new ticket should be sent to the client. This
           only occurs in TLSv1.2 or below. In TLSv1.3 it is not valid for a client to send an empty ticket.

       SSL_TICKET_NO_DECRYPT
           The  ticket couldn't be decrypted. No ticket data will be used and a new ticket should be sent to the
           client.

       SSL_TICKET_SUCCESS
           A ticket was successfully decrypted, any session ticket application data should be available.  A  new
           ticket should not be sent to the client.

       SSL_TICKET_SUCCESS_RENEW
           Same as <b>SSL_TICKET_SUCCESS</b>, but a new ticket should be sent to the client.

       The return value can be any of these values:

       SSL_TICKET_RETURN_ABORT
           The  handshake  should be aborted, either because of an error or because of some policy. Note that in
           TLSv1.3 a client may send more than one ticket in a single handshake.  Therefore,  just  because  one
           ticket  is  unacceptable it does not mean that all of them are. For this reason this option should be
           used with caution.

       SSL_TICKET_RETURN_IGNORE
           Do not use a ticket (if one was available). Do not send a renewed ticket to the client.

       SSL_TICKET_RETURN_IGNORE_RENEW
           Do not use a ticket (if one was available). Send a renewed ticket to the client.

           If the callback does not wish to change the default ticket behaviour then it should return this value
           if <b>status</b> is <b>SSL_TICKET_EMPTY</b> or <b>SSL_TICKET_NO_DECRYPT</b>.

       SSL_TICKET_RETURN_USE
           Use the ticket. Do not send a renewed ticket to the client. It is an error for the callback to return
           this value if <b>status</b> has a value other than <b>SSL_TICKET_SUCCESS</b> or <b>SSL_TICKET_SUCCESS_RENEW</b>.

           If the callback does not wish to change the default ticket behaviour then it should return this value
           if <b>status</b> is <b>SSL_TICKET_SUCCESS</b>.

       SSL_TICKET_RETURN_USE_RENEW
           Use the ticket. Send a renewed ticket to the client. It is an error for the callback to  return  this
           value if <b>status</b> has a value other than <b>SSL_TICKET_SUCCESS</b> or <b>SSL_TICKET_SUCCESS_RENEW</b>.

           If the callback does not wish to change the default ticket behaviour then it should return this value
           if <b>status</b> is <b>SSL_TICKET_SUCCESS_RENEW</b>.

       If  <b>status</b> has the value <b>SSL_TICKET_EMPTY</b> or <b>SSL_TICKET_NO_DECRYPT</b> then no session data will be available
       and the callback  must  not  use  the  <b>ss</b>  argument.  If  <b>status</b>  has  the  value  <b>SSL_TICKET_SUCCESS</b>  or
       <b>SSL_TICKET_SUCCESS_RENEW</b>  then  the  application  can  call  <b>SSL_SESSION_get0_ticket_appdata()</b>  using the
       session provided in the <b>ss</b> argument to retrieve the application data.

       When the <b>gen_cb</b> callback is  invoked,  the  <b>SSL_get_session()</b>  function  can  be  used  to  retrieve  the
       SSL_SESSION for <b>SSL_SESSION_set1_ticket_appdata()</b>.

       By  default,  in  TLSv1.2  and  below,  a new session ticket is not issued on a successful resumption and
       therefore <b>gen_cb</b> will not be called. In TLSv1.3 the default behaviour is to always issue a new ticket  on
       resumption.  In  both  cases  this  behaviour  can  be  changed  if  a ticket key callback is in use (see
       <b><a href="../man3/SSL_CTX_set_tlsext_ticket_key_cb.3.html">SSL_CTX_set_tlsext_ticket_key_cb</a></b>(3)).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The           <b>SSL_CTX_set_session_ticket_cb()</b>,           <b>SSL_SESSION_set1_ticket_appdata()</b>            and
       <b>SSL_SESSION_get0_ticket_appdata()</b> functions return 1 on success and 0 on failure.

       The <b>gen_cb</b> callback must return 1 to continue the connection. A return of 0 will terminate the connection
       with an INTERNAL_ERROR alert.

       The <b>dec_cb</b> callback must return a value as described in "NOTES" above.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_get_session.3.html">SSL_get_session</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The            <b>SSL_CTX_set_session_ticket_cb()</b>,           <b>SSL_SESSION_set1_ticket_appdata()</b>           and
       <b>SSL_SESSION_get_ticket_appdata()</b> functions were added in OpenSSL 1.1.1.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2017-2020 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                <u><a href="../man3SSL/SSL_CTX_SET_SESSION_TICKET_CB.3SSL.html">SSL_CTX_SET_SESSION_TICKET_CB</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>