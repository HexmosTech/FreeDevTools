<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::SSH2::File - SSH2 SFTP file object</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-ssh2-perl">libnet-ssh2-perl_0.74-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::SSH2::File - SSH2 SFTP file object

</pre><h4><b>DESCRIPTION</b></h4><pre>
       An SFTP file object is created by the Net::SSH2::SFTP "open" method.

   <b>read</b> <b>(</b> <b>buffer,</b> <b>size</b> <b>)</b>
       Read size bytes from the file into a given buffer.  Returns number of bytes read, or undef on failure.

   <b>write</b> <b>(</b> <b>buffer</b> <b>)</b>
       Write buffer to the remote file.

       The "libssh2_sftp_write" function wrapped by this method has a complex and quite difficult (if not
       impossible at all) to use API. It tries to hide the packet pipelining being done under the hood in order
       to attain decent throughput.

       Net::SSH2 can not hide that complexity without negatively affecting the transmission speed so it provides
       just a thin wrapper for that library function.

       An excerpt from "libssh2_sftp_write" manual page follows:

         WRITE AHEAD

         Starting in libssh2 version 1.2.8, the default behavior of libssh2
         is to create several smaller outgoing packets for all data you pass
         to this function and it will return a positive number as soon as the
         first packet is acknowledged from the server.

         This has the effect that sometimes more data has been sent off but
         isn't acked yet when this function returns, and when this function
         is subsequently called again to write more data, libssh2 will
         immediately figure out that the data is already received remotely.

         In most normal situation this should  not cause any problems, but it
         should be noted that if you've once called libssh2_sftp_write() with
         data and  it returns short, you  MUST still assume that  the rest of
         the data  might've been cached  so you need  to make sure  you don't
         alter that  data and think  that the version  you have in  your next
         function invoke will be detected or used.

         The reason  for this funny behavior  is that SFTP can  only send 32K
         data in each packet and it gets all packets acked individually. This
         means we  cannot use a  simple serial approach  if we want  to reach
         high performance even on high latency connections. And we want that.

       This is an example of simple file uploading

           use constant BUF_SIZE =&gt; 128*1024;

           my $sftp = $ssh2-&gt;sftp;
           open my $fh, '&lt;', '/tmp/doc.txt';
           my $sf = $sftp-&gt;open('doc.txt', O_CREAT|O_WRONLY|O_TRUNC);

           my $buf;
           while (sysread($fh, $buf, BUF_SIZE)) {
               while (length $buf) {
                   my $rc = $sf-&gt;write($buf);
                   if (!defined($rc)) {
                       $sftp-&gt;die_with_error('write error');
                   }
                   # Remove transferred data from the buffer.
                   substr($buf, 0, $rc) = '';
               }
           }

   <b>stat</b>
       Returns file attributes; see Net::SSH2::SFTP::stat.

   <b>setstat</b> <b>(</b> <b>key,</b> <b>value...</b> <b>)</b>
       Sets file attributes; see Net::SSH2::SFTP::setstat.

   <b>seek</b> <b>(</b> <b>offset</b> <b>)</b>
       Set the file pointer offset.

   <b>tell</b>
       Returns the current file pointer offset.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Net::SSH2::SFTP.

       Check Net::SFTP::Foreign for a high level, perlish and easy to use SFTP client module. It can work on top
       of Net::SSH2 via the Net::SFTP::Foreign::Backend::Net_SSH2 backend module.

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       Copyright (C) 2005, 2006 by David B. Robins &lt;<a href="mailto:dbrobins@cpan.org">dbrobins@cpan.org</a>&gt;;

       Copyright (C) 2015 by Salvador Fandi√±o &lt;<a href="mailto:sfandino@yahoo.com">sfandino@yahoo.com</a>&gt;;

       All rights reserved.

       This library is free software; you can redistribute it and/or modify it under the same terms as Perl
       itself, either Perl version 5.8.0 or, at your option, any later version of Perl 5 you may have available.

       The documentation for this package contains and excerpt from libssh2 manual pages. You can consult the
       license of the libssh2 project for the conditions regulating the copyright of that part.

perl v5.40.0                                       2024-09-07                               <u>Net::SSH2::<a href="../man3pm/File.3pm.html">File</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>