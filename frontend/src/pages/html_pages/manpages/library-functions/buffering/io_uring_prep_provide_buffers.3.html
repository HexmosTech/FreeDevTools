<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>io_uring_prep_provide_buffers - prepare a provide buffers request</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/liburing-dev">liburing-dev_2.9-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       io_uring_prep_provide_buffers - prepare a provide buffers request

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;liburing.h&gt;</b>

       <b>void</b> <b>io_uring_prep_provide_buffers(struct</b> <b>io_uring_sqe</b> <b>*</b><u>sqe</u><b>,</b>
                                          <b>void</b> <b>*</b><u>addr</u><b>,</b>
                                          <b>int</b> <u>len</u><b>,</b>
                                          <b>int</b> <u>nr</u><b>,</b>
                                          <b>int</b> <u>bgid</u><b>,</b>
                                          <b>int</b> <u>bid</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b><a href="../man3/io_uring_prep_provide_buffers.3.html">io_uring_prep_provide_buffers</a></b>(3)  function prepares a request for providing the kernel with buffers.
       The submission queue entry <u>sqe</u> is setup to consume <u>nr</u> number of <u>len</u> sized buffers starting  at  <u>addr</u>  and
       identified by the buffer group ID of <u>bgid</u> and numbered sequentially starting at <u>bid</u>.

       This  function  sets  up a request to provide buffers to the io_uring context that can be used by read or
       receive operations. This is done by filling in the SQE <u>buf_group</u> field and setting <b>IOSQE_BUFFER_SELECT</b> in
       the SQE <u>flags</u> member. If buffer selection is used for a request, no buffer  should  be  provided  in  the
       address  field. Instead, the group ID is set to match one that was previously provided to the kernel. The
       kernel will then select a buffer from this group for the IO operation. On successful completion of the IO
       request, the CQE <u>flags</u> field will have <b>IORING_CQE_F_BUFFER</b>  set  and  the  selected  buffer  ID  will  be
       indicated by the upper 16-bits of the <u>flags</u> field.

       Different  buffer  group  IDs  can be used by the application to have different sizes or types of buffers
       available. Once a buffer has been consumed for an operation, it is no longer known to io_uring.  It  must
       be re-provided if so desired or freed by the application if no longer needed.

       The  buffer IDs are internally tracked from <u>bid</u> and sequentially ascending from that value. If <b>16</b> buffers
       are provided and start with an initial <u>bid</u> of 0,  then  the  buffer  IDs  will  range  from  <b>0..15</b>.   The
       application must be aware of this to make sense of the buffer ID passed back in the CQE.

       Buffer  IDs  always  range  from <b>0</b> to <b>65535</b> <b>,</b> as there are only 16-bits available in the CQE to pass them
       back. This range is independent of how the buffer group initially got created. Attempting to  add  buffer
       IDs larger than that, or buffer IDs that will wrap when cast to a 16-bit value, will cause the request to
       fail with <b>-E2BIG</b> or <b>-EINVAL</b> <b>.</b>

       Not  all  requests support buffer selection, as it only really makes sense for requests that receive data
       from the kernel rather than write or provide data.  Currently, this mode of operation  is  supported  for
       any  file  read  or  socket  receive  request.  Attempting to use <b>IOSQE_BUFFER_SELECT</b> with a command that
       doesn't support it will result in a CQE <u>res</u> error of <b>-EINVAL</b>.  Buffer selection will work with operations
       that take a <b>struct</b> <b>iovec</b> as its data destination, but only if 1 iovec is provided.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       None

</pre><h4><b>ERRORS</b></h4><pre>
       These are the errors that are reported in the CQE <u>res</u> field. On success, <u>res</u> will contain <b>0</b> or the number
       of successfully provided buffers.

       <b>-ENOMEM</b>
              The kernel was unable to allocate memory for the request.

       <b>-EINVAL</b>
              One of the fields set in the SQE was invalid.

       <b>-E2BIG</b> The number of buffers provided was too big, or the <u>bid</u> was too  big.  A  max  value  of  <b>USHRT_MAX</b>
              buffers can be specified.

       <b>-EFAULT</b>
              Some of the user memory given was invalid for the application.

       <b>-EOVERFLOW</b>
              The product of <u>len</u> and <u>nr</u> exceed the valid amount or overflowed, or the sum of <u>addr</u> and the length
              of buffers overflowed.

       <b>-EBUSY</b> Attempt to update a slot that is already used.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/io_uring_get_sqe.3.html">io_uring_get_sqe</a></b>(3), <b><a href="../man3/io_uring_submit.3.html">io_uring_submit</a></b>(3), <b><a href="../man2/io_uring_register.2.html">io_uring_register</a></b>(2), <b><a href="../man3/io_uring_prep_remove_buffers.3.html">io_uring_prep_remove_buffers</a></b>(3)

liburing-2.2                                     March 13, 2022                 <u><a href="../man3/io_uring_prep_provide_buffers.3.html">io_uring_prep_provide_buffers</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>