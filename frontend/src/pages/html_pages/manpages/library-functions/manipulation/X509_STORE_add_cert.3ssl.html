<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X509_STORE, X509_STORE_add_cert, X509_STORE_add_crl, X509_STORE_set_depth, X509_STORE_set_flags,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       X509_STORE, X509_STORE_add_cert, X509_STORE_add_crl, X509_STORE_set_depth, X509_STORE_set_flags,
       X509_STORE_set_purpose, X509_STORE_set_trust, X509_STORE_add_lookup, X509_STORE_load_file_ex,
       X509_STORE_load_file, X509_STORE_load_path, X509_STORE_load_store_ex, X509_STORE_load_store,
       X509_STORE_set_default_paths_ex, X509_STORE_set_default_paths, X509_STORE_load_locations_ex,
       X509_STORE_load_locations - X509_STORE manipulation

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/x509_vfy.h&gt;

        typedef x509_store_st X509_STORE;

        int X509_STORE_add_cert(X509_STORE *xs, X509 *x);
        int X509_STORE_add_crl(X509_STORE *xs, X509_CRL *x);
        int X509_STORE_set_depth(X509_STORE *store, int depth);
        int X509_STORE_set_flags(X509_STORE *xs, unsigned long flags);
        int X509_STORE_set_purpose(X509_STORE *xs, int purpose);
        int X509_STORE_set_trust(X509_STORE *xs, int trust);

        X509_LOOKUP *X509_STORE_add_lookup(X509_STORE *store,
                                           X509_LOOKUP_METHOD *meth);

        int X509_STORE_set_default_paths_ex(X509_STORE *xs, OSSL_LIB_CTX *libctx,
                                            const char *propq);
        int X509_STORE_set_default_paths(X509_STORE *xs);
        int X509_STORE_load_file_ex(X509_STORE *xs, const char *file,
                                    OSSL_LIB_CTX *libctx, const char *propq);
        int X509_STORE_load_file(X509_STORE *xs, const char *file);
        int X509_STORE_load_path(X509_STORE *xs, const char *dir);
        int X509_STORE_load_store_ex(X509_STORE *xs, const char *uri,
                                     OSSL_LIB_CTX *libctx, const char *propq);
        int X509_STORE_load_store(X509_STORE *xs, const char *uri);
        int X509_STORE_load_locations_ex(X509_STORE *xs, const char *file,
                                         const char *dir, OSSL_LIB_CTX *libctx,
                                         const char *propq);
        int X509_STORE_load_locations(X509_STORE *xs,
                                      const char *file, const char *dir);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>X509_STORE</b> structure is intended to be a consolidated mechanism for holding information about X.509
       certificates and CRLs, and constructing and validating chains of certificates terminating in trusted
       roots.  It admits multiple lookup mechanisms and efficient scaling performance with large numbers of
       certificates, and a great deal of flexibility in how validation and policy checks are performed.

       Details of the chain building and checking process are described in "Certification Path Building" in
       <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1) and "Certification Path Validation" in <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1).

       <b><a href="../man3/X509_STORE_new.3.html">X509_STORE_new</a></b>(3) creates an empty <b>X509_STORE</b> structure, which contains no information about trusted
       certificates or where such certificates are located on disk, and is generally not usable.  Normally,
       trusted certificates will be added to the <b>X509_STORE</b> to prepare it for use, via mechanisms such as
       <b>X509_STORE_add_lookup()</b> and <b>X509_LOOKUP_file()</b>, or <b>PEM_read_bio_X509_AUX()</b> and <b>X509_STORE_add_cert()</b>.
       CRLs can also be added, and many behaviors configured as desired.

       Once the <b>X509_STORE</b> is suitably configured, <b>X509_STORE_CTX_new()</b> is used to instantiate a single-use
       <b>X509_STORE_CTX</b> for each chain-building and verification operation.  That process includes providing the
       end-entity certificate to be verified and an additional set of untrusted certificates that may be used in
       chain-building.  As such, it is expected that the certificates included in the <b>X509_STORE</b> are
       certificates that represent trusted entities such as root certificate authorities (CAs).  OpenSSL
       represents these trusted certificates internally as <b>X509</b> objects with an associated <b>X509_CERT_AUX</b>, as are
       produced by <b>PEM_read_bio_X509_AUX()</b> and similar routines that refer to X509_AUX.  The public interfaces
       that operate on such trusted certificates still operate on pointers to <b>X509</b> objects, though.

       <b>X509_STORE_add_cert()</b> and <b>X509_STORE_add_crl()</b> add the respective object to the <b>X509_STORE</b>'s local
       storage.  Untrusted objects should not be added in this way.  The added object's reference count is
       incremented by one, hence the caller retains ownership of the object and needs to free it when it is no
       longer needed.

       <b>X509_STORE_set_depth()</b>, <b>X509_STORE_set_flags()</b>, <b>X509_STORE_set_purpose()</b>, <b>X509_STORE_set_trust()</b>, and
       <b>X509_STORE_set1_param()</b> set the default values for the corresponding values used in certificate chain
       validation.  Their behavior is documented in the corresponding <b>X509_VERIFY_PARAM</b> manual pages, e.g.,
       <b><a href="../man3/X509_VERIFY_PARAM_set_depth.3.html">X509_VERIFY_PARAM_set_depth</a></b>(3). The <b>X509_STORE</b> <b>MUST</b> <b>NOT</b> be NULL.

       <b>X509_STORE_add_lookup()</b> finds or creates a <b><a href="../man3/X509_LOOKUP.3.html">X509_LOOKUP</a></b>(3) with the <b><a href="../man3/X509_LOOKUP_METHOD.3.html">X509_LOOKUP_METHOD</a></b>(3) <u>meth</u> and adds it
       to the <b>X509_STORE</b> <u>store</u>.  This also associates the <b>X509_STORE</b> with the lookup, so <b>X509_LOOKUP</b> functions
       can look up objects in that store.

       <b>X509_STORE_load_file_ex()</b> loads trusted certificate(s) into an <b>X509_STORE</b> from a given file. The library
       context <u>libctx</u> and property query <u>propq</u> are used when fetching algorithms from providers.

       <b>X509_STORE_load_file()</b> is similar to <b>X509_STORE_load_file_ex()</b> but uses NULL for the library context
       <u>libctx</u> and property query <u>propq</u>.

       <b>X509_STORE_load_path()</b> loads trusted certificate(s) into an <b>X509_STORE</b> from a given directory path.  The
       certificates in the directory must be in hashed form, as documented in <b><a href="../man3/X509_LOOKUP_hash_dir.3.html">X509_LOOKUP_hash_dir</a></b>(3).

       <b>X509_STORE_load_store_ex()</b> loads trusted certificate(s) into an <b>X509_STORE</b> from a store at a given URI.
       The library context <u>libctx</u> and property query <u>propq</u> are used when fetching algorithms from providers.

       <b>X509_STORE_load_store()</b> is similar to <b>X509_STORE_load_store_ex()</b> but uses NULL for the library context
       <u>libctx</u> and property query <u>propq</u>.

       <b>X509_STORE_load_locations_ex()</b> combines <b>X509_STORE_load_file_ex()</b> and <b>X509_STORE_load_path()</b> for a given
       file and/or directory path.  It is permitted to specify just a file, just a directory, or both paths.

       <b>X509_STORE_load_locations()</b> is similar to <b>X509_STORE_load_locations_ex()</b> but uses NULL for the library
       context <u>libctx</u> and property query <u>propq</u>.

       <b>X509_STORE_set_default_paths_ex()</b> is somewhat misnamed, in that it does not set what default paths should
       be used for loading certificates.  Instead, it loads certificates into the <b>X509_STORE</b> from the hardcoded
       default paths. The library context <u>libctx</u> and property query <u>propq</u> are used when fetching algorithms from
       providers.

       <b>X509_STORE_set_default_paths()</b> is similar to <b>X509_STORE_set_default_paths_ex()</b> but uses NULL for the
       library context <u>libctx</u> and property query <u>propq</u>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>X509_STORE_add_cert()</b>, <b>X509_STORE_add_crl()</b>, <b>X509_STORE_set_depth()</b>, <b>X509_STORE_set_flags()</b>,
       <b>X509_STORE_set_purpose()</b>, <b>X509_STORE_set_trust()</b>, <b>X509_STORE_load_file_ex()</b>, <b>X509_STORE_load_file()</b>,
       <b>X509_STORE_load_path()</b>, <b>X509_STORE_load_store_ex()</b>, <b>X509_STORE_load_store()</b>,
       <b>X509_STORE_load_locations_ex()</b>, <b>X509_STORE_load_locations()</b>, <b>X509_STORE_set_default_paths_ex()</b> and
       <b>X509_STORE_set_default_paths()</b> return 1 on success or 0 on failure.

       <b>X509_STORE_add_lookup()</b> returns the found or created <b><a href="../man3/X509_LOOKUP.3.html">X509_LOOKUP</a></b>(3), or NULL on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/X509_LOOKUP_hash_dir.3.html">X509_LOOKUP_hash_dir</a></b>(3).  <b><a href="../man3/X509_VERIFY_PARAM_set_depth.3.html">X509_VERIFY_PARAM_set_depth</a></b>(3).  <b><a href="../man3/X509_STORE_new.3.html">X509_STORE_new</a></b>(3), <b><a href="../man3/X509_STORE_get0_param.3.html">X509_STORE_get0_param</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The functions <b>X509_STORE_set_default_paths_ex()</b>, <b>X509_STORE_load_file_ex()</b>, <b>X509_STORE_load_store_ex()</b>
       and <b>X509_STORE_load_locations_ex()</b> were added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2017-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                          <u><a href="../man3SSL/X509_STORE_ADD_CERT.3SSL.html">X509_STORE_ADD_CERT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>