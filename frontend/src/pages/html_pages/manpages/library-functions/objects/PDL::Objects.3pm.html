<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDL::Objects -- Object-orientation, what it is and how to exploit it</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/pdl">pdl_2.100-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       PDL::Objects -- Object-orientation, what it is and how to exploit it

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This describes how to subclass PDL objects for fun and profit.

   <b>Why</b> <b>subclass?</b>
       There are basically two reasons for subclassing ndarrays.  The first is simply that you want to be able
       to use your own routines like

         $ndarray-&gt;something

       but don't want to mess up the PDL namespace (a worthy goal, indeed!).  The other is that you wish to
       provide special handling of some functions or more information about the data the ndarray contains.  The
       first case you can do with

         package BAR;
         our @ISA=qw/PDL/;
         sub foo {my($this) = @_; fiddle;}

         package main;
         $x = BAR-&gt;<a href="../man5/pdl.5.html">pdl</a>(5);
         $x-&gt;foo;

       However, because a PDL object is an opaque reference to a C struct, it is not instantly possible to
       extend the PDL class by e.g. extra data via subclassing.

   <b>Perl</b> <b>values</b> <b>into</b> <b>underlying</b> <b>C</b> <b>values</b>
       "typemap"s turns Perl values into the C entities needed by the C code. PDL's one uses "SvPDLV" to extract
       a "pdl*" from a Perl value. That knows how to deal with:

       •   "simple" blessed scalars that have a C pointer

       •   blessed hash-refs that have a "PDL" member that's a C pointer as above

       •   blessed  hash-refs  that  have  a  "PDL"  member  that's  a Perl code-ref.  It will be called, and is
           expected to return an ndarray that conforms to one of cases 1-2  or  4-5  above.  As  of  2.094,  the
           original  hash-ref  will  be  passed as the first argument. This means you can give a method as shown
           below, rather than needing to make a closure each time.  Example from <u>t/subclass.t</u>:

             package PDL::Derived2;
             # This is a array of ones of dim 'Coeff'
             # All that is stored initially is "Coeff", the
             # PDL array is only realised when a boring PDL
             # function is called on it. One can imagine methods
             # in PDL::Derived2 doing manipulation on the Coeffs
             # rather than actualizing the data.
             our @ISA = qw/PDL/;
             sub new {
               my $class = shift;
               bless {
                 Coeff=&gt;shift,
                 PDL=&gt;\&amp;cache,
                 SomethingElse=&gt;42,
               }, $class;
             }
             # Actualize the value (demonstrating cacheing)
             # One can imagine expiring the cache if say, Coeffs change
             sub cache {
               my $self = shift;
               return $self-&gt;{Cache} if exists $self-&gt;{Cache};
               $self-&gt;{Cache} = PDL-&gt;ones(@$self{qw(Coeff Coeff)})+2;
             }

       •   "simple" Perl data, either a scalar or an array-reference

       •   blessed hash-refs that are a Math::Complex (or subclass) object - special case of the "scalar" above

       The rest of this document deals with the second case above.

   <b>Inheritance</b>
       To enable subclassing, make a package and bless a hash-ref into it with a "PDL" member. Make that package
       inherit from "PDL", and redefine the method "initialize".

         package FOO;
         our ISA = qw(PDL::Hash);
         sub initialize {
           my $class = shift;
           my $self = $class-&gt;SUPER::initialize(@_);
           $self-&gt;{creation_time} = time(); # necessary extension :-)
           $self;
         }

       All PDL constructors will call <b>initialize()</b> to make sure that  your  extensions  are  added  by  <u>all</u>  PDL
       constructors automatically.

       Do  remember  that  if  you  subclass  a  class  that  is  subclassed  from  an ndarray, you need to call
       "SUPER::initialize". Make sure it is callable as an instance method, e.g. by copying data from $class  if
       ref $class is true.

   <b>Examples</b>
       You  can  find  some  simple examples of PDL subclassing in the PDL distribution test-case files. Look in
       <u>t/subclass.t</u>.

   <b>Output</b> <b>Auto-Creation</b> <b>and</b> <b>Subclassed</b> <b>Objects</b>
       For PDL Functions where the output is created  and  returned,  PDL  will  call  the  subclassed  object's
       "initialize"  method  on  either  instance or class to create the output object. (See PDL::Indexing for a
       discussion on Output Auto-Creation.) This behavior is summarized as follows:

       PDL will call "initialize" on the first input argument if it is an object, else on "PDL"  to  create  the
       output  object.   In  the spirit of the Perl philosophy of making <u>Easy</u> <u>Things</u> <u>Easy</u>, this behavior enables
       PDL-subclassed objects to be written without having to overload the many simple  PDL  functions  in  this
       category.

</pre><h4><b>AUTHOR</b></h4><pre>
       Copyright  (C)  Karl  Glazebrook  (<a href="mailto:kgb@aaoepp.aao.gov.au">kgb@aaoepp.aao.gov.au</a>),  Tuomas J. Lukka, (<a href="mailto:lukka@husc.harvard.edu">lukka@husc.harvard.edu</a>) and
       Christian Soeller (<a href="mailto:c.soeller@auckland.ac.nz">c.soeller@auckland.ac.nz</a>) 2000.  All rights reserved. There is no  warranty.  You  are
       allowed to copy this on the same terms as Perl itself.

perl v5.40.1                                       2025-03-27                                  <u>PDL::<a href="../man3pm/Objects.3pm.html">Objects</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>