<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aa_features - an opaque object representing a set of AppArmor kernel features</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libapparmor-dev">libapparmor-dev_4.1.1-0ubuntu6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       aa_features - an opaque object representing a set of AppArmor kernel features

       aa_features_new - create a new aa_features object based on a path

       aa_features_new_from_string - create a new aa_features object based on a string

       aa_features_new_from_kernel - create a new aa_features object based on the current kernel

       aa_features_ref - increments the ref count of an aa_features object

       aa_features_unref - decrements the ref count and frees the aa_features object when 0

       aa_features_write_to_fd - write a string representation of an aa_features object to a file descriptor

       aa_features_write_to_file - write a string representation of an aa_features object to a file

       aa_features_is_equal - equality test for two aa_features objects

       aa_features_supports - provides aa_features object support status

       aa_features_id - provides unique identifier for an aa_features object

       aa_features_value - the value associated with a given feature.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/apparmor.h&gt;</b>

       <b>typedef</b> <b>struct</b> <b>aa_features</b> <b>aa_features;</b>

       <b>int</b> <b>aa_features_new(aa_features</b> <b>**features,</b> <b>int</b> <b>dirfd,</b> <b>const</b> <b>char</b> <b>*path);</b>

       <b>int</b> <b>aa_features_new_from_file(aa_features</b> <b>**features,</b> <b>int</b> <b>fd);</b>

       <b>int</b> <b>aa_features_new_from_string(aa_features</b> <b>**features,</b> <b>const</b> <b>char</b> <b>*string,</b> <b>size_t</b> <b>size);</b>

       <b>int</b> <b>aa_features_new_from_kernel(aa_features</b> <b>**features);</b>

       <b>aa_features</b> <b>*aa_features_ref(aa_features</b> <b>*features);</b>

       <b>void</b> <b>aa_features_unref(aa_features</b> <b>*features);</b>

       <b>int</b> <b>aa_features_write_to_fd(aa_features</b> <b>*features,</b> <b>int</b> <b>fd);</b>

       <b>int</b> <b>aa_features_write_to_file(aa_features</b> <b>*features,</b> <b>int</b> <b>dirfd,</b> <b>const</b> <b>char</b> <b>*path);</b>

       <b>bool</b> <b>aa_features_is_equal(aa_features</b> <b>*features1,</b> <b>aa_features</b> <b>*features2);</b>

       <b>bool</b> <b>aa_features_supports(aa_features</b> <b>*features,</b> <b>const</b> <b>char</b> <b>*str);</b>

       <b>char</b> <b>*aa_features_id(aa_features</b> <b>*features);</b>

       <b>char</b> <b>*aa_features_value(aa_features</b> <b>*features,</b> <b>const</b> <b>char</b> <b>*str,</b> <b>size_t</b> <b>*len);</b>

       Link with <b>-lapparmor</b> when compiling.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <u>aa_features</u> object contains information about the AppArmor features supported by a kernel. The
       feature support information is based upon the files AppArmor represents in securityfs, which is typically
       found at <a href="file:/sys/kernel/security/apparmor/features/.">/sys/kernel/security/apparmor/features/.</a> That information may be parsed and turned into a string
       or flat file in order to represent a set of features of a kernel that is not currently running.

       The <b>aa_features_new()</b> function creates an <u>aa_features</u> object based upon a directory file descriptor and
       path. The <u>path</u> can point to a file or directory. See the <b><a href="../man2/openat.2.html">openat</a></b>(2) man page for examples of <u>dirfd</u> and
       <u>path</u>. The allocated <u>features</u> object must be freed using <b>aa_features_unref()</b>.

       The <b>aa_features_new_from_file()</b> function is similar except that it accepts an open file as the argument.
       The allocated <u>features</u> object must be freed using <b>aa_features_unref()</b>.

       The <b>aa_features_new_from_string()</b> function is similar except that it accepts a NUL-terminated string
       representation of the AppArmor features as the <u>string</u> argument. The length of the features string, not
       counting the NUL-terminator, must be specified as the <u>size</u> argument. The allocated <u>features</u> object must
       be freed using <b>aa_features_unref()</b>.

       The <b>aa_features_new_from_kernel()</b> function creates an <u>aa_features</u> object from the current running kernel.
       The allocated <u>features</u> object must be freed using <b>aa_features_unref()</b>.

       <b>aa_features_ref()</b> increments the reference count on the <u>features</u> object.

       <b>aa_features_unref()</b> decrements the reference count on the <u>features</u> object and releases all corresponding
       resources when the reference count reaches zero.

       The <b>aa_features_write_to_fd()</b> function writes a string representation of the <u>features</u> object to the file
       descriptor specified by the <u>fd</u>.

       The <b>aa_features_write_to_file()</b> function writes a string representation of the <u>features</u> object to the
       file specified by the <u>dirfd</u> and <u>path</u> combination.

       <b>aa_features_is_equal()</b> can be used to detect if the <u>features1</u> and <u>features2</u> objects are equal. The
       definition of equality is private to libapparmor and may be changed in ways that do not break backward
       compatibility.

       The <b>aa_features_supports()</b> function can be used to query the <u>features</u> object to determine if a feature is
       supported. The <u>str</u> argument should be equal to the path, relative to the "apparmor/features/" directory
       of securityfs, of the feature to query. For example, to test if policy version 6 is supported, <u>str</u> would
       be "policy/versions/v6".

       The <b>aa_features_id()</b> function returns a string representation of an identifier that can be used to
       uniquely identify an <u>aa_features</u> object.  The mechanism for generating the string representation is
       internal to libapparmor and subject to change but an example implementation is applying a hash function
       to the features string.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>aa_features_new()</b> family of functions return 0 on success and <u>*features</u> will point to an <u>aa_features</u>
       object that must be freed by <b>aa_features_unref()</b>. -1 is returned on error, with errno set appropriately,
       and <u>*features</u> will be set to NULL.

       <b>aa_features_ref()</b> returns the value of <u>features</u>.

       <b>aa_features_write_to_file()</b> returns 0 on success. -1 is returned on error, with errno set appropriately.

       <b>aa_features_is_equal()</b> returns true if <u>features1</u> and <u>features2</u> are equal and false if they are not equal.

       <b>aa_features_supports()</b> returns true if the feature represented by <u>str</u> is supported and false if it is not
       supported.

       <b>aa_features_id()</b> returns a string identifying <u>features</u> which must be freed by the caller. NULL is
       returned on error, with errno set appropriately.

       <b>aa_features_value()</b> returns a null terminated string with is associated length which must be freed by the
       caller. NULL is returned on error, with errno set to ENOENT if the feature was not found, ENODIR if the
       specified feature does not resolve to a leaf feature.

</pre><h4><b>ERRORS</b></h4><pre>
       The errno value will be set according to the underlying error in the <u>aa_features</u> family of functions that
       return -1 or NULL on error.

</pre><h4><b>NOTES</b></h4><pre>
       The <b>aa_features_id()</b> function can be found in libapparmor version 2.13. All the other aa_feature
       functions described above are present in libapparmor version 2.10.

       <b>aa_features_unref()</b> saves the value of errno when called and restores errno before exiting in libapparmor
       version 2.12 and newer.

</pre><h4><b>BUGS</b></h4><pre>
       None known. If you find any, please report them at &lt;https://gitlab.com/apparmor/apparmor/-/issues&gt;.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/openat.2.html">openat</a></b>(2), <b><a href="../man1/aa-features-abi.1.html">aa-features-abi</a></b>(1) and &lt;https://wiki.apparmor.net&gt;.

AppArmor 4.1.1                                     2025-07-23                                     <u><a href="../man3/aa_features.3.html">aa_features</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>