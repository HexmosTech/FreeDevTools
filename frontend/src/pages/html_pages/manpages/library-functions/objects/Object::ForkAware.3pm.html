<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Object::ForkAware - Make an object aware of process forks and threads, recreating itself as needed</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libobject-forkaware-perl">libobject-forkaware-perl_0.005-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Object::ForkAware - Make an object aware of process forks and threads, recreating itself as needed

</pre><h4><b>VERSION</b></h4><pre>
       version 0.005

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Object::ForkAware;
           my $client = Object::ForkAware-&gt;new(
               create =&gt; sub { MyClient-&gt;new(server =&gt; 'foo.com', port =&gt; '1234') },
           );

           # do things with object as normal...
           $client-&gt;send(...);

           # later, we fork for some reason
           if (fork == 0) {
               # child process
               $client-&gt;send(...);
           }

           # no boom happens! fork is detected and client object is regenerated

</pre><h4><b>DESCRIPTION</b></h4><pre>
       If you've ever had an object representing a network connection to some server, or something else
       containing a socket, a filehandle, etc, and used it in a program that forks, and then forgot to close and
       reopen your socket/handle etc in the new process, you'll know what chaos can ensue. Depending on the type
       of connection, you can have multiple processes trying to write to the same resource at once, or
       simultaneous reads getting each other's data, dogs and cats living together... It's horrible, and it's an
       easy problem to run into.

       This module invisibly wraps your object and makes it fork-aware, automatically checking $$ on every
       access and recreating the object if the process id changes.  (The object is also thread-aware; if the
       thread id changes, the object is recreated in the same manner.)

       The object can be safely used with type checks and various type constraint mechanisms, as "isa" and "can"
       respond as if they were being called against the contained object itself.

       You can also ensure that a fork never happens, by making use of the optional "on_fork" handler:

           my $client = Object::ForkAware-&gt;new(
               create =&gt; sub { MyClient-&gt;new(server =&gt; 'foo.com', port =&gt; '1234') },
               on_fork =&gt; sub { die 'fork detected!' },
           );

       Or, if regenerating the object needs to be done differently than the initial creation:

           my $client = Object::ForkAware-&gt;new(
               create =&gt; sub { MyClient-&gt;new(server =&gt; 'foo.com', port =&gt; '1234') },
               on_fork =&gt; sub { MyClient-&gt;new(server =&gt; 'other.foo.com' },
           );

</pre><h4><b>METHODS</b></h4><pre>
   <b>"new(option</b> <b>=&gt;</b> <b>val,</b> <b>option</b> <b>=&gt;</b> <b>val...)"</b>
       Provides an instance of this class.  Available options are:

       •   "create"  (mandatory)  -  a  sub reference containing the code to be run when the object is initially
           created (as well as recreated, if there is no "on_fork" sub provided), returning the object instance.
           If the object previously existed, it is passed as an argument to this method, allowing  you  to  copy
           any state from the old object to the new one.

       •   "on_fork"  -  a sub reference containing the code to be run when a fork is detected. It should either
           generate an exception or return the new object instance.  If the object  previously  existed,  it  is
           passed  as  an argument to this method, allowing you to copy any state from the old object to the new
           one.

       •   "lazy" - a boolean (defaults to false) - when true, the "create" sub is not called  immediately,  but
           instead deferred until the first time the object is used. This prevents useless object creation if it
           is not likely to be used until after the first fork.

       There  are  no  other  public  methods.  All  method  calls  on  the object will be passed through to the
       containing object, after checking $$ (or "threads-&gt;tid") and  possibly  recreating  the  object  via  the
       provided "create" (or "on_fork") sub.

</pre><h4><b>LIMITATIONS</b></h4><pre>
       Using  the  Object::ForkAware  object with an operator that the containing object has overloaded will not
       work; behaviour is as if there was no operator overloading.  Partial support is possible, but is not  yet
       implemented.

</pre><h4><b>ACKNOWLEDGEMENTS</b></h4><pre>
       The concept for this module came about through a conversation with Matt S.  Trout ("<a href="mailto:mst@shadowcat.co.uk">mst@shadowcat.co.uk</a>")
       after experiencing the issue described in the synopsis on a prefork job-processing daemon.

       Some of the pid detection logic was inspired by the wonderful DBIx::Connector.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       •   Object::Wrapper

       •   Object::Wrapper::Fork

       •   POSIX::AtFork

</pre><h4><b>SUPPORT</b></h4><pre>
       Bugs         may        be        submitted        through        the        RT        bug        tracker
       &lt;https://rt.cpan.org/Public/Dist/Display.html?Name=Object-ForkAware&gt; (or <a href="mailto:bug-Object-ForkAware@rt.cpan.org">bug-Object-ForkAware@rt.cpan.org</a>
       &lt;<a href="mailto:bug-Object-ForkAware@rt.cpan.org">mailto:bug-Object-ForkAware@rt.cpan.org</a>&gt;).

       I am also usually active on irc, as 'ether' at "irc.perl.org".

</pre><h4><b>AUTHOR</b></h4><pre>
       Karen Etheridge &lt;<a href="mailto:ether@cpan.org">ether@cpan.org</a>&gt;

</pre><h4><b>CONTRIBUTOR</b></h4><pre>
       Graham Knop &lt;<a href="mailto:haarg@haarg.org">haarg@haarg.org</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENCE</b></h4><pre>
       This software is copyright (c) 2013 by Karen Etheridge.

       This is free software; you can redistribute it and/or modify it under  the  same  terms  as  the  Perl  5
       programming language system itself.

perl v5.36.0                                       2022-12-04                             <u>Object::<a href="../man3pm/ForkAware.3pm.html">ForkAware</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>