<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>locks — libbash library that implements locking (directory based).</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libbash">libbash_0.9.11-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       locks — libbash library that implements locking (directory based).

       <b>This</b> <b>library</b> <b>is</b> <b>not</b> <b>throughoutly</b> <b>tested</b> <b>-</b> <b>use</b> <b>with</b> <b>caution!</b>

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>dirInitLock</b>      ⟨object⟩ [⟨spin⟩]
       <b>dirTryLock</b>       ⟨object⟩
       <b>dirLock</b>          ⟨object⟩
       <b>dirUnlock</b>        ⟨object⟩
       <b>dirDestroyLock</b>   ⟨object⟩

</pre><h4><b>DESCRIPTION</b></h4><pre>
   <b>General</b>
       <b>locks</b>  is  a collection of functions that implement locking (mutex like) in bash scripting language.  The
       whole idea is based on the fact that directory creation/removal is an atomic process.   The  creation  of
       this library was inspired by studying CVS locks management.

       Same  lock  object  can by used by several processes to serialize access to some shared resource.  (Well,
       yeah, this what locks were invented for...) To actually do this,  processes  just  need  to  access  lock
       object by the same name.

   <b>Functions</b> <b>list:</b>
            <b>dirInitLock</b>      Initialize a lock object for your proccess

            <b>dirTryLock</b>       Try to lock the lock object - give up if its already locked

            <b>dirLock</b>          Lock the lock object - will block until object is unlocked

            <b>dirUnlock</b>        Unlock the lock object

            <b>dirDestroyLock</b>   Destroy the lock object - free resources

       Detailed interface description follows.

</pre><h4><b>FUNCTIONS</b> <b>DESCRIPTIONS</b></h4><pre>
   <b>dirInitLock</b> ⟨<u><b>object</b></u>⟩ [⟨<u><b>spin</b></u>⟩]
       Initialize  a lock object for your process.  Only after a lock is initialized, your proccess will be able
       to use it.  <b>Notice:</b> This action does not lock the object.

       The lock can be set on two types of objects. The first is an existing directory.  In this  case,  Aq  dir
       must be a path (relative or full). The path must contain a ‘/’.  The second is an abstract object used as
       a  lock.  In  this case, the name of the lock will not contain any ‘/’.  This can be used to create locks
       without creating real directories for them.  <b>Notice:</b> Do not call your lock object ‘.lock’.

       Parameters:

         ⟨<u>object</u>⟩
           The name of the lock object (either existing directory or abstract name)

         ⟨<u>spin</u>⟩
           The time (in seconds) that the funtion <u>dirLock</u> will  wait  between  two  runs  of  <u>dirTryLock</u>.   This
           parameter  is  optional,  and its value generally should be less then 1.  If ommited, a default value
           (0.01) is set.

       Return Value:

         One of the following:
         <b>0</b>    The action finished successfully.
         <b>1</b>    The action failed. You do not have permissions to preform it.
         <b>3</b>    The directory path could not be resolved. Possibly parameter  does  contain  ‘/’,  but  refers  to
              directory that does not exist.

   <b>dirTryLock</b> ⟨<u><b>object</b></u>⟩
       Try to lock the lock object. The function always returns immediately.

       Parameters:

         ⟨<u>object</u>⟩
           The object that the lock is set on.

       Return Value:

         One of the following:
         <b>0</b>    The action finished successfully.
         <b>1</b>    The action failed. The object is already locked.
         <b>2</b>    The action failed. Your proccess did not initialize a lock for the object.
         <b>3</b>    The directory path could not be resolved.

   <b>dirLock</b> ⟨<u><b>object</b></u>⟩
       Lock  given  lock object.  If the object is already locked - the function will block untill the object is
       unlocked.  After each try (dirTryLock) the function will sleep for spin seconds (spin  is  defined  using
       <u>dirInitLock</u> ).

       Parameters:

         ⟨<u>object</u>⟩
           The directory that the lock is set on.

       Return Value:

         One of the following:
         <b>0</b>    The action finished successfully.
         <b>2</b>    The action failed. Your proccess did not initialize a lock for the directory.
         <b>3</b>    The directory path could not be resolved.

   <b>dirUnlock</b> ⟨<u><b>dir</b></u>⟩
       Unlock the lock object.

       Parameters:

         ⟨<u>object</u>⟩
           The object that the lock is set on.

       Return Value:

         One of the following:
         <b>0</b>    The action finished successfully.
         <b>2</b>    The action failed. Your proccess did not initialize the lock.
         <b>3</b>    The directory path could not be resolved.

   <b>dirDestroyLock</b> ⟨<u><b>object</b></u>⟩
       Destroys  the lock object.  After this action the proccess will no longer be able to use the lock object.
       To use  the object after this action is done, one must initialize the lock, using <u>dirInitLock</u>.

       Parameters:

         ⟨<u>object</u>⟩
           The directory that the lock is set on.

       Return Value:

         One of the following:
         <b>0</b>    The action finished successfully.
         <b>1</b>    The action failed. The directory is locked by your own proccess. Unlock it first.
         <b>2</b>    The action failed. Your proccess did not initialize the lock.
         <b>3</b>    The directory path could not be resolved.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Creating an abstract lock named mylock, with 0.1 second spintime:
             $ dirInitLock mylock 0.1 # $?=0
       Locking it:
             $ dirLock mylock # $?=0
       Trying once to lock it again:
             $ dirTryLock mylock # $?=1
       Trying to lock it again:
             $ dirLock mylock # Will wait forever
       Unlocking:
             $ dirUnlock mylock # $?=0
       Destroying the lock:
             $ dirDestroyLock mylock # $?=0
       Trying to lock again:
             $ dirLock mylock # $?=2
       Creating a lock on the directory ./mydir, with default spin time:
             $ dirInitLock ./mydir # $?=0

</pre><h4><b>AUTHORS</b></h4><pre>
       Hai Zaar &lt;<a href="mailto:haizaar@haizaar.com">haizaar@haizaar.com</a>&gt;
       Gil Ran &lt;<a href="mailto:gil@ran4.net">gil@ran4.net</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/ldbash.1.html">ldbash</a></u>(1), <u><a href="../man1/libbash.1.html">libbash</a></u>(1)

Linux                                                UNDATED                                            <u><a href="../man3/LOCKS.3.html">LOCKS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>