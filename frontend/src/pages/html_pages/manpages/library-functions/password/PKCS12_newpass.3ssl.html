<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKCS12_newpass - change the password of a PKCS12 structure</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       PKCS12_newpass - change the password of a PKCS12 structure

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/pkcs12.h&gt;

        int PKCS12_newpass(PKCS12 *p12, const char *oldpass, const char *newpass);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>PKCS12_newpass()</b> changes the password of a PKCS12 structure.

       <b>p12</b> is a pointer to a PKCS12 structure. <b>oldpass</b> is the existing password and <b>newpass</b> is the new password.

       Each of <b>oldpass</b> and <b>newpass</b> is independently interpreted as a string in the UTF-8 encoding. If it is not
       valid UTF-8, it is assumed to be ISO8859-1 instead.

       In particular, this means that passwords in the locale character set (or code page on Windows) must
       potentially be converted to UTF-8 before use. This may include passwords from local text files, or input
       from the terminal or command line. Refer to the documentation of <b><a href="../man3/UI_OpenSSL.3.html">UI_OpenSSL</a></b>(3), for example.

       If the PKCS#12 structure does not have a password, then you must use the empty string "" for <b>oldpass</b>.
       Using NULL for <b>oldpass</b> will result in a <b>PKCS12_newpass()</b> failure.

       If the wrong password is used for <b>oldpass</b> then the function will fail, with a MAC verification error. In
       rare cases the PKCS12 structure does not contain a MAC: in this case it will usually fail with a
       decryption padding error.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>PKCS12_newpass()</b> returns 1 on success or 0 on failure. Applications can retrieve the most recent error
       from <b>PKCS12_newpass()</b> with <b>ERR_get_error()</b>.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This example loads a PKCS#12 file, changes its password and writes out the result to a new file.

        #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
        #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
        #include &lt;openssl/pem.h&gt;
        #include &lt;openssl/err.h&gt;
        #include &lt;openssl/pkcs12.h&gt;

        int main(int argc, char **argv)
        {
            FILE *fp;
            PKCS12 *p12;

            if (argc != 5) {
                fprintf(stderr, "Usage: pkread p12file password newpass opfile\n");
                return 1;
            }
            if ((fp = fopen(argv[1], "rb")) == NULL) {
                fprintf(stderr, "Error opening file %s\n", argv[1]);
                return 1;
            }
            p12 = d2i_PKCS12_fp(fp, NULL);
            fclose(fp);
            if (p12 == NULL) {
                fprintf(stderr, "Error reading PKCS#12 file\n");
                ERR_print_errors_fp(stderr);
                return 1;
            }
            if (PKCS12_newpass(p12, argv[2], argv[3]) == 0) {
                fprintf(stderr, "Error changing password\n");
                ERR_print_errors_fp(stderr);
                PKCS12_free(p12);
                return 1;
            }
            if ((fp = fopen(argv[4], "wb")) == NULL) {
                fprintf(stderr, "Error opening file %s\n", argv[4]);
                PKCS12_free(p12);
                return 1;
            }
            i2d_PKCS12_fp(fp, p12);
            PKCS12_free(p12);
            fclose(fp);
            return 0;
        }

</pre><h4><b>BUGS</b></h4><pre>
       The password format is a NULL terminated ASCII string which is converted to Unicode form internally. As a
       result some passwords cannot be supplied to this function.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/PKCS12_create.3.html">PKCS12_create</a></b>(3), <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3), <b><a href="../man7/passphrase-encoding.7.html">passphrase-encoding</a></b>(7)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2016-2018 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                               <u><a href="../man3SSL/PKCS12_NEWPASS.3SSL.html">PKCS12_NEWPASS</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>