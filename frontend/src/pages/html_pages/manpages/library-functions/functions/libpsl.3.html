<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>libpsl - Public Suffix List library functions</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpsl-dev">libpsl-dev_0.21.2-1.1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       libpsl - Public Suffix List library functions

</pre><h4><b>STABILITY</b> <b>LEVEL</b></h4><pre>
       Stable, unless otherwise indicated

</pre><h4><b>FUNCTIONS</b></h4><pre>
       psl_ctx_t *                                                            psl_load_file ()
       psl_ctx_t *                                                            psl_load_fp ()
       psl_ctx_t *                                                            psl_latest ()
       const psl_ctx_t *                                                      psl_builtin ()
       void                                                                   psl_free ()
       int                                                                    psl_is_public_suffix ()
       int                                                                    psl_is_public_suffix2 ()
       const char *                                                           psl_unregistrable_domain ()
       const char *                                                           psl_registrable_domain ()
       int                                                                    psl_suffix_count ()
       int                                                                    psl_suffix_exception_count ()
       int                                                                    psl_suffix_wildcard_count ()
       time_t                                                                 psl_builtin_file_time ()
       const char *                                                           psl_builtin_sha1sum ()
       const char *                                                           psl_builtin_filename ()
       int                                                                    psl_builtin_outdated ()
       int                                                                    psl_is_cookie_domain_acceptable ()
       const char *                                                           psl_dist_filename ()
       const char *                                                           psl_get_version ()
       int                                                                    psl_check_version_number ()
       psl_error_t                                                            psl_str_to_utf8lower ()
       void                                                                   psl_free_string ()

</pre><h4><b>TYPES</b> <b>AND</b> <b>VALUES</b></h4><pre>
       #define                                                                             PSL_API
       #define                                                                             PSL_VERSION
       #define                                                                             PSL_VERSION_MAJOR
       #define                                                                             PSL_VERSION_MINOR
       #define                                                                             PSL_VERSION_NUMBER
       #define                                                                             PSL_VERSION_PATCH
       #define                                                                             PSL_TYPE_ICANN
       #define                                                                             PSL_TYPE_PRIVATE
       #define                                                                             PSL_TYPE_NO_STAR_RULE
       #define                                                                             PSL_TYPE_ANY
       enum                                                                                psl_error_t
       typedef                                                                             psl_ctx_t

</pre><h4><b>INCLUDES</b></h4><pre>
           #include &lt;libpsl.h&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Public</b> <b>Suffix</b> <b>List</b>[1] library functions.

</pre><h4><b>FUNCTIONS</b></h4><pre>
   <b>psl_load_file</b> <b>()</b>
           psl_ctx_t *
           psl_load_file (<u>const</u> <b>char</b> <u>*fname</u>);

       This function loads the public suffixes file named <u>fname</u> . To free the allocated resources, call
       <b>psl_free()</b>.

       The suffixes are expected to be UTF-8 encoded (lowercase + NFKC) if they are international.

       <b>Parameters</b>

                      fname                                       Name of PSL file

       <b>Returns</b>

           Pointer to a PSL context or NULL on failure.

       Since: 0.1

   <b>psl_load_fp</b> <b>()</b>
           psl_ctx_t *
           psl_load_fp (<b>FILE</b> <u>*fp</u>);

       This function loads the public suffixes from a FILE pointer. To free the allocated resources, call
       <b>psl_free()</b>.

       The suffixes are expected to be UTF-8 encoded (lowercase + NFKC) if they are international.

       <b>Parameters</b>

                      fp                                           FILE pointer

       <b>Returns</b>

           Pointer to a PSL context or NULL on failure.

       Since: 0.1

   <b>psl_latest</b> <b>()</b>
           psl_ctx_t *
           psl_latest (<u>const</u> <b>char</b> <u>*fname</u>);

       This function loads the the latest available PSL data from either

       •   <u>fname</u> (application specific filename, may be NULL)

       •   location specified during built-time (filename from ./configure --with-psl-distfile)

       •   built-in PSL data (generated from ./configure --with-psl-file)

       •   location of built-in data (filename from ./configure --with-psl-file)

       If none of the above is available, the function returns NULL.

       To free the allocated resources, call <b>psl_free()</b>.

       <b>Parameters</b>

                      fname                                       Name of PSL file
                                                                  or NULL

       <b>Returns</b>

           Pointer to a PSL context or NULL on failure.

       Since: 0.16

   <b>psl_builtin</b> <b>()</b>
           const psl_ctx_t *
           psl_builtin (<b>void</b>);

       This function returns the PSL context that has been generated and built in at compile-time. You don't
       have to free the returned context explicitly.

       The builtin data also contains punycode entries, one for each international domain name.

       If the generation of built-in data has been disabled during compilation, NULL will be returned. When
       using the builtin psl context, you can provide UTF-8 (lowercase + NFKC) or ASCII/ACE (punycode)
       representations of domains to functions like <b>psl_is_public_suffix()</b>.

       <b>Returns</b>

           Pointer to the built in PSL data or NULL if this data is not available.

       Since: 0.1

   <b>psl_free</b> <b>()</b>
           void
           psl_free (<b>psl_ctx_t</b> <u>*psl</u>);

       This function frees the the PSL context that has been retrieved via <b>psl_load_fp()</b> or <b>psl_load_file()</b>.

       <b>Parameters</b>

                      psl                                           PSL context
                                                                    pointer

       Since: 0.1

   <b>psl_is_public_suffix</b> <b>()</b>
           int
           psl_is_public_suffix (<u>const</u> <b>psl_ctx_t</b> <u>*psl</u>,
                                 <u>const</u> <b>char</b> <u>*domain</u>);

       This function checks if <u>domain</u> is a public suffix by the means of the <b>Mozilla</b> <b>Public</b> <b>Suffix</b> <b>List</b>[2].

       For cookie domain checking see <b>psl_is_cookie_domain_acceptable()</b>.

       International <u>domain</u> names have to be either in UTF-8 (lowercase + NFKC) or in ASCII/ACE format
       (punycode). Other encodings likely result in incorrect return values. Use helper function
       <b>psl_str_to_utf8lower()</b> for normalization <u>domain</u> .

       <u>psl</u> is a context returned by either <b>psl_load_file()</b>, <b>psl_load_fp()</b> or <b>psl_builtin()</b>.

       <b>Parameters</b>

                      psl                                           PSL context

                      domain                                        Domain string

       <b>Returns</b>

           1 if domain is a public suffix, 0 if not.

       Since: 0.1

   <b>psl_is_public_suffix2</b> <b>()</b>
           int
           psl_is_public_suffix2 (<u>const</u> <b>psl_ctx_t</b> <u>*psl</u>,
                                  <u>const</u> <b>char</b> <u>*domain</u>,
                                  <b>int</b> <u>type</u>);

       This function checks if <u>domain</u> is a public suffix by the means of the <b>Mozilla</b> <b>Public</b> <b>Suffix</b> <b>List</b>[2].

       <u>type</u> specifies the PSL section where to perform the lookup. Valid values are PSL_TYPE_PRIVATE,
       PSL_TYPE_ICANN, PSL_TYPE_NO_STAR_RULE, and PSL_TYPE_ANY.

       PSL_TYPE_NO_STAR_RULE switches of the 'prevailing star rule' (see <b>List</b>[3] under 'Algorithm' 2.). Applying
       the flag means that TLDs not explicitly listed in the PSL are *not* treated as public suffixes.

       International <u>domain</u> names have to be either in UTF-8 (lowercase + NFKC) or in ASCII/ACE format
       (punycode). Other encodings likely result in incorrect return values. Use helper function
       <b>psl_str_to_utf8lower()</b> for normalization <u>domain</u> .

       <u>psl</u> is a context returned by either <b>psl_load_file()</b>, <b>psl_load_fp()</b> or <b>psl_builtin()</b>.

       <b>Parameters</b>

                      psl                                           PSL context

                      domain                                        Domain string

                      type                                          Domain type

       <b>Returns</b>

           1 if domain is a public suffix, 0 if not.

       Since: 0.1

   <b>psl_unregistrable_domain</b> <b>()</b>
           const char *
           psl_unregistrable_domain (<u>const</u> <b>psl_ctx_t</b> <u>*psl</u>,
                                     <u>const</u> <b>char</b> <u>*domain</u>);

       This function finds the longest public suffix part of <u>domain</u> by the means of the <b>Mozilla</b> <b>Public</b> <b>Suffix</b>
       <b>List</b>[2].

       International <u>domain</u> names have to be either in UTF-8 (lowercase + NFKC) or in ASCII/ACE format
       (punycode). Other encodings likely result in incorrect return values. Use helper function
       <b>psl_str_to_utf8lower()</b> for normalization <u>domain</u> .

       <u>psl</u> is a context returned by either <b>psl_load_file()</b>, <b>psl_load_fp()</b> or <b>psl_builtin()</b>.

       <b>Parameters</b>

                      psl                                           PSL context

                      domain                                        Domain string

       <b>Returns</b>

           Pointer to longest public suffix part of <u>domain</u> or NULL if <u>domain</u> does not contain a public suffix
           (or if <u>psl</u> is NULL).

       Since: 0.1

   <b>psl_registrable_domain</b> <b>()</b>
           const char *
           psl_registrable_domain (<u>const</u> <b>psl_ctx_t</b> <u>*psl</u>,
                                   <u>const</u> <b>char</b> <u>*domain</u>);

       This function finds the shortest private suffix part of <u>domain</u> by the means of the <b>Mozilla</b> <b>Public</b> <b>Suffix</b>
       <b>List</b>[2].

       International <u>domain</u> names have to be either in UTF-8 (lowercase + NFKC) or in ASCII/ACE format
       (punycode). Other encodings likely result in incorrect return values. Use helper function
       <b>psl_str_to_utf8lower()</b> for normalization <u>domain</u> .

       <u>psl</u> is a context returned by either <b>psl_load_file()</b>, <b>psl_load_fp()</b> or <b>psl_builtin()</b>.

       <b>Parameters</b>

                      psl                                           PSL context

                      domain                                        Domain string

       <b>Returns</b>

           Pointer to shortest private suffix part of <u>domain</u> or NULL if <u>domain</u> does not contain a private suffix
           (or if <u>psl</u> is NULL).

       Since: 0.1

   <b>psl_suffix_count</b> <b>()</b>
           int
           psl_suffix_count (<u>const</u> <b>psl_ctx_t</b> <u>*psl</u>);

       This function returns number of public suffixes maintained by <u>psl</u> . The number of exceptions within the
       Public Suffix List are not included.

       If the information is not available, the return value is -1 (since 0.19). This is the case with DAFSA
       blobs or if <u>psl</u> is NULL.

       <b>Parameters</b>

                      psl                                           PSL context
                                                                    pointer

       <b>Returns</b>

           Number of public suffixes entries in PSL context or -1 if this information is not available.

       Since: 0.1

   <b>psl_suffix_exception_count</b> <b>()</b>
           int
           psl_suffix_exception_count (<u>const</u> <b>psl_ctx_t</b> <u>*psl</u>);

       This function returns number of public suffix exceptions maintained by <u>psl</u> .

       If the information is not available, the return value is -1 (since 0.19). This is the case with DAFSA
       blobs or if <u>psl</u> is NULL.

       <b>Parameters</b>

                      psl                                           PSL context
                                                                    pointer

       <b>Returns</b>

           Number of public suffix exceptions in PSL context or -1 if this information is not available.

       Since: 0.1

   <b>psl_suffix_wildcard_count</b> <b>()</b>
           int
           psl_suffix_wildcard_count (<u>const</u> <b>psl_ctx_t</b> <u>*psl</u>);

       This function returns number of public suffix wildcards maintained by <u>psl</u> .

       If the information is not available, the return value is -1 (since 0.19). This is the case with DAFSA
       blobs or if <u>psl</u> is NULL.

       <b>Parameters</b>

                      psl                                           PSL context
                                                                    pointer

       <b>Returns</b>

           Number of public suffix wildcards in PSL context or -1 if this information is not available.

       Since: 0.10.0

   <b>psl_builtin_file_time</b> <b>()</b>
           time_t
           psl_builtin_file_time (<b>void</b>);

       This function returns the mtime of the Public Suffix List file that has been built in.

       If the generation of built-in data has been disabled during compilation, 0 will be returned.

       <b>Returns</b>

           time_t value or 0.

       Since: 0.1

   <b>psl_builtin_sha1sum</b> <b>()</b>
           const char *
           psl_builtin_sha1sum (<b>void</b>);

       This function returns the SHA1 checksum of the Public Suffix List file that has been built in. The
       returned string is in lowercase hex encoding, e.g. "2af1e9e3044eda0678bb05949d7cca2f769901d8".

       If the generation of built-in data has been disabled during compilation, an empty string will be
       returned.

       <b>Returns</b>

           String containing SHA1 checksum or an empty string.

       Since: 0.1

   <b>psl_builtin_filename</b> <b>()</b>
           const char *
           psl_builtin_filename (<b>void</b>);

       This function returns the file name of the Public Suffix List file that has been built in.

       If the generation of built-in data has been disabled during compilation, an empty string will be
       returned.

       <b>Returns</b>

           String containing the PSL file name or an empty string.

       Since: 0.1

   <b>psl_builtin_outdated</b> <b>()</b>
           int
           psl_builtin_outdated (<b>void</b>);

       This function checks if the built-in data is older than the file it has been created from. If it is, it
       might be a good idea for the application to reload the PSL. The mtime is taken as reference.

       If the PSL file does not exist, it is assumed that the built-in data is not outdated.

       <b>Returns</b>

           1 if the built-in is outdated, 0 otherwise.

       Since: 0.10.0

   <b>psl_is_cookie_domain_acceptable</b> <b>()</b>
           int
           psl_is_cookie_domain_acceptable (<u>const</u> <b>psl_ctx_t</b> <u>*psl</u>,
                                            <u>const</u> <b>char</b> <u>*hostname</u>,
                                            <u>const</u> <b>char</b> <u>*cookie_domain</u>);

       This helper function checks whether <u>cookie_domain</u> is an acceptable cookie domain value for the request
       <u>hostname</u> .

       For international domain names both, <u>hostname</u> and <u>cookie_domain</u> , have to be either in UTF-8 (lowercase +
       NFKC) or in ASCII/ACE (punycode) format. Other encodings or mixing UTF-8 and punycode likely result in
       incorrect return values.

       Use helper function <b>psl_str_to_utf8lower()</b> for normalization of <u>hostname</u> and <u>cookie_domain</u> .

       Hint for Windows users: Please make sure the calling application has called <b>WSAStartup()</b> before calling
       <b>psl_is_cookie_domain_acceptable()</b>.

       Examples:

        1. Cookie domain 'example.com' would be acceptable for hostname 'www.example.com', but '.com' or 'com'
           would NOT be acceptable since 'com' is a public suffix.

        2. Cookie domain 'his.name' would be acceptable for hostname 'remember.his.name', but NOT for
           'forgot.his.name' since 'forgot.his.name' is a public suffix.

       <b>Parameters</b>

                      psl                                             PSL context
                                                                      pointer

                      hostname                                        The request
                                                                      hostname.

                      cookie_domain                                   The domain value
                                                                      from a cookie

       <b>Returns</b>

           1 if acceptable, 0 if not acceptable.

       Since: 0.1

   <b>psl_dist_filename</b> <b>()</b>
           const char *
           psl_dist_filename (<b>void</b>);

       This function returns the file name of the distribution/system PSL data file. This file will be
       considered by <b>psl_latest()</b>.

       Return the filename that is set by ./configure --with-psl-distfile, or an empty string.

       <b>Returns</b>

           String containing a PSL file name or an empty string.

       Since: 0.16

   <b>psl_get_version</b> <b>()</b>
           const char *
           psl_get_version (<b>void</b>);

       Get libpsl version.

       <b>Returns</b>

           String containing version of libpsl.

       Since: 0.2.5

   <b>psl_check_version_number</b> <b>()</b>
           int
           psl_check_version_number (<b>int</b> <u>version</u>);

       Check the given version number is at minimum the current library version number. The version number must
       be a hexadecimal number like 0x000a01 (V0.10.1).

       <b>Parameters</b>

                      version                                       Version number
                                                                    (hex) to check
                                                                    against.

       <b>Returns</b>

           Returns the library version number if the given version number is at least the version of the
           library, else return 0; If the argument is 0, the function returns the library version number without
           performing a check.

       Since: 0.11.0

   <b>psl_str_to_utf8lower</b> <b>()</b>
           psl_error_t
           psl_str_to_utf8lower (<u>const</u> <b>char</b> <u>*str</u>,
                                 <u>const</u> <b>char</b> <u>*encoding</u>,
                                 <u>const</u> <b>char</b> <u>*locale</u>,
                                 <b>char</b> <u>**lower</u>);

       This helper function converts a string to UTF-8 lowercase + NFKC representation. Lowercase + NFKC UTF-8
       is needed as input to the domain checking functions.

       <u>lower</u> stays unchanged on error.

       When returning PSL_SUCCESS, the return value 'lower' must be freed after usage.

       <b>Parameters</b>

                      str                                          string to convert

                      encoding                                     charset encoding
                                                                   of <u>str</u> , e.g.
                                                                   'iso-8859-1' or
                                                                   NULL

                      locale                                       locale of <u>str</u> for
                                                                   to lowercase
                                                                   conversion, e.g.
                                                                   'de' or NULL

                      lower                                        return value
                                                                   containing the
                                                                   converted string

       <b>Returns</b>

           psl_error_t value. PSL_SUCCESS: Success PSL_ERR_INVALID_ARG: <u>str</u> is a NULL value. PSL_ERR_CONVERTER:
           Failed to open the unicode converter with name <u>encoding</u> PSL_ERR_TO_UTF16: Failed to convert <u>str</u> to
           unicode PSL_ERR_TO_LOWER: Failed to convert unicode to lowercase PSL_ERR_TO_UTF8: Failed to convert
           unicode to UTF-8 PSL_ERR_NO_MEM: Failed to allocate memory

       Since: 0.4

   <b>psl_free_string</b> <b>()</b>
           void
           psl_free_string (<b>char</b> <u>*str</u>);

       This function <b>free()</b>'s the memory allocated by <b>psl_str_to_utf8lower()</b> when returning a lowercase string

       <b>Parameters</b>

                      str                                     pointer to
                                                              lowercase string
                                                              returned by
                                                              <b>psl_str_to_utf8lower()</b>

       Since: 0.19

</pre><h4><b>TYPES</b> <b>AND</b> <b>VALUES</b></h4><pre>
   <b>PSL_API</b>
           #  define PSL_API __attribute__ ((__visibility__("default")))

   <b>PSL_VERSION</b>
           #define PSL_VERSION "0.21.2"

   <b>PSL_VERSION_MAJOR</b>
           #define PSL_VERSION_MAJOR 0

   <b>PSL_VERSION_MINOR</b>
           #define PSL_VERSION_MINOR 21

   <b>PSL_VERSION_NUMBER</b>
           #define PSL_VERSION_NUMBER 0x001502

   <b>PSL_VERSION_PATCH</b>
           #define PSL_VERSION_PATCH 2

   <b>PSL_TYPE_ICANN</b>
           #define PSL_TYPE_ICANN        (1&lt;&lt;0)

   <b>PSL_TYPE_PRIVATE</b>
           #define PSL_TYPE_PRIVATE      (1&lt;&lt;1)

   <b>PSL_TYPE_NO_STAR_RULE</b>
           #define PSL_TYPE_NO_STAR_RULE (1&lt;&lt;2)

   <b>PSL_TYPE_ANY</b>
           #define PSL_TYPE_ANY          (PSL_TYPE_ICANN | PSL_TYPE_PRIVATE)

   <b>enum</b> <b>psl_error_t</b>
       Return codes for PSL functions. Negative return codes mean failure. Positive values are reserved for
       non-error return codes.

       <b>Members</b>

                      PSL_SUCCESS                                        Successful
                                                                         return.

                      PSL_ERR_INVALID_ARG                                Invalid argument.

                      PSL_ERR_CONVERTER                                  Failed to open
                                                                         libicu utf-16
                                                                         converter.

                      PSL_ERR_TO_UTF16                                   Failed to convert
                                                                         to utf-16.

                      PSL_ERR_TO_LOWER                                   Failed to convert
                                                                         utf-16 to
                                                                         lowercase.

                      PSL_ERR_TO_UTF8                                    Failed to convert
                                                                         utf-16 to utf-8.

                      PSL_ERR_NO_MEM                                     Failed to
                                                                         allocate memory.

   <b>psl_ctx_t</b>
           typedef struct psl_ctx_st psl_ctx_t;

</pre><h4><b>NOTES</b></h4><pre>
        1. Public Suffix List
           https://publicsuffix.org/

        2. Mozilla Public Suffix List
           https://publicsuffix.org

        3. List
           https://publicsuffix.org/list

LIBPSL Library                                     03/31/2024                                          <u><a href="../man3/LIBPSL.3.html">LIBPSL</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>