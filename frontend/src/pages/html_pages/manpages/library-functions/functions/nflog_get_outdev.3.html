<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nflog_get_msg_packet_hdr, nflog_get_hwtype, nflog_get_msg_packet_hwhdrlen, nflog_get_msg_packet_hwhdr,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnetfilter-log-doc">libnetfilter-log-doc_1.0.2-4build1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nflog_get_msg_packet_hdr, nflog_get_hwtype, nflog_get_msg_packet_hwhdrlen, nflog_get_msg_packet_hwhdr,
       nflog_get_nfmark, nflog_get_timestamp, nflog_get_indev, nflog_get_physindev, nflog_get_outdev,
       nflog_get_physoutdev, nflog_get_packet_hw, nflog_get_payload, nflog_get_prefix, nflog_get_uid,
       nflog_get_gid, nflog_get_seq, nflog_get_seq_global, nflog_get_ctid - Message parsing functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;stddef.h&gt;</b>
       <b>#include</b> <b>&lt;libnetfilter_log/libnetfilter_log.h&gt;</b>

       struct nfulnl_msg_packet_hdr * <b>nflog_get_msg_packet_hdr</b> (struct nflog_data *nfad)
       uint16_t <b>nflog_get_hwtype</b> (struct nflog_data *nfad)
       uint16_t <b>nflog_get_msg_packet_hwhdrlen</b> (struct nflog_data *nfad)
       char * <b>nflog_get_msg_packet_hwhdr</b> (struct nflog_data *nfad)
       uint32_t <b>nflog_get_nfmark</b> (struct nflog_data *nfad)
       int <b>nflog_get_timestamp</b> (struct nflog_data *nfad, struct timeval *tv)
       uint32_t <b>nflog_get_indev</b> (struct nflog_data *nfad)
       uint32_t <b>nflog_get_physindev</b> (struct nflog_data *nfad)
       uint32_t <b>nflog_get_outdev</b> (struct nflog_data *nfad)
       uint32_t <b>nflog_get_physoutdev</b> (struct nflog_data *nfad)
       struct nfulnl_msg_packet_hw * <b>nflog_get_packet_hw</b> (struct nflog_data *nfad)
       int <b>nflog_get_payload</b> (struct nflog_data *nfad, char **data)
       char * <b>nflog_get_prefix</b> (struct nflog_data *nfad)
       int <b>nflog_get_uid</b> (struct nflog_data *nfad, uint32_t *uid)
       int <b>nflog_get_gid</b> (struct nflog_data *nfad, uint32_t *gid)
       int <b>nflog_get_seq</b> (struct nflog_data *nfad, uint32_t *seq)
       int <b>nflog_get_seq_global</b> (struct nflog_data *nfad, uint32_t *seq)
       int <b>nflog_get_ctid</b> (struct nflog_data *nfad, uint32_t *id)

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>int</b> <b>nflog_get_ctid</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad,</b> <b>uint32_t</b> <b>*</b> <b>id)</b>
       nflog_get_ct_id - get the conntrack id

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function
           <u>id</u> conntrack id, if the function returns zero

       You must enable this via <b>nflog_set_flags()</b>.

       <b>Returns</b>
           0 on success or -1 if conntrack itself or its id was unavailable

       Definition at line <b>990</b> of file <b>libnetfilter_log.c</b>.

   <b>int</b> <b>nflog_get_gid</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad,</b> <b>uint32_t</b> <b>*</b> <b>gid)</b>
       nflog_get_gid - get the GID of the user that has generated the packet

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function
           <u>gid</u> GID of the user that generated the packet, if the function returns zero

       <b>Returns</b>
           0 on success or -1 if GID was unavailable (<b>gid</b> is then invalid)

       Definition at line <b>932</b> of file <b>libnetfilter_log.c</b>.

   <b>uint16_t</b> <b>nflog_get_hwtype</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_hwtype - get the hardware link layer type from logging data

       <b>Parameters</b>
           <u>nfad</u> pointer to logging data

       <b>Returns</b>
           the hardware link layer type.

       Definition at line <b>724</b> of file <b>libnetfilter_log.c</b>.

   <b>uint32_t</b> <b>nflog_get_indev</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_indev - get the interface that the packet was received through

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function

       <b>Returns</b>
           The index of the device the packet was received via. If the returned index is 0, the packet was
           locally generated or the input interface is not known (ie. POSTROUTING?).

       <b>Warning</b>
           all nflog_get_dev() functions return 0 if not set, since Linux only allows ifindex &gt;= 1, see
           net/core/dev.c:9819 (in 5.14.3)

       Definition at line <b>799</b> of file <b>libnetfilter_log.c</b>.

   <b>struct</b> <b>nfulnl_msg_packet_hdr</b> <b>*</b> <b>nflog_get_msg_packet_hdr</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_msg_packet_hdr - return the metaheader that wraps the packet

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function

       <b>Returns</b>
           the netfilter log netlink packet header for the given nflog_data argument. Typically, the nflog_data
           value is passed as the 3rd parameter to the callback function set by a call to
           <b>nflog_callback_register()</b>.

       The nfulnl_msg_packet_hdr structure is defined in libnetfilter_log.h as:

               struct nfulnl_msg_packet_hdr {
                       uint16_t       hw_protocol;    // hw protocol (network order)
                       uint8_t        hook;           // netfilter hook
                       uint8_t        _pad;
               } __attribute__ ((packed));

       Definition at line <b>712</b> of file <b>libnetfilter_log.c</b>.

   <b>char</b> <b>*</b> <b>nflog_get_msg_packet_hwhdr</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_msg_packet_hwhdr - get the hardware link layer header

       <b>Parameters</b>
           <u>nfad</u> pointer to logging data

       <b>Returns</b>
           the hardware link layer header

       Definition at line <b>746</b> of file <b>libnetfilter_log.c</b>.

   <b>uint16_t</b> <b>nflog_get_msg_packet_hwhdrlen</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_hwhdrlen - get the length of the hardware link layer header

       <b>Parameters</b>
           <u>nfad</u> pointer to logging data

       <b>Returns</b>
           the size of the hardware link layer header

       Definition at line <b>735</b> of file <b>libnetfilter_log.c</b>.

   <b>uint32_t</b> <b>nflog_get_nfmark</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_nfmark - get the packet mark

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function

       <b>Returns</b>
           the netfilter mark currently assigned to the logged packet.

       Definition at line <b>757</b> of file <b>libnetfilter_log.c</b>.

   <b>uint32_t</b> <b>nflog_get_outdev</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_outdev - gets the interface that the packet will be routed to

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function

       <b>Returns</b>
           The index of the device the packet will be sent to. If the returned index is 0, the packet is
           destined for localhost or the output interface is not yet known (ie. PREROUTING?).

       Definition at line <b>826</b> of file <b>libnetfilter_log.c</b>.

   <b>struct</b> <b>nfulnl_msg_packet_hw</b> <b>*</b> <b>nflog_get_packet_hw</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_packet_hw - get hardware address

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function

       Retrieves the hardware address associated with the given packet. For ethernet packets, the hardware
       address returned (if any) will be the MAC address of the packet source host. The destination MAC address
       is not known until after POSTROUTING and a successful ARP request, so cannot currently be retrieved.

       The nfulnl_msg_packet_hw structure is defined in libnetfilter_log.h as:

               struct nfulnl_msg_packet_hw {
                       uint16_t       hw_addrlen; // Network Byte Order
                       uint16_t       _pad;
                       uint8_t        hw_addr[8];
               } __attribute__ ((packed));

       <b>Returns</b>
           Pointer to struct nfulnl_msg_packet_hw from originating host or NULL if none available (e.g. locally-
           originated packet not for <b>lo</b> interface).

       Definition at line <b>867</b> of file <b>libnetfilter_log.c</b>.

   <b>int</b> <b>nflog_get_payload</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad,</b> <b>char</b> <b>**</b> <b>data)</b>
       nflog_get_payload - get payload of the logged packet

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function
           <u>data</u> Pointer of pointer that will be pointed to the payload

       Retrieve the payload for a logged packet. The actual amount and type of data retrieved by this function
       will depend on the mode set with the <b>nflog_set_mode()</b> function.

       <b>Returns</b>
           payload length, or -1 if this is not available

       Definition at line <b>884</b> of file <b>libnetfilter_log.c</b>.

   <b>uint32_t</b> <b>nflog_get_physindev</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_physindev - get the physical interface that the packet was received through

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function

       <b>Returns</b>
           The index of the physical device the packet was received via. If the returned index is 0, the packet
           was locally generated or the physical input interface is no longer known (ie. POSTROUTING?).

       Definition at line <b>813</b> of file <b>libnetfilter_log.c</b>.

   <b>uint32_t</b> <b>nflog_get_physoutdev</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_physoutdev - get the physical interface for packet output

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function

       <b>Returns</b>
           Index of physical device the packet will be routed to. If the returned index is 0, the packet is
           destined for localhost or the physical output interface is not yet known (ie. PREROUTING?).

       Definition at line <b>839</b> of file <b>libnetfilter_log.c</b>.

   <b>char</b> <b>*</b> <b>nflog_get_prefix</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad)</b>
       nflog_get_prefix - get the logging string prefix

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function

       <b>Returns</b>
           the string prefix that is specified as argument to the iptables' NFLOG target or NULL if this is not
           available.

       Definition at line <b>900</b> of file <b>libnetfilter_log.c</b>.

   <b>int</b> <b>nflog_get_seq</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad,</b> <b>uint32_t</b> <b>*</b> <b>seq)</b>
       nflog_get_seq - get the local nflog sequence number

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function
           <u>seq</u> local nflog sequence number, if the function returns zero

       You must enable this via <b>nflog_set_flags()</b>.

       <b>Returns</b>
           0 on success or -1 if sequence number was unavailable (<b>seq</b> is then invalid)

       Definition at line <b>952</b> of file <b>libnetfilter_log.c</b>.

   <b>int</b> <b>nflog_get_seq_global</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad,</b> <b>uint32_t</b> <b>*</b> <b>seq)</b>
       nflog_get_seq_global - get the global nflog sequence number

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function
           <u>seq</u> global nflog sequence number, if the function returns zero

       You must enable this via <b>nflog_set_flags()</b>.

       <b>Returns</b>
           0 on success or -1 if sequence number was unavailable (<b>seq</b> is then invalid)

       Definition at line <b>972</b> of file <b>libnetfilter_log.c</b>.

   <b>int</b> <b>nflog_get_timestamp</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad,</b> <b>struct</b> <b>timeval</b> <b>*</b> <b>tv)</b>
       nflog_get_timestamp - get the packet timestamp

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function
           <u>tv</u> structure to fill with timestamp info

       Retrieves the received timestamp from the given logged packet.

       <b>Returns</b>
           0 on success, -1 on failure with <b>errno</b> set.

       <b>Errors</b>
           from underlying calls, in exceptional circumstances

       Definition at line <b>773</b> of file <b>libnetfilter_log.c</b>.

   <b>int</b> <b>nflog_get_uid</b> <b>(struct</b> <b>nflog_data</b> <b>*</b> <b>nfad,</b> <b>uint32_t</b> <b>*</b> <b>uid)</b>
       nflog_get_uid - get the UID of the user that generated the packet

       <b>Parameters</b>
           <u>nfad</u> Netlink packet data handle passed to callback function
           <u>uid</u> UID of the user that generated the packet, if the function returns zero

       <b>Returns</b>
           0 on success or -1 if UID was unavailable (<b>uid</b> is then invalid)

       Definition at line <b>914</b> of file <b>libnetfilter_log.c</b>.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for libnetfilter_log from the source code.

libnetfilter_log                                  Version 1.0.2                                       <u><a href="../man3/Parsing.3.html">Parsing</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>