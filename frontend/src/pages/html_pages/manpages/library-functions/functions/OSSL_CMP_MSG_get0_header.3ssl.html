<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSSL_CMP_MSG_get0_header, OSSL_CMP_MSG_get_bodytype, OSSL_CMP_MSG_get0_certreq_publickey,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       OSSL_CMP_MSG_get0_header, OSSL_CMP_MSG_get_bodytype, OSSL_CMP_MSG_get0_certreq_publickey,
       OSSL_CMP_MSG_update_transactionID, OSSL_CMP_MSG_update_recipNonce, OSSL_CMP_CTX_setup_CRM,
       OSSL_CMP_MSG_read, OSSL_CMP_MSG_write, d2i_OSSL_CMP_MSG_bio, i2d_OSSL_CMP_MSG_bio - function(s)
       manipulating CMP messages

</pre><h4><b>SYNOPSIS</b></h4><pre>
         #include &lt;openssl/cmp.h&gt;

         OSSL_CMP_PKIHEADER *OSSL_CMP_MSG_get0_header(const OSSL_CMP_MSG *msg);
         int OSSL_CMP_MSG_get_bodytype(const OSSL_CMP_MSG *msg);
         X509_PUBKEY *OSSL_CMP_MSG_get0_certreq_publickey(const OSSL_CMP_MSG *msg);
         int OSSL_CMP_MSG_update_transactionID(OSSL_CMP_CTX *ctx, OSSL_CMP_MSG *msg);
         int OSSL_CMP_MSG_update_recipNonce(OSSL_CMP_CTX *ctx, OSSL_CMP_MSG *msg);
         OSSL_CRMF_MSG *OSSL_CMP_CTX_setup_CRM(OSSL_CMP_CTX *ctx, int for_KUR, int rid);
         OSSL_CMP_MSG *OSSL_CMP_MSG_read(const char *file, OSSL_LIB_CTX *libctx, const char *propq);
         int OSSL_CMP_MSG_write(const char *file, const OSSL_CMP_MSG *msg);
         OSSL_CMP_MSG *d2i_OSSL_CMP_MSG_bio(BIO *bio, OSSL_CMP_MSG **msg);
         int i2d_OSSL_CMP_MSG_bio(BIO *bio, const OSSL_CMP_MSG *msg);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>OSSL_CMP_MSG_get0_header()</b> returns the header of the given CMP message.

       <b>OSSL_CMP_MSG_get_bodytype()</b> returns the body type of the given CMP message.

       <b>OSSL_CMP_MSG_get0_certreq_publickey()</b> expects that <u>msg</u> is a certificate request message and returns the
       public key in its certificate template if present.

       <b>OSSL_CMP_MSG_update_transactionID()</b> updates the transactionID field in the header of the given message
       according to the CMP_CTX.  If <u>ctx</u> does not contain a transaction ID, a fresh one is created before.  The
       message gets re-protected (if protecting requests is required).

       <b>OSSL_CMP_MSG_update_recipNonce()</b> updates the recipNonce field in the header of the given message
       according to the CMP_CTX.  The message gets re-protected (if protecting requests is required).

       <b>OSSL_CMP_CTX_setup_CRM()</b> creates a CRMF certificate request message from various information provided in
       the CMP context argument <u>ctx</u> for inclusion in a CMP request message based on details contained in <u>ctx</u>.
       The <u>rid</u> argument defines the request identifier to use, which typically is 0.

       The subject DN included in the certificate template is the first available value of these:

       any subject name in <u>ctx</u> set via <b><a href="../man3/OSSL_CMP_CTX_set1_subjectName.3.html">OSSL_CMP_CTX_set1_subjectName</a></b>(3) - if it is the NULL-DN (i.e., any empty
       sequence of RDNs), no subject is included,
       the subject field of any PKCS#10 CSR set in <u>ctx</u> via <b><a href="../man3/OSSL_CMP_CTX_set1_p10CSR.3.html">OSSL_CMP_CTX_set1_p10CSR</a></b>(3),
       the subject field of any reference certificate given in <u>ctx</u> (see <b><a href="../man3/OSSL_CMP_CTX_set1_oldCert.3.html">OSSL_CMP_CTX_set1_oldCert</a></b>(3)), but only
       if <u>for_KUR</u> is nonzero or the <u>ctx</u> does not include a Subject Alternative Name.

       The public key included is the first available value of these:

       the public key derived from any key set via <b><a href="../man3/OSSL_CMP_CTX_set0_newPkey.3.html">OSSL_CMP_CTX_set0_newPkey</a></b>(3),
       the public key of any PKCS#10 CSR given in <u>ctx</u>,
       the public key of any reference certificate given in <u>ctx</u> (see <b><a href="../man3/OSSL_CMP_CTX_set1_oldCert.3.html">OSSL_CMP_CTX_set1_oldCert</a></b>(3)),
       the public key derived from any client's private key set via <b><a href="../man3/OSSL_CMP_CTX_set1_pkey.3.html">OSSL_CMP_CTX_set1_pkey</a></b>(3).

       The  set  of  X.509  extensions  to  include is computed as follows.  If a PKCS#10 CSR is present in <u>ctx</u>,
       default extensions are taken from there, otherwise the empty set is taken as the initial value.  If there
       is  a  reference   certificate   in   <u>ctx</u>   and   contains   Subject   Alternative   Names   (SANs)   and
       <b>OSSL_CMP_OPT_SUBJECTALTNAME_NODEFAULT</b>  is  not  set,  these  override any SANs from the PKCS#10 CSR.  The
       extensions are further augmented or overridden by any extensions with the same OIDs included in  the  <u>ctx</u>
       via  <b><a href="../man3/OSSL_CMP_CTX_set0_reqExtensions.3.html">OSSL_CMP_CTX_set0_reqExtensions</a></b>(3).  The SANs are further overridden by any SANs included in <u>ctx</u> via
       <b><a href="../man3/OSSL_CMP_CTX_push1_subjectAltName.3.html">OSSL_CMP_CTX_push1_subjectAltName</a></b>(3).  Finally, policies are overridden by any policies included  in  <u>ctx</u>
       via <b><a href="../man3/OSSL_CMP_CTX_push0_policy.3.html">OSSL_CMP_CTX_push0_policy</a></b>(3).

       <b>OSSL_CMP_CTX_setup_CRM()</b>  also  sets  the  sets the regToken control <b>oldCertID</b> for KUR messages using the
       issuer name and serial number of the reference certificate, if present.

       <b>OSSL_CMP_MSG_read()</b> loads a DER-encoded OSSL_CMP_MSG from <u>file</u>.

       <b>OSSL_CMP_MSG_write()</b> stores the given OSSL_CMP_MSG to <u>file</u> in DER encoding.

       <b>d2i_OSSL_CMP_MSG_bio()</b> parses an ASN.1-encoded OSSL_CMP_MSG from the BIO <u>bio</u>.  It assigns  a  pointer  to
       the new structure to <u>*msg</u> if <u>msg</u> is not NULL.

       <b>i2d_OSSL_CMP_MSG_bio()</b> writes the OSSL_CMP_MSG <u>msg</u> in ASN.1 encoding to BIO <u>bio</u>.

</pre><h4><b>NOTES</b></h4><pre>
       CMP is defined in RFC 4210.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>OSSL_CMP_MSG_get0_header()</b>  returns  the  intended  pointer  value  as  described  above  or  NULL if the
       respective entry does not exist and on error.

       <b>OSSL_CMP_MSG_get_bodytype()</b> returns the body type or -1 on error.

       <b>OSSL_CMP_MSG_get0_certreq_publickey()</b> returns a public key or NULL on error.

       <b>OSSL_CMP_CTX_setup_CRM()</b> returns a pointer to a <b>OSSL_CRMF_MSG</b> on success, NULL on error.

       <b>d2i_OSSL_CMP_MSG_bio()</b> returns the parsed message or NULL on error.

       <b>OSSL_CMP_MSG_read()</b> and <b>d2i_OSSL_CMP_MSG_bio()</b> return the parsed CMP message or NULL on error.

       <b>OSSL_CMP_MSG_write()</b> returns the number of bytes successfully encoded or a negative  value  if  an  error
       occurs.

       <b>i2d_OSSL_CMP_MSG_bio()</b>,  <b>OSSL_CMP_MSG_update_transactionID()</b>, and <b>OSSL_CMP_MSG_update_recipNonce()</b> return
       1 on success, 0 on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/OSSL_CMP_CTX_set1_subjectName.3.html">OSSL_CMP_CTX_set1_subjectName</a></b>(3),       <b><a href="../man3/OSSL_CMP_CTX_set1_p10CSR.3.html">OSSL_CMP_CTX_set1_p10CSR</a></b>(3),        <b><a href="../man3/OSSL_CMP_CTX_set1_oldCert.3.html">OSSL_CMP_CTX_set1_oldCert</a></b>(3),
       <b><a href="../man3/OSSL_CMP_CTX_set0_newPkey.3.html">OSSL_CMP_CTX_set0_newPkey</a></b>(3),        <b><a href="../man3/OSSL_CMP_CTX_set1_pkey.3.html">OSSL_CMP_CTX_set1_pkey</a></b>(3),       <b><a href="../man3/OSSL_CMP_CTX_set0_reqExtensions.3.html">OSSL_CMP_CTX_set0_reqExtensions</a></b>(3),
       <b><a href="../man3/OSSL_CMP_CTX_push1_subjectAltName.3.html">OSSL_CMP_CTX_push1_subjectAltName</a></b>(3), <b><a href="../man3/OSSL_CMP_CTX_push0_policy.3.html">OSSL_CMP_CTX_push0_policy</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The OpenSSL CMP support was added in OpenSSL 3.0.

       <b>OSSL_CMP_MSG_update_recipNonce()</b> was added in OpenSSL 3.0.9.

       <b>OSSL_CMP_MSG_get0_certreq_publickey()</b> was added in OpenSSL 3.3.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2007-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                     <u><a href="../man3SSL/OSSL_CMP_MSG_GET0_HEADER.3SSL.html">OSSL_CMP_MSG_GET0_HEADER</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>