<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oath_totp_validate4 - API function</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/liboath-dev">liboath-dev_2.6.12-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       oath_totp_validate4 - API function

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;oath.h&gt;</b>

       <b>int</b>  <b>oath_totp_validate4(const</b>  <b>char</b> <b>*</b> <u>secret</u><b>,</b> <b>size_t</b> <u>secret_length</u><b>,</b> <b>time_t</b> <u>now</u><b>,</b> <b>unsigned</b> <u>time_step_size</u><b>,</b>
       <b>time_t</b> <u>start_offset</u><b>,</b> <b>size_t</b> <u>window</u><b>,</b> <b>int</b> <b>*</b> <u>otp_pos</u><b>,</b> <b>uint64_t</b> <b>*</b> <u>otp_counter</u><b>,</b> <b>int</b> <u>flags</u><b>,</b> <b>const</b> <b>char</b> <b>*</b> <u>otp</u><b>);</b>

</pre><h4><b>ARGUMENTS</b></h4><pre>
       const char * secret
                   the shared secret string

       size_t secret_length
                   length of <u>secret</u>

       time_t now  Unix time value to validate TOTP for

       unsigned time_step_size
                   time step system parameter (typically 30)

       time_t start_offset
                   Unix time of when to start counting time steps (typically 0)

       size_t window
                   how many OTPs after/before start OTP to test

       int * otp_pos
                   output search position in search window (may be NULL).

       uint64_t * otp_counter
                   counter value used to calculate OTP value (may be NULL).

       int flags   flags indicating mode, one of <b>oath_totp_flags</b>

       const char * otp
                   the OTP to validate.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Validate an OTP according to OATH TOTP algorithm per RFC 6238.

       Currently only OTP lengths of 6, 7 or 8 digits are supported.  This restrictions may be lifted in  future
       versions, although some limitations are inherent in the protocol.

       The  <u>flags</u>  parameter  may  be  used  to  change  the  MAC function, for example <b>OATH_TOTP_HMAC_SHA256</b> or
       <b>OATH_TOTP_HMAC_SHA512</b>.

</pre><h4><b>RETURNS</b></h4><pre>
       Returns absolute value of position in OTP window (zero is first position), or <b>OATH_INVALID_OTP</b> if no  OTP
       was found in OTP window, or an error code.

</pre><h4><b>SINCE</b></h4><pre>
       2.6.0

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report  bugs  to &lt;<a href="mailto:oath-toolkit-help@nongnu.org">oath-toolkit-help@nongnu.org</a>&gt;.  liboath home page: https://www.nongnu.org/oath-toolkit/
       General help using GNU software: <a href="http://www.gnu.org/gethelp/">http://www.gnu.org/gethelp/</a>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Â© 2009-2020 Simon Josefsson.
       Copying and distribution of this file, with or without modification, are permitted in any medium  without
       royalty provided the copyright notice and this notice are preserved.

liboath                                              2.6.12                               <u><a href="../man3/oath_totp_validate4.3.html">oath_totp_validate4</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>