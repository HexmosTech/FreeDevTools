<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>register_config_handler,          register_const_config_handler,         register_prenetsnmp_mib_handler,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsnmp-dev">libsnmp-dev_5.9.4+dfsg-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       register_config_handler,          register_const_config_handler,         register_prenetsnmp_mib_handler,
       unregister_config_handler,             register_mib_handlers,             unregister_all_config_handlers,
       register_app_config_handler,      register_app_prenetsnmp_mib_handler,     unregister_app_config_handler,
       read_configs,    read_premib_configs,    read_config_print_usage,    config_perror,    config_pwarn     -
       netsnmp_config_api functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;net-snmp/config_api.h&gt;</b>

   <b>Config</b> <b>Handlers</b>
       <b>struct</b> <b>config_line</b> <b>*</b>
         <b>register_config_handler(const</b> <b>char</b> <b>*</b><u>filePrefix</u><b>,</b>
                            <b>const</b> <b>char</b> <b>*</b><u>token</u><b>,</b>
                            <b>void</b> <b>(*</b><u>parser</u><b>)(const</b> <b>char</b> <b>*,</b> <b>char</b> <b>*),</b>
                            <b>void</b> <b>(*</b><u>releaser</u><b>)(void),</b>
                            <b>const</b> <b>char</b> <b>*</b><u>usageLine</u><b>);</b>

       <b>struct</b> <b>config_line</b> <b>*</b>
         <b>register_const_config_handler(const</b> <b>char</b> <b>*</b><u>filePrefix</u><b>,</b>
                            <b>const</b> <b>char</b> <b>*</b><u>token</u><b>,</b>
                            <b>void</b> <b>(*</b><u>parser</u><b>)(const</b> <b>char</b> <b>*,</b> <b>const</b> <b>char</b> <b>*),</b>
                            <b>void</b> <b>(*</b><u>releaser</u><b>)(void),</b>
                            <b>const</b> <b>char</b> <b>*</b><u>usageLine</u><b>);</b>

       <b>struct</b> <b>config_line</b> <b>*</b>
         <b>register_prenetsnmp_mib_handler(const</b> <b>char</b> <b>*</b><u>filePrefix</u><b>,</b>
                            <b>const</b> <b>char</b> <b>*</b><u>token</u><b>,</b>
                            <b>void</b> <b>(*</b><u>parser</u><b>)(const</b> <b>char</b> <b>*,</b> <b>char</b> <b>*),</b>
                            <b>void</b> <b>(*</b><u>releaser</u><b>)(void),</b>
                            <b>const</b> <b>char</b> <b>*</b><u>usageLine</u><b>);</b>

       <b>void</b> <b>unregister_config_handler(const</b> <b>char</b> <b>*</b><u>filePrefix</u><b>,</b>
                            <b>const</b> <b>char</b> <b>*</b><u>token</u><b>);</b>

       <b>void</b> <b>register_mib_handlers(void);</b>
       <b>void</b> <b>unregister_all_config_handlers(void);</b>

   <b>Application</b> <b>Handlers</b>
       <b>struct</b> <b>config_line</b> <b>*</b>
         <b>register_app_config_handler(const</b> <b>char</b> <b>*</b><u>token</u><b>,</b>
                            <b>void</b> <b>(*</b><u>parser</u><b>)(const</b> <b>char</b> <b>*,</b> <b>char</b> <b>*),</b>
                            <b>void</b> <b>(*</b><u>releaser</u><b>)(void),</b>
                            <b>const</b> <b>char</b> <b>*</b><u>usageLine</u><b>);</b>

       <b>struct</b> <b>config_line</b> <b>*</b>
         <b>register_app_prenetsnmp_mib_handler(const</b> <b>char</b> <b>*</b><u>token</u><b>,</b>
                            <b>void</b> <b>(*</b><u>parser</u><b>)(const</b> <b>char</b> <b>*,</b> <b>char</b> <b>*),</b>
                            <b>void</b> <b>(*</b><u>releaser</u><b>)(void),</b>
                            <b>const</b> <b>char</b> <b>*</b><u>usageLine</u><b>);</b>

       <b>void</b> <b>unregister_app_config_handler(const</b> <b>char</b> <b>*</b><u>token</u><b>);</b>

   <b>Reading</b> <b>Configuration</b> <b>Files</b>
       <b>void</b> <b>read_premib_configs(void);</b>
       <b>void</b> <b>read_configs(void);</b>

   <b>Help</b> <b>Strings</b> <b>and</b> <b>Errors</b>
       <b>void</b> <b>read_config_print_usage(char</b> <b>*</b><u>lead</u><b>);</b>
       <b>void</b> <b>config_pwarn(const</b> <b>char</b> <b>*</b><u>string</u><b>);</b>
       <b>void</b> <b>config_perror(const</b> <b>char</b> <b>*</b><u>string</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The functions are a fairly extensible system of parsing various configuration files at the run time of an
       application.  The configuration file flow is broken into the following phases:

           1.  Registration of handlers.

           2.  Reading of the configuration files for pre-MIB parsing requirements.

           3.  Reading and parsing of the textual MIB files.

           4.  Reading of the configuration files for configuration directives.

           5.  Optionally re-reading the configuration files at a future date.

       The  idea  is  that  the calling application is able to register <u>handlers</u> for certain <u>tokens</u> specified in
       certain named <u>configuration</u> <u>files.</u>  The <b>read_configs()</b> function can  then  be  called  to  look  for  all
       relevant configuration files, match the first word on each line against the list of registered tokens and
       pass the remainder of the line to the appropriate registered handler.

</pre><h4><b>REGISTERING</b> <b>A</b> <b>HANDLER</b></h4><pre>
       <b>register_config_handler()</b>
              Registers  a  configuration  handler  routine,  which  should  be  called to process configuration
              directives starting with the specified token.  For example:

                     register_config_handler("snmp", "exampleToken", example_handler, NULL, "ARG1 [ARG2]");

              would register the <b>example_handler()</b> function so that it will get called every time the first word
              of a line in the <u>snmp.conf</u> configuration file(s) matches "exampleToken".
              Calling  the  appropriate  handlers  to  process  the  configuration  file   directives   is   the
              responsibility of <b>read_configs()</b> (see below).

       <b>register_const_config_handler()</b>
              Similar   to  the  <b>register_config_handler()</b>  function,  but  the  parser  routine  is  explicitly
              constrained to not modify the string being parsed.

       <b>register_prenetsnmp_mib_handler()</b>
              Similar to the <b>register_config_handler()</b> function, but the  registered  handler  routine  will  be
              called  <u>before</u>  the  textual MIBs are read in.  This is typically used for tokens that will affect
              the configuration of the MIB parser, and will normally  only  be  used  within  the  SNMP  library
              itself.

       <b>register_mib_handlers()</b>
              Initialisation routine to register the internal SNMP library configuration handlers.

       <b>unregister_config_handler()</b>
              Removes the registered configuration handler for the specified <u>filePrefix</u> and <u>token</u>.

       <b>unregister_all_config_handlers()</b>
              Removes all registered configuration handlers.

   <b>Token</b> <b>Handlers</b>
       Handler functions should have the following signature:

              <b>void</b> <b>handler(const</b> <b>char</b> <b>*</b><u>token</u><b>,</b> <b>char</b> <b>*</b><u>line</u><b>);</b>
              or
              <b>void</b>    <b>handler(const</b>    <b>char</b>    <b>*</b><u>token</u><b>,</b>    <b>const</b>   <b>char</b>   <b>*</b><u>line</u><b>);</b>   br   (if   registered   using
              <u>register_const_config_handler</u>)

       The function will be called with two arguments, the first being the token that triggered the call to this
       function (i.e. the token used when registering the handler), and the second being the  remainder  of  the
       configuration file line (i.e. everything following the white space following the matched token).

   <b>Freeing</b> <b>Handlers</b>
       If the token handler function dynamically allocates resources when processing a configuration entry, then
       these  may  need  to  be  released  before re-reading the configuration files.  If the fourth parameter (
       <u>releaser</u> ) passed to <b>register_config_handler</b> is non-NULL, then this specifies a  function  to  be  called
       before  re-reading  the  configuration  files.   This function should free any resources allocated by the
       token handler function and reset its notion of the configuration  to  its  default.   The  token  handler
       function can then safely be called again.  No arguments are passed to the resource freeing handler.
       Note  that  this  function  is not called when the handler is unregistered individually (but <u>is</u> called as
       part of <b>unregister_all_config_handlers()</b> ).

   <b>Application</b> <b>Handlers</b>
       <b>register_app_config_handler()</b>

       <b>register_app_prenetsnmp_mib_handler()</b>

       <b>unregister_app_config_handler()</b>
              These functions are analagous to <b>register_config_handler()</b>, <b>register_prenetsnmp_mib_handler()</b>  and
              <b>unregister_config_handler()</b>  but  do not require the file type argument (which is filled in by the
              application).  It is intended that MIB modules written for the agent use these functions to  allow
              the  agent  to have more control over which configuration files are read (typically the <u>snmpd.conf</u>
              files).

</pre><h4><b>READING</b> <b>CONFIGURATION</b> <b>FILES</b></h4><pre>
       <b>read_premib_configs()</b>

       <b>read_configs()</b>
              These routines process the configuration files found in the configuration search path (see below).
              For each entry, the handler registered for that configuration token is called.

       <b>read_premib_configs()</b> is run before the MIB files are read in, and processes those  configuration  tokens
       registered  using  <b>register_prenetsnmp_mib_handler()</b>  (or  <b>register_app_prenetsnmp_mib_handler()</b>  ).  All
       other entries are ignored.

       <b>read_configs()</b> is run after the MIB files have been read in, and  processes  those  configuration  tokens
       registered  using  <b>register_config_handler()</b>  (or  <b>register_app_config_handler()</b>  ).   If it encounters a
       configuration token for which no handler has been registered (either pre-  or  post-mib),  then  it  will
       display a warning message, and continue processing with the next line of the configuration file.

   <b>Configuration</b> <b>Search</b> <b>Path</b>
       The  configuration  files  to  be  read  are  found  by searching a list of configuration directories for
       appropriately named files.  In each such directory, the library will look for files named
        snmp.conf,
        snmp.local.conf,
        <u>app</u>.conf,
        <u>app</u>.local.conf,
       (where <u>app</u> is the appication-specific filePrefix used to register configuration  handlers).   It  is  not
       necessary  for any or all of these files to be present in each directory.  Missing files will be silently
       skipped.
       The idea behind the two different suffixes is that the first file can be shared  (via  rdist  or  an  NFS
       mount)  across a large number of machines and the second file can be used to configure local settings for
       one particular machine.

       The default list of directories to search  is   /etc/snmp,  followed  by   /usr/share/snmp,  followed  by
       /usr/lib/x86_64-linux-gnu/snmp,  followed  by   $HOME/.snmp.   This  list  can  be changed by setting the
       environmental variable <u>SNMPCONFPATH</u> to be a (colon separated) list of directories to search.

   <b>init_snmp()</b>
       The normal mode of operation would be to register the application-specific  configuration  handlers,  and
       then  invoke  <b>init_snmp()</b>.   This  would  call the routines listed above to register the internal library
       configuration     handlers,     process      any      configuration      tokens      registered      with
       <b>register_prenetsnmp_mib_handler(),</b>  read in the textual MIB files using <b>init_mib(),</b> and finally parse the
       configuration file tokens registered with <b>register_config_handler()</b>.

       If the <b>init_snmp()</b> function is used, none of  these  functions  need  to  be  explicitly  called  by  the
       application.

</pre><h4><b>HELP</b> <b>STRINGS</b> <b>AND</b> <b>ERRORS</b></h4><pre>
       The  <u>usageLine</u>  parameter  passed to <b>register_config_handler()</b> and similar calls, is used to display help
       information when the <b>read_config_print_usage()</b> function is called.  This function is used by all  of  the
       applications  when  the  <b>-H</b>  flag  is  passed  on  the  command  line.  It prints a summary of all of the
       configuration file lines, and the associated files,  that  the  configuration  system  understands.   The
       <u>usageLine</u> parameter should be a list of arguments expected after the token, and not a lengthy description
       (which  should  go  into a manual page instead).  The <u>lead</u> prefix will be prepended to each line that the
       function prints to stderr, where it displays its output.

       The <b>init_snmp()</b> function should be called before the <b>read_config_print_usage()</b>  function  is  called,  so
       that the library can register its configuration file directives as well for the <b>read_config_print_usage()</b>
       function to display.

   <b>Error</b> <b>Handling</b> <b>Functions</b>
       The  two  functions <b>config_pwarn()</b> and <b>config_perror()</b> both take an error string as an argument and print
       it to stderr along with the file and line number that caused the error.  A call to  the  second  function
       will  also  force  <b>read_configs()</b>  to  eventually  return  with  an error code indicating to it's calling
       function that it should abort the operation of the application.

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       SNMPCONFPATH
                 A colon separated list of directories to search for configuration files in.  Default
                 /etc/snmp:/usr/share/snmp:/usr/lib/x86_64-linux-gnu/snmp:$HOME/.snmp

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3/netsnmp_mib_api.3.html">netsnmp_mib_api</a>(3), <a href="../man3/snmp_api.3.html">snmp_api</a>(3)

V5.9.4.pre2                                        13 Aug 2010                             <u><a href="../man3/NETSNMP_CONFIG_API.3.html">NETSNMP_CONFIG_API</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>