<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gnutls_certificate_verify_peers - API function</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/gnutls-doc">gnutls-doc_3.8.9-3ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gnutls_certificate_verify_peers - API function

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;gnutls/gnutls.h&gt;</b>

       <b>int</b>  <b>gnutls_certificate_verify_peers(gnutls_session_t</b> <u>session</u><b>,</b> <b>gnutls_typed_vdata_st</b> <b>*</b> <u>data</u><b>,</b> <b>unsigned</b> <b>int</b>
       <u>elements</u><b>,</b> <b>unsigned</b> <b>int</b> <b>*</b> <u>status</u><b>);</b>

</pre><h4><b>ARGUMENTS</b></h4><pre>
       gnutls_session_t session
                   is a gnutls session

       gnutls_typed_vdata_st * data
                   an array of typed data

       unsigned int elements
                   the number of data elements

       unsigned int * status
                   is the output of the verification

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This function will verify the peer's certificate and store the the status in the  <u>status</u>  variable  as  a
       bitwise  OR  of gnutls_certificate_status_t values or zero if the certificate is trusted. Note that value
       in  <u>status</u> is set only when the return value of this  function  is  success  (i.e,  failure  to  trust  a
       certificate  does  not  imply  a  negative  return  value).   The default verification flags used by this
       function  can  be  overridden  using  <b>gnutls_certificate_set_verify_flags()</b>.  See  the  documentation  of
       <b>gnutls_certificate_verify_peers2()</b> for details in the verification process.

       This  function  will  take  into  account  the  stapled OCSP responses sent by the server, as well as the
       following X.509 certificate extensions: Name Constraints, Key Usage, and Basic Constraints (pathlen).

       The    acceptable     <u>data</u>     types     are     <b>GNUTLS_DT_DNS_HOSTNAME</b>,     <b>GNUTLS_DT_RFC822NAME</b>     and
       <b>GNUTLS_DT_KEY_PURPOSE_OID</b>.   The  former  two accept as data a null-terminated hostname or email address,
       and the latter a null-terminated object identifier (e.g., <b>GNUTLS_KP_TLS_WWW_SERVER</b>).

       If a DNS hostname is provided then this function will compare the hostname in the certificate against the
       given. If names do not match the <b>GNUTLS_CERT_UNEXPECTED_OWNER</b> status flag will be set.  If a key  purpose
       OID  is  provided  and  the  end-certificate  contains  the extended key usage PKIX extension, it will be
       required to be have the provided key purpose or be marked for any purpose, otherwise verification  status
       will have the <b>GNUTLS_CERT_SIGNER_CONSTRAINTS_FAILURE</b> flag set.

       To avoid denial of service attacks some default upper limits regarding the certificate key size and chain
       size are set. To override them use <b>gnutls_certificate_set_verify_limits()</b>.

       Note  that  when  using  raw  public-keys  verification  will  not work because there is no corresponding
       certificate body belonging to the raw key that can be verified. In that case this  function  will  return
       <b>GNUTLS_E_INVALID_REQUEST</b>.

</pre><h4><b>RETURNS</b></h4><pre>
       <b>GNUTLS_E_SUCCESS</b>  (0) when the validation is performed, or a negative error code otherwise.  A successful
       error code means that the  <u>status</u> parameter must be checked to obtain the validation status.

</pre><h4><b>SINCE</b></h4><pre>
       3.3.0

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<a href="mailto:bugs@gnutls.org">bugs@gnutls.org</a>&gt;.
       Home page: https://www.gnutls.org

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Â© 2001-2023 Free Software Foundation, Inc., and others.
       Copying and distribution of this file, with or without modification, are permitted in any medium  without
       royalty provided the copyright notice and this notice are preserved.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       The  full  documentation  for  <b>gnutls</b>  is  maintained as a Texinfo manual.  If the /usr/share/doc/gnutls/
       directory does not contain the HTML form visit

       https://www.gnutls.org/manual/

gnutls                                                3.8.9                   <u><a href="../man3/gnutls_certificate_verify_peers.3.html">gnutls_certificate_verify_peers</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>