<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gensio_alloc_mdns,       gensio_free_mdns,      gensio_mdns_add_service,      gensio_mdns_remove_service,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libgensio-dev">libgensio-dev_2.8.6-1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gensio_alloc_mdns,       gensio_free_mdns,      gensio_mdns_add_service,      gensio_mdns_remove_service,
       gensio_mdns_add_watch, gensio_mdns_remove_watch - Functions for doing mDNS operations

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;gensio/gensio_mdns.h&gt;</b>

       <b>typedef</b> <b>void</b> <b>(*gensio_mdns_done)(struct</b> <b>gensio_mdns</b> <b>*m,</b>
                           <b>void</b> <b>*userdata);</b>

       <b>int</b> <b>gensio_alloc_mdns(struct</b> <b>gensio_os_funcs</b> <b>*o,</b>
                           <b>struct</b> <b>gensio_mdns</b> <b>**m);</b>

       <b>int</b> <b>gensio_free_mdns(struct</b> <b>gensio_mdns</b> <b>*m,</b> <b>gensio_mdns_done</b> <b>done,</b>
                           <b>void</b> <b>*userdata);</b>

       <b>int</b> <b>gensio_mdns_add_service(struct</b> <b>gensio_mdns</b> <b>*m,</b> <b>int</b> <b>interface,</b>
                           <b>int</b> <b>ipdomain,</b> <b>const</b> <b>char</b> <b>*name,</b> <b>const</b> <b>char</b> <b>*type,</b>
                           <b>const</b> <b>char</b> <b>*domain,</b> <b>const</b> <b>char</b> <b>*host,</b>
                           <b>int</b> <b>port,</b> <b>const</b> <b>char</b> <b>*txt[],</b>
                           <b>struct</b> <b>gensio_mdns_service</b> <b>**s);</b>

       <b>typedef</b> <b>void</b> <b>(*gensio_mdns_service_cb)(struct</b> <b>gensio_mdns_service</b> <b>*service,</b>
                           <b>enum</b> <b>gensio_mdns_service_event</b> <b>ev,</b>
                           <b>const</b> <b>char</b> <b>*info,</b>
                           <b>void</b> <b>*cb_data);</b>

       <b>int</b> <b>gensio_mdns_add_service2(struct</b> <b>gensio_mdns</b> <b>*m,</b> <b>int</b> <b>interface,</b>
                           <b>int</b> <b>ipdomain,</b> <b>const</b> <b>char</b> <b>*name,</b> <b>const</b> <b>char</b> <b>*type,</b>
                           <b>const</b> <b>char</b> <b>*domain,</b> <b>const</b> <b>char</b> <b>*host,</b>
                           <b>int</b> <b>port,</b> <b>const</b> <b>char</b> <b>*txt[],</b>
                           <b>gensio_mdns_service_cb</b> <b>cb,</b> <b>void</b> <b>*cb_data,</b>
                           <b>struct</b> <b>gensio_mdns_service</b> <b>**s);</b>

       <b>int</b> <b>gensio_mdns_remove_service(struct</b> <b>gensio_mdns_service</b> <b>*s);</b>

       <b>typedef</b> <b>void</b> <b>gensio_mdns_watch_cb(struct</b> <b>gensio_mdns_watch</b> <b>*w,</b>
                           <b>enum</b> <b>gensio_mdns_data_state</b> <b>state,</b>
                           <b>int</b> <b>interface,</b> <b>int</b> <b>ipdomain,</b>
                           <b>const</b> <b>char</b> <b>*name,</b> <b>const</b> <b>char</b> <b>*type,</b>
                           <b>const</b> <b>char</b> <b>*domain,</b> <b>const</b> <b>char</b> <b>*host,</b>
                           <b>const</b> <b>struct</b> <b>gensio_addr</b> <b>*addr,</b> <b>const</b> <b>char</b> <b>*txt[],</b>
                           <b>void</b> <b>*userdata);</b>

       <b>int</b> <b>gensio_mdns_add_watch(struct</b> <b>gensio_mdns</b> <b>*m,</b> <b>int</b> <b>interface,</b>
                           <b>int</b> <b>ipdomain,</b> <b>const</b> <b>char</b> <b>*name,</b> <b>const</b> <b>char</b> <b>*type,</b>
                           <b>const</b> <b>char</b> <b>*domain,</b> <b>const</b> <b>char</b> <b>*host,</b>
                           <b>gensio_mdns_watch_cb</b> <b>callback,</b> <b>void</b> <b>*userdata,</b>
                           <b>struct</b> <b>gensio_mdns_watch</b> <b>**w);</b>

       <b>int</b> <b>gensio_mdns_remove_watch(struct</b> <b>gensio_mdns_watch</b> <b>*w);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These functions and type deal with mDNS (Multicast DNS) discovery of services on a local  network.   They
       can  be  used to advertise services or find services.  These provide a powerful and easy to use interface
       to mDNS capabilities.

       To do these things, you must first use <b>gensio_alloc_mdns</b> to allocate an mdns structure with the  standard
       gensio  OS  functions  structure.  You must, of course, do the standard OS functions wait loops and such.
       When you are finished, you should free the mdns structure with  <b>gensio_free_mdns.</b>   Note  that  code  may
       still  be  in mdns callbacks when the free returns, you have to make sure to wait until the done callback
       is called to know the code is out of all callbacks.  The done callback is optional  if  you  don't  care.
       Also  note  that  the mdns will not be freed (and done not called) until all the services and watches are
       freed for it.

       For the remaining functions, the <u>interface</u> parameter is  the  system  interface  number  of  the  network
       device, and may be -1 to specify all interfaces.  The <u>ipdomain</u> parameter is one of:

       <u>GENSIO_NETTYPE_UNSPEC</u>
              Do both IPV4 and IPV4

       <u>GENSIO_NETTYPE_IPV4</u>
              IPV4 only

       <u>GENSIO_NETTYPE_IPV6</u>
              IPV6 only

       The  <u>name,</u>  <u>type,</u> <u>domain,</u> <u>and</u> <u>host</u> parameters are the standard mDNS fields, see documentation on mDNS for
       details.  The <u>txt</u> parameter is for mDNS text fields, and is a standard argv-like array.

       Once  you  have  an  mdns  structure,  you  can  advertise  a  service  on  the   net   with   it   using
       <b>gensio_mdns_add_service2.</b>    That   service   will   continue   to   be   advertised   until   you   call
       <b>gensio_mdns_remove_service</b> on it or your program terminates.   The  <u>domain</u>  and  <u>host</u>  parameters  should
       generally be NULL to take the system defaults.  The <u>txt</u> parameter may be NULL if you don't have any.

       <b>gensio_mdns_add_service2</b>  takes  a  callback, it will be called when the service has been registered, and
       possible with a new name if there was a name conflict.  You may pass in a NULL for the  callback  if  you
       don't care.  The callback <b>parameter</b> <b>can</b> <b>take</b> <b>the</b> <b>following</b> <b>values:</b>

       <u>GENSIO_MDNS_SERVICE_READY</u>
              The service is now registered, and the name is the same as the name you passed in.

       <u>GENSIO_MDNS_SERVICE_READY_NEW_NAME</u>
              The service is now registered, but the name was changed, it will be in the info parameter.

       <u>GENSIO_MDNS_SERVICE_REMOVED</u>
              You  requested  the  service  be  removed, the remove is now complete and the callback will not be
              called again.

       <u>GENSIO_MDNS_SERVICE_ERROR</u>
              An error occurred as part of service registration.

       There is a <b>gensio_mdns_add_service</b> function for backwards compatibility,  it  is  equivalent  to  calling
       <b>gensio_mdns_add_service2</b> with a NULL callback.  Don't use it in new code.

       To  find  services  on the network, you add a watch with <b>gensio_mdns_add_watch.</b>  Any service that matches
       your query will be reported with the callback functions and all fields will be provided in the  callback.
       Once you are done with a watch, you may call <b>gensio_mdns_remove_watch</b> Note that code may still be in mdns
       callbacks  when  the  remove  returns, you have to make sure to wait until the done callback is called to
       know the code is out of all callbacks.  The done callback is optional if you don't care.

       Some MDNS libraries do not support an NULL <b>type</b> for the watch, and some do.  For  portable  code,  always
       specify the watch.  If the library does not support a null <b>type</b> the function will return <b>GE_INCONSISTENT.</b>

       The watch callback state has three possible values:

       <u>GENSIO_MDNS_WATCH_NEW_DATA</u>
              This is a new entry being reported.

       <u>GENSIO_MDNS_WATCH_DATA_GONE</u>
              An entry that was previously reported as gone away.

       <u>GENSIO_MDNS_WATCH_ALL_FOR_NOW</u>
              This  is  called  one time after the watch is created, it reports that all currently known entries
              have been reported.  New ones may be reported in the future, but those will have been  dynamically
              added later.

       In  the watch callback, you must make copies of all the strings and addresses passed to you to keep them.
       Their continued existence is not guaranteed.

       In watches, all of the string fields may be NULL, meaning you want to take anything in that field.  So if
       all the strings are NULL and the interface is -1 and the ipdomain is <u>GENSIO_NETTYPE_UNSPEC</u> you  will  get
       all of the fields.

</pre><h4><b>STRING</b> <b>VALUES</b> <b>FOR</b> <b>WATCHES</b></h4><pre>
       The  string values to the watch add function may use regular expressions.  If the string starts with '%',
       then the data after it is treated as a regular expression and fields are matched against that.   See  the
       <a href="../man7/regex.7.html">regex</a>(7) man page for details.

       Globs are supported on some platforms, but their use is discouraged because they aren't available on some
       platforms.   If the string starts with '@', the the data after it is treated as a standard glob.  See the
       <a href="../man7/glob.7.html">glob</a>(7) man page for details.  An error will be returned if the platform doesn't have glob matching.

       If the string starts with '=', an exact comparison is done with the data after it.

       If the string starts with a-z0-9_ or a space, then an exact string  comparison  is  done,  including  the
       first character.

       The  behavior  of  matching for any other starting character is undefined.  In general, you should always
       use '@', '%', or '=' as the starting character of all your query strings to be sure.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       Zero is returned on success, or a gensio error on failure.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3/gensio_err.3.html">gensio_err</a>(3), <a href="../man3/gensio_os_funcs.3.html">gensio_os_funcs</a>(3), <a href="../man7/regex.7.html">regex</a>(7), <a href="../man7/glob.7.html">glob</a>(7)

                                                   15 Oct 2020                                    <u><a href="../man3/gensio_mdns.3.html">gensio_mdns</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>