<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gnutls_certificate_set_retrieve_function3 - API function</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/gnutls-doc">gnutls-doc_3.8.9-3ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gnutls_certificate_set_retrieve_function3 - API function

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;gnutls/abstract.h&gt;</b>

       <b>void</b>           <b>gnutls_certificate_set_retrieve_function3(gnutls_certificate_credentials_t</b>           <u>cred</u><b>,</b>
       <b>gnutls_certificate_retrieve_function3</b> <b>*</b> <u>func</u><b>);</b>

</pre><h4><b>ARGUMENTS</b></h4><pre>
       gnutls_certificate_credentials_t cred
                   is a <b>gnutls_certificate_credentials_t</b> type.

       gnutls_certificate_retrieve_function3 * func
                   is the callback function

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This function sets a callback to be called in order to retrieve the certificate and OCSP responses to  be
       used  in  the  handshake.   <u>func</u>  will  be  called  only if the peer requests a certificate either during
       handshake or during post-handshake authentication.

       The callback's function prototype is defined in `abstract.h':

       int gnutls_certificate_retrieve_function3(  gnutls_session_t,  const  struct  gnutls_cert_retr_st  *info,
       gnutls_pcert_st   **certs,   unsigned   int   *certs_length,  gnutls_ocsp_data_st  **ocsp,  unsigned  int
       *ocsp_length, gnutls_privkey_t *privkey, unsigned int *flags);

       The info field of the callback contains:
        <u>req_ca_dn</u> which is a list with the CA names that the server considers  trusted.   This  is  a  hint  and
       typically  the  client  should  send  a certificate that is signed by one of these CAs. These names, when
       available, are DER encoded. To get a more meaningful value use the function <b>gnutls_x509_rdn_get()</b>.
        <u>pk_algos</u> contains a list with server's acceptable  public  key  algorithms.   The  certificate  returned
       should support the server's given algorithms.

       The callback should fill-in the following values:

        <u>certs</u> should contain an allocated list of certificates and public keys.
        <u>certs_length</u> is the size of the previous list.
        <u>ocsp</u> should contain an allocated list of OCSP responses.
        <u>ocsp_length</u> is the size of the previous list.
        <u>privkey</u> is the private key.

       If  flags  in  the  callback  are  set  to  <b>GNUTLS_CERT_RETR_DEINIT_ALL</b>  then all provided values must be
       allocated using <b>gnutls_malloc()</b>, and will be released by gnutls; otherwise they will not  be  touched  by
       gnutls.

       The  callback  function  should  set  the  certificate and OCSP response list to be sent, and return 0 on
       success. If no certificates are available, the  <u>certs_length</u> and  <u>ocsp_length</u> should be set to zero.  The
       return  value  (-1) indicates error and the handshake will be terminated. If both certificates are set in
       the credentials and a callback is available, the callback takes predence.

       Raw public-keys: In case raw public-keys are negotiated as  certificate  type,  certificates  that  would
       normally hold the public-key material are not available. In that case,
        <u>certs</u>  contains an allocated list with only the public key. Since there is no certificate, there is also
       no certificate status. Therefore, OCSP information should not be set.

</pre><h4><b>SINCE</b></h4><pre>
       3.6.3

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<a href="mailto:bugs@gnutls.org">bugs@gnutls.org</a>&gt;.
       Home page: https://www.gnutls.org

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright Â© 2001-2023 Free Software Foundation, Inc., and others.
       Copying and distribution of this file, with or without modification, are permitted in any medium  without
       royalty provided the copyright notice and this notice are preserved.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       The  full  documentation  for  <b>gnutls</b>  is  maintained as a Texinfo manual.  If the /usr/share/doc/gnutls/
       directory does not contain the HTML form visit

       https://www.gnutls.org/manual/

gnutls                                                3.8.9         <u><a href="../man3/gnutls_certificate_set_retrieve_function3.3.html">gnutls_certificate_set_retrieve_function3</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>