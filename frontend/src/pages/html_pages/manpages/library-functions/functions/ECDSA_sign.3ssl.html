<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECDSA_size, ECDSA_sign, ECDSA_do_sign, ECDSA_verify, ECDSA_do_verify, ECDSA_sign_setup, ECDSA_sign_ex,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ECDSA_size, ECDSA_sign, ECDSA_do_sign, ECDSA_verify, ECDSA_do_verify, ECDSA_sign_setup, ECDSA_sign_ex,
       ECDSA_do_sign_ex - deprecated low-level elliptic curve digital signature algorithm (ECDSA) functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ecdsa.h&gt;

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        int ECDSA_size(const EC_KEY *eckey);

        int ECDSA_sign(int type, const unsigned char *dgst, int dgstlen,
                       unsigned char *sig, unsigned int *siglen, EC_KEY *eckey);
        ECDSA_SIG *ECDSA_do_sign(const unsigned char *dgst, int dgst_len,
                                 EC_KEY *eckey);

        int ECDSA_verify(int type, const unsigned char *dgst, int dgstlen,
                         const unsigned char *sig, int siglen, EC_KEY *eckey);
        int ECDSA_do_verify(const unsigned char *dgst, int dgst_len,
                            const ECDSA_SIG *sig, EC_KEY* eckey);

        ECDSA_SIG *ECDSA_do_sign_ex(const unsigned char *dgst, int dgstlen,
                                    const BIGNUM *kinv, const BIGNUM *rp,
                                    EC_KEY *eckey);
        int ECDSA_sign_setup(EC_KEY *eckey, BN_CTX *ctx, BIGNUM **kinv, BIGNUM **rp);
        int ECDSA_sign_ex(int type, const unsigned char *dgst, int dgstlen,
                          unsigned char *sig, unsigned int *siglen,
                          const BIGNUM *kinv, const BIGNUM *rp, EC_KEY *eckey);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       See <b><a href="../man3/ECDSA_SIG_new.3.html">ECDSA_SIG_new</a></b>(3) for a description of the <b>ECDSA_SIG</b> object.

       See <b><a href="../man3/i2d_ECDSA_SIG.3.html">i2d_ECDSA_SIG</a></b>(3) and <b><a href="../man3/d2i_ECDSA_SIG.3.html">d2i_ECDSA_SIG</a></b>(3) for information about encoding and decoding ECDSA signatures
       to/from DER.

       All of the functions described below are deprecated. Applications should use the higher level <b>EVP</b>
       interface such as <b><a href="../man3/EVP_DigestSignInit.3.html">EVP_DigestSignInit</a></b>(3) or <b><a href="../man3/EVP_DigestVerifyInit.3.html">EVP_DigestVerifyInit</a></b>(3) instead.

       <b>ECDSA_size()</b> returns the maximum length of a DER encoded ECDSA signature created with the private EC key
       <u>eckey</u>. To obtain the actual signature size use <b><a href="../man3/EVP_PKEY_sign.3.html">EVP_PKEY_sign</a></b>(3) with a NULL <u>sig</u> parameter.

       <b>ECDSA_sign()</b> computes a digital signature of the <u>dgstlen</u> bytes hash value <u>dgst</u> using the private EC key
       <u>eckey</u>. The DER encoded signatures is stored in <u>sig</u> and its length is returned in <u>siglen</u>. Note: <u>sig</u> must
       point to ECDSA_size(eckey) bytes of memory. The parameter <u>type</u> is currently ignored. <b>ECDSA_sign()</b> is
       wrapper function for <b>ECDSA_sign_ex()</b> with <u>kinv</u> and <u>rp</u> set to NULL.

       <b>ECDSA_do_sign()</b> is similar to <b>ECDSA_sign()</b> except the signature is returned as a newly allocated
       <b>ECDSA_SIG</b> structure (or NULL on error). <b>ECDSA_do_sign()</b> is a wrapper function for <b>ECDSA_do_sign_ex()</b> with
       <u>kinv</u> and <u>rp</u> set to NULL.

       <b>ECDSA_verify()</b> verifies that the signature in <u>sig</u> of size <u>siglen</u> is a valid ECDSA signature of the hash
       value <u>dgst</u> of size <u>dgstlen</u> using the public key <u>eckey</u>.  The parameter <u>type</u> is ignored.

       <b>ECDSA_do_verify()</b> is similar to <b>ECDSA_verify()</b> except the signature is presented in the form of a pointer
       to an <b>ECDSA_SIG</b> structure.

       The remaining functions utilise the internal <u>kinv</u> and <u>r</u> values used during signature computation. Most
       applications will never need to call these and some external ECDSA ENGINE implementations may not support
       them at all if either <u>kinv</u> or <u>r</u> is not NULL.

       <b>ECDSA_sign_setup()</b> may be used to precompute parts of the signing operation.  <u>eckey</u> is the private EC key
       and <u>ctx</u> is a pointer to <b>BN_CTX</b> structure (or NULL). The precomputed values or returned in <u>kinv</u> and <u>rp</u> and
       can be used in a later call to <b>ECDSA_sign_ex()</b> or <b>ECDSA_do_sign_ex()</b>.

       <b>ECDSA_sign_ex()</b> computes a digital signature of the <u>dgstlen</u> bytes hash value <u>dgst</u> using the private EC
       key <u>eckey</u> and the optional pre-computed values <u>kinv</u> and <u>rp</u>. The DER encoded signature is stored in <u>sig</u>
       and its length is returned in <u>siglen</u>. Note: <u>sig</u> must point to ECDSA_size(eckey) bytes of memory. The
       parameter <u>type</u> is ignored.

       <b>ECDSA_do_sign_ex()</b> is similar to <b>ECDSA_sign_ex()</b> except the signature is returned as a newly allocated
       <b>ECDSA_SIG</b> structure (or NULL on error).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>ECDSA_size()</b> returns the maximum length signature or 0 on error.

       <b>ECDSA_sign()</b>, <b>ECDSA_sign_ex()</b> and <b>ECDSA_sign_setup()</b> return 1 if successful or 0 on error.

       <b>ECDSA_do_sign()</b> and <b>ECDSA_do_sign_ex()</b> return a pointer to an allocated <b>ECDSA_SIG</b> structure or NULL on
       error.

       <b>ECDSA_verify()</b> and <b>ECDSA_do_verify()</b> return 1 for a valid signature, 0 for an invalid signature and -1 on
       error.  The error codes can be obtained by <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3).

</pre><h4><b>EXAMPLES</b></h4><pre>
       Creating an ECDSA signature of a given SHA-256 hash value using the named curve prime256v1 (aka P-256).
       This example uses deprecated functionality. See "DESCRIPTION".

       First step: create an EC_KEY object (note: this part is <b>not</b> ECDSA specific)

        int ret;
        ECDSA_SIG *sig;
        EC_KEY *eckey;

        eckey = EC_KEY_new_by_curve_name(NID_X9_62_prime256v1);
        if (eckey == NULL)
            /* error */
        if (EC_KEY_generate_key(eckey) == 0)
            /* error */

       Second step: compute the ECDSA signature of a SHA-256 hash value using <b>ECDSA_do_sign()</b>:

        sig = ECDSA_do_sign(digest, 32, eckey);
        if (sig == NULL)
            /* error */

       or using <b>ECDSA_sign()</b>:

        unsigned char *buffer, *pp;
        int buf_len;

        buf_len = ECDSA_size(eckey);
        buffer = OPENSSL_malloc(buf_len);
        pp = buffer;
        if (ECDSA_sign(0, dgst, dgstlen, pp, &amp;buf_len, eckey) == 0)
            /* error */

       Third step: verify the created ECDSA signature using <b>ECDSA_do_verify()</b>:

        ret = ECDSA_do_verify(digest, 32, sig, eckey);

       or using <b>ECDSA_verify()</b>:

        ret = ECDSA_verify(0, digest, 32, buffer, buf_len, eckey);

       and finally evaluate the return value:

        if (ret == 1)
            /* signature ok */
        else if (ret == 0)
            /* incorrect signature */
        else
            /* error */

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       ANSI X9.62, US Federal Information Processing Standard FIPS186-2 (Digital Signature Standard, DSS)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EC_KEY_new.3.html">EC_KEY_new</a></b>(3), <b><a href="../man3/EVP_DigestSignInit.3.html">EVP_DigestSignInit</a></b>(3), <b><a href="../man3/EVP_DigestVerifyInit.3.html">EVP_DigestVerifyInit</a></b>(3), <b><a href="../man3/EVP_PKEY_sign.3.html">EVP_PKEY_sign</a></b>(3) <b><a href="../man3/i2d_ECDSA_SIG.3.html">i2d_ECDSA_SIG</a></b>(3),
       <b><a href="../man3/d2i_ECDSA_SIG.3.html">d2i_ECDSA_SIG</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       All functionality described here was deprecated in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2004-2022 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                   <u><a href="../man3SSL/ECDSA_SIGN.3SSL.html">ECDSA_SIGN</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>