<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>efi_variable_import,  efi_variable_export,  efi_variable_alloc, efi_variable_free, efi_variable_set_name,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libefivar-dev">libefivar-dev_38-3.1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       efi_variable_import,  efi_variable_export,  efi_variable_alloc, efi_variable_free, efi_variable_set_name,
       efi_variable_get_name,     efi_variable_set_guid,      efi_variable_get_guid,      efi_variable_set_data,
       efi_variable_get_data,  efi_variable_set_attributes,  efi_variable_get_attributes, efi_variable_realize -
       utility functions to import and export UEFI variables to files.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;efivar.h&gt;</b>

       <u>typedef</u> <u>struct</u> <u>efi_variable</u> <b>efi_variable_t</b><u>;</u>

       <u>ssize_t</u> <b>efi_variable_import</b>(<u>uint8_t</u> <u>*</u><b>data</b>, <u>size_t</u> <b>size</b>, <u>efi_variable_t</u> <u>**</u><b>var</b>);
       <u>ssize_t</u> <b>efi_variable_export</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>, <u>uint8_t</u> <u>**</u><b>data</b>, <u>size_t</u> <u>*</u><b>size</b>);

       <u>efi_variable_t</u> <u>*</u><b>efi_variable_alloc</b>(<u>void</u>);
       <u>void</u> <b>efi_variable_free</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>, <u>int</u> <b>free_data</b>);

       <u>int</u> <b>efi_variable_set_name</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>, <u>char</u> <u>*</u><b>name</b>);
       <u>char</u> <u>*</u><b>efi_variable_get_name</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>);

       <u>int</u> <b>efi_variable_set_guid</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>, <u>efi_guid_t</u> <u>*</u><b>guid</b>);
       <u>int</u> <b>efi_variable_get_guid</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>, <u>efi_guid_t</u> <u>**</u><b>guid</b>);

       <u>int</u> <b>efi_variable_set_data</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>, <u>uint8_t</u> <u>*</u><b>data</b>, <u>size_t</u> <b>size</b>);
       <u>int</u> <b>efi_variable_get_data</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>, <u>uint8_t</u> <u>**</u><b>data</b>, <u>size_t</u> <u>*</u><b>size</b>);

       <u>#define</u> <b>EFI_VARIABLE_NON_VOLATILE</b> <u>0x0000000000000001</u>
       <u>#define</u> <b>EFI_VARIABLE_BOOTSERVICE_ACCESS</b> <u>0x0000000000000002</u>
       <u>#define</u> <b>EFI_VARIABLE_RUNTIME_ACCESS</b> <u>0x0000000000000004</u>
       <u>#define</u> <b>EFI_VARIABLE_HARDWARE_ERROR_RECORD</b> <u>0x0000000000000008</u>
       <u>#define</u> <b>EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS</b> <u>0x0000000000000010</u>
       <u>#define</u> <b>EFI_VARIABLE_TIME_BASED_AUTHENTICATED_WRITE_ACCESS</b> <u>0x0000000000000020</u>
       <u>#define</u> <b>EFI_VARIABLE_APPEND_WRITE</b> <u>0x0000000000000040</u>
       <u>#define</u> <b>EFI_VARIABLE_HAS_AUTH_HEADER</b> <u>0x0000000100000000</u>
       <u>#define</u> <b>EFI_VARIABLE_HAS_SIGNATURE</b> <u>0x0000000200000000</u>

       <u>int</u> <b>efi_variable_set_attributes</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>, <u>uint64_t</u> <b>attrs</b>);
       <u>int</u> <b>efi_variable_get_attributes</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>, <u>uint64_t</u> <u>*</u><b>attrs</b>);

       <u>int</u> <b>efi_variable_realize</b>(<u>efi_variable_t</u> <u>*</u><b>var</b>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>efi_variable_t</b> is an opaque data type used to store variables in-memory for use with this API.

       <b>efi_variable_import</b>() is used to import raw data read from a file.  This function returns the  amount  of
       data  consumed  with  this variable, and may be used successively, using its return code as an offset, to
       parse a list of variables.  Note that the internal guid, name, and data values are allocated  separately,
       and  must  be  freed either individually or using the <b>free_data</b> parameter of <b>efi_variable_free</b>().  <b>_get</b>()
       accessors for those values return data suitable for freeing individually, except in such  cases  where  a
       <b>_set</b>() accessor has been passed an object already unsuitable for that.

       <b>efi_variable_export</b>() is used to marshall <b>efi_variable_t</b> objects into linear data which can be written to
       a file.  If <b>data</b> or <b>size</b> parameters are not provided, this function will return how much storage a caller
       must  allocate.  Otherwise, <b>efi_variable_export</b>() will use the storage referred to as its buffer; if <b>size</b>
       is smaller than the amount of needed storage , the buffer  will  not  be  modified,  and  the  difference
       between the needed space and <b>size</b> will be returned.

       <b>efi_variable_alloc</b>()  is  used  to  allocate  an  unpopulated  <b>efi_variable_t</b>  object suitable to be used
       throughout this API.  <b>efi_variable_free</b>() is used to free an <b>efi_variable_t</b> object, and if  <b>free_data</b>  is
       nonzero, to free its constituent data.

       Each pair of <b>_set</b>() and <b>_get</b>() accessors have essentially the same semantics.  Neither operation performs
       any memory management, including freeing of previously set values or values set by <b>efi_variable_import</b>(),
       and  so in some cases it may be necessary to use a <b>_get</b>() accessor to retrieve an object to be freed.  In
       cases where no value has been set, <b>_get</b>() accessors will set <b>errno</b> to <b>ENOENT</b> and return a negative  value
       or NULL.

       <b>efi_variable_set_name</b>() and <b>efi_variable_get_name</b>() are used to set and retrieve the name of the variable
       referred to by the <b>efi_variable_t</b> object.

       <b>efi_variable_set_guid</b>() and <b>efi_variable_get_guid</b>() are used to set and retrieve the Vendor GUID value of
       the variable referred to by the <b>efi_variable_t</b> object.

       <b>efi_variable_set_data</b>()  and  <b>efi_variable_get_data</b>()  are  used  to  set  and retrieve an <b>efi_variable_t</b>
       object's variable data.

       <b>efi_variable_set_attributes</b>()  and  <b>efi_variable_get_attributes</b>  are  used  to  set   and   retrieve   an
       <b>efi_variable_t</b>    object's    attributes.     All    bits    except    <b>EFI_VARIABLE_HAS_AUTH_HEADER</b>   and
       <b>EFI_VARIABLE_HAS_SIGNATURE</b> are defined  in  the  UEFI  specification  and  should  be  used  accordingly.
       <b>EFI_VARIABLE_HAS_AUTH_HEADER</b>  should  be used by applications to track whether the variable data contents
       include an authentication header.  <b>EFI_VARIABLE_HAS_SIGNATURE</b> should be used by applications to track  if
       the    variable's    data    contents   include   a   signature,   and   should   not   be   set   unless
       <b>EFI_VARIABLE_HAS_AUTH_HEADER</b> is also set.  These attributes are used to track if an exported variable  is
       in  a  state  of  partial  construction, for example if an authenticated variable has been created but is
       intended to be signed at a later date.

       <b>efi_variable_realize</b>() is a convenience function to set or append a UEFI variable on the  running  system
       from   an   <b>efi_variable_t</b>   object.   its  return  codes  are  the  same  as  <b><a href="../man3/efi_append_variable.3.html">efi_append_variable</a></b>(3)  if
       EFI_VARIABLE_APPEND_WRITE is set, and <b>efi_set_variable</b>() if that bit is not set.   Additionally,  in  the
       case  that any of the authentication bits are set, <b>efi_variable_realize</b>() will return error and set <b>errno</b>
       to <b>EPERM</b> unless both <b>EFI_VARIABLE_HAS_AUTH_HEADER</b> and <b>EFI_VARIABLE_HAS_SIGNATURE</b> attribute bits are  been
       set.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>efi_variable_import</b>()  returns 0 on success, and -1 on failure.  In cases where it cannot parse the data,
       <b>errno</b> will be set to <b>EINVAL</b>.  In cases where memory has been exhausted, <b>errno</b> will be set to <b>ENOMEM</b>.

       <b>efi_variable_export</b>() returns the size of the buffer data on success, or a negative value in the case  of
       an  error.   If  <b>data</b>  or  <b>size</b> parameters are not provided, this function will return how much storage a
       caller must allocate.  Otherwise, this function will use the storage provided in <b>data</b>; if  <b>size</b>  is  less
       than  the  needed space, the buffer will not be modified, and the return value will be the difficiency in
       size.

       <b>efi_variable_alloc</b>() returns a newly allocated <b>efi_variable_t</b> object, but does not peform any  allocation
       for  that object's <b>name</b>, <b>guid</b>, or <b>data</b>.  In the case that memory is exhausted, <b>NULL</b> will be returned, and
       <b>errno</b> will be set to <b>ENOMEM</b>.

       <b>efi_variable_get_name</b>() returns  a  pointer  the  NUL-terminated  string  containing  the  <b>efi_variable_t</b>
       object's name information.

       <b>efi_variable_set_name</b>(),   <b>efi_variable_set_guid</b>(),   <b>efi_variable_get_guid</b>(),   <b>efi_variable_set_data</b>(),
       <b>efi_variable_get_data</b>(),      <b>efi_variable_set_attributes</b>(),      <b>efi_variable_get_attributes</b>(),      and
       <b>efi_variable_realize</b>() return 0 on success and -1 on error.

</pre><h4><b>AUTHORS</b></h4><pre>
       Peter Jones &lt;<a href="mailto:pjones@redhat.com">pjones@redhat.com</a>&gt;

                                                 Thu Nov 11 2014                               <u><a href="../man3/EFI_VARIABLE_T.3.html">EFI_VARIABLE_T</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>