<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>__pmProcessPipe, __pmProcessPipeClose - support for process execution at the end of a pipe</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpcp3-dev">libpcp3-dev_6.3.8-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>__pmProcessPipe</b>, <b>__pmProcessPipeClose</b> - support for process execution at the end of a pipe

</pre><h4><b>C</b> <b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>"pmapi.h"</b>
       <b>#include</b> <b>"libpcp.h"</b>

       <b>int</b> <b>__pmProcessPipe(__pmExecCtl_t</b> <b>**</b><u>handle</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>type</u><b>,</b> <b>int</b> <u>toss</u><b>,</b> <b>FILE</b> <b>**</b><u>fp</u><b>);</b>
       <b>int</b> <b>__pmProcessPipeClose(FILE</b> <b>*</b><u>fp</u><b>);</b>

       <b>cc</b> <b>...</b> <b>-lpcp</b>

</pre><h4><b>CAVEAT</b></h4><pre>
       This documentation is intended for internal Performance Co-Pilot (PCP) developer use.

       These  interfaces  are  not part of the PCP APIs that are guaranteed to remain fixed across releases, and
       they may not work, or may provide different semantics at some point in the future.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Within the libraries and applications of the Performance Co-Pilot (PCP)  these  routines  are  provide  a
       convenient  and  safe  alternative to <b><a href="../man3/popen.3.html">popen</a></b>(3) and <b><a href="../man3/pclose.3.html">pclose</a></b>(3) for executing commands in a separate process
       that is connected to the caller by a pipe.

       Setting up the command and arguments is fully documented in <b><a href="../man3/__pmProcessAddArg.3.html">__pmProcessAddArg</a></b>(3) and is identical to  the
       procedure used to setup <b><a href="../man3/__pmProcessExec.3.html">__pmProcessExec</a></b>(3).

       Once  all  the  command  name  and arguments have been registered calling <b>__pmProcessPipe</b> uses a <b><a href="../man2/pipe.2.html">pipe</a></b>(2),
       <b><a href="../man2/fork.2.html">fork</a></b>(2) and <b><a href="../man2/execvp.2.html">execvp</a></b>(2) sequence to execute the command.

       The <u>type</u> argument needs to be <b>``r''</b> to read from the pipe, else <b>``w''</b> to write to the pipe.

       The argument <u>toss</u> may be used to assign some or all of the  standard  I/O  streams  for  the  command  to
       <u>/dev/null</u>  - specifically <u>toss</u> is either <b>PM_EXEC_TOSS_NONE</b> to keep all I/O streams the same as the parent
       process, else the bit-wise or of <b>PM_EXEC_TOSS_STDIN</b> and/or <b>PM_EXEC_TOSS_STDOUT</b> and/or <b>PM_EXEC_TOSS_STDERR</b>
       to reassign <b>stdin</b>, <b>stdout</b> and <b>stderr</b> respectively.  <b>PM_EXEC_TOSS_ALL</b> is a convenience macro equivalent to
       <b>PM_EXEC_TOSS_STDIN</b> <b>|</b> <b>PM_EXEC_TOSS_STDOUT</b> <b>|</b> <b>PM_EXEC_TOSS_STDERR</b>.

       Obviously  some  combinations  of  argument  values  make  no  sense,  e.g.  <u>type</u>  equal  to  <b>``r''</b>   and
       <b>PM_EXEC_TOSS_STDOUT</b> set in <u>toss</u> or <u>type</u> equal to <b>``w''</b> and <b>PM_EXEC_TOSS_STDIN</b> set in <u>type</u>.

       <b>__pmProcessPipe</b> returns a standard I/O stream for the pipe via the <u>fp</u> argument.

       Once the caller determines all the work has been done, <b>__pmProcessPipeClose</b> should be called.

       Nested calling of <b><a href="../man3/__pmProcessExec.3.html">__pmProcessExec</a></b>(3) and/or <b>__pmProcessPipe</b> is not allowed.  Once <b><a href="../man3/__pmProcessAddArg.3.html">__pmProcessAddArg</a></b>(3) is
       called  with  <u>handle</u>  set to <b>NULL</b> to start the registration and execution sequence any attempt to start a
       second  registration  sequence  will  be  blocked  until  the  first  one   is   completed   by   calling
       <b><a href="../man3/__pmProcessExec.3.html">__pmProcessExec</a></b>(3) or <b>__pmProcessPipe</b>.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       If  successful <b>__pmProcessPipe</b> returns 0.  Other conditions are rare (e.g. memory allocation failure) and
       are indicated by a return value that can be decoded using <b><a href="../man3/pmErrStr.3.html">pmErrStr</a></b>(3).

       The return status from <b>__pmProcessPipeClose</b> is a little more complicated.  If the command completes  with
       an  exit status of 0, the return value is 0.  Return values less than 0 indicate a more serious error and
       the value can be decoded using <b><a href="../man3/pmErrStr.3.html">pmErrStr</a></b>(3).  If the command was executed, but did not exit with status of
       0 then the return value is an encoding of the <b><a href="../man2/waitpid.2.html">waitpid</a></b>(2) status as follows:  2000  if  something  unknown
       went  wrong, else if 1000 + signal number of the command was killed or stopped by a signal, else the exit
       status of the command.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/execvp.2.html">execvp</a></b>(2),  <b><a href="../man2/fork.2.html">fork</a></b>(2),  <b><a href="../man2/pclose.2.html">pclose</a></b>(2),  <b><a href="../man2/pipe.2.html">pipe</a></b>(2),   <b><a href="../man2/popen.2.html">popen</a></b>(2),   <b><a href="../man3/__pmProcessAddArg.3.html">__pmProcessAddArg</a></b>(3),   <b><a href="../man3/__pmProcessExec.3.html">__pmProcessExec</a></b>(3)   and
       <b><a href="../man3/waitpid.3.html">waitpid</a></b>(3).

Performance Co-Pilot                                   PCP                                      <u><a href="../man3/PMPROCESSPIPE.3.html">PMPROCESSPIPE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>