<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nfstest.file_io - File I/O module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/nfstest">nfstest_3.2-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nfstest.file_io - File I/O module

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Provides an interface to create and manipulate files of different types.  The arguments allow running for
       a  specified period of time as well as running multiple processes. Each process modifies a single file at
       a time and the file name space is different for each process so  there  are  no  collisions  between  two
       different processes modifying the same file.

       File types:
         - Regular file
         - Hard link
         - Symbolic link

       File operations:
         - Open (create or re-open)
         - Open downgrade
           This is done by opening the file for read and write, then the file is
           opened again as read only and finally closing the read and write file
           descriptor
         - Read (sequential or random access)
         - Write (sequential or random access)
         - Remove
         - Rename
         - Truncate (path or file descriptor)
         - Readdir
         - Lock
         - Unlock
         - Tlock

</pre><h4><b>CLASSES</b></h4><pre>
   <b>class</b> <b>FileIO(baseobj.BaseObj)</b>
       FileIO object

       Usage:
           from nfstest.file_io import FileIO

           # Instantiate FileIO object given top level directory
           x = FileIO(datadir="/tmp/data")

           # Run workload creating the top level directory if necessary
           x.run()

       <b>Methods</b> <b>defined</b> <b>here:</b>
       ---------------------

       <b>__del__(self)</b>
       Destructor

       <b>__init__(self,</b> <b>**kwargs)</b>
       Constructor

       Initialize object's private data

              <b>datadir:</b>
                     Top level directory where files will be created,
                     it will be created if it does not exist

              <b>seed:</b>  Seed to initialized the random number generator
                     [default: automatically generated]

              <b>nprocs:</b>
                     Number of processes to use [default: 1]

              <b>runtime:</b>
                     Run time [default: 0 (indefinitely)]

              <b>verbose:</b>
                     Verbose level: none|info|debug|dbg1-7|all [default: 'none']

              <b>exiterr:</b>
                     Exit on first error [default: False]

              <b>read:</b>  Read file percentage [default: 40.0]

              <b>write:</b> Write file percentage [default: 40.0]

              <b>rdwr:</b>  Read/write file percentage [default: 20.0]

              <b>randio:</b>
                     Random file access percentage [default: 50.0]

              <b>iodelay:</b>
                     Seconds to delay I/O operations [default: 0.0]

              <b>direct:</b>
                     Use direct I/O [default: False]

              <b>rdwronly:</b>
                     Use read and write only, no rename, remove, etc. [default: False]

              <b>create:</b>
                     Create file percentage [default: 5.0]

              <b>odgrade:</b>
                     Open downgrade percentage [default: 5.0]

              <b>osync:</b> Open file with O_SYNC [default: 10.0]

              <b>fsync:</b> Percentage of fsync after write [default: 2.0]

              <b>rename:</b>
                     Rename file percentage [default: 5.0]

              <b>remove:</b>
                     Remove file percentage [default: 5.0]

              <b>trunc:</b> Truncate file percentage [default: 2.0]

              <b>ftrunc:</b>
                     Truncate opened file percentage [default: 2.0]

              <b>link:</b>  Create hard link percentage [default: 1.0]

              <b>slink:</b> Create symbolic link percentage [default: 0.2]

              <b>readdir:</b>
                     List contents of directory percentage [default: 0.5]

              <b>lock:</b>  Lock file percentage [default: 20.0]

              <b>unlock:</b>
                     Unlock file percentage [default: 80.0]

              <b>tlock:</b> Lock test percentage [default: 20.0]

              <b>lockfull:</b>
                     Lock full file percentage [default: 50.0]

              <b>minfiles:</b>
                     Minimum number of files to create before any file operation
                     is executed [default: 10]

              <b>fsizeavg:</b>
                     File size average [default: 1m]

              <b>fsizedev:</b>
                     File size standard deviation [default: 256k]

              <b>rsize:</b> Read block size [default: 64k]

              <b>rsizedev:</b>
                     Read block size standard deviation [default: 8k]

              <b>wsize:</b> Write block size [default: 64k]

              <b>wsizedev:</b>
                     Write block size standard deviation [default: 8k]

              <b>sizemult:</b>
                     Size multiplier [default: 1.0]

              <b>createlog:</b>
                     Create log file [default: False]

              <b>createlogs:</b>
                     Create a log file for each process [default: False]

              <b>logdir:</b>
                     Log directory [default: '<a href="file:/tmp">/tmp</a>']

       <b>get_mountpoint(self)</b>
       Get mount point from data directory

       <b>run(self)</b>
       Main function where all processes are started

       <b>run_process(self,</b> <b>tid=0)</b>
       Main loop for each process

   <b>class</b> <b>FileObj(baseobj.BaseObj)</b>
       Base class so objects will inherit the methods providing the string
       representation of the object and a simple debug printing and logging
       mechanism.

       Usage:
           from baseobj import BaseObj

           # Named arguments
           x = BaseObj(a=1, b=2)

           # Dictionary argument
           x = BaseObj({'a':1, 'b':2})

           # Tuple arguments: first for keys and second for the values
           x = BaseObj(['a', 'b'], [1, 2])

           # All of the above will create an object having two attributes:
           x.a = 1 and x.b = 2

           # Add attribute name, this will be the only attribute to be displayed
           x.set_attrlist("a")

           # Add list of attribute names to be displayed in that order
           x.set_attrlist(["a", "b"])

           # Set attribute with ordered display rights
           x.set_attr("a", 1)
           # This is the same as
           setattr(x, "a", 1) or x.a = 1
           x.set_attrlist("a")

           # Set attribute with switch duplicate
           # The following creates an extra attribute "switch" with
           # the same value as attribute "a":
           #   x.a == x.switch
           #   x.a is x.switch
           x.set_attr("a", 1, switch=True)

           # Make the current object flat by allowing all the attributes
           # for the new attribute to be accessed directly by the current
           # object so the following is True:
           #   x.d == x.c.d
           x.set_attr("c", BaseObj(d=11, e=22), switch=True)

           # Set the comparison attribute so x == x.a is True
           x.set_eqattr("a")

           # Set verbose level of object's string representation
           x.debug_repr(level)

           # Set string format for verbose level 1
           x.set_strfmt(1, "arg1:{0}")
           # In the above example the first positional argument is "a"
           # so the str(x) gives "arg1:1"

           # Set attribute shared by all instances
           # If a global or shared attribute is set on one instance,
           # all other instances will have access to it:
           #   y = BaseObj(d=2, e=3)
           # then the following is true
           #   x.g == y.g
           #   x.g is y.g
           x.set_global("g", 5)

           # Set level mask to display all debug messages matching mask
           <a href="../man0xFF/x.debug_level.0xFF.html">x.debug_level</a>(0xFF)

           # Add a debug mapping for mask 0x100
           x.debug_map(0x100, 'opts', "OPTS: ")

           # Set global indentation to 4 spaces for dprint
           <a href="../man4/x.dindent.4.html">x.dindent</a>(4)

           # Set global indentation to 4 spaces for displaying objects
           <a href="../man4/x.sindent.4.html">x.sindent</a>(4)

           # Set global truncation to 64 for displaying string objects
           <a href="../man64/x.strsize.64.html">x.strsize</a>(64)

           # Do not display timestamp for dprint messages
           x.tstamp(enable=False)

           # Change timestamp format to include the date
           x.tstamp(fmt="{0:date:%Y-%m-%d %H:%M:%S.%q} ")

           # Get timestamp if enabled, else return an empty string
           out = x.timestamp()

           # Open log file
           x.open_log(logfile)

           # Close log file
           x.close_log()

           # Write data to log file
           x.write_log(data)

           # Format the given arguments
           out = x.format("{0:x} - {1}", 1, "hello")

           # Format the object attributes set by set_attrlist()
           out = x.format("{0:x} - {1}")

           # Print debug message only if OPTS bitmap matches the current
           # debug level mask
           x.dprint("OPTS", "This is an OPTS debug message")

   <b>class</b> <b>TermSignal(builtins.Exception)</b>
       Exception to be raised on SIGTERM signal

</pre><h4><b>FUNCTIONS</b></h4><pre>
       <b>stop_handler(signum,</b> <b>frame)</b>
       Signal handler to catch SIGTERM and allow for graceful termination
       of subprocesses

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/baseobj.3.html">baseobj</a>(3),</b> <b><a href="../man3/formatstr.3.html">formatstr</a>(3)</b>

</pre><h4><b>BUGS</b></h4><pre>
       No known bugs.

</pre><h4><b>AUTHOR</b></h4><pre>
       Jorge Mora (<a href="mailto:mora@netapp.com">mora@netapp.com</a>)

NFStest 3.2                                       21 March 2023                                       <u><a href="../man3/FILE_IO.3.html">FILE_IO</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>