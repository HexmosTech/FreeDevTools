<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test2::Harness::Log::CoverageAggregator - Module for aggregating coverage data from a stream of events.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtest2-harness-perl">libtest2-harness-perl_1.000158-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Test2::Harness::Log::CoverageAggregator - Module for aggregating coverage data from a stream of events.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module takes a stream of events and produces aggregated coverage data.

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Test2::Harness::Log::CoverageAggregator;

           my $agg = Test2::Harness::Log::CoverageAggregator-&gt;new();

           while (my $e = $log-&gt;next_event) {
               $agg-&gt;process_event($e);
           }

           # Get a structure like { source_file =&gt; { source_method =&gt; $touched_count, ... }, ...}
           my $touched_source = $agg-&gt;touched;

           # Get a structure like
           # {
           #     files =&gt; {total =&gt; 5,  tested =&gt; 2},
           #     subs  =&gt; {total =&gt; 20, tested =&gt; 12},
           #     untested =&gt; {files =&gt; \@file_list, subs =&gt; {file =&gt; \@sub_list, ...}},
           # }
           my $metrics = $agg-&gt;metrics;

</pre><h4><b>METHODS</b></h4><pre>
   <b>IMPLEMENTABLE</b> <b>IN</b> <b>SUBLCASSES</b>
       If you implement these in a subclass they will be called for you at the proper times, making subclassing
       much easier. In most cases you can avoid overriding <b>process_event()</b>.

       $agg-&gt;start_test($test, $event)
           This is called once per test when it starts.

           <b>Note:</b>  If  a  test  is  run more than once (re-run) it will start and stop again for each re-run. The
           event is also provided as an argument so that you can check for a try-id or similar in the event that
           re-runs matter to you.

       $agg-&gt;stop_test($test, $event)
           This is called once per test when it stops.

           <b>Note:</b> If a test is run more than once (re-run) it will start and stop  again  for  each  re-run.  The
           event is also provided as an argument so that you can check for a try-id or similar in the event that
           re-runs matter to you.

       $agg-&gt;record_coverage($test, $coverage_data, $event)
           This is called once per coverage event (there can be several in a test, specially if it forks or uses
           threads).

           In  most cases you probably want to leave this unimplemented and implement the touch() method instead
           of iterating over the coverage structure yourself.

       $agg-&gt;touch(source =&gt; $file, sub =&gt; $sub, test =&gt; $test, manager_data =&gt; $mdata, event =&gt; $event)
           Every touch applied to a source file (and sub) will trigger this method call.

           source =&gt; $file
               The source file that was touched

           sub =&gt; $sub
               The source subroutine that was touched. <b>Note:</b> This may be '&lt;&gt;' if the source file was opened  via
               open() or '*' if code outside of a subroutine was executed by the test.

           test =&gt; $test
               The test file that did the touching.

           manager_data =&gt; $mdata
               If  the  test  file makes use of a source manager to attach extra data to coverage, this is where
               that data will be. A good example would be test suites that use tools similar to  Test::Class  or
               Test::Class::Moose where all tests are run in methods and you want to track what test method does
               the touching. Please note that this level of coverage tracking is not automatic.

           event =&gt; $event
               The full event being processed.

   <b>PUBLIC</b> <b>API</b>
       $agg-&gt;process_event($event)
           Process the event, aggregating any coverage info it may contain.

       $touched = $add-&gt;<b>touched()</b>
           Returns  the following structure, which tells you how many times a specific source file's subroutines
           were called. There are also "special" subroutines '&lt;&gt;' and '*' which mean "file was opened via  open"
           and "code outside of a subroutine".

               {
                   source_file =&gt; {
                       source_method =&gt; $touched_count,
                       ...
                   },
                   ...
               }

       $metrics = $agg-&gt;<b>build_metrics()</b>
       $metrics = $agg-&gt;build_metrics(exclude_private =&gt; $BOOL)
           Will build metrics, and include them in the output from "$agg-&gt;coverage()" next time it is called.

           The  "exclude_private"  option,  when  set  to  true,  will  exclude  any  method that beings with an
           underscore from the coverage metrics and untested sub list.

           Metrics:

               {
                   files =&gt; {total =&gt; 20, tested =&gt; 18},
                   subs  =&gt; {total =&gt; 80, tested =&gt; 70},

                   untested =&gt; {
                       files =&gt; \@file_list,
                       subs =&gt; {
                           file =&gt; \@sub_list,
                           ...
                       }
                   },
               }

</pre><h4><b>SOURCE</b></h4><pre>
       The source code repository for Test2-Harness can be found at <u><a href="http://github.com/Test-More/Test2-Harness/">http://github.com/Test-More/Test2-Harness/</a></u>.

</pre><h4><b>MAINTAINERS</b></h4><pre>
       Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;

</pre><h4><b>AUTHORS</b></h4><pre>
       Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020 Chad Granum &lt;<a href="mailto:exodist7@gmail.com">exodist7@gmail.com</a>&gt;.

       This program is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself.

       See <u><a href="http://dev.perl.org/licenses/">http://dev.perl.org/licenses/</a></u>

perl v5.40.1                                       2025-05-23              <u>Test2::<a href="../man3pm/Harness...erageAggregator.3pm.html">Harness...erageAggregator</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>