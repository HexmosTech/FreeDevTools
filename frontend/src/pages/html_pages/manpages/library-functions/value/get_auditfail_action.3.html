<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>get_auditfail_action - Get failure_action tunable value</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libaudit-dev">libaudit-dev_4.0.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       get_auditfail_action - Get failure_action tunable value

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;libaudit.h&gt;

       int <b>get_auditfail_action</b>(auditfail_t *<u>failmode</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  function  gets  the failure_action tunable value stored in <b><a href="file:/etc/libaudit.conf">/etc/libaudit.conf</a></b>. <b>get_auditfail_action</b>
       should be called after an <b>audit_open</b> call returns an error to see what action the admin prefers.

       The failure_action value found in <b><a href="file:/etc/libaudit.conf">/etc/libaudit.conf</a></b> is copied into the <u>failmode</u> argument  upon  function
       return.   This  value  should  then be used by the calling application to determine what action should be
       taken when the audit subsystem is unavailable.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Upon success, <b>get_auditfail_action</b> returns a zero, and the <u>failmode</u> argument will hold the failure_action
       value.  The possible values for failure_action are: FAIL_IGNORE (0),  FAIL_LOG  (1),  and  FAIL_TERMINATE
       (2). Upon failure, <b>get_auditfail_action</b> returns a return code of one.

</pre><h4><b>ERRORS</b></h4><pre>
       An  error is returned if there is an error reading <b><a href="file:/etc/libaudit.conf">/etc/libaudit.conf</a></b> or if the failure_action tunable is
       not found in the file.

</pre><h4><b>EXAMPLES</b></h4><pre>
              /* Sample code */
              auditfail_t failmode;

              if ((fd = audit_open() ) &lt; 0 ) {
                   fprintf (stderr, "Cannot open netlink audit socket");

                   /* Get the failure_action */
                   if ((rc = get_auditfail_action(&amp;failmode)) == 0) {
                       if (failmode == FAIL_LOG)
                            fprintf (stderr, "Audit subsystem unavailable");
                       else if (failmode == FAIL_TERMINATE)
                            exit (1);
                       /* If failmode == FAIL_IGNORE, do nothing */
                   }
              }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/audit_open.3.html">audit_open</a></b>(3), <b><a href="../man8/auditd.8.html">auditd</a></b>(8).

</pre><h4><b>AUTHOR</b></h4><pre>
       Lisa M. Smith.

Linux 2.7                                           2006-7-10                            <u><a href="../man3/GET_AUDITFAIL_ACTION.3.html">GET_AUDITFAIL_ACTION</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>