<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>audit_encode_nv_string - encode a name/value pair in a string</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libaudit-dev">libaudit-dev_4.0.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       audit_encode_nv_string - encode a name/value pair in a string

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;libaudit.h&gt;</b>

       <b>char</b> <b>*audit_encode_nv_string(const</b> <b>char</b> <b>*name,</b> <b>const</b> <b>char</b> <b>*value,</b> <b>unsigned</b> <b>int</b> <b>vlen)</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  function  is  used  to encode a name/value pair. This should be used on any field being logged that
       potentially contains a space, a double-quote, or a control character. Any value containing those have  to
       be  specially  encoded  for  the  auparse  library  to correctly handle the value. The encoding method is
       designed to prevent log injection attacks where malicious values could cause parsing errors.

       To use this function, pass the name string and value strings on their respective arguments. If the  value
       is  likely  to  have  a  NUL value embedded within it, you will need to pass a value length that tells in
       bytes how big the value is. Otherwise, you can pass a 0 for vlen and the function will simply use  strlen
       against  the  value  pointer.  Also  be aware that the name of the field will cause auparse to do certain
       things when interpreting the value. If the name is uid, a user id value in decimal is expected. Make sure
       that well known names are used for their intended purpose or that there is no chance  of  name  collision
       with something new.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Returns a freshly malloc'ed string that the caller must free or NULL on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/audit_log_user_message.3.html">audit_log_user_message</a></b>(3),         <b><a href="../man3/audit_log_user_comm_message.3.html">audit_log_user_comm_message</a></b>(3),         <b><a href="../man3/audit_log_user_avc_message.3.html">audit_log_user_avc_message</a></b>(3),
       <b><a href="../man3/audit_log_semanage_message.3.html">audit_log_semanage_message</a></b>(3).

</pre><h4><b>AUTHOR</b></h4><pre>
       Steve Grubb

Red Hat                                             Oct 2010                           <u><a href="../man3/AUDIT_ENCODE_NV_STRING.3.html">AUDIT_ENCODE_NV_STRING</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>