<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catmandu::Fix::lookup_in_store - change the value of a HASH key or ARRAY index by looking up its value in</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcatmandu-perl">libcatmandu-perl_1.2024-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Catmandu::Fix::lookup_in_store - change the value of a HASH key or ARRAY index by looking up its value in
       a store

</pre><h4><b>SYNOPSIS</b></h4><pre>
          # Lookup in an SQLLite database
          lookup_in_store(foo.bar, DBI, data_source: "dbi:SQLite:path/data.sqlite")

          # Lookup in a MongoDB database
          lookup_in_store(foo.bar, MongoDB, database_name: lookups, bag: mydata)

          # Lookup in a MongoDB database, using the default bag and a default value when nothing found
          lookup_in_store(foo.bar, MongoDB, database_name: lookups, default: 'default value')

          # Lookup in a MongoDB database, using the default bag and delete the foo.bar field when nothing found
          lookup_in_store(foo.bar, MongoDB, database_name: lookups, delete: 1)

          # Or, a much faster option: use a named store in a catmandu.yml file
          #
          # store:
          #  mydbi:
          #    package: DBI
          #    options:
          #      data_source: "dbi:SQLite:path/data.sqlite"
          #  mymongo:
          #    package: MongoDB
          #    options:
          #      database_name: lookups
          lookup_in_store(foo.bar, mydbi)
          lookup_in_store(foo.bar, mymongo, bag: mydata)
          lookup_in_store(foo.bar, mymongo, default: 'default value')
          lookup_in_store(foo.bar, mymongo, delete: 1)

</pre><h4><b>DESCRIPTION</b></h4><pre>
   <b>lookup_in_store(PATH,STORE[,store_param:</b> <b>store_val,</b> <b>...][,bag:</b> <b>bag_name][,delete:1][,default:value])</b>
       Use the lookup_in_store fix to match a field in a record to the "_id" field in a Catmandu::Store of
       choice.  For instance, if a Catmandu::Store contains these records:

           ---
           _id: water
           fr: l'eau
           de: wasser
           en: water
           nl: water
           ---
           _id: tree
           fr: arbre
           de: baum
           en: tree
           nl: boom

       And you data contains these fields:

           ---
           _id: 001
           tag: tree
           ---
           _id: 002
           tag: water

       Then, the fix below will lookup a tag in the Catmandu::Store and replace it with the database value:

           lookup_in_store(tag, DBI, data_source: "dbi:SQLite:path/data.sqlite")

       The resulting data will contain:

           ---
           _id: 001
           tag:
             _id: tree
             fr: arbre
             de: baum
             en: tree
             nl: boom
           ---
           _id: 002
           tag:
             _id: water
             fr: l'eau
             de: wasser
             en: water
             nl: water

</pre><h4><b>DATABASE</b> <b>CONNECTIONS</b></h4><pre>
       For every call to a "lookup_in_store" a new database connection is created. It is much more effient to
       used named stores in a "catmandu.yml" file. This file needs to contain all the connection parameters to
       the database. E.g.

           store:
              mystore:
                package: MongoDB
                options:
                   database_name: mydata

       The  "catmandu.yml" file should be available in the same directory as where the "catmandu" command is
       executed. Or, this directory can be set with the "-L" option:

           $ catmandu -L /tmp/path convert ...

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Catmandu::Fix, Catmandu::Store , Catmandu::Fix::add_to_store

perl v5.40.0                                       2025-01-17                <u>Catmandu::Fix::<a href="../man3pm/lookup_in_store.3pm.html">lookup_in_store</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>