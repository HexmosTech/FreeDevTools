<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>diameter_tcp - Diameter transport over TCP.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/erlang-manpages">erlang-manpages_24.2.1+dfsg-1ubuntu0.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       diameter_tcp - Diameter transport over TCP.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  module implements diameter transport over TCP using <a href="../man3erl/gen_tcp.3erl.html">gen_tcp</a>(3erl). It can be specified as the value
       of a <u>transport_module</u> option to diameter:add_transport/2  and  implements  the  behaviour  documented  in
       <a href="../man3erl/diameter_transport.3erl.html">diameter_transport</a>(3erl). TLS security is supported, either as an upgrade following capabilities exchange
       or at connection establishment.

       Note  that  the ssl application is required for TLS and must be started before configuring TLS capability
       on diameter transports.

</pre><h4><b>EXPORTS</b></h4><pre>
       <b>start({Type,</b> <b>Ref},</b> <b>Svc,</b> <b>[Opt])</b> <b>-&gt;</b> <b>{ok,</b> <b>Pid}</b> <b>|</b> <b>{ok,</b> <b>Pid,</b> <b>[LAddr]}</b> <b>|</b> <b>{error,</b> <b>Reason}</b>

              Types:

                 Type = connect | accept
                 Ref = diameter:transport_ref()
                 Svc = #diameter_service{}
                 Opt = OwnOpt | SslOpt | TcpOpt
                 Pid = pid()
                 LAddr = inet:ip_address()
                 Reason = term()
                 OwnOpt = {raddr, inet:ip_address()} | {rport, integer()} | {accept, Match} | {port,  integer()}
                 |  {fragment_timer,  infinity  |  0..16#FFFFFFFF}  |  {message_cb,  diameter:eval()} | {sender,
                 boolean()}
                 SslOpt = {ssl_options, true | list()}
                 TcpOpt = term()
                 Match = inet:ip_address() | string() | [Match]

              The start function required by <a href="../man3erl/diameter_transport.3erl.html">diameter_transport</a>(3erl).

              Options <u>raddr</u> and <u>rport</u> specify the remote address and port for a connecting transport and are not
              valid for a listening transport.

              Option <u>accept</u> specifies remote addresses for  a  listening  transport  and  is  not  valid  for  a
              connecting  transport.  If  specified,  a  remote address that does not match one of the specified
              addresses causes the connection to be aborted. Multiple <u>accept</u> options can be specified. A string-
              valued <u>Match</u> that does not parse as an address is interpreted as a regular expression.

              Option <u>ssl_options</u> must be specified for a transport that should support  TLS:  a  value  of  <u>true</u>
              results  in  a  TLS  handshake  immediately  upon  connection establishment while <u>list()</u> specifies
              options to be passed to ssl:connect/2 or ssl:handshake/2 after capabilities  exchange  if  TLS  is
              negotiated.

              Option  <u>fragment_timer</u>  specifies  the timeout, in milliseconds, of a timer used to flush messages
              from the incoming byte stream even if the number of bytes indicated in the Message Length field of
              its Diameter Header have not yet been accumulated: such a message is received over  the  transport
              interface  after  two  successive  timeouts without the reception of additional bytes. Defaults to
              1000.

              Option <u>sender</u> specifies whether or not to use a dedicated process for sending  outgoing  messages,
              which  avoids the possibility of send blocking reception. Defaults to <u>false</u>. If set to <u>true</u> then a
              <u>message_cb</u> that avoids the possibility of messages being queued  in  the  sender  process  without
              bound should be configured.

              Option <u>message_cb</u> specifies a callback that is invoked on incoming and outgoing messages, that can
              be  used  to implement flow control. It is applied to two arguments: an atom indicating the reason
              for the callback (<u>send</u>, <u>recv</u>, or <u>ack</u>  after  a  completed  send),  and  the  message  in  question
              (binary()  on  <u>recv</u>,  binary()  or  diameter_packet record on <u>send</u> or <u>ack</u>, or <u>false</u> on <u>ack</u> when an
              incoming request has been discarded). It should return a list of actions and  a  new  callback  as
              tail;  eg.  <u>[fun</u>  <u>cb/3,</u>  <u>State]</u>.  Valid  actions  are the atoms <u>send</u> or <u>recv</u>, to cause a following
              message-valued action to be sent/received, a message to send/receive (binary() or  diameter_packet
              record),  or  a boolean() to enable/disable reading on the socket. More than one <u>send</u>/<u>recv</u>/message
              sequence can be returned from the same callback, and an initial <u>send</u>/<u>recv</u> can be  omitted  if  the
              same  as  the  value  passed  as  the callback's first argument. Reading is initially enabled, and
              returning <u>false</u> does not imply there cannot  be  subsequent  <u>recv</u>  callbacks  since  messages  may
              already  have  been  read.  An  empty tail is equivalent to the prevailing callback. Defaults to a
              callback equivalent to <u>fun(ack,</u> <b>_</b><u>)</u> <u>-&gt;</u> <u>[];</u> <u>(_,</u> <u>Msg)</u> <u>-&gt;</u> <u>[Msg]</u> <u>end</u>.

              Remaining options are  any  accepted  by  ssl:connect/3  or  gen_tcp:connect/3  for  a  connecting
              transport,  or ssl:listen/2 or gen_tcp:listen/2 for a listening transport, depending on whether or
              not <u>{ssl_options,</u> <u>true}</u> has been specified. Options <u>binary</u>, <u>packet</u> and <u>active</u> cannot be specified.
              Also, option <u>port</u> can be specified for a listening transport to specify the local listening  port,
              the default being the standardized 3868. Note that the option <u>ip</u> specifies the local address.

              An  <u>ssl_options</u>  list  must  be specified if and only if the transport in question has set <u>Inband-</u>
              <u>Security-Id</u>   to   1   (<u>TLS</u>),    as    specified    to    either    diameter:start_service/2    or
              diameter:add_transport/2,  so  that  the transport process will receive notification of whether or
              not to commence with a TLS handshake  following  capabilities  exchange.  Failing  to  specify  an
              options  list  on  a TLS-capable transport for which TLS is negotiated will cause TLS handshake to
              fail. Failing to specify TLS capability  when  <u>ssl_options</u>  has  been  specified  will  cause  the
              transport  process  to wait for a notification that will not be forthcoming, which will eventually
              cause the RFC 3539 watchdog to take down the connection.

              The first element of a non-empty <u>Host-IP-Address</u> list in <u>Svc</u> provides the local IP address  if  an
              <u>ip</u>  option  is  not  specified.  The  local  address is either returned fromstart/3 or passed in a
              <u>connected</u> message over the transport interface.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3erl/diameter.3erl.html">diameter</a>(3erl), <a href="../man3erl/diameter_transport.3erl.html">diameter_transport</a>(3erl), <a href="../man3erl/gen_tcp.3erl.html">gen_tcp</a>(3erl), <a href="../man3erl/inet.3erl.html">inet</a>(3erl), <a href="../man3erl/ssl.3erl.html">ssl</a>(3erl)

Ericsson AB                                      diameter 2.2.4                               <u><a href="../man3erl/diameter_tcp.3erl.html">diameter_tcp</a></u>(3erl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>