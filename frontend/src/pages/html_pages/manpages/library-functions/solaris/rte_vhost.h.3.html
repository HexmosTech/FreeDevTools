<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rte_vhost.h</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/dpdk-doc">dpdk-doc_24.11.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rte_vhost.h

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;stdbool.h&gt;
       #include &lt;<a href="file:/usr/include/stdint.h">stdint.h</a>&gt;
       #include &lt;sys/eventfd.h&gt;
       #include &lt;rte_compat.h&gt;
       #include &lt;rte_memory.h&gt;
       #include &lt;rte_mempool.h&gt;
       #include &lt;<a href="file:/usr/include/linux/vhost.h">linux/vhost.h</a>&gt;
       #include &lt;<a href="file:/usr/include/linux/virtio_ring.h">linux/virtio_ring.h</a>&gt;
       #include &lt;<a href="file:/usr/include/linux/virtio_net.h">linux/virtio_net.h</a>&gt;

   <b>Data</b> <b>Structures</b>
       struct <b>rte_vhost_mem_region</b>
       struct <b>rte_vhost_memory</b>
       struct <b>rte_vhost_user_extern_ops</b>
       struct <b>rte_vhost_device_ops</b>
       struct <b>rte_vhost_power_monitor_cond</b>
       struct <b>rte_vhost_stat</b>
       struct <b>rte_vhost_stat_name</b>

   <b>Macros</b>
       #define <b>VHOST_USER_PROTOCOL_F_MQ</b>   0
       #define <b>VHOST_USER_F_PROTOCOL_FEATURES</b>   30
       #define <b>RTE_VHOST_STATS_NAME_SIZE</b>   64

   <b>Typedefs</b>
       <b>typedef</b> enum <b>rte_vhost_msg_result</b>(* <b>rte_vhost_msg_handle</b>) (int vid, void *msg)

   <b>Enumerations</b>
       enum <b>rte_vhost_msg_result</b>

   <b>Functions</b>
       static <b>__rte_always_inline</b> uint64_t <b>rte_vhost_va_from_guest_pa</b> (struct <b>rte_vhost_memory</b> *mem, uint64_t
           gpa, uint64_t *len)
       void <b>rte_vhost_log_write</b> (int vid, uint64_t addr, uint64_t len)
       void <b>rte_vhost_log_used_vring</b> (int vid, uint16_t vring_idx, uint64_t offset, uint64_t len)
       __rte_experimental void <b>rte_vhost_notify_guest</b> (int vid, uint16_t queue_id)
       int <b>rte_vhost_driver_register</b> (const char *path, uint64_t flags)
       int <b>rte_vhost_driver_attach_vdpa_device</b> (const char *path, struct rte_vdpa_device *dev)
       int <b>rte_vhost_driver_detach_vdpa_device</b> (const char *path)
       struct rte_vdpa_device * <b>rte_vhost_driver_get_vdpa_device</b> (const char *path)
       int <b>rte_vhost_driver_get_vdpa_dev_type</b> (const char *path, uint32_t *type)
       int <b>rte_vhost_driver_set_features</b> (const char *path, uint64_t features)
       int <b>rte_vhost_driver_enable_features</b> (const char *path, uint64_t features)
       int <b>rte_vhost_driver_disable_features</b> (const char *path, uint64_t features)
       int <b>rte_vhost_driver_get_features</b> (const char *path, uint64_t *features)
       int <b>rte_vhost_driver_set_protocol_features</b> (const char *path, uint64_t protocol_features)
       int <b>rte_vhost_driver_get_protocol_features</b> (const char *path, uint64_t *protocol_features)
       int <b>rte_vhost_driver_get_queue_num</b> (const char *path, uint32_t *queue_num)
       int <b>rte_vhost_driver_set_max_queue_num</b> (const char *path, uint32_t max_queue_pairs)
       int <b>rte_vhost_get_negotiated_features</b> (int vid, uint64_t *features)
       int <b>rte_vhost_get_negotiated_protocol_features</b> (int vid, uint64_t *protocol_features)
       int <b>rte_vhost_driver_start</b> (const char *path)
       int <b>rte_vhost_get_mtu</b> (int vid, uint16_t *mtu)
       int <b>rte_vhost_get_numa_node</b> (int vid)
       uint16_t <b>rte_vhost_get_vring_num</b> (int vid)
       int <b>rte_vhost_get_ifname</b> (int vid, char *buf, size_t len)
       uint16_t <b>rte_vhost_avail_entries</b> (int vid, uint16_t queue_id)
       uint16_t <b>rte_vhost_enqueue_burst</b> (int vid, uint16_t queue_id, struct <b>rte_mbuf</b> **pkts, uint16_t count)
       uint16_t <b>rte_vhost_dequeue_burst</b> (int vid, uint16_t queue_id, struct <b>rte_mempool</b> *mbuf_pool, struct
           <b>rte_mbuf</b> **pkts, uint16_t count)
       int <b>rte_vhost_get_mem_table</b> (int vid, struct <b>rte_vhost_memory</b> **mem)
       int <b>rte_vhost_get_vhost_vring</b> (int vid, uint16_t vring_idx, struct rte_vhost_vring *vring)
       int <b>rte_vhost_get_vhost_ring_inflight</b> (int vid, uint16_t vring_idx, struct rte_vhost_ring_inflight
           *vring)
       int <b>rte_vhost_set_inflight_desc_split</b> (int vid, uint16_t vring_idx, uint16_t idx)
       int <b>rte_vhost_set_inflight_desc_packed</b> (int vid, uint16_t vring_idx, uint16_t head, uint16_t last,
           uint16_t *inflight_entry)
       int <b>rte_vhost_set_last_inflight_io_split</b> (int vid, uint16_t vring_idx, uint16_t idx)
       int <b>rte_vhost_set_last_inflight_io_packed</b> (int vid, uint16_t vring_idx, uint16_t head)
       int <b>rte_vhost_clr_inflight_desc_split</b> (int vid, uint16_t vring_idx, uint16_t last_used_idx, uint16_t idx)
       int <b>rte_vhost_clr_inflight_desc_packed</b> (int vid, uint16_t vring_idx, uint16_t head)
       int <b>rte_vhost_vring_call</b> (int vid, uint16_t vring_idx)
       int <b>rte_vhost_vring_call_nonblock</b> (int vid, uint16_t vring_idx)
       uint32_t <b>rte_vhost_rx_queue_count</b> (int vid, uint16_t qid)
       int <b>rte_vhost_get_monitor_addr</b> (int vid, uint16_t queue_id, struct <b>rte_vhost_power_monitor_cond</b> *pmc)
       int <b>rte_vhost_get_log_base</b> (int vid, uint64_t *log_base, uint64_t *log_size)
       int <b>rte_vhost_get_vring_base</b> (int vid, uint16_t queue_id, uint16_t *last_avail_idx, uint16_t
           *last_used_idx)
       int <b>rte_vhost_get_vring_base_from_inflight</b> (int vid, uint16_t queue_id, uint16_t *last_avail_idx,
           uint16_t *last_used_idx)
       int <b>rte_vhost_set_vring_base</b> (int vid, uint16_t queue_id, uint16_t last_avail_idx, uint16_t
           last_used_idx)
       int <b>rte_vhost_extern_callback_register</b> (int vid, struct <b>rte_vhost_user_extern_ops</b> const *const ops, void
           *ctx)
       struct rte_vdpa_device * <b>rte_vhost_get_vdpa_device</b> (int vid)
       int <b>rte_vhost_backend_config_change</b> (int vid, bool need_reply)
       int <b>rte_vhost_vring_stats_get_names</b> (int vid, uint16_t queue_id, struct <b>rte_vhost_stat_name</b> *name,
           unsigned int size)
       int <b>rte_vhost_vring_stats_get</b> (int vid, uint16_t queue_id, struct <b>rte_vhost_stat</b> *stats, unsigned int n)
       int <b>rte_vhost_vring_stats_reset</b> (int vid, uint16_t queue_id)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       Interface to vhost-user

       Definition in file <b>rte_vhost.h</b>.

</pre><h4><b>Macro</b> <b>Definition</b> <b>Documentation</b></h4><pre>
   <b>#define</b> <b>VHOST_USER_PROTOCOL_F_MQ</b>   <b>0</b>
       Protocol features.

       Definition at line <b>65</b> of file <b>rte_vhost.h</b>.

   <b>#define</b> <b>VHOST_USER_F_PROTOCOL_FEATURES</b>   <b>30</b>
       Indicate whether protocol features negotiation is supported.

       Definition at line <b>118</b> of file <b>rte_vhost.h</b>.

   <b>#define</b> <b>RTE_VHOST_STATS_NAME_SIZE</b>   <b>64</b>
       Maximum name length for the statistics counters

       Definition at line <b>337</b> of file <b>rte_vhost.h</b>.

</pre><h4><b>Typedef</b> <b>Documentation</b></h4><pre>
   <b>typedef</b> <b>enum</b> <b>rte_vhost_msg_result(*</b> <b>rte_vhost_msg_handle)</b> <b>(int</b> <b>vid,</b> <b>void</b> <b>*msg)</b>
       Function prototype for the vhost backend to handle specific vhost user messages.

       <b>Parameters</b>
           <u>vid</u> vhost device id
           <u>msg</u> Message pointer.

       <b>Returns</b>
           RTE_VHOST_MSG_RESULT_OK on success, RTE_VHOST_MSG_RESULT_REPLY on success with reply,
           RTE_VHOST_MSG_RESULT_ERR on failure, RTE_VHOST_MSG_RESULT_NOT_HANDLED if message was not handled.

       Definition at line <b>1</b> of file <b>rte_vhost.h</b>.

</pre><h4><b>Enumeration</b> <b>Type</b> <b>Documentation</b></h4><pre>
   <b>enum</b> <b>rte_vhost_msg_result</b>
       Possible results of the vhost user message handling callbacks

       Definition at line <b>237</b> of file <b>rte_vhost.h</b>.

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>static</b> <b>__rte_always_inline</b> <b>uint64_t</b> <b>rte_vhost_va_from_guest_pa</b> <b>(struct</b> <b>rte_vhost_memory</b> <b>*</b> <b>mem,</b> <b>uint64_t</b> <b>gpa,</b>
       <b>uint64_t</b> <b>*</b> <b>len)</b> <b>[static]</b>
       Convert guest physical address to host virtual address

       <b>Parameters</b>
           <u>mem</u> the guest memory regions
           <u>gpa</u> the guest physical address for querying
           <u>len</u> the size of the requested area to map, updated with actual size mapped

       <b>Returns</b>
           the host virtual address on success, 0 on failure

       Definition at line <b>375</b> of file <b>rte_vhost.h</b>.

   <b>void</b> <b>rte_vhost_log_write</b> <b>(int</b> <b>vid,</b> <b>uint64_t</b> <b>addr,</b> <b>uint64_t</b> <b>len)</b>
       Log the memory write start with given address.

       This function only need be invoked when the live migration starts. Therefore, we won't need call it at
       all in the most of time. For making the performance impact be minimum, it's suggested to do a check
       before calling it:

          if (unlikely(RTE_VHOST_NEED_LOG(features)))
                  rte_vhost_log_write(vid, addr, len);

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>addr</u> the starting address for write (in guest physical address space)
           <u>len</u> the length to write

   <b>void</b> <b>rte_vhost_log_used_vring</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx,</b> <b>uint64_t</b> <b>offset,</b> <b>uint64_t</b> <b>len)</b>
       Log the used ring update start at given offset.

       Same as rte_vhost_log_write, it's suggested to do a check before calling it:

          if (unlikely(RTE_VHOST_NEED_LOG(features)))
                  rte_vhost_log_used_vring(vid, vring_idx, offset, len);

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> the vring index
           <u>offset</u> the offset inside the used ring
           <u>len</u> the length to write

   <b>__rte_experimental</b> <b>void</b> <b>rte_vhost_notify_guest</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id)</b>
       <b>Warning</b>
           <b>EXPERIMENTAL:</b> this API may change, or be removed, without prior notice.

       Inject the offloaded interrupt into the vhost device's queue.

       <b>See</b> <b>also</b>
           guest_notify vhost device operation

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> virtio queue index

   <b>int</b> <b>rte_vhost_driver_register</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint64_t</b> <b>flags)</b>
       Register vhost driver. path could be different for multiple instance support.

   <b>int</b> <b>rte_vhost_driver_attach_vdpa_device</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>struct</b> <b>rte_vdpa_device</b> <b>*</b> <b>dev)</b>
       Set the vdpa device id, enforce single connection per socket

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>dev</u> vDPA device pointer

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_detach_vdpa_device</b> <b>(const</b> <b>char</b> <b>*</b> <b>path)</b>
       Unset the vdpa device id

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path

       <b>Returns</b>
           0 on success, -1 on failure

   <b>struct</b> <b>rte_vdpa_device</b> <b>*</b> <b>rte_vhost_driver_get_vdpa_device</b> <b>(const</b> <b>char</b> <b>*</b> <b>path)</b>
       Get the device id

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path

       <b>Returns</b>
           vDPA device pointer, NULL on failure

   <b>int</b> <b>rte_vhost_driver_get_vdpa_dev_type</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint32_t</b> <b>*</b> <b>type)</b>
       Get the device type of the vdpa device.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>type</u> the device type of the vdpa device

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_set_features</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint64_t</b> <b>features)</b>
       Set the feature bits the vhost-user driver supports.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>features</u> Supported features

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_enable_features</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint64_t</b> <b>features)</b>
       Enable vhost-user driver features.

       Note that

       • the param features should be a subset of the feature bits provided by <b>rte_vhost_driver_set_features()</b>.

       • it must be invoked before vhost-user negotiation starts.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>features</u> Features to enable

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_disable_features</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint64_t</b> <b>features)</b>
       Disable vhost-user driver features.

       The two notes at <b>rte_vhost_driver_enable_features()</b> also apply here.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>features</u> Features to disable

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_get_features</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint64_t</b> <b>*</b> <b>features)</b>
       Get the feature bits before feature negotiation.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>features</u> A pointer to store the queried feature bits

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_set_protocol_features</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint64_t</b> <b>protocol_features)</b>
       Set the protocol feature bits before feature negotiation.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>protocol_features</u> Supported protocol features

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_get_protocol_features</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint64_t</b> <b>*</b> <b>protocol_features)</b>
       Get the protocol feature bits before feature negotiation.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>protocol_features</u> A pointer to store the queried protocol feature bits

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_get_queue_num</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint32_t</b> <b>*</b> <b>queue_num)</b>
       Get the queue number bits before feature negotiation.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>queue_num</u> A pointer to store the queried queue number bits

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_set_max_queue_num</b> <b>(const</b> <b>char</b> <b>*</b> <b>path,</b> <b>uint32_t</b> <b>max_queue_pairs)</b>
       Set  the  maximum  number of queue pairs supported by the device. The value set is ignored for Vhost-user
       backends. It is only taken into account with VDUSE backends.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path
           <u>max_queue_pairs</u> The maximum number of queue pairs

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_get_negotiated_features</b> <b>(int</b> <b>vid,</b> <b>uint64_t</b> <b>*</b> <b>features)</b>
       Get the feature bits after negotiation

       <b>Parameters</b>
           <u>vid</u> Vhost device ID
           <u>features</u> A pointer to store the queried feature bits

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_get_negotiated_protocol_features</b> <b>(int</b> <b>vid,</b> <b>uint64_t</b> <b>*</b> <b>protocol_features)</b>
       Get the protocol feature bits after negotiation

       <b>Parameters</b>
           <u>vid</u> Vhost device ID
           <u>protocol_features</u> A pointer to store the queried protocol feature bits

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_driver_start</b> <b>(const</b> <b>char</b> <b>*</b> <b>path)</b>
       Start the vhost-user driver.

       This function triggers the vhost-user negotiation.

       <b>Parameters</b>
           <u>path</u> The vhost-user socket file path

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_get_mtu</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>*</b> <b>mtu)</b>
       Get the MTU value of the device if set in QEMU.

       <b>Parameters</b>
           <u>vid</u> virtio-net device ID
           <u>mtu</u> The variable to store the MTU value

       <b>Returns</b>
           0: success -EAGAIN: device not yet started -ENOTSUP: device does not support MTU feature

   <b>int</b> <b>rte_vhost_get_numa_node</b> <b>(int</b> <b>vid)</b>
       Get the numa node from which the virtio net device's memory is allocated.

       <b>Parameters</b>
           <u>vid</u> vhost device ID

       <b>Returns</b>
           The numa node, -1 on failure

   <b>uint16_t</b> <b>rte_vhost_get_vring_num</b> <b>(int</b> <b>vid)</b>
       Get the number of vrings the device supports.

       <b>Parameters</b>
           <u>vid</u> vhost device ID

       <b>Returns</b>
           The number of vrings, 0 on failure

   <b>int</b> <b>rte_vhost_get_ifname</b> <b>(int</b> <b>vid,</b> <b>char</b> <b>*</b> <b>buf,</b> <b>size_t</b> <b>len)</b>
       Get the virtio net device's ifname, which is the vhost-user socket file path.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>buf</u> The buffer to stored the queried ifname
           <u>len</u> The length of buf

       <b>Returns</b>
           0 on success, -1 on failure

   <b>uint16_t</b> <b>rte_vhost_avail_entries</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id)</b>
       Get how many avail entries are left in the queue

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> virtio queue index

       <b>Returns</b>
           num of avail entries left

   <b>uint16_t</b> <b>rte_vhost_enqueue_burst</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id,</b> <b>struct</b> <b>rte_mbuf</b> <b>**</b> <b>pkts,</b> <b>uint16_t</b> <b>count)</b>
       This function adds buffers to the virtio devices RX virtqueue. Buffers can be received from the  physical
       port  or  from  another virtual device. A packet count is returned to indicate the number of packets that
       were successfully added to the RX queue.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> virtio queue index in mq case
           <u>pkts</u> array to contain packets to be enqueued
           <u>count</u> packets num to be enqueued

       <b>Returns</b>
           num of packets enqueued

   <b>uint16_t</b> <b>rte_vhost_dequeue_burst</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id,</b> <b>struct</b> <b>rte_mempool</b> <b>*</b> <b>mbuf_pool,</b> <b>struct</b> <b>rte_mbuf</b>
       <b>**</b> <b>pkts,</b> <b>uint16_t</b> <b>count)</b>
       This function gets guest buffers from the virtio device TX virtqueue, construct host mbufs, copies  guest
       buffer content to host mbufs and store them in pkts to be processed.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> virtio queue index in mq case
           <u>mbuf_pool</u> mbuf_pool where host mbuf is allocated.
           <u>pkts</u> array to contain packets to be dequeued
           <u>count</u> packets num to be dequeued

       <b>Returns</b>
           num of packets dequeued

   <b>int</b> <b>rte_vhost_get_mem_table</b> <b>(int</b> <b>vid,</b> <b>struct</b> <b>rte_vhost_memory</b> <b>**</b> <b>mem)</b>
       Get guest mem table: a list of memory regions.

       An  rte_vhost_vhost_memory  object  will  be  allocated  internally,  to  hold  the guest memory regions.
       Application should free it at destroy_device() callback.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>mem</u> To store the returned mem regions

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_get_vhost_vring</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx,</b> <b>struct</b> <b>rte_vhost_vring</b> <b>*</b> <b>vring)</b>
       Get guest vring info, including the vring address, vring size, etc.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index
           <u>vring</u> the structure to hold the requested vring info

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_get_vhost_ring_inflight</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx,</b> <b>struct</b> <b>rte_vhost_ring_inflight</b> <b>*</b> <b>vring)</b>
       Get guest inflight vring info, including inflight ring and resubmit list.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index
           <u>vring</u> the structure to hold the requested inflight vring info

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_set_inflight_desc_split</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx,</b> <b>uint16_t</b> <b>idx)</b>
       Set split inflight descriptor.

       This function save descriptors that has been consumed in available ring

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index
           <u>idx</u> inflight entry index

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_set_inflight_desc_packed</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx,</b> <b>uint16_t</b> <b>head,</b> <b>uint16_t</b> <b>last,</b> <b>uint16_t</b> <b>*</b>
       <b>inflight_entry)</b>
       Set packed inflight descriptor and get corresponding inflight entry

       This function save descriptors that has been consumed

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index
           <u>head</u> head of descriptors
           <u>last</u> last of descriptors
           <u>inflight_entry</u> corresponding inflight entry

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_set_last_inflight_io_split</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx,</b> <b>uint16_t</b> <b>idx)</b>
       Save the head of list that the last batch of used descriptors.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index
           <u>idx</u> descriptor entry index

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_set_last_inflight_io_packed</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx,</b> <b>uint16_t</b> <b>head)</b>
       Update the inflight free_head, used_idx and used_wrap_counter.

       This function will update status first before updating descriptors to used

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index
           <u>head</u> head of descriptors

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_clr_inflight_desc_split</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx,</b> <b>uint16_t</b> <b>last_used_idx,</b> <b>uint16_t</b> <b>idx)</b>
       Clear the split inflight status.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index
           <u>last_used_idx</u> last used idx of used ring
           <u>idx</u> inflight entry index

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_clr_inflight_desc_packed</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx,</b> <b>uint16_t</b> <b>head)</b>
       Clear the packed inflight status.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index
           <u>head</u> inflight entry index

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_vring_call</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx)</b>
       Notify the guest that used descriptors have been added to the vring.  This  function  acts  as  a  memory
       barrier.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_vring_call_nonblock</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>vring_idx)</b>
       Notify  the  guest  that  used  descriptors  have been added to the vring. This function acts as a memory
       barrier. This function will return -EAGAIN when vq's access lock is held by other thread, user should try
       again later.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>vring_idx</u> vring index

       <b>Returns</b>
           0 on success, -1 on failure, -EAGAIN for another retry

   <b>uint32_t</b> <b>rte_vhost_rx_queue_count</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>qid)</b>
       Get vhost RX queue avail count.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>qid</u> virtio queue index in mq case

       <b>Returns</b>
           num of desc available

   <b>int</b> <b>rte_vhost_get_monitor_addr</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id,</b> <b>struct</b> <b>rte_vhost_power_monitor_cond</b> <b>*</b> <b>pmc)</b>
       Get power monitor address of the vhost device

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> vhost queue ID
           <u>pmc</u> power monitor condition

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_get_log_base</b> <b>(int</b> <b>vid,</b> <b>uint64_t</b> <b>*</b> <b>log_base,</b> <b>uint64_t</b> <b>*</b> <b>log_size)</b>
       Get log base and log size of the vhost device

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>log_base</u> vhost log base
           <u>log_size</u> vhost log size

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b>  <b>rte_vhost_get_vring_base</b>  <b>(int</b>  <b>vid,</b>  <b>uint16_t</b>  <b>queue_id,</b>  <b>uint16_t</b>   <b>*</b>   <b>last_avail_idx,</b>   <b>uint16_t</b>   <b>*</b>
       <b>last_used_idx)</b>
       Get last_avail/used_idx of the vhost virtqueue

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> vhost queue index
           <u>last_avail_idx</u> vhost last_avail_idx to get
           <u>last_used_idx</u> vhost last_used_idx to get

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_get_vring_base_from_inflight</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id,</b> <b>uint16_t</b> <b>*</b> <b>last_avail_idx,</b> <b>uint16_t</b> <b>*</b>
       <b>last_used_idx)</b>
       Get last_avail/last_used of the vhost virtqueue

       This  function  is  designed for the reconnection and it's specific for the packed ring as we can get the
       two parameters from the inflight queueregion

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> vhost queue index
           <u>last_avail_idx</u> vhost last_avail_idx to get
           <u>last_used_idx</u> vhost last_used_idx to get

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_set_vring_base</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id,</b> <b>uint16_t</b> <b>last_avail_idx,</b> <b>uint16_t</b> <b>last_used_idx)</b>
       Set last_avail/used_idx of the vhost virtqueue

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> vhost queue index
           <u>last_avail_idx</u> last_avail_idx to set
           <u>last_used_idx</u> last_used_idx to set

       <b>Returns</b>
           0 on success, -1 on failure

   <b>int</b> <b>rte_vhost_extern_callback_register</b> <b>(int</b> <b>vid,</b> <b>struct</b> <b>rte_vhost_user_extern_ops</b> <b>const</b> <b>*const</b>  <b>ops,</b>  <b>void</b>  <b>*</b>
       <b>ctx)</b>
       Register external message handling callbacks

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>ops</u> virtio external callbacks to register
           <u>ctx</u> additional context passed to the callbacks

       <b>Returns</b>
           0 on success, -1 on failure

   <b>struct</b> <b>rte_vdpa_device</b> <b>*</b> <b>rte_vhost_get_vdpa_device</b> <b>(int</b> <b>vid)</b>
       Get vdpa device id for vhost device.

       <b>Parameters</b>
           <u>vid</u> vhost device id

       <b>Returns</b>
           vDPA device pointer on success, NULL on failure

   <b>int</b> <b>rte_vhost_backend_config_change</b> <b>(int</b> <b>vid,</b> <b>bool</b> <b>need_reply)</b>
       Notify the guest that should get virtio configuration space from backend.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>need_reply</u> wait for the frontend response the status of this operation

       <b>Returns</b>
           0 on success, &lt; 0 on failure

   <b>int</b>  <b>rte_vhost_vring_stats_get_names</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id,</b> <b>struct</b> <b>rte_vhost_stat_name</b> <b>*</b> <b>name,</b> <b>unsigned</b>
       <b>int</b> <b>size)</b>
       Retrieve names of statistics of a Vhost virtqueue.

       There  is  an  assumption  that  'stat_names'  and  'stats'  arrays   are   matched   by   array   index:
       stats_names[i].name =&gt; stats[i].value

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> vhost queue index
           <u>name</u>  array of at least size elements to be filled. If set to NULL, the function returns the required
           number of elements.
           <u>size</u> The number of elements in stats_names array.

       <b>Returns</b>

           • Success if greater than 0 and lower or equal to <u>size</u>. The return  value  indicates  the  number  of
             elements filled in the <u>names</u> array.

           • Failure  if  greater  than  <u>size</u>. The return value indicates the number of elements the <u>names</u> array
             that should be given to succeed.

           • Failure if lower than 0. The device ID or queue ID is invalid or

       • statistics collection is not enabled.

   <b>int</b> <b>rte_vhost_vring_stats_get</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id,</b> <b>struct</b> <b>rte_vhost_stat</b> <b>*</b> <b>stats,</b> <b>unsigned</b> <b>int</b> <b>n)</b>
       Retrieve statistics of a Vhost virtqueue.

       There  is  an  assumption  that  'stat_names'  and  'stats'  arrays   are   matched   by   array   index:
       stats_names[i].name =&gt; stats[i].value

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> vhost queue index
           <u>stats</u> A pointer to a table of structure of type <b>rte_vhost_stat</b> to be filled with virtqueue statistics
           ids and values.
           <u>n</u> The number of elements in stats array.

       <b>Returns</b>

           • Success  if  greater  than  0  and  lower  or  equal to <u>n</u>. The return value indicates the number of
             elements filled in the <u>stats</u> array.

           • Failure if greater than <u>n</u>. The return value indicates the number of elements the <u>stats</u>  array  that
             should be given to succeed.

           • Failure  if  lower  than  0.  The device ID or queue ID is invalid, or statistics collection is not
             enabled.

   <b>int</b> <b>rte_vhost_vring_stats_reset</b> <b>(int</b> <b>vid,</b> <b>uint16_t</b> <b>queue_id)</b>
       Reset statistics of a Vhost virtqueue.

       <b>Parameters</b>
           <u>vid</u> vhost device ID
           <u>queue_id</u> vhost queue index

       <b>Returns</b>

           • Success if 0. Statistics have been reset.

           • Failure if lower than 0. The device ID or queue ID is invalid,  or  statistics  collection  is  not
             enabled.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for DPDK from the source code.

DPDK                                             Version 24.11.2                                  <u><a href="../man3/rte_vhost.h.3.html">rte_vhost.h</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>