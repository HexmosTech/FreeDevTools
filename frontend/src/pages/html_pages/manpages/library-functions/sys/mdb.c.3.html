<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mdb.c - Lightning memory-mapped database library.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/lmdb-doc">lmdb-doc_0.9.31-1build1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mdb.c - Lightning memory-mapped database library.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;sys/types.h&gt;
       #include &lt;sys/stat.h&gt;
       #include &lt;sys/param.h&gt;
       #include &lt;sys/uio.h&gt;
       #include &lt;sys/mman.h&gt;
       #include &lt;<a href="file:/usr/include/fcntl.h">fcntl.h</a>&gt;
       #include &lt;<a href="file:/usr/include/errno.h">errno.h</a>&gt;
       #include &lt;<a href="file:/usr/include/limits.h">limits.h</a>&gt;
       #include &lt;stddef.h&gt;
       #include &lt;<a href="file:/usr/include/inttypes.h">inttypes.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
       #include &lt;<a href="file:/usr/include/string.h">string.h</a>&gt;
       #include &lt;<a href="file:/usr/include/time.h">time.h</a>&gt;
       #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;
       #include &lt;<a href="file:/usr/include/netinet/in.h">netinet/in.h</a>&gt;
       #include &lt;<a href="file:/usr/include/resolv.h">resolv.h</a>&gt;
       #include &lt;<a href="file:/usr/include/pthread.h">pthread.h</a>&gt;
       #include &lt;<a href="file:/usr/include/signal.h">signal.h</a>&gt;
       #include 'lmdb.h'
       #include 'midl.h'

   <b>Data</b> <b>Structures</b>
       struct <b>MDB_rxbody</b>
       struct <b>MDB_reader</b>
       struct <b>MDB_txbody</b>
       struct <b>MDB_txninfo</b>
       struct <b>MDB_page</b>
       struct <b>MDB_page2</b>
       struct <b>MDB_node</b>
       struct <b>MDB_db</b>
       struct <b>MDB_meta</b>
       union <b>MDB_metabuf</b>
       struct <b>MDB_dbx</b>
       struct <b>MDB_txn</b>
           Opaque structure for a transaction handle.
       struct <b>MDB_cursor</b>
           Opaque structure for navigating through a database.
       struct <b>MDB_xcursor</b>
       struct <b>MDB_pgstate</b>
       struct <b>MDB_env</b>
           Opaque structure for a database environment.
       struct <b>MDB_ntxn</b>
       struct <b>MDB_name</b>
       struct <b>mdb_copy</b>

   <b>Macros</b>
       #define <b>_GNU_SOURCE</b>   1
       #define <b>MDB_PID_T</b>   pid_t
       #define <b>MDB_THR_T</b>   pthread_t
       #define <b>CACHEFLUSH</b>(addr,  bytes,  cache)
       #define <b>MDB_USE_POSIX_MUTEX</b>   1
       #define <b>VGMEMP_CREATE</b>(h,  r,  z)
       #define <b>VGMEMP_ALLOC</b>(h,  a,  s)
       #define <b>VGMEMP_FREE</b>(h,  a)
       #define <b>VGMEMP_DESTROY</b>(h)
       #define <b>VGMEMP_DEFINED</b>(a,  s)
       #define <b>BYTE_ORDER</b>   __BYTE_ORDER
       #define <b>LITTLE_ENDIAN</b>   __LITTLE_ENDIAN
       #define <b>BIG_ENDIAN</b>   __BIG_ENDIAN
       #define <b>ESECT</b>   __attribute__ ((section('text_env')))
       #define <b>CALL_CONV</b>
       #define <b>MDB_DEVEL</b>   0
       #define <b>mdb_func_</b>   '&lt;mdb_unknown&gt;'
       #define <b>MDB_NO_ROOT</b>   (<b>MDB_LAST_ERRCODE</b> + 10)
       #define <b>MDB_USE_ROBUST</b>   1
       #define <b>THREAD_RET</b>   void *
       #define <b>THREAD_CREATE</b>(thr,  start,  arg)   pthread_create(&amp;thr,NULL,start,arg)
       #define <b>THREAD_FINISH</b>(thr)   pthread_join(thr,NULL)
       #define <b>Z</b>   'z'
       #define <b>MDB_PIDLOCK</b>   1
       #define <b><a href="../manmutex/LOCK_MUTEX0.mutex.html">LOCK_MUTEX0</a></b>(mutex)   <a href="../manmutex/pthread_mutex_lock.mutex.html">pthread_mutex_lock</a>(mutex)
       #define <b><a href="../manmutex/UNLOCK_MUTEX.mutex.html">UNLOCK_MUTEX</a></b>(mutex)   <a href="../manmutex/pthread_mutex_unlock.mutex.html">pthread_mutex_unlock</a>(mutex)
       #define <b><a href="../manmutex/mdb_mutex_consistent.mutex.html">mdb_mutex_consistent</a></b>(mutex)   <a href="../manmutex/pthread_mutex_consistent.mutex.html">pthread_mutex_consistent</a>(mutex)
       #define <b>ErrCode</b>()   errno
       #define <b>HANDLE</b>   int
       #define <b>INVALID_HANDLE_VALUE</b>   (-1)
       #define <b>GET_PAGESIZE</b>(x)   ((x) = sysconf(_SC_PAGE_SIZE))
       #define <b>MNAME_LEN</b>   (sizeof(pthread_mutex_t))
       #define <b>LOCK_MUTEX</b>(rc,  env,  mutex)   ((rc) = <b><a href="../manmutex/LOCK_MUTEX0.mutex.html">LOCK_MUTEX0</a></b>(mutex))
       #define <b>mdb_mutex_failed</b>(env,  mutex,  rc)   (rc)
       #define <b>MDB_DSYNC</b>   O_SYNC
       #define <b>MDB_FDATASYNC</b>   fdatasync
       #define <b>MDB_MSYNC</b>(addr,  len,  flags)   msync(addr,len,flags)
       #define <b>MS_SYNC</b>   1
       #define <b>MS_ASYNC</b>   0
       #define <b>MDB_DEBUG</b>   0
       #define <b>DPRINTF</b>(args)   ((void) 0)
       #define <b>DPUTS</b>(arg)   DPRINTF(('%s', arg))
       #define <b><a href="../manmc/DDBI.mc.html">DDBI</a></b>(mc)    (((mc)-&gt;mc_flags &amp; <b>C_SUB</b>) ? -(int)(mc)-&gt;mc_dbi : (int)(mc)-&gt;mc_dbi)
       #define <b>MAX_PAGESIZE</b>   (<b>PAGEBASE</b> ? 0x10000 : 0x8000)
           The maximum size of a database page.
       #define <b>MDB_MINKEYS</b>   2
       #define <b>MDB_MAGIC</b>   0xBEEFC0DE
       #define <b>MDB_DATA_VERSION</b>   ((<b>MDB_DEVEL</b>) ? 999 : 1)
       #define <b>MDB_LOCK_VERSION</b>   1
       #define <b>MDB_MAXKEYSIZE</b>   ((<b>MDB_DEVEL</b>) ? 0 : 511)
           The max size of a key we can write, or 0 for computed max.
       #define <b>ENV_MAXKEY</b>(env)   (<b>MDB_MAXKEYSIZE</b>)
       #define <b>MAXDATASIZE</b>   0xffffffffUL
           The maximum size of a data item.
       #define <b>DKBUF</b>
       #define <b>DKEY</b>(x)   0
       #define <b>P_INVALID</b>   (~(<b>pgno_t</b>)0)
       #define <b>F_ISSET</b>(w,  f)   (((w) &amp; (f)) == (f))
       #define <b>EVEN</b>(n)   (((n) + 1U) &amp; -2) /* sign-extending -2 to match n+1U */
       #define <b>DEFAULT_MAPSIZE</b>   1048576
       #define <b>DEFAULT_READERS</b>   126
       #define <b>CACHELINE</b>   64
       #define <b>mr_txnid</b>   mru.mrx.mrb_txnid
       #define <b>mr_pid</b>   mru.mrx.mrb_pid
       #define <b>mr_tid</b>   mru.mrx.mrb_tid
       #define <b>mti_magic</b>   mt1.mtb.mtb_magic
       #define <b>mti_format</b>   mt1.mtb.mtb_format
       #define <b>mti_rmutex</b>   mt1.mtb.mtb_rmutex
       #define <b>mti_rmname</b>   mt1.mtb.mtb_rmname
       #define <b>mti_txnid</b>   mt1.mtb.mtb_txnid
       #define <b>mti_numreaders</b>   mt1.mtb.mtb_numreaders
       #define <b>mti_wmutex</b>   mt2.mt2_wmutex
       #define <b>MDB_LOCK_FORMAT</b>
       #define <b>mp_pgno</b>   mp_p.p_pgno
       #define <b>mp_next</b>   mp_p.p_next
       #define <b>P_BRANCH</b>   0x01
       #define <b>P_LEAF</b>   0x02
       #define <b>P_OVERFLOW</b>   0x04
       #define <b>P_META</b>   0x08
       #define <b>P_DIRTY</b>   0x10
       #define <b>P_LEAF2</b>   0x20
       #define <b>P_SUBP</b>   0x40
       #define <b>P_LOOSE</b>   0x4000
       #define <b>P_KEEP</b>   0x8000
       #define <b>mp_lower</b>   mp_pb.pb.pb_lower
       #define <b>mp_upper</b>   mp_pb.pb.pb_upper
       #define <b>mp_pages</b>   mp_pb.pb_pages
       #define <b>MP_PGNO</b>(p)   (((<b>MDB_page2</b> *)(void *)(p))-&gt;mp2_p)
       #define <b>MP_PAD</b>(p)   (((<b>MDB_page2</b> *)(void *)(p))-&gt;mp2_pad)
       #define <b>MP_FLAGS</b>(p)   (((<b>MDB_page2</b> *)(void *)(p))-&gt;mp2_flags)
       #define <b>MP_LOWER</b>(p)   (((<b>MDB_page2</b> *)(void *)(p))-&gt;mp2_lower)
       #define <b>MP_UPPER</b>(p)   (((<b>MDB_page2</b> *)(void *)(p))-&gt;mp2_upper)
       #define <b>MP_PTRS</b>(p)   (((<b>MDB_page2</b> *)(void *)(p))-&gt;mp2_ptrs)
       #define <b>PAGEHDRSZ</b>   ((unsigned) offsetof(<b>MDB_page</b>, mp_ptrs))
       #define <b>METADATA</b>(p)   ((void *)((char *)(p) + <b>PAGEHDRSZ</b>))
       #define <b>PAGEBASE</b>   ((<b>MDB_DEVEL</b>) ? <b>PAGEHDRSZ</b> : 0)
       #define <b>NUMKEYS</b>(p)   ((MP_LOWER(p) - (<b>PAGEHDRSZ</b>-<b>PAGEBASE</b>)) &gt;&gt; 1)
       #define <b>SIZELEFT</b>(p)   (<b>indx_t</b>)(MP_UPPER(p) - MP_LOWER(p))
       #define <b>PAGEFILL</b>(env,  p)
       #define <b>FILL_THRESHOLD</b>   250
       #define <b>IS_LEAF</b>(p)   <b>F_ISSET</b>(MP_FLAGS(p), <b>P_LEAF</b>)
       #define <b>IS_LEAF2</b>(p)   <b>F_ISSET</b>(MP_FLAGS(p), <b>P_LEAF2</b>)
       #define <b>IS_BRANCH</b>(p)   <b>F_ISSET</b>(MP_FLAGS(p), <b>P_BRANCH</b>)
       #define <b>IS_OVERFLOW</b>(p)   <b>F_ISSET</b>(MP_FLAGS(p), <b>P_OVERFLOW</b>)
       #define <b>IS_SUBP</b>(p)   <b>F_ISSET</b>(MP_FLAGS(p), <b>P_SUBP</b>)
       #define <b>OVPAGES</b>(size,  psize)   ((<b>PAGEHDRSZ</b>-1 + (size)) / (psize) + 1)
       #define <b>NEXT_LOOSE_PAGE</b>(p)   (*(<b>MDB_page</b> **)((p) + 2))
       #define <b>F_BIGDATA</b>   0x01
       #define <b>F_SUBDATA</b>   0x02
       #define <b>F_DUPDATA</b>   0x04
       #define <b>NODE_ADD_FLAGS</b>   (<b>F_DUPDATA</b>|<b>F_SUBDATA</b>|<b>MDB_RESERVE</b>|<b>MDB_APPEND</b>)
       #define <b>NODESIZE</b>   offsetof(<b>MDB_node</b>, mn_data)
       #define <b>PGNO_TOPWORD</b>   ((<b>pgno_t</b>)-1 &gt; 0xffffffffu ? 32 : 0)
       #define <b>INDXSIZE</b>(k)   (<b>NODESIZE</b> + ((k) == NULL ? 0 : (k)-&gt;mv_size))
       #define <b>LEAFSIZE</b>(k,  d)   (<b>NODESIZE</b> + (k)-&gt;mv_size + (d)-&gt;mv_size)
       #define <b>NODEPTR</b>(p,  i)   ((<b>MDB_node</b> *)((char *)(p) + MP_PTRS(p)[i] + <b>PAGEBASE</b>))
       #define <b>NODEKEY</b>(node)   (void *)((node)-&gt;mn_data)
       #define <b>NODEDATA</b>(node)   (void *)((char *)(node)-&gt;mn_data + (node)-&gt;mn_ksize)
       #define <b>NODEPGNO</b>(node)
       #define <b>SETPGNO</b>(node,  pgno)
       #define <b>NODEDSZ</b>(node)   ((node)-&gt;mn_lo | ((unsigned)(node)-&gt;mn_hi &lt;&lt; 16))
       #define <b>SETDSZ</b>(node,  size)
       #define <b>NODEKSZ</b>(node)   ((node)-&gt;mn_ksize)
       #define <b>COPY_PGNO</b>(dst,  src)
       #define <b>LEAF2KEY</b>(p,  i,  ks)   ((char *)(p) + <b>PAGEHDRSZ</b> + ((i)*(ks)))
       #define <b>MDB_GET_KEY</b>(node,  keyptr)
       #define <b>MDB_GET_KEY2</b>(node,  key)   { key.mv_size = <b>NODEKSZ</b>(node); key.mv_data = <b>NODEKEY</b>(node); }
       #define <b>MDB_VALID</b>   0x8000
       #define <b>PERSISTENT_FLAGS</b>   (0xffff &amp; ~(<b>MDB_VALID</b>))
       #define <b>VALID_FLAGS</b>
       #define <b>FREE_DBI</b>   0
       #define <b>MAIN_DBI</b>   1
       #define <b>CORE_DBS</b>   2
       #define <b>NUM_METAS</b>   2
       #define <b>mm_psize</b>   mm_dbs[<b>FREE_DBI</b>].md_pad
       #define <b>mm_flags</b>   mm_dbs[<b>FREE_DBI</b>].md_flags
       #define <b>DB_DIRTY</b>   0x01
       #define <b>DB_STALE</b>   0x02
       #define <b>DB_NEW</b>   0x04
       #define <b>DB_VALID</b>   0x08
       #define <b>DB_USRVALID</b>   0x10
       #define <b>DB_DUPDATA</b>   0x20
       #define <b>MDB_TXN_BEGIN_FLAGS</b>   <b>MDB_RDONLY</b>
       #define <b>MDB_TXN_RDONLY</b>   <b>MDB_RDONLY</b>
       #define <b>MDB_TXN_WRITEMAP</b>   <b>MDB_WRITEMAP</b>
       #define <b>MDB_TXN_FINISHED</b>   0x01
       #define <b>MDB_TXN_ERROR</b>   0x02
       #define <b>MDB_TXN_DIRTY</b>   0x04
       #define <b>MDB_TXN_SPILLS</b>   0x08
       #define <b>MDB_TXN_HAS_CHILD</b>   0x10
       #define <b>MDB_TXN_BLOCKED</b>   (<b>MDB_TXN_FINISHED</b>|<b>MDB_TXN_ERROR</b>|<b>MDB_TXN_HAS_CHILD</b>)
       #define <b>CURSOR_STACK</b>   32
       #define <b>C_INITIALIZED</b>   0x01
       #define <b>C_EOF</b>   0x02
       #define <b>C_SUB</b>   0x04
       #define <b>C_DEL</b>   0x08
       #define <b>C_UNTRACK</b>   0x40
       #define <b><a href="../manmc/XCURSOR_INITED.mc.html">XCURSOR_INITED</a></b>(mc)    ((mc)-&gt;mc_xcursor &amp;&amp; ((mc)-&gt;mc_xcursor-&gt;mx_cursor.mc_flags &amp;
           <b>C_INITIALIZED</b>))
       #define <b>XCURSOR_REFRESH</b>(mc,  top,  mp)
       #define <b>MDB_FATAL_ERROR</b>   0x80000000U
       #define <b>MDB_ENV_ACTIVE</b>   0x20000000U
       #define <b>MDB_ENV_TXKEY</b>   0x10000000U
       #define <b>MDB_FSYNCONLY</b>   0x08000000U
       #define <b>me_pglast</b>   me_pgstate.mf_pglast
       #define <b>me_pghead</b>   me_pgstate.mf_pghead
       #define <b>me_rmutex</b>   me_txns-&gt;mti_rmutex
       #define <b>me_wmutex</b>   me_txns-&gt;mti_wmutex
       #define <b>MDB_COMMIT_PAGES</b>   64
       #define <b>MAX_WRITE</b>   (0x40000000U &gt;&gt; (sizeof(ssize_t) == 4))
       #define <b>TXN_DBI_EXIST</b>(txn,  dbi,  validity)       ((txn) &amp;&amp; (dbi)&lt;(txn)-&gt;mt_numdbs &amp;&amp;
           ((txn)-&gt;mt_dbflags[dbi] &amp; (validity)))
       #define <b>TXN_DBI_CHANGED</b>(txn,  dbi)      ((txn)-&gt;mt_dbiseqs[dbi] != (txn)-&gt;mt_env-&gt;me_dbiseqs[dbi])
       #define <b>MDB_END_NAMES</b>
       #define <b>MDB_END_OPMASK</b>   0x0F
       #define <b>MDB_END_UPDATE</b>   0x10
       #define <b>MDB_END_FREE</b>   0x20
       #define <b>MDB_END_SLOT</b>   <b>MDB_NOTLS</b>
       #define <b>MDB_PS_MODIFY</b>   1
       #define <b>MDB_PS_ROOTONLY</b>   2
       #define <b>MDB_PS_FIRST</b>   4
       #define <b>MDB_PS_LAST</b>   8
       #define <b>MDB_SPLIT_REPLACE</b>   <b>MDB_APPENDDUP</b>
       #define <b>mdb_env_close0</b>(env,  excl)   mdb_env_close1(env)
       #define <b>mdb_cmp_clong</b>   <b>mdb_cmp_cint</b>
       #define <b>mdb_cassert</b>(mc,  expr)   mdb_assert0((mc)-&gt;mc_txn-&gt;mt_env, expr, #expr)
       #define <b>mdb_tassert</b>(txn,  expr)   mdb_assert0((txn)-&gt;mt_env, expr, #expr)
       #define <b>mdb_eassert</b>(env,  expr)   mdb_assert0(env, expr, #expr)
       #define <b>mdb_assert0</b>(env,  expr,  expr_txt)
       #define <b>DO_PWRITE</b>(rc,  fd,  ptr,  size,  len,  pos)
       #define <b>MDB_NAME</b>(str)   str
       #define <b>mdb_name_cpy</b>   strcpy
       #define <b>MDB_SUFFLEN</b>   9
       #define <b>mdb_fname_destroy</b>(fname)        do { if ((fname).mn_alloced) free((fname).mn_val); } while (0)
       #define <b>MDB_CLOEXEC</b>   0
       #define <b>MDB_ERRCODE_ROFS</b>   EROFS
       #define <b>CHANGEABLE</b>   (<b>MDB_NOSYNC</b>|<b>MDB_NOMETASYNC</b>|<b>MDB_MAPASYNC</b>|<b>MDB_NOMEMINIT</b>)
       #define <b>CHANGELESS</b>
       #define <b>MDB_NOSPILL</b>   0x8000
       #define <b>WITH_CURSOR_TRACKING</b>(mn,  act)
       #define <b>MDB_WBUF</b>   (1024*1024)
       #define <b>MDB_EOF</b>   0x10
       #define <b>DO_WRITE</b>(rc,  fd,  ptr,  w2,  len)   len = write(fd, ptr, w2); rc = (len &gt;= 0)
       #define <b>DO_WRITE</b>(rc,  fd,  ptr,  w2,  len)   len = write(fd, ptr, w2); rc = (len &gt;= 0)

   <b>Typedefs</b>
       typedef pthread_mutex_t <b>mdb_mutex_t</b>[1]
       typedef pthread_mutex_t * <b>mdb_mutexref_t</b>
       typedef <b>MDB_ID</b> <b>pgno_t</b>
       typedef <b>MDB_ID</b> <b>txnid_t</b>
       typedef uint16_t <b>indx_t</b>
       typedef char <b>mdb_nchar_t</b>

   <b>Enumerations</b>
       enum { <b>MDB_END_COMMITTED</b>, <b>MDB_END_EMPTY_COMMIT</b>, <b>MDB_END_ABORT</b>, <b>MDB_END_RESET</b>, <b>MDB_END_RESET_TMP</b>,
           <b>MDB_END_FAIL_BEGIN</b>, <b>MDB_END_FAIL_BEGINCHILD</b> }
       enum <b>Pidlock_op</b> { <b>Pidset</b> = F_SETLK, <b>Pidcheck</b> = F_GETLK }
       enum <b>mdb_fopen_type</b> { <b>MDB_O_RDONLY</b> = O_RDONLY, <b>MDB_O_RDWR</b> = O_RDWR |O_CREAT, <b>MDB_O_META</b> =
           O_WRONLY|MDB_DSYNC |MDB_CLOEXEC, <b>MDB_O_COPY</b> = O_WRONLY|O_CREAT|O_EXCL|MDB_CLOEXEC, <b>MDB_O_MASK</b> =
           MDB_O_RDWR|MDB_CLOEXEC | MDB_O_RDONLY|MDB_O_META|MDB_O_COPY, <b>MDB_O_LOCKS</b> = MDB_O_RDWR|MDB_CLOEXEC |
           ((MDB_O_MASK+1) &amp; ~MDB_O_MASK) }

   <b>Functions</b>
       static int <b>mdb_page_alloc</b> (<b>MDB_cursor</b> *mc, int num, <b>MDB_page</b> **mp)
       static int <b>mdb_page_new</b> (<b>MDB_cursor</b> *mc, uint32_t flags, int num, <b>MDB_page</b> **mp)
       static int <b>mdb_page_touch</b> (<b>MDB_cursor</b> *mc)
       static void <b>mdb_txn_end</b> (<b>MDB_txn</b> *txn, unsigned mode)
       static int <b>mdb_page_get</b> (<b>MDB_cursor</b> *mc, <b>pgno_t</b> pgno, <b>MDB_page</b> **mp, int *lvl)
       static int <b>mdb_page_search_root</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, int modify)
       static int <b>mdb_page_search</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, int flags)
       static int <b>mdb_page_merge</b> (<b>MDB_cursor</b> *csrc, <b>MDB_cursor</b> *cdst)
       static int <b>mdb_page_split</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *newkey, <b>MDB_val</b> *newdata, <b>pgno_t</b> newpgno, unsigned
           int nflags)
       static int <b>mdb_env_read_header</b> (<b>MDB_env</b> *env, <b>MDB_meta</b> *meta)
       static <b>MDB_meta</b> * <b>mdb_env_pick_meta</b> (const <b>MDB_env</b> *env)
       static int <b>mdb_env_write_meta</b> (<b>MDB_txn</b> *txn)
       static void <b>mdb_env_close0</b> (<b>MDB_env</b> *env, int excl)
       static <b>MDB_node</b> * <b>mdb_node_search</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, int *exactp)
       static int <b>mdb_node_add</b> (<b>MDB_cursor</b> *mc, <b>indx_t</b> indx, <b>MDB_val</b> *key, <b>MDB_val</b> *data, <b>pgno_t</b> pgno, unsigned
           int flags)
       static void <b>mdb_node_del</b> (<b>MDB_cursor</b> *mc, int ksize)
       static void <b>mdb_node_shrink</b> (<b>MDB_page</b> *mp, <b>indx_t</b> indx)
       static int <b>mdb_node_move</b> (<b>MDB_cursor</b> *csrc, <b>MDB_cursor</b> *cdst, int fromleft)
       static int <b>mdb_node_read</b> (<b>MDB_cursor</b> *mc, <b>MDB_node</b> *leaf, <b>MDB_val</b> *data)
       static size_t <b>mdb_leaf_size</b> (<b>MDB_env</b> *env, <b>MDB_val</b> *key, <b>MDB_val</b> *data)
       static size_t <b>mdb_branch_size</b> (<b>MDB_env</b> *env, <b>MDB_val</b> *key)
       static int <b>mdb_rebalance</b> (<b>MDB_cursor</b> *mc)
       static int <b>mdb_update_key</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key)
       static void <b>mdb_cursor_pop</b> (<b>MDB_cursor</b> *mc)
       static int <b>mdb_cursor_push</b> (<b>MDB_cursor</b> *mc, <b>MDB_page</b> *mp)
       static int <b>mdb_cursor_del0</b> (<b>MDB_cursor</b> *mc)
       static int <b>mdb_del0</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_val</b> *key, <b>MDB_val</b> *data, unsigned flags)
       static int <b>mdb_cursor_sibling</b> (<b>MDB_cursor</b> *mc, int move_right)
       static int <b>mdb_cursor_next</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, <b>MDB_val</b> *data, <b>MDB_cursor_op</b> op)
       static int <b>mdb_cursor_prev</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, <b>MDB_val</b> *data, <b>MDB_cursor_op</b> op)
       static int <b>mdb_cursor_set</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, <b>MDB_val</b> *data, <b>MDB_cursor_op</b> op, int *exactp)
       static int <b>mdb_cursor_first</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, <b>MDB_val</b> *data)
       static int <b>mdb_cursor_last</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, <b>MDB_val</b> *data)
       static void <b>mdb_cursor_init</b> (<b>MDB_cursor</b> *mc, <b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_xcursor</b> *mx)
       static void <b>mdb_xcursor_init0</b> (<b>MDB_cursor</b> *mc)
       static void <b>mdb_xcursor_init1</b> (<b>MDB_cursor</b> *mc, <b>MDB_node</b> *node)
       static void <b>mdb_xcursor_init2</b> (<b>MDB_cursor</b> *mc, <b>MDB_xcursor</b> *src_mx, int force)
       static int <b>mdb_drop0</b> (<b>MDB_cursor</b> *mc, int subs)
       static void <b>mdb_default_cmp</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi)
       static int <b>mdb_reader_check0</b> (<b>MDB_env</b> *env, int rlocked, int *dead)
       char *ESECT <b>mdb_version</b> (int *major, int *minor, int *patch)
           Return the LMDB library version information.
       char * <b>mdb_strerror</b> (int err)
           Return a string describing a given error code.
       static void ESECT <b>mdb_assert_fail</b> (<b>MDB_env</b> *env, const char *expr_txt, const char *func, const char
           *file, int line)
       int <b>mdb_cmp</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, const <b>MDB_val</b> *a, const <b>MDB_val</b> *b)
           Compare two data items according to a particular database.
       int <b>mdb_dcmp</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, const <b>MDB_val</b> *a, const <b>MDB_val</b> *b)
           Compare two data items according to a particular database.
       static <b>MDB_page</b> * <b>mdb_page_malloc</b> (<b>MDB_txn</b> *txn, unsigned num)
       static void <b>mdb_page_free</b> (<b>MDB_env</b> *env, <b>MDB_page</b> *mp)
       static void <b>mdb_dpage_free</b> (<b>MDB_env</b> *env, <b>MDB_page</b> *dp)
       static void <b>mdb_dlist_free</b> (<b>MDB_txn</b> *txn)
       static int <b>mdb_page_loose</b> (<b>MDB_cursor</b> *mc, <b>MDB_page</b> *mp)
       static int <b>mdb_pages_xkeep</b> (<b>MDB_cursor</b> *mc, unsigned pflags, int all)
       static int <b>mdb_page_flush</b> (<b>MDB_txn</b> *txn, int keep)
       static int <b>mdb_page_spill</b> (<b>MDB_cursor</b> *m0, <b>MDB_val</b> *key, <b>MDB_val</b> *data)
       static <b>txnid_t</b> <b>mdb_find_oldest</b> (<b>MDB_txn</b> *txn)
       static void <b>mdb_page_dirty</b> (<b>MDB_txn</b> *txn, <b>MDB_page</b> *mp)
       static void <b>mdb_page_copy</b> (<b>MDB_page</b> *dst, <b>MDB_page</b> *src, unsigned int psize)
       static int <b>mdb_page_unspill</b> (<b>MDB_txn</b> *txn, <b>MDB_page</b> *mp, <b>MDB_page</b> **ret)
       int <b>mdb_env_sync</b> (<b>MDB_env</b> *env, int force)
           Flush the data buffers to disk.
       static int <b>mdb_cursor_shadow</b> (<b>MDB_txn</b> *src, <b>MDB_txn</b> *dst)
       static void <b>mdb_cursors_close</b> (<b>MDB_txn</b> *txn, unsigned merge)
       static int <b>mdb_reader_pid</b> (<b>MDB_env</b> *env, enum Pidlock_op op, MDB_PID_T pid)
       static int <b>mdb_txn_renew0</b> (<b>MDB_txn</b> *txn)
       int <b>mdb_txn_renew</b> (<b>MDB_txn</b> *txn)
           Renew a read-only transaction.
       int <b>mdb_txn_begin</b> (<b>MDB_env</b> *env, <b>MDB_txn</b> *parent, unsigned int flags, <b>MDB_txn</b> **ret)
           Create a transaction for use with the environment.
       <b>MDB_env</b> * <b>mdb_txn_env</b> (<b>MDB_txn</b> *txn)
           Returns the transaction's <b>MDB_env</b>.
       size_t <b>mdb_txn_id</b> (<b>MDB_txn</b> *txn)
           Return the transaction's ID.
       static void <b>mdb_dbis_update</b> (<b>MDB_txn</b> *txn, int keep)
       void <b>mdb_txn_reset</b> (<b>MDB_txn</b> *txn)
           Reset a read-only transaction.
       void <b>mdb_txn_abort</b> (<b>MDB_txn</b> *txn)
           Abandon all the operations of the transaction instead of saving them.
       static int <b>mdb_freelist_save</b> (<b>MDB_txn</b> *txn)
       int <b>mdb_txn_commit</b> (<b>MDB_txn</b> *txn)
           Commit all the operations of a transaction into the database.
       static void ESECT <b>mdb_env_init_meta0</b> (<b>MDB_env</b> *env, <b>MDB_meta</b> *meta)
       static int ESECT <b>mdb_env_init_meta</b> (<b>MDB_env</b> *env, <b>MDB_meta</b> *meta)
       int ESECT <b>mdb_env_create</b> (<b>MDB_env</b> **env)
           Create an LMDB environment handle.
       static int ESECT <b>mdb_env_map</b> (<b>MDB_env</b> *env, void *addr)
       int ESECT <b>mdb_env_set_mapsize</b> (<b>MDB_env</b> *env, size_t size)
           Set the size of the memory map to use for this environment.
       int ESECT <b>mdb_env_set_maxdbs</b> (<b>MDB_env</b> *env, <b>MDB_dbi</b> dbs)
           Set the maximum number of named databases for the environment.
       int ESECT <b>mdb_env_set_maxreaders</b> (<b>MDB_env</b> *env, unsigned int readers)
           Set the maximum number of threads/reader slots for the environment.
       int ESECT <b>mdb_env_get_maxreaders</b> (<b>MDB_env</b> *env, unsigned int *readers)
           Get the maximum number of threads/reader slots for the environment.
       static int ESECT <b>mdb_fsize</b> (<b>HANDLE</b> fd, size_t *size)
       static int ESECT <b>mdb_fname_init</b> (const char *path, unsigned envflags, <b>MDB_name</b> *fname)
       static int ESECT <b>mdb_fopen</b> (const <b>MDB_env</b> *env, <b>MDB_name</b> *fname, enum <b>mdb_fopen_type</b> which, <b>mdb_mode_t</b>
           mode, <b>HANDLE</b> *res)
       static int ESECT <b>mdb_env_open2</b> (<b>MDB_env</b> *env)
       static void <b>mdb_env_reader_dest</b> (void *ptr)
       static int ESECT <b>mdb_env_share_locks</b> (<b>MDB_env</b> *env, int *excl)
       static int ESECT <b>mdb_env_excl_lock</b> (<b>MDB_env</b> *env, int *excl)
       static int ESECT <b>mdb_env_setup_locks</b> (<b>MDB_env</b> *env, <b>MDB_name</b> *fname, int mode, int *excl)
       int ESECT <b>mdb_env_open</b> (<b>MDB_env</b> *env, const char *path, unsigned int flags, <b>mdb_mode_t</b> mode)
           Open an environment handle.
       void ESECT <b>mdb_env_close</b> (<b>MDB_env</b> *env)
           Close the environment and release the memory map.
       static int <b>mdb_cmp_long</b> (const <b>MDB_val</b> *a, const <b>MDB_val</b> *b)
       static int <b>mdb_cmp_int</b> (const <b>MDB_val</b> *a, const <b>MDB_val</b> *b)
       static int <b>mdb_cmp_cint</b> (const <b>MDB_val</b> *a, const <b>MDB_val</b> *b)
       static int <b>mdb_cmp_memn</b> (const <b>MDB_val</b> *a, const <b>MDB_val</b> *b)
       static int <b>mdb_cmp_memnr</b> (const <b>MDB_val</b> *a, const <b>MDB_val</b> *b)
       static int <b>mdb_page_search_lowest</b> (<b>MDB_cursor</b> *mc)
       static int <b>mdb_ovpage_free</b> (<b>MDB_cursor</b> *mc, <b>MDB_page</b> *mp)
       int <b>mdb_get</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_val</b> *key, <b>MDB_val</b> *data)
           Get items from a database.
       int <b>mdb_cursor_get</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, <b>MDB_val</b> *data, <b>MDB_cursor_op</b> op)
           Retrieve by cursor.
       static int <b>mdb_cursor_touch</b> (<b>MDB_cursor</b> *mc)
       int <b>mdb_cursor_put</b> (<b>MDB_cursor</b> *mc, <b>MDB_val</b> *key, <b>MDB_val</b> *data, unsigned int flags)
           Store by cursor.
       int <b>mdb_cursor_del</b> (<b>MDB_cursor</b> *mc, unsigned int flags)
           Delete current key/data pair.
       int <b>mdb_cursor_open</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_cursor</b> **ret)
           Create a cursor handle.
       int <b>mdb_cursor_renew</b> (<b>MDB_txn</b> *txn, <b>MDB_cursor</b> *mc)
           Renew a cursor handle.
       int <b>mdb_cursor_count</b> (<b>MDB_cursor</b> *mc, size_t *countp)
           Return count of duplicates for current key.
       void <b>mdb_cursor_close</b> (<b>MDB_cursor</b> *mc)
           Close a cursor handle.
       <b>MDB_txn</b> * <b>mdb_cursor_txn</b> (<b>MDB_cursor</b> *mc)
           Return the cursor's transaction handle.
       <b>MDB_dbi</b> <b>mdb_cursor_dbi</b> (<b>MDB_cursor</b> *mc)
           Return the cursor's database handle.
       static void <b>mdb_cursor_copy</b> (const <b>MDB_cursor</b> *csrc, <b>MDB_cursor</b> *cdst)
       int <b>mdb_del</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_val</b> *key, <b>MDB_val</b> *data)
           Delete items from a database.
       int <b>mdb_put</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_val</b> *key, <b>MDB_val</b> *data, unsigned int flags)
           Store items into a database.
       static THREAD_RET ESECT CALL_CONV <b>mdb_env_copythr</b> (void *arg)
       static int ESECT <b>mdb_env_cthr_toggle</b> (<b>mdb_copy</b> *my, int adjust)
       static int ESECT <b>mdb_env_cwalk</b> (<b>mdb_copy</b> *my, <b>pgno_t</b> *pg, int flags)
       static int ESECT <b>mdb_env_copyfd1</b> (<b>MDB_env</b> *env, <b>HANDLE</b> fd)
       static int ESECT <b>mdb_env_copyfd0</b> (<b>MDB_env</b> *env, <b>HANDLE</b> fd)
       int ESECT <b>mdb_env_copyfd2</b> (<b>MDB_env</b> *env, <b>HANDLE</b> fd, unsigned int flags)
       int ESECT <b>mdb_env_copyfd</b> (<b>MDB_env</b> *env, <b>HANDLE</b> fd)
       int ESECT <b>mdb_env_copy2</b> (<b>MDB_env</b> *env, const char *path, unsigned int flags)
           Copy an LMDB environment to the specified path, with options.
       int ESECT <b>mdb_env_copy</b> (<b>MDB_env</b> *env, const char *path)
           Copy an LMDB environment to the specified path.
       int ESECT <b>mdb_env_set_flags</b> (<b>MDB_env</b> *env, unsigned int flag, int onoff)
           Set environment flags.
       int ESECT <b>mdb_env_get_flags</b> (<b>MDB_env</b> *env, unsigned int *arg)
           Get environment flags.
       int ESECT <b>mdb_env_set_userctx</b> (<b>MDB_env</b> *env, void *ctx)
           Set application information associated with the <b>MDB_env</b>.
       void *ESECT <b>mdb_env_get_userctx</b> (<b>MDB_env</b> *env)
           Get the application information associated with the <b>MDB_env</b>.
       int ESECT <b>mdb_env_set_assert</b> (<b>MDB_env</b> *env, <b>MDB_assert_func</b> *func)
       int ESECT <b>mdb_env_get_path</b> (<b>MDB_env</b> *env, const char **arg)
           Return the path that was used in <b>mdb_env_open()</b>.
       int ESECT <b>mdb_env_get_fd</b> (<b>MDB_env</b> *env, <b>mdb_filehandle_t</b> *arg)
           Return the filedescriptor for the given environment.
       static int ESECT <b>mdb_stat0</b> (<b>MDB_env</b> *env, <b>MDB_db</b> *db, <b>MDB_stat</b> *arg)
       int ESECT <b>mdb_env_stat</b> (<b>MDB_env</b> *env, <b>MDB_stat</b> *arg)
           Return statistics about the LMDB environment.
       int ESECT <b>mdb_env_info</b> (<b>MDB_env</b> *env, <b>MDB_envinfo</b> *arg)
           Return information about the LMDB environment.
       int <b>mdb_dbi_open</b> (<b>MDB_txn</b> *txn, const char *name, unsigned int flags, <b>MDB_dbi</b> *dbi)
           Open a database in the environment.
       int ESECT <b>mdb_stat</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_stat</b> *arg)
           Retrieve statistics for a database.
       void <b>mdb_dbi_close</b> (<b>MDB_env</b> *env, <b>MDB_dbi</b> dbi)
           Close a database handle. Normally unnecessary. Use with care:
       int <b>mdb_dbi_flags</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, unsigned int *flags)
           Retrieve the DB flags for a database handle.
       int <b>mdb_drop</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, int del)
           Empty or delete+close a database.
       int <b>mdb_set_compare</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_cmp_func</b> *cmp)
           Set a custom key comparison function for a database.
       int <b>mdb_set_dupsort</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_cmp_func</b> *cmp)
           Set a custom data comparison function for a <b>MDB_DUPSORT</b> database.
       int <b>mdb_set_relfunc</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, <b>MDB_rel_func</b> *rel)
           Set a relocation function for a <b>MDB_FIXEDMAP</b> database.
       int <b>mdb_set_relctx</b> (<b>MDB_txn</b> *txn, <b>MDB_dbi</b> dbi, void *ctx)
           Set a context pointer for a <b>MDB_FIXEDMAP</b> database's relocation function.
       int ESECT <b>mdb_env_get_maxkeysize</b> (<b>MDB_env</b> *env)
           Get the maximum size of keys and <b>MDB_DUPSORT</b> data we can write.
       int ESECT <b>mdb_reader_list</b> (<b>MDB_env</b> *env, <b>MDB_msg_func</b> *func, void *ctx)
           Dump the entries in the reader lock table.
       static int ESECT <b>mdb_pid_insert</b> (MDB_PID_T *ids, MDB_PID_T pid)
       int ESECT <b>mdb_reader_check</b> (<b>MDB_env</b> *env, int *dead)
           Check for stale entries in the reader lock table.

   <b>Variables</b>
       static char *const <b>mdb_errstr</b> []
       static const <b>mdb_nchar_t</b> *const <b>mdb_suffixes</b> [2][2]

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       Lightning memory-mapped database library.

       A Btree-based database management library modeled loosely on the BerkeleyDB API, but much simplified.

</pre><h4><b>Macro</b> <b>Definition</b> <b>Documentation</b></h4><pre>
   <b>#define</b> <b>mr_txnid</b>   <b>mru.mrx.mrb_txnid</b>
       shorthand for mrb_txnid

   <b>#define</b> <b>mm_psize</b>   <b>mm_dbs[FREE_DBI].md_pad</b>
       The size of pages used in this DB

   <b>#define</b> <b>mm_flags</b>   <b>mm_dbs[FREE_DBI].md_flags</b>
       Any persistent environment flags. <b>Environment</b> <b>Flags</b>

   <b>#define</b> <b>MDB_FATAL_ERROR</b>   <b>0x80000000U</b>
       Failed to update the meta page. Probably an I/O error.

   <b>#define</b> <b>MDB_ENV_ACTIVE</b>   <b>0x20000000U</b>
       Some fields are initialized.

   <b>#define</b> <b>MDB_ENV_TXKEY</b>   <b>0x10000000U</b>
       me_txkey is set

   <b>#define</b> <b>MDB_FSYNCONLY</b>   <b>0x08000000U</b>
       fdatasync is unreliable

   <b>#define</b> <b>me_rmutex</b>   <b>me_txns-&gt;mti_rmutex</b>
       Shared reader lock

   <b>#define</b> <b>me_wmutex</b>   <b>me_txns-&gt;mti_wmutex</b>
       Shared writer lock

   <b>#define</b> <b>DO_PWRITE(rc,</b> <b>fd,</b> <b>ptr,</b> <b>size,</b> <b>len,</b> <b>pos)</b>
       <b>Value:</b>.PP
           do { \
           len = pwrite(fd, ptr, size, pos);   \
           if (len == -1 &amp;&amp; ErrCode() == EINTR) continue; \
           rc = (len &gt;= 0); break; } <a href="../man1/while.1.html">while</a>(1)

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for LMDB from the source code.

                                                      LMDB                                              <u><a href="../man3/mdb.c.3.html">mdb.c</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>