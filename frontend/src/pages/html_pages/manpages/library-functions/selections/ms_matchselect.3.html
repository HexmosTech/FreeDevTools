<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ms_selection - Routines to manage and use data selection lists.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmseed-doc">libmseed-doc_2.19.8-1ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ms_selection - Routines to manage and use data selection lists.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;libmseed.h&gt;</b>

       <b>Selections</b> <b>*ms_matchselect</b> <b>(</b> <b>Selections</b> <b>*</b><u>selections</u><b>,</b> <b>char</b> <b>*</b><u>srcname</u><b>,</b>
                                    <b>hptime_t</b> <u>starttime</u><b>,</b> <b>hptime_t</b> <u>endtime</u><b>,</b>
                                    <b>SelectTime</b> <b>**</b><u>ppselecttime</u> <b>);</b>

       <b>Selections</b> <b>*msr_matchselect</b> <b>(</b> <b>Selections</b> <b>*</b><u>selections</u><b>,</b> <b>MSRecord</b> <b>*</b><u>msr</u><b>,</b>
                                     <b>SelectTime</b> <b>**</b><u>ppselecttime</u> <b>);</b>

       <b>int</b>  <b>ms_addselect</b> <b>(</b> <b>Selections</b> <b>**</b><u>ppselections</u><b>,</b> <b>char</b> <b>*</b><u>srcname</u><b>,</b>
                          <b>hptime_t</b> <u>starttime</u><b>,</b> <b>hptime_t</b> <u>endtime</u> <b>);</b>

       <b>int</b>  <b>ms_addselect_comp</b> <b>(</b> <b>Selections</b> <b>**</b><u>ppselections</u><b>,</b> <b>char</b> <b>*</b><u>net</u><b>,</b>
                                <b>char</b> <b>*</b><u>sta</u><b>,</b> <b>char</b> <b>*</b><u>loc</u><b>,</b> <b>char</b> <b>*</b><u>chan</u><b>,</b> <b>char</b> <b>*</b><u>qual</u><b>,</b>
                                <b>hptime_t</b> <u>starttime</u><b>,</b> <b>hptime_t</b> <u>endtime</u> <b>);</b>

       <b>int</b>  <b>ms_readselectionsfile</b> <b>(</b> <b>Selections</b> <b>**</b><u>ppselections</u><b>,</b> <b>char</b> <b>*</b><u>filename</u> <b>);</b>

       <b>void</b> <b>ms_freeselections</b> <b>(</b> <b>Selections</b> <b>*</b><u>selections</u> <b>);</b>

       <b>void</b> <b>ms_printselections</b> <b>(</b> <b>Selections</b> <b>*</b><u>selections</u> <b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These  routines  serve  as  a convienence facility for creating a list of data selections and using it to
       match data.  The selection criteria are the <u>srcname</u> and  optional  start  and  end  times.   The  <u>srcname</u>
       components  in  a  selection  may  contain  globbing characters for matching (wildcards, character range,
       etc.).  A <u>srcname</u> is generally composed of network,  station,  location,  channel  and  optional  quality
       components; normally these are created with <b><a href="../man3/msr_srcname.3.html">msr_srcname</a>(3)</b> and <b><a href="../man3/mst_srcname.3.html">mst_srcname</a>(3)</b>.

       <b>ms_matchselect</b>  checks  for  an  entry  in  the  <b>selections</b>  list  that  matches the supplied <u>srcname</u> and
       optionally <u>starttime</u> and <u>endtime</u>.  The start and/or end times can be set to HTPERROR to mean "any"  time.
       A  selection  will  match  the  specified  time  range  if there is any overlap in time coverage.  If the
       <u>ppselecttime</u> pointer is not NULL it will be set to the matching SelectTime entry.

       <b>msr_matchselect</b> is a simple wrapper to call <b>ms_matchselect</b> using the details from a specified MSRecord.

       <b>ms_addselect</b> adds a selection entry to the <u>selections</u> list based on the  rcname  and  the  <u>starttime</u>  and
       <u>endtime</u>  boundaries.   The  source name components may contain globbing characters for matching including
       wildcards and character sets, see <b>SRCNAME</b> <b>MATCHING</b> below.  Note that the <u>ppselections</u> is a pointer  to  a
       pointer, if the secondary pointer has not been allocated (i.e. the list is empty) the first entry will be
       created and the primary pointer updated.

       <b>ms_addselect_comp</b> is a wrapper of <b>ms_addselect</b> used to add a selection entry to the <u>selections</u> list.  The
       <u>net</u>,  <u>sta</u>,  <u>loc</u>,  <u>chan</u> and <u>qual</u> source name components are used to create a <u>srcname</u>.  The name components
       may contain globbing characters for matching including wildcards and character sets, see <b>SRCNAME</b> <b>MATCHING</b>
       below.  If a name component is not specified a wildard matching all entries  will  be  substituted,  i.e.
       <u>net</u>==NULL  will be interpreted to match all network codes.  As a special case a <u>loc</u> value of "--" will be
       translated to and empty string to match the srcname representation of a blank (space-space) location ID.

       <b>ms_readselectionsfile</b> reads a file containing a list  of  selections  and  adds  them  to  the  specified
       <u>selections</u>  list.   As  with  <b>ms_addselect</b>  if the selections list is empty it will be created.  For more
       details see the <b>SELECTION</b> <b>FILE</b> section below.

       <b>ms_freeselections</b> frees all memory associated with <u>selections</u>.

       <b>ms_printselections</b> prints all of the entries in the <u>selections</u> list using the ms_log() facility.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The <b>ms_matchselect</b> and <b>msr_matchselect</b> routines return a pointer to  the  matching  Selections  entry  on
       success  and  NULL when no match was found.  These routines will also set the <u>ppselecttime</u> pointer to the
       matching SelectTime entry if supplied.

       <b>ms_addselect</b> and <b>ms_addselect_comp</b> return 0 on success and -1 on error.

       <b>ms_readselectionsfile</b> returns the number of selections added to the list or -1 on error.

</pre><h4><b>SELECTION</b> <b>FILE</b></h4><pre>
       A selection file is used to match input data records based on  network,  station,  location  and  channel
       information.   Optionally a quality and time range may also be specified for more refined selection.  The
       non-time fields may use the '*' wildcard to match multiple characters  and  the  '?'  wildcard  to  match
       single  characters.   Character  sets  may also be used, for example '[ENZ]' will match either E, N or Z.
       The '#' character indicates the remaining portion of the line will be ignored.

       Example selection file entries (the first four fields are required)
       #net sta  loc  chan  qual  start             end
       IU   ANMO *    BH?
       II   *    *    *     Q
       IU   COLA 00   LH[ENZ] R
       IU   COLA 00   LHZ   *     2008,100,10,00,00 2008,100,10,30,00

</pre><h4><b>SRCNAME</b> <b>MATCHING</b></h4><pre>
       Entries in a Selections list include a "source name" (srcname) string to  represent  matching  parameters
       for  network, station, location, channel and optionally the quality name components.  Each name component
       may contain globbing characters to match more than one unique srcname.

       Valid glob patterns include:
          *       matches zero or more characters
          ?       matches any single character
          [set]   matches any character in the set
          [^set]  matches any character NOT in the set
                  where a set is a group of characters or ranges. a range
                  is written as two characters separated with a hyphen:
                  a-z denotes all characters between a to z inclusive.
          [-set]  set matches a literal hyphen and any character in the set
          []set]  matches a literal close bracket and any character in the set

          char    matches itself except where char is '*' or '?' or '['

        examples:
          a*c             ac abc abbc ...
          a?c             acc abc aXc ...
          a[a-z]c         aac abc acc ...
          a[-a-z]c        a-c aac abc ...

</pre><h4><b>EXAMPLE</b> <b>USAGE</b></h4><pre>
       The primary intention of the Selections list facility is to limit data to a specific  selection  as  it's
       read into a program.  This is illustrated below.

       main() {
         MSRecord *msr = NULL;
         Selections *selections = NULL;
         hptime_t starttime;
         hptime_t endtime;
         int retcode;

         ms_addselect (&amp;selections, "IU_*_*_LH?_?", HPTERROR, HPTERROR);

         starttime = timestr2hptime ("2009/1/15 00:00:00.00");
         endtime = timestr2hptime ("2009/1/31 23:59:59.99");
         ms_addselect (&amp;selections, "IU_ANMO_00_LH?_?", starttime, endtime);

         while ( (retcode = ms_readmsr (&amp;msr, filename, 0, NULL, NULL, 1, 0, verbose)) == MS_NOERROR )
           {
              /* Print details if data record matches selection criteria */
              if ( msr_matchselect (selections, msr, NULL) )
                {
                  msr_print (msr, verbose);
                }
           }

         if ( retcode != MS_ENDOFFILE )
           ms_log (2, "Error reading input file %s: %s\n",
                   filename, ms_errorstr(retcode));

         /* Cleanup memory and close file */
         ms_readmsr (&amp;msr, NULL, 0, NULL, NULL, 0, 0, verbose);
       } /* End of main() */

       The following two calls are equivalent:
         ms_addselect (&amp;selections, "IU_ANMO_00_LH?_?", starttime, endtime);
         ms_addselect_comp (&amp;selections, "IU", "ANMO", "00", "LH?", "?", startime, endtime);

       As a further convienence usage of <b>ms_readselectionsfile()</b> would allow the selections to be specified in a
       simple ASCII file and avoid the need to directly call <b>ms_addselect()</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/msr_srcname.3.html">msr_srcname</a>(3)</b> and <b><a href="../man3/mst_srcname.3.html">mst_srcname</a>(3)</b>.

</pre><h4><b>AUTHOR</b></h4><pre>
       Chad Trabant
       IRIS Data Management Center

Libmseed API                                       2012/12/28                                    <u><a href="../man3/MS_SELECTION.3.html">MS_SELECTION</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>