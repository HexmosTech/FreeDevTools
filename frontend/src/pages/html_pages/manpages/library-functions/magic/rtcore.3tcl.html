<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fileutil::magic::rt - Runtime core for file type recognition engines written in pure Tcl</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fileutil::magic::rt - Runtime core for file type recognition engines written in pure Tcl

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>fileutil::magic::rt</b> <b>?2.0?</b>

       <b>::fileutil::magic::rt::&gt;</b>

       <b>::fileutil::magic::rt::&lt;</b>

       <b>::fileutil::magic::rt::new</b> <u>chan</u> <u>named</u> <u>analyze</u>

       <b>::fileutil::magic::rt::file_start</b> <u>name</u>

       <b>::fileutil::magic::rt::emit</b> <u>msg</u>

       <b>::fileutil::magic::rt::O</b> <u>where</u>

       <b>::fileutil::magic::rt::R</b> <u>where</u>

       <b>::fileutil::magic::rt::Nv</b> <u>type</u> <u>offset</u> <u>compinvert</u> <u>comp</u> <u>expected</u>

       <b>::fileutil::magic::rt::N</b> <u>type</u> <u>offset</u> <u>testinvert</u> <u>compinvert</u> <u>mod</u> <u>mand</u> <u>comp</u> <u>expected</u>

       <b>::fileutil::magic::rt::S</b> <u>type</u> <u>offset</u> <u>testinvert</u> <u>mod</u> <u>mand</u> <u>comp</u> <u>val</u>

       <b>::fileutil::magic::rt::L</b> <u>newlevel</u>

       <b>::fileutil::magic::rt::I</b> <u>offset</u> <u>it</u> <u>ioi</u> <u>ioo</u> <u>iir</u> <u>io</u>

       <b>::fileutil::magic::rt::R</b> <u>offset</u>

       <b>::fileutil::magic::rt::U</b> <u>fileindex</u> <u>name</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  package provides the runtime core for file type recognition engines written in pure Tcl and is thus
       used by all other packages in this module such as <b>fileutil::magic::filetype</b> and the two compiler packages
       <b>fileutil::magic::cgen</b> and <b>fileutil::magic::cfront</b>.

</pre><h4><b>COMMANDS</b></h4><pre>
       <b>::fileutil::magic::rt::&gt;</b>
              Increment the level and perform related housekeeping

       <b>::fileutil::magic::rt::&lt;</b>
              Decrement the level and perform related housekeeping

       <b>::fileutil::magic::rt::new</b> <u>chan</u> <u>named</u> <u>analyze</u>
              Create a new command which returns one description of the file each time it is called, and a  code
              of  <u>break</u>  when  there  are  no  more  descriptions.   <u>chan</u>  is the channel containing the data to
              describe.  The channel configuration is then managed as needed.  <u>named</u> is a  dictionary  of  named
              tests,  as  generated by <b>fileutil::magic::cfront::compile</b>.  <u>test</u> is a command prefix for a routine
              composed of the list of commands as returned by <b>fileutil::magic::cfront::compile</b>.

       <b>::fileutil::magic::rt::file_start</b> <u>name</u>
              This command marks the start of a magic file when debugging. It returns the empty  string  as  its
              result.

       <b>::fileutil::magic::rt::emit</b> <u>msg</u>
              This command adds the text <u>msg</u> to the result buffer. The message may contain the following special
              character sequences. They will be replaced with buffered values before the message is added to the
              result. The command returns the empty string as its result.

              <b>\b</b>     This sequence is removed

              <b>%s</b>     Replaced with the last buffered string value.

              <b>%ld</b>    Replaced with the last buffered numeric value.

              <b>%d</b>     See above.

              <b>${x:...?...}</b>
                     Substitute one string if the file is executable, and another string otherwise.

       <b>::fileutil::magic::rt::O</b> <u>where</u>
              Produce  an offset from <u>where</u>, relative to the cursor one level up.  Produce an offset from <u>where</u>,
              relative to the offset one level up.

       <b>::fileutil::magic::rt::Nv</b> <u>type</u> <u>offset</u> <u>compinvert</u> <u>comp</u> <u>expected</u>
              A limited form of <b>::fileutile::magic::rt::N</b> that only checks for equality and  can't  be  told  to
              invert the test.

       <b>::fileutil::magic::rt::N</b> <u>type</u> <u>offset</u> <u>testinvert</u> <u>compinvert</u> <u>mod</u> <u>mand</u> <u>comp</u> <u>expected</u>
              Fetch  the  numeric  value  with  <u>type</u> from the absolute location <u>offset</u>, compare it with <u>expected</u>
              using <u>comp</u> as the comparision operator,  and returns the result.

              The argument <u>comp</u> must be one of Tcl's comparison operators.

                &lt;comp&gt; &lt;fetched-and-masked-value&gt; &lt;comp&gt; &lt;expected&gt;

       The special comparison operator <b>x</b> signals that no comparison should be done, or, in other words, that the
       fetched value will always match <u>val</u>.

       <b>::fileutil::magic::rt::S</b> <u>type</u> <u>offset</u> <u>testinvert</u> <u>mod</u> <u>mand</u> <u>comp</u> <u>val</u>
              Like <b>::fileutil::magic::rt::N</b> except that it fetches and compares string types , not numeric data.

       <b>::fileutil::magic::rt::L</b> <u>newlevel</u>
              Sets the current level in the calling context to <u>newlevel</u>. The command returns the empty string as
              its result.

       <b>::fileutil::magic::rt::I</b> <u>offset</u> <u>it</u> <u>ioi</u> <u>ioo</u> <u>iir</u> <u>io</u>
              Calculates an offset based on an initial offset and the provided modifiers.

       <b>::fileutil::magic::rt::R</b> <u>offset</u>
              Given an initial offset, calculates an offset relative to the cursor at the  next  level  up.  The
              cursor  is the position in the data one character after the data extracted from the file one level
              up.

       <b>::fileutil::magic::rt::U</b> <u>fileindex</u> <u>name</u>
              Add a level and use a named test script.

</pre><h4><b>NUMERIC</b> <b>TYPES</b></h4><pre>
       <b>byte</b>   8-bit integer

       <b>short</b>  16-bit integer, stored in native endianess

       <b>beshort</b>
              see above, stored in big endian

       <b>leshort</b>
              see above, stored in small/little endian

       <b>long</b>   32-bit integer, stored in native endianess

       <b>belong</b> see above, stored in big endian

       <b>lelong</b> see above, stored in small/little endian

       All of the types above exit in an unsigned form as well. The type names are the same, with the  character
       "u" added as prefix.

       <b>date</b>   32-bit integer timestamp, stored in native endianess

       <b>bedate</b> see above, stored in big endian

       <b>ledate</b> see above, stored in small/little endian

       <b>ldate</b>  32-bit integer timestamp, stored in native endianess

       <b>beldate</b>
              see above, stored in big endian

       <b>leldate</b>
              see above, stored in small/little endian

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This  document,  and  the package it describes, will undoubtedly contain bugs and other problems.  Please
       report    such    in    the    category    <u>fileutil</u>    <u>::</u>    <u>magic</u>     of     the     <u>Tcllib</u>     <u>Trackers</u>
       [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].   Please  also report any ideas for enhancements you may have for
       either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note further that <u>attachments</u> are strongly preferred over inlined patches. Attachments  can  be  made  by
       going  to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most button
       in the secondary navigation bar.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/file.1.html">file</a>(1), fileutil, <a href="../man5/magic.5.html">magic</a>(5)

</pre><h4><b>KEYWORDS</b></h4><pre>
       file recognition, file type, file utilities, mime, type

</pre><h4><b>CATEGORY</b></h4><pre>
       Programming tools

tcllib                                                 2.0                             <u>fileutil::magic::<a href="../man3tcl/rt.3tcl.html">rt</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>