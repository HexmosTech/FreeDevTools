<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tcl_ZlibAdler32,     Tcl_ZlibCRC32,     Tcl_ZlibDeflate,     Tcl_ZlibInflate,     Tcl_ZlibStreamChecksum,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl9.0-doc">tcl9.0-doc_9.0.1+dfsg-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Tcl_ZlibAdler32,     Tcl_ZlibCRC32,     Tcl_ZlibDeflate,     Tcl_ZlibInflate,     Tcl_ZlibStreamChecksum,
       Tcl_ZlibStreamClose,      Tcl_ZlibStreamEof,       Tcl_ZlibStreamGet,       Tcl_ZlibStreamGetCommandName,
       Tcl_ZlibStreamInit, Tcl_ZlibStreamPut - compression and decompression functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;tcl.h&gt;

       int
       <b>Tcl_ZlibDeflate</b>(<u>interp,</u> <u>format,</u> <u>dataObj,</u> <u>level,</u> <u>dictObj</u>)

       int
       <b>Tcl_ZlibInflate</b>(<u>interp,</u> <u>format,</u> <u>dataObj,</u> <u>bufferSize,</u> <u>dictObj</u>)

       unsigned int
       <b>Tcl_ZlibCRC32</b>(<u>initValue,</u> <u>bytes,</u> <u>length</u>)

       unsigned int
       <b>Tcl_ZlibAdler32</b>(<u>initValue,</u> <u>bytes,</u> <u>length</u>)

       int
       <b>Tcl_ZlibStreamInit</b>(<u>interp,</u> <u>mode,</u> <u>format,</u> <u>level,</u> <u>dictObj,</u> <u>zshandlePtr</u>)

       Tcl_Obj *
       <b>Tcl_ZlibStreamGetCommandName</b>(<u>zshandle</u>)

       int
       <b>Tcl_ZlibStreamEof</b>(<u>zshandle</u>)

       int
       <b>Tcl_ZlibStreamClose</b>(<u>zshandle</u>)

       int
       <b>Tcl_ZlibStreamReset</b>(<u>zshandle</u>)

       int
       <b>Tcl_ZlibStreamChecksum</b>(<u>zshandle</u>)

       int
       <b>Tcl_ZlibStreamPut</b>(<u>zshandle,</u> <u>dataObj,</u> <u>flush</u>)

       int
       <b>Tcl_ZlibStreamGet</b>(<u>zshandle,</u> <u>dataObj,</u> <u>count</u>)

       <b>Tcl_ZlibStreamSetCompressionDictionary</b>(<u>zshandle,</u> <u>compDict</u>)

</pre><h4><b>ARGUMENTS</b></h4><pre>
       Tcl_Interp <u>*interp</u> (in)               The  interpreter to store resulting compressed or uncompressed data
                                             in.   Also   where   any   error   messages   are   written.    For
                                             <b>Tcl_ZlibStreamInit</b>, this can be NULL to create a stream that is not
                                             bound to a command.

       int <u>format</u> (in)                       What  format  of  compressed  data  to  work  with.  Must be one of
                                             <b>TCL_ZLIB_FORMAT_ZLIB</b> for zlib-format data, <b>TCL_ZLIB_FORMAT_GZIP</b> for
                                             gzip-format data, or <b>TCL_ZLIB_FORMAT_RAW</b> for raw  compressed  data.
                                             In  addition, for decompression only, <b>TCL_ZLIB_FORMAT_AUTO</b> may also
                                             be chosen which can automatically  detect  whether  the  compressed
                                             data was in zlib or gzip format.

       Tcl_Obj <u>*dataObj</u> (in/out)             A  byte-array  value  containing  the  data  to  be  compressed  or
                                             decompressed, or to which the data extracted  from  the  stream  is
                                             appended when passed to <b>Tcl_ZlibStreamGet</b>.

       int <u>level</u> (in)                        What level of compression to use. Should be a number from 0 to 9 or
                                             one  of  the  following: <b>TCL_ZLIB_COMPRESS_NONE</b> for no compression,
                                             <b>TCL_ZLIB_COMPRESS_FAST</b>  for  fast  but   inefficient   compression,
                                             <b>TCL_ZLIB_COMPRESS_BEST</b>   for   slow  but  maximal  compression,  or
                                             <b>TCL_ZLIB_COMPRESS_DEFAULT</b> for the level  recommended  by  the  zlib
                                             library.

       Tcl_Obj <u>*dictObj</u> (in/out)             A  dictionary that contains, or which will be updated to contain, a
                                             description of the gzip header associated with the compressed data.
                                             Only  useful   when   the   <u>format</u>   is   <b>TCL_ZLIB_FORMAT_GZIP</b>   or
                                             <b>TCL_ZLIB_FORMAT_AUTO</b>. If a NULL is passed, a default header will be
                                             used  on  compression  and  the  header will be ignored (apart from
                                             integrity checks) on decompression. See the  section  <b>GZIP</b>  <b>OPTIONS</b>
                                             <b>DICTIONARY</b> for details about the contents of this dictionary.

       unsigned int <u>initValue</u> (in)           The initial value for the checksum algorithm.

       Tcl_Size <u>bufferSize</u> (in)              A hint as to what size of buffer is to be used to receive the data.
                                             Use 0 to use a geric guess based on the input data.

       unsigned char <u>*bytes</u> (in)             An  array  of  bytes to run the checksum algorithm over, or NULL to
                                             get the recommended initial value for the checksum algorithm.

       Tcl_Size <u>length</u> (in)                  The number of bytes in the array.

       int <u>mode</u> (in)                         What  mode  to  operate   the   stream   in.   Should   be   either
                                             <b>TCL_ZLIB_STREAM_DEFLATE</b>     for    a    compressing    stream    or
                                             <b>TCL_ZLIB_STREAM_INFLATE</b> for a decompressing stream.

       Tcl_ZlibStream <u>*zshandlePtr</u> (out)     A pointer to a variable in which to write the  abstract  token  for
                                             the stream upon successful creation.

       Tcl_ZlibStream <u>zshandle</u> (in)          The abstract token for the stream to operate on.

       int <u>flush</u> (in)                        Whether  and  how to flush the stream after writing the data to it.
                                             Must be one of: <b>TCL_ZLIB_NO_FLUSH</b> if no flushing  is  to  be  done,
                                             <b>TCL_ZLIB_FLUSH</b>  if  the  currently  compressed  data  must  be made
                                             available for access using <b>Tcl_ZlibStreamGet</b>, <b>TCL_ZLIB_FULLFLUSH</b> if
                                             the stream must be put into a  state  where  the  decompressor  can
                                             recover from on corruption, or <b>TCL_ZLIB_FINALIZE</b> to ensure that the
                                             stream  is  finished and that any trailer demanded by the format is
                                             written.

       Tcl_Size <u>count</u> (in)                   The maximum number of bytes to get from the stream, or  -1  to  get
                                             all remaining bytes from the stream's buffers.

       Tcl_Obj <u>*compDict</u> (in)                A  byte  array value that is the compression dictionary to use with
                                             the stream.  Note that this is <u>not</u> <u>a</u>  <u>Tcl</u>  <u>dictionary</u>,  and  it  is
                                             recommended  that  this  only  ever  be used with streams that were
                                             created with their <u>format</u> set to <b>TCL_ZLIB_FORMAT_ZLIB</b>  because  the
                                             other  formats  have no mechanism to indicate whether a compression
                                             dictionary was present other than to fail on decompression.
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These functions form the interface from the Tcl library to the Zlib library by Jean-loup Gailly and  Mark
       Adler.

       <b>Tcl_ZlibDeflate</b>  and  <b>Tcl_ZlibInflate</b>  respectively  compress  and  decompress  the data contained in the
       <u>dataObj</u> argument, according to the <u>format</u> and, for compression, <u>level</u> arguments. The  dictionary  in  the
       <u>dictObj</u>  parameter  is  used  to  convey additional header information about the compressed data when the
       compression format supports it; currently, the dictionary is only  used  when  the  <u>format</u>  parameter  is
       <b>TCL_ZLIB_FORMAT_GZIP</b> or <b>TCL_ZLIB_FORMAT_AUTO</b>. For details of the contents of the dictionary, see the <b>GZIP</b>
       <b>OPTIONS</b>  <b>DICTIONARY</b>  section  below.  Upon  success,  both  functions  leave  the resulting compressed or
       decompressed data in a byte-array value that is the Tcl interpreter's result; the  returned  value  is  a
       standard Tcl result code.

       <b>Tcl_ZlibAdler32</b>  and <b>Tcl_ZlibCRC32</b> compute checksums on arrays of bytes, returning the computed checksum.
       Checksums are computed incrementally, allowing data to be  processed  one  block  at  a  time,  but  this
       requires  the  caller  to  maintain  the  current checksum and pass it in as the <u>initValue</u> parameter; the
       initial value to use for this can be obtained by using NULL for the <u>bytes</u> parameter instead of a  pointer
       to  the array of bytes to compute the checksum over. Thus, typical usage in the single data block case is
       like this:

              checksum = <b>Tcl_ZlibCRC32</b>(<b>Tcl_ZlibCRC32</b>(0,NULL,0), data, length);

       Note that the Adler-32 algorithm is not a real checksum, but instead is a related type of hash that works
       best on longer data.

   <b>ZLIB</b> <b>STREAMS</b>
       <b>Tcl_ZlibStreamInit</b> creates a compressing or decompressing  stream  that  is  linked  to  a  Tcl  command,
       according to its arguments, and provides an abstract token for the stream and returns a normal Tcl result
       code;  <b>Tcl_ZlibStreamGetCommandName</b>  returns  the name of that command given the stream token, or NULL if
       the stream has no command. Streams are not designed to be thread-safe; each stream should  only  ever  be
       used  from  the  thread that created it. When working with gzip streams, a dictionary (fields as given in
       the <b>GZIP</b> <b>OPTIONS</b> <b>DICTIONARY</b> section below) can be given via the <u>dictObj</u>  parameter  that  on  compression
       allows control over the generated headers, and on decompression allows discovery of the existing headers.
       Note that the dictionary will be written to on decompression once sufficient data has been read to have a
       complete  header.  This  means  that the dictionary must be an unshared value in that case; a blank value
       created with <b>Tcl_NewObj</b> is suggested.

       Once a  stream  has  been  constructed,  <b>Tcl_ZlibStreamPut</b>  is  used  to  add  data  to  the  stream  and
       <b>Tcl_ZlibStreamGet</b>  is  used  to  retrieve  data  from the stream after processing. Both return normal Tcl
       result codes and leave an error message in the result of the interpreter that the  stream  is  registered
       with  in  the  error  case  (if such a registration has been performed). With <b>Tcl_ZlibStreamPut</b>, the data
       buffer value passed to it should not be modified afterwards.  With  <b>Tcl_ZlibStreamGet</b>,  the  data  buffer
       value  passed  to  it  will  have  the  data bytes appended to it. Internally to the stream, data is kept
       compressed so as to minimize the cost of buffer space.

       <b>Tcl_ZlibStreamChecksum</b> returns the checksum computed over the uncompressed data according to the  format,
       and  <b>Tcl_ZlibStreamEof</b>  returns  a  boolean value indicating whether the end of the uncompressed data has
       been reached.

       <b>Tcl_ZlibStreamSetCompressionDictionary</b> is used to  control  the  compression  dictionary  used  with  the
       stream,   a   compression   dictionary   being  an  array  of  bytes  (such  as  might  be  created  with
       <b>Tcl_NewByteArrayObj</b>) that is used to initialize the compression engine rather than leaving it  to  create
       it  on the fly from the data being compressed. Setting a compression dictionary allows for more efficient
       compression in the case where the start of the data is highly regular,  but  it  does  require  both  the
       compressor  and  the  decompressor  to agree on the value to use. Compression dictionaries are only fully
       supported for zlib-format data; on compression, they must  be  set  before  any  data  is  sent  in  with
       <b>Tcl_ZlibStreamPut</b>,  and on decompression they should be set when <b>Tcl_ZlibStreamGet</b> produces an <b>error</b> with
       its <b>-errorcode</b> set to “<b>ZLIB</b> <b>NEED_DICT</b> <u>code</u>”; the <u>code</u> will be the Adler-32 checksum (see <b>Tcl_ZlibAdler32</b>)
       of the compression dictionary sought. (Note that this is only true for zlib-format streams; gzip  streams
       ignore  compression  dictionaries  as  the format specification doesn't permit them, and raw streams just
       produce a data error if the compression dictionary is missing or incorrect.)

       If  you  wish  to  clear  a  stream  and  reuse  it  for  a  new  compression  or  decompression  action,
       <b>Tcl_ZlibStreamReset</b>  will  do  this  and  return  a  normal  Tcl  result  code to indicate whether it was
       successful; if the stream is registered with an interpreter,  an  error  message  will  be  left  in  the
       interpreter  result when this function returns TCL_ERROR.  Finally, <b>Tcl_ZlibStreamClose</b> will clean up the
       stream and delete the associated command: using <b>Tcl_DeleteCommand</b> on the stream's command  is  equivalent
       (when such a command exists).

</pre><h4><b>GZIP</b> <b>OPTIONS</b> <b>DICTIONARY</b></h4><pre>
       The  <u>dictObj</u>  parameter  to  <b>Tcl_ZlibDeflate</b>,  <b>Tcl_ZlibInflate</b>  and  <b>Tcl_ZlibStreamInit</b> is used to pass a
       dictionary of options about that is used to describe  the  gzip  header  in  the  compressed  data.  When
       creating  compressed  data,  the  dictionary is read and when unpacking compressed data the dictionary is
       written (in which case the <u>dictObj</u> parameter must refer to an unshared dictionary value).

       The following fields in the dictionary value are understood. All other fields are ignored.  No  field  is
       required when creating a gzip-format stream.

       <b>comment</b>
              This  holds  the  comment  field of the header, if present. If absent, no comment was supplied (on
              decompression) or will be created (on compression).

       <b>crc</b>    A boolean value describing whether a CRC of the header is computed. Note  that  the  <b>gzip</b>  program
              does <u>not</u> use or allow a CRC on the header.

       <b>filename</b>
              The  name  of  the  file  that  held  the uncompressed data. This should not contain any directory
              separators, and should be sanitized before use on decompression with <b>file</b> <b>tail</b>.

       <b>os</b>     The operating system type code field from the header (if not the “unknown” value).  See  RFC  1952
              for  the  meaning  of these codes. On compression, if this is absent then the field will be set to
              the “unknown” value.

       <b>size</b>   The size of the uncompressed data. This is ignored on compression; the size of the data compressed
              depends on how much data is supplied to the compression engine.

       <b>time</b>   The time field from the header if non-zero, expected to be the time that the  file  named  by  the
              <b>filename</b>  field  was modified. Suitable for use with <b>clock</b> <b>format</b>. On creation, the right value to
              use is that from <b>clock</b> <b>seconds</b> or <b>file</b> <b>mtime</b>.

       <b>type</b>   The type of the uncompressed data (either <b>binary</b> or <b>text</b>) if known.

</pre><h4><b>REFERENCE</b> <b>COUNT</b> <b>MANAGEMENT</b></h4><pre>
       <b>Tcl_ZlibDeflate</b> and <b>Tcl_ZlibInflate</b> take a value with arbitrary reference count  for  their  <u>dataObj</u>  and
       <u>dictObj</u> arguments (the latter often being NULL instead), and set the interpreter result with their output
       value  (or  an error).  The existing interpreter result should not be passed as any argument value unless
       an additional reference is held.

       <b>Tcl_ZlibStreamInit</b> takes a value with arbitrary reference count for its <u>dictObj</u> argument; it  only  reads
       from it. The existing interpreter result should not be passed unless an additional reference is held.

       <b>Tcl_ZlibStreamGetCommandName</b> returns a zero reference count value, much like <b>Tcl_NewObj</b>.

       The <u>dataObj</u> argument to <b>Tcl_ZlibStreamPut</b> is a value with arbitrary reference count; it is only ever read
       from.

       The <u>dataObj</u> argument to <b>Tcl_ZlibStreamGet</b> is an unshared value (see <b>Tcl_IsShared</b>) that will be updated by
       the function.

       The  <u>compDict</u>  argument  to <b>Tcl_ZlibStreamSetCompressionDictionary</b>, if non-NULL, may be duplicated or may
       have its reference count incremented.  Using a zero reference count value is not recommended.

</pre><h4><b>PORTABILITY</b> <b>NOTES</b></h4><pre>
       These functions will fail gracefully if Tcl is not linked with the zlib library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/Tcl_NewByteArrayObj.3tcl.html">Tcl_NewByteArrayObj</a>(3tcl), <a href="../man3tcl/zlib.3tcl.html">zlib</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       compress, decompress, deflate, gzip, inflate

Tcl                                                    8.6                                         <u><a href="../man3tcl/TclZlib.3tcl.html">TclZlib</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>