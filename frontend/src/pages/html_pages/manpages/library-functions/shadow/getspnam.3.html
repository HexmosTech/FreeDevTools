<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>getspnam,  getspnam_r,  getspent,  getspent_r,  setspent,  endspent,  fgetspent,  fgetspent_r, sgetspent,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       getspnam,  getspnam_r,  getspent,  getspent_r,  setspent,  endspent,  fgetspent,  fgetspent_r, sgetspent,
       sgetspent_r, putspent, lckpwdf, ulckpwdf - get shadow password file entry

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       /* General shadow password file API */
       <b>#include</b> <b>&lt;<a href="file:/usr/include/shadow.h">shadow.h</a>&gt;</b>

       <b>struct</b> <b>spwd</b> <b>*getspnam(const</b> <b>char</b> <b>*</b><u>name</u><b>);</b>
       <b>struct</b> <b>spwd</b> <b>*getspent(void);</b>

       <b>void</b> <b>setspent(void);</b>
       <b>void</b> <b>endspent(void);</b>

       <b>struct</b> <b>spwd</b> <b>*fgetspent(FILE</b> <b>*</b><u>stream</u><b>);</b>
       <b>struct</b> <b>spwd</b> <b>*sgetspent(const</b> <b>char</b> <b>*</b><u>s</u><b>);</b>

       <b>int</b> <b>putspent(const</b> <b>struct</b> <b>spwd</b> <b>*</b><u>p</u><b>,</b> <b>FILE</b> <b>*</b><u>stream</u><b>);</b>

       <b>int</b> <b>lckpwdf(void);</b>
       <b>int</b> <b>ulckpwdf(void);</b>

       /* GNU extension */
       <b>#include</b> <b>&lt;<a href="file:/usr/include/shadow.h">shadow.h</a>&gt;</b>

       <b>int</b> <b>getspent_r(struct</b> <b>spwd</b> <b>*</b><u>spbuf</u><b>,</b>
                      <b>char</b> <u>buf</u><b>[.</b><u>buflen</u><b>],</b> <b>size_t</b> <u>buflen</u><b>,</b> <b>struct</b> <b>spwd</b> <b>**</b><u>spbufp</u><b>);</b>
       <b>int</b> <b>getspnam_r(const</b> <b>char</b> <b>*</b><u>name</u><b>,</b> <b>struct</b> <b>spwd</b> <b>*</b><u>spbuf</u><b>,</b>
                      <b>char</b> <u>buf</u><b>[.</b><u>buflen</u><b>],</b> <b>size_t</b> <u>buflen</u><b>,</b> <b>struct</b> <b>spwd</b> <b>**</b><u>spbufp</u><b>);</b>

       <b>int</b> <b>fgetspent_r(FILE</b> <b>*</b><u>stream</u><b>,</b> <b>struct</b> <b>spwd</b> <b>*</b><u>spbuf</u><b>,</b>
                      <b>char</b> <u>buf</u><b>[.</b><u>buflen</u><b>],</b> <b>size_t</b> <u>buflen</u><b>,</b> <b>struct</b> <b>spwd</b> <b>**</b><u>spbufp</u><b>);</b>
       <b>int</b> <b>sgetspent_r(const</b> <b>char</b> <b>*</b><u>s</u><b>,</b> <b>struct</b> <b>spwd</b> <b>*</b><u>spbuf</u><b>,</b>
                      <b>char</b> <u>buf</u><b>[.</b><u>buflen</u><b>],</b> <b>size_t</b> <u>buflen</u><b>,</b> <b>struct</b> <b>spwd</b> <b>**</b><u>spbufp</u><b>);</b>

   Feature Test Macro Requirements for glibc (see <b><a href="../man7/feature_test_macros.7.html">feature_test_macros</a></b>(7)):

       <b>getspent_r</b>(), <b>getspnam_r</b>(), <b>fgetspent_r</b>(), <b>sgetspent_r</b>():
           Since glibc 2.19:
               _DEFAULT_SOURCE
           glibc 2.19 and earlier:
               _BSD_SOURCE || _SVID_SOURCE

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Long ago it was considered safe to have encrypted passwords openly visible in the  password  file.   When
       computers  got  faster  and  people got more security-conscious, this was no longer acceptable.  Julianne
       Frances Haugh implemented the shadow password suite that keeps the  encrypted  passwords  in  the  shadow
       password  database  (e.g.,  the  local shadow password file <u><a href="file:/etc/shadow">/etc/shadow</a></u>, NIS, and LDAP), readable only by
       root.

       The functions described below resemble those for the traditional password database (e.g., see <b><a href="../man3/getpwnam.3.html">getpwnam</a></b>(3)
       and <b><a href="../man3/getpwent.3.html">getpwent</a></b>(3)).

       The <b>getspnam</b>() function returns a pointer to a structure containing the broken-out fields of  the  record
       in the shadow password database that matches the username <u>name</u>.

       The  <b>getspent</b>()  function  returns  a  pointer  to  the  next entry in the shadow password database.  The
       position in the input stream is initialized by <b>setspent</b>().  When  done  reading,  the  program  may  call
       <b>endspent</b>() so that resources can be deallocated.

       The  <b>fgetspent</b>()  function  is  similar  to  <b>getspent</b>()  but  uses the supplied stream instead of the one
       implicitly opened by <b>setspent</b>().

       The <b>sgetspent</b>() function parses the supplied string <u>s</u> into a struct <u>spwd</u>.

       The <b>putspent</b>() function writes the contents of the supplied struct <u>spwd</u> <u>*p</u> as a text line in  the  shadow
       password  file  format to <u>stream</u>.  String entries with value NULL and numerical entries with value -1 are
       written as an empty string.

       The <b>lckpwdf</b>() function is intended to protect  against  multiple  simultaneous  accesses  of  the  shadow
       password  database.   It  tries  to  acquire a lock, and returns 0 on success, or -1 on failure (lock not
       obtained within 15 seconds).  The <b>ulckpwdf</b>() function releases the lock again.  Note  that  there  is  no
       protection  against  direct  access  of  the shadow password file.  Only programs that use <b>lckpwdf</b>() will
       notice the lock.

       These were the functions that formed the original shadow API.  They are widely available.

   <b>Reentrant</b> <b>versions</b>
       Analogous to the reentrant functions for the password database, glibc also has  reentrant  functions  for
       the  shadow  password  database.   The  <b>getspnam_r</b>() function is like <b>getspnam</b>() but stores the retrieved
       shadow password structure in the space pointed to by <u>spbuf</u>.   This  shadow  password  structure  contains
       pointers  to  strings,  and  these strings are stored in the buffer <u>buf</u> of size <u>buflen</u>.  A pointer to the
       result (in case of success) or NULL (in case no entry was found  or  an  error  occurred)  is  stored  in
       <u>*spbufp</u>.

       The   functions   <b>getspent_r</b>(),  <b>fgetspent_r</b>(),  and  <b>sgetspent_r</b>()  are  similarly  analogous  to  their
       nonreentrant counterparts.

       Some non-glibc systems also have functions with these names, often with different prototypes.

   <b>Structure</b>
       The shadow password structure is defined in <u>&lt;shadow.h&gt;</u> as follows:

           struct spwd {
               char *sp_namp;     /* Login name */
               char *sp_pwdp;     /* Encrypted password */
               long  sp_lstchg;   /* Date of last change
                                     (measured in days since
                                     1970-01-01 00:00:00 +0000 (UTC)) */
               long  sp_min;      /* Min # of days between changes */
               long  sp_max;      /* Max # of days between changes */
               long  sp_warn;     /* # of days before password expires
                                     to warn user to change it */
               long  sp_inact;    /* # of days after password expires
                                     until account is disabled */
               long  sp_expire;   /* Date when account expires
                                     (measured in days since
                                     1970-01-01 00:00:00 +0000 (UTC)) */
               unsigned long sp_flag;  /* Reserved */
           };

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The functions that return a pointer return NULL if no more entries are available or if  an  error  occurs
       during  processing.   The  functions  which  have <u>int</u> as the return value return 0 for success and -1 for
       failure, with <u>errno</u> set to indicate the error.

       For the nonreentrant functions, the return value may point to static area,  and  may  be  overwritten  by
       subsequent calls to these functions.

       The reentrant functions return zero on success.  In case of error, an error number is returned.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EACCES</b> The caller does not have permission to access the shadow password file.

       <b>ERANGE</b> Supplied buffer is too small.

</pre><h4><b>FILES</b></h4><pre>
       <u><a href="file:/etc/shadow">/etc/shadow</a></u>
              local shadow password database file

       <u><a href="file:/etc/.pwd.lock">/etc/.pwd.lock</a></u>
              lock file

       The include file <u>&lt;paths.h&gt;</u> defines the constant <b>_PATH_SHADOW</b> to the pathname of the shadow password file.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       For an explanation of the terms used in this section, see <b><a href="../man7/attributes.7.html">attributes</a></b>(7).
       ┌───────────────────────────┬───────────────┬───────────────────────────────────────────────────────────┐
       │ <b>Interface</b>                 │ <b>Attribute</b>     │ <b>Value</b>                                                     │
       ├───────────────────────────┼───────────────┼───────────────────────────────────────────────────────────┤
       │ <b>getspnam</b>()                │ Thread safety │ MT-Unsafe race:getspnam locale                            │
       ├───────────────────────────┼───────────────┼───────────────────────────────────────────────────────────┤
       │ <b>getspent</b>()                │ Thread safety │ MT-Unsafe race:getspent race:spentbuf locale              │
       ├───────────────────────────┼───────────────┼───────────────────────────────────────────────────────────┤
       │ <b>setspent</b>(), <b>endspent</b>(),   │ Thread safety │ MT-Unsafe race:getspent locale                            │
       │ <b>getspent_r</b>()              │               │                                                           │
       ├───────────────────────────┼───────────────┼───────────────────────────────────────────────────────────┤
       │ <b>fgetspent</b>()               │ Thread safety │ MT-Unsafe race:fgetspent                                  │
       ├───────────────────────────┼───────────────┼───────────────────────────────────────────────────────────┤
       │ <b>sgetspent</b>()               │ Thread safety │ MT-Unsafe race:sgetspent                                  │
       ├───────────────────────────┼───────────────┼───────────────────────────────────────────────────────────┤
       │ <b>putspent</b>(), <b>getspnam_r</b>(), │ Thread safety │ MT-Safe locale                                            │
       │ <b>sgetspent_r</b>()             │               │                                                           │
       ├───────────────────────────┼───────────────┼───────────────────────────────────────────────────────────┤
       │ <b>lckpwdf</b>(), <b>ulckpwdf</b>(),    │ Thread safety │ MT-Safe                                                   │
       │ <b>fgetspent_r</b>()             │               │                                                           │
       └───────────────────────────┴───────────────┴───────────────────────────────────────────────────────────┘

       In  the  above  table,  <u>getspent</u>  in  <u>race:getspent</u>  signifies  that  if any of the functions <b>setspent</b>(),
       <b>getspent</b>(), <b>getspent_r</b>(), or <b>endspent</b>() are used in parallel in different threads of a program, then data
       races could occur.

</pre><h4><b>VERSIONS</b></h4><pre>
       Many other systems provide a similar API.

</pre><h4><b>STANDARDS</b></h4><pre>
       None.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/getgrnam.3.html">getgrnam</a></b>(3), <b><a href="../man3/getpwnam.3.html">getpwnam</a></b>(3), <b><a href="../man3/getpwnam_r.3.html">getpwnam_r</a></b>(3), <b><a href="../man5/shadow.5.html">shadow</a></b>(5)

Linux man-pages 6.9.1                              2024-05-02                                        <u><a href="../man3/getspnam.3.html">getspnam</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>