<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASN1_EXTERN_FUNCS, ASN1_ex_d2i, ASN1_ex_d2i_ex, ASN1_ex_i2d, ASN1_ex_new_func, ASN1_ex_new_ex_func,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ASN1_EXTERN_FUNCS, ASN1_ex_d2i, ASN1_ex_d2i_ex, ASN1_ex_i2d, ASN1_ex_new_func, ASN1_ex_new_ex_func,
       ASN1_ex_free_func, ASN1_ex_print_func, IMPLEMENT_EXTERN_ASN1 - ASN.1 external function support

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/asn1t.h&gt;

        typedef int ASN1_ex_d2i(ASN1_VALUE **pval, const unsigned char **in, long len,
                                const ASN1_ITEM *it, int tag, int aclass, char opt,
                                ASN1_TLC *ctx);
        typedef int ASN1_ex_d2i_ex(ASN1_VALUE **pval, const unsigned char **in, long len,
                                   const ASN1_ITEM *it, int tag, int aclass, char opt,
                                   ASN1_TLC *ctx, OSSL_LIB_CTX *libctx,
                                   const char *propq);
        typedef int ASN1_ex_i2d(const ASN1_VALUE **pval, unsigned char **out,
                                const ASN1_ITEM *it, int tag, int aclass);
        typedef int ASN1_ex_new_func(ASN1_VALUE **pval, const ASN1_ITEM *it);
        typedef int ASN1_ex_new_ex_func(ASN1_VALUE **pval, const ASN1_ITEM *it,
                                        OSSL_LIB_CTX *libctx, const char *propq);
        typedef void ASN1_ex_free_func(ASN1_VALUE **pval, const ASN1_ITEM *it);
        typedef int ASN1_ex_print_func(BIO *out, const ASN1_VALUE **pval,
                                       int indent, const char *fname,
                                       const ASN1_PCTX *pctx);

        struct ASN1_EXTERN_FUNCS_st {
           void *app_data;
           ASN1_ex_new_func *asn1_ex_new;
           ASN1_ex_free_func *asn1_ex_free;
           ASN1_ex_free_func *asn1_ex_clear;
           ASN1_ex_d2i *asn1_ex_d2i;
           ASN1_ex_i2d *asn1_ex_i2d;
           ASN1_ex_print_func *asn1_ex_print;
           ASN1_ex_new_ex_func *asn1_ex_new_ex;
           ASN1_ex_d2i_ex *asn1_ex_d2i_ex;
        };
        typedef struct ASN1_EXTERN_FUNCS_st ASN1_EXTERN_FUNCS;

        #define IMPLEMENT_EXTERN_ASN1(sname, tag, fptrs)

</pre><h4><b>DESCRIPTION</b></h4><pre>
       ASN.1 data structures templates are typically defined in OpenSSL using a series of macros such as
       <b>ASN1_SEQUENCE()</b>, <b>ASN1_SEQUENCE_END()</b> and so on. Instead templates can also be defined based entirely on
       external functions. These external functions are called to perform operations such as creating a new
       <b>ASN1_VALUE</b> or converting an <b>ASN1_VALUE</b> to or from DER encoding.

       The macro <b>IMPLEMENT_EXTERN_ASN1()</b> can be used to create such an externally defined structure. The name of
       the structure should be supplied in the <u>sname</u> parameter. The tag for the structure (e.g. typically
       <b>V_ASN1_SEQUENCE</b>) should be supplied in the <u>tag</u> parameter. Finally a pointer to an <b>ASN1_EXTERN_FUNCS</b>
       structure should be supplied in the <u>fptrs</u> parameter.

       The <b>ASN1_EXTERN_FUNCS</b> structure has the following entries.

       <u>app_data</u>
           A pointer to arbitrary application specific data.

       <u>asn1_ex_new</u>
           A  "new"  function  responsible for constructing a new <b>ASN1_VALUE</b> object. The newly constructed value
           should be stored in <u>*pval</u>. The <u>it</u> parameter is a pointer to the <b>ASN1_ITEM</b> template object created via
           the <b>IMPLEMENT_EXTERN_ASN1()</b> macro.

           Returns a positive value on success or 0 on error.

       <u>asn1_ex_free</u>
           A "free" function responsible for  freeing  the  <b>ASN1_VALUE</b>  passed  in  <u>*pval</u>  that  was  previously
           allocated  via  a  "new"  function.  The  <u>it</u>  parameter is a pointer to the <b>ASN1_ITEM</b> template object
           created via the <b>IMPLEMENT_EXTERN_ASN1()</b> macro.

       <u>asn1_ex_clear</u>
           A "clear" function responsible for clearing any data in the <b>ASN1_VALUE</b> passed in <u>*pval</u> and making  it
           suitable  for  reuse.  The <u>it</u> parameter is a pointer to the <b>ASN1_ITEM</b> template object created via the
           <b>IMPLEMENT_EXTERN_ASN1()</b> macro.

       <u>asn1_ex_d2i</u>
           A "d2i" function responsible for converting DER data with  the  tag  <u>tag</u>  and  class  <u>class</u>  into  an
           <b>ASN1_VALUE</b>.  If  <u>*pval</u>  is non-NULL then the <b>ASN_VALUE</b> it points to should be reused. Otherwise a new
           <b>ASN1_VALUE</b> should be allocated and stored in <u>*pval</u>. <u>*in</u> points to the DER data to be decoded and  <u>len</u>
           is  the length of that data. After decoding <u>*in</u> should be updated to point at the next byte after the
           decoded data. If the <b>ASN1_VALUE</b> is considered optional in this context  then  <u>opt</u>  will  be  nonzero.
           Otherwise it will be zero. The <u>it</u> parameter is a pointer to the <b>ASN1_ITEM</b> template object created via
           the  <b>IMPLEMENT_EXTERN_ASN1()</b>  macro. A pointer to the current <b>ASN1_TLC</b> context (which may be required
           for other ASN1 function calls) is passed in the <u>ctx</u> parameter.

           The <u>asn1_ex_d2i</u> entry may be NULL if <u>asn1_ex_d2i_ex</u> has been specified instead.

           Returns &lt;= 0 on error or a positive value on success.

       <u>asn1_ex_i2d</u>
           An "i2d" function responsible for converting an <b>ASN1_VALUE</b> into DER encoding.  On  entry  <u>*pval</u>  will
           contain  the <b>ASN1_VALUE</b> to be encoded. If default tagging is to be used then <u>tag</u> will be -1 on entry.
           Otherwise if implicit tagging should be used then <u>tag</u> and <u>aclass</u>  will  be  the  tag  and  associated
           class.

           If  <u>out</u>  is  not NULL then this function should write the DER encoded data to the buffer in <u>*out</u>, and
           then increment <u>*out</u> to point to immediately after the data just written.

           If <u>out</u> is NULL then no data should be written but the length calculated and returned as if it were.

           The <u>asn1_ex_i2d</u> entry may be NULL if <u>asn1_ex_i2d_ex</u> has been specified instead.

           The return value should be negative if a fatal error occurred, or 0 if a  non-fatal  error  occurred.
           Otherwise it should return the length of the encoded data.

       <u>asn1_ex_print</u>
           A  "print"  function.  <u>out</u>  is the BIO to print the output to. <u>*pval</u> is the <b>ASN1_VALUE</b> to be printed.
           <u>indent</u> is the number of spaces of indenting to be printed  before  any  data  is  printed.  <u>fname</u>  is
           currently unused and is always "". <u>pctx</u> is a pointer to the <b>ASN1_PCTX</b> for the print operation.

           Returns  0  on  error  or  a  positive  value on success. If the return value is 2 then an additional
           newline will be printed after the data printed by this function.

       <u>asn1_ex_new_ex</u>
           This is the same as <u>asn1_ex_new</u> except that it is additionally passed the OSSL_LIB_CTX to be used  in
           <u>libctx</u>  and  any  property query string to be used for algorithm fetching in the <u>propq</u> parameter. See
           "ALGORITHM FETCHING" in <b><a href="../man7/crypto.7.html">crypto</a></b>(7) for further details. If <u>asn1_ex_new_ex</u> is non NULL,  then  it  will
           always be called in preference to <u>asn1_ex_new</u>.

       <u>asn1_ex_d2i_ex</u>
           This  is the same as <u>asn1_ex_d2i</u> except that it is additionally passed the OSSL_LIB_CTX to be used in
           <u>libctx</u> and any property query string to be used for algorithm fetching in the  <u>propq</u>  parameter.  See
           "ALGORITHM  FETCHING"  in  <b><a href="../man7/crypto.7.html">crypto</a></b>(7) for further details. If <u>asn1_ex_d2i_ex</u> is non NULL, then it will
           always be called in preference to <u>asn1_ex_d2i</u>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       Return values for the various callbacks are as described above.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ASN1_item_new_ex.3.html">ASN1_item_new_ex</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The <u>asn1_ex_new_ex</u> and <u>asn1_ex_d2i_ex</u> callbacks were added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                            <u><a href="../man3SSL/ASN1_EXTERN_FUNCS.3SSL.html">ASN1_EXTERN_FUNCS</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>