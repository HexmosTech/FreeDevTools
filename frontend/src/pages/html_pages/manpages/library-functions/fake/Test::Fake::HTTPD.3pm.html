<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test::Fake::HTTPD - a fake HTTP server</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtest-fake-httpd-perl">libtest-fake-httpd-perl_0.09-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Test::Fake::HTTPD - a fake HTTP server

</pre><h4><b>SYNOPSIS</b></h4><pre>
       DSL-style

           use Test::Fake::HTTPD;

           my $httpd = run_http_server {
               my $req = shift;
               # ...

               # 1. HTTP::Response ok
               return $http_response;
               # 2. Plack::Response ok
               return $plack_response;
               # 3. PSGI response ok
               return [ 200, [ 'Content-Type' =&gt; 'text/plain' ], [ 'Hello World' ] ];
           };

           printf "Listening on address:port %s\n", $httpd-&gt;host_port;
           # or
           printf "Listening on address %s port %s\n", $httpd-&gt;host, $httpd-&gt;port;

           # access to fake HTTP server
           use LWP::UserAgent;
           my $res = LWP::UserAgent-&gt;new-&gt;get($httpd-&gt;endpoint); # "<a href="http://127.0.0.1">http://127.0.0.1</a>:{port}"

           # Stop http server automatically at destruction time.

       OO-style

           use Test::Fake::HTTPD;

           my $httpd = Test::Fake::HTTPD-&gt;new(
               timeout     =&gt; 5,
               daemon_args =&gt; { ... }, # HTTP::Daemon args
           );

           $httpd-&gt;run(sub {
               my $req = shift;
               # ...
               [ 200, [ 'Content-Type', 'text/plain' ], [ 'Hello World' ] ];
           });

           # Stop http server automatically at destruction time.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Test::Fake::HTTPD is a fake HTTP server module for testing.

</pre><h4><b>FUNCTIONS</b></h4><pre>
       •   "run_http_server { ... }"

           Starts HTTP server and returns the guard instance.

             my $httpd = run_http_server {
                 my $req = shift;
                 # ...
                 return $http_or_plack_or_psgi_res;
             };

             # can use $httpd guard object, same as OO-style
             LWP::UserAgent-&gt;new-&gt;get($httpd-&gt;endpoint);

       •   "run_https_server { ... }"

           Starts <b>HTTPS</b> server and returns the guard instance.

           If you use this method, you MUST install HTTP::Daemon::SSL.

             extra_daemon_args
                 SSL_key_file  =&gt; "certs/server-key.pem",
                 SSL_cert_file =&gt; "certs/server-cert.pem";

             my $httpd = run_https_server {
                 my $req = shift;
                 # ...
                 return $http_or_plack_or_psgi_res;
             };

             # can use $httpd guard object, same as OO-style
             my $ua = LWP::UserAgent-&gt;new(
                 ssl_opts =&gt; {
                     SSL_verify_mode =&gt; 0,
                     verify_hostname =&gt; 0,
                 },
             );
             $ua-&gt;get($httpd-&gt;endpoint);

</pre><h4><b>METHODS</b></h4><pre>
       •   "new( %args )"

           Returns a new instance.

             my $httpd = Test::Fake::HTTPD-&gt;new(%args);

           %args are:

           •       "timeout"

                   timeout value (default: 5)

           •       "listen"

                   queue size for listen (default: 5)

           •       "host"

                   local address to listen on (default: 127.0.0.1)

           •       "port"

                   TCP port to listen on (default: auto detection)

             my $httpd = Test::Fake::HTTPD-&gt;new(
                 timeout =&gt; 10,
                 listen  =&gt; 10,
                 port    =&gt; 3333,
             );

       •   "run( sub { ... } )"

           Starts this HTTP server.

             $httpd-&gt;run(sub { ... });

       •   "scheme"

           Returns a scheme of running, "http" or "https".

             my $scheme = $httpd-&gt;scheme;

       •   "host"

           Returns the address the server is listening on.

       •   "port"

           Returns the TCP port the server is listening on.

             my $port = $httpd-&gt;port;

       •   "host_port"

           Returns the host:port from "endpoint" (e.g., "127.0.0.1:1234", "[::1]:1234").

             my $host_port = $httpd-&gt;host_port;

       •   "endpoint"

           Returns  a URI object to the running server (e.g., "<a href="http://127.0.0.1">http://127.0.0.1</a>:1234", "https://[::1]:1234"). If
           "host" returns "undef", '', '0.0.0.0', or '::', the host portion of the URI is set to "localhost".

             use LWP::UserAgent;

             my $res = LWP::UserAgent-&gt;new-&gt;get($httpd-&gt;endpoint);

             my $url = $httpd-&gt;endpoint;
             $url-&gt;path('/foo/bar');
             my $res = LWP::UserAgent-&gt;new-&gt;get($url);

</pre><h4><b>AUTHOR</b></h4><pre>
       NAKAGAWA Masaki &lt;<a href="mailto:masaki@cpan.org">masaki@cpan.org</a>&gt;

</pre><h4><b>THANKS</b> <b>TO</b></h4><pre>
       xaicron

</pre><h4><b>LICENSE</b></h4><pre>
       This library is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Test::TCP, HTTP::Daemon, HTTP::Daemon::SSL, HTTP::Message::PSGI

perl v5.30.3                                       2020-08-18                             <u>Test::Fake::<a href="../man3pm/HTTPD.3pm.html">HTTPD</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>