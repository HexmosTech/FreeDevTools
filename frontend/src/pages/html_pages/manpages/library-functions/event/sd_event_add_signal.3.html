<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sd_event_add_signal, sd_event_source_get_signal, sd_event_signal_handler_t, SD_EVENT_SIGNAL_PROCMASK -</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsystemd-dev">libsystemd-dev_257.7-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sd_event_add_signal, sd_event_source_get_signal, sd_event_signal_handler_t, SD_EVENT_SIGNAL_PROCMASK -
       Add a UNIX process signal event source to an event loop

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;systemd/sd-event.h&gt;</b>

       <b>typedef</b> <b>struct</b> <b>sd_event_source</b> <b>sd_event_source;</b>

       <b>SD_EVENT_SIGNAL_PROCMASK</b>

       <b>typedef</b> <b>int</b> <b>(*sd_event_signal_handler_t)(sd_event_source</b> <b>*</b><u>s</u><b>,</b> <b>const</b> <b>struct</b> <b>signalfd_siginfo</b> <b>*</b><u>si</u><b>,</b>
                                                <b>void</b> <b>*</b><u>userdata</u><b>);</b>

       <b>int</b> <b>sd_event_add_signal(sd_event</b> <b>*</b><u>event</u><b>,</b> <b>sd_event_source</b> <b>**</b><u>source</u><b>,</b> <b>int</b> <u>signal</u><b>,</b>
                               <b>sd_event_signal_handler_t</b> <u>handler</u><b>,</b> <b>void</b> <b>*</b><u>userdata</u><b>);</b>

       <b>int</b> <b>sd_event_source_get_signal(sd_event_source</b> <b>*</b><u>source</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sd_event_add_signal()</b> adds a new UNIX process signal event source to an event loop. The event loop object
       is specified in the <u>event</u> parameter, and the event source object is returned in the <u>source</u> parameter. The
       <u>signal</u> parameter specifies the numeric signal to be handled (see <b><a href="../man7/signal.7.html">signal</a></b>(7)).

       The <u>handler</u> parameter is a function to call when the signal is received or <b>NULL</b>. The handler function
       will be passed the <u>userdata</u> pointer, which may be chosen freely by the caller. The handler also receives
       a pointer to a signalfd_siginfo structure containing information about the received signal. See
       <b><a href="../man2/signalfd.2.html">signalfd</a></b>(2) for further information. The handler may return negative to signal an error (see below),
       other return values are ignored. If <u>handler</u> is <b>NULL</b>, a default handler that calls <b><a href="../man3/sd_event_exit.3.html">sd_event_exit</a></b>(3) will
       be used.

       Only a single handler may be installed for a specific signal. The signal must be blocked in all threads
       before this function is called (using <b><a href="../man2/sigprocmask.2.html">sigprocmask</a></b>(2) or <b><a href="../man3/pthread_sigmask.3.html">pthread_sigmask</a></b>(3)). For convenience, if the
       special flag <b>SD_EVENT_SIGNAL_PROCMASK</b> is ORed into the specified signal the signal will be automatically
       masked as necessary, for the calling thread. Note that this only works reliably if the signal is already
       masked in all other threads of the process, or if there are no other threads at the moment of invocation.

       By default, the event source is enabled permanently (<b>SD_EVENT_ON</b>), but this may be changed with
       <b><a href="../man3/sd_event_source_set_enabled.3.html">sd_event_source_set_enabled</a></b>(3). If the handler function returns a negative error code, it will either be
       disabled after the invocation, even if the <b>SD_EVENT_ON</b> mode was requested before, or it will cause the
       loop to terminate, see <b><a href="../man3/sd_event_source_set_exit_on_failure.3.html">sd_event_source_set_exit_on_failure</a></b>(3).

       To destroy an event source object use <b><a href="../man3/sd_event_source_unref.3.html">sd_event_source_unref</a></b>(3), but note that the event source is only
       removed from the event loop when all references to the event source are dropped. To make sure an event
       source does not fire anymore, even if it is still referenced, disable the event source using
       <b><a href="../man3/sd_event_source_set_enabled.3.html">sd_event_source_set_enabled</a></b>(3) with <b>SD_EVENT_OFF</b>.

       If the second parameter of <b>sd_event_add_signal()</b> is <b>NULL</b> no reference to the event source object is
       returned. In this case, the event source is considered "floating", and will be destroyed implicitly when
       the event loop itself is destroyed.

       If the <u>handler</u> parameter to <b>sd_event_add_signal()</b> is <b>NULL</b>, and the event source fires, this will be
       considered a request to exit the event loop. In this case, the <u>userdata</u> parameter, cast to an integer, is
       passed as the exit code parameter to <b><a href="../man3/sd_event_exit.3.html">sd_event_exit</a></b>(3).

       <b>sd_event_source_get_signal()</b> returns the configured signal number of an event source created previously
       with <b>sd_event_add_signal()</b>. It takes the event source object as the <u>source</u> parameter.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, these functions return 0 or a positive integer. On failure, they return a negative
       errno-style error code.

   <b>Errors</b>
       Returned errors may indicate the following problems:

       <b>-ENOMEM</b>
           Not enough memory to allocate an object.

       <b>-EINVAL</b>
           An invalid argument has been passed.

       <b>-EBUSY</b>
           A handler is already installed for this signal or the signal was not blocked previously.

       <b>-ESTALE</b>
           The event loop is already terminated.

       <b>-ECHILD</b>
           The event loop has been created in a different process, library or module instance.

       <b>-EDOM</b>
           The passed event source is not a signal event source.

</pre><h4><b>NOTES</b></h4><pre>
       Functions described here are available as a shared library, which can be compiled against and linked to
       with the <b>libsystemd</b> <b><a href="../man1/pkg-config.1.html">pkg-config</a></b>(1) file.

       The code described here uses <b><a href="../man3/getenv.3.html">getenv</a></b>(3), which is declared to be not multi-thread-safe. This means that
       the code calling the functions described here must not call <b><a href="../man3/setenv.3.html">setenv</a></b>(3) from a parallel thread. It is
       recommended to only do calls to <b>setenv()</b> from an early phase of the program when no other threads have
       been started.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>sd_event_add_signal()</b>, <b>sd_event_signal_handler_t()</b>, and <b>sd_event_source_get_signal()</b> were added in
       version 217.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man3/sd-event.3.html">sd-event</a></b>(3), <b><a href="../man3/sd_event_new.3.html">sd_event_new</a></b>(3), <b><a href="../man3/sd_event_now.3.html">sd_event_now</a></b>(3), <b><a href="../man3/sd_event_add_io.3.html">sd_event_add_io</a></b>(3), <b><a href="../man3/sd_event_add_time.3.html">sd_event_add_time</a></b>(3),
       <b><a href="../man3/sd_event_add_child.3.html">sd_event_add_child</a></b>(3), <b><a href="../man3/sd_event_add_inotify.3.html">sd_event_add_inotify</a></b>(3), <b><a href="../man3/sd_event_add_defer.3.html">sd_event_add_defer</a></b>(3), <b><a href="../man3/sd_event_source_set_enabled.3.html">sd_event_source_set_enabled</a></b>(3),
       <b><a href="../man3/sd_event_source_set_description.3.html">sd_event_source_set_description</a></b>(3), <b><a href="../man3/sd_event_source_set_userdata.3.html">sd_event_source_set_userdata</a></b>(3), <b><a href="../man3/sd_event_source_set_floating.3.html">sd_event_source_set_floating</a></b>(3),
       <b><a href="../man7/signal.7.html">signal</a></b>(7), <b><a href="../man2/signalfd.2.html">signalfd</a></b>(2), <b><a href="../man2/sigprocmask.2.html">sigprocmask</a></b>(2), <b><a href="../man3/pthread_sigmask.3.html">pthread_sigmask</a></b>(3)

systemd 257.7                                                                             <u><a href="../man3/SD_EVENT_ADD_SIGNAL.3.html">SD_EVENT_ADD_SIGNAL</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>