<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test2::AsyncSubtest - Object representing an async subtest.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtest2-suite-perl">libtest2-suite-perl_0.000163-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Test2::AsyncSubtest - Object representing an async subtest.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Regular subtests have a limited scope, they start, events are generated, then they close and send an
       Test2::Event::Subtest event. This is a problem if you want the subtest to keep receiving events while
       other events are also being generated. This class implements subtests that stay open until you decide to
       close them.

       This is mainly useful for tools that start a subtest in one process and then spawn children. In many
       cases it is nice to let the parent process continue instead of waiting on the children.

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Test2::AsyncSubtest;

           my $ast = Test2::AsyncSubtest-&gt;new(name =&gt; foo);

           $ast-&gt;run(sub {
               ok(1, "Event in parent" );
           });

           ok(1, "Event outside of subtest");

           $ast-&gt;run_fork(sub {
               ok(1, "Event in child process");
           });

           ...

           $ast-&gt;finish;

           done_testing;

</pre><h4><b>CONSTRUCTION</b></h4><pre>
           my $ast = Test2::AsyncSubtest-&gt;new( ... );

       name =&gt; $name (required)
           Name of the subtest. This construction argument is required.

       send_to =&gt; $hub (optional)
           Hub  to  which  the  final  subtest event should be sent. This must be an instance of Test2::Hub or a
           subclass. If none is specified then the current top hub will be used.

       trace =&gt; $trace (optional)
           File/Line to which errors should be attributed. This must be an instance  of  Test2::Util::Trace.  If
           none is specified then the file/line where the constructor was called will be used.

       hub =&gt; $hub (optional)
           Use  this to specify a hub the subtest should use. By default a new hub is generated. This must be an
           instance of Test2::AsyncSubtest::Hub.

</pre><h4><b>METHODS</b></h4><pre>
   <b>SIMPLE</b> <b>ACCESSORS</b>
       $bool = $ast-&gt;active
           True if the subtest is active. The subtest is active if its hub appears in the global hub stack. This
           is true when "$ast-&gt;run(...)" us running.

       $arrayref = $ast-&gt;children
           Get an arrayref of child processes/threads. Numerical items  are  PIDs,  blessed  items  are  threads
           instances.

       $arrayref = $ast-&gt;events
           Get an arrayref of events that have been sent to the subtests hub.

       $bool = $ast-&gt;finished
           True if finished() has already been called.

       $hub = $ast-&gt;hub
           The hub created for the subtest.

       $int = $ast-&gt;id
           Attach/Detach counter. Used internally, not useful to users.

       $str = $ast-&gt;name
           Name of the subtest.

       $pid = $ast-&gt;pid
           PID in which the subtest was created.

       $tid = $ast-&gt;tid
           Thread ID in which the subtest was created.

       $hub = $ast-&gt;send_to
           Hub to which the final subtest event should be sent.

       $arrayref = $ast-&gt;stack
           Stack of async subtests at the time this one was created. This is mainly for internal use.

       $trace = $ast-&gt;trace
           Test2::Util::Trace instance used for error reporting.

   <b>INTERFACE</b>
       $ast-&gt;attach($id)
           Attach a subtest in a child/process to the original.

           <b>Note:</b> "my $id = $ast-&gt;cleave" must have been called in the parent process/thread before the child was
           started, the id it returns must be used in the call to "$ast-&gt;attach($id)"

       $id = $ast-&gt;cleave
           Prepare  a slot for a child process/thread to attach. This must be called BEFORE the child process or
           thread is started. The ID returned is used by attach().

           This must only be called in the original process/thread.

       $ctx = $ast-&gt;context
           Get an Test2::API::Context instance that can be used to send events to the context in which  the  hub
           was created. This is not a canonical context, you should not call "$ctx-&gt;release" on it.

       $ast-&gt;detach
           Detach from the parent in a child process/thread. This should be called just before the child exits.

       $ast-&gt;finish
       $ast-&gt;finish(%options)
           Finish the subtest, wait on children, and send the final subtest event.

           This must only be called in the original process/thread.

           <b>Note:</b> This calls "$ast-&gt;wait".

           These are the options:

           collapse =&gt; 1
               This intelligently allows a subtest to be empty.

               If  no events bump the test count then the subtest no final plan will be added.  The subtest will
               not be considered a failure (normally an empty subtest is a failure).

               If there are no events at all the subtest will be collapsed into an Test2::Event::Ok event.

           silent =&gt; 1
               This will prevent finish from generating a final Test2::Event::Subtest  event.  This  effectively
               ends the subtest without it effecting the parent subtest (or top level test).

           no_plan =&gt; 1
               This  will  prevent  a  final  plan from being added to the subtest for you when none is directly
               specified.

           skip =&gt; "reason"
               This will issue an Test2::Event::Skip instead of a subtest. This will throw an exception  if  any
               events have been seen, or if state implies events have occurred.

       $out = $ast-&gt;fork
           This  is a slightly higher level interface to fork. Running it will fork your code in-place just like
           fork(). It will return a pid in the parent, and an  Test2::Util::Guard  instance  in  the  child.  An
           exception will be thrown if fork fails.

           It is recommended that you use "$ast-&gt;run_fork(sub { ... })" instead.

       $bool = $ast-&gt;pending
           True if there are child processes, threads, or subtests that depend on this one.

       $bool = $ast-&gt;ready
           This is essentially "!$ast-&gt;pending".

       $ast-&gt;run(sub { ... })
           Run the provided codeblock inside the subtest. This will push the subtest hub onto the stack, run the
           code, then pop the hub off the stack.

       $pid = $ast-&gt;run_fork(sub { ... })
           Same as "$ast-&gt;run()", except that the codeblock is run in a child process.

           You  do  not  need  to  directly  call  wait($pid),  that  will be done for you when "$ast-&gt;wait", or
           "$ast-&gt;finish" are called.

       my $thr = $ast-&gt;run_thread(sub { ... });
           <b>**</b> <b>DISCOURAGED</b> <b>**</b> Threads cause problems. This method remains for anyone who REALLY wants it, but  it
           is  no  longer  supported.  Tests for this functionality do not even run unless the AUTHOR_TESTING or
           T2_DO_THREAD_TESTS env vars are enabled.

           Same as "$ast-&gt;run()", except that the codeblock is run in a child thread.

           You do not need  to  directly  call  "$thr-&gt;join",  that  is  done  for  you  when  "$ast-&gt;wait",  or
           "$ast-&gt;finish" are called.

       $passing = $ast-&gt;start
           Push the subtest hub onto the stack. Returns the current pass/fail status of the subtest.

       $ast-&gt;stop
           Pop the subtest hub off the stack. Returns the current pass/fail status of the subtest.

       $ast-&gt;wait
           Wait   on   all   threads/processes  that  were  started  using  "$ast-&gt;fork",  "$ast-&gt;run_fork",  or
           "$ast-&gt;run_thread".

</pre><h4><b>SOURCE</b></h4><pre>
       The     source     code     repository     for     Test2-AsyncSubtest      can      be      found      at
       <u>https://github.com/Test-More/Test2-Suite/</u>.

</pre><h4><b>MAINTAINERS</b></h4><pre>
       Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;

</pre><h4><b>AUTHORS</b></h4><pre>
       Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2018 Chad Granum &lt;<a href="mailto:exodist7@gmail.com">exodist7@gmail.com</a>&gt;.

       This  program  is  free  software;  you can redistribute it and/or modify it under the same terms as Perl
       itself.

       See <u><a href="http://dev.perl.org/licenses/">http://dev.perl.org/licenses/</a></u>

perl v5.38.2                                       2024-06-07                           <u>Test2::<a href="../man3pm/AsyncSubtest.3pm.html">AsyncSubtest</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>