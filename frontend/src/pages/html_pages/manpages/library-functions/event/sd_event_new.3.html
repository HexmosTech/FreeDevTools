<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sd_event_new, sd_event_default, sd_event_ref, sd_event_unref, sd_event_unrefp, sd_event_get_tid, sd_event</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsystemd-dev">libsystemd-dev_257.7-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sd_event_new, sd_event_default, sd_event_ref, sd_event_unref, sd_event_unrefp, sd_event_get_tid, sd_event
       - Acquire and release an event loop object

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;systemd/sd-event.h&gt;</b>

       <b>typedef</b> <b>struct</b> <b>sd_event</b> <b>sd_event;</b>

       <b>int</b> <b>sd_event_new(sd_event</b> <b>**</b><u>event</u><b>);</b>

       <b>int</b> <b>sd_event_default(sd_event</b> <b>**</b><u>event</u><b>);</b>

       <b>sd_event</b> <b>*sd_event_ref(sd_event</b> <b>*</b><u>event</u><b>);</b>

       <b>sd_event</b> <b>*sd_event_unref(sd_event</b> <b>*</b><u>event</u><b>);</b>

       <b>void</b> <b>sd_event_unrefp(sd_event</b> <b>**</b><u>event</u><b>);</b>

       <b>int</b> <b>sd_event_get_tid(sd_event</b> <b>*</b><u>event</u><b>,</b> <b>pid_t</b> <b>*</b><u>ret</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sd_event_new()</b> allocates a new event loop object. The event loop object is returned in the <u>event</u>
       parameter. After use, drop the returned reference with <b>sd_event_unref()</b>. When the last reference is
       dropped, the object is freed.

       <b>sd_event_default()</b> acquires a reference to the default event loop object of the calling thread, possibly
       allocating a new object if no default event loop object has been allocated yet for the thread. After use,
       drop the returned reference with <b>sd_event_unref()</b>. When the last reference is dropped, the event loop is
       freed. If this function is called while the object returned from a previous call from the same thread is
       still referenced, the same object is returned again, but the reference is increased by one. It is
       recommended to use this call instead of <b>sd_event_new()</b> in order to share event loop objects between
       various components that are dispatched in the same thread. All threads have exactly either zero or one
       default event loop objects associated, but never more.

       After allocating an event loop object, add event sources to it with <b><a href="../man3/sd_event_add_io.3.html">sd_event_add_io</a></b>(3),
       <b><a href="../man3/sd_event_add_time.3.html">sd_event_add_time</a></b>(3), <b><a href="../man3/sd_event_add_signal.3.html">sd_event_add_signal</a></b>(3), <b><a href="../man3/sd_event_add_child.3.html">sd_event_add_child</a></b>(3), <b><a href="../man3/sd_event_add_inotify.3.html">sd_event_add_inotify</a></b>(3),
       <b><a href="../man3/sd_event_add_defer.3.html">sd_event_add_defer</a></b>(3), <b><a href="../man3/sd_event_add_post.3.html">sd_event_add_post</a></b>(3) or <b><a href="../man3/sd_event_add_exit.3.html">sd_event_add_exit</a></b>(3), and then execute the event loop
       using <b><a href="../man3/sd_event_loop.3.html">sd_event_loop</a></b>(3).

       <b>sd_event_ref()</b> increases the reference count of the specified event loop object by one.

       <b>sd_event_unref()</b> decreases the reference count of the specified event loop object by one. If the count
       hits zero, the object is freed. Note that it is freed regardless of whether it is the default event loop
       object for a thread or not. This means that allocating an event loop with <b>sd_event_default()</b>, then
       releasing it, and then acquiring a new one with <b>sd_event_default()</b> will result in two distinct objects.
       Note that, in order to free an event loop object, all remaining event sources of the event loop also need
       to be freed as each keeps a reference to it.

       <b>sd_event_unrefp()</b> is similar to <b>sd_event_unref()</b> but takes a pointer to a pointer to an <b>sd_event</b> object.
       This call is useful in conjunction with GCC's and LLVM's <b>Clean-up</b> <b>Variable</b> <b>Attribute</b>[1]. Note that this
       function is defined as inline function. Use a declaration like the following, in order to allocate an
       event loop object that is freed automatically as the code block is left:

           {
                   __attribute__((cleanup(sd_event_unrefp))) sd_event *event = NULL;
                   int r;
                   ...
                   r = sd_event_default(&amp;event);
                   if (r &lt; 0) {
                     errno = -r;
                     fprintf(stderr, "Failed to allocate event loop: %m\n");
                   }
                   ...
           }

       <b>sd_event_ref()</b>, <b>sd_event_unref()</b> and <b>sd_event_unrefp()</b> execute no operation if the passed in event loop
       object is <b>NULL</b>.

       <b>sd_event_get_tid()</b> retrieves the thread identifier ("TID") of the thread the specified event loop object
       is associated with. This call is only supported for event loops allocated with <b>sd_event_default()</b>, and
       returns the identifier for the thread the event loop is the default event loop of. See <b><a href="../man2/gettid.2.html">gettid</a></b>(2) for more
       information on thread identifiers.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, <b>sd_event_new()</b>, <b>sd_event_default()</b> and <b>sd_event_get_tid()</b> return 0 or a positive integer. On
       failure, they return a negative errno-style error code.  <b>sd_event_ref()</b> always returns a pointer to the
       event loop object passed in.  <b>sd_event_unref()</b> always returns <b>NULL</b>.

   <b>Errors</b>
       Returned errors may indicate the following problems:

       <b>-ENOMEM</b>
           Not enough memory to allocate the object.

       <b>-EMFILE</b>
           The maximum number of event loops has been allocated.

       <b>-ENXIO</b>
           <b>sd_event_get_tid()</b> was invoked on an event loop object that was not allocated with
           <b>sd_event_default()</b>.

</pre><h4><b>NOTES</b></h4><pre>
       Functions described here are available as a shared library, which can be compiled against and linked to
       with the <b>libsystemd</b> <b><a href="../man1/pkg-config.1.html">pkg-config</a></b>(1) file.

       The code described here uses <b><a href="../man3/getenv.3.html">getenv</a></b>(3), which is declared to be not multi-thread-safe. This means that
       the code calling the functions described here must not call <b><a href="../man3/setenv.3.html">setenv</a></b>(3) from a parallel thread. It is
       recommended to only do calls to <b>setenv()</b> from an early phase of the program when no other threads have
       been started.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>sd_event_new()</b>, <b>sd_event_default()</b>, <b>sd_event_ref()</b>, and <b>sd_event_unref()</b> were added in version 213.

       <b>sd_event_unrefp()</b> and <b>sd_event_get_tid()</b> were added in version 229.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man3/sd-event.3.html">sd-event</a></b>(3), <b><a href="../man3/sd_event_add_io.3.html">sd_event_add_io</a></b>(3), <b><a href="../man3/sd_event_add_time.3.html">sd_event_add_time</a></b>(3), <b><a href="../man3/sd_event_add_signal.3.html">sd_event_add_signal</a></b>(3),
       <b><a href="../man3/sd_event_add_child.3.html">sd_event_add_child</a></b>(3), <b><a href="../man3/sd_event_add_inotify.3.html">sd_event_add_inotify</a></b>(3), <b><a href="../man3/sd_event_add_defer.3.html">sd_event_add_defer</a></b>(3), <b><a href="../man3/sd_event_run.3.html">sd_event_run</a></b>(3), <b><a href="../man2/gettid.2.html">gettid</a></b>(2)

</pre><h4><b>NOTES</b></h4><pre>
        1. Clean-up Variable Attribute
           https://gcc.gnu.org/onlinedocs/gcc/Common-Variable-Attributes.html

systemd 257.7                                                                                    <u><a href="../man3/SD_EVENT_NEW.3.html">SD_EVENT_NEW</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>