<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tep_register_event_handler, tep_unregister_event_handler - Register / unregisters a callback function to</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtraceevent-doc">libtraceevent-doc_1.8.4-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tep_register_event_handler, tep_unregister_event_handler - Register / unregisters a callback function to
       parse an event information.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;event-parse.h&gt;</b>

       enum <b>tep_reg_handler</b> {
               <u>TEP_REGISTER_SUCCESS</u>,
               <u>TEP_REGISTER_SUCCESS_OVERWRITE</u>,
       };

       int <b>tep_register_event_handler</b>(struct tep_handle *<u>tep</u>, int <u>id</u>, const char *<u>sys_name</u>, const char *<u>event_name</u>, tep_event_handler_func <u>func</u>, void *<u>context</u>);
       int <b>tep_unregister_event_handler</b>(struct tep_handle *tep, int id, const char *sys_name, const char *event_name, tep_event_handler_func func, void *<u>context</u>);

       typedef int (<b>*tep_event_handler_func</b>)(struct trace_seq *s, struct tep_record *record, struct tep_event *event, void *context);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>tep_register_event_handler()</b> function registers a handler function, which is going to be called to
       parse the information for a given event. The <u>tep</u> argument is the trace event parser context. The <u>id</u>
       argument is the id of the event. The <u>sys_name</u> argument is the name of the system, the event belongs to.
       The <u>event_name</u> argument is the name of the event. If <u>id</u> is &gt;= 0, it is used to find the event, otherwise
       <u>sys_name</u> and <u>event_name</u> are used. The <u>func</u> is a pointer to the function, which is going to be called to
       parse the event information. The <u>context</u> argument is a pointer to the context data, which will be passed
       to the <u>func</u>. If a handler function for the same event is already registered, it will be overridden with
       the new one. This mechanism allows a developer to override the parsing of a given event. If for some
       reason the default print format is not sufficient, the developer can register a function for an event to
       be used to parse the data instead.

       The <b>tep_unregister_event_handler()</b> function unregisters the handler function, previously registered with
       <b>tep_register_event_handler()</b>. The <u>tep</u> argument is the trace event parser context. The <u>id</u>, <u>sys_name</u>,
       <u>event_name</u>, <u>func</u>, and <u>context</u> are the same arguments, as when the callback function <u>func</u> was registered.

       The <u>tep_event_handler_func</u> is the type of the custom event handler function. The <u>s</u> argument is the trace
       sequence, it can be used to create a custom string, describing the event. A <u>record</u> to get the event from
       is passed as input parameter and also the <u>event</u> - the handle to the recordâ€™s event. The <u>context</u> is custom
       context, set when the custom event handler is registered.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>tep_register_event_handler()</b> function returns <u>TEP_REGISTER_SUCCESS</u> if the new handler is registered
       successfully or <u>TEP_REGISTER_SUCCESS_OVERWRITE</u> if an existing handler is overwritten. If there is not
       enough memory to complete the registration, TEP_ERRNO__MEM_ALLOC_FAILED is returned.

       The <b>tep_unregister_event_handler()</b> function returns 0 if <u>func</u> was removed successful or, -1 if the event
       was not found.

       The <u>tep_event_handler_func</u> should return -1 in case of an error, or 0 otherwise.

</pre><h4><b>EXAMPLE</b></h4><pre>
           #include &lt;event-parse.h&gt;
           #include &lt;trace-seq.h&gt;
           ...
           struct tep_handle *tep = tep_alloc();
           ...
           int timer_expire_handler(struct trace_seq *s, struct tep_record *record,
                                    struct tep_event *event, void *context)
           {
                   trace_seq_printf(s, "hrtimer=");

                   if (tep_print_num_field(s, "0x%llx", event, "timer", record, 0) == -1)
                           tep_print_num_field(s, "0x%llx", event, "hrtimer", record, 1);

                   trace_seq_printf(s, " now=");

                   tep_print_num_field(s, "%llu", event, "now", record, 1);

                   tep_print_func_field(s, " function=%s", event, "function", record, 0);

                   return 0;
           }
           ...
                   int ret;

                   ret = tep_register_event_handler(tep, -1, "timer", "hrtimer_expire_entry",
                                                    timer_expire_handler, NULL);
                   if (ret &lt; 0) {
                           char buf[32];

                           tep_strerror(tep, ret, buf, 32)
                           printf("Failed to register handler for hrtimer_expire_entry: %s\n", buf);
                   } else {
                           switch (ret) {
                           case TEP_REGISTER_SUCCESS:
                                   printf ("Registered handler for hrtimer_expire_entry\n");
                                   break;
                           case TEP_REGISTER_SUCCESS_OVERWRITE:
                                   printf ("Overwrote handler for hrtimer_expire_entry\n");
                                   break;
                           }
                   }
           ...
                   ret = tep_unregister_event_handler(tep, -1, "timer", "hrtimer_expire_entry",
                                                      timer_expire_handler, NULL);
                   if ( ret )
                           printf ("Failed to unregister handler for hrtimer_expire_entry\n");

</pre><h4><b>FILES</b></h4><pre>
           <b>event-parse.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>trace-seq.h</b>
                   Header file to include in order to have access to trace sequences
                   related APIs. Trace sequences are used to allow a function to call
                   several other functions to create a string of data to use.
           <b>-ltraceevent</b>
                   Linker switch to add when building a program that uses the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libtraceevent.3.html">libtraceevent</a></b>(3), <b><a href="../man1/trace-cmd.1.html">trace-cmd</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
           <b>Steven</b> <b>Rostedt</b> &lt;<b><a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a></b>[1]&gt;, author of <b>libtraceevent</b>.
           <b>Tzvetomir</b> <b>Stoyanov</b> &lt;<b><a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a></b>[2]&gt;, author of this man page.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<b><a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a></b>[3]&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       libtraceevent is Free Software licensed under the GNU LGPL 2.1

</pre><h4><b>RESOURCES</b></h4><pre>
       <b>https://git.kernel.org/pub/scm/libs/libtrace/libtraceevent.git/</b>

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a>
           <a href="mailto:rostedt@goodmis.org">mailto:rostedt@goodmis.org</a>

        2. <a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a>
           <a href="mailto:tz.stoyanov@gmail.com">mailto:tz.stoyanov@gmail.com</a>

        3. <a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a>
           <a href="mailto:linux-trace-devel@vger.kernel.org">mailto:linux-trace-devel@vger.kernel.org</a>

libtraceevent 1.8.4                                12/24/2024                                   <u><a href="../man3/LIBTRACEEVENT.3.html">LIBTRACEEVENT</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>