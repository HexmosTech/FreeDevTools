<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tep_filter_alloc, tep_filter_free, tep_filter_reset, tep_filter_make_string, tep_filter_copy,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtraceevent-doc">libtraceevent-doc_1.8.4-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tep_filter_alloc, tep_filter_free, tep_filter_reset, tep_filter_make_string, tep_filter_copy,
       tep_filter_compare, tep_filter_match, tep_event_filtered, tep_filter_remove_event, tep_filter_strerror,
       tep_filter_add_filter_str - Event filter related APIs.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;event-parse.h&gt;</b>

       struct tep_event_filter *<b>tep_filter_alloc</b>(struct tep_handle *<u>tep</u>);
       void <b>tep_filter_free</b>(struct tep_event_filter *<u>filter</u>);
       void <b>tep_filter_reset</b>(struct tep_event_filter *<u>filter</u>);
       enum tep_errno <b>tep_filter_add_filter_str</b>(struct tep_event_filter *<u>filter</u>, const char *<u>filter_str</u>);
       int <b>tep_event_filtered</b>(struct tep_event_filter *<u>filter</u>, int <u>event_id</u>);
       int <b>tep_filter_remove_event</b>(struct tep_event_filter *<u>filter</u>, int <u>event_id</u>);
       enum tep_errno <b>tep_filter_match</b>(struct tep_event_filter *<u>filter</u>, struct tep_record *<u>record</u>);
       int <b>tep_filter_copy</b>(struct tep_event_filter *<u>dest</u>, struct tep_event_filter *<u>source</u>);
       int <b>tep_filter_compare</b>(struct tep_event_filter *<u>filter1</u>, struct tep_event_filter *<u>filter2</u>);
       char *<b>tep_filter_make_string</b>(struct tep_event_filter *<u>filter</u>, int <u>event_id</u>);
       int <b>tep_filter_strerror</b>(struct tep_event_filter *<u>filter</u>, enum tep_errno <u>err</u>, char *buf, size_t <u>buflen</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Filters can be attached to traced events. They can be used to filter out various events when outputting
       them. Each event can be filtered based on its parameters, described in the event’s format file. This set
       of functions can be used to create, delete, modify and attach event filters.

       The <b>tep_filter_alloc()</b> function creates a new event filter. The <u>tep</u> argument is the trace event parser
       context.

       The <b>tep_filter_free()</b> function frees an event filter and all resources that it had used.

       The <b>tep_filter_reset()</b> function removes all rules from an event filter and resets it.

       The <b>tep_filter_add_filter_str()</b> function adds a new rule to the <u>filter</u>. The <u>filter_str</u> argument is the
       filter string, that contains the rule.

       The <b>tep_event_filtered()</b> function checks if the event with <u>event_id</u> has <u>filter</u>.

       The <b>tep_filter_remove_event()</b> function removes a <u>filter</u> for an event with <u>event_id</u>.

       The <b>tep_filter_match()</b> function tests if a <u>record</u> matches given <u>filter</u>.

       The <b>tep_filter_copy()</b> function copies a <u>source</u> filter into a <u>dest</u> filter.

       The <b>tep_filter_compare()</b> function compares two filers - <u>filter1</u> and <u>filter2</u>.

       The <b>tep_filter_make_string()</b> function constructs a string, displaying the <u>filter</u> contents for given
       <u>event_id</u>.

       The <b>tep_filter_strerror()</b> function copies the <u>filter</u> error buffer into the given <u>buf</u> with the size
       <u>buflen</u>. If the error buffer is empty, in the <u>buf</u> is copied a string, describing the error <u>err</u>.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>tep_filter_alloc()</b> function returns a pointer to the newly created event filter, or NULL in case of
       an error.

       The <b>tep_filter_add_filter_str()</b> function returns 0 if the rule was successfully added or a negative error
       code. Use <b>tep_filter_strerror()</b> to see actual error message in case of an error.

       The <b>tep_event_filtered()</b> function returns 1 if the filter is found for given event, or 0 otherwise.

       The <b>tep_filter_remove_event()</b> function returns 1 if the vent was removed, or 0 if the event was not
       found.

       The <b>tep_filter_match()</b> function returns <u>tep_errno</u>, according to the result:

           <u>TEP_ERRNO</u><b>__</b><u>FILTER_MATCH</u>        - filter found for event, the record matches.
           <u>TEP_ERRNO</u><b>__</b><u>FILTER_MISS</u>         - filter found for event, the record does not match.
           <u>TEP_ERRNO</u><b>__</b><u>FILTER_NOT_FOUND</u>    - no filter found for record’s event.
           <u>TEP_ERRNO</u><b>__</b><u>NO_FILTER</u>           - no rules in the filter.

       or any other <u>tep_errno</u>, if an error occurred during the test.

       The <b>tep_filter_copy()</b> function returns 0 on success or -1 if not all rules were copied.

       The <b>tep_filter_compare()</b> function returns 1 if the two filters hold the same content, or 0 if they do
       not.

       The <b>tep_filter_make_string()</b> function returns a string, which must be freed with free(), or NULL in case
       of an error.

       The <b>tep_filter_strerror()</b> function returns 0 if message was filled successfully, or -1 in case of an
       error.

</pre><h4><b>EXAMPLE</b></h4><pre>
           #include &lt;event-parse.h&gt;
           ...
           struct tep_handle *tep = tep_alloc();
           ...
           char errstr[200];
           int ret;

           struct tep_event_filter *filter = tep_filter_alloc(tep);
           struct tep_event_filter *filter1 = tep_filter_alloc(tep);
           ret = tep_filter_add_filter_str(filter, "sched/sched_wakeup:target_cpu==1");
           if(ret &lt; 0) {
                   tep_filter_strerror(filter, ret, errstr, sizeof(errstr));
                   /* Failed to add a new rule to the filter, the error string is in errstr */
           }
           if (tep_filter_copy(filter1, filter) != 0) {
                   /* Failed to copy filter in filter1 */
           }
           ...
           if (tep_filter_compare(filter, filter1) != 1) {
                   /* Both filters are different */
           }
           ...
           void process_record(struct tep_handle *tep, struct tep_record *record)
           {
                   struct tep_event *event;
                   char *fstring;

                   event = tep_find_event_by_record(tep, record);

                   if (tep_event_filtered(filter, event-&gt;id) == 1) {
                           /* The event has filter */
                           fstring = tep_filter_make_string(filter, event-&gt;id);
                           if (fstring != NULL) {
                                   /* The filter for the event is in fstring */
                                   free(fstring);
                           }
                   }

                   switch (tep_filter_match(filter, record)) {
                   case TEP_ERRNO__FILTER_MATCH:
                           /* The filter matches the record */
                           break;
                   case TEP_ERRNO__FILTER_MISS:
                           /* The filter does not match the record */
                           break;
                   case TEP_ERRNO__FILTER_NOT_FOUND:
                           /* No filter found for record's event */
                           break;
                   case TEP_ERRNO__NO_FILTER:
                           /* There are no rules in the filter */
                           break
                   default:
                           /* An error occurred during the test */
                           break;
                   }

                   if (tep_filter_remove_event(filter, event-&gt;id) == 1) {
                           /* The event was removed from the filter */
                   }
           }

           ...
           tep_filter_reset(filter);
           ...
           tep_filter_free(filter);
           tep_filter_free(filter1);
           ...

</pre><h4><b>FILES</b></h4><pre>
           <b>event-parse.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>-ltraceevent</b>
                   Linker switch to add when building a program that uses the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libtraceevent.3.html">libtraceevent</a></b>(3), <b><a href="../man1/trace-cmd.1.html">trace-cmd</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
           <b>Steven</b> <b>Rostedt</b> &lt;<b><a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a></b>[1]&gt;, author of <b>libtraceevent</b>.
           <b>Tzvetomir</b> <b>Stoyanov</b> &lt;<b><a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a></b>[2]&gt;, author of this man page.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<b><a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a></b>[3]&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       libtraceevent is Free Software licensed under the GNU LGPL 2.1

</pre><h4><b>RESOURCES</b></h4><pre>
       <b>https://git.kernel.org/pub/scm/libs/libtrace/libtraceevent.git/</b>

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a>
           <a href="mailto:rostedt@goodmis.org">mailto:rostedt@goodmis.org</a>

        2. <a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a>
           <a href="mailto:tz.stoyanov@gmail.com">mailto:tz.stoyanov@gmail.com</a>

        3. <a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a>
           <a href="mailto:linux-trace-devel@vger.kernel.org">mailto:linux-trace-devel@vger.kernel.org</a>

libtraceevent 1.8.4                                12/24/2024                                   <u><a href="../man3/LIBTRACEEVENT.3.html">LIBTRACEEVENT</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>