<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmExtractValue - extract a performance metric value from a pmResult structure</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpcp3-dev">libpcp3-dev_6.3.8-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmExtractValue</b> - extract a performance metric value from a pmResult structure

</pre><h4><b>C</b> <b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;pcp/pmapi.h&gt;</b>

       <b>int</b> <b>pmExtractValue(int</b> <u>valfmt</u><b>,</b> <b>const</b> <b>pmValue</b> <b>*</b><u>ival</u><b>,</b> <b>int</b> <u>itype</u><b>,</b> <b>pmAtomValue</b> <b>*</b><u>oval</u><b>,</b> <b>int</b> <u>otype</u><b>);</b>

       <b>cc</b> <b>...</b> <b>-lpcp</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <u>pmValue</u>  structure is embedded within the <u>pmResult</u> structure that is used to return one or more per‐
       formance metrics; see <b><a href="../man3/pmFetch.3.html">pmFetch</a></b>(3).

       All performance metric values may be encoded in a <u>pmAtomValue</u> union, defined as follows;

            typedef union {
                __int32_t    l;     /* 32-bit signed */
                __uint32_t   ul;    /* 32-bit unsigned */
                __int64_t    ll;    /* 64-bit signed */
                __uint64_t   ull;   /* 64-bit unsigned */
                float        f;     /* 32-bit floating point */
                double       d;     /* 64-bit floating point */
                char         *cp;   /* char ptr */
                pmValueBlock *vbp;  /* pmValueBlock ptr */
            } pmAtomValue;

       The routine <b>pmExtractValue</b> provides a convenient mechanism for extracting values from the <u>pmValue</u> part of
       a <u>pmResult</u> structure, optionally converting the data type, and making the result available to the  appli‐
       cation programmer.

       <u>itype</u>  defines  the  data type of the input value held in <u>ival</u> according to the storage format defined by
       <u>valfmt</u> (see <b><a href="../man3/pmFetch.3.html">pmFetch</a></b>(3)).  <u>otype</u> defines the data type of the result to be placed in <u>oval</u>.

       The value for <u>itype</u> is typically extracted from a <u>pmDesc</u> structure, following a call  to  <b><a href="../man3/pmLookupDesc.3.html">pmLookupDesc</a></b>(3)
       for a particular performance metric.

       The <u>otype</u> value should be one of the defined <b>PM_TYPE_</b>...  values, that have a 1:1 correspondence with the
       fields in the <u>pmAtomValue</u> union.

       Normally  the  <u>valfmt</u>  parameter would be plucked from the same <u>pmResult</u> structure that provides the <u>ival</u>
       parameter, and if <u>valfmt</u> specifies <b>PM_VAL_INSITU</b>, then the following types are not allowed, as these can‐
       not be encoded in 32-bits; <b>__int64_t</b>, <b>__uint64_t</b>, <b>double</b>, <b>char</b> <b>*</b> and <b>void</b> <b>*</b> (the corresponding <u>itype</u> val‐
       ues are <b>PM_TYPE_64</b>, <b>PM_TYPE_U64</b>, <b>PM_TYPE_DOUBLE</b>, <b>PM_TYPE_STRING</b>, <b>PM_TYPE_AGGREGATE</b> and <b>PM_TYPE_EVENT</b>  re‐
       spectively).   If  <u>valfmt</u> specifies <b>PM_VAL_SPTR</b> or <b>PM_VAL_DPTR</b>, then the value will be extracted from the
       associated <u>pmValueBlock</u>  structure,  and  the  <b>__int32_t</b>,  <b>__uint32_t</b>  and  <b>float</b>  options  (<u>itype</u>  being
       <b>PM_TYPE_32</b>,  <b>PM_TYPE_U32</b>  and <b>PM_TYPE_FLOAT</b> respectively) are not allowed, as <b>PM_VAL_INSITU</b> is the appro‐
       priate encoding for these.

       The following table defines the various possibilities for the type conversion -- the input  type  (<u>itype</u>)
       is shown vertically, and the output type (<u>otype</u>) is shown horizontally.  Y means the conversion is always
       acceptable, N means the conversion can never be performed (the function returns <b>PM_ERR_CONV</b>), P means the
       conversion  may  lose  accuracy  (but  no error status is returned), T means the result may be subject to
       high-order truncation (in which case the function returns <b>PM_ERR_TRUNC</b>) and S means the conversion may be
       impossible due to the sign of the input value (in which case the function returns  <b>PM_ERR_SIGN</b>).   If  an
       error occurs, the value represented by <u>oval</u> will be zero (or <b>NULL</b>).

       Note  that  although some of the conversions involving the types <b>PM_TYPE_STRING</b> and <b>PM_TYPE_AGGREGATE</b> are
       indeed possible, but are marked N - the rationale is that <b>pmExtractValue</b> should not be attempting to  du‐
       plicate functionality already available in the C library via <b><a href="../man3/sscanf.3.html">sscanf</a></b>(3) and <b><a href="../man3/sprintf.3.html">sprintf</a></b>(3).

       No conversion involving the type <b>PM_TYPE_EVENT</b> is supported.

             | 32  |  U32  | 64  |  U64  | FLOAT | DBLE | STRNG | AGGR | EVENT
       ======|=====|=======|=====|=======|=======|======|=======|======|=======
       32    |  Y  |   S   |  Y  |   S   |   P   |  P   |   N   |  N   |   N
       U32   |  T  |   Y   |  Y  |   Y   |   P   |  P   |   N   |  N   |   N
       64    |  T  |  T,S  |  Y  |   S   |   P   |  P   |   N   |  N   |   N
       U64   |  T  |   T   |  T  |   Y   |   P   |  P   |   N   |  N   |   N
       FLOAT | P,T | P,T,S | P,T | P,T,S |   Y   |  Y   |   N   |  N   |   N
       DBLE  | P,T | P,T,S | P,T | P,T,S |   P   |  Y   |   N   |  N   |   N
       STRNG |  N  |   N   |  N  |   N   |   N   |  N   |   Y   |  N   |   N
       AGGR  |  N  |   N   |  N  |   N   |   N   |  N   |   N   |  Y   |   N
       EVENT |  N  |   N   |  N  |   N   |   N   |  N   |   N   |  N   |   N

       In  the cases where multiple conversion errors could occur, the first encountered error will be notified,
       and the order of checking is not defined.

       If the output conversion is to one of the pointer types, i.e. <u>otype</u> is <b>PM_TYPE_STRING</b>  or  <b>PM_TYPE_AGGRE‐</b>
       <b>GATE</b>,  then the value buffer will have been allocated by <b><a href="../man3/pmExtractValue.3.html">pmExtractValue</a></b>(3) using <b><a href="../man3/malloc.3.html">malloc</a></b>(3), and it is the
       caller's responsibility to free the space when it is no longer required.

       Although this function appears rather complex, it has been constructed to assist the development of  per‐
       formance  tools  that  wish  to  convert  values, whose type is only known via the <u>type</u> field in a <u>pmDesc</u>
       structure, into a canonical type for local processing.  See the <b>pmFetchGroup</b> functions for a simpler  al‐
       ternative.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       <b>PM_ERR_CONV</b>

              Impossible conversion, marked by N in above table

       <b>PM_ERR_TRUNC</b>

              High-order truncation occurred

       <b>PM_ERR_SIGN</b>

              Conversion of negative value to unsigned type attempted

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3),  <b><a href="../man3/pmAtomStr.3.html">pmAtomStr</a></b>(3),  <b><a href="../man3/pmConvScale.3.html">pmConvScale</a></b>(3),  <b><a href="../man3/pmFetch.3.html">pmFetch</a></b>(3), <b><a href="../man3/pmFetchGroup.3.html">pmFetchGroup</a></b>(3), <b><a href="../man3/pmLookupDesc.3.html">pmLookupDesc</a></b>(3), <b><a href="../man3/pmPrintValue.3.html">pmPrintValue</a></b>(3),
       <b><a href="../man3/pmTypeStr.3.html">pmTypeStr</a></b>(3), <b><a href="../man3/pmUnitsStr.3.html">pmUnitsStr</a></b>(3) and <b><a href="../man3/pmUnpackEventRecords.3.html">pmUnpackEventRecords</a></b>(3).

Performance Co-Pilot                                   PCP                                     <u><a href="../man3/PMEXTRACTVALUE.3.html">PMEXTRACTVALUE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>