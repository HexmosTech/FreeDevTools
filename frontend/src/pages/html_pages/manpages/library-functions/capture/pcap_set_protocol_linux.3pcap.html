<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pcap_set_protocol_linux - set capture protocol for a not-yet-activated capture handle</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpcap0.8-dev">libpcap0.8-dev_1.10.5-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pcap_set_protocol_linux - set capture protocol for a not-yet-activated capture handle

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;pcap/pcap.h&gt;</b>

       <b>int</b> <b>pcap_set_protocol_linux(pcap_t</b> <b>*p,</b> <b>int</b> <b>protocol);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       On  network  interface  devices  on  Linux, <b>pcap_set_protocol_linux</b>() sets the protocol to be used in the
       <b><a href="../man2/socket.2.html">socket</a></b>(2) call to create a capture socket when the handle is activated.  The  argument  is  a  link-layer
       protocol  value,  such as the values in the <b>&lt;linux/if_ether.h&gt;</b> header file, specified in host byte order.
       If <u>protocol</u> is non-zero, packets of that  protocol  will  be  captured  when  the  handle  is  activated,
       otherwise,  all packets will be captured.  This function is only provided on Linux, and, if it is used on
       any device other than a network interface, it will have no effect.

       It should not be used in portable code; instead, a filter should be specified with <b><a href="../man3PCAP/pcap_setfilter.3PCAP.html">pcap_setfilter</a></b>(3PCAP).

       If a given network interface provides a standard link-layer header, with  a  standard  packet  type,  but
       provides  some  packet  types  with a different socket-layer protocol type from the one in the link-layer
       header, that packet type cannot be filtered with a filter specified  with  <b>pcap_setfilter</b>()  but  can  be
       filtered by specifying the socket-layer protocol type using <b>pcap_set_protocol_linux</b>().

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>pcap_set_protocol_linux</b>() returns <b>0</b> on success or <b>PCAP_ERROR_ACTIVATED</b> if called on a capture handle that
       has been activated.

</pre><h4><b>BACKWARD</b> <b>COMPATIBILITY</b></h4><pre>
       This function became available in libpcap release 1.9.0.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3PCAP/pcap.3PCAP.html">pcap</a></b>(3PCAP), <b><a href="../man3PCAP/pcap_create.3PCAP.html">pcap_create</a></b>(3PCAP), <b><a href="../man3PCAP/pcap_activate.3PCAP.html">pcap_activate</a></b>(3PCAP)

                                                 22 August 2018                   <u><a href="../man3PCAP/PCAP_SET_PROTOCOL_LINUX.3PCAP.html">PCAP_SET_PROTOCOL_LINUX</a></u>(3PCAP)
</pre>
 </div>
</div></section>
</div>
</body>
</html>