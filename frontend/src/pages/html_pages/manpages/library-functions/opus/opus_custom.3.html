<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>opus_custom - Opus Custom</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libopus-doc">libopus-doc_1.5.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       opus_custom - Opus Custom

        - Opus Custom is an optional part of the Opus specification and reference implementation which uses a
       distinct API from the regular API and supports frame sizes that are not normally supported. Use of Opus
       Custom is discouraged for all but very special applications for which a frame size different from 2.5, 5,
       10, or 20 ms is needed (for either complexity or latency reasons) and where interoperability is less
       important.

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Typedefs</b>
       typedef struct <b>OpusCustomEncoder</b> <b>OpusCustomEncoder</b>
           Contains the state of an encoder.
       typedef struct <b>OpusCustomDecoder</b> <b>OpusCustomDecoder</b>
           State of the decoder.
       typedef struct <b>OpusCustomMode</b> <b>OpusCustomMode</b>
           The mode contains all the information necessary to create an encoder.

   <b>Functions</b>
       <b>OpusCustomMode</b> * <b>opus_custom_mode_create</b> (<b>opus_int32</b> Fs, int frame_size, int *error)
           Creates a new mode struct.
       void <b>opus_custom_mode_destroy</b> (<b>OpusCustomMode</b> *mode)
           Destroys a mode struct.
       int <b>opus_custom_encoder_get_size</b> (const <b>OpusCustomMode</b> *mode, int channels)
           Gets the size of an OpusCustomEncoder structure.
       <b>OpusCustomEncoder</b> * <b>opus_custom_encoder_create</b> (const <b>OpusCustomMode</b> *mode, int channels, int *error)
           Creates a new encoder state.
       void <b>opus_custom_encoder_destroy</b> (<b>OpusCustomEncoder</b> *st)
           Destroys an encoder state.
       int <b>opus_custom_encode_float</b> (<b>OpusCustomEncoder</b> *st, const float *pcm, int frame_size, unsigned char
           *compressed, int maxCompressedBytes)
           Encodes a frame of audio.
       int <b>opus_custom_encode</b> (<b>OpusCustomEncoder</b> *st, const <b>opus_int16</b> *pcm, int frame_size, unsigned char
           *compressed, int maxCompressedBytes)
           Encodes a frame of audio.
       int <b>opus_custom_encoder_ctl</b> (<b>OpusCustomEncoder</b> *OPUS_RESTRICT st, int request,...)
           Perform a CTL function on an Opus custom encoder.
       int <b>opus_custom_decoder_get_size</b> (const <b>OpusCustomMode</b> *mode, int channels)
           Gets the size of an OpusCustomDecoder structure.
       int <b>opus_custom_decoder_init</b> (<b>OpusCustomDecoder</b> *st, const <b>OpusCustomMode</b> *mode, int channels)
           Initializes a previously allocated decoder state The memory pointed to by st must be the size
           returned by opus_custom_decoder_get_size.
       <b>OpusCustomDecoder</b> * <b>opus_custom_decoder_create</b> (const <b>OpusCustomMode</b> *mode, int channels, int *error)
           Creates a new decoder state.
       void <b>opus_custom_decoder_destroy</b> (<b>OpusCustomDecoder</b> *st)
           Destroys a decoder state.
       int <b>opus_custom_decode_float</b> (<b>OpusCustomDecoder</b> *st, const unsigned char *data, int len, float *pcm, int
           frame_size)
           Decode an opus custom frame with floating point output.
       int <b>opus_custom_decode</b> (<b>OpusCustomDecoder</b> *st, const unsigned char *data, int len, <b>opus_int16</b> *pcm, int
           frame_size)
           Decode an opus custom frame.
       int <b>opus_custom_decoder_ctl</b> (<b>OpusCustomDecoder</b> *OPUS_RESTRICT st, int request,...)
           Perform a CTL function on an Opus custom decoder.

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       Opus Custom is an optional part of the Opus specification and reference implementation which uses a
       distinct API from the regular API and supports frame sizes that are not normally supported. Use of Opus
       Custom is discouraged for all but very special applications for which a frame size different from 2.5, 5,
       10, or 20 ms is needed (for either complexity or latency reasons) and where interoperability is less
       important.

       In addition to the interoperability limitations the use of Opus custom disables a substantial chunk of
       the codec and generally lowers the quality available at a given bitrate. Normally when an application
       needs a different frame size from the codec it should buffer to match the sizes but this adds a small
       amount of delay which may be important in some very low latency applications. Some transports (especially
       constant rate RF transports) may also work best with frames of particular durations.

       Libopus only supports custom modes if they are enabled at compile time.

       The Opus Custom API is similar to the regular API but the <b>opus_encoder_create</b> and <b>opus_decoder_create</b>
       calls take an additional mode parameter which is a structure produced by a call to
       <b>opus_custom_mode_create</b>. Both the encoder and decoder must create a mode using the same sample rate (fs)
       and frame size (frame size) so these parameters must either be signaled out of band or fixed in a
       particular implementation.

       Similar to regular Opus the custom modes support on the fly frame size switching, but the sizes available
       depend on the particular frame size in use. For some initial frame sizes on a single on the fly size is
       available.

</pre><h4><b>Typedef</b> <b>Documentation</b></h4><pre>
   <b>typedef</b> <b>struct</b> <b>OpusCustomDecoder</b> <b>OpusCustomDecoder</b>
       State of the decoder. One decoder state is needed for each stream. It is initialized once at the
       beginning of the stream. Do <u>not</u> re-initialize the state for every frame.

       Decoder state

   <b>typedef</b> <b>struct</b> <b>OpusCustomEncoder</b> <b>OpusCustomEncoder</b>
       Contains the state of an encoder. One encoder state is needed for each stream. It is initialized once at
       the beginning of the stream. Do <u>not</u> re-initialize the state for every frame.

       Encoder state

   <b>typedef</b> <b>struct</b> <b>OpusCustomMode</b> <b>OpusCustomMode</b>
       The mode contains all the information necessary to create an encoder. Both the encoder and decoder need
       to be initialized with exactly the same mode, otherwise the output will be corrupted. The mode MUST NOT
       BE DESTROYED until the encoders and decoders that use it are destroyed as well.

       Mode configuration

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>int</b> <b>opus_custom_decode</b> <b>(OpusCustomDecoder</b> <b>*</b> <b>st,</b> <b>const</b> <b>unsigned</b> <b>char</b> <b>*</b> <b>data,</b> <b>int</b> <b>len,</b> <b>opus_int16</b> <b>*</b> <b>pcm,</b> <b>int</b>
       <b>frame_size)</b>
       Decode an opus custom frame.

       <b>Parameters</b>
           <u>st</u> OpusCustomDecoder*: Decoder state
           <u>data</u> char*: Input payload. Use a NULL pointer to indicate packet loss
           <u>len</u> int: Number of bytes in payload
           <u>pcm</u> opus_int16*: Output signal (interleaved if 2 channels). length is
           frame_size*channels*sizeof(opus_int16)
           <u>frame_size</u> Number of samples per channel of available space in *pcm.

       <b>Returns</b>
           Number of decoded samples or <b>Error</b> <b>codes</b>

   <b>int</b> <b>opus_custom_decode_float</b> <b>(OpusCustomDecoder</b> <b>*</b> <b>st,</b> <b>const</b> <b>unsigned</b> <b>char</b> <b>*</b> <b>data,</b> <b>int</b> <b>len,</b> <b>float</b> <b>*</b> <b>pcm,</b> <b>int</b>
       <b>frame_size)</b>
       Decode an opus custom frame with floating point output.

       <b>Parameters</b>
           <u>st</u> OpusCustomDecoder*: Decoder state
           <u>data</u> char*: Input payload. Use a NULL pointer to indicate packet loss
           <u>len</u> int: Number of bytes in payload
           <u>pcm</u> float*: Output signal (interleaved if 2 channels). length is frame_size*channels*sizeof(float)
           <u>frame_size</u> Number of samples per channel of available space in *pcm.

       <b>Returns</b>
           Number of decoded samples or <b>Error</b> <b>codes</b>

   <b>OpusCustomDecoder</b> <b>*</b> <b>opus_custom_decoder_create</b> <b>(const</b> <b>OpusCustomMode</b> <b>*</b> <b>mode,</b> <b>int</b> <b>channels,</b> <b>int</b> <b>*</b> <b>error)</b>
       Creates a new decoder state. Each stream needs its own decoder state (can't be shared across simultaneous
       streams).

       <b>Parameters</b>
           <u>mode</u> OpusCustomMode: Contains all the information about the characteristics of the stream (must be
           the same characteristics as used for the encoder)
           <u>channels</u> int: Number of channels
           <u>error</u> int*: Returns an error code

       <b>Returns</b>
           Newly created decoder state.

   <b>int</b> <b>opus_custom_decoder_ctl</b> <b>(OpusCustomDecoder</b> <b>*OPUS_RESTRICT</b> <b>st,</b> <b>int</b> <b>request,</b>  <b>...)</b>
       Perform a CTL function on an Opus custom decoder. Generally the request and subsequent arguments are
       generated by a convenience macro.

       <b>See</b> <b>also</b>
           <b>Generic</b> <b>CTLs</b>

   <b>void</b> <b>opus_custom_decoder_destroy</b> <b>(OpusCustomDecoder</b> <b>*</b> <b>st)</b>
       Destroys a decoder state.

       <b>Parameters</b>
           <u>st</u> OpusCustomDecoder*: State to be freed.

   <b>int</b> <b>opus_custom_decoder_get_size</b> <b>(const</b> <b>OpusCustomMode</b> <b>*</b> <b>mode,</b> <b>int</b> <b>channels)</b>
       Gets the size of an OpusCustomDecoder structure.

       <b>Parameters</b>
           <u>mode</u> OpusCustomMode *: Mode configuration
           <u>channels</u> int: Number of channels

       <b>Returns</b>
           size

   <b>int</b> <b>opus_custom_decoder_init</b> <b>(OpusCustomDecoder</b> <b>*</b> <b>st,</b> <b>const</b> <b>OpusCustomMode</b> <b>*</b> <b>mode,</b> <b>int</b> <b>channels)</b>
       Initializes a previously allocated decoder state The memory pointed to by st must be the size returned by
       opus_custom_decoder_get_size. This is intended for applications which use their own allocator instead of
       malloc.

       <b>See</b> <b>also</b>
           <b>opus_custom_decoder_create()</b>,<b>opus_custom_decoder_get_size()</b> To reset a previously initialized state
           use the <b>OPUS_RESET_STATE</b> CTL.

       <b>Parameters</b>
           <u>st</u> OpusCustomDecoder*: Decoder state
           <u>mode</u> OpusCustomMode *: Contains all the information about the characteristics of the stream (must be
           the same characteristics as used for the encoder)
           <u>channels</u> int: Number of channels

       <b>Returns</b>
           OPUS_OK Success or <b>Error</b> <b>codes</b>

   <b>int</b> <b>opus_custom_encode</b> <b>(OpusCustomEncoder</b> <b>*</b> <b>st,</b> <b>const</b> <b>opus_int16</b> <b>*</b> <b>pcm,</b> <b>int</b> <b>frame_size,</b> <b>unsigned</b> <b>char</b> <b>*</b>
       <b>compressed,</b> <b>int</b> <b>maxCompressedBytes)</b>
       Encodes a frame of audio.

       <b>Parameters</b>
           <u>st</u> OpusCustomEncoder*: Encoder state
           <u>pcm</u> opus_int16*: PCM audio in signed 16-bit format (native endian). There must be exactly frame_size
           samples per channel.
           <u>frame_size</u> int: Number of samples per frame of input signal
           <u>compressed</u> char *: The compressed data is written here. This may not alias pcm and must be at least
           maxCompressedBytes long.
           <u>maxCompressedBytes</u> int: Maximum number of bytes to use for compressing the frame (can change from one
           frame to another)

       <b>Returns</b>
           Number of bytes written to 'compressed'. If negative, an error has occurred (see error codes). It is
           IMPORTANT that the length returned be somehow transmitted to the decoder. Otherwise, no decoding is
           possible.

   <b>int</b> <b>opus_custom_encode_float</b> <b>(OpusCustomEncoder</b> <b>*</b> <b>st,</b> <b>const</b> <b>float</b> <b>*</b> <b>pcm,</b> <b>int</b> <b>frame_size,</b> <b>unsigned</b> <b>char</b> <b>*</b>
       <b>compressed,</b> <b>int</b> <b>maxCompressedBytes)</b>
       Encodes a frame of audio.

       <b>Parameters</b>
           <u>st</u> OpusCustomEncoder*: Encoder state
           <u>pcm</u> float*: PCM audio in float format, with a normal range of +/-1.0. Samples with a range beyond
           +/-1.0 are supported but will be clipped by decoders using the integer API and should only be used if
           it is known that the far end supports extended dynamic range. There must be exactly frame_size
           samples per channel.
           <u>frame_size</u> int: Number of samples per frame of input signal
           <u>compressed</u> char *: The compressed data is written here. This may not alias pcm and must be at least
           maxCompressedBytes long.
           <u>maxCompressedBytes</u> int: Maximum number of bytes to use for compressing the frame (can change from one
           frame to another)

       <b>Returns</b>
           Number of bytes written to 'compressed'. If negative, an error has occurred (see error codes). It is
           IMPORTANT that the length returned be somehow transmitted to the decoder. Otherwise, no decoding is
           possible.

   <b>OpusCustomEncoder</b> <b>*</b> <b>opus_custom_encoder_create</b> <b>(const</b> <b>OpusCustomMode</b> <b>*</b> <b>mode,</b> <b>int</b> <b>channels,</b> <b>int</b> <b>*</b> <b>error)</b>
       Creates a new encoder state. Each stream needs its own encoder state (can't be shared across simultaneous
       streams).

       <b>Parameters</b>
           <u>mode</u> OpusCustomMode*: Contains all the information about the characteristics of the stream (must be
           the same characteristics as used for the decoder)
           <u>channels</u> int: Number of channels
           <u>error</u> int*: Returns an error code

       <b>Returns</b>
           Newly created encoder state.

   <b>int</b> <b>opus_custom_encoder_ctl</b> <b>(OpusCustomEncoder</b> <b>*OPUS_RESTRICT</b> <b>st,</b> <b>int</b> <b>request,</b>  <b>...)</b>
       Perform a CTL function on an Opus custom encoder. Generally the request and subsequent arguments are
       generated by a convenience macro.

       <b>See</b> <b>also</b>
           <b>Encoder</b> <b>related</b> <b>CTLs</b>

   <b>void</b> <b>opus_custom_encoder_destroy</b> <b>(OpusCustomEncoder</b> <b>*</b> <b>st)</b>
       Destroys an encoder state.

       <b>Parameters</b>
           <u>st</u> OpusCustomEncoder*: State to be freed.

   <b>int</b> <b>opus_custom_encoder_get_size</b> <b>(const</b> <b>OpusCustomMode</b> <b>*</b> <b>mode,</b> <b>int</b> <b>channels)</b>
       Gets the size of an OpusCustomEncoder structure.

       <b>Parameters</b>
           <u>mode</u> OpusCustomMode *: Mode configuration
           <u>channels</u> int: Number of channels

       <b>Returns</b>
           size

   <b>OpusCustomMode</b> <b>*</b> <b>opus_custom_mode_create</b> <b>(opus_int32</b> <b>Fs,</b> <b>int</b> <b>frame_size,</b> <b>int</b> <b>*</b> <b>error)</b>
       Creates a new mode struct. This will be passed to an encoder or decoder. The mode MUST NOT BE DESTROYED
       until the encoders and decoders that use it are destroyed as well.

       <b>Parameters</b>
           <u>Fs</u> int: Sampling rate (8000 to 96000 Hz)
           <u>frame_size</u> int: Number of samples (per channel) to encode in each packet (64 - 1024, prime
           factorization must contain zero or more 2s, 3s, or 5s and no other primes)
           <u>error</u> int*: Returned error code (if NULL, no error will be returned)

       <b>Returns</b>
           A newly created mode

   <b>void</b> <b>opus_custom_mode_destroy</b> <b>(OpusCustomMode</b> <b>*</b> <b>mode)</b>
       Destroys a mode struct. Only call this after all encoders and decoders using this mode are destroyed as
       well.

       <b>Parameters</b>
           <u>mode</u> OpusCustomMode*: Mode to be freed.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for Opus from the source code.

Version 1.5.2                                Wed Jul 3 2024 11:41:33                              <u><a href="../man3/opus_custom.3.html">opus_custom</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>