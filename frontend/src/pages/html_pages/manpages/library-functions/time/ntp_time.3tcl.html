<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ntp_time - Tcl Time Service Client</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ntp_time - Tcl Time Service Client

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>time</b> <b>?1.2.2?</b>

       <b>::time::gettime</b> ?<u>options</u>? <u>timeserver</u> ?<u>port</u>?

       <b>::time::getsntp</b> ?<u>options</u>? <u>timeserver</u> ?<u>port</u>?

       <b>::time::configure</b> ?<u>options</u>?

       <b>::time::cget</b> <u>name</u>

       <b>::time::unixtime</b> <u>token</u>

       <b>::time::status</b> <u>token</u>

       <b>::time::error</b> <u>token</u>

       <b>::time::reset</b> <u>token</u> <u>?reason?</u>

       <b>::time::wait</b> <u>token</u>

       <b>::time::cleanup</b> <u>token</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This package implements a client for the RFC 868 TIME protocol (<u><a href="http://www.rfc-editor.org/rfc/rfc868.txt">http://www.rfc-editor.org/rfc/rfc868.txt</a></u>)
       and   also   a   minimal   client  for  the  RFC  2030  Simple  Network  Time  Protocol  (<u><a href="http://www.rfc">http://www.rfc</a>-</u>
       <u>editor.org/rfc/rfc2030.txt</u>).  RFC 868 returns the time in seconds since 1 January 1900 to either  tcp  or
       udp  clients. RFC 2030 also gives this time but also provides a fractional part which is not used in this
       client.

</pre><h4><b>COMMANDS</b></h4><pre>
       <b>::time::gettime</b> ?<u>options</u>? <u>timeserver</u> ?<u>port</u>?
              Get the time from <u>timeserver</u>. You may specify any of the options listed for the <b>configure</b>  command
              here.  This  command  returns  a token which must then be used with the remaining commands in this
              package. Once you have finished, you should use <b>cleanup</b> to release all resources. The default port
              is <b>37</b>.

       <b>::time::getsntp</b> ?<u>options</u>? <u>timeserver</u> ?<u>port</u>?
              Get the time from an SNTP server. This accepts  exactly  the  same  arguments  as  <b>::time::gettime</b>
              except  that  the  default port is <b>123</b>. The result is a token as per <b>::time::gettime</b> and should be
              handled in the same way.

              Note that it is unlikely that any SNTP server will reply using tcp so you will require the  <b>tcludp</b>
              or  the  <b>ceptcl</b> package. If a suitable package can be loaded then the udp protocol will be used by
              default.

       <b>::time::configure</b> ?<u>options</u>?
              Called with no arguments this command returns all the current configuration  options  and  values.
              Otherwise it should be called with pairs of option name and value.

              <b>-protocol</b> <u>number</u>
                     Set  the default network protocol. This defaults to udp if the tcludp package is available.
                     Otherwise it will use tcp.

              <b>-port</b> <u>number</u>
                     Set the default port to use. RFC 868 uses port <b>37</b>, RFC 2030 uses port <b>123</b>.

              <b>-timeout</b> <u>number</u>
                     Set the default timeout value in milliseconds. The default is 10 seconds.

              <b>-command</b> <u>number</u>
                     Set a command procedure to be run when a reply is received. The procedure  is  called  with
                     the time token appended to the argument list.

              <b>-loglevel</b> <u>number</u>
                     Set the logging level. The default is 'warning'.

       <b>::time::cget</b> <u>name</u>
              Get the current value for the named configuration option.

       <b>::time::unixtime</b> <u>token</u>
              Format the returned time for the unix epoch. RFC 868 time defines time 0 as 1 Jan 1900, while unix
              time defines time 0 as 1 Jan 1970. This command converts the reply to unix time.

       <b>::time::status</b> <u>token</u>
              Returns  the  status  flag.  For  a  successfully completed query this will be <u>ok</u>. May be <u>error</u> or
              <u>timeout</u> or <u>eof</u>.  See also <b>::time::error</b>

       <b>::time::error</b> <u>token</u>
              Returns the error message provided for requests whose status is  <u>error</u>.   If  there  is  no  error
              message then an empty string is returned.

       <b>::time::reset</b> <u>token</u> <u>?reason?</u>
              Reset or cancel the query optionally specfying the reason to record for the <b>error</b> command.

       <b>::time::wait</b> <u>token</u>
              Wait for a query to complete and return the status upon completion.

       <b>::time::cleanup</b> <u>token</u>
              Remove all state variables associated with the request.

              % set tok [::time::gettime ntp2a.mcc.ac.uk]
              % set t [::time::unixtime $tok]
              % ::time::cleanup $tok

              % set tok [::time::getsntp pool.ntp.org]
              % set t [::time::unixtime $tok]
              % ::time::cleanup $tok

              proc on_time {token} {
                 if {[time::status $token] eq "ok"} {
                    puts [clock format [time::unixtime $token]]
                 } else {
                    puts [time::error $token]
                 }
                 time::cleanup $token
              }
              time::getsntp -command on_time pool.ntp.org

</pre><h4><b>AUTHORS</b></h4><pre>
       Pat Thoyts

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This  document,  and  the package it describes, will undoubtedly contain bugs and other problems.  Please
       report such in the category <u>ntp</u> of the <u>Tcllib</u>  <u>Trackers</u>  [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].   Please
       also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note  further  that  <u>attachments</u>  are strongly preferred over inlined patches. Attachments can be made by
       going to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most  button
       in the secondary navigation bar.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       ntp

</pre><h4><b>KEYWORDS</b></h4><pre>
       NTP, SNTP, rfc 2030, rfc 868, time

</pre><h4><b>CATEGORY</b></h4><pre>
       Networking

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2002, Pat Thoyts &lt;<a href="mailto:patthoyts@users.sourceforge.net">patthoyts@users.sourceforge.net</a>&gt;

tcllib                                                1.2.2                                       <u><a href="../man3tcl/ntp_time.3tcl.html">ntp_time</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>