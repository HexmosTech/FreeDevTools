<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rtime - get time from a remote machine</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       rtime - get time from a remote machine

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;rpc/auth_des.h&gt;</b>

       <b>int</b> <b>rtime(struct</b> <b>sockaddr_in</b> <b>*</b><u>addrp</u><b>,</b> <b>struct</b> <b>rpc_timeval</b> <b>*</b><u>timep</u><b>,</b>
                 <b>struct</b> <b>rpc_timeval</b> <b>*</b><u>timeout</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  function  uses  the  Time  Server Protocol as described in RFC 868 to obtain the time from a remote
       machine.

       The Time Server Protocol gives the time in seconds since 00:00:00 UTC, 1  Jan  1900,  and  this  function
       subtracts  the appropriate constant in order to convert the result to seconds since the Epoch, 1970-01-01
       00:00:00 +0000 (UTC).

       When <u>timeout</u> is non-NULL, the udp/time socket (port 37) is used.  Otherwise, the  tcp/time  socket  (port
       37) is used.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On  success,  0  is  returned, and the obtained 32-bit time value is stored in <u>timep-&gt;tv_sec</u>.  In case of
       error -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       All errors for underlying functions (<b><a href="../man2/sendto.2.html">sendto</a></b>(2), <b><a href="../man2/poll.2.html">poll</a></b>(2), <b><a href="../man2/recvfrom.2.html">recvfrom</a></b>(2),  <b><a href="../man2/connect.2.html">connect</a></b>(2),  <b><a href="../man2/read.2.html">read</a></b>(2))  can  occur.
       Moreover:

       <b>EIO</b>    The number of returned bytes is not 4.

       <b>ETIMEDOUT</b>
              The waiting time as defined in timeout has expired.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       For an explanation of the terms used in this section, see <b><a href="../man7/attributes.7.html">attributes</a></b>(7).
       ┌─────────────────────────────────────────────────────────────────────────────┬───────────────┬─────────┐
       │ <b>Interface</b>                                                                   │ <b>Attribute</b>     │ <b>Value</b>   │
       ├─────────────────────────────────────────────────────────────────────────────┼───────────────┼─────────┤
       │ <b>rtime</b>()                                                                     │ Thread safety │ MT-Safe │
       └─────────────────────────────────────────────────────────────────────────────┴───────────────┴─────────┘

</pre><h4><b>NOTES</b></h4><pre>
       Only IPv4 is supported.

       Some <u>in.timed</u> versions support only TCP.  Try the example program with <u>use_tcp</u> set to 1.

</pre><h4><b>BUGS</b></h4><pre>
       <b>rtime</b>() in glibc 2.2.5 and earlier does not work properly on 64-bit machines.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This  example  requires  that  port  37  is  up  and  open.   You  may  check  that the time entry within
       <u>/etc/inetd.conf</u> is not commented out.

       The program connects to a computer called "linux".  Using "localhost" does not work.  The result  is  the
       localtime of the computer "linux".

       #include &lt;<a href="file:/usr/include/errno.h">errno.h</a>&gt;
       #include &lt;<a href="file:/usr/include/netdb.h">netdb.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
       #include &lt;<a href="file:/usr/include/string.h">string.h</a>&gt;
       #include &lt;<a href="file:/usr/include/time.h">time.h</a>&gt;

       #include &lt;rpc/auth_des.h&gt;

       static int use_tcp = 0;
       static const char servername[] = "linux";

       int
       main(void)
       {
           int                 ret;
           time_t              t;
           struct hostent      *hent;
           struct rpc_timeval  time1 = {0, 0};
           struct rpc_timeval  timeout = {1, 0};
           struct sockaddr_in  name;

           memset(&amp;name, 0, sizeof(name));
           <a href="../man1/sethostent.1.html">sethostent</a>(1);
           hent = gethostbyname(servername);
           memcpy(&amp;name.sin_addr, hent-&gt;h_addr, hent-&gt;h_length);

           ret = rtime(&amp;name, &amp;time1, use_tcp ? NULL : &amp;timeout);
           if (ret &lt; 0)
               perror("rtime error");
           else {
               t = time1.tv_sec;
               printf("%s\n", ctime(&amp;t));
           }

           exit(EXIT_SUCCESS);
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/ntpdate.1.html">ntpdate</a></b>(1), <b><a href="../man8/inetd.8.html">inetd</a></b>(8)

Linux man-pages 6.9.1                              2024-06-15                                           <u><a href="../man3/rtime.3.html">rtime</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>