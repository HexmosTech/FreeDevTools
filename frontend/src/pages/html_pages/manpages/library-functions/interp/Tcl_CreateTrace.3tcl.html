<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tcl_CreateTrace, Tcl_CreateObjTrace, Tcl_CreateObjTrace2, Tcl_DeleteTrace - arrange for command execution</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl9.0-doc">tcl9.0-doc_9.0.1+dfsg-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Tcl_CreateTrace, Tcl_CreateObjTrace, Tcl_CreateObjTrace2, Tcl_DeleteTrace - arrange for command execution
       to be traced

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tcl.h&gt;</b>

       Tcl_Trace
       <b>Tcl_CreateTrace</b>(<u>interp,</u> <u>level,</u> <u>proc,</u> <u>clientData</u>)

       Tcl_Trace
       <b>Tcl_CreateObjTrace</b>(<u>interp,</u> <u>level,</u> <u>flags,</u> <u>objProc,</u> <u>clientData,</u> <u>deleteProc</u>)

       Tcl_Trace
       <b>Tcl_CreateObjTrace2</b>(<u>interp,</u> <u>level,</u> <u>flags,</u> <u>objProc2,</u> <u>clientData,</u> <u>deleteProc</u>)

       <b>Tcl_DeleteTrace</b>(<u>interp,</u> <u>trace</u>)

</pre><h4><b>ARGUMENTS</b></h4><pre>
       Tcl_Interp <u>*interp</u> (in)                             Interpreter   containing  command  to  be  traced  or
                                                           untraced.

       Tcl_Size <u>level</u> (in)                                 Only commands at or below this nesting level will  be
                                                           traced  unless  0  is  specified.   1 means top-level
                                                           commands only, 2 means top-level  commands  or  those
                                                           that   are   invoked  as  immediate  consequences  of
                                                           executing  top-level  commands   (procedure   bodies,
                                                           bracketed  commands,  etc.)  and so on.  A value of 0
                                                           means that commands at any level are traced.

       int <u>flags</u> (in)                                      Flags governing the trace execution.  See  below  for
                                                           details.

       Tcl_CmdObjTraceProc <u>*objProc</u> (in)                   Procedure  to call for each command that is executed.
                                                           See below for details of the calling sequence.

       Tcl_CmdObjTraceProc2 <u>*objProc2</u> (in)                 Procedure to call for each command that is  executed.
                                                           See below for details of the calling sequence.

       Tcl_CmdTraceProc <u>*proc</u> (in)                         Procedure  to call for each command that is executed.
                                                           See below for details on the calling sequence.

       void <u>*clientData</u> (in)                               Arbitrary one-word value to pass to <u>objProc</u>, <u>objProc2</u>
                                                           or <u>proc</u>.

       Tcl_CmdObjTraceDeleteProc <u>*deleteProc</u> (in)          Procedure to call when the  trace  is  deleted.   See
                                                           below  for  details  of the calling sequence.  A NULL
                                                           pointer is permissible and  results  in  no  callback
                                                           when the trace is deleted.

       Tcl_Trace <u>trace</u> (in)                                Token  for  trace  to  be  removed (return value from
                                                           previous call to <b>Tcl_CreateTrace</b>).
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Tcl_CreateObjTrace</b> arranges for command tracing.  After it is called, <u>objProc</u> will be invoked before  the
       Tcl  interpreter  calls  any command procedure when evaluating commands in <u>interp</u>.  The return value from
       <b>Tcl_CreateObjTrace</b> is a token for the trace, which may be passed to <b>Tcl_DeleteTrace</b> to remove the  trace.
       There may be many traces in effect simultaneously for the same interpreter.

       <u>objProc</u> should have arguments and result that match the type, <b>Tcl_CmdObjTraceProc</b>:

              typedef int <b>Tcl_CmdObjTraceProc</b>(
                      <b>void</b> <b>*</b> <u>clientData</u>,
                      <b>Tcl_Interp</b>* <u>interp</u>,
                      int <u>level</u>,
                      const char *<u>command</u>,
                      <b>Tcl_Command</b> <u>commandToken</u>,
                      int <u>objc</u>,
                      <b>Tcl_Obj</b> *const <u>objv</u>[]);

       <u>objProc2</u> should have arguments and result that match the type, <b>Tcl_CmdObjTraceProc2</b>:

              typedef int <b>Tcl_CmdObjTraceProc2</b>(
                      <b>void</b> <b>*</b> <u>clientData</u>,
                      <b>Tcl_Interp</b>* <u>interp</u>,
                      Tcl_Size <u>level</u>,
                      const char *<u>command</u>,
                      <b>Tcl_Command</b> <u>commandToken</u>,
                      Tcl_Size <u>objc</u>,
                      <b>Tcl_Obj</b> *const <u>objv</u>[]);

       The  <u>clientData</u> and <u>interp</u> parameters are copies of the corresponding arguments given to <b>Tcl_CreateTrace</b>.
       <u>clientData</u> typically points to an application-specific data structure that  describes  what  to  do  when
       <u>objProc</u> is invoked.  The <u>level</u> parameter gives the nesting level of the command (1 for top-level commands
       passed  to  <b>Tcl_Eval</b>  by  the  application,  2  for the next-level commands passed to <b>Tcl_Eval</b> as part of
       parsing or interpreting level-1 commands, and so on). The <u>command</u> parameter points to a string containing
       the text of the command, before any argument substitution.  The <u>commandToken</u> parameter is a  Tcl  command
       token  that  identifies  the  command  to  be  invoked.   The  token may be passed to <b>Tcl_GetCommandName</b>,
       <b>Tcl_GetCommandInfoFromToken</b>, or <b>Tcl_SetCommandInfoFromToken</b> to manipulate the definition of the  command.
       The <u>objc</u> and <u>objv</u> parameters designate the final parameter count and parameter vector that will be passed
       to the command, and have had all substitutions performed.

       The  <u>objProc</u>  callback  is  expected to return a standard Tcl status return code.  If this code is <b>TCL_OK</b>
       (the normal case), then the Tcl interpreter will invoke the command.  Any other return code is treated as
       if the command returned that status, and the command is <u>not</u> invoked.

       The <u>objProc</u> callback must not modify <u>objv</u> in any way.

       Tracing will only occur for commands at nesting level less than or equal to the <u>level</u> parameter (i.e. the
       <u>level</u> parameter to <u>objProc</u> will always be less than or equal to the <u>level</u> parameter to <b>Tcl_CreateTrace</b>).

       Tracing has a significant effect on runtime performance  because  it  causes  the  bytecode  compiler  to
       refrain  from  generating  in-line  code  for Tcl commands such as <b>if</b> and <b>while</b> in order that they may be
       traced.  If traces for the built-in commands are not required, the <u>flags</u> parameter  may  be  set  to  the
       constant  value  <b>TCL_ALLOW_INLINE_COMPILATION</b>.   In this case, traces on built-in commands may or may not
       result in trace callbacks, depending on the state of the interpreter, but run-time  performance  will  be
       improved  significantly.  (This functionality is desirable, for example, when using <b>Tcl_CreateObjTrace</b> to
       implement an execution time profiler.)

       Calls to <u>objProc</u> will be made by the Tcl parser immediately before it calls the command procedure for the
       command (<u>cmdProc</u>).  This occurs after argument parsing  and  substitution,  so  tracing  for  substituted
       commands  occurs before tracing of the commands containing the substitutions.  If there is a syntax error
       in a command, or if there is no command procedure associated with a command name, then  no  tracing  will
       occur  for  that  command.   If  a string passed to Tcl_Eval contains multiple commands (bracketed, or on
       different lines) then multiple calls to <u>objProc</u> will occur, one for each command.

       <b>Tcl_DeleteTrace</b> removes a trace, so that no future calls will be made to the  procedure  associated  with
       the trace.  After <b>Tcl_DeleteTrace</b> returns, the caller should never again use the <u>trace</u> token.

       When  <b>Tcl_DeleteTrace</b> is called, the interpreter invokes the <u>deleteProc</u> that was passed as a parameter to
       <b>Tcl_CreateObjTrace</b>.  The <u>deleteProc</u> must match the type, <b>Tcl_CmdObjTraceDeleteProc</b>:

              typedef void <b>Tcl_CmdObjTraceDeleteProc</b>(
                      <b>void</b> <b>*</b> <u>clientData</u>);

       The <u>clientData</u> parameter will be the same as the <u>clientData</u>  parameter  that  was  originally  passed  to
       <b>Tcl_CreateObjTrace</b>.

       <b>Tcl_CreateTrace</b>  is  an  alternative interface for command tracing, <u>not</u> <u>recommended</u> <u>for</u> <u>new</u> <u>applications</u>.
       It is provided for backward compatibility with code that was developed for  older  versions  of  the  Tcl
       interpreter.   It  is similar to <b>Tcl_CreateObjTrace</b>, except that its <u>proc</u> parameter should have arguments
       and result that match the type <b>Tcl_CmdTraceProc</b>:

              typedef void <b>Tcl_CmdTraceProc</b>(
                      void *<u>clientData</u>,
                      Tcl_Interp *<u>interp</u>,
                      int <u>level</u>,
                      char *<u>command</u>,
                      Tcl_CmdProc *<u>cmdProc</u>,
                      void *<u>cmdClientData</u>,
                      int <u>argc</u>,
                      const char *<u>argv</u>[]);

       The parameters to the <u>proc</u> callback are similar to those of the <u>objProc</u> callback above. The  <u>commandToken</u>
       is  replaced  with  <u>cmdProc</u>,  a pointer to the (string-based) command procedure that will be invoked; and
       <u>cmdClientData</u>, the client data that will be passed to the procedure.  The <u>objc</u> parameter is replaced with
       an <u>argv</u> parameter, that gives the arguments to the command as character strings.  <u>Proc</u>  must  not  modify
       the <u>command</u> or <u>argv</u> strings.

       If  a  trace created with <b>Tcl_CreateTrace</b> is in effect, inline compilation of Tcl commands such as <b>if</b> and
       <b>while</b> is always disabled.  There is no notification when a trace created with <b>Tcl_CreateTrace</b> is deleted.
       There is no way to be notified when the trace created by <b>Tcl_CreateTrace</b> is deleted.  There is no way for
       the <u>proc</u> associated with a call to <b>Tcl_CreateTrace</b> to abort execution of <u>command</u>.

</pre><h4><b>REFERENCE</b> <b>COUNT</b> <b>MANAGEMENT</b></h4><pre>
       When the <u>proc</u> passed to <b>Tcl_CreateObjTrace</b> is called, the  values  in  its  <u>objv</u>  argument  will  have  a
       reference  count  of  at least 1, with that guaranteed reference being from the Tcl evaluation stack. You
       should not call <b>Tcl_DecrRefCount</b> on any of those values unless you call <b>Tcl_IncrRefCount</b> on them first.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/trace.3tcl.html">trace</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       command, create, delete, interpreter, trace

Tcl                                                                                        <u><a href="../man3tcl/Tcl_CreateTrace.3tcl.html">Tcl_CreateTrace</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>