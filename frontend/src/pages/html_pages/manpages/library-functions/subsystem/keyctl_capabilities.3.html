<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>keyctl_capabilities - Query subsystem capabilities</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libkeyutils-dev">libkeyutils-dev_1.6.3-6ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       keyctl_capabilities - Query subsystem capabilities

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;keyutils.h&gt;</b>

       <b>long</b> <b>keyctl_capabilities(unsigned</b> <b>char</b> <b>*</b><u>buffer</u><b>,</b> <b>size_t</b> <u>buflen</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>keyctl_capabilities</b>()  queries  the  keyrings  subsystem  in the kernel to ask about its capabilities and
       fills in the array in the buffer with bits that indicate the presence or absence of specific features  in
       the keyrings subsystem.

       The  function  returns  the amount of data the kernel has available, irrespective of the amount of buffer
       space available.  If the buffer is shorter than the data, a short copy will be made;  if  the  buffer  is
       larger than the data, the excess space will be cleared.

       If this operation is not available in the kernel, the keyutils library will emulate it as best it can and
       the capability bit that indicates if the kernel operation is available will be cleared.

       In <u>buffer[0]</u>, the following capabilities exist:

       <b>KEYCTL_CAPS0_CAPABILITIES</b>
              This  is  set  if the kernel supports this operation and cleared otherwise.  If it is cleared, the
              rest of the flags are emulated.

       <b>KEYCTL_CAPS0_PERSISTENT_KEYRINGS</b>
              This  is  set  if  the  kernel  supports  persistent  keyrings   and   cleared   otherwise.    See
              <b>keyctl_get_persistent</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_DIFFIE_HELLMAN</b>
              This  is  set  if  the  kernel  supports  Diffie-Hellman  calculation  and cleared otherwise.  See
              <b>keyctl_dh_compute</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_PUBLIC_KEY</b>
              This  is  set  if  the  kernel  supports  public-key  operations  and  cleared   otherwise.    See
              <b>keyctl_pkey_query</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_BIG_KEY</b>
              This is set if the kernel supports the big_key key type and cleared otherwise.

       <b>KEYCTL_CAPS0_INVALIDATE</b>
              This   is   set   if   the   kernel   supports   key  invalidation  and  cleared  otherwise.   See
              <b>keyctl_invalidate</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_RESTRICT_KEYRING</b>
              This is set  if  the  kernel  supports  restrictions  on  keyrings  and  cleared  otherwise.   See
              <b>keyctl_restrict_keyring</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_MOVE</b>
              This  is  set  if  the  kernel  supports  the  move  key  operation  and  cleared  otherwise.  See
              <b>keyctl_move</b>(<b>3</b>).

       In <u>buffer[1]</u>, the following capabilities exist:

       <b>KEYCTL_CAPS1_NS_KEYRING_NAME</b>
              This is set if the keyring names are segregated according to the user-namespace in which a keyring
              is created.

       <b>KEYCTL_CAPS1_NS_KEY_TAG</b>
              This is set if a key or keyring may get tagged with a namespace, thereby  allowing  multiple  keys
              with  the  same  type  and  description,  but different namespace tags, to coexist within the same
              keyring.  Tagging may be automatic depending on the key type.  Only network-namespace  tagging  is
              currently used.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On  success <b>keyctl_capabilities</b>() returns the size of the data it has available, irrespective of the size
       of the buffer.  On error, the value <b>-1</b> will be returned and <u>errno</u> will have been set  to  an  appropriate
       error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EFAULT</b> The buffer cannot be written to.

</pre><h4><b>LINKING</b></h4><pre>
       This  is  a  library  function  that  can  be  found  in <u>libkeyutils</u>.  When linking, <b>-lkeyutils</b> should be
       specified to the linker.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/keyctl.1.html">keyctl</a></b>(1), <b><a href="../man2/add_key.2.html">add_key</a></b>(2), <b><a href="../man2/keyctl.2.html">keyctl</a></b>(2), <b><a href="../man2/request_key.2.html">request_key</a></b>(2), <b><a href="../man3/keyctl.3.html">keyctl</a></b>(3), <b><a href="../man7/keyrings.7.html">keyrings</a></b>(7), <b><a href="../man7/keyutils.7.html">keyutils</a></b>(7)

Linux                                              30 May 2019                            <u><a href="../man3/KEYCTL_CAPABILITIES.3.html">KEYCTL_CAPABILITIES</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>