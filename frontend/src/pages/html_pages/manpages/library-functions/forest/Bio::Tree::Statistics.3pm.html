<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio::Tree::Statistics - Calculate certain statistics for a Tree</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libbio-perl-perl">libbio-perl-perl_1.7.8-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Bio::Tree::Statistics - Calculate certain statistics for a Tree

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Bio::Tree::Statistics;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This should be where Tree statistics are calculated.  It was previously where statistics from a
       Coalescent simulation.

       It now contains several methods for calculating Tree-Trait statistics.

</pre><h4><b>FEEDBACK</b></h4><pre>
   <b>Mailing</b> <b>Lists</b>
       User feedback is an integral part of the evolution of this and other Bioperl modules. Send your comments
       and suggestions preferably to the Bioperl mailing list.  Your participation is much appreciated.

         <a href="mailto:bioperl-l@bioperl.org">bioperl-l@bioperl.org</a>                  - General discussion
         <a href="http://bioperl.org/wiki/Mailing_lists">http://bioperl.org/wiki/Mailing_lists</a>  - About the mailing lists

   <b>Support</b>
       Please direct usage questions or support issues to the mailing list:

       <u><a href="mailto:bioperl-l@bioperl.org">bioperl-l@bioperl.org</a></u>

       rather than to the module maintainer directly. Many experienced and reponsive experts will be able look
       at the problem and quickly address it. Please include a thorough description of the problem with code and
       data examples if at all possible.

   <b>Reporting</b> <b>Bugs</b>
       Report bugs to the Bioperl bug tracking system to help us keep track of the bugs and their resolution.
       Bug reports can be submitted via the web:

         https://github.com/bioperl/bioperl-live/issues

</pre><h4><b>AUTHOR</b> <b>-</b> <b>Jason</b> <b>Stajich</b></h4><pre>
       Email jason AT bioperl.org

</pre><h4><b>CONTRIBUTORS</b></h4><pre>
       Heikki Lehvaslaiho, heikki at bioperl dot org

</pre><h4><b>APPENDIX</b></h4><pre>
       The rest of the documentation details each of the object methods.  Internal methods are usually preceded
       with a _

   <b>new</b>
        Title   : new
        Usage   : my $obj = Bio::Tree::Statistics-&gt;new();
        Function: Builds a new Bio::Tree::Statistics object
        Returns : Bio::Tree::Statistics
        Args    :

   <b>assess_bootstrap</b>
        Title   : assess_bootstrap
        Usage   : my $tree_with_bs = $stats-&gt;assess_bootstrap(\@bs_trees,$guide_tree);
        Function: Calculates the bootstrap for internal nodes based on the percentage
                  of times \@bs_trees agree with each internal node
        Returns : L&lt;Bio::Tree::TreeI&gt;
        Args    : Arrayref of L&lt;Bio::Tree::TreeI&gt;s
                  Guide tree, L&lt;Bio::Tree::TreeI&gt;s

   <b>transfer_bootstrap_expectation</b>
        Title   : transfer_bootstrap_expectation
        Usage   : my $tree_with_bs = $stats-&gt;transfer_bootstrap_expectation(\@bs_trees,$guide_tree);
        Function: Calculates the Transfer Bootstrap Expectation (TBE) for internal nodes based on
                  the methods outlined in Lemoine et al, Nature, 2018.
                  Currently experimental.
        Returns : L&lt;Bio::Tree::TreeI&gt;
        Args    : Arrayref of L&lt;Bio::Tree::TreeI&gt;s
                  Guide tree, L&lt;Bio::Tree::TreeI&gt;s

   <b>cherries</b>
         Example    : cherries($tree, $node);
         Description: Count number of paired leaf nodes
                      in a binary tree
         Returns    : integer
         Exceptions :
         Args       : 1. Bio::Tree::TreeI object
                      2. Bio::Tree::NodeI object within the tree, optional

       Commonly used statistics assume a binary tree, but this methods returns a value even for trees with
       polytomies.

   <b>Tree-Trait</b> <b>statistics</b>
       The following methods produce descriptors of trait distribution among leaf nodes within the trees. They
       require that a trait has been set for each leaf node. The tag methods of Bio::Tree::Node are used to
       store them as key/value pairs. In this way, one tree can store more than one trait.

       Trees have method <b>add_traits()</b> to set trait values from a file. See the <b>add_trait()</b> method in
       Bio::Tree::TreeFunctionsI.

   <b>fitch</b>
         Example    : fitch($tree, $key, $node);
         Description: Calculates Parsimony Score (PS) and internal trait
                      values using the Fitch 1971 parsimony algorithm for
                      the subtree a defined by the (internal) node.
                      Node defaults to the root.
         Returns    : true on success
         Exceptions : leaf nodes have to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. trait name string
                      3. Bio::Tree::NodeI object within the tree, optional

       Runs first fitch_up that calculates parsimony scores and then fitch_down that should resolve most of the
       trait/character state ambiguities.

       Fitch, W.M., 1971. Toward defining the course of evolution: minimal change for a specific tree topology.
       Syst. Zool. 20, 406-416.

       You can access calculated parsimony values using:

         $score = $node-&gt;-&gt;get_tag_values('ps_score');

       and the trait value with:

         $traitvalue = $node-&gt;-&gt;get_tag_values('ps_trait'); # only the first
         @traitvalues = $node-&gt;-&gt;get_tag_values('ps_trait');

       Note that there can be more that one trait value, especially for the root node.

   <b>ps</b>
         Example    : ps($tree, $key, $node);
         Description: Calculates Parsimony Score (PS) from Fitch 1971
                      parsimony algorithm for the subtree as defined
                      by the (internal) node.
                      Node defaults to the root.
         Returns    : integer, 1 &lt; PS &lt; n, where n is number of branches
         Exceptions : leaf nodes have to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. trait name string
                      3. Bio::Tree::NodeI object within the tree, optional

       This is the first half of the Fitch algorithm that is enough for calculating the resolved parsimony
       values. The trait/chararacter states are commonly left in ambiguous state. To resolve them, run
       fitch_down.

   <b>fitch_up</b>
         Example    : fitch_up($tree, $key, $node);
         Description: Calculates Parsimony Score (PS) from the Fitch 1971
                      parsimony algorithm for the subtree as defined
                      by the (internal) node.
                      Node defaults to the root.
         Returns    : integer, 1&lt; PS &lt; n, where n is number of branches
         Exceptions : leaf nodes have to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. trait name string
                      3. Bio::Tree::NodeI object within the tree, optional

       This is a more generic name for ps and indicates that it performs the first bottom-up tree traversal that
       calculates the parsimony score but usually leaves trait/character states ambiguous. If you are interested
       in internal trait states, running fitch_down should resolve most of the ambiguities.

   <b>fitch_down</b>
         Example    : fitch_down($tree, $node);
         Description: Runs the second pass from Fitch 1971
                      parsimony algorithm to resolve ambiguous
                      trait states left by first pass.
                      by the (internal) node.
                      Node defaults to the root.
         Returns    : true
         Exceptions : dies unless the trait is defined in all nodes
         Args       : 1. Bio::Tree::TreeI object
                      2. Bio::Tree::NodeI object within the tree, optional

       Before running this method you should have ran fitch_up (alias to ps ). Note that it is not guaranteed
       that all states are completely resolved.

   <b>persistence</b>
         Example    : persistence($tree, $node);
         Description: Calculates the persistence
                      for node in the subtree defined by the (internal)
                      node.  Node defaults to the root.
         Returns    : int, number of generations trait value has to remain same
         Exceptions : all the  nodes need to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. Bio::Tree::NodeI object within the tree, optional

       Persistence measures the stability that the trait value has in a tree. It expresses the number of
       generations the trait value remains the same. All the decendants of the root in the same generation have
       to share the same value.

       Depends on Fitch's parsimony score (PS).

   <b>count_subclusters</b>
         Example    : count_clusters($tree, $node);
         Description: Calculates the number of sub-clusters
                      in the subtree defined by the (internal)
                      node.  Node defaults to the root.
         Returns    : int, count
         Exceptions : all the  nodes need to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. Bio::Tree::NodeI object within the tree, optional

       Depends on Fitch's parsimony score (PS).

   <b>count_leaves</b>
         Example    : count_leaves($tree, $node);
         Description: Calculates the number of leaves with same trait
                      value as root in the subtree defined by the (internal)
                      node.  Requires an unbroken line of identical trait values.
                      Node defaults to the root.
         Returns    : int, number of leaves with this trait value
         Exceptions : all the  nodes need to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. Bio::Tree::NodeI object within the tree, optional

       Depends on Fitch's parsimony score (PS).

   <b>phylotype_length</b>
         Example    : phylotype_length($tree, $node);
         Description: Sums up the branch lengths within phylotype
                      excluding the subclusters where the trait values
                      are different
         Returns    : float, length
         Exceptions : all the  nodes need to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. Bio::Tree::NodeI object within the tree, optional

       Depends on Fitch's parsimony score (PS).

   <b>sum_of_leaf_distances</b>
         Example    : sum_of_leaf_distances($tree, $node);
         Description: Sums up the branch lengths from root to leaf
                      excluding the subclusters where the trait values
                      are different
         Returns    : float, length
         Exceptions : all the  nodes need to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. Bio::Tree::NodeI object within the tree, optional

       Depends on Fitch's parsimony score (PS).

   <b>genetic_diversity</b>
         Example    : genetic_diversity($tree, $node);
         Description: Diversity is the sum of root to leaf distances
                      within the phylotype normalised by number of leaf
                      nodes
         Returns    : float, value of genetic diversity
         Exceptions : all the  nodes need to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. Bio::Tree::NodeI object within the tree, optional

       Depends on Fitch's parsimony score (PS).

   <b>statratio</b>
         Example    : statratio($tree, $node);
         Description: Ratio of the stem length and the genetic diversity of the
                      phylotype L&lt;genetic_diversity&gt;
         Returns    : float, separation score
         Exceptions : all the  nodes need to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. Bio::Tree::NodeI object within the tree, optional

       Statratio gives a measure of separation and variability within the phylotype.  Larger values identify
       more rapidly evolving and recent phylotypes.

       Depends on Fitch's parsimony score (PS).

   <b>ai</b>
         Example    : ai($tree, $key, $node);
         Description: Calculates the Association Index (AI) of Whang et
                      al. 2001 for the subtree defined by the (internal)
                      node.  Node defaults to the root.
         Returns    : real
         Exceptions : leaf nodes have to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. trait name string
                      3. Bio::Tree::NodeI object within the tree, optional

         Association index (AI) gives a more fine grained results than PS since
         the result is a real number. ~0 E&lt;lt&gt;= AI.

         Wang, T.H., Donaldson, Y.K., Brettle, R.P., Bell, J.E., Simmonds, P.,
         2001.  Identification of shared populations of human immunodeficiency
         Virus Type 1 infecting microglia and tissue macrophages outside the
         central nervous system. J. Virol. 75 (23), 11686-11699.

   <b>mc</b>
         Example    : mc($tree, $key, $node);
         Description: Calculates the Monophyletic Clade (MC) size statistics
                      for the subtree a defined by the (internal) node.
                      Node defaults to the root;
         Returns    : hashref with trait values as keys
         Exceptions : leaf nodes have to have the trait defined
         Args       : 1. Bio::Tree::TreeI object
                      2. trait name string
                      3. Bio::Tree::NodeI object within the tree, optional

         Monophyletic Clade (MC) size statistics by Salemi at al 2005. It is
         calculated for each trait value. 1 E&lt;lt&gt;= MC E&lt;lt&gt;= nx, where nx is the
         number of tips with value x:

          pick the internal node with maximim value for
             number of of tips with only trait x

         MC was defined by Parker et al 2008.

         Salemi, M., Lamers, S.L., Yu, S., de Oliveira, T., Fitch, W.M., McGrath, M.S.,
          2005. Phylodynamic analysis of Human Immunodeficiency Virus Type 1 in
          distinct brain compartments provides a model for the neuropathogenesis of
          AIDS. J. Virol. 79 (17), 11343-11352.

         Parker, J., Rambaut A., Pybus O., 2008. Correlating viral phenotypes
          with phylogeny: Accounting for phylogenetic uncertainty Infection,
          Genetics and Evolution 8 (2008), 239-246.

perl v5.32.1                                       2021-08-15                         <u>Bio::Tree::<a href="../man3pm/Statistics.3pm.html">Statistics</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>