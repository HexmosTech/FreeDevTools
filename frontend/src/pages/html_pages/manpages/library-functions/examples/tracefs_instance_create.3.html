<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tracefs_instance_create, tracefs_instance_destroy, tracefs_instance_alloc, tracefs_instance_free,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtracefs-doc">libtracefs-doc_1.8.1-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tracefs_instance_create, tracefs_instance_destroy, tracefs_instance_alloc, tracefs_instance_free,
       tracefs_instance_is_new, tracefs_instances, tracefs_instance_clear, tracefs_instance_reset - Manage trace
       instances.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tracefs.h&gt;</b>

       struct tracefs_instance *<b>tracefs_instance_create</b>(const char *<u>name</u>);
       int <b>tracefs_instance_destroy</b>(struct tracefs_instance *<u>instance</u>);
       struct tracefs_instance *<b>tracefs_instance_alloc</b>(const char *<u>tracing_dir</u>, const char *<u>name</u>);
       void <b>tracefs_instance_free</b>(struct tracefs_instance *<u>instance</u>);
       bool <b>tracefs_instance_is_new</b>(struct tracefs_instance *<u>instance</u>);
       char **<b>tracefs_instances</b>(const char *<u>regex</u>);
       void <b>tracefs_instance_clear</b>(struct tracefs_instance *<u>instance</u>);
       void <b>tracefs_instance_reset</b>(struct tracefs_instance *<u>instance</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This set of functions can be used to manage trace instances. A trace instance is a sub buffer used by the
       Linux tracing system. Given a unique name, the events enabled in an instance do not affect the main
       tracing system, nor other instances, as events enabled in the main tracing system or other instances do
       not affect the given instance.

       The <b>tracefs_instance_create()</b> function allocates and initializes a new tracefs_instance structure and
       returns it. If the instance with <u>name</u> does not yet exist in the system, it will be created. The <u>name</u>
       could be NULL, then the new tracefs_instance structure is initialized for the top instance. Note that the
       top instance cannot be created in the system, if it does not exist.

       The <b>tracefs_instance_destroy()</b> removes the instance from the system, but does not free the structure.
       <b>tracefs_instance_free()</b> must still be called on <u>instance</u>.

       The tracefs_instance_alloc()* function allocates a new tracefs_instance structure for existing trace
       instance. If the instance does not exist in the system, the function fails. The <u>tracing_dir</u> parameter
       points to the system trace directory. It can be NULL, then default system trace directory is used. This
       parameter is useful to allocate instances to trace directories, copied from another machine. The <u>name</u> is
       the name of the instance, or NULL for the top instance in the given <u>tracing_dir</u>.

       The <b>tracefs_instance_free()</b> function frees the tracefs_instance structure, without removing the trace
       instance from the system.

       The <b>tracefs_instance_is_new()</b> function checks if the given <u>instance</u> is newly created by
       <b>tracefs_instance_create()</b>, or it has been in the system before that.

       The <b>tracefs_instances</b>() function returns a list of instances that exist in the system that match the
       regular expression <u>regex</u>. If <u>regex</u> is NULL, then it will match all instances that exist. The returned
       list must be freed with <b><a href="../man3/tracefs_list_free.3.html">tracefs_list_free</a></b>(3). Note, if no instances are found an empty list is returned
       and that too needs to be free with <b><a href="../man3/tracefs_list_free.3.html">tracefs_list_free</a></b>(3).

       The <b>tracefs_instance_clear()</b> function clears the ring buffer of the given <u>instance</u> or the top level ring
       buffer if <u>instance</u> is NULL.

       The <b>tracefs_instance_reset</b>() function resets the given <u>instance</u> to its default state.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>tracefs_instance_create()</b> and <b>tracefs_instance_alloc()</b> functions return a pointer to a newly
       allocated tracefs_instance structure. It must be freed with <b>tracefs_instance_free()</b>.

       The <b>tracefs_instance_destroy()</b> function returns 0 if it succeeds to remove the instance, otherwise it
       returns -1 if the instance does not exist or it fails to remove it.

       The <b>tracefs_instance_is_new()</b> function returns true if the <b>tracefs_instance_create()</b> that allocated
       <u>instance</u> also created the trace instance in the system, or false if the trace instance already existed in
       the system when <u>instance</u> was allocated by <b>tracefs_instance_create()</b> or <b>tracefs_instance_alloc()</b>.

       The <b>tracefs_instances()</b> returns a list of instance names that exist on the system. The list must be freed
       with <b><a href="../man3/tracefs_list_free.3.html">tracefs_list_free</a></b>(3). An empty list is returned if no instance exists that matches <u>regex</u>, and this
       needs to be freed with <b><a href="../man3/tracefs_list_free.3.html">tracefs_list_free</a></b>(3) as well. NULL is returned on error.

       The <b>tracefs_instance_clear()</b> returns 0 if it successfully cleared the ring buffer, or -1 on error.

</pre><h4><b>EXAMPLE</b></h4><pre>
           #include &lt;tracefs.h&gt;

           struct tracefs_instance *inst = tracefs_instance_create("foo");
                   if (!inst) {
                           /* Error creating a new trace instance */
                           ...
                   }

                   ...

                   if (tracefs_instance_is_new(inst))
                           tracefs_instance_destroy(inst);
                   tracefs_instance_free(inst);
           ...

           struct tracefs_instance *inst = tracefs_instance_alloc(NULL, "bar");
                   if (!inst) {
                           /* Error allocating 'bar' trace instance */
                           ...
                   }

                   ...
                   tracefs_instance_reset(inst);
                   tracefs_instance_free(inst);

</pre><h4><b>FILES</b></h4><pre>
           <b>tracefs.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>-ltracefs</b>
                   Linker switch to add when building a program that uses the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libtracefs.3.html">libtracefs</a></b>(3), <b><a href="../man3/libtraceevent.3.html">libtraceevent</a></b>(3), <b><a href="../man1/trace-cmd.1.html">trace-cmd</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
           <b>Steven</b> <b>Rostedt</b> &lt;<b><a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a></b>[1]&gt;
           <b>Tzvetomir</b> <b>Stoyanov</b> &lt;<b><a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a></b>[2]&gt;

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<b><a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a></b>[3]&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       libtracefs is Free Software licensed under the GNU LGPL 2.1

</pre><h4><b>RESOURCES</b></h4><pre>
       <b>https://git.kernel.org/pub/scm/libs/libtrace/libtracefs.git/</b>

</pre><h4><b>COPYING</b></h4><pre>
       Copyright (C) 2020 VMware, Inc. Free use of this software is granted under the terms of the GNU Public
       License (GPL).

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a>
           <a href="mailto:rostedt@goodmis.org">mailto:rostedt@goodmis.org</a>

        2. <a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a>
           <a href="mailto:tz.stoyanov@gmail.com">mailto:tz.stoyanov@gmail.com</a>

        3. <a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a>
           <a href="mailto:linux-trace-devel@vger.kernel.org">mailto:linux-trace-devel@vger.kernel.org</a>

libtracefs 1.8.1                                   06/05/2025                                      <u><a href="../man3/LIBTRACEFS.3.html">LIBTRACEFS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>