<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tracefs_trace_pipe_stream, tracefs_trace_pipe_print, tracefs_trace_pipe_stop - redirect the stream of</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtracefs-doc">libtracefs-doc_1.8.1-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tracefs_trace_pipe_stream, tracefs_trace_pipe_print, tracefs_trace_pipe_stop - redirect the stream of
       trace data to an output or stdout.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tracefs.h&gt;</b>

       ssize_t <b>tracefs_trace_pipe_stream</b>(int <u>fd</u>, struct tracefs_instance *<u>instance</u>, int <u>flags</u>);
       ssize_t <b>tracefs_trace_pipe_print</b>(struct tracefs_instance *<u>instance</u>, int <u>flags</u>);
       void <b>tracefs_trace_pipe_stop</b>(struct tracefs_instance *<u>instance</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       If NULL is passed as <u>instance</u>, the top trace instance is used.

       The reading of the trace_pipe file can be stopped by calling <b>tracefs_trace_pipe_stop()</b> which could be
       placed in a signal handler in case the application wants to stop the reading, for example, with the user
       pressing Ctrl-C.

       The <b>tracefs_trace_pipe_stream()</b> function redirects the stream of trace data to an output file. The
       "splice" system call is used to moves the data without copying between kernel address space and user
       address space. The <u>fd</u> is the file descriptor of the output file and <u>flags</u> is a bit mask of flags to be
       passed to the open system call of the trace_pipe file (see <b><a href="../man2/open.2.html">open</a>(2)</b>). If flags contain O_NONBLOCK, then
       that is also passed to the splice calls that may read the file to the output stream file descriptor.
       Note, O_RDONLY is orâ€™d to the <u>flags</u> and only O_NONBLOCK is useful for this parameter.

       The <b>tracefs_trace_pipe_print()</b> function is similar to <b>tracefs_trace_pipe_stream()</b>, but the stream of
       trace data is redirected to stdout.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>tracefs_trace_pipe_stream()</b>, and <b>tracefs_trace_pipe_print()</b> functions return the number of bytes
       transfered if the operation is successful, or -1 in case of an error.

</pre><h4><b>EXAMPLE</b></h4><pre>
           #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
           #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
           #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;
           #include &lt;<a href="file:/usr/include/signal.h">signal.h</a>&gt;
           #include &lt;<a href="file:/usr/include/fcntl.h">fcntl.h</a>&gt;

           #include &lt;tracefs.h&gt;

           void stop(int sig)
           {
                   tracefs_trace_pipe_stop(NULL);
           }

           int main(int argc, char **argv)
           {
                   mode_t mode = S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH;
                   const char *filename;
                   int fd;
                   int ret;

                   if (argc &lt; 2) {
                           fprintf(stderr, "usage: %s output_file\n", argv[0]);
                           exit(-1);
                   }
                   filename = argv[1];
                   fd = creat(filename, mode);
                   if (fd &lt; 0) {
                           perror(filename);
                           exit(-1);
                   }
                   signal(SIGINT, stop);
                   ret = tracefs_trace_pipe_stream(fd, NULL, SPLICE_F_NONBLOCK);
                   close(fd);

                   return ret;
           }

</pre><h4><b>FILES</b></h4><pre>
           <b>tracefs.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>-ltracefs</b>
                   Linker switch to add when building a program that uses the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libtracefs.3.html">libtracefs</a></b>(3), <b><a href="../man3/libtraceevent.3.html">libtraceevent</a></b>(3), <b><a href="../man1/trace-cmd.1.html">trace-cmd</a></b>(1), Documentation/trace/ftrace.rst from the Linux kernel tree

</pre><h4><b>AUTHOR</b></h4><pre>
           <b>Steven</b> <b>Rostedt</b> &lt;<b><a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a></b>[1]&gt;
           <b>Tzvetomir</b> <b>Stoyanov</b> &lt;<b><a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a></b>[2]&gt;

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<b><a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a></b>[3]&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       libtracefs is Free Software licensed under the GNU LGPL 2.1

</pre><h4><b>RESOURCES</b></h4><pre>
       <b>https://git.kernel.org/pub/scm/libs/libtrace/libtracefs.git/</b>

</pre><h4><b>COPYING</b></h4><pre>
       Copyright (C) 2021 VMware, Inc. Free use of this software is granted under the terms of the GNU Public
       License (GPL).

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a>
           <a href="mailto:rostedt@goodmis.org">mailto:rostedt@goodmis.org</a>

        2. <a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a>
           <a href="mailto:tz.stoyanov@gmail.com">mailto:tz.stoyanov@gmail.com</a>

        3. <a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a>
           <a href="mailto:linux-trace-devel@vger.kernel.org">mailto:linux-trace-devel@vger.kernel.org</a>

libtracefs 1.8.1                                   06/05/2025                                      <u><a href="../man3/LIBTRACEFS.3.html">LIBTRACEFS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>