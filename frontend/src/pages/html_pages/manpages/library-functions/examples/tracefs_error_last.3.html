<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tracefs_error_last, tracefs_error_all, tracefs_error_clear - functions to read and clear the tracefs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtracefs-doc">libtracefs-doc_1.8.1-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tracefs_error_last, tracefs_error_all, tracefs_error_clear - functions to read and clear the tracefs
       error log.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tracefs.h&gt;</b>

       char *<b>tracefs_error_last</b>(struct tracefs_instance *<u>instance</u>);
       char *<b>tracefs_error_all</b>(struct tracefs_instance *<u>instance</u>);
       int <b>tracefs_error_clear</b>(struct tracefs_instance *<u>instance</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>tracefs_error_last</b>() returns the last error message in the tracefs error log. Several actions that
       require proper syntax written into the tracefs file system may produce error messages in the error log.
       This function will show the most recent error in the error log.

       The <b>tracefs_error_all</b>() returns all messages saved in the error log. Note, this may not be all messages
       that were ever produced, as the kernel only keeps a limited amount of messages, and older ones may be
       discarded by the kernel.

       The <b>tracefs_error_clear</b>() will clear the error log.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Both <b>tracefs_error_last</b>() and <b>tracefs_error_all</b>() will return an allocated string an error exists in the
       log, otherwise NULL is returned. If an error occurs, errno will be set, otherwise if there is no error
       messages to display then errno is not touched.

       <b>tracefs_error_clear</b>() returns 0 on success or -1 on error.

</pre><h4><b>EXAMPLE</b></h4><pre>
           #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
           #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;
           #include &lt;<a href="file:/usr/include/errno.h">errno.h</a>&gt;

           #include &lt;tracefs.h&gt;

           int main (int argc, char **argv, char **env)
           {
                   struct tracefs_dynevent *kevent;
                   char *system = NULL;
                   char *kprobe;
                   char *format;
                   char *addr;
                   int arg = 1;
                   int ret;

                   if (argc &lt; 4) {
                           printf("usage: %s [system] kprobe addr fmt\n", argv[0]);
                           exit(-1);
                   }

                   if (argc &gt; 5)
                           system = argv[arg++];

                   kprobe = argv[arg++];
                   addr = argv[arg++];
                   format = argv[arg++];

                   tracefs_error_clear(NULL);
                   kevent = tracefs_dynevent_get(TRACEFS_DYNEVENT_KPROBE, system, kprobe);
                   if (kevent) {
                           tracefs_dynevent_destroy(kevent, true);
                           tracefs_dynevent_free(kevent);
                   }

                   ret = tracefs_kprobe_raw(system, kprobe, addr, format);
                   if (ret &lt; 0) {
                           char *err;

                           perror("Failed creating kprobe");
                           errno = 0;
                           err = tracefs_error_last(NULL);
                           if (err)
                                   fprintf(stderr, "%s\n", err);
                           else if (errno)
                                   perror("Failed reading error log");
                           free(err);
                   }

                   exit(ret);
           }

</pre><h4><b>FILES</b></h4><pre>
           <b>tracefs.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>-ltracefs</b>
                   Linker switch to add when building a program that uses the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libtracefs.3.html">libtracefs</a></b>(3), <b><a href="../man3/libtraceevent.3.html">libtraceevent</a></b>(3), <b><a href="../man1/trace-cmd.1.html">trace-cmd</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
           <b>Steven</b> <b>Rostedt</b> &lt;<b><a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a></b>[1]&gt;
           <b>Tzvetomir</b> <b>Stoyanov</b> &lt;<b><a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a></b>[2]&gt;

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<b><a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a></b>[3]&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       libtracefs is Free Software licensed under the GNU LGPL 2.1

</pre><h4><b>RESOURCES</b></h4><pre>
       <b>https://git.kernel.org/pub/scm/libs/libtrace/libtracefs.git/</b>

</pre><h4><b>COPYING</b></h4><pre>
       Copyright (C) 2020 VMware, Inc. Free use of this software is granted under the terms of the GNU Public
       License (GPL).

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a>
           <a href="mailto:rostedt@goodmis.org">mailto:rostedt@goodmis.org</a>

        2. <a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a>
           <a href="mailto:tz.stoyanov@gmail.com">mailto:tz.stoyanov@gmail.com</a>

        3. <a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a>
           <a href="mailto:linux-trace-devel@vger.kernel.org">mailto:linux-trace-devel@vger.kernel.org</a>

libtracefs 1.8.1                                   06/05/2025                                      <u><a href="../man3/LIBTRACEFS.3.html">LIBTRACEFS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>