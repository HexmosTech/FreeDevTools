<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BN_generate_prime_ex2, BN_generate_prime_ex, BN_is_prime_ex, BN_check_prime, BN_is_prime_fasttest_ex,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       BN_generate_prime_ex2, BN_generate_prime_ex, BN_is_prime_ex, BN_check_prime, BN_is_prime_fasttest_ex,
       BN_GENCB_call, BN_GENCB_new, BN_GENCB_free, BN_GENCB_set_old, BN_GENCB_set, BN_GENCB_get_arg,
       BN_generate_prime, BN_is_prime, BN_is_prime_fasttest - generate primes and test for primality

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/bn.h&gt;

        int BN_generate_prime_ex2(BIGNUM *ret, int bits, int safe,
                                  const BIGNUM *add, const BIGNUM *rem, BN_GENCB *cb,
                                  BN_CTX *ctx);

        int BN_generate_prime_ex(BIGNUM *ret, int bits, int safe, const BIGNUM *add,
                                 const BIGNUM *rem, BN_GENCB *cb);

        int BN_check_prime(const BIGNUM *p, BN_CTX *ctx, BN_GENCB *cb);

        int BN_GENCB_call(BN_GENCB *cb, int a, int b);

        BN_GENCB *BN_GENCB_new(void);

        void BN_GENCB_free(BN_GENCB *cb);

        void BN_GENCB_set_old(BN_GENCB *gencb,
                              void (*callback)(int, int, void *), void *cb_arg);

        void BN_GENCB_set(BN_GENCB *gencb,
                          int (*callback)(int, int, BN_GENCB *), void *cb_arg);

        void *BN_GENCB_get_arg(BN_GENCB *cb);

       The following functions have been deprecated since OpenSSL 0.9.8, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        BIGNUM *BN_generate_prime(BIGNUM *ret, int num, int safe, BIGNUM *add,
                                  BIGNUM *rem, void (*callback)(int, int, void *),
                                  void *cb_arg);

        int BN_is_prime(const BIGNUM *p, int nchecks,
                        void (*callback)(int, int, void *), BN_CTX *ctx, void *cb_arg);

        int BN_is_prime_fasttest(const BIGNUM *p, int nchecks,
                                 void (*callback)(int, int, void *), BN_CTX *ctx,
                                 void *cb_arg, int do_trial_division);

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        int BN_is_prime_ex(const BIGNUM *p, int nchecks, BN_CTX *ctx, BN_GENCB *cb);

        int BN_is_prime_fasttest_ex(const BIGNUM *p, int nchecks, BN_CTX *ctx,
                                    int do_trial_division, BN_GENCB *cb);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>BN_generate_prime_ex2()</b> generates a pseudo-random prime number of at least bit length <b>bits</b> using the
       BN_CTX provided in <b>ctx</b>. The value of <b>ctx</b> must not be NULL.

       The returned number is probably prime with a negligible error.  The maximum error rate is 2^-128.  It's
       2^-287 for a 512 bit prime, 2^-435 for a 1024 bit prime, 2^-648 for a 2048 bit prime, and lower than
       2^-882 for primes larger than 2048 bit.

       If <b>add</b> is <b>NULL</b> the returned prime number will have exact bit length <b>bits</b> with the top most two bits set.

       If <b>ret</b> is not <b>NULL</b>, it will be used to store the number.

       If <b>cb</b> is not <b>NULL</b>, it is used as follows:

       • <b>BN_GENCB_call(cb,</b> <b>0,</b> <b>i)</b> is called after generating the i-th potential prime number.

       • While the number is being tested for primality, <b>BN_GENCB_call(cb,</b> <b>1,</b> <b>j)</b> is called as described below.

       • When a prime has been found, <b>BN_GENCB_call(cb,</b> <b>2,</b> <b>i)</b> is called.

       • The  callers  of <b>BN_generate_prime_ex()</b> may call <b>BN_GENCB_call(cb,</b> <b>i,</b> <b>j)</b> with other values as described
         in their respective man pages; see "SEE ALSO".

       The prime may have to fulfill additional requirements for use in Diffie-Hellman key exchange:

       If <b>add</b> is not <b>NULL</b>, the prime will fulfill the condition p % <b>add</b> == <b>rem</b> (p % <b>add</b> == 1 if <b>rem</b> == <b>NULL</b>)  in
       order to suit a given generator.

       If <b>safe</b> is true, it will be a safe prime (i.e. a prime p so that (p-1)/2 is also prime). If <b>safe</b> is true,
       and <b>rem</b> == <b>NULL</b> the condition will be p % <b>add</b> == 3.  It is recommended that <b>add</b> is a multiple of 4.

       The random generator must be seeded prior to calling <b>BN_generate_prime_ex()</b>.  If the automatic seeding or
       reseeding  of  the  OpenSSL  CSPRNG fails due to external circumstances (see <b><a href="../man7/RAND.7.html">RAND</a></b>(7)), the operation will
       fail.  The random number generator configured for the OSSL_LIB_CTX associated with <b>ctx</b> will be used.

       <b>BN_generate_prime_ex()</b> is the same as <b>BN_generate_prime_ex2()</b> except that no <b>ctx</b> parameter is passed.  In
       this case the random number generator associated with the default OSSL_LIB_CTX will be used.

       <b>BN_check_prime()</b>, <b>BN_is_prime_ex()</b>, <b>BN_is_prime_fasttest_ex()</b>, <b>BN_is_prime()</b>  and  <b>BN_is_prime_fasttest()</b>
       test  if the number <b>p</b> is prime.  The functions tests until one of the tests shows that <b>p</b> is composite, or
       all the tests passed.  If <b>p</b> passes all these tests, it is considered a probable prime.

       The test performed on <b>p</b> are trial division by a number of small primes and rounds of the of  the  Miller-
       Rabin probabilistic primality test.

       The  functions  do  at  least  64 rounds of the Miller-Rabin test giving a maximum false positive rate of
       2^-128.  If the size of <b>p</b> is more than 2048 bits, they do at least 128  rounds  giving  a  maximum  false
       positive rate of 2^-256.

       If  <b>nchecks</b> is larger than the minimum above (64 or 128), <b>nchecks</b> rounds of the Miller-Rabin test will be
       done.

       If <b>do_trial_division</b> set to <b>0</b>, the trial division will be skipped.   <b>BN_is_prime_ex()</b>  and  <b>BN_is_prime()</b>
       always skip the trial division.

       <b>BN_is_prime_ex()</b>, <b>BN_is_prime_fasttest_ex()</b>, <b>BN_is_prime()</b> and <b>BN_is_prime_fasttest()</b> are deprecated.

       <b>BN_is_prime_fasttest()</b>  and <b>BN_is_prime()</b> behave just like <b>BN_is_prime_fasttest_ex()</b> and <b>BN_is_prime_ex()</b>
       respectively, but with the old style call back.

       <b>ctx</b> is a preallocated <b>BN_CTX</b> (to save the overhead of allocating and freeing the structure in a loop), or
       <b>NULL</b>.

       If the trial division is done, and no divisors are found and <b>cb</b> is not <b>NULL</b>, <b>BN_GENCB_call(cb,</b> <b>1,</b> <b>-1)</b>  is
       called.

       After  each  round of the Miller-Rabin probabilistic primality test, if <b>cb</b> is not <b>NULL</b>, <b>BN_GENCB_call(cb,</b>
       <b>1,</b> <b>j)</b> is called with <b>j</b> the iteration (j = 0, 1, ...).

       <b>BN_GENCB_call()</b> calls the callback function held in the <b>BN_GENCB</b> structure and passes the ints <b>a</b> and <b>b</b> as
       arguments. There are two types of <b>BN_GENCB</b> structure that are supported: "new" style and "old" style. New
       programs should prefer the "new" style, whilst the "old" style is provided  for  backwards  compatibility
       purposes.

       A  <b>BN_GENCB</b>  structure  should  be  created through a call to <b>BN_GENCB_new()</b>, and freed through a call to
       <b>BN_GENCB_free()</b>. If the argument is NULL, nothing is done.

       For "new" style callbacks a BN_GENCB structure should be initialised with a call to <b>BN_GENCB_set()</b>, where
       <b>gencb</b> is a <b>BN_GENCB</b> <b>*</b>, <b>callback</b> is of type <b>int</b> <b>(*callback)(int,</b> <b>int,</b> <b>BN_GENCB</b> <b>*)</b> and <b>cb_arg</b> is a <b>void</b>  <b>*</b>.
       "Old"  style  callbacks  are  the  same except they are initialised with a call to <b>BN_GENCB_set_old()</b> and
       <b>callback</b> is of type <b>void</b> <b>(*callback)(int,</b> <b>int,</b> <b>void</b> <b>*)</b>.

       A callback is invoked through a call to <b>BN_GENCB_call</b>. This will check the type of the callback and  will
       invoke <b>callback(a,</b> <b>b,</b> <b>gencb)</b> for new style callbacks or <b>callback(a,</b> <b>b,</b> <b>cb_arg)</b> for old style.

       It  is  possible  to  obtain  the  argument  associated  with  a  BN_GENCB  structure  (set via a call to
       BN_GENCB_set or BN_GENCB_set_old) using BN_GENCB_get_arg.

       <b>BN_generate_prime()</b> (deprecated) works in the same way as <b>BN_generate_prime_ex()</b> but expects an old-style
       callback function directly in the <b>callback</b> parameter, and an argument  to  pass  to  it  in  the  <b>cb_arg</b>.
       <b>BN_is_prime()</b>   and   <b>BN_is_prime_fasttest()</b>   can   similarly   be   compared  to  <b>BN_is_prime_ex()</b>  and
       <b>BN_is_prime_fasttest_ex()</b>, respectively.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>BN_generate_prime_ex()</b> return 1 on success or 0 on error.

       <b>BN_is_prime_ex()</b>, <b>BN_is_prime_fasttest_ex()</b>,  <b>BN_is_prime()</b>,  <b>BN_is_prime_fasttest()</b>  and  BN_check_prime
       return  0  if  the  number  is  composite,  1  if  it  is  prime  with  an error probability of less than
       0.25^<b>nchecks</b>, and -1 on error.

       <b>BN_generate_prime()</b> returns the prime number on success, <b>NULL</b> otherwise.

       BN_GENCB_new returns a pointer to a BN_GENCB structure on success, or <b>NULL</b> otherwise.

       BN_GENCB_get_arg returns the argument previously associated with a BN_GENCB structure.

       Callback functions should return 1 on success or 0 on error.

       The error codes can be obtained by <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3).

</pre><h4><b>REMOVED</b> <b>FUNCTIONALITY</b></h4><pre>
       As of OpenSSL 1.1.0 it is no longer possible to create a BN_GENCB structure directly, as in:

        BN_GENCB callback;

       Instead applications should create a BN_GENCB structure using BN_GENCB_new:

        BN_GENCB *callback;
        callback = BN_GENCB_new();
        if (!callback)
            /* error */
        ...
        BN_GENCB_free(callback);

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/DH_generate_parameters.3.html">DH_generate_parameters</a></b>(3),     <b><a href="../man3/DSA_generate_parameters.3.html">DSA_generate_parameters</a></b>(3),     <b><a href="../man3/RSA_generate_key.3.html">RSA_generate_key</a></b>(3),     <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3),
       <b><a href="../man3/RAND_bytes.3.html">RAND_bytes</a></b>(3), <b><a href="../man7/RAND.7.html">RAND</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>BN_is_prime_ex()</b> and <b>BN_is_prime_fasttest_ex()</b> functions were deprecated in OpenSSL 3.0.

       The <b>BN_GENCB_new()</b>, <b>BN_GENCB_free()</b>, and <b>BN_GENCB_get_arg()</b> functions were added in OpenSSL 1.1.0.

       <b>BN_check_prime()</b> was added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                            <u><a href="../man3SSL/BN_GENERATE_PRIME.3SSL.html">BN_GENERATE_PRIME</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>