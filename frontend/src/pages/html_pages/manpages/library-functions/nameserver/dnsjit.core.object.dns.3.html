<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dnsjit.core.object.dns - Container of a DNS message</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/dnsjit">dnsjit_1.5.0-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dnsjit.core.object.dns - Container of a DNS message

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Parse</b> <b>DNS</b> <b>header</b> <b>and</b> <b>check</b> <b>if</b> <b>query</b> <b>or</b> <b>response</b>
         local dns = require("dnsjit.core.object.dns").new(payload)
         if dns:parse_header() == 0 then
           if dns.qr == 0 then
             print(dns.id, dns.opcode_tostring(dns.opcode))
           else
             print(dns.id, dns.rcode_tostring(dns.rcode))
           end
         end

   <b>Print</b> <b>a</b> <b>DNS</b> <b>payload</b>
         local dns = require("dnsjit.core.object.dns").new(payload)
         dns:print()

   <b>Parse</b> <b>a</b> <b>DNS</b> <b>payload</b>
         local dns = require("dnsjit.core.object.dns").new(payload)
         local qs, q_labels, rrs, rr_labels = dns:parse()
         if qs and q_labels then
           ...
           if rrs and rr_labels then
             ...
           end
         end

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The object that describes a DNS message.

   <b>Attributes</b>
       includes_dnslen
              If non-zero then this indicates that the DNS length is included in the payload (for example if the
              transport is TCP) and will affect parsing of it.

       have_dnslen
              Set if the dnslen was included in the payload and could be read.

       have_id
              Set if there is a DNS ID.

       have_qr
              Set if there is a QR flag.

       have_opcode
              Set if there is an OPCODE.

       have_aa
              Set if there is a AA flag.

       have_tc
              Set if there is a TC flag.

       have_rd
              Set if there is a RD flag.

       have_ra
              Set if there is a RA flag.

       have_z Set if there is a Z flag.

       have_ad
              Set if there is a AD flag.

       have_cd
              Set if there is a CD flag.

       have_rcode
              Set if there is a RCODE.

       have_qdcount
              Set if there is an QDCOUNT.

       have_ancount
              Set if there is an ANCOUNT.

       have_nscount
              Set if there is a NSCOUNT.

       have_arcount
              Set if there is an ARCOUNT.

       dnslen The DNS length found in the payload.

       id     The DNS ID.

       qr     The QR flag.

       opcode The OPCODE.

       aa     The AA flag.

       tc     The TC flag.

       rd     The RD flag.

       ra     The RA flag.

       z      The Z flag.

       ad     The AD flag.

       cd     The CD flag.

       rcode  The RCODE.

       qdcount
              The QDCOUNT.

       ancount
              The ANCOUNT.

       nscount
              The NSCOUNT.

       arcount
              The ARCOUNT.

   <b>Constants</b>
       The  following  tables  exists  for  DNS  parameters,  taken  from  <u>https://www.iana.org/assignments/dns-</u>
       <u>parameters/dns-parameters.xhtml</u> on the 2016-12-09.

       <u>CLASS</u>, <u>CLASS_STR</u>,  <u>TYPE</u>,  <u>TYPE_STR</u>,  <u>OPCODE</u>,  <u>OPCODE_STR</u>,  <u>RCODE</u>,  <u>RCODE_STR</u>,  <u>AFSDB</u>,  <u>AFSDB_STR</u>,  <u>DHCID</u>,
       <u>DHCID_STR</u>, <u>ENDS0</u>, <u>ENDS0_STR</u>

       The  <u>*_STR</u>  tables can be used to get a textual representation of the numbers, see also <u>class_tostring()</u>,
       <u>type_tostring()</u>,   <u>opcode_tostring()</u>,   <u>rcode_tostring()</u>,    <u>afsdb_tostring()</u>,    <u>dhcid_tostring()</u>    and
       <u>edns0_tostring()</u>.

   <b>Functions</b>
       <b>Dns.new</b>(obj)
              Create a new DNS object, optionally on-top of another object.

       <b>Dns:type</b>()
              Return the textual type of the object.

       <b>Dns:prev</b>()
              Return the previous object.

       <b>Dns:cast</b>()
              Cast the object to the underlining object module and return it.

       <b>Dns:uncast</b>()
              Cast the object to the generic object module and return it.

       <b>Dns:copy</b>()
              Make a copy of the object and return it.

       <b>Dns:free</b>()
              Free the object, should only be used on copies or otherwise allocated.

       <b>Dns:reset</b>()
              Reset the object readying it for reuse.

       <b>Dns:log</b>()
              Return the Log object to control logging of this module.

       <b>Dns:parse_header</b>()
              Begin  parsing the underlaying object, first the header is parsed then optionally continue calling
              <u>parse_q</u>() for the number of questions (see <u>qdcount</u>).  After that continue calling  <u>parse_rr</u>()  for
              the  number  of  answers,  authorities  and additionals resource records (see <u>ancount</u>, <u>nscount</u> and
              <u>arcount</u>).  Returns 0 on success or negative integer  on  error  which  can  be  for  malformed  or
              truncated DNS (-2) or if more space for labels is needed (-3).

       <b>Dns:parse_q</b>(q, labels, num_labels)
              Parse  the  next resource record as a question.  Returns 0 on success or negative integer on error
              which can be for malformed or truncated DNS (-2) or if more space for labels is needed (-3).

       <b>Dns:parse_rr</b>(rr, labels, num_labels)
              Parse the next resource record.  Returns 0 on success or negative integer on error  which  can  be
              for malformed or truncated DNS (-2) or if more space for labels is needed (-3).

       <b>Dns:parse</b>(num_labels)
              Begin parsing the underlaying object using <u>parse_header</u>(), <u>parse_q</u>() and <u>parse_rr</u>().  The optional
              <u>num_labels</u>  can  be  used  to  set a specific number of labels used for each question and resource
              record (default 16).  Returns result code, an array of questions, an array of question labels,  an
              array of resource records and an array of resource records labels.  Result code is 0 on success or
              negative  integer  on  error which can be for malformed or truncated DNS (-2) or if more space for
              labels is needed (-3).

       <b>Dns:print</b>(num_labels)
              Begin parsing the underlaying object using <u>parse_header</u>(), <u>parse_q</u>()  and  <u>parse_rr</u>(),  and  print
              it's  content.   The  optional  <u>num_labels</u> can be used to set a specific number of labels used for
              each question and resource record (default 16).

       <b>Dns.class_tostring</b>(class)
              Return the textual name for a class.

       <b>Dns.type_tostring</b>(type)
              Return the textual name for a type.

       <b>Dns.opcode_tostring</b>(opcode)
              Return the textual name for an opcode.

       <b>Dns.rcode_tostring</b>(rcode)
              Return the textual name for a rcode.

       <b>Dns.afsdb_tostring</b>(afsdb)
              Return the textual name for an afsdb subtype.

       <b>Dns.dhcid_tostring</b>(dhcid)
              Return the textual name for a dhcid type.

       <b>Dns.edns0_tostring</b>(edns0)
              Return the textual name for an EDNS0 OPT record.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/dnsjit.core.object.3.html">dnsjit.core.object</a></b>(3),          <b><a href="../man3/dnsjit.core.object.payload.3.html">dnsjit.core.object.payload</a></b>(3),           <b><a href="../man3/dnsjit.core.object.dns.label.3.html">dnsjit.core.object.dns.label</a></b>(3),
       <b><a href="../man3/dnsjit.core.object.dns.q.3.html">dnsjit.core.object.dns.q</a></b>(3), <b><a href="../man3/dnsjit.core.object.dns.rr.3.html">dnsjit.core.object.dns.rr</a></b>(3)

</pre><h4><b>AUTHORS</b> <b>and</b> <b>CONTRIBUTORS</b></h4><pre>
       Jerry Lundström (DNS-OARC), Tomáš Křížek (CZ.NIC), Petr Špaček (ISC)

       Maintained by DNS-OARC

              <u>https://www.dns-oarc.net/</u>

</pre><h4><b>BUGS</b></h4><pre>
       For issues and feature requests please use:

              <u>https://github.com/DNS-OARC/dnsjit/issues</u>

       For question and help please use:

              <u><a href="mailto:admin@dns-oarc.net">admin@dns-oarc.net</a></u>

dnsjit                                                1.5.0                            <u><a href="../man3/dnsjit.core.object.dns.3.html">dnsjit.core.object.dns</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>