<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gd_desync — check for a change of metadata on disk</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libgetdata-doc">libgetdata-doc_0.11.0-15_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gd_desync — check for a change of metadata on disk

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;getdata.h&gt;</b>

       <b>int</b> <b>gd_desync(DIRFILE</b> <b>*</b><u>dirfile</u><b>,</b> <b>unsigned</b> <b>int</b> <u>flags</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>gd_desync</b>() function determines whether the metadata of the loaded <u>dirfile</u> has become desynchronised
       from the format specification fragments on disk, due to a third party modifying the Dirfile  metadata  on
       disk  after  GetData opened it.  If <u>dirfile</u> has become desynchronised, this function can, optionally, re‐
       load the dirfile.

       The <u>flags</u> argument influences how the function works.  It should be zero or more of the following  flags,
       bitwise or'd together:

       <b>GD_DESYNC_PATHCHECK</b>
               Ignore  GetData's internal directory cache, and use the format fragments' full path when checking
               for modifications.  This flag  is  of  particular  importance  when  the  <u>dirfilename</u>  passed  to
               <b><a href="../man3/gd_cbopen.3.html">gd_cbopen</a></b>(3),  or  directory  paths used in included fragments, contain symbolic links: with this
               flag, these symbolic links will be re-evaluated.  Without it, the target of the symbolic links in
               effect when the dirfile was first opened will be considered instead.

       <b>GD_DESYNC_REOPEN</b>
               If this flag is specified, and <b>gd_desync</b>() detects desynchronisation, the  Dirfile  will  be  re-
               opened  in  place  using  the exiting <u>dirfile</u> pointer.  In this case, upon a positive result from
               this function, the caller must discard all cached information about the dirfile, even the assump‐
               tion that <u>dirfile</u> has been successfully opened.

               Re-opening the dirfile is equivalent to calling <b><a href="../man3/gd_discard.3.html">gd_discard</a></b>(3), and  then  <b><a href="../man3/gd_cbopen.3.html">gd_cbopen</a></b>(3)  with  the
               same  arguments  used  when  originally creating <u>dirfile</u>, except that the <u>dirfile</u> pointer doesn't
               change its value.  As a result, this function may invoke the registered parser callback  function
               (see <b><a href="../man3/gd_cbopen.3.html">gd_cbopen</a></b>(3) and <b><a href="../man3/gd_parser_callback.3.html">gd_parser_callback</a></b>(3)).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       When  successful,  this  function returns zero if the loaded dirfile has not desynchronised, or one if it
       has.  On error, a negative-valued error code is returned, regardless of desynchronisation.  Possible  er‐
       ror codes are:

       <b>GD_E_ALLOC</b>
               The library was unable to allocate memory.

       <b>GD_E_BAD_DIRFILE</b>
               The supplied dirfile was invalid.

       <b>GD_E_IO</b> An error occurred while trying to obtain the modification time of a fragment.

       Additionally,  if  <b>GD_DESYNC_REOPEN</b>  is used, this function may fail for any of the reasons listed in the
       <b><a href="../man3/gd_discard.3.html">gd_discard</a></b>(3) and <b><a href="../man3/gd_cbopen.3.html">gd_cbopen</a></b>(3) manual pages.

       The error code is also stored in the <b>DIRFILE</b> object and may be retrieved after this function  returns  by
       calling   <b><a href="../man3/gd_error.3.html">gd_error</a></b>(3).    A   descriptive  error  string  for  the  error  may  be  obtained  by  calling
       <b><a href="../man3/gd_error_string.3.html">gd_error_string</a></b>(3).

</pre><h4><b>LIMITATIONS</b></h4><pre>
       The current implementation uses file modification times as reported by <b><a href="../man2/stat.2.html">stat</a></b>(2) to detect changes.   These
       times have a granularity of, at best, one second.  As a result, desynchronisation will not be detected in
       the  case  when  a  fragment is modified, then GetData reads it, then the fragment is modified again, all
       within one second.  The caller may wish to perform its own monitoring using  the  pathnames  returned  by
       <b><a href="../man3/gd_fragmentname.3.html">gd_fragmentname</a></b>(3).

       On  systems  lacking  a POSIX.1-2008 conformant <b><a href="../man2/fstatat.2.html">fstatat</a></b>(2) (q.v.), this function may always operate as if
       <b>GD_DESYNC_PATHCHECK</b> had been specified, regardless of the actual <u>flags</u>.

</pre><h4><b>HISTORY</b></h4><pre>
       The function <b>gd_desync</b>() appeared in GetData-0.8.0.

       In GetData-0.10.0, the error return from this function changed from -1 to a negative-valued error code.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/fstatat.2.html">fstatat</a></b>(2), <b><a href="../man2/stat.2.html">stat</a></b>(2), <b><a href="../man3/gd_cbopen.3.html">gd_cbopen</a></b>(3), <b><a href="../man3/gd_discard.3.html">gd_discard</a></b>(3), <b><a href="../man3/gd_error.3.html">gd_error</a></b>(3), <b><a href="../man3/gd_error_string.3.html">gd_error_string</a></b>(3), <b><a href="../man3/gd_parser_callback.3.html">gd_parser_callback</a></b>(3)

Version 0.10.0                                  25 December 2016                                    <u><a href="../man3/gd_desync.3.html">gd_desync</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>