<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::SpamAssassin::DnsResolver - DNS resolution engine</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/spamassassin">spamassassin_4.0.1-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::SpamAssassin::DnsResolver - DNS resolution engine

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This is a DNS resolution engine for SpamAssassin, implemented in order to reduce file descriptor usage by
       Net::DNS and avoid a response collision bug in that module.

</pre><h4><b>METHODS</b></h4><pre>
       $res-&gt;<b>load_resolver()</b>
           Load the "Net::DNS::Resolver" object.  Returns 0 if Net::DNS cannot be used, 1 if it is available.

       $resolver = $res-&gt;<b>get_resolver()</b>
           Return the "Net::DNS::Resolver" object.

       $res-&gt;<b>configured_nameservers()</b>
           Get  a  list  of  nameservers  as  configured  by  dns_server  directives or as provided by Net::DNS,
           typically from <a href="file:/etc/resolv.conf">/etc/resolv.conf</a>

       $res-&gt;<b>available_nameservers()</b>
           Get or set a list of currently available nameservers, which is typically a known-to-be-good subset of
           configured nameservers

       $res-&gt;<b>connect_sock()</b>
           Re-connect to the first nameserver listed in "<a href="file:/etc/resolv.conf">/etc/resolv.conf</a>" or similar platform-dependent source,
           as provided by "Net::DNS".

       $res-&gt;<b>get_sock()</b>
           Return the "IO::Socket::INET" object used to communicate with the nameserver.

       $packet = new_dns_packet ($domain, $type, $class)
           A wrapper for Net::DNS::Packet::new() which traps a die thrown by it.

           To use this, change calls to "Net::DNS::Resolver::bgsend" from:

               $res-&gt;bgsend($domain, $type);

           to:

               $res-&gt;bgsend(Mail::SpamAssassin::DnsResolver::new_dns_packet($domain, $type, $class));

       $id = $res-&gt;bgsend($domain, $type, $class, $cb)
           DIRECT USE DISCOURAGED, please use bgsend_and_start_lookup in plugins.

           Quite similar to "Net::DNS::Resolver::bgsend", except that when a reply  packet  eventually  arrives,
           and "poll_responses" is called, the callback sub reference $cb will be called.

           Note  that  $type  and  $class  may  be  "undef",  in  which  case they will default to "A" and "IN",
           respectively.

           The callback sub will be called with three arguments -- the packet that  was  delivered,  and  an  id
           string  that  fingerprints the query packet and the expected reply. The third argument is a timestamp
           (Unix time, floating point), captured at the time the packet was collected. It  is  expected  that  a
           closure callback be used, like so:

             my $id = $self-&gt;{resolver}-&gt;bgsend($domain, $type, undef, sub {
                   my ($reply, $reply_id, $timestamp) = @_;
                   $self-&gt;got_a_reply($reply, $reply_id);
                 });

           The  callback  can  ignore  the reply as an invalid packet sent to the listening port if the reply id
           does not match the return value from bgsend.

       $id = $res-&gt;<b>bgread()</b>
           Similar to "Net::DNS::Resolver::bgread".  Reads a DNS packet from a supplied socket, decodes it,  and
           returns a Net::DNS::Packet object if successful.  Dies on error.

       $nfound = $res-&gt;<b>poll_responses()</b>
           See if there are any "bgsend" reply packets ready, and return the number of such packets delivered to
           their callbacks.

       $res-&gt;<b>bgabort()</b>
           Call  this  to release pending requests from memory, when aborting backgrounded requests, or when the
           scan is complete.  "Mail::SpamAssassin::PerMsgStatus::check" calls this before returning.

       $packet = $res-&gt;send($name, $type, $class)
           Emulates Net::DNS::Resolver::send().

           This subroutine is a  simple  synchronous  leftover  from  SpamAssassin  version  3.3  and  does  not
           participate    in    packet    query    caching    and    callback   grouping   as   implemented   by
           <b>AsyncLoop::bgsend_and_start_lookup()</b>.  As such it should be avoided for mainstream usage.   Currently
           used through Mail::SPF::Server by the SPF plugin.

       $res-&gt;<b>errorstring()</b>
           Little more than a stub for callers expecting this from "Net::DNS::Resolver".

           If called immediately after a call to $res-&gt;send this will return "query timed out" if the $res-&gt;send
           DNS query timed out.  Otherwise "unknown error or no error" will be returned.

           No other errors are reported.

       $res-&gt;<b>finish_socket()</b>
           Reset socket when done with it.

       $res-&gt;<b>finish()</b>
           Clean up for destruction.

perl v5.40.1                                       2025-06-26               <u>Mail::SpamAssassin::<a href="../man3pm/DnsResolver.3pm.html">DnsResolver</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>