<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::SpamAssassin::SQLBasedAddrList - SpamAssassin SQL Based Auto Welcomelist</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/spamassassin">spamassassin_4.0.1-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::SpamAssassin::SQLBasedAddrList - SpamAssassin SQL Based Auto Welcomelist

</pre><h4><b>SYNOPSIS</b></h4><pre>
           my $factory = Mail::SpamAssassin::SQLBasedAddrList-&gt;new()
           $spamtest-&gt;set_persistent_addr_list_factory ($factory);
         ... call into SpamAssassin classes...

       SpamAssassin will call:

           my $addrlist = $factory-&gt;new_checker($spamtest);
           $entry = $addrlist-&gt;get_addr_entry ($addr, $origip);
         ...

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A SQL based persistent address list implementation.

       See "Mail::SpamAssassin::PersistentAddrList" for more information.

       Uses DBI::DBD module access to your favorite database (tested with MySQL, SQLite and PostgreSQL) to store
       user auto-welcomelists.

       The default table structure looks like this: CREATE TABLE awl (
         username <a href="../man100/varchar.100.html">varchar</a>(100) NOT NULL default '',
         email <a href="../man255/varchar.255.html">varchar</a>(255) NOT NULL default '',
         ip <a href="../man40/varchar.40.html">varchar</a>(40) NOT NULL default '',
         msgcount <a href="../man11/int.11.html">int</a>(11) NOT NULL default '0',
         totscore float NOT NULL default '0',
         signedby <a href="../man255/varchar.255.html">varchar</a>(255) NOT NULL default '',
         last_hit timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
         PRIMARY KEY (username,email,signedby,ip) ) TYPE=MyISAM;

       Your table definition may change depending on which database driver you choose.  There is a config option
       to override the table name.

       This module introduces several new config variables:

       user_awl_dsn

       user_awl_sql_username

       user_awl_sql_password

       user_awl_sql_table

       user_awl_sql_override_username

       see "Mail::SpamAssassin::Conf" for more information.

   <b>new</b>
       public class (Mail::SpamAssassin::SQLBasedAddrList) new ()

       Description: This method creates a new instance of the SQLBasedAddrList factory and calls the parent's
       (PersistentAddrList) new method.

   <b>new_checker</b>
       public instance (Mail::SpamAssassin::SQLBasedAddrList) new_checker (\% $main)

       Description: This method is called to setup a new checker interface and return a blessed copy of itself.
       Here is where we setup the SQL database connection based on the config values.

   <b>get_addr_entry</b>
       public instance (\%) get_addr_entry (String $addr, String $signedby)

       Description: This method takes a given $addr and splits it between the email address component and the ip
       component and performs a lookup in the database. If nothing is found in the database then a blank entry
       hash is created and returned, otherwise an entry containing the found information is returned.  If a
       with_awl_signer configuration option is enabled only addresses signed by the given signing identity are
       taken into account, or, if $signedby is undefined (or empty) only unsigned entries are considered.

       A key, "exists_p", is set to 1 if an entry already exists in the database, otherwise it is set to 0.

   <b>add_score</b>
       public instance (\%) add_score (\% $entry, Integer $score)

       Description: This method adds a given $score to a given $entry.  If the entry was marked as not existing
       in the database then an entry will be inserted, otherwise a simple update will be performed.

       NOTE: This code uses a self referential SQL call (ie set foo = foo + 1) which is supported by most modern
       database backends, but not everything calling itself a SQL database.

   <b>remove_entry</b>
       public instance () remove_entry (\% $entry)

       Description: This method removes a given $entry from the database.  If the ip portion of the entry
       address is equal to "none" then remove any perl-IP entries for this address as well.

   <b>finish</b>
       public instance () finish ()

       Description: This method provides the necessary cleanup for the address list.

   <b>_unpack_addr</b>
       private instance (String, String) _unpack_addr(string $addr)

       Description: This method splits an autowelcomelist address into it's two components, email and ip
       address.

perl v5.40.1                                       2025-06-26             <u>Mail::<a href="../man3pm/SpamAssas...QLBasedAddrList.3pm.html">SpamAssas...QLBasedAddrList</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>