<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>"Test::ExpectAndCheck::Future" - "expect/check"-style unit testing with "Future"-returning methods</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtest-expectandcheck-perl">libtest-expectandcheck-perl_0.07-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       "Test::ExpectAndCheck::Future" - "expect/check"-style unit testing with "Future"-returning methods

</pre><h4><b>SYNOPSIS</b></h4><pre>
          use Test::More;
          use Test::ExpectAndCheck::Future;

          use Future::AsyncAwait;

          my ( $controller, $mock ) = Test::ExpectAndCheck::Future-&gt;create;

          {
             $controller-&gt;expect( act =&gt; 123, 45 )
                -&gt;will_done( 678 );

             is( await $mock-&gt;act( 123, 45 ), 678, '$mock-&gt;act yields result' );

             $controller-&gt;check_and_clear( '-&gt;act' );
          }

          done_testing;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This package creates objects that assist in writing unit tests with mocked object instances. Each mocked
       instance will expect to receive a given list of method calls. Each method call is checked that it
       received the right arguments, and will return a Future instance to yield the prescribed result. At the
       end of each test, each object is checked to ensure all the expected methods were called.

       It is a variation of Test::ExpectAndCheck, assistance around the results of invoked methods. Every
       invoked method will return a Future instance. The "will_done" or "will_fail" method can then set the
       desired eventual result of that future instance for each expectation.

       These return instances are implemented using Test::Future::Deferred, so they are not immediately ready.
       Instead they will only become ready after a toplevel "await" expression or call to the "get" method. This
       should help unit tests to run similarly to real-world behaviour, where most futures returned by real-
       world interfaces (such as IO systems) would not be immediately ready. This behaviour can be switched off
       for individual expectations by using the "immediately" method.

</pre><h4><b>EXPECTATIONS</b></h4><pre>
   <b>will_done</b>
          $exp-&gt;will_done( @result );

       <u>Since</u> <u>version</u> <u>0.04.</u>

       Sets that method call will return a "Future" instance which will succeed with the given result.

   <b>will_fail</b>
          $exp-&gt;will_fail( $message, $category, @more );

       <u>Since</u> <u>version</u> <u>0.04.</u>

       Sets that method call will return a "Future" instance which will fail with the given message, and
       optionally category name and extra details.

   <b>immediately</b>
          $exp-&gt;will_done( ... )-&gt;immediately;

          $exp-&gt;will_fail( ... )-&gt;immediately;

       <u>Since</u> <u>version</u> <u>0.02.</u>

       Switches this expectation to return an immediate future, rather than a deferred one.

   <b>remains_pending</b>
          $exp-&gt;remains_pending;

       <u>Since</u> <u>version</u> <u>0.03.</u>

       Sets that the future returned by this method will not complete and simply remain pending.

   <b>will_also_later</b>
          $exp-&gt;will_also_later( sub { ... } );

       <u>Since</u> <u>version</u> <u>0.04.</u>

       Adds extra code which will run when the expected method is called, after the returned future has
       completed. This is performed by the use of "Test::Future::Deferred".

       When invoked, the code body is invoked in void context with no additional arguments.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Evans &lt;<a href="mailto:leonerd@leonerd.org.uk">leonerd@leonerd.org.uk</a>&gt;

perl v5.40.0                                       2024-10-28                  <u>Test::ExpectAndCheck::<a href="../man3pm/Future.3pm.html">Future</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>