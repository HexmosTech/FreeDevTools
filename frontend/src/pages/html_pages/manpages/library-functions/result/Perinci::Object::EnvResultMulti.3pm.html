<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perinci::Object::EnvResultMulti - Represent enveloped result (multistatus)</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libperinci-object-perl">libperinci-object-perl_0.311-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Perinci::Object::EnvResultMulti - Represent enveloped result (multistatus)

</pre><h4><b>VERSION</b></h4><pre>
       This document describes version 0.311 of Perinci::Object::EnvResultMulti (from Perl distribution Perinci-
       Object), released on 2020-01-02.

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Perinci::Object::EnvResultMulti;
        use Data::Dump; # for dd()

        sub myfunc {
            ...

            # if unspecified, the default status will be [200, "Success/no items"]
            my $envres = Perinci::Object::EnvResultMulti-&gt;new;

            # then you can add result for each item
            $envres-&gt;add_result(200, "OK", {item_id=&gt;1});
            $envres-&gt;add_result(202, "OK", {item_id=&gt;2, note=&gt;"blah"});
            $envres-&gt;add_result(404, "Not found", {item_id=&gt;3});
            ...

            # if you add a success status, the overall status will still be 200

            # if you add a non-success staus, the overall status will be 207, or
            # the non-success status (if no success has been added)

            # finally, return the result
            return $envres-&gt;as_struct;

            # the result from the above will be: [207, "Partial success", undef,
            # {results =&gt; [
            #     {success=&gt;200, message=&gt;"OK", item_id=&gt;1},
            #     {success=&gt;201, message=&gt;"OK", item_id=&gt;2, note=&gt;"blah"},
            #     {success=&gt;404, message=&gt;"Not found", item_id=&gt;3},
            # ]}]
        } # myfunc

       To add a payload for each result:

        my $envres = Perinci::Object::EnvResultMulti-&gt;new;
        $envres-&gt;add_result(200, "OK", {item_id=&gt;1, payload=&gt;"a"});
        $envres-&gt;add_result(200, "OK", {item_id=&gt;2, payload=&gt;"b"});
        $envres-&gt;add_result(200, "OK", {item_id=&gt;3, payload=&gt;"c"});

        return $envres-&gt;as_struct;
        # =&gt; [200, "All success", ["a","b","c"], ...]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This class is a subclass of Perinci::Object::EnvResult and provides a convenience method when you want to
       use multistatus/detailed per-item results (specified in Rinci 1.1.63: "results" result metadata
       property). In this case, response status can be 200, 207, or non-success. As you add more per-item
       results, this class will set/update the overall response status for you.

</pre><h4><b>METHODS</b></h4><pre>
   <b>new($res)</b> <b>=&gt;</b> <b>OBJECT</b>
       Create a new object from $res enveloped result array. If $res is not specified, the default is "[200,
       "Success/no items"]".

   <b>$envres-&gt;add_result($status,</b> <b>$message,</b> <b>\%extra)</b>
       Add an item result.

       Extra keys:

       •   item_id

       •   payload

           If  you  want  to  add a payload for this result. The final overall payload will be an array composed
           from this payload.

</pre><h4><b>HOMEPAGE</b></h4><pre>
       Please visit the project's homepage at &lt;https://metacpan.org/release/Perinci-Object&gt;.

</pre><h4><b>SOURCE</b></h4><pre>
       Source repository is at &lt;https://github.com/perlancar/perl-Perinci-Object&gt;.

</pre><h4><b>BUGS</b></h4><pre>
       Please    report    any    bugs     or     feature     requests     on     the     bugtracker     website
       &lt;https://github.com/perlancar/perl-Perinci-Object/issues&gt;

       When  submitting  a  bug  or request, please include a test-file or a patch to an existing test-file that
       illustrates the bug or desired feature.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Perinci::Object

       Perinci::Object::EnvResult

</pre><h4><b>AUTHOR</b></h4><pre>
       perlancar &lt;<a href="mailto:perlancar@cpan.org">perlancar@cpan.org</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       This software is copyright (c) 2021, 2017, 2016, 2015, 2014, 2013, 2012, 2011 by <a href="mailto:perlancar@cpan.org">perlancar@cpan.org</a>.

       This is free software; you can redistribute it and/or modify it under  the  same  terms  as  the  Perl  5
       programming language system itself.

perl v5.36.0                                       2022-10-13               <u>Perinci::Object::<a href="../man3pm/EnvResultMulti.3pm.html">EnvResultMulti</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>