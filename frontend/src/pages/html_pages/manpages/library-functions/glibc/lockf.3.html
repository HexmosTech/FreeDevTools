<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lockf - apply, test or remove a POSIX lock on an open file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       lockf - apply, test or remove a POSIX lock on an open file

</pre><h4><b>LIBRARY</b></h4><pre>
       Standard C library (<u>libc</u>, <u>-lc</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;</b>

       <b>int</b> <b>lockf(int</b> <u>fd</u><b>,</b> <b>int</b> <u>op</u><b>,</b> <b>off_t</b> <u>len</u><b>);</b>

   Feature Test Macro Requirements for glibc (see <b><a href="../man7/feature_test_macros.7.html">feature_test_macros</a></b>(7)):

       <b>lockf</b>():
           _XOPEN_SOURCE &gt;= 500
               || /* glibc &gt;= 2.19: */ _DEFAULT_SOURCE
               || /* glibc &lt;= 2.19: */ _BSD_SOURCE || _SVID_SOURCE

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Apply,  test,  or  remove a POSIX lock on a section of an open file.  The file is specified by <u>fd</u>, a file
       descriptor open for writing, the action by <u>op</u>, and the section consists of byte positions  <u>pos</u>..<u>pos</u>+<u>len</u>-1
       if <u>len</u> is positive, and <u>pos</u>-<u>len</u>..<u>pos</u>-1 if <u>len</u> is negative, where <u>pos</u> is the current file position, and if
       <u>len</u> is zero, the section extends from the current file position to infinity, encompassing the present and
       future end-of-file positions.  In all cases, the section may extend past current end-of-file.

       On  Linux, <b>lockf</b>() is just an interface on top of <b><a href="../man2/fcntl.2.html">fcntl</a></b>(2) locking.  Many other systems implement <b>lockf</b>()
       in this way,  but  note  that  POSIX.1  leaves  the  relationship  between  <b>lockf</b>()  and  <b><a href="../man2/fcntl.2.html">fcntl</a></b>(2)  locks
       unspecified.  A portable application should probably avoid mixing calls to these interfaces.

       Valid operations are given below:

       <b>F_LOCK</b> Set  an exclusive lock on the specified section of the file.  If (part of) this section is already
              locked, the call blocks until the previous lock is released.  If this section overlaps an  earlier
              locked section, both are merged.  File locks are released as soon as the process holding the locks
              closes some file descriptor for the file.  A child process does not inherit these locks.

       <b>F_TLOCK</b>
              Same  as  <b>F_LOCK</b>  but  the  call  never blocks and returns an error instead if the file is already
              locked.

       <b>F_ULOCK</b>
              Unlock the indicated section of the file.  This may cause a locked section to be  split  into  two
              locked sections.

       <b>F_TEST</b> Test the lock: return 0 if the specified section is unlocked or locked by this process; return -1,
              set <u>errno</u> to <b>EAGAIN</b> (<b>EACCES</b> on some other systems), if another process holds a lock.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, zero is returned.  On error, -1 is returned, and <u>errno</u> is set to indicate the error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EACCES</b> or <b>EAGAIN</b>
              The file is locked and <b>F_TLOCK</b> or <b>F_TEST</b> was specified, or the operation is prohibited because the
              file has been memory-mapped by another process.

       <b>EBADF</b>  <u>fd</u>  is  not  an  open  file  descriptor;  or <u>op</u> is <b>F_LOCK</b> or <b>F_TLOCK</b> and <u>fd</u> is not a writable file
              descriptor.

       <b>EDEADLK</b>
              <u>op</u> was <b>F_LOCK</b> and this lock operation would cause a deadlock.

       <b>EINTR</b>  While waiting to acquire a lock, the call was interrupted by delivery of  a  signal  caught  by  a
              handler; see <b><a href="../man7/signal.7.html">signal</a></b>(7).

       <b>EINVAL</b> An invalid operation was specified in <u>op</u>.

       <b>ENOLCK</b> Too many segment locks open, lock table is full.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       For an explanation of the terms used in this section, see <b><a href="../man7/attributes.7.html">attributes</a></b>(7).
       ┌─────────────────────────────────────────────────────────────────────────────┬───────────────┬─────────┐
       │ <b>Interface</b>                                                                   │ <b>Attribute</b>     │ <b>Value</b>   │
       ├─────────────────────────────────────────────────────────────────────────────┼───────────────┼─────────┤
       │ <b>lockf</b>()                                                                     │ Thread safety │ MT-Safe │
       └─────────────────────────────────────────────────────────────────────────────┴───────────────┴─────────┘

</pre><h4><b>STANDARDS</b></h4><pre>
       POSIX.1-2008.

</pre><h4><b>HISTORY</b></h4><pre>
       POSIX.1-2001, SVr4.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/fcntl.2.html">fcntl</a></b>(2), <b><a href="../man2/flock.2.html">flock</a></b>(2)

       <u>locks.txt</u>  and  <u>mandatory-locking.txt</u>  in the Linux kernel source directory <u>Documentation/filesystems</u> (on
       older kernels, these files are directly under the <u>Documentation</u> directory, and  <u>mandatory-locking.txt</u>  is
       called <u>mandatory.txt</u>)

Linux man-pages 6.9.1                              2024-05-02                                           <u><a href="../man3/lockf.3.html">lockf</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>