<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rex::Commands::Cloud - Cloud Management Commands</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/rex">rex_1.16.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Rex::Commands::Cloud - Cloud Management Commands

</pre><h4><b>DESCRIPTION</b></h4><pre>
       With this Module you can manage different Cloud services. Currently it supports Amazon EC2, Jiffybox and
       OpenStack.

       Version &lt;= 1.0: All these functions will not be reported.

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Rex::Commands::Cloud;

        cloud_service "Amazon";
        cloud_auth "your-access-key", "your-private-access-key";
        cloud_region "ec2.eu-west-1.amazonaws.com";

        task "list", sub {
          print Dumper cloud_instance_list;
          print Dumper cloud_volume_list;
        };

        task "create", sub {
          my $vol_id = cloud_volume create =&gt; { size =&gt; 1, zone =&gt; "eu-west-1a", };

          cloud_instance create =&gt; {
              image_id =&gt; "ami-xxxxxxx",
              name    =&gt; "test01",
              key    =&gt; "my-key",
              volume  =&gt; $vol_id,
              zone    =&gt; "eu-west-1a",
            };
        };

        task "destroy", sub {
          cloud_volume detach =&gt; "vol-xxxxxxx";
          cloud_volume delete =&gt; "vol-xxxxxxx";

          cloud_instance terminate =&gt; "i-xxxxxxx";
        };

</pre><h4><b>EXPORTED</b> <b>FUNCTIONS</b></h4><pre>
   <b>cloud_service($cloud_service)</b>
       Define which cloud service to use.

       Services
           Amazon
           Jiffybox
           OpenStack

   <b>cloud_auth($param1,</b> <b>$param2,</b> <b>...)</b>
       Set the authentication for the cloudservice.

       For example for Amazon it is:

        cloud_auth($access_key, $secret_access_key);

       For JiffyBox:

        cloud_auth($auth_key);

       For OpenStack:

        cloud_auth(
         tenant_name =&gt; 'tenant',
         username    =&gt; 'user',
         password    =&gt; 'password',
        );

   <b>cloud_region($region)</b>
       Set the cloud region.

   <b>cloud_instance_list</b>
       Get all instances of a cloud service.

        task "list", sub {
          for my $instance (cloud_instance_list()) {
            say "Arch  : " . $instance-&gt;{"architecture"};
            say "IP   : " . $instance-&gt;{"ip"};
            say "ID   : " . $instance-&gt;{"id"};
            say "State : " . $instance-&gt;{"state"};
          }
        };

       There  are some parameters for this function that can change the gathering of ip addresses for some cloud
       providers (like OpenStack).

        task "list", sub {
          my @instances = cloud_instance_list
                             private_network =&gt; 'private',
                             public_network  =&gt; 'public',
                             public_ip_type  =&gt; 'floating',
                             private_ip_type =&gt; 'fixed';
        };

   <b>cloud_volume_list</b>
       Get all volumes of a cloud service.

        task "list-volumes", sub {
          for my $volume (cloud_volume_list()) {
            say "ID     : " . $volume-&gt;{"id"};
            say "Zone    : " . $volume-&gt;{"zone"};
            say "State   : " . $volume-&gt;{"state"};
            say "Attached : " . $volume-&gt;{"attached_to"};
          }
        };

   <b>cloud_network_list</b>
       Get all networks of a cloud service.

        task "network-list", sub {
          for my $network (cloud_network_list()) {
            say "network  : " . $network-&gt;{network};
            say "name    : " . $network-&gt;{name};
            say "id     : " . $network-&gt;{id};
          }
        };

   <b>cloud_image_list</b>
       Get a list of all available cloud images.

   <b>cloud_upload_key</b>
       Upload public SSH key to cloud provider

        private_key '<a href="file:~/.ssh/mykey">~/.ssh/mykey</a>
        public_key  '<a href="file:~/.ssh/mykey.pub">~/.ssh/mykey.pub</a>';

        task "cloudprovider", sub {
          cloud_upload_key;

          cloud_instance create =&gt; {
            ...
          };
        };

   <b>get_cloud_instances_as_group</b>
       Get a list of all running instances of a cloud service. This can be used for a <u>group</u> definition.

        group fe  =&gt; "fe01", "fe02", "fe03";
        group ec2 =&gt; get_cloud_instances_as_group();

   <b>cloud_instance($action,</b> <b>$data)</b>
       This function controls all aspects of a cloud instance.

   <b>create</b>
       Create a new instance.

        cloud_instance create =&gt; {
            image_id =&gt; "ami-xxxxxx",
            key    =&gt; "ssh-key",
            name    =&gt; "fe-ec2-01",  # name is not necessary
            volume  =&gt; "vol-yyyyy",  # volume is not necessary
            zone    =&gt; "eu-west-1a",  # zone is not necessary
            floating_ip  =&gt; "89.39.38.160" # floating_ip is not necessary
          };

   <b>start</b>
       Start an existing instance

        cloud_instance start =&gt; "instance-id";

   <b>stop</b>
       Stop an existing instance

        cloud_instance stop =&gt; "instance-id";

   <b>terminate</b>
       Terminate an instance. This will destroy all data and remove the instance.

        cloud_instance terminate =&gt; "i-zzzzzzz";

   <b>get_cloud_regions</b>
       Returns all regions as an array.

   <b>cloud_volume($action</b> <b>,</b> <b>$data)</b>
       This function controls all aspects of a cloud volume.

   <b>create</b>
       Create a new volume. Size is in Gigabytes.

        task "create-vol", sub {
          my $vol_id = cloud_volume create =&gt; { size =&gt; 1, zone =&gt; "eu-west-1a", };
        };

   <b>attach</b>
       Attach a volume to an instance.

        task "attach-vol", sub {
          cloud_volume attach =&gt; "vol-xxxxxx", to =&gt; "server-id";
        };

   <b>detach</b>
       Detach a volume from an instance.

        task "detach-vol", sub {
          cloud_volume detach =&gt; "vol-xxxxxx", from =&gt; "server-id";
        };

   <b>delete</b>
       Delete a volume. This will destroy all data.

        task "delete-vol", sub {
          cloud_volume delete =&gt; "vol-xxxxxx";
        };

   <b>get_cloud_floating_ip</b>
       Returns first available floating IP

        task "get_floating_ip", sub {

          my $ip = get_cloud_floating_ip;

          my $instance = cloud_instance create =&gt; {
             image_id =&gt; 'edffd57d-82bf-4ffe-b9e8-af22563741bf',
             name =&gt; 'instance1',
             plan_id =&gt; 17,
             floating_ip =&gt; $ip
           };
        };

   <b>cloud_network</b>
   <b>create</b>
       Create a new network.

        task "create-net", sub {
          my $net_id = cloud_network create =&gt; { cidr =&gt; '192.168.0.0/24', name =&gt; "mynetwork", };
        };

   <b>delete</b>
       Delete a network.

        task "delete-net", sub {
          cloud_network delete =&gt; '18a4ccf8-f14a-a10d-1af4-4ac7fee08a81';
        };

   <b>get_cloud_availability_zones</b>
       Returns all availability zones of a cloud services. If available.

        task "get-zones", sub {
          print Dumper get_cloud_availability_zones;
        };

   <b>get_cloud_plans</b>
       Retrieve information of the available cloud plans. If supported.

   <b>get_cloud_operating_systems</b>
       Retrieve information of the available cloud plans. If supported.

   <b>cloud_object</b>
       Returns the cloud object itself.

perl v5.40.0                                       2025-02-06                          <u>Rex::Commands::<a href="../man3pm/Cloud.3pm.html">Cloud</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>