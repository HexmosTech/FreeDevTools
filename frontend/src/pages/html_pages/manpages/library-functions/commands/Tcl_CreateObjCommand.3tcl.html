<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tcl_CreateObjCommand,      Tcl_CreateObjCommand2,      Tcl_DeleteCommand,     Tcl_DeleteCommandFromToken,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl9.0-doc">tcl9.0-doc_9.0.1+dfsg-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Tcl_CreateObjCommand,      Tcl_CreateObjCommand2,      Tcl_DeleteCommand,     Tcl_DeleteCommandFromToken,
       Tcl_GetCommandInfo,   Tcl_GetCommandInfoFromToken,    Tcl_SetCommandInfo,    Tcl_SetCommandInfoFromToken,
       Tcl_GetCommandName, Tcl_GetCommandFullName, Tcl_GetCommandFromObj - implement new commands in C

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tcl.h&gt;</b>

       Tcl_Command
       <b>Tcl_CreateObjCommand</b>(<u>interp,</u> <u>cmdName,</u> <u>proc,</u> <u>clientData,</u> <u>deleteProc</u>)

       Tcl_Command
       <b>Tcl_CreateObjCommand2</b>(<u>interp,</u> <u>cmdName,</u> <u>proc2,</u> <u>clientData,</u> <u>deleteProc</u>)

       int
       <b>Tcl_DeleteCommand</b>(<u>interp,</u> <u>cmdName</u>)

       int
       <b>Tcl_DeleteCommandFromToken</b>(<u>interp,</u> <u>token</u>)

       int
       <b>Tcl_GetCommandInfo</b>(<u>interp,</u> <u>cmdName,</u> <u>infoPtr</u>)

       int
       <b>Tcl_SetCommandInfo</b>(<u>interp,</u> <u>cmdName,</u> <u>infoPtr</u>)

       int
       <b>Tcl_GetCommandInfoFromToken</b>(<u>token,</u> <u>infoPtr</u>)

       int
       <b>Tcl_SetCommandInfoFromToken</b>(<u>token,</u> <u>infoPtr</u>)

       const char *
       <b>Tcl_GetCommandName</b>(<u>interp,</u> <u>token</u>)

       <b>Tcl_GetCommandFullName</b>(<u>interp,</u> <u>token,</u> <u>objPtr</u>)

       Tcl_Command
       <b>Tcl_GetCommandFromObj</b>(<u>interp,</u> <u>objPtr</u>)

</pre><h4><b>ARGUMENTS</b></h4><pre>
       Tcl_Interp <u>*interp</u> (in)                     Interpreter in which to create a new command or that contains
                                                   a command.

       const char <u>*cmdName</u> (in)                    Name of command.

       Tcl_ObjCmdProc <u>*proc</u> (in)                   Implementation  of  the  new  command:  <u>proc</u>  will  be called
                                                   whenever <u>cmdName</u> is invoked as a command.

       Tcl_ObjCmdProc2 <u>*proc2</u> (in)                 Implementation of the  new  command:  <u>proc2</u>  will  be  called
                                                   whenever <u>cmdName</u> is invoked as a command.

       void <u>*clientData</u> (in)                       Arbitrary one-word value to pass to <u>proc</u> and <u>deleteProc</u>.

       Tcl_CmdDeleteProc <u>*deleteProc</u> (in)          Procedure   to  call  before  <u>cmdName</u>  is  deleted  from  the
                                                   interpreter; allows for command-specific  cleanup.  If  NULL,
                                                   then no procedure is called before the command is deleted.

       Tcl_Command <u>token</u> (in)                      Token   for   command,   returned   by   previous   call   to
                                                   <b>Tcl_CreateObjCommand</b>.   The  command  must  not   have   been
                                                   deleted.

       Tcl_CmdInfo <u>*infoPtr</u> (in/out)               Pointer  to  structure containing various information about a
                                                   Tcl command.

       Tcl_Obj <u>*objPtr</u> (in)                        Value containing the name of a Tcl command.

       const char <u>*typeName</u> (in)                   Indicates the name of  the  type  of  command  implementation
                                                   associated  with  a  particular  <u>proc</u>,  or  NULL to break the
                                                   association.
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Tcl_CreateObjCommand</b> defines a new command in <u>interp</u> and associates it  with  procedure  <u>proc</u>  such  that
       whenever  <u>name</u>  is  invoked as a Tcl command (e.g., via a call to <b>Tcl_EvalObjEx</b>) the Tcl interpreter will
       call <u>proc</u> to process the command.

       <b>Tcl_CreateObjCommand</b> deletes any existing command <u>name</u> already associated with the  interpreter  (however
       see  below  for  an exception where the existing command is not deleted).  It returns a token that may be
       used to refer to the command in  subsequent  calls  to  <b>Tcl_GetCommandName</b>.   If  <u>name</u>  contains  any  <b>::</b>
       namespace  qualifiers,  then  the  command  is added to the specified namespace; otherwise the command is
       added to the global namespace.  If <b>Tcl_CreateObjCommand</b> is called for  an  interpreter  that  is  in  the
       process  of  being  deleted, then it does not create a new command and it returns NULL.  <u>proc</u> should have
       arguments and result that match the type <b>Tcl_ObjCmdProc</b>:

              typedef int <b>Tcl_ObjCmdProc</b>(
                      void *<u>clientData</u>,
                      Tcl_Interp *<u>interp</u>,
                      int <u>objc</u>,
                      Tcl_Obj *const <u>objv</u>[]);

       When <u>proc</u> is invoked, the <u>clientData</u> and <u>interp</u> parameters will be copies of the  <u>clientData</u>  and  <u>interp</u>
       arguments  given  to  <b>Tcl_CreateObjCommand</b>.  Typically, <u>clientData</u> points to an application-specific data
       structure that describes what to do when the command procedure is invoked. <u>Objc</u>  and  <u>objv</u>  describe  the
       arguments to the command, <u>objc</u> giving the number of argument values (including the command name) and <u>objv</u>
       giving  the  values  of the arguments.  The <u>objv</u> array will contain <u>objc</u> values, pointing to the argument
       values.  Unlike <u>argv</u>[<u>argv</u>] used in a string-based command procedure, <u>objv</u>[<u>objc</u>] will not contain NULL.

       Additionally, when <u>proc</u> is invoked, it must not modify the contents of the <u>objv</u> array  by  assigning  new
       pointer  values  to any element of the array (for example, <u>objv</u>[<b>2</b>] = <b>NULL</b>) because this will cause memory
       to be lost and the runtime stack to be corrupted.  The <b>const</b> in the declaration of <u>objv</u> will cause  ANSI-
       compliant  compilers  to  report any such attempted assignment as an error.  However, it is acceptable to
       modify the internal representation of any individual value argument.  For instance,  the  user  may  call
       <b>Tcl_GetIntFromObj</b> on <u>objv</u>[<b>2</b>] to obtain the integer representation of that value; that call may change the
       type of the value that <u>objv</u>[<b>2</b>] points at, but will not change where <u>objv</u>[<b>2</b>] points.

       <u>proc</u>  must  return  an  integer  code  that  is  either  <b>TCL_OK</b>,  <b>TCL_ERROR</b>,  <b>TCL_RETURN</b>,  <b>TCL_BREAK</b>,  or
       <b>TCL_CONTINUE</b>.  See the <b>return</b> man page for details on what these codes  mean  and  the  use  of  extended
       values for an extension's private use. Most normal commands will only return <b>TCL_OK</b> or <b>TCL_ERROR</b>.

       In  addition,  if  <u>proc</u>  needs  to  return  a  non-empty  result, it can call <b>Tcl_SetObjResult</b> to set the
       interpreter's result.  In the case of a <b>TCL_OK</b> return code this gives the result of the command,  and  in
       the  case  of  <b>TCL_ERROR</b> this gives an error message.  Before invoking a command procedure, <b>Tcl_EvalObjEx</b>
       sets interpreter's result to point to a value representing an empty string, so simple commands can return
       an empty result by doing nothing at all.

       The contents of the <u>objv</u> array belong to Tcl and are not guaranteed to persist once  <u>proc</u>  returns:  <u>proc</u>
       should not modify them.  Call <b>Tcl_SetObjResult</b> if you want to return something from the <u>objv</u> array.

       Ordinarily,   <b>Tcl_CreateObjCommand</b>  deletes  any  existing  command  <u>name</u>  already  associated  with  the
       interpreter.  However, if the existing command was created  by  a  previous  call  to  <b>Tcl_CreateCommand</b>,
       <b>Tcl_CreateObjCommand</b> does not delete the command but instead arranges for the Tcl interpreter to call the
       <b>Tcl_ObjCmdProc</b>  <u>proc</u>  in  the  future.   The  old string-based <b>Tcl_CmdProc</b> associated with the command is
       retained and its address can be obtained  by  subsequent  <b>Tcl_GetCommandInfo</b>  calls.  This  is  done  for
       backwards compatibility.

       <u>DeleteProc</u>   will   be   invoked  when  (if)  <u>name</u>  is  deleted.   This  can  occur  through  a  call  to
       <b>Tcl_DeleteCommand</b>, <b>Tcl_DeleteCommandFromToken</b>, or <b>Tcl_DeleteInterp</b>, or by replacing <u>name</u> in another  call
       to  <b>Tcl_CreateObjCommand</b>.  <u>DeleteProc</u> is invoked before the command is deleted, and gives the application
       an opportunity to release any structures associated with the command.  <u>DeleteProc</u> should  have  arguments
       and result that match the type <b>Tcl_CmdDeleteProc</b>:

              typedef void <b>Tcl_CmdDeleteProc</b>(
                      void *<u>clientData</u>);

       The <u>clientData</u> argument will be the same as the <u>clientData</u> argument passed to <b>Tcl_CreateObjCommand</b>.

       <b>Tcl_CreateObjCommand2</b>  does  the  same  as  <b>Tcl_CreateObjCommand</b>,  except  its  <u>proc2</u> argument is of type
       <b>Tcl_ObjCmdProc2</b>.

              typedef int <b>Tcl_ObjCmdProc2</b>(
                      void *<u>clientData</u>,
                      Tcl_Interp *<u>interp</u>,
                      Tcl_Size <u>objc</u>,
                      Tcl_Obj *const <u>objv</u>[]);

       <b>Tcl_DeleteCommand</b> deletes a command from a command interpreter.  Once the  call  completes,  attempts  to
       invoke  <u>cmdName</u>  in  <u>interp</u>  will  result in errors.  If <u>cmdName</u> is not bound as a command in <u>interp</u> then
       <b>Tcl_DeleteCommand</b> does nothing and returns -1;  otherwise it returns 0.  There  are  no  restrictions  on
       <u>cmdName</u>:   it  may  refer to a built-in command, an application-specific command, or a Tcl procedure.  If
       <u>name</u> contains any <b>::</b> namespace qualifiers, the command is deleted from the specified namespace.

       Given a token returned by <b>Tcl_CreateObjCommand</b>, <b>Tcl_DeleteCommandFromToken</b> deletes  the  command  from  a
       command  interpreter.   It  will  delete  a command even if that command has been renamed.  Once the call
       completes, attempts to invoke the command in <u>interp</u> will result in errors.  If the command  corresponding
       to  <u>token</u>  has  already  been  deleted  from  <u>interp</u>  then <b>Tcl_DeleteCommand</b> does nothing and returns -1;
       otherwise it returns 0.

       <b>Tcl_GetCommandInfo</b> checks to see whether its <u>cmdName</u> argument exists as a command in <u>interp</u>.  <u>cmdName</u> may
       include <b>::</b> namespace qualifiers to identify a command in a particular namespace.  If the command  is  not
       found, then it returns 0.  Otherwise it places information about the command in the <b>Tcl_CmdInfo</b> structure
       pointed to by <u>infoPtr</u> and returns 1.  A <b>Tcl_CmdInfo</b> structure has the following fields:

              typedef struct {
                  int <u>isNativeObjectProc</u>;
                  Tcl_ObjCmdProc *<u>objProc</u>;
                  void *<u>objClientData</u>;
                  Tcl_CmdProc *<u>proc</u>;
                  void *<u>clientData</u>;
                  Tcl_CmdDeleteProc *<u>deleteProc</u>;
                  void *<u>deleteData</u>;
                  Tcl_Namespace *<u>namespacePtr</u>;
                  Tcl_ObjCmdProc2 *<u>objProc2</u>;
                  void *<u>objClientData2</u>;
              } <b>Tcl_CmdInfo</b>;

       The <u>isNativeObjectProc</u> field has the value 2 if <b>Tcl_CreateObjCommand2</b> was called to register the command;
       it  has  the  value  1  if  <b>Tcl_CreateObjCommand</b>  was  called  to  register  the command; it is 0 if only
       <b>Tcl_CreateCommand</b> was called.  It allows a program to determine whether it is faster  to  call  <u>objProc2</u>,
       <u>objProc</u>   or   <u>proc</u>:  <u>objProc2</u>/<u>objProc</u>  is  normally  faster  if  <u>isNativeObjectProc</u>  has  the  value  2;
       <u>objProc</u>/<u>objProc</u> is normally faster if <u>isNativeObjectProc</u>  has  the  value  1.   The  fields  <u>objProc</u>  and
       <u>objClientData</u>  have  the  same meaning as the <u>proc</u> and <u>clientData</u> arguments to <b>Tcl_CreateObjCommand</b>; they
       hold information about the value-based command procedure that the Tcl interpreter calls to implement  the
       command.   The  fields <u>proc</u> and <u>clientData</u> hold information about the string-based command procedure that
       implements the command.  If <b>Tcl_CreateCommand</b> was called for this command, this is the  procedure  passed
       to  it; otherwise, this is a compatibility procedure registered by <b>Tcl_CreateObjCommand</b> that simply calls
       the command's value-based procedure after converting its string  arguments  to  Tcl  values.   The  field
       <u>deleteData</u>  is the clientData value to pass to <u>deleteProc</u>;  it is normally the same as <u>clientData</u> but may
       be set independently using the <b>Tcl_SetCommandInfo</b> procedure.  The field <u>namespacePtr</u> holds a  pointer  to
       the Tcl_Namespace that contains the command.

       <b>Tcl_GetCommandInfoFromToken</b>  is  identical  to  <b>Tcl_GetCommandInfo</b>  except  that  it uses a command token
       returned from <b>Tcl_CreateObjCommand</b> in place of the command name.  If the  <u>token</u>  parameter  is  NULL,  it
       returns 0; otherwise, it returns 1 and fills in the structure designated by <u>infoPtr</u>.

       <b>Tcl_SetCommandInfo</b> is used to modify the procedures and clientData values associated with a command.  Its
       <u>cmdName</u>  argument  is  the  name  of a command in <u>interp</u>.  <u>cmdName</u> may include <b>::</b> namespace qualifiers to
       identify a command in a particular namespace.  If this command does  not  exist  then  <b>Tcl_SetCommandInfo</b>
       returns  0.   Otherwise,  it  copies  the  information  from <u>*infoPtr</u> to Tcl's internal structure for the
       command and returns 1.

       <b>Tcl_SetCommandInfoFromToken</b> is identical to <b>Tcl_SetCommandInfo</b> except that it takes a  command  token  as
       returned by <b>Tcl_CreateObjCommand</b> instead of the command name.  If the <u>token</u> parameter is NULL, it returns
       0.   Otherwise,  it  copies the information from <u>*infoPtr</u> to Tcl's internal structure for the command and
       returns 1.

       Note that <b>Tcl_SetCommandInfo</b> and <b>Tcl_SetCommandInfoFromToken</b> both allow the clientData  for  a  command's
       deletion  procedure  to  be  given a different value than the clientData for its command procedure.  Note
       also that neither <b>Tcl_SetCommandInfo</b> nor <b>Tcl_SetCommandInfoFromToken</b> will change a  command's  namespace.
       Use <b>Tcl_Eval</b> to call the <b>rename</b> command to do that.

       <b>Tcl_GetCommandName</b>  provides  a  mechanism  for  tracking commands that have been renamed.  Given a token
       returned by <b>Tcl_CreateObjCommand</b> when the command was created, <b>Tcl_GetCommandName</b> returns the string name
       of the command.  If the command has been renamed since it was created,  then  <b>Tcl_GetCommandName</b>  returns
       the  current name.  This name does not include any <b>::</b> namespace qualifiers.  The command corresponding to
       <u>token</u> must not have been deleted.  The string returned by <b>Tcl_GetCommandName</b> is in dynamic  memory  owned
       by  Tcl  and  is  only  guaranteed  to retain its value as long as the command is not deleted or renamed;
       callers should copy the string if they need to keep it for a long time.

       <b>Tcl_GetCommandFullName</b> produces the fully qualified name of a command from a command  token.   The  name,
       including all namespace prefixes, is appended to the value specified by <u>objPtr</u>.

       <b>Tcl_GetCommandFromObj</b>  returns  a  token for the command specified by the name in a <b>Tcl_Obj</b>.  The command
       name is resolved relative to the current namespace.  Returns NULL if the command is not found.

</pre><h4><b>REFERENCE</b> <b>COUNT</b> <b>MANAGEMENT</b></h4><pre>
       When the <u>proc</u> passed to <b>Tcl_CreateObjCommand</b> is called, the values in  its  <u>objv</u>  argument  will  have  a
       reference  count  of  at least 1, with that guaranteed reference being from the Tcl evaluation stack. You
       should not call <b>Tcl_DecrRefCount</b> on any of those values unless you call <b>Tcl_IncrRefCount</b> on  them  first.
       Also,  when  the  <u>proc</u> is called, the interpreter result is guaranteed to be an empty string value with a
       reference count of 1.

       <b>Tcl_GetCommandFullName</b> does not modify the reference count of its <u>objPtr</u> argument, but does require  that
       the object be unshared.

       <b>Tcl_GetCommandFromObj</b> does not modify the reference count of its <u>objPtr</u> argument; it only reads.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/Tcl_CreateCommand.3tcl.html">Tcl_CreateCommand</a>(3tcl), <a href="../man3tcl/Tcl_ResetResult.3tcl.html">Tcl_ResetResult</a>(3tcl), <a href="../man3tcl/Tcl_SetObjResult.3tcl.html">Tcl_SetObjResult</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       bind, command, create, delete, namespace, value

Tcl                                                    8.0                            <u><a href="../man3tcl/Tcl_CreateObjCommand.3tcl.html">Tcl_CreateObjCommand</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>