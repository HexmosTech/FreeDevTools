<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MooseX::Daemonize::Core - A Role with the core daemonization features</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmoosex-daemonize-perl">libmoosex-daemonize-perl_0.22-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       MooseX::Daemonize::Core - A Role with the core daemonization features

</pre><h4><b>VERSION</b></h4><pre>
       version 0.22

</pre><h4><b>SYNOPSIS</b></h4><pre>
         package My::Daemon;
         use Moose;

         with 'MooseX::Daemonize::Core';

         sub start {
             my $self = shift;
             # daemonize me ...
             $self-&gt;daemonize;
             # return from the parent,...
             return unless $self-&gt;is_daemon;
             # but continue on in the child (daemon)
         }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This is the basic daemonization Role, it provides a few methods (see below) and the minimum features
       needed to properly daemonize your code.

   <b>Important</b> <b>Notes</b>
       None of the methods in this role will exit the parent process for you, it only forks and detaches your
       child (daemon) process. It is your responsibility to exit the parent process in some way.

       There is no PID or PID file management in this role, that is your responsibility (see some of the other
       roles in this distro for that).

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       <u>is_daemon</u> <u>(is</u> <u>=</u> rw, isa =&gt; Bool)&gt;
           This attribute is used to signal if we are within the daemon process or not.

       <u>no_double_fork</u> <u>(is</u> <u>=</u> rw, isa =&gt; Bool)&gt;
           Setting  this  attribute to true will cause this method to not perform the typical double-fork, which
           is extra added protection from your process  accidentally  acquiring  a  controlling  terminal.  More
           information can be found above, and by Googling "double fork daemonize".

           If you the double-fork behavior off, you might want to enable the <u>ignore_zombies</u>.

       <u>ignore_zombies</u> <u>(is</u> <u>=</u> rw, isa =&gt; Bool)&gt;
           Setting  this  attribute  to  a true value will result in setting the $SIG{CHLD} handler to "IGNORE".
           This tells perl to clean up zombie processes. By default, and for the most part you  don't  <u>need</u>  it,
           only  when you turn off the double fork behavior (with the <u>no_double_fork</u> attribute) do you sometimes
           want this behavior.

       <u>dont_close_all_files</u> <u>(is</u> <u>=</u> rw, isa =&gt; Bool)&gt;
           Setting this attribute to true will cause it to skip closing all the filehandles. This is  useful  if
           you are opening things like sockets and such in the pre-fork.

</pre><h4><b>METHODS</b></h4><pre>
       <b>daemon_fork</b> <b>(?%options)</b>
           This  forks  off  the  child process to be daemonized. Just as with the built in fork, it returns the
           child pid to the parent process, 0 to the  child  process.  It  will  also  set  the  is_daemon  flag
           appropriately.

           The  %options  argument  remains  for  backwards  compatibility, but it is suggested that you use the
           attributes listed above instead.

       <b>daemon_detach</b> <b>(?%options)</b>
           This detaches the new child process from the terminal by doing the following things.

           The %options argument remains for backwards compatibility, but it  is  suggested  that  you  use  the
           attributes listed above instead.

           Becomes a session leader
               This  detaches  the  program  from  the  controlling  terminal,  it  is  accomplished  by calling
               "POSIX::setsid".

           Performing the double-fork
               See below for information on how to change this part of the process.

           Changes the current working directory to "/"
               This is standard daemon behavior, if you want a different working directory then simply change it
               later in your daemons code.

           Clears the file creation mask.
           Closes all open file descriptors.
               See the <u>dont_close_all_files</u> attribute for information on how to change this part of the process.

           Reopen STDERR, STDOUT &amp; STDIN to /dev/null
               This behavior can be controlled slightly though  the  "MX_DAEMON_STDERR"  and  "MX_DAEMON_STDOUT"
               environment  variables.  It  will  look  for a filename in either of these variables and redirect
               "STDOUT" and/or "STDERR" to those files. This is useful for debugging and/or testing purposes.

               <b>NOTE</b>

               If called from within the parent process (the "is_daemon" flag is set to false), this method will
               simply return and do nothing.

           <b>daemonize</b> <b>(?%options)</b>
               This will simply call "daemon_fork" followed by "daemon_detach".

               The %options argument remains for backwards compatibility, but it is suggested that you  use  the
               attributes listed above instead.

           <b>meta()</b>
               The "meta()" method from Class::MOP::Class

</pre><h4><b>STUFF</b> <b>YOU</b> <b>SHOULD</b> <b>READ</b></h4><pre>
       Note about double fork
           Taken  from &lt;<a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/66012">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/66012</a>&gt; in a comment entitled <u>The</u>
           <u>second</u> <u>fork</u> <b>_</b><u>is</u><b>_</b> <u>necessary</u> <u>by</u> <u>Jonathan</u> <u>Bartlett</u>, it is not the definitive statement on the issue, but
           it's clear and well written enough so I decided to reproduce it here.

             The first fork accomplishes two things - allow the shell to return,
             and allow you to do a setsid().

             The setsid() removes yourself from your controlling terminal. You
             see, before, you were still listed as a job of your previous process,
             and therefore the user might accidentally send you a signal. setsid()
             gives you a new session, and removes the existing controlling terminal.

             The problem is, you are now a session leader. As a session leader, if
             you open a file descriptor that is a terminal, it will become your
             controlling terminal (oops!). Therefore, the second fork makes you NOT
             be a session leader. Only session leaders can acquire a controlling
             terminal, so you can open up any file you wish without worrying that
             it will make you a controlling terminal.

             So - first fork - allow shell to return, and permit you to call setsid()

             Second fork - prevent you from accidentally reacquiring a controlling
             terminal.

           That said, you don't always want this to be the behavior, so you are free to specify otherwise  using
           the <u>no_double_fork</u> attribute.

       Note about zombies
           Doing  the double fork (see above) tends to get rid of your zombies since by the time you have double
           forked your daemon process is then owned by the init process. However, sometimes the  double-fork  is
           more than you really need, and you want to keep your daemon processes a little closer to you. In this
           case  you  have  to  watch  out  for  zombies,  you can avoid then by just setting the <u>ignore_zombies</u>
           attribute (see above).

</pre><h4><b>ENVIRONMENT</b> <b>VARIABLES</b></h4><pre>
       These variables are best just used for debugging and/or testing, but not used  for  actual  logging.  For
       that, you should reopen "STDOUT"/"STDERR" on your own.

       <b>MX_DAEMON_STDOUT</b>
           A filename to redirect the daemon "STDOUT" to.

       <b>MX_DAEMON_STDERR</b>
           A filename to redirect the daemon "STDERR" to.

</pre><h4><b>DEPENDENCIES</b></h4><pre>
       Moose::Role, POSIX

</pre><h4><b>INCOMPATIBILITIES</b></h4><pre>
</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Proc::Daemon

       This  code  is  based  <b>HEAVILY</b>  on  Proc::Daemon,  we  originally depended on it, but we needed some more
       flexibility, so instead we just stole the code.

</pre><h4><b>SUPPORT</b></h4><pre>
       Bugs        may        be        submitted        through        the        RT        bug         tracker
       &lt;https://rt.cpan.org/Public/Dist/Display.html?Name=MooseX-Daemonize&gt; (or <a href="mailto:bug-MooseX-Daemonize@rt.cpan.org">bug-MooseX-Daemonize@rt.cpan.org</a>
       &lt;<a href="mailto:bug-MooseX-Daemonize@rt.cpan.org">mailto:bug-MooseX-Daemonize@rt.cpan.org</a>&gt;).

       There    is    also    a    mailing    list    available    for    users   of   this   distribution,   at
       &lt;<a href="http://lists.perl.org/list/moose.html">http://lists.perl.org/list/moose.html</a>&gt;.

       There is also an irc channel available for users of this  distribution,  at  "#moose"  on  "irc.perl.org"
       &lt;irc://irc.perl.org/#moose&gt;.

</pre><h4><b>AUTHORS</b></h4><pre>
       •   Stevan Little &lt;<a href="mailto:stevan.little@iinteractive.com">stevan.little@iinteractive.com</a>&gt;

       •   Chris Prather &lt;<a href="mailto:chris@prather.org">chris@prather.org</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENCE</b></h4><pre>
       This software is copyright (c) 2007 by Chris Prather.

       This  is  free  software;  you  can  redistribute  it and/or modify it under the same terms as the Perl 5
       programming language system itself.

       Portions heavily borrowed from Proc::Daemon which is copyright Earl Hood.

perl v5.30.0                                       2019-12-22                       <u>MooseX::Daemonize::<a href="../man3pm/Core.3pm.html">Core</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>