<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>audit_fgets, audit_fgets_more, audit_fgets_eof, audit_fgets_clear - buffered line reader helpers</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libaudit-dev">libaudit-dev_4.0.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       audit_fgets, audit_fgets_more, audit_fgets_eof, audit_fgets_clear - buffered line reader helpers

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;libaudit.h&gt;</b>

       <b>int</b> <b>audit_fgets(char</b> <b>*</b><u>buf</u><b>,</b> <b>size_t</b> <u>blen</u><b>,</b> <b>int</b> <u>fd</u><b>);</b>
       <b>int</b> <b>audit_fgets_more(size_t</b> <u>blen</u><b>);</b>
       <b>int</b> <b>audit_fgets_eof(void);</b>
       <b>void</b> <b>audit_fgets_clear(void);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>audit_fgets</b>  reads  from  <u>fd</u>  into  <u>buf</u> up to <u>blen</u> bytes or through the next newline. Text is accumulated
       across calls in an internal buffer so that complete lines can be returned. The string is NUL terminated.

       <b>audit_fgets_more</b> checks whether the buffer holds a newline or at least <u>blen</u> <u>-</u> <u>1</u> bytes.

       <b>audit_fgets_eof</b> indicates whether end of file was reached on <u>fd</u>

       <b>audit_fgets_clear</b> resets the internal buffer and EOF state, discarding any stored text.

       These functions maintain static state and are therefore not thread safe.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>audit_fgets</b> returns -1 on error, 0 when no  data  is  available,  or  the  number  of  characters  copied
       otherwise.

       <b>audit_fgets_more</b> and <b>audit_fgets_eof</b> return 1 for true and 0 for false.

       <b>audit_fgets_clear</b> returns no value.

</pre><h4><b>BACKGROUND</b></h4><pre>
        The  reason that this family of functions was created is because in  auditd plugins, the event stream is
       stdin, which is  descriptor 0.  A typical pattern is to call select, poll, or epoll to wait for a  record
       to arrive. As soon as it does, you need to read it. If you  use fgets, you will wind up with big problems
       because you cannot mix  low level descriptors with high level constructs like struct FILE.   This  family
       of functions allows you to correctly work only using descriptors but with the convenience of fgets.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/fgets.3.html">fgets</a></b>(3)

Red Hat                                             May 2025                                      <u><a href="../man3/AUDIT_FGETS.3.html">AUDIT_FGETS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>