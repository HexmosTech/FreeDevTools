<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spreadsheet::ParseExcel::SaveParser - Rewrite an existing Excel file.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libspreadsheet-parseexcel-perl">libspreadsheet-parseexcel-perl_0.6600-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Spreadsheet::ParseExcel::SaveParser - Rewrite an existing Excel file.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       Say we start with an Excel file that looks like this:

           -----------------------------------------------------
          |   |      A      |      B      |      C      |
           -----------------------------------------------------
          | 1 | Hello       | ...         | ...         |  ...
          | 2 | World       | ...         | ...         |  ...
          | 3 | *Bold text* | ...         | ...         |  ...
          | 4 | ...         | ...         | ...         |  ...
          | 5 | ...         | ...         | ...         |  ...

       Then we process it with the following program:

           #!<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?perl">/usr/bin/perl</a>

           use strict;
           use warnings;

           use Spreadsheet::ParseExcel;
           use Spreadsheet::ParseExcel::SaveParser;

           # Open an existing file with SaveParser
           my $parser   = Spreadsheet::ParseExcel::SaveParser-&gt;new();
           my $template = $parser-&gt;Parse('template.xls');

           # Get the first worksheet.
           my $worksheet = $template-&gt;<a href="../man0/worksheet.0.html">worksheet</a>(0);
           my $row  = 0;
           my $col  = 0;

           # Overwrite the string in cell A1
           $worksheet-&gt;AddCell( $row, $col, 'New string' );

           # Add a new string in cell B1
           $worksheet-&gt;AddCell( $row, $col + 1, 'Newer' );

           # Add a new string in cell C1 with the format from cell A3.
           my $cell = $worksheet-&gt;get_cell( $row + 2, $col );
           my $format_number = $cell-&gt;{FormatNo};

           $worksheet-&gt;AddCell( $row, $col + 2, 'Newest', $format_number );

           # Write over the existing file or write a new file.
           $template-&gt;SaveAs('newfile.xls');

       We should now have an Excel file that looks like this:

           -----------------------------------------------------
          |   |      A      |      B      |      C      |
           -----------------------------------------------------
          | 1 | New string  | Newer       | *Newest*    |  ...
          | 2 | World       | ...         | ...         |  ...
          | 3 | *Bold text* | ...         | ...         |  ...
          | 4 | ...         | ...         | ...         |  ...
          | 5 | ...         | ...         | ...         |  ...

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The "Spreadsheet::ParseExcel::SaveParser" module rewrite an existing Excel file by reading it with
       "Spreadsheet::ParseExcel" and rewriting it with "Spreadsheet::WriteExcel".

</pre><h4><b>METHODS</b></h4><pre>
</pre><h4><b>Parser</b></h4><pre>
   <b>new()</b>
           $parse = new Spreadsheet::ParseExcel::SaveParser();

       Constructor.

   <b>Parse()</b>
           $workbook = $parse-&gt;Parse($sFileName);

           $workbook = $parse-&gt;Parse($sFileName , $formatter);

       Returns a "Workbook" object. If an error occurs, returns undef.

       The optional $formatter is a Formatter Class to format the value of cells.

</pre><h4><b>Workbook</b></h4><pre>
       The "Parse()" method returns a "Spreadsheet::ParseExcel::SaveParser::Workbook" object.

       This is a subclass of the Spreadsheet::ParseExcel::Workbook and has the following methods:

   <b>worksheets()</b>
       Returns an array of "Worksheet" objects. This was most commonly used to iterate over the worksheets in a
       workbook:

           for my $worksheet ( $workbook-&gt;worksheets() ) {
               ...
           }

   <b>worksheet()</b>
       The "worksheet()" method returns a single "Worksheet" object using either its name or index:

           $worksheet = $workbook-&gt;worksheet('Sheet1');
           $worksheet = $workbook-&gt;<a href="../man0/worksheet.0.html">worksheet</a>(0);

       Returns "undef" if the sheet name or index doesn't exist.

   <b>AddWorksheet()</b>
           $workbook = $workbook-&gt;AddWorksheet($name, %properties);

       Create a new Worksheet object of type "Spreadsheet::ParseExcel::Worksheet".

       The %properties hash contains the properties of new Worksheet.

   <b>AddFont</b>
           $workbook = $workbook-&gt;AddFont(%properties);

       Create new Font object of type "Spreadsheet::ParseExcel::Font".

       The %properties hash contains the properties of new Font.

   <b>AddFormat</b>
           $workbook = $workbook-&gt;AddFormat(%properties);

       The %properties hash contains the properties of new Font.

</pre><h4><b>Worksheet</b></h4><pre>
       Spreadsheet::ParseExcel::SaveParser::Worksheet

       Worksheet is a subclass of Spreadsheet::ParseExcel::Worksheet.  And has these methods :

       The "Worksbook::worksheet()" method returns a "Spreadsheet::ParseExcel::SaveParser::Worksheet" object.

       This is a subclass of the Spreadsheet::ParseExcel::Worksheet and has the following methods:

</pre><h4><b>AddCell</b></h4><pre>
           $workbook = $worksheet-&gt;AddCell($row, $col, $value, $format [$encoding]);

       Create new Cell object of type "Spreadsheet::ParseExcel::Cell".

       The $format parameter is the format number rather than a full format object.

       To specify just same as another cell, you can set it like below:

           $row            = 0;
           $col            = 0;
           $worksheet      = $template-&gt;<a href="../man0/worksheet.0.html">worksheet</a>(0);
           $cell           = $worksheet-&gt;get_cell( $row, $col );
           $format_number  = $cell-&gt;{FormatNo};

           $worksheet-&gt;AddCell($row +1, $coll, 'New data', $format_number);

</pre><h4><b>TODO</b></h4><pre>
       Please note that this module is currently (versions 0.50-0.60) undergoing a major restructuring and
       rewriting.

</pre><h4><b>Known</b> <b>Problems</b></h4><pre>
       You can only rewrite the features that Spreadsheet::WriteExcel supports so macros, graphs and some other
       features in the original Excel file will be lost.  Also, formulas aren't rewritten, only the result of a
       formula is written.

       Only last print area will remain. (Others will be removed)

</pre><h4><b>AUTHOR</b></h4><pre>
       Current maintainer 0.60+: Douglas Wilson <a href="mailto:dougw@cpan.org">dougw@cpan.org</a>

       Maintainer 0.40-0.59: John McNamara <a href="mailto:jmcnamara@cpan.org">jmcnamara@cpan.org</a>

       Maintainer 0.27-0.33: Gabor Szabo <a href="mailto:szabgab@cpan.org">szabgab@cpan.org</a>

       Original author: Kawai Takanori <a href="mailto:kwitknr@cpan.org">kwitknr@cpan.org</a>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2014 Douglas Wilson

       Copyright (c) 2009-2013 John McNamara

       Copyright (c) 2006-2008 Gabor Szabo

       Copyright (c) 2000-2002 Kawai Takanori and Nippon-RAD Co. OP Division

       All rights reserved.

       You may distribute under the terms of either the GNU General Public License or the Artistic License, as
       specified in the Perl README file.

perl v5.36.0                                       2024-01-01              <u>Spreadsheet::P...cel::<a href="../man3pm/SaveParser.3pm.html">SaveParser</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>