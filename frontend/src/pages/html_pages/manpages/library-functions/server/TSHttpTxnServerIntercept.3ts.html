<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSHttpTxnServerIntercept - intercept origin server requests</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/trafficserver-dev">trafficserver-dev_9.2.5+ds-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       TSHttpTxnServerIntercept - intercept origin server requests

</pre><h4><b>SYNOPSIS</b></h4><pre>
          #include &lt;ts/ts.h&gt;

       <b>void</b> <b>TSHttpTxnServerIntercept(</b><u>TSCont</u> <b>contp,</b> <u>TSHttpTxn</u> <b>txnp)</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>TSHttpTxnServerIntercept()</u>  allows  a  plugin take over the servicing of the request as though it was the
       origin server. In the event a request needs to be made to the server for transaction <u>txnp</u>, <u>contp</u> will  be
       sent  a  <u>TS_EVENT_NET_ACCEPT</u>  event.  The  <u>edata</u> passed with <u>TS_EVENT_NET_ACCEPT</u> is an <u>TSVConn</u> just as it
       would be for a normal accept. The plugin must act as if it is an HTTP server and read  the  HTTP  request
       and body from the <u>TSVConn</u> and send an HTTP response header and body.

       <u>TSHttpTxnServerIntercept()</u> must be not be called after the connection to the server has taken place. This
       means  that  the  last hook that it can be called from is <u>TS_HTTP_READ_CACHE_HDR_HOOK</u>. If a connection to
       the server is not necessary, the continuation <u>contp</u> will be sent a <u>TS_EVENT_NET_ACCEPT_FAILED</u> event  when
       the transaction completes.

       The  response from the plugin is cached subject to standard and configured HTTP caching rules. Should the
       plugin wish the response not be cached, the plugin must use appropriate HTTP response headers to  prevent
       caching.  The primary purpose of <u>TSHttpTxnServerIntercept()</u> is allow plugins to provide gateways to other
       protocols  or  to  allow  one  to  plugin  to  its  own  transport  for  the  next  hop  to  the  server.
       <u>TSHttpTxnServerIntercept()</u> overrides parent cache configuration.

       <u>TSHttpTxnServerIntercept()</u>  must  only  be  called once per transaction. The continuation <u>contp</u> must have
       been created with a valid <u>TSMutex</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3ts/TSAPI.3ts.html">TSAPI</a>(3ts)</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2025, <a href="mailto:dev@trafficserver.apache.org">dev@trafficserver.apache.org</a>

9.2                                               May 22, 2025                     <u><a href="../man3ts/TSHTTPTXNSERVERINTERCEPT.3ts.html">TSHTTPTXNSERVERINTERCEPT</a></u>(3ts)
</pre>
 </div>
</div></section>
</div>
</body>
</html>