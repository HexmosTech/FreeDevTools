<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mojo::Server::Daemon - Non-blocking I/O HTTP and WebSocket server</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmojolicious-perl">libmojolicious-perl_9.39+dfsg-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mojo::Server::Daemon - Non-blocking I/O HTTP and WebSocket server

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Mojo::Server::Daemon;

         my $daemon = Mojo::Server::Daemon-&gt;new(listen =&gt; ['http://*:8080']);
         $daemon-&gt;unsubscribe('request')-&gt;on(request =&gt; sub ($daemon, $tx) {

           # Request
           my $method = $tx-&gt;req-&gt;method;
           my $path   = $tx-&gt;req-&gt;url-&gt;path;

           # Response
           $tx-&gt;res-&gt;<a href="../man200/code.200.html">code</a>(200);
           $tx-&gt;res-&gt;headers-&gt;content_type('text/plain');
           $tx-&gt;res-&gt;body("$method request for $path!");

           # Resume transaction
           $tx-&gt;resume;
         });
         $daemon-&gt;run;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Mojo::Server::Daemon is a full featured, highly portable non-blocking I/O HTTP and WebSocket server, with
       IPv6, TLS, SNI, Comet (long polling), keep-alive and multiple event loop support.

       For better scalability (epoll, kqueue) and to provide non-blocking name resolution, SOCKS5 as well as TLS
       support, the optional modules EV (4.32+), Net::DNS::Native (0.15+), IO::Socket::Socks (0.64+) and
       IO::Socket::SSL (2.009+) will be used automatically if possible. Individual features can also be disabled
       with the "MOJO_NO_NNR", "MOJO_NO_SOCKS" and "MOJO_NO_TLS" environment variables.

       See "DEPLOYMENT" in Mojolicious::Guides::Cookbook for more.

</pre><h4><b>SIGNALS</b></h4><pre>
       The Mojo::Server::Daemon process can be controlled at runtime with the following signals.

   <b>INT,</b> <b>TERM</b>
       Shut down server immediately.

</pre><h4><b>EVENTS</b></h4><pre>
       Mojo::Server::Daemon inherits all events from Mojo::Server.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       Mojo::Server::Daemon inherits all attributes from Mojo::Server and implements the following new ones.

   <b>acceptors</b>
         my $acceptors = $daemon-&gt;acceptors;
         $daemon       = $daemon-&gt;acceptors(['6be0c140ef00a389c5d039536b56d139']);

       Active acceptor ids.

         # Check port
         mu $port = $daemon-&gt;ioloop-&gt;acceptor($daemon-&gt;acceptors-&gt;[0])-&gt;port;

   <b>backlog</b>
         my $backlog = $daemon-&gt;backlog;
         $daemon     = $daemon-&gt;<a href="../man128/backlog.128.html">backlog</a>(128);

       Listen backlog size, defaults to "SOMAXCONN".

   <b>inactivity_timeout</b>
         my $timeout = $daemon-&gt;inactivity_timeout;
         $daemon     = $daemon-&gt;<a href="../man5/inactivity_timeout.5.html">inactivity_timeout</a>(5);

       Maximum amount of time in seconds a connection with an active request can be inactive before getting
       closed, defaults to the value of the "MOJO_INACTIVITY_TIMEOUT" environment variable or 30. Setting the
       value to 0 will allow connections to be inactive indefinitely.

   <b>ioloop</b>
         my $loop = $daemon-&gt;ioloop;
         $daemon  = $daemon-&gt;ioloop(Mojo::IOLoop-&gt;new);

       Event loop object to use for I/O operations, defaults to the global Mojo::IOLoop singleton.

   <b>keep_alive_timeout</b>
         my $timeout = $daemon-&gt;keep_alive_timeout;
         $daemon     = $daemon-&gt;<a href="../man10/keep_alive_timeout.10.html">keep_alive_timeout</a>(10);

       Maximum amount of time in seconds a connection without an active request can be inactive before getting
       closed, defaults to the value of the "MOJO_KEEP_ALIVE_TIMEOUT" environment variable or 5. Setting the
       value to 0 will allow connections to be inactive indefinitely.

   <b>listen</b>
         my $listen = $daemon-&gt;listen;
         $daemon    = $daemon-&gt;listen(['https://127.0.0.1:8080']);

       Array reference with one or more locations to listen on, defaults to the value of the "MOJO_LISTEN"
       environment variable or "http://*:3000" (shortcut for "<a href="http://0.0.0.0">http://0.0.0.0</a>:3000").

         # Listen on all IPv4 interfaces
         $daemon-&gt;listen(['http://*:3000']);

         # Listen on all IPv4 and IPv6 interfaces
         $daemon-&gt;listen(['http://[::]:3000']);

         # Listen on IPv6 interface
         $daemon-&gt;listen(['http://[::1]:4000']);

         # Listen on IPv4 and IPv6 interfaces
         $daemon-&gt;listen(['<a href="http://127.0.0.1">http://127.0.0.1</a>:3000', 'http://[::1]:3000']);

         # Listen on UNIX domain socket "/tmp/myapp.sock" (percent encoded slash)
         $daemon-&gt;listen(['http+unix://%2Ftmp%2Fmyapp.sock']);

         # File descriptor, as used by systemd
         $daemon-&gt;listen(['<a href="http://127.0.0.1">http://127.0.0.1</a>?fd=3']);

         # Allow multiple servers to use the same port (SO_REUSEPORT)
         $daemon-&gt;listen(['http://*:8080?reuse=1']);

         # Listen on two ports with HTTP and HTTPS at the same time
         $daemon-&gt;listen(['http://*:3000', 'https://*:4000']);

         # Use a custom certificate and key
         $daemon-&gt;listen(['https://*:3000?cert=/x/server.crt&amp;key=/y/server.key']);

         # Domain specific certificates and keys (SNI)
         $daemon-&gt;listen(
           ['https://*:3000?example.com_cert=/x/my.crt&amp;example.com_key=/y/my.key']);

         # Or even a custom certificate authority
         $daemon-&gt;listen(
           ['https://*:3000?cert=/x/server.crt&amp;key=/y/server.key&amp;ca=/z/ca.crt']);

       These parameters are currently available:

       ca
           ca=/etc/tls/ca.crt

         Path to TLS certificate authority file used to verify the peer certificate.

       cert
           cert=/etc/tls/server.crt
           mojolicious.org_cert=/etc/tls/mojo.crt

         Path to the TLS cert file, defaults to a built-in test certificate.

       ciphers
           ciphers=AES128-GCM-SHA256:RC4:HIGH:!MD5:!aNULL:!EDH

         TLS    cipher    specification    string.    For    more    information    about    the    format   see
         &lt;https://www.openssl.org/docs/manmaster/man1/ciphers.html#CIPHER-STRINGS&gt;.

       fd
           fd=3

         File descriptor with an already prepared listen socket.

       key
           key=/etc/tls/server.key
           mojolicious.org_key=/etc/tls/mojo.key

         Path to the TLS key file, defaults to a built-in test key.

       reuse
           reuse=1

         Allow multiple servers to use the same port with the "SO_REUSEPORT" socket option.

       single_accept
           single_accept=1

         Only accept one connection at a time.

       verify
           verify=0x00

         TLS verification mode.

       version
           version=TLSv1_2

         TLS protocol version.

   <b>max_clients</b>
         my $max = $daemon-&gt;max_clients;
         $daemon = $daemon-&gt;<a href="../man100/max_clients.100.html">max_clients</a>(100);

       Maximum number of accepted connections this server is allowed to handle concurrently, before stopping  to
       accept new incoming connections, passed along to "max_connections" in Mojo::IOLoop.

   <b>max_requests</b>
         my $max = $daemon-&gt;max_requests;
         $daemon = $daemon-&gt;<a href="../man250/max_requests.250.html">max_requests</a>(250);

       Maximum number of keep-alive requests per connection, defaults to 100.

   <b>silent</b>
         my $bool = $daemon-&gt;silent;
         $daemon  = $daemon-&gt;silent($bool);

       Disable console messages.

</pre><h4><b>METHODS</b></h4><pre>
       Mojo::Server::Daemon inherits all methods from Mojo::Server and implements the following new ones.

   <b>ports</b>
         my $ports = $daemon-&gt;ports;

       Get all ports this server is currently listening on.

         # All ports
         say for @{$daemon-&gt;ports};

   <b>run</b>
         $daemon-&gt;run;

       Run server and wait for "SIGNALS".

   <b>start</b>
         $daemon = $daemon-&gt;start;

       Start or resume accepting connections through "ioloop".

         # Listen on random port
         my $port = $daemon-&gt;listen(['<a href="http://127.0.0.1">http://127.0.0.1</a>'])-&gt;start-&gt;ports-&gt;[0];

         # Run multiple web servers concurrently
         my $daemon1 = Mojo::Server::Daemon-&gt;new(listen =&gt; ['http://*:3000'])-&gt;start;
         my $daemon2 = Mojo::Server::Daemon-&gt;new(listen =&gt; ['http://*:4000'])-&gt;start;
         Mojo::IOLoop-&gt;start unless Mojo::IOLoop-&gt;is_running;

   <b>stop</b>
         $daemon = $daemon-&gt;stop;

       Stop accepting connections through "ioloop".

</pre><h4><b>DEBUGGING</b></h4><pre>
       You  can  set  the  "MOJO_SERVER_DEBUG" environment variable to get some advanced diagnostics information
       printed to "STDERR".

         MOJO_SERVER_DEBUG=1

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Mojolicious, Mojolicious::Guides, &lt;https://mojolicious.org&gt;.

perl v5.40.0                                       2024-12-07                          <u>Mojo::Server::<a href="../man3pm/Daemon.3pm.html">Daemon</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>