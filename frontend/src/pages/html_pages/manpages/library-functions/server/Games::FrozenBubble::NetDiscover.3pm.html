<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copyright © 2010 The Frozen-Bubble Team</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/frozen-bubble">frozen-bubble_2.212-13build1_amd64</a> <br><br><pre>
</pre><h4><b>Frozen-Bubble</b></h4><pre>
       Copyright © 2010 The Frozen-Bubble Team

       This program is free software; you can redistribute it and/or modify it under the terms of the GNU
       General Public License version 2, as published by the Free Software Foundation.

       This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
       the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
       License for more details.

       You should have received a copy of the GNU General Public License along with this program; if not, write
       to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.

</pre><h4><b>NAME</b></h4><pre>
       Games::FrozenBubble::NetDiscover - high performance server discovery plugin for frozen bubble

</pre><h4><b>SYNOPSIS</b></h4><pre>
           my $discover = Games::FrozenBubble::NetDiscover-&gt;new(
               { host =&gt; "1.2.3.4", port =&gt; 1511 },
               { host =&gt; "5.6.7.8", port =&gt; 1512 }, ...);
           while($discover-&gt;pending()) {
               my @servers = $discover-&gt;found();
               for(my $server = 0; $server &lt; @servers; $server++) {
                   printf("%02i: ip %s ping %i\n",
                       $server, $servers[$server]{ip}, $servers[$server]{ping});
               }
               $discover-&gt;work(0.1); # sit in a select loop for 100ms

               # update your screen, and all of that stuff, here.
           }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Games::FrozenBubble::NetDiscover checks a list of servers, finding their versions, ping times, and number
       of current clients.  It uses nonblocking IO and select, to connect to multiple servers in parallel, thus
       reducing the total amount of time elapsed.  This, in turn, allows the user to begin playing frozen bubble
       more quickly. :)

       This module is designed to be called from a GUI loop.  It has to spend sit in a select loop for most of
       its life in order to get accurate ping times, but it will return back to your loop at intervals you
       specify, so you can check for keystrokes and refresh the screen and so forth.

       In order to get consistent results on slow dialup links, this module will only attempt to connect to one
       server per each 200ms.  This means for 18 servers that there are 3.4 seconds of extra guaranteed lag, but
       it also means packets from multiple servers are less likely to bump into eachother in the queue, so ping
       reply times will be more reliable.

       In the source script, there are two configuration parameters: $number_of_pings and
       $time_between_connections.  These are set to 2 and 0.2, respectively.  These two parameters will
       determine the amount of bandwidth used, and the amount of time taken before the user can select a server.
       Assuming the user's internet connection can handle the traffic without extra latency from queueing or
       retransmissions, the worst case latency will be, in seconds:

           N*L + T*(S-1)

       where

           N = $number_of_pings
           L = the roundtrip time of the slowest server in the list, in seconds
           T = $time_between_connections
           S = the number of servers in the list

</pre><h4><b>CONSTRUCTOR</b></h4><pre>
           ...-&gt;new ({host =&gt; "server1", port =&gt; port}, {host =&gt; "server2", port =&gt; port}, ...)

       Takes a list of servers as arguments.  Each server argument should be a hash reference, consisting of
       {host =&gt; host, port =&gt; port}.  Returns a Games::FrozenBubble::NetDiscover object, which can be used
       within a GUI loop to discover all of your servers.

       The host string should ideally be an IP address.  A hostname string should work too, but DNS lookups will
       introduce extra, unpredictable latency later on.

</pre><h4><b>METHODS</b></h4><pre>
       These methods define the public API for instances of this class.

   <b>found</b>
       Returns a list of 0 or more servers found.  Each return value is a hash reference, containing the
       following keys:

           host: the IP address of the server
           port: the TCP port of the server
           pingtimes: array reference, contains the actual result times of 4 pings
           ping: the average roundtrip latency of the server, in ms
           freenicks: the list of players connected
           freegames: the list of open games (not yet started)
           free: the number of idle clients connected to this server
           games: the number of clients connected to this server, who are playing games
           playing: the list of players in games
           geolocs: the geolocations of players in games
           name: the self-proclaimed "name" reported by the server
           language: the preferred language reported by the server

   <b>pending</b>
       Returns non-zero if we are still waiting for a response from one or more servers; returns 0 if processing
       is complete.

   <b>work(seconds)</b>
       Enters the main loop of this module.  This method requires one argument, a numeric count of seconds to
       work for.  This is expected to be a floating point decimal, for sub-second precision.  Returns the number
       of servers pending, just like the pending method does.

</pre><h4><b>INTERNAL</b> <b>METHODS</b></h4><pre>
       These methods are only meant to be called from within the module.  They are subject to change without
       notice.

   <b>try_connect</b>
       Attempts to connect to a server.  Moves the first "not_started" server to the "pending" list, and creates
       a non-blocking IO::Socket::INET object for it.  Updates the begin_time timestamp, to determine when the
       next server should be connected.

   <b>server_sm(connection_number)</b>
       Implements a simple state machine.  Called with an index into the pending array, to indicate that data is
       available for reading from this server.

   <b>give_up_on(connection_number,</b> <b>reason)</b>
       Called if select reports a socket as has_exception.  Also called if the server has a bogus version, times
       out, or we can't parse the IP address or something.  Removes the entry from further processing, and emits
       an error message on stderr.

</pre><h4><b>EXPORT</b></h4><pre>
       None.

</pre><h4><b>BUGS</b></h4><pre>
       implement some sort of timeout, for servers which don't respond within 5 seconds.

</pre><h4><b>AUTHOR</b></h4><pre>
       Mark Glines, &lt;<a href="mailto:mark@glines.org">mark@glines.org</a>&gt;.

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       This code is donated to the frozen bubble project, www.frozen-bubble.org, so they can do whatever they
       want with it.  Copyright is therefore assigned to those guys.

perl v5.40.0                                       2024-10-20              <u>Games::FrozenBubble::<a href="../man3pm/NetDiscover.3pm.html">NetDiscover</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>