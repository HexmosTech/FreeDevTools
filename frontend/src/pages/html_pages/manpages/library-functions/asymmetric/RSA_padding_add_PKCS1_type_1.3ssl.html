<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA_padding_add_PKCS1_type_1, RSA_padding_check_PKCS1_type_1, RSA_padding_add_PKCS1_type_2,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       RSA_padding_add_PKCS1_type_1, RSA_padding_check_PKCS1_type_1, RSA_padding_add_PKCS1_type_2,
       RSA_padding_check_PKCS1_type_2, RSA_padding_add_PKCS1_OAEP, RSA_padding_check_PKCS1_OAEP,
       RSA_padding_add_PKCS1_OAEP_mgf1, RSA_padding_check_PKCS1_OAEP_mgf1, RSA_padding_add_none,
       RSA_padding_check_none - asymmetric encryption padding

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/rsa.h&gt;

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        int RSA_padding_add_PKCS1_type_1(unsigned char *to, int tlen,
                                         const unsigned char *f, int fl);

        int RSA_padding_check_PKCS1_type_1(unsigned char *to, int tlen,
                                           const unsigned char *f, int fl, int rsa_len);

        int RSA_padding_add_PKCS1_type_2(unsigned char *to, int tlen,
                                         const unsigned char *f, int fl);

        int RSA_padding_check_PKCS1_type_2(unsigned char *to, int tlen,
                                           const unsigned char *f, int fl, int rsa_len);

        int RSA_padding_add_PKCS1_OAEP(unsigned char *to, int tlen,
                                       const unsigned char *f, int fl,
                                       const unsigned char *p, int pl);

        int RSA_padding_check_PKCS1_OAEP(unsigned char *to, int tlen,
                                         const unsigned char *f, int fl, int rsa_len,
                                         const unsigned char *p, int pl);

        int RSA_padding_add_PKCS1_OAEP_mgf1(unsigned char *to, int tlen,
                                            const unsigned char *f, int fl,
                                            const unsigned char *p, int pl,
                                            const EVP_MD *md, const EVP_MD *mgf1md);

        int RSA_padding_check_PKCS1_OAEP_mgf1(unsigned char *to, int tlen,
                                              const unsigned char *f, int fl, int rsa_len,
                                              const unsigned char *p, int pl,
                                              const EVP_MD *md, const EVP_MD *mgf1md);

        int RSA_padding_add_none(unsigned char *to, int tlen,
                                 const unsigned char *f, int fl);

        int RSA_padding_check_none(unsigned char *to, int tlen,
                                   const unsigned char *f, int fl, int rsa_len);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       All of the functions described on this page are deprecated.  Applications should instead use the EVP PKEY
       APIs.

       The <b>RSA_padding_xxx_xxx()</b> functions are called from the RSA encrypt, decrypt, sign and verify functions.
       Normally they should not be called from application programs.

       However, they can also be called directly to implement padding for other asymmetric ciphers.
       <b>RSA_padding_add_PKCS1_OAEP()</b> and <b>RSA_padding_check_PKCS1_OAEP()</b> may be used in an application combined
       with <b>RSA_NO_PADDING</b> in order to implement OAEP with an encoding parameter.

       <b>RSA_padding_add_xxx()</b> encodes <b>fl</b> bytes from <b>f</b> so as to fit into <b>tlen</b> bytes and stores the result at <b>to</b>.
       An error occurs if <b>fl</b> does not meet the size requirements of the encoding method.

       The following encoding methods are implemented:

       PKCS1_type_1
           PKCS #1 v2.0 EMSA-PKCS1-v1_5 (PKCS #1 v1.5 block type 1); used for signatures

       PKCS1_type_2
           PKCS #1 v2.0 EME-PKCS1-v1_5 (PKCS #1 v1.5 block type 2)

       PKCS1_OAEP
           PKCS #1 v2.0 EME-OAEP

       none
           simply copy the data

       The  random  number  generator  must  be seeded prior to calling <b>RSA_padding_add_xxx()</b>.  If the automatic
       seeding or reseeding of the OpenSSL CSPRNG  fails  due  to  external  circumstances  (see  <b><a href="../man7/RAND.7.html">RAND</a></b>(7)),  the
       operation will fail.

       <b>RSA_padding_check_xxx()</b>  verifies  that the <b>fl</b> bytes at <b>f</b> contain a valid encoding for a <b>rsa_len</b> byte RSA
       key in the respective encoding method  and  stores  the  recovered  data  of  at  most  <b>tlen</b>  bytes  (for
       <b>RSA_NO_PADDING</b>: of size <b>tlen</b>) at <b>to</b>.

       For <b>RSA_padding_xxx_OAEP()</b>, <b>p</b> points to the encoding parameter of length <b>pl</b>. <b>p</b> may be <b>NULL</b> if <b>pl</b> is 0.

       For  <b>RSA_padding_xxx_OAEP_mgf1()</b>,  <b>md</b> points to the md hash, if <b>md</b> is <b>NULL</b> that means md=sha1, and <b>mgf1md</b>
       points to the mgf1 hash, if <b>mgf1md</b> is <b>NULL</b> that means mgf1md=md.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The <b>RSA_padding_add_xxx()</b> functions return  1  on  success,  0  on  error.   The  <b>RSA_padding_check_xxx()</b>
       functions  return  the  length of the recovered data, -1 on error. Error codes can be obtained by calling
       <b><a href="../man3/ERR_get_error.3.html">ERR_get_error</a></b>(3).

</pre><h4><b>WARNINGS</b></h4><pre>
       The result of <b>RSA_padding_check_PKCS1_type_2()</b> is exactly the  information  which  is  used  to  mount  a
       classical  Bleichenbacher padding oracle attack. This is an inherent weakness in the PKCS #1 v1.5 padding
       design.   Prefer    PKCS1_OAEP    padding.    If    that    is    not    possible,    the    result    of
       <b>RSA_padding_check_PKCS1_type_2()</b>  should be checked in constant time if it matches the expected length of
       the plaintext and additionally some application specific consistency checks on the plaintext need  to  be
       performed  in  constant  time.   If  the plaintext is rejected it must be kept secret which of the checks
       caused the application to reject the message.  Do not remove the zero-padding from the decrypted raw  RSA
       data which was computed by <b>RSA_private_decrypt()</b> with <b>RSA_NO_PADDING</b>, as this would create a small timing
       side  channel  which  could  be  used to mount a Bleichenbacher attack against any padding mode including
       PKCS1_OAEP.

       You should prefer the use of EVP PKEY APIs for PKCS#1 v1.5 decryption as  they  implement  the  necessary
       workarounds internally.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/RSA_public_encrypt.3.html">RSA_public_encrypt</a></b>(3), <b><a href="../man3/RSA_private_decrypt.3.html">RSA_private_decrypt</a></b>(3), <b><a href="../man3/RSA_sign.3.html">RSA_sign</a></b>(3), <b><a href="../man3/RSA_verify.3.html">RSA_verify</a></b>(3), <b><a href="../man7/RAND.7.html">RAND</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       All of these functions were deprecated in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                 <u><a href="../man3SSL/RSA_PADDING_ADD_PKCS1_TYPE_1.3SSL.html">RSA_PADDING_ADD_PKCS1_TYPE_1</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>