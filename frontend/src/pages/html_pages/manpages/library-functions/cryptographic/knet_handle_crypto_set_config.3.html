<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>knet_handle_crypto_set_config - set up packet cryptographic signing & encryption</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libknet-doc">libknet-doc_1.31-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       knet_handle_crypto_set_config - set up packet cryptographic signing &amp; encryption

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;libknet.h&gt;</b>

       <b>int</b> <b>knet_handle_crypto_set_config</b>(
           <b>knet_handle_t</b>                    <u>knet_h</u>,
           <b>struct</b> <b>knet_handle_crypto_cfg</b>   <b>*</b><u>knet_handle_crypto_cfg</u>,
           <b>uint8_t</b>                          <u>config_num</u>
       );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       knet_handle_crypto_set_config

       knet_h - pointer to knet_handle_t

       knet_handle_crypto_cfg - pointer to a knet_handle_crypto_cfg structure

       crypto_model  should contain the model name. Currently only "openssl" and "nss" are supported. Setting to
       "none" will disable crypto.

       crypto_cipher_type should contain the cipher algo name. It can be set to "none"  to  disable  encryption.
       Currently  supported by "nss" model: "aes128", "aes192" and "aes256". "openssl" model supports more modes
       and it strictly depends on the openssl build. See: EVP_get_cipherbyname openssl API call for details.

       crypto_hash_type should contain the hashing algo name. It can  be  set  to  "none"  to  disable  hashing.
       Currently  supported  by  "nss"  model:  "md5",  "sha1", "sha256", "sha384" and "sha512". "openssl" model
       supports more modes and it strictly depends on the openssl build. See: EVP_get_digestbyname  openssl  API
       call for details.

       private_key will contain the private shared key. It has to be at least KNET_MIN_KEY_LEN long.

       private_key_len length of the provided private_key.

       config_num  - knet supports 2 concurrent sets of crypto configurations, to allow runtime change of crypto
       config and keys. On RX both configurations will be used sequentially in an attempt to decrypt/validate  a
       packet  (when  2 are available). Note that this might slow down performance during a reconfiguration. See
       also <a href="../man3/knet_handle_crypto_rx_clear_traffic.3.html">knet_handle_crypto_rx_clear_traffic</a>(3)  to  enable  /  disable  processing  of  clear  (unencrypted)
       traffic.    For    TX,    the    user    needs    to    specify    which   configuration   to   use   via
       <a href="../man3/knet_handle_crypto_use_config.3.html">knet_handle_crypto_use_config</a>(3). config_num accepts 0, 1 or 2 as the value. 0 should be  used  when  all
       crypto  is  being  disabled. Calling <a href="../man3/knet_handle_crypto_set_config.3.html">knet_handle_crypto_set_config</a>(3) twice with the same config_num will
       REPLACE the configuration and NOT activate the second key. If the configuration is currently in use EBUSY
       will be returned. See also <a href="../man3/knet_handle_crypto_use_config.3.html">knet_handle_crypto_use_config</a>(3). The correct sequence to  perform  a  runtime
       rekey / reconfiguration is:knet_handle_crypto_set_config(..., 1). -&gt; first time config, will use config1

       knet_handle_crypto_use_config(..., 1). -&gt; switch TX to config 1

       knet_handle_crypto_set_config(..., 2). -&gt; install config2 and use it only for RX

       knet_handle_crypto_use_config(..., 2). -&gt; switch TX to config 2

       knet_handle_crypto_set_config(...,  1).  -&gt;  with  a  "none"/"none"/"none"  configuration  to release the
       resources previously allocated The application is responsible for synchronizing calls  on  the  nodes  to
       make  sure the new config is in place before switching the TX configuration. Failure to do so will result
       in knet being unable to talk to some of the nodes.

       Implementation notes/current limitations:enabling crypto,  will  increase  latency  as  packets  have  to
       processed.

       enabling crypto might reduce the overall throughtput due to crypto data overhead.

       private/public key encryption/hashing is not currently planned.

       crypto key must be the same for all hosts in the same knet instance / configX.

       it is safe to call knet_handle_crypto_set_config multiple times at runtime. The last config will be used.
       IMPORTANT:  a  call  to  knet_handle_crypto_set_config  can  fail due to: 1) failure to obtain locking 2)
       errors  to  initializing  the  crypto  level.   This   can   happen   even   in   subsequent   calls   to
       <a href="../man3/knet_handle_crypto_set_config.3.html">knet_handle_crypto_set_config</a>(3). A failure in crypto init will restore the previous crypto configuration
       if any.

</pre><h4><b>STRUCTURES</b></h4><pre>
       Structure passed into knet_handle_set_crypto_config() to determine the crypto options to use for the current communications handle

       <b>struct</b> <b>knet_handle_crypto_cfg</b> <b>{</b>
           <b>char</b>           <u>crypto_model[16]</u><b>;</b>               /* Model to use. nss, openssl, etc */
           <b>char</b>           <u>crypto_cipher_type[16]</u><b>;</b>         /* Cipher type name for encryption. aes 256 etc */
           <b>char</b>           <u>crypto_hash_type[16]</u><b>;</b>           /* Hash type for digest. sha512 etc */
           <b>unsigned</b> <b>char</b>  <u>private_key[KNET_MAX_KEY_LEN]</u><b>;</b>  /* Private key */
           <b>unsigned</b> <b>int</b>   <u>private_key_len</u><b>;</b>                /* Length of private key */
       };

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       knet_handle_crypto_set_config returns:

       <b>0</b>          on success

       <b>-1</b>         on error and errno is set.

       <b>-2</b>         on crypto subsystem initialization error. No errno is provided at the moment (yet).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/knet_handle_remove_datafd.3.html">knet_handle_remove_datafd</a></u>(3), <u><a href="../man3/knet_handle_get_stats.3.html">knet_handle_get_stats</a></u>(3), <u><a href="../man3/knet_host_add.3.html">knet_host_add</a></u>(3), <u><a href="../man3/knet_handle_pmtud_setfreq.3.html">knet_handle_pmtud_setfreq</a></u>(3),
       <u><a href="../man3/knet_handle_pmtud_get.3.html">knet_handle_pmtud_get</a></u>(3), <u><a href="../man3/knet_handle_crypto_use_config.3.html">knet_handle_crypto_use_config</a></u>(3), <u><a href="../man3/knet_host_get_id_by_host_name.3.html">knet_host_get_id_by_host_name</a></u>(3),
       <u><a href="../man3/knet_host_get_status.3.html">knet_host_get_status</a></u>(3), <u><a href="../man3/knet_link_add_acl.3.html">knet_link_add_acl</a></u>(3), <u><a href="../man3/knet_link_get_pong_count.3.html">knet_link_get_pong_count</a></u>(3), <u><a href="../man3/knet_link_get_priority.3.html">knet_link_get_priority</a></u>(3),
       <u><a href="../man3/knet_handle_free.3.html">knet_handle_free</a></u>(3), <u><a href="../man3/knet_handle_enable_sock_notify.3.html">knet_handle_enable_sock_notify</a></u>(3), <u><a href="../man3/knet_handle_get_datafd.3.html">knet_handle_get_datafd</a></u>(3), <u><a href="../man3/knet_recv.3.html">knet_recv</a></u>(3),
       <u><a href="../man3/knet_link_get_ping_timers.3.html">knet_link_get_ping_timers</a></u>(3), <u><a href="../man3/knet_log_get_subsystem_id.3.html">knet_log_get_subsystem_id</a></u>(3), <u><a href="../man3/knet_host_remove.3.html">knet_host_remove</a></u>(3),
       <u><a href="../man3/knet_host_enable_status_change_notify.3.html">knet_host_enable_status_change_notify</a></u>(3), <u><a href="../man3/knet_strtoaddr.3.html">knet_strtoaddr</a></u>(3), <u><a href="../man3/knet_link_rm_acl.3.html">knet_link_rm_acl</a></u>(3), <u><a href="../man3/knet_send.3.html">knet_send</a></u>(3),
       <u><a href="../man3/knet_handle_enable_pmtud_notify.3.html">knet_handle_enable_pmtud_notify</a></u>(3), <u><a href="../man3/knet_handle_get_transport_reconnect_interval.3.html">knet_handle_get_transport_reconnect_interval</a></u>(3),
       <u><a href="../man3/knet_link_get_enable.3.html">knet_link_get_enable</a></u>(3), <u><a href="../man3/knet_link_set_priority.3.html">knet_link_set_priority</a></u>(3), <u><a href="../man3/knet_log_set_loglevel.3.html">knet_log_set_loglevel</a></u>(3), <u><a href="../man3/knet_handle_get_channel.3.html">knet_handle_get_channel</a></u>(3),
       <u><a href="../man3/knet_link_get_config.3.html">knet_link_get_config</a></u>(3), <u><a href="../man3/knet_link_get_link_list.3.html">knet_link_get_link_list</a></u>(3), <u><a href="../man3/knet_get_transport_list.3.html">knet_get_transport_list</a></u>(3),
       <u><a href="../man3/knet_get_transport_id_by_name.3.html">knet_get_transport_id_by_name</a></u>(3), <u><a href="../man3/knet_log_get_loglevel_id.3.html">knet_log_get_loglevel_id</a></u>(3), <u><a href="../man3/knet_handle_new_ex.3.html">knet_handle_new_ex</a></u>(3),
       <u><a href="../man3/knet_host_set_name.3.html">knet_host_set_name</a></u>(3), <u><a href="../man3/knet_addrtostr.3.html">knet_addrtostr</a></u>(3), <u><a href="../man3/knet_handle_setfwd.3.html">knet_handle_setfwd</a></u>(3), <u><a href="../man3/knet_get_compress_list.3.html">knet_get_compress_list</a></u>(3),
       <u><a href="../man3/knet_host_set_policy.3.html">knet_host_set_policy</a></u>(3), <u><a href="../man3/knet_get_transport_name_by_id.3.html">knet_get_transport_name_by_id</a></u>(3), <u><a href="../man3/knet_handle_enable_filter.3.html">knet_handle_enable_filter</a></u>(3),
       <u><a href="../man3/knet_handle_crypto_rx_clear_traffic.3.html">knet_handle_crypto_rx_clear_traffic</a></u>(3), <u><a href="../man3/knet_handle_compress.3.html">knet_handle_compress</a></u>(3), <u><a href="../man3/knet_link_get_status.3.html">knet_link_get_status</a></u>(3),
       <u><a href="../man3/knet_handle_add_datafd.3.html">knet_handle_add_datafd</a></u>(3), <u><a href="../man3/knet_send_sync.3.html">knet_send_sync</a></u>(3), <u><a href="../man3/knet_log_get_loglevel_name.3.html">knet_log_get_loglevel_name</a></u>(3),
       <u><a href="../man3/knet_handle_enable_access_lists.3.html">knet_handle_enable_access_lists</a></u>(3), <u><a href="../man3/knet_host_get_host_list.3.html">knet_host_get_host_list</a></u>(3), <u><a href="../man3/knet_host_get_policy.3.html">knet_host_get_policy</a></u>(3),
       <u><a href="../man3/knet_link_set_enable.3.html">knet_link_set_enable</a></u>(3), <u><a href="../man3/knet_link_set_pong_count.3.html">knet_link_set_pong_count</a></u>(3), <u><a href="../man3/knet_log_get_subsystem_name.3.html">knet_log_get_subsystem_name</a></u>(3),
       <u><a href="../man3/knet_host_get_name_by_host_id.3.html">knet_host_get_name_by_host_id</a></u>(3), <u><a href="../man3/knet_link_clear_config.3.html">knet_link_clear_config</a></u>(3), <u><a href="../man3/knet_log_get_loglevel.3.html">knet_log_get_loglevel</a></u>(3),
       <u><a href="../man3/knet_handle_new.3.html">knet_handle_new</a></u>(3), <u><a href="../man3/knet_handle_pmtud_getfreq.3.html">knet_handle_pmtud_getfreq</a></u>(3), <u><a href="../man3/knet_handle_pmtud_set.3.html">knet_handle_pmtud_set</a></u>(3), <u><a href="../man3/knet_handle_clear_stats.3.html">knet_handle_clear_stats</a></u>(3),
       <u><a href="../man3/knet_link_set_config.3.html">knet_link_set_config</a></u>(3), <u><a href="../man3/knet_handle_crypto.3.html">knet_handle_crypto</a></u>(3), <u><a href="../man3/knet_get_crypto_list.3.html">knet_get_crypto_list</a></u>(3),
       <u><a href="../man3/knet_handle_set_transport_reconnect_interval.3.html">knet_handle_set_transport_reconnect_interval</a></u>(3), <u><a href="../man3/knet_link_clear_acl.3.html">knet_link_clear_acl</a></u>(3), <u><a href="../man3/knet_link_set_ping_timers.3.html">knet_link_set_ping_timers</a></u>(3),
       <u><a href="../man3/knet_link_insert_acl.3.html">knet_link_insert_acl</a></u>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2010-2025 Red Hat, Inc. All rights reserved.

kronosnet                                          2025-04-24                   <u><a href="../man3/KNET_HANDLE_CRYPTO_SET_CONFIG.3.html">KNET_HANDLE_CRYPTO_SET_CONFIG</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>