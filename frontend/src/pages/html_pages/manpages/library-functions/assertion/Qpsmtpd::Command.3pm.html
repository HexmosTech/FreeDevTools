<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qpsmtpd::Command - parse arguments to SMTP commands</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/qpsmtpd">qpsmtpd_0.94-8_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Qpsmtpd::Command - parse arguments to SMTP commands

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Qpsmtpd::Command</b> provides just one public sub routine: <b>parse()</b>.

       This sub expects two or three arguments. The first is the name of the SMTP command (such as <u>HELO</u>, <u>MAIL</u>,
       ...). The second must be the remaining of the line the client sent.

       If no third argument is given (or it's not a reference to a CODE) it parses the line according to RFC
       1869 (SMTP Service Extensions) for the <u>MAIL</u> and <u>RCPT</u> commands and splitting by spaces (" ") for all
       other.

       Any module can supply it's own parsing routine by returning a sub routine reference from a hook_*_parse.
       This sub will be called with <u>$self</u>, <u>$cmd</u> and <u>$line</u>.

       On successfull parsing it MUST return <b>OK</b> (the constant from <u>Qpsmtpd::Constants</u>) success as first argument
       and a list of values, which will be the arguments to the hook for this command.

       If parsing failed, the second returned value (if any) will be returned to the client as error message.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Inside a plugin

        sub hook_unrecognized_command_parse {
           my ($self, $transaction, $cmd) = @_;
           return (OK, \&amp;bdat_parser) if ($cmd eq 'bdat');
        }

        sub bdat_parser {
           my ($self,$cmd,$line) = @_;
           # .. do something with $line...
           return (DENY, "Invalid arguments")
             if $some_reason_why_there_is_a_syntax_error;
           return (OK, @args);
        }

        sub hook_unrecognized_command {
           my ($self, $transaction, $cmd, @args) = @_;
           return (DECLINED) if ($self-&gt;qp-&gt;connection-&gt;hello eq 'helo');
           return (DECLINED) unless ($cmd eq 'bdat');
           ....
        }

perl v5.40.1                                       2025-03-21                              <u>Qpsmtpd::<a href="../man3pm/Command.3pm.html">Command</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>