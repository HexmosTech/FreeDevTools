<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tk_ParseArgv - process command-line options</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tk9.0-doc">tk9.0-doc_9.0.1-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Tk_ParseArgv - process command-line options

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tk.h&gt;</b>

       int
       <b>Tk_ParseArgv</b>(<u>interp,</u> <u>tkwin,</u> <u>argcPtr,</u> <u>argv,</u> <u>argTable,</u> <u>flags</u>)

</pre><h4><b>ARGUMENTS</b></h4><pre>
       Tcl_Interp <u>*interp</u> (in)             Interpreter to use for returning error messages.

       Tk_Window <u>tkwin</u> (in)                Window to use when arguments specify Tk options.  If NULL, then no Tk
                                           options will be processed.

       int <u>argcPtr</u> (in/out)                Pointer to number of arguments in argv;  gets modified to hold number
                                           of unprocessed arguments that remain after the call.

       const char <u>**argv</u> (in/out)          Command  line  arguments  passed  to  main program.  Modified to hold
                                           unprocessed arguments that remain after the call.

       Tk_ArgvInfo <u>*argTable</u> (in)          Array of  argument  descriptors,  terminated  by  element  with  type
                                           <b>TK_ARGV_END</b>.

       int <u>flags</u> (in)                      If  non-zero,  then  it  specifies one or more flags that control the
                                           parsing of arguments.  Different flags may be  OR'ed  together.   The
                                           flags     currently    defined    are    <b>TK_ARGV_DONT_SKIP_FIRST_ARG</b>,
                                           <b>TK_ARGV_NO_ABBREV</b>, <b>TK_ARGV_NO_LEFTOVERS</b>, and <b>TK_ARGV_NO_DEFAULTS</b>.
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Tk_ParseArgv</b> processes an array of command-line arguments according to a table describing  the  kinds  of
       arguments  that  are expected.  Each of the arguments in <u>argv</u> is processed in turn:  if it matches one of
       the entries in <u>argTable</u>, the argument is processed according to that entry and discarded.  The  arguments
       that do not match anything in <u>argTable</u> are copied down to the beginning of <u>argv</u> (retaining their original
       order)  and returned to the caller.  At the end of the call <b>Tk_ParseArgv</b> sets <u>*argcPtr</u> to hold the number
       of arguments that are left in <u>argv</u>, and <u>argv[*argcPtr]</u> will hold the value NULL.  Normally,  <b>Tk_ParseArgv</b>
       assumes  that  <u>argv[0]</u>  is a command name, so it is treated like an argument that does not match <u>argTable</u>
       and returned to the caller;  however, if the <b>TK_ARGV_DONT_SKIP_FIRST_ARG</b> bit is set in <u>flags</u> then <u>argv[0]</u>
       will be processed just like the other elements of <u>argv</u>.

       <b>Tk_ParseArgv</b> normally returns the value <b>TCL_OK</b>.  If an error occurs while  parsing  the  arguments,  then
       <b>TCL_ERROR</b> is returned and <b>Tk_ParseArgv</b> will leave an error message in the result of interpreter <u>interp</u> in
       the  standard  Tcl  fashion.   In the event of an error return, <u>*argvPtr</u> will not have been modified, but
       <u>argv</u> could have been partially modified.  The possible causes of errors are explained below.

       The <u>argTable</u> array specifies the kinds of arguments that are expected;   each  of  its  entries  has  the
       following structure:
              typedef struct {
                  const char *<u>key</u>;
                  int <u>type</u>;
                  void *<u>src</u>;
                  void *<u>dst</u>;
                  const char *<u>help</u>;
              } <b>Tk_ArgvInfo</b>;
       The  <u>key</u>  field  is  a string such as “-display” or “-bg” that is compared with the values in <u>argv</u>.  <u>Type</u>
       indicates how to process an argument that matches <u>key</u> (more on this below).  <u>Src</u> and <u>dst</u>  are  additional
       values used in processing the argument.  Their exact usage depends on <u>type</u>, but typically <u>src</u> indicates a
       value  and  <u>dst</u>  indicates  where  to  store  the  value.   The  <b>char</b>  <b>*</b> declarations for <u>src</u> and <u>dst</u> are
       placeholders:  the actual types may be different.  Lastly, <u>help</u> is a string giving a brief description of
       this option;  this string is printed when users ask for help about command-line options.

       When processing an argument in <u>argv</u>, <b>Tk_ParseArgv</b> compares the argument to each of the <u>key</u>'s in <u>argTable</u>.
       <b>Tk_ParseArgv</b> selects the first specifier whose <u>key</u> matches the argument  exactly,  if  such  a  specifier
       exists.   Otherwise <b>Tk_ParseArgv</b> selects a specifier for which the argument is a unique abbreviation.  If
       the argument is a unique abbreviation for more than one specifier, then an error is returned.   If  there
       is no matching entry in <u>argTable</u>, then the argument is skipped and returned to the caller.

       Once  a  matching  argument specifier is found, <b>Tk_ParseArgv</b> processes the argument according to the <u>type</u>
       field of the specifier.  The argument  that  matched  <u>key</u>  is  called  “the  matching  argument”  in  the
       descriptions below.  As part of the processing, <b>Tk_ParseArgv</b> may also use the next argument in <u>argv</u> after
       the  matching  argument,  which  is  called “the following argument”.  The legal values for <u>type</u>, and the
       processing that they cause, are as follows:

       <b>TK_ARGV_END</b>
              Marks the end of the table.  The last entry in <u>argTable</u> must have this type;   all  of  its  other
              fields are ignored and it will never match any arguments.

       <b>TK_ARGV_CONSTANT</b>
              <u>Src</u>  is  treated  as  an  integer and <u>dst</u> is treated as a pointer to an integer.  <u>Src</u> is stored at
              <u>*dst</u>.  The matching argument is discarded.

       <b>TK_ARGV_INT</b>
              The following argument must contain an integer string in the format accepted by <b>strtol</b> (e.g.   “0”
              and  “0x”  prefixes  may  be  used to specify octal or hexadecimal numbers, respectively).  <u>Dst</u> is
              treated as a pointer to an integer;  the following argument is converted to an integer  value  and
              stored at <u>*dst</u>.  <u>Src</u> is ignored.  The matching and following arguments are discarded from <u>argv</u>.

       <b>TK_ARGV_FLOAT</b>
              The following argument must contain a floating-point number in the format accepted by <b>strtol</b>.  <u>Dst</u>
              is  treated  as the address of a double-precision floating point value;  the following argument is
              converted to a double-precision value and stored at <u>*dst</u>.  The matching  and  following  arguments
              are discarded from <u>argv</u>.

       <b>TK_ARGV_STRING</b>
              In  this form, <u>dst</u> is treated as a pointer to a (char *); <b>Tk_ParseArgv</b> stores at <u>*dst</u> a pointer to
              the following argument, and discards the matching and  following  arguments  from  <u>argv</u>.   <u>Src</u>  is
              ignored.

       <b>TK_ARGV_UID</b>
              This  form  is  similar  to  <b>TK_ARGV_STRING</b>,  except  that the argument is turned into a Tk_Uid by
              calling <b>Tk_GetUid</b>.  <u>Dst</u> is treated as a pointer to a  Tk_Uid;  <b>Tk_ParseArgv</b>  stores  at  <u>*dst</u>  the
              Tk_Uid  corresponding to the following argument, and discards the matching and following arguments
              from <u>argv</u>.  <u>Src</u> is ignored.

       <b>TK_ARGV_CONST_OPTION</b>
              This form causes a Tk option to be set (as if the <b>option</b> command had been invoked).  The <u>src</u> field
              is treated as a pointer to a string giving the value of an option, and <u>dst</u> is treated as a pointer
              to the name of the option.  The matching argument is discarded.  If <u>tkwin</u> is NULL,  then  argument
              specifiers of this type are ignored (as if they did not exist).

       <b>TK_ARGV_OPTION_VALUE</b>
              This  form  is  similar to <b>TK_ARGV_CONST_OPTION</b>, except that the value of the option is taken from
              the following argument instead of from <u>src</u>.  <u>Dst</u> is used as  the  name  of  the  option.   <u>Src</u>  is
              ignored.   The  matching  and  following arguments are discarded.  If <u>tkwin</u> is NULL, then argument
              specifiers of this type are ignored (as if they did not exist).

       <b>TK_ARGV_OPTION_NAME_VALUE</b>
              In this case the following argument is taken as the name of a Tk option  and  the  argument  after
              that  is  taken  as the value for that option.  Both <u>src</u> and <u>dst</u> are ignored.  All three arguments
              are discarded from <u>argv</u>.  If <u>tkwin</u> is NULL, then argument specifiers of this type are ignored  (as
              if they did not exist).

       <b>TK_ARGV_HELP</b>
              When this kind of option is encountered, <b>Tk_ParseArgv</b> uses the <u>help</u> fields of <u>argTable</u> to format a
              message  describing all the valid arguments.  The message is placed in interpreter <u>interp</u>'s result
              and <b>Tk_ParseArgv</b> returns <b>TCL_ERROR</b>.  When this  happens,  the  caller  normally  prints  the  help
              message and aborts.  If the <u>key</u> field of a <b>TK_ARGV_HELP</b> specifier is NULL, then the specifier will
              never  match any arguments;  in this case the specifier simply provides extra documentation, which
              will be included when some other <b>TK_ARGV_HELP</b> entry causes help information to be returned.

       <b>TK_ARGV_REST</b>
              This option is used by programs or commands that allow the last several of their options to be the
              name and/or  options  for  some  other  program.   If  a  <b>TK_ARGV_REST</b>  argument  is  found,  then
              <b>Tk_ParseArgv</b>  does  not  process  any  of  the  remaining  arguments;   it returns them all at the
              beginning of <u>argv</u> (along with any other unprocessed arguments).  In addition, <b>Tk_ParseArgv</b>  treats
              <u>dst</u>  as  the  address  of  an  integer  value,  and  stores  at <u>*dst</u> the index of the first of the
              <b>TK_ARGV_REST</b>  options  in  the  returned  <u>argv</u>.   This  allows  the  program  to  distinguish  the
              <b>TK_ARGV_REST</b> options from other unprocessed options that preceded the <b>TK_ARGV_REST</b>.

       <b>TK_ARGV_FUNC</b>
              For  this  kind  of  argument,  <u>src</u>  is treated as the address of a procedure, which is invoked to
              process the following argument.  The procedure should have the following structure:
                     int
                     <u>func</u>(<u>dst</u>, <u>key</u>, <u>nextArg</u>)
                         char *<u>dst</u>;
                         char *<u>key</u>;
                         char *<u>nextArg</u>;
                     {
                     }
              The <u>dst</u> and <u>key</u> parameters will contain the corresponding fields  from  the  <u>argTable</u>  entry,  and
              <u>nextArg</u>  will  point  to  the  following  argument  from  <u>argv</u>  (or NULL if there are not any more
              arguments left in <u>argv</u>).  If <u>func</u> uses <u>nextArg</u> (so that <b>Tk_ParseArgv</b> should discard it),  then  it
              should return 1.  Otherwise it should return 0 and <b>TkParseArgv</b> will process the following argument
              in the normal fashion.  In either event the matching argument is discarded.

       <b>TK_ARGV_GENFUNC</b>
              This form provides a more general procedural escape.  It treats <u>src</u> as the address of a procedure,
              and passes that procedure all of the remaining arguments.  The procedure should have the following
              form:
                     int
                     <u>genfunc</u>(dst, interp, key, argc, argv)
                         char *<u>dst</u>;
                         Tcl_Interp *<u>interp</u>;
                         char *<u>key</u>;
                         int <u>argc</u>;
                         char **<u>argv</u>;
                     {
                     }
              The  <u>dst</u> and <u>key</u> parameters will contain the corresponding fields from the <u>argTable</u> entry.  <u>Interp</u>
              will be the same as the <u>interp</u> argument to <b>Tcl_ParseArgv</b>.  <u>Argc</u> and  <u>argv</u>  refer  to  all  of  the
              options  after  the  matching  one.   <u>Genfunc</u>  should behave in a fashion similar to <b>Tk_ParseArgv</b>:
              parse as many of the remaining arguments as it can, then return any that are  left  by  compacting
              them  to  the  beginning of <u>argv</u> (starting at <u>argv</u>[0]).  <u>Genfunc</u> should return a count of how many
              arguments are left in <u>argv</u>; <b>Tk_ParseArgv</b> will process them.  If <u>genfunc</u> encounters an  error  then
              it  should  leave  an  error message in interpreter <u>interp</u>'s result, in the usual Tcl fashion, and
              return -1;  when this happens <b>Tk_ParseArgv</b> will abort its processing and return <b>TCL_ERROR</b>.

   <b>FLAGS</b>
       <b>TK_ARGV_DONT_SKIP_FIRST_ARG</b>
              <b>Tk_ParseArgv</b> normally treats <u>argv[0]</u> as a program or command name, and returns it  to  the  caller
              just  as if it had not matched <u>argTable</u>.  If this flag is given, then <u>argv[0]</u> is not given special
              treatment.

       <b>TK_ARGV_NO_ABBREV</b>
              Normally, <b>Tk_ParseArgv</b> accepts unique abbreviations for <u>key</u> values in <u>argTable</u>.  If this  flag  is
              given then only exact matches will be acceptable.

       <b>TK_ARGV_NO_LEFTOVERS</b>
              Normally,  <b>Tk_ParseArgv</b> returns unrecognized arguments to the caller.  If this bit is set in <u>flags</u>
              then <b>Tk_ParseArgv</b> will return an error if it encounters any argument that does not match <u>argTable</u>.
              The only exception to this rule is <u>argv[0]</u>, which will be returned to the caller with no errors as
              long as <b>TK_ARGV_DONT_SKIP_FIRST_ARG</b> is not specified.

       <b>TK_ARGV_NO_DEFAULTS</b>
              Normally, <b>Tk_ParseArgv</b> searches an internal table of standard argument specifiers in  addition  to
              <u>argTable</u>.   If  this  bit  is  set  in <u>flags</u>, then <b>Tk_ParseArgv</b> will use only <u>argTable</u> and not its
              default table.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Here is an example definition of an <u>argTable</u> and some sample command lines that use  the  options.   Note
       the  effect  on <u>argc</u> and <u>argv</u>;  arguments processed by <b>Tk_ParseArgv</b> are eliminated from <u>argv</u>, and <u>argc</u> is
       updated to reflect reduced number of arguments.
              /*
               * Define and set default values for globals.
               */
              int debugFlag = 0;
              int numReps = 100;
              char defaultFileName[] = "out";
              char *fileName = defaultFileName;
              Boolean exec = FALSE;

              /*
               * Define option descriptions.
               */
              Tk_ArgvInfo argTable[] = {
                  {"-X", TK_ARGV_CONSTANT, (char *) 1, &amp;debugFlag,
                      "Turn on debugging printfs"},
                  {"-N", TK_ARGV_INT, NULL, &amp;numReps,
                      "Number of repetitions"},
                  {"-of", TK_ARGV_STRING, NULL, &amp;fileName,
                      "Name of file for output"},
                  {"x", TK_ARGV_REST, NULL, &amp;exec,
                      "File to exec, followed by any arguments (must be last argument)."},
                  {NULL, TK_ARGV_END, NULL, NULL,
                      NULL}
              };

              int main(int argc, char *argv[])
              {
                  ...

                  if (Tk_ParseArgv(interp, tkwin, &amp;argc, argv, argTable, 0) != TCL_OK) {
                      fprintf(stderr, "%s\n", Tcl_GetString(Tcl_GetObjResult(interp)));
                      <a href="../man1/exit.1.html">exit</a>(1);
                  }

                  /*
                   * Remainder of the program.
                   */
              }

       Note that default values can be assigned to variables named in <u>argTable</u>:   the  variables  will  only  be
       overwritten  if  the  particular  arguments are present in <u>argv</u>.  Here are some example command lines and
       their effects.
              prog -N 200 infile        # just sets the numReps variable to 200
              prog -of out200 infile    # sets fileName to reference "out200"
              prog -XN 10 infile        # sets the debug flag, also sets numReps
       In all of the above examples, <u>argc</u> will be set by <b>Tk_ParseArgv</b> to 2, <u>argv</u>[0] will be “prog”, <u>argv</u>[1] will
       be “infile”, and <u>argv</u>[2] will be NULL.

</pre><h4><b>KEYWORDS</b></h4><pre>
       arguments, command line, options

Tk                                                                                             <u><a href="../man3tk/Tk_ParseArgv.3tk.html">Tk_ParseArgv</a></u>(3tk)
</pre>
 </div>
</div></section>
</div>
</body>
</html>