<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>socket - Open a TCP network connection</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl9.0-doc">tcl9.0-doc_9.0.1+dfsg-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       socket - Open a TCP network connection

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>socket</b> ?<u>options</u>? <u>host</u> <u>port</u>
       <b>socket</b> <b>-server</b> <u>command</u> ?<u>options</u>? <u>port</u>
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  command  opens  a  network  socket  and  returns  a  channel  identifier that may be used in future
       invocations of commands like <b>read</b>, <b>puts</b> and <b>flush</b>.  At present only the TCP network protocol is supported
       over IPv4 and IPv6; future releases may include support for additional protocols.  The <b>socket</b> command may
       be used to open either the client or server side of a connection, depending on whether the <b>-server</b> switch
       is specified.

       Note that the default encoding for <u>all</u> sockets is the system encoding, as returned  by  <b>encoding</b>  <b>system</b>.
       Most  of  the  time,  you  will need to use <b>chan</b> <b>configure</b> to alter this to something else, such as <u>utf-8</u>
       (ideal for communicating with other Tcl processes) or  <u>iso8859-1</u>  (useful  for  many  network  protocols,
       especially the older ones).

</pre><h4><b>CLIENT</b> <b>SOCKETS</b></h4><pre>
       If  the  <b>-server</b>  option is not specified, then the client side of a connection is opened and the command
       returns a channel identifier that can be used for both reading and writing.  <u>Port</u> and <u>host</u> specify a port
       to connect to;  there must be a server accepting connections on this  port.   <u>Port</u>  is  an  integer  port
       number  (or service name, where supported and understood by the host operating system) and <u>host</u> is either
       a domain-style name such as <b>www.tcl.tk</b> or  a  numerical  IPv4  or  IPv6  address  such  as  <b>127.0.0.1</b>  or
       <b>2001:DB8::1</b>.  Use <u>localhost</u> to refer to the host on which the command is invoked.

       The  following  options  may  also  be  present  before  <u>host</u> to specify additional information about the
       connection:

       <b>-myaddr</b> <u>addr</u>
              <u>Addr</u> gives the domain-style name or numerical IP address of the client-side network  interface  to
              use  for  the  connection.   This  option may be useful if the client machine has multiple network
              interfaces.  If the option is omitted then the client-side interface will be chosen by the  system
              software.

       <b>-myport</b> <u>port</u>
              <u>Port</u> specifies an integer port number (or service name, where supported and understood by the host
              operating  system) to use for the client's side of the connection.  If this option is omitted, the
              client's port number will be chosen at random by the system software.

       <b>-async</b> This option will cause the client socket to be  connected  asynchronously.  This  means  that  the
              socket  will  be  created immediately but may not yet be connected to the server, when the call to
              <b>socket</b> returns.

              When a <b>gets</b> or <b>flush</b> is done on the socket before the connection attempt succeeds or fails, if the
              socket is in blocking mode, the operation will wait until the connection is completed or fails. If
              the socket is in nonblocking mode and a <b>gets</b> or <b>flush</b> is done on the socket before the  connection
              attempt succeeds or fails, the operation returns immediately and <b>fblocked</b> on the socket returns 1.
              Synchronous  client  sockets  may  be  switched  (after  they  have  connected)  to  operating  in
              asynchronous mode using:

                     <b>chan</b> <b>configure</b> <u>chan</u> <b>-blocking</b> <b>0</b>

              See the <b>chan</b> <b>configure</b> command for more details.

              The Tcl event loop should be running while an asynchronous connection is in progress,  because  it
              may  have  to do several connection attempts in the background. Running the event loop also allows
              you to set up a writable channel event on  the  socket  to  get  notified  when  the  asynchronous
              connection  has  succeeded  or failed. See the <b>vwait</b> and the <b>chan</b> commands for more details on the
              event loop and channel events.

              The <b>chan</b> <b>configure</b> option <b>-connecting</b> may be used to check if the connect  is  still  running.  To
              verify a successful connect, the option <b>-error</b> may be checked when <b>-connecting</b> returned 0.

              Operation  without  the  event queue requires at the moment calls to <b>chan</b> <b>configure</b> to advance the
              internal state machine.

</pre><h4><b>SERVER</b> <b>SOCKETS</b></h4><pre>
       If the <b>-server</b> option is specified then the new socket will be a server that listens on  the  given  <u>port</u>
       (either  an  integer  or  a service name, where supported and understood by the host operating system; if
       <u>port</u> is zero, the operating system will allocate a free port to the server socket which may be discovered
       by using <b>chan</b> <b>configure</b> to read the <b>-sockname</b> option). If the host supports  both,  IPv4  and  IPv6,  the
       socket will listen on both address families. Tcl will automatically accept connections to the given port.
       For  each  connection Tcl will create a new channel that may be used to communicate with the client.  Tcl
       then invokes <u>command</u> (properly a command prefix list, see  the  <b>EXAMPLES</b>  below)  with  three  additional
       arguments:  the  name of the new channel, the address, in network address notation, of the client's host,
       and the client's port number.

       The following additional option may also be specified before <u>port</u>:

       <b>-myaddr</b> <u>addr</u>
              <u>Addr</u> gives the domain-style name or numerical IP address of the server-side network  interface  to
              use  for  the  connection.   This  option may be useful if the server machine has multiple network
              interfaces.  If the option is omitted then the server socket is bound to the wildcard  address  so
              that  it  can  accept  connections  from  any interface. If <u>addr</u> is a domain name that resolves to
              multiple IP addresses that are available on the local machine, the socket will listen  on  all  of
              them.

       <b>-reuseaddr</b> <u>boolean</u>
              Tells  the  kernel  whether to reuse the local address if there is no socket actively listening on
              it. This is the default on Windows.

       <b>-reuseport</b> <u>boolean</u>
              Tells the kernel whether to allow the binding of multiple sockets to the same address and port.

       Server channels cannot be used for input or output; their sole use is to accept new  client  connections.
       The  channels  created  for  each incoming client connection are opened for input and output. Closing the
       server channel shuts down the server so that no new connections  will  be  accepted;   however,  existing
       connections will be unaffected.

       Server  sockets  depend  on  the Tcl event mechanism to find out when new connections are opened.  If the
       application does not enter the event loop, for example by invoking the <b>vwait</b> command  or  calling  the  C
       procedure <b>Tcl_DoOneEvent</b>, then no connections will be accepted.

       If  <u>port</u>  is  specified  as  zero,  the operating system will allocate an unused port for use as a server
       socket.  The port number actually allocated may be retrieved from the created  server  socket  using  the
       <b>chan</b> <b>configure</b> command to retrieve the <b>-sockname</b> option as described below.

</pre><h4><b>CONFIGURATION</b> <b>OPTIONS</b></h4><pre>
       The  <b>chan</b>  <b>configure</b>  command  can  be  used  to  query several readonly configuration options for socket
       channels or in some cases to set alternative properties on socket channels:

       <b>-error</b> This option gets the current error status of the given socket.  This is useful when  you  need  to
              determine  if  an  asynchronous  connect  operation  succeeded.   If there was an error, the error
              message is returned.  If there was no error, an empty string is returned.

              Note that  the  error  status  is  reset  by  the  read  operation;  this  mimics  the  underlying
              getsockopt(SO_ERROR) call.

       <b>-sockname</b>
              For  client  sockets  (including  the channels that get created when a client connects to a server
              socket) this option returns a list of three elements, the address, the  host  name  and  the  port
              number for the socket. If the host name cannot be computed, the second element is identical to the
              address, the first element of the list.

              For  server sockets this option returns a list of a multiple of three elements each group of which
              have the same meaning as described above. The list contains more than one group  when  the  server
              socket  was  created  without  <b>-myaddr</b>  or  with  the argument to <b>-myaddr</b> being a domain name that
              resolves multiple IP addresses that are local to the invoking host.

       <b>-peername</b>
              This option is not supported by server sockets. For  client  and  accepted  sockets,  this  option
              returns  a  list of three elements; these are the address, the host name and the port to which the
              peer socket is connected or bound. If the host name cannot be computed, the second element of  the
              list is identical to the address, its first element.

       <b>-connecting</b>
              This  option  is  not supported by server sockets. For client sockets, this option returns 1 if an
              asynchronous connect is still in progress, 0 otherwise.

       <b>-keepalive</b>
              This option sets or queries the TCP keepalive option on the socket as 1 if keepalive is turned on,
              0 otherwise.

       <b>-nodelay</b>
              This option sets or queries the TCP nodelay option on the socket as 1 if nodelay is turned  on,  0
              otherwise.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Here is a very simple time server:

              proc Server {startTime channel clientaddr clientport} {
                  puts "Connection from $clientaddr registered"
                  set now [clock seconds]
                  puts $channel [clock format $now]
                  puts $channel "[expr {$now - $startTime}] since start"
                  close $channel
              }

              <b>socket</b> <b>-server</b> [list Server [clock seconds]] 9900
              vwait forever

       And here is the corresponding client to talk to the server and extract some information:

              set server localhost
              set sockChan [<b>socket</b> $server 9900]
              gets $sockChan line1
              gets $sockChan line2
              close $sockChan
              puts "The time on $server is $line1"
              puts "That is [lindex $line2 0]s since the server started"

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/chan.3tcl.html">chan</a>(3tcl), <a href="../man3tcl/flush.3tcl.html">flush</a>(3tcl), <a href="../man3tcl/open.3tcl.html">open</a>(3tcl), <a href="../man3tcl/read.3tcl.html">read</a>(3tcl)

</pre><h4><b>KEYWORDS</b></h4><pre>
       asynchronous I/O, bind, channel, connection, domain name, host, network address, socket, tcp

Tcl                                                    8.6                                          <u><a href="../man3tcl/socket.3tcl.html">socket</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>