<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nmap::Parser - parse nmap scan data with perl</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnmap-parser-perl">libnmap-parser-perl_1.37-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Nmap::Parser - parse nmap scan data with perl

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Nmap::Parser;
         my $np = new Nmap::Parser;

         $np-&gt;parsescan($nmap_path, $nmap_args, @ips);
           #or
         $np-&gt;parsefile($file_xml);

         my $session    = $np-&gt;get_session();
           #a Nmap::Parser::Session object

         my $host       = $np-&gt;get_host($ip_addr);
           #a Nmap::Parser::Host object

         my $service = $host-&gt;<a href="../man80/tcp_service.80.html">tcp_service</a>(80);
           #a Nmap::Parser::Host::Service object

         my $os         = $host-&gt;os_sig();
           #a Nmap::Parser::Host::OS object

        #---------------------------------------

        my $np2 = new Nmap::Parser;

        $np2-&gt;callback(\&amp;my_callback);

        $np2-&gt;parsefile($file_xml);
           #or
        $np2-&gt;parsescan($nmap_path, $nmap_args, @ips);

        sub my_callback {

          my $host = shift;
           #Nmap::Parser::Host object
           #.. see documentation for all methods ...

        }

       <u>For</u> <u>a</u> <u>full</u> <u>listing</u> <u>of</u> <u>methods</u> <u>see</u> <u>the</u> <u>documentation</u> <u>corresponding</u> <u>to</u> <u>each</u> <u>object.</u>  You can also visit the
       website &lt;https://github.com/modernistik/Nmap-Parser&gt; for additional installation instructions.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module implements a interface to the information contained in an nmap scan.  It is implemented by
       parsing the xml scan data that is generated by nmap. This will enable anyone who utilizes nmap to quickly
       create fast and robust security scripts that utilize the powerful port scanning abilities of nmap.

       The latest version of this module can be found on here &lt;https://github.com/modernistik/Nmap-Parser&gt;

</pre><h4><b>OVERVIEW</b></h4><pre>
       This module has an internal framework to make it easy to retrieve the desired information of a scan.
       Every nmap scan is based on two main sections of informations: the scan session, and the scan information
       of all hosts.  The session information will be stored as a Nmap::Parser::Session object. This object will
       contain its own methods to obtain the desired information. The same is true for any hosts that were
       scanned using the Nmap::Parser::Host object.  There are two sub objects under Nmap::Parser::Host. One is
       the Nmap::Parser::Host::Service object which will be used to obtain information of a given service
       running on a given port. The second is the Nmap::Parser::Host::OS object which contains the operating
       system signature information (OS guessed names, classes, osfamily..etc).

         Nmap::Parser                        -- Core parser
            |
            +--Nmap::Parser::Session         -- Nmap scan session information
            |
            +--Nmap::Parser::Host            -- General host information
            |  |
            |  |-Nmap::Parser::Host::Service -- Port service information
            |  |
            |  |-Nmap::Parser::Host::OS      -- Operating system signature information

</pre><h4><b>METHODS</b></h4><pre>
   <b>Nmap::Parser</b>
       The main idea behind the core module is, you will first parse the information and then extract data.
       Therefore, all parse*() methods should be executed before any get_*() methods.

       <b>parse($string)</b>
       <b>parse($filehandle)</b>
           Parses the nmap scan information in $string. Note that is usually only used if you have the whole xml
           scan information in $string or if you are piping the scan information.

       <b>parsefile($xml_file)</b>
           Parses  the  nmap  scan  data in $xml_file. This file can be generated from an nmap scan by using the
           '-oX filename.xml' option with nmap. If you get an error or your program dies due to parsing,  please
           check that the xml information is compliant. The file is closed no matter how "parsefile()" returns.

       <b>parsescan($nmap,$args,@ips)</b>
           This method runs an nmap scan where $nmap is the path to the nmap executable or binary, $args are the
           nmap  command  line  parameters,  and  @ips  are  the  list of IP addresses to scan. <b>parsescan()</b> will
           automagically run the nmap scan and parse the information.

           If you wish to save the xml output from <b>parsescan()</b>, you must call  <b>cache_scan()</b>  method  <b>BEFORE</b>  you
           start  the  <b>parsescan()</b> process. This is done to conserve memory while parsing. <b>cache_scan()</b> will let
           Nmap::Parser know to save the output before parsing the xml since Nmap::Parser purges everything that
           has been parsed by the script to conserve memory and increase speed.

           <u>See</u> <u>section</u> <u>EXAMPLES</u> <u>for</u> <u>a</u> <u>short</u> <u>tutorial</u>

           <u>Note:</u> <u>You</u> <u>cannot</u> <u>have</u> <u>one</u> <u>of</u> <u>the</u> <u>nmap</u> <u>options</u> <u>to</u> <u>be</u> <u>'-oX',</u> <u>'-oN'</u> <u>or</u> <u>'-oG'.</u> <u>Your</u> <u>program</u> <u>will</u>  <u>die</u>  <u>if</u>
           <u>you</u>  <u>try</u>  <u>and</u> <u>pass</u> <u>any</u> <u>of</u> <u>these</u> <u>options</u> <u>because</u> <u>it</u> <u>decides</u> <u>the</u> <u>type</u> <u>of</u> <u>output</u> <u>nmap</u> <u>will</u> <u>generate.</u> <u>The</u>
           <u>IP</u> <u>addresses</u> <u>can</u> <u>be</u> <u>nmap-formatted</u> <u>addresses</u> <u>see</u> <u><b><a href="../man1/nmap.1.html">nmap</a></b>(1)</u>

           If you get an error or your program dies due to parsing, please check that  the  xml  information  is
           compliant. If you are using <b>parsescan()</b> or an open filehandle , make sure that the nmap scan that you
           are performing is successful in returning xml information. (Sometimes using loopback addresses causes
           nmap to fail).

       <b>cache_scan($filename)</b>
           This function allows you to save the output of a <b>parsescan()</b> (or nmap scan) to the disk. $filename is
           the   name   of   the  file  you  wish  to  save  the  nmap  scan  information  to.  It  defaults  to
           nmap-parser-cache.xml It returns the name of the file to be used as the cache.

            #Must be called before parsescan().
            $np-&gt;cache_scan($filename); #output set to nmap-parser-cache.xml

            #.. do other stuff to prepare for parsescan(), ex. setup callbacks

            $np-&gt;parsescan('/usr/bin/nmap',$args,@IPS);

       <b>purge()</b>
           Cleans the xml scan data from memory. This is useful if you have a program where you are parsing lots
           of nmap scan data files with persistent variables.

       <b>callback(\&amp;code_ref)</b>
           Sets the parsing mode to be done using the callback function.  It  takes  the  parameter  of  a  code
           reference  or  a reference to a function. If no code reference is given, it resets the mode to normal
           (no callback).

            $np-&gt;callback(\&amp;my_function); #sets callback, my_function() will be called
            $np-&gt;callback(); #resets it, no callback function called. Back to normal.

       <b>get_session()</b>
           Obtains the Nmap::Parser::Session object which contains the session scan information.

       <b>get_host($ip_addr)</b>
           Obtains the Nmap::Parser::Host object for the given $ip_addr.

       <b>del_host($ip_addr)</b>
           Deletes the stored Nmap::Parser::Host object whose IP is $ip_addr.

       <b>all_hosts()</b>
       <b>all_hosts($status)</b>
           Returns an array of all the Nmap::Parser::Host objects for the scan. If the optional status is given,
           it will only return those hosts that match that status. The status  can  be  any  of  the  following:
           "(up|down|unknown|skipped)"

       <b>get_ips()</b>
       <b>get_ips($status)</b>
           Returns  the  list  of  IP  addresses  that  were scanned in this nmap session. They are sorted using
           addr_sort. If the optional status is given, it will only return those IP addresses  that  match  that
           status. The status can be any of the following: "(up|down|unknown|skipped)"

       <b>addr_sort(@ips)</b>
           This function takes a list of IP addresses and returns the correctly sorted version of the list.

   <b>Nmap::Parser::Session</b>
       This object contains the scan session information of the nmap scan.

       <b>finish_time()</b>
           Returns the numeric time that the nmap scan finished.

       <b>nmap_version()</b>
           Returns the version of nmap used for the scan.

       <b>numservices()</b>
       <b>numservices($type)</b>
           If  numservices is called without argument, it returns the total number of services that were scanned
           for all types. If $type is given, it returns the number of services for that  given  scan  type.  See
           <b>scan_types()</b> for more info.

       <b>scan_args()</b>
           Returns a string which contains the nmap executed command line used to run the scan.

       <b>scan_type_proto($type)</b>
           Returns the protocol type of the given scan type (provided by $type). See <b>scan_types()</b> for more info.

       <b>scan_types()</b>
           Returns   the   list   of  scan  types  that  were  performed.  It  can  be  any  of  the  following:
           "(syn|ack|bounce|connect|null|xmas|window|maimon|fin|udp|ipproto)".

       <b>start_str()</b>
           Returns the human readable format of the start time.

       <b>start_time()</b>
           Returns the numeric form of the time the nmap scan started.

       <b>time_str()</b>
           Returns the human readable format of the finish time.

       <b>xml_version()</b>
           Returns the version of nmap xml file.

       <b>prescripts()</b>
       <b>prescripts($name)</b>
           A basic call to <b>prescripts()</b> returns a list of the names of the NSE scripts run in  the  pre-scanning
           phase.  If  $name is given, it returns the text output of the a reference to a hash with "output" and
           "contents" keys for the script with that name, or undef if that script was not run.  The value of the
           "output" key is the text output of the script. The value of the "contents" key is  a  data  structure
           based on the XML output of the NSE script.

       <b>postscripts()</b>
       <b>postscripts($name)</b>
           A  basic call to <b>postscripts()</b> returns a list of the names of the NSE scripts run in the post-scaning
           phase. If $name is given, it returns the text output of the a reference to a hash with  "output"  and
           "contents" keys for the script with that name, or undef if that script was not run.  The value of the
           "output"  key  is  the text output of the script. The value of the "contents" key is a data structure
           based on the XML output of the NSE script.

   <b>Nmap::Parser::Host</b>
       This object represents the information collected from a scanned host.

       <b>status()</b>
           Returns the state of the host. It is usually one of these "(up|down|unknown|skipped)".

       <b>addr()</b>
           Returns the main IP address of the host. This is usually the  IPv4  address.  If  there  is  no  IPv4
           address, the IPv6 is returned (hopefully there is one).

       <b>addrtype()</b>
           Returns the address type of the address given by <b>addr()</b> .

       <b>all_hostnames()</b>
           Returns a list of all hostnames found for the given host.

       <b>extraports_count()</b>
           Returns the number of extraports found.

       <b>extraports_state()</b>
           Returns the state of all the extraports found.

       <b>hostname()</b>
       <b>hostname($index)</b>
           As  a  basic call, <b>hostname()</b> returns the first hostname obtained for the given host. If there exists
           more than one hostname, you can provide a number, which is used as the location  in  the  array.  The
           index starts at 0;

            #in the case that there are only 2 hostnames
            hostname() eq <a href="../man0/hostname.0.html">hostname</a>(0);
            <a href="../man1/hostname.1.html">hostname</a>(1); #second hostname found
            <a href="../man400/hostname.400.html">hostname</a>(400) eq <a href="../man1/hostname.1.html">hostname</a>(1) #nothing at 400; return the name at the last index

       <b>ipv4_addr()</b>
           Explicitly return the IPv4 address.

       <b>ipv6_addr()</b>
           Explicitly return the IPv6 address.

       <b>mac_addr()</b>
           Explicitly return the MAC address.

       <b>mac_vendor()</b>
           Return the vendor information of the MAC.

       <b>distance()</b>
           Return the distance (in hops) of the target machine from the machine that performed the scan.

       <b>trace_error()</b>
           Returns  a  true value (usually a meaningful error message) if the traceroute was performed but could
           not reach the destination. In this case "all_trace_hops()" contains only the part of  the  path  that
           could be determined.

       <b>all_trace_hops()</b>
           Returns  an  array  of Nmap::Parser::Host::TraceHop objects representing the path to the target host.
           This array may be empty if Nmap did not perform the traceroute for some  reason  (same  network,  for
           example).

           Some  hops may be missing if Nmap could not figure out information about them.  In this case there is
           a gap between the "ttl()" values of consecutive returned hops. See also "trace_error()".

       <b>trace_proto()</b>
           Returns the name of the protocol used to perform the traceroute.

       <b>trace_port()</b>
           Returns the port used to perform the traceroute.

       <b>os_sig()</b>
           Returns an Nmap::Parser::Host::OS object that  can  be  used  to  obtain  all  the  Operating  System
           signature (fingerprint) information. See Nmap::Parser::Host::OS for more details.

            $os = $host-&gt;os_sig;
            $os-&gt;name;
            $os-&gt;osfamily;

       <b>tcpsequence_class()</b>
       <b>tcpsequence_index()</b>
       <b>tcpsequence_values()</b>
           Returns the class, index and values information respectively of the tcp sequence.

       <b>ipidsequence_class()</b>
       <b>ipidsequence_values()</b>
           Returns the class and values information respectively of the ipid sequence.

       <b>tcptssequence_class()</b>
       <b>tcptssequence_values()</b>
           Returns the class and values information respectively of the tcpts sequence.

       <b>uptime_lastboot()</b>
           Returns the human readable format of the timestamp of when the host had last rebooted.

       <b>uptime_seconds()</b>
           Returns  the  number  of  seconds  that have passed since the host's last boot from when the scan was
           performed.

       <b>hostscripts()</b>
       <b>hostscripts($name)</b>
           A basic call to <b>hostscripts()</b> returns a list of the names of the host scripts run. If $name is given,
           it returns the text output of the a reference to a hash with "output" and  "contents"  keys  for  the
           script  with  that  name,  or undef if that script was not run.  The value of the "output" key is the
           text output of the script. The value of the "contents" key is a  data  structure  based  on  the  XML
           output of the NSE script.

       <b>tcp_ports()</b>
       <b>udp_ports()</b>
           Returns  the  sorted  list of TCP|UDP ports respectively that were scanned on this host. Optionally a
           string argument can be given to these functions to filter the list.

            $host-&gt;tcp_ports('open') #returns all only 'open' ports (even 'open|filtered')
            $host-&gt;udp_ports('open|filtered'); #matches exactly ports with 'open|filtered'

           <u>Note</u> <u>that</u> <u>if</u> <u>a</u> <u>port</u> <u>state</u> <u>is</u> <u>set</u> <u>to</u> <u>'open|filtered'</u> <u>(or</u> <u>any</u> <u>combination),</u> <u>it</u> <u>will</u> <u>be</u>  <u>counted</u>  <u>as</u>  <u>an</u>
           <u>'open'</u> <u>port</u> <u>as</u> <u>well</u> <u>as</u> <u>a</u> <u>'filtered'</u> <u>one.</u>

       <b>tcp_port_count()</b>
       <b>udp_port_count()</b>
           Returns the total of TCP|UDP ports scanned respectively.

       <b>tcp_port_state_ttl()</b>
           Returns the 'reason_ttl' value present in nmap xml result.

       <b>tcp_del_ports($portid,</b> <b>[$portid,</b> <b>...])</b>
       <b>udp_del_ports($portid,</b> <b>[</b> <b>$portid,</b> <b>...])</b>
           Deletes the current $portid from the list of ports for given protocol.

       <b>tcp_port_state($portid)</b>
       <b>udp_port_state($portid)</b>
           Returns the state of the given port, provided by the port number in $portid.

       <b>tcp_open_ports()</b>
       <b>udp_open_ports()</b>
           Returns  the  list  of  open  TCP|UDP  ports  respectively. Note that if a port state is for example,
           'open|filtered', it will appear on this list as well.

       <b>tcp_filtered_ports()</b>
       <b>udp_filtered_ports()</b>
           Returns the list of filtered TCP|UDP ports respectively. Note that if a port state  is  for  example,
           'open|filtered', it will appear on this list as well.

       <b>tcp_closed_ports()</b>
       <b>udp_closed_ports()</b>
           Returns  the  list  of  closed  TCP|UDP ports respectively. Note that if a port state is for example,
           'closed|filtered', it will appear on this list as well.

       <b>tcp_service($portid)</b>
       <b>udp_service($portid)</b>
           Returns the Nmap::Parser::Host::Service object of a  given  service  running  on  port,  provided  by
           $portid. See Nmap::Parser::Host::Service for more info.

            $svc = $host-&gt;<a href="../man80/tcp_service.80.html">tcp_service</a>(80);
            $svc-&gt;name;
            $svc-&gt;proto;

       <u>Nmap::Parser::Host::Service</u>

       This  object  represents  the service running on a given port in a given host. This object is obtained by
       using the tcp_service($portid) or udp_service($portid) method from the Nmap::Parser::Host  object.  If  a
       portid  is  given  that does not exist on the given host, these functions will still return an object (so
       your script doesn't die).  Its good to use <b>tcp_ports()</b> or <b>udp_ports()</b> to see what ports were collected.

       <b>confidence()</b>
           Returns the confidence level in service detection.

       <b>extrainfo()</b>
           Returns any additional information nmap knows about the service.

       <b>method()</b>
           Returns the detection method.

       <b>name()</b>
           Returns the service name.

       <b>owner()</b>
           Returns the process owner of the given service. (If available)

       <b>port()</b>
           Returns the port number where the service is running on.

       <b>product()</b>
           Returns the product information of the service.

       <b>proto()</b>
           Returns the protocol type of the service.

       <b>rpcnum()</b>
           Returns the RPC number.

       <b>tunnel()</b>
           Returns the tunnel value. (If available)

       <b>fingerprint()</b>
           Returns the service fingerprint. (If available)

       <b>version()</b>
           Returns the version of the given product of the running service.

       <b>scripts()</b>
       <b>scripts($name)</b>
           A basic call to <b>scripts()</b> returns a list of the names of the NSE scripts run for this port. If  $name
           is given, it returns a reference to a hash with "output" and "contents" keys for the script with that
           name,  or  undef if that script was not run.  The value of the "output" key is the text output of the
           script. The value of the "contents" key is a data structure based  on  the  XML  output  of  the  NSE
           script.

       <u>Nmap::Parser::Host::OS</u>

       This  object  represents the Operating System signature (fingerprint) information of the given host. This
       object is obtained from an Nmap::Parser::Host object using the "os_sig()" method. One important thing  to
       note  is that the order of OS names and classes are sorted by <b>DECREASING</b> <b>ACCURACY</b>. This is more important
       than alphabetical ordering. Therefore, a basic call to any of these functions will return the record with
       the highest accuracy.  (Which is probably the one you want anyways).

       <b>all_names()</b>
           Returns the list of all the guessed OS names for the given host.

       <b>class_accuracy()</b>
       <b>class_accuracy($index)</b>
           A basic call to <b>class_accuracy()</b> returns the osclass accuracy of the  first  record.   If  $index  is
           given, it returns the osclass accuracy for the given record. The index starts at 0.

       <b>class_count()</b>
           Returns the total number of OS class records obtained from the nmap scan.

       <b>name()</b>
       <b>name($index)</b>
       <b>names()</b>
       <b>names($index)</b>
           A  basic  call  to  <b>name()</b> returns the OS name of the first record which is the name with the highest
           accuracy. If $index is given, it returns the name for the given record. The index starts at 0.

       <b>name_accuracy()</b>
       <b>name_accuracy($index)</b>
           A basic call to <b>name_accuracy()</b> returns the OS name accuracy of the first record. If $index is given,
           it returns the name for the given record. The index starts at 0.

       <b>name_count()</b>
           Returns the total number of OS names (records) for the given host.

       <b>osfamily()</b>
       <b>osfamily($index)</b>
           A basic call to <b>osfamily()</b> returns the OS family information of  the  first  record.   If  $index  is
           given, it returns the OS family information for the given record. The index starts at 0.

       <b>osgen()</b>
       <b>osgen($index)</b>
           A  basic  call  to  <b>osgen()</b>  returns the OS generation information of the first record.  If $index is
           given, it returns the OS generation information for the given record. The index starts at 0.

       <b>portused_closed()</b>
           Returns the closed port number used to help identify the OS signatures. This might not  be  available
           for all hosts.

       <b>portused_open()</b>
           Returns the open port number used to help identify the OS signatures. This might not be available for
           all hosts.

       <b>os_fingerprint()</b>
           Returns  the  OS fingerprint used to help identify the OS signatures. This might not be available for
           all hosts.

       <b>type()</b>
       <b>type($index)</b>
           A basic call to <b>type()</b> returns the OS type information of the first record.  If $index is  given,  it
           returns the OS type information for the given record. The index starts at 0.

       <b>vendor()</b>
       <b>vendor($index)</b>
           A  basic call to <b>vendor()</b> returns the OS vendor information of the first record.  If $index is given,
           it returns the OS vendor information for the given record. The index starts at 0.

       <u>Nmap::Parser::Host::TraceHop</u>

       This object represents a router on the IP path towards the destination or the destination itself. This is
       similar to what the "traceroute" command outputs.

       Nmap::Parser::Host::TraceHop objects  are  obtained  through  the  "all_trace_hops()"  and  "trace_hop()"
       Nmap::Parser::Host methods.

       <b>ttl()</b>
           The Time To Live is the network distance of this hop.

       <b>rtt()</b>
           The  Round  Trip  Time  is  roughly equivalent to the "ping" time towards this hop.  It is not always
           available (in which case it will be undef).

       <b>ipaddr()</b>
           The known IP address of this hop.

       <b>host()</b>
           The host name of this hop, if known.

</pre><h4><b>EXAMPLES</b></h4><pre>
       I think some of us best learn from examples. These are  a  couple  of  examples  to  help  create  custom
       security  audit  tools  using  some  of  the nice features of the Nmap::Parser module. Hopefully this can
       double     as     a     tutorial.      More     tutorials     (articles)     can     be     found      at
       &lt;https://github.com/modernistik/Nmap-Parser&gt;

   <b>Real-Time</b> <b>Scanning</b>
       You  can run a nmap scan and have the parser parse the information automagically.  The only constraint is
       that you cannot use '-oX', '-oN', or '-oG' as one of your arguments  for  nmap  command  line  parameters
       passed to <b>parsescan()</b>.

        use Nmap::Parser;

        my $np = new Nmap::Parser;
        my @hosts = @ARGV; #get hosts from cmd line

        #runs the nmap command with hosts and parses it automagically
        $np-&gt;parsescan('/usr/bin/nmap','-sS O -p 1-1023',@hosts);

        for my $host ($np-&gt;all_hosts()){
               print $host-&gt;hostname."\n";
               #do mor stuff...
        }

       If  you  would  like  to  run  the  scan using <b>parsescan()</b> but also save the scan xml output, you can use
       <b>cache_scan()</b>. You must call <b>cache_scan()</b> BEFORE you initiate the <b>parsescan()</b> method.

        use Nmap::Parser;
        my $np = new Nmap::Parser;

        #telling np to save output
        $np-&gt;cache_scan('nmap.localhost.xml');
        $np-&gt;parsescan('/usr/bin/nmap','-F','localhost');
        #do other stuff...

   <b>Callbacks</b>
       This is probably the easiest way to write a script with using Nmap::Parser, if you don't need the general
       scan session information. During the parsing process, the parser will obtain information of  every  host.
       The   callback  function  (in  this  case  '<b>booyah()</b>')   is  called  after  the  parsing  of  every  host
       (sequentially). When the callback returns, the parser will delete all information of the host it had sent
       to the callback. This callback function is called for every host that the parser encounters. <u>The</u> <u>callback</u>
       <u>function</u> <u>must</u> <u>be</u> <u>setup</u> <u>before</u> <u>parsing</u>

        use Nmap::Parser;
        my $np = new Nmap::Parser;

        $np-&gt;callback( \&amp;booyah );

        $np-&gt;parsefile('nmap_results.xml');
           # or use parsescan()

        sub booyah {
           my $host = shift; #Nmap::Parser::Host object, just parsed
           print 'IP: ',$host-&gt;addr,"\n";
                # ... do more stuff with $host ...

           #when it returns, host object will be deleted from memory
           #(good for processing VERY LARGE files or scans)
        }

   <b>Multiple</b> <b>Instances</b> <b>-</b> <b>("no</b> <b>less</b> <b>'of';</b> <b>my</b> <b>$self")</b>
       Using multiple instances of Nmap::Parser is extremely useful in helping audit/monitor the network  <b>P</b>olicy
       (ohh  noo! its that 'P' word!).  In this example, we have a set of hosts that had been scanned previously
       for tcp services where the image was saved in <u>base_image.xml</u>. We  now  will  scan  the  same  hosts,  and
       compare  if  any  new  tcp have been open since then (good way to look for suspicious new services). Easy
       security <b>C</b>ompliance detection.  (ooh noo! The 'C' word too!).

        use Nmap::Parser;
        use vars qw($nmap_exe $nmap_args @ips);
        my $base = new Nmap::Parser;
        my $curr = new Nmap::Parser;

        $base-&gt;parsefile('base_image.xml'); #load previous state
        $curr-&gt;parsescan($nmap_exe, $nmap_args, @ips); #scan current hosts

        for my $ip ($curr-&gt;get_ips )
        {
               #assume that IPs in base == IPs in curr scan
               my $ip_base = $base-&gt;get_host($ip);
               my $ip_curr = $curr-&gt;get_host($ip);
               my %port = ();

               #find ports that are open that were not open before
               #by finding the difference in port lists
               my @diff =  grep { $port{$_} &lt; 2}
                          (map {$port{$_}++; $_}
                          ( $ip_curr-&gt;tcp_open_ports , $ip_base-&gt;tcp_open_ports ));

               print "$ip has these new ports open: ".join(',',@diff) if(scalar @diff);

               for (@diff){print "$_ seems to be ",$ip_curr-&gt;tcp_service($_)-&gt;name,"\n";}

        }

</pre><h4><b>SUPPORT</b></h4><pre>
   <b>Discussion</b> <b>Forum</b>
       If you have questions about how to use the module, or any of its features, you can post messages  to  the
       Nmap::Parser module forum on CPAN::Forum.  &lt;https://github.com/modernistik/Nmap-Parser/issues&gt;

   <b>Bug</b> <b>Reports,</b> <b>Enhancements,</b> <b>Merge</b> <b>Requests</b>
       Please submit any bugs or feature requests to: &lt;https://github.com/modernistik/Nmap-Parser/issues&gt;

       <b>Please</b>  <b>make</b> <b>sure</b> <b>that</b> <b>you</b> <b>submit</b> <b>the</b> <b>xml-output</b> <b>file</b> <b>of</b> <b>the</b> <b>scan</b> <b>which</b> <b>you</b> <b>are</b> <b>having</b> <b>trouble</b> <b>with.</b> This
       can be done by running your scan with the <u>-oX</u> <u>filename.xml</u> nmap switch.  Please remove any  important  IP
       addresses for security reasons. It saves time in reproducing issues.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
        nmap, XML::Twig

       The  Nmap::Parser  page  can  be found at: &lt;https://github.com/modernistik/Nmap-Parser&gt;.  It contains the
       latest  developments  on  the  module.  The  nmap  security   scanner   homepage   can   be   found   at:
       &lt;<a href="http://www.insecure.org/nmap/">http://www.insecure.org/nmap/</a>&gt;.

</pre><h4><b>AUTHORS</b></h4><pre>
       Origiinal  author,  Anthony  Persaud  &lt;https://www.modernistik.com&gt;.  However,  special thanks to: Daniel
       Miller &lt;https://github.com/bonsaiviking&gt; and Robin Bowes &lt;<a href="http://robinbowes.com">http://robinbowes.com</a>&gt;.  Please see  Changes.md
       file for a list of other great contributors.

</pre><h4><b>COPYRIGHT</b> <b>Copyright</b> <b>(c)</b> <b>&lt;2003-2017&gt;</b> <b>&lt;Anthony</b> <b>Persaud&gt;</b> <b>&lt;https://www.modernistik.com&gt;</b></h4><pre>
       MIT License

       Permission  is  hereby  granted,  free  of  charge,  to  any person obtaining a copy of this software and
       associated documentation files (the "Software"), to deal in the Software without  restriction,  including
       without  limitation  the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
       copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to  the
       following conditions:

       The  above  copyright  notice  and  this permission notice shall be included in all copies or substantial
       portions of the Software.

       THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR  IMPLIED,  INCLUDING  BUT  NOT
       LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO
       EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
       IN  AN  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR
       THE USE OR OTHER DEALINGS IN THE SOFTWARE.

perl v5.36.0                                       2022-11-20                                        <u><a href="../man3pm/Parser.3pm.html">Parser</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>