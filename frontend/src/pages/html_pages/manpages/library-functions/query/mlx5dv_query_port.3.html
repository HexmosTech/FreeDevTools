<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mlx5dv_query_port - Query non standard attributes of IB device port.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libibverbs-dev">libibverbs-dev_56.1-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mlx5dv_query_port - Query non standard attributes of IB device port.

</pre><h4><b>SYNOPSIS</b></h4><pre>
              #include &lt;infiniband/mlx5dv.h&gt;

              int mlx5dv_query_port(struct ibv_context *context,
                            uint32_t port_num,
                            struct mlx5dv_port *info);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Query  port  info  which  can  be used for some device commands over the DEVX interface and when directly
       accessing the hardware resources.

       A function that lets a user query hardware and configuration attributes associated with the port.

</pre><h4><b>USAGE</b></h4><pre>
       A user should provide the port number to query.  On successful query <u>flags</u> will store  a  subset  of  the
       requested attributes which are supported/relevant for that port.

</pre><h4><b>ARGUMENTS</b></h4><pre>
       <u>context</u>
              RDMA device context to work on.

       <u>port_num</u>
              Port number to query.

       ## <u>info</u>
              Stores the returned attributes from the kernel.

              struct mlx5dv_port {
                  uint64_t flags;
                  uint16_t vport;
                  uint16_t vport_vhca_id;
                  uint16_t esw_owner_vhca_id;
                  uint16_t rsvd0;
                  uint64_t vport_steering_icm_rx;
                  uint64_t vport_steering_icm_tx;
                  struct mlx5dv_reg reg_c0;
              };

       <u>flags</u>  Bit field of attributes, on successful query <u>flags</u> stores the valid filled attributes.

              MLX5DV_QUERY_PORT_VPORT: The vport number of that port.

              MLX5DV_QUERY_PORT_VPORT_VHCA_ID: The VHCA ID of <u>vport_num</u>.

              MLX5DV_QUERY_PORT_ESW_OWNER_VHCA_ID: The E-Switch owner of <u>vport_num</u>.

              MLX5DV_QUERY_PORT_VPORT_STEERING_ICM_RX: The ICM RX address when directing traffic.

              MLX5DV_QUERY_PORT_VPORT_STEERING_ICM_TX: The ICM TX address when directing traffic.

              MLX5DV_QUERY_PORT_VPORT_REG_C0: Register C0 value used to identify egress of <u>vport_num</u>.

       <u>vport</u>  The VPORT number of that port.

       <u>vport_vhca_id</u>
              The VHCA ID of <u>vport_num</u>.

       <u>rsvd0</u>  A reserved field.  Not to be used.

       <u>esw_owner_vhca_id</u>
              The E-Switch owner of <u>vport_num</u>.

       <u>vport_steering_ica_rx</u>
              The ICM RX address when directing traffic.

       <u>vport_steering_icm_tx</u>
              The ICM TX address when directing traffic.

       ## reg_c0
              Register C0 value used to identify traffic of <u>vport_num</u>.

              struct mlx5dv_reg {
                      uint32_t value;
                      uint32_t mask;
              };

       <u>value</u>  The value that should be used as match.

       <u>mask</u>   The mask that should be used when matching.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       returns 0 on success, or the value of errno on failure (which indicates the failure reason).

</pre><h4><b>EXAMPLE</b></h4><pre>
              for (i = 1; i &lt;= ports; i++) {
                  ret = mlx5dv_query_port(context, i, &amp;port_info);
                  if (ret) {
                      printf("Error querying port %d\n", i);
                      break;
                  }

                  printf("Port: %d:\n", i);

                  if (port_info.flags &amp; MLX5DV_QUERY_PORT_VPORT)
                      printf("\tvport_num: 0x%x\n", port_info.vport_num);

                  if (port_info.flags &amp; MLX5DV_QUERY_PORT_VPORT_REG_C0)
                      printf("\treg_c0: val: 0x%x mask: 0x%x\n",
                              port_info.reg_c0.value,
                              port_info.reg_c0.mask);
              }

       Mark Bloch <a href="mailto:mbloch@nvidia.com">mbloch@nvidia.com</a>

                                                                                            <u><a href="../man3/mlx5dv_query_port.3.html">mlx5dv_query_port</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>