<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cgsi_plugin.h - Header file for the GSI gSOAP plugin.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcgsi-gsoap-doc">libcgsi-gsoap-doc_1.3.12-1build1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       cgsi_plugin.h - Header file for the GSI gSOAP plugin.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;stdsoap2.h&gt;

   <b>Macros</b>
       #define <b>CGSI_OPT_CLIENT</b>   0x1
       #define <b>CGSI_OPT_SERVER</b>   0x2
       #define <b>CGSI_OPT_DELEG_FLAG</b>   0x4
       #define <b>CGSI_OPT_SSL_COMPATIBLE</b>   0x8
       #define <b>CGSI_OPT_DISABLE_NAME_CHECK</b>   0x10
       #define <b>CGSI_OPT_KEEP_ALIVE</b>   0x20
       #define <b>CGSI_OPT_DISABLE_MAPPING</b>   0x40
       #define <b>CGSI_OPT_DISABLE_VOMS_CHECK</b>   0x80
       #define <b>CGSI_OPT_ALLOW_ONLY_SELF</b>   0x100

   <b>Functions</b>
       int <b>soap_cgsi_init</b> (struct soap *soap, int cgsi_options)
       int <b>cgsi_plugin</b> (struct soap *soap, struct soap_plugin *plugin, void *arg)
       int <b>client_cgsi_plugin</b> (struct soap *soap, struct soap_plugin *plugin, void *arg)
       int <b>server_cgsi_plugin</b> (struct soap *soap, struct soap_plugin *plugin, void *arg)
       int <b>is_context_established</b> (struct soap *soap)
       int <b>get_client_dn</b> (struct soap *soap, char *dn, size_t dnlen)
       int <b>get_client_username</b> (struct soap *soap, char *username, size_t dnlen)
       int <b>get_delegated_credentials</b> (struct soap *soap, void **buffer, size_t *length)
       int <b>export_delegated_credentials</b> (struct soap *soap, char *filename)
       int <b>has_delegated_credentials</b> (struct soap *soap)
       int <b>set_default_proxy_file</b> (struct soap *soap, char *filename)
       void <b>clear_default_proxy_file</b> (int unlink_file)
       int <b>retrieve_voms_creds</b> (struct soap *soap)
       int <b>retrieve_userca_and_voms_creds</b> (struct soap *soap)
       char * <b>get_client_ca</b> (struct soap *soap)
       char * <b>get_client_voname</b> (struct soap *soap)
       char ** <b>get_client_roles</b> (struct soap *soap, int *nbfqans)
       int <b>cgsi_plugin_set_flags</b> (struct soap *soap, int is_server, int flags)
       int <b>cgsi_plugin_clr_flags</b> (struct soap *soap, int is_server, int flags)
       int <b>cgsi_plugin_get_flags</b> (struct soap *soap, int is_server)
       int <b>cgsi_plugin_set_credentials</b> (struct soap *soap, int is_server, const char *x509_cert, const char
           *x509_key)

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       Header file for the GSI gSOAP plugin.

       <b>cgsi_plugin.h</b> - Header file for the GSI gSOAP plugin

       <b>Author</b>
           Ben Couturier CERN, IT/ADC

       This is a GSI plugin for gSOAP. It uses the globus GSI libraries to implement GSI secure authentication
       and encryption on top of gSOAP. The globus GSI bundle is necessary for the plugin to compile and run.

</pre><h4><b>Macro</b> <b>Definition</b> <b>Documentation</b></h4><pre>
   <b>#define</b> <b>CGSI_OPT_ALLOW_ONLY_SELF</b>   <b>0x100</b>
       Allow client and server to only connect together when they have the same identity

   <b>#define</b> <b>CGSI_OPT_CLIENT</b>   <b>0x1</b>
       Options that can be specified when initializing the cgsi_plugin (in the arg parameter): The program acts
       as a client.

   <b>#define</b> <b>CGSI_OPT_DELEG_FLAG</b>   <b>0x4</b>
       Initiate delegation over the HTTPG protocol.

   <b>#define</b> <b>CGSI_OPT_DISABLE_MAPPING</b>   <b>0x40</b>
       Disable DN-&gt;userid mapping via gridmap-file.

   <b>#define</b> <b>CGSI_OPT_DISABLE_NAME_CHECK</b>   <b>0x10</b>
       Disable comparing the server's host name with its certificate's CN.

   <b>#define</b> <b>CGSI_OPT_DISABLE_VOMS_CHECK</b>   <b>0x80</b>
       Disable connect time VOMS parsing for better error handling via an explicit call to <b>retrieve_voms_creds()</b>

   <b>#define</b> <b>CGSI_OPT_KEEP_ALIVE</b>   <b>0x20</b>
       Keep alive the HTTP connection.

   <b>#define</b> <b>CGSI_OPT_SERVER</b>   <b>0x2</b>
       The program acts as a server.

   <b>#define</b> <b>CGSI_OPT_SSL_COMPATIBLE</b>   <b>0x8</b>
       Using pure SSL protocol, for compatibility.

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>int</b> <b>cgsi_plugin</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>struct</b> <b>soap_plugin</b> <b>*</b> <b>plugin,</b> <b>void</b> <b>*</b> <b>arg)</b>
       Generic constructor for the cgsi_plugin

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>plugin</u> Pointer to the plugin data structure
           <u>arg</u> The parameters for the plugin creation

       <b>Returns</b>
           0 if successful, -1 otherwise

   <b>int</b> <b>cgsi_plugin_clr_flags</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>int</b> <b>is_server,</b> <b>int</b> <b>flags)</b>
       Adjust CGSI-plugin's behaviour by clearing one or more flags. If a flag is not present in args then it is
       unaffected by this operation. If a flag is currently cleared then attempting to clear it will have no
       effect.

       <b>Parameters</b>
           <u>soap</u> The soap structure from gSOAP
           <u>is_server</u> 0 if client, 1 if server
           <u>flags</u> Bitwise OR of the flags to be cleared.

       <b>Returns</b>
           0 on success, -1 on error.

   <b>int</b> <b>cgsi_plugin_get_flags</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>int</b> <b>is_server)</b>
       Discover the current set of flags that are in effect.

       <b>Parameters</b>
           <u>soap</u> The soap structure from gSOAP
           <u>is_server</u> 0 if client, 1 if server

       <b>Returns</b>
           the set of flags or -1 on error

   <b>int</b> <b>cgsi_plugin_set_credentials</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>int</b> <b>is_server,</b> <b>const</b> <b>char</b> <b>*</b> <b>x509_cert,</b> <b>const</b> <b>char</b> <b>*</b>
       <b>x509_key)</b>
       Set credentials without using environment variables

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>is_server</u> 0 if client, 1 if server
           <u>x509_cert</u> The certificate. If it is a proxy, you only need to specify this one
           <u>x509_key</u> The key. Will be ignored if x509_cert is NULL!

       <b>Returns</b>
           0 on success, -1 on error.

   <b>int</b> <b>cgsi_plugin_set_flags</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>int</b> <b>is_server,</b> <b>int</b> <b>flags)</b>
       Adjust CGSI-plugin's behaviour by setting one or more flags. If a flag is not present in args then that
       flag is unaffected by this operation. If a flag is currently set then attempting to set it will have no
       effect.

       <b>Parameters</b>
           <u>soap</u> The soap structure from gSOAP
           <u>is_server</u> 0 if client, 1 if server
           <u>flags</u> Bitwise OR of the flags to be set.

       <b>Returns</b>
           0 on success, -1 on error.

   <b>void</b> <b>clear_default_proxy_file</b> <b>(int</b> <b>unlink_file)</b>
       Clears the env variable used by GSI to specify the proxy filename

       <b>Parameters</b>
           <u>unlink_file</u> Set to 1 if you want to destroy the credential file as well

   <b>int</b> <b>client_cgsi_plugin</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>struct</b> <b>soap_plugin</b> <b>*</b> <b>plugin,</b> <b>void</b> <b>*</b> <b>arg)</b>
       Client constructor for the cgsi_plugin

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>plugin</u> Pointer to the plugin data structure
           <u>arg</u> The parameters for the plugin creation (CGSI_OPT_CLIENT assumed)

       <b>Returns</b>
           0 if successful, -1 otherwise

   <b>int</b> <b>export_delegated_credentials</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>char</b> <b>*</b> <b>filename)</b>
       Export the delegated credentials (if available) to a file

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>filename</u> Name of the file where the credentials are to be written

       <b>Returns</b>
           0 if successful, -1 otherwise

   <b>char</b> <b>*</b> <b>get_client_ca</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap)</b>
       Returns the client CA

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request

       <b>Returns</b>
           The client CA is allocated in the soap structure (DON'T free), NULL otherwise

   <b>int</b> <b>get_client_dn</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>char</b> <b>*</b> <b>dn,</b> <b>size_t</b> <b>dnlen)</b>
       Gets the Distinguished name (DN) of the client

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>dn</u> Pointer to a buffer where the DN is to be written
           <u>dnlen</u> The length of the buffer

       <b>Returns</b>
           0 if successful, -1 otherwise

   <b>char</b> <b>**</b> <b>get_client_roles</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>int</b> <b>*</b> <b>nbfqans)</b>
       Returns the client VO roles if they were provided in the certificate

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>nbfqans</u> The number of returned Fully Qualified Attribute Names

       <b>Returns</b>
           The client roles are malloced in the soap structure (DON'T free), NULL otherwise

   <b>int</b> <b>get_client_username</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>char</b> <b>*</b> <b>username,</b> <b>size_t</b> <b>dnlen)</b>
       Gets the username (DN) of the client

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>username</u> Pointer to a buffer where the username is to be written
           <u>dnlen</u> The length of the buffer

       <b>Returns</b>
           0 if successful, -1 otherwise

   <b>char</b> <b>*</b> <b>get_client_voname</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap)</b>
       Returns the client VO name if it was provided in the certificate

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request

       <b>Returns</b>
           The client voname is malloced in the soap structure (DON'T free), NULL otherwise

   <b>int</b> <b>get_delegated_credentials</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>void</b> <b>**</b> <b>buffer,</b> <b>size_t</b> <b>*</b> <b>length)</b>
       Make the delegated credential available as a token in memory. The soap structure retains ownership of the
       memory. The user should not free the pointer returned by this function, nor use it after the soap object
       becomes invalid.

       <b>Parameters</b>
           <u>soap</u> The soap structure that is the target of the request
           <u>buffer</u> Pointer to a void pointer which will be set to reference the credential token.
           <u>length</u> Pointer to a length that will be set to the size of the credential token

       <b>Returns</b>
           0 if successful, -1 otherwise

   <b>int</b> <b>has_delegated_credentials</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap)</b>
       Checks whether the client delegated credentials to the server

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request

       <b>Returns</b>
           1 if there are some delegated credentials, 0 otherwise

   <b>int</b> <b>is_context_established</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap)</b>
       Checks whether the security context has been established properly

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request

       <b>Returns</b>
           1 if context established, 0 otherwise

   <b>int</b> <b>retrieve_userca_and_voms_creds</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap)</b>
   <b>int</b> <b>retrieve_voms_creds</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap)</b>
       Parses the optional VOMS extension of the peer certificate. It has to be called before
       <b>get_client_voname()</b> and <b>get_client_roles()</b>!

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request

       <b>Returns</b>
           0 if successful, -1 otherwise SOAP Fault structure contains the detailed description.

   <b>int</b> <b>server_cgsi_plugin</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>struct</b> <b>soap_plugin</b> <b>*</b> <b>plugin,</b> <b>void</b> <b>*</b> <b>arg)</b>
       Server constructor for the cgsi_plugin

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>plugin</u> Pointer to the plugin data structure
           <u>arg</u> The parameters for the plugin creation (CGSI_OPT_SERVER assumed)

       <b>Returns</b>
           0 if successful, -1 otherwise

   <b>int</b> <b>set_default_proxy_file</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>char</b> <b>*</b> <b>filename)</b>
       Sets the env variable for GSI to use the proxy in the specified filename

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>filename</u> Name of the file where credentials are stored

       <b>Returns</b>
           0 if successful, -1 otherwise

   <b>int</b> <b>soap_cgsi_init</b> <b>(struct</b> <b>soap</b> <b>*</b> <b>soap,</b> <b>int</b> <b>cgsi_options)</b>
       Helper function to create the gsoap object and the cgsi_plugin at the same time. This function assumes
       that a client plugin is specified, to create a server plugin, use the CGSI_OPT_SERVER option.

       <b>Parameters</b>
           <u>soap</u> The soap structure for the request
           <u>cgsi_options</u> The parameters for the plugin creation (bitwise or of the different options).

       <b>Returns</b>
           0 if successful, -1 otherwise

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for CGSI_gSOAP from the source code.

CGSI_gSOAP                                       Version 1.3.12                                 <u><a href="../man3/cgsi_plugin.h.3.html">cgsi_plugin.h</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>