<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pam_sm_chauthtok - PAM service function for authentication token management</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpam-doc">libpam-doc_1.7.0-5ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pam_sm_chauthtok - PAM service function for authentication token management

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;security/pam_modules.h&gt;</b>

       <b>int</b> <b>pam_sm_chauthtok(pam_handle_t</b> <b>*</b><u>pamh</u><b>,</b> <b>int</b> <u>flags</u><b>,</b> <b>int</b> <u>argc</u><b>,</b> <b>const</b> <b>char</b> <b>**</b><u>argv</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>pam_sm_chauthtok</b> function is the service module's implementation of the <b><a href="../man3/pam_chauthtok.3.html">pam_chauthtok</a></b>(3) interface.

       This function is used to (re-)set the authentication token of the user.

       Valid flags, which may be logically OR'd with <u>PAM_SILENT</u>, are:

       PAM_SILENT
           Do not emit any messages.

       PAM_CHANGE_EXPIRED_AUTHTOK
           This argument indicates to the module that the user's authentication token (password) should only be
           changed if it has expired. This flag is optional and <u>must</u> be combined with one of the following two
           flags. Note, however, the following two options are <u>mutually</u> <u>exclusive</u>.

       PAM_PRELIM_CHECK
           This indicates that the modules are being probed as to their ready status for altering the user's
           authentication token. If the module requires access to another system over some network it should
           attempt to verify it can connect to this system on receiving this flag. If a module cannot establish
           it is ready to update the user's authentication token it should return <b>PAM_TRY_AGAIN</b>, this
           information will be passed back to the application.

           If the control value <u>sufficient</u> is used in the password stack, the <u>PAM_PRELIM_CHECK</u> section of the
           modules following that control value is not always executed.

       PAM_UPDATE_AUTHTOK
           This informs the module that this is the call it should change the authorization tokens. If the flag
           is logically OR'd with <b>PAM_CHANGE_EXPIRED_AUTHTOK</b>, the token is only changed if it has actually
           expired.

       The PAM library calls this function twice in succession. The first time with <b>PAM_PRELIM_CHECK</b> and then,
       if the module does not return <b>PAM_TRY_AGAIN</b>, subsequently with <b>PAM_UPDATE_AUTHTOK</b>. It is only on the
       second call that the authorization token is (possibly) changed.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       PAM_AUTHTOK_ERR
           The module was unable to obtain the new authentication token.

       PAM_AUTHTOK_RECOVERY_ERR
           The module was unable to obtain the old authentication token.

       PAM_AUTHTOK_LOCK_BUSY
           Cannot change the authentication token since it is currently locked.

       PAM_AUTHTOK_DISABLE_AGING
           Authentication token aging has been disabled.

       PAM_PERM_DENIED
           Permission denied.

       PAM_TRY_AGAIN
           Preliminary check was unsuccessful. Signals an immediate return to the application is desired.

       PAM_SUCCESS
           The authentication token was successfully updated.

       PAM_USER_UNKNOWN
           User unknown to password service.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/pam.3.html">pam</a></b>(3), <b><a href="../man3/pam_chauthtok.3.html">pam_chauthtok</a></b>(3), <b><a href="../man3/pam_sm_chauthtok.3.html">pam_sm_chauthtok</a></b>(3), <b><a href="../man3/pam_strerror.3.html">pam_strerror</a></b>(3), <b><a href="../man8/PAM.8.html">PAM</a></b>(8)

Linux-PAM                                          07/03/2025                                <u><a href="../man3/PAM_SM_CHAUTHTOK.3.html">PAM_SM_CHAUTHTOK</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>