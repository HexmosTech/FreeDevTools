<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>libhmsbeagle/beagle.h - This file documents the API as well as header for the Broad-platform Evolutionary</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/libhmsbeagle-dev">libhmsbeagle-dev_3.1.2+dfsg-12ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       libhmsbeagle/beagle.h - This file documents the API as well as header for the Broad-platform Evolutionary
       Analysis General Likelihood Evaluator.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include 'libhmsbeagle/platform.h'

   <b>Classes</b>
       struct <b>BeagleInstanceDetails</b>
           Information about a specific instance.
       struct <b>BeagleResource</b>
           Description of a hardware resource.
       struct <b>BeagleResourceList</b>
           List of hardware resources.
       struct <b>BeagleBenchmarkedResource</b>
           Description of a benchmarked hardware resource.
       struct <b>BeagleBenchmarkedResourceList</b>
           Ordered list of benchmarked hardware resources, from fastest to slowest.
       struct <b>BeagleOperation</b>
           A list of integer indices which specify a partial likelihoods operation.
       struct <b>BeagleOperationByPartition</b>
           A list of integer indices which specify a partial likelihoods operation for a partitioned analysis.

   <b>Enumerations</b>
       enum <b>BeagleReturnCodes</b> { <b>BEAGLE_SUCCESS</b> = 0, <b>BEAGLE_ERROR_GENERAL</b> = -1, <b>BEAGLE_ERROR_OUT_OF_MEMORY</b> = -2,
           <b>BEAGLE_ERROR_UNIDENTIFIED_EXCEPTION</b> = -3, <b>BEAGLE_ERROR_UNINITIALIZED_INSTANCE</b> = -4,
           <b>BEAGLE_ERROR_OUT_OF_RANGE</b> = -5, <b>BEAGLE_ERROR_NO_RESOURCE</b> = -6, <b>BEAGLE_ERROR_NO_IMPLEMENTATION</b> = -7,
           <b>BEAGLE_ERROR_FLOATING_POINT</b> = -8 }
           Error return codes.
       enum <b>BeagleFlags</b> { <b>BEAGLE_FLAG_PRECISION_SINGLE</b> = 1 &lt;&lt; 0, <b>BEAGLE_FLAG_PRECISION_DOUBLE</b> = 1 &lt;&lt; 1,
           <b>BEAGLE_FLAG_COMPUTATION_SYNCH</b> = 1 &lt;&lt; 2, <b>BEAGLE_FLAG_COMPUTATION_ASYNCH</b> = 1 &lt;&lt; 3,
           <b>BEAGLE_FLAG_EIGEN_REAL</b> = 1 &lt;&lt; 4, <b>BEAGLE_FLAG_EIGEN_COMPLEX</b> = 1 &lt;&lt; 5, <b>BEAGLE_FLAG_SCALING_MANUAL</b> = 1
           &lt;&lt; 6, <b>BEAGLE_FLAG_SCALING_AUTO</b> = 1 &lt;&lt; 7, <b>BEAGLE_FLAG_SCALING_ALWAYS</b> = 1 &lt;&lt; 8,
           <b>BEAGLE_FLAG_SCALING_DYNAMIC</b> = 1 &lt;&lt; 25, <b>BEAGLE_FLAG_SCALERS_RAW</b> = 1 &lt;&lt; 9, <b>BEAGLE_FLAG_SCALERS_LOG</b> = 1
           &lt;&lt; 10, <b>BEAGLE_FLAG_INVEVEC_STANDARD</b> = 1 &lt;&lt; 20, <b>BEAGLE_FLAG_INVEVEC_TRANSPOSED</b> = 1 &lt;&lt; 21,
           <b>BEAGLE_FLAG_VECTOR_SSE</b> = 1 &lt;&lt; 11, <b>BEAGLE_FLAG_VECTOR_AVX</b> = 1 &lt;&lt; 24, <b>BEAGLE_FLAG_VECTOR_NONE</b> = 1 &lt;&lt;
           12, <b>BEAGLE_FLAG_THREADING_CPP</b> = 1 &lt;&lt; 30, <b>BEAGLE_FLAG_THREADING_OPENMP</b> = 1 &lt;&lt; 13,
           <b>BEAGLE_FLAG_THREADING_NONE</b> = 1 &lt;&lt; 14, <b>BEAGLE_FLAG_PROCESSOR_CPU</b> = 1 &lt;&lt; 15, <b>BEAGLE_FLAG_PROCESSOR_GPU</b>
           = 1 &lt;&lt; 16, <b>BEAGLE_FLAG_PROCESSOR_FPGA</b> = 1 &lt;&lt; 17, <b>BEAGLE_FLAG_PROCESSOR_CELL</b> = 1 &lt;&lt; 18,
           <b>BEAGLE_FLAG_PROCESSOR_PHI</b> = 1 &lt;&lt; 19, <b>BEAGLE_FLAG_PROCESSOR_OTHER</b> = 1 &lt;&lt; 26,
           <b>BEAGLE_FLAG_FRAMEWORK_CUDA</b> = 1 &lt;&lt; 22, <b>BEAGLE_FLAG_FRAMEWORK_OPENCL</b> = 1 &lt;&lt; 23,
           <b>BEAGLE_FLAG_FRAMEWORK_CPU</b> = 1 &lt;&lt; 27, <b>BEAGLE_FLAG_PARALLELOPS_STREAMS</b> = 1 &lt;&lt; 28,
           <b>BEAGLE_FLAG_PARALLELOPS_GRID</b> = 1 &lt;&lt; 29 }
           Hardware and implementation capability flags.
       enum <b>BeagleBenchmarkFlags</b> { <b>BEAGLE_BENCHFLAG_SCALING_NONE</b> = 1 &lt;&lt; 0, <b>BEAGLE_BENCHFLAG_SCALING_ALWAYS</b> = 1
           &lt;&lt; 1, <b>BEAGLE_BENCHFLAG_SCALING_DYNAMIC</b> = 1 &lt;&lt; 2 }
           Benchmarking mode flags for resource performance evaluation with beagleGetOrderedResourceList.
       enum <b>BeagleOpCodes</b> { <b>BEAGLE_OP_COUNT</b> = 7, <b>BEAGLE_PARTITION_OP_COUNT</b> = 9, <b>BEAGLE_OP_NONE</b> = -1 }
           Operation codes.

   <b>Functions</b>
       BEAGLE_DLLEXPORT const char * <b>beagleGetVersion</b> (void)
           Get version.
       BEAGLE_DLLEXPORT const char * <b>beagleGetCitation</b> (void)
           Get citation.
       BEAGLE_DLLEXPORT <b>BeagleResourceList</b> * <b>beagleGetResourceList</b> (void)
           Get list of hardware resources.
       BEAGLE_DLLEXPORT <b>BeagleBenchmarkedResourceList</b> * <b>beagleGetBenchmarkedResourceList</b> (int tipCount, int
           compactBufferCount, int stateCount, int patternCount, int categoryCount, int *resourceList, int
           resourceCount, long preferenceFlags, long requirementFlags, int eigenModelCount, int partitionCount,
           int calculateDerivatives, long benchmarkFlags)
           Get a benchmarked list of hardware resources for the given analysis parameters.
       BEAGLE_DLLEXPORT int <b>beagleCreateInstance</b> (int tipCount, int partialsBufferCount, int compactBufferCount,
           int stateCount, int patternCount, int eigenBufferCount, int matrixBufferCount, int categoryCount, int
           scaleBufferCount, int *resourceList, int resourceCount, long preferenceFlags, long requirementFlags,
           <b>BeagleInstanceDetails</b> *returnInfo)
           Create a single instance.
       BEAGLE_DLLEXPORT int <b>beagleFinalizeInstance</b> (int instance)
           Finalize this instance.
       BEAGLE_DLLEXPORT int <b>beagleFinalize</b> (void)
           Finalize the library.
       BEAGLE_DLLEXPORT int <b>beagleSetCPUThreadCount</b> (int instance, int threadCount)
           Set number of threads for native CPU implementation.
       BEAGLE_DLLEXPORT int <b>beagleSetTipStates</b> (int instance, int tipIndex, const int *inStates)
           Set the compact state representation for tip node.
       BEAGLE_DLLEXPORT int <b>beagleSetTipPartials</b> (int instance, int tipIndex, const double *inPartials)
           Set an instance partials buffer for tip node.
       BEAGLE_DLLEXPORT int <b>beagleSetPartials</b> (int instance, int bufferIndex, const double *inPartials)
           Set an instance partials buffer.
       BEAGLE_DLLEXPORT int <b>beagleGetPartials</b> (int instance, int bufferIndex, int scaleIndex, double
           *outPartials)
           Get partials from an instance buffer.
       BEAGLE_DLLEXPORT int <b>beagleSetEigenDecomposition</b> (int instance, int eigenIndex, const double
           *inEigenVectors, const double *inInverseEigenVectors, const double *inEigenValues)
           Set an eigen-decomposition buffer.
       BEAGLE_DLLEXPORT int <b>beagleSetStateFrequencies</b> (int instance, int stateFrequenciesIndex, const double
           *inStateFrequencies)
           Set a state frequency buffer.
       BEAGLE_DLLEXPORT int <b>beagleSetCategoryWeights</b> (int instance, int categoryWeightsIndex, const double
           *inCategoryWeights)
           Set a category weights buffer.
       BEAGLE_DLLEXPORT int <b>beagleSetCategoryRates</b> (int instance, const double *inCategoryRates)
           Set the default category rates buffer.
       BEAGLE_DLLEXPORT int <b>beagleSetCategoryRatesWithIndex</b> (int instance, int categoryRatesIndex, const double
           *inCategoryRates)
           Set a category rates buffer.
       BEAGLE_DLLEXPORT int <b>beagleSetPatternWeights</b> (int instance, const double *inPatternWeights)
           Set pattern weights.
       BEAGLE_DLLEXPORT int <b>beagleSetPatternPartitions</b> (int instance, int partitionCount, const int
           *inPatternPartitions)
           Set pattern partition assignments.
       BEAGLE_DLLEXPORT int <b>beagleConvolveTransitionMatrices</b> (int instance, const int *firstIndices, const int
           *secondIndices, const int *resultIndices, int matrixCount)
           Set partitions by pattern weight.
       BEAGLE_DLLEXPORT int <b>beagleUpdateTransitionMatrices</b> (int instance, int eigenIndex, const int
           *probabilityIndices, const int *firstDerivativeIndices, const int *secondDerivativeIndices, const
           double *edgeLengths, int count)
           Calculate a list of transition probability matrices.
       BEAGLE_DLLEXPORT int <b>beagleUpdateTransitionMatricesWithMultipleModels</b> (int instance, const int
           *eigenIndices, const int *categoryRateIndices, const int *probabilityIndices, const int
           *firstDerivativeIndices, const int *secondDerivativeIndices, const double *edgeLengths, int count)
           Calculate a list of transition probability matrices with multiple models.
       BEAGLE_DLLEXPORT int <b>beagleSetTransitionMatrix</b> (int instance, int matrixIndex, const double *inMatrix,
           double paddedValue)
           Set a finite-time transition probability matrix.
       BEAGLE_DLLEXPORT int <b>beagleGetTransitionMatrix</b> (int instance, int matrixIndex, double *outMatrix)
           Get a finite-time transition probability matrix.
       BEAGLE_DLLEXPORT int <b>beagleSetTransitionMatrices</b> (int instance, const int *matrixIndices, const double
           *inMatrices, const double *paddedValues, int count)
           Set multiple transition matrices.
       BEAGLE_DLLEXPORT int <b>beagleUpdatePartials</b> (const int instance, const <b>BeagleOperation</b> *operations, int
           operationCount, int cumulativeScaleIndex)
           Calculate or queue for calculation partials using a list of operations.
       BEAGLE_DLLEXPORT int <b>beagleUpdatePartialsByPartition</b> (const int instance, const
           <b>BeagleOperationByPartition</b> *operations, int operationCount)
           Calculate or queue for calculation partials using a list of partition operations.
       BEAGLE_DLLEXPORT int <b>beagleWaitForPartials</b> (const int instance, const int *destinationPartials, int
           destinationPartialsCount)
           Block until all calculations that write to the specified partials have completed.
       BEAGLE_DLLEXPORT int <b>beagleAccumulateScaleFactors</b> (int instance, const int *scaleIndices, int count, int
           cumulativeScaleIndex)
           Accumulate scale factors.
       BEAGLE_DLLEXPORT int <b>beagleAccumulateScaleFactorsByPartition</b> (int instance, const int *scaleIndices, int
           count, int cumulativeScaleIndex, int partitionIndex)
           Accumulate scale factors by partition.
       BEAGLE_DLLEXPORT int <b>beagleRemoveScaleFactors</b> (int instance, const int *scaleIndices, int count, int
           cumulativeScaleIndex)
           Remove scale factors.
       BEAGLE_DLLEXPORT int <b>beagleRemoveScaleFactorsByPartition</b> (int instance, const int *scaleIndices, int
           count, int cumulativeScaleIndex, int partitionIndex)
           Remove scale factors by partition.
       BEAGLE_DLLEXPORT int <b>beagleResetScaleFactors</b> (int instance, int cumulativeScaleIndex)
           Reset scalefactors.
       BEAGLE_DLLEXPORT int <b>beagleResetScaleFactorsByPartition</b> (int instance, int cumulativeScaleIndex, int
           partitionIndex)
           Reset scalefactors by partition.
       BEAGLE_DLLEXPORT int <b>beagleCopyScaleFactors</b> (int instance, int destScalingIndex, int srcScalingIndex)
           Copy scale factors.
       BEAGLE_DLLEXPORT int <b>beagleGetScaleFactors</b> (int instance, int srcScalingIndex, double *outScaleFactors)
           Get scale factors.
       BEAGLE_DLLEXPORT int <b>beagleCalculateRootLogLikelihoods</b> (int instance, const int *bufferIndices, const int
           *categoryWeightsIndices, const int *stateFrequenciesIndices, const int *cumulativeScaleIndices, int
           count, double *outSumLogLikelihood)
           Calculate site log likelihoods at a root node.
       BEAGLE_DLLEXPORT int <b>beagleCalculateRootLogLikelihoodsByPartition</b> (int instance, const int
           *bufferIndices, const int *categoryWeightsIndices, const int *stateFrequenciesIndices, const int
           *cumulativeScaleIndices, const int *partitionIndices, int partitionCount, int count, double
           *outSumLogLikelihoodByPartition, double *outSumLogLikelihood)
           Calculate site log likelihoods at a root node with per partition buffers.
       BEAGLE_DLLEXPORT int <b>beagleCalculateEdgeLogLikelihoods</b> (int instance, const int *parentBufferIndices,
           const int *childBufferIndices, const int *probabilityIndices, const int *firstDerivativeIndices,
           const int *secondDerivativeIndices, const int *categoryWeightsIndices, const int
           *stateFrequenciesIndices, const int *cumulativeScaleIndices, int count, double *outSumLogLikelihood,
           double *outSumFirstDerivative, double *outSumSecondDerivative)
           Calculate site log likelihoods and derivatives along an edge.
       BEAGLE_DLLEXPORT int <b>beagleCalculateEdgeLogLikelihoodsByPartition</b> (int instance, const int
           *parentBufferIndices, const int *childBufferIndices, const int *probabilityIndices, const int
           *firstDerivativeIndices, const int *secondDerivativeIndices, const int *categoryWeightsIndices, const
           int *stateFrequenciesIndices, const int *cumulativeScaleIndices, const int *partitionIndices, int
           partitionCount, int count, double *outSumLogLikelihoodByPartition, double *outSumLogLikelihood,
           double *outSumFirstDerivativeByPartition, double *outSumFirstDerivative, double
           *outSumSecondDerivativeByPartition, double *outSumSecondDerivative)
           Calculate multiple site log likelihoods and derivatives along an edge with per partition buffers.
       BEAGLE_DLLEXPORT int <b>beagleGetLogLikelihood</b> (int instance, double *outSumLogLikelihood)
           Returns log likelihood sum and subsequent to an asynchronous integration call.
       BEAGLE_DLLEXPORT int <b>beagleGetDerivatives</b> (int instance, double *outSumFirstDerivative, double
           *outSumSecondDerivative)
           Returns derivative sums subsequent to an asynchronous integration call.
       BEAGLE_DLLEXPORT int <b>beagleGetSiteLogLikelihoods</b> (int instance, double *outLogLikelihoods)
           Get site log likelihoods for last beagleCalculateRootLogLikelihoods or
           beagleCalculateEdgeLogLikelihoods call.
       BEAGLE_DLLEXPORT int <b>beagleGetSiteDerivatives</b> (int instance, double *outFirstDerivatives, double
           *outSecondDerivatives)
           Get site derivatives for last beagleCalculateEdgeLogLikelihoods call.

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       This file documents the API as well as header for the Broad-platform Evolutionary Analysis General
       Likelihood Evaluator.

       Copyright 2009-2013 Phylogenetic Likelihood Working Group

       This file is part of BEAGLE.

       BEAGLE is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser
       General Public License as published by the Free Software Foundation, either version 3 of the License, or
       (at your option) any later version.

       BEAGLE is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the
       implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General
       Public License for more details.

       You should have received a copy of the GNU Lesser General Public License along with BEAGLE. If not, see
       <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.

       KEY CONCEPTS

       The key to BEAGLE performance lies in delivering fine-scale parallelization while minimizing data
       transfer and memory copy overhead. To accomplish this, the library lacks the concept of data structure
       for a tree, in spite of the intended use for phylogenetic analysis. Instead, BEAGLE acts directly on
       flexibly indexed data storage (called buffers) for observed character states and partial likelihoods. The
       client program can set the input buffers to reflect the data and can calculate the likelihood of a
       particular phylogeny by invoking likelihood calculations on the appropriate input and output buffers in
       the correct order. Because of this design simplicity, the library can support many different tree
       inference algorithms and likelihood calculation on a variety of models. Arbitrary numbers of states can
       be used, as can nonreversible substitution matrices via complex eigen decompositions, and mixture models
       with multiple rate categories and/or multiple eigen decompositions. Finally, BEAGLE application
       programming interface (API) calls can be asynchronous, allowing the calling program to implement other
       coarse-scale parallelization schemes such as evaluating independent genes or running concurrent Markov
       chains.

       USAGE

       To use the library, a client program first creates an instance of BEAGLE by calling beagleCreateInstance;
       multiple instances per client are possible and encouraged. All additional functions are called with a
       reference to this instance. The client program can optionally request that an instance run on certain
       hardware (e.g., a GPU) or have particular features (e.g., double-precision math). Next, the client
       program must specify the data dimensions and specify key aspects of the phylogenetic model. Character
       state data are then loaded and can be in the form of discrete observed states or partial likelihoods for
       ambiguous characters. The observed data are usually unchanging and loaded only once at the start to
       minimize memory copy overhead. The character data can be compressed into unique “site patterns” and
       associated weights for each. The parameters of the substitution process can then be specified, including
       the equilibrium state frequencies, the rates for one or more substitution rate categories and their
       weights, and finally, the eigen decomposition for the substitution process.

       In order to calculate the likelihood of a particular tree, the client program then specifies a series of
       integration operations that correspond to steps in Felsenstein’s algorithm. Finite-time transition
       probabilities for each edge are loaded directly if considering a nondiagonalizable model or calculated in
       parallel from the eigen decomposition and edge lengths specified. This is performed within BEAGLE’s
       memory space to minimize data transfers. A single function call will then request one or more integration
       operations to calculate partial likelihoods over some or all nodes. The operations are performed in the
       order they are provided, typically dictated by a postorder traversal of the tree topology. The client
       needs only specify nodes for which the partial likelihoods need updating, but it is up to the calling
       software to keep track of these dependencies. The final step in evaluating the phylogenetic model is done
       using an API call that yields a single log likelihood for the model given the data.

       Aspects of the BEAGLE API design support both maximum likelihood (ML) and Bayesian phylogenetic tree
       inference. For ML inference, API calls can calculate first and second derivatives of the likelihood with
       respect to the lengths of edges (branches). In both cases, BEAGLE provides the ability to cache and reuse
       previously computed partial likelihood results, which can yield a tremendous speedup over recomputing the
       entire likelihood every time a new phylogenetic model is evaluated.

       <b>Author</b>
           Likelihood API Working Group

           Daniel Ayres

           Peter Beerli

           Michael Cummings

           Aaron Darling

           Mark Holder

           John Huelsenbeck

           Paul Lewis

           Michael Ott

           Andrew Rambaut

           Fredrik Ronquist

           Marc Suchard

           David Swofford

           Derrick Zwickl

</pre><h4><b>Enumeration</b> <b>Type</b> <b>Documentation</b></h4><pre>
   <b>enum</b> <b>BeagleBenchmarkFlags</b>
       Benchmarking mode flags for resource performance evaluation with beagleGetOrderedResourceList.

       This enumerates all possible benchmarking mode flags. Each mode is a bit in a 'long'

       <b>Enumerator</b>

       <u>BEAGLE_BENCHFLAG_SCALING_NONE</u>
              No scaling

       <u>BEAGLE_BENCHFLAG_SCALING_ALWAYS</u>
              Scale at every iteration

       <u>BEAGLE_BENCHFLAG_SCALING_DYNAMIC</u>
              Scale  every fixed number of iterations or when a numerical error occurs, and re-use scale factors
              for subsequent iterations

   <b>enum</b> <b>BeagleFlags</b>
       Hardware and implementation capability flags.

       This enumerates all possible hardware and implementation capability flags. Each capability is a bit in  a
       'long'

       <b>Enumerator</b>

       <u>BEAGLE_FLAG_PRECISION_SINGLE</u>
              Single precision computation

       <u>BEAGLE_FLAG_PRECISION_DOUBLE</u>
              Double precision computation

       <u>BEAGLE_FLAG_COMPUTATION_SYNCH</u>
              Synchronous computation (blocking)

       <u>BEAGLE_FLAG_COMPUTATION_ASYNCH</u>
              Asynchronous computation (non-blocking)

       <u>BEAGLE_FLAG_EIGEN_REAL</u>
              Real eigenvalue computation

       <u>BEAGLE_FLAG_EIGEN_COMPLEX</u>
              Complex eigenvalue computation

       <u>BEAGLE_FLAG_SCALING_MANUAL</u>
              Manual scaling

       <u>BEAGLE_FLAG_SCALING_AUTO</u>
              Auto-scaling on (deprecated, may not work correctly)

       <u>BEAGLE_FLAG_SCALING_ALWAYS</u>
              Scale at every updatePartials (deprecated, may not work correctly)

       <u>BEAGLE_FLAG_SCALING_DYNAMIC</u>
              Manual scaling with dynamic checking (deprecated, may not work correctly)

       <u>BEAGLE_FLAG_SCALERS_RAW</u>
              Save raw scalers

       <u>BEAGLE_FLAG_SCALERS_LOG</u>
              Save log scalers

       <u>BEAGLE_FLAG_INVEVEC_STANDARD</u>
              Inverse eigen vectors passed to BEAGLE have not been transposed

       <u>BEAGLE_FLAG_INVEVEC_TRANSPOSED</u>
              Inverse eigen vectors passed to BEAGLE have been transposed

       <u>BEAGLE_FLAG_VECTOR_SSE</u>
              SSE computation

       <u>BEAGLE_FLAG_VECTOR_AVX</u>
              AVX computation

       <u>BEAGLE_FLAG_VECTOR_NONE</u>
              No vector computation

       <u>BEAGLE_FLAG_THREADING_CPP</u>
              C++11 threading

       <u>BEAGLE_FLAG_THREADING_OPENMP</u>
              OpenMP threading

       <u>BEAGLE_FLAG_THREADING_NONE</u>
              No threading (default)

       <u>BEAGLE_FLAG_PROCESSOR_CPU</u>
              Use CPU as main processor

       <u>BEAGLE_FLAG_PROCESSOR_GPU</u>
              Use GPU as main processor

       <u>BEAGLE_FLAG_PROCESSOR_FPGA</u>
              Use FPGA as main processor

       <u>BEAGLE_FLAG_PROCESSOR_CELL</u>
              Use Cell as main processor

       <u>BEAGLE_FLAG_PROCESSOR_PHI</u>
              Use Intel Phi as main processor

       <u>BEAGLE_FLAG_PROCESSOR_OTHER</u>
              Use other type of processor

       <u>BEAGLE_FLAG_FRAMEWORK_CUDA</u>
              Use CUDA implementation with GPU resources

       <u>BEAGLE_FLAG_FRAMEWORK_OPENCL</u>
              Use OpenCL implementation with GPU resources

       <u>BEAGLE_FLAG_FRAMEWORK_CPU</u>
              Use CPU implementation

       <u>BEAGLE_FLAG_PARALLELOPS_STREAMS</u>
              Operations in updatePartials may be assigned to separate device streams

       <u>BEAGLE_FLAG_PARALLELOPS_GRID</u>
              Operations  in  updatePartials  may be folded into single kernel launch (necessary for partitions;
              typically performs better for problems with fewer pattern sites)

   <b>enum</b> <b>BeagleOpCodes</b>
       Operation codes.

       This enumerates all possible BEAGLE operation codes.

       <b>Enumerator</b>

       <u>BEAGLE_OP_COUNT</u>
              Total number of integers per beagleUpdatePartials operation

       <u>BEAGLE_PARTITION_OP_COUNT</u>
              Total number of integers per beagleUpdatePartialsByPartition operation

       <u>BEAGLE_OP_NONE</u>
              Specify no use for indexed buffer

   <b>enum</b> <b>BeagleReturnCodes</b>
       Error return codes.

       This enumerates all possible BEAGLE return codes. Error codes are always negative.

       <b>Enumerator</b>

       <u>BEAGLE_SUCCESS</u>
              Success

       <u>BEAGLE_ERROR_GENERAL</u>
              Unspecified error

       <u>BEAGLE_ERROR_OUT_OF_MEMORY</u>
              Not enough memory could be allocated

       <u>BEAGLE_ERROR_UNIDENTIFIED_EXCEPTION</u>
              Unspecified exception

       <u>BEAGLE_ERROR_UNINITIALIZED_INSTANCE</u>
              The instance index is out of range, or the instance has not been created

       <u>BEAGLE_ERROR_OUT_OF_RANGE</u>
              One of the indices specified exceeded the range of the array

       <u>BEAGLE_ERROR_NO_RESOURCE</u>
              No resource matches requirements

       <u>BEAGLE_ERROR_NO_IMPLEMENTATION</u>
              No implementation matches requirements

       <u>BEAGLE_ERROR_FLOATING_POINT</u>
              Floating-point error (e.g., NaN)

</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleAccumulateScaleFactors</b> <b>(int</b> <b>instance,</b> <b>const</b> <b>int</b> <b>*</b>  <b>scaleIndices,</b>  <b>int</b>  <b>count,</b>  <b>int</b>
       <b>cumulativeScaleIndex)</b>
       Accumulate  scale  factors.  This  function  adds  (log)  scale  factors from a list of scaleBuffers to a
       cumulative scale buffer. It is used to calculate the marginal scaling at a specific node for each site.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>scaleIndices</u> List of scaleBuffers to add (input)
           <u>count</u> Number of scaleBuffers in list (input)
           <u>cumulativeScaleIndex</u> Index number of scaleBuffer to accumulate factors into (input)

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleAccumulateScaleFactorsByPartition</b> <b>(int</b> <b>instance,</b> <b>const</b>  <b>int</b>  <b>*</b>  <b>scaleIndices,</b>  <b>int</b>
       <b>count,</b> <b>int</b> <b>cumulativeScaleIndex,</b> <b>int</b> <b>partitionIndex)</b>
       Accumulate scale factors by partition. This function adds (log) scale factors from a list of scaleBuffers
       to  a  cumulative  scale buffer. It is used to calculate the marginal scaling at a specific node for each
       site.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>scaleIndices</u> List of scaleBuffers to add (input)
           <u>count</u> Number of scaleBuffers in list (input)
           <u>cumulativeScaleIndex</u> Index number of scaleBuffer to accumulate factors into (input)
           <u>partitionIndex</u> Index of partition to accumulate into (input)

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleCalculateEdgeLogLikelihoods</b> <b>(int</b> <b>instance,</b> <b>const</b> <b>int</b> <b>*</b> <b>parentBufferIndices,</b>  <b>const</b>
       <b>int</b> <b>*</b> <b>childBufferIndices,</b> <b>const</b> <b>int</b> <b>*</b> <b>probabilityIndices,</b> <b>const</b> <b>int</b> <b>*</b> <b>firstDerivativeIndices,</b> <b>const</b> <b>int</b> <b>*</b>
       <b>secondDerivativeIndices,</b>  <b>const</b>  <b>int</b> <b>*</b> <b>categoryWeightsIndices,</b> <b>const</b> <b>int</b> <b>*</b> <b>stateFrequenciesIndices,</b> <b>const</b>
       <b>int</b> <b>*</b> <b>cumulativeScaleIndices,</b> <b>int</b> <b>count,</b> <b>double</b> <b>*</b> <b>outSumLogLikelihood,</b>  <b>double</b>  <b>*</b>  <b>outSumFirstDerivative,</b>
       <b>double</b> <b>*</b> <b>outSumSecondDerivative)</b>
       Calculate site log likelihoods and derivatives along an edge. This function integrates a list of partials
       at  a parent and child node with respect to a set of partials-weights and state frequencies to return the
       log likelihood and first and second derivative sums

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>parentBufferIndices</u> List of indices of parent partialsBuffers (input)
           <u>childBufferIndices</u> List of indices of child partialsBuffers (input)
           <u>probabilityIndices</u> List indices of transition probability matrices for this edge (input)
           <u>firstDerivativeIndices</u> List indices of first derivative matrices (input)
           <u>secondDerivativeIndices</u> List indices of second derivative matrices (input)
           <u>categoryWeightsIndices</u> List of weights to apply to each partialsBuffer (input)
           <u>stateFrequenciesIndices</u> List of state frequencies for each partialsBuffer (input).  There  should  be
           one set for each of parentBufferIndices
           <u>cumulativeScaleIndices</u>  List  of  scaleBuffers  containing  accumulated  factors  to  apply  to  each
           partialsBuffer (input). There should be one index for each of parentBufferIndices
           <u>count</u> Number of partialsBuffers (input)
           <u>outSumLogLikelihood</u> Pointer to destination for resulting log likelihood (output)
           <u>outSumFirstDerivative</u> Pointer to destination for resulting first derivative (output)
           <u>outSumSecondDerivative</u> Pointer to destination for resulting second derivative (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>   <b>int</b>   <b>beagleCalculateEdgeLogLikelihoodsByPartition</b>   <b>(int</b>   <b>instance,</b>    <b>const</b>    <b>int</b>    <b>*</b>
       <b>parentBufferIndices,</b>  <b>const</b>  <b>int</b>  <b>*</b>  <b>childBufferIndices,</b>  <b>const</b>  <b>int</b>  <b>*</b>  <b>probabilityIndices,</b>  <b>const</b> <b>int</b> <b>*</b>
       <b>firstDerivativeIndices,</b> <b>const</b> <b>int</b> <b>*</b> <b>secondDerivativeIndices,</b> <b>const</b> <b>int</b>  <b>*</b>  <b>categoryWeightsIndices,</b>  <b>const</b>
       <b>int</b>  <b>*</b>  <b>stateFrequenciesIndices,</b>  <b>const</b>  <b>int</b>  <b>*</b> <b>cumulativeScaleIndices,</b> <b>const</b> <b>int</b> <b>*</b> <b>partitionIndices,</b> <b>int</b>
       <b>partitionCount,</b> <b>int</b> <b>count,</b> <b>double</b> <b>*</b> <b>outSumLogLikelihoodByPartition,</b> <b>double</b> <b>*</b> <b>outSumLogLikelihood,</b>  <b>double</b>
       <b>*</b>      <b>outSumFirstDerivativeByPartition,</b>      <b>double</b>      <b>*</b>      <b>outSumFirstDerivative,</b>      <b>double</b>     <b>*</b>
       <b>outSumSecondDerivativeByPartition,</b> <b>double</b> <b>*</b> <b>outSumSecondDerivative)</b>
       Calculate multiple site log likelihoods and derivatives along an edge with per  partition  buffers.  This
       function  integrates  lists  of  partials  at  a parent and child node with respect to a set of partials-
       weights and state frequencies to return the log likelihood and first and second derivative sums

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>parentBufferIndices</u> List of indices of parent partialsBuffers (input)
           <u>childBufferIndices</u> List of indices of child partialsBuffers (input)
           <u>probabilityIndices</u> List indices of transition probability matrices for this edge (input)
           <u>firstDerivativeIndices</u> List indices of first derivative matrices (input)
           <u>secondDerivativeIndices</u> List indices of second derivative matrices (input)
           <u>categoryWeightsIndices</u> List of weights to apply to each partialsBuffer (input)
           <u>stateFrequenciesIndices</u> List of state frequencies for each partialsBuffer (input).  There  should  be
           one set for each of parentBufferIndices
           <u>cumulativeScaleIndices</u>  List  of  scaleBuffers  containing  accumulated  factors  to  apply  to  each
           partialsBuffer (input). There should be one index for each of parentBufferIndices
           <u>partitionIndices</u> List of partition indices indicating which sites in each  partialsBuffer  should  be
           used (input). There should be one index for each of parentBufferIndices
           <u>partitionCount</u> Number of distinct partitionIndices (input)
           <u>count</u> Number of sets of partitions to integrate across (input)
           <u>outSumLogLikelihoodByPartition</u>  Pointer  to  destination  for  resulting  log  likelihoods  for  each
           partition (output)
           <u>outSumLogLikelihood</u> Pointer to destination for resulting log likelihood (output)
           <u>outSumFirstDerivativeByPartition</u> Pointer to destination  for  resulting  first  derivative  for  each
           partition (output)
           <u>outSumFirstDerivative</u> Pointer to destination for resulting first derivative (output)
           <u>outSumSecondDerivativeByPartition</u>  Pointer  to  destination  for resulting second derivative for each
           partition (output)
           <u>outSumSecondDerivative</u> Pointer to destination for resulting second derivative (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleCalculateRootLogLikelihoods</b> <b>(int</b> <b>instance,</b> <b>const</b> <b>int</b> <b>*</b> <b>bufferIndices,</b> <b>const</b> <b>int</b>  <b>*</b>
       <b>categoryWeightsIndices,</b>  <b>const</b>  <b>int</b>  <b>*</b>  <b>stateFrequenciesIndices,</b>  <b>const</b> <b>int</b> <b>*</b> <b>cumulativeScaleIndices,</b> <b>int</b>
       <b>count,</b> <b>double</b> <b>*</b> <b>outSumLogLikelihood)</b>
       Calculate site log likelihoods at a root node. This function integrates a list of partials at a node with
       respect to a set of partials-weights and state frequencies to return the log likelihood sum

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>bufferIndices</u> List of partialsBuffer indices to integrate (input)
           <u>categoryWeightsIndices</u> List of weights to apply to each partialsBuffer (input). There should  be  one
           categoryCount sized set for each of parentBufferIndices
           <u>stateFrequenciesIndices</u>  List  of  state frequencies for each partialsBuffer (input). There should be
           one set for each of parentBufferIndices
           <u>cumulativeScaleIndices</u>  List  of  scaleBuffers  containing  accumulated  factors  to  apply  to  each
           partialsBuffer (input). There should be one index for each of parentBufferIndices
           <u>count</u> Number of partialsBuffer to integrate (input)
           <u>outSumLogLikelihood</u> Pointer to destination for resulting log likelihood (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b>  <b>beagleCalculateRootLogLikelihoodsByPartition</b> <b>(int</b> <b>instance,</b> <b>const</b> <b>int</b> <b>*</b> <b>bufferIndices,</b>
       <b>const</b>   <b>int</b>   <b>*</b>   <b>categoryWeightsIndices,</b>   <b>const</b>   <b>int</b>   <b>*</b>   <b>stateFrequenciesIndices,</b>   <b>const</b>   <b>int</b>    <b>*</b>
       <b>cumulativeScaleIndices,</b>   <b>const</b>   <b>int</b>  <b>*</b>  <b>partitionIndices,</b>  <b>int</b>  <b>partitionCount,</b>  <b>int</b>  <b>count,</b>  <b>double</b>  <b>*</b>
       <b>outSumLogLikelihoodByPartition,</b> <b>double</b> <b>*</b> <b>outSumLogLikelihood)</b>
       Calculate site log likelihoods at a root node with per partition buffers. This function integrates  lists
       of  partials  at a node with respect to a set of partials-weights and state frequencies to return the log
       likelihood sums

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>bufferIndices</u> List of partialsBuffer indices to integrate (input)
           <u>categoryWeightsIndices</u> List of weights to apply to each partialsBuffer (input). There should  be  one
           categoryCount sized set for each of bufferIndices
           <u>stateFrequenciesIndices</u>  List  of  state frequencies for each partialsBuffer (input). There should be
           one set for each of bufferIndices
           <u>cumulativeScaleIndices</u>  List  of  scaleBuffers  containing  accumulated  factors  to  apply  to  each
           partialsBuffer (input). There should be one index for each of bufferIndices
           <u>partitionIndices</u>  List  of  partition indices indicating which sites in each partialsBuffer should be
           used (input). There should be one index for each of bufferIndices
           <u>partitionCount</u> Number of distinct partitionIndices (input)
           <u>count</u> Number of sets of partitions to integrate across (input)
           <u>outSumLogLikelihoodByPartition</u>  Pointer  to  destination  for  resulting  log  likelihoods  for  each
           partition (output)
           <u>outSumLogLikelihood</u> Pointer to destination for resulting log likelihood (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b>  <b>beagleConvolveTransitionMatrices</b>  <b>(int</b> <b>instance,</b> <b>const</b> <b>int</b> <b>*</b> <b>firstIndices,</b> <b>const</b> <b>int</b> <b>*</b>
       <b>secondIndices,</b> <b>const</b> <b>int</b> <b>*</b> <b>resultIndices,</b> <b>int</b> <b>matrixCount)</b>
       Set partitions by pattern weight. This function defines partitions by setting their vectors  of  pattern-
       weights for an instance. It should be called after beagleSetTipPartials or beagleSetTipStates.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>inPartitionPatternWeights</u> partitionCount arrays, each containing patternCount pattern weights (input)
           <u>partitionCount</u> Number of partitions (input)

       <b>Returns</b>
           error code

       Convolve lists of transition probability matrices

       This function convolves two lists of transition probability matrices.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>firstIndices</u> List of indices of the first transition probability matrices to convolve (input)
           <u>secondIndices</u> List of indices of the second transition probability matrices to convolve (input)
           <u>resultIndices</u> List of indices of resulting transition probability matrices (input)
           <u>matrixCount</u> Length of lists

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleCopyScaleFactors</b> <b>(int</b> <b>instance,</b> <b>int</b> <b>destScalingIndex,</b> <b>int</b> <b>srcScalingIndex)</b>
       Copy scale factors. This function copies scale factors from one buffer to another.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>destScalingIndex</u> Destination scaleBuffer (input)
           <u>srcScalingIndex</u> Source scaleBuffer (input)

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleCreateInstance</b> <b>(int</b> <b>tipCount,</b> <b>int</b> <b>partialsBufferCount,</b> <b>int</b> <b>compactBufferCount,</b> <b>int</b>
       <b>stateCount,</b>  <b>int</b>  <b>patternCount,</b>  <b>int</b>  <b>eigenBufferCount,</b>  <b>int</b>  <b>matrixBufferCount,</b>  <b>int</b>  <b>categoryCount,</b> <b>int</b>
       <b>scaleBufferCount,</b> <b>int</b> <b>*</b> <b>resourceList,</b> <b>int</b> <b>resourceCount,</b>  <b>long</b>  <b>preferenceFlags,</b>  <b>long</b>  <b>requirementFlags,</b>
       <b>BeagleInstanceDetails</b> <b>*</b> <b>returnInfo)</b>
       Create a single instance. This function creates a single instance of the BEAGLE library and can be called
       multiple times to create multiple data partition instances each returning a unique identifier.

       <b>Parameters</b>
           <u>tipCount</u> Number of tip data elements (input)
           <u>partialsBufferCount</u> Number of partials buffers to create (input)
           <u>compactBufferCount</u> Number of compact state representation buffers to create (input)
           <u>stateCount</u> Number of states in the continuous-time Markov chain (input)
           <u>patternCount</u> Number of site patterns to be handled by the instance (input)
           <u>eigenBufferCount</u>  Number  of  rate  matrix  eigen-decomposition, category weight, category rates, and
           state frequency buffers to allocate (input)
           <u>matrixBufferCount</u> Number of transition probability matrix buffers (input)
           <u>categoryCount</u> Number of rate categories (input)
           <u>scaleBufferCount</u> Number of scale buffers to create, ignored for auto scale or always scale (input)
           <u>resourceList</u> List of potential resources on which this instance is allowed (input,  NULL  implies  no
           restriction)
           <u>resourceCount</u> Length of resourceList list (input)
           <u>preferenceFlags</u>  Bit-flags  indicating  preferred  implementation  characteristics,  see  BeagleFlags
           (input)
           <u>requirementFlags</u>  Bit-flags  indicating  required  implementation  characteristics,  see  BeagleFlags
           (input)
           <u>returnInfo</u> Pointer to return implementation and resource details

       <b>Returns</b>
           the unique instance identifier (&lt;0 if failed, see <b>BeagleReturnCodes</b>)

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleFinalize</b> <b>(void)</b>
       Finalize  the  library.  This  function  finalizes  the  library  and releases all allocated memory. This
       function is automatically called under GNU C via <b>attribute</b> ((destructor)).

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleFinalizeInstance</b> <b>(int</b> <b>instance)</b>
       Finalize this instance. This function finalizes the instance by releasing allocated memory

       <b>Parameters</b>
           <u>instance</u> Instance number

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>   <b>BeagleBenchmarkedResourceList*</b>   <b>beagleGetBenchmarkedResourceList</b>   <b>(int</b>   <b>tipCount,</b>   <b>int</b>
       <b>compactBufferCount,</b>  <b>int</b>  <b>stateCount,</b>  <b>int</b>  <b>patternCount,</b>  <b>int</b>  <b>categoryCount,</b>  <b>int</b>  <b>*</b>  <b>resourceList,</b> <b>int</b>
       <b>resourceCount,</b> <b>long</b> <b>preferenceFlags,</b> <b>long</b> <b>requirementFlags,</b> <b>int</b> <b>eigenModelCount,</b> <b>int</b> <b>partitionCount,</b>  <b>int</b>
       <b>calculateDerivatives,</b> <b>long</b> <b>benchmarkFlags)</b>
       Get  a  benchmarked list of hardware resources for the given analysis parameters. This function returns a
       pointer to a <b>BeagleBenchmarkedResourceList</b>  struct,  which  includes  a  <b>BeagleBenchmarkedResource</b>  array
       describing  the  available  hardware  resources  with benchmark times and CPU performance ratios for each
       resource. Resources are benchmarked with the given analysis parameters and  the  array  is  ordered  from
       fastest to slowest. If there is an error the function returns NULL.

       <b>Parameters</b>
           <u>tipCount</u> Number of tip data elements (input)
           <u>compactBufferCount</u> Number of compact state representation tips (input)
           <u>stateCount</u> Number of states in the continuous-time Markov chain (input)
           <u>patternCount</u> Number of site patterns (input)
           <u>categoryCount</u> Number of rate categories (input)
           <u>resourceList</u> List of resources to be benchmarked, NULL implies no restriction (input)
           <u>resourceCount</u> Length of resourceList list (input)
           <u>preferenceFlags</u>  Bit-flags  indicating  preferred  implementation  characteristics,  see  BeagleFlags
           (input)
           <u>requirementFlags</u>  Bit-flags  indicating  required  implementation  characteristics,  see  BeagleFlags
           (input)
           <u>eigenModelCount</u> Number of full-alignment rate matrix eigen-decomposition models (input)
           <u>partitionCount</u> Number of partitions (input)
           <u>calculateDerivatives</u> Indicates if calculation of derivatives are required (input)
           <u>benchmarkFlags</u> Bit-flags indicating benchmarking preferences (input)

       <b>Returns</b>
           An  ordered  (fastest  to  slowest)  list  of  hardware  resources  available  to  the  library  as a
           <b>BeagleBenchmarkedResourceList</b> for the specified analysis parameters

   <b>BEAGLE_DLLEXPORT</b> <b>const</b> <b>char*</b> <b>beagleGetCitation</b> <b>(void)</b>
       Get citation. This function returns a pointer to a string describing the version of the library  and  how
       to cite it.

       <b>Returns</b>
           A string describing the version of the library and how to cite it

   <b>BEAGLE_DLLEXPORT</b>   <b>int</b>   <b>beagleGetDerivatives</b>   <b>(int</b>  <b>instance,</b>  <b>double</b>  <b>*</b>  <b>outSumFirstDerivative,</b>  <b>double</b>  <b>*</b>
       <b>outSumSecondDerivative)</b>
       Returns derivative sums subsequent to an asynchronous integration call. This  function  is  optional  and
       only   has   to   be   called  by  clients  that  use  the  non-blocking  asynchronous  computation  mode
       (BEAGLE_FLAG_COMPUTATION_ASYNCH).

       If used, this function must be called after a beagleCalculateEdgeLogLikelihoods call.  The  library  will
       block until the derivatiives have been calculated.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>outSumFirstDerivative</u> Pointer to destination for resulting first derivative (output)
           <u>outSumSecondDerivative</u> Pointer to destination for resulting second derivative (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleGetLogLikelihood</b> <b>(int</b> <b>instance,</b> <b>double</b> <b>*</b> <b>outSumLogLikelihood)</b>
       Returns  log likelihood sum and subsequent to an asynchronous integration call. This function is optional
       and only  has  to  be  called  by  clients  that  use  the  non-blocking  asynchronous  computation  mode
       (BEAGLE_FLAG_COMPUTATION_ASYNCH).

       If    used,    this    function   must   be   called   after   a   beagleCalculateRootLogLikelihoods   or
       beagleCalculateEdgeLogLikelihoods call. The library will block until the likelihood has been calculated.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>outSumLogLikelihood</u> Pointer to destination for resulting log likelihood (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleGetPartials</b> <b>(int</b> <b>instance,</b> <b>int</b> <b>bufferIndex,</b> <b>int</b> <b>scaleIndex,</b> <b>double</b> <b>*</b> <b>outPartials)</b>
       Get partials from an instance buffer. This function copies an instance buffer into the array outPartials.
       The outPartials array should be stateCount * patternCount * categoryCount in length.

       <b>Parameters</b>
           <u>instance</u> Instance number from which to get partialsBuffer (input)
           <u>bufferIndex</u> Index of source partialsBuffer (input)
           <u>scaleIndex</u> Index of scaleBuffer to apply to partialsBuffer (input)
           <u>outPartials</u> Pointer to which to receive partialsBuffer (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>BeagleResourceList*</b> <b>beagleGetResourceList</b> <b>(void)</b>
       Get list of hardware resources. This function returns a pointer to  a  <b>BeagleResourceList</b>  struct,  which
       includes a <b>BeagleResource</b> array describing the available hardware resources.

       <b>Returns</b>
           A list of hardware resources available to the library as a <b>BeagleResourceList</b>

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleGetScaleFactors</b> <b>(int</b> <b>instance,</b> <b>int</b> <b>srcScalingIndex,</b> <b>double</b> <b>*</b> <b>outScaleFactors)</b>
       Get scale factors. This function retrieves a buffer of scale factors.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>srcScalingIndex</u> Source scaleBuffer (input)
           <u>outScaleFactors</u> Pointer to which to receive scaleFactors (output)

   <b>BEAGLE_DLLEXPORT</b>   <b>int</b>  <b>beagleGetSiteDerivatives</b>  <b>(int</b>  <b>instance,</b>  <b>double</b>  <b>*</b>  <b>outFirstDerivatives,</b>  <b>double</b>  <b>*</b>
       <b>outSecondDerivatives)</b>
       Get  site  derivatives  for  last  beagleCalculateEdgeLogLikelihoods  call.  This  function  returns  the
       derivatives for each site

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>outFirstDerivatives</u> Pointer to destination for resulting first derivatives (output)
           <u>outSecondDerivatives</u> Pointer to destination for resulting second derivatives (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleGetSiteLogLikelihoods</b> <b>(int</b> <b>instance,</b> <b>double</b> <b>*</b> <b>outLogLikelihoods)</b>
       Get  site log likelihoods for last beagleCalculateRootLogLikelihoods or beagleCalculateEdgeLogLikelihoods
       call. This function returns the log likelihoods for each site

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>outLogLikelihoods</u> Pointer to destination for resulting log likelihoods (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleGetTransitionMatrix</b> <b>(int</b> <b>instance,</b> <b>int</b> <b>matrixIndex,</b> <b>double</b> <b>*</b> <b>outMatrix)</b>
       Get a finite-time transition probability matrix. This function copies  a  finite-time  transition  matrix
       buffer  into  the  array  outMatrix.  The  outMatrix  array  should  be of size stateCount * stateCount *
       categoryCount and will be filled with one matrix for each rate category.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>matrixIndex</u> Index of matrix buffer (input)
           <u>outMatrix</u> Pointer to destination transition probability matrix (output)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>const</b> <b>char*</b> <b>beagleGetVersion</b> <b>(void)</b>
       Get version. This function returns a pointer to a string with the library version number.

       <b>Returns</b>
           A string with the version number

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleRemoveScaleFactors</b> <b>(int</b>  <b>instance,</b>  <b>const</b>  <b>int</b>  <b>*</b>  <b>scaleIndices,</b>  <b>int</b>  <b>count,</b>  <b>int</b>
       <b>cumulativeScaleIndex)</b>
       Remove scale factors. This function removes (log) scale factors from a cumulative scale buffer. The scale
       factors to be removed are indicated in a list of scaleBuffers.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>scaleIndices</u> List of scaleBuffers to remove (input)
           <u>count</u> Number of scaleBuffers in list (input)
           <u>cumulativeScaleIndex</u> Index number of scaleBuffer containing accumulated factors (input)

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b> <b>beagleRemoveScaleFactorsByPartition</b> <b>(int</b> <b>instance,</b> <b>const</b> <b>int</b> <b>*</b> <b>scaleIndices,</b> <b>int</b> <b>count,</b>
       <b>int</b> <b>cumulativeScaleIndex,</b> <b>int</b> <b>partitionIndex)</b>
       Remove scale factors by partition. This function removes (log) scale  factors  from  a  cumulative  scale
       buffer. The scale factors to be removed are indicated in a list of scaleBuffers.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>scaleIndices</u> List of scaleBuffers to remove (input)
           <u>count</u> Number of scaleBuffers in list (input)
           <u>cumulativeScaleIndex</u> Index number of scaleBuffer containing accumulated factors (input)
           <u>partitionIndex</u> Index of partition to remove from (input)

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleResetScaleFactors</b> <b>(int</b> <b>instance,</b> <b>int</b> <b>cumulativeScaleIndex)</b>
       Reset scalefactors. This function resets a cumulative scale buffer.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>cumulativeScaleIndex</u> Index number of cumulative scaleBuffer (input)

   <b>BEAGLE_DLLEXPORT</b>   <b>int</b>   <b>beagleResetScaleFactorsByPartition</b>  <b>(int</b>  <b>instance,</b>  <b>int</b>  <b>cumulativeScaleIndex,</b>  <b>int</b>
       <b>partitionIndex)</b>
       Reset scalefactors by partition. This function resets a cumulative scale buffer.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>cumulativeScaleIndex</u> Index number of cumulative scaleBuffer (input)
           <u>partitionIndex</u> Index of partition to reset (input)

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleSetCategoryRates</b> <b>(int</b> <b>instance,</b> <b>const</b> <b>double</b> <b>*</b> <b>inCategoryRates)</b>
       Set the default category rates buffer. This function sets the default vector of  category  rates  for  an
       instance.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>inCategoryRates</u> Array containing categoryCount rate scalers (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b>  <b>beagleSetCategoryRatesWithIndex</b>  <b>(int</b> <b>instance,</b> <b>int</b> <b>categoryRatesIndex,</b> <b>const</b> <b>double</b> <b>*</b>
       <b>inCategoryRates)</b>
       Set a category rates buffer. This function sets the vector of category rates for a  given  buffer  in  an
       instance.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>categoryRatesIndex</u> Index of category rates buffer (input)
           <u>inCategoryRates</u> Array containing categoryCount rate scalers (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b>  <b>beagleSetCategoryWeights</b>  <b>(int</b>  <b>instance,</b>  <b>int</b>  <b>categoryWeightsIndex,</b>  <b>const</b>  <b>double</b> <b>*</b>
       <b>inCategoryWeights)</b>
       Set a category weights buffer. This function copies a category weights array into an instance buffer.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>categoryWeightsIndex</u> Index of category weights buffer (input)
           <u>inCategoryWeights</u> Category weights array (categoryCount) (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleSetCPUThreadCount</b> <b>(int</b> <b>instance,</b> <b>int</b> <b>threadCount)</b>
       Set number of threads for native CPU implementation. This function sets the max number of worker  threads
       to  be  used  with  a  native CPU implementation. It should only be called after beagleCreateInstance and
       requires the BEAGLE_FLAG_THREADING_CPP flag to be set. It has no effect on GPU-based implementations.  It
       has  no  effect  with the default BEAGLE_FLAG_THREADING_NONE setting. If BEAGLE_FLAG_THREADING_CPP is set
       and this function is not called BEAGLE will use a heuristic to set an appropriate number of threads.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>threadCount</u> Number of threads (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b>  <b>beagleSetEigenDecomposition</b>  <b>(int</b>   <b>instance,</b>   <b>int</b>   <b>eigenIndex,</b>   <b>const</b>   <b>double</b>   <b>*</b>
       <b>inEigenVectors,</b> <b>const</b> <b>double</b> <b>*</b> <b>inInverseEigenVectors,</b> <b>const</b> <b>double</b> <b>*</b> <b>inEigenValues)</b>
       Set an eigen-decomposition buffer. This function copies an eigen-decomposition into an instance buffer.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>eigenIndex</u> Index of eigen-decomposition buffer (input)
           <u>inEigenVectors</u> Flattened matrix (stateCount x stateCount) of eigen-vectors (input)
           <u>inInverseEigenVectors</u> Flattened matrix (stateCount x stateCount) of inverse-eigen- vectors (input)
           <u>inEigenValues</u> Vector of eigenvalues

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleSetPartials</b> <b>(int</b> <b>instance,</b> <b>int</b> <b>bufferIndex,</b> <b>const</b> <b>double</b> <b>*</b> <b>inPartials)</b>
       Set  an  instance partials buffer. This function copies an array of partials into an instance buffer. The
       inPartials array should be stateCount * patternCount * categoryCount in length.

       <b>Parameters</b>
           <u>instance</u> Instance number in which to set a partialsBuffer (input)
           <u>bufferIndex</u> Index of destination partialsBuffer (input)
           <u>inPartials</u> Pointer to partials values to set (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b>  <b>beagleSetPatternPartitions</b>  <b>(int</b>   <b>instance,</b>   <b>int</b>   <b>partitionCount,</b>   <b>const</b>   <b>int</b>   <b>*</b>
       <b>inPatternPartitions)</b>
       Set  pattern  partition  assignments.  This  function sets the vector of pattern partition indices for an
       instance. It should only be called after beagleSetTipPartials and beagleSetPatternWeights.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>partitionCount</u> Number of partitions (input)
           <u>inPatternPartitions</u> Array containing partitionCount partition indices (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleSetPatternWeights</b> <b>(int</b> <b>instance,</b> <b>const</b> <b>double</b> <b>*</b> <b>inPatternWeights)</b>
       Set pattern weights. This function sets the vector of pattern weights for an instance.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>inPatternWeights</u> Array containing patternCount weights (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleSetStateFrequencies</b> <b>(int</b>  <b>instance,</b>  <b>int</b>  <b>stateFrequenciesIndex,</b>  <b>const</b>  <b>double</b>  <b>*</b>
       <b>inStateFrequencies)</b>
       Set a state frequency buffer. This function copies a state frequency array into an instance buffer.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>stateFrequenciesIndex</u> Index of state frequencies buffer (input)
           <u>inStateFrequencies</u> State frequencies array (stateCount) (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleSetTipPartials</b> <b>(int</b> <b>instance,</b> <b>int</b> <b>tipIndex,</b> <b>const</b> <b>double</b> <b>*</b> <b>inPartials)</b>
       Set  an instance partials buffer for tip node. This function copies an array of partials into an instance
       buffer. The inPartials array should be stateCount * patternCount in length. For  most  applications  this
       will  be  used  to  set the partial likelihoods for the observed states. Internally, the partials will be
       copied categoryCount times.

       <b>Parameters</b>
           <u>instance</u> Instance number in which to set a partialsBuffer (input)
           <u>tipIndex</u> Index of destination partialsBuffer (input)
           <u>inPartials</u> Pointer to partials values to set (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleSetTipStates</b> <b>(int</b> <b>instance,</b> <b>int</b> <b>tipIndex,</b> <b>const</b> <b>int</b> <b>*</b> <b>inStates)</b>
       Set the compact state representation for tip node. This function copies a  compact  state  representation
       into an instance buffer. Compact state representation is an array of states: 0 to stateCount - 1 (missing
       =  stateCount).  The inStates array should be patternCount in length (replication across categoryCount is
       not required).

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>tipIndex</u> Index of destination compactBuffer (input)
           <u>inStates</u> Pointer to compact states (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleSetTransitionMatrices</b> <b>(int</b> <b>instance,</b> <b>const</b> <b>int</b> <b>*</b>  <b>matrixIndices,</b>  <b>const</b>  <b>double</b>  <b>*</b>
       <b>inMatrices,</b> <b>const</b> <b>double</b> <b>*</b> <b>paddedValues,</b> <b>int</b> <b>count)</b>
       Set  multiple transition matrices. This function copies multiple transition matrices into matrix buffers.
       This function is used when the application wishes to explicitly set the transition matrices  rather  than
       using  the beagleSetEigenDecomposition and beagleUpdateTransitionMatrices functions. The inMatrices array
       should be of size stateCount * stateCount * categoryCount * count.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>matrixIndices</u> Indices of matrix buffers (input)
           <u>inMatrices</u> Pointer to source transition matrices (input)
           <u>paddedValues</u> Values to be used for padding for ambiguous states (e.g. 1 for probability  matrices,  0
           for derivative matrices) (input)
           <u>count</u> Number of transition matrices (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b>  <b>beagleSetTransitionMatrix</b>  <b>(int</b>  <b>instance,</b>  <b>int</b>  <b>matrixIndex,</b> <b>const</b> <b>double</b> <b>*</b> <b>inMatrix,</b>
       <b>double</b> <b>paddedValue)</b>
       Set  a  finite-time  transition  probability  matrix.  This  function  copies  a  finite-time  transition
       probability  matrix into a matrix buffer. This function is used when the application wishes to explicitly
       set  the  transition  probability  matrix  rather  than   using   the   beagleSetEigenDecomposition   and
       beagleUpdateTransitionMatrices  functions. The inMatrix array should be of size stateCount * stateCount *
       categoryCount and will contain one matrix for each rate category.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>matrixIndex</u> Index of matrix buffer (input)
           <u>inMatrix</u> Pointer to source transition probability matrix (input)
           <u>paddedValue</u> Value to be used for padding for ambiguous states (e.g. 1 for probability matrices, 0 for
           derivative matrices) (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleUpdatePartials</b> <b>(const</b>  <b>int</b>  <b>instance,</b>  <b>const</b>  <b>BeagleOperation</b>  <b>*</b>  <b>operations,</b>  <b>int</b>
       <b>operationCount,</b> <b>int</b> <b>cumulativeScaleIndex)</b>
       Calculate  or  queue for calculation partials using a list of operations. This function either calculates
       or queues for calculation a list partials. Implementations supporting ASYNCH may queue these calculations
       while other implementations perform these operations immediately and in order.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>operations</u> <b>BeagleOperation</b> list specifying operations (input)
           <u>operationCount</u> Number of operations (input)
           <u>cumulativeScaleIndex</u> Index number of scaleBuffer to store accumulated factors (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b> <b>int</b> <b>beagleUpdatePartialsByPartition</b> <b>(const</b> <b>int</b> <b>instance,</b> <b>const</b> <b>BeagleOperationByPartition</b>  <b>*</b>
       <b>operations,</b> <b>int</b> <b>operationCount)</b>
       Calculate  or  queue  for calculation partials using a list of partition operations. This function either
       calculates or queues for calculation a list partitioned partials. Implementations supporting  ASYNCH  may
       queue these calculations while other implementations perform these operations immediately and in order.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>operations</u> <b>BeagleOperation</b> list specifying operations (input)
           <u>operationCount</u> Number of operations (input)

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>   <b>int</b>   <b>beagleUpdateTransitionMatrices</b>   <b>(int</b>   <b>instance,</b>   <b>int</b>   <b>eigenIndex,</b>  <b>const</b>  <b>int</b>  <b>*</b>
       <b>probabilityIndices,</b> <b>const</b> <b>int</b> <b>*</b> <b>firstDerivativeIndices,</b> <b>const</b> <b>int</b> <b>*</b> <b>secondDerivativeIndices,</b> <b>const</b> <b>double</b>
       <b>*</b> <b>edgeLengths,</b> <b>int</b> <b>count)</b>
       Calculate a list of transition probability matrices.  This  function  calculates  a  list  of  transition
       probabilities matrices and their first and second derivatives (if requested).

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>eigenIndex</u> Index of eigen-decomposition buffer (input)
           <u>probabilityIndices</u> List of indices of transition probability matrices to update (input)
           <u>firstDerivativeIndices</u> List of indices of first derivative matrices to update (input, NULL implies no
           calculation)
           <u>secondDerivativeIndices</u>  List of indices of second derivative matrices to update (input, NULL implies
           no calculation)
           <u>edgeLengths</u> List of edge lengths with which to perform calculations (input)
           <u>count</u> Length of lists

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b>   <b>beagleUpdateTransitionMatricesWithMultipleModels</b>   <b>(int</b>   <b>instance,</b>   <b>const</b>   <b>int</b>   <b>*</b>
       <b>eigenIndices,</b>   <b>const</b>   <b>int</b>   <b>*</b>   <b>categoryRateIndices,</b>  <b>const</b>  <b>int</b>  <b>*</b>  <b>probabilityIndices,</b>  <b>const</b>  <b>int</b>  <b>*</b>
       <b>firstDerivativeIndices,</b> <b>const</b> <b>int</b> <b>*</b> <b>secondDerivativeIndices,</b> <b>const</b> <b>double</b> <b>*</b> <b>edgeLengths,</b> <b>int</b> <b>count)</b>
       Calculate a list of transition probability matrices with multiple models. This function calculates a list
       of transition probabilities matrices and their first and second derivatives (if requested).

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>eigenIndices</u> List of indices of eigen-decomposition buffers to use for updates (input)
           <u>categoryRateIndices</u> List of indices of category-rate buffers to use for updates (input)
           <u>probabilityIndices</u> List of indices of transition probability matrices to update (input)
           <u>firstDerivativeIndices</u> List of indices of first derivative matrices to update (input, NULL implies no
           calculation)
           <u>secondDerivativeIndices</u> List of indices of second derivative matrices to update (input, NULL  implies
           no calculation)
           <u>edgeLengths</u> List of edge lengths with which to perform calculations (input)
           <u>count</u> Length of lists

       <b>Returns</b>
           error code

   <b>BEAGLE_DLLEXPORT</b>  <b>int</b>  <b>beagleWaitForPartials</b>  <b>(const</b>  <b>int</b>  <b>instance,</b>  <b>const</b>  <b>int</b>  <b>*</b>  <b>destinationPartials,</b> <b>int</b>
       <b>destinationPartialsCount)</b>
       Block until all calculations that write to the  specified  partials  have  completed.  This  function  is
       optional and only has to be called by clients that 'recycle' partials.

       If  used,  this  function  must  be called after a beagleUpdatePartials call and must refer to indices of
       'destinationPartials' that were used in a previous beagleUpdatePartials  call.  The  library  will  block
       until those partials have been calculated.

       <b>Parameters</b>
           <u>instance</u> Instance number (input)
           <u>destinationPartials</u>  List  of  the  indices of destinationPartials that must be calculated before the
           function returns
           <u>destinationPartialsCount</u> Number of destinationPartials (input)

       <b>Returns</b>
           error code

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for BEAGLE from the source code.

Version 3.1.2                                    Tue Oct 19 2021                        <u>libhmsbeagle/<a href="../man3/beagle.h.3.html">beagle.h</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>