<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sd_bus_creds_new_from_pid, sd_bus_creds_new_from_pidfd, sd_bus_creds_get_mask,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsystemd-dev">libsystemd-dev_257.7-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sd_bus_creds_new_from_pid, sd_bus_creds_new_from_pidfd, sd_bus_creds_get_mask,
       sd_bus_creds_get_augmented_mask, sd_bus_creds_ref, sd_bus_creds_unref, sd_bus_creds_unrefp - Retrieve
       credentials object for the specified PID

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;systemd/sd-bus.h&gt;</b>

       <b>int</b> <b>sd_bus_creds_new_from_pid(pid_t</b> <u>pid</u><b>,</b> <b>uint64_t</b> <u>creds_mask</u><b>,</b> <b>sd_bus_creds</b> <b>**</b><u>ret</u><b>);</b>

       <b>int</b> <b>sd_bus_creds_new_from_pidfd(int</b> <u>pidfd</u><b>,</b> <b>uint64_t</b> <u>creds_mask</u><b>,</b> <b>sd_bus_creds</b> <b>**</b><u>ret</u><b>);</b>

       <b>uint64_t</b> <b>sd_bus_creds_get_mask(sd_bus_creds</b> <b>*</b><u>c</u><b>);</b>

       <b>uint64_t</b> <b>sd_bus_creds_get_augmented_mask(sd_bus_creds</b> <b>*</b><u>c</u><b>);</b>

       <b>sd_bus_creds</b> <b>*sd_bus_creds_ref(sd_bus_creds</b> <b>*</b><u>c</u><b>);</b>

       <b>sd_bus_creds</b> <b>*sd_bus_creds_unref(sd_bus_creds</b> <b>*</b><u>c</u><b>);</b>

       <b>void</b> <b>sd_bus_creds_unrefp(sd_bus_creds</b> <b>**</b><u>c</u><b>);</b>

       <b>SD_BUS_CREDS_PID</b>, <b>SD_BUS_CREDS_PPID</b>, <b>SD_BUS_CREDS_TID</b>, <b>SD_BUS_CREDS_UID</b>, <b>SD_BUS_CREDS_EUID</b>,
       <b>SD_BUS_CREDS_SUID</b>, <b>SD_BUS_CREDS_FSUID</b>, <b>SD_BUS_CREDS_GID</b>, <b>SD_BUS_CREDS_EGID</b>, <b>SD_BUS_CREDS_SGID</b>,
       <b>SD_BUS_CREDS_FSGID</b>, <b>SD_BUS_CREDS_SUPPLEMENTARY_GIDS</b>, <b>SD_BUS_CREDS_COMM</b>, <b>SD_BUS_CREDS_TID_COMM</b>,
       <b>SD_BUS_CREDS_EXE</b>, <b>SD_BUS_CREDS_CMDLINE</b>, <b>SD_BUS_CREDS_CGROUP</b>, <b>SD_BUS_CREDS_UNIT</b>, <b>SD_BUS_CREDS_SLICE</b>,
       <b>SD_BUS_CREDS_USER_UNIT</b>, <b>SD_BUS_CREDS_USER_SLICE</b>, <b>SD_BUS_CREDS_SESSION</b>, <b>SD_BUS_CREDS_OWNER_UID</b>,
       <b>SD_BUS_CREDS_EFFECTIVE_CAPS</b>, <b>SD_BUS_CREDS_PERMITTED_CAPS</b>, <b>SD_BUS_CREDS_INHERITABLE_CAPS</b>,
       <b>SD_BUS_CREDS_BOUNDING_CAPS</b>, <b>SD_BUS_CREDS_SELINUX_CONTEXT</b>, <b>SD_BUS_CREDS_AUDIT_SESSION_ID</b>,
       <b>SD_BUS_CREDS_AUDIT_LOGIN_UID</b>, <b>SD_BUS_CREDS_TTY</b>, <b>SD_BUS_CREDS_UNIQUE_NAME</b>, <b>SD_BUS_CREDS_WELL_KNOWN_NAMES</b>,
       <b>SD_BUS_CREDS_DESCRIPTION</b>, <b>SD_BUS_CREDS_PIDFD</b>, <b>SD_BUS_CREDS_AUGMENT</b>, <b>_SD_BUS_CREDS_ALL</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sd_bus_creds_new_from_pid()</b> creates a new credentials object and fills it with information about the
       process <u>pid</u>. The pointer to this object will be stored in the <u>ret</u> pointer. Note that credential objects
       may also be created and retrieved via <b><a href="../man3/sd_bus_get_name_creds.3.html">sd_bus_get_name_creds</a></b>(3), <b><a href="../man3/sd_bus_get_owner_creds.3.html">sd_bus_get_owner_creds</a></b>(3) and
       <b><a href="../man3/sd_bus_message_get_creds.3.html">sd_bus_message_get_creds</a></b>(3).

       <b>sd_bus_creds_new_from_pidfd()</b> is identical to <b>sd_bus_creds_new_from_pid()</b>, but takes a PID file
       descriptor rather than a numeric PID as reference to the process. See <b><a href="../man2/pidfd_open.2.html">pidfd_open</a></b>(2).

       The information that will be stored is determined by <u>creds_mask</u>. It may contain a subset of ORed
       constants <b>SD_BUS_CREDS_PID</b>, <b>SD_BUS_CREDS_PPID</b>, <b>SD_BUS_CREDS_TID</b>, <b>SD_BUS_CREDS_UID</b>, <b>SD_BUS_CREDS_EUID</b>,
       <b>SD_BUS_CREDS_SUID</b>, <b>SD_BUS_CREDS_FSUID</b>, <b>SD_BUS_CREDS_GID</b>, <b>SD_BUS_CREDS_EGID</b>, <b>SD_BUS_CREDS_SGID</b>,
       <b>SD_BUS_CREDS_FSGID</b>, <b>SD_BUS_CREDS_SUPPLEMENTARY_GIDS</b>, <b>SD_BUS_CREDS_COMM</b>, <b>SD_BUS_CREDS_TID_COMM</b>,
       <b>SD_BUS_CREDS_EXE</b>, <b>SD_BUS_CREDS_CMDLINE</b>, <b>SD_BUS_CREDS_CGROUP</b>, <b>SD_BUS_CREDS_UNIT</b>, <b>SD_BUS_CREDS_SLICE</b>,
       <b>SD_BUS_CREDS_USER_UNIT</b>, <b>SD_BUS_CREDS_USER_SLICE</b>, <b>SD_BUS_CREDS_SESSION</b>, <b>SD_BUS_CREDS_OWNER_UID</b>,
       <b>SD_BUS_CREDS_EFFECTIVE_CAPS</b>, <b>SD_BUS_CREDS_PERMITTED_CAPS</b>, <b>SD_BUS_CREDS_INHERITABLE_CAPS</b>,
       <b>SD_BUS_CREDS_BOUNDING_CAPS</b>, <b>SD_BUS_CREDS_SELINUX_CONTEXT</b>, <b>SD_BUS_CREDS_AUDIT_SESSION_ID</b>,
       <b>SD_BUS_CREDS_AUDIT_LOGIN_UID</b>, <b>SD_BUS_CREDS_TTY</b>, <b>SD_BUS_CREDS_UNIQUE_NAME</b>, <b>SD_BUS_CREDS_WELL_KNOWN_NAMES</b>,
       <b>SD_BUS_CREDS_DESCRIPTION</b>, and <b>SD_BUS_CREDS_PIDFD</b>. Use the special value <b>_SD_BUS_CREDS_ALL</b> to request all
       supported fields. The <b>SD_BUS_CREDS_AUGMENT</b> constant may not be ORed into the mask for invocations of
       <b>sd_bus_creds_new_from_pid()</b> or <b>sd_bus_creds_new_from_pidfd()</b>.

       Fields can be retrieved from the credentials object using <b><a href="../man3/sd_bus_creds_get_pid.3.html">sd_bus_creds_get_pid</a></b>(3) and other functions
       which correspond directly to the constants listed above.

       A mask of fields which were actually successfully retrieved can be retrieved with
       <b>sd_bus_creds_get_mask()</b>. If the credentials object was created with <b>sd_bus_creds_new_from_pid()</b> or
       <b>sd_bus_creds_new_from_pidfd()</b>, this will be a subset of fields requested in <u>creds_mask</u>.

       Similar to <b>sd_bus_creds_get_mask()</b>, the function <b>sd_bus_creds_get_augmented_mask()</b> returns a bitmask of
       field constants. The mask indicates which credential fields have been retrieved in a non-atomic fashion.
       For credential objects created via <b>sd_bus_creds_new_from_pid()</b> or <b>sd_bus_creds_new_from_pidfd()</b>, this
       mask will be identical to the mask returned by <b>sd_bus_creds_get_mask()</b>. However, for credential objects
       retrieved via <b>sd_bus_get_name_creds()</b>, this mask will be set for the credential fields that could not be
       determined atomically at peer connection time, and which were later added by reading augmenting
       credential data from <a href="file:/proc/.">/proc/.</a> Similarly, for credential objects retrieved via <b>sd_bus_get_owner_creds()</b>,
       the mask is set for the fields that could not be determined atomically at bus creation time, but have
       been augmented. Similarly, for credential objects retrieved via <b>sd_bus_message_get_creds()</b>, the mask is
       set for the fields that could not be determined atomically at message sending time, but have been
       augmented. The mask returned by <b>sd_bus_creds_get_augmented_mask()</b> is always a subset of (or identical to)
       the mask returned by <b>sd_bus_creds_get_mask()</b> for the same object. The latter call hence returns all
       credential fields available in the credential object, the former then marks the subset of those that have
       been augmented. Note that augmented fields are unsuitable for authorization decisions, as they may be
       retrieved at different times, thus being subject to races. Hence, augmented fields should be used
       exclusively for informational purposes.

       <b>sd_bus_creds_ref()</b> creates a new reference to the credentials object <u>c</u>. This object will not be destroyed
       until <b>sd_bus_creds_unref()</b> has been called as many times plus once more. Once the reference count has
       dropped to zero, <u>c</u> cannot be used anymore, so further calls to <b>sd_bus_creds_ref(c)</b> or
       <b>sd_bus_creds_unref(c)</b> are illegal.

       <b>sd_bus_creds_unref()</b> destroys a reference to <u>c</u>.

       <b>sd_bus_creds_unrefp()</b> is similar to <b>sd_bus_creds_unref()</b> but takes a pointer to a pointer to an
       <b>sd_bus_creds</b> object. This call is useful in conjunction with GCC's and LLVM's <b>Clean-up</b> <b>Variable</b>
       <b>Attribute</b>[1]. Note that this function is defined as inline function.

       <b>sd_bus_creds_ref()</b>, <b>sd_bus_creds_unref()</b> and <b>sd_bus_creds_unrefp()</b> execute no operation if the passed in
       bus credentials object is <b>NULL</b>.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, <b>sd_bus_creds_new_from_pid()</b> and <b>sd_bus_creds_new_from_pidfd()</b> return 0 or a positive integer.
       On failure, they return a negative errno-style error code.

       <b>sd_bus_creds_get_mask()</b> returns the mask of successfully acquired fields.

       <b>sd_bus_creds_get_augmented_mask()</b> returns the mask of fields that have been augmented from data in
       <a href="file:/proc/">/proc/</a>, and are thus not suitable for authorization decisions.

       <b>sd_bus_creds_ref()</b> always returns the argument.

       <b>sd_bus_creds_unref()</b> always returns <b>NULL</b>.

</pre><h4><b>REFERENCE</b> <b>OWNERSHIP</b></h4><pre>
       The functions <b>sd_bus_creds_new_from_pid()</b> and <b>sd_bus_creds_new_from_pidfd()</b> create a new object and the
       caller owns the sole reference. When not needed anymore, this reference should be destroyed with
       <b><a href="../man3/sd_bus_creds_unref.3.html">sd_bus_creds_unref</a></b>(3).

   <b>Errors</b>
       Returned errors may indicate the following problems:

       <b>-ESRCH</b>
           Specified <u>pid</u> could not be found.

       <b>-EINVAL</b>
           Specified parameter is invalid (<b>NULL</b> in case of output parameters).

       <b>-ENOMEM</b>
           Memory allocation failed.

       <b>-EOPNOTSUPP</b>
           One of the requested fields is unknown to the local system.

</pre><h4><b>NOTES</b></h4><pre>
       Functions described here are available as a shared library, which can be compiled against and linked to
       with the <b>libsystemd</b> <b><a href="../man1/pkg-config.1.html">pkg-config</a></b>(1) file.

       The code described here uses <b><a href="../man3/getenv.3.html">getenv</a></b>(3), which is declared to be not multi-thread-safe. This means that
       the code calling the functions described here must not call <b><a href="../man3/setenv.3.html">setenv</a></b>(3) from a parallel thread. It is
       recommended to only do calls to <b>setenv()</b> from an early phase of the program when no other threads have
       been started.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>sd_bus_creds_new_from_pid()</b>, <b>sd_bus_creds_get_mask()</b>, <b>sd_bus_creds_ref()</b>, <b>sd_bus_creds_unref()</b>, and
       <b>sd_bus_creds_get_augmented_mask()</b> were added in version 221.

       <b>sd_bus_creds_unrefp()</b> was added in version 229.

       <b>sd_bus_creds_new_from_pidfd()</b> was added in version 256.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man3/sd-bus.3.html">sd-bus</a></b>(3), <b><a href="../man3/sd_bus_creds_get_pid.3.html">sd_bus_creds_get_pid</a></b>(3), <b><a href="../man3/sd_bus_get_name_creds.3.html">sd_bus_get_name_creds</a></b>(3), <b><a href="../man3/sd_bus_get_owner_creds.3.html">sd_bus_get_owner_creds</a></b>(3),
       <b><a href="../man3/sd_bus_message_get_creds.3.html">sd_bus_message_get_creds</a></b>(3)

</pre><h4><b>NOTES</b></h4><pre>
        1. Clean-up Variable Attribute
           https://gcc.gnu.org/onlinedocs/gcc/Common-Variable-Attributes.html

systemd 257.7                                                                       <u><a href="../man3/SD_BUS_CREDS_NEW_FROM_PID.3.html">SD_BUS_CREDS_NEW_FROM_PID</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>