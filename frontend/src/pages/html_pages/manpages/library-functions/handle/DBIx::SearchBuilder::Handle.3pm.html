<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DBIx::SearchBuilder::Handle - Perl extension which is a generic DBI handle</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libdbix-searchbuilder-perl">libdbix-searchbuilder-perl_1.82-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       DBIx::SearchBuilder::Handle - Perl extension which is a generic DBI handle

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use DBIx::SearchBuilder::Handle;

         my $handle = DBIx::SearchBuilder::Handle-&gt;new();
         $handle-&gt;Connect( Driver =&gt; 'mysql',
                           Database =&gt; 'dbname',
                           Host =&gt; 'hostname',
                           User =&gt; 'dbuser',
                           Password =&gt; 'dbpassword');
         # now $handle isa DBIx::SearchBuilder::Handle::mysql

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This class provides a wrapper for DBI handles that can also perform a number of additional functions.

   <b>new</b>
       Generic constructor

   <b>Connect</b> <b>PARAMHASH:</b> <b>Driver,</b> <b>Database,</b> <b>Host,</b> <b>User,</b> <b>Password,</b> <b>QuoteTableNames</b>
       Takes a paramhash and connects to your DBI datasource.

       You should _always_ set

            DisconnectHandleOnDestroy =&gt; 1

       unless you have a legacy app like RT2 or RT 3.0.{0,1,2} that depends on the broken behaviour.

       If you created the handle with
            DBIx::SearchBuilder::Handle-&gt;new and there is a DBIx::SearchBuilder::Handle::(Driver) subclass for
       the driver you have chosen, the handle will be automatically "upgraded" into that subclass.

       QuoteTableNames option will force all table names to be quoted if the driver subclass has a method for
       quoting implemented. The mysql subclass will detect mysql version 8 and set the flag.

   <b>_UpgradeHandle</b> <b>DRIVER</b>
       This private internal method turns a plain DBIx::SearchBuilder::Handle into one of the standard driver-
       specific subclasses.

   <b>BuildDSN</b> <b>PARAMHASH</b>
       Takes a bunch of parameters:

       Required: Driver, Database, Optional: Host, Port and RequireSSL

       Builds a DSN suitable for a DBI connection

   <b>DSN</b>
       Returns the DSN for this database connection.

   <b>RaiseError</b> <b>[MODE]</b>
       Turns on the Database Handle's RaiseError attribute.

   <b>PrintError</b> <b>[MODE]</b>
       Turns on the Database Handle's PrintError attribute.

   <b>LogSQLStatements</b> <b>BOOL</b>
       Takes a boolean argument. If the boolean is true, SearchBuilder will log all SQL statements, as well as
       their invocation times and execution times.

       Returns whether we're currently logging or not as a boolean

   <b>_LogSQLStatement</b> <b>STATEMENT</b> <b>DURATION</b>
       Add an SQL statement to our query log

   <b>ClearSQLStatementLog</b>
       Clears out the SQL statement log.

   <b>SQLStatementLog</b>
       Returns the current SQL statement log as an array of arrays. Each entry is a triple of

       (Time,  Statement, Duration)

   <b>AutoCommit</b> <b>[MODE]</b>
       Turns on the Database Handle's AutoCommit attribute.

   <b>Disconnect</b>
       Disconnect from your DBI datasource

   <b>dbh</b> <b>[HANDLE]</b>
       Return the current DBI handle. If we're handed a parameter, make the database handle that.

   <b>Insert</b> <b>$TABLE_NAME</b> <b>@KEY_VALUE_PAIRS</b>
       Takes a table name and a set of key-value pairs in an array.  Splits the key value pairs, constructs an
       INSERT statement and performs the insert.

       Base class return statement handle object, while DB specific subclass should return row id.

   <b>InsertQueryString</b> <b>$TABLE_NAME</b> <b>@KEY_VALUE_PAIRS</b>
       Takes a table name and a set of key-value pairs in an array.  Splits the key value pairs, constructs an
       INSERT statement and returns query string and set of bind values.

       This method is more useful for subclassing in DB specific handles. "Insert" method is preferred for end
       users.

   <b>InsertFromSelect</b>
       Takes table name, array reference with columns, select query and list of bind values. Inserts data select
       by the query into the table.

       To make sure call is portable every column in result of the query should have unique name or should be
       aliased.  See "InsertFromSelect" in DBIx::SearchBuilder::Handle::Oracle for details.

   <b>UpdateRecordValue</b>
       Takes a hash with fields: Table, Column, Value PrimaryKeys, and IsSQLFunction.  Table, and Column should
       be obvious, Value is where you set the new value you want the column to have. The primary_keys field
       should be the lvalue of <b>DBIx::SearchBuilder::Record::PrimaryKeys()</b>.  Finally IsSQLFunction is set when
       the Value is a SQL function.  For example, you might have ('Value'=&gt;'PASSWORD(string)'), by setting
       IsSQLFunction that string will be inserted into the query directly rather then as a binding.

   <b>UpdateTableValue</b> <b>TABLE</b> <b>COLUMN</b> <b>NEW_VALUE</b> <b>RECORD_ID</b> <b>IS_SQL</b>
       Update column COLUMN of table TABLE where the record id = RECORD_ID.  if IS_SQL is set, don\'t quote the
       NEW_VALUE

</pre><h4><b>SimpleUpdateFromSelect</b></h4><pre>
       Takes table name, hash reference with (column, value) pairs, select query and list of bind values.

       Updates the table, but only records with IDs returned by the selected query, eg:

           UPDATE $table SET %values WHERE id IN ( $query )

       It's simple as values are static and search only allowed by id.

</pre><h4><b>DeleteFromSelect</b></h4><pre>
       Takes table name, select query and list of bind values.

       Deletes from the table, but only records with IDs returned by the select query, eg:

           DELETE FROM $table WHERE id IN ($query)

   <b>SimpleQuery</b> <b>QUERY_STRING,</b> <b>[</b> <b>BIND_VALUE,</b> <b>...</b> <b>]</b>
       Execute the SQL string specified in QUERY_STRING

   <b>FetchResult</b> <b>QUERY,</b> <b>[</b> <b>BIND_VALUE,</b> <b>...</b> <b>]</b>
       Takes a SELECT query as a string, along with an array of BIND_VALUEs If the select succeeds, returns the
       first row as an array.  Otherwise, returns a Class::ResturnValue object with the failure loaded up.

   <b>BinarySafeBLOBs</b>
       Returns 1 if the current database supports BLOBs with embedded nulls.  Returns undef if the current
       database doesn't support BLOBs with embedded nulls

   <b>KnowsBLOBs</b>
       Returns 1 if the current database supports inserts of BLOBs automatically.  Returns undef if the current
       database must be informed of BLOBs for inserts.

   <b>BLOBParams</b> <b>FIELD_NAME</b> <b>FIELD_TYPE</b>
       Returns a hash ref for the bind_param call to identify BLOB types used by the current database for a
       particular column type.

   <b>DatabaseVersion</b> <b>[Short</b> <b>=&gt;</b> <b>1]</b>
       Returns the database's version.

       If argument "Short" is true returns short variant, in other case returns whatever database handle/driver
       returns. By default returns short version, e.g. '4.1.23' or '8.0-rc4'.

       Returns empty string on error or if database couldn't return version.

       The base implementation uses a "SELECT VERSION()"

   <b>CaseSensitive</b>
       Returns 1 if the current database's searches are case sensitive by default Returns undef otherwise

   <b>QuoteTableNames</b>
       Returns 1 if table names will be quoted in queries, otherwise 0

   <b>_MakeClauseCaseInsensitive</b> <b>FIELD</b> <b>OPERATOR</b> <b>VALUE</b>
       Takes a field, operator and value. performs the magic necessary to make your database treat this clause
       as case insensitive.

       Returns a FIELD OPERATOR VALUE triple.

   <b>Transactions</b>
       DBIx::SearchBuilder::Handle emulates nested transactions, by keeping a transaction stack depth.

       <b>NOTE:</b> In nested transactions you shouldn't mix rollbacks and commits, because only last action really do
       commit/rollback. For example next code would produce desired results:

         $handle-&gt;BeginTransaction;
           $handle-&gt;BeginTransaction;
           ...
           $handle-&gt;Rollback;
           $handle-&gt;BeginTransaction;
           ...
           $handle-&gt;Commit;
         $handle-&gt;Commit;

       Only last action(Commit in example) finilize transaction in DB.

       <u>BeginTransaction</u>

       Tells DBIx::SearchBuilder to begin a new SQL transaction.  This will temporarily suspend Autocommit mode.

       <u>EndTransaction</u> <u>[Action</u> <u>=&gt;</u> <u>'commit']</u> <u>[Force</u> <u>=&gt;</u> <u>0]</u>

       Tells to end the current transaction. Takes "Action" argument that could be "commit" or "rollback", the
       default value is "commit".

       If "Force" argument is true then all nested transactions would be committed or rolled back.

       If there is no transaction in progress then method throw warning unless action is forced.

       Method returns true on success or false if an error occurred.

       <u>Commit</u> <u>[FORCE]</u>

       Tells to commit the current SQL transaction.

       Method uses "EndTransaction" method, read its description.

       <u>Rollback</u> <u>[FORCE]</u>

       Tells to abort the current SQL transaction.

       Method uses "EndTransaction" method, read its description.

       <u>ForceRollback</u>

       Force the handle to rollback.  Whether or not we're deep in nested transactions.

       <u>TransactionDepth</u>

       Returns the current depth of the nested transaction stack.  Returns "undef" if there is no connection to
       database.

   <b>ApplyLimits</b> <b>STATEMENTREF</b> <b>ROWS_PER_PAGE</b> <b>FIRST_ROW</b>
       takes an SQL SELECT statement and massages it to return ROWS_PER_PAGE starting with FIRST_ROW;

   <b>Join</b> <b>{</b> <b>Paramhash</b> <b>}</b>
       Takes a paramhash of everything Searchbuildler::Record does plus a parameter called 'SearchBuilder' that
       contains a ref to a SearchBuilder object'.

       This performs the join.

   <b>MayBeNull</b>
       Takes a "SearchBuilder" and "ALIAS" in a hash and resturns true if restrictions of the query allow NULLs
       in a table joined with the ALIAS, otherwise returns false value which means that you can use normal join
       instead of left for the aliased table.

       Works only for queries have been built with "Join" in DBIx::SearchBuilder and "Limit" in
       DBIx::SearchBuilder methods, for other cases return true value to avoid fault optimizations.

   <b>DistinctQuery</b> <b>STATEMENTREF</b>
       takes an incomplete SQL SELECT statement and massages it to return a DISTINCT result set.

   <b>DistinctQueryAndCount</b> <b>STATEMENTREF</b>
       takes an incomplete SQL SELECT statement and massages it to return a DISTINCT result set and the total
       count of potential records.

   <b>DistinctCount</b> <b>STATEMENTREF</b>
       takes an incomplete SQL SELECT statement and massages it to return a DISTINCT result set.

   <b>Log</b> <b>MESSAGE</b>
       Takes a single argument, a message to log.

       Currently prints that message to STDERR

   <b>SimpleDateTimeFunctions</b>
       See "DateTimeFunction" for details on supported functions.  This method is for implementers of custom DB
       connectors.

       Returns hash reference with (function name, sql template) pairs.

   <b>DateTimeFunction</b>
       Takes named arguments:

       •   Field - SQL expression date/time function should be applied to. Note that this argument is used as is
           without any kind of quoting.

       •   Type - name of the function, see supported values below.

       •   Timezone  -  optional  hash  reference  with  From  and  To values, see "ConvertTimezoneFunction" for
           details.

       Returns SQL statement. Returns NULL if function is not supported.

       <u>Supported</u> <u>functions</u>

       Type value in "DateTimeFunction" is case insesitive. Spaces, underscores and dashes are ignored. So 'date
       time', 'DateTime' and 'date_time' are all synonyms. The following functions are supported:

       •   date time - as is, no conversion, except applying timezone conversion if it's provided.

       •   time - time only

       •   hourly - datetime prefix up to the hours, e.g. '2010-03-25 16'

       •   hour - hour, 0 - 23

       •   date - date only

       •   daily - synonym for date

       •   day of week - 0 - 6, 0 - Sunday

       •   day - day of month, 1 - 31

       •   day of month - synonym for day

       •   day of year - 1 - 366, support is database dependent

       •   month - 1 - 12

       •   monthly - year and month prefix, e.g. '2010-11'

       •   year - e.g. '2023'

       •   annually - synonym for year

       •   week of year - 0-53, presence of zero week, 1st week meaning and whether week  starts  on  Monday  or
           Sunday heavily depends on database.

   <b>ConvertTimezoneFunction</b>
       Generates  a  function  applied  to Field argument that converts timezone.  By default converts from UTC.
       Examples:

           # UTC =&gt; Moscow
           $handle-&gt;ConvertTimezoneFunction( Field =&gt; '?', To =&gt; 'Europe/Moscow');

       If there is problem with arguments or timezones are  equal  then  Field  returned  without  any  function
       applied. Field argument is not escaped in any way, it's your job.

       Implementation  is very database specific. To be portable convert from UTC or to UTC. Some databases have
       internal storage for information about timezones that should be kept up to date.  Read documentation  for
       your DB.

   <b>DateTimeIntervalFunction</b>
       Generates  a  function  to  calculate  interval in seconds between two dates. Takes From and To arguments
       which  can  be  either  scalar  or  a  hash.  Hash  is  processed  with   "CombineFunctionWithField"   in
       DBIx::SearchBuilder.

       Arguments are not quoted or escaped in any way. It's caller's job.

   <b>NullsOrder</b>
       Sets order of NULLs when sorting columns when called with mode, but only if DB supports it. Modes:

       •   small

           NULLs are smaller then anything else, so come first when order is ASC and last otherwise.

       •   large

           NULLs are larger then anything else.

       •   first

           NULLs are always first.

       •   last

           NULLs are always last.

       •   default

           Return back to DB's default behaviour.

       When called without argument returns metadata required to generate SQL.

   <b>HasSupportForNullsOrder</b>
       Returns  true  value  if  DB supports adjusting NULLs order while sorting a column, for example "ORDER BY
       Value ASC NULLS FIRST".

   <b>HasSupportForCombineSearchAndCount</b>
       Returns true value if DB supports to combine search and count in single query.

   <b>HasSupportForEmptyString</b>
       Returns true value if DB supports empty string.

   <b>QuoteName</b>
       Quote table or column name to avoid reserved word errors.

       Returns same value passed unless over-ridden in database-specific subclass.

   <b>DequoteName</b>
       Undo the effects of QuoteName by removing quoting.

   <b>DESTROY</b>
       When we get rid of the Searchbuilder::Handle, we need to disconnect from the database

   <b>CastAsDecimal</b> <b>FIELD</b>
       Cast the given field as decimal.

       E.g. on Pg, it's "CAST(Content AS DECIMAL)".

perl v5.38.2                                       2024-05-15                   <u>DBIx::SearchBuilder::<a href="../man3pm/Handle.3pm.html">Handle</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>