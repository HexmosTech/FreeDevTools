<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Win::Hivex - Perl bindings for reading and writing Windows Registry hive files</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libwin-hivex-perl">libwin-hivex-perl_1.3.24-1build6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Win::Hivex - Perl bindings for reading and writing Windows Registry hive files

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Win::Hivex;

        $h = Win::Hivex-&gt;open ('SOFTWARE');
        $root_node = $h-&gt;root ();
        print $h-&gt;node_name ($root_node);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The "Win::Hivex" module provides a Perl XS binding to the <b><a href="../man3/hivex.3.html">hivex</a></b>(3) API for reading and writing Windows
       Registry binary hive files.

</pre><h4><b>ERRORS</b></h4><pre>
       All errors turn into calls to "croak" (see <b><a href="../man3/Carp.3.html">Carp</a></b>(3)).

</pre><h4><b>METHODS</b></h4><pre>
       open
            $h = Win::Hivex-&gt;open ($filename,
                                   [verbose =&gt; 1,]
                                   [debug =&gt; 1,]
                                   [write =&gt; 1,]
                                   [unsafe =&gt; 1,])

           Open a Windows Registry binary hive file.

           The "verbose" and "debug" flags enable different levels of debugging messages.

           The  "write"  flag is required if you will be modifying the hive file (see "WRITING TO HIVE FILES" in
           <b><a href="../man3/hivex.3.html">hivex</a></b>(3)).

           This function returns a hive handle.  The hive handle is  closed  automatically  when  its  reference
           count drops to 0.

       root
            $node = $h-&gt;root ()

           Return root node of the hive.  All valid hives must contain a root node.

           This returns a node handle.

       last_modified
            $int64 = $h-&gt;last_modified ()

           Return the modification time from the header of the hive.

           The   returned   value   is   a   Windows  filetime.   To  convert  this  to  a  Unix  "time_t"  see:
           &lt;<a href="http://stackoverflow.com/questions/6161776/convert-windows-filetime-to-second-in-unix-linux/6161842">http://stackoverflow.com/questions/6161776/convert-windows-filetime-to-second-in-unix-linux/6161842</a>#6161842&gt;

       node_name
            $string = $h-&gt;node_name ($node)

           Return the name of the node.

           Note that the name of the root node is a dummy, such as "$$$PROTO.HIV" (other names are possible:  it
           seems  to depend on the tool or program that created the hive in the first place).  You can only know
           the "real" name of the root node by knowing which registry file  this  hive  originally  comes  from,
           which is knowledge that is outside the scope of this library.

           The name is recoded to UTF-8 and may contain embedded NUL characters.

       node_name_len
            $size = $h-&gt;node_name_len ($node)

           Return the length of the node name as produced by "node_name".

           This returns a size.

       node_timestamp
            $int64 = $h-&gt;node_timestamp ($node)

           Return the modification time of the node.

           The   returned   value   is   a   Windows  filetime.   To  convert  this  to  a  Unix  "time_t"  see:
           &lt;<a href="http://stackoverflow.com/questions/6161776/convert-windows-filetime-to-second-in-unix-linux/6161842">http://stackoverflow.com/questions/6161776/convert-windows-filetime-to-second-in-unix-linux/6161842</a>#6161842&gt;

       node_children
            @nodes = $h-&gt;node_children ($node)

           Return an array of nodes which are the subkeys (children) of "node".

           This returns a list of node handles.

       node_get_child
            $node = $h-&gt;node_get_child ($node, $name)

           Return the child of node with the name "name", if it exists.

           The name is matched case insensitively.

           This returns a node handle, or "undef" if the node was not found.

       node_nr_children
            $size = $h-&gt;node_nr_children ($node)

           Return the number of nodes as produced by "node_children".

           This returns a size.

       node_parent
            $node = $h-&gt;node_parent ($node)

           Return the parent of "node".

           The parent pointer of the root node in registry files that we have examined seems to be invalid,  and
           so this function will return an error if called on the root node.

           This returns a node handle.

       node_values
            @values = $h-&gt;node_values ($node)

           Return the array of (key, value) pairs attached to this node.

           This returns a list of value handles.

       node_get_value
            $value = $h-&gt;node_get_value ($node, $key)

           Return the value attached to this node which has the name "key", if it exists.

           The key name is matched case insensitively.

           Note that to get the default key, you should pass the empty string "" here.  The default key is often
           written "@", but inside hives that has no meaning and won't give you the default key.

           This returns a value handle.

       node_nr_values
            $size = $h-&gt;node_nr_values ($node)

           Return the number of (key, value) pairs attached to this node as produced by "node_values".

           This returns a size.

       value_key_len
            $size = $h-&gt;value_key_len ($val)

           Return the length of the key (name) of a (key, value) pair as produced by "value_key". The length can
           legitimately be 0, so errno is the necessary mechanism to check for errors.

           In the context of Windows Registries, a zero-length name means that this value is the default key for
           this node in the tree.  This is usually written as "@".

           The key is recoded to UTF-8 and may contain embedded NUL characters.

           This returns a size.

       value_key
            $string = $h-&gt;value_key ($val)

           Return  the  key  (name)  of  a  (key, value) pair.  The name is reencoded as UTF-8 and returned as a
           string.

           The string should be freed by the caller when it is no longer needed.

           Note that this function can return a zero-length string.  In the context of Windows Registries,  this
           means that this value is the default key for this node in the tree.  This is usually written as "@".

       value_type
            ($type, $len) = $h-&gt;value_type ($val)

           Return  the data length and data type of the value in this (key, value) pair.  See also "value_value"
           which returns all this information, and the value itself.  Also, "value_*" functions below which  can
           be used to return the value in a more useful form when you know the type in advance.

       node_struct_length
            $size = $h-&gt;node_struct_length ($node)

           Return the length of the node data structure.

           This returns a size.

       value_struct_length
            $size = $h-&gt;value_struct_length ($val)

           Return the length of the value data structure.

           This returns a size.

       value_data_cell_offset
            ($len, $value) = $h-&gt;value_data_cell_offset ($val)

           Return the offset and length of the value's data cell.

           The  data  cell  is  a  registry structure that contains the length (a 4 byte, little endian integer)
           followed by the data.

           If the length of the value is less than or equal to 4 bytes then the offset and  length  returned  by
           this function is zero as the data is inlined in the value.

           Returns 0 and sets errno on error.

       value_value
            ($type, $data) = $h-&gt;value_value ($val)

           Return  the  value  of this (key, value) pair.  The value should be interpreted according to its type
           (see "hive_type").

       value_string
            $string = $h-&gt;value_string ($val)

           If this value is a string, return the string reencoded as UTF-8 (as a C string).  This only works for
           values which have type "hive_t_string", "hive_t_expand_string" or "hive_t_link".

       value_multiple_strings
            @strings = $h-&gt;value_multiple_strings ($val)

           If this value is a multiple-string, return the strings reencoded as UTF-8 (in C, as a NULL-terminated
           array of C strings, in other language bindings, as a list of strings).  This only  works  for  values
           which have type "hive_t_multiple_strings".

       value_dword
            $int32 = $h-&gt;value_dword ($val)

           If  this  value  is  a  DWORD (Windows int32), return it.  This only works for values which have type
           "hive_t_dword" or "hive_t_dword_be".

       value_qword
            $int64 = $h-&gt;value_qword ($val)

           If this value is a QWORD (Windows int64), return it.  This only works  for  values  which  have  type
           "hive_t_qword".

       commit
            $h-&gt;commit ([$filename|undef])

           Commit (write) any changes which have been made.

           "filename"  is the new file to write.  If "filename" is null/undefined then we overwrite the original
           file (ie. the file name that was passed to "open").

           Note this does not close the hive handle.  You can perform  further  operations  on  the  hive  after
           committing,  including  making  more  modifications.  If you no longer wish to use the hive, then you
           should close the handle after committing.

       node_add_child
            $node = $h-&gt;node_add_child ($parent, $name)

           Add a new child node named "name" to the existing node "parent".  The  new  child  initially  has  no
           subnodes  and  contains no keys or values.  The sk-record (security descriptor) is inherited from the
           parent.

           The parent must not have an existing child called "name", so if you want  to  overwrite  an  existing
           child, call "node_delete_child" first.

           This returns a node handle.

       node_delete_child
            $h-&gt;node_delete_child ($node)

           Delete  the  node  "node".   All  values at the node and all subnodes are deleted (recursively).  The
           "node" handle and the handles of all subnodes become invalid.  You cannot delete the root node.

       node_set_values
            $h-&gt;node_set_values ($node, \@values)

           This call can be used to set all the (key, value) pairs stored in "node".

           "node" is the node to modify.

           @values is an array of (keys, value) pairs.  Each element should be a hashref containing  "key",  "t"
           (type) and "data".

           Any existing values stored at the node are discarded, and their "value" handles become invalid.  Thus
           you can remove all values stored at "node" by passing "@values = []".

       node_set_value
            $h-&gt;node_set_value ($node, $val)

           This  call can be used to replace a single "(key, value)" pair stored in "node".  If the key does not
           already exist, then a new key is added.  Key matching is case insensitive.

           "node" is the node to modify.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2009-2022 Red Hat Inc.

</pre><h4><b>LICENSE</b></h4><pre>
       Please see the file COPYING.LIB for the full license.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/hivex.3.html">hivex</a></b>(3), <b><a href="../man1/hivexsh.1.html">hivexsh</a></b>(1), &lt;<a href="http://libguestfs.org">http://libguestfs.org</a>&gt;, <b>Sys::<a href="../man3/Guestfs.3.html">Guestfs</a></b>(3).

perl v5.40.1                                       2025-06-16                                    <u>Win::<a href="../man3pm/Hivex.3pm.html">Hivex</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>