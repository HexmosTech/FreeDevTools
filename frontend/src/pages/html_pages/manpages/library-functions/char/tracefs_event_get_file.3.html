<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tracefs_event_get_file, tracefs_event_file_read, tracefs_event_file_write, tracefs_event_file_append,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtracefs-doc">libtracefs-doc_1.8.1-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tracefs_event_get_file, tracefs_event_file_read, tracefs_event_file_write, tracefs_event_file_append,
       tracefs_event_file_clear, tracefs_event_file_exists - Work with trace event files.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tracefs.h&gt;</b>

       char *<b>tracefs_event_get_file</b>(struct tracefs_instance *<u>instance</u>, const char *<u>system</u>, const char *<u>event</u>,
                                    const char *<u>file</u>);
       char *<b>tracefs_event_file_read</b>(struct tracefs_instance *<u>instance</u>, const char *<u>system</u>, const char *<u>event</u>,
                                     const char *<u>file</u>, int *<u>psize</u>);
       int <b>tracefs_event_file_write</b>(struct tracefs_instance *<u>instance</u>, const char *<u>system</u>, const char *<u>event</u>,
                                    const char *<u>file</u>, const char *<u>str</u>);
       int <b>tracefs_event_file_append</b>(struct tracefs_instance *<u>instance</u>, const char *<u>system</u>, const char *<u>event</u>,
                                     const char *<u>file</u>, const char *<u>str</u>);
       int <b>tracefs_event_file_clear</b>(struct tracefs_instance *<u>instance</u>, const char *<u>system</u>, const char *<u>event</u>,
                                    const char *<u>file</u>);
       bool <b>tracefs_event_file_exists</b>(struct tracefs_instance *<u>instance</u>, const char *<u>system</u>, const char *<u>event</u>,
                                      const char *<u>file</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These are functions for accessing tracefs event specific files. These functions act similar to the
       tracefs instance file functions but are easier to get to if the system and events are known before hand.

       The <b>tracefs_event_get_file()</b> returns the full path of the <u>file</u> for the given <u>system</u> and <u>event</u> that is
       within the given <u>instance</u>. If <u>instance</u> is NULL, then the file for the <u>event</u> for the top level instance is
       returned. Note, there is no check to see if the file actually exists or even if the system and event
       exist. It only creates the path name for such an event if it did exist. This acts similar to the
       <b><a href="../man3/tracefs_instance_get_file.3.html">tracefs_instance_get_file</a></b>(3), but is to be used to get to event files if the <u>system</u> and <u>event</u> are already
       known.

       The <b>tracefs_event_file_read()</b> reads the content for the <u>event</u> <u>file</u> for the given <u>instance</u> or the top
       level instance if <u>instance</u> is NULL. The content of the file is returned and <u>psize</u> is set to the amount of
       data that was read. The returned content must be freed with <b><a href="../man3/free.3.html">free</a></b>(3). This acts similar to the
       <b><a href="../man3/tracefs_instance_file_read.3.html">tracefs_instance_file_read</a></b>(3), but is to be used to read the event file if the <u>system</u> and <u>event</u> are
       already known.

       The <b>tracefs_event_file_write()</b> writes <u>str</u> to the <u>event</u> <u>file</u>. It will truncate anything that is already in
       that file. This acts similar to the <b><a href="../man3/tracefs_instance_file_write.3.html">tracefs_instance_file_write</a></b>(3), but is to be used to read the event
       file if the <u>system</u> and <u>event</u> are already known.

       The <b>tracefs_event_file_append()</b> appends <u>str</u> to the <u>event</u> <u>file</u>. It will not clear out the file as it
       writes <u>sting</u>. This acts similar to the <b><a href="../man3/tracefs_instance_file_append.3.html">tracefs_instance_file_append</a></b>(3), but is to be used to read the
       event file if the <u>system</u> and <u>event</u> are already known.

       The <b>tracefs_event_file_clear()</b> clears the content of the <u>event</u> <u>file</u>. This acts similar to the
       <b><a href="../man3/tracefs_instance_file_clear.3.html">tracefs_instance_file_clear</a></b>(3), but is to be used to read the event file if the <u>system</u> and <u>event</u> are
       already known.

       The <b>tracefs_event_file_exists()</b> returns true if the <u>event</u> <u>file</u> exists, and false otherwise. This acts
       similar to the <b><a href="../man3/tracefs_instance_file_exists.3.html">tracefs_instance_file_exists</a></b>(3), but is to be used to read the event file if the <u>system</u>
       and <u>event</u> are already known.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>tracefs_event_get_file()</b> returns the path of the given <u>system</u>/<u>event</u> <u>file</u> on success and NULL on error.
       The return value must be freed with <b><a href="../man3/tracefs_put_tracing_file.3.html">tracefs_put_tracing_file</a></b>(3).

       <b>tracefs_event_file_read()</b> reads the content of the <u>system</u>/<u>event</u> <u>file</u> or NULL on error. The return pointer
       must be freed with <b><a href="../man3/free.3.html">free</a></b>(3).

       <b>tracefs_event_file_write()</b> and <b>tracefs_event_file_append()</b> returns the number of bytes written to the
       <u>system</u>/<u>event</u> <u>file</u> or negative on error.

       <b>tracefs_event_file_clear()</b> returns zero on success and -1 on error.

       <b>tracefs_event_file_exists()</b> returns true if the <u>system</u>/<u>event</u> <u>file</u> exists for the given <u>instance</u> (or top
       level if <u>instance</u> is NULL) or false otherwise.

</pre><h4><b>EXAMPLE</b></h4><pre>
           #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
           #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
           #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;
           #include &lt;tracefs.h&gt;

           int main(int argc, char **argv)
           {
                   char *system;
                   char *event;
                   char *file;
                   char *cmd = NULL;
                   char *buf;
                   char *str;
                   char ch = 'r';
                   int size;

                   if (argc &lt; 4) {
                           printf("usage: %s sytem event file [(-a|-w) write | -c]\n"
                                  "   reads the system/event file or writes if [write is supplied]\n",
                                  argv[0]);
                           <a href="../man0/exit.0.html">exit</a>(0);
                   }

                   system = argv[1];
                   event = argv[2];
                   file = argv[3];
                   if (argc &gt; 4)
                           cmd = argv[4];

                   if (!tracefs_event_file_exists(NULL, system, event, file)) {
                           fprintf(stderr, "File %s/%s/%s does not exist\n",
                                           system, event, file);
                           exit(-1);
                   }

                   if (cmd) {
                           if (cmd[0] != '-')
                                   ch = cmd[0];
                           else
                                   ch = cmd[1];
                           if (!ch)
                                   ch = 'c';
                   }

                   switch (ch) {
                   case 'r':
                           buf = tracefs_event_file_read(NULL, system, event, file, &amp;size);
                           if (buf)
                                   printf("%s", buf);
                           else
                                   fprintf(stderr, "Failed to read %s/%s/%s\n",
                                           system, event, file);
                           free(buf);
                           break;
                   case 'w':
                   case 'a':
                           if (argc &lt; 6) {
                                   fprintf(stderr, "%s command requires something to write\n",
                                           ch == 'w' ? "write" : "append");
                                   exit(-1);
                           }
                           if (ch == 'w')
                                   size = tracefs_event_file_write(NULL, system, event, file, argv[5]);
                           else
                                   size = tracefs_event_file_append(NULL, system, event, file, argv[5]);
                           if (size &lt; 0) {
                                   fprintf(stderr, "Failed to write '%s' to %s/%s/%s\n",
                                                   argv[5], system, event, file);
                                   exit(-1);
                           }
                           break;
                   case 'c':
                           if (tracefs_event_file_clear(NULL, system, event, file) &lt; 0) {
                                   fprintf(stderr, "Failed to clear %s/%s/%s\n",
                                           system, event, file);
                                   exit(-1);
                           }
                           break;
                   default:
                           fprintf(stderr, "Unknown command '%c'\n", ch);
                           exit(-1);
                   }
                   <a href="../man0/exit.0.html">exit</a>(0);
           }

</pre><h4><b>FILES</b></h4><pre>
           <b>tracefs.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>-ltracefs</b>
                   Linker switch to add when building a program that uses the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libtracefs.3.html">libtracefs</a></b>(3), <b><a href="../man3/libtraceevent.3.html">libtraceevent</a></b>(3), <b><a href="../man1/trace-cmd.1.html">trace-cmd</a></b>(1)

</pre><h4><b>AUTHOR</b></h4><pre>
           <b>Steven</b> <b>Rostedt</b> &lt;<b><a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a></b>[1]&gt;

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<b><a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a></b>[2]&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       libtracefs is Free Software licensed under the GNU LGPL 2.1

</pre><h4><b>RESOURCES</b></h4><pre>
       <b>https://git.kernel.org/pub/scm/libs/libtrace/libtracefs.git/</b>

</pre><h4><b>COPYING</b></h4><pre>
       Copyright (C) 2022 Google, Inc. Free use of this software is granted under the terms of the GNU Public
       License (GPL).

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a>
           <a href="mailto:rostedt@goodmis.org">mailto:rostedt@goodmis.org</a>

        2. <a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a>
           <a href="mailto:linux-trace-devel@vger.kernel.org">mailto:linux-trace-devel@vger.kernel.org</a>

libtracefs 1.8.1                                   06/05/2025                                      <u><a href="../man3/LIBTRACEFS.3.html">LIBTRACEFS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>