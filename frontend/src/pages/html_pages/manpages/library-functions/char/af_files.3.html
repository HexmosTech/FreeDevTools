<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>af_crkey, af_open, af_close, af_rm, af_establish, af_restore - AtFS file system operations</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/atfs-dev">atfs-dev_1.4pl6-16.1build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       af_crkey, af_open, af_close, af_rm, af_establish, af_restore - AtFS file system operations

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;atfs.h&gt;

       int af_crkey (char *syspath, char *name, char *type, Af_key *aso)

       FILE *af_open (Af_key *aso, char *mode)

       int af_close (FILE *stream)

       int af_rm (Af_key *aso)

       int af_establish (Af_key *aso, char *filename)

       int af_restore (Af_key *aso, Af_key *restoredAso)

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>af_crkey</u> creates an object key for a regular UNIX file identified by name, type and system path.  <u>syspath</u>
       is  an  either  absolute or relative directory name. An empty syspath refers to the current directory. By
       convention, AtFS interprets the filename suffix of a UNIX file as <u>type</u> and the filename without suffix as
       <u>name</u> attribute.  To give an example, the path name

              <b>/usr/andy/foo.c</b> is split up in <b>/usr/andy</b> (syspath) <b>foo</b> (name) <b>c</b> (type)

       A period as first character in the filename is always considered as part of the name. Hence <b>.cshrc</b> has  a
       name  but  no  type.  "."  and  ".." are recognized as names too.  If the named UNIX file does not exist,
       af_crkey creates an empty file.  The created key remains accessible until it is explicitly  given  up  by
       af_dropkey (manual page <a href="../man3/af_retrieve.3.html">af_retrieve</a>(3)).

       <u>af_open</u> opens the contents of the ASO pointed to by <u>aso</u> and associates a stream with it. A pointer to the
       FILE  structure associated with the stream is returned. <u>Mode</u> is a character string that is either "r[+]",
       "w[+]" or "a[+]". See <a href="../man3/fopen.3.html">fopen</a>(3) for further details. Upon error, af_open returns a NULL pointer.  Non-busy
       ASOs can only be opened with mode "r". If a non-busy ASO is opened, it's contents will  be  placed  in  a
       temporary UNIX file due to storage of versions as deltas.

       <u>af_close</u>  closes  a  stream  previously  opened  by  af_open  (see <a href="../man3/fclose.3.html">fclose</a>(3)). Temporary files created by
       af_open, holding the contents of a saved versions are unlinked right after being opened so that they will
       automatically disappear on closing.

       <u>af_rm</u> removes the specified ASO. The application has to have a lock (see <a href="../man3/af_lock.3.html">af_lock</a>(3)) set on the ASO  that
       shall be deleted by af_rm. ASOs with the state attribute set to <b>accessed</b> or <b>frozen</b> cannot be removed.  If
       you  keep  multiple  keys  of  one  object  (perhaps in different sets) af_rm invalidates all keys of the
       removed object.  As AtFS does not support multiple links to saved ASOs, af_rm on a saved  version  always
       does a physical removal.

       <u>af_establish</u>  establishes  the contents of the saved version, pointed to by <u>aso</u> in a file named <u>filename</u>.
       The resulting file gets the version's modification and access date.

       <u>af_restore</u> is used to restore formerly saved derived ASOs into their old file location. It also  restores
       the  file  modification  and  access  date. This function cannot be applied to source objects. af_restore
       returns the key of the restored version in the buffer <u>restoredAso</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3/fopen.3.html">fopen</a>(3), <a href="../man3/fclose.3.html">fclose</a>(3), <a href="../man3/af_retrieve.3.html">af_retrieve</a>(3), <a href="../man3/af_lock.3.html">af_lock</a>(3)

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Upon error, -1 or a nil pointer (depending on the return type) is returned and <u>af_errno</u>  is  set  to  the
       corresponding error number.

AtFS-1.71                                   Fri Jun 25 14:33:07 1993                                 <u><a href="../man3/af_files.3.html">af_files</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>