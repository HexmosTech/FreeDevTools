<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_export_keying_material, SSL_export_keying_material_early - obtain keying material for application use</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_export_keying_material, SSL_export_keying_material_early - obtain keying material for application use

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        int SSL_export_keying_material(SSL *s, unsigned char *out, size_t olen,
                                       const char *label, size_t llen,
                                       const unsigned char *context,
                                       size_t contextlen, int use_context);

        int SSL_export_keying_material_early(SSL *s, unsigned char *out, size_t olen,
                                             const char *label, size_t llen,
                                             const unsigned char *context,
                                             size_t contextlen);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       During the creation of a TLS or DTLS connection shared keying material is established between the two
       endpoints. The functions <b>SSL_export_keying_material()</b> and <b>SSL_export_keying_material_early()</b> enable an
       application to use some of this keying material for its own purposes in accordance with RFC5705 (for
       TLSv1.2 and below) or RFC8446 (for TLSv1.3).

       <b>SSL_export_keying_material()</b> derives keying material using the <u>exporter_master_secret</u> established in the
       handshake.

       <b>SSL_export_keying_material_early()</b> is only usable with TLSv1.3, and derives keying material using the
       <u>early_exporter_master_secret</u> (as defined in the TLS 1.3 RFC). For the client, the
       <u>early_exporter_master_secret</u> is only available when the client attempts to send 0-RTT data. For the
       server, it is only available when the server accepts 0-RTT data.

       An application may need to securely establish the context within which this keying material will be used.
       For example this may include identifiers for the application session, application algorithms or
       parameters, or the lifetime of the context. The context value is left to the application but must be the
       same on both sides of the communication.

       For a given SSL connection <b>s</b>, <b>olen</b> bytes of data will be written to <b>out</b>. The application specific context
       should be supplied in the location pointed to by <b>context</b> and should be <b>contextlen</b> bytes long. Provision
       of a context is optional. If the context should be omitted entirely then <b>use_context</b> should be set to 0.
       Otherwise it should be any other value. If <b>use_context</b> is 0 then the values of <b>context</b> and <b>contextlen</b> are
       ignored.  Note that in TLSv1.2 and below a zero length context is treated differently from no context at
       all, and will result in different keying material being returned.  In TLSv1.3 a zero length context is
       that same as no context at all and will result in the same keying material being returned.

       An application specific label should be provided in the location pointed to by <b>label</b> and should be <b>llen</b>
       bytes long. Typically this will be a value from the IANA Exporter Label Registry
       (&lt;https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#exporter-labels&gt;).  Alternatively
       labels beginning with "EXPERIMENTAL" are permitted by the standard to be used without registration.
       TLSv1.3 imposes a maximum label length of 249 bytes.

       Note that this function is only defined for TLSv1.0 and above, and DTLSv1.0 and above. Attempting to use
       it in SSLv3 will result in an error.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_export_keying_material()</b> returns 0 or -1 on failure or 1 on success.

       <b>SSL_export_keying_material_early()</b> returns 0 on failure or 1 on success.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>SSL_export_keying_material_early()</b> function was added in OpenSSL 1.1.1.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2017-2018 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                   <u><a href="../man3SSL/SSL_EXPORT_KEYING_MATERIAL.3SSL.html">SSL_EXPORT_KEYING_MATERIAL</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>