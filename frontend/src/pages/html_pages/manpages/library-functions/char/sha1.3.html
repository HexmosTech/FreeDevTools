<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHA1Init,  SHA1Update,  SHA1Pad,  SHA1Final,  SHA1Transform, SHA1End, SHA1File, SHA1FileChunk, SHA1Data —</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmd-dev">libmd-dev_1.1.0-2build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SHA1Init,  SHA1Update,  SHA1Pad,  SHA1Final,  SHA1Transform, SHA1End, SHA1File, SHA1FileChunk, SHA1Data —
       calculate the NIST Secure Hash Algorithm

</pre><h4><b>LIBRARY</b></h4><pre>
       Message Digest (MD4, MD5, etc.) Support Library (libmd, -lmd)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/types.h&gt;</b>
       <b>#include</b> <b>&lt;sha1.h&gt;</b>

       <u>void</u>
       <b>SHA1Init</b>(<u>SHA1_CTX</u> <u>*context</u>);

       <u>void</u>
       <b>SHA1Update</b>(<u>SHA1_CTX</u> <u>*context</u>, <u>const</u> <u>uint8_t</u> <u>*data</u>, <u>size_t</u> <u>len</u>);

       <u>void</u>
       <b>SHA1Pad</b>(<u>SHA1_CTX</u> <u>*context</u>);

       <u>void</u>
       <b>SHA1Final</b>(<u>uint8_t</u> <u>digest[SHA1_DIGEST_LENGTH]</u>, <u>SHA1_CTX</u> <u>*context</u>);

       <u>void</u>
       <b>SHA1Transform</b>(<u>uint32_t</u> <u>state[5]</u>, <u>const</u> <u>uint8_t</u> <u>buffer[SHA1_BLOCK_LENGTH]</u>);

       <u>char</u> <u>*</u>
       <b>SHA1End</b>(<u>SHA1_CTX</u> <u>*context</u>, <u>char</u> <u>*buf</u>);

       <u>char</u> <u>*</u>
       <b>SHA1File</b>(<u>const</u> <u>char</u> <u>*filename</u>, <u>char</u> <u>*buf</u>);

       <u>char</u> <u>*</u>
       <b>SHA1FileChunk</b>(<u>const</u> <u>char</u> <u>*filename</u>, <u>char</u> <u>*buf</u>, <u>off_t</u> <u>offset</u>, <u>off_t</u> <u>length</u>);

       <u>char</u> <u>*</u>
       <b>SHA1Data</b>(<u>const</u> <u>uint8_t</u> <u>*data</u>, <u>size_t</u> <u>len</u>, <u>char</u> <u>*buf</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The SHA1 functions implement the NIST Secure Hash Algorithm (SHA-1), FIPS PUB 180-1.  SHA-1  is  used  to
       generate  a condensed representation of a message called a message digest.  The algorithm takes a message
       less than 2^64 bits as input and produces a 160-bit digest suitable for use as a digital signature.

       While the SHA1 functions are considered to be more secure than the <u><a href="../man3/md4.3.html">md4</a></u>(3) and <u><a href="../man3/md5.3.html">md5</a></u>(3) functions with which
       they share a similar interface, they are considered insecure as of 2005, and  as  of  2020  chosen-prefix
       attacks have become practical, thus these must not be used in cryptographic contexts.

       The  <b>SHA1Init</b>()  function initializes a SHA1_CTX <u>context</u> for use with <b>SHA1Update</b>(), and <b>SHA1Final</b>().  The
       <b>SHA1Update</b>() function adds <u>data</u> of length <u>len</u> to the  SHA1_CTX  specified  by  <u>context</u>.   <b>SHA1Final</b>()  is
       called when all data has been added via <b>SHA1Update</b>() and stores a message digest in the <u>digest</u> parameter.

       The  <b>SHA1Pad</b>()  function  can  be  used to apply padding to the message digest as in <b>SHA1Final</b>(), but the
       current context can still be used with <b>SHA1Update</b>().

       The <b>SHA1Transform</b>() function is used by <b>SHA1Update</b>() to hash 512-bit blocks and forms  the  core  of  the
       algorithm.   Most  programs should use the interface provided by <b>SHA1Init</b>(), <b>SHA1Update</b>() and <b>SHA1Final</b>()
       instead of calling <b>SHA1Transform</b>() directly.

       The <b>SHA1End</b>() function is  a  front  end  for  <b>SHA1Final</b>()  which  converts  the  digest  into  an  ASCII
       representation of the 160 bit digest in hexadecimal.

       The  <b>SHA1File</b>()  function  calculates  the  digest  for  a file and returns the result via <b>SHA1End</b>().  If
       <b>SHA1File</b>() is unable to open the file a NULL pointer is returned.

       <b>SHA1FileChunk</b>() behaves like <b>SHA1File</b>() but calculates the digest only  for  that  portion  of  the  file
       starting  at  <u>offset</u>  and  continuing  for  <u>length</u> bytes or until end of file is reached, whichever comes
       first.  A zero <u>length</u> can be specified to read until end of file.  A negative <u>length</u> or  <u>offset</u>  will  be
       ignored.

       The  <b>SHA1Data</b>()  function  calculates  the  digest  of  an  arbitrary  string  and returns the result via
       <b>SHA1End</b>().

       For each of the <b>SHA1End</b>(), <b>SHA1File</b>(), and <b>SHA1Data</b>() functions the <u>buf</u>  parameter  should  either  be  a
       string  of  at  least  41  characters  in  size  or  a  NULL  pointer.  In the latter case, space will be
       dynamically allocated via <u><a href="../man3/malloc.3.html">malloc</a></u>(3) and should be freed using <u><a href="../man3/free.3.html">free</a></u>(3) when it is no longer needed.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The  follow   code   fragment   will   calculate   the   digest   for   the   string   "abc"   which   is
       ``0xa9993e364706816aba3e25717850c26c9cd0d89d''.

             SHA1_CTX sha;
             uint8_t results[SHA1_DIGEST_LENGTH];
             char *buf;
             int n;

             buf = "abc";
             n = strlen(buf);
             SHA1Init(&amp;sha);
             SHA1Update(&amp;sha, (uint8_t *)buf, n);
             SHA1Final(results, &amp;sha);

             /* Print the digest as one long hex value */
             printf("0x");
             for (n = 0; n &lt; SHA1_DIGEST_LENGTH; n++)
                     printf("%02x", results[n]);
             putchar('\n');

       Alternately, the helper functions could be used in the following way:

             uint8_t output[SHA1_DIGEST_STRING_LENGTH];
             char *buf = "abc";

             printf("0x%s\n", SHA1Data(buf, strlen(buf), output));

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/cksum.1.html">cksum</a></u>(1), <u><a href="../man1/sha1.1.html">sha1</a></u>(1), <u><a href="../man3/md4.3.html">md4</a></u>(3), <u><a href="../man3/md5.3.html">md5</a></u>(3), <u><a href="../man3/rmd160.3.html">rmd160</a></u>(3), <u><a href="../man3/sha2.3.html">sha2</a></u>(3)

       J. Burrows, <u>The</u> <u>Secure</u> <u>Hash</u> <u>Standard</u>, FIPS PUB 180-1.

       D. Eastlake and P. Jones, <u>US</u> <u>Secure</u> <u>Hash</u> <u>Algorithm</u> <u>1</u>, RFC 3174.

</pre><h4><b>HISTORY</b></h4><pre>
       The SHA-1 functions appeared in OpenBSD 2.0.

</pre><h4><b>AUTHORS</b></h4><pre>
       This implementation of SHA-1 was written by Steve Reid.

       The <b>SHA1End</b>(), <b>SHA1File</b>(), <b>SHA1FileChunk</b>(), and <b>SHA1Data</b>() helper functions are derived from code written
       by Poul-Henning Kamp.

</pre><h4><b>CAVEATS</b></h4><pre>
       This  implementation  of  SHA-1  has not been validated by NIST and as such is not in official compliance
       with the standard.

       If a message digest is to be copied to a multi-byte type (ie: an array of five 32-bit integers)  it  will
       be necessary to perform byte swapping on little endian machines such as the i386, alpha, and vax.

Debian                                          February 13, 2008                                        <u><a href="../man3/SHA1.3.html">SHA1</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>