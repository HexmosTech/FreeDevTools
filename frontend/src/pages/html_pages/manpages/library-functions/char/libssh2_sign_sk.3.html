<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>libssh2_sign_sk - Create a signature from a FIDO2 authenticator.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssh2-1-dev">libssh2-1-dev_1.11.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       libssh2_sign_sk - Create a signature from a FIDO2 authenticator.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;libssh2.h&gt;

       int
       libssh2_sign_sk(LIBSSH2_SESSION *session,
                       unsigned char **sig,
                       size_t *sig_len,
                       const unsigned char *data,
                       size_t data_len,
                       void **abstract);

       typedef struct _LIBSSH2_PRIVKEY_SK {
           int algorithm;
           uint8_t flags;
           const char *application;
           const unsigned char *key_handle;
           size_t handle_len;
           LIBSSH2_USERAUTH_SK_SIGN_FUNC((*sign_callback));
           void **orig_abstract;
       } LIBSSH2_PRIVKEY_SK;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>session</u> - Session instance as returned by <b><a href="../man3/libssh2_session_init_ex.3.html">libssh2_session_init_ex</a>(3)</b>

       <u>sig</u>  -  A  pointer to a buffer in which to place the signature. The caller is responsible for freeing the
       signature with LIBSSH2_FREE.

       <u>sig_len</u> - A pointer to the length of the sig parameter.

       <u>data</u> - The data to sign.

       <u>data_len</u> - The length of the data parameter.

       <u>abstract</u> - A pointer to a pointer to a LIBSSH2_PRIVKEY_SK. See description below.

       Create a signature from a FIDO2 authenticator, using either the <a href="mailto:sk-ssh-ed25519@openssh.com">sk-ssh-ed25519@openssh.com</a>  or  sk-ecdsa-
       <a href="mailto:sha2-nistp256@openssh.com">sha2-nistp256@openssh.com</a> key exchange algorithms.

       The  abstract  parameter  is  a  pointer  to  a  pointer  due  to  the  internal workings of libssh2. The
       LIBSSH2_PRIVKEY_SK must be completely filled out, and the caller is responsible for all memory management
       of its fields.

       <u>algorithm</u>  -  The  signing  algorithm  to  use.  Possible  values  are  LIBSSH2_HOSTKEY_TYPE_ED25519  and
       LIBSSH2_HOSTKEY_TYPE_ECDSA_256.

       <u>flags</u> - A bitmask specifying options for the authenticator. When LIBSSH2_SK_PRESENCE_REQUIRED is set, the
       authenticator  requires a touch. When LIBSSH2_SK_VERIFICATION_REQUIRED is set, the authenticator requires
       a PIN.  Many servers and authenticators do not work properly  when  LIBSSH2_SK_PRESENCE_REQUIRED  is  not
       set.

       <u>application</u> - A user-defined string to use as the RP name for the authenticator. Usually "ssh:".

       <u>key_handle</u> - The key handle to use for the authenticator's allow list.

       <u>handle_len</u> - The length of the key_handle parameter.

       <u>abstract</u>  - User-defined data. When a PIN is required, use this to pass in the PIN, or a function pointer
       to retrieve the PIN.

       <u>key_handle</u> The decoded key handle from the private key file.

       <u>handle_len</u> The length of the key_handle parameter.

       <u>sign_callback</u> - Responsible for communicating with the hardware authenticator to generate a signature. On
       success, the signature information must be placed in the `<u>sig_info</u> sig_info parameter  and  the  callback
       must return 0. On failure, it should return a negative number. See <b><a href="../man3/libssh2_userauth_publickey_sk.3.html">libssh2_userauth_publickey_sk</a>(3)</b>
        for more information.

       <u>orig_abstract</u>  -  User-defined  data.  When a PIN is required, use this to pass in the PIN, or a function
       pointer to retrieve the PIN.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Return 0 on success or negative on failure.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libssh2_userauth_publickey_sk.3.html">libssh2_userauth_publickey_sk</a>(3)</b>

libssh2 1.10.0                                     1 Jun 2022                                 <u><a href="../man3/libssh2_sign_sk.3.html">libssh2_sign_sk</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>