<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Printexc - Facilities for printing exceptions and inspecting current call stack.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ocaml-man">ocaml-man_5.3.0-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Printexc - Facilities for printing exceptions and inspecting current call stack.

</pre><h4><b>Module</b></h4><pre>
       Module   Printexc

</pre><h4><b>Documentation</b></h4><pre>
       Module <b>Printexc</b>
        : <b>sig</b> <b>end</b>

       Facilities for printing exceptions and inspecting current call stack.

       <u>type</u> <u>t</u> = <b>exn</b> = ..

       The type of exception values.

       <u>val</u> <u>to_string</u> : <b>exn</b> <b>-&gt;</b> <b>string</b>

       <b>Printexc.to_string</b> <b>e</b> returns a string representation of the exception <b>e</b> .

       <u>val</u> <u>to_string_default</u> : <b>exn</b> <b>-&gt;</b> <b>string</b>

       <b>Printexc.to_string_default</b> <b>e</b> returns a string representation of the exception <b>e</b> , ignoring all registered
       exception printers.

       <b>Since</b> 4.09

       <u>val</u> <u>print</u> : <b>('a</b> <b>-&gt;</b> <b>'b)</b> <b>-&gt;</b> <b>'a</b> <b>-&gt;</b> <b>'b</b>

       <b>Printexc.print</b>  <b>fn</b>  <b>x</b>  applies  <b>fn</b>  to  <b>x</b>  and  returns the result.  If the evaluation of <b>fn</b> <b>x</b> raises any
       exception, the name of the exception is printed on standard error output, and  the  exception  is  raised
       again.  The typical use is to catch and report exceptions that escape a function application.

       <u>val</u> <u>catch</u> : <b>('a</b> <b>-&gt;</b> <b>'b)</b> <b>-&gt;</b> <b>'a</b> <b>-&gt;</b> <b>'b</b>

       <b>Deprecated.</b>  This function is no longer needed.

       <b>Printexc.catch</b> <b>fn</b> <b>x</b> is similar to <b>Printexc.print</b> , but aborts the program with exit code 2 after printing
       the  uncaught  exception.   This function is deprecated: the runtime system is now able to print uncaught
       exceptions as precisely as <b>Printexc.catch</b> does.  Moreover, calling  <b>Printexc.catch</b>  makes  it  harder  to
       track  the  location of the exception using the debugger or the stack backtrace facility.  So, do not use
       <b>Printexc.catch</b> in new code.

       <u>val</u> <u>print_backtrace</u> : <b>out_channel</b> <b>-&gt;</b> <b>unit</b>

       <b>Printexc.print_backtrace</b> <b>oc</b> prints an exception backtrace on the output channel <b>oc</b> .  The backtrace lists
       the program locations where the most-recently raised exception was raised and  where  it  was  propagated
       through function calls.

       If  the  call  is  not inside an exception handler, the returned backtrace is unspecified. If the call is
       after some exception-catching code (before in the handler, or in a when-guard during the matching of  the
       exception handler), the backtrace may correspond to a later exception than the handled one.

       <b>Since</b> 3.11

       <u>val</u> <u>get_backtrace</u> : <b>unit</b> <b>-&gt;</b> <b>string</b>

       <b>Printexc.get_backtrace</b>   <b>()</b>   returns   a   string   containing   the   same   exception  backtrace  that
       <b>Printexc.print_backtrace</b> would print. Same restriction usage than <b>Printexc.print_backtrace</b> .

       <b>Since</b> 3.11

       <u>val</u> <u>record_backtrace</u> : <b>bool</b> <b>-&gt;</b> <b>unit</b>

       <b>Printexc.record_backtrace</b> <b>b</b> turns recording of exception backtraces on (if <b>b</b> <b>=</b> <b>true</b> )  or  off  (if  <b>b</b>  <b>=</b>
       <b>false</b>  ).   Initially, backtraces are not recorded, unless the <b>b</b> flag is given to the program through the
       <b>OCAMLRUNPARAM</b> variable.

       <b>Since</b> 3.11

       <u>val</u> <u>backtrace_status</u> : <b>unit</b> <b>-&gt;</b> <b>bool</b>

       <b>Printexc.backtrace_status()</b> returns <b>true</b> if exception backtraces are currently recorded, <b>false</b> if not.

       <b>Since</b> 3.11

       <u>val</u> <u>register_printer</u> : <b>(exn</b> <b>-&gt;</b> <b>string</b> <b>option)</b> <b>-&gt;</b> <b>unit</b>

       <b>Printexc.register_printer</b> <b>fn</b> registers <b>fn</b> as an exception printer.  The printer  should  return  <b>None</b>  or
       raise an exception if it does not know how to convert the passed exception, and <b>Some</b>
            <b>s</b>  with  <b>s</b>  the  resulting  string  if it can convert the passed exception. Exceptions raised by the
       printer are ignored.

       When converting an exception into a string, the printers will be invoked in the reverse  order  of  their
       registrations,  until a printer returns a <b>Some</b> <b>s</b> value (if no such printer exists, the runtime will use a
       generic printer).

       When using this mechanism, one should be aware that an exception backtrace is attached to the thread that
       saw it raised, rather than to the exception itself. Practically, it means that the  code  related  to  <b>fn</b>
       should not use the backtrace if it has itself raised an exception before.

       <b>Since</b> 3.11.2

       <u>val</u> <u>use_printers</u> : <b>exn</b> <b>-&gt;</b> <b>string</b> <b>option</b>

       <b>Printexc.use_printers</b>  <b>e</b> returns <b>None</b> if there are no registered printers and <b>Some</b> <b>s</b> with <b>s</b> the resulting
       string otherwise.

       <b>Since</b> 4.09

   <b>Raw</b> <b>backtraces</b>
       <u>type</u> <u>raw_backtrace</u>

       The type <b>raw_backtrace</b> stores a backtrace in a low-level format, which can be converted  to  usable  form
       using <b>raw_backtrace_entries</b> and <b>backtrace_slots_of_raw_entry</b> below.

       Converting  backtraces  to  <b>backtrace_slot</b>  s  is slower than capturing the backtraces. If an application
       processes many backtraces, it can be useful to use <b>raw_backtrace</b> to avoid or delay conversion.

       Raw backtraces cannot be marshalled. If you need marshalling, you should use the array  returned  by  the
       <b>backtrace_slots</b> function of the next section.

       <b>Since</b> 4.01

       <u>type</u> <u>raw_backtrace_entry</u> = private <b>int</b>

       A <b>raw_backtrace_entry</b> is an element of a <b>raw_backtrace</b> .

       Each  <b>raw_backtrace_entry</b>  is an opaque integer, whose value is not stable between different programs, or
       even between different runs of the same binary.

       A <b>raw_backtrace_entry</b> can be converted to a usable form using  <b>backtrace_slots_of_raw_entry</b>  below.  Note
       that,  due  to inlining, a single <b>raw_backtrace_entry</b> may convert to several <b>backtrace_slot</b> s.  Since the
       values of a <b>raw_backtrace_entry</b> are not stable, they cannot be marshalled. If they are to  be  converted,
       the conversion must be done by the process that generated them.

       Again  due  to  inlining, there may be multiple distinct raw_backtrace_entry values that convert to equal
       <b>backtrace_slot</b> s. However, if two <b>raw_backtrace_entry</b> s are equal as integers, then  they  represent  the
       same <b>backtrace_slot</b> s.

       <b>Since</b> 4.12

       <u>val</u> <u>raw_backtrace_entries</u> : <b>raw_backtrace</b> <b>-&gt;</b> <b>raw_backtrace_entry</b> <b>array</b>

       <b>Since</b> 4.12

       <u>val</u> <u>get_raw_backtrace</u> : <b>unit</b> <b>-&gt;</b> <b>raw_backtrace</b>

       <b>Printexc.get_raw_backtrace</b>  <b>()</b>  returns  the same exception backtrace that <b>Printexc.print_backtrace</b> would
       print, but in a raw format. Same restriction usage than <b>Printexc.print_backtrace</b> .

       <b>Since</b> 4.01

       <u>val</u> <u>print_raw_backtrace</u> : <b>out_channel</b> <b>-&gt;</b> <b>raw_backtrace</b> <b>-&gt;</b> <b>unit</b>

       Print a raw backtrace in the same format <b>Printexc.print_backtrace</b> uses.

       <b>Since</b> 4.01

       <u>val</u> <u>raw_backtrace_to_string</u> : <b>raw_backtrace</b> <b>-&gt;</b> <b>string</b>

       Return a string from a raw backtrace, in the same format <b>Printexc.get_backtrace</b> uses.

       <b>Since</b> 4.01

       <u>val</u> <u>raise_with_backtrace</u> : <b>exn</b> <b>-&gt;</b> <b>raw_backtrace</b> <b>-&gt;</b> <b>'a</b>

       Reraise the exception using the given raw_backtrace for the origin of the exception

       <b>Since</b> 4.05

   <b>Current</b> <b>call</b> <b>stack</b>
       <u>val</u> <u>get_callstack</u> : <b>int</b> <b>-&gt;</b> <b>raw_backtrace</b>

       <b>Printexc.get_callstack</b> <b>n</b> returns a description of the top of the call stack on the current program  point
       (for  the  current thread), with at most <b>n</b> entries.  (Note: this function is not related to exceptions at
       all, despite being part of the <b>Printexc</b> module.)

       <b>Since</b> 4.01

   <b>Uncaught</b> <b>exceptions</b>
       <u>val</u> <u>default_uncaught_exception_handler</u> : <b>exn</b> <b>-&gt;</b> <b>raw_backtrace</b> <b>-&gt;</b> <b>unit</b>

       <b>Printexc.default_uncaught_exception_handler</b> prints the exception and backtrace on standard error output.

       <b>Since</b> 4.11

       <u>val</u> <u>set_uncaught_exception_handler</u> : <b>(exn</b> <b>-&gt;</b> <b>raw_backtrace</b> <b>-&gt;</b> <b>unit)</b> <b>-&gt;</b> <b>unit</b>

       <b>Printexc.set_uncaught_exception_handler</b> <b>fn</b> registers <b>fn</b> as  the  handler  for  uncaught  exceptions.  The
       default handler is <b>Printexc.default_uncaught_exception_handler</b> .

       Note  that  when <b>fn</b> is called all the functions registered with <b>at_exit</b> have already been called. Because
       of this you must make sure any output channel <b>fn</b> writes on is flushed.

       Also note that exceptions raised by user code in the interactive toplevel are not passed to this function
       as they are caught by the toplevel itself.

       If <b>fn</b> raises an exception, both the exceptions passed to <b>fn</b> and raised by <b>fn</b> will be printed  with  their
       respective backtrace.

       <b>Since</b> 4.02

   <b>Manipulation</b> <b>of</b> <b>backtrace</b> <b>information</b>
       These  functions are used to traverse the slots of a raw backtrace and extract information from them in a
       programmer-friendly format.

       <u>type</u> <u>backtrace_slot</u>

       The abstract type <b>backtrace_slot</b> represents a single slot of a backtrace.

       <b>Since</b> 4.02

       <u>val</u> <u>backtrace_slots</u> : <b>raw_backtrace</b> <b>-&gt;</b> <b>backtrace_slot</b> <b>array</b> <b>option</b>

       Returns the slots of a raw backtrace, or <b>None</b> if none of them contain useful information.

       In the return array, the slot at index <b>0</b>  corresponds  to  the  most  recent  function  call,  raise,  or
       primitive <b>get_backtrace</b> call in the trace.

       Some possible reasons for returning <b>None</b> are as follow:

       -none of the slots in the trace come from modules compiled with debug information ( <b>-g</b> )

       -the program is a bytecode program that has not been linked with debug information enabled ( <b>ocamlc</b> <b>-g</b> )

       <b>Since</b> 4.02

       <u>val</u> <u>backtrace_slots_of_raw_entry</u> : <b>raw_backtrace_entry</b> <b>-&gt;</b> <b>backtrace_slot</b> <b>array</b> <b>option</b>

       Returns the slots of a single raw backtrace entry, or <b>None</b> if this entry lacks debug information.

       Slots  are  returned  in the same order as <b>backtrace_slots</b> : the slot at index <b>0</b> is the most recent call,
       raise, or primitive, and subsequent slots represent callers.

       <b>Since</b> 4.12

       <u>type</u> <u>location</u> = {
        filename : <b>string</b> ;
        line_number : <b>int</b> ;
        start_char : <b>int</b> ;
        end_char : <b>int</b> ;
        end_line : <b>int</b> ;  (* .B "Since" 5.2
        *)
        end_col : <b>int</b> ;  (* .B "Since" 5.2
        *)
        }

       The type of location information found in backtraces.  <b>start_char</b> and <b>end_char</b> are positions relative  to
       the beginning of <b>line_number</b> .  <b>end_col</b> is relative to the beginning of <b>end_line</b> .

       <b>Since</b> 4.02

       <u>module</u> <u>Slot</u> <u>:</u> <b>sig</b> <b>end</b>

       <b>Since</b> 4.02

   <b>Raw</b> <b>backtrace</b> <b>slots</b>
       <u>type</u> <u>raw_backtrace_slot</u>

       This   type   is   used   to   iterate   over  the  slots  of  a  <b>raw_backtrace</b>  .   For  most  purposes,
       <b>backtrace_slots_of_raw_entry</b> is easier to use.

       Like <b>raw_backtrace_entry</b> ,  values  of  this  type  are  process-specific  and  must  absolutely  not  be
       marshalled,  and are unsafe to use for this reason (marshalling them may not fail, but un-marshalling and
       using the result will result in undefined behavior).

       Elements of this type can still be compared and hashed: when two elements are equal, then they  represent
       the same source location (the converse is not necessarily true in presence of inlining, for example).

       <b>Since</b> 4.02

       <u>val</u> <u>raw_backtrace_length</u> : <b>raw_backtrace</b> <b>-&gt;</b> <b>int</b>

       <b>raw_backtrace_length</b> <b>bckt</b> returns the number of slots in the backtrace <b>bckt</b> .

       <b>Since</b> 4.02

       <u>val</u> <u>get_raw_backtrace_slot</u> : <b>raw_backtrace</b> <b>-&gt;</b> <b>int</b> <b>-&gt;</b> <b>raw_backtrace_slot</b>

       <b>get_raw_backtrace_slot</b> <b>bckt</b> <b>pos</b> returns the slot in position <b>pos</b> in the backtrace <b>bckt</b> .

       <b>Since</b> 4.02

       <u>val</u> <u>convert_raw_backtrace_slot</u> : <b>raw_backtrace_slot</b> <b>-&gt;</b> <b>backtrace_slot</b>

       Extracts the user-friendly <b>backtrace_slot</b> from a low-level <b>raw_backtrace_slot</b> .

       <b>Since</b> 4.02

       <u>val</u> <u>get_raw_backtrace_next_slot</u> : <b>raw_backtrace_slot</b> <b>-&gt;</b> <b>raw_backtrace_slot</b> <b>option</b>

       <b>get_raw_backtrace_next_slot</b> <b>slot</b> returns the next slot inlined, if any.

       Sample code to iterate over all frames (inlined and non-inlined):
             <b>(*</b> <b>Iterate</b> <b>over</b> <b>inlined</b> <b>frames</b> <b>*)</b>
             <b>let</b> <b>rec</b> <b>iter_raw_backtrace_slot</b> <b>f</b> <b>slot</b> <b>=</b>
               <b>f</b> <b>slot;</b>
               <b>match</b> <b>get_raw_backtrace_next_slot</b> <b>slot</b> <b>with</b>
               <b>|</b> <b>None</b> <b>-&gt;</b> <b>()</b>
               <b>|</b> <b>Some</b> <b>slot'</b> <b>-&gt;</b> <b>iter_raw_backtrace_slot</b> <b>f</b> <b>slot'</b>

             <b>(*</b> <b>Iterate</b> <b>over</b> <b>stack</b> <b>frames</b> <b>*)</b>
             <b>let</b> <b>iter_raw_backtrace</b> <b>f</b> <b>bt</b> <b>=</b>
               <b>for</b> <b>i</b> <b>=</b> <b>0</b> <b>to</b> <b>raw_backtrace_length</b> <b>bt</b> <b>-</b> <b>1</b> <b>do</b>
                 <b>iter_raw_backtrace_slot</b> <b>f</b> <b>(get_raw_backtrace_slot</b> <b>bt</b> <b>i)</b>
               <b>done</b>

       <b>Since</b> 4.04

   <b>Exception</b> <b>slots</b>
       <u>val</u> <u>exn_slot_id</u> : <b>exn</b> <b>-&gt;</b> <b>int</b>

       <b>Printexc.exn_slot_id</b>  returns  an  integer  which  uniquely identifies the constructor used to create the
       exception value <b>exn</b> (in the current runtime).

       <b>Since</b> 4.02

       <u>val</u> <u>exn_slot_name</u> : <b>exn</b> <b>-&gt;</b> <b>string</b>

       <b>Printexc.exn_slot_name</b> <b>exn</b> returns the internal name of the constructor  used  to  create  the  exception
       value <b>exn</b> .

       <b>Since</b> 4.02

OCamldoc                                           2025-06-12                                       <u><a href="../man3o/Printexc.3o.html">Printexc</a></u>(3o)
</pre>
 </div>
</div></section>
</div>
</body>
</html>