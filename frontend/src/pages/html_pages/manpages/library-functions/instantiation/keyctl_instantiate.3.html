<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>keyctl_assume_authority,  keyctl_instantiate,  keyctl_instantiate_iov, keyctl_reject, keyctl_negate - key</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libkeyutils-dev">libkeyutils-dev_1.6.3-6ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       keyctl_assume_authority,  keyctl_instantiate,  keyctl_instantiate_iov, keyctl_reject, keyctl_negate - key
       instantiation functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;keyutils.h&gt;</b>

       <b>long</b> <b>keyctl_assume_authority(key_serial_t</b> <u>key</u><b>);</b>

       <b>long</b> <b>keyctl_instantiate(key_serial_t</b> <u>key</u><b>,</b> <b>const</b> <b>void</b> <b>*</b><u>payload</u><b>,</b>
       <b>size_t</b> <u>plen</u><b>,</b> <b>key_serial_t</b> <u>keyring</u><b>);</b>

       <b>long</b> <b>keyctl_instantiate_iov(key_serial_t</b> <u>key</u><b>,</b>
       <b>const</b> <b>struct</b> <b>iovec</b> <b>*</b><u>payload_iov</u><b>,</b> <b>unsigned</b> <u>ioc</u><b>,</b>
       <b>key_serial_t</b> <u>keyring</u><b>);</b>

       <b>long</b> <b>keyctl_negate(key_serial_t</b> <u>key</u><b>,</b> <b>unsigned</b> <u>timeout</u><b>,</b>
       <b>key_serial_t</b> <u>keyring</u><b>);</b>

       <b>long</b> <b>keyctl_reject(key_serial_t</b> <u>key</u><b>,</b> <b>unsigned</b> <u>timeout</u><b>,</b>
       <b>unsigned</b> <u>error</u><b>,</b> <b>key_serial_t</b> <u>keyring</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>keyctl_assume_authority</b>() assumes the authority for the calling thread to deal with and  instantiate  the
       specified uninstantiated <u>key</u>.

       The  calling  thread must have the appropriate authorisation key resident in one of its keyrings for this
       to succeed, and that authority must not have been revoked.

       The authorising key is allocated by <b>request_key()</b> when it needs to invoke userspace to generate a key for
       the requesting process.  This is then attached to one of the keyrings of the userspace process  to  which
       the task of instantiating the key is given:

              requester -&gt; request_key() -&gt; instantiator

       Calling  this  function  modifies  the  way  <b>request_key</b>()  works  when  called thereafter by the calling
       (instantiator) thread; once the authority is assumed, the keyrings of the initial process  are  added  to
       the search path, using the initial process's UID, GID, groups and security context.

       If  a  thread  has  multiple  instantiations  to  deal  with,  it  may  call  this function to change the
       authorisation key currently in effect.  Supplying a <b>zero</b> <u>key</u> de-assumes the currently assumed authority.

       <b>NOTE!</b>  This is a per-thread setting and not a per-process setting so that a multithreaded process can  be
       used to instantiate several keys at once.

       <b>keyctl_instantiate</b>()  instantiates the payload of an uninstantiated key from the data specified.  <u>payload</u>
       and <u>plen</u> specify the data for the new payload.  <u>payload</u> may be NULL and <u>plen</u> may be zero if the key  type
       permits that.  The key type may reject the data if it's in the wrong format or in some other way invalid.

       <b>keyctl_instantiate_iov</b>()  is similar, but the data is passed in an array of iovec structs instead of in a
       flat buffer.  <u>payload_iov</u> points to the base of the array and <u>ioc</u> indicates how many elements there  are.
       <u>payload_iov</u> may be NULL or <u>ioc</u> may be zero to indicate that no data is being supplied.

       <b>keyctl_reject</b>()  marks  a  key  as  negatively instantiated and sets the expiration timer on it.  <u>timeout</u>
       specifies the lifetime of the key in seconds.  <u>error</u> specifies the error to be  returned  when  a  search
       hits  the  key  (this  is typically <b>EKEYREJECTED</b>, <b>EKEYREVOKED</b> or <b>EKEYEXPIRED</b>).  Note that <b>keyctl_reject</b>()
       falls back to <b>keyctl_negate</b>() if the kernel does not support it.

       <b>keyctl_negate</b>() as <b>keyctl_reject</b>() with an error code of <u>ENOKEY</u><b>.</b>

       Only a key for which authority has been assumed may be instantiated or negatively instantiated, and  once
       instantiated, the authorisation key will be revoked and the requesting process will be able to resume.

       The  destination  <u>keyring</u>,  if  given,  is  assumed  to  belong  to  the  initial  requester, and not the
       instantiating process.  Therefore, the special keyring IDs refer to the  requesting  process's  keyrings,
       not the caller's, and the requester's UID, etc. will be used to access them.

       The destination keyring can be <b>zero</b> if no extra link is desired.

       The requester, not the caller, must have <b>write</b> permission on the destination for a link to be made there.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On  success  <b>keyctl_instantiate</b>() returns <b>0</b>.  On error, the value <b>-1</b> will be returned and <u>errno</u> will have
       been set to an appropriate error.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>ENOKEY</b> The key or keyring specified is invalid.

       <b>EKEYEXPIRED</b>
              The keyring specified has expired.

       <b>EKEYREVOKED</b>
              The key or keyring specified had been revoked, or the authorisation has been revoked.

       <b>EINVAL</b> The payload data was invalid.

       <b>ENOMEM</b> Insufficient memory to store the new payload or to expand the destination keyring.

       <b>EDQUOT</b> The key quota for the key's user  would  be  exceeded  by  increasing  the  size  of  the  key  to
              accommodate the new payload or the key quota for the keyring's user would be exceeded by expanding
              the destination keyring.

       <b>EACCES</b> The key exists, but is not <b>writable</b> by the requester.

</pre><h4><b>LINKING</b></h4><pre>
       This  is  a  library  function  that  can  be  found  in <u>libkeyutils</u>.  When linking, <b>-lkeyutils</b> should be
       specified to the linker.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/keyctl.1.html">keyctl</a></b>(1), <b><a href="../man2/add_key.2.html">add_key</a></b>(2), <b><a href="../man2/keyctl.2.html">keyctl</a></b>(2), <b><a href="../man2/request_key.2.html">request_key</a></b>(2), <b><a href="../man3/keyctl.3.html">keyctl</a></b>(3), <b><a href="../man7/keyrings.7.html">keyrings</a></b>(7), <b><a href="../man7/keyutils.7.html">keyutils</a></b>(7), <b><a href="../man8/request-key.8.html">request-key</a></b>(8)

Linux                                              4 May 2006                              <u><a href="../man3/KEYCTL_INSTANTIATE.3.html">KEYCTL_INSTANTIATE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>