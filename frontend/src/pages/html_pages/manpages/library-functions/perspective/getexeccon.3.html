<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>getexeccon, setexeccon - get or set the SELinux security context used for executing a new process</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libselinux1-dev">libselinux1-dev_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       getexeccon, setexeccon - get or set the SELinux security context used for executing a new process

       rpm_execcon - run a helper for rpm in an appropriate security context

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/selinux.h&gt;</b>

       <b>int</b> <b>getexeccon(char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getexeccon_raw(char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>setexeccon(const</b> <b>char</b> <b>*</b><u>context</u><b>);</b>

       <b>int</b> <b>setexeccon_raw(const</b> <b>char</b> <b>*</b><u>context</u><b>);</b>

       <b>int</b> <b>setexecfilecon(const</b> <b>char</b> <b>*</b><u>filename</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>fallback_type</u><b>);</b>

       <b>int</b> <b>rpm_execcon(unsigned</b> <b>int</b> <u>verified</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>filename</u><b>,</b> <b>char</b> <b>*const</b> <u>argv</u><b>[],</b> <b>char</b> <b>*const</b> <u>envp</u><b>[]);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>getexeccon</b>()  retrieves  the  context  used for executing a new process.  This returned context should be
       freed with <b><a href="../man3/freecon.3.html">freecon</a></b>(3) if non-NULL.  <b>getexeccon</b>() sets <b>*</b><u>context</u> to  NULL  if  no  exec  context  has  been
       explicitly set by the program (i.e., using the default policy behavior).

       <b>setexeccon</b>()  sets  the  context used for the next <b><a href="../man2/execve.2.html">execve</a></b>(2) call.  NULL can be passed to <b>setexeccon</b>() to
       reset to the default policy behavior.  The exec context is automatically reset after the next  <b><a href="../man2/execve.2.html">execve</a></b>(2),
       so a program doesn't need to explicitly sanitize it upon startup.

       <b>setexeccon</b>()  can  be  applied  prior  to  library  functions that internally perform an <b><a href="../man2/execve.2.html">execve</a></b>(2), e.g.,
       <b>execl</b>*(3), <b>execv</b>*(3), <b><a href="../man3/popen.3.html">popen</a></b>(3), in order to set an exec context for that operation.

       <b>getexeccon_raw</b>() and <b>setexeccon_raw</b>() behave identically to their non-raw counterparts but do not perform
       context translation.

       <b>Note:</b> Signal handlers that perform an <b><a href="../man2/execve.2.html">execve</a></b>(2) must take care to  save,  reset,  and  restore  the  exec
       context to avoid unexpected behavior.

       <b>setexecfilecon</b>() sets the context used for the next <b><a href="../man2/execve.2.html">execve</a></b>(2) call, based on the policy for the <u>filename</u>,
       and falling back to a new context with a <u>fallback_type</u> in case there is no transition.

       <b>rpm_execcon</b>()  is  deprecated; please use <b>setexecfilecon</b>() in conjunction with <b><a href="../man2/execve.2.html">execve</a></b>(2) in all new code.
       This function runs a helper for rpm in an appropriate security context.  The  verified  parameter  should
       contain  the  return  code from the signature verification (0 == ok, 1 == notfound, 2 == verifyfail, 3 ==
       nottrusted, 4 == nokey), although this information is  not  yet  used  by  the  function.   The  function
       determines the proper security context for the helper based on policy, sets the exec context accordingly,
       and then executes the specified filename with the provided argument and environment arrays.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On failure, -1 is returned and <u>errno</u> is  set appropriately.

       On  success  <b>getexeccon</b>(),  <b>setexeccon</b>()  and <b>setexecfilecon</b>() return 0.  <b>rpm_execcon</b>() only returns upon
       errors, as it calls <b><a href="../man2/execve.2.html">execve</a></b>(2).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/selinux.8.html">selinux</a></b>(8), <b><a href="../man3/freecon.3.html">freecon</a></b>(3), <b><a href="../man3/getcon.3.html">getcon</a></b>(3)

<a href="mailto:russell@coker.com.au">russell@coker.com.au</a>                             1 January 2004                                    <u><a href="../man3/getexeccon.3.html">getexeccon</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>