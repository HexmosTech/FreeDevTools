<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>getcon, getprevcon, getpidcon - get SELinux security context of a process</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libselinux1-dev">libselinux1-dev_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       getcon, getprevcon, getpidcon - get SELinux security context of a process

       freecon, freeconary - free memory associated with SELinux security contexts

       getpeercon - get security context of a peer socket

       setcon - set current security context of a process

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/selinux.h&gt;</b>

       <b>int</b> <b>getcon(char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getcon_raw(char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getprevcon(char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getprevcon_raw(char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getpidcon(pid_t</b> <u>pid</u><b>,</b> <b>char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getpidcon_raw(pid_t</b> <u>pid</u><b>,</b> <b>char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getpidprevcon(pid_t</b> <u>pid</u><b>,</b> <b>char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getpidprevcon_raw(pid_t</b> <u>pid</u><b>,</b> <b>char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getpeercon(int</b> <u>fd</u><b>,</b> <b>char</b> <b>**</b><u>context</u><b>);</b>

       <b>int</b> <b>getpeercon_raw(int</b> <u>fd</u><b>,</b> <b>char</b> <b>**</b><u>context</u><b>);</b>

       <b>void</b> <b>freecon(char</b> <b>*</b><u>con</u><b>);</b>

       <b>void</b> <b>freeconary(char</b> <b>**</b><u>con</u><b>);</b>

       <b>int</b> <b>setcon(const</b> <b>char</b> <b>*</b><u>context</u><b>);</b>

       <b>int</b> <b>setcon_raw(const</b> <b>char</b> <b>*</b><u>context</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>getcon</b>()
              retrieves the context of the current process, which must be free'd with <b>freecon</b>().

       <b>getprevcon</b>()
              same as getcon but gets the context before the last exec.

       <b>getpidcon</b>()
              returns the process context for the specified PID, which must be free'd with <b>freecon</b>().

       <b>getpidprevcon</b>()
              returns  the process context before the last exec for the specified PID, which must be free'd with
              <b>freecon</b>().

       <b>getpeercon</b>()
              retrieves the context of the peer socket, which must be free'd with <b>freecon</b>().

       <b>freecon</b>()
              frees the memory allocated for a security context.

              If <u>con</u> is NULL, no operation is performed.

       <b>freeconary</b>()
              frees the memory allocated for a context array.

              If <u>con</u> is NULL, no operation is performed.

       <b>setcon</b>()
              sets the current security context of the process to a new value.  Note that use of  this  function
              requires that the entire application be trusted to maintain any desired separation between the old
              and  new  security  contexts,  unlike  exec-based  transitions  performed via <b><a href="../man3/setexeccon.3.html">setexeccon</a></b>(3).  When
              possible, decompose your application and use <b><a href="../man3/setexeccon.3.html">setexeccon</a></b>(3) and <b><a href="../man3/execve.3.html">execve</a></b>(3) instead.

              Since access to file descriptors is revalidated upon use by  SELinux,  the  new  context  must  be
              explicitly  authorized  in  the policy to use the descriptors opened by the old context if that is
              desired.  Otherwise, attempts by the process to use any  existing  descriptors  (including  <u>stdin</u>,
              <u>stdout</u>, and <u>stderr</u>) after performing the <b>setcon</b>() will fail.

              A  multi-threaded application can perform a <b>setcon</b>() prior to creating any child threads, in which
              case all of the child threads will inherit the new  context.   However,  prior  to  Linux  2.6.28,
              <b>setcon</b>()  would  fail  if there are any other threads running in the same process since this would
              yield an inconsistency among the security contexts of  threads  sharing  the  same  memory  space.
              Since  Linux  2.6.28, <b>setcon</b>() is permitted for threads within a multi-threaded process if the new
              security context is bounded by the old security context, where the  bounded  relation  is  defined
              through  typebounds  statements  in  the policy and guarantees that the new security context has a
              subset of the permissions of the old security context.

              If the process was being ptraced at the time of the <b>setcon</b>() operation, ptrace permission will  be
              revalidated against the new context and the <b>setcon</b>() will fail if it is not allowed by policy.

       <b>*_raw</b>(),
              <b>getcon_raw</b>(),   <b>getprevcon_raw</b>(),   <b>getpidcon_raw</b>(),  <b>getpidprevcon_raw</b>(),  <b>getpeercon_raw</b>(),  and
              <b>setcon_raw</b>() behave  identically  to  their  non-raw  counterparts  but  do  not  perform  context
              translation.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On error -1 is returned with errno set.  On success 0 is returned.

</pre><h4><b>NOTES</b></h4><pre>
       The  retrieval  functions  might  return  success  and set <u>*context</u> to NULL if and only if SELinux is not
       enabled.

       Querying a foreign process via its PID, e.g., <b>getpidcon</b>() or  <b>getpidprevcon</b>(),  is  inherently  racy  and
       therefore should never be relied upon for security purposes.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/selinux.8.html">selinux</a></b>(8), <b><a href="../man3/setexeccon.3.html">setexeccon</a></b>(3)

<a href="mailto:russell@coker.com.au">russell@coker.com.au</a>                            21 December 2011                                       <u><a href="../man3/getcon.3.html">getcon</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>