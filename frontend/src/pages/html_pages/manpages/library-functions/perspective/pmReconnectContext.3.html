<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmReconnectContext - reconnect to a PMAPI context</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpcp3-dev">libpcp3-dev_6.3.8-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmReconnectContext</b> - reconnect to a PMAPI context

</pre><h4><b>C</b> <b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;pcp/pmapi.h&gt;</b>

       <b>int</b> <b>pmReconnectContext(int</b> <u>handle</u><b>);</b>

       <b>cc</b> <b>...</b> <b>-lpcp</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       As  a  consequence  of  network,  host  or  Performance  Metrics  Collector  Daemon  (PMCD)  failures, an
       application's connection to a PMCD may be established and then subsequently lost.

       The routine <b>pmReconnectContext</b> allows an application to request that the  context  identified  by  <u>handle</u>
       should be re-established, provided the associated metrics source is accessible.

       When  the  source  of  metrics  associated with the context <u>handle</u> is <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1), then to avoid flooding the
       system with reconnect requests, <b>pmReconnectContext</b> will only attempt  a  reconnection  after  a  suitable
       delay  from  the previous unsuccessful attempt to reconnect this context. This imposed restriction on the
       reconnect re-try time interval uses an exponential back-off so that the initial delay is 5 seconds  after
       the  first  unsuccessful  attempt,  then 10 seconds, then 20 seconds, then 40 seconds and then 80 seconds
       thereafter.

       The environment variable <b>PMCD_RECONNECT_TIMEOUT</b> may be used  to  redefine  the  back-off  intervals,  see
       <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3).

       Calling <b>pmReconnectContext</b> with a handle identifying a currently connected <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) context will cause the
       connection to be broken before any reconnection is attempted.

       If  <u>handle</u>  identifies a context associated with an archive source of metrics, <b>pmReconnectContext</b> returns
       without delay.

       If the reconnection succeeds, <b>pmReconnectContext</b> returns <u>handle</u>.

       As a  side-effect  of  reconnecting,  any  derived  metrics  that  have  previously  been  defined  using
       <b><a href="../man3/pmRegisterDerived.3.html">pmRegisterDerived</a></b>(3),  <b><a href="../man3/pmRegisterDerivedMetric.3.html">pmRegisterDerivedMetric</a></b>(3)  or <b><a href="../man3/pmLoadDerivedConfig.3.html">pmLoadDerivedConfig</a></b>(3) will be re-processed and re-
       bound to the available metrics from the reconnected  source.   The  support  of  dynamic  definition  for
       derived  metrics  provides  one use case where <b>pmReconnectContext</b> may be called even if the connection to
       the metrics source has not been lost.

       Note that even in the case of a successful reconnection, <b>pmReconnectContext</b> does not change  the  current
       Performance Metrics Application Programming Interface (PMAPI) context, so <u>handle</u> remains valid.

       When  attempting  to  connect  to a remote <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) on a machine that is booting, <b>pmReconnectContext</b> could
       potentially  block  for  a  long  time  until   the   remote   machine   finishes   its   initialization.
       <b>pmReconnectContext</b>  will  abort and return an error if the connection has not been established after some
       specified interval has elapsed.  The default interval is 5 seconds.  This  may  be  modified  by  setting
       <b>PMCD_CONNECT_TIMEOUT</b>  in  the  environment  to a real number of seconds for the desired timeout.  This is
       most useful in cases where the remote host is at the end of a slow network, requiring longer latencies to
       establish the connection correctly.

</pre><h4><b>CAVEAT</b></h4><pre>
       Applications that use <b><a href="../man3/gethostbyname.3.html">gethostbyname</a></b>(3) should exercise  caution  because  the  static  fields  in  <u>struct</u>
       <u>hostent</u>   may  not  be  preserved  across  some  <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3)  calls.   In  particular,  <b><a href="../man3/pmNewContext.3.html">pmNewContext</a></b>(3)  and
       <b><a href="../man3/pmReconnectContext.3.html">pmReconnectContext</a></b>(3) both may call <b><a href="../man3/gethostbyname.3.html">gethostbyname</a></b>(3) internally.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       <b>PM_ERR_NOCONTEXT</b>

              <u>handle</u> does not identify a valid PMAPI context

       <b>-ETIMEDOUT</b>

              The re-try time has not elapsed, or the reconnection is attempted and fails.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       <b>PMCD_CONNECT_TIMEOUT</b>
              Timeout period (in seconds) for <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1) connection attempts.

       <b>PMCD_RECONNECT_TIMEOUT</b>
              Redefines the back-off intervals - refer to <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/pmcd.1.html">pmcd</a></b>(1),       <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3),       <b><a href="../man3/pmLoadDerivedConfig.3.html">pmLoadDerivedConfig</a></b>(3),       <b><a href="../man3/pmNewContext.3.html">pmNewContext</a></b>(3),       <b><a href="../man3/pmRegisterDerived.3.html">pmRegisterDerived</a></b>(3),
       <b><a href="../man3/pmRegisterDerivedMetric.3.html">pmRegisterDerivedMetric</a></b>(3) and <b><a href="../man3/pmUseContext.3.html">pmUseContext</a></b>(3).

Performance Co-Pilot                                   PCP                                 <u><a href="../man3/PMRECONNECTCONTEXT.3.html">PMRECONNECTCONTEXT</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>