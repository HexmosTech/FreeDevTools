<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nutscan_add_ip_range - Add an entry with IP address range (starting and ending addresses) to a</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnutscan-dev">libnutscan-dev_2.8.3-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nutscan_add_ip_range - Add an entry with IP address range (starting and ending addresses) to a
       `nutscan_ip_range_list_t` structure.

</pre><h4><b>SYNOPSIS</b></h4><pre>
               #include &lt;nut-scan.h&gt;

               /* One IP address range: */
               typedef struct nutscan_ip_range_s {
                       char * start_ip;
                       char * end_ip;
                       struct nutscan_ip_range_s * next;
               } nutscan_ip_range_t;

               /* List of IP address ranges and helper data: */
               typedef struct nutscan_ip_range_list_s {
                       nutscan_ip_range_t * ip_ranges;         /* Actual linked list of entries, first entry */
                       nutscan_ip_range_t * ip_ranges_last;    /* Pointer to end of list for quicker additions */
                       size_t ip_ranges_count;                 /* Counter of added entries */
               } nutscan_ip_range_list_t;

               size_t nutscan_add_ip_range(
                       nutscan_ip_range_list_t *irl,
                       char * start_ip,
                       char * end_ip);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>nutscan_add_ip_range()</b> function can create and add a nutscan_ip_range_t entry based on provided
       inputs to the specified nutscan_ip_range_list_t structure. The resulting amount of entries in the
       structure is returned, or 0 in case of non-fatal errors.

       This function skips work if:

       •   the structure pointer is NULL (<u>0</u> is returned);

       •   neither start_ip nor end_ip were provided, i.e. they both have NULL values (current list length from
           the structure is returned);

       •   failed to allocate the entry (fatal).

       If only one of start_ip or end_ip values was provided (not NULL), a single-address range is created with
       both addresses set to the same pointer value.

       The structure should be initialized before use by nutscan_init_ip_ranges().

       The caller must free the contents of the structure after completing its use by calling
       nutscan_free_ip_ranges() (after which the structure can be re-used for a new list), and explicitly free()
       the structure object itself if it was allocated dynamically (e.g. by calling
       nutscan_init_ip_ranges(NULL)).

</pre><h4><b>NOTES</b></h4><pre>
       Technically, the function is currently defined in <u>nutscan-ip.h</u> file.

       Currently there are no checks for duplicate or overlapping entries, so the same IP addresses and whole IP
       address ranges can be added to the list (and would eventually be scanned) many times.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/nutscan_init_ip_ranges.3.html">nutscan_init_ip_ranges</a></b>(3), <b><a href="../man3/nutscan_free_ip_ranges.3.html">nutscan_free_ip_ranges</a></b>(3), <b><a href="../man3/nutscan_stringify_ip_ranges.3.html">nutscan_stringify_ip_ranges</a></b>(3),
       <b><a href="../man3/nutscan_cidr_to_ip.3.html">nutscan_cidr_to_ip</a></b>(3), <b><a href="../man3/nutscan_ip_ranges_iter_init.3.html">nutscan_ip_ranges_iter_init</a></b>(3), <b><a href="../man3/nutscan_ip_ranges_iter_inc.3.html">nutscan_ip_ranges_iter_inc</a></b>(3)

Network UPS Tools 2.8.3                            07/08/2025                            <u><a href="../man3/NUTSCAN_ADD_IP_RANGE.3.html">NUTSCAN_ADD_IP_RANGE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>