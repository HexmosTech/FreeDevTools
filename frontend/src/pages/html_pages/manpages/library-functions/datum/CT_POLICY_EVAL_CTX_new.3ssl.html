<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CT_POLICY_EVAL_CTX_new_ex, CT_POLICY_EVAL_CTX_new, CT_POLICY_EVAL_CTX_free, CT_POLICY_EVAL_CTX_get0_cert,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CT_POLICY_EVAL_CTX_new_ex, CT_POLICY_EVAL_CTX_new, CT_POLICY_EVAL_CTX_free, CT_POLICY_EVAL_CTX_get0_cert,
       CT_POLICY_EVAL_CTX_set1_cert, CT_POLICY_EVAL_CTX_get0_issuer, CT_POLICY_EVAL_CTX_set1_issuer,
       CT_POLICY_EVAL_CTX_get0_log_store, CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE,
       CT_POLICY_EVAL_CTX_get_time, CT_POLICY_EVAL_CTX_set_time - Encapsulates the data required to evaluate
       whether SCTs meet a Certificate Transparency policy

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ct.h&gt;

        CT_POLICY_EVAL_CTX *CT_POLICY_EVAL_CTX_new_ex(OSSL_LIB_CTX *libctx,
                                                      const char *propq);
        CT_POLICY_EVAL_CTX *CT_POLICY_EVAL_CTX_new(void);
        void CT_POLICY_EVAL_CTX_free(CT_POLICY_EVAL_CTX *ctx);
        X509* CT_POLICY_EVAL_CTX_get0_cert(const CT_POLICY_EVAL_CTX *ctx);
        int CT_POLICY_EVAL_CTX_set1_cert(CT_POLICY_EVAL_CTX *ctx, X509 *cert);
        X509* CT_POLICY_EVAL_CTX_get0_issuer(const CT_POLICY_EVAL_CTX *ctx);
        int CT_POLICY_EVAL_CTX_set1_issuer(CT_POLICY_EVAL_CTX *ctx, X509 *issuer);
        const CTLOG_STORE *CT_POLICY_EVAL_CTX_get0_log_store(const CT_POLICY_EVAL_CTX *ctx);
        void CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE(CT_POLICY_EVAL_CTX *ctx,
                                                       CTLOG_STORE *log_store);
        uint64_t CT_POLICY_EVAL_CTX_get_time(const CT_POLICY_EVAL_CTX *ctx);
        void CT_POLICY_EVAL_CTX_set_time(CT_POLICY_EVAL_CTX *ctx, uint64_t time_in_ms);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A <b>CT_POLICY_EVAL_CTX</b> is used by functions that evaluate whether Signed Certificate Timestamps (SCTs)
       fulfil a Certificate Transparency (CT) policy.  This policy may be, for example, that at least one valid
       SCT is available. To determine this, an SCT's timestamp and signature must be verified.  This requires:

       • the public key of the log that issued the SCT

       • the certificate that the SCT was issued for

       • the issuer certificate (if the SCT was issued for a pre-certificate)

       • the current time

       The above requirements are met using the setters described below.

       <b>CT_POLICY_EVAL_CTX_new_ex()</b>  creates  an empty policy evaluation context and associates it with the given
       library context <u>libctx</u> and property query string <u>propq</u>.

       <b>CT_POLICY_EVAL_CTX_new()</b> does the same thing as  <b>CT_POLICY_EVAL_CTX_new_ex()</b>  except  that  it  uses  the
       default library context and property query string.

       The CT_POLICY_EVAL_CTX should then be populated using:

       • <b>CT_POLICY_EVAL_CTX_set1_cert()</b> to provide the certificate the SCTs were issued for

         Increments the reference count of the certificate.

       • <b>CT_POLICY_EVAL_CTX_set1_issuer()</b> to provide the issuer certificate

         Increments the reference count of the certificate.

       • <b>CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE()</b>  to  provide  a list of logs that are trusted as sources of
         SCTs

         Holds a pointer to the CTLOG_STORE, so the CTLOG_STORE must outlive the CT_POLICY_EVAL_CTX.

       • <b>CT_POLICY_EVAL_CTX_set_time()</b> to set the time SCTs should be compared with to  determine  if  they  are
         valid

         The  SCT  timestamp  will  be  compared to this time to check whether the SCT was issued in the future.
         RFC6962 states that "TLS clients MUST reject SCTs whose timestamp is in the future". By  default,  this
         will be set to 5 minutes in the future (e.g. (<b>time()</b> + 300) * 1000), to allow for clock drift.

         The time should be in milliseconds since the Unix Epoch.

       Each setter has a matching getter for accessing the current value.

       When  no  longer required, the <b>CT_POLICY_EVAL_CTX</b> should be passed to <b>CT_POLICY_EVAL_CTX_free()</b> to delete
       it. If the argument to <b>CT_POLICY_EVAL_CTX_free()</b> is NULL, nothing is done.

</pre><h4><b>NOTES</b></h4><pre>
       The issuer certificate only needs to be provided if at least one of  the  SCTs  was  issued  for  a  pre-
       certificate. This will be the case for SCTs embedded in a certificate (i.e. those in an X.509 extension),
       but may not be the case for SCTs found in the TLS SCT extension or OCSP response.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>CT_POLICY_EVAL_CTX_new_ex()</b> and <b>CT_POLICY_EVAL_CTX_new()</b> will return NULL if malloc fails.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ct.7.html">ct</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       CT_POLICY_EVAL_CTX_new_ex was added in OpenSSL 3.0. All other functions were added in OpenSSL 1.1.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2016-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                       <u><a href="../man3SSL/CT_POLICY_EVAL_CTX_NEW.3SSL.html">CT_POLICY_EVAL_CTX_NEW</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>