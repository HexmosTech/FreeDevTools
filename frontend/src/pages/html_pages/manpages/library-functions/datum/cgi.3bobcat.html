<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FBB::CGI - handles GET and POST submitted form data</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libbobcat-dev">libbobcat-dev_6.07.01-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       FBB::CGI - handles GET and POST submitted form data

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;bobcat/cgi&gt;</b>
       Linking option: <u>-lbobcat</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  class  <u>CGI</u> offers an interface to data submitted by web-forms. The data is sent to a script handling
       the data using a <u>&lt;form</u> <u>action="/path/to/form/script"&gt;</u> stanza. Very often this is indeed a script, like  a
       Perl  script,  but  there is no need to use a scripting language. The class <u>CGI</u> allows <b>C++</b> programmers to
       process the form by an executable usually  resulting  in  faster  processing  and  in  construction  time
       benefits  from  the  type safety offered by <b>C++</b>. The class <u>CGI</u> automatically handles data submitted using
       the <u>GET</u> method as well as data submitted using the <u>POST</u> method.

       By default the class’s constructor writes the customary <u>Content-type</u> header lines to the standard  output
       stream.  Additional  (html)  output  of a reply page must be provided by other code. Therefore, a program
       processing an uploaded form will have an organization comparable to the following basic setup:

           // assume includes and namespace std/FBB were defined
           int main()
           {
               CGI cgi;
               cout &lt;&lt; "&lt;html&gt;&lt;body&gt;\n";
               if (parametersOK(cgi))
               {
                   process(cgi);
                   generateReplyPage();
               }
               else
                   generateErrorPage();
               cout &lt;&lt; "&lt;/body&gt;&lt;/html&gt;\n;
           }

       When errors in the received form-data are detected an error message is written  to  the  standard  output
       stream and an <u>FBB::Exception</u> exception is thrown.

</pre><h4><b>NAMESPACE</b></h4><pre>
       <b>FBB</b>
       All  constructors,  members,  operators  and manipulators, mentioned in this man-page, are defined in the
       namespace <b>FBB</b>.

</pre><h4><b>INHERITS</b> <b>FROM</b></h4><pre>
       -

</pre><h4><b>TYPEDEF</b></h4><pre>
       o      <b>CGI::MapStringVector</b>:
              A shorthand for <u>std::unordered_map&lt;std::string,</u> <u>std::vector&lt;std::string&gt;</u> <u>&gt;</u>, which is the data type
              in which form-variables are stored.

</pre><h4><b>ENUMERATIONS</b></h4><pre>
       The <u>CGI::Method</u> enumeration specifies values indicating the way the form’s data were submitted:

       o      <b>CGI::UNDETERMINED</b>:
              Used internally indicating that the form’s method was neither <u>GET</u> nor <u>POST</u>.

       o      <b>CGI::GET</b>:
              Indicates that the <u>GET</u> method was used when submitting the form’s data;

       o      <b>CGI::POST</b>:
              Indicates that the <u>POST</u> method was used when submitting the form’s data.

       The <u>CGI::Create</u> enumeration is used to request or suppress creation of the directory to contain any  file
       uploaded by a form:

       o      <b>CGI::DONT_CREATE_PATH</b>:
              When uploading files, the destination directory must exist;

       o      <b>CGI::CREATE_PATH</b>:
              When uploading files, the destination directory will be created.

</pre><h4><b>CONSTRUCTORS</b></h4><pre>
       o      <b>CGI(bool</b> <b>defaultEscape</b> <b>=</b> <b>true,</b> <b>char</b> <b>const</b> <b>*header</b> <b>=</b> <b>"Content-type:</b> <b>text/html",</b> <b>std::ostream</b> <b>&amp;out</b> <b>=</b>
              <b>std::cout)</b>:
              The  default constructor writes the standard content type header to the standard output stream and
              will use <u>std::cout</u> for output. Specifying <u>0</u> as header suppresses outputting the <u>Content-type</u> line.
              Otherwise the content type line is also followed by two <u>\r\n</u> character  combinations.  By  default
              all  characters  in  retrieved form-variables are escaped. The overloaded insertion operators (see
              below) can be used to modify the default set of characters to escape. The backslash is used as the
              escape character. The escape-prefix is not used if the <u>defaultEscape</u> value is specified  as  <u>false</u>
              and if no insertions into the <b>CGI</b> object were performed.

       Copy and move constructors (and assignment operators) are available.

</pre><h4><b>OERLOADED</b> <b>OPERATORS</b></h4><pre>
       <b>Note:</b>  the  following  three insertion operators, defining sets of characters that should be escaped, can
       only be used before calling any of the <u>param,</u> <u>begin</u> or <u>end</u> members. As soon as one of these latter  three
       members  has  been called the set of characters to be escaped is fixed and attempts to modify that set is
       silently ignored.

       o      <b>char</b> <b>const</b> <b>*operator[](std::string</b> <b>const</b> <b>&amp;key)</b> <b>const</b>:
              The index operator returns the value of the environment variable specified  as  the  index.  0  is
              returned if the variable specified at <u>key</u> is not defined.

       o      <b>CGI</b> <b>&amp;operator&lt;&lt;(std::string</b> <b>const</b> <b>&amp;accept)</b>:
              This member’s actions are suppressed once <u>param,</u> <u>begin</u> or <u>end</u> (see below) has been called.

              The  insertion operator can be used to fine-tune the set of characters that are escaped in strings
              returned by <u>param</u> (see below). Depending on the value of the constructor’s <u>defaultEscape</u> parameter
              characters inserted into the <u>CGI</u> object will or will not be escaped by a backslash.

              If the constructor’s <u>defaultEscape</u> parameter was specified as <u>true</u> then the insertion operator can
              be used to define a set of characters that are <u>not</u> escaped.

              If <u>defaultEscape</u> was specified as  <u>false</u>  then  the  insertion  operator  will  define  a  set  of
              characters that <u>will</u> be escaped.

              The backlash itself is always escaped and a request to use it unescaped is silently ignored.

              The  <u>accept</u>  string  can  be  specified  as  a regular expression character set, without the usual
              surrounding square brackets. E.g., an insertion like <u>cgi</u> <u>&lt;&lt;</u> <u>"-a-z0-9"</u> defines the  set  consisting
              of the dash, the lower case letters and the digits.

              Individual  characters,  character  ranges  (using  the  dash to specify a range) and all standard
              character classes (<u>[:alnum:],</u> <u>[:alpha:],</u> <u>[:cntrl:],</u> <u>[:digit:],</u>  <u>[:graph:],</u>  <u>[:lower:],</u>  <u>[:print:],</u>
              <u>[:punct:],</u>  <u>[:space:],</u>  <u>[:upper:]</u>,  and <u>[:xdigit:]</u>) can be used to specify a set of characters. In
              addition to these standard character classes the class <u>[:cgi:]</u> can  be  used  to  define  the  set
              consisting of the characters <u>"</u> <u>’</u> <u>`</u> <u>;</u> and <u>\</u>.

              Note that standard and <u>[:cgi:]</u> character classes <u>do</u> require square brackets.

              When  a  series of insertions are performed then the union of the sets defined by these insertions
              are used.

              <b>Note</b>: using unescaped single quotes, the double quotes,  backtick  characters  and  semicolons  in
              CGI-programs might be risky and is not advised.

       o      <b>CGI</b> <b>&amp;operator&lt;&lt;(int</b> <b>c)</b>:
              This member’s actions are suppressed once <u>param,</u> <u>begin</u> or <u>end</u> (see below) has been called.

              This insertion operator is used to change the default escape handling of a single character <u>c</u>. The
              <u>int</u> parameter is cast internally to a <u>char</u>.

       o      <b>CGI</b> <b>&amp;operator&lt;&lt;(std::pair&lt;char,</b> <b>char&gt;</b> <b>range)</b>:
              This member’s actions are suppressed once <u>param,</u> <u>begin</u> or <u>end</u> (see below) has been called.

              This  insertion  operator  can  be  used  to  change  the  default  escape  handling of a range of
              characters. The pair’s second character must be equal to or exceed  the  position  of  the  pair’s
              first character in the ASCII collating sequence or the member will have no effect.

       o      <b>std::ostream</b> <b>&amp;std::operator&lt;&lt;(std::ostream</b> <b>&amp;out,</b> <b>CGI</b> <b>const</b> <b>&amp;cgi)</b>:
              <u>CGI</u>  objects  can  be inserted into <u>ostreams</u> to display the characters that will appear escaped in
              strings returned by the <u>param()</u> member function. Each character for which <u>isprint()</u>  returns  <u>true</u>
              will  be displayed as character, surrounded by single quotes. For all other characters their ASCII
              values are displayed.  Each character is displayed on a line by itself.

</pre><h4><b>MEMBER</b> <b>FUNCTIONS</b></h4><pre>
       o      <b>CGI::MapStringVector::const_iterator</b> <b>begin()</b>:
              Returns the begin iterator of the form’s parameter map. Iterator values unequal to <u>end</u> (see below)
              point to a pair of values, the first of which is the name of a field  defined  by  the  form,  the
              second  is  a  vector  of strings containing the field’s value(s). See also the description of the
              <u>param</u> member below.

       o      <b>CGI::MapStringVector::const_iterator</b> <b>end()</b>:
              Returns the end iterator of the form’s parameter map.

       o      <b>unsigned</b> <b>long</b> <b>long</b> <b>maxUploadSize()</b> <b>const</b>:
              Returns the current maximum file upload size in bytes.

       o      <b>CGI::Method</b> <b>method()</b> <b>const</b>:
              Returns the method that was used when the form was submitted (either <u>CGI::GET</u> or <u>CGI::POST</u>).

       o      <b>std::vector&lt;std::string&gt;</b> <b>const</b> <b>&amp;param(std::string</b> <b>const</b> <b>&amp;variable)</b>:
              Returns the value of the form-variable specified by the function’s argument. An  empty  vector  is
              returned if the variable was not provided by the form’s data.

              If  the  same  variable  was  specified multiple times or if its value extends over multiple lines
              (only with <u>multipart/form-data</u>) then the vector contains multiple strings.

              With <u>GET</u> and <u>POST</u> methods not using <u>multipart/form-data</u> input fields extending over multiple lines
              are stored in one string, using <u>\r\n</u> combinations between those lines.

              When files are uploaded the vectors contain sets of four strings. The first  string  provides  the
              path  nme  of  the  uploaded  file; the second string provides the file name specified in the form
              itself (so it is the name of the file at the remote location); the third string shows the  content
              type  specified by the remote browser (e.g., <u>application/octet-stream</u>), the fourth string contains
              <u>OK</u> if the file was successfully uploaded and <u>truncated</u> if the file was truncated.  Existing  files
              will not be overwritten. When uploading a file a usable filename must be found within 100 trials.

       o      <b>std::string</b> <b>param1(std::string</b> <b>const</b> <b>&amp;variable)</b> <b>const</b>:
              Returns the first element of the <u>vector&lt;string&gt;</u> returned by the <u>param</u> member or an empty string if
              <u>variable</u> was not defined by the received form.

       o      <b>std::string</b> <b>const</b> <b>&amp;query()</b> <b>const</b>:
              Returns  the query-string submitted with <u>CGI::GET</u> or <u>CGI::POST</u> forms (if the <u>POST</u>ed form specified
              <u>ENCTYPE="multipart/form-data"</u> the query string is empty).

       o      <b>report()</b>:
              The <u>report</u> member silently returns if no  errors  were  encountered  while  processing  form-data.
              Otherwise,  the  <u>html</u>  file  generated  by the <u>CGI</u> program displays a line starting with <u>FBB::CGI</u>,
              followed by the status report.

              The following status report messages are presently defined:

              <u>Content-Disposition</u>  <u>not</u>  <u>recognized</u>  <u>in:</u>,   which   is   followed   by   the   line   where   the
              <u>Content-Disposition</u> was expected. This may occur when processing <u>multipart/form</u> data.

              <u>Invalid</u>  <u>multipart/form-data</u>.  This  message can be generated when readling lines while processing
              <u>multipart/form</u> data.

              <u>GET/POST</u> <u>REQUEST_METHOD</u> <u>not</u> <u>found</u>. This message is shown if the program couldn’t find  the  form’s
              <u>REQUEST_METHOD</u> type (i.e., <u>GET</u> or <u>POST</u>).

              <u>Invalid</u>  <u>CONTENT_LENGHT</u>  <u>in</u> <u>POSTed</u> <u>form</u>. This message is shown if the content-length header has an
              incorrect value.

              <u>Content-Type</u> <u>not</u> <u>found</u> <u>for</u> <u>file-field</u>, followed by the file’s field name. This message is shown if
              no <u>Content-Type</u> specification was found in an uploaded form.

              <u>Can’t</u> <u>open</u> <u>a</u> <u>file</u> <u>to</u> <u>write</u> <u>an</u> <u>uploaded</u> <u>file</u>. This message  indicates  that  the  CGI  program  was
              unable  to  open  a  file  to write an uploaded file to. This can be caused by an overfull disk or
              partition or by incorrect write-permissions.

              <u>multipart/form-data:</u> <u>no</u> <u>end-boundary</u> <u>found</u>. This message is shown if the end-boundary was  missing
              in a <u>multipart/form-data</u> form.

       o      <b>void</b>  <b>setFileDestination(std::string</b>  <b>const</b> <b>&amp;path,</b> <b>std::string</b> <b>const</b> <b>&amp;prefix</b> <b>=</b> <b>"",</b> <b>Create</b> <b>create</b> <b>=</b>
              <b>CREATE_PATH)</b>:
              This member is used to specify the path and prefix of  uploaded  files.  Uploaded  files  will  be
              stored at <u>path/prefixNr</u> where <u>Nr</u> is an internally used number starting at one. When <u>CREATE_PATH</u> is
              specified  <u>path</u>  must  be  available  or  the  <b>CGI</b>  object  must  be  able  to create the path. If
              <u>DONT_CREATE_PATH</u> is specified the specified path must be  available.  If  not,  an  <u>FBB::Exception</u>
              exception will be thrown.

       o      <b>void</b> <b>setMaxUploadSize(size_t</b> <b>maxSize,</b> <b>int</b> <b>unit</b> <b>=</b> <b>’M’)</b>:
              This  member can be used to change the maximum size of uploaded files. Its default value is 100Mb.
              The <u>unit</u> can  be  one  of  <u>b</u>  (bytes,  the  default),  <u>K</u>  (Kbytes),  <u>M</u>  (Mbytes)  or  <u>G</u>  (Gbytes).
              Unit-specifiers  are  interpreted case insensitively. File uploads will continue until the maximum
              upload size is exceeded, followed by discarding any remainder.

       o      <b>void</b> <b>swap(CGI</b> <b>&amp;other)</b>:
              The current and <u>other</u> object are swapped.  The first time one of the  <u>param(),</u>  <u>begin()</u>  or  <u>end()</u>
              members  is  called these members may detect errors in the the received form data. If so, an error
              message is written to the standard output stream and an <u>FBB::Exception</u> exception will be thrown.

</pre><h4><b>STATIC</b> <b>MEMBERS</b></h4><pre>
       o      <b>std::string</b> <b>dos2unix(std::string</b> <b>const</b> <b>&amp;text)</b>:
              This member converts all <u>\r\n</u> character combinations in <u>text</u> into plain <u>\n</u>  characters,  returning
              the converted text.

       o      <b>std::string</b> <b>unPercent(std::string</b> <b>const</b> <b>&amp;text)</b>:
              This  member  converts  all  <u>%xx</u> encoded characters into their corresponding ASCII values. Also, <u>+</u>
              characters are converted to single blank spaces. The converted string is returned.

</pre><h4><b>EXAMPLE</b></h4><pre>
       #include "main.ih"

       void showParam(CGI::MapStringVector::value_type const &amp;mapValue)
       {
           cout &lt;&lt; "Param: " &lt;&lt; mapValue.first &lt;&lt; ’\n’;

           for (auto &amp;str: mapValue.second)
               cout &lt;&lt; "    " &lt;&lt; CGI::dos2unix(str) &lt;&lt; "\n"
                   "    ";

           cout &lt;&lt; ’\n’;
       }

       int main(int argc, char **argv)
       try
       {
           Arg &amp;arg = Arg::initialize("evhm:", argc, argv);

           // usage and version are in the source archive in .../cgi/driver
           // arg.versionHelp(usage, version, 2);

           ifstream in(arg[0]);
           string line;
           while (getline(in, line))
           {
               size_t pos = line.find(’=’);

               if (pos == string::npos)
                   continue;
                                   // set environment vars simulating
                                   // a GET form
               if (setenv(line.substr(0, pos).c_str(),
                      line.substr(pos + 1).c_str(), true) == 0)
               {
                   if (arg.option(’e’))
                       cout &lt;&lt; line.substr(0, pos).c_str() &lt;&lt; ’=’ &lt;&lt;
                              line.substr(pos + 1).c_str() &lt;&lt; ’\n’;
               }
               else
                   cout &lt;&lt; "FAILED: setenv " &lt;&lt; line &lt;&lt; ’\n’;
           }

           CGI cgi(false);             // chars are not escaped

           cgi &lt;&lt; arg[1];

           if (arg.option(&amp;line, ’m’))
               cgi.setMaxUploadSize(stoul(line), *line.rbegin());

           cout &lt;&lt; "Max upload size (b): " &lt;&lt; cgi.maxUploadSize() &lt;&lt; ’\n’;

           CGI::Method method = cgi.method();

           cout &lt;&lt; "To escape:\n" &lt;&lt;
                   cgi &lt;&lt; "\n"
                   "Method: " &lt;&lt; (method == CGI::GET ? "GET" : "POST") &lt;&lt;
                   ’\n’;

           cout &lt;&lt; "Query string: " &lt;&lt; cgi.query() &lt;&lt; ’\n’;

           cout &lt;&lt; "Submit string: `" &lt;&lt; cgi.param1("submit") &lt;&lt; "’\n";

           for (auto &amp;mapElement: cgi)
               <a href="../manmapElement/showParam.mapElement.html">showParam</a>(mapElement);

           cout &lt;&lt; "END OF PROGRAM\n";
       }
       catch (exception const &amp;err)
       {
           cout &lt;&lt; err.what() &lt;&lt; ’\n’;
           return 1;
       }
       catch (...)
       {
           return 1;
       }

       To test the program’s <u>get</u> form processing, call it as <u>driver</u> <u>get</u> <u>’[:cgi:]’</u>, with the file <u>get</u> containing:
       INFO=This is an abbreviated set of environment variables
       SERVER_ADMIN=<a href="mailto:f.b.brokken@rug.nl">f.b.brokken@rug.nl</a>
       GATEWAY_INTERFACE=CGI/1.1
       SERVER_PROTOCOL=HTTP/1.1
       REQUEST_METHOD=GET
       QUERY_STRING=hidden=hidval&amp;submit=Submit+%20Query

       To test the program’s <u>post</u> form processing, call it as <u>driver</u> <u>post1</u> <u>’[:cgi:]’</u>, using <u>post1</u> and  <u>post1.cin</u>
       found in Bobcat’s source archive under <u>../cgi/driver</u>.

</pre><h4><b>FILES</b></h4><pre>
       <u>bobcat/cgi</u> - defines the class interface

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/bobcat.7.html">bobcat</a></b>(7)

</pre><h4><b>BUGS</b></h4><pre>
       None Reported.

</pre><h4><b>BOBCAT</b> <b>PROJECT</b> <b>FILES</b></h4><pre>
       o      <u>https://fbb-git.gitlab.io/bobcat/</u>: gitlab project page;

       Debian Bobcat project files:

       o      <u>libbobcat6</u>: debian package containing the shared library, changelog and copyright note;

       o      <u>libbobcat-dev</u>:  debian package containing the static library, headers, manual pages, and developer
              info;

</pre><h4><b>BOBCAT</b></h4><pre>
       Bobcat is an acronym of `Brokken’s Own Base Classes And Templates’.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       This is free software, distributed under the terms of the GNU General Public License (GPL).

</pre><h4><b>AUTHOR</b></h4><pre>
       Frank B. Brokken (<b><a href="mailto:f.b.brokken@rug.nl">f.b.brokken@rug.nl</a></b>).

libbobcat-dev_6.07.01                               2005-2025                                  <u>FBB::<a href="../man3bobcat/CGI.3bobcat.html">CGI</a></u>(3bobcat)
</pre>
 </div>
</div></section>
</div>
</body>
</html>