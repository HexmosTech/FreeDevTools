<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FromNameSpoof - perform various tests to detect spoof attempts using the From header name section</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/spamassassin">spamassassin_4.0.1-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       FromNameSpoof - perform various tests to detect spoof attempts using the From header name section

</pre><h4><b>SYNOPSIS</b></h4><pre>
       loadplugin    Mail::SpamAssassin::Plugin::FromNameSpoof

        # From:name and From:addr do not match, matching depends on C&lt;fns_check&gt; setting
        header  __PLUGIN_FROMNAME_SPOOF  eval:check_fromname_spoof()

        # From:name and From:addr do not match (same as above rule and C&lt;fns_check 0&gt;)
        header  __PLUGIN_FROMNAME_DIFFERENT  eval:check_fromname_different()

        # From:name and From:addr domains differ
        header  __PLUGIN_FROMNAME_DOMAIN_DIFFER  eval:check_fromname_domain_differ()

        # From:name looks like it contains an email address (not same as From:addr)
        header  __PLUGIN_FROMNAME_EMAIL  eval:check_fromname_contains_email()

        # From:name matches any To:addr
        header  __PLUGIN_FROMNAME_EQUALS_TO  eval:check_fromname_equals_to()

        # From:name and From:addr owners differ
        header  __PLUGIN_FROMNAME_OWNERS_DIFFER  eval:check_fromname_owners_differ()

        # From:name matches Reply-To:addr
        header  __PLUGIN_FROMNAME_EQUALS_REPLYTO  eval:check_fromname_equals_replyto()

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Perform various tests against From:name header to detect spoofing. Steps in place to ensure minimal FPs.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       The plugin allows you to skip emails that have been DKIM signed by specific senders:

         fns_ignore_dkim googlegroups.com

       FromNameSpoof allows for a configurable closeness when matching the From:addr and From:name, the
       closeness can be adjusted with:

         fns_extrachars 50

       <b>Note</b> that FromNameSpoof detects the "owner" of a domain by the following search:

         &lt;owner&gt;.&lt;tld&gt;

       By default FromNameSpoof will ignore the TLD when comparing addresses:

         fns_check 1

       Check levels:

         0 - Strict checking of From:name != From:addr
         1 - Allow for different TLDs
         2 - Allow for different aliases but same domain

       "Owner" info can also be mapped as aliases with "fns_add_addrlist".  For example, to consider
       "googlemail.com" as "gmail":

         fns_add_addrlist (gmail) *@googlemail.com

</pre><h4><b>TAGS</b></h4><pre>
       The following tags are added to the set if a spoof is detected. They are available for use in reports,
       header fields, other plugins, etc.:

         _FNSFNAMEADDR_
           Detected spoof address from From:name header

         _FNSFNAMEDOMAIN_
           Detected spoof domain from From:name header

         _FNSFNAMEOWNER_
           Detected spoof owner from From:name header

         _FNSFADDRADDR_
           Actual From:addr address

         _FNSFADDRDOMAIN_
           Actual From:addr domain

         _FNSFADDROWNER_
           Actual From:addr owner

</pre><h4><b>EXAMPLE</b></h4><pre>
         header  __PLUGIN_FROMNAME_SPOOF  eval:check_fromname_spoof()
         header  __PLUGIN_FROMNAME_EQUALS_TO  eval:check_fromname_equals_to()
         meta     FROMNAME_SPOOF_EQUALS_TO (__PLUGIN_FROMNAME_SPOOF &amp;&amp; __PLUGIN_FROMNAME_EQUALS_TO)
         describe FROMNAME_SPOOF_EQUALS_TO From:name is spoof to look like To: address
         score    FROMNAME_SPOOF_EQUALS_TO 1.2

perl v5.40.1                                       2025-06-26              <u>Mail::SpamAssa...::<a href="../man3pm/FromNameSpoof.3pm.html">FromNameSpoof</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>