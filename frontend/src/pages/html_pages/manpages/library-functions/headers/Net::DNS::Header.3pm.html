<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::DNS::Header - DNS packet header</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-dns-perl">libnet-dns-perl_1.50-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::DNS::Header - DNS packet header

</pre><h4><b>SYNOPSIS</b></h4><pre>
               use Net::DNS;

               $packet = Net::DNS::Packet-&gt;new();
               $header = $packet-&gt;header;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       "Net::DNS::Header" represents the header portion of a DNS packet.

</pre><h4><b>METHODS</b></h4><pre>
   <b>$packet-&gt;header</b>
               $packet = Net::DNS::Packet-&gt;new();
               $header = $packet-&gt;header;

       Net::DNS::Header objects emanate from the Net::DNS::Packet <b>header()</b> method, and contain an opaque
       reference to the parent Packet object.

       Header objects may be assigned to suitably scoped lexical variables.  They should never be stored in
       global variables or persistent data structures.

   <b>string</b>
               print $packet-&gt;header-&gt;string;

       Returns a string representation of the packet header.

   <b>print</b>
               $packet-&gt;header-&gt;print;

       Prints the string representation of the packet header.

   <b>id</b>
               print "query id = ", $packet-&gt;header-&gt;id, "\n";
               $packet-&gt;header-&gt;<a href="../man1234/id.1234.html">id</a>(1234);

       Gets or sets the query identification number.

   <b>opcode</b>
               print "query opcode = ", $packet-&gt;header-&gt;opcode, "\n";
               $packet-&gt;header-&gt;opcode("UPDATE");

       Gets or sets the query opcode (the purpose of the query).

   <b>rcode</b>
               print "query response code = ", $packet-&gt;header-&gt;rcode, "\n";
               $packet-&gt;header-&gt;rcode("SERVFAIL");

       Gets or sets the query response code (the status of the query).

   <b>qr</b>
               print "query response flag = ", $packet-&gt;header-&gt;qr, "\n";
               $packet-&gt;header-&gt;<a href="../man0/qr.0.html">qr</a>(0);

       Gets or sets the query response flag.

   <b>aa</b>
               print "response is ", $packet-&gt;header-&gt;aa ? "" : "non-", "authoritative\n";
               $packet-&gt;header-&gt;<a href="../man0/aa.0.html">aa</a>(0);

       Gets or sets the authoritative answer flag.

   <b>tc</b>
               print "packet is ", $packet-&gt;header-&gt;tc ? "" : "not ", "truncated\n";
               $packet-&gt;header-&gt;<a href="../man0/tc.0.html">tc</a>(0);

       Gets or sets the truncated packet flag.

   <b>rd</b>
               print "recursion was ", $packet-&gt;header-&gt;rd ? "" : "not ", "desired\n";
               $packet-&gt;header-&gt;<a href="../man0/rd.0.html">rd</a>(0);

       Gets or sets the recursion desired flag.

   <b>ra</b>
               print "recursion is ", $packet-&gt;header-&gt;ra ? "" : "not ", "available\n";
               $packet-&gt;header-&gt;<a href="../man0/ra.0.html">ra</a>(0);

       Gets or sets the recursion available flag.

   <b>z</b>
       Unassigned bit, should always be zero.

   <b>ad</b>
               print "The response has ", $packet-&gt;header-&gt;ad ? "" : "not", "been verified\n";

       Relevant in DNSSEC context.

       (The AD bit is only set on a response where signatures have been cryptographically verified or the server
       is authoritative for the data and is allowed to set the bit by policy.)

   <b>cd</b>
               print "checking was ", $packet-&gt;header-&gt;cd ? "not" : "", "desired\n";
               $packet-&gt;header-&gt;<a href="../man0/cd.0.html">cd</a>(0);

       Gets or sets the checking disabled flag.

   <b>qdcount,</b> <b>zocount</b>
               print "# of question records: ", $packet-&gt;header-&gt;qdcount, "\n";

       Returns the number of records in the question section of the packet.  In dynamic update packets, this
       field is known as "zocount" and refers to the number of RRs in the zone section.

   <b>ancount,</b> <b>prcount</b>
               print "# of answer records: ", $packet-&gt;header-&gt;ancount, "\n";

       Returns the number of records in the answer section of the packet which may, in the case of corrupt
       packets, differ from the actual number of records.  In dynamic update packets, this field is known as
       "prcount" and refers to the number of RRs in the prerequisite section.

   <b>nscount,</b> <b>upcount</b>
               print "# of authority records: ", $packet-&gt;header-&gt;nscount, "\n";

       Returns the number of records in the authority section of the packet which may, in the case of corrupt
       packets, differ from the actual number of records.  In dynamic update packets, this field is known as
       "upcount" and refers to the number of RRs in the update section.

   <b>arcount,</b> <b>adcount</b>
               print "# of additional records: ", $packet-&gt;header-&gt;arcount, "\n";

       Returns the number of records in the additional section of the packet which may, in the case of corrupt
       packets, differ from the actual number of records.  In dynamic update packets, this field is known as
       "adcount".

</pre><h4><b>EDNS</b> <b>Protocol</b> <b>Extensions</b></h4><pre>
   <b>do,</b> <b>co</b>
               print "DNSSEC_OK flag was ", $packet-&gt;header-&gt;do ? "not" : "", "set\n";
               $packet-&gt;header-&gt;<a href="../man1/do.1.html">do</a>(1);

       Gets or sets the named EDNS flag.

   <b>Extended</b> <b>rcode</b>
       EDNS extended rcodes are handled transparently by $packet-&gt;header-&gt;<b>rcode()</b>.

   <b>UDP</b> <b>packet</b> <b>size</b>
               $udp_max = $packet-&gt;edns-&gt;UDPsize;

       EDNS offers a mechanism to advertise the maximum UDP packet size which can be assembled by the local
       network stack.

   <b>edns</b>
               $header  = $packet-&gt;header;
               $version = $header-&gt;edns-&gt;version;
               @options = $header-&gt;edns-&gt;options;
               $option  = $header-&gt;edns-&gt;option(n);
               $udp_max = $packet-&gt;edns-&gt;UDPsize;

       Auxiliary function which provides access to the EDNS protocol extension OPT RR.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c)1997 Michael Fuhr.

       Portions Copyright (c)2002,2003 Chris Reinhardt.

       Portions Copyright (c)2012,2022 Dick Franks.

       All rights reserved.

</pre><h4><b>LICENSE</b></h4><pre>
       Permission to use, copy, modify, and distribute this software and its documentation for any purpose and
       without fee is hereby granted, provided that the original copyright notices appear in all copies and that
       both copyright notice and this permission notice appear in supporting documentation, and that the name of
       the author not be used in advertising or publicity pertaining to distribution of the software without
       specific prior written permission.

       THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT
       LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO
       EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
       IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR
       THE USE OR OTHER DEALINGS IN THE SOFTWARE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       perl Net::DNS Net::DNS::Packet Net::DNS::RR::OPT RFC1035(4.1.1)
       &lt;https://iana.org/go/rfc1035#section-4.1.1&gt;

perl v5.40.1                                       2025-03-05                              <u>Net::DNS::<a href="../man3pm/Header.3pm.html">Header</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>