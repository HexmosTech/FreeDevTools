<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_set_record_padding_callback, SSL_set_record_padding_callback,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_set_record_padding_callback, SSL_set_record_padding_callback,
       SSL_CTX_set_record_padding_callback_arg, SSL_set_record_padding_callback_arg,
       SSL_CTX_get_record_padding_callback_arg, SSL_get_record_padding_callback_arg, SSL_CTX_set_block_padding,
       SSL_CTX_set_block_padding_ex, SSL_set_block_padding, SSL_set_block_padding_ex - install callback to
       specify TLS 1.3 record padding

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        void SSL_CTX_set_record_padding_callback(SSL_CTX *ctx, size_t (*cb)(SSL *s, int type, size_t len, void *arg));
        int SSL_set_record_padding_callback(SSL *ssl, size_t (*cb)(SSL *s, int type, size_t len, void *arg));

        void SSL_CTX_set_record_padding_callback_arg(SSL_CTX *ctx, void *arg);
        void *SSL_CTX_get_record_padding_callback_arg(const SSL_CTX *ctx);

        void SSL_set_record_padding_callback_arg(SSL *ssl, void *arg);
        void *SSL_get_record_padding_callback_arg(const SSL *ssl);

        int SSL_CTX_set_block_padding(SSL_CTX *ctx, size_t block_size);
        int SSL_set_block_padding(SSL *ssl, size_t block_size);
        int SSL_CTX_set_block_padding_ex(SSL_CTX *ctx, size_t app_block_size, size_t hs_block_size);
        int SSL_set_block_padding_ex(SSL *ssl, size_t app_block_size, size_t hs_block_size);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_CTX_set_record_padding_callback()</b> or <b>SSL_set_record_padding_callback()</b> can be used to assign a
       callback function <u>cb</u> to specify the padding for TLS 1.3 records. The value set in <b>ctx</b> is copied to a new
       SSL by <b>SSL_new()</b>.  Kernel TLS is not possible if the record padding callback is set, and the callback
       function cannot be set if Kernel TLS is already configured for the current SSL object.

       <b>SSL_CTX_set_record_padding_callback_arg()</b> and <b>SSL_set_record_padding_callback_arg()</b> assign a value <b>arg</b>
       that is passed to the callback when it is invoked. The value set in <b>ctx</b> is copied to a new SSL by
       <b>SSL_new()</b>.

       <b>SSL_CTX_get_record_padding_callback_arg()</b> and <b>SSL_get_record_padding_callback_arg()</b> retrieve the <b>arg</b>
       value that is passed to the callback.

       <b>SSL_CTX_set_block_padding()</b> and <b>SSL_set_block_padding()</b> pads the record to a multiple of the <b>block_size</b>.
       A <b>block_size</b> of 0 or 1 disables block padding. The limit of <b>block_size</b> is SSL3_RT_MAX_PLAIN_LENGTH.

       <b>SSL_CTX_set_block_padding_ex()</b> and <b>SSL_set_block_padding_ex()</b> do similarly but allow the caller to
       separately specify the padding block size to be applied to handshake and application data messages.

       The callback is invoked for every record before encryption.  The <b>type</b> parameter is the TLS record type
       that is being processed; may be one of SSL3_RT_APPLICATION_DATA, SSL3_RT_HANDSHAKE, or SSL3_RT_ALERT.
       The <b>len</b> parameter is the current plaintext length of the record before encryption.  The <b>arg</b> parameter is
       the value set via <b>SSL_CTX_set_record_padding_callback_arg()</b> or <b>SSL_set_record_padding_callback_arg()</b>.

       These functions cannot be used with QUIC SSL objects.  <b>SSL_set_record_padding_callback()</b> and
       <b>SSL_set_block_padding()</b> fail if called on a QUIC SSL object.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The <b>SSL_CTX_get_record_padding_callback_arg()</b> and <b>SSL_get_record_padding_callback_arg()</b> functions return
       the <b>arg</b> value assigned in the corresponding set functions.

       The <b>SSL_CTX_set_block_padding()</b> and <b>SSL_set_block_padding()</b> functions return 1 on success or 0 if
       <b>block_size</b> is too large.

       The <b>cb</b> returns the number of padding bytes to add to the record. A return of 0 indicates no padding will
       be added. A return value that causes the record to exceed the maximum record size
       (SSL3_RT_MAX_PLAIN_LENGTH) will pad out to the maximum record size.

       The <b>SSL_CTX_get_record_padding_callback_arg()</b> function returns 1 on success or 0 if the callback function
       is not set because Kernel TLS is configured for the SSL object.

</pre><h4><b>NOTES</b></h4><pre>
       The default behavior is to add no padding to the record.

       A user-supplied padding callback function will override the behavior set by <b>SSL_set_block_padding()</b> or
       <b>SSL_CTX_set_block_padding()</b>. Setting the user-supplied callback to NULL will restore the configured block
       padding behavior.

       These functions only apply to TLS 1.3 records being written.

       Padding bytes are not added in constant-time.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_new.3.html">SSL_new</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The record padding API was added for TLS 1.3 support in OpenSSL 1.1.1.

       The return type of <b>SSL_CTX_set_record_padding_callback()</b> function was changed to int in OpenSSL 3.0.

       The functions <b>SSL_set_block_padding_ex()</b> and <b>SSL_CTX_set_block_padding_ex()</b> were added in OpenSSL 3.4.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2017-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04          <u><a href="../man3SSL/SSL_CTX_SET_RECORD_PADDING_CALLBACK.3SSL.html">SSL_CTX_SET_RECORD_PADDING_CALLBACK</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>