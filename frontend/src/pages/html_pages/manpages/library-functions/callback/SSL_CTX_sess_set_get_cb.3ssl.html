<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_sess_set_new_cb, SSL_CTX_sess_set_remove_cb, SSL_CTX_sess_set_get_cb, SSL_CTX_sess_get_new_cb,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_sess_set_new_cb, SSL_CTX_sess_set_remove_cb, SSL_CTX_sess_set_get_cb, SSL_CTX_sess_get_new_cb,
       SSL_CTX_sess_get_remove_cb, SSL_CTX_sess_get_get_cb - provide callback functions for server side external
       session caching

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        void SSL_CTX_sess_set_new_cb(SSL_CTX *ctx,
                                     int (*new_session_cb)(SSL *, SSL_SESSION *));
        void SSL_CTX_sess_set_remove_cb(SSL_CTX *ctx,
                                        void (*remove_session_cb)(SSL_CTX *ctx,
                                                                  SSL_SESSION *));
        void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
                                     SSL_SESSION (*get_session_cb)(SSL *,
                                                                   const unsigned char *,
                                                                   int, int *));

        int (*SSL_CTX_sess_get_new_cb(SSL_CTX *ctx))(struct ssl_st *ssl,
                                                     SSL_SESSION *sess);
        void (*SSL_CTX_sess_get_remove_cb(SSL_CTX *ctx))(struct ssl_ctx_st *ctx,
                                                         SSL_SESSION *sess);
        SSL_SESSION *(*SSL_CTX_sess_get_get_cb(SSL_CTX *ctx))(struct ssl_st *ssl,
                                                              const unsigned char *data,
                                                              int len, int *copy);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_CTX_sess_set_new_cb()</b> sets the callback function that is called whenever a new session was
       negotiated.

       <b>SSL_CTX_sess_set_remove_cb()</b> sets the callback function that is called whenever a session is removed by
       the SSL engine.  For example, this can occur because a session is considered faulty or has become
       obsolete because of exceeding the timeout value.

       <b>SSL_CTX_sess_set_get_cb()</b> sets the callback function that is called whenever a TLS client proposed to
       resume a session but the session could not be found in the internal session cache (see
       <b><a href="../man3/SSL_CTX_set_session_cache_mode.3.html">SSL_CTX_set_session_cache_mode</a></b>(3)).  (TLS server only.)

       <b>SSL_CTX_sess_get_new_cb()</b>, <b>SSL_CTX_sess_get_remove_cb()</b>, and <b>SSL_CTX_sess_get_get_cb()</b> retrieve the
       function pointers set by the corresponding set callback functions. If a callback function has not been
       set, the NULL pointer is returned.

</pre><h4><b>NOTES</b></h4><pre>
       In order to allow external session caching, synchronization with the internal session cache is realized
       via callback functions. Inside these callback functions, session can be saved to disk or put into a
       database using the <b><a href="../man3/d2i_SSL_SESSION.3.html">d2i_SSL_SESSION</a></b>(3) interface.

       The <b>new_session_cb()</b> is called whenever a new session has been negotiated and session caching is enabled
       (see <b><a href="../man3/SSL_CTX_set_session_cache_mode.3.html">SSL_CTX_set_session_cache_mode</a></b>(3)).  The <b>new_session_cb()</b> is passed the <b>ssl</b> connection and the
       nascent ssl session <b>sess</b>.  Since sessions are reference-counted objects, the reference count on the
       session is incremented before the callback, on behalf of the application.  If the callback returns <b>0</b>, the
       session will be immediately removed from the internal cache and the reference count released. If the
       callback returns <b>1</b>, the application retains the reference (for an entry in the application-maintained
       "external session cache"), and is responsible for calling <b>SSL_SESSION_free()</b> when the session reference
       is no longer in use.

       Note that in TLSv1.3, sessions are established after the main handshake has completed. The server decides
       when to send the client the session information and this may occur some time after the end of the
       handshake (or not at all). This means that applications should expect the <b>new_session_cb()</b> function to be
       invoked during the handshake (for &lt;= TLSv1.2) or after the handshake (for TLSv1.3). It is also possible
       in TLSv1.3 for multiple sessions to be established with a single connection. In these case the
       <b>new_session_cb()</b> function will be invoked multiple times.

       In TLSv1.3 it is recommended that each SSL_SESSION object is only used for resumption once. One way of
       enforcing that is for applications to call <b><a href="../man3/SSL_CTX_remove_session.3.html">SSL_CTX_remove_session</a></b>(3) after a session has been used.

       The <b>remove_session_cb()</b> is called whenever the SSL engine removes a session from the internal cache. This
       can happen when the session is removed because it is expired or when a connection was not shutdown
       cleanly. It also happens for all sessions in the internal session cache when <b><a href="../man3/SSL_CTX_free.3.html">SSL_CTX_free</a></b>(3) is called.
       The <b>remove_session_cb()</b> is passed the <b>ctx</b> and the ssl session <b>sess</b>. It does not provide any feedback.

       The <b>get_session_cb()</b> is only called on SSL/TLS servers, and is given the session id proposed by the
       client. The <b>get_session_cb()</b> is always called, even when session caching was disabled. The
       <b>get_session_cb()</b> is passed the <b>ssl</b> connection and the session id of length <b>length</b> at the memory location
       <b>data</b>. By setting the parameter <b>copy</b> to <b>1</b>, the callback can require the SSL engine to increment the
       reference count of the SSL_SESSION object; setting <b>copy</b> to <b>0</b> causes the reference count to remain
       unchanged.  If the <b>get_session_cb()</b> does not write to <b>copy</b>, the reference count is incremented and the
       session must be explicitly freed with <b><a href="../man3/SSL_SESSION_free.3.html">SSL_SESSION_free</a></b>(3).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_CTX_sess_get_new_cb()</b>, <b>SSL_CTX_sess_get_remove_cb()</b> and <b>SSL_CTX_sess_get_get_cb()</b> return different
       callback function pointers respectively.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/d2i_SSL_SESSION.3.html">d2i_SSL_SESSION</a></b>(3), <b><a href="../man3/SSL_CTX_set_session_cache_mode.3.html">SSL_CTX_set_session_cache_mode</a></b>(3), <b><a href="../man3/SSL_CTX_flush_sessions.3.html">SSL_CTX_flush_sessions</a></b>(3),
       <b><a href="../man3/SSL_SESSION_free.3.html">SSL_SESSION_free</a></b>(3), <b><a href="../man3/SSL_CTX_free.3.html">SSL_CTX_free</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2001-2020 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                      <u><a href="../man3SSL/SSL_CTX_SESS_SET_GET_CB.3SSL.html">SSL_CTX_SESS_SET_GET_CB</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>