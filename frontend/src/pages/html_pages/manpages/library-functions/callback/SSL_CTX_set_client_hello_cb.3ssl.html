<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_set_client_hello_cb, SSL_client_hello_cb_fn, SSL_client_hello_isv2,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_set_client_hello_cb, SSL_client_hello_cb_fn, SSL_client_hello_isv2,
       SSL_client_hello_get0_legacy_version, SSL_client_hello_get0_random, SSL_client_hello_get0_session_id,
       SSL_client_hello_get0_ciphers, SSL_client_hello_get0_compression_methods,
       SSL_client_hello_get1_extensions_present, SSL_client_hello_get_extension_order, SSL_client_hello_get0_ext
       - callback functions for early server-side ClientHello processing

</pre><h4><b>SYNOPSIS</b></h4><pre>
        typedef int (*SSL_client_hello_cb_fn)(SSL *s, int *al, void *arg);
        void SSL_CTX_set_client_hello_cb(SSL_CTX *c, SSL_client_hello_cb_fn *f,
                                         void *arg);
        int SSL_client_hello_isv2(SSL *s);
        unsigned int SSL_client_hello_get0_legacy_version(SSL *s);
        size_t SSL_client_hello_get0_random(SSL *s, const unsigned char **out);
        size_t SSL_client_hello_get0_session_id(SSL *s, const unsigned char **out);
        size_t SSL_client_hello_get0_ciphers(SSL *s, const unsigned char **out);
        size_t SSL_client_hello_get0_compression_methods(SSL *s,
                                                         const unsigned char **out);
        int SSL_client_hello_get1_extensions_present(SSL *s, int **out,
                                                     size_t *outlen);
        int SSL_client_hello_get_extension_order(SSL *s, uint16_t *exts,
                                                 size_t *num_exts);
        int SSL_client_hello_get0_ext(SSL *s, unsigned int type, const unsigned char **out,
                                      size_t *outlen);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_CTX_set_client_hello_cb()</b> sets the callback function, which is automatically called during the early
       stages of ClientHello processing on the server.  The argument supplied when setting the callback is
       passed back to the callback at run time.  A callback that returns failure (0) will cause the connection
       to terminate, and callbacks returning failure should indicate what alert value is to be sent in the <b>al</b>
       parameter.  A callback may also return a negative value to suspend the handshake, and the handshake
       function will return immediately.  <b><a href="../man3/SSL_get_error.3.html">SSL_get_error</a></b>(3) will return SSL_ERROR_WANT_CLIENT_HELLO_CB to
       indicate that the handshake was suspended.  It is the job of the ClientHello callback to store
       information about the state of the last call if needed to continue.  On the next call into the handshake
       function, the ClientHello callback will be called again, and, if it returns success, normal handshake
       processing will continue from that point.

       <b>SSL_client_hello_isv2()</b> indicates whether the ClientHello was carried in a SSLv2 record and is in the
       SSLv2 format.  The SSLv2 format has substantial differences from the normal SSLv3 format, including using
       three bytes per cipher suite, and not allowing extensions.  Additionally, the SSLv2 format 'challenge'
       field is exposed via <b>SSL_client_hello_get0_random()</b>, padded to SSL3_RANDOM_SIZE bytes with zeros if
       needed.  For SSLv2 format ClientHellos, <b>SSL_client_hello_get0_compression_methods()</b> returns a dummy list
       that only includes the null compression method, since the SSLv2 format does not include a mechanism by
       which to negotiate compression.

       <b>SSL_client_hello_get0_random()</b>, <b>SSL_client_hello_get0_session_id()</b>, <b>SSL_client_hello_get0_ciphers()</b>, and
       <b>SSL_client_hello_get0_compression_methods()</b> provide access to the corresponding ClientHello fields,
       returning the field length and optionally setting an out pointer to the octets of that field.

       Similarly, <b>SSL_client_hello_get0_ext()</b> provides access to individual extensions from the ClientHello on a
       per-extension basis.  For the provided wire protocol extension type value, the extension value and length
       are returned in the output parameters (if present).

       <b>SSL_client_hello_get1_extensions_present()</b> can be used prior to <b>SSL_client_hello_get0_ext()</b>, to determine
       which extensions are present in the ClientHello before querying for them.  The <b>out</b> and <b>outlen</b> parameters
       are both required, and on success the caller must release the storage allocated for <b>*out</b> using
       <b>OPENSSL_free()</b>.  The contents of <b>*out</b> is an array of integers holding the numerical value of the TLS
       extension types in the order they appear in the ClientHello.  <b>*outlen</b> contains the number of elements in
       the array.  In situations when the ClientHello has no extensions, the function will return success with
       <b>*out</b> set to NULL and <b>*outlen</b> set to 0.

       <b>SSL_client_hello_get_extension_order()</b> is similar to <b>SSL_client_hello_get1_extensions_present()</b>, without
       internal memory allocation.  When called with <b>exts</b> set to NULL, returns the number of extensions (e.g.,
       to allocate storage for a subsequent call).  Otherwise, <b>*exts</b> is populated with the ExtensionType values
       in the order that the corresponding extensions appeared in the ClientHello.  <b>*num_exts</b> is an input/output
       parameter, used as input to supply the size of storage allocated by the caller, and as output to indicate
       how many ExtensionType values were written.  If the input <b>*num_exts</b> is smaller then the number of
       extensions in question, that is treated as an error.  A subsequent call with <b>exts</b> set to NULL can
       retrieve the size of storage needed.  A ClientHello that contained no extensions is treated as success,
       with <b>*num_exts</b> set to 0.

</pre><h4><b>NOTES</b></h4><pre>
       The ClientHello callback provides a vast window of possibilities for application code to affect the TLS
       handshake.  A primary use of the callback is to allow the server to examine the server name indication
       extension provided by the client in order to select an appropriate certificate to present, and make other
       configuration adjustments relevant to that server name and its configuration.  Such configuration changes
       can include swapping out the associated SSL_CTX pointer, modifying the server's list of permitted TLS
       versions, changing the server's cipher list in response to the client's cipher list, etc.

       It is also recommended that applications utilize a ClientHello callback and not use a servername
       callback, in order to avoid unexpected behavior that occurs due to the relative order of processing
       between things like session resumption and the historical servername callback.

       The SSL_client_hello_* family of functions may only be called from code executing within a ClientHello
       callback.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The application's supplied ClientHello callback returns SSL_CLIENT_HELLO_SUCCESS on success,
       SSL_CLIENT_HELLO_ERROR on failure, and SSL_CLIENT_HELLO_RETRY to suspend processing.

       <b>SSL_client_hello_isv2()</b> returns 1 for SSLv2-format ClientHellos and 0 otherwise.

       <b>SSL_client_hello_get0_random()</b>, <b>SSL_client_hello_get0_session_id()</b>, <b>SSL_client_hello_get0_ciphers()</b>, and
       <b>SSL_client_hello_get0_compression_methods()</b> return the length of the corresponding ClientHello fields.
       If zero is returned, the output pointer should not be assumed to be valid.

       <b>SSL_client_hello_get0_ext()</b> returns 1 if the extension of type 'type' is present, and 0 otherwise.

       <b>SSL_client_hello_get1_extensions_present()</b> returns 1 on success and 0 on failure.

       <b>SSL_client_hello_get_extension_order()</b> returns 1 on success and 0 on failure.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_CTX_set_tlsext_servername_callback.3.html">SSL_CTX_set_tlsext_servername_callback</a></b>(3), <b><a href="../man3/SSL_bytes_to_cipher_list.3.html">SSL_bytes_to_cipher_list</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The SSL ClientHello callback, <b>SSL_client_hello_isv2()</b>, <b>SSL_client_hello_get0_random()</b>,
       <b>SSL_client_hello_get0_session_id()</b>, <b>SSL_client_hello_get0_ciphers()</b>,
       <b>SSL_client_hello_get0_compression_methods()</b>, <b>SSL_client_hello_get0_ext()</b>, and
       <b>SSL_client_hello_get1_extensions_present()</b> were added in OpenSSL 1.1.1.
       <b>SSL_client_hello_get_extension_order()</b> was added in OpenSSL 3.2.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2017-2022 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                  <u><a href="../man3SSL/SSL_CTX_SET_CLIENT_HELLO_CB.3SSL.html">SSL_CTX_SET_CLIENT_HELLO_CB</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>