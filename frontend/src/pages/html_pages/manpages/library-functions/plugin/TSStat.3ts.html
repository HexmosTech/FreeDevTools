<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plugin  Statistics  -  a  plugin  can  create statistics (metrics) that are accessible in the same way as</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/trafficserver-dev">trafficserver-dev_9.2.5+ds-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Plugin  Statistics  -  a  plugin  can  create statistics (metrics) that are accessible in the same way as
       Traffic Server core statistics. In general monitoring the behavior of plugins in production is easier  to
       do in this way in contrast to processing log files

</pre><h4><b>SYNOPSIS</b></h4><pre>
          #include &lt;ts/ts.h&gt;

       <b>int</b> <b>TSStatCreate(const</b> <b>char</b> <b>*name,</b> <u>TSRecordDataType</u> <b>type,</b> <u>TSStatPersistence</u> <b>persistence,</b> <u>TSStatSync</u>
       <b>sync_style)</b>

       <u>TSReturnCode</u> <b>TSStatFindName(const</b> <b>char</b> <b>*name,</b> <b>int</b> <b>*idx_ptr)</b>

       <u>TSMgmtInt</u> <b>TSStatIntGet(int</b> <b>idx)</b>

       <b>void</b> <b>TSStatIntSet(int</b> <b>idx,</b> <u>TSMgmtInt</u> <b>value)</b>

       <b>void</b> <b>TSStatIntIncrement(int</b> <b>idx,</b> <u>TSMgmtInt</u> <b>value)</b>

       <b>void</b> <b>TSStatIntDecrement(int</b> <b>idx,</b> <u>TSMgmtInt</u> <b>value)</b>

       <b>typedef</b> <b>void</b> <b>(*TSRecordDumpCb)(</b><u>TSRecordType</u> <b>*type,</b> <b>void</b> <b>*edata,</b> <b>int</b> <b>registered,</b> <b>const</b> <b>char</b> <b>*name,</b>
       <u>TSRecordDataType</u> <b>type,</b> <u>TSRecordData</u> <b>*datum)</b>

       <b>void</b> <b>TSRecordDump(</b><u>TSRecordType</u> <b>rect_type,</b> <u>TSRecordDumpCb</u> <b>callback,</b> <b>void</b> <b>*edata)</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A  plugin  statistic is created by <u>TSStatCreate()</u>. The <u>name</u> must be globally unique and should follow the
       standard dotted tag form. To avoid collisions and for easy of use the first tag should be the plugin name
       or something easily derived from it. Currently  only  integers  are  supported  therefore  <u>type</u>  must  be
       <u>TS_RECORDDATATYPE_INT</u>. The return value is the index of the statistic. In general this should work but if
       it  doesn't it will <b>assert</b>. In particular, creating the same statistic twice will fail in this way, which
       can happen if statistics are created as part of or based on configuration files  and  Traffic  Server  is
       reloaded.

       <u>TSStatFindName()</u>  locates  a  statistic  by  <u>name</u>. If found the function returns <b>TS_SUCCESS</b> and the value
       pointed at by <u>idx_ptr</u> is updated to be the index of the statistic. Otherwise it returns <b>TS_ERROR</b>.

       The  values  in  statistics  are  manipulated  by  <u>TSStatIntSet()</u>  to   set   the   statistic   directly,
       <u>TSStatIntIncrement()</u> to increase it by <u>value</u>, and <u>TSStatIntDecrement()</u> to decrease it by <u>value</u>.

       A  group  of  records  can be examined via <u>TSRecordDump()</u>. A set of records is specified and the iterated
       over. For each record in the set the callbac <u>callback</u> is invoked.

       The records are specified by the <u>TSRecordType</u>.  If  this  is  <u>TS_RECORDTYPE_NULL</u>  then  all  records  are
       examined. The callback is passed

          <u>type</u>   The record type.

          <u>edata</u>  Callback context. This is the <u>edata</u> value passed to <u>TSRecordDump()</u>.

          <u>registered</u>
                 A flag indicating if the value has been registered.

          <u>name</u>   The name of the record. This is nul terminated.

          <u>type</u>   The storage type of the data in the record.

          <u>datum</u>  The record data.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <u>TSMgmtStringCreate()</u>  and  <u>TSMgmtIntCreate()</u>  return  <b>TS_SUCCESS</b>  if the management value was created and
       <b>TS_ERROR</b> if not.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>Adding</u> <u>Statistics</u> <b><a href="../man3ts/TSAPI.3ts.html">TSAPI</a>(3ts)</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2025, <a href="mailto:dev@trafficserver.apache.org">dev@trafficserver.apache.org</a>

9.2                                               May 22, 2025                            <u>PLUGIN</u> <u><a href="../man3ts/STATISTICS.3ts.html">STATISTICS</a></u>(3ts)
</pre>
 </div>
</div></section>
</div>
</body>
</html>