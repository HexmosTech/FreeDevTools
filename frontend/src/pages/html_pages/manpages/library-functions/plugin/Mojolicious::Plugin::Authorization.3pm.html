<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mojolicious::Plugin::Authorization - A plugin to make Authorization a bit easier</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmojolicious-plugin-authorization-perl">libmojolicious-plugin-authorization-perl_1.0600-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mojolicious::Plugin::Authorization - A plugin to make Authorization a bit easier

</pre><h4><b>VERSION</b></h4><pre>
       version 1.06

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Mojolicious::Plugin::Authorization
           $self-&gt;plugin('Authorization' =&gt; {
               'has_priv'    =&gt; sub { ... },
               'is_role'     =&gt; sub { ... },
               'user_privs'  =&gt; sub { ... },
               'user_role'   =&gt; sub { ... },
               'fail_render' =&gt; { status =&gt; 401, json =&gt; { ... } },
           });
           if ($self-&gt;has_priv('delete_all', { optional =&gt; 'extra data stuff' })) {
               ...
           }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A very simple API implementation of role-based access control (RBAC). This plugin is only an API you will
       have to do all the work of setting up your roles and privileges and then provide four subs that are used
       by the plugin.  The plugin expects that the current session will be used to get the role its privileges.
       It also assumes that you have already been authenticated and your role set.  That is about it you are
       free to implement any system you like.

</pre><h4><b>METHODS</b></h4><pre>
   <b>has_priv('privilege',</b> <b>$extra_data)</b> <b>or</b> <b>has_privilege('privilege',</b> <b>$extra_data)</b>
       'has_priv' and 'has_privilege' will use the supplied "has_priv" subroutine ref to check if the current
       session has the given privilege. Returns true when the session has the privilege or false otherwise.  You
       can pass additional data along in the extra_data hashref and it will be passed to your "has_priv"
       subroutine as-is.

   <b>is('role',$extra_data)</b> <b>or</b> <b>is_role('role',$extra_data)</b>
       'is' and 'is_role' will use the supplied "is_role" subroutine ref to check if the current session is the
       given role. Returns true when the session has privilege or false otherwise.  You can pass additional data
       along in the extra_data hashref and it will be passed to your "is_role" subroutine as-is.

   <b>privileges($extra_data)</b>
       'privileges' will use the supplied "user_privs" subroutine ref and return the privileges of the current
       session.  You can pass additional data along in the extra_data hashref and it will be passed to your
       "user_privs" subroutine as-is. The returned data is dependent on the supplied "user_privs" subroutine.

   <b>role($extra_data)</b>
       'role' will use the supplied "user_role" subroutine ref and return the role of the current session.  You
       can pass additional data along in the extra_data hashref and it will be passed to your "user_role"
       subroutine as-is. The returned data is dependent on the supplied "user_role" subroutine.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       The following options must be set for the plugin:

       has_priv (REQUIRED) A coderef for checking to see if the current session has a privilege (see "HAS
       PRIV").
       is_role (REQUIRED) A coderef for checking to see if the current session is a certain role (see "IS / IS
       ROLE").
       user_privs (REQUIRED) A coderef for returning the privileges of the current session (see "PRIVILEGES").
       user_role (REQUIRED) A coderef for returning the role of the current session (see "ROLE").

       The following options are not required but allow greater control:

       fail_render (OPTIONAL) A hashref for setting the status code and rendering json/text/etc when routing
       fails (see "ROUTING VIA CALLBACK").

   <b>HAS</b> <b>PRIV</b> <b>/</b> <b>HAS</b> <b>PRIVILEGE</b>
       'has_priv'  is  used  when  you  need  to  confirm that the current session has the given privilege.  The
       coderef you pass to the "has_priv" configuration key has the following signature:

           sub {
               my ($app, $privilege,$extradata) = @_;
               ...
           }

       You must return either 0 for a fail and 1 for a pass.   This  allows  "ROUTING  VIA  CONDITION"  to  work
       correctly.

   <b>IS</b> <b>/</b> <b>IS</b> <b>ROLE</b>
       'is' / 'is_role' is used when you need to confirm that the current session is set to the given role.  The
       coderef you pass to the "is_role" configuration key has the following signature:

           sub {
               my ($app, $role, $extradata) = @_;
               ...
               return $role;
           }

       You  must  return  either  0  for  a  fail and 1 for a pass.  This allows "ROUTING VIA CONDITION" to work
       correctly.

   <b>PRIVILEGES</b>
       'privileges' is used when you need to get all the privileges of the current  session.   The  coderef  you
       pass to the "user_privs" configuration key has the following signature:

           sub {
               my ($app,$extradata) = @_;
               ...
               return $privileges;
           }

       You  can  return  anything  you  want. It would normally be an arrayref of privileges but you are free to
       return a scalar, hashref, arrayref, blessed object, or undef.

   <b>ROLE</b>
       'role' is used when you need to get the role of the  current  session.   The  coderef  you  pass  to  the
       "user_privs" configuration key has the following signature:

           sub {
               my ($app,$extradata) = @_;
               ...
               return $role;
           }

       You can return anything you want. It would normally be just a scalar but you are free to return a scalar,
       hashref, arrayref, blessed object, or undef.

</pre><h4><b>EXAMPLES</b></h4><pre>
       For a code example using this, see the <u>t/01-functional.t</u> test, it uses Mojolicious::Lite and this plugin.

</pre><h4><b>ROUTING</b> <b>VIA</b> <b>CONDITION</b></h4><pre>
       This plugin also exports a routing condition you can use in order to limit access to certain documents to
       only sessions that have a privilege.

           $r-&gt;route('/delete_all')-&gt;requires(has_priv =&gt; 'delete_all')-&gt;to('mycontroller#delete_all');
           $r-&gt;route('/delete_all')-&gt;requires(has_priv =&gt; ['delete_all', $extradata])-&gt;to('mycontroller#delete_all');
           my $delete_all_only = $r-&gt;route('/members')-&gt;requires(has_priv =&gt; 'delete_all')-&gt;to('members#delete_all');
           $delete_all_only-&gt;route('delete')-&gt;to('members#delete_all');

       If  the  session  does  not  have  the 'delete_all' privilege, these routes will not be considered by the
       dispatcher and unless you have set up a catch-all route,
        a 404 Not Found will be generated instead.

       Another condition you can use to limit access to certain documents to only those  sessions  that  have  a
       role.

           $r-&gt;route('/view_all')-&gt;requires(is =&gt; 'ADMIN')-&gt;to('mycontroller#view_all');
           $r-&gt;route('/view_all')-&gt;requires(is =&gt; ['ADMIN', $extradata])-&gt;to('mycontroller#view_all');
           my $view_all_only = $r-&gt;route('/members')-&gt;requires(is =&gt; 'view_all')-&gt;to('members#view_all');
           $view_all_only-&gt;route('view')-&gt;to('members#view_all');

       If  the session is not the 'ADMIN' role, these routes will not be considered by the dispatcher and unless
       you have set up a catch-all route,
        a 404 Not Found will be generated instead.  This behavior is similar to the "has" condition.

</pre><h4><b>ROUTING</b> <b>VIA</b> <b>CALLBACK</b></h4><pre>
       It is not recommended to route un-authorized requests to anything but a 404 page. If you do route to some
       sort of 'You are not allowed page' you are telling a hacker that the URL was correct while the 404  tells
       them nothing.  This is just my opinion.

       However  in  the case of publicly documented APIs returning a 404 when priv/role checks fails can confuse
       users, so you can override the default 404 status on failure by supplying a 'fail_render'  value  in  the
       plugin  config.  This  will  be  passed  to  the Mojolicious -&gt;render method when the has_priv/is/is_role
       routing fails. For example, to return a status code of 401 with JSON:

           fail_render =&gt; { status =&gt; 401, json =&gt; { error =&gt; 'Denied' } },

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Mojolicious::Sessions, Mojocast 3: Authorization &lt;<a href="http://mojocasts.com/e3">http://mojocasts.com/e3</a>#&gt;

</pre><h4><b>AUTHOR</b></h4><pre>
       John Scoles, "&lt;byterock  at hotmail.com&gt;"

</pre><h4><b>BUGS</b> <b>/</b> <b>CONTRIBUTING</b></h4><pre>
       Please    report    any    bugs    or    feature    requests    through    the    web    interface     at
       &lt;https://github.com/byterock/mojolicious-plugin-authorization/issues&gt;.

</pre><h4><b>SUPPORT</b></h4><pre>
       You can find documentation for this module with the perldoc command.
           perldoc Mojolicious::Plugin::Authorization You can also look for information at:

       •   AnnoCPAN: Annotated CPAN documentation &lt;<a href="http://annocpan.org/dist/Mojolicious-Plugin-Authorization">http://annocpan.org/dist/Mojolicious-Plugin-Authorization</a>&gt;

       •   CPAN Ratings &lt;<a href="http://cpanratings.perl.org/d/Mojolicious-Plugin-Authorization">http://cpanratings.perl.org/d/Mojolicious-Plugin-Authorization</a>&gt;

       •   Search CPAN &lt;<a href="http://search.cpan.org/dist/Mojolicious-Plugin-Authorization/">http://search.cpan.org/dist/Mojolicious-Plugin-Authorization/</a>&gt;

</pre><h4><b>ACKNOWLEDGEMENTS</b></h4><pre>
       Ben van Staveren   (madcat)

           -   For 'Mojolicious::Plugin::Authentication' which I used as a guide in writing up this one.

       Chuck Finley

           -   For staring me off on this.

       Abhijit Menon-Sen

           -   For the routing suggestions

       Roland Lammel

           -   For some other good suggestions

       Lee Johnson

           -   For the latest updates for version 1.04

       Matt Altus

           -   For the Allow extra data via conditional routing enhancement

</pre><h4><b>LICENSE</b> <b>AND</b> <b>COPYRIGHT</b></h4><pre>
       Copyright  2012  John  Scoles.   This  program is free software; you can redistribute it and/or modify it
       under the terms of either: the GNU General Public License as published by the Free  Software  Foundation;
       or the Artistic License.  See <a href="http://dev.perl.org/licenses/">http://dev.perl.org/licenses/</a> for more information.

perl v5.40.0                                       2024-10-05             <u>Mojolicious::Pl...::<a href="../man3pm/Authorization.3pm.html">Authorization</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>