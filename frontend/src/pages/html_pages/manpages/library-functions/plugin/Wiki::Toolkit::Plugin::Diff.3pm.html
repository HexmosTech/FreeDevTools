<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wiki::Toolkit::Plugin::Diff - format differences between two Wiki::Toolkit pages</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libwiki-toolkit-plugin-diff-perl">libwiki-toolkit-plugin-diff-perl_0.12-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Wiki::Toolkit::Plugin::Diff - format differences between two Wiki::Toolkit pages

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Wiki::Toolkit::Plugin::Diff;
         my $plugin = Wiki::Toolkit::Plugin::Diff-&gt;new;
         $wiki-&gt;register_plugin( plugin =&gt; $plugin );   # called before any node reads
         my %diff = $plugin-&gt;differences( node =&gt; 'Imperial College',
                                       left_version =&gt; 3,
                                       right_version =&gt; 5);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A plug-in for Wiki::Toolkit sites, which provides a nice extract of differences between two versions of a
       node.

</pre><h4><b>BASIC</b> <b>USAGE</b></h4><pre>
       <b>differences</b>

         my %diff_vars = $plugin-&gt;differences(
             node          =&gt; "Home Page",
             left_version  =&gt; 3,
             right_version =&gt; 5
         );

       Takes a series of key/value pairs:

       •   <b>left_version</b>

           The node version whose content we're considering canonical.

       •   <b>right_version</b>

           The node version that we're showing the differences from.

       •   <b>meta_include</b>

           Filter  the list of metadata fields to only include a certain list in the diff output. The default is
           to include all metadata fields.

       •   <b>meta_exclude</b>

           Filter the list of metadata fields to exclude certain fields from the diff output. The default is the
           following list, to match previous version (OpenGuides) behaviour:
              "qw(
              username
              comment
              __categories__checksum
              __locales__checksum )"

           Agreed this list is  hopelessly  inadequate,  especially  for  OpenGuides.   Hopefully,  future  wiki
           designers will use the meta_include parameter to specify exactly what metadata they want to appear on
           the diff.

       The differences method returns a list of key/value pairs, which can be assigned to a hash:

       <b>left_version</b>
           The node version whose content we're considering canonical.

       <b>right_version</b>
           The node version that we're showing the differences from.

       <b>content</b>
           The (formatted) contents of the <u>Left</u> version of the node.

       <b>diff</b>
           An  array  of hashrefs of "hunks" of differences between the versions. It is assumed that the display
           will be rendered in HTML, and SPAN tags are inserted with a class of diff1  or  diff2,  to  highlight
           which individual words have actually changed. Display the contents of diff using a &lt;table&gt;, with each
           member of the array corresponding to a row &lt;TR&gt;, and keys {left} and {right} being two columns &lt;TD&gt;.

           Usually you will want to feed this through a templating system, such as Template Toolkit, which makes
           iterating the AoH very easy.

</pre><h4><b>ADVANCED</b></h4><pre>
       Wiki::Toolkit::Plugin::Diff  allows  for  a  more flexible approach than HTML only rendering of pages. In
       particular, there are optional parameters to the constructor which control fine detail of  the  resultant
       output.

       If  this  is  not  sufficient, the module is also subclassable, and the programmer can supply alternative
       methods.

   <b>METHODS</b>
       Most of these are called internally by the plugin, but provide hooks for alternative code if  the  module
       is subclassed.

       <b>new</b>
             my $plugin = Wiki::Toolkit::Plugin::Diff-&gt;new( option =&gt; value, option =&gt; value...);

           Here, <u>option</u> can be one of the following:

           <b>metadata_separator</b>
               A  string  which  is  inserted between each metadata field, and also between the contents and the
               metadata. This defaults to "&lt;br /&gt;\n" so as to render each metadata field on a new line.

           <b>line_number_format</b>
               Used to lay out the head line number for a  difference  hunk.  The  string  is  eval'ed  with  $_
               containing the line number.  Default is "== Line \$_ ==" .

           <b>word_matcher</b>
               is  a regular expression, used to tokenize the input string. This is the way of grouping together
               atomic sequences, so as to give a readable result. The default is the following:

                           &amp;.+?;                   #HTML special characters e.g. &amp;lt;
                           |&lt;br\s*/&gt;               #Line breaks
                           |\w+\s*                 #Word with trailing spaces
                           |.                      #Any other single character

       <b>differences</b>
           see above.

       <b>line_number</b>
           This method is called to format a line number into a suitable string.  The supplied routine  performs
           the necessary substitution of $self-&gt;{line_number_format} using eval.

       <b>serialise_metadata</b>
           The purpose of this method is to turn a metadata hash into a string suitable for diffing.

       <b>content_escape</b>
           This method is used to apply the necessary quoting or escaping of characters that could appear in the
           content body, that could interfere with the rendering of the diff text.

       <b>intradiff</b>
           This  method  turns an array of hunks as returned by VCS::Lite::Delta-&gt;hunks into a side by side diff
           listing, with highlights indicating different words and punctuation.

           Currently, this is hardcoded to present the differences with HTML tags.

           This module is a prime candidate for  migration  into  VCS::Lite,  where  this  functionality  really
           belongs.

       <b>get_token</b>
           This  allows  the  "false  positive" bug discovered by Earle Martin to be solved (rt.cpan.org #6284).
           Effectively, the input strings (diff1 and diff2) are tokenised using  the  word_matcher  regexp  (see
           above), and turned into arrays of tokens.

           The  default  regexp absorbs trailing whitespace, to give a more readable result.  However, if a word
           is followed by differing whitespace or no whitespace at all, this was throwing up a diff.

           The get_token method supplied removes trailing  whitespace  from  the  key  values  before  they  are
           compared.

</pre><h4><b>TODO</b></h4><pre>
       Move intradiff functionality into VCS::Lite.

</pre><h4><b>BUGS</b> <b>AND</b> <b>ENHANCEMENTS</b></h4><pre>
       Please use rt.cpan.org to report any bugs in this module. If you have any ideas for how this module could
       be  enhanced,  please email the author, or post to the Wiki::Toolkit list (cgi (hyphen) wiki (hyphen) dev
       (at) earth (dot) li).

</pre><h4><b>AUTHOR</b></h4><pre>
       I.   P.   Williams   (ivorw_openguides    [at]    xemaps    {dot}    com)    The    Wiki::Toolkit    team
       (<a href="http://www.wiki-toolkit.org/">http://www.wiki-toolkit.org/</a>)

</pre><h4><b>COPYRIGHT</b></h4><pre>
            Copyright (C) 2003-2004 I. P. Williams (ivorw_openguides [at] xemaps {dot} com).
            Copyright (C) 2006 the Wiki::Toolkit team (<a href="http://www.wiki-toolkit.org/">http://www.wiki-toolkit.org/</a>)
            All Rights Reserved.

       This  module  is  free  software;  you  can redistribute it and/or modify it under the same terms as Perl
       itself.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       VCS::Lite, Wiki::Toolkit, Wiki::Toolkit::Plugin, OpenGuides

perl v5.40.1                                       2025-04-07                   <u>Wiki::Toolkit::Plugin::<a href="../man3pm/Diff.3pm.html">Diff</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>