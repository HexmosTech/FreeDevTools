<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::SpamAssassin::Plugin::AuthRes - use Authentication-Results header fields</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/spamassassin">spamassassin_4.0.1-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::SpamAssassin::Plugin::AuthRes - use Authentication-Results header fields

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>SpamAssassin</b> <b>configuration:</b>
       loadplugin     Mail::SpamAssassin::Plugin::AuthRes

       authres_trusted_authserv  myserv.example.com authres_networks  all

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This plugin parses Authentication-Results header fields and can supply the results obtained to other
       plugins, so as to avoid repeating checks that have been performed already.

</pre><h4><b>ADMINISTRATOR</b> <b>SETTINGS</b></h4><pre>
       authres_networks internal/trusted/all    (default: internal)
           Process  Authenticated-Results  headers  set  by  servers from these networks (refers to SpamAssassin
           *_networks zones).  Any header outside this is completely ignored (affects all module settings).

            internal   = internal_networks
            trusted    = internal_networks + trusted_networks
            all        = all above + all external

           Setting "all" is safe only if your MX servers filter properly all incoming A-R headers, and  you  use
           authres_trusted_authserv  to  match  your  authserv-id.   This  is  suitable for default OpenDKIM for
           example.  These settings might also be required if your filters do not insert A-R header  to  correct
           position  above  the  internal  Received  header (some known offenders: OpenDKIM, OpenDMARC, amavisd-
           milter).

       authres_trusted_authserv authservid1 id2 ...   (default: none)
           Trusted authentication server IDs (the domain-name-like first word of  Authentication-Results  field,
           also known as "authserv-id").

           Note that if set, ALL A-R headers are ignored unless a match is found.

           Use strongly recommended, possibly along with authres_networks all.

       authres_ignored_authserv authservid1 id2 ...   (default: none)
           Ignored  authentication  server IDs (the domain-name-like first word of Authentication-Results field,
           also known as "authserv-id").

           Any A-R header is ignored if match is found.

</pre><h4><b>METADATA</b></h4><pre>
       Parsed headers are stored in $pms-&gt;{authres_parsed}, as a hash of  array  of  hashes  where  results  are
       collected by method.  For example, the header field:

         Authentication-Results: server.example.com;
           spf=pass smtp.mailfrom=bounce.example.org;
           dkim=pass header.i=@example.org;
           dkim=fail header.i=@another.signing.domain.example

       Produces the following structure:

        $pms-&gt;{authres_parsed} = {
          'dkim' =&gt; [
            {
              'properties' =&gt; {
                'header' =&gt; {
                  'i' =&gt; '@example.org'
                }
              },
              'authserv' =&gt; 'server.example.com',
              'result' =&gt; 'pass',
              'version' =&gt; 1,
              'reason' =&gt; ''
            },
            {
              'properties' =&gt; {
                'header' =&gt; {
                  'i' =&gt; '@another.signing.domain.example'
                }
              },
              'result' =&gt; 'fail',
              'authserv' =&gt; 'server.example.com',
              'version' =&gt; 1,
              'reason' =&gt; ''
            },
          ],
        }

       Within each array, the order of results is the original, which should be most recent results first.

       For checking result of methods, $pms-&gt;{authres_result} is available:

        $pms-&gt;{authres_result} = {
          'dkim' =&gt; 'pass',
          'spf' =&gt; 'fail',
        }

</pre><h4><b>EVAL</b> <b>FUNCTIONS</b></h4><pre>
       header RULENAME eval:check_authres_result(method, result)
           Can be used to check results.

           Reference           of           valid          result          methods          and          values:
           "https://www.iana.org/assignments/email-auth/email-auth.xhtml"

           Additionally the result value of 'missing' can be used to check if there is no result at all.

             ifplugin Mail::SpamAssassin::Plugin::AuthRes
             ifplugin !(Mail::SpamAssassin::Plugin::SPF)
               header  SPF_PASS      eval:check_authres_result('spf', 'pass')
               header  SPF_FAIL      eval:check_authres_result('spf', 'fail')
               header  SPF_SOFTFAIL  eval:check_authres_result('spf', 'softfail')
               header  SPF_TEMPFAIL  eval:check_authres_result('spf', 'tempfail')
             endif
             ifplugin !(Mail::SpamAssassin::Plugin::DKIM)
               header  DKIM_VERIFIED  eval:check_authres_result('dkim', 'pass')
               header  DKIM_INVALID   eval:check_authres_result('dkim', 'fail')
             endif
             endif

perl v5.40.1                                       2025-06-26              <u>Mail::SpamAssa...Plugin::<a href="../man3pm/AuthRes.3pm.html">AuthRes</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>