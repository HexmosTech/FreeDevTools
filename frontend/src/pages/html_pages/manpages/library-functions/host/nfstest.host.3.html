<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nfstest.host - Host module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/nfstest">nfstest_3.2-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nfstest.host - Host module

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Provides  a  set  of tools for running commands on the local host or a remote host, including a mechanism
       for running commands in the background.  It provides methods for mounting  and  unmounting  from  an  NFS
       server and a mechanism to simulate a network partition via the use of 'iptables'.  Currently, there is no
       mechanism to restore the iptables rules to their original state.

</pre><h4><b>CLASSES</b></h4><pre>
   <b>class</b> <b>Host(baseobj.BaseObj)</b>
       Host object

       Host() -&gt; New Host object

       Usage:
           from nfstest.host import Host

           # Create host object for local host
           x = Host()
           # Create host object for remote host
           y = Host(host='192.168.0.11')

           # Run command to the local host
           x.run_cmd("ls -l")

           # Send command to the remote host and run it as root
           y.run_cmd("ls -l", sudo=True)

           # Run command in the background
           x.run_cmd("tcpdump", sudo=True, wait=False)
           ....
           ....
           # Stop command running in the background
           x.stop_cmd()

           # Mount volume using default options
           x.mount()

           # Unmount volume
           x.umount()

           # Start packet trace
           x.trace_start()

           # Stop packet trace
           x.trace_stop()

           # Open packet trace
           x.trace_open()

           # Enable NFS kernel debug
           x.nfs_debug_enable(nfsdebug='all'):

           # Stop NFS kernel debug
           x.nfs_debug_reset()

       <b>Methods</b> <b>defined</b> <b>here:</b>
       ---------------------

       <b>__del__(self)</b>
       Destructor

       <b>__init__(self,</b> <b>**kwargs)</b>
       Constructor

       Initialize object's private data.

              <b>host:</b>  Hostname or IP address [default: localhost]

              <b>user:</b>  User to log in to host [default: '']

              <b>server:</b>
                     NFS server name or IP address [default: None]

              <b>nfsversion:</b>
                     NFS version [default: 4.1]

              <b>proto:</b> NFS protocol name [default: 'tcp']

              <b>port:</b>  NFS server port [default: 2049]

              <b>sec:</b>   Security flavor [default: 'sys']

              <b>nconnect:</b>
                     Multiple TCP connections option [default: 1]

              <b>export:</b>
                     Exported file system to mount [default: '/']

              <b>mtpoint:</b>
                     Mount point [default: '/mnt/t']

              <b>datadir:</b>
                     Data directory where files are created [default: '']

              <b>mtopts:</b>
                     Mount options [default: 'hard,rsize=4096,wsize=4096']

              <b>interface:</b>
                     Network device interface [default: 'eth0']

              <b>nomount:</b>
                     Debug option so the server is not actually mounted [default: False]

              <b>tracename:</b>
                     Base name for trace files to create [default: 'tracefile']

              <b>trcdelay:</b>
                     Seconds to delay before stopping packet trace [default: 0.0]

              <b>tcpdump:</b>
                     Tcpdump command [default: '/usr/sbin/tcpdump']

              <b>tbsize:</b>
                     Capture buffer size in kB [default: 150000]

              <b>notrace:</b>
                     Debug option so a trace is not actually started [default: False]

              <b>rpcdebug:</b>
                     Set RPC kernel debug flags and save log messages [default: '']

              <b>nfsdebug:</b>
                     Set NFS kernel debug flags and save log messages [default: '']

              <b>tracepoints:</b>
                     List of trace points modules to enable [default: '']

              <b>nfsstats:</b>
                     Get NFS stats [default: False]

              <b>dbgname:</b>
                     Base name for log messages files to create [default: 'dbgfile']

              <b>trcpname:</b>
                     Base name for trace point files to create [default: 'trcpfile']

              <b>nfsstatname:</b>
                     Base name for NFS stats files to create [default: 'nfsstatfile']

              <b>messages:</b>
                     Location of file for system messages [default: '/var/log/messages']

              <b>trcevents:</b>
                     Tracing events directory [default: '/sys/kernel/debug/tracing/events']

              <b>trcpipe:</b>
                     Trace pipe file [default: '/sys/kernel/debug/tracing/trace_pipe']

              <b>tmpdir:</b>
                     Temporary directory where trace/debug files are created
                     [default: '<a href="file:/tmp">/tmp</a>']

              <b>iptables:</b>
                     Iptables command [default: '<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?iptables">/usr/sbin/iptables</a>']

              <b>kill:</b>  kill command [default: '<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?kill">/usr/bin/kill</a>']

              <b>nfsstat:</b>
                     nfsstat command [default: '/usr/bin/nfsstat']

              <b>sudo:</b>  Sudo command [default: '<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sudo">/usr/bin/sudo</a>']

       <b>abspath(self,</b> <b>filename,</b> <b>dir=None)</b>
       Return the absolute path for the given file name.

       <b>cleanup(self)</b>
       Gracefully unmount volume and reset network

       <b>get_pids(self,</b> <b>pid)</b>
       Get all descendant PIDs for the given PID

       <b>get_route(self,</b> <b>ipaddr)</b>
       Get routing information for destination IP address
       Returns a tuple: (gateway, device name, src IP address)

       <b>mount(self,</b> <b>**kwargs)</b>
       Mount the file system on the given mount point.

              <b>server:</b>
                     NFS server name or IP address [default: self.server]

              <b>nfsversion:</b>
                     NFS version [default: self.nfsversion]

              <b>proto:</b> NFS protocol name [default: self.proto]

              <b>port:</b>  NFS server port [default: self.port]

              <b>sec:</b>   Security flavor [default: self.sec]

              <b>nconnect:</b>
                     Multiple TCP connections option [default: self.nconnect]

              <b>export:</b>
                     Exported file system to mount [default: self.export]

              <b>mtpoint:</b>
                     Mount point [default: self.mtpoint]

              <b>datadir:</b>
                     Data directory where files are created [default: self.datadir]

              <b>mtopts:</b>
                     Mount options [default: self.mtopts]

              Return the mount point.

       <b>network_drop(self,</b> <b>ipaddr,</b> <b>port)</b>
       Simulate a network drop by dropping all tcp packets going to the
       given ipaddr and port using the iptables commands.

       <b>network_reset(self)</b>
       Reset the network by flushing all the chains in the table using
       the iptables command.

       <b>nfs_debug_enable(self,</b> <b>**kwargs)</b>
       Enable NFS debug messages.

              <b>rpcdebug:</b>
                     Set RPC kernel debug flags and save log messages [default: self.rpcdebug]

              <b>nfsdebug:</b>
                     Set NFS kernel debug flags and save log messages [default: self.nfsdebug]

              <b>dbgfile:</b>
                     Name of log messages file to create, default is a unique name
                     created in the temporary directory using self.dbgname as the
                     base name.

       <b>nfs_debug_reset(self)</b>
       Reset NFS debug messages.

       <b>nfsstat_get(self)</b>
       Get NFS stats.

       <b>nfsstat_init(self)</b>
       Initialize NFS stats.

       <b>nfsstr(self,</b> <b>version=None,</b> <b>prefix='NFSv')</b>
       Return the NFS string for the given NFS version

              <b>version:</b>
                     NFS version, default is the object attribute nfsversion

       <b>nfsvers(self,</b> <b>version=None)</b>
       Return major and minor version for the given NFS version

              <b>version:</b>
                     NFS version, default is the object attribute nfsversion

       <b>run_cmd(self,</b> <b>cmd,</b> <b>sudo=False,</b> <b>dlevel='DBG1',</b> <b>msg='',</b> <b>wait=True)</b>
       Run the command to the remote machine using ssh.
       There is no user authentication, so remote host must allow
       ssh connection without any passwords for the user.
       For a localhost the command is just executed and ssh is not used.

       The object for the process of the command is stored in object
       attribute 'self.process' to be used by methods wait_cmd() and
       stop_cmd(). The standard output of the command is also stored
       in the object attribute 'self.pstdout' while the standard error
       output of the command is stored in 'self.pstderr'.

              <b>cmd:</b>   Command to execute

              <b>sudo:</b>  Run command using sudo if option is True

              <b>dlevel:</b>
                     Debug level for displaying the command to the user

              <b>msg:</b>   Prefix this message to the debug message to be displayed

              <b>wait:</b>  Wait for command to complete before returning

              Return the standard output of the command and the return code or
              exit status is stored in the object attribute 'self.returncode'.

       <b>stop_cmd(self,</b> <b>process=None,</b> <b>dlevel=None,</b> <b>msg='')</b>
       Terminate command started by run_cmd() by calling wait_cmd()
       with the 'terminate' option set to True.

              <b>process:</b>
                     The object for the process of the command to terminate,
                     or terminate all commands started by run_cmd() if this
                     option is not given

              <b>dlevel:</b>
                     Debug level for displaying the command to the user, default
                     is the level given by run_cmd()

              <b>msg:</b>   Prefix this message to the debug message to be displayed

              Return the exit status of the last command

       <b>sudo_cmd(self,</b> <b>cmd)</b>
       Prefix the SUDO command if effective user is not root.

       <b>trace_open(self,</b> <b>tracefile=None,</b> <b>**kwargs)</b>
       Open the trace file given or the trace file started by trace_start().

       All extra options are passed directly to the packet trace object.

       Return the packet trace object created, the packet trace object
       is also stored in the object attribute pktt.

       <b>trace_points_enable(self)</b>
       Enable trace points.

       <b>trace_points_reset(self)</b>
       Reset trace points.

       <b>trace_start(self,</b> <b>tracefile=None,</b> <b>interface=None,</b> <b>capsize=None,</b> <b>clients=None)</b>
       Start trace on interface given

              <b>tracefile:</b>
                     Name of trace file to create, default is a unique name
                     created in the temporary directory using self.tracename as the
                     base name.

              <b>capsize:</b>
                     Use the -C option of tcpdump to split the trace files every
                     1000000*capsize bytes. See documentation for tcpdump for more
                     information

              <b>clients:</b>
                     List of Host() objects to monitor

              Return the name of the trace file created.

       <b>trace_stop(self)</b>
       Stop the trace started by trace_start().

       <b>umount(self)</b>
       Unmount the file system.

       <b>wait_cmd(self,</b> <b>process=None,</b> <b>terminate=False,</b> <b>dlevel=None,</b> <b>msg='')</b>
       Wait for command started by run_cmd() to finish.

              <b>process:</b>
                     The object for the process of the command to wait for,
                     or wait for all commands started by run_cmd() if this
                     option is not given

              <b>terminate:</b>
                     If True, send a signal to terminate the command or commands
                     and then wait for all commands to finish

              <b>dlevel:</b>
                     Debug level for displaying the command to the user, default
                     is the level given by run_cmd()

              <b>msg:</b>   Prefix this message to the debug message to be displayed

              Return the exit status of the last command

       <b>Static</b> <b>methods</b> <b>defined</b> <b>here:</b>
       ----------------------------

       <b>get_ip_address(host='',</b> <b>ipv6=False)</b>
       Get IP address associated with the given host name.
       This could be run as an instance or class method.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/baseobj.3.html">baseobj</a>(3),</b> <b><a href="../man3/packet.pktt.3.html">packet.pktt</a>(3)</b>

</pre><h4><b>BUGS</b></h4><pre>
       No known bugs.

</pre><h4><b>AUTHOR</b></h4><pre>
       Jorge Mora (<a href="mailto:mora@netapp.com">mora@netapp.com</a>)

NFStest 3.2                                       21 March 2023                                          <u><a href="../man3/HOST.3.html">HOST</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>