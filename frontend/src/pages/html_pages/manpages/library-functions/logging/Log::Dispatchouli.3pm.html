<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log::Dispatchouli - a simple wrapper around Log::Dispatch</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/liblog-dispatchouli-perl">liblog-dispatchouli-perl_3.009-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Log::Dispatchouli - a simple wrapper around Log::Dispatch

</pre><h4><b>VERSION</b></h4><pre>
       version 3.009

</pre><h4><b>SYNOPSIS</b></h4><pre>
         my $logger = Log::Dispatchouli-&gt;new({
           ident     =&gt; 'stuff-purger',
           facility  =&gt; 'daemon',
           to_stdout =&gt; $opt-&gt;{print},
           debug     =&gt; $opt-&gt;{verbose}
         });

         $logger-&gt;log([ "There are %s items left to purge...", $stuff_left ]);

         $logger-&gt;log_debug("this is extra often-ignored debugging log");

         $logger-&gt;log_fatal("Now we will die!!");

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Log::Dispatchouli is a thin layer above Log::Dispatch and meant to make it dead simple to add logging to
       a program without having to think much about categories, facilities, levels, or things like that.  It is
       meant to make logging just configurable enough that you can find the logs you want and just easy enough
       that you will actually log things.

       Log::Dispatchouli can log to syslog (if you specify a facility), standard error or standard output, to a
       file, or to an array in memory.  That last one is mostly useful for testing.

       In addition to providing as simple a way to get a handle for logging operations, Log::Dispatchouli uses
       String::Flogger to process the things to be logged, meaning you can easily log data structures.
       Basically: strings are logged as is, arrayrefs are taken as (sprintf format, args), and subroutines are
       called only if needed.  For more information read the String::Flogger docs.

</pre><h4><b>PERL</b> <b>VERSION</b></h4><pre>
       This library should run on perls released even a long time ago.  It should work on any version of perl
       released in the last five years.

       Although it may work on older versions of perl, no guarantee is made that the minimum required version
       will not be increased.  The version may be increased for any reason, and there is no promise that patches
       will be accepted to lower the minimum required perl.

</pre><h4><b>METHODS</b></h4><pre>
   <b>new</b>
         my $logger = Log::Dispatchouli-&gt;new(\%arg);

       This returns a new logger, a Log::Dispatchouli object.

       Valid arguments are:

         ident       - the name of the thing logging (mandatory)
         to_self     - log to the logger object for testing; default: false
         to_stdout   - log to STDOUT; default: false
         to_stderr   - log to STDERR; default: false
         facility    - to which syslog facility to send logs; default: none

         to_file     - DEPRECATED: this option will be removed in 2025
                       log to PROGRAM_NAME.YYYYMMDD in the log path; default: false
         log_file    - a leaf name for the file to log to with to_file
         log_path    - path in which to log to file; defaults to DISPATCHOULI_PATH
                       environment variable or, failing that, to your system's tmpdir

         file_format - this optional coderef is passed the message to be logged
                       and returns the text to write out

         log_pid     - if 1, prefix all log entries with the pid; default: true
                       can also be a comma-delimited list of log targets where pid is
                       logged, like "stderr,syslog"; mostly useful for logging pid in
                       syslog, but not on standard I/O
         fail_fatal  - a boolean; if true, failure to log is fatal; default: true
         muted       - a boolean; if true, only fatals are logged; default: false
         debug       - a boolean; if true, log_debug method is not a no-op
                       defaults to the truth of the DISPATCHOULI_DEBUG env var
         quiet_fatal - 'stderr' or 'stdout' or an arrayref of zero, one, or both
                       fatal log messages will not be logged to these
                       (default: stderr)
         config_id   - a name for this logger's config; rarely needed!
         syslog_socket - a value for Sys::Syslog's "socket" arg; default: "native"

       The log path is either <u><a href="file:/tmp">/tmp</a></u> or the value of the <u>DISPATCHOULI_PATH</u> env var.

       If the <u>DISPATCHOULI_NOSYSLOG</u> env var is true, we don't log to syslog.

   <b>enable_stdout</b>
   <b>enable_stderr</b>
       These methods turn on logging to STDOUT or STDERR, respectively.  If that logging has already been
       enabled, these methods do nothing.

       There is not, yet, a <u>disable</u> version of these methods.

   <b>log</b>
         $logger-&gt;log(@messages);

         $logger-&gt;log(\%arg, @messages);

       This method uses String::Flogger on the input, then <u>unconditionally</u> logs the result.  Each message is
       flogged individually, then joined with spaces.

       If the first argument is a hashref, it will be used as extra arguments to logging.  It may include a
       "prefix" entry to preprocess the message by prepending a string (if the prefix is a string) or calling a
       subroutine to generate a new message (if the prefix is a coderef).

   <b>log_fatal</b>
       This behaves like the "log" method, but will throw the logged string as an exception after logging.

       This method can also be called as "fatal", to match other popular logging interfaces.  <b>If</b> <b>you</b> <b>want</b> <b>to</b>
       <b>override</b> <b>this</b> <b>method,</b> <b>you</b> <b>must</b> <b>override</b> <b>"log_fatal"</b> <b>and</b> <b>not</b> <b>"fatal"</b>.

   <b>log_debug</b>
       This behaves like the "log" method, but will only log (at the debug level) if the logger object has its
       debug property set to true.

       This method can also be called as "debug", to match other popular logging interfaces.  <b>If</b> <b>you</b> <b>want</b> <b>to</b>
       <b>override</b> <b>this</b> <b>method,</b> <b>you</b> <b>must</b> <b>override</b> <b>"log_debug"</b> <b>and</b> <b>not</b> <b>"debug"</b>.

   <b>log_event</b>
       This method is like "log", but is used for structured logging instead of free form text.  It's invoked
       like this:

         $logger-&gt;log($event_type =&gt; $data_ref);

       $event_type should be a simple string, probably a valid identifier, that identifies the kind of event
       being logged.  It is suggested, but not required, that all events of the same type have the same kind of
       structured data in them.

       $data_ref is a set of key/value pairs of data to log in this event.  It can be an arrayref (in which case
       the ordering of pairs is preserved) or a hashref (in which case they are sorted by key).

       The logged string will be in logfmt format, meaning a series of key=value pairs separated by spaces and
       following these rules:

       •   an "identifier" is a string of printable ASCII characters between "!" and "~", excluding "\" and "="

       •   keys must be valid identifiers

       •   if a key is empty, "~" is used instead

       •   if a key contains characters not permitted in an identifier, they are replaced by "?"

       •   values must <u>either</u> be valid identifiers, or be quoted

       •   quoted value start and end with """

       •   in  a  quoted  value, """ becomes "\"", "\" becomes "\\", newline and carriage return become "\n" and
           "\r" respectively, and other control characters are replaced with "\u{....}" where  the  contents  of
           the braces are the hex value of the control character

       When values are undef, they are represented as "~".

       When values are array references, the index/values are mapped over, so that:

         key =&gt; [ 'a', 'b' ]

       becomes

         key.0=a key.1=b

       When values are hash references, the key/values are mapped, with keys sorted, so that:

         key =&gt; { b =&gt; 2, a =&gt; 1 }

       becomes

         key.a=1 key.b=2

       This  expansion  is  performed recursively.  If a value itself recurses, appearances of a reference after
       the first time will be replaced with a string like "&amp;foo.bar", pointing to the first occurrence.  <u>This</u> <u>is</u>
       <u>not</u> <u>meant</u> <u>to</u> <u>be</u> <u>a</u> <u>robust</u> <u>serialization</u> <u>mechanism.</u>  It's just here to help you be a  little  lazy.   Don't
       push the limits.

       If the value in $data_ref is a code reference, it will be called and its result logged.  If its result is
       also a code reference, you get whatever garbage that code reference stringifies to.

       If  the  value  in  $data_ref  is  a  reference  reference,  then the referenced scalar will be passed to
       String::Flogger, and the resulting string will be used as the value to log.  That string will  be  quoted
       as described above, if needed.

   <b>log_debug_event</b>
       This method is just like "log_event", but will log nothing unless the logger has its "debug" property set
       to true.

   <b>set_debug</b>
         $logger-&gt;set_debug($bool);

       This sets the logger's debug property, which affects the behavior of "log_debug".

   <b>get_debug</b>
       This gets the logger's debug property, which affects the behavior of "log_debug".

   <b>clear_debug</b>
       This method does nothing, and is only useful for Log::Dispatchouli::Proxy objects.  See Methods for Proxy
       Loggers, below.

   <b>set_muted</b>
         $logger-&gt;set_muted($bool);

       This sets the logger's muted property, which affects the behavior of "log".

   <b>get_muted</b>
       This gets the logger's muted property, which affects the behavior of "log".

   <b>clear_muted</b>
       This method does nothing, and is only useful for Log::Dispatchouli::Proxy objects.  See Methods for Proxy
       Loggers, below.

   <b>get_prefix</b>
         my $prefix = $logger-&gt;get_prefix;

       This  method  returns the currently-set prefix for the logger, which may be a string or code reference or
       undef.  See Logger Prefix.

   <b>set_prefix</b>
         $logger-&gt;set_prefix( $new_prefix );

       This method changes the prefix.  See Logger Prefix.

   <b>clear_prefix</b>
       This method clears any set logger prefix.  (It  can  also  be  called  as  "unset_prefix",  but  this  is
       deprecated.  See Logger Prefix.

   <b>ident</b>
       This method returns the logger's ident.

   <b>config_id</b>
       This method returns the logger's configuration id, which defaults to its ident.  This can be used to make
       two loggers equivalent in Log::Dispatchouli::Global so that trying to reinitialize with a new logger with
       the same "config_id" as the current logger will not throw an exception, and will simply do no thing.

   <b>dispatcher</b>
       This  returns  the  underlying  Log::Dispatch  object.   This is not the method you're looking for.  Move
       along.

   <b>stdio_dispatcher_class</b>
       This method is an experimental feature to allow you to pick an alternate dispatch class  for  stderr  and
       stdio.  By default, Log::Dispatch::Screen is used.  <b>This</b> <b>feature</b> <b>may</b> <b>go</b> <b>away</b> <b>at</b> <b>any</b> <b>time.</b>

</pre><h4><b>LOGGER</b> <b>PREFIX</b></h4><pre>
       Log  messages may be prepended with information to set context.  This can be set at a logger level or per
       log item.  The simplest example is:

         my $logger = Log::Dispatchouli-&gt;new( ... );

         $logger-&gt;set_prefix("Batch 123: ");

         $logger-&gt;log("begun processing");

         # ...

         $logger-&gt;log("finished processing");

       The above will log something like:

         Batch 123: begun processing
         Batch 123: finished processing

       To pass a prefix per-message:

         $logger-&gt;log({ prefix =&gt; 'Sub-Item 234: ' }, 'error!')

         # Logs: Batch 123: Sub-Item 234: error!

       If the prefix is a string, it is prepended to each line of the message.  If it is a coderef, it is called
       and passed the message to be logged.  The return value is logged instead.

       Proxy loggers also have their own prefix settings, which accumulate.  So:

         my $proxy = $logger-&gt;proxy({ proxy_prefix =&gt; 'Subsystem 12: ' });

         $proxy-&gt;set_prefix('Page 9: ');

         $proxy-&gt;log({ prefix =&gt; 'Paragraph 6: ' }, 'Done.');

       ...will log...

         Batch 123: Subsystem 12: Page 9: Paragraph 6: Done.

</pre><h4><b>METHODS</b> <b>FOR</b> <b>SUBCLASSING</b></h4><pre>
   <b>string_flogger</b>
       This method returns the thing on which <u>flog</u> will be called to format log messages.  By default,  it  just
       returns "String::Flogger"

   <b>env_prefix</b>
       This  method  should  return  a  string  used  as  a prefix to find environment variables that affect the
       logger's behavior.  For example, if this method returns "XYZZY" then when checking the environment for  a
       default  value  for  the  "debug"  parameter,  Log::Dispatchouli  will  first  check  "XYZZY_DEBUG", then
       "DISPATCHOULI_DEBUG".

       By default, this method returns "()", which means no extra environment variable is checked.

   <b>env_value</b>
         my $value = $logger-&gt;env_value('DEBUG');

       This method returns the value for the environment variable suffix given.  For example, the example given,
       calling with "DEBUG" will check "DISPATCHOULI_DEBUG".

</pre><h4><b>METHODS</b> <b>FOR</b> <b>TESTING</b></h4><pre>
   <b>new_tester</b>
         my $logger = Log::Dispatchouli-&gt;new_tester( \%arg );

       This returns a new logger that logs only "to_self".  It's useful  in  testing.   If  no  "ident"  arg  is
       provided, one will be generated.  "log_pid" is off by default, but can be overridden.

       "\%arg" is optional.

   <b>events</b>
       This  method  returns the arrayref of events logged to an array in memory (in the logger).  If the logger
       is not logging "to_self" this raises an exception.

   <b>clear_events</b>
       This method empties the current sequence of events logged into an array in memory.  If the logger is  not
       logging "to_self" this raises an exception.

</pre><h4><b>METHODS</b> <b>FOR</b> <b>PROXY</b> <b>LOGGERS</b></h4><pre>
   <b>proxy</b>
         my $proxy_logger = $logger-&gt;proxy( \%arg );

       This  method  returns  a  new  proxy  logger -- an instance of Log::Dispatchouli::Proxy -- which will log
       through the given logger, but which may have some settings localized.

       %arg is optional.  It may contain the following entries:

       proxy_prefix
           This is a prefix that will be applied to anything the proxy logger logs, and cannot be changed.

       proxy_ctx
           This is data to be inserted in front of event data logged through the proxy.  It  will  appear  <u>after</u>
           the  "event"  key  but  before  the logged event data.  It can be in the same format as the $data_ref
           argument to "log_event".

       debug
           This can be set to true or false to change the proxy's "am I in debug mode?"   setting.   It  can  be
           changed or cleared later on the proxy.

   <b>parent</b>
   <b>logger</b>
       These methods return the logger itself.  (They're more useful when called on proxy loggers.)

</pre><h4><b>METHODS</b> <b>FOR</b> <b>API</b> <b>COMPATIBILITY</b></h4><pre>
       To  provide  compatibility  with  some  other  loggers,  most specifically Log::Contextual, the following
       methods are provided.  You should not use these methods without a  good  reason,  and  you  should  never
       subclass them.  Instead, subclass the methods they call.

       is_debug
           This method calls "get_debug".

       is_info
       is_fatal
           These methods return true.

       info
       fatal
       debug
           These methods redispatch to "log", "log_fatal", and "log_debug" respectively.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       •   Log::Dispatch

       •   String::Flogger

</pre><h4><b>AUTHOR</b></h4><pre>
       Ricardo SIGNES &lt;<a href="mailto:cpan@semiotic.systems">cpan@semiotic.systems</a>&gt;

</pre><h4><b>CONTRIBUTORS</b></h4><pre>
       •   Charlie Garrison &lt;<a href="mailto:cng@garrison.com.au">cng@garrison.com.au</a>&gt;

       •   Christopher J. Madsen &lt;<a href="mailto:perl@cjmweb.net">perl@cjmweb.net</a>&gt;

       •   Dagfinn Ilmari Mannsåker &lt;<a href="mailto:ilmari@ilmari.org">ilmari@ilmari.org</a>&gt;

       •   Dan Book &lt;<a href="mailto:grinnz@gmail.com">grinnz@gmail.com</a>&gt;

       •   George Hartzell &lt;<a href="mailto:hartzell@alerce.com">hartzell@alerce.com</a>&gt;

       •   Jon Stuart &lt;<a href="mailto:jon@fastmailteam.com">jon@fastmailteam.com</a>&gt;

       •   Matt Phillips &lt;<a href="mailto:mattp@cpan.org">mattp@cpan.org</a>&gt;

       •   Olivier Mengué &lt;<a href="mailto:dolmen@cpan.org">dolmen@cpan.org</a>&gt;

       •   Randy Stauner &lt;<a href="mailto:randy@magnificent-tears.com">randy@magnificent-tears.com</a>&gt;

       •   Ricardo Signes &lt;<a href="mailto:rjbs@semiotic.systems">rjbs@semiotic.systems</a>&gt;

       •   Sawyer X &lt;<a href="mailto:xsawyerx@cpan.org">xsawyerx@cpan.org</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       This software is copyright (c) 2025 by Ricardo SIGNES.

       This  is  free  software;  you  can  redistribute  it and/or modify it under the same terms as the Perl 5
       programming language system itself.

perl v5.40.0                                       2025-01-26                             <u>Log::<a href="../man3pm/Dispatchouli.3pm.html">Dispatchouli</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>