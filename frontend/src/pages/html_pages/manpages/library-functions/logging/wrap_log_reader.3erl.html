<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>wrap_log_reader - A service to read internally formatted wrap disk logs.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/erlang-manpages">erlang-manpages_24.2.1+dfsg-1ubuntu0.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       wrap_log_reader - A service to read internally formatted wrap disk logs.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  module  makes  it  possible  to  read  internally  formatted  wrap  disk  logs, see <u><a href="../man3erl/disk_log.3erl.html">disk_log</a>(3erl)</u>.
       <u>wrap_log_reader</u> does not interfere with <u>disk_log</u> activities; there is however a bug in  this  version  of
       the <u>wrap_log_reader</u>, see section Known Limitations.

       A  wrap  disk  log  file consists of many files, called index files. A log file can be opened and closed.
       Also, a single index file can be opened separately. If a non-existent or non-internally formatted file is
       opened, an error message is returned. If the file is corrupt, no attempt is made to  repair  it,  but  an
       error message is returned.

       If  a  log  is  configured  to be distributed, it is possible that all items are not logged on all nodes.
       <u>wrap_log_reader</u> only reads the log on the called node; it is up to the user to be sure that all items are
       read.

</pre><h4><b>DATA</b> <b>TYPES</b></h4><pre>
       <b>continuation()</b>

              Continuation returned by <u>open/1,2</u> or <u>chunk/1,2</u>.

</pre><h4><b>EXPORTS</b></h4><pre>
       <b>chunk(Continuation)</b> <b>-&gt;</b> <b>chunk_ret()</b>

       <b>chunk(Continuation,</b> <b>N)</b> <b>-&gt;</b> <b>chunk_ret()</b>

              Types:

                 Continuation = continuation()
                 N = infinity | integer() &gt;= 1
                 <b>chunk_ret()</b> =
                     {Continuation2, Terms :: [term()]} |
                     {Continuation2,
                      Terms :: [term()],
                      Badbytes :: integer() &gt;= 0} |
                     {Continuation2, eof} |
                     {error, Reason :: term()}

              Enables to efficiently read the terms that are appended to a log. Minimises disk I/O by reading 64
              kilobyte chunks from the file.

              The first time <u>chunk()</u> is called, an initial continuation returned from <u>open/1</u> or <u>open/2</u>  must  be
              provided.

              When  <u>chunk/3</u> is called, <u>N</u> controls the maximum number of terms that are read from the log in each
              chunk. Defaults to <u>infinity</u>, which means that all the terms contained in the 8K chunk are read. If
              less than <u>N</u> terms are returned, this does not necessarily mean that end of file is reached.

              Returns a tuple <u>{Continuation2,</u> <u>Terms}</u>, where  <u>Terms</u>  is  a  list  of  terms  found  in  the  log.
              <u>Continuation2</u>  is  yet  another  continuation  that  must  be passed on to any subsequent calls to
              <u>chunk()</u>. With a series of calls to <u>chunk()</u>, it is then possible to extract all terms from a log.

              Returns a tuple <u>{Continuation2,</u> <u>Terms,</u> <u>Badbytes}</u> if the log is opened in read only  mode  and  the
              read  chunk  is  corrupt.  <u>Badbytes</u>  indicates  the number of non-Erlang terms found in the chunk.
              Notice that the log is not repaired.

              Returns <u>{Continuation2,</u> <u>eof}</u> when the end of the log is reached, and <u>{error,</u> <u>Reason}</u> if  an  error
              occurs.

              The  returned  continuation  either  is or is not valid in the next call to this function. This is
              because the log can wrap and delete the file into which the continuation points.  To  ensure  this
              does not occur, the log can be blocked during the search.

       <b>close(Continuation)</b> <b>-&gt;</b> <b>ok</b> <b>|</b> <b>{error,</b> <b>Reason}</b>

              Types:

                 Continuation = continuation()
                 Reason = file:posix()

              Closes a log file properly.

       <b>open(Filename)</b> <b>-&gt;</b> <b>open_ret()</b>

       <b>open(Filename,</b> <b>N)</b> <b>-&gt;</b> <b>open_ret()</b>

              Types:

                 Filename = string() | atom()
                 N = integer()
                 <b>open_ret()</b> =
                     {ok, Continuation :: continuation()} |
                     {error, Reason :: tuple()}

              <u>Filename</u> specifies the name of the file to be read.

              <u>N</u> specifies the index of the file to be read. If <u>N</u> is omitted, the whole wrap log file is read; if
              it is specified, only the specified index file is read.

              Returns  <u>{ok,</u>  <u>Continuation}</u>  if  the log/index file is opened successfully. <u>Continuation</u> is to be
              used when chunking or closing the file.

              Returns <u>{error,</u> <u>Reason}</u> for all errors.

</pre><h4><b>KNOWN</b> <b>LIMITATIONS</b></h4><pre>
       This version of <u>wrap_log_reader</u> does not detect if <u>disk_log</u> wraps to a new index file between a  call  to
       <u>wrap_log_reader:open()</u> and the first call to <u>wrap_log_reader:chunk()</u>. If this occurs, the call to <u>chunk()</u>
       reads the last logged items in the log file, as the opened index file was truncated by <u>disk_log</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3erl/disk_log.3erl.html">disk_log</a>(3erl)</u>

Ericsson AB                                        kernel 8.2                              <u><a href="../man3erl/wrap_log_reader.3erl.html">wrap_log_reader</a></u>(3erl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>