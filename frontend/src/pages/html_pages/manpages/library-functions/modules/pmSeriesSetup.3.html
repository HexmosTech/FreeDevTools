<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmSeriesSetup,          pmSeriesSetSlots,         pmSeriesSetEventLoop,         pmSeriesSetConfiguration,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpcp3-dev">libpcp3-dev_6.3.8-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmSeriesSetup</b>,          <b>pmSeriesSetSlots</b>,         <b>pmSeriesSetEventLoop</b>,         <b>pmSeriesSetConfiguration</b>,
       <b>pmSeriesSetMetricRegistry</b>, <b>pmSeriesClose</b> - fast, scalable time series services

</pre><h4><b>C</b> <b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;pcp/pmwebapi.h&gt;</b>

       <b>int</b> <b>pmSeriesSetup(pmSeriesModule</b> <b>*</b><u>module</u><b>,</b> <b>pmSeriesCallBacks</b> <b>*</b><u>callbacks</u><b>,</b> <b>void</b> <b>*</b><u>arg</u><b>);</b>

       <b>int</b> <b>pmSeriesSetSlots(pmSeriesModule</b> <b>*</b><u>module</u><b>,</b> <b>void</b> <b>*</b><u>slots</u><b>);</b>
       <b>int</b> <b>pmSeriesSetEventLoop(pmSeriesModule</b> <b>*</b><u>module</u><b>,</b> <b>void</b> <b>*</b><u>uvloop</u><b>);</b>
       <b>int</b> <b>pmSeriesSetConfiguration(pmSeriesModule</b> <b>*</b><u>module</u><b>,</b> <b>struct</b> <b>dict</b> <b>*</b><u>config</u><b>);</b>
       <b>int</b> <b>pmSeriesSetMetricRegistry(pmSeriesModule</b> <b>*</b><u>module</u><b>,</b> <b>struct</b> <b>mmv_registry</b> <b>*</b><u>registry</u><b>);</b>

       <b>int</b> <b>pmSeriesClose(pmSeriesModule</b> <b>*</b><u>module</u><b>);</b>

       <b>cc</b> <b>...</b> <b>-lpcp_web</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>pmSeriesSetup</b> and related API functions prepare an application for accessing the fast, scalable  time
       series querying functionality of the Performance Co-Pilot (PCP).

       This functionality is provided through asynchronous APIs, which function in an event-driven fashion.  The
       interfaces described here prepare a given time series <u>module</u> which associates callback routines with cer‐
       tain asynchronous events that occur as part of servicing time series requests.

       As  a general pattern, all interfaces in these APIs that need to invoke <u>callbacks</u> provided by the calling
       program will take an opaque (void * pointer) parameter, <u>arg</u>.  This pointer will  be  passed  through  un‐
       changed and is typically used to access a data structure maintaining state within the calling program.

       Where asynchronous setup is required by <b>pmSeriesSetup</b> its completion will be indicated through use of the
       <u>on_setup</u> callback, which is part of the passed in <b>pmSeriesModule</b> structure.  This structure also provides
       for  custom  diagnostics  handling,  through  the  <u>on_info</u>  callback.   These  are  self-explanatory, see
       <u>&lt;pcp/pmwebapi.h&gt;</u> for exact calling conventions.

       The <u>callbacks</u> registered by <b>pmSeriesSetup</b> to handle events are as follows:

       <b>pmSeriesMatchCallBack</b> <u>on_match</u>
            When a time series query discovers time series identifiers that match the query, the <u>on_match</u>  call‐
            back  will be called once for every series identifier (SID).  The SID is a unique 40-byte ASCII rep‐
            resentation of a SHA hash.

       <b>pmSeriesDescCallBack</b> <u>on_desc</u>
            Metric descriptor requests from <b><a href="../man1/pmSeriesDescs.1.html">pmSeriesDescs</a></b>(1) will invoke this  callback  once  for  each  series
            identifier.

       <b>pmSeriesInstCallBack</b> <u>on_inst</u>
            Instance identification callback - internal (numeric) and external (string) instance identifiers, as
            well as time series and source (host) SHA1 identifiers.  Called once for each instance.  The associ‐
            ated series identifier is also provided to the callback.

       <b>pmSeriesLabelCallBack</b> <u>on_labelmap</u>
            Provides  metric  labels  (name and value mappings) for each series identifier passed to <b>pmSeriesLa‐</b>
            <b><a href="../man1/bels.1.html">bels</a></b>(1).

       <b>pmSeriesStringCallBack</b> <u>on_instance</u>
            Provides an instance name for a call to <b><a href="../man1/pmSeriesInstances.1.html">pmSeriesInstances</a></b>(1)<b>-</b> the callback is called once  for  each
            instance name.  The associated series identifier is also provided to the callback.

       <b>pmSeriesStringCallBack</b> <u>on_context</u>
            Provides  a  context  name  for  a  call to <b><a href="../man1/pmSeriesSources.1.html">pmSeriesSources</a></b>(1)<b>-</b> the callback is called once for each
            source (hostname or archive).  The associated source identifier is also provided to the callback.

       <b>pmSeriesStringCallBack</b> <u>on_metric</u>
            Provides a metric name for a call to <b><a href="../man1/pmSeriesMetrics.1.html">pmSeriesMetrics</a></b>(1)<b>-</b> the callback is called once for each metric
            name.  The associated series identifier is also provided to the callback.

       <b>pmSeriesStringCallBack</b> <u>on_label</u>
            Provides a label name for a call to <b><a href="../man1/pmSeriesLabels.1.html">pmSeriesLabels</a></b>(1)<b>-</b> the callback is called once  for  each  label
            name.  The associated series identifier is also provided to the callback.

       <b>pmSeriesValueCallBack</b> <u>on_value</u>
            Calls to the <b>pmSeriesQuery</b> interface that provide a time window may result in values being found for
            matching  time  series.  The <u>on_value</u> callback will be invoked once for each time series value, also
            providing the sample timestamp (in both string and binary form, as a time in nanoseconds  since  the
            epoch).  The associated series identifier is also provided to the callback.

       <b>pmSeriesDoneCallBack</b> <u>on_done</u>
            On  completion  of all asynchronous interfaces that return success (zero return code), this callback
            will be called.  It provides a status code indicating overall success (zero)  or  failure  (negative
            PMAPI code) of the operation.

       The  helper  functions <b>pmSeriesSetSlots</b> (key-value server), <b>pmSeriesSetEventLoop</b> (libuv), <b>pmSeriesSetCon‐</b>
       <b>figuration</b> (configuration file) and <b>pmSeriesSetMetricRegistry</b> (MMV instrumentation) interfaces provide  a
       mechanism for passing in state for each of the associated subsystems.

       Finally, a call to <b>pmSeriesClose</b> is used to end services available from a series <u>module</u> previously estab‐
       lished through <b>pmSeriesSetup</b>.

       Within PCP, the <b><a href="../man1/pmproxy.1.html">pmproxy</a></b>(1) and <b><a href="../man1/pmseries.1.html">pmseries</a></b>(1) utilities are the primary users of these interfaces, providing
       REST API and command line time series query services respectively.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Where  these functions return a status code, this is always zero on success.  On failure a negative PMAPI
       error code is returned.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/pmproxy.1.html">pmproxy</a></b>(1), <b><a href="../man1/pmlogger.1.html">pmlogger</a></b>(1), <b><a href="../man1/pmseries.1.html">pmseries</a></b>(1), <b><a href="../man3/mmv_stats_registry.3.html">mmv_stats_registry</a></b>(3), <b><a href="../man3/pmSeriesDescs.3.html">pmSeriesDescs</a></b>(3), <b><a href="../man3/pmSeriesQuery.3.html">pmSeriesQuery</a></b>(3), <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3)
       and <b><a href="../man3/PMWEBAPI.3.html">PMWEBAPI</a></b>(3).

Performance Co-Pilot                                   PCP                                      <u><a href="../man3/PMSERIESSETUP.3.html">PMSERIESSETUP</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>