<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log::Handler::Output::DBI - Log messages to a database.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/liblog-handler-perl">liblog-handler-perl_0.90-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Log::Handler::Output::DBI - Log messages to a database.

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Log::Handler::Output::DBI;

           my $db = Log::Handler::Output::DBI-&gt;new(
               # database source
               database    =&gt; "database",
               driver      =&gt; "mysql",
               host        =&gt; "127.0.0.1",
               port        =&gt; 3306,

               # or with "dbname" instead of "database"
               dbname      =&gt; "database",
               driver      =&gt; "Pg",
               host        =&gt; "127.0.0.1",
               port        =&gt; 5432,

               # or with data_source
               data_source =&gt; "dbi:mysql:database=database;host=127.0.0.1;port=3306",

               # Username and password
               user        =&gt; "user",
               password    =&gt; "password",

               # debugging
               debug       =&gt; 1,

               # table, columns and values (as string)
               table       =&gt; "messages",
               columns     =&gt; "level ctime cdate pid hostname progname message",
               values      =&gt; "%level %time %date %pid %hostname %progname %message",

               # table, columns and values (as array reference)
               table       =&gt; "messages",
               columns     =&gt; [ qw/level ctime cdate pid hostname progname message/ ],
               values      =&gt; [ qw/%level %time %date %pid %hostname %progname %message/ ],

               # table, columns and values (your own statement)
               statement   =&gt; "insert into messages (level,ctime,cdate,pid,hostname,progname,message) values (?,?,?,?,?,?,?)",
               values      =&gt; [ qw/%level %time %date %pid %hostname %progname %message/ ],

               # if you like persistent connections and want to re-connect
               persistent  =&gt; 1,
           );

           my %message = (
               level       =&gt; "ERROR",
               time        =&gt; "10:12:13",
               date        =&gt; "1999-12-12",
               pid         =&gt; $$,
               hostname    =&gt; "localhost",
               progname    =&gt; $0,
               message     =&gt; "an error here"
           );

           $db-&gt;log(\%message);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       With this output you can insert messages into a database table.

</pre><h4><b>METHODS</b></h4><pre>
   <b>new()</b>
       Call "new()" to create a new Log::Handler::Output::DBI object.

       The following options are possible:

       <b>data_source</b>
           Set the dsn (data source name).

           You can use this parameter instead of "database", "driver", "host" and "port".

       <b>database</b> or <b>dbname</b>
           Pass the database name.

       <b>driver</b>
           Pass the database driver.

       <b>host</b>
           Pass the hostname where the database is running.

       <b>port</b>
           Pass the port where the database is listened.

       <b>user</b>
           Pass the database user for the connect.

       <b>password</b>
           Pass the users password.

       <b>table</b> and <b>columns</b>
           With  this  options  you  can  pass  the table name for the insert and the columns.  You can pass the
           columns as string or as array. Example:

               # the table name
               table =&gt; "messages",

               # columns as string
               columns =&gt; "level, ctime, cdate, pid, hostname, progname, message",

               # columns as array
               columns =&gt; [ qw/level ctime cdate pid hostname progname message/ ],

           The statement would created as follows

               insert into message (level, ctime, cdate, pid, hostname, progname, mtime, message)
                            values (?,?,?,?,?,?,?)

       <b>statement</b>
           With this option you can pass your own statement if you don't want to you  the  options  "table"  and
           "columns".

               statement =&gt; "insert into message (level, ctime, cdate, pid, hostname, progname, mtime, message)"
                            ." values (?,?,?,?,?,?,?)"

       <b>values</b>
           With this option you have to set the values for the insert.

                   values =&gt; "%level, %time, %date, %pid, %hostname, %progname, %message",

                   # or

                   values =&gt; [ qw/%level %time %date %pid %hostname %progname %message/ ],

           The  placeholders  are  identical  with  the  pattern  names  that  you  have to pass with the option
           "message_pattern" from Log::Handler.

               %L   level
               %T   time
               %D   date
               %P   pid
               %H   hostname
               %N   newline
               %C   caller
               %p   package
               %f   filename
               %l   line
               %s   subroutine
               %S   progname
               %r   runtime
               %t   mtime
               %m   message

           Take a look to the documentation of Log::Handler for all possible patterns.

       <b>persistent</b>
           With this option you can enable or disable a persistent database connection  and  re-connect  if  the
           connection was lost.

           This option is set to 1 on default.

       <b>dbi_params</b>
           This option is useful if you want to pass arguments to DBI. The default is set to

               {
                   PrintError =&gt; 0,
                   AutoCommit =&gt; 1
               }

           "PrintError" is deactivated because this would print error messages as warnings to STDERR.

           You can pass your own arguments - and overwrite it - with

               dbi_params =&gt; { PrintError =&gt; 1, AutoCommit =&gt; 0 }

       <b>debug</b>
           With  this  option  it's  possible  to  enable  debugging.  The  information  can be intercepted with
           $SIG{__WARN__}.

   <b>log()</b>
       Log a message to the database.

           my $db = Log::Handler::Output::DBI-&gt;new(
               database   =&gt; "database",
               driver     =&gt; "mysql",
               user       =&gt; "user",
               password   =&gt; "password",
               host       =&gt; "127.0.0.1",
               port       =&gt; 3306,
               table      =&gt; "messages",
               columns    =&gt; [ qw/level ctime message/ ],
               values     =&gt; [ qw/%level %time %message/ ],
               persistent =&gt; 1,
           );

           $db-&gt;log(
               message =&gt; "your message",
               level   =&gt; "INFO",
               time    =&gt; "2008-10-10 10:12:23",
           );

       Or you can connect to the database yourself. You should notice that if the database connection lost  then
       the logger can't re-connect to the database and would return an error. Use "dbi_handle" at your own risk.

           my $dbh = DBI-&gt;connect(...);

           my $db = Log::Handler::Output::DBI-&gt;new(
               dbi_handle =&gt; $dbh,
               table      =&gt; "messages",
               columns    =&gt; [ qw/level ctime message/ ],
               values     =&gt; [ qw/%level %time %message/ ],
           );

   <b>connect()</b>
       Connect to the database.

   <b>disconnect()</b>
       Disconnect from the database.

   <b>validate()</b>
       Validate a configuration.

   <b>reload()</b>
       Reload with a new configuration.

   <b>errstr()</b>
       This function returns the last error message.

</pre><h4><b>PREREQUISITES</b></h4><pre>
           Carp
           Params::Validate
           DBI
           your DBI driver you want to use

</pre><h4><b>EXPORTS</b></h4><pre>
       No exports.

</pre><h4><b>REPORT</b> <b>BUGS</b></h4><pre>
       Please report all bugs to &lt;jschulz.cpan(at)bloonix.de&gt;.

       If you send me a mail then add Log::Handler into the subject.

</pre><h4><b>AUTHOR</b></h4><pre>
       Jonny Schulz &lt;jschulz.cpan(at)bloonix.de&gt;.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (C) 2007-2009 by Jonny Schulz. All rights reserved.

       This  program  is  free  software;  you can redistribute it and/or modify it under the same terms as Perl
       itself.

perl v5.36.0                                       2022-08-28                     <u>Log::Handler::Output::<a href="../man3pm/DBI.3pm.html">DBI</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>