<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File::Map - Memory mapping made simple and safe.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libfile-map-perl">libfile-map-perl_0.71-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       File::Map - Memory mapping made simple and safe.

</pre><h4><b>VERSION</b></h4><pre>
       version 0.71

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use File::Map 'map_file';

        map_file my $map, $filename, '+&lt;';
        $map =~ s/bar/quz/g;
        substr $map, 1024, 11, "Hello world";

</pre><h4><b>DESCRIPTION</b></h4><pre>
       File::Map maps files or anonymous memory into perl variables.

   <b>Advantages</b> <b>of</b> <b>memory</b> <b>mapping</b>
       •   Unlike normal perl variables, mapped memory is (usually) shared between threads or forked processes.

       •   It  is  an efficient way to slurp an entire file. Unlike for example File::Slurp, this module returns
           almost immediately, loading the pages lazily on access. This means you only 'pay' for  the  parts  of
           the file you actually use.

       •   Perl usually doesn't return memory to the system while running, mapped memory can be returned.

   <b>Advantages</b> <b>of</b> <b>this</b> <b>module</b> <b>over</b> <b>other</b> <b>similar</b> <b>modules</b>
       •   Safety and Speed

           This  module  is  safe  yet  fast.  Alternatives  are either fast but can cause segfaults or lose the
           mapping when not used correctly, or are safe but rather slow. File::Map is as fast as a normal string
           yet safe.

       •   Simplicity

           It offers a simple interface targeted at common usage patterns

           •   Files are mapped into a variable that can be read just like any other variable,  and  it  can  be
               written to using standard Perl techniques such as regexps and "substr".

           •   Files  can be mapped using a set of simple functions. There is no need to know weird constants or
               the order of 6 arguments.

           •   It will automatically unmap the file when the scalar gets destroyed. This works correctly even in
               multi-threaded programs.

       •   Portability

           File::Map supports Unix and Windows.

       •   Thread synchronization

           It has built-in support for thread synchronization.

</pre><h4><b>FUNCTIONS</b></h4><pre>
   <b>Mapping</b>
       The following functions for mapping a variable are available for exportation.  Note  that  all  of  these
       functions throw exceptions on errors, unless noted otherwise.

       <u>map_handle</u> <u>$lvalue,</u> <u>$filehandle,</u> <u>$mode</u> <u>=</u> <u>'&lt;',</u> <u>$offset</u> <u>=</u> <u>0,</u> <u>$length</u> <u>=</u> <u>-s(*handle)</u> <u>-</u> <u>$offset</u>

       Use  a  filehandle  to map into an lvalue. $filehandle should be a scalar filehandle. $mode uses the same
       format as "open" does (it currently accepts "&lt;", "+&lt;", "&gt;"  and  "+&gt;").  $offset  and  $length  are  byte
       positions in the file, and default to mapping the whole file.

       <u>*</u> <u>map_file</u> <u>$lvalue,</u> <u>$filename,</u> <u>$mode</u> <u>=</u> <u>'&lt;',</u> <u>$offset</u> <u>=</u> <u>0,</u> <u>$length</u> <u>=</u> <u>-s($filename)</u> <u>-</u> <u>$offset</u>

       Open a file and map it into an lvalue. Other than $filename, all arguments work as in map_handle.

       <u>*</u> <u>map_anonymous</u> <u>$lvalue,</u> <u>$length,</u> <u>$type</u>

       Map  an  anonymous  piece  of  memory. $type can be either 'shared', in which case it will be shared with
       child processes, or 'private', which won't be shared.

       <u>*</u> <u>sys_map</u> <u>$lvalue,</u> <u>$length,</u> <u>$protection,</u> <u>$flags,</u> <u>$filehandle,</u> <u>$offset</u> <u>=</u> <u>0</u>

       Low level map operation. It  accepts  the  same  constants  as  mmap  does  (except  its  first  argument
       obviously). If you don't know how mmap works you probably shouldn't be using this.

       <u>*</u> <u>unmap</u> <u>$lvalue</u>

       Unmap  a  variable.  Note  that normally this is not necessary as variables are unmapped automatically at
       destruction, but it is included for completeness.

       <u>*</u> <u>remap</u> <u>$lvalue,</u> <u>$new_size</u>

       Try to remap $lvalue to a new size. This call is linux specific and not supported on other systems. For a
       file backed mapping a file must be long enough to hold the new size, otherwise you can expect bus faults.
       For an anonymous map it must be private, shared maps can not be remapped. <b>Use</b> <b>with</b> <b>caution</b>.

   <b>Auxiliary</b>
       <u>*</u> <u>sync</u> <u>$lvalue,</u> <u>$synchronous</u> <u>=</u> <u>1</u>

       Flush changes made to the memory map back to disk. Mappings are always flushed when unmapped, so this  is
       usually  not  necessary. If $synchronous is true and your operating system supports it, the flushing will
       be done synchronously.

       <u>*</u> <u>pin</u> <u>$lvalue</u>

       Disable paging for this map, thus locking it in physical memory. Depending on your operating system there
       may be limits on pinning.

       <u>*</u> <u>unpin</u> <u>$lvalue</u>

       Unlock the map from physical memory.

       <u>*</u> <u>advise</u> <u>$lvalue,</u> <u>$advice</u>

       Advise a certain memory usage pattern. This is not implemented on all operating systems, and may be a no-
       op. The following values for $advice are always accepted:.

       • normal

         Specifies that the application has no advice to give  on  its  behavior  with  respect  to  the  mapped
         variable. It is the default characteristic if no advice is given.

       • random

         Specifies that the application expects to access the mapped variable in a random order.

       • sequential

         Specifies that the application expects to access the mapped variable sequentially from start to end.

       • willneed

         Specifies that the application expects to access the mapped variable in the near future.

       • dontneed

         Specifies that the application expects that it will not access the mapped variable in the near future.

       On  some  systems  there  may be more values available, but this can not be relied on. Unknown values for
       $advice will cause a warning but are further ignored.

       <u>*</u> <u>protect</u> <u>$lvalue,</u> <u>$mode</u>

       Change the memory protection of the mapping. $mode takes the same format  as  "open",  but  also  accepts
       sys_map style constants.

   <b>Locking</b>
       These  locking  functions  provide  locking  for  threads for the mapped region. The mapped region has an
       internal  lock  and  condition  variable.  The  condition  variable   functions("wait_until",   "notify",
       "broadcast")  can  only  be  used  inside  a  locked block. If your perl has been compiled without thread
       support the condition functions will not be available.

       <u>*</u> <u>lock_map</u> <u>$lvalue</u>

       Lock $lvalue until the end of the scope. If your perl does not support threads, this will be a no-op.

       <u>*</u> <u>wait_until</u> <u>{</u> <u>block</u> <u>}</u> <u>$lvalue</u>

       Wait for block to become true. After every failed attempt, wait  for  a  signal.  It  returns  the  value
       returned by the block.

       <u>*</u> <u>notify</u> <u>$lvalue</u>

       This will signal to one listener that the map is available.

       <u>*</u> <u>broadcast</u> <u>$lvalue</u>

       This will signal to all listeners that the map is available.

   <b>Constants</b>
       PROT_NONE, PROT_READ, PROT_WRITE, PROT_EXEC, MAP_ANONYMOUS, MAP_SHARED, MAP_PRIVATE, MAP_ANON, MAP_FILE
           These constants are used for sys_map. If you think you need them your mmap manpage will explain them,
           but in most cases you can skip sys_map altogether.

</pre><h4><b>EXPORTS</b></h4><pre>
       All  previously mentioned functions are available for exportation, but none are exported by default. Some
       functions may not be available on your OS or your version of perl as specified above. A  number  of  tags
       are defined to make importation easier.

       •   :map

           map_handle, map_file, map_anonymous, sys_map, unmap

       •   :extra

           remap, sync, pin, unpin, advise, protect

       •   :lock

           lock_map, wait_until, notify, broadcast

       •   :constants

           PROT_NONE,  PROT_READ,  PROT_WRITE,  PROT_EXEC,  MAP_ANONYMOUS,  MAP_SHARED,  MAP_PRIVATE,  MAP_ANON,
           MAP_FILE

       •   :all

           All functions defined in this module.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
   <b>Exceptions</b>
       •   Could not &lt;function name&gt;: this variable is not memory mapped

           An attempt was made to "sync", "remap", "unmap", "pin", "unpin", "advise" or "lock_map"  an  unmapped
           variable.

       •   Could not &lt;function name&gt;: &lt;system error&gt;

           Your OS didn't allow File::Map to do what you asked it to do for some reason.

       •   Trying to &lt;function_name&gt; on an unlocked map

           You tried to "wait_until", "notify" or "broadcast" on an unlocked variable.

       •   Zero length not allowed for anonymous map

           A zero length anonymous map is not possible (or in any way useful).

       •   Can't remap a shared mapping

           An attempt was made to remap a mapping that is shared among different threads, this is not possible.

       •   Window (&lt;start&gt;, &lt;end&gt;) is outside the file

           The offset and/or length you specified were invalid for this file.

       •   Can't map fake filehandle

           The filehandle you provided is not real. This may mean it's a scalar string handle or a tied handle.

       •   No such flag &lt;flag_name&gt;

           The flag given for map_anonymous isn't valid, it should either be "shared" or "private".

   <b>Warnings</b>
       •   Writing directly to a memory mapped file is not recommended

           Due to the way perl works internally, it's not possible to write a mapping implementation that allows
           direct  assignment  yet performs well. As a compromise, File::Map is capable of fixing up the mess if
           you do it nonetheless, but it will warn you that you're doing something you shouldn't.  This  warning
           is only given when "use warnings 'substr'" is in effect.

       •   Truncating new value to size of the memory map

           This  warning is additional to the previous one, warning you that you're losing data. This warning is
           only given when "use warnings 'substr'" is in effect.

       •   Shouldn't mmap non-binary filehandle

           You tried to to map a filehandle that has some encoding layer. Encoding layers are not  supported  by
           File::Map.  This  warning  is only given when "use warnings 'layer'" is in effect. Note that this may
           become an exception in a future version.

       •   Unknown advice '&lt;advice&gt;'

           You gave advise an advice it didn't know. This is either a typo or a portability issue. This  warning
           is only given when "use warnings 'portable'" is in effect.

       •   Syncing a readonly map makes no sense

           "sync"  flushes  changes to the map to the filesystem. This obviously is of little use when you can't
           change the map. This warning is only given when "use warnings 'io'" is in effect.

       •   Can't overwrite an empty map

           Overwriting an empty map is rather nonsensical, hence a warning is given when  this  is  tried.  This
           warning is only given when "use warnings 'substr'" is in effect.

</pre><h4><b>DEPENDENCIES</b></h4><pre>
       This  module  depends  on  perl  5.8  and Sub::Exporter::Progressive. Perl 5.8.8 or higher is recommended
       because older versions can give spurious warnings.

       In perl versions before 5.11.5 many string functions  including  "substr"  are  limited  to  32bit  logic
       &lt;<a href="http://rt.perl.org/rt3//Public/Bug/Display.html">http://rt.perl.org/rt3//Public/Bug/Display.html</a>?id=72784&gt;, even on 64bit architectures. Effectively this
       means  you  can't  use  them  on strings bigger than 2GB. If you are working with such large files, it is
       strongly recommended to upgrade to 5.12.

       In perl versions before 5.17.5, there is an off-by-one bug in Perl's regexp  engine,  as  explained  here
       &lt;<a href="http://rt.perl.org/rt3//Public/Bug/Display.html">http://rt.perl.org/rt3//Public/Bug/Display.html</a>?id=73542&gt;.  If  the  length  of  the  file  is  an exact
       multiple of the page size, some regexps can trigger a segmentation fault.

</pre><h4><b>PITFALLS</b></h4><pre>
       •   This module doesn't do any encoding or newline transformation for you, and will reject any filehandle
           with such features enabled as mapping it would return a different value  than  reading  it  normally.
           Most  importantly  this  means  that  on  Windows you have to remember to use the ":raw" open mode or
           binmode to make your filehandles binary before mapping  them,  as  by  default  it  would  do  "crlf"
           transformation. See PerlIO for more information on how that works.

       •   You can map a ":utf8" filehandle, but writing to it may be tricky. Hic sunt dracones.

       •   You  probably  don't  want  to  use "&gt;" as a mode. This does not give you reading permissions on many
           architectures, resulting in segmentation faults when trying to read a variable (confusingly, it  will
           work on some others like x86).

</pre><h4><b>BUGS</b> <b>AND</b> <b>LIMITATIONS</b></h4><pre>
       As any piece of software, bugs are likely to exist here. Bug reports are welcome.

       Please report any bugs or feature requests to "bug-file-map at rt.cpan.org", or through the web interface
       at  &lt;<a href="http://rt.cpan.org/NoAuth/ReportBug.html">http://rt.cpan.org/NoAuth/ReportBug.html</a>?Queue=File-Map&gt;.   I  will  be  notified,  and  then you'll
       automatically be notified of progress on your bug as I make changes.

       Unicode file mappings are known to be buggy on perl 5.8.7 and lower.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       •   Sys::Mmap, the original Perl mmap module

       •   <b><a href="../man2/mmap.2.html">mmap</a></b>(2), your mmap man page

       •   Win32::MMF

       •   CreateFileMapping at MSDN: &lt;<a href="http://msdn.microsoft.com/en-us/library/aa366537">http://msdn.microsoft.com/en-us/library/aa366537</a>(VS.85).aspx&gt;

</pre><h4><b>AUTHOR</b></h4><pre>
       Leon Timmermans &lt;<a href="mailto:fawaka@gmail.com">fawaka@gmail.com</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       This software is copyright (c) 2008 by Leon Timmermans.

       This is free software; you can redistribute it and/or modify it under  the  same  terms  as  the  Perl  5
       programming language system itself.

perl v5.40.1                                       2025-03-07                                     <u>File::<a href="../man3pm/Map.3pm.html">Map</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>