<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyrus::Annotator::Daemon - framework for writing annotator daemons for Cyrus</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcyrus-imap-perl">libcyrus-imap-perl_3.10.2-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Cyrus::Annotator::Daemon - framework for writing annotator daemons for Cyrus

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use warnings;
         use strict;
         package MyAnnotatorDaemon;
         use Cyrus::Annotator::Daemon;
         our @ISA = qw(Cyrus::Annotator::Daemon);

         sub annotate_message
         {
             my ($self, $message) = @_;

             $message-&gt;set_flag('\Flagged');
             $message-&gt;set_shared_annotation('/comment', 'Hello!!');
         }

         MyAnnotatorDaemon-&gt;run();

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module provides a framework for writing daemons which can be used to add annotations or flags to
       messages which are delivered into the Cyrus mail server.

       To use Cyrus::Annotator::Daemon, write a Perl script which creates an object derived from it; see the
       Synopsis above.  Run this script as root, and it will daemonize itself.  Then add this line to the
       imapd.conf file

         annotation_callout: /var/run/annotatord.socket

       and restart Cyrus.

</pre><h4><b>METHODS</b></h4><pre>
       Cyrus::Annotator::Daemon has the following methods.

       <u>run(...options...)</u>
           This  class method can be used to create an instance of Cyrus::Annotator::Daemon and to run it's main
           loop.  Note that Cyrus::Annotator::Daemon derives from Net::Server, and any of that module's  options
           can be used.

           For example:

             MyAnnotatorDaemon-&gt;run(personality =&gt; 'Fork');

           Cyrus::Annotator::Daemon changes some of the Net::Server defaults, including:

           •   Logging is to syslog using facility <u>local6</u>.

           •   The network socket is a <u>SOCK_STREAM</u> UNIX domain socket bound to <u>/var/run/annotatord.socket</u>.

           •   A PID file is written to <u>/var/run/annotatord.pid</u>.

           •   The daemon runs in the background, as user <u>cyrus</u> and group <u>mail</u>.

       <u>annotate_message($message)</u>
           You  need  to provide a method of this name.  It will be called whenever Cyrus notifies the annotator
           daemon that a new message is available, and may set or clear any flags  (system  or  user  flags)  or
           annotations.   Note that to set any annotations which aren't builtin to Cyrus, you will first need to
           configure them using <u>annotation_definitions</u> option in the <u>imapd.conf</u> file.

           The <u>$message</u> object is a Cyrus::Annotator::Message which can be examined,  and  on  which  flags  and
           annotations can be set.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>Net::Server</u>, <b><a href="../man5/imapd.conf.5.html">imapd.conf</a></b>(5), <u>RFC3501</u>, <u>RFC5257</u>.

</pre><h4><b>AUTHOR</b></h4><pre>
       Greg Banks &lt;<a href="mailto:gnb@fastmail.fm">gnb@fastmail.fm</a>&gt;.

perl v5.40.1                                       2025-06-27                                        <u><a href="../man3pm/Daemon.3pm.html">Daemon</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>