<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail::DKIM::Signature - represents a DKIM-Signature header</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmail-dkim-perl">libmail-dkim-perl_1.20230212-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Mail::DKIM::Signature - represents a DKIM-Signature header

</pre><h4><b>VERSION</b></h4><pre>
       version 1.20230212

</pre><h4><b>CONSTRUCTORS</b></h4><pre>
   <b>new()</b> <b>-</b> <b>create</b> <b>a</b> <b>new</b> <b>signature</b> <b>from</b> <b>parameters</b>
         my $signature = Mail::DKIM::Signature-&gt;new(
                             [ Algorithm =&gt; 'rsa-sha1', ]
                             [ Signature =&gt; $base64, ]
                             [ Method =&gt; 'relaxed', ]
                             [ Domain =&gt; 'example.org', ]
                             [ Identity =&gt; '<a href="mailto:user@example.org">user@example.org</a>', ]
                             [ Headers =&gt; 'from:subject:date:message-id', ]
                             [ Query =&gt; 'dns', ]
                             [ Selector =&gt; 'alpha', ]
                             [ Timestamp =&gt; time(), ]
                             [ Expiration =&gt; time() + 86400, ]
                         );

   <b>parse()</b> <b>-</b> <b>create</b> <b>a</b> <b>new</b> <b>signature</b> <b>from</b> <b>a</b> <b>DKIM-Signature</b> <b>header</b>
         my $sig = Mail::DKIM::Signature-&gt;parse(
                         'DKIM-Signature: a=rsa-sha1; b=yluiJ7+0=; c=relaxed'
                   );

       Constructs a signature by parsing the provided DKIM-Signature header content. You do not have to include
       the header name (i.e. "DKIM-Signature:") but it is recommended, so the header name can be preserved and
       returned the same way in <b>as_string()</b>.

       Note: The input to this constructor is in the same format as the output of the as_string method.

</pre><h4><b>METHODS</b></h4><pre>
   <b>algorithm()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>algorithm</b> <b>(a=)</b> <b>field</b>
       The algorithm used to generate the signature. Should be either "rsa-sha1", an RSA-signed SHA-1 digest, or
       "rsa-sha256", an RSA-signed SHA-256 digest.

       See also <b>hash_algorithm()</b>.

   <b>as_string()</b> <b>-</b> <b>the</b> <b>signature</b> <b>header</b> <b>as</b> <b>a</b> <b>string</b>
         print $signature-&gt;as_string . "\n";

       outputs

         DKIM-Signature: a=rsa-sha1; b=yluiJ7+0=; c=relaxed

       As shown in the example, the as_string method can be used to generate the DKIM-Signature that gets
       prepended to a signed message.

   <b>as_string_without_data()</b> <b>-</b> <b>signature</b> <b>without</b> <b>the</b> <b>signature</b> <b>data</b>
         print $signature-&gt;as_string_without_data . "\n";

       outputs

         DKIM-Signature: a=rsa-sha1; b=; c=relaxed

       This is similar to the <b>as_string()</b> method, but it always excludes the "data" part. This is used by the
       DKIM canonicalization methods, which require incorporating this part of the signature into the signed
       message.

   <b>body_count()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>body</b> <b>count</b> <b>(l=)</b> <b>field</b>
         my $i = $signature-&gt;body_count;

       Informs the verifier of the number of bytes in the body of the email included in the cryptographic hash,
       starting from 0 immediately following the CRLF preceding the body. Also known as the l= tag.

       When creating a signature, this tag may be either omitted, or set after the selected canonicalization
       system has received the entire message body (but before it canonicalizes the DKIM-Signature).

   <b>body_hash()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>body</b> <b>hash</b> <b>(bh=)</b> <b>field</b>
         my $bh = $signature-&gt;body_hash;

       The hash of the body part of the message. Whitespace is ignored in this value. This tag is required.

       When accessing this value, whitespace is stripped from the tag for you.

   <b>canonicalization()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>canonicalization</b> <b>(c=)</b> <b>field</b>
         $signature-&gt;canonicalization('relaxed', 'simple');

         ($header, $body) = $signature-&gt;canonicalization;

       Message canonicalization (default is "simple/simple"). This informs the verifier of the type of
       canonicalization used to prepare the message for signing.

       In scalar context, this returns header/body canonicalization as a single string separated by <a href="file:/.">/.</a> In list
       context, it returns a two element array, containing first the header canonicalization, then the body.

   <b>data()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>signature</b> <b>data</b> <b>(b=)</b> <b>field</b>
         my $base64 = $signature-&gt;data;
         $signature-&gt;data($base64);

       The signature data. Whitespace is automatically stripped from the returned value. The data is
       Base64-encoded.

   <b>domain()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>domain</b> <b>(d=)</b> <b>field</b>
         my $d = $signature-&gt;domain;          # gets the domain value
         $signature-&gt;domain('example.org');   # sets the domain value

       The domain of the signing entity, as specified in the signature.  This is the domain that will be queried
       for the public key.

       If using an "internationalized domain name", the domain name must be converted to ASCII (following
       section 4.1 of RFC 3490) before passing it to this method.

   <b>expiration()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>signature</b> <b>expiration</b> <b>(x=)</b> <b>field</b>
       Signature expiration (default is undef, meaning no expiration).  The signature expiration, if defined, is
       an unsigned integer identifying the standard Unix seconds-since-1970 time when the signature will expire.

   <b>get_public_key()</b> <b>-</b> <b>fetches</b> <b>the</b> <b>public</b> <b>key</b> <b>referenced</b> <b>by</b> <b>this</b> <b>signature</b>
         my $pubkey = $signature-&gt;get_public_key;

       Public key to fetch is determined by the protocol, selector, and domain fields.

       This method caches the result of the fetch, so subsequent calls will not require additional DNS queries.

       This method will "die" if an error occurs.

   <b>get_tag()</b> <b>-</b> <b>access</b> <b>the</b> <b>raw</b> <b>value</b> <b>of</b> <b>a</b> <b>tag</b> <b>in</b> <b>this</b> <b>signature</b>
         my $raw_identity = $signature-&gt;get_tag('i');

       Use this method to access a tag not already supported by Mail::DKIM, or if you want to bypass decoding of
       the value by Mail::DKIM.

       For example, the raw i= (identity) tag is encoded in quoted-printable form. If you use the <b>identity()</b>
       method, Mail::DKIM will decode from quoted-printable before returning the value. But if you use
       get_tag('i'), you can access the encoded quoted-printable form of the value.

   <b>hash_algorithm()</b> <b>-</b> <b>access</b> <b>the</b> <b>hash</b> <b>algorithm</b> <b>specified</b> <b>in</b> <b>this</b> <b>signature</b>
         my $hash = $signature-&gt;hash_algorithm;

       Determines what hashing algorithm is used as part of the signature's specified algorithm.

       For algorithm "rsa-sha1", the hash algorithm is "sha1". Likewise, for algorithm "rsa-sha256", the hash
       algorithm is "sha256". If the algorithm is not recognized, undef is returned.

   <b>headerlist()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>signed</b> <b>header</b> <b>fields</b> <b>(h=)</b> <b>field</b>
         $signature-&gt;headerlist('a:b:c');

         my $headerlist = $signature-&gt;headerlist;

         my @headers = $signature-&gt;headerlist;

       Signed header fields. A colon-separated list of header field names that identify the header fields
       presented to the signing algorithm.

       In scalar context, the list of header field names will be returned as a single string, with the names
       joined together with colons.  In list context, the header field names will be returned as a list.

   <b>identity()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>signing</b> <b>identity</b> <b>(i=)</b> <b>field</b>
         my $i = $signature-&gt;identity;

       Identity of the user or agent on behalf of which this message is signed.  The identity has an optional
       local part, followed by "@", then a domain name. The domain name should be the same as or a subdomain of
       the domain returned by the "domain" method.

       Ideally, the identity should match the identity listed in the From: header, or the Sender: header, but
       this is not required to have a valid signature. Whether the identity used is "authorized" to sign for the
       given message is not determined here.

       If using an "internationalized domain name", the domain name must be converted to ASCII (following
       section 4.1 of RFC 3490) before passing it to this method.

       Identity values are encoded in the signature in quoted-printable format.  Using this method will
       translate to/from quoted-printable as necessary.  If you want the raw quoted-printable version of the
       identity, use $signature-&gt;get_tag('i').

   <b>key()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>private</b> <b>key</b> <b>object</b>
         my $key = $signature-&gt;key;

         $signature-&gt;key(Mail::DKIM::PrivateKey-&gt;load(File =&gt; 'private.key'));

       The private key is used for signing messages.  It is not used for verifying messages.

       The key object can be any object that implements the <b>sign_digest()</b> method.  (Providing your own object
       can be useful if your actual keys are stored out-of-process.)

   <b>method()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>canonicalization</b> <b>(c=)</b> <b>field</b>
       Message canonicalization (default is "simple"). This informs the verifier of the type of canonicalization
       used to prepare the message for signing.

   <b>protocol()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>query</b> <b>methods</b> <b>(q=)</b> <b>field</b>
       A colon-separated list of query methods used to retrieve the public key (default is "dns"). Each query
       method is of the form "type[/options]", where the syntax and semantics of the options depends on the
       type.

   <b>result()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>verification</b> <b>result</b>
         my $result = $signature-&gt;result;

         $signature-&gt;result('pass');

         # to set the result with details
         $signature-&gt;result('invalid', 'no public key');

   <b>result_detail()</b> <b>-</b> <b>access</b> <b>the</b> <b>result,</b> <b>plus</b> <b>details</b> <b>if</b> <b>available</b>
         my $detail = $signature-&gt;result_detail;

       An explanation of possible detail messages can be found in the documentation for "<b>result_detail()</b>" in
       Mail::DKIM::Verifier.

   <b>selector()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>selector</b> <b>(s=)</b> <b>field</b>
       The selector subdivides the namespace for the "d=" (domain) tag.

   <b>prettify()</b> <b>-</b> <b>alters</b> <b>the</b> <b>signature</b> <b>to</b> <b>look</b> <b>"nicer"</b> <b>as</b> <b>an</b> <b>email</b> <b>header</b>
         $signature-&gt;prettify;

       This method may alter the signature in a way that breaks signatures, so it should be done ONLY when the
       signature is being generated, BEFORE being fed to the canonicalization algorithm.

       See also <b>prettify_safe()</b>, which will not break signatures.

   <b>prettify_safe()</b> <b>-</b> <b>same</b> <b>as</b> <b>prettify()</b> <b>but</b> <b>only</b> <b>touches</b> <b>the</b> <b>b=</b> <b>part</b>
         $signature-&gt;prettify_safe;

       This method will not break the signature, but it only affects the b= part of the signature.

   <b>timestamp()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>signature</b> <b>timestamp</b> <b>(t=)</b> <b>field</b>
       Signature timestamp (default is undef, meaning unknown creation time).  This is the time that the
       signature was created. The value is an unsigned integer identifying the number of standard Unix
       seconds-since-1970.

   <b>version()</b> <b>-</b> <b>get</b> <b>or</b> <b>set</b> <b>the</b> <b>DKIM</b> <b>specification</b> <b>version</b> <b>(v=)</b> <b>field</b>
       This is the version of the DKIM specification that applies to this signature record.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Mail::DKIM::DkSignature for DomainKey-Signature headers

</pre><h4><b>AUTHORS</b></h4><pre>
       •   Jason Long &lt;<a href="mailto:jason@long.name">jason@long.name</a>&gt;

       •   Marc Bradshaw &lt;<a href="mailto:marc@marcbradshaw.net">marc@marcbradshaw.net</a>&gt;

       •   Bron Gondwana &lt;<a href="mailto:brong@fastmailteam.com">brong@fastmailteam.com</a>&gt; (ARC)

</pre><h4><b>THANKS</b></h4><pre>
       Work  on  ensuring  that  this  module  passes  the  ARC  test suite was generously sponsored by Valimail
       (https://www.valimail.com/)

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       •   Copyright (C) 2013 by Messiah College

       •   Copyright (C) 2010 by Jason Long

       •   Copyright (C) 2017 by Standcore LLC

       •   Copyright (C) 2020 by FastMail Pty Ltd

       This library is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself, either Perl version 5.8.6 or, at your option, any later version of Perl 5 you may have available.

perl v5.38.2                                       2024-02-27                         <u>Mail::DKIM::<a href="../man3pm/Signature.3pm.html">Signature</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>