<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mod_security - Security Audit and Trailing Functionality</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/erlang-manpages">erlang-manpages_24.2.1+dfsg-1ubuntu0.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mod_security - Security Audit and Trailing Functionality

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Security Audit and Trailing Functionality

</pre><h4><b>EXPORTS</b></h4><pre>
       <b>block_user(User,</b> <b>Port,</b> <b>Dir,</b> <b>Seconds)</b> <b>-&gt;</b> <b>true</b> <b>|</b> <b>{error,</b> <b>Reason}</b>
       <b>block_user(User,</b> <b>Address,</b> <b>Port,</b> <b>Dir,</b> <b>Seconds)</b> <b>-&gt;</b> <b>true</b> <b>|</b> <b>{error,</b> <b>Reason}</b>

              Types:

                 User = string()
                 Port = integer()
                 Address = {A,B,C,D} | string() | undefined
                 Dir = string()
                 Seconds = integer() | infinity
                 Reason = no_such_directory

              <u>block_user/4</u>  and <u>block_user/5</u> each blocks the user <u>User</u> from directory <u>Dir</u> for a specified amount
              of time.

       <b>list_auth_users(Port)</b> <b>-&gt;</b> <b>Users</b> <b>|</b> <b>[]</b>
       <b>list_auth_users(Address,</b> <b>Port)</b> <b>-&gt;</b> <b>Users</b> <b>|</b> <b>[]</b>
       <b>list_auth_users(Port,</b> <b>Dir)</b> <b>-&gt;</b> <b>Users</b> <b>|</b> <b>[]</b>
       <b>list_auth_users(Address,</b> <b>Port,</b> <b>Dir)</b> <b>-&gt;</b> <b>Users</b> <b>|</b> <b>[]</b>

              Types:

                 Port = integer()
                 Address = {A,B,C,D} | string() | undefined
                 Dir = string()
                 Users = list() = [string()]

              <u>list_auth_users/1</u>, <u>list_auth_users/2</u>, and <u>list_auth_users/3</u> each returns a list of users that  are
              currently  authenticated.  Authentications  are  stored  for <u>SecurityAuthTimeout</u> seconds, and then
              discarded.

       <b>list_blocked_users(Port)</b> <b>-&gt;</b> <b>Users</b> <b>|</b> <b>[]</b>
       <b>list_blocked_users(Address,</b> <b>Port)</b> <b>-&gt;</b> <b>Users</b> <b>|</b> <b>[]</b>
       <b>list_blocked_users(Port,</b> <b>Dir)</b> <b>-&gt;</b> <b>Users</b> <b>|</b> <b>[]</b>
       <b>list_blocked_users(Address,</b> <b>Port,</b> <b>Dir)</b> <b>-&gt;</b> <b>Users</b> <b>|</b> <b>[]</b>

              Types:

                 Port = integer()
                 Address = {A,B,C,D} | string() | undefined
                 Dir = string()
                 Users = list() = [string()]

              <u>list_blocked_users/1</u>, <u>list_blocked_users/2</u>, and <u>list_blocked_users/3</u> each returns a list of  users
              that are currently blocked from access.

       <b>unblock_user(User,</b> <b>Port)</b> <b>-&gt;</b> <b>true</b> <b>|</b> <b>{error,</b> <b>Reason}</b>
       <b>unblock_user(User,</b> <b>Address,</b> <b>Port)</b> <b>-&gt;</b> <b>true</b> <b>|</b> <b>{error,</b> <b>Reason}</b>
       <b>unblock_user(User,</b> <b>Port,</b> <b>Dir)</b> <b>-&gt;</b> <b>true</b> <b>|</b> <b>{error,</b> <b>Reason}</b>
       <b>unblock_user(User,</b> <b>Address,</b> <b>Port,</b> <b>Dir)</b> <b>-&gt;</b> <b>true</b> <b>|</b> <b>{error,</b> <b>Reason}</b>

              Types:

                 User = string()
                 Port = integer()
                 Address = {A,B,C,D} | string() | undefined
                 Dir = string()
                 Reason = term()

              <u>unblock_user/2</u>,  <u>unblock_user/3</u>,  and  <u>unblock_user/4</u>  each removes the user <u>User</u> from the list of
              blocked users for <u>Port</u> (and <u>Dir</u>).

</pre><h4><b>SECURITYCALLBACKMODULE</b></h4><pre>
       The <u>SecurityCallbackModule</u> is a user-written module that can receive events from the <u>mod_security</u>  Erlang
       web server API module. This module only exports the functions event/[4,5] which are described here.

</pre><h4><b>EXPORTS</b></h4><pre>
       <b>Module:event(What,</b> <b>Port,</b> <b>Dir,</b> <b>Data)</b> <b>-&gt;</b> <b>ignored</b>
       <b>Module:event(What,</b> <b>Address,</b> <b>Port,</b> <b>Dir,</b> <b>Data)</b> <b>-&gt;</b> <b>ignored</b>

              Types:

                 What = atom()
                 Port = integer()
                 Address = {A,B,C,D} | string()
                 Dir = string()
                 Data = [Info]
                 Info = {Name, Value}

              <u>event/4</u>  or  <u>event/5</u>  is called whenever an event occurs in the <u>mod_security</u> Erlang web server API
              module. (<u>event/4</u> is called if <u>Address</u> is undefined, otherwise <u>event/5</u>. Argument <u>What</u> specifies the
              type of event that has occurred and is one of the following reasons:

                <u>auth_fail</u>:
                  A failed user authentication.

                <u>user_block</u>:
                  A user is being blocked from access.

                <u>user_unblock</u>:
                  A user is being removed from the block list.

          <b>Note:</b>
              The event <u>user_unblock</u> is not triggered when a user is removed  from  the  block  list  explicitly
              using the <u>unblock_user</u> function.

Ericsson AB                                         inets 7.5                                 <u><a href="../man3erl/mod_security.3erl.html">mod_security</a></u>(3erl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>