<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKCS12_SAFEBAG_create_cert, PKCS12_SAFEBAG_create_crl, PKCS12_SAFEBAG_create_secret,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       PKCS12_SAFEBAG_create_cert, PKCS12_SAFEBAG_create_crl, PKCS12_SAFEBAG_create_secret,
       PKCS12_SAFEBAG_create0_p8inf, PKCS12_SAFEBAG_create0_pkcs8, PKCS12_SAFEBAG_create_pkcs8_encrypt,
       PKCS12_SAFEBAG_create_pkcs8_encrypt_ex - Create PKCS#12 safeBag objects

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/pkcs12.h&gt;

        PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_cert(X509 *x509);
        PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_crl(X509_CRL *crl);
        PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_secret(int type, int vtype,
                                                     const unsigned char* value,
                                                     int len);
        PKCS12_SAFEBAG *PKCS12_SAFEBAG_create0_p8inf(PKCS8_PRIV_KEY_INFO *p8);
        PKCS12_SAFEBAG *PKCS12_SAFEBAG_create0_pkcs8(X509_SIG *p8);
        PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_pkcs8_encrypt(int pbe_nid,
                                                            const char *pass,
                                                            int passlen,
                                                            unsigned char *salt,
                                                            int saltlen, int iter,
                                                            PKCS8_PRIV_KEY_INFO *p8inf);
        PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_pkcs8_encrypt_ex(int pbe_nid,
                                                               const char *pass,
                                                               int passlen,
                                                               unsigned char *salt,
                                                               int saltlen, int iter,
                                                               PKCS8_PRIV_KEY_INFO *p8inf,
                                                               OSSL_LIB_CTX *ctx,
                                                               const char *propq);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>PKCS12_SAFEBAG_create_cert()</b> creates a new <b>PKCS12_SAFEBAG</b> of type <b>NID_certBag</b> containing the supplied
       certificate.

       <b>PKCS12_SAFEBAG_create_crl()</b> creates a new <b>PKCS12_SAFEBAG</b> of type <b>NID_crlBag</b> containing the supplied crl.

       <b>PKCS12_SAFEBAG_create_secret()</b> creates a new <b>PKCS12_SAFEBAG</b> of type corresponding to a PKCS#12 <b>secretBag</b>.
       The <b>secretBag</b> contents are tagged as <u>type</u> with an ASN1 value of type <u>vtype</u> constructed using the bytes in
       <u>value</u> of length <u>len</u>.

       <b>PKCS12_SAFEBAG_create0_p8inf()</b> creates a new <b>PKCS12_SAFEBAG</b> of type <b>NID_keyBag</b> containing the supplied
       PKCS8 structure.

       <b>PKCS12_SAFEBAG_create0_pkcs8()</b> creates a new <b>PKCS12_SAFEBAG</b> of type <b>NID_pkcs8ShroudedKeyBag</b> containing
       the supplied PKCS8 structure.

       <b>PKCS12_SAFEBAG_create_pkcs8_encrypt()</b> creates a new <b>PKCS12_SAFEBAG</b> of type <b>NID_pkcs8ShroudedKeyBag</b> by
       encrypting the supplied PKCS8 <u>p8inf</u>.  If <u>pbe_nid</u> is 0, a default encryption algorithm is used. <u>pass</u> is
       the passphrase and <u>iter</u> is the iteration count. If <u>iter</u> is zero then a default value of 2048 is used. If
       <u>salt</u> is NULL then a salt is generated randomly.

       <b>PKCS12_SAFEBAG_create_pkcs8_encrypt_ex()</b> is identical to <b>PKCS12_SAFEBAG_create_pkcs8_encrypt()</b> but allows
       for a library context <u>ctx</u> and property query <u>propq</u> to be used to select algorithm implementations.

</pre><h4><b>NOTES</b></h4><pre>
       <b>PKCS12_SAFEBAG_create_pkcs8_encrypt()</b> makes assumptions regarding the encoding of the given pass phrase.
       See <b><a href="../man7/passphrase-encoding.7.html">passphrase-encoding</a></b>(7) for more information.

       <b>PKCS12_SAFEBAG_create_secret()</b> was added in OpenSSL 3.0.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       All of these functions return a valid <b>PKCS12_SAFEBAG</b> structure or NULL if an error occurred.

</pre><h4><b>CONFORMING</b> <b>TO</b></h4><pre>
       IETF RFC 7292 (&lt;https://tools.ietf.org/html/rfc7292&gt;)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/PKCS12_create.3.html">PKCS12_create</a></b>(3), <b><a href="../man3/PKCS12_add_safe.3.html">PKCS12_add_safe</a></b>(3), <b><a href="../man3/PKCS12_add_safes.3.html">PKCS12_add_safes</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>PKCS12_SAFEBAG_create_pkcs8_encrypt_ex()</b> was added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                   <u><a href="../man3SSL/PKCS12_SAFEBAG_CREATE_CERT.3SSL.html">PKCS12_SAFEBAG_CREATE_CERT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>