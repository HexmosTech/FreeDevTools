<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X509_LOOKUP_hash_dir, X509_LOOKUP_file, X509_LOOKUP_store, X509_load_cert_file_ex, X509_load_cert_file,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       X509_LOOKUP_hash_dir, X509_LOOKUP_file, X509_LOOKUP_store, X509_load_cert_file_ex, X509_load_cert_file,
       X509_load_crl_file, X509_load_cert_crl_file_ex, X509_load_cert_crl_file - Default OpenSSL certificate
       lookup methods

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/x509_vfy.h&gt;

        X509_LOOKUP_METHOD *X509_LOOKUP_hash_dir(void);
        X509_LOOKUP_METHOD *X509_LOOKUP_file(void);
        X509_LOOKUP_METHOD *X509_LOOKUP_store(void);

        int X509_load_cert_file_ex(X509_LOOKUP *ctx, const char *file, int type,
                                   OSSL_LIB_CTX *libctx, const char *propq);
        int X509_load_cert_file(X509_LOOKUP *ctx, const char *file, int type);
        int X509_load_crl_file(X509_LOOKUP *ctx, const char *file, int type);
        int X509_load_cert_crl_file_ex(X509_LOOKUP *ctx, const char *file, int type,
                                       OSSL_LIB_CTX *libctx, const char *propq);
        int X509_load_cert_crl_file(X509_LOOKUP *ctx, const char *file, int type);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>X509_LOOKUP_hash_dir</b> and <b>X509_LOOKUP_file</b> are two certificate lookup methods to use with <b>X509_STORE</b>,
       provided by OpenSSL library.

       Users of the library typically do not need to create instances of these methods manually, they would be
       created automatically by <b><a href="../man3/X509_STORE_load_locations.3.html">X509_STORE_load_locations</a></b>(3) or <b><a href="../man3/SSL_CTX_load_verify_locations.3.html">SSL_CTX_load_verify_locations</a></b>(3) functions.

       Internally loading of certificates and CRLs is implemented via functions <b>X509_load_cert_crl_file</b>,
       <b>X509_load_cert_file</b> and <b>X509_load_crl_file</b>. These functions support parameter <u>type</u>, which can be one of
       constants <b>FILETYPE_PEM</b>, <b>FILETYPE_ASN1</b> and <b>FILETYPE_DEFAULT</b>. They load certificates and/or CRLs from
       specified file into memory cache of <b>X509_STORE</b> objects which given <b>ctx</b> parameter is associated with.

       Functions <b>X509_load_cert_file</b> and <b>X509_load_crl_file</b> can load both PEM and DER formats depending of type
       value. Because DER format cannot contain more than one certificate or CRL object (while PEM can contain
       several concatenated PEM objects) <b>X509_load_cert_crl_file</b> with <b>FILETYPE_ASN1</b> is equivalent to
       <b>X509_load_cert_file</b>.

       Constant <b>FILETYPE_DEFAULT</b> with NULL filename causes these functions to load default certificate store
       file (see <b><a href="../man3/X509_STORE_set_default_paths.3.html">X509_STORE_set_default_paths</a></b>(3).

       Functions return number of objects loaded from file or 0 in case of error.

       Both methods support adding several certificate locations into one <b>X509_STORE</b>.

       This page documents certificate store formats used by these methods and caching policy.

   <b>File</b> <b>Method</b>
       The <b>X509_LOOKUP_file</b> method loads all the certificates or CRLs present in a file into memory at the time
       the file is added as a lookup source.

       File format is ASCII text which contains concatenated PEM certificates and CRLs.

       This method should be used by applications which work with a small set of CAs.

   <b>Hashed</b> <b>Directory</b> <b>Method</b>
       <b>X509_LOOKUP_hash_dir</b> is a more advanced method, which loads certificates and CRLs on demand, and caches
       them in memory once they are loaded. As of OpenSSL 1.0.0, it also checks for newer CRLs upon each lookup,
       so that newer CRLs are as soon as they appear in the directory.

       The directory should contain one certificate or CRL per file in PEM format, with a filename of the form
       <u>hash</u>.<u>N</u> for a certificate, or <u>hash</u>.<b>r</b><u>N</u> for a CRL.  The <u>hash</u> is the value returned by the
       <b><a href="../man3/X509_NAME_hash_ex.3.html">X509_NAME_hash_ex</a></b>(3) function applied to the subject name for certificates or issuer name for CRLs.  The
       hash can also be obtained via the <b>-hash</b> option of the <b><a href="../man1/openssl-x509.1.html">openssl-x509</a></b>(1) or <b><a href="../man1/openssl-crl.1.html">openssl-crl</a></b>(1) commands.

       The .<u>N</u> or .<b>r</b><u>N</u> suffix is a sequence number that starts at zero, and is incremented consecutively for each
       certificate or CRL with the same <u>hash</u> value.  Gaps in the sequence numbers are not supported, it is
       assumed that there are no more objects with the same hash beyond the first missing number in the
       sequence.

       Sequence numbers make it possible for the directory to contain multiple certificates with same subject
       name hash value.  For example, it is possible to have in the store several certificates with same subject
       or several CRLs with same issuer (and, for example, different validity period).

       When checking for new CRLs once one CRL for given hash value is loaded, hash_dir lookup method checks
       only for certificates with sequence number greater than that of the already cached CRL.

       Note that the hash algorithm used for subject name hashing changed in OpenSSL 1.0.0, and all certificate
       stores have to be rehashed when moving from OpenSSL 0.9.8 to 1.0.0.

       OpenSSL includes a <b><a href="../man1/openssl-rehash.1.html">openssl-rehash</a></b>(1) utility which creates symlinks with hashed names for all files with
       <u>.pem</u> suffix in a given directory.

   <b>OSSL_STORE</b> <b>Method</b>
       <b>X509_LOOKUP_store</b> is a method that allows access to any store of certificates and CRLs through any loader
       supported by <b><a href="../man7/ossl_store.7.html">ossl_store</a></b>(7).  It works with the help of URIs, which can be direct references to
       certificates or CRLs, but can also be references to catalogues of such objects (that behave like
       directories).

       This method overlaps the "File Method" and "Hashed Directory Method" because of the 'file:' scheme
       loader.  It does no caching of its own, but can use a caching <b><a href="../man7/ossl_store.7.html">ossl_store</a></b>(7) loader, and therefore depends
       on the loader's capability.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>X509_LOOKUP_hash_dir()</b>, <b>X509_LOOKUP_file()</b> and <b>X509_LOOKUP_store()</b> always return a valid
       <b>X509_LOOKUP_METHOD</b> structure.

       <b>X509_load_cert_file()</b>, <b>X509_load_crl_file()</b> and <b>X509_load_cert_crl_file()</b> return the number of loaded
       objects or 0 on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/PEM_read_PrivateKey.3.html">PEM_read_PrivateKey</a></b>(3), <b><a href="../man3/X509_STORE_load_locations.3.html">X509_STORE_load_locations</a></b>(3), <b><a href="../man3/SSL_CTX_load_verify_locations.3.html">SSL_CTX_load_verify_locations</a></b>(3),
       <b><a href="../man3/X509_LOOKUP_meth_new.3.html">X509_LOOKUP_meth_new</a></b>(3), <b><a href="../man7/ossl_store.7.html">ossl_store</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       The functions <b>X509_load_cert_file_ex()</b>, <b>X509_load_cert_crl_file_ex()</b> and <b>X509_LOOKUP_store()</b> were added
       in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2015-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                         <u><a href="../man3SSL/X509_LOOKUP_HASH_DIR.3SSL.html">X509_LOOKUP_HASH_DIR</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>