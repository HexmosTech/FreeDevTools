<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tracecmd_get_traceid, tracecmd_get_guest_cpumap - Manage trace session with multiple trace peers,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/trace-cmd">trace-cmd_3.3.1-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tracecmd_get_traceid, tracecmd_get_guest_cpumap - Manage trace session with multiple trace peers,
       recorded in multiple trace files.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;trace-cmd.h&gt;</b>

       unsigned long long <b>tracecmd_get_traceid</b>(struct tracecmd_input *<u>handle</u>);
       int <b>tracecmd_get_guest_cpumap</b>(struct tracecmd_input *<u>handle</u>, unsigned long long <u>trace_id</u>, const char **<u>name</u>, int *<u>vcpu_count</u>, const int **<u>cpu_pid</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This set of APIs can be used to manage a trace session with multiple trace peers, for example, tracing
       both a host and one or more guest virtual machines. The trace data of each peer from the session is
       recorded in separate trace files. Information about peers from the session is stored in the metadata of
       each trace file. These APIs use that information to extract and synchronize the trace data.

       The <b>tracecmd_get_traceid()</b> function returns the trace ID stored in the trace file metadata associated
       with <u>handle</u>. Each peer from a trace session has an ID unique for that peer and that trace session only.
       This ID is used to match multiple trace files recorded in a same trace session.

       The <b>tracecmd_get_guest_cpumap()</b> function gets the mapping of guest virtual CPUs (VCPU) to the host
       process that represents those VCPUs and is stored in the metadata of the trace file associated with
       <u>handle</u>. This information is gathered during a host-guest trace session and is stored in the host trace
       file. The <u>trace_id</u> parameter is the trace ID of the guest in this particular trace session. If a guest
       with that ID was part of that session, its VCPU to host process mapping is in the host trace file and the
       information is returned in <u>name</u>, <u>vcpu_count</u> and <u>cpu_pid</u> parameters. The <u>name</u> parameter contains the name
       of the guest, the <u>vcpu_count</u> contains the count of VCPUs of that guest and the <u>cpu_pid</u> array contains the
       VCPU to host process mapping. The array is of size <u>vcpu_count</u> where the index is VCPU and the value is
       the process ID (PID) of the host process, running that VCPU. The <u>name</u>, <u>vcpu_count</u> and <u>cpu_pid</u> values must
       <b>not</b> be freed.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       The <b>tracecmd_get_traceid()</b> function returns a 64 bit trace ID.

       The <b>tracecmd_get_guest_cpumap()</b> function returns -1 in case of an error or 0 otherwise. If 0 is returned,
       then the <u>name</u>, <u>vcpu_count</u> and <u>cpu_pid</u> parameters contain the requested information.

</pre><h4><b>EXAMPLE</b></h4><pre>
           #include &lt;trace-cmd.h&gt;
           ...
           struct tracecmd_input *host = tracecmd_open("trace.dat");
                   if (!host) {
                           /* Failed to open host trace file */
                   }

           struct tracecmd_input *guest1 = tracecmd_open_head("trace-Guest1.dat");
                   if (!guest1) {
                           /* Failed to open guest1 trace file */
                   }
           struct tracecmd_input *guest2 = tracecmd_open_head("trace-Guest2.dat");
                   if (!guest2) {
                           /* Failed to open guest2 trace file */
                   }

           unsigned long long guest_id_1 = tracecmd_get_traceid(guest1);
           unsigned long long guest_id_2 = tracecmd_get_traceid(guest2);
           int *cpu_pid_1, *cpu_pid_2;
           int vcount_1, vcount_2;
           char *name_1, *name_2;

                   if (!tracecmd_get_guest_cpumap(host, guest_id_1, &amp;name_1, &amp;vcount_1, &amp;cpu_pid_1)) {
                           /* The Host and a guest1 with name_1 are part of the same trace session.
                            * Got guest1 VCPU to host PID mapping.
                            */
                   }
                   if (!tracecmd_get_guest_cpumap(host, guest_id_2, &amp;name_2, &amp;vcount_2, &amp;cpu_pid_2)) {
                           /* The Host and a guest2 with name_2 are part of the same trace session.
                            * Got guest2 VCPU to host PID mapping.
                            */
                   }
           ...
                   tracecmd_close(guest1);
                   tracecmd_close(guest2);
                   tracecmd_close(handle);

</pre><h4><b>FILES</b></h4><pre>
           <b>trace-cmd.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>-ltracecmd</b>
                   Linker switch to add when building a program that uses the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libtracefs.3.html">libtracefs</a>(3)</b>, <b><a href="../man3/libtraceevent.3.html">libtraceevent</a>(3)</b>, <b><a href="../man1/trace-cmd.1.html">trace-cmd</a>(1)</b> <b><a href="../man5/trace-cmd.dat.5.html">trace-cmd.dat</a>(5)</b>

</pre><h4><b>AUTHOR</b></h4><pre>
           <b>Steven</b> <b>Rostedt</b> &lt;<b><a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a></b>[1]&gt;
           <b>Tzvetomir</b> <b>Stoyanov</b> &lt;<b><a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a></b>[2]&gt;

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<b><a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a></b>[3]&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       libtracecmd is Free Software licensed under the GNU LGPL 2.1

</pre><h4><b>RESOURCES</b></h4><pre>
       <b>https://git.kernel.org/pub/scm/utils/trace-cmd/trace-cmd.git/</b>

</pre><h4><b>COPYING</b></h4><pre>
       Copyright (C) 2020 VMware, Inc. Free use of this software is granted under the terms of the GNU Public
       License (GPL).

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a>
           <a href="mailto:rostedt@goodmis.org">mailto:rostedt@goodmis.org</a>

        2. <a href="mailto:tz.stoyanov@gmail.com">tz.stoyanov@gmail.com</a>
           <a href="mailto:tz.stoyanov@gmail.com">mailto:tz.stoyanov@gmail.com</a>

        3. <a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a>
           <a href="mailto:linux-trace-devel@vger.kernel.org">mailto:linux-trace-devel@vger.kernel.org</a>

libtracefs                                         06/23/2025                                     <u><a href="../man3/LIBTRACECMD.3.html">LIBTRACECMD</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>