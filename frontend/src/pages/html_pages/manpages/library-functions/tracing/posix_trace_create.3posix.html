<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-posix-dev">manpages-posix-dev_2017a-2_all</a> <br><br><pre>
</pre><h4><b>PROLOG</b></h4><pre>
       This  manual  page  is part of the POSIX Programmer's Manual.  The Linux implementation of this interface
       may differ (consult the corresponding Linux manual page for details of Linux behavior), or the  interface
       may not be implemented on Linux.

</pre><h4><b>NAME</b></h4><pre>
       posix_trace_create,  posix_trace_create_withlog,  posix_trace_flush,  posix_trace_shutdown — trace stream
       initialization, flush, and shutdown from a process (<b>TRACING</b>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;sys/types.h&gt;
       #include &lt;trace.h&gt;

       int posix_trace_create(pid_t <u>pid</u>,
           const trace_attr_t *restrict <u>attr</u>,
           trace_id_t *restrict <u>trid</u>);
       int posix_trace_create_withlog(pid_t <u>pid</u>,
           const trace_attr_t *restrict <u>attr</u>, int <u>file_desc</u>,
           trace_id_t *restrict <u>trid</u>);
       int posix_trace_flush(trace_id_t <u>trid</u>);
       int posix_trace_shutdown(trace_id_t <u>trid</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <u>posix_trace_create</u>() function shall create an active trace stream. It  allocates  all  the  resources
       needed  by the trace stream being created for tracing the process specified by <u>pid</u> in accordance with the
       <u>attr</u> argument. The <u>attr</u> argument represents the initial attributes of the trace  stream  and  shall  have
       been  initialized  by the function <u>posix_trace_attr_init</u>() prior to the <u>posix_trace_create</u>() call. If the
       argument <u>attr</u> is NULL, the default attributes  shall  be  used.  The  <u>attr</u>  attributes  object  shall  be
       manipulated  through  a  set  of  functions described in the <u>posix_trace_attr</u> family of functions. If the
       attributes of the object pointed to by <u>attr</u> are modified later, the attributes of the trace stream  shall
       not  be affected. The <u>creation-time</u> attribute of the newly created trace stream shall be set to the value
       of the system clock, if the Timers option is not supported, or to the value of the CLOCK_REALTIME  clock,
       if the Timers option is supported.

       The  <u>pid</u> argument represents the target process to be traced. If the process executing this function does
       not have appropriate privileges to trace the process identified by <u>pid</u>, an error shall  be  returned.  If
       the <u>pid</u> argument is zero, the calling process shall be traced.

       The  <u>posix_trace_create</u>() function shall store the trace stream identifier of the new trace stream in the
       object pointed to by the <u>trid</u> argument. This trace stream identifier shall be used in subsequent calls to
       control tracing. The <u>trid</u> argument may only be used by the following functions:
       <u>posix_trace_clear</u>()                      <u>posix_trace_getnext_event</u>()
       <u>posix_trace_eventid_equal</u>()              <u>posix_trace_shutdown</u>()
       <u>posix_trace_eventid_get_name</u>()           <u>posix_trace_start</u>()
       <u>posix_trace_eventtypelist_getnext_id</u>()   <u>posix_trace_stop</u>()
       <u>posix_trace_eventtypelist_rewind</u>()       <u>posix_trace_timedgetnext_event</u>()
       <u>posix_trace_get_attr</u>()                   <u>posix_trace_trid_eventid_open</u>()
       <u>posix_trace_get_status</u>()                 <u>posix_trace_trygetnext_event</u>()

       If the Trace Event Filter option is supported, the  following  additional  functions  may  use  the  <u>trid</u>
       argument:
       <u>posix_trace_get_filter</u>()   <u>posix_trace_set_filter</u>()

       In  particular,  notice  that  the  operations  normally  used  by  a  trace  analyzer  process,  such as
       <u>posix_trace_rewind</u>() or <u>posix_trace_close</u>(), cannot be invoked using the trace stream identifier returned
       by the <u>posix_trace_create</u>() function.

       A trace stream shall be created in a suspended state.  If the Trace Event Filter option is supported, its
       trace event type filter shall be empty.

       The <u>posix_trace_create</u>() function may be called multiple times from the same or different processes, with
       the system-wide limit indicated by the runtime invariant value {TRACE_SYS_MAX},  which  has  the  minimum
       value {_POSIX_TRACE_SYS_MAX}.

       The  trace  stream identifier returned by the <u>posix_trace_create</u>() function in the argument pointed to by
       <u>trid</u> is valid only in the process that made the function call. If it is used from another  process,  that
       is  a  child  process,  in functions defined in POSIX.1‐2008, these functions shall return with the error
       <b>[EINVAL]</b>.

       The <u>posix_trace_create_withlog</u>() function shall be equivalent to  <u>posix_trace_create</u>(),  except  that  it
       associates  a trace log with this stream. The <u>file_desc</u> argument shall be the file descriptor designating
       the trace log destination. The function shall fail if this file descriptor refers to a file with  a  file
       type  that  is  not  compatible  with  the  log  policy  associated  with  the trace log. The list of the
       appropriate file types that are compatible with each log policy is implementation-defined.

       The <u>posix_trace_create_withlog</u>() function shall return in the parameter pointed  to  by  <u>trid</u>  the  trace
       stream  identifier,  which  uniquely  identifies  the  newly  created  trace stream, and shall be used in
       subsequent calls to control tracing. The <u>trid</u> argument may only be used by the following functions:
       <u>posix_trace_clear</u>()                      <u>posix_trace_get_status</u>()
       <u>posix_trace_eventid_equal</u>()              <u>posix_trace_getnext_event</u>()
       <u>posix_trace_eventid_get_name</u>()           <u>posix_trace_shutdown</u>()
       <u>posix_trace_eventtypelist_getnext_id</u>()   <u>posix_trace_start</u>()
       <u>posix_trace_eventtypelist_rewind</u>()       <u>posix_trace_stop</u>()
       <u>posix_trace_flush</u>()                      <u>posix_trace_timedgetnext_event</u>()
       <u>posix_trace_get_attr</u>()                   <u>posix_trace_trid_eventid_open</u>()

       If the Trace Event Filter option is supported, the  following  additional  functions  may  use  the  <u>trid</u>
       argument:
       <u>posix_trace_get_filter</u>()   <u>posix_trace_set_filter</u>()

       In  particular,  notice  that  the  operations  normally  used  by  a  trace  analyzer  process,  such as
       <u>posix_trace_rewind</u>() or <u>posix_trace_close</u>(), cannot be invoked using the trace stream identifier returned
       by the <u>posix_trace_create_withlog</u>() function.

       The <u>posix_trace_flush</u>() function shall initiate a flush operation which copies the contents of the  trace
       stream  identified  by  the  argument  <u>trid</u>  into  the  trace log associated with the trace stream at the
       creation time. If no trace log has been associated with  the  trace  stream  pointed  to  by  <u>trid</u>,  this
       function  shall  return  an  error.  The  termination  of  the  flush  operation  can  be  polled  by the
       <u>posix_trace_get_status</u>() function. During the flush operation, it shall be possible to  trace  new  trace
       events  up  to the point when the trace stream becomes full.  After flushing is completed, the space used
       by the flushed trace events shall be available for tracing new trace events.

       If flushing the trace stream causes the resulting trace log to become full, the  trace  log  full  policy
       shall be applied. If the trace <u>log-full-policy</u> attribute is set, the following occurs:

       POSIX_TRACE_UNTIL_FULL
             The trace events that have not yet been flushed shall be discarded.

       POSIX_TRACE_LOOP
             The trace events that have not yet been flushed shall be written to the beginning of the trace log,
             overwriting previous trace events stored there.

       POSIX_TRACE_APPEND
             The trace events that have not yet been flushed shall be appended to the trace log.

       The <u>posix_trace_shutdown</u>() function shall stop the tracing of trace events in the trace stream identified
       by  <u>trid</u>,  as  if <u>posix_trace_stop</u>() had been invoked. The <u>posix_trace_shutdown</u>() function shall free all
       the resources associated with the trace stream.

       The <u>posix_trace_shutdown</u>() function shall not return until all the resources associated  with  the  trace
       stream  have  been  freed. When the <u>posix_trace_shutdown</u>() function returns, the <u>trid</u> argument becomes an
       invalid trace stream identifier. A call to this function shall unconditionally deallocate  the  resources
       regardless  of  whether all trace events have been retrieved by the analyzer process.  Any thread blocked
       on one of the <u>trace_getnext_event</u>() functions (which specified this <u>trid</u>) before this call  is  unblocked
       with the error <b>[EINVAL]</b>.

       If  the  process  exits,  invokes  a  member of the <u>exec</u> family of functions, or is terminated, the trace
       streams that the process had created and that have not yet been shut down, shall  be  automatically  shut
       down as if an explicit call were made to the <u>posix_trace_shutdown</u>() function.

       For an active trace stream with log, when the <u>posix_trace_shutdown</u>() function is called, all trace events
       that have not yet been flushed to the trace log shall be flushed, as in the <u>posix_trace_flush</u>() function,
       and the trace log shall be closed.

       When  a  trace  log is closed, all the information that may be retrieved later from the trace log through
       the trace interface shall have been written to  the  trace  log.  This  information  includes  the  trace
       attributes,  the  list  of  trace event types (with the mapping between trace event names and trace event
       type identifiers), and the trace status.

       In addition, unspecified information shall be written to the trace log to  allow  detection  of  a  valid
       trace log during the <u>posix_trace_open</u>() operation.

       The <u>posix_trace_shutdown</u>() function shall not return until all trace events have been flushed.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Upon  successful  completion,  these functions shall return a value of zero. Otherwise, they shall return
       the corresponding error number.

       The <u>posix_trace_create</u>() and <u>posix_trace_create_withlog</u>() functions store  the  trace  stream  identifier
       value in the object pointed to by <u>trid</u>, if successful.

</pre><h4><b>ERRORS</b></h4><pre>
       The <u>posix_trace_create</u>() and <u>posix_trace_create_withlog</u>() functions shall fail if:

       <b>EAGAIN</b> No more trace streams can be started now.  {TRACE_SYS_MAX} has been exceeded.

       <b>EINTR</b>  The operation was interrupted by a signal. No trace stream was created.

       <b>EINVAL</b> One or more of the trace parameters specified by the <u>attr</u> parameter is invalid.

       <b>ENOMEM</b> The  implementation  does not currently have sufficient memory to create the trace stream with the
              specified parameters.

       <b>EPERM</b>  The caller does not have appropriate privileges to trace the process specified by <u>pid</u>.

       <b>ESRCH</b>  The <u>pid</u> argument does not refer to an existing process.

       The <u>posix_trace_create_withlog</u>() function shall fail if:

       <b>EBADF</b>  The <u>file_desc</u> argument is not a valid file descriptor open for writing.

       <b>EINVAL</b> The <u>file_desc</u> argument refers to a file with a file type that does  not  support  the  log  policy
              associated with the trace log.

       <b>ENOSPC</b> No  space  left on device. The device corresponding to the argument <u>file_desc</u> does not contain the
              space required to create this trace log.

       The <u>posix_trace_flush</u>() and <u>posix_trace_shutdown</u>() functions shall fail if:

       <b>EINVAL</b> The value of the <u>trid</u> argument does not correspond to an active trace stream with log.

       <b>EFBIG</b>  The trace log file has attempted to exceed an implementation-defined maximum file size.

       <b>ENOSPC</b> No space left on device.

       <u>The</u> <u>following</u> <u>sections</u> <u>are</u> <u>informative.</u>

</pre><h4><b>EXAMPLES</b></h4><pre>
       None.

</pre><h4><b>APPLICATION</b> <b>USAGE</b></h4><pre>
       None.

</pre><h4><b>RATIONALE</b></h4><pre>
       None.

</pre><h4><b>FUTURE</b> <b>DIRECTIONS</b></h4><pre>
       The <u>posix_trace_create</u>(), <u>posix_trace_create_withlog</u>(), <u>posix_trace_flush</u>(),  and  <u>posix_trace_shutdown</u>()
       functions may be removed in a future version.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u>clock_getres</u>(), <u>exec</u>, <u>posix_trace_attr_destroy</u>(), <u>posix_trace_clear</u>(), <u>posix_trace_close</u>(),
       <u>posix_trace_eventid_equal</u>(), <u>posix_trace_eventtypelist_getnext_id</u>(), <u>posix_trace_get_attr</u>(),
       <u>posix_trace_get_filter</u>(), <u>posix_trace_getnext_event</u>(), <u>posix_trace_start</u>(), <u>posix_trace_start</u>(), <u>time</u>()

       The Base Definitions volume of POSIX.1‐2017, <b>&lt;sys_types.h&gt;</b>, <b>&lt;trace.h&gt;</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1-2017, Standard
       for  Information  Technology  --  Portable  Operating  System  Interface  (POSIX),  The  Open  Group Base
       Specifications Issue 7, 2018 Edition, Copyright (C) 2018 by the Institute of Electrical  and  Electronics
       Engineers, Inc and The Open Group.  In the event of any discrepancy between this version and the original
       IEEE  and The Open Group Standard, the original IEEE and The Open Group Standard is the referee document.
       The original Standard can be obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any typographical or formatting errors that appear in this page are most likely to have  been  introduced
       during   the   conversion  of  the  source  files  to  man  page  format.  To  report  such  errors,  see
       https://www.kernel.org/doc/man-pages/reporting_bugs.html .

IEEE/The Open Group                                   2017                            <u><a href="../man3POSIX/POSIX_TRACE_CREATE.3POSIX.html">POSIX_TRACE_CREATE</a></u>(3POSIX)
</pre>
 </div>
</div></section>
</div>
</body>
</html>