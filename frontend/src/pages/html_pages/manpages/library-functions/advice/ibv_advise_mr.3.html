<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ibv_advise_mr  -  Gives  advice  or  directions  to the kernel about an address range belongs to a memory</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libibverbs-dev">libibverbs-dev_56.1-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ibv_advise_mr  -  Gives  advice  or  directions  to the kernel about an address range belongs to a memory
       region (MR).

</pre><h4><b>SYNOPSIS</b></h4><pre>
              #include &lt;infiniband/verbs.h&gt;

              int ibv_advise_mr(struct ibv_pd *pd,
                        enum ibv_advise_mr_advice advice,
                        uint32_t flags,
                        struct ibv_sge *sg_list,
                        uint32_t num_sge)

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>ibv_advise_mr()</b> Give advice or directions to the kernel about an address  range  belonging  to  a  memory
       region  (MR).   Applications  that  are  aware  of  future  access patterns can use this verb in order to
       leverage this knowledge to improve system or application performance.

       <b>Conventional</b> <b>advice</b> <b>values</b>

       <u>IBV_ADVISE_MR_ADVICE_PREFETCH</u>
              Pre-fetch a range of an on-demand paging MR.  Make pages present with read-only permission  before
              the  actual  IO is conducted.  This would provide a way to reduce latency by overlapping paging-in
              and either compute time or IO to other ranges.

       <u>IBV_ADVISE_MR_ADVICE_PREFETCH_WRITE</u>
              Like IBV_ADVISE_MR_ADVICE_PREFETCH but with read-access and write-access permission to the fetched
              memory.

       <u>IBV_ADVISE_MR_ADVICE_PREFETCH_NO_FAULT</u>
              Pre-fetch a range of an on-demand paging MR without faulting.  This allows presented pages in  the
              CPU to become presented to the device.

</pre><h4><b>ARGUMENTS</b></h4><pre>
       <u>pd</u>     The protection domain (PD) associated with the MR.

       <u>advice</u> The requested advise value (as listed above).

       <u>flags</u>  Describes    the    properties    of    the    advise   operation   <b>Conventional</b>   <b>advice</b>   <b>values</b>
              <u>IBV_ADVISE_MR_FLAG_FLUSH</u> : Request to be a synchronized operation.  Return to the caller after the
              operation is completed.

       <u>sg_list</u>
              Pointer to the s/g array When using IBV_ADVISE_OP_PREFETCH advise value, all the lkeys of all  the
              scatter  gather  elements  (SGEs)  must  be associated with ODP MRs (MRs that were registered with
              IBV_ACCESS_ON_DEMAND).

       <u>num_sge</u>
              Number of elements in the s/g array

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>ibv_advise_mr()</b> returns 0 when the call was successful, or the value of errno on failure (which indicates
       the failure reason).

       <u>EOPNOTSUPP</u>
              libibverbs or provider driver doesn’t support the ibv_advise_mr() verb (ENOSYS  may  sometimes  be
              returned by old versions of libibverbs).

       <u>ENOTSUP</u>
              The advise operation isn’t supported.

       <u>EFAULT</u> In  one  of the following: o When the range requested is out of the MR bounds, or when parts of it
              are not part of the process address space.  o One of the lkeys provided in the scatter gather list
              is invalid or with wrong write access.

       <u>EINVAL</u> In one of the following: o The PD is invalid.  o The flags are invalid.  o The  requested  address
              doesn’t belong to a MR, but a MW or something.

       <u>EPERM</u>  In  one  of  the following: o Referencing a valid lkey outside the caller’s security scope.  o The
              advice is IBV_ADVISE_MR_ADVICE_PREFETCH_WRITE but the specified MR in the scatter gather  list  is
              not registered as writable access.

       <u>ENOENT</u> The providing lkeys aren’t consistent with the MR’s.

       <u>ENOMEM</u> Not enough memory.  # NOTES

       An    application   may   pre-fetch   any   address   range   within   an   ODP   MR   when   using   the
       <b>IBV_ADVISE_MR_ADVICE_PREFETCH</b>  or   <b>IBV_ADVISE_MR_ADVICE_PREFETCH_WRITE</b>   advice.    Semantically,   this
       operation  is best-effort.  That means the kernel does not guarantee that underlying pages are updated in
       the HCA or the pre-fetched pages would remain resident.

       When using <b>IBV_ADVISE_MR_ADVICE_PREFETCH</b> or  <b>IBV_ADVISE_MR_ADVICE_PREFETCH_WRITE</b>  advice,  the  operation
       will  be  done  in the following stages: o Page in the user pages to memory (pages aren’t pinned).  o Get
       the dma mapping of these user pages.  o Post the underlying page translations to the HCA.

       If <b>IBV_ADVISE_MR_FLAG_FLUSH</b> is specified then the underlying pages are guaranteed to be  updated  in  the
       HCA  before  returning  SUCCESS.   Otherwise  the  driver  can  choose to postpone the posting of the new
       translations to the HCA.  When performing a  local  RDMA  access  operation  it  is  recommended  to  use
       IBV_ADVISE_MR_FLAG_FLUSH  flag  with  one of the pre-fetch advices to increase probability that the pages
       translations are valid in the HCA and avoid future page faults.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ibv_reg_mr.3.html">ibv_reg_mr</a></b>(3), <b><a href="../man3/ibv_rereg_mr.3.html">ibv_rereg_mr</a></b>(3), <b><a href="../man3/ibv_dereg_mr.3.html">ibv_dereg_mr</a></b>(3)

</pre><h4><b>AUTHOR</b></h4><pre>
       Aviad Yehezkel <a href="mailto:aviadye@mellanox.com">aviadye@mellanox.com</a>

libibverbs                                         2018-10-19                                   <u><a href="../man3/IBV_ADVISE_MR.3.html">IBV_ADVISE_MR</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>