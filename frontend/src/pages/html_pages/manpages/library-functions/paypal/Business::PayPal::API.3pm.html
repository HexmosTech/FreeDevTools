<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business::PayPal::API - PayPal SOAP API client with sandbox support</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libbusiness-paypal-api-perl">libbusiness-paypal-api-perl_0.77-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Business::PayPal::API - PayPal SOAP API client with sandbox support

</pre><h4><b>VERSION</b></h4><pre>
       version 0.77

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Business::PayPal::API qw( ExpressCheckout GetTransactionDetails );

           ## certificate authentication
           my $pp = Business::PayPal::API-&gt;new(
               Username       =&gt; 'my_api1.domain.tld',
               Password       =&gt; 'this_is_my_password',
               PKCS12File     =&gt; '/path/to/cert.pkcs12',
               PKCS12Password =&gt; '(pkcs12 password)',
               sandbox        =&gt; 1,
           );

           ## PEM cert authentication
           my $pp = Business::PayPal::API-&gt;new(
               Username =&gt; 'my_api1.domain.tld',
               Password =&gt; 'this_is_my_password',
               CertFile =&gt; '/path/to/cert.pem',
               KeyFile  =&gt; '/path/to/cert.pem',
               sandbox  =&gt; 1,
           );

           ## 3-token (Signature) authentication
           my $pp = Business::PayPal::API-&gt;new(
               Username =&gt; 'my_api1.domain.tld',
               Password =&gt; 'Xdkis9k3jDFk39fj29sD9',    ## supplied by PayPal
               Signature =&gt;
                   'f7d03YCpEjIF3s9Dk23F2V1C1vbYYR3ALqc7jm0UrCcYm-3ksdiDwjfSeii', ## ditto
               sandbox =&gt; 1,
           );

           my %response = $pp-&gt;SetExpressCheckout( ... );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Business::PayPal::API</b> supports both certificate authentication and the new 3-token "Signature"
       authentication.

       It also supports PayPal's development <u>sandbox</u> for testing. See the <b>sandbox</b> parameter to <b>new()</b> below for
       details.

       <b>Business::PayPal::API</b> can import other <b>API</b> derived classes:

         use Business::PayPal::API qw( RefundTransaction );

       This allows for much more concise and intuitive usage. For example, these two statements are equivalent:

         use Business::PayPal::API::RefundTransaction;
         my $pp = Business::PayPal::API::RefundTransaction-&gt;new( ... );
         $pp-&gt;RefundTransaction( ... );

       and more concisely:

         use Business::PayPal::API qw( RefundTransaction );
         my $pp = Business::PayPal::API-&gt;new( ... );
         $pp-&gt;RefundTransaction( ... );

       The advantage of this becomes clear when you need to use multiple API calls in your program; this allows
       you to use the same object to invoke the various methods, instead of creating a new object for each
       subclass. Here is an example of a <b>API</b> object used to invoke various PayPal APIs with the same object:

         use Business::PayPal::API qw( GetTransactionDetails
                                       TransactionSearch
                                       RefundTransaction );
         my $pp = Business::PayPal::API-&gt;new( ... );
         my $records = $pp-&gt;TransactionSearch( ... );

         my %details = $pp-&gt;GetTransactionDetails( ... );

         my %resp = $pp-&gt;RefundTransaction( ... );

       However, you may certainly use just the subclass if that's all you need. Every subclass should work as
       its own self-contained API.

       For details on <b>Business::PayPal::API::*</b> subclasses, see each subclass's individual documentation.

   <b>new</b>
       Creates a new <b>Business::PayPal::API</b> object.

       A note about certificate authentication: PayPal (and this module) support either PKCS#12 certificate
       authentication or PEM certificate authentication. See options below.

       <b>Username</b>
           Required.  This  is  the  PayPal API username, usually in the form of 'my_api1.mydomain.tld'. You can
           find or create your API credentials by logging into PayPal (if you want to do testing, as you should,
           you should also create a developer sandbox account) and going to:

             My Account -&gt; Profile -&gt; API Access -&gt; Request API Credentials

           Please see the <u>PayPal</u> <u>API</u> <u>Reference</u> and <u>PayPal</u> <u>Sandbox</u> <u>User</u> <u>Guide</u> for details on  creating  a  PayPal
           business account and sandbox account for testing.

       <b>Password</b>
           Required.  If  you  use  certificate authentication, this is the PayPal API password created when you
           setup your certificate. If you use 3-token (Signature) authentication, this is  the  password  PayPal
           assigned you, along with the "API User Name" and "Signature Hash".

       <b>Subject</b>
           Optional.  This  is  used  by  PayPal  to  authenticate 3rd party billers using your account. See the
           documents in "SEE ALSO".

       <b>Signature</b>
           Required for 3-token (Signature) authentication. This is the "Signature Hash" you received  when  you
           did "Request API Credentials" in your PayPal Business Account.

       <b>PKCS12File</b>
           Required for PKCS#12 certificate authentication, unless the <b>HTTPS_PKCS12_FILE</b> environment variable is
           already set.

           This  contains  the  path  to  your  private  key  for  PayPal  authentication. It is used to set the
           <b>HTTPS_PKCS12_FILE</b> environment variable. You may set this environment variable yourself and leave this
           field blank.

       <b>PKCS12Password</b>
           Required  for  PKCS#12  certificate  authentication,  unless  the  <b>HTTPS_PKCS12_PASSWORD</b>  environment
           variable is already set.

           This  contains  the  PKCS#12  password  for  the  key  specified in <b>PKCS12File</b>. It is used to set the
           <b>HTTPS_PKCS12_PASSWORD</b> environment variable. You may set this environment variable yourself and  leave
           this field blank.

       <b>CertFile</b>
           Required  for  PEM  certificate  authentication,  unless  the HTTPS_CERT_FILE environment variable is
           already set.

           This contains the path to your PEM format certificate given to you from PayPal (and accessible in the
           same location that your Username and Password and/or Signature Hash are found) and is used to set the
           <b>HTTPS_CERT_FILE</b> environment variable. You may set this environment variable yourself and  leave  this
           field blank.

           You  may  combine  both certificate and private key into one file and set <b>CertFile</b> and <b>KeyFile</b> to the
           same path.

       <b>KeyFile</b>
           Required for PEM certificate  authentication,  unless  the  HTTPS_KEY_FILE  environment  variable  is
           already set.

           This contains the path to your PEM format private key given to you from PayPal (and accessible in the
           same location that your Username and Password and/or Signature Hash are found) and is used to set the
           <b>HTTPS_KEY_FILE</b>  environment  variable.  You may set this environment variable yourself and leave this
           field blank.

           You may combine both certificate and private key into one file and set <b>CertFile</b> and  <b>KeyFile</b>  to  the
           same path.

       <b>sandbox</b>
           Required.  If  set  to  true  (default),  <b>Business::PayPal::API</b>  will connect to PayPal's development
           sandbox, instead of PayPal's live site. *You must explicitly set this to false (0) to access PayPal's
           live site*.

           If you use PayPal's development sandbox for testing, you must have already  signed  up  as  a  PayPal
           developer  and  created a Business sandbox account and a Buyer sandbox account (and make sure both of
           them have <b>Verified</b> status in the sandbox).

           When testing with the sandbox, you will use different  usernames,  passwords,  and  certificates  (if
           using  certificate  authentication)  than  you will when accessing PayPal's live site. Please see the
           PayPal documentation for details. See "SEE ALSO" for references.

           PayPal's sandbox reference:

           &lt;https://www.paypal.com/IntegrationCenter/ic_sandbox.html&gt;

       <b>proxy_url</b>
           Optional. When set, the proxy at the specified URL will be used for outbound connections.

       <b>timeout</b>
           Optional. Set the timeout in seconds. Defaults to 30 seconds.

</pre><h4><b>NAME</b></h4><pre>
       Business::PayPal::API - PayPal API

</pre><h4><b>ERROR</b> <b>HANDLING</b></h4><pre>
       Every API call should return an <b>Ack</b> response, whether <u>Success</u>, <u>Failure</u>, or otherwise  (depending  on  the
       API  call).  If it returns any non-success value, you can find an <u>Errors</u> entry in your return hash, whose
       value is an arrayref of hashrefs:

        [ { ErrorCode =&gt; 10002,
            LongMessage =&gt; "Invalid security header" },

          { ErrorCode =&gt; 10030,
            LongMessage =&gt; "Some other error" }, ]

       You can retrieve these errors like this:

         %response = $pp-&gt;doSomeAPICall();
         if( $response{Ack} ne 'Success' ) {
             for my $err ( @{$response{Errors}} ) {
                 warn "Error: " . $err-&gt;{LongMessage} . "\n";
             }
         }

</pre><h4><b>TESTING</b></h4><pre>
       Testing the <b>Business::PayPal::API::*</b> modules requires that you  create  a  file  containing  your  PayPal
       Developer   Sandbox   authentication   credentials  (e.g.,  API  certificate  authentication  or  3-Token
       authentication signature, etc.) and setting the <b>WPP_TEST</b> environment variable to point to this file.

       The format for this file is as follows:

         Username = your_api.username.com
         Password = your_api_password

       and then ONE of the following options:

         a) supply 3-token authentication signature

             Signature = xxxxxxxxxxxxxxxxxxxxxxxx

         b) supply PEM certificate credentials

             CertFile = /path/to/cert_key_pem.txt
             KeyFile  = /path/to/cert_key_pem.txt

         c) supply PKCS#12 certificate credentials

             PKCS12File = /path/to/cert.p12
             PKCS12Password = pkcs12_password

       You  may  also  set  the  appropriate  HTTPS_*  environment  variables  for  b)  and  c)   above   (e.g.,
       HTTPS_CERT_FILE,  HTTPS_KEY_FILE,  HTTPS_PKCS12_File,  HTTPS_PKCS12_PASSWORD)  in  lieu  of  putting this
       information in a file.

       Then use "WPP_TEST=my_auth.txt make test" (for Bourne shell derivates) or "setenv WPP_TEST my_auth.txt &amp;&amp;
       make test" (for C-shell derivates).

       See  'auth.sample.*'  files  in  this  package  for  an  example  of  the  file  format.  Variables   are
       case-*sensitive*.

       Any of the following variables are recognized:

         Username Password Signature Subject
         CertFile KeyFile PKCS12File PKCS12Password
         BuyerEmail

       Note:  PayPal  authentication  may  <u>fail</u>  if you set the certificate environment variables and attempt to
       connect using 3-token  authentication  (i.e.,  PayPal  will  use  the  first  authentication  credentials
       presented to it, and if they fail, the connection is aborted).

</pre><h4><b>TROUBLESHOOTING</b></h4><pre>
   <b>PayPal</b> <b>Authentication</b> <b>Errors</b>
       If  you  are  experiencing  PayPal  authentication  errors  (e.g.,  "Security  header is not valid", "SSL
       negotiation failed", etc.), you should make sure:

          * your username and password match those found in your PayPal
            Business account sandbox (this is not the same as your regular
            account).

          * you're not trying to use your live username and password for
            sandbox testing and vice versa.

          * you are using a US Business Sandbox account, you may also need to have
            "PayPal Payments Pro" enabled.

          * if the sandbox works but "live" does not, make sure you've turned
            off the 'sandbox' parameter correctly. Otherwise you'll be
            passing your PayPal sandbox credentials to PayPal's live site
            (which won't work).

          * if you use certificate authentication, your certificate must be
            the correct one (live or sandbox) depending on what you're doing.

          * if you use 3-Token authentication (i.e., Signature), you don't
            have any B&lt;PKCS12*&gt; parameters or B&lt;CertFile&gt; or B&lt;KeyFile&gt;
            parameters in your constructor AND that none of the corresponding
            B&lt;HTTPS_*&gt; environment variables are set. PayPal prefers
            certificate authentication since it occurs at connection time; if
            it fails, it will not try Signature authentication.

            Try clearing your environment:

                ## delete all HTTPS, SSL env
                delete $ENV{$_} for grep { /^(HTTPS|SSL)/ } keys %ENV;

                ## now put our own HTTPS env back in
                $ENV{HTTPS_CERT_FILE} = '/var/path/to/cert.pem';

                ## create our paypal object
                my $pp = Business::PayPal::API-&gt;new(...)

          * if you have already loaded Net::SSLeay (or IO::Socket::SSL), then
            Net::HTTPS will prefer to use IO::Socket::SSL. I don't know how
            to get SOAP::Lite to work with IO::Socket::SSL (e.g.,
            Crypt::SSLeay uses HTTPS_* environment variables), so until then,
            you can use this hack:

              local $IO::Socket::SSL::VERSION = undef;

              $pp-&gt;DoExpressCheckoutPayment(...);

            This will tell Net::HTTPS to ignore the fact that IO::Socket::SSL
            is already loaded for this scope and import Net::SSL (part of the
            Crypt::SSLeay package) for its 'configure()' method.

          * if you receive a message like "500 Can't connect to
            api.sandbox.paypal.com:443 (Illegal seek)", you'll need to make
            sure you have Crypt::SSLeay installed. It seems that other crypto
            modules don't do the certificate authentication quite as well,
            and LWP needs this to negotiate the SSL connection with PayPal.

       See the DEBUGGING section below for further hints.

   <b>PayPal</b> <b>Munging</b> <b>URLs</b>
       PayPal seems to be munging my URLs when it returns.

       SOAP::Lite follows the XML specification carefully, and encodes '&amp;' and '&lt;'  characters  before  applying
       them  to  the  SOAP document. PayPal does not properly URL-decode HTML entities '&amp;amp;' and '&amp;lt;' on the
       way back, so if you have an ampersand in your ReturnURL (for example), your customers will be  redirected
       here:

         <a href="http://domain.tld/prog">http://domain.tld/prog</a>?arg1=foo&amp;amp;arg2=bar

       instead of here:

         <a href="http://domain.tld/prog">http://domain.tld/prog</a>?arg1=foo&amp;arg2=bar

       Solution:

       Use CDATA tags to wrap your request:

         ReturnURL =&gt; '&lt;![CDATA[<a href="http://domain.tld/prog">http://domain.tld/prog</a>?arg1=foo&amp;arg2=bar]]&gt;'

       You may also use semicolons instead of ampersands to separate your URL arguments:

         ReturnURL =&gt; '<a href="http://domain.tld/prog">http://domain.tld/prog</a>?arg1=foo;arg2=bar'

       (thanks to Ollie Ready)

</pre><h4><b>DEBUGGING</b></h4><pre>
       You can see the raw SOAP XML sent and received by <b>Business::PayPal::API</b> by setting its <b>$Debug</b> variable:

         $Business::PayPal::API::Debug = 1;
         $pp-&gt;SetExpressCheckout( %args );

       this  will  print  the  XML  being sent, and dump a Perl data structure of the SOM received on STDERR (so
       check your error_log if running inside a web server).

       If anyone knows how to turn a SOAP::SOM object into XML without setting <b>outputxml()</b>, let me know.

</pre><h4><b>DEVELOPMENT</b></h4><pre>
       If you are a developer wanting to extend <b>Business::PayPal::API</b> for other PayPal API calls, you can review
       any of the included modules (e.g., <u>RefundTransaction.pm</u> or <u>ExpressCheckout.pm</u>) for examples on how to  do
       this until I have more time to write a more complete document.

       But in a nutshell:

         package Business::PayPal::API::SomeAPI;

         use 5.008001;
         use strict;
         use warnings;

         use SOAP::Lite 0.67;
         use Business::PayPal::API ();

         our @ISA = qw(Business::PayPal::API);
         our @EXPORT_OK = qw( SomeAPIMethod );

         sub SomeAPIMethod {
          ...
         }

       Notice  the  <b>@EXPORT_OK</b>  variable.  This is <u>not</u> used by <b>Exporter</b> (we don't load Exporter at all): it is a
       special variable used by <b>Business::PayPal::API</b> to know which methods to import when <b>Business::PayPal::API</b>
       is run like this:

         use Business::PayPal::API qw( SomeAPI );

       That is, <b>Business::PayPal::API</b> will import any subroutine into its  own  namespace  from  the  <b>@EXPORT_OK</b>
       array. Now it can be used like this:

         use Business::PayPal::API qw( SomeAPI );
         my $pp = Business::PayPal::API-&gt;new( ... );
         $pp-&gt;SomeAPIMethod( ... );

       Of  course, we also do a 'use Business::PayPal::API' in the module so that it can be used as a standalone
       module, if necessary:

         use Business::PayPal::API::SomeAPI;
         my $pp = Business::PayPal::API::SomeAPI-&gt;new( ... ); ## same args as superclass
         $pp-&gt;SomeAPIMethod( ... );

       Adding the <b>@EXPORT_OK</b> array in your module allows your module to be used in the most convenient  way  for
       the given circumstances.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Andy  Spiegl &lt;<a href="mailto:paypalcheckout.Spiegl@kascada.com">paypalcheckout.Spiegl@kascada.com</a>&gt; has kindly donated some example code (in German) for the
       ExpressCheckout API which may be found in the <u>eg</u> directory of this archive. Additional code examples  for
       other APIs may be found in the <u>t</u> test directory.

</pre><h4><b>EXPORT</b></h4><pre>
       None by default.

</pre><h4><b>CAVEATS</b></h4><pre>
       Because  I  haven't  figured  out  how  to  make SOAP::Lite read the WSDL definitions directly and simply
       implement those (help, anyone?), I have essentially recreated all of those WSDL structures internally  in
       this module.

       (Note  -  6 Oct 2006: SOAP::Lite's WSDL support is moving ahead, but slowly. The methods used by this API
       are considered "best practice" and are safe to use).

       As with all web services, if PayPal stop supporting their API endpoint, this module *may  stop  working*.
       You can help me keep this module up-to-date if you notice such an event occurring.

       Also,  I  didn't  implement  a big fat class hierarchy to make this module "academically" correct. You'll
       notice that I fudged colliding parameter names in <b>DoExpressCheckoutPayment</b> and  similar  fudging  may  be
       found in <b>GetTransactionDetails</b>. The good news is that this was written quickly, works, and is dead-simple
       to  use.  The  bad news is that this sort of collision might occur again as more and more data is sent in
       the API (call it 'eBay API bloat'). I'm willing to take the risk this will be rare  (PayPal--please  make
       it rare!).

</pre><h4><b>ACKNOWLEDGEMENTS</b></h4><pre>
       Wherein I acknowledge all the good folks who have contributed to this module in some way:

       •   Daniel P. Hembree

           for  authoring  the AuthorizationRequest, CaptureRequest, DirectPayments, ReauthorizationRequest, and
           VoidRequest extensions.

       •   &lt;jshiles at base16consulting daught com&gt;

           for finding some API typos in the ExpressCheckout API

       •   Andy Spiegl &lt;<a href="mailto:paypalcheckout.Spiegl@kascada.com">paypalcheckout.Spiegl@kascada.com</a>&gt;

           for giving me the heads-up on PayPal's new 3-token auth URI and for  a  sample  command-line  program
           (found in the 'eg' directory) demonstrating the ExpressCheckout API.

       •   Ollie Ready &lt;oready at drjays daught com&gt;

           for the heads-up on the newest 3-token auth URI as well as a pile of documentation inconsistencies.

       •   Michael Hendricks &lt;michael at ndrix daught org&gt;

           for a patch that adds ShippingTotal to the DirectPayments module.

       •   Erik Aronesty, Drew Simpson via rt.cpan.org (#28596)

           for a patch to fix <b>getFields()</b> when multiple items are returned

       •   Sebastian Böhm via email, SDC via rt.cpan.org (#38915)

           for  a  heads-up  that  the  PayPal  documentation  for  MassPay API was wrong regarding the <u>UniqueId</u>
           parameter.

       •   Jonathon Wright via email

           for  patches  for  <b>ExpressCheckout</b>  and  <b>RecurringPayments</b>  that   implement   <u>BillingAgreement</u>   and
           <u>DoReferenceTransaction</u> API calls.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       SOAP::Lite,  PayPal  User  Guide  &lt;https://developer.paypal.com/webapps/developer/docs/classic/products&gt;,
       PayPal API Reference &lt;https://developer.paypal.com/webapps/developer/docs/api/overview&gt;

</pre><h4><b>AUTHORS</b></h4><pre>
       •   Scott Wiersdorf &lt;<a href="mailto:scott@perlcode.org">scott@perlcode.org</a>&gt;

       •   Danny Hembree &lt;<a href="mailto:danny@dynamical.org">danny@dynamical.org</a>&gt;

       •   Bradley M. Kuhn &lt;<a href="mailto:bkuhn@ebb.org">bkuhn@ebb.org</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       This software is copyright (c) 2006-2017 by Scott Wiersdorf, Danny Hembree, Bradley M. Kuhn.

       This is free software; you can redistribute it and/or modify it under  the  same  terms  as  the  Perl  5
       programming language system itself.

perl v5.36.0                                       2022-08-28                         <u>Business::PayPal::<a href="../man3pm/API.3pm.html">API</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>