<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>grammar::me::cpu - Virtual machine implementation II for parsing token streams</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       grammar::me::cpu - Virtual machine implementation II for parsing token streams

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>grammar::me::cpu</b> <b>?0.3?</b>

       <b>::grammar::me::cpu</b> <u>meName</u> <u>matchcode</u>

       <b>meName</b> <b>option</b> ?<u>arg</u> <u>arg</u> <u>...</u>?

       <u>meName</u> <b>lc</b> <u>location</u>

       <u>meName</u> <b>tok</b> ?<u>from</u> ?<u>to</u>??

       <u>meName</u> <b>pc</b> <u>state</u>

       <u>meName</u> <b>iseof</b> <u>state</u>

       <u>meName</u> <b>at</b> <u>state</u>

       <u>meName</u> <b>cc</b> <u>state</u>

       <u>meName</u> <b>sv</b>

       <u>meName</u> <b>ok</b>

       <u>meName</u> <b>error</b>

       <u>meName</u> <b>lstk</b> <u>state</u>

       <u>meName</u> <b>astk</b> <u>state</u>

       <u>meName</u> <b>mstk</b> <u>state</u>

       <u>meName</u> <b>estk</b> <u>state</u>

       <u>meName</u> <b>rstk</b> <u>state</u>

       <u>meName</u> <b>nc</b> <u>state</u>

       <u>meName</u> <b>ast</b>

       <u>meName</u> <b>halted</b>

       <u>meName</u> <b>code</b>

       <u>meName</u> <b>eof</b>

       <u>meName</u> <b>put</b> <u>tok</u> <u>lex</u> <u>line</u> <u>col</u>

       <u>meName</u> <b>putstring</b> <u>string</u> <u>lvar</u> <u>cvar</u>

       <u>meName</u> <b>run</b> ?<u>n</u>?

       <u>meName</u> <b>pull</b> <u>nextcmd</u>

       <u>meName</u> <b>reset</b>

       <u>meName</u> <b>destroy</b>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  package  provides  an  implementation  of  the ME virtual machine.  Please go and read the document
       <b>grammar::me_intro</b> first if you do not know what a ME virtual machine is.

       This implementation provides an object-based API and the  machines  are  not  truly  tied  to  Tcl.  A  C
       implementation of the same API is quite possible.

       Internally  the  package  actually  uses the value-based machine manipulation commands as provided by the
       package <b>grammar::me::cpu::core</b> to perform its duties.

</pre><h4><b>API</b></h4><pre>
   <b>CLASS</b> <b>API</b>
       The package directly provides only a single command for the construction of ME virtual machines.

       <b>::grammar::me::cpu</b> <u>meName</u> <u>matchcode</u>
              The command creates a new ME machine object with an associated global Tcl command  whose  name  is
              <u>meName</u>.  This  command  may  be  used  to  invoke  various  operations on the machine.  It has the
              following general form:

              <b>meName</b> <b>option</b> ?<u>arg</u> <u>arg</u> <u>...</u>?
                     <u>Option</u> and the <u>arg</u>s determine the exact behavior of the command.

       The argument <u>matchcode</u> contains the match instructions the machine has to execute while parsing the input
       stream.  Please  read  section  <b>MATCH</b>  <b>CODE</b>  <b>REPRESENTATION</b>  of  the  documentation   for   the   package
       <b>grammar::me::cpu::core</b> for the specification of the structure of this value.

       The  <u>tokmap</u>  argument taken by the implementation provided by the package <b>grammar::me::tcl</b> is here hidden
       inside of the match instructions and therefore not needed.

   <b>OBJECT</b> <b>API</b>
       All ME virtual machine objects created by the class command specified in section <b>CLASS</b>  <b>API</b>  support  the
       methods listed below.

       The  machines provided by this package provide methods for operation in both push- and pull-styles. Push-
       style means that tokens are pushed into the machine state when they arrive, triggering further  execution
       until  they are consumed. In other words, this allows the machine to be suspended and resumed at will and
       an arbitrary number of times, the quasi-parallel operation of several machines, and the operation as part
       of the event loop.

       <u>meName</u> <b>lc</b> <u>location</u>
              This method converts the location of a token  given  as  offset  in  the  input  stream  into  the
              associated  line number and column index. The result of the command is a 2-element list containing
              the two values, in the order mentioned in the previous sentence.  This  allows  higher  levels  to
              convert  the  location information found in the error status and the generated AST into more human
              readable data.

              <u>Note</u> that the command is not able to convert locations which have not been reached by the  machine
              yet. In other words, if the machine has read 7 tokens the command is able to convert the offsets <b>0</b>
              to  <b>6</b>,  but  nothing beyond that. This also shows that it is not possible to convert offsets which
              refer to locations before the beginning of the stream.

       <u>meName</u> <b>tok</b> ?<u>from</u> ?<u>to</u>??
              This method returns a Tcl list containing the part of the input stream between the locations  <u>from</u>
              and  <u>to</u> (both inclusive). If <u>to</u> is not specified it will default to the value of <u>from</u>.  If <u>from</u> is
              not specified either the whole input stream is returned.

              Each element of the returned list is a list of four elements, the token,  its  associated  lexeme,
              line  number,  and  column index, in this order.  This command places the same restrictions on its
              location arguments as the method <b>lc</b>.

       <u>meName</u> <b>pc</b> <u>state</u>
              This method takes the state value of a ME virtual machine and returns the  current  value  of  the
              stored program counter.

       <u>meName</u> <b>iseof</b> <u>state</u>
              This  method  takes  the  state value of a ME virtual machine and returns the current value of the
              stored eof flag.

       <u>meName</u> <b>at</b> <u>state</u>
              This method takes the state value of a ME virtual machine and returns the current location in  the
              input stream.

       <u>meName</u> <b>cc</b> <u>state</u>
              This method takes the state value of a ME virtual machine and returns the current token.

       <u>meName</u> <b>sv</b>
              This  command  returns  the  current  semantic value <u>SV</u> stored in the machine. This is an abstract
              syntax tree as specified in the document <b>grammar::me_ast</b>, section <b>AST</b> <b>VALUES</b>.

       <u>meName</u> <b>ok</b>
              This method returns the current match status <u>OK</u>.

       <u>meName</u> <b>error</b>
              This method returns the current error status <u>ER</u>.

       <u>meName</u> <b>lstk</b> <u>state</u>
              This method takes the state value of a ME virtual machine and returns the location stack.

       <u>meName</u> <b>astk</b> <u>state</u>
              This method takes the state value of a ME virtual machine and returns the AST stack.

       <u>meName</u> <b>mstk</b> <u>state</u>
              This method takes the state value of a ME virtual machine and returns the AST marker stack.

       <u>meName</u> <b>estk</b> <u>state</u>
              This method takes the state value of a ME virtual machine and returns the error stack.

       <u>meName</u> <b>rstk</b> <u>state</u>
              This method takes the state value of a ME virtual machine and returns the subroutine return stack.

       <u>meName</u> <b>nc</b> <u>state</u>
              This method takes the state value of a ME virtual machine and returns the nonterminal match  cache
              as a dictionary.

       <u>meName</u> <b>ast</b>
              This method returns the current top entry of the AST stack <u>AS</u>.  This is an abstract syntax tree as
              specified in the document <b>grammar::me_ast</b>, section <b>AST</b> <b>VALUES</b>.

       <u>meName</u> <b>halted</b>
              This  method returns a boolean value telling the caller whether the engine has halted execution or
              not. Halt means that no further matching is possible, and the information retrieved via the  other
              method is final. Attempts to <b>run</b> the engine will be ignored, until a <b>reset</b> is made.

       <u>meName</u> <b>code</b>
              This  method  returns the <u>code</u> information used to construct the object. In other words, the match
              program executed by the machine.

       <u>meName</u> <b>eof</b>
              This method adds an end of file marker to the end of the input stream.  This signals  the  machine
              that  the  current  contents  of the input queue are the final parts of the input and nothing will
              come after. Attempts to put more characters into the queue will fail.

       <u>meName</u> <b>put</b> <u>tok</u> <u>lex</u> <u>line</u> <u>col</u>
              This method adds the token <u>tok</u> to the end of the input stream, with associated lexeme data <u>lex</u> and
              <u>line</u>/<u>col</u>umn information.

       <u>meName</u> <b>putstring</b> <u>string</u> <u>lvar</u> <u>cvar</u>
              This method adds each individual character in the <u>string</u> as a  token  to  the  end  of  the  input
              stream,  from  first  to  last. The lexemes will be empty and the line/col information is computed
              based on the characters encountered and the data in the variables <u>lvar</u> and <u>cvar</u>.

       <u>meName</u> <b>run</b> ?<u>n</u>?
              This methods causes the engine to execute match instructions until either

              •      <u>n</u> instructions have been executed, or

              •      a halt instruction was executed, or

              •      the input queue is empty and the code is asking for more tokens to process.

       If no limit <u>n</u> was set only the last two conditions are checked for.

       <u>meName</u> <b>pull</b> <u>nextcmd</u>
              This method implements pull-style operation  of  the  machine.  It  causes  it  to  execute  match
              instructions  until  either a halt instruction is reached, or the command prefix <u>nextcmd</u> ceases to
              deliver more tokens.

              The command prefix <u>nextcmd</u> represents the input stream of characters and is invoked by the machine
              whenever the a new character from the stream is required. The instruction  for  handling  this  is
              <u>ict_advance</u>.  The callback has to return either the empty list, or a list of 4 elements containing
              the  token, its lexeme attribute, and its location as line number and column index, in this order.
              The empty list is the signal that the end of  the  input  stream  has  been  reached.  The  lexeme
              attribute is stored in the terminal cache, but otherwise not used by the machine.

              The  end  of  the  input  stream  for this method does not imply that method <b>eof</b> is called for the
              machine as a whole. By avoiding this and still asking for an explicit call of  the  method  it  is
              possible to mix push- and pull-style operation during the lifetime of the machine.

       <u>meName</u> <b>reset</b>
              This method resets the machine to its initial state, discarding any state it may have.

       <u>meName</u> <b>destroy</b>
              This method deletes the object and releases all resurces it claimed.

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This  document,  and  the package it describes, will undoubtedly contain bugs and other problems.  Please
       report such in the category <u>grammar_me</u> of  the  <u>Tcllib</u>  <u>Trackers</u>  [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].
       Please also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note  further  that  <u>attachments</u>  are strongly preferred over inlined patches. Attachments can be made by
       going to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most  button
       in the secondary navigation bar.

</pre><h4><b>KEYWORDS</b></h4><pre>
       grammar, parsing, virtual machine

</pre><h4><b>CATEGORY</b></h4><pre>
       Grammars and finite automata

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2005-2006 Andreas Kupries &lt;<a href="mailto:andreas_kupries@users.sourceforge.net">andreas_kupries@users.sourceforge.net</a>&gt;

tcllib                                                 0.3                                <u>grammar::me::<a href="../man3tcl/cpu.3tcl.html">cpu</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>