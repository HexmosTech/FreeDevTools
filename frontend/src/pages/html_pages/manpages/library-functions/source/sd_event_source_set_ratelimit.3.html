<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sd_event_source_set_ratelimit, sd_event_source_get_ratelimit, sd_event_source_is_ratelimited,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsystemd-dev">libsystemd-dev_257.7-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sd_event_source_set_ratelimit, sd_event_source_get_ratelimit, sd_event_source_is_ratelimited,
       sd_event_source_set_ratelimit_expire_callback, sd_event_source_leave_ratelimit - Configure rate limiting
       on event sources

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;systemd/sd-event.h&gt;</b>

       <b>int</b> <b>sd_event_source_set_ratelimit(sd_event_source</b> <b>*</b><u>source</u><b>,</b> <b>uint64_t</b> <u>interval_usec</u><b>,</b> <b>unsigned</b> <u>burst</u><b>);</b>

       <b>int</b> <b>sd_event_source_get_ratelimit(sd_event_source</b> <b>*</b><u>source</u><b>,</b> <b>uint64_t*</b> <u>ret_interval_usec</u><b>,</b>
                                         <b>unsigned*</b> <u>ret_burst</u><b>);</b>

       <b>int</b> <b>sd_event_source_is_ratelimited(sd_event_source</b> <b>*</b><u>source</u><b>);</b>

       <b>int</b> <b>sd_event_source_set_ratelimit_expire_callback(sd_event_source</b> <b>*</b><u>source</u><b>,</b> <b>sd_event_handler_t</b><u>callback</u><b>);</b>

       <b>int</b> <b>sd_event_source_leave_ratelimit(sd_event_source</b> <b>*</b><u>source</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sd_event_source_set_ratelimit()</b> may be used to enforce rate limiting on an event source. When used an
       event source will be temporarily turned off when it fires more often then a specified burst number within
       a specified time interval. This is useful as simple mechanism to avoid event source starvation if high
       priority event sources fire very frequently.

       Pass the event source to operate on as first argument, a time interval in microseconds as second argument
       and a maximum dispatch limit ("burst") as third parameter. Whenever the event source is dispatched more
       often than the specified burst within the specified interval it is placed in a mode similar to being
       disabled with <b><a href="../man3/sd_event_source_set_enabled.3.html">sd_event_source_set_enabled</a></b>(3) and the <b>SD_EVENT_OFF</b> parameter. However, it is disabled only
       temporarily â€“ once the specified interval is over regular operation resumes. It is again disabled
       temporarily once the specified rate limiting is hit the next time. If either the interval or the burst
       value are specified as zero, rate limiting is turned off. By default, event sources do not have rate
       limiting enabled. Note that rate limiting and disabling via <b>sd_event_source_set_enabled()</b> are independent
       of each other, and an event source will only effect event loop wake-ups and is dispatched while it both
       is enabled and rate limiting is not in effect.

       <b>sd_event_source_get_ratelimit()</b> may be used to query the current rate limiting parameters set on the
       event source object <u>source</u>. The previously set interval and burst vales are returned in the second and
       third argument.

       <b>sd_event_source_is_ratelimited()</b> may be used to query whether the event source is currently affected by
       rate limiting, i.e. it has recently hit the rate limit and is currently temporarily disabled due to that.

       <b>sd_event_source_set_ratelimit_expire_callback()</b> may be used to set a callback function that is invoked
       every time the event source leaves rate limited state. Note that function is called in the same event
       loop iteration in which state transition occurred.

       <b>sd_event_source_leave_ratelimit()</b> may be used to immediately reenable an event source that was
       temporarily disabled due to rate limiting. This will reset the ratelimit counters for the current time
       interval.

       Rate limiting is currently implemented for I/O, timer, signal, defer and inotify event sources.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, <b>sd_event_source_set_ratelimit()</b>, <b>sd_event_source_set_ratelimit_expire_callback</b> and
       <b>sd_event_source_get_ratelimit()</b> return a non-negative integer. On failure, they return a negative
       errno-style error code.  <b>sd_event_source_is_ratelimited()</b> returns zero if rate limiting is currently not
       in effect and greater than zero if it is in effect; it returns a negative errno-style error code on
       failure.  <b>sd_event_source_leave_ratelimit()</b> returns zero if rate limiting was not in effect on the
       specified event source, and positive if it was and rate limiting is now turned off again; it returns a
       negative errno-style error code on failure.

   <b>Errors</b>
       Returned errors may indicate the following problems:

       <b>-EINVAL</b>
           <u>source</u> is not a valid pointer to an sd_event_source object.

           Added in version 248.

       <b>-ECHILD</b>
           The event loop has been created in a different process, library or module instance.

           Added in version 248.

       <b>-EDOM</b>
           It was attempted to use the rate limiting feature on an event source type that does not support rate
           limiting.

           Added in version 248.

       <b>-ENOEXEC</b>
           <b>sd_event_source_get_ratelimit()</b> was called on an event source that does not have rate limiting
           configured.

           Added in version 248.

</pre><h4><b>NOTES</b></h4><pre>
       Functions described here are available as a shared library, which can be compiled against and linked to
       with the <b>libsystemd</b> <b><a href="../man1/pkg-config.1.html">pkg-config</a></b>(1) file.

       The code described here uses <b><a href="../man3/getenv.3.html">getenv</a></b>(3), which is declared to be not multi-thread-safe. This means that
       the code calling the functions described here must not call <b><a href="../man3/setenv.3.html">setenv</a></b>(3) from a parallel thread. It is
       recommended to only do calls to <b>setenv()</b> from an early phase of the program when no other threads have
       been started.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>sd_event_source_set_ratelimit()</b>, <b>sd_event_source_get_ratelimit()</b>, and <b>sd_event_source_is_ratelimited()</b>
       were added in version 248.

       <b>sd_event_source_set_ratelimit_expire_callback()</b> was added in version 250.

       <b>sd_event_source_leave_ratelimit()</b> was added in version 254.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/sd-event.3.html">sd-event</a></b>(3), <b><a href="../man3/sd_event_add_io.3.html">sd_event_add_io</a></b>(3), <b><a href="../man3/sd_event_add_time.3.html">sd_event_add_time</a></b>(3), <b><a href="../man3/sd_event_add_signal.3.html">sd_event_add_signal</a></b>(3), <b><a href="../man3/sd_event_add_inotify.3.html">sd_event_add_inotify</a></b>(3),
       <b><a href="../man3/sd_event_add_defer.3.html">sd_event_add_defer</a></b>(3), <b><a href="../man3/sd_event_source_set_enabled.3.html">sd_event_source_set_enabled</a></b>(3)

systemd 257.7                                                                   <u><a href="../man3/SD_EVENT_SOURCE_SET_RATELIMIT.3.html">SD_EVENT_SOURCE_SET_RATELIMIT</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>