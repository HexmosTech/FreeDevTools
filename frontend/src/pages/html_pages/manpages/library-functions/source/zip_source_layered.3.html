<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>zip_source_layered, zip_source_layered_create — create layered data source from function</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libzip-dev">libzip-dev_1.11.3-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       zip_source_layered, zip_source_layered_create — create layered data source from function

</pre><h4><b>LIBRARY</b></h4><pre>
       libzip (-lzip)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;zip.h&gt;</b>

       <u>zip_source_t</u> <u>*</u>
       <b>zip_source_layered</b>(<u>zip_t</u> <u>*archive</u>, <u>zip_source_t</u> <u>*source</u>, <u>zip_source_layered_callback</u> <u>fn</u>, <u>void</u> <u>*userdata</u>);

       <u>zip_source_t</u> <u>*</u>
       <b>zip_source_layered_create</b>(<u>zip_source_t</u>   <u>*source</u>,   <u>zip_source_layered_callback</u>   <u>fn</u>,   <u>void</u>   <u>*userdata</u>,
           <u>zip_error_t</u> <u>*error</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The functions <b>zip_source_layered</b>() and <b>zip_source_layered_create</b>() create a layered zip source  from  the
       user-provided function <u>fn</u>, which must be of the following type:

       <u>typedef</u>   <u>zip_int64_t</u>   (*p_source_layered_callback)(<u>zip_source_t</u> <u>*source</u>,   <u>void</u> <u>*userdata</u>,  <u>void</u> <u>*data</u>,
       <u>zip_uint64_t</u> <u>length</u>, <u>zip_source_cmd_t</u> <u>cmd</u>)

       <u>archive</u> or <u>error</u> are used for reporting errors and can be NULL.

       When called by the library, the first argument is the <u>source</u> of the lower layer, the second  argument  is
       the  <u>userdata</u> argument supplied to the function.  The next two arguments are a buffer <u>data</u> of size <u>length</u>
       when data is passed in or expected to be returned, or else NULL and 0.  The last argument, <u>cmd</u>, specifies
       which action the function should perform.

       See <u><a href="../man3/zip_source_function.3.html">zip_source_function</a></u>(3) for a description of the commands.

       A layered source transforms the data or metadata of the source below in some way.  Layered sources  can't
       support  writing  and  are not sufficient to cleanly add support for additional compression or encryption
       methods.  This may be revised in a later release of libzip.

       On success, the layered source takes ownership of <u>source</u>.  The caller should not free it.

       The interaction with the lower layer depends on the command:

   ZIP_SOURCE_ACCEPT_EMPTY
       If the layered source supports this command, the lower layer is not called automatically.  Otherwise, the
       return value of the lower source is used.

   ZIP_SOURCE_CLOSE
       The lower layer is closed after the callback returns.

   ZIP_SOURCE_ERROR
       The lower layer is not called automatically.  If you need to retrieve error information  from  the  lower
       layer, use <u><a href="../man3/zip_error_set_from_source.3.html">zip_error_set_from_source</a></u>(3) or <u><a href="../man3/zip_source_pass_to_lower_layer.3.html">zip_source_pass_to_lower_layer</a></u>(3).

   ZIP_SOURCE_FREE
       The lower layer is freed after the callback returns.

   ZIP_SOURCE_GET_FILE_ATTRIBUTES
       The  attributes  of  the lower layer are merged with the attributes returned by the callback: information
       set by the callback wins over the lower layer, with the following exceptions: the  higher  <u>version_needed</u>
       is  used,  and  <u>general_purpose_bit_flags</u>  are  only  overwritten  if  the  corresponding  bit  is set in
       <u>general_purpose_bit_mask</u>.

   ZIP_SOURCE_OPEN
       The lower layer is opened before the callback is called.

   ZIP_SOURCE_READ
       The lower layer is not called automatically.

   ZIP_SOURCE_SEEK
       The lower layer is not called automatically.

   ZIP_SOURCE_STAT
       <u>data</u> contains the stat information from the lower layer when the callback is called.

   ZIP_SOURCE_SUPPORTS
       <u>data</u> contains the bitmap of commands supported by the lower layer when the  callback  is  called.   Since
       layered  sources  can't  support  writing, all commands related to writing are stripped from the returned
       support bitmap.

   ZIP_SOURCE_TELL
       The lower layer is not called automatically.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       Upon successful completion, the created source is returned.  Otherwise, NULL is returned  and  the  error
       code in <u>archive</u> or <u>error</u> is set to indicate the error (unless it is NULL).

</pre><h4><b>ERRORS</b></h4><pre>
       <b>zip_source_layered</b>() fails if:

       [ZIP_ER_MEMORY]    Required memory could not be allocated.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/libzip.3.html">libzip</a></u>(3),     <u><a href="../man3/zip_file_add.3.html">zip_file_add</a></u>(3),    <u><a href="../man3/zip_file_attributes_init.3.html">zip_file_attributes_init</a></u>(3),    <u><a href="../man3/zip_file_replace.3.html">zip_file_replace</a></u>(3),    <u><a href="../man3/zip_source.3.html">zip_source</a></u>(3),
       <u><a href="../man3/zip_source_function.3.html">zip_source_function</a></u>(3), <u><a href="../man3/zip_source_pass_to_lower_layer.3.html">zip_source_pass_to_lower_layer</a></u>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>zip_source_layered</b>() and <b>zip_source_layered_create</b>() were added in libzip 1.10.

</pre><h4><b>AUTHORS</b></h4><pre>
       Dieter Baron &lt;<u><a href="mailto:dillo@nih.at">dillo@nih.at</a></u>&gt; and Thomas Klausner &lt;<u><a href="mailto:wiz@gatalith.at">wiz@gatalith.at</a></u>&gt;

Debian                                          January 20, 2023                           <u><a href="../man3/ZIP_SOURCE_LAYERED.3.html">ZIP_SOURCE_LAYERED</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>