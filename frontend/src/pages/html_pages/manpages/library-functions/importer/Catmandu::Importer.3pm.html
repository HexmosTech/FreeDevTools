<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catmandu::Importer - Namespace for packages that can import</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcatmandu-perl">libcatmandu-perl_1.2024-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Catmandu::Importer - Namespace for packages that can import

</pre><h4><b>SYNOPSIS</b></h4><pre>
           # From the command line

           # JSON is an importer and YAML an exporter
           $ catmandu convert JSON to YAML &lt; data.json

           # OAI is an importer and JSON an exporter
           $ catmandu convert OAI --url <a href="http://biblio.ugent.be/oai">http://biblio.ugent.be/oai</a> to JSON

           # Fetch remote content
           $ catmandu convert JSON --file <a href="http://example.com/data.json">http://example.com/data.json</a> to YAML

           # From Perl

           use Catmandu;
           use Data::Dumper;

           my $importer = Catmandu-&gt;importer('JSON', file =&gt; 'data.json');

           $importer-&gt;each(sub {
               my $item = shift;
               print Dumper($item);
           });

           my $num = $importer-&gt;count;

           my $first_item = $importer-&gt;first;

           # Convert OAI to JSON in Perl
           my $importer = Catmandu-&gt;importer('OAI', url =&gt; '<a href="http://biblio.ugent.be/oai">http://biblio.ugent.be/oai</a>');
           my $exporter = Catmandu-&gt;exporter('JSON');

           $exporter-&gt;add_many($importer);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A Catmandu::Importer is a Perl package that can generate structured data from sources such as JSON, YAML,
       XML, RDF or network protocols such as Atom, OAI-PMH, SRU and even DBI databases. Given an
       Catmandu::Importer a programmer can read data from using one of the many Catmandu::Iterable methods:

           $importer-&gt;to_array;
           $importer-&gt;count;
           $importer-&gt;each(\&amp;callback);
           $importer-&gt;first;
           $importer-&gt;rest;
           ...etc...

       Every Catmandu::Importer is also Catmandu::Fixable and thus inherits a 'fix' parameter that can be set in
       the constructor. When given a 'fix' parameter, then each item returned by the generator will be
       automatically Fixed using one or more Catmandu::Fixes.  E.g.

           my $importer = Catmandu-&gt;importer('JSON',fix =&gt; ['upcase(title)']);
           $importer-&gt;each( sub {
               my $item = shift ; # Every $item-&gt;{title} is now upcased...

           });

           # or via a Fix file
           my $importer = Catmandu-&gt;importer('JSON',fix =&gt; ['/my/fixes.txt']);
           $importer-&gt;each( sub {
               my $item = shift ; # Every $item-&gt;{title} is now upcased...

           });

</pre><h4><b>CONFIGURATION</b></h4><pre>
       file
           Read  input  from  a  local file given by its path. If the path looks like a url, the content will be
           fetched first and then passed to the importer.  Alternatively a scalar reference  can  be  passed  to
           read from a string.

       fh  Read  input  from  an  IO::Handle.  If  not specified, Catmandu::Util::io is used to create the input
           stream from the "file" argument or by using STDIN.

       encoding
           Binmode of the input stream "fh". Set to ":utf8" by default.

       fix An ARRAY of one or more Fix-es or Fix scripts to be applied to imported items.

       data_path
           The data at "data_path" is imported instead of the original data.

              # given this imported item:
              {abc =&gt; [{a=&gt;1},{b=&gt;2},{c=&gt;3}]}
              # with data_path 'abc', this item gets imported instead:
              [{a=&gt;1},{b=&gt;2},{c=&gt;3}]
              # with data_path 'abc.*', 3 items get imported:
              {a=&gt;1}
              {b=&gt;2}
              {c=&gt;3}

       variables
           Variables given here will interpolate the "file" and "http_body" options. The syntax is the  same  as
           URI::Template.

               # named arguments
               my $importer = Catmandu-&gt;importer('JSON',
                   file =&gt; 'http://{server}/{path}',
                   variables =&gt; {server =&gt; 'biblio.ugent.be', path =&gt; 'file.json'},
               );

               # positional arguments
               my $importer = Catmandu-&gt;importer('JSON',
                   file =&gt; 'http://{server}/{path}',
                   variables =&gt; 'biblio.ugent.be,file.json',
               );

               # or
               my $importer = Catmandu-&gt;importer('JSON',
                   url =&gt; 'http://{server}/{path}',
                   variables =&gt; ['biblio.ugent.be','file.json'],
               );

               # or via the command line
               $ catmandu convert JSON --file 'http://{server}/{path}' --variables 'biblio.ugent.be,file.json'

</pre><h4><b>HTTP</b> <b>CONFIGURATION</b></h4><pre>
       These options are only relevant if "file" is a url. See LWP::UserAgent for details about these options.

       http_body
           Set the GET/POST message body.

       http_method
           Set the type of HTTP request 'GET', 'POST' , ...

       http_headers
           A reference to a HTTP::Headers objects.

   <b>Set</b> <b>an</b> <b>own</b> <b>HTTP</b> <b>client</b>
       user_agent(LWP::UserAgent-&gt;new(...))
           Set an own HTTP client

   <b>Alternative</b> <b>set</b> <b>the</b> <b>parameters</b> <b>of</b> <b>the</b> <b>default</b> <b>client</b>
       http_agent
           A string containing the name of the HTTP client.

       http_max_redirect
           Maximum number of HTTP redirects allowed.

       http_timeout
           Maximum execution time.

       http_verify_hostname
           Verify the SSL certificate.

       http_retry
           Maximum  times  to  retry  the  HTTP  request  if it temporarily fails. Default is not to retry.  See
           LWP::UserAgent::Determined for the HTTP status codes that initiate a retry.

       http_timing
           Maximum times and timeouts to retry the HTTP request if it  temporarily  fails.  Default  is  not  to
           retry.  See LWP::UserAgent::Determined for the HTTP status codes that initiate a retry and the format
           of the timing value.

</pre><h4><b>METHODS</b></h4><pre>
   <b>first,</b> <b>each,</b> <b>rest</b> <b>,</b> <b>...</b>
       See Catmandu::Iterable for all inherited methods.

</pre><h4><b>CODING</b></h4><pre>
       Create  your  own importer by creating a Perl package in the Catmandu::Importer namespace that implements
       "Catmandu::Importer". Basically, you need to create a method 'generate' which  returns  a  callback  that
       creates one Perl hash for each call:

           my $importer = Catmandu::Importer::Hello-&gt;new;

           $importer-&gt;generate(); # record
           $importer-&gt;generate(); # next record
           $importer-&gt;generate(); # undef = end of stream

       Here is an example of a simple "Hello" importer:

           package Catmandu::Importer::Hello;

           use Catmandu::Sane;
           use Moo;

           with 'Catmandu::Importer';

           sub generator {
               my ($self) = @_;
               state $fh = $self-&gt;fh;
               my $n = 0;
               return sub {
                   $self-&gt;log-&gt;debug("generating record " . ++$n);
                   my $name = $self-&gt;fh-&gt;readline;
                   return defined $name ? { "hello" =&gt; $name } : undef;
               };
           }

           1;

       This importer can be called via the command line as:

           $ catmandu convert Hello to JSON &lt; /tmp/names.txt
           $ catmandu convert Hello to YAML &lt; /tmp/names.txt
           $ catmandu import Hello to MongoDB --database_name test &lt; /tmp/names.txt

       Or, via Perl

           use Catmandu;

           my $importer = Catmandu-&gt;importer('Hello', file =&gt; '/tmp/names.txt');
           $importer-&gt;each(sub {
               my $items = shift;
           });

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Catmandu::Iterable    ,    Catmandu::Fix    ,    Catmandu::Importer::CSV,    Catmandu::Importer::JSON   ,
       Catmandu::Importer::YAML

perl v5.40.0                                       2025-01-17                            <u>Catmandu::<a href="../man3pm/Importer.3pm.html">Importer</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>