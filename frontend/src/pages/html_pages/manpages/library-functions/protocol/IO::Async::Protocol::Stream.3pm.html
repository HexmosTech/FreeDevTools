<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>"IO::Async::Protocol::Stream" - base class for stream-based protocols</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libio-async-perl">libio-async-perl_0.804-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       "IO::Async::Protocol::Stream" - base class for stream-based protocols

</pre><h4><b>SYNOPSIS</b></h4><pre>
       Most likely this class will be subclassed to implement a particular network protocol.

          package Net::Async::HelloWorld;

          use strict;
          use warnings;
          use base qw( IO::Async::Protocol::Stream );

          sub on_read
          {
             my $self = shift;
             my ( $buffref, $eof ) = @_;

             return 0 unless $$buffref =~ s/^(.*)\n//;
             my $line = $1;

             if( $line =~ m/^HELLO (.*)/ ) {
                my $name = $1;

                $self-&gt;invoke_event( on_hello =&gt; $name );
             }

             return 1;
          }

          sub send_hello
          {
             my $self = shift;
             my ( $name ) = @_;

             $self-&gt;write( "HELLO $name\n" );
          }

       This small example elides such details as error handling, which a real protocol implementation would be
       likely to contain.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This subclass of IO::Async::Protocol is intended to stand as a base class for implementing stream-based
       protocols. It provides an interface similar to IO::Async::Stream, primarily, a "write" method and an
       "on_read" event handler.

       It contains an instance of an IO::Async::Stream object which it uses for actual communication, rather
       than being a subclass of it, allowing a level of independence from the actual stream being used. For
       example, the stream may actually be an IO::Async::SSLStream to allow the protocol to be used over SSL.

       As with IO::Async::Stream, it is required that by the time the protocol object is added to a Loop, that
       it either has an "on_read" method, or has been configured with an "on_read" callback handler.

</pre><h4><b>EVENTS</b></h4><pre>
       The following events are invoked, either using subclass methods or CODE references in parameters:

   <b>$ret</b> <b>=</b> <b>on_read</b> <b>\$buffer,</b> <b>$eof</b>
   <b>on_read_eof</b>
   <b>on_write_eof</b>
       The event handlers are invoked identically to IO::Async::Stream.

   <b>on_closed</b>
       The "on_closed" handler is optional, but if provided, will be invoked after the stream is closed by
       either side (either because the close() method has been invoked on it, or on an incoming EOF).

</pre><h4><b>PARAMETERS</b></h4><pre>
       The following named parameters may be passed to "new" or "configure":

   <b>on_read</b> <b>=&gt;</b> <b>CODE</b>
   <b>on_read_eof</b> <b>=&gt;</b> <b>CODE</b>
   <b>on_write_eof</b> <b>=&gt;</b> <b>CODE</b>
       CODE references for the events.

   <b>handle</b> <b>=&gt;</b> <b>IO</b>
       A shortcut for the common case where the transport only needs to be a plain IO::Async::Stream object. If
       this argument is provided without a "transport" object, a new IO::Async::Stream object will be built
       around the given IO handle, and used as the transport.

</pre><h4><b>METHODS</b></h4><pre>
   <b>write</b>
          $protocol-&gt;write( $data );

       Writes the given data by calling the "write" method on the contained transport stream.

   <b>connect</b>
          $protocol-&gt;connect( %args );

       Sets up a connection to a peer, and configures the underlying "transport" for the Protocol. Calls
       IO::Async::Protocol "connect" with "socktype" set to "stream".

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Evans &lt;<a href="mailto:leonerd@leonerd.org.uk">leonerd@leonerd.org.uk</a>&gt;

perl v5.40.1                                       2025-05-17                   <u>IO::Async::Protocol::<a href="../man3pm/Stream.3pm.html">Stream</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>