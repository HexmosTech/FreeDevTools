<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pop3 - Tcl client for POP3 email protocol</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pop3 - Tcl client for POP3 email protocol

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>pop3</b> <b>?1.11?</b>

       <b>::pop3::open</b>  ?<b>-msex</b>  0|1?  ?<b>-retr-mode</b> retr|list|slow? ?<b>-socketcmd</b> cmdprefix? ?<b>-stls</b> 0|1? ?<b>-tls-callback</b>
       stls-callback-command? <u>host</u> <u>username</u> <u>password</u> ?<u>port</u>?

       <b>::pop3::config</b> <u>chan</u>

       <b>::pop3::status</b> <u>chan</u>

       <b>::pop3::last</b> <u>chan</u>

       <b>::pop3::retrieve</b> <u>chan</u> <u>startIndex</u> ?<u>endIndex</u>?

       <b>::pop3::delete</b> <u>chan</u> <u>startIndex</u> ?<u>endIndex</u>?

       <b>::pop3::list</b> <u>chan</u> ?<u>msg</u>?

       <b>::pop3::top</b> <u>chan</u> <u>msg</u> <u>n</u>

       <b>::pop3::uidl</b> <u>chan</u> ?<u>msg</u>?

       <b>::pop3::capa</b> <u>chan</u>

       <b>::pop3::close</b> <u>chan</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>pop3</b> package provides a simple Tcl-only client library for the POP3 email protocol  as  specified  in
       <u>RFC</u>  <u>1939</u>  [<a href="http://www.rfc-editor.org/rfc/rfc1939.txt">http://www.rfc-editor.org/rfc/rfc1939.txt</a>].   It works by opening the standard POP3 socket on
       the server, transmitting the username and password, then providing a Tcl API to access the POP3  protocol
       commands.   All server errors are returned as Tcl errors (thrown) which must be caught with the Tcl <b>catch</b>
       command.

</pre><h4><b>TLS</b> <b>SECURITY</b> <b>CONSIDERATIONS</b></h4><pre>
       This package uses the <b>TLS</b> package to handle the security for <b>https</b> urls and other socket connections.

       Policy decisions like the set of protocols to support and what ciphers to use are not the  responsibility
       of  <b>TLS</b>,  nor  of  this  package  itself  however.   Such  decisions  are the responsibility of whichever
       application is using the package, and are likely influenced by the set of servers  the  application  will
       talk to as well.

       For        example,        in        light        of        the        recent        <u>POODLE</u>        <u>attack</u>
       [<a href="http://googleonlinesecurity.blogspot.co.uk/2014/10/this-poodle-bites-exploiting-ssl-30.html">http://googleonlinesecurity.blogspot.co.uk/2014/10/this-poodle-bites-exploiting-ssl-30.html</a>]  discovered
       by  Google  many  servers  will  disable  support  for  the  SSLv3  protocol.   To handle this change the
       applications using <b>TLS</b> must be patched, and not this package, nor <b>TLS</b> itself.  Such a  patch  may  be  as
       simple as generally activating <b>tls1</b> support, as shown in the example below.

                  package require tls
                  tls::init -tls1 1 ;# forcibly activate support for the TLS1 protocol

                  ... your own application code ...

</pre><h4><b>API</b></h4><pre>
       <b>::pop3::open</b> ?<b>-msex</b> 0|1? ?<b>-retr-mode</b> retr|list|slow? ?<b>-socketcmd</b> cmdprefix? ?<b>-stls</b> 0|1? ?<b>-tls-callback</b>
       stls-callback-command? <u>host</u> <u>username</u> <u>password</u> ?<u>port</u>?
              Open  a  socket  connection to the server specified by <u>host</u>, transmit the <u>username</u> and <u>password</u> as
              login information to the server.  The default port number is <b>110</b>, which can  be  overridden  using
              the  optional  <u>port</u>  argument.   The  return  value  is  a channel used by all of the other ::pop3
              functions.

              The command recognizes three options

              <b>-msex</b> boolean
                     Setting this option tells the package that the server we are talking to is an  MS  Exchange
                     server (which has some oddities we have to work around). The default is <b>False</b>.

              <b>-retr-mode</b> retr|list|slow
                     The  retrieval  mode determines how exactly messages are read from the server.  The allowed
                     values are <b>retr</b>, <b>list</b> and <b>slow</b>.   The  default  is  <b>retr</b>.  See  <b>::pop3::retrieve</b>  for  more
                     information.

              <b>-socketcmd</b> cmdprefix
                     This  option allows the user to overide the use of the builtin <b>socket</b> command with any API-
                     compatible command. The envisioned main use is the securing of the new connection via  SSL,
                     through  the specification of the command <b>tls::socket</b>. This command is specially recognized
                     as well, changing the default port of the connection to <b>995</b>.

              <b>-stls</b> boolean
                     Setting this option tells the package to  secure  the  connection  using  SSL  or  TLS.  It
                     performs  STARTTLS  as  described  in  IETF  RFC 2595, it first opens a normal, unencrypted
                     connection and then negotiates a SSLv3 or TLSv1 connection. If  the  connection  cannot  be
                     secured, the connection will be closed and an error will be returned

              <b>-tls-callback</b> stls-callback-command
                     This  option  allows  the  user  to overide the <b>tls::callback</b> used during the <b>-stls</b> SSL/TLS
                     handshake. See the TLS manual for details on how to implement this callback.

       <b>::pop3::config</b> <u>chan</u>
              Returns the configuration of the pop3 connection identified  by  the  channel  handle  <u>chan</u>  as  a
              serialized array.

       <b>::pop3::status</b> <u>chan</u>
              Query  the  server  for the status of the mail spool.  The status is returned as a list containing
              two elements, the first is the number of email messages on the server and the second is  the  size
              (in octets, 8 bit blocks) of the entire mail spool.

       <b>::pop3::last</b> <u>chan</u>
              Query the server for the last email message read from the spool.  This value includes all messages
              read  from  all clients connecting to the login account.  This command may not be supported by the
              email server, in which case the server may return 0 or an error.

       <b>::pop3::retrieve</b> <u>chan</u> <u>startIndex</u> ?<u>endIndex</u>?
              Retrieve a range of messages from the server.  If the <u>endIndex</u> is not specified, only one  message
              will be retrieved.  The return value is a list containing each message as a separate element.  See
              the <u>startIndex</u> and <u>endIndex</u> descriptions below.

              The retrieval mode determines how exactly messages are read from the server. The mode <b>retr</b> assumes
              that the RETR command delivers the size of the message as part of the command status and uses this
              to read the message efficiently. In mode <b>list</b> RETR does not deliver the size, but the LIST command
              does  and  we use this to retrieve the message size before the actual retrieval, which can then be
              done efficiently. In the last mode, <b>slow</b>, the system is unable to obtain the size of  the  message
              to retrieve in any manner and falls back to reading the message from the server line by line.

              It  should  also  be  noted  that the system checks upon the configured mode and falls back to the
              slower modes if the above assumptions are not true.

       <b>::pop3::delete</b> <u>chan</u> <u>startIndex</u> ?<u>endIndex</u>?
              Delete a range of messages from the server.  If the <u>endIndex</u> is not specified,  only  one  message
              will  be  deleted.  Note, the indices are not reordered on the server, so if you delete message 1,
              then the first message in the queue is message 2 (message index 1 is no longer  valid).   See  the
              <u>startIndex</u> and <u>endIndex</u> descriptions below.

              <u>startIndex</u>
                     The  <u>startIndex</u> may be an index of a specific message starting with the index 1, or it have
                     any of the following values:

                     <b>start</b>  This is a logical value for the first message in the spool, equivalent to the  value
                            1.

                     <b>next</b>   The message immediately following the last message read, see <b>::pop3::last</b>.

                     <b>end</b>    The  most  recent  message  in  the spool (the end of the spool).  This is useful to
                            retrieve only the most recent message.

              <u>endIndex</u>
                     The <u>endIndex</u> is an optional parameter and defaults to the value "-1",  which  indicates  to
                     only retrieve the one message specified by <u>startIndex</u>.  If specified, it may be an index of
                     a specific message starting with the index "1", or it may have any of the following values:

                     <b>last</b>   The message is the last message read by a POP3 client, see <b>::pop3::last</b>.

                     <b>end</b>    The most recent message in the spool (the end of the spool).

       <b>::pop3::list</b> <u>chan</u> ?<u>msg</u>?
              Returns the scan listing of the mailbox. If parameter <u>msg</u> is given, then the listing only for that
              message is returned.

       <b>::pop3::top</b> <u>chan</u> <u>msg</u> <u>n</u>
              Optional  POP3  command,  not  all  servers  may support this.  <b>::pop3::top</b> retrieves headers of a
              message, specified by parameter <u>msg</u>, and number of <u>n</u> lines from the message body.

       <b>::pop3::uidl</b> <u>chan</u> ?<u>msg</u>?
              Optional POP3 command, not all servers may support this.  <b>::pop3::uidl</b> returns the uid listing  of
              the  mailbox.  If  the  parameter  <u>msg</u>  is  specified,  then  the listing only for that message is
              returned.

       <b>::pop3::capa</b> <u>chan</u>
              Optional POP3 command, not all servers may support this.   <b>::pop3::capa</b>  returns  a  list  of  the
              capabilities  of the server.  TOP, SASL, UIDL, LOGIN-DELAY and STLS are typical capabilities.  See
              IETF RFC 2449.

       <b>::pop3::close</b> <u>chan</u>
              Gracefully close the connect after sending a POP3 QUIT command down the socket.

</pre><h4><b>SECURE</b> <b>MAIL</b> <b>TRANSFER</b></h4><pre>
       A pop3 connection can be secured with SSL/TLS by requiring the package <b>TLS</b>  and  then  using  either  the
       option  <b>-socketcmd</b>  or  the option <b>-stls</b> of the command <b>pop3::open</b>.  The first method, option <b>-socketcmd</b>,
       will force the use of the <b>tls::socket</b> command when opening the connection.  This  is  suitable  for  POP3
       servers which expect SSL connections only. These will generally be listening on port 995.

                package require tls
                tls::init -cafile /path/to/ca/cert -keyfile ...

                # Create secured pop3 channel
                pop3::open -socketcmd tls::socket \
                   $thehost $theuser $thepassword

                ...

       The  second  method,  option  <b>-stls</b>,  will connect to the standard POP3 port and then perform an STARTTLS
       handshake. This will only work for POP3 servers which have this capability. The package will confirm that
       the  server  supports  STARTTLS  and  the  handshake  was  performed  correctly  before  proceeding  with
       authentication.

                package require tls
                tls::init -cafile /path/to/ca/cert -keyfile ...

                # Create secured pop3 channel
                pop3::open -stls 1 \
                   $thehost $theuser $thepassword

                ...

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This  document,  and  the package it describes, will undoubtedly contain bugs and other problems.  Please
       report such in the category <u>pop3</u> of the <u>Tcllib</u> <u>Trackers</u>  [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].   Please
       also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note  further  that  <u>attachments</u>  are strongly preferred over inlined patches. Attachments can be made by
       going to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most  button
       in the secondary navigation bar.

</pre><h4><b>KEYWORDS</b></h4><pre>
       email, mail, pop, pop3, rfc 1939, secure, ssl, tls

</pre><h4><b>CATEGORY</b></h4><pre>
       Networking

tcllib                                                1.11                                            <u><a href="../man3tcl/pop3.3tcl.html">pop3</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>