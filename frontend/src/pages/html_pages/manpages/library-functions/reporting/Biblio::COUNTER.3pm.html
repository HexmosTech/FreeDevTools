<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblio::COUNTER - COUNTER Codes of Practice report processing</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libbiblio-counter-perl">libbiblio-counter-perl_0.11-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Biblio::COUNTER - COUNTER Codes of Practice report processing

</pre><h4><b>SYNOPSIS</b></h4><pre>
           # --- Process a report

           # (1) Using Biblio::COUNTER
           $report = Biblio::COUNTER-&gt;report(\*STDIN)-&gt;process;
           $report = Biblio::COUNTER-&gt;report($file)-&gt;process;

           # (2) Using Biblio::COUNTER::Processor or a subclass
           $processor = Biblio::COUNTER::Processor::Default-&gt;new;\
           $report = $processor-&gt;run(\*STDIN);
           $report = $processor-&gt;run($file);
           $report = $processor-&gt;run(Biblio::COUNTER-&gt;new(\*STDIN));

           # --- Access information in a processed report

           warn "Invalid report" unless $report-&gt;is_valid;

           # Access data in the report
           $name      = $report-&gt;name;
                          # e.g., "Database Report 2 (R2)"
           $descrip   = $report-&gt;description;
                          # e.g., "Turnaways by Month and Database"
           $date_run  = $report-&gt;date_run;
                          # e.g., "2008-04-11"
           $criteria  = $report-&gt;criteria;
           $publisher = $report-&gt;publisher;
           $platform  = $report-&gt;platform;
           $periods   = $report-&gt;periods;
                          # e.g., [ "2008-01", "2008-02", "2008-03" ]

           foreach $rec ($report-&gt;records) {
               $title     = $rec-&gt;{title};
               $publisher = $rec-&gt;{publisher};
               $platform  = $rec-&gt;{platform};
               $count     = $rec-&gt;{count};
               foreach $period (@periods) {
                   $period_count = $count-&gt;{$period};
                   while (($metric, $n) = each %$period_count) {
                       # e.g., ("turnaways", 3)
                   }
               }
           }

</pre><h4><b>NOTE</b></h4><pre>
       Because the COUNTER Codes of Practice are so poorly written and documented, with incomplete
       specifications and inconsistent terminology, it has been necessary to make certain assumptions and
       normalizations in the code and documentation of this module.

       First, all reports must be in plain text, tab- or comma-delimited format; Excel spreadsheets are not
       allowed.  (To convert an Excel spreadsheet to tab-delimited text, consider using
       Spreadsheet::ParseExcel::Simple.

       (XML formats may be handled in a future version of this module.)

       Some terminology notes are in order:

       <b>name</b>
           The <b>name</b> of a report fully denotes the report's type and the version of the COUNTER Codes of Practice
           that  defines  it.   For  example,  "Journal  Report 1 (R2)". COUNTER sometimes refers to this as the
           report <u>title</u>.

       <b>description</b>
           This is the phrase, also defined by the COUNTER Codes of Practice, that describes the contents  of  a
           report.   For  example,  <b>Journal</b>  <b>Report</b>  <b>1</b>  is  described as "Number of Successful Full-Text Article
           Requests by Month and Journal".

       <b>code</b>
           This is the term I use for the short name that identifies the type, <b>but</b> <b>not</b> <b>the</b> <b>version</b>, of a COUNTER
           report.  For example, "JR1" is the code for <b>Journal</b> <b>Report</b> <b>1</b> reports.

       <b>metric</b>
           A metric is a particular measure of usage  (or  non-usage),  including  the  number  of  searches  or
           sessions in a database or the number of full-text articles in a journal downloaded successfully.

</pre><h4><b>METHODS</b></h4><pre>
       <b>report</b>(<u>$how</u>, [<u>%args</u>])
           Create a new report instance.

           Set  <u>$how</u>  to a glob ref (e.g., "\*STDIN") to specify a filehandle from which an existing report will
           be read.

           Specify a report name in <u>$how</u> (e.g., "Database Report 2 (R2)") to instantiate a  new,  empty  report.
           (Report generation is not yet implemented.)

           <u>%args</u> may contain any of the following:

           <b>treat_blank_counts_as_zero</b>
               If  set  to a true value, a blank cell where a count was expected is treated as if it contained a
               zero; otherwise, blank counts are silently ignored (the default).

           <b>change_not_available_to_blank</b>
               If set to a true value (the default), the value "n/a") in a count field will be  changed  to  the
               empty   string.    It   will   <b>never</b>   be   treated  as  if  it  were  zero,  regardless  of  the
               <b>treat_blank_counts_as_zero</b> setting.

           <b>callback</b>
               Get or set a reference to a hash of (<u>$event</u>, <u>$code</u>) pairs specifying what to do for each  of  the
               events described under CALLBACKS.

               Each <u>$code</u> must be a coderef, not the name of a function or method.

               If an event is not specified in this hash, then the default action for the event will be taken.

       <b>name</b>
           Get  or  set  the  report's name: this is the official name defined by the COUNTER codes of practice.
           See  "REPORTS  SUPPORTED"  for  a  complete  list  of  the  reports  supported  by  this  version  of
           Biblio::COUNTER.

       <b>code</b>
           Get  or  set  the report's code: this is the short string (e.g., "JR1") that identifies the type, <b>but</b>
           <b>not</b> <b>the</b> <b>version</b>, of a COUNTER report.

       <b>description</b>
           Get or set the report's description: this is the official description defined by the COUNTER codes of
           practice.  For example, the "Journal Report 1 (R2)" report has the description "Number of  Successful
           Full-Text Article Requests by Month and Journal".

       <b>date_run</b>
           Get or set the date on which the report was run.  The date, if valid, is in the ISO8601 standard form
           "YYYY-MM-DD".

       <b>criteria</b>
           Get or set the report criteria.  This is a free text field.

       <b>periods</b>
           Get  or  set  the  periods  for  which  the  report contains counts.  To simplify things, periods are
           returned (and must be set) in the ISO 8601 standard form "YYYY-MM".

       <b>publisher</b>
           Get or set the publisher common to all of the resources in the report.

       <b>platform</b>
           Get or set the platform common to all of the resources in the report.

</pre><h4><b>CALLBACKS</b></h4><pre>
       While processing a report, a number of different <b>events</b> occur. For example,  a <b>fixed</b> event occurs when  a
       field  whose  value  is  invalid  is  corrected.   For  event  different kind of event, a <b>callback</b> may be
       specified that is triggered each time the event occurs; see the  <b>report</b>  method  for  how  to  specify  a
       callback.

       Callbacks must be coderefs, not function or method names.

       For  example,  the following callbacks may be used to provide an indication of the progress in processing
       it:

           $record_number = 0;
           %callbacks = (
               'begin_report' =&gt; sub {
                   print STDERR "Beginning report: ";
               },
               'end_header' =&gt; sub {
                   my ($report, $header) = @_;
                   print STDERR $report-&gt;name, "\n";
               }
               'end_record' =&gt; sub {
                   my ($report, $record) = @_;
                   ++$record_number;
                   print STDERR "$record_number "
                       if $record_number % 20 == 0;
                   print STDERR "\n"
                       if $record_number % 200 == 0;
               },
               'end_report' =&gt; sub {
                   my ($report) = @_;
                   if ($report-&gt;is_valid) {
                       print STDERR "OK\n";
                   }
                   else {
                       print STDERR "INVALID\n";
                   }
               },
           );

       By default, the only callback defined is for <b>output</b>; it prints each line of input  (corrected,  if  there
       were correctable problems) to standard output. (Spurious blank lines are not printed.)

       Events fall into four broad categories: <b>structure</b>, <b>validation</b>, <b>tracing</b>, and <b>data</b>.

   <b>Structure</b>
       Logically, a COUNTER report has the following structure:

           report
               header
               body
                   record
                   record
                   ...

       <b>begin_file</b>(<u>$report</u>, <u>$file</u>)
           Parsing  of  the given file is beginning. This is always the first event triggered.  At the time this
           callback is invoked, the report has not yet been identified.

       <b>end_file</b>(<u>$report</u>, <u>$file</u>)
           Parsing of the given file has ended. This is always the last event triggered.

       <b>begin_report</b>(<u>$report</u>)
           Processing of the report is beginning.  At the time this callback is invoked, the report has not  yet
           been identified.

       <b>end_report</b>(<u>$report</u>)
           Processing of the report has ended.  This is always the last event triggered.

       <b>begin_header</b>(<u>$report</u>, <u>$header</u>)
           Processing of the report's header is beginning.  The header is everything before the first data row.

           <u>$header</u> is a reference to an empty hash; the callback code may, if it wishes, put something into this
           hash.

       <b>end_header</b>(<u>$report</u>, <u>$header</u>)
           Processing of the report's header is complete.

           <u>$header</u>  is  a  reference  to  the  same  hash referenced in the <b>begin_header</b> callback, but which now
           contains one or more of the elements listed below.   (These  elements  are  described  under  <b>METHODS</b>
           above):

           <b>date_run</b>
               The date on which the report was run, in the ISO8601 standard form "YYYY-MM-DD".

           <b>criteria</b>
               The report criteria.

           <b>description</b>
               The report's description (e.g., "Turnaways by Month and Database").

           <b>periods</b>
               The periods for which the report contains counts, in the ISO 8601 standard form "YYYY-MM".

           <b>publisher</b>
               The publisher common to all of the resources in the report.

           <b>platform</b>
               The platform common to all of the resources in the report.

       <b>begin_body</b>(<u>$report</u>)
           Processing  of the report's body is beginning.  The body is the part of the report that contains data
           rows.

       <b>end_body</b>(<u>$report</u>)
           Processing of the report's body is complete.

       <b>begin_record</b>(<u>$report</u>, <u>$record</u>)
           Processing of a new record is beginning.  (In some COUNTER reports, a record occupies more  than  one
           row.)

           <u>$record</u> is a reference to a hash, which is empty at the time the event is triggered.

       <b>end_record</b>(<u>$report</u>, <u>$record</u>)
           <u>$record</u>  is  a  reference  to  a  hash  that contains the data found in the record (title, publisher,
           counts, etc.).  Fields that are invalid and uncorrectable will <b>not</b> be  represented  in  the  hash  --
           e.g., if a title is blank then there will be no <b>title</b> element in the hash.

   <b>Validation</b>
       Each of these events is triggered when a cell (or, in the case of <b>skip_blank_row</b>, a row) is validated.

       The cell's row and column (e.g., "D7") may be retrieved by calling "$report-&gt;current_position".

       Note  that  a  single  cell may trigger more than one validation event -- e.g., a cell may be trimmed and
       then deleted -- and there is no guarantee that these events will occur in any particular order.

       <b>ok</b>(<u>$report</u>, <u>$field_name</u>, <u>$value</u>)
           A cell's value is valid.

       <b>trimmed</b>(<u>$report</u>, <u>$field_name</u>, <u>$value</u>)
           Whitespace has been trimmed from the beginning and/or end of a cell.

       <b>fixed</b>(<u>$report</u>, <u>$field_name</u>, <u>$old_value</u>, <u>$new_value</u>)
           A cell's value was invalid but has been corrected.

       <b>cant_fix</b>(<u>$report</u>, <u>$field_name</u>, <u>$value</u>, <u>$expected</u>)
           A cell's value is invalid and cannot be corrected.  The expected value may be an exact string  (e.g.,
           "EBSCOhost") or merely a general hint (e.g., "&lt;issn&gt;").

       <b>deleted</b>(<u>$report</u>, <u>$value</u>)
           A  spurious  cell  has  been deleted.  (A this time, this only occurs for blank cells at the end of a
           row.)

       <b>skip_blank_row</b>(<u>$report</u>)
           A blank row that doesn't belong here has been skipped.

   <b>Tracing</b>
       <b>input</b>(<u>$line</u>)
           A line of input has been read.

       <b>line</b>(<u>$line_number</u>)
           The report processor has moved to the next line of input.

       <b>output</b>(<u>$line</u>)
           A new line of output is ready.  The default is to print the line to standard output.  Both valid  and
           invalid  lines,  including  invalid  lines that could not be corrected as well as those that could be
           corrected, trigger an output event.  Blank lines that have been skipped do not.

   <b>Data</b>
       <b>count</b>(<u>$report</u>, <u>$scope</u>, <u>$metric</u>, <u>$period</u>, <u>$value</u>)
           A valid count has been identified within the report.

           <u>$scope</u> is either "report" (for summary counts that appear at the top of the report) or "record"  (for
           counts that occur within the body of the report).

           <u>$metric</u> is the type of event being counted, and is always one of the following:

           "requests"
           "searches"
           "sessions"
           "turnaways"

           <u>$period</u> is a year and month, in the ISO8601 form "YYYY-MM".

           <u>$value</u> is the number of requests (or searches, or whatever).

           <b>count</b>  events are <b>not</b> triggered for blank counts unless the <b>treat_blank_counts_as_zero</b> option was set
           to a true value when the report was instantiated.

       <b>count_ytd</b>(<u>$report</u>, <u>$scope</u>, <u>$metric</u>, <u>$value</u>) =item <b>count_ytd_html</b>(<u>$report</u>, <u>$scope</u>, <u>$metric</u>, <u>$value</u>) =item
       <b>count_ytd_pdf</b>(<u>$report</u>, <u>$scope</u>, <u>$metric</u>, <u>$value</u>)
           A valid YTD count has been identified.

           <u>$scope</u> is either "report" (for summary counts that appear at the top of the report) or "record"  (for
           counts that occur within the body of the report).

</pre><h4><b>REPORTS</b> <b>SUPPORTED</b></h4><pre>
       Biblio::COUNTER implements processing of text-format (comma- or tab-delimited) COUNTER reports only.  XML
       formats are not supported at this time.

       The  following  is  a list of COUNTER reports, with full name and description, that are supported by this
       version of Biblio::COUNTER:

       "Journal Report 1 (R2)"
           Number of Successful Full-Text Article Requests by Month and Journal

       "Journal Report 1a (R2)"
           Number of Successful Full-Text Article Requests from an Archive by Month and Journal

       "Journal Report 2 (R2)"
           Turnaways by Month and Journal

       "Database Report 1 (R2)"
           Total Searches and Sessions by Month and Database

       "Database Report 2 (R2)"
           Turnaways by Month and Database

       "Database Report 3 (R2)"
           Total Searches and Sessions by Month and Service

       Other reports, including Release 3 reports, will be supported in the future.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       &lt;<a href="http://www.projectcounter.org/">http://www.projectcounter.org/</a>&gt;

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Hoffman (nkuitse AT cpan DOT org).

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2008 Paul M. Hoffman.

       This is free software, and is made available under the same terms as Perl itself.

perl v5.36.0                                       2023-02-04                               <u>Biblio::<a href="../man3pm/COUNTER.3pm.html">COUNTER</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>