<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAP::Parser::SourceHandler::Perl - Stream TAP from a Perl executable</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtest-harness-perl">libtest-harness-perl_3.50-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       TAP::Parser::SourceHandler::Perl - Stream TAP from a Perl executable

</pre><h4><b>VERSION</b></h4><pre>
       Version 3.50

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use TAP::Parser::Source;
         use TAP::Parser::SourceHandler::Perl;

         my $source = TAP::Parser::Source-&gt;new-&gt;raw( \'script.pl' );
         $source-&gt;assemble_meta;

         my $class = 'TAP::Parser::SourceHandler::Perl';
         my $vote  = $class-&gt;can_handle( $source );
         my $iter  = $class-&gt;make_iterator( $source );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This is a <u>Perl</u> TAP::Parser::SourceHandler - it has 2 jobs:

       1. Figure out if the TAP::Parser::Source it's given is actually a Perl script ("can_handle").

       2. Creates an iterator for Perl sources ("make_iterator").

       Unless you're writing a plugin or subclassing TAP::Parser, you probably won't need to use this module
       directly.

</pre><h4><b>METHODS</b></h4><pre>
   <b>Class</b> <b>Methods</b>
       <u>"can_handle"</u>

         my $vote = $class-&gt;can_handle( $source );

       Only votes if $source looks like a file.  Casts the following votes:

         0.9  if it has a shebang ala "#!...perl"
         0.3  if it has any shebang
         0.8  if it's a .t file
         0.9  if it's a .pl file
         0.75 if it's in a 't' directory
         0.25 by default (backwards compat)

       <u>"make_iterator"</u>

         my $iterator = $class-&gt;make_iterator( $source );

       Constructs &amp; returns a new TAP::Parser::Iterator::Process for the source.  Assumes "$source-&gt;raw"
       contains a reference to the perl script.  "croak"s if the file could not be found.

       The command to run is built as follows:

         $perl @switches $perl_script @test_args

       The perl command to use is determined by "get_perl".  The command generated is guaranteed to preserve:

         PERL5LIB
         PERL5OPT
         Taint Mode, if set in the script's shebang

       <u>Note:</u> the command generated will <u>not</u> respect any shebang line defined in your Perl script.  This is only
       a problem if you have compiled a custom version of Perl or if you want to use a specific version of Perl
       for one test and a different version for another, for example:

         #!/path/to/a/custom_perl --some --args
         #!/usr/local/perl-5.6/bin/perl -w

       Currently you need to write a plugin to get around this.

       <u>"get_taint"</u>

       Decode any taint switches from a Perl shebang line.

         # $taint will be 't'
         my $taint = TAP::Parser::SourceHandler::Perl-&gt;get_taint( '#!<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?perl">/usr/bin/perl</a> -t' );

         # $untaint will be undefined
         my $untaint = TAP::Parser::SourceHandler::Perl-&gt;get_taint( '#!<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?perl">/usr/bin/perl</a>' );

       <u>"get_perl"</u>

       Gets the version of Perl currently running the test suite.

</pre><h4><b>SUBCLASSING</b></h4><pre>
       Please see "SUBCLASSING" in TAP::Parser for a subclassing overview.

   <b>Example</b>
         package MyPerlSourceHandler;

         use strict;

         use TAP::Parser::SourceHandler::Perl;

         use base 'TAP::Parser::SourceHandler::Perl';

         # use the version of perl from the shebang line in the test file
         sub get_perl {
             my $self = shift;
             if (my $shebang = $self-&gt;shebang( $self-&gt;{file} )) {
                 $shebang =~ /^#!(.*\bperl.*?)(?:(?:\s)|(?:$))/;
                 return $1 if $1;
             }
             return $self-&gt;SUPER::get_perl(@_);
         }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       TAP::Object, TAP::Parser, TAP::Parser::IteratorFactory, TAP::Parser::SourceHandler,
       TAP::Parser::SourceHandler::Executable, TAP::Parser::SourceHandler::File,
       TAP::Parser::SourceHandler::Handle, TAP::Parser::SourceHandler::RawTAP

perl v5.40.0                                       2024-08-17              <u>TAP::Parser::SourceHandler::<a href="../man3pm/Perl.3pm.html">Perl</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>