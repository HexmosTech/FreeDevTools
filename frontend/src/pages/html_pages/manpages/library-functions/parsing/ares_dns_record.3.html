<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ares_dns_class_t,      ares_dns_flags_t,     ares_dns_opcode_t,     ares_dns_parse,     ares_dns_rcode_t,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libc-ares-dev">libc-ares-dev_1.34.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ares_dns_class_t,      ares_dns_flags_t,     ares_dns_opcode_t,     ares_dns_parse,     ares_dns_rcode_t,
       ares_dns_record_create,   ares_dns_record_destroy,   ares_dns_record_get_flags,   ares_dns_record_get_id,
       ares_dns_record_get_opcode,             ares_dns_record_get_rcode,             ares_dns_record_query_add,
       ares_dns_record_query_cnt, ares_dns_record_query_get, ares_dns_rec_type_t, ares_dns_write  -  DNS  Record
       parsing, writing, creating and destroying functions.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;ares.h&gt;

       void ares_dns_record_destroy(ares_dns_record_t *dnsrec);

       ares_status_t ares_dns_parse(const unsigned char *buf,
                                    size_t buf_len, unsigned int flags,
                                    ares_dns_record_t **dnsrec);

       ares_status_t ares_dns_write(const ares_dns_record_t *dnsrec,
                                    unsigned char **buf, size_t *buf_len);

       ares_status_t ares_dns_record_create(ares_dns_record_t **dnsrec,
                                            unsigned short      id,
                                            unsigned short      flags,
                                            ares_dns_opcode_t   opcode,
                                            ares_dns_rcode_t    rcode);

       ares_dns_record_t *ares_dns_record_duplicate(const ares_dns_record_t *dnsrec);

       unsigned short ares_dns_record_get_id(const ares_dns_record_t *dnsrec);

       ares_bool_t ares_dns_record_set_id(ares_dns_record_t *dnsrec,
                                          unsigned short id);

       unsigned short ares_dns_record_get_flags(const ares_dns_record_t *dnsrec);

       ares_dns_opcode_t ares_dns_record_get_opcode(const ares_dns_record_t *dnsrec);

       ares_dns_rcode_t ares_dns_record_get_rcode(const ares_dns_record_t *dnsrec);

       ares_status_t ares_dns_record_query_add(ares_dns_record_t  *dnsrec,
                                               const char         *name,
                                               ares_dns_rec_type_t qtype,
                                               ares_dns_class_t    qclass);

       ares_status_t ares_dns_record_query_set_name(ares_dns_record_t  *dnsrec,
                                                    size_t              idx,
                                                    const char         *name);

       ares_status_t ares_dns_record_query_set_type(ares_dns_record_t  *dnsrec,
                                                    size_t              idx,
                                                    ares_dns_rec_type_t qtype);

       size_t ares_dns_record_query_cnt(const ares_dns_record_t *dnsrec);

       ares_status_t ares_dns_record_query_get(const ares_dns_record_t *dnsrec,
                                               size_t idx, const char **name,
                                               ares_dns_rec_type_t *qtype,
                                               ares_dns_class_t *qclass);

</pre><h4><b>ENUMERATIONS</b></h4><pre>
       <b>ares_dns_rec_type_t</b>  <b>-</b>  DNS  Record  types  handled  by  c-ares.   Some record types may only be valid on
       requests, and some may only be valid on responses:
           <b>ARES_REC_TYPE_A</b> - Host address
           <b>ARES_REC_TYPE_NS</b> - Authoritative server
           <b>ARES_REC_TYPE_CNAME</b> - Canonical name
           <b>ARES_REC_TYPE_SOA</b> - Start of authority zone
           <b>ARES_REC_TYPE_PTR</b> - Domain name pointer
           <b>ARES_REC_TYPE_HINFO</b> - Host information
           <b>ARES_REC_TYPE_MX</b> - Mail routing information
           <b>ARES_REC_TYPE_TXT</b> - Text strings
           <b>ARES_REC_TYPE_SIG</b> - RFC 2535. RFC 2931. SIG Record
           <b>ARES_REC_TYPE_AAAA</b> - RFC 3596. Ip6 Address
           <b>ARES_REC_TYPE_SRV</b> - RFC 2782. Server Selection
           <b>ARES_REC_TYPE_NAPTR</b> - RFC 3403. Naming Authority Pointer
           <b>ARES_REC_TYPE_OPT</b> - RFC 6891. EDNS0 option (meta-RR). Pseudo Record.
           <b>ARES_REC_TYPE_TLSA</b> - RFC 6698. DNS-Based Authentication of  Named  Entities  (DANE)  Transport  Layer
           Security (TLS) Protocol: TLSA
           <b>ARES_REC_TYPE_SVCB</b> - RFC 9460. General Purpose Service Binding
           <b>ARES_REC_TYPE_HTTPS</b> <b>-</b> - RFC 9460. Service Binding type for use with HTTPS
           <b>ARES_REC_TYPE_ANY</b> - Wildcard match.  Not response RR
           <b>ARES_REC_TYPE_URI</b> - RFC 7553. Uniform Resource Identifier
           <b>ARES_REC_TYPE_CAA</b> - RFC 6844. Certification Authority Authorization
           <b>ARES_REC_TYPE_RAW_RR</b>  -  Used  as an indicator that the RR record is not parsed, but provided in wire
           format

       <b>ares_dns_class_t</b> <b>-</b> DNS Classes for requests and responses:
           <b>ARES_CLASS_IN</b> - Internet
           <b>ARES_CLASS_CHAOS</b> - CHAOS
           <b>ARES_CLASS_HESOID</b> - Hesoid [Dyer 87]
           <b>ARES_CLASS_NONE</b> - RFC 2136
           <b>ARES_CLASS_ANY</b> - Any class (requests only)

       <b>ares_dns_opcode_t</b> <b>-</b> DNS Header Opcodes:
           <b>ARES_OPCODE_QUERY</b> - Standard query
           <b>ARES_OPCODE_IQUERY</b> - Inverse query. Obsolete
           <b>ARES_OPCODE_STATUS</b> - Name server status query
           <b>ARES_OPCODE_NOTIFY</b> - Zone change notification (RFC 1996)
           <b>ARES_OPCODE_UPDATE</b> - Zone update message (RFC 2136)

       <b>ares_dns_flags_t</b> <b>-</b> DNS Header Flags:
           <b>ARES_FLAG_QR</b> - QR. If set, is a response
           <b>ARES_FLAG_AA</b> - Authoritative Answer. If set, is authoritative
           <b>ARES_FLAG_TC</b> - Truncation. If set, is truncated response
           <b>ARES_FLAG_RD</b> - Recursion Desired. If set, recursion is desired
           <b>ARES_FLAG_RA</b> - Recursion Available. If set, server supports recursion
           <b>ARES_FLAG_AD</b> - RFC 2065. Authentic Data bit indicates in a response that the data included  has  been
           verified by the server providing it
           <b>ARES_FLAG_CD</b>  -  RFC  2065.  Checking  Disabled  bit  indicates  in a query that non-verified data is
           acceptable to the resolver sending the query

       <b>ares_dns_rcode_t</b> <b>-</b> DNS Response codes from server:
           <b>ARES_RCODE_NOERROR</b> - Success
           <b>ARES_RCODE_FORMERR</b> - Format error. The name server was unable to interpret the query
           <b>ARES_RCODE_SERVFAIL</b> - Server Failure. The name server was unable to  process  this  query  due  to  a
           problem with the nameserver
           <b>ARES_RCODE_NXDOMAIN</b>  -  Name Error.  Meaningful only for responses from an authoritative name server,
           this code signifies that the domain name referenced in the query does not exist.
           <b>ARES_RCODE_NOTIMP</b> - Not implemented.  The name server does not support the requested kind of query
           <b>ARES_RCODE_REFUSED</b> - Refused. The name server refuses to perform the specified operation  for  policy
           reasons.
           <b>ARES_RCODE_YXDOMAIN</b> - RFC 2136. Some name that ought not to exist, does exist
           <b>ARES_RCODE_YXRRSET</b> - RFC 2136. Some RRset that ought to not exist, does exist
           <b>ARES_RCODE_NXRRSET</b> - RFC 2136. Some RRset that ought to exist, does not exist
           <b>ARES_RCODE_NOTAUTH</b>  -  RFC  2136.  The  server  is  not  authoritative for the zone named in the Zone
           section.
           <b>ARES_RCODE_NOTZONE</b> - RFC 2136. A name used in the Prerequisite or Update Section is  not  within  the
           zone denoted by the Zone Section.
           <b>ARES_RCODE_DSOTYPEI</b> - RFC 8409. DSO-TYPE Not implemented
           <b>ARES_RCODE_BADSIG</b> - RFC 8945. TSIG Signature Failure
           <b>ARES_RCODE_BADKEY</b> - RFC 8945. Key not recognized
           <b>ARES_RCODE_BADTIME</b> - RFC 8945. Signature out of time window
           <b>ARES_RCODE_BADMODE</b> - RFC 2930. Bad TKEY Mode
           <b>ARES_RCODE_BADNAME</b> - RFC 2930. Duplicate Key Name
           <b>ARES_RCODE_BADALG</b> - RFC 2930. Algorithm not supported
           <b>ARES_RCODE_BADTRUNC</b> - RFC 8945. Bad Truncation
           <b>ARES_RCODE_BADCOOKIE</b> - RFC 7973. Bad/missing Server Cookie

       <b>ares_dns_parse_flags_t</b> <b>-</b> Flags for altering <u><a href="../man3/ares_dns_parse.3.html">ares_dns_parse</a>(3)</u> behaviour:
           <b>ARES_DNS_PARSE_AN_BASE_RAW</b> - Parse Answer Section from RFC 1035 that allow name compression as RAW RR
           type
           <b>ARES_DNS_PARSE_NS_BASE_RAW</b> - Parse Authority Section from RFC 1035 that allow name compression as RAW
           RR type
           <b>ARES_DNS_PARSE_AR_BASE_RAW</b>  -  Parse  Additional Section from RFC 1035 that allow name compression as
           RAW RR type
           <b>ARES_DNS_PARSE_AN_EXT_RAW</b> - Parse Answer Section from later RFCs (no name compression) as RAW RR type
           <b>ARES_DNS_PARSE_NS_EXT_RAW</b> - Parse Authority Section from later RFCs (no name compression) as  RAW  RR
           type
           <b>ARES_DNS_PARSE_AR_EXT_RAW</b>  - Parse Additional Section from later RFCs (no name compression) as RAW RR
           type

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <u><a href="../man3/ares_dns_record_destroy.3.html">ares_dns_record_destroy</a>(3)</u> function destroys the memory associated with the  dns  record  created  by
       either <u><a href="../man3/ares_dns_record_create.3.html">ares_dns_record_create</a>(3)</u> or <u><a href="../man3/ares_dns_parse.3.html">ares_dns_parse</a>(3)</u> passed in via <u>dnsrec</u>.

       The  <u><a href="../man3/ares_dns_parse.3.html">ares_dns_parse</a>(3)</u>  function  parses the buffer provided in <u>buf</u> with length provided in <u>buf_len.</u>  The
       <u>flags</u> parameter can be one or more <u>ares_dns_parse_flags_t</u>, or zero if no flags are needed.  The resulting
       dns record data structure is stored into the variable pointed to by <u>dnsrec</u> and must  be  destroyed  using
       <u><a href="../man3/ares_dns_record_destroy.3.html">ares_dns_record_destroy</a>(3)</u>.

       The  <u><a href="../man3/ares_dns_write.3.html">ares_dns_write</a>(3)</u> function takes a populated DNS record structure in <u>dnsrec</u> and writes a wire-format
       DNS message into the variable pointed to by <u>buf</u> and writes the length of the  buffer  into  the  variable
       pointed to by <u>buf_len.</u>  The buffer must be destroyed using <u><a href="../man3/ares_free_string.3.html">ares_free_string</a>(3)</u>.

       The  <u><a href="../man3/ares_dns_record_create.3.html">ares_dns_record_create</a>(3)</u>  function creates an empty DNS record structure in the variable pointed to
       by <u>dnsrec.</u>  The <u>id</u> parameter is the DNS message id, however if passing to  <u><a href="../man3/ares_send.3.html">ares_send</a>(3)</u>  this  identifier
       will  be overwritten, so should typically be 0. The <u>flags</u> parameter is one or more <u>ares_dns_flags_t</u>.  The
       opcode is passed in the <u>opcode</u> parameter and should typically be <u>ARES_OPCODE_QUERY</u>.  The response code is
       meant mostly for responses and is passed in the <u>rcode</u> parameter and is typically <u>ARES_RCODE_NOERROR</u>.

       The <u><a href="../man3/ares_dns_record_duplicate.3.html">ares_dns_record_duplicate</a>(3)</u> function duplicates an existing  DNS  record  structure.   This  may  be
       useful  if  needing to save a result as retrieved from <u><a href="../man3/ares_send_dnsrec.3.html">ares_send_dnsrec</a>(3)</u> or <u><a href="../man3/ares_search_dnsrec.3.html">ares_search_dnsrec</a>(3)</u>.  The
       structure to be duplicated is passed in the <u>dnsrec</u> parameter, and the duplicated  copy  is  returned,  or
       NULL on error such as out of memory.

       The  <u><a href="../man3/ares_dns_record_get_id.3.html">ares_dns_record_get_id</a>(3)</u>  function  is  used  to  retrieve  the  DNS message id from the DNS record
       provided in the <u>dnsrec</u> parameter.

       The <u><a href="../man3/ares_dns_record_set_id.3.html">ares_dns_record_set_id</a>(3)</u> function is used to set the DNS message id in the <u>id</u> parameter from the DNS
       record provided in the <u>dnsrec</u> parameter.  This id will be overwritten when passing the record to  c-ares,
       so mostly exists for external purposes.

       The  <u><a href="../man3/ares_dns_record_get_flags.3.html">ares_dns_record_get_flags</a>(3)</u>  function is used to retrieve the DNS message flags from the DNS record
       provided in the <u>dnsrec</u> parameter.

       The <u><a href="../man3/ares_dns_record_get_opcode.3.html">ares_dns_record_get_opcode</a>(3)</u> function is used to retrieve the DNS message flags from the DNS  record
       provided in the <u>dnsrec</u> parameter.

       The  <u><a href="../man3/ares_dns_record_get_rcode.3.html">ares_dns_record_get_rcode</a>(3)</u> function is used to retrieve the DNS message response code from the DNS
       record provided in the <u>dnsrec</u> parameter.

       The <u><a href="../man3/ares_dns_record_query_add.3.html">ares_dns_record_query_add</a>(3)</u> function is used to add a question to the DNS  record  provided  in  the
       <u>dnsrec</u>  parameter.   The  domain name specified for the question is provided in the <u>name</u> parameter, along
       with the question type in the <u>qtype</u> parameter and the question class  (typically  <u>ARES_CLASS_IN</u>)  in  the
       <u>qclass</u> parameter.

       The  <u><a href="../man3/ares_dns_record_query_set_name.3.html">ares_dns_record_query_set_name</a>(3)</u>  function  is  used  to modify the question name in the DNS record
       provided  in  the  <u>dnsrec</u>  parameter.   The   index   of   the   query,   which   must   be   less   than
       <u><a href="../man3/ares_dns_record_query_cnt.3.html">ares_dns_record_query_cnt</a>(3)</u>,  is  provided  in the <u>idx</u> parameter. The new domain name is provided in the
       <u>name</u> parameter. Care should be taken as this will cause invalidation of any <u>name</u> pointer  retrieved  from
       <u><a href="../man3/ares_dns_Record_query_get.3.html">ares_dns_Record_query_get</a>(3)</u>.   This  function  is useful if sending multiple similar queries without re-
       creating the entire DNS query.

       The <u><a href="../man3/ares_dns_record_query_set_type.3.html">ares_dns_record_query_set_type</a>(3)</u> function is used to modify the question  type  in  the  DNS  record
       provided   in   the   <u>dnsrec</u>   parameter.    The   index   of   the   query,  which  must  be  less  than
       <u><a href="../man3/ares_dns_record_query_cnt.3.html">ares_dns_record_query_cnt</a>(3)</u>, is provided in the <u>idx</u> parameter. The new query type  is  provided  in  the
       <u>qtype</u> parameter.

       The  <u><a href="../man3/ares_dns_record_query_cnt.3.html">ares_dns_record_query_cnt</a>(3)</u>  function  is  used  to retrieve the number of DNS questions in the DNS
       record provided in the <u>dnsrec</u> parameter.

       The <u><a href="../man3/ares_dns_record_query_get.3.html">ares_dns_record_query_get</a>(3)</u> function is used to retrieve the details of a single DNS question in the
       provided <u>dnsrec</u> parameter.  The index provided in the <u>idx</u> parameter must be less than the value  returned
       from  <u><a href="../man3/ares_dns_record_query_cnt.3.html">ares_dns_record_query_cnt</a>(3)</u>.  The DNS question name will be returned in the variable pointed to by
       the <u>name</u> parameter, this may be provided as NULL if the  name  is  not  needed.   This  pointer  will  be
       invalided  by  any  call to <u><a href="../man3/ares_dns_record_query_set_name.3.html">ares_dns_record_query_set_name</a>(3)</u>.  The DNS question type will be returned in
       the variable pointed to by the <u>qtype</u> parameter, this may be provided as NULL if the type is  not  needed.
       The  DNS  question class will be returned in the variable pointed to by the <u>qclass</u> parameter, this may be
       provided as NULL if the class is not needed.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <u><a href="../man3/ares_dns_parse.3.html">ares_dns_parse</a>(3)</u>,  <u><a href="../man3/ares_dns_write.3.html">ares_dns_write</a>(3)</u>,   <u><a href="../man3/ares_dns_record_create.3.html">ares_dns_record_create</a>(3)</u>,   <u><a href="../man3/ares_dns_record_query_add.3.html">ares_dns_record_query_add</a>(3)</u>,   and
       <u><a href="../man3/ares_dns_record_query_get.3.html">ares_dns_record_query_get</a>(3)</u>  all  return  an  <u>ares_status_t</u>  error  code.   <b>ARES_SUCCESS</b>  is returned on
       success, <b>ARES_ENOMEM</b> is returned on out of memory, <b>ARES_EFORMERR</b> is returned on misuse.

       <u><a href="../man3/ares_dns_record_get_id.3.html">ares_dns_record_get_id</a>(3)</u>,            <u><a href="../man3/ares_dns_record_set_id.3.html">ares_dns_record_set_id</a>(3)</u>,            <u><a href="../man3/ares_dns_record_get_flags.3.html">ares_dns_record_get_flags</a>(3)</u>,
       <u><a href="../man3/ares_dns_record_get_opcode.3.html">ares_dns_record_get_opcode</a>(3)</u>,   <u><a href="../man3/ares_dns_record_get_rcode.3.html">ares_dns_record_get_rcode</a>(3)</u>,   and   <u><a href="../man3/ares_dns_record_query_cnt.3.html">ares_dns_record_query_cnt</a>(3)</u>   all
       returned their prescribed datatype values and in general can't fail except for misuse cases, in which a 0
       may be returned, however 0 can also be a valid return value for most of these functions.

</pre><h4><b>AVAILABILITY</b></h4><pre>
       These functions were first introduced in c-ares version 1.22.0.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/ares_dns_mapping.3.html">ares_dns_mapping</a></b>(3), <b><a href="../man3/ares_dns_rr.3.html">ares_dns_rr</a></b>(3), <b><a href="../man3/ares_free_string.3.html">ares_free_string</a></b>(3)

                                                12 November 2023                              <u><a href="../man3/ARES_DNS_RECORD.3.html">ARES_DNS_RECORD</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>