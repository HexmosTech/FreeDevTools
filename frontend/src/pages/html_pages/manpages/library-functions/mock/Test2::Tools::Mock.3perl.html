<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test2::Tools::Mock - Class/Instance mocking for Test2.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/perl-doc">perl-doc_5.40.1-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Test2::Tools::Mock - Class/Instance mocking for Test2.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Mocking is often an essential part of testing. This library covers some of the most common mocking needs.
       This plugin is heavily influenced by Mock::Quick, but with an improved API. This plugin is also intended
       to play well with other plugins in ways Mock::Quick would be unable to.

</pre><h4><b>SYNOPSIS</b></h4><pre>
           my $mock = mock 'Some::Class' =&gt; (
               track =&gt; $BOOL, # Enable/Disable tracking on subs defined below

               add =&gt; [
                   new_method =&gt; sub { ... },
               ],
               override =&gt; [
                   replace_method =&gt; sub { ... },
               ],
               set =&gt; [
                   replace_or_inject =&gt; sub { ... },
               ],

               track =&gt; $bool, # enable/disable tracking again to affect mocks made after this point
               ..., # Argument keys may be repeated
           );

           Some::Class-&gt;new_method();        # Calls the newly injected method
           Some::Class-&gt;replace_method();    # Calls our replacement method.

           $mock-&gt;override(...) # Override some more

           $mock = undef; # Undoes all the mocking, restoring all original methods.

           my $simple_mock = mock {} =&gt; (
               add =&gt; [
                   is_active =&gt; sub { ... }
               ]
           );

           $simple_mock-&gt;is_active();        # Calls our newly mocked method.

</pre><h4><b>EXPORTS</b></h4><pre>
   <b>DEFAULT</b>
       mock
           This  is  a  one-stop shop function that delegates to one of the other methods depending on how it is
           used. If you are not comfortable with a function that has a lot of potential behaviors, you  can  use
           one of the other functions directly.

       @mocks = mocked($object)
       @mocks = mocked($class)
           Check  if  an  object  or  class is mocked. If it is mocked the $mock object(s) (Test2::Mock) will be
           returned.

       $mock = mock $class =&gt; ( ... );
       $mock = mock $instance =&gt; ( ... )
       $mock = mock 'class', $class =&gt; ( ... )
           These forms delegate to mock_class() to mock a package. The third form is to be explicit  about  what
           type of mocking you want.

       $obj = <b>mock()</b>
       $obj = mock { ... }
       $obj = mock 'obj', ...;
           These  forms  delegate  to  mock_obj()  to  create  instances of anonymous packages where methods are
           vivified into existence as needed.

       mock $mock =&gt; sub { ... }
       mock $method =&gt; ( ... )
           These forms go together, the first form will set $mock as the current mock build, then run  the  sub.
           Within the sub you can declare mock specifications using the second form. The first form delegates to
           mock_build().

           The  second  form  calls  the  specified  method  on the current build. This second form delegates to
           mock_do().

   <b>BY</b> <b>REQUEST</b>
       <u>DEFINING</u> <u>MOCKS</u>

       $obj = mock_obj( ... )
       $obj = mock_obj { ... } =&gt; ( ... )
       $obj = mock_obj sub { ... }
       $obj = mock_obj { ... } =&gt; sub { ... }
           This method lets you quickly generate a blessed object. The object will be an instance of a  randomly
           generated package name. Methods will vivify as read/write accessors as needed.

           Arguments  can  be  any  method  available  to Test2::Mock followed by an argument. If the very first
           argument is a hashref then it will be blessed as your new object.

           If you provide a coderef instead of key/value pairs, the coderef will be run to build the mock.  (See
           the "BUILDING MOCKS" section).

       $mock = mock_class $class =&gt; ( ... )
       $mock = mock_class $instance =&gt; ( ... )
       $mock = mock_class ... =&gt; sub { ... }
           This  will  create  a  new instance of Test2::Mock to control the package specified. If you give it a
           blessed reference it will use the class of the instance.

           Arguments can be any method available to Test2::Mock followed by  an  argument.  If  the  very  first
           argument is a hashref then it will be blessed as your new object.

           If  you provide a coderef instead of key/value pairs, the coderef will be run to build the mock. (See
           the "BUILDING MOCKS" section).

       <u>BUILDING</u> <u>MOCKS</u>

       mock_build $mock =&gt; sub { ... }
           Set $mock as the current build, then run the specified code. $mock will  no  longer  be  the  current
           build when the sub is complete.

       $mock = <b>mock_building()</b>
           Get the current building $mock object.

       mock_do $method =&gt; $args
           Run the specified method on the currently building object.

       <u>METHOD</u> <u>GENERATORS</u>

       $sub = mock_accessor $field
           Generate a read/write accessor for the specified field. This will generate a sub like the following:

               $sub = sub {
                   my $self = shift;
                   ($self-&gt;{$field}) = @_ if @_;
                   return $self-&gt;{$field};
               };

       $sub = mock_getter $field
           Generate a read only accessor for the specified field. This will generate a sub like the following:

               $sub = sub {
                   my $self = shift;
                   return $self-&gt;{$field};
               };

       $sub = mock_setter $field
           Generate a write accessor for the specified field. This will generate a sub like the following:

               $sub = sub {
                   my $self = shift;
                   ($self-&gt;{$field}) = @_;
               };

       %pairs = mock_accessors(qw/name1 name2 name3/)
           Generates  several  read/write  accessors at once, returns key/value pairs where the key is the field
           name, and the value is the coderef.

       %pairs = mock_getters(qw/name1 name2 name3/)
           Generates several read only accessors at once, returns key/value pairs where the  key  is  the  field
           name, and the value is the coderef.

       %pairs = mock_setters(qw/name1 name2 name3/)
           Generates  several  write accessors at once, returns key/value pairs where the key is the field name,
           and the value is the coderef.

</pre><h4><b>MOCK</b> <b>CONTROL</b> <b>OBJECTS</b></h4><pre>
           my $mock = mock(...);

       Mock objects are instances of Test2::Mock. See it for their methods.

</pre><h4><b>SOURCE</b></h4><pre>
       The source code repository for Test2-Suite can be found at &lt;https://github.com/Test-More/Test2-Suite/&gt;.

</pre><h4><b>MAINTAINERS</b></h4><pre>
       Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;

</pre><h4><b>AUTHORS</b></h4><pre>
       Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2018 Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;.

       This program is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself.

       See &lt;https://dev.perl.org/licenses/&gt;

perl v5.40.1                                       2025-07-27                          <u>Test2::Tools::<a href="../man3perl/Mock.3perl.html">Mock</a></u>(3perl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>