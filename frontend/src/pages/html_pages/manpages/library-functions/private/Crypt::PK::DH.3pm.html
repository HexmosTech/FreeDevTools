<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypt::PK::DH - Public key cryptography based on Diffie-Hellman</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcryptx-perl">libcryptx-perl_0.085-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Crypt::PK::DH - Public key cryptography based on Diffie-Hellman

</pre><h4><b>SYNOPSIS</b></h4><pre>
        ### OO interface

        #Shared secret
        my $priv = Crypt::PK::DH-&gt;new('Alice_priv_dh1.key');
        my $pub = Crypt::PK::DH-&gt;new('Bob_pub_dh1.key');
        my $shared_secret = $priv-&gt;shared_secret($pub);

        #Key generation
        my $pk = Crypt::PK::DH-&gt;new();
        $pk-&gt;<a href="../man128/generate_key.128.html">generate_key</a>(128);
        my $private = $pk-&gt;export_key('private');
        my $public = $pk-&gt;export_key('public');

        or

        my $pk = Crypt::PK::DH-&gt;new();
        $pk-&gt;generate_key('ike2048');
        my $private = $pk-&gt;export_key('private');
        my $public = $pk-&gt;export_key('public');

        or

        my $pk = Crypt::PK::DH-&gt;new();
        $pk-&gt;generate_key({ p =&gt; $p, g =&gt; $g });
        my $private = $pk-&gt;export_key('private');
        my $public = $pk-&gt;export_key('public');

        ### Functional interface

        #Shared secret
        my $shared_secret = dh_shared_secret('Alice_priv_dh1.key', 'Bob_pub_dh1.key');

</pre><h4><b>METHODS</b></h4><pre>
   <b>new</b>
         my $pk = Crypt::PK::DH-&gt;new();
         #or
         my $pk = Crypt::PK::DH-&gt;new($priv_or_pub_key_filename);
         #or
         my $pk = Crypt::PK::DH-&gt;new(\$buffer_containing_priv_or_pub_key);

   <b>generate_key</b>
       Uses Yarrow-based cryptographically strong random number generator seeded with random data taken from
       "/dev/random" (UNIX) or "CryptGenRandom" (Win32).

        $pk-&gt;generate_key($groupsize);
        ### $groupsize (in bytes) corresponds to DH parameters (p, g) predefined by libtomcrypt
        # 96   =&gt;  DH-768
        # 128  =&gt;  DH-1024
        # 192  =&gt;  DH-1536
        # 256  =&gt;  DH-2048
        # 384  =&gt;  DH-3072
        # 512  =&gt;  DH-4096
        # 768  =&gt;  DH-6144
        # 1024 =&gt;  DH-8192

       The following variants are available since CryptX-0.032

        $pk-&gt;generate_key($groupname)
        ### $groupname corresponds to values defined in RFC7296 and RFC3526
        # 'ike768'  =&gt;  768-bit MODP (Group 1)
        # 'ike1024' =&gt; 1024-bit MODP (Group 2)
        # 'ike1536' =&gt; 1536-bit MODP (Group 5)
        # 'ike2048' =&gt; 2048-bit MODP (Group 14)
        # 'ike3072' =&gt; 3072-bit MODP (Group 15)
        # 'ike4096' =&gt; 4096-bit MODP (Group 16)
        # 'ike6144' =&gt; 6144-bit MODP (Group 17)
        # 'ike8192' =&gt; 8192-bit MODP (Group 18)

        $pk-&gt;generate_key($param_hash)
        # $param_hash is { g =&gt; $g, p =&gt; $p }
        # where $g is the generator (base) in a hex string and $p is the prime in a hex string

        $pk-&gt;generate_key(\$dh_param)
        # $dh_param is the content of DER or PEM file with DH parameters
        # e.g. openssl dhparam 2048

   <b>import_key</b>
       Loads private or public key (exported by "export_key").

         $pk-&gt;import_key($filename);
         #or
         $pk-&gt;import_key(\$buffer_containing_key);

   <b>import_key_raw</b>
       <u>Since:</u> <u>CryptX-0.032</u>

         $pk-&gt;import_key_raw($raw_bytes, $type, $params)
         ### $raw_bytes is a binary string containing the key
         ### $type is either 'private' or 'public'
         ### $param is either a name ('ike2038') or hash containing the p,g values { g=&gt;$g, p=&gt;$p }
         ### in hex strings

   <b>export_key</b>
       <b>BEWARE:</b> DH key format change - since v0.049 it is compatible with libtomcrypt 1.18.

        my $private = $pk-&gt;export_key('private');
        #or
        my $public = $pk-&gt;export_key('public');

   <b>export_key_raw</b>
       <u>Since:</u> <u>CryptX-0.032</u>

        $raw_bytes = $dh-&gt;export_key_raw('public')
        #or
        $raw_bytes = $dh-&gt;export_key_raw('private')

   <b>shared_secret</b>
        # Alice having her priv key $pk and Bob's public key $pkb
        my $pk  = Crypt::PK::DH-&gt;new($priv_key_filename);
        my $pkb = Crypt::PK::DH-&gt;new($pub_key_filename);
        my $shared_secret = $pk-&gt;shared_secret($pkb);

        # Bob having his priv key $pk and Alice's public key $pka
        my $pk = Crypt::PK::DH-&gt;new($priv_key_filename);
        my $pka = Crypt::PK::DH-&gt;new($pub_key_filename);
        my $shared_secret = $pk-&gt;shared_secret($pka);  # same value as computed by Alice

   <b>is_private</b>
        my $rv = $pk-&gt;is_private;
        # 1 .. private key loaded
        # 0 .. public key loaded
        # undef .. no key loaded

   <b>size</b>
        my $size = $pk-&gt;size;
        # returns key size in bytes or undef if no key loaded

   <b>key2hash</b>
        my $hash = $pk-&gt;key2hash;

        # returns hash like this (or undef if no key loaded):
        {
          type =&gt; 0,   # integer: 1 .. private, 0 .. public
          size =&gt; 256, # integer: key size in bytes
          x =&gt; "FBC1062F73B9A17BB8473A2F5A074911FA7F20D28FB...", #private key
          y =&gt; "AB9AAA40774D3CD476B52F82E7EE2D8A8D40CD88BF4...", #public key
          g =&gt; "2", # generator/base
          p =&gt; "FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80D...", # prime
       }

   <b>params2hash</b>
       <u>Since:</u> <u>CryptX-0.032</u>

        my $params = $pk-&gt;params2hash;

        # returns hash like this (or undef if no key loaded):
        {
          g =&gt; "2", # generator/base
          p =&gt; "FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80D...", # prime
       }

</pre><h4><b>FUNCTIONS</b></h4><pre>
   <b>dh_shared_secret</b>
       DH based shared secret generation. See method "shared_secret" below.

        #on Alice side
        my $shared_secret = dh_shared_secret('Alice_priv_dh1.key', 'Bob_pub_dh1.key');

        #on Bob side
        my $shared_secret = dh_shared_secret('Bob_priv_dh1.key', 'Alice_pub_dh1.key');

</pre><h4><b>DEPRECATED</b> <b>INTERFACE</b></h4><pre>
       The following functions/methods were removed in removed in v0.049:

        encrypt
        decrypt
        sign_message
        verify_message
        sign_hash
        verify_hash

        dh_encrypt
        dh_decrypt
        dh_sign_message
        dh_verify_message
        dh_sign_hash
        dh_verify_hash

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       â€¢   &lt;https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange&gt;

perl v5.40.0                                       2025-02-15                                 <u>Crypt::PK::<a href="../man3pm/DH.3pm.html">DH</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>