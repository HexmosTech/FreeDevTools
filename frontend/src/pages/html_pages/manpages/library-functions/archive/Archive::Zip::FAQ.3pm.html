<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive::Zip::FAQ - Answers to a few frequently asked questions about Archive::Zip</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libarchive-zip-perl">libarchive-zip-perl_1.68-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Archive::Zip::FAQ - Answers to a few frequently asked questions about Archive::Zip

</pre><h4><b>DESCRIPTION</b></h4><pre>
       It seems that I keep answering the same questions over and over again. I assume that this is because my
       documentation is deficient, rather than that people don't read the documentation.

       So this FAQ is an attempt to cut down on the number of personal answers I have to give. At least I can
       now say "You <u>did</u> read the FAQ, right?".

       The questions are not in any particular order. The answers assume the current version of Archive::Zip;
       some of the answers depend on newly added/fixed functionality.

</pre><h4><b>Install</b> <b>problems</b> <b>on</b> <b>RedHat</b> <b>8</b> <b>or</b> <b>9</b> <b>with</b> <b>Perl</b> <b>5.8.0</b></h4><pre>
       <b>Q:</b> Archive::Zip won't install on my RedHat 9 system! It's broke!

       <b>A:</b> This has become something of a FAQ.  Basically, RedHat broke some versions of Perl by setting LANG to
       UTF8.  They apparently have a fixed version out as an update.

       You might try running CPAN or creating your Makefile after exporting the LANG environment variable as

       "LANG=C"

       &lt;https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=87682&gt;

</pre><h4><b>Why</b> <b>is</b> <b>my</b> <b>zip</b> <b>file</b> <b>so</b> <b>big?</b></h4><pre>
       <b>Q:</b> My zip file is actually bigger than what I stored in it! Why?

       <b>A:</b> Some things to make sure of:

       Make sure that you are requesting COMPRESSION_DEFLATED if you are storing strings.
           $member-&gt;desiredCompressionMethod( COMPRESSION_DEFLATED );

       Don't make lots of little files if you can help it.
           Since  zip  computes the compression tables for each member, small members without much entropy won't
           compress well.  Instead, if you've got lots of repeated strings in your data,  try  to  combine  them
           into one big member.

       Make sure that you are requesting COMPRESSION_STORED if you are storing things that are already
       compressed.
           If  you're  storing  a  .zip, .jpg, .mp3, or other compressed file in a zip, then don't compress them
           again. They'll get bigger.

</pre><h4><b>Sample</b> <b>code?</b></h4><pre>
       <b>Q:</b> Can you send me code to do (whatever)?

       <b>A:</b> Have you looked in the "examples/" directory yet? It contains:

       examples/calcSizes.pl    -- How to find out how big a Zip file will be before writing it
       examples/copy.pl         -- Copies one Zip file to another
       examples/extract.pl      -- extract file(s) from a Zip
       examples/mailZip.pl      -- make and mail a zip file
       examples/mfh.pl          -- demo for use of MockFileHandle
       examples/readScalar.pl   -- shows how to use IO::Scalar as the source of a Zip read
       examples/selfex.pl       -- a brief example of a self-extracting Zip
       examples/unzipAll.pl     -- uses Archive::Zip::Tree to unzip an entire Zip
       examples/updateZip.pl    -- shows how to read/modify/write a Zip
       examples/updateTree.pl   -- shows how to update a Zip in place
       examples/writeScalar.pl  -- shows how to use IO::Scalar as the destination of a Zip write
       examples/writeScalar2.pl -- shows how to use IO::String as the destination of a Zip write
       examples/zip.pl          -- Constructs a Zip file
       examples/zipcheck.pl     -- One way to check a Zip file for validity
       examples/zipinfo.pl      -- Prints out information about a Zip archive file
       examples/zipGrep.pl      -- Searches for text in Zip files
       examples/ziptest.pl      -- Lists a Zip file and checks member CRCs
       examples/ziprecent.pl    -- Puts recent files into a zipfile
       examples/ziptest.pl      -- Another way to check a Zip file for validity

</pre><h4><b>Can't</b> <b>Read/modify/write</b> <b>same</b> <b>Zip</b> <b>file</b></h4><pre>
       <b>Q:</b> Why can't I open a Zip file, add a member, and write it back? I get an error message when I try.

       <b>A:</b> Because Archive::Zip doesn't (and can't, generally) read file contents into memory, the  original  Zip
       file is required to stay around until the writing of the new file is completed.

       The  best  way  to  do this is to write the Zip to a temporary file and then rename the temporary file to
       have the old name (possibly after deleting the old one).

       Archive::Zip v1.02 added the archive methods "overwrite()" and "overwriteAs()"  to  do  this  simply  and
       carefully.

       See "examples/updateZip.pl" for an example of this technique.

</pre><h4><b>File</b> <b>creation</b> <b>time</b> <b>not</b> <b>set</b></h4><pre>
       <b>Q:</b> Upon extracting files, I see that their modification (and access) times are set to the time in the Zip
       archive. However, their creation time is not set to the same time. Why?

       <b>A:</b>  Mostly  because Perl doesn't give cross-platform access to <u>creation</u> <u>time</u>.  Indeed, many systems (like
       Unix) don't support such a concept.  However, if yours does, you can easily set it. Get the  modification
       time from the member using "lastModTime()".

</pre><h4><b>Can't</b> <b>use</b> <b>Archive::Zip</b> <b>on</b> <b>gzip</b> <b>files</b></h4><pre>
       <b>Q:</b> Can I use Archive::Zip to extract Unix gzip files?

       <b>A:</b> No.

       There is a distinction between Unix gzip files, and Zip archives that also can use the gzip compression.

       Depending  on the format of the gzip file, you can use Compress::Raw::Zlib, or Archive::Tar to decompress
       it (and de-archive it in the case of Tar files).

       You can unzip PKZIP/WinZip/etc/ archives using Archive::Zip  (that's  what  it's  for)  as  long  as  any
       compressed members are compressed using Deflate compression.

</pre><h4><b>Add</b> <b>a</b> <b>directory/tree</b> <b>to</b> <b>a</b> <b>Zip</b></h4><pre>
       <b>Q:</b> How can I add a directory (or tree) full of files to a Zip?

       <b>A:</b> You can use the Archive::Zip::addTree*() methods:

          use Archive::Zip;
          my $zip = Archive::Zip-&gt;new();
          # add all readable files and directories below . as xyz/*
          $zip-&gt;addTree( '.', 'xyz' );
          # add all readable plain files below /abc as def/*
          $zip-&gt;addTree( '/abc', 'def', sub { -f &amp;&amp; -r } );
          # add all .c files below <a href="file:/tmp">/tmp</a> as stuff/*
          $zip-&gt;addTreeMatching( '<a href="file:/tmp">/tmp</a>', 'stuff', '\.c$' );
          # add all .o files below <a href="file:/tmp">/tmp</a> as stuff/* if they aren't writable
          $zip-&gt;addTreeMatching( '<a href="file:/tmp">/tmp</a>', 'stuff', '\.o$', sub { ! -w } );
          # add all .so files below <a href="file:/tmp">/tmp</a> that are smaller than 200 bytes as stuff/*
          $zip-&gt;addTreeMatching( '<a href="file:/tmp">/tmp</a>', 'stuff', '\.o$', sub { -s &lt; 200 } );
          # and write them into a file
          $zip-&gt;writeToFileNamed('xxx.zip');

</pre><h4><b>Extract</b> <b>a</b> <b>directory/tree</b></h4><pre>
       <b>Q:</b> How can I extract some (or all) files from a Zip into a different directory?

       <b>A:</b> You can use the <b>Archive::Zip::extractTree()</b> method: ??? ||

          # now extract the same files into /tmpx
          $zip-&gt;extractTree( 'stuff', '/tmpx' );

</pre><h4><b>Update</b> <b>a</b> <b>directory/tree</b></h4><pre>
       <b>Q:</b> How can I update a Zip from a directory tree, adding or replacing only the newer files?

       <b>A:</b> You can use the <b>Archive::Zip::updateTree()</b> method that was added in version 1.09.

</pre><h4><b>Zip</b> <b>times</b> <b>might</b> <b>be</b> <b>off</b> <b>by</b> <b>1</b> <b>second</b></h4><pre>
       <b>Q:</b> It bothers me greatly that my file times are wrong by one second about half the time. Why don't you do
       something about it?

       <b>A:</b> Get over it. This is a result of the Zip format storing times in DOS format, which has a resolution of
       only two seconds.

</pre><h4><b>Zip</b> <b>times</b> <b>don't</b> <b>include</b> <b>time</b> <b>zone</b> <b>information</b></h4><pre>
       <b>Q:</b> My file times don't respect time zones. What gives?

       <b>A:</b>  If this is important to you, please submit patches to read the various Extra Fields that encode times
       with time zones. I'm just using the DOS Date/Time, which doesn't have a time zone.

</pre><h4><b>How</b> <b>do</b> <b>I</b> <b>make</b> <b>a</b> <b>self-extracting</b> <b>Zip</b></h4><pre>
       <b>Q:</b> I want to make a self-extracting Zip file. Can I do this?

       <b>A:</b> Yes. You can write a self-extracting archive stub  (that  is,  a  version  of  unzip)  to  the  output
       filehandle  that  you  pass  to  <b>writeToFileHandle()</b>.  See  examples/selfex.pl  for  how to write a self-
       extracting archive.

       However, you should understand that this will only work on one kind of platform (the one  for  which  the
       stub was compiled).

</pre><h4><b>How</b> <b>can</b> <b>I</b> <b>deal</b> <b>with</b> <b>Zips</b> <b>with</b> <b>prepended</b> <b>garbage</b> <b>(i.e.</b> <b>from</b> <b>Sircam)</b></h4><pre>
       <b>Q:</b> How can I tell if a Zip has been damaged by adding garbage to the beginning or inside the file?

       <b>A:</b>  I  added  code  for  this for the Amavis virus scanner. You can query archives for their 'eocdOffset'
       property, which should be 0:

         if ($zip-&gt;eocdOffset &gt; 0)
           { warn($zip-&gt;eocdOffset . " bytes of garbage at beginning or within Zip") }

       When members are extracted, this offset will be used to adjust the start of the member if necessary.

</pre><h4><b>Can't</b> <b>extract</b> <b>Shrunk</b> <b>files</b></h4><pre>
       <b>Q:</b> I'm trying to extract a file out of a Zip produced by PKZIP, and keep getting this error message:

         error: Unsupported compression combination: read 6, write 0

       <b>A:</b> You can't uncompress this  archive  member.  Archive::Zip  only  supports  uncompressed  members,  and
       compressed members that are compressed using the compression supported by Compress::Raw::Zlib. That means
       only Deflated and Stored members.

       Your file is compressed using the Shrink format, which is not supported by Compress::Raw::Zlib.

       You could, perhaps, use a command-line UnZip program (like the Info-Zip one) to extract this.

</pre><h4><b>Can't</b> <b>do</b> <b>decryption</b></h4><pre>
       <b>Q:</b> How do I decrypt encrypted Zip members?

       <b>A:</b>  With  some other program or library. Archive::Zip doesn't support decryption, and probably never will
       (unless <u>you</u> write it).

</pre><h4><b>How</b> <b>to</b> <b>test</b> <b>file</b> <b>integrity?</b></h4><pre>
       <b>Q:</b> How can Archive::Zip can test the validity of a Zip file?

       <b>A:</b> If you try to decompress the file, the gzip streams will report errors if you have  garbage.  Most  of
       the time.

       If you try to open the file and a central directory structure can't be found, an error will be reported.

       When  a  file  is  being  read,  if we can't find a proper PK.. signature in the right places we report a
       format error.

       If there is added garbage at the beginning of a Zip file (as inserted by some viruses), you can find  out
       about  it,  but Archive::Zip will ignore it, and you can still use the archive. When it gets written back
       out the added stuff will be gone.

       There are two ready-to-use utilities in the examples directory that can be used to test  file  integrity,
       or that you can use as examples for your own code:

       examples/zipcheck.pl shows how to use an attempted extraction to test a file.
       examples/ziptest.pl shows how to test CRCs in a file.

</pre><h4><b>Duplicate</b> <b>files</b> <b>in</b> <b>Zip?</b></h4><pre>
       <b>Q:</b> Archive::Zip let me put the same file in my Zip twice! Why don't you prevent this?

       <b>A:</b>  As far as I can tell, this is not disallowed by the Zip spec. If you think it's a bad idea, check for
       it yourself:

         $zip-&gt;addFile($someFile, $someName) unless $zip-&gt;memberNamed($someName);

       I can even imagine cases where this might be useful (for instance, multiple versions of files).

</pre><h4><b>File</b> <b>ownership/permissions/ACLS/etc</b></h4><pre>
       <b>Q:</b> Why doesn't Archive::Zip deal with file ownership, ACLs, etc.?

       <b>A:</b> There is no standard way to represent these in the Zip file format. If you want to  send  me  code  to
       properly  handle  the various extra fields that have been used to represent these through the years, I'll
       look at it.

</pre><h4><b>I</b> <b>can't</b> <b>compile</b> <b>but</b> <b>ActiveState</b> <b>only</b> <b>has</b> <b>an</b> <b>old</b> <b>version</b> <b>of</b> <b>Archive::Zip</b></h4><pre>
       <b>Q:</b> I've only installed modules using ActiveState's PPM program and repository. But they have a much older
       version of Archive::Zip than is in CPAN. Will you send me a newer PPM?

       <b>A:</b> Probably not, unless I get lots of extra time. But there's no reason you  can't  install  the  version
       from CPAN. Archive::Zip is pure Perl, so all you need is NMAKE, which you can get for free from Microsoft
       (see the FAQ in the ActiveState documentation for details on how to install CPAN modules).

</pre><h4><b>My</b> <b>JPEGs</b> <b>(or</b> <b>MP3's)</b> <b>don't</b> <b>compress</b> <b>when</b> <b>I</b> <b>put</b> <b>them</b> <b>into</b> <b>Zips!</b></h4><pre>
       <b>Q:</b> How come my JPEGs and MP3's don't compress much when I put them into Zips?

       <b>A:</b> Because they're already compressed.

</pre><h4><b>Under</b> <b>Windows,</b> <b>things</b> <b>lock</b> <b>up/get</b> <b>damaged</b></h4><pre>
       <b>Q:</b>  I'm  using Windows. When I try to use Archive::Zip, my machine locks up/makes funny sounds/displays a
       BSOD/corrupts data. How can I fix this?

       <b>A:</b> First, try the newest version of Compress::Raw::Zlib. I know  of  Windows-related  problems  prior  to
       v1.14 of that library.

</pre><h4><b>Zip</b> <b>contents</b> <b>in</b> <b>a</b> <b>scalar</b></h4><pre>
       <b>Q:</b>  I  want  to  read a Zip file from (or write one to) a scalar variable instead of a file. How can I do
       this?

       <b>A:</b>  Use  "IO::String"  and   the   "readFromFileHandle()"   and   "writeToFileHandle()"   methods.    See
       "examples/readScalar.pl" and "examples/writeScalar.pl".

</pre><h4><b>Reading</b> <b>from</b> <b>streams</b></h4><pre>
       <b>Q:</b> How do I read from a stream (like for the Info-Zip "funzip" program)?

       <b>A:</b> This is not currently supported, though writing to a stream is.

perl v5.30.0                                       2020-03-14                             <u>Archive::Zip::<a href="../man3pm/FAQ.3pm.html">FAQ</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>