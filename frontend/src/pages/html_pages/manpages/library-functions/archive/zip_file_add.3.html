<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>zip_file_add, zip_file_replace — add file to zip archive or replace file in zip archive</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libzip-dev">libzip-dev_1.11.3-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       zip_file_add, zip_file_replace — add file to zip archive or replace file in zip archive

</pre><h4><b>LIBRARY</b></h4><pre>
       libzip (-lzip)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;zip.h&gt;</b>

       <u>zip_int64_t</u>
       <b>zip_file_add</b>(<u>zip_t</u> <u>*archive</u>, <u>const</u> <u>char</u> <u>*name</u>, <u>zip_source_t</u> <u>*source</u>, <u>zip_flags_t</u> <u>flags</u>);

       <u>int</u>
       <b>zip_file_replace</b>(<u>zip_t</u> <u>*archive</u>, <u>zip_uint64_t</u> <u>index</u>, <u>zip_source_t</u> <u>*source</u>, <u>zip_flags_t</u> <u>flags</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  function  <b>zip_file_add</b>() adds a file to a zip archive, while <b>zip_file_replace</b>() replaces an existing
       file in a zip archive.  The argument <u>archive</u> specifies the zip archive to which the file should be added.
       <u>name</u> is the file's name in the zip archive (for <b>zip_file_add</b>()), while <u>index</u> specifies which file  should
       be replaced (for <b>zip_file_replace</b>()).  The <u>flags</u> argument can be any combination of ZIP_FL_OVERWRITE with
       one of ZIP_FL_ENC_*:

       ZIP_FL_OVERWRITE      Overwrite any existing file of the same name.  For <b>zip_file_add</b> only.

       ZIP_FL_ENC_GUESS      Guess encoding of <u>name</u> (default).  (Only CP-437 and UTF-8 are recognized.)

       ZIP_FL_ENC_UTF_8      Interpret <u>name</u> as UTF-8.

       ZIP_FL_ENC_CP437      Interpret <u>name</u> as code page 437 (CP-437).
       The data is obtained from the <u>source</u> argument, see <u><a href="../man3/zip_source.3.html">zip_source</a></u>(3).

       <u>NOTE</u>:  <u><a href="../man3/zip_source_free.3.html">zip_source_free</a></u>(3)  should  not  be  called  on  a  <u>source</u>  after  it  was  used successfully in a
       <b>zip_file_add</b> or <b>zip_file_replace</b> call.

       Please also note that when using <b>zip_replace</b>, the target file's extra field information will  be  deleted
       since  this  usually  is dependent on the file contents.  If you want to keep them, query them beforehand
       with <u><a href="../man3/zip_file_extra_field_get.3.html">zip_file_extra_field_get</a></u>(3) and restore them after <b>zip_replace</b> with <u><a href="../man3/zip_file_extra_field_set.3.html">zip_file_extra_field_set</a></u>(3).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       Upon successful completion, <b>zip_file_add</b>() returns the  index  of  the  new  file  in  the  archive,  and
       <b>zip_file_replace</b>() returns 0.  Otherwise, -1 is returned and the error code in <u>archive</u> is set to indicate
       the error.

</pre><h4><b>EXAMPLES</b></h4><pre>
             zip_source_t *s;
             const char buf[]="teststring";

             if ((s=zip_source_buffer(archive, buf, sizeof(buf), 0)) == NULL ||
                 zip_file_add(archive, name, s, ZIP_FL_ENC_UTF_8) &lt; 0) {
                 zip_source_free(s);
                 printf("error adding file: %s\n", zip_strerror(archive));
             }

</pre><h4><b>ERRORS</b></h4><pre>
       <b>zip_file_add</b>() and <b>zip_file_replace</b>() fail if:

       [ZIP_ER_EXISTS]    There  is already a file called <u>name</u> in the archive.  (Only applies to <b>zip_file_add</b>(),
                          and only if ZIP_FL_OVERWRITE is not provided).

       [ZIP_ER_INVAL]     <u>source</u> or <u>name</u> are NULL, or <u>index</u> is invalid.

       [ZIP_ER_MEMORY]    Required memory could not be allocated.

       [ZIP_ER_RDONLY]    Archive was opened in read-only mode.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/libzip.3.html">libzip</a></u>(3), <u><a href="../man3/zip_source.3.html">zip_source</a></u>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>zip_file_add</b>() and <b>zip_file_replace</b>() were added in libzip 0.11.

</pre><h4><b>AUTHORS</b></h4><pre>
       Dieter Baron &lt;<u><a href="mailto:dillo@nih.at">dillo@nih.at</a></u>&gt; and Thomas Klausner &lt;<u><a href="mailto:wiz@gatalith.at">wiz@gatalith.at</a></u>&gt;

Debian                                           March 18, 2024                                  <u><a href="../man3/ZIP_FILE_ADD.3.html">ZIP_FILE_ADD</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>