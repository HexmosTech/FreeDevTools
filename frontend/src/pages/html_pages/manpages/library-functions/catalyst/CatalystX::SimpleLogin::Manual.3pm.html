<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CatalystX::SimpleLogin::Manual - How to use and customise CatalystX::SimpleLogin.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcatalystx-simplelogin-perl">libcatalystx-simplelogin-perl_0.21-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CatalystX::SimpleLogin::Manual - How to use and customise CatalystX::SimpleLogin.

   <b>Tutorial</b>
       We're using a sample application here, to make the instructions a little easier. This assumes that you
       have Catalyst, Catalyst::Devel, Template Toolkit, and the Catalyst authentication and session plugins
       installed.

           catalyst.pl MyApp
           cd MyApp
           script/myapp_create.pl view HTML TT

       Edit lib/MyApp.pm and add CatalystX::SimpleLogin,  Authenticate, and the Session plugins to the use
       Catalyst plugin list:

           use Catalyst qw/-Debug
                           ConfigLoader
                           +CatalystX::SimpleLogin
                           Authentication
                           Session
                           Session::Store::File
                           Session::State::Cookie
                           Static::Simple/;

       Add the following config for authentication, including two sample users:

           __PACKAGE__-&gt;config(
               'Plugin::Authentication' =&gt; {
                   default =&gt; {
                       credential =&gt; {
                           class =&gt; 'Password',
                           password_field =&gt; 'password',
                           password_type =&gt; 'clear'
                       },
                       store =&gt; {
                           class =&gt; 'Minimal',
                           users =&gt; {
                               bob =&gt; {
                                   password =&gt; "bobpw",
                               },
                               william =&gt; {
                                   password =&gt; "billpw",
                               },
                           },
                       },
                   },
               },
           );

       Execute " script/myapp_server.pl " and, as part of the debug output, you should see:

           [debug] Loaded Chained actions:
           .-------------------------------------+--------------------------------------.
           | Path Spec                           | Private                              |
           +-------------------------------------+--------------------------------------+
           | /login                              | /login/login                         |
           | /logout                             | /login/logout                        |
           '-------------------------------------+--------------------------------------'

       Go to " localhost:3000 " and you should see the Catalyst welcome screen. Go to " localhost:3000/login "
       and you should get a login screen containing username and password text fields, a 'Remember' checkbox,
       and a 'Login' button. Enter 'bob' and 'bobpw'. You should be logged in and taken to the welcome screen.
       If you execute " localhost:3000/logout " you will be logged out, and should see this in the debug output
       (the welcome screen will stay the same).

       Now go to " lib/MyApp/Controller/Root.pm " and remove the lines saying:

           use strict;
           use warnings;
           use parent 'Catalyst::Controller';

       and add the following lines:

           use Moose;
           use namespace::autoclean;
           BEGIN { extends 'Catalyst::Controller' }

       Now add a new action to " lib/MyApp/Controller/Root.pm " and include " Does('NeedsLogin') " to use the
       Catalyst ActionRole that is part of SimpleLogin:

           sub hello_user : Local Does('NeedsLogin') {
               my ( $self, $c ) = @_;
               $c-&gt;res-&gt;body('&lt;h2&gt;Hello, user!&lt;/h2&gt;');
           }

       Restart the server and you can see the new action. Go to "htp://localhost:3000/hello_user" and you'll get
       the 'Hello, user!' page. Now execute "<a href="http://localhost">http://localhost</a>:3000/logout" and try
       "<a href="http://localhost">http://localhost</a>:3000/hello_user" again. You will be presented with a login screen.

       <u>Authorization</u>

       CatalystX::SimpleLogin also provides /login/required and /login/not_required for easy chaining off of for
       actions which should only be available to authenticated users.

           package MyApp::Controller::Secure;

           sub setup : Chained('/login/required') PathPart('') <a href="../man1/CaptureArgs.1.html">CaptureArgs</a>(1) {
               my ( $self, $c, $id ) = @_;
               # setup actions for authenticated-user-only access
               $c-&gt;stash-&gt;{id} = $id;
           }

           sub something_secure : Chained('setup') PathPart <a href="../man0/Args.0.html">Args</a>(0) {
               my ( $self, $c ) = @_;
               # only authenticated users will have access to this action
           }

           sub open_to_all : Chained('/login/not_required') PathPart <a href="../man0/Args.0.html">Args</a>(0) {
               my ( $self, $c ) = @_;
               # this is available to everyone
           }

       For more fine-grained control, you can use ACL checks to refine access control policies. This
       functionality is provided via Catalyst::ActionRole::ACL.  Please consult the ACL documentation for steps
       to setup your application.  The ACL checks work by allowing you to add additional attributes on your
       actions which control the particular role(s) required or allowed.

           package MyApp;
           __PACKAGE__-&gt;config(
               'Controller::Login' =&gt; {
                   actions =&gt; {
                       required =&gt; {
                           Does =&gt; ['ACL'],
                           AllowedRole =&gt; ['admin', 'poweruser'], # ANY of these
                           # RequiresRole =&gt; ['extranet'], # ALL of these
                           ACLDetachTo =&gt; 'login',
                       },
                   },
               },
           );

           package MyApp::Controller::Foo;
           BEGIN { extends 'Catalyst::Controller' }

           sub do_something : Chained('/login/required')
                            : Does('ACL') RequiresRole('createinvoice') ACLDetachTo('/login') {}

       You can also add a message, which will be put into the flash key 'error_msg'. Add the following to the
       hello_user action:

         : LoginRedirectMessage('Please Login to view this Action')

       Now we'll create a Template Toolkit template that can be customized. Create a " root/login/login.tt "
       file with the following lines.

         [% error_msg %]
         [% render_login_form %]

       Now edit " lib/MyApp.pm " and add the config shown below to remove the 'RenderAsTTTemplate' trait, and
       add 'flash_to_stash' for Catalyst::Plugin::Session (to allow the error message to be passed to the next
       request):

           __PACKAGE__-&gt;config(
               'Plugin::Session' =&gt; {
                   flash_to_stash =&gt; 1
               },
               'Controller::Login' =&gt; {
                   traits =&gt; ['-RenderAsTTTemplate'],
               },
               # Other config..
           );

       Restart the server and try to view the hello_user page without being logged in.  You should be redireced
       to the login page with the error message displayed at the top.

       You can replace " [% render_login_form %] " with your own html, and customize it as you please.

           &lt;div class="error"&gt;[% error_msg %]&lt;/div&gt;
           &lt;form id="login_form" method="post" &gt;
           &lt;fieldset class="main_fieldset"&gt;
           &lt;div&gt;&lt;label class="label" for="username"&gt;Username:
           &lt;/label&gt;&lt;input type="text" name="username" id="username" value="" /&gt;
           &lt;/div&gt;

           &lt;div&gt;&lt;label class="label" for="password"&gt;Password: &lt;/label&gt;
           &lt;input type="password" name="password" id="password" value="" /&gt;
           &lt;/div&gt;

           &lt;div&gt;&lt;label class="label" for="remember"&gt;Remember: &lt;/label&gt;
           &lt;input type="checkbox" name="remember" id="remember" value="1" /&gt;
           &lt;/div&gt;

           &lt;div&gt;&lt;input type="submit" name="submit" id="submit" value="Login" /&gt;
           &lt;/div&gt;
           &lt;/fieldset&gt;&lt;/form&gt;

       Or you can customize it using HTML::FormHandler HTML rendering features, and the 'login_form_args' config
       key.

       To alter the amount the remember me extends the session by alter the "remember_me_expiry" configuration
       setting.

           __PACKAGE__-&gt;config(
               'Controller::Login' =&gt; {
                   remember_me_expiry =&gt; 999999999, # the default is about 32 years.
               },
               # Other config..
           );

perl v5.36.0                                       2022-08-28                <u>CatalystX::SimpleLogin::<a href="../man3pm/Manual.3pm.html">Manual</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>