<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIO_s_dgram_pair, BIO_new_bio_dgram_pair, BIO_dgram_set_no_trunc, BIO_dgram_get_no_trunc,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       BIO_s_dgram_pair, BIO_new_bio_dgram_pair, BIO_dgram_set_no_trunc, BIO_dgram_get_no_trunc,
       BIO_dgram_get_effective_caps, BIO_dgram_get_caps, BIO_dgram_set_caps, BIO_dgram_set_mtu,
       BIO_dgram_get_mtu, BIO_dgram_set0_local_addr - datagram pair BIO

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/bio.h&gt;

        const BIO_METHOD *BIO_s_dgram_pair(void);

        int BIO_new_bio_dgram_pair(BIO **bio1, size_t writebuf1,
                                   BIO **bio2, size_t writebuf2);
        int BIO_dgram_set_no_trunc(BIO *bio, int enable);
        int BIO_dgram_get_no_trunc(BIO *bio);
        uint32_t BIO_dgram_get_effective_caps(BIO *bio);
        uint32_t BIO_dgram_get_caps(BIO *bio);
        int BIO_dgram_set_caps(BIO *bio, uint32_t caps);
        int BIO_dgram_set_mtu(BIO *bio, unsigned int mtu);
        unsigned int BIO_dgram_get_mtu(BIO *bio);
        int BIO_dgram_set0_local_addr(BIO *bio, BIO_ADDR *addr);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>BIO_s_dgram_pair()</b> returns the method for a BIO datagram pair. A BIO datagram pair is similar to a BIO
       pair (see <b><a href="../man3/BIO_s_bio.3.html">BIO_s_bio</a></b>(3)) but has datagram semantics.  Broadly, this means that the length of the buffer
       passed to a write call will match that retrieved by a read call. If the buffer passed to a read call is
       too short, the datagram is truncated or the read fails, depending on how the BIO is configured.

       The BIO datagram pair attaches certain metadata to each write, such as source and destination addresses.
       This information may be retrieved on read.

       A typical application of a BIO datagram pair is to allow an application to keep all datagram network I/O
       requested by libssl under application control.

       The BIO datagram pair is designed to support multithreaded use where certain restrictions are observed;
       see THREADING.

       The BIO datagram pair allows each half of a pair to signal to the other half whether they support certain
       capabilities; see CAPABILITY INDICATION.

       <b>BIO_new_bio_dgram_pair()</b> combines the calls to <b><a href="../man3/BIO_new.3.html">BIO_new</a></b>(3), <b><a href="../man3/BIO_make_bio_pair.3.html">BIO_make_bio_pair</a></b>(3) and
       <b><a href="../man3/BIO_set_write_buf_size.3.html">BIO_set_write_buf_size</a></b>(3) to create a connected pair of BIOs <b>bio1</b>, <b>bio2</b> with write buffer sizes <b>writebuf1</b>
       and <b>writebuf2</b>. If either size is zero then the default size is used.

       <b><a href="../man3/BIO_make_bio_pair.3.html">BIO_make_bio_pair</a></b>(3) may be used to join two datagram pair BIOs into a pair.  The two BIOs must both use
       the method returned by <b>BIO_s_dgram_pair()</b> and neither of the BIOs may currently be associated in a pair.

       <b><a href="../man3/BIO_destroy_bio_pair.3.html">BIO_destroy_bio_pair</a></b>(3) destroys the association between two connected BIOs.  Freeing either half of the
       pair will automatically destroy the association.

       <b><a href="../man3/BIO_reset.3.html">BIO_reset</a></b>(3) clears any data in the write buffer of the given BIO. This means that the opposite BIO in
       the pair will no longer have any data waiting to be read.

       The BIO maintains a fixed size internal write buffer. When the buffer is full, further writes will fail
       until the buffer is drained via calls to <b><a href="../man3/BIO_read.3.html">BIO_read</a></b>(3). The size of the buffer can be changed using
       <b><a href="../man3/BIO_set_write_buf_size.3.html">BIO_set_write_buf_size</a></b>(3) and queried using <b><a href="../man3/BIO_get_write_buf_size.3.html">BIO_get_write_buf_size</a></b>(3).

       Note that the write buffer is partially consumed by metadata stored internally which is attached to each
       datagram, such as source and destination addresses.  The size of this overhead is undefined and may
       change between releases.

       The standard <b><a href="../man3/BIO_ctrl_pending.3.html">BIO_ctrl_pending</a></b>(3) call has modified behaviour and returns the size of the next datagram
       waiting to be read in bytes. An application can use this function to ensure it provides an adequate
       buffer to a subsequent read call. If no datagram is waiting to be read, zero is returned.

       This BIO does not support sending or receiving zero-length datagrams. Passing a zero-length buffer to
       BIO_write is treated as a no-op.

       <b><a href="../man3/BIO_eof.3.html">BIO_eof</a></b>(3) returns 1 only if the given BIO datagram pair BIO is not currently connected to a peer BIO.

       <b><a href="../man3/BIO_get_write_guarantee.3.html">BIO_get_write_guarantee</a></b>(3) and <b><a href="../man3/BIO_ctrl_get_write_guarantee.3.html">BIO_ctrl_get_write_guarantee</a></b>(3) return how large a datagram the next call
       to <b><a href="../man3/BIO_write.3.html">BIO_write</a></b>(3) can accept. If there is not enough space in the write buffer to accept another datagram
       equal in size to the configured MTU, zero is returned (see below). This is intended to avoid a situation
       where an application attempts to read a datagram from a network intending to write it to a BIO datagram
       pair, but where the received datagram ends up being too large to write to the BIO datagram pair.

       <b>BIO_dgram_set_no_trunc()</b> and <b>BIO_ctrl_get_no_trunc()</b> set and retrieve the truncation mode for the given
       half of a BIO datagram pair. When no-truncate mode is enabled, <b>BIO_read()</b> will fail if the buffer
       provided is inadequate to hold the next datagram to be read. If no-truncate mode is disabled (the
       default), the datagram will be silently truncated. This default behaviour maintains compatibility with
       the semantics of the Berkeley sockets API.

       <b>BIO_dgram_set_mtu()</b> and <b>BIO_dgram_get_mtu()</b> may be used to set an informational MTU value on the BIO
       datagram pair. If <b>BIO_dgram_set_mtu()</b> is used on a BIO which is currently part of a BIO datagram pair,
       the MTU value is set on both halves of the pair. The value does not affect the operation of the BIO
       datagram pair (except for <b>BIO_get_write_guarantee()</b>; see above) but may be used by other code to
       determine a requested MTU. When a BIO datagram pair BIO is created, the MTU is set to an unspecified but
       valid value.

       <b>BIO_dgram_set0_local_addr()</b> can be used to set the local BIO_ADDR to be used when sending a datagram via
       a BIO datagram pair. This becomes the peer address when receiving on the other half of the pair. If the
       BIO is used in a call to <b><a href="../man3/BIO_sendmmsg.3.html">BIO_sendmmsg</a></b>(3) and a local address is explicitly specified, then the explicitly
       specified local address takes precedence. The reference to the BIO_ADDR is passed to the BIO by this call
       and will be freed automatically when the BIO is freed.

       <b><a href="../man3/BIO_flush.3.html">BIO_flush</a></b>(3) is a no-op.

</pre><h4><b>NOTES</b></h4><pre>
       The halves of a BIO datagram pair have independent lifetimes and must be separately freed.

</pre><h4><b>THREADING</b></h4><pre>
       <b><a href="../man3/BIO_recvmmsg.3.html">BIO_recvmmsg</a></b>(3), <b><a href="../man3/BIO_sendmmsg.3.html">BIO_sendmmsg</a></b>(3), <b><a href="../man3/BIO_read.3.html">BIO_read</a></b>(3), <b><a href="../man3/BIO_write.3.html">BIO_write</a></b>(3), <b><a href="../man3/BIO_pending.3.html">BIO_pending</a></b>(3), <b><a href="../man3/BIO_get_write_guarantee.3.html">BIO_get_write_guarantee</a></b>(3)
       and <b><a href="../man3/BIO_flush.3.html">BIO_flush</a></b>(3) may be used by multiple threads simultaneously on the same BIO datagram pair. Specific
       <b><a href="../man3/BIO_ctrl.3.html">BIO_ctrl</a></b>(3) operations (namely BIO_CTRL_PENDING, BIO_CTRL_FLUSH and BIO_C_GET_WRITE_GUARANTEE) may also
       be used. Invoking any other BIO call, or any other <b><a href="../man3/BIO_ctrl.3.html">BIO_ctrl</a></b>(3) operation, on either half of a BIO
       datagram pair while any other BIO call is also in progress to either half of the same BIO datagram pair
       results in undefined behaviour.

</pre><h4><b>CAPABILITY</b> <b>INDICATION</b></h4><pre>
       The BIO datagram pair can be used to enqueue datagrams which have source and destination addresses
       attached. It is important that the component consuming one side of a BIO datagram pair understand whether
       the other side of the pair will honour any source and destination addresses it attaches to each datagram.
       For example, if datagrams are queued with destination addresses set but simply read by simple calls to
       <b><a href="../man3/BIO_read.3.html">BIO_read</a></b>(3), the destination addresses will be discarded.

       Each half of a BIO datagram pair can have capability flags set on it which indicate whether source and
       destination addresses will be honoured by the reader and whether they will be provided by the writer.
       These capability flags should be set via a call to <b>BIO_dgram_set_caps()</b>, and these capabilities will be
       reflected in the value returned by <b>BIO_dgram_get_effective_caps()</b> on the opposite BIO. If necessary, the
       capability value previously set can be retrieved using <b>BIO_dgram_get_caps()</b>. Note that
       <b>BIO_dgram_set_caps()</b> on a given BIO controls the capabilities advertised to the peer, and
       <b>BIO_dgram_get_effective_caps()</b> on a given BIO determines the capabilities advertised by the peer of that
       BIO.

       The following capabilities are available:

       <b>BIO_DGRAM_CAP_HANDLES_SRC_ADDR</b>
           The user of the datagram pair BIO promises to honour source addresses provided with datagrams written
           to the BIO pair.

       <b>BIO_DGRAM_CAP_HANDLES_DST_ADDR</b>
           The  user  of  the datagram pair BIO promises to honour destination addresses provided with datagrams
           written to the BIO pair.

       <b>BIO_DGRAM_CAP_PROVIDES_SRC_ADDR</b>
           The user of the datagram pair BIO  advertises  the  fact  that  it  will  provide  source  addressing
           information with future writes to the BIO pair, where available.

       <b>BIO_DGRAM_CAP_PROVIDES_DST_ADDR</b>
           The  user  of  the  datagram pair BIO advertises the fact that it will provide destination addressing
           information with future writes to the BIO pair, where available.

       If a caller attempts to specify a destination address (for example, using <b><a href="../man3/BIO_sendmmsg.3.html">BIO_sendmmsg</a></b>(3)) and  the  peer
       has  not  advertised the <b>BIO_DGRAM_CAP_HANDLES_DST_ADDR</b> capability, the operation fails. Thus, capability
       negotiation is mandatory.

       If a caller attempts to specify a source address when writing, or requests  a  destination  address  when
       receiving,   and   local   address   support   has   not   been   enabled,   the   operation  fails;  see
       <b><a href="../man3/BIO_dgram_set_local_addr_enable.3.html">BIO_dgram_set_local_addr_enable</a></b>(3).

       If a caller attempts  to  enable  local  address  support  using  <b><a href="../man3/BIO_dgram_set_local_addr_enable.3.html">BIO_dgram_set_local_addr_enable</a></b>(3)  and
       <b><a href="../man3/BIO_dgram_get_local_addr_cap.3.html">BIO_dgram_get_local_addr_cap</a></b>(3)  does  not  return  1  (meaning that the peer has not advertised both the
       <b>BIO_DGRAM_CAP_HANDLES_SRC_ADDR</b> and the <b>BIO_DGRAM_CAP_PROVIDES_DST_ADDR</b> capability), the operation fails.

       <b>BIO_DGRAM_CAP_PROVIDES_SRC_ADDR</b> and <b>BIO_DGRAM_CAP_PROVIDES_DST_ADDR</b> indicate that the  application  using
       that  half  of a BIO datagram pair promises to provide source and destination addresses respectively when
       writing datagrams to that half of the BIO datagram pair. However, these capability flags  do  not  affect
       the behaviour of the BIO datagram pair.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>BIO_new_bio_dgram_pair()</b>  returns  1  on  success,  with the new BIOs available in <b>bio1</b> and <b>bio2</b>, or 0 on
       failure, with NULL pointers stored into the locations for <b>bio1</b> and <b>bio2</b>. Check the error stack  for  more
       information.

       <b>BIO_dgram_set_no_trunc()</b>,  <b>BIO_dgram_set_caps()</b>  and  <b>BIO_dgram_set_mtu()</b>  return  1  on success and 0 on
       failure.

       <b>BIO_dgram_get_no_trunc()</b> returns 1 if no-truncate mode is enabled on a BIO, or 0 if no-truncate  mode  is
       not enabled or not supported on a given BIO.

       <b>BIO_dgram_get_effective_caps()</b> and <b>BIO_dgram_get_caps()</b> return zero if no capabilities are supported.

       <b>BIO_dgram_get_mtu()</b>  returns  the  MTU  value  configured  on  the  BIO,  or zero if the operation is not
       supported.

       <b>BIO_dgram_set0_local_addr()</b> returns 1 on success and &lt;= 0 otherwise.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/BIO_s_bio.3.html">BIO_s_bio</a></b>(3), <b><a href="../man7/bio.7.html">bio</a></b>(7)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>BIO_s_dgram_pair()</b>, <b>BIO_new_bio_dgram_pair()</b> were added in OpenSSL 3.2.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2022-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                             <u><a href="../man3SSL/BIO_S_DGRAM_PAIR.3SSL.html">BIO_S_DGRAM_PAIR</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>