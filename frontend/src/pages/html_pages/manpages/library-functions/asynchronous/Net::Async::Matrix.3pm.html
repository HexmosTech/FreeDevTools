<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>"Net::Async::Matrix" - use Matrix with IO::Async</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-async-matrix-perl">libnet-async-matrix-perl_0.19-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       "Net::Async::Matrix" - use Matrix with IO::Async

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use Net::Async::Matrix;
        use IO::Async::Loop;

        my $loop = IO::Async::Loop-&gt;new;

        my $matrix = Net::Async::Matrix-&gt;new(
           server =&gt; "my.home.server",
        );

        $loop-&gt;add( $matrix );

        $matrix-&gt;login(
           user_id  =&gt; '@my-user:home.server',
           password =&gt; 'SeKr1t',
        )-&gt;get;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <u>Matrix</u> is an new open standard for interoperable Instant Messaging and VoIP, providing pragmatic HTTP
       APIs and open source reference implementations for creating and running your own real-time communication
       infrastructure.

       This module allows an program to interact with a Matrix homeserver as a connected user client.

       &lt;<a href="http://matrix.org/">http://matrix.org/</a>&gt;

</pre><h4><b>EVENTS</b></h4><pre>
       The following events are invoked, either using subclass methods or "CODE" references in parameters:

   <b>on_log</b> <b>$message</b>
       A request to write a debugging log message. This is provided temporarily for development and debugging
       purposes, but will at some point be removed when the code has reached a certain level of stability.

   <b>on_presence</b> <b>$user,</b> <b>%changes</b>
       Invoked on receipt of a user presence change event from the homeserver.  %changes will map user state
       field names to 2-element ARRAY references, each containing the old and new values of that field.

   <b>on_room_new</b> <b>$room</b>
       Invoked when a new room first becomes known about.

       Passed an instance of Net::Async::Matrix::Room.

   <b>on_room_del</b> <b>$room</b>
       Invoked when the user has now left a room.

   <b>on_invite</b> <b>$event</b>
       Invoked on receipt of a room invite. The $event will contain the plain Matrix event as received; with at
       least the keys "inviter" and "room_id".

   <b>on_unknown_event</b> <b>$event</b>
       Invoked on receipt of any sort of event from the event stream, that is not recognised by any of the other
       code. This can be used to handle new kinds of incoming events.

</pre><h4><b>PARAMETERS</b></h4><pre>
       The following named parameters may be passed to "new" or "configure". In addition, "CODE" references for
       event handlers using the event names listed above can also be given.

   <b>server</b> <b>=&gt;</b> <b>STRING</b>
       Hostname and port number to contact the homeserver at. Given in the form

        $hostname:$port

       This string will be interpolated directly into HTTP request URLs.

   <b>SSL</b> <b>=&gt;</b> <b>BOOL</b>
       Whether to use SSL/TLS to communicate with the homeserver. Defaults false.

   <b>SSL_*</b> <b>=&gt;</b> <b>...</b>
       Any other parameters whose names begin "SSL_" will be stored for passing to the HTTP user agent. See
       IO::Socket::SSL for more detail.

   <b>path_prefix</b> <b>=&gt;</b> <b>STRING</b>
       Optional. Gives the path prefix to find the Matrix client API at. Normally this should not need
       modification.

   <b>on_room_member,</b> <b>on_room_message</b> <b>=&gt;</b> <b>CODE</b>
       Optional. Sets default event handlers on new room objects.

   <b>enable_events</b> <b>=&gt;</b> <b>BOOL</b>
       Optional. Normally enabled, but if set to a defined-but-false value (i.e. 0 or empty string) the event
       stream will be disabled. This will cause none of the incoming event handlers to be invoked, because the
       server will not be polled for events.

       This may be useful in simple send-only cases where the client has no interest in receiveing any events,
       and wishes to reduce the load on the homeserver.

   <b>longpoll_timeout</b> <b>=&gt;</b> <b>NUM</b>
       Optional. Timeout in seconds for the "/events" longpoll operation. Defaults to 30 seconds if not
       supplied.

   <b>first_sync_limit</b> <b>=&gt;</b> <b>NUM</b>
       Optional. Number of events per room to fetch on the first "/sync" request on startup. Defaults to the
       server's builtin value if not defined, which is likely to be 10.

</pre><h4><b>METHODS</b></h4><pre>
       The following methods documented with a trailing call to "-&gt;get" return Future instances.

   <b>login</b>
          $matrix-&gt;login( %params )-&gt;get

       Performs the necessary steps required to authenticate with the configured Home Server, actually obtain an
       access token and starting the event stream (unless disabled by the "enable_events" option being false).
       The returned "Future" will eventually yield the $matrix object itself, so it can be easily chained.

       There are various methods of logging in supported by Matrix; the following sets of arguments determine
       which is used:

       user_id, password
           Log in via the "m.login.password" method.

       user_id, access_token
           Directly  sets  the  "user_id"  and  "access_token" fields, bypassing the usual login semantics. This
           presumes you already have an existing access token to re-use, obtained by some other mechanism.  This
           exists largely for testing purposes.

   <b>register</b>
          $matrix-&gt;register( %params )-&gt;get

       Performs the necessary steps required to create a new account on the configured Home Server.

   <b>sync</b>
          $matrix-&gt;sync( %params )-&gt;get

       Performs a single "/sync" request on the server, returning the raw results directly.

       Takes the following named parameters

       since =&gt; STRING
           Optional. Sync token from the previous request.

   <b>start</b>
          $f = $matrix-&gt;start

       Performs the initial sync on the server, and starts the event stream to begin receiving events.

       While  this  method  does  return  a  "Future" it is not required that the caller keep track of this; the
       object itself will store it. It will complete when the initial sync has fininshed, and the  event  stream
       has started.

       If  the  initial  sync  has already been requested, this method simply returns the future it returned the
       last time, ensuring that you can await the client starting up simply by calling it; it will not  start  a
       second time.

   <b>stop</b>
          $matrix-&gt;stop

       Stops  the  event  stream.  After  calling  this you will need to use "start" again to continue receiving
       events.

   <b>myself</b>
          $user = $matrix-&gt;myself

       Returns the user object representing the connected user.

   <b>user</b>
          $user = $matrix-&gt;user( $user_id )

       Returns the user object representing a user of the given ID, if defined, or "undef".

   <b>get_displayname</b>
   <b>set_displayname</b>
          $name = $matrix-&gt;get_displayname-&gt;get

          $matrix-&gt;set_displayname( $name )-&gt;get

       Accessor and mutator for the user account's "display name" profile field.

   <b>get_presence</b>
   <b>set_presence</b>
          ( $presence, $msg ) = $matrix-&gt;get_presence-&gt;get

          $matrix-&gt;set_presence( $presence, $msg )-&gt;get

       Accessor and mutator for the user's current presence state and optional status message string.

   <b>create_room</b>
          ( $room, $room_alias ) = $matrix-&gt;create_room( $alias_localpart )-&gt;get

       Requests the creation of a new room and associates a new alias with the given localpart  on  the  server.
       The  returned  "Future"  will  return an instance of Net::Async::Matrix::Room and a string containing the
       full alias that was created.

   <b>join_room</b>
          $room = $matrix-&gt;join_room( $room_alias_or_id )-&gt;get

       Requests to join an existing room with the given alias name or plain room ID.  If this  room  is  already
       known by the $matrix object, this method simply returns it.

   <b>add_alias</b>
   <b>delete_alias</b>
          $matrix-&gt;add_alias( $alias, $room_id )-&gt;get

          $matrix-&gt;delete_alias( $alias )-&gt;get

       Performs  a  directory server request to create the given room alias name, to point at the room ID, or to
       remove it again.

       Note that this is likely only to be supported for alias names scoped within the homeserver the client  is
       connected  to,  and  that  additionally some form of permissions system may be in effect on the server to
       limit access to the directory server.

   <b>upload</b>
          $content_uri = $matrix-&gt;upload( %params )-&gt;get

       Performs a post to the server's media content repository, to upload a new piece of content, returning the
       content URI that points to it.

       The content can be specified in any of three ways, with the following three mutually-exclusive arguments:

       content =&gt; STRING
           Gives the content directly as an immediate scalar value.

       file =&gt; STRING
           Gives the path to a readable file on the filesystem containing the content.

       fh =&gt; IO
           Gives an opened IO handle the content can be read from.

       The following additional arguments are also recognised:

       content_type =&gt; STRING
           Gives the MIME type of the content data.

       content_length =&gt; INT
           Optional. If the content is being delivered from an opened filehandle (via the "fh"  argument),  this
           gives  the  total  length  in  bytes.  This is required in cases such as reading from pipes, when the
           length of the content isn't immediately available such as by "stat()"ing the filehandle.

   <b>convert_mxc_url</b>
          $url = $matrix-&gt;convert_mxc_url( $mxc )

       Given a plain string or URI instance containing a Matrix media URL (in the  "mxc:"  scheme),  returns  an
       "http:"  or  "https:"  URL  in the form of an URI instance pointing at the media repository on the user's
       local homeserver where it can be downloaded from.

</pre><h4><b>USER</b> <b>STRUCTURES</b></h4><pre>
       Parameters documented as $user receive a user struct, which supports the following methods:

   <b>$user_id</b> <b>=</b> <b>$user-&gt;user_id</b>
       User ID of the user.

   <b>$displayname</b> <b>=</b> <b>$user-&gt;displayname</b>
       Profile displayname of the user.

   <b>$presence</b> <b>=</b> <b>$user-&gt;presence</b>
       Presence state. One of "offline", "unavailable" or "online".

   <b>$last_active</b> <b>=</b> <b>$user-&gt;last_active</b>
       Epoch time that the user was last active.

</pre><h4><b>SUBCLASSING</b> <b>METHODS</b></h4><pre>
       The following methods are not normally required by  users  of  this  class,  but  are  provided  for  the
       convenience of subclasses to override.

   <b>$room</b> <b>=</b> <b>$matrix-&gt;make_room(</b> <b>%params</b> <b>)</b>
       Returns a new instance of Net::Async::Matrix::Room.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       •   &lt;<a href="http://matrix.org/">http://matrix.org/</a>&gt; - matrix.org home page

       •   &lt;https://github.com/matrix-org&gt; - matrix.org on github

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Evans &lt;<a href="mailto:leonerd@leonerd.org.uk">leonerd@leonerd.org.uk</a>&gt;

perl v5.36.0                                       2022-12-10                            <u>Net::Async::<a href="../man3pm/Matrix.3pm.html">Matrix</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>