<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IsoSpec::IsoThresholdGenerator - The generator of isotopologues above a given threshold value.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libisospec++-dev">libisospec++-dev_2.2.1-4.1build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       IsoSpec::IsoThresholdGenerator - The generator of isotopologues above a given threshold value.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;isoSpec++.h&gt;

       Inherits <b>IsoSpec::IsoGenerator</b>.

   <b>Public</b> <b>Member</b> <b>Functions</b>
       <b>IsoThresholdGenerator</b> (const <b>IsoThresholdGenerator</b> &amp;other)=delete
       <b>IsoThresholdGenerator</b> &amp; <b>operator=</b> (const <b>IsoThresholdGenerator</b> &amp;other)=delete
       void <b>get_conf_signature</b> (int *space) const override final
           Write the signature of configuration into target memory location. It must be large enough to
           accomodate it.
       <b>IsoThresholdGenerator</b> (<b>Iso</b> &amp;&amp;iso, double _threshold, bool _absolute=true, int _tabSize=1000, int
           _hashSize=1000, bool reorder_marginals=true)
           The move-constructor.
       ISOSPEC_FORCE_INLINE bool <b>advanceToNextConfiguration</b> () override final
           Advance to the next, not yet visited, most probable isotopologue.
       ISOSPEC_FORCE_INLINE double <b>lprob</b> () const override final
           Get the log-probability of the current isotopologue.
       ISOSPEC_FORCE_INLINE double <b>mass</b> () const override final
           Get the mass of the current isotopologue.
       ISOSPEC_FORCE_INLINE double <b>prob</b> () const override final
           Get the probability of the current isotopologue.
       void <b>terminate_search</b> ()
           Block the subsequent search of isotopologues.
       void <b>reset</b> ()
       size_t <b>count_confs</b> ()

       Public Member Functions inherited from <b>IsoSpec::IsoGenerator</b>
       <b>IsoGenerator</b> (<b>Iso</b> &amp;&amp;iso, bool alloc_partials=true)
           Move constructor.
       virtual <b>~IsoGenerator</b> ()
           Destructor.

       Public Member Functions inherited from <b>IsoSpec::Iso</b>
       <b>Iso</b> (int _dimNumber, const int *_isotopeNumbers, const int *_atomCounts, const double *_isotopeMasses,
           const double *_isotopeProbabilities)
           General constructror.
       <b>Iso</b> (int _dimNumber, const int *_isotopeNumbers, const int *_atomCounts, const double *const
           *_isotopeMasses, const double *const *_isotopeProbabilities)
       <b>Iso</b> (const char *formula, bool use_nominal_masses=false)
           Constructor from the formula object.
       <b>Iso</b> (const std::string &amp;formula, bool use_nominal_masses=false)
           Constructor from C++ std::string chemical formula.
       <b>Iso</b> (<b>Iso</b> &amp;&amp;other)
           The move constructor.
       <b>Iso</b> &amp; <b>operator=</b> (const <b>Iso</b> &amp;other)=delete
       <b>Iso</b> (const <b>Iso</b> &amp;other, bool fullcopy)
           The copy constructor.
       virtual <b>~Iso</b> ()
           Destructor.
       double <b>getLightestPeakMass</b> () const
           Get the mass of the lightest peak in the isotopic distribution.
       double <b>getHeaviestPeakMass</b> () const
           Get the mass of the heaviest peak in the isotopic distribution.
       double <b>getMonoisotopicPeakMass</b> () const
       double <b>getModeLProb</b> () const
           Get the log-probability of the mode-configuration (if there are many modes, they share this value).
       double <b>getUnlikeliestPeakLProb</b> () const
           Get the logprobability of the least probable subisotopologue.
       double <b>getModeMass</b> () const
           Get the mass of the mode-configuration (if there are many modes, it is undefined which one will be
           selected).
       double <b>getTheoreticalAverageMass</b> () const
           Get the theoretical average mass of the molecule.
       double <b>variance</b> () const
           Get the theoretical variance of the distribution.
       double <b>stddev</b> () const
           Get the standard deviation of the theoretical distribution.
       int <b>getDimNumber</b> () const
           Get the number of elements in the chemical formula of the molecule.
       int <b>getAllDim</b> () const
           Get the total number of isotopes of elements present in a chemical formula.
       void <b>addElement</b> (int atomCount, int noIsotopes, const double *isotopeMasses, const double
           *isotopeProbabilities)
           Add an element to the molecule. Note: this method can only be used BEFORE <b>Iso</b> is used to construct an
           <b>IsoGenerator</b> instance.
       void <b>saveMarginalLogSizeEstimates</b> (double *priorities, double target_total_prob) const
           Save estimates of logarithms of target sizes of marginals using Gaussian approximation into argument
           array. Array priorities must have length equal to dimNumber.

   <b>Additional</b> <b>Inherited</b> <b>Members</b>
       Static Public Member Functions inherited from <b>IsoSpec::Iso</b>
       static <b>Iso</b> <b>FromFASTA</b> (const char *fasta, bool use_nominal_masses=false, bool add_water=true)
           Constructor (named) from aminoacid FASTA sequence as C string.
       static <b>Iso</b> <b>FromFASTA</b> (const std::string &amp;fasta, bool use_nominal_masses=false, bool add_water=true)
           Constructor (named) from aminoacid FASTA sequence as C++ std::string. See above for details.

       Public Attributes inherited from <b>IsoSpec::IsoGenerator</b>
       const double <b>mode_lprob</b>

       Protected Member Functions inherited from <b>IsoSpec::Iso</b>
       bool <b>doMarginalsNeedSorting</b> () const

       Protected Attributes inherited from <b>IsoSpec::IsoGenerator</b>
       double * <b>partialLProbs</b>
       double * <b>partialMasses</b>
       double * <b>partialProbs</b>

       Protected Attributes inherited from <b>IsoSpec::Iso</b>
       int <b>dimNumber</b>
       int * <b>isotopeNumbers</b>
       int * <b>atomCounts</b>
       unsigned int <b>confSize</b>
       int <b>allDim</b>
       <b>Marginal</b> ** <b>marginals</b>

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       The generator of isotopologues above a given threshold value.

       Attention: the calculated configurations are only partially ordeded and the user should not assume they
       will be ordered. This algorithm computes N isotopologues in O(N). It is a considerable advantage w.r.t.
       the <b>IsoOrderedGenerator</b>.

       Definition at line <b>295</b> of file <b>isoSpec++.h</b>.

</pre><h4><b>Constructor</b> <b>&amp;</b> <b>Destructor</b> <b>Documentation</b></h4><pre>
   <b>IsoSpec::IsoThresholdGenerator::IsoThresholdGenerator</b> <b>(Iso</b> <b>&amp;&amp;</b> <b>iso,</b> <b>double</b> <b>_threshold,</b> <b>bool</b> <b>_absolute</b> <b>=</b> <b>true,</b>
       <b>int</b> <b>_tabSize</b> <b>=</b> <b>1000,</b> <b>int</b> <b>_hashSize</b> <b>=</b> <b>1000,</b> <b>bool</b> <b>reorder_marginals</b> <b>=</b> <b>true)</b>
       The move-constructor.

       <b>Parameters</b>
           <u>iso</u> An instance of the <b>Iso</b> class.
           <b>_</b><u>threshold</u> The threshold value.
           <b>_</b><u>absolute</u> If true, the _threshold is interpreted as the absolute minimal peak height for the
           isotopologues. If false, the _threshold is the fraction of the heighest peak's probability.
           <u>tabSize</u> The size of the extension of the table with configurations.
           <u>hashSize</u> The size of the hash-table used to store subisotopologues and check if they have been
           already calculated.

       Definition at line <b>478</b> of file <b>isoSpec++.cpp</b>.

   <b>IsoSpec::IsoThresholdGenerator::~IsoThresholdGenerator</b> <b>()</b>
       Definition at line <b>637</b> of file <b>isoSpec++.cpp</b>.

</pre><h4><b>Member</b> <b>Function</b> <b>Documentation</b></h4><pre>
   <b>ISOSPEC_FORCE_INLINE</b> <b>bool</b> <b>IsoSpec::IsoThresholdGenerator::advanceToNextConfiguration</b> <b>()</b> <b>[inline],</b>  <b>[final],</b>
       <b>[override],</b>  <b>[virtual]</b>
       Advance to the next, not yet visited, most probable isotopologue.

       <b>Returns</b>
           Return false if it is not possible to advance.

       Implements <b>IsoSpec::IsoGenerator</b>.

       Definition at line <b>352</b> of file <b>isoSpec++.h</b>.

   <b>size_t</b> <b>IsoSpec::IsoThresholdGenerator::count_confs</b> <b>()</b>
       Count the number of configurations in the distribution. This can be used to pre-allocate enough memory to
       store it (e.g. std::vector's reserve() method - this is faster than depending on the vector's dynamic
       resizing, even though it means that the configuration space is walked through twice. This method has to
       be called before the first call to advanceToNextConfiguration and has undefined results (incl. segfaults)
       otherwise.

       Definition at line <b>566</b> of file <b>isoSpec++.cpp</b>.

   <b>void</b> <b>IsoSpec::IsoThresholdGenerator::get_conf_signature</b> <b>(int</b> <b>*</b> <b>space)</b> <b>const</b> <b>[inline],</b>  <b>[final],</b>  <b>[override],</b>
       <b>[virtual]</b>
       Write the signature of configuration into target memory location. It must be large enough to accomodate
       it.

       Implements <b>IsoSpec::IsoGenerator</b>.

       Definition at line <b>315</b> of file <b>isoSpec++.h</b>.

   <b>ISOSPEC_FORCE_INLINE</b> <b>double</b> <b>IsoSpec::IsoThresholdGenerator::lprob</b> <b>()</b> <b>const</b> <b>[inline],</b>  <b>[final],</b>  <b>[override],</b>
       <b>[virtual]</b>
       Get the log-probability of the current isotopologue.

       <b>Returns</b>
           The log-probability of the current isotopologue.

       Reimplemented from <b>IsoSpec::IsoGenerator</b>.

       Definition at line <b>391</b> of file <b>isoSpec++.h</b>.

   <b>ISOSPEC_FORCE_INLINE</b> <b>double</b> <b>IsoSpec::IsoThresholdGenerator::mass</b> <b>()</b> <b>const</b> <b>[inline],</b>  <b>[final],</b>  <b>[override],</b>
       <b>[virtual]</b>
       Get the mass of the current isotopologue.

       <b>Returns</b>
           The mass of the current isotopologue.

       Reimplemented from <b>IsoSpec::IsoGenerator</b>.

       Definition at line <b>392</b> of file <b>isoSpec++.h</b>.

   <b>ISOSPEC_FORCE_INLINE</b> <b>double</b> <b>IsoSpec::IsoThresholdGenerator::prob</b> <b>()</b> <b>const</b> <b>[inline],</b>  <b>[final],</b>  <b>[override],</b>
       <b>[virtual]</b>
       Get the probability of the current isotopologue.

       <b>Returns</b>
           The probability of the current isotopologue.

       Reimplemented from <b>IsoSpec::IsoGenerator</b>.

       Definition at line <b>393</b> of file <b>isoSpec++.h</b>.

   <b>void</b> <b>IsoSpec::IsoThresholdGenerator::reset</b> <b>()</b>
       Reset the generator to the beginning of the sequence. Allows it to be reused, eg. to go through the conf
       space once, calculate the amount of space needed to store configurations, then to allocate that memory,
       and go through it again, this time saving configurations (and <u>is</u> in fact faster than allocating a
       std::vector and depending on it to grow as needed. This is cheaper than throwing away the generator and
       making a new one too: marginal distributions don't need to be recalculated.

       Definition at line <b>620</b> of file <b>isoSpec++.cpp</b>.

   <b>void</b> <b>IsoSpec::IsoThresholdGenerator::terminate_search</b> <b>()</b>
       Block the subsequent search of isotopologues.

       Definition at line <b>555</b> of file <b>isoSpec++.cpp</b>.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for IsoSpec from the source code.

IsoSpec                                           Version 2.2.1                <u>IsoSpec::<a href="../man3/IsoThresholdGenerator.3.html">IsoThresholdGenerator</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>