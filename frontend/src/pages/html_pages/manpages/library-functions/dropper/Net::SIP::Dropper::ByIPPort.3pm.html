<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::SIP::Dropper::ByIPPort - drops SIP messages based on senders IP and port</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-sip-perl">libnet-sip-perl_0.838-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::SIP::Dropper::ByIPPort - drops SIP messages based on senders IP and port

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Net::SIP::Dropper::ByIPPort;
           my $drop_by_ipport = Net::SIP::Dropper::ByIPPort-&gt;new(
               database =&gt; '/path/to/database.drop',
               methods =&gt; [ 'REGISTER', '...', '' ],
               attempts =&gt; 10,
               interval =&gt; 60,
           );

           my $dropper = Net::SIP::Dropper-&gt;new( cb =&gt; $drop_by_ipport );
           my $chain = Net::SIP::ReceiveChain-&gt;new([ $dropper, ... ]);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       With "Net::SIP::Dropper::ByIPPort" one can drop packets, if too much packets are received from the same
       IP and port within a specific interval. This is to stop bad behaving clients.

</pre><h4><b>CONSTRUCTOR</b></h4><pre>
       new ( ARGS )
           ARGS is a hash with the following keys:

           database
                   Optional file name of database or callback for storing/retrieving the data.

                   If  it  is  a callback it will be called with $callback-&gt;(\%data) to retrieve the data (%data
                   will be updated) and "$callback-&gt;(\%data,true)" to save the data. No  return  value  will  be
                   expected from the callback.

                   %data  contains  the  number  of  attempts from a specific IP, port at a specific time in the
                   following format: "$data{ip}{port}{time} = count"

           attempts
                   After how many attempts within the specific interval the packet will be dropped.  Argument is
                   required.

           interval
                   The interval for attempts.  Argument is required.

           methods Optional argument to restrict dropping to specific methods.

                   Is array reference of method names, if one of the names  is  empty  also  responses  will  be
                   considered. If not given all packets will be checked.

</pre><h4><b>METHODS</b></h4><pre>
       run ( PACKET, LEG, FROM )
           This method is called as a callback from the Net::SIP::Dropper object.  It returns true if the packet
           should  be  dropped,  e.g.  if  there  are  too  much  packets from the same ip,port within the given
           interval.

       expire
           This method is called from within "run" but can also be called by hand.  It will expire  all  entries
           which are outside of the interval.

       savedb
           This  method  is  called from "expire" and "run" for saving to the database after changes, but can be
           called by hand to, useful if you made manual changes using the "data" method.

       data
           This method gives access to the internal hash which stores the attempts.  An attempt from a  specific
           IP and port and a specific time (as int, like <b>time()</b> gives) will be added to
            "$self-&gt;data-&gt;{ip}{port}{time}".

           By  manually  manipulating  the  hash one can restrict a specific IP,port forever (just set time to a
           large value and add a high number of attempts) or even restrict access for the whole IP  (all  ports)
           until time by using a port number of 0.

           After changes to the data it is advised to call "savedb".

perl v5.40.0                                       2024-09-08                   <u>Net::SIP::Dropper::<a href="../man3pm/ByIPPort.3pm.html">ByIPPort</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>