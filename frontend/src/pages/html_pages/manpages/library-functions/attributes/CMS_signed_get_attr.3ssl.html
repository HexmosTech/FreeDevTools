<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS_signed_get_attr_count, CMS_signed_get_attr_by_NID, CMS_signed_get_attr_by_OBJ, CMS_signed_get_attr,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CMS_signed_get_attr_count, CMS_signed_get_attr_by_NID, CMS_signed_get_attr_by_OBJ, CMS_signed_get_attr,
       CMS_signed_delete_attr, CMS_signed_add1_attr, CMS_signed_add1_attr_by_OBJ, CMS_signed_add1_attr_by_NID,
       CMS_signed_add1_attr_by_txt, CMS_signed_get0_data_by_OBJ, CMS_unsigned_get_attr_count,
       CMS_unsigned_get_attr_by_NID, CMS_unsigned_get_attr_by_OBJ, CMS_unsigned_get_attr,
       CMS_unsigned_delete_attr, CMS_unsigned_add1_attr, CMS_unsigned_add1_attr_by_OBJ,
       CMS_unsigned_add1_attr_by_NID, CMS_unsigned_add1_attr_by_txt, CMS_unsigned_get0_data_by_OBJ - CMS signed
       and unsigned attribute functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/cms.h&gt;

        int CMS_signed_get_attr_count(const CMS_SignerInfo *si);
        int CMS_signed_get_attr_by_NID(const CMS_SignerInfo *si, int nid,
                                       int lastpos);
        int CMS_signed_get_attr_by_OBJ(const CMS_SignerInfo *si, const ASN1_OBJECT *obj,
                                       int lastpos);
        X509_ATTRIBUTE *CMS_signed_get_attr(const CMS_SignerInfo *si, int loc);
        X509_ATTRIBUTE *CMS_signed_delete_attr(CMS_SignerInfo *si, int loc);
        int CMS_signed_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr);
        int CMS_signed_add1_attr_by_OBJ(CMS_SignerInfo *si,
                                        const ASN1_OBJECT *obj, int type,
                                        const void *bytes, int len);
        int CMS_signed_add1_attr_by_NID(CMS_SignerInfo *si,
                                        int nid, int type,
                                        const void *bytes, int len);
        int CMS_signed_add1_attr_by_txt(CMS_SignerInfo *si,
                                        const char *attrname, int type,
                                        const void *bytes, int len);
        void *CMS_signed_get0_data_by_OBJ(const CMS_SignerInfo *si,
                                          const ASN1_OBJECT *oid,
                                          int lastpos, int type);

        int CMS_unsigned_get_attr_count(const CMS_SignerInfo *si);
        int CMS_unsigned_get_attr_by_NID(const CMS_SignerInfo *si, int nid,
                                         int lastpos);
        int CMS_unsigned_get_attr_by_OBJ(const CMS_SignerInfo *si,
                                         const ASN1_OBJECT *obj, int lastpos);
        X509_ATTRIBUTE *CMS_unsigned_get_attr(const CMS_SignerInfo *si, int loc);
        X509_ATTRIBUTE *CMS_unsigned_delete_attr(CMS_SignerInfo *si, int loc);
        int CMS_unsigned_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr);
        int CMS_unsigned_add1_attr_by_OBJ(CMS_SignerInfo *si,
                                          const ASN1_OBJECT *obj, int type,
                                          const void *bytes, int len);
        int CMS_unsigned_add1_attr_by_NID(CMS_SignerInfo *si,
                                          int nid, int type,
                                          const void *bytes, int len);
        int CMS_unsigned_add1_attr_by_txt(CMS_SignerInfo *si,
                                          const char *attrname, int type,
                                          const void *bytes, int len);
        void *CMS_unsigned_get0_data_by_OBJ(CMS_SignerInfo *si, ASN1_OBJECT *oid,
                                            int lastpos, int type);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       CMS_signerInfo contains separate attribute lists for signed and unsigned attributes. Each
       <b>CMS_signed_XXX()</b> function is used for signed attributes, and each <b>CMS_unsigned_XXX()</b> function is used for
       unsigned attributes.  Since the <b>CMS_unsigned_XXX()</b> functions work in the same way as the <b>CMS_signed_XXX()</b>
       equivalents, only the <b>CMS_signed_XXX()</b> functions are described below.

       <b>CMS_signed_get_attr_by_OBJ()</b> finds the location of the first matching object <u>obj</u> in the SignerInfo's <u>si</u>
       signed attribute list. The search starts at the position after <u>lastpos</u>. If the returned value is positive
       then it can be used on the next call to <b>CMS_signed_get_attr_by_OBJ()</b> as the value of <u>lastpos</u> in order to
       iterate through the remaining attributes. <u>lastpos</u> can be set to any negative value on the first call, in
       order to start searching from the start of the signed attribute list.

       <b>CMS_signed_get_attr_by_NID()</b> is similar to <b>CMS_signed_get_attr_by_OBJ()</b> except that it passes the
       numerical identifier (NID) <u>nid</u> associated with the object.  See &lt;openssl/obj_mac.h&gt; for a list of NID_*.

       <b>CMS_signed_get_attr()</b> returns the <b>X509_ATTRIBUTE</b> object at index <u>loc</u> in the <u>si</u> signed attribute list. <u>loc</u>
       should be in the range from 0 to <b>CMS_signed_get_attr_count()</b> - 1.

       <b>CMS_signed_delete_attr()</b> removes the <b>X509_ATTRIBUTE</b> object at index <u>loc</u> in the <u>si</u> signed attribute list.
       An error occurs if the <u>si</u> attribute list is NULL.

       <b>CMS_signed_add1_attr()</b> pushes a copy of the passed in <b>X509_ATTRIBUTE</b> object to the <u>si</u> signed attribute
       list. A new signed attribute list is created if required. An error occurs if <u>attr</u> is NULL.

       <b>CMS_signed_add1_attr_by_OBJ()</b> creates a new signed <b>X509_ATTRIBUTE</b> using <b>X509_ATTRIBUTE_set1_object()</b> and
       <b>X509_ATTRIBUTE_set1_data()</b> to assign a new <u>obj</u> with type <u>type</u> and data <u>bytes</u> of length <u>len</u> and then
       pushes it to the <u>key</u> object's attribute list.

       <b>CMS_signed_add1_attr_by_NID()</b> is similar to <b>CMS_signed_add1_attr_by_OBJ()</b> except that it passes the
       numerical identifier (NID) <u>nid</u> associated with the object.  See &lt;openssl/obj_mac.h&gt; for a list of NID_*.

       <b>CMS_signed_add1_attr_by_txt()</b> is similar to <b>CMS_signed_add1_attr_by_OBJ()</b> except that it passes a name
       <u>attrname</u> associated with the object.  See &lt;openssl/obj_mac.h&gt; for a list of SN_* names.

       <b>CMS_signed_get0_data_by_OBJ()</b> finds the first attribute in a <u>si</u> signed attributes list that matches the
       <u>obj</u> starting at index <u>lastpos</u> and returns the data retrieved from the found attributes first <b>ASN1_TYPE</b>
       object. An error will occur if the attribute type <u>type</u> does not match the type of the <b>ASN1_TYPE</b> object OR
       if <u>type</u> is either <b>V_ASN1_BOOLEAN</b> or <b>V_ASN1_NULL</b> OR the attribute is not found.  If <u>lastpos</u> is less than
       -1 then an error will occur if there are multiple objects in the signed attribute list that match <u>obj</u>.
       If <u>lastpos</u> is less than -2 then an error will occur if there is more than one <b>ASN1_TYPE</b> object in the
       found signed attribute.

       Refer to <b><a href="../man3/X509_ATTRIBUTE.3.html">X509_ATTRIBUTE</a></b>(3) for information related to attributes.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The <b>CMS_unsigned_XXX()</b> functions return values are similar to those of the equivalent <b>CMS_signed_XXX()</b>
       functions.

       <b>CMS_signed_get_attr_count()</b> returns the number of signed attributes in the SignerInfo <u>si</u>, or -1 if the
       signed attribute list is NULL.

       <b>CMS_signed_get_attr_by_OBJ()</b> returns -1 if either the signed attribute list of <u>si</u> is empty OR if <u>obj</u> is
       not found, otherwise it returns the location of the <u>obj</u> in the SignerInfo's <u>si</u> signed attribute list.

       <b>CMS_signed_get_attr_by_NID()</b> is similar to <b>CMS_signed_get_attr_by_OBJ()</b> except that it returns -2 if the
       <u>nid</u> is not known by OpenSSL.

       <b>CMS_signed_get_attr()</b> returns either a signed <b>X509_ATTRIBUTE</b> or NULL on error.

       <b>CMS_signed_delete_attr()</b> returns either the removed signed <b>X509_ATTRIBUTE</b> or NULL if there is a error.

       <b>CMS_signed_add1_attr()</b>, <b>CMS_signed_add1_attr_by_OBJ()</b>, <b>CMS_signed_add1_attr_by_NID()</b>,
       <b>CMS_signed_add1_attr_by_txt()</b>, return 1 on success or 0 on error.

       <b>CMS_signed_get0_data_by_OBJ()</b> returns the data retrieved from the found signed attributes first <b>ASN1_TYPE</b>
       object, or NULL if an error occurs.

</pre><h4><b>NOTES</b></h4><pre>
       Some attributes are added automatically during the signing process.

       Calling <b>CMS_SignerInfo_sign()</b> adds the NID_pkcs9_signingTime signed attribute.

       Calling <b>CMS_final()</b>, <b>CMS_final_digest()</b> or <b>CMS_dataFinal()</b> adds the NID_pkcs9_messageDigest signed
       attribute.

       The NID_pkcs9_contentType signed attribute is always added if the NID_pkcs9_signingTime attribute is
       added.

       Calling <b>CMS_sign_ex()</b>, <b>CMS_sign_receipt()</b> or <b>CMS_add1_signer()</b> may add attributes depending on the flags
       parameter. See <b><a href="../man3/CMS_add1_signer.3.html">CMS_add1_signer</a></b>(3) for more information.

       OpenSSL applies special rules for the following attribute NIDs:

       CMS Signed Attributes
           NID_pkcs9_contentType NID_pkcs9_messageDigest NID_pkcs9_signingTime

       ESS Signed Attributes
           NID_id_smime_aa_signingCertificate                               NID_id_smime_aa_signingCertificateV2
           NID_id_smime_aa_receiptRequest

       CMS Unsigned Attributes
           NID_pkcs9_countersignature

       <b>CMS_signed_add1_attr()</b>,           <b>CMS_signed_add1_attr_by_OBJ()</b>,           <b>CMS_signed_add1_attr_by_NID()</b>,
       <b>CMS_signed_add1_attr_by_txt()</b>  and  the  equivalent <b>CMS_unsigned_add1_attrXXX()</b> functions allow duplicate
       attributes to be added. The attribute rules are not checked during these function calls, and are deferred
       until  the  sign  or  verify  process  (i.e.  during  calls  to   any   of   <b>CMS_sign_ex()</b>,   <b>CMS_sign()</b>,
       <b>CMS_sign_receipt()</b>,  <b>CMS_add1_signer()</b>,  <b>CMS_Final()</b>,  <b>CMS_dataFinal()</b>, <b>CMS_final_digest()</b>, <b>CMS_verify()</b>,
       <b>CMS_verify_receipt()</b> or <b>CMS_SignedData_verify()</b>).

       For CMS attribute rules see RFC 5652 Section 11.  For ESS attribute rules see RFC 2634 Section 1.3.4  and
       RFC 5035 Section 5.4.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/X509_ATTRIBUTE.3.html">X509_ATTRIBUTE</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2023-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                          <u><a href="../man3SSL/CMS_SIGNED_GET_ATTR.3SSL.html">CMS_SIGNED_GET_ATTR</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>