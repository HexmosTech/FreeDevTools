<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pthread_attr_init, pthread_attr_destroy - initialize and destroy thread attributes object</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pthread_attr_init, pthread_attr_destroy - initialize and destroy thread attributes object

</pre><h4><b>LIBRARY</b></h4><pre>
       POSIX threads library (<u>libpthread</u>, <u>-lpthread</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/pthread.h">pthread.h</a>&gt;</b>

       <b>int</b> <b>pthread_attr_init(pthread_attr_t</b> <b>*</b><u>attr</u><b>);</b>
       <b>int</b> <b>pthread_attr_destroy(pthread_attr_t</b> <b>*</b><u>attr</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>pthread_attr_init</b>() function initializes the thread attributes object pointed to by <u>attr</u> with default
       attribute  values.  After this call, individual attributes of the object can be set using various related
       functions (listed under SEE ALSO), and then the object can be used in one or more <b><a href="../man3/pthread_create.3.html">pthread_create</a></b>(3) calls
       that create threads.

       Calling <b>pthread_attr_init</b>() on a thread attributes object that has already been  initialized  results  in
       undefined behavior.

       When   a   thread   attributes   object  is  no  longer  required,  it  should  be  destroyed  using  the
       <b>pthread_attr_destroy</b>() function.  Destroying a thread attributes object has no  effect  on  threads  that
       were created using that object.

       Once  a  thread  attributes object has been destroyed, it can be reinitialized using <b>pthread_attr_init</b>().
       Any other use of a destroyed thread attributes object has undefined results.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, these functions return 0; on error, they return a nonzero error number.

</pre><h4><b>ERRORS</b></h4><pre>
       POSIX.1 documents an <b>ENOMEM</b> error for <b>pthread_attr_init</b>(); on Linux these functions always  succeed  (but
       portable and future-proof applications should nevertheless handle a possible error return).

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       For an explanation of the terms used in this section, see <b><a href="../man7/attributes.7.html">attributes</a></b>(7).
       ┌─────────────────────────────────────────────────────────────────────────────┬───────────────┬─────────┐
       │ <b>Interface</b>                                                                   │ <b>Attribute</b>     │ <b>Value</b>   │
       ├─────────────────────────────────────────────────────────────────────────────┼───────────────┼─────────┤
       │ <b>pthread_attr_init</b>(), <b>pthread_attr_destroy</b>()                                 │ Thread safety │ MT-Safe │
       └─────────────────────────────────────────────────────────────────────────────┴───────────────┴─────────┘

</pre><h4><b>STANDARDS</b></h4><pre>
       POSIX.1-2008.

</pre><h4><b>HISTORY</b></h4><pre>
       POSIX.1-2001.

</pre><h4><b>NOTES</b></h4><pre>
       The  <u>pthread_attr_t</u>  type  should  be treated as opaque: any access to the object other than via pthreads
       functions is nonportable and produces undefined results.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The program below optionally makes use of <b>pthread_attr_init</b>() and various related functions to initialize
       a thread attributes object that is used to create a single thread.  Once created,  the  thread  uses  the
       <b><a href="../man3/pthread_getattr_np.3.html">pthread_getattr_np</a></b>(3)  function  (a  nonstandard  GNU extension) to retrieve the thread's attributes, and
       then displays those attributes.

       If the program is run with no command-line argument,  then  it  passes  NULL  as  the  <u>attr</u>  argument  of
       <b><a href="../man3/pthread_create.3.html">pthread_create</a></b>(3),  so  that  the  thread  is  created  with  default attributes.  Running the program on
       Linux/x86-32 with the NPTL threading implementation, we see the following:

           $ <b>ulimit</b> <b>-s</b>       # No stack limit ==&gt; default stack size is 2 MB
           unlimited
           $ <b>./a.out</b>
           Thread attributes:
                   Detach state        = PTHREAD_CREATE_JOINABLE
                   Scope               = PTHREAD_SCOPE_SYSTEM
                   Inherit scheduler   = PTHREAD_INHERIT_SCHED
                   Scheduling policy   = SCHED_OTHER
                   Scheduling priority = 0
                   Guard size          = 4096 bytes
                   Stack address       = 0x40196000
                   Stack size          = 0x201000 bytes

       When we supply a stack size as a command-line argument,  the  program  initializes  a  thread  attributes
       object,  sets  various  attributes  in  that  object,  and  passes a pointer to the object in the call to
       <b><a href="../man3/pthread_create.3.html">pthread_create</a></b>(3).  Running the program on Linux/x86-32 with the NPTL threading  implementation,  we  see
       the following:

           $ <b>./a.out</b> <b>0x3000000</b>
           posix_memalign() allocated at 0x40197000
           Thread attributes:
                   Detach state        = PTHREAD_CREATE_DETACHED
                   Scope               = PTHREAD_SCOPE_SYSTEM
                   Inherit scheduler   = PTHREAD_EXPLICIT_SCHED
                   Scheduling policy   = SCHED_OTHER
                   Scheduling priority = 0
                   Guard size          = 0 bytes
                   Stack address       = 0x40197000
                   Stack size          = 0x3000000 bytes

   <b>Program</b> <b>source</b>

       #define _GNU_SOURCE     /* To get pthread_getattr_np() declaration */
       #include &lt;<a href="file:/usr/include/err.h">err.h</a>&gt;
       #include &lt;<a href="file:/usr/include/errno.h">errno.h</a>&gt;
       #include &lt;<a href="file:/usr/include/pthread.h">pthread.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
       #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;

       static void
       display_pthread_attr(pthread_attr_t *attr, char *prefix)
       {
           int s, i;
           size_t v;
           void *stkaddr;
           struct sched_param sp;

           s = pthread_attr_getdetachstate(attr, &amp;i);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_attr_getdetachstate");
           printf("%sDetach state        = %s\n", prefix,
                  (i == PTHREAD_CREATE_DETACHED) ? "PTHREAD_CREATE_DETACHED" :
                  (i == PTHREAD_CREATE_JOINABLE) ? "PTHREAD_CREATE_JOINABLE" :
                  "???");

           s = pthread_attr_getscope(attr, &amp;i);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_attr_getscope");
           printf("%sScope               = %s\n", prefix,
                  (i == PTHREAD_SCOPE_SYSTEM)  ? "PTHREAD_SCOPE_SYSTEM" :
                  (i == PTHREAD_SCOPE_PROCESS) ? "PTHREAD_SCOPE_PROCESS" :
                  "???");

           s = pthread_attr_getinheritsched(attr, &amp;i);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_attr_getinheritsched");
           printf("%sInherit scheduler   = %s\n", prefix,
                  (i == PTHREAD_INHERIT_SCHED)  ? "PTHREAD_INHERIT_SCHED" :
                  (i == PTHREAD_EXPLICIT_SCHED) ? "PTHREAD_EXPLICIT_SCHED" :
                  "???");

           s = pthread_attr_getschedpolicy(attr, &amp;i);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_attr_getschedpolicy");
           printf("%sScheduling policy   = %s\n", prefix,
                  (i == SCHED_OTHER) ? "SCHED_OTHER" :
                  (i == SCHED_FIFO)  ? "SCHED_FIFO" :
                  (i == SCHED_RR)    ? "SCHED_RR" :
                  "???");

           s = pthread_attr_getschedparam(attr, &amp;sp);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_attr_getschedparam");
           printf("%sScheduling priority = %d\n", prefix, sp.sched_priority);

           s = pthread_attr_getguardsize(attr, &amp;v);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_attr_getguardsize");
           printf("%sGuard size          = %zu bytes\n", prefix, v);

           s = pthread_attr_getstack(attr, &amp;stkaddr, &amp;v);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_attr_getstack");
           printf("%sStack address       = %p\n", prefix, stkaddr);
           printf("%sStack size          = %#zx bytes\n", prefix, v);
       }

       static void *
       thread_start(void *arg)
       {
           int s;
           pthread_attr_t gattr;

           /* pthread_getattr_np() is a non-standard GNU extension that
              retrieves the attributes of the thread specified in its
              first argument. */

           s = pthread_getattr_np(pthread_self(), &amp;gattr);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_getattr_np");

           printf("Thread attributes:\n");
           display_pthread_attr(&amp;gattr, "\t");

           exit(EXIT_SUCCESS);         /* Terminate all threads */
       }

       int
       main(int argc, char *argv[])
       {
           pthread_t thr;
           pthread_attr_t attr;
           pthread_attr_t *attrp;      /* NULL or &amp;attr */
           int s;

           attrp = NULL;

           /* If a command-line argument was supplied, use it to set the
              stack-size attribute and set a few other thread attributes,
              and set attrp pointing to thread attributes object. */

           if (argc &gt; 1) {
               size_t stack_size;
               void *sp;

               attrp = &amp;attr;

               s = pthread_attr_init(&amp;attr);
               if (s != 0)
                   errc(EXIT_FAILURE, s, "pthread_attr_init");

               s = pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_DETACHED);
               if (s != 0)
                   errc(EXIT_FAILURE, s, "pthread_attr_setdetachstate");

               s = pthread_attr_setinheritsched(&amp;attr, PTHREAD_EXPLICIT_SCHED);
               if (s != 0)
                   errc(EXIT_FAILURE, s, "pthread_attr_setinheritsched");

               stack_size = strtoul(argv[1], NULL, 0);

               s = posix_memalign(&amp;sp, sysconf(_SC_PAGESIZE), stack_size);
               if (s != 0)
                   errc(EXIT_FAILURE, s, "posix_memalign");

               printf("posix_memalign() allocated at %p\n", sp);

               s = pthread_attr_setstack(&amp;attr, sp, stack_size);
               if (s != 0)
                   errc(EXIT_FAILURE, s, "pthread_attr_setstack");
           }

           s = pthread_create(&amp;thr, attrp, &amp;thread_start, NULL);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_create");

           if (attrp != NULL) {
               s = pthread_attr_destroy(attrp);
               if (s != 0)
                   errc(EXIT_FAILURE, s, "pthread_attr_destroy");
           }

           pause();    /* Terminates when other thread calls exit() */
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/pthread_attr_setaffinity_np.3.html">pthread_attr_setaffinity_np</a></b>(3), <b><a href="../man3/pthread_attr_setdetachstate.3.html">pthread_attr_setdetachstate</a></b>(3), <b><a href="../man3/pthread_attr_setguardsize.3.html">pthread_attr_setguardsize</a></b>(3),
       <b><a href="../man3/pthread_attr_setinheritsched.3.html">pthread_attr_setinheritsched</a></b>(3), <b><a href="../man3/pthread_attr_setschedparam.3.html">pthread_attr_setschedparam</a></b>(3), <b><a href="../man3/pthread_attr_setschedpolicy.3.html">pthread_attr_setschedpolicy</a></b>(3),
       <b><a href="../man3/pthread_attr_setscope.3.html">pthread_attr_setscope</a></b>(3), <b><a href="../man3/pthread_attr_setsigmask_np.3.html">pthread_attr_setsigmask_np</a></b>(3), <b><a href="../man3/pthread_attr_setstack.3.html">pthread_attr_setstack</a></b>(3),
       <b><a href="../man3/pthread_attr_setstackaddr.3.html">pthread_attr_setstackaddr</a></b>(3), <b><a href="../man3/pthread_attr_setstacksize.3.html">pthread_attr_setstacksize</a></b>(3), <b><a href="../man3/pthread_create.3.html">pthread_create</a></b>(3), <b><a href="../man3/pthread_getattr_np.3.html">pthread_getattr_np</a></b>(3),
       <b><a href="../man3/pthread_setattr_default_np.3.html">pthread_setattr_default_np</a></b>(3), <b><a href="../man7/pthreads.7.html">pthreads</a></b>(7)

Linux man-pages 6.9.1                              2024-06-15                               <u><a href="../man3/pthread_attr_init.3.html">pthread_attr_init</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>