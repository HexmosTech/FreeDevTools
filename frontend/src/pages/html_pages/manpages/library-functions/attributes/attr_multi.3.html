<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>attr_multi, attr_multif - manipulate multiple user attributes on a filesystem object at once</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libattr1-dev">libattr1-dev_2.5.2-3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       attr_multi, attr_multif - manipulate multiple user attributes on a filesystem object at once

</pre><h4><b>C</b> <b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;attr/attributes.h&gt;</b>

       <b>int</b> <b>attr_multi</b> <b>(const</b> <b>char</b> <b>*</b><u>path</u><b>,</b> <b>attr_multiop_t</b> <b>*</b><u>oplist</u><b>,</b>
                       <b>int</b> <u>count</u><b>,</b> <b>int</b> <u>flags</u><b>);</b>

       <b>int</b> <b>attr_multif</b> <b>(int</b> <u>fd</u><b>,</b> <b>attr_multiop_t</b> <b>*</b><u>oplist</u><b>,</b>
                        <b>int</b> <u>count</u><b>,</b> <b>int</b> <u>flags</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>attr_multi</b> and <b>attr_multif</b> functions provide a way to operate on multiple attributes of a filesystem
       object at once.

       <u>Path</u> points to a path name for a filesystem object, and <u>fd</u> refers to the file descriptor associated  with
       a  file.   The  <u>oplist</u>  is an array of <u><b>attr_multiop_t</b></u> structures.  Each element in that array describes a
       single attribute operation and provides all the information required to carry out that operation  and  to
       check for success or failure of that operation.  <u>Count</u> tells how many elements are in the <u>oplist</u> array.

       The contents of an <u><b>attr_multiop_t</b></u> structure include the following members:

          <u><b>int</b></u> <u><b>am_opcode;</b></u> <u><b>/*</b></u> <u><b>which</b></u> <u><b>operation</b></u> <u><b>to</b></u> <u><b>perform</b></u> <u><b>(see</b></u> <u><b>below)</b></u> <u><b>*/</b></u>
          <u><b>int</b></u> <u><b>am_error;</b></u> <u><b>/*</b></u> <u><b>[out</b></u> <u><b>arg]</b></u> <u><b>result</b></u> <u><b>of</b></u> <u><b>this</b></u> <u><b>sub-op</b></u> <u><b>(an</b></u> <u><b>errno)</b></u> <u><b>*/</b></u>
          <u><b>char</b></u> <u><b>*am_attrname;</b></u> <u><b>/*</b></u> <u><b>attribute</b></u> <u><b>name</b></u> <u><b>to</b></u> <u><b>work</b></u> <u><b>with</b></u> <u><b>*/</b></u>
          <u><b>char</b></u> <u><b>*am_attrvalue;</b></u> <u><b>/*</b></u> <u><b>[in/out</b></u> <u><b>arg]</b></u> <u><b>attribute</b></u> <u><b>value</b></u> <u><b>(raw</b></u> <u><b>bytes)</b></u> <u><b>*/</b></u>
          <u><b>int</b></u> <u><b>am_length;</b></u> <u><b>/*</b></u> <u><b>[in/out</b></u> <u><b>arg]</b></u> <u><b>length</b></u> <u><b>of</b></u> <u><b>value</b></u> <u><b>*/</b></u>
          <u><b>int</b></u> <u><b>am_flags;</b></u> <u><b>/*</b></u> <u><b>flags</b></u> <u><b>(bit-wise</b></u> <u><b>OR</b></u> <u><b>of</b></u> <u><b>#defines</b></u> <u><b>below)</b></u> <u><b>*/</b></u>

       The  <u>am_opcode</u>  field  defines  how the remaining fields are to be interpreted and can take on one of the
       following values:

          <u><b>ATTR_OP_GET</b></u> <u><b>/*</b></u> <u><b>return</b></u> <u><b>the</b></u> <u><b>indicated</b></u> <u><b>attr's</b></u> <u><b>value</b></u> <u><b>*/</b></u>
          <u><b>ATTR_OP_SET</b></u> <u><b>/*</b></u> <u><b>set/create</b></u> <u><b>the</b></u> <u><b>indicated</b></u> <u><b>attr/value</b></u> <u><b>pair</b></u> <u><b>*/</b></u>
          <u><b>ATTR_OP_REMOVE</b></u> <u><b>/*</b></u> <u><b>remove</b></u> <u><b>the</b></u> <u><b>indicated</b></u> <u><b>attr</b></u> <u><b>*/</b></u>

       The <u>am_error</u> field will contain the appropriate error result  code  if  that  sub-operation  fails.   The
       result  codes  for  a  given  sub-operation  are  a subset of the result codes that are possible from the
       corresponding single-attribute function call.  For example, the result code possible from an  <u><b>ATTR_OP_GET</b></u>
       sub-operation are a subset of those that can be returned from an <b>attr_get</b> function call.

       The  <u>am_attrname</u>  field  is a pointer to a NULL terminated string giving the attribute name that the sub-
       operation should operate on.

       The <u>am_attrvalue,</u> <u>am_length</u> and <u>am_flags</u> fields are used to store the value of the named  attribute,  and
       some  control flags for that sub-operation, respectively.  Their use varies depending on the value of the
       <u>am_opcode</u> field.

       <b>ATTR_OP_GET</b>
              The <u>am_attrvalue</u> field is a pointer to a empty buffer that will be overwritten with the  value  of
              the  named  attribute.   The <u>am_length</u> field is initially the total size of the memory buffer that
              the <u>am_attrvalue</u> field points to.  After the operation, the <u>am_length</u> field  contains  the  actual
              size  of  the  attribute's  value.   The  <u>am_flags</u> field may be set to the <u><b>ATTR_ROOT</b></u> flag.  If the
              process has appropriate privileges, the ROOT namespace will be searched for the  named  attribute,
              otherwise the USER namespace will be searched.

       <b>ATTR_OP_SET</b>
              The  <u>am_attrvalue</u>  and <u>am_length</u> fields contain the new value for the given attribute name and its
              length.  The <u><b>ATTR_ROOT</b></u> flag may be set in the <u>am_flags</u> field.   If  the  process  has  appropriate
              privileges,  the  ROOT  namespace  will  be  searched  for the named attribute, otherwise the USER
              namespace will be searched.  The <u><b>ATTR_CREATE</b></u> and the <u><b>ATTR_REPLACE</b></u> flags may also  be  set  in  the
              <u>am_flags</u>  field  (but not simultaneously).  If the <u><b>ATTR_CREATE</b></u> flag is set, the sub-operation will
              set the <u>am_error</u> field to EEXIST if the named attribute already exists.  If the <u><b>ATTR_REPLACE</b></u>  flag
              is  set,  the sub-operation will set the <u>am_error</u> field to ENOATTR if the named attribute does not
              already exist.  (If the system libc does not define  ENOATTR,  then  libattr  will  define  it  to
              ENODATA in <b>&lt;attr/attributes.h&gt;</b>.)  If neither of those two flags are set and the attribute does not
              exist, then the attribute will be created with the given value.  If neither of those two flags are
              set and the attribute already exists, then the value will be replaced with the given value.

       <b>ATTR_OP_REMOVE</b>
              The <u>am_attrvalue</u> and <u>am_length</u> fields are not used and are ignored.  The <u>am_flags</u> field may be set
              to  the  <u><b>ATTR_ROOT</b></u>  flag.   If  the process has appropriate privileges, the ROOT namespace will be
              searched for the named attribute, otherwise the USER namespace will be searched.

       The <u>flags</u> argument to the <b>attr_multi</b> call is used to control following of  symbolic  links  in  the  <u>path</u>
       argument.   The default is to follow symbolic links, <u>flags</u> should be set to ATTR_DONTFOLLOW to not follow
       symbolic links.

       <b>attr_multi</b> will fail if one or more of the following are true:

       [ENOENT]         The named file does not exist.

       [EPERM]          The effective user ID does not match the owner of the file and the effective user ID  is
                        not super-user.

       [ENOTDIR]        A component of the path prefix is not a directory.

       [EACCES]         Search permission is denied on a component of the path prefix.

       [EINVAL]         A bit other than ATTR_DONTFOLLOW was set in the <u>flag</u> argument.

       [EFAULT]         <u>Path,</u> or <u>oplist</u> points outside the allocated address space of the process.

       [ELOOP]          A path name lookup involved too many symbolic links.

       [ENAMETOOLONG]   The  length  of  <u>path</u>  exceeds  {<u>MAXPATHLEN</u>},  or  a  pathname  component is longer than
                        {<u>MAXNAMELEN</u>}.

       <b>attr_multif</b> will fail if:

       [EINVAL]       A bit was set in the <u>flag</u> argument, or <u>fd</u> refers to a socket, not a file.

       [EFAULT]       <u>Oplist</u> points outside the allocated address space of the process.

       [EBADF]        <u>Fd</u> does not refer to a valid descriptor.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       On success, zero is returned.  On error, -1 is returned, and <u>errno</u> is set appropriately.  Note  that  the
       individual  operations  listed  in  the  <u>oplist</u> array each have their own error return fields.  The <u>errno</u>
       variable only records the result of the <u>attr_multi</u> call itself,  not  the  result  of  any  of  the  sub-
       operations.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/attr.1.html">attr</a></b>(1), <b><a href="../man3/attr_get.3.html">attr_get</a></b>(3), <b><a href="../man3/attr_list.3.html">attr_list</a></b>(3), <b><a href="../man3/attr_remove.3.html">attr_remove</a></b>(3), <b><a href="../man3/attr_set.3.html">attr_set</a></b>(3)

Dec 2001                                       Extended Attributes                                 <u><a href="../man3/ATTR_MULTI.3.html">ATTR_MULTI</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>