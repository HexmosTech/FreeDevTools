<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Builtin_attributes - Support for the builtin attributes:</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/ocaml-man">ocaml-man_5.3.0-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Builtin_attributes - Support for the builtin attributes:

</pre><h4><b>Module</b></h4><pre>
       Module   Builtin_attributes

</pre><h4><b>Documentation</b></h4><pre>
       Module <b>Builtin_attributes</b>
        : <b>sig</b> <b>end</b>

       Support for the builtin attributes:

       -ocaml.alert

       -ocaml.boxed

       -ocaml.deprecated

       -ocaml.deprecated_mutable

       -ocaml.explicit_arity

       -ocaml.immediate

       -ocaml.immediate64

       -ocaml.inline

       -ocaml.inlined

       -ocaml.noalloc

       -ocaml.poll

       -ocaml.ppwarning

       -ocaml.specialise

       -ocaml.specialised

       -ocaml.tailcall

       -ocaml.tail_mod_cons

       -ocaml.unboxed

       -ocaml.untagged

       -ocaml.unrolled

       -ocaml.warnerror

       -ocaml.warning

       -ocaml.warn_on_literal_pattern

       Warning: this module is unstable and part of <b>Compiler_libs</b> .

   <b>Attribute</b> <b>tracking</b> <b>for</b> <b>warning</b> <b>53</b>
       <u>type</u> <u>current_phase</u> =
        | Parser
        | Invariant_check

       <b>register_attr</b> must be called on the locations of all attributes that should be tracked for the purpose of
       misplaced  attribute  warnings.  In particular, it should be called on all attributes that are present in
       the source program except those that are contained in the payload of another attribute (because these may
       be left behind by a ppx and intentionally ignored by the compiler).

       The <b>current_phase</b> argument indicates when this function is being called

       -either when an attribute is created in the parser or when we see an attribute while running the check in
       the <b>Ast_invariants</b> module.  This is used to ensure that we track only attributes from the  final  version
       of  the  parse  tree:  we  skip adding attributes seen at parse time if we can see that a ppx will be run
       later, because the <b>Ast_invariants</b> check is always run on the result of a ppx.

       Note that the <b>Ast_invariants</b> check is also run on parse trees created from marshalled ast files if no ppx
       is being used, ensuring we don't miss attributes in that case.

       <u>val</u> <u>register_attr</u> : <b>current_phase</b> <b>-&gt;</b> <b>string</b> <b>Location.loc</b> <b>-&gt;</b> <b>unit</b>

       <u>val</u> <u>mark_payload_attrs_used</u> : <b>Parsetree.payload</b> <b>-&gt;</b> <b>unit</b>

       Marks the attributes hiding in the payload of another attribute  used,  for  the  purposes  of  misplaced
       attribute  warnings  (see  comment on <b>current_phase</b> above).  In the parser, it's simplest to add these to
       the table and remove them later, rather than  threading  through  state  tracking  whether  we're  in  an
       attribute payload.

       <u>val</u> <u>warn_unused</u> : <b>unit</b> <b>-&gt;</b> <b>unit</b>

       Issue  misplaced  attribute warnings for all attributes created with <b>mk_internal</b> but not yet marked used.
       Does nothing if compilation is stopped before lambda due to command-line flags.

   <b>Warning</b> <b>53</b> <b>helpers</b> <b>for</b> <b>environment</b> <b>attributes</b>
       Some attributes, like deprecation markers, do not affect the compilation of the definition on which  they
       appear,  but  rather result in warnings on future uses of that definition.  This is implemented by moving
       the raw attributes into the environment, where they will be noticed on future accesses.

       To make misplaced attribute warnings work appropriately for these attributes, we mark  them  "used"  when
       they are moved into the environment.  This is done with the helper functions in this section.

       <u>val</u> <u>mark_alert_used</u> : <b>Parsetree.attribute</b> <b>-&gt;</b> <b>unit</b>

       Marks  the  attribute used for the purposes of misplaced attribute warnings if it is an alert.  Call this
       when moving things allowed to have alert attributes into the environment.

       <u>val</u> <u>mark_alerts_used</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>unit</b>

       The same as <b>List.iter</b> <b>mark_alert_used</b> .

       <u>val</u> <u>mark_warn_on_literal_pattern_used</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>unit</b>

       Marks "warn_on_literal_pattern" attributes used for the purposes of misplaced attribute  warnings.   Call
       this when moving constructors into the environment.

       <u>val</u> <u>mark_deprecated_mutable_used</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>unit</b>

       Marks  "deprecated_mutable"  attributes used for the purposes of misplaced attribute warnings.  Call this
       when moving labels of mutable fields into the environment.

   <b>Helpers</b> <b>for</b> <b>alert</b> <b>and</b> <b>warning</b> <b>attributes</b>
       <u>val</u> <u>check_alerts</u> : <b>Location.t</b> <b>-&gt;</b> <b>Parsetree.attributes</b> <b>-&gt;</b> <b>string</b> <b>-&gt;</b> <b>unit</b>

       <u>val</u> <u>check_alerts_inclusion</u> : <b>def:Location.t</b> <b>-&gt;</b> <b>use:Location.t</b> <b>-&gt;</b> <b>Location.t</b>  <b>-&gt;</b>  <b>Parsetree.attributes</b>  <b>-&gt;</b>
       <b>Parsetree.attributes</b> <b>-&gt;</b> <b>string</b> <b>-&gt;</b> <b>unit</b>

       <u>val</u> <u>alerts_of_attrs</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>Misc.alerts</b>

       <u>val</u> <u>alerts_of_sig</u> : <b>mark:bool</b> <b>-&gt;</b> <b>Parsetree.signature</b> <b>-&gt;</b> <b>Misc.alerts</b>

       <u>val</u> <u>alerts_of_str</u> : <b>mark:bool</b> <b>-&gt;</b> <b>Parsetree.structure</b> <b>-&gt;</b> <b>Misc.alerts</b>

       <u>val</u> <u>check_deprecated_mutable</u> : <b>Location.t</b> <b>-&gt;</b> <b>Parsetree.attributes</b> <b>-&gt;</b> <b>string</b> <b>-&gt;</b> <b>unit</b>

       <u>val</u>   <u>check_deprecated_mutable_inclusion</u>   :   <b>def:Location.t</b>   <b>-&gt;</b>   <b>use:Location.t</b>   <b>-&gt;</b>   <b>Location.t</b>  <b>-&gt;</b>
       <b>Parsetree.attributes</b> <b>-&gt;</b> <b>Parsetree.attributes</b> <b>-&gt;</b> <b>string</b> <b>-&gt;</b> <b>unit</b>

       <u>val</u> <u>error_of_extension</u> : <b>Parsetree.extension</b> <b>-&gt;</b> <b>Location.error</b>

       <u>val</u> <u>warning_attribute</u> : <b>?ppwarning:bool</b> <b>-&gt;</b> <b>Parsetree.attribute</b> <b>-&gt;</b> <b>unit</b>

       Apply warning settings from the specified  attribute.   "ocaml.warning"/"ocaml.warnerror"  (and  variants
       without the prefix) are processed and marked used for warning 53.  Other attributes are ignored.

       Also implement ocaml.ppwarning (unless ~ppwarning:false is passed).

       <u>val</u> <u>warning_scope</u> : <b>?ppwarning:bool</b> <b>-&gt;</b> <b>Parsetree.attributes</b> <b>-&gt;</b> <b>(unit</b> <b>-&gt;</b> <b>'a)</b> <b>-&gt;</b> <b>'a</b>

       Execute  a  function  in  a  new  scope  for warning settings.  This means that the effect of any call to
       <b>warning_attribute</b> during the execution of this function will be discarded after execution.

       The function also takes a list of attributes which are processed  with  <b>warning_attribute</b>  in  the  fresh
       scope before the function is executed.

   <b>Helpers</b> <b>for</b> <b>searching</b> <b>for</b> <b>particular</b> <b>attributes</b>
       <u>val</u> <u>has_attribute</u> : <b>string</b> <b>-&gt;</b> <b>Parsetree.attributes</b> <b>-&gt;</b> <b>bool</b>

       <b>has_attribute</b>  <b>name</b> <b>attrs</b> is true if an attribute with name <b>name</b> or <b>"ocaml."</b> <b>^</b> <b>name</b> is present in <b>attrs</b> .
       It marks that attribute used for the purposes of misplaced attribute warnings.

       <u>type</u> <u>attr_action</u> =
        | Mark_used_only
        | Return

       <b>select_attributes</b> <b>actions</b> <b>attrs</b> finds the elements of <b>attrs</b> that appear in  <b>actions</b>  and  either  returns
       them or just marks them used, according to the corresponding <b>attr_action</b> .

       Each  element  <b>(nm,</b> <b>action)</b> of the <b>actions</b> list is an attribute along with an <b>attr_action</b> specifying what
       to do with that attribute.  The action is used to accommodate different compiler configurations.   If  an
       attribute is used only in some compiler configurations, it's important that we still look for it and mark
       it used when compiling with other configurations.  Otherwise, we would issue spurious misplaced attribute
       warnings.

       <u>val</u> <u>select_attributes</u> : <b>(string</b> <b>*</b> <b>attr_action)</b> <b>list</b> <b>-&gt;</b> <b>Parsetree.attributes</b> <b>-&gt;</b> <b>Parsetree.attributes</b>

       <u>val</u> <u>attr_equals_builtin</u> : <b>Parsetree.attribute</b> <b>-&gt;</b> <b>string</b> <b>-&gt;</b> <b>bool</b>

       <b>attr_equals_builtin</b>  <b>attr</b>  <b>s</b>  is true if the name of the attribute is <b>s</b> or <b>"ocaml."</b> <b>^</b> <b>s</b> .  This is useful
       for manually inspecting attribute names, but note that doing so will not result in marking the  attribute
       used for the purpose of warning 53, so it is usually preferable to use <b>has_attribute</b> or <b>select_attributes</b>
       .

       <u>val</u> <u>warn_on_literal_pattern</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>bool</b>

       <u>val</u> <u>explicit_arity</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>bool</b>

       <u>val</u> <u>immediate</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>bool</b>

       <u>val</u> <u>immediate64</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>bool</b>

       <u>val</u> <u>has_unboxed</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>bool</b>

       <u>val</u> <u>has_boxed</u> : <b>Parsetree.attributes</b> <b>-&gt;</b> <b>bool</b>

OCamldoc                                           2025-06-12                             <u><a href="../man3o/Builtin_attributes.3o.html">Builtin_attributes</a></u>(3o)
</pre>
 </div>
</div></section>
</div>
</body>
</html>