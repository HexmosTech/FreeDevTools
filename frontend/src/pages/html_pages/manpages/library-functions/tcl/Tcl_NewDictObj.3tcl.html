<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tcl_NewDictObj,  Tcl_DictObjPut,  Tcl_DictObjGet,  Tcl_DictObjRemove,  Tcl_DictObjSize, Tcl_DictObjFirst,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl9.0-doc">tcl9.0-doc_9.0.1+dfsg-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Tcl_NewDictObj,  Tcl_DictObjPut,  Tcl_DictObjGet,  Tcl_DictObjRemove,  Tcl_DictObjSize, Tcl_DictObjFirst,
       Tcl_DictObjNext, Tcl_DictObjDone, Tcl_DictObjPutKeyList, Tcl_DictObjRemoveKeyList - manipulate Tcl values
       as dictionaries

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tcl.h&gt;</b>

       Tcl_Obj *
       <b>Tcl_NewDictObj</b>()

       int
       <b>Tcl_DictObjGet</b>(<u>interp,</u> <u>dictPtr,</u> <u>keyPtr,</u> <u>valuePtrPtr</u>)

       int
       <b>Tcl_DictObjPut</b>(<u>interp,</u> <u>dictPtr,</u> <u>keyPtr,</u> <u>valuePtr</u>)

       int
       <b>Tcl_DictObjRemove</b>(<u>interp,</u> <u>dictPtr,</u> <u>keyPtr</u>)

       int
       <b>Tcl_DictObjSize</b>(<u>interp,</u> <u>dictPtr,</u> <u>sizePtr</u>)

       int
       <b>Tcl_DictObjFirst</b>(<u>interp,</u> <u>dictPtr,</u> <u>searchPtr,</u>
                        <u>keyPtrPtr,</u> <u>valuePtrPtr,</u> <u>donePtr</u>)

       <b>Tcl_DictObjNext</b>(<u>searchPtr,</u> <u>keyPtrPtr,</u> <u>valuePtrPtr,</u> <u>donePtr</u>)

       <b>Tcl_DictObjDone</b>(<u>searchPtr</u>)

       int
       <b>Tcl_DictObjPutKeyList</b>(<u>interp,</u> <u>dictPtr,</u> <u>keyc,</u> <u>keyv,</u> <u>valuePtr</u>)

       int
       <b>Tcl_DictObjRemoveKeyList</b>(<u>interp,</u> <u>dictPtr,</u> <u>keyc,</u> <u>keyv</u>)

</pre><h4><b>ARGUMENTS</b></h4><pre>
       Tcl_Interp <u>*interp</u> (in)                    If an error occurs while converting a value to be a dictionary
                                                  value, an error message is left in  the  interpreter's  result
                                                  value unless <u>interp</u> is NULL.

       Tcl_Obj <u>*dictPtr</u> (in/out)                  Points  to the dictionary value to be manipulated.  If <u>dictPtr</u>
                                                  does not already point to a dictionary value, an attempt  will
                                                  be made to convert it to one.

       Tcl_Obj <u>*keyPtr</u> (in)                       Points  to  the  key  for the key/value pair being manipulated
                                                  within the dictionary value.

       Tcl_Obj <u>**keyPtrPtr</u> (out)                  Points to a variable that will have the key from  a  key/value
                                                  pair  placed  within  it.   May  be  NULL to indicate that the
                                                  caller is not interested in the key.

       Tcl_Obj <u>*valuePtr</u> (in)                     Points to the value for the key/value pair  being  manipulated
                                                  within  the  dictionary  value  (or  sub-value, in the case of
                                                  <b>Tcl_DictObjPutKeyList</b>.)

       Tcl_Obj <u>**valuePtrPtr</u> (out)                Points to a variable that will have the value from a key/value
                                                  pair   placed   within   it.    For    <b>Tcl_DictObjFirst</b>    and
                                                  <b>Tcl_DictObjNext</b>,  this may be NULL to indicate that the caller
                                                  is not interested in the value.

       Tcl_Size | int <u>*sizePtr</u> (out)              Points to a variable that will have the  number  of  key/value
                                                  pairs  contained  within the dictionary placed within it.  May
                                                  be (Tcl_Size *)NULL when not used. If it points to a  variable
                                                  which  type  is  not  <b>Tcl_Size</b>,  a  compiler  warning  will be
                                                  generated.  If your extensions is compiled  with  -DTCL_8_API,
                                                  this  function  will  return NULL for dictionaries larger than
                                                  INT_MAX  (which   should   trigger   proper   error-handling),
                                                  otherwise expect it to crash.

       Tcl_DictSearch <u>*searchPtr</u> (in/out)         Pointer  to  record  to  use  to  keep  track  of  progress in
                                                  enumerating all key/value pairs in a dictionary.  The contents
                                                  of  the  record  will  be   initialized   by   the   call   to
                                                  <b>Tcl_DictObjFirst</b>.   If  the  enumerating  is  to be terminated
                                                  before all values in the dictionary have  been  returned,  the
                                                  search  record <u>must</u> be passed to <b>Tcl_DictObjDone</b> to enable the
                                                  internal locks to be released.

       int <u>*donePtr</u> (out)                         Points to a variable that will have a non-zero  value  written
                                                  into  it  when  the  enumeration  of  the key/value pairs in a
                                                  dictionary has completed, and a zero otherwise.

       Tcl_Size <u>keyc</u> (in)                         Indicates the number of keys that will be supplied in the <u>keyv</u>
                                                  array.

       Tcl_Obj *const <u>*keyv</u> (in)                  Array of <u>keyc</u> pointers to  values  that  <b>Tcl_DictObjPutKeyList</b>
                                                  and  <b>Tcl_DictObjRemoveKeyList</b> will use to locate the key/value
                                                  pair to manipulate within the  sub-dictionaries  of  the  main
                                                  dictionary value passed to them.
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Tcl dictionary values have an internal representation that supports efficient mapping from keys to values
       and  which  guarantees that the particular ordering of keys within the dictionary remains the same modulo
       any keys being deleted (which removes them from the order) or added (which adds them to the  end  of  the
       order). If reinterpreted as a list, the values at the even-valued indices in the list will be the keys of
       the  dictionary,  and  each  will be followed (in the odd-valued index) by the value associated with that
       key.

       The procedures described in this man page are used to create, modify, index, and iterate over  dictionary
       values from C code.

       <b>Tcl_NewDictObj</b>  creates  a  new,  empty dictionary value.  The string representation of the value will be
       invalid, and the reference count of the value will be zero.

       <b>Tcl_DictObjGet</b> looks up the given key within the given dictionary and  writes  a  pointer  to  the  value
       associated with that key into the variable pointed to by <u>valuePtrPtr</u>, or a NULL if the key has no mapping
       within  the  dictionary.   The  result of this procedure is <b>TCL_OK</b>, or <b>TCL_ERROR</b> if the <u>dictPtr</u> cannot be
       converted to a dictionary.

       <b>Tcl_DictObjPut</b> updates the given dictionary so that the given key maps to the given value;  any  key  may
       exist  at  most  once  in  any particular dictionary.  The dictionary must not be shared, but the key and
       value may be.  This procedure may increase the reference count  of  both  key  and  value  if  it  proves
       necessary  to store them.  Neither key nor value should be NULL.  The result of this procedure is <b>TCL_OK</b>,
       or <b>TCL_ERROR</b> if the <u>dictPtr</u> cannot be converted to a dictionary.

       <b>Tcl_DictObjRemove</b> updates the given dictionary so that the given key has no mapping to  any  value.   The
       dictionary  must  not be shared, but the key may be.  The key actually stored in the dictionary will have
       its reference count decremented if it was present.  It is not an error if  the  key  did  not  previously
       exist.   The  result  of  this  procedure is <b>TCL_OK</b>, or <b>TCL_ERROR</b> if the <u>dictPtr</u> cannot be converted to a
       dictionary.

       <b>Tcl_DictObjSize</b> updates the given variable with the number of key/value  pairs  currently  in  the  given
       dictionary.  The result of this procedure is <b>TCL_OK</b>, or <b>TCL_ERROR</b> if the <u>dictPtr</u> cannot be converted to a
       dictionary or if <u>sizePtr</u> points to a variable of type <b>int</b> and the dict contains more than 2**31 key/value
       pairs.

       <b>Tcl_DictObjFirst</b> commences an iteration across all the key/value pairs in the given  dictionary,  placing
       the  key  and  value in the variables pointed to by the <u>keyPtrPtr</u> and <u>valuePtrPtr</u> arguments (which may be
       NULL to indicate that the caller is uninterested  in  they  key  or  variable  respectively.)   The  next
       key/value  pair  in  the  dictionary  may  be  retrieved with <b>Tcl_DictObjNext</b>.  Concurrent updates of the
       dictionary's internal representation will not modify the iteration processing unless  the  dictionary  is
       unshared, when this will trigger premature termination of the iteration instead (which Tcl scripts cannot
       trigger  via  the  <b>dict</b>  command.)   The  <u>searchPtr</u> argument points to a piece of context that is used to
       identify  which  particular  iteration  is  being  performed,  and  is  initialized  by   the   call   to
       <b>Tcl_DictObjFirst</b>.   The  <u>donePtr</u>  argument  points  to a variable that is updated to be zero of there are
       further key/value pairs to be iterated over, or non-zero if the iteration  is  complete.   The  order  of
       iteration  is  implementation-defined.   If  the  <u>dictPtr</u>  argument  cannot be converted to a dictionary,
       <b>Tcl_DictObjFirst</b> returns <b>TCL_ERROR</b> and the iteration is not commenced, and otherwise it returns <b>TCL_OK</b>.

       When <b>Tcl_DictObjFirst</b> is called upon a dictionary, a lock is placed on  the  dictionary  to  enable  that
       dictionary  to  be  iterated over safely without regard for whether the dictionary is modified during the
       iteration. Because of this, once the iteration over a dictionary's keys has finished (whether because all
       values have been iterated over as indicated by the variable indicated by the <u>donePtr</u> argument  being  set
       to  one,  or because no further values are required) the <b>Tcl_DictObjDone</b> function must be called with the
       same <u>searchPtr</u> as was passed to <b>Tcl_DictObjFirst</b> so that the internal  locks  can  be  released.  Once  a
       particular  <u>searchPtr</u>  is  passed  to  <b>Tcl_DictObjDone</b>,  passing  it  to  <b>Tcl_DictObjNext</b>  (without first
       initializing it with <b>Tcl_DictObjFirst</b>) will result in no values being produced and the  variable  pointed
       to  by <u>donePtr</u> being set to one.  It is safe to call <b>Tcl_DictObjDone</b> multiple times on the same <u>searchPtr</u>
       for each call to <b>Tcl_DictObjFirst</b>.

       The  procedures  <b>Tcl_DictObjPutKeyList</b>  and  <b>Tcl_DictObjRemoveKeyList</b>  are   the   close   analogues   of
       <b>Tcl_DictObjPut</b>  and  <b>Tcl_DictObjRemove</b>  respectively,  except  that  instead  of  working  with  a single
       dictionary, they are designed to operate on a nested tree of dictionaries, with inner dictionaries stored
       as values inside outer dictionaries.  The <u>keyc</u> and <u>keyv</u> arguments specify a list of keys (with  outermost
       keys  first)  that  acts  as  a  path  to  the  key/value  pair  to  be  affected.  Note that there is no
       corresponding operation for reading a value for a path as this is easy to construct from repeated use  of
       <b>Tcl_DictObjGet</b>.  With  <b>Tcl_DictObjPutKeyList</b>, nested dictionaries are created for non-terminal keys where
       they do not already exist. With <b>Tcl_DictObjRemoveKeyList</b>, all  non-terminal  keys  must  exist  and  have
       dictionaries as their values.

</pre><h4><b>REFERENCE</b> <b>COUNT</b> <b>MANAGEMENT</b></h4><pre>
       <b>Tcl_NewDictObj</b> always returns a zero-reference object, much like <b>Tcl_NewObj</b>.

       <b>Tcl_DictObjPut</b>  does  not  modify  the reference count of its <u>dictPtr</u> argument, but does require that the
       object be unshared.  If <b>Tcl_DictObjPut</b> returns <b>TCL_ERROR</b> it does not manipulate any reference counts; but
       if it returns <b>TCL_OK</b> then it definitely increments the reference count of <u>valuePtr</u> and may increment  the
       reference  count  of <u>keyPtr</u>; the latter case happens exactly when the key did not previously exist in the
       dictionary.  Note however that this function may set the interpreter result; if that is  the  only  place
       that is holding a reference to an object, it will be deleted.

       <b>Tcl_DictObjGet</b>  only reads from its <u>dictPtr</u> and <u>keyPtr</u> arguments, and does not manipulate their reference
       counts at all.  If the <u>valuePtrPtr</u> argument  is  not  set  to  NULL  (and  the  function  doesn't  return
       <b>TCL_ERROR</b>), it will be set to a value with a reference count of at least 1, with a reference owned by the
       dictionary.   Note  however  that this function may set the interpreter result; if that is the only place
       that is holding a reference to an object, it will be deleted.

       <b>Tcl_DictObjRemove</b> does not modify the reference count of its <u>dictPtr</u> argument, but does require that  the
       object  be  unshared.  It  does  not  manipulate the reference count of its <u>keyPtr</u> argument at all.  Note
       however that this function may set the interpreter result; if that is the only place that  is  holding  a
       reference to an object, it will be deleted.

       <b>Tcl_DictObjSize</b> does not modify the reference count of its <u>dictPtr</u> argument; it only reads.  Note however
       that  this function may set the interpreter result; if that is the only place that is holding a reference
       to the dictionary object, it will be deleted.

       <b>Tcl_DictObjFirst</b> does not modify the reference  count  of  its  <u>dictPtr</u>  argument;  it  only  reads.  The
       variables  given  by  the  <u>keyPtrPtr</u>  and  <u>valuePtrPtr</u> arguments (if not NULL) will be updated to contain
       references to the relevant values in the dictionary; their reference counts will be at least  1  (due  to
       the  dictionary  holding  a reference to them). It may also manipulate internal references; these are not
       exposed to user code, but require a matching <b>Tcl_DictObjDone</b> call.  Note however that this  function  may
       set  the  interpreter  result;  if  that  is the only place that is holding a reference to the dictionary
       object, it will be deleted.

       Similarly for <b>Tcl_DictObjNext</b>; the variables given by the <u>keyPtrPtr</u> and  <u>valuePtrPtr</u>  arguments  (if  not
       NULL)  will  be  updated  to contain references to the relevant values in the dictionary; their reference
       counts will be at least 1 (due to the dictionary holding a reference to them).

       <b>Tcl_DictObjDone</b> does not manipulate (user-visible) reference counts.

       <b>Tcl_DictObjPutKeyList</b> is similar to <b>Tcl_DictObjPut</b>; it does not modify the reference count of its <u>dictPtr</u>
       argument, but does require that the object be unshared. It may increment the reference count of any value
       passed in the <u>keyv</u> argument, and will increment the reference count of the <u>valuePtr</u> argument on  success.
       It  is  recommended  that  values  passed  via <u>keyv</u> and <u>valuePtr</u> do not have zero reference counts.  Note
       however that this function may set the interpreter result; if that is the only place that  is  holding  a
       reference to an object, it will be deleted.

       <b>Tcl_DictObjRemoveKeyList</b>  is  similar to <b>Tcl_DictObjRemove</b>; it does not modify the reference count of its
       <u>dictPtr</u> argument, but does require that the object be unshared, and does not modify the reference  counts
       of  any  of  the  values  passed  in  the  <u>keyv</u>  argument.   Note  however that this function may set the
       interpreter result; if that is the only place that is holding a  reference  to  an  object,  it  will  be
       deleted.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Using the dictionary iteration interface to search determine if there is a key that maps to itself:

              Tcl_DictSearch search;
              Tcl_Obj *key, *value;
              int done;

              /*
               * Assume interp and objPtr are parameters.  This is the
               * idiomatic way to start an iteration over the dictionary; it
               * sets a lock on the internal representation that ensures that
               * there are no concurrent modification issues when normal
               * reference count management is also used.  The lock is
               * released automatically when the loop is finished, but must
               * be released manually when an exceptional exit from the loop
               * is performed. However it is safe to try to release the lock
               * even if we've finished iterating over the loop.
               */
              if (<b>Tcl_DictObjFirst</b>(interp, objPtr, &amp;search,
                      &amp;key, &amp;value, &amp;done) != TCL_OK) {
                  return TCL_ERROR;
              }
              for (; !done ; <b>Tcl_DictObjNext</b>(&amp;search, &amp;key, &amp;value, &amp;done)) {
                  /*
                   * Note that strcmp() is not a good way of comparing
                   * values and is just used here for demonstration
                   * purposes.
                   */
                  if (!strcmp(Tcl_GetString(key), Tcl_GetString(value))) {
                      break;
                  }
              }
              <b>Tcl_DictObjDone</b>(&amp;search);
              Tcl_SetObjResult(interp, Tcl_NewBooleanObj(!done));
              return TCL_OK;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Tcl_NewObj, Tcl_DecrRefCount, Tcl_IncrRefCount, Tcl_InitObjHashTable

</pre><h4><b>KEYWORDS</b></h4><pre>
       dict, dict value, dictionary, dictionary value, hash table, iteration, value

Tcl                                                    8.5                                     <u><a href="../man3tcl/Tcl_DictObj.3tcl.html">Tcl_DictObj</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>