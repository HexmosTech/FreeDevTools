<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::Google::SafeBrowsing2::Storage - Base class for storing the Google Safe Browsing v2 database</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/libnet-google-safebrowsing2-perl">libnet-google-safebrowsing2-perl_1.07-6.1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::Google::SafeBrowsing2::Storage - Base class for storing the Google Safe Browsing v2 database

</pre><h4><b>SYNOPSIS</b></h4><pre>
         package Net::Google::SafeBrowsing2::Sqlite;

         use base 'Net::Google::SafeBrowsing2::Storage';

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This is the base class for implementing a storage mechanism for the Google Safe Browsing v2 database. See
       Net::Google::SafeBrowsing2::Sqlite for an example of implementation.

       This module cannot be used on its own as it does not actually store anything. All methods should
       redefined. Check the code to see which arguments are used, and what should be returned.

</pre><h4><b>CONSTRUCTOR</b></h4><pre>
   <b>new()</b>
         Create a Net::Google::SafeBrowsing2::Storage object

         my $storage   =&gt; Net::Google::SafeBrowsing2::Storage-&gt;new();

</pre><h4><b>PUBLIC</b> <b>FUNCTIONS</b></h4><pre>
   <b>add_chunks()</b>
       Add chunk information to the local database

         $storage-&gt;add_chunks(type =&gt; 'a', chunknum =&gt; 2154, chunks =&gt; [{host =&gt; HEX, prefix =&gt; ''}], list =&gt; 'goog-malware-shavar');

       Does not return anything.

       Arguments

       type
           Required. Type of chunk: 'a' (add chunk) or 's' (sub chunk).

       chunknum
           Required. Chunk number.

       chunks
           Required. Array of chunks

           For add chunks, each element of the array is an hash reference in the following format:

             {
               host =&gt; HEX,
                   prefix =&gt; HEX
             }

           For sub chunks, each element of the array is an hash reference in the following format:

             {
               host =&gt; HEX,
                   prefix =&gt; HEX,
               add_chunknum =&gt; INTEGER
             }

       list
           Required. Google Safe Browsing list name.

   <b>get_add_chunks()</b>
       Returns a list of chunks for a given host key for all lists.

               my @chunks = $storage-&gt;get_add_chunks(hostkey =&gt; HEX);

       Arguments

       hostkey.
           Required. Host key.

       Return value

           Array of add chunks in the same format as described above:

               (
                           {
                                   chunknum        =&gt; 25121,
                                   hostkey         =&gt; hex('12345678'),
                                   prefix          =&gt; '',
                                   list            =&gt; 'goog-malware-shavar'
                           },
                           {
                                   chunknum        =&gt; '25121',
                                   hostkey         =&gt; hex('12345678'),
                                   prefix          =&gt; hex('2fc96b9f'),
                                   list            =&gt; 'goog-malware-shavar'
                           },
                   );

   <b>get_sub_chunks()</b>
       Returns a list of sub chunks for a given host key for all lists.

               my @chunks = $storage-&gt;get_sub_chunks(hostkey =&gt; HEX);

       Arguments

       hostkey
           Required. Host key.

       Return value

           Array of add chunks in the same format as described above:

               (
                           {
                                   chunknum        =&gt; 37441,
                                   prefix          =&gt; '',
                                   addchunknum     =&gt; 23911,
                                   list            =&gt; 'goog-malware-shavar'
                           },
                           {
                                   chunknum        =&gt; 37441,
                                   prefix          =&gt; '',
                                   addchunknum     =&gt; 22107,
                                   list            =&gt; 'goog-malware-shavar'
                           },
                   );

   <b>get_add_chunks_nums()</b>
       Returns a list of unique add chunk numbers for a specific list.

       <b>IMPORTANT</b>: this list should be sorted in ascendant order.

               my @ids = $storage-&gt;get_add_chunks_nums(list =&gt; 'goog-malware-shavar');

       Arguments

       list
           Required. Google Safe Browsing list name

       Return value

           Array of integers sorted in ascendant order:

               qw(25121 25122 25123 25124 25125 25126)

   <b>get_sub_chunks_nums()</b>
       Returns a list of unique sub chunk numbers for a specific list.

       <b>IMPORTANT</b>: this list should be sorted in ascendant order.

               my @ids = $storage-&gt;get_sub_chunks_nums(list =&gt; 'goog-malware-shavar');

       Arguments

       list
           Required. Google Safe Browsing list name

       Return value

           Array of integers sorted in ascendant order:

               qw(37441 37442 37443 37444 37445 37446 37447 37448 37449 37450)

   <b>delete_add_chunks()</b>
       Delete add chunks from the local database

               $storage-&gt;delete_add_chunks(chunknums =&gt; [qw/37444 37445 37446/], list =&gt; 'goog-malware-shavar');

       Arguments

       chunknums
           Required. Array of chunk numbers

       list
           Required. Google Safe Browsing list name

       No return value

   <b>delete_sub_chunks()</b>
       Delete sub chunks from the local database

               $storage-&gt;delete_sub_chunks(chunknums =&gt; [qw/37444 37445 37446/], list =&gt; 'goog-malware-shavar');

       Arguments

       chunknums
           Required. Array of chunk numbers

       list
           Required. Google Safe Browsing list name

       No return value

   <b>get_full_hashes()</b>
       Return a list of full hashes

               $storage-&gt;get_full_hashes(chunknum =&gt; 37444, timestamp =&gt; time() - 45 * 60 * 60, list =&gt; 'goog-malware-shavar');

       Arguments

       chunknum
           Required. Add chunk number

       timestamp
           Required. Request hashes retrieved after this timestamp value.

       list
           Required. Google Safe Browsing list name

       Return value

           Array of full hashes:

               (HEX, HEX, HEX)

   <b>updated()</b>
       Save information about a successful database update

               $storage-&gt;updated('time' =&gt; time(), wait =&gt; 1800, list =&gt; 'goog-malware-shavar');

       Arguments

       time
           Required. Time of the update.

       wait
           Required. Number o seconds to wait before doing the next update.

       list
           Required. Google Safe Browsing list name.

       No return value

   <b>update_error()</b>
       Save information about a failed database update

               $storage-&gt;update_error('time' =&gt; time(), wait =&gt; 60, list =&gt; 'goog-malware-shavar', errors =&gt; 1);

       Arguments

       time
           Required. Time of the update.

       wait
           Required. Number o seconds to wait before doing the next update.

       list
           Required. Google Safe Browsing list name.

       errors
           Required. Number of errors.

       No return value

   <b>last_update()</b>
       Return information about the last database update

               my $info = $storage-&gt;last_update(list =&gt; 'goog-malware-shavar');

       Arguments

       list
           Required. Google Safe Browsing list name.

       Return value

           Hash reference

                   {
                           time    =&gt; time(),
                           wait    =&gt; 1800,
                           errors  =&gt; 0
                   }

   <b>add_full_hashes()</b>
       Add full hashes to the local database

               $storage-&gt;add_full_hashes(timestamp =&gt; time(), full_hashes =&gt; [{chunknum =&gt; 2154, hash =&gt; HEX, list =&gt; 'goog-malware-shavar'}]);

       Arguments

       timestamp
           Required. Time when the full hash was retrieved.

       full_hashes
           Required. Array of full hashes. Each element is an hash reference in the following format:

                   {
                           chunknum        =&gt; INTEGER,
                           hash            =&gt; HEX,
                           list            =&gt; 'goog-malware-shavar'
                   }

       No return value

   <b>delete_full_hashes()</b>
       Delete full hashes from the local database

               $storage-&gt;delete_full_hashes(chunknums =&gt; [qw/2154 2156 2158/], list =&gt; 'goog-malware-shavar');

       Arguments

       chunknums
           Required. Array of chunk numbers.

       list
           Required. Google Safe Browsing list name.

       No return value

   <b>full_hash_error()</b>
       Save information about failed attempt to retrieve a full hash

               $storage-&gt;full_hash_error(timestamp =&gt; time(), prefix =&gt; HEX);

       Arguments

       timestamp
           Required. Time when the Google returned an error.

       prefix
           Required. Host prefix.

       No return value

   <b>full_hash_ok()</b>
       Save information about a successful attempt to retrieve a full hash

               $storage-&gt;full_hash_ok(timestamp =&gt; time(), prefix =&gt; HEX);

       Arguments

       timestamp
           Required. Time when the Google returned an error.

       prefix
           Required. Host prefix.

       No return value

   <b>get_full_hash_error()</b>
       Save information about a successful attempt to retrieve a full hash

               my $info = $storage-&gt;get_full_hash_error(prefix =&gt; HEX);

       Arguments

       prefix
           Required. Host prefix.

       Return value

           undef if there was no error

           Hash reference in the following format if there was an error:

                   {
                           timestamp       =&gt; time(),
                           errors          =&gt; 3
                   }

   <b>get_mac_keys()</b>
       Retrieve the Message Authentication Code (MAC) keys.

               my $keys = $storage-&gt;get_mac_keys();

       No arguments

       Return value

           Hash reference in the following format:

                   {
                           client_key      =&gt; '',
                           wrapped_key     =&gt; ''
                   }

   <b>delete_add_keys()</b>
       Add the Message Authentication Code (MAC) keys.

               $storage-&gt;delete_mac_keys(client_key =&gt; 'KEY', wrapped_key =&gt; 'KEY');

       Arguments

       client_key
           Required. Client key.

       wrapped_key
           Required. Wrapped key.

       No return value

   <b>delete_mac_keys()</b>
       Delete the Message Authentication Code (MAC) keys.

               $storage-&gt;delete_mac_keys();

       No arguments

       No return value

   <b>reset()</b>
       Remove all local data

               $storage-&gt;delete_mac_keys();

       Arguments

       list
           Required. Google Safe Browsing list name.

       No return value

</pre><h4><b>PRIVATE</b> <b>FUNCTIONS</b></h4><pre>
       These functions are not intended for debugging purpose.

   <b>hex_to_ascii()</b>
       Transform hexadecimal strings to printable ASCII strings. Used mainly for debugging.

         print $storage-&gt;hex_to_ascii('hex value');

   <b>ascii_to_hex()</b>
       Transform ASCII strings to hexadecimal strings.

                 print $storage-&gt;ascii_to_hex('ascii value');

</pre><h4><b>CHANGELOG</b></h4><pre>
       0.4 Add reset mehtod to empty local database.

       0.3 Return the hostkey as part of the add chunks (get_add_chunks).

       0.2 Add functions to store and retrieve Message Authentication Code (MAC) keys.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       See Net::Google::SafeBrowsing2 for handling Google Safe Browsing v2.

       See Net::Google::SafeBrowsing2::Sqlite or Net::Google::SafeBrowsing2::MySQL for an example of storing and
       managing the Google Safe Browsing database.

       Google Safe Browsing v2 API: &lt;<a href="http://code.google.com/apis/safebrowsing/developers_guide_v2.html">http://code.google.com/apis/safebrowsing/developers_guide_v2.html</a>&gt;

</pre><h4><b>AUTHOR</b></h4><pre>
       Julien Sobrier, &lt;<a href="mailto:jsobrier@zscaler.com">jsobrier@zscaler.com</a>&gt; or &lt;<a href="mailto:julien@sobrier.net">julien@sobrier.net</a>&gt;

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       Copyright (C) 2011 by Julien Sobrier

       This  library  is  free  software;  you can redistribute it and/or modify it under the same terms as Perl
       itself, either Perl version 5.8.8 or, at your option, any later version of Perl 5 you may have available.

perl v5.32.0                                       2021-01-07              <u>Net::Google::S...wsing2::<a href="../man3pm/Storage.3pm.html">Storage</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>