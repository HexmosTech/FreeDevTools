<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X509v3_get_ext_count, X509v3_get_ext, X509v3_get_ext_by_NID, X509v3_get_ext_by_OBJ,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       X509v3_get_ext_count, X509v3_get_ext, X509v3_get_ext_by_NID, X509v3_get_ext_by_OBJ,
       X509v3_get_ext_by_critical, X509v3_delete_ext, X509v3_add_ext, X509v3_add_extensions, X509_get_ext_count,
       X509_get_ext, X509_get_ext_by_NID, X509_get_ext_by_OBJ, X509_get_ext_by_critical, X509_delete_ext,
       X509_add_ext, X509_CRL_get_ext_count, X509_CRL_get_ext, X509_CRL_get_ext_by_NID, X509_CRL_get_ext_by_OBJ,
       X509_CRL_get_ext_by_critical, X509_CRL_delete_ext, X509_CRL_add_ext, X509_REVOKED_get_ext_count,
       X509_REVOKED_get_ext, X509_REVOKED_get_ext_by_NID, X509_REVOKED_get_ext_by_OBJ,
       X509_REVOKED_get_ext_by_critical, X509_REVOKED_delete_ext, X509_REVOKED_add_ext - extension stack utility
       functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/x509.h&gt;

        int X509v3_get_ext_count(const STACK_OF(X509_EXTENSION) *x);
        X509_EXTENSION *X509v3_get_ext(const STACK_OF(X509_EXTENSION) *x, int loc);

        int X509v3_get_ext_by_NID(const STACK_OF(X509_EXTENSION) *x,
                                  int nid, int lastpos);
        int X509v3_get_ext_by_OBJ(const STACK_OF(X509_EXTENSION) *x,
                                  const ASN1_OBJECT *obj, int lastpos);
        int X509v3_get_ext_by_critical(const STACK_OF(X509_EXTENSION) *x,
                                       int crit, int lastpos);
        X509_EXTENSION *X509v3_delete_ext(STACK_OF(X509_EXTENSION) *x, int loc);
        STACK_OF(X509_EXTENSION) *X509v3_add_ext(STACK_OF(X509_EXTENSION) **x,
                                                 X509_EXTENSION *ex, int loc);
        STACK_OF(X509_EXTENSION)
             *X509v3_add_extensions(STACK_OF(X509_EXTENSION) **target,
                                    const STACK_OF(X509_EXTENSION) *exts);

        int X509_get_ext_count(const X509 *x);
        X509_EXTENSION *X509_get_ext(const X509 *x, int loc);
        int X509_get_ext_by_NID(const X509 *x, int nid, int lastpos);
        int X509_get_ext_by_OBJ(const X509 *x, const ASN1_OBJECT *obj, int lastpos);
        int X509_get_ext_by_critical(const X509 *x, int crit, int lastpos);
        X509_EXTENSION *X509_delete_ext(X509 *x, int loc);
        int X509_add_ext(X509 *x, X509_EXTENSION *ex, int loc);

        int X509_CRL_get_ext_count(const X509_CRL *x);
        X509_EXTENSION *X509_CRL_get_ext(const X509_CRL *x, int loc);
        int X509_CRL_get_ext_by_NID(const X509_CRL *x, int nid, int lastpos);
        int X509_CRL_get_ext_by_OBJ(const X509_CRL *x, const ASN1_OBJECT *obj,
                                    int lastpos);
        int X509_CRL_get_ext_by_critical(const X509_CRL *x, int crit, int lastpos);
        X509_EXTENSION *X509_CRL_delete_ext(X509_CRL *x, int loc);
        int X509_CRL_add_ext(X509_CRL *x, X509_EXTENSION *ex, int loc);

        int X509_REVOKED_get_ext_count(const X509_REVOKED *x);
        X509_EXTENSION *X509_REVOKED_get_ext(const X509_REVOKED *x, int loc);
        int X509_REVOKED_get_ext_by_NID(const X509_REVOKED *x, int nid, int lastpos);
        int X509_REVOKED_get_ext_by_OBJ(const X509_REVOKED *x, const ASN1_OBJECT *obj,
                                        int lastpos);
        int X509_REVOKED_get_ext_by_critical(const X509_REVOKED *x, int crit, int lastpos);
        X509_EXTENSION *X509_REVOKED_delete_ext(X509_REVOKED *x, int loc);
        int X509_REVOKED_add_ext(X509_REVOKED *x, X509_EXTENSION *ex, int loc);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>X509v3_get_ext_count()</b> retrieves the number of extensions in <u>x</u>.

       <b>X509v3_get_ext()</b> retrieves extension <u>loc</u> from <u>x</u>. The index <u>loc</u> can take any value from 0 to
       X509_get_ext_count(<u>x</u>) - 1. The returned extension is an internal pointer which <b>MUST</b> <b>NOT</b> be freed by the
       application.

       <b>X509v3_get_ext_by_NID()</b> and <b>X509v3_get_ext_by_OBJ()</b> look for an extension with <u>nid</u> or <u>obj</u> from extension
       STACK <u>x</u>. The search starts from the extension after <u>lastpos</u> or from the beginning if <u>lastpos</u> is -1. If
       the extension is found, its index is returned, otherwise -1 is returned.

       <b>X509v3_get_ext_by_critical()</b> is similar to <b>X509v3_get_ext_by_NID()</b> except it looks for an extension of
       criticality <u>crit</u>. A zero value for <u>crit</u> looks for a non-critical extension. A nonzero value looks for a
       critical extension.

       <b>X509v3_delete_ext()</b> deletes the extension with index <u>loc</u> from <u>x</u>.  The deleted extension is returned and
       must be freed by the caller.  If <u>loc</u> is an invalid index value, NULL is returned.

       <b>X509v3_add_ext()</b> inserts extension <u>ex</u> to STACK <u>*x</u> at position <u>loc</u>.  If <u>loc</u> is -1, the new extension is
       added to the end.  A new STACK is allocated if <u>*x</u> is NULL.  The passed extension <u>ex</u> is duplicated so it
       must be freed after use.

       <b>X509v3_add_extensions()</b> adds the list of extensions <u>exts</u> to STACK <u>*target</u>.  The STACK <u>*target</u> is returned
       unchanged if <u>exts</u> is NULL or an empty list.  Otherwise a new stack is allocated if <u>*target</u> is NULL.  An
       extension to be added that has the same OID as a pre-existing one replaces this earlier one.

       <b>X509_get_ext_count()</b>, <b>X509_get_ext()</b>, <b>X509_get_ext_by_NID()</b>, <b>X509_get_ext_by_OBJ()</b>,
       <b>X509_get_ext_by_critical()</b>, <b>X509_delete_ext()</b> and <b>X509_add_ext()</b> operate on the extensions of certificate
       <u>x</u>. They are otherwise identical to the X509v3 functions.

       <b>X509_CRL_get_ext_count()</b>, <b>X509_CRL_get_ext()</b>, <b>X509_CRL_get_ext_by_NID()</b>, <b>X509_CRL_get_ext_by_OBJ()</b>,
       <b>X509_CRL_get_ext_by_critical()</b>, <b>X509_CRL_delete_ext()</b> and <b>X509_CRL_add_ext()</b> operate on the extensions of
       CRL <u>x</u>. They are otherwise identical to the X509v3 functions.

       <b>X509_REVOKED_get_ext_count()</b>, <b>X509_REVOKED_get_ext()</b>, <b>X509_REVOKED_get_ext_by_NID()</b>,
       <b>X509_REVOKED_get_ext_by_OBJ()</b>, <b>X509_REVOKED_get_ext_by_critical()</b>, <b>X509_REVOKED_delete_ext()</b> and
       <b>X509_REVOKED_add_ext()</b> operate on the extensions of CRL entry <u>x</u>.  They are otherwise identical to the
       X509v3 functions.

</pre><h4><b>NOTES</b></h4><pre>
       These functions are used to examine stacks of extensions directly.  Applications that want to parse or
       encode and add an extension should use the extension encode and decode functions instead, such as
       <b>X509_add1_ext_i2d()</b> and <b>X509_get_ext_d2i()</b>.

       For <b>X509v3_get_ext_by_NID()</b>, <b>X509v3_get_ext_by_OBJ()</b>, <b>X509v3_get_ext_by_critical()</b> and its variants, a
       zero index return value is not an error since extension STACK <u>x</u> indices start from zero.  These search
       functions start from the extension <b>after</b> the <u>lastpos</u> parameter so it should initially be set to -1. If it
       is set to zero, the initial extension will not be checked.

       <b>X509v3_delete_ext()</b> and its variants are a bit counter-intuitive because these functions do not free the
       extension they delete.  They return an <b>X509_EXTENSION</b> object which must be explicitly freed using
       <b>X509_EXTENSION_free()</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>X509v3_get_ext_count()</b> returns the extension count or 0 for failure.

       <b>X509v3_get_ext()</b>, <b>X509v3_delete_ext()</b> and <b>X509_delete_ext()</b> return an <b>X509_EXTENSION</b> structure or NULL if
       an error occurs.

       <b>X509v3_get_ext_by_OBJ()</b> and <b>X509v3_get_ext_by_critical()</b> return the extension index or -1 if an error
       occurs.

       <b>X509v3_get_ext_by_NID()</b> returns the extension index or negative values if an error occurs.

       <b>X509v3_add_ext()</b> returns a STACK of extensions or NULL on error.

       <b>X509v3_add_extensions()</b> returns a STACK of extensions or NULL on error or if <u>*target</u> is NULL and <u>exts</u> is
       NULL or an empty list.

       <b>X509_add_ext()</b> returns 1 on success and 0 on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/X509V3_get_d2i.3.html">X509V3_get_d2i</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>X509v3_add_extensions()</b> was added in OpenSSL 3.4.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2015-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                        <u><a href="../man3SSL/X509V3_GET_EXT_BY_NID.3SSL.html">X509V3_GET_EXT_BY_NID</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>