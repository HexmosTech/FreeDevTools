<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNMP::Extension::PassPersist - Generic pass/pass_persist extension framework for Net-SNMP</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsnmp-extension-passpersist-perl">libsnmp-extension-passpersist-perl_0.07-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SNMP::Extension::PassPersist - Generic pass/pass_persist extension framework for Net-SNMP

</pre><h4><b>VERSION</b></h4><pre>
       This is the documentation of "SNMP::Extension::PassPersist" version 0.07

</pre><h4><b>SYNOPSIS</b></h4><pre>
       Typical setup for a "pass" program:

           use strict;
           use SNMP::Extension::PassPersist;

           # create the object
           my $extsnmp = SNMP::Extension::PassPersist-&gt;new;

           # add a few OID entries
           $extsnmp-&gt;add_oid_entry($oid, $type, $value);
           $extsnmp-&gt;add_oid_entry($oid, $type, $value);

           # run the program
           $extsnmp-&gt;run;

       Typical setup for a "pass_persist" program:

           use strict;
           use SNMP::Extension::PassPersist;

           my $extsnmp = SNMP::Extension::PassPersist-&gt;new(
               backend_collect =&gt; \&amp;update_tree
           );
           $extsnmp-&gt;run;

           sub update_tree {
               my ($self) = @_;

               # add a serie of OID entries
               $self-&gt;add_oid_entry($oid, $type, $value);
               ...

               # or directly add a whole OID tree
               $self-&gt;add_oid_tree(\%oid_tree);
           }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module is a framework for writing Net-SNMP extensions using the "pass" or "pass_persist" mechanisms.

       When in "pass_persist" mode, it provides a mechanism to spare resources by quitting from the main loop
       after a given number of idle cycles.

       This module can use "Sort::Key::OID" when it is available, for sorting OIDs faster than with the internal
       pure Perl function.

</pre><h4><b>METHODS</b></h4><pre>
   <b>new()</b>
       Creates a new object. Can be given any attributes as a hash or hashref.  See "ATTRIBUTES" for the list of
       available attributes.

       <b>Examples:</b>

       For a "pass" command, most attributes are useless:

           my $extsnmp = SNMP::Extension::PassPersist-&gt;new;

       For a "pass_persist" command, you'll usually want to at least set the "backend_collect" callback:

           my $extsnmp = SNMP::Extension::PassPersist-&gt;new(
               backend_collect =&gt; \&amp;update_tree,
               idle_count      =&gt; 10,      # no more than 10 idle cycles
               refresh         =&gt; 10,      # refresh every 10 sec
           );

   <b>run()</b>
       This method does the following things:

       •   process the command line arguments in order to decide in which mode the program has to be executed

       •   call the backend init callback

       •   call the backend collect callback a first time

       Then,  when  in  "pass"  mode,  the  corresponding SNMP command is executed, its result is printed on the
       output filehandle, and "run()" returns.

       When in "pass_persist" mode, "run()" enters a loop, reading Net-SNMP queries  on  its  input  filehandle,
       processing  them,  and  printing  result on its output filehandle. The backend collect callback is called
       every "refresh" seconds. If no query is read from the input after "idle_count" cycles, "run()" returns.

   <b>add_oid_entry(FUNC_OID,</b> <b>FUNC_TYPE,</b> <b>FUNC_VALUE)</b>
       Add an entry to the OID tree.

   <b>add_oid_tree(HASH)</b>
       Merge an OID tree to the main OID tree, using the same structure as the one of the OID tree itself.

   <b>dump_oid_tree()</b>
       Print a complete listing of the OID tree on the output file handle.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       This module's attributes are generated by "Class::Accessor", and can therefore be passed as arguments  to
       "new()" or called as object methods.

   <b>backend_collect</b>
       Set the code reference for the <u>collect</u> callback. See also "CALLBACKS".

   <b>backend_fork</b>
       When set to true, the backend callbacks will be executed in a separate process. Default value is false.

   <b>backend_init</b>
       Set the code reference for the <u>init</u> callback. See also "CALLBACKS".

   <b>backend_pipe</b>
       Contains the pipe used to communicate with the backend child, when executed in a separate process.

   <b>dispatch</b>
       Gives access to the internal dispatch table, stored as a hash with the following structure:

           dispatch =&gt; {
               SNMP_CMD  =&gt;  { nargs =&gt; NUMBER_ARGS,  code =&gt; CODEREF },
               ...
           }

       where  the  SNMP  command  is  always in lowercase, "nargs" gives the number of arguments expected by the
       command and "code" the callback reference.

       You should not modify this table unless you really know what you're doing.

   <b>heap</b>
       Give access to the heap.

   <b>idle_count</b>
       Get/set the number of idle cycles before ending the run loop.

   <b>input</b>
       Get/set the input filehandle.

   <b>oid_tree</b>
       Gives access to the internal OID tree, stored as a hash with the following structure:

           oid_tree =&gt; {
               FUNC_OID  =&gt;  [ FUNC_TYPE, FUNC_VALUE ],
               ...
           }

       where "FUNC_OID" is the absolute OID of the SNMP function,  "FUNC_TYPE"  the  function  type  ("integer",
       "counter", "gauge", etc), and "FUNC_VALUE" the function value.

       You should not directly modify this hash but instead use the appropriate methods for adding OID entries.

   <b>output</b>
       Get/set the output filehandle.

   <b>refresh</b>
       Get/set the refresh delay before calling the backend collect callback to update the OID tree.

</pre><h4><b>CALLBACKS</b></h4><pre>
       The callbacks are invoked with the corresponding object as first argument, as for a normal method. A heap
       is available for storing user-defined data.

       In the specific case of a program running in "pass_persist" mode with a forked backend, the callbacks are
       only executed in the child process (the forked backend).

       The currently implemented callbacks are:

       •   init

           This callback is called once, before the first <u>collect</u> invocation and before the main loop. It can be
           accessed and modified through the "backend_init" attribute.

       •   collect

           This  callback  is  called  every  "refresh"  seconds  so  the user can update the OID tree using the
           "add_oid_entry()" and "add_oid_tree()" methods.

   <b>Examples</b>
       For simple needs, only the <u>collect</u> callback needs to be defined:

           my $extsnmp = SNMP::Extension::PassPersist-&gt;new(
               backend_collect =&gt; \&amp;update_tree,
           );

           sub update_tree {
               my ($self) = @_;

               # fetch the number of running processes
               my $nb_proc = @{ Proc::ProcessTable-&gt;new-&gt;table };

               $self-&gt;add_oid_entry(".1.3.6.1.4.1.32272.10", gauge", $nb_proc);
           }

       A more advanced example is when there is a need to connect to a database, in which case both the <u>init</u> and
       <u>collect</u> callback need to be defined:

           my $extsnmp = SNMP::Extension::PassPersist-&gt;new(
               backend_init    =&gt; \&amp;connect_db,
               backend_collect =&gt; \&amp;update_tree,
           );

           sub connect_db {
               my ($self) = @_;
               my $heap = $self-&gt;heap;

               # connect to a database
               my $dbh = DBI-&gt;connect($dsn, $user, $password);
               $heap-&gt;{dbh} = $dbh;
           }

           sub update_tree {
               my ($self) = @_;
               my $heap = $self-&gt;heap;

               # fetch the number of records from a given table
               my $dbh = $heap-&gt;{dbh};
               my $sth = $dbh-&gt;prepare_cached("SELECT count(*) FROM whatever");
               $sth-&gt;execute;
               my ($count) = $sth-&gt;fetchrow_array;

               $self-&gt;add_oid_entry(".1.3.6.1.4.1.32272.20", "gauge", $count);
           }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       SNMP::Persist is another pass_persist backend for writing Net-SNMP extensions, but relies on threads.

       The documentation of Net-SNMP, especially the part  on  how  to  configure  a  "pass"  or  "pass_persist"
       extension:

       •   main site: &lt;<a href="http://www.net-snmp.org/">http://www.net-snmp.org/</a>&gt;

       •   configuring a pass or pass_persist extension: &lt;<a href="http://www.net-snmp.org/docs/man/snmpd.conf.html">http://www.net-snmp.org/docs/man/snmpd.conf.html</a>#lbBB&gt;

</pre><h4><b>BUGS</b></h4><pre>
       Please report any bugs or feature requests to "bug-snmp-extension-passpersist at rt.cpan.org", or through
       the  web  interface  at &lt;<a href="http://rt.cpan.org/Public/Dist/Display.html">http://rt.cpan.org/Public/Dist/Display.html</a>?Name=SNMP-Extension-PassPersist&gt;.  I
       will be notified, and then you'll automatically be notified of progress on your bug as I make changes.

</pre><h4><b>SUPPORT</b></h4><pre>
       You can find documentation for this module with the perldoc command.

           perldoc SNMP::Extension::PassPersist

       You can also look for information at:

       •   Search CPAN

           &lt;<a href="http://search.cpan.org/dist/SNMP-Extension-PassPersist">http://search.cpan.org/dist/SNMP-Extension-PassPersist</a>&gt;

       •   Meta CPAN

           &lt;https://metacpan.org/release/SNMP-Extension-PassPersist&gt;

       •   RT: CPAN's request tracker

           &lt;<a href="http://rt.cpan.org/Public/Dist/Display.html">http://rt.cpan.org/Public/Dist/Display.html</a>?Name=SNMP-Extension-PassPersist&gt;

       •   AnnoCPAN: Annotated CPAN documentation

           &lt;<a href="http://annocpan.org/dist/SNMP-Extension-PassPersist">http://annocpan.org/dist/SNMP-Extension-PassPersist</a>&gt;

       •   CPAN Ratings

           &lt;<a href="http://cpanratings.perl.org/d/SNMP-Extension-PassPersist">http://cpanratings.perl.org/d/SNMP-Extension-PassPersist</a>&gt;

</pre><h4><b>AUTHOR</b></h4><pre>
       Sebastien Aperghis-Tramoni, "&lt;sebastien at aperghis.net&gt;"

</pre><h4><b>COPYRIGHT</b> <b>&amp;</b> <b>LICENSE</b></h4><pre>
       Copyright 2008-2011 Sebastien Aperghis-Tramoni, all rights reserved.

       This program is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself.

perl v5.34.0                                       2022-06-17                  <u>SNMP::Extension::<a href="../man3pm/PassPersist.3pm.html">PassPersist</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>