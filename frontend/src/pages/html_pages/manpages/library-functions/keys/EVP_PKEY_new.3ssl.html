<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVP_PKEY, EVP_PKEY_new, EVP_PKEY_up_ref, EVP_PKEY_dup, EVP_PKEY_free, EVP_PKEY_new_raw_private_key_ex,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       EVP_PKEY, EVP_PKEY_new, EVP_PKEY_up_ref, EVP_PKEY_dup, EVP_PKEY_free, EVP_PKEY_new_raw_private_key_ex,
       EVP_PKEY_new_raw_private_key, EVP_PKEY_new_raw_public_key_ex, EVP_PKEY_new_raw_public_key,
       EVP_PKEY_new_CMAC_key, EVP_PKEY_new_mac_key, EVP_PKEY_get_raw_private_key, EVP_PKEY_get_raw_public_key -
       public/private key allocation and raw key handling functions

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/evp.h&gt;

        typedef evp_pkey_st EVP_PKEY;

        EVP_PKEY *EVP_PKEY_new(void);
        int EVP_PKEY_up_ref(EVP_PKEY *key);
        EVP_PKEY *EVP_PKEY_dup(EVP_PKEY *key);
        void EVP_PKEY_free(EVP_PKEY *key);

        EVP_PKEY *EVP_PKEY_new_raw_private_key_ex(OSSL_LIB_CTX *libctx,
                                                  const char *keytype,
                                                  const char *propq,
                                                  const unsigned char *key,
                                                  size_t keylen);
        EVP_PKEY *EVP_PKEY_new_raw_private_key(int type, ENGINE *e,
                                               const unsigned char *key, size_t keylen);
        EVP_PKEY *EVP_PKEY_new_raw_public_key_ex(OSSL_LIB_CTX *libctx,
                                                 const char *keytype,
                                                 const char *propq,
                                                 const unsigned char *key,
                                                 size_t keylen);
        EVP_PKEY *EVP_PKEY_new_raw_public_key(int type, ENGINE *e,
                                              const unsigned char *key, size_t keylen);
        EVP_PKEY *EVP_PKEY_new_mac_key(int type, ENGINE *e, const unsigned char *key,
                                       int keylen);

        int EVP_PKEY_get_raw_private_key(const EVP_PKEY *pkey, unsigned char *priv,
                                         size_t *len);
        int EVP_PKEY_get_raw_public_key(const EVP_PKEY *pkey, unsigned char *pub,
                                        size_t *len);

       The following function has been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        EVP_PKEY *EVP_PKEY_new_CMAC_key(ENGINE *e, const unsigned char *priv,
                                        size_t len, const EVP_CIPHER *cipher);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>EVP_PKEY</b> is a generic structure to hold diverse types of asymmetric keys (also known as "key pairs"), and
       can be used for diverse operations, like signing, verifying signatures, key derivation, etc.  The
       asymmetric keys themselves are often referred to as the "internal key", and are handled by backends, such
       as providers (through <b><a href="../man3/EVP_KEYMGMT.3.html">EVP_KEYMGMT</a></b>(3)) or <b>ENGINE</b>s.

       Conceptually, an <b>EVP_PKEY</b> internal key may hold a private key, a public key, or both (a keypair), and
       along with those, key parameters if the key type requires them.  The presence of these components
       determine what operations can be made; for example, signing normally requires the presence of a private
       key, and verifying normally requires the presence of a public key.

       <b>EVP_PKEY</b> has also been used for MAC algorithm that were conceived as producing signatures, although not
       being public key algorithms; "POLY1305", "SIPHASH", "HMAC", "CMAC".  This usage is considered legacy and
       is discouraged in favor of the <b><a href="../man3/EVP_MAC.3.html">EVP_MAC</a></b>(3) API.

       The <b>EVP_PKEY_new()</b> function allocates an empty <b>EVP_PKEY</b> structure which is used by OpenSSL to store
       public and private keys. The reference count is set to <b>1</b>.

       <b>EVP_PKEY_up_ref()</b> increments the reference count of <u>key</u>.

       <b>EVP_PKEY_dup()</b> duplicates the <u>key</u>. The <u>key</u> must not be ENGINE based or a raw key, otherwise the
       duplication will fail.

       <b>EVP_PKEY_free()</b> decrements the reference count of <u>key</u> and, if the reference count is zero, frees it up.
       If <u>key</u> is NULL, nothing is done.

       <b>EVP_PKEY_new_raw_private_key_ex()</b> allocates a new <b>EVP_PKEY</b>. Unless an engine should be used for the key
       type, a provider for the key is found using the library context <u>libctx</u> and the property query string
       <u>propq</u>. The <u>keytype</u> argument indicates what kind of key this is. The value should be a string for a public
       key algorithm that supports raw private keys, e.g., one of: "ED25519", "ED448", "X25519", "X448",
       "ML-DSA-44", "ML-DSA-65", "ML-DSA-87", "ML-KEM-512", "ML-KEM-768", or "ML-KEM-1024".  <u>key</u> points to the
       raw private key data for this <b>EVP_PKEY</b> which should be of length <u>keylen</u>. The length should be appropriate
       for the type of the key. The public key data will be automatically derived from the given private key
       data (if appropriate for the algorithm type).

       <b>EVP_PKEY_new_raw_private_key()</b> does the same as <b>EVP_PKEY_new_raw_private_key_ex()</b> except that the default
       library context and default property query are used instead. If <u>e</u> is non-NULL then the new <b>EVP_PKEY</b>
       structure is associated with the engine <u>e</u>. The <u>type</u> argument indicates what kind of key this is. The
       value should be a NID for a public key algorithm that supports raw private keys, i.e. one of
       <b>EVP_PKEY_X25519</b>, <b>EVP_PKEY_ED25519</b>, <b>EVP_PKEY_X448</b> or <b>EVP_PKEY_ED448</b>.

       <b>EVP_PKEY_new_raw_private_key_ex()</b> and <b>EVP_PKEY_new_raw_private_key()</b> may also be used with most MACs
       implemented as public key algorithms, so key types such as "HMAC", "POLY1305", "SIPHASH", or their NID
       form <b>EVP_PKEY_POLY1305</b>, <b>EVP_PKEY_SIPHASH</b>, <b>EVP_PKEY_HMAC</b> are also accepted.  This usage is, as mentioned
       above, discouraged in favor of the <b><a href="../man3/EVP_MAC.3.html">EVP_MAC</a></b>(3) API.

       <b>EVP_PKEY_new_raw_public_key_ex()</b> works in the same way as <b>EVP_PKEY_new_raw_private_key_ex()</b> except that
       <u>key</u> points to the raw public key data. The <b>EVP_PKEY</b> structure will be initialised without any private key
       information. Algorithm types that support raw public keys are <b>ED25519</b>, <b>ED448</b>, <b>X25519</b>, <b>X448</b>, "ML-DSA-44",
       "ML-DSA-65", "ML-DSA-87", <b>ML-KEM-512</b>, <b>ML-KEM-768</b>, and <b>ML-KEM-1024</b>.

       <b>EVP_PKEY_new_raw_public_key()</b> works in the same way as <b>EVP_PKEY_new_raw_private_key_ex()</b> except that <u>key</u>
       points to the raw public key data.  The <b>EVP_PKEY</b> structure will be initialised without any private key
       information.

       <b>EVP_PKEY_new_mac_key()</b> works in the same way as <b>EVP_PKEY_new_raw_private_key()</b>.  New applications should
       use <b>EVP_PKEY_new_raw_private_key()</b> instead.

       <b>EVP_PKEY_get_raw_private_key()</b> fills the buffer provided by <u>priv</u> with raw private key data. The size of
       the <u>priv</u> buffer should be in <u>*len</u> on entry to the function, and on exit <u>*len</u> is updated with the number
       of bytes actually written. If the buffer <u>priv</u> is NULL then <u>*len</u> is populated with the number of bytes
       required to hold the key. The calling application is responsible for ensuring that the buffer is large
       enough to receive the private key data. This function only works for algorithms that support raw private
       keys.  These include: <b>ED25519</b>, <b>ED448</b>, <b>X25519</b>, <b>X448</b>, <b>HMAC</b>, <b>POLY1305</b>, and <b>SIPHASH</b>.
       <b>EVP_PKEY_get_raw_private_key()</b> also works with "ML-DSA-44", "ML-DSA-65", "ML-DSA-87", <b>ML-KEM-512</b>,
       <b>ML-KEM-768</b> and <b>ML-KEM-1024</b> keys, which don't have legacy numeric <u>NID</u> assigments, but their raw form is
       nevertheless available.

       <b>EVP_PKEY_get_raw_public_key()</b> fills the buffer provided by <u>pub</u> with raw public key data. The size of the
       <u>pub</u> buffer should be in <u>*len</u> on entry to the function, and on exit <u>*len</u> is updated with the number of
       bytes actually written. If the buffer <u>pub</u> is NULL then <u>*len</u> is populated with the number of bytes
       required to hold the key. The calling application is responsible for ensuring that the buffer is large
       enough to receive the public key data. This function only works for algorithms that support raw public
       keys.  These include: <b>ED25519</b>, <b>ED448</b>, <b>X25519</b>, and <b>X448</b> <b>EVP_PKEY_get_raw_public_key()</b> also works with
       "ML-DSA-44", "ML-DSA-65", "ML-DSA-87", <b>ML-KEM-512</b>, <b>ML-KEM-768</b> and <b>ML-KEM-1024</b> keys, which don't have
       legacy numeric <u>NID</u> assigments, but their raw form is nevertheless available.

       <b>EVP_PKEY_new_CMAC_key()</b> works in the same way as <b>EVP_PKEY_new_raw_private_key()</b> except it is only for the
       <b>EVP_PKEY_CMAC</b> algorithm type. In addition to the raw private key data, it also takes a cipher algorithm
       to be used during creation of a CMAC in the <b>cipher</b> argument. The cipher should be a standard encryption-
       only cipher. For example AEAD and XTS ciphers should not be used.

       Applications should use the <b><a href="../man3/EVP_MAC.3.html">EVP_MAC</a></b>(3) API instead and set the <b>OSSL_MAC_PARAM_CIPHER</b> parameter on the
       <b>EVP_MAC_CTX</b> object with the name of the cipher being used.

</pre><h4><b>NOTES</b></h4><pre>
       The <b>EVP_PKEY</b> structure is used by various OpenSSL functions which require a general private key without
       reference to any particular algorithm.

       The structure returned by <b>EVP_PKEY_new()</b> is empty. To add a private or public key to this empty structure
       use the appropriate functions described in <b><a href="../man3/EVP_PKEY_set1_RSA.3.html">EVP_PKEY_set1_RSA</a></b>(3), <b><a href="../man3/EVP_PKEY_set1_DSA.3.html">EVP_PKEY_set1_DSA</a></b>(3),
       <b><a href="../man3/EVP_PKEY_set1_DH.3.html">EVP_PKEY_set1_DH</a></b>(3) or <b><a href="../man3/EVP_PKEY_set1_EC_KEY.3.html">EVP_PKEY_set1_EC_KEY</a></b>(3).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>EVP_PKEY_new()</b>, <b>EVP_PKEY_new_raw_private_key()</b>, <b>EVP_PKEY_new_raw_public_key()</b>, <b>EVP_PKEY_new_CMAC_key()</b>
       and <b>EVP_PKEY_new_mac_key()</b> return either the newly allocated <b>EVP_PKEY</b> structure or NULL if an error
       occurred.

       <b>EVP_PKEY_dup()</b> returns the key duplicate or NULL if an error occurred.

       <b>EVP_PKEY_up_ref()</b>, <b>EVP_PKEY_get_raw_private_key()</b> and <b>EVP_PKEY_get_raw_public_key()</b> return 1 for success
       and 0 for failure.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/EVP_PKEY_set1_RSA.3.html">EVP_PKEY_set1_RSA</a></b>(3), <b><a href="../man3/EVP_PKEY_set1_DSA.3.html">EVP_PKEY_set1_DSA</a></b>(3), <b><a href="../man3/EVP_PKEY_set1_DH.3.html">EVP_PKEY_set1_DH</a></b>(3), <b><a href="../man3/EVP_PKEY_set1_EC_KEY.3.html">EVP_PKEY_set1_EC_KEY</a></b>(3),
       <b><a href="../man7/EVP_PKEY-ED25519.7.html">EVP_PKEY-ED25519</a></b>(7), <b><a href="../man7/EVP_PKEY-ED448.7.html">EVP_PKEY-ED448</a></b>(7).  <b><a href="../man7/EVP_PKEY-HMAC.7.html">EVP_PKEY-HMAC</a></b>(7), <b><a href="../man7/EVP_PKEY-Poly1305.7.html">EVP_PKEY-Poly1305</a></b>(7), <b><a href="../man7/EVP_PKEY-Siphash.7.html">EVP_PKEY-Siphash</a></b>(7),
       <b><a href="../man7/EVP_PKEY-X25519.7.html">EVP_PKEY-X25519</a></b>(7), <b><a href="../man7/EVP_PKEY-X448.7.html">EVP_PKEY-X448</a></b>(7), <b><a href="../man7/EVP_PKEY-ML-DSA.7.html">EVP_PKEY-ML-DSA</a></b>(7), <b><a href="../man7/EVP_PKEY-ML-KEM.7.html">EVP_PKEY-ML-KEM</a></b>(7).

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>EVP_PKEY_new()</b> and <b>EVP_PKEY_free()</b> functions exist in all versions of OpenSSL.

       The <b>EVP_PKEY_up_ref()</b> function was added in OpenSSL 1.1.0.

       The <b>EVP_PKEY_new_raw_private_key()</b>, <b>EVP_PKEY_new_raw_public_key()</b>, <b>EVP_PKEY_new_CMAC_key()</b>,
       <b>EVP_PKEY_new_raw_private_key()</b> and <b>EVP_PKEY_get_raw_public_key()</b> functions were added in OpenSSL 1.1.1.

       The <b>EVP_PKEY_dup()</b>, <b>EVP_PKEY_new_raw_private_key_ex()</b>, and <b>EVP_PKEY_new_raw_public_key_ex()</b> functions
       were added in OpenSSL 3.0.

       The <b>EVP_PKEY_new_CMAC_key()</b> was deprecated in OpenSSL 3.0.

       The documentation of <b>EVP_PKEY</b> was amended in OpenSSL 3.0 to allow there to be the private part of the
       keypair without the public part, where this was previously implied to be disallowed.

       Support for <b>ML-DSA</b> and <b>ML-KEM</b> was added in OpenSSL 3.5.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2002-2025 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                 <u><a href="../man3SSL/EVP_PKEY_NEW.3SSL.html">EVP_PKEY_NEW</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>