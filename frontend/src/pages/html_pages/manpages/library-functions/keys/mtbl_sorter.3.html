<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mtbl_sorter - sort a sequence of unordered key-value pairs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmtbl-dev">libmtbl-dev_1.6.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mtbl_sorter - sort a sequence of unordered key-value pairs

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;mtbl.h&gt;</b>

       Sorter objects:

       <b>struct</b> <b>mtbl_sorter</b> <b>*</b>
       <b>mtbl_sorter_init(const</b> <b>struct</b> <b>mtbl_sorter_options</b> <b>*</b><u>sopt</u><b>);</b>

       <b>void</b>
       <b>mtbl_sorter_destroy(struct</b> <b>mtbl_sorter</b> <b>**</b><u>s</u><b>);</b>

       <b>mtbl_res</b>
       <b>mtbl_sorter_add(struct</b> <b>mtbl_sorter</b> <b>*</b><u>s</u><b>,</b>
               <b>const</b> <b>uint8_t</b> <b>*</b><u>key</u><b>,</b> <b>size_t</b> <u>len_key</u><b>,</b>
               <b>const</b> <b>uint8_t</b> <b>*</b><u>val</u><b>,</b> <b>size_t</b> <u>len_val</u><b>);</b>

       <b>mtbl_res</b>
       <b>mtbl_sorter_write(struct</b> <b>mtbl_sorter</b> <b>*</b><u>s</u><b>,</b> <b>struct</b> <b>mtbl_writer</b> <b>*</b><u>w</u><b>);</b>

       <b>struct</b> <b>mtbl_iter</b> <b>*</b>
       <b>mtbl_sorter_iter(struct</b> <b>mtbl_sorter</b> <b>*</b><u>s</u><b>);</b>

       Sorter options:

       <b>struct</b> <b>mtbl_sorter_options</b> <b>*</b>
       <b>mtbl_sorter_options_init(void);</b>

       <b>void</b>
       <b>mtbl_sorter_options_destroy(struct</b> <b>mtbl_sorter_options</b> <b>**</b><u>sopt</u><b>);</b>

       <b>void</b>
       <b>mtbl_sorter_options_set_merge_func(</b>
               <b>struct</b> <b>mtbl_sorter_options</b> <b>*</b><u>sopt</u><b>,</b>
               <b>mtbl_merge_func</b> <u>fp</u><b>,</b>
               <b>void</b> <b>*</b><u>clos</u><b>);</b>

       <b>void</b>
       <b>mtbl_sorter_options_set_temp_dir(</b>
               <b>struct</b> <b>mtbl_sorter_options</b> <b>*</b><u>sopt</u><b>,</b>
               <b>const</b> <b>char</b> <b>*</b><u>temp_dir</u><b>);</b>

       <b>void</b>
       <b>mtbl_sorter_options_set_max_memory(</b>
               <b>struct</b> <b>mtbl_sorter_options</b> <b>*</b><u>sopt</u><b>,</b>
               <b>size_t</b> <u>max_memory</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>mtbl_sorter</b> interface accepts a sequence of key-value pairs with keys in arbitrary order and provides
       these entries in sorted order. The sorted entries may be consumed via the <b>mtbl_iter</b> interface using the
       <b>mtbl_sorter_iter</b>() function, or they may be dumped to an <b>mtbl_writer</b> object using the <b>mtbl_sorter_write</b>()
       function. The <b>mtbl_sorter</b> implementation buffers entries in memory up to a configurable limit before
       sorting them and writing them to disk in chunks. When the caller has finishing adding entries and
       requests the sorted output, entries from these sorted chunks are then read back and merged. (Thus,
       <b><a href="../man3/mtbl_sorter.3.html">mtbl_sorter</a></b>(3) is an "external sorting" implementation.)

       Because the MTBL format does not allow duplicate keys, the caller must provide a function which will
       accept a key and two conflicting values for that key and return a replacement value. This function may be
       called multiple times for the same key if the same key is inserted more than twice. See <b><a href="../man3/mtbl_merger.3.html">mtbl_merger</a></b>(3)
       for further details about the merge function.

       <b>mtbl_sorter</b> objects are created with the <b>mtbl_sorter_init</b>() function, which requires a non-NULL <u>sopt</u>
       argument which has been configured with a merge function <u>fp</u>.

       <b>mtbl_sorter_add</b>() copies key-value pairs from the caller into the <b>mtbl_sorter</b> object. Keys are specified
       as a pointer to a buffer, <u>key</u>, and the length of that buffer, <u>len_key</u>. Values are specified as a pointer
       to a buffer, <u>val</u>, and the length of that buffer, <u>len_val</u>.

       Once the caller has finished adding entries to the <b>mtbl_sorter</b> object, either <b>mtbl_sorter_write</b>() or
       <b>mtbl_sorter_iter</b>() should be called in order to consume the sorted output. It is a runtime error to call
       <b>mtbl_sorter_add</b>() on an <b>mtbl_sorter</b> object after iteration has begun, and once the sorted output has been
       consumed, it is also a runtime error to call any other function but <b>mtbl_sorter_destroy</b>() on the depleted
       <b>mtbl_sorter</b> object.

   <b>Sorter</b> <b>options</b>
       <b>temp_dir</b>

           Specifies the temporary directory to use. Defaults to /var/tmp.

       <b>max_memory</b>

           Specifies the maximum amount of memory to use for in-memory sorting, in bytes. Defaults to 1
           Gigabyte. This specifies a limit on the total number of bytes allocated for key-value entries and
           does not include any allocation overhead.

       <b>merge_func</b>

           See <b><a href="../man3/mtbl_merger.3.html">mtbl_merger</a></b>(3). An <b>mtbl_merger</b> object is used internally for the external sort.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       If the merge function callback is unable to provide a merged value (that is, it fails to return a
       non-NULL value in its <u>merged_val</u> argument), the sort process will be aborted, and <b>mtbl_sorter_write</b>() or
       <b>mtbl_iter_next</b>() will return <b>mtbl_res_failure</b>.

       <b>mtbl_sorter_write</b>() returns <b>mtbl_res_success</b> if the sorted output was successfully written, and
       <b>mtbl_res_failure</b> otherwise.

                                                   01/31/2014                                     <u><a href="../man3/MTBL_SORTER.3.html">MTBL_SORTER</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>