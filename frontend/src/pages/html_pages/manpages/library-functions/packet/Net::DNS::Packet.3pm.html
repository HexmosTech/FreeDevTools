<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net::DNS::Packet - DNS protocol packet</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libnet-dns-perl">libnet-dns-perl_1.50-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Net::DNS::Packet - DNS protocol packet

</pre><h4><b>SYNOPSIS</b></h4><pre>
               use Net::DNS::Packet;

               $query = Net::DNS::Packet-&gt;new( 'example.com', 'MX', 'IN' );

               $reply = $resolver-&gt;send( $query );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A Net::DNS::Packet object represents a DNS protocol packet.

</pre><h4><b>METHODS</b></h4><pre>
   <b>new</b>
               $packet = Net::DNS::Packet-&gt;new( 'example.com' );
               $packet = Net::DNS::Packet-&gt;new( 'example.com', 'MX', 'IN' );

               $packet = Net::DNS::Packet-&gt;new();

       If passed a domain, type, and class, <b>new()</b> creates a Net::DNS::Packet object which is suitable for making
       a DNS query for the specified information.  The type and class may be omitted; they default to A and IN.

       If called with an empty argument list, <b>new()</b> creates an empty packet.

   <b>decode</b>
               $packet = Net::DNS::Packet-&gt;decode( \$data );
               $packet = Net::DNS::Packet-&gt;decode( \$data, 1 );        # debug
               $packet = Net::DNS::Packet-&gt;new( \$data ... );

       A new packet object is created by decoding the DNS packet data contained in the scalar referenced by the
       first argument.  The optional second boolean argument enables debugging output.

       Returns undef if unable to create a packet object.

       Decoding errors, including data corruption and truncation, are collected in the $@ ($EVAL_ERROR)
       variable.

               ( $packet, $length ) = Net::DNS::Packet-&gt;decode( \$data );

       If called in array context, returns a packet object and the number of octets successfully decoded.

       Note that the number of RRs in each section of the packet may differ from the corresponding header value
       if the data has been truncated or corrupted during transmission.

   <b>encode</b>
               $data = $packet-&gt;encode;
               $data = $packet-&gt;encode( $size );

       Returns the packet data in binary format, suitable for sending as a query or update request to a
       nameserver.

       Truncation may be specified using a non-zero optional size argument.

   <b>header</b>
               $header = $packet-&gt;header;

       Constructor method which returns a Net::DNS::Header object which represents the header section of the
       packet.

   <b>edns</b>
               $version = $packet-&gt;edns-&gt;version;
               $UDPsize = $packet-&gt;edns-&gt;size;

       Auxiliary function which provides access to the EDNS protocol extension OPT RR.

   <b>reply</b>
               $reply = $query-&gt;reply( $UDPmax );

       Constructor method which returns a new reply packet.

       The optional UDPsize argument is the maximum UDP packet size which can be reassembled by the local
       network stack, and is advertised in response to an EDNS query.

   <b>question,</b> <b>zone</b>
               @question = $packet-&gt;question;

       Returns a list of Net::DNS::Question objects representing the question section of the packet.

       In dynamic update packets, this section is known as <b>zone()</b> and specifies the DNS zone to be updated.

   <b>answer,</b> <b>pre,</b> <b>prerequisite</b>
               @answer = $packet-&gt;answer;

       Returns a list of Net::DNS::RR objects representing the answer section of the packet.

       In dynamic update packets, this section is known as <b>pre()</b> or <b>prerequisite()</b> and specifies the RRs or
       RRsets which must or must not preexist.

   <b>authority,</b> <b>update</b>
               @authority = $packet-&gt;authority;

       Returns a list of Net::DNS::RR objects representing the authority section of the packet.

       In dynamic update packets, this section is known as <b>update()</b> and specifies the RRs or RRsets to be added
       or deleted.

   <b>additional</b>
               @additional = $packet-&gt;additional;

       Returns a list of Net::DNS::RR objects representing the additional section of the packet.

   <b>print</b>
               $packet-&gt;print;

       Prints the entire packet to the currently selected output filehandle using the master file format
       mandated by RFC1035.

   <b>string</b>
               print $packet-&gt;string;

       Returns a string representation of the packet.

   <b>from</b>
               print "packet received from ", $packet-&gt;from, "\n";

       Returns the IP address from which this packet was received.  This method will return undef for user-
       created packets.

   <b>size</b>
               print "packet size: ", $packet-&gt;size, " octets\n";

       Returns the size of the packet in octets as it was received from a nameserver.  This method will return
       undef for user-created packets (use length($packet-&gt;data) instead).

   <b>push</b>
               $ancount = $packet-&gt;push( prereq =&gt; $rr );
               $nscount = $packet-&gt;push( update =&gt; $rr );
               $arcount = $packet-&gt;push( additional =&gt; $rr );

               $nscount = $packet-&gt;push( update =&gt; $rr1, $rr2, $rr3 );
               $nscount = $packet-&gt;push( update =&gt; @rr );

       Adds RRs to the specified section of the packet.

       Returns the number of resource records in the specified section.

       Section names may be abbreviated to the first three characters.

   <b>unique_push</b>
               $ancount = $packet-&gt;unique_push( prereq =&gt; $rr );
               $nscount = $packet-&gt;unique_push( update =&gt; $rr );
               $arcount = $packet-&gt;unique_push( additional =&gt; $rr );

               $nscount = $packet-&gt;unique_push( update =&gt; $rr1, $rr2, $rr3 );
               $nscount = $packet-&gt;unique_push( update =&gt; @rr );

       Adds RRs to the specified section of the packet provided that the RRs are not already present in the same
       section.

       Returns the number of resource records in the specified section.

       Section names may be abbreviated to the first three characters.

   <b>pop</b>
               my $rr = $packet-&gt;pop( 'pre' );
               my $rr = $packet-&gt;pop( 'update' );
               my $rr = $packet-&gt;pop( 'additional' );

       Removes a single RR from the specified section of the packet.

   <b>sign_tsig</b>
               $query = Net::DNS::Packet-&gt;new( 'www.example.com', 'A' );

               $query-&gt;sign_tsig(
                       $keyfile,
                       fudge =&gt; 60
                       );

               $reply = $res-&gt;send( $query );

               $reply-&gt;verify( $query ) || die $reply-&gt;verifyerr;

       Attaches a TSIG resource record object, which will be used to sign the packet (see RFC 2845).

       The TSIG record can be customised by optional additional arguments to <b>sign_tsig()</b> or by calling the
       appropriate Net::DNS::RR::TSIG methods.

       If you wish to create a TSIG record using a non-standard algorithm, you will have to create it yourself.
       In all cases, the TSIG name must uniquely identify the key shared between the parties, and the algorithm
       name must identify the signing function to be used with the specified key.

               $tsig = Net::DNS::RR-&gt;new(
                       name            =&gt; 'tsig.example',
                       type            =&gt; 'TSIG',
                       algorithm       =&gt; 'custom-algorithm',
                       key             =&gt; '&lt;base64 key text&gt;',
                       sig_function    =&gt; sub {
                                                 my ($key, $data) = @_;
                                                       ...
                                               }
                       );

               $query-&gt;sign_tsig( $tsig );

       The response to an inbound request is signed by presenting the request in place of the key parameter.

               $response = $request-&gt;reply;
               $response-&gt;sign_tsig( $request, @options );

       Multi-packet transactions are signed by chaining the <b>sign_tsig()</b> calls together as follows:

               $opaque = $packet1-&gt;sign_tsig( 'Kexample.+165+13281.private' );
               $opaque = $packet2-&gt;sign_tsig( $opaque );
               $opaque = $packet3-&gt;sign_tsig( $opaque );

       The opaque intermediate object references returned during multi-packet signing are not intended to be
       accessed by the end-user application.  Any such access is expressly forbidden.

       Note that a TSIG record is added to every packet; this implementation does not support the suppressed
       signature scheme described in RFC2845.

   <b>verify</b> <b>and</b> <b>verifyerr</b>
               $reply-&gt;verify($query) || die $reply-&gt;verifyerr;

       Verify TSIG signature of a reply to the corresponding query.

               $opaque  = $packet1-&gt;verify( $query ) || die $packet1-&gt;verifyerr;
               $opaque  = $packet2-&gt;verify( $opaque );
               $verifed = $packet3-&gt;verify( $opaque ) || die $packet3-&gt;verifyerr;

       Verify TSIG signature of a multi-packet reply to the corresponding query.

       The opaque intermediate object references returned by <b>verify()</b> at each stage will be undefined (Boolean
       false) if verification fails.  Testing at every stage is not necessary, which produces a BADSIG error on
       the final packet in the absence of more specific information.  Access to the objects themselves, if they
       exist, is expressly forbidden.

   <b>sign_sig0</b>
       SIG0 support is provided through the Net::DNS::RR::SIG class.  The requisite cryptographic components are
       not integrated into Net::DNS but reside in the Net::DNS::SEC distribution available from CPAN.

               $update = Net::DNS::Update-&gt;new('example.com');
               $update-&gt;push( update =&gt; rr_add('foo.example.com A 10.1.2.3'));
               $update-&gt;sign_sig0('Kexample.com+003+25317.private');

       Execution will be terminated if Net::DNS::SEC is not available.

   <b>verify</b> <b>SIG0</b>
               $packet-&gt;verify( $keyrr )               || die $packet-&gt;verifyerr;
               $packet-&gt;verify( [$keyrr, ...] )        || die $packet-&gt;verifyerr;

       Verify SIG0 packet signature against one or more specified KEY RRs.

   <b>sigrr</b>
               $sigrr = $packet-&gt;sigrr() || die 'unsigned packet';

       The sigrr method returns the signature RR from a signed packet or undefined if the signature is absent.

   <b>truncate</b>
       The truncate method takes a maximum length as argument and then tries to truncate the packet and set the
       TC bit according to the rules of RFC2181 Section 9.

       The smallest length limit that is honoured is 512 octets.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c)1997-2000 Michael Fuhr.

       Portions Copyright (c)2002-2004 Chris Reinhardt.

       Portions Copyright (c)2002-2009 Olaf Kolkman

       Portions Copyright (c)2007-2019 Dick Franks

       All rights reserved.

</pre><h4><b>LICENSE</b></h4><pre>
       Permission to use, copy, modify, and distribute this software and its documentation for any purpose and
       without fee is hereby granted, provided that the original copyright notices appear in all copies and that
       both copyright notice and this permission notice appear in supporting documentation, and that the name of
       the author not be used in advertising or publicity pertaining to distribution of the software without
       specific prior written permission.

       THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT
       LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO
       EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
       IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR
       THE USE OR OTHER DEALINGS IN THE SOFTWARE.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       perl Net::DNS Net::DNS::Header Net::DNS::Question Net::DNS::RR Net::DNS::RR::TSIG RFC1035(4.1)
       &lt;https://iana.org/go/rfc1035#section-4.1&gt; RFC2136 &lt;https://iana.org/go/rfc2136#section-2&gt; RFC8490
       &lt;https://iana.org/go/rfc8490&gt; RFC8945 &lt;https://iana.org/go/rfc8945&gt;

perl v5.40.1                                       2025-03-05                              <u>Net::DNS::<a href="../man3pm/Packet.3pm.html">Packet</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>