<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XML::LibXML::XPathContext - XPath Evaluation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libxml-libxml-perl">libxml-libxml-perl_2.0207+dfsg+really+2.0207-0ubuntu6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       XML::LibXML::XPathContext - XPath Evaluation

</pre><h4><b>SYNOPSIS</b></h4><pre>
         my $xpc = XML::LibXML::XPathContext-&gt;new();
         my $xpc = XML::LibXML::XPathContext-&gt;new($node);
         $xpc-&gt;registerNs($prefix, $namespace_uri)
         $xpc-&gt;unregisterNs($prefix)
         $uri = $xpc-&gt;lookupNs($prefix)
         $xpc-&gt;registerVarLookupFunc($callback, $data)
         $data = $xpc-&gt;getVarLookupData();
         $callback = $xpc-&gt;getVarLookupFunc();
         $xpc-&gt;unregisterVarLookupFunc($name);
         $xpc-&gt;registerFunctionNS($name, $uri, $callback)
         $xpc-&gt;unregisterFunctionNS($name, $uri)
         $xpc-&gt;registerFunction($name, $callback)
         $xpc-&gt;unregisterFunction($name)
         @nodes = $xpc-&gt;findnodes($xpath)
         @nodes = $xpc-&gt;findnodes($xpath, $context_node )
         $nodelist = $xpc-&gt;findnodes($xpath, $context_node )
         $object = $xpc-&gt;find($xpath )
         $object = $xpc-&gt;find($xpath, $context_node )
         $value = $xpc-&gt;findvalue($xpath )
         $value = $xpc-&gt;findvalue($xpath, $context_node )
         $bool = $xpc-&gt;exists( $xpath_expression, $context_node );
         $xpc-&gt;setContextNode($node)
         my $node = $xpc-&gt;getContextNode;
         $xpc-&gt;setContextPosition($position)
         my $position = $xpc-&gt;getContextPosition;
         $xpc-&gt;setContextSize($size)
         my $size = $xpc-&gt;getContextSize;
         $xpc-&gt;setContextNode($node)

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The XML::LibXML::XPathContext class provides an almost complete interface to libxml2's XPath
       implementation. With XML::LibXML::XPathContext, it is possible to evaluate XPath expressions in the
       context of arbitrary node, context size, and context position, with a user-defined namespace-prefix
       mapping, custom XPath functions written in Perl, and even a custom XPath variable resolver.

</pre><h4><b>EXAMPLES</b></h4><pre>
   <b>Namespaces</b>
       This example demonstrates registerNs() method. It finds all paragraph nodes in an XHTML document.

         my $xc = XML::LibXML::XPathContext-&gt;new($xhtml_doc);
         $xc-&gt;registerNs('xhtml', '<a href="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</a>');
         my @nodes = $xc-&gt;findnodes('//xhtml:p');

   <b>Custom</b> <b>XPath</b> <b>functions</b>
       This example demonstrates registerFunction() method by defining a function filtering nodes based on a
       Perl regular expression:

         sub grep_nodes {
           my ($nodelist,$regexp) =  @_;
           my $result = XML::LibXML::NodeList-&gt;new;
           for my $node ($nodelist-&gt;get_nodelist()) {
             $result-&gt;push($node) if $node-&gt;textContent =~ $regexp;
           }
           return $result;
         };

         my $xc = XML::LibXML::XPathContext-&gt;new($node);
         $xc-&gt;registerFunction('grep_nodes', \&amp;grep_nodes);
         my @nodes = $xc-&gt;findnodes('//section[grep_nodes(para,"\bsearch(ing|es)?\b")]');

   <b>Variables</b>
       This example demonstrates registerVarLookup() method. We use XPath variables to recycle results of
       previous evaluations:

         sub var_lookup {
           my ($varname,$ns,$data)=@_;
           return $data-&gt;{$varname};
         }

         my $areas = XML::LibXML-&gt;new-&gt;parse_file('areas.xml');
         my $empl = XML::LibXML-&gt;new-&gt;parse_file('employees.xml');

         my $xc = XML::LibXML::XPathContext-&gt;new($empl);

         my %variables = (
           A =&gt; $xc-&gt;find('/employees/employee[@salary&gt;10000]'),
           B =&gt; $areas-&gt;find('/areas/area[district='Brooklyn']/street'),
         );

         # get names of employees from $A working in an area listed in $B
         $xc-&gt;registerVarLookupFunc(\&amp;var_lookup, \%variables);
         my @nodes = $xc-&gt;findnodes('$A[work_area/street = $B]/name');

</pre><h4><b>METHODS</b></h4><pre>
       new
             my $xpc = XML::LibXML::XPathContext-&gt;new();

           Creates a new XML::LibXML::XPathContext object without a context node.

             my $xpc = XML::LibXML::XPathContext-&gt;new($node);

           Creates a new XML::LibXML::XPathContext object with the context node set to $node.

       registerNs
             $xpc-&gt;registerNs($prefix, $namespace_uri)

           Registers namespace $prefix to $namespace_uri.

       unregisterNs
             $xpc-&gt;unregisterNs($prefix)

           Unregisters namespace $prefix.

       lookupNs
             $uri = $xpc-&gt;lookupNs($prefix)

           Returns  namespace  URI  registered  with  $prefix. If $prefix is not registered to any namespace URI
           returns "undef".

       registerVarLookupFunc
             $xpc-&gt;registerVarLookupFunc($callback, $data)

           Registers variable lookup function $callback. The registered function is executed by the XPath engine
           each time an XPath variable is evaluated.  It  takes  three  arguments:  $data,  variable  name,  and
           variable  ns-URI and must return one value: a number or string or any "XML::LibXML::" object that can
           be a result of findnodes:  Boolean,  Literal,  Number,  Node  (e.g.   Document,  Element,  etc.),  or
           NodeList.  For  convenience,  simple (non-blessed) array references containing only XML::LibXML::Node
           objects can be used instead of an XML::LibXML::NodeList.

       getVarLookupData
             $data = $xpc-&gt;getVarLookupData();

           Returns the data that have been associated with a variable lookup function during a previous call  to
           "registerVarLookupFunc".

       getVarLookupFunc
             $callback = $xpc-&gt;getVarLookupFunc();

           Returns the variable lookup function previously registered with "registerVarLookupFunc".

       unregisterVarLookupFunc
             $xpc-&gt;unregisterVarLookupFunc($name);

           Unregisters variable lookup function and the associated lookup data.

       registerFunctionNS
             $xpc-&gt;registerFunctionNS($name, $uri, $callback)

           Registers  an  extension  function  $name  in $uri namespace. $callback must be a CODE reference. The
           arguments of the callback function are either simple scalars or "XML::LibXML::*" objects depending on
           the XPath argument types. The function is responsible for checking the  argument  number  and  types.
           Result  of  the callback code must be a single value of the following types: a simple scalar (number,
           string) or an arbitrary "XML::LibXML::*" object that can be a result of findnodes: Boolean,  Literal,
           Number,  Node  (e.g.   Document,  Element,  etc.), or NodeList. For convenience, simple (non-blessed)
           array  references  containing  only  XML::LibXML::Node   objects   can   be   used   instead   of   a
           XML::LibXML::NodeList.

       unregisterFunctionNS
             $xpc-&gt;unregisterFunctionNS($name, $uri)

           Unregisters  extension  function  $name  in $uri namespace. Has the same effect as passing "undef" as
           $callback to registerFunctionNS.

       registerFunction
             $xpc-&gt;registerFunction($name, $callback)

           Same as "registerFunctionNS" but without a namespace.

       unregisterFunction
             $xpc-&gt;unregisterFunction($name)

           Same as "unregisterFunctionNS" but without a namespace.

       findnodes
             @nodes = $xpc-&gt;findnodes($xpath)

             @nodes = $xpc-&gt;findnodes($xpath, $context_node )

             $nodelist = $xpc-&gt;findnodes($xpath, $context_node )

           Performs the xpath statement on the current node and returns  the  result  as  an  array.  In  scalar
           context,  returns  an  XML::LibXML::NodeList  object.  Optionally,  a  node may be passed as a second
           argument to set the context node for the query.

           The xpath expression can be passed either as a string, or as a XML::LibXML::XPathExpression object.

       find
             $object = $xpc-&gt;find($xpath )

             $object = $xpc-&gt;find($xpath, $context_node )

           Performs the xpath expression using the current node as the context of the  expression,  and  returns
           the result depending on what type of result the XPath expression had. For example, the XPath "1 * 3 +
                   52" results in an XML::LibXML::Number object being returned. Other expressions might return a
           XML::LibXML::Boolean  object, or a XML::LibXML::Literal object (a string). Each of those objects uses
           Perl's overload feature to ``do the right thing'' in different contexts. Optionally, a  node  may  be
           passed as a second argument to set the context node for the query.

           The xpath expression can be passed either as a string, or as a XML::LibXML::XPathExpression object.

       findvalue
             $value = $xpc-&gt;findvalue($xpath )

             $value = $xpc-&gt;findvalue($xpath, $context_node )

           Is exactly equivalent to:

             $xpc-&gt;find( $xpath, $context_node )-&gt;to_literal;

           That  is,  it  returns  the  literal  value of the results. This enables you to ensure that you get a
           string back from your search, allowing certain shortcuts.  This could be used as  the  equivalent  of
           &lt;xsl:value-of  select=``some_xpath''/&gt;.   Optionally,  a node may be passed in the second argument to
           set the context node for the query.

           The xpath expression can be passed either as a string, or as a XML::LibXML::XPathExpression object.

       exists
             $bool = $xpc-&gt;exists( $xpath_expression, $context_node );

           This method behaves like <u>findnodes</u>, except that it only returns a boolean value (1 if the  expression
           matches  a node, 0 otherwise) and may be faster than <u>findnodes</u>, because the XPath evaluation may stop
           early on the first match (this is true for libxml2 &gt;= 2.6.27).

           For XPath expressions that do not return node-set, the method returns true if the returned value is a
           non-zero number or a non-empty string.

       setContextNode
             $xpc-&gt;setContextNode($node)

           Set the current context node.

       getContextNode
             my $node = $xpc-&gt;getContextNode;

           Get the current context node.

       setContextPosition
             $xpc-&gt;setContextPosition($position)

           Set the current context position. By default,  this  value  is  -1  (and  evaluating  XPath  function
           position()  in  the initial context raises an XPath error), but can be set to any value up to context
           size. This usually only serves to cheat the XPath engine to return  given  position  when  position()
           XPath function is called. Setting this value to -1 restores the default behavior.

       getContextPosition
             my $position = $xpc-&gt;getContextPosition;

           Get the current context position.

       setContextSize
             $xpc-&gt;setContextSize($size)

           Set  the  current context size. By default, this value is -1 (and evaluating XPath function last() in
           the initial context raises an XPath error), but can be set to any non-negative  value.  This  usually
           only serves to cheat the XPath engine to return the given value when last() XPath function is called.
           If  context  size  is set to 0, position is automatically also set to 0. If context size is positive,
           position is automatically set to 1. Setting context size to -1 restores the default behavior.

       getContextSize
             my $size = $xpc-&gt;getContextSize;

           Get the current context size.

       setContextNode
             $xpc-&gt;setContextNode($node)

           Set the current context node.

</pre><h4><b>BUGS</b> <b>AND</b> <b>CAVEATS</b></h4><pre>
       XML::LibXML::XPathContext  objects  <u>are</u>  reentrant,  meaning  that   you   can   call   methods   of   an
       XML::LibXML::XPathContext  even  from XPath extension functions registered with the same object or from a
       variable lookup function. On the other hand, you should rather avoid registering new extension functions,
       namespaces and a variable lookup function from within extension functions and a variable lookup function,
       unless you want to experience untested behavior.

</pre><h4><b>AUTHORS</b></h4><pre>
       Ilya Martynov and Petr Pajas, based on XML::LibXML and XML::LibXSLT code by Matt Sergeant  and  Christian
       Glahn.

</pre><h4><b>HISTORICAL</b> <b>REMARK</b></h4><pre>
       Prior to XML::LibXML 1.61 this module was distributed separately for maintenance reasons.

</pre><h4><b>AUTHORS</b></h4><pre>
       Matt Sergeant, Christian Glahn, Petr Pajas

</pre><h4><b>VERSION</b></h4><pre>
       2.0207

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2001-2007, AxKit.com Ltd.

       2002-2006, Christian Glahn.

       2006-2009, Petr Pajas.

</pre><h4><b>LICENSE</b></h4><pre>
       This  program  is  free  software;  you can redistribute it and/or modify it under the same terms as Perl
       itself.

perl v5.40.1                                       2025-08-01                     <u>XML::LibXML::<a href="../man3pm/XPathContext.3pm.html">XPathContext</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>