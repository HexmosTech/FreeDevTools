<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tcl_Interp - client-visible fields of interpreter structures</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl8.6-doc">tcl8.6-doc_8.6.16+dfsg-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Tcl_Interp - client-visible fields of interpreter structures

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tcl.h&gt;</b>

       typedef struct {
           char *<u>result</u>;
           Tcl_FreeProc *<u>freeProc</u>;
           int <u>errorLine</u>;
       } <b>Tcl_Interp</b>;

       typedef void <b>Tcl_FreeProc</b>(
               char *<u>blockPtr</u>);
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>Tcl_CreateInterp</b> procedure returns a pointer to a Tcl_Interp structure.  Callers of <b>Tcl_CreateInterp</b>
       should use this pointer as an opaque token, suitable  for  nothing  other  than  passing  back  to  other
       routines  in  the  Tcl interface.  Accessing fields directly through the pointer as described below is no
       longer  supported.   The  supported  public  routines  <b>Tcl_SetResult</b>,  <b>Tcl_GetResult</b>,   <b>Tcl_SetErrorLine</b>,
       <b>Tcl_GetErrorLine</b> must be used instead.

       For  legacy programs and extensions no longer being maintained, compiles against the Tcl 8.6 header files
       are only possible with the compiler directives
              #define USE_INTERP_RESULT
       and/or
              #define USE_INTERP_ERRORLINE
       depending on which fields of the <b>Tcl_Interp</b> struct are accessed.  These directives  may  be  embedded  in
       code or supplied via compiler options.

       The  <u>result</u>  and  <u>freeProc</u>  fields  are  used  to  return  results or error messages from commands.  This
       information is returned by command procedures back to <b>Tcl_Eval</b>, and by <b>Tcl_Eval</b> back to its callers.  The
       <u>result</u> field points to the string that represents the result or error message,  and  the  <u>freeProc</u>  field
       tells  how  to  dispose of the storage for the string when it is not needed anymore.  The easiest way for
       command  procedures  to  manipulate  these  fields  is  to  call   procedures   like   <b>Tcl_SetResult</b>   or
       <b>Tcl_AppendResult</b>;   they  will hide all the details of managing the fields.  The description below is for
       those procedures that manipulate the fields directly.

       Whenever a command procedure returns, it must ensure that the <u>result</u> field of its interpreter  points  to
       the  string  being  returned by the command.  The <u>result</u> field must always point to a valid string.  If a
       command wishes to return no result then <u>interp-&gt;result</u>  should  point  to  an  empty  string.   Normally,
       results  are assumed to be statically allocated, which means that the contents will not change before the
       next time <b>Tcl_Eval</b> is called or some other command procedure is invoked.   In  this  case,  the  <u>freeProc</u>
       field  must  be zero.  Alternatively, a command procedure may dynamically allocate its return value (e.g.
       using <b>Tcl_Alloc</b>) and store a pointer to it in <u>interp-&gt;result</u>.  In this case, the command  procedure  must
       also  set  <u>interp-&gt;freeProc</u>  to the address of a procedure that can free the value, or <b>TCL_DYNAMIC</b> if the
       storage was allocated directly by Tcl or by a call to <b>Tcl_Alloc</b>.  If <u>interp-&gt;freeProc</u> is  non-zero,  then
       Tcl will call <u>freeProc</u> to free the space pointed to by <u>interp-&gt;result</u> before it invokes the next command.
       If a client procedure overwrites <u>interp-&gt;result</u> when <u>interp-&gt;freeProc</u> is non-zero, then it is responsible
       for  calling  <u>freeProc</u>  to  free the old <u>interp-&gt;result</u> (the <b>Tcl_FreeResult</b> macro should be used for this
       purpose).

       <u>FreeProc</u> should have arguments and result that match the <b>Tcl_FreeProc</b> declaration above:  it  receives  a
       single  argument which is a pointer to the result value to free.  In most applications <b>TCL_DYNAMIC</b> is the
       only non-zero value ever used for <u>freeProc</u>.  However, an application  may  store  a  different  procedure
       address  in  <u>freeProc</u>  in order to use an alternate memory allocator or in order to do other cleanup when
       the result memory is freed.

       As part of processing each command, <b>Tcl_Eval</b> initializes <u>interp-&gt;result</u> and <u>interp-&gt;freeProc</u> just  before
       calling  the  command  procedure  for  the  command.  The <u>freeProc</u> field will be initialized to zero, and
       <u>interp-&gt;result</u> will point to an empty string.  Commands that do not return any value can simply leave the
       fields alone.  Furthermore, the empty string pointed to by  <u>result</u>  is  actually  part  of  an  array  of
       <b>TCL_RESULT_SIZE</b>  characters  (approximately  200).   If a command wishes to return a short string, it can
       simply copy it to the area pointed to by <u>interp-&gt;result</u>.   Or,  it  can  use  the  sprintf  procedure  to
       generate a short result string at the location pointed to by <u>interp-&gt;result</u>.

       It is a general convention in Tcl-based applications that the result of an interpreter is normally in the
       initialized  state  described  in  the  previous  paragraph.  Procedures that manipulate an interpreter's
       result (e.g. by returning an error) will generally assume that the result has been initialized  when  the
       procedure  is  called.   If  such  a  procedure  is  to be called after the result has been changed, then
       <b>Tcl_ResetResult</b> should be called first to reset the result to its initialized state.  The direct  use  of
       <u>interp-&gt;result</u> is strongly deprecated (see <b>Tcl_SetResult</b>).

       The  <u>errorLine</u> field is valid only after <b>Tcl_Eval</b> returns a <b>TCL_ERROR</b> return code.  In this situation the
       <u>errorLine</u> field identifies the line number of the command being executed when the  error  occurred.   The
       line numbers are relative to the command being executed:  1 means the first line of the command passed to
       <b>Tcl_Eval</b>,  2 means the second line, and so on.  The <u>errorLine</u> field is typically used in conjunction with
       <b>Tcl_AddErrorInfo</b> to report information about where an error occurred.  <u>ErrorLine</u> should not  normally  be
       modified except by <b>Tcl_Eval</b>.

</pre><h4><b>KEYWORDS</b></h4><pre>
       free, initialized, interpreter, malloc, result

Tcl                                                    7.5                                      <u><a href="../man3tcl/Tcl_Interp.3tcl.html">Tcl_Interp</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>