<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>seccomp_merge - Merge two seccomp filters</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libseccomp-dev">libseccomp-dev_2.6.0-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       seccomp_merge - Merge two seccomp filters

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;seccomp.h&gt;</b>

       <b>typedef</b> <b>void</b> <b>*</b> <b>scmp_filter_ctx;</b>

       <b>int</b> <b>seccomp_merge(scmp_filter_ctx</b> <u>dst</u><b>,</b> <b>scmp_filter_ctx</b> <u>src</u><b>);</b>

       Link with <u>-lseccomp</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>seccomp_merge</b>()  function  merges  the  seccomp  filter in <u>src</u> with the filter in <u>dst</u> and stores the
       resulting in the <u>dst</u> filter.  If successful, the <u>src</u> seccomp filter is released and all  internal  memory
       associated  with  the  filter is freed; there is no need to call <b><a href="../man3/seccomp_release.3.html">seccomp_release</a></b>(3) on <u>src</u> and the caller
       should discard any references to the filter.

       In order to merge two seccomp  filters,  both  filters  must  have  the  same  attribute  values  and  no
       overlapping architectures.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Returns zero on success or one of the following error codes on failure:

       <b>-EDOM</b>  Unable to merge the filters due to architecture issues, e.g. byte endian mismatches.

       <b>-EEXIST</b>
              The architecture already exists in the filter.

       <b>-EINVAL</b>
              One of the filters is invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.

</pre><h4><b>EXAMPLES</b></h4><pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx_32, ctx_64;

            ctx_32 = seccomp_init(SCMP_ACT_KILL);
            if (ctx_32 == NULL)
                 goto out_all;
            ctx_64 = seccomp_init(SCMP_ACT_KILL);
            if (ctx_64 == NULL)
                 goto out_all;

            if (seccomp_arch_exist(ctx_32, SCMP_ARCH_X86) == -EEXIST) {
                 rc = seccomp_arch_add(ctx_32, SCMP_ARCH_X86);
                 if (rc != 0)
                      goto out_all;
                 rc = seccomp_arch_remove(ctx_32, SCMP_ARCH_NATIVE);
                 if (rc != 0)
                      goto out_all;
            }
            if (seccomp_arch_exist(ctx_64, SCMP_ARCH_X86_64) == -EEXIST) {
                 rc = seccomp_arch_add(ctx_64, SCMP_ARCH_X86_64);
                 if (rc != 0)
                      goto out_all;
                 rc = seccomp_arch_remove(ctx_64, SCMP_ARCH_NATIVE);
                 if (rc != 0)
                      goto out_all;
            }

            /* ... */

            rc = seccomp_merge(ctx_64, ctx_32);
            if (rc != 0)
                 goto out_all;

            /* NOTE: the 'ctx_32' filter is no longer valid at this point */

            /* ... */

       out:
            seccomp_release(ctx_64);
            return -rc;
       out_all:
            seccomp_release(ctx_32);
            goto out;
       }

</pre><h4><b>NOTES</b></h4><pre>
       While  the  seccomp filter can be generated independent of the kernel, kernel support is required to load
       and enforce the seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the  source  code  repository,  can  be  found  at
       https://github.com/seccomp/libseccomp.   This tool, as well as the libseccomp library, is currently under
       development, please report any bugs at the project site or directly to the author.

</pre><h4><b>AUTHOR</b></h4><pre>
       Paul Moore &lt;<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/seccomp_init.3.html">seccomp_init</a></b>(3),  <b><a href="../man3/seccomp_reset.3.html">seccomp_reset</a></b>(3),  <b><a href="../man3/seccomp_arch_add.3.html">seccomp_arch_add</a></b>(3),  <b><a href="../man3/seccomp_arch_remove.3.html">seccomp_arch_remove</a></b>(3),   <b><a href="../man3/seccomp_attr_get.3.html">seccomp_attr_get</a></b>(3),
       <b><a href="../man3/seccomp_attr_set.3.html">seccomp_attr_set</a></b>(3)

<a href="mailto:paul@paul-moore.com">paul@paul-moore.com</a>                                30 May 2020                                  <u><a href="../man3/seccomp_merge.3.html">seccomp_merge</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>