<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courier::Filter::Module::Parts - Message (MIME multipart and ZIP archive) parts filter module for the</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/courier-filter-perl">courier-filter-perl_0.200+ds-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Courier::Filter::Module::Parts - Message (MIME multipart and ZIP archive) parts filter module for the
       Courier::Filter framework

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Courier::Filter::Module::Parts;

           my $module = Courier::Filter::Module::Parts-&gt;new(
               max_message_size
                               =&gt; $max_message_size,
               max_part_size   =&gt; $max_part_size,
               views           =&gt; ['raw', 'zip'],
               signatures      =&gt; [
                   {
                       # One or more of the following options:
                       mime_type       =&gt; 'text/html' || qr/html/i,
                       file_name       =&gt; 'file_name.ext' || qr/\.(com|exe)$/i,
                       size            =&gt; 106496,
                       digest_md5      =&gt; 'b09e26c292759d654633d3c8ed00d18d',
                       encrypted       =&gt; 0,

                       # Optionally any of the following:
                       views           =&gt; ['raw', 'zip'],
                       response        =&gt; $response_text
                   },
                   ...
               ],

               logger          =&gt; $logger,
               inverse         =&gt; 0,
               trusting        =&gt; 0,
               testing         =&gt; 0,
               debugging       =&gt; 0
           );

           my $filter = Courier::Filter-&gt;new(
               ...
               modules         =&gt; [ $module ],
               ...
           );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This class is a filter module class for use with Courier::Filter.  It matches a message if one of the
       message's parts (MIME parts, or files in a ZIP archive) matches one of the configured signatures.

   <b>Constructor</b>
       The following constructor is provided:

       <b>new(%options)</b>: returns <u>Courier::Filter::Module::Parts</u>
           Creates a new <b>Parts</b> filter module.

           %options is a list of key/value pairs representing any of the following options:

           <b>views</b>
               An  arrayref containing the global default set of <u>views</u> the filter module should apply to message
               parts when matching the configured signatures against them.  A view is the way how a MIME  part's
               (MIME-decoded) data is interpreted.  Defaults to <b>['raw']</b>.

               The following views are supported:

               <b>raw</b> The  MIME  part  is  MIME-decoded  but  not otherwise transformed.  The raw MIME part is then
                   matched against the configured signatures.

               <b>zip</b> If the MIME part has a file name ending in ".zip", it is considered a ZIP  archive,  and  all
                   unencrypted  files  in  the  archive  are  matched  as  individual  message parts against the
                   configured signatures.  The zip view requires the <b>Archive::Zip</b> Perl module to be installed.

           <b>max_message_size</b>
           <b>max_size</b> (DEPRECATED)
               An integer value controlling the maximum size (in bytes)  of  the  overall  message  text  for  a
               message  to  be  processed  by this filter module.  Messages larger than this value will never be
               processed, and thus will never match.  If <b>undef</b>, there is no size  limit.   Defaults  to  <b>1024**2</b>
               (1MB).

               As MIME multipart and ZIP archive processing can be quite CPU- and memory-intensive (although the
               <b>Parts</b>  filter  module  makes  use  of  temporary files since version 0.13), you should definitely
               restrict the message size to some sensible value  that  easily  fits  in  your  server's  memory.
               1024**2 (1MB) should be appropriate for most uses of this filter module.

               The  "max_message_size" option was previously called "max_size", but the latter is now deprecated
               and may not be supported in future versions of the <b>Parts</b> filter module.

           <b>max_part_size</b>
               An integer value controlling the maximum size (in bytes) of any single message  part  (i.e.  MIME
               part  in  a  message, or file in an archive) for that part to be processed by this filter module.
               Parts larger than this value will never be processed, and thus will never match.  If <b>undef</b>, there
               is no size limit.

               Defaults to the value of the "max_message_size" option, so you don't really  need  to  specify  a
               part  size  limit  if  you  are  comfortable  with  using  the  same  value  for  both.   See the
               "max_message_size" option for its default.

               If you make use of the <b>'zip'</b> view, be aware of the risk posed by so-called  <u>decompression</u>  <u>bombs</u>,
               which allow messages to easily fall below the overall message size limit, while a file in a small
               attached ZIP archive can decompress to a huge size.  The part size limit prevents huge files from
               being decompressed.

           <b>signatures</b>
               <u>Required</u>.   A reference to an array containing the list of <u>signatures</u> against which message parts
               are to be matched.  A signature in turn is a reference to a hash containing one or more so-called
               signature <u>aspects</u> (as key/value pairs) and any signature <u>options</u> (also as key/value pairs).

               <u>Signature</u> <u>aspects</u>

               Aspects may either be scalar values (for exact, case-sensitive matches),  or  regular  expression
               objects  created  with  the  "qr//"  operator (for inexact, partial matches).  For a signature to
               match a message part, <u>all</u> of the signature's specified aspects must match those  of  the  message
               part.   For  the  filter  module  to match a message, <u>any</u> of the signatures must match <u>any</u> of the
               message's parts.

               A signature aspect can be any of the following:

               <b>mime_type</b>
                   The MIME type of the message part ('type/sub-type').

               <b>file_name</b>
                   The file name of the message part.

               <b>size</b>
                   The exact size (in bytes) of the decoded message part.

               <b>digest_md5</b>
                   The MD5 digest of the decoded message part (32 hex digits, as printed by `md5sum`).

               <b>encrypted</b>
                   A boolean value denoting  whether  the  message  part  is  encrypted  and  its  contents  are
                   inaccessible to the <b>Parts</b> filter module.

               <u>Signature</u> <u>options</u>

               A signature option can be any of the following:

               <b>views</b>
                   An  arrayref containing the set of <u>views</u> the filter module should apply to message parts when
                   matching <u>this</u> signature against them.  For a list of supported views, see the description  of
                   the  constructor's  "views"  option.   Defaults  to  the global set of views specified to the
                   constructor.

               <b>response</b>
                   A string that is to be returned as the  match  result  in  case  of  a  match.   Defaults  to
                   <b>"Prohibited</b> <b>message</b> <b>part</b> <b>detected."</b>.

               <u>Example</u>

               So for instance, a signature list could look like this:

                   signatures  =&gt; [
                       {
                           mime_type   =&gt; qr/html/i,
                           response    =&gt; 'No HTML mail, please.'
                       },
                       {
                           file_name   =&gt; qr/\.(com|exe|lnk|pif|scr|vbs)$/i,
                           response    =&gt; 'Executable content detected'
                       },
                       {
                           size        =&gt; 106496,
                           digest_md5  =&gt; 'b09e26c292759d654633d3c8ed00d18d',
                           views       =&gt; ['raw', 'zip'],  # Look into ZIP archives, too!
                           response    =&gt; 'Worm detected: W32.Swen'
                       },
                       {
                           size        =&gt; 22528,
                           # Cannot set a specific digest_md5 since W32.Mydoom
                           # is polymorphic.
                           response    =&gt; 'Worm suspected: W32.Mydoom'
                       },
                       {
                           encrypted   =&gt; 1,
                           views       =&gt; ['zip'],
                           response    =&gt; 'Worm suspected ' .
                                          '(only worms and fools use ZIP encryption)'
                       }
                   ]

           All  options  of the <b>Courier::Filter::Module</b> constructor are also supported by the constructor of the
           <b>Parts</b> filter module.  Please see "new" in Courier::Filter::Module for their descriptions.

   <b>Instance</b> <b>methods</b>
       See "Instance methods" in Courier::Filter::Module for a description of the provided instance methods.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Courier::Filter::Module, Courier::Filter::Overview.

       For AVAILABILITY, SUPPORT, and LICENSE information, see Courier::Filter::Overview.

</pre><h4><b>AUTHOR</b></h4><pre>
       Julian Mehnle &lt;<a href="mailto:julian@mehnle.net">julian@mehnle.net</a>&gt;

perl v5.20.2                                       2015-11-28                <u>Courier::Filter::Module::<a href="../man3pm/Parts.3pm.html">Parts</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>