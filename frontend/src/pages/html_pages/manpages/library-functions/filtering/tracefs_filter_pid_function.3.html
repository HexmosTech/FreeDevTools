<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tracefs_filter_pid_function, tracefs_filter_pid_events, tracefs_filter_pid_function_clear,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtracefs-doc">libtracefs-doc_1.8.1-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tracefs_filter_pid_function, tracefs_filter_pid_events, tracefs_filter_pid_function_clear,
       tracefs_filter_pid_events_clear - Add and remove PID filtering for functions and events

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tracefs.h&gt;</b>

       int <b>tracefs_filter_pid_function</b>(struct tracefs_instance *<u>instance,</u> int <u>pid</u>,
                                       bool <u>reset</u>, bool <u>notrace</u>);
       int <b>tracefs_filter_pid_function_clear</b>(struct tracefs_instance *<u>instance</u>, bool <u>notrace</u>);
       int <b>tracefs_filter_pid_events</b>(struct tracefs_instance *<u>instance</u>, int <u>pid</u>,
                                    bool <u>reset</u>, bool <u>notrace</u>);
       int <b>tracefs_filter_pid_events_clear</b>(struct tracefs_instance *<u>instance</u>, bool <u>notrace</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Both events and functions can be filtered by PID, but they are done separately. PID filtering for
       functions affect the function and function_graph tracer, where as PID filtering for events affect all
       events such as <u>sched_switch</u> and <u>sched_waking</u>. If the <b>TRACEFS_OPTION_FUNCTION_FORK</b> is enabled (see
       <b><a href="../man3/tracefs_option_enable.3.html">tracefs_option_enable</a></b>(3)), any PID that is set as part of the function PID filtering will automatically
       have its children added when they are spawned, as well as the PID removed when they exit. If the
       <b>TRACEFS_OPTION_EVENT_FORK</b> is set, the same is true for event PID filtering. This also includes the
       <u>notrace</u> option where the child threads and processes of PIDs that are labled as notrace will also not be
       traced.

       The <b>tracefs_filter_pid_function()</b> affects function PID filtering and <b>tracefs_filter_pid_events()</b> affects
       the PID event filtering. For both functions, they add a <u>pid</u> to be filtered in the given <u>instance</u>. If
       <u>reset</u> is true, then any PIDs already being filtered will be removed, otherwise the <u>pid</u> is simply added to
       the filtering. If <u>notrace</u> is true, then the PID is added to the list of PIDs that are not to be traced.
       Note, that <u>reset</u> only affects the list associated with <u>notrace</u>. That is, if both <u>reset</u> and <u>notrace</u> are
       true, then it will not affect PIDs that are to be traced. Same is if <u>reset</u> is true and <u>notrace</u> is false,
       it will not affect PIDs that are not to be traced.

       The <b>tracefs_filter_pid_function_clear()</b> affects function PID filtering and
       <b>tracefs_filter_pid_events_clear()</b> affects the PID event filtering. For both functions it will clear all
       the PIDs that are being filtered for the given filter. If <u>notrace</u> is true it clears all the PIDs that are
       not to be traced otherwise if it is false, it clears all the PIDs that are to be traced.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       All the functions return 0 on success and -1 on error.

</pre><h4><b>EXAMPLE</b></h4><pre>
           #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
           #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
           #include &lt;<a href="file:/usr/include/ctype.h">ctype.h</a>&gt;
           #include &lt;tracefs.h&gt;

           static void usage(char **argv)
           {
                   fprintf(stderr, "usage: %s [-e|-f][-c|-n] pid [pid ...]\n", argv[0]);
                   fprintf(stderr, "   -e enable event filter\n");
                   fprintf(stderr, "   -f enable function filter\n");
                   fprintf(stderr, "     (default is both, function and event)\n");
                   fprintf(stderr, "   -c clear the filter\n");
                   fprintf(stderr, "   -n notrace filter\n");
                   exit(-1);
           }

           int main (int argc, char **argv)
           {
                   bool events = false;
                   bool funcs = false;
                   bool neg = false;
                   bool clear = false;
                   bool reset = true;
                   int i;

                   for (i = 1; i &lt; argc &amp;&amp; argv[i][0] == '-'; i++) {
                           char *arg = argv[i];
                           int c;
                           for (c = 1; arg[c]; c++) {
                                   switch (arg[c]) {
                                   case 'e': events = true; break;
                                   case 'f': funcs = true; break;
                                   case 'n': neg = true; break;
                                   case 'c': clear = true; break;
                                   default:
                                           usage(argv);
                                   }
                           }
                           if (c == 1)
                                   usage(argv);
                   }

                   if (i == argc &amp;&amp; !clear)
                           usage(argv);

                   if (!events &amp;&amp; !funcs) {
                           events = true;
                           funcs = true;
                   }

                   if (clear) {
                           if (events)
                                   tracefs_filter_pid_events_clear(NULL, neg);
                           if (funcs)
                                   tracefs_filter_pid_function_clear(NULL, neg);
                           <a href="../man0/exit.0.html">exit</a>(0);
                   }

                   for (; i &lt; argc; i++) {
                           int pid = atoi(argv[i]);

                           if (events)
                                   tracefs_filter_pid_events(NULL, pid, reset, neg);
                           if (funcs)
                                   tracefs_filter_pid_function(NULL, pid, reset, neg);

                           reset = false;
                   }

                   <a href="../man0/exit.0.html">exit</a>(0);
           }

</pre><h4><b>FILES</b></h4><pre>
           <b>tracefs.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>-ltracefs</b>
                   Linker switch to add when building a program that uses the library.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/libtracefs.3.html">libtracefs</a></b>(3), <b><a href="../man3/libtraceevent.3.html">libtraceevent</a></b>(3), <b><a href="../man1/trace-cmd.1.html">trace-cmd</a></b>(1), <b><a href="../man3/tracefs_hist_alloc.3.html">tracefs_hist_alloc</a></b>(3), <b><a href="../man3/tracefs_hist_alloc_2d.3.html">tracefs_hist_alloc_2d</a></b>(3),
       <b><a href="../man3/tracefs_hist_alloc_nd.3.html">tracefs_hist_alloc_nd</a></b>(3), <b><a href="../man3/tracefs_hist_free.3.html">tracefs_hist_free</a></b>(3), <b><a href="../man3/tracefs_hist_add_key.3.html">tracefs_hist_add_key</a></b>(3), <b><a href="../man3/tracefs_hist_add_value.3.html">tracefs_hist_add_value</a></b>(3),
       <b><a href="../man3/tracefs_hist_add_name.3.html">tracefs_hist_add_name</a></b>(3), <b><a href="../man3/tracefs_hist_start.3.html">tracefs_hist_start</a></b>(3), <b><a href="../man3/tracefs_hist_destory.3.html">tracefs_hist_destory</a></b>(3), <b><a href="../man3/tracefs_hist_add_sort_key.3.html">tracefs_hist_add_sort_key</a></b>(3),
       <b><a href="../man3/tracefs_hist_sort_key_direction.3.html">tracefs_hist_sort_key_direction</a></b>(3)

</pre><h4><b>AUTHOR</b></h4><pre>
           <b>Steven</b> <b>Rostedt</b> &lt;<b><a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a></b>[1]&gt;

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to &lt;<b><a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a></b>[2]&gt;

</pre><h4><b>LICENSE</b></h4><pre>
       libtracefs is Free Software licensed under the GNU LGPL 2.1

</pre><h4><b>RESOURCES</b></h4><pre>
       <b>https://git.kernel.org/pub/scm/libs/libtrace/libtracefs.git/</b>

</pre><h4><b>COPYING</b></h4><pre>
       Copyright (C) 2023 Google, LLC. Free use of this software is granted under the terms of the GNU Public
       License (GPL).

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="mailto:rostedt@goodmis.org">rostedt@goodmis.org</a>
           <a href="mailto:rostedt@goodmis.org">mailto:rostedt@goodmis.org</a>

        2. <a href="mailto:linux-trace-devel@vger.kernel.org">linux-trace-devel@vger.kernel.org</a>
           <a href="mailto:linux-trace-devel@vger.kernel.org">mailto:linux-trace-devel@vger.kernel.org</a>

libtracefs 1.8.1                                   06/05/2025                                      <u><a href="../man3/LIBTRACEFS.3.html">LIBTRACEFS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>