<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>smtp - Client-side tcl implementation of the smtp protocol</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       smtp - Client-side tcl implementation of the smtp protocol

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b>

       package require <b>mime</b> <b>?1.5.4?</b>

       package require <b>smtp</b> <b>?1.5.2?</b>

       <b>::smtp::sendmessage</b> <u>token</u> <u>option</u>...

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>smtp</b> library package provides the client side of the Simple Mail Transfer Protocol (SMTP) (1) (2).

       <b>::smtp::sendmessage</b> <u>token</u> <u>option</u>...
              This  command  sends  the  MIME  part  (see  package <b>mime</b>) represented by <u>token</u> to an SMTP server.
              <u>options</u> is a list of options and their associated values.  The recognized options are:

              <b>-servers</b>
                     A list of SMTP servers. The default is <b>localhost</b>.

                     If multiple servers are specified they are tried in sequence.  Note  that  the  <b>-ports</b>  are
                     iterated  over  in tandem with the servers. If there are not enough ports for the number of
                     servers the default port (see below) is used. If there are  more  ports  than  servers  the
                     superfluous ports are ignored.

              <b>-ports</b> A list of SMTP ports. The default is <b>25</b>.

                     See  option  <b>-servers</b>  above regardig the behaviour for then multiple servers and ports are
                     specified.

              <b>-client</b>
                     The name to use as our hostname when connecting to the server. By default  this  is  either
                     localhost  if  one  of  the  servers is localhost, or is set to the string returned by <b>info</b>
                     <b>hostname</b>.

              <b>-queue</b> Indicates that the SMTP server should be asked to queue the message for later processing. A
                     boolean value.

              <b>-atleastone</b>
                     Indicates that the SMTP server must find at least one recipient acceptable for the  message
                     to be sent. A boolean value.

              <b>-originator</b>
                     A  string  containing  an  822-style  address  specification.  If  present the header isn't
                     examined for an originator address.

              <b>-recipients</b>
                     A string containing one or more 822-style address specifications.  If  present  the  header
                     isn't  examined for recipient addresses). If the string contains more than one address they
                     will be separated by commas.

              <b>-header</b>
                     A list containing two elements, an smtp header and its associated value (the -header option
                     may occur zero or more times).

              <b>-usetls</b>
                     This package supports the RFC 3207 TLS extension (3) by default provided the tls package is
                     available. You can turn this off with this boolean option.

              <b>-tlsimport</b>
                     This boolean flag is <b>false</b> by default.  When this flag is set the package will  import  TLS
                     on  a  sucessfully  opened  channel.  This  is  needed  for  connections  using  native TLS
                     negotiation instead of <b>STARTTLS</b>. The <b>tls</b> package is automatically required when needed.

              <b>-tlspolicy</b>
                     This option lets you specify a command to be called if an error occurs  during  TLS  setup.
                     The  command  is  called  with  the  SMTP code and diagnostic message appended. The command
                     should return 'secure' or 'insecure' where insecure will cause the package to  continue  on
                     the  unencrypted  channel.   Returning  'secure' will cause the socket to be closed and the
                     next server in the <b>-servers</b> list to be tried.

              <b>-username</b>

              <b>-password</b>
                     If your SMTP server requires authentication (RFC 2554 (4)) before accepting  mail  you  can
                     use <b>-username</b> and <b>-password</b> to provide your authentication details to the server. Currently
                     this  package  supports  DIGEST-MD5,  CRAM-MD5, LOGIN and PLAIN authentication methods. The
                     most secure method will be tried first and each method tried in turn until  we  are  either
                     authorized or we run out of methods. Note that if the server permits a TLS connection, then
                     the authorization will occur after we begin using the secure channel.

                     Please  also read the section on <b>Authentication</b>, it details the necessary prequisites, i.e.
                     packages needed to support these options and authentication.

       If the <b>-originator</b> option is not present, the originator address is taken  from  <b>From</b>  (or  <b>Resent-From</b>);
       similarly,  if  the <b>-recipients</b> option is not present, recipient addresses are taken from <b>To</b>, <b>cc</b>, and <b>Bcc</b>
       (or <b>Resent-To</b>, and so on). Note that the header key/values supplied by  the  <b>-header</b>  option  (not  those
       present  in the MIME part) are consulted. Regardless, header key/values are added to the outgoing message
       as necessary to ensure that a valid 822-style message is sent.

       The command returns a list indicating which recipients were unacceptable to the SMTP server. Each element
       of the list is another list, containing the address, an  SMTP  error  code,  and  a  textual  diagnostic.
       Depending on the <b>-atleastone</b> option and the intended recipients, a non-empty list may still indicate that
       the message was accepted by the server.

</pre><h4><b>AUTHENTICATION</b></h4><pre>
       Beware.  SMTP  authentication  uses <b>SASL</b>. I.e. if the user has to authenticate a connection, i.e. use the
       options <b>-user</b> and <b>-password</b> (see above) it is necessary to have the <b>sasl</b> package available so  that  <b>smtp</b>
       can load it.

       This is a soft dependency because not everybody requires authentication, and <b>sasl</b> depends on a lot of the
       cryptographic (secure) hashes, i.e. all of <b>md5</b>, <b>otp</b>, <b>md4</b>, <b>sha1</b>, and <b>ripemd160</b>.

</pre><h4><b>EXAMPLE</b></h4><pre>
              proc send_simple_message {recipient email_server subject body} {
                  package require smtp
                  package require mime

                  set token [mime::initialize -canonical text/plain \
                -string $body]
                  mime::setheader $token Subject $subject
                  smtp::sendmessage $token \
                -recipients $recipient -servers $email_server
                  mime::finalize $token
              }

              send_simple_message <a href="mailto:someone@somewhere.com">someone@somewhere.com</a> localhost \
                  "This is the subject." "This is the message."

</pre><h4><b>TLS</b> <b>SECURITY</b> <b>CONSIDERATIONS</b></h4><pre>
       This package uses the <b>TLS</b> package to handle the security for <b>https</b> urls and other socket connections.

       Policy  decisions like the set of protocols to support and what ciphers to use are not the responsibility
       of <b>TLS</b>, nor of this  package  itself  however.   Such  decisions  are  the  responsibility  of  whichever
       application  is  using  the package, and are likely influenced by the set of servers the application will
       talk to as well.

       For        example,        in        light        of        the        recent        <u>POODLE</u>        <u>attack</u>
       [<a href="http://googleonlinesecurity.blogspot.co.uk/2014/10/this-poodle-bites-exploiting-ssl-30.html">http://googleonlinesecurity.blogspot.co.uk/2014/10/this-poodle-bites-exploiting-ssl-30.html</a>]  discovered
       by Google many servers will  disable  support  for  the  SSLv3  protocol.   To  handle  this  change  the
       applications  using  <b>TLS</b>  must  be patched, and not this package, nor <b>TLS</b> itself.  Such a patch may be as
       simple as generally activating <b>tls1</b> support, as shown in the example below.

                  package require tls
                  tls::init -tls1 1 ;# forcibly activate support for the TLS1 protocol

                  ... your own application code ...

</pre><h4><b>REFERENCES</b></h4><pre>
       [1]    Jonathan B. Postel, "SIMPLE MAIL TRANSFER  PROTOCOL",  RFC  821,  August  1982.   (<u><a href="http://www.rfc">http://www.rfc</a>-</u>
              <u>editor.org/rfc/rfc821.txt</u>)

       [2]    J.   Klensin,   "Simple   Mail   Transfer  Protocol",  RFC  2821,  April  2001.   (<u><a href="http://www.rfc">http://www.rfc</a>-</u>
              <u>editor.org/rfc/rfc2821.txt</u>)

       [3]    P. Hoffman, "SMTP Service Extension for Secure SMTP over  Transport  Layer  Security",  RFC  3207,
              February 2002.  (<u><a href="http://www.rfc-editor.org/rfc/rfc3207.txt">http://www.rfc-editor.org/rfc/rfc3207.txt</a></u>)

       [4]    J.  Myers,  "SMTP  Service  Extension for Authentication", RFC 2554, March 1999.  (<u><a href="http://www.rfc">http://www.rfc</a>-</u>
              <u>editor.org/rfc/rfc2554.txt</u>)

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This document, and the package it describes, will undoubtedly contain bugs and  other  problems.   Please
       report  such  in the category <u>smtp</u> of the <u>Tcllib</u> <u>Trackers</u> [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].  Please
       also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note further that <u>attachments</u> are strongly preferred over inlined patches. Attachments  can  be  made  by
       going  to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most button
       in the secondary navigation bar.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       ftp, http, mime, pop3

</pre><h4><b>KEYWORDS</b></h4><pre>
       email, internet, mail, mime, net, rfc 2554, rfc 2821, rfc 3207, rfc 821, rfc 822, smtp, tls

</pre><h4><b>CATEGORY</b></h4><pre>
       Networking

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 1999-2000 Marshall T. Rose and others

tcllib                                                1.5.2                                           <u><a href="../man3tcl/smtp.3tcl.html">smtp</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>