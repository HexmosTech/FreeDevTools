<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>imap4 - imap client-side tcl implementation of imap protocol</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       imap4 - imap client-side tcl implementation of imap protocol

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>imap4</b> <b>?0.5.5?</b>

       <b>::imap4::open</b> <u>hostname</u> ?<u>port</u>?

       <b>::imap4::starttls</b> <u>chan</u>

       <b>::imap4::login</b> <u>chan</u> <u>user</u> <u>pass</u>

       <b>::imap4::folders</b> <u>chan</u> ?<u>-inline</u>? ?<u>mboxref</u>? ?<u>mboxname</u>?

       <b>::imap4::select</b> <u>chan</u> ?<u>mailbox</u>?

       <b>::imap4::examine</b> <u>chan</u> ?<u>mailbox</u>?

       <b>::imap4::fetch</b> <u>chan</u> <u>range</u> ?<u>-inline</u>? ?<u>attr</u> <u>...</u>?

       <b>::imap4::noop</b> <u>chan</u>

       <b>::imap4::check</b> <u>chan</u>

       <b>::imap4::folderinfo</b> <u>chan</u> ?<u>info</u>?

       <b>::imap4::msginfo</b> <u>chan</u> <u>msgid</u> ?<u>info</u>? ?<u>defval</u>?

       <b>::imap4::mboxinfo</b> <u>chan</u> ?<u>info</u>?

       <b>::imap4::isableto</b> <u>chan</u> ?<u>capability</u>?

       <b>::imap4::create</b> <u>chan</u> <u>mailbox</u>

       <b>::imap4::delete</b> <u>chan</u> <u>mailbox</u>

       <b>::imap4::rename</b> <u>chan</u> <u>oldname</u> <u>newname</u>

       <b>::imap4::subscribe</b> <u>chan</u> <u>mailbox</u>

       <b>::imap4::unsubscribe</b> <u>chan</u> <u>mailbox</u>

       <b>::imap4::search</b> <u>chan</u> <u>expr</u> ?<u>...</u>?

       <b>::imap4::close</b> <u>chan</u>

       <b>::imap4::cleanup</b> <u>chan</u>

       <b>::imap4::debugmode</b> <u>chan</u> ?<u>errormsg</u>?

       <b>::imap4::store</b> <u>chan</u> <u>range</u> <u>data</u> <u>flaglist</u>

       <b>::imap4::expunge</b> <u>chan</u>

       <b>::imap4::copy</b> <u>chan</u> <u>msgid</u> <u>mailbox</u>

       <b>::imap4::logout</b> <u>chan</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>imap4</b>  library package provides the client side of the <u>Internet</u> <u>Message</u> <u>Access</u> <u>Protocol</u> (IMAP) using
       standard sockets or secure connection via TLS/SSL.  The package is fully implemented in Tcl.

       This document describes the procedures and explains their usage.

</pre><h4><b>PROCEDURES</b></h4><pre>
       This package defines the following public procedures:

       <b>::imap4::open</b> <u>hostname</u> ?<u>port</u>?

              Open a new IMAP connection and initalize the handler, the imap communication channel (handler)  is
              returned.

              <u>hostname</u> - mail server

              <u>port</u> - connection port, defaults to 143

              The  namespace  variable  <b>::imap4::use_ssl</b>  can  be  used  to establish to a secure connection via
              TSL/SSL if set to true. In this case default connection port defaults to 993.

              <u>Note:</u> For connecting via SSL the Tcl module <u>tls</u> must be  already  loaded  otherwise  an  error  is
              raised.

                  package require tls              ; # must be loaded for TLS/SSL
                  set ::imap4::use_ssl 1           ; # request a secure connection
                  set chan [::imap4::open $server] ; # default port is now 993

       <b>::imap4::starttls</b> <u>chan</u>
              Use  this  when  tasked with connecting to an unsecure port which must be changed to a secure port
              prior to user login.  This feature is known as <u>STARTTLS</u>.

       <b>::imap4::login</b> <u>chan</u> <u>user</u> <u>pass</u>

              Login using the IMAP LOGIN command, 0 is returned on successful login.

              <u>chan</u> - imap channel

              <u>user</u> - username

              <u>pass</u> - password

       <b>::imap4::folders</b> <u>chan</u> ?<u>-inline</u>? ?<u>mboxref</u>? ?<u>mboxname</u>?

              Get list of matching folders, 0 is returned on success.

              Wildcards '*' as '%' are allowed for <u>mboxref</u> and <u>mboxname</u>, command <b>::imap4::folderinfo</b> can be used
              to retrieve folder information.

              <u>chan</u> - imap channel

              <u>mboxref</u> - mailbox reference, defaults to ""

              <u>mboxname</u> - mailbox name, defaults to "*"

              If <b>-inline</b> is specified a compact folderlist is returned instead of the result code. All flags are
              converted to lowercase and leading special characters are removed.

              {{Arc08 noselect} {Arc08/Private {noinferiors unmarked}} {INBOX noinferiors}}

       <b>::imap4::select</b> <u>chan</u> ?<u>mailbox</u>?

              Select a mailbox, 0 is returned on success.

              <u>chan</u> - imap channel

              <u>mailbox</u> - Path of the mailbox,  defaults to <u>INBOX</u>

              Prior to examine/select an open mailbox must be closed - see: <b>::imap4::close</b>.

       <b>::imap4::examine</b> <u>chan</u> ?<u>mailbox</u>?

              "Examines" a mailbox, read-only equivalent of <b>::imap4::select</b>.

              <u>chan</u> - imap channel

              <u>mailbox</u> - mailbox name or path to mailbox, defaults to <u>INBOX</u>

              Prior to examine/select an open mailbox must be closed - see: <b>::imap4::close</b>.

       <b>::imap4::fetch</b> <u>chan</u> <u>range</u> ?<u>-inline</u>? ?<u>attr</u> <u>...</u>?

              Fetch attributes from messages.

              The attributes are fetched and stored in the internal state which can be  retrieved  with  command
              <b>::imap4::msginfo</b>, 0 is returned on success.  If <b>-inline</b> is specified, alle records are returned as
              list in order as defined in the <u>attr</u> argument.

              <u>chan</u> - imap channel

              <u>range</u> - message index in format <u>FROM</u>:<u>TO</u>

              <u>attr</u> - imap attributes to fetch

              <u>Note:</u>  If  <u>FROM</u>  is  omitted,  the  1st  message is assumed, if <u>TO</u> is ommitted the last message is
              assumed.  All message index ranges are 1-based.

       <b>::imap4::noop</b> <u>chan</u>
              Send NOOP command to server. May get information as untagged data.

              <u>chan</u> - imap channel

       <b>::imap4::check</b> <u>chan</u>
              Send CHECK command to server. Flush to disk.

              <u>chan</u> - imap channel

       <b>::imap4::folderinfo</b> <u>chan</u> ?<u>info</u>?

              Get information on the recently selected folderlist.  If the <u>info</u> argument is omitted  or  a  null
              string, the full list of information available for the mailbox is returned.

              If  the  required information name is suffixed with a ? character, the command returns true if the
              information is available, or false if it is not.

              <u>chan</u> - imap channel

              <u>info</u> - folderlist options to retrieve

              Currently supported options: <u>delim</u> - hierarchy  delimiter  only,  <u>match</u>  -  ref  and  mbox  search
              patterns  (see  <b>::imap4::folders</b>), <u>names</u> - list of folder names only, <u>flags</u> - list of folder names
              with  flags  in  format  <u>{</u>  <u>{name</u>  <u>{flags}}</u>  <u>...</u>  <u>}</u>  (see  also   compact   format   in   function
              <b>::imap4::folders</b>).

              {{Arc08 {{\NoSelect}}} {Arc08/Private {{\NoInferiors} {\UnMarked}}} {INBOX {\NoInferiors}}}

       <b>::imap4::msginfo</b> <u>chan</u> <u>msgid</u> ?<u>info</u>? ?<u>defval</u>?

              Get information (from previously collected using fetch) from a given <u>msgid</u>. If the 'info' argument
              is  omitted  or  a null string, the list of available information options for the given message is
              returned.

              If the required information name is suffixed with a ? character, the command returns true  if  the
              information is available, or false if it is not.

              <u>chan</u> - imap channel

              <u>msgid</u> - message number

              <u>info</u> - imap keyword to retrieve

              <u>defval</u> - default value, returned if info is empty

              <u>Note:</u> All message index ranges are 1-based.

       <b>::imap4::mboxinfo</b> <u>chan</u> ?<u>info</u>?

              Get  information  on  the  currently  selected mailbox.  If the <u>info</u> argument is omitted or a null
              string, the list of available information options for the mailbox is returned.

              If the required information name is suffixed with a ? character, the command returns true  if  the
              information is available, or false if it is not.

              <u>chan</u> - imap channel

              <u>opt</u> - mailbox option to retrieve

              Currently supported options: <u>EXISTS</u> (noof msgs), <u>RECENT</u> (noof 'recent' flagged msgs), <u>FLAGS</u>

              In conjunction with OK: <u>PERMFLAGS</u>, <u>UIDNEXT</u>, <u>UIDVAL</u>, <u>UNSEEN</u>

              Div. states: <u>CURRENT</u>, <u>FOUND</u>, <u>PERM</u>.

                  ::imap4::select $chan INBOX
                  puts "[::imap4::mboxinfo $chan exists] mails in INBOX"

       <b>::imap4::isableto</b> <u>chan</u> ?<u>capability</u>?

              Test  for  capability.   It  returns  1  if  requested  capability  is supported, 0 otherwise.  If
              <u>capability</u> is omitted all capability imap codes are retured as list.

              <u>chan</u> - imap channel

              <u>info</u> - imap keyword to retrieve

              <u>Note:</u> Use the capability command to ask the server if not already done by the user.

       <b>::imap4::create</b> <u>chan</u> <u>mailbox</u>

              Create a new mailbox.

              <u>chan</u> - imap channel

              <u>mailbox</u> - mailbox name

       <b>::imap4::delete</b> <u>chan</u> <u>mailbox</u>

              Delete a new mailbox.

              <u>chan</u> - imap channel

              <u>mailbox</u> - mailbox name

       <b>::imap4::rename</b> <u>chan</u> <u>oldname</u> <u>newname</u>

              Rename a new mailbox.

              <u>chan</u> - imap channel

              <u>mailbox</u> - old mailbox name

              <u>mailbox</u> - new mailbox name

       <b>::imap4::subscribe</b> <u>chan</u> <u>mailbox</u>

              Subscribe a new mailbox.

              <u>chan</u> - imap channel

              <u>mailbox</u> - mailbox name

       <b>::imap4::unsubscribe</b> <u>chan</u> <u>mailbox</u>

              Unsubscribe a new mailbox.

              <u>chan</u> - imap channel

              <u>mailbox</u> - mailbox name

       <b>::imap4::search</b> <u>chan</u> <u>expr</u> ?<u>...</u>?

              Search for mails matching search criterions, 0 is returned on success.

              <u>chan</u> - imap channel

              <u>expr</u> - imap search expression

              <u>Notes:</u> Currently the following search expressions are handled:

              <u>Mail</u> <u>header</u> <u>flags:</u> all mail header entries (ending with a colon ":"), like "From:", "Bcc:", ...

              <u>Imap</u> <u>message</u> <u>search</u> <u>flags:</u> ANSWERED, DELETED, DRAFT, FLAGGED, RECENT, SEEN, NEW, OLD,  UNANSWERED,
              UNDELETED, UNDRAFT, UNFLAGGED, UNSEEN, ALL

              <u>Imap</u> <u>header</u> <u>search</u> <u>flags:</u> BODY, CC, FROM, SUBJECT, TEXT, KEYWORD, BCC

              <u>Imap</u>  <u>conditional</u>  <u>search</u> <u>flags:</u> SMALLER, LARGER, ON, SENTBEFORE, SENTON, SENTSINCE, SINCE, BEFORE
              (not implemented), UID (not implemented)

              <u>Logical</u> <u>search</u> <u>conditions:</u> OR, NOT

              ::imap4::search $chan larger 4000 seen
              puts "Found messages: [::imap4::mboxinfo $chan found]"
              Found messages: 1 3 6 7 8 9 13 14 15 19 20

       <b>::imap4::close</b> <u>chan</u>

              Close the mailbox. Permanently removes \Deleted messages and return to the AUTH state.

              <u>chan</u> - imap channel

       <b>::imap4::cleanup</b> <u>chan</u>

              Destroy an IMAP connection and free the  used  space.   Close  the  mailbox.  Permanently  removes
              \Deleted messages and return to the AUTH state.

              <u>chan</u> - imap channel

       <b>::imap4::debugmode</b> <u>chan</u> ?<u>errormsg</u>?
              Switch client into command line debug mode.

              This is a developers mode only that pass the control to the programmer. Every line entered is sent
              verbatim  to  the  server  (after  the  addition  of  the request identifier).  The ::imap4::debug
              variable is automatically set to '1' on enter.

              It's possible to execute Tcl commands starting the line with a slash.

              <u>chan</u> - imap channel

              <u>errormsg</u> - optional error message to display

       <b>::imap4::store</b> <u>chan</u> <u>range</u> <u>data</u> <u>flaglist</u>

              Alters data associated with a message in the selected mailbox.

              <u>chan</u> - imap channel

              <u>range</u> - message index in format <u>FROM</u>:<u>TO</u>

              <u>flaglist</u> - Flags the <u>data</u> operates on.

              <u>data</u> - The currently defined <u>data</u> items that can be stored are shown below. <u>Note</u> that all of these
              data types may also be suffixed with ".SILENT" to suppress the untagged FETCH response.

              FLAGS  Replace the flags for the message (other than \Recent) with the <u>flaglist</u>.

              +FLAGS Add the flags in <u>flaglist</u> to the existing flags for the message.

              -FLAGS Remove the flags in <u>flaglist</u> to the existing flags for the message.

              For example:

                ::imap4::store $chan $start_msgid:$end_msgid +FLAGS "Deleted"

       <b>::imap4::expunge</b> <u>chan</u>

              Permanently removes all messages that have the \Deleted  flag  set  from  the  currently  selected
              mailbox, without the need to close the connection.

              <u>chan</u> - imap channel

       <b>::imap4::copy</b> <u>chan</u> <u>msgid</u> <u>mailbox</u>

              Copies  the  specified  message (identified by its message number) to the named mailbox, i.e. imap
              folder.

              <u>chan</u> - imap channel

              <u>msgid</u> - message number

              <u>mailbox</u> - mailbox name

       <b>::imap4::logout</b> <u>chan</u>

              Informs the server that the client is done with the connection and closes the network  connection.
              Permanently removes \Deleted messages.

              A new connection will need to be established to login once more.

              <u>chan</u> - imap channel

</pre><h4><b>EXAMPLES</b></h4><pre>
                  set user myusername
                  set pass xtremescrt
                  set server imap.test.tld
                  set FOLDER INBOX
                  # Connect to server
                  set imap [::imap4::open $server]
                  ::imap4::login $imap $user $pass
                  ::imap4::select $imap $FOLDER
                  # Output all the information about that mailbox
                  foreach info [::imap4::mboxinfo $imap] {
                      puts "$info -&gt; [::imap4::mboxinfo $imap $info]"
                  }
                  # fetch 3 records inline
                  set fields {from: to: subject: size}
                  foreach rec [::imap4::fetch $imap :3 -inline {*}$fields] {
                      puts -nonewline "#[incr idx])"
                      for {set j 0} {$j&lt;[llength $fields]} {incr j} {
                          puts "\t[lindex $fields $j] [lindex $rec $j]"
                      }
                  }

                  # Show all the information available about the message ID 1
                  puts "Available info about message 1: [::imap4::msginfo $imap 1]"

                  # Use the capability stuff
                  puts "Capabilities: [::imap4::isableto $imap]"
                  puts "Is able to imap4rev1? [::imap4::isableto $imap imap4rev1]"

                  # Cleanup
                  ::imap4::cleanup $imap

</pre><h4><b>TLS</b> <b>SECURITY</b> <b>CONSIDERATIONS</b></h4><pre>
       This package uses the <b>TLS</b> package to handle the security for <b>https</b> urls and other socket connections.

       Policy  decisions like the set of protocols to support and what ciphers to use are not the responsibility
       of <b>TLS</b>, nor of this  package  itself  however.   Such  decisions  are  the  responsibility  of  whichever
       application  is  using  the package, and are likely influenced by the set of servers the application will
       talk to as well.

       For        example,        in        light        of        the        recent        <u>POODLE</u>        <u>attack</u>
       [<a href="http://googleonlinesecurity.blogspot.co.uk/2014/10/this-poodle-bites-exploiting-ssl-30.html">http://googleonlinesecurity.blogspot.co.uk/2014/10/this-poodle-bites-exploiting-ssl-30.html</a>]  discovered
       by Google many servers will  disable  support  for  the  SSLv3  protocol.   To  handle  this  change  the
       applications  using  <b>TLS</b>  must  be patched, and not this package, nor <b>TLS</b> itself.  Such a patch may be as
       simple as generally activating <b>tls1</b> support, as shown in the example below.

                  package require tls
                  tls::init -tls1 1 ;# forcibly activate support for the TLS1 protocol

                  ... your own application code ...

</pre><h4><b>REFERENCES</b></h4><pre>
       Mark  R.  Crispin,  "INTERNET  MESSAGE  ACCESS  PROTOCOL  -  VERSION  4rev1",  RFC  3501,   March   2003,
       <u><a href="http://www.rfc-editor.org/rfc/rfc3501.txt">http://www.rfc-editor.org/rfc/rfc3501.txt</a></u>

       OpenSSL, <u><a href="http://www.openssl.org/">http://www.openssl.org/</a></u>

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This  document,  and  the package it describes, will undoubtedly contain bugs and other problems.  Please
       report such in the category <u>imap4</u> of the <u>Tcllib</u> <u>Trackers</u> [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].   Please
       also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note  further  that  <u>attachments</u>  are strongly preferred over inlined patches. Attachments can be made by
       going to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most  button
       in the secondary navigation bar.  Only a small part of rfc3501 implemented.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       ftp, http, imap, mime, pop3, tls

</pre><h4><b>KEYWORDS</b></h4><pre>
       email, imap, internet, mail, net, rfc3501, ssl, tls

</pre><h4><b>CATEGORY</b></h4><pre>
       Networking

tcllib                                                0.5.5                                          <u><a href="../man3tcl/imap4.3tcl.html">imap4</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>