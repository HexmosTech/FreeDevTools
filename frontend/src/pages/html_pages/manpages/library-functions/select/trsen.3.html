<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>trsen - trsen: reorder Schur form</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/liblapack-doc">liblapack-doc_3.12.1-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       trsen - trsen: reorder Schur form

</pre><h4><b>SYNOPSIS</b></h4><pre>
   <b>Functions</b>
       subroutine <b>ctrsen</b> (job, compq, select, n, t, ldt, q, ldq, w, m, s, sep, work, lwork, info)
           <b>CTRSEN</b>
       subroutine <b>dtrsen</b> (job, compq, select, n, t, ldt, q, ldq, wr, wi, m, s, sep, work, lwork, iwork, liwork,
           info)
           <b>DTRSEN</b>
       subroutine <b>strsen</b> (job, compq, select, n, t, ldt, q, ldq, wr, wi, m, s, sep, work, lwork, iwork, liwork,
           info)
           <b>STRSEN</b>
       subroutine <b>ztrsen</b> (job, compq, select, n, t, ldt, q, ldq, w, m, s, sep, work, lwork, info)
           <b>ZTRSEN</b>

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
</pre><h4><b>Function</b> <b>Documentation</b></h4><pre>
   <b>subroutine</b> <b>ctrsen</b> <b>(character</b> <b>job,</b> <b>character</b> <b>compq,</b> <b>logical,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>select,</b> <b>integer</b> <b>n,</b> <b>complex,</b>
       <b>dimension(</b> <b>ldt,</b> <b>*</b> <b>)</b> <b>t,</b> <b>integer</b> <b>ldt,</b> <b>complex,</b> <b>dimension(</b> <b>ldq,</b> <b>*</b> <b>)</b> <b>q,</b> <b>integer</b> <b>ldq,</b> <b>complex,</b> <b>dimension(</b> <b>*</b> <b>)</b>
       <b>w,</b> <b>integer</b> <b>m,</b> <b>real</b> <b>s,</b> <b>real</b> <b>sep,</b> <b>complex,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>work,</b> <b>integer</b> <b>lwork,</b> <b>integer</b> <b>info)</b>
       <b>CTRSEN</b>

       <b>Purpose:</b>

            CTRSEN reorders the Schur factorization of a complex matrix
            A = Q*T*Q**H, so that a selected cluster of eigenvalues appears in
            the leading positions on the diagonal of the upper triangular matrix
            T, and the leading columns of Q form an orthonormal basis of the
            corresponding right invariant subspace.

            Optionally the routine computes the reciprocal condition numbers of
            the cluster of eigenvalues and/or the invariant subspace.

       <b>Parameters</b>
           <u>JOB</u>

                     JOB is CHARACTER*1
                     Specifies whether condition numbers are required for the
                     cluster of eigenvalues (S) or the invariant subspace (SEP):
                     = 'N': none;
                     = 'E': for eigenvalues only (S);
                     = 'V': for invariant subspace only (SEP);
                     = 'B': for both eigenvalues and invariant subspace (S and
                            SEP).

           <u>COMPQ</u>

                     COMPQ is CHARACTER*1
                     = 'V': update the matrix Q of Schur vectors;
                     = 'N': do not update Q.

           <u>SELECT</u>

                     SELECT is LOGICAL array, dimension (N)
                     SELECT specifies the eigenvalues in the selected cluster. To
                     select the j-th eigenvalue, SELECT(j) must be set to .TRUE..

           <u>N</u>

                     N is INTEGER
                     The order of the matrix T. N &gt;= 0.

           <u>T</u>

                     T is COMPLEX array, dimension (LDT,N)
                     On entry, the upper triangular matrix T.
                     On exit, T is overwritten by the reordered matrix T, with the
                     selected eigenvalues as the leading diagonal elements.

           <u>LDT</u>

                     LDT is INTEGER
                     The leading dimension of the array T. LDT &gt;= max(1,N).

           <u>Q</u>

                     Q is COMPLEX array, dimension (LDQ,N)
                     On entry, if COMPQ = 'V', the matrix Q of Schur vectors.
                     On exit, if COMPQ = 'V', Q has been postmultiplied by the
                     unitary transformation matrix which reorders T; the leading M
                     columns of Q form an orthonormal basis for the specified
                     invariant subspace.
                     If COMPQ = 'N', Q is not referenced.

           <u>LDQ</u>

                     LDQ is INTEGER
                     The leading dimension of the array Q.
                     LDQ &gt;= 1; and if COMPQ = 'V', LDQ &gt;= N.

           <u>W</u>

                     W is COMPLEX array, dimension (N)
                     The reordered eigenvalues of T, in the same order as they
                     appear on the diagonal of T.

           <u>M</u>

                     M is INTEGER
                     The dimension of the specified invariant subspace.
                     0 &lt;= M &lt;= N.

           <u>S</u>

                     S is REAL
                     If JOB = 'E' or 'B', S is a lower bound on the reciprocal
                     condition number for the selected cluster of eigenvalues.
                     S cannot underestimate the true reciprocal condition number
                     by more than a factor of sqrt(N). If M = 0 or N, S = 1.
                     If JOB = 'N' or 'V', S is not referenced.

           <u>SEP</u>

                     SEP is REAL
                     If JOB = 'V' or 'B', SEP is the estimated reciprocal
                     condition number of the specified invariant subspace. If
                     M = 0 or N, SEP = norm(T).
                     If JOB = 'N' or 'E', SEP is not referenced.

           <u>WORK</u>

                     WORK is COMPLEX array, dimension (MAX(1,LWORK))
                     On exit, if INFO = 0, <a href="../man1/WORK.1.html">WORK</a>(1) returns the optimal LWORK.

           <u>LWORK</u>

                     LWORK is INTEGER
                     The dimension of the array WORK.
                     If JOB = 'N', LWORK &gt;= 1;
                     if JOB = 'E', LWORK = max(1,M*(N-M));
                     if JOB = 'V' or 'B', LWORK &gt;= max(1,2*M*(N-M)).

                     If LWORK = -1, then a workspace query is assumed; the routine
                     only calculates the optimal size of the WORK array, returns
                     this value as the first entry of the WORK array, and no error
                     message related to LWORK is issued by XERBLA.

           <u>INFO</u>

                     INFO is INTEGER
                     = 0:  successful exit
                     &lt; 0:  if INFO = -i, the i-th argument had an illegal value

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

             CTRSEN first collects the selected eigenvalues by computing a unitary
             transformation Z to move them to the top left corner of T. In other
             words, the selected eigenvalues are the eigenvalues of T11 in:

                     Z**H * T * Z = ( T11 T12 ) n1
                                    (  0  T22 ) n2
                                       n1  n2

             where N = n1+n2. The first
             n1 columns of Z span the specified invariant subspace of T.

             If T has been obtained from the Schur factorization of a matrix
             A = Q*T*Q**H, then the reordered Schur factorization of A is given by
             A = (Q*Z)*(Z**H*T*Z)*(Q*Z)**H, and the first n1 columns of Q*Z span the
             corresponding invariant subspace of A.

             The reciprocal condition number of the average of the eigenvalues of
             T11 may be returned in S. S lies between 0 (very badly conditioned)
             and 1 (very well conditioned). It is computed as follows. First we
             compute R so that

                                    P = ( I  R ) n1
                                        ( 0  0 ) n2
                                          n1 n2

             is the projector on the invariant subspace associated with T11.
             R is the solution of the Sylvester equation:

                                   T11*R - R*T22 = T12.

             Let F-norm(M) denote the Frobenius-norm of M and 2-norm(M) denote
             the two-norm of M. Then S is computed as the lower bound

                                 (1 + F-norm(R)**2)**(-1/2)

             on the reciprocal of 2-norm(P), the true reciprocal condition number.
             S cannot underestimate 1 / 2-norm(P) by more than a factor of
             sqrt(N).

             An approximate error bound for the computed average of the
             eigenvalues of T11 is

                                    EPS * norm(T) / S

             where EPS is the machine precision.

             The reciprocal condition number of the right invariant subspace
             spanned by the first n1 columns of Z (or of Q*Z) is returned in SEP.
             SEP is defined as the separation of T11 and T22:

                                sep( T11, T22 ) = sigma-min( C )

             where sigma-min(C) is the smallest singular value of the
             n1*n2-by-n1*n2 matrix

                C  = kprod( I(n2), T11 ) - kprod( transpose(T22), I(n1) )

             <a href="../manm/I.m.html">I</a>(m) is an m by m identity matrix, and kprod denotes the Kronecker
             product. We estimate sigma-min(C) by the reciprocal of an estimate of
             the 1-norm of inverse(C). The true reciprocal 1-norm of inverse(C)
             cannot differ from sigma-min(C) by more than a factor of sqrt(n1*n2).

             When SEP is small, small changes in T can cause large changes in
             the invariant subspace. An approximate bound on the maximum angular
             error in the computed right invariant subspace is

                                 EPS * norm(T) / SEP

   <b>subroutine</b> <b>dtrsen</b> <b>(character</b> <b>job,</b> <b>character</b> <b>compq,</b> <b>logical,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>select,</b> <b>integer</b> <b>n,</b> <b>double</b>
       <b>precision,</b> <b>dimension(</b> <b>ldt,</b> <b>*</b> <b>)</b> <b>t,</b> <b>integer</b> <b>ldt,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>ldq,</b> <b>*</b> <b>)</b> <b>q,</b> <b>integer</b> <b>ldq,</b>
       <b>double</b> <b>precision,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>wr,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>wi,</b> <b>integer</b> <b>m,</b> <b>double</b> <b>precision</b> <b>s,</b>
       <b>double</b> <b>precision</b> <b>sep,</b> <b>double</b> <b>precision,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>work,</b> <b>integer</b> <b>lwork,</b> <b>integer,</b> <b>dimension(</b> <b>*</b> <b>)</b>
       <b>iwork,</b> <b>integer</b> <b>liwork,</b> <b>integer</b> <b>info)</b>
       <b>DTRSEN</b>

       <b>Purpose:</b>

            DTRSEN reorders the real Schur factorization of a real matrix
            A = Q*T*Q**T, so that a selected cluster of eigenvalues appears in
            the leading diagonal blocks of the upper quasi-triangular matrix T,
            and the leading columns of Q form an orthonormal basis of the
            corresponding right invariant subspace.

            Optionally the routine computes the reciprocal condition numbers of
            the cluster of eigenvalues and/or the invariant subspace.

            T must be in Schur canonical form (as returned by DHSEQR), that is,
            block upper triangular with 1-by-1 and 2-by-2 diagonal blocks; each
            2-by-2 diagonal block has its diagonal elements equal and its
            off-diagonal elements of opposite sign.

       <b>Parameters</b>
           <u>JOB</u>

                     JOB is CHARACTER*1
                     Specifies whether condition numbers are required for the
                     cluster of eigenvalues (S) or the invariant subspace (SEP):
                     = 'N': none;
                     = 'E': for eigenvalues only (S);
                     = 'V': for invariant subspace only (SEP);
                     = 'B': for both eigenvalues and invariant subspace (S and
                            SEP).

           <u>COMPQ</u>

                     COMPQ is CHARACTER*1
                     = 'V': update the matrix Q of Schur vectors;
                     = 'N': do not update Q.

           <u>SELECT</u>

                     SELECT is LOGICAL array, dimension (N)
                     SELECT specifies the eigenvalues in the selected cluster. To
                     select a real eigenvalue w(j), SELECT(j) must be set to
                     .TRUE.. To select a complex conjugate pair of eigenvalues
                     w(j) and w(j+1), corresponding to a 2-by-2 diagonal block,
                     either SELECT(j) or SELECT(j+1) or both must be set to
                     .TRUE.; a complex conjugate pair of eigenvalues must be
                     either both included in the cluster or both excluded.

           <u>N</u>

                     N is INTEGER
                     The order of the matrix T. N &gt;= 0.

           <u>T</u>

                     T is DOUBLE PRECISION array, dimension (LDT,N)
                     On entry, the upper quasi-triangular matrix T, in Schur
                     canonical form.
                     On exit, T is overwritten by the reordered matrix T, again in
                     Schur canonical form, with the selected eigenvalues in the
                     leading diagonal blocks.

           <u>LDT</u>

                     LDT is INTEGER
                     The leading dimension of the array T. LDT &gt;= max(1,N).

           <u>Q</u>

                     Q is DOUBLE PRECISION array, dimension (LDQ,N)
                     On entry, if COMPQ = 'V', the matrix Q of Schur vectors.
                     On exit, if COMPQ = 'V', Q has been postmultiplied by the
                     orthogonal transformation matrix which reorders T; the
                     leading M columns of Q form an orthonormal basis for the
                     specified invariant subspace.
                     If COMPQ = 'N', Q is not referenced.

           <u>LDQ</u>

                     LDQ is INTEGER
                     The leading dimension of the array Q.
                     LDQ &gt;= 1; and if COMPQ = 'V', LDQ &gt;= N.

           <u>WR</u>

                     WR is DOUBLE PRECISION array, dimension (N)

           <u>WI</u>

                     WI is DOUBLE PRECISION array, dimension (N)

                     The real and imaginary parts, respectively, of the reordered
                     eigenvalues of T. The eigenvalues are stored in the same
                     order as on the diagonal of T, with WR(i) = T(i,i) and, if
                     T(i:i+1,i:i+1) is a 2-by-2 diagonal block, WI(i) &gt; 0 and
                     WI(i+1) = -WI(i). Note that if a complex eigenvalue is
                     sufficiently ill-conditioned, then its value may differ
                     significantly from its value before reordering.

           <u>M</u>

                     M is INTEGER
                     The dimension of the specified invariant subspace.
                     0 &lt; = M &lt;= N.

           <u>S</u>

                     S is DOUBLE PRECISION
                     If JOB = 'E' or 'B', S is a lower bound on the reciprocal
                     condition number for the selected cluster of eigenvalues.
                     S cannot underestimate the true reciprocal condition number
                     by more than a factor of sqrt(N). If M = 0 or N, S = 1.
                     If JOB = 'N' or 'V', S is not referenced.

           <u>SEP</u>

                     SEP is DOUBLE PRECISION
                     If JOB = 'V' or 'B', SEP is the estimated reciprocal
                     condition number of the specified invariant subspace. If
                     M = 0 or N, SEP = norm(T).
                     If JOB = 'N' or 'E', SEP is not referenced.

           <u>WORK</u>

                     WORK is DOUBLE PRECISION array, dimension (MAX(1,LWORK))
                     On exit, if INFO = 0, <a href="../man1/WORK.1.html">WORK</a>(1) returns the optimal LWORK.

           <u>LWORK</u>

                     LWORK is INTEGER
                     The dimension of the array WORK.
                     If JOB = 'N', LWORK &gt;= max(1,N);
                     if JOB = 'E', LWORK &gt;= max(1,M*(N-M));
                     if JOB = 'V' or 'B', LWORK &gt;= max(1,2*M*(N-M)).

                     If LWORK = -1, then a workspace query is assumed; the routine
                     only calculates the optimal size of the WORK array, returns
                     this value as the first entry of the WORK array, and no error
                     message related to LWORK is issued by XERBLA.

           <u>IWORK</u>

                     IWORK is INTEGER array, dimension (MAX(1,LIWORK))
                     On exit, if INFO = 0, <a href="../man1/IWORK.1.html">IWORK</a>(1) returns the optimal LIWORK.

           <u>LIWORK</u>

                     LIWORK is INTEGER
                     The dimension of the array IWORK.
                     If JOB = 'N' or 'E', LIWORK &gt;= 1;
                     if JOB = 'V' or 'B', LIWORK &gt;= max(1,M*(N-M)).

                     If LIWORK = -1, then a workspace query is assumed; the
                     routine only calculates the optimal size of the IWORK array,
                     returns this value as the first entry of the IWORK array, and
                     no error message related to LIWORK is issued by XERBLA.

           <u>INFO</u>

                     INFO is INTEGER
                     = 0: successful exit
                     &lt; 0: if INFO = -i, the i-th argument had an illegal value
                     = 1: reordering of T failed because some eigenvalues are too
                          close to separate (the problem is very ill-conditioned);
                          T may have been partially reordered, and WR and WI
                          contain the eigenvalues in the same order as in T; S and
                          SEP (if requested) are set to zero.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

             DTRSEN first collects the selected eigenvalues by computing an
             orthogonal transformation Z to move them to the top left corner of T.
             In other words, the selected eigenvalues are the eigenvalues of T11
             in:

                     Z**T * T * Z = ( T11 T12 ) n1
                                    (  0  T22 ) n2
                                       n1  n2

             where N = n1+n2 and Z**T means the transpose of Z. The first n1 columns
             of Z span the specified invariant subspace of T.

             If T has been obtained from the real Schur factorization of a matrix
             A = Q*T*Q**T, then the reordered real Schur factorization of A is given
             by A = (Q*Z)*(Z**T*T*Z)*(Q*Z)**T, and the first n1 columns of Q*Z span
             the corresponding invariant subspace of A.

             The reciprocal condition number of the average of the eigenvalues of
             T11 may be returned in S. S lies between 0 (very badly conditioned)
             and 1 (very well conditioned). It is computed as follows. First we
             compute R so that

                                    P = ( I  R ) n1
                                        ( 0  0 ) n2
                                          n1 n2

             is the projector on the invariant subspace associated with T11.
             R is the solution of the Sylvester equation:

                                   T11*R - R*T22 = T12.

             Let F-norm(M) denote the Frobenius-norm of M and 2-norm(M) denote
             the two-norm of M. Then S is computed as the lower bound

                                 (1 + F-norm(R)**2)**(-1/2)

             on the reciprocal of 2-norm(P), the true reciprocal condition number.
             S cannot underestimate 1 / 2-norm(P) by more than a factor of
             sqrt(N).

             An approximate error bound for the computed average of the
             eigenvalues of T11 is

                                    EPS * norm(T) / S

             where EPS is the machine precision.

             The reciprocal condition number of the right invariant subspace
             spanned by the first n1 columns of Z (or of Q*Z) is returned in SEP.
             SEP is defined as the separation of T11 and T22:

                                sep( T11, T22 ) = sigma-min( C )

             where sigma-min(C) is the smallest singular value of the
             n1*n2-by-n1*n2 matrix

                C  = kprod( I(n2), T11 ) - kprod( transpose(T22), I(n1) )

             <a href="../manm/I.m.html">I</a>(m) is an m by m identity matrix, and kprod denotes the Kronecker
             product. We estimate sigma-min(C) by the reciprocal of an estimate of
             the 1-norm of inverse(C). The true reciprocal 1-norm of inverse(C)
             cannot differ from sigma-min(C) by more than a factor of sqrt(n1*n2).

             When SEP is small, small changes in T can cause large changes in
             the invariant subspace. An approximate bound on the maximum angular
             error in the computed right invariant subspace is

                                 EPS * norm(T) / SEP

   <b>subroutine</b> <b>strsen</b> <b>(character</b> <b>job,</b> <b>character</b> <b>compq,</b> <b>logical,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>select,</b> <b>integer</b> <b>n,</b> <b>real,</b>
       <b>dimension(</b> <b>ldt,</b> <b>*</b> <b>)</b> <b>t,</b> <b>integer</b> <b>ldt,</b> <b>real,</b> <b>dimension(</b> <b>ldq,</b> <b>*</b> <b>)</b> <b>q,</b> <b>integer</b> <b>ldq,</b> <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>wr,</b>
       <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>wi,</b> <b>integer</b> <b>m,</b> <b>real</b> <b>s,</b> <b>real</b> <b>sep,</b> <b>real,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>work,</b> <b>integer</b> <b>lwork,</b> <b>integer,</b>
       <b>dimension(</b> <b>*</b> <b>)</b> <b>iwork,</b> <b>integer</b> <b>liwork,</b> <b>integer</b> <b>info)</b>
       <b>STRSEN</b>

       <b>Purpose:</b>

            STRSEN reorders the real Schur factorization of a real matrix
            A = Q*T*Q**T, so that a selected cluster of eigenvalues appears in
            the leading diagonal blocks of the upper quasi-triangular matrix T,
            and the leading columns of Q form an orthonormal basis of the
            corresponding right invariant subspace.

            Optionally the routine computes the reciprocal condition numbers of
            the cluster of eigenvalues and/or the invariant subspace.

            T must be in Schur canonical form (as returned by SHSEQR), that is,
            block upper triangular with 1-by-1 and 2-by-2 diagonal blocks; each
            2-by-2 diagonal block has its diagonal elements equal and its
            off-diagonal elements of opposite sign.

       <b>Parameters</b>
           <u>JOB</u>

                     JOB is CHARACTER*1
                     Specifies whether condition numbers are required for the
                     cluster of eigenvalues (S) or the invariant subspace (SEP):
                     = 'N': none;
                     = 'E': for eigenvalues only (S);
                     = 'V': for invariant subspace only (SEP);
                     = 'B': for both eigenvalues and invariant subspace (S and
                            SEP).

           <u>COMPQ</u>

                     COMPQ is CHARACTER*1
                     = 'V': update the matrix Q of Schur vectors;
                     = 'N': do not update Q.

           <u>SELECT</u>

                     SELECT is LOGICAL array, dimension (N)
                     SELECT specifies the eigenvalues in the selected cluster. To
                     select a real eigenvalue w(j), SELECT(j) must be set to
                     .TRUE.. To select a complex conjugate pair of eigenvalues
                     w(j) and w(j+1), corresponding to a 2-by-2 diagonal block,
                     either SELECT(j) or SELECT(j+1) or both must be set to
                     .TRUE.; a complex conjugate pair of eigenvalues must be
                     either both included in the cluster or both excluded.

           <u>N</u>

                     N is INTEGER
                     The order of the matrix T. N &gt;= 0.

           <u>T</u>

                     T is REAL array, dimension (LDT,N)
                     On entry, the upper quasi-triangular matrix T, in Schur
                     canonical form.
                     On exit, T is overwritten by the reordered matrix T, again in
                     Schur canonical form, with the selected eigenvalues in the
                     leading diagonal blocks.

           <u>LDT</u>

                     LDT is INTEGER
                     The leading dimension of the array T. LDT &gt;= max(1,N).

           <u>Q</u>

                     Q is REAL array, dimension (LDQ,N)
                     On entry, if COMPQ = 'V', the matrix Q of Schur vectors.
                     On exit, if COMPQ = 'V', Q has been postmultiplied by the
                     orthogonal transformation matrix which reorders T; the
                     leading M columns of Q form an orthonormal basis for the
                     specified invariant subspace.
                     If COMPQ = 'N', Q is not referenced.

           <u>LDQ</u>

                     LDQ is INTEGER
                     The leading dimension of the array Q.
                     LDQ &gt;= 1; and if COMPQ = 'V', LDQ &gt;= N.

           <u>WR</u>

                     WR is REAL array, dimension (N)

           <u>WI</u>

                     WI is REAL array, dimension (N)

                     The real and imaginary parts, respectively, of the reordered
                     eigenvalues of T. The eigenvalues are stored in the same
                     order as on the diagonal of T, with WR(i) = T(i,i) and, if
                     T(i:i+1,i:i+1) is a 2-by-2 diagonal block, WI(i) &gt; 0 and
                     WI(i+1) = -WI(i). Note that if a complex eigenvalue is
                     sufficiently ill-conditioned, then its value may differ
                     significantly from its value before reordering.

           <u>M</u>

                     M is INTEGER
                     The dimension of the specified invariant subspace.
                     0 &lt; = M &lt;= N.

           <u>S</u>

                     S is REAL
                     If JOB = 'E' or 'B', S is a lower bound on the reciprocal
                     condition number for the selected cluster of eigenvalues.
                     S cannot underestimate the true reciprocal condition number
                     by more than a factor of sqrt(N). If M = 0 or N, S = 1.
                     If JOB = 'N' or 'V', S is not referenced.

           <u>SEP</u>

                     SEP is REAL
                     If JOB = 'V' or 'B', SEP is the estimated reciprocal
                     condition number of the specified invariant subspace. If
                     M = 0 or N, SEP = norm(T).
                     If JOB = 'N' or 'E', SEP is not referenced.

           <u>WORK</u>

                     WORK is REAL array, dimension (MAX(1,LWORK))
                     On exit, if INFO = 0, <a href="../man1/WORK.1.html">WORK</a>(1) returns the optimal LWORK.

           <u>LWORK</u>

                     LWORK is INTEGER
                     The dimension of the array WORK.
                     If JOB = 'N', LWORK &gt;= max(1,N);
                     if JOB = 'E', LWORK &gt;= max(1,M*(N-M));
                     if JOB = 'V' or 'B', LWORK &gt;= max(1,2*M*(N-M)).

                     If LWORK = -1, then a workspace query is assumed; the routine
                     only calculates the optimal size of the WORK array, returns
                     this value as the first entry of the WORK array, and no error
                     message related to LWORK is issued by XERBLA.

           <u>IWORK</u>

                     IWORK is INTEGER array, dimension (MAX(1,LIWORK))
                     On exit, if INFO = 0, <a href="../man1/IWORK.1.html">IWORK</a>(1) returns the optimal LIWORK.

           <u>LIWORK</u>

                     LIWORK is INTEGER
                     The dimension of the array IWORK.
                     If JOB = 'N' or 'E', LIWORK &gt;= 1;
                     if JOB = 'V' or 'B', LIWORK &gt;= max(1,M*(N-M)).

                     If LIWORK = -1, then a workspace query is assumed; the
                     routine only calculates the optimal size of the IWORK array,
                     returns this value as the first entry of the IWORK array, and
                     no error message related to LIWORK is issued by XERBLA.

           <u>INFO</u>

                     INFO is INTEGER
                     = 0: successful exit
                     &lt; 0: if INFO = -i, the i-th argument had an illegal value
                     = 1: reordering of T failed because some eigenvalues are too
                          close to separate (the problem is very ill-conditioned);
                          T may have been partially reordered, and WR and WI
                          contain the eigenvalues in the same order as in T; S and
                          SEP (if requested) are set to zero.

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

             STRSEN first collects the selected eigenvalues by computing an
             orthogonal transformation Z to move them to the top left corner of T.
             In other words, the selected eigenvalues are the eigenvalues of T11
             in:

                     Z**T * T * Z = ( T11 T12 ) n1
                                    (  0  T22 ) n2
                                       n1  n2

             where N = n1+n2 and Z**T means the transpose of Z. The first n1 columns
             of Z span the specified invariant subspace of T.

             If T has been obtained from the real Schur factorization of a matrix
             A = Q*T*Q**T, then the reordered real Schur factorization of A is given
             by A = (Q*Z)*(Z**T*T*Z)*(Q*Z)**T, and the first n1 columns of Q*Z span
             the corresponding invariant subspace of A.

             The reciprocal condition number of the average of the eigenvalues of
             T11 may be returned in S. S lies between 0 (very badly conditioned)
             and 1 (very well conditioned). It is computed as follows. First we
             compute R so that

                                    P = ( I  R ) n1
                                        ( 0  0 ) n2
                                          n1 n2

             is the projector on the invariant subspace associated with T11.
             R is the solution of the Sylvester equation:

                                   T11*R - R*T22 = T12.

             Let F-norm(M) denote the Frobenius-norm of M and 2-norm(M) denote
             the two-norm of M. Then S is computed as the lower bound

                                 (1 + F-norm(R)**2)**(-1/2)

             on the reciprocal of 2-norm(P), the true reciprocal condition number.
             S cannot underestimate 1 / 2-norm(P) by more than a factor of
             sqrt(N).

             An approximate error bound for the computed average of the
             eigenvalues of T11 is

                                    EPS * norm(T) / S

             where EPS is the machine precision.

             The reciprocal condition number of the right invariant subspace
             spanned by the first n1 columns of Z (or of Q*Z) is returned in SEP.
             SEP is defined as the separation of T11 and T22:

                                sep( T11, T22 ) = sigma-min( C )

             where sigma-min(C) is the smallest singular value of the
             n1*n2-by-n1*n2 matrix

                C  = kprod( I(n2), T11 ) - kprod( transpose(T22), I(n1) )

             <a href="../manm/I.m.html">I</a>(m) is an m by m identity matrix, and kprod denotes the Kronecker
             product. We estimate sigma-min(C) by the reciprocal of an estimate of
             the 1-norm of inverse(C). The true reciprocal 1-norm of inverse(C)
             cannot differ from sigma-min(C) by more than a factor of sqrt(n1*n2).

             When SEP is small, small changes in T can cause large changes in
             the invariant subspace. An approximate bound on the maximum angular
             error in the computed right invariant subspace is

                                 EPS * norm(T) / SEP

   <b>subroutine</b> <b>ztrsen</b> <b>(character</b> <b>job,</b> <b>character</b> <b>compq,</b> <b>logical,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>select,</b> <b>integer</b> <b>n,</b> <b>complex*16,</b>
       <b>dimension(</b> <b>ldt,</b> <b>*</b> <b>)</b> <b>t,</b> <b>integer</b> <b>ldt,</b> <b>complex*16,</b> <b>dimension(</b> <b>ldq,</b> <b>*</b> <b>)</b> <b>q,</b> <b>integer</b> <b>ldq,</b> <b>complex*16,</b>
       <b>dimension(</b> <b>*</b> <b>)</b> <b>w,</b> <b>integer</b> <b>m,</b> <b>double</b> <b>precision</b> <b>s,</b> <b>double</b> <b>precision</b> <b>sep,</b> <b>complex*16,</b> <b>dimension(</b> <b>*</b> <b>)</b> <b>work,</b>
       <b>integer</b> <b>lwork,</b> <b>integer</b> <b>info)</b>
       <b>ZTRSEN</b>

       <b>Purpose:</b>

            ZTRSEN reorders the Schur factorization of a complex matrix
            A = Q*T*Q**H, so that a selected cluster of eigenvalues appears in
            the leading positions on the diagonal of the upper triangular matrix
            T, and the leading columns of Q form an orthonormal basis of the
            corresponding right invariant subspace.

            Optionally the routine computes the reciprocal condition numbers of
            the cluster of eigenvalues and/or the invariant subspace.

       <b>Parameters</b>
           <u>JOB</u>

                     JOB is CHARACTER*1
                     Specifies whether condition numbers are required for the
                     cluster of eigenvalues (S) or the invariant subspace (SEP):
                     = 'N': none;
                     = 'E': for eigenvalues only (S);
                     = 'V': for invariant subspace only (SEP);
                     = 'B': for both eigenvalues and invariant subspace (S and
                            SEP).

           <u>COMPQ</u>

                     COMPQ is CHARACTER*1
                     = 'V': update the matrix Q of Schur vectors;
                     = 'N': do not update Q.

           <u>SELECT</u>

                     SELECT is LOGICAL array, dimension (N)
                     SELECT specifies the eigenvalues in the selected cluster. To
                     select the j-th eigenvalue, SELECT(j) must be set to .TRUE..

           <u>N</u>

                     N is INTEGER
                     The order of the matrix T. N &gt;= 0.

           <u>T</u>

                     T is COMPLEX*16 array, dimension (LDT,N)
                     On entry, the upper triangular matrix T.
                     On exit, T is overwritten by the reordered matrix T, with the
                     selected eigenvalues as the leading diagonal elements.

           <u>LDT</u>

                     LDT is INTEGER
                     The leading dimension of the array T. LDT &gt;= max(1,N).

           <u>Q</u>

                     Q is COMPLEX*16 array, dimension (LDQ,N)
                     On entry, if COMPQ = 'V', the matrix Q of Schur vectors.
                     On exit, if COMPQ = 'V', Q has been postmultiplied by the
                     unitary transformation matrix which reorders T; the leading M
                     columns of Q form an orthonormal basis for the specified
                     invariant subspace.
                     If COMPQ = 'N', Q is not referenced.

           <u>LDQ</u>

                     LDQ is INTEGER
                     The leading dimension of the array Q.
                     LDQ &gt;= 1; and if COMPQ = 'V', LDQ &gt;= N.

           <u>W</u>

                     W is COMPLEX*16 array, dimension (N)
                     The reordered eigenvalues of T, in the same order as they
                     appear on the diagonal of T.

           <u>M</u>

                     M is INTEGER
                     The dimension of the specified invariant subspace.
                     0 &lt;= M &lt;= N.

           <u>S</u>

                     S is DOUBLE PRECISION
                     If JOB = 'E' or 'B', S is a lower bound on the reciprocal
                     condition number for the selected cluster of eigenvalues.
                     S cannot underestimate the true reciprocal condition number
                     by more than a factor of sqrt(N). If M = 0 or N, S = 1.
                     If JOB = 'N' or 'V', S is not referenced.

           <u>SEP</u>

                     SEP is DOUBLE PRECISION
                     If JOB = 'V' or 'B', SEP is the estimated reciprocal
                     condition number of the specified invariant subspace. If
                     M = 0 or N, SEP = norm(T).
                     If JOB = 'N' or 'E', SEP is not referenced.

           <u>WORK</u>

                     WORK is COMPLEX*16 array, dimension (MAX(1,LWORK))
                     On exit, if INFO = 0, <a href="../man1/WORK.1.html">WORK</a>(1) returns the optimal LWORK.

           <u>LWORK</u>

                     LWORK is INTEGER
                     The dimension of the array WORK.
                     If JOB = 'N', LWORK &gt;= 1;
                     if JOB = 'E', LWORK = max(1,M*(N-M));
                     if JOB = 'V' or 'B', LWORK &gt;= max(1,2*M*(N-M)).

                     If LWORK = -1, then a workspace query is assumed; the routine
                     only calculates the optimal size of the WORK array, returns
                     this value as the first entry of the WORK array, and no error
                     message related to LWORK is issued by XERBLA.

           <u>INFO</u>

                     INFO is INTEGER
                     = 0:  successful exit
                     &lt; 0:  if INFO = -i, the i-th argument had an illegal value

       <b>Author</b>
           Univ. of Tennessee

           Univ. of California Berkeley

           Univ. of Colorado Denver

           NAG Ltd.

       <b>Further</b> <b>Details:</b>

             ZTRSEN first collects the selected eigenvalues by computing a unitary
             transformation Z to move them to the top left corner of T. In other
             words, the selected eigenvalues are the eigenvalues of T11 in:

                     Z**H * T * Z = ( T11 T12 ) n1
                                    (  0  T22 ) n2
                                       n1  n2

             where N = n1+n2. The first
             n1 columns of Z span the specified invariant subspace of T.

             If T has been obtained from the Schur factorization of a matrix
             A = Q*T*Q**H, then the reordered Schur factorization of A is given by
             A = (Q*Z)*(Z**H*T*Z)*(Q*Z)**H, and the first n1 columns of Q*Z span the
             corresponding invariant subspace of A.

             The reciprocal condition number of the average of the eigenvalues of
             T11 may be returned in S. S lies between 0 (very badly conditioned)
             and 1 (very well conditioned). It is computed as follows. First we
             compute R so that

                                    P = ( I  R ) n1
                                        ( 0  0 ) n2
                                          n1 n2

             is the projector on the invariant subspace associated with T11.
             R is the solution of the Sylvester equation:

                                   T11*R - R*T22 = T12.

             Let F-norm(M) denote the Frobenius-norm of M and 2-norm(M) denote
             the two-norm of M. Then S is computed as the lower bound

                                 (1 + F-norm(R)**2)**(-1/2)

             on the reciprocal of 2-norm(P), the true reciprocal condition number.
             S cannot underestimate 1 / 2-norm(P) by more than a factor of
             sqrt(N).

             An approximate error bound for the computed average of the
             eigenvalues of T11 is

                                    EPS * norm(T) / S

             where EPS is the machine precision.

             The reciprocal condition number of the right invariant subspace
             spanned by the first n1 columns of Z (or of Q*Z) is returned in SEP.
             SEP is defined as the separation of T11 and T22:

                                sep( T11, T22 ) = sigma-min( C )

             where sigma-min(C) is the smallest singular value of the
             n1*n2-by-n1*n2 matrix

                C  = kprod( I(n2), T11 ) - kprod( transpose(T22), I(n1) )

             <a href="../manm/I.m.html">I</a>(m) is an m by m identity matrix, and kprod denotes the Kronecker
             product. We estimate sigma-min(C) by the reciprocal of an estimate of
             the 1-norm of inverse(C). The true reciprocal 1-norm of inverse(C)
             cannot differ from sigma-min(C) by more than a factor of sqrt(n1*n2).

             When SEP is small, small changes in T can cause large changes in
             the invariant subspace. An approximate bound on the maximum angular
             error in the computed right invariant subspace is

                                 EPS * norm(T) / SEP

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for LAPACK from the source code.

Version 3.12.0                              Sun Jul 20 2025 01:40:05                                    <u><a href="../man3/trsen.3.html">trsen</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>