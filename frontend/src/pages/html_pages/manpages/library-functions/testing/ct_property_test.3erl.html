<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ct_property_test - Support in Common Test for running property-based tests.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/erlang-manpages">erlang-manpages_24.2.1+dfsg-1ubuntu0.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ct_property_test - Support in Common Test for running property-based tests.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  module  helps  running  property-based  tests  in  the  <u>Common</u> <u>Test</u> framework. One (or more) of the
       property testing tools

         * QuickCheck,

         * PropEr or

         * Triq

       is assumed to be installed.

       The idea with this module is to have a <u>Common</u> <u>Test</u> test  suite  calling  a  property  testing  tool  with
       special  property  test  suites as defined by that tool. The tests are collected in the <u>test</u> directory of
       the application. The <u>test</u> directory has a subdirectory <u>property_test</u>, where  everything  needed  for  the
       property tests are collected. The usual Erlang application directory structure is assumed.

       A typical <u>Common</u> <u>Test</u> test suite using <u>ct_property_test</u> is organized as follows:

       -<a href="../manmy_prop_test_SUITE/module.my_prop_test_SUITE.html">module</a>(my_prop_test_SUITE).
       -compile(export_all).

       -include_lib("common_test/include/ct.hrl").

        all() -&gt; [prop_ftp_case].

        init_per_suite(Config) -&gt;
            ct_property_test:init_per_suite(Config).

        %%%---- test case
        prop_ftp_case(Config) -&gt;
            ct_property_test:quickcheck(
              ftp_simple_client_server:prop_ftp(),
              Config
             ).

       and  the  the  property  test  module  (in  this  example <u>ftp_simple_client_server.erl</u>) as almost a usual
       property testing module (More examples are in the User's Guide):

       -module(ftp_simple_client_server).
       -export([prop_ftp/0...]).

       -include_lib("common_test/include/ct_property_test.hrl").

       prop_ftp() -&gt;
           ?FORALL( ....

</pre><h4><b>EXPORTS</b></h4><pre>
       <b>init_per_suite(Config)</b> <b>-&gt;</b> <b>Config</b> <b>|</b> <b>{skip,</b> <b>Reason}</b>

              Initializes and extends <u>Config</u> for property based testing.

              This function investigates if support is available for  either  QuickCheck,  PropEr  or  Triq  and
              compiles  the  properties  with  the  first  tool  found.  It  is  supposed  to  be  called in the
              <u>init_per_suite/1</u> function in a CommonTest test suite.

              Which tools to check  for,  and  in  which  order  could  be  set  with  the  option  <u>{prop_tools,</u>
              <u>list(eqc|proper|triq)}</u>  in the CommonTest configuration <u>Config</u>. The default value is <u>[eqc,</u> <u>proper,</u>
              <u>triq]</u> with <u>eqc</u> being the first one searched for.

              If no support is found for any tool, this function returns <u>{skip,</u> <u>Explanation}</u>.

              If support is found, the option <u>{property_test_tool,ToolModule}</u> with the selected tool main module
              name (<u>eqc</u>, <u>proper</u> or <u>triq</u>) is added to the list <u>Config</u> which then is returned.

              The property tests are assumed to be in a subdirectory named <u>property_test</u>. All found Erlang files
              in that directory are compiled with one of the macros <u>'EQC'</u>, <u>'PROPER'</u> or <u>'TRIQ'</u> set, depending  on
              which  tool  that  is  first  found. This could make parts of the Erlang property tests code to be
              included or excluded with the macro directives <u>-ifdef(Macro).</u> or <u>-ifndef(Macro).</u>.

              The file(s) in the <u>property_test</u> subdirectory  could,  or  should,  include  the  ct_property_test
              include file:

              -include_lib("common_test/include/ct_property_test.hrl").

              This included file will:

                * Include the correct tool's include file

                * Set  the  macro <u>'MOD_eqc'</u> to the correct module name for the selected tool. That is, the macro
                  <u>'MOD_eqc'</u> is set to either <u>eqc</u>, <u>proper</u> or <u>triq</u>.

       <b>quickcheck(Property,</b> <b>Config)</b> <b>-&gt;</b> <b>true</b> <b>|</b> <b>{fail,</b> <b>Reason}</b>

              Calls the selected tool's function for running the <u>Property</u>.  It  is  usually  and  by  historical
              reasons called quickcheck, and that is why that name is used in this module (<u>ct_property_test</u>).

              The result is returned in a form suitable for <u>Common</u> <u>Test</u> test suites.

              This function is intended to be called in test cases in test suites.

       <b>present_result(Module,</b> <b>Cmds,</b> <b>Triple,</b> <b>Config)</b> <b>-&gt;</b> <b>Result</b>

              Same as <u>present_result(Module,</u> <u>Cmds,</u> <u>Triple,</u> <u>Config,</u> <u>[])</u>

       <b>present_result(Module,</b> <b>Cmds,</b> <b>Triple,</b> <b>Config,</b> <b>Options)</b> <b>-&gt;</b> <b>Result</b>

              Types:

                 Module = module()

                 Cmds =
                   the list of commands generated by the property testing tool, for example by proper:commands/1
                   or by proper:parallel_commands/1
                 Triple =
                   the output from for example proper:run_commands/2 or proper:run_parallel_commands/2
                 Config =
                   the Common Test Config in test cases.
                 Options = [present_option()]
                 present_option() = {print_fun, fun(Format,Args)}
                  | {spec, StatisticsSpec}
                   The  <u>print_fun</u> defines which function to do the actual printout. The default is ct:log/2. The
                   <u>spec</u> defines what statistics are to be printed
                 Result = boolean()
                   Is <u>false</u> if the test failed and is <u>true</u> if the test passed

              Presents the result of <u>stateful</u> <u>(statem)</u> <u>property</u> <u>testing</u>  using the aggregate function in PropEr,
              QuickCheck or other similar property testing tool.

              It is assumed to be called inside the property called by quickcheck/2:

              ...
              RunResult = run_parallel_commands(?MODULE, Cmds),
              ct_property_test:present_result(?MODULE, Cmds, RunResult, Config)
              ...

              See the User's Guide for an example of the usage and of the default printout.

              The <u>StatisticsSpec</u> is a list of the tuples:

                * <u>{Title::string(),</u> <u>CollectFun::fun/1}</u>

                * <u>{Title::string(),</u> <u>FrequencyFun::/0,</u> <u>CollectFun::fun/1}</u>

              Each tuple will produce one table in the order of their places in the list.

                * <u>Title</u> will be the title of one result table

                * <u>CollectFun</u> is called with one argument: the <u>Cmds</u>. It should return a list of the values to  be
                  counted. The following pre-defined functions exist:

                  * <u>ct_property_test:cmnd_names/1</u>  returns  a list of commands (function calls) generated in the
                    <u>Cmnd</u> sequence, without Module, Arguments and other details.

                  * <u>ct_property_test:num_calls/1</u> returns a list of the length of commands lists

                  * <u>ct_property_test:sequential_parallel/1</u> returns a list with information about sequential  and
                    parallel parts from <u>Tool:parallel_commands/1,2</u>

                * <u>FrequencyFun/0</u>  returns a fun/1 which is supposed to take a list of items as input, and return
                  an iolist wich will be printed as the table. Per default, the number of each item  is  counted
                  and the percentage is printed for each. The list [a,b,a,a,c] could for example return

                 ["a 60%\n","b 20%\n","c 20%\n"]

                 a 60%
                 b 20%
                 c 20%

              The default <u>StatisticsSpec</u> is:

                * For sequential commands:

                [{"Function calls", fun cmnd_names/1},
                 {"Length of command sequences", fun print_frequency_ranges/0,
                                                                  fun num_calls/1}]

                * For parallel commands:

                [{"Distribution sequential/parallel", fun sequential_parallel/1},
                 {"Function calls", fun cmnd_names/1},
                 {"Length of command sequences", fun print_frequency_ranges/0,
                                                                  fun num_calls/1}]

Ericsson AB                                     common_test 1.22                          <u><a href="../man3erl/ct_property_test.3erl.html">ct_property_test</a></u>(3erl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>