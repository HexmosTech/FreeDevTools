<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test2::Manual::Tooling::Plugin::TestingDone - Run code when the test file is finished, or when</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtest2-suite-perl">libtest2-suite-perl_0.000163-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Test2::Manual::Tooling::Plugin::TestingDone - Run code when the test file is finished, or when
       done_testing is called.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This is a way to add behavior to the end of a test file. This code is run either when <b>done_testing()</b> is
       called, or when the test file has no more run-time code to run.

       When triggered by <b>done_testing()</b> this will be run BEFORE the plan is calculated and sent. This means it
       IS safe to make test assertions in this callback.

</pre><h4><b>COMPLETE</b> <b>CODE</b> <b>UP</b> <b>FRONT</b></h4><pre>
           package Test2::Plugin::MyPlugin;

           use Test2::API qw{test2_add_callback_testing_done};

           sub import {
               my $class = shift;

               test2_add_callback_testing_done(sub {
                   ok(!$some_global, '$some_global was not set');
                   print "The test file is done, or done_testing was just called\n"
               });
           }

           1;

</pre><h4><b>LINE</b> <b>BY</b> <b>LINE</b></h4><pre>
       use Test2::API qw{test2_add_callback_testing_done};
           This imports the test2_add_callback_testing_done() callback.

       test2_add_callback_testing_done(sub { ... });
           This adds our callback to be called when testing is done.

       ok(!$some_global, '$some_global was not set')
           It is safe to make assertions in this type of callback. This code simply asserts that some global was
           never set over the course of the test.

       print "The test file is done, or done_testing was just called\n"
           This prints a message when the callback is run.

</pre><h4><b>UNDER</b> <b>THE</b> <b>HOOD</b></h4><pre>
       Before  <b>test2_add_callback_testing_done()</b>  this  kind of thing was still possible, but it was hard to get
       right, here is the code to do it:

           test2_add_callback_post_load(sub {
               my $stack = test2_stack();

               # Insure we have at least one hub, but we do not necessarily want the
               # one this returns.
               $stack-&gt;top;

               # We want the root hub, not the top one.
               my ($root) = Test2::API::test2_stack-&gt;all;

               # Make sure the hub does not believe nothing has happened.
               $root-&gt;<a href="../man1/set_active.1.html">set_active</a>(1);

               # Now we can add our follow-up code
               $root-&gt;follow_up(sub {
                   # Your callback code here
               });
           });

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Test2::Manual - Primary index of the manual.

</pre><h4><b>SOURCE</b></h4><pre>
       The source code repository for Test2-Manual can be found at <u>https://github.com/Test-More/Test2-Suite/</u>.

</pre><h4><b>MAINTAINERS</b></h4><pre>
       Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;

</pre><h4><b>AUTHORS</b></h4><pre>
       Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2018 Chad Granum &lt;<a href="mailto:exodist@cpan.org">exodist@cpan.org</a>&gt;.

       This program is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself.

       See <u><a href="http://dev.perl.org/licenses/">http://dev.perl.org/licenses/</a></u>

perl v5.38.2                                       2024-06-07              <u>Test2::Manual:...in::<a href="../man3pm/TestingDone.3pm.html">TestingDone</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>