<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test::MockObject - Perl extension for emulating troublesome interfaces</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtest-mockobject-perl">libtest-mockobject-perl_1.20200122-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Test::MockObject - Perl extension for emulating troublesome interfaces

</pre><h4><b>SYNOPSIS</b></h4><pre>
         use Test::MockObject;
         my $mock = Test::MockObject-&gt;new();
         $mock-&gt;set_true( 'somemethod' );
         ok( $mock-&gt;somemethod() );

         $mock-&gt;set_true( 'veritas')
              -&gt;set_false( 'ficta' )
              -&gt;set_series( 'amicae', 'Sunny', 'Kylie', 'Bella' );

</pre><h4><b>DESCRIPTION</b></h4><pre>
       It's a simple program that doesn't use any other modules, and those are easy to test.  More often,
       testing a program completely means faking up input to another module, trying to coax the right output
       from something you're not supposed to be testing anyway.

       Testing is a lot easier when you can control the entire environment.  With Test::MockObject, you can get
       a lot closer.

       Test::MockObject allows you to create objects that conform to particular interfaces with very little
       code.  You don't have to reimplement the behavior, just the input and the output.

   <b>IMPORTANT</b> <b>CAVEATS</b>
       Before you go wild with your testing powers, consider three caveats:

       •   It  is  possible  to  write highly detailed unit tests that pass even when your integration tests may
           fail.  Testing the pieces individually does not excuse you from testing the whole thing together.

       •   In cases  where  you  only  need  to  mock  one  or  two  pieces  of  an  existing  module,  consider
           Test::MockObject::Extends instead.

       •   If  the  code  under  testing  produces strange errors about type checks, pass the "-debug" flag when
           using "Test::MockObject" or "Test::MockObject::Extends".  This  will  load  both  UNIVERSAL::isa  and
           UNIVERSAL::can  to  perform  additional  debugging  on  the  incorrect  use  of both methods from the
           UNIVERSAL package. (This behavior used to be active  by  default,  but  that  was,  however  correct,
           probably a burden to onerous for the CPAN.)

   <b>EXPORT</b>
       None.

   <b>METHODS</b>
       The  most  important thing a Mock Object can do is to conform sufficiently to an interface.  For example,
       if you're testing something that relies on CGI.pm, you may find it easier to create a  mock  object  that
       returns controllable results at given times than to fake query string input.

       <u>The</u> <u>Basics</u>

       •   "new"

           Creates  a  new  mock  object.   By  default, this is a blessed hash.  Pass a reference to bless that
           reference.

               my $mock_array  = Test::MockObject-&gt;new( [] );
               my $mock_scalar = Test::MockObject-&gt;new( \( my $scalar ) );
               my $mock_code   = Test::MockObject-&gt;new( sub {} );
               my $mock_glob   = Test::MockObject-&gt;new( \*GLOB );

       <u>Mocking</u>

       Your mock object is nearly useless if you don't tell it what it's mocking.  This is  done  by  installing
       methods.   You  control  the  output of these mocked methods.  In addition, any mocked method is tracked.
       You can tell not only what was called, but which arguments were passed.   Please  note  that  you  cannot
       track  non-mocked  method  calls.   They will still be allowed, though Test::MockObject will <b>carp()</b> about
       them.  This is considered a feature, though it may be possible to disable this in the future.

       As implied in the example above, it's possible to chain these calls together.   Thanks  to  a  suggestion
       from the fabulous Piers Cawley (CPAN RT #1249), this feature came about in version 0.09.  Shorter testing
       code is nice!

       •   "mock(<u>name</u>, <u>coderef</u> [, <u>name2</u>, <u>coderef2</u>, ...])"

           Adds  one  or more coderefs to the object.  This allows code to call the named methods on the object.
           For example, this code:

               my $mock = Test::MockObject-&gt;new();
               $mock-&gt;mock( 'fluorinate',
                   sub { 'impurifying precious bodily fluids' } );
               print $mock-&gt;fluorinate;

           will print a helpful warning message.  Please note that methods are only added to a single object  at
           a  time  and  not  the  class.  (There is no small similarity to the Self programming language or the
           Class::Prototyped module.)

           This method forms the basis for most of Test::MockObject's testing goodness.

           <b>Please</b> <b>Note:</b> this method used to be "add()".  Due to its ambiguity, it now has a different  spelling.
           For backwards compatibility purposes, <b>add()</b> is available, though version 0.07 deprecated it.  It goes
           to some contortions to try to do what you mean, but I make few guarantees.

       •   "fake_module(<u>module</u> <u>name</u>), [ <u>subname</u> =" <u>coderef</u>, ... ]

           <b>Note:</b> See Test::MockModule for an alternate (and better) approach.

           Lies  to  Perl that it has already loaded a named module.  This is handy when providing a mockup of a
           real module if you'd like to prevent the actual module from interfering with  the  nice  fakery.   If
           you're mocking Regexp::English, say:

               $mock-&gt;fake_module( 'Regexp::English' );

           This  is  both  a  class and as an object method.  Beware that this must take place before the actual
           module has a chance to load.  Either wrap it in a BEGIN block before a use or  require  or  place  it
           before a "use_ok()" or "require_ok()" call.

           You  can  optionally  add  functions to the mocked module by passing them as name =&gt; coderef pairs to
           "fake_module()".  This is handy if you want to test an "import()":

               my $import;
               $mock-&gt;fake_module(
                   'Regexp::English',
                   import =&gt; sub { $import = caller }
               );
               use_ok( 'Regexp::Esperanto' );
               is( $import, 'Regexp::Esperanto',
                   'Regexp::Esperanto should use() Regexp::English' );

           If you use "fake_module()" to mock a module that already  exists  in  memory  --  one  you've  loaded
           elsewhere  perhaps,  but  do  not  pass any subroutines to mock, this method will throw an exception.
           This is because if you call the constructor later on, you probably won't get a mock object  back  and
           you'll be confused.

       •   "fake_new(<u>module</u> <u>name</u>)"

           <b>Note:</b> see Test::MockObject::Extends for a better alternative to this method.

           Provides  a  fake  constructor  for  the given module that returns the invoking mock object.  Used in
           conjunction with "fake_module()", you can force the tested unit to work with the mock object instead.

               $mock-&gt;fake_module( 'CGI' );
               $mock-&gt;fake_new( 'CGI' );

               use_ok( 'Some::Module' );
               my $s = Some::Module-&gt;new();
               is( $s-&gt;{_cgi}, $mock,
                   'new() should create and store a new CGI object' );

       •   "set_always(<u>name</u>, <u>value</u>)"

           Adds a method of the specified name that always returns the specified value.

       •   "set_true(<u>name_1</u>, <u>name_2</u>, ... <u>name_n</u>)"

           Adds a method of the specified name that always returns a true value.  This can take a list of names.

       •   "set_false(<u>name_1</u>, <u>name_2</u>, ... <u>name_n</u>)"

           Adds a method of the specified name that always returns a false value.  (Since it installs  an  empty
           subroutine,  the  value  should  be false in both scalar and list contexts.)  This can take a list of
           names.

       •   "set_list(<u>name</u>, [ <u>item1</u>, <u>item2</u>, ... ]"

           Adds a method that always returns a given list of values.  It takes some care to provide a  list  and
           not an array, if that's important to you.

       •   "set_series(<u>name</u>, [ <u>item1</u>, <u>item2</u>, ... ]"

           Adds  a  method that will return the next item in a series on each call.  This can help to test error
           handling, by forcing a failure on the first method call and then subsequent successes.  Note that the
           series does not repeat; it will eventually run out.

       •   "set_bound(<u>name</u>, <u>reference</u>)"

           Adds a method bound to a variable.  Pass in a reference to a variable in your test.  When you  change
           the  variable,  the  return  value of the new method will change as well.  This is often handier than
           replacing mock methods.

       •   "set_isa( <u>name1</u>, <u>name2</u>, ... <u>namen</u> )"

           Adds an apparent parent to the module,  so  that  calling  "isa()"  on  the  mock  will  return  true
           appropriately.  Sometimes you really need this.

       •   "remove(<u>name</u>)"

           Removes a named method.

       <u>Checking</u> <u>Your</u> <u>Mocks</u>

       •   "can( $method_name )"

           Returns  a  subroutine  reference if this particular mocked object can handle the named method, false
           otherwise.

       •   "isa( $class_name )"

           Returns true if the invocant object mocks a particular class.  You must have used "set_isa()" first.

       •   "called(<u>name</u>)"

           Checks to see if something has called a named method on the object.  This returns  a  boolean  value.
           The  current  implementation  does  not  scale  especially well, so use this sparingly if you need to
           search through hundreds of calls.

       •   "clear()"

           Clears the internal record of all method calls on the object.  It's handy to do this  every  now  and
           then.   Note  that  this  does  not  affect the mocked methods, only all of the methods called on the
           object to this point.

           It's handy to "clear()" methods in between series of tests.   That  makes  it  much  easier  to  call
           "next_method()" without having to skip over the calls from the last set of tests.

       •   "next_call([ <u>position</u> ])"

           Returns  the  name  and argument list of the next mocked method called on an object, in list context.
           In scalar context, returns only the method name.  There are two important things to know  about  this
           method.  First, it starts at the beginning of the call list.  If your code runs like this:

               $mock-&gt;set_true( 'foo' );
               $mock-&gt;set_true( 'bar' );
               $mock-&gt;set_true( 'baz' );

               $mock-&gt;foo();
               $mock-&gt;bar( 3, 4 );
               $mock-&gt;foo( 1, 2 );

           Then you might see output of:

               my ($name, $args) = $mock-&gt;next_call();
               print "$name (@$args)";

               # prints 'foo'

               $name = $mock-&gt;next_call();
               print $name;

               # prints 'bar'

               ($name, $args) = $mock-&gt;next_call();
               print "$name (@$args)";

               # prints 'foo 1 2'

           If  you  provide  an  optional number as the <u>position</u> argument, the method will skip that many calls,
           returning the data for the last one skipped.

               $mock-&gt;foo();
               $mock-&gt;bar();
               $mock-&gt;baz();

               $name = $mock-&gt;next_call();
               print $name;

               # prints 'foo'

               $name = $mock-&gt;next_call( 2 );
               print $name

               # prints 'baz'

           When it reaches the end of the list, it returns undef.  This is probably the most  convenient  method
           in  the  whole  module,  but  for the sake of completeness and backwards compatibility (it takes me a
           while to reach the truest state of laziness!), there are several other methods.

       •   "call_pos(<u>position</u>)"

           Returns the name of the method called on the object at a specified position.  This is  handy  if  you
           need to test a certain order of calls.  For example:

               Some::Function( $mock );
               is( $mock-&gt;<a href="../man1/call_pos.1.html">call_pos</a>(1),  'setup',
                   'Function() should first call setup()' );
               is( $mock-&gt;call_pos(-1), 'end',
                   '... and last call end()' );

           Positions  can  be  positive or negative.  Please note that the first position is, in fact, 1.  (This
           may change in the future.  I like it, but am willing to reconsider.)

       •   "call_args(<u>position</u>)"

           Returns a list of the arguments provided to the method called at the appropriate position.  Following
           the test above, one might say:

               is( ($mock-&gt;<a href="../man1/call_args.1.html">call_args</a>(1))[0], $mock,
                   '... passing the object to setup()' );
               is( scalar $mock-&gt;call_args(-1), 0,
                   '... and no args to end()' );

       •   "call_args_pos(<u>call</u> <u>position</u>, <u>argument</u> <u>position</u>)"

           Returns the argument at the specified position for the method call at the  specified  position.   One
           might rewrite the first test of the last example as:

               is( $mock-&gt;call_args_pos(1, 1), $mock,
                   '... passing the object to setup()');

       •   "call_args_string(<u>position</u>, [ <u>separator</u> ])"

           Returns  a stringified version of the arguments at the specified position.  If no separator is given,
           they will not be separated.  This can be used as:

               is( $mock-&gt;<a href="../man1/call_args_string.1.html">call_args_string</a>(1), "$mock initialize",
                   '... passing object, initialize as arguments' );

       •   "called_ok(<u>method</u> <u>name</u>, [ <u>test</u> <u>name</u> ])"

           Tests to see whether a method of the specified name has been called on  the  object.   This  and  the
           following  methods  use  Test::Builder,  so  they  integrate  nicely  with  a test suite built around
           Test::Simple, Test::More, or anything else compatible:

               $mock-&gt;foo();
               $mock-&gt;called_ok( 'foo' );

           A generic default test name is provided.

       •   "called_pos_ok(<u>position</u>, <u>method</u> <u>name</u>, [ <u>test</u> <u>name</u> ])"

           Tests to see whether the named method was called at the specified position.  A default test  name  is
           provided.

       •   "called_args_pos_is(<u>method</u> <u>position</u>, <u>argument</u> <u>position</u>, <u>expected</u>, [ <u>test</u> <u>name</u> ])"

           Tests to see whether the argument at the appropriate position of the method in the specified position
           equals a specified value.  A default, rather non-descript test name is provided.

       •   "called_args_string_is(<u>method</u> <u>position</u>, <u>separator</u>, <u>expected</u>, [ <u>test</u> <u>name</u> ])"

           Joins  together  all  of  the arguments to a method at the appropriate position and matches against a
           specified string.  A generically bland test name is provided by default.  You can  probably  do  much
           better.

       •   "check_class_loaded( $class_name )"

           Attempts  to  determine whether you have a class of the given name loaded and compiled.  Returns true
           or false.

       <u>Logging</u>

       Test::MockObject logs all mocked methods by default.  Sometimes you don't want to do  this.   To  prevent
       logging all calls to a given method, prepend the name of the method with "-" when mocking it.

       That is:

           $mock-&gt;set_true( '-foo', 'bar' );

       will  set  mock both "foo()" and "bar()", causing both to return true.  However, the object will log only
       calls to "bar()", not "foo()".  To log "foo()" again, merely mock it again without the leading "-":

           $mock-&gt;set_true( 'foo' );

       $mock will log all subsequent calls to "foo()" again.

       <u>Subclassing</u>

       There are two methods provided for subclassing:

       •   "dispatch_mocked_method( $method_name, @_ )"

           This method determines how to call a method (named as $method_name) not available in this class.   It
           also  controls  logging.  You may or may not find it useful, but I certainly take advantage of it for
           Test::MockObject::Extends.

       •   "log_call( $method_name, @_ )"

           This method tracks the call of the named method and its arguments.

</pre><h4><b>TODO</b></h4><pre>
       •   Add a factory method to avoid namespace collisions (soon)

       •   Add more useful methods (catch "import()"?)

</pre><h4><b>AUTHOR</b></h4><pre>
       chromatic, &lt;chromatic at wgz dot org&gt;

       Thanks go to Curtis 'Ovid' Poe, as well as  ONSITE!  Technology,  Inc.,  for  finding  several  bugs  and
       providing several constructive suggestions.

       Jay Bonci also found a false positive in "called_ok()".  Thanks!

       Chris  Winters  was  the first to report I'd accidentally scheduled 0.12 for deletion without uploading a
       newer version.  He also gave useful feedback on Test::MockObject::Extends.

       Stevan Little provided the impetus and code for "set_isa()".

       Nicholas Clark found a documentation error.

       Mutant suggested a potential problem with <b>fake_module()</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       perl,     Test::Tutorial,     Test::More,     <a href="http://www.perl.com/pub/a/2001/12/04/testing.html">http://www.perl.com/pub/a/2001/12/04/testing.html</a>,      and
       <a href="http://www.perl.com/pub/a/2002/07/10/tmo.html">http://www.perl.com/pub/a/2002/07/10/tmo.html</a>.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2002 - 2016 by chromatic &lt;chromatic at wgz dot org&gt;.

       This program is free software; you can use, modify, and redistribute it under the same terms as Perl 5.24
       itself.

       See <a href="http://www.perl.com/perl/misc/Artistic.html">http://www.perl.com/perl/misc/Artistic.html</a>

perl v5.36.0                                       2022-11-27                              <u>Test::<a href="../man3pm/MockObject.3pm.html">MockObject</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>