<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uri - URI utilities</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       uri - URI utilities

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>uri</b> <b>?1.2.8?</b>

       <b>uri::setQuirkOption</b> <u>option</u> ?<u>value</u>?

       <b>uri::split</b> <u>url</u> ?<u>defaultscheme</u>?

       <b>uri::join</b> ?<u>key</u> <u>value</u>?...

       <b>uri::resolve</b> <u>base</u> <u>url</u>

       <b>uri::isrelative</b> <u>url</u>

       <b>uri::geturl</b> <u>url</u> ?<u>options</u>...?

       <b>uri::canonicalize</b> <u>uri</u>

       <b>uri::register</b> <u>schemeList</u> <u>script</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This package does two things.

       First,  it  provides a number of commands for manipulating URLs/URIs and fetching data specified by them.
       For fetching data this package analyses the requested URL/URI and then dispatches it to  the  appropriate
       package  (<b>http</b>,  <b>ftp</b>,  ...)  for  actual retrieval.  Currently these commands are defined for the schemes
       <u>http</u>, <u>https</u>, <u>ftp</u>, <u>mailto</u>, <u>news</u>, <u>ldap</u>, <u>ldaps</u> and <u>file</u>.  The package <b>uri::urn</b> adds scheme <u>urn</u>.

       Second, it provides regular expressions for a number of <b>registered</b> URL/URI  schemes.  Registered  schemes
       are  currently <u>ftp</u>, <u>ldap</u>, <u>ldaps</u>, <u>file</u>, <u>http</u>, <u>https</u>, <u>gopher</u>, <u>mailto</u>, <u>news</u>, <u>wais</u> and <u>prospero</u>.  The package
       <b>uri::urn</b> adds scheme <u>urn</u>.

       The commands of the package conform to RFC 3986  (<u>https://www.rfc-editor.org/rfc/rfc3986.txt</u>),  with  the
       exception  of  a  loophole  arising from RFC 1630 and described in RFC 3986 Sections 5.2.2 and 5.4.2. The
       loophole allows a relative URI to include a scheme if it is the same  as  the  scheme  of  the  base  URI
       against which it is resolved. RFC 3986 recommends avoiding this usage.

</pre><h4><b>COMMANDS</b></h4><pre>
       <b>uri::setQuirkOption</b> <u>option</u> ?<u>value</u>?
              <b>uri::setQuirkOption</b>  is  an accessor command for a number of "quirk options".  The command has the
              same semantics as the command <b>set</b>: when called with one argument it reads an existing value;  with
              two  arguments  it  writes a new value.  The value of a "quirk option" is boolean: the value <b>false</b>
              requests conformance with RFC 3986, while <b>true</b> requests use  of  the  quirk.   See  section  <b>QUIRK</b>
              <b>OPTIONS</b> for discussion of the different options and their purpose.

       <b>uri::split</b> <u>url</u> ?<u>defaultscheme</u>?
              <b>uri::split</b>  takes  a <u>url</u>, decodes it and then returns a list of key/value pairs suitable for <b>array</b>
              <b>set</b> containing the constituents of the <u>url</u>. If the scheme is missing from the <u>url</u> it  defaults  to
              the  value  of <u>defaultscheme</u> if it was specified, or <u>http</u> else. Currently the schemes <u>http</u>, <u>https</u>,
              <u>ftp</u>, <u>mailto</u>, <u>news</u>, <u>ldap</u>, <u>ldaps</u> and  <u>file</u>  are  supported  by  the  package  itself.   See  section
              <b>EXTENDING</b> on how to expand that range.

              The  set  of  constituents of a URL (= the set of keys in the returned dictionary) is dependent on
              the scheme of the URL. The only key which is therefore always present is <b>scheme</b>. For the following
              schemes the constituents and their keys are known:

              ftp    <b>user</b>, <b>pwd</b>, <b>host</b>, <b>port</b>, <b>path</b>, <b>type</b>, <b>pbare</b>.  The pbare is optional.

              http(s)
                     <b>user</b>, <b>pwd</b>, <b>host</b>, <b>port</b>, <b>path</b>, <b>query</b>, <b>fragment</b>, <b>pbare</b>.  The pbare is optional.

              file   <b>path</b>, <b>host</b>. The host is optional.

              mailto <b>user</b>, <b>host</b>. The host is optional.

              ldap(s)
                     <b>host</b>, <b>port</b>, <b>dn</b>, <b>attrs</b>, <b>scope</b>, <b>filter</b>, <b>extensions</b>

              news   Either <b>message-id</b> or <b>newsgroup-name</b>.

              For discussion of the boolean <b>pbare</b> see options <u>NoInitialSlash</u> and <u>NoExtraKeys</u> in <b>QUIRK</b> <b>OPTIONS</b>.

              The constituents are returned as slices of the argument <u>url</u>, without removal  of  percent-encoding
              ("url-encoding")  or  other  adaptations.   Notably,  on Windows® the <b>path</b> in scheme <u>file</u> is not a
              valid local filename.  See <b>EXAMPLES</b> for more information.

       <b>uri::join</b> ?<u>key</u> <u>value</u>?...
              <b>uri::join</b> takes a list of key/value pairs (generated by <b>uri::split</b>, for example) and  returns  the
              canonical  URL  they  represent. Currently the schemes <u>http</u>, <u>https</u>, <u>ftp</u>, <u>mailto</u>, <u>news</u>, <u>ldap</u>, <u>ldaps</u>
              and <u>file</u> are supported by the package itself. See section <b>EXTENDING</b> on how to expand that range.

              The arguments are expected to be slices of a valid URL, with percent-encoding ("url-encoding") and
              any other necessary adaptations.  Notably, on Windows the <b>path</b> in scheme <u>file</u> is not a valid local
              filename.  See <b>EXAMPLES</b> for more information.

       <b>uri::resolve</b> <u>base</u> <u>url</u>
              <b>uri::resolve</b> resolves the specified <u>url</u> relative to <u>base</u>, in conformance with RFC 3986.  In  other
              words:  a non-relative <u>url</u> is returned unchanged, whereas for a relative <u>url</u> the missing parts are
              taken from <u>base</u> and prepended to it. The result of this operation is returned. For  an  empty  <u>url</u>
              the result is <u>base</u>, without its URI fragment (if any).  The command is available for schemes <u>http</u>,
              <u>https</u>, <u>ftp</u>, and <u>file</u>.

       <b>uri::isrelative</b> <u>url</u>
              <b>uri::isrelative</b>  determines  whether  the  specified  <u>url</u> is absolute or relative.  The command is
              available for a <u>url</u> of any scheme.

       <b>uri::geturl</b> <u>url</u> ?<u>options</u>...?
              <b>uri::geturl</b> decodes the specified <u>url</u> and then dispatches the request to the  package  appropriate
              for  the  scheme found in the URL. The command assumes that the package to handle the given scheme
              either has the same name as the scheme itself  (including  possible  capitalization)  followed  by
              <b>::geturl</b>,  or, in case of this failing, has the same name as the scheme itself (including possible
              capitalization). It further assumes that whatever package was loaded provides a <b>geturl</b>-command  in
              the  namespace  of  the same name as the package itself. This command is called with the given <u>url</u>
              and all given <u>options</u>. Currently <b>geturl</b> does not handle any options itself.

              <u>Note:</u> <u>file</u>-URLs are an exception to the rule described above. They are handled internally.

              It is not possible to specify results of the command. They depend on the  <b>geturl</b>-command  for  the
              scheme the request was dispatched to.

       <b>uri::canonicalize</b> <u>uri</u>
              <b>uri::canonicalize</b>  returns  the canonical form of a URI.  The canonical form of a URI is one where
              relative path specifications, i.e. "." and "..", have been resolved.  The command is available for
              all URI schemes that have <b>uri::split</b> and <b>uri::join</b> commands. The command returns  a  canonicalized
              URI  if  the  URI scheme has a <b>path</b> component (i.e. <u>http</u>, <u>https</u>, <u>ftp</u>, and <u>file</u>).  For schemes that
              have <b>uri::split</b> and <b>uri::join</b> commands but no <b>path</b> component (i.e. <u>mailto</u>, <u>news</u>, <u>ldap</u>, and <u>ldaps</u>),
              the command returns the <u>uri</u> unchanged.

       <b>uri::register</b> <u>schemeList</u> <u>script</u>
              <b>uri::register</b> registers the first element of <u>schemeList</u> as a new scheme and the remaining elements
              as aliases for this scheme. It creates the namespace for the scheme and executes the <u>script</u> in the
              new namespace. The script has to declare variables containing regular expressions relevant to  the
              scheme.  At  least  the  variable  <b>schemepart</b> has to be declared as that one is used to extend the
              variables keeping track of the registered schemes.

</pre><h4><b>SCHEMES</b></h4><pre>
       In addition to the commands mentioned above this package provides regular expression  to  recognize  URLs
       for a number of URL schemes.

       For  each  supported  scheme  a namespace of the same name as the scheme itself is provided inside of the
       namespace <u>uri</u> containing the variable <b>url</b> whose contents are a regular expression to  recognize  URLs  of
       that scheme. Additional variables may contain regular expressions for parts of URLs for that scheme.

       The  variable  <b>uri::schemes</b>  contains  a  list  of all registered schemes. Currently these are <u>ftp</u>, <u>ldap</u>,
       <u>ldaps</u>, <u>file</u>, <u>http</u>, <u>https</u>, <u>gopher</u>, <u>mailto</u>, <u>news</u>, <u>wais</u> and <u>prospero</u>.

</pre><h4><b>EXTENDING</b></h4><pre>
       Extending the range of schemes supported by <b>uri::split</b> and <b>uri::join</b> is easy because both commands do not
       handle the request by themselves but dispatch it to another command in the <u>uri</u> namespace using the scheme
       of the URL as criterion.

       <b>uri::split</b>  and  <b>uri::join</b>  call  <b>Split[string</b>  <b>totitle</b>  <b>&lt;scheme&gt;]</b>  and   <b>Join[string</b>  <b>totitle</b>  <b>&lt;scheme&gt;]</b>
       respectively.

       The  provision  of  split  and  join  commands is sufficient to extend the commands <b>uri::canonicalize</b> and
       <b>uri::geturl</b> (the latter subject to the availability of a suitable package with  a  <b>geturl</b>  command).   In
       contrast, to extend the command <b>uri::resolve</b> to a new scheme, the command itself must be modified.

       To extend the range of schemes for which pattern information is available, use the command <b>uri::register</b>.

       An example of a package that provides both commands and pattern information for a new scheme is <b>uri::urn</b>,
       which adds scheme <u>urn</u>.

</pre><h4><b>QUIRK</b> <b>OPTIONS</b></h4><pre>
       The  value of a "quirk option" is boolean: the value <b>false</b> requests conformance with RFC 3986, while <b>true</b>
       requests use of the quirk.  Use command <b>uri::setQuirkOption</b> to access the values of quirk options.

       Quirk options are useful both for allowing backwards compatibility when a command specification  changes,
       and  for adding useful features that are not included in RFC specifications.  The following quirk options
       are currently defined:

       <u>NoInitialSlash</u>
              This quirk option concerns the leading character of <b>path</b>  (if  non-empty)  in  the  schemes  <u>http</u>,
              <u>https</u>, and <u>ftp</u>.

              RFC  3986  defines <b>path</b> in an absolute URI to have an initial "/", unless the value of <b>path</b> is the
              empty string. For the scheme <u>file</u>, all versions of package <b>uri</b> follow this rule.  The quirk option
              <u>NoInitialSlash</u> does not apply to scheme <u>file</u>.

              For the schemes <u>http</u>, <u>https</u>, and <u>ftp</u>, versions of <b>uri</b> before 1.2.7 define the <b>path</b> <u>NOT</u> to  include
              an initial "/".  When the quirk option <u>NoInitialSlash</u> is <b>true</b> (the default), this behavior is also
              used  in  version  1.2.7.   To  use  instead values of <b>path</b> as defined by RFC 3986, set this quirk
              option to <b>false</b>.

              This setting does not affect RFC 3986 conformance.  If <u>NoInitialSlash</u> is <b>true</b>, then the  value  of
              <b>path</b>  in  the  schemes <u>http</u>, <u>https</u>, or <u>ftp</u>, cannot distinguish between URIs in which the full "RFC
              3986 path" is the empty string "" or a single slash "/" respectively.  The missing information  is
              recorded in an additional <b>uri::split</b> key <b>pbare</b>.

              The  boolean  <b>pbare</b>  is defined when quirk options <u>NoInitialSlash</u> and <u>NoExtraKeys</u> have values <b>true</b>
              and <b>false</b> respectively.  In this case, if the value of <b>path</b> is the empty string "", <b>pbare</b> is  <b>true</b>
              if the full "RFC 3986 path" is "", and <b>pbare</b> is <b>false</b> if the full "RFC 3986 path" is "/".

              Using this quirk option <u>NoInitialSlash</u> is a matter of preference.

       <u>NoExtraKeys</u>
              This  quirk  option  permits  full  backward  compatibility  with versions of <b>uri</b> before 1.2.7, by
              omitting the <b>uri::split</b> key <b>pbare</b> described above (see quirk option <u>NoInitialSlash</u>).  The  outcome
              is  greater  backward  compatibility  of  the  <b>uri::split</b> command, but an inability to distinguish
              between URIs in which the full "RFC 3986 path" is the empty  string  ""  or  a  single  slash  "/"
              respectively - i.e. a minor non-conformance with RFC 3986.

              If  the  quirk option <u>NoExtraKeys</u> is <b>false</b> (the default), command <b>uri::split</b> returns an additional
              key <b>pbare</b>, and the commands comply with RFC 3986. If the quirk option <u>NoExtraKeys</u> is <b>true</b>, the key
              <b>pbare</b> is not defined and there is not full conformance with RFC 3986.

              Using the quirk option <u>NoExtraKeys</u> is <u>NOT</u> recommended, because if  set  to  <b>true</b>  it  will  reduce
              conformance  with  RFC 3986.  The option is included only for compatibility with code, written for
              earlier versions of <b>uri</b>, that needs values of <b>path</b> without a leading "/", <u>AND</u> <u>ALSO</u> cannot tolerate
              unexpected keys in the results of <b>uri::split</b>.

       <u>HostAsDriveLetter</u>
              When handling the scheme <u>file</u> on the Windows platform, versions of <b>uri</b> before 1.2.7 use  the  <b>host</b>
              field  to  represent  a  Windows drive letter and the colon that follows it, and the <b>path</b> field to
              represent the filename path after the colon.  Such URIs are invalid, and are not recognized by any
              RFC. When the quirk option <u>HostAsDriveLetter</u> is <b>true</b>, this behavior is also used in version 1.2.7.
              To use <u>file</u> URIs on Windows that conform to  RFC  3986,  set  this  quirk  option  to  <b>false</b>  (the
              default).

              Using  this  quirk  is  <u>NOT</u>  recommended, because if set to <b>true</b> it will cause the <b>uri</b> commands to
              expect and produce invalid URIs.  The option is included only for compatibility with legacy code.

       <u>RemoveDoubleSlashes</u>
              When a URI is canonicalized by <b>uri::canonicalize</b>, its <b>path</b> is normalized by  removal  of  segments
              "."  and  "..".   RFC  3986  does not mandate the removal of empty segments "" (i.e. the merger of
              double slashes, which is a feature of filename normalization but not of URI  <b>path</b>  normalization):
              it  treats  URIs  with  excess slashes as referring to different resources.  When the quirk option
              <u>RemoveDoubleSlashes</u> is <b>true</b> (the default), empty segments will be removed from <b>path</b>.   To  prevent
              removal, and thereby conform to RFC 3986, set this quirk option to <b>false</b>.

              Using this quirk is a matter of preference.  A URI with double slashes in its path was most likely
              generated  by  error,  certainly so if it has a straightforward mapping to a file on a server.  In
              some cases it may be better to sanitize the URI; in others, to keep the URI  and  let  the  server
              handle the possible error.

   <b>BACKWARD</b> <b>COMPATIBILITY</b>
       To  behave  as  similarly  as  possible  to  versions  of <b>uri</b> earlier than 1.2.7, set the following quirk
       options:

       •      <b>uri::setQuirkOption</b> <u>NoInitialSlash</u> 1

       •      <b>uri::setQuirkOption</b> <u>NoExtraKeys</u> 1

       •      <b>uri::setQuirkOption</b> <u>HostAsDriveLetter</u> 1

       •      <b>uri::setQuirkOption</b> <u>RemoveDoubleSlashes</u> 0

       In code that can tolerate the return by <b>uri::split</b> of an additional key <b>pbare</b>, set

       •      <b>uri::setQuirkOption</b> <u>NoExtraKeys</u> 0

       in order to achieve greater compliance with RFC 3986.

   <b>NEW</b> <b>DESIGNS</b>
       For new projects, the following settings are recommended:

       •      <b>uri::setQuirkOption</b> <u>NoInitialSlash</u> 0

       •      <b>uri::setQuirkOption</b> <u>NoExtraKeys</u> 0

       •      <b>uri::setQuirkOption</b> <u>HostAsDriveLetter</u> 0

       •      <b>uri::setQuirkOption</b> <u>RemoveDoubleSlashes</u> 0|1

   <b>DEFAULT</b> <b>VALUES</b>
       The default values for package <b>uri</b> version 1.2.7 are  intended  to  be  a  compromise  between  backwards
       compatibility  and  improved  features.   Different  default  values  may be chosen in future versions of
       package <b>uri</b>.

       •      <b>uri::setQuirkOption</b> <u>NoInitialSlash</u> 1

       •      <b>uri::setQuirkOption</b> <u>NoExtraKeys</u> 0

       •      <b>uri::setQuirkOption</b> <u>HostAsDriveLetter</u> 0

       •      <b>uri::setQuirkOption</b> <u>RemoveDoubleSlashes</u> 1

</pre><h4><b>EXAMPLES</b></h4><pre>
       A Windows® local filename such as "<b>C:\Other</b> <b>Files\startup.txt</b>" is  not  suitable  for  use  as  the  <b>path</b>
       element of a URI in the scheme <u>file</u>.

       The Tcl command <b>file</b> <b>normalize</b> will convert the backslashes to forward slashes.  To generate a valid <b>path</b>
       for  the scheme <u>file</u>, the normalized filename must be prepended with "<b>/</b>", and then any characters that do
       not match the <b>regexp</b> bracket expression

                  [a-zA-Z0-9$_.+!*'(,)?:@&amp;=-]

       must be percent-encoded.

       The result in this example is "<b>/C:/Other%20Files/startup.txt</b>" which is a valid value for <b>path</b>.

              % uri::join path /C:/Other%20Files/startup.txt scheme file

              file:///C:/Other%20Files/startup.txt

              % uri::split file:///C:/Other%20Files/startup.txt

              path /C:/Other%20Files/startup.txt scheme file

       On UNIX® systems filenames begin with "<b>/</b>" which is also used as the directory separator.  The only action
       needed to convert a filename to a valid <b>path</b> is percent-encoding.

</pre><h4><b>CREDITS</b></h4><pre>
       Original code (regular  expressions)  by  Andreas  Kupries.   Modularisation  by  Steve  Ball,  also  the
       split/join/resolve functionality. RFC 3986 conformance by Keith Nash.

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This  document,  and  the package it describes, will undoubtedly contain bugs and other problems.  Please
       report such in the category <u>uri</u> of the <u>Tcllib</u>  <u>Trackers</u>  [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].   Please
       also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note  further  that  <u>attachments</u>  are strongly preferred over inlined patches. Attachments can be made by
       going to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most  button
       in the secondary navigation bar.

</pre><h4><b>KEYWORDS</b></h4><pre>
       fetching  information,  file, ftp, gopher, http, https, ldap, mailto, news, prospero, rfc 1630, rfc 2255,
       rfc 2396, rfc 3986, uri, url, wais, www

</pre><h4><b>CATEGORY</b></h4><pre>
       Networking

tcllib                                                1.2.8                                            <u><a href="../man3tcl/uri.3tcl.html">uri</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>