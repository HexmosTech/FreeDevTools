<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sc::MBPT2 - The MBPT2 class implements several second-order perturbation theory methods.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/libsc-doc">libsc-doc_2.3.1-21_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sc::MBPT2 - The <b>MBPT2</b> class implements several second-order perturbation theory methods.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;mbpt.h&gt;

       Inherits <b>sc::Wavefunction</b>.

       Inherited by <b>sc::MBPT2_R12</b>.

   <b>Public</b> <b>Member</b> <b>Functions</b>
       <b>MBPT2</b> (<b>StateIn</b> &amp;)
       <b>MBPT2</b> (const <b>Ref</b>&lt; <b>KeyVal</b> &gt; &amp;)
           The <b>KeyVal</b> constructor.
       void <b>save_data_state</b> (<b>StateOut</b> &amp;)
           Save the base classes (with save_data_state) and the members in the same order that the <b>StateIn</b> CTOR
           initializes them.
       <b>Ref</b>&lt; <b>SCF</b> &gt; <b>ref</b> ()
       double <b>ref_energy</b> ()
       double <b>corr_energy</b> ()
       <b>RefSCVector</b> <b>ref_energy_gradient</b> ()
       <b>RefSCVector</b> <b>corr_energy_gradient</b> ()
       int <b>nelectron</b> ()
           Returns the number of electrons.
       int <b>nfzcore</b> () const
       int <b>nfzvirt</b> () const
       <b>RefSymmSCMatrix</b> <b>density</b> ()
           Returns the <b>SO</b> density.
       int <b>spin_polarized</b> ()
           Return 1 if the alpha density is not equal to the beta density.
       int <b>gradient_implemented</b> () const
       int <b>value_implemented</b> () const
           Information about the availability of values, gradients, and hessians.
       void <b>symmetry_changed</b> ()
           Call this if you have changed the molecular symmetry of the molecule contained by this
           <b>MolecularEnergy</b>.
       void <b>obsolete</b> ()
           Marks all results as being out of date.
       void <b>print</b> (std::ostream &amp;o=<b>ExEnv::out0</b>()) const
           Print information about the object.

   <b>Protected</b> <b>Member</b> <b>Functions</b>
       void <b>init_variables</b> ()
       void <b>compute</b> ()
           Recompute at least the results that have compute true and are not already computed.
       void <b>eigen</b> (<b>RefDiagSCMatrix</b> &amp;vals, <b>RefSCMatrix</b> &amp;vecs, <b>RefDiagSCMatrix</b> &amp;occs)
       void <b>compute_hsos_v1</b> ()
       <b>distsize_t</b> <b>compute_v2_memory</b> (int ni, int nfuncmax, int nbfme, int nshell, int ndocc, int nsocc, int
           nvir, int nproc)
       void <b>compute_hsos_v2</b> ()
       void <b>compute_hsos_v2_lb</b> ()
       int <b>compute_cs_batchsize</b> (size_t mem_static, int nocc_act)
       <b>distsize_t</b> <b>compute_cs_dynamic_memory</b> (int ni, int nocc_act)
       int <b>make_cs_gmat</b> (<b>RefSymmSCMatrix</b> &amp;Gmat, double *DPmat)
       int <b>make_cs_gmat_new</b> (<b>RefSymmSCMatrix</b> &amp;Gmat, const <b>RefSymmSCMatrix</b> &amp;DPmat)
       void <b>form_max_dens</b> (double *DPmat, signed char *maxp)
       int <b>init_cs_gmat</b> ()
       void <b>done_cs_gmat</b> ()
       int <b>make_g_d_nor</b> (<b>RefSymmSCMatrix</b> &amp;Gmat, double *DPmat, const double *mgdbuff)
       void <b>cs_cphf</b> (double **scf_vector, double *Laj, double *eigval, <b>RefSCMatrix</b> &amp;P2aj)
       void <b>s2pdm_contrib</b> (const double *intderbuf, double *PHF, double *P2AO, double **hf_ginter, double
           **ginter)
       void <b>hcore_cs_grad</b> (double *PHF, double *PMP2, double **hf_ginter, double **ginter)
       void <b>overlap_cs_grad</b> (double *WHF, double *WMP2, double **hf_ginter, double **ginter)
       void <b>compute_cs_grad</b> ()

   <b>Protected</b> <b>Attributes</b>
       <b>Ref</b>&lt; <b>SCF</b> &gt; <b>reference_</b>
       <b>Ref</b>&lt; <b>MemoryGrp</b> &gt; <b>mem</b>
       int <b>nfzc</b>
       int <b>nfzv</b>
       size_t <b>mem_alloc</b>
       double <b>cphf_epsilon_</b>
       int <b>eliminate_in_gmat_</b>
       const double * <b>intbuf_</b>
       <b>Ref</b>&lt; <b>TwoBodyInt</b> &gt; <b>tbint_</b>
       <b>Ref</b>&lt; <b>TwoBodyInt</b> &gt; * <b>tbints_</b>
       <b>Ref</b>&lt; <b>TwoBodyDerivInt</b> &gt; * <b>tbintder_</b>
       int <b>nbasis</b>
       int <b>noso</b>
       <b>Ref</b>&lt; <b>MessageGrp</b> &gt; <b>msg_</b>
       int <b>nvir</b>
       int <b>nocc</b>
       int <b>nsocc</b>
       <b>Ref</b>&lt; <b>ThreadGrp</b> &gt; <b>thr_</b>
       int <b>dynamic_</b>
       double <b>print_percent_</b>
       int <b>max_norb_</b>
       int * <b>symorb_irrep_</b>
       int * <b>symorb_num_</b>
       char * <b>method_</b>
       char * <b>algorithm_</b>
       int <b>do_d1_</b>
       int <b>do_d2_</b>
       int <b>nfuncmax</b>
       double <b>hf_energy_</b>
       <b>RefSCVector</b> <b>hf_gradient_</b>
       double <b>restart_ecorr_</b>
       int <b>restart_orbital_v1_</b>
       int <b>restart_orbital_memgrp_</b>

   <b>Additional</b> <b>Inherited</b> <b>Members</b>
</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       The <b>MBPT2</b> class implements several second-order perturbation theory methods.

</pre><h4><b>Constructor</b> <b>&amp;</b> <b>Destructor</b> <b>Documentation</b></h4><pre>
   <b>sc::MBPT2::MBPT2</b> <b>(const</b> <b>Ref&lt;</b> <b>KeyVal</b> <b>&gt;</b> <b>&amp;)</b>
       The <b>KeyVal</b> constructor.

       <b>reference</b>
           This  gives the reference wavefunction. It must be an object of type <b>CLSCF</b> for closed-shell molecules
           and <b>HSOSSCF</b> for open-shell molecules. The is no default.

       <b>nfzc</b>
           The number of frozen core orbitals. The default is 0. If no atoms have an atomic number greater  than
           30,  then  the  number  of orbitals to be frozen can be automatically determined by specifying nfzc =
           auto.

       <b>nfzv</b>
           The number of frozen virtual orbitals. The default is 0.

       <b>memory</b>
           The amount of memory, in bytes, that each processor may use.

       <b>method</b>
           This gives a string that must take on one of the values below. The default  is  mp  for  closed-shell
           systems and zapt for open-shell systems.

       <b>mp</b>  Use  M/ller-Plesset  perturbation  theory.  This is only valid for closed-shell systems. Energies and
           gradients can be computed with this method.

       <b>opt1</b>
           Use the OPT1 variant of open-shell perturbation theory. Only energies can be computed for  open-shell
           systems.

       <b>opt2</b>
           Use  the OPT2 variant of open-shell perturbation theory. Only energies can be computed for open-shell
           systems.

       <b>zapt</b>
           Use the ZAPT variant of open-shell perturbation theory. Only energies can be computed for  open-shell
           systems.

       <b>algorithm</b>
           This  gives  a  string  that  must  take  on one of the values given below. The default is memgrp for
           closed-shell systems. For open-shell systems v1 is used for a small number of processors  and  v2  is
           used otherwise.

       <b>memgrp</b>
           Use  the  distributed shared memory algorithm (which uses a <b>MemoryGrp</b> object). This is only valid for
           MP2 energies and gradients.

       <b>v1</b>  Use algorithm V1. Only energies can be computed.  The  maximum  number  of  processors  that  can  be
           utilized  is  the  number of virtual orbitals. This algorithm computes few integrals than the others,
           but has higher communication requirements.

       <b>v2</b>  Use algorithm V2. Only energies can be computed.  The  maximum  number  of  processors  that  can  be
           utilized is the number of shells.

       <b>v2lb</b>
           Use  a  modified  V2  algorithm that may compute more two electron integrals, but may get better load
           balance on the $O(n_thrm{basis}^5)$ part of the calculation. Only energies can be computed.  This  is
           recommended only for computations involving large molecules (where the transformation is dominant) on
           very many processors (approaching the number of shells).

       The  v1 and v2 algorithms are discussed in Ida M. B. Nielsen and Edward T. Seidl, J. Comp. Chem. 16, 1301
       (1995). The memgrp algorithm is discussed in Ida M. B. Nielsen, Chem. Phys. Lett. 255, 210 (1996).

       <b>memorygrp</b>
           A <b>MemoryGrp</b> object is used by the memgrp algorithm. If this is not given the program will try to find
           an appropriate default.

</pre><h4><b>Member</b> <b>Function</b> <b>Documentation</b></h4><pre>
   <b>void</b> <b>sc::MBPT2::compute</b> <b>()</b> <b>[protected],</b>  <b>[virtual]</b>
       Recompute at least the results that have compute true and are not already computed. This should  only  be
       called by <b>Result</b>'s members.

       Implements <b>sc::Compute</b>.

       Reimplemented in <b>sc::MBPT2_R12</b>.

   <b>void</b> <b>sc::MBPT2::obsolete</b> <b>()</b> <b>[virtual]</b>
       Marks all results as being out of date. Any subsequent access to results will cause <b>Compute::compute()</b> to
       be called.

       Reimplemented from <b>sc::Compute</b>.

       Reimplemented in <b>sc::MBPT2_R12</b>.

   <b>void</b> <b>sc::MBPT2::save_data_state</b> <b>(StateOut</b> <b>&amp;)</b> <b>[virtual]</b>
       Save  the  base  classes  (with  save_data_state) and the members in the same order that the <b>StateIn</b> CTOR
       initializes them. This must be implemented by the derived class if the class has data.

       Reimplemented from <b>sc::MolecularEnergy</b>.

       Reimplemented in <b>sc::MBPT2_R12</b>.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for MPQC from the source code.

Version 2.3.1                                    Sun Oct 4 2020                                     <u>sc::<a href="../man3/MBPT2.3.html">MBPT2</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>