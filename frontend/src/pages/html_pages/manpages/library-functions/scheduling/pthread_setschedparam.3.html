<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pthread_setschedparam, pthread_getschedparam - set/get scheduling policy and parameters of a thread</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pthread_setschedparam, pthread_getschedparam - set/get scheduling policy and parameters of a thread

</pre><h4><b>LIBRARY</b></h4><pre>
       POSIX threads library (<u>libpthread</u>, <u>-lpthread</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/pthread.h">pthread.h</a>&gt;</b>

       <b>int</b> <b>pthread_setschedparam(pthread_t</b> <u>thread</u><b>,</b> <b>int</b> <u>policy</u><b>,</b>
                                 <b>const</b> <b>struct</b> <b>sched_param</b> <b>*</b><u>param</u><b>);</b>
       <b>int</b> <b>pthread_getschedparam(pthread_t</b> <u>thread</u><b>,</b> <b>int</b> <b>*restrict</b> <u>policy</u><b>,</b>
                                 <b>struct</b> <b>sched_param</b> <b>*restrict</b> <u>param</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>pthread_setschedparam</b>() function sets the scheduling policy and parameters of the thread <u>thread</u>.

       <u>policy</u>  specifies  the  new  scheduling  policy  for  <u>thread</u>.  The supported values for <u>policy</u>, and their
       semantics, are described in <b><a href="../man7/sched.7.html">sched</a></b>(7).

       The structure pointed to by <u>param</u>  specifies  the  new  scheduling  parameters  for  <u>thread</u>.   Scheduling
       parameters are maintained in the following structure:

           struct sched_param {
               int sched_priority;     /* Scheduling priority */
           };

       As  can  be  seen,  only  one scheduling parameter is supported.  For details of the permitted ranges for
       scheduling priorities in each scheduling policy, see <b><a href="../man7/sched.7.html">sched</a></b>(7).

       The <b>pthread_getschedparam</b>() function returns the scheduling policy and parameters of the  thread  <u>thread</u>,
       in  the buffers pointed to by <u>policy</u> and <u>param</u>, respectively.  The returned priority value is that set by
       the most recent <b>pthread_setschedparam</b>(), <b><a href="../man3/pthread_setschedprio.3.html">pthread_setschedprio</a></b>(3), or <b><a href="../man3/pthread_create.3.html">pthread_create</a></b>(3) call that affected
       <u>thread</u>.  The returned priority does not reflect any temporary priority adjustments as a result  of  calls
       to    any    priority    inheritance    or    priority    ceiling    functions    (see,    for   example,
       <b><a href="../man3/pthread_mutexattr_setprioceiling.3.html">pthread_mutexattr_setprioceiling</a></b>(3) and <b><a href="../man3/pthread_mutexattr_setprotocol.3.html">pthread_mutexattr_setprotocol</a></b>(3)).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On  success,  these  functions  return  0;  on  error,  they  return  a   nonzero   error   number.    If
       <b>pthread_setschedparam</b>() fails, the scheduling policy and parameters of <u>thread</u> are not changed.

</pre><h4><b>ERRORS</b></h4><pre>
       Both of these functions can fail with the following error:

       <b>ESRCH</b>  No thread with the ID <u>thread</u> could be found.

       <b>pthread_setschedparam</b>() may additionally fail with the following errors:

       <b>EINVAL</b> <u>policy</u> is not a recognized policy, or <u>param</u> does not make sense for the <u>policy</u>.

       <b>EPERM</b>  The  caller  does  not  have  appropriate  privileges  to  set the specified scheduling policy and
              parameters.

       POSIX.1 also documents an <b>ENOTSUP</b> ("attempt was made to set the policy or  scheduling  parameters  to  an
       unsupported value") error for <b>pthread_setschedparam</b>().

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       For an explanation of the terms used in this section, see <b><a href="../man7/attributes.7.html">attributes</a></b>(7).
       ┌─────────────────────────────────────────────────────────────────────────────┬───────────────┬─────────┐
       │ <b>Interface</b>                                                                   │ <b>Attribute</b>     │ <b>Value</b>   │
       ├─────────────────────────────────────────────────────────────────────────────┼───────────────┼─────────┤
       │ <b>pthread_setschedparam</b>(), <b>pthread_getschedparam</b>()                            │ Thread safety │ MT-Safe │
       └─────────────────────────────────────────────────────────────────────────────┴───────────────┴─────────┘

</pre><h4><b>STANDARDS</b></h4><pre>
       POSIX.1-2008.

</pre><h4><b>HISTORY</b></h4><pre>
       glibc 2.0 POSIX.1-2001.

</pre><h4><b>NOTES</b></h4><pre>
       For  a  description  of  the  permissions  required to, and the effect of, changing a thread's scheduling
       policy and priority, and details of the permitted ranges for priorities in each  scheduling  policy,  see
       <b><a href="../man7/sched.7.html">sched</a></b>(7).

</pre><h4><b>EXAMPLES</b></h4><pre>
       The program below demonstrates the use of <b>pthread_setschedparam</b>() and <b>pthread_getschedparam</b>(), as well as
       the use of a number of other scheduling-related pthreads functions.

       In the following run, the main thread sets its scheduling policy to <b>SCHED_FIFO</b> with a priority of 10, and
       initializes  a  thread  attributes object with a scheduling policy attribute of <b>SCHED_RR</b> and a scheduling
       priority attribute of 20.  The program then  sets  (using  <b><a href="../man3/pthread_attr_setinheritsched.3.html">pthread_attr_setinheritsched</a></b>(3))  the  inherit
       scheduler  attribute  of  the  thread  attributes  object to <b>PTHREAD_EXPLICIT_SCHED</b>, meaning that threads
       created using this attributes object should take their scheduling attributes from the  thread  attributes
       object.   The  program then creates a thread using the thread attributes object, and that thread displays
       its scheduling policy and priority.

           $ <b>su</b>      # Need privilege to set real-time scheduling policies
           Password:
           # <b>./a.out</b> <b>-mf10</b> <b>-ar20</b> <b>-i</b> <b>e</b>
           Scheduler settings of main thread
               policy=SCHED_FIFO, priority=10

           Scheduler settings in 'attr'
               policy=SCHED_RR, priority=20
               inheritsched is EXPLICIT

           Scheduler attributes of new thread
               policy=SCHED_RR, priority=20

       In the above output, one can see that the scheduling policy and  priority  were  taken  from  the  values
       specified in the thread attributes object.

       The  next  run  is  the  same  as  the  previous,  except  that the inherit scheduler attribute is set to
       <b>PTHREAD_INHERIT_SCHED</b>, meaning that threads created using the thread attributes object should ignore  the
       scheduling  attributes  specified  in  the attributes object and instead take their scheduling attributes
       from the creating thread.

           # <b>./a.out</b> <b>-mf10</b> <b>-ar20</b> <b>-i</b> <b>i</b>
           Scheduler settings of main thread
               policy=SCHED_FIFO, priority=10

           Scheduler settings in 'attr'
               policy=SCHED_RR, priority=20
               inheritsched is INHERIT

           Scheduler attributes of new thread
               policy=SCHED_FIFO, priority=10

       In the above output, one can see that the scheduling policy and priority were  taken  from  the  creating
       thread, rather than the thread attributes object.

       Note   that  if  we  had  omitted  the  <u>-i</u>  <u>i</u>  option,  the  output  would  have  been  the  same,  since
       <b>PTHREAD_INHERIT_SCHED</b> is the default for the inherit scheduler attribute.

   <b>Program</b> <b>source</b>

       /* pthreads_sched_test.c */

       #include &lt;<a href="file:/usr/include/errno.h">errno.h</a>&gt;
       #include &lt;<a href="file:/usr/include/pthread.h">pthread.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;
       #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;

       #define handle_error_en(en, msg) \
               do { errno = en; <a href="../manmsg/perror.msg.html">perror</a>(msg); exit(EXIT_FAILURE); } while (0)

       [[noreturn]]
       static void
       usage(char *prog_name, char *msg)
       {
           if (msg != NULL)
               fputs(msg, stderr);

           fprintf(stderr, "Usage: %s [options]\n", prog_name);
           fprintf(stderr, "Options are:\n");
       #define <a href="../manmsg/fpe.msg.html">fpe</a>(msg) fprintf(stderr, "\t%s", msg)          /* Shorter */
           fpe("-a&lt;policy&gt;&lt;prio&gt; Set scheduling policy and priority in\n");
           fpe("                 thread attributes object\n");
           fpe("                 &lt;policy&gt; can be\n");
           fpe("                     f  SCHED_FIFO\n");
           fpe("                     r  SCHED_RR\n");
           fpe("                     o  SCHED_OTHER\n");
           fpe("-A               Use default thread attributes object\n");
           fpe("-i {e|i}         Set inherit scheduler attribute to\n");
           fpe("                 'explicit' or 'inherit'\n");
           fpe("-m&lt;policy&gt;&lt;prio&gt; Set scheduling policy and priority on\n");
           fpe("                 main thread before pthread_create() call\n");
           exit(EXIT_FAILURE);
       }

       static int
       get_policy(char p, int *policy)
       {
           switch (p) {
           case 'f': *policy = SCHED_FIFO;     return 1;
           case 'r': *policy = SCHED_RR;       return 1;
           case 'o': *policy = SCHED_OTHER;    return 1;
           default:  return 0;
           }
       }

       static void
       display_sched_attr(int policy, const struct sched_param *param)
       {
           printf("    policy=%s, priority=%d\n",
                  (policy == SCHED_FIFO)  ? "SCHED_FIFO" :
                  (policy == SCHED_RR)    ? "SCHED_RR" :
                  (policy == SCHED_OTHER) ? "SCHED_OTHER" :
                  "???",
                  param-&gt;sched_priority);
       }

       static void
       display_thread_sched_attr(char *msg)
       {
           int policy, s;
           struct sched_param param;

           s = pthread_getschedparam(pthread_self(), &amp;policy, &amp;param);
           if (s != 0)
               handle_error_en(s, "pthread_getschedparam");

           printf("%s\n", msg);
           display_sched_attr(policy, &amp;param);
       }

       static void *
       thread_start(void *arg)
       {
           display_thread_sched_attr("Scheduler attributes of new thread");

           return NULL;
       }

       int
       main(int argc, char *argv[])
       {
           int s, opt, inheritsched, use_null_attrib, policy;
           pthread_t thread;
           pthread_attr_t attr;
           pthread_attr_t *attrp;
           char *attr_sched_str, *main_sched_str, *inheritsched_str;
           struct sched_param param;

           /* Process command-line options. */

           use_null_attrib = 0;
           attr_sched_str = NULL;
           main_sched_str = NULL;
           inheritsched_str = NULL;

           while ((opt = getopt(argc, argv, "a:Ai:m:")) != -1) {
               switch (opt) {
               case 'a': attr_sched_str = optarg;      break;
               case 'A': use_null_attrib = 1;          break;
               case 'i': inheritsched_str = optarg;    break;
               case 'm': main_sched_str = optarg;      break;
               default:  usage(argv[0], "Unrecognized option\n");
               }
           }

           if (use_null_attrib
               &amp;&amp; (inheritsched_str != NULL || attr_sched_str != NULL))
           {
               usage(argv[0], "Can't specify -A with -i or -a\n");
           }

           /* Optionally set scheduling attributes of main thread,
              and display the attributes. */

           if (main_sched_str != NULL) {
               if (!get_policy(main_sched_str[0], &amp;policy))
                   usage(argv[0], "Bad policy for main thread (-m)\n");
               param.sched_priority = strtol(&amp;main_sched_str[1], NULL, 0);

               s = pthread_setschedparam(pthread_self(), policy, &amp;param);
               if (s != 0)
                   handle_error_en(s, "pthread_setschedparam");
           }

           display_thread_sched_attr("Scheduler settings of main thread");
           printf("\n");

           /* Initialize thread attributes object according to options. */

           attrp = NULL;

           if (!use_null_attrib) {
               s = pthread_attr_init(&amp;attr);
               if (s != 0)
                   handle_error_en(s, "pthread_attr_init");
               attrp = &amp;attr;
           }

           if (inheritsched_str != NULL) {
               if (inheritsched_str[0] == 'e')
                   inheritsched = PTHREAD_EXPLICIT_SCHED;
               else if (inheritsched_str[0] == 'i')
                   inheritsched = PTHREAD_INHERIT_SCHED;
               else
                   usage(argv[0], "Value for -i must be 'e' or 'i'\n");

               s = pthread_attr_setinheritsched(&amp;attr, inheritsched);
               if (s != 0)
                   handle_error_en(s, "pthread_attr_setinheritsched");
           }

           if (attr_sched_str != NULL) {
               if (!get_policy(attr_sched_str[0], &amp;policy))
                   usage(argv[0], "Bad policy for 'attr' (-a)\n");
               param.sched_priority = strtol(&amp;attr_sched_str[1], NULL, 0);

               s = pthread_attr_setschedpolicy(&amp;attr, policy);
               if (s != 0)
                   handle_error_en(s, "pthread_attr_setschedpolicy");
               s = pthread_attr_setschedparam(&amp;attr, &amp;param);
               if (s != 0)
                   handle_error_en(s, "pthread_attr_setschedparam");
           }

           /* If we initialized a thread attributes object, display
              the scheduling attributes that were set in the object. */

           if (attrp != NULL) {
               s = pthread_attr_getschedparam(&amp;attr, &amp;param);
               if (s != 0)
                   handle_error_en(s, "pthread_attr_getschedparam");
               s = pthread_attr_getschedpolicy(&amp;attr, &amp;policy);
               if (s != 0)
                   handle_error_en(s, "pthread_attr_getschedpolicy");

               printf("Scheduler settings in 'attr'\n");
               display_sched_attr(policy, &amp;param);

               pthread_attr_getinheritsched(&amp;attr, &amp;inheritsched);
               printf("    inheritsched is %s\n",
                      (inheritsched == PTHREAD_INHERIT_SCHED)  ? "INHERIT" :
                      (inheritsched == PTHREAD_EXPLICIT_SCHED) ? "EXPLICIT" :
                      "???");
               printf("\n");
           }

           /* Create a thread that will display its scheduling attributes. */

           s = pthread_create(&amp;thread, attrp, &amp;thread_start, NULL);
           if (s != 0)
               handle_error_en(s, "pthread_create");

           /* Destroy unneeded thread attributes object. */

           if (!use_null_attrib) {
             s = pthread_attr_destroy(&amp;attr);
             if (s != 0)
                 handle_error_en(s, "pthread_attr_destroy");
           }

           s = pthread_join(thread, NULL);
           if (s != 0)
               handle_error_en(s, "pthread_join");

           exit(EXIT_SUCCESS);
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/getrlimit.2.html">getrlimit</a></b>(2), <b><a href="../man2/sched_get_priority_min.2.html">sched_get_priority_min</a></b>(2), <b><a href="../man3/pthread_attr_init.3.html">pthread_attr_init</a></b>(3), <b><a href="../man3/pthread_attr_setinheritsched.3.html">pthread_attr_setinheritsched</a></b>(3),
       <b><a href="../man3/pthread_attr_setschedparam.3.html">pthread_attr_setschedparam</a></b>(3), <b><a href="../man3/pthread_attr_setschedpolicy.3.html">pthread_attr_setschedpolicy</a></b>(3), <b><a href="../man3/pthread_create.3.html">pthread_create</a></b>(3), <b><a href="../man3/pthread_self.3.html">pthread_self</a></b>(3),
       <b><a href="../man3/pthread_setschedprio.3.html">pthread_setschedprio</a></b>(3), <b><a href="../man7/pthreads.7.html">pthreads</a></b>(7), <b><a href="../man7/sched.7.html">sched</a></b>(7)

Linux man-pages 6.9.1                              2024-06-15                           <u><a href="../man3/pthread_setschedparam.3.html">pthread_setschedparam</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>