<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmdaGetOpt, pmdaGetOptions - get options from arguments, parsing generic PMDA options</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpcp-pmda3-dev">libpcp-pmda3-dev_6.3.8-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>pmdaGetOpt</b>, <b>pmdaGetOptions</b> - get options from arguments, parsing generic PMDA options

</pre><h4><b>C</b> <b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;pcp/pmapi.h&gt;</b>
       <b>#include</b> <b>&lt;pcp/pmda.h&gt;</b>

       <b>int</b> <b>pmdaGetOptions(int</b> <u>argc</u><b>,</b> <b>char</b> <b>*const</b> <b>*</b><u>argv</u><b>,</b> <b>pmdaOptions</b> <b>*</b><u>opts</u><b>,</b> <b>pmdaInterface</b> <b>*</b><u>dispatch</u><b>);</b>

       <b>int</b> <b>pmdaGetOpt(int</b> <u>argc</u><b>,</b> <b>char</b> <b>*const</b> <b>*</b><u>argv</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>optstring</u><b>,</b> <b>pmdaInterface</b> <b>*</b><u>dispatch</u><b>,</b> <b>int</b> <b>*</b><u>err</u><b>);</b>

       <b>cc</b> <b>...</b> <b>-lpcp_pmda</b> <b>-lpcp</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These  functions  are  wrappers for <b><a href="../man3/pmgetopt_r.3.html">pmgetopt_r</a></b>(3).  The behavior of each function is that certain options
       are assumed to have a predefined behavior which initializes several fields in  the  <b>pmdaInterface</b>  struc‐
       ture.   The  <b>pmdaGetOptions</b>  interface allows both short and long options to be given, whereas <b>pmdaGetOpt</b>
       allows for short form options only.

       The options that both <b>pmdaGetOptions</b> and <b>pmdaGetOpt</b> will trap are:

       <b>-D</b><u>debugspec</u>    Set the <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3) debugging options to <u>debugspec</u>, as described in  <b><a href="../man1/PCPIntro.1.html">PCPIntro</a></b>(1).   Used  for
                      controlling levels of trace output while debugging.

       <b>-d</b><u>domain</u>       Set the <u>domain</u> number of this agent.

       <b>-h</b><u>helpfile</u>     Obtain the help text (see <b><a href="../man3/pmdaText.3.html">pmdaText</a></b>(3)) for the metrics from this file rather than from the
                      path specified with <b><a href="../man3/pmdaDSO.3.html">pmdaDSO</a></b>(3) or <b><a href="../man3/pmdaDaemon.3.html">pmdaDaemon</a></b>(3).

       <b>-i</b><u>port</u>         Expect PMCD to connect on inet <u>port</u> (number or name).

       <b>-6</b><u>port</u>         Expect PMCD to connect on ipv6 <u>port</u> (number or name).

       <b>-l</b><u>logfile</u>      Redirect diagnostics and trace output to <u>logfile</u>.

       <b>-p</b>             Expect PMCD to supply stdin/stdout pipe.

       <b>-u</b><u>socket</u>       Expect PMCD to connect on unix domain <u>socket</u>.

       The  <b>pmdaGetOptions</b> interface will also capture the following options, and store them within the <u>opts</u> pa‐
       rameter:

       <b>-U</b><u>username</u>     Set the user account name under which the PMDA should execute.

       Only one of <b>-i</b>, <b>-6</b>, <b>-p</b> and <b>-u</b> may be specified.  If none of these three options is given, a pipe (<b>-p</b>)  is
       assumed.   When  these options are encountered by <b>pmdaGetOpt</b>, the option is processed and the next option
       is examined.  Therefore, <b>pmdaGetOpt</b> will only return when an option other  than  those  listed  above  is
       found, or the end of the list is reached.  The returned value will be the argument or EOF, respectively.

       A PMDA can control which of these options the program will accept with either the <u>opts</u> or <u>optstring</u> argu‐
       ment.  To accept all the options, the PMDA should call <b>pmdaGetOptions</b> with the short_options field of the
       <u>opts</u>  structure set to the PMDA_OPTIONS macro, or <b>pmdaGetOpt</b> with the option string "D:d:h:i:l:pu:".  Any
       PMDA specific options should be added to these strings in the style of <b><a href="../man3/getopt.3.html">getopt</a></b>(3), and will be returned by
       both <b>pmdaGetOptions</b> and <b>pmdaGetOpt</b> if encountered.

       When a command line option usage error is detected in the <b>pmdaGetOptions</b> interface, the  error  field  of
       the <u>opts</u> structure will contain a non-zero error count.

       <b>pmdaGetOpt</b> takes a pointer to an int, <u>err</u>, which is used as an error count.  This variable should be ini‐
       tialized to zero before <b>pmdaGetOpt</b> is first called, and tested when <b>pmdaGetOpt</b> returns EOF.

       Neither <b>pmdaGetOptions</b> nor <b>pmdaGetOpt</b> modify their <u>argc</u> or <u>argv</u> parameters.

       The global variables used by the system <b>getopt</b> <b>(3)</b> interface may also be used by the caller of <b>pmdaGetOpt</b>
       within the argument parsing loop.

       On the other hand, the <b>pmdaGetOptions</b> interface does not utilize global variables at all (neither reading
       nor modifying them).  Instead, these variables can be access via the <u>opts</u> fields of the same name.

</pre><h4><b>CAVEAT</b></h4><pre>
       The  options  <b>-D</b>, <b>-d</b>, <b>-i</b>, <b>-l</b>, <b>-p</b> and <b>-u</b> cannot be reused for other purposes by the PMDA, unless using the
       <u>override</u> method provided by the <b>pmdaGetOptions</b> interface, which operates in the same way as described for
       the <b><a href="../man3/pmGetOptions.3.html">pmGetOptions</a></b>(3) interface used by PMAPI client tools.

       The PMDA must be using <b>PMDA_INTERFACE_2</b> or later, as specified in the  call  to  <b><a href="../man3/pmdaDSO.3.html">pmdaDSO</a></b>(3)  or  <b>pmdaDae‐</b>
       <b><a href="../man3/mon.3.html">mon</a></b>(3).

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       Both <b>pmdaGetOptions</b> and <b>pmdaGetOpt</b> will display the same error messages as <b>getopt</b>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/pmdbg.1.html">pmdbg</a></b>(1), <b><a href="../man3/getopt.3.html">getopt</a></b>(3), <b><a href="../man3/pmgetopt_r.3.html">pmgetopt_r</a></b>(3), <b><a href="../man3/pmGetOptions.3.html">pmGetOptions</a></b>(3), <b><a href="../man3/PMAPI.3.html">PMAPI</a></b>(3), <b><a href="../man3/PMDA.3.html">PMDA</a></b>(3), <b><a href="../man3/pmdaDaemon.3.html">pmdaDaemon</a></b>(3), <b><a href="../man3/pmdaDSO.3.html">pmdaDSO</a></b>(3) and <b>pm‐</b>
       <b><a href="../man3/daText.3.html">daText</a></b>(3).

Performance Co-Pilot                                   PCP                                     <u><a href="../man3/PMDAGETOPTIONS.3.html">PMDAGETOPTIONS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>