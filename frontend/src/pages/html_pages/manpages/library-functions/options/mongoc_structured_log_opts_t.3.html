<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>typedef struct mongoc_structured_log_opts_t mongoc_structured_log_opts_t;</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmongoc-doc">libmongoc-doc_1.30.4-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>SYNOPSIS</b></h4><pre>
          typedef struct mongoc_structured_log_opts_t mongoc_structured_log_opts_t;

       <b>mongoc_structured_log_opts_t</b>  is  an  opaque  type  that  contains  options  for  the  structured logging
       subsystem: per-component log levels, a maximum logged document length, and a handler function.

       Create a <b>mongoc_structured_log_opts_t</b> with <u>mongoc_structured_log_opts_new()</u>, set options and  a  callback
       on       it,       then       pass       it       to      <u>mongoc_client_set_structured_log_opts()</u>      or
       <u>mongoc_client_pool_set_structured_log_opts()</u>.        Must       be       destroyed       by       calling
       <u>mongoc_structured_log_opts_destroy()</u>.

</pre><h4><b>FUNCTIONS</b></h4><pre>
   <b>mongoc_structured_log_opts_new()</b>
   <b>Synopsis</b>
          mongoc_structured_log_opts_t *
          mongoc_structured_log_opts_new (void);

       Creates a new <u>mongoc_structured_log_opts_t</u>, filled with defaults captured from the current environment.

       Sets a default log handler which would write a text representation of each log message to <b>stderr</b>, <b>stdout</b>,
       or  another  file configurable using <b>MONGODB_LOG_PATH</b>.  This setting has no effect if the default handler
       is replaced using <u>mongoc_structured_log_opts_set_handler()</u>.

       Environment variable errors are non-fatal, and result in one-time warnings delivered as  an  unstructured
       log.

       Per-component maximum levels are initialized equivalently to:

          mongoc_structured_log_opts_set_max_level_for_all_components(opts, MONGOC_STRUCTURED_LOG_LEVEL_WARNING);
          mongoc_structured_log_opts_set_max_levels_from_env(opts);

   <b>Environment</b> <b>Variables</b>
       This is a full list of the captured environment variables.

       • <b>MONGODB_LOG_MAX_DOCUMENT_LENGTH</b>:  Maximum length for JSON-serialized documents that appear within a log
         message.   It  may  be  a  number,  in  bytes,  or  <b>unlimited</b>   (case   insensitive)   to   choose   an
         implementation-specific  value  near  the  maximum representable length.  By default, the limit is 1000
         bytes.  This limit affects interior documents like commands and replies, not  the  total  length  of  a
         structured log message.

       • <b>MONGODB_LOG_PATH</b>:  A  file  path  or  one  of  the  special strings <b>stderr</b> or <b>stdout</b> (case insensitive)
         specifying the destination for structured logs seen by the default handler.  By default, it  writes  to
         <b>stderr</b>.   This  path  will  be  captured  during  <b>mongoc_structured_log_opts_new()</b>,  but  it  will  not
         immediately be opened.  If the file can't be opened, a warning is then written to the unstructured  log
         and the handler writes structured logs to <b>stderr</b> instead.

         <b>WARNING:</b>
            When  a  file path is given for <b>MONGODB_LOG_PATH</b>, each log instance (one stand-alone client or pool)
            will separately open this file for append.  The results are operating system specific. On  UNIX-like
            platforms each instance's output will be interleaved, in most cases without splitting individual log
            messages.  Notably  on  Windows  the file will be opened in exclusive mode by the first instance and
            subsequent instances will fail, falling back on  the  default  of  <b>stderr</b>.   Applications  that  use
            multiple  processes or multiple client pools will likely want to supply a log handler that annotates
            each message with information about its originating log instance.

       • <b>MONGODB_LOG_COMMAND</b>:     A     log     level     name     to     set     as     the     maximum     for
         <b>MONGOC_STRUCTURED_LOG_COMPONENT_COMMAND</b>.

       • <b>MONGODB_LOG_TOPOLOGY</b>:     A     log     level     name     to     set     as     the     maximum    for
         <b>MONGOC_STRUCTURED_LOG_COMPONENT_TOPOLOGY</b>.

       • <b>MONGODB_LOG_SERVER_SELECTION</b>:    A    log    level    name    to    set    as    the    maximum     for
         <b>MONGOC_STRUCTURED_LOG_COMPONENT_SERVER_SELECTION</b>.

       • <b>MONGODB_LOG_CONNECTION</b>:     A     log     level     name     to     set     as    the    maximum    for
         <b>MONGOC_STRUCTURED_LOG_COMPONENT_CONNECTION</b>.

       • <b>MONGODB_LOG_ALL</b>: A log level name applied to all components not otherwise specified.

       Note that log level names are always case  insensitive.   This  is  a  full  list  of  recognized  names,
       including allowed aliases:

       • <b>emergency</b>, <b>off</b>

       • <b>alert</b>

       • <b>critical</b>

       • <b>error</b>

       • <b>warning</b>, <b>warn</b>

       • <b>notice</b>

       • <b>informational</b>, <b>info</b>

       • <b>debug</b>

       • <b>trace</b>

   <b>Returns</b>
       A newly allocated <u>mongoc_structured_log_opts_t</u>.

   <b>mongoc_structured_log_opts_destroy()</b>
   <b>Synopsis</b>
          void
          mongoc_structured_log_opts_destroy (mongoc_structured_log_opts_t *opts);

   <b>Parameters</b>
       • <b>opts</b>:  Pointer  to  a  <u>mongoc_structured_log_opts_t</u> allocated with <u>mongoc_structured_log_opts_new()</u>, or
         NULL.

   <b>Description</b>
       This function releases all resources associated with a  <u>mongoc_structured_log_opts_t</u>.   Does  nothing  if
       <b>opts</b> is NULL.

   <b>mongoc_structured_log_opts_set_handler()</b>
   <b>Synopsis</b>
          void
          mongoc_structured_log_opts_set_handler (mongoc_structured_log_opts_t *opts,
                                                  mongoc_structured_log_func_t log_func,
                                                  void *user_data);

       Sets the function to be called to handle structured log messages, as a <u>mongoc_structured_log_func_t</u>.

       The  callback  is  given a <u>mongoc_structured_log_entry_t</u> as a handle for obtaining additional information
       about the log message.  This entry pointer is only valid during a  callback,  because  it's  a  low  cost
       reference to temporary data.

       Structured  log  handlers  must  be thread-safe if they will be used with <u>mongoc_client_pool_t</u>.  Handlers
       must avoid unbounded recursion, preferably by avoiding the use of any <b>libmongoc</b> client or pool which uses
       the same handler.

       This function always replaces the default log handler from <u>mongoc_structured_log_opts_new()</u>,  if  it  was
       still set.  If the <b>log_func</b> is set to NULL, structured logging will be disabled.

   <b>Parameters</b>
       • <b>opts</b>: Structured log options, allocated with <u>mongoc_structured_log_opts_new()</u>.

       • <b>log_func</b>:  The  handler  to  install,  a  <u>mongoc_structured_log_func_t</u>,  or  NULL to disable structured
         logging.

       • <b>user_data</b>: Optional user data, passed on to the handler.

       <b>SEE</b> <b>ALSO:</b>
          <u>Structured</u> <u>Logging</u>

   <b>mongoc_structured_log_opts_set_max_level_for_component()</b>
   <b>Synopsis</b>
          bool
          mongoc_structured_log_opts_set_max_level_for_component (mongoc_structured_log_opts_t *opts,
                                                                  mongoc_structured_log_component_t component,
                                                                  mongoc_structured_log_level_t level);

       Sets the maximum log level per-component.  Only log messages at or below  this  severity  level  will  be
       passed to <u>mongoc_structured_log_func_t</u>.

       By    default,    each    component's   log   level   may   come   from   environment   variables.    See
       <u>mongoc_structured_log_opts_set_max_levels_from_env()</u>.

   <b>Parameters</b>
       • <b>opts</b>: Structured log options, allocated with <u>mongoc_structured_log_opts_new()</u>.

       • <b>component</b>: The component to set a max log level. for, as a <u>mongoc_structured_log_component_t</u>.

       • <b>level</b>: The new max log level for this component, as a <u>mongoc_structured_log_level_t</u>.

   <b>Returns</b>
       Returns <b>true</b> on success, or <b>false</b> if the supplied parameters were incorrect.

       <b>SEE</b> <b>ALSO:</b>
          <u>Structured</u> <u>Logging</u>

   <b>mongoc_structured_log_opts_set_max_level_for_all_components()</b>
   <b>Synopsis</b>
          bool
          mongoc_structured_log_opts_set_max_level_for_all_components (mongoc_structured_log_opts_t *opts,
                                                                       mongoc_structured_log_level_t level);

       Sets all per-component maximum log levels to the same value.  Only log messages at or below this severity
       level will be passed to <u>mongoc_structured_log_func_t</u>.  Effective even for logging components not known at
       compile-time.

   <b>Parameters</b>
       • <b>opts</b>: Structured log options, allocated with <u>mongoc_structured_log_opts_new()</u>.

       • <b>level</b>: The max log level for all components, as a <u>mongoc_structured_log_level_t</u>.

   <b>Returns</b>
       Returns <b>true</b> on success, or <b>false</b> if the supplied parameters were incorrect.

       <b>SEE</b> <b>ALSO:</b>
          <u>Structured</u> <u>Logging</u>

   <b>mongoc_structured_log_opts_set_max_levels_from_env()</b>
   <b>Synopsis</b>
          bool
          mongoc_structured_log_opts_set_max_levels_from_env (mongoc_structured_log_opts_t *opts);

       Sets any maximum log levels requested by  environment  variables:  <b>MONGODB_LOG_ALL</b>  for  all  components,
       followed  by  per-component log levels <b>MONGODB_LOG_COMMAND</b>, <b>MONGODB_LOG_CONNECTION</b>, <b>MONGODB_LOG_TOPOLOGY</b>,
       and <b>MONGODB_LOG_SERVER_SELECTION</b>.

       Expects the value to be recognizable by <u>mongoc_structured_log_get_named_level()</u>.  Parse errors may  cause
       a warning message, delivered via unstructured logging.

       Component levels with no valid environment variable setting will be left unmodified.

       This  happens  automatically  when <u>mongoc_structured_log_opts_new()</u> establishes defaults.  Any subsequent
       programmatic modifications to the <u>mongoc_structured_log_opts_t</u> will  override  the  environment  variable
       settings.   For  applications that desire the opposite behavior, where environment variables may override
       programmatic settings, they may call <b>mongoc_structured_log_opts_set_max_levels_from_env()</b>  after  calling
       <u>mongoc_structured_log_opts_set_max_level_for_component()</u>                                              and
       <u>mongoc_structured_log_opts_set_max_level_for_all_components()</u>.   This  will  process  the  environment  a
       second time, allowing it to override customized defaults.

   <b>Returns</b>
       Returns  <b>true</b>  on  success.   If  warnings  are encountered in the environment, returns <b>false</b> and may log
       additional information to the unstructured logging facility.  Note that, by design, these errors  are  by
       default  non-fatal.  When <u>mongoc_structured_log_opts_new()</u> internally calls this function, it ignores the
       return value.

       <b>SEE</b> <b>ALSO:</b>
          <u>Structured</u> <u>Logging</u>

   <b>mongoc_structured_log_opts_get_max_level_for_component()</b>
   <b>Synopsis</b>
          mongoc_structured_log_level_t
          mongoc_structured_log_opts_get_max_level_for_component (const mongoc_structured_log_opts_t *opts,
                                                                  mongoc_structured_log_component_t component);

   <b>Parameters</b>
       • <b>opts</b>: Structured log options, allocated with <u>mongoc_structured_log_opts_new()</u>.

       • <b>component</b>: Log component as a <u>mongoc_structured_log_component_t</u>.

   <b>Returns</b>
       Returns the configured maximum log level for a specific component,  as  a  <u>mongoc_structured_log_level_t</u>.
       This   may  be  the  last  value  set  with  <u>mongoc_structured_log_opts_set_max_level_for_component()</u>  or
       <u>mongoc_structured_log_opts_set_max_level_for_all_components()</u>, or it may be  the  default  obtained  from
       environment variables.  If an invalid or unknown component enum is given, returns the lowest log level.

       <b>SEE</b> <b>ALSO:</b>
          <u>Structured</u> <u>Logging</u>

   <b>mongoc_structured_log_opts_set_max_document_length()</b>
   <b>Synopsis</b>
          bool
          mongoc_structured_log_opts_set_max_document_length (mongoc_structured_log_opts_t *opts,
                                                              size_t max_document_length);

       Sets  a maximum length for BSON documents that appear serialized in JSON form as part of a structured log
       message.

       Serialized JSON will be truncated at  this  limit,  interpreted  as  a  count  of  UTF-8  encoded  bytes.
       Truncation  will  be indicated with a <b>...</b> suffix, the length of which is not included in the max document
       length. If truncation at the exact indicated length would  split  a  valid  UTF-8  sequence,  we  instead
       truncate the document earlier at the nearest boundary between code points.

   <b>Parameters</b>
       • <b>opts</b>: Structured log options, allocated with <u>mongoc_structured_log_opts_new()</u>.

       • <b>max_document_length</b>:  Maximum  length  for  each  embedded  JSON  document,  in bytes, not including an
         ellipsis (<b>...</b>) added to indicate truncation. Values near or above <b>INT_MAX</b> will be rejected.

   <b>Returns</b>
       Returns <b>true</b> on success, or <b>false</b> if the supplied maximum length is too large.

       <b>SEE</b> <b>ALSO:</b>
          <u>Structured</u> <u>Logging</u>
          <u>mongoc_structured_log_opts_set_max_document_length_from_env()</u>

   <b>mongoc_structured_log_opts_set_max_document_length_from_env()</b>
   <b>Synopsis</b>
          bool
          mongoc_structured_log_opts_set_max_document_length_from_env (mongoc_structured_log_opts_t *opts);

       Sets a maximum document length from the <b>MONGODB_LOG_MAX_DOCUMENT_LENGTH</b> environment variable, if a  valid
       setting  is  found.   See <u>mongoc_structured_log_opts_new()</u> for a description of the supported environment
       variable formats.

       Parse errors may cause a warning message, delivered via unstructured logging.

       This happens automatically when <u>mongoc_structured_log_opts_new()</u> establishes  defaults.   Any  subsequent
       programmatic  modifications  to  the  <u>mongoc_structured_log_opts_t</u> will override the environment variable
       settings.  For applications that desire the opposite behavior, where environment variables  may  override
       programmatic  settings, they may call <b>mongoc_structured_log_opts_set_max_document_length_from_env()</b> after
       calling <u>mongoc_structured_log_opts_set_max_document_length()</u>.  This will process the environment a second
       time, allowing it to override customized defaults.

   <b>Returns</b>
       Returns <b>true</b> on success: either a valid environment setting was found, or the value  is  unset  and  <b>opts</b>
       will  not  be  modified.   If  warnings  are  encountered  in  the environment, returns <b>false</b> and may log
       additional information to the unstructured logging facility.  Note that, by design, these errors  are  by
       default  non-fatal.  When <u>mongoc_structured_log_opts_new()</u> internally calls this function, it ignores the
       return value.

       <b>SEE</b> <b>ALSO:</b>
          <u>Structured</u> <u>Logging</u>

   <b>mongoc_structured_log_opts_get_max_document_length()</b>
   <b>Synopsis</b>
          size_t
          mongoc_structured_log_opts_get_max_document_length (const mongoc_structured_log_opts_t *opts);

   <b>Parameters</b>
       • <b>opts</b>: Structured log options, allocated with <u>mongoc_structured_log_opts_new()</u>.

   <b>Returns</b>
       Returns the current maximum document length set in <b>opts</b>, as a <b>size_t</b>.

       <b>SEE</b> <b>ALSO:</b>
          <u>Structured</u> <u>Logging</u>

       <b>SEE</b> <b>ALSO:</b>
          <u>Structured</u> <u>Logging</u>

</pre><h4><b>AUTHOR</b></h4><pre>
       MongoDB, Inc

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2009-present, MongoDB, Inc.

1.30.4                                            Jun 08, 2025                   <u><a href="../man3/MONGOC_STRUCTURED_LOG_OPTS_T.3.html">MONGOC_STRUCTURED_LOG_OPTS_T</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>