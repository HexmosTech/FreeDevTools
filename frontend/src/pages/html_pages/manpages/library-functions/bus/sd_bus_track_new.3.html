<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sd_bus_track_new, sd_bus_track_ref, sd_bus_track_unref, sd_bus_track_unrefp, sd_bus_track_set_recursive,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsystemd-dev">libsystemd-dev_257.7-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sd_bus_track_new, sd_bus_track_ref, sd_bus_track_unref, sd_bus_track_unrefp, sd_bus_track_set_recursive,
       sd_bus_track_get_recursive, sd_bus_track_get_bus, sd_bus_track_get_userdata, sd_bus_track_set_userdata -
       Track bus peers

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;systemd/sd-bus.h&gt;</b>

       <b>int</b> <b>sd_bus_track_new(sd_bus*</b> <u>bus</u><b>,</b> <b>sd_bus_track**</b> <u>ret</u><b>,</b> <b>sd_bus_track_handler_t</b> <u>handler</u><b>,</b> <b>void*</b> <u>userdata</u><b>);</b>

       <b>sd_bus_track</b> <b>*sd_bus_track_ref(sd_bus_track</b> <b>*</b><u>t</u><b>);</b>

       <b>sd_bus_track</b> <b>*sd_bus_track_unref(sd_bus_track</b> <b>*</b><u>t</u><b>);</b>

       <b>void</b> <b>sd_bus_track_unrefp(sd_bus_track</b> <b>**</b><u>t</u><b>);</b>

       <b>int</b> <b>sd_bus_track_get_recursive(sd_bus_track</b> <b>*</b><u>t</u><b>);</b>

       <b>int</b> <b>sd_bus_track_set_recursive(sd_bus_track</b> <b>*</b><u>t</u><b>,</b> <b>int</b> <u>b</u><b>);</b>

       <b>sd_bus*</b> <b>sd_bus_track_get_bus(sd_bus_track</b> <b>*</b><u>t</u><b>);</b>

       <b>void*</b> <b>sd_bus_track_get_userdata(sd_bus_track</b> <b>*</b><u>t</u><b>);</b>

       <b>void*</b> <b>sd_bus_track_set_userdata(sd_bus_track</b> <b>*</b><u>t</u><b>,</b> <b>void</b> <b>*userdata);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sd_bus_track_new()</b> creates a new bus peer tracking object. The object is allocated for the specified bus,
       and returned in the <u>*ret</u> parameter. After use, the object should be freed again by dropping the acquired
       reference with <b>sd_bus_track_unref()</b> (see below). A bus peer tracking object may be used to keep track of
       peers on a specific IPC bus, for cases where peers are making use of one or more local objects, in order
       to control the lifecycle of the local objects and ensure they stay around as long as the peers needing
       them are around, and unreferenced (and possibly destroyed) as soon as all relevant peers have vanished.
       Each bus peer tracking object may be used to track zero, one or more peers add a time. References to
       specific bus peers are added via <b><a href="../man3/sd_bus_track_add_name.3.html">sd_bus_track_add_name</a></b>(3) or <b>sd_bus_track_add_sender()</b>. They may be
       dropped again via <b>sd_bus_track_remove_name()</b> and <b>sd_bus_track_remove_sender()</b>. Alternatively, references
       on peers are removed automatically when they disconnect from the bus. If non-<b>NULL</b> the <u>handler</u> may specify
       a function that is invoked whenever the last reference is dropped, regardless whether the reference is
       dropped explicitly via <b>sd_bus_track_remove_name()</b> or implicitly because the peer disconnected from the
       bus. The final argument <u>userdata</u> may be used to attach a generic user data pointer to the object. This
       pointer is passed to the handler callback when it is invoked.

       <b>sd_bus_track_ref()</b> creates a new reference to a bus peer tracking object. This object will not be
       destroyed until <b>sd_bus_track_unref()</b> has been called as many times plus once more. Once the reference
       count has dropped to zero, the specified object cannot be used anymore, further calls to
       <b>sd_bus_track_ref()</b> or <b>sd_bus_track_unref()</b> on the same object are illegal.

       <b>sd_bus_track_unref()</b> destroys a reference to a bus peer tracking object.

       <b>sd_bus_track_unrefp()</b> is similar to <b>sd_bus_track_unref()</b> but takes a pointer to a pointer to an
       <b>sd_bus_track</b> object. This call is useful in conjunction with GCC's and LLVM's <b>Clean-up</b> <b>Variable</b>
       <b>Attribute</b>[1]. Note that this function is defined as inline function.

       <b>sd_bus_track_ref()</b>, <b>sd_bus_track_unref()</b> and <b>sd_bus_track_unrefp()</b> execute no operation if the passed in
       bus peer tracking object is <b>NULL</b>.

       Bus peer tracking objects may exist in two modes: by default they operate in non-recursive mode, but may
       optionally be switched into recursive mode. If operating in the default non-recursive mode a peer is
       either tracked or not tracked. In this mode invoking <b>sd_bus_track_add_name()</b> multiple times in a row for
       the same peer is fully equivalent to calling it just once, as the call adds the peer to the set of
       tracked peers if necessary, and executes no operation if the peer is already being tracked. A single
       invocation of <b>sd_bus_track_remove_name()</b> removes the reference on the peer again, regardless how many
       times <b>sd_bus_track_add_name()</b> was called before. If operating in recursive mode, the number of times
       <b>sd_bus_track_add_name()</b> is invoked for the same peer name is counted and <b>sd_bus_track_remove_name()</b> must
       be called the same number of times before the peer is not tracked anymore, with the exception when the
       tracked peer vanishes from the bus, in which case the count is irrelevant and the tracking of the
       specific peer is immediately removed.  <b>sd_bus_track_get_recursive()</b> may be used to determine whether the
       bus peer tracking object is operating in recursive mode.  <b>sd_bus_track_set_recursive()</b> may be used to
       enable or disable recursive mode. By default, a bus peer tracking object operates in non-recursive mode,
       and <b>sd_bus_track_get_recursive()</b> for a newly allocated object hence returns a value equal to zero. Use
       <b>sd_bus_track_set_recursive()</b> to enable recursive mode, right after allocation. It takes a boolean
       argument to enable or disable recursive mode. Note that tracking objects for which
       <b>sd_bus_track_add_name()</b> was already invoked at least once (and which hence track already one or more
       peers) may not be switched from recursive to non-recursive mode anymore.

       <b>sd_bus_track_get_bus()</b> returns the bus object the bus peer tracking object belongs to. It returns the bus
       object initially passed to <b>sd_bus_track_new()</b> when the object was allocated.

       <b>sd_bus_track_get_userdata()</b> returns the generic user data pointer set on the bus peer tracking object at
       the time of creation using <b>sd_bus_track_new()</b> or at a later time, using <b>sd_bus_track_set_userdata()</b>.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, <b>sd_bus_track_new()</b> and <b>sd_bus_track_set_recursive()</b> return 0 or a positive integer. On
       failure, they return a negative errno-style error code.

       <b>sd_bus_track_ref()</b> always returns the argument.

       <b>sd_bus_track_unref()</b> always returns <b>NULL</b>.

       <b>sd_bus_track_get_recursive()</b> returns 0 if non-recursive mode is selected (default), and greater than 0 if
       recursive mode is selected. On failure a negative errno-style error code is returned.

       <b>sd_bus_track_get_bus()</b> returns the bus object associated to the bus peer tracking object.

       <b>sd_bus_track_get_userdata()</b> returns the generic user data pointer associated with the bus peer tracking
       object.  <b>sd_bus_track_set_userdata()</b> returns the previous user data pointer set.

</pre><h4><b>REFERENCE</b> <b>OWNERSHIP</b></h4><pre>
       The <b>sd_bus_track_new()</b> function creates a new object and the caller owns the sole reference. When not
       needed anymore, this reference should be destroyed with <b>sd_bus_track_unref()</b>.

   <b>Errors</b>
       Returned errors may indicate the following problems:

       <b>-EBUSY</b>
           Bus peers have already been added to the bus peer tracking object and <b>sd_bus_track_set_recursive()</b>
           was called to change tracking mode.

       <b>-EINVAL</b>
           Specified parameter is invalid (<b>NULL</b> in case of output parameters).

       <b>-ENOMEM</b>
           Memory allocation failed.

</pre><h4><b>NOTES</b></h4><pre>
       Functions described here are available as a shared library, which can be compiled against and linked to
       with the <b>libsystemd</b> <b><a href="../man1/pkg-config.1.html">pkg-config</a></b>(1) file.

       The code described here uses <b><a href="../man3/getenv.3.html">getenv</a></b>(3), which is declared to be not multi-thread-safe. This means that
       the code calling the functions described here must not call <b><a href="../man3/setenv.3.html">setenv</a></b>(3) from a parallel thread. It is
       recommended to only do calls to <b>setenv()</b> from an early phase of the program when no other threads have
       been started.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>sd_bus_track_new()</b>, <b>sd_bus_track_ref()</b>, <b>sd_bus_track_unref()</b>, <b>sd_bus_track_unrefp()</b>,
       <b>sd_bus_track_get_recursive()</b>, <b>sd_bus_track_set_recursive()</b>, <b>sd_bus_track_get_bus()</b>,
       <b>sd_bus_track_get_userdata()</b>, and <b>sd_bus_track_set_userdata()</b> were added in version 232.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man3/sd-bus.3.html">sd-bus</a></b>(3), <b><a href="../man3/sd_bus_track_add_name.3.html">sd_bus_track_add_name</a></b>(3)

</pre><h4><b>NOTES</b></h4><pre>
        1. Clean-up Variable Attribute
           https://gcc.gnu.org/onlinedocs/gcc/Common-Variable-Attributes.html

systemd 257.7                                                                                <u><a href="../man3/SD_BUS_TRACK_NEW.3.html">SD_BUS_TRACK_NEW</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>