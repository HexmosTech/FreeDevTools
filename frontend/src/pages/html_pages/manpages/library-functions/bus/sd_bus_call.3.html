<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sd_bus_call, sd_bus_call_async - Invoke a D-Bus method call</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsystemd-dev">libsystemd-dev_257.7-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sd_bus_call, sd_bus_call_async - Invoke a D-Bus method call

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;systemd/sd-bus.h&gt;</b>

       <b>typedef</b> <b>int</b> <b>(*sd_bus_message_handler_t)(sd_bus_message</b> <b>*</b><u>m</u><b>,</b> <b>void</b> <b>*</b><u>userdata</u><b>,</b> <b>sd_bus_error</b> <b>*</b><u>ret_error</u><b>);</b>

       <b>int</b> <b>sd_bus_call(sd_bus</b> <b>*</b><u>bus</u><b>,</b> <b>sd_bus_message</b> <b>*</b><u>m</u><b>,</b> <b>uint64_t</b> <u>usec</u><b>,</b> <b>sd_bus_error</b> <b>*</b><u>ret_error</u><b>,</b>
                       <b>sd_bus_message</b> <b>**</b><u>reply</u><b>);</b>

       <b>int</b> <b>sd_bus_call_async(sd_bus</b> <b>*</b><u>bus</u><b>,</b> <b>sd_bus_slot</b> <b>**</b><u>slot</u><b>,</b> <b>sd_bus_message</b> <b>*</b><u>m</u><b>,</b>
                             <b>sd_bus_message_handler_t</b> <u>callback</u><b>,</b> <b>void</b> <b>*</b><u>userdata</u><b>,</b> <b>uint64_t</b> <u>usec</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sd_bus_call()</b> takes a complete bus message object and calls the corresponding D-Bus method. On success,
       the response is stored in <u>reply</u>.  <u>usec</u> indicates the timeout in microseconds. If <u>ret_error</u> is not <b>NULL</b>
       and <b>sd_bus_call()</b> fails (either because of an internal error or because it received a D-Bus error reply),
       <u>ret_error</u> is initialized to an instance of sd_bus_error describing the error.

       <b>sd_bus_call_async()</b> is like <b>sd_bus_call()</b> but works asynchronously. The <u>callback</u> indicates the function
       to call when the response arrives. The <u>userdata</u> pointer will be passed to the callback function, and may
       be chosen freely by the caller. If <u>slot</u> is not <b>NULL</b> and <b>sd_bus_call_async()</b> succeeds, <u>slot</u> is set to a
       slot object which can be used to cancel the method call at a later time using <b><a href="../man3/sd_bus_slot_unref.3.html">sd_bus_slot_unref</a></b>(3). If
       <u>slot</u> is <b>NULL</b>, the lifetime of the method call is bound to the lifetime of the bus object itself, and it
       cannot be cancelled independently. See <b><a href="../man3/sd_bus_slot_set_floating.3.html">sd_bus_slot_set_floating</a></b>(3) for details.  <u>callback</u> is called when
       a reply arrives with the reply, <u>userdata</u> and an sd_bus_error output parameter as its arguments. Unlike
       <b>sd_bus_call()</b>, the sd_bus_error output parameter passed to the callback will be empty. To determine
       whether the method call succeeded, use <b><a href="../man3/sd_bus_message_is_method_error.3.html">sd_bus_message_is_method_error</a></b>(3) on the reply message passed to
       the callback instead. If the callback returns zero and the sd_bus_error output parameter is still empty
       when the callback finishes, other handlers registered with functions such as <b><a href="../man3/sd_bus_add_filter.3.html">sd_bus_add_filter</a></b>(3) or
       <b><a href="../man3/sd_bus_add_match.3.html">sd_bus_add_match</a></b>(3) are given a chance to process the message. If the callback returns a non-zero value
       or the sd_bus_error output parameter is not empty when the callback finishes, no further processing of
       the message is done. Generally, you want to return zero from the callback to give other registered
       handlers a chance to process the reply as well. (Note that the sd_bus_error parameter is an output
       parameter of the callback function, not an input parameter; it can be used to propagate errors from the
       callback handler, it will not receive any error that was received as method reply.)

       The message <u>m</u> passed to the callback is only borrowed, that is, the callback should not call
       <b><a href="../man3/sd_bus_message_unref.3.html">sd_bus_message_unref</a></b>(3) on it. If the callback wants to hold on to the message beyond the lifetime of the
       callback, it needs to call <b><a href="../man3/sd_bus_message_ref.3.html">sd_bus_message_ref</a></b>(3) to create a new reference.

       If <u>usec</u> is zero, the default D-Bus method call timeout is used. See <b><a href="../man3/sd_bus_get_method_call_timeout.3.html">sd_bus_get_method_call_timeout</a></b>(3).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, these functions return a non-negative integer. On failure, they return a negative errno-style
       error code.

   <b>Errors</b>
       When <b>sd_bus_call()</b> internally receives a D-Bus error reply, it will set <u>ret_error</u> if it is not <b>NULL</b>, and
       will return a negative value mapped from the error reply, see <b><a href="../man3/sd_bus_error_get_errno.3.html">sd_bus_error_get_errno</a></b>(3).

       Returned errors may indicate the following problems:

       <b>-EINVAL</b>
           The input parameter <u>m</u> is <b>NULL</b>.

           The input parameter <u>m</u> is not a D-Bus method call. To create a new D-Bus method call, use
           <b><a href="../man3/sd_bus_message_new_method_call.3.html">sd_bus_message_new_method_call</a></b>(3).

           The input parameter <u>m</u> has the <b>BUS_MESSAGE_NO_REPLY_EXPECTED</b> flag set.

           The input parameter <u>error</u> is non-<b>NULL</b> but was not set to <b>SD_BUS_ERROR_NULL</b>.

       <b>-ECHILD</b>
           The bus connection was allocated in a parent process and is being reused in a child process after
           <b>fork()</b>.

       <b>-ENOTCONN</b>
           The input parameter <u>bus</u> is <b>NULL</b> or the bus is not connected.

       <b>-ECONNRESET</b>
           The bus connection was closed while waiting for the response.

       <b>-ETIMEDOUT</b>
           A response was not received within the given timeout.

       <b>-ELOOP</b>
           The message <u>m</u> is addressed to its own client.

       <b>-ENOMEM</b>
           Memory allocation failed.

</pre><h4><b>NOTES</b></h4><pre>
       Functions described here are available as a shared library, which can be compiled against and linked to
       with the <b>libsystemd</b> <b><a href="../man1/pkg-config.1.html">pkg-config</a></b>(1) file.

       The code described here uses <b><a href="../man3/getenv.3.html">getenv</a></b>(3), which is declared to be not multi-thread-safe. This means that
       the code calling the functions described here must not call <b><a href="../man3/setenv.3.html">setenv</a></b>(3) from a parallel thread. It is
       recommended to only do calls to <b>setenv()</b> from an early phase of the program when no other threads have
       been started.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>sd_bus_call()</b> and <b>sd_bus_call_async()</b> were added in version 221.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man3/sd-bus.3.html">sd-bus</a></b>(3), <b><a href="../man3/sd_bus_call_method.3.html">sd_bus_call_method</a></b>(3), <b><a href="../man3/sd_bus_call_method_async.3.html">sd_bus_call_method_async</a></b>(3),
       <b><a href="../man3/sd_bus_message_new_method_call.3.html">sd_bus_message_new_method_call</a></b>(3), <b><a href="../man3/sd_bus_message_append.3.html">sd_bus_message_append</a></b>(3), <b><a href="../man3/sd_bus_error.3.html">sd_bus_error</a></b>(3)

systemd 257.7                                                                                     <u><a href="../man3/SD_BUS_CALL.3.html">SD_BUS_CALL</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>