<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sd_bus_get_fd, sd_bus_get_events, sd_bus_get_timeout - Get the file descriptor, I/O events and timeout to</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsystemd-dev">libsystemd-dev_257.7-1ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sd_bus_get_fd, sd_bus_get_events, sd_bus_get_timeout - Get the file descriptor, I/O events and timeout to
       wait for from a message bus object

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;systemd/sd-bus.h&gt;</b>

       <b>int</b> <b>sd_bus_get_fd(sd_bus</b> <b>*</b><u>bus</u><b>);</b>

       <b>int</b> <b>sd_bus_get_events(sd_bus</b> <b>*</b><u>bus</u><b>);</b>

       <b>int</b> <b>sd_bus_get_timeout(sd_bus</b> <b>*</b><u>bus</u><b>,</b> <b>uint64_t</b> <b>*</b><u>timeout_usec</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sd_bus_get_fd()</b> returns the file descriptor used to communicate from a message bus object. This
       descriptor can be used with <b><a href="../man3/poll.3.html">poll</a></b>(3) or a similar function to wait for I/O events on the specified bus
       connection object. If the bus object was configured with the <b>sd_bus_set_fd()</b> function, then the <u>input_fd</u>
       file descriptor used in that call is returned.

       <b>sd_bus_get_events()</b> returns the I/O events to wait for, suitable for passing to <b>poll()</b> or a similar call.
       Returns a combination of <b>POLLIN</b>, <b>POLLOUT</b>, ... events, or negative on error.

       <b>sd_bus_get_timeout()</b> returns the <u>absolute</u> timeout in Î¼s, from which the relative timeout to pass to
       <b>poll()</b> (or a similar call) can be derived, when waiting for events on the specified bus connection. The
       returned timeout may be zero, in which case a subsequent I/O polling call should be invoked in
       non-blocking mode. The returned timeout may be <b>UINT64_MAX</b> in which case the I/O polling call may block
       indefinitely, without any applied timeout. Note that the returned timeout should be considered only a
       maximum sleeping time. It is permissible (and even expected) that shorter timeouts are used by the
       calling program, in case other event sources are polled in the same event loop. Note that the returned
       time-value is absolute, based of <b>CLOCK_MONOTONIC</b> and specified in microseconds. When converting this
       value in order to pass it as third argument to <b>poll()</b> (which expects relative milliseconds), care should
       be taken to convert to a relative time and use a division that rounds up to ensure the I/O polling
       operation does not sleep for shorter than necessary, which might result in unintended busy looping
       (alternatively, use <b><a href="../man2/ppoll.2.html">ppoll</a></b>(2) instead of plain <b>poll()</b>, which understands timeouts with nano-second
       granularity).

       These three functions are useful to hook up a bus connection object with an external or manual event loop
       involving <b>poll()</b> or a similar I/O polling call. Before each invocation of the I/O polling call, all three
       functions should be invoked: the file descriptor returned by <b>sd_bus_get_fd()</b> should be polled for the
       events indicated by <b>sd_bus_get_events()</b>, and the I/O call should block for that up to the timeout
       returned by <b>sd_bus_get_timeout()</b>. After each I/O polling call the bus connection needs to process
       incoming or outgoing data, by invoking <b><a href="../man3/sd_bus_process.3.html">sd_bus_process</a></b>(3).

       Note that these functions are only one of three supported ways to implement I/O event handling for bus
       connections. Alternatively use <b><a href="../man3/sd_bus_attach_event.3.html">sd_bus_attach_event</a></b>(3) to attach a bus connection to an <b><a href="../man3/sd-event.3.html">sd-event</a></b>(3) event
       loop. Or use <b><a href="../man3/sd_bus_wait.3.html">sd_bus_wait</a></b>(3) as a simple synchronous, blocking I/O waiting call.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, <b>sd_bus_get_fd()</b> returns the file descriptor used for communication. On failure, it returns a
       negative errno-style error code.

       On success, <b>sd_bus_get_events()</b> returns the I/O event mask to use for I/O event watching. On failure, it
       returns a negative errno-style error code.

       On success, <b>sd_bus_get_timeout()</b> returns a non-negative integer. On failure, it returns a negative
       errno-style error code.

   <b>Errors</b>
       Returned errors may indicate the following problems:

       <b>-EINVAL</b>
           An invalid bus object was passed.

       <b>-ECHILD</b>
           The bus connection was allocated in a parent process and is being reused in a child process after
           <b>fork()</b>.

       <b>-ENOTCONN</b>
           The bus connection has been terminated.

       <b>-EPERM</b>
           Two distinct file descriptors were passed for input and output using <b>sd_bus_set_fd()</b>, which
           <b>sd_bus_get_fd()</b> cannot return.

       <b>-ENOPKG</b>
           The bus cannot be resolved.

</pre><h4><b>NOTES</b></h4><pre>
       Functions described here are available as a shared library, which can be compiled against and linked to
       with the <b>libsystemd</b> <b><a href="../man1/pkg-config.1.html">pkg-config</a></b>(1) file.

       The code described here uses <b><a href="../man3/getenv.3.html">getenv</a></b>(3), which is declared to be not multi-thread-safe. This means that
       the code calling the functions described here must not call <b><a href="../man3/setenv.3.html">setenv</a></b>(3) from a parallel thread. It is
       recommended to only do calls to <b>setenv()</b> from an early phase of the program when no other threads have
       been started.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>sd_bus_get_fd()</b>, <b>sd_bus_get_events()</b>, and <b>sd_bus_get_timeout()</b> were added in version 221.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man3/sd-bus.3.html">sd-bus</a></b>(3), <b><a href="../man3/sd_bus_process.3.html">sd_bus_process</a></b>(3), <b><a href="../man3/sd_bus_attach_event.3.html">sd_bus_attach_event</a></b>(3), <b><a href="../man3/sd_bus_wait.3.html">sd_bus_wait</a></b>(3), <b><a href="../man3/sd_bus_set_fd.3.html">sd_bus_set_fd</a></b>(3),
       <b><a href="../man3/poll.3.html">poll</a></b>(3)

systemd 257.7                                                                                   <u><a href="../man3/SD_BUS_GET_FD.3.html">SD_BUS_GET_FD</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>