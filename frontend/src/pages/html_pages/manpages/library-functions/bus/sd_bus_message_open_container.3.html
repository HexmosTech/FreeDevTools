<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sd_bus_message_open_container, sd_bus_message_close_container, sd_bus_message_enter_container,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsystemd-dev">libsystemd-dev_257.7-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sd_bus_message_open_container, sd_bus_message_close_container, sd_bus_message_enter_container,
       sd_bus_message_exit_container - Create and move between containers in D-Bus messages

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;systemd/sd-bus.h&gt;</b>

       <b>int</b> <b>sd_bus_message_open_container(sd_bus_message</b> <b>*</b><u>m</u><b>,</b> <b>char</b> <u>type</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>contents</u><b>);</b>

       <b>int</b> <b>sd_bus_message_close_container(sd_bus_message</b> <b>*</b><u>m</u><b>);</b>

       <b>int</b> <b>sd_bus_message_enter_container(sd_bus_message</b> <b>*</b><u>m</u><b>,</b> <b>char</b> <u>type</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>contents</u><b>);</b>

       <b>int</b> <b>sd_bus_message_exit_container(sd_bus_message</b> <b>*</b><u>m</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sd_bus_message_open_container()</b> appends a new container to the message <u>m</u>. After opening a new container,
       it can be filled with content using <b><a href="../man3/sd_bus_message_append.3.html">sd_bus_message_append</a></b>(3) and similar functions. Containers behave
       like a stack. To nest containers inside each other, call <b>sd_bus_message_open_container()</b> multiple times
       without calling <b>sd_bus_message_close_container()</b> in between. Each container will be nested inside the
       previous container.  <u>type</u> represents the container type and should be one of "r", "a", "v" or "e" as
       described in <b><a href="../man3/sd_bus_message_append.3.html">sd_bus_message_append</a></b>(3). Instead of literals, the corresponding constants
       <b>SD_BUS_TYPE_STRUCT</b>, <b>SD_BUS_TYPE_ARRAY</b>, <b>SD_BUS_TYPE_VARIANT</b> or <b>SD_BUS_TYPE_DICT_ENTRY</b> can also be used.
       <u>contents</u> describes the type of the container's elements and should be a D-Bus type string following the
       rules described in <b><a href="../man3/sd_bus_message_append.3.html">sd_bus_message_append</a></b>(3).

       <b>sd_bus_message_close_container()</b> closes the last container opened with <b>sd_bus_message_open_container()</b>.
       On success, the write pointer of the message <u>m</u> is positioned after the closed container in its parent
       container or in <u>m</u> itself if there is no parent container.

       <b>sd_bus_message_enter_container()</b> enters the next container of the message <u>m</u> for reading. It behaves
       mostly the same as <b>sd_bus_message_open_container()</b>. Entering a container allows reading its contents with
       <b><a href="../man3/sd_bus_message_read.3.html">sd_bus_message_read</a></b>(3) and similar functions.  <u>type</u> and <u>contents</u> are the same as in
       <b>sd_bus_message_open_container()</b>.

       <b>sd_bus_message_exit_container()</b> exits the scope of the last container entered with
       <b>sd_bus_message_enter_container()</b>. It behaves mostly the same as <b>sd_bus_message_close_container()</b>. Note
       that <b>sd_bus_message_exit_container()</b> may only be called after iterating through all members of the
       container, i.e. reading or skipping over them. Use <b><a href="../man3/sd_bus_message_skip.3.html">sd_bus_message_skip</a></b>(3) to skip over fields of a
       container in order to be able to exit the container with <b>sd_bus_message_exit_container()</b> without reading
       all members.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, these functions return a non-negative integer.  <b>sd_bus_message_open_container()</b> and
       <b>sd_bus_message_close_container()</b> return 0.  <b>sd_bus_message_enter_container()</b> returns 1 if it successfully
       opened a new container, and 0 if that was not possible because the end of the currently open container or
       message was reached.  <b>sd_bus_message_exit_container()</b> returns 1 on success. On failure, all of these
       functions return a negative errno-style error code.

   <b>Errors</b>
       Returned errors may indicate the following problems:

       <b>-EINVAL</b>
           <u>m</u> or <u>contents</u> are <b>NULL</b> or <u>type</u> is invalid.

           Added in version 246.

       <b>-EBADMSG</b>
           Message <u>m</u> has invalid structure.

           Added in version 254.

       <b>-ENXIO</b>
           Message <u>m</u> does not have a container of type <u>type</u> at the current position, or the contents do not
           match <u>contents</u>.

           Added in version 254.

       <b>-EPERM</b>
           The message <u>m</u> is already sealed.

           Added in version 246.

       <b>-ESTALE</b>
           The message <u>m</u> is in an invalid state.

           Added in version 246.

       <b>-ENOMEM</b>
           Memory allocation failed.

           Added in version 246.

       <b>-EBUSY</b>
           <b>sd_bus_message_exit_container()</b> was called but there are unread members left in the container.

           Added in version 247.

</pre><h4><b>NOTES</b></h4><pre>
       Functions described here are available as a shared library, which can be compiled against and linked to
       with the <b>libsystemd</b> <b><a href="../man1/pkg-config.1.html">pkg-config</a></b>(1) file.

       The code described here uses <b><a href="../man3/getenv.3.html">getenv</a></b>(3), which is declared to be not multi-thread-safe. This means that
       the code calling the functions described here must not call <b><a href="../man3/setenv.3.html">setenv</a></b>(3) from a parallel thread. It is
       recommended to only do calls to <b>setenv()</b> from an early phase of the program when no other threads have
       been started.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>Example</b> <b>1.</b> <b>Append</b> <b>an</b> <b>array</b> <b>of</b> <b>strings</b> <b>to</b> <b>a</b> <b>message</b>

           /* SPDX-License-Identifier: MIT-0 */

           #include &lt;systemd/sd-bus.h&gt;

           int append_strings_to_message(sd_bus_message *m, const char *const *arr) {
             const char *s;
             int r;

             r = sd_bus_message_open_container(m, 'a', "s");
             if (r &lt; 0)
               return r;

             for (s = *arr; *s; s++) {
               r = sd_bus_message_append(m, "s", s);
               if (r &lt; 0)
                 return r;
             }

             return <a href="../manm/sd_bus_message_close_container.m.html">sd_bus_message_close_container</a>(m);
           }

       <b>Example</b> <b>2.</b> <b>Read</b> <b>an</b> <b>array</b> <b>of</b> <b>strings</b> <b>from</b> <b>a</b> <b>message</b>

           /* SPDX-License-Identifier: MIT-0 */

           #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;

           #include &lt;systemd/sd-bus.h&gt;

           int read_strings_from_message(sd_bus_message *m) {
             int r;

             r = sd_bus_message_enter_container(m, 'a', "s");
             if (r &lt; 0)
               return r;

             for (;;) {
               const char *s;

               r = sd_bus_message_read(m, "s", &amp;s);
               if (r &lt; 0)
                 return r;
               if (r == 0)
                 break;

               printf("%s\n", s);
             }

             return <a href="../manm/sd_bus_message_exit_container.m.html">sd_bus_message_exit_container</a>(m);
           }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man3/sd-bus.3.html">sd-bus</a></b>(3), <b><a href="../man3/sd_bus_message_append.3.html">sd_bus_message_append</a></b>(3), <b><a href="../man3/sd_bus_message_read.3.html">sd_bus_message_read</a></b>(3), <b><a href="../man3/sd_bus_message_skip.3.html">sd_bus_message_skip</a></b>(3), <b>The</b>
       <b>D-Bus</b> <b>specification</b>[1]

</pre><h4><b>NOTES</b></h4><pre>
        1. The D-Bus specification
           https://dbus.freedesktop.org/doc/dbus-specification.html

systemd 257.7                                                                   <u><a href="../man3/SD_BUS_MESSAGE_OPEN_CONTAINER.3.html">SD_BUS_MESSAGE_OPEN_CONTAINER</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>