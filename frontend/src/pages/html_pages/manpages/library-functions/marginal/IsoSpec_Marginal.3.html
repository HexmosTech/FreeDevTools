<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IsoSpec::Marginal - The marginal distribution class (a subisotopologue).</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libisospec++-dev">libisospec++-dev_2.2.1-4.1build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       IsoSpec::Marginal - The marginal distribution class (a subisotopologue).

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;marginalTrek++.h&gt;

       Inherited by <b>IsoSpec::LayeredMarginal</b>, <b>IsoSpec::MarginalTrek</b>, and <b>IsoSpec::PrecalculatedMarginal</b>.

   <b>Public</b> <b>Member</b> <b>Functions</b>
       <b>Marginal</b> (const double *_masses, const double *_probs, int _isotopeNo, int _atomCnt)
           Class constructor.
       <b>Marginal</b> &amp; <b>operator=</b> (const <b>Marginal</b> &amp;other)=delete
       <b>Marginal</b> (const <b>Marginal</b> &amp;other)
           Copy constructor.
       <b>Marginal</b> (<b>Marginal</b> &amp;&amp;other)
           Move constructor.
       virtual <b>~Marginal</b> ()
           Destructor.
       int <b>get_isotopeNo</b> () const
           Get the number of isotopes of the investigated element.
       const double * <b>get_lProbs</b> () const
       double <b>getLightestConfMass</b> () const
           Get the mass of the lightest subisotopologue.
       double <b>getHeaviestConfMass</b> () const
           Get the mass of the heaviest subisotopologue.
       double <b>getMonoisotopicConfMass</b> () const
           Get the mass of the monoisotopic subisotopologue.
       double <b>getModeMass</b> ()
           The the mass of the mode subisotopologue.
       double <b>getModeLProb</b> ()
           Get the log-probability of the mode subisotopologue.
       double <b>fastGetModeLProb</b> ()
           Get the log-probability of the mode subisotopologue. Results undefined if ensureModeConf() wasn't
           called before.
       Conf <b>computeModeConf</b> () const
           The the probability of the mode subisotopologue.
       double <b>getSmallestLProb</b> () const
           The the log-probability of the lightest subisotopologue.
       double <b>getAtomAverageMass</b> () const
           The average mass of a single atom.
       double <b>getTheoreticalAverageMass</b> () const
           The theoretical average mass of the molecule.
       double <b>variance</b> () const
           Calculate the variance of the theoretical distribution describing the subisotopologue.
       double <b>getLogSizeEstimate</b> (double logEllipsoidRadius) const
           Return estimated logarithm of size of the marginal at a given ellipsoid radius.
       void <b>ensureModeConf</b> ()

   <b>Protected</b> <b>Member</b> <b>Functions</b>
       ISOSPEC_FORCE_INLINE double <b>unnormalized_logProb</b> (Conf conf) const
           Calculate the log-probability of a given subisotopologue.
       ISOSPEC_FORCE_INLINE double <b>logProb</b> (Conf conf) const

   <b>Protected</b> <b>Attributes</b>
       const unsigned int <b>isotopeNo</b>
       const unsigned int <b>atomCnt</b>
       const double *const <b>atom_lProbs</b>
       const double *const <b>atom_masses</b>
       const double <b>loggamma_nominator</b>
       Conf <b>mode_conf</b>
       double <b>mode_lprob</b>

</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       The marginal distribution class (a subisotopologue).

       This class mostly provides some basic common API for subclasses, but itself is not abstract. This class
       represents the probability distribution generated by one element only -- a subisotopologue. For instance,
       it might be the distribution of C200, that might be part of, say, C200H402. It corresponds to the
       multinomial distribution, where each configuration can also be attributed a precise mass. The constructor
       method perform initial hill-climbing to find the most probable sub-isotopologue (the mode).

       Definition at line <b>42</b> of file <b>marginalTrek++.h</b>.

</pre><h4><b>Constructor</b> <b>&amp;</b> <b>Destructor</b> <b>Documentation</b></h4><pre>
   <b>IsoSpec::Marginal::Marginal</b> <b>(const</b> <b>double</b> <b>*</b> <b>_masses,</b> <b>const</b> <b>double</b> <b>*</b> <b>_probs,</b> <b>int</b> <b>_isotopeNo,</b> <b>int</b> <b>_atomCnt)</b>
       Class constructor.

       <b>Parameters</b>
           <b>_</b><u>masses</u> A table of masses of the stable isotopes of the investigated element, e.g. for C10 it is 2:
           C12 and C13.
           <b>_</b><u>probs</u> A table of natural frequencies of the stable isotopes of the investigated element, see IUPAC
           at https://iupac.org/isotopesmatter/
           <b>_</b><u>isotopeNo</u> Number of isotopes of a given element.
           <b>_</b><u>atomCnt</u> The number of atoms of the given element, e.g. 10 for C10.

       <b>Returns</b>
           An instance of the <b>Marginal</b> class.

       Definition at line <b>165</b> of file <b>marginalTrek++.cpp</b>.

   <b>IsoSpec::Marginal::Marginal</b> <b>(const</b> <b>Marginal</b> <b>&amp;</b> <b>other)</b>
       Copy constructor.

       Definition at line <b>181</b> of file <b>marginalTrek++.cpp</b>.

   <b>IsoSpec::Marginal::Marginal</b> <b>(Marginal</b> <b>&amp;&amp;</b> <b>other)</b>
       Move constructor.

       Definition at line <b>203</b> of file <b>marginalTrek++.cpp</b>.

   <b>IsoSpec::Marginal::~Marginal</b> <b>()</b> <b>[virtual]</b>
       Destructor.

       Definition at line <b>224</b> of file <b>marginalTrek++.cpp</b>.

</pre><h4><b>Member</b> <b>Function</b> <b>Documentation</b></h4><pre>
   <b>Conf</b> <b>IsoSpec::Marginal::computeModeConf</b> <b>()</b> <b>const</b>
       The the probability of the mode subisotopologue.

       <b>Returns</b>
           The probability of a/the most probable subisotopologue. Computes and returns the mode configuration,
           a isotopeNo-large array that the caller is responsible for delete[]-ing.

       Definition at line <b>235</b> of file <b>marginalTrek++.cpp</b>.

   <b>void</b> <b>IsoSpec::Marginal::ensureModeConf</b> <b>()</b> <b>[inline]</b>
       Definition at line <b>168</b> of file <b>marginalTrek++.h</b>.

   <b>double</b> <b>IsoSpec::Marginal::fastGetModeLProb</b> <b>()</b> <b>[inline]</b>
       Get the log-probability of the mode subisotopologue. Results undefined if ensureModeConf() wasn't called
       before.

       Definition at line <b>124</b> of file <b>marginalTrek++.h</b>.

   <b>int</b> <b>IsoSpec::Marginal::get_isotopeNo</b> <b>()</b> <b>const</b> <b>[inline]</b>
       Get the number of isotopes of the investigated element.

       <b>Returns</b>
           The integer number of isotopes of the investigated element.

       Definition at line <b>88</b> of file <b>marginalTrek++.h</b>.

   <b>const</b> <b>double</b> <b>*</b> <b>IsoSpec::Marginal::get_lProbs</b> <b>()</b> <b>const</b> <b>[inline]</b>
       Definition at line <b>90</b> of file <b>marginalTrek++.h</b>.

   <b>double</b> <b>IsoSpec::Marginal::getAtomAverageMass</b> <b>()</b> <b>const</b>
       The average mass of a single atom.

       <b>Returns</b>
           The average mass of a single atom.

       Definition at line <b>281</b> of file <b>marginalTrek++.cpp</b>.

   <b>double</b> <b>IsoSpec::Marginal::getHeaviestConfMass</b> <b>()</b> <b>const</b>
       Get the mass of the heaviest subisotopologue. This is trivially obtained by considering all atomNo atoms
       to be the heaviest isotope possible.

       <b>Returns</b>
           The mass of the heaviest subisotopologue.

       Definition at line <b>259</b> of file <b>marginalTrek++.cpp</b>.

   <b>double</b> <b>IsoSpec::Marginal::getLightestConfMass</b> <b>()</b> <b>const</b>
       Get the mass of the lightest subisotopologue. This is trivially obtained by considering all atomNo atoms
       to be the lightest isotope possible.

       <b>Returns</b>
           The mass of the lightiest subisotopologue.

       Definition at line <b>250</b> of file <b>marginalTrek++.cpp</b>.

   <b>double</b> <b>IsoSpec::Marginal::getLogSizeEstimate</b> <b>(double</b> <b>logEllipsoidRadius)</b> <b>const</b>
       Return estimated logarithm of size of the marginal at a given ellipsoid radius.

       Definition at line <b>301</b> of file <b>marginalTrek++.cpp</b>.

   <b>double</b> <b>IsoSpec::Marginal::getModeLProb</b> <b>()</b> <b>[inline]</b>
       Get the log-probability of the mode subisotopologue.

       <b>Returns</b>
           The log-probability of a/the most probable subisotopologue.

       Definition at line <b>121</b> of file <b>marginalTrek++.h</b>.

   <b>double</b> <b>IsoSpec::Marginal::getModeMass</b> <b>()</b> <b>[inline]</b>
       The the mass of the mode subisotopologue.

       <b>Returns</b>
           The mass of one of the most probable subisotopologues.

       Definition at line <b>115</b> of file <b>marginalTrek++.h</b>.

   <b>double</b> <b>IsoSpec::Marginal::getMonoisotopicConfMass</b> <b>()</b> <b>const</b>
       Get the mass of the monoisotopic subisotopologue. The monoisotopic subisotopologue is defined as the
       molecule consiting only of the most likely isotope. This is frequently the lightest subisotopologue,
       making this frequently (but not always) equal to <b>getLightestConfMass()</b>

       Definition at line <b>268</b> of file <b>marginalTrek++.cpp</b>.

   <b>double</b> <b>IsoSpec::Marginal::getSmallestLProb</b> <b>()</b> <b>const</b> <b>[inline]</b>
       The the log-probability of the lightest subisotopologue.

       <b>Returns</b>
           The logarithm of the smallest non-zero probability of a subisotopologue.

       Definition at line <b>139</b> of file <b>marginalTrek++.h</b>.

   <b>double</b> <b>IsoSpec::Marginal::getTheoreticalAverageMass</b> <b>()</b> <b>const</b> <b>[inline]</b>
       The theoretical average mass of the molecule.

       <b>Returns</b>
           The theoretical average mass of the molecule.

       Definition at line <b>151</b> of file <b>marginalTrek++.h</b>.

   <b>ISOSPEC_FORCE_INLINE</b> <b>double</b> <b>IsoSpec::Marginal::logProb</b> <b>(Conf</b> <b>conf)</b> <b>const</b> <b>[inline],</b>  <b>[protected]</b>
       Definition at line <b>160</b> of file <b>marginalTrek++.h</b>.

   <b>ISOSPEC_FORCE_INLINE</b> <b>double</b> <b>IsoSpec::Marginal::unnormalized_logProb</b> <b>(Conf</b> <b>conf)</b> <b>const</b> <b>[inline],</b>  <b>[protected]</b>
       Calculate the log-probability of a given subisotopologue.

       <b>Parameters</b>
           <u>conf</u> A subisotopologue (a table of integers describing subsequent isotope-counts).

       <b>Returns</b>
           The log-probability of the input subisotopologue.

       Definition at line <b>159</b> of file <b>marginalTrek++.h</b>.

   <b>double</b> <b>IsoSpec::Marginal::variance</b> <b>()</b> <b>const</b>
       Calculate the variance of the theoretical distribution describing the subisotopologue.

       Definition at line <b>289</b> of file <b>marginalTrek++.cpp</b>.

</pre><h4><b>Member</b> <b>Data</b> <b>Documentation</b></h4><pre>
   <b>const</b> <b>double*</b> <b>const</b> <b>IsoSpec::Marginal::atom_lProbs</b> <b>[protected]</b>
       Table of log-probabilities of all the isotopeNo isotopes.

       Definition at line <b>49</b> of file <b>marginalTrek++.h</b>.

   <b>const</b> <b>double*</b> <b>const</b> <b>IsoSpec::Marginal::atom_masses</b> <b>[protected]</b>
       Table of atomic masses of all the isotopeNo isotopes.

       Definition at line <b>50</b> of file <b>marginalTrek++.h</b>.

   <b>const</b> <b>unsigned</b> <b>int</b> <b>IsoSpec::Marginal::atomCnt</b> <b>[protected]</b>
       The number of atoms of the given element.

       Definition at line <b>48</b> of file <b>marginalTrek++.h</b>.

   <b>const</b> <b>unsigned</b> <b>int</b> <b>IsoSpec::Marginal::isotopeNo</b> <b>[protected]</b>
       The number of isotopes of the given element.

       Definition at line <b>47</b> of file <b>marginalTrek++.h</b>.

   <b>const</b> <b>double</b> <b>IsoSpec::Marginal::loggamma_nominator</b> <b>[protected]</b>
       The constant nominator that appears in the expressions for the multinomial probabilities.

       Definition at line <b>51</b> of file <b>marginalTrek++.h</b>.

   <b>Conf</b> <b>IsoSpec::Marginal::mode_conf</b> <b>[protected]</b>
       A subisotopologue with most probability. If not unique, one of the representatives of that class of
       subisotopologues.

       Definition at line <b>52</b> of file <b>marginalTrek++.h</b>.

   <b>double</b> <b>IsoSpec::Marginal::mode_lprob</b> <b>[protected]</b>
       The log-probability of the mode subisotopologue.

       Definition at line <b>53</b> of file <b>marginalTrek++.h</b>.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for IsoSpec from the source code.

IsoSpec                                           Version 2.2.1                             <u>IsoSpec::<a href="../man3/Marginal.3.html">Marginal</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>