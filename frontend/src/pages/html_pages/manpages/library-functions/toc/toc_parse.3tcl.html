<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>doctools::toc::parse - Parsing text in doctoc format</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       doctools::toc::parse - Parsing text in doctoc format

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>doctools::toc::parse</b> <b>?0.2?</b>

       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>doctools::toc::structure</b>

       package require <b>doctools::msgcat</b>

       package require <b>doctools::tcl::parse</b>

       package require <b>fileutil</b>

       package require <b>logger</b>

       package require <b>snit</b>

       package require <b>struct::list</b>

       package require <b>struct::stack</b>

       <b>::doctools::toc::parse</b> <b>text</b> <u>text</u>

       <b>::doctools::toc::parse</b> <b>file</b> <u>path</u>

       <b>::doctools::toc::parse</b> <b>includes</b>

       <b>::doctools::toc::parse</b> <b>include</b> <b>add</b> <u>path</u>

       <b>::doctools::toc::parse</b> <b>include</b> <b>remove</b> <u>path</u>

       <b>::doctools::toc::parse</b> <b>include</b> <b>clear</b>

       <b>::doctools::toc::parse</b> <b>vars</b>

       <b>::doctools::toc::parse</b> <b>var</b> <b>set</b> <u>name</u> <u>value</u>

       <b>::doctools::toc::parse</b> <b>var</b> <b>unset</b> <u>name</u>

       <b>::doctools::toc::parse</b> <b>var</b> <b>clear</b> ?<u>pattern</u>?

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  package  provides  commands to parse text written in the <u>doctoc</u> markup language and convert it into
       the canonical serialization of the  table  of  contents  encoded  in  the  text.   See  the  section  <b>ToC</b>
       <b>serialization</b> <b>format</b> for specification of their format.

       This is an internal package of doctools, for use by the higher level packages handling <u>doctoc</u> documents.

</pre><h4><b>API</b></h4><pre>
       <b>::doctools::toc::parse</b> <b>text</b> <u>text</u>
              The command takes the string contained in <u>text</u> and parses it under the assumption that it contains
              a  document  written  using  the  <u>doctoc</u> markup language. An error is thrown if this assumption is
              found to be false. The format of these errors is described in section <b>Parse</b> <b>errors</b>.

              When successful the command returns the canonical serialization of the table of contents which was
              encoded in the text.  See the section <b>ToC</b> <b>serialization</b> <b>format</b> for specification of that format.

       <b>::doctools::toc::parse</b> <b>file</b> <u>path</u>
              The same as <b>text</b>, except that the text to parse is read from the file specified by <u>path</u>.

       <b>::doctools::toc::parse</b> <b>includes</b>
              This method returns the current list of search paths used when looking for include files.

       <b>::doctools::toc::parse</b> <b>include</b> <b>add</b> <u>path</u>
              This method adds the <u>path</u> to the list of paths searched when looking for an include file. The call
              is ignored if the path is already in the list of paths. The method returns the empty string as its
              result.

       <b>::doctools::toc::parse</b> <b>include</b> <b>remove</b> <u>path</u>
              This method removes the <u>path</u> from the list of paths searched when looking for an include file. The
              call is ignored if the path is not contained in the list of paths. The method  returns  the  empty
              string as its result.

       <b>::doctools::toc::parse</b> <b>include</b> <b>clear</b>
              This method clears the list of search paths for include files.

       <b>::doctools::toc::parse</b> <b>vars</b>
              This  method  returns a dictionary containing the current set of predefined variables known to the
              <b>vset</b> markup command during processing.

       <b>::doctools::toc::parse</b> <b>var</b> <b>set</b> <u>name</u> <u>value</u>
              This method adds the variable <u>name</u> to the set of predefined variables known  to  the  <b>vset</b>  markup
              command  during  processing, and gives it the specified <u>value</u>. The method returns the empty string
              as its result.

       <b>::doctools::toc::parse</b> <b>var</b> <b>unset</b> <u>name</u>
              This method removes the variable <u>name</u> from the set of  predefined  variables  known  to  the  <b>vset</b>
              markup command during processing. The method returns the empty string as its result.

       <b>::doctools::toc::parse</b> <b>var</b> <b>clear</b> ?<u>pattern</u>?
              This  method removes all variables matching the <u>pattern</u> from the set of predefined variables known
              to the <b>vset</b> markup command during processing. The method returns the empty string as its result.

              The pattern matching is done with <b>string</b>  <b>match</b>,  and  the  default  pattern  used  when  none  is
              specified, is <b>*</b>.

</pre><h4><b>PARSE</b> <b>ERRORS</b></h4><pre>
       The format of the parse error messages thrown when encountering violations of the <u>doctoc</u> markup syntax is
       human readable and not intended for processing by machines. As such it is not documented.

       <u>However</u>, the errorCode attached to the message is machine-readable and has the following format:

       [1]    The error code will be a list, each element describing a single error found in the input. The list
              has at least one element, possibly more.

       [2]    Each  error  element  will  be  a  list  containing six strings describing an error in detail. The
              strings will be

              [1]    The path of the file the error occurred in. This may be empty.

              [2]    The range of the token the error was found at. This range is a two-element list  containing
                     the  offset of the first and last character in the range, counted from the beginning of the
                     input (file). Offsets are counted from zero.

              [3]    The line the first character after the error is on.  Lines are counted from one.

              [4]    The column the first character after the error is at.  Columns are counted from zero.

              [5]    The message code of the error. This value can be used as argument to <b>msgcat::mc</b> to obtain a
                     localized  error  message,  assuming  that  the  application  had  a   suitable   call   of
                     <b>doctools::msgcat::init</b>   to   initialize   the  necessary  message  catalogs  (See  package
                     <b>doctools::msgcat</b>).

              [6]    A list of details for the error, like the markup command involved. In the case  of  message
                     code  <b>doctoc/include/syntax</b>  this  value  is  the set of errors found in the included file,
                     using the format described here.

</pre><h4><b>[DOCTOC]</b> <b>NOTATION</b> <b>OF</b> <b>TABLES</b> <b>OF</b> <b>CONTENTS</b></h4><pre>
       The doctoc format for tables of contents, also called the <u>doctoc</u> <u>markup</u> <u>language</u>,  is  too  large  to  be
       covered in single section.  The interested reader should start with the document

       [1]    <u>doctoc</u> <u>language</u> <u>introduction</u>

       and then proceed from there to the formal specifications, i.e. the documents

       [1]    <u>doctoc</u> <u>language</u> <u>syntax</u> and

       [2]    <u>doctoc</u> <u>language</u> <u>command</u> <u>reference</u>.

       to get a thorough understanding of the language.

</pre><h4><b>TOC</b> <b>SERIALIZATION</b> <b>FORMAT</b></h4><pre>
       Here  we specify the format used by the doctools v2 packages to serialize tables of contents as immutable
       values for transport, comparison, etc.

       We distinguish between <u>regular</u> and <u>canonical</u> serializations.  While a table of  contents  may  have  more
       than one regular serialization only exactly one of them will be <u>canonical</u>.

       regular serialization

              [1]    The serialization of any table of contents is a nested Tcl dictionary.

              [2]    This  dictionary  holds  a  single  key, <b>doctools::toc</b>, and its value. This value holds the
                     contents of the table of contents.

              [3]    The contents of the table of contents are a Tcl dictionary holding the title of  the  table
                     of contents, a label, and its elements. The relevant keys and their values are

                     <b>title</b>  The value is a string containing the title of the table of contents.

                     <b>label</b>  The value is a string containing a label for the table of contents.

                     <b>items</b>  The  value is a Tcl list holding the elements of the table, in the order they are to
                            be shown.

                            Each element is a Tcl list holding the type of the item,  and  its  description,  in
                            this  order. An alternative description would be that it is a Tcl dictionary holding
                            a single key, the item type, mapped to the item description.

                            The two legal item types and their descriptions are

                            <b>reference</b>
                                   This item describes a single entry in the table of  contents,  referencing  a
                                   single  document.  To this end its value is a Tcl dictionary containing an id
                                   for the referenced document, a label, and a longer textual description  which
                                   can be associated with the entry.  The relevant keys and their values are

                                   <b>id</b>     The  value  is  a  string containing the id of the document associated
                                          with the entry.

                                   <b>label</b>  The value is a string containing a label for this entry.  This  string
                                          also  identifies  the  entry,  and  no  two  entries  (references  and
                                          divisions) in the containing list are allowed to have the same label.

                                   <b>desc</b>   The value is a string containing a longer description for this entry.

                            <b>division</b>
                                   This item describes a group of entries in the table of contents,  inducing  a
                                   hierarchy of entries.  To this end its value is a Tcl dictionary containing a
                                   label  for  the  group, an optional id to a document for the whole group, and
                                   the list of entries in the group.  The relevant keys and their values are

                                   <b>id</b>     The value is a string containing the id  of  the  document  associated
                                          with the whole group. This key is optional.

                                   <b>label</b>  The  value  is  a string containing a label for the group. This string
                                          also  identifies  the  entry,  and  no  two  entries  (references  and
                                          divisions) in the containing list are allowed to have the same label.

                                   <b>items</b>  The  value  is  a  Tcl  list holding the elements of the group, in the
                                          order they are to be shown.  This list has the same structure  as  the
                                          value  for  the  keyword  <b>items</b>  used  to  describe the whole table of
                                          contents, see above. This  closes  the  recusrive  definition  of  the
                                          structure,  with  divisions  holding  the same type of elements as the
                                          whole table of contents, including other divisions.

       canonical serialization
              The canonical serialization of a table of contents has the format as  specified  in  the  previous
              item,  and  then  additionally satisfies the constraints below, which make it unique among all the
              possible serializations of this table of contents.

              [1]    The keys found in all the nested Tcl dictionaries are sorted in ascending dictionary order,
                     as generated by Tcl's builtin command <b>lsort</b> <b>-increasing</b> <b>-dict</b>.

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This document, and the package it describes, will undoubtedly contain bugs and  other  problems.   Please
       report  such  in  the  category  <u>doctools</u>  of the <u>Tcllib</u> <u>Trackers</u> [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].
       Please also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note further that <u>attachments</u> are strongly preferred over inlined patches. Attachments  can  be  made  by
       going  to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most button
       in the secondary navigation bar.

</pre><h4><b>KEYWORDS</b></h4><pre>
       doctoc, doctools, lexer, parser

</pre><h4><b>CATEGORY</b></h4><pre>
       Documentation tools

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2009 Andreas Kupries &lt;<a href="mailto:andreas_kupries@users.sourceforge.net">andreas_kupries@users.sourceforge.net</a>&gt;

tcllib                                                  1                             <u>doctools::toc::<a href="../man3tcl/parse.3tcl.html">parse</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>