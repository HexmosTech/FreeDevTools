<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>doctools::toc::structure - Doctoc serialization utilities</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       doctools::toc::structure - Doctoc serialization utilities

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>doctools::toc::structure</b> <b>?0.2?</b>

       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>logger</b>

       package require <b>snit</b>

       <b>::doctools::toc::structure</b> <b>verify</b> <u>serial</u> ?<u>canonvar</u>?

       <b>::doctools::toc::structure</b> <b>verify-as-canonical</b> <u>serial</u>

       <b>::doctools::toc::structure</b> <b>canonicalize</b> <u>serial</u>

       <b>::doctools::toc::structure</b> <b>print</b> <u>serial</u>

       <b>::doctools::toc::structure</b> <b>merge</b> <u>seriala</u> <u>serialb</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  package  provides  commands to work with the serializations of tables of contents as managed by the
       doctools system v2, and specified in section <b>ToC</b> <b>serialization</b> <b>format</b>.

       This is an internal package of doctools, for use by the higher level packages handling tables of contents
       and their conversion into and out of various other formats, like documents written using <u>doctoc</u> markup.

</pre><h4><b>API</b></h4><pre>
       <b>::doctools::toc::structure</b> <b>verify</b> <u>serial</u> ?<u>canonvar</u>?
              This command verifies that the content of <u>serial</u> is a valid <u>regular</u> serialization of  a  table  of
              contents  and  will throw an error if that is not the case. The result of the command is the empty
              string.

              If the argument <u>canonvar</u> is specified it is interpreted as the name of a variable in  the  calling
              context.  This variable will be written to if and only if <u>serial</u> is a valid regular serialization.
              Its value will be a boolean, with <b>True</b> indicating that the serialization is not  only  valid,  but
              also <u>canonical</u>. <b>False</b> will be written for a valid, but non-canonical serialization.

              For  the  specification  of regular and canonical serializations see the section <b>ToC</b> <b>serialization</b>
              <b>format</b>.

       <b>::doctools::toc::structure</b> <b>verify-as-canonical</b> <u>serial</u>
              This command verifies that the content of <u>serial</u> is a valid <u>canonical</u> serialization of a table  of
              contents  and  will throw an error if that is not the case. The result of the command is the empty
              string.

              For the specification of canonical serializations see the section <b>ToC</b> <b>serialization</b> <b>format</b>.

       <b>::doctools::toc::structure</b> <b>canonicalize</b> <u>serial</u>
              This command assumes that the content of <u>serial</u> is a valid <u>regular</u> serialization  of  a  table  of
              contents and will throw an error if that is not the case.

              It will then convert the input into the <u>canonical</u> serialization of the contained table of contents
              and return it as its result. If the input is already canonical it will be returned unchanged.

              For  the  specification  of regular and canonical serializations see the section <b>ToC</b> <b>serialization</b>
              <b>format</b>.

       <b>::doctools::toc::structure</b> <b>print</b> <u>serial</u>
              This command assumes that the argument <u>serial</u> contains a valid regular serialization of a table of
              contents and returns a string containing that table in a human readable form.

              The exact format of this form is not specified and cannot  be  relied  on  for  parsing  or  other
              machine-based activities.

              For the specification of regular serializations see the section <b>ToC</b> <b>serialization</b> <b>format</b>.

       <b>::doctools::toc::structure</b> <b>merge</b> <u>seriala</u> <u>serialb</u>
              This  command accepts the regular serializations of two tables of contents and uses them to create
              their union.  The result of the command is the canonical serialization of this  unified  table  of
              contents.

              Title and label of the resulting table are taken from the table contained in <u>serialb</u>.

              The whole table and its divisions are merged recursively in the same manner:

              [1]    All  reference  elements  which  occur  in  both  divisions (identified by their label) are
                     unified with document id's and descriptions taken from the second table.

              [2]    All division elements which occur in both divisions (identified by their label) are unified
                     with the optional document id taken from the second table, if any, or  from  the  first  if
                     none  is  in the second. The elements in the division are merged recursively using the same
                     algorithm as described in this list.

              [3]    Type conflicts between elements,  i.e.  finding  two  elements  with  the  same  label  but
                     different types result in a merge error.

              [4]    All  elements found in the second division but not in the first are added to the end of the
                     list of elements in the merge result.

       For the specification of regular and canonical serializations see the section <b>ToC</b> <b>serialization</b> <b>format</b>.

</pre><h4><b>TOC</b> <b>SERIALIZATION</b> <b>FORMAT</b></h4><pre>
       Here we specify the format used by the doctools v2 packages to serialize tables of contents as  immutable
       values for transport, comparison, etc.

       We  distinguish  between  <u>regular</u>  and <u>canonical</u> serializations.  While a table of contents may have more
       than one regular serialization only exactly one of them will be <u>canonical</u>.

       regular serialization

              [1]    The serialization of any table of contents is a nested Tcl dictionary.

              [2]    This dictionary holds a single key, <b>doctools::toc</b>, and its  value.  This  value  holds  the
                     contents of the table of contents.

              [3]    The  contents  of the table of contents are a Tcl dictionary holding the title of the table
                     of contents, a label, and its elements. The relevant keys and their values are

                     <b>title</b>  The value is a string containing the title of the table of contents.

                     <b>label</b>  The value is a string containing a label for the table of contents.

                     <b>items</b>  The value is a Tcl list holding the elements of the table, in the order they are  to
                            be shown.

                            Each  element  is  a  Tcl list holding the type of the item, and its description, in
                            this order. An alternative description would be that it is a Tcl dictionary  holding
                            a single key, the item type, mapped to the item description.

                            The two legal item types and their descriptions are

                            <b>reference</b>
                                   This  item  describes  a single entry in the table of contents, referencing a
                                   single document.  To this end its value is a Tcl dictionary containing an  id
                                   for  the referenced document, a label, and a longer textual description which
                                   can be associated with the entry.  The relevant keys and their values are

                                   <b>id</b>     The value is a string containing the id  of  the  document  associated
                                          with the entry.

                                   <b>label</b>  The  value  is a string containing a label for this entry. This string
                                          also  identifies  the  entry,  and  no  two  entries  (references  and
                                          divisions) in the containing list are allowed to have the same label.

                                   <b>desc</b>   The value is a string containing a longer description for this entry.

                            <b>division</b>
                                   This  item  describes a group of entries in the table of contents, inducing a
                                   hierarchy of entries.  To this end its value is a Tcl dictionary containing a
                                   label for the group, an optional id to a document for the  whole  group,  and
                                   the list of entries in the group.  The relevant keys and their values are

                                   <b>id</b>     The  value  is  a  string containing the id of the document associated
                                          with the whole group. This key is optional.

                                   <b>label</b>  The value is a string containing a label for the  group.  This  string
                                          also  identifies  the  entry,  and  no  two  entries  (references  and
                                          divisions) in the containing list are allowed to have the same label.

                                   <b>items</b>  The value is a Tcl list holding the elements  of  the  group,  in  the
                                          order  they  are to be shown.  This list has the same structure as the
                                          value for the keyword <b>items</b>  used  to  describe  the  whole  table  of
                                          contents,  see  above.  This  closes  the  recusrive definition of the
                                          structure, with divisions holding the same type  of  elements  as  the
                                          whole table of contents, including other divisions.

       canonical serialization
              The  canonical  serialization  of  a table of contents has the format as specified in the previous
              item, and then additionally satisfies the constraints below, which make it unique  among  all  the
              possible serializations of this table of contents.

              [1]    The keys found in all the nested Tcl dictionaries are sorted in ascending dictionary order,
                     as generated by Tcl's builtin command <b>lsort</b> <b>-increasing</b> <b>-dict</b>.

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This  document,  and  the package it describes, will undoubtedly contain bugs and other problems.  Please
       report such in the category  <u>doctools</u>  of  the  <u>Tcllib</u>  <u>Trackers</u>  [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].
       Please also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note  further  that  <u>attachments</u>  are strongly preferred over inlined patches. Attachments can be made by
       going to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most  button
       in the secondary navigation bar.

</pre><h4><b>KEYWORDS</b></h4><pre>
       deserialization, doctoc, doctools, serialization

</pre><h4><b>CATEGORY</b></h4><pre>
       Documentation tools

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2009 Andreas Kupries &lt;<a href="mailto:andreas_kupries@users.sourceforge.net">andreas_kupries@users.sourceforge.net</a>&gt;

tcllib                                                 0.2                        <u>doctools::toc::<a href="../man3tcl/structure.3tcl.html">structure</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>