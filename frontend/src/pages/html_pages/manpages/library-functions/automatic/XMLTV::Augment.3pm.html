<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XMLTV::Augment - Augment XMLTV listings files with automatic and user-defined rules.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libxmltv-perl">libxmltv-perl_1.4.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       XMLTV::Augment - Augment XMLTV listings files with automatic and user-defined rules.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Augment an XMLTV xml file by applying corrections ("fixups") to programmes matching defined criteria
       ("rules").

       Two types of rules are actioned: (i) automatic, (ii) user-defined.

       Automatic rules use pre-programmed input and output to modify the input programmes. E.g. removing a
       "title" where it is repeated in a "sub-title" (e.g. "Horizon" / "Horizon: Star Wars"), or trying to
       identify and extract series/episode numbers from the programme"s title, sub-title or description.

       User-defined rules use the content of a "rules" file which allows programmes matching certain user-
       defined criteria to be corrected/enhanced with the user data supplied (e.g. adding/changing categories
       for all episodes of "Horizon", or fixing misspellings in titles, etc.)

       By setting appropriate options in the "config" file, the "rules" file can be automatically downloaded
       using XMLTV::Supplement.

</pre><h4><b>EXPORTED</b> <b>FUNCTIONS</b></h4><pre>
       <b>setEncoding</b>
           Set the assumed encoding of the rules file.

       <b>inputChannel</b>
           Store each channel found in the input programmes file for later processing by "stats".

       <b>augmentProgramme</b>
           Augment  a  programme  using  (i)  pre-determined rules and (ii) user-defined rules.  Which rules are
           processed is determined by the options set in the "config" file.

       <b>printInfo</b>
           Print the lists of actions taken and suggestions for further fixups.

       <b>end</b> Do any final processing before exit (e.g. close the log file if necessary).

</pre><h4><b>INSTANTIATION</b></h4><pre>
           new XMLTV::Augment( { ...parameters...} );

       Possible parameters:
             rule       =&gt; filename of file containing fixup rules (if omitted then no user-defined  rules  will
       be actioned) (overrides auto-fetch Supplement if that is defined; see sample options file)
             config     =&gt; filename of config file to read (if omitted then no config file will be used)
             encoding   =&gt; assumed encoding of the rules file (default = UTF-8)
             stats      =&gt; whether to print the audit stats in the log (values = 0,1) (default = 1)
             log        =&gt; filename of output log
             debug      =&gt; debug level (values 0-10) (default = no debug)
                               note  debug  level  &gt; 3 is not likely to be of much use unless you are developing
       code

</pre><h4><b>TYPICAL</b> <b>USAGE</b></h4><pre>
        1) Create the XMLTV::Augment object
        2) Pass each channel to inputChannel()
        3) Pass each programme to augmentProgramme()
        4) Tidy up using printInfo() &amp; end()

               #instantiate the object
               my $augment = new XMLTV::Augment(
                         "rule"       =&gt; "myrules.txt",
                         "config"     =&gt; "myconfig.txt",
                         "log"        =&gt; "augment.log",
                         );
               die "failed to create XMLTV::Augment object" if !$augment;

               for each channel... {
                 # store the channel details
                 $augment-&gt;inputChannel( $ch );
               }

               for each programme... {
                 # augmentProgramme will now do any requested processing of the input xml
                 $prog = $augment-&gt;augmentProgramme( $prog );
               }

               # log the stats
               $augment-&gt;printInfo();

               # close the log file if necessary
               $augment-&gt;end();

       Note: you are responsible for reading/writing to the XMLTV .xml file; the package will not  do  that  for
       you.

</pre><h4><b>RULES</b></h4><pre>
       <b>remove_duplicated_new_title_in_ep</b>
           Rule #A1

           Remove "New $title :" from &lt;sub-title&gt;

             If sub-title starts with "New" + &lt;title&gt; + separator, then it will be removed from the sub-title
             "separator" can be any of .,:;-

             in : "Antiques Roadshow / New Antiques Roadshow: Doncaster"
             out: "Antiques Roadshow / Doncaster"

       <b>remove_duplicated_title_and_ep_in_ep</b>
           Rule #A2

           Remove duplicated programme title *and* episode from &lt;sub-title&gt;

             If sub-title starts with &lt;title&gt; + separator + &lt;episode&gt; + separator + &lt;episode&gt;, then it will be removed from the sub-title
             "separator" can be any of .,:;-

             in : "Antiques Roadshow / Antiques Roadshow: Doncaster: Doncaster"
             out: "Antiques Roadshow / Doncaster"

       <b>remove_duplicated_title_in_ep</b>
           Rule #A3

           Remove duplicated programme title from &lt;sub-title&gt;

             i) If sub-title starts with &lt;title&gt; + separator, then it will be removed from the sub-title
             ii) If sub-title ends with separator + &lt;title&gt;, then it will be removed from the sub-title
             iii) If sub-title starts with &lt;title&gt;(...), then the sub-title will be set to the text in brackets
             iv) If sub-title equals &lt;title&gt;, then the sub-title will be removed
             "separator" can be any of .,:;-

             in : "Antiques Roadshow / Antiques Roadshow: Doncaster"
             out: "Antiques Roadshow / Doncaster"

             in : "Antiques Roadshow / Antiques Roadshow (Doncaster)"
             out: "Antiques Roadshow / Doncaster"

             in : "Antiques Roadshow / Antiques Roadshow"
             out: "Antiques Roadshow / "

       <b>update_premiere_repeat_flags_from_desc</b>
           Rule #A4

           Set  the  &lt;premiere&gt;  element  and  remove  any  &lt;previously-shown&gt;  element  if  &lt;desc&gt;  starts with
           "Premiere." or "New series". Remove the "Premiere." text.  Set  the  &lt;previously-shown&gt;  element  and
           remove any &lt;premiere&gt; element if &lt;desc&gt; starts with "Another chance" or "Rerun" or "Repeat"

       <b>check_potential_numbering_in_text</b>
           Rule #A5

           Check for potential series, episode and part numbering in the title, episode and description fields.

       <b>extract_numbering_from_title</b>
           Rule #A5.1

           Extract series/episode numbering found in &lt;title&gt;.

       <b>extract_numbering_from_episode</b>
           Rule #A5.2

           Extract series/episode numbering found in &lt;sub-title&gt;.

       <b>extract_numbering_from_desc</b>
           Rule #A5.3

           Extract series/episode numbering found in &lt;desc&gt;.

       <b>make_episode_from_part_numbers</b>
           Rule #A5.4

           If no &lt;sub-title&gt; then make one from "part" numbers.

             in : "Panorama / "  desc = "Part 1/2..."
             out: "Panorama / Part 1 of 2"

       <b>process_user_rules</b>
           Rule #user

           Process programme against user-defined fixups

           The  individual  rules  each have their own option to run or not; consider this like an on/off switch
           for all of them. I.e. if this option is off then no user rules will be run (irrespective of any other
           option flags).

       <b>process_non_title_info</b>
           Rule #1

           Remove specified non-title text from &lt;title&gt;.

             If title starts with text + separator, then it will be removed from the title
             "separator" can be any of :;-

             rule: 1|Python Night
             in : "Python Night: Monty Python - Live at the Hollywood Bowl / "
             out: "Monty Python - Live at the Hollywood Bowl / "

       <b>process_demoted_titles</b>
           Rule #11

           Promote demoted title from &lt;sub-title&gt; to &lt;title&gt;.

             If title matches, and sub-title starts with text then remove matching text from sub-title and move it into the title.
             Any text after 'separator' in the sub-title is preserved. 'separator' can be any of .,:;-

             rule: 11|Blackadder~Blackadder II
             in : "Blackadder / Blackadder II: Potato"
             out: "Blackadder II / Potato"

       <b>process_replacement_titles_desc</b>
           Rule #10

           Replace specified &lt;title&gt; / &lt;sub-title&gt; with title/episode pair supplied using &lt;desc&gt;.

             If title &amp; sub-title match supplied data, then replace &lt;title&gt; and &lt;sub-title&gt; with new data supplied.

             rule: 10|Which Doctor~~Gunsmoke~Which Doctor~Festus and Doc go fishing, but are captured by a family that is feuding with the Haggens.
             in : "Which Doctor / " desc&gt; = "  Festus and Doc go fishing, but are captured by a family that is feuding with the Haggens. ..."
             out: "Gunsmoke / Which Doctor"

       <b>process_replacement_titles_episodes</b>
           Rule #8

           Replace specified &lt;title&gt; / &lt;sub-title&gt; with title/episode pair supplied.

             If title &amp; sub-title match supplied data, then replace &lt;title&gt; and &lt;sub-title&gt; with new data supplied.

             rule: 8|Top Gear USA Special~Detroit~Top Gear~USA Special
             in : "Top Gear USA Special / Detroit"
             out: "Top Gear / USA Special"

             rule: 8|Top Gear USA Special~~Top Gear~USA Special
             in : "Top Gear USA Special / "
             out: "Top Gear / USA Special"
               or
             in : "Top Gear USA Special / 1/6."
             out: "Top Gear / 1/6. USA Special"

       <b>process_mixed_title_subtitle</b>
           Rule #2

           Extract sub-title from &lt;title&gt;.

             If title starts with text + separator, then the text after it will be moved into the sub-title
             "separator" can be any of :;-

             rule: 2|Blackadder II
             in : "Blackadder II: Potato / "
             out: "Blackadder II / Potato"

       <b>process_mixed_subtitle_title</b>
           Rule #3

           Extract sub-title from &lt;title&gt;.

             If title ends with separator + text, then the text before it will be moved into the sub-title
             "separator" can be any of :;-

             rule: 3|Storyville
             in : "Kings of Pastry :Storyville / "
             out: "Storyville / Kings of Pastry"

       <b>process_reversed_title_subtitle</b>
           Rule #4

           Reverse &lt;title&gt; and &lt;sub-title&gt;

             If sub-title matches the rule's text, then swap the title and sub-title

             rule: 4|Storyville
             in : "Kings of Pastry / Storyville"
             out: "Storyville / Kings of Pastry"

       <b>process_replacement_titles</b>
           Rule #5

           Replace &lt;title&gt; with supplied text.

             If title matches the rule's text, then use the replacement text supplied

             rule: 5|A Time Team Special~Time Team
             in : "A Time Team Special / Doncaster"
             out: "Time Team / Doncaster"

           This is the one which you will probably use most. It can be used to fix most incorrect titles -  e.g.
           spelling mistakes; punctuation; character case; etc.

       <b>process_subtitle_remove_text</b>
           Rule #13

           Remove specified text from &lt;sub-title&gt; for a given &lt;title&gt;.

             If sub-title starts with text + separator, or ends with separator + text,
             then it will be removed from the sub-title.
             "separator" can be any of .,:;- and is optional.

             rule: 13|Time Team~A Time Team Special
             in : "Time Team / Doncaster : A Time Team Special "
             out: "Time Team / Doncaster"

       <b>process_replacement_episodes</b>
           Rule #7

           Replace &lt;sub-title&gt; with supplied text.

             If sub-title matches the rule's text, then use the replacement text supplied

             rule: 7|Time Team~Time Team Special: Doncaster~Doncaster
             in : "Time Team / Time Team Special: Doncaster"
             out: "Time Team / Doncaster"

       <b>process_replacement_ep_from_desc</b>
           Rule #9

           Replace &lt;sub-title&gt; with supplied text when the &lt;desc&gt; matches that given.

             If sub-title matches the rule's text, then use the replacement text supplied

             rule: 9|Heroes of Comedy~The Goons~The series celebrating great British comics pays tribute to the Goons.
             in : "Heroes of Comedy / "
             out: "Heroes of Comedy / The Goons"
               or
             in : "Heroes of Comedy / Spike Milligan"
             out: "Heroes of Comedy / The Goons"

       <b>process_replacement_genres</b>
           Rule #6

           Replace &lt;category&gt; with supplied text.

             If title matches the rule's text, then use the replacement category(-ies) supplied
             (note ALL existing categories are replaced)

             rule: 6|Antiques Roadshow~Entertainment~Arts~Shopping
             in : "Antiques Roadshow / " category "Reality"
             out: "Antiques Roadshow / " category "Entertainment" + "Arts" + "Shopping"

           You  can specify a wildcard with the title by using %% which represents any number of characters.  So
           for example "News%%" will match "News", "News  and  Weather",  "Newsnight",  etc.   But  be  careful;
           "%%News%%"  will  also  match  "John Craven's Newsround", "Eurosport News", "Election Newsroom Live",
           "Have I Got News For You", "Scuzz Meets Jason Newsted", etc.

       <b>process_replacement_film_genres</b>
           Rule #12

           Replace "Film"/"Films" &lt;category&gt; with supplied text.

             If title matches the rule's text and the prog has category "Film" or "Films", then use the replacement category(-ies) supplied
             (note ALL categories are replaced, not just "Film")

             rule: 12|The Hobbit Special~Entertainment~Interview
             in : "The Hobbit Special / " category "Film" + "Drama"
             out: "The Hobbit Special / " category "Entertainment" + "Interview"

       <b>process_translate_genres</b>
           Rule #14

           Replace &lt;category&gt; with supplied value(s).

             If category matches one found in the prog, then replace it with the category(-ies) supplied
             (note any other categories are left alone)

             rule: 14|Soccer~Football
             in : "Leeds v Arsenal" category "Soccer"
             out: "Leeds v Arsenal" category "Football"

             rule: 14|Adventure/War~Action Adventure~War
             in : "Leeds v Arsenal" category "Adventure/War"
             out: "Leeds v Arsenal" category "Action Adventure" + "War"

       <b>process_add_genres_to_channel</b>
           Rule #15

           Add a category to all programmes on a specified channel.

             If channel matches this prog, the add the supplied category(-ies) to the programme
             (note any other categories are left alone)

             rule: 15|travelchannel.co.uk~Travel
             in : "World's Greatest Motorcycle Rides" category "Motoring"
             out: "World's Greatest Motorcycle Rides" category "Motoring" + "Travel"

             rule: 15|cnbc.com~News~Business
             in : "Investing in India" category ""
             out: "Investing in India" category "News" + "Business"

           You should be very careful with this one as it will add the category you specify to  EVERY  programme
           broadcast  on  that  channel.  This  may  not be what you always want (e.g. Teleshopping isn't really
           "music" even if it is on MTV!)

       <b>process_remove_numbering_from_programmes</b>
           Rule #16

           Remove episode numbering from a given programme title (on an optionally-specified channel).

             If title matches the one in the prog, all programme numbering for the programme
             is removed, on any channel. An optional channel identifier can be provided to
             restrict the removal of programme numbering to the given channel.

             rule: 16|Bedtime Story
             in : "CBeebies Bedtime Story" episode-num ".700."
             out: "CBeebies Bedtime Story" episode-num ""

             rule: 16|CBeebies Bedtime Story~cbeebies.bbc.co.uk
             in : "CBeebies Bedtime Story" episode-num ".700."
             out: "CBeebies Bedtime Story" episode-num ""

           Remember to specify the optional channel limiter if you have good programme  numbering  for  a  given
           programme title on some channels but not others.

</pre><h4><b>AUTHOR</b></h4><pre>
       Geoff Westcott, honir.at.gmail.dot.com, Dec. 2014.

       This code is based on the "fixup" method/code defined in tv_grab_uk_rt grabber and credit is given to the
       author Nick Morrott.

perl v5.40.1                                       2025-04-19                                       <u><a href="../man3pm/Augment.3pm.html">Augment</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>