<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mtbl_fileset - automatic multiple MTBL data file merger</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmtbl-dev">libmtbl-dev_1.6.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mtbl_fileset - automatic multiple MTBL data file merger

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;mtbl.h&gt;</b>

       Fileset objects:

       <b>struct</b> <b>mtbl_fileset</b> <b>*</b>
       <b>mtbl_fileset_init(const</b> <b>char</b> <b>*</b><u>fname</u><b>,</b> <b>const</b> <b>struct</b> <b>mtbl_fileset_options</b> <b>*</b><u>fopt</u><b>);</b>

       <b>struct</b> <b>mtbl_fileset</b> <b>*</b>
       <b>mtbl_fileset_dup(struct</b> <b>mtbl_fileset</b> <b>*</b><u>orig</u><b>,</b> <b>const</b> <b>struct</b> <b>mtbl_fileset_options</b> <b>*</b><u>fopt</u><b>);</b>

       <b>void</b>
       <b>mtbl_fileset_destroy(struct</b> <b>mtbl_fileset</b> <b>**</b><u>f</u><b>);</b>

       <b>void</b>
       <b>mtbl_fileset_reload(struct</b> <b>mtbl_fileset</b> <b>*</b><u>f</u><b>);</b>

       <b>void</b>
       <b>mtbl_fileset_reload_now(struct</b> <b>mtbl_fileset</b> <b>*</b><u>f</u><b>);</b>

       <b>const</b> <b>struct</b> <b>mtbl_source</b> <b>*</b>
       <b>mtbl_fileset_source(struct</b> <b>mtbl_fileset</b> <b>*</b><u>f</u><b>);</b>

       <b>void</b>
       <b>mtbl_fileset_partition(struct</b> <b>mtbl_fileset</b> <b>*</b><u>f</u><b>,</b>
                       <b>mtbl_filename_filter_func</b> <u>cb</u><b>,</b>
                       <b>void</b> <b>*</b><u>clos</u><b>,</b>
                       <b>struct</b> <b>mtbl_merger</b> <b>**</b><u>m1</u><b>,</b>
                       <b>struct</b> <b>mtbl_merger</b> <b>**</b><u>m2</u><b>);</b>

       Fileset options:

       <b>struct</b> <b>mtbl_fileset_options</b> <b>*</b>
       <b>mtbl_fileset_options_init(void);</b>

       <b>void</b>
       <b>mtbl_fileset_options_destroy(struct</b> <b>mtbl_fileset_options</b> <b>**</b><u>fopt</u><b>);</b>

       <b>void</b>
       <b>mtbl_fileset_options_set_merge_func(</b>
               <b>struct</b> <b>mtbl_fileset_options</b> <b>*</b><u>fopt</u><b>,</b>
               <b>mtbl_merge_func</b> <u>fp</u><b>,</b>
               <b>void</b> <b>*</b><u>clos</u><b>);</b>

       <b>void</b>
       <b>mtbl_fileset_options_set_dupsort_func(</b>
               <b>struct</b> <b>mtbl_fileset_options</b> <b>*</b><u>fopt</u><b>,</b>
               <b>mtbl_dupsort_func</b> <u>fp</u><b>,</b>
               <b>void</b> <b>*</b><u>clos</u><b>);</b>

       <b>void</b>
       <b>mtbl_fileset_options_set_filename_filter_func(</b>
               <b>struct</b> <b>mtbl_fileset_options</b> <b>*</b><u>fopt</u><b>,</b>
               <b>mtbl_filename_filter_func</b> <u>fp</u><b>,</b>
               <b>void</b> <b>*</b><u>clos</u><b>);</b>

       <b>void</b>
       <b>mtbl_fileset_options_set_reader_filter_func(</b>
               <b>struct</b> <b>mtbl_fileset_options</b> <b>*</b><u>fopt</u><b>,</b>
               <b>mtbl_reader_filter_func</b> <u>fp</u><b>,</b>
               <b>void</b> <b>*</b><u>clos</u><b>);</b>

       <b>void</b>
       <b>mtbl_fileset_options_set_reload_interval(</b>
               <b>struct</b> <b>mtbl_fileset_options</b> <b>*</b><u>fopt</u><b>,</b>
               <b>uint32_t</b> <u>reload_interval</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>mtbl_fileset</b> is a convenience interface for automatically maintaining a merged view of a set of MTBL
       data files. The merged entries may be consumed via the <b><a href="../man3/mtbl_source.3.html">mtbl_source</a></b>(3) and <b><a href="../man3/mtbl_iter.3.html">mtbl_iter</a></b>(3) interfaces.

       <b>mtbl_fileset</b> objects are initialized from a "setfile", which specifies a list of filenames of MTBL data
       files, one per line. For each filename, if it is not an absolute path, then the directory name of the
       fileset file’s pathname is prepended to it. Examples: If the setfile path is
       "/export/dnstable/mtbl/dns.fileset", and a line in it is of the form "dns.2017.Y.mtbl" then <b>dnstable</b> will
       try to open "/export/dnstable/mtbl/dns.2017.Y.mtbl". If the setfile path is
       "/export/dnstable/mtbl/dns.fileset", and a line in it is of the form "/tmp/dns.2017.Y.mtbl" then <b>dnstable</b>
       will try to open "/tmp/dns.2017.Y.mtbl".

       Internally, an <b>mtbl_reader</b> object is initialized from each filename and added to an <b>mtbl_merger</b> object.
       The setfile is watched for changes and the addition or removal of filenames from the setfile will result
       in the corresponding addition or removal of <b>mtbl_reader</b> objects.

       Because the MTBL format does not allow duplicate keys, the caller must provide a function which will
       accept a key and two conflicting values for that key and return a replacement value. This function may be
       called multiple times for the same key if the same key is inserted more than twice. See <b><a href="../man3/mtbl_merger.3.html">mtbl_merger</a></b>(3)
       for further details about the merge function.

       <b>mtbl_fileset</b> objects are created with the <b>mtbl_fileset_init</b>() function, which requires the path to a
       "setfile", <u>fname</u>, and a non-NULL <u>fopt</u> argument which has been configured with a merge function <u>fp</u>.
       <b>mtbl_fileset_source</b>() should then be called in order to consume output via the <b><a href="../man3/mtbl_source.3.html">mtbl_source</a></b>(3) interface.

       The <b>mtbl_fileset_dup</b>() function, which requires a <b>mtbl_fileset</b> object and a non-NULL <b>opt</b> argument,
       creates a duplicate <b>mtbl_fileset</b> object that shares the underlying fileset, but with different fileset
       options, as specified.

       Accesses via the <b><a href="../man3/mtbl_source.3.html">mtbl_source</a></b>(3) interface will implicitly check for updates to the setfile. However, it
       may be necessary to explicitly call the <b>mtbl_fileset_reload</b>() function in order to check for updates,
       especially if files are being removed from the setfile and the <b>mtbl_source</b> is infrequently accessed.

       The <b>mtbl_fileset_reload</b>() function avoids checking for updates more frequently than every <u>reload_interval</u>
       seconds. If <b>reload_interval</b> is set to <b>MTBL_FILESET_RELOAD_INTERVAL_NEVER</b>, then <b>mtbl_fileset_reload</b>()
       function will only load the fileset once. The <b>mtbl_fileset_reload_now</b>() function can be called to bypass
       the <u>reload_interval</u> check.

       The <b>mtbl_fileset_partition</b>() function yields two <b>struct</b> <b>mtbl_merger</b> objects that are split based on the
       output of a callback. The caller is responsible for calling <b>mtbl_merger_destroy</b>() on each of these
       mergers. Calls to <b>mtbl_source_*</b>() on the fileset’s source object, and calls to <b>mtbl_fileset_reload</b>() and
       <b>mtbl_fileset_reload_now</b>(), including those implicitly performed by operations on the fileset source, may
       leave these mergers in an inconsistent state. For this reason, <b>mtbl_fileset_partition</b>() use is deprecated
       in favor of <b>mtbl_fileset_dup</b>() with the <b>fname_filter_func</b> option set.

   <b>Fileset</b> <b>options</b>
       <b>merge_func</b>

           See <b><a href="../man3/mtbl_merger.3.html">mtbl_merger</a></b>(3). An <b>mtbl_merger</b> object is used internally for the external sort.

       <b>dupsort_func</b>

           See <b><a href="../man3/mtbl_merger.3.html">mtbl_merger</a></b>(3). Used to sort the entries with duplicate keys during the merge process based on
           their data.

       <b>fname_filter_func</b>

           Used to filter specific files by name from a fileset. If the function returns <b>false</b>, the file’s data
           will not be included in the results returned by any iterators on the fileset.

       <b>reader_filter_func</b>

           Used to filter specific readers from a fileset. If the function returns <b>false</b>, the reader’s data will
           not be included in the results returned by any iterators on the fileset.

       <b>reload_interval</b>

           Specifies the interval between checks for updates to the setfile, in seconds. Defaults to 60 seconds.
           <b>MTBL_FILESET_RELOAD_INTERVAL_NEVER</b> is a special value that indicates to never reload the fileset.

                                                   11/28/2022                                    <u><a href="../man3/MTBL_FILESET.3.html">MTBL_FILESET</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>