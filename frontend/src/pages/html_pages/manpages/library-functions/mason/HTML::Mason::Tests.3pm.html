<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML::Mason::Tests - Test harness for testing Mason</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libhtml-mason-perl">libhtml-mason-perl_1.60-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       HTML::Mason::Tests - Test harness for testing Mason

</pre><h4><b>SYNOPSIS</b></h4><pre>
        use HTML::Mason::Tests;

        my $group = HTML::Mason::Tests-&gt;new( name =&gt; 'name of group', description =&gt; 'tests something' );
        $group-&gt;add_test( name =&gt; 'foo',
                          description =&gt; 'tests foo',
                          component =&gt; &lt;&lt;'EOF'
        &lt;%args&gt;
        $foo =&gt; 1
        &lt;/%args&gt;
        &lt;% $foo %&gt;
        EOF
                          expect =&gt; &lt;&lt;'EOF',
        1
        EOF
                        );

        $group-&gt;run;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This module is designed to automate as much as possible of the Mason test suite.  It does tasks like
       write component files to disk, call them, compare the actual results to the expected results, and more.
       In addition, it also is capable of printing out useful information about test failures when run in
       verbose mode.  See the ADDITIONAL RUN MODES section for more information.

       It also makes sure that any given group of tests provides all the information needed to run them (test
       names, components and results, etc.).

       Now you have no excuse for writing new tests (and that goes double for me!).

</pre><h4><b>METHODS</b></h4><pre>
   <b>new</b>
       Takes the following parameters:

       •   name (required)

           The name of the entire group of tests.

       •   description (required)

           What this group tests.

       •   pre_test_cleanup (optional, default=1)

           If  this is true (the default), the component root and data directory will be deleted both before and
           after running tests.

   <b>add_support</b>
       Takes the following parameters:

       •   path (required)

           The path that other components will expect  this  component  to  be  reachable  at.   All  paths  are
           prepended  with  the group name.  So '/bar' as a support component in the 'foo' group's ultimate path
           would be '/foo/bar'.

       •   component

           Text of the support component.  This parameter must have a value unless the skip_component  parameter
           is true.

       •   skip_component

           If true, then the test harness will not write a component to disk for this test.

   <b>add_test</b>
       Takes the following parameters:

       •   name (required)

           The name of this test.

       •   description (required)

           What this test is testing.

       •   component (required)

           Text of the component.

       •   path (optional)

           The  path  that this component should written to.  As with support components, this path is prepended
           with the group's name.  If no path is given, it uses call_path, if given, otherwise it uses the  name
           parameter.

       •   call_path (optional)

           The path that should be used to call the component.  If none is given, it will be /&lt;group name&gt;/&lt;test
           name&gt;.  If a value is given, it is still prepended by /&lt;group name&gt;<a href="file:/.">/.</a>

       •   call_args (optional)

           The  arguments  that  should  be  passed to the component, in list or hash reference form. If none is
           given, no arguments are passed.

       •   compiler_params

           This is a hash reference of parameters to be passed to the Compiler-&gt;new method.

       •   interp_params

           This is a hash reference of parameters to be passed to the Interp-&gt;new method.

       •   interp

           Provide an HTML::Mason::Interp object to be used for the test.

       •   todo

           If this is given, the test will be treated as a todo test, so it will  be  expected  to  fail.   This
           should be a string.

       One of the following three options is required:

       •   expect

           The  text  expected  as  a  result  of  calling the component.  This parameter is _not_ required when
           running in Create mode.

       •   expect_error

           A regex that will be matched against the error returned from the component execution.

       •   no_warnings

           If true, this means that the test expects to run without generating any warnings.   If  warnings  are
           generated, the test fails.

       •   expect_warnings

           A regex that will be matched against any warnings output when running the component.

       •   skip_expect

           This  causes  the component to be run but its output is ignored.  However, if the component execution
           causes an error this will cause the test to fail.  This is used in  a  few  situations  where  it  is
           necessary to just run a component as part the preparation for another test.

   <b>run</b>
       Run the tests in the group.

   <b>Class</b> <b>methods</b>
       These methods are provided since some tests may need to know these values.

   <b>base_path</b>
       The base path under which the component root and data directory for the tests are created.

   <b>comp_root</b>
       Returns the component root directory.

   <b>data_dir</b>
       Return the data directory

   <b>check_output</b> <b>(</b> <b>actual</b> <b>=&gt;</b> <b>$actual_output,</b> <b>expect</b> <b>=&gt;</b> <b>$expected_output</b> <b>)</b>
       Given  the  parameters  shown  above, this method will check to see if the two are equal.  If they're not
       equal, it will print out an error message attempting to highlight the difference.

</pre><h4><b>ADDITIONAL</b> <b>RUN</b> <b>MODES</b></h4><pre>
       The following additional modes are available for running tests.

   <b>Verbose</b> <b>mode</b>
       To turn this on, set the environment variables MASON_VERBOSE or MASON_DEBUG as true or run the  tests  as
       'make  test  TEST_VERBOSE=1'.  In this mode, the "run" method will output information about tests as they
       are run.  If a test fails, then it will also show the cause of the failure.

   <b>Debug</b> <b>mode</b>
       To turn this on, set the MASON_DEBUG environment variable to a true  value.   In  this  mode,  the  "run"
       method  will print detailed information of its actions.  This mode includes the output printed in VERBOSE
       mode.

   <b>No</b> <b>cleanup</b> <b>mode</b>
       Setting the MASON_NO_CLEANUP environment variable will tell the module to not  clean  up  generated  data
       from  running the tests.  This includes the components written to disk and the data directory used during
       testing.  This can be useful when debugging.

   <b>Create</b> <b>mode</b>
       If the individual tests are run from the command line with the '--create' flag, then instead of  checking
       the  output  of a component, the test harness will simply output its results.  This allows you to cut and
       paste these results back into the test file (assuming they are correct!).

   <b>Running</b> <b>and/or</b> <b>skipping</b> <b>selected</b> <b>tests</b>
       You can run just some of a test file with the '--tests-to-run' flag or the MASON_TESTS_TO_RUN environment
       variable.  Similarly  you  can  skip  specific   tests   with   the   '--tests-to-skip'   flag   or   the
       MASON_TESTS_TO_SKIP environment variable.

       The value of either flag is a comma-separated list of one or more of

          [test_file_name:](test_number|test_name|*)

       e.g.

           perl ./01-syntax.t --tests-to-run=3,5
           MASON_TESTS_TO_SKIP=fake_percent,empty_percents perl ./01-syntax.t
           MASON_TESTS_TO_RUN="misc:autohandler, request:*, interp:private1" make test

   <b>Subclassing</b> <b>this</b> <b>module</b>
       You can run tests with your own Tests.pm subclass using the '--tests-class' flag or the MASON_TESTS_CLASS
       environment  variable.   The value is a fully qualified package name that will be loaded before each test
       file is run.  e.g.

           perl ./01-syntax.t --tests-class=HTML::Mason::Tests::MyTests
           MASON_TESTS_CLASS=HTML::Mason::Tests::MyTests make test

       For example, if you have created your own lexer subclass and want to make sure that tests still pass with
       it, create a Tests subclass that overrides the _make_interp method to use your subclass:

           sub _make_interp
           {
               my ($self, %interp_params) = @_;

               return HTML::Mason::Interp-&gt;new
                   ( lexer_class =&gt; HTML::Mason::MyLexer,
                     %interp_params );
           }

perl v5.38.2                                       2024-03-05                            <u>HTML::Mason::<a href="../man3pm/Tests.3pm.html">Tests</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>