<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apache2::Connection - Perl API for Apache connection object</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libapache2-mod-perl2">libapache2-mod-perl2_2.0.13-2build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Apache2::Connection - Perl API for Apache connection object

</pre><h4><b>Synopsis</b></h4><pre>
         use Apache2::Connection ();
         use Apache2::RequestRec ();

         my $c = $r-&gt;connection;

         my $c = $r-&gt;connection;
         # is connection still open?
         $status = $c-&gt;aborted;

         # base server
         $base_server = $c-&gt;base_server();

         # needed for creating buckets/brigades
         $ba = $c-&gt;bucket_alloc();

         # client's socket
         $socket = $c-&gt;client_socket;

         # unique connection id
         $id = $c-&gt;id();

         # connection filters stack
         $input_filters = $c-&gt;input_filters();
         $output_filters = $c-&gt;output_filters();

         # keep the connection alive?
         $status = $c-&gt;keepalive();

         # how many requests served over the current connection
         $served = $c-&gt;keepalives();

         # this connection's local and remote socket addresses
         $local_sa  = $c-&gt;local_addr();
         $remote_sa = $c-&gt;remote_addr();

         # local and remote hostnames
         $local_host = $c-&gt;local_host();
         $remote_host = $c-&gt;get_remote_host();
         $remote_host = $c-&gt;remote_host();

         # server and remote client's IP addresses
         $local_ip = $c-&gt;local_ip();
         $remote_ip = $c-&gt;remote_ip();

         # connection level Apache notes
         $notes = $c-&gt;notes();

         # this connection's pool
         $p = $c-&gt;pool();

</pre><h4><b>Description</b></h4><pre>
       "Apache2::RequestRec" provides the Perl API for Apache connection record object.

</pre><h4><b>API</b></h4><pre>
       "Apache2::Connection" provides the following functions and/or methods:

   <b>"aborted"</b>
       Check whether the connection is still open

         $status = $c-&gt;aborted();

       obj: $c ( "Apache2::Connection object" )
       ret: $status ( boolean )
           true if the connection has been aborted, false if still open

       since: 2.0.00

   <b>"base_server"</b>
       Physical server this connection came in on (main server or vhost):

         $base_server = $c-&gt;base_server();

       obj: $c ( "Apache2::Connection object" )
       ret: $base_server ( "Apache2::Server object" )
       since: 2.0.00

   <b>"bucket_alloc"</b>
       The bucket allocator to use for all bucket/brigade creations

         $ba = $c-&gt;bucket_alloc();

       obj: $c ( "Apache2::Connection object" )
       ret: $ba ( "APR::BucketAlloc object" )
       since: 2.0.00

       This object is needed by "APR::Bucket" and "APR::Brigade" methods/functions.

   <b>"client_socket"</b>
       Get/set the client socket

         $socket      = $c-&gt;client_socket;
         $prev_socket = $c-&gt;client_socket($new_socket);

       obj: $c ( "Apache2::Connection object" )
       opt arg1: $new_socket ( "APR::Socket object" object )
           If passed a new socket will be set.

       ret: $socket ( "APR::Socket object" object )
           current client socket

           if the optional argument $new_socket was passed the previous socket object is returned.

       since: 2.0.00

   <b>"get_remote_host"</b>
       Lookup the client's DNS hostname or IP address

         $remote_host = $c-&gt;remote_host();
         $remote_host = $c-&gt;remote_host($type);
         $remote_host = $c-&gt;remote_host($type, $dir_config);

       obj: $c ( "Apache2::Connection object" )
           The current connection

       opt arg1: $type ( ":remotehost constant" )
           The type of lookup to perform:

           "Apache2::Const::REMOTE_DOUBLE_REV"
               will  always  force  a  DNS  lookup,  and  also  force a double reverse lookup, regardless of the
               "HostnameLookups" setting.  The result is the (double reverse checked) hostname, or undef if  any
               of the lookups fail.

           "Apache2::Const::REMOTE_HOST"
               returns  the  hostname,  or  "undef"  if  the  hostname lookup fails.  It will force a DNS lookup
               according to the "HostnameLookups" setting.

           "Apache2::Const::REMOTE_NAME"
               returns the hostname, or the dotted quad if the hostname lookup  fails.   It  will  force  a  DNS
               lookup according to the "HostnameLookups" setting.

           "Apache2::Const::REMOTE_NOLOOKUP"
               is like "Apache2::Const::REMOTE_NAME" except that a DNS lookup is never forced.

           Default value is "Apache2::Const::REMOTE_NAME".

       opt arg2: $dir_config ( "Apache2::ConfVector object" )
           The  directory  config  vector  from  the  request.  It's  needed  to find the container in which the
           directive "HostnameLookups" is set. To get one for the current request use "$r-&gt;per_dir_config".

           By default, "undef" is passed, in which case it's the same as if "HostnameLookups" was set to "Off".

       ret: $remote_host ( string/undef )
           The remote hostname.  If the configuration directive <b>HostNameLookups</b> is set to off, this returns  the
           dotted  decimal  representation  of  the  client's  IP  address  instead. Might return "undef" if the
           hostname is not known.

       since: 2.0.00

       The  result  of  "get_remote_host"  call  is  cached  in  "$c-&gt;remote_host".  If  the  latter   is   set,
       "get_remote_host" will return that value immediately, w/o doing any checkups.

   <b>"id"</b>
       ID of this connection; unique at any point in time

         $id = $c-&gt;id();

       obj: $c ( "Apache2::Connection object" )
       ret: $id (integer)
       since: 2.0.00

   <b>"input_filters"</b>
       Get/set the first filter in a linked list of protocol level input filters:

         $input_filters      = $c-&gt;input_filters();
         $prev_input_filters = $c-&gt;input_filters($new_input_filters);

       obj: $c ( "Apache2::Connection object" )
       opt arg1: $new_input_filters
           Set a new value

       ret: $input_filters ( "Apache2::Filter object" )
           The first filter in the connection input filters chain.

           If $new_input_filters was passed, returns the previous value.

       since: 2.0.00

       For an example see: Bucket Brigades-based Protocol Module

   <b>"keepalive"</b>
       This  method answers the question: Should the the connection be kept alive for another HTTP request after
       the current request is completed?

         $status = $c-&gt;keepalive();
         $status = $c-&gt;keepalive($new_status);

       obj: $c ( "Apache2::Connection object" )
       opt arg1: $new_status ( ":conn_keepalive constant" )
           Normally you should not mess with setting this option when handling the HTTP protocol. If you do (for
           example when  sending  your  own  headers  set  with  "$r-&gt;assbackwards")  --  take  a  look  at  the
           <b>ap_set_keepalive()</b> function in <u>httpd-2.0/modules/http/http_protocol.c</u>.

       ret: $status ( ":conn_keepalive constant" )
           The  method  does  <b>not</b>  return  true  or  false,  but one of the states which can be compared against
           (":conn_keepalive constants").

       since: 2.0.00

       Unless you set this value yourself when implementing non-HTTP protocols,  it's  only  relevant  for  HTTP
       requests.

       For example:

         use Apache2::RequestRec ();
         use Apache2::Connection ();

         use Apache2::Const -compile =&gt; qw(:conn_keepalive);
         ...
         my $c = $r-&gt;connection;
         if ($c-&gt;keepalive == Apache2::Const::CONN_KEEPALIVE) {
             # do something
         }
         elsif ($c-&gt;keepalive == Apache2::Const::CONN_CLOSE) {
             # do something else
         }
         elsif ($c-&gt;keepalive == Apache2::Const::CONN_UNKNOWN) {
             # do yet something else
         }
         else {
             # die "unknown state";
         }

       Notice  that  new  states  could be added later by Apache, so your code should make no assumptions and do
       things only if the desired state matches.

   <b>"keepalives"</b>
       How many requests were already served over the current connection.

         $served = $c-&gt;keepalives();
         $served = $c-&gt;keepalives($new_served);

       obj: $c ( "Apache2::Connection object" )
       opt arg1: $new_served (integer)
           Set the number of served requests over the current  connection.  Normally  you  won't  do  that  when
           handling HTTP requests. (But see below a note regarding "$r-&gt;assbackwards").

       ret: $served (integer)
           How many requests were already served over the current connection.

           In  most handlers, but HTTP output filter handlers, that value doesn't count the current request. For
           the latter it'll count the current request.

       since: 2.0.00

       This  method  is  only  relevant  for  keepalive  connections.  The   core   connection   output   filter
       "ap_http_header_filter"  increments this value when the response headers are sent and it decides that the
       connection should not be closed (see ap_set_keepalive()).

       If you send your own set of HTTP headers with "$r-&gt;assbackwards", which includes  the  "Keep-Alive"  HTTP
       response header, you must make sure to increment the "keepalives" counter.

   <b>"local_addr"</b>
       Get this connection's local socket address

         $local_sa = $c-&gt;local_addr();

       obj: $c ( "Apache2::Connection object" )
       ret: $local_sa ( "APR::SockAddr object" )
       since: 2.0.00

   <b>"local_host"</b>
       used for ap_get_server_name when UseCanonicalName is set to DNS (ignores setting of HostnameLookups)

         $local_host = $c-&gt;local_host();

       obj: $c ( "Apache2::Connection object" )
       ret: $local_host (string)
       since: 2.0.00

       META:  you  probably  shouldn't  use  this  method, but ( "get_server_name" ) if inside request and $r is
       available.

   <b>"local_ip"</b>
       server IP address

         $local_ip = $c-&gt;local_ip();

       obj: $c ( "Apache2::Connection object" )
       ret: $local_ip (string)
       since: 2.0.00

   <b>"notes"</b>
       Get/set text notes for the duration of this connection. These notes can be  passed  from  one  module  to
       another (not only mod_perl, but modules in any other language):

         $notes      = $c-&gt;notes();
         $prev_notes = $c-&gt;notes($new_notes);

       obj: $c ( "Apache2::Connection object" )
       opt arg1: $new_notes ( "APR::Table object" )
       ret: $notes ( "APR::Table object" )
           the current notes table.

           if the $new_notes argument was passed, returns the previous value.

       since: 2.0.00

       Also see "$r-&gt;notes"

   <b>"output_filters"</b>
       Get the first filter in a linked list of protocol level output filters:

         $output_filters = $c-&gt;output_filters();
         $prev_output_filters = $r-&gt;output_filters($new_output_filters);

       obj: $c ( "Apache2::Connection object" )
       opt arg1: $new_output_filters
           Set a new value

       ret: $output_filters ( "Apache2::Filter object" )
           The first filter in the connection output filters chain.

           If $new_output_filters was passed, returns the previous value.

       since: 2.0.00

       For an example see: Bucket Brigades-based Protocol Module

   <b>"pool"</b>
       Pool associated with this connection

         $p = $c-&gt;pool();

       obj: $c ( "Apache2::Connection object" )
       ret: $p ( "APR::Pool object" )
       since: 2.0.00

   <b>"remote_addr"</b>
       Get this connection's remote socket address

         $remote_sa = $c-&gt;remote_addr();

       obj: $c ( "Apache2::Connection object" )
       ret: $remote_sa ( "APR::SockAddr object" )
       since: 2.0.00

   <b>"remote_ip"</b>
       Client's IP address

         $remote_ip      = $c-&gt;remote_ip();
         $prev_remote_ip = $c-&gt;remote_ip($new_remote_ip);

       obj: $c ( "Apache2::Connection object" )
       opt arg1: $new_remote_ip ( string )
           If passed a new value will be set

       ret: $remote_ip ( string )
           current remote ip address

           if the optional argument $new_remote_ip was passed the previous value is returned.

       since: 2.0.00

   <b>"remote_host"</b>
       Client's DNS name:

         $remote_host = $c-&gt;remote_host();

       obj: $c ( "Apache2::Connection object" )
       ret: $remote_host ( string/undef )
           If  "$c-&gt;get_remote_host" was run it returns the cached value, which is a client DNS name or "" if it
           wasn't found. If the check wasn't run -- "undef" is returned.

       since: 2.0.00

       It's best to to call "$c-&gt;get_remote_host" instead of directly accessing this variable.

</pre><h4><b>Unsupported</b> <b>API</b></h4><pre>
       "Apache2::Connection" also provides auto-generated Perl interface for a few other  methods  which  aren't
       tested  at  the  moment  and  therefore their API is a subject to change. These methods will be finalized
       later as a need arises. If you want to rely on any of  the  following  methods  please  contact  the  the
       mod_perl  development mailing list so we can help each other take the steps necessary to shift the method
       to an officially supported API.

   <b>"conn_config"</b>
       Config vector containing pointers to connections per-server config structures

         $ret = $c-&gt;conn_config();

       obj: $c ( "Apache2::Connection object" )
       ret: $ret ( "Apache2::ConfVector object" )
       since: 2.0.00

   <b>"sbh"</b>
       META: Autogenerated - needs to be reviewed/completed

       handle to scoreboard information for this connection

         $sbh = $c-&gt;sbh();

       obj: $c ( "Apache2::Connection object" )
       ret: $sbh (XXX)
       since: 2.0.00

       META: Not sure how this can be used from mod_perl at the moment. Unless "Apache2::Scoreboard" is extended
       to provide a hook to read from this variable.

</pre><h4><b>See</b> <b>Also</b></h4><pre>
       mod_perl 2.0 documentation.

</pre><h4><b>Copyright</b></h4><pre>
       mod_perl 2.0 and its core modules are copyrighted under The Apache Software License, Version 2.0.

</pre><h4><b>Authors</b></h4><pre>
       The mod_perl development team and numerous contributors.

perl v5.40.0                                       2024-10-20              <u>libapache2-mod...he2::<a href="../man3pm/Connection.3pm.html">Connection</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>