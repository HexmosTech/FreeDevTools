<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feersum::Connection - HTTP connection encapsulation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/feersum">feersum_1.505-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Feersum::Connection - HTTP connection encapsulation

</pre><h4><b>SYNOPSIS</b></h4><pre>
       For a streaming response:

           Feersum-&gt;endjinn-&gt;request_handler(sub {
               my $req = shift; # this is a Feersum::Connection object
               my $env = $req-&gt;env();
               my $w = $req-&gt;start_streaming(200, ['Content-Type' =&gt; 'text/plain']);
               # then immediately or after some time:
               $w-&gt;write("Ergrates ");
               $w-&gt;write(\"FTW.");
               $w-&gt;close();
           });

       For a response with a Content-Length header:

           Feersum-&gt;endjinn-&gt;request_handler(sub {
               my $req = shift; # this is a Feersum::Connection object
               my $env = $req-&gt;env();
               $req-&gt;start_whole_response(200, ['Content-Type' =&gt; 'text/plain']);
               $req-&gt;write_whole_body(\"Ergrates FTW.");
           });

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Encapsulates an HTTP connection to Feersum.  It's roughly analogous to an "Apache::Request" or
       "Apache2::Connection" object, but differs significantly in functionality.

       Until Keep-Alive functionality is supported (if ever) this means that a connection is <b>also</b> a request.

       See Feersum for more examples on usage.

</pre><h4><b>METHODS</b></h4><pre>
       "my $env = $req-&gt;env()"
           Obtain  an  environment  hash.  This hash contains the same entries as for a PSGI handler environment
           hash.  See Feersum for details on the contents.

           This is a method instead of a parameter so that future versions of Feersum can request a slice of the
           hash for speed.

       "my $w = $req-&gt;start_streaming($code, \@headers)"
           A full HTTP header section is sent with "Transfer-Encoding:  chunked"  (or  "Connection:  close"  for
           HTTP/1.0 clients).

           Returns  a  "Feersum::Connection::Writer"  handle which should be used to complete the response.  See
           Feersum::Connection::Handle for methods.

       "$req-&gt;send_response($code, \@headers, $body)"
       "$req-&gt;send_response($code, \@headers, \@body)"
           Respond with a full HTTP header (including "Content-Length") and body.

           Returns the number of bytes calculated for the body.

       "$req-&gt;force_http10"
       "$req-&gt;force_http11"
           Force the response to use HTTP/1.0 or HTTP/1.1, respectively.

           Normally, if the request was made with 1.1 then Feersum uses HTTP/1.1  for  the  response,  otherwise
           HTTP/1.0 is used (this includes requests made with the HTTP "0.9" non-declaration).

           For  streaming  under  HTTP/1.1 "Transfer-Encoding: chunked" is used, otherwise a "Connection: close"
           stream-style is used (with the usual non-guarantees about delivery).   You  may  know  about  certain
           user-agents that support/don't-support T-E:chunked, so this is how you can override that.

           Supposedly  clients and a lot of proxies support the "Connection: close" stream-style, see support in
           Varnish at <a href="http://www.varnish-cache.org/trac/ticket/400">http://www.varnish-cache.org/trac/ticket/400</a>

       "$req-&gt;fileno"
           The socket file-descriptor number for this connection.

       "$req-&gt;response_guard($guard)"
           Register a guard to be triggered when the response is completely sent and the socket  is  closed.   A
           "guard"  in  this  context  is some object that will do something interesting in its DESTROY/DEMOLISH
           method. For example, Guard.

       "my $env = $req-&gt;method"
           req method (GET/POST..) (psgi REQUEST_METHOD)

       "my $env = $req-&gt;uri"
           full request uri (psgi REQUEST_URI)

       "my $env = $req-&gt;protocol"
           protocol (psgi SERVER_PROTOCOL)

       "my $env = $req-&gt;path"
           percent decoded request path (psgi PATH_INFO)

       "my $env = $req-&gt;query"
           request query (psgi QUERY_STRING)

       "my $env = $req-&gt;content_length"
           body content lenght (psgi CONTENT_LENGTH)

       "my $env = $req-&gt;input"
           input body handler (psgi.input), it is advised to close it after read is done

       "my $env = $req-&gt;headers([normalization_style])"
           an array of headers if form of [name, value, name, value, ...]

           normalization_style is one of:

           0 - skip normalization (default) HEADER_NORM_LOCASE - "content-type" HEADER_NORM_UPCASE  -  "CONTENT-
           TYPE"  HEADER_NORM_LOCASE_DASH  - "content_type" HEADER_NORM_UPCASE_DASH - "CONTENT_TYPE" (like PSGI,
           but without "HTTP_" prefix)

           One can export these constants via c&lt;&lt;use Feersum 'HEADER_NORM_LOCASE'&gt;&gt;

       "my $value = $req-&gt;header(name)"
           simple lookup for header value, name should be in lowercase, eg. 'content-type'

       "my $env = $req-&gt;remote_address"
           remote address (psgi REMOTE_ADDR)

       "my $env = $req-&gt;remote_port"
           remote port (psgi REMOTE_PORT)

</pre><h4><b>AUTHOR</b></h4><pre>
       Jeremy Stashewsky, "<a href="mailto:stash@cpan.org">stash@cpan.org</a>"

</pre><h4><b>COPYRIGHT</b> <b>AND</b> <b>LICENSE</b></h4><pre>
       Copyright (C) 2010 by Jeremy Stashewsky &amp; Socialtext Inc.

       This library is free software; you can redistribute it and/or modify it under  the  same  terms  as  Perl
       itself, either Perl version 5.8.7 or, at your option, any later version of Perl 5 you may have available.

perl v5.40.1                                       2025-04-13                           <u>Feersum::<a href="../man3pm/Connection.3pm.html">Connection</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>