<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tls_conn_version, tls_conn_cipher, tls_conn_cipher_strength, tls_conn_alpn_selected, tls_conn_servername,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtls-dev">libtls-dev_3.8.1-2.1build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tls_conn_version, tls_conn_cipher, tls_conn_cipher_strength, tls_conn_alpn_selected, tls_conn_servername,
       tls_conn_session_resumed,  tls_peer_cert_provided,  tls_peer_cert_contains_name, tls_peer_cert_chain_pem,
       tls_peer_cert_issuer,      tls_peer_cert_subject,      tls_peer_cert_hash,       tls_peer_cert_notbefore,
       tls_peer_cert_notafter â€” inspect an established TLS connection

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tls.h&gt;</b>

       <u>const</u> <u>char</u> <u>*</u>
       <b>tls_conn_version</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>const</u> <u>char</u> <u>*</u>
       <b>tls_conn_cipher</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>int</u>
       <b>tls_conn_cipher_strength</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>const</u> <u>char</u> <u>*</u>
       <b>tls_conn_alpn_selected</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>const</u> <u>char</u> <u>*</u>
       <b>tls_conn_servername</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>int</u>
       <b>tls_conn_session_resumed</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>int</u>
       <b>tls_peer_cert_provided</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>int</u>
       <b>tls_peer_cert_contains_name</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>, <u>const</u> <u>char</u> <u>*name</u>);

       <u>const</u> <u>uint8_t</u> <u>*</u>
       <b>tls_peer_cert_chain_pem</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>, <u>size_t</u> <u>*size</u>);

       <u>const</u> <u>char</u> <u>*</u>
       <b>tls_peer_cert_issuer</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>const</u> <u>char</u> <u>*</u>
       <b>tls_peer_cert_subject</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>const</u> <u>char</u> <u>*</u>
       <b>tls_peer_cert_hash</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>time_t</u>
       <b>tls_peer_cert_notbefore</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>time_t</u>
       <b>tls_peer_cert_notafter</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These  functions  return  information about a TLS connection and will only succeed after the handshake is
       complete (the connection information applies to both clients and servers, unless noted otherwise):

       <b>tls_conn_version</b>() returns a string corresponding to a TLS version negotiated with the peer connected  to
       <u>ctx</u>.

       <b>tls_conn_cipher</b>()  returns  a string corresponding to the cipher suite negotiated with the peer connected
       to <u>ctx</u>.

       <b>tls_conn_cipher_strength</b>() returns the strength in bits for the symmetric cipher that is being used  with
       the peer connected to <u>ctx</u>.

       <b>tls_conn_alpn_selected</b>() returns a string that specifies the ALPN protocol selected for use with the peer
       connected to <u>ctx</u>.  If no protocol was selected then NULL is returned.

       <b>tls_conn_servername</b>()  returns  a string corresponding to the servername that the client connected to <u>ctx</u>
       requested by sending a TLS Server Name Indication extension (server only).

       <b>tls_conn_session_resumed</b>() indicates whether a TLS session has been resumed during the handshake with the
       server connected to <u>ctx</u> (client only).

       <b>tls_peer_cert_provided</b>() checks if the peer of <u>ctx</u> has provided a certificate.

       <b>tls_peer_cert_contains_name</b>() checks if the peer of a TLS <u>ctx</u> has provided a certificate that contains  a
       SAN or CN that matches <u>name</u>.

       <b>tls_peer_cert_chain_pem</b>()  returns a pointer to memory containing a PEM-encoded certificate chain for the
       peer certificate from <u>ctx</u>.

       <b>tls_peer_cert_subject</b>() returns a string corresponding to the subject of the peer certificate from <u>ctx</u>.

       <b>tls_peer_cert_issuer</b>() returns a string corresponding to the issuer of the peer certificate from <u>ctx</u>.

       <b>tls_peer_cert_hash</b>() returns a string corresponding to a hash  of  the  raw  peer  certificate  from  <u>ctx</u>
       prefixed by a hash name followed by a colon.  The hash currently used is SHA256, though this could change
       in the future.  The hash string for a certificate in file <u>mycert.crt</u> can be generated using the commands:

             h=$(openssl x509 -outform der -in mycert.crt | sha256)
             printf "SHA256:${h}\n"

       <b>tls_peer_cert_notbefore</b>()  returns the time corresponding to the start of the validity period of the peer
       certificate from <u>ctx</u>.

       <b>tls_peer_cert_notafter</b>() returns the time corresponding to the end of the validity  period  of  the  peer
       certificate from <u>ctx</u>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The <b>tls_conn_session_resumed</b>() function returns 1 if a TLS session was resumed or 0 if it was not.

       The  <b>tls_peer_cert_provided</b>()  and <b>tls_peer_cert_contains_name</b>() functions return 1 if the check succeeds
       or 0 if it does not.

       <b>tls_peer_cert_notbefore</b>() and <b>tls_peer_cert_notafter</b>() return a time in epoch-seconds on success or -1 on
       error.

       The functions that return a pointer return NULL on error or an out of memory condition.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/tls_configure.3.html">tls_configure</a></u>(3), <u><a href="../man3/tls_handshake.3.html">tls_handshake</a></u>(3), <u><a href="../man3/tls_init.3.html">tls_init</a></u>(3), <u><a href="../man3/tls_ocsp_process_response.3.html">tls_ocsp_process_response</a></u>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>tls_conn_version</b>(),    <b>tls_conn_cipher</b>(),    <b>tls_peer_cert_provided</b>(),     <b>tls_peer_cert_contains_name</b>(),
       <b>tls_peer_cert_issuer</b>(),  <b>tls_peer_cert_subject</b>(),  <b>tls_peer_cert_hash</b>(),  <b>tls_peer_cert_notbefore</b>(),  and
       <b>tls_peer_cert_notafter</b>() appeared in OpenBSD 5.9.

       <b>tls_conn_servername</b>() and <b>tls_conn_alpn_selected</b>() appeared in OpenBSD 6.1.

       <b>tls_conn_session_resumed</b>() appeared in OpenBSD 6.3.

       <b>tls_conn_cipher_strength</b>() appeared in OpenBSD 6.7.

</pre><h4><b>AUTHORS</b></h4><pre>
       Bob Beck &lt;<u><a href="mailto:beck@openbsd.org">beck@openbsd.org</a></u>&gt;
       Joel Sing &lt;<u><a href="mailto:jsing@openbsd.org">jsing@openbsd.org</a></u>&gt;

Debian                                          November 2, 2019                             <u><a href="../man3/TLS_CONN_VERSION.3.html">TLS_CONN_VERSION</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>