<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ssh_connection -</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/erlang-manpages">erlang-manpages_24.2.1+dfsg-1ubuntu0.5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ssh_connection -
           This module provides API functions to send SSH Connection Protocol
           events to the other side of an SSH channel.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  SSH  Connection  Protocol is used by clients and servers, that is, SSH channels, to communicate over
       the SSH connection. The API functions in this module send  SSH  Connection  Protocol  events,  which  are
       received  as  messages  by  the  remote  channel handling the remote channel. The Erlang format of thoose
       messages is (see also below):

       <u>{ssh_cm,</u> ssh:connection_ref()<u>,</u> <u>channel_msg()}</u>

       If the ssh_client_channel behavior is used to implement the channel process, these messages  are  handled
       by handle_ssh_msg/2.

</pre><h4><b>DATA</b> <b>TYPES</b></h4><pre>
       <b>ssh_data_type_code()</b> = integer() &gt;= 0

              The valid values are <u>0</u> ("normal") and <u>1</u> ("stderr"), see RFC 4254, Section 5.2.

       <b>result()</b> = req_status() | {error, reason()}

       <b>reason()</b> = closed | timeout

              The result of a call.

              If  the  request  reached  the  peer, was handled and the response reached the requesting node the
              req_status() is the status reported from the peer.

              If not, the reason() indicates what went wrong:

                <u>closed</u>:
                  indicates that the channel or connection was closed when trying to send the request

                <u>timeout</u>:
                  indicates that the operation exceeded a time limit

       <b>req_status()</b> = success | failure

              The status of a request. Coresponds to  the  <u>SSH_MSG_CHANNEL_SUCCESS</u>  and  <u>SSH_MSG_CHANNEL_FAILURE</u>
              values in RFC 4254, Section 5.4.

   <b>SSH</b> <b>Connection</b> <b>Protocol:</b> <b>General</b>
       <b>event()</b> = {ssh_cm, ssh:connection_ref(), channel_msg()}

       <b>channel_msg()</b> =
           data_ch_msg() |
           eof_ch_msg() |
           closed_ch_msg() |
           pty_ch_msg() |
           env_ch_msg() |
           shell_ch_msg() |
           exec_ch_msg() |
           signal_ch_msg() |
           window_change_ch_msg() |
           exit_status_ch_msg() |
           exit_signal_ch_msg()

              As mentioned in the introduction, the SSH Connection Protocol events are handled as messages. When
              writing  a  channel  handling process without using the support by the ssh_client_channel behavior
              the process must handle thoose messages.

       <b>want_reply()</b> = boolean()

              Messages  that   include   a   <u>WantReply</u>   expect   the   channel   handling   process   to   call
              ssh_connection:reply_request/4 with the boolean value of <u>WantReply</u> as the second argument.

   <b>Data</b> <b>Transfer</b> <b>(RFC</b> <b>4254,</b> <b>section</b> <b>5.2)</b>
       <b>data_ch_msg()</b> =
           {data,
            ssh:channel_id(),
            ssh_data_type_code(),
            Data :: binary()}

              Data   has   arrived   on   the   channel.   This   event   is   sent   as  a  result  of  calling
              ssh_connection:send/[3,4,5].

   <b>Closing</b> <b>a</b> <b>Channel</b> <b>(RFC</b> <b>4254,</b> <b>section</b> <b>5.3)</b>
       <b>eof_ch_msg()</b> = {eof, ssh:channel_id()}

              Indicates that the other side sends no more data. This event  is  sent  as  a  result  of  calling
              ssh_connection:send_eof/2.

       <b>closed_ch_msg()</b> = {closed, ssh:channel_id()}

              This  event is sent as a result of calling ssh_connection:close/2. Both the handling of this event
              and sending it are taken care of by the ssh_client_channel behavior.

   <b>Requesting</b> <b>a</b> <b>Pseudo-Terminal</b> <b>(RFC</b> <b>4254,</b> <b>section</b> <b>6.2)</b>
       <b>pty_ch_msg()</b> =
           {pty,
            ssh:channel_id(),
            want_reply(),
            {Terminal :: string(),
             CharWidth :: integer() &gt;= 0,
             RowHeight :: integer() &gt;= 0,
             PixelWidth :: integer() &gt;= 0,
             PixelHeight :: integer() &gt;= 0,
             TerminalModes :: [term_mode()]}}

       <b>term_mode()</b> =
           {Opcode :: atom() | byte(), Value :: integer() &gt;= 0}

              A pseudo-terminal has been  requested  for  the  session.  <u>Terminal</u>  is  the  value  of  the  TERM
              environment  variable  value,  that  is,  <u>vt100</u>.  Zero  dimension  parameters must be ignored. The
              character/row dimensions override the pixel dimensions (when non-zero). Pixel dimensions refer  to
              the  drawable  area  of  the  window.  <u>Opcode</u>  in  the  <u>TerminalModes</u>  list  is the mnemonic name,
              represented as a lowercase Erlang atom, defined in RFC 4254, Section 8. It can also be  an  <u>Opcode</u>
              if  the  mnemonic  name  is not listed in the RFC. Example: <u>OP</u> <u>code:</u> <u>53,</u> <u>mnemonic</u> <u>name</u> <u>ECHO</u> <u>erlang</u>
              <u>atom:</u> <u>echo</u>. This event is sent as a result of calling ssh_connection:ptty_alloc/4.

   <b>Environment</b> <b>Variable</b> <b>Passing</b> <b>(RFC</b> <b>4254,</b> <b>section</b> <b>6.4)</b>
       <b>env_ch_msg()</b> =
           {env,
            ssh:channel_id(),
            want_reply(),
            Var :: string(),
            Value :: string()}

              Environment variables can be passed to the shell/command to be started later. This event  is  sent
              as a result of calling  ssh_connection:setenv/5.

   <b>Starting</b> <b>a</b> <b>Shell</b> <b>or</b> <b>Command</b> <b>(RFC</b> <b>4254,</b> <b>section</b> <b>6.5)</b>
       <b>shell_ch_msg()</b> = {shell, ssh:channel_id(), want_reply()}

              This  message requests that the user default shell is started at the other end. This event is sent
              as a result of calling  ssh_connection:shell/2.

       <b>exec_ch_msg()</b> =
           {exec, ssh:channel_id(), want_reply(), Command :: string()}

              This message requests that the server starts execution of the given command. This event is sent as
              a result of calling ssh_connection:exec/4 .

   <b>Window</b> <b>Dimension</b> <b>Change</b> <b>Message</b> <b>(RFC</b> <b>4254,</b> <b>section</b> <b>6.7)</b>
       <b>window_change_ch_msg()</b> =
           {window_change,
            ssh:channel_id(),
            CharWidth :: integer() &gt;= 0,
            RowHeight :: integer() &gt;= 0,
            PixelWidth :: integer() &gt;= 0,
            PixelHeight :: integer() &gt;= 0}

              When the window (terminal) size changes on the client side, it <u>can</u> send a message  to  the  server
              side to inform it of the new dimensions. No API function generates this event.

   <b>Signals</b> <b>(RFC</b> <b>4254,</b> <b>section</b> <b>6.9)</b>
       <b>signal_ch_msg()</b> =
           {signal, ssh:channel_id(), SignalName :: string()}

              A  signal can be delivered to the remote process/service using the following message. Some systems
              do not support signals, in which case they are to ignore  this  message.  There  is  currently  no
              function  to  generate  this  event  as  the signals referred to are on OS-level and not something
              generated by an Erlang program.

   <b>Returning</b> <b>Exit</b> <b>Status</b> <b>(RFC</b> <b>4254,</b> <b>section</b> <b>6.10)</b>
       <b>exit_status_ch_msg()</b> =
           {exit_status,
            ssh:channel_id(),
            ExitStatus :: integer() &gt;= 0}

              When the command running at the other end terminates, the following message can be sent to  return
              the  exit  status  of  the  command.  A zero <u>exit_status</u> usually means that the command terminated
              successfully. This event is sent as a result of calling  ssh_connection:exit_status/3.

       <b>exit_signal_ch_msg()</b> =
           {exit_signal,
            ssh:channel_id(),
            ExitSignal :: string(),
            ErrorMsg :: string(),
            LanguageString :: string()}

              A remote execution can terminate violently because of a signal. Then this message can be received.
              For details on valid string values, see RFC 4254 Section 6.10, which shows a special case of these
              signals.

</pre><h4><b>EXPORTS</b></h4><pre>
       <b>adjust_window(ConnectionRef,</b> <b>ChannelId,</b> <b>NumOfBytes)</b> <b>-&gt;</b> <b>ok</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()
                 NumOfBytes = integer()

              Adjusts the SSH flow control window. This is to be  done  by  both  the  client-  and  server-side
              channel processes.

          <b>Note:</b>
              Channels  implemented  with  the   ssh_client_channel  behavior  do not normally need to call this
              function as flow control is handled by the behavior. The behavior adjusts the  window  every  time
              the callback  handle_ssh_msg/2 returns after processing channel data.

       <b>close(ConnectionRef,</b> <b>ChannelId)</b> <b>-&gt;</b> <b>ok</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()

              A server- or client-channel process can choose to close their session by sending a close event.

          <b>Note:</b>
              This  function  is  called  by the <u>ssh_client_channel</u> behavior when the channel is terminated, see
              <a href="../man3erl/ssh_client_channel.3erl.html">ssh_client_channel</a>(3erl). Thus, channels implemented with  the  behavior  are  not  to  call  this
              function explicitly.

       <b>exec(ConnectionRef,</b> <b>ChannelId,</b> <b>Command,</b> <b>Timeout)</b> <b>-&gt;</b> <b>result()</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()
                 Command = string()
                 Timeout = timeout()

              Is  to be called by a client-channel process to request that the server starts executing the given
              command. The result is several messages according to the following pattern. The last message is  a
              channel close message, as the <u>exec</u> request is a one-time execution that closes the channel when it
              is done.

                <b>N</b> <b>x</b> <b>data</b> <b>message(s):</b>
                  The  result  of  executing the command can be only one line or thousands of lines depending on
                  the command.

                <b>0</b> <b>or</b> <b>1</b> <b>x</b> <b>eof</b> <b>message:</b>
                  Indicates that no more data is to be sent.

                <b>0</b> <b>or</b> <b>1</b> <b>x</b> <b>exit</b> <b>signal</b> <b>message:</b>
                  Not all systems send signals. For details on valid string values, see RFC 4254, Section 6.10

                <b>0</b> <b>or</b> <b>1</b> <b>x</b> <b>exit</b> <b>status</b> <b>message:</b>
                  It is recommended by the SSH Connection Protocol to send this message, but that is not  always
                  the case.

                <b>1</b> <b>x</b> <b>closed</b> <b>status</b> <b>message:</b>
                  Indicates  that  the  <u>ssh_client_channel</u> started for the execution of the command has now been
                  shut down.

              See the User's Guide section on One-Time Execution for examples.

       <b>exit_status(ConnectionRef,</b> <b>ChannelId,</b> <b>Status)</b> <b>-&gt;</b> <b>ok</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()
                 Status = integer()

              Is to be called by a server-channel process to send the exit status of a command to the client.

       <b>ptty_alloc(ConnectionRef,</b> <b>ChannelId,</b> <b>Options)</b> <b>-&gt;</b> <b>result()</b>

       <b>ptty_alloc(ConnectionRef,</b> <b>ChannelId,</b> <b>Options,</b> <b>Timeout)</b> <b>-&gt;</b> <b>result()</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()
                 Options = proplists:proplist()
                 Timeout = timeout()

              Sends an SSH Connection Protocol <u>pty_req</u>, to allocate a pseudo-terminal. Is to be called by an SSH
              client process.

              Options:

                <b>{term,</b> <b>string()}:</b>
                  Defaults to <u>os:getenv("TERM")</u> or <u>vt100</u> if it is undefined.

                <b>{width,</b> <b>integer()}:</b>
                  Defaults to 80 if <u>pixel_width</u> is not defined.

                <b>{height,</b> <b>integer()}:</b>
                  Defaults to 24 if <u>pixel_height</u> is not defined.

                <b>{pixel_width,</b> <b>integer()}:</b>
                  Is disregarded if <u>width</u> is defined.

                <b>{pixel_height,</b> <b>integer()}:</b>
                  Is disregarded if <u>height</u> is defined.

                <b>{pty_opts,</b> <b>[{posix_atom(),</b> <b>integer()}]}:</b>
                  Option can be an empty list. Otherwise, see possible <u>POSIX</u> names in Section 8 in  RFC 4254.

       <b>reply_request(ConnectionRef,</b> <b>WantReply,</b> <b>Status,</b> <b>ChannelId)</b> <b>-&gt;</b> <b>ok</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 WantReply = boolean()
                 Status = req_status()
                 ChannelId = ssh:channel_id()

              Sends status replies to requests where the requester has stated that it  wants  a  status  report,
              that is, <u>WantReply</u> <u>=</u> <u>true</u>. If <u>WantReply</u> is <u>false</u>, calling this function becomes a "noop". Is to be
              called while handling an SSH Connection Protocol message containing a <u>WantReply</u> boolean value.

       <b>send(ConnectionRef,</b> <b>ChannelId,</b> <b>Data)</b> <b>-&gt;</b>
       <b>send(ConnectionRef,</b> <b>ChannelId,</b> <b>Data,</b> <b>Timeout)</b> <b>-&gt;</b>
       <b>send(ConnectionRef,</b> <b>ChannelId,</b> <b>Type,</b> <b>Data)</b> <b>-&gt;</b>
       <b>send(ConnectionRef,</b> <b>ChannelId,</b> <b>Type,</b> <b>Data,</b> <b>TimeOut)</b> <b>-&gt;</b> <b>ok</b> <b>|</b> <b>Error</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()
                 Data = iodata()
                 Type = ssh_data_type_code()
                 Timeout = timeout()
                 Error = {error, reason()}

              Is to be called by client- and server-channel processes to send data to each other.

              The function subsystem/4 and subsequent calls of <u>send/3,4,5</u> must be executed in the same process.

       <b>send_eof(ConnectionRef,</b> <b>ChannelId)</b> <b>-&gt;</b> <b>ok</b> <b>|</b> <b>{error,</b> <b>closed}</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()

              Sends EOF on channel <u>ChannelId</u>.

       <b>session_channel(ConnectionRef,</b> <b>Timeout)</b> <b>-&gt;</b> <b>Result</b>

       <b>session_channel(ConnectionRef,</b> <b>InitialWindowSize,</b> <b>MaxPacketSize,</b>
                       Timeout) -&gt;
                          Result

              Types:

                 ConnectionRef = ssh:connection_ref()
                 InitialWindowSize = MaxPacketSize = integer() &gt;= 1 | undefined
                 Timeout = timeout()
                 Result = {ok, ssh:channel_id()} | {error, reason()}

              Opens  a  channel for an SSH session. The channel id returned from this function is the id used as
              input to the other functions in this module.

       <b>setenv(ConnectionRef,</b> <b>ChannelId,</b> <b>Var,</b> <b>Value,</b> <b>Timeout)</b> <b>-&gt;</b> <b>success</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()
                 Var = Value = string()
                 Timeout = timeout()

              Environment variables can be passed before starting the shell/command. Is to be called by a client
              channel processes.

       <b>shell(ConnectionRef,</b> <b>ChannelId)</b> <b>-&gt;</b> <b>Result</b>

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()
                 Result = ok | success | failure | {error, timeout}

              Is to be called by a client channel process to request that  the  user  default  shell  (typically
              defined in <a href="file:/etc/passwd">/etc/passwd</a> in Unix systems) is executed at the server end.

              Note:  the return value is <u>ok</u> instead of <u>success</u> unlike in other functions in this module. This is
              a fault that was introduced so long ago that any change would break a  large  number  of  existing
              software.

       <b>subsystem(ConnectionRef,</b> <b>ChannelId,</b> <b>Subsystem,</b> <b>Timeout)</b> <b>-&gt;</b>
                    result()

              Types:

                 ConnectionRef = ssh:connection_ref()
                 ChannelId = ssh:channel_id()
                 Subsystem = string()
                 Timeout = timeout()

              Is  to  be  called by a client-channel process for requesting to execute a predefined subsystem on
              the server.

              The function <u>subsystem/4</u> and subsequent calls of send/3,4,5 must be executed in the same process.

Ericsson AB                                         ssh 4.13                                <u><a href="../man3erl/ssh_connection.3erl.html">ssh_connection</a></u>(3erl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>