<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mongoc_read_prefs_t  provides an abstraction on top of the MongoDB connection read preferences. It allows</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmongoc-doc">libmongoc-doc_1.30.4-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>SYNOPSIS</b></h4><pre>
       <u>mongoc_read_prefs_t</u>  provides an abstraction on top of the MongoDB connection read preferences. It allows
       for hinting to the driver which nodes in a replica set should be accessed first and how.

       You can specify a read preference mode on connection objects, database objects,  collection  objects,  or
       per-operation.    Generally,   it   makes  the  most  sense  to  stick  with  the  global  default  mode,
       <b>MONGOC_READ_PRIMARY</b>.  All of the other modes come with caveats that won't  be  covered  in  great  detail
       here.

</pre><h4><b>READ</b> <b>MODES</b></h4><pre>
                     ┌─────────────────────────────────┬───────────────────────────────────────┐
                     │ MONGOC_READ_PRIMARY             │ Default  mode.  All  operations  read │
                     │                                 │ from the current replica set primary. │
                     ├─────────────────────────────────┼───────────────────────────────────────┤
                     │ MONGOC_READ_SECONDARY           │ All operations read  from  among  the │
                     │                                 │ nearest   secondary  members  of  the │
                     │                                 │ replica set.                          │
                     ├─────────────────────────────────┼───────────────────────────────────────┤
                     │ MONGOC_READ_PRIMARY_PREFERRED   │ In most situations,  operations  read │
                     │                                 │ from   the   primary  but  if  it  is │
                     │                                 │ unavailable,  operations  read   from │
                     │                                 │ secondary members.                    │
                     ├─────────────────────────────────┼───────────────────────────────────────┤
                     │ MONGOC_READ_SECONDARY_PREFERRED │ In  most  situations, operations read │
                     │                                 │ from  among  the  nearest   secondary │
                     │                                 │ members,  but  if  no secondaries are │
                     │                                 │ available, operations read  from  the │
                     │                                 │ primary.                              │
                     ├─────────────────────────────────┼───────────────────────────────────────┤
                     │ MONGOC_READ_NEAREST             │ Operations   read   from   among  the │
                     │                                 │ nearest members of the  replica  set, │
                     │                                 │ irrespective of the member's type.    │
                     └─────────────────────────────────┴───────────────────────────────────────┘

</pre><h4><b>TAG</b> <b>SETS</b></h4><pre>
       Tag  sets  allow  you  to specify custom read preferences and write concerns so that your application can
       target operations to specific members.

       Custom read preferences and write concerns  evaluate  tags  sets  in  different  ways:  read  preferences
       consider  the  value of a tag when selecting a member to read from, while write concerns ignore the value
       of a tag when selecting a member, except to consider whether or not the value is unique.

       You can specify tag sets with the following read preference modes:

       • primaryPreferred

       • secondary

       • secondaryPreferred

       • nearest

       Tags are not compatible with <b>MONGOC_READ_PRIMARY</b> and, in general, only apply when selecting  a  secondary
       member  of a set for a read operation. However, the nearest read mode, when combined with a tag set, will
       select the nearest member that matches the specified tag set, which may be a primary or secondary.

       Tag sets are represented as a comma-separated list of colon-separated key-value pairs when provided as  a
       connection string, e.g. <u>dc:ny,rack:1</u>.

       To specify a list of tag sets, using multiple readPreferenceTags, e.g.

          readPreferenceTags=dc:ny,rack:1;readPreferenceTags=dc:ny;readPreferenceTags=

       Note the empty value for the last one, which means "match any secondary as a last resort".

       Order matters when using multiple readPreferenceTags.

       Tag Sets can also be configured using <u>mongoc_read_prefs_set_tags()</u>.

       All  interfaces  use  the  same  member  selection  logic  to  choose  the member to which to direct read
       operations, basing the choice on read preference mode and tag sets.

</pre><h4><b>MAX</b> <b>STALENESS</b></h4><pre>
       When connected to replica set running MongoDB 3.4 or later, the driver estimates the  staleness  of  each
       secondary based on lastWriteDate values provided in server hello responses.

       Max Staleness is the maximum replication lag in seconds (wall clock time) that a secondary can suffer and
       still  be  eligible  for  reads. The default is <b>MONGOC_NO_MAX_STALENESS</b>, which disables staleness checks.
       Otherwise, it must be a positive integer at least <b>MONGOC_SMALLEST_MAX_STALENESS_SECONDS</b> (90 seconds).

       Max Staleness is also supported by sharded clusters of replica sets if all servers  run  MongoDB  3.4  or
       later.

</pre><h4><b>HEDGED</b> <b>READS</b></h4><pre>
       When  connecting  to a sharded cluster running MongoDB 4.4 or later, reads can be sent in parallel to the
       two "best" hosts.  Once one result returns, any other outstanding operations that were part of the hedged
       read are cancelled.

       When the read preference mode is <b>MONGOC_READ_NEAREST</b> and the sharded cluster is running  MongoDB  4.4  or
       later,  hedged  reads  are  enabled  by default.  Additionally, hedged reads may be explicitly enabled or
       disabled by calling <u>mongoc_read_prefs_set_hedge()</u> with a BSON document, e.g.

          {
             enabled: true
          }

       Appropriate values for the <b>enabled</b> key are <b>true</b> or <b>false</b>.

</pre><h4><b>AUTHOR</b></h4><pre>
       MongoDB, Inc

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2009-present, MongoDB, Inc.

1.30.4                                            Jun 08, 2025                            <u><a href="../man3/MONGOC_READ_PREFS_T.3.html">MONGOC_READ_PREFS_T</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>