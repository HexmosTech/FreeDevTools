<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSHttpConnectPlugin  -  allows  the  plugin  to initiate an http connection. This will tag the HTTP state</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/trafficserver-dev">trafficserver-dev_9.2.5+ds-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       TSHttpConnectPlugin  -  allows  the  plugin  to initiate an http connection. This will tag the HTTP state
       machine with extra data that can be accessed by  the  logging  interface.  Additional  arguments  provide
       buffer  settings  that  are  used  when  constructing  IOBuffers.  The  connection  is treated as an HTTP
       transaction as if it came from a client

</pre><h4><b>SYNOPSIS</b></h4><pre>
          #include &lt;ts/ts.h&gt;

       <u>TSVConn</u> <b>TSHttpConnectPlugin(</b><u>TSHttpConnectOptions</u> <b>*options);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This call attempts to create an HTTP state machine and a virtual connection to that state  machine.  This
       is  more  efficient  than using <u>TSNetConnect()</u> because it avoids using the operating system stack via the
       loopback interface.

       <u>options</u>
              A <u>TSHttpConnectOptions</u> structure that contains fields that provide  the  network  address  of  the
              target,  a  tag  that can be passed through to the HTTP state machine, a plugin ID, a buffer index
              and buffer water mark.

       The virtual connection returned as the <u>TSVConn</u> is API equivalent to a network virtual connection both  to
       the  plugin  and  to  internal  mechanisms. Data is read and written to the connection (and thence to the
       target system) by reading and writing on this virtual connection.

       <b>NOTE:</b>
          This function only opens the connection. To drive the transaction an actual HTTP request must be  sent
          and  the  HTTP  response handled. The transaction is handled as a standard HTTP transaction and all of
          the standard configuration options and plugins will operate on it.

       The combination of <u>tag</u> and <u>id</u> is  intended  to  enable  correlation  in  log  post  processing.  The  <u>tag</u>
       identifies  the  connection  as  related  to the plugin and the <u>id</u> can be used in conjunction with plugin
       generated logs to correlate the log records.

</pre><h4><b>NOTES</b></h4><pre>
       The H2 implementation uses this to correlate client sessions with H2 streams. Each client  connection  is
       assigned  a  distinct numeric identifier. This is passed in the options structure via the member variable
       <u>id</u> to the <u>TSHttpConnectPlugin()</u> function.  The <u>tag</u> is selected to  be  the  NPN  string  for  the  client
       session protocol, e.g. "h2". Log post processing can then count the number of connections for the various
       supported  protocols  and  the  number  of  H2 virtual streams for each real client connection to Traffic
       Server.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3ts/TSHttpConnectWithPluginId.3ts.html">TSHttpConnectWithPluginId</a>(3ts)</b>, <b><a href="../man3ts/TSHttpConnect.3ts.html">TSHttpConnect</a>(3ts)</b>, <b><a href="../man3ts/TSNetConnect.3ts.html">TSNetConnect</a>(3ts)</b>, <b><a href="../man3ts/TSAPI.3ts.html">TSAPI</a>(3ts)</b>

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2025, <a href="mailto:dev@trafficserver.apache.org">dev@trafficserver.apache.org</a>

9.2                                               May 22, 2025                          <u><a href="../man3ts/TSHTTPCONNECTPLUGIN.3ts.html">TSHTTPCONNECTPLUGIN</a></u>(3ts)
</pre>
 </div>
</div></section>
</div>
</body>
</html>