<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tls_ocsp_process_response,  tls_peer_ocsp_url,  tls_peer_ocsp_response_status, tls_peer_ocsp_cert_status,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libtls-dev">libtls-dev_3.8.1-2.1build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tls_ocsp_process_response,  tls_peer_ocsp_url,  tls_peer_ocsp_response_status, tls_peer_ocsp_cert_status,
       tls_peer_ocsp_crl_reason, tls_peer_ocsp_result, tls_peer_ocsp_revocation_time, tls_peer_ocsp_this_update,
       tls_peer_ocsp_next_update â€” inspect an OCSP response

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tls.h&gt;</b>

       <u>int</u>
       <b>tls_ocsp_process_response</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>, <u>const</u> <u>unsigned</u> <u>char</u> <u>*response</u>, <u>size_t</u> <u>size</u>);

       <u>const</u> <u>char</u> <u>*</u>
       <b>tls_peer_ocsp_url</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>int</u>
       <b>tls_peer_ocsp_response_status</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>int</u>
       <b>tls_peer_ocsp_cert_status</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>int</u>
       <b>tls_peer_ocsp_crl_reason</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>const</u> <u>char</u> <u>*</u>
       <b>tls_peer_ocsp_result</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>time_t</u>
       <b>tls_peer_ocsp_revocation_time</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>time_t</u>
       <b>tls_peer_ocsp_this_update</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

       <u>time_t</u>
       <b>tls_peer_ocsp_next_update</b>(<u>struct</u> <u>tls</u> <u>*ctx</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>tls_ocsp_process_response</b>() processes a raw  OCSP  response  in  <u>response</u>  of  size  <u>size</u>  to  check  the
       revocation  status  of  the  peer certificate from <u>ctx</u>.  A successful return code of 0 indicates that the
       certificate has not been revoked.

       <b>tls_peer_ocsp_url</b>() returns the URL for OCSP validation of the peer certificate from <u>ctx</u>.

       The following functions return information about the peer certificate  from  <u>ctx</u>  that  was  obtained  by
       validating   a   stapled   OCSP   response   during   the   handshake,   or   via   a  previous  call  to
       <b>tls_ocsp_process_response</b>().

       <b>tls_peer_ocsp_response_status</b>() returns the OCSP response status as per RFC 6960 section 2.3.

       <b>tls_peer_ocsp_cert_status</b>() returns the OCSP certificate status code as per RFC 6960 section 2.2.

       <b>tls_peer_ocsp_crl_reason</b>() returns the OCSP certificate revocation reason status code  as  per  RFC  5280
       section 5.3.1.

       <b>tls_peer_ocsp_result</b>()  returns  a  textual representation of the OCSP status code returned by one of the
       previous three functions.  If the OCSP response was valid and the certificate was not revoked, the string
       indicates the OCSP certificate status.  Otherwise, the string indicates the OCSP  certificate  revocation
       reason or the OCSP error.

       <b>tls_peer_ocsp_revocation_time</b>() returns the OCSP revocation time.

       <b>tls_peer_ocsp_this_update</b>() returns the OCSP this update time.

       <b>tls_peer_ocsp_next_update</b>() returns the OCSP next update time.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>tls_ocsp_process_response</b>() returns 0 on success or -1 on error.

       <b>tls_peer_ocsp_url</b>() and <b>tls_peer_ocsp_result</b>() return NULL on error or an out of memory condition.

       The    <b>tls_peer_ocsp_response_status</b>()    function    returns    one   of   TLS_OCSP_RESPONSE_SUCCESSFUL,
       TLS_OCSP_RESPONSE_MALFORMED,         TLS_OCSP_RESPONSE_INTERNALERROR,         TLS_OCSP_RESPONSE_TRYLATER,
       TLS_OCSP_RESPONSE_SIGREQUIRED, or TLS_OCSP_RESPONSE_UNAUTHORIZED on success or -1 on error.

       The  <b>tls_peer_ocsp_cert_status</b>()  function  returns  one of TLS_OCSP_CERT_GOOD, TLS_OCSP_CERT_REVOKED, or
       TLS_OCSP_CERT_UNKNOWN on success, and -1 on error.

       The    <b>tls_peer_ocsp_crl_reason</b>()     function     returns     one     of     TLS_CRL_REASON_UNSPECIFIED,
       TLS_CRL_REASON_KEY_COMPROMISE,      TLS_CRL_REASON_CA_COMPROMISE,     TLS_CRL_REASON_AFFILIATION_CHANGED,
       TLS_CRL_REASON_SUPERSEDED,    TLS_CRL_REASON_CESSATION_OF_OPERATION,     TLS_CRL_REASON_CERTIFICATE_HOLD,
       TLS_CRL_REASON_REMOVE_FROM_CRL,  TLS_CRL_REASON_PRIVILEGE_WITHDRAWN,  or  TLS_CRL_REASON_AA_COMPROMISE on
       success or -1 on error.

       <b>tls_peer_ocsp_revocation_time</b>(), <b>tls_peer_ocsp_this_update</b>(), and  <b>tls_peer_ocsp_next_update</b>()  return  a
       time in epoch-seconds on success or -1 on error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/tls_client.3.html">tls_client</a></u>(3),       <u><a href="../man3/tls_config_ocsp_require_stapling.3.html">tls_config_ocsp_require_stapling</a></u>(3),       <u><a href="../man3/tls_conn_version.3.html">tls_conn_version</a></u>(3),      <u><a href="../man3/tls_connect.3.html">tls_connect</a></u>(3),
       <u><a href="../man3/tls_handshake.3.html">tls_handshake</a></u>(3), <u><a href="../man3/tls_init.3.html">tls_init</a></u>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       These functions appeared in OpenBSD 6.1.

</pre><h4><b>AUTHORS</b></h4><pre>
       Bob Beck &lt;<u><a href="mailto:beck@openbsd.org">beck@openbsd.org</a></u>&gt;
       Marko Kreen &lt;<u><a href="mailto:markokr@gmail.com">markokr@gmail.com</a></u>&gt;

Debian                                            July 24, 2018                     <u><a href="../man3/TLS_OCSP_PROCESS_RESPONSE.3.html">TLS_OCSP_PROCESS_RESPONSE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>