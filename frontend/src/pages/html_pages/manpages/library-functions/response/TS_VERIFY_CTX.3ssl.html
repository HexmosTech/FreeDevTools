<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TS_VERIFY_CTX, TS_VERIFY_CTX_new, TS_VERIFY_CTX_init, TS_VERIFY_CTX_free, TS_VERIFY_CTX_cleanup,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       TS_VERIFY_CTX, TS_VERIFY_CTX_new, TS_VERIFY_CTX_init, TS_VERIFY_CTX_free, TS_VERIFY_CTX_cleanup,
       TS_VERIFY_CTX_set_flags, TS_VERIFY_CTX_add_flags, TS_VERIFY_CTX_set0_data, TS_VERIFY_CTX_set0_imprint,
       TS_VERIFY_CTX_set0_store, TS_VERIFY_CTX_set0_certs, TS_VERIFY_CTX_set_certs, TS_VERIFY_CTS_set_certs,
       TS_VERIFY_CTX_set_data, TS_VERIFY_CTX_set_imprint, TS_VERIFY_CTX_set_store - manage the TS response
       verification context

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ts.h&gt;

        typedef struct TS_verify_ctx TS_VERIFY_CTX;

        TS_VERIFY_CTX *TS_VERIFY_CTX_new(void);
        void TS_VERIFY_CTX_init(TS_VERIFY_CTX *ctx);
        void TS_VERIFY_CTX_free(TS_VERIFY_CTX *ctx);
        void TS_VERIFY_CTX_cleanup(TS_VERIFY_CTX *ctx);
        int TS_VERIFY_CTX_set_flags(TS_VERIFY_CTX *ctx, int f);
        int TS_VERIFY_CTX_add_flags(TS_VERIFY_CTX *ctx, int f);
        int TS_VERIFY_CTX_set0_data(TS_VERIFY_CTX *ctx, BIO *b);
        int TS_VERIFY_CTX_set0_imprint(TS_VERIFY_CTX *ctx,
                                       unsigned char *hexstr, long len);
        int TS_VERIFY_CTX_set0_store(TS_VERIFY_CTX *ctx, X509_STORE *s);
        int TS_VERIFY_CTX_set0_certs(TS_VERIFY_CTX *ctx, STACK_OF(X509) *certs);

       The following functions have been deprecated since OpenSSL 3.4:

        BIO *TS_VERIFY_CTX_set_data(TS_VERIFY_CTX *ctx, BIO *b);
        unsigned char *TS_VERIFY_CTX_set_imprint(TS_VERIFY_CTX *ctx,
                                                 unsigned char *hexstr, long len);
        X509_STORE *TS_VERIFY_CTX_set_store(TS_VERIFY_CTX *ctx, X509_STORE *s);
        STACK_OF(X509) *TS_VERIFY_CTX_set_certs(TS_VERIFY_CTX *ctx,
                                                STACK_OF(X509) *certs);

       The following function has been deprecated since OpenSSL 3.0:

        STACK_OF(X509) *TS_VERIFY_CTS_set_certs(TS_VERIFY_CTX *ctx,
                                                STACK_OF(X509) *certs);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The Time-Stamp Protocol (TSP) is defined by RFC 3161. TSP is a protocol used to provide long-term proof
       of the existence of certain data before a particular time. TSP defines a Time Stamping Authority (TSA)
       and an entity that makes requests to the TSA. Usually, the TSA is referred to as the server side, and the
       requesting entity is referred to as the client.

       In TSP, when a server sends a response to a client, the server normally needs to sign the response data -
       the TimeStampToken (TST) - with its private key. Then the client verifies the received TST using the
       server's certificate chain.

       For all the following methods, unless noted otherwise, <u>ctx</u> is the verification context created in
       advance.

       <b>TS_VERIFY_CTX_new()</b> returns an allocated <b>TS_VERIFY_CTX</b> structure.

       <b>TS_VERIFY_CTX_init()</b> initializes a verification context.

       <b>TS_VERIFY_CTX_free()</b> frees up a <b>TS_VERIFY_CTX</b> object. <u>ctx</u> is the verification context to be freed. If <u>ctx</u>
       is NULL, the call is ignored.

       <b>TS_VERIFY_CTX_set_flags()</b> sets the flags in the verification context. <u>f</u> are the flags to be set.

       <b>TS_VERIFY_CTX_add_flags()</b> adds flags to the verification context. <u>f</u> are the flags to be added (OR'd).

       <b>TS_VERIFY_CTX_set0_data()</b> sets the data to be verified. <u>b</u> is the <b>BIO</b> with the data. A previously assigned
       <b>BIO</b> is freed.

       <b>TS_VERIFY_CTX_set0_imprint()</b> sets the message imprint. <u>hexstr</u> is the message imprint to be assigned. A
       previously assigned imprint is freed.

       <b>TS_VERIFY_CTX_set0_store()</b> sets the store for the verification context. <u>s</u> is the store to be assigned. A
       previously assigned store is freed.

       <b>TS_VERIFY_CTX_set0_certs()</b> is used to set the server's certificate chain when verifying a TST. <u>certs</u> is a
       stack of <b>X509</b> certificates.

       <b>TS_VERIFY_CTX_cleanup()</b> frees all data associated with the given <b>TS_VERIFY_CTX</b> object and initializes it.
       <u>ctx</u> is the verification context created in advance. If <u>ctx</u> is NULL, the call is ignored.

       All of the following functions described are deprecated. Applications should instead use the functions
       <b><a href="../man3/TS_VERIFY_CTX_set0_data.3.html">TS_VERIFY_CTX_set0_data</a></b>(3), <b><a href="../man3/TS_VERIFY_CTX_set0_imprint.3.html">TS_VERIFY_CTX_set0_imprint</a></b>(3), <b><a href="../man3/TS_VERIFY_CTX_set0_store.3.html">TS_VERIFY_CTX_set0_store</a></b>(3),
       <b><a href="../man3/TS_VERIFY_CTX_set0_certs.3.html">TS_VERIFY_CTX_set0_certs</a></b>(3).

       <b>TS_VERIFY_CTX_set_data()</b> is used to set the BIO with the data to be verified.  A previously assigned BIO
       is <b>not</b> <b>freed</b> by this call. <u>b</u> is the <b>BIO</b> with the data to assign.

       <b>TS_VERIFY_CTX_set_imprint()</b> is used to set the message imprint. A previously assigned imprint <b>is</b> <b>freed</b> by
       this call. <u>hexstr</u> is the string with the message imprint to assign.

       <b>TS_VERIFY_CTX_set_store()</b> is used to set the certificate store. A previously assigned store is <b>not</b> <b>freed</b>
       by this call. <u>s</u> is the store to assign.

       <b>TS_VERIFY_CTX_set_certs()</b> is used to set the server's certificate chain.  A previously assigned stack is
       <b>not</b> <b>freed</b> by this call. <u>certs</u> is a stack of <b>X509</b> certificates.

       <b>TS_VERIFY_CTS_set_certs()</b> is a misspelled version of <b>TS_VERIFY_CTX_set_certs()</b> which takes the same
       parameters and returns the same result.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>TS_VERIFY_CTX_new()</b> returns an allocated <b>TS_VERIFY_CTX</b> structure.

       <b>TS_VERIFY_CTX_set_flags()</b> returns the flags passed via parameter <u>f</u>.

       <b>TS_VERIFY_CTX_add_flags()</b> returns the flags of the context after the ones passed via parameter <u>f</u> are
       added to it.

       <b>TS_VERIFY_CTX_set0_data()</b>, <b>TS_VERIFY_CTX_set0_imprint()</b>, <b>TS_VERIFY_CTX_set0_store()</b>, and
       <b>TS_VERIFY_CTX_set0_certs()</b> return 1 if the value could be successfully set and 0 in case of any error.

       The deprecated functions <b>TS_VERIFY_CTX_set_data()</b>, <b>TS_VERIFY_CTX_set_imprint()</b>,
       <b>TS_VERIFY_CTX_set_store()</b>, <b>TS_VERIFY_CTX_set_certs()</b> return the parameter the user passes via parameter
       <u>bio</u>, <u>hexstr</u>, <u>s</u> or <u>certs</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/OSSL_ESS_check_signing_certs.3.html">OSSL_ESS_check_signing_certs</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>TS_VERIFY_CTX_set0_data()</b>, <b>TS_VERIFY_CTX_set0_imprint()</b>, <b>TS_VERIFY_CTX_set0_store()</b>,
       <b>TS_VERIFY_CTX_set0_certs()</b> replace the functions <b>TS_VERIFY_CTX_set_data()</b>, <b>TS_VERIFY_CTX_set_imprint()</b>,
       <b>TS_VERIFY_CTX_set_store()</b>, <b>TS_VERIFY_CTX_set_certs()</b> that were deprecated in OpenSSL 3.4.0.

       The spelling of <b>TS_VERIFY_CTX_set_certs()</b> was corrected in OpenSSL 3.0.0.  The misspelled version
       <b>TS_VERIFY_CTS_set_certs()</b> has been retained for compatibility reasons, but it is deprecated in OpenSSL
       3.0.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2019-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License"). You may not use this file except in compliance
       with the License. You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                <u><a href="../man3SSL/TS_VERIFY_CTX.3SSL.html">TS_VERIFY_CTX</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>