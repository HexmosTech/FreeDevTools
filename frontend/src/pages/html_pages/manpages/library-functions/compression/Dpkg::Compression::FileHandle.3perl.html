<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dpkg::Compression::FileHandle - class dealing transparently with file compression</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libdpkg-perl">libdpkg-perl_1.22.21ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Dpkg::Compression::FileHandle - class dealing transparently with file compression

</pre><h4><b>SYNOPSIS</b></h4><pre>
           use Dpkg::Compression::FileHandle;

           my ($fh, @lines);

           $fh = Dpkg::Compression::FileHandle-&gt;new(filename =&gt; 'sample.gz');
           print $fh "Something\n";
           close $fh;

           $fh = Dpkg::Compression::FileHandle-&gt;new();
           open($fh, '&gt;', 'sample.bz2');
           print $fh "Something\n";
           close $fh;

           $fh = Dpkg::Compression::FileHandle-&gt;new();
           $fh-&gt;open('sample.xz', 'w');
           $fh-&gt;print("Something\n");
           $fh-&gt;close();

           $fh = Dpkg::Compression::FileHandle-&gt;new(filename =&gt; 'sample.gz');
           @lines = &lt;$fh&gt;;
           close $fh;

           $fh = Dpkg::Compression::FileHandle-&gt;new();
           open($fh, '&lt;', 'sample.bz2');
           @lines = &lt;$fh&gt;;
           close $fh;

           $fh = Dpkg::Compression::FileHandle-&gt;new();
           $fh-&gt;open('sample.xz', 'r');
           @lines = $fh-&gt;getlines();
           $fh-&gt;close();

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Dpkg::Compression::FileHandle is a class that can be used like any filehandle and that deals
       transparently with compressed files. By default, the compression scheme is guessed from the filename but
       you can override this behavior with the method <b>set_compression()</b>.

       If you don't open the file explicitly, it will be auto-opened on the first read or write operation based
       on the filename set at creation time (or later with the <b>set_filename()</b> method).

       Once a file has been opened, the filehandle must be closed before being able to open another file.

</pre><h4><b>STANDARD</b> <b>FUNCTIONS</b></h4><pre>
       The standard functions acting on filehandles should accept a Dpkg::Compression::FileHandle object
       transparently including <b>open()</b> (only when using the variant with 3 parameters), <b>close()</b>, <b>binmode()</b>,
       <b>eof()</b>, <b>fileno()</b>, <b>getc()</b>, <b>print()</b>, <b>printf()</b>, <b>read()</b>, <b>sysread()</b>, <b>say()</b>, <b>write()</b>, <b>syswrite()</b>, <b>seek()</b>,
       <b>sysseek()</b>, <b>tell()</b>.

       Note however that <b>seek()</b> and <b>sysseek()</b> will only work on uncompressed files as compressed files are
       really pipes to the compressor programs and you can't seek on a pipe.

</pre><h4><b>FileHandle</b> <b>METHODS</b></h4><pre>
       The class inherits from IO::File so all methods that work on this class should work for
       Dpkg::Compression::FileHandle too. There may be exceptions though.

</pre><h4><b>PUBLIC</b> <b>METHODS</b></h4><pre>
       $fh = Dpkg::Compression::FileHandle-&gt;new(%opts)
           Creates a new filehandle supporting on-the-fly compression/decompression.

           Options:

           <b>filename</b>
               See $fh-&gt;<b>set_filename()</b>.

           <b>compression</b>
               See $fh-&gt;<b>set_compression()</b>.

           <b>compression_level</b>
               See $fh-&gt;<b>set_compression_level()</b>.

           <b>add_comp_ext</b>
               If  set  to  true,  then  the  extension  corresponding  to  the  selected  compression scheme is
               automatically added  to  the  recorded  filename.  It's  obviously  incompatible  with  automatic
               detection of the compression method.

       $fh-&gt;ensure_open($mode, %opts)
           Ensure  the  file  is  opened in the requested mode ("r" for read and "w" for write). The options are
           passed down to the compressor's <b>spawn()</b> call, if one is  used.  Opens  the  file  with  the  recorded
           filename if needed. If the file is already open but not in the requested mode, then it errors out.

       $fh-&gt;set_compression($comp)
           Defines  the  compression method used. $comp should one of the methods supported by Dpkg::Compression
           or "none" or "auto". "none" indicates that the file is uncompressed and  "auto"  indicates  that  the
           method must be guessed based on the filename extension used.

       $fh-&gt;set_compression_level($level)
           Indicate   the   desired   compression  level.  It  should  be  a  value  accepted  by  the  function
           <b>compression_is_valid_level()</b> of Dpkg::Compression.

       $fh-&gt;set_filename($name, [$add_comp_ext])
           Use $name as filename when the file must be opened/created. If $add_comp_ext is passed, it  indicates
           whether  the  default extension of the compression method must be automatically added to the filename
           (or not).

       $file = $fh-&gt;<b>get_filename()</b>
           Returns the filename that would be used when the filehandle must be opened (both in  read  and  write
           mode).  This  function errors out if "add_comp_ext" is enabled while the compression method is set to
           "auto". The returned filename includes the extension of the compression method if  "add_comp_ext"  is
           enabled.

       $ret = $fh-&gt;<b>use_compression()</b>
           Returns  "0"  if no compression is used and the compression method used otherwise. If the compression
           is set to "auto", the value returned depends on the extension  of  the  filename  obtained  with  the
           <b>get_filename()</b> method.

       $real_fh = $fh-&gt;<b>get_filehandle()</b>
           Returns the real underlying filehandle. Useful if you want to pass it along in a derived class.

</pre><h4><b>DERIVED</b> <b>CLASSES</b></h4><pre>
       If you want to create a class that inherits from Dpkg::Compression::FileHandle you must be aware that the
       object is a reference to a GLOB that is returned by <b>Symbol::gensym()</b> and as such it's not a HASH.

       You  can  store internal data in a hash but you have to use "*$self-"{...}&gt; to access the associated hash
       like in the example below:

           sub set_option {
               my ($self, $value) = @_;
               *$self-&gt;{option} = $value;
           }

</pre><h4><b>CHANGES</b></h4><pre>
   <b>Version</b> <b>1.01</b> <b>(dpkg</b> <b>1.17.11)</b>
       New argument: $fh-&gt;<b>ensure_open()</b> accepts an %opts argument.

   <b>Version</b> <b>1.00</b> <b>(dpkg</b> <b>1.15.6)</b>
       Mark the module as public.

1.22.21                                            2025-07-14               <u>Dpkg::Compression::<a href="../man3perl/FileHandle.3perl.html">FileHandle</a></u>(3perl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>