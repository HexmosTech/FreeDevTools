<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>zlib - compression and decompression operations</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcl9.0-doc">tcl9.0-doc_9.0.1+dfsg-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       zlib - compression and decompression operations

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>zlib</b> <u>subcommand</u> <u>arg</u> <u>...</u>
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>zlib</b>  command provides access to the compression and check-summing facilities of the Zlib library by
       Jean-loup Gailly and Mark Adler. It has the following subcommands.

   <b>COMPRESSION</b> <b>SUBCOMMANDS</b>
       <b>zlib</b> <b>compress</b> <u>string</u> ?<u>level</u>?
              Returns the zlib-format compressed binary data of the binary string in <u>string</u>. If  present,  <u>level</u>
              gives the compression level to use (from 0, which is uncompressed, to 9, maximally compressed).

       <b>zlib</b> <b>decompress</b> <u>string</u> ?<u>bufferSize</u>?
              Returns  the  uncompressed  version  of  the  raw  compressed  binary  data in <u>string</u>. If present,
              <u>bufferSize</u> is a hint as to what size of buffer is to be used to receive the data.

       <b>zlib</b> <b>deflate</b> <u>string</u> ?<u>level</u>?
              Returns the raw compressed binary data of the binary string in <u>string</u>.  If  present,  <u>level</u>  gives
              the compression level to use (from 0, which is uncompressed, to 9, maximally compressed).

       <b>zlib</b> <b>gunzip</b> <u>string</u> ?<b>-headerVar</b> <u>varName</u>?
              Return  the uncompressed contents of binary string <u>string</u>, which must have been in gzip format. If
              <b>-headerVar</b> is given, store a dictionary describing the contents of the gzip header in the variable
              called <u>varName</u>. The keys of the dictionary that may be present are:

              <b>comment</b>
                     The comment field from the header, if present.

              <b>crc</b>    A boolean value describing whether a CRC of the header is computed.

              <b>filename</b>
                     The filename field from the header, if present.

              <b>os</b>     The operating system type code field from the header (if not the QW unknown value). See RFC
                     1952 for the meaning of these codes.

              <b>size</b>   The size of the uncompressed data.

              <b>time</b>   The time field from the header if non-zero, expected to be time that the file named by  the
                     <b>filename</b> field was modified. Suitable for use with <b>clock</b> <b>format</b>.

              <b>type</b>   The type of the uncompressed data (<b>binary</b> or <b>text</b>) if known.

       <b>zlib</b> <b>gzip</b> <u>string</u> ?<b>-level</b> <u>level</u>? ?<b>-header</b> <u>dict</u>?
              Return  the compressed contents of binary string <u>string</u> in gzip format.  If <b>-level</b> is given, <u>level</u>
              gives the compression level to use (from 0, which is uncompressed, to 9, maximally compressed). If
              <b>-header</b> is given, <u>dict</u> is a dictionary containing values used for the gzip header.  The  following
              keys may be defined:

              <b>comment</b>
                     Add the given comment to the header of the gzip-format data.

              <b>crc</b>    A  boolean  saying  whether  to compute a CRC of the header. Note that if the data is to be
                     interchanged with the <b>gzip</b> program, a header CRC should <u>not</u> be computed.

              <b>filename</b>
                     The name of the file that the data to be compressed came from.

              <b>os</b>     The operating system type code, which should be one of the values described in RFC 1952.

              <b>time</b>   The time that the file named in the <b>filename</b> key was last modified. This  will  be  in  the
                     same as is returned by <b>clock</b> <b>seconds</b> or <b>file</b> <b>mtime</b>.

              <b>type</b>   The type of the data being compressed, being <b>binary</b> or <b>text</b>.

       <b>zlib</b> <b>inflate</b> <u>string</u> ?<u>bufferSize</u>?
              Returns  the  uncompressed  version  of  the  raw  compressed  binary  data in <u>string</u>. If present,
              <u>bufferSize</u> is a hint as to what size of buffer is to be used to receive the data.

   <b>CHANNEL</b> <b>SUBCOMMAND</b>
       <b>zlib</b> <b>push</b> <u>mode</u> <u>channel</u> ?<u>options</u> <u>...</u>?
              Pushes a compressing or decompressing transformation onto the channel <u>channel</u>.  The transformation
              can be removed again with <b>chan</b> <b>pop</b>.  The <u>mode</u> argument determines what type of  transformation  is
              pushed; the following are supported:

              <b>compress</b>
                     The  transformation  will be a compressing transformation that produces zlib-format data on
                     <u>channel</u>, which must be writable.

              <b>decompress</b>
                     The transformation will be a decompressing transformation that reads zlib-format data  from
                     <u>channel</u>, which must be readable.

              <b>deflate</b>
                     The  transformation  will be a compressing transformation that produces raw compressed data
                     on <u>channel</u>, which must be writable.

              <b>gunzip</b> The transformation will be a decompressing transformation that reads gzip-format data  from
                     <u>channel</u>, which must be readable.

              <b>gzip</b>   The  transformation  will be a compressing transformation that produces gzip-format data on
                     <u>channel</u>, which must be writable.

              <b>inflate</b>
                     The transformation will be a decompressing transformation that reads  raw  compressed  data
                     from <u>channel</u>, which must be readable.

              The following options may be set when creating a transformation via the “<u>options</u> <u>...</u>”  to the <b>zlib</b>
              <b>push</b> command:

              <b>-dictionary</b> <u>binData</u>
                     Sets  the  compression dictionary to use when working with compressing or decompressing the 2
                     data to be <u>binData</u>. Not valid for transformations that work  with  gzip-format  data.   The 2
                     dictionary  should  consist  of  strings (byte sequences) that are likely to be encountered 2
                     later in the data to be compressed, with the most  commonly  used  strings  preferably  put 2
                     towards  the  end  of  the  dictionary.  Tcl provides no mechanism for choosing a good such 2
                     dictionary for a particular data sequence.

              <b>-header</b> <u>dictionary</u>
                     Passes a description of the gzip header to create,  in  the  same  format  that  <b>zlib</b>  <b>gzip</b>
                     understands.

              <b>-level</b> <u>compressionLevel</u>
                     How  hard  to  compress  the data. Must be an integer from 0 (uncompressed) to 9 (maximally
                     compressed).

              <b>-limit</b> <u>readaheadLimit</u>
                     The maximum number of bytes ahead to read when decompressing.

                     This option has become <b>irrelevant</b>. It was originally introduced to prevent Tcl from reading
                     beyond the end of a compressed stream in multi-stream channels  to  ensure  that  the  data
                     after was left alone for further reading, at the cost of speed.

                     Tcl  now  automatically returns any bytes it has read beyond the end of a compressed stream
                     back to the channel, making them appear as unread to further readers.

              Both compressing and decompressing channel transformations add extra  configuration  options  that
              may be accessed through <b>chan</b> <b>configure</b>. The options are:

              <b>-checksum</b> <u>checksum</u>
                     This  read-only  option  gets  the  current  checksum  for  the  uncompressed data that the
                     compression engine has seen so far. It is valid  for  both  compressing  and  decompressing
                     transforms,  but  not  for  the  raw inflate and deflate formats. The compression algorithm
                     depends on what format is being produced or consumed.

              <b>-dictionary</b> <u>binData</u>
                     This read-write options gets or sets the initial compression dictionary to use when working 2
                     with  compressing  or  decompressing  the  data  to  be  <u>binData</u>.   It  is  not  valid  for 2
                     transformations  that  work  with  gzip-format  data,  and  should  not  normally be set on 2
                     compressing transformations other than at the point where the  transformation  is  stacked. 2
                     Note  that this cannot be used to get the current active compression dictionary mid-stream, 2
                     as that information is not exposed by the underlying library.

              <b>-flush</b> <u>type</u>
                     This write-only operation flushes the current state of the  compressor  to  the  underlying
                     channel.  It is only valid for compressing transformations. The <u>type</u> must be either <b>sync</b> or
                     <b>full</b> for a  normal  flush  or  an  expensive  flush  respectively.  Flushing  degrades  the
                     compression  ratio,  but  makes it easier for a decompressor to recover more of the file in
                     the case of data corruption.

              <b>-header</b> <u>dictionary</u>
                     This read-only option, only valid for decompressing transforms that  are  processing  gzip-
                     format data, returns the dictionary describing the header read off the data stream.

              <b>-limit</b> <u>readaheadLimit</u>
                     This  read-write  option is used by decompressing channels to control the maximum number of
                     bytes ahead to read from the underlying data source. See above for more information.

   <b>STREAMING</b> <b>SUBCOMMAND</b>
       <b>zlib</b> <b>stream</b> <u>mode</u> ?<u>options</u>?
              Creates a streaming compression or decompression command based on the <u>mode</u>, and return the name of
              the command. For a description of how that command works, see <b>STREAMING</b>  <b>INSTANCE</b>  <b>COMMAND</b>  below.
              The following modes and <u>options</u> are supported:

              <b>zlib</b> <b>stream</b> <b>compress</b> ?<b>-dictionary</b> <u>bindata</u>? ?<b>-level</b> <u>level</u>?
                     The stream will be a compressing stream that produces zlib-format output, using compression
                     level  <u>level</u>  (if  specified)  which  will  be  an integer from 0 to 9, and the compression 2
                     dictionary <u>bindata</u> (if specified).

              <b>zlib</b> <b>stream</b> <b>decompress</b> ?<b>-dictionary</b> <u>bindata</u>?
                     The stream will be a  decompressing  stream  that  takes  zlib-format  input  and  produces
                     uncompressed  output.   If  <u>bindata</u>  is  supplied, it is a compression dictionary to use if 2
                     required.

              <b>zlib</b> <b>stream</b> <b>deflate</b> ?<b>-dictionary</b> <u>bindata</u>? ?<b>-level</b> <u>level</u>?
                     The stream will be a compressing stream that produces raw output, using  compression  level
                     <u>level</u>  (if  specified) which will be an integer from 0 to 9, and the compression dictionary 2
                     <u>bindata</u> (if specified). Note that the raw compressed data includes no metadata  about  what 2
                     compression dictionary was used, if any; that is a feature of the zlib-format data.

              <b>zlib</b> <b>stream</b> <b>gunzip</b>
                     The  stream  will  be  a  decompressing  stream  that  takes gzip-format input and produces
                     uncompressed output.

              <b>zlib</b> <b>stream</b> <b>gzip</b> ?<b>-header</b> <u>header</u>? ?<b>-level</b> <u>level</u>?
                     The stream will be a compressing stream that produces gzip-format output, using compression
                     level <u>level</u> (if specified) which will be an integer from 0 to 9, and the header  descriptor
                     dictionary <u>header</u> (if specified; for keys see <b>zlib</b> <b>gzip</b>).

              <b>zlib</b> <b>stream</b> <b>inflate</b> ?<b>-dictionary</b> <u>bindata</u>?
                     The  stream  will  be  a  decompressing stream that takes raw compressed input and produces
                     uncompressed output.  If <u>bindata</u> is supplied, it is a compression dictionary to  use.  Note 2
                     that  there  are  no  checks  in  place  to determine whether the compression dictionary is 2
                     correct.

   <b>CHECKSUMMING</b> <b>SUBCOMMANDS</b>
       <b>zlib</b> <b>adler32</b> <u>string</u> ?<u>initValue</u>?
              Compute a checksum of binary string <u>string</u> using the Adler-32 algorithm.  If given,  <u>initValue</u>  is
              used to initialize the checksum engine.

       <b>zlib</b> <b>crc32</b> <u>string</u> ?<u>initValue</u>?
              Compute  a  checksum  of  binary string <u>string</u> using the CRC-32 algorithm.  If given, <u>initValue</u> is
              used to initialize the checksum engine.

</pre><h4><b>STREAMING</b> <b>INSTANCE</b> <b>COMMAND</b></h4><pre>
       Streaming compression instance commands are produced by the <b>zlib</b> <b>stream</b> command. They are used by calling
       their <b>put</b> subcommand one or more times to load data in, and their <b>get</b> subcommand one  or  more  times  to
       extract the transformed data.

       The full set of subcommands supported by a streaming instance command, <u>stream</u>, is as follows:

       <u>stream</u> <b>add</b> ?<u>option...</u>? <u>data</u>
              A short-cut for “<u>stream</u> <b>put</b> ?<u>option...</u>? <u>data</u>” followed by “<u>stream</u> <b>get</b>”.

       <u>stream</u> <b>checksum</b>
              Returns the checksum of the uncompressed data seen so far by this stream.

       <u>stream</u> <b>close</b>
              Deletes this stream and frees up all resources associated with it.

       <u>stream</u> <b>eof</b>
              Returns  a  boolean indicating whether the end of the stream (as determined by the compressed data
              itself) has been reached. Not all formats support detection of the end of the stream.

       <u>stream</u> <b>finalize</b>
              A short-cut for “<u>stream</u> <b>put</b> <b>-finalize</b> <b>{}</b>”.

       <u>stream</u> <b>flush</b>
              A short-cut for “<u>stream</u> <b>put</b> <b>-flush</b> <b>{}</b>”.

       <u>stream</u> <b>fullflush</b>
              A short-cut for “<u>stream</u> <b>put</b> <b>-fullflush</b> <b>{}</b>”.

       <u>stream</u> <b>get</b> ?<u>count</u>?
              Return up to <u>count</u> bytes from <u>stream</u>'s internal buffers with the transformation applied. If  <u>count</u>
              is omitted, the entire contents of the buffers are returned.

       <u>stream</u> <b>header</b>
              Return  the  gzip  header  description  dictionary  extracted  from the stream. Only supported for
              streams created with their <u>mode</u> parameter set to <b>gunzip</b>.

       <u>stream</u> <b>put</b> ?<u>option...</u>? <u>data</u>
              Append the contents of the binary string <u>data</u> to <u>stream</u>'s  internal  buffers  while  applying  the
              transformation.  The following <u>option</u>s are supported (or an unambiguous prefix of them), which are
              used to modify the way in which the transformation is applied:

              <b>-dictionary</b> <u>binData</u>
                     Sets the compression dictionary to use when working with compressing or  decompressing  the 2
                     data to be <u>binData</u>.

              <b>-finalize</b>
                     Mark  the  stream  as  finished,  ensuring  that  all  bytes have been wholly compressed or
                     decompressed. For gzip streams, this also ensures that the footer is written to the stream.
                     The stream will need to be reset before having more data written to it after  this,  though
                     data can still be read out of the stream with the <b>get</b> subcommand.

                     This option is mutually exclusive with the <b>-flush</b> and <b>-fullflush</b> options.

              <b>-flush</b> Ensure  that  a  decompressor  consuming the bytes that the current (compressing) stream is
                     producing will be able to produce all the bytes that have been compressed so far,  at  some
                     performance penalty.

                     This option is mutually exclusive with the <b>-finalize</b> and <b>-fullflush</b> options.

              <b>-fullflush</b>
                     Ensure  that  not  only  can  a  decompressor handle all the bytes produced so far (as with
                     <b>-flush</b> above) but also that it can restart from this point if it detects that the stream is
                     partially corrupt. This incurs a substantial performance penalty.

                     This option is mutually exclusive with the <b>-finalize</b> and <b>-flush</b> options.

       <u>stream</u> <b>reset</b>
              Puts any stream, including those that have been finalized or that have reached eof,  back  into  a
              state where it can process more data. Throws away all internally buffered data.

</pre><h4><b>EXAMPLES</b></h4><pre>
       To  compress  a  Tcl string, it should be first converted to a particular charset encoding since the <b>zlib</b>
       command always operates on binary strings.

              set binData [encoding convertto utf-8 $string]
              set compData [<b>zlib</b> <b>compress</b> $binData]

       When converting back, it is also important to reverse the charset encoding:

              set binData [<b>zlib</b> <b>decompress</b> $compData]
              set string [encoding convertfrom utf-8 $binData]

       The compression operation from above can also be done with streams, which is especially helpful when  you
       want to accumulate the data by stages:

              set strm [<b>zlib</b> <b>stream</b> compress]
              $<u>strm</u> <b>put</b> [encoding convertto utf-8 $string]
              # ...
              $<u>strm</u> <b>finalize</b>
              set compData [$<u>strm</u> <b>get</b>]
              $<u>strm</u> <b>close</b>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3tcl/binary.3tcl.html">binary</a>(3tcl), <a href="../man3tcl/chan.3tcl.html">chan</a>(3tcl), <a href="../man3tcl/encoding.3tcl.html">encoding</a>(3tcl), <a href="../man3tcl/Tcl_ZlibDeflate.3tcl.html">Tcl_ZlibDeflate</a>(3tcl), RFC1950 - RFC1952

</pre><h4><b>KEYWORDS</b></h4><pre>
       compress, decompress, deflate, gzip, inflate, zlib

Tcl                                                    8.6                                            <u><a href="../man3tcl/zlib.3tcl.html">zlib</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>