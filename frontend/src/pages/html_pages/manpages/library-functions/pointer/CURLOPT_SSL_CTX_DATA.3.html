<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CURLOPT_SSL_CTX_DATA - pointer passed to SSL context callback</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcurl4-doc">libcurl4-doc_8.14.1-1ubuntu2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CURLOPT_SSL_CTX_DATA - pointer passed to SSL context callback

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;curl/curl.h&gt;

       CURLcode curl_easy_setopt(CURL *handle, CURLOPT_SSL_CTX_DATA, void *pointer);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Data  <u>pointer</u>  to pass to the ssl context callback set by the option <u><a href="../man3/CURLOPT_SSL_CTX_FUNCTION.3.html">CURLOPT_SSL_CTX_FUNCTION</a>(3)</u>, this is
       the pointer you get as third parameter.

</pre><h4><b>DEFAULT</b></h4><pre>
       NULL

</pre><h4><b>PROTOCOLS</b></h4><pre>
       This functionality affects all TLS based protocols: HTTPS, FTPS, IMAPS, POP3S, SMTPS etc.

       This option works only with the following TLS backends: BearSSL, OpenSSL, mbedTLS and wolfSSL

</pre><h4><b>EXAMPLE</b></h4><pre>
       /* OpenSSL specific */

       #include &lt;openssl/ssl.h&gt;
       #include &lt;curl/curl.h&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;

       static CURLcode sslctx_function(CURL *curl, void *sslctx, void *parm)
       {
         X509_STORE *store;
         X509 *cert = NULL;
         BIO *bio;
         char *mypem = parm;
         /* get a BIO */
         bio = BIO_new_mem_buf(mypem, -1);
         /* use it to read the PEM formatted certificate from memory into an
          * X509 structure that SSL can use
          */
         PEM_read_bio_X509(bio, &amp;cert, 0, NULL);
         if(!cert)
           printf("PEM_read_bio_X509 failed...\n");

         /* get a pointer to the X509 certificate store (which may be empty) */
         store = SSL_CTX_get_cert_store((SSL_CTX *)sslctx);

         /* add our certificate to this store */
         if(X509_STORE_add_cert(store, cert) == 0)
           printf("error adding certificate\n");

         /* decrease reference counts */
         X509_free(cert);
         BIO_free(bio);

         /* all set to go */
         return CURLE_OK;
       }

       int main(void)
       {
         CURL *ch;
         CURLcode rv;
         char *mypem = /* example CA cert PEM - shortened */
           "-----BEGIN CERTIFICATE-----\n"
           "MIIHPTCCBSWgAwIBAgIBADANBgkqhkiG9w0BAQQFADB5MRAwDgYDVQQKEwdSb290\n"
           "IENBMR4wHAYDVQQLExVodHRwOi8vd3d3LmNhY2VydC5vcmcxIjAgBgNVBAMTGUNB\n"
           "IENlcnQgU2lnbmluZyBBdXRob3JpdHkxITAfBgkqhkiG9w0BCQEWEnN1cHBvcnRA\n"
           "Y2FjZXJ0Lm9yZzAeFw0wMzAzMzAxMjI5NDlaFw0zMzAzMjkxMjI5NDlaMHkxEDAO\n"
           "GCSNe9FINSkYQKyTYOGWhlC0elnYjyELn8+CkcY7v2vcB5G5l1YjqrZslMZIBjzk\n"
           "zk6q5PYvCdxTby78dOs6Y5nCpqyJvKeyRKANihDjbPIky/qbn3BHLt4Ui9SyIAmW\n"
           "omTxJBzcoTWcFbLUvFUufQb1nA5V9FrWk9p2rSVzTMVD\n"
           "-----END CERTIFICATE-----\n";

         curl_global_init(CURL_GLOBAL_ALL);
         ch = curl_easy_init();

         curl_easy_setopt(ch, CURLOPT_SSLCERTTYPE, "PEM");
         curl_easy_setopt(ch, CURLOPT_SSL_VERIFYPEER, 1L);
         curl_easy_setopt(ch, CURLOPT_URL, "https://www.example.com/");

         curl_easy_setopt(ch, CURLOPT_SSL_CTX_FUNCTION, *sslctx_function);
         curl_easy_setopt(ch, CURLOPT_SSL_CTX_DATA, mypem);
         rv = curl_easy_perform(ch);
         if(!rv)
           printf("*** transfer succeeded ***\n");
         else
           printf("*** transfer failed ***\n");

         curl_easy_cleanup(ch);
         curl_global_cleanup();
         return rv;
       }

</pre><h4><b>HISTORY</b></h4><pre>
       Added in 7.11.0 for OpenSSL, in 7.42.0 for wolfSSL, in 7.54.0 for mbedTLS, in 7.83.0 in BearSSL.

</pre><h4><b>AVAILABILITY</b></h4><pre>
       Added in curl 7.10.6

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       CURLE_OK if supported; or an error such as:

       CURLE_NOT_BUILT_IN - Not supported by the SSL backend

       CURLE_UNKNOWN_OPTION

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/CURLOPT_SSLVERSION.3.html">CURLOPT_SSLVERSION</a></b>(3), <b><a href="../man3/CURLOPT_SSL_CTX_FUNCTION.3.html">CURLOPT_SSL_CTX_FUNCTION</a></b>(3)

libcurl                                            2025-06-16                            <u><a href="../man3/CURLOPT_SSL_CTX_DATA.3.html">CURLOPT_SSL_CTX_DATA</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>