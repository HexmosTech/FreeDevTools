<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DH_get0_pqg, DH_set0_pqg, DH_get0_key, DH_set0_key, DH_get0_p, DH_get0_q, DH_get0_g, DH_get0_priv_key,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       DH_get0_pqg, DH_set0_pqg, DH_get0_key, DH_set0_key, DH_get0_p, DH_get0_q, DH_get0_g, DH_get0_priv_key,
       DH_get0_pub_key, DH_clear_flags, DH_test_flags, DH_set_flags, DH_get0_engine, DH_get_length,
       DH_set_length - Routines for getting and setting data in a DH object

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/dh.h&gt;

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        void DH_get0_pqg(const DH *dh,
                         const BIGNUM **p, const BIGNUM **q, const BIGNUM **g);
        int DH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g);
        void DH_get0_key(const DH *dh,
                         const BIGNUM **pub_key, const BIGNUM **priv_key);
        int DH_set0_key(DH *dh, BIGNUM *pub_key, BIGNUM *priv_key);
        const BIGNUM *DH_get0_p(const DH *dh);
        const BIGNUM *DH_get0_q(const DH *dh);
        const BIGNUM *DH_get0_g(const DH *dh);
        const BIGNUM *DH_get0_priv_key(const DH *dh);
        const BIGNUM *DH_get0_pub_key(const DH *dh);
        void DH_clear_flags(DH *dh, int flags);
        int DH_test_flags(const DH *dh, int flags);
        void DH_set_flags(DH *dh, int flags);

        long DH_get_length(const DH *dh);
        int DH_set_length(DH *dh, long length);

        ENGINE *DH_get0_engine(DH *d);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       All of the functions described on this page are deprecated.  Applications should instead use
       <b><a href="../man3/EVP_PKEY_get_bn_param.3.html">EVP_PKEY_get_bn_param</a></b>(3) for any methods that return a <b>BIGNUM</b>. Refer to <b><a href="../man7/EVP_PKEY-DH.7.html">EVP_PKEY-DH</a></b>(7) for more
       information.

       A DH object contains the parameters <u>p</u>, <u>q</u> and <u>g</u>. Note that the <u>q</u> parameter is optional. It also contains a
       public key (<u>pub_key</u>) and (optionally) a private key (<u>priv_key</u>).

       The <u>p</u>, <u>q</u> and <u>g</u> parameters can be obtained by calling <b>DH_get0_pqg()</b>.  If the parameters have not yet been
       set then <u>*p</u>, <u>*q</u> and <u>*g</u> will be set to NULL. Otherwise they are set to pointers to their respective
       values. These point directly to the internal representations of the values and therefore should not be
       freed directly.  Any of the out parameters <u>p</u>, <u>q</u>, and <u>g</u> can be NULL, in which case no value will be
       returned for that parameter.

       The <u>p</u>, <u>q</u> and <u>g</u> values can be set by calling <b>DH_set0_pqg()</b> and passing the new values for <u>p</u>, <u>q</u> and <u>g</u> as
       parameters to the function. Calling this function transfers the memory management of the values to the DH
       object, and therefore the values that have been passed in should not be freed directly after this
       function has been called. The <u>q</u> parameter may be NULL.  <b>DH_set0_pqg()</b> also checks if the parameters
       associated with <u>p</u> and <u>g</u> and optionally <u>q</u> are associated with known safe prime groups. If it is a safe
       prime group then the value of <u>q</u> will be set to q = (p - 1) / 2 if <u>q</u> is NULL. The optional length
       parameter will be set to BN_num_bits(<u>q</u>) if <u>q</u> is not NULL.

       To get the public and private key values use the <b>DH_get0_key()</b> function. A pointer to the public key will
       be stored in <u>*pub_key</u>, and a pointer to the private key will be stored in <u>*priv_key</u>. Either may be NULL
       if they have not been set yet, although if the private key has been set then the public key must be. The
       values point to the internal representation of the public key and private key values. This memory should
       not be freed directly.  Any of the out parameters <u>pub_key</u> and <u>priv_key</u> can be NULL, in which case no
       value will be returned for that parameter.

       The public and private key values can be set using <b>DH_set0_key()</b>. Either parameter may be NULL, which
       means the corresponding DH field is left untouched. As with <b>DH_set0_pqg()</b> this function transfers the
       memory management of the key values to the DH object, and therefore they should not be freed directly
       after this function has been called.

       Any of the values <u>p</u>, <u>q</u>, <u>g</u>, <u>priv_key</u>, and <u>pub_key</u> can also be retrieved separately by the corresponding
       function <b>DH_get0_p()</b>, <b>DH_get0_q()</b>, <b>DH_get0_g()</b>, <b>DH_get0_priv_key()</b>, and <b>DH_get0_pub_key()</b>, respectively.

       <b>DH_set_flags()</b> sets the flags in the <u>flags</u> parameter on the DH object.  Multiple flags can be passed in
       one go (bitwise ORed together). Any flags that are already set are left set. <b>DH_test_flags()</b> tests to see
       whether the flags passed in the <u>flags</u> parameter are currently set in the DH object. Multiple flags can be
       tested in one go. All flags that are currently set are returned, or zero if none of the flags are set.
       <b>DH_clear_flags()</b> clears the specified flags within the DH object.

       <b>DH_get0_engine()</b> returns a handle to the ENGINE that has been set for this DH object, or NULL if no such
       ENGINE has been set. This function is deprecated. All engines should be replaced by providers.

       The <b>DH_get_length()</b> and <b>DH_set_length()</b> functions get and set the optional length parameter associated
       with this DH object. If the length is nonzero then it is used, otherwise it is ignored. The <u>length</u>
       parameter indicates the length of the secret exponent (private key) in bits. For safe prime groups the
       optional length parameter <u>length</u> can be set to a value greater or equal to 2 *
       maximum_target_security_strength(BN_num_bits(<u>p</u>)) as listed in SP800-56Ar3 Table(s) 25 &amp; 26.  These
       functions are deprecated and should be replaced with <b>EVP_PKEY_CTX_set_params()</b> and
       <b>EVP_PKEY_get_int_param()</b> using the parameter key <b>OSSL_PKEY_PARAM_DH_PRIV_LEN</b> as described in
       <b><a href="../man7/EVP_PKEY-DH.7.html">EVP_PKEY-DH</a></b>(7).

</pre><h4><b>NOTES</b></h4><pre>
       Values retrieved with <b>DH_get0_key()</b> are owned by the DH object used in the call and may therefore <u>not</u> be
       passed to <b>DH_set0_key()</b>.  If needed, duplicate the received value using <b>BN_dup()</b> and pass the duplicate.
       The same applies to <b>DH_get0_pqg()</b> and <b>DH_set0_pqg()</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>DH_set0_pqg()</b> and <b>DH_set0_key()</b> return 1 on success or 0 on failure.

       <b>DH_get0_p()</b>, <b>DH_get0_q()</b>, <b>DH_get0_g()</b>, <b>DH_get0_priv_key()</b>, and <b>DH_get0_pub_key()</b> return the respective
       value, or NULL if it is unset.

       <b>DH_test_flags()</b> returns the current state of the flags in the DH object.

       <b>DH_get0_engine()</b> returns the ENGINE set for the DH object or NULL if no ENGINE has been set.

       <b>DH_get_length()</b> returns the length of the secret exponent (private key) in bits, or zero if no such
       length has been explicitly set.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/DH_new.3.html">DH_new</a></b>(3), <b><a href="../man3/DH_new.3.html">DH_new</a></b>(3), <b><a href="../man3/DH_generate_parameters.3.html">DH_generate_parameters</a></b>(3), <b><a href="../man3/DH_generate_key.3.html">DH_generate_key</a></b>(3), <b><a href="../man3/DH_set_method.3.html">DH_set_method</a></b>(3), <b><a href="../man3/DH_size.3.html">DH_size</a></b>(3),
       <b><a href="../man3/DH_meth_new.3.html">DH_meth_new</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The functions described here were added in OpenSSL 1.1.0.

       All of these functions were deprecated in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2016-2022 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                  <u><a href="../man3SSL/DH_GET0_PQG.3SSL.html">DH_GET0_PQG</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>