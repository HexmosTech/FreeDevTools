<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tk_ComputeTextLayout,   Tk_FreeTextLayout,   Tk_DrawTextLayout,  Tk_UnderlineTextLayout,  Tk_PointToChar,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tk9.0-doc">tk9.0-doc_9.0.1-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Tk_ComputeTextLayout,   Tk_FreeTextLayout,   Tk_DrawTextLayout,  Tk_UnderlineTextLayout,  Tk_PointToChar,
       Tk_CharBbox, Tk_DistanceToTextLayout, Tk_IntersectTextLayout,  Tk_TextLayoutToPostscript  -  routines  to
       measure and display single-font, multi-line, justified text.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tk.h&gt;</b>

       Tk_TextLayout
       <b>Tk_ComputeTextLayout</b>(<u>tkfont,</u> <u>string,</u> <u>numChars,</u> <u>wrapLength,</u> <u>justify,</u> <u>flags,</u> <u>widthPtr,</u> <u>heightPtr</u>)

       <b>Tk_FreeTextLayout</b>(<u>layout</u>)

       <b>Tk_DrawTextLayout</b>(<u>display,</u> <u>drawable,</u> <u>gc,</u> <u>layout,</u> <u>x,</u> <u>y,</u> <u>firstChar,</u> <u>lastChar</u>)

       <b>Tk_UnderlineTextLayout</b>(<u>display,</u> <u>drawable,</u> <u>gc,</u> <u>layout,</u> <u>x,</u> <u>y,</u> <u>underline</u>)

       int
       <b>Tk_PointToChar</b>(<u>layout,</u> <u>x,</u> <u>y</u>)

       int
       <b>Tk_CharBbox</b>(<u>layout,</u> <u>index,</u> <u>xPtr,</u> <u>yPtr,</u> <u>widthPtr,</u> <u>heightPtr</u>)

       int
       <b>Tk_DistanceToTextLayout</b>(<u>layout,</u> <u>x,</u> <u>y</u>)

       int
       <b>Tk_IntersectTextLayout</b>(<u>layout,</u> <u>x,</u> <u>y,</u> <u>width,</u> <u>height</u>)

       <b>Tk_TextLayoutToPostscript</b>(<u>interp,</u> <u>layout</u>)

</pre><h4><b>ARGUMENTS</b></h4><pre>
       Tk_Font <u>tkfont</u> (in)                      Font to use when constructing and displaying a text layout.  The
                                                <u>tkfont</u>  must  remain  valid for the lifetime of the text layout.
                                                Must have been returned by a previous call to <b>Tk_GetFont</b>.

       const char <u>*string</u> (in)                  Potentially  multi-line  string  whose  dimensions  are  to   be
                                                computed  and stored in the text layout.  The <u>string</u> must remain
                                                valid for the lifetime of the text layout.

       int <u>numChars</u> (in)                        The number of characters to consider from <u>string</u>.   If  <u>numChars</u>
                                                is  negative,  then  assumes  <u>string</u> is null terminated and uses
                                                <b>Tcl_NumUtfChars</b> to determine the length of <u>string</u>.

       int <u>wrapLength</u> (in)                      Longest permissible line length, in  pixels.   Lines  in  <u>string</u>
                                                will automatically be broken at word boundaries and wrapped when
                                                they  reach  this length.  If <u>wrapLength</u> is too small for even a
                                                single character to fit on a line, it will be expanded to  allow
                                                one character to fit on each line.  If <u>wrapLength</u> is &lt;= 0, there
                                                is no automatic wrapping; lines will get as long as they need to
                                                be and only wrap if a newline/return character is encountered.

       Tk_Justify <u>justify</u> (in)                  How  to justify the lines in a multi-line text layout.  Possible
                                                values    are     <b>TK_JUSTIFY_LEFT</b>,     <b>TK_JUSTIFY_CENTER</b>,     or
                                                <b>TK_JUSTIFY_RIGHT</b>.  If  the  text  layout  only occupies a single
                                                line, then <u>justify</u> is irrelevant.

       int <u>flags</u> (in)                           Various flag bits OR-ed together. <b>TK_IGNORE_TABS</b> means that  tab
                                                characters  should  not  be  expanded  to  the  next  tab  stop.
                                                <b>TK_IGNORE_NEWLINES</b> means that newline/return  characters  should
                                                not  cause a line break.  If either tabs or newlines/returns are
                                                ignored, then they will be treated as regular characters,  being
                                                measured   and  displayed  in  a  platform-dependent  manner  as
                                                described in <b>Tk_MeasureChars</b>, and  will  not  have  any  special
                                                behaviors.

       int <u>*widthPtr</u> (out)                      If  non-NULL,  filled  with  either the width, in pixels, of the
                                                widest line in the text layout, or the width, in pixels, of  the
                                                bounding box for the character specified by <u>index</u>.

       int <u>*heightPtr</u> (out)                     If  non-NULL, filled with either the total height, in pixels, of
                                                all the lines in the text layout, or the height, in  pixels,  of
                                                the bounding box for the character specified by <u>index</u>.

       Tk_TextLayout <u>layout</u> (in)                A  token that represents the cached layout information about the
                                                single-font, multi-line, justified piece of text.  This token is
                                                returned by <b>Tk_ComputeTextLayout</b>.

       Display <u>*display</u> (in)                    Display on which to draw.

       Drawable <u>drawable</u> (in)                   Window or pixmap in which to draw.

       GC <u>gc</u> (in)                               Graphics context to use  for  drawing  text  layout.   The  font
                                                selected  in  this  GC  must  correspond to the <u>tkfont</u> used when
                                                constructing the text layout.

       int <u>x,</u> <u>y</u> (in)                            Point, in pixels, at which to place the upper-left  hand  corner
                                                of the text layout when it is being drawn, or the coordinates of
                                                a  point (with respect to the upper-left hand corner of the text
                                                layout) to check against the text layout.

       Tcl_Size <u>firstChar</u> (in)                  The index of the first character to draw  from  the  given  text
                                                layout.  The number 0 means to draw from the beginning.

       Tcl_Size <u>lastChar</u> (in)                   The  index  of  the  last  character  up  to which to draw.  The
                                                character specified by <u>lastChar</u> itself will  not  be  drawn.   A
                                                number  less  than  0  means  to draw all characters in the text
                                                layout.

       int <u>underline</u> (in)                       Index of the single character to underline in the  text  layout,
                                                or  a  negative  number  counting  backwards from the end of the
                                                string.  Any  out-of-range  number  (e.g.  INT_MIN)   means   no
                                                underline.

       Tcl_Size <u>index</u> (in)                      The  index  of the character whose bounding box is desired.  The
                                                bounding box is computed with respect  to  the  upper-left  hand
                                                corner of the text layout.

       int <u>*xPtr,</u> <u>*yPtr</u> (out)                   Filled  with  the  upper-left  hand  corner,  in  pixels, of the
                                                bounding box for the character specified by  <u>index</u>.   Either  or
                                                both  <u>xPtr</u> and <u>yPtr</u> may be NULL, in which case the corresponding
                                                value is not calculated.

       int <u>width,</u> <u>height</u> (in)                   Specifies the width and height, in pixels,  of  the  rectangular
                                                area to compare for intersection against the text layout.

       Tcl_Interp <u>*interp</u> (out)                 Postscript  code  that will print the text layout is appended to
                                                the result of interpreter <u>interp</u>.
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These routines are for measuring and displaying single-font, multi-line, justified text.  To measure  and
       display  simple  single-font, single-line strings, refer to the documentation for <b>Tk_MeasureChars</b>.  There
       is no programming interface in the core of Tk that supports multi-font, multi-line text; support for that
       behavior must be built on top of simpler layers.  Note that unlike the lower level text display routines,
       the functions described here all operate on character-oriented lengths  and  indices  rather  than  byte-
       oriented  values.  See the description of <b>Tcl_UtfAtIndex</b> for more details on converting between character
       and byte offsets.

       The  routines  described  here  are  built  on  top  of  the  programming  interface  described  in   the
       <b>Tk_MeasureChars</b>  documentation.  Tab characters and newline/return characters may be treated specially by
       these procedures, but all other characters are passed through to the lower level.

       <b>Tk_ComputeTextLayout</b> computes the  layout  information  needed  to  display  a  single-font,  multi-line,
       justified  <u>string</u>  of  text and returns a Tk_TextLayout token that holds this information.  This token is
       used  in  subsequent  calls  to  procedures  such  as  <b>Tk_DrawTextLayout</b>,  <b>Tk_DistanceToTextLayout</b>,   and
       <b>Tk_FreeTextLayout</b>.   The  <u>string</u>  and  <u>tkfont</u>  used  when  computing the layout must remain valid for the
       lifetime of this token.

       <b>Tk_FreeTextLayout</b> is called to release the storage associated with <u>layout</u> when it is no longer needed.  A
       <u>layout</u> should not be used in any other text layout procedures once it has been released.

       <b>Tk_DrawTextLayout</b> uses the information in <u>layout</u> to display a single-font, multi-line,  justified  string
       of text at the specified location.

       <b>Tk_UnderlineTextLayout</b>  uses  the  information  in  <u>layout</u>  to  display  an underline below an individual
       character.  This procedure does not draw the text, just the underline.  To  produce  natively  underlined
       text,  an underlined font should be constructed and used.  All characters, including tabs, newline/return
       characters, and spaces at the ends of lines, can be underlined using this method.  However, the underline
       will never be drawn outside of the computed width of <u>layout</u>; the underline will stop at the edge for  any
       character that would extend partially outside of <u>layout</u>, and the underline will not be visible at all for
       any character that would be located completely outside of the layout.

       <b>Tk_PointToChar</b> uses the information in <u>layout</u> to determine the character closest to the given point.  The
       point  is  specified  with respect to the upper-left hand corner of the <u>layout</u>, which is considered to be
       located at (0, 0).  Any point whose <u>y</u>-value is less that 0  will  be  considered  closest  to  the  first
       character  in the text layout; any point whose <u>y</u>-value is greater than the height of the text layout will
       be considered closest to the last character in the text layout.  Any point whose <u>x</u>-value is negative will
       be considered closest to the first character on that line; any point whose <u>x</u>-value is  greater  than  the
       width of the text layout will be considered closest to the last character on that line.  The return value
       is  the index of the character that was closest to the point, or one more than the index of any character
       (to indicate that the point was after the end of the string and that the corresponding caret would be  at
       the  end  of  the  string).   Given  a  <u>layout</u>  with  no characters, the value 0 will always be returned,
       referring to a hypothetical zero-width placeholder character.

       <b>Tk_CharBbox</b> uses the information in <u>layout</u> to return the bounding box  for  the  character  specified  by
       <u>index</u>.   The  width  of  the bounding box is the advance width of the character, and does not include any
       left or right bearing.  Any character that extends partially  outside  of  <u>layout</u>  is  considered  to  be
       truncated at the edge.  Any character that would be located completely outside of <u>layout</u> is considered to
       be  zero-width  and  pegged against the edge.  The height of the bounding box is the line height for this
       font, extending from the top of the ascent to the bottom of the descent;  information  about  the  actual
       height  of  individual  letters  is  not  available.  For measurement purposes, a <u>layout</u> that contains no
       characters is considered to contain a single zero-width placeholder character at index 0.  If  <u>index</u>  was
       not  a  valid  character  index,  the  return  value is 0 and <u>*xPtr</u>, <u>*yPtr</u>, <u>*widthPtr</u>, and <u>*heightPtr</u> are
       unmodified.  Otherwise, if <u>index</u> did specify a valid, the return value is  non-zero,  and  <u>*xPtr</u>,  <u>*yPtr</u>,
       <u>*widthPtr</u>,  and  <u>*heightPtr</u>  are  filled  with the bounding box information for the character.  If any of
       <u>xPtr</u>, <u>yPtr</u>, <u>widthPtr</u>, or <u>heightPtr</u> are NULL, the corresponding value is not calculated or stored.

       <b>Tk_DistanceToTextLayout</b> computes the shortest distance in pixels from the  given  point  (<u>x,</u>  <u>y</u>)  to  the
       characters  in  <u>layout</u>.   Newline/return characters and non-displaying space characters that occur at the
       end of individual lines in the text layout are ignored for hit detection purposes, but tab characters are
       not.  The return value is 0 if the point actually hits the <u>layout</u>.  If the point did not hit  the  <u>layout</u>
       then the return value is the distance in pixels from the point to the <u>layout</u>.

       <b>Tk_IntersectTextLayout</b>  determines whether a <u>layout</u> lies entirely inside, entirely outside, or overlaps a
       given rectangle.  Newline/return characters and non-displaying space characters that occur at the end  of
       individual  lines in the <u>layout</u> are ignored for intersection calculations.  The return value is -1 if the
       <u>layout</u> is entirely outside of the rectangle, 0 if it overlaps, and 1 if it  is  entirely  inside  of  the
       rectangle.

       <b>Tk_TextLayoutToPostscript</b>  outputs  code  consisting  of a Postscript array of strings that represent the
       individual lines in <u>layout</u>.  It is the responsibility of the caller  to  take  the  Postscript  array  of
       strings and add some Postscript function operate on the array to render each of the lines.  The code that
       represents the Postscript array of strings is appended to interpreter <u>interp</u>'s result.

</pre><h4><b>DISPLAY</b> <b>MODEL</b></h4><pre>
       When  measuring  a  text layout, space characters that occur at the end of a line are ignored.  The space
       characters still exist and the insertion point can be positioned amongst them, but their additional width
       is ignored when justifying lines or returning the total width of a text layout.   All  end-of-line  space
       characters  are  considered  to  be  attached to the right edge of the line; this behavior is logical for
       left-justified text and reasonable for center-justified text, but not very  useful  when  editing  right-
       justified  text.   Spaces are considered variable width characters; the first space that extends past the
       edge of the text layout is clipped to the edge, and any subsequent spaces on the line are considered zero
       width and pegged against the edge.  Space characters that occur in the middle of a line of text  are  not
       suppressed and occupy their normal space width.

       Tab  characters  are  not  ignored  for measurement calculations.  If wrapping is turned on and there are
       enough tabs on a line, the next tab will wrap to the beginning of the next line.  There are some possible
       strange interactions between tabs and justification; tab positions are calculated  and  the  line  length
       computed  in  a  left-justified  world, and then the whole resulting line is shifted so it is centered or
       right-justified, causing the tab columns not to align any more.

       When wrapping is turned on, lines may wrap at word breaks (space or tab characters)  or  newline/returns.
       A  dash or hyphen character in the middle of a word is not considered a word break.  <b>Tk_ComputeTextLayout</b>
       always attempts to place at least one word on each line.  If it cannot  because  the  <u>wrapLength</u>  is  too
       small, the word will be broken and as much as fits placed on the line and the rest on subsequent line(s).
       If  <u>wrapLength</u> is so small that not even one character can fit on a given line, the <u>wrapLength</u> is ignored
       for that line and one character will be placed on the line anyhow.  When wrapping  is  turned  off,  only
       newline/return characters may cause a line break.

       When  a  text layout has been created using an underlined <u>tkfont</u>, then any space characters that occur at
       the end  of  individual  lines,  newlines/returns,  and  tabs  will  not  be  displayed  underlined  when
       <b>Tk_DrawTextLayout</b>  is  called,  because  those  characters  are  never  actually  drawn - they are merely
       placeholders maintained in the <u>layout</u>.

</pre><h4><b>KEYWORDS</b></h4><pre>
       font

Tk                                                     8.1                             <u><a href="../man3tk/Tk_ComputeTextLayout.3tk.html">Tk_ComputeTextLayout</a></u>(3tk)
</pre>
 </div>
</div></section>
</div>
</body>
</html>