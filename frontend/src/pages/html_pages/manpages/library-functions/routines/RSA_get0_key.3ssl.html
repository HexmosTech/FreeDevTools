<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA_set0_key, RSA_set0_factors, RSA_set0_crt_params, RSA_get0_key, RSA_get0_factors, RSA_get0_crt_params,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       RSA_set0_key, RSA_set0_factors, RSA_set0_crt_params, RSA_get0_key, RSA_get0_factors, RSA_get0_crt_params,
       RSA_get0_n, RSA_get0_e, RSA_get0_d, RSA_get0_p, RSA_get0_q, RSA_get0_dmp1, RSA_get0_dmq1, RSA_get0_iqmp,
       RSA_get0_pss_params, RSA_clear_flags, RSA_test_flags, RSA_set_flags, RSA_get0_engine,
       RSA_get_multi_prime_extra_count, RSA_get0_multi_prime_factors, RSA_get0_multi_prime_crt_params,
       RSA_set0_multi_prime_params, RSA_get_version - Routines for getting and setting data in an RSA object

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/rsa.h&gt;

       The following functions have been deprecated since OpenSSL 3.0, and can be hidden entirely by defining
       <b>OPENSSL_API_COMPAT</b> with a suitable version value, see <b><a href="../man7/openssl_user_macros.7.html">openssl_user_macros</a></b>(7):

        int RSA_set0_key(RSA *r, BIGNUM *n, BIGNUM *e, BIGNUM *d);
        int RSA_set0_factors(RSA *r, BIGNUM *p, BIGNUM *q);
        int RSA_set0_crt_params(RSA *r, BIGNUM *dmp1, BIGNUM *dmq1, BIGNUM *iqmp);
        void RSA_get0_key(const RSA *r,
                          const BIGNUM **n, const BIGNUM **e, const BIGNUM **d);
        void RSA_get0_factors(const RSA *r, const BIGNUM **p, const BIGNUM **q);
        void RSA_get0_crt_params(const RSA *r,
                                 const BIGNUM **dmp1, const BIGNUM **dmq1,
                                 const BIGNUM **iqmp);
        const BIGNUM *RSA_get0_n(const RSA *d);
        const BIGNUM *RSA_get0_e(const RSA *d);
        const BIGNUM *RSA_get0_d(const RSA *d);
        const BIGNUM *RSA_get0_p(const RSA *d);
        const BIGNUM *RSA_get0_q(const RSA *d);
        const BIGNUM *RSA_get0_dmp1(const RSA *r);
        const BIGNUM *RSA_get0_dmq1(const RSA *r);
        const BIGNUM *RSA_get0_iqmp(const RSA *r);
        const RSA_PSS_PARAMS *RSA_get0_pss_params(const RSA *r);
        void RSA_clear_flags(RSA *r, int flags);
        int RSA_test_flags(const RSA *r, int flags);
        void RSA_set_flags(RSA *r, int flags);
        ENGINE *RSA_get0_engine(RSA *r);
        int RSA_get_multi_prime_extra_count(const RSA *r);
        int RSA_get0_multi_prime_factors(const RSA *r, const BIGNUM *primes[]);
        int RSA_get0_multi_prime_crt_params(const RSA *r, const BIGNUM *exps[],
                                            const BIGNUM *coeffs[]);
        int RSA_set0_multi_prime_params(RSA *r, BIGNUM *primes[], BIGNUM *exps[],
                                       BIGNUM *coeffs[], int pnum);
        int RSA_get_version(RSA *r);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       All of the functions described on this page are deprecated.  Applications should instead use
       <b><a href="../man3/EVP_PKEY_get_bn_param.3.html">EVP_PKEY_get_bn_param</a></b>(3) for any methods that return a <b>BIGNUM</b>. Refer to <b><a href="../man7/EVP_PKEY-DH.7.html">EVP_PKEY-DH</a></b>(7) for more
       information.

       An RSA object contains the components for the public and private key, <b>n</b>, <b>e</b>, <b>d</b>, <b>p</b>, <b>q</b>, <b>dmp1</b>, <b>dmq1</b> and <b>iqmp</b>.
       <b>n</b> is the modulus common to both public and private key, <b>e</b> is the public exponent and <b>d</b> is the private
       exponent.  <b>p</b>, <b>q</b>, <b>dmp1</b>, <b>dmq1</b> and <b>iqmp</b> are the factors for the second representation of a private key (see
       PKCS#1 section 3 Key Types), where <b>p</b> and <b>q</b> are the first and second factor of <b>n</b> and <b>dmp1</b>, <b>dmq1</b> and <b>iqmp</b>
       are the exponents and coefficient for CRT calculations.

       For multi-prime RSA (defined in RFC 8017), there are also one or more 'triplet' in an RSA object. A
       triplet contains three members, <b>r</b>, <b>d</b> and <b>t</b>. <b>r</b> is the additional prime besides <b>p</b> and <b>q</b>. <b>d</b> and <b>t</b> are the
       exponent and coefficient for CRT calculations.

       The <b>n</b>, <b>e</b> and <b>d</b> parameters can be obtained by calling <b>RSA_get0_key()</b>.  If they have not been set yet, then
       <b>*n</b>, <b>*e</b> and <b>*d</b> will be set to NULL.  Otherwise, they are set to pointers to their respective values. These
       point directly to the internal representations of the values and therefore should not be freed by the
       caller.

       The <b>n</b>, <b>e</b> and <b>d</b> parameter values can be set by calling <b>RSA_set0_key()</b> and passing the new values for <b>n</b>, <b>e</b>
       and <b>d</b> as parameters to the function.  The values <b>n</b> and <b>e</b> must be non-NULL the first time this function is
       called on a given RSA object. The value <b>d</b> may be NULL. On subsequent calls any of these values may be
       NULL which means the corresponding RSA field is left untouched.  Calling this function transfers the
       memory management of the values to the RSA object, and therefore the values that have been passed in
       should not be freed by the caller after this function has been called.

       In a similar fashion, the <b>p</b> and <b>q</b> parameters can be obtained and set with <b>RSA_get0_factors()</b> and
       <b>RSA_set0_factors()</b>, and the <b>dmp1</b>, <b>dmq1</b> and <b>iqmp</b> parameters can be obtained and set with
       <b>RSA_get0_crt_params()</b> and <b>RSA_set0_crt_params()</b>.

       For <b>RSA_get0_key()</b>, <b>RSA_get0_factors()</b>, and <b>RSA_get0_crt_params()</b>, NULL value BIGNUM ** output parameters
       are permitted. The functions ignore NULL parameters but return values for other, non-NULL, parameters.

       For multi-prime RSA, <b>RSA_get0_multi_prime_factors()</b> and <b>RSA_get0_multi_prime_params()</b> can be used to
       obtain other primes and related CRT parameters. The return values are stored in an array of <b>BIGNUM</b> <b>*</b>.
       <b>RSA_set0_multi_prime_params()</b> sets a collect of multi-prime 'triplet' members (prime, exponent and
       coefficient) into an RSA object.

       Any of the values <b>n</b>, <b>e</b>, <b>d</b>, <b>p</b>, <b>q</b>, <b>dmp1</b>, <b>dmq1</b>, and <b>iqmp</b> can also be retrieved separately by the
       corresponding function <b>RSA_get0_n()</b>, <b>RSA_get0_e()</b>, <b>RSA_get0_d()</b>, <b>RSA_get0_p()</b>, <b>RSA_get0_q()</b>,
       <b>RSA_get0_dmp1()</b>, <b>RSA_get0_dmq1()</b>, and <b>RSA_get0_iqmp()</b>, respectively.

       <b>RSA_get0_pss_params()</b> is used to retrieve the RSA-PSS parameters.

       <b>RSA_set_flags()</b> sets the flags in the <b>flags</b> parameter on the RSA object. Multiple flags can be passed in
       one go (bitwise ORed together).  Any flags that are already set are left set. <b>RSA_test_flags()</b> tests to
       see whether the flags passed in the <b>flags</b> parameter are currently set in the RSA object. Multiple flags
       can be tested in one go. All flags that are currently set are returned, or zero if none of the flags are
       set. <b>RSA_clear_flags()</b> clears the specified flags within the RSA object.

       <b>RSA_get0_engine()</b> returns a handle to the ENGINE that has been set for this RSA object, or NULL if no
       such ENGINE has been set.

       <b>RSA_get_version()</b> returns the version of an RSA object <b>r</b>.

</pre><h4><b>NOTES</b></h4><pre>
       Values retrieved with <b>RSA_get0_key()</b> are owned by the RSA object used in the call and may therefore <u>not</u>
       be passed to <b>RSA_set0_key()</b>.  If needed, duplicate the received value using <b>BN_dup()</b> and pass the
       duplicate.  The same applies to <b>RSA_get0_factors()</b> and <b>RSA_set0_factors()</b> as well as
       <b>RSA_get0_crt_params()</b> and <b>RSA_set0_crt_params()</b>.

       The caller should obtain the size by calling <b>RSA_get_multi_prime_extra_count()</b> in advance and allocate
       sufficient buffer to store the return values before calling <b>RSA_get0_multi_prime_factors()</b> and
       <b>RSA_get0_multi_prime_params()</b>.

       <b>RSA_set0_multi_prime_params()</b> always clears the original multi-prime triplets in RSA object <b>r</b> and assign
       the new set of triplets into it.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>RSA_set0_key()</b>, <b>RSA_set0_factors()</b>, <b>RSA_set0_crt_params()</b> and <b>RSA_set0_multi_prime_params()</b> return 1 on
       success or 0 on failure.

       <b>RSA_get0_n()</b>, <b>RSA_get0_e()</b>, <b>RSA_get0_d()</b>, <b>RSA_get0_p()</b>, <b>RSA_get0_q()</b>, <b>RSA_get0_dmp1()</b>, <b>RSA_get0_dmq1()</b>,
       and <b>RSA_get0_iqmp()</b> return the respective value.

       <b>RSA_get0_pss_params()</b> returns a <b>RSA_PSS_PARAMS</b> pointer, or NULL if there is none.

       <b>RSA_get0_multi_prime_factors()</b> and <b>RSA_get0_multi_prime_crt_params()</b> return 1 on success or 0 on failure.

       <b>RSA_get_multi_prime_extra_count()</b> returns two less than the number of primes in use, which is 0 for
       traditional RSA and the number of extra primes for multi-prime RSA.

       <b>RSA_get_version()</b> returns <b>RSA_ASN1_VERSION_MULTI</b> for multi-prime RSA and <b>RSA_ASN1_VERSION_DEFAULT</b> for
       normal two-prime RSA, as defined in RFC 8017.

       <b>RSA_test_flags()</b> returns the current state of the flags in the RSA object.

       <b>RSA_get0_engine()</b> returns the ENGINE set for the RSA object or NULL if no ENGINE has been set.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/RSA_new.3.html">RSA_new</a></b>(3), <b><a href="../man3/RSA_size.3.html">RSA_size</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>RSA_get0_pss_params()</b> function was added in OpenSSL 1.1.1e.

       The <b>RSA_get_multi_prime_extra_count()</b>, <b>RSA_get0_multi_prime_factors()</b>, <b>RSA_get0_multi_prime_crt_params()</b>,
       <b>RSA_set0_multi_prime_params()</b>, and <b>RSA_get_version()</b> functions were added in OpenSSL 1.1.1.

       Other functions described here were added in OpenSSL 1.1.0.

       All of these functions were deprecated in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2016-2022 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                 <u><a href="../man3SSL/RSA_GET0_KEY.3SSL.html">RSA_GET0_KEY</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>