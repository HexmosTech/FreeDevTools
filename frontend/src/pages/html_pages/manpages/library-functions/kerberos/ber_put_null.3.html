<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ber_alloc_t,    ber_flush,    ber_flush2,   ber_printf,   ber_put_int,   ber_put_enum,   ber_put_ostring,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libldap-dev">libldap-dev_2.6.9+dfsg-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ber_alloc_t,    ber_flush,    ber_flush2,   ber_printf,   ber_put_int,   ber_put_enum,   ber_put_ostring,
       ber_put_string,   ber_put_null,   ber_put_boolean,   ber_put_bitstring,   ber_start_seq,   ber_start_set,
       ber_put_seq, ber_put_set - OpenLDAP LBER simplified Basic Encoding Rules library routines for encoding

</pre><h4><b>LIBRARY</b></h4><pre>
       OpenLDAP LBER (liblber, -llber)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;lber.h&gt;</b>

       <b>BerElement</b> <b>*ber_alloc_t(int</b> <u>options</u><b>);</b>

       <b>int</b> <b>ber_flush(Sockbuf</b> <b>*</b><u>sb</u><b>,</b> <b>BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>int</b> <u>freeit</u><b>);</b>

       <b>int</b> <b>ber_flush2(Sockbuf</b> <b>*</b><u>sb</u><b>,</b> <b>BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>int</b> <u>freeit</u><b>);</b>

       <b>int</b> <b>ber_printf(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>fmt</u><b>,</b> <b>...);</b>

       <b>int</b> <b>ber_put_int(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_int_t</b> <u>num</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_enum(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_int_t</b> <u>num</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_ostring(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>str</u><b>,</b> <b>ber_len_t</b> <u>len</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_string(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>str</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_null(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_boolean(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_int_t</b> <u>bool</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_bitstring(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>str</u><b>,</b> <b>ber_len_t</b> <u>blen</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_start_seq(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_start_set(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_seq(BerElement</b> <b>*</b><u>ber</u><b>);</b>

       <b>int</b> <b>ber_put_set(BerElement</b> <b>*</b><u>ber</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These  routines provide a subroutine interface to a simplified implementation of the Basic Encoding Rules
       of ASN.1.  The version of BER these routines support is the one  defined  for  the  LDAP  protocol.   The
       encoding  rules  are the same as BER, except that only definite form lengths are used, and bitstrings and
       octet strings are always encoded in primitive form.  This man page describes the encoding routines in the
       lber library.  See <b><a href="../man3/lber-decode.3.html">lber-decode</a></b>(3) for details on the  corresponding  decoding  routines.   Consult  <b><a href="../man3/lbertypes.3.html">lber-</a></b>
       <b><a href="../man3/lbertypes.3.html">types</a></b>(3) for information about types, allocators, and deallocators.

       Normally,  the only routines that need to be called by an application are <b>ber_alloc_t</b>() to allocate a BER
       element for encoding, <b>ber_printf</b>() to do the actual encoding, and  <b>ber_flush2</b>()  to  actually  write  the
       element.  The other routines are provided for those applications that need more control than <b>ber_printf</b>()
       provides.   In  general,  these  routines  return  the  length  of the element encoded, or -1 if an error
       occurred.

       The <b>ber_alloc_t</b>() routine is used to allocate a new BER element.  It should be called with an argument of
       LBER_USE_DER.

       The <b>ber_flush2</b>() routine is used to actually write the element to a socket (or file) descriptor, once  it
       has  been  fully  encoded  (using <b>ber_printf</b>() and friends).  See <b><a href="../man3/lber-sockbuf.3.html">lber-sockbuf</a></b>(3) for more details on the
       Sockbuf implementation of the <u>sb</u> parameter.  If the <u>freeit</u> parameter is non-zero, the supplied  <u>ber</u>  will
       be  freed.   If  <u>LBER_FLUSH_FREE_ON_SUCCESS</u>  is  used,  the  <u>ber</u> is only freed when successfully flushed,
       otherwise it is left intact; if <u>LBER_FLUSH_FREE_ON_ERROR</u> is used, the <u>ber</u> is only  freed  when  an  error
       occurs,  otherwise  it  is left intact; if <u>LBER_FLUSH_FREE_ALWAYS</u> is used, the <u>ber</u> is freed anyway.  This
       function differs from the original <b><a href="../man3/ber_flush.3.html">ber_flush</a></b>(3) function, whose behavior corresponds  to  that  indicated
       for  <u>LBER_FLUSH_FREE_ON_SUCCESS</u>.   Note that in the future, the behavior of <b><a href="../man3/ber_flush.3.html">ber_flush</a></b>(3) with <u>freeit</u> non-
       zero might change into that of <b><a href="../man3/ber_flush2.3.html">ber_flush2</a></b>(3) with <u>freeit</u> set to <u>LBER_FLUSH_FREE_ALWAYS</u>.

       The <b>ber_printf</b>() routine is used to encode a BER element in much the same way that <b><a href="../man3/sprintf.3.html">sprintf</a></b>(3) works.  One
       important difference, though, is that some state information is kept  with  the  <u>ber</u>  parameter  so  that
       multiple  calls can be made to <b>ber_printf</b>() to append things to the end of the BER element.  <b>Ber_printf</b>()
       writes to <u>ber</u>, a pointer to a BerElement such as returned by <b>ber_alloc_t</b>().  It  interprets  and  formats
       its  arguments  according  to  the  format  string  <u>fmt</u>.   The  format  string  can contain the following
       characters:

              <b>b</b>  Boolean.  An ber_int_t parameter should be supplied.  A boolean element is output.

              <b>e</b>  Enumeration.  An ber_int_t parameter should be supplied.  An enumeration element is output.

              <b>i</b>  Integer.  An ber_int_t parameter should be supplied.  An integer element is output.

              <b>B</b>  Bitstring.  A char * pointer to the start of the bitstring is supplied, followed by the  number
                 of bits in the bitstring.  A bitstring element is output.

              <b>n</b>  Null.  No parameter is required.  A null element is output.

              <b>o</b>  Octet string.  A char * is supplied, followed by the length of the string pointed to.  An octet
                 string element is output.

              <b>O</b>  Octet string.  A struct berval * is supplied.  An octet string element is output.

              <b>s</b>  Octet  string.   A  null-terminated string is supplied.  An octet string element is output, not
                 including the trailing NULL octet.

              <b>t</b>  Tag.  A ber_tag_t specifying the tag to give the next element is provided.  This  works  across
                 calls.

              <b>v</b>  Several octet strings.  A null-terminated array of char *'s is supplied.  Note that a construct
                 like '{v}' is required to get an actual SEQUENCE OF octet strings.

              <b>V</b>  Several  octet strings.  A null-terminated array of struct berval *'s is supplied.  Note that a
                 construct like '{V}' is required to get an actual SEQUENCE OF octet strings.

              <b>W</b>  Several octet strings.  An array of struct berval's is supplied.  The array is terminated by  a
                 struct  berval  with  a  NULL  bv_val.   Note that a construct like '{W}' is required to get an
                 actual SEQUENCE OF octet strings.

              <b>{</b>  Begin sequence.  No parameter is required.

              <b>}</b>  End sequence.  No parameter is required.

              <b>[</b>  Begin set.  No parameter is required.

              <b>]</b>  End set.  No parameter is required.

       The <b>ber_put_int</b>() routine writes the integer element <u>num</u> to the BER element <u>ber</u>.

       The <b>ber_put_enum</b>() routine writes the enumeration element <u>num</u> to the BER element <u>ber</u>.

       The <b>ber_put_boolean</b>() routine writes the boolean value given by <u>bool</u> to the BER element.

       The <b>ber_put_bitstring</b>() routine writes <u>blen</u> bits starting at <u>str</u> as a bitstring value to  the  given  BER
       element.  Note that <u>blen</u> is the length <u>in</u> <u>bits</u> of the bitstring.

       The <b>ber_put_ostring</b>() routine writes <u>len</u> bytes starting at <u>str</u> to the BER element as an octet string.

       The  <b>ber_put_string</b>()  routine  writes  the null-terminated string (minus the terminating ' ') to the BER
       element as an octet string.

       The <b>ber_put_null</b>() routine writes a NULL element to the BER element.

       The <b>ber_start_seq</b>() routine is used to start a sequence in the BER element.  The <b>ber_start_set</b>()  routine
       works  similarly.  The end of the sequence or set is marked by the nearest matching call to <b>ber_put_seq</b>()
       or <b>ber_put_set</b>(), respectively.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Assuming the following variable declarations, and that the variables have been assigned appropriately, an
       lber encoding of the following ASN.1 object:

             AlmostASearchRequest := SEQUENCE {
                 baseObject      DistinguishedName,
                 scope           ENUMERATED {
                     baseObject    (0),
                     singleLevel   (1),
                     wholeSubtree  (2)
                 },
                 derefAliases    ENUMERATED {
                     neverDerefaliases   (0),
                     derefInSearching    (1),
                     derefFindingBaseObj (2),
                     alwaysDerefAliases  (3)
                 },
                 sizelimit       INTEGER (0 .. 65535),
                 timelimit       INTEGER (0 .. 65535),
                 attrsOnly       BOOLEAN,
                 attributes      SEQUENCE OF AttributeType
             }

       can be achieved like so:

             int rc;
             ber_int_t    scope, ali, size, time, attrsonly;
             char   *dn, **attrs;
             BerElement *ber;

             /* ... fill in values ... */

             ber = ber_alloc_t( LBER_USE_DER );

             if ( ber == NULL ) {
                     /* error */
             }

             rc = ber_printf( ber, "{siiiib{v}}", dn, scope, ali,
                 size, time, attrsonly, attrs );

             if( rc == -1 ) {
                     /* error */
             } else {
                     /* success */
             }

</pre><h4><b>ERRORS</b></h4><pre>
       If an error occurs during encoding, generally these routines return -1.

</pre><h4><b>NOTES</b></h4><pre>
       The return values for all of these functions are declared in the &lt;lber.h&gt; header file.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/lber-decode.3.html">lber-decode</a></b>(3), <b><a href="../man3/lber-memory.3.html">lber-memory</a></b>(3), <b><a href="../man3/lber-sockbuf.3.html">lber-sockbuf</a></b>(3), <b><a href="../man3/lber-types.3.html">lber-types</a></b>(3)

</pre><h4><b>ACKNOWLEDGEMENTS</b></h4><pre>
       <b>OpenLDAP</b> <b>Software</b> is  developed  and  maintained  by  The  OpenLDAP  Project  &lt;<a href="http://www.openldap.org/">http://www.openldap.org/</a>&gt;.
       <b>OpenLDAP</b> <b>Software</b> is derived from the University of Michigan LDAP 3.3 Release.

OpenLDAP 2.6.9+dfsg-2ubuntu1                       2024/11/26                                     <u><a href="../man3/LBER_ENCODE.3.html">LBER_ENCODE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>