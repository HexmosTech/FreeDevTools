<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sd_id128_get_machine, sd_id128_get_app_specific, sd_id128_get_machine_app_specific, sd_id128_get_boot,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libsystemd-dev">libsystemd-dev_257.7-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sd_id128_get_machine, sd_id128_get_app_specific, sd_id128_get_machine_app_specific, sd_id128_get_boot,
       sd_id128_get_boot_app_specific, sd_id128_get_invocation - Retrieve 128-bit IDs

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;systemd/sd-id128.h&gt;</b>

       <b>int</b> <b>sd_id128_get_machine(sd_id128_t</b> <b>*</b><u>ret</u><b>);</b>

       <b>int</b> <b>sd_id128_get_app_specific(sd_id128_t</b> <u>base</u><b>,</b> <b>sd_id128_t</b> <u>app_id</u><b>,</b> <b>sd_id128_t</b> <b>*</b><u>ret</u><b>);</b>

       <b>int</b> <b>sd_id128_get_machine_app_specific(sd_id128_t</b> <u>app_id</u><b>,</b> <b>sd_id128_t</b> <b>*</b><u>ret</u><b>);</b>

       <b>int</b> <b>sd_id128_get_boot(sd_id128_t</b> <b>*</b><u>ret</u><b>);</b>

       <b>int</b> <b>sd_id128_get_boot_app_specific(sd_id128_t</b> <u>app_id</u><b>,</b> <b>sd_id128_t</b> <b>*</b><u>ret</u><b>);</b>

       <b>int</b> <b>sd_id128_get_invocation(sd_id128_t</b> <b>*</b><u>ret</u><b>);</b>

       <b>int</b> <b>sd_id128_get_invocation_app_specific(sd_id128_t</b> <u>app_id</u><b>,</b> <b>sd_id128_t</b> <b>*</b><u>ret</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>sd_id128_get_machine()</b> returns the machine ID of the executing host. This reads and parses the <b><a href="../man5/machineid.5.html">machine-</a></b>
       <b><a href="../man5/machineid.5.html">id</a></b>(5) file. This function caches the machine ID internally to make retrieving the machine ID a cheap
       operation. This ID may be used wherever a unique identifier for the local system is needed. However, it
       is recommended to use this ID as-is only in trusted environments. In untrusted environments it is
       recommended to derive an application specific ID from this machine ID, in an irreversible
       (cryptographically secure) way. To make this easy <b>sd_id128_get_machine_app_specific()</b> is provided, see
       below.

       <b>sd_id128_get_app_specific()</b> returns a machine ID that is a combination of the <u>base</u> and <u>app_id</u> parameters.
       Internally, this function calculates HMAC-SHA256 of the <u>app_id</u> parameter keyed by the <u>base</u> parameter, and
       truncates this result to fit in sd_id128_t and turns it into a valid Variant 1 Version 4 UUID, in
       accordance with <b>RFC</b> <b>4122</b>[1]. Neither of the two input parameters can be calculated from the output
       parameter <u>ret</u>.

       <b>sd_id128_get_machine_app_specific()</b> is similar to <b>sd_id128_get_machine()</b>, but retrieves a machine ID that
       is specific to the application that is identified by the indicated application ID. It is recommended to
       use this function instead of <b>sd_id128_get_machine()</b> when passing an ID to untrusted environments, in
       order to make sure that the original machine ID may not be determined externally. This way, the ID used
       by the application remains stable on a given machine, but cannot be easily correlated with IDs used in
       other applications on the same machine. The application-specific ID should be generated via a tool like
       <b>systemd-id128</b> <b>new</b>, and may be compiled into the application. This function will return the same
       application-specific ID for each combination of machine ID and application ID. Internally, this function
       calls <b>sd_id128_get_app_specific()</b> with the result from <b>sd_id128_get_machine()</b> and the <u>app_id</u> parameter.

       <b>sd_id128_get_boot()</b> returns the boot ID of the executing kernel. This reads and parses the
       <a href="file:/proc/sys/kernel/random/boot_id">/proc/sys/kernel/random/boot_id</a> file exposed by the kernel. It is randomly generated early at boot and is
       unique for every running kernel instance. See <b><a href="../man4/random.4.html">random</a></b>(4) for more information. This function also
       internally caches the returned ID to make this call a cheap operation. It is recommended to use this ID
       as-is only in trusted environments. In untrusted environments it is recommended to derive an application
       specific ID using <b>sd_id128_get_boot_app_specific()</b>, see below.

       <b>sd_id128_get_boot_app_specific()</b> is analogous to <b>sd_id128_get_machine_app_specific()</b>, but returns an ID
       that changes between boots. Some machines may be used for a long time without rebooting, hence the boot
       ID may remain constant for a long time, and has properties similar to the machine ID during that time.

       <b>sd_id128_get_invocation()</b> returns the invocation ID of the currently executed service. In its current
       implementation, this tries to read and parse the following:

       •   The <u>$INVOCATION_ID</u> environment variable that the service manager sets when activating a service.

       •   An entry in the kernel keyring that the system service manager sets when activating a service.

       See <b><a href="../man5/systemd.exec.5.html">systemd.exec</a></b>(5) for details. The ID is cached internally. In future a different mechanism to
       determine the invocation ID may be added.

       <b>sd_id128_get_invocation_app_specific()</b> derives an application-specific ID from the invocation ID.

       Note that <b>sd_id128_get_machine_app_specific()</b>, <b>sd_id128_get_boot()</b>, <b>sd_id128_get_boot_app_specific()</b>,
       <b>sd_id128_get_invocation()</b> and <b>sd_id128_get_invocation_app_specific</b> always return UUID Variant 1 Version 4
       compatible IDs.  <b>sd_id128_get_machine()</b> will also return a UUID Variant 1 Version 4 compatible ID on new
       installations but might not on older. It is possible to convert the machine ID non-reversibly into a UUID
       Variant 1 Version 4 compatible one. For more information, see <b><a href="../man5/machine-id.5.html">machine-id</a></b>(5). It is hence guaranteed that
       these functions will never return the ID consisting of all zero or all one bits (<b>SD_ID128_NULL</b>,
       <b>SD_ID128_ALLF</b>) — with the possible exception of <b>sd_id128_get_machine()</b>, as mentioned.

       For more information about the "sd_id128_t" type see <b><a href="../man3/sd-id128.3.html">sd-id128</a></b>(3).

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       Those calls return 0 on success (in which case <u>ret</u> is filled in), or a negative errno-style error code.

   <b>Errors</b>
       Returned errors may indicate the following problems:

       <b>-ENOENT</b>
           Returned by <b>sd_id128_get_machine()</b> and <b>sd_id128_get_machine_app_specific()</b> when <a href="file:/etc/machine-id">/etc/machine-id</a> is
           missing.

           Added in version 242.

       <b>-ENOMEDIUM</b>
           Returned by <b>sd_id128_get_machine()</b> and <b>sd_id128_get_machine_app_specific()</b> when <a href="file:/etc/machine-id">/etc/machine-id</a> is
           empty or all zeros. Also returned by <b>sd_id128_get_invocation()</b> when the invocation ID is all zeros.

           Added in version 242.

       <b>-ENOPKG</b>
           Returned by <b>sd_id128_get_machine()</b> and <b>sd_id128_get_machine_app_specific()</b> when the content of
           <a href="file:/etc/machine-id">/etc/machine-id</a> is "uninitialized".

           Added in version 253.

       <b>-ENOSYS</b>
           Returned by <b>sd_id128_get_boot()</b> and <b>sd_id128_get_boot_app_specific()</b> when <a href="file:/proc/">/proc/</a> is not mounted.

           Added in version 253.

       <b>-ENXIO</b>
           Returned by <b>sd_id128_get_invocation()</b> if no invocation ID is set. Also returned by
           <b>sd_id128_get_app_specific()</b>, <b>sd_id128_get_machine_app_specific()</b>, and
           <b>sd_id128_get_boot_app_specific()</b> when the <u>app_id</u> parameter is all zeros.

           Added in version 242.

       <b>-EUCLEAN</b>
           Returned by any of the functions described here when the configured value has invalid format.

           Added in version 253.

       <b>-EPERM</b>
           Requested information could not be retrieved because of insufficient permissions.

           Added in version 242.

</pre><h4><b>NOTES</b></h4><pre>
       Functions described here are available as a shared library, which can be compiled against and linked to
       with the <b>libsystemd</b> <b><a href="../man1/pkg-config.1.html">pkg-config</a></b>(1) file.

       The code described here uses <b><a href="../man3/getenv.3.html">getenv</a></b>(3), which is declared to be not multi-thread-safe. This means that
       the code calling the functions described here must not call <b><a href="../man3/setenv.3.html">setenv</a></b>(3) from a parallel thread. It is
       recommended to only do calls to <b>setenv()</b> from an early phase of the program when no other threads have
       been started.

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>Example</b> <b>1.</b> <b>Application-specific</b> <b>machine</b> <b>ID</b>

       First, generate the application ID:

           $ systemd-id128 -p new
           As string:
           c273277323db454ea63bb96e79b53e97

           As UUID:
           c2732773-23db-454e-a63b-b96e79b53e97

           As man:<a href="../man3/sd-id128.3.html">sd-id128</a>(3) macro:
           #define MESSAGE_XYZ SD_ID128_MAKE(c2,73,27,73,23,db,45,4e,a6,3b,b9,6e,79,b5,3e,97)
           ...

       Then use the new identifier in an example application:

           /* SPDX-License-Identifier: MIT-0 */

           #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
           #include &lt;systemd/sd-id128.h&gt;

           #define OUR_APPLICATION_ID SD_ID128_MAKE(c2,73,27,73,23,db,45,4e,a6,3b,b9,6e,79,b5,3e,97)

           int main(int argc, char *argv[]) {
             sd_id128_t id;
             sd_id128_get_machine_app_specific(OUR_APPLICATION_ID, &amp;id);
             printf("Our application ID: " SD_ID128_FORMAT_STR "\n", SD_ID128_FORMAT_VAL(id));
             return 0;
           }

</pre><h4><b>HISTORY</b></h4><pre>
       <b>sd_id128_get_machine()</b> and <b>sd_id128_get_boot()</b> were added in version 187.

       <b>sd_id128_get_invocation()</b> was added in version 232.

       <b>sd_id128_get_machine_app_specific()</b> was added in version 233.

       <b>sd_id128_get_boot_app_specific()</b> was added in version 240.

       <b>sd_id128_get_app_specific()</b> was added in version 255.

       <b>sd_id128_get_invocation_app_specific()</b> was added in version 256.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/systemd.1.html">systemd</a></b>(1), <b><a href="../man1/systemd-id128.1.html">systemd-id128</a></b>(1), <b><a href="../man3/sd-id128.3.html">sd-id128</a></b>(3), <b><a href="../man5/machine-id.5.html">machine-id</a></b>(5), <b><a href="../man5/systemd.exec.5.html">systemd.exec</a></b>(5), <b><a href="../man3/sd_id128_randomize.3.html">sd_id128_randomize</a></b>(3),
       <b><a href="../man4/random.4.html">random</a></b>(4)

</pre><h4><b>NOTES</b></h4><pre>
        1. RFC 4122
           https://tools.ietf.org/html/rfc4122

systemd 257.7                                                                            <u><a href="../man3/SD_ID128_GET_MACHINE.3.html">SD_ID128_GET_MACHINE</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>