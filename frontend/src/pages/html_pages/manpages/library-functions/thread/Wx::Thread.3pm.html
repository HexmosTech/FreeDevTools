<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thread - using wxPerl with threads</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libwx-perl">libwx-perl_0.9932-9build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Thread - using wxPerl with threads

</pre><h4><b>SYNOPSIS</b></h4><pre>
         # the order of these use()s is important
         use threads;
         use threads::shared;
         use Wx;

         my $DONE_EVENT : shared = Wx::NewEventType;

         my $worker = threads-&gt;create( \&amp;work );

         # create frames, etc
         my $frame = Wx::Frame-&gt;new( ... );
         EVT_COMMAND( $frame, -1, $DONE_EVENT, \&amp;done );
         $app-&gt;MainLoop;

         sub done {
             my( $frame, $event ) = @_;

             print $event-&gt;GetData;
         }

         sub work {
             # ... do stuff, create a shared $result value

             my $threvent = new Wx::PlThreadEvent( -1, $DONE_EVENT, $result );
             Wx::PostEvent( $frame, $threvent );
         }

         # event handler
         sub OnCreateThread {
             # @_ = () is necessary to avoid "Scalars leaked"
             my( $self, $event ) = @_; @_ = ();

             threads-&gt;create( ... );
         }

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Threaded GUI application are somewhat different from non-GUI threaded applications in that the main
       thread (which runs the GUI) must never block.  Also, in wxWidgets, no thread other than the main thread
       can manipulate GUI objects.  This leads to a hybrid model where worker threads must send events to the
       main thread in order to change the GUI state or signal their termination.

   <b>Order</b> <b>of</b> <b>module</b> <b>loading</b>
       It's necessary for "use Wx" to happen after &lt;use threads::shared&gt;.

   <b>Sending</b> <b>events</b> <b>from</b> <b>worker</b> <b>threads</b>
       "Wx::PlThreadEvent" can be used to communicate between worker and GUI threads.  The event can carry a
       <u>shared</u> value between threads.

         my $DONE_EVENT : shared = Wx::NewEventType;

         sub work {
             # ... do some stuff
             my $progress = new Wx::PlThreadEvent( -1, $DONE_EVENT, $progress );
             Wx::PostEvent( $frame, $progress );

             # ... do stuff, create a shared $result value
             my $end = new Wx::PlThreadEvent( -1, $DONE_EVENT, $result );
             Wx::PostEvent( $frame, $end );
         }

       The target of the event can be any "Wx::EvtHandler"

   <b>Receiving</b> <b>events</b> <b>from</b> <b>worker</b> <b>threads</b>
       "Wx::PlThreadEvent" is a command event and can be handled as such.  The "-&gt;GetData" method can be used to
       retrieve the <u>shared</u> data contained inside the event.

         my $DONE_EVENT : shared = Wx::NewEventType;

         EVT_COMMAND( $frame, -1, $DONE_EVENT, \&amp;done );

         sub done {
             my( $frame, $event ) = @_;

             print $event-&gt;GetData;
         }

   <b>Creating</b> <b>new</b> <b>threads</b>
       Creating new threads from event handlers works without problems except from a little snag.  In order not
       to trigger a bug in the Perl interpreter, all event handler that directly or indirectly cause a thread
       creation must clean @_ before starting the thread.

       For example:

         sub OnCreateThread {
             my( $self, $event ) = @_; @_ = ();

             threads-&gt;create( ... );
         }

       failure to do that will cause "scalars leaked" warnings from the Perl interpreter.

perl v5.40.1                                       2025-05-05                                    <u>Wx::<a href="../man3pm/Thread.3pm.html">Thread</a></u>(3pm)
</pre>
 </div>
</div></section>
</div>
</body>
</html>