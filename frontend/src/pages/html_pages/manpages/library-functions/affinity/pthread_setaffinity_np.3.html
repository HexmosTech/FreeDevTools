<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pthread_setaffinity_np, pthread_getaffinity_np - set/get CPU affinity of a thread</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/manpages-dev">manpages-dev_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pthread_setaffinity_np, pthread_getaffinity_np - set/get CPU affinity of a thread

</pre><h4><b>LIBRARY</b></h4><pre>
       POSIX threads library (<u>libpthread</u>, <u>-lpthread</u>)

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#define</b> <b>_GNU_SOURCE</b>             /* See <a href="../man7/feature_test_macros.7.html">feature_test_macros</a>(7) */
       <b>#include</b> <b>&lt;<a href="file:/usr/include/pthread.h">pthread.h</a>&gt;</b>

       <b>int</b> <b>pthread_setaffinity_np(pthread_t</b> <u>thread</u><b>,</b> <b>size_t</b> <u>cpusetsize</u><b>,</b>
                                  <b>const</b> <b>cpu_set_t</b> <b>*</b><u>cpuset</u><b>);</b>
       <b>int</b> <b>pthread_getaffinity_np(pthread_t</b> <u>thread</u><b>,</b> <b>size_t</b> <u>cpusetsize</u><b>,</b>
                                  <b>cpu_set_t</b> <b>*</b><u>cpuset</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>pthread_setaffinity_np</b>()  function  sets  the  CPU affinity mask of the thread <u>thread</u> to the CPU set
       pointed to by <u>cpuset</u>.  If the call is successful, and the thread is not currently running on one  of  the
       CPUs in <u>cpuset</u>, then it is migrated to one of those CPUs.

       The  <b>pthread_getaffinity_np</b>()  function  returns the CPU affinity mask of the thread <u>thread</u> in the buffer
       pointed to by <u>cpuset</u>.

       For more details on CPU affinity masks, see <b><a href="../man2/sched_setaffinity.2.html">sched_setaffinity</a></b>(2).  For a description of a set  of  macros
       that can be used to manipulate and inspect CPU sets, see <b><a href="../man3/CPU_SET.3.html">CPU_SET</a></b>(3).

       The  argument  <u>cpusetsize</u>  is  the length (in bytes) of the buffer pointed to by <u>cpuset</u>.  Typically, this
       argument would be specified as <u>sizeof(cpu_set_t)</u>.  (It may be some  other  value,  if  using  the  macros
       described in <b><a href="../man3/CPU_SET.3.html">CPU_SET</a></b>(3) for dynamically allocating a CPU set.)

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       On success, these functions return 0; on error, they return a nonzero error number.

</pre><h4><b>ERRORS</b></h4><pre>
       <b>EFAULT</b> A supplied memory address was invalid.

       <b>EINVAL</b> (<b>pthread_setaffinity_np</b>())  The  affinity  bit mask <u>mask</u> contains no processors that are currently
              physically on the system and permitted to the thread according to any  restrictions  that  may  be
              imposed by the "cpuset" mechanism described in <b><a href="../man7/cpuset.7.html">cpuset</a></b>(7).

       <b>EINVAL</b> (<b>pthread_setaffinity_np</b>())  <u>cpuset</u>  specified  a  CPU  that  was  outside the set supported by the
              kernel.  (The kernel configuration option <b>CONFIG_NR_CPUS</b> defines the range of the set supported by
              the kernel data type used to represent CPU sets.)

       <b>EINVAL</b> (<b>pthread_getaffinity_np</b>()) <u>cpusetsize</u> is smaller than the size of the affinity mask  used  by  the
              kernel.

       <b>ESRCH</b>  No thread with the ID <u>thread</u> could be found.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       For an explanation of the terms used in this section, see <b><a href="../man7/attributes.7.html">attributes</a></b>(7).
       ┌─────────────────────────────────────────────────────────────────────────────┬───────────────┬─────────┐
       │ <b>Interface</b>                                                                   │ <b>Attribute</b>     │ <b>Value</b>   │
       ├─────────────────────────────────────────────────────────────────────────────┼───────────────┼─────────┤
       │ <b>pthread_setaffinity_np</b>(), <b>pthread_getaffinity_np</b>()                          │ Thread safety │ MT-Safe │
       └─────────────────────────────────────────────────────────────────────────────┴───────────────┴─────────┘

</pre><h4><b>STANDARDS</b></h4><pre>
       GNU; hence the suffix "_np" (nonportable) in the names.

</pre><h4><b>HISTORY</b></h4><pre>
       glibc 2.3.4.

       In  glibc  2.3.3 only, versions of these functions were provided that did not have a <u>cpusetsize</u> argument.
       Instead the CPU set size given to the underlying system calls was always <u>sizeof(cpu_set_t)</u>.

</pre><h4><b>NOTES</b></h4><pre>
       After a call to <b>pthread_setaffinity_np</b>(), the set of CPUs on which the thread will actually  run  is  the
       intersection  of  the  set  specified  in the <u>cpuset</u> argument and the set of CPUs actually present on the
       system.  The system may further restrict the set of CPUs  on  which  the  thread  runs  if  the  "cpuset"
       mechanism  described  in  <b><a href="../man7/cpuset.7.html">cpuset</a></b>(7) is being used.  These restrictions on the actual set of CPUs on which
       the thread will run are silently imposed by the kernel.

       These functions are implemented on top of the <b><a href="../man2/sched_setaffinity.2.html">sched_setaffinity</a></b>(2) and <b><a href="../man2/sched_getaffinity.2.html">sched_getaffinity</a></b>(2) system calls.

       A new thread created by <b><a href="../man3/pthread_create.3.html">pthread_create</a></b>(3) inherits a copy of its creator's CPU affinity mask.

</pre><h4><b>EXAMPLES</b></h4><pre>
       In the following program, the main thread uses <b>pthread_setaffinity_np</b>() to set its CPU affinity  mask  to
       include   CPUs   0   to   7   (which   may   not  all  be  available  on  the  system),  and  then  calls
       <b>pthread_getaffinity_np</b>() to check the resulting CPU affinity mask of the thread.

       #define _GNU_SOURCE
       #include &lt;<a href="file:/usr/include/err.h">err.h</a>&gt;
       #include &lt;<a href="file:/usr/include/errno.h">errno.h</a>&gt;
       #include &lt;<a href="file:/usr/include/pthread.h">pthread.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdio.h">stdio.h</a>&gt;
       #include &lt;<a href="file:/usr/include/stdlib.h">stdlib.h</a>&gt;

       int
       main(void)
       {
           int s;
           cpu_set_t cpuset;
           pthread_t thread;

           thread = pthread_self();

           /* Set affinity mask to include CPUs 0 to 7. */

           CPU_ZERO(&amp;cpuset);
           for (size_t j = 0; j &lt; 8; j++)
               CPU_SET(j, &amp;cpuset);

           s = pthread_setaffinity_np(thread, sizeof(cpuset), &amp;cpuset);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_setaffinity_np");

           /* Check the actual affinity mask assigned to the thread. */

           s = pthread_getaffinity_np(thread, sizeof(cpuset), &amp;cpuset);
           if (s != 0)
               errc(EXIT_FAILURE, s, "pthread_getaffinity_np");

           printf("Set returned by pthread_getaffinity_np() contained:\n");
           for (size_t j = 0; j &lt; CPU_SETSIZE; j++)
               if (CPU_ISSET(j, &amp;cpuset))
                   printf("    CPU %zu\n", j);

           exit(EXIT_SUCCESS);
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man2/sched_setaffinity.2.html">sched_setaffinity</a></b>(2),  <b><a href="../man3/CPU_SET.3.html">CPU_SET</a></b>(3),  <b><a href="../man3/pthread_attr_setaffinity_np.3.html">pthread_attr_setaffinity_np</a></b>(3),   <b><a href="../man3/pthread_self.3.html">pthread_self</a></b>(3),   <b><a href="../man3/sched_getcpu.3.html">sched_getcpu</a></b>(3),
       <b><a href="../man7/cpuset.7.html">cpuset</a></b>(7), <b><a href="../man7/pthreads.7.html">pthreads</a></b>(7), <b><a href="../man7/sched.7.html">sched</a></b>(7)

Linux man-pages 6.9.1                              2024-06-15                          <u><a href="../man3/pthread_setaffinity_np.3.html">pthread_setaffinity_np</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>