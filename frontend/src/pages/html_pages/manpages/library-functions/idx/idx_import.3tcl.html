<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>doctools::idx::import - Importing keyword indices</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tcllib">tcllib_2.0+dfsg-4_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       doctools::idx::import - Importing keyword indices

</pre><h4><b>SYNOPSIS</b></h4><pre>
       package require <b>doctools::idx::import</b> <b>?0.2.2?</b>

       package require <b>Tcl</b> <b>8.5</b> <b>9</b>

       package require <b>struct::map</b>

       package require <b>doctools::idx::structure</b>

       package require <b>snit</b>

       package require <b>pluginmgr</b>

       <b>::doctools::idx::import</b> <u>objectName</u>

       <b>objectName</b> <b>method</b> ?<u>arg</u> <u>arg</u> <u>...</u>?

       <u>objectName</u> <b>destroy</b>

       <u>objectName</u> <b>import</b> <b>text</b> <u>text</u> ?<u>format</u>?

       <u>objectName</u> <b>import</b> <b>file</b> <u>path</u> ?<u>format</u>?

       <u>objectName</u> <b>import</b> <b>object</b> <b>text</b> <u>object</u> <u>text</u> ?<u>format</u>?

       <u>objectName</u> <b>import</b> <b>object</b> <b>file</b> <u>object</u> <u>path</u> ?<u>format</u>?

       <u>objectName</u> <b>config</b> <b>names</b>

       <u>objectName</u> <b>config</b> <b>get</b>

       <u>objectName</u> <b>config</b> <b>set</b> <u>name</u> ?<u>value</u>?

       <u>objectName</u> <b>config</b> <b>unset</b> <u>pattern</u>...

       <u>objectName</u> <b>includes</b>

       <u>objectName</u> <b>include</b> <b>add</b> <u>path</u>

       <u>objectName</u> <b>include</b> <b>remove</b> <u>path</u>

       <u>objectName</u> <b>include</b> <b>clear</b>

       <b>IncludeFile</b> <u>currentfile</u> <u>path</u>

       <b>import</b> <u>text</u> <u>configuration</u>

________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This package provides a class to manage the plugins for the import of keyword indices from other formats,
       i.e. their conversion from, for example <u>docidx</u>, <u>json</u>, etc.

       This  is  one  of  the  three  public pillars the management of keyword indices resides on. The other two
       pillars are

       [1]    <u>Exporting</u> <u>keyword</u> <u>indices</u>, and

       [2]    <u>Holding</u> <u>keyword</u> <u>indices</u>

       For information about the <b>Concepts</b> of keyword indices, and their parts, see the same-named section.   For
       information  about  the  data structure which is the major output of the manager objects provided by this
       package see the section <b>Keyword</b> <b>index</b> <b>serialization</b> <b>format</b>.

       The plugin system of our class is based on the package <b>pluginmgr</b>, and  configured  to  look  for  plugins
       using

       [1]    the environment variable <b>DOCTOOLS_IDX_IMPORT_PLUGINS</b>,

       [2]    the environment variable <b>DOCTOOLS_IDX_PLUGINS</b>,

       [3]    the environment variable <b>DOCTOOLS_PLUGINS</b>,

       [4]    the path "<u><a href="file:~/.doctools/idx/import/plugin">~/.doctools/idx/import/plugin</a></u>"

       [5]    the path "<u><a href="file:~/.doctools/idx/plugin">~/.doctools/idx/plugin</a></u>"

       [6]    the path "<u><a href="file:~/.doctools/plugin">~/.doctools/plugin</a></u>"

       [7]    the path "<u><a href="file:~/.doctools/idx/import/plugins">~/.doctools/idx/import/plugins</a></u>"

       [8]    the path "<u><a href="file:~/.doctools/idx/plugins">~/.doctools/idx/plugins</a></u>"

       [9]    the path "<u><a href="file:~/.doctools/plugins">~/.doctools/plugins</a></u>"

       [10]   the registry entry "HKEY_CURRENT_USER\SOFTWARE\DOCTOOLS\IDX\IMPORT\PLUGINS"

       [11]   the registry entry "HKEY_CURRENT_USER\SOFTWARE\DOCTOOLS\IDX\PLUGINS"

       [12]   the registry entry "HKEY_CURRENT_USER\SOFTWARE\DOCTOOLS\PLUGINS"

       The last three are used only when the package is run on a machine using Windows(tm) operating system.

       The whole system is delivered with two predefined import plugins, namely

       docidx See <u>docidx</u> <u>import</u> <u>plugin</u> for details.

       json   See <u>json</u> <u>import</u> <u>plugin</u> for details.

       Readers  wishing  to  write  their  own  import  plugin for some format, i.e.  <u>plugin</u> <u>writer</u>s reading and
       understanding the section containing the <b>Import</b> <b>plugin</b> <b>API</b> <b>v2</b> <b>reference</b> is an absolute necessity,  as  it
       specifies the interaction between this package and its plugins in detail.

</pre><h4><b>CONCEPTS</b></h4><pre>
       [1]    A <u>keyword</u> <u>index</u> consists of a (possibly empty) set of <u>keywords</u>.

       [2]    Each keyword in the set is identified by its name.

       [3]    Each keyword has a (possibly empty) set of <u>references</u>.

       [4]    A reference can be associated with more than one keyword.

       [5]    A reference not associated with at least one keyword is not possible however.

       [6]    Each  reference  is  identified  by  its  target, specified as either an url or symbolic filename,
              depending on the type of reference (<b>url</b>, or <b>manpage</b>).

       [7]    The type of a reference (url, or manpage) depends only  on  the  reference  itself,  and  not  the
              keywords it is associated with.

       [8]    In  addition  to a type each reference has a descriptive label as well. This label depends only on
              the reference itself, and not the keywords it is associated with.

       A few notes

       [1]    Manpage references are intended to be used for references to the documents the index is made  for.
              Their  target  is  a  symbolic  file name identifying the document, and export plugins may replace
              symbolic with actual file names, if specified.

       [2]    Url references are intended on the othre hand are inteded to be used for links to  anything  else,
              like websites. Their target is an url.

       [3]    While  url  and  manpage  references  share  a  namespace for their identifiers, this should be no
              problem, given that manpage identifiers are symbolic filenames and as such they should never  look
              like urls, the identifiers for url references.

</pre><h4><b>API</b></h4><pre>
   <b>PACKAGE</b> <b>COMMANDS</b>
       <b>::doctools::idx::import</b> <u>objectName</u>
              This  command  creates  a  new  import manager object with an associated Tcl command whose name is
              <u>objectName</u>. This <u>object</u> command is explained in full detail in the  sections  <b>Object</b>  <b>command</b>  and
              <b>Object</b>  <b>methods</b>.  The object command will be created under the current namespace if the <u>objectName</u>
              is not fully qualified, and in the specified namespace otherwise.

   <b>OBJECT</b> <b>COMMAND</b>
       All objects created by the <b>::doctools::idx::import</b> command have the following general form:

       <b>objectName</b> <b>method</b> ?<u>arg</u> <u>arg</u> <u>...</u>?
              The method <b>method</b> and its <u>arg</u>'uments determine the exact behavior of  the  command.   See  section
              <b>Object</b> <b>methods</b> for the detailed specifications.

   <b>OBJECT</b> <b>METHODS</b>
       <u>objectName</u> <b>destroy</b>
              This method destroys the object it is invoked for.

       <u>objectName</u> <b>import</b> <b>text</b> <u>text</u> ?<u>format</u>?
              This  method  takes  the  <u>text</u>  and  converts  it  from  the  specified  <u>format</u>  to  the canonical
              serialization of a keyword index using the import plugin for the format. An error is thrown if  no
              plugin  could  be  found for the format.  The serialization generated by the conversion process is
              returned as the result of this method.

              If no format is specified the method defaults to <b>docidx</b>.

              The specification of what a <u>canonical</u> serialization is can be found in the section  <b>Keyword</b>  <b>index</b>
              <b>serialization</b> <b>format</b>.

              The plugin has to conform to the interface specified in section <b>Import</b> <b>plugin</b> <b>API</b> <b>v2</b> <b>reference</b>.

       <u>objectName</u> <b>import</b> <b>file</b> <u>path</u> ?<u>format</u>?
              This  method is a convenient wrapper around the <b>import</b> <b>text</b> method described by the previous item.
              It reads the contents of the specified file into memory, feeds the result  into  <b>import</b>  <b>text</b>  and
              returns the resulting serialization as its own result.

       <u>objectName</u> <b>import</b> <b>object</b> <b>text</b> <u>object</u> <u>text</u> ?<u>format</u>?
              This  method is a convenient wrapper around the <b>import</b> <b>text</b> method described by the previous item.
              It expects that <u>object</u> is  an  object  command  supporting  a  <b>deserialize</b>  method  expecting  the
              canonical  serialization of a keyword index.  It imports the text using <b>import</b> <b>text</b> and then feeds
              the resulting serialization into the <u>object</u> via <b>deserialize</b>.  This method returns the empty string
              as it result.

       <u>objectName</u> <b>import</b> <b>object</b> <b>file</b> <u>object</u> <u>path</u> ?<u>format</u>?
              This method behaves like <b>import</b> <b>object</b> <b>text</b>, except that it reads the text  to  convert  from  the
              specified file instead of being given it as argument.

       <u>objectName</u> <b>config</b> <b>names</b>
              This  method returns a list containing the names of all configuration variables currently known to
              the object.

       <u>objectName</u> <b>config</b> <b>get</b>
              This method returns a dictionary containing the names and values of  all  configuration  variables
              currently known to the object.

       <u>objectName</u> <b>config</b> <b>set</b> <u>name</u> ?<u>value</u>?
              This  method sets the configuration variable <u>name</u> to the specified <u>value</u> and returns the new value
              of the variable.

              If no value is specified it simply returns the current value, without changing it.

              Note that while the user can set the predefined configuration variables <b>user</b> and <b>format</b>  doing  so
              will have no effect, these values will be internally overridden when invoking an import plugin.

       <u>objectName</u> <b>config</b> <b>unset</b> <u>pattern</u>...
              This method unsets all configuration variables matching the specified glob <u>pattern</u>s. If no pattern
              is specified it will unset all currently defined configuration variables.

       <u>objectName</u> <b>includes</b>
              This  method  returns a list containing the currently specified paths to use to search for include
              files when processing input.  The order of paths in the list corresponds to  the  order  in  which
              they  are  used, from first to last, and also corresponds to the order in which they were added to
              the object.

       <u>objectName</u> <b>include</b> <b>add</b> <u>path</u>
              This methods adds the specified <u>path</u> to the list of paths to use to search for include files  when
              processing  input.  The  path is added to the end of the list, causing it to be searched after all
              previously added paths. The result of the command is the empty string.

              The method does nothing if the path is already known.

       <u>objectName</u> <b>include</b> <b>remove</b> <u>path</u>
              This methods removes the specified <u>path</u> from the list of paths to use to search for include  files
              when processing input. The result of the command is the empty string.

              The method does nothing if the path is not known.

       <u>objectName</u> <b>include</b> <b>clear</b>
              This method clears the list of paths to use to search for include files when processing input. The
              result of the command is the empty string.

</pre><h4><b>IMPORT</b> <b>PLUGIN</b> <b>API</b> <b>V2</b> <b>REFERENCE</b></h4><pre>
       Plugins  are  what  this package uses to manage the support for any input format beyond the <b>Keyword</b> <b>index</b>
       <b>serialization</b> <b>format</b>. Here we specify the API the objects created by this package use  to  interact  with
       their plugins.

       A plugin for this package has to follow the rules listed below:

       [1]    A plugin is a package.

       [2]    The name of a plugin package has the form doctools::idx::import::<b>FOO</b>, where <b>FOO</b> is the name of the
              format  the  plugin  will  generate  output  for. This name is also the argument to provide to the
              various <b>import</b> methods of import manager objects to get a string encoding a keyword index in  that
              format.

       [3]    The plugin can expect that the package <b>doctools::idx::export::plugin</b> is present, as indicator that
              it was invoked from a genuine plugin manager.

       [4]    The plugin can expect that a command named <b>IncludeFile</b> is present, with the signature

              <b>IncludeFile</b> <u>currentfile</u> <u>path</u>
                     This  command  has  to be invoked by the plugin when it has to process an included file, if
                     the format has the concept of such. An example of such a format would be <u>docidx</u>.

                     The plugin has to supply the following arguments

                     string <u>currentfile</u>
                            The path of the file it is currently processing. This may be the empty string if  no
                            such is known.

                     string <u>path</u>
                            The path of the include file as specified in the include directive being processed.

                     The result of the command will be a 5-element list containing

                     [1]    A boolean flag indicating the success (<b>True</b>) or failure (<b>False</b>) of the operation.

                     [2]    In  case  of  success  the  contents  of  the  included  file,  and the empty string
                            otherwise.

                     [3]    The resolved, i.e. absolute path of the included file, if possible, or the unchanged
                            <u>path</u> argument. This is for display in  an  error  message,  or  as  the  <u>currentfile</u>
                            argument of another call to <b>IncludeFile</b> should this file contain more files.

                     [4]    In case of success an empty string, and for failure a code indicating the reason for
                            it, one of

                            notfound
                                   The specified file could not be found.

                            notread
                                   The specified file was found, but not be read into memory.

                     [5]    An  empty  string  in case of success of a <b>notfound</b> failure, and an additional error
                            message describing the reason for a <b>notread</b> error in more detail.

       [5]    A plugin has to provide one command, with the signature shown below.

              <b>import</b> <u>text</u> <u>configuration</u>
                     Whenever an import manager of <b>doctools::idx</b> has to parse input for an index it will  invoke
                     this command.

                     string <u>text</u>
                            This  argument will contain the text encoding the index per the format the plugin is
                            for.

                     dictionary <u>configuration</u>
                            This argument will contain the current configuration to apply to the parsing,  as  a
                            dictionary mapping from variable names to values.

                            The  following configuration variables have a predefined meaning all plugins have to
                            obey, although they can ignore this information at their discretion. Any other other
                            configuration variables recognized by a plugin will be described in the manpage  for
                            that plugin.

                            user   This  variable is expected to contain the name of the user owning the process
                                   invoking the plugin.

                            format This variable is expected to contain the name of the format whose  plugin  is
                                   invoked.

       [6]    A  single usage cycle of a plugin consists of the invokations of the command <b>import</b>. This call has
              to leave the plugin in a state where another usage cycle can be run without problems.

</pre><h4><b>KEYWORD</b> <b>INDEX</b> <b>SERIALIZATION</b> <b>FORMAT</b></h4><pre>
       Here we specify the format used by the doctools v2 packages to serialize  keyword  indices  as  immutable
       values for transport, comparison, etc.

       We distinguish between <u>regular</u> and <u>canonical</u> serializations. While a keyword index may have more than one
       regular serialization only exactly one of them will be <u>canonical</u>.

       regular serialization

              [1]    An index serialization is a nested Tcl dictionary.

              [2]    This  dictionary  holds  a  single  key, <b>doctools::idx</b>, and its value. This value holds the
                     contents of the index.

              [3]    The contents of the index are a Tcl dictionary holding the title of the index, a label, and
                     the keywords and references. The relevant keys and their values are

                     <b>title</b>  The value is a string containing the title of the index.

                     <b>label</b>  The value is a string containing a label for the index.

                     <b>keywords</b>
                            The value is a Tcl dictionary, using the keywords known to the index  as  keys.  The
                            associated  values are lists containing the identifiers of the references associated
                            with that particular keyword.

                            Any reference identifier used in these lists has to exist as a key in the <b>references</b>
                            dictionary, see the next item for its definition.

                     <b>references</b>
                            The value is a Tcl dictionary, using the identifiers for the references known to the
                            index as keys. The associated values are 2-element lists  containing  the  type  and
                            label of the reference, in this order.

                            Any  key here has to be associated with at least one keyword, i.e. occur in at least
                            one of the reference lists which are the values  in  the  <b>keywords</b>  dictionary,  see
                            previous item for its definition.

              [4]    The <u>type</u> of a reference can be one of two values,

                     <b>manpage</b>
                            The  identifier  of the reference is interpreted as symbolic file name, referring to
                            one of the documents the index was made for.

                     <b>url</b>    The identifier of the reference is interpreted as an url, referring to some external
                            location, like a website, etc.

       canonical serialization
              The canonical serialization of a keyword index has the format as specified in the  previous  item,
              and then additionally satisfies the constraints below, which make it unique among all the possible
              serializations of the keyword index.

              [1]    The keys found in all the nested Tcl dictionaries are sorted in ascending dictionary order,
                     as generated by Tcl's builtin command <b>lsort</b> <b>-increasing</b> <b>-dict</b>.

              [2]    The  references  listed  for  each  keyword  of  the index, if any, are listed in ascending
                     dictionary order of their <u>labels</u>, as generated by Tcl's builtin command  <b>lsort</b>  <b>-increasing</b>
                     <b>-dict</b>.

</pre><h4><b>BUGS,</b> <b>IDEAS,</b> <b>FEEDBACK</b></h4><pre>
       This  document,  and  the package it describes, will undoubtedly contain bugs and other problems.  Please
       report such in the category  <u>doctools</u>  of  the  <u>Tcllib</u>  <u>Trackers</u>  [<a href="http://core.tcl.tk/tcllib/reportlist">http://core.tcl.tk/tcllib/reportlist</a>].
       Please also report any ideas for enhancements you may have for either package and/or documentation.

       When proposing code changes, please provide <u>unified</u> <u>diffs</u>, i.e the output of <b>diff</b> <b>-u</b>.

       Note  further  that  <u>attachments</u>  are strongly preferred over inlined patches. Attachments can be made by
       going to the <b>Edit</b> form of the ticket immediately after its creation, and then using the left-most  button
       in the secondary navigation bar.

</pre><h4><b>KEYWORDS</b></h4><pre>
       conversion,  docidx, documentation, import, index, json, keyword index, manpage, markup, parsing, plugin,
       reference, url

</pre><h4><b>CATEGORY</b></h4><pre>
       Documentation tools

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright (c) 2009-2019 Andreas Kupries &lt;<a href="mailto:andreas_kupries@users.sourceforge.net">andreas_kupries@users.sourceforge.net</a>&gt;

tcllib                                                0.2.2                          <u>doctools::idx::<a href="../man3tcl/import.3tcl.html">import</a></u>(3tcl)
</pre>
 </div>
</div></section>
</div>
</body>
</html>