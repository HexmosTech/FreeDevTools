<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sc::IntMolecularCoor - The IntMolecularCoor abstract class describes a molecule's coordinates in terms of</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/libsc-doc">libsc-doc_2.3.1-21_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sc::IntMolecularCoor - The <b>IntMolecularCoor</b> abstract class describes a molecule's coordinates in terms of
       internal coordinates.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       #include &lt;coor.h&gt;

       Inherits <b>sc::MolecularCoor</b>.

       Inherited by <b>sc::RedundMolecularCoor</b>, and <b>sc::SymmMolecularCoor</b>.

   <b>Public</b> <b>Member</b> <b>Functions</b>
       <b>IntMolecularCoor</b> (<b>StateIn</b> &amp;)
       <b>IntMolecularCoor</b> (<b>Ref</b>&lt; <b>Molecule</b> &gt; &amp;mol)
       <b>IntMolecularCoor</b> (const <b>Ref</b>&lt; <b>KeyVal</b> &gt; &amp;)
           The <b>KeyVal</b> constructor.
       void <b>save_data_state</b> (<b>StateOut</b> &amp;)
           Save the base classes (with save_data_state) and the members in the same order that the <b>StateIn</b> CTOR
           initializes them.
       virtual void <b>form_coordinates</b> (int keep_variable=0)=0
           Actually form the variable and constant internal coordinates from the simple internal coordinates.
       virtual int <b>all_to_cartesian</b> (const <b>Ref</b>&lt; <b>Molecule</b> &gt; &amp;, <b>RefSCVector</b> &amp;internal)
           Like to_cartesians(), except all internal coordinates are considered, not just the variable ones.
       virtual int <b>all_to_internal</b> (const <b>Ref</b>&lt; <b>Molecule</b> &gt; &amp;, <b>RefSCVector</b> &amp;internal)
           Like <b>to_internal()</b>, except all internal coordinates are considered, not just the variable ones.
       virtual <b>RefSCDimension</b> <b>dim</b> ()
           These implement the virtual functions inherited from <b>MolecularCoor</b>.
       virtual int <b>to_cartesian</b> (const <b>Ref</b>&lt; <b>Molecule</b> &gt; &amp;, const <b>RefSCVector</b> &amp;internal)
       virtual int <b>to_internal</b> (<b>RefSCVector</b> &amp;internal)
           Fill in the vector ``internal'' with the current internal coordinates.
       virtual int <b>to_cartesian</b> (<b>RefSCVector</b> &amp;cartesian, <b>RefSCVector</b> &amp;internal)
           Convert the internal coordinate gradients in ``internal'' to Cartesian coordinates and copy these
           Cartesian coordinate gradients to ``cartesian''.
       virtual int <b>to_internal</b> (<b>RefSCVector</b> &amp;internal, <b>RefSCVector</b> &amp;cartesian)
           Convert the Cartesian coordinate gradients in ``cartesian'' to internal coordinates and copy these
           internal coordinate gradients to ``internal''.
       virtual int <b>to_cartesian</b> (<b>RefSymmSCMatrix</b> &amp;cart, <b>RefSymmSCMatrix</b> &amp;internal)
           Convert the internal coordinate Hessian internal'' to Cartesian coordinates and copy the result
           tocartesian''.
       virtual int <b>to_internal</b> (<b>RefSymmSCMatrix</b> &amp;internal, <b>RefSymmSCMatrix</b> &amp;cart)
           Convert the Cartesian coordinate Hessian cartesian'' to internal coordinates and copy the result
           tointernal''.
       virtual void <b>print</b> (std::ostream &amp;=<b>ExEnv::out0</b>()) const
           Print the coordinate.
       virtual void <b>print_simples</b> (std::ostream &amp;=<b>ExEnv::out0</b>()) const
       virtual void <b>print_variable</b> (std::ostream &amp;=<b>ExEnv::out0</b>()) const
       virtual void <b>print_constant</b> (std::ostream &amp;=<b>ExEnv::out0</b>()) const
       int <b>nconstrained</b> ()
           Returns the number of constrained coordinates.

   <b>Protected</b> <b>Member</b> <b>Functions</b>
       void <b>form_K_matrix</b> (<b>RefSCDimension</b> &amp;dredundant, <b>RefSCDimension</b> &amp;dfixed, <b>RefSCMatrix</b> &amp;K, int
           *&amp;is_totally_symmetric)
       virtual void <b>init</b> ()
           This is called by the constructors of classes derived from <b>IntMolecularCoor</b>.
       virtual void <b>new_coords</b> ()
           Allocates memory for the <b>SetIntCoor</b>'s used to store the simple and internal coordinates.
       virtual void <b>read_keyval</b> (const <b>Ref</b>&lt; <b>KeyVal</b> &gt; &amp;)
           Reads the <b>KeyVal</b> input.

   <b>Protected</b> <b>Attributes</b>
       <b>Ref</b>&lt; <b>IntCoorGen</b> &gt; <b>generator_</b>
       <b>RefSCDimension</b> <b>dim_</b>
       <b>RefSCDimension</b> <b>dvc_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>variable_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>constant_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>fixed_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>watched_</b>
       <b>Ref</b>&lt; <b>IntCoor</b> &gt; <b>followed_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>bonds_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>bends_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>tors_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>outs_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>extras_</b>
       <b>Ref</b>&lt; <b>SetIntCoor</b> &gt; <b>all_</b>
       int <b>update_bmat_</b>
       int <b>only_totally_symmetric_</b>
       double <b>symmetry_tolerance_</b>
       double <b>simple_tolerance_</b>
       double <b>coordinate_tolerance_</b>
       double <b>cartesian_tolerance_</b>
       double <b>scale_bonds_</b>
       double <b>scale_bends_</b>
       double <b>scale_tors_</b>
       double <b>scale_outs_</b>
       int <b>nextra_bonds_</b>
       int * <b>extra_bonds_</b>
       int <b>given_fixed_values_</b>
       int <b>decouple_bonds_</b>
       int <b>decouple_bends_</b>
       int <b>max_update_steps_</b>
       double <b>max_update_disp_</b>
       int <b>form_print_simples_</b>
       int <b>form_print_variable_</b>
       int <b>form_print_constant_</b>
       int <b>form_print_molecule_</b>

   <b>Additional</b> <b>Inherited</b> <b>Members</b>
</pre><h4><b>Detailed</b> <b>Description</b></h4><pre>
       The <b>IntMolecularCoor</b> abstract class describes a molecule's coordinates in terms of internal coordinates.

</pre><h4><b>Constructor</b> <b>&amp;</b> <b>Destructor</b> <b>Documentation</b></h4><pre>
   <b>sc::IntMolecularCoor::IntMolecularCoor</b> <b>(const</b> <b>Ref&lt;</b> <b>KeyVal</b> <b>&gt;</b> <b>&amp;)</b>
       The <b>KeyVal</b> constructor.

       <b>variable</b>
           Gives  a <b>SetIntCoor</b> object that specifies the internal coordinates that can be varied. If this is not
           given, the variable coordinates will be generated.

       <b>followed</b>
           Gives a <b>IntCoor</b> object that specifies a coordinate to used as the first coordinate  in  the  variable
           coordinate  list.  The  remaining  coordinates  will  be  automatically  generated. The default is no
           followed coordinate. This option is usually used to set the initial search direction for a transition
           state optimization, where it is used in conjunction with  the  mode_following  keyword  read  by  the
           <b>EFCOpt</b> class.

       <b>fixed</b>
           Gives  a <b>SetIntCoor</b> object that specifies the internal coordinates that will be fixed. The default is
           no fixed coordinates.

       <b>watched</b>
           Gives a <b>SetIntCoor</b> object that specifies internal coordinates that will be printed out  whenever  the
           coordinates are changed. The default is none.

       <b>have_fixed_values</b>
           If  true, then values for the fixed coordinates must be given in fixed and an attempt will be made to
           displace the initial geometry to the given fixed values. The default is false.

       <b>extra_bonds</b>
           This is only read if the generator keyword is not given. It  is  a  vector  of  atom  numbers,  where
           elements  $(i-1)imes  2  +  1$ and $iimes 2$ specify the atoms which are bound in extra bond $i$. The
           extra_bonds keyword should only be needed for weakly interacting fragments, otherwise all the  needed
           bonds will be found.

       <b>generator</b>
           Specifies  an  <b>IntCoorGen</b> object that creates simple, redundant internal coordinates. If this keyword
           is not given, then a vector giving extra bonds to be added is read from extra_bonds and this is  used
           to create an <b>IntCoorGen</b> object.

       <b>decouple_bonds</b>
           Automatically  generated  internal  coordinates are linear combinations of possibly any mix of simple
           internal coordinates. If decouple_bonds is true, an attempt will be made to form some of the internal
           coordinates from just stretch simple coordinates. The default is false.

       <b>decouple_bends</b>
           This is like decouple_bonds except it applies to the bend-like coordinates. The default is false.

       <b>max_update_disp</b>
           The maximum displacement to be used in the displacement to fixed internal coordinates values.  Larger
           displacements  will  be  broken into several smaller displacements and new coordinates will be formed
           for each of these displacments. This is only used when fixed and  have_fixed_values  are  given.  The
           default is 0.5.

       <b>max_update_steps</b>
           The  maximum  number  of  steps  permitted  to convert internal coordinate displacements to cartesian
           coordinate displacements. The default is 100.

       <b>update_bmat</b>
           Displacements in internal coordinates are converted to  a  cartesian  displacements  iteratively.  If
           there  are  large  changes  in  the  cartesian  coordinates during conversion, then recompute the $B$
           matrix, which is using to do the conversion. The default is false.

       <b>only_totally_symmetric</b>
           If a simple test reveals that an internal coordinate is not totally symmetric, then it  will  not  be
           added to the internal coordinate list. The default is true.

       <b>simple_tolerance</b>
           The internal coordinates are formed as linear combinations of simple, redundant internal coordinates.
           Coordinates with coefficients smaller then simple_tolerance will be omitted. The default is 1.0e-3.

       <b>cartesian_tolerance</b>
           The  tolerance  for  conversion  of internal coordinate displacements to cartesian displacements. The
           default is 1.0e-12.

       <b>form:print_simple</b>
           Print the simple internal coordinates. The default is false.

       <b>form:print_variable</b>
           Print the variable internal coordinates. The default is false.

       <b>form:print_constant</b>
           Print the constant internal coordinates. The default is false.

       <b>form:print_molecule</b>
           Print the molecule when forming coordinates. The default is false.

       <b>scale_bonds</b>
           Obsolete. The default value is 1.0.

       <b>scale_bends</b>
           Obsolete. The default value is 1.0.

       <b>scale_tors</b>
           Obsolete. The default value is 1.0.

       <b>scale_outs</b>
           Obsolete. The default value is 1.0.

       <b>symmetry_tolerance</b>
           Obsolete. The default is 1.0e-5.

       <b>coordinate_tolerance</b>
           Obsolete. The default is 1.0e-7.

</pre><h4><b>Member</b> <b>Function</b> <b>Documentation</b></h4><pre>
   <b>virtual</b> <b>void</b> <b>sc::IntMolecularCoor::init</b> <b>()</b> <b>[protected],</b>  <b>[virtual]</b>
       This is called by the constructors of classes derived from <b>IntMolecularCoor</b>. It initialized the lists  of
       simple internal coordinates, and then calls the <b>form_coordinates()</b> member.

       Reimplemented in <b>sc::SymmMolecularCoor</b>.

   <b>void</b> <b>sc::IntMolecularCoor::save_data_state</b> <b>(StateOut</b> <b>&amp;)</b> <b>[virtual]</b>
       Save  the  base  classes  (with  save_data_state) and the members in the same order that the <b>StateIn</b> CTOR
       initializes them. This must be implemented by the derived class if the class has data.

       Reimplemented from <b>sc::MolecularCoor</b>.

       Reimplemented in <b>sc::RedundMolecularCoor</b>, and <b>sc::SymmMolecularCoor</b>.

   <b>virtual</b> <b>int</b> <b>sc::IntMolecularCoor::to_cartesian</b> <b>(RefSCVector</b> <b>&amp;</b> <b>cartesian,</b> <b>RefSCVector</b> <b>&amp;</b> <b>internal)</b> <b>[virtual]</b>
       Convert the internal coordinate gradients  in  ``internal''  to  Cartesian  coordinates  and  copy  these
       Cartesian  coordinate  gradients  to  ``cartesian''.  Only the variable internal coordinate gradients are
       transformed.

       Implements <b>sc::MolecularCoor</b>.

   <b>virtual</b> <b>int</b> <b>sc::IntMolecularCoor::to_cartesian</b> <b>(RefSymmSCMatrix</b>  <b>&amp;</b>  <b>cartesian,</b>  <b>RefSymmSCMatrix</b>  <b>&amp;</b>  <b>internal)</b>
       <b>[virtual]</b>
       Convert  the  internal  coordinate  Hessian  internal''  to  Cartesian  coordinates  and  copy the result
       tocartesian''. Only the variable internal coordinate force constants are transformed.

       Implements <b>sc::MolecularCoor</b>.

   <b>virtual</b> <b>int</b> <b>sc::IntMolecularCoor::to_internal</b> <b>(RefSCVector</b> <b>&amp;</b> <b>internal)</b> <b>[virtual]</b>
       Fill in the vector ``internal'' with the current internal coordinates. Note that this member will  update
       the values of the variable internal coordinates.

       Implements <b>sc::MolecularCoor</b>.

   <b>virtual</b> <b>int</b> <b>sc::IntMolecularCoor::to_internal</b> <b>(RefSCVector</b> <b>&amp;</b> <b>internal,</b> <b>RefSCVector</b> <b>&amp;</b> <b>cartesian)</b> <b>[virtual]</b>
       Convert  the  Cartesian  coordinate  gradients  in  ``cartesian''  to internal coordinates and copy these
       internal coordinate gradients to ``internal''.  Only  the  variable  internal  coordinate  gradients  are
       calculated.

       Implements <b>sc::MolecularCoor</b>.

   <b>virtual</b>  <b>int</b>  <b>sc::IntMolecularCoor::to_internal</b>  <b>(RefSymmSCMatrix</b>  <b>&amp;</b>  <b>internal,</b>  <b>RefSymmSCMatrix</b> <b>&amp;</b> <b>cartesian)</b>
       <b>[virtual]</b>
       Convert the Cartesian coordinate  Hessian  cartesian''  to  internal  coordinates  and  copy  the  result
       tointernal''. Only the variable internal coordinate force constants are calculated.

       Implements <b>sc::MolecularCoor</b>.

</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for MPQC from the source code.

Version 2.3.1                                    Sun Oct 4 2020                          <u>sc::<a href="../man3/IntMolecularCoor.3.html">IntMolecularCoor</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>