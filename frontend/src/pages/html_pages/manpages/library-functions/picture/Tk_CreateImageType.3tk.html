<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tk_CreateImageType, Tk_GetImageModelData - define new kind of image</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/tk9.0-doc">tk9.0-doc_9.0.1-3_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       Tk_CreateImageType, Tk_GetImageModelData - define new kind of image

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;tk.h&gt;</b>

       <b>Tk_CreateImageType</b>(<u>typePtr</u>)

       void *
       <b>Tk_GetImageModelData</b>(<u>interp,</u> <u>name,</u> <u>typePtrPtr</u>)

</pre><h4><b>ARGUMENTS</b></h4><pre>
       const Tk_ImageType <u>*typePtr</u> (in)             Structure  that  defines  the new type of image.  For Tk 8.4
                                                    and earlier this must be static: a pointer to this structure
                                                    is retained by the image code.  In Tk 8.5,  this  limitation
                                                    was relaxed.

       Tcl_Interp <u>*interp</u> (in)                      Interpreter in which image was created.

       const char <u>*name</u> (in)                        Name of existing image.

       Tk_ImageType <u>**typePtrPtr</u> (out)              Points  to  word  in  which  to  store  a  pointer  to  type
                                                    information for the given image, if it exists.

       char <u>***argvPtr</u> (in/out)                     Pointer to argument list
________________________________________________________________________________________________________________

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>Tk_CreateImageType</b> is invoked to define a new kind of image.  An image type corresponds to  a  particular
       value  of  the <u>type</u> argument for the <b>image</b> <b>create</b> command.  There may exist any number of different image
       types, and new types may be defined dynamically by calling <b>Tk_CreateImageType</b>.  For example, there  might
       be one type for 2-color bitmaps, another for multi-color images, another for dithered images, another for
       video, and so on.

       The  code  that  implements  a new image type is called an <u>image</u> <u>manager</u>.  It consists of a collection of
       procedures plus three different kinds of data structures.  The first data  structure  is  a  Tk_ImageType
       structure,  which  contains  the  name  of the image type and pointers to five procedures provided by the
       image manager to deal with images of this type:
              typedef struct {
                  const char *<u>name</u>;
                  Tk_ImageCreateProc *<u>createProc</u>;
                  Tk_ImageGetProc *<u>getProc</u>;
                  Tk_ImageDisplayProc *<u>displayProc</u>;
                  Tk_ImageFreeProc *<u>freeProc</u>;
                  Tk_ImageDeleteProc *<u>deleteProc</u>;
              } <b>Tk_ImageType</b>;
       The fields of this structure will be described in later subsections of this entry.

       The second major data structure manipulated by an image manager is called an <u>image</u>  <u>model</u>;   it  contains
       overall  information  about a particular image, such as the values of the configuration options specified
       in an <b>image</b> <b>create</b> command.  There will usually be one of these structures for  each  invocation  of  the
       <b>image</b> <b>create</b> command.

       The  third  data  structure  related  to images is an <u>image</u> <u>instance</u>.  There will usually be one of these
       structures for each usage of an image in a particular widget.  It is  possible  for  a  single  image  to
       appear  simultaneously  in  multiple  widgets,  or  even multiple times in the same widget.  Furthermore,
       different instances may be on different screens or displays.  The image instance data structure describes
       things that may vary from instance to instance, such as  colors  and  graphics  contexts  for  redisplay.
       There is usually one instance structure for each <b>-image</b> option specified for a widget or canvas item.

       The following subsections describe the fields of a Tk_ImageType in more detail.

   <b>NAME</b>
       <u>typePtr-&gt;name</u> provides a name for the image type.  Once <b>Tk_CreateImageType</b> returns, this name may be used
       in  <b>image</b>  <b>create</b>  commands  to create images of the new type.  If there already existed an image type by
       this name then the new image type replaces the old one.

   <b>CREATEPROC</b>
       <u>typePtr-&gt;createProc</u> provides the address of a procedure for Tk to call whenever <b>image</b> <b>create</b>  is  invoked
       to create an image of the new type.  <u>typePtr-&gt;createProc</u> must match the following prototype:
              typedef int <b>Tk_ImageCreateProc</b>(
                      Tcl_Interp *<u>interp</u>,
                      const char *<u>name</u>,
                      int <u>objc</u>,
                      Tcl_Obj *const <u>objv</u>[],
                      const Tk_ImageType *<u>typePtr</u>,
                      Tk_ImageModel <u>model</u>,
                      void **<u>modelDataPtr</u>);
       The  <u>interp</u>  argument is the interpreter in which the <b>image</b> command was invoked, and <u>name</u> is the name for
       the new image, which was either specified explicitly in the <b>image</b> command or generated  automatically  by
       the  <b>image</b> command.  The <u>objc</u> and <u>objv</u> arguments describe all the configuration options for the new image
       (everything after the name argument to <b>image</b>).  The <u>model</u>  argument  is  a  token  that  refers  to  Tk's
       information  about  this  image;   the  image  manager  must  return  this  token to Tk when invoking the
       <b>Tk_ImageChanged</b> procedure.  Typically <u>createProc</u> will parse <u>objc</u> and <u>objv</u> and create an image model  data
       structure  for  the  new image.  <u>createProc</u> may store an arbitrary one-word value at *<u>modelDataPtr</u>, which
       will be passed back to the image manager when other callbacks are invoked.   Typically  the  value  is  a
       pointer to the model data structure for the image.

       If  <u>createProc</u> encounters an error, it should leave an error message in the interpreter result and return
       <b>TCL_ERROR</b>;  otherwise it should return <b>TCL_OK</b>.

       <u>createProc</u> should call <b>Tk_ImageChanged</b> in order to set the size of  the  image  and  request  an  initial
       redisplay.

   <b>GETPROC</b>
       <u>typePtr-&gt;getProc</u>  is  invoked  by Tk whenever a widget calls <b>Tk_GetImage</b> to use a particular image.  This
       procedure must match the following prototype:
              typedef void *<b>Tk_ImageGetProc</b>(
                      Tk_Window <u>tkwin</u>,
                      void *<u>modelData</u>);
       The <u>tkwin</u> argument identifies the window in which the image will be  used  and  <u>modelData</u>  is  the  value
       returned  by  <u>createProc</u>  when the image model was created.  <u>getProc</u> will usually create a data structure
       for the new instance, including such things as the resources needed to display the  image  in  the  given
       window.   <u>getProc</u>  returns  a  one-word  token  for  the  instance, which is typically the address of the
       instance data structure.  Tk will pass this value back to the image manager when invoking its <u>displayProc</u>
       and <u>freeProc</u> procedures.

   <b>DISPLAYPROC</b>
       <u>typePtr-&gt;displayProc</u> is invoked by Tk whenever an image needs to be displayed (i.e.,  whenever  a  widget
       calls <b>Tk_RedrawImage</b>).  <u>displayProc</u> must match the following prototype:
              typedef void <b>Tk_ImageDisplayProc</b>(
                      void *<u>instanceData</u>,
                      Display *<u>display</u>,
                      Drawable <u>drawable</u>,
                      int <u>imageX</u>,
                      int <u>imageY</u>,
                      int <u>width</u>,
                      int <u>height</u>,
                      int <u>drawableX</u>,
                      int <u>drawableY</u>);
       The  <u>instanceData</u>  will  be  the  same  as  the  value returned by <u>getProc</u> when the instance was created.
       <u>display</u> and <u>drawable</u> indicate where to display the image;  <u>drawable</u> may  be  a  pixmap  rather  than  the
       window  specified  to <u>getProc</u> (this is usually the case, since most widgets double-buffer their redisplay
       to get smoother visual effects).  <u>imageX</u>, <u>imageY</u>, <u>width</u>, and <u>height</u> identify the region of the image that
       must be redisplayed.  This region will always be within the size of the image as specified  in  the  most
       recent  call  to <b>Tk_ImageChanged</b>.  <u>drawableX</u> and <u>drawableY</u> indicate where in <u>drawable</u> the image should be
       displayed;  <u>displayProc</u> should display the given region of the image so that point  (<u>imageX</u>,  <u>imageY</u>)  in
       the image appears at (<u>drawableX</u>, <u>drawableY</u>) in <u>drawable</u>.

   <b>FREEPROC</b>
       <u>typePtr-&gt;freeProc</u>  contains  the  address  of  a  procedure that Tk will invoke when an image instance is
       released (i.e., when <b>Tk_FreeImage</b> is invoked).  This can happen, for example, when a widget is deleted or
       a image item in a canvas is deleted, or when the image displayed in a widget or canvas item  is  changed.
       <u>freeProc</u> must match the following prototype:
              typedef void <b>Tk_ImageFreeProc</b>(
                      void *<u>instanceData</u>,
                      Display *<u>display</u>);
       The  <u>instanceData</u>  will  be  the same as the value returned by <u>getProc</u> when the instance was created, and
       <u>display</u> is the display containing the window for the instance.  <u>freeProc</u>  should  release  any  resources
       associated with the image instance, since the instance will never be used again.

   <b>DELETEPROC</b>
       <u>typePtr-&gt;deleteProc</u>  is  a  procedure that Tk invokes when an image is being deleted (i.e. when the <b>image</b>
       <b>delete</b> command is invoked).  Before invoking <u>deleteProc</u> Tk will invoke <u>freeProc</u> for each of  the  image's
       instances.  <u>deleteProc</u> must match the following prototype:
              typedef void <b>Tk_ImageDeleteProc</b>(
                      void *<u>modelData</u>);
       The <u>modelData</u> argument will be the same as the value stored in <u>*modelDataPtr</u> by <u>createProc</u> when the image
       was created.  <u>deleteProc</u> should release any resources associated with the image.

</pre><h4><b>TK_GETIMAGEMODELDATA</b></h4><pre>
       The  procedure  <b>Tk_GetImageModelData</b> may be invoked to retrieve information about an image.  For example,
       an image manager can use this procedure to locate its image model data for an image.  If there exists  an
       image  named <u>name</u> in the interpreter given by <u>interp</u>, then <u>*typePtrPtr</u> is filled in with type information
       for the image (the <u>typePtr</u> value passed to <b>Tk_CreateImageType</b> when the image type was registered) and the
       return value is the clientData value returned by the <u>createProc</u> when  the  image  was  created  (this  is
       typically  a  pointer  to the image model data structure).  If no such image exists then NULL is returned
       and NULL is stored at <u>*typePtrPtr</u>.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       Tk_ImageChanged, Tk_GetImage, Tk_FreeImage, Tk_RedrawImage, Tk_SizeOfImage

</pre><h4><b>KEYWORDS</b></h4><pre>
       image manager, image type, instance, model

Tk                                                     8.5                               <u><a href="../man3tk/Tk_CreateImageType.3tk.html">Tk_CreateImageType</a></u>(3tk)
</pre>
 </div>
</div></section>
</div>
</body>
</html>