<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>void</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libmongoc-doc">libmongoc-doc_1.30.4-1ubuntu1_all</a> <br><br><pre>
</pre><h4><b>SYNOPSIS</b></h4><pre>
          void
          mongoc_read_prefs_set_tags (mongoc_read_prefs_t *read_prefs,
                                      const bson_t *tags);

</pre><h4><b>PARAMETERS</b></h4><pre>
       • <b>read_prefs</b>: A <u>mongoc_read_prefs_t</u>.

       • <b>tags</b>: A <u>bson_t</u>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Sets  the  tags  to  be  used  for the read preference. Only mongod instances matching these tags will be
       suitable for handling the request.

</pre><h4><b>EXAMPLES</b></h4><pre>
          #include &lt;mongoc/mongoc.h&gt;

          static void
          run_query_with_read_prefs_tags (mongoc_collection_t *collection)
          {
             char *str;
             const bson_t *doc;
             bson_t filter = BSON_INITIALIZER;
             bson_error_t error;
             mongoc_cursor_t *cursor;
             mongoc_read_prefs_t *read_prefs;
             /*  Create a tagset representing
              *  [
              *    {"dc": "ny", "rack": "1" }, // Any node in rack1 in the ny datacenter
              *    {"dc": "ny", "rack": "2" }, // Any node in rack2 in the ny datacenter
              *    {"dc": "ny" },              // Any node in the ny datacenter
              *    {}                          // If all else fails, just any available node
              * ]
              */
             bson_t *tags = BCON_NEW (
                "0", "{", "dc", BCON_UTF8("ny"), "rack", BCON_UTF8("1"), "}",
                "1", "{", "dc", BCON_UTF8("ny"), "rack", BCON_UTF8("2"), "}",
                "2", "{", "dc", BCON_UTF8("ny"), "}",
                "3", "{", "}"
             );

             read_prefs = mongoc_read_prefs_new (MONGOC_READ_SECONDARY);
             mongoc_read_prefs_set_tags (read_prefs, tags);
             bson_destroy (tags);

             cursor =
                mongoc_collection_find_with_opts (collection, &amp;filter, NULL, read_prefs);

             while (mongoc_cursor_next (cursor, &amp;doc)) {
                str = bson_as_canonical_extended_json (doc, NULL);
                printf ("%s\n", str);
                bson_free (str);
             }
             if (mongoc_cursor_error (cursor, &amp;error)) {
                fprintf (stderr, "Cursor error: %s\n", error.message);
             }

             mongoc_cursor_destroy (cursor);
             mongoc_read_prefs_destroy (read_prefs);
             bson_destroy (doc);
          }

          int main (void)
          {
             mongoc_client_t *client;
             mongoc_collection_t *collection;

             mongoc_init ();

             client =
                mongoc_client_new ("mongodb://localhost/?appname=rp_tags&amp;replicaSet=foo");
             mongoc_client_set_error_api (client, 2);
             collection = mongoc_client_get_collection (client, "dbname", "collname");
             run_query_with_read_prefs_tags (collection);

             mongoc_collection_destroy (collection);
             mongoc_client_destroy (client);
             mongoc_cleanup();
          }

</pre><h4><b>AUTHOR</b></h4><pre>
       MongoDB, Inc

</pre><h4><b>COPYRIGHT</b></h4><pre>
       2009-present, MongoDB, Inc.

1.30.4                                            Jun 08, 2025                     <u><a href="../man3/MONGOC_READ_PREFS_SET_TAGS.3.html">MONGOC_READ_PREFS_SET_TAGS</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>