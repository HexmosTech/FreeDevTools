<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNMP_session  -  C++ object for specifying an SNMP Agent which can then be the managed via SNMP set, get,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/jammy/+package/libsnmpkit-dev">libsnmpkit-dev_0.9-16ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SNMP_session  -  C++ object for specifying an SNMP Agent which can then be the managed via SNMP set, get,
       and get_next calls

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;snmpkit&gt;</b>

       <b>SNMP_session::SNMP_session</b>  <b>(const</b>  <b>string</b>  <b>&amp;host,void</b>  <b>*(*start_routine)(SNMP_session*),</b>  <b>const</b>   <b>string</b>
       <b>&amp;community="public")</b>

       <b>list&lt;SNMP_session*&gt;</b>         <b>&amp;SNMP_sessions(list&lt;SNMP_session*&gt;</b>         <b>&amp;dest,string</b>        <b>&amp;hostspec,void</b>
       <b>*(*start_routine)(SNMP_session*),const</b> <b>string</b> <b>&amp;community="public");</b>

       <b>list&lt;SNMP_session*&gt;</b>      <b>&amp;SNMP_sessions(list&lt;SNMP_session*&gt;</b>      <b>&amp;dest,list&lt;string&gt;</b>       <b>&amp;hostspecs,void</b>
       <b>*(*start_routine)(SNMP_session*),const</b> <b>string</b> <b>&amp;community="public");</b>

       <b>SNMP_session::~SNMP_session();</b>

       <b>static</b> <b>void</b> <b>SNMP_session::end();</b>

       <b>OidSeq</b> <b>*SNMP_session::get(OidSeq</b> <b>*oids);</b>

       <b>OidSeq</b> <b>*SNMP_session::get_next(OidSeq</b> <b>*oids);</b>

       <b>OidSeq</b> <b>*SNMP_session::set(OidSeq</b> <b>*oids);</b>

       <b>char</b> <b>*SNMP_session::ConnHost();</b>

       <b>const</b> <b>string</b> <b>&amp;SNMP_session::Hostname();</b>

       <b>void</b> <b>SNMP_session::setDebug();</b>

       <b>void</b> <b>SNMP_session::write_debug(const</b> <b>string</b> <b>&amp;dirstr,</b> <b>BerSequence</b> <b>*packet);</b>

       <b>void</b> <b>SNMP_session::write_debug_bin(const</b> <b>basic_string&lt;unsigned</b> <b>char&gt;</b> <b>&amp;str);</b>

       <b>void</b> <b>SNMP_session::printstr(unsigned</b> <b>long</b> <b>*argflags,char</b> <b>need_newline,char</b> <b>*str,</b> <b>char</b> <b>ck_name_flag);</b>

       <b>int</b> <b>SNMP_sessions_done();</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       An  <b>SNMP_session</b>  instance  is an object that handles the details of communicating an SNMP enabled device
       such as a printer or a router.

   <b>SNMP_session::SNMP_session</b>  <b>(const</b>   <b>string</b>   <b>&amp;host,void</b>   <b>*(*start_routine)(SNMP_session*),</b>   <b>const</b>   <b>string</b>
       <b>&amp;community);</b>
       In  order  to  create a new SNMP_session, you should know the address of the host or hosts with which you
       wish to communicate.  This parameter can take the form of an IP address or a hostname.

       You must also provide a pointer to the start_routine function.  The start_routine() is the function  used
       to actually do the work of communicating with the network device. In other words, this function is called
       when  the  thread  handling  this  particular device is activated. In other words, this function actually
       loads up the packets with the SNMP objects and then makes the requsts.

       Finally, you should also provide a SNMP community string (although a default one will be used if  you  do
       not supply one).  This string acts as a password.  Normally there are two strings set for an SNMP enabled
       device.   One will allow the user write access to settings via SNMP commands and the second password will
       only allow for read access to device settings.

       <b>Exceptions</b>

       * SocketNoUDPException - unable to obtain a protoent  (<b>See</b>  <b><a href="../man3/getprotbyname.3.html">getprotbyname</a>(3)</b>)  structure  for  the  "UDP"
       protocol.

       * SocketCreateFailException - unable to create a socket for use by the SNMP_session. (<b>See</b> <b><a href="../man2/socket.2.html">socket</a>(2)</b>).

       * ReceiverCreateException - unable to create the listening thread in order to receive responses to issued
       SNMP queries.(<b>See</b> <b><a href="../man3/pthread_create.3.html">pthread_create</a>(3)</b>).

       *   SessionHostNotFoundException   -   unable  to  create  the  hostent  struct;  normally  caused  by  a
       <b><a href="../man3/gethostbyname.3.html">gethostbyname</a>(3)</b> call on the host argument to the SNMP_session() constructor.

       * JoinerCreateException - new thread creation failed. (<b>See</b> <b><a href="../man3/pthread_create.3.html">pthread_create</a>(3)</b>).

       * SessionWorkerCreateException - worker thread creation failed. (<b>See</b> <b><a href="../man3/pthread_create.3.html">pthread_create</a>(3)</b>).

   <b>list&lt;SNMP_session*&gt;</b>          <b>&amp;SNMP_sessions(list&lt;SNMP_session*&gt;</b>          <b>&amp;dest,string</b>          <b>&amp;hostspec,void</b>
       <b>*(*start_routine)(SNMP_session*),const</b> <b>string</b> <b>&amp;community="public");</b>
       This   function  is not really a part of the class but its sole purpose is to repeatedly call the session
       constructor. This function is simply a quick way to create lots of sessions all at once. In  addition  to
       being  able  to  pass  a  simple hostname or IP address, you can pass a host specification. This can have
       several forms:

       * Simple address: 192.168.0.1

       * Simple hostname: foobar

       * IP address range: 192.168.0.1-52

       * Network and subnet mask: 192.168.0.0/255.255.255.0

       * Network and bits in subnet mask: 192.168.0.0/24

       In addition the a community name can be appeneded to the hostpsec by  surrounding  it  with  parenthesis.
       e.g. 192.168.0.5-18(private)

       <b>Exceptions</b>

       Same as SNMP_session::SNMP_session() with the addition of

       * SessionCommunityException - Can't find the closing parenthesis on the community name.

       * SessionOctetOverflowException - One of the octets in subnet mask is greater than 255.

       * SessionBadSubnetException - The subnet mask doesn't make sense.

       * SessionNetbitsOverflowException - The number of bits in the netbits is greater than 31.

       * SessionBadNetmaskException -  The overall netmask specification wasn't deciferable.

   <b>list&lt;SNMP_session*&gt;</b>        <b>&amp;SNMP_sessions(list&lt;SNMP_session*&gt;</b>        <b>&amp;dest,list&lt;string&gt;</b>       <b>&amp;hostspecs,void</b>
       <b>*(*start_routine)(SNMP_session*),const</b> <b>string</b> <b>&amp;community);</b>
       See SNMP_sessions(list&lt;SNMP_session*&gt; &amp;dest,string &amp;hostspec,void  *(*start_routine)(SNMP_session*),const
       string &amp;community);

       This function is not really part of the class but its sole purpose is to repeatedly call the constructor.
       This  function is simply a quick way to create lots of sessions all at once. It is virtually identical to
       the other SNMP_sessions function with the exception that instead of taking one string as  a  hostspec  it
       takes a list of hostspec strings.

       <b>Exceptions</b>

       Same          as          SNMP_sessions(list&lt;SNMP_session*&gt;          &amp;dest,string          &amp;hostspec,void
       *(*start_routine)(SNMP_session*),const string &amp;community).

   <b>SNMP_session::~SNMP_session();</b>
       SNMP_session object destructor.

   <b>OidSeq</b> <b>*SNMP_session::__get(OidSeq</b> <b>*oids)</b>
       Method to read  information  from  an  SNMP  device.  This  function  is  primarily  called  by  the  <b>See</b>
       <b><a href="../man3/SNMP_structFiller.3.html">SNMP_structFiller</a>(3)</b>  class. It is designed to be called by the other functions in the library and is not
       generally considered an exported interface to the SNMPkit library.

       <b>Exceptions</b>

       * SNMPPacketNotSequenceException - The response received was not a valid SNMP response.

       * SNMPRespNotSequenceException - The packet received was a valid SNMP response but the structure  of  the
       SNMP response was incorrect.

       * SNMPNotResponseTagException - The type of the SNMP response received was incorrect (not 0xa2).

       * SNMPSeqnoNotIntException - The sequence number of the response was not a classified as a number.

       *  SNMPStateNotIntException - The SNMP device sent back an improperly constructed response packet and the
       status was not classified as an integer.

       * SNMPFaultOidNotIntException - A response was returned with an error but the index to the problem object
       identifier was not classified as an integer.

       * OidSeqBadLayoutException -  Within a SNMP packet there is a substructure which is an OID  sequence.  If
       the  packet  was  supposed to have an OID sequence in a particular locaion but for some reason one of the
       elements was not of the correct type, then this exception will be thrown.

       * SNMPBadOidException - An OID in the SNMP response packet was invalid.

       * SocketSendShortExecption - An error occurred while sending the SNMP request resulting in an  incomplete
       transmission of the query.

       *     BerSequenceTagException,     BerIntTagException,     BerStringTagException,    BerNullTagException,
       BerOidTagException, BerTimeTickTagException,  BerCounterTagException  -  These  exceptions  are  internal
       exceptions  which  are  caused  by  trying to interpret a piece of as one type when in fact it is another
       type. These are almost always called as a result of a bug in the SNMPkit library.

       *  BerLengthException,  BerIntLengthExecption,  BerTimeTickLengthgExceptioin,  BerCounterLengthExecption,
       BerNullLengthExecption,  BerIPAddrLengthExecption - The size of the data to be encoded (BER) will not fit
       into an unsigned long data type.

   <b>OidSeq</b> <b>*SNMP_session::__get_next(OidSeq</b> <b>*oids);</b>
       Get the next item following the one pointed to by the  OID  sequence  passed  into  the  function.   This
       function  is  primarily  called by the <b>See</b> <b><a href="../man3/SNMP_structFiller.3.html">SNMP_structFiller</a>(3)</b> class. It is designed to be called by the
       other functions in the library and is not generally considered  an  exported  interface  to  the  SNMPkit
       library.

       <b>Exceptions</b>

       Same as the <b>SNMP_session::__get()</b> method.

   <b>OidSeq</b> <b>*SNMP_session::__set(OidSeq</b> <b>*oids)</b>
       This  method  will  write  the  values inserted into the OidSeq into the the SNMP agent. It is almost the
       opposite of __get which takes an OID and gets the value from the SNMP agent. This function  is  primarily
       called  by  the <b>See</b> <b><a href="../man3/SNMP_structFiller.3.html">SNMP_structFiller</a>(3)</b> class. It is designed to be called by the other functions in the
       library and is not generally considered an exported interface to the SNMPkit library.

       <b>Exceptions</b>

       Same as the <b>SNMP_session::__get()</b> method.

   <b>void</b> <b>SNMP_session::setDebug()</b>
       Enable the logging of debug information from the SNMP_session  instance.   This  method  must  be  called
       before attempting to write any debug data using the write_debug() method.

       <b>Exceptions</b>

       *  DebugFileStatException  - An unexpected error occurred when attempting to locate the appropriate debug
       log ("snmplog*"); this will occur when a stat of the debug log file returns an error other than ENOENT.

       * DebugFileOpenException - An error occurred when attempting to open the process debug log.

   <b>void</b> <b>SNMP_session::__write_debug(const</b> <b>string</b> <b>&amp;dirstr,</b>
       BerSequence *packet);" Write the SNMP packet information to a log file  in  order  to  aid  in  debugging
       errors.

   <b>void</b> <b>SNMP_session::__write_debug_bin(const</b> <b>basic_string&lt;unsigned</b> <b>char&gt;</b>
       &amp;str);" Write binary debugging information to the log files dumping it in hex format.

   <b>void</b> <b>SNMP_session::printstr(unsigned</b> <b>long</b> <b>*argflags,char</b> <b>need_newline,</b>
       char *str, char ck_name_flag);" Enables the SNMP_session object to synchronize the logging of information
       among its various threads.

   <b>char</b> <b>*SNMP_Session::ConnHost();</b>
       Method  to  obtain  the network address of the current SNMP session.  Note that the returned string is in
       network byte order.

   <b>constr</b> <b>string</b> <b>&amp;SNMP_session::Hostname();</b>
       Method to obtain the hostname string used when creating the SNMP_session instance

   <b>void</b> <b>SNMP_session::end();</b>
       Method for appending a final newline (if necessary) to standard output.

   <b>int</b> <b>SNMP_sessions_done();</b>
       There is a thread that demultiplexes the packets coming in on the  socket  as  well  as  a  thread  which
       recycles threads to keep the utilization of the system resources reasonable. Call this function after all
       the  sessions  are  created  to wait for all the threads to complete and clean up all the misc. resources
       which are being used by the library.

</pre><h4><b>RETURN</b> <b>VALUE</b></h4><pre>
       <b>OidSeq</b> <b>*SNMP_session::__get();</b>

              Pointer to an OidSeq object containing the response to the SNMP get request.

       <b>OidSeq</b> <b>*SNMP_session::__get_next();</b>

              Pointer to an OidSeq object containing the response to the SNMP get_next request.

       <b>OidSeq</b> <b>*SNMP_session::__set();</b>

              Pointer to an OidSeq object containing the response to the SNMP set request

       <b>int</b> <b>SNMP_sessions_done();</b>

              The maximum error returned by any of the threads when they complete.

       <b>list&lt;SNMP_session*&gt;</b> <b>&amp;SNMP_sessions();</b>

              Returns the list passed into it with any sessions that were created appended to  the  end  of  the
              list.

</pre><h4><b>EXAMPLE</b></h4><pre>
       <b>#include</b> <b>&lt;snmpkit&gt;</b>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/string.h">string.h</a>&gt;</b>
       <b>#include</b> <b>&lt;iostream.h&gt;</b>

       static const char SYSDESC[]="1.3.6.1.2.1.1.1.0";

       struct PrinterInfo{
         char *sysDesc;
       };

       void printer_info_insert_sysDesc(void *dest_ptr,const char *str){
         PrinterInfo *dest=reinterpret_cast&lt;PrinterInfo*&gt;(dest_ptr);
         dest-&gt;sysDesc=strdup(str);
       }

       void *do_req(SNMP_session *printer){
         PrinterInfo prinfo;
         cerr &lt;&lt; printer-&gt;Hostname() &lt;&lt; endl &lt;&lt; flush;
         printer-&gt;setDebug();
         SNMP_structFiller table(*printer);
         table.append_string(SYSDESC,printer_info_insert_sysDesc);
         table.get(&amp;prinfo);
         cout &lt;&lt; printer-&gt;Hostname() &lt;&lt; ' ' &lt;&lt; prinfo.sysDesc &lt;&lt; endl;
         return NULL;
       }

       int main(int argc,char **argv){
         set_snmpsock_props(1,3);
         list&lt;SNMP_session*&gt; sessions;
         string hostspec(argv[1]);
         SNMP_sessions(sessions,hostspec,do_req);
         SNMP_sessions_done();
         <a href="../man1/exit.1.html">exit</a>(1);
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man3/SNMP_structFiller.3.html">SNMP_structFiller</a>(3), <a href="../man3/SNMP_table.3.html">SNMP_table</a>(3)

</pre><h4><b>AUTHOR</b></h4><pre>
       The  SNMPkit  C/C++ library was originally developed by Ben Woodard &lt;<a href="mailto:ben@users.sourceforge.net">ben@users.sourceforge.net</a>&gt;. This man
       page was written by Gerald Carter &lt;<a href="mailto:gcarter@valinux.com">gcarter@valinux.com</a>&gt;.

GNU snmpkit 0.4                                   November 2000                                  <u><a href="../man3/SNMP_session.3.html">SNMP_session</a></u>(3)
</pre>
 </div>
</div></section>
</div>
</body>
</html>