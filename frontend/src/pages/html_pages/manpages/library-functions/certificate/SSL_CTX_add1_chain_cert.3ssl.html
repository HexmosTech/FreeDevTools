<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_set0_chain, SSL_CTX_set1_chain, SSL_CTX_add0_chain_cert, SSL_CTX_add1_chain_cert,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_set0_chain, SSL_CTX_set1_chain, SSL_CTX_add0_chain_cert, SSL_CTX_add1_chain_cert,
       SSL_CTX_get0_chain_certs, SSL_CTX_clear_chain_certs, SSL_set0_chain, SSL_set1_chain, SSL_add0_chain_cert,
       SSL_add1_chain_cert, SSL_get0_chain_certs, SSL_clear_chain_certs, SSL_CTX_build_cert_chain,
       SSL_build_cert_chain, SSL_CTX_select_current_cert, SSL_select_current_cert, SSL_CTX_set_current_cert,
       SSL_set_current_cert - extra chain certificate processing

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        int SSL_CTX_set0_chain(SSL_CTX *ctx, STACK_OF(X509) *sk);
        int SSL_CTX_set1_chain(SSL_CTX *ctx, STACK_OF(X509) *sk);
        int SSL_CTX_add0_chain_cert(SSL_CTX *ctx, X509 *x509);
        int SSL_CTX_add1_chain_cert(SSL_CTX *ctx, X509 *x509);
        int SSL_CTX_get0_chain_certs(SSL_CTX *ctx, STACK_OF(X509) **sk);
        int SSL_CTX_clear_chain_certs(SSL_CTX *ctx);

        int SSL_set0_chain(SSL *ssl, STACK_OF(X509) *sk);
        int SSL_set1_chain(SSL *ssl, STACK_OF(X509) *sk);
        int SSL_add0_chain_cert(SSL *ssl, X509 *x509);
        int SSL_add1_chain_cert(SSL *ssl, X509 *x509);
        int SSL_get0_chain_certs(SSL *ssl, STACK_OF(X509) **sk);
        int SSL_clear_chain_certs(SSL *ssl);

        int SSL_CTX_build_cert_chain(SSL_CTX *ctx, flags);
        int SSL_build_cert_chain(SSL *ssl, flags);

        int SSL_CTX_select_current_cert(SSL_CTX *ctx, X509 *x509);
        int SSL_select_current_cert(SSL *ssl, X509 *x509);
        int SSL_CTX_set_current_cert(SSL_CTX *ctx, long op);
        int SSL_set_current_cert(SSL *ssl, long op);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_CTX_set0_chain()</b> and <b>SSL_CTX_set1_chain()</b> set the certificate chain associated with the current
       certificate of <b>ctx</b> to <b>sk</b>.

       <b>SSL_CTX_add0_chain_cert()</b> and <b>SSL_CTX_add1_chain_cert()</b> append the single certificate <b>x509</b> to the chain
       associated with the current certificate of <b>ctx</b>.

       <b>SSL_CTX_get0_chain_certs()</b> retrieves the chain associated with the current certificate of <b>ctx</b>.

       <b>SSL_CTX_clear_chain_certs()</b> clears any existing chain associated with the current certificate of <b>ctx</b>.
       (This is implemented by calling <b>SSL_CTX_set0_chain()</b> with <b>sk</b> set to <b>NULL</b>).

       <b>SSL_CTX_build_cert_chain()</b> builds the certificate chain for <b>ctx</b>.  Normally this uses the chain store or
       the verify store if the chain store is not set.  If the function is successful the built chain will
       replace any existing chain.  The <b>flags</b> parameter can be set to <b>SSL_BUILD_CHAIN_FLAG_UNTRUSTED</b> to use
       existing chain certificates as untrusted CAs, <b>SSL_BUILD_CHAIN_FLAG_NO_ROOT</b> to omit the root CA from the
       built chain, <b>SSL_BUILD_CHAIN_FLAG_CHECK</b> to use all existing chain certificates only to build the chain
       (effectively sanity checking and rearranging them if necessary), the flag
       <b>SSL_BUILD_CHAIN_FLAG_IGNORE_ERROR</b> ignores any errors during verification: if flag
       <b>SSL_BUILD_CHAIN_FLAG_CLEAR_ERROR</b> is also set verification errors are cleared from the error queue.
       Details of the chain building process are described in "Certification Path Building" in
       <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1).

       Each of these functions operates on the <u>current</u> end entity (i.e. server or client) certificate. This is
       the last certificate loaded or selected on the corresponding <b>ctx</b> structure.

       <b>SSL_CTX_select_current_cert()</b> selects <b>x509</b> as the current end entity certificate, but only if <b>x509</b> has
       already been loaded into <b>ctx</b> using a function such as <b>SSL_CTX_use_certificate()</b>.

       <b>SSL_set0_chain()</b>, <b>SSL_set1_chain()</b>, <b>SSL_add0_chain_cert()</b>, <b>SSL_add1_chain_cert()</b>, <b>SSL_get0_chain_certs()</b>,
       <b>SSL_clear_chain_certs()</b>, <b>SSL_build_cert_chain()</b>, <b>SSL_select_current_cert()</b> and <b>SSL_set_current_cert()</b> are
       similar except they apply to SSL structure <b>ssl</b>.

       <b>SSL_CTX_set_current_cert()</b> changes the current certificate to a value based on the <b>op</b> argument. Currently
       <b>op</b> can be <b>SSL_CERT_SET_FIRST</b> to use the first valid certificate or <b>SSL_CERT_SET_NEXT</b> to set the next
       valid certificate after the current certificate. These two operations can be used to iterate over all
       certificates in an <b>SSL_CTX</b> structure.

       <b>SSL_set_current_cert()</b> also supports the option <b>SSL_CERT_SET_SERVER</b>.  If <b>ssl</b> is a server and has sent a
       certificate to a connected client this option sets that certificate to the current certificate and
       returns 1.  If the negotiated cipher suite is anonymous (and thus no certificate will be sent) 2 is
       returned and the current certificate is unchanged. If <b>ssl</b> is not a server or a certificate has not been
       sent 0 is returned and the current certificate is unchanged.

       All these functions are implemented as macros. Those containing a <b>1</b> increment the reference count of the
       supplied certificate or chain so it must be freed at some point after the operation. Those containing a <b>0</b>
       do not increment reference counts and the supplied certificate or chain <b>MUST</b> <b>NOT</b> be freed after the
       operation.

</pre><h4><b>NOTES</b></h4><pre>
       The chains associate with an SSL_CTX structure are copied to any SSL structures when <b>SSL_new()</b> is called.
       SSL structures will not be affected by any chains subsequently changed in the parent SSL_CTX.

       One chain can be set for each key type supported by a server. So, for example, an RSA and a DSA
       certificate can (and often will) have different chains.

       The functions <b>SSL_CTX_build_cert_chain()</b> and <b>SSL_build_cert_chain()</b> can be used to check application
       configuration and to ensure any necessary subordinate CAs are sent in the correct order. Misconfigured
       applications sending incorrect certificate chains often cause problems with peers.

       For example an application can add any set of certificates using <b>SSL_CTX_use_certificate_chain_file()</b>
       then call <b>SSL_CTX_build_cert_chain()</b> with the option <b>SSL_BUILD_CHAIN_FLAG_CHECK</b> to check and reorder
       them.

       Applications can issue non fatal warnings when checking chains by setting the flag
       <b>SSL_BUILD_CHAIN_FLAG_IGNORE_ERRORS</b> and checking the return value.

       Calling <b>SSL_CTX_build_cert_chain()</b> or <b>SSL_build_cert_chain()</b> is more efficient than the automatic chain
       building as it is only performed once.  Automatic chain building is performed on each new session.

       If any certificates are added using these functions no certificates added using
       <b>SSL_CTX_add_extra_chain_cert()</b> will be used.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>SSL_set_current_cert()</b> with <b>SSL_CERT_SET_SERVER</b> return 1 for success, 2 if no server certificate is used
       because the cipher suites is anonymous and 0 for failure.

       <b>SSL_CTX_build_cert_chain()</b> and <b>SSL_build_cert_chain()</b> return 1 for success and 0 for failure. If the flag
       <b>SSL_BUILD_CHAIN_FLAG_IGNORE_ERROR</b> and a verification error occurs then 2 is returned.

       All other functions return 1 for success and 0 for failure.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_CTX_add_extra_chain_cert.3.html">SSL_CTX_add_extra_chain_cert</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       These functions were added in OpenSSL 1.0.2.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2013-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain a copy in the file LICENSE in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                      <u><a href="../man3SSL/SSL_CTX_ADD1_CHAIN_CERT.3SSL.html">SSL_CTX_ADD1_CHAIN_CERT</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>