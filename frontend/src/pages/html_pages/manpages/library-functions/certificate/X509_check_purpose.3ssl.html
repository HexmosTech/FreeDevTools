<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X509_check_purpose, X509_PURPOSE_get_count, X509_PURPOSE_get_unused_id, X509_PURPOSE_get_by_sname,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       X509_check_purpose, X509_PURPOSE_get_count, X509_PURPOSE_get_unused_id, X509_PURPOSE_get_by_sname,
       X509_PURPOSE_get_by_id, X509_PURPOSE_add, X509_PURPOSE_cleanup, X509_PURPOSE_get0, X509_PURPOSE_get_id,
       X509_PURPOSE_get0_name, X509_PURPOSE_get0_sname, X509_PURPOSE_get_trust, X509_PURPOSE_set - functions
       related to checking the purpose of a certificate

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/x509v3.h&gt;

        int X509_check_purpose(X509 *x, int id, int ca);

        int X509_PURPOSE_get_count(void);
        int X509_PURPOSE_get_unused_id(OSSL_LIB_CTX *libctx);
        int X509_PURPOSE_get_by_sname(const char *sname);
        int X509_PURPOSE_get_by_id(int id);
        int X509_PURPOSE_add(int id, int trust, int flags,
                             int (*ck) (const X509_PURPOSE *, const X509 *, int),
                             const char *name, const char *sname, void *arg);
        void X509_PURPOSE_cleanup(void);

        X509_PURPOSE *X509_PURPOSE_get0(int idx);
        int X509_PURPOSE_get_id(const X509_PURPOSE *);
        char *X509_PURPOSE_get0_name(const X509_PURPOSE *xp);
        char *X509_PURPOSE_get0_sname(const X509_PURPOSE *xp);
        int X509_PURPOSE_get_trust(const X509_PURPOSE *xp);
        int X509_PURPOSE_set(int *p, int purpose);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>X509_check_purpose()</b> checks if certificate <u>x</u> was created with the purpose represented by <u>id</u>. If <u>ca</u> is
       nonzero, then certificate <u>x</u> is checked to determine if it's a possible CA with various levels of
       certainty possibly returned. The certificate <u>x</u> must be a complete certificate otherwise the function
       returns an error.

       Below are the potential ID's that can be checked:

        # define X509_PURPOSE_SSL_CLIENT        1
        # define X509_PURPOSE_SSL_SERVER        2
        # define X509_PURPOSE_NS_SSL_SERVER     3
        # define X509_PURPOSE_SMIME_SIGN        4
        # define X509_PURPOSE_SMIME_ENCRYPT     5
        # define X509_PURPOSE_CRL_SIGN          6
        # define X509_PURPOSE_ANY               7
        # define X509_PURPOSE_OCSP_HELPER       8
        # define X509_PURPOSE_TIMESTAMP_SIGN    9
        # define X509_PURPOSE_CODE_SIGN        10

       The checks performed take into account the X.509 extensions keyUsage, extendedKeyUsage, and
       basicConstraints.

       <b>X509_PURPOSE_get_count()</b> returns the number of currently defined purposes.

       <b>X509_PURPOSE_get_unused_id()</b> returns the smallest purpose id not yet used, which is guaranteed to be
       unique and larger than <b>X509_PURPOSE_MAX</b>.  The <u>libctx</u> parameter should be used to provide the library
       context.  It is currently ignored as the purpose mapping table is global.

       <b>X509_PURPOSE_get_by_sname()</b> returns the index of the purpose with the given short name or -1 if not
       found.

       <b>X509_PURPOSE_get_by_id()</b> returns the index of the purpose with the given id or -1 if not found.

       <b>X509_PURPOSE_add()</b> adds or modifies a purpose entry identified by <u>sname</u>.  Unless the id stays the same
       for an existing entry, <u>id</u> must be fresh, which can be achieved by using the result of
       <b>X509_PURPOSE_get_unused_id()</b>.  The function also sets in the entry the trust id <u>trust</u>, the given <u>flags</u>,
       the purpose (long) name <u>name</u>, the short name <u>sname</u>, the purpose checking funktion <u>ck</u> of type <b>int</b> <b>(*)</b>
       <b>(const</b> <b>X509_PURPOSE</b> <b>*,</b> <b>const</b> <b>X509</b> <b>*,</b> <b>int)</b>, and its user data <u>arg</u> which may be retrieved via the
       <b>X509_PURPOSE</b> pointer.

       <b>X509_PURPOSE_cleanup()</b> removes all purposes that are not pre-defined.

       <b>X509_PURPOSE_get0()</b> returns an <b>X509_PURPOSE</b> pointer or NULL on error.

       <b>X509_PURPOSE_get_id()</b> returns the id of the given <b>X509_PURPOSE</b> structure.

       <b>X509_PURPOSE_get0_name()</b> returns the (long) name of the given <b>X509_PURPOSE</b>.

       <b>X509_PURPOSE_get0_sname()</b> returns the short name of the given <b>X509_PURPOSE</b>.

       <b>X509_PURPOSE_get_trust()</b> returns the trust id of the given <b>X509_PURPOSE</b>.

       <b>X509_PURPOSE_set()</b> assigns the given <u>purpose</u> id to the location pointed at by <u>p</u>.  This resets to the any
       purpose if <u>purpose</u> is <b>X509_PURPOSE_DEFAULT_ANY</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>X509_check_purpose()</b> returns the following values.  For non-CA checks

       -1 an error condition has occurred
        1 if the certificate was created to perform the purpose represented by <u>id</u>
        0 if the certificate was not created to perform the purpose represented by <u>id</u>

       For CA checks the below integers could be returned with the following meanings:

       -1 an error condition has occurred
        0 not a CA or does not have the purpose represented by <u>id</u>
        1 is a CA.
        2 Only possible in old versions of openSSL when basicConstraints are absent. New versions will not
       return this value. May be a CA
        3 basicConstraints absent but self signed V1.
        4 basicConstraints absent but keyUsage present and keyCertSign asserted.
        5 legacy Netscape specific CA Flags present

       <b>X509_PURPOSE_get_count()</b> returns the number of currently defined purposes.

       <b>X509_PURPOSE_get_unused_id()</b> returns the smallest purpose id not yet used.

       <b>X509_PURPOSE_get_by_sname()</b>  returns  the  index  of  the  purpose with the given short name or -1 if not
       found.

       <b>X509_PURPOSE_get_by_id()</b> returns the index of the purpose with the given id or -1 if not found.

       int <b>X509_PURPOSE_add()</b> returns 1 on success, 0 on error.

       <b>X509_PURPOSE_cleanup()</b> does not return anything.

       <b>X509_PURPOSE_get0()</b> returns an <b>X509_PURPOSE</b> pointer or NULL on error.

       <b>X509_PURPOSE_get_id()</b> returns the id of the given <b>X509_PURPOSE</b> structure.

       <b>X509_PURPOSE_get0_name()</b> returns the (long) name of the given <b>X509_PURPOSE</b>.

       <b>X509_PURPOSE_get0_sname()</b> returns the short name of the given <b>X509_PURPOSE</b>.

       <b>X509_PURPOSE_get_trust()</b> returns the trust id of the given <b>X509_PURPOSE</b>.

       <b>X509_PURPOSE_set()</b> returns 1 on success, 0 on error.

</pre><h4><b>BUGS</b></h4><pre>
       The X509_PURPOSE implementation so far is not thread-safe.   There  may  be  race  conditions  retrieving
       purpose information while <b>X509_PURPOSE_add()</b> or X509_PURPOSE_cleanup(void) is being called.

</pre><h4><b>HISTORY</b></h4><pre>
       <b>X509_PURPOSE_get_unused_id()</b> was added in OpensSL 3.5.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright  2019-2025 The OpenSSL Project Authors. All Rights Reserved.  Licensed under the Apache License
       2.0 (the "License"). You may not use this file except in compliance with the License. You  can  obtain  a
       copy in the file LICENSE in the source distribution or at &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                           <u><a href="../man3SSL/X509_CHECK_PURPOSE.3SSL.html">X509_CHECK_PURPOSE</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>