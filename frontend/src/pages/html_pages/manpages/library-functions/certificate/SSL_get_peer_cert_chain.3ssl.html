<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_get_peer_cert_chain, SSL_get0_verified_chain - get the X509 certificate chain of the peer</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_get_peer_cert_chain, SSL_get0_verified_chain - get the X509 certificate chain of the peer

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        STACK_OF(X509) *SSL_get_peer_cert_chain(const SSL *ssl);
        STACK_OF(X509) *SSL_get0_verified_chain(const SSL *ssl);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_get_peer_cert_chain()</b> returns a pointer to STACK_OF(X509) certificates forming the certificate chain
       sent by the peer. If called on the client side, the stack also contains the peer's certificate; if called
       on the server side, the peer's certificate must be obtained separately using <b><a href="../man3/SSL_get_peer_certificate.3.html">SSL_get_peer_certificate</a></b>(3).
       If the peer did not present a certificate, NULL is returned.

       NB: <b>SSL_get_peer_cert_chain()</b> returns the peer chain as sent by the peer: it only consists of
       certificates the peer has sent (in the order the peer has sent them) it is <b>not</b> a verified chain.

       <b>SSL_get0_verified_chain()</b> returns the <b>verified</b> certificate chain of the peer including the peer's end
       entity certificate. It must be called after a session has been successfully established. If peer
       verification was not successful (as indicated by <b>SSL_get_verify_result()</b> not returning X509_V_OK) the
       chain may be incomplete or invalid.

</pre><h4><b>NOTES</b></h4><pre>
       If the session is resumed peers do not send certificates so a NULL pointer is returned by these
       functions. Applications can call <b>SSL_session_reused()</b> to determine whether a session is resumed.

       The reference count of each certificate in the returned STACK_OF(X509) object is not incremented and the
       returned stack may be invalidated by renegotiation.  If applications wish to use any certificates in the
       returned chain indefinitely they must increase the reference counts using <b>X509_up_ref()</b> or obtain a copy
       of the whole chain with <b>X509_chain_up_ref()</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The following return values can occur:

       NULL
           No certificate was presented by the peer or no connection was established or the certificate chain is
           no longer available when a session is reused.

       Pointer to a STACK_OF(X509)
           The return value points to the certificate chain presented by the peer.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7), <b><a href="../man3/SSL_get_peer_certificate.3.html">SSL_get_peer_certificate</a></b>(3), <b><a href="../man3/X509_up_ref.3.html">X509_up_ref</a></b>(3), <b><a href="../man3/X509_chain_up_ref.3.html">X509_chain_up_ref</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2016 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                      <u><a href="../man3SSL/SSL_GET_PEER_CERT_CHAIN.3SSL.html">SSL_GET_PEER_CERT_CHAIN</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>