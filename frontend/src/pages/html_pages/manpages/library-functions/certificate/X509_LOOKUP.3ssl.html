<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X509_LOOKUP, X509_LOOKUP_TYPE, X509_LOOKUP_new, X509_LOOKUP_free, X509_LOOKUP_init, X509_LOOKUP_shutdown,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       X509_LOOKUP, X509_LOOKUP_TYPE, X509_LOOKUP_new, X509_LOOKUP_free, X509_LOOKUP_init, X509_LOOKUP_shutdown,
       X509_LOOKUP_set_method_data, X509_LOOKUP_get_method_data, X509_LOOKUP_ctrl_ex, X509_LOOKUP_ctrl,
       X509_LOOKUP_load_file_ex, X509_LOOKUP_load_file, X509_LOOKUP_add_dir, X509_LOOKUP_add_store_ex,
       X509_LOOKUP_add_store, X509_LOOKUP_load_store_ex, X509_LOOKUP_load_store, X509_LOOKUP_get_store,
       X509_LOOKUP_by_subject_ex, X509_LOOKUP_by_subject, X509_LOOKUP_by_issuer_serial,
       X509_LOOKUP_by_fingerprint, X509_LOOKUP_by_alias - OpenSSL certificate lookup mechanisms

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/x509_vfy.h&gt;

        typedef x509_lookup_st X509_LOOKUP;

        typedef enum X509_LOOKUP_TYPE;

        X509_LOOKUP *X509_LOOKUP_new(X509_LOOKUP_METHOD *method);
        int X509_LOOKUP_init(X509_LOOKUP *ctx);
        int X509_LOOKUP_shutdown(X509_LOOKUP *ctx);
        void X509_LOOKUP_free(X509_LOOKUP *ctx);

        int X509_LOOKUP_set_method_data(X509_LOOKUP *ctx, void *data);
        void *X509_LOOKUP_get_method_data(const X509_LOOKUP *ctx);

        int X509_LOOKUP_ctrl_ex(X509_LOOKUP *ctx, int cmd, const char *argc, long argl,
                                char **ret, OSSL_LIB_CTX *libctx, const char *propq);
        int X509_LOOKUP_ctrl(X509_LOOKUP *ctx, int cmd, const char *argc,
                             long argl, char **ret);
        int X509_LOOKUP_load_file_ex(X509_LOOKUP *ctx, char *name, long type,
                                     OSSL_LIB_CTX *libctx, const char *propq);
        int X509_LOOKUP_load_file(X509_LOOKUP *ctx, char *name, long type);
        int X509_LOOKUP_load_file_ex(X509_LOOKUP *ctx, char *name, long type,
                                     OSSL_LIB_CTX *libctx, const char *propq);
        int X509_LOOKUP_add_dir(X509_LOOKUP *ctx, char *name, long type);
        int X509_LOOKUP_add_store_ex(X509_LOOKUP *ctx, char *uri, OSSL_LIB_CTX *libctx,
                                     const char *propq);
        int X509_LOOKUP_add_store(X509_LOOKUP *ctx, char *uri);
        int X509_LOOKUP_load_store_ex(X509_LOOKUP *ctx, char *uri, OSSL_LIB_CTX *libctx,
                                      const char *propq);
        int X509_LOOKUP_load_store(X509_LOOKUP *ctx, char *uri);

        X509_STORE *X509_LOOKUP_get_store(const X509_LOOKUP *ctx);

        int X509_LOOKUP_by_subject_ex(X509_LOOKUP *ctx, X509_LOOKUP_TYPE type,
                                      const X509_NAME *name, X509_OBJECT *ret,
                                      OSSL_LIB_CTX *libctx, const char *propq);
        int X509_LOOKUP_by_subject(X509_LOOKUP *ctx, X509_LOOKUP_TYPE type,
                                   const X509_NAME *name, X509_OBJECT *ret);
        int X509_LOOKUP_by_issuer_serial(X509_LOOKUP *ctx, X509_LOOKUP_TYPE type,
                                         const X509_NAME *name,
                                         const ASN1_INTEGER *serial, X509_OBJECT *ret);
        int X509_LOOKUP_by_fingerprint(X509_LOOKUP *ctx, X509_LOOKUP_TYPE type,
                                       const unsigned char *bytes, int len,
                                       X509_OBJECT *ret);
        int X509_LOOKUP_by_alias(X509_LOOKUP *ctx, X509_LOOKUP_TYPE type,
                                 const char *str, int len, X509_OBJECT *ret);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>X509_LOOKUP</b> structure holds the information needed to look up certificates and CRLs according to an
       associated <b><a href="../man3/X509_LOOKUP_METHOD.3.html">X509_LOOKUP_METHOD</a></b>(3).  Multiple <b>X509_LOOKUP</b> instances can be added to an <b><a href="../man3/X509_STORE.3.html">X509_STORE</a></b>(3) to
       enable lookup in that store.

       <b>X509_LOOKUP_new()</b> creates a new <b>X509_LOOKUP</b> using the given lookup <u>method</u>.  It can also be created by
       calling <b><a href="../man3/X509_STORE_add_lookup.3.html">X509_STORE_add_lookup</a></b>(3), which will associate a <b>X509_STORE</b> with the lookup mechanism.

       <b>X509_LOOKUP_init()</b> initializes the internal state and resources as needed by the given <b>X509_LOOKUP</b> to do
       its work.

       <b>X509_LOOKUP_shutdown()</b> tears down the internal state and resources of the given <b>X509_LOOKUP</b>.

       <b>X509_LOOKUP_free()</b> destructs the given <b>X509_LOOKUP</b>.  If the argument is NULL, nothing is done.

       <b>X509_LOOKUP_set_method_data()</b> and <b>X509_LOOKUP_get_method_data()</b> associates and retrieves a pointer to
       application data to and from the given <b>X509_LOOKUP</b>, respectively.

       <b>X509_LOOKUP_ctrl_ex()</b> is used to set or get additional data to or from a <b>X509_LOOKUP</b> structure using any
       control function in the associated <b><a href="../man3/X509_LOOKUP_METHOD.3.html">X509_LOOKUP_METHOD</a></b>(3).  The arguments of the control command are
       passed via <u>argc</u> and <u>argl</u>, its return value via <u>*ret</u>. The library context <u>libctx</u> and property query <u>propq</u>
       are used when fetching algorithms from providers.  The meaning of the arguments depends on the <u>cmd</u> number
       of the control command. In general, this function is not called directly, but wrapped by a macro call,
       see below.  The control <u>cmd</u>s known to OpenSSL are discussed in more depth in "Control Commands".

       <b>X509_LOOKUP_ctrl()</b> is similar to <b>X509_LOOKUP_ctrl_ex()</b> but uses NULL for the library context <u>libctx</u> and
       property query <u>propq</u>.

       <b>X509_LOOKUP_load_file_ex()</b> passes a filename to be loaded immediately into the associated <b>X509_STORE</b>. The
       library context <u>libctx</u> and property query <u>propq</u> are used when fetching algorithms from providers.  <u>type</u>
       indicates what type of object is expected.  This can only be used with a lookup using the implementation
       <b><a href="../man3/X509_LOOKUP_file.3.html">X509_LOOKUP_file</a></b>(3).

       <b>X509_LOOKUP_load_file()</b> is similar to <b>X509_LOOKUP_load_file_ex()</b> but uses NULL for the library context
       <u>libctx</u> and property query <u>propq</u>.

       <b>X509_LOOKUP_add_dir()</b> passes a directory specification from which certificates and CRLs are loaded on
       demand into the associated <b>X509_STORE</b>.  <u>type</u> indicates what type of object is expected.  This can only be
       used with a lookup using the implementation <b><a href="../man3/X509_LOOKUP_hash_dir.3.html">X509_LOOKUP_hash_dir</a></b>(3).

       <b>X509_LOOKUP_add_store_ex()</b> passes a URI for a directory-like structure from which containers with
       certificates and CRLs are loaded on demand into the associated <b>X509_STORE</b>. The library context <u>libctx</u> and
       property query <u>propq</u> are used when fetching algorithms from providers.

       <b>X509_LOOKUP_add_store()</b> is similar to <b>X509_LOOKUP_add_store_ex()</b> but uses NULL for the library context
       <u>libctx</u> and property query <u>propq</u>.

       <b>X509_LOOKUP_load_store_ex()</b> passes a URI for a single container from which certificates and CRLs are
       immediately loaded into the associated <b>X509_STORE</b>. The library context <u>libctx</u> and property query <u>propq</u>
       are used when fetching algorithms from providers.  These functions can only be used with a lookup using
       the implementation <b><a href="../man3/X509_LOOKUP_store.3.html">X509_LOOKUP_store</a></b>(3).

       <b>X509_LOOKUP_load_store()</b> is similar to <b>X509_LOOKUP_load_store_ex()</b> but uses NULL for the library context
       <u>libctx</u> and property query <u>propq</u>.

       <b>X509_LOOKUP_load_file_ex()</b>, <b>X509_LOOKUP_load_file()</b>, <b>X509_LOOKUP_add_dir()</b>, <b>X509_LOOKUP_add_store_ex()</b>
       <b>X509_LOOKUP_add_store()</b>, <b>X509_LOOKUP_load_store_ex()</b> and <b>X509_LOOKUP_load_store()</b> are implemented as
       macros that use <b>X509_LOOKUP_ctrl()</b>.

       <b>X509_LOOKUP_by_subject_ex()</b>, <b>X509_LOOKUP_by_subject()</b>, <b>X509_LOOKUP_by_issuer_serial()</b>,
       <b>X509_LOOKUP_by_fingerprint()</b>, and <b>X509_LOOKUP_by_alias()</b> look up certificates and CRLs in the
       <b><a href="../man3/X509_STORE.3.html">X509_STORE</a></b>(3) associated with the <b>X509_LOOKUP</b> using different criteria, where the looked up object is
       stored in <u>ret</u>.  Some of the underlying <b>X509_LOOKUP_METHOD</b>s will also cache objects matching the criteria
       in the associated <b>X509_STORE</b>, which makes it possible to handle cases where the criteria have more than
       one hit.

   <b>Control</b> <b>Commands</b>
       The <b>X509_LOOKUP_METHOD</b>s built into OpenSSL recognize the following <b>X509_LOOKUP_ctrl()</b> <u>cmd</u>s:

       <b>X509_L_FILE_LOAD</b>
           This is the command that <b>X509_LOOKUP_load_file_ex()</b> and <b>X509_LOOKUP_load_file()</b> use.  The filename is
           passed in <u>argc</u>, and the type in <u>argl</u>.

       <b>X509_L_ADD_DIR</b>
           This  is the command that <b>X509_LOOKUP_add_dir()</b> uses.  The directory specification is passed in <u>argc</u>,
           and the type in <u>argl</u>.

       <b>X509_L_ADD_STORE</b>
           This is the command that <b>X509_LOOKUP_add_store_ex()</b> and  <b>X509_LOOKUP_add_store()</b>  use.   The  URI  is
           passed in <u>argc</u>.

       <b>X509_L_LOAD_STORE</b>
           This  is  the  command that <b>X509_LOOKUP_load_store_ex()</b> and <b>X509_LOOKUP_load_store()</b> use.  The URI is
           passed in <u>argc</u>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>X509_LOOKUP_new()</b> returns a <b>X509_LOOKUP</b> pointer when successful, or NULL on error.

       <b>X509_LOOKUP_init()</b> and <b>X509_LOOKUP_shutdown()</b> return 1 on success, or 0 on error.

       <b>X509_LOOKUP_ctrl_ex()</b> and <b>X509_LOOKUP_ctrl()</b> return -1 if the  <b>X509_LOOKUP</b>  doesn't  have  an  associated
       <b>X509_LOOKUP_METHOD</b>,  or 1 if the doesn't have a control function.  Otherwise, it returns what the control
       function in the <b>X509_LOOKUP_METHOD</b> returns, which is usually 1 on success and 0 on error but  could  also
       be -1 on failure.

       <b>X509_LOOKUP_get_store()</b> returns a <b>X509_STORE</b> pointer if there is one, otherwise NULL.

       <b>X509_LOOKUP_by_subject_ex()</b>  returns  0  if  there  is  no  <b>X509_LOOKUP_METHOD</b> that implements any of the
       <b>get_by_subject_ex()</b> or <b>get_by_subject()</b> functions.  It calls <b>get_by_subject_ex()</b>  if  present,  otherwise
       <b>get_by_subject()</b>, and returns the result of the function, which is usually 1 on success and 0 on error.

       <b>X509_LOOKUP_by_subject()</b>  is  similar  to <b>X509_LOOKUP_by_subject_ex()</b> but passes NULL for both the libctx
       and propq.

       <b>X509_LOOKUP_by_issuer_serial()</b>, <b>X509_LOOKUP_by_fingerprint()</b>, and <b>X509_LOOKUP_by_alias()</b> all return 0  if
       there  is  no <b>X509_LOOKUP_METHOD</b> or that method doesn't implement the corresponding function.  Otherwise,
       they return what the corresponding function in the <b>X509_LOOKUP_METHOD</b> returns,  which  is  usually  1  on
       success and 0 in error.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/X509_LOOKUP_METHOD.3.html">X509_LOOKUP_METHOD</a></b>(3), <b><a href="../man3/X509_STORE.3.html">X509_STORE</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       The functions <b>X509_LOOKUP_by_subject_ex()</b> and <b>X509_LOOKUP_ctrl_ex()</b> were added in OpenSSL 3.0.

       The  macros  <b>X509_LOOKUP_load_file_ex()</b>,  <b>X509_LOOKUP_load_store_ex()</b>  and 509_LOOKUP_add_store_ex() were
       added in OpenSSL 3.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2020-2024 The OpenSSL Project Authors. All Rights Reserved.

       Licensed under the Apache License 2.0 (the "License").  You may not use this file  except  in  compliance
       with  the  License.   You  can  obtain  a  copy  in  the  file  LICENSE  in the source distribution or at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                                  <u><a href="../man3SSL/X509_LOOKUP.3SSL.html">X509_LOOKUP</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>