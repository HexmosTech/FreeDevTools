<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X509_get0_subject_key_id, X509_get0_authority_key_id, X509_get0_authority_issuer,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       X509_get0_subject_key_id, X509_get0_authority_key_id, X509_get0_authority_issuer,
       X509_get0_authority_serial, X509_get_pathlen, X509_get_extension_flags, X509_get_key_usage,
       X509_get_extended_key_usage, X509_set_proxy_flag, X509_set_proxy_pathlen, X509_get_proxy_pathlen -
       retrieve certificate extension data

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/x509v3.h&gt;

        long X509_get_pathlen(X509 *x);
        uint32_t X509_get_extension_flags(X509 *x);
        uint32_t X509_get_key_usage(X509 *x);
        uint32_t X509_get_extended_key_usage(X509 *x);
        const ASN1_OCTET_STRING *X509_get0_subject_key_id(X509 *x);
        const ASN1_OCTET_STRING *X509_get0_authority_key_id(X509 *x);
        const GENERAL_NAMES *X509_get0_authority_issuer(X509 *x);
        const ASN1_INTEGER *X509_get0_authority_serial(X509 *x);
        void X509_set_proxy_flag(X509 *x);
        void X509_set_proxy_pathlen(int l);
        long X509_get_proxy_pathlen(X509 *x);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       These functions retrieve information related to commonly used certificate extensions.

       <b>X509_get_pathlen()</b> retrieves the path length extension from a certificate.  This extension is used to
       limit the length of a cert chain that may be issued from that CA.

       <b>X509_get_extension_flags()</b> retrieves general information about a certificate, it will return one or more
       of the following flags ored together.

       <b>EXFLAG_V1</b>
           The certificate is an obsolete version 1 certificate.

       <b>EXFLAG_BCONS</b>
           The certificate contains a basic constraints extension.

       <b>EXFLAG_CA</b>
           The certificate contains basic constraints and asserts the CA flag.

       <b>EXFLAG_PROXY</b>
           The certificate is a valid proxy certificate.

       <b>EXFLAG_SI</b>
           The certificate is self issued (that is subject and issuer names match).

       <b>EXFLAG_SS</b>
           The subject and issuer names match and extension values imply it is self signed.

       <b>EXFLAG_FRESHEST</b>
           The freshest CRL extension is present in the certificate.

       <b>EXFLAG_CRITICAL</b>
           The certificate contains an unhandled critical extension.

       <b>EXFLAG_INVALID</b>
           Some  certificate  extension values are invalid or inconsistent.  The certificate should be rejected.
           This bit may also be raised after an out-of-memory error while processing the X509 object, so it  may
           not be related to the processed ASN1 object itself.

       <b>EXFLAG_NO_FINGERPRINT</b>
           Failed  to compute the internal SHA1 hash value of the certificate or CRL.  This may be due to malloc
           failure or because no SHA1 implementation was found.

       <b>EXFLAG_INVALID_POLICY</b>
           The NID_certificate_policies certificate extension is invalid or inconsistent. The certificate should
           be rejected.  This bit may also be raised after an out-of-memory  error  while  processing  the  X509
           object, so it may not be related to the processed ASN1 object itself.

       <b>EXFLAG_KUSAGE</b>
           The   certificate   contains   a   key   usage   extension.   The   value   can  be  retrieved  using
           <b>X509_get_key_usage()</b>.

       <b>EXFLAG_XKUSAGE</b>
           The certificate contains  an  extended  key  usage  extension.  The  value  can  be  retrieved  using
           <b>X509_get_extended_key_usage()</b>.

       <b>X509_get_key_usage()</b>  returns  the value of the key usage extension.  If key usage is present will return
       zero   or   more   of   the   flags:   <b>KU_DIGITAL_SIGNATURE</b>,   <b>KU_NON_REPUDIATION</b>,   <b>KU_KEY_ENCIPHERMENT</b>,
       <b>KU_DATA_ENCIPHERMENT</b>,    <b>KU_KEY_AGREEMENT</b>,    <b>KU_KEY_CERT_SIGN</b>,    <b>KU_CRL_SIGN</b>,    <b>KU_ENCIPHER_ONLY</b>    or
       <b>KU_DECIPHER_ONLY</b> corresponding to individual key usage bits. If key usage is absent  then  <b>UINT32_MAX</b>  is
       returned.

       <b>X509_get_extended_key_usage()</b>  returns  the  value  of  the extended key usage extension. If extended key
       usage is present it will return zero or more of the  flags:  <b>XKU_SSL_SERVER</b>,  <b>XKU_SSL_CLIENT</b>,  <b>XKU_SMIME</b>,
       <b>XKU_CODE_SIGN</b>  <b>XKU_OCSP_SIGN</b>,  <b>XKU_TIMESTAMP</b>, <b>XKU_DVCS</b> or <b>XKU_ANYEKU</b>. These correspond to the OIDs <b>id-kp-</b>
       <b>serverAuth</b>,  <b>id-kp-clientAuth</b>,  <b>id-kp-emailProtection</b>,   <b>id-kp-codeSigning</b>,   <b>id-kp-OCSPSigning</b>,   <b>id-kp-</b>
       <b>timeStamping</b>,  <b>id-kp-dvcs</b>  and  <b>anyExtendedKeyUsage</b>  respectively.  Additionally <b>XKU_SGC</b> is set if either
       Netscape or Microsoft SGC OIDs are present.

       <b>X509_get0_subject_key_id()</b> returns an internal  pointer  to  the  subject  key  identifier  of  <b>x</b>  as  an
       <b>ASN1_OCTET_STRING</b> or <b>NULL</b> if the extension is not present or cannot be parsed.

       <b>X509_get0_authority_key_id()</b>  returns  an  internal  pointer  to  the authority key identifier of <b>x</b> as an
       <b>ASN1_OCTET_STRING</b> or <b>NULL</b> if the extension is not present or cannot be parsed.

       <b>X509_get0_authority_issuer()</b> returns an internal pointer to the authority certificate issuer of  <b>x</b>  as  a
       stack of <b>GENERAL_NAME</b> structures or <b>NULL</b> if the extension is not present or cannot be parsed.

       <b>X509_get0_authority_serial()</b>  returns an internal pointer to the authority certificate serial number of <b>x</b>
       as an <b>ASN1_INTEGER</b> or <b>NULL</b> if the extension is not present or cannot be parsed.

       <b>X509_set_proxy_flag()</b> marks the certificate with the <b>EXFLAG_PROXY</b> flag.  This is for the users  who  need
       to mark non-RFC3820 proxy certificates as such, as OpenSSL only detects RFC3820 compliant ones.

       <b>X509_set_proxy_pathlen()</b> sets the proxy certificate path length for the given certificate <b>x</b>.  This is for
       the  users  who  need  to  mark  non-RFC3820  proxy certificates as such, as OpenSSL only detects RFC3820
       compliant ones.

       <b>X509_get_proxy_pathlen()</b> returns the proxy certificate path length for the given certificate <b>x</b> if it is a
       proxy certificate.

</pre><h4><b>NOTES</b></h4><pre>
       The value of the flags correspond to extension values which are cached in  the  <b>X509</b>  structure.  If  the
       flags  returned  do  not  provide  sufficient  information an application should examine extension values
       directly for example using <b>X509_get_ext_d2i()</b>.

       If the key usage or extended key usage extension is absent then typically usage is unrestricted. For this
       reason <b>X509_get_key_usage()</b> and <b>X509_get_extended_key_usage()</b> return <b>UINT32_MAX</b>  when  the  corresponding
       extension  is  absent. Applications can additionally check the return value of <b>X509_get_extension_flags()</b>
       and take appropriate action is an extension is absent.

       If <b>X509_get0_subject_key_id()</b> returns <b>NULL</b> then the extension may be absent  or  malformed.  Applications
       can determine the precise reason using <b>X509_get_ext_d2i()</b>.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       <b>X509_get_pathlen()</b> returns the path length value, or -1 if the extension is not present.

       <b>X509_get_extension_flags()</b>,  <b>X509_get_key_usage()</b>  and <b>X509_get_extended_key_usage()</b> return sets of flags
       corresponding to the certificate extension values.

       <b>X509_get0_subject_key_id()</b> returns the subject key  identifier  as  a  pointer  to  an  <b>ASN1_OCTET_STRING</b>
       structure or <b>NULL</b> if the extension is absent or an error occurred during parsing.

       <b>X509_get_proxy_pathlen()</b>  returns the path length value if the given certificate is a proxy one and has a
       path length set, and -1 otherwise.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man3/X509_check_purpose.3.html">X509_check_purpose</a></b>(3)

</pre><h4><b>HISTORY</b></h4><pre>
       <b>X509_get_pathlen()</b>, <b>X509_set_proxy_flag()</b>,  <b>X509_set_proxy_pathlen()</b>  and  <b>X509_get_proxy_pathlen()</b>  were
       added in OpenSSL 1.1.0.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2015-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                     <u><a href="../man3SSL/X509_GET_EXTENSION_FLAGS.3SSL.html">X509_GET_EXTENSION_FLAGS</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>