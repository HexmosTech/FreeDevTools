<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL_CTX_load_verify_dir, SSL_CTX_load_verify_file, SSL_CTX_load_verify_store,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libssl-doc">libssl-doc_3.5.0-2ubuntu1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       SSL_CTX_load_verify_dir, SSL_CTX_load_verify_file, SSL_CTX_load_verify_store,
       SSL_CTX_set_default_verify_paths, SSL_CTX_set_default_verify_dir, SSL_CTX_set_default_verify_file,
       SSL_CTX_set_default_verify_store, SSL_CTX_load_verify_locations - set default locations for trusted CA
       certificates

</pre><h4><b>SYNOPSIS</b></h4><pre>
        #include &lt;openssl/ssl.h&gt;

        int SSL_CTX_load_verify_dir(SSL_CTX *ctx, const char *CApath);
        int SSL_CTX_load_verify_file(SSL_CTX *ctx, const char *CAfile);
        int SSL_CTX_load_verify_store(SSL_CTX *ctx, const char *CAstore);

        int SSL_CTX_set_default_verify_paths(SSL_CTX *ctx);

        int SSL_CTX_set_default_verify_dir(SSL_CTX *ctx);
        int SSL_CTX_set_default_verify_file(SSL_CTX *ctx);
        int SSL_CTX_set_default_verify_store(SSL_CTX *ctx);

        int SSL_CTX_load_verify_locations(SSL_CTX *ctx, const char *CAfile,
                                          const char *CApath);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>SSL_CTX_load_verify_locations()</b>, <b>SSL_CTX_load_verify_dir()</b>, <b>SSL_CTX_load_verify_file()</b>,
       <b>SSL_CTX_load_verify_store()</b> specifies the locations for <b>ctx</b>, at which CA certificates for verification
       purposes are located. The certificates available via <b>CAfile</b>, <b>CApath</b> and <b>CAstore</b> are trusted. <b>ctx</b> <b>MUST</b> <b>NOT</b>
       be NULL

       Details of the certificate verification and chain checking process are described in "Certification Path
       Validation" in <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1).

       <b>SSL_CTX_set_default_verify_paths()</b> specifies that the default locations from which CA certificates are
       loaded should be used. There is one default directory, one default file and one default store.  The
       default CA certificates directory is called <u>certs</u> in the default OpenSSL directory, and this is also the
       default store.  Alternatively the <b>SSL_CERT_DIR</b> environment variable can be defined to override this
       location.  The default CA certificates file is called <u>cert.pem</u> in the default OpenSSL directory.
       Alternatively the <b>SSL_CERT_FILE</b> environment variable can be defined to override this location.  <b>ctx</b> <b>MUST</b>
       <b>NOT</b> be NULL.

       <b>SSL_CTX_set_default_verify_dir()</b> is similar to <b>SSL_CTX_set_default_verify_paths()</b> except that just the
       default directory is used.

       <b>SSL_CTX_set_default_verify_file()</b> is similar to <b>SSL_CTX_set_default_verify_paths()</b> except that just the
       default file is used.

       <b>SSL_CTX_set_default_verify_store()</b> is similar to <b>SSL_CTX_set_default_verify_paths()</b> except that just the
       default store is used.

</pre><h4><b>NOTES</b></h4><pre>
       If <b>CAfile</b> is not NULL, it points to a file of CA certificates in PEM format. The file can contain several
       CA certificates identified by

        -----BEGIN CERTIFICATE-----
        ... (CA certificate in base64 encoding) ...

        -----END CERTIFICATE-----
       sequences. Before, between, and after the certificates text is allowed which can be used e.g. for
       descriptions of the certificates.

       The <b>CAfile</b> is processed on execution of the <b>SSL_CTX_load_verify_locations()</b> function.

       If <b>CApath</b> is not NULL, it points to a directory containing CA certificates in PEM format. The files each
       contain one CA certificate. The files are looked up by the CA subject name hash value, which must hence
       be available.  If more than one CA certificate with the same name hash value exist, the extension must be
       different (e.g. 9d66eef0.0, 9d66eef0.1 etc). The search is performed in the ordering of the extension
       number, regardless of other properties of the certificates.  Use the <b>c_rehash</b> utility to create the
       necessary links.

       The certificates in <b>CApath</b> are only looked up when required, e.g. when building the certificate chain or
       when actually performing the verification of a peer certificate.

       When looking up CA certificates for chain building, the OpenSSL library will search for suitable
       certificates first in <b>CAfile</b>, then in <b>CApath</b>.  Details of the chain building process are described in
       "Certification Path Building" in <b><a href="../man1/openssl-verification-options.1.html">openssl-verification-options</a></b>(1).

       If <b>CAstore</b> is not NULL, it's a URI for to a store, which may represent a single container or a whole
       catalogue of containers.  Apart from the <b>CAstore</b> not necessarily being a local file or directory, it's
       generally treated the same way as a <b>CApath</b>.

       In server mode, when requesting a client certificate, the server must send the list of CAs of which it
       will accept client certificates. This list is not influenced by the contents of <b>CAfile</b> or <b>CApath</b> and must
       explicitly be set using the <b><a href="../man3/SSL_CTX_set_client_CA_list.3.html">SSL_CTX_set_client_CA_list</a></b>(3) family of functions.

       When building its own certificate chain, an OpenSSL client/server will try to fill in missing
       certificates from <b>CAfile</b>/<b>CApath</b>, if the certificate chain was not explicitly specified (see
       <b><a href="../man3/SSL_CTX_add_extra_chain_cert.3.html">SSL_CTX_add_extra_chain_cert</a></b>(3), <b><a href="../man3/SSL_CTX_use_certificate.3.html">SSL_CTX_use_certificate</a></b>(3).

</pre><h4><b>WARNINGS</b></h4><pre>
       If several CA certificates matching the name, key identifier, and serial number condition are available,
       only the first one will be examined. This may lead to unexpected results if the same CA certificate is
       available with different expiration dates. If a "certificate expired" verification error occurs, no other
       certificate will be searched. Make sure to not have expired certificates mixed with valid ones.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       For SSL_CTX_load_verify_locations the following return values can occur:

       0   The  operation  failed  because  <b>CAfile</b> and <b>CApath</b> are NULL or the processing at one of the locations
           specified failed. Check the error stack to find out the reason.

       1   The operation succeeded.

       <b>SSL_CTX_set_default_verify_paths()</b>,                 <b>SSL_CTX_set_default_verify_dir()</b>                  and
       <b>SSL_CTX_set_default_verify_file()</b>  all return 1 on success or 0 on failure. A missing default location is
       still treated as a success.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Generate a CA certificate file with descriptive text from the CA certificates ca1.pem ca2.pem ca3.pem:

        #!<a href="file:/bin/sh">/bin/sh</a>
        rm CAfile.pem
        for i in ca1.pem ca2.pem ca3.pem ; do
            openssl x509 -in $i -text &gt;&gt; CAfile.pem
        done

       Prepare the directory /some/where/certs containing several CA certificates for use as <b>CApath</b>:

        cd /some/where/certs
        c_rehash .

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man7/ssl.7.html">ssl</a></b>(7),     <b><a href="../man3/SSL_CTX_set_client_CA_list.3.html">SSL_CTX_set_client_CA_list</a></b>(3),     <b><a href="../man3/SSL_get_client_CA_list.3.html">SSL_get_client_CA_list</a></b>(3),     <b><a href="../man3/SSL_CTX_use_certificate.3.html">SSL_CTX_use_certificate</a></b>(3),
       <b><a href="../man3/SSL_CTX_add_extra_chain_cert.3.html">SSL_CTX_add_extra_chain_cert</a></b>(3), <b><a href="../man3/SSL_CTX_set_cert_store.3.html">SSL_CTX_set_cert_store</a></b>(3), <b><a href="../man3/SSL_CTX_set_client_CA_list.3.html">SSL_CTX_set_client_CA_list</a></b>(3)

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright 2000-2021 The OpenSSL Project Authors. All Rights Reserved.

       Licensed  under  the  Apache License 2.0 (the "License").  You may not use this file except in compliance
       with the License.  You can obtain  a  copy  in  the  file  LICENSE  in  the  source  distribution  or  at
       &lt;https://www.openssl.org/source/license.html&gt;.

3.5.0                                              2025-06-04                <u><a href="../man3SSL/SSL_CTX_LOAD_VERIFY_LOCATIONS.3SSL.html">SSL_CTX_LOAD_VERIFY_LOCATIONS</a></u>(3SSL)
</pre>
 </div>
</div></section>
</div>
</body>
</html>