<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OF_getprop,  OF_getproplen, OF_getencprop, OF_hasprop, OF_searchprop, OF_searchencprop, OF_getprop_alloc,</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       OF_getprop,  OF_getproplen, OF_getencprop, OF_hasprop, OF_searchprop, OF_searchencprop, OF_getprop_alloc,
       OF_getencprop_alloc,  OF_getprop_alloc_multi,   OF_getencprop_alloc_multi,   OF_prop_free,   OF_nextprop,
       OF_setprop â€” access properties of device tree node

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;dev/ofw/ofw_bus.h&gt;</b>
       <b>#include</b> <b>&lt;dev/ofw/ofw_bus_subr.h&gt;</b>

       <u>ssize_t</u>
       <b>OF_getproplen</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>);

       <u>ssize_t</u>
       <b>OF_getprop</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>, <u>void</u> <u>*buf</u>, <u>size_t</u> <u>len</u>);

       <u>ssize_t</u>
       <b>OF_getencprop</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*prop</u>, <u>pcell_t</u> <u>*buf</u>, <u>size_t</u> <u>len</u>);

       <u>int</u>
       <b>OF_hasprop</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>);

       <u>ssize_t</u>
       <b>OF_searchprop</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>, <u>void</u> <u>*buf</u>, <u>size_t</u> <u>len</u>);

       <u>ssize_t</u>
       <b>OF_searchencprop</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>, <u>pcell_t</u> <u>*buf</u>, <u>size_t</u> <u>len</u>);

       <u>ssize_t</u>
       <b>OF_getprop_alloc</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>, <u>void</u> <u>**buf</u>);

       <u>ssize_t</u>
       <b>OF_getencprop_alloc</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>, <u>pcell_t</u> <u>**buf</u>);

       <u>ssize_t</u>
       <b>OF_getprop_alloc_multi</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>, <u>int</u> <u>elsz</u>, <u>void</u> <u>**buf</u>);

       <u>ssize_t</u>
       <b>OF_getencprop_alloc_multi</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>, <u>int</u> <u>elsz</u>, <u>pcell_t</u> <u>**buf</u>);

       <u>void</u>
       <b>OF_prop_free</b>(<u>void</u> <u>*buf</u>);

       <u>int</u>
       <b>OF_nextprop</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>, <u>char</u> <u>*buf</u>, <u>size_t</u> <u>len</u>);

       <u>int</u>
       <b>OF_setprop</b>(<u>phandle_t</u> <u>node</u>, <u>const</u> <u>char</u> <u>*propname</u>, <u>const</u> <u>void</u> <u>*buf</u>, <u>size_t</u> <u>len</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Device  nodes  can  have  associated  properties.  Properties consist of a name and a value.  A name is a
       human-readable string from 1 to 31 characters long.  A value is an array  of  zero  or  more  bytes  that
       encode certain information.  The meaning of that bytes depends on how drivers interpret them.  Properties
       can encode byte arrays, text strings, unsigned 32-bit values or any combination of these types.

       Property with a zero-length value usually represents boolean information.  If the property is present, it
       signifies true, otherwise false.

       A byte array is encoded as a sequence of bytes and represents values like MAC addresses.

       A  text  string  is  a sequence of n printable characters.  It is encoded as a byte array of length n + 1
       bytes with characters represented as bytes plus a terminating null character.

       Unsigned 32-bit values, also sometimes called cells, are encoded as a sequence of 4 bytes  in  big-endian
       order.

       <b>OF_getproplen</b>()  returns either the length of the value associated with the property <u>propname</u> in the node
       identified by <u>node</u>, or 0 if the property exists but has no associated value.  If <u>propname</u> does not exist,
       -1 is returned.

       <b>OF_getprop</b>() copies a maximum of <u>len</u> bytes from the value associated with the property  <u>propname</u>  of  the
       device  node  <u>node</u>  into  the memory specified by <u>buf</u>.  Returns the actual size of the value or -1 if the
       property does not exist.

       <b>OF_getencprop</b>() copies a maximum of <u>len</u> bytes into memory specified by <u>buf</u>,  then  converts  cell  values
       from big-endian to host byte order.  Returns the actual size of the value in bytes, or -1 if the property
       does not exist.  <u>len</u> must be a multiple of 4.

       <b>OF_hasprop</b>()  returns  1  if  the  device node <u>node</u> has a property specified by <u>propname</u>, and zero if the
       property does not exist.

       <b>OF_searchprop</b>() recursively looks for the property specified by <u>propname</u> starting with  the  device  node
       <u>node</u>  followed by the parent node and up to the root node.  If the property is found, the function copies
       a maximum of <u>len</u> bytes of the value associated with the  property  into  the  memory  specified  by  <u>buf</u>.
       Returns the actual size in bytes of the value, or -1 if the property does not exist.

       <b>OF_searchencprop</b>() recursively looks for the property specified by <u>propname</u> starting with the device node
       <u>node</u>  followed by the parent node and up to the root node.  If the property is found, the function copies
       a maximum of <u>len</u> bytes of the value associated with the property into the memory specified by  <u>buf</u>,  then
       converts  cell values from big-endian to host byte order.  Returns the actual size in bytes of the value,
       or -1 if the property does not exist.

       <b>OF_getprop_alloc</b>() allocates memory large enough to hold the value associated with the property  <u>propname</u>
       of  the device node <u>node</u> and copies the value into the newly allocated memory region.  Returns the actual
       size of the value and stores the address of the allocated memory in <u>*buf</u>.  If the property  has  a  zero-
       sized  value  <u>*buf</u>  is  set NULL.  Returns -1 if the property does not exist or memory allocation failed.
       Allocated memory should be released when no longer required  by  calling  <b>OF_prop_free</b>().   The  function
       might sleep when allocating memory.

       <b>OF_getencprop_alloc</b>()  allocates enough memory to hold the value associated with the property <u>propname</u> of
       the device node <u>node</u>, copies the value into the newly allocated memory region,  and  then  converts  cell
       values  from  big-endian to host byte order.  The actual size of the value is returned and the address of
       allocated memory is stored in <u>*buf</u>.  If the property has zero-length value, <u>*buf</u> is set to NULL.  Returns
       -1 if the property does not exist or memory allocation failed or the size of the value is  not  divisible
       by  a  cell  size  (4  bytes).   Allocated  memory  should be released when no longer required by calling
       <b>OF_prop_free</b>().  The function might sleep when allocating memory.

       <b>OF_getprop_alloc_multi</b>() allocates memory large enough to hold the value  associated  with  the  property
       <u>propname</u>  of the device node <u>node</u> and copies the value into the newly allocated memory region.  The value
       is expected to be an array of zero or more elements <u>elsz</u> bytes long.  Returns the number of  elements  in
       the value and stores the address of the allocated memory in <u>*buf</u>.  If the property has a zero-sized value
       <u>*buf</u>  is  set NULL.  Returns -1 if the property does not exist or memory allocation failed or the size of
       the value is not divisible by <u>elsz</u>.  Allocated memory should be  released  when  no  longer  required  by
       calling <b>OF_prop_free</b>().  The function might sleep when allocating memory.

       <b>OF_getencprop_alloc_multi</b>()  allocates memory large enough to hold the value associated with the property
       <u>propname</u> of the device node <u>node</u> and copies the value into the newly allocated memory  region,  and  then
       converts cell values from big-endian to host byte order.  The value is expected to be an array of zero or
       more elements <u>elsz</u> bytes long.  Returns the number of elements in the value and stores the address of the
       allocated  memory  in  <u>*buf</u>.  If the property has a zero-sized value <u>*buf</u> is set NULL.  Returns -1 if the
       property does not exist or memory allocation failed or the size of the value is not  divisible  by  <u>elsz</u>.
       Allocated  memory  should  be  released  when no longer required by calling <b>OF_prop_free</b>().  The function
       might sleep when allocating memory.

       <b>OF_prop_free</b>() releases memory at <u>buf</u> that was allocated  by  <b>OF_getprop_alloc</b>(),  <b>OF_getencprop_alloc</b>(),
       <b>OF_getprop_alloc_multi</b>(), <b>OF_getencprop_alloc_multi</b>().

       <b>OF_nextprop</b>()  copies a maximum of <u>size</u> bytes of the name of the property following the <u>propname</u> property
       into <u>buf</u>.  If <u>propname</u> is NULL, the function copies the name of the first property  of  the  device  node
       <u>node</u>.   <b>OF_nextprop</b>()  returns -1 if <u>propname</u> is invalid or there is an internal error, 0 if there are no
       more properties after <u>propname</u>, or 1 otherwise.

       <b>OF_setprop</b>() sets the value of the property <u>propname</u> in the device node <u>node</u> to the  value  beginning  at
       the  address  specified  by  <u>buf</u> and running for <u>len</u> bytes.  If the property does not exist, the function
       tries to create it.  <b>OF_setprop</b>() returns the actual size of the new value, or -1 if the  property  value
       cannot be changed or the new property cannot be created.

</pre><h4><b>EXAMPLES</b></h4><pre>
           phandle_t node;
           phandle_t hdmixref, hdminode;
           device_t hdmi;
           uint8_t mac[6];
           char *model;

           /*
            * Get a byte array property
            */
           if (OF_getprop(node, "eth,hwaddr", mac, <a href="../manmac/sizeof.mac.html">sizeof</a>(mac)) != <a href="../manmac/sizeof.mac.html">sizeof</a>(mac))
               return;

           /*
            * Get internal node reference and device associated with it
            */
           if (OF_getencprop(node, "hdmi", &amp;hdmixref) &lt;= 0)
               return;
           hdmi = OF_device_from_xref(hdmixref);

           /*
            * Get string value of model property of HDMI framer node
            */
           hdminode = OF_node_from_xref(hdmixref);
           if (OF_getprop_alloc(hdminode, "model", (void **)&amp;model) &lt;= 0)
               return;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man9/OF_device_from_xref.9.html">OF_device_from_xref</a></u>(9) <u><a href="../man9/OF_node_from_xref.9.html">OF_node_from_xref</a></u>(9)

</pre><h4><b>AUTHORS</b></h4><pre>
       This manual page was written by Oleksandr Tymoshenko &lt;<u><a href="mailto:gonzo@FreeBSD.org">gonzo@FreeBSD.org</a></u>&gt;.

Debian                                            June 23, 2018                                    <u><a href="../man9/OF_GETPROP.9.html">OF_GETPROP</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>