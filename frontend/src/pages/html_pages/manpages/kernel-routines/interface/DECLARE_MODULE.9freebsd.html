<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DECLARE_MODULE — kernel module declaration macro</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       DECLARE_MODULE — kernel module declaration macro

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/param.h&gt;</b>
       <b>#include</b> <b>&lt;sys/kernel.h&gt;</b>
       <b>#include</b> <b>&lt;sys/module.h&gt;</b>

       <b>DECLARE_MODULE</b>(<u>name</u>, <u>moduledata_t</u> <u>data</u>, <u>sub</u>, <u>order</u>);

       <b>DECLARE_MODULE_TIED</b>(<u>name</u>, <u>moduledata_t</u> <u>data</u>, <u>sub</u>, <u>order</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>DECLARE_MODULE</b>() macro declares a generic kernel module.  It is used to register the module with the
       system, using the <b>SYSINIT</b>() macro.  <b>DECLARE_MODULE</b>()  is  usually  used  within  other  macros,  such  as
       <u><a href="../man9/DRIVER_MODULE.9.html">DRIVER_MODULE</a></u>(9),  <u><a href="../man9/DEV_MODULE.9.html">DEV_MODULE</a></u>(9)  and  <u><a href="../man9/SYSCALL_MODULE.9.html">SYSCALL_MODULE</a></u>(9).  Of course, it can also be called directly, for
       example in order to implement dynamic sysctls.

       A module declared with <b>DECLARE_MODULE_TIED</b>() will load only if the running kernel version  (as  specified
       by  __FreeBSD_version)  is  identical  to that on which it was built.  This declaration should be used by
       modules which depend on interfaces beyond the stable kernel KBI (such as  ABI  emulators  or  hypervisors
       that  rely  on internal kernel structures).  <b>DECLARE_MODULE</b>() will behave like <b>DECLARE_MODULE_TIED</b>() when
       compiled with modules built with the kernel. This allows locks and other synchronization primitives to be
       inlined safely.

       The arguments are:

       <u>name</u>    The module name, which will be used in the <b>SYSINIT</b>() call to identify the module.

       <u>data</u>    A <u>moduledata_t</u> structure, which contains two main items, the official name of  the  module  name,
               which  will be used in the <u>module_t</u> structure and a pointer to the event handler function of type
               <u>modeventhand_t</u>.

       <u>sub</u>     An argument directed to the <b>SYSINIT</b>()  macro.   Valid  values  for  this  are  contained  in  the
               <u>sysinit_sub_id</u>   enumeration  (see  &lt;<u>sys/kernel.h</u>&gt;)  and  specify  the  type  of  system  startup
               interfaces.  The <u><a href="../man9/DRIVER_MODULE.9.html">DRIVER_MODULE</a></u>(9) macro uses a value of SI_SUB_DRIVERS here  for  example,  since
               these  modules  contain  a driver for a device.  For kernel modules that are loaded at runtime, a
               value of SI_SUB_EXEC is common.

       <u>order</u>   An argument for <b>SYSINIT</b>().  It represents the KLDs order of initialization within the  subsystem.
               Valid values are defined in the <u>sysinit_elem_order</u> enumeration (&lt;<u>sys/kernel.h</u>&gt;).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man9/DEV_MODULE.9.html">DEV_MODULE</a></u>(9), <u><a href="../man9/DRIVER_MODULE.9.html">DRIVER_MODULE</a></u>(9), <u><a href="../man9/module.9.html">module</a></u>(9), <u><a href="../man9/SYSCALL_MODULE.9.html">SYSCALL_MODULE</a></u>(9)

       <u>/usr/include/sys/kernel.h</u>, <u>/usr/share/examples/kld</u>

</pre><h4><b>AUTHORS</b></h4><pre>
       This  manual  page  was  written  by  Alexander  Langer  &lt;<u><a href="mailto:alex@FreeBSD.org">alex@FreeBSD.org</a></u>&gt;, inspired by the KLD Facility
       Programming Tutorial by Andrew Reiter &lt;<u><a href="mailto:arr@watson.org">arr@watson.org</a></u>&gt;.

Debian                                          February 13, 2018                              <u><a href="../man9/DECLARE_MODULE.9.html">DECLARE_MODULE</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>