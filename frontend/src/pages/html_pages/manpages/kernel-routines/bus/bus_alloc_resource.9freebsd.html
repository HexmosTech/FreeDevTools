<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bus_alloc_resource,  bus_alloc_resource_any,  bus_alloc_resource_anywhere  —  allocate  resources  from a</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       bus_alloc_resource,  bus_alloc_resource_any,  bus_alloc_resource_anywhere  —  allocate  resources  from a
       parent bus

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/param.h&gt;</b>
       <b>#include</b> <b>&lt;sys/bus.h&gt;</b>

       <b>#include</b> <b>&lt;machine/bus.h&gt;</b>
       <b>#include</b> <b>&lt;sys/rman.h&gt;</b>
       <b>#include</b> <b>&lt;machine/resource.h&gt;</b>

       <u>struct</u> <u>resource</u> <u>*</u>
       <b>bus_alloc_resource</b>(<u>device_t</u> <u>dev</u>, <u>int</u> <u>type</u>, <u>int</u> <u>*rid</u>, <u>rman_res_t</u> <u>start</u>, <u>rman_res_t</u> <u>end</u>,  <u>rman_res_t</u> <u>count</u>,
           <u>u_int</u> <u>flags</u>);

       <u>struct</u> <u>resource</u> <u>*</u>
       <b>bus_alloc_resource_any</b>(<u>device_t</u> <u>dev</u>, <u>int</u> <u>type</u>, <u>int</u> <u>*rid</u>, <u>u_int</u> <u>flags</u>);

       <u>struct</u> <u>resource</u> <u>*</u>
       <b>bus_alloc_resource_anywhere</b>(<u>device_t</u> <u>dev</u>, <u>int</u> <u>type</u>, <u>int</u> <u>*rid</u>, <u>rman_res_t</u> <u>count</u>, <u>u_int</u> <u>flags</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This  is  an  easy  interface to the resource-management functions.  It hides the indirection through the
       parent's method table.  This function generally should be called in attach,  but  (except  in  some  rare
       cases) never earlier.

       The  <b>bus_alloc_resource_any</b>()  and  <b>bus_alloc_resource_anywhere</b>()  functions are convenience wrappers for
       <b>bus_alloc_resource</b>().  <b>bus_alloc_resource_any</b>() sets <u>start</u>, <u>end</u>, and <u>count</u> to the default  resource  (see
       description  of  <u>start</u>  below).  <b>bus_alloc_resource_anywhere</b>() sets <u>start</u> and <u>end</u> to the default resource
       and uses the provided <u>count</u> argument.

       The arguments are as follows:

       <u>dev</u> is the device that requests ownership of the resource.  Before allocation, the resource is  owned  by
       the parent bus.

       <u>type</u> is the type of resource you want to allocate.  It is one of:

       PCI_RES_BUS     for PCI bus numbers

       SYS_RES_IRQ     for IRQs

       SYS_RES_DRQ     for ISA DMA lines

       SYS_RES_IOPORT  for I/O ports

       SYS_RES_MEMORY  for I/O memory

       <u>rid</u>  points  to  a  bus specific handle that identifies the resource being allocated.  For ISA this is an
       index into an array of resources that have been setup for this device by either the PnP mechanism, or via
       the hints mechanism.  For PCCARD, this is an index into the array of resources described by the PC Card's
       CIS entry.  For PCI, the offset into PCI config space which has the BAR to use to  access  the  resource.
       The  bus  methods are free to change the RIDs that they are given as a parameter.  You must not depend on
       the value you gave it earlier.

       <u>start</u> and <u>end</u> are the start/end addresses of the resource.  If you specify values of 0ul  for  <u>start</u>  and
       ~0ul for <u>end</u> and 1 for <u>count</u>, the default values for the bus are calculated.

       <u>count</u>  is  the  size  of  the resource.  For example, the size of an I/O port is usually 1 byte (but some
       devices override this).  If you specified the default values for <u>start</u> and <u>end</u>, then the default value of
       the bus is used if <u>count</u> is smaller than the default value and <u>count</u> is used, if it is  bigger  than  the
       default value.

       <u>flags</u> sets the flags for the resource.  You can set one or more of these flags:

       RF_ALLOCATED  resource   has   been   reserved.    The   resource   still  needs  to  be  activated  with
                     <u><a href="../man9/bus_activate_resource.9.html">bus_activate_resource</a></u>(9).

       RF_ACTIVE     activate resource atomically.

       RF_PREFETCHABLE
                     resource is prefetchable.

       RF_SHAREABLE  resource permits contemporaneous sharing.  It should always be set unless you know that the
                     resource cannot be shared.  It is the bus driver's task to filter out the flag if  the  bus
                     does not support sharing.  For example, <u><a href="../man4/pccard.4.html">pccard</a></u>(4) cannot share IRQs while <u><a href="../man4/cardbus.4.html">cardbus</a></u>(4) can.

       RF_UNMAPPED   do not establish implicit mapping when activated via <u><a href="../man9/bus_activate_resource.9.html">bus_activate_resource</a></u>(9).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       A pointer to <u>struct</u> <u>resource</u> is returned on success, a null pointer otherwise.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This  is  some example code that allocates a 32 byte I/O port range and an IRQ.  The values of <u>portid</u> and
       <u>irqid</u> should be saved in the softc of the device after these calls.

               struct resource *portres, *irqres;
               int portid, irqid;

               portid = 0;
               irqid = 0;
               portres = bus_alloc_resource(dev, SYS_RES_IOPORT, &amp;portid,
                               0ul, ~0ul, 32, RF_ACTIVE);
               irqres = bus_alloc_resource_any(dev, SYS_RES_IRQ, &amp;irqid,
                               RF_ACTIVE | RF_SHAREABLE);

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man9/bus_activate_resource.9.html">bus_activate_resource</a></u>(9),    <u><a href="../man9/bus_adjust_resource.9.html">bus_adjust_resource</a></u>(9),    <u><a href="../man9/bus_map_resource.9.html">bus_map_resource</a></u>(9),     <u><a href="../man9/bus_release_resource.9.html">bus_release_resource</a></u>(9),
       <u><a href="../man9/device.9.html">device</a></u>(9), <u><a href="../man9/driver.9.html">driver</a></u>(9)

</pre><h4><b>AUTHORS</b></h4><pre>
       This  manual  page  was  written  by  Alexander  Langer  &lt;<u><a href="mailto:alex@big.endian.de">alex@big.endian.de</a></u>&gt;  with  parts by Warner Losh
       &lt;<u><a href="mailto:imp@FreeBSD.org">imp@FreeBSD.org</a></u>&gt;.

Debian                                            May 20, 2016                             <u><a href="../man9/BUS_ALLOC_RESOURCE.9.html">BUS_ALLOC_RESOURCE</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>