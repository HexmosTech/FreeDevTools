<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>priv — kernel privilege checking API</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       priv — kernel privilege checking API

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/priv.h&gt;</b>

       <u>int</u>
       <b>priv_check</b>(<u>struct</u> <u>thread</u> <u>*td</u>, <u>int</u> <u>priv</u>);

       <u>int</u>
       <b>priv_check_cred</b>(<u>struct</u> <u>ucred</u> <u>*cred</u>, <u>int</u> <u>priv</u>, <u>int</u> <u>flags</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>priv</b>  interfaces check to see if specific system privileges are granted to the passed thread, <u>td</u>, or
       credential, <u>cred</u>.  This interface  replaces  the  now  removed  <u><a href="../man9/suser.9.html">suser</a></u>(9)  privilege  checking  interface.
       Privileges  typically  represent  rights  in  one  of  two  categories:  the right to manage a particular
       component of the system, or an exemption to a  specific  policy  or  access  control  list.   The  caller
       identifies the desired privilege via the <u>priv</u> argument.  The optional flags argument, <u>flags</u>, is currently
       unused.

   <b>Privilege</b> <b>Policies</b>
       Privileges  are  typically  granted based on one of two base system policies: the superuser policy, which
       grants privilege based on the effective (or sometimes real) UID having a value  of  0,  and  the  <u><a href="../man2/jail.2.html">jail</a></u>(2)
       policy, which permits only certain privileges to be granted to processes in a jail.  The set of available
       privileges may also be influenced by the TrustedBSD MAC Framework, described in <u><a href="../man9/mac.9.html">mac</a></u>(9).

</pre><h4><b>IMPLEMENTATION</b> <b>NOTES</b></h4><pre>
       When  adding a new privilege check to a code path, first check the complete list of current privileges in
       <u>sys/priv.h</u> to see if one already exists for the class of privilege required.  Only if  there  is  not  an
       exact  match should a new privilege be added to the privilege list.  As privilege numbers becomes encoded
       in the kernel module ABI, privilege constants must not be changed as  any  kernel  modules  depending  on
       privileges  will  then  need to be recompiled.  When adding a new privilege, be certain to also determine
       whether it should be listed in <b>prison_priv_check</b>(), which includes a complete list of privileges  granted
       to the root user in <u><a href="../man2/jail.2.html">jail</a></u>(2).

       Certain  catch-all  privileges  exist, such as PRIV_DRIVER, intended to be used by device drivers, rather
       than adding a new driver-specific privilege.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       Typically, 0 will be returned for success, and EPERM will be returned on failure.  Most consumers of <b>priv</b>
       will wish to directly return the error code from a failed privilege check to user space; a  small  number
       will wish to translate it to another error code appropriate to a specific context.

       When  designing  new  APIs,  it  is  preferable to return explicit errors from a call if privilege is not
       granted rather than changing the semantics of the call but returning success.  For example, the  behavior
       exhibited  by  <u><a href="../man2/stat.2.html">stat</a></u>(2), in which the generation field is optionally zero'd out when there is insufficient
       privilege is highly undesirable, as it results in frequent privilege checks, and the caller is unable  to
       tell if an access control failure occurred.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/jail.2.html">jail</a></u>(2), <u><a href="../man9/mac.9.html">mac</a></u>(9), <u><a href="../man9/ucred.9.html">ucred</a></u>(9)

</pre><h4><b>AUTHORS</b></h4><pre>
       The <b>priv</b> API and implementation were created by Robert Watson under contract to nCircle Network Security,
       Inc.

Debian                                           August 30, 2006                                         <u><a href="../man9/PRIV.9.html">PRIV</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>