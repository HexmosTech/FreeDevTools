<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>matrix_kb - Convert integers to HAL pins.  Optionally scan a matrix of IO ports to create those integers.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/linuxcnc-uspace">linuxcnc-uspace_2.9.4-2ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       matrix_kb - Convert integers to HAL pins.  Optionally scan a matrix of IO ports to create those integers.

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>loadrt</b> <b>matrix_kb</b> <b>config=</b><u>RxCs,RxCs</u><b>...</b> <b>names=</b><u>name1,name2</u><b>...</b>

       Creates a component configured for R rows and N columns of matrix keyboard.

       If  the  <b>s</b>  option  is specified then a set of output rows will be cyclically toggled, and a set of input
       columns will be scanned.

       The <b>names</b> parameter is optional, but if used then the HAL pins and functions will use the specified names
       rather than the default ones.  This can be useful for readability and 2-pass HAL parsing.

       There must be no spaces in the parameter lists.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This component was written to convert matrix keyboard scancodes into HAL pins.  However,  it  might  also
       find uses in converting integers from 0 to N into N HAL pins.

       The component can work in two ways, and the HAL pins created vary according to mode.

       In the default mode the component expects to be given a scan code from a separate driver but could be any
       integer  from any source.  Most typically this will be the keypad scancode from a Mesa 7I73.  The default
       codes for keyup and keydown are based on the Mesa 7I73 specification with 0x40 indicating a  keydown  and
       0x80  a  keyup  event.   If  using the 7I73 it is important to match the keypad size jumpers with the HAL
       component. Valid configs for the 7I73 are 4x8 and 8x8.  Note that the component will only  work  properly
       with  the version 12 (0xC) 7I73 firmware.  The firmware version is visible on the component parameters in
       HAL.

       In the optional scan-generation mode the <b>matrix_kb.</b><u>N</u><b>.keycode</b> pin changes to an output pin and  a  set  of
       output  row  pins  and  input column pins are created.  These need to be connected to physical inputs and
       outputs to scan the matrix and return values to HAL.  Note the <b>negative-logic</b> parameter described  below,
       this will need to be set on the most common forms of inputs which float high when unconnected.

       In both modes a set of HAL output pins are created corresponding to each node of the matrix.

</pre><h4><b>FUNCTIONS</b></h4><pre>
       <b>matrix_kb.</b><u>N</u>
              Perform all requested functions.  Should be run in a slow thread for effective debouncing.

</pre><h4><b>PINS</b></h4><pre>
       <b>matrix_kb.</b><u>N</u><b>.col-</b><u>CC</u><b>-in</b> bit in
              The input pin corresponding to column C.

       <b>matrix_kb.</b><u>N</u><b>.key.r</b><u>R</u><b>c</b><u>C</u> bit out
              The pin corresponding to the key at row R column C of the matrix.

       <b>matrix_kb.</b><u>N</u><b>.keycode</b> unsigned in or out depending on mode.
              This  pin  should be connected to the scancode generator if hardware such as a 7I73 is being used.
              In this mode it is an input pin. In the internally-generated scanning mode this pin is an  output,
              but will not normally be connected.

       <b>matrix_kb.</b><u>N</u><b>.row-</b><u>RR</u><b>-out</b> <b>bit</b> <b>out</b>
              The  row  scan drive pins.  Should be connected to external hardware pins connected to the keypad.
              The row scan drive pins.Should be connected to external hardware pins connected to the keypad.

</pre><h4><b>PARAMETERS</b></h4><pre>
       <b>matrix_kb.</b><u>N</u><b>.key_rollover</b> unsigned r/w (default 2)
              With most matrix keyboards the scancodes are only unambiguous with 1 or 2 keys pressed.  With more
              keys pressed phantom keystrokes can appear.  Some keyboards are optimised to reduce this  problem,
              and  some have internal diodes so that any number of keys may be pressed simultaneously.  Increase
              the value of this parameter if such a keyboard is connected, or if  phantom  keystrokes  are  more
              acceptable than only two keys being active at one time.

       <b>matrix_kb.</b><u>N</u><b>.negative-logic</b> bit r/w (default 1) only in scan mode
              When  no  keys are pressed a typical digital input will float high.  The input will then be pulled
              low by the keypad when the corresponding poll line is low.  Set this parameter to 0 if the  IO  in
              use requires one row at a time to be high, and a high input corresponds to a button press.

LinuxCNC Documentation                             2013-03-24                                       <u><a href="../man9/MATRIX_KB.9.html">MATRIX_KB</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>