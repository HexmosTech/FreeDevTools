<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTR0, CTR1, CTR2, CTR3, CTR4, CTR5 — kernel tracing facility</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       CTR0, CTR1, CTR2, CTR3, CTR4, CTR5 — kernel tracing facility

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/param.h&gt;</b>
       <b>#include</b> <b>&lt;sys/ktr.h&gt;</b>

       <u>extern</u> <u>int</u> <u>ktr_cpumask</u>;
       <u>extern</u> <u>int</u> <u>ktr_entries</u>;
       <u>extern</u> <u>int</u> <u>ktr_extend</u>;
       <u>extern</u> <u>int</u> <u>ktr_mask</u>;
       <u>extern</u> <u>int</u> <u>ktr_verbose</u>;
       <u>extern</u> <u>struct</u> <u>ktr_entry</u> <u>ktr_buf[]</u>;

       <u>void</u>
       <b>CTR0</b>(<u>u_int</u> <u>mask</u>, <u>char</u> <u>*format</u>);

       <u>void</u>
       <b>CTR1</b>(<u>u_int</u> <u>mask</u>, <u>char</u> <u>*format</u>, <u>arg1</u>);

       <u>void</u>
       <b>CTR2</b>(<u>u_int</u> <u>mask</u>, <u>char</u> <u>*format</u>, <u>arg1</u>, <u>arg2</u>);

       <u>void</u>
       <b>CTR3</b>(<u>u_int</u> <u>mask</u>, <u>char</u> <u>*format</u>, <u>arg1</u>, <u>arg2</u>, <u>arg3</u>);

       <u>void</u>
       <b>CTR4</b>(<u>u_int</u> <u>mask</u>, <u>char</u> <u>*format</u>, <u>arg1</u>, <u>arg2</u>, <u>arg3</u>, <u>arg4</u>);

       <u>void</u>
       <b>CTR5</b>(<u>u_int</u> <u>mask</u>, <u>char</u> <u>*format</u>, <u>arg1</u>, <u>arg2</u>, <u>arg3</u>, <u>arg4</u>, <u>arg5</u>);

       <u>void</u>
       <b>CTR6</b>(<u>u_int</u> <u>mask</u>, <u>char</u> <u>*format</u>, <u>arg1</u>, <u>arg2</u>, <u>arg3</u>, <u>arg4</u>, <u>arg5</u>, <u>arg6</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       KTR  provides  a circular buffer of events that can be logged in a <u><a href="../man9/printf.9.html">printf</a></u>(9) style fashion.  These events
       can then be dumped with <u><a href="../man4/ddb.4.html">ddb</a></u>(4), <u><a href="../man1/gdb.1.html">gdb</a></u>(1) or <u><a href="../man8/ktrdump.8.html">ktrdump</a></u>(8).

       Events are created and logged in the kernel via the CTR<u>x</u> macros.  The first parameter is a mask of  event
       types  (KTR_*) defined in &lt;<u>sys/ktr.h</u>&gt;.  The event will be logged only if any of the event types specified
       in <u>mask</u> are enabled in the global event mask stored in <u>ktr_mask</u>.  The  <u>format</u>  argument  is  a  <u><a href="../man9/printf.9.html">printf</a></u>(9)
       style  format  string  used  to build the text of the event log message.  Following the <u>format</u> string are
       zero to five arguments referenced by <u>format</u>.  Each event is logged with  a  file  name  and  source  line
       number of the originating CTR call, and a timestamp in addition to the log message.

       The  event  is stored in the circular buffer with supplied arguments as is, and formatting is done at the
       dump time.  Do not use pointers to the objects with limited lifetime, for instance, strings, because  the
       pointer may become invalid when buffer is printed.

       Note that the different macros differ only in the number of arguments each one takes, as indicated by its
       name.

       The <u>ktr_entries</u> variable contains the number of entries in the <u>ktr_buf</u> array.  These variables are mostly
       useful for post-mortem crash dump tools to locate the base of the circular trace buffer and its length.

       The <u>ktr_mask</u> variable contains the run time mask of events to log.

       The CPU event mask is stored in the <u>ktr_cpumask</u> variable.

       The  <u>ktr_verbose</u>  variable stores the verbose flag that controls whether events are logged to the console
       in addition to the event buffer.

</pre><h4><b>EXAMPLES</b></h4><pre>
       This example demonstrates the use of tracepoints at the KTR_PROC logging level.

       void
       mi_switch()
       {
               ...
               /*
                * Pick a new current process and record its start time.
                */
               ...
               CTR3(KTR_PROC, "mi_switch: old proc %p (pid %d)", p, p-&gt;p_pid);
               ...
               cpu_switch();
               ...
               CTR3(KTR_PROC, "mi_switch: new proc %p (pid %d)", p, p-&gt;p_pid);
               ...
       }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man4/ktr.4.html">ktr</a></u>(4), <u><a href="../man8/ktrdump.8.html">ktrdump</a></u>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       The KTR kernel tracing facility first appeared in BSD/OS 3.0 and was imported into FreeBSD 5.0.

</pre><h4><b>BUGS</b></h4><pre>
       Currently there is one global buffer shared among all CPUs.  It might be profitable at some point in time
       to use per-CPU buffers instead so that if one CPU halts or starts spinning,  then  the  log  messages  it
       emitted just prior to halting or spinning will not be drowned out by events from the other CPUs.

       The  arguments  given in <b>CTRx</b>() macros are stored as <u>u_long</u>, so do not pass arguments larger than size of
       an <u>u_long</u> type.  For example passing 64bit arguments on 32bit architectures will give incorrect results.

Debian                                          November 30, 2008                                         <u><a href="../man9/KTR.9.html">KTR</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>