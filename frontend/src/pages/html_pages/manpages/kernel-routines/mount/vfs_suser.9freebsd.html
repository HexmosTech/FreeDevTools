<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vfs_suser — check if credentials have superuser privileges for a mount point</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       vfs_suser — check if credentials have superuser privileges for a mount point

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/param.h&gt;</b>
       <b>#include</b> <b>&lt;sys/systm.h&gt;</b>
       <b>#include</b> <b>&lt;sys/mount.h&gt;</b>

       <u>int</u>
       <b>vfs_suser</b>(<u>struct</u> <u>mount</u> <u>*mp</u>, <u>struct</u> <u>thread</u> <u>*td</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>vfs_suser</b>()  function  checks  if the credentials given include superuser powers for the given mount
       point.  It will check to see if the thread passed in has the same credentials as the  user  that  mounted
       the file system.  If so, it returns 0, otherwise it returns what <u><a href="../man9/priv_check.9.html">priv_check</a></u>(9) would have returned.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The  <b>vfs_suser</b>()  function  returns  0 if the user has superuser powers and EPERM otherwise.  This is the
       <u>reverse</u> <u>logic</u> of some other implementations of <b>suser</b>() in  which  a  TRUE  response  indicates  superuser
       powers.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/chroot.2.html">chroot</a></u>(2), <u><a href="../man2/jail.2.html">jail</a></u>(2)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>vfs_suser</b>() function was introduced in FreeBSD 5.2.

</pre><h4><b>AUTHORS</b></h4><pre>
       This manual page was written by Alfred Perlstein.

Debian                                            April 2, 2004                                     <u><a href="../man9/VFS_SUSER.9.html">VFS_SUSER</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>