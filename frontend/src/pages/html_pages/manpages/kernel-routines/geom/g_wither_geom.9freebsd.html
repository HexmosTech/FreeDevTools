<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>g_wither_geom — destroy geom and related providers and consumers when you get a chance</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       g_wither_geom — destroy geom and related providers and consumers when you get a chance

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;geom/geom.h&gt;</b>

       <u>void</u>
       <b>g_wither_geom</b>(<u>struct</u> <u>g_geom</u> <u>*gp</u>, <u>int</u> <u>error</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>g_wither_geom</b>()  function  tells  GEOM  that geom <u>gp</u> is to be destroyed.  GEOM sets an error on each
       provider of the given geom (in the orphaning process) and waits for a chance to destroy the geom.  If the
       access count of any  possessed  consumer  goes  to  0,  the  consumer  will  be  detached  and  destroyed
       automatically.   If  the  last consumer attached to any possessed provider will be detached, the provider
       will be destroyed.  If there are no more providers nor consumers, the geom will be destroyed.

       This is an automatic “garbage collect” to avoid duplicated code in all classes.   Before  it  is  called,
       field  <u>softc</u>  should  be  disposed  of  and set to NULL.  Note that the <b>g_wither_geom</b>() function gives no
       guarantee that the geom will be immediately destroyed, mostly because the access  counts  of  the  geom's
       consumers  and  providers  may  not  be 0.  That is why calling this function for every geom from a given
       class is not enough to be sure that the class can be unloaded.

</pre><h4><b>RESTRICTIONS/CONDITIONS</b></h4><pre>
       The argument <u>error</u> must be nonzero.

       The topology lock has to be held.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man4/geom.4.html">geom</a></u>(4), <u><a href="../man9/DECLARE_GEOM_CLASS.9.html">DECLARE_GEOM_CLASS</a></u>(9), <u><a href="../man9/g_access.9.html">g_access</a></u>(9), <u><a href="../man9/g_attach.9.html">g_attach</a></u>(9), <u><a href="../man9/g_bio.9.html">g_bio</a></u>(9), <u><a href="../man9/g_consumer.9.html">g_consumer</a></u>(9), <u><a href="../man9/g_data.9.html">g_data</a></u>(9), <u><a href="../man9/g_event.9.html">g_event</a></u>(9),
       <u><a href="../man9/g_geom.9.html">g_geom</a></u>(9), <u><a href="../man9/g_provider.9.html">g_provider</a></u>(9), <u><a href="../man9/g_provider_by_name.9.html">g_provider_by_name</a></u>(9)

</pre><h4><b>AUTHORS</b></h4><pre>
       This manual page was written by Pawel Jakub Dawidek &lt;<u><a href="mailto:pjd@FreeBSD.org">pjd@FreeBSD.org</a></u>&gt;.

Debian                                          January 16, 2004                                <u><a href="../man9/G_WITHER_GEOM.9.html">G_WITHER_GEOM</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>