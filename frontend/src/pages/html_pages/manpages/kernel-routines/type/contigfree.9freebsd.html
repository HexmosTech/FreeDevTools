<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>contigmalloc, contigfree — manage contiguous kernel physical memory</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       contigmalloc, contigfree — manage contiguous kernel physical memory

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/types.h&gt;</b>
       <b>#include</b> <b>&lt;sys/malloc.h&gt;</b>

       <u>void</u> <u>*</u>
       <b>contigmalloc</b>(<u>unsigned</u> <u>long</u> <u>size</u>,  <u>struct</u> <u>malloc_type</u> <u>*type</u>,  <u>int</u> <u>flags</u>,  <u>vm_paddr_t</u> <u>low</u>, <u>vm_paddr_t</u> <u>high</u>,
           <u>unsigned</u> <u>long</u> <u>alignment</u>, <u>vm_paddr_t</u> <u>boundary</u>);

       <u>void</u>
       <b>contigfree</b>(<u>void</u> <u>*addr</u>, <u>unsigned</u> <u>long</u> <u>size</u>, <u>struct</u> <u>malloc_type</u> <u>*type</u>);

       <b>#include</b> <b>&lt;sys/param.h&gt;</b>
       <b>#include</b> <b>&lt;sys/domainset.h&gt;</b>

       <u>void</u> <u>*</u>
       <b>contigmalloc_domainset</b>(<u>unsigned</u> <u>long</u> <u>size</u>,  <u>struct</u> <u>malloc_type</u> <u>*type</u>,  <u>struct</u> <u>domainset</u> <u>*ds</u>,   <u>int</u> <u>flags</u>,
           <u>vm_paddr_t</u> <u>low</u>, <u>vm_paddr_t</u> <u>high</u>, <u>unsigned</u> <u>long</u> <u>alignment</u>, <u>vm_paddr_t</u> <u>boundary</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>contigmalloc</b>()  function  allocates  <u>size</u>  bytes  of  contiguous  physical memory that is aligned to
       <u>alignment</u> bytes, and which does not cross a boundary of <u>boundary</u> bytes.  If  successful,  the  allocation
       will  reside  between  physical  addresses  <u>low</u>  and <u>high</u>.  The returned pointer points to a wired kernel
       virtual address range of <u>size</u> bytes allocated from the kernel virtual address (KVA) map.

       The <b>contigmalloc_domainset</b>() variant allows the caller to additionally specify a <u><a href="../man4/numa.4.html">numa</a></u>(4) domain selection
       policy.  See <u><a href="../man9/domainset.9.html">domainset</a></u>(9) for some example policies.

       The <u>flags</u> parameter modifies <b>contigmalloc</b>()'s behaviour as follows:

       M_ZERO  Causes the allocated physical memory to be zero filled.

       M_NOWAIT
               Causes <b>contigmalloc</b>() to return NULL if the  request  cannot  be  immediately  fulfilled  due  to
               resource shortage.

       Other flags (if present) are ignored.

       The  <b>contigfree</b>()  function  deallocates  memory  allocated  by  a  previous  call  to  <b>contigmalloc</b>() or
       <b>contigmalloc_domainset</b>().

</pre><h4><b>IMPLEMENTATION</b> <b>NOTES</b></h4><pre>
       The <b>contigmalloc</b>() function does not sleep waiting for memory resources  to  be  freed  up,  but  instead
       actively  reclaims  pages  before giving up.  However, unless M_NOWAIT is specified, it may select a page
       for reclamation that must first be written to backing storage, causing it to sleep.

       The <b>contigfree</b>() function does not accept NULL as an address input, unlike <u><a href="../man9/free.9.html">free</a></u>(9).

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The <b>contigmalloc</b>() function returns a kernel virtual address if allocation succeeds, or NULL otherwise.

</pre><h4><b>EXAMPLES</b></h4><pre>
       void *p;
       p = contigmalloc(8192, M_DEVBUF, M_ZERO, 0, (1L &lt;&lt; 22),
           32 * 1024, 1024 * 1024);

       Ask for 8192 bytes of zero-filled memory residing between  physical  address  0  and  4194303  inclusive,
       aligned to a 32K boundary and not crossing a 1M address boundary.

</pre><h4><b>DIAGNOSTICS</b></h4><pre>
       The  <b>contigmalloc</b>()  function  will  panic if <u>size</u> is zero, or if <u>alignment</u> or <u>boundary</u> is not a power of
       two.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man9/malloc.9.html">malloc</a></u>(9), <u><a href="../man9/memguard.9.html">memguard</a></u>(9)

Debian                                          October 30, 2018                                 <u><a href="../man9/CONTIGMALLOC.9.html">CONTIGMALLOC</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>