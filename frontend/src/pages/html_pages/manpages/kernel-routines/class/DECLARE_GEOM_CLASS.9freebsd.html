<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DECLARE_GEOM_CLASS — GEOM class declaration macro</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       DECLARE_GEOM_CLASS — GEOM class declaration macro

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;geom/geom.h&gt;</b>

       <b>DECLARE_GEOM_CLASS</b>(<u>class</u>, <u>mod_name</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>DECLARE_GEOM_CLASS</b>()  macro  registers  a  GEOM  class  in GEOM.  A GEOM class itself implements one
       particular kind of transformation.  Typical examples are: MBR disk partition,  BSD  disklabel  and  RAID5
       classes.  <b>DECLARE_GEOM_CLASS</b>() can be used both for compiled in and loaded as <u><a href="../man4/kld.4.html">kld</a></u>(4) modules GEOM classes
       and it is the only official way for class registration.

       The arguments to <b>DECLARE_GEOM_CLASS</b>() are:

             <u>class</u>         The <u>g_class</u> structure which describes a GEOM class.

             <u>mod_name</u>      A kernel module name (not a class name!).

       Structure <u>g_class</u> contains data describing the class.  They are:

             <u>const</u> <u>char</u> <u>*</u> <u>name</u>
                     Class name.

             <u>g_taste_t</u> <u>*</u> <u>taste</u>
                     Pointer to function used for taste event handling.  If it is non-NULL it is called in three
                     situations:

                     <b>-</b>   On class activation, all existing providers are offered for tasting.
                     <b>-</b>   When new provider is created it is offered for tasting.
                     <b>-</b>   After  last  write access to a provider is closed it is offered for retasting (on first
                         write open event “spoil” was sent).

             <u>g_config_t</u> <u>*</u> <u>config</u>
                     This field is not used anymore, its functionality was replaced by the <u>ctlreq</u> field.

             <u>g_ctl_req_t</u> <u>*</u> <u>ctlreq</u>
                     Pointer to function used for handling events from userland applications.

             <u>g_init_t</u> <u>*</u> <u>init</u>
                     Pointer to function which is called right after class registration.

             <u>g_fini_t</u> <u>*</u> <u>fini</u>
                     Pointer to function which is called right before class deregistration.

             <u>g_ctl_destroy_geom_t</u> <u>*</u> <u>destroy_geom</u>
                     Pointer to a function which is called for every geom on class unload.  If this field is not
                     set, the class can not be unloaded.

       Only a <u>name</u> field is required; the rest are optional.

</pre><h4><b>RESTRICTIONS/CONDITIONS</b></h4><pre>
       The fields of <u>g_class</u> should always be initialized using C99-style field naming (see  the  initialization
       of <u>example_class</u> below).

</pre><h4><b>EXAMPLES</b></h4><pre>
       Example class declaration.

             static struct g_geom *
             g_example_taste(struct g_class *mp, struct g_provider *pp,
                 int flags __unused)
             {
                     g_topology_assert();

                     [...]
             }

             static void
             g_example_ctlreq(struct gctl_req *req, struct g_class *cp,
                 char const *verb)
             {

                     [...]
             }

             static int
             g_example_destroy_geom(struct gctl_req *req, struct g_class *cp,
                 struct g_geom *gp)
             {

                     g_topology_assert();

                     [...]
             }

             static void
             g_example_init(struct g_class *mp)
             {

                     [...]
             }

             static void
             g_example_fini(struct g_class *mp)
             {

                     [...]
             }

             struct g_class example_class = {
                     .name = "EXAMPLE",
                     .taste = g_example_taste,
                     .ctlreq = g_example_ctlreq,
                     .init = g_example_init,
                     .fini = g_example_fini,
                     .destroy_geom = g_example_destroy_geom
             };

             DECLARE_GEOM_CLASS(example_class, g_example);

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man4/geom.4.html">geom</a></u>(4),   <u><a href="../man9/g_attach.9.html">g_attach</a></u>(9),   <u><a href="../man9/g_bio.9.html">g_bio</a></u>(9),   <u><a href="../man9/g_consumer.9.html">g_consumer</a></u>(9),  <u><a href="../man9/g_data.9.html">g_data</a></u>(9),  <u><a href="../man9/g_event.9.html">g_event</a></u>(9),  <u><a href="../man9/g_geom.9.html">g_geom</a></u>(9),  <u><a href="../man9/g_provider.9.html">g_provider</a></u>(9),
       <u><a href="../man9/g_provider_by_name.9.html">g_provider_by_name</a></u>(9), <u><a href="../man9/g_wither_geom.9.html">g_wither_geom</a></u>(9)

</pre><h4><b>AUTHORS</b></h4><pre>
       This manual page was written by Pawel Jakub Dawidek &lt;<u><a href="mailto:pjd@FreeBSD.org">pjd@FreeBSD.org</a></u>&gt;.

Debian                                           August 13, 2007                           <u><a href="../man9/DECLARE_GEOM_CLASS.9.html">DECLARE_GEOM_CLASS</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>