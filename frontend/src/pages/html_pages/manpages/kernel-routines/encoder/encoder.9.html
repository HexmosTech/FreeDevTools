<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>encoder - software counting of quadrature encoder signals</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/linuxcnc-uspace">linuxcnc-uspace_2.9.4-2ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       encoder - software counting of quadrature encoder signals

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>loadrt</b> <b>encoder</b> <b>[num_chan=</b><u>num</u> <b>|</b> <b>names=</b><u>name1</u><b>[,</b><u>name2...</u><b>]]</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>encoder</b>  is  used  to  measure  position  by counting the pulses generated by a quadrature encoder.  As a
       software-based implementation it is much less expensive than hardware, but has a  limited  maximum  count
       rate.   The limit is in the range of 10 kHz to 50 kHz, depending on the computer speed and other factors.
       If better performance is needed, a hardware encoder counter is  a  better  choice.   Some  hardware-based
       systems can count at MHz rates.

       <b>encoder</b>  supports  a  maximum  of  eight  channels.  The number of channels actually loaded is set by the
       <b>num_chan</b> argument when the module is loaded.  Alternatively, specify names= and unique names separated by
       commas.

       The <b>num_chan=</b> and <b>names=</b> specifiers  are  mutually  exclusive.   If  neither  <b>num_chan=</b>  nor  <b>names=</b>  are
       specified, or if <b>num_chan=0</b> is specified, the default value is three.

       <b>encoder</b> has a one-phase, unidirectional mode called <u>counter</u>.  In this mode, the <b>phase-B</b> input is ignored;
       the  counts  increase  on  each  rising  edge  of  <b>phase-A</b>.   This  mode  may  be  useful  for counting a
       unidirectional spindle with a single input line, though the noise-resistant characteristics of quadrature
       are lost.

       If used in counter-mode it is also possible to enable the missing-teeth index mode, where a  gap  in  the
       pulse  train  of  one  or  more  teeth  is  used  as in index marker. This system is used extensively for
       automotive crank position sensors.

</pre><h4><b>FUNCTIONS</b></h4><pre>
       <b>encoder.update-counters</b> (no floating-point)
              Does the actual counting, by sampling the encoder signals and decoding the  quadrature  waveforms.
              Must  be  called  as frequently as possible, preferably twice as fast as the maximum desired count
              rate.  Operates on all channels at once.

       <b>encoder.capture-position</b> (uses floating point)
              Captures the raw counts from <b>update-counters</b> and performs scaling and other necessary  conversion,
              handles  counter  rollover, etc.  Can (and should) be called less frequently than <b>update-counters</b>.
              Operates on all channels at once.

</pre><h4><b>NAMING</b></h4><pre>
       The names for pins and parameters are prefixed as:
         <b>encoder.N.</b> for N=0,1,...,num-1 when using <b>num_chan=num</b>
         <b>nameN.</b> for nameN=name1,name2,... when using <b>names=name1,name2,...</b>

       The <b>encoder.N.</b> format is shown in the following descriptions.

</pre><h4><b>PINS</b></h4><pre>
       <b>encoder.</b><u>N</u><b>.counter-mode</b> bit i/o
              Enables counter mode.  When true, the counter counts  each  rising  edge  of  the  phase-A  input,
              ignoring  the  value on phase-B.  This is useful for counting the output of a single channel (non-
              quadrature) sensor.  When false (the default), it counts in quadrature mode.

       <b>encoder.</b><u>N</u><b>.counts</b> s32 out
              Position in encoder counts.

       <b>encoder.</b><u>N</u><b>.index-enable</b> bit i/o
              When true, <b>counts</b> and <b>position</b> are reset to zero on the next rising edge of <b>Phase-Z</b>.  At the  same
              time, <b>index-enable</b> is reset to zero to indicate that the rising edge has occurred.

       <b>encoder.</b><u>N</u><b>.min-speed-estimate</b> float in (default: 1.0)
              Determine   the   minimum   speed   at   which   <b>velocity</b>   will   be  estimated  as  nonzero  and
              <b>postition-interpolated</b> will be interpolated.  The units of <b>min-speed-estimate</b> are the same as  the
              units  of <b>velocity</b>.  Setting this parameter too low will cause it to take a long time for <b>velocity</b>
              to go to 0 after encoder pulses have stopped arriving.

       <b>encoder.</b><u>N</u><b>.phase-A</b> bit in
              Quadrature input for encoder channel <u>N</u>.

       <b>encoder.</b><u>N</u><b>.phase-B</b> bit in
              Quadrature input.

       <b>encoder.</b><u>N</u><b>.phase-Z</b> bit in
              Index pulse input.

       <b>encoder.</b><u>N</u><b>.position</b> float out
              Position in scaled units (see <b>position-scale</b>)

       <b>encoder.</b><u>N</u><b>.position-interpolated</b> float out
              Position in scaled units, interpolated between  encoder  counts.   Only  valid  when  velocity  is
              approximately constant and above <b>min-speed-estimate</b>.  Do not use for position control.

       <b>encoder.</b><u>N</u><b>.position-scale</b> float i/o
              Scale  factor, in counts per length unit.  For example, if <b>position-scale</b> is 500, then 1000 counts
              of the encoder will be reported as a position of 2.0 units.

       <b>encoder.</b><u>N</u><b>.missing-teeth</b> s32 in
              The number of teeth missing from the index gap. For  example  a  60  tooth  gear  with  two  teeth
              shortened  to  form an index so that there are 58 pulses per revolution would use a position-scale
              of 60 and a missing-teeth of 2.

       <b>encoder.</b><u>N</u><b>.rawcounts</b> s32 out
              The raw count, as determined by <b>update-counters</b>.  This  value  is  updated  more  frequently  than
              <b>counts</b> and <b>position</b>.  It is also unaffected by <b>reset</b> or the index pulse.

       <b>encoder.</b><u>N</u><b>.reset</b> bit in
              When true, <b>counts</b> and <b>position</b> are reset to zero immediately.

       <b>encoder.</b><u>N</u><b>.velocity</b> float out
              Velocity  in scaled units per second.  <b>encoder</b> uses an algorithm that greatly reduces quantization
              noise as compared to simply differentiating the <b>position</b> output.  When the magnitude of  the  true
              velocity is below min-speed-estimate, the velocity output is 0.

       <b>encoder.</b><u>N</u><b>.velocity-rpm</b> float out
              Velocity  in  scaled  units  per  minute.  Simply  <b>encoder.</b><u>N</u><b>.velocity</b> scaled by a factor of 60 for
              convenience.

       <b>encoder.</b><u>N</u><b>.x4-mode</b> bit i/o
              Enables times-4 mode.  When true (the default), the counter counts each  edge  of  the  quadrature
              waveform  (four  counts  per  full  cycle).   When  false, it only counts once per full cycle.  In
              <b>counter-mode</b>, this parameter is ignored.

       <b>encoder.</b><u>N</u><b>.latch-input</b> bit in
       <b>encoder.</b><u>N</u><b>.latch-falling</b> bit in (default: <b>TRUE</b>)
       <b>encoder.</b><u>N</u><b>.latch-rising</b> bit in (default: <b>TRUE</b>)
       <b>encoder.</b><u>N</u><b>.counts-latched</b> s32 out
       <b>encoder.</b><u>N</u><b>.position-latched</b> float out
              Update <b>counts-latched</b> and <b>position-latched</b> on the rising and/or falling edges  of  <b>latch-input</b>  as
              indicated by <b>latch-rising</b> and <b>latch-falling</b>.

       <b>encoder.</b><u>N</u><b>.counter-mode</b> bit rw
              Enables  counter  mode.   When  true,  the  counter  counts each rising edge of the phase-A input,
              ignoring the value on phase-B.  This is useful for counting the output of a single  channel  (non-
              quadrature)    sensor.     When   false   (the   default),   it   counts   in   quadrature   mode.
              <b>encoder.</b><u>N</u><b>.capture-position.tmax</b> s32 rw Maximum number of  CPU  cycles  it  took  to  execute  this
              function.

</pre><h4><b>PARAMETERS</b></h4><pre>
       The encoder component has no HAL Parameters.

LinuxCNC Documentation                             2009-04-15                                         <u><a href="../man9/ENCODER.9.html">ENCODER</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>