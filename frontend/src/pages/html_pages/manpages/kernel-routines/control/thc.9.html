<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>thc - Torch Height Control</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/linuxcnc-uspace">linuxcnc-uspace_2.9.4-2ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       thc - Torch Height Control

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>loadrt</b> <b>thc</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Torch Height Control Mesa THC &gt; Encoder &gt; LinuxCNC THC component

       The  Mesa  THC  sends  a  frequency  based on the voltage detected to the encoder.  The velocity from the
       encoder is converted to volts with the velocity scale parameter inside the THC component.

       The THCAD card sends a frequency at 0 volts so the scale offset parameter is used to zero the  calculated
       voltage.

       Component  Functions If enabled and torch is on and X + Y velocity is within tolerance of set speed allow
       the THC to offset the Z axis as needed to maintain voltage.

       If enabled and torch is off and the Z axis is moving up remove any correction at a rate not to exceed the
       rate of movement of the Z axis.

       If enabled and torch is off and there is no correction pass the Z position and feed back untouched.

       If not enabled pass the Z position and feed back untouched.

       Physical Connections
       Plasma Torch Arc Voltage Signal =&gt; 6 x 487k 1% resistors =&gt; THC Arc Voltage In
       THC Frequency Signal =&gt; Encoder #0, pin A (Input)
       Plasma Torch Arc OK Signal =&gt; input pin
       output pin =&gt; Plasma Torch Start Arc Contacts

       HAL Plasma Connections
       encoder.nn.velocity =&gt; thc.encoder-vel (tip voltage)
       spindle.0.on =&gt; output pin (start the arc)
       thc.arc-ok &lt;= motion.digital-in-00 &lt;= input pin (arc ok signal)

       HAL Motion Connections
       thc.requested-vel &lt;= motion.requested-vel
       thc.current-vel &lt;= motion.current-vel

</pre><h4><b>FUNCTIONS</b></h4><pre>
       <b>thc</b> (requires a floating-point thread)

</pre><h4><b>PINS</b></h4><pre>
       <b>thc.encoder-vel</b> float in
              Connect to hm2_5i20.0.encoder.00.velocity

       <b>thc.current-vel</b> float in
              Connect to motion.current-vel

       <b>thc.requested-vel</b> float in
              Connect to motion.requested-vel

       <b>thc.volts-requested</b> float in
              Tip Volts current_vel &gt;= min_velocity requested

       <b>thc.vel-tol</b> float in
              Velocity Tolerance (Corner Lock)

       <b>thc.torch-on</b> bit in
              Connect to spindle.N.on

       <b>thc.arc-ok</b> bit in
              Arc OK from Plasma Torch

       <b>thc.enable</b> bit in
              Enable the THC, if not enabled Z position is passed through

       <b>thc.z-pos-in</b> float in
              Z Motor Position Command in from axis.n.motor-pos-cmd

       <b>thc.z-pos-out</b> float out
              Z Motor Position Command Out

       <b>thc.z-fb-out</b> float out
              Z Position Feedback to Axis

       <b>thc.volts</b> float out
              The Calculated Volts

       <b>thc.vel-status</b> bit out
              When the THC thinks we are at requested speed

       <b>thc.offset-value</b> float out
              The Current Offset

</pre><h4><b>PARAMETERS</b></h4><pre>
       <b>thc.vel-scale</b> float rw
              The scale to convert the Velocity signal to Volts

       <b>thc.scale-offset</b> float rw
              The offset of the velocity input at 0 volts

       <b>thc.velocity-tol</b> float rw
              The deviation percent from planned velocity

       <b>thc.voltage-tol</b> float rw
              The deviation of Tip Voltage before correction takes place

       <b>thc.correction-vel</b> float rw
              The amount of change in user units per period to move Z to correct

</pre><h4><b>AUTHOR</b></h4><pre>
       John Thornton

</pre><h4><b>LICENSE</b></h4><pre>
       GPLv2 or greater

LinuxCNC Documentation                             2025-08-07                                             <u><a href="../man9/THC.9.html">THC</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>