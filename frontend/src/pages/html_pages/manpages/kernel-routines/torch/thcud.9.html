<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>thcud - Torch Height Control Up/Down Input</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/linuxcnc-uspace">linuxcnc-uspace_2.9.4-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       thcud - Torch Height Control Up/Down Input

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>loadrt</b> <b>thcud</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Torch Height Control This THC takes either an up or a down input from a THC

       If  enabled  and  torch is on and X + Y velocity is within tolerance of set speed allow the THC to offset
       the Z axis as needed to maintain voltage.

       If enabled and torch is off and the Z axis is moving up remove any correction at a rate not to exceed the
       rate of movement of the Z axis.

       If enabled and torch is off and there is no correction pass the Z position and feed back untouched.

       If not enabled pass the Z position and feed back untouched.

       Typical Physical Connections using a Parallel Port
       Parallel Pin 12 &lt;= THC controller Plasma Up
       Parallel Pin 13 &lt;= THC controller Plasma Down
       Parallel Pin 15  &lt;= Plasma Torch Arc Ok Signal
       Parallel Pin 16 =&gt; Plasma Torch Start Arc Contacts

       HAL Plasma Connections
       net torch-up thcud.torch-up &lt;= parport.0.pin-12-in
       net torch-down thcud.torch-down &lt;= parport.0.pin-13-in
       net torch-on spindle.0.on =&gt; parport.0.pin-16-out (start the arc)
       net arc-ok thcud.arc-ok &lt;= motion.digital-in-00 &lt;= parport.0.pin-15-in (arc ok signal)

       HAL Motion Connections
       net requested-vel thcud.requested-vel &lt;= motion.requested-vel
       net current-vel thcud.current-vel &lt;= motion.current-vel

       PyVCP Connections In the XML file you need something like:

         &lt;pyvcp&gt;
         &lt;checkbutton&gt;
           &lt;text&gt;"THC Enable"&lt;/text&gt;
           &lt;halpin&gt;"thc-enable"&lt;/halpin&gt;
         &lt;/checkbutton&gt;
         &lt;/pyvcp&gt;

       Connect the PyVCP pins in the postgui.hal file like this:

       net thc-enable thcud.enable &lt;= pyvcp.thc-enable

</pre><h4><b>FUNCTIONS</b></h4><pre>
       <b>thcud</b> (requires a floating-point thread)

</pre><h4><b>PINS</b></h4><pre>
       <b>thcud.torch-up</b> bit in
              Connect to an input pin

       <b>thcud.torch-down</b> bit in
              Connect to input pin

       <b>thcud.current-vel</b> float in
              Connect to motion.current-vel

       <b>thcud.requested-vel</b> float in
              Connect to motion.requested-vel

       <b>thcud.torch-on</b> bit in
              Connect to spindle.N.on

       <b>thcud.arc-ok</b> bit in
              Arc Ok from Plasma Torch

       <b>thcud.enable</b> bit in
              Enable the THC, if not enabled Z position is passed through

       <b>thcud.z-pos-in</b> float in
              Z Motor Position Command in from axis.n.motor-pos-cmd

       <b>thcud.z-pos-out</b> float out
              Z Motor Position Command Out

       <b>thcud.z-fb-out</b> float out
              Z Position Feedback to Axis

       <b>thcud.cur-offset</b> float out
              The Current Offset

       <b>thcud.vel-status</b> bit out
              When the THC thinks we are at requested speed

       <b>thcud.removing-offset</b> bit out
              Pin for testing

       <b>thcud.correction-vel</b> float in
              The Velocity to move Z to correct

</pre><h4><b>PARAMETERS</b></h4><pre>
       <b>thcud.velocity-tol</b> float rw
              The deviation percent from planned velocity

</pre><h4><b>AUTHOR</b></h4><pre>
       John Thornton

</pre><h4><b>LICENSE</b></h4><pre>
       GPLv2 or greater

LinuxCNC Documentation                             2025-06-19                                           <u><a href="../man9/THCUD.9.html">THCUD</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>