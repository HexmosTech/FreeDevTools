<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>accept_filter,  accept_filt_add, accept_filt_del, accept_filt_generic_mod_event, accept_filt_get — filter</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       accept_filter,  accept_filt_add, accept_filt_del, accept_filt_generic_mod_event, accept_filt_get — filter
       incoming connections

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/types.h&gt;</b>
       <b>#include</b> <b>&lt;sys/module.h&gt;</b>
       <b>#include</b> <b>&lt;sys/socket.h&gt;</b>
       <b>#define</b> <b>ACCEPT_FILTER_MOD</b>
       <b>#include</b> <b>&lt;sys/socketvar.h&gt;</b>

       <u>int</u>
       <b>accept_filt_add</b>(<u>struct</u> <u>accept_filter</u> <u>*filt</u>);

       <u>int</u>
       <b>accept_filt_del</b>(<u>char</u> <u>*name</u>);

       <u>int</u>
       <b>accept_filt_generic_mod_event</b>(<u>module_t</u> <u>mod</u>, <u>int</u> <u>event</u>, <u>void</u> <u>*data</u>);

       <u>struct</u> <u>accept_filter</u> <u>*</u>
       <b>accept_filt_get</b>(<u>char</u> <u>*name</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Accept filters allow an application to request that the  kernel  pre-process  incoming  connections.   An
       accept filter is requested via the <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2) system call, passing in an <u>optname</u> of SO_ACCEPTFILTER.

</pre><h4><b>IMPLEMENTATION</b> <b>NOTES</b></h4><pre>
       A module that wants to be an accept filter must provide a <u>struct</u> <u>accept_filter</u> to the system:

       struct accept_filter {
               char    accf_name[16];
               void    (*accf_callback)(struct socket *so, void *arg, int waitflag);
               void *  (*accf_create)(struct socket *so, char *arg);
               void    (*accf_destroy)(struct socket *so);
               SLIST_ENTRY(accept_filter) accf_next;   /* next on the list */
       };

       The  module  should  register  it  with  the  function  <b>accept_filt_add</b>(),  passing a pointer to a <u>struct</u>
       <u>accept_filter</u>, allocated with <u><a href="../man9/malloc.9.html">malloc</a></u>(9).

       The fields of <u>struct</u> <u>accept_filter</u> are as follows:

       <u>accf_name</u>      Name of the filter; this is how it will be accessed from userland.

       <u>accf_callback</u>  The callback that the kernel will do once the connection is established.  It is  the  same
                      as  a socket upcall and will be called when the connection is established and whenever new
                      data arrives on the socket, unless the callback modifies the socket's flags.

       <u>accf_create</u>    Called whenever a <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2) installs the filter onto a listening socket.

       <u>accf_destroy</u>   Called whenever the user removes the accept filter on the socket.

       The <b>accept_filt_del</b>() function passed the same string used in <u>accept_filter.accf_name</u> during registration
       with <b>accept_filt_add</b>(), the kernel will then disallow and further userland use of the filter.

       The <b>accept_filt_get</b>() function is  used  internally  to  locate  which  accept  filter  to  use  via  the
       <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2) system call.

       The  <b>accept_filt_generic_mod_event</b>()  function  provides  a  simple  way to avoid duplication of code for
       accept filters which do not use the argument field to load and unload themselves.  This function  can  be
       used in the <u>moduledata_t</u> struct for the <u><a href="../man9/DECLARE_MODULE.9.html">DECLARE_MODULE</a></u>(9) macro.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2), <u><a href="../man9/accf_data.9.html">accf_data</a></u>(9), <u><a href="../man9/accf_dns.9.html">accf_dns</a></u>(9), <u><a href="../man9/accf_http.9.html">accf_http</a></u>(9), <u><a href="../man9/malloc.9.html">malloc</a></u>(9)

</pre><h4><b>HISTORY</b></h4><pre>
       The accept filter mechanism was introduced in FreeBSD 4.0.

</pre><h4><b>AUTHORS</b></h4><pre>
       This manual page was written by Alfred Perlstein, Sheldon Hearn and Jeroen Ruigrok van der Werven.

       The  accept  filter  concept  was  pioneered  by David Filo at Yahoo! and refined to be a loadable module
       system by Alfred Perlstein.

Debian                                            June 25, 2000                                 <u><a href="../man9/ACCEPT_FILTER.9.html">ACCEPT_FILTER</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>