<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pmap_enter — insert a virtual page into a physical map</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       pmap_enter — insert a virtual page into a physical map

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/param.h&gt;</b>
       <b>#include</b> <b>&lt;vm/vm.h&gt;</b>
       <b>#include</b> <b>&lt;vm/pmap.h&gt;</b>

       <u>int</u>
       <b>pmap_enter</b>(<u>pmap_t</u> <u>pmap</u>, <u>vm_offset_t</u> <u>va</u>, <u>vm_page_t</u> <u>m</u>, <u>vm_prot_t</u> <u>prot</u>, <u>u_int</u> <u>flags</u>, <u>int8_t</u> <u>psind</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>pmap_enter</b>()  function creates a mapping in the physical map <u>pmap</u> from the virtual address <u>va</u> to the
       physical page <u>m</u> with the protection <u>prot</u>.  Any previous mapping at the virtual address <u>va</u> is destroyed.

       The <u>flags</u> argument may have the following values:

       VM_PROT_READ        A read access to the given virtual address triggered the call.

       VM_PROT_WRITE       A write access to the given virtual address triggered the call.

       VM_PROT_EXECUTE     An execute access to the given virtual address triggered the call.

       PMAP_ENTER_WIRED    The mapping should be marked as wired.

       PMAP_ENTER_NOSLEEP  This function may not sleep during creation of the mapping.  If the mapping cannot be
                           created without sleeping, an appropriate Mach VM error is returned.
       If the PMAP_ENTER_NOSLEEP flag is not specified, this function must create the requested  mapping  before
       returning.   It  may  not  fail.  In order to create the requested mapping, this function may destroy any
       non-wired mapping in any pmap.

       The <u>psind</u> parameter specifies the page size that should be used by the mapping.  The supported page sizes
       are described by the global array pagesizes[].  The desired page size is specified by passing  the  index
       of the array element that equals the desired page size.

       When  the  <b>pmap_enter</b>()  function destroys or updates a managed mapping, including an existing mapping at
       virtual address <u>va</u>, it updates the <u>vm_page</u> structure corresponding  to  the  previously  mapped  physical
       page.   If  the  physical  page  was  accessed  through the managed mapping, then the <u>vm_page</u> structure's
       PGA_REFERENCED aflag is set.  If the physical page was modified through the  managed  mapping,  then  the
       <b>vm_page_dirty</b>() function is called on the <u>vm_page</u> structure.

       The  PGA_WRITEABLE  aflag  must be set for the page <u>m</u> if the new mapping is managed and writeable.  It is
       advised to clear PGA_WRITEABLE for destroyed mappings if the implementation  can  ensure  that  no  other
       writeable managed mappings for the previously mapped pages exist.

       If  the  request  modifies  an  existing  mapping  to use a different physical page, an implementation of
       <b>pmap_enter</b> must invalidate the previous mapping before installing the new one.   This  ensures  that  all
       threads  sharing  the  pmap  keep  a  consistent  view of the mapping, which is necessary for the correct
       handling of CoW (copy on write) faults.

       If the page <u>m</u> is managed, the page must be busied by the caller or the owning object must be locked.   In
       the later case, the PMAP_ENTER_NOSLEEP must be specified by the caller.

       The <b>pmap_enter</b>() function must handle the multiprocessor TLB consistency for the given address.

</pre><h4><b>NOTES</b></h4><pre>
       On  arm and i386 architectures the existing implementation of the <b>pmap_enter</b> function is incomplete, only
       value 0 for <u>psind</u> is supported.  Other supported architectures, except amd64, have pagesizes[]  array  of
       size 1.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       If  successful,  the  <b>pmap_enter</b>()  function  returns  KERN_SUCCESS.   If the PMAP_ENTER_NOSLEEP flag was
       specified  and  the  resources  required  for  the  mapping  cannot   be   acquired   without   sleeping,
       KERN_RESOURCE_SHORTAGE is returned.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man9/pmap.9.html">pmap</a></u>(9)

</pre><h4><b>AUTHORS</b></h4><pre>
       This manual page was first written by Bruce M Simpson &lt;<u><a href="mailto:bms@spc.org">bms@spc.org</a></u>&gt; and then rewritten by
       Alan Cox &lt;<u><a href="mailto:alc@FreeBSD.org">alc@FreeBSD.org</a></u>&gt; and
       Konstantin Belousov &lt;<u><a href="mailto:kib@FreeBSD.org">kib@FreeBSD.org</a></u>&gt;.

Debian                                          December 16, 2018                                  <u><a href="../man9/PMAP_ENTER.9.html">PMAP_ENTER</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>