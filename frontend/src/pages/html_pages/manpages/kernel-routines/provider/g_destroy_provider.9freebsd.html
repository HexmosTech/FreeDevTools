<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>g_new_providerf, g_destroy_provider, g_error_provider — GEOM providers management</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       g_new_providerf, g_destroy_provider, g_error_provider — GEOM providers management

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;geom/geom.h&gt;</b>

       <u>struct</u> <u>g_provider</u> <u>*</u>
       <b>g_new_providerf</b>(<u>struct</u> <u>g_geom</u> <u>*gp</u>, <u>const</u> <u>char</u> <u>*fmt</u>, <u>...</u>);

       <u>void</u>
       <b>g_destroy_provider</b>(<u>struct</u> <u>g_provider</u> <u>*pp</u>);

       <u>void</u>
       <b>g_error_provider</b>(<u>struct</u> <u>g_provider</u> <u>*pp</u>, <u>int</u> <u>error</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A GEOM provider is the front gate at which a geom offers service.  A provider is “a disk-like thing which
       appears  in  <u><a href="file:/dev">/dev</a></u>”  –  a  logical  disk  in other words.  All providers have three main properties: name,
       sectorsize and size.

       The <b>g_new_providerf</b>() function creates a new provider on given geom <u>gp</u>.  The name of the provider,  which
       will  appear  as  device  in <u><a href="../man5/devfs.5.html">devfs</a></u>(5), is created in a <u><a href="../man3/printf.3.html">printf</a></u>(3)-like way from the rest of the arguments.
       After creation, the caller has to set the provider's <u>mediasize</u> and <u>sectorsize</u>, as well as  other  desired
       initializations,  and  then call <b>g_error_provider</b>() to reset the provider's error, which is initially set
       to ENXIO.

       The <b>g_destroy_provider</b>() function destroys the given provider, cancels all  related  pending  events  and
       removes the corresponding devfs entry.

       The  <b>g_error_provider</b>() function is used to set the provider's error value.  If set to a nonzero, all I/O
       requests will be denied, as well as increasing its access count will not be possible (error <u>error</u> will be
       returned).

</pre><h4><b>RESTRICTIONS/CONDITIONS</b></h4><pre>
       <b>g_new_provider</b>():

             The provider name should be unique, but this is not enforced by GEOM.  If the name is  not  unique,
             one will end up with two (or more) files with the same name, which is a programmer error.

             The geom <u>gp</u> has to have a <u>start</u> method defined.

             The topology lock has to be held.

       <b>g_destroy_provider</b>():

             The provider must not have consumers attached.

             The access count has to be 0.

             The topology lock has to be held.

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The <b>g_new_providerf</b>() function returns a pointer to the newly created provider.

</pre><h4><b>EXAMPLES</b></h4><pre>
       Create an example provider, set its parameters and make it usable.

             struct g_provider *
             create_example_provider(struct g_geom *gp)
             {
                     struct g_provider *pp;

                     g_topology_lock();
                     pp = g_new_providerf(gp, "example_provider");
                     g_topology_unlock();
                     pp-&gt;mediasize = 65536;
                     pp-&gt;sectorsize = 512;
                     g_error_provider(pp, 0);

                     return (pp);
             }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man4/geom.4.html">geom</a></u>(4), <u><a href="../man9/DECLARE_GEOM_CLASS.9.html">DECLARE_GEOM_CLASS</a></u>(9), <u><a href="../man9/g_access.9.html">g_access</a></u>(9), <u><a href="../man9/g_attach.9.html">g_attach</a></u>(9), <u><a href="../man9/g_bio.9.html">g_bio</a></u>(9), <u><a href="../man9/g_consumer.9.html">g_consumer</a></u>(9), <u><a href="../man9/g_data.9.html">g_data</a></u>(9), <u><a href="../man9/g_event.9.html">g_event</a></u>(9),
       <u><a href="../man9/g_geom.9.html">g_geom</a></u>(9), <u><a href="../man9/g_provider_by_name.9.html">g_provider_by_name</a></u>(9), <u><a href="../man9/g_wither_geom.9.html">g_wither_geom</a></u>(9)

</pre><h4><b>AUTHORS</b></h4><pre>
       This manual page was written by Pawel Jakub Dawidek &lt;<u><a href="mailto:pjd@FreeBSD.org">pjd@FreeBSD.org</a></u>&gt;.

Debian                                          January 16, 2004                                   <u><a href="../man9/G_PROVIDER.9.html">G_PROVIDER</a></u>(9)
</pre>
 </div>
</div></section>
</div>
</body>
</html>