<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ausearch-expression - audit search expression format</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/auditd">auditd_4.0.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ausearch-expression - audit search expression format

</pre><h4><b>OVERVIEW</b></h4><pre>
       This  man  page  describes  the  format  of  "ausearch  expressions".   Parsing  and  evaluation of these
       expressions is provided by libauparse and is common to applications that use this library.

</pre><h4><b>LEXICAL</b> <b>STRUCTURE</b></h4><pre>
       White space (ASCII space, tab and new-line characters) between tokens is ignored.  The  following  tokens
       are recognized:

       Punctuation
              <b>(</b> <b>)</b> <b>\</b>

       Logical operators
              <b>!</b> <b>&amp;&amp;</b> <b>||</b>

       Comparison operators
              <b>&lt;</b> <b>&lt;=</b> <b>==</b> <b>&gt;</b> <b>&gt;=</b> <b>!==</b> <b>i=</b> <b>i!=</b> <b>r=</b> <b>r!=</b>

       Unquoted strings
              Any non-empty sequence of ASCII letters, digits, and the <b>_</b> symbol.

       Quoted strings
              A  sequence  of characters surrounded by the <b>"</b> quotes.  The <b>\</b> character starts an escape sequence.
              The only defined escape sequences are <b>\\</b> and <b>\"</b>.  The  semantics  of  other  escape  sequences  is
              undefined.

       Regexps
              A  sequence  of  characters  surrounded  by  the  <b>/</b>  characters.  The <b>\</b> character starts an escape
              sequence.  The only defined escape sequences are  <b>\\</b>  and  <b>\/</b>.   The  semantics  of  other  escape
              sequences is undefined.

       Anywhere  an  unquoted string is valid, a quoted string is valid as well, and vice versa.  In particular,
       field names may be specified using quoted strings, and field  values  may  be  specified  using  unquoted
       strings.

</pre><h4><b>EXPRESSION</b> <b>SYNTAX</b></h4><pre>
       The primary expression has one of the following forms:

              <u>field</u> <u>comparison-operator</u> <u>value</u>

              <b>\regexp</b> <u>string-or-regexp</u>

       <u>field</u> is either a string, which specifies the first field with that name within the current audit record,
       or  the  <b>\</b> escape character followed by a string, which specifies a virtual field with the specified name
       (virtual fields are defined in a later section).

       <u>field</u> is a string.  <u>operator</u> specifies the comparison to perform

       <b>r=</b> <b>r!=</b> Get the "raw" string of <u>field</u>, and compare it to <u>value</u>.  For fields in audit  records,  the  "raw"
              string is the exact string stored in the audit record (with all escaping and unprintable character
              encoding left alone); applications can read the "raw" string using <b><a href="../man3/auparse_get_field_str.3.html">auparse_get_field_str</a></b>(3).  Each
              virtual  field  may  define  a  "raw"  string.  If <u>field</u> is not present or does not define a "raw"
              string, the result of the comparison is <b>false</b> (regardless of the operator).

       <b>i=</b> <b>i!=</b> Get the "interpreted" string of <u>field</u>, and compare it to <u>value</u>.  For fields in audit records,  the
              "interpreted"  string  is  an  "user-readable" interpretation of the field value; applications can
              read the "interpreted" string using <b><a href="../man3/auparse_interpret_field.3.html">auparse_interpret_field</a></b>(3).  Each virtual field may define  an
              "interpreted"  string.   If  <u>field</u>  is not present or does not define an "interpreted" string, the
              result of the comparison is <b>false</b> (regardless of the operator).

       <b>&lt;</b> <b>&lt;=</b> <b>==</b> <b>&gt;</b> <b>&gt;=</b> <b>!==</b>
              Evaluate the "value" of <u>field</u>, and compare it to <u>value</u>.  A "value" may be defined for any field or
              virtual field, but no "value" is currently defined for any  audit  record  field.   The  rules  of
              parsing <u>value</u> for comparing it with the "value" of <u>field</u> are specific for each <u>field</u>.  If <u>field</u> is
              not  present,  the  result of the comparison is <b>false</b> (regardless of the operator).  If <u>field</u> does
              not define a "value", an error is reported when parsing the expression.

       In the special case of <b>\regexp</b> <u>regexp-or-string</u>, the current audit record is taken as a  string  (without
       interpreting  field  values),  and  matched  against  <u>regexp-or-string</u>.   <u>regexp-or-string</u> is an extended
       regular expression, using a string or regexp token (in other words, delimited by <b>"</b> or <b>/</b>).

       If <u>E1</u> and <u>E2</u> are valid expressions, then <b>!</b>  <u>E1</u>, <u>E1</u> <b>&amp;&amp;</b> <u>E2</u>, and <u>E1</u> <b>||</b> <u>E2</u> are  valid  expressions  as  well,
       with  the  usual  C  semantics  and evaluation priorities.  Note that <b>!</b>  <u>field</u> <u>op</u> <u>value</u> is interpreted as
       <b>!(</b><u>field</u> <u>op</u> <u>value</u><b>)</b>, not as <b>(!</b><u>field</u><b>)</b> <u>op</u> <u>value</u>.

</pre><h4><b>VIRTUAL</b> <b>FIELDS</b></h4><pre>
       The following virtual fields are defined:

       <b>\timestamp</b>
              The value is the timestamp of the current event.  <u>value</u> must be formatted as:

                   ts:seconds.milli

              where <u>seconds</u> and <u>milli</u> are decimal numbers specifying the seconds and milliseconds  part  of  the
              timestamp, respectively.

       <b>\timestamp_ex</b>
              This  is  similar  to  <b>\timestamp</b>  but  also  includes  the  event's serial number.  <u>value</u> must be
              formatted as:

                   ts:seconds.milli:serial

              where <u>serial</u> is a decimal number specifying the event's serial number.

       <b>\record_type</b>
              The value is the type of the current record.  <u>value</u> is either the record type name, or  a  decimal
              number specifying the type.

</pre><h4><b>SEMANTICS</b></h4><pre>
       The expression as a whole applies to a single record.  The expression is <b>true</b> for a specified event if it
       is <b>true</b> for any record associated with the event.

</pre><h4><b>EXAMPLES</b></h4><pre>
       As a demonstration of the semantics of handling missing fields, the following expression is <b>true</b> if <u>field</u>
       is present:

              <b>(</b><u>field</u> <b>r=</b> <b>"")</b> <b>||</b> <b>(</b><u>field</u> <b>r!=</b> <b>"")</b>

       and the same expression surrounded by <b>!(</b> and <b>)</b> is <b>true</b> if <u>field</u> is not present.

</pre><h4><b>FUTURE</b> <b>DIRECTIONS</b></h4><pre>
       New escape sequences for quoted strings may be defined.

       For  currently  defined virtual fields that do not define a "raw" or "interpreted" string, the definition
       may be added.  Therefore, don't rely on the fact that comparing the "raw" or "interpreted" string of  the
       field with any value is <b>false</b>.

       New formats of value constants for the <b>\timestamp</b> virtual field may be added.

</pre><h4><b>AUTHOR</b></h4><pre>
       Miloslav Trmac

Red Hat                                             Feb 2008                              <u><a href="../man5/AUSEARCH-EXPRESSION.5.html">AUSEARCH-EXPRESSION</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>