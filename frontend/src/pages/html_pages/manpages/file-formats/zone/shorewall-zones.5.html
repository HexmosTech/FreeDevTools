<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>zones - Shorewall zone declaration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/shorewall">shorewall_5.2.8-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       zones - Shorewall zone declaration file

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>/etc/shorewall/zones</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The /etc/shorewall/zones file declares your network zones. You specify the hosts in each zone through
       entries in /etc/shorewall/interfaces or /etc/shorewall/hosts.

       The columns in the file are as follows (where the column name is followed by a different name in
       parentheses, the different name is used in the alternate specification syntax).

       <b>ZONE</b> - <u>zone</u>[<b>:</b><u>parent-zone</u>[<b>,</b><u>parent-zone</u>]...]
           Name of the <u>zone</u>. Must start with a letter and consist of letters, digits or '_'. The names "all",
           "none", "any", "SOURCE" and "DEST" are reserved and may not be used as zone names. The maximum length
           of a zone name is determined by the setting of the LOGFORMAT option in <b>shorewall.conf</b>[1](5). With the
           default LOGFORMAT, zone names can be at most 5 characters long.  The maximum length of an iptables
           log prefix is 29 bytes. As explained in <b>shorewall.conf</b>[1] (5), the legacy default LOGPREFIX
           formatting string is “Shorewall:%s:%s:” where the first %s is replaced by the chain name and the
           second is replaced by the disposition.

           •   The "Shorewall:%s:%s:" formatting string has 12 fixed characters ("Shorewall" and three colons).

           •   The longest of the standard dispositions are ACCEPT and REJECT which have 6 characters each.

           •   The canonical name for the chain containing the rules for traffic going from zone 1 to zone 2 is
               "&lt;zone 1&gt;2&lt;zone 2&gt;" or "&lt;zone 1&gt;-&lt;zone 2&gt;".

           •   So if M is the maximum zone name length, such chains can have length 2*M + 1.
                   12 + 6 + 2*M + 1 = 29 which reduces to
                   2*M = 29 - 12 - 6 - 1 = 10 or
                   M = 5

           In Shorewall 5.1.0, the LOGFORMAT in the default and sample shorewall.conf files was changed to
           "%s:%s ".

           •   That formatting string has 2 fixed characters (":" and a space).

           •   So the maximum zone name length M is calculated as:
                   2 + 6 + 2*M + 1 = 29
                   2M = 29 - 2 - 6 - 1 = 20
                   M = 10
           The order in which Shorewall matches addresses from packets to zones is determined by the order of
           zone declarations. Where a zone is nested in one or more other zones, you may either ensure that the
           nested zone precedes its parents in this file, or you may follow the (sub)zone name by ":" and a
           comma-separated list of the parent zones. The parent zones must have been declared in earlier records
           in this file. See <b>shorewall-nesting</b>[2](5) for additional information.

           Example:

               #ZONE     TYPE     OPTIONS         IN OPTIONS        OUT OPTIONS
               a         ip
               b         ip
               c:a,b     ip

           Currently, Shorewall uses this information to reorder the zone list so that parent zones appear after
           their subzones in the list. The IMPLICIT_CONTINUE option in <b>shorewall.conf</b>[1](5) can also create
           implicit CONTINUE policies to/from the subzone.

           Where an <b>ipsec</b> zone is explicitly included as a child of an <b>ip</b> zone, the ruleset allows CONTINUE
           policies (explicit or implicit) to work as expected.

           In the future, Shorewall may make additional use of nesting information.

       <b>TYPE</b>

           <b>ip</b>
               This is the standard Shorewall zone type and is the default if you leave this column empty or if
               you enter "-" in the column. Communication with some zone hosts may be encrypted. Encrypted hosts
               are designated using the 'ipsec' option in <b>shorewall-hosts</b>[3](5). For clarity, this zone type may
               be specified as <b>ipv4</b> in IPv4 configurations and <b>ipv6</b> in IPv6 configurations.

           <b>ipsec</b>
               Communication with all zone hosts is encrypted. Your kernel and iptables must include policy
               match support. For clarity, this zone type may be specified as <b>ipsec4</b> in IPv4 configurations and
               <b>ipsec6</b> in IPv6 configurations.

           <b>firewall</b>
               Designates the firewall itself. You must have exactly one 'firewall' zone. No options are
               permitted with a 'firewall' zone. The name that you enter in the ZONE column will be stored in
               the shell variable $FW which you may use in other configuration files to designate the firewall
               zone.

           <b>bport</b>
               The zone is associated with one or more ports on a single bridge. For clarity, this zone type may
               be specified as <b>bport4</b> in IPv4 configurations and <b>bport6</b> in IPv6 configurations.

           <b>vserver</b>
               Added in Shorewall 4.4.11 Beta 2 - A zone composed of Linux-vserver guests. The zone contents
               must be defined in <b>shorewall-hosts</b>[3] (5).

               Vserver zones are implicitly handled as subzones of the firewall zone.

           <b>loopback</b>
               Added in Shorewall 4.5.17.

               Normally, Shorewall treats the loopback interface (lo) in the following way:

               •   By default, all traffic through the interface is ACCEPTed.

               •   If a $FW -&gt; $FW policy is defined or $FW -&gt; $FW rules are defined, they are placed in a chain
                   named ${FW}2${F2} or ${FW}-${FW} (e.g., 'fw2fw' or 'fw-fw' ) depending on the ZONE2ZONE
                   setting in <b>shorewall.conf</b>[1](5).

               •   $FW -&gt; $FW traffic is only filtered in the OUTPUT chain.

               By defining a <b>loopback</b> zone and associating it with the loopback interface in
               <a href="../man5/shorewall-interfaces.5.html">shorewall-interfaces</a>(5), you can effect a slightly different model. Suppose that the <b>loopback</b>
               zone name is 'local'; then:

               •   Both $FW -&gt; local and local -&gt; $FW chains are created.

               •   The $FW -&gt; local and local -&gt; $FW policies may be different.

               •   Both $FW -&gt; local and local -&gt; $FW rules may be specified.

               Rules to/from the <b>loopback</b> zone and any zone other than the firewall zone are ignored with a
               warning.

               <b>loopback</b> zones may be nested within other <b>loopback</b> zones.

           local
               Added in Shorewall 4.5.17.  <b>local</b> is the same as <b>ipv4</b> with the exception that the zone is only
               accessible from the <b>firewall</b> and <b>vserver</b> zones.

       <b>OPTIONS,</b> <b>IN</b> <b>OPTIONS</b> <b>and</b> <b>OUT</b> <b>OPTIONS</b> (options, in_options, out_options) - [<u>option</u>[<b>,</b><u>option</u>]...]
           A comma-separated list of options. With the exception of the <b>mss</b> and <b>blacklist</b> options, these only
           apply to TYPE <b>ipsec</b> zones.

           <b>dynamic_shared</b>
               Added in Shorewall 4.5.9. May only be specified in the OPTIONS column and indicates that only a
               single ipset should be created for this zone if it has multiple dynamic entries in
               <b>shorewall-hosts</b>[3](5). Without this option, a separate ipset is created for each interface.

           <b>reqid=</b><u>number</u>
               where <u>number</u> is specified using <a href="../man8/setkey.8.html">setkey</a>(8) using the 'unique:<u>number</u> option for the SPD level.

           <b>spi=</b>&lt;number&gt;
               where <u>number</u> is the SPI of the SA used to encrypt/decrypt packets.

           <b>proto=ah</b>|<b>esp</b>|<b>ipcomp</b>
               IPSEC Encapsulation Protocol

           <b>mss=</b><u>number</u>
               sets the MSS field in TCP packets. If you supply this option, you should also set FASTACCEPT=No
               in <b>shorewall.conf</b>[1](5) to insure that both the SYN and SYN,ACK packets have their MSS field
               adjusted.

           <b>mode=transport</b>|<b>tunnel</b>
               IPSEC mode

           <b>tunnel-src=</b><u>address</u>[/<u>mask</u>]
               only available with mode=tunnel

           <b>tunnel-dst=</b><u>address</u>[/<u>mask</u>]
               only available with mode=tunnel

           <b>strict</b>
               Means that packets must match all rules.

           <b>next</b>
               Separates rules; can only be used with strict

           The options in the OPTIONS column are applied to both incoming and outgoing traffic. The IN OPTIONS
           are applied to incoming traffic (in addition to OPTIONS) and the OUT OPTIONS are applied to outgoing
           traffic.

           If you wish to leave a column empty but need to make an entry in a following column, use "-".

</pre><h4><b>FILES</b></h4><pre>
       /etc/shorewall/zones

       /etc/shorewall6/zones

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>https://shorewall.org/Multiple_Zones.html</b>[4].

       <b>https://shorewall.org/configuration_file_basics.htm#Pairs</b>[5]

       <a href="../man8/shorewall.8.html">shorewall</a>(8)

</pre><h4><b>NOTES</b></h4><pre>
        1. shorewall.conf
           https://shorewall.org/manpages/shorewall.conf.html

        2. shorewall-nesting
           https://shorewall.org/manpages/shorewall-nesting.html

        3. shorewall-hosts
           https://shorewall.org/manpages/shorewall-hosts.html

        4. https://shorewall.org/Multiple_Zones.html
           https://shorewall.org/Multiple_Zones.html

        5. https://shorewall.org/configuration_file_basics.htm#Pairs
           https://shorewall.org/configuration_file_basics.htm#Pairs

Configuration Files                                09/24/2020                                 <u><a href="../man5/SHOREWALL-ZONES.5.html">SHOREWALL-ZONES</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>