<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>persistence.conf - Configuration file for persistence media in live-boot</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/open-infrastructure-system-boot">open-infrastructure-system-boot_20190301-lts1-5_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>persistence.conf</b> - Configuration file for persistence media in live-boot

</pre><h4><b>DESCRIPTION</b></h4><pre>
       If  live-boot  probes  a persistence volume with the label (or GPT name, or file name, but from now on we
       will just say "label") "persistence",  that  volume's  persistence  is  fully  customizable  through  the
       <b>persistence.conf</b>  file  stored  on  the root of its file system. Any such labeled volume must have such a
       file, or it will be ignored.

       The format of <b>persistence.conf</b> allows empty lines and lines starting with a "#" (used for comments), both
       which will be ignored. A so called "custom mount" has the format:

              <u>DIR</u> [<u>OPTION</u>]...

       which roughly translates to "make <u>DIR</u> persistence in the way described by the list of <u>OPTION</u>s".

       For each custom mount <u>DIR</u> must be an absolute path that cannot contain white spaces or the special .  and
       ..  path  components,  and  cannot  be /live (or any of its sub-directories).  Once activated all changes
       (file deletion, creation and modification) to <u>DIR</u> on the live file system are stored persistently into  a
       path  equivalent to <u>DIR</u> on the persistence media, called the source directory. The default way to achieve
       persistence is to simply bind-mount the corresponding source directory to <u>DIR</u>, but this  can  be  changed
       through the use of <u>OPTION</u>s.

       All  custom  mounts  will  be  done  in  an order so that no two custom mounts can "hide" each other. For
       instance, if we have the two <u>DIR</u>:s /a and /a/b it would always be the case that /a is mounted first, then
       /a/b. This remains true no  matter  how  the  lines  in  <b>persistence.conf</b>  are  ordered,  or  if  several
       <b>persistence.conf</b> files on different persistence media are used at the same time. However, it is forbidden
       for  custom mounts to have their source directory inside the source directory of another custom mount, so
       the source directories that are auto-created by live-boot does not support "nested" mounts  like  /a  and
       /a/b  on  the  same media. In this case you must use the <b>source</b> option (see below) to make sure that they
       are stored in different source directories.

       When a source directory doesn't exist on the persistence media for a certain custom  mount,  it  will  be
       created automatically, and permissions and ownership will be optimistically set according to <u>DIR</u>. It will
       also  be  bootstrapped  by  copying  the contents of the <u>DIR</u> into its source directory on the persistence
       media. The bootstrapping will not happen when the <b>link</b> or <b>union</b> options are used (see below).

</pre><h4><b>OPTIONS</b></h4><pre>
       Custom mounts defined in <b>persistence.conf</b> accept the following options in a comma-separated list:

       <b>source</b>=<u>PATH</u>
           When given, store the persistence changes into <u>PATH</u> on the persistence media. <u>PATH</u> must be a relative
           path (with respect to the persistence media root) that cannot contain white spaces or the  special  .
           or  ..  path  components,  with the exception that it can be just . which means the persistence media
           root. This option is mostly relevant if you want to nest custom mounts, which otherwise  would  cause
           errors,  or if you want to make the whole media root available (similar to the now deprecated <b>home-rw</b>
           type of persistence).

       The following options are mutually exclusive (only the last given one will be in effect):

       <b>bind</b>
           Bind-mount the source directory to <u>DIR</u>. This is the default.

       <b>link</b>
           Create the directory structure of the source directory on the persistence media  in  <u>DIR</u>  and  create
           symbolic  links  from  the corresponding place in <u>DIR</u> to each file in the source directory.  Existing
           files or directories with the same name as any link will be overwritten. Note that deleting the links
           in <u>DIR</u> will only remove the link, not the corresponding  file  in  the  source;  removed  links  will
           reappear  after  a  reboot. To permanently add or delete a file one must do so directly in the source
           directory.

           Effectively <b>link</b> will make only files already in the source directory persistent, not any other files
           in <u>DIR</u>. These files must be manually added to the source directory to make use of  this  option,  and
           they  will  appear in <u>DIR</u> in addition to files already there. This option is useful when only certain
           files need to be persistent, not the whole directory they're in, e.g. some configuration files  in  a
           user's home directory.

       <b>union</b>
           Save  the rw branch of a union on the persistence media, so only the changes are stored persistently.
           This can potentially reduce disk usage compared to bind-mounts, and will not hide files added to  the
           read-only  media.  One  caveat is that the union will use <u>DIR</u> from the image's read-only file system,
           not the real file system root, so files created after boot (e.g. by live-config) will not  appear  in
           the union. This option will use the union file system specified by live-boot's <b>union</b> boot parameter.

</pre><h4><b>DIRECTORIES</b></h4><pre>
       <b>/live/persistence</b>
           All  persistence  volumes will be mounted here (in a directory corresponding to the device name). The
           <b>persistence.conf</b> file can easily be edited through this mount, as  well  as  any  source  directories
           (which is especially practical for custom mounts using the <b>link</b> option).

</pre><h4><b>EXAMPLES</b></h4><pre>
       Let's say we have a persistence volume <u>VOL</u> with the a <b>persistence.conf</b> file containing the following four
       lines (numbered for ease of reference):

       1.     /home/user1 link,source=config-files/user1

       2.     /home/user2 link,source=config-files/user2

       3.     <a href="file:/home">/home</a>

       4.     <a href="file:/usr">/usr</a> union

       The corresponding source directories are:

       1.     <u>VOL</u>/config-files/user1 (but it would be <u>VOL</u>/home/user1 without the <b>source</b> option)

       2.     <u>VOL</u>/config-files/user2 (but it would be <u>VOL</u>/home/user2 without the <b>source</b> option)

       3.     <u>VOL</u><a href="file:/home">/home</a>

       4.     <u>VOL</u><a href="file:/usr">/usr</a>

       It was necessary to set the <b>source</b> options for 1 and 2, since they otherwise would become nested with 3's
       source, which is invalid.

       Line  3  will  be  taken care of before line 1 and 2 in order to prevent custom mounts 1 and 2 from being
       hidden by 3. When line 3 is handled, <u>VOL</u><a href="file:/home">/home</a> is simply bind-mounted on /home. To illustrate what happens
       for lines 1 and 2, let's say that the following files exist:

       a.     <u>VOL</u>/config-files/user1/.emacs

       b.     <u>VOL</u>/config-files/user2/.bashrc

       c.     <u>VOL</u>/config-files/user2/.ssh/config

       Then the following links and directories will be created:

       Link:  /home/user1/.emacs -&gt; <u>VOL</u>/config-files/user1/.emacs (from a)

       Link:  /home/user2/.bashrc -&gt; <u>VOL</u>/config-files/user2/.bashrc (from b)

       Dir:   /homea/user2/.ssh (from c)

       Link:  /home/user2/.ssh/config -&gt; <u>VOL</u>/config-files/user2/.ssh/config (from c)

       One could argue, though, that lines 1 and 2 in the example <b>persistence.conf</b> file  above  are  unnecessary
       since line 3 already would make all of <a href="file:/home">/home</a> persistent. The <b>link</b> option is intended for situations where
       you don't want a complete directory to be persistent, only certain files in it or its sub-directories.

       Line  4  can  be mounted at any time since its <u>DIR</u> (and source directory) is completely disjoint from all
       the other custom mounts. When mounted, <u>VOL</u><a href="file:/usr">/usr</a> will be the rw branch due to the <b>union</b>  option,  and  will
       only  contain  the  difference  compared to the underlying read-only file system. Hence packages could be
       installed into <a href="file:/usr">/usr</a> with great space-wise efficiency compared to bind-mounts, since in  the  latter  case
       all of <a href="file:/usr">/usr</a> would have to be copied into <u>VOL</u><a href="file:/usr">/usr</a> during the initial bootstrap.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man7/live-boot.7.html">live-boot</a></u>(7)

       <u><a href="../man7/live-build.7.html">live-build</a></u>(7)

       <u><a href="../man7/live-config.7.html">live-config</a></u>(7)

       <u><a href="../man7/live-tools.7.html">live-tools</a></u>(7)

</pre><h4><b>HOMEPAGE</b></h4><pre>
       More  information  about  live-boot  and  the  Live  Systems  project  can  be  found  on the homepage at
       &lt;<u><a href="http://live-systems.org/">http://live-systems.org/</a></u>&gt; and in the manual at &lt;<u><a href="http://live-systems.org/manual/">http://live-systems.org/manual/</a></u>&gt;.

</pre><h4><b>BUGS</b></h4><pre>
       Bugs can be reported by submitting a bugreport for the live-boot package in the Bug  Tracking  System  at
       &lt;<u><a href="http://bugs.debian.org/">http://bugs.debian.org/</a></u>&gt;   or  by  writing  a  mail  to  the  Live  Systems  mailing  list  at  &lt;<u>debian-</u>
       <u><a href="mailto:live@lists.debian.org">live@lists.debian.org</a></u>&gt;.

</pre><h4><b>AUTHOR</b></h4><pre>
       live-boot was written by Daniel Baumann &lt;<u><a href="mailto:mail@daniel-baumann.ch">mail@daniel-baumann.ch</a></u>&gt;.

5.0~a5-1                                           2015-09-22                                    <u>LIVE-BOOT</u>(conf)
</pre>
 </div>
</div></section>
</div>
</body>
</html>