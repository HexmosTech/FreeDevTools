<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mta-sts-daemon.yml - configuration file for mta-sts-daemon</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/postfix-mta-sts-resolver">postfix-mta-sts-resolver_1.5.0-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mta-sts-daemon.yml - configuration file for mta-sts-daemon

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This configuration file configures the listening socket, caching behaviour, and manipulation of MTA-STS
       mode.

</pre><h4><b>SYNTAX</b></h4><pre>
       The file is in YAML syntax with the following elements:

       <b>host</b>: (<u>str</u>) daemon bind address. Default: 127.0.0.1

       <b>port</b>: (<u>int</u>) daemon bind port. Default: 8461

       <b>path</b>: (<u>str</u>) daemon UNIX socket bind address (path). If specified, <b>host</b> and <b>port</b> are ignored and UNIX
       socket is bound instead of TCP.

       <b>mode</b>: (<u>int</u>) file mode for daemon UNIX socket. If not specified default filemode is used. This option has
       effect only when UNIX socket is used. If file mode specified in octal form (most common case), it has to
       be prepended with leading zero. Example: 0666

       <b>reuse_port</b>: (<u>bool</u>) allow multiple instances to share same port (available on Unix, Windows). Default:
       true

       <b>cache_grace</b>: (<u>float</u>) age of cache entries in seconds which do not require policy refresh and update.
       Default: 60

       <b>shutdown_timeout</b>: (<u>float</u>) time limit granted to existing client sessions for finishing when server stops.
       Default: 20

       <b>cache</b>

           •   <b>type</b>: (<u>str</u>: <u>internal</u>|<u>sqlite</u>|<u>redis</u>|<u>redis_sentinel</u>|postgres) cache backend type. Default: internal

           •   <b>options</b>:

               •   Options for <u>internal</u> type:

                   •   <b>cache_size</b>: (<u>int</u>) number of cache entries to store in memory. Default: 10000

               •   Options for <u>sqlite</u> type:

                   •   <b>filename</b>: (<u>str</u>) path to database file

                   •   <b>threads</b>: (<u>int</u>) number of threads in pool for SQLite connections. Default: number of CPUs

                   •   <b>timeout</b>: (<u>float</u>) timeout in seconds for acquiring connection from pool or DB lock.
                       Default: 5

               •   Options for <u>redis</u> type:

                   •   All parameters are passed to aioredis.from_url [0]. Check there for a parameter
                       reference.

               •   Options for <u>redis_sentinel</u> type:

                   •   <b>sentinel_master_name</b>: (<u>str</u>) name of the sentinel master

                   •   <b>sentinels</b>: (<u>list</u>)(<u>tuple</u>) list of sentinels in form of IP/FQDN and port

                   •   All other parameters are passed to aioredis.sentinel.Sentinel [1]. For additional details
                       check [2].

               •   Options for <u>postgres</u> type:

                   •   <b>dsn</b>: (<u>str</u>) database connection string

       <b>proactive_policy_fetching</b>

           •   <b>enabled</b>: (<u>bool</u>) enable proactive policy fetching in the background. Default: false

           •   <b>interval</b>: (<u>int</u>) if proactive policy fetching is enabled, it is scheduled every this many seconds.
               It is unaffected by cache_grace and vice versa. Default: 86400

           •   <b>concurrency_limit</b>: (<u>int</u>) the maximum number of concurrent domain updates. Default: 100

           •   <b>grace_ratio</b>: (<u>float</u>) proactive fetch for a particular domain is skipped if its cached policy age
               is less than interval/grace_ratio. Default: 2.0

       <b>default_zone</b>

           •   <b>strict_testing</b>: (<u>bool</u>) enforce policy for testing domains. Default: false

           •   <b>timeout</b>: (<u>int</u>) network operations timeout for resolver in that zone. Default: 4

           •   <b>require_sni</b>: (<u>bool</u>) add option servername=hostname to policy responses to make Postfix send SNI
               in TLS handshake as required by RFC 8461. Requires Postfix version 3.4+. Default: true

           •   <b>tlsrpt</b>: (<u>bool</u>) include response attributes for TLSRPT support (Postfix 3.10 and later). Default:
               false

       <b>zones</b>

           •   <b>ZONENAME</b>:

               •   Same as options in <u>default_zone</u>

       The timeout is used for the DNS and HTTP requests.

       MTA-STS "testing" mode can be interpreted as "strict" mode. This may be useful (though noncompliant) in
       the beginning of MTA-STS deployment, when many domains operate under "testing" mode.

</pre><h4><b>EXAMPLE</b></h4><pre>
           host: 127.0.0.1
           port: 8461
           reuse_port: true
           shutdown_timeout: 20
           proactive_policy_fetching:
             enabled: true
             interval: 86400
             concurrency_limit: 100
             grace_ratio: 2
           cache:
             type: internal
             options:
               cache_size: 10000
           default_zone:
             strict_testing: false
             timeout: 4
           zones:
             myzone:
               strict_testing: false
               timeout: 4

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/mta-sts-daemon.1.html">mta-sts-daemon</a></b>(1), <b><a href="../man1/mta-sts-query.1.html">mta-sts-query</a></b>(1)

</pre><h4><b>NOTES</b></h4><pre>
       0.
           https://aioredis.readthedocs.io/en/latest/api/high-level/#aioredis.client.Redis.from_url

       1.
           https://aioredis.readthedocs.io/en/latest/getting-started/#redis-sentinel-client

       2.
           https://redis.readthedocs.io/en/stable/connections.html#sentinel-client

postfix-mta-sts-resolver                           2025-03-10                              <u><a href="../man5/MTA-STS-DAEMON.YML.5.html">MTA-STS-DAEMON.YML</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>