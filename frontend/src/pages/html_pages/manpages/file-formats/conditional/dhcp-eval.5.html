<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dhcp-eval - ISC DHCP conditional evaluation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/isc-dhcp-common">isc-dhcp-common_4.4.3-P1-4ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dhcp-eval - ISC DHCP conditional evaluation

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  Internet  Systems  Consortium DHCP client and server both provide the ability to perform conditional
       behavior depending on the contents of packets they receive.  The syntax for specifying  this  conditional
       behaviour is documented here.

</pre><h4><b>REFERENCE:</b> <b>CONDITIONAL</b> <b>BEHAVIOUR</b></h4><pre>
       Conditional  behaviour  may  be  specified using the if statement and the else or elsif statements or the
       switch and case statements.  A conditional statement can appear anywhere that a regular statement  (e.g.,
       an option statement) can appear, and can enclose one or more such statements.

       <b>CONDITIONAL</b> <b>BEHAVIOUR:</b> <b>IF</b>

       A typical conditional if statement in a server might be:

       if option dhcp-user-class = "accounting" {
         max-lease-time 17600;
         option domain-name "accounting.example.org";
         option domain-name-servers ns1.accounting.example.org,
                           ns2.accounting.example.org;
       } elsif option dhcp-user-class = "sales" {
         max-lease-time 17600;
         option domain-name "sales.example.org";
         option domain-name-servers ns1.sales.example.org,
                           ns2.sales.example.org;
       } elsif option dhcp-user-class = "engineering" {
         max-lease-time 17600;
         option domain-name "engineering.example.org";
         option domain-name-servers ns1.engineering.example.org,
                           ns2.engineering.example.org;
       } else {
         max-lease-time 600;
         option domain-name "misc.example.org";
         option domain-name-servers ns1.misc.example.org,
                           ns2.misc.example.org;
       }

       On the client side, an example of conditional evaluation might be:

       # example.org filters DNS at its firewall, so we have to use their DNS
       # servers when we connect to their network.  If we are not at
       # example.org, prefer our own DNS server.
       if not option domain-name = "example.org" {
         prepend domain-name-servers 127.0.0.1;
       }

       The  <b>if</b>  statement and the <b>elsif</b> continuation statement both take boolean expressions as their arguments.
       That is, they take expressions that, when  evaluated,  produce  a  boolean  result.   If  the  expression
       evaluates  to  true,  then the statements enclosed in braces following the <b>if</b> statement are executed, and
       all subsequent <b>elsif</b> and <b>else</b> clauses are skipped.  Otherwise, each subsequent <b>elsif</b> clause's  expression
       is  checked,  until  an  elsif  clause  is encountered whose test evaluates to true.  If such a clause is
       found, the statements in braces following it are executed, and then any subsequent <b>elsif</b> and <b>else</b> clauses
       are skipped.  If all the <b>if</b> and <b>elsif</b> clauses are checked but none of their  expressions  evaluate  true,
       then  if  there  is  an  <b>else</b> clause, the statements enclosed in braces following the <b>else</b> are evaluated.
       Boolean expressions that evaluate to null are treated as false in conditionals.

       <b>CONDITIONAL</b> <b>BEHAVIOUR:</b> <b>SWITCH</b>

       The above example can be rewritten using a switch construct as well.

       switch (option dhcp-user-class) {
         case "accounting":
           max-lease-time 17600;
           option domain-name "accounting.example.org";
           option domain-name-servers ns1.accounting.example.org,
                             ns2.accounting.example.org;
         case "sales":
           max-lease-time 17600;
           option domain-name "sales.example.org";
           option domain-name-servers ns1.sales.example.org,
                             ns2.sales.example.org;
           break;
         case "engineering":
           max-lease-time 17600;
           option domain-name "engineering.example.org";
           option domain-name-servers ns1.engineering.example.org,
                             ns2.engineering.example.org;
           break;
         default:
           max-lease-time 600;
           option domain-name "misc.example.org";
           option domain-name-servers ns1.misc.example.org,
                             ns2.misc.example.org;
           break;
       }

       The <b>switch</b> statement and the <b>case</b> statements can both be data expressions or numeric expressions.  Within
       a switch statement they all must be the same type.  The server evaluates the expression from  the  switch
       statement and then it evaluates the expressions from the case statements until it finds a match.

       If  it finds a match it starts executing statements from that case until the next break statement.  If it
       doesn't find a match it starts from the default statement and again proceeds to the next break statement.
       If there is no match and no default it does nothing.

</pre><h4><b>BOOLEAN</b> <b>EXPRESSIONS</b></h4><pre>
       The following is the current list of boolean expressions that are supported by the DHCP distribution.

       <u>data-expression-1</u> <b>=</b> <u>data-expression-2</u>

         The <b>=</b> operator compares the values of two data expressions, returning true if they are the same,  false
         if  they  are  not.   If  either the left-hand side or the right-hand side are null, the result is also
         null.

       <u>data-expression-1</u> <b>~=</b> <u>data-expression-2</u> <u>data-expression-1</u> <b>~~</b> <u>data-expression-2</u>

         The <b>~=</b> and <b>~~</b> operators (not available on all systems) perform extended <a href="../man7/regex.7.html">regex</a>(7) matching of the values
         of two data expressions, returning true if <u>data-expression-1</u> matches  against  the  regular  expression
         evaluated  by <u>data-expression-2</u>, or false if it does not match or encounters some error.  If either the
         left-hand side or the right-hand side are null or empty strings, the result  is  also  false.   The  <b>~~</b>
         operator differs from the <b>~=</b> operator in that it is case-insensitive.

       <u>boolean-expression-1</u> <b>and</b> <u>boolean-expression-2</u>

         The  <b>and</b>  operator  evaluates  to  true if the boolean expression on the left-hand side and the boolean
         expression on the right-hand side both evaluate to true.  Otherwise, it evaluates to false.  If  either
         the  expression  on the left-hand side or the expression on the right-hand side are null, the result is
         null.

       <u>boolean-expression-1</u> <b>or</b> <u>boolean-expression-2</u>

         The <b>or</b> operator evaluates to true if either the boolean expression on the left-hand side or the boolean
         expression on the right-hand side evaluate to true.  Otherwise, it evaluates to false.  If  either  the
         expression on the left-hand side or the expression on the right-hand side are null, the result is null.

       <b>not</b> <u>boolean-expression</u>

         The  <b>not</b>  operator  evaluates  to  true  if <u>boolean-expression</u> evaluates to false, and returns false if
         <u>boolean-expression</u> evaluates to true.  If <u>boolean-expression</u> evaluates to  null,  the  result  is  also
         null.

       <b>exists</b> <u>option-name</u>

         The  <b>exists</b>  expression  returns  true if the specified option exists in the incoming DHCP packet being
         processed.
       <b>known</b>

         The <b>known</b> expression returns true if the client whose request is currently being processed is  known  -
         that is, if there's a host declaration for it.
       <b>static</b>

         The <b>static</b> expression returns true if the lease assigned to the client whose request is currently being
         processed is derived from a static address assignment.

</pre><h4><b>DATA</b> <b>EXPRESSIONS</b></h4><pre>
       Several of the boolean expressions above depend on the results of evaluating data expressions.  A list of
       these expressions is provided here.

       <b>substring</b> <b>(</b><u>data-expr</u><b>,</b> <u>offset</u><b>,</b> <u>length</u><b>)</b>

         The  <b>substring</b>  operator  evaluates the data expression and returns the substring of the result of that
         evaluation that starts <u>offset</u> bytes from the beginning, continuing for <u>length</u> bytes.  <u>Offset</u> and <u>length</u>
         are both numeric expressions.  If <u>data-expr</u>, <u>offset</u> or <u>length</u> evaluate to null, then the result is also
         null.  If <u>offset</u> is greater than or equal to the length of the evaluated data, then a zero-length  data
         string is returned.  If <u>length</u> <u>is</u> <u>greater</u> <u>then</u> <u>the</u> <u>remaining</u> <u>length</u> <u>of</u> <u>the</u> <u>evaluated</u> <u>data</u> <u>after</u> <u>offset</u>,
         then a data string containing all data from <u>offset</u> to the end of the evaluated data is returned.

       <b>suffix</b> <b>(</b><u>data-expr</u><b>,</b> <u>length</u><b>)</b>

         The  <b>suffix</b>  operator  evaluates  <u>data-expr</u>  and  returns  the  last <u>length</u> bytes of the result of that
         evaluation.  <u>Length</u> is a numeric expression.  If <u>data-expr</u> or <u>length</u> evaluate to null, then the  result
         is  also null.  If <u>suffix</u> evaluates to a number greater than the length of the evaluated data, then the
         evaluated data is returned.

       <b>lcase</b> <b>(</b><u>data-expr</u><b>)</b>

         The <b>lcase</b> function returns the result of evaluating <u>data-expr</u> converted to lower  case.   If  <u>data-expr</u>
         evaluates to null, then the result is also null.

       <b>ucase</b> <b>(</b><u>data-expr</u><b>)</b>

         The  <b>ucase</b>  function  returns the result of evaluating <u>data-expr</u> converted to upper case.  If <u>data-expr</u>
         evaluates to null, then the result is also null.

       <b>option</b> <u>option-name</u>

         The <b>option</b> operator returns the contents of the specified option in the packet to which the  server  is
         responding.

       <b>config-option</b> <u>option-name</u>

         The  <b>config-option</b>  operator  returns the value for the specified option that the DHCP client or server
         has been configured to send.

       <b>gethostname()</b>

         The <b>gethostname()</b> function returns a data string whose contents are a character string, the results  of
         calling  gethostname()  on  the  local  system  with  a  size  limit  of  255 bytes (not including NULL
         terminator).  This can be used for example to configure dhclient to send  the  local  hostname  without
         knowing the local hostname at the time dhclient.conf is written.

       <b>hardware</b>

         The  <b>hardware</b>  operator  returns  a  data  string  whose first element is the type of network interface
         indicated in packet being considered, and whose subsequent elements are  client's  link-layer  address.
         If  there  is  no  packet,  or if the RFC2131 <u>hlen</u> field is invalid, then the result is null.  Hardware
         types include ethernet (1), token-ring (6), and fddi (8).  Hardware types are specified  by  the  IETF,
         and  details on how the type numbers are defined can be found in RFC2131 (in the ISC DHCP distribution,
         this is included in the doc/ subdirectory).

       <b>packet</b> <b>(</b><u>offset</u><b>,</b> <u>length</u><b>)</b>

         The <b>packet</b> operator returns the specified portion of the packet being considered, or null  in  contexts
         where  no  packet  is being considered.  <u>Offset</u> and <u>length</u> are applied to the contents packet as in the
         <b>substring</b> operator.

       <u>string</u>

         A string, enclosed in quotes, may be specified as a data expression, and returns the text  between  the
         quotes,  encoded  in  ASCII.   The backslash ('\') character is treated specially, as in C programming:
         '\t' means TAB, '\r' means carriage return, '\n' means newline, and '\b' means bell.  Any  octal  value
         can  be  specified with '\nnn', where nnn is any positive octal number less than 0400.  Any hexadecimal
         value can be specified with '\xnn', where nn is any positive hexadecimal number less than or  equal  to
         0xff.

       <u>colon-separated</u> <u>hexadecimal</u> <u>list</u>

         A list of hexadecimal octet values, separated by colons, may be specified as a data expression.

       <b>concat</b> <b>(</b><u>data-expr1</u><b>,</b> <b>...,</b> <u>data-exprN</u><b>)</b>
         The expressions are evaluated, and the results of each evaluation are concatenated in the sequence that
         the subexpressions are listed.  If any subexpression evaluates to null, the result of the concatenation
         is null.

       <b>reverse</b> <b>(</b><u>numeric-expr1</u><b>,</b> <u>data-expr2</u><b>)</b>
         The two expressions are evaluated, and then the result of evaluating the data expression is reversed in
         place,  using  hunks  of  the  size  specified  in the numeric expression.  For example, if the numeric
         expression evaluates to four, and the data expression evaluates to  twelve  bytes  of  data,  then  the
         reverse  expression  will  evaluate  to  twelve bytes of data, consisting of the last four bytes of the
         input data, followed by the middle four bytes, followed by the first four bytes.

       <b>leased-address</b>
         In any context where the client whose request is being processed has been assigned an IP address,  this
         data  expression  returns  that  IP  address.   In  any context where the client whose request is being
         processed has not been assigned an  ip  address,  if  this  data  expression  is  found  in  executable
         statements  executed  on  that  client's behalf, a log message indicating "there is no lease associated
         with  this  client"  is  syslogged  to  the  debug  level  (this  is  considered  dhcpd.conf  debugging
         information).

       <b>binary-to-ascii</b> <b>(</b><u>numeric-expr1</u><b>,</b> <u>numeric-expr2</u><b>,</b> <u>data-expr1</u><b>,</b> <u>data-expr2</u><b>)</b>
         Converts  the result of evaluating data-expr2 into a text string containing one number for each element
         of the result of evaluating data-expr2.  Each number is separated from  the  other  by  the  result  of
         evaluating  data-expr1.   The result of evaluating numeric-expr1 specifies the base (2 through 16) into
         which the numbers should be converted.  The result of evaluating numeric-expr2 specifies the  width  in
         bits of each number, which may be either 8, 16 or 32.

         As  an example of the preceding three types of expressions, to produce the name of a PTR record for the
         IP address being assigned to a client, one could write the following expression:

               concat (binary-to-ascii (10, 8, ".",
                                        reverse (1, leased-address)),
                       ".in-addr.arpa.");

       <b>encode-int</b> <b>(</b><u>numeric-expr</u><b>,</b> <u>width</u><b>)</b>
         Numeric-expr is evaluated and encoded as a data string of the specified width, in  network  byte  order
         (most  significant  byte  first).  If the numeric expression evaluates to the null value, the result is
         also null.

       <b>pick-first-value</b> <b>(</b><u>data-expr1</u> [ ... <u>expr</u>n ] <b>)</b>
         The pick-first-value function takes any number of data expressions as its arguments.   Each  expression
         is  evaluated, starting with the first in the list, until an expression is found that does not evaluate
         to a null value.  That expression is returned, and none of the subsequent  expressions  are  evaluated.
         If all expressions evaluate to a null value, the null value is returned.

       <b>host-decl-name</b>
         The  host-decl-name  function  returns  the  name of the host declaration that matched the client whose
         request is currently being processed, if any.  If no host declaration matched, the result is  the  null
         value.

</pre><h4><b>NUMERIC</b> <b>EXPRESSIONS</b></h4><pre>
       Numeric expressions are expressions that evaluate to an integer.  In general, the maximum size of such an
       integer  should  not  be  assumed  to  be  representable in fewer than 32 bits, but the precision of such
       integers may be more than 32 bits.

       In addition to the following operators several standard math functions are available.  They are:
       operation    symbol
       add            <b>+</b>
       subtract       <b>-</b>
       divide         <b>/</b>
       multiply       <b>*</b>
       modulus        <b>%</b>
       bitwise and    <b>&amp;</b>
       bitwise or     <b>|</b>
       bitwise xor    <b>^</b>

       <b>extract-int</b> <b>(</b><u>data-expr</u><b>,</b> <u>width</u><b>)</b>

         The <b>extract-int</b> operator extracts an integer value in network byte order from the result of  evaluating
         the  specified  data expression.  Width is the width in bits of the integer to extract.  Currently, the
         only supported widths are 8, 16 and 32.  If the evaluation  of  the  data  expression  doesn't  provide
         sufficient bits to extract an integer of the specified size, the null value is returned.

       <b>lease-time</b>

         The  duration of the current lease - that is, the difference between the current time and the time that
         the lease expires.

       <u>number</u>

         Any number between zero and the maximum representable size may be specified as a numeric expression.

       <b>client-state</b>

         The current state of the client  instance  being  processed.   This  is  only  useful  in  DHCP  client
         configuration files.  Possible values are:

         <u>•</u> Booting  -  DHCP  client is in the INIT state, and does not yet have an IP address.  The next message
           transmitted will be a DHCPDISCOVER, which will be broadcast.

         <u>•</u> Reboot - DHCP client is in the INIT-REBOOT state.  It has an IP address, but is  not  yet  using  it.
           The next message to be transmitted will be a DHCPREQUEST, which will be broadcast.  If no response is
           heard, the client will bind to its address and move to the BOUND state.

         <u>•</u> Select  - DHCP client is in the SELECTING state - it has received at least one DHCPOFFER message, but
           is waiting to see if it may receive other DHCPOFFER messages from other  servers.   No  messages  are
           sent in the SELECTING state.

         <u>•</u> Request  -  DHCP  client is in the REQUESTING state - it has received at least one DHCPOFFER message,
           and has chosen which one it will request.  The next message to be sent will be a DHCPREQUEST message,
           which will be broadcast.

         <u>•</u> Bound - DHCP client is in the BOUND state - it has an IP address.  No  messages  are  transmitted  in
           this state.

         <u>•</u> Renew  -  DHCP  client  is in the RENEWING state - it has an IP address, and is trying to contact the
           server to renew it.  The next message to be sent will be a DHCPREQUEST message, which will be unicast
           directly to the server.

         <u>•</u> Rebind - DHCP client is in the REBINDING state - it has an IP address, and is trying to  contact  any
           server to renew it.  The next message to be sent will be a DHCPREQUEST, which will be broadcast.

</pre><h4><b>REFERENCE:</b> <b>ACTION</b> <b>EXPRESSIONS</b></h4><pre>
       <b>log</b> <b>(</b><u>priority</u><b>,</b> <u>data-expr</u><b>)</b>

         Logging  statements  may  be  used  to  send  information  to the standard logging channels.  A logging
         statement includes an optional priority (<b>fatal</b>, <b>error</b>, <b>info</b>, or <b>debug</b>), and a data expression.

         Logging statements take only a single data expression argument, so if you want to output multiple  data
         values, you will need to use the <b>concat</b> operator to concatenate them.

       <b>execute</b> <b>(</b><u>command-path</u> <b>[,</b> <u>data-expr1</u><b>,</b> <b>...</b> <u>data-exprN</u><b>]);</b>

         The  <b>execute</b> statement runs an external command.  The first argument is a string literal containing the
         name or path of the command to run.  The other arguments, if present, are  either  string  literals  or
         data-  expressions  which  evaluate  to  text  strings,  to  be passed as command-line arguments to the
         command.

         <b>execute</b> is synchronous; the program will block until the  external  command  being  run  has  finished.
         Please note that lengthy program execution (for example, in an "on commit" in dhcpd.conf) may result in
         bad  performance and timeouts.  Only external applications with very short execution times are suitable
         for use.

         Passing user-supplied data to an external application might  be  dangerous.   Make  sure  the  external
         application  checks  input buffers for validity.  Non-printable ASCII characters will be converted into
         dhcpd.conf language octal escapes ("\nnn"), make sure your external command handles them as such.

         It is possible to use the execute statement in any context, not only on events.  If you  put  it  in  a
         regular scope in the configuration file you will execute that command every time a scope is evaluated.

       <b>parse-vendor-option;</b>

         The <b>parse-vendor-option</b> statement attempts to parse a vendor option (code 43).  It is only useful while
         processing  a  packet  on  the  server and requires that the administrator has already used the <b>vendor-</b>
         <b>option-space</b> statement to select a valid vendor space.

         This functionality may be used if the server needs to take different actions depending  on  the  values
         the  client  placed in the vendor option and the sub-options are not at fixed locations.  It is handled
         as an action to allow an administrator to examine the incoming options and choose  the  correct  vendor
         space.

</pre><h4><b>REFERENCE:</b> <b>DYNAMIC</b> <b>DNS</b> <b>UPDATES</b></h4><pre>
       See the dhcpd.conf and dhclient.conf man pages for more information about DDNS.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man5/dhcpd.conf.5.html">dhcpd.conf</a>(5),   <a href="../man5/dhcpd.leases.5.html">dhcpd.leases</a>(5),  <a href="../man5/dhclient.conf.5.html">dhclient.conf</a>(5),  <a href="../man5/dhcp-options.5.html">dhcp-options</a>(5),  <a href="../man8/dhcpd.8.html">dhcpd</a>(8),  <a href="../man8/dhclient.8.html">dhclient</a>(8),  RFC2132,
       RFC2131.

</pre><h4><b>AUTHOR</b></h4><pre>
       Information about Internet Systems Consortium can be found at <b>https://www.isc.org.</b>

                                                                                                    <u><a href="../man5/dhcp-eval.5.html">dhcp-eval</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>