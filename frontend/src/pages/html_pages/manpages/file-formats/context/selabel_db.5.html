<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>selabel_db  -  userspace  SELinux  labeling interface and configuration file format for the RDBMS objects</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/selinux-utils">selinux-utils_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       selabel_db  -  userspace  SELinux  labeling interface and configuration file format for the RDBMS objects
       context backend

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/label.h&gt;</b>

       <b>int</b> <b>selabel_lookup(struct</b> <b>selabel_handle</b> <b>*</b><u>hnd</u><b>,</b>
                          <b>char</b> <b>**</b><u>context</u><b>,</b>
                          <b>const</b> <b>char</b> <b>*</b><u>object_name</u><b>,</b> <b>int</b> <u>object_type</u><b>);</b>

       <b>int</b> <b>selabel_lookup_raw(struct</b> <b>selabel_handle</b> <b>*</b><u>hnd</u><b>,</b>
                          <b>char</b> <b>**</b><u>context</u><b>,</b>
                          <b>const</b> <b>char</b> <b>*</b><u>object_name</u><b>,</b> <b>int</b> <u>object_type</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The DB contexts backend maps from a pair of object name and class into security contexts. It is  used  to
       find  the  appropriate  context  for  database  objects  when relabeling a certain database. The returned
       <u>context</u> must be freed using <b><a href="../man3/freecon.3.html">freecon</a></b>(3).
       <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3) describes the function with its return and error codes.

       The <u>object_name</u> should be a fully qualified name using the hierarchy of database  objects.  For  example,
       the <b>pg_class</b> table in the <b>postgres</b> database and <b>pg_catalog</b> schema should be qualified as:
              <b>Bpostgres.pg_catalog.pg_class</b>

       The <b>NOTES</b> section has further information on database support for namespace hierarchies.

       The <u>object_type</u> argument should be set to one of the following values:

              <b>SELABEL_DB_DATABASE</b>
                     The <u>object_name</u> argument specifies the name of a database itself, such as "postgres".

              <b>SELABEL_DB_SCHEMA</b>
                     The <u>object_name</u> argument specifies the name of a schema object, such as "postgres.public".

              <b>SELABEL_DB_TABLE</b>
                     The   <u>object_name</u>   argument   specifies   the   name   of   a   table   object,   such  as
                     "postgres.public.my_table"

              <b>SELABEL_DB_COLUMN</b>
                     The  <u>object_name</u>  argument   specifies   the   name   of   a   column   object,   such   as
                     "postgres.public.my_table.user_id"

              <b>SELABEL_DB_TUPLE</b>
                     The  <u>object_name</u> argument specifies the name of a table object which contains the tuples to
                     be relabeled, such as "postgresql.public.my_table". Note that we have no  way  to  identify
                     individual  tuple  objects,  except  for  WHERE clause on DML statements, because it has no
                     name.

              <b>SELABEL_DB_PROCEDURE</b>
                     The  <u>object_name</u>  argument  specifies  the  name   of   a   procedure   object,   such   as
                     "postgres.public.my_func".  Note  that  we  don't  support  lookup  of  individual security
                     contexts for procedures which have the same name but different arguments.

              <b>SELABEL_DB_SEQUENCE</b>
                     The  <u>object_name</u>  argument  specifies  the   name   of   a   sequence   object,   such   as
                     "postgres.public.my_seq".

              <b>SELABEL_DB_BLOB</b>
                     The  <u>object_name</u>  argument  specifies the name of a large object, such as "postgres.16308".
                     Note that a large object does not have a name, so it is identified by its identifier value.

              <b>SELABEL_DB_VIEW</b>
                     The   <u>object_name</u>   argument   specifies   the   name   of   a   view   object,   such   as
                     "postgres.public.my_view".

              <b>SELABEL_DB_LANGUAGE</b>
                     The   <u>object_name</u>   argument   specifies   the   name   of   a  language  object,  such  as
                     "postgres.public.tcl".

              <b>SELABEL_DB_EXCEPTION</b>
                     The <u>object_name</u> argument specifies the name of a exception object.

              <b>SELABEL_DB_DATATYPE</b>
                     The <u>object_name</u>  argument  specifies  the  name  of  a  type  or  domain  object,  such  as
                     postgres.public.my_type.

       Any  messages  generated by <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3) are sent to <u>stderr</u> by default, although this can be changed
       by <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3).

       <b><a href="../man3/selabel_lookup_raw.3.html">selabel_lookup_raw</a></b>(3) behaves identically to <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3) but does not perform context translation.

       The <b>FILES</b> section details the configuration files used to determine the database object context.

</pre><h4><b>OPTIONS</b></h4><pre>
       In addition to the global options described in <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3), this  backend  recognizes  the  following
       options:

              <b>SELABEL_OPT_PATH</b>
                     A  non-null value for this option specifies a path to a file that will be opened in lieu of
                     the standard DB contexts file.  It tries to open the specfile designed for SE-PostgreSQL as
                     default, so if another RDBMS uses this interface, it needs to  give  an  explicit  specfile
                     designed for that RDBMS (see the <b>FILES</b> section for details).

</pre><h4><b>FILES</b></h4><pre>
       The  database context file used to retrieve a context depends on the <b>SELABEL_OPT_PATH</b> parameter passed to
       <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3). If <u>NULL</u>, then the <b>SELABEL_OPT_PATH</b> value will default  to  the  active  policy  database
       contexts location (as returned by <b><a href="../man3/selinux_sepgsql_context_path.3.html">selinux_sepgsql_context_path</a></b>(3)), otherwise the actual <b>SELABEL_OPT_PATH</b>
       value specified is used (this option must be used to support databases other than SE-PostgreSQL).

       The default database object contexts file is:
              <u><a href="file:/etc/selinux/">/etc/selinux/</a>{SELINUXTYPE}/contexts/sepgsql_context</u>

       Where <u>{SELINUXTYPE}</u> is the entry from the selinux configuration file <u>config</u> (see <b><a href="../man5/selinux_config.5.html">selinux_config</a></b>(5)).

       The  entries within the database contexts file are shown in the <b>Object</b> <b>Name</b> <b>String</b> <b>Values</b> and <b>FILE</b> <b>FORMAT</b>
       sections.

</pre><h4><b>Object</b> <b>Name</b> <b>String</b> <b>Values</b></h4><pre>
       The string name assigned to each <u>object_type</u> argument that can be present in the database  contexts  file
       are:
                                       ┌──────────────────────┬──────────────┐
                                       │ <u>object_type</u>          │ <b>Text</b> <b>Name</b>    │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_DATABASE</b>  │ db_database  │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_SCHEMA</b>    │ db_schema    │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_VIEW</b>      │ db_view      │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_LANGUAGE</b>  │ db_language  │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_TABLE</b>     │ db_table     │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_COLUMN</b>    │ db_column    │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_TUPLE</b>     │ db_tuple     │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_PROCEDURE</b> │ db_procedure │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_SEQUENCE</b>  │ db_sequence  │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_BLOB</b>      │ db_blob      │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_EXCEPTION</b> │ db_exception │
                                       ├──────────────────────┼──────────────┤
                                       │ <b>SELABEL_DB_DATATYPE</b>  │ db_datatype  │
                                       └──────────────────────┴──────────────┘

</pre><h4><b>FILE</b> <b>FORMAT</b></h4><pre>
       Each line within the database contexts file is as follows:
              <u>object_type</u> <u>object_name</u> <u>context</u>

       Where:
              <u>object_type</u>
                     This is the string representation of the object type shown in the <b>Object</b> <b>Name</b> <b>String</b> <b>Values</b>
                     section.
              <u>object_name</u>
                     The key used to obtain the context based on the <u>object_type</u>.

                     The entry can contain '*' for wildcard matching or '?' for substitution.

                     Note  that  if  the  '*'  is  used,  then be aware that the order of entries in the file is
                     important. The '*' on its own is used to ensure a default fallback context is assigned  and
                     should be the last entry in the <u>object_type</u> block.
              <u>context</u>
                     The security context that will be applied to the object.

       The following example is for SE-PostgreSQL:

       # ./contexts/sepgsql_contexts file
       # object_type  object_name   context
       db_database    my_database   system_u:object_r:sepgsql_db_t:s0
       db_database    *             system_u:object_r:sepgsql_db_t:s0
       db_schema      *.*           system_u:object_r:sepgsql_schema_t:s0
       db_tuple       row_low       system_u:object_r:sepgsql_table_t:s0
       db_tuple       row_high      system_u:object_r:sepgsql_table_t:s0:c1023
       db_tuple       *.*.*         system_u:object_r:sepgsql_table_t:s0

</pre><h4><b>NOTES</b></h4><pre>
       1.  A  suitable  database contexts file needs to be written for the target RDBMS and the <b>SELABEL_OPT_PATH</b>
           option must be used in <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3) to load it.

       2.  The hierarchy of the namespace for database objects  depends  on  the  RDBMS,  however  the  <u>selabel*</u>
           interfaces do not have any specific support for a namespace hierarchy.

           SE-PostgreSQL  has  a  namespace  hierarchy  where a database is the top level object with the schema
           being the next level. Under the schema object there can be other types of objects such as tables  and
           procedures. This hierarchy is supported as follows:

                  If  a  security  context  is  required  for "my_table" table in the "public" schema within the
                  "postgres"  database,  then  the  <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3)  parameters  for  <u>object_type</u>   would   be
                  <b>SELABEL_DB_TABLE</b> and the <u>object_name</u> would be "postgres.public.my_table", the security context
                  (if available), would be returned in <u>context</u>.

       3.  If  contexts  are  to  be  validated,  then the global option <b>SELABEL_OPT_VALIDATE</b> must be set before
           calling <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3). If this is not set, then it  is  possible  for  an  invalid  context  to  be
           returned.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/selinux.8.html">selinux</a></b>(8), <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3), <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3), <b><a href="../man3/selabel_stats.3.html">selabel_stats</a></b>(3), <b><a href="../man3/selabel_close.3.html">selabel_close</a></b>(3),
       <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3), <b><a href="../man3/selinux_sepgsql_context_path.3.html">selinux_sepgsql_context_path</a></b>(3), <b><a href="../man3/freecon.3.html">freecon</a></b>(3), <b><a href="../man5/selinux_config.5.html">selinux_config</a></b>(5)

Security Enhanced Linux                            01 DEC 2011                                     <u><a href="../man5/selabel_db.5.html">selabel_db</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>