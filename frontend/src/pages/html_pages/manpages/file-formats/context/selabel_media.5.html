<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>selabel_media - userspace SELinux labeling interface and configuration file format for the media contexts</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/selinux-utils">selinux-utils_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       selabel_media - userspace SELinux labeling interface and configuration file format for the media contexts
       backend

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/label.h&gt;</b>

       <b>int</b> <b>selabel_lookup(struct</b> <b>selabel_handle</b> <b>*</b><u>hnd</u><b>,</b>
                          <b>char</b> <b>**</b><u>context</u><b>,</b>
                          <b>const</b> <b>char</b> <b>*</b><u>device_name</u><b>,</b> <b>int</b> <u>unused</u><b>);</b>

       <b>int</b> <b>selabel_lookup_raw(struct</b> <b>selabel_handle</b> <b>*</b><u>hnd</u><b>,</b>
                          <b>char</b> <b>**</b><u>context</u><b>,</b>
                          <b>const</b> <b>char</b> <b>*</b><u>device_name</u><b>,</b> <b>int</b> <u>unused</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  media  contexts  backend  maps  from  media  device  names such as "cdrom" or "floppy" into security
       contexts. It is used to find the appropriate context for establishing context mounts  on  these  devices.
       The returned <u>context</u> must be freed using <b><a href="../man3/freecon.3.html">freecon</a></b>(3).
       <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3) describes the function with its return and error codes.

       The integer lookup argument is currently unused and should be set to zero.

       Any  messages  generated by <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3) are sent to <u>stderr</u> by default, although this can be changed
       by <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3).

       <b><a href="../man3/selabel_lookup_raw.3.html">selabel_lookup_raw</a></b>(3) behaves identically to <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3) but does not perform context translation.

       The <b>FILES</b> section details the configuration files used to determine the media context.

</pre><h4><b>OPTIONS</b></h4><pre>
       In addition to the global options described in <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3), this  backend  recognizes  the  following
       options:

       <b>SELABEL_OPT_PATH</b>
              A  non-null  value  for  this option specifies a path to a file that will be opened in lieu of the
              standard <u>media</u> contexts file.

</pre><h4><b>FILES</b></h4><pre>
       The media context file used to retrieve a default  context  depends  on  the  <b>SELABEL_OPT_PATH</b>  parameter
       passed  to  <b><a href="../man3/selabel_open.3.html">selabel_open</a>(3).</b>  <b>If</b>  <u>NULL</u>, then the <b>SELABEL_OPT_PATH</b> value will default to the active policy
       media  contexts  location  (as  returned  by   <b><a href="../man3/selinux_media_context_path.3.html">selinux_media_context_path</a></b>(3)),   otherwise   the   actual
       <b>SELABEL_OPT_PATH</b> value specified is used.

       The default media contexts file is:
              <u><a href="file:/etc/selinux/">/etc/selinux/</a>{SELINUXTYPE}/contexts/files/media</u>

       Where <u>{SELINUXTYPE}</u> is the entry from the selinux configuration file <u>config</u> (see <b><a href="../man5/selinux_config.5.html">selinux_config</a></b>(5)).

</pre><h4><b>FILE</b> <b>FORMAT</b></h4><pre>
       Each line within the <u>media</u> file is as follows:
              <u>device_name</u> <u>context</u>

       Where:
              <u>device_name</u>
                     The media identifier (e.g. cdrom, floppy, disk and usb).
              <u>context</u>
                     The context to be used for labeling the device.

       Example:
              # contexts/files/media
              cdrom system_u:object_r:removable_device_t
              floppy system_u:object_r:removable_device_t
              disk system_u:object_r:fixed_disk_device_t

</pre><h4><b>NOTES</b></h4><pre>
       If  contexts  are to be validated, then the global option <b>SELABEL_OPT_VALIDATE</b> must be set before calling
       <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3). If this is not set, then it is possible for an invalid context to be returned.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/selinux.8.html">selinux</a></b>(8), <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3), <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3), <b><a href="../man3/selabel_stats.3.html">selabel_stats</a></b>(3), <b><a href="../man3/selabel_close.3.html">selabel_close</a></b>(3),
       <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3), <b><a href="../man3/selinux_media_context_path.3.html">selinux_media_context_path</a></b>(3), <b><a href="../man3/freecon.3.html">freecon</a></b>(3), <b><a href="../man5/selinux_config.5.html">selinux_config</a></b>(5)

Security Enhanced Linux                            29 Nov 2011                                  <u><a href="../man5/selabel_media.5.html">selabel_media</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>