<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>magic - format of .mag files read/written by Magic</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/magic">magic_8.3.105+ds.1-1.1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       magic - format of <b>.mag</b> files read/written by Magic

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Magic  uses  its  own internal ASCII format for storing cells in disk files.  Each cell <u>name</u> is stored in
       its own file, named <u>name</u><b>.mag</b>.

       The first line in a <b>.mag</b> file is the string

                 <b>magic</b>

       to identify this as a Magic file.

       The next line is optional and is used to identify the technology  in  which  a  cell  was  designed.   If
       present, it should be of the form

                 <b>tech</b> <u>techname</u>

       If absent, the technology defaults to a system-wide standard, currently <b>nmos</b>.

       The next line is also optional and gives a timestamp for the cell.  The line is of the format

                 <b>timestamp</b> <u>stamp</u>

       where  <u>stamp</u>  is  a number of seconds since 00:00 GMT January 1, 1970 (i.e, the Unix time returned by the
       library function <u>time()</u>).  It should be the last time this cell or any  of  its  children  changed.   The
       timestamp  is  used to detect when a child is edited outside the context of its parent (the parent stores
       the last timestamp it saw for each of its children;  see  below).   When  this  occurs,  the  design-rule
       checker  must  recheck  the  entire  area  of the child for subcell interaction errors.  If this field is
       omitted in a cell, Magic supplies a default value that forces the rechecks.

       Next come lines describing the contents of  the  cell.   There  are  three  kinds  of  groups  of  lines,
       describing  mask  rectangles, subcell uses, and labels.  Each group must appear contiguously in the file,
       but the order between groups is arbitrary.

       Each group of mask rectangles is headed with a line of the format

                 <b>&lt;&lt;</b> <u>layer</u> <b>&gt;&gt;</b>

       where <u>layer</u> is a layername known in the current technology (see the <b>tech</b> line above).   Each  line  after
       this header has the format

                 <b>rect</b> <u>xbot</u> <u>ybot</u> <u>xtop</u> <u>ytop</u>

       where  <u>(xbot,</u> <u>ybot)</u>  is  the  lower-left  corner  of  the  rectangle  in  Magic (lambda) coordinates, and
       <u>(xtop,</u> <u>ytop)</u> is the upper-right corner.  Degenerate rectangles are not allowed;  <u>xbot</u>  must  be  strictly
       less than <u>xtop</u>, and <u>ybot</u> strictly less than <u>ytop</u>.  The smallest legal value of <u>xbot</u> or <u>ybot</u> is <b>âˆ’67108858</b>,
       and  the  largest  legal value for <u>xtop</u> or <u>ytop</u> is <b>67108858</b>.  Values that approach these limits (within a
       factor of 100 or 1000) may cause numerical overflows in Magic even though they are not strictly  illegal.
       We recommend using coordinates around zero as much as possible.

       Rectangles should be non-overlapping, although this is not essential.  They should also already have been
       merged  into maximal horizontal strips (the neighbor to the right or left of a rectangle should not be of
       the same type), but this is also not essential.

       The second kind of line group describes a single cell use.  Each cell use group is of the following form:

                 <b>use</b> <u>filename</u> <u>use-id</u>
                 <b>array</b> <u>xlo</u> <u>xhi</u> <u>xsep</u> <u>ylo</u> <u>yhi</u> <u>ysep</u>
                 <b>timestamp</b> <u>stamp</u>
                 <b>transform</b> <u>a</u> <u>b</u> <u>c</u> <u>d</u> <u>e</u> <u>f</u>
                 <b>box</b> <u>xbot</u> <u>ybot</u> <u>xtop</u> <u>ytop</u>

       A group specifies a single instance of the cell named <u>filename</u>,  with  instance-identifier  <u>use-id</u>.   The
       instance-identifier  <u>use-id</u>  must  be  unique  among  all cells used by this <b>.mag</b> file.  If <u>use-id</u> is not
       specified, a unique one is generated automatically.

       The <b>array</b> line need only be present if the cell is an array.  If so, the X indices run from  <u>xlo</u>  to  <u>xhi</u>
       inclusive,  with  elements  being  separated  from  each  other in the X dimension by <u>xsep</u> lambda.  The Y
       indices run from <u>ylo</u> to <u>yhi</u> inclusive, with elements being separated from each other in the  Y  dimension
       by  <u>ysep</u>  lambda.  If <u>xlo</u> and <u>xhi</u> are equal, <u>xsep</u> is ignored; similarly if <u>ylo</u> and <u>yhi</u> are equal, <u>ysep</u> is
       ignored.

       The <b>timestamp</b> line is optional; if present, it gives the last time this cell was  aware  that  the  child
       <u>filename</u>  changed.  If there is no <b>timestamp</b> line, a timestamp of 0 is assumed.  When the subcell is read
       in, this value is compared to the actual value at the beginning  of  the  child  cell.   If  there  is  a
       difference,  the  ``timestamp  mismatch''  message is printed, and Magic rechecks design-rules around the
       child.

       The <b>transform</b> line gives the geometric transform from coordinates of the child <u>filename</u> into  coordinates
       of  the  cell being read.  The six integers <u>a</u>, <u>b</u>, <u>c</u>, <u>d</u>, <u>e</u>, and <u>f</u> are part of the following transformation
       matrix, which is used to postmultiply all coordinates in the child <u>filename</u> whenever their coordinates in
       the parent are required:

                           <u>a</u>    <u>d</u>    0
                           <u>b</u>    <u>e</u>    0
                           <u>c</u>    <u>f</u>    1

       Finally, <b>box</b> gives an estimate of the bounding box of cell <u>filename</u> (covering all  the  elements  of  the
       array if an <b>array</b> line was present), in coordinates of the cell being read.

       The third kind of line group in a <b>.mag</b> file is a list of labels.  It begins with the line

                 <b>&lt;&lt;</b> <b>labels</b> <b>&gt;&gt;</b>

       and is followed by zero or more lines of the following form:

                 <b>rlabel</b> <u>layer</u> <u>xbot</u> <u>ybot</u> <u>xtop</u> <u>ytop</u> <u>position</u> <u>text</u>

       Here <u>layer</u> is the name of one of the layers specified in the technology file for this cell.  The label is
       attached  to  material of this type.  <u>Layer</u> may be <b>space</b>, in which case the label is not considered to be
       attached to any layer.

       Labels are rectangular.  The lower-left corner of the label (the part attached to any geometry  if  <u>layer</u>
       is non-<b>space</b>) is at <u>(xbot,</u> <u>ybot)</u>, and the upper-right corner at <u>(xtop,</u> <u>ytop)</u>.  The width of the rectangle
       or its height may be zero.  In fact, most labels in Magic have a lower-left equal to their upper right.

       The  text  of  the  label, <u>text</u>, may be any sequence of characters not including a newline.  This text is
       located at one of nine possible orientations relative to the center of the label's  rectangle.   <u>Position</u>
       is an integer between 0 and 8, each of which corresponds to a different orientation:

                 <b>0</b>    center
                 <b>1</b>    north
                 <b>2</b>    northeast
                 <b>3</b>    east
                 <b>4</b>    southeast
                 <b>5</b>    south
                 <b>6</b>    southwest
                 <b>7</b>    west
                 <b>8</b>    northwest

       A <b>.mag</b> file is terminated by the line

                 <b>&lt;&lt;</b> <b>end</b> <b>&gt;&gt;</b>

       Everything following this line is ignored.

       Any line beginning with a pound sigh (``<b>#</b>'') is considered to be a comment and ignored.  Beware, however,
       that  these  comments  are  discarded  by Magic when it reads a cell, so if that cell is written again by
       Magic, the comments will be lost.

</pre><h4><b>NOTE</b> <b>FOR</b> <b>PROGRAMS</b> <b>THAT</b> <b>GENERATE</b> <b>MAGIC</b> <b>FILES</b></h4><pre>
       Magic's incremental design rule checker expects that every cell is either completely checked, or contains
       information to tell the checker which areas  of  the  cell  have  yet  to  be  examined  for  design-rule
       violations.   To make sure that the design-rule checker verifies all the material that has been generated
       for a cell, programs that generate <b>.mag</b> files should place the following rectangle in each file:

                 <b>&lt;&lt;</b> <b>checkpaint</b> <b>&gt;&gt;</b>
                 <b>rect</b> <u>xbot</u> <u>ybot</u> <u>xtop</u> <u>ytop</u>

       This rectangle may appear anywhere a list of rectangles is allowed; immediately following  the  <b>timestamp</b>
       line  at  the beginning of a <b>.mag</b> file is a good place.  The coordinates <u>xbot</u> etc. should be large enough
       to completely cover anything in the cell, and must surround all this material by at least one lambda.  Be
       careful, however, not to make this area too ridiculously large.  For example, if you use the maximum  and
       minimum  legal  tile  coordinates, it will take the design-rule checker an extremely long time to recheck
       the area.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/magic.1.html">magic</a>(1)

4th Berkeley Distribution                                                                               <u><a href="../man5/MAGIC.5.html">MAGIC</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>