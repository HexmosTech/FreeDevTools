<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>firewalld.direct - firewalld direct configuration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/firewalld">firewalld_2.3.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       firewalld.direct - firewalld direct configuration file

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <u>/etc/firewalld/direct.xml</u>

</pre><h4><b>DEPRECATED</b></h4><pre>
       The direct interface has been deprecated. It will be removed in a future release. It is superseded by
       policies, see <b><a href="../man5/firewalld.policies.5.html">firewalld.policies</a></b>(5).

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Direct configuration gives a more direct access to the firewall. It requires user to know basic
       <a href="../man6/ip.6.html">ip</a>(6)tables/ebtables concepts, i.e.  <u>table</u> (filter/mangle/nat/...), <u>chain</u> (INPUT/OUTPUT/FORWARD/...),
       <u>commands</u> (-A/-D/-I/...), <u>parameters</u> (-p/-s/-d/-j/...) and <u>targets</u> (ACCEPT/DROP/REJECT/...). Direct
       configuration should be used only as a last resort when it's not possible to use <b><a href="../man5/firewalld.zone.5.html">firewalld.zone</a></b>(5). See
       also <u>Direct</u> <u>Options</u> in <b><a href="../man1/firewall-cmd.1.html">firewall-cmd</a></b>(1).

       A firewalld direct configuration file contains information about permanent direct chains, rules and
       passthrough ...

       This is the structure of a direct configuration file:

           &lt;?xml version="1.0" encoding="utf-8"?&gt;
           &lt;direct&gt;
             [ &lt;chain ipv="<u>ipv4</u>|<u>ipv6</u>|<u>eb</u>" table="<u>table</u>" chain="<u>chain</u>"/&gt; ]
             [ &lt;rule ipv="<u>ipv4</u>|<u>ipv6</u>|<u>eb</u>" table="<u>table</u>" chain="<u>chain</u>" priority="<u>priority</u>"&gt; args &lt;/rule&gt; ]
             [ &lt;passthrough ipv="<u>ipv4</u>|<u>ipv6</u>|<u>eb</u>"&gt; args &lt;/passthrough&gt; ]
           &lt;/direct&gt;

   <b>direct</b>
       The mandatory direct start and end tag defines the direct. This tag can only be used once in a direct
       configuration file. There are no attributes for direct.

   <b>chain</b>
       Is an optional empty-element tag and can be used several times. It can be used to define names for
       additional chains. A chain entry has exactly three attributes:

       ipv="<u>ipv4</u>|<u>ipv6</u>|<u>eb</u>"
           The IP family where the chain will be created. This can be either <u>ipv4</u>, <u>ipv6</u> or <u>eb</u>.

       table="<u>table</u>"
           The table name where the chain will be created. This can be one of the tables that can be used for
           iptables, ip6tables or ebtables. For the possible values, see TABLES section in the iptables,
           ip6tables or ebtables man pages.

       chain="<u>chain</u>"
           The name of the chain, that will be created. Please make sure that there is no other chain with this
           name already.

       Please remember to add a rule or passthrough rule with an <b>--jump</b> or <b>--goto</b> option to connect the chain to
       another one.

   <b>rule</b>
       Is an optional element tag and can be used several times. It can be used to add rules to a built-in or
       added chain. A rule entry has exactly four attributes:

       ipv="<u>ipv4</u>|<u>ipv6</u>|<u>eb</u>"
           The IP family where the rule will be added. This can be either <u>ipv4</u>, <u>ipv6</u> or <u>eb</u>.

       table="<u>table</u>"
           The table name where the rule will be added. This can be one of the tables that can be used for
           iptables, ip6tables or ebtables. For the possible values, see TABLES section in the iptables,
           ip6tables or ebtables man pages.

       chain="<u>chain</u>"
           The name of the chain where the rule will be added. This can be either a built-in chain or a chain
           that has been created with the chain tag. If the chain name is a built-in chain, then the rule will
           be added to <u>chain</u>_direct, else the supplied chain name is used.  <u>chain</u>_direct is created internally
           for all built-in chains to make sure that the added rules do not conflict with the rules created by
           firewalld.

       priority="<u>priority</u>"
           The priority is used to order rules. Priority 0 means add rule on top of the chain, with a higher
           priority the rule will be added further down. Rules with the same priority are on the same level and
           the order of these rules is not fixed and may change. If you want to make sure that a rule will be
           added after another one, use a low priority for the first and a higher for the following.

       The <u>args</u> can be any arguments of iptables or ip6tables, that do not conflict with the table or chain
       attributes.

   <b>passthrough</b>
       Is an optional element tag and can be used several times. It can be used to add rules to a built-in or
       added chain. A rule entry has exactly one attribute:

       ipv="<u>ipv4</u>|<u>ipv6</u>|<u>eb</u>"
           The IP family where the passthrough rule will be added. This can be either <u>ipv4</u>, <u>ipv6</u> or <u>eb</u>.

       The <u>args</u> can be any arguments of iptables or ip6tables.

       The passthrough rule will be added to the chain directly. There is no mechanism like for the direct <b>rule</b>
       above. The user of the passthrough rule has to make sure that there will be no conflict with the rules
       created by firewalld.

</pre><h4><b>CAVEATS</b></h4><pre>
       Depending on the value of <u>FirewallBackend</u> (see <b><a href="../man5/firewalld.conf.5.html">firewalld.conf</a></b>(5)) direct rules behave differently in some
       scenarios.

   <b>Packet</b> <b>accept/drop</b> <b>precedence</b>
       Due to implementation details of netfilter inside the kernel, if <u>FirewallBackend=nftables</u> is used direct
       rules that <u>ACCEPT</u> packets don't actually cause the packets to be immediately accepted by the system.
       Those packets are still be subject to firewalld's nftables ruleset. This basically means there are two
       independent firewalls and packets must be accepted by both (iptables and nftables). As an aside, this
       scenario also occurs inside of nftables (again due to netfilter) if there are multiple chains attached to
       the same hook - it's not as simple as iptables vs nftables.

       There are a handful of options to workaround the <u>ACCEPT</u> issue:

        1. Rich Rules

           If a rich rule can be used, then they should always be preferred over direct rules. Rich Rules will
           be converted to the enabled <u>FirewallBackend</u>. See <b><a href="../man5/firewalld.richlanguage.5.html">firewalld.richlanguage</a></b>(5).

        2. Blanket Accept

           Users can add an explicit accept to the nftables ruleset. This can be done by adding the interface or
           source to the <u>trusted</u> zone.

           This strategy is often employed by things that perform their own filtering such as: libvirt, podman,
           docker.

           <b>Warning</b>: This means firewalld will do no filtering on these packets. It must all be done via direct
           rules or out-of-band iptables rules.

        3. Selective Accept

           Alternatively, enable only the relevant service, port, address, or otherwise in the appropriate zone.

        4. Revert to the iptables backend

           A last resort is to revert to the iptables backend by setting <u>FirewallBackend=iptables</u>. Users should
           be aware that firewalld development focuses on the nftables backend.

       For direct rules that <u>DROP</u> packets the packets are immediately dropped regardless of the value of
       <u>FirewallBackend</u>. As such, there is no special consideration needed.

       Firewalld guarantees the above ACCEPT/DROP behavior by registering nftables hooks with a lower precedence
       than iptables hooks.

   <b>Direct</b> <b>interface</b> <b>precedence</b>
       With <u>FirewallBackend=iptables</u> firewalld's top-level internal rules apply before direct rules are
       executed. This includes rules to accept existing connections. In the past this has surprised users. As an
       example, if a user adds a direct rule to drop traffic on destination port 22 existing SSH sessions would
       continue to function, but new connections would be denied.

       With <u>FirewallBackend=nftables</u> direct rules were deliberately given a higher precedence than all other
       firewalld rules. This includes rules to accept existing connections.

</pre><h4><b>EXAMPLE</b></h4><pre>
       Denylisting of the networks 192.168.1.0/24 and 192.168.5.0/24 with logging and dropping early in the raw
       table:

           &lt;?xml version="1.0" encoding="utf-8"?&gt;
           &lt;direct&gt;
             &lt;chain ipv="ipv4" table="raw" chain="denylist"/&gt;
             &lt;rule ipv="ipv4" table="raw" chain="PREROUTING" priority="0"&gt;-s 192.168.1.0/24 -j denylist&lt;/rule&gt;
             &lt;rule ipv="ipv4" table="raw" chain="PREROUTING" priority="1"&gt;-s 192.168.5.0/24 -j denylist&lt;/rule&gt;
             &lt;rule ipv="ipv4" table="raw" chain="denylist" priority="0"&gt;-m limit --limit 1/min -j LOG --log-prefix "denylisted: "&lt;/rule&gt;
             &lt;rule ipv="ipv4" table="raw" chain="denylist" priority="1"&gt;-j DROP&lt;/rule&gt;
           &lt;/direct&gt;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/firewall-applet.1.html">firewall-applet</a></b>(1), <b><a href="../man1/firewalld.1.html">firewalld</a></b>(1), <b><a href="../man1/firewall-cmd.1.html">firewall-cmd</a></b>(1), <b><a href="../man1/firewall-config.1.html">firewall-config</a></b>(1), <b><a href="../man5/firewalld.conf.5.html">firewalld.conf</a></b>(5),
       <b><a href="../man5/firewalld.direct.5.html">firewalld.direct</a></b>(5), <b><a href="../man5/firewalld.dbus.5.html">firewalld.dbus</a></b>(5), <b><a href="../man5/firewalld.icmptype.5.html">firewalld.icmptype</a></b>(5), <b><a href="../man1/firewall-offline-cmd.1.html">firewall-offline-cmd</a></b>(1),
       <b><a href="../man5/firewalld.richlanguage.5.html">firewalld.richlanguage</a></b>(5), <b><a href="../man5/firewalld.service.5.html">firewalld.service</a></b>(5), <b><a href="../man5/firewalld.zone.5.html">firewalld.zone</a></b>(5), <b><a href="../man5/firewalld.zones.5.html">firewalld.zones</a></b>(5),
       <b><a href="../man5/firewalld.policy.5.html">firewalld.policy</a></b>(5), <b><a href="../man5/firewalld.policies.5.html">firewalld.policies</a></b>(5), <b><a href="../man5/firewalld.ipset.5.html">firewalld.ipset</a></b>(5), <b><a href="../man5/firewalld.helper.5.html">firewalld.helper</a></b>(5)

</pre><h4><b>NOTES</b></h4><pre>
       firewalld home page:
           <b><a href="http://firewalld.org">http://firewalld.org</a></b>

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>Thomas</b> <b>Woerner</b> &lt;<a href="mailto:twoerner@redhat.com">twoerner@redhat.com</a>&gt;
           Developer

       <b>Jiri</b> <b>Popelka</b> &lt;<a href="mailto:jpopelka@redhat.com">jpopelka@redhat.com</a>&gt;
           Developer

       <b>Eric</b> <b>Garver</b> &lt;<a href="mailto:eric@garver.life">eric@garver.life</a>&gt;
           Developer

firewalld 2.3.1                                                                              <u><a href="../man5/FIREWALLD.DIRECT.5.html">FIREWALLD.DIRECT</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>