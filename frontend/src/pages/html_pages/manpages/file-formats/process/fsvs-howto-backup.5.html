<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOWTO: Backup -</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/fsvs">fsvs_1.2.12-1build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       HOWTO: Backup -

       This document is a step-by-step explanation how to do backups using FSVS.  This document is a step-by-
       step explanation how to do backups using FSVS.

</pre><h4><b>Preparation</b></h4><pre>
       If you're going to back up your system, you have to decide what you want to have stored in your backup,
       and what should be left out.

       Depending on your system usage and environment you first have to decide:

       • Do you only want to backup your data in <a href="file:/home">/home</a>?

         • Less storage requirements
         • In case of hardware crash the OS must be set up again
       • Do you want to keep track of your configuration in <a href="file:/etc">/etc</a>?

         • Very small storage overhead
         • Not much use for backup/restore, but shows what has been changed
       • Or do you want to backup your whole installation, from / on?

         • Whole system versioned, restore is only a few commands
         • Much more storage space needed - typically you'd need at least a few GB free space.
       The  next few moments should be spent thinking about the storage space for the repository - will it be on
       the system harddisk, a secondary or an external harddisk, or even off-site?
       <b>Note:</b>
           If you just created a fresh repository, you probably should create the 'default' directory  structure
           for subversion - trunk, branches, tags; this layout might be useful for your backups.
            The URL you'd use in fsvs would go to trunk.
       Possibly  you'll  have  to take the available bandwidth into your considerations; a single home directory
       may be backed up on a 56k modem, but a complete system installation would likely need at least some  kind
       of DSL or LAN.
       <b>Note:</b>
           If  this is a production box with sparse, small changes, you could take the initial backup on a local
           harddisk, transfer the directory with some media to the target machine, and switch the URLs.
       A fair bit of time should go to a small investigation which file patterns and paths you <b>not</b> want to back-
       up.

       • Backup files like *.bak, *~, *.tmp, and similar
       • History files: .sh-history and similar in the home-directories
       • Cache directories: your favourite browser might store many MB of cached data in you home-directories
       • Virtual system directories, like <a href="file:/proc">/proc</a> and <a href="file:/sys">/sys</a>, /dev/shmfs.
</pre><h4><b>Telling</b> <b>FSVS</b> <b>what</b> <b>to</b> <b>do</b></h4><pre>
       Given $WC as the <u>working</u> <u>directory</u> - the base of the data you'd like backed up (/, <a href="file:/home">/home</a>), and $URL as  a
       valid subversion URL to your (already created) repository path.
       Independent of all these details the first steps look like these:
                cd $WC
                fsvs urls $URL

        Now you have to say what should be ignored - that'll differ depending on your needs/wishes.
                fsvs ignore './**~' './**.tmp' './**.bak'
                fsvs ignore .<a href="file:/proc/">/proc/</a> .<a href="file:/sys/">/sys/</a> .<a href="file:/tmp/">/tmp/</a>
                fsvs ignore .<a href="file:/var/tmp/">/var/tmp/</a> ./var/spool/lpd/
                fsvs ignore '.<a href="file:/var/log/">/var/log/</a>*.gz'
                fsvs ignore .<a href="file:/var/run/">/var/run/</a> <a href="file:/dev/pts/">/dev/pts/</a>
                fsvs ignore '.<a href="file:/etc/">/etc/</a>*.dpkg-dist' '.<a href="file:/etc/">/etc/</a>*.dpkg-new'
                fsvs ignore '.<a href="file:/etc/">/etc/</a>*.dpkg-old' '.<a href="file:/etc/">/etc/</a>*.dpkg-bak'

       <b>Note:</b>
           <a href="file:/var/run">/var/run</a>  is  for  transient  files; I've heard reports that <b>reverting</b> files there can cause problems
           with running programs.
            Similar for <a href="file:/dev/pts">/dev/pts</a> - if that's a devpts filesystem, you'll run into problems on <b>update</b> or <b>revert</b> -
           as FSVS won't be allowed to create entries in this directory.
       Now you may find that you'd like to have some files encrypted in your backup - like <a href="file:/etc/shadow">/etc/shadow</a>, or  your
       .ssh/id_* files. So you tell fsvs to en/decrypt these files:
                fsvs propset fsvs:commit-pipe 'gpg -er {your backup key}' <a href="file:/etc/shadow">/etc/shadow</a> <a href="file:/etc/gshadow">/etc/gshadow</a>
                fsvs propset fsvs:update-pipe 'gpg -d' <a href="file:/etc/shadow">/etc/shadow</a> <a href="file:/etc/gshadow">/etc/gshadow</a>

       <b>Note:</b>
           This  are  just  examples.  You'll  probably  have to exclude some other paths and patterns from your
           backup, and mark some others as to-be-filtered.
</pre><h4><b>The</b> <b>first</b> <b>backup</b></h4><pre>
               fsvs commit -m 'First commit.'
        That's all there is to it!
</pre><h4><b>Further</b> <b>use</b> <b>and</b> <b>maintenance</b></h4><pre>
       The further usage is more or less the commit command from the last section.
        When do you have to do some manual work?

       • When ignore patterns change.

         • New filesystems that should be ignored, or would be ignored but shouldn't
         • You find that your favorite word-processor leaves many *.segv files behind, and similar things
       • If you get an error message from fsvs, check the arguments and  retry.  In  desperate  cases  (or  just
         because it's quicker than debugging yourself) ask on dev [at] fsvs.tigris.org.
</pre><h4><b>Restoration</b> <b>in</b> <b>a</b> <b>working</b> <b>system</b></h4><pre>
       Depending on the circumstances you can take different ways to restore data from your repository.

       •
          'fsvs export' allows you to just dump some repository data into your filesystem - eg. into a temporary
         directory to sort things out.
       • Using 'fsvs revert' you can get older revisions of a given file, directory or directory tree inplace.

       • Or you can do a fresh checkout - set an URL in an (empty) directory, and update to the needed revision.
       • If  everything  else  fails  (no  backup  media  with fsvs on it), you can use subversion commands (eg.
         export) to restore needed parts, and update the rest with fsvs.
</pre><h4><b>Recovery</b> <b>for</b> <b>a</b> <b>non-booting</b> <b>system</b></h4><pre>
       In case of a real emergency, when your harddisks crashed or your filesystem was eaten and you have to re-
       partition or re-format, you should get your system working again by

       • booting from a knoppix or some other Live-CD (with FSVS on it),
       • partition/format as needed,
       • mount your harddisk partitions below eg. <a href="file:/mnt">/mnt</a>,
       • and then recovering by
             $ cd <a href="file:/mnt">/mnt</a>
               $ export FSVS_CONF=/etc/fsvs                    # if non-standard
               $ export FSVS_WAA=/var/spool/fsvs           # if non-standard
               $ fsvs checkout -o softroot=<a href="file:/mnt">/mnt</a>
       If somebody asks really nice I'd possibly even create  a  recovery  command  that  deduces  the  softroot
       parameter from the current working directory.
       For more information please take a look at <b>Using</b> <b>an</b> <b>alternate</b> <b>root</b> <b>directory</b>.
</pre><h4><b>Feedback</b></h4><pre>
       If  you've  got  any questions, ideas, wishes or other feedback, please tell us in the mailing list users
       [at] fsvs.tigris.org.
       Thank you!
</pre><h4><b>Author</b></h4><pre>
       Generated automatically by Doxygen for fsvs from the source code.

Version trunk:2424                                 11 Mar 2010                            <u>FSVS</u> <u>-</u> <u>Backup</u> <u><a href="../man5/HOWTO.5.html">HOWTO</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>