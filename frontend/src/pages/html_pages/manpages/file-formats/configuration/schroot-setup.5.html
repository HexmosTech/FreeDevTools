<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>schroot-setup - schroot chroot setup scripts</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/schroot">schroot_1.6.13-7build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       schroot-setup - schroot chroot setup scripts

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>schroot</b>   uses   scripts   to   set  up  and  then  clean  up  the  chroot  environment.   The  directory
       <u><b>/etc/schroot/setup.d</b></u> contains scripts run when a chroot is created and  destroyed.   Several  environment
       variables  are  set  while  the  scripts  are  being  run, which allows their behaviour to be customised,
       depending upon, for example, the type of chroot in use.

       The scripts are run in name order, like those run by <b><a href="../man8/init.8.html">init</a></b>(8), by using the same  style  of  execution  as
       <b><a href="../man8/run-parts.8.html">run-parts</a></b>(8).

       The setup scripts are all invoked with two options:

       1      The action to perform.

              When   a   session   is   first  started,  the  chroot  is  set  up  by  running  the  scripts  in
              /etc/schroot/setup.d with the ‘setup-start’ option.  When the session is  ended,  the  scripts  in
              <u>/etc/schroot/setup.d</u> are run in reverse order with the ‘setup-stop’ option.

       2      The chroot status.

              This  is  either  ‘ok’  if there are no problems, or ‘fail’ if something went wrong.  For example,
              particular actions may be skipped on failure.

       Note that the scripts should be <u>idempotent</u>.  They <b>must</b>  be  idempotent  during  the  ‘setup-stop’  phase,
       because they may be run more than once, for example on failure.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
   <b>General</b> <b>variables</b>
       AUTH_USER
              The username of the user the command in the chroot will run as.

       CHROOT_NAME
              The  chroot  name.  Note that this is the name of the original chroot before session creation; you
              probably want SESSION_ID.

       LIBEXEC_DIR
              The directory under which helper programs are located.

       MOUNT_DIR
              The directory under  which  non-filesystem  chroots  are  mounted  (e.g.  block  devices  and  LVM
              snapshots).

       PID    The process ID of the schroot process.

       PLATFORM
              The  operating  system  platform schroot is running upon.  This may be used to introduce platform-
              specific behaviour into the setup scripts where  required.   Note  that  the  HOST  variables  are
              probably  what  are  required.   In  the  context  of  schroot,  the  platform  is  the  supported
              configuration and behaviour for a given architecture,  and  may  be  identical  between  different
              architectures.

       SESSION_ID
              The session identifier.

       VERBOSE
              Set to ‘quiet’ if only error messages should be printed, ‘normal’ if other messages may be printed
              as well, and ‘verbose’ if all messages may be printed.  Previously called AUTH_VERBOSITY.

       CHROOT_SESSION_CREATE
              Set to ‘true’ if a session will be created, otherwise ‘false’.

       CHROOT_SESSION_CLONE
              Set to ‘true’ if a session will be cloned, otherwise ‘false’.

       CHROOT_SESSION_PURGE
              Set to ‘true’ if a session will be purged, otherwise ‘false’.

       CHROOT_SESSION_SOURCE
              Set to ‘true’ if a session will be created from a source chroot, otherwise ‘false’.

       CHROOT_TYPE
              The type of the chroot.  This is useful for restricting a setup task to particular types of chroot
              (e.g. only block devices or LVM snapshots).

       CHROOT_NAME
              The  name  of  the chroot.  This is useful for restricting a setup task to a particular chroot, or
              set of chroots.

       CHROOT_ALIAS
              The name of the alias used to select the chroot.  This is useful for  specialising  a  setup  task
              based  upon one of its alternative alias names, or the default chroot name.  For example, it could
              be used to specify additional sources in <u><a href="file:/etc/apt/sources.list">/etc/apt/sources.list</a></u>, such as  a  stable-security  alias
              for a stable chroot, or an experimental alias for an unstable chroot.

       CHROOT_DESCRIPTION
              The description of the chroot.

       CHROOT_MOUNT_LOCATION
              The location to mount the chroot.  It is used for mount point creation and mounting.

       CHROOT_LOCATION
              The  location of the chroot inside the mount point.  This is to allow multiple chroots on a single
              filesystem.  Set for all mountable chroot types.

       CHROOT_PATH
              The absolute path to the chroot.  This  is  typically  CHROOT_MOUNT_LOCATION  and  CHROOT_LOCATION
              concatenated together.  This is the path which should be used to access the chroots.

   <b>Plain</b> <b>and</b> <b>directory</b> <b>chroot</b> <b>variables</b>
       These chroot types use only general variables.

   <b>File</b> <b>variables</b>
       CHROOT_FILE
              The file containing the chroot files.

       CHROOT_FILE_REPACK
              Set to ‘true’ to repack the chroot into an archive file on ending a session, otherwise ‘false’.

   <b>Mountable</b> <b>chroot</b> <b>variables</b>
       These variables are only set for directly mountable chroot types.

       CHROOT_MOUNT_DEVICE
              The device to mount containing the chroot.

       CHROOT_MOUNT_OPTIONS
              Options to pass to <b><a href="../man8/mount.8.html">mount</a></b>(8).

       CHROOT_LOCATION
              The  location of the chroot inside the mount point.  This allows the existence of multiple chroots
              on a single filesystem.

   <b>Filesystem</b> <b>union</b> <b>variables</b>
       CHROOT_UNION_TYPE
              Union filesystem type.

       CHROOT_UNION_MOUNT_OPTIONS
              Union filesystem mount options.

       CHROOT_UNION_OVERLAY_DIRECTORY
              Union filesystem overlay directory (writable).

       CHROOT_UNION_UNDERLAY_DIRECTORY
              Union filesystem underlay directory (read-only).

   <b>Block</b> <b>device</b> <b>variables</b>
       CHROOT_DEVICE
              The device containing the chroot root filesystem.  This  is  usually,  but  not  necessarily,  the
              device  which  will be mounted.  For example, for a LVM snapshot this will be the original logical
              volume.

   <b>LVM</b> <b>snapshot</b> <b>variables</b>
       CHROOT_LVM_SNAPSHOT_NAME
              Snapshot name to pass to <b><a href="../man8/lvcreate.8.html">lvcreate</a></b>(8).

       CHROOT_LVM_SNAPSHOT_DEVICE
              The name of the LVM snapshot device.

       CHROOT_LVM_SNAPSHOT_OPTIONS
              Options to pass to <b><a href="../man8/lvcreate.8.html">lvcreate</a></b>(8).

   <b>Custom</b> <b>variables</b>
       Custom keys set in  <u>schroot.conf</u>  will  be  uppercased  and  set  in  the  environment  as  described  in
       <b><a href="../man5/schroot.conf.5.html">schroot.conf</a></b>(5).

</pre><h4><b>FILES</b></h4><pre>
   <b>Setup</b> <b>script</b> <b>configuration</b>
       The directory <u><b>/etc/schroot/default</b></u> contains the default settings used by setup scripts.

       <u><b>config</b></u> Main  configuration  file  read  by  setup  scripts.   The  format  of  this  file is described in
              <b><a href="../man5/schroot-script-config.5.html">schroot-script-config</a></b>(5).  This is the default value for the <u>script-config</u> key.   Note  that  this
              was formerly named <u>/etc/schroot/script-defaults</u>.  The following files are referenced by default:

       <u><b>copyfiles</b></u>
              A  list  of files to copy into the chroot from the host system.  Note that this was formerly named
              <u>/etc/schroot/copyfiles-defaults</u>.

       <u><b>fstab</b></u>  A file in the format described in <b><a href="../man5/fstab.5.html">fstab</a></b>(5), used to mount  filesystems  inside  the  chroot.   The
              mount  location  is  relative  to  the  root  of  the  chroot.   Note that this was formerly named
              <u>/etc/schroot/mount-defaults</u>.

       <u><b>nssdatabases</b></u>
              System databases (as described in <u><a href="file:/etc/nsswitch.conf">/etc/nsswitch.conf</a></u> on GNU/Linux systems) to copy into the chroot
              from the host.  Note that this was formerly named <u>/etc/schroot/nssdatabases-defaults</u>.

   <b>Setup</b> <b>scripts</b>
       The directory <u><b>/etc/schroot/setup.d</b></u> contains the chroot setup scripts.

       <u><b>00check</b></u>
              Print debugging diagnostics and perform basic sanity checking.

       <u><b>05file</b></u> Unpack, clean up, and repack file-based chroots.

       <u><b>05fsunion</b></u>
              Create and remove union filesystems.

       <u><b>05lvm</b></u>  Create and remove LVM snapshots.

       <u><b>10mount</b></u>
              Mount and unmount filesystems.

       <u><b>15binfmt</b></u>
              Sets up the QEMU user emulator using binfmt-support.  This permits a chroot for  a  different  CPU
              architecture  to  be  used  transparently,  providing  an alternative to cross-compiling or whole-
              machine emulation.

       <u><b>15killprocs</b></u>
              Kill processes still running inside  the  chroot  when  ending  a  session,  which  would  prevent
              unmounting of filesystems and cleanup of any other resources.

       <u><b>20copyfiles</b></u>
              Copy  files  from  the  host  system  into  the chroot.  Configure networking by copying <u>hosts</u> and
              <u>resolv.conf</u>, for example.

       <u><b>20nssdatabases</b></u>
              Configure system databases by copying passwd, shadow, group etc. into the chroot.

       <u><b>50chrootname</b></u>
              Set the chroot name (<u>/etc/debian_chroot</u>) in the chroot.  This may be used by the shell  prompt  to
              display the current chroot.

</pre><h4><b>AUTHORS</b></h4><pre>
       Roger Leigh.

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright © 2005-2012  Roger Leigh &lt;<a href="mailto:rleigh@codelibre.net">rleigh@codelibre.net</a>&gt;

       <b>schroot</b>  is  free  software:  you can redistribute it and/or modify it under the terms of the GNU General
       Public License as published by the Free Software Foundation, either version 3 of the License, or (at your
       option) any later version.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/schroot.1.html">schroot</a></b>(1), <b><a href="../man5/fstab.5.html">fstab</a></b>(5), <b><a href="../man5/schroot.conf.5.html">schroot.conf</a></b>(5), <b><a href="../man5/schroot-script-config.5.html">schroot-script-config</a></b>(5), <b><a href="../man8/run-parts.8.html">run-parts</a></b>(8).

Version 1.6.13                                     14 Aug 2022                                  <u><a href="../man5/SCHROOT-SETUP.5.html">SCHROOT-SETUP</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>