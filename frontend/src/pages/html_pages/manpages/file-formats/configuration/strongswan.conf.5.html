<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>strongswan.conf - strongSwan configuration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libstrongswan">libstrongswan_6.0.1-6ubuntu4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       strongswan.conf - strongSwan configuration file

</pre><h4><b>DESCRIPTION</b></h4><pre>
       While  the  <u><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></u>(5)  configuration  file  is  well  suited  to  define  IPsec related configuration
       parameters, it is not useful for other strongSwan applications to read options from this file.  The  file
       is  hard  to  parse  and  only  <u>ipsec</u>  <u>starter</u> is capable of doing so. As the number of components of the
       strongSwan project is continually growing, a more flexible configuration file was  needed,  one  that  is
       easy to extend and can be used by all components. With strongSwan 4.2.1 <u><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></u>(5) was introduced
       which meets these requirements.

</pre><h4><b>SYNTAX</b></h4><pre>
       The format of the strongswan.conf file consists of hierarchical <b>sections</b> and a list of <b>key/value</b> <b>pairs</b> in
       each section. Each section has a name, followed by C-Style curly brackets defining the section body. Each
       section body contains a set of subsections and key/value pairs:

            settings := (section|keyvalue)*
            section  := name { settings }
            keyvalue := key = value\n

       Values must be terminated by a newline.

       Comments are possible using the <b>#</b>-character.

       Section names and keys may contain any printable character except:

            . , : { } = " # \n \t space

       An example file in this format might look like this:

            a = b
            section-one {
                 somevalue = asdf
                 subsection {
                      othervalue = xxx
                 }
                 # yei, a comment
                 yetanother = zz
            }
            section-two {
                 x = 12
            }

       Indentation is optional, you may use tabs or spaces.

</pre><h4><b>NUMBER</b> <b>FORMATS</b></h4><pre>
       Options  that  define  an  integer  value  can be specified as decimal (the default) or hexadecimal ("0x"
       prefix, upper- or  lowercase  letters  are  accepted).   Locale-dependent  strings  (e.g.  the  thousands
       separator of the current locale) may also be accepted in locales other than "C".

       Options that define a floating-point value can be specified as decimal (the default) or hexadecimal ("0x"
       prefix,  upper-  or  lowercase  letters are accepted).  The radix character (decimal separator) in either
       case is locale-dependent, usually ".".

</pre><h4><b>TIME</b> <b>FORMATS</b></h4><pre>
       Unless stated otherwise, options that define a time are specified in seconds.  The "s", "m", "h" and  "d"
       suffixes  may  be  used  to  automatically  convert  values given in seconds, minutes, hours or days (for
       instance, instead of configuring a rekey time of 4 hours as "14400" seconds, "4h" may be used).

       There are some global options that don't accept these suffixes as they are configured as  integer  values
       in  seconds or milliseconds, or even as floating-point numbers (e.g. the retransmission timeout). Options
       that accept the suffixes have a corresponding default value.

</pre><h4><b>REFERENCING</b> <b>OTHER</b> <b>SECTIONS</b></h4><pre>
       It is possible to inherit settings and sections from another section. This feature is  mainly  useful  in
       swanctl.conf (which uses the same file format).  The syntax is as follows:

            section    := name : references { settings }
            references := absname[, absname]*
            absname    := name[.name]*

       All  key/value pairs and all subsections of the referenced sections will be inherited by the section that
       references them via their absolute name. Values may be overridden in the  section  or  any  of  its  sub-
       sections  (use  an  empty  assignment  to  clear a value so its default value, if any, will apply). It is
       currently not possible to limit the inclusion level or clear/remove inherited sub-sections.

       If the order is important (e.g. for auth rounds in a connection, if <u>round</u> is  not  used),  it  should  be
       noted  that  inherited  settings/sections  will  follow those defined in the current section (if multiple
       sections are referenced, their settings are enumerated left to right).

       References are evaluated dynamically at runtime, so referring to sections later in  the  config  file  or
       included via other files is no problem.

       Here is an example of how this might look like:

            conn-defaults {
                 # default settings for all conns (e.g. a cert, or IP pools)
            }
            eap-defaults {
                 # defaults if eap is used (e.g. a remote auth round)
            }
            child-defaults {
                 # defaults for child configs (e.g. traffic selectors)
            }
            connections {
                 conn-a : conn-defaults, eap-defaults {
                      # set/override stuff specific to this connection
                      children {
                           child-a : child-defaults {
                                # set/override stuff specific to this child
                           }
                      }
                 }
                 conn-b : conn-defaults {
                      # set/override stuff specific to this connection
                      children {
                           child-b : child-defaults {
                                # set/override stuff specific to this child
                           }
                      }
                 }
                 conn-c : connections.conn-a {
                      # everything is inherited, including everything conn-a
                      # already inherits from the sections it and its
                      # sub-section reference
                 }
            }

</pre><h4><b>INCLUDING</b> <b>FILES</b></h4><pre>
       Using the <b>include</b> statement it is possible to include other files into strongswan.conf, e.g.

            include /some/path/*.conf

       If  the  file  name is not an absolute path, it is considered to be relative to the directory of the file
       containing the include statement. The file name may include shell  wildcards  (see  <u><a href="../man1/sh.1.html">sh</a></u>(1)).   Also,  such
       inclusions can be nested.

       Sections  loaded  from  included  files  <u>extend</u>  previously  loaded sections; already existing values are
       <u>replaced</u>.  It is important to note that settings are added relative to the section the include  statement
       is in.

       As an example, the following three files result in the same final config as the one given above:

            a = b
            section-one {
                 somevalue = before include
                 include include.conf
            }
            include other.conf

       include.conf:
            # settings loaded from this file are added to section-one
            # the following replaces the previous value
            somevalue = asdf
            subsection {
                 othervalue = yyy
            }
            yetanother = zz

       other.conf:
            # this extends section-one and subsection
            section-one {
                 subsection {
                      # this replaces the previous value
                      othervalue = xxx
                 }
            }
            section-two {
                 x = 12
            }

</pre><h4><b>READING</b> <b>VALUES</b></h4><pre>
       Values  are  accessed using a dot-separated section list and a key.  With reference to the example above,
       accessing <b>section-one.subsection.othervalue</b> will return <b>xxx</b>.

</pre><h4><b>DEFINED</b> <b>KEYS</b></h4><pre>
       The following keys are currently defined (using dot notation). The default value (if any)  is  listed  in
       brackets after the key.

       <b>aikgen.load</b> []
              Plugins to load in ipsec aikgen tool.

       <b>attest.database</b> []
              File  measurement  information  database  URI.  If it contains a password, make sure to adjust the
              permissions of the config file accordingly.

       <b>attest.load</b> []
              Plugins to load in ipsec attest tool.

       <b>charon</b>
              Options for the charon IKE daemon.

              <b>Note</b>: Many of the options in this section also apply to <b>charon-cmd</b> and other  <b>charon</b>  derivatives.
              Just  use  their  respective name (e.g.  <b>charon-cmd</b> instead of <b>charon</b>).  For many options defaults
              can be defined in the <b>libstrongswan</b> section.

       <b>charon.accept_private_algs</b> [no]
              Deliberately violate the IKE standard's  requirement  and  allow  the  use  of  private  algorithm
              identifiers, even if the peer implementation is unknown.

       <b>charon.accept_unencrypted_mainmode_messages</b> [no]
              Accept unencrypted ID and HASH payloads in IKEv1 Main Mode.

              Some  implementations  send the third Main Mode message unencrypted, probably to find the PSKs for
              the specified ID for authentication. This is very similar to Aggressive Mode,  and  has  the  same
              security  implications:  A  passive  attacker  can  sniff the negotiated Identity, and start brute
              forcing the PSK using the HASH payload.

              It is recommended to keep this option to no, unless you know exactly what the implications are and
              require compatibility to such devices (for example, some SonicWall boxes).

       <b>charon.block_threshold</b> [5]
              Maximum number of half-open IKE_SAs (including unprocessed IKE_SA_INITs) for a single peer IP.

       <b>charon.cache_crls</b> [no]
              Whether Certificate Revocation Lists (CRLs) fetched via HTTP or  LDAP  should  be  saved  under  a
              unique   file   name  derived  from  the  public  key  of  the  Certification  Authority  (CA)  to
              <b>${sysconfdir}/ipsec.d/crls</b> (stroke) or <b>${sysconfdir}/swanctl/x509crl</b> (vici), respectively.

       <b>charon.cert_cache</b> [yes]
              Whether relations in validated certificate chains should be cached in memory.

       <b>charon.check_current_path</b> [no]
              By default, after detecting any changes to interfaces and/or addresses no action is taken  if  the
              current  path to the remote peer still looks usable. Enabling this option will use DPD to check if
              the path actually still works, or, for instance, the peer removed the state after a  longer  phase
              without  connectivity.   It  will also trigger a MOBIKE update if NAT mappings were removed during
              the downtime.

       <b>charon.cisco_flexvpn</b> [no]
              Send the Cisco FlexVPN vendor ID payload, which is required in order to make Cisco  brand  devices
              allow  negotiating  a  local  traffic  selector  (from strongSwan's point of view) that is not the
              assigned virtual IP address if such an address is requested by    strongSwan.  Sending  the  Cisco
              FlexVPN  vendor  ID  prevents  the  peer from narrowing the initiator's local traffic selector and
              allows it to e.g. negotiate a TS of 0.0.0.0/0 == 0.0.0.0/0 instead.  This has been tested  with  a
              "tunnel mode ipsec ipv4" Cisco template but should also work for GRE encapsulation.

       <b>charon.cisco_unity</b> [no]
              Send Cisco Unity vendor ID payload (IKEv1 only).

       <b>charon.close_ike_on_child_failure</b> [no]
              Close the IKE_SA if setup of the CHILD_SA along with IKE_AUTH failed.

       <b>charon.cookie_threshold</b> [30]
              Number  of  half-open  IKE_SAs  (including  unprocessed  IKE_SA_INITs)  that  activate  the cookie
              mechanism.

       <b>charon.cookie_threshold_ip</b> [3]
              Number of half-open IKE_SAs (including  unprocessed  IKE_SA_INITs)  for  a  single  peer  IP  that
              activate the cookie  mechanism.

       <b>charon.crypto_test.bench</b> [no]
              Benchmark crypto algorithms and order them by efficiency.

       <b>charon.crypto_test.bench_size</b> [1024]
              Buffer size used for crypto benchmark.

       <b>charon.crypto_test.bench_time</b> [50]
              Time in ms during which crypto algorithm performance is measured.

       <b>charon.crypto_test.on_add</b> [no]
              Test  crypto  algorithms  during  registration (requires test vectors provided by the <u>test-vectors</u>
              plugin).

       <b>charon.crypto_test.on_create</b> [no]
              Test crypto algorithms on each crypto primitive instantiation.

       <b>charon.crypto_test.required</b> [no]
              Strictly require at least one test vector to enable an algorithm.

       <b>charon.crypto_test.rng_true</b> [no]
              Whether to test RNG with TRUE quality; requires a lot of entropy.

       <b>charon.delete_rekeyed</b> [no]
              Delete CHILD_SAs right after they got successfully rekeyed (IKEv1 only).  Reduces  the  number  of
              stale  CHILD_SAs  in  scenarios  with  a lot of rekeyings. However, this might cause problems with
              implementations that continue to use rekeyed SAs until they expire.

       <b>charon.delete_rekeyed_delay</b> [5]
              Delay in seconds until inbound IPsec SAs are deleted after  rekeyings  (IKEv2  only).  To  process
              delayed  packets  the  inbound part of a CHILD_SA is kept installed up to the configured number of
              seconds after it got replaced during a rekeying. If set to 0 the CHILD_SA will be  kept  installed
              until it expires (if no lifetime is set it will be destroyed immediately).

       <b>charon.dh_exponent_ansi_x9_42</b> [yes]
              Use ANSI X9.42 DH exponent size or optimum size matched to cryptographic strength.

       <b>charon.dlopen_use_rtld_now</b> [no]
              Use RTLD_NOW with dlopen when loading plugins and IMV/IMCs to reveal missing symbols immediately.

       <b>charon.dns1</b> []
              DNS server assigned to peer via configuration payload (CP).

       <b>charon.dns2</b> []
              DNS server assigned to peer via configuration payload (CP).

       <b>charon.dos_protection</b> [yes]
              Enable Denial of Service protection using cookies and aggressiveness checks.

       <b>charon.filelog</b>
              Section to define file loggers, see LOGGER CONFIGURATION in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

       <b>charon.filelog.&lt;name&gt;</b>
              &lt;name&gt;  may  be  the full path to the log file if it only contains characters permitted in section
              names. Is ignored if <u>path</u> is specified.

       <b>charon.filelog.&lt;name&gt;.&lt;subsystem&gt;</b> [&lt;default&gt;]
              Loglevel for a specific subsystem.

       <b>charon.filelog.&lt;name&gt;.append</b> [yes]
              If this option is enabled log entries are appended to the existing file.

       <b>charon.filelog.&lt;name&gt;.default</b> [1]
              Specifies the default loglevel to be used  for  subsystems  for  which  no  specific  loglevel  is
              defined.

       <b>charon.filelog.&lt;name&gt;.flush_line</b> [no]
              Enabling this option disables block buffering and enables line buffering.

       <b>charon.filelog.&lt;name&gt;.ike_name</b> [no]
              Add the connection name and a unique numerical identifier for the current IKE_SA to each log entry
              if available.

       <b>charon.filelog.&lt;name&gt;.json</b> [no]
              Enables  writing  each  log  entry  as  a  JSON  object to the file. The properties are "time" (if
              `time_format` is set),  "thread",  "group",  "level"  and  "msg".   Newlines,  double  quotes  and
              backslashes are escaped in the latter. If `ike_name` is enabled, "ikesa-uniqueid" and "ikesa-name"
              are added to the object if available. The `log_level` option does not apply if this is enabled.

       <b>charon.filelog.&lt;name&gt;.log_level</b> [no]
              Add the log level of each message after the subsystem (e.g. [IKE2]).

       <b>charon.filelog.&lt;name&gt;.path</b> []
              Optional  path  to  the  log  file.  Overrides the section name. Must be used if the path contains
              characters that aren't allowed in section names.

       <b>charon.filelog.&lt;name&gt;.time_format</b> []
              Prefix each log entry with  a  timestamp.  The  option  accepts  a  format  string  as  passed  to
              <b><a href="../man3/strftime.3.html">strftime</a></b>(3).

       <b>charon.filelog.&lt;name&gt;.time_precision</b> []
              Add  the  milliseconds  (<u>ms</u>)  or  microseconds  (<u>us</u>) within the current second after the timestamp
              (separated by a dot, so <u>time_format</u> should end with %S or %T). By default, nothing is added.

       <b>charon.flush_auth_cfg</b> [no]
              If enabled objects used during authentication (certificates, identities  etc.)   are  released  to
              free  memory  once  an IKE_SA is established. Enabling this might conflict with plugins that later
              need access to e.g. the used certificates.

       <b>charon.follow_redirects</b> [yes]
              Whether to follow IKEv2 redirects (RFC 5685).

       <b>charon.force_eap_only_authentication</b> [no]
              Violate  RFC  5998  and  use  EAP-only  authentication  even  if  the  peer  did   not   send   an
              EAP_ONLY_AUTHENTICATION notify during IKE_AUTH.

       <b>charon.fragment_size</b> [1280]
              Maximum  size  (complete  IP datagram size in bytes) of a sent IKE fragment when using proprietary
              IKEv1 or standardized IKEv2 fragmentation, defaults to 1280 (use 0  for  address  family  specific
              default  values,  which  uses  a lower value for IPv4).  Unless overridden, this limit is used for
              both IPv4 and IPv6 if specified.

       <b>charon.fragment_size_v4</b> [charon.fragment_size]
              Maximum size (complete IPv4 datagram size in bytes) of a sent IKE fragment when using  proprietary
              IKEv1 or standardized IKEv2 fragmentation.

       <b>charon.fragment_size_v6</b> [charon.fragment_size]
              Maximum  size (complete IPv6 datagram size in bytes) of a sent IKE fragment when using proprietary
              IKEv1 or standardized IKEv2 fragmentation.

       <b>charon.group</b> []
              Name of the group the daemon changes to after startup.

       <b>charon.half_open_timeout</b> [30]
              Timeout in seconds for connecting IKE_SAs (also see IKE_SA_INIT DROPPING).

       <b>charon.hash_and_url</b> [no]
              Enable hash and URL support.

       <b>charon.host_resolver.max_threads</b> [3]
              Maximum number of concurrent resolver threads (they are terminated if unused).

       <b>charon.host_resolver.min_threads</b> [0]
              Minimum number of resolver threads to keep around.

       <b>charon.i_dont_care_about_security_and_use_aggressive_mode_psk</b> [no]
              If enabled responders are allowed to use IKEv1 Aggressive Mode  with  pre-shared  keys,  which  is
              discouraged due to security concerns (offline attacks on the openly transmitted hash of the PSK).

       <b>charon.ignore_acquire_ts</b> [no]
              If this is disabled the traffic selectors from the kernel's acquire events, which are derived from
              the  triggering  packet,  are  prepended to the traffic selectors from the configuration for IKEv2
              connection. By enabling this, such specific traffic selectors will be ignored and only the ones in
              the config will be sent. This always happens for IKEv1 connections as the protocol  only  supports
              one set of traffic selectors per CHILD_SA.

       <b>charon.ignore_routing_tables</b> []
              A space-separated list of routing tables to be excluded from route lookups.

       <b>charon.ikesa_limit</b> [0]
              Maximum  number of IKE_SAs that can be established at the same time before new connection attempts
              are blocked.

       <b>charon.ikesa_table_segments</b> [1]
              Number of exclusively locked segments in the hash table.

       <b>charon.ikesa_table_size</b> [1]
              Size of the IKE_SA hash table.

       <b>charon.imcv</b>
              Defaults for options in this section can be configured in the <u>libimcv</u> section.

       <b>charon.imcv.assessment_result</b> [yes]
              Whether IMVs send a standard IETF Assessment Result attribute.

       <b>charon.imcv.database</b> []
              Global IMV policy database URI. If it contains a password, make sure to adjust the permissions  of
              the config file accordingly.

       <b>charon.imcv.os_info.default_password_enabled</b> [no]
              Manually set whether a default password is enabled

       <b>charon.imcv.os_info.name</b> []
              Manually set the name of the client OS (e.g. Ubuntu).

       <b>charon.imcv.os_info.version</b> []
              Manually set the version of the client OS (e.g. 12.04 i686).

       <b>charon.imcv.policy_script</b> [ipsec _imv_policy]
              Script called for each TNC connection to generate IMV policies.

       <b>charon.inactivity_close_ike</b> [no]
              Whether to close IKE_SA if the only CHILD_SA closed due to inactivity.

       <b>charon.init_limit_half_open</b> [0]
              Limit  new  connections based on the current number of half open IKE_SAs, see IKE_SA_INIT DROPPING
              in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

       <b>charon.init_limit_job_load</b> [0]
              Limit new connections based on the number of jobs currently queued for processing (see IKE_SA_INIT
              DROPPING).

       <b>charon.initiator_only</b> [no]
              Causes charon daemon to ignore IKE initiation requests.

       <b>charon.install_routes</b> [yes]
              Install routes into a separate routing table for established IPsec tunnels.

       <b>charon.install_virtual_ip</b> [yes]
              Install virtual IP addresses.

       <b>charon.install_virtual_ip_on</b> []
              The name of the interface on which virtual IP addresses should be installed. If not specified  the
              addresses will be installed on the outbound interface.

       <b>charon.integrity_test</b> [no]
              Check daemon, libstrongswan and plugin integrity at startup.

       <b>charon.interfaces_ignore</b> []
              A  comma-separated  list  of  network  interfaces  that  should  be  ignored, if <b>interfaces_use</b> is
              specified this option has no effect.

       <b>charon.interfaces_use</b> []
              A comma-separated list of network interfaces that should be used by charon. All  other  interfaces
              are ignored.

       <b>charon.keep_alive</b> [20s]
              NAT keep alive interval.

       <b>charon.keep_alive_dpd_margin</b> [0s]
              Number  of  seconds  the keep alive interval may be exceeded before a DPD is sent instead of a NAT
              keep alive (0 to disable).  This is only useful if a  clock  is  used  that  includes  time  spent
              suspended (e.g. CLOCK_BOOTTIME).

       <b>charon.leak_detective.detailed</b> [yes]
              Includes source file names and line numbers in leak detective output.

       <b>charon.leak_detective.usage_threshold</b> [10240]
              Threshold in bytes for allocations to be included in usage reports (0 to include all).

       <b>charon.leak_detective.usage_threshold_count</b> [0]
              Threshold  in  number of allocations for allocations to be included in usage reports (0 to include
              all).

       <b>charon.load</b> []
              Plugins to load in the IKE daemon charon.

       <b>charon.load_modular</b> [no]
              If  enabled,  the  list  of   plugins   to   load   is   determined   via   the   value   of   the
              <u>charon.plugins.&lt;name&gt;.load</u>  options.  In addition to a simple boolean flag that option may take an
              integer value indicating the priority of a plugin, which would influence the order of a plugin  in
              the  plugin  list  (the  default  is  1). If two plugins have the same priority their order in the
              default  plugin  list  is  preserved.  Enabled  plugins  not  found  in  that  list  are   ordered
              alphabetically before other plugins with the same priority.

       <b>charon.make_before_break</b> [yes]
              Initiate  IKEv2  reauthentication  with a make-before-break instead of a break-before-make scheme.
              Make-before-break uses overlapping IKE and CHILD_SA during reauthentication  by  first  recreating
              all  new  SAs  before deleting the old ones. This behavior can be beneficial to avoid connectivity
              gaps during reauthentication, but requires support for overlapping SAs by  the  peer.   strongSwan
              can handle such overlapping SAs since version 5.3.0.

       <b>charon.max_ikev1_exchanges</b> [3]
              Maximum number of IKEv1 phase 2 exchanges per IKE_SA to keep state about and track concurrently.

       <b>charon.max_packet</b> [10000]
              Maximum packet size accepted by charon.

       <b>charon.multiple_authentication</b> [yes]
              Enable multiple authentication exchanges (RFC 4739).

       <b>charon.nbns1</b> []
              WINS servers assigned to peer via configuration payload (CP).

       <b>charon.nbns2</b> []
              WINS servers assigned to peer via configuration payload (CP).

       <b>charon.ocsp_nonce_len</b> [32]
              Length  of nonces in OCSP requests. According to RFC 8954, valid values are between 1 and 32, with
              new clients required to use 32. Some servers might not support that so lowering the value to  e.g.
              16 might be necessary.

       <b>charon.plugins.addrblock.depth</b> [-1]
              RFC3779  requires  that all addrblocks claimed by a certificate must be contained in the addrblock
              extension of the issuer certificate, up to the root CA. The default depth setting of  -1  enforces
              this.

              In  practice, third party (root) CAs may not contain the extension, making the addrblock extension
              unusable under such CAs. By limiting  the  validation  depth,  only  a  certain  level  of  issuer
              certificates are validated for proper addrblock extensions: A depth of 0 does not check any issuer
              certificate  extensions,  a  depth  of  1  only the direct issuer of the end entity certificate is
              checkend, and so on.

       <b>charon.plugins.addrblock.strict</b> [yes]
              If set to yes, a subject certificate without an addrblock extension  is  rejected  if  the  issuer
              certificate has such an addrblock extension. If set to no, subject certificates issued without the
              addrblock  extension are accepted without any traffic selector checks and no policy is enforced by
              the plugin.

       <b>charon.plugins.android_log.loglevel</b> [1]
              Loglevel for logging to Android specific logger.

       <b>charon.plugins.attr</b>
              Section to specify arbitrary attributes that are assigned to  a  peer  via  configuration  payload
              (CP).

       <b>charon.plugins.attr.&lt;attr&gt;</b> []
              <b>&lt;attr&gt;</b>  can  be  either <u>address</u>, <u>netmask</u>, <u>dns</u>, <u>nbns</u>, <u>dhcp</u>, <u>subnet</u>, <u>split-include</u>, <u>split-exclude</u> or
              the numeric identifier of the attribute type. The assigned value can be an  IPv4/IPv6  address,  a
              subnet in CIDR notation or an arbitrary value depending on the attribute type.  For some attribute
              types multiple values may be specified as a comma separated list.

       <b>charon.plugins.attr-sql.crash_recovery</b> [yes]
              Release  all  online  leases  during  startup.   Disable this to share the DB between multiple VPN
              gateways.

       <b>charon.plugins.attr-sql.database</b> []
              Database URI for attr-sql plugin used by charon. If it contains a password, make  sure  to  adjust
              the permissions of the config file accordingly.

       <b>charon.plugins.attr-sql.lease_history</b> [yes]
              Enable logging of SQL IP pool leases.

       <b>charon.plugins.botan.internal_rng_only</b> [no]
              If  enabled,  only  Botan's  internal  RNG  will be used throughout the plugin.  Otherwise, and if
              supported by Botan, rng_t implementations provided by other loaded plugins will be used as RNG.

       <b>charon.plugins.bypass-lan.interfaces_ignore</b> []
              A comma-separated list of network interfaces for which connected subnets  should  be  ignored,  if
              <b>interfaces_use</b> is specified this option has no effect.

       <b>charon.plugins.bypass-lan.interfaces_use</b> []
              A comma-separated list of network interfaces for which connected subnets should be considered. All
              other interfaces are ignored.

       <b>charon.plugins.certexpire.csv.cron</b> []
              Cron style string specifying CSV export times.

       <b>charon.plugins.certexpire.csv.empty_string</b> []
              String to use in empty intermediate CA fields.

       <b>charon.plugins.certexpire.csv.fixed_fields</b> [yes]
              Use a fixed intermediate CA field count.

       <b>charon.plugins.certexpire.csv.force</b> [yes]
              Force export of all trustchains we have a private key for.

       <b>charon.plugins.certexpire.csv.format</b> [%d:%m:%Y]
              <b><a href="../man3/strftime.3.html">strftime</a></b>(3) format string to export expiration dates as.

       <b>charon.plugins.certexpire.csv.local</b> []
              <b><a href="../man3/strftime.3.html">strftime</a></b>(3) format string for the CSV file name to export local certificates to.

       <b>charon.plugins.certexpire.csv.remote</b> []
              <b><a href="../man3/strftime.3.html">strftime</a></b>(3) format string for the CSV file name to export remote certificates to.

       <b>charon.plugins.certexpire.csv.separator</b> [,]
              CSV field separator.

       <b>charon.plugins.coupling.file</b> []
              File to store coupling list to.

       <b>charon.plugins.coupling.hash</b> [sha1]
              Hashing algorithm to fingerprint coupled certificates.

       <b>charon.plugins.coupling.max</b> [1]
              Maximum number of coupling entries to create.

       <b>charon.plugins.curl.redir</b> [-1]
              Maximum  number  of redirects followed by the plugin, set to 0 to disable following redirects, set
              to -1 for no limit.

       <b>charon.plugins.curl.tls_backend</b> []
              The SSL/TLS backend to configure in curl if multiple  are  available  (requires  libcurl  7.56  or
              newer).  A list of available options is logged on level 2 if nothing is configured. Similar but on
              level 1 if the selected backend isn't available.

       <b>charon.plugins.dhcp.force_server_address</b> [no]
              Always use the configured server address. This might be helpful if the DHCP  server  runs  on  the
              same  host  as strongSwan, and the DHCP daemon does not listen on the loopback interface.  In that
              case the server cannot be reached via unicast (or even 255.255.255.255) as that  would  be  routed
              via  loopback.  Setting  this  option  to  yes  and  configuring the local broadcast address (e.g.
              192.168.0.255) as server address might work.

       <b>charon.plugins.dhcp.identity_lease</b> [no]
              Derive user-defined MAC address from hash of IKE identity and send client identity DHCP option.

       <b>charon.plugins.dhcp.interface</b> []
              Interface name the plugin uses for address allocation. The default is to bind to any (0.0.0.0) and
              let the system decide which way to route the packets to the DHCP server.

       <b>charon.plugins.dhcp.interface_receive</b> [charon.plugins.dhcp.interface]
              Interface name the plugin uses to bind its  receive  socket.  The  default  is  to  use  the  same
              interface  as  the  send socket. Set it to the empty string to avoid binding the receive socket to
              any interface while the send socket is bound to one. If the   server runs on the same host and the
              send socket is bound to an interface, it might be necessary to set  this  to  `lo`  or  the  empty
              string.

       <b>charon.plugins.dhcp.server</b> [255.255.255.255]
              DHCP server unicast or broadcast IP address.

       <b>charon.plugins.dhcp.use_server_port</b> [no]
              Use the DHCP server port (67) as source port, instead of the DHCP client port (68), when a unicast
              server  address  is configured and the plugin acts as relay agent.  When replying in this mode the
              DHCP server will always send packets to the DHCP server port and if no process binds that port  an
              ICMP  port  unreachables  will be sent back, which might be problematic for some DHCP servers.  To
              avoid that, enabling this option will cause the plugin to bind the DHCP server port  to  send  its
              requests  when acting as relay agent. This is not necessary if a DHCP server is already running on
              the same host and might even cause conflicts (and since the server port is  already  bound,  ICMPs
              should not be an issue).

       <b>charon.plugins.dnscert.enable</b> [no]
              Enable fetching of CERT RRs via DNS.

       <b>charon.plugins.drbg.max_drbg_requests</b> [4294967294]
              Number of pseudo-random bit requests from the DRBG before an automatic reseeding occurs.

       <b>charon.plugins.duplicheck.enable</b> [yes]
              Enable duplicheck plugin (if loaded).

       <b>charon.plugins.duplicheck.socket</b> [unix://${piddir}/charon.dck]
              Socket provided by the duplicheck plugin.

       <b>charon.plugins.eap-aka.request_identity</b> [yes]

       <b>charon.plugins.eap-aka-3gpp.seq_check</b> []
              Enable to activate sequence check of the AKA SQN values in order to trigger resync cycles.

       <b>charon.plugins.eap-aka-3gpp2.seq_check</b> []
              Enable to activate sequence check of the AKA SQN values in order to trigger resync cycles.

       <b>charon.plugins.eap-dynamic.prefer_user</b> [no]
              If  enabled the EAP methods proposed in an EAP-Nak message sent by the peer are preferred over the
              methods registered locally.

       <b>charon.plugins.eap-dynamic.preferred</b> []
              The preferred EAP method(s) to be used.  If it is not given the first registered  method  will  be
              used  initially.   If  a  comma  separated  list is given the methods are tried in the given order
              before trying the rest of the registered methods.

       <b>charon.plugins.eap-gtc.backend</b> [pam]
              XAuth backend to be used for credential verification.

       <b>charon.plugins.eap-peap.fragment_size</b> [1024]
              Maximum size of an EAP-PEAP packet.

       <b>charon.plugins.eap-peap.include_length</b> [no]
              Include length in non-fragmented EAP-PEAP packets.

       <b>charon.plugins.eap-peap.max_message_count</b> [32]
              Maximum number of processed EAP-PEAP packets (0 = no limit).

       <b>charon.plugins.eap-peap.phase2_method</b> [mschapv2]
              Phase2 EAP client authentication method.

       <b>charon.plugins.eap-peap.phase2_piggyback</b> [no]
              Phase2 EAP Identity request piggybacked by server onto TLS Finished message, relevant only if  TLS
              1.2 or earlier is negotiated.

       <b>charon.plugins.eap-peap.phase2_tnc</b> [no]
              Start phase2 EAP TNC protocol after successful client authentication.

       <b>charon.plugins.eap-peap.request_peer_auth</b> [no]
              Request peer authentication based on a client certificate.

       <b>charon.plugins.eap-radius.accounting</b> [no]
              Send RADIUS accounting information to RADIUS servers.

       <b>charon.plugins.eap-radius.accounting_close_on_timeout</b> [yes]
              Close the IKE_SA if there is a timeout during interim RADIUS accounting updates.

       <b>charon.plugins.eap-radius.accounting_interval</b> [0s]
              Interval  in  seconds for interim RADIUS accounting updates, if not specified by the RADIUS server
              in the Access-Accept message.

       <b>charon.plugins.eap-radius.accounting_requires_vip</b> [no]
              If enabled, accounting is disabled unless an IKE_SA has at least one virtual IP.  Only for  IKEv2,
              for IKEv1 a virtual IP is strictly necessary.

       <b>charon.plugins.eap-radius.accounting_send_class</b> [no]
              If  enabled,  adds the Class attributes received in Access-Accept message to the RADIUS accounting
              messages.

       <b>charon.plugins.eap-radius.class_group</b> [no]
              Use the <u>class</u> attribute sent in the RADIUS-Accept message as group membership information that  is
              compared to the groups specified in the <b>rightgroups</b> option in <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5).

       <b>charon.plugins.eap-radius.close_all_on_timeout</b> [no]
              Closes  all  IKE_SAs  if communication with the RADIUS server times out. If it is not set only the
              current IKE_SA is closed.

       <b>charon.plugins.eap-radius.dae.enable</b> [no]
              Enables support for the Dynamic Authorization Extension (RFC 5176).

       <b>charon.plugins.eap-radius.dae.listen</b> [0.0.0.0]
              Address to listen for DAE messages from the RADIUS server.

       <b>charon.plugins.eap-radius.dae.port</b> [3799]
              Port to listen for DAE requests.

       <b>charon.plugins.eap-radius.dae.secret</b> []
              Shared secret used to verify/sign DAE messages. If set, make sure to adjust the permissions of the
              config file accordingly.

       <b>charon.plugins.eap-radius.eap_start</b> [no]
              Send EAP-Start instead of EAP-Identity to start RADIUS conversation.

       <b>charon.plugins.eap-radius.filter_id</b> [no]
              If the RADIUS <u>tunnel_type</u> attribute with value <b>ESP</b> is received, use the <u>filter_id</u>  attribute  sent
              in  the  RADIUS-Accept  message  as  group  membership  information that is compared to the groups
              specified in the <b>rightgroups</b> option in <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5).

       <b>charon.plugins.eap-radius.forward.ike_to_radius</b> []
              RADIUS attributes to be forwarded from IKEv2 to RADIUS  (can  be  defined  by  name  or  attribute
              number,  a  colon can be used to specify vendor-specific attributes, e.g. Reply-Message, or 11, or
              36906:12).

       <b>charon.plugins.eap-radius.forward.radius_to_ike</b> []
              Same as <u>charon.plugins.eap-radius.forward.ike_to_radius</u> but from RADIUS  to  IKEv2,  a  strongSwan
              specific private notify (40969) is used to transmit the attributes.

       <b>charon.plugins.eap-radius.id_prefix</b> []
              Prefix to EAP-Identity, some AAA servers use a IMSI prefix to select the EAP method.

       <b>charon.plugins.eap-radius.nas_identifier</b> [strongSwan]
              NAS-Identifier to include in RADIUS messages.

       <b>charon.plugins.eap-radius.port</b> [1812]
              Port of RADIUS server (authentication).

       <b>charon.plugins.eap-radius.retransmit_base</b> [1.4]
              Base to use for calculating exponential back off.

       <b>charon.plugins.eap-radius.retransmit_timeout</b> [2.0]
              Timeout in seconds before sending first retransmit.

       <b>charon.plugins.eap-radius.retransmit_tries</b> [4]
              Number of times to retransmit a packet before giving up.

       <b>charon.plugins.eap-radius.secret</b> []
              Shared  secret  between  RADIUS and NAS. If set, make sure to adjust the permissions of the config
              file accordingly.

       <b>charon.plugins.eap-radius.server</b> []
              IP/Hostname of RADIUS server.

       <b>charon.plugins.eap-radius.servers</b>
              Section to specify multiple RADIUS servers. The <b>source</b>, <b>nas_identifier</b>, <b>secret</b>, <b>sockets</b>  and  <b>port</b>
              (or  <b>auth_port</b>) options can be specified for each server. A server's IP/Hostname can be configured
              using the <b>address</b> option. The <b>acct_port</b> [1813] option can be used to specify  the  port  used  for
              RADIUS  accounting.  For  each  RADIUS server a priority can be specified using the <b>preference</b> [0]
              option.  The  retransmission  time  for  each  server   can   set   set   using   <b>retransmit_base</b>,
              <b>retransmit_timeout</b> and <b>retransmit_tries</b>.

       <b>charon.plugins.eap-radius.sockets</b> [1]
              Number of sockets (ports) to use, increase for high load.

       <b>charon.plugins.eap-radius.source</b> []
              Optional specific source IP to use.

       <b>charon.plugins.eap-radius.station_id_with_port</b> [yes]
              Whether to include the UDP port in the Called- and Calling-Station-Id RADIUS attributes.

       <b>charon.plugins.eap-radius.xauth</b>
              Section  to  configure  multiple XAuth authentication rounds via RADIUS. The subsections define so
              called authentication profiles with arbitrary names. In each profile section  one  or  more  XAuth
              types can be configured, with an assigned message. For each type a separate XAuth exchange will be
              initiated  and  all  replies  get  concatenated  into the User-Password attribute, which then gets
              verified over RADIUS.

              Available XAuth types are <b>password</b>, <b>passcode</b>, <b>nextpin</b>, and <b>answer</b>.  This type is not  relevant  to
              strongSwan  or  the  AAA  server,  but  the  client  may  show  a different dialog (along with the
              configured message).

              To use the configured profiles, they have  to  be  configured  in  the  respective  connection  in
              <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5)  by  appending  the  profile  name, separated by a colon, to the <b>xauth-radius</b> XAauth
              backend configuration in <u>rightauth</u> or <u>rightauth2</u>, for instance, <u>rightauth2=xauth-radius:profile</u>.

       <b>charon.plugins.eap-sim.request_identity</b> [yes]

       <b>charon.plugins.eap-simaka-sql.database</b> []

       <b>charon.plugins.eap-simaka-sql.remove_used</b> [no]

       <b>charon.plugins.eap-tls.fragment_size</b> [1024]
              Maximum size of an EAP-TLS packet.

       <b>charon.plugins.eap-tls.include_length</b> [yes]
              Include length in non-fragmented EAP-TLS packets.

       <b>charon.plugins.eap-tls.max_message_count</b> [32]
              Maximum number of processed EAP-TLS packets (0 = no limit).

       <b>charon.plugins.eap-tnc.max_message_count</b> [10]
              Maximum number of processed EAP-TNC packets (0 = no limit).

       <b>charon.plugins.eap-tnc.protocol</b> [tnccs-2.0]
              IF-TNCCS protocol version to be used (<u>tnccs-1.1</u>, <u>tnccs-2.0</u>, <u>tnccs-dynamic</u>).

       <b>charon.plugins.eap-ttls.fragment_size</b> [1024]
              Maximum size of an EAP-TTLS packet.

       <b>charon.plugins.eap-ttls.include_length</b> [yes]
              Include length in non-fragmented EAP-TTLS packets.

       <b>charon.plugins.eap-ttls.max_message_count</b> [32]
              Maximum number of processed EAP-TTLS packets (0 = no limit).

       <b>charon.plugins.eap-ttls.phase2_method</b> [md5]
              Phase2 EAP client authentication method.

       <b>charon.plugins.eap-ttls.phase2_piggyback</b> [no]
              Phase2 EAP Identity request piggybacked by server onto TLS Finished message.

       <b>charon.plugins.eap-ttls.phase2_tnc</b> [no]
              Start phase2 EAP TNC protocol after successful client authentication.

       <b>charon.plugins.eap-ttls.phase2_tnc_method</b> [pt]
              Phase2 EAP TNC transport protocol (<u>pt</u> as IETF standard or legacy <u>tnc</u>)

       <b>charon.plugins.eap-ttls.request_peer_auth</b> [no]
              Request peer authentication based on a client certificate.

       <b>charon.plugins.error-notify.socket</b> [unix://${piddir}/charon.enfy]
              Socket provided by the error-notify plugin.

       <b>charon.plugins.ext-auth.script</b> []
              Command to pass to the system shell for peer authorization. Authorization is considered successful
              if the command executes normally with an exit code of  zero.  For  all  other  exit  codes  IKE_SA
              authorization is rejected.

              The  following environment variables get passed to the script: <u>IKE_UNIQUE_ID</u>: The IKE_SA numerical
              unique identifier.  <u>IKE_NAME</u>: The peer configuration connection name.  <u>IKE_LOCAL_HOST</u>:  Local  IKE
              IP   address.   <u>IKE_REMOTE_HOST</u>:  Remote  IKE  IP  address.   <u>IKE_LOCAL_ID</u>:  Local  IKE  identity.
              <u>IKE_REMOTE_ID</u>: Remote IKE identity.  <u>IKE_REMOTE_EAP_ID</u>: Remote EAP or XAuth identity, if used.

       <b>charon.plugins.forecast.groups</b> [224.0.0.1,224.0.0.22,224.0.0.251,224.0.0.252,239.255.255.250]
              Comma separated list of multicast groups to join locally. The local  host  receives  and  forwards
              packets in the local LAN for joined multicast groups only.  Packets matching the list of multicast
              groups get forwarded to connected clients. The default group includes host multicasts, IGMP, mDNS,
              LLMNR and SSDP/WS-Discovery, and is usually a good choice for Windows clients.

       <b>charon.plugins.forecast.interface</b> []
              Name  of  the  local  interface  to  listen for broadcasts messages to forward. If no interface is
              configured, the first usable interface is used, which is usually just fine for single-homed hosts.
              If your host has multiple interfaces, set this option to the  local  LAN  interface  you  want  to
              forward broadcasts from/to.

       <b>charon.plugins.forecast.reinject</b> []
              Comma  separated  list  of  CHILD_SA  configuration  names  for  which  to perform multi/broadcast
              reinjection. For clients connecting over such a configuration, any multi/broadcast  received  over
              the  tunnel  gets  reinjected  to  all  active tunnels. This makes the broadcasts visible to other
              peers, and for examples allows clients to see others shares. If disabled, multi/broadcast messages
              received over a tunnel are injected to the local network only, but not to other IPsec clients.

       <b>charon.plugins.gcrypt.quick_random</b> [no]
              Use faster random numbers in gcrypt; for testing only, produces weak keys!

       <b>charon.plugins.ha.autobalance</b> [0]
              Interval in seconds to automatically balance handled segments between nodes. Set to 0 to disable.

       <b>charon.plugins.ha.buflen</b> [2048]
              Buffer size for received HA messages. For IKEv1 the public DH  factors  are  also  transmitted  so
              depending  on  the  DH  group  the HA messages can get quite big (the default should be fine up to
              <u>modp4096</u>).

       <b>charon.plugins.ha.fifo_interface</b> [yes]

       <b>charon.plugins.ha.heartbeat_delay</b> [1000]

       <b>charon.plugins.ha.heartbeat_timeout</b> [2100]

       <b>charon.plugins.ha.local</b> []

       <b>charon.plugins.ha.monitor</b> [yes]

       <b>charon.plugins.ha.pools</b> []

       <b>charon.plugins.ha.remote</b> []

       <b>charon.plugins.ha.resync</b> [yes]

       <b>charon.plugins.ha.secret</b> []

       <b>charon.plugins.ha.segment_count</b> [1]

       <b>charon.plugins.ipseckey.enable</b> [no]
              Enable fetching of IPSECKEY RRs via DNS.

       <b>charon.plugins.kernel-libipsec.allow_peer_ts</b> [no]
              Allow that the remote traffic selector equals the IKE peer. The route installed for  such  traffic
              (via  TUN  device) usually prevents further IKE traffic. The fwmark options for the <u>kernel-netlink</u>
              and <u>socket-default</u> plugins can be used to circumvent that problem.

       <b>charon.plugins.kernel-libipsec.fwmark</b> [charon.plugins.socket-default.fwmark]
              Firewall mark to set on outbound raw ESP packets.

       <b>charon.plugins.kernel-libipsec.raw_esp</b> [no]
              Whether to send and receive ESP packets without UDP encapsulation if supported  on  this  platform
              and no NAT is detected.

       <b>charon.plugins.kernel-netlink.buflen</b> [&lt;min(PAGE_SIZE, 8192)&gt;]
              Buffer size for received Netlink messages.

       <b>charon.plugins.kernel-netlink.fwmark</b> []
              Firewall  mark to set on the routing rule that directs traffic to our routing table. The format is
              [!]mark[/mask], where the optional exclamation mark  inverts  the  meaning  (i.e.  the  rule  only
              applies to packets that don't match the mark).

       <b>charon.plugins.kernel-netlink.hw_offload_feature_interface</b> [lo]
              If  the  kernel  supports  hardware  offloading,  the  plugin needs to find the feature flag which
              represents hardware offloading support for network devices. Using the  loopback  device  for  this
              purpose  is  usually fine, since it should always be present. For rare cases in which the loopback
              device cannot be used to obtain the appropriate feature flag, this option can be used  to  specify
              an alternative interface for offload feature detection.

       <b>charon.plugins.kernel-netlink.ignore_retransmit_errors</b> [no]
              Whether to ignore errors potentially resulting from a retransmission.

       <b>charon.plugins.kernel-netlink.install_routes_xfrmi</b> [no]
              Whether  routes  via  XFRM  interfaces  are automatically installed for SAs that reference such an
              interface via <u>if_id_out</u>.  If the traffic selectors include the  IKE  traffic  to  the  peer,  this
              requires special care (e.g. installing bypass policies and/or routes, or setting a mark on the IKE
              socket and excluding such packets from the configured routing table via <u>fwmark</u> option).

       <b>charon.plugins.kernel-netlink.mss</b> [0]
              MSS to set on installed routes, 0 to disable.

       <b>charon.plugins.kernel-netlink.mtu</b> [0]
              MTU to set on installed routes, 0 to disable.

       <b>charon.plugins.kernel-netlink.parallel_route</b> [no]
              Whether to perform concurrent Netlink ROUTE queries on a single socket. While parallel queries can
              improve  throughput, it has more overhead. On vanilla Linux, DUMP queries fail with EBUSY and must
              be retried, further decreasing performance.

       <b>charon.plugins.kernel-netlink.parallel_xfrm</b> [no]
              Whether to perform concurrent Netlink XFRM queries on a single socket.

       <b>charon.plugins.kernel-netlink.policy_update</b> [no]
              Whether to always use XFRM_MSG_UPDPOLICY to install policies.

       <b>charon.plugins.kernel-netlink.port_bypass</b> [no]
              Whether to use port or socket based IKE XFRM bypass policies. IKE  bypass  policies  are  used  to
              exempt  IKE  traffic  from XFRM processing. The default socket based policies are directly tied to
              the IKE UDP sockets, port based policies use global XFRM bypass policies  for  the  used  IKE  UDP
              ports.

       <b>charon.plugins.kernel-netlink.process_rules</b> [no]
              Whether  to process changes in routing rules to trigger roam events. This is currently only useful
              if the kernel based route lookup is used (i.e. if route installation is disabled  or  an  inverted
              fwmark match is configured).

       <b>charon.plugins.kernel-netlink.receive_buffer_size</b> [8388608]
              Maximum  Netlink  socket  receive  buffer  in bytes. This value controls how many bytes of Netlink
              messages  can  be  queued   to   a   Netlink   socket.   If   set   to   0,   the   default   from
              <a href="file:/proc/sys/net/core/rmem_default">/proc/sys/net/core/rmem_default</a>  will  apply. Note that the kernel doubles the configured value to
              account for overhead. To exceed the system-wide maximum from <a href="file:/proc/sys/net/core/rmem_max">/proc/sys/net/core/rmem_max</a>,  special
              privileges (CAP_NET_ADMIN) are necessary, otherwise, the kernel silently caps the value.

       <b>charon.plugins.kernel-netlink.retries</b> [0]
              Number of Netlink message retransmissions to send on timeout.

       <b>charon.plugins.kernel-netlink.roam_events</b> [yes]
              Whether to trigger roam events when interfaces, addresses or routes change.

       <b>charon.plugins.kernel-netlink.set_proto_port_transport_sa</b> [no]
              Whether  to  set  protocol  and ports in the selector installed on transport mode IPsec SAs in the
              kernel. While doing so enforces policies for inbound traffic, it also prevents the use of a single
              IPsec SA by more than one traffic selector.

       <b>charon.plugins.kernel-netlink.spdh_thresh</b>
              XFRM policy hashing threshold configuration for IPv4 and IPv6.

              The section defines hashing thresholds to configure in the  kernel  during  daemon  startup.  Each
              address family takes a threshold for the local subnet of an IPsec policy (src in out-policies, dst
              in  in-  and  forward-policies)  and  the  remote  subnet  (dst  in  out-policies,  src in in- and
              forward-policies).

              If the subnet has more or equal net bits than the threshold, the first threshold bits are used  to
              calculate a hash to lookup the policy.

              Policy  hashing  thresholds  are  not  supported  before Linux 3.18 and might conflict with socket
              policies before Linux 4.8.

       <b>charon.plugins.kernel-netlink.spdh_thresh.ipv4.lbits</b> [32]
              Local subnet XFRM policy hashing threshold for IPv4.

       <b>charon.plugins.kernel-netlink.spdh_thresh.ipv4.rbits</b> [32]
              Remote subnet XFRM policy hashing threshold for IPv4.

       <b>charon.plugins.kernel-netlink.spdh_thresh.ipv6.lbits</b> [128]
              Local subnet XFRM policy hashing threshold for IPv6.

       <b>charon.plugins.kernel-netlink.spdh_thresh.ipv6.rbits</b> [128]
              Remote subnet XFRM policy hashing threshold for IPv6.

       <b>charon.plugins.kernel-netlink.timeout</b> [0]
              Netlink message retransmission timeout, 0 to disable retransmissions.

       <b>charon.plugins.kernel-netlink.xfrm_acq_expires</b> [165]
              Lifetime of XFRM acquire state created by the kernel when traffic matches a trap policy. The value
              gets written to /proc/sys/net/core/xfrm_acq_expires.  Indirectly controls the delay  between  XFRM
              acquire  messages triggered by the kernel for a trap policy. The same value is used as timeout for
              SPIs allocated by the kernel. The default value equals the total   retransmission timeout for  IKE
              messages, see IKEv2 RETRANSMISSION in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

       <b>charon.plugins.kernel-pfkey.events_buffer_size</b> [0]
              Size  of the receive buffer for the event socket (0 for default size). Because events are received
              asynchronously installing e.g. lots of policies may require a larger buffer than  the  default  on
              certain platforms in order to receive all messages.

       <b>charon.plugins.kernel-pfkey.route_via_internal</b> [no]
              Whether  to  use the internal or external interface in installed routes. The internal interface is
              the one where the IP address contained in the local traffic  selector  is  located,  the  external
              interface  is  the one over which the destination address of the IPsec tunnel can be reached. This
              is not relevant if virtual IPs are used, for which a TUN device is  created  that's  used  in  the
              routes.

       <b>charon.plugins.kernel-pfroute.mtu</b> [1400]
              MTU to set on TUN devices created for virtual IPs.

       <b>charon.plugins.kernel-pfroute.vip_wait</b> [1000]
              Time in ms to wait until virtual IP addresses appear/disappear before failing.

       <b>charon.plugins.led.activity_led</b> []

       <b>charon.plugins.led.blink_time</b> [50]

       <b>charon.plugins.load-tester</b>
              Section to configure the load-tester plugin, see LOAD TESTS in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5) for details.

       <b>charon.plugins.load-tester.addrs</b>
              Section  that contains key/value pairs with address pools (in CIDR notation) to use for a specific
              network interface e.g. eth0 = 10.10.0.0/16.

       <b>charon.plugins.load-tester.addrs_keep</b> [no]
              Whether to keep dynamic addresses even after the associated SA got terminated.

       <b>charon.plugins.load-tester.addrs_prefix</b> [16]
              Network prefix length to use when installing dynamic addresses. If set to -1 the full  address  is
              used (i.e. 32 or 128).

       <b>charon.plugins.load-tester.ca_dir</b> []
              Directory to load (intermediate) CA certificates from.

       <b>charon.plugins.load-tester.child_rekey</b> [600]
              Seconds to start CHILD_SA rekeying after setup.

       <b>charon.plugins.load-tester.crl</b> []
              URI to a CRL to include as certificate distribution point in generated certificates.

       <b>charon.plugins.load-tester.delay</b> [0]
              Delay between initiations for each thread.

       <b>charon.plugins.load-tester.delete_after_established</b> [no]
              Delete an IKE_SA as soon as it has been established.

       <b>charon.plugins.load-tester.digest</b> [sha1]
              Digest algorithm used when issuing certificates.

       <b>charon.plugins.load-tester.dpd_delay</b> [0]
              DPD delay to use in load test.

       <b>charon.plugins.load-tester.dynamic_port</b> [0]
              Base port to be used for requests (each client uses a different port).

       <b>charon.plugins.load-tester.eap_password</b> [default-pwd]
              EAP secret to use in load test.

       <b>charon.plugins.load-tester.enable</b> [no]
              Enable  the  load  testing  plugin.   <b>WARNING</b>:  Never enable this plugin on productive systems. It
              provides preconfigured credentials and allows an attacker to authenticate as any user.

       <b>charon.plugins.load-tester.esp</b> [aes128-sha1]
              CHILD_SA proposal to use for load tests.

       <b>charon.plugins.load-tester.fake_kernel</b> [no]
              Fake the kernel interface to allow load-testing against self.

       <b>charon.plugins.load-tester.ike_rekey</b> [0]
              Seconds to start IKE_SA rekeying after setup.

       <b>charon.plugins.load-tester.init_limit</b> [0]
              Global limit of concurrently established SAs during load test.

       <b>charon.plugins.load-tester.initiator</b> [0.0.0.0]
              Address to initiate from.

       <b>charon.plugins.load-tester.initiator_auth</b> [pubkey]
              Authentication method(s) the initiator uses.

       <b>charon.plugins.load-tester.initiator_id</b> []
              Initiator ID used in load test.

       <b>charon.plugins.load-tester.initiator_match</b> []
              Initiator ID to match against as responder.

       <b>charon.plugins.load-tester.initiator_tsi</b> []
              Traffic selector on initiator side, as proposed by initiator.

       <b>charon.plugins.load-tester.initiator_tsr</b> []
              Traffic selector on responder side, as proposed by initiator.

       <b>charon.plugins.load-tester.initiators</b> [0]
              Number of concurrent initiator threads to use in load test.

       <b>charon.plugins.load-tester.issuer_cert</b> []
              Path to the issuer certificate (if not configured a hard-coded default value is used).

       <b>charon.plugins.load-tester.issuer_key</b> []
              Path to private key that is used to issue certificates (if not  configured  a  hard-coded  default
              value is used).

       <b>charon.plugins.load-tester.iterations</b> [1]
              Number of IKE_SAs to initiate by each initiator in load test.

       <b>charon.plugins.load-tester.mode</b> [tunnel]
              IPsec mode to use, one of <u>tunnel</u>, <u>transport</u>, or <u>beet</u>.

       <b>charon.plugins.load-tester.pool</b> []
              Provide INTERNAL_IPV4_ADDRs from a named pool.

       <b>charon.plugins.load-tester.preshared_key</b> [&lt;default-psk&gt;]
              Preshared key to use in load test.

       <b>charon.plugins.load-tester.proposal</b> [aes128-sha1-modp768]
              IKE proposal to use in load test.

       <b>charon.plugins.load-tester.request_virtual_ip</b> [no]
              Request an INTERNAL_IPV4_ADDR and INTERNAL_IPV6_ADDR from the server.

       <b>charon.plugins.load-tester.responder</b> [127.0.0.1]
              Address to initiation connections to.

       <b>charon.plugins.load-tester.responder_auth</b> [pubkey]
              Authentication method(s) the responder uses.

       <b>charon.plugins.load-tester.responder_id</b> []
              Responder ID used in load test.

       <b>charon.plugins.load-tester.responder_tsi</b> [initiator_tsi]
              Traffic selector on initiator side, as narrowed by responder.

       <b>charon.plugins.load-tester.responder_tsr</b> [initiator_tsr]
              Traffic selector on responder side, as narrowed by responder.

       <b>charon.plugins.load-tester.shutdown_when_complete</b> [no]
              Shutdown the daemon after all IKE_SAs have been established.

       <b>charon.plugins.load-tester.socket</b> [unix://${piddir}/charon.ldt]
              Socket provided by the load-tester plugin.

       <b>charon.plugins.load-tester.version</b> [0]
              IKE version to use (0 means use IKEv2 as initiator and accept any version as responder).

       <b>charon.plugins.lookip.socket</b> [unix://${piddir}/charon.lkp]
              Socket provided by the lookip plugin.

       <b>charon.plugins.openssl.engine_id</b> [pkcs11]
              ENGINE ID to use in the OpenSSL plugin.

       <b>charon.plugins.openssl.fips_mode</b> [0]
              Set  OpenSSL FIPS mode.  With OpenSSL before 3.0, the supported values are <a href="../man0/disabled.0.html">disabled</a>(0), <a href="../man1/enabled.1.html">enabled</a>(1)
              and Suite B <a href="../man2/enabled.2.html">enabled</a>(2).  With OpenSSL 3+, any value other than 0 will explicitly load the fips and
              base  providers  (<u>load_legacy</u>  will  be  ignored).  The  latter  still  requires  the  config   in
              fipsmodule.cnf  (e.g.   for  the module's MAC), but allows explicitly loading the provider if it's
              not activated in that config.

       <b>charon.plugins.openssl.load_legacy</b> [yes]
              Load the legacy provider in OpenSSL 3+ for algorithms like MD4, DES, or Blowfish  (the  first  two
              are  required  for EAP-MSCHAPv2). If disabled, the default provider is loaded, or those configured
              in the OpenSSL config (e.g. the fips provider).

       <b>charon.plugins.openxpki.database</b> []
              Database URI connecting to the OpenXPKI <b>certificate</b> database. If it contains a password, make sure
              to adjust the permissions of the config file accordingly.

       <b>charon.plugins.osx-attr.append</b> [yes]
              Whether DNS servers are appended to existing entries, instead of replacing them.

       <b>charon.plugins.p-cscf.enable</b>
              Section to enable requesting P-CSCF server addresses for individual connections.

       <b>charon.plugins.p-cscf.enable.&lt;conn&gt;</b> [no]
              &lt;conn&gt; is the name of a connection with an ePDG from which to  request  P-CSCF  server  addresses.
              Requests will be sent for addresses of the same families for which internal IPs are requested.

       <b>charon.plugins.pkcs11.modules</b>
              List of available PKCS#11 modules.

       <b>charon.plugins.pkcs11.modules.&lt;name&gt;.load_certs</b> [yes]
              Whether to automatically load certificates from tokens.

       <b>charon.plugins.pkcs11.modules.&lt;name&gt;.os_locking</b> [no]
              Whether OS locking should be enabled for this module.

       <b>charon.plugins.pkcs11.modules.&lt;name&gt;.path</b> []
              Full path to the shared object file of this PKCS#11 module.

       <b>charon.plugins.pkcs11.reload_certs</b> [no]
              Reload certificates from all tokens if charon receives a SIGHUP.

       <b>charon.plugins.pkcs11.use_dh</b> [no]
              Whether the PKCS#11 modules should be used for DH and ECDH (see <u>use_ecc</u> option).

       <b>charon.plugins.pkcs11.use_ecc</b> [no]
              Whether the PKCS#11 modules should be used for ECDH and ECDSA public key operations. ECDSA private
              keys can be used regardless of this option.

       <b>charon.plugins.pkcs11.use_hasher</b> [no]
              Whether the PKCS#11 modules should be used to hash data.

       <b>charon.plugins.pkcs11.use_pubkey</b> [no]
              Whether  the PKCS#11 modules should be used for public key operations, even for keys not stored on
              tokens.

       <b>charon.plugins.pkcs11.use_rng</b> [no]
              Whether the PKCS#11 modules should be used as RNG.

       <b>charon.plugins.pkcs11.use_rsa_pss_hashers</b> [no]
              Whether the PKCS#11 modules should try to  use  internal  hashing  for  RSA-PSS  signatures  (some
              PKCS#11 libraries don't implement internal hashing in conjunction with RSA-PSS correctly).

       <b>charon.plugins.radattr.dir</b> []
              Directory where RADIUS attributes are stored in client-ID specific files.

       <b>charon.plugins.radattr.message_id</b> [-1]
              Attributes  are  added  to  all IKE_AUTH messages by default (-1), or only to the IKE_AUTH message
              with the given IKEv2 message ID.

       <b>charon.plugins.random.random</b> [${random_device}]
              File to read random bytes from.

       <b>charon.plugins.random.strong_equals_true</b> [no]
              If set to yes the RNG_STRONG class reads random bytes from the same source as the RNG_TRUE class.

       <b>charon.plugins.random.urandom</b> [${urandom_device}]
              File to read pseudo random bytes from.

       <b>charon.plugins.resolve.file</b> [<a href="file:/etc/resolv.conf">/etc/resolv.conf</a>]
              File where to add DNS server entries if not using <a href="../man8/resolvconf.8.html">resolvconf</a>(8).

       <b>charon.plugins.resolve.resolvconf.iface</b> [lo.ipsec]
              The interface name and protocol sent to <b><a href="../man8/resolvconf.8.html">resolvconf</a></b>(8).  This has to  be  a  valid  interface  name
              according  to  the rules defined by resolvconf.  Also, it should have a high priority according to
              the order defined in <b><a href="../man5/interface-order.5.html">interface-order</a></b>(5) if relevant on the system.

       <b>charon.plugins.resolve.resolvconf.path</b> [<a href="file:/sbin/resolvconf">/sbin/resolvconf</a>]
              Path/command for <b><a href="../man8/resolvconf.8.html">resolvconf</a></b>(8).  The command is executed by a shell, so "resolvconf" will work  if
              it's in $PATH of the daemon.

              If  not  configured,  <b><a href="../man8/resolvconf.8.html">resolvconf</a></b>(8) will be used if found at the default location.  Otherwise, the
              file in <u>charon.plugins.resolve.file</u> will be modified directly.

       <b>charon.plugins.revocation.enable_crl</b> [yes]
              Whether CRL validation should be enabled.

       <b>charon.plugins.revocation.enable_ocsp</b> [yes]
              Whether OCSP validation should be enabled.

       <b>charon.plugins.revocation.timeout</b> [10s]
              Timeout used when fetching OCSP/CRL.

       <b>charon.plugins.save-keys.esp</b> [no]
              Whether to save ESP keys.

       <b>charon.plugins.save-keys.ike</b> [no]
              Whether to save IKE keys.

       <b>charon.plugins.save-keys.load</b> [no]
              Whether to load the plugin.

       <b>charon.plugins.save-keys.wireshark_keys</b> []
              Directory where the keys are stored in the format supported by Wireshark. IKEv1 keys are stored in
              the <u>ikev1_decryption_table</u> file. IKEv2 keys are stored in the  <u>ikev2_decryption_table</u>  file.  Keys
              for ESP CHILD_SAs are stored in the <u>esp_sa</u> file.

       <b>charon.plugins.socket-default.fwmark</b> []
              Firewall mark to set on outbound packets.

       <b>charon.plugins.socket-default.set_source</b> [yes]
              Set source address on outbound packets, if possible.

       <b>charon.plugins.socket-default.set_sourceif</b> [no]
              Force  sending  interface  on  outbound  packets,  if  possible. This allows using IPv6 link-local
              addresses as tunnel endpoints.

       <b>charon.plugins.socket-default.use_ipv4</b> [yes]
              Listen on IPv4, if possible.

       <b>charon.plugins.socket-default.use_ipv6</b> [yes]
              Listen on IPv6, if possible.

       <b>charon.plugins.sql.database</b> []
              Database URI for charon's SQL plugin.  If  it  contains  a  password,  make  sure  to  adjust  the
              permissions of the config file accordingly.

       <b>charon.plugins.sql.loglevel</b> [-1]
              Loglevel for logging to SQL database.

       <b>charon.plugins.stroke.allow_swap</b> [yes]
              Analyze  addresses/hostnames  in  <u>left|right</u>  to detect which side is local and swap configuration
              options if necessary. If disabled <u>left</u> is always <u>local</u>.

       <b>charon.plugins.stroke.ignore_missing_ca_basic_constraint</b> [no]
              Treat certificates in ipsec.d/cacerts and ipsec.conf ca sections as CA certificates even  if  they
              don't contain a CA basic constraint.

       <b>charon.plugins.stroke.max_concurrent</b> [4]
              Maximum number of stroke messages handled concurrently.

       <b>charon.plugins.stroke.prevent_loglevel_changes</b> [no]
              If enabled log level changes via stroke socket are not allowed.

       <b>charon.plugins.stroke.secrets_file</b> [${sysconfdir}/ipsec.secrets]
              Location of the ipsec.secrets file

       <b>charon.plugins.stroke.socket</b> [unix://${piddir}/charon.ctl]
              Socket provided by the stroke plugin.

       <b>charon.plugins.stroke.timeout</b> [0]
              Timeout in ms for any stroke command. Use 0 to disable the timeout.

       <b>charon.plugins.systime-fix.interval</b> [0]
              Interval in seconds to check system time for validity. 0 disables the check.

       <b>charon.plugins.systime-fix.reauth</b> [no]
              Whether to use reauth or delete if an invalid cert lifetime is detected.

       <b>charon.plugins.systime-fix.threshold</b> []
              Threshold date where system time is considered valid. Disabled if not specified.

       <b>charon.plugins.systime-fix.threshold_format</b> [%Y]
              <b><a href="../man3/strptime.3.html">strptime</a></b>(3) format used to parse threshold option.

       <b>charon.plugins.systime-fix.timeout</b> [0s]
              How long to wait for a valid system time if an interval is configured. 0 to recheck indefinitely.

       <b>charon.plugins.tnc-ifmap.client_cert</b> []
              Path to X.509 certificate file of IF-MAP client.

       <b>charon.plugins.tnc-ifmap.client_key</b> []
              Path to private key file of IF-MAP client.

       <b>charon.plugins.tnc-ifmap.device_name</b> []
              Unique name of strongSwan server as a PEP and/or PDP device.

       <b>charon.plugins.tnc-ifmap.renew_session_interval</b> [150]
              Interval in seconds between periodic IF-MAP RenewSession requests.

       <b>charon.plugins.tnc-ifmap.server_cert</b> []
              Path to X.509 certificate file of IF-MAP server.

       <b>charon.plugins.tnc-ifmap.server_uri</b> [https://localhost:8444/imap]
              URI of the form [https://]servername[:port][/path].

       <b>charon.plugins.tnc-ifmap.username_password</b> []
              Credentials  of  IF-MAP  client  of  the  form  username:password. If set, make sure to adjust the
              permissions of the config file accordingly.

       <b>charon.plugins.tnc-imc.dlclose</b> [yes]
              Unload IMC after use.

       <b>charon.plugins.tnc-imc.preferred_language</b> [en]
              Preferred language for TNC recommendations.

       <b>charon.plugins.tnc-imv.dlclose</b> [yes]
              Unload IMV after use.

       <b>charon.plugins.tnc-imv.recommendation_policy</b> [default]
              TNC recommendation policy, one of <u>default</u>, <u>any</u>, or <u>all</u>.

       <b>charon.plugins.tnc-pdp.pt_tls.enable</b> [yes]
              Enable PT-TLS protocol on the strongSwan PDP.

       <b>charon.plugins.tnc-pdp.pt_tls.port</b> [271]
              PT-TLS server port the strongSwan PDP is listening on.

       <b>charon.plugins.tnc-pdp.radius.enable</b> [yes]
              Enable RADIUS protocol on the strongSwan PDP.

       <b>charon.plugins.tnc-pdp.radius.method</b> [ttls]
              EAP tunnel method to be used.

       <b>charon.plugins.tnc-pdp.radius.port</b> [1812]
              RADIUS server port the strongSwan PDP is listening on.

       <b>charon.plugins.tnc-pdp.radius.secret</b> []
              Shared RADIUS secret between strongSwan PDP and NAS. If set, make sure to adjust  the  permissions
              of the config file accordingly.

       <b>charon.plugins.tnc-pdp.server</b> []
              Name of the strongSwan PDP as contained in the AAA certificate.

       <b>charon.plugins.tnc-pdp.timeout</b> []
              Timeout in seconds before closing incomplete connections.

       <b>charon.plugins.tnccs-11.max_message_size</b> [45000]
              Maximum size of a PA-TNC message (XML &amp; Base64 encoding).

       <b>charon.plugins.tnccs-20.max_batch_size</b> [65522]
              Maximum size of a PB-TNC batch (upper limit via PT-EAP = 65529).

       <b>charon.plugins.tnccs-20.max_message_size</b> [65490]
              Maximum size of a PA-TNC message (upper limit via PT-EAP = 65497).

       <b>charon.plugins.tnccs-20.mutual</b> [no]
              Enable PB-TNC mutual protocol.

       <b>charon.plugins.tnccs-20.tests.pb_tnc_noskip</b> [no]
              Send an unsupported PB-TNC message type with the NOSKIP flag set.

       <b>charon.plugins.tnccs-20.tests.pb_tnc_version</b> [2]
              Send a PB-TNC batch with a modified PB-TNC version.

       <b>charon.plugins.tpm.ek_handle</b> []
              Handle of the RSA or ECC Endorsement Key (EK) to be used to set up an authenticated session with a
              TPM 2.0 (e.g. 0x81010001).

       <b>charon.plugins.tpm.fips_186_4</b> [no]
              Is  the  TPM  2.0 FIPS-186-4 compliant, forcing e.g. the use of the default salt length instead of
              maximum salt length with RSAPSS padding.

       <b>charon.plugins.tpm.tcti.name</b> [device|tabrmd]
              Name of TPM 2.0 TCTI library. Valid values: <u>tabrmd</u>, <u>device</u> or <u>mssim</u>.  Defaults are <u>device</u>  if  the
              <u>/dev/tpmrm0</u>  in-kernel TPM 2.0 resource manager device exists, and <u>tabrmd</u> otherwise, requiring the
              d-bus based TPM 2.0 access broker and resource manager to be available.

       <b>charon.plugins.tpm.tcti.opts</b> [/dev/tpmrm0|&lt;none&gt;]
              Options for the TPM 2.0 TCTI library. Defaults are <u>/dev/tpmrm0</u> if the TCTI library name is  <u>device</u>
              and no options otherwise.

       <b>charon.plugins.tpm.use_rng</b> [no]
              Whether  the  TPM  should  be  used  as  RNG. For security reasons enable only if an authenticated
              session can be set up (see <u>ek_handle</u> option).

       <b>charon.plugins.unbound.dlv_anchors</b> []
              File to read trusted keys for DLV (DNSSEC Lookaside Validation) from. It uses the same  format  as
              <u>trust_anchors</u>.   Only  one  DLV  can be configured, which is then used as a root trusted DLV, this
              means that it is a lookaside for the root.

       <b>charon.plugins.unbound.resolv_conf</b> [<a href="file:/etc/resolv.conf">/etc/resolv.conf</a>]
              File to read DNS resolver configuration from.

       <b>charon.plugins.unbound.trust_anchors</b> [${sysconfdir}/ipsec.d/dnssec.keys]
              File to read DNSSEC trust anchors from (usually root zone KSK). The format  of  the  file  is  the
              standard DNS Zone file format, anchors can be stored as DS or DNSKEY entries in the file.

       <b>charon.plugins.updown.dns_handler</b> [no]
              Whether the updown script should handle DNS servers assigned via IKEv1 Mode Config or IKEv2 Config
              Payloads (if enabled they can't be handled by other plugins, like resolve)

       <b>charon.plugins.vici.socket</b> [unix://${piddir}/charon.vici]
              Socket the vici plugin serves clients.

       <b>charon.plugins.whitelist.enable</b> [yes]
              Enable loaded whitelist plugin.

       <b>charon.plugins.whitelist.socket</b> [unix://${piddir}/charon.wlst]
              Socket provided by the whitelist plugin.

       <b>charon.plugins.wolfssl.fips_mode</b> [no]
              Enable to prevent loading the plugin if wolfSSL is not in FIPS mode.

       <b>charon.plugins.xauth-eap.backend</b> [radius]
              EAP plugin to be used as backend for XAuth credential verification.

       <b>charon.plugins.xauth-pam.pam_service</b> [login]
              PAM service to be used for authentication.

       <b>charon.plugins.xauth-pam.session</b> [no]
              Open/close a PAM session for each active IKE_SA.

       <b>charon.plugins.xauth-pam.trim_email</b> [yes]
              If an email address is received as an XAuth username, trim it to just the username part.

       <b>charon.port</b> [500]
              UDP port used locally. If set to 0 a random port will be allocated.

       <b>charon.port_nat_t</b> [4500]
              UDP  port  used  locally in case of NAT-T. If set to 0 a random port will be allocated.  Has to be
              different from <b>charon.port</b>, otherwise a random port will be allocated.

       <b>charon.prefer_best_path</b> [no]
              By default, charon keeps SAs on the routing path with addresses it previously used if that path is
              still usable. By setting this option to yes, it tries more aggressively to update SAs with  MOBIKE
              on  routing  priority  changes  using  the  cheapest  path.  This  adds  more noise, but allows to
              dynamically adapt SAs to routing priority changes. This option has no  effect  if  MOBIKE  is  not
              supported or disabled.

       <b>charon.prefer_configured_proposals</b> [yes]
              Prefer  locally configured proposals for IKE/IPsec over supplied ones as responder (disabling this
              can avoid keying retries due to INVALID_KE_PAYLOAD notifies).

       <b>charon.prefer_temporary_addrs</b> [no]
              By default, permanent IPv6 source addresses are preferred over temporary ones (RFC 4941), to  make
              connections more stable. Enable this option to reverse this.

              It  also affects which IPv6 addresses are announced as additional addresses if MOBIKE is used.  If
              the option is disabled, only permanent addresses are sent,  and  only  temporary  ones  if  it  is
              enabled.

       <b>charon.process_route</b> [yes]
              Process RTM_NEWROUTE and RTM_DELROUTE events.

       <b>charon.processor.priority_threads</b>
              Section to configure the number of reserved threads per priority class see JOB PRIORITY MANAGEMENT
              in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

       <b>charon.rdn_matching</b> [strict]
              How RDNs in subject DNs of certificates are matched against configured identities. Possible values
              are  <u>strict</u>  (the default), <u>reordered</u>, and <u>relaxed</u>.  With <u>strict</u> the number, type and order of all
              RDNs has to match, wildcards (*) for the values of RDNs are allowed (that's the case for all three
              variants). Using <u>reordered</u> also matches DNs if the RDNs appear in a different  order,  the  number
              and  type  still  has to match. Finally, <u>relaxed</u> also allows matches of DNs that contain more RDNs
              than the configured identity (missing RDNs are treated like a wildcard match).

              Note that <u>reordered</u> and <u>relaxed</u> impose a considerable overhead on memory  usage  and  runtime,  in
              particular, for mismatches, compared to <u>strict</u>.

       <b>charon.receive_delay</b> [0]
              Delay in ms for receiving packets, to simulate larger RTT.

       <b>charon.receive_delay_request</b> [yes]
              Delay request messages.

       <b>charon.receive_delay_response</b> [yes]
              Delay response messages.

       <b>charon.receive_delay_type</b> [0]
              Specific IKEv2 message type to delay, 0 for any.

       <b>charon.reject_trusted_end_entity</b> [no]
              Reject peers that use trusted end-entity certificates (i.e. local certificates).

       <b>charon.replay_window</b> [32]
              Size of the AH/ESP replay window, in packets.

       <b>charon.reqid_base</b> [1]
              Value of the first reqid to be automatically assigned to a CHILD_SA.

       <b>charon.retransmit_base</b> [1.8]
              Base to use for calculating exponential back off, see IKEv2 RETRANSMISSION in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

       <b>charon.retransmit_jitter</b> [0]
              Maximum jitter in percent to apply randomly to calculated retransmission timeout (0 to disable).

       <b>charon.retransmit_limit</b> [0]
              Upper limit in seconds for calculated retransmission timeout (0 to disable).

       <b>charon.retransmit_timeout</b> [4.0]
              Timeout in seconds before sending first retransmit.

       <b>charon.retransmit_tries</b> [5]
              Number of times to retransmit a packet before giving up.

       <b>charon.retry_initiate_interval</b> [0s]
              Interval  in seconds to use when retrying to initiate an IKE_SA (e.g. if DNS resolution failed), 0
              to disable retries.

       <b>charon.reuse_ikesa</b> [yes]
              Initiate CHILD_SA within existing IKE_SAs (always enabled for IKEv1).

       <b>charon.routing_table</b> []
              Numerical routing table to install routes to.

       <b>charon.routing_table_prio</b> []
              Priority of the routing table.

       <b>charon.rsa_pss</b> [no]
              Whether to use RSA with PSS padding instead of PKCS#1 padding by default.

       <b>charon.rsa_pss_trailerfield</b> [no]
              Whether to encode an explicit trailerField  value  of  0x01  in  the  RSA-PSS  algorithmIdentifier
              (CONTEXT3) or using the DEFAULT value by omitting it.

       <b>charon.send_delay</b> [0]
              Delay in ms for sending packets, to simulate larger RTT.

       <b>charon.send_delay_request</b> [yes]
              Delay request messages.

       <b>charon.send_delay_response</b> [yes]
              Delay response messages.

       <b>charon.send_delay_type</b> [0]
              Specific IKEv2 message type to delay, 0 for any.

       <b>charon.send_vendor_id</b> [no]
              Send strongSwan vendor ID payload

       <b>charon.signature_authentication</b> [yes]
              Whether to enable Signature Authentication as per RFC 7427.

       <b>charon.signature_authentication_constraints</b> [yes]
              If  enabled, signature schemes configured in <u>rightauth</u>, in addition to getting used as constraints
              against signature schemes employed in the certificate chain, are also used as constraints  against
              the signature scheme used by peers during IKEv2.

       <b>charon.spi_label</b> [0x0000000000000000]
              Value mixed into the local IKE SPIs after applying <u>spi_mask</u>.

       <b>charon.spi_mask</b> [0x0000000000000000]
              Mask  applied  to  local  IKE  SPIs  before  mixing  in  <u>spi_label</u> (bits set will be replaced with
              <u>spi_label</u>).

       <b>charon.spi_max</b> [0xcfffffff]
              The upper limit for SPIs requested from the kernel for IPsec SAs.

       <b>charon.spi_min</b> [0xc0000000]
              The lower limit for SPIs requested from the kernel for IPsec SAs. Should not  be  set  lower  than
              0x00000100 (256), as SPIs between 1 and 255 are reserved by IANA.

       <b>charon.start-scripts</b>
              Section containing a list of scripts (name = path) that are executed when the daemon is started.

       <b>charon.stop-scripts</b>
              Section  containing  a  list  of  scripts  (name  =  path)  that  are  executed when the daemon is
              terminated.

       <b>charon.syslog</b>
              Section to define syslog loggers, see LOGGER CONFIGURATION in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

       <b>charon.syslog.&lt;facility&gt;</b>
              &lt;facility&gt;  is  one  of  the  supported   syslog   facilities,   see   LOGGER   CONFIGURATION   in
              <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

       <b>charon.syslog.&lt;facility&gt;.&lt;subsystem&gt;</b> [&lt;default&gt;]
              Loglevel for a specific subsystem.

       <b>charon.syslog.&lt;facility&gt;.default</b> [1]
              Specifies  the  default  loglevel  to  be  used  for  subsystems for which no specific loglevel is
              defined.

       <b>charon.syslog.&lt;facility&gt;.ike_name</b> [no]
              Prefix each log entry with the connection name and a unique numerical identifier for each IKE_SA.

       <b>charon.syslog.&lt;facility&gt;.log_level</b> [no]
              Add the log level of each message after the subsystem (e.g. [IKE2]).

       <b>charon.syslog.&lt;facility&gt;.map_level</b> [-1]
              The default setting of -1 passes all  messages  to  syslog  using  a  log  level  of  LOG_INFO.  A
              non-negative  value  maps the strongSwan specific loglevels (0..4) to the syslog level starting at
              the specified number. For example, a value  of  5  (LOG_NOTICE)  maps  strongSwan  loglevel  0  to
              LOG_NOTICE,  level  1  to  LOG_INFO,  and levels 2, 3 and 4 to LOG_DEBUG. This allows (additional)
              filtering of log messages on the syslog server.

       <b>charon.syslog.identifier</b> []
              Global identifier used for an <b><a href="../man3/openlog.3.html">openlog</a></b>(3) call, prepended to each log message by  syslog.   If  not
              configured,  <b><a href="../man3/openlog.3.html">openlog</a></b>(3)  is  not  called,  so  the value will depend on system defaults (often the
              program name).

       <b>charon.threads</b> [16]
              Number of worker threads in charon. Several of these  are  reserved  for  long  running  tasks  in
              internal modules and plugins. Therefore, make sure you don't set this value too low. The number of
              idle worker threads listed in <u>ipsec</u> <u>statusall</u> might be used as indicator on the number of reserved
              threads.

       <b>charon.tls.cipher</b> []
              List of TLS encryption ciphers.

       <b>charon.tls.ke_group</b> []
              List of TLS key exchange groups.

       <b>charon.tls.key_exchange</b> []
              List of TLS key exchange methods.

       <b>charon.tls.mac</b> []
              List of TLS MAC algorithms.

       <b>charon.tls.send_certreq_authorities</b> [yes]
              Whether  to include CAs in a server's CertificateRequest message. May be disabled if clients can't
              handle a long list of CAs.

       <b>charon.tls.signature</b> []
              List of TLS signature schemes.

       <b>charon.tls.suites</b> []
              List of TLS cipher suites.

       <b>charon.tls.version_max</b> [1.2]
              Maximum TLS version to negotiate.

       <b>charon.tls.version_min</b> [1.2]
              Minimum TLS version to negotiate.

       <b>charon.tnc.tnc_config</b> [/etc/tnc_config]
              TNC IMC/IMV configuration file.

       <b>charon.user</b> []
              Name of the user the daemon changes to after startup.

       <b>charon.x509.enforce_critical</b> [yes]
              Discard certificates with unsupported or unknown critical extensions.

       <b>charon-nm</b>
              Section with settings specific to the  NetworkManager  backend  `charon-nm`.   Settings  from  the
              `charon`  section are not inherited, but many can be used here as well. Defaults for some settings
              are chosen very deliberately and should only be changed in case of conflicts.

       <b>charon-nm.ca_dir</b> [&lt;default&gt;]
              Directory from which to load CA certificates if no certificate is configured.

       <b>charon-nm.install_virtual_ip_on</b> [lo]
              Interface on which virtual IP addresses are installed. Note that NM also installs the virtual  IPs
              on the XFRM interface.

       <b>charon-nm.mtu</b> [1400]
              MTU for XFRM interfaces created by the NM plugin.

       <b>charon-nm.plugins.kernel-netlink.fwmark</b> [!210]
              Make   packets  with  this  mark  ignore  the  routing  table.  Must  be  the  same  mark  set  in
              charon-nm.plugins.socket-default.fwmark.

       <b>charon-nm.plugins.socket-default.fwmark</b> [210]
              Mark applied to IKE and ESP packets to ignore the routing table and avoid routing loops when using
              XFRM interfaces.

       <b>charon-nm.port</b> [0]
              Source port when sending packets to port 500. Defaults to an ephemeral port. May be set to 500  if
              firewall rules require a static port.

       <b>charon-nm.port_nat_t</b> [0]
              Source  port  when  sending packets to port 4500 or a custom server port. Defaults to an ephemeral
              port. May be set to e.g. 4500 if firewall rules require a static port.

       <b>charon-nm.retransmit_base</b> [1.4]
              Base to use for calculating exponential back off, see IKEv2 RETRANSMISSION in  <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).
              Default  retransmission  settings  for  charon-nm  are  deliberately  lower  to  fail and possibly
              reestablish SAs more quickly.

       <b>charon-nm.retransmit_timeout</b> [2.0]
              Timeout in seconds before sending first retransmit.

       <b>charon-nm.retransmit_tries</b> [3]
              Number of times to retransmit a packet before giving up.

       <b>charon-nm.routing_table</b> [210]
              Table where routes via XFRM interface are installed. Should be different than the table  used  for
              the regular IKE daemon due to the mark.

       <b>charon-nm.routing_table_prio</b> [210]
              Priority of the routing table. Higher than the default priority used for the regular IKE daemon.

       <b>charon-nm.syslog.daemon.default</b> [1]
              Default to logging via syslog's daemon facility on level 1.

       <b>charon-systemd.journal</b>
              Section to configure native systemd journal logger, very similar to the syslog logger as described
              in LOGGER CONFIGURATION in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

       <b>charon-systemd.journal.&lt;subsystem&gt;</b> [&lt;default&gt;]
              Loglevel for a specific subsystem.

       <b>charon-systemd.journal.default</b> [1]
              Specifies  the  default  loglevel  to  be  used  for  subsystems for which no specific loglevel is
              defined.

       <b>imv_policy_manager.command_allow</b> []
              Shell command to be executed with recommendation allow.

       <b>imv_policy_manager.command_block</b> []
              Shell command to be executed with all other recommendations.

       <b>imv_policy_manager.database</b> []
              Database URI for the database that stores the package information. If it contains a password, make
              sure to adjust the permissions of the config file accordingly.

       <b>imv_policy_manager.load</b> [sqlite]
              Plugins to load in IMV policy manager.

       <b>libimcv.debug_level</b> [1]
              Debug level for a stand-alone <u>libimcv</u> library.

       <b>libimcv.load</b> [random nonce gmp pubkey x509]
              Plugins to load in IMC/IMVs with stand-alone <u>libimcv</u> library.

       <b>libimcv.plugins.imc-attestation.aik_blob</b> []
              AIK encrypted private key blob file.

       <b>libimcv.plugins.imc-attestation.aik_cert</b> []
              AIK certificate file.

       <b>libimcv.plugins.imc-attestation.aik_handle</b> []
              AIK object handle.

       <b>libimcv.plugins.imc-attestation.aik_pubkey</b> []
              AIK public key file.

       <b>libimcv.plugins.imc-attestation.hash_algorithm</b> [sha384]
              Preferred measurement hash algorithm.

       <b>libimcv.plugins.imc-attestation.mandatory_dh_groups</b> [yes]
              Enforce mandatory Diffie-Hellman groups.

       <b>libimcv.plugins.imc-attestation.nonce_len</b> [20]
              DH nonce length.

       <b>libimcv.plugins.imc-attestation.pcr17_after</b> []
              PCR17 value after measurement.

       <b>libimcv.plugins.imc-attestation.pcr17_before</b> []
              PCR17 value before measurement.

       <b>libimcv.plugins.imc-attestation.pcr17_meas</b> []
              Dummy measurement value extended into PCR17 if the TBOOT log is not available.

       <b>libimcv.plugins.imc-attestation.pcr18_after</b> []
              PCR18 value after measurement.

       <b>libimcv.plugins.imc-attestation.pcr18_before</b> []
              PCR18 value before measurement.

       <b>libimcv.plugins.imc-attestation.pcr18_meas</b> []
              Dummy measurement value extended into PCR17 if the TBOOT log is not available.

       <b>libimcv.plugins.imc-attestation.pcr_info</b> [no]
              Whether to send pcr_before and pcr_after info.

       <b>libimcv.plugins.imc-attestation.pcr_padding</b> [no]
              Whether to pad IMA SHA1 measurements values when extending into SHA256 PCR bank.

       <b>libimcv.plugins.imc-attestation.use_quote2</b> [yes]
              Use Quote2 AIK signature instead of Quote signature.

       <b>libimcv.plugins.imc-attestation.use_version_info</b> [no]
              Version Info is included in Quote2 signature.

       <b>libimcv.plugins.imc-hcd.push_info</b> [yes]
              Send quadruple info without being prompted.

       <b>libimcv.plugins.imc-hcd.subtypes</b> []
              Section to define PWG HCD PA subtypes.

       <b>libimcv.plugins.imc-hcd.subtypes.&lt;section&gt;</b> []
              Defines a PWG HCD PA subtype section.  Recognized  subtype  section  names  are  <u>system</u>,  <u>control</u>,
              <u>marker</u>, <u>finisher</u>, <u>interface</u> and <u>scanner</u>.

       <b>libimcv.plugins.imc-hcd.subtypes.&lt;section&gt;.&lt;sw_type&gt;</b> []
              Defines   a   software  type  section.  Recognized  software  type  section  names  are  <u>firmware</u>,
              <u>resident_application</u> and <u>user_application</u>.

       <b>libimcv.plugins.imc-hcd.subtypes.&lt;section&gt;.&lt;sw_type&gt;.&lt;software&gt;</b> []
              Defines a software section having an arbitrary name.

       <b>libimcv.plugins.imc-hcd.subtypes.&lt;section&gt;.&lt;sw_type&gt;.&lt;software&gt;.name</b> []
              Name of the software installed on the hardcopy device.

       <b>libimcv.plugins.imc-hcd.subtypes.&lt;section&gt;.&lt;sw_type&gt;.&lt;software&gt;.patches</b> []
              String describing all patches  applied  to  the  given  software  on  this  hardcopy  device.  The
              individual patches are separated by a newline character '\n'.

       <b>libimcv.plugins.imc-hcd.subtypes.&lt;section&gt;.&lt;sw_type&gt;.&lt;software&gt;.string_version</b> []
              String describing the version of the given software on this hardcopy device.

       <b>libimcv.plugins.imc-hcd.subtypes.&lt;section&gt;.&lt;sw_type&gt;.&lt;software&gt;.version</b> []
              Hex-encoded  version  string  with  a  length  of 16 octets consisting of the fields major version
              number (4 octets), minor version number (4 octets), build number (4 octets),  service  pack  major
              number (2 octets) and service pack minor number (2 octets).

       <b>libimcv.plugins.imc-hcd.subtypes.&lt;section&gt;.attributes_natural_language</b> [en]
              Variable  length  natural language tag conforming to RFC 5646 specifies the language to be used in
              the health assessment message of a given subtype.

       <b>libimcv.plugins.imc-hcd.subtypes.system.certification_state</b> []
              Hex-encoded certification state.

       <b>libimcv.plugins.imc-hcd.subtypes.system.configuration_state</b> []
              Hex-encoded configuration state.

       <b>libimcv.plugins.imc-hcd.subtypes.system.machine_type_model</b> []
              String specifying the machine type and model of the hardcopy device.

       <b>libimcv.plugins.imc-hcd.subtypes.system.pstn_fax_enabled</b> [no]
              Specifies if a PSTN facsimile interface is installed and enabled on the hardcopy device.

       <b>libimcv.plugins.imc-hcd.subtypes.system.time_source</b> []
              String specifying the hostname of the network time server used by the hardcopy device.

       <b>libimcv.plugins.imc-hcd.subtypes.system.user_application_enabled</b> [no]
              Specifies if users can dynamically download and execute applications on the hardcopy device.

       <b>libimcv.plugins.imc-hcd.subtypes.system.user_application_persistence_enabled</b> [no]
              Specifies if user dynamically downloaded applications can persist  outside  the  boundaries  of  a
              single job on the hardcopy device.

       <b>libimcv.plugins.imc-hcd.subtypes.system.vendor_name</b> []
              String specifying the manufacturer of the hardcopy device.

       <b>libimcv.plugins.imc-hcd.subtypes.system.vendor_smi_code</b> []
              Integer  specifying  the  globally  unique  24-bit  SMI  code  assigned to the manufacturer of the
              hardcopy device.

       <b>libimcv.plugins.imc-os.device_cert</b> []
              Manually set the path to the client device certificate (e.g.  /etc/pts/aikCert.der)

       <b>libimcv.plugins.imc-os.device_handle</b> []
              Manually set handle to a private key bound to a smartcard or TPM (e.g.  0x81010004)

       <b>libimcv.plugins.imc-os.device_id</b> []
              Manually     set     the     client     device     ID     in     hexadecimal     format      (e.g.
              1083f03988c9762703b1c1080c2e46f72b99cc31)

       <b>libimcv.plugins.imc-os.device_pubkey</b> []
              Manually set the path to the client device public key (e.g. /etc/pts/aikPub.der)

       <b>libimcv.plugins.imc-os.push_info</b> [yes]
              Send operating system info without being prompted.

       <b>libimcv.plugins.imc-scanner.push_info</b> [yes]
              Send open listening ports without being prompted.

       <b>libimcv.plugins.imc-swima.eid_epoch</b> [0x11223344]
              Set 32 bit epoch value for event IDs manually if software collector database is not available.

       <b>libimcv.plugins.imc-swima.subscriptions</b> [no]
              Accept SW Inventory or SW Events subscriptions.

       <b>libimcv.plugins.imc-swima.swid_database</b> []
              URI  to  software  collector  database containing event timestamps, software creation and deletion
              events and collected software identifiers. If it contains a password,  make  sure  to  adjust  the
              permissions of the config file accordingly.

       <b>libimcv.plugins.imc-swima.swid_directory</b> [${prefix}/share]
              Directory where SWID tags are located.

       <b>libimcv.plugins.imc-swima.swid_full</b> [no]
              Include file information in the XML-encoded SWID tags.

       <b>libimcv.plugins.imc-swima.swid_pretty</b> [no]
              Generate XML-encoded SWID tags with pretty indentation.

       <b>libimcv.plugins.imc-test.additional_ids</b> [0]
              Number of additional IMC IDs.

       <b>libimcv.plugins.imc-test.command</b> [none]
              Command to be sent to the Test IMV.

       <b>libimcv.plugins.imc-test.dummy_size</b> [0]
              Size of dummy attribute to be sent to the Test IMV (0 = disabled).

       <b>libimcv.plugins.imc-test.retry</b> [no]
              Do a handshake retry.

       <b>libimcv.plugins.imc-test.retry_command</b> []
              Command to be sent to the Test IMV in the handshake retry.

       <b>libimcv.plugins.imv-attestation.cadir</b> []
              Path to directory with AIK cacerts.

       <b>libimcv.plugins.imv-attestation.dh_group</b> [ecp256]
              Preferred Diffie-Hellman group.

       <b>libimcv.plugins.imv-attestation.hash_algorithm</b> [sha384]
              Preferred measurement hash algorithm.

       <b>libimcv.plugins.imv-attestation.mandatory_dh_groups</b> [yes]
              Enforce mandatory Diffie-Hellman groups.

       <b>libimcv.plugins.imv-attestation.min_nonce_len</b> [0]
              DH minimum nonce length.

       <b>libimcv.plugins.imv-os.remediation_uri</b> []
              URI pointing to operating system remediation instructions.

       <b>libimcv.plugins.imv-scanner.remediation_uri</b> []
              URI pointing to scanner remediation instructions.

       <b>libimcv.plugins.imv-swima.rest_api.timeout</b> [120]
              Timeout of SWID REST API HTTP POST transaction.

       <b>libimcv.plugins.imv-swima.rest_api.uri</b> []
              HTTP URI of the SWID REST API.

       <b>libimcv.plugins.imv-test.rounds</b> [0]
              Number of IMC-IMV retry rounds.

       <b>libimcv.stderr_quiet</b> [no]
              Disable output to stderr with a stand-alone <u>libimcv</u> library.

       <b>libimcv.swid_gen.command</b> [/usr/local/bin/swid_generator]
              SWID generator command to be executed.

       <b>libimcv.swid_gen.tag_creator.name</b> [strongSwan Project]
              Name of the tagCreator entity.

       <b>libimcv.swid_gen.tag_creator.regid</b> [strongswan.org]
              regid of the tagCreator entity.

       <b>manager.database</b> []
              Credential  database  URI  for  manager.  If  it  contains  a  password,  make  sure to adjust the
              permissions of the config file accordingly.

       <b>manager.debug</b> [no]
              Enable debugging in manager.

       <b>manager.load</b> []
              Plugins to load in manager.

       <b>manager.socket</b> []
              FastCGI socket of manager, to run it statically.

       <b>manager.threads</b> [10]
              Threads to use for request handling.

       <b>manager.timeout</b> [15m]
              Session timeout for manager.

       <b>medsrv.database</b> []
              Mediation server database URI. If it contains a password, make sure to adjust the  permissions  of
              the config file accordingly.

       <b>medsrv.debug</b> [no]
              Debugging in mediation server web application.

       <b>medsrv.dpd</b> [5m]
              DPD timeout to use in mediation server plugin.

       <b>medsrv.load</b> []
              Plugins to load in mediation server plugin.

       <b>medsrv.password_length</b> [6]
              Minimum password length required for mediation server user accounts.

       <b>medsrv.rekey</b> [20m]
              Rekeying time on mediation connections in mediation server plugin.

       <b>medsrv.socket</b> []
              Run Mediation server web application statically on socket.

       <b>medsrv.threads</b> [5]
              Number of thread for mediation service web application.

       <b>medsrv.timeout</b> [15m]
              Session timeout for mediation service.

       <b>pki.load</b> []
              Plugins to load in the pki tool.

       <b>pki.scep.http_bind</b> []
              Source IP address to bind for HTTP operations.

       <b>pki.scep.http_timeout</b> [30s]
              Timeout for HTTP operations.

       <b>pki.scep.renewal_via_pkcs_req</b> [no]
              Some  SCEP  servers  (e.g.  openxpki)  are  incorrectly  doing certificate renewal via messageType
              PKCSReq (19) instead of RenewalReq (17).

       <b>pool.database</b> []
              Database URI for the database that stores IP pools and configuration attributes.  If it contains a
              password, make        sure to adjust the permissions of the config file accordingly.

       <b>pool.load</b> []
              Plugins to load in ipsec pool tool.

       <b>sec-updater</b>
              Options for the sec-updater tool.

       <b>sec-updater.database</b> []
              Global IMV policy database URI. If it contains a password, make sure to adjust the permissions  of
              the config file accordingly.

       <b>sec-updater.load</b> []
              Plugins to load in sec-updater tool.

       <b>sec-updater.swid_gen.command</b> [/usr/local/bin/swid_generator]
              SWID generator command to be executed.

       <b>sec-updater.swid_gen.tag_creator.name</b> [strongSwan Project]
              Name of the tagCreator entity.

       <b>sec-updater.swid_gen.tag_creator.regid</b> [strongswan.org]
              regid of the tagCreator entity.

       <b>sec-updater.tmp.deb_file</b> [/tmp/sec-updater.deb]
              Temporary storage for downloaded deb package file.

       <b>sec-updater.tmp.tag_file</b> [/tmp/sec-updater.tag]
              Temporary storage for generated SWID tags.

       <b>sec-updater.tnc_manage_command</b> [/var/www/tnc/manage.py]
              strongTNC manage.py command used to import SWID tags.

       <b>starter.config_file</b> [${sysconfdir}/ipsec.conf]
              Location of the ipsec.conf file

       <b>starter.load_warning</b> [yes]
              Disable charon plugin load option warning.

       <b>sw-collector</b>
              Options for the sw-collector tool.

       <b>sw-collector.database</b> []
              URI  to  software  collector  database containing event timestamps, software creation and deletion
              events and collected software identifiers. If it contains a password,  make  sure  to  adjust  the
              permissions of the config file accordingly.

       <b>sw-collector.first_file</b> [/var/log/bootstrap.log]
              Path pointing to file created when the Linux OS was installed.

       <b>sw-collector.first_time</b> [0000-00-00T00:00:00Z]
              Time in UTC when the Linux OS was installed.

       <b>sw-collector.history</b> []
              Path pointing to apt history.log file.

       <b>sw-collector.load</b> []
              Plugins to load in sw-collector tool.

       <b>sw-collector.rest_api.timeout</b> [120]
              Timeout of REST API HTTP POST transaction.

       <b>sw-collector.rest_api.uri</b> []
              HTTP URI of the central collector's REST API.

       <b>swanctl.load</b> []
              Plugins to load in swanctl.

       <b>swanctl.socket</b> [unix://${piddir}/charon.vici]
              VICI socket to connect to by default.

</pre><h4><b>LOGGER</b> <b>CONFIGURATION</b></h4><pre>
       Options  in  <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5)  provide a much more flexible way to configure loggers for the IKE daemon
       charon than using the <b>charondebug</b> option in <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5).

       <b>Note</b>: If any loggers are specified in strongswan.conf, <b>charondebug</b> does not have any effect.

       There are currently two types of loggers:

       <b>File</b> <b>loggers</b>
              Log directly to a file and are defined by  specifying  an  arbitrarily  named  subsection  in  the
              <b>charon.filelog</b>  section.  The  full  path  to  the  file is configured in the <u>path</u> setting of that
              subsection, however, if it only contains characters permitted in section names,  the  setting  may
              also  be  omitted  and the path specified as name of the subsection. To log to the console the two
              special filenames <b>stdout</b> and <b>stderr</b> may be used.

       <b>Syslog</b> <b>loggers</b>
              Log into a syslog facility and are defined by specifying the facility to log to as the name  of  a
              subsection  in the <b>charon.syslog</b> section. The following facilities are currently supported: <b>daemon</b>
              and <b>auth</b>.

       Multiple loggers can be defined for each type with different log verbosity for the  different  subsystems
       of the daemon.

   <b>Subsystems</b>
       <b>dmn</b>    Main daemon setup/cleanup/signal handling

       <b>mgr</b>    IKE_SA manager, handling synchronization for IKE_SA access

       <b>ike</b>    IKE_SA

       <b>chd</b>    CHILD_SA

       <b>job</b>    Jobs queueing/processing and thread pool management

       <b>cfg</b>    Configuration management and plugins

       <b>knl</b>    IPsec/Networking kernel interface

       <b>net</b>    IKE network communication

       <b>asn</b>    Low-level encoding/decoding (ASN.1, X.509 etc.)

       <b>enc</b>    Packet encoding/decoding encryption/decryption operations

       <b>tls</b>    libtls library messages

       <b>esp</b>    libipsec library messages

       <b>lib</b>    libstrongswan library messages

       <b>tnc</b>    Trusted Network Connect

       <b>imc</b>    Integrity Measurement Collector

       <b>imv</b>    Integrity Measurement Verifier

       <b>pts</b>    Platform Trust Service

   <b>Loglevels</b>
       <b>-1</b>     Absolutely silent

       <b>0</b>      Very basic auditing logs, (e.g. SA up/SA down)

       <b>1</b>      Generic control flow with errors, a good default to see what's going on

       <b>2</b>      More detailed debugging control flow

       <b>3</b>      Including RAW data dumps in Hex

       <b>4</b>      Also include sensitive material in dumps, e.g. keys

   <b>Example</b>
            charon {
                 filelog {
                      charon {
                           path = /var/log/charon.log
                           time_format = %b %e %T
                           append = no
                           default = 1
                      }
                      stderr {
                           ike = 2
                           knl = 3
                           ike_name = yes
                      }
                 }
                 syslog {
                      # enable logging to LOG_DAEMON, use defaults
                      daemon {
                      }
                      # minimalistic IKE auditing logging to LOG_AUTHPRIV
                      auth {
                           default = -1
                           ike = 0
                      }
                 }
            }

</pre><h4><b>JOB</b> <b>PRIORITY</b> <b>MANAGEMENT</b></h4><pre>
       Some  operations  in  the  IKEv2  daemon charon are currently implemented synchronously and blocking. Two
       examples for such operations are communication with a RADIUS server via EAP-RADIUS, or fetching  CRL/OCSP
       information  during  certificate  chain verification. Under high load conditions, the thread pool may run
       out of available threads, and some more important jobs, such as liveness checking, may not  get  executed
       in time.

       To  prevent  thread starvation in such situations job priorities were introduced.  The job processor will
       reserve some threads for higher priority jobs, these  threads  are  not  available  for  lower  priority,
       locking jobs.

   <b>Implementation</b>
       Currently 4 priorities have been defined, and they are used in charon as follows:

       <b>CRITICAL</b>
              Priority for long-running dispatcher jobs.

       <b>HIGH</b>   INFORMATIONAL exchanges, as used by liveness checking (DPD).

       <b>MEDIUM</b> Everything not HIGH/LOW, including IKE_SA_INIT processing.

       <b>LOW</b>    IKE_AUTH message processing. RADIUS and CRL fetching block here

       Although  IKE_SA_INIT  processing  is  computationally expensive, it is explicitly assigned to the MEDIUM
       class. This allows charon to do the DH exchange while other threads are blocked in IKE_AUTH.  To  prevent
       the daemon from accepting more IKE_SA_INIT requests than it can handle, use IKE_SA_INIT DROPPING.

       The  thread  pool  processes  jobs strictly by priority, meaning it will consume all higher priority jobs
       before looking for ones with lower priority. Further, it  reserves  threads  for  certain  priorities.  A
       priority  class  having  reserved  <u>n</u>  threads will always have <u>n</u> threads available for this class (either
       currently processing a job, or waiting for one).

   <b>Configuration</b>
       To ensure that there are always enough threads available for  higher  priority  tasks,  threads  must  be
       reserved for each priority class.

       <b>charon.processor.priority_threads.critical</b> [0]
              Threads reserved for CRITICAL priority class jobs

       <b>charon.processor.priority_threads.high</b> [0]
              Threads reserved for HIGH priority class jobs

       <b>charon.processor.priority_threads.medium</b> [0]
              Threads reserved for MEDIUM priority class jobs

       <b>charon.processor.priority_threads.low</b> [0]
              Threads reserved for LOW priority class jobs

       Let's consider the following configuration:

            charon {
                 processor {
                      priority_threads {
                           high = 1
                           medium = 4
                      }
                 }
            }

       With  this  configuration,  one  thread  is  reserved for HIGH priority tasks. As currently only liveness
       checking and stroke message processing is  done  with  high  priority,  one  or  two  threads  should  be
       sufficient.

       The  MEDIUM  class  mostly  processes non-blocking jobs. Unless your setup is experiencing many blocks in
       locks while accessing shared resources, threads for one or two times the number of CPU cores is fine.

       It is usually not required to reserve threads for CRITICAL jobs. Jobs in this class rarely return and  do
       not release their thread to the pool.

       The  remaining  threads are available for LOW priority jobs. Reserving threads does not make sense (until
       we have an even lower priority).

   <b>Monitoring</b>
       To see what the threads are actually doing, invoke <u>ipsec</u> <u>statusall</u>.  Under high load, something like this
       will show up:

            worker threads: 2 or 32 idle, 5/1/2/22 working,
                 job queue: 0/0/1/149, scheduled: 198

       From 32 worker threads,

       2      are currently idle.

       5      are running CRITICAL priority jobs (dispatching from sockets, etc.).

       1      is currently handling a HIGH priority job. This is actually the thread  currently  providing  this
              information via stroke.

       2      are handling MEDIUM priority jobs, likely IKE_SA_INIT or CREATE_CHILD_SA messages.

       22     are  handling  LOW  priority  jobs,  probably  waiting for an EAP-RADIUS response while processing
              IKE_AUTH messages.

       The job queue load shows how many jobs are queued for each priority,  ready  for  execution.  The  single
       MEDIUM priority job will get executed immediately, as we have two spare threads reserved for MEDIUM class
       jobs.

</pre><h4><b>IKE_SA_INIT</b> <b>DROPPING</b></h4><pre>
       If  a  responder receives more connection requests per seconds than it can handle, it does not make sense
       to accept more IKE_SA_INIT messages. And if they are queued but can't get processed in  time,  an  answer
       might be sent after the client has already given up and restarted its connection setup. This additionally
       increases the load on the responder.

       To  limit  the  responder  load  resulting  from new connection attempts, the daemon can drop IKE_SA_INIT
       messages just after reception. There are two mechanisms to decide if this should happen, configured  with
       the following options:

       <b>charon.init_limit_half_open</b> [0]
              Limit based on the number of half open IKE_SAs. Half open IKE_SAs are SAs in connecting state, but
              not yet established.

       <b>charon.init_limit_job_load</b> [0]
              Limit based on the number of jobs currently queued for processing (sum over all job priorities).

       The  second limit includes load from other jobs, such as rekeying. Choosing a good value is difficult and
       depends on the hardware and expected load.

       The first limit is simpler to calculate, but includes  the  load  from  new  connections  only.  If  your
       responder is capable of negotiating 100 tunnels/s, you might set this limit to 1000. The daemon will then
       drop  new  connection  attempts  if  generating a response would require more than 10 seconds. If you are
       allowing for a maximum response time of  more  than  30  seconds,  consider  adjusting  the  timeout  for
       connecting  IKE_SAs  (<b>charon.half_open_timeout</b>).   A  responder,  by  default,  deletes  an IKE_SA if the
       initiator does not establish it within 30 seconds. Under high load, a higher value might be required.

</pre><h4><b>LOAD</b> <b>TESTS</b></h4><pre>
       To do stability testing and performance optimizations, the IKE daemon  charon  provides  the  <u>load-tester</u>
       plugin.  This plugin allows one to setup thousands of tunnels concurrently against the daemon itself or a
       remote host.

       <b>WARNING:</b>  Never  enable  the  load-testing  plugin  on  productive  systems.  It  provides  preconfigured
       credentials and allows an attacker to authenticate as any user.

   <b>Configuration</b> <b>details</b>
       For  public key authentication, the responder uses the <b>"CN=srv,</b> <b>OU=load-test,</b> <b>O=strongSwan"</b> identity. For
       the initiator, each connection attempt uses a different identity in  the  form  <b>"CN=c1-r1,</b>  <b>OU=load-test,</b>
       <b>O=strongSwan"</b>,  where  the  first number indicates the client number, the second the authentication round
       (if multiple authentication rounds are used).

       For PSK authentication, FQDN identities are used. The server uses <b>srv.strongswan.org</b>, the client uses  an
       identity in the form <b>c1-r1.strongswan.org</b>.

       For EAP authentication, the client uses a NAI in the form <b><a href="mailto:100000000010001@strongswan.org">100000000010001@strongswan.org</a></b>.

       To configure multiple authentication rounds, concatenate multiple methods using, e.g.
            initiator_auth = pubkey|psk|eap-md5|eap-aka

       The  responder  uses  a hardcoded certificate based on a 1024-bit RSA key.  This certificate additionally
       serves as CA certificate. A peer uses the same private key, but generates client certificates  on  demand
       signed by the CA certificate. Install the Responder/CA certificate on the remote host to authenticate all
       clients.

       To  speed  up  testing,  the load tester plugin implements a special Diffie-Hellman implementation called
       <u>modpnull</u>. By setting
            proposal = aes128-sha1-modpnull
       this wicked fast DH implementation is used. It does not provide any security at all, but  allows  one  to
       run tests without DH calculation overhead.

   <b>Examples</b>
       In the simplest case, the daemon initiates IKE_SAs against itself using the loopback interface. This will
       actually establish double the number of IKE_SAs, as the daemon is initiator and responder for each IKE_SA
       at the same time.  Installation of IPsec SAs would fail, as each SA gets installed twice. To simulate the
       correct  behavior,  a  fake  kernel  interface can be enabled which does not install the IPsec SAs at the
       kernel level.

       A simple loopback configuration might look like this:

            charon {
                 # create new IKE_SAs for each CHILD_SA to simulate
                 # different clients
                 reuse_ikesa = no
                 # turn off denial of service protection
                 dos_protection = no

                 plugins {
                      load-tester {
                           # enable the plugin
                           enable = yes
                           # use 4 threads to initiate connections
                           # simultaneously
                           initiators = 4
                           # each thread initiates 1000 connections
                           iterations = 1000
                           # delay each initiation in each thread by 20ms
                           delay = 20
                           # enable the fake kernel interface to
                           # avoid SA conflicts
                           fake_kernel = yes
                      }
                 }
            }

       This will initiate 4000 IKE_SAs within 20 seconds. You may increase the delay value if your box  can  not
       handle  that  much  load,  or  decrease  it  to  put more load on it. If the daemon starts retransmitting
       messages your box probably can not handle all connection attempts.

       The plugin also allows one to test against a remote host. This might help to test against  a  real  world
       configuration. A connection setup to do stress testing of a gateway might look like this:

            charon {
                 reuse_ikesa = no
                 threads = 32

                 plugins {
                      load-tester {
                           enable = yes
                           # 10000 connections, ten in parallel
                           initiators = 10
                           iterations = 1000
                           # use a delay of 100ms, overall time is:
                           # iterations * delay = 100s
                           delay = 100
                           # address of the gateway
                           remote = 1.2.3.4
                           # IKE-proposal to use
                           proposal = aes128-sha1-modp1024
                           # use faster PSK authentication instead
                           # of 1024bit RSA
                           initiator_auth = psk
                           responder_auth = psk
                           # request a virtual IP using configuration
                           # payloads
                           request_virtual_ip = yes
                           # enable CHILD_SA every 60s
                           child_rekey = 60
                      }
                 }
            }

</pre><h4><b>IKEv2</b> <b>RETRANSMISSION</b></h4><pre>
       Retransmission timeouts in the IKEv2 daemon charon can be configured globally using the three keys listed
       below:

              <b>charon.retransmit_base</b> [1.8]
              <b>charon.retransmit_timeout</b> [4.0]
              <b>charon.retransmit_tries</b> [5]
              <b>charon.retransmit_jitter</b> [0]
              <b>charon.retransmit_limit</b> [0]

       The following algorithm is used to calculate the timeout:

            relative timeout = retransmit_timeout * retransmit_base ^ (n-1)

       Where  <u>n</u>  is  the  current  retransmission  count.  The  calculated  timeout  can't exceed the configured
       retransmit_limit (if any), which is useful if the number of retries is high.

       If a jitter in percent is configured, the timeout is modified as follows:

            relative timeout -= random(0, retransmit_jitter * relative timeout)

       Using the default values, packets are retransmitted in:

       Retransmission   Relative Timeout   Absolute Timeout
       ─────────────────────────────────────────────────────
       <b>1</b>                              4s                 4s
       <b>2</b>                              7s                11s
       <b>3</b>                             13s                24s
       <b>4</b>                             23s                47s
       <b>5</b>                             42s                89s
       <b>giving</b> <b>up</b>                     76s               165s

</pre><h4><b>VARIABLES</b></h4><pre>
       The variables used above are configured as follows:

       ${piddir}               <a href="file:/var/run">/var/run</a>
       ${prefix}               <a href="file:/usr">/usr</a>
       ${sysconfdir}           <a href="file:/etc">/etc</a>
       ${random_device}        /dev/random
       ${urandom_device}       /dev/urandom

</pre><h4><b>FILES</b></h4><pre>
       /etc/strongswan.conf       configuration file
       /etc/strongswan.d/         directory containing included config snippets
       /etc/strongswan.d/charon/  plugin specific config snippets

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/swanctl.conf.5.html">swanctl.conf</a></b>(5), <b><a href="../man8/swanctl.8.html">swanctl</a></b>(8), <b><a href="../man5/ipsec.conf.5.html">ipsec.conf</a></b>(5), <b><a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a></b>(5), <b><a href="../man8/ipsec.8.html">ipsec</a></b>(8), <b><a href="../man8/charon-cmd.8.html">charon-cmd</a></b>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       Written for the strongSwan project by Tobias Brunner, Andreas Steffen and Martin Willi.

6.0.1                                                                                         <u><a href="../man5/STRONGSWAN.CONF.5.html">STRONGSWAN.CONF</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>