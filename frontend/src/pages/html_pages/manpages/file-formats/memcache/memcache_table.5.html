<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>memcache_table - Postfix memcache client configuration</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/postfix">postfix_3.10.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       memcache_table - Postfix memcache client configuration

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>postmap</b> <b>-q</b> <b>"</b><u>string</u><b>"</b> <b>memcache:/etc/postfix/</b><u>filename</u>

       <b>postmap</b> <b>-q</b> <b>-</b> <b>memcache:/etc/postfix/</b><u>filename</u> <b>&lt;</b><u>inputfile</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  Postfix  mail  system  uses  optional tables for address rewriting or mail routing. These tables are
       usually in <b>dbm</b> or <b>db</b> format.

       Alternatively, lookup tables can be specified as memcache instances.  To use memcache lookups,  define  a
       memcache source as a lookup table in main.cf, for example:

           virtual_alias_maps = memcache:/etc/postfix/memcache-aliases.cf

       The  file /etc/postfix/memcache-aliases.cf has the same format as the Postfix main.cf file, and specifies
       the parameters described below.

       The Postfix memcache client supports the lookup, update, delete and sequence (first/next) operations. The
       sequence operation requires a backup database that supports the operation.

</pre><h4><b>MEMCACHE</b> <b>MAIN</b> <b>PARAMETERS</b></h4><pre>
       <b>memcache</b> <b>(default:</b> <b>inet:localhost:11211)</b>
              The memcache server (note: singular) that Postfix will try  to  connect  to.   For  a  TCP  server
              specify  "inet:"  followed  by  a hostname or address, ":", and a port name or number.  Specify an
              IPv6 address inside "[]".  For a  UNIX-domain  server  specify  "unix:"  followed  by  the  socket
              pathname. Examples:

                  memcache = inet:memcache.example.com:11211
                  memcache = inet:127.0.0.1:11211
                  memcache = inet:[fc00:8d00:189::3]:11211
                  memcache = unix:/path/to/socket

              NOTE: to access a UNIX-domain socket with the <a href="../man8/proxymap.8.html">proxymap</a>(8) server, the socket must be accessible by
              the unprivileged postfix user.

       <b>backup</b> <b>(default:</b> <b>undefined)</b>
              An  optional  Postfix  database  that  provides  persistent  backup for the memcache database. The
              Postfix memcache client will update  the  memcache  database  whenever  it  looks  up  or  changes
              information in the persistent database. Specify a Postfix "type:table" database. Examples:

                  # Non-shared postscreen cache.
                  backup = btree:/var/lib/postfix/postscreen_cache_map

                  # Shared postscreen cache for processes on the same host.
                  backup = proxy:btree:/var/lib/postfix/postscreen_cache_map

              Access to remote proxymap servers is under development.

              NOTE  1:  When  sharing  a  persistent  <b><a href="../man8/postscreen.8.html">postscreen</a></b>(8)  or <b><a href="../man8/verify.8.html">verify</a></b>(8) cache, disable automatic cache
              cleanup (set *_cache_cleanup_interval  =  0)  except  with  one  Postfix  instance  that  will  be
              responsible for cache cleanup.

              NOTE  2:  When  multiple  tables  share  the  same  memcache  database,  each table should use the
              <b>key_format</b> feature (see below) to prepend its own unique string to  the  lookup  key.   Otherwise,
              automatic <b><a href="../man8/postscreen.8.html">postscreen</a></b>(8) or <b><a href="../man8/verify.8.html">verify</a></b>(8) cache cleanup may not work.

              NOTE  3: When the backup database is accessed with "proxy:" lookups, the full backup database name
              (including the "proxy:" prefix) must be specified in  the  proxymap  server's  proxy_read_maps  or
              proxy_write_maps setting (depending on whether the access is read-only or read-write).

       <b>flags</b> <b>(default:</b> <b>0)</b>
              Optional  flags  that  should  be  stored along with a memcache update. The flags are ignored when
              looking up information.

       <b>ttl</b> <b>(default:</b> <b>3600)</b>
              The expiration time in seconds of memcache updates.

              NOTE 1: When using a memcache table as <b><a href="../man8/postscreen.8.html">postscreen</a></b>(8) or <b><a href="../man8/verify.8.html">verify</a></b>(8) cache without persistent backup,
              specify a zero *_cache_cleanup_interval value with all Postfix instances that  use  the  memcache,
              and specify the largest <b><a href="../man8/postscreen.8.html">postscreen</a></b>(8) *_ttl value or <b><a href="../man8/verify.8.html">verify</a></b>(8) *_expire_time value as the memcache
              table's <b>ttl</b> value.

              NOTE  2:  According  to  memcache  protocol  documentation,  a value greater than 30 days (2592000
              seconds) specifies absolute UNIX time. Smaller values are relative to the time of the update.

</pre><h4><b>MEMCACHE</b> <b>KEY</b> <b>PARAMETERS</b></h4><pre>
       <b>key_format</b> <b>(default:</b> <b>%s)</b>
              Format of the lookup and update keys that the  Postfix  memcache  client  sends  to  the  memcache
              server.   By  default,  these  are the same as the lookup and update keys that the memcache client
              receives from Postfix applications.

              NOTE 1: The <b>key_format</b> feature is not used for <b>backup</b> database requests.

              NOTE 2: When multiple tables share the same memcache database, each table should prepend  its  own
              unique  string  to  the lookup key.  Otherwise, automatic <b><a href="../man8/postscreen.8.html">postscreen</a></b>(8) or <b><a href="../man8/verify.8.html">verify</a></b>(8) cache cleanup
              may not work.

              Examples:

                  key_format = aliases:%s
                  key_format = verify:%s
                  key_format = postscreen:%s

              The <b>key_format</b> parameter supports the following '%' expansions:

              <b>%%</b>     This is replaced by a literal '%' character.

              <b>%s</b>     This is replaced by the memcache client input key.

              <b>%u</b>     When the input key is an address of the form user@domain, <b>%u</b> is replaced by the SQL  quoted
                     local  part of the address.  Otherwise, <b>%u</b> is replaced by the entire search string.  If the
                     localpart is empty, a lookup is silently suppressed and returns no results  (an  update  is
                     skipped with a warning).

              <b>%d</b>     When the input key is an address of the form user@domain, <b>%d</b> is replaced by the domain part
                     of  the  address.   Otherwise,  a  lookup is silently suppressed and returns no results (an
                     update is skipped with a warning).

              <b>%[SUD]</b> The upper-case equivalents of the above  expansions  behave  in  the  <b>key_format</b>  parameter
                     identically to their lower-case counter-parts.

              <b>%[1-9]</b> The patterns %1, %2, ... %9 are replaced by the corresponding most significant component of
                     the  input  key's  domain. If the input key is <u><a href="mailto:user@mail.example.com">user@mail.example.com</a></u>, then %1 is <b>com</b>, %2 is
                     <b>example</b> and %3 is <b>mail</b>. If the input key is unqualified or  does  not  have  enough  domain
                     components  to  satisfy  all  the  specified  patterns, a lookup is silently suppressed and
                     returns no results (an update is skipped with a warning).

       <b>domain</b> <b>(default:</b> <b>no</b> <b>domain</b> <b>list)</b>
              This feature can significantly reduce database server load.  Specify a list of domain names, paths
              to files, or "type:table" databases.  When specified, only fully  qualified  search  keys  with  a
              *non-empty*  localpart  and  a  matching  domain  are  eligible  for lookup or update: bare 'user'
              lookups, bare domain lookups and "@domain" lookups are silently skipped (updates are skipped  with
              a warning).  Example:

                  domain = example.com, hash:/etc/postfix/searchdomains

</pre><h4><b>MEMCACHE</b> <b>ERROR</b> <b>CONTROLS</b></h4><pre>
       <b>data_size_limit</b> <b>(default:</b> <b>10240)</b>
              The maximal memcache reply data length in bytes.

       <b>line_size_limit</b> <b>(default:</b> <b>1024)</b>
              The maximal memcache reply line length in bytes.

       <b>max_try</b> <b>(default:</b> <b>2)</b>
              The  number  of  times  to  try a memcache command before giving up.  The memcache client does not
              retry a command when the memcache server accepts no connection.

       <b>retry_pause</b> <b>(default:</b> <b>1)</b>
              The time in seconds before retrying a failed memcache command.

       <b>timeout</b> <b>(default:</b> <b>2)</b>
              The time limit for sending a memcache command and for receiving a memcache reply.

</pre><h4><b>BUGS</b></h4><pre>
       The Postfix memcache client cannot be used for security-sensitive tables such as  <b>alias_maps</b>  (these  may
       contain   "<u>|command</u>   and   "<u>/file/name</u>"   destinations),   or   <b>virtual_uid_maps</b>,  <b>virtual_gid_maps</b>  and
       <b>virtual_mailbox_maps</b> (these specify UNIX process privileges or "<u>/file/name</u>" destinations).  In a  typical
       deployment  a  memcache  database  is  writable  by  any process that can talk to the memcache server; in
       contrast, security-sensitive tables must never be writable by the unprivileged Postfix user.

       The Postfix memcache client requires additional configuration when used  as  <b><a href="../man8/postscreen.8.html">postscreen</a></b>(8)  or  <b><a href="../man8/verify.8.html">verify</a></b>(8)
       cache.   For details see the <b>backup</b> and <b>ttl</b> parameter discussions in the MEMCACHE MAIN PARAMETERS section
       above.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/postmap.1.html">postmap</a>(1), Postfix lookup table manager
       <a href="../man5/postconf.5.html">postconf</a>(5), configuration parameters

</pre><h4><b>README</b> <b>FILES</b></h4><pre>
       Use "<b>postconf</b> <b>readme_directory</b>" or "<b>postconf</b> <b>html_directory</b>" to locate this information.
       DATABASE_README, Postfix lookup table overview
       MEMCACHE_README, Postfix memcache client guide

</pre><h4><b>LICENSE</b></h4><pre>
       The Secure Mailer license must be distributed with this software.

</pre><h4><b>HISTORY</b></h4><pre>
       Memcache support was introduced with Postfix version 2.9.

</pre><h4><b>AUTHOR(S)</b></h4><pre>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA

       Wietse Venema
       Google, Inc.
       111 8th Avenue
       New York, NY 10011, USA

                                                                                               <u><a href="../man5/MEMCACHE_TABLE.5.html">MEMCACHE_TABLE</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>