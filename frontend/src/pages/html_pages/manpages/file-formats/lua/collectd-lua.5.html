<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>collectd-lua - Documentation of collectd's "Lua plugin"</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/collectd-core">collectd-core_5.12.0-23ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       collectd-lua - Documentation of collectd's "Lua plugin"

</pre><h4><b>SYNOPSIS</b></h4><pre>
         LoadPlugin lua
         # ...
         &lt;Plugin lua&gt;
           BasePath "/path/to/your/lua/scripts"
           Script "script1.lua"
           Script "script2.lua"
         &lt;/Plugin&gt;

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The "Lua plugin" embeds a Lua interpreter into collectd and provides an interface to collectd's plugin
       system. This makes it possible to write plugins for collectd in Lua. This is a lot more efficient than
       executing a Lua script every time you want to read a value with the "exec plugin" (see <b><a href="../man5/collectd-exec.5.html">collectd-exec</a></b>(5))
       and provides a lot more functionality, too.

       The minimum required Lua version is <u>5.1</u>.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       <b>LoadPlugin</b> <u>Lua</u>
           Loads the Lua plugin.

       <b>BasePath</b> <u>Name</u>
           The  directory  the  "Lua  plugin" looks in to find script <b>Script</b>.  If set, this is also prepended to
           <b>package.path</b>.

       <b>Script</b> <u>Name</u>
           The script the "Lua plugin" is going to run.  If <b>BasePath</b> is not  specified,  this  needs  to  be  an
           absolute path.

</pre><h4><b>WRITING</b> <b>YOUR</b> <b>OWN</b> <b>PLUGINS</b></h4><pre>
       Writing  your  own plugins is quite simple. collectd manages plugins by means of <b>dispatch</b> <b>functions</b> which
       call the appropriate <b>callback</b> <b>functions</b> registered by the plugins. Any plugin basically consists  of  the
       implementation  of  these  callback  functions  and  initializing code which registers the functions with
       collectd. See the section "EXAMPLES" below for a really basic example. The following  types  of  <b>callback</b>
       <b>functions</b> are implemented in the Lua plugin (all of them are optional):

       read functions
           These  are  used  to  collect  the  actual  data.  It  is  called once per interval (see the <b>Interval</b>
           configuration option of collectd). Usually it will  call  <b>collectd.dispatch_values</b>  to  dispatch  the
           values  to  collectd which will pass them on to all registered <b>write</b> <b>functions</b>. If this function does
           not return 0, interval between  its  calls  will  grow  until  function  returns  0  again.  See  the
           <b>MaxReadInterval</b> configuration option of collectd.

       write functions
           These  are  used  to  write  the  dispatched  values.  They  are called once for every value that was
           dispatched by any plugin.

</pre><h4><b>FUNCTIONS</b></h4><pre>
       The following functions are provided to Lua modules:

       register_read(callback)
           Function to register read callbacks.  The  callback  will  be  called  without  arguments.   If  this
           callback function does not return 0 the next call will be delayed by an increasing interval.

       register_write(callback)
           Function to register write callbacks.  The callback function will be called with one argument passed,
           which  will  be  a  table  of  values.  If this callback function does not return 0 next call will be
           delayed by an increasing interval.

       log_error, log_warning, log_notice, log_info, log_debug(<u>message</u>)
           Log a message with the specified severity.

</pre><h4><b>EXAMPLES</b></h4><pre>
           A very simple read function might look like:

             function read()
               collectd.log_info("read function called")
               t = {
                   host = 'localhost',
                   plugin = 'myplugin',
                   type = 'counter',
                   values = {42},
               }
               collectd.dispatch_values(t)
               return 0
             end

           A very simple write function might look like:

             function write(vl)
               for i = 1, #vl.values do
                 collectd.log_info(vl.host .. '.' .. vl.plugin .. '.' .. vl.type .. ' ' .. vl.values[i])
               end
               return 0
             end

           To register those functions with collectd:

             collectd.register_read(read)     -- pass function as variable
             collectd.register_write("write") -- pass by global-scope function name

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/collectd.1.html">collectd</a></b>(1), <b><a href="../man5/collectd.conf.5.html">collectd.conf</a></b>(5), <b><a href="../man1/lua.1.html">lua</a></b>(1),

</pre><h4><b>AUTHOR</b></h4><pre>
       The  "Lua  plugin"  has  been  written  by  Julien  Ammous   &lt;j.ammous at gmail.com&gt;,   Florian   Forster
       &lt;octo at collectd.org&gt; and Ruben Kerkhof &lt;ruben at rubenkerkhof.com&gt;.

       This  manpage  has  been  written  by  Ruben  Kerkhof  &lt;ruben at rubenkerkhof.com&gt;.   It  is based on the
       <b><a href="../man5/collectd-perl.5.html">collectd-perl</a></b>(5)  manual  page   by   Florian   Forster   &lt;octo at collectd.org&gt;   and   Sebastian   Harl
       &lt;sh at tokkee.org&gt;.

5.12.0.git                                         2025-08-07                                    <u><a href="../man5/COLLECTD-LUA.5.html">COLLECTD-LUA</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>