<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dlm.conf - dlm_controld configuration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/dlm-controld">dlm-controld_4.3.0-3build1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dlm.conf - dlm_controld configuration file

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>/etc/dlm/dlm.conf</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  configuration  options  in  dlm.conf  mirror the dlm_controld command line options.  The config file
       additionally allows advanced fencing and lockspace configuration that are not supported  on  the  command
       line.

</pre><h4><b>Command</b> <b>line</b> <b>equivalents</b></h4><pre>
       If  an option is specified on the command line and in the config file, the command line setting overrides
       the config file setting.  See <b><a href="../man8/dlm_controld.8.html">dlm_controld</a></b>(8) for descriptions and dlm_controld -h for defaults.

       Format:

       setting=value

       Example:

       log_debug=1
       post_join_delay=10
       protocol=tcp

       Options:

       daemon_debug(*)
       log_debug(*)
       protocol
       mark
       debug_logfile(*)
       enable_plock
       plock_debug(*)
       plock_rate_limit(*)
       plock_ownership
       drop_resources_time(*)
       drop_resources_count(*)
       drop_resources_age(*)
       post_join_delay(*)
       enable_fencing
       enable_concurrent_fencing
       enable_startup_fencing
       enable_quorum_fencing(*)
       enable_quorum_lockspace(*)
       repeat_failed_fencing(*)
       enable_helper

       Options with (*) can be reloaded, see Reload config.

</pre><h4><b>Reload</b> <b>config</b></h4><pre>
       Some dlm.conf settings can be changed while dlm_controld is running using dlm_tool  reload_config.   Edit
       dlm.conf,  adding,  removing, commenting or changing values, then run dlm_tool reload_config to apply the
       changes in dlm_controld.  dlm_tool dump_config will show the new settings.

</pre><h4><b>Fencing</b></h4><pre>
       A fence device definition begins with a <b>device</b> line, followed by a number of <b>connect</b> lines, one for  each
       node connected to the device.

       A blank line separates device definitions.

       Devices are used in the order they are listed.

       The  <b>device</b>  key word is followed by a unique <u>dev_name</u>, the <u>agent</u> program to be used, and <u>args</u>, which are
       agent arguments specific to the device.

       The <b>connect</b> key word is followed by the <u>dev_name</u> of the device section, the node ID of the connected node
       in the format <b>node=</b><u>nodeid</u> and <u>args</u>, which are agent arguments specific to the node for the given device.

       The format of <u>args</u> is key=val on both device and connect lines, each pair  separated  by  a  space,  e.g.
       key1=val1 key2=val2 key3=val3.

       Format:

       <b>device</b>  <u>dev_name</u> <u>agent</u> [args]
       <b>connect</b> <u>dev_name</u> <b>node=</b><u>nodeid</u> [args]
       <b>connect</b> <u>dev_name</u> <b>node=</b><u>nodeid</u> [args]
       <b>connect</b> <u>dev_name</u> <b>node=</b><u>nodeid</u> [args]

       Example:

       device  foo fence_foo ipaddr=1.1.1.1 login=x password=y
       connect foo node=1 port=1
       connect foo node=2 port=2
       connect foo node=3 port=3

       device  bar fence_bar ipaddr=2.2.2.2 login=x password=y
       connect bar node=1 port=1
       connect bar node=2 port=2
       connect bar node=3 port=3

   <b>Parallel</b> <b>devices</b>
       Some  devices,  like  dual power or dual path, must all be turned off in parallel for fencing to succeed.
       To define multiple devices as being parallel to each other, use the same  base  dev_name  with  different
       suffixes and a colon separator between base name and suffix.

       Format:

       <b>device</b>  <u>dev_name</u>:1 <u>agent</u> [args]
       <b>connect</b> <u>dev_name</u>:1 <b>node=</b><u>nodeid</u> [args]
       <b>connect</b> <u>dev_name</u>:1 <b>node=</b><u>nodeid</u> [args]
       <b>connect</b> <u>dev_name</u>:1 <b>node=</b><u>nodeid</u> [args]

       <b>device</b>  <u>dev_name</u>:2 <u>agent</u> [args]
       <b>connect</b> <u>dev_name</u>:2 <b>node=</b><u>nodeid</u> [args]
       <b>connect</b> <u>dev_name</u>:2 <b>node=</b><u>nodeid</u> [args]
       <b>connect</b> <u>dev_name</u>:2 <b>node=</b><u>nodeid</u> [args]

       Example:

       device  foo:1 fence_foo ipaddr=1.1.1.1 login=x password=y
       connect foo:1 node=1 port=1
       connect foo:2 node=2 port=2
       connect foo:3 node=3 port=3

       device  foo:2 fence_foo ipaddr=5.5.5.5 login=x password=y
       connect foo:2 node=1 port=1
       connect foo:2 node=2 port=2
       connect foo:2 node=3 port=3

   <b>Unfencing</b>
       A  node  may sometimes need to "unfence" itself when starting.  The unfencing command reverses the effect
       of a previous fencing operation against it.  An example would be fencing that disables a port  on  a  SAN
       switch.  A node could use unfencing to re-enable its switch port when starting up after rebooting.  (Care
       must  be  taken  to  ensure  it's  safe  for  a node to unfence itself.  A node often needs to be cleanly
       rebooted before unfencing itself.)

       To specify that a node should unfence itself for a given <b>device,</b> the <b>unfence</b>  line  is  added  after  the
       <b>connect</b> lines.

       Format:

       <b>device</b>  <u>dev_name</u> <u>agent</u> [args]
       <b>connect</b> <u>dev_name</u> <b>node=</b><u>nodeid</u> [args]
       <b>connect</b> <u>dev_name</u> <b>node=</b><u>nodeid</u> [args]
       <b>connect</b> <u>dev_name</u> <b>node=</b><u>nodeid</u> [args]
       <b>unfence</b> <u>dev_name</u>

       Example:

       device  foo fence_foo ipaddr=1.1.1.1 login=x password=y
       connect foo node=1 port=1
       connect foo node=2 port=2
       connect foo node=3 port=3
       unfence foo

   <b>Simple</b> <b>devices</b>
       In  some cases, a single fence device is used for all nodes, and it requires no node-specific args.  This
       would typically be a "bridge" fence device in which an agent  is  passing  a  fence  request  to  another
       subsystem to handle.  (Note that a "node=nodeid" arg is always automatically included in agent args, so a
       node-specific nodeid is always present to minimally identify the victim.)

       In such a case, a simplified, single-line fence configuration is possible, with format:

       <b>fence_all</b> <u>agent</u> [args]

       Example:

       fence_all dlm_stonith

       A fence_all configuration is not compatible with a fence device configuration (above).

       Unfencing can optionally be applied with:

       <b>fence_all</b> <u>agent</u> [args]
       <b>unfence_all</b>

</pre><h4><b>Lockspace</b> <b>configuration</b></h4><pre>
       A  lockspace definition begins with a <b>lockspace</b> line, followed by a number of <b>master</b> lines.  A blank line
       separates lockspace definitions.

       Format:

       <b>lockspace</b> <u>ls_name</u> [ls_args]
       <b>master</b>    <u>ls_name</u> <b>node=</b><u>nodeid</u> [node_args]
       <b>master</b>    <u>ls_name</u> <b>node=</b><u>nodeid</u> [node_args]
       <b>master</b>    <u>ls_name</u> <b>node=</b><u>nodeid</u> [node_args]

   <b>Disabling</b> <b>resource</b> <b>directory</b>
       Lockspaces usually use a resource directory to keep track of which node is the master of  each  resource.
       The  dlm  can  operate  without  the  resource directory, though, by statically assigning the master of a
       resource using a hash of the resource name.  To enable, set the per-lockspace <b>nodir</b> option to 1.

       Example:

       lockspace foo nodir=1

   <b>Lock-server</b> <b>configuration</b>
       The nodir setting can be combined with node weights to create a configuration where  select  node(s)  are
       the  master  of  all  resources/locks.   These master nodes can be viewed as "lock servers" for the other
       nodes.

       Example of nodeid 1 as master of all resources:

       lockspace foo nodir=1
       master    foo node=1

       Example of nodeid's 1 and 2 as masters of all resources:

       lockspace foo nodir=1
       master    foo node=1
       master    foo node=2

       Lock management will be partitioned among the available masters.  There can  be  any  number  of  masters
       defined.   The  designated  master  nodes will master all resources/locks (according to the resource name
       hash).  When no masters are members of the  lockspace,  then  the  nodes  revert  to  the  common  fully-
       distributed  configuration.   Recovery  is  faster,  with  little  disruption,  when  a  non-master  node
       joins/leaves.

       There is no special mode in the dlm for this lock server configuration, it's just a  natural  consequence
       of combining the "nodir" option with node weights.  When a lockspace has master nodes defined, the master
       has  a  default  weight  of 1 and all non-master nodes have weight of 0.  An explicit non-zero <b>weight</b> can
       also be assigned to master nodes, e.g.

       lockspace foo nodir=1
       master    foo node=1 weight=2
       master    foo node=2 weight=1

       In which case node 1 will master 2/3 of the total resources and node 2 will master the other 1/3.

   <b>Node</b> <b>configuration</b>
       Node configurations can be set by the node keyword followed of key-value pairs.

       <b>Keys:</b>

       <b>mark</b> The mark key can be used to set a specific mark value which is then used by the in-kernel DLM socket
       creation. This can be used to match for DLM specific packets for e.g. routing.

       Example of setting a per socket value for nodeid 1 and a mark value of 42:

       node id=1 mark=42

       For local nodes this value doesn't have any effect.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/dlm_controld.8.html">dlm_controld</a></b>(8), <b><a href="../man8/dlm_tool.8.html">dlm_tool</a></b>(8)

dlm                                                2012-04-09                                        <u><a href="../man5/DLM.CONF.5.html">DLM.CONF</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>