<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>providers - Shorewall Providers file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/shorewall">shorewall_5.2.8-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       providers - Shorewall Providers file

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>/etc/shorewall/providers</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This file is used to define additional routing tables. You will want to define an additional table if:

       •   You have connections to more than one ISP or multiple connections to the same ISP

       •   You run Squid as a transparent proxy on a host other than the firewall.

       •   You have other requirements for policy routing.

       Each entry in the file defines a single routing table.

       If you wish to omit a column entry but want to include an entry in the next column, use "-" for the
       omitted entry.

       The columns in the file are as follows.

       <b>NAME</b> - <u>name</u>
           The provider <u>name</u>. Must be a valid shell variable name. The names 'local', 'main', 'default' and
           'unspec' are reserved and may not be used as provider names.

       <b>NUMBER</b> - <u>number</u>
           The provider number -- a number between 1 and 15. Each provider must be assigned a unique value.

       <b>MARK</b> (Optional) - <u>value</u>
           A FWMARK <u>value</u> used in your <b><a href="../man5/shorewall-mangle.5.html">shorewall-mangle</a>(5)</b>[1] file to direct packets to this provider.

           If PROVIDER_OFFSET is non-zero in <b><a href="../man5/shorewall.conf.5.html">shorewall.conf</a>(5)</b>[2], then the value must be a multiple of
           2^^PROVIDER_OFFSET. In all cases, the number of significant bits may not exceed PROVIDER_OFFSET +
           PROVIDER_BITS.

       <b>DUPLICATE</b> - <u>routing-table-name</u>
           The name of an existing table to duplicate to create this routing table. May be <b>main</b> or the name of a
           previously listed provider. You may select only certain entries from the table to copy by using the
           COPY column below. This column should contain a dash ("-') when USE_DEFAULT_RT=Yes in
           <b><a href="../man5/shorewall.conf.5.html">shorewall.conf</a>(5)</b>[2].

       <b>INTERFACE</b> - <u>interface</u>[:<u>address</u>]
           The name of the network interface to the provider. Must be listed in <b><a href="../man5/shorewall-interfaces.5.html">shorewall-interfaces</a>(5)</b>[3]. In
           general, that interface should not have the <b>proxyarp</b> or <b>proxyndp</b> option specified unless <b>loose</b> is
           given in the OPTIONS column of this entry.

               <b>Important</b>
               For IPv6, if the interface is an Ethernet device and an IP address is supplied, it should be the
               upstream router's link-level address, not its global address.
           Where more than one provider is serviced through a single interface, the <u>interface</u> must be followed
           by a colon and the IP <u>address</u> of the interface that is supplied by the associated provider.

       <b>GATEWAY</b> - {<b>-</b>|<u>address</u>[,<u>mac</u>]|<b>detect|none</b>}
           The IP address of the provider's gateway router. Beginning with Shorewall 4.6.2, you may also specify
           the MAC address of the gateway when there are multiple providers serviced through the same interface.
           When the MAC is not specified, Shorewall will detect the MAC during firewall start or restart.

           You can enter <b>detect</b> here and Shorewall will attempt to detect the gateway automatically.

           Beginning with Shorewall 5.0.6, you may also enter <b>none</b>. This causes creation of a routing table with
           no default route in it.

           For PPP devices, you may omit this column.

       <b>OPTIONS</b> (Optional) - [<b>-</b>|<u>option</u>[<b>,</b><u>option</u>]...]
           A comma-separated list selected from the following. The order of the options is not significant but
           the list may contain no embedded white-space.

           autosrc
               Added in Shorewall 4.5.17. Causes a host route to the provider's gateway router to be added to
               the provider's routing table. This is the default behavior unless overridden by a following
               <b>noautosrc</b> option.

           <b>track</b>
               If specified, inbound connections on this interface are to be tracked so that responses may be
               routed back out this same interface.

               You want to specify <b>track</b> if internet hosts will be connecting to local servers through this
               provider.

               Beginning with Shorewall 4.4.3, <b>track</b> defaults to the setting of the TRACK_PROVIDERS option in
               <b>shorewall.conf</b>[2] (5). If you set TRACK_PROVIDERS=Yes and want to override that setting for an
               individual provider, then specify <b>notrack</b> (see below).

           <b>balance[=</b><u>weight</u><b>]</b>
               The providers that have <b>balance</b> specified will get outbound traffic load-balanced among them. By
               default, all interfaces with <b>balance</b> specified will have the same weight (1). You can change the
               weight of an interface by specifying <b>balance=</b><u>weight</u> where <u>weight</u> is the weight of the route out
               of this interface.

               Prior to Shorewall 5.1.1, when USE_DEFAULT_RT=Yes, <b>balance=1</b> is assumed unless the <b>fallback</b>,
               <b>loose</b>, <b>load</b> or <b>tproxy</b> option is specified. Beginning with Shorewall 5.1.1, when
               BALANCE_PROVIDERS=Yes, <b>balance=1</b> is assumed unless the <b>fallback</b>, <b>loose</b>, <b>load</b> or <b>tproxy</b> option is
               specified.I

                   <b>Caution</b>
                   In IPV6, the <b>balance</b> option does not cause balanced default routes to be created; it rather
                   causes a sequence of default routes with different metrics to be created.

           <b>loose</b>
               Shorewall normally adds a routing rule for each IP address on an interface which forces traffic
               whose source is that IP address to be sent using the routing table for that interface. Setting
               <b>loose</b> prevents creation of such rules on this interface.

           <b>load=</b><u>probability</u>
               Added in Shorewall 4.6.0. This option provides an alternative method of load balancing based on
               probabilities. Providers to be balanced are given a <u>probability</u> (a number 0 &gt; n &gt;= 1) with up to
               8 digits to the right of the decimal point. Beginning with Shorewall 4.6.10, a warning is issued
               if the sum of the probabilities is not 1.00000000.

           <b>noautosrc</b>
               Added in Shorewall 4.5.17. Prevents the addition of a host route to the provider's gateway router
               from being added to the provider's routing table. This option must be used with caution as it can
               cause start and restart failures.

           <b>notrack</b>
               Added in Shorewall 4.4.3. When specified, turns off <b>track</b>.

           <b>optional</b> <b>(deprecated</b> <b>for</b> <b>use</b> <b>with</b> <b>providers</b> <b>that</b> <b>do</b> <b>not</b> <b>share</b> <b>an</b> <b>interface)</b>
               If the interface named in the INTERFACE column is not up and configured with an IPv4 address then
               ignore this provider. If not specified, the value of the <b>optional</b> option for the INTERFACE in
               <b><a href="../man5/shorewall-interfaces.5.html">shorewall-interfaces</a>(5)</b>[3] is assumed. Use of that option is preferred to this one, unless an
               <u>address</u> is provider in the INTERFACE column.

           <b>primary</b>
               Added in Shorewall 4.6.6, <b>primary</b> is equivalent to <b>balance=1</b> and is preferred when the remaining
               providers specify <b>fallback</b> or <b>tproxy</b>.

           <b>src=</b><u>source-address</u>
               Specifies the source address to use when routing to this provider and none is known (the local
               client has bound to the 0 address). May not be specified when an <u>address</u> is given in the
               INTERFACE column. If this option is not used, Shorewall substitutes the primary IP address on the
               interface named in the INTERFACE column.

           <b>mtu=</b><u>number</u>
               Specifies the MTU when forwarding through this provider. If not given, the MTU of the interface
               named in the INTERFACE column is assumed.

           <b>fallback[=</b><u>weight</u><b>]</b>
               Indicates that a default route through the provider should be added to the default routing table
               (table 253). If a <u>weight</u> is given, a balanced route is added with the weight of this provider
               equal to the specified <u>weight</u>. If the option is given without a <u>weight</u>, a separate default route
               is added through the provider's gateway; the route has a metric equal to the provider's NUMBER.

               Prior to Shorewall 4.4.24, the option is ignored with a warning message if USE_DEFAULT_RT=Yes in
               shorewall.conf.

                   <b>Caution</b>
                   In IPV6, specifying the <b>fallback</b> option on multiple providers does not cause balanced
                   fallback routes to be created; it rather causes a sequence of fallback routes with different
                   metrics to be created.

           <b>tproxy</b>
               Added in Shorewall 4.5.4. Used for supporting the TPROXY action in <a href="../man5/shorewall-mangle.5.html">shorewall-mangle</a>(5). See
               <b>https://shorewall.org/Shorewall_Squid_Usage.html</b>[4]. When specified, the MARK, DUPLICATE and
               GATEWAY columns should be empty, INTERFACE should be set to 'lo' and <b>tproxy</b> should be the only
               OPTION. Only one <b>tproxy</b> provider is allowed.

           <b>hostroute</b>
               Added in Shorewall 4.5.21. This is the default behavior that results in a host route to the
               defined <b>GATEWAY</b> being inserted into the main routing table and into the provider's routing table.
               <b>hostroute</b> is required for older distributions but <b>nohostroute</b> (below) is appropriate for recent
               distributions.  <b>hostroute</b> may interfere with Zebra's ability to add routes on some distributions
               such as Debian 7. This option defaults to on when BALANCE_PROVIDERS=Yes, in <b><a href="../man5/shorewall.conf.5.html">shorewall.conf</a>(5)</b>[2].

           <b>nohostroute</b>
               Added in Shorewall 4.5.21. nohostroute inhibits addition of a host route to the defined <b>GATEWAY</b>
               being inserted into the main routing table and into the provider's routing table.  <b>nohostroute</b> is
               not appropriate for older distributions but is appropriate for recent distributions.  <b>nohostroute</b>
               allows Zebra's to correctly add routes on some distributions such as Debian 7. This option
               defaults to off when BALANCE_PROVIDERS=Yes, in <b><a href="../man5/shorewall.conf.5.html">shorewall.conf</a>(5)</b>[2].

           <b>persistent</b>
               Added in Shorewall 5.0.2 and alters the behavior of the <b>disable</b> command:

               •   The provider's routing table still contains the apprioriate default route.

               •   Unless the <b>noautosrc</b> option is specified, routing rules are generated to route traffic from
                   the interfaces address(es) out of the provider's routing table.

               •   Persistent routing rules in <b><a href="../man5/shorewall-rtrules.5.html">shorewall-rtrules</a>(5)</b>[5] are present.

                   <b>Note</b>
                   The generated script will attempt to reenable a disabled persistent provider during execution
                   of the <b>start</b>, <b>restart</b> and <b>reload</b> commands. When <b>persistent</b> is not specified, only the <b>enable</b>
                   and <b>reenable</b> commands can reenable the provider.

                   <b>Important</b>
                   RESTORE_DEFAULT_ROUTE=Yes in shorewall[6].conf is not recommended when the <b>persistent</b> option
                   is used, as restoring default routes to the main routing table can prevent link status
                   monitors such as foolsm from correctly detecting non-working providers.

       <b>COPY</b> - [{<b>none</b>|<u>interface</u><b>[,</b><u>interface</u>]...}]
           A comma-separated list of other interfaces on your firewall. Wildcards specified using an asterisk
           ("*") are permitted (e.g., tun* ). Usually used only when DUPLICATE is <b>main</b>. Only copy routes through
           INTERFACE and through interfaces listed here. If you only wish to copy routes through INTERFACE,
           enter <b>none</b> in this column.

           Beginning with Shorewall 4.5.17, blackhole, unreachable and prohibit routes are no longer copied by
           default but may be copied by including <b>blackhole</b>,<b>unreachable</b> and <b>prohibit</b> respectively in the COPY
           list.

</pre><h4><b>EXAMPLES</b></h4><pre>
       IPv4 Example 1:
           You run squid in your DMZ on IP address 192.168.2.99. Your DMZ interface is eth2

                       #NAME   NUMBER  MARK DUPLICATE  INTERFACE GATEWAY       OPTIONS
                       Squid   1       1    -          eth2      192.168.2.99  -

       IPv4 Example 2:
           eth0 connects to ISP 1. The IP address of eth0 is 206.124.146.176 and the ISP's gateway router has IP
           address 206.124.146.254.

           eth1 connects to ISP 2. The IP address of eth1 is 130.252.99.27 and the ISP's gateway router has IP
           address 130.252.99.254.

           eth2 connects to a local network.

                       #NAME NUMBER MARK DUPLICATE INTERFACE GATEWAY          OPTIONS            COPY
                       ISP1  1       1    main      eth0      206.124.146.254 track,balance      eth2
                       ISP2  2       2    main      eth1      130.252.99.254  track,balance      eth2

       IPv6 Example 1:
           You run squid in your DMZ on IP address 2002:ce7c:92b4:1::2. Your DMZ interface is eth2

                       #NAME   NUMBER  MARK DUPLICATE  INTERFACE GATEWAY              OPTIONS
                       Squid   1       1    -          eth2      2002:ce7c:92b4:1::2  -

       IPv6 Example 2:
           eth0 connects to ISP 1. The ISP's gateway router has IP address 2001:ce7c:92b4:1::2.

           eth1 connects to ISP 2. The ISP's gateway router has IP address 2001:d64c:83c9:12::8b.

           eth2 connects to a local network.

                       #NAME NUMBER MARK DUPLICATE INTERFACE GATEWAY               OPTIONS    COPY
                       ISP1  1       1    main      eth0     2001:ce7c:92b4:1::2   track      eth2
                       ISP2  2       2    main      eth1     2001:d64c:83c9:12::8b track      eth2

</pre><h4><b>FILES</b></h4><pre>
       /etc/shorewall/providers

       /etc/shorewall6/providers

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>https://shorewall.org/MultiISP.html</b>[6]

       <b>https://shorewall.org/configuration_file_basics.htm#Pairs</b>[7]

       <a href="../man8/shorewall.8.html">shorewall</a>(8)

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="../man5/shorewall-mangle.5.html">shorewall-mangle</a>(5)
           https://shorewall.org/manpages/shorewall-mangle.html

        2. <a href="../man5/shorewall.conf.5.html">shorewall.conf</a>(5)
           https://shorewall.org/manpages/shorewall.conf.html

        3. <a href="../man5/shorewall-interfaces.5.html">shorewall-interfaces</a>(5)
           https://shorewall.org/manpages/shorewall-interfaces.html

        4. https://shorewall.org/Shorewall_Squid_Usage.html
           https://shorewall.org/Shorewall_Squid_Usage.html

        5. <a href="../man5/shorewall-rtrules.5.html">shorewall-rtrules</a>(5)
           https://shorewall.org/manpages/shorewall-rtrules.html

        6. https://shorewall.org/MultiISP.html
           https://shorewall.org/MultiISP.html

        7. https://shorewall.org/configuration_file_basics.htm#Pairs
           https://shorewall.org/configuration_file_basics.htm#Pairs

Configuration Files                                09/24/2020                             <u><a href="../man5/SHOREWALL-PROVIDERS.5.html">SHOREWALL-PROVIDERS</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>