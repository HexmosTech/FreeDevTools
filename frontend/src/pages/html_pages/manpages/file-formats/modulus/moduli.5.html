<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>moduli — Diffie-Hellman moduli</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/openssh-server">openssh-server_10.0p1-5ubuntu3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       moduli — Diffie-Hellman moduli

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <u><a href="file:/etc/ssh/moduli">/etc/ssh/moduli</a></u>  file contains prime numbers and generators for use by <u><a href="../man8/sshd.8.html">sshd</a></u>(8) in the Diffie-Hellman
       Group Exchange key exchange method.

       New moduli may be generated with <u><a href="../man1/ssh-keygen.1.html">ssh-keygen</a></u>(1) using a two-step process.  An initial <u>candidate</u> <u>generation</u>
       pass, using <b>ssh-keygen</b> <b>-M</b> <b>generate</b>, calculates numbers that are likely to be useful.  A second  <u>primality</u>
       <u>testing</u>  pass, using <b>ssh-keygen</b> <b>-M</b> <b>screen</b>, provides a high degree of assurance that the numbers are prime
       and are safe for use in Diffie-Hellman operations by <u><a href="../man8/sshd.8.html">sshd</a></u>(8).  This <b>moduli</b> format is used as  the  output
       from each pass.

       The file consists of newline-separated records, one per modulus, containing seven space-separated fields.
       These fields are as follows:

             timestamp    The time that the modulus was last processed as YYYYMMDDHHMMSS.

             type         Decimal  number  specifying  the  internal  structure of the prime modulus.  Supported
                          types are:

                          0     Unknown, not tested.
                          2     "Safe" prime; (p-1)/2 is also prime.
                          4     Sophie Germain; 2p+1 is also prime.

                          Moduli candidates initially produced by <u><a href="../man1/ssh-keygen.1.html">ssh-keygen</a></u>(1) are Sophie Germain primes  (type
                          4).   Further primality testing with <u><a href="../man1/ssh-keygen.1.html">ssh-keygen</a></u>(1) produces safe prime moduli (type 2)
                          that are ready for use in <u><a href="../man8/sshd.8.html">sshd</a></u>(8).  Other types are not used by OpenSSH.

             tests        Decimal number indicating the type  of  primality  tests  that  the  number  has  been
                          subjected to represented as a bitmask of the following values:

                          0x00  Not tested.
                          0x01  Composite number – not prime.
                          0x02  Sieve of Eratosthenes.
                          0x04  Probabilistic Miller-Rabin primality tests.

                          The  <u><a href="../man1/ssh-keygen.1.html">ssh-keygen</a></u>(1)  moduli  candidate  generation uses the Sieve of Eratosthenes (flag
                          0x02).  Subsequent <u><a href="../man1/ssh-keygen.1.html">ssh-keygen</a></u>(1) primality tests are Miller-Rabin tests (flag 0x04).

             trials       Decimal number indicating the number of primality trials that have been  performed  on
                          the modulus.

             size         Decimal number indicating the size of the prime in bits.

             generator    The recommended generator for use with this modulus (hexadecimal).

             modulus      The modulus itself in hexadecimal.

       When  performing  Diffie-Hellman Group Exchange, <u><a href="../man8/sshd.8.html">sshd</a></u>(8) first estimates the size of the modulus required
       to produce enough Diffie-Hellman output to sufficiently key the selected symmetric cipher.  <u><a href="../man8/sshd.8.html">sshd</a></u>(8)  then
       randomly selects a modulus from <u><a href="file:/etc/ssh/moduli">/etc/ssh/moduli</a></u> that best meets the size requirement.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/ssh-keygen.1.html">ssh-keygen</a></u>(1), <u><a href="../man8/sshd.8.html">sshd</a></u>(8)

</pre><h4><b>STANDARDS</b></h4><pre>
       M.  Friedl, N. Provos, and W. Simpson, <u>Diffie-Hellman</u> <u>Group</u> <u>Exchange</u> <u>for</u> <u>the</u> <u>Secure</u> <u>Shell</u> <u>(SSH)</u> <u>Transport</u>
       <u>Layer</u> <u>Protocol</u>, RFC 4419, March 2006.

Debian                                           April 16, 2022                                        <u><a href="../man5/MODULI.5.html">MODULI</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>