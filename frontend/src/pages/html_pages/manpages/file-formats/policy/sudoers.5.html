<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sudoers — default sudo security policy plugin</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/sudo-ldap">sudo-ldap_1.9.16p2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       sudoers — default sudo security policy plugin

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>sudoers</b>  policy  plugin  determines a user's <b>sudo</b> privileges.  It is the default <b>sudo</b> policy plugin.
       The policy is driven by the <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> file or, optionally, in LDAP.  The policy format is described in
       detail in the “SUDOERS FILE FORMAT” section.  For information on storing <b>sudoers</b>  policy  information  in
       LDAP, see <u><a href="../man5/sudoers.ldap.5.html">sudoers.ldap</a></u>(5).

   <b>Configuring</b> <b>sudo.conf</b> <b>for</b> <b>sudoers</b>
       <b>sudo</b>  consults  the  <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5)  file  to  determine which plugins to load.  If no <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) file is
       present, or if it contains no <u>Plugin</u> lines, <b>sudoers</b> will be used for auditing, policy decisions  and  I/O
       logging.  To explicitly configure <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) to use the <b>sudoers</b> plugin, the following configuration can
       be used.

           Plugin sudoers_audit sudoers.so
           Plugin sudoers_policy sudoers.so
           Plugin sudoers_io sudoers.so

       Starting  with  <b>sudo</b>  1.8.5,  it  is  possible to specify optional arguments to the <b>sudoers</b> plugin in the
       <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) file.  Plugin arguments, if any, should be listed after the path to the plugin (i.e.,  after
       <u>sudoers.so</u>).  The arguments are only effective for the plugin that opens (and parses) the <u>sudoers</u> file.

       For  <b>sudo</b>  version  1.9.1  and  higher,  this is the <u>sudoers_audit</u> plugin.  For older versions, it is the
       <u>sudoers_policy</u> plugin.  Multiple arguments may be specified, separated by white space.  For example:

           Plugin sudoers_audit sudoers.so sudoers_mode=0400 error_recovery=false

       The following plugin arguments are supported:

       error_recovery=bool
             The <u>error_recovery</u> argument can be used to control whether <b>sudoers</b> should attempt to  recover  from
             syntax  errors in the <u>sudoers</u> file.  If set to <u>true</u> (the default), <b>sudoers</b> will try to recover from
             a syntax error by discarding the portion of the line that contains the error until the end  of  the
             line.  A value of <u>false</u> will disable error recovery.  Prior to version 1.9.3, no error recovery was
             performed.

       ignore_perms=bool
             The <u>ignore_perms</u> argument can be used to disable security checks when loading the <u>sudoers</u> file.  If
             enabled,  the  <u>sudoers</u>  file will be loaded regardless of the owner or file mode.  This argument is
             intended to be used for testing purposes and should not be enabled on production systems.

       ldap_conf=pathname
             The <u>ldap_conf</u> argument can be used to override the default path to the <u>ldap.conf</u> file.

       ldap_secret=pathname
             The <u>ldap_secret</u> argument can be used to override the default path to the <u>ldap.secret</u> file.

       sudoers_file=pathname
             The <u>sudoers_file</u> argument can be used to override the default path to the <u>sudoers</u> file.

       sudoers_uid=user-ID
             The <u>sudoers_uid</u> argument can be used to override the default owner of the sudoers file.  It  should
             be specified as a numeric user-ID.

       sudoers_gid=group-ID
             The <u>sudoers_gid</u> argument can be used to override the default group of the sudoers file.  It must be
             specified as a numeric group-ID (not a group name).

       sudoers_mode=mode
             The  <u>sudoers_mode</u>  argument can be used to override the default file mode for the sudoers file.  It
             should be specified as an octal value.

       For more information on configuring <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5), refer to its manual.

   <b>User</b> <b>Authentication</b>
       The <b>sudoers</b> security policy requires that most users authenticate themselves before they can use <b>sudo</b>.  A
       password is not required if the invoking user is <b>root</b>, if the target user is the  same  as  the  invoking
       user,  or  if the policy has disabled authentication for the user or command.  Unlike <u><a href="../man1/su.1.html">su</a></u>(1), when <b>sudoers</b>
       requires authentication, it validates the invoking user's credentials, not the target user's (or  <b>root</b>'s)
       credentials.  This can be changed via the <u>rootpw</u>, <u>targetpw</u> and <u>runaspw</u> flags, described later.

       If  a  user  who  is not listed in the policy tries to run a command via <b>sudo</b>, mail is sent to the proper
       authorities.  The address used for such mail is configurable via the  <u>mailto</u>  Defaults  entry  (described
       later) and defaults to <u>root</u>.

       No  mail  will be sent if an unauthorized user tries to run <b>sudo</b> with the <b>-l</b> or <b>-v</b> option unless there is
       an authentication error and either the <u>mail_always</u> or <u>mail_badpass</u> flags are enabled.  This allows  users
       to determine for themselves whether or not they are allowed to use <b>sudo</b>.  By default, all attempts to run
       <b>sudo</b> (successful or not) are logged, regardless of whether or not mail is sent.

       If  <b>sudo</b>  is  run by <b>root</b> and the SUDO_USER environment variable is set, the <b>sudoers</b> policy will use this
       value to determine who the actual user is.  This can be used by a user to log commands through sudo  even
       when  a <b>root</b> shell has been invoked.  It also allows the <b>-e</b> option to remain useful even when invoked via
       a sudo-run script or program.  Note, however, that the <u>sudoers</u> file lookup is still done  for  <b>root</b>,  not
       the user specified by SUDO_USER.

       <b>sudoers</b>  uses  per-user  time  stamp files for credential caching.  Once a user has been authenticated, a
       record is written containing the user-ID that was used to authenticate,  the  terminal  session  ID,  the
       start  time of the session leader (or parent process) and a time stamp (using a monotonic clock if one is
       available).  The user may then use <b>sudo</b> without a password for a short period of time (15 minutes  unless
       overridden  by  the  <u>timestamp_timeout</u>  option).   By  default,  <b>sudoers</b>  uses a separate record for each
       terminal, which means that a user's login sessions  are  authenticated  separately.   The  <u>timestamp_type</u>
       option can be used to select the type of time stamp record <b>sudoers</b> will use.

       The  <b>tsdump</b> utility, included with the sudo source distribution, can be used to display the contents of a
       time stamp file.  See <u><a href="../man5/sudoers_timestamp.5.html">sudoers_timestamp</a></u>(5) for details of the time stamp file format.

   <b>Logging</b>
       By default, <b>sudoers</b> logs both successful and unsuccessful attempts (as well as errors).  The  <u>log_allowed</u>
       and  <u>log_denied</u>  flags  can be used to control this behavior.  Messages can be logged to <u><a href="../man3/syslog.3.html">syslog</a></u>(3), a log
       file, or both.  The default is to log to <u><a href="../man3/syslog.3.html">syslog</a></u>(3) but this is configurable via the  <u>syslog</u>  and  <u>logfile</u>
       settings.  See “EVENT LOGGING” for a description of the log file format.

       <b>sudoers</b>  is  also capable of running a command in a pseudo-terminal and logging input and/or output.  The
       standard input, standard output, and standard error can  be  logged  even  when  not  associated  with  a
       terminal.  For more information about I/O logging, see the “I/O LOGGING” section.

       Starting with version 1.9, the <u>log_servers</u> setting may be used to send event and I/O log data to a remote
       server   running   <b>sudo_logsrvd</b>   or   another   service   that  implements  the  protocol  described  by
       <u><a href="../man5/sudo_logsrv.proto.5.html">sudo_logsrv.proto</a></u>(5).

   <b>Command</b> <b>environment</b>
       Since environment variables can influence program behavior, <b>sudoers</b> provides a means  to  restrict  which
       variables  from  the  user's  environment are inherited by the command to be run.  There are two distinct
       ways <b>sudoers</b> can deal with environment variables.

       By default, the <u>env_reset</u> flag is enabled.  This causes commands to  be  executed  with  a  new,  minimal
       environment.  On AIX (and Linux systems without PAM), the environment is initialized with the contents of
       the <u><a href="file:/etc/environment">/etc/environment</a></u> file.  The HOME, MAIL, SHELL, LOGNAME and USER environment variables are initialized
       based  on  the  target  user  and  the  SUDO_*  variables are set based on the invoking user.  Additional
       variables, such as DISPLAY, PATH and  TERM,  are  preserved  from  the  invoking  user's  environment  if
       permitted  by the <u>env_check</u>, or <u>env_keep</u> options.  A few environment variables are treated specially.  If
       the PATH and TERM variables are not preserved from the user's environment, they will be  set  to  default
       values.   The  LOGNAME and USER are handled as a single entity.  If one of them is preserved (or removed)
       from the user's environment, the other will be as well.  If LOGNAME and USER are to be preserved but only
       one of them is present in the user's environment, the other will be set to the same value.   This  avoids
       an  inconsistent  environment  where one of the variables describing the user name is set to the invoking
       user and one is set to the target user.  Environment variables with  a  value  beginning  with  ‘()’  are
       removed  unless  both  the  name  and  value  parts  are matched by <u>env_keep</u> or <u>env_check</u>, as they may be
       interpreted as functions by the <b>bash</b> shell.  Prior to version 1.8.11, such variables were always removed.

       If, however, the <u>env_reset</u> flag is disabled, any variables not explicitly denied  by  the  <u>env_check</u>  and
       <u>env_delete</u>  options  are  allowed  and  their  values  are inherited from the invoking process.  Prior to
       version 1.8.21, environment variables with a value beginning with ‘()’ were  always  removed.   Beginning
       with  version 1.8.21, a pattern in <u>env_delete</u> is used to match <b>bash</b> shell functions instead.  Since it is
       not possible to block all potentially dangerous environment  variables,  use  of  the  default  <u>env_reset</u>
       behavior is encouraged.

       Environment  variables  specified  by  <u>env_check</u>,  <u>env_delete</u>,  or  <u>env_keep</u>  may include one or more ‘*’
       characters which will match zero or more characters.  No other wildcard characters are supported.

       By default, environment variables are matched by name.  However, if the pattern includes  an  equal  sign
       (‘=’), both the variables name and value must match.  For example, a <b>bash</b> shell function could be matched
       as follows:

           env_keep += "BASH_FUNC_my_func%%=()*"

       Without the ‘=()*’ suffix, this would not match, as <b>bash</b> shell functions are not preserved by default.

       The  complete list of environment variables that are preserved or removed, as modified by global Defaults
       parameters in <u>sudoers</u>, is displayed when <b>sudo</b> is run by <b>root</b> with the <b>-V</b> option.  The list of environment
       variables to remove varies based on the operating system <b>sudo</b> is running on.

       Other settings may influence the command environment:

       <b>•</b>  <b>sudoers</b> options such as <u>always_set_home</u>, <u>secure_path</u>, <u>set_logname</u>, <u>set_home</u>, and <u>setenv</u>.

       <b>•</b>  Command tags, such as SETENV and NOSETENV.  Note that SETENV is implied if the command matched is <b>ALL</b>.

       <b>•</b>  <b>sudo</b> options, such as <b>-E</b> and <b>-i</b>.

       On systems that support PAM where  the  <b>pam_env</b>  module  is  enabled  for  <b>sudo</b>,  variables  in  the  PAM
       environment may be merged in to the environment.  If a variable in the PAM environment is already present
       in  the  user's  environment,  the  value  will  only  be overridden if the variable was not preserved by
       <b>sudoers</b>.  When <u>env_reset</u> is enabled, variables preserved from the  invoking  user's  environment  by  the
       <u>env_keep</u>  list  take precedence over those in the PAM environment.  When <u>env_reset</u> is disabled, variables
       present the invoking user's environment take precedence over those in the  PAM  environment  unless  they
       match a pattern in the <u>env_delete</u> list.

       The  dynamic linker on most operating systems will remove variables that can control dynamic linking from
       the environment of set-user-ID executables, including <b>sudo</b>.  Depending on the operating system  this  may
       include _RLD*, DYLD_*, LD_*, LDR_*, LIBPATH, SHLIB_PATH, and others.  These type of variables are removed
       from  the  environment  before  <b>sudo</b>  even  begins execution and, as such, it is not possible for <b>sudo</b> to
       preserve them.

       As a special case, if the <b>-i</b> option (initial login) is specified, <b>sudoers</b> will initialize the environment
       regardless of the value of <u>env_reset</u>.  The DISPLAY, PATH and TERM variables remain unchanged; HOME, MAIL,
       SHELL, USER, and LOGNAME are set based on the target user.  On AIX (and Linux systems without  PAM),  the
       contents  of  <u><a href="file:/etc/environment">/etc/environment</a></u>  are  also  included.   All other environment variables are removed unless
       permitted by <u>env_keep</u> or <u>env_check</u>, described above.

       Finally, the  <u>restricted_env_file</u>  and  <u>env_file</u>  files  are  applied,  if  present.   The  variables  in
       <u>restricted_env_file</u>  are  applied  first  and are subject to the same restrictions as the invoking user's
       environment, as detailed above.  The variables in <u>env_file</u> are applied last and are not subject to  these
       restrictions.   In  both cases, variables present in the files will only be set to their specified values
       if they would not conflict with an existing environment variable.

</pre><h4><b>SUDOERS</b> <b>FILE</b> <b>FORMAT</b></h4><pre>
       The <u>sudoers</u>  file  is  composed  of  two  types  of  entries:  aliases  (basically  variables)  and  user
       specifications (which specify who may run what).

       When multiple entries match for a user, they are applied in order.  Where there are multiple matches, the
       last match is used (which is not necessarily the most specific match).

       The  <u>sudoers</u>  file grammar will be described below in Extended Backus-Naur Form (EBNF).  Don't despair if
       you are unfamiliar with EBNF; it is fairly simple, and the definitions below are annotated.

   <b>Resource</b> <b>limits</b>
       By default, <b>sudoers</b> uses the operating system's native method of setting resource limits for  the  target
       user.   On  Linux  systems, resource limits are usually set by the <u>pam_limits.so</u> PAM module.  On some BSD
       systems, the <u>/etc/login.conf</u> file specifies resource limits for  the  user.   On  AIX  systems,  resource
       limits  are configured in the <u>/etc/security/limits</u> file.  If there is no system mechanism to set per-user
       resource limits, the command will run with the same limits as the invoking user.  The  one  exception  to
       this  is  the  core  dump  file  size,  which is set by <b>sudoers</b> to 0 by default.  Disabling core dumps by
       default makes it possible to avoid potential security problems where the core file is treated as  trusted
       input.

       Resource  limits may also be set in the <u>sudoers</u> file itself, in which case they override those set by the
       system.   See  the  <u>rlimit_as,</u>  <u>rlimit_core,</u>   <u>rlimit_cpu,</u>   <u>rlimit_data,</u>   <u>rlimit_fsize,</u>   <u>rlimit_locks,</u>
       <u>rlimit_memlock,</u>  <u>rlimit_nofile,</u> <u>rlimit_nproc,</u> <u>rlimit_rss,</u> <u>rlimit_stack</u> options described below.  Resource
       limits in <b>sudoers</b> may be specified in one of the following formats:

       “value”
               Both the soft and hard resource limits are set to the same value.  The special  value  “infinity”
               can be used to indicate that the value is unlimited.

       “soft,hard”
               Two  comma-separated  values.  The soft limit is set to the first value and the hard limit is set
               to the second.  Both values must either be enclosed in a set of double quotes, or the comma  must
               be  escaped  with a backslash (‘\’).  The special value “infinity” may be used in place of either
               value.

       “default”
               The default resource limit for the user will be used.  This may be  a  user-specific  value  (see
               above)  or  the  value of the resource limit when <b>sudo</b> was invoked for systems that don't support
               per-user limits.

       “user”  The invoking user's resource limits will be preserved when running the command.

       For example, to restore the historic core dump file size behavior, a line like the following may be used.

             <b>Defaults</b> <b>rlimit_core=default</b>

       Resource limits in <b>sudoers</b> are only supported by version 1.8.7 or higher.

   <b>Quick</b> <b>guide</b> <b>to</b> <b>EBNF</b>
       EBNF is a concise and exact way of describing the grammar of a language.  Each EBNF definition is made up
       of <u>production</u> <u>rules</u>.  For example:

           symbol ::= definition | alternate1 | alternate2 ...

       Each <u>production</u> <u>rule</u> references others and thus makes up a grammar for the language.  EBNF also  contains
       the  following  operators,  which many readers will recognize from regular expressions.  Do not, however,
       confuse them with “wildcard” characters, which have different meanings.

       ?     Means that the preceding symbol (or group of symbols) is optional.  That is, it may appear once  or
             not at all.

       *     Means that the preceding symbol (or group of symbols) may appear zero or more times.

       +     Means that the preceding symbol (or group of symbols) may appear one or more times.

       Parentheses  may  be  used  to  group  symbols  together.  For clarity, we will use single quotes ('') to
       designate what is a verbatim character string (as opposed to a symbol name).

   <b>Aliases</b>
       There are four kinds of aliases: <u>User_Alias</u>, <u>Runas_Alias</u>, <u>Host_Alias</u> and <u>Cmnd_Alias</u>.  Beginning with <b>sudo</b>
       1.9.0, <u>Cmd_Alias</u> may be used in place of <u>Cmnd_Alias</u> if desired.

       Alias ::= 'User_Alias'  User_Alias_Spec (':' User_Alias_Spec)* |
                 'Runas_Alias' Runas_Alias_Spec (':' Runas_Alias_Spec)* |
                 'Host_Alias'  Host_Alias_Spec (':' Host_Alias_Spec)* |
                 'Cmnd_Alias'  Cmnd_Alias_Spec (':' Cmnd_Alias_Spec)* |
                 'Cmd_Alias'   Cmnd_Alias_Spec (':' Cmnd_Alias_Spec)*

       User_Alias ::= NAME

       User_Alias_Spec ::= User_Alias '=' User_List

       Runas_Alias ::= NAME

       Runas_Alias_Spec ::= Runas_Alias '=' Runas_List

       Host_Alias ::= NAME

       Host_Alias_Spec ::= Host_Alias '=' Host_List

       Cmnd_Alias ::= NAME

       Cmnd_Alias_Spec ::= Cmnd_Alias '=' Cmnd_List

       NAME ::= [A-Z]([A-Z][0-9]_)*

       Each <u>alias</u> definition is of the form

       Alias_Type NAME = item1, item2, ...

       where <u>Alias_Type</u> is one of <u>User_Alias</u>, <u>Runas_Alias</u>, <u>Host_Alias</u>, or <u>Cmnd_Alias</u>.  A NAME  is  a  string  of
       uppercase letters, numbers, and underscore characters (‘_’).  A NAME <b>must</b> start with an uppercase letter.
       It  is  possible  to  put  several alias definitions of the same type on a single line, joined by a colon
       (‘:’).  For example:

       Alias_Type NAME = item1, item2, item3 : NAME = item4, item5

       It is a syntax error to redefine an existing <u>alias</u>.  It is possible to use the same name for  <u>aliases</u>  of
       different types, but this is not recommended.

       The definitions of what constitutes a valid <u>alias</u> member follow.

       User_List ::= User |
                     User ',' User_List

       User ::= '!'* user name |
                '!'* #user-ID |
                '!'* %group |
                '!'* %#group-ID |
                '!'* +netgroup |
                '!'* %:nonunix_group |
                '!'* %:#nonunix_gid |
                '!'* User_Alias

       A  <u>User_List</u>  is  made up of one or more user names, user-IDs (prefixed with ‘#’), system group names and
       IDs (prefixed with ‘%’ and ‘%#’ respectively), netgroups (prefixed with ‘+’), non-Unix  group  names  and
       IDs  (prefixed  with  ‘%:’ and ‘%:#’ respectively), and <u>User_Alias</u>es. Each list item may be prefixed with
       zero or more ‘!’ operators.  An odd number of ‘!’ operators negate the value of the item; an even  number
       just  cancel each other out.  User netgroups are matched using the user and domain members only; the host
       member is not used when matching.

       A <u>user</u> <u>name</u>, <u>user-ID</u>, <u>group</u>, <u>group-ID</u>, <u>netgroup</u>, <u>nonunix_group</u> or <u>nonunix_gid</u> may be enclosed  in  double
       quotes  to  avoid  the  need  for  escaping  special  characters.  Alternately, special characters may be
       specified in escaped hex mode, e.g., \x20 for space.  When using double  quotes,  any  prefix  characters
       must be included inside the quotes.

       The  actual  <u>nonunix_group</u>  and  <u>nonunix_gid</u> syntax depends on the underlying group provider plugin.  For
       instance, the QAS AD plugin supports the following formats:

       <b>•</b>  Group in the same domain: "%:Group Name"

       <b>•</b>  Group in any domain: "%:Group <a href="mailto:Name@FULLY.QUALIFIED.DOMAIN">Name@FULLY.QUALIFIED.DOMAIN</a>"

       <b>•</b>  Group SID: "%:S-1-2-34-5678901234-5678901234-5678901234-567"

       See “GROUP PROVIDER PLUGINS” for more information.

       Quotes around group names are optional.  Unquoted strings must use a backslash (‘\’) to escape spaces and
       special characters.  See “Other special characters and reserved words” for a list of characters that need
       to be escaped.

       Runas_List ::= Runas_Member |
                      Runas_Member ',' Runas_List

       Runas_Member ::= '!'* user name |
                        '!'* #user-ID |
                        '!'* %group |
                        '!'* %#group-ID |
                        '!'* %:nonunix_group |
                        '!'* %:#nonunix_gid |
                        '!'* +netgroup |
                        '!'* Runas_Alias |
                        '!'* ALL

       A <u>Runas_List</u> is similar to a <u>User_List</u> except that instead of <u>User_Alias</u>es it can contain  <u>Runas_Alias</u>es.
       User  names  and  groups  are  matched as strings.  In other words, two users (groups) with the same user
       (group) ID are considered to be distinct.  If you wish to match all user  names  with  the  same  user-ID
       (e.g., <b>root</b> and <b>toor</b>), you can use a user-ID instead of a name (#0 in the example given).  The user-ID or
       group-ID specified in a <u>Runas_Member</u> need not be listed in the password or group database.

       Host_List ::= Host |
                     Host ',' Host_List

       Host ::= '!'* host name |
                '!'* ip_addr |
                '!'* network(/netmask)? |
                '!'* +netgroup |
                '!'* Host_Alias |
                '!'* ALL

       A <u>Host_List</u> is made up of one or more host names, IP addresses, network numbers, netgroups (prefixed with
       ‘+’),  and  other  aliases.   Again,  the  value  of  an item may be negated with the ‘!’ operator.  Host
       netgroups are matched using the host (both qualified and unqualified) and domain members only;  the  user
       member  is  not  used  when matching.  If you specify a network number without a netmask, <b>sudo</b> will query
       each of the local host's network interfaces and, if the network number corresponds to one of the  hosts's
       network  interfaces,  will  use  the  netmask  of that interface.  The netmask may be specified either in
       standard IP address notation (e.g., 255.255.255.0 or ffff:ffff:ffff:ffff::), or CIDR notation (number  of
       bits,  e.g.,  24  or  64).   A  host  name may include shell-style wildcards (see the “Wildcards” section
       below), but unless the <u>hostname</u> command on your machine returns the fully  qualified  host  name,  you'll
       need to use the <u>fqdn</u> flag for wildcards to be useful.  <b>sudo</b> only inspects actual network interfaces; this
       means  that IP address 127.0.0.1 (localhost) will never match.  Also, the host name “localhost” will only
       match if that is the actual host name, which is usually only the case for non-networked systems.

       digest ::= [A-Fa-f0-9]+ |
                  [A-Za-z0-9\+/=]+

       Digest_Spec ::= "sha224" ':' digest |
                       "sha256" ':' digest |
                       "sha384" ':' digest |
                       "sha512" ':' digest

       Digest_List ::= Digest_Spec |
                       Digest_Spec ',' Digest_List

       Cmnd_List ::= Cmnd |
                     Cmnd ',' Cmnd_List

       command name ::= regex |
                        file name

       command ::= command name |
                   command name args |
                   command name regex |
                   command name '""' |
                   ALL

       Edit_Spec ::= "sudoedit" file name+ |
                     "sudoedit" regex |
                     "sudoedit"

       List_Spec ::= "list"

       Cmnd ::= Digest_List? '!'* command |
                '!'* directory |
                '!'* Edit_Spec |
                '!'* List_Spec |
                '!'* Cmnd_Alias

       A <u>Cmnd_List</u> is a list of one or more commands, directories, or aliases.  A command is a  fully  qualified
       file  name,  which  may  include  shell-style wildcards (see the “Wildcards” section below), or a regular
       expression that starts with ‘^’ and ends with ‘$’ (see  the  “Regular  expressions”  section  below).   A
       directory  is  a fully qualified path name ending in a ‘/’.  When you specify a directory in a <u>Cmnd_List</u>,
       the user will be able to run any file within that directory (but not in any sub-directories therein).  If
       no command line arguments are specified, the user may run the command with  any  arguments  they  choose.
       Command  line  arguments  can  include wildcards or be a regular expression that starts with ‘^’ and ends
       with ‘$’.  If the command line arguments consist of ‘""’, the command may only be run with <u>no</u> arguments.

       If a <u>Cmnd</u> has associated command line arguments, the arguments in the <u>Cmnd</u> must match those given by  the
       user  on  the  command  line.   If  the  arguments  in  a <u>Cmnd</u> begin with the ‘^’ character, they will be
       interpreted as a regular expression and matched accordingly.  Otherwise, shell-style wildcards  are  used
       when matching.  Unless a regular expression is specified, the following characters must be escaped with a
       ‘\’ if they are used in command arguments: ‘,’, ‘:’, ‘=’, ‘\’.  To prevent arguments in a <u>Cmnd</u> that begin
       with a ‘^’ character from being interpreted as a regular expression, the ‘^’ must be escaped with a ‘\’.

       There  are  two commands built into <b>sudo</b> itself: “list” and “sudoedit”.  Unlike other commands, these two
       must be specified in the <u>sudoers</u> file <u>without</u> a leading path.

       The “list” built-in can be used to permit a user to list another user's privileges with <b>sudo</b>'s <b>-U</b> option.
       For example, “sudo -l -U otheruser”.  A user with the “list” privilege is able  to  list  another  user's
       privileges  even  if they don't have permission to run commands as that user.  By default, only root or a
       user with the ability to run any command as either root or the specified <u>user</u> on the current host may use
       the <b>-U</b> option.  No command line arguments may be specified with the “list” built-in.

       The “sudoedit” built-in is used to permit a user to run <b>sudo</b> with the <b>-e</b> option (or as <b>sudoedit</b>).  It may
       take command line arguments just as a normal command does.  Unlike other commands,  “sudoedit”  is  built
       into  <b>sudo</b> itself and must be specified in the <u>sudoers</u> file <u>without</u> a leading path.  If a leading path is
       present, for example <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sudoedit">/usr/bin/sudoedit</a></u>, the path name will be silently converted to “sudoedit”.  A fully-
       qualified path for <b>sudoedit</b> is treated as an error by <b>visudo</b>.

       A <u>command</u> may be preceded by a <u>Digest_List</u>, a comma-separated list of one or  more  <u>Digest_Spec</u>  entries.
       If  a <u>Digest_List</u> is present, the command will only match successfully if it can be verified using one of
       the SHA-2 digests in the list.  Starting with version 1.9.0,  the  <b>ALL</b>  reserved  word  can  be  used  in
       conjunction  with a <u>Digest_List</u>.  The following digest formats are supported: sha224, sha256, sha384, and
       sha512.  The string may be specified in either hex or base64 format (base64 is more compact).  There  are
       several  utilities  capable of generating SHA-2 digests in hex format such as openssl, shasum, sha224sum,
       sha256sum, sha384sum, sha512sum.

       For example, using openssl:

       $ openssl dgst -sha224 <a href="file:/bin/ls">/bin/ls</a>
       SHA224(<a href="file:/bin/ls">/bin/ls</a>)= 118187da8364d490b4a7debbf483004e8f3e053ec954309de2c41a25

       It is also possible to use openssl to generate base64 output:

       $ openssl dgst -binary -sha224 <a href="file:/bin/ls">/bin/ls</a> | openssl base64
       EYGH2oNk1JC0p9679IMATo8+BT7JVDCd4sQaJQ==

       Warning, if the user has write access to the command itself (directly or via a <b>sudo</b> command), it  may  be
       possible  for  the  user  to replace the command after the digest check has been performed but before the
       command is executed.  A similar race condition exists on systems that lack  the  <u><a href="../man2/fexecve.2.html">fexecve</a></u>(2)  system  call
       when  the  directory in which the command is located is writable by the user.  See the description of the
       <u>fdexec</u> setting for more information on how <b>sudo</b> executes commands that have an associated digest.

       Command digests are only supported by version 1.8.7 or higher.

   <b>Defaults</b>
       Certain configuration options may be changed from their default  values  at  run-time  via  one  or  more
       <u>Default_Entry</u>  lines.   These may affect all users on any host (‘Defaults’), all users on a specific host
       (‘Defaults@host’), a specific user (‘Defaults:user’), a specific command (‘Defaults!cmnd’),  or  commands
       being run as a specific user (‘Defaults&gt;runasuser’).

       White space is not permitted between ‘Defaults’ and the ‘@’, ‘:’, ‘!’, or ‘&gt;’ characters.  While a comma-
       separated list may be used in place of a single value after the ‘@’, ‘:’, ‘!’, or ‘&gt;’ character, using an
       alias  instead  of a list is often improve readability.  Per-command entries may not include command line
       arguments.  If you need to specify arguments, define a <u>Cmnd_Alias</u> and reference that instead.

       Default_Type ::= 'Defaults' |
                        'Defaults@' Host_List |
                        'Defaults:' User_List |
                        'Defaults!' Cmnd_List |
                        'Defaults&gt;' Runas_List

       Default_Entry ::= Default_Type Parameter_List

       Parameter_List ::= Parameter |
                          Parameter ',' Parameter_List

       Parameter ::= Parameter '=' Value |
                     Parameter '+=' Value |
                     Parameter '-=' Value |
                     '!'* Parameter

       Parameters may be <b>flags</b>, <b>integer</b> values, <b>strings</b>, or <b>lists</b>.  Flags are  implicitly  boolean  and  can  be
       turned  off via the ‘!’ operator.  Some integer, string and list parameters may also be used in a boolean
       context to disable them.  Values may be enclosed in double quotes ("") when they contain multiple  words.
       Special characters may be escaped with a backslash (‘\’).

       To  include a literal backslash character in a command line argument you must escape the backslash twice.
       For example, to match ‘\n’ as part of a command line argument, you must use ‘\\\\n’ in the <u>sudoers</u>  file.
       This  is  due  to  there  being two levels of escaping, one in the <u>sudoers</u> parser itself and another when
       command line arguments are matched by the <u><a href="../man3/fnmatch.3.html">fnmatch</a></u>(3) or <u><a href="../man3/regexec.3.html">regexec</a></u>(3) function.

       Lists have two additional assignment operators, ‘+=’ and ‘-=’.  These operators are used to  add  to  and
       delete  from  a list respectively.  It is not an error to use the ‘-=’ operator to remove an element that
       does not exist in a list.

       Defaults entries are parsed in the following order: global, host, user, and runas  Defaults  first,  then
       command defaults.  If there are multiple Defaults settings of the same type, the last matching setting is
       used.   The  following  Defaults  settings  are parsed before all others since they may affect subsequent
       entries: <u>fqdn</u>, <u>group_plugin</u>, <u>runas_default</u>, <u>sudoers_locale</u>.

       See “SUDOERS OPTIONS” for a list of supported Defaults parameters.

   <b>User</b> <b>specification</b>
       User_Spec ::= User_List Host_List '=' Cmnd_Spec_List \
                     (':' Host_List '=' Cmnd_Spec_List)*

       Cmnd_Spec_List ::= Cmnd_Spec |
                          Cmnd_Spec ',' Cmnd_Spec_List

       Cmnd_Spec ::= Runas_Spec? Option_Spec* (Tag_Spec ':')* Cmnd

       Runas_Spec ::= '(' Runas_List? (':' Runas_List)? ')'

       Option_Spec ::= (SELinux_Spec | Date_Spec | Timeout_Spec | Chdir_Spec | Chroot_Spec)

       SELinux_Spec ::= ('ROLE=role' | 'TYPE=type')

       AppArmor_Spec ::= 'APPARMOR_PROFILE=profile'

       Date_Spec ::= ('NOTBEFORE=timestamp' | 'NOTAFTER=timestamp')

       Timeout_Spec ::= 'TIMEOUT=timeout'

       Chdir_Spec ::= 'CWD=directory'

       Chroot_Spec ::= 'CHROOT=directory'

       Tag_Spec ::= ('EXEC' | 'NOEXEC' | 'FOLLOW' | 'NOFOLLOW' |
                     'LOG_INPUT' | 'NOLOG_INPUT' | 'LOG_OUTPUT' |
                     'NOLOG_OUTPUT' | 'MAIL' | 'NOMAIL' | 'INTERCEPT' |
                     'NOINTERCEPT' | 'PASSWD' | 'NOPASSWD' | 'SETENV' |
                     'NOSETENV')

       A <b>user</b> <b>specification</b> determines which commands a user may run (and as what user) on specified hosts.   By
       default,  commands  are run as <b>root</b> (unless <u>runas_default</u> has been set to a different value) but this can
       also be changed on a per-command basis.

       The basic structure of a user specification is “who where = (as_whom) what”.  Let's break that down  into
       its constituent parts:

   <b>Runas_Spec</b>
       A  <u>Runas_Spec</u>  determines  the  user  and/or  the  group that a command may be run as.  A fully-specified
       <u>Runas_Spec</u> consists of two <u>Runas_List</u>s (as defined above) separated by a colon (‘:’) and  enclosed  in  a
       set  of  parentheses.   The  first  <u>Runas_List</u> indicates which users the command may be run as via the <b>-u</b>
       option.  The second defines a list of groups that may be specified via the <b>-g</b> option (in addition to  any
       of  the  target  user's  groups).   If  both  <u>Runas_List</u>s  are specified, the command may be run with any
       combination of users and groups listed in their respective <u>Runas_List</u>s. If only the first  is  specified,
       the  command  may  be run as any user in the list and, optionally, with any group the target user belongs
       to.  If the first <u>Runas_List</u> is empty but the second is specified, the command may be run as the invoking
       user with the group set to any listed in the <u>Runas_List</u>.  If both <u>Runas_List</u>s are empty, the command  may
       only  be  run  as  the invoking user and the group, if specified, must be one that the invoking user is a
       member of.  If no <u>Runas_Spec</u> is specified, the command may only be run as the <u>runas_default</u> user (<b>root</b> by
       default) and the group, if specified, must be one that the <u>runas_default</u> user is a member of.

       A <u>Runas_Spec</u> sets the default for the commands that follow it.  What this means is that for the entry:

       dgb     boulder = (operator) <a href="file:/bin/ls">/bin/ls</a>, <a href="file:/bin/kill">/bin/kill</a>, /usr/bin/lprm

       The user <b>dgb</b> may run <u><a href="file:/bin/ls">/bin/ls</a></u>, <u><a href="file:/bin/kill">/bin/kill</a></u>, and <u>/usr/bin/lprm</u> on the host boulder—but only as <b>operator</b>.  For
       example:

       $ sudo -u operator <a href="file:/bin/ls">/bin/ls</a>

       It is also possible to override a <u>Runas_Spec</u> later on in an entry.  If we modify the entry like so:

       dgb     boulder = (operator) <a href="file:/bin/ls">/bin/ls</a>, (root) <a href="file:/bin/kill">/bin/kill</a>, /usr/bin/lprm

       Then user <b>dgb</b> is now allowed to run <u><a href="file:/bin/ls">/bin/ls</a></u> as <b>operator</b>, but <u><a href="file:/bin/kill">/bin/kill</a></u> and <u>/usr/bin/lprm</u> as <b>root</b>.

       We can extend this to allow <b>dgb</b> to run <u><a href="file:/bin/ls">/bin/ls</a></u> with either the user or group set to <b>operator</b>:

       dgb     boulder = (operator : operator) <a href="file:/bin/ls">/bin/ls</a>, (root) <a href="file:/bin/kill">/bin/kill</a>,\
               /usr/bin/lprm

       While the group portion of the <u>Runas_Spec</u> permits the user to run as command with that group, it does not
       force the user to do so.  If no group is specified on the command line, the command  will  run  with  the
       group  listed  in the target user's password database entry.  The following would all be permitted by the
       sudoers entry above:

       $ sudo -u operator <a href="file:/bin/ls">/bin/ls</a>
       $ sudo -u operator -g operator <a href="file:/bin/ls">/bin/ls</a>
       $ sudo -g operator <a href="file:/bin/ls">/bin/ls</a>

       In the following example, user <b>tcm</b> may run commands that access a  modem  device  file  with  the  dialer
       group.

       tcm     boulder = (:dialer) /usr/bin/tip, /usr/bin/cu,\
               /usr/local/bin/minicom

       In this example only the group will be set, the command still runs as user <b>tcm</b>.  For example:

       $ sudo -g dialer /usr/bin/cu

       Multiple  users  and  groups  may  be  present  in  a  <u>Runas_Spec</u>,  in which case the user may select any
       combination of users and groups via the <b>-u</b> and <b>-g</b> options.  In this example:

       alan    ALL = (root, bin : operator, system) ALL

       user <b>alan</b> may run any command as either user <b>root</b> or <b>bin</b>, optionally setting the  group  to  operator  or
       system.

   <b>Option_Spec</b>
       A  <u>Cmnd</u>  may  have  zero or more options associated with it.  Options may consist of SELinux roles and/or
       types, AppArmor profiles, start and/or end dates and command timeouts.  Once an option is set for a <u>Cmnd</u>,
       subsequent <u>Cmnd</u>s in the <u>Cmnd_Spec_List</u>, inherit that option unless it is overridden  by  another  option.
       Option  names  are reserved words in <u>sudoers</u>.  This means that none of the valid option names (see below)
       can be used when declaring an alias.

   <b>SELinux_Spec</b>
       On systems with SELinux support, <u>sudoers</u> file entries may optionally have an  SELinux  role  and/or  type
       associated with a command.  This can be used to implement a form of role-based access control (RBAC).  If
       a role or type is specified with the command it will override any default values specified in <u>sudoers</u>.  A
       role or type specified on the command line, however, will supersede the values in <u>sudoers</u>.

   <b>AppArmor_Spec</b>
       On  systems  supporting  AppArmor,  <u>sudoers</u>  file entries may optionally specify an AppArmor profile that
       should be used to confine a command.  If an AppArmor profile is  specified  with  the  command,  it  will
       override  any  default values specified in <u>sudoers</u>.  Appropriate profile transition rules must be defined
       to support the profile change specified for a user.

       AppArmor profiles can be specified in any way that complies with the rules of <u><a href="../man2/aa_change_profile.2.html">aa_change_profile</a></u>(2).   For
       instance, in the following <u>sudoers</u> entry

       alice   ALL = (root)    APPARMOR_PROFILE=my-profile     ALL

       the  user  <b>alice</b> may run any command as <b>root</b> under confinement by the profile ‘my-profile’.  You can also
       stack profiles, or allow a user to run commands unconfined by any profile.  For example:

       bob     ALL = (root)    APPARMOR_PROFILE=foo//&amp;bar      <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vi">/usr/bin/vi</a>
       cathy   ALL = (root)    APPARMOR_PROFILE=unconfined     <a href="file:/bin/ls">/bin/ls</a>

       These <u>sudoers</u> entries allow user <b>bob</b> to run <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vi">/usr/bin/vi</a></u> as <b>root</b> under  the  stacked  profiles  ‘foo’  and
       ‘bar’, and user <b>cathy</b> to run <u><a href="file:/bin/ls">/bin/ls</a></u> without any confinement at all.

   <b>Date_Spec</b>
       <b>sudoers</b>  rules  can  be specified with a start and end date via the NOTBEFORE and NOTAFTER settings.  The
       time stamp must be specified in “Generalized Time” as defined by RFC 4517.   The  format  is  effectively
       ‘yyyymmddHHMMSSZ’  where  the  minutes  and seconds are optional.  The ‘Z’ suffix indicates that the time
       stamp is in Coordinated Universal Time (UTC).  It is also possible to specify a timezone offset from  UTC
       in hours and minutes instead of a ‘Z’.  For example, ‘-0500’ would correspond to Eastern Standard time in
       the US.  As an extension, if no ‘Z’ or timezone offset is specified, local time will be used.

       The following are all valid time stamps:

           20170214083000Z
           2017021408Z
           20160315220000-0500
           20151201235900

   <b>Timeout_Spec</b>
       A  command  may have a timeout associated with it.  If the timeout expires before the command has exited,
       the command will be terminated.  The timeout may be specified in combinations of  days,  hours,  minutes,
       and seconds with a single-letter case-insensitive suffix that indicates the unit of time.  For example, a
       timeout  of 7 days, 8 hours, 30 minutes, and 10 seconds would be written as ‘7d8h30m10s’.  If a number is
       specified without a unit, seconds are assumed.  Any of the  days,  minutes,  hours,  or  seconds  may  be
       omitted.  The order must be from largest to smallest unit and a unit may not be specified more than once.

       The  following are all <u>valid</u> timeout values: ‘7d8h30m10s’, ‘14d’, ‘8h30m’, ‘600s’, ‘3600’.  The following
       are <u>invalid</u> timeout values: ‘12m2w1d’, ‘30s10m4h’, ‘1d2d3h’.

       This setting is only supported by version 1.8.20 or higher.

   <b>Chdir_Spec</b>
       The working directory that the command will be run in can  be  specified  using  the  CWD  setting.   The
       <u>directory</u> must be a fully-qualified path name beginning with a ‘/’ or ‘~’ character, or the special value
       “*”.   A  value of “*” indicates that the user may specify the working directory by running <b>sudo</b> with the
       <b>-D</b> option.  By default, commands are run from the invoking user's current working directory,  unless  the
       <b>-i</b>  option  is  given.   Path  names of the form <u>~user/path/name</u> are interpreted as being relative to the
       named user's home directory.  If the user name is omitted, the path will be relative to the runas  user's
       home directory.

       This setting is only supported by version 1.9.3 or higher.

   <b>Chroot_Spec</b>
       The  root  directory  that  the  command  will  be run in can be specified using the CHROOT setting.  The
       <u>directory</u> must be a fully-qualified path name beginning with a ‘/’ or ‘~’ character, or the special value
       “*”.  A value of “*” indicates that the user may specify the root directory by running <b>sudo</b> with  the  <b>-R</b>
       option.   This  setting  can be used to run the command in a <u><a href="../man2/chroot.2.html">chroot</a></u>(2) “sandbox” similar to the <u><a href="../man8/chroot.8.html">chroot</a></u>(8)
       utility.  Path names of the form <u>~user/path/name</u> are interpreted as being relative to  the  named  user's
       home  directory.   If  the  user  name  is  omitted,  the  path will be relative to the runas user's home
       directory.

       This setting is only supported by version 1.9.3 or higher.

   <b>Tag_Spec</b>
       A command may have zero or more tags associated with it.  The following tag values are  supported:  EXEC,
       NOEXEC,  FOLLOW,  NOFOLLOW,  LOG_INPUT,  NOLOG_INPUT,  LOG_OUTPUT, NOLOG_OUTPUT, MAIL, NOMAIL, INTERCEPT,
       NOINTERCEPT, PASSWD, NOPASSWD, SETENV, and NOSETENV.  Once a tag is set on a <u>Cmnd</u>,  subsequent  <u>Cmnd</u>s  in
       the  <u>Cmnd_Spec_List</u>,  inherit the tag unless it is overridden by the opposite tag (in other words, PASSWD
       overrides NOPASSWD and NOEXEC overrides EXEC).

       EXEC and NOEXEC

         If <b>sudo</b> has been compiled with <u>noexec</u> support and the underlying  operating  system  supports  it,  the
         NOEXEC tag can be used to prevent a dynamically-linked executable from running further commands itself.

         In  the  following  example,  user  <b>aaron</b> may run <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?more">/usr/bin/more</a></u> and <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vi">/usr/bin/vi</a></u> on the host shanty, but
         shell escapes will be disabled.

         aaron   shanty = NOEXEC: <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?more">/usr/bin/more</a>, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vi">/usr/bin/vi</a>

         See the “Preventing shell escapes” section below for more details on how NOEXEC works  and  whether  or
         not it will work on your system.

       FOLLOW and NOFOLLOW

         Starting  with  version  1.8.15,  <b>sudoedit</b>  will  not  open  a  file that is a symbolic link unless the
         <u>sudoedit_follow</u> flag is enabled.  The FOLLOW and NOFOLLOW tags override the  value  of  <u>sudoedit_follow</u>
         and  can  be used to permit (or deny) the editing of symbolic links on a per-command basis.  These tags
         are only effective for the <u>sudoedit</u> command and are ignored for all other commands.

       LOG_INPUT and NOLOG_INPUT

         These tags override the value of the <u>log_input</u> flag on a per-command basis.  For more information,  see
         “I/O LOGGING”.

       LOG_OUTPUT and NOLOG_OUTPUT

         These tags override the value of the <u>log_output</u> flag on a per-command basis.  For more information, see
         “I/O LOGGING”.

       MAIL and NOMAIL

         These  tags  provide  fine-grained control over whether mail will be sent when a user runs a command by
         overriding the value of the <u>mail_all_cmnds</u> flag on a per-command basis.  They have no effect when  <b>sudo</b>
         is  run  with  the <b>-l</b> or <b>-v</b> options.  A NOMAIL tag will also override the <u>mail_always</u> and <u>mail_no_perms</u>
         options.  For more information, see the descriptions of <u>mail_all_cmnds</u>, <u>mail_always</u>, and  <u>mail_no_perms</u>
         in the “SUDOERS OPTIONS” section below.

       PASSWD and NOPASSWD

         By  default,  <b>sudo</b>  requires  that  a user authenticate before running a command.  This behavior can be
         modified via the NOPASSWD tag.  Like a <u>Runas_Spec</u>, the NOPASSWD tag sets a  default  for  the  commands
         that  follow  it in the <u>Cmnd_Spec_List</u>.  Conversely, the PASSWD tag can be used to reverse things.  For
         example:

         ray     rushmore = NOPASSWD: <a href="file:/bin/kill">/bin/kill</a>, <a href="file:/bin/ls">/bin/ls</a>, /usr/bin/lprm

         would allow the user <b>ray</b> to run <u><a href="file:/bin/kill">/bin/kill</a></u>, <u><a href="file:/bin/ls">/bin/ls</a></u>, and <u>/usr/bin/lprm</u> as <b>root</b> on the machine “rushmore”
         without authenticating himself.  If we only want <b>ray</b> to be able to run <u><a href="file:/bin/kill">/bin/kill</a></u> without a password the
         entry would be:

         ray     rushmore = NOPASSWD: <a href="file:/bin/kill">/bin/kill</a>, PASSWD: <a href="file:/bin/ls">/bin/ls</a>, /usr/bin/lprm

         Note, however, that the PASSWD tag has no effect on users  who  are  in  the  group  specified  by  the
         <u>exempt_group</u> setting.

         By  default,  if  the NOPASSWD tag is applied to any of a user's entries for the current host, the user
         will be able to run ‘sudo -l’ without a password.  Additionally, a user may only run ‘sudo -v’  without
         a  password if all of the user's entries for the current host have the NOPASSWD tag.  This behavior may
         be overridden via the <u>verifypw</u> and <u>listpw</u> options.

       SETENV and NOSETENV

         These tags override the value of the <u>setenv</u> flag on a per-command basis.  If SETENV has been set for  a
         command,  the  user  may  disable  the  <u>env_reset</u>  flag  from  the  command  line  via  the  <b>-E</b> option.
         Additionally, environment variables set on the command line are not subject to the restrictions imposed
         by <u>env_check</u>, <u>env_delete</u>, or <u>env_keep</u>.  As such, only trusted users should be allowed to set  variables
         in  this  manner.   If  the  command  matched  is <b>ALL</b>, the SETENV tag is implied for that command; this
         default may be overridden by use of the NOSETENV tag.

       INTERCEPT and NOINTERCEPT

         If <b>sudo</b> has been compiled with <u>intercept</u> support and the underlying operating system supports  it,  the
         INTERCEPT  tag  can  be used to cause programs spawned by a command to be validated against <u>sudoers</u> and
         logged just like they would be if run through <b>sudo</b>  directly.   This  is  useful  in  conjunction  with
         commands  that  allow  shell  escapes  such  as  editors,  shells, and paginators.  There is additional
         overhead due to the policy check that may add latency when running commands such as shell scripts  that
         execute  a  large  number  of  sub-commands.   For interactive commands, such as a shell or editor, the
         overhead is not usually noticeable.

         In the following example, user <b>chuck</b> may run any command on the machine “research” in intercept mode.

         chuck   research = INTERCEPT: ALL

         See the “Preventing shell escapes” section below for more details on how INTERCEPT works and whether or
         not it will work on your system.

   <b>Wildcards</b>
       <b>sudo</b> allows shell-style <u>wildcards</u> (aka meta or glob characters) to be used in host names, path names, and
       command line arguments in the <u>sudoers</u> file.  Wildcard matching is done via  the  <u><a href="../man3/glob.3.html">glob</a></u>(3)  and  <u><a href="../man3/fnmatch.3.html">fnmatch</a></u>(3)
       functions as specified by IEEE Std 1003.1 (“POSIX.1”).

       *       Matches any set of zero or more characters (including white space).

       ?       Matches any single character (including white space).

       [...]   Matches any character in the specified range.

       [!...]  Matches any character <u>not</u> in the specified range.

       \x      For any character ‘x’, evaluates to ‘x’.  This is used to escape special characters such as: ‘*’,
               ‘?’, ‘[’, and ‘]’.

       <b>These</b>  <b>are</b>  <b>not</b>  <b>regular</b>  <b>expressions.</b>   Unlike a regular expression there is no way to match one or more
       characters within a range.

       Character classes may be used if your system's <u><a href="../man3/glob.3.html">glob</a></u>(3) and <u><a href="../man3/fnmatch.3.html">fnmatch</a></u>(3) functions support  them.   However,
       because the ‘:’ character has special meaning in <u>sudoers</u>, it must be escaped.  For example:

           <a href="file:/bin/ls">/bin/ls</a> [[\:alpha\:]]*

       Would match any file name beginning with a letter.

       A  forward  slash  (‘/’)  will  <u>not</u> be matched by wildcards used in the file name portion of the command.
       This is to make a path like:

           <a href="file:/usr/bin/">/usr/bin/</a>*

       match <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?who">/usr/bin/who</a></u> but not <u>/usr/bin/X11/xterm</u>.

       When matching the command line arguments, however, a slash <u>does</u> get matched by  wildcards  since  command
       line arguments may contain arbitrary strings and not just path names.

       <b>Wildcards</b> <b>in</b> <b>command</b> <b>line</b> <b>arguments</b> <b>should</b> <b>be</b> <b>used</b> <b>with</b> <b>care.</b>
       Wildcards  can  match  any character, including white space.  In most cases, it is safer to use a regular
       expression to match command line arguments.  For more information, see “Wildcards in  command  arguments”
       below.

   <b>Exceptions</b> <b>to</b> <b>wildcard</b> <b>rules</b>
       The following exceptions apply to the above rules:

       ""        If  the  empty string ‘""’ is the only command line argument in the <u>sudoers</u> file entry it means
                 that command is not allowed to be run with <u>any</u> arguments.

       sudoedit  Command line arguments to the <u>sudoedit</u> built-in command should  always  be  path  names,  so  a
                 forward slash (‘/’) will not be matched by a wildcard.

   <b>Regular</b> <b>expressions</b>
       Starting  with  version 1.9.10, it is possible to use regular expressions for path names and command line
       arguments.  Regular expressions are more expressive than shell-style  <u>wildcards</u>  and  are  usually  safer
       because  they  provide  a  greater  degree  of  control  when  matching.  The type of regular expressions
       supported by <b>sudoers</b> are POSIX extended regular expressions,  similar  to  those  used  by  the  <u><a href="../man1/egrep.1.html">egrep</a></u>(1)
       utility.   They  are  usually documented in the <u><a href="../man7/regex.7.html">regex</a></u>(7) or <u><a href="../man7/re_format.7.html">re_format</a></u>(7) manual, depending on the system.
       As an extension, if the regular expression begins with “(?i)”, it will be matched in  a  case-insensitive
       manner.

       In  <u>sudoers</u>,  regular  expressions  must  start  with  a ‘^’ character and end with a ‘$’.  This makes it
       explicit what is, or is not, a regular expression.  Either the path name, the command line  arguments  or
       both  may be regular expressions.  Because the path name and arguments are matched separately, it is even
       possible to use wildcards for the path name and  regular  expressions  for  the  arguments.   It  is  not
       possible  to  use  a  single  regular  expression  to  match both the command and its arguments.  Regular
       expressions in <u>sudoers</u> are limited to 1024 characters.

       There is no need to escape <u>sudoers</u> special characters in a regular expression other than the  pound  sign
       (‘#’).

       In  the following example, user <b>john</b> can run the <u><a href="../man1/passwd.1.html">passwd</a></u>(1) command as <b>root</b> on any host but is not allowed
       to change <b>root</b>'s password.  This kind of rule is impossible to express safely using wildcards.

           john    ALL = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?passwd">/usr/bin/passwd</a> ^[a-zA-Z0-9_]+$,\
                         !<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?passwd">/usr/bin/passwd</a> root

       It is also possible to use a regular expression in conjunction with <b>sudoedit</b> rules.  The  following  rule
       would give user bob the ability to edit the <u>/etc/motd</u>, <u><a href="file:/etc/issue">/etc/issue</a></u>, and <u><a href="file:/etc/hosts">/etc/hosts</a></u> files only.

           bob    ALL = sudoedit ^<a href="file:/etc/">/etc/</a>(motd|issue|hosts)$

       Regular  expressions may also be used to match the command itself.  In this example, a regular expression
       is used to  allow  user  <b>sid</b>  to  run  the  <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?groupadd">/usr/sbin/groupadd</a></u>,  <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?groupmod">/usr/sbin/groupmod</a></u>,  <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?groupdel">/usr/sbin/groupdel</a></u>,
       <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?useradd">/usr/sbin/useradd</a></u>, <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?usermod">/usr/sbin/usermod</a></u>, and <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?userdel">/usr/sbin/userdel</a></u> commands as <b>root</b>.

           sid    ALL = ^<a href="file:/usr/sbin/">/usr/sbin/</a>(group|user)(add|mod|del)$

       One  disadvantage  of  using a regular expression to match the command name is that it is not possible to
       match relative paths such as <u>./useradd</u> or <u>..<a href="file:/sbin/useradd">/sbin/useradd</a></u>.  This has security implications when a regular
       expression is used for the command name in conjunction with the negation operator, ‘!’, as such rules can
       be trivially bypassed.  Because of this, using a negated regular  expression  for  the  command  name  is
       <b>strongly</b>  <b>discouraged</b>.   This  does  not  apply to negated commands that only use a regular expression to
       match the command arguments.  See “Regular expressions in command names” below for more information.

   <b>Including</b> <b>other</b> <b>files</b> <b>from</b> <b>within</b> <b>sudoers</b>
       It is possible to include other <u>sudoers</u> files from within the <u>sudoers</u> file currently being  parsed  using
       the  <u>@include</u>  and <u>@includedir</u> directives.  For compatibility with sudo versions prior to 1.9.1, <u>#include</u>
       and <u>#includedir</u> are also accepted.

       An include file can be used, for example, to keep a site-wide <u>sudoers</u> file in addition to a  local,  per-
       machine  file.  For the sake of this example the site-wide <u>sudoers</u> file will be <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> and the per-
       machine one will be <u>/etc/sudoers.local</u>.  To include <u>/etc/sudoers.local</u> from within <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> one would
       use the following line in <u><a href="file:/etc/sudoers">/etc/sudoers</a></u>:

           @include /etc/sudoers.local

       When <b>sudo</b> reaches this line it will suspend processing of the current file (<u><a href="file:/etc/sudoers">/etc/sudoers</a></u>) and  switch  to
       <u>/etc/sudoers.local</u>.   Upon  reaching  the  end  of  <u>/etc/sudoers.local</u>,  the rest of <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> will be
       processed.  Files that are included may themselves include other files.   A  hard  limit  of  128  nested
       include files is enforced to prevent include file loops.

       Starting with version 1.9.1, the path to the include file may contain white space if it is escaped with a
       backslash  (‘\’).   Alternately,  the entire path may be enclosed in double quotes (""), in which case no
       escaping is necessary.  To include a literal backslash in the path, ‘\\’ should be used.

       If the path to the include file is not fully-qualified (does not begin with a ‘/’), it must be located in
       the same directory as the sudoers file it was included from.  For example, if <u><a href="file:/etc/sudoers">/etc/sudoers</a></u>  contains  the
       line:

           @include sudoers.local

       the file that will be included is <u>/etc/sudoers.local</u>.

       The  file  name  may  also include the ‘%h’ escape, signifying the short form of the host name.  In other
       words, if the machine's host name is “xerxes”, then

           @include /etc/sudoers.%h

       will cause <b>sudo</b> to include the file  <u>/etc/sudoers.xerxes</u>.   Any  path  name  separator  characters  (‘/’)
       present in the host name will be replaced with an underbar (‘_’) during expansion.

       The <u>@includedir</u> directive can be used to create a <u>sudoers.d</u> directory that the system package manager can
       drop <u>sudoers</u> file rules into as part of package installation.  For example, given:

           @includedir <a href="file:/etc/sudoers.d">/etc/sudoers.d</a>

       <b>sudo</b>  will  suspend  processing  of  the current file and read each file in <u><a href="file:/etc/sudoers.d">/etc/sudoers.d</a></u>, skipping file
       names that end in ‘~’ or contain a ‘.’ character to avoid causing problems with package manager or editor
       temporary/backup files.

       Files are parsed in sorted lexical  order.   That  is,  <u>/etc/sudoers.d/01_first</u>  will  be  parsed  before
       <u>/etc/sudoers.d/10_second</u>.    Be   aware   that   because   the   sorting   is   lexical,   not   numeric,
       <u>/etc/sudoers.d/1_whoops</u> would be loaded <u>after</u> <u>/etc/sudoers.d/10_second</u>.  Using  a  consistent  number  of
       leading  zeroes  in  the  file  names can be used to avoid such problems.  After parsing the files in the
       directory, control returns to the file that contained the <u>@includedir</u> directive.

       Unlike files included via <u>@include</u>, <b>visudo</b> will not edit the files in a <u>@includedir</u> directory unless  one
       of  them  contains a syntax error.  It is still possible to run <b>visudo</b> with the <b>-f</b> flag to edit the files
       directly, but this will not catch the redefinition of an <u>alias</u> that is also present in a different file.

   <b>Other</b> <b>special</b> <b>characters</b> <b>and</b> <b>reserved</b> <b>words</b>
       The pound sign (‘#’) is used to indicate a comment (unless it is part of a #include directive  or  unless
       it  occurs  in  the  context  of  a  user name and is followed by one or more digits, in which case it is
       treated as a user-ID).  Both the comment character and any text after it, up to the end of the line,  are
       ignored.

       The reserved word <b>ALL</b> is a built-in <u>alias</u> that always causes a match to succeed.  It can be used wherever
       one  might  otherwise  use a <u>Cmnd_Alias</u>, <u>User_Alias</u>, <u>Runas_Alias</u>, or <u>Host_Alias</u>.  Attempting to define an
       <u>alias</u> named <b>ALL</b> will result in a syntax error.  Using <b>ALL</b> can be dangerous since in a command context, it
       allows the user to run <u>any</u> command on the system.

       The following option names permitted in an <u>Option_Spec</u> are also considered reserved words: CHROOT,  ROLE,
       TYPE,  TIMEOUT,  CWD, NOTBEFORE and NOTAFTER.  Attempting to define an <u>alias</u> with the same name as one of
       the options will result in a syntax error.

       An exclamation point (‘!’) can be used as a logical <u>not</u> operator in a list or <u>alias</u> as well as  in  front
       of  a <u>Cmnd</u>.  This allows one to exclude certain values.  For the ‘!’ operator to be effective, there must
       be something for it to exclude.  For example, to match all users except for <b>root</b> one would use:

           ALL, !root

       If the <b>ALL</b>, is omitted, as in:

           !root

       it would explicitly deny <b>root</b> but not match any other users.  This is different from  a  true  “negation”
       operator.

       Note,  however,  that  using a ‘!’ in conjunction with the built-in <b>ALL</b> alias to allow a user to run “all
       but a few” commands rarely works as intended (see “SECURITY NOTES” below).

       Long lines can be continued with a backslash (‘\’) as the last character on the line.

       White space between elements in a list as well as special syntactic characters in  a  <u>User</u>  <u>Specification</u>
       (‘=’, ‘:’, ‘(’, ‘)’) is optional.

       The following characters must be escaped with a backslash (‘\’) when used as part of a word (e.g., a user
       name or host name): ‘!’, ‘=’, ‘:’, ‘,’, ‘(’, ‘)’, ‘\’.

</pre><h4><b>SUDOERS</b> <b>OPTIONS</b></h4><pre>
       <b>sudo</b>'s  behavior  can  be modified by <u>Default_Entry</u> lines, as explained earlier.  A list of all supported
       Defaults parameters, grouped by type, are listed below.

       <b>Boolean</b> <b>Flags</b>:

       always_query_group_plugin
                         If a <u>group_plugin</u> is configured, use it to resolve groups of the form ‘%group’ as  long
                         as  there  is  not  also a system group of the same name.  Normally, only groups of the
                         form ‘%:group’ are passed to the <u>group_plugin</u>.  This flag is <u>off</u> by default.

       always_set_home   If enabled, <b>sudo</b> will set the HOME environment variable to the home  directory  of  the
                         target  user (which is the <u>runas_default</u> user unless the <b>-u</b> option is used).  This flag
                         is largely obsolete and has no effect unless the <u>env_reset</u> flag has  been  disabled  or
                         HOME  is  present  in  the <u>env_keep</u> list, both of which are strongly discouraged.  This
                         flag is <u>off</u> by default.

       authenticate      If set,  users  must  authenticate  themselves  via  a  password  (or  other  means  of
                         authentication)  before  they may run commands.  This default may be overridden via the
                         PASSWD and NOPASSWD tags.  This flag is <u>on</u> by default.

       case_insensitive_group
                         If enabled, group names in <u>sudoers</u> will be matched in a case insensitive manner.   This
                         may be necessary when users are stored in LDAP or AD.  This flag is <u>on</u> by default.

       case_insensitive_user
                         If  enabled,  user names in <u>sudoers</u> will be matched in a case insensitive manner.  This
                         may be necessary when groups are stored in LDAP or AD.  This flag is <u>on</u> by default.

       closefrom_override
                         If set, the user may use the <b>-C</b> option which overrides the default  starting  point  at
                         which <b>sudo</b> begins closing open file descriptors.  This flag is <u>off</u> by default.

       compress_io       If set, and <b>sudo</b> is configured to log a command's input or output, the I/O logs will be
                         compressed  using  <b>zlib</b>.   This  flag  is <u>on</u> by default when <b>sudo</b> is compiled with <b>zlib</b>
                         support.

       exec_background   By default, <b>sudo</b> runs a command as the foreground process as long  as  <b>sudo</b>  itself  is
                         running in the foreground.  When the <u>exec_background</u> flag is enabled and the command is
                         being  run  in  a pseudo-terminal (due to I/O logging or the <u>use_pty</u> flag), the command
                         will be run as a background process.  Attempts to read from  the  controlling  terminal
                         (or  to  change  terminal settings) will result in the command being suspended with the
                         SIGTTIN signal (or SIGTTOU in the case of terminal settings).   If  this  happens  when
                         <b>sudo</b>  is a foreground process, the command will be granted the controlling terminal and
                         resumed in the foreground  with  no  user  intervention  required.   The  advantage  of
                         initially  running  the  command  in the background is that <b>sudo</b> need not read from the
                         terminal unless the command explicitly requests it.  Otherwise, any terminal input must
                         be passed to the command, whether it  has  required  it  or  not  (the  kernel  buffers
                         terminals  so  it  is not possible to tell whether the command really wants the input).
                         This is different from historic <u>sudo</u> behavior or when the command is not being run in a
                         pseudo-terminal.

                         For this to work seamlessly, the operating system must support the automatic restarting
                         of system calls.  Unfortunately, not all operating systems do this by default, and even
                         those that do may have bugs.  For example, macOS fails to restart the <u><a href="../man3/tcgetattr.3.html">tcgetattr</a></u>(3)  and
                         <u><a href="../man3/tcsetattr.3.html">tcsetattr</a></u>(3)  functions  (this  is a bug in macOS).  Furthermore, because this behavior
                         depends on the command stopping with the SIGTTIN  or  SIGTTOU  signals,  programs  that
                         catch  these  signals  and  suspend themselves with a different signal (usually SIGTOP)
                         will not be automatically foregrounded.  Some  versions  of  the  linux  <u><a href="../man1/su.1.html">su</a></u>(1)  command
                         behave this way.  This flag is <u>off</u> by default.

                         This setting is only supported by version 1.8.7 or higher.  It has no effect unless I/O
                         logging is enabled or the <u>use_pty</u> flag is enabled.

       env_editor        If  set,  <b>visudo</b>  will  use  the value of the SUDO_EDITOR, VISUAL or EDITOR environment
                         variables before falling back on the default editor list.  <b>visudo</b> is typically  run  as
                         <b>root</b>  so this flag may allow a user with <b>visudo</b> privileges to run arbitrary commands as
                         <b>root</b> without logging.  An alternative is to place  a  colon-separated  list  of  “safe”
                         editors  int  the  <u>editor</u>  setting.   <b>visudo</b>  will then only use SUDO_EDITOR, VISUAL or
                         EDITOR if they match a value specified in <u>editor</u>.  If the <u>env_reset</u>  flag  is  enabled,
                         the  SUDO_EDITOR,  VISUAL  and/or  EDITOR  environment variables must be present in the
                         <u>env_keep</u> list for the <u>env_editor</u> flag to function when  <b>visudo</b>  is  invoked  via  <b>sudo</b>.
                         This flag is <u>on</u> by default.

       env_reset         If  set,  <b>sudo</b> will run the command in a minimal environment containing the TERM, PATH,
                         HOME, MAIL, SHELL, LOGNAME, USER and SUDO_* variables.  Any variables in  the  caller's
                         environment  or in the file specified by the <u>restricted_env_file</u> setting that match the
                         <u>env_keep</u> and <u>env_check</u> lists are then added, followed by any variables present  in  the
                         file  specified  by  the  <u>env_file</u>  setting (if any).  The contents of the <u>env_keep</u> and
                         <u>env_check</u> lists, as modified by global Defaults parameters in  <u>sudoers</u>,  are  displayed
                         when  <b>sudo</b>  is  run by <b>root</b> with the <b>-V</b> option.  If the <u>secure_path</u> setting is enabled,
                         its value will be used for the PATH environment variable.  This flag is <u>on</u> by default.

       fast_glob         Normally, <b>sudo</b> uses the <u><a href="../man3/glob.3.html">glob</a></u>(3) function to do shell-style globbing when matching  path
                         names.   However,  since  it  accesses the file system, <u><a href="../man3/glob.3.html">glob</a></u>(3) can take a long time to
                         complete for some patterns, especially when  the  pattern  references  a  network  file
                         system that is mounted on demand (auto mounted).  The <u>fast_glob</u> flag causes <b>sudo</b> to use
                         the <u><a href="../man3/fnmatch.3.html">fnmatch</a></u>(3) function, which does not access the file system to do its matching.  The
                         disadvantage  of <u>fast_glob</u> is that it is unable to match relative paths such as <u>./ls</u> or
                         <u>..<a href="file:/bin/ls">/bin/ls</a></u>.  This has security  implications  when  path  names  that  include  globbing
                         characters  are  used  with  the negation operator, ‘!’, as such rules can be trivially
                         bypassed.  As such, this flag should not be used when the <u>sudoers</u> file  contains  rules
                         that contain negated path names which include globbing characters.  This flag is <u>off</u> by
                         default.

       log_passwords     Most  programs  that  require  a  user's  password will disable echo before reading the
                         password to avoid displaying  the  plaintext  password  on  the  screen.   However,  if
                         terminal  input is being logged (see “I/O LOGGING”), the password will still be present
                         in the I/O log.  If the <u>log_passwords</u> option  is  disabled,  <b>sudoers</b>  will  attempt  to
                         prevent  passwords from being logged.  It does this by using the regular expressions in
                         <u>passprompt_regex</u> to match a password prompt in the  terminal  output  buffer.   When  a
                         match  is found, input characters in the I/O log will be replaced with ‘*’ until either
                         a line feed or carriage return is found in the terminal input or a new terminal  output
                         buffer is received.  If, however, a program displays characters as the user types (such
                         as  <b>sudo</b>  when  <u>pwfeedback</u>  is  set),  only the first character of the password will be
                         replaced in the I/O log.  This option has no effect unless <u>log_input</u> or  <u>log_ttyin</u>  are
                         also set.  This flag is <u>on</u> by default.

                         This setting is only supported by version 1.9.10 or higher.

       fqdn              Set  this  flag  if you want to put fully qualified host names in the <u>sudoers</u> file when
                         the local host name (as returned by the ‘hostname’ command) does not contain the domain
                         name.  In other words, instead of myhost you would use  myhost.mydomain.edu.   You  may
                         still  use  the  short  form  if  you  wish  (and even mix the two).  This flag is only
                         effective when the  “canonical”  host  name,  as  returned  by  the  <u><a href="../man3/getaddrinfo.3.html">getaddrinfo</a></u>(3)  or
                         <u><a href="../man3/gethostbyname.3.html">gethostbyname</a></u>(3)  function, is a fully-qualified domain name.  This is usually the case
                         when the system is configured to use DNS for host name resolution.

                         If the system is configured to use the  <u><a href="file:/etc/hosts">/etc/hosts</a></u>  file  in  preference  to  DNS,  the
                         “canonical”  host  name may not be fully-qualified.  The order that sources are queried
                         for  host  name  resolution   is   usually   specified   in   the   <u><a href="file:/etc/nsswitch.conf">/etc/nsswitch.conf</a></u>,
                         <u>/etc/netsvc.conf</u>,  <u><a href="file:/etc/host.conf">/etc/host.conf</a></u>,  or,  in  some cases, <u><a href="file:/etc/resolv.conf">/etc/resolv.conf</a></u> file.  In the
                         <u><a href="file:/etc/hosts">/etc/hosts</a></u> file, the first host name of the entry is considered to be  the  “canonical”
                         name;  subsequent  names  are  aliases  that are not used by <b>sudoers</b>.  For example, the
                         following hosts file line for the machine “xyzzy” has the fully-qualified  domain  name
                         as the “canonical” host name, and the short version as an alias.

                               <b>192.168.1.1</b> <b>xyzzy.sudo.ws</b> <b>xyzzy</b>

                         If  the machine's hosts file entry is not formatted properly, the <u>fqdn</u> flag will not be
                         effective if it is queried before DNS.

                         Beware that when using DNS for host name resolution, turning on <u>fqdn</u>  requires  <b>sudoers</b>
                         to  make  DNS  lookups which renders <b>sudo</b> unusable if DNS stops working (for example if
                         the machine is disconnected from the network).  Just like with the hosts file, you must
                         use the “canonical” name as DNS knows it.  That is, you may not use a host alias (CNAME
                         entry) due to performance issues and the fact that there is no way to get  all  aliases
                         from DNS.

                         This flag is <u>on</u> by default.

       ignore_audit_errors
                         Allow commands to be run even if <b>sudoers</b> cannot write to the audit log.  If enabled, an
                         audit  log  write  failure is not treated as a fatal error.  If disabled, a command may
                         only be run after the audit event is successfully written.  This flag is only effective
                         on systems for which <b>sudoers</b> supports audit logging, including FreeBSD,  Linux,  macOS,
                         and Solaris.  This flag is <u>on</u> by default.

       ignore_dot        If  set,  <b>sudo</b>  will ignore "." or "" (both denoting the current directory) in the PATH
                         environment variable; the PATH itself is not modified.  This flag is <u>off</u> by default.

       ignore_iolog_errors
                         Allow commands to be run even if <b>sudoers</b> cannot write to the I/O log (local or remote).
                         If enabled, an I/O log write failure is not treated as a fatal error.  If disabled, the
                         command will be terminated if the I/O log cannot be written to.  This flag  is  <u>off</u>  by
                         default.

       ignore_logfile_errors
                         Allow  commands  to be run even if <b>sudoers</b> cannot write to the log file.  If enabled, a
                         log file write failure is not treated as a fatal error.  If  disabled,  a  command  may
                         only  be  run  after the log file entry is successfully written.  This flag only has an
                         effect when <b>sudoers</b> is configured to use file-based logging via  the  <u>logfile</u>  setting.
                         This flag is <u>on</u> by default.

       ignore_local_sudoers
                         If  set  via LDAP, parsing of <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> will be skipped.  This is intended for sites
                         that wish to prevent the usage of local sudoers files so that only LDAP is used.   This
                         thwarts  the efforts of rogue operators who would attempt to add roles to <u><a href="file:/etc/sudoers">/etc/sudoers</a></u>.
                         When this flag is enabled, <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> does not even need to exist.  Since  this  flag
                         tells  <b>sudo</b>  how  to  behave  when  no  specific  LDAP  entries have been matched, this
                         sudoOption is only meaningful for the ‘cn=defaults’  section.   This  flag  is  <u>off</u>  by
                         default.

       ignore_unknown_defaults
                         If  set,  <b>sudo</b> will not produce a warning if it encounters an unknown Defaults entry in
                         the <u>sudoers</u> file or an unknown sudoOption in LDAP.  This flag is <u>off</u> by default.

       insults           If set, <b>sudo</b> will insult users when they enter an incorrect password.  This flag is <u>off</u>
                         by default.

       log_allowed       If set, <b>sudoers</b> will log commands allowed by the policy to the system audit log  (where
                         supported) as well as to syslog and/or a log file.  This flag is <u>on</u> by default.

                         This setting is only supported by version 1.8.29 or higher.

       log_denied        If  set,  <b>sudoers</b> will log commands denied by the policy to the system audit log (where
                         supported) as well as to syslog and/or a log file.  This flag is <u>on</u> by default.

                         This setting is only supported by version 1.8.29 or higher.

       log_exit_status   If set, <b>sudoers</b> will log the exit value of commands that are run to syslog and/or a log
                         file.  If a command was terminated by a signal, the signal  name  is  logged  as  well.
                         This flag is <u>off</u> by default.

                         This setting is only supported by version 1.9.8 or higher.

       log_host          If set, the host name will be included in log entries written to the file configured by
                         the <u>logfile</u> setting.  This flag is <u>off</u> by default.

       log_input         If  set,  <b>sudo</b>  will  run  the  command  in  a  pseudo-terminal (if <b>sudo</b> was run from a
                         terminal) and log all user input.  If the standard input is not connected to the user's
                         terminal, due to I/O redirection or because the command is part  of  a  pipeline,  that
                         input  is  also  logged.  For more information about I/O logging, see the “I/O LOGGING”
                         section.  This flag is <u>off</u> by default.

       log_output        If set, <b>sudo</b> will run the command  in  a  pseudo-terminal  (if  <b>sudo</b>  was  run  from  a
                         terminal)  and  log all output that is sent to the user's terminal, the standard output
                         or the standard error.  If the standard output or standard error is  not  connected  to
                         the  user's  terminal,  due  to  I/O  redirection  or  because the command is part of a
                         pipeline, that output is also logged.  For more information about I/O logging, see  the
                         “I/O LOGGING” section.  This flag is <u>off</u> by default.

       log_server_keepalive
                         If  set,  <b>sudo</b> will enable the TCP keepalive socket option on the connection to the log
                         server.  This enables the periodic transmission of keepalive messages  to  the  server.
                         If  the  server  does  not  respond to a message, the connection will be closed and the
                         running command will be terminated unless the  <u>ignore_iolog_errors</u>  flag  (I/O  logging
                         enabled)  or the <u>ignore_log_errors</u> flag (I/O logging disabled) is set.  This flag is <u>on</u>
                         by default.

                         This setting is only supported by version 1.9.0 or higher.

       log_server_verify
                         If set, the server certificate received during the TLS handshake must be valid  and  it
                         must contain either the server name (from <u>log_servers</u>) or its IP address.  If either of
                         these conditions is not met, the TLS handshake will fail.  This flag is <u>on</u> by default.

                         This setting is only supported by version 1.9.0 or higher.

       log_stderr        If set, <b>sudo</b> will log the standard error if it is not connected to the user's terminal.
                         This  can be used to log output to a pipe or redirected to a file.  This flag is <u>off</u> by
                         default but is enabled when either the <u>log_output</u> flag or the LOG_OUTPUT command tag is
                         set.

       log_stdin         If set, <b>sudo</b> will log the standard input if it is not connected to the user's terminal.
                         This can be used to log input from a pipe or redirected from a file.  This flag is  <u>off</u>
                         by  default  but is enabled when either the <u>log_input</u> flag or the LOG_INPUT command tag
                         is set.

       log_stdout        If set, <b>sudo</b> will log the standard  output  if  it  is  not  connected  to  the  user's
                         terminal.  This can be used to log output to a pipe or redirected to a file.  This flag
                         is  <u>off</u>  by  default  but  is enabled when either the <u>log_output</u> flag or the LOG_OUTPUT
                         command tag is set.

       log_subcmds       If set, <b>sudoers</b> will log when a command spawns a child process and executes  a  program
                         using  the  <u><a href="../man2/execve.2.html">execve</a></u>(2), <u><a href="../man3/execl.3.html">execl</a></u>(3), <u><a href="../man3/execle.3.html">execle</a></u>(3), <u><a href="../man3/execlp.3.html">execlp</a></u>(3), <u><a href="../man3/execv.3.html">execv</a></u>(3), <u><a href="../man3/execvp.3.html">execvp</a></u>(3), <u><a href="../man3/execvpe.3.html">execvpe</a></u>(3),
                         or <u><a href="../man3/system.3.html">system</a></u>(3) library functions.  For example, if a shell is run by <b>sudo</b>, the individual
                         commands run via the shell will be logged.  This flag is <u>off</u> by default.

                         The <u>log_subcmds</u> flag uses the same underlying mechanism as the <u>intercept</u> setting.  Some
                         commands may not work  properly  when  <u>log_subcmds</u>  is  enabled,  due  to  the  way  it
                         intercepts  sub-commands.   See “Preventing shell escapes” for more information on what
                         systems support this option and its limitations.  This setting  is  only  supported  by
                         version 1.9.8 or higher and is incompatible with SELinux RBAC support unless the system
                         supports <u><a href="../man2/seccomp.2.html">seccomp</a></u>(2) filter mode.

       log_ttyin         If  set, <b>sudo</b> will run the command in a pseudo-terminal and log user keystrokes sent to
                         the user's terminal, if one is present.  This flag is <u>off</u> by  default  but  is  enabled
                         when  either the <u>log_input</u> flag or the LOG_INPUT command tag is set.  If no terminal is
                         present, for example when running a remote command using <u><a href="../man1/ssh.1.html">ssh</a></u>(1), this flag will have no
                         effect.

       log_ttyout        If set, <b>sudo</b> will run the command in a pseudo-terminal and log all output displayed  on
                         the  user's  terminal,  if  one is present.  This flag is <u>off</u> by default but is enabled
                         when either the <u>log_output</u> flag or the LOG_OUTPUT command tag is set.  If  no  terminal
                         is present, for example when running a remote command using <u><a href="../man1/ssh.1.html">ssh</a></u>(1), this flag will have
                         no effect.

       log_year          If  set,  the  four-digit  year will be logged in the (non-syslog) <b>sudo</b> log file.  This
                         flag is <u>off</u> by default.

       long_otp_prompt   When validating with a One Time Password (OTP) scheme such as <b>S/Key</b> or <b>OPIE</b>, a two-line
                         prompt is used to make it easier to cut and paste the  challenge  to  a  local  window.
                         It's  not  as pretty as the default but some people find it more convenient.  This flag
                         is <u>off</u> by default.

       mail_all_cmnds    Send mail to the <u>mailto</u> user every time a user attempts to run a command via <b>sudo</b> (this
                         includes <b>sudoedit</b>).  No mail will be sent if the user runs  <b>sudo</b>  with  the  <b>-l</b>  or  <b>-v</b>
                         option  unless  there is an authentication error and the <u>mail_badpass</u> flag is also set.
                         This flag is <u>off</u> by default.

       mail_always       Send mail to the <u>mailto</u> user every time a user runs <b>sudo</b>.  This flag is <u>off</u> by default.

       mail_badpass      Send mail to the <u>mailto</u> user if the user  running  <b>sudo</b>  does  not  enter  the  correct
                         password.  If the command the user is attempting to run is not permitted by <b>sudoers</b> and
                         one  of  the  <u>mail_all_cmnds</u>,  <u>mail_always</u>, <u>mail_no_host</u>, <u>mail_no_perms</u> or <u>mail_no_user</u>
                         flags are set, this flag will have no effect.  This flag is <u>off</u> by default.

       mail_no_host      If set, mail will be sent to the <u>mailto</u> user if the invoking user exists in the <u>sudoers</u>
                         file, but is not allowed to run commands on the current host.   This  flag  is  <u>off</u>  by
                         default.

       mail_no_perms     If  set,  mail  will  be sent to the <u>mailto</u> user if the invoking user is allowed to use
                         <b>sudo</b> but the command they are trying is not listed in their <u>sudoers</u> file  entry  or  is
                         explicitly denied.  This flag is <u>off</u> by default.

       mail_no_user      If set, mail will be sent to the <u>mailto</u> user if the invoking user is not in the <u>sudoers</u>
                         file.  This flag is <u>on</u> by default.

       match_group_by_gid
                         By  default,  <b>sudoers</b>  will  look  up each group the user is a member of by group-ID to
                         determine the group name (this is only done once).  The resulting list  of  the  user's
                         group  names  is used when matching groups listed in the <u>sudoers</u> file.  This works well
                         on systems where the number of groups listed in the <u>sudoers</u> file  is  larger  than  the
                         number  of  groups a typical user belongs to.  On systems where group lookups are slow,
                         where users may belong to a large number of groups,  or  where  the  number  of  groups
                         listed  in  the <u>sudoers</u> file is relatively small, it may be prohibitively expensive and
                         running commands via <b>sudo</b> may take longer than normal.   On  such  systems  it  may  be
                         faster  to  use  the <u>match_group_by_gid</u> flag to avoid resolving the user's group-IDs to
                         group names.  In this case, <b>sudoers</b> must look up any group name listed in  the  <u>sudoers</u>
                         file  and  use the group-ID instead of the group name when determining whether the user
                         is a member of the group.

                         If <u>match_group_by_gid</u> is enabled, group database lookups performed by <b>sudoers</b>  will  be
                         keyed  by  group  name  as  opposed  to  group-ID.  On systems where there are multiple
                         sources for the group database, it is possible  to  have  conflicting  group  names  or
                         group-IDs in the local <u><a href="file:/etc/group">/etc/group</a></u> file and the remote group database.  On such systems,
                         enabling  or  disabling <u>match_group_by_gid</u> can be used to choose whether group database
                         queries are performed by name (enabled) or ID (disabled),  which  may  aid  in  working
                         around group entry conflicts.

                         The  <u>match_group_by_gid</u>  flag  has no effect when <u>sudoers</u> data is stored in LDAP.  This
                         flag is <u>off</u> by default.

                         This setting is only supported by version 1.8.18 or higher.

       intercept         If set, all commands run via <b>sudo</b> will behave as if the INTERCEPT  tag  has  been  set,
                         unless  overridden  by  an  NOINTERCEPT  tag.  Some commands may not work properly when
                         <u>intercept</u> is enabled, due to the way it intercept sub-commands.  See the description of
                         INTERCEPT and NOINTERCEPT above as well as the “Preventing shell  escapes”  section  at
                         the end of this manual.  This flag is <u>off</u> by default.

                         This  setting  is  only  supported  by version 1.9.8 or higher and is incompatible with
                         SELinux RBAC support unless the system supports <u><a href="../man2/seccomp.2.html">seccomp</a></u>(2) filter mode.

       intercept_allow_setid
                         On most systems, the dynamic loader will ignore LD_PRELOAD  (or  the  equivalent)  when
                         running  set-user-ID  and  set-group-ID programs, effectively disabling intercept mode.
                         To prevent this from happening, <b>sudoers</b> will not permit a set-user-ID  or  set-group-ID
                         program  to be run in intercept mode unless <u>intercept_allow_setid</u> is enable.  This flag
                         has no effect unless the <u>intercept</u> flag is enabled or the INTERCEPT tag  has  been  set
                         for  the  command.  This flag is <u>on</u> by default when the <u>intercept_type</u> option is set to
                         <u>trace</u>, otherwise it default to <u>off</u>.

                         This setting is only supported by version 1.9.8 or higher.

       intercept_authenticate
                         If set, commands run by an intercepted process must be authenticated  when  the  user's
                         time  stamp  is not current.  For example, if a shell is run with <u>intercept</u> enabled, as
                         soon as the invoking user's time stamp is out of date, subsequent commands will need to
                         be authenticated.  This flag has no effect unless the <u>intercept</u> flag is enabled or  the
                         INTERCEPT tag has been set for the command.  This flag is <u>off</u> by default.

                         This setting is only supported by version 1.9.8 or higher.

       intercept_verify  If  set,  <b>sudo</b>  will  attempt  to  verify  that a command run in intercept mode has the
                         expected path name, command line arguments and environment.

                         The process will be stopped after <u><a href="../man2/execve.2.html">execve</a></u>(2) has completed but before  the  new  command
                         has had a chance to run.  To verify the command, <b>sudo</b> will read the command's path from
                         <u>/proc/PID/exe</u>,  the  command  line arguments and environment from the process's memory,
                         and compare them against the arguments that were passed to <u><a href="../man2/execve.2.html">execve</a></u>(2).  In the event  of
                         a mismatch, the command will be sent a SIGKILL signal and terminated.

                         This  can  help  prevent  a  time of check versus time of use issue with intercept mode
                         where the <u><a href="../man2/execve.2.html">execve</a></u>(2) arguments could be altered after the  <b>sudoers</b>  policy  check.   The
                         checks can only be performed if the <u><a href="../man5/proc.5.html">proc</a></u>(5) file system is available.  This flag has no
                         effect  unless  the <u>intercept</u> flag is enabled or the INTERCEPT tag has been set for the
                         command and the <u>intercept_type</u> option is set to <u>trace</u>.

                         This setting is incompatible  with  programs  that  change  their  root  directory  via
                         <u><a href="../man2/chroot.2.html">chroot</a></u>(2).   If  a  program changes its root directory, path names will no longer match
                         those seen by the <b>sudo</b> parent process and sub-commands will be terminated  before  they
                         have a chance to run.  This flag is <u>on</u> by default.

                         This setting is only supported by version 1.9.12 or higher.

       netgroup_tuple    If  set,  netgroup  lookups will be performed using the full netgroup tuple: host name,
                         user name, and domain (if one is set).  Historically, <b>sudo</b> only matched the  user  name
                         and  domain for netgroups used in a <u>User_List</u> and only matched the host name and domain
                         for netgroups used in a <u>Host_List</u>.  This flag is <u>off</u> by default.

       noexec            If set, all commands run via <b>sudo</b> will behave as if the NOEXEC tag has been set, unless
                         overridden by an EXEC tag.  See the description of EXEC and NOEXEC above as well as the
                         “Preventing shell escapes” section at the end of this manual.   This  flag  is  <u>off</u>  by
                         default.

       noninteractive_auth
                         If  set,  authentication will be attempted even in non-interactive mode (when <b>sudo</b>'s <b>-n</b>
                         option is specified).  This allows  authentication  methods  that  don't  require  user
                         interaction  to  succeed.   Authentication  methods  that require input from the user's
                         terminal will still fail.  If disabled, authentication will not be  attempted  in  non-
                         interactive mode.  This flag is <u>off</u> by default.

                         This setting is only supported by version 1.9.10 or higher.

       pam_acct_mgmt     On  systems  that  use PAM for authentication, <b>sudo</b> will perform PAM account validation
                         for the invoking user by default.  The actual checks  performed  depend  on  which  PAM
                         modules are configured.  If enabled, account validation will be performed regardless of
                         whether or not a password is required.  This flag is <u>on</u> by default.

                         This setting is only supported by version 1.8.28 or higher.

       pam_rhost         On  systems that use PAM for authentication, <b>sudo</b> will set the PAM remote host value to
                         the name of the local host when the <u>pam_rhost</u>  flag  is  enabled.   On  Linux  systems,
                         enabling  <u>pam_rhost</u>  may  result  in  DNS  lookups  of  the local host name when PAM is
                         initialized.  On Solaris versions prior to Solaris 8,  <u>pam_rhost</u>  must  be  enabled  if
                         <u>pam_ruser</u> is also enabled to avoid a crash in the Solaris PAM implementation.

                         This flag is <u>off</u> by default on systems other than Solaris.

                         This setting is only supported by version 1.9.0 or higher.

       pam_ruser         On  systems that use PAM for authentication, <b>sudo</b> will set the PAM remote user value to
                         the name of the user that invoked sudo when the <u>pam_ruser</u> flag is enabled.   This  flag
                         is <u>on</u> by default.

                         This setting is only supported by version 1.9.0 or higher.

       pam_session       On  systems that use PAM for authentication, <b>sudo</b> will create a new PAM session for the
                         command to be run in.  Unless <b>sudo</b> is given the <b>-i</b> or <b>-s</b> options, PAM  session  modules
                         are  run  with  the  “silent”  flag enabled.  This prevents last login information from
                         being displayed for every command on some systems.  Disabling <u>pam_session</u> may be needed
                         on older PAM implementations or on  operating  systems  where  opening  a  PAM  session
                         changes  the  utmp  or wtmp files.  If PAM session support is disabled, resource limits
                         may not be updated for the command being run.  If <u>pam_session</u>, <u>pam_setcred</u>, and <u>use_pty</u>
                         are disabled, <u>log_servers</u> has not been set and I/O logging  has  not  been  configured,
                         <b>sudo</b>  will execute the command directly instead of running it as a child process.  This
                         flag is <u>on</u> by default.

                         This setting is only supported by version 1.8.7 or higher.

       pam_setcred       On systems that use PAM for authentication, <b>sudo</b> will attempt to establish  credentials
                         for  the  target user by default, if supported by the underlying authentication system.
                         One example of a credential is a Kerberos ticket.   If  <u>pam_session</u>,  <u>pam_setcred</u>,  and
                         <u>use_pty</u>  are  disabled,  <u>log_servers</u>  has  not  been  set  and I/O logging has not been
                         configured, <b>sudo</b> will execute the command directly instead of running  it  as  a  child
                         process.  This flag is <u>on</u> by default.

                         This setting is only supported by version 1.8.8 or higher.

       pam_silent        If  set,  PAM  authentication  will  be  performed  in  silent mode.  This prevents PAM
                         authentication modules from generating  output.   In  some  cases,  this  may  suppress
                         important  information  about why authentication failed.  For example, PAM modules such
                         as <u>pam_faillock</u> will only display a warning if <u>pam_silent</u> is disabled.  This flag is <u>on</u>
                         by default.

                         This setting is only supported by version 1.9.16 or higher.

       passprompt_override
                         If set, the prompt specified by <u>passprompt</u> or the SUDO_PROMPT environment variable will
                         always be used and  will  replace  the  prompt  provided  by  a  PAM  module  or  other
                         authentication method.  This flag is <u>off</u> by default.

       path_info         Normally,  <b>sudo</b>  will  tell  the  user  when a command could not be found in their PATH
                         environment variable.  Some sites may wish to disable this  as  it  could  be  used  to
                         gather  information  on  the location of executables that the normal user does not have
                         access to.  The disadvantage is that if the executable is  simply  not  in  the  user's
                         PATH,  <b>sudo</b>  will  tell  the  user  that  they  are not allowed to run it, which can be
                         confusing.  This flag is <u>on</u> by default.

       preserve_groups   By default, <b>sudo</b> will initialize the group vector to the list of groups the target user
                         is in.  When  <u>preserve_groups</u>  is  set,  the  user's  existing  group  vector  is  left
                         unaltered.   The  real  and  effective  group-IDs,  however, are still set to match the
                         target user.  This flag is <u>off</u> by default.

       pwfeedback        By default, <b>sudo</b> reads the password like most other Unix programs, by turning off  echo
                         until  the  user hits the return (or enter) key.  Some users become confused by this as
                         it appears to them that <b>sudo</b> has hung at this point.  When <u>pwfeedback</u> is set, <b>sudo</b> will
                         provide visual feedback when the user presses a key.  This does have a security  impact
                         as an onlooker may be able to determine the length of the password being entered.  This
                         flag is <u>off</u> by default.

       requiretty        If set, <b>sudo</b> will only run when the user is logged in to a real tty.  When this flag is
                         set,  <b>sudo</b> can only be run from a login session and not via other means such as <u><a href="../man8/cron.8.html">cron</a></u>(8)
                         or cgi-bin scripts.  This flag is <u>off</u> by default.

       root_sudo         If set, <b>root</b> is allowed to run <b>sudo</b> too.  Disabling this prevents users from “chaining”
                         <b>sudo</b> commands to get a <b>root</b> shell by doing something like ‘sudo sudo  <a href="file:/bin/sh">/bin/sh</a>’.   Note,
                         however,  that  turning  off  <u>root_sudo</u>  will  also prevent <b>root</b> from running <b>sudoedit</b>.
                         Disabling <u>root_sudo</u>  provides  no  real  additional  security;  it  exists  purely  for
                         historical reasons.  This flag is <u>on</u> by default.

       rootpw            If  set, <b>sudo</b> will prompt for the <b>root</b> password instead of the password of the invoking
                         user when running a command or editing a file.  This flag is <u>off</u> by default.

       runas_allow_unknown_id
                         If enabled, allow matching of runas user and group IDs that  are  not  present  in  the
                         password  or group databases.  In addition to explicitly matching unknown user or group
                         IDs in a <u>Runas_List</u>, this option also allows the <b>ALL</b> alias to match unknown IDs.   This
                         flag is <u>off</u> by default.

                         This  setting  is  only  supported by version 1.8.30 or higher.  Older versions of <b>sudo</b>
                         always allowed matching of unknown user and group IDs.

       runas_check_shell
                         If enabled, <b>sudo</b> will  only  run  commands  as  a  user  whose  shell  appears  in  the
                         <u><a href="file:/etc/shells">/etc/shells</a></u> file, even if the invoking user's <u>Runas_List</u> would otherwise permit it.  If
                         no  <u><a href="file:/etc/shells">/etc/shells</a></u>  file is present, a system-dependent list of built-in default shells is
                         used.  On many operating systems, system users such as “bin”, do not have a valid shell
                         and this flag can be used to prevent commands from being run as those users.  This flag
                         is <u>off</u> by default.

                         This setting is only supported by version 1.8.30 or higher.

       runaspw           If set, <b>sudo</b> will prompt for the password of the  user  defined  by  the  <u>runas_default</u>
                         option  (defaults  to <b>root</b>) instead of the password of the invoking user when running a
                         command or editing a file.  This flag is <u>off</u> by default.

       selinux           If enabled, the user may specify an SELinux role and/or type to use  when  running  the
                         command,  as  permitted  by  the SELinux policy.  If SELinux is disabled on the system,
                         this flag has no effect.  This flag is <u>on</u> by default.

       set_home          If enabled and <b>sudo</b> is invoked with the <b>-s</b> option, the HOME environment  variable  will
                         be set to the home directory of the target user (which is the <u>runas_default</u> user unless
                         the  <b>-u</b>  option  is  used).  This flag is largely obsolete and has no effect unless the
                         <u>env_reset</u> flag has been disabled or HOME is present in the <u>env_keep</u> list, both of which
                         are strongly discouraged.  This flag is <u>off</u> by default.

       set_logname       Normally, <b>sudo</b> will set the LOGNAME and USER environment variables to the name  of  the
                         target  user  (the  user  specified  by  <u>runas_default</u>  unless the <b>-u</b> option is given).
                         However, since some programs (including the RCS revision control system) use LOGNAME to
                         determine the real identity of the user, it may be desirable to change  this  behavior.
                         This  can be done by negating the set_logname option.  The <u>set_logname</u> option will have
                         no effect if the <u>env_reset</u> option has not been disabled and the <u>env_keep</u> list  contains
                         LOGNAME or USER.  This flag is <u>on</u> by default.

       set_utmp          When  enabled,  <b>sudo</b>  will  create  an entry in the utmp (or utmpx) file when a pseudo-
                         terminal is allocated.  A pseudo-terminal is allocated by <b>sudo</b> when it is running in  a
                         terminal  and  one  or  more  of  the  <u>log_input</u>,  <u>log_output</u>,  <u>log_stdin</u>,  <u>log_stdout</u>,
                         <u>log_stderr</u>, <u>log_ttyin</u>, <u>log_ttyout</u>, or <u>use_pty</u> flags is enabled.  By  default,  the  new
                         entry  will  be  a copy of the user's existing utmp entry (if any), with the tty, time,
                         type, and pid fields updated.  This flag is <u>on</u> by default.

       setenv            Allow the user to disable the <u>env_reset</u> option from the command line via the <b>-E</b> option.
                         Additionally, environment variables set via the command line are  not  subject  to  the
                         restrictions  imposed  by  <u>env_check</u>,  <u>env_delete</u>,  or <u>env_keep</u>.  As such, only trusted
                         users should be allowed to set variables in this manner.  This flag is <u>off</u> by default.

       shell_noargs      If set and <b>sudo</b> is invoked with no arguments it acts as  if  the  <b>-s</b>  option  had  been
                         given.   That  is,  it  runs  a  shell  as  <b>root</b>  (the shell is determined by the SHELL
                         environment variable if it is set, falling back on the shell  listed  in  the  invoking
                         user's <a href="file:/etc/passwd">/etc/passwd</a> entry if not).  This flag is <u>off</u> by default.

       stay_setuid       Normally,  when  <b>sudo</b> executes a command the real and effective user-IDs are set to the
                         target user (<b>root</b> by default).  This option changes that behavior such  that  the  real
                         user-ID is left as the invoking user's user-ID.  In other words, this makes <b>sudo</b> act as
                         a  set-user-ID  wrapper.   This  can be useful on systems that disable some potentially
                         dangerous functionality when a  program  is  run  set-user-ID.   This  option  is  only
                         effective  on  systems that support either the <u><a href="../man2/setreuid.2.html">setreuid</a></u>(2) or <u><a href="../man2/setresuid.2.html">setresuid</a></u>(2) system call.
                         This flag is <u>off</u> by default.

       sudoedit_checkdir
                         If set, <b>sudoedit</b> will check all directory components of  the  path  to  be  edited  for
                         writability  by  the  invoking  user.   Symbolic links will not be followed in writable
                         directories and <b>sudoedit</b> will refuse to edit a file located in  a  writable  directory.
                         These  restrictions are not enforced when <b>sudoedit</b> is run by <b>root</b>.  On some systems, if
                         all directory components of the path to be edited are not readable by the target  user,
                         <b>sudoedit</b> will be unable to edit the file.  This flag is <u>on</u> by default.

                         This  setting was first introduced in version 1.8.15 but initially suffered from a race
                         condition.  The check for symbolic links in writable intermediate directories was added
                         in version 1.8.16.

       sudoedit_follow   By  default,  <b>sudoedit</b>  will  not  follow  symbolic  links  when  opening  files.   The
                         <u>sudoedit_follow</u> option can be enabled to allow <b>sudoedit</b> to open symbolic links.  It may
                         be overridden on a per-command basis by the FOLLOW and NOFOLLOW tags.  This flag is <u>off</u>
                         by default.

                         This setting is only supported by version 1.8.15 or higher.

       syslog_pid        When  logging via <u><a href="../man3/syslog.3.html">syslog</a></u>(3), include the process ID in the log entry.  This flag is <u>off</u>
                         by default.

                         This setting is only supported by version 1.8.21 or higher.

       targetpw          If set, <b>sudo</b> will prompt for the password of  the  user  specified  by  the  <b>-u</b>  option
                         (defaults  to  the value of <u>runas_default</u>) instead of the password of the invoking user
                         when running a command or editing a file.  This flag precludes the use of a user-ID not
                         listed in the passwd database as an argument to the <b>-u</b> option.  This  flag  is  <u>off</u>  by
                         default.

       tty_tickets       If  set, users must authenticate on a per-tty basis.  With this flag enabled, <b>sudo</b> will
                         use a separate record in the time stamp file for each terminal.  If disabled, a  single
                         record is used for all login sessions.

                         This option has been superseded by the <u>timestamp_type</u> option.

       umask_override    If  set, <b>sudo</b> will set the umask as specified in the <u>sudoers</u> file without modification.
                         This makes it possible to specify a umask in the <u>sudoers</u> file that is  more  permissive
                         than  the  user's  own umask and matches historical behavior.  If <u>umask_override</u> is not
                         set, <b>sudo</b> will set the umask to be the union of the user's umask and what is  specified
                         in <u>sudoers</u>.  This flag is <u>off</u> by default.

       use_netgroups     If  set,  netgroups  (prefixed  with ‘+’), may be used in place of a user or host.  For
                         LDAP-based sudoers, netgroup support requires an  expensive  sub-string  match  on  the
                         server  unless  the <b>NETGROUP_BASE</b> directive is present in the <u>/etc/sudo-ldap.conf</u> file.
                         If netgroups are not needed, this option can be disabled to reduce the load on the LDAP
                         server.  This flag is <u>on</u> by default.

       use_pty           If set, and <b>sudo</b> is running in a terminal, the command will be run  in  a  new  pseudo-
                         terminal.  If the <b>sudo</b> process is not attached to a terminal, <u>use_pty</u> has no effect.

                         A malicious program run under <b>sudo</b> may be capable of injecting commands into the user's
                         terminal  or  running  a  background process that retains access to the user's terminal
                         device even after the main program has finished executing.  By running the command in a
                         separate pseudo-terminal, this attack is no longer possible.

                         A side effect of running the command in a new pseudo-terminal is  that  input  will  be
                         passed  to  the  command  even if it is non-interactive.  This means that, for example,
                         keys pressed while a non-interactive command  is  running  will  be  consumed  by  <b>sudo</b>
                         instead of being passed to the shell after the command exits.

                         This flag is <u>on</u> by default for <b>sudo</b> 1.9.14 and above.

       user_command_timeouts
                         If  set,  the  user  may specify a timeout on the command line.  If the timeout expires
                         before the command has exited, the  command  will  be  terminated.   If  a  timeout  is
                         specified  both  in  the  <u>sudoers</u>  file and on the command line, the smaller of the two
                         timeouts will be used.  See the <u>Timeout_Spec</u> section for a description of  the  timeout
                         syntax.  This flag is <u>off</u> by default.

                         This setting is only supported by version 1.8.20 or higher.

       utmp_runas        If  set,  <b>sudo</b>  will store the name of the runas user when updating the utmp (or utmpx)
                         file.  By default, <b>sudo</b> stores the name of the invoking user.   This  flag  is  <u>off</u>  by
                         default.

       visiblepw         By  default,  <b>sudo</b>  will  refuse to run if the user must enter a password but it is not
                         possible to disable echo on the terminal.  If the <u>visiblepw</u>  flag  is  set,  <b>sudo</b>  will
                         prompt  for  a  password  even  when  it would be visible on the screen.  This makes it
                         possible to run things like ‘ssh somehost sudo ls’ since by default,  <u><a href="../man1/ssh.1.html">ssh</a></u>(1)  does  not
                         allocate a tty when running a command.  This flag is <u>off</u> by default.

       <b>Integers</b>:

       closefrom         Before  it  executes  a  command,  <b>sudo</b> will close all open file descriptors other than
                         standard input, standard output,  and  standard  error  (file  descriptors  0-2).   The
                         <u>closefrom</u>  option  can be used to specify a different file descriptor at which to start
                         closing.  The default is 3.

       command_timeout   The maximum amount of time a command is allowed to run before it  is  terminated.   See
                         the <u>Timeout_Spec</u> section for a description of the timeout syntax.

                         This setting is only supported by version 1.8.20 or higher.

       log_server_timeout
                         The  maximum  amount  of  time to wait when connecting to a log server or waiting for a
                         server response.  See the <u>Timeout_Spec</u> section for a description of the timeout syntax.
                         The default value is 30 seconds.

                         This setting is only supported by version 1.9.0 or higher.

       maxseq            The maximum sequence number that will be substituted for the ‘%{seq}’ escape in the I/O
                         log file (see the <u>iolog_dir</u> description below for more information).  While  the  value
                         substituted  for  ‘%{seq}’ is in base 36, <u>maxseq</u> itself should be expressed in decimal.
                         Values larger than 2176782336  (which  corresponds  to  the  base  36  sequence  number
                         “ZZZZZZ”) will be silently truncated to 2176782336.  The default value is 2176782336.

                         Once  the  local  sequence  number  reaches the value of <u>maxseq</u>, it will “roll over” to
                         zero, after which <b>sudoers</b> will truncate and reuse any existing I/O log path names.

                         This setting is only supported by version 1.8.7 or higher.

       passwd_tries      The number of tries a user gets to enter his/her password before <b>sudo</b> logs the  failure
                         and exits.  The default is 3.

       syslog_maxlen     On  many  systems,  <u><a href="../man3/syslog.3.html">syslog</a></u>(3)  has a relatively small log buffer.  IETF RFC 5424 states
                         that syslog servers must support messages of at least  480  bytes  and  should  support
                         messages  up  to  2048 bytes.  By default, <b>sudoers</b> creates log messages up to 980 bytes
                         which corresponds to the historic BSD syslog implementation  which  used  a  1024  byte
                         buffer  to  store  the  message,  date,  hostname, and program name.  To prevent syslog
                         messages from being truncated, <b>sudoers</b> will split up log messages that are larger  than
                         <u>syslog_maxlen</u> bytes.  When a message is split, additional parts will include the string
                         “(command  continued)”  after  the  user  name  and  before  the continued command line
                         arguments.

                         This setting is only supported by version 1.8.19 or higher.

       <b>Integers</b> <b>that</b> <b>can</b> <b>be</b> <b>used</b> <b>in</b> <b>a</b> <b>boolean</b> <b>context</b>:

       loglinelen        Number of characters per line for the file log.  This value is used to decide  when  to
                         wrap  lines  for  nicer log files.  This has no effect on the syslog log file, only the
                         file log.  The default is 80 (use 0 or negate the option to disable word wrap).

       passwd_timeout    Number of minutes before the <b>sudo</b> password prompt times out, or 0 for no timeout.   The
                         timeout  may  include a fractional component if minute granularity is insufficient, for
                         example 2.5.  The default is 0.

       timestamp_timeout
                         Number of minutes that can elapse before <b>sudo</b> will  ask  for  a  password  again.   The
                         timeout  may  include a fractional component if minute granularity is insufficient, for
                         example 2.5.  The default is 15.  Set this to 0 to always prompt for  a  password.   If
                         set  to  a  value less than 0 the user's time stamp will not expire until the system is
                         rebooted.  This can be used to allow users to create or delete their  own  time  stamps
                         via ‘sudo -v’ and ‘sudo -k’ respectively.

       umask             File  mode creation mask to use when running the command.  Negate this option or set it
                         to 0777 to prevent <b>sudoers</b> from changing the umask.  Unless the <u>umask_override</u> flag  is
                         set,  the actual umask will be the union of the user's umask and the value of the <u>umask</u>
                         setting, which defaults to 0022.  This guarantees that <b>sudo</b> never lowers the umask when
                         running a command.

                         If <u>umask</u> is explicitly set in <u>sudoers</u>, it will override any umask  setting  in  PAM  or
                         login.conf.   If  <u>umask</u> is not set in <u>sudoers</u>, the umask specified by PAM or login.conf
                         will take precedence.  The umask setting in PAM is not used for  <b>sudoedit</b>,  which  does
                         not create a new PAM session.

       <b>Strings</b>:

       apparmor_profile  The  default  AppArmor  profile  to  transition  into  when executing the command.  The
                         default <u>apparmor_profile</u> can be overridden for individual <u>sudoers</u> entries by specifying
                         the APPARMOR_PROFILE option.  This option is only available when  sudo  is  built  with
                         AppArmor support.

       cmddenial_message
                         It  set,  <b>sudo</b>  will  display  this  message  when  a  user is denied access to run the
                         specified command, but is listed in the <u>sudoers</u> file for the host.  This can be used to
                         provide additional, site-specific information to the user when a command is  denied  by
                         the  security policy.  It does not override the standard warning the user receives when
                         a command is denied.

       authfail_message  Message that is displayed after a user fails to authenticate.  The message may  include
                         the  ‘%d’  escape which will expand to the number of failed password attempts.  If set,
                         it overrides the default message, “%d incorrect password attempt(s)”.

       badpass_message   Message that is displayed if a user enters  an  incorrect  password.   The  default  is
                         “Sorry, try again.” unless insults are enabled.

       editor            A  colon  (‘:’)  separated  list of editor path names used by <b>sudoedit</b> and <b>visudo</b>.  For
                         <b>sudoedit</b>, this list is used to find an editor when none of the SUDO_EDITOR,  VISUAL  or
                         EDITOR  environment  variables are set to an editor that exists and is executable.  For
                         <b>visudo</b>, it is used as a white list of allowed editors; <b>visudo</b> will  choose  the  editor
                         that matches the user's SUDO_EDITOR, VISUAL or EDITOR environment variable if possible,
                         or  the  first editor in the list that exists and is executable if not.  Unless invoked
                         as <b>sudoedit</b>, <b>sudo</b> does not preserve  the  SUDO_EDITOR,  VISUAL  or  EDITOR  environment
                         variables  unless  they  are  present  in  the <u>env_keep</u> list or the <u>env_reset</u> option is
                         disabled.  The default is <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?editor">/usr/bin/editor</a></u>.

       intercept_type    The underlying mechanism used by the <u>intercept</u> and <u>log_subcmds</u>  options.   It  has  the
                         following possible values:

                         dso     Preload a dynamic shared object (shared library) that intercepts the <u><a href="../man2/execve.2.html">execve</a></u>(2),
                                 <u><a href="../man3/execl.3.html">execl</a></u>(3),  <u><a href="../man3/execle.3.html">execle</a></u>(3), <u><a href="../man3/execlp.3.html">execlp</a></u>(3), <u><a href="../man3/execv.3.html">execv</a></u>(3), <u><a href="../man3/execvp.3.html">execvp</a></u>(3), <u><a href="../man3/execvpe.3.html">execvpe</a></u>(3), and <u><a href="../man3/system.3.html">system</a></u>(3)
                                 library functions.  A value of <u>dso</u> is incompatible  with  <b>sudo</b>'s  SELinux  RBAC
                                 support.

                         trace   Use  <u><a href="../man2/ptrace.2.html">ptrace</a></u>(2)  to intercept the <u><a href="../man2/execve.2.html">execve</a></u>(2) system call.  This is only supported
                                 on  Linux  systems   where   <u><a href="../man2/seccomp.2.html">seccomp</a></u>(2)   filtering   is   enabled.    If   the
                                 <u><a href="file:/proc/sys/kernel/seccomp/actions_avail">/proc/sys/kernel/seccomp/actions_avail</a></u>  file  is  missing or does not contain a
                                 “trap” element, setting <u>intercept_type</u> to <u>trace</u> will have  no  effect  and  <u>dso</u>
                                 will be used instead.

                         The default is to use <u>trace</u> if it is supported by the system and <u>dso</u> if it is not.

       iolog_dir         The top-level directory to use when constructing the path name for the input/output log
                         directory.   Only  used  if the <u>log_input</u> or <u>log_output</u> options are enabled or when the
                         LOG_INPUT or LOG_OUTPUT tags are present for a command.  The session  sequence  number,
                         if any, is stored in the directory.  The default is <u>/var/log/sudo-io</u>.

                         The following percent (‘%’) escape sequences are supported:

                         %{seq}
                               expanded  to  a monotonically increasing base-36 sequence number, such as 0100A5,
                               where every two digits are used to form a new directory, e.g., <u>01/00/A5</u>

                         %{user}
                               expanded to the invoking user's login name

                         %{group}
                               expanded to the name of the invoking user's real group-ID

                         %{runas_user}
                               expanded to the login name of the user the command will be run as (e.g., <b>root</b>)

                         %{runas_group}
                               expanded to the group name of the user the command will be run as (e.g., <b>wheel</b>)

                         %{hostname}
                               expanded to the local host name without the domain name

                         %{command}
                               expanded to the base name of the command being run

                         In addition, any escape sequences supported by the system's <u><a href="../man3/strftime.3.html">strftime</a></u>(3)  function  will
                         be expanded.

                         To include a literal ‘%’ character, the string ‘%%’ should be used.

                         Any  path  name separator characters (‘/’) present in the user, group or host name will
                         be replaced with an underbar (‘_’) during expansion.

       iolog_file        The path name, relative to <u>iolog_dir</u>, in which to  store  input/output  logs  when  the
                         <u>log_input</u>  or  <u>log_output</u>  options are enabled or when the LOG_INPUT or LOG_OUTPUT tags
                         are present for a command.  <u>iolog_file</u> may contain directory components.   The  default
                         is ‘%{seq}’.

                         See the <u>iolog_dir</u> option above for a list of supported percent (‘%’) escape sequences.

                         In  addition  to  the escape sequences, path names that end in six or more <u>X</u>s will have
                         the <u>X</u>s replaced with a unique  combination  of  digits  and  letters,  similar  to  the
                         <u><a href="../man3/mktemp.3.html">mktemp</a></u>(3) function.

                         If  the  path  created  by  concatenating  <u>iolog_dir</u> and <u>iolog_file</u> already exists, the
                         existing I/O log file will be truncated and overwritten unless <u>iolog_file</u> ends  in  six
                         or more <u>X</u>s.

       iolog_flush       If  set, <b>sudo</b> will flush I/O log data to disk after each write instead of buffering it.
                         This makes it possible to view the logs in real-time as the program  is  executing  but
                         may significantly reduce the effectiveness of I/O log compression.  This flag is <u>off</u> by
                         default.

                         This setting is only supported by version 1.8.20 or higher.

       iolog_group       The  group  name  to  look  up  when  setting  the  group-ID  on  new I/O log files and
                         directories.  If <u>iolog_group</u> is not set, the primary group-ID of the user specified  by
                         <u>iolog_user</u>  is  used.  If neither <u>iolog_group</u> nor <u>iolog_user</u> are set, I/O log files and
                         directories are created with group-ID 0.

                         This setting is only supported by version 1.8.19 or higher.

       iolog_mode        The file mode to use when creating I/O  log  files.   Mode  bits  for  read  and  write
                         permissions  for  owner,  group, or other are honored, everything else is ignored.  The
                         file permissions will always include the owner read and write bits, even  if  they  are
                         not present in the specified mode.  When creating I/O log directories, search (execute)
                         bits  are  added to match the read and write bits specified by <u>iolog_mode</u>.  Defaults to
                         0600 (read and write by user only).

                         This setting is only supported by version 1.8.19 or higher.

       iolog_user        The user name to look up when setting the user and group-IDs on new I/O log  files  and
                         directories.   If  <u>iolog_group</u>  is  set,  it will be used instead of the user's primary
                         group-ID.  By default, I/O log files and directories are created with user and group-ID
                         0.

                         This setting can be useful when the I/O logs are stored on a Network File System  (NFS)
                         share.  Having a dedicated user own the I/O log files means that <b>sudoers</b> does not write
                         to the log files as user-ID 0, which is usually not permitted by NFS.

                         This setting is only supported by version 1.8.19 or higher.

       lecture_status_dir
                         The  directory  in  which  <b>sudo</b>  stores per-user lecture status files.  Once a user has
                         received the lecture, a zero-length file is created in this directory so that <b>sudo</b> will
                         not lecture the user again.  This directory should  <u>not</u>  be  cleared  when  the  system
                         reboots.  The default is <u><a href="file:/var/lib/sudo/lectured">/var/lib/sudo/lectured</a></u>.

       log_server_cabundle
                         The  path  to a certificate authority bundle file, in PEM format, to use instead of the
                         system's default certificate authority database when  authenticating  the  log  server.
                         The  default  is  to  use  the  system's  default certificate authority database.  This
                         setting has no effect unless <u>log_servers</u> is set and the remote log  server  is  secured
                         with TLS.

                         This setting is only supported by version 1.9.0 or higher.

       log_server_peer_cert
                         The  path  to  the  <b>sudo</b>  client's  certificate  file,  in PEM format.  This setting is
                         required when the remote  log  server  is  secured  with  TLS  and  client  certificate
                         validation  is  enabled.  For <b>sudo_logsrvd</b>, client certificate validation is controlled
                         by the <u>tls_checkpeer</u> option, which defaults to <u>false</u>.

                         This setting is only supported by version 1.9.0 or higher.

       log_server_peer_key
                         The path to the <b>sudo</b> client's private  key  file,  in  PEM  format.   This  setting  is
                         required  when  the  remote  log  server  is  secured  with  TLS and client certificate
                         validation is enabled.  For <b>sudo_logsrvd</b>, client certificate validation  is  controlled
                         by the <u>tls_checkpeer</u> flag, which defaults to <u>false</u>.

                         This setting is only supported by version 1.9.0 or higher.

       mailsub           Subject  of  the mail sent to the <u>mailto</u> user.  The escape ‘%h’ will expand to the host
                         name of the machine.  Default is “*** SECURITY information for %h ***”.

       noexec_file       As of <b>sudo</b> version 1.8.1 this option is no longer supported.  The path  to  the  noexec
                         file should now be set in the <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) file.

       pam_askpass_service
                         On  systems  that use PAM for authentication, this is the service name used when the <b>-A</b>
                         option is specified.  The default value is either  ‘sudo’  or  ‘sudo-i’,  depending  on
                         whether or not the <b>-i</b> option is also specified.  See the description of <u>pam_service</u> for
                         more information.

                         This setting is only supported by version 1.9.9 or higher.

       pam_login_service
                         On  systems  that use PAM for authentication, this is the service name used when the <b>-i</b>
                         option  is  specified.   The  default  value  is  ‘sudo-i’.   See  the  description  of
                         <u>pam_service</u> for more information.

                         This setting is only supported by version 1.8.8 or higher.

       pam_service       On  systems  that use PAM for authentication, the service name specifies the PAM policy
                         to apply.  This usually corresponds to an entry in the <u>pam.conf</u> file or a file  in  the
                         <u><a href="file:/etc/pam.d">/etc/pam.d</a></u> directory.  The default value is ‘sudo’.

                         This setting is only supported by version 1.8.8 or higher.

       passprompt        The  default  prompt  to  use  when asking for a password; can be overridden via the <b>-p</b>
                         option or the SUDO_PROMPT environment variable.  The  following  percent  (‘%’)  escape
                         sequences are supported:

                         %H    expanded  to the local host name including the domain name (only if the machine's
                               host name is fully qualified or the <u>fqdn</u> option is set)

                         %h    expanded to the local host name without the domain name

                         %p    expanded to the user whose password is being  asked  for  (respects  the  <u>rootpw</u>,
                               <u>targetpw</u> and <u>runaspw</u> flags in <u>sudoers</u>)

                         %U    expanded  to  the  login name of the user the command will be run as (defaults to
                               <b>root</b>)

                         %u    expanded to the invoking user's login name

                         %%    two consecutive ‘%’ characters are collapsed into a single ‘%’ character

                         On systems that use PAM for authentication, <u>passprompt</u> will only be used if the  prompt
                         provided  by the PAM module matches the string “Password: ” or “username's Password: ”.
                         This ensures that the <u>passprompt</u> setting does  not  interfere  with  challenge-response
                         style  authentication.   The  <u>passprompt_override</u>  flag  can  be  used  to  change this
                         behavior.

                         The default value is ‘[sudo] password for %p: ’.

       role              The default SELinux role to use when constructing a new security  context  to  run  the
                         command.  The default role may be overridden on a per-command basis in the <u>sudoers</u> file
                         or  via  command  line  options.  This option is only available when <b>sudo</b> is built with
                         SELinux support.

       runas_default     The default user to run commands as if the <b>-u</b> option is not specified  on  the  command
                         line.  This defaults to <b>root</b>.

       sudoers_locale    Locale  to  use  when  parsing  the  sudoers file, logging commands, and sending email.
                         Changing the locale may affect how sudoers is interpreted.  Defaults to ‘C’.

       timestamp_type    <b>sudoers</b> uses per-user time stamp files  for  credential  caching.   The  <u>timestamp_type</u>
                         option can be used to specify the type of time stamp record used.  It has the following
                         possible values:

                         global  A  single  time  stamp  record  is  used  for  all  of a user's login sessions,
                                 regardless of the terminal or parent process ID.  An additional record is  used
                                 to  serialize  password prompts when <b>sudo</b> is used multiple times in a pipeline,
                                 but this does not affect authentication.

                         ppid    A single time stamp record is used for  all  processes  with  the  same  parent
                                 process  ID  (usually  the  shell).  Commands run from the same shell (or other
                                 common parent process)  will  not  require  a  password  for  <u>timestamp_timeout</u>
                                 minutes (15 by default).  Commands run via <b>sudo</b> with a different parent process
                                 ID, for example from a shell script, will be authenticated separately.

                         tty     One  time  stamp  record  is  used for each terminal, which means that a user's
                                 login sessions are authenticated separately.  If no terminal  is  present,  the
                                 behavior  is  the  same  as <u>ppid</u>.  Commands run from the same terminal will not
                                 require a password for <u>timestamp_timeout</u> minutes (15 by default).

                         kernel  The time stamp is stored in the kernel as an attribute of the terminal  device.
                                 If  no  terminal  is  present,  the  behavior  is  the  same as <u>ppid</u>.  Negative
                                 <u>timestamp_timeout</u> values are not supported and positive values are limited to a
                                 maximum of 60 minutes.  This is currently only supported on OpenBSD.

                         The default value is <u>tty</u>.

                         This setting is only supported by version 1.8.21 or higher.

       timestampdir      The directory in which <b>sudo</b> stores its time stamp  files.   This  directory  should  be
                         cleared when the system reboots.  The default is <u>/run/sudo/ts</u>.

       timestampowner    The  owner  of  the lecture status directory, time stamp directory and all files stored
                         therein.  The default is <b>root</b>.

       type              The default SELinux type to use when constructing a new security  context  to  run  the
                         command.  The default type may be overridden on a per-command basis in the <u>sudoers</u> file
                         or  via  command  line  options.  This option is only available when <b>sudo</b> is built with
                         SELinux support.

       <b>Strings</b> <b>that</b> <b>can</b> <b>be</b> <b>used</b> <b>in</b> <b>a</b> <b>boolean</b> <b>context</b>:

       admin_flag    The <u>admin_flag</u> option specifies the path to a file that is created the first  time  a  user
                     that  is  a  member  of  the  <u>sudo</u>  or  <u>admin</u>  groups runs <b>sudo</b>.  Only available if <b>sudo</b> is
                     configured   with   the    <b>--enable-admin-flag</b>    option.     The    default    value    is
                     <u><a href="file:~/.sudo_as_admin_successful">~/.sudo_as_admin_successful</a></u>.

       env_file      The <u>env_file</u> option specifies the fully qualified path to a file containing variables to be
                     set  in the environment of the program being run.  Entries in this file should either be of
                     the form ‘VARIABLE=value’ or ‘export VARIABLE=value’.  The value may optionally be enclosed
                     in single or double quotes.  Variables in this file are only added if the variable does not
                     already exist in the environment.  This file is considered  to  be  part  of  the  security
                     policy,  its  contents  are  not  subject  to  other  <b>sudo</b> environment restrictions such as
                     <u>env_keep</u> and <u>env_check</u>.

       exempt_group  Users in this group are exempt  from  password  and  PATH  requirements.   The  group  name
                     specified should not include a ‘%’ prefix.  This is not set by default.

       fdexec        Determines  whether  <b>sudo</b> will execute a command by its path or by an open file descriptor.
                     It has the following possible values:

                     always  Always execute by file descriptor.

                     never   Never execute by file descriptor.

                     digest_only
                             Only execute by file descriptor if the command has  an  associated  digest  in  the
                             <u>sudoers</u> file.

                     The  default  value  is  <u>digest_only</u>.   This avoids a time of check versus time of use race
                     condition when the command is located in a directory writable by the invoking user.

                     <u>fdexec</u> will change the first element of the argument vector for scripts ($0 in  the  shell)
                     due  to  the  way  the kernel runs script interpreters.  Instead of being a normal path, it
                     will refer to a file descriptor.  For example, <u>/dev/fd/4</u> on Solaris and <u>/proc/self/fd/4</u>  on
                     Linux.  A workaround is to use the SUDO_COMMAND environment variable instead.

                     The <u>fdexec</u> setting is only used when the command is matched by path name.  It has no effect
                     if the command is matched by the built-in <b>ALL</b> alias.

                     This  setting  is only supported by version 1.8.20 or higher.  If the operating system does
                     not support the <u><a href="../man2/fexecve.2.html">fexecve</a></u>(2) system call, this setting has no effect.

       group_plugin  A string containing a <b>sudoers</b> group plugin with  optional  arguments.   The  string  should
                     consist  of  the  plugin  path, either fully-qualified or relative to the <u><a href="file:/usr/libexec/sudo">/usr/libexec/sudo</a></u>
                     directory, followed by any configuration arguments the plugin  requires.   These  arguments
                     (if any) will be passed to the plugin's initialization function.  If arguments are present,
                     the string must be enclosed in double quotes ("").

                     On  64-bit  systems, if the plugin is present but cannot be loaded, <b>sudoers</b> will look for a
                     64-bit version and, if it exists, load that as a fallback.  The exact rules for  this  vary
                     by  system.   On  Solaris,  if the plugin is stored in a directory ending in “lib”, <b>sudoers</b>
                     will   create   a   fallback   path   by   appending   “/64”   to   the   directory   name;
                     <u>/usr/lib/group_plugin.so</u> becomes <u>/usr/lib/64/group_plugin.so</u>.  On Linux, a directory ending
                     in  “lib”  will  be  transformed  to “lib64” as the fallback path; <u>/usr/lib/group_plugin.so</u>
                     becomes <u>/usr/lib64/group_plugin.so</u>.  On all other systems, the fallback path  is  generated
                     by adding a “64” before the file extension; <u>group_plugin.so</u> becomes <u>group_plugin64.so</u>.

                     On AIX systems, the plugin may be either a shared object ending in ‘.so’ or an archive file
                     containing a shared object ending in ‘.a’ with the name of the shared object in parentheses
                     at the end.

                     For more information see “GROUP PROVIDER PLUGINS”.

       lecture       This  option  controls when a short lecture will be printed along with the password prompt.
                     It has the following possible values:

                     always  Always lecture the user.

                     never   Never lecture the user.

                     once    Only lecture the user the first time they run <b>sudo</b>.

                     If no value is specified, a value of <u>once</u> is implied.  Negating the  option  results  in  a
                     value of <u>never</u> being used.  The default value is <u>never</u>.

       lecture_file  Path  to  a  file  containing  an  alternate <b>sudo</b> lecture that will be used in place of the
                     standard lecture if the named file exists.  By default, <b>sudo</b> uses a built-in lecture.

       listpw        This option controls when a password will be required when a user runs  <b>sudo</b>  with  the  <b>-l</b>
                     option.  It has the following possible values:

                     all   All  the user's <u>sudoers</u> file entries for the current host must have the NOPASSWD flag
                           set to avoid entering a password.

                     always
                           The user must always enter a password to use the <b>-l</b> option.

                     any   At least one of the user's <u>sudoers</u> file entries for the current host  must  have  the
                           NOPASSWD flag set to avoid entering a password.

                     never
                           The user need never enter a password to use the <b>-l</b> option.

                     If  no  value  is  specified,  a value of <u>any</u> is implied.  Negating the option results in a
                     value of <u>never</u> being used.  The default value is <u>any</u>.

       log_format    The event log format.  Supported log formats are:

                     json  Currently, this is an alias for <u>json_pretty</u>.  In a future version of <b>sudo</b>, <u>json</u>  will
                           be  equivalent  to  <u>json_compact</u>.   JSON log entries contain the full user details as
                           well as the execution environment if the command was allowed.

                     json_compact
                           Log events in “compact” (minified) JSON format.  Each event is written as a  separate
                           JSON object on single line without extraneous white space.  Due to limitations of the
                           protocol, JSON events sent via <u>syslog</u> may be truncated.

                     json_pretty
                           Log  events  in  “pretty”  JSON  format.   When logging to a file, the entire file is
                           treated as a single JSON object consisting of multiple events,  each  event  spanning
                           multiple  lines.   When  logging  via  <u>syslog</u>,  there  is  no  difference between the
                           <u>json_pretty</u> and <u>json_compact</u> formats.

                     sudo  Log events in traditional sudo-style format, see “EVENT LOGGING” for details.

                     This setting affects logs sent via <u><a href="../man3/syslog.3.html">syslog</a></u>(3) as well as the file specified by  the  <u>logfile</u>
                     setting, if any.  The default value is <u>sudo</u>.

       logfile       Path  to the <b>sudo</b> log file (not the syslog log file).  Setting a path turns on logging to a
                     file; negating this option turns it off.  By default, <b>sudo</b> logs via syslog.

       mailerflags   Flags to use when invoking mailer.  Defaults to <b>-t</b>.

       mailerpath    Path to mail program used to send warning mail (negate to prevent <b>sudo</b> from sending  mail).
                     Defaults to the path to sendmail found at configure time.

       mailfrom      Address  to  use  for  the “from” address when sending warning and error mail.  The address
                     should be enclosed in double quotes ("") to protect against <b>sudo</b> interpreting the ‘@’ sign.
                     Defaults to the name of the user running <b>sudo</b>.

       mailto        Address to send warning and error mail to (negate to prevent <b>sudo</b> from sending mail).   The
                     address  should  be enclosed in double quotes ("") to protect against <b>sudo</b> interpreting the
                     ‘@’ sign.  Defaults to root.

       rlimit_as     The maximum size to which the process's address space may grow (in bytes), if supported  by
                     the operating system.  See “Resource limits” for more information.

       rlimit_core   The  largest size core dump file that may be created (in bytes).  See “Resource limits” for
                     more information.  Defaults to 0 (no core dump created).

       rlimit_cpu    The maximum amount of CPU time that the  process  may  use  (in  seconds).   See  “Resource
                     limits” for more information.

       rlimit_data   The maximum size of the data segment for the process (in bytes).  See “Resource limits” for
                     more information.

       rlimit_fsize  The  largest  size  file that the process may create (in bytes).  See “Resource limits” for
                     more information.

       rlimit_locks  The maximum number of locks that the process may establish, if supported by  the  operating
                     system.  See “Resource limits” for more information.

       rlimit_memlock
                     The  maximum  size  that  the  process  may  lock in memory (in bytes), if supported by the
                     operating system.  See “Resource limits” for more information.

       rlimit_nofile
                     The maximum number of files that the process may have open.  See “Resource limits” for more
                     information.

       rlimit_nproc  The maximum number of processes that  the  user  may  run  simultaneously.   See  “Resource
                     limits” for more information.

       rlimit_rss    The  maximum  size  to  which  the  process's  resident  set size may grow (in bytes).  See
                     “Resource limits” for more information.

       rlimit_stack  The maximum size to which the process's stack may grow (in bytes).  See  “Resource  limits”
                     for more information.

       restricted_env_file
                     The  <u>restricted_env_file</u>  option  specifies  the  fully qualified path to a file containing
                     variables to be set in the environment of the program being  run.   Entries  in  this  file
                     should be assignments in the form ‘VARIABLE=value’ or ‘export VARIABLE=value’, separated by
                     newline  characters.   The  value  may  optionally  be enclosed in single or double quotes.
                     Shell-style variable substitution is not supported.  Empty lines and comments starting with
                     a pound sign (‘#’) are ignored.  Variables in this file are only added if the variable does
                     not already exist in the environment.  Unlike <u>env_file</u>, the file's contents are not trusted
                     and are processed in a manner similar to that  of  the  invoking  user's  environment.   If
                     <u>env_reset</u>  is  enabled,  variables  in  the  file will only be added if they are matched by
                     either the <u>env_check</u> or <u>env_keep</u> list.  If <u>env_reset</u> is disabled, variables in the file are
                     added as long as they are not matched by the <u>env_delete</u> list.  In either case, the contents
                     of <u>restricted_env_file</u> are processed before the contents of <u>env_file</u>.

       runchroot     If set, <b>sudo</b> will use this value for the  root  directory  when  running  a  command.   The
                     special  value  “*” will allow the user to specify the root directory via <b>sudo</b>'s <b>-R</b> option.
                     See the “Chroot_Spec” section for more details.

                     It is only possible to use <u>runchroot</u> as a command-specific Defaults setting if the  command
                     exists  with  the same path both inside and outside the chroot jail.  This restriction does
                     not apply to global, host, or user-based Defaults settings or to a <u>Cmnd_Spec</u> that  includes
                     a <u>Chroot_Spec</u>.

                     This setting is only supported by version 1.9.3 or higher.

       runcwd        If  set,  <b>sudo</b>  will  use this value for the working directory when running a command.  The
                     special value “*” will allow the user to  specify  the  working  directory  via  <b>sudo</b>'s  <b>-D</b>
                     option.  See the “Chdir_Spec” section for more details.

                     This setting is only supported by version 1.9.3 or higher.

       secure_path   If  set,  <b>sudo</b> will use this value in place of the user's PATH environment variable.  There
                     are two basic use cases for <u>secure_path</u>:

                     1. To make  it  possible  for  <b>sudo</b>  to  find  system  administrator  commands  located  in
                        directories that may not be in the default user path, such as <u><a href="file:/usr/sbin">/usr/sbin</a></u>.

                     2.  To  help protect scripts and programs that execute other commands without first setting
                        PATH to a safe value.  Otherwise, a user with limited privileges  may  be  able  to  run
                        arbitrary  commands  by  manipulating  the  PATH if the command being run executes other
                        commands without using a fully-qualified path name.

                     Users in the group specified by the <u>exempt_group</u> option are not  affected  by  <u>secure_path</u>.
                     This option is disabled by default.

       syslog        Syslog  facility  if  syslog  is being used for logging (negate to disable syslog logging).
                     Defaults to authpriv.

                     The following syslog facilities are supported: <b>authpriv</b> (if your  OS  supports  it),  <b>auth</b>,
                     <b>daemon</b>, <b>user</b>, <b>local0</b>, <b>local1</b>, <b>local2</b>, <b>local3</b>, <b>local4</b>, <b>local5</b>, <b>local6</b>, and <b>local7</b>.

       syslog_badpri
                     Syslog priority to use when the user is not allowed to run a command or when authentication
                     is unsuccessful.  Defaults to alert.

                     The  following  syslog  priorities  are  supported:  <b>alert</b>,  <b>crit</b>, <b>debug</b>, <b>emerg</b>, <b>err</b>, <b>info</b>,
                     <b>notice</b>, <b>warning</b>, and <b>none</b>.  Negating the option or setting it  to  a  value  of  <b>none</b>  will
                     disable logging of unsuccessful commands.

       syslog_goodpri
                     Syslog  priority  to  use  when  the user is allowed to run a command and authentication is
                     successful.  Defaults to notice.

                     See <u>syslog_badpri</u> for the list of supported syslog  priorities.   Negating  the  option  or
                     setting it to a value of <b>none</b> will disable logging of successful commands.

       verifypw      This  option  controls  when  a password will be required when a user runs <b>sudo</b> with the <b>-v</b>
                     option.  It has the following possible values:

                     all     All the user's <u>sudoers</u> file entries for the current host  must  have  the  NOPASSWD
                             flag set to avoid entering a password.

                     always  The user must always enter a password to use the <b>-v</b> option.

                     any     At  least one of the user's <u>sudoers</u> file entries for the current host must have the
                             NOPASSWD flag set to avoid entering a password.

                     never   The user need never enter a password to use the <b>-v</b> option.

                     If no value is specified, a value of <u>all</u> is implied.  Negating  the  option  results  in  a
                     value of <u>never</u> being used.  The default value is <u>all</u>.

       <b>Lists</b> <b>that</b> <b>can</b> <b>be</b> <b>used</b> <b>in</b> <b>a</b> <b>boolean</b> <b>context</b>:

       env_check         Environment  variables  to  be  removed  from  the  user's  environment unless they are
                         considered “safe”.  For all variables except TZ, “safe” means that the variable's value
                         does not contain any ‘%’ or ‘/’ characters.  This can be used to guard against  printf-
                         style format vulnerabilities in poorly-written programs.  The TZ variable is considered
                         unsafe if any of the following are true:

                         <b>•</b>  It  consists of a fully-qualified path name, optionally prefixed with a colon (‘:’),
                            that does not match the location of the <u>zoneinfo</u> directory.

                         <b>•</b>  It contains a <u>..</u> path element.

                         <b>•</b>  It contains white space or non-printable characters.

                         <b>•</b>  It is longer than the value of PATH_MAX.

                         The argument may be a double-quoted, space-separated list or  a  single  value  without
                         double-quotes.   The list can be replaced, added to, deleted from, or disabled by using
                         the ‘=’, ‘+=’, ‘-=’,  and  ‘!’  operators  respectively.   Regardless  of  whether  the
                         <u>env_reset</u>  option  is  enabled  or  disabled,  variables specified by <u>env_check</u> will be
                         preserved in the environment if they pass the aforementioned check.  The global list of
                         environment variables to check is displayed when <b>sudo</b>  is  run  by  <b>root</b>  with  the  <b>-V</b>
                         option.

       env_delete        Environment  variables  to  be  removed  from the user's environment when the <u>env_reset</u>
                         option is not in effect.  The argument may be a double-quoted, space-separated list  or
                         a  single  value  without  double-quotes.   The list can be replaced, added to, deleted
                         from, or disabled by using the ‘=’, ‘+=’, ‘-=’, and ‘!’  operators  respectively.   The
                         global  list  of  environment variables to remove is displayed when <b>sudo</b> is run by <b>root</b>
                         with the <b>-V</b> option.  Many operating systems will remove potentially dangerous variables
                         from the environment of any set-user-ID process (such as <b>sudo</b>).

       env_keep          Environment variables to be preserved in the  user's  environment  when  the  <u>env_reset</u>
                         option   is   in  effect.   This  allows  fine-grained  control  over  the  environment
                         <b>sudo</b>-spawned processes will receive.  The  argument  may  be  a  double-quoted,  space-
                         separated  list  or  a  single  value without double-quotes.  The list can be replaced,
                         added to, deleted from, or disabled by using the ‘=’, ‘+=’,  ‘-=’,  and  ‘!’  operators
                         respectively.   The  global  list of variables to keep is displayed when <b>sudo</b> is run by
                         <b>root</b> with the <b>-V</b> option.

                         Preserving the HOME environment variable has security implications since many  programs
                         use  it  when  searching  for configuration or data files.  Adding HOME to <u>env_keep</u> may
                         enable a user to run unrestricted commands via <b>sudo</b> and is strongly discouraged.  Users
                         wishing to edit files with  <b>sudo</b>  should  run  <b>sudoedit</b>  (or  <b>sudo</b>  <b>-e</b>)  to  get  their
                         accustomed editor configuration instead of invoking the editor directly.

       log_servers       A list of one or more servers to use for remote event and I/O log storage, separated by
                         white  space.   Log  servers  must  be  running  <b>sudo_logsrvd</b>  or  another service that
                         implements the protocol described by <u><a href="../man5/sudo_logsrv.proto.5.html">sudo_logsrv.proto</a></u>(5).

                         Server addresses should be of the form “host[:port][(tls)]”.  The host portion may be a
                         host name, an IPv4 address, or an IPv6 address in square brackets.

                         If the optional <u>tls</u> flag is present, the connection  will  be  secured  with  Transport
                         Layer  Security  (TLS)  version  1.2  or  1.3.   Versions  of  TLS prior to 1.2 are not
                         supported.

                         If a port is specified, it may either be a port number or a well-known service name  as
                         defined  by the system service name database.  If no port is specified, port 30343 will
                         be used for plaintext connections and port 30344 will be used for TLS connections.

                         When <u>log_servers</u> is set, event log data will be logged both locally (see the <u>syslog</u> and
                         <u>log_file</u> settings) as well as remotely, but I/O log data will only be logged  remotely.
                         If  multiple  hosts  are specified, they will be attempted in reverse order.  If no log
                         servers are available, the user will not be able to run a  command  unless  either  the
                         <u>ignore_iolog_errors</u>  flag  (I/O  logging  enabled)  or  the <u>ignore_log_errors</u> flag (I/O
                         logging disabled) is set.  Likewise, if the connection to the log server is interrupted
                         while <b>sudo</b> is running, the command will be terminated  unless  the  <u>ignore_iolog_errors</u>
                         flag (I/O logging enabled) or the <u>ignore_log_errors</u> flag (I/O logging disabled) is set.

                         This setting is only supported by version 1.9.0 or higher.

       passprompt_regex  A  list  of  POSIX  extended  regular expressions used to match password prompts in the
                         terminal output.  As an extension, if the regular expression  begins  with  “(?i)”,  it
                         will  be  matched  in a case-insensitive manner.  Each regular expression is limited to
                         1024 characters.  This option is only used when <u>log_passwords</u> has been  disabled.   The
                         default value is “[Pp]assword[: ]*”

                         This setting is only supported by version 1.9.10 or higher.

</pre><h4><b>GROUP</b> <b>PROVIDER</b> <b>PLUGINS</b></h4><pre>
       The  <b>sudoers</b>  plugin  supports its own plugin interface to allow non-Unix group lookups which can query a
       group source other than the standard Unix group database.  This can be used to implement support for  the
       <u>nonunix_group</u> syntax described earlier.

       Group  provider  plugins are specified via the <u>group_plugin</u> setting.  The argument to <u>group_plugin</u> should
       consist of the plugin path, either  fully-qualified  or  relative  to  the  <u><a href="file:/usr/libexec/sudo">/usr/libexec/sudo</a></u>  directory,
       followed  by  any configuration options the plugin requires.  These options (if specified) will be passed
       to the plugin's initialization function.  If options are present, the string must be enclosed  in  double
       quotes ("").

       The following group provider plugins are installed by default:

       group_file
             The  <u>group_file</u> plugin supports an alternate group file that uses the same syntax as the <u><a href="file:/etc/group">/etc/group</a></u>
             file.  The path to the group file should be specified as an option to the plugin.  For example,  if
             the group file to be used is <u>/etc/sudo-group</u>:

             Defaults group_plugin="group_file.so /etc/sudo-group"

       system_group
             The <u>system_group</u> plugin supports group lookups via the standard C library functions <u><a href="../man3/getgrnam.3.html">getgrnam</a></u>(3) and
             <u><a href="../man3/getgrid.3.html">getgrid</a></u>(3).   This  plugin can be used in instances where the user belongs to groups not present in
             the user's supplemental group vector.  This plugin takes no options:

             Defaults group_plugin=system_group.so

       The group provider plugin API is described in detail in <u><a href="../man5/sudo_plugin.5.html">sudo_plugin</a></u>(5).

</pre><h4><b>EVENT</b> <b>LOGGING</b></h4><pre>
       <b>sudoers</b> can log events in either JSON or <u>sudo</u>  format,  this  section  describes  the  <u>sudo</u>  log  format.
       Depending  on  <u>sudoers</u> configuration, <b>sudoers</b> can log events via <u><a href="../man3/syslog.3.html">syslog</a></u>(3), to a local log file, or both.
       The log format is almost identical in both cases.  Any control characters present in  the  log  data  are
       formatted  in  octal with a leading ‘#’ character.  For example, a horizontal tab is stored as ‘#011’ and
       an embedded carriage return is stored as ‘#015’.  In addition, space characters in the command  path  are
       stored  as  ‘#040’.  Command line arguments that contain spaces are enclosed in single quotes ('').  This
       makes it possible to distinguish multiple command line arguments from a  single  argument  that  contains
       spaces.   Literal single quotes and backslash characters (‘\’) in command line arguments are escaped with
       a backslash.

   <b>Accepted</b> <b>command</b> <b>log</b> <b>entries</b>
       Commands that  sudo  runs  are  logged  using  the  following  format  (split  into  multiple  lines  for
       readability):

           date hostname progname: username : TTY=ttyname ; CHROOT=chroot ; \
               PWD=cwd ; USER=runasuser ; GROUP=runasgroup ; TSID=logid ; \
               ENV=env_vars COMMAND=command

       Where the fields are as follows:

       date          The  date  the  command was run.  Typically, this is in the format “MMM, DD, HH:MM:SS”.  If
                     logging via <u><a href="../man3/syslog.3.html">syslog</a></u>(3), the actual date format is  controlled  by  the  syslog  daemon.   If
                     logging to a file and the <u>log_year</u> option is enabled, the date will also include the year.

       hostname      The  name  of  the  host  <b>sudo</b>  was  run  on.   This field is only present when logging via
                     <u><a href="../man3/syslog.3.html">syslog</a></u>(3).

       progname      The name of the program, usually <u>sudo</u> or <u>sudoedit</u>.  This field is only present when logging
                     via <u><a href="../man3/syslog.3.html">syslog</a></u>(3).

       username      The login name of the user who ran <b>sudo</b>.

       ttyname       The short name of the terminal (e.g., “console”, “tty01”, or “pts/0”) <b>sudo</b> was run  on,  or
                     “unknown” if there was no terminal present.

       chroot        The root directory that the command was run in, if one was specified.

       cwd           The current working directory that <b>sudo</b> was run in.

       runasuser     The user the command was run as.

       runasgroup    The group the command was run as if one was specified on the command line.

       logid         An  I/O  log  identifier  that  can  be  used to replay the command's output.  This is only
                     present when the <u>log_input</u> or <u>log_output</u> option is enabled.

       env_vars      A list of environment variables specified on the command line, if specified.

       command       The actual command that was executed, including any command line arguments.

       Messages are logged using the locale specified by <u>sudoers_locale</u>, which defaults to the ‘C’ locale.

   <b>Denied</b> <b>command</b> <b>log</b> <b>entries</b>
       If the user is not allowed to run the command, the reason for the  denial  will  follow  the  user  name.
       Possible reasons include:

       user NOT in sudoers
         The user is not listed in the <u>sudoers</u> file.

       user NOT authorized on host
         The user is listed in the <u>sudoers</u> file but is not allowed to run commands on the host.

       command not allowed
         The  user  is  listed  in  the  <u>sudoers</u> file for the host but they are not allowed to run the specified
         command.

       3 incorrect password attempts
         The user failed to enter their password after 3 tries.  The actual number of tries will vary  based  on
         the number of failed attempts and the value of the <u>passwd_tries</u> option.

       a password is required
         The <b>-n</b> option was specified but a password was required.

       sorry, you are not allowed to set the following environment variables
         The user specified environment variables on the command line that were not allowed by <u>sudoers</u>.

   <b>Error</b> <b>log</b> <b>entries</b>
       If  an  error  occurs, <b>sudoers</b> will log a message and, in most cases, send a message to the administrator
       via email.  Possible errors include:

       parse error in <a href="file:/etc/sudoers">/etc/sudoers</a> near line N
         <b>sudoers</b> encountered an error when parsing the specified file.  In some cases, the actual error  may  be
         one line above or below the line number listed, depending on the type of error.

       problem with defaults entries
         The  <u>sudoers</u>  file  contains  one  or  more unknown Defaults settings.  This does not prevent <b>sudo</b> from
         running, but the <u>sudoers</u> file should be checked using <b>visudo</b>.

       timestamp owner (username): No such user
         The time stamp directory owner, as specified by the <u>timestampowner</u> setting, could not be found  in  the
         password database.

       unable to open/read <a href="file:/etc/sudoers">/etc/sudoers</a>
         The  <u>sudoers</u> file could not be opened for reading.  This can happen when the <u>sudoers</u> file is located on
         a remote file system that maps user-ID 0 to a different value.  Normally, <b>sudoers</b>  tries  to  open  the
         <u>sudoers</u>  file using group permissions to avoid this problem.  Consider either changing the ownership of
         <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> or adding an argument like “sudoers_uid=N” (where ‘N’ is the user-ID that owns the <u>sudoers</u>
         file) to the end of the <b>sudoers</b> <u>Plugin</u> line in the <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) file.

       unable to open <a href="file:/etc/sudoers">/etc/sudoers</a>
         The <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> file is missing.

       <a href="file:/etc/sudoers">/etc/sudoers</a> is not a regular file
         The <u><a href="file:/etc/sudoers">/etc/sudoers</a></u> file exists but is not a regular file or symbolic link.

       <a href="file:/etc/sudoers">/etc/sudoers</a> is owned by uid N, should be 0
         The <u>sudoers</u>  file  has  the  wrong  owner.   If  you  wish  to  change  the  <u>sudoers</u>  file  owner,  add
         “sudoers_uid=N” (where ‘N’ is the user-ID that owns the <u>sudoers</u> file) to the <b>sudoers</b> <u>Plugin</u> line in the
         <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) file.

       <a href="file:/etc/sudoers">/etc/sudoers</a> is world writable
         The  permissions  on  the  <u>sudoers</u>  file  allow all users to write to it.  The <u>sudoers</u> file must not be
         world-writable, the default file mode is 0440 (readable by owner and group,  writable  by  none).   The
         default  mode  may  be  changed  via  the  “sudoers_mode”  option  to  the  <b>sudoers</b>  <u>Plugin</u> line in the
         <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) file.

       <a href="file:/etc/sudoers">/etc/sudoers</a> is owned by gid N, should be 1
         The <u>sudoers</u> file has the wrong group  ownership.   If  you  wish  to  change  the  <u>sudoers</u>  file  group
         ownership,  add  “sudoers_gid=N”  (where ‘N’ is the group-ID that owns the <u>sudoers</u> file) to the <b>sudoers</b>
         <u>Plugin</u> line in the <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) file.

       unable to open /run/sudo/ts/user-ID
         <b>sudoers</b> was unable to read or create the user's time stamp file.  This can happen  when  <u>timestampowner</u>
         is  set  to  a user other than <b>root</b> and the mode on <u><a href="file:/run/sudo">/run/sudo</a></u> is not searchable by group or other.  The
         default mode for <u><a href="file:/run/sudo">/run/sudo</a></u> is 0711.

       unable to write to /run/sudo/ts/user-ID
         <b>sudoers</b> was unable to write to the user's time stamp file.

       /run/sudo/ts is owned by uid X, should be Y
         The time stamp directory is owned by a user other than <u>timestampowner</u>.  This can occur when  the  value
         of  <u>timestampowner</u>  has  been changed.  <b>sudoers</b> will ignore the time stamp directory until the owner is
         corrected.

       /run/sudo/ts is group writable
         The time stamp directory is group-writable; it should be writable only by <u>timestampowner</u>.  The  default
         mode for the time stamp directory is 0700.  <b>sudoers</b> will ignore the time stamp directory until the mode
         is corrected.

   <b>Notes</b> <b>on</b> <b>logging</b> <b>via</b> <b>syslog</b>
       By  default,  <b>sudoers</b>  logs messages via <u><a href="../man3/syslog.3.html">syslog</a></u>(3).  The <u>date</u>, <u>hostname</u>, and <u>progname</u> fields are added by
       the system's <u><a href="../man3/syslog.3.html">syslog</a></u>(3) function, not <b>sudoers</b> itself.  As such, they  may  vary  in  format  on  different
       systems.

       The  maximum size of syslog messages varies from system to system.  The <u>syslog_maxlen</u> setting can be used
       to change the maximum syslog message size from the default value of 980 bytes.  For more information, see
       the description of <u>syslog_maxlen</u>.

   <b>Notes</b> <b>on</b> <b>logging</b> <b>to</b> <b>a</b> <b>file</b>
       If the <u>logfile</u> option is set, <b>sudoers</b> will log to a local file, such as <u>/var/log/sudo</u>.  When logging to a
       file, <b>sudoers</b> uses a format similar to <u><a href="../man3/syslog.3.html">syslog</a></u>(3), with a few important differences:

       1.   The <u>progname</u> field is not present.

       2.   The <u>hostname</u> is only logged if the <u>log_host</u> option is enabled.

       3.   The date does not include the year unless the <u>log_year</u> option is enabled.

       4.   Lines that are longer than <u>loglinelen</u> characters (80 by default) are word-wrapped and  continued  on
            the  next  line  with a four character indent.  This makes entries easier to read for a human being,
            but makes it more difficult to use <u><a href="../man1/grep.1.html">grep</a></u>(1) on the log files.  If the <u>loglinelen</u> option is set  to  0
            (or negated with a ‘!’), word wrap will be disabled.

</pre><h4><b>I/O</b> <b>LOGGING</b></h4><pre>
       When  I/O  logging is enabled, <b>sudo</b> will runs the command in a pseudo-terminal, logging user input and/or
       output, depending on which <b>sudoers</b> flags are enabled.  There are five distinct types of I/O that  can  be
       logged, each with a corresponding <b>sudoers</b> flag.

       <b>Type</b>               <b>Flag</b>          <b>Description</b>
       terminal input     log_ttyin     keystrokes entered by the user
       terminal output    log_ttyout    command output displayed to the screen
       standard input     log_stdin     input from a pipe or a file
       standard output    log_stdout    output to a pipe or a file
       standard error     log_stderr    output to a pipe or a file

       In addition to flags described the above, the <u>log_input</u> flag and LOG_INPUT command tag set both <u>log_ttyin</u>
       and  <u>log_stdin</u>.   The  <u>log_output</u>  flag  and  LOG_OUTPUT  command  tag  set  <u>log_ttyout</u>,  <u>log_stdout</u>, and
       <u>log_stderr</u>.

       To capture terminal input and output, <b>sudo</b> run the command in a pseudo-terminal, logging  the  input  and
       output  before  passing  it  on  to the user.  To capture the standard input, standard output or standard
       error, <b>sudo</b> uses a pipe to interpose itself between the input or output stream, logging  the  I/O  before
       passing it to the other end of the pipe.

       I/O  can  be logged either to the local machine or to a remote log server.  For local logs, I/O is logged
       to the directory specified by the <u>iolog_dir</u> option (<u>/var/log/sudo-io</u> by default) using a  unique  session
       ID  that  is  included in the <b>sudo</b> log line, prefixed with ‘TSID=’.  The <u>iolog_file</u> option may be used to
       control the format of the session ID.  For remote logs, the <u>log_servers</u> setting is used to specify one or
       more log servers running <b>sudo_logsrvd</b> or  another  server  that  implements  the  protocol  described  by
       <u><a href="../man5/sudo_logsrv.proto.5.html">sudo_logsrv.proto</a></u>(5).

   <b>I/O</b> <b>logging</b> <b>pitfals</b>
       When  logging standard input, anything sent to the standard input will be consumed, regardless of whether
       or not the command run via <b>sudo</b> is actively reading the standard input.  This may have unexpected results
       when using <b>sudo</b> in a shell script that expects to process the standard input.   For  example,  given  the
       following shell script:

           #!<a href="file:/bin/sh">/bin/sh</a>
           sudo echo testing
           echo done

       It will behave as expected when the script is passed to the shell as a an argument:

           $ sh test.sh
           testing
           done

       However, if the script is passed to the shell on the standard input, the ‘sudo echo testing’ command will
       consume the rest of the script.  This means that the ‘echo done’ statement is never executed.

           $ sh -s &lt; test.sh
           testing

       There are several ways to work around this problem:

       1.   Redirect  the  standard  input  from <u>/dev/null</u> when running a command via <b>sudo</b> that does not need to
            read the standard input.

                sudo echo testing &lt; /dev/null

       2.   Pass the script to the shell by path name instead of via the standard input.

                sh test.sh

       3.   Disable logging the standard input for commands that do not need to read the standard input.

                Defaults!<a href="file:/bin/echo">/bin/echo</a> !log_stdin

       Depending on the command, it may not be desirable to log the standard  input  or  standard  output.   For
       example,  I/O  logging  of  commands that send or receive large amount of data via the standard output or
       standard input such as <u><a href="../man1/rsync.1.html">rsync</a></u>(1) and <u><a href="../man1/tar.1.html">tar</a></u>(1) could fill up the log file system with superfluous  data.   It
       is possible to disable logging of the standard input and standard output for such commands as follows:

           Cmnd_Alias COPY_CMDS = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?tar">/usr/bin/tar</a>, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?cpio">/usr/bin/cpio</a>, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?rsync">/usr/bin/rsync</a>

           # Log input and output but omit stdin and stdout when copying files.
           Defaults log_input, log_output
           Defaults!COPY_CMDS !log_stdin, !log_stdout

       However,  be aware that using the <u>log_input</u> flag or the LOG_INPUT command tag will also enable <u>log_stdin</u>.
       Likewise, the <u>log_ouput</u> flag or the LOG_OUTPUT command tag will enable <u>log_stdout</u> and <u>log_stderr.</u> Careful
       ordering of rules may be necessary to achieve the results that you expect.

   <b>I/O</b> <b>log</b> <b>format</b>
       For both local and remote I/O logs, each log  is  stored  in  a  separate  directory  that  contains  the
       following files:

       <u>log</u>       A text file containing information about the command.  The first line consists of the following
                 colon-delimited  fields:  the  time the command was run, the name of the user who ran <b>sudo</b>, the
                 name of the target user, the name of the target group (optional), the terminal  that  <b>sudo</b>  was
                 run  from,  and  the  number  of lines and columns of the terminal.  The second and third lines
                 contain the working directory the command was run from and the path name of the command  itself
                 (with arguments if present).

       <u>log.json</u>  A  JSON-formatted  file  containing  information about the command.  This is similar to the <u>log</u>
                 file but contains additional information and is easily extensible.  The <u>log.json</u> file  will  be
                 used  by  <u><a href="../man8/sudoreplay.8.html">sudoreplay</a></u>(8)  in  preference to the <u>log</u> file if it exists.  The file may contain the
                 following elements:

                 timestamp
                       A JSON object containing time the command was run.  It consists of  two  values,  <u>seconds</u>
                       and <u>nanoseconds</u>.

                 columns
                       The  number  of  columns  of  the terminal the command ran on, or zero if no terminal was
                       present.

                 command
                       The fully-qualified path of the command that was run.

                 lines
                       The number of lines of the terminal the command ran  on,  or  zero  if  no  terminal  was
                       present.

                 runargv
                       A JSON array representing the command's argument vector as passed to the <u><a href="../man2/execve.2.html">execve</a></u>(2) system
                       call.

                 runenv
                       A  JSON  array  representing  the command's environment as passed to the <u><a href="../man2/execve.2.html">execve</a></u>(2) system
                       call.

                 rungid
                       The group ID the command ran as.  This element is only present when the user specifies  a
                       group on the command line.

                 rungroup
                       The  name  of  the  group the command ran as.  This element is only present when the user
                       specifies a group on the command line.

                 runuid
                       The user ID the command ran as.

                 runuser
                       The name of the user the command ran as.

                 submitcwd
                       The current working directory at the time <b>sudo</b> was run.

                 submithost
                       The name of the host the command was run on.

                 submituser
                       The name of the user who ran the command via <b>sudo</b>.

                 ttyname
                       The path name of the terminal the user invoked <b>sudo</b> from.  If the command was  run  in  a
                       pseudo-terminal, <u>ttyname</u> will be different from the terminal the command actually ran in.

       <u>timing</u>    Timing  information  used  to replay the session.  Each line consists of the I/O log entry type
                 and amount of time since the last entry, followed by type-specific data.   The  I/O  log  entry
                 types and their corresponding type-specific data are:

                 0     standard input, number of bytes in the entry
                 1     standard output, number of bytes in the entry
                 2     standard error, number of bytes in the entry
                 3     terminal input, number of bytes in the entry
                 4     terminal output, number of bytes in the entry
                 5     window change, new number lines and columns
                 6     bug compatibility for <b>sudo</b> 1.8.7 terminal output
                 7     command suspend or resume, signal received

       <u>ttyin</u>     Raw  input  from the user's terminal, exactly as it was received.  This file is only present if
                 the <u>log_input</u> or <u>log_ttyin</u> flags are set and <b>sudo</b> was run from a terminal.  No  post-processing
                 is  performed.   For  manual viewing, you may wish to convert carriage return characters in the
                 log to line feeds.  For example: ‘gunzip -c ttyin | tr "\r" "\n"’

       <u>stdin</u>     The standard input when no terminal is present, or input redirected from a pipe or file.   This
                 file  is only present if the <u>log_input</u> or <u>log_stdin</u> flags are set and the standard input is not
                 connected to a terminal.

       <u>ttyout</u>    Output from the pseudo-terminal (what the command writes  to  the  screen).   Terminal-specific
                 post-processing  is  performed  before  the data is logged.  This means that, for example, line
                 feeds are usually converted to line feed/carriage return pairs and  tabs  may  be  expanded  to
                 spaces.   This  file is only present if the <u>log_output</u> or <u>log_ttyout</u> flags are set and <b>sudo</b> was
                 run from a terminal.

       <u>stdout</u>    The standard output when no terminal is present, or output redirected to a pipe or file.   This
                 file  is  only present if the <u>log_output</u> or <u>log_stdout</u> flags are set and the standard output is
                 not connected to a terminal.

       <u>stderr</u>    The standard error when no terminal is present, or output redirected to a pipe or  file.   This
                 file  is  only  present if the <u>log_output</u> or <u>log_stderr</u> flags are set and the standard error is
                 not connected to a terminal.

       All files other than <u>log</u> are compressed in gzip format unless the <u>compress_io</u>  flag  has  been  disabled.
       Due  to  buffering,  it  is  not normally possible to display the I/O logs in real-time as the program is
       executing.  The I/O log data will not be complete until the program run by <b>sudo</b> has exited  or  has  been
       terminated  by  a  signal.   The <u>iolog_flush</u> flag can be used to disable buffering, in which case I/O log
       data is written to disk as soon as it is available.  The output portion of an I/O log file can be  viewed
       with the <u><a href="../man8/sudoreplay.8.html">sudoreplay</a></u>(8) utility, which can also be used to list or search the available logs.

       User  input  may  contain  sensitive  information  such  as passwords (even if they are not echoed to the
       screen), which will be stored in the log file unencrypted.  In most cases, logging the command output via
       <u>log_output</u> or  LOG_OUTPUT  is  all  that  is  required.   When  logging  input,  consider  disabling  the
       <u>log_passwords</u> flag.

       Since  each  session's  I/O  logs  are stored in a separate directory, traditional log rotation utilities
       cannot be used to limit the number of I/O logs.  The simplest way to  limit  the  number  of  I/O  is  by
       setting  the  <u>maxseq</u>  option  to the maximum number of logs you wish to store.  Once the I/O log sequence
       number reaches <u>maxseq</u>, it will be reset to zero and <b>sudoers</b> will truncate  and  reuse  any  existing  I/O
       logs.

</pre><h4><b>FILES</b></h4><pre>
       <u><a href="file:/etc/sudo.conf">/etc/sudo.conf</a></u>            Sudo front-end configuration

       <u><a href="file:/etc/sudoers">/etc/sudoers</a></u>              List of who can run what

       <u><a href="file:/etc/group">/etc/group</a></u>                Local groups file

       <u>/etc/netgroup</u>             List of network groups

       <u>/var/log/sudo-io</u>          I/O log files

       <u>/run/sudo/ts</u>              Directory containing time stamps for the <b>sudoers</b> security policy

       <u><a href="file:/var/lib/sudo/lectured">/var/lib/sudo/lectured</a></u>    Directory containing lecture status files for the <b>sudoers</b> security policy

       <u><a href="file:/etc/environment">/etc/environment</a></u>          Initial environment for <b>-i</b> mode on AIX and Linux systems

</pre><h4><b>EXAMPLES</b></h4><pre>
       Below  are example <u>sudoers</u> file entries.  Admittedly, some of these are a bit contrived.  First, we allow
       a few environment variables to pass and then define our <u>aliases</u>:

       # Run X applications through sudo; HOME is used to find the
       # .Xauthority file.  Other programs use HOME to locate configuration
       # files and this may lead to privilege escalation!
       Defaults env_keep += "DISPLAY HOME"

       # User alias specification
       User_Alias      FULLTIMERS = millert, mikef, dowdy
       User_Alias      PARTTIMERS = bostley, jwfox, crawl
       User_Alias      WEBADMIN = will, wendy, wim

       # Runas alias specification
       Runas_Alias     OP = root, operator
       Runas_Alias     DB = oracle, sybase
       Runas_Alias     ADMINGRP = adm, oper

       # Host alias specification
       Host_Alias      SPARC = bigtime, eclipse, moet, anchor :\
                       SGI = grolsch, dandelion, black :\
                       ALPHA = widget, thalamus, foobar :\
                       HPPA = boa, nag, python
       Host_Alias      CUNETS = 128.138.0.0/255.255.0.0
       Host_Alias      CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0
       Host_Alias      SERVERS = primary, mail, www, ns
       Host_Alias      CDROM = orion, perseus, hercules

       # Cmnd alias specification
       Cmnd_Alias      DUMPS = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?mt">/usr/bin/mt</a>, /usr/sbin/dump, /usr/sbin/rdump,\
                               /usr/sbin/restore, /usr/sbin/rrestore,\
                               sha224:0GomF8mNN3wlDt1HD9XldjJ3SNgpFdbjO1+NsQ== \
                               /home/operator/bin/start_backups
       Cmnd_Alias      KILL = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?kill">/usr/bin/kill</a>
       Cmnd_Alias      PRINTING = /usr/sbin/lpc, /usr/bin/lprm
       Cmnd_Alias      SHUTDOWN = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?shutdown">/usr/sbin/shutdown</a>
       Cmnd_Alias      HALT = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?halt">/usr/sbin/halt</a>
       Cmnd_Alias      REBOOT = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?reboot">/usr/sbin/reboot</a>
       Cmnd_Alias      SHELLS = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?sh">/usr/bin/sh</a>, /usr/bin/csh, /usr/bin/ksh,\
                                /usr/local/bin/tcsh, /usr/bin/rsh,\
                                /usr/local/bin/zsh
       Cmnd_Alias      SU = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?su">/usr/bin/su</a>
       Cmnd_Alias      PAGERS = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?more">/usr/bin/more</a>, /usr/bin/pg, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?less">/usr/bin/less</a>

       Here we override some of the compiled in default values.  We want <b>sudo</b> to log  via  <u><a href="../man3/syslog.3.html">syslog</a></u>(3)  using  the
       <u>auth</u>  facility  in  all  cases  and  for  commands to be run with the target user's home directory as the
       working directory.  We don't want to subject the full time staff to the <b>sudo</b> lecture and we want to allow
       them to run commands in a <u><a href="../man2/chroot.2.html">chroot</a></u>(2) “sandbox” via the  <b>-R</b>  option.   User  <b>millert</b>  need  not  provide  a
       password  and  we  don't want to reset the LOGNAME or USER environment variables when running commands as
       <b>root</b>.  Additionally, on the machines in the SERVERS <u>Host_Alias</u>, we keep an additional local log file  and
       make  sure  we log the year in each log line since the log entries will be kept around for several years.
       Lastly, we disable shell escapes for the commands in the PAGERS  <u>Cmnd_Alias</u>  (<u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?more">/usr/bin/more</a></u>,  <u>/usr/bin/pg</u>
       and <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?less">/usr/bin/less</a></u>).  This will not effectively constrain users with <b>sudo</b> <b>ALL</b> privileges.

       # Override built-in defaults
       Defaults                syslog=auth,runcwd=~
       Defaults&gt;root           !set_logname
       Defaults:FULLTIMERS     !lecture,runchroot=*
       Defaults:millert        !authenticate
       Defaults@SERVERS        log_year, logfile=/var/log/sudo.log
       Defaults!PAGERS         noexec

       The <u>User</u> <u>specification</u> is the part that actually determines who may run what.

       root            ALL = (ALL) ALL
       %wheel          ALL = (ALL) ALL

       We let <b>root</b> and any user in group <b>wheel</b> run any command on any host as any user.

       FULLTIMERS      ALL = NOPASSWD: ALL

       Full  time  sysadmins  (<b>millert</b>, <b>mikef</b>, and <b>dowdy</b>) may run any command on any host without authenticating
       themselves.

       PARTTIMERS      ALL = ALL

       Part time sysadmins <b>bostley</b>, <b>jwfox</b>, and <b>crawl</b>) may run any command on any host but they must authenticate
       themselves first (since the entry lacks the NOPASSWD tag).

       jack            CSNETS = ALL

       The user <b>jack</b> may run any command on the machines  in  the  CSNETS  alias  (the  networks  128.138.243.0,
       128.138.204.0,  and  128.138.242.0).   Of  those networks, only 128.138.204.0 has an explicit netmask (in
       CIDR notation) indicating it is a class C network.  For the other networks in CSNETS, the local machine's
       netmask will be used during matching.

       lisa            CUNETS = ALL

       The user <b>lisa</b> may run any command on any host in the CUNETS alias (the class B network 128.138.0.0).

       operator        ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT, PRINTING,\
                       sudoedit /etc/printcap, /usr/oper/bin/

       The <b>operator</b> user may run commands limited to simple maintenance.  Here, those are  commands  related  to
       backups,  killing  processes,  the  printing  system,  shutting  down the system, and any commands in the
       directory  <u>/usr/oper/bin/</u>.   One  command  in  the   DUMPS   Cmnd_Alias   includes   a   sha224   digest,
       <u>/home/operator/bin/start_backups</u>.  This is because the directory containing the script is writable by the
       operator  user.  If the script is modified (resulting in a digest mismatch) it will no longer be possible
       to run it via <b>sudo</b>.

       joe             ALL = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?su">/usr/bin/su</a> operator

       The user <b>joe</b> may only <u><a href="../man1/su.1.html">su</a></u>(1) to operator.

       pete            HPPA = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?passwd">/usr/bin/passwd</a> [A-Za-z]*, !<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?passwd">/usr/bin/passwd</a> *root*

       %opers          ALL = (: ADMINGRP) <a href="file:/usr/sbin/">/usr/sbin/</a>

       Users in the <b>opers</b> group may run commands in <u><a href="file:/usr/sbin/">/usr/sbin/</a></u> as themselves with  any  group  in  the  ADMINGRP
       <u>Runas_Alias</u> (the <b>adm</b> and <b>oper</b> groups).

       The  user  <b>pete</b>  is  allowed  to  change anyone's password except for <b>root</b> on the HPPA machines.  Because
       command line arguments are matched as a single, concatenated string, the ‘*’ wildcard will match <u>multiple</u>
       words.  This example assumes that <u><a href="../man1/passwd.1.html">passwd</a></u>(1) does not take multiple user names on the  command  line.   On
       systems  with GNU <u><a href="../man3/getopt.3.html">getopt</a></u>(3), options to <u><a href="../man1/passwd.1.html">passwd</a></u>(1) may be specified after the user argument.  As a result,
       this rule will also allow:

           passwd username --expire

       which may not be desirable.

       bob             SPARC = (OP) ALL : SGI = (OP) ALL

       The user <b>bob</b> may run anything on the SPARC and SGI machines as any user  listed  in  the  OP  <u>Runas_Alias</u>
       (<b>root</b> and <b>operator</b>.)

       jim             +biglab = ALL

       The  user  <b>jim</b>  may  run  any  command on machines in the <u>biglab</u> netgroup.  <b>sudo</b> knows that “biglab” is a
       netgroup due to the ‘+’ prefix.

       +secretaries    ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser

       Users in the <b>secretaries</b> netgroup need to help manage the printers as well as add and  remove  users,  so
       they are allowed to run those commands on all machines.

       fred            ALL = (DB) NOPASSWD: ALL

       The  user  <b>fred</b>  can  run  commands as any user in the DB <u>Runas_Alias</u> (<b>oracle</b> or <b>sybase</b>) without giving a
       password.

       john            ALPHA = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?su">/usr/bin/su</a> [!-]*, !<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?su">/usr/bin/su</a> *root*

       On the ALPHA machines, user <b>john</b> may su to anyone except <b>root</b> but  he  is  not  allowed  to  specify  any
       options to the <u><a href="../man1/su.1.html">su</a></u>(1) command.

       jen             ALL, !SERVERS = ALL

       The  user  <b>jen</b>  may  run  any command on any machine except for those in the SERVERS <u>Host_Alias</u> (primary,
       mail, www, and ns).

       jill            SERVERS = <a href="file:/usr/bin/">/usr/bin/</a>, !SU, !SHELLS

       For any machine in the SERVERS <u>Host_Alias</u>, <b>jill</b> may run any commands in the  directory  <u><a href="file:/usr/bin/">/usr/bin/</a></u>  except
       for  those commands belonging to the SU and SHELLS <u>Cmnd_Aliases</u>.  While not specifically mentioned in the
       rule, the commands in the PAGERS <u>Cmnd_Alias</u> all reside in <u><a href="file:/usr/bin">/usr/bin</a></u> and have the <u>noexec</u> option set.

       steve           CSNETS = (operator) /usr/local/op_commands/

       The user <b>steve</b> may run any command in the directory /usr/local/op_commands/ but only as user operator.

       matt            valkyrie = KILL

       On his personal workstation, valkyrie, <b>matt</b> needs to be able to kill hung processes.

       WEBADMIN        www = (www) ALL, (root) <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?su">/usr/bin/su</a> www

       On the host www, any user in the WEBADMIN <u>User_Alias</u> (will, wendy, and wim), may run any command as  user
       www (which owns the web pages) or simply <u><a href="../man1/su.1.html">su</a></u>(1) to www.

       ALL             CDROM = NOPASSWD: /sbin/umount /CDROM,\
                       /sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM

       Any user may mount or unmount a CD-ROM on the machines in the CDROM <u>Host_Alias</u> (orion, perseus, hercules)
       without  entering  a  password.   This is a bit tedious for users to type, so it is a prime candidate for
       encapsulating in a shell script.

</pre><h4><b>SECURITY</b> <b>NOTES</b></h4><pre>
   <b>Limitations</b> <b>of</b> <b>the</b> ‘!’ operator
       It is generally not effective to “subtract” commands from  <b>ALL</b>  using  the  ‘!’  operator.   A  user  can
       trivially  circumvent  this  by  copying the desired command to a different name and then executing that.
       For example:

       bill    ALL = ALL, !SU, !SHELLS

       Doesn't really prevent <b>bill</b> from running the commands listed in SU or SHELLS since  he  can  simply  copy
       those  commands  to  a different name, or use a shell escape from an editor or other program.  Therefore,
       these kind of restrictions should be considered advisory at best (and reinforced by policy).

       In general, if a user has sudo <b>ALL</b> there is nothing to prevent them from creating their own program  that
       gives  them a <b>root</b> shell (or making their own copy of a shell) regardless of any ‘!’ elements in the user
       specification.

   <b>Security</b> <b>implications</b> <b>of</b> <u><b>fast_glob</b></u>
       If the <u>fast_glob</u> option is in use, it is not possible to reliably negate commands  where  the  path  name
       includes  globbing (aka wildcard) characters.  This is because the C library's <u><a href="../man3/fnmatch.3.html">fnmatch</a></u>(3) function cannot
       resolve relative paths.  While this is typically only an inconvenience for rules that  grant  privileges,
       it can result in a security issue for rules that subtract or revoke privileges.

       For example, given the following <u>sudoers</u> file entry:

       john    ALL = <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?passwd">/usr/bin/passwd</a> [a-zA-Z0-9]*, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?chsh">/usr/bin/chsh</a> [a-zA-Z0-9]*,\
                     <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?chfn">/usr/bin/chfn</a> [a-zA-Z0-9]*, !<a href="file:/usr/bin/">/usr/bin/</a>* root

       User  <b>john</b>  can  still  run  ‘<a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?passwd">/usr/bin/passwd</a>  root’  if <u>fast_glob</u> is enabled by changing to <u><a href="file:/usr/bin">/usr/bin</a></u> and
       running ‘./passwd root’ instead.

       Another potential issue is that when <b>sudo</b> executes the command, it must use the command or path specified
       by the user instead of a path listed in the <u>sudoers</u> file.  This may lead to a time of check  versus  time
       of use race condition.

   <b>Wildcards</b> <b>in</b> <b>command</b> <b>arguments</b>
       Command line arguments are matched as a single, concatenated string.  This mean a wildcard character such
       as  ‘?’  or ‘*’ will match across word boundaries, which may be unexpected.  For example, while a sudoers
       entry like:

           %operator ALL = <a href="file:/bin/cat">/bin/cat</a> /var/log/messages*

       will allow command like:

           $ sudo cat /var/log/messages.1

       It will also allow:

           $ sudo cat /var/log/messages <a href="file:/etc/shadow">/etc/shadow</a>

       which is probably not what was intended.  A safer alternative is to use a regular expression for matching
       command line arguments.  The above example can be rewritten as a regular expression:

           %operator ALL = <a href="file:/bin/cat">/bin/cat</a> ^/var/log/messages[^[:space:]]*$

       The regular expression will only match a single file with a name that begins with  <u>/var/log/messages</u>  and
       does  not  include any white space in the name.  It is often better to do command line processing outside
       of the <u>sudoers</u> file in a scripting language for anything non-trivial.

   <b>Regular</b> <b>expressions</b> <b>in</b> <b>command</b> <b>names</b>
       Using a regular expression to match a command name has  the  same  security  implications  as  using  the
       <u>fast_glob</u> option:

       <b>•</b>  It is not possible to reliably negate commands when the path name is a regular expression.

       <b>•</b>  When  <b>sudo</b>  executes  the  command, it must use the command or path specified by the user instead of a
          path listed in the <u>sudoers</u> file.  This may lead to a time of check versus time of use race condition.

       These issues do not apply to rules where only the command  line  options  are  matched  using  a  regular
       expression.

   <b>Preventing</b> <b>shell</b> <b>escapes</b>
       Once  <b>sudo</b>  executes  a  program,  that  program  is  free to do whatever it pleases, including run other
       programs.  This can be a security issue since it is not uncommon for a program to  allow  shell  escapes,
       which  lets  a  user bypass <b>sudo</b>'s access control and logging.  Common programs that permit shell escapes
       include shells (obviously), editors, paginators, mail, and terminal programs.

       There are four basic approaches to this problem:

       restrict   Avoid giving users access to commands that allow the user to  run  arbitrary  commands.   Many
                  editors  have  a restricted mode where shell escapes are disabled, though <b>sudoedit</b> is a better
                  solution to running editors via <b>sudo</b>.  Due to the large number of programs  that  offer  shell
                  escapes, restricting users to the set of programs that do not is often unworkable.

       intercept  On  most  systems,  <b>sudo</b>'s  <u>intercept</u>  functionality can be used to transparently intercept an
                  attempt to run a new command, allow or deny it based on <u>sudoers</u> rules,  and  log  the  result.
                  For  example,  this can be used to restrict the commands run from within a privileged shell or
                  editor.  However, not all programs operate correctly when <u>intercept</u> is enabled.

                  There are two underlying mechanisms that may be used to  implement  <u>intercept</u>  mode:  <u>dso</u>  and
                  <u>trace</u>.  The <u>intercept_type</u> setting can be used to select between them.

                  The  first mechanism, <u>dso</u>, overrides the standard C library functions that are used to execute
                  a command.  It does this by setting an environment variable (usually LD_PRELOAD) to  the  path
                  of  a  dynamic  shared object, or shared library, containing custom versions of the <u><a href="../man2/execve.2.html">execve</a></u>(2),
                  <u><a href="../man3/execl.3.html">execl</a></u>(3),  <u><a href="../man3/execle.3.html">execle</a></u>(3),  <u><a href="../man3/execlp.3.html">execlp</a></u>(3),  <u><a href="../man3/execv.3.html">execv</a></u>(3),  <u><a href="../man3/execvp.3.html">execvp</a></u>(3),  <u><a href="../man3/execvpe.3.html">execvpe</a></u>(3),  and  <u><a href="../man3/system.3.html">system</a></u>(3)  library
                  functions  that  connect back to <b>sudo</b> for a policy decision.  Note, however, that this applies
                  only to dynamically-linked  executables.   It  is  not  possible  to  intercept  commands  for
                  statically-linked  executables  or  executables  that  run  under  binary  emulation this way.
                  Because most dynamic loaders ignore LD_PRELOAD (or the equivalent)  when  running  set-user-ID
                  and  set-group-ID  programs, <b>sudoers</b> will not permit such programs to be run in <u>intercept</u> mode
                  by default.  The <u>dso</u> mechanism is incompatible with  <b>sudo</b>'s  SELinux  RBAC  support  (but  see
                  below).    SELinux  disables  LD_PRELOAD  by  default  and  interferes  with  file  descriptor
                  inheritance, which <b>sudo</b> relies on.

                  The second mechanism, <u>trace</u>, is available on Linux systems that support <u><a href="../man2/seccomp.2.html">seccomp</a></u>(2)  filtering.
                  It uses <u><a href="../man2/ptrace.2.html">ptrace</a></u>(2) and <u><a href="../man2/seccomp.2.html">seccomp</a></u>(2) to intercept the <u><a href="../man2/execve.2.html">execve</a></u>(2) system call instead of pre-loading
                  a  dynamic  shared  object.   Both  static  and  dynamic  executables  are supported and it is
                  compatible with <b>sudo</b>'s SELinux RBAC mode.  Functions utilizing the  <u><a href="../man2/execveat.2.html">execveat</a></u>(2)  system  call,
                  such  as  <u><a href="../man3/fexecve.3.html">fexecve</a></u>(3),  are  not  currently  intercepted.   Programs  that  rely  on  <u><a href="../man2/ptrace.2.html">ptrace</a></u>(2)
                  themselves, such as debuggers and system call tracers (such as <u><a href="../man1/strace.1.html">strace</a></u>(1) and <u><a href="../man1/truss.1.html">truss</a></u>(1)) will be
                  unable to function if <u>intercept</u> is enabled in <u>trace</u> mode.  This same  restriction  applies  to
                  the <u>log_subcmds</u> sudoers option.

                  The  <u>intercept</u> feature is known to work on Solaris, *BSD, Linux, macOS, HP-UX 11.x and AIX 5.3
                  and above.  It should be supported on most  operating  systems  that  support  the  LD_PRELOAD
                  environment  variable  or  an  equivalent.   It  is  not  possible to intercept shell built-in
                  commands or restrict the ability to read or write sensitive files from within a shell.

                  To enable intercept mode on a per-command basis, use the INTERCEPT tag as  documented  in  the
                  User Specification section above.  Here is that example again:

                  chuck   research = INTERCEPT: ALL

                  This  allows  user  <b>chuck</b> to run any command on the machine “research” in intercept mode.  Any
                  commands run via shell escapes will be validated and  logged  by  <b>sudo</b>.   If  you  are  unsure
                  whether  or not your system is capable of supporting <u>intercept</u>, you can always just try it out
                  and check whether or not external commands run via  a  shell  are  logged  when  <u>intercept</u>  is
                  enabled.

                  There  is  an  inherent race condition between when a command is checked against <b>sudoers</b> rules
                  and when it is actually executed.  If a user is allowed to run arbitrary commands, they may be
                  able to change the <u><a href="../man2/execve.2.html">execve</a></u>(2) arguments in the program  after  the  <b>sudoers</b>  policy  check  has
                  completed  but  before  the  new command is executed.  Starting with version 1.9.12, the <u>trace</u>
                  method will verify that the command and its arguments have not  changed  after  <u><a href="../man2/execve.2.html">execve</a></u>(2)  has
                  completed  but  before  execution of the new program has had a chance to run.  This is not the
                  case with the <u>dso</u> method.  See the  description  of  the  <u>intercept_verify</u>  setting  for  more
                  information.

       log        There  are  two  separate but related ways to log additional commands.  The first is to enable
                  I/O logging using the <u>log_output</u> flag.  This will log the command's output but will not create
                  an event log entry when  the  additional  command  is  run.   The  second  is  to  enable  the
                  <u>log_subcmds</u>  flag  in <u>sudoers</u> which will create an event log entry every time a new command is
                  run.  If I/O logging is also enabled, the log entry will include a time offset  into  the  I/O
                  log  to  indicate  when  the  command was run.  This offset can be passed to the <u><a href="../man8/sudoreplay.8.html">sudoreplay</a></u>(8)
                  utility to replay the I/O log at the exact moment when the command was run.   The  <u>log_subcmds</u>
                  flag uses the same mechanism as <u>intercept</u> (see above) and has the same limitations.

       noexec     <b>sudo</b>'s  <u>noexec</u>  functionality  can be used to prevent a program run by <b>sudo</b> from executing any
                  other programs.  On most systems, it uses the same  LD_PRELOAD  mechanism  as  <u>intercept</u>  (see
                  above)  and  thus  the  same  caveats  apply.  The <u>noexec</u> functionality is capable of blocking
                  execution of commands  run  via  the  <u><a href="../man2/execve.2.html">execve</a></u>(2),  <u><a href="../man3/execl.3.html">execl</a></u>(3),  <u><a href="../man3/execle.3.html">execle</a></u>(3),  <u><a href="../man3/execlp.3.html">execlp</a></u>(3),  <u><a href="../man3/exect.3.html">exect</a></u>(3),
                  <u><a href="../man3/execv.3.html">execv</a></u>(3), <u><a href="../man3/execveat.3.html">execveat</a></u>(3), <u><a href="../man3/execvP.3.html">execvP</a></u>(3), <u><a href="../man3/execvp.3.html">execvp</a></u>(3), <u><a href="../man3/execvpe.3.html">execvpe</a></u>(3), <u><a href="../man3/fexecve.3.html">fexecve</a></u>(3), <u><a href="../man3/popen.3.html">popen</a></u>(3), <u><a href="../man3/posix_spawn.3.html">posix_spawn</a></u>(3),
                  <u><a href="../man3/posix_spawnp.3.html">posix_spawnp</a></u>(3),  <u><a href="../man3/system.3.html">system</a></u>(3),  and <u><a href="../man3/wordexp.3.html">wordexp</a></u>(3) functions.  On Linux, a <u><a href="../man2/seccomp.2.html">seccomp</a></u>(2) filter is used
                  to implement <u>noexec</u>.  On Solaris 10 and higher, <u>noexec</u> uses Solaris privileges instead of  the
                  LD_PRELOAD environment variable.

                  To  enable  <u>noexec</u>  for  a command, use the NOEXEC tag as documented in the User Specification
                  section above.  Here is that example again:

                  aaron   shanty = NOEXEC: <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?more">/usr/bin/more</a>, <a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vi">/usr/bin/vi</a>

                  This allows user <b>aaron</b> to run <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?more">/usr/bin/more</a></u> and <u><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?vi">/usr/bin/vi</a></u> with <u>noexec</u>  enabled.   This  will
                  prevent those two commands from executing other commands (such as a shell).  If you are unsure
                  whether  or not your system is capable of supporting <u>noexec</u> you can always just try it out and
                  check whether shell escapes work when <u>noexec</u> is enabled.

       Restricting shell escapes is not a  panacea.   Programs  running  as  <b>root</b>  are  still  capable  of  many
       potentially  hazardous  operations  (such as changing or overwriting files) that could lead to unintended
       privilege escalation.  In the specific case of an editor, a safer approach is to give the user permission
       to run <b>sudoedit</b> (see below).

   <b>Secure</b> <b>editing</b>
       The <b>sudoers</b> plugin includes <b>sudoedit</b> support which allows users to securely edit files with the editor of
       their choice.  As <b>sudoedit</b> is a built-in command, it must be specified in  the  <u>sudoers</u>  file  without  a
       leading path.  However, it may take command line arguments just as a normal command does.  Wildcards used
       in  <u>sudoedit</u>  command  line arguments are expected to be path names, so a forward slash (‘/’) will not be
       matched by a wildcard.

       Unlike other <b>sudo</b> commands, the editor is run with the permissions of the  invoking  user  and  with  the
       environment unmodified.  More information may be found in the description of the <b>-e</b> option in <u><a href="../man8/sudo.8.html">sudo</a></u>(8).

       For example, to allow user operator to edit the “message of the day” file on any machine:

           operator ALL = sudoedit /etc/motd

       The operator user then runs <b>sudoedit</b> as follows:

           $ sudoedit /etc/motd

       The editor will run as the operator user, not <b>root</b>, on a temporary copy of <u>/etc/motd</u>.  After the file has
       been edited, <u>/etc/motd</u> will be updated with the contents of the temporary copy.

       Users should <u>never</u> be granted <b>sudoedit</b> permission to edit a file that resides in a directory the user has
       write  access to, either directly or via a wildcard.  If the user has write access to the directory it is
       possible to replace the legitimate file with a link to another file, allowing the  editing  of  arbitrary
       files.   To  prevent  this, starting with version 1.8.16, symbolic links will not be followed in writable
       directories and <b>sudoedit</b> will refuse  to  edit  a  file  located  in  a  writable  directory  unless  the
       <u>sudoedit_checkdir</u> option has been disabled or the invoking user is <b>root</b>.  Additionally, in version 1.8.15
       and  higher,  <b>sudoedit</b>  will  refuse  to open a symbolic link unless either the <u>sudoedit_follow</u> option is
       enabled or the <u>sudoedit</u> command is prefixed with the FOLLOW tag in the <u>sudoers</u> file.

   <b>Time</b> <b>stamp</b> <b>file</b> <b>checks</b>
       <b>sudoers</b> will check the ownership of its time stamp directory (<u>/run/sudo/ts</u> by  default)  and  ignore  the
       directory's  contents  if  it is not owned by <b>root</b> or if it is writable by a user other than <b>root</b>.  Older
       versions of <b>sudo</b> stored time stamp files in <u><a href="file:/tmp">/tmp</a></u>; this is no longer recommended as it may be possible for
       a user to create the time stamp themselves on  systems  that  allow  unprivileged  users  to  change  the
       ownership of files they create.

       While  the  time  stamp  directory  <u>should</u>  be  cleared at reboot time, not all systems contain a <u><a href="file:/run">/run</a></u> or
       <u><a href="file:/var/run">/var/run</a></u> directory.  To avoid potential problems, <b>sudoers</b> will ignore time stamp  files  that  date  from
       before the machine booted on systems where the boot time is available.

       Some  systems  with  graphical  desktop environments allow unprivileged users to change the system clock.
       Since <b>sudoers</b> relies on the system clock for time stamp validation, it may be possible  on  such  systems
       for  a  user  to  run  <b>sudo</b> for longer than <u>timestamp_timeout</u> by setting the clock back.  To combat this,
       <b>sudoers</b> uses a monotonic clock (which never moves backwards) for its time stamps if the  system  supports
       it.

       <b>sudoers</b>  will  not  honor  time  stamps  set  far  in  the  future.  Time stamps with a date greater than
       current_time + 2 * TIMEOUT will be ignored and <b>sudoers</b> will log and complain.

       If the <u>timestamp_type</u> option is set to “tty”, the time stamp record includes the  device  number  of  the
       terminal  the user authenticated with.  This provides per-terminal granularity but time stamp records may
       still outlive the user's session.

       Unless the <u>timestamp_type</u> option is set to “global”, the time stamp record also includes the  session  ID
       of  the  process  that  last  authenticated.  This prevents processes in different terminal sessions from
       using the same time stamp record.  On systems where a process's start time can be queried, the start time
       of the session leader is recorded  in  the  time  stamp  record.   If  no  terminal  is  present  or  the
       <u>timestamp_type</u>  option  is  set to “ppid”, the start time of the parent process is used instead.  In most
       cases this will prevent a time stamp record from being reused without the user entering a  password  when
       logging out and back in again.

</pre><h4><b>DEBUGGING</b></h4><pre>
       Versions  1.8.4  and  higher  of  the <b>sudoers</b> plugin support a flexible debugging framework that can help
       track down what the plugin is doing internally if there is a problem.  This  can  be  configured  in  the
       <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) file.

       The <b>sudoers</b> plugin uses the same debug flag format as the <b>sudo</b> front-end: <u>subsystem</u>@<u>priority</u>.

       The  priorities  used  by  <b>sudoers</b>,  in order of decreasing severity, are: <u>crit</u>, <u>err</u>, <u>warn</u>, <u>notice</u>, <u>diag</u>,
       <u>info</u>, <u>trace</u>, and <u>debug</u>.  Each priority, when specified, also includes all priorities higher than it.  For
       example, a priority of <u>notice</u> would include debug messages logged at <u>notice</u> and higher.

       The following subsystems are used by the <b>sudoers</b> plugin:

       <u>alias</u>     <u>User_Alias</u>, <u>Runas_Alias</u>, <u>Host_Alias</u> and <u>Cmnd_Alias</u> processing

       <u>all</u>       matches every subsystem

       <u>audit</u>     BSM and Linux audit code

       <u>auth</u>      user authentication

       <u>defaults</u>  <u>sudoers</u> file <u>Defaults</u> settings

       <u>env</u>       environment handling

       <u>ldap</u>      LDAP-based sudoers

       <u>logging</u>   logging support

       <u>match</u>     matching of users, groups, hosts, and netgroups in the <u>sudoers</u> file

       <u>netif</u>     network interface handling

       <u>nss</u>       network service switch handling in <b>sudoers</b>

       <u>parser</u>    <u>sudoers</u> file parsing

       <u>perms</u>     permission setting

       <u>plugin</u>    The equivalent of <u>main</u> for the plugin.

       <u>pty</u>       pseudo-terminal related code

       <u>rbtree</u>    redblack tree internals

       <u>sssd</u>      SSSD-based sudoers

       <u>util</u>      utility functions

       For example:

       Debug sudoers.so /var/log/sudoers_debug match@info,nss@info

       For more information, see the <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5) manual.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/ssh.1.html">ssh</a></u>(1),  <u><a href="../man1/su.1.html">su</a></u>(1),  <u><a href="../man3/fnmatch.3.html">fnmatch</a></u>(3),  <u><a href="../man3/glob.3.html">glob</a></u>(3),  <u><a href="../man3/mktemp.3.html">mktemp</a></u>(3),   <u><a href="../man3/strftime.3.html">strftime</a></u>(3),   <u><a href="../man5/sudo.conf.5.html">sudo.conf</a></u>(5),   <u><a href="../man5/sudo_logsrv.proto.5.html">sudo_logsrv.proto</a></u>(5),
       <u><a href="../man5/sudo_plugin.5.html">sudo_plugin</a></u>(5), <u><a href="../man5/sudoers.ldap.5.html">sudoers.ldap</a></u>(5), <u><a href="../man5/sudoers_timestamp.5.html">sudoers_timestamp</a></u>(5), <u><a href="../man8/sudo.8.html">sudo</a></u>(8), <u><a href="../man8/sudo_logsrvd.8.html">sudo_logsrvd</a></u>(8), <u><a href="../man8/visudo.8.html">visudo</a></u>(8)

</pre><h4><b>AUTHORS</b></h4><pre>
       Many people have worked on <b>sudo</b> over the years; this version consists of code written primarily by:

             Todd C. Miller

       See  the  CONTRIBUTORS.md  file in the <b>sudo</b> distribution (https://www.sudo.ws/about/contributors/) for an
       exhaustive list of people who have contributed to <b>sudo</b>.

</pre><h4><b>CAVEATS</b></h4><pre>
       The <u>sudoers</u> file should <b>always</b> be edited by the <b>visudo</b> utility which locks the file and checks for syntax
       errors.  If <u>sudoers</u> contains syntax errors, <b>sudo</b> may refuse to run, which is a serious problem if <b>sudo</b> is
       your only method of obtaining superuser privileges.  Recent versions of <b>sudoers</b> will attempt  to  recover
       after  a  syntax  error  by ignoring the rest of the line after encountering an error.  Older versions of
       <b>sudo</b> will not run if <u>sudoers</u> contains a syntax error.

       When using netgroups of machines (as opposed to users), if you store fully qualified  host  name  in  the
       netgroup  (as is usually the case), you either need to have the machine's host name be fully qualified as
       returned by the <u>hostname</u> command or use the <u>fqdn</u> option in <u>sudoers</u>.

</pre><h4><b>BUGS</b></h4><pre>
       If you believe you have found a bug in <b>sudoers</b>, you can  either  file  a  bug  report  in  the  sudo  bug
       database, https://bugzilla.sudo.ws/, or open an issue at https://github.com/sudo-project/sudo/issues.  If
       you   would   prefer   to   use   email,   messages  may  be  sent  to  the  sudo-workers  mailing  list,
       https://www.sudo.ws/mailman/listinfo/sudo-workers (public) or &lt;<a href="mailto:sudo@sudo.ws">sudo@sudo.ws</a>&gt; (private).

       Please not report security vulnerabilities through public  GitHub  issues,  Bugzilla  or  mailing  lists.
       Instead,  report  them  via email to &lt;<a href="mailto:Todd.Miller@sudo.ws">Todd.Miller@sudo.ws</a>&gt;.  You may encrypt your message with PGP if you
       would like, using the key found at https://www.sudo.ws/dist/PGPKEYS.

</pre><h4><b>SUPPORT</b></h4><pre>
       Limited    free    support    is    available    via     the     sudo-users     mailing     list,     see
       https://www.sudo.ws/mailman/listinfo/sudo-users to subscribe or search the archives.

</pre><h4><b>DISCLAIMER</b></h4><pre>
       <b>sudo</b>  is  provided  “AS  IS”  and  any  express or implied warranties, including, but not limited to, the
       implied warranties of merchantability and fitness for a  particular  purpose  are  disclaimed.   See  the
       LICENSE.md file distributed with <b>sudo</b> or https://www.sudo.ws/about/license/ for complete details.

Sudo 1.9.16p2                                   November 11, 2024                                     <u><a href="../man5/SUDOERS.5.html">SUDOERS</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>