<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>policy - Shorewall policy file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/shorewall">shorewall_5.2.8-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       policy - Shorewall policy file

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>/etc/shorewall[6]/policy</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This file defines the high-level policy for connections between zones defined in <b>shorewall-zones</b>[1](5).

           <b>Important</b>

           The order of entries in this file is important

           This file determines what to do with a new connection request if we don't get a match from the
           <b>shorewall-blrules</b>[2](5) or <b>shorewall-rules</b>[3](5) files. For each source/destination pair, the file is
           processed in order until a match is found ("all" will match any source or destination).

           <b>Important</b>

           Intra-zone policies are pre-defined

           For $FW and for all of the zones defined in <b>shorewall-zones</b>[1](5), the POLICY for connections from
           the zone to itself is ACCEPT (with no logging or TCP connection rate limiting) but may be overridden
           by an entry in this file. The overriding entry must be explicit (specifying the zone name in both
           SOURCE and DEST) or it must use "all+" (Shorewall 4.5.17 or later).

           Similarly, if you have IMPLICIT_CONTINUE=Yes in <b>shorewall.conf</b>[4](5), then the implicit policy
           to/from any sub-zone is CONTINUE. These implicit CONTINUE policies may also be overridden by an
           explicit entry in this file.

       The columns in the file are as follows (where the column name is followed by a different name in
       parentheses, the different name is used in the alternate specification syntax).

       <b>SOURCE</b> - <u>zone</u>[,...[+]]|<b>$FW</b>|<b>all[+][!</b><u>ezone</u><b>[,...]]</b>
           Source zone. Must be the name of a zone defined in <b>shorewall-zones</b>[1](5), $FW, "all" or "all+".

           Support for <b>all+</b> was added in Shorewall 4.5.17.  <b>all</b> does not override the implicit intra-zone ACCEPT
           policy while <b>all+</b> does.

           Beginning with Shorewall 5.0.12, multiple zones may be listed separated by commas. As above, if '+'
           is specified after two or more zone names, then the policy overrides the implicit intra-zone ACCEPT
           policy if the same <u>zone</u> appears in both the SOURCE and DEST columns.

           Beginning with Shorewall 5.2.3, a comma-separated list of excluded zones preceded by "!" may follow
           <b>all</b> or <b>all+.</b>

       <b>DEST</b> - <u>zone</u>[,...[+]]|<b>$FW</b>|all[+][!<u>ezone</u>[,...]]
           Destination zone. Must be the name of a zone defined in <b>shorewall-zones</b>[1](5), $FW, "all" or "all+".
           If the DEST is a bport zone, then the SOURCE must be "all", "all+", another bport zone associated
           with the same bridge, or it must be an ipv4 zone that is associated with only the same bridge.

           Support for "all+" was added in Shorewall 4.5.17. "all" does not override the implicit intra-zone
           ACCEPT policy while "all+" does.

           Beginning with Shorewall 5.0.12, multiple zones may be listed separated by commas. As above, if '+'
           is specified after two or more zone names, then the policy overrides the implicit intra-zone ACCEPT
           policy if the same <u>zone</u> appears in both the SOURCE and DEST columns.

           Beginning with Shorewall 5.2.3, a comma-separated list of excluded zones preceded by "!" may follow
           <b>all</b> or <b>all+</b>.

       <b>POLICY</b> -
       {<b>ACCEPT</b>|<b>DROP</b>|<b>REJECT</b>|<b>BLACKLIST</b>|<b>CONTINUE</b>|<b>QUEUE</b>|<b>NFQUEUE</b>[([<u>queuenumber</u>1[:<u>queuenumber2</u>[c]][,bypass]]|bypass)]|<b>NONE</b>}[<b>:</b>{[+]<u>policy-action</u>[:level][,...]|<b>None</b>}]
           Policy if no match from the rules file is found.

           If the policy is neither CONTINUE nor NONE then the policy may be followed by ":" and one of the
           following:

            1. The word "None" or "none". This causes any default action defined in <b>shorewall.conf</b>[4](5) to be
               omitted for this policy.

            2. The name of an action with optional parameters enclosed in parentheses. The action will be
               invoked before the policy is enforced.

           Actions can have parameters specified.

           Beginning with Shorewall 4.5.10, the action name can be followed optionally by a colon and a log
           level. The level will be applied to each rule in the action or body that does not already have a log
           level.

           Beginning with Shorewall 5.1.2, multiple <u>action</u>[:<u>level</u>] specification may be listeded, separated by
           commas. The actions are invoked in the order listed. Also beginning with Shorewall 5.1.2, the
           policy-action list can be prefixed with a plus sign ("+") indicating that the listed actions are in
           addition to those listed in the related _DEFAULT setting in <b>shorewall.conf</b>[4](5).

           Possible policies are:

           <b>ACCEPT</b>
               Accept the connection.

           <b>DROP</b>
               Ignore the connection request.

           <b>REJECT</b>
               For TCP, send RST. For all other, send an "unreachable" ICMP.

           <b>BLACKLIST</b>
               Added in Shorewall 5.1.1 and requires that the DYNAMIC_BLACKLIST setting in <b>shorewall.conf</b>[4](5)
               specifies ipset-based dynamic blacklisting. The SOURCE IP address is added to the blacklist ipset
               and the connection request is ignored.

           <b>QUEUE</b>
               Queue the request for a user-space application such as Snort-inline.

           <b>NFQUEUE</b>
               Queue the request for a user-space application using the nfnetlink_queue mechanism. If a
               <u>queuenumber1</u> is not given, queue zero (0) is assumed. Beginning with Shorewall 4.6.10, a second
               queue number (queuenumber2) may be given. This specifies a range of queues to use. Packets are
               then balanced across the given queues. This is useful for multicore systems: start multiple
               instances of the userspace program on queues x, x+1, .. x+n and use "x:x+n". Packets belonging to
               the same connection are put into the same nfqueue. Beginning with Shorewall 5.1.0, queuenumber2
               may be followed by the letter 'c' to indicate that the CPU ID will be used as an index to map
               packets to the queues. The idea is that you can improve performance if there's a queue per CPU.
               Requires the NFQUEUE CPU Fanout capability in your kernel and iptables.

               Beginning with Shorewall 4.6.10, the keyword <b>bypass</b> can be given. By default, if no userspace
               program is listening on an NFQUEUE, then all packets that are to be queued are dropped. When this
               option is used, the NFQUEUE rule behaves like ACCEPT instead.

           <b>CONTINUE</b>
               Pass the connection request past any other rules that it might also match (where the source or
               destination zone in those rules is a superset of the SOURCE or DEST in this policy). See
               <b>shorewall-nesting</b>[5](5) for additional information.

           <b>NONE</b>
               Assume that there will never be any packets from this SOURCE to this DEST. Shorewall will not
               create any infrastructure to handle such packets and you may not have any rules with this SOURCE
               and DEST in the /etc/shorewall/rules file. If such a packet <b>is</b> received, the result is undefined.
               NONE may not be used if the SOURCE or DEST columns contain the firewall zone ($FW) or "all".

       <b>LOGLEVEL</b> (loglevel) - [<u>log-level</u>|<b>ULOG|NFLOG</b>]
           Optional - if supplied, each connection handled under the default POLICY is logged at that level. If
           not supplied, no log message is generated. See <a href="../man5/syslog.conf.5.html">syslog.conf</a>(5) for a description of log levels.

           You may also specify ULOG or NFLOG (must be in upper case). This will log to the ULOG or NFLOG target
           and will send to a separate log through use of ulogd
           (<b><a href="http://www.netfilter.org/projects/ulogd/index.html">http://www.netfilter.org/projects/ulogd/index.html</a></b>).

           For a description of logging, see <b><a href="../man5/shorewall-logging.5.html">shorewall-logging</a>(5)</b>[6].

           If you don't want to log but need to specify the following column, place "-" here.

       <b>RATE</b> (rate) - [-|<u>limit</u>]
           where limit is one of:
               [<b>-</b>|[{<b>s</b>|<b>d</b>}[/<u>vlsm</u>]:[[<u>name</u>][(ht-buckets,ht-max)]:]]]<u>rate</u><b>/</b>{<b>sec</b>|<b>min</b>|<b>hour</b>|<b>day</b>}[:<u>burst</u>]
               [<u>name</u>1:]<u>rate1</u><b>/</b>{<b>sec</b>|<b>min</b>|<b>hour</b>|<b>day</b>}[:<u>burst1</u>],[<u>name</u>2:]<u>rate2</u><b>/</b>{<b>sec</b>|<b>min</b>|<b>hour</b>|<b>day</b>}[:<u>burst2</u>]
           If passed, specifies the maximum TCP connection <u>rate</u> and the size of an acceptable <u>burst</u>. If not
           specified, TCP connections are not limited. If the <u>burst</u> parameter is omitted, a value of 5 is
           assumed.

           When <b>s:</b> or <b>d:</b> is specified, the rate applies per source IP address or per destination IP address
           respectively. The <u>name</u> may be chosen by the user and specifies a hash table to be used to count
           matching connections. If not give, the name <b>shorewall</b> is assumed. Where more than one POLICY or rule
           specifies the same name, the connections counts for the policies are aggregated and the individual
           rates apply to the aggregated count. Beginning with Shorewall 5.2.1, the <b>s</b> or <b>d</b> may be followed by a
           slash ("/") and an integer <u>vlsm</u>. When a <u>vlsm</u> is specified, all source or destination addresses
           encountered will be grouped according to the given prefix length and the so-created subnet will be
           subject to the rate limit.

           Beginning with Shorewall 4.6.5, two <u>limit</u>s may be specified, separated by a comma. In this case, the
           first limit (<u>name1</u>, <u>rate1</u>, burst1) specifies the per-source IP limit and the second limit specifies
           the per-destination IP limit.

           Example: <b>client:10/sec:20,:60/sec:100</b>

           Beginning with Shorewall 5.2.1, the table name, if any, may be followed by two integers separated by
           commas and enclosed in parentheses. The first integer (<u>ht-buckets</u>) specifies the number of buckets in
           the generated hash table. The second integer (<u>ht-max</u>) specifies the maximum number of entries in the
           hash table.

           Example: <b>s:client(1024,65536):10/sec</b>

       <b>CONNLIMIT</b> - <u>limit</u>[:<u>mask</u>]
           May be used to limit the number of simultaneous connections from each individual host to <u>limit</u>
           connections. While the limit is only checked on connections to which this policy could apply, the
           number of current connections is calculated over all current connections from the SOURCE host. By
           default, the limit is applied to each host individually but can be made to apply to networks of hosts
           by specifying a <u>mask</u>. The <u>mask</u> specifies the width of a VLSM mask to be applied to the source
           address; the number of current connections is then taken over all hosts in the subnet
           <u>source-address</u>/<u>mask</u>.

</pre><h4><b>EXAMPLE</b></h4><pre>
        1. All connections from the local network to the internet are allowed

        2. All connections from the internet are ignored but logged at syslog level KERNEL.INFO.

        3. All other connection requests are rejected and logged at level KERNEL.INFO.

                   #SOURCE         DEST            POLICY          LOG           BURST:LIMIT
                   #                                               LEVEL
                   loc             net             ACCEPT
                   net             all             DROP            info
                   #
                   # THE FOLLOWING POLICY MUST BE LAST
                   #
                   all             all             REJECT          info

</pre><h4><b>FILES</b></h4><pre>
       /etc/shorewall/policy

       /etc/shorewall6/policy

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>https://shorewall.org/configuration_file_basics.htm#Pairs</b>[7]

       <a href="../man8/shorewall.8.html">shorewall</a>(8)

</pre><h4><b>NOTES</b></h4><pre>
        1. shorewall-zones
           https://shorewall.org/manpages/shorewall-zones.html

        2. shorewall-blrules
           https://shorewall.org/manpages/shorewall-blrules.html

        3. shorewall-rules
           https://shorewall.org/manpages/shorewall-rules.html

        4. shorewall.conf
           https://shorewall.org/manpages/shorewall.conf.html

        5. shorewall-nesting
           https://shorewall.org/manpages/shorewall-nesting.html

        6. <a href="../man5/shorewall-logging.5.html">shorewall-logging</a>(5)
           https://shorewall.org/shorewall_logging.html

        7. https://shorewall.org/configuration_file_basics.htm#Pairs
           https://shorewall.org/configuration_file_basics.htm#Pairs

Configuration Files                                09/24/2020                                <u><a href="../man5/SHOREWALL-POLICY.5.html">SHOREWALL-POLICY</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>