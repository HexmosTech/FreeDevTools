<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aide.conf - The configuration file for Advanced Intrusion Detection Environment</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/aide">aide_0.19.1-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       aide.conf - The configuration file for Advanced Intrusion Detection Environment

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>aide.conf</b>  is the configuration file for Advanced Intrusion Detection Environment. <b>aide.conf</b> contains the
       runtime configuration aide uses to initialize or check the AIDE database.

</pre><h4><b>FILE</b> <b>FORMAT</b></h4><pre>
       aide.conf is case-sensitive. Leading and trailing white spaces are ignored. Each  config  line  must  end
       with new line.

       AIDE  uses the backslash character (<b>\</b>) as escape character for ' ' (space), '@' and '\' (backslash) (e.g.
       '\ ' or '\@'). To literally match a '<b>\</b>' in a file path with a regular expression you have to  escape  the
       backslash twice (i.e. '<b>\\\\</b>').

       There  are three types of lines in <b>aide.conf</b>. First there are the configuration options which are used to
       set configuration parameters and define groups. Second, there are (restricted) rules  that  are  used  to
       indicate  which  files/directoires  from  the  file  system are added to the database. Third, macro lines
       define or undefine variables within the config file. Lines beginning with # are ignored as comments.

</pre><h4><b>CONFIG</b> <b>OPTIONS</b></h4><pre>
       These lines have the format parameter=value. See URLS for a list of valid urls.

       database_in (type: URL, default: see <b>--version</b> output, added in AIDE v0.17)
       database (REMOVED in AIDE v0.19)
              The url from which database is read. There can only be one of these lines. If there  are  multiple
              database lines then the first is used.

              <b>Examples:</b>

                 <b>database_in=file:/var/lib/aide/aide.db</b>

                    Read database locally from <u>/var/lib/aide/aide.db</u>.

                 <b>database_in=stdin</b>

                    Read database from <u>stdin</u>.

                 <b>database_in=https://example.com/aide.db</b>

                    Read database remotely from <u>https://example.com/aide.db</u>.

       database_out (type: URL, default: see <b>--version</b> output)
              The  url  to  which the new database is written to. There can only be one of these lines. If there
              are multiple database_out lines then the first is used.

       database_new (type: URL, default: <b>&lt;none&gt;</b>)
              The url from which the other database for --compare is read.

       database_attrs (type: attribute expression, default: <b>H</b>, added in AIDE v0.16)
              The attributes of the (uncompressed) database files which are to be added to the reports in report
              level  &gt;=  <b>database_attributes</b>  .  Only  checksum  attributes  are  supported.  To   disable   set
              <u>database_attrs</u> to '<b>E</b>'.

       database_add_metadata (type: bool, default: <b>true</b>, added in AIDE v0.16)
              Whether  to  add  the AIDE version and the time of database generation as comments to the database
              file or not. This option may be set to false by default in a future release.

       log_level (type: log level, default: <b>warning</b>, added in AIDE v0.17)
              The log level to use. Log messages are written to <u>stderr</u>. If there are  multiple  <u>log_level</u>  lines
              then the first one is used. The --log-level or -L command line option overwrites this option.

              The following log levels are available:

                     <b>error</b>:  show  unrecoverable issues that have to be handled by the user. Errors are fatal to
                     the AIDE process.

                     <b>warning</b>: additionally show recoverable issues that most likely lead to unexpected behaviour
                     and should be handled by the user

                     <b>notice</b>: additionally show recoverable issues that sometimes lead  to  unexpected  behaviour
                     and might be handled by the user.

                     <b>info</b>: additionally show informational messages

                     <b>compare</b>:  additionally  show  messages  to  help  to  debug  file  comparison and (special)
                     attribute handling

                     The log levels below are very verbose and can easily generate  multiple  gigabytes  of  log
                     data  (depending  on  the  number  of  processed  files and the size of the rule tree). For
                     debugging it is recommended to use these log levels together  with  the  <u>--limit</u>  parameter
                     (see aide (1) for details).

                     <b>rule</b>: additionally show messages to help to debug the path rule matching

                     <b>config</b>: additionally show messages to help to debug config and rule parsing

                     <b>debug</b>: additionally show messages that are useful to debug the application

                     <b>limit</b>: additionally show messages about skipped entries due to limit match

                     <b>thread</b>: additionally show messages about thread processing (e.g. broadcast events)

                     <b>trace</b>:  additionallyt  show messages about the internal data structures and the flow of the
                     application (e.g. in-loop logging) (extremely verbose)

       verbose (type: number, range: 0 - 255, default: <b>5</b>, REMOVED in AIDE v0.17)
              Removed, use <b>log_level</b> and <b>report_level</b> options instead.

       gzip_dbout (type: bool, default: <b>false</b>)
              Whether the output to the database is gzipped or not.  This  option  is  available  only  if  zlib
              support is compiled in.

       root_prefix (type: path, default: <b>&lt;empty&gt;</b>, added in AIDE v0.16)
              The  prefix  to strip from each file name in the file system before applying the rules and writing
              to database. AIDE removes a trailing slash from the prefix.  If  there  are  multiple  root_prefix
              lines then the first one is used. This option has no effect in compare mode.

       acl_no_symlink_follow (type: bool, default: <b>false</b>)
              Whether  to  check  ACLs  for  symlinks  or  not.  This option is available only if acl support is
              compiled in.

       warn_dead_symlinks (type: path, default: <b>false</b>)
              Whether to warn about dead symlinks or not.

       config_version (type: string, default: <b>&lt;empty&gt;</b>)
              The value of config_version is printed in the report and also printed to the database. This is for
              informational purposes only. It has no other functionality.

       config_check_warn_unrestricted_rules (type: bool, default: <b>false</b>, added in AIDE v0.18)
              Whether to warn on unrestricted rules during config check. To explicitly define unrestricted rules
              use <b>0</b> (zero) as restriction character.

       num_workers (type: number|percentage, default: <b>1</b>, added in AIDE v0.18)
              Specifies the number of simultaneous workers (threads) for file attribute processing (i.a. hashsum
              calculation).

              The number of workers can be a positive integer (e.g. '4') or  the  percentage  of  the  available
              processors  (e.g.  '60%'). The resulting number of workers is rounded up to the next integer (e.g.
              '60%' of 8 processors results in 5 workers).

              If there are multiple <u>num_workers</u> lines then the first one is used.

              Use 0 (zero) to disable (multi-threaded) workers.

              The default value 1 (single worker thread) may be changed in a future release.

</pre><h4><b>REPORT</b> <b>OPTIONS</b></h4><pre>
       report_url (type: URL, default: <b>stdout</b>)

              The URL that the output is written to.

              Multiple instances of the <b>report_url</b> option are supported.

              <b>Examples:</b>

                 <b>report_url=file:/var/log/aide.log</b>

                    Write report to <u>/var/log/aide.log</u>.

                 <b>report_url=stdout</b>

                    Write report to <u>stdout</u>.

                 <b>report_url=syslog:&lt;LOG_FACILITY&gt;</b>

                    Write report to <u>syslog</u> using <u>LOG_FACILITY</u>.

       The following report options are available (to take effect they have to be set before <b>report_url</b>):

       report_level (type: report level, default: <b>changed_attributes</b>, added in AIDE v0.17)

              The report level to use. The available report levels are as follows:

              <b>minimal</b>: print single line whether AIDE found differences to the database

              <b>summary</b>: additionally print number of added, removed and changed files

              <b>database_attributes</b>: additionally print database checksums

              <b>list_entries</b>: additionally print lists of added, removed and changed entries

              <b>changed_attributes</b>: additionally print details about changed entries

                     <b>Example:</b>

                        File: <a href="file:/var/lib/apt/extended_states">/var/lib/apt/extended_states</a>
                         Perm      : -rw-r--r--                       | -rw-------
                         Uid       : 0                                | 106

                     The left column shows the old value (e.g. from the  <u>database_in</u>  database)  and  the  right
                     column shows the new value (e.g. from the file system).

              <b>added_removed_attributes</b>: additionally print details about added and removed attributes

              <b>added_removed_entries</b>: additionally print details about added and removed entries

       report_format (type: report format, default: <b>plain</b>, added in AIDE v0.18)
              The report format to use. The available report formats are as follows:

              <b>plain</b>: Print report in plain human-readable format.

              <b>json</b>: Print report in json machine-readable format.

       report_base16 (type: bool, default: <b>false</b>, added in AIDE v0.17)
              Base16 encode the checksums in the report. The default is to report checksums in base64 encoding.

       report_detailed_init (type: bool, default: <b>false</b>, added in AIDE v0.16)
              Report   added   files  (report  level  &gt;=  <b>list_entries</b>)  and  their  details  (report  level  &gt;=
              <b>added_removed_entries</b>) in initialization mode.

       report_quiet (type: bool, default: <b>false</b>, added in AIDE v0.16)
              Suppress report output if no differences to the database have been found.

       report_append (type: bool, default: <b>false</b>, added in AIDE v0.17)
              Append to the report URL.

       report_grouped (type: bool, default: <b>true</b>, added in AIDE v0.17)
       grouped (REMOVED in AIDE v0.19)
              Group the files in the report by added, removed and changed files.

       report_summarize_changes (type: bool, default: <b>true</b>, added in AIDE v0.17)
       summarize_changes (REMOVED in AIDE v0.19)
              Summarize changes in the added, removed and changed files sections of the report.

              The general format is like the string YlZbpugamcinHAXSECF, where Y is replaced  by  the  file-type
              ('<b>f</b>' for a regular file, '<b>d</b>' for a directory, '<b>l</b>' for a symbolic link, '<b>c</b>' for a character device,
              '<b>b</b>'  for  a block device, '<b>p</b>' for a FIFO, '<b>s</b>' for a unix socket, '<b>D</b>' for a Solaris door, '<b>P</b>' for a
              Solaris event port, '<b>!</b>' if file type has changed and '<b>?</b>' otherwise).

              The Z is replaced as follows: A '<b>=</b>' means that the size has not changed, a '<b>&lt;</b>' reports a  shrinked
              size  and a '<b>&gt;</b>' reports a grown size.  The other letters in the string are the actual letters that
              will be output if the associated attribute for the item has been changed or a '<b>.</b>' for no change.

              Otherwise a '<b>+</b>' is shown if the attribute has been added, a '<b>-</b>' if it has been removed, a  '<b>:</b>'  if
              the attribute is ignored (but not forced) or a ' ' if the attribute has not been checked.

              The  exceptions  to  this are: (1) a newly created file replaces each letter with a '<b>+</b>', and (2) a
              removed file replaces each letter with a '<b>-</b>'.

              The attribute that is associated with each letter is as follows:

              o      An <b>l</b> means that the link name has changed.

              o      A <b>b</b> means that the block count has changed.

              o      A <b>p</b> means that the permissions have changed.

              o      A <b>u</b> means that the uid has changed.

              o      A <b>g</b> means that the gid has changed.

              o      An <b>a</b> means that the access time has changed.

              o      An <b>m</b> means that the modification time has changed.

              o      A <b>c</b> means that the change time has changed.

              o      An <b>i</b> means that the inode has changed.

              o      An <b>n</b> means that the link count has changed.

              o      An <b>H</b> means that one or more message digests have changed.

              o      An <b>F</b> means that one file system type has changed (Linux only).

              The following letters are only available when explicitly enabled using configure:

              o      An <b>A</b> means that the access control list has changed.

              o      An <b>X</b> means that the extended attributes have changed.

              o      An <b>S</b> means that the SELinux attributes have changed.

              o      An <b>E</b> means that the file attributes on a second extended file system have changed.

              o      A <b>C</b> means that the file capabilities have changed.

       report_ignore_added_attrs (type: attribute expression, default: <b>empty</b>, added in AIDE v0.16)
              Attributes whose addition is to be ignored in the report.

       report_ignore_removed_attrs (type: attribute expression, default: <b>empty</b>, added in AIDE v0.16)
              Attributes whose removal is to be ignored in the report.

       report_ignore_changed_attrs (type: attribute expression, default: <b>empty</b>, added in AIDE v0.16)
       ignore_list (REMOVED in AIDE v0.17)
              Attributes whose change is to be ignored in the report.

       report_force_attrs (type: attribute expression, default: <b>empty</b>, added in AIDE v0.16)
       report_attributes (REMOVED in AIDE v0.17)
              Attributes which are always printed in the report for changed  files.  If  an  attribute  is  both
              ignored and forced the attribute is not considered for file change but printed in the final report
              as long as the file has been otherwise changed.

       report_ignore_e2fsattrs (type: string, default: <b>0</b>, added in AIDE v0.16)
              List  (no delimiter) of ext2 file attributes which are to be ignored in the report.  See <b><a href="../man1/chattr.1.html">chattr</a></b>(1)
              for the available attributes. Use <b>0</b> (zero) to not ignore any  attribute.  Ignored  attributes  are
              represented by a ':' in the report.

              By  default  AIDE  also  reports  changes  of the read-only attributes mentioned in <b><a href="../man1/chattr.1.html">chattr</a></b>(1) (see
              example below how to ignore those changes).

              <b>Example:</b>

                 Ignore changes of the read-only ext2 file attributes  verify  (V),  inline  data  (N),  indexed
                 directory (I) and encrypted (E):

                    report_ignore_e2fsattrs=VNIE

</pre><h4><b>GROUPS</b></h4><pre>
       Groups are aggregations of attributes.

       Group definitions have the format &lt;group name&gt; = &lt;attribute expression&gt;.

       Group names are limited to alphanumeric characters (<b>A-Za-z0-9</b>).

       See ATTRIBUTES for a description of all available attributes.

       <b>Default</b> <b>groups</b>

       <b>R</b>      p+ftype+i+l+n+u+g+s+m+c+sha3_256+X

       <b>L</b>      p+ftype+i+l+n+u+g+X

       <b>&gt;</b>      Growing file p+ftype+l+u+g+i+n+s+growing+X

       <b>H</b>      all compiled in (and not deprecated) hashsums (added in AIDE v0.17)

       <b>X</b>      acl+selinux+xattrs+e2fsattrs+caps (if attributes are compiled in, added in AIDE v0.16)

       <b>E</b>      Empty group

       Use 'aide --version' to list the default compound groups.

</pre><h4><b>RULES</b></h4><pre>
       AIDE supports three types of rules:

       <b>Regular</b> <b>rule:</b>
              &lt;regex&gt; &lt;attribute expression&gt;

              Files and directories matching the regular expression are added to the database.

       <b>Recursive</b> <b>negative</b> <b>rule:</b>
              !&lt;regex&gt;

              Files  and directories matching the regular expression are excluded and NOT added to the database.
              The children of directories and sub-directories are recursed  into  and  only  not  added  to  the
              database if they also match the regular expression.

       <b>Non-recursive</b> <b>negative</b> <b>rule</b> <b>(added</b> <b>in</b> <b>AIDE</b> <b>v0.19)</b>
              -&lt;regex&gt;

              Files and directories matching the regular expression are excluded and NOT added the database. The
              children  of  directories  and  sub-directories  are  not recursed into and hence not added to the
              database by any means.

       <b>Equals</b> <b>rule:</b>
              =&lt;regex&gt; &lt;attribute expression&gt;

              Files and directories matching the regular expression are added to the database.  The children  of
              directories  are  only  added  if  the  regular  expression ends with a "/".  The children of sub-
              directories are not added to the database.

       Every regular expression has to start with an explicit "/".  An implicit ^ is  added  in  front  of  each
       regular  expression.   In  other words, the regular expressions are matched at the first position against
       the complete path.  Special characters can be escaped using two-digit URL encoding (for example,  %20  to
       represent a space).

       AIDE  uses  a deepest-match algorithm to find the tree node to search, but a first-match algorithm inside
       the node.  (see also <b>rule</b> log level).

       See EXAMPLES for examples.

       More in-depth discussion of the selection algorithm can be found in the AIDE manual.

</pre><h4><b>RESTRICTED</b> <b>RULES</b></h4><pre>
       Restricted rules are like normal rules but can be restricted to file types (added in AIDE  v0.16)  and/or
       file system types (added in AIDE v0.19, Linux only).

       The syntax of restricted rules is as follows:

       <b>Restricted</b> <b>regular</b> <b>rule</b>

          &lt;regex&gt; &lt;restriction expression&gt; &lt;attribute expression&gt;

          Files  and  directories  matching both the regular expression and the restriction expression are added
          the database.

       <b>Restricted</b> <b>recursive</b> <b>negative</b> <b>rule</b>

          !&lt;regex&gt; &lt;restriction expression&gt;

          Files and directories matching both the regular expression and the restriction expression are excluded
          and NOT added the database. The children of directories and sub-directories are recursed into and only
          excluded if they also match the regular expression as well as the restriction.

       <b>Restricted</b> <b>non-recursive</b> <b>negative</b> <b>rule</b> <b>(added</b> <b>in</b> <b>AIDE</b> <b>v0.19)</b>

          -&lt;regex&gt; &lt;restriction expression&gt;

          Files and directories matching both the regular expression and the restriction expression are excluded
          and NOT added the database. The children of directories and sub-directories are not recursed into  and
          hence not added to the database by any means.

       <b>Restricted</b> <b>equals</b> <b>rule</b>

          =&lt;regex&gt; &lt;restriction expression&gt; &lt;attribute expression&gt;

          Files  and  directories  matching both the regular expression and the restriction expression are added
          the database. The children of directories are only added if the regular expression ends  with  a  "/".
          The children of sub-directories are not added to the database.

       <b>Restriction</b> <b>expression</b>

          An restriction expression is of the following form:

          &lt;restriction expression&gt;: &lt;file types&gt;
                       | =&lt;file system type&gt;
                       | &lt;file types&gt;=&lt;file system type&gt;

       <b>File</b> <b>types</b>

          The following file types are supported:

             <b>f</b>      restrict rule to regular files

             <b>d</b>      restrict rule to directories

             <b>l</b>      restrict rule to symbolic links

             <b>c</b>      restrict rule to character devices

             <b>b</b>      restrict rule to block devices

             <b>p</b>      restrict rule to FIFO files

             <b>s</b>      restrict rule to UNIX sockets

             <b>D</b>      restrict rule to Solaris doors

             <b>P</b>      restrict rule to Solaris event ports

          Multiple file type restrictions can be given as a comma-separated list.

       <b>File</b> <b>system</b> <b>types</b> <b>(Linux</b> <b>only)</b>

          The file system type restriction can be specified by file system types magic number (e.g. '0x01021994'
          for  tmpfs)  or  by  its name (use 'aide --version' to list the available file system type names). The
          magic number must start with '0x' and be formatted in hexdecimal format.

       <b>Empty</b> <b>restriction</b>

          To explicitly don't restrict a rule use <b>0</b> (added in AIDE v0.18).

       <b>Examples:</b>

          / d,f R

             Only add directories and files to the database.

          <a href="file:/boot/efi">/boot/efi</a>$ d=vfat R

             Only add <b><a href="file:/boot/efi">/boot/efi</a></b> to the database if it is a directory and mounted on <b>vfat</b>.

          !<a href="file:/dev">/dev</a> =0x01021994

             Exclude <b><a href="file:/dev">/dev</a></b> and any children that are mounted on <b>tmpfs</b> (<b>tmpfs</b> magic number: <b>0x01021994</b>).

          -<a href="file:/dev">/dev</a> =tmpfs

             Exclude <b><a href="file:/dev">/dev</a></b> and all children, if <b><a href="file:/dev">/dev</a></b> is mounted on <b>tmpfs</b>.

</pre><h4><b>MACRO</b> <b>LINES</b></h4><pre>
       @@define <b>VAR</b> <b>val</b>
              Define variable <b>VAR</b> to value <b>val</b>.

       @@undef <b>VAR</b>
              Undefine variable <b>VAR</b>.

       @@if <b>boolean_expression</b> (added in AIDE v0.18)
       @@else
       @@endif
              @@if begins an if statement. It must be terminated with an @@endif statement.  The  lines  between
              @@if  and  @@endif  are  used  if the <b>boolean_expression</b> evaluates to <b>true</b>.  If there is an @@else
              statement then the part between @@if and @@else is used if <b>boolean_expression</b>  evaluates  to  <b>true</b>
              otherwise the part between @@else and @@endif is used.

              Available operators and functions in boolean expressions:

                 <b>not</b> <u>boolean_expression</u>
                    Evaluates to true if the <u>boolean_expression</u> is false, and false if the <u>boolean_expression</u> is
                    true.

                 <b>defined</b> <u>VARIABLE</u>

                    Evaluates to <b>true</b> if <u>VARIABLE</u> is defined.

                 <b>hostname</b> <u>HOSTNAME</u>

                    Evaluates  to  <b>true</b>  if <u>HOSTNAME</u> equals the <b>hostname</b> of the machine that AIDE is running on.
                    <b>hostname</b>  is  the  name  of  the  host  without   the   domainname   (ie   'hostname',   not
                    'hostname.example.com').

                 <b>exists</b> <u>PATH</u>

                    Evaluates to <b>true</b> if <u>PATH</u> exists.

                 <u>VERSION_STRING1</u> <b>version_ge</b> <u>VERSION_STRING2</u> (added in AIDE v0.19)

                    Evaluates  to  <b>true</b>  if  <u>VERSION_STRING1</u>  is  greater than or equal to <u>VERSION_STRING2</u> (e.g.
                    0.19.1 <b>version_ge</b> 0.18 evaluates to <b>true</b> and 2.17 <b>version_ge</b>  1.1  to  <b>false</b>).  The  version
                    strings  must  be  in the formaat MAJOR.MINOR.PATCH (minor and patch version can be omitted,
                    any version suffix (e.g. for pre-release) will be truncated).

       @@ifdef <b>VARIABLE</b> (<b>DEPRECATED</b> since AIDE v0.18, will be removed in AIDE v0.20)
              same as <b>@@if</b> <b>defined</b> <b>VARIABLE</b>

       @@ifndef <b>VARIABLE</b> (<b>DEPRECATED</b> since AIDE v0.18, will be removed in AIDE v0.20)
              same as <b>@@if</b> <b>not</b> <b>defined</b> <b>VARIABLE</b>

       @@ifhost <b>HOSTNAME</b> (<b>DEPRECATED</b> since AIDE v0.18, will be removed in AIDE v0.20)
              same as <b>@@if</b> <b>hostname</b> <b>HOSTNAME</b>

       @@ifnhost <b>HOSTNAME</b> (<b>DEPRECATED</b> since AIDE v0.18, will be removed in AIDE v0.20)
              same as <b>@@if</b> <b>not</b> <b>hostname</b> <b>HOSTNAME</b>

       @@{<b>VAR</b>}
              @@{<b>VAR</b>} is replaced with the value of the variable <b>VAR</b>.  If variable <b>VAR</b> is not defined  an  empty
              string is used.

              Variables are supported in strings and in regular expressions of rules.

              Pre-defined marco variables:

                 <b>@@{AIDE_VERSION}</b>: the version of AIDE

                 <b>@@{HOSTNAME}</b>: the hostname of the current system

       @@include <b>FILE</b>
              Include <b>FILE</b>.

              The content of the file is used as if it were inserted in this part of the config file.

              The maximum depth of nested includes is 16.

       @@include <b>DIRECTORY</b> <b>REGEX</b> [<b>RULE_PREFIX</b>] (added in AIDE v0.17)
              Include  all (regular) files found in <b>DIRECTORY</b> matching regular expression <b>REGEX</b> (sub-directories
              are ignored). The file are included in lexical sort order.

              If <b>RULE_PREFIX</b> (added in AIDE v0.18) is set, all rules included by the statement are prefixed with
              given <b>RULE_PREFIX</b>. Prefixes from nested include statements are concatenated.

              The content of the files is used as if it were inserted in this part of the config file.

       @@x_include <b>FILE</b> (added in AIDE v0.17)
       @@x_include <b>DIRECTORY</b> <b>REGEX</b> [<b>RULE_PREFIX</b>]  (added in AIDE v0.17)
              <b>@x_include</b> is identical to <b>@@include</b>, except that if a config file is executable is is run and the
              output is used as config.

              If the executable file exits with status greater than zero or writes to stderr aide stops with  an
              error.

              For  security  reasons <b>DIRECTORY</b> and each executable config file must be owned by the current user
              or root. They must not be group- or world-writable.

       @@x_include_setenv <b>VAR</b> <b>VALUE</b> (added in AIDE v0.17)

              Adds the variable <b>VAR</b> with the value <b>VALUE</b> to the environment used for config file execution.

              Environment variable names are limited to alphanumeric characters (<b>A-Za-z0-9</b>) and  the  underscore
              '<b>_</b>' and must not begin with a digit.

</pre><h4><b>TYPES</b></h4><pre>
       <b>bool</b>
          Valid values are <b>yes</b>, <b>true</b>, <b>no</b> or <b>false</b>.

       <b>attribute</b> <b>expression</b>

          An attribute expression is of the following form:

                 &lt;attribute expression&gt;: &lt;attribute/group&gt;
                       | &lt;attribute expression&gt; + &lt;attribute/group&gt;
                       | &lt;attribute expression&gt; - &lt;attribute/group&gt;

       <b>URLS</b>
          Urls can be one of the following. Input urls cannot be used as outputs and vice versa.

                 stdout

                 stderr Output is sent to stdout, stderr respectively.

                 stdin  Input is read from stdin.

                 file:/<b>path</b>
                        Input is read from <b>path</b> or output is written to <b>path</b>.

                 fd:<b>number</b>
                        Input is read from filedescriptor <b>number</b> or output is written to <b>number</b>.

                 syslog:<b>LOG_FACILITY</b>
                        Output is written to syslog using <u>LOG_FACILITY</u>.

</pre><h4><b>ATTRIBUTES</b></h4><pre>
       <b>File</b> <b>attributes</b>

       <b>ftype</b>  file type (added in AIDE v0.15)

       <b>fstype</b> file system type (Linux-only, added in AIDE v0.19)

       <b>p</b>      permissions

       <b>i</b>      inode

       <b>l</b>      link name (symbolic links only)

       <b>n</b>      number of links

       <b>u</b>      user

       <b>g</b>      group

       <b>s</b>      size

       <b>b</b>      block count

       <b>m</b>      mtime

       <b>a</b>      atime

       <b>c</b>      ctime

       <b>acl</b>    access control list (requires <u>libacl</u>, Linux-only)

       <b>selinux</b>
              selinux attributes (requires <u>libselinux</u>, Linux-only)

       <b>xattrs</b> extended attributes (requires <u>libattr</u>, Linux-only)

       <b>e2fsattrs</b>
              file  attributes  on  a  Linux  file  system,  see also  <b>report_ignore_e2fsattrs</b>  option (requires
              <u>libext2fs</u>, added in AIDE v0.15)

       <b>caps</b>   file capabilities (regular files only) (requires <u>libcap</u>, Linux-only, added in AIDE v0.17)

       Use 'aide --version' to show which compiled-in attributes are available.

       <b>Special</b> <b>attributes</b>

       <b>S</b>      check for growing size (<b>DEPRECATED</b> since AIDE v0.18, will be removed in AIDE v0.20)

              Use <b>growing+s</b> attributes instead

       <b>I</b>      ignore changed filename

              When <b>I</b> is used, the inode of the new file is used to search for a moved source  file  in  the  old
              database.

              Source and target file have to be located in the same directory and must share the same attributes
              (except for special attributes <b>ANF</b>, <b>ARF</b>, <b>I</b>, <b>growing</b>, and <b>compressed</b>).

              For moved entries a change of the <b>ctime</b> attribute is ignored.

       <b>growing</b>
              ignore growing file (added in AIDE v0.18)

              When <b>growing</b> is used, changes of the following attributes are ignored:

              <b>size</b>: if new size is greater than old size

              <b>bcount</b>: if new bcount is greater than old bcount

              <b>atime</b>: if new atime is greater than old atime

              <b>mtime</b>: if new mtime is greater than old mtime

              <b>ctime</b>: if new ctime is greater than old ctime

              <b>hashsums</b>: if the hashsum of the new file restricted to the old size equals the hashsums of the old
              file

              For hashsum attributes the <b>growing</b> attribute is ignored in compare mode.

       <b>compressed</b>
              ignore compressed file (added in AIDE v0.18)

              When  <b>compressed</b>  is  used,  the  uncompressed  hashsums  of  the  new  compressed file (supported
              compressions: <b>gzip</b>) are used to search for the uncompressed file in the old database.

              The old uncompressed and the new compressed file have to be located in the same directory and must
              share the same attributes (except for special attributes <b>ANF</b>, <b>ARF</b>,  <b>I</b>,  <b>growing</b>,  and  <b>compressed</b>)
              including at least one common hashsum.

              Changes of the <b>inode</b>, <b>size</b>, <b>bcount</b> and <b>ctime</b> attributes are ignored.

              The  <b>growing</b>  attribute (i.e. the old file size) is not considered for compressed files during the
              calculation of the uncompressed hashsums.

              The <b>compressed</b> attribute is ignored in compare mode.

       <b>ANF</b>    allow new files

              When 'ANF' is used, new files are added to the new database, but are ignored in the report.

       <b>ARF</b>    allow removed files

              When 'ARF' is used, files missing on disk are omitted from the new database, but  are  ignored  in
              the report.

       <b>Hashsums</b> <b>attributes</b> <b>(regular</b> <b>files</b> <b>only)</b>

          <b>sha256</b> SHA-256 checksum

          <b>sha512</b> SHA-512 checksum

          <b>sha512_256</b> (added in AIDE v0.19)
                 SHA-512 checksum truncated to 256 output bits

          <b>sha3_256</b> (added in AIDE v0.19)
                 SHA3-256 checksum

          <b>sha3_512</b> (added in AIDE v0.19)
                 SHA3-512 checksum

          <b>stribog256</b> (added in AIDE v0.17)
                 GOST R 34.11-2012, 256 bit checksum

          <b>stribog512</b> (added in AIDE v0.17)
                 GOST R 34.11-2012, 512 bit checksum

          md5 (<b>DEPRECATED</b> since AIDE v0.19, will be removed in AIDE v0.21)
                 MD5 checksum (not in <u>libgcrypt</u> FIPS mode)

          sha1 (<b>DEPRECATED</b> since AIDE v0.19, will be removed in AIDE v0.21)
                 SHA-1 checksum

          rmd160 (<b>DEPRECATED</b> since AIDE v0.19, will be removed in AIDE v0.21)
                 RIPEMD-160 checksum

          gost (<b>DEPRECATED</b> since AIDE v0.19, will be removed in AIDE v0.21)
                 GOST R 34.11-94 checksum

          crc32 (<b>REMOVED</b> in AIDE v0.19)
                 crc32 checksum

          crc32b (<b>REMOVED</b> in AIDE v0.19)
                 crc32 checksum

          haval (<b>REMOVED</b> in AIDE v0.19)
                 haval256 checksum

          tiger (<b>REMOVED</b> in AIDE v0.19)
                 tiger checksum

          whirlpool (<b>REMOVED</b> in AIDE v0.19)
                 whirlpool checksum

          Use 'aide --version' to show which hashsums are available.

          <b>Hashsum</b> <b>transitions</b> <b>(since</b> <b>AIDE</b> <b>v0.19):</b>

          AIDE  has  limited support for hashsum transitions (i.e. ensuring hashsum validation when hashsums are
          added/removed from existing entries). If both the old and the new entry do mot share common hashsum(s)
          AIDE tries to additionally  calculate  the  removed  hashsum(s)  also  for  the  new  entry  (this  is
          especieally not supported for moved (<b>I</b> attribute) and compressed (<b>compressed</b> attribute) entries).

</pre><h4><b>EXAMPLES</b></h4><pre>
       <b>/</b> <b>R</b>    This  adds  all  files  on  your  machine  to  the  database.   This one line is a fully qualified
              configuration file.

       <b>!<a href="file:/dev">/dev</a>$</b> This ignores the <a href="file:/dev">/dev</a> directory structure.

       <b>=/foo</b> <b>R</b>
              Only /foo and /foobar are taken into the database.  None of their children are added.

       <b>=/foo/</b> <b>R</b>
              Only /foo and its children (e.g. /foo/file and /foo/directory) are taken into the  database.   The
              children of sub-directories (e.g. /foo/directory/bar) are not added.

       <b>/</b> <b>d,f</b> <b>R</b>
              Only add directories and files to the database

       <b>!<a href="file:/run">/run</a></b> <b>d</b>
       <b><a href="file:/run">/run</a></b> <b>R</b> Add all but directory entries to the database

       <b><a href="file:/run">/run</a></b> <b>d</b> <b>R-m-c-i</b>
       <b><a href="file:/run">/run</a></b> <b>R</b> Use specific rule for directories

       Suggested Groups

       <b>OwnerMode</b> = p+u+g+ftype
              Check permissions, owner, group and file type

       <b>Size</b> = s+b
              Check size and block count

       <b>InodeData</b> = OwnerMode+n+i+Size+l+X
       <b>StaticFile</b> = m+c+Checksums
              Files that stay static

       <b>Full</b> = InodeData+StaticFile
       <b>Full</b> = ftype+p+l+u+g+s+m+c+a+i+b+n+H+X
       <b>/</b> <b>0</b> <b>Full</b>
              This  line  defines  group  <b>Full</b>.   It  has  all  attributes, all compiled in hashsums (<b>H</b>) and all
              compiled in extra file attributes (<b>X</b>).  See '--version' output for the compiled  in  hashsums  and
              extra groups.  The example rule is the typical catch-all rule at the end of the rule list.

       <b>VarTime</b> = InodeData+Checksums
       <b>/etc/ssl/certs/ca-certificates\\.crt$</b> <b>VarTime</b>
              Files that change their mtimes or ctimes but not their contents.

       <b>VarInode</b> = VarTime-i
       <b>/var/lib/nfs/etab$</b> <b>f</b> <b>VarInode</b>
              Files that are recreated regularly but do not change their contents

       <b>VarFile</b> = OwnerMode+n+l+X
       <b>/etc/resolv\\.conf$</b> <b>f</b> <b>VarFile</b>
              Files that change their contents during system operation

       <b>VarDir</b> = OwnerMode+n+i+X
       <b>/var/lib/snmp$</b> <b>d</b> <b>VarDir</b>
              Directories that change their contents during system operation

       <b>RecreatedDir</b> = OwnerMode+n+X
       <b>/run/samba$</b> <b>d</b> <b>RecreatedDir</b>
              Directories that are recreated regularly and change their contents

       Log Handling

       Logs  pose  a number of special challenges to AIDE.  An active log is nearly constantly being written to.
       The process of log rotation changes file names for files that are supposed to  have  unaltered  contents.
       To save space, Logs are compressed in the process of their rotation, and finally, they get deleted.  AIDE
       is  supposed  to  handle all those cases without generating reports, and it is still expected to flag the
       cases when an attacker tampers with logs.

       The following examples suggest a way to handle the common case of  log  rotation  with  the  <a href="../man8/logrotate.8.html">logrotate</a>(8)
       program,  with its options <b>compress</b>, <b>delaycompress</b> and <b>nocopytruncate</b> set.  The vast majority of logs are
       rotated this way on most Linux systems.

       <b>ActLog</b>=Full+growing+ANF+I
       <b>/var/log/foo\\.log$</b> <b>f</b> <b>ActLog</b>
              An Active Log is typically named foo.log.  It is  constanty  being  written  to.   The  file  does
              neither change its mode nor its inode number.  The size only increases, and what is written to the
              file  is  not  supposed to change (growing).  During log rotation, foo.log is typically renamed to
              foo.log.1 (or foo.log.0) and the process is instructed to write to a new foo.log.  Log content  is
              written  to  a  new  file  (ANF)  and  will  eventually  be renamed to foo.log.1 (I).  The growing
              attribute suppresses reports for files that  just  had  content  appended  when  compared  to  the
              database.  A change of the old content is still reported!

       <b>RotLog</b>=Full
       <b>/var/log/foo\\.log\\.1$</b> <b>f</b> <b>RotLog</b>
              foo.log.0  or  foo.log.1 is called the Rotated Log, the previously active log renamed to the first
              name of the Log Series that is formed by the rotation mechanism.  Right after rotation,  the  file
              might  still  being  written  to  by  the  daemon.  To aide, this looks like the Active Log's size
              decreases and its inode and timestamps change.  The Rotated Log is  not  supposed  to  change  its
              attributes  once  the  process has stopped writing to it.  Reports might be generated if aide runs
              while the process still writes to the Rotated Log, but this is quite unlikely to happen.  Some log
              rotation mechanisms rename  foo.log  to  foo.log.0  to  foo.log.1.gz,  others  rename  foo.log  to
              foo.log.1 to foo.2.log.gz.

       <b>CompSerLog</b>=Full+I+compressed
       <b>/var/log/foo\\.log\\.2\\.gz$</b> <b>f</b> <b>CompSerLog</b>
              In  the next rotation step, foo.log.1 gets compressed to foo.log.2.gz, becoming the Compressed Log
              in the Log Series.  With this rule, AIDE does not report this step  because  it  uncompresses  the
              contents  of  the  file and takes the checksum of the uncompressed content.  The contents strictly
              doesn't change, but some attribute changes are ignored (compressed).

       <b>MidlSerLog</b>=Full+I
       <b>/var/log/foo\\.log\\.[345]\\.gz$</b> <b>f</b> <b>MidlSerLog</b>
              In the next log rotation, all foo.log.{x} get renamed to foo.log.{x+1}.  The other attributes  are
              not supposed to change.

       <b>LastSerLog</b>=Full+ARF
       <b>/var/log/foo\\.log\\.6\\.gz$</b> <b>f</b> <b>LastSerLog</b>
              The  configuration  of the log rotation process specifies a number of log generations to keep. The
              last log in the series is therefore removed from the disk (ARF).

       aide 0.18 does not yet support the following cases of log rotation:

       <b>empty</b> <b>files</b>
              It might be the case that a log is actually created, but never written to.  This commonly  happens
              on  rarely  used  web  servers  that use the log rotation as a method to cater for data protection
              regulation.  In result, all files in a series are identical, breaking  the  heuristics  that  aide
              uses  to  detect  log  rotation.   A  possible  workaround  is to begin a newly rotated log with a
              timestamp.  With logrotate, this can be done in a postrotate scriptlet.

       <b>nodelaycompress</b>
              With logrotate's <b>nodelaycompress</b> option, a log is immediately compressed after  renaming  it  from
              the Active Log name.  For the time being, it is recommended to always use the <b>delaycompress</b> option
              to avoid this behavior.

       <b>copytruncate</b>
              With  logrotate's  <b>copytruncate</b> option, the Active Log is not renamed and newly created but copied
              to the new file name.  After the copy operation, the old file is truncated to zero size,  allowing
              the  daemon  to continuously write to the already open file handle.  aide uses the Inode number to
              detect the rotation process.  That doesn't work with <b>copytruncate</b> because the Inode stays with the
              Active Log.  For the time being, it is recommended to avoid the <b>copytruncate</b> option to avoid  this
              behavior.

</pre><h4><b>HINTS</b></h4><pre>
       In the following, the first is not allowed in AIDE. Use the latter instead.

              <b>/foo</b> <b>epug</b>

              <b>/foo</b> <b>e+p+u+g</b>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/aide.1.html">aide</a></b>(1)

</pre><h4><b>DISCLAIMER</b></h4><pre>
       All  trademarks  are  the  property of their respective owners.  No animals were harmed while making this
       webpage or this piece of software.

aide v0.19.1                                       2025-07-06                                       <u><a href="../man5/AIDE.CONF.5.html">AIDE.CONF</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>