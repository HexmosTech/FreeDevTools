<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dtrace_audit — A DTrace provider for tracing audit(4) events</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dtrace_audit — A DTrace provider for tracing <u><a href="../man4/audit.4.html">audit</a></u>(4) events

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>audit:event:aue_*:commit</b>(<u>char</u> <u>*eventname</u>, <u>struct</u> <u>audit_record</u> <u>*ar</u>);

       <b>audit:event:aue_*:bsm</b>(<u>char</u> <u>*eventname</u>, <u>struct</u> <u>audit_record</u> <u>*ar</u>, <u>const</u> <u>void</u> <u>*</u>, <u>size_t</u>);

       To compile this module into the kernel, place the following in your kernel configuration file:

             <b>options</b> <b>DTAUDIT</b>

       Alternatively, to load the module at boot time, place the following line in <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             dtaudit_load="YES"

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  DTrace  <b>dtaudit</b>  provider  allows  users  to trace events in the kernel security auditing subsystem,
       <u><a href="../man4/audit.4.html">audit</a></u>(4).  <u><a href="../man4/audit.4.html">audit</a></u>(4) provides detailed logging of a configurable set of  security-relevant  system  calls,
       including  key  arguments  (such as file paths) and return values that are copied race-free as the system
       call proceeds.  The <b>dtaudit</b> provider allows DTrace scripts to selectively enable  in-kernel  audit-record
       capture  for  system  calls,  and  then access those records in either the in-kernel format or BSM format
       (<u><a href="../man5/audit.log.5.html">audit.log</a></u>(5)) when the system call completes.  While  the  in-kernel  audit  record  data  structure  is
       subject  to  change  as  the  kernel changes over time, it is a much more friendly interface for use in D
       scripts than either those available via the DTrace system-call provider or the BSM trail itself.

   <b>Configuration</b>
       The <b>dtaudit</b> provider relies on <u><a href="../man4/audit.4.html">audit</a></u>(4) being compiled into the kernel.  <b>dtaudit</b> probes become  available
       only  once  there  is an event-to-name mapping installed in the kernel, normally done by <u><a href="../man8/auditd.8.html">auditd</a></u>(8) during
       the boot process, if audit is enabled in <u><a href="../man5/rc.conf.5.html">rc.conf</a></u>(5):

             auditd_enable="YES"

       If <b>dtaudit</b> probes are required earlier in boot -- for example, in single-user mode -- or without enabling
       <u><a href="../man4/audit.4.html">audit</a></u>(4), they can be preloaded in the boot loader by adding this line to <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5).

             audit_event_load="YES"

   <b>Probes</b>
       The <b>audit:event:aue_*:commit</b>() probes fire synchronously during system-call return, giving access to  two
       arguments:  a <u>char</u> <u>*</u> audit event name, and the <u>struct</u> <u>audit_record</u> <u>*</u> in-kernel audit record.  Because the
       probe fires in system-call return,  the  user  thread  has  not  yet  regained  control,  and  additional
       information from the thread and process remains available for capture by the script.

       The  <b>audit:event:aue_*:bsm</b>()  probes fire asynchonously from system-call return, following BSM conversion
       and just prior to being written to disk, giving access to four arguments: a <u>char</u> <u>*</u> audit event name,  the
       <u>struct</u>  <u>audit_record</u>  <u>*</u> in-kernel audit record, a <u>const</u> <u>void</u> <u>*</u> pointer to the converted BSM record, and a
       <u>size_t</u> for the length of the BSM record.

</pre><h4><b>IMPLEMENTATION</b> <b>NOTES</b></h4><pre>
       When a set of <b>dtaudit</b> probes are registered, corresponding in-kernel audit records will be  captured  and
       their probes will fire regardless of whether the <u><a href="../man4/audit.4.html">audit</a></u>(4) subsystem itself would have captured the record
       for  the  purposes  of writing it to the audit trail, or for delivery to a <u><a href="../man4/auditpipe.4.html">auditpipe</a></u>(4).  In-kernel audit
       records allocated only because of enabled <u><a href="../man4/dtaudit.4.html">dtaudit</a></u>(4) probes will not  be  unnecessarily  written  to  the
       audit trail or enabled pipes.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/dtrace.1.html">dtrace</a></u>(1), <u><a href="../man4/audit.4.html">audit</a></u>(4), <u><a href="../man5/audit.log.5.html">audit.log</a></u>(5), <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5), <u><a href="../man5/rc.conf.5.html">rc.conf</a></u>(5), <u><a href="../man8/auditd.8.html">auditd</a></u>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>dtaudit</b> provider first appeared in FreeBSD 12.0.

</pre><h4><b>AUTHORS</b></h4><pre>
       This  software  and  this manual page were developed by BAE Systems, the University of Cambridge Computer
       Laboratory, and Memorial University under DARPA/AFRL contract (FA8650-15-C-7558) (“CADETS”), as  part  of
       the  DARPA  Transparent  Computing (TC) research program.  The <b>dtaudit</b> provider and this manual page were
       written by Robert Watson &lt;<u><a href="mailto:rwatson@FreeBSD.org">rwatson@FreeBSD.org</a></u>&gt;.

</pre><h4><b>BUGS</b></h4><pre>
       Because <u><a href="../man4/audit.4.html">audit</a></u>(4) maintains its primary event-to-name mapping database in userspace, that database must be
       loaded into the kernel before <b>dtaudit</b> probes become available.

       <b>dtaudit</b> is only able to provide access to system-call audit events,  not  the  full  scope  of  userspace
       events, such as those relating to login, password change, and so on.

Debian                                           April 28, 2019                                  <u><a href="../man4/DTRACE_AUDIT.4.html">DTRACE_AUDIT</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>