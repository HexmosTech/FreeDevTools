<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dtrace_ip — a DTrace provider for tracing events related to the IPv4 and IPv6 protocols</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dtrace_ip — a DTrace provider for tracing events related to the IPv4 and IPv6 protocols

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>ip:::receive</b>(<u>pktinfo_t</u> <u>*</u>, <u>csinfo_t</u> <u>*</u>, <u>ipinfo_t</u> <u>*</u>, <u>ifinfo_t</u> <u>*</u>, <u>ipv4info_t</u> <u>*</u>, <u>ipv6info_t</u> <u>*</u>);

       <b>ip:::send</b>(<u>pktinfo_t</u> <u>*</u>, <u>csinfo_t</u> <u>*</u>, <u>ipinfo_t</u> <u>*</u>, <u>ifinfo_t</u> <u>*</u>, <u>ipv4info_t</u> <u>*</u>, <u>ipv6info_t</u> <u>*</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  DTrace  <b>ip</b>  provider  allows users to trace events in the <u><a href="../man4/ip.4.html">ip</a></u>(4) and <u><a href="../man4/ip6.4.html">ip6</a></u>(4) protocol implementations.
       The <b>ip:::send</b>() probe fires whenever the kernel prepares to transmit an IP packet, and the <b>ip:::receive</b>()
       probe fires whenever the kernel receives an IP packet.  The arguments to these  probes  can  be  used  to
       obtain  detailed  information  about  the  IP headers of the corresponding packet, as well as the network
       interface on which the  packet  was  sent  or  received.   Unlike  the  <u><a href="../man4/dtrace_tcp.4.html">dtrace_tcp</a></u>(4)  and  <u><a href="../man4/dtrace_udp.4.html">dtrace_udp</a></u>(4)
       providers,  <b>ip</b>  provider  probes  are  triggered  by forwarded packets.  That is, the probes will fire on
       packets that are not destined to the local host.

</pre><h4><b>ARGUMENTS</b></h4><pre>
       The <u>pktinfo_t</u>  argument  is  currently  unimplemented  and  is  included  for  compatibility  with  other
       implementations of this provider.  Its fields are:

             <u>uintptr_t</u> <u>pkt_addr</u>  Always set to 0.

       The  <u>csinfo_t</u>  argument  is  currently  unimplemented  and  is  included  for  compatibility  with  other
       implementations of this provider.  Its fields are:

             <u>uintptr_t</u> <u>cs_addr</u>  Always set to 0.

             <u>uint64_t</u> <u>cs_cid</u>    A pointer to the <u>struct</u> <u>inpcb</u> for this packet, or NULL.

             <u>pid_t</u> <u>cs_pid</u>       Always set to 0.

       The <u>ipinfo_t</u> argument contains IP fields common to both IPv4 and IPv6 packets.  Its fields are:

             <u>uint8_t</u> <u>ip_ver</u>       IP version of the packet, 4 for IPv4 packets and 6 for IPv6 packets.

             <u>uint32_t</u> <u>ip_plength</u>  IP payload size.  This does not include the size of  the  IP  header  or  IPv6
                                  option headers.

             <u>string</u> <u>ip_saddr</u>      IP source address.

             <u>string</u> <u>ip_daddr</u>      IP destination address.

       The  <u>ifinfo_t</u>  argument  describes the outgoing and incoming interfaces for the packet in the <b>ip:::send</b>()
       and <b>ip:::receive</b>() probes respectively.  Its fields are:

             <u>string</u> <u>if_name</u>     The interface name.

             <u>int8_t</u> <u>if_local</u>    A boolean value indicating whether or not the interface is a loopback interface.

             <u>uintptr_t</u> <u>if_addr</u>  A pointer to the <u>struct</u> <u>ifnet</u> which describes the interface.  See  the  <u><a href="../man9/ifnet.9.html">ifnet</a></u>(9)
                                manual page.

       The <u>ipv4info_t</u> argument contains the fields of the IP header for IPv4 packets.  This argument is NULL for
       IPv6 packets.  DTrace scripts should use the <b>ip_ver</b>() field in the <u>ipinfo_t</u> argument to determine whether
       to use this argument.  Its fields are:

             <u>uint8_t</u> <u>ipv4_ver</u>        IP version.  This will always be 4 for IPv4 packets.

             <u>uint8_t</u> <u>ipv4_ihl</u>        The IP header length, including options, in 32-bit words.

             <u>uint8_t</u> <u>ipv4_tos</u>        IP type of service field.

             <u>uint16_t</u> <u>ipv4_length</u>    The total packet length, including the header, in bytes.

             <u>uint16_t</u> <u>ipv4_ident</u>     Identification field.

             <u>uint8_t</u> <u>ipv4_flags</u>      The IP flags.

             <u>uint16_t</u> <u>ipv4_offset</u>    The fragment offset of the packet.

             <u>uint8_t</u> <u>ipv4_ttl</u>        Time to live field.

             <u>uint8_t</u> <u>ipv4_protocol</u>   Next-level protocol ID.

             <u>string</u> <u>ipv4_protostr</u>    A  string  containing  the name of the encapsulated protocol.  The protocol
                                     strings are defined in the <u>protocol</u> array in <u>/usr/lib/dtrace/ip.d</u>

             <u>uint16_t</u> <u>ipv4_checksum</u>  The IP checksum.

             <u>ipaddr_t</u> <u>ipv4_src</u>       IPv4 source address.

             <u>ipaddr_t</u> <u>ipv4_dst</u>       IPv4 destination address.

             <u>string</u> <u>ipv4_saddr</u>       A string representation of the source address.

             <u>string</u> <u>ipv4_daddr</u>       A string representation of the destination address.

             <u>ipha_t</u> <u>*ipv4_hdr</u>        A pointer to the raw IPv4 header.

       The <u>ipv6info_t</u> argument contains the fields of the IP header for IPv6 packets.  Its fields  are  not  set
       for IPv4 packets; as with the <u>ipv4info_t</u> argument, the <b>ip_ver</b>() field should be used to determine whether
       this argument is valid.  Its fields are:

             <u>uint8_t</u> <u>ipv6_ver</u>        IP version.  This will always be 6 for IPv6 packets.

             <u>uint8_t</u> <u>ipv6_tclass</u>     The  traffic  class,  used to set the differentiated services codepoint and
                                     extended congestion notification flags.

             <u>uint32_t</u> <u>ipv6_flow</u>      The flow label of the packet.

             <u>uint16_t</u> <u>ipv6_plen</u>      The IP payload size, including extension headers, in bytes.

             <u>uint8_t</u> <u>ipv6_nexthdr</u>    An identifier for the type of the next header.

             <u>string</u> <u>ipv6_nextstr</u>     A string representation of the type of the next header.

             <u>uint8_t</u> <u>ipv6_hlim</u>       The hop limit.

             <u>ip6_addr_t</u> <u>*ipv6_src</u>    IPv6 source address.

             <u>ip6_addr_t</u> <u>*ipv6_dst</u>    IPv6 destination address.

             <u>string</u> <u>ipv6_saddr</u>       A string representation of the source address.

             <u>string</u> <u>ipv6_daddr</u>       A string representation of the destination address.

             <u>struct</u> <u>ip6_hdr</u> <u>*ipv6_hdr</u>
                                     A pointer to the raw IPv6 header.

</pre><h4><b>FILES</b></h4><pre>
       <u>/usr/lib/dtrace/ip.d</u>  DTrace type and translator definitions for the <b>ip</b> provider.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following script counts received packets by remote host address.

             ip:::receive
             {
                     @num[args[2]-&gt;ip_saddr] = count();
             }

       This script will print some details of each IP packet as it is sent or received by the kernel:

             #pragma D option quiet
             #pragma D option switchrate=10Hz

             dtrace:::BEGIN
             {
                     printf(" %10s %30s    %-30s %8s %6s\n", "DELTA(us)", "SOURCE",
                         "DEST", "INT", "BYTES");
                     last = timestamp;
             }

             ip:::send
             {
                     this-&gt;elapsed = (timestamp - last) / 1000;
                     printf(" %10d %30s -&gt; %-30s %8s %6d\n", this-&gt;elapsed,
                         args[2]-&gt;ip_saddr, args[2]-&gt;ip_daddr, args[3]-&gt;if_name,
                         args[2]-&gt;ip_plength);
                     last = timestamp;
             }

             ip:::receive
             {
                     this-&gt;elapsed = (timestamp - last) / 1000;
                     printf(" %10d %30s &lt;- %-30s %8s %6d\n", this-&gt;elapsed,
                         args[2]-&gt;ip_daddr, args[2]-&gt;ip_saddr, args[3]-&gt;if_name,
                         args[2]-&gt;ip_plength);
                     last = timestamp;
             }

</pre><h4><b>COMPATIBILITY</b></h4><pre>
       This provider is compatible with the <b>ip</b> providers found in Solaris and Darwin.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/dtrace.1.html">dtrace</a></u>(1), <u><a href="../man4/dtrace_tcp.4.html">dtrace_tcp</a></u>(4), <u><a href="../man4/dtrace_udp.4.html">dtrace_udp</a></u>(4), <u><a href="../man4/ip.4.html">ip</a></u>(4), <u><a href="../man4/ip6.4.html">ip6</a></u>(4), <u><a href="../man9/ifnet.9.html">ifnet</a></u>(9), <u><a href="../man9/SDT.9.html">SDT</a></u>(9)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>ip</b> provider first appeared in FreeBSD 10.0.

</pre><h4><b>AUTHORS</b></h4><pre>
       This manual page was written by Mark Johnston &lt;<u><a href="mailto:markj@FreeBSD.org">markj@FreeBSD.org</a></u>&gt;.

Debian                                         September 14, 2015                                   <u><a href="../man4/DTRACE_IP.4.html">DTRACE_IP</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>