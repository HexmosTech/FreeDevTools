<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mk48txx — Mostek time-of-day clock driver</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mk48txx — Mostek time-of-day clock driver

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/eventhandler.h&gt;</b>
       <b>#include</b> <b>&lt;sys/lock.h&gt;</b>
       <b>#include</b> <b>&lt;sys/mutex.h&gt;</b>
       <b>#include</b> <b>&lt;dev/mk48txx/mk48txxvar.h&gt;</b>

       To compile this driver into the kernel, place the following line in your kernel configuration file:

             <b>device</b> <b>mk48txx</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>mk48txx</b>  driver  is  a  back-end  for several models of Mostek time-of-day clock chips.  It provides
       access methods to retrieve and set date and time for use with the “<b>clock</b>” KOBJ interface.

       To tie an instance of this device to the system, use the <b>mk48txx_attach</b>() function and the  mk48txx_softc
       structure defined as follows:

       <u>int</u> <b>mk48txx_attach</b>(<u>device_t</u> <u>dev</u>)

       typedef uint8_t (*mk48txx_nvrd_t)(device_t dev, int off);
       typedef void (*mk48txx_nvwr_t)(device_t dev, int off, uint8_t v);

       struct mk48txx_softc {
               struct resource sc_res;
               struct mtx      sc_mtx;
               eventhandler_tag        sc_wet;
               const char      *sc_model;
               bus_size_t      sc_nvramsz;
               bus_size_t      sc_clkoffset;
               u_int           sc_year0;
               u_int           sc_flag;
               mk48txx_nvrd_t  sc_nvrd;
               mk48txx_nvwr_t  sc_nvwr;
       };

       <u>sc_res</u>  The  bus  resource  used  for  accessing  the  chip's  non-volatile  memory  (including the clock
               registers), which must be supplied by the front-end when using the default  access  methods  (see
               below).  Otherwise this member is optional.

       <u>sc_mtx</u>  The  hardware  mutex  used  when  accessing  the  chip's non-volatile memory (including the clock
               registers), which must be initialized with MTX_DEF by the front-end.

       <u>sc_wet</u>  The event handler tag for the watchdog functionality, which is registered by the <b>mk48txx_attach</b>()
               function if supported by the chip and specified as part of the  machine-dependent  features  (see
               below).

       <u>sc_model</u>
               The  chip  model  which this instance should serve.  This member must be set to one of “mk48t02”,
               “mk48t08”, “mk48t18”, or “mk48t59” by the front-end.

       <u>sc_nvramsz</u>
               The size of the non-volatile RAM in the  Mostek  chip,  which  is  set  by  the  <b>mk48txx_attach</b>()
               function.

       <u>sc_clkoffset</u>
               The  offset  into  the control registers of the Mostek chip, which is set by the <b>mk48txx_attach</b>()
               function.

       <u>sc_year0</u>
               The year offset to be used with the ‘year’ counter of the clock, which must be set by the  front-
               end.   This value is generally dependent on the system configuration in which the clock device is
               mounted.  For instance, on Sun Microsystems machines the convention is to have clock's  two-digit
               year represent the year since 1968.

       <u>sc_flag</u>
               This flag is used to specify machine-dependent features.  The following flags are supported:

               MK48TXX_NO_CENT_ADJUST   If  the resulting date retrieved with the “<b>clock_gettime()</b> <b>method</b>” would
                                        be earlier than January 1, 1970, the driver will assume that the  chip's
                                        year  counter  actually  represents  a  year  in the 21st century.  This
                                        behavior can be overridden  by  setting  this  flag,  which  causes  the
                                        <b>mk48txx</b> driver to respect the clock's century bit instead.

               MK48TXX_WDOG_REGISTER    When  this  flag  is set, the <b>mk48txx</b> driver will register as a watchdog
                                        via the interface defined in <u><a href="../man9/watchdog.9.html">watchdog</a></u>(9) if supported  by  the  specific
                                        chip model.

               MK48TXX_WDOG_ENABLE_WDS  When this flag is set, the <b>mk48txx</b> driver will set the watchdog steering
                                        (WDS) bit when enabling the watchdog functionality of the chip.  enabled
                                        (see  the  chip  documentation for further information regarding the WDS
                                        bit).

       <u>sc_nvread</u>

       <u>sc_nvwrite</u>
               These members specify the access methods for reading respectively writing clock device registers.
               The default, when NULL is passed as an access method, is to access the  chip  memory  (and  clock
               registers) as if they were direct-mapped using the specified bus resource.

               Otherwise,  the driver will call the respective function supplied by the front-end to perform the
               access, passing it the offset <u>off</u> of the chip memory (or clock register) location to be read from
               or written to, respectively.

</pre><h4><b>HARDWARE</b></h4><pre>
       The following models are supported:

             Mostek MK48T02
             Mostek MK48T08
             Mostek MK48T18
             Mostek MK48T59

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man4/intro.4.html">intro</a></u>(4), <u><a href="../man9/watchdog.9.html">watchdog</a></u>(9)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>mk48txx</b> driver appeared in NetBSD 1.5.  The first FreeBSD version to include it was FreeBSD 5.0.

</pre><h4><b>AUTHORS</b></h4><pre>
       The <b>mk48txx</b> driver was written for NetBSD by Paul Kranenburg &lt;<u><a href="mailto:pk@NetBSD.org">pk@NetBSD.org</a></u>&gt;.  It was ported  to  FreeBSD
       by Thomas Moestl &lt;<u><a href="mailto:tmm@FreeBSD.org">tmm@FreeBSD.org</a></u>&gt; and later on improved by Marius Strobl &lt;<u><a href="mailto:marius@FreeBSD.org">marius@FreeBSD.org</a></u>&gt;.

Debian                                          December 25, 2009                                     <u><a href="../man4/MK48TXX.4.html">MK48TXX</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>