<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>perfmon — CPU performance-monitoring interface</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       perfmon — CPU performance-monitoring interface

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>cpu</b> <b>I586_CPU</b>
       <b>cpu</b> <b>I686_CPU</b>
       <b>options</b> <b>PERFMON</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>perfmon</b>  driver  provides  access  to  the internal performance-monitoring capabilities of the Intel
       Pentium and Pentium Pro CPUs.  These processors implement two internal counters which can  be  configured
       to  measure  a variety of events for either count or duration (in CPU cycles), as well as a cycle counter
       which counts clock cycles.  The <b>perfmon</b> driver provides a device-style interface to these capabilities.

       All access  to  the  performance-monitoring  counters  is  performed  through  the  special  device  file
       “<u>/dev/perfmon</u>”.  This device supports a number of <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2) requests, defined in &lt;<u>machine/perfmon.h</u>&gt; along
       with the definitions of the various counters for both Pentium and Pentium Pro processors.

       <b>NOTA</b>  <b>BENE</b>: The set of available events differs from processor to processor.  It is the responsibility of
       the programmer to ensure that the event numbers used  are  the  correct  ones  for  the  CPU  type  being
       measured.

       The following <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2) requests are defined:

       PMIOSETUP   (<b>struct</b>  <b>pmc</b>)  Set  up  a  counter  with  parameters and flags defined in the structure.  The
                   following fields are defined in <b>struct</b> <b>pmc</b>:

                   <b>int</b> <b>pmc_num</b>        the number of the counter in question; must be less than  NPMC  (currently
                                      2).

                   <b>u_char</b> <b>pmc_event</b>   the   particular   event   number   to   be   monitored,   as  defined  in
                                      &lt;<u>machine/perfmon.h</u>&gt;.

                   <b>u_char</b> <b>pmc_unit</b>    the  unit  mask  value,  specific  to  the  event  type  (see  the   Intel
                                      documentation).

                   <b>u_char</b> <b>pmc_flags</b>   flags modifying the operation of the counter (see below).

                   <b>u_char</b> <b>pmc_mask</b>    the  counter mask value; essentially, this is a threshold used to restrict
                                      the count to events lasting more (or less) than the  specified  number  of
                                      clocks.

                   The following <b>pmc_flags</b> values are defined:
                   PMCF_USR    count events in user mode
                   PMCF_OS     count events in kernel mode
                   PMCF_E      count number of events rather than their duration
                   PMCF_INV    invert the sense of the counter mask comparison

       PMIOGET     (<b>struct</b> <b>pmc</b>) returns the current configuration of the specified counter.

       PMIOSTART

       PMIOSTOP    (<b>int</b>)  starts  (stops) the specified counter.  Due to hardware deficiencies, counters must be
                   started and stopped in numerical order.  (That is to say, counter  0  can  never  be  stopped
                   without  first  stopping  counter 1.)  The driver will <u>not</u> enforce this restriction (since it
                   may not be present in future CPUs).

       PMIORESET   (<b>int</b>) reset the specified counter to zero.  The  counter  should  be  stopped  with  PMIOSTOP
                   before it is reset.  All counters are automatically reset by PMIOSETUP.

       PMIOREAD    (<b>struct</b>  <b>pmc_data</b>)  get the current value of the counter.  The <b>pmc_data</b> structure defines two
                   fields:

                   <b>int</b> <b>pmcd_num</b>       the number of the counter to read
                   <b>quad_t</b> <b>pmcd_value</b>  the resulting value as a 64-bit signed integer

                   In the future, it may be possible to use the <b>RDPMC</b> instruction on Pentium Pro  processors  to
                   read the counters directly.

       PMIOTSTAMP  (<b>struct</b>  <b>pmc_tstamp</b>)  read  the  time  stamp  counter.   The <b>pmc_tstamp</b> structure defines two
                   fields:

                   <b>int</b> <b>pmct_rate</b>      the approximate rate of the counter, in MHz
                   <b>quad_t</b> <b>pmct_value</b>  the current value of the counter as a 64-bit integer

                   It is important to note that the counter rate, as provided in the <b>pmct_rate</b> field,  is  often
                   incorrect  because  of  calibration  difficulties  and  non-integral clock rates.  This field
                   should be considered more of a hint or sanity-check than an actual representation of the rate
                   of clock ticks.

</pre><h4><b>FILES</b></h4><pre>
       <u>/dev/perfmon</u>                    character device interface to counters
       <u>/usr/include/machine/perfmon.h</u>  include file with definitions of structures and event types
       <u>/usr/share/examples/perfmon</u>     sample source code demonstrating use of all the <b>ioctl</b>() commands

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2), <u><a href="../man4/hwpmc.4.html">hwpmc</a></u>(4)

       Intel Corporation, <u>Pentium</u> <u>Pro</u> <u>Family</u> <u>Developer's</u> <u>Manual</u>, vol. 3, January 1996, Operating System Writer's
       Manual.

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>perfmon</b> device first appeared in FreeBSD 2.2.

</pre><h4><b>AUTHORS</b></h4><pre>
       The <b>perfmon</b> driver was written by Garrett A. Wollman, MIT Laboratory for Computer Science.

Debian                                           March 26, 1996                                       <u><a href="../man4/PERFMON.4.html">PERFMON</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>