<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>twpolicy - Tripwire policy file reference</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/tripwire">tripwire_2.4.3.7-6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       twpolicy - <u>Tripwire</u> policy file reference

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  policy  file describes system objects to be monitored by <u>Tripwire</u>, and specifies what properties for
       each object should be collected and stored in the database file.  Each  object  in  the  policy  file  is
       associated  with  a  property mask, which describes what changes to the file or directory <u>Tripwire</u> should
       monitor, and which ones can safely be ignored.  By customizing the various aspects of  the  policy  file,
       the system administrator can very closely control how <u>Tripwire</u> checks the integrity of any system.

       During  installation,  an  encoded  and  signed policy file (<u>tw.pol</u>) will be created in the <u>/etc/tripwire</u>
       directory, and a plain text copy of this policy file (<u>twpol.txt</u>) will be generated in the same directory.
       An additional text file (<u>policyguide.txt</u>) illustrates all of the features of the policy  language.   Both
       of the text files are heavily commented and can be used as a reference during policy file creation.

       A  new  policy  file is first created using the <b>twadmin</b> <b>--create-polfile</b> command.  With this command, the
       user can designate an existing plain text file as the current policy file.  Using the  current  site  key
       and passphrase, the new configuration file is encoded, signed and saved.

       Once   the   initial   policy   file   has   been   generated,  any  changes  should  be  made  with  the
       <b>tripwire</b> <b>--update-policy</b>  command,  rather  than  by  simply  overwriting  the  policy  file   with   the
       <b>twadmin</b> <b>--create-polfile</b>  command.   This is an important distinction‐‐when a new policy file is created,
       the <u>Tripwire</u> database must be re-initialized.  If an intruder has modified files since the last integrity
       check, these changes will not be detected, and will be included as part of the new "baseline" database.

</pre><h4><b>COMPONENTS</b> <b>OF</b> <b>THE</b> <b>POLICY</b> <b>FILE</b></h4><pre>
       The basic components of policy files are comments, rules,  directives,  and  variables.   Each  of  these
       components is described in greater detail below.

   <b>Comments</b>
       In a policy file, any text following a '#', up to the next line break, is considered a comment.  Example:

            # This is a comment.
            <a href="file:/bin">/bin</a>  -&gt;  $(ReadOnly);  # A comment can go here, too.

   <b>Rules</b>
       Policy  rules  determine whether and to what extent <u>Tripwire</u> will check particular files and directories.
       There are two kinds of policy rules recognized by <u>Tripwire</u>:

       1) Normal rules define which properties of a particular file or directory tree <u>Tripwire</u> scans.
       2) Stop points tell <u>Tripwire</u> not to scan a particular file or directory.

   <b>Normal</b> <b>Rules</b>
       The format for a normal rule is:
            <u>object_name</u>    -&gt;    <u>property_mask</u>;

       where the <u>object_name</u> is the fully  qualified  pathname  for  a  directory  or  file,  and  <u>property_mask</u>
       specifies  what  properties of an object to examine or ignore.  The '-&gt;' token separates the pathname and
       the property mask.  Whitespace must separate the object name and '-&gt;' token.  A semicolon must  terminate
       the  rule.   If  the  pathname specified is a directory, the directory and all of its descendants will be
       scanned with the indicated property mask.  If the pathname refers to an individual file, only  that  file
       will be scanned with the specified property mask.  Examples:

            # Defines Tripwire behavior for entire <a href="file:/bin">/bin</a> directory tree.
            <a href="file:/bin">/bin</a>   -&gt;   $(ReadOnly);

            # Defines Tripwire behavior for a single file.  In this case,
            # Tripwire watches for all properties of hostname.hme0.
            /etc/hostname.hme0    -&gt;    $(IgnoreNone) -ar;

            # Scan the entire <a href="file:/etc">/etc</a> directory tree using mask1, except the
            # file <a href="file:/etc/passwd">/etc/passwd</a>, which should be scanned using mask2.
            <a href="file:/etc">/etc</a>        -&gt;  $(mask1);
            <a href="file:/etc/passwd">/etc/passwd</a> -&gt;  $(mask2);

       Only  one rule may be associated with any given object.  If any object has more than one rule in a policy
       file, <u>Tripwire</u> will print an error message and exit without scanning any files.  For example:

            # This is an example of an illegal construct.
            <a href="file:/usr/bin">/usr/bin</a>   -&gt;   $(mask3);
            <a href="file:/usr/bin">/usr/bin</a>   -&gt;   $(mask4);

   <b>Object</b> <b>Names</b>
       In this  document,  policy  file  objects  are  fully  qualified  pathnames  of  files  and  directories.
       Environment variables are not allowed for security reasons.  Examples:

            <a href="file:/etc">/etc</a>         # valid object name.
            <a href="file:/etc/passwd">/etc/passwd</a>  # valid object name.
            $HOME        # not valid.

   <b>Property</b> <b>Masks</b>
       Property masks designate which <u>Tripwire</u> properties of a given object should be examined.  A property mask
       consists  of  a  series of single-character symbols, each of which may be preceded by an optional plus or
       minus sign.  Each character symbol stands for a  particular  <u>Tripwire</u>  property  to  be  examined  during
       integrity  checking.   If  the  character  is  preceded by a plus, checking is done for that property; if
       preceded by a minus, checking is not done for that property.  For example:

            +p          # compare permissions.
            -p          # ignore permissions.

       Each rule in the policy file must have a property mask.  Examples:

            <a href="file:/etc">/etc</a>        -&gt;    $(IgnoreAll);     #valid property mask.
            <a href="file:/etc">/etc</a>        -&gt;    +p-p;             #valid property mask.
            <a href="file:/etc">/etc</a>        -&gt;    ;                 #invalid property mask.

       Characters in a property mask without a preceding plus or minus sign  are  assumed  to  be  plus.   If  a
       property is not specified in the property mask, it is ignored, which is equivalent to turning it off with
       the minus sign.  Examples:

            # Examine permissions and link count.
            # All three of the following are equivalent.
            +p+n
            pn
            pn-g

       Characters used in property masks, with descriptions:

            -     Ignore the following properties
            +     Record and check the following properties
            a     Access timestamp
            b     Number of blocks allocated
            c     Inode timestamp (create/modify)
            d     ID of device on which inode resides
            g     File owner's group ID
            i     Inode number
            l     File is increasing in size (a "growing file")
            m     Modification timestamp
            n     Number of links (inode reference count)
            p     Permissions and file mode bits
            r     ID of device pointed to by inode
                  (valid only for device objects)
            s     File size
            t     File type
            u     File owner's user ID
            C     CRC-32 hash value
            H     Haval hash value
            M     MD5 hash value
            S     SHA hash value

   <b>Stop</b> <b>Points</b>
       Stop  points are used to specify specific files or directories that <u>Tripwire</u> should not scan.  The syntax
       for stop points is:
            !  <u>object_name</u>  ;
       For example:
            !<a href="file:/etc/init.d">/etc/init.d</a>;
            # The directory <a href="file:/etc/init.d">/etc/init.d</a> will not be scanned.

            <a href="file:/etc">/etc</a>   -&gt;   $(ReadOnly);
            !/etc/rc.d;
            !/etc/mnttab;
            # Scan all of <a href="file:/etc">/etc</a>, but do not scan two particular
            # files in the <a href="file:/etc">/etc</a> hierarchy.

   <b>Rule</b> <b>Attributes</b>
       Rule attributes work with normal rules to  modify  their  behavior  or  provide  additional  information.
       Multiple  attributes  can  be  assigned  to  each  rule.   Rule  attributes are not case-sensitive.  Rule
       attributes may be applied to a single rule using the following syntax:
            <u>object_name</u> -&gt; <u>property_mask</u> (<u>rule</u> <u>attribute</u> = <u>value</u>);
       For example:
            <a href="file:/usr/lib">/usr/lib</a> -&gt; $(ReadOnly) (emailto = <a href="mailto:admin@foo.com">admin@foo.com</a>, severity = 80);
            #This rule will notify the admin if any violations of the
            #rule occur and designate the severity as 80.

       Rule attributes can also be specified for a group of rules, using the format:
            (<u>attribute</u> <u>list</u>)
            {
                 <u>rule</u> <u>list</u>;
            }
       For example:
            (emailto = <a href="mailto:admin@foo.com">admin@foo.com</a>, severity = 80)
            {
                 <a href="file:/usr/lib">/usr/lib</a>  -&gt;  $(ReadOnly);
            }
       is equivalent to the attribute example above.

       The following four rule attributes are supported by <u>Tripwire</u>:

       rulename       The rulename attribute is used to associate a rule or set of rules with a  specific  name.
                      In  a  report  file,  this  name will be associated with violations to the specified rule.
                      This feature is useful if you want to  track  certain  objects  within  a  large  <u>Tripwire</u>
                      database.   For  instance,  if you associate the rule name "watchme" with important files,
                      you can sort through the <u>Tripwire</u> report using "watchme" as a sorting key.
                      Example:
                           <a href="file:/etc">/etc</a> -&gt; +ug (rulename=watchme);

       emailto        The emailto attribute associates one or more email addresses  with  a  rule  or  group  of
                      rules.   When  an  integrity  check  is  run  with the <b>--email-report</b> option and a rule is
                      violated, a report of that violation will be sent  to  the  specified  email  address(es),
                      using  the  report  format specified by the EMAILREPORTLEVEL variable in the configuration
                      file.
                      Example:
                           <a href="file:/etc">/etc</a> -&gt; +ug (emailto=<a href="mailto:admin@domain.com">admin@domain.com</a>);

                      To specify multiple email addresses, include them as a quoted, semicolon-delimited list.
                      <a href="file:/etc">/etc</a> -&gt; +ug (emailto="<a href="mailto:admin@foo.com">admin@foo.com</a>;<a href="mailto:admin2@foo.com">admin2@foo.com</a>");

       severity       The severity attribute associates a numeric severity level with a rule.  When <u>Tripwire</u>  is
                      run  in  Integrity  Checking  mode,  it is possible to specify that only rules exceeding a
                      certain severity level are used.  The default severity level is 0, and  values  can  range
                      from 0 to 1,000,000.
                      Example:
                           <a href="file:/etc">/etc</a> -&gt; +ug (severity=50);

       recurse        The recurse attribute specifies how a rule will scan directories. Valid values for recurse
                      are  <u>true</u>,  <u>false</u>,  or  a  number from -1 to 1,000,000. If recurse is set to <u>true</u> (or -1),
                      tripwire will recursively scan the entire  contents  of  the  directory  (both  files  and
                      subdirectories).  When recurse is set to <u>false</u> (or 0), and the rule refers to a directory,
                      <u>Tripwire</u> will scan the inode of the directory but none  of  the  files  or  subdirectories
                      contained  therein.  For positive recurse value <u>n</u>, the rule will monitor all objects up to
                      <u>n</u> levels below the start point. Stop points within the recursed directory still apply, and
                      will prevent the specified file or directory from being scanned.

                      When a rule refers to a file, specifying the recurse attribute has no  effect‐‐files  will
                      be  scanned  no  matter  what value is given for recurse. The default value for recurse is
                      <u>true</u>.
                      Example:
                           <a href="file:/etc">/etc</a> -&gt; +ug (recurse=2);

   <b>Directives</b>
       <u>Tripwire</u> supports a small number of directives that allow conditional interpretation of the  policy  file
       and certain diagnostic and debugging operations.  The primary purpose of directives is to support sharing
       of a policy file among multiple machines.  Directives use the following syntax:
            @@  <u>directive_name</u>  [<u>arguments</u>]

       Where the directive name is one of the directives listed below:

            @@section  # Designates a section of the policy file.

            @@ifhost   # Allow conditional interpretation
            @@else     # of the policy file.
            @@endif

            @@print    # Print a message to standard output.
            @@error    # Print a message to standard output and then exit.

            @@end      # Marks the logical end-of-file.

       The  @@section  directive  is  used  to designate sections of the policy file that are OS-specific.  With
       <u>Tripwire</u> <u>2.4</u>, valid arguments for the @@section directive are FS and GLOBAL. If no @@section directive is
       specified, FS will be assumed.  If the argument to the @@section directive is either NTFS or NTREG (which
       have meaning only on Windows NT systems), <u>Tripwire</u> will skip all policy file text down to the next  valid
       @@section directive.  Any other argument will cause an error.

       The  @@ifhost,  @@else, and @@endif directives are used to allow conditional interpretation of the policy
       file. With the @@ifhost directive, multiple hostnames can be expressed as arguments,  but  they  must  be
       separated  by  an  '||',  interpreted as the logical 'OR'.  This example illustrates how one might employ
       directives to use one policy file with multiple hosts.

            @@ifhost spock || kirk
               <a href="file:/bin">/bin</a>   -&gt;   $(ReadOnly);
            @@endif

            @@ifhost chekov || uhura
               <a href="file:/usr/bin">/usr/bin</a>   -&gt;   +pinug;
            @@else
               <a href="file:/usr/bin">/usr/bin</a>   -&gt;   +pinugsmC;
            @@endif

       The @@print and @@error directives are intended for debugging and remote  diagnostics.   The  syntax  for
       these commands is:
            @@print  "<u>string</u>"
            @@error  "<u>string</u>"

       The  @@print  directive  prints <u>string</u> to <u>stdout</u>, while the @@error directive prints <u>string</u> to <u>stdout</u> and
       causes the calling program to exit with a non-zero status.

       The @@end directive marks the end of the policy file.  Any text appearing after this  directive  will  be
       ignored by <u>Tripwire</u>.

   <b>Variables</b>
       For  user  convenience, <u>Tripwire</u>'s policy file supports variables for string substitution.  Variables can
       be defined anywhere between rules.  The syntax for variable definition is:
            <u>variable</u>  =  <u>value</u>;

       Variable substitution is legal anywhere that a string could appear.  The syntax for variable substitution
       is:
            $(  <u>variable</u>  )

       Examples of variable definition and variable substitution on the left, right, and both  sides  of  rules.
       Note that variable names are case sensitive.

            param1 = +SMCH;          # Set variable param1.
            dir1   = /etc/inet;      # Set variable dir1.
            DIR1   = <a href="file:/etc/init.d">/etc/init.d</a>;    # Variables are case sensitive.
            $(dir1)   -&gt; +tbamc;     # Left hand substitution.
            /etc/inet -&gt; $(param1);  # Right hand substitution.
            $(DIR1)   -&gt; $(param1);  # Double substitution.

       A  number  of  variables  are  predefined  by <u>Tripwire</u> and may not be changed.  These variables represent
       different ways that files can change, and can be used on the right side of rules to design a policy  file
       quickly.

       ReadOnly       ReadOnly is good for files that are widely available but are intended to be read-only.
                      Value: +pinugtsdbmCM-rlacSH

       Dynamic        Dynamic  is  good  for  monitoring  user  directories and files that tend to be dynamic in
                      behavior.
                      Value: +pinugtd-srlbamcCMSH

       Growing        The Growing variable is intended for files that should only get larger.
                      Value: +pinugtdl-srbamcCMSH

       Device         Device is good for devices or other files that <u>Tripwire</u> should not attempt to open.
                      Value: +pugsdr-intlbamcCMSH

       IgnoreAll      IgnoreAll tracks a file's presence or absence, but doesn't check any other properties.
                      Value: -pinugtsdrlbamcCMSH

       IgnoreNone     IgnoreNone turns on all properties and provides a convenient starting point  for  defining
                      your own property masks.  (For example, mymask = $(IgnoreNone) -ar;)
                      Value: +pinugtsdrbamcCMSH-l

</pre><h4><b>VERSION</b> <b>INFORMATION</b></h4><pre>
       This man page describes <u>Tripwire</u> <u>2.4</u>.

</pre><h4><b>AUTHORS</b></h4><pre>
       Tripwire, Inc.

</pre><h4><b>COPYING</b> <b>PERMISSIONS</b></h4><pre>
       Permission  is  granted  to  make  and distribute verbatim copies of this man page provided the copyright
       notice and this permission notice are preserved on all copies.

       Permission is granted to copy and distribute modified versions of this man page under the conditions  for
       verbatim  copying,  provided  that  the entire resulting derived work is distributed under the terms of a
       permission notice identical to this one.

       Permission is granted to copy and distribute translations of this man page into another  language,  under
       the  above  conditions  for  modified  versions,  except  that  this permission notice may be stated in a
       translation approved by Tripwire, Inc.

       Copyright 2000-2018 Tripwire, Inc. Tripwire is a registered trademark of Tripwire,  Inc.  in  the  United
       States and other countries. All rights reserved.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/twintro.8.html">twintro</a></b>(8), <b><a href="../man8/tripwire.8.html">tripwire</a></b>(8), <b><a href="../man8/twadmin.8.html">twadmin</a></b>(8), <b><a href="../man8/twprint.8.html">twprint</a></b>(8), <b><a href="../man8/siggen.8.html">siggen</a></b>(8), <b><a href="../man4/twconfig.4.html">twconfig</a></b>(4), <b><a href="../man5/twfiles.5.html">twfiles</a></b>(5)

Open Source Tripwire 2.4                           04 Jan 2018                                       <u><a href="../man4/TWPOLICY.4.html">TWPOLICY</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>