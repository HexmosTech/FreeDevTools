<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fdc — PC architecture floppy disk controller driver</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fdc — PC architecture floppy disk controller driver

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>device</b> <b>fdc</b>

       In <u>/boot/device.hints</u>:
       <b>hint.fdc.0.at="isa"</b>
       <b>hint.fdc.0.port="0x3F0"</b>
       <b>hint.fdc.0.irq="6"</b>
       <b>hint.fdc.0.drq="2"</b>
       <b>hint.fdc.0.flags="0x0"</b>
       <b>hint.fd.0.at="fdc0"</b>
       <b>hint.fd.0.drive="0"</b>
       <b>hint.fd.0.flags="0x0"</b>
       <b>hint.fd.1.at="fdc0"</b>
       <b>hint.fd.1.drive="1"</b>
       <b>hint.fd.1.flags="0x0"</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
   <b>Device</b> <b>Usage</b>
       This  driver provides access to floppy disk drives.  Floppy disks using either FM (single-density) or MFM
       (double or high-density) recording can be handled.

       Floppy disk controllers can connect up to four drives each.  The <b>fdc</b> driver can currently  handle  up  to
       two  drives  per  controller (or four drives on ACPI).  Upon driver initialization, an attempt is made to
       find out the type of the floppy controller in use.  The known controller types are  either  the  original
       NE765  or  i8272  chips,  or  alternatively  <u>enhanced</u> controllers that are compatible with the NE72065 or
       i82077 chips.  These enhanced controllers (among other enhancements) implement a  FIFO  for  floppy  data
       transfers  that  will  automatically  be  enabled  once  an  enhanced  chip has been detected.  This FIFO
       activation can be disabled using the per-controller flags value of <u>0x1</u>.

       By default, this driver creates a single device node <u>/dev/fdN</u> for each attached drive with number <u>N</u>.  For
       historical reasons, device nodes that use a trailing UFS-style partition letter (ranging from ‘a’ through
       ‘h’) can also be accessed, which will be implemented as symbolic links to the main device node.

       Accessing the main device node will attempt to autodetect the density of the available medium for  multi-
       density devices.  Thus it is possible to use either a 720 KB medium or a 1440 KB medium in a high-density
       3.5  inch standard floppy drive.  Normally, this autodetection will only happen once at the first call to
       <u><a href="../man2/open.2.html">open</a></u>(2) for the device after inserting the medium.  This  assumes  the  drive  offers  proper  changeline
       support  so  media  changes  can  be  detected by the driver.  To indicate a drive that does not have the
       changeline support, this can be overridden using the per-drive device flags value of <u>0x10</u>  (causing  each
       call to <u><a href="../man2/open.2.html">open</a></u>(2) to perform the autodetection).

       When  trying to use a floppy device with special-density media, other device nodes can be created, of the
       form <u>/dev/fdN</u>.<u>MMMM</u>, where <u>N</u> is the drive number, and <u>MMMM</u>  is  a  number  between  one  and  four  digits
       describing  the  device  density.  Up to 15 additional subdevices per drive can be created that way.  The
       administrator is free to decide on a policy how to assign these numbers.  The two common policies are  to
       either  implement  subdevices numbered 1 through 15, or to use a number that describes the medium density
       in kilobytes.  Initially, each of those devices will  be  configured  to  the  maximal  density  that  is
       possible  for  the  drive  type (like 1200 KB for 5.25 inch HD drives or 1440 KB for 3.5 inch HD drives).
       The desired density to be used on that subdevice needs to be configured using <u><a href="../man8/fdcontrol.8.html">fdcontrol</a></u>(8).

       Drive types are configured using the lower four bits of the per-drive device flags.  The following values
       can be specified:

             <u>1</u>   5.25 inch double-density device with 40 cylinders (360 KB native capacity)

             <u>2</u>   5.25 inch high-density device with 80 cylinders (1200 KB native capacity)

             <u>3</u>   3.5 inch double-density device with 80 cylinders (720 KB native capacity)

             <u>4</u>   3.5 inch high-density device with 80 cylinders (1440 KB native capacity)

             <u>5</u>   3.5 inch extra-density device with 80 cylinders  (2880  KB  native  capacity,  usage  currently
                 restricted to at most 1440 KB media)

             <u>6</u>   Same as type 5, available for compatibility with some BIOSes

       On  IA32  architectures,  the  drive  type  can be specified as 0 for the drives.  In that case, the CMOS
       configuration memory will be consulted to obtain the value for that drive.  The ACPI probe  automatically
       determines  these  values via the _FDE and _FDI methods, but this can be overridden by specifying a drive
       type hint.

       Normally, each configured drive will be probed at initialization time, using a short seek sequence.  This
       is intended to find out about drives that have been configured but are actually missing or otherwise  not
       responding.  (The ACPI probe method does not perform this seek.)  In some environments (like laptops with
       detachable  drives), it might be desirable to bypass this drive probe, and pretend a drive to be there so
       the driver autoconfiguration will work even if the drive is currently not present.  For that  purpose,  a
       per-drive device flags value of <u>0x20</u> needs to be specified.

   <b>Programming</b> <b>Interface</b>
       In  addition  to  the normal read and write functionality, the <b>fdc</b> driver offers a number of configurable
       options using <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2).  In order to access any of this functionality, programmers need  to  include  the
       header  file  &lt;<u>sys/fdcio.h</u>&gt;  into  their  programs.  The call to <u><a href="../man2/open.2.html">open</a></u>(2) can be performed in two possible
       ways.  When opening the device without the O_NONBLOCK flag set, the device is opened  in  a  normal  way,
       which  would  cause  the  main  device nodes to perform automatic media density selection, and which will
       yield a file descriptor that is fully available for any I/O operation or any of  the  following  <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2)
       commands.

       When  opening the device with O_NONBLOCK set, automatic media density selection will be bypassed, and the
       device remains in a half-opened state.  No actual I/O operations are possible, but many of  the  <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2)
       commands  described  below  can be performed.  This mode is intended for access to the device without the
       requirement to have an accessible media present, like for status inquiries to the drive, or in  order  to
       format  a  medium.   O_NONBLOCK needs to be cleared before I/O operations are possible on the descriptor,
       which requires a prior specification of the density using the FD_STYPE command (see  below).   Operations
       that are not allowed on the half-opened descriptor will cause an error value of EAGAIN.

       The following <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2) commands are currently available:

       FD_FORM    Used  to  format  a  floppy  disk  medium.   Third  argument is a pointer to a <u>struct</u> <u>fd_formb</u>
                  specifying which track to format, and which parameters to fill  into  the  ID  fields  of  the
                  floppy disk medium.

       FD_GTYPE   Returns  the  current  density definition record for the selected device.  Third argument is a
                  pointer to <u>struct</u> <u>fd_type</u>.

       FD_STYPE   Adjusts the density definition of the selected device.  Third argument is a pointer to  <u>struct</u>
                  <u>fd_type</u>.   For  the  fixed-density  subdevices  (1  through  15  per drive), this operation is
                  restricted to a process with superuser privileges.  For the auto-selecting  subdevice  0,  the
                  operation  is temporarily allowed to any process, but this setting will be lost again upon the
                  next autoselection.  This can be used when formatting a new medium (which will require to open
                  the device using O_NONBLOCK, and thus to later adjust the density using FD_STYPE).

       FD_GOPTS   Obtain the current drive options.  Third argument is a pointer to <u>int</u>,  containing  a  bitwise
                  union of the following possible flag values:

                  FDOPT_NORETRY   Do not automatically retry operations upon failure.

                  FDOPT_NOERRLOG  Do not cause “hard error” kernel logs for failed I/O operations.

                  FDOPT_NOERROR   Do  not  indicate  I/O  errors  when returning from <u><a href="../man2/read.2.html">read</a></u>(2) or <u><a href="../man2/write.2.html">write</a></u>(2) system
                                  calls.  The caller is assumed to use FD_GSTAT calls in order to inquire  about
                                  the  success of each operation.  This is intended to allow even erroneous data
                                  from bad blocks to be retrieved using normal I/O operations.

                  FDOPT_AUTOSEL   Device performs automatic density selection.  Unlike the above flags, this one
                                  is read-only.

       FD_SOPTS   Set device options, see above for their meaning.  Third argument is a pointer to  <u>int</u>.   Drive
                  options will always be cleared when closing the descriptor.

       FD_CLRERR  Clear  the  internal  low-level error counter.  Normally, controller-level I/O errors are only
                  logged up to FDC_ERRMAX errors (currently defined to 100).  This command resets  the  counter.
                  Requires superuser privileges.

       FD_READID  Read  one  sector ID field from the floppy disk medium.  Third argument is a pointer to <u>struct</u>
                  <u>fdc_readid</u>, where the read data will be returned.  Can  be  used  to  analyze  a  floppy  disk
                  medium.

       FD_GSTAT   Return the recent floppy disk controller status, if available.  Third argument is a pointer to
                  <u>struct</u>  <u>fdc_status</u>,  where  the  status  registers  (ST0,  ST1, ST2, C, H, R, and N) are being
                  returned.  EINVAL will be caused if no recent status is available.

       FD_GDTYPE  Returns the floppy disk drive type.  Third argument is a pointer to <u>enum</u>  <u>fd_drivetype</u>.   This
                  type  is  the  same  as  being  used  in  the  per-drive  configuration  flags, or in the CMOS
                  configuration data or ACPI namespace on IA32 systems.

</pre><h4><b>DEPRECATION</b> <b>NOTICE</b></h4><pre>
       The PC Card attachment of this driver is scheduled for removal prior to the release of FreeBSD 13.0

</pre><h4><b>FILES</b></h4><pre>
       <u><a href="file:/dev/fd">/dev/fd</a>*</u>  floppy disk device nodes

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/fdformat.1.html">fdformat</a></u>(1), <u><a href="../man1/fdread.1.html">fdread</a></u>(1), <u><a href="../man1/fdwrite.1.html">fdwrite</a></u>(1), <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2), <u><a href="../man2/open.2.html">open</a></u>(2), <u><a href="../man2/read.2.html">read</a></u>(2), <u><a href="../man2/write.2.html">write</a></u>(2), <u><a href="../man8/fdcontrol.8.html">fdcontrol</a></u>(8)

</pre><h4><b>AUTHORS</b></h4><pre>
       This man page was initially written by Wilko Bulte, and later vastly rewritten by Jörg Wunsch.

Debian                                            April 7, 2017                                           <u><a href="../man4/FDC.4.html">FDC</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>