<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>spigen — SPI generic I/O device driver</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       spigen — SPI generic I/O device driver

</pre><h4><b>SYNOPSIS</b></h4><pre>
       To compile this driver into the kernel, place the following lines in your kernel configuration file:

             <b>device</b> <b>spi</b>
             <b>device</b> <b>spibus</b>
             <b>device</b> <b>spigen</b>

       Alternatively, to load the driver as a module at boot time, place the following line in <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             spigen_load="YES"

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>spigen</b>  driver  provides  direct access to a slave device on the SPI bus.  Each instance of a <b>spigen</b>
       device is associated with a single chip-select line on the  bus,  and  all  I/O  performed  through  that
       instance is done with that chip-select line asserted.

       SPI data transfers are inherently bi-directional; there are not separate read and write operations.  When
       commands  and data are sent to a device, data also comes back from the device, although in some cases the
       data may not be useful (or even documented  or  predictable  for  some  devices).   Likewise  on  a  read
       operation, whatever data is in the buffer at the start of the operation is sent to (and typically ignored
       by)  the  device, with each outgoing byte then replaced in the buffer by the corresponding incoming byte.
       Thus, all buffers passed to the transfer functions are both input and output buffers.

       The <b>spigen</b> driver provides access to the SPI slave device with the following <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2) calls,  defined  in
       &lt;<u>sys/spigenio.h</u>&gt;:

       SPIGENIOC_TRANSFER (<u>struct</u> <u>spigen_transfer</u>)
               Transfer  a  command and optional associated data to/from the device, using the buffers described
               by the st_command and st_data fields in the <u>spigen_transfer</u>.   Set  <u>st_data.iov_len</u>  to  zero  if
               there is no data associated with the command.

               struct spigen_transfer {
                       struct iovec st_command;
                       struct iovec st_data;
               };

       SPIGENIOC_TRANSFER_MMAPPED (<u>spigen_transfer_mmapped</u>)
               Transfer a command and optional associated data to/from the device.  The buffers for the transfer
               are  a  previously-mmap'd  region.   The  length  of  the command and data within that region are
               described by the <u>stm_command_length</u> and <u>stm_data_length</u> fields  of  <u>spigen_transfer_mmapped</u>.   If
               <u>stm_data_length</u>  is  non-zero,  the  data  appears in the memory region immediately following the
               command (that is, at offset <u>stm_command_length</u> from the start of the mapped region).

               struct spigen_transfer_mmapped {
                       size_t stm_command_length;
                       size_t stm_data_length;
               };

       SPIGENIOC_GET_CLOCK_SPEED (<u>uint32_t</u>)
               Get the maximum clock speed (bus frequency in Hertz) to be  used  when  communicating  with  this
               slave device.

       SPIGENIOC_SET_CLOCK_SPEED (<u>uint32_t</u>)
               Set  the  maximum  clock  speed  (bus frequency in Hertz) to be used when communicating with this
               slave device.  The setting remains in effect for subsequent transfers; it  is  not  necessary  to
               reset  this  before  each  transfer.   The  actual  bus  frequency  may  be lower due to hardware
               limitiations of the SPI bus controller device.

       SPIGENIOC_GET_SPI_MODE (<u>uint32_t</u>)
               Get the SPI mode (clock polarity and phase) to be used when communicating with this device.

       SPIGENIOC_SET_SPI_MODE (<u>uint32_t</u>)
               Set the SPI mode (clock polarity and phase) to be used when communicating with this device.   The
               setting remains in effect for subsequent transfers; it is not necessary to reset this before each
               transfer.

</pre><h4><b>HINTS</b> <b>CONFIGURATION</b></h4><pre>
       On a <u><a href="../man5/device.hints.5.html">device.hints</a></u>(5) based system, such as <b>MIPS</b>, these values are configurable for <b>spigen</b>:

       <u>hint.spigen.%d.at</u>
               The spibus the <b>spigen</b> instance is attached to.

       <u>hint.spigen.%d.clock</u>
               The  maximum  bus  frequency to use when communicating with this device.  Actual bus speed may be
               lower, depending on the capabilities of the SPI bus controller hardware.

       <u>hint.spigen.%d.cs</u>
               The chip-select number to assert when performing I/O for this device.  Set the high bit (1 &lt;&lt; 31)
               to invert the logic level of the chip select line.

       <u>hint.spigen.%d.mode</u>
               The SPI mode (0-3) to use when communicating with this device.

</pre><h4><b>FDT</b> <b>CONFIGURATION</b></h4><pre>
       On an <u><a href="../man4/fdt.4.html">fdt</a></u>(4) based system, the spigen device is defined  as  a  slave  device  subnode  of  the  SPI  bus
       controller  node.   All  properties  documented  in the <u>spibus.txt</u> bindings document can be used with the
       <b>spigen</b> device.  The most commonly-used ones are documented below.

       The following properties are required in the <b>spigen</b> device subnode:

       <u>compatible</u>
               Must be the string "freebsd,spigen".

       <u>reg</u>     Chip select address of device.

       <u>spi-max-frequency</u>
               The maximum bus frequency to use when communicating with this slave device.  Actual bus speed may
               be lower, depending on the capabilities of the SPI bus controller hardware.

       The following properties are optional for the <b>spigen</b> device subnode:

       <u>spi-cpha</u>
               Empty property indicating the slave device requires shifted clock phase (CPHA) mode.

       <u>spi-cpol</u>
               Empty property indicating the slave device requires inverse clock polarity (CPOL) mode.

       <u>spi-cs-high</u>
               Empty property indicating the slave device requires chip select active high.

</pre><h4><b>FILES</b></h4><pre>
       <u>/dev/spigen*</u>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man4/fdt.4.html">fdt</a></u>(4), <u><a href="../man5/device.hints.5.html">device.hints</a></u>(5)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>spigen</b> driver appeared in FreeBSD 11.0.  FDT support appeared in FreeBSD 11.2.

Debian                                            April 7, 2018                                        <u><a href="../man4/SPIGEN.4.html">SPIGEN</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>