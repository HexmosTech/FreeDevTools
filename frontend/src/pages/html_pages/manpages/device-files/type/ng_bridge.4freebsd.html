<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ng_bridge — Ethernet bridging netgraph node type</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ng_bridge — Ethernet bridging netgraph node type

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/types.h&gt;</b>
       <b>#include</b> <b>&lt;netgraph/ng_bridge.h&gt;</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>bridge</b>  node  type  performs  Ethernet bridging over one or more links.  Each link (represented by a
       connected hook) is used to transmit and receive raw Ethernet frames.  As packets are received,  the  node
       learns which link each host resides on.  Packets unicast to a known host are directed out the appropriate
       link  only,  and other links are spared the traffic.  This behavior is in contrast to a hub, which always
       forwards every received packet to every other link.

</pre><h4><b>LOOP</b> <b>DETECTION</b></h4><pre>
       The <b>bridge</b> node incorporates a simple loop detection algorithm.  A loop is when two ports  are  connected
       to  the  same  physical  medium.   Loops  are important to avoid because of packet storms, which severely
       degrade performance.  A packet storm results when the same packet is sent  and  received  over  and  over
       again.   If  a  host  is  detected on link A, and is then detected on link B within a certain time period
       after first being detected on link A, then link B is considered to be  a  looped  back  link.   The  time
       period is called the minimum stable time.

       A looped back link will be temporarily muted, i.e., all traffic received on that link is ignored.

</pre><h4><b>IPFW</b> <b>PROCESSING</b></h4><pre>
       Processing of IP packets via the <u><a href="../man4/ipfirewall.4.html">ipfirewall</a></u>(4) mechanism on a per-link basis is not yet implemented.

</pre><h4><b>HOOKS</b></h4><pre>
       This  node  type  supports  an unlimited number of hooks.  Each connected hook represents a bridged link.
       The hooks are named link0, link1, etc.  Typically these hooks are connected to the lower hooks of one  or
       more  <u><a href="../man4/ng_ether.4.html">ng_ether</a></u>(4) nodes.  To connect the host machine to a bridged network, simply connect the upper hook
       of an <u><a href="../man4/ng_ether.4.html">ng_ether</a></u>(4) node to the bridge node.

</pre><h4><b>CONTROL</b> <b>MESSAGES</b></h4><pre>
       This node type supports the generic control messages, plus the following:

       NGM_BRIDGE_SET_CONFIG (<b>setconfig</b>)
            Set the node configuration.  This command takes a struct ng_bridge_config as an argument:

            /* Node configuration structure */
            struct ng_bridge_config {
              u_char      debugLevel;           /* debug level */
              uint32_t    loopTimeout;          /* link loopback mute time */
              uint32_t    maxStaleness;         /* max host age before nuking */
              uint32_t    minStableAge;         /* min time for a stable host */
            };

            The debugLevel field sets the debug level on the node.  At level of 2 or greater, detected loops are
            logged.  The default level is 1.

            The loopTimeout determines how long (in seconds) a looped link is muted.  The default is 60 seconds.
            The maxStaleness parameter determines how long a period of  inactivity  before  a  host's  entry  is
            forgotten.   The  default  is  15 minutes.  The minStableAge determines how quickly a host must jump
            from one link to another before we declare a loopback condition.  The default is one second.

       NGM_BRIDGE_GET_CONFIG (<b>getconfig</b>)
            Returns the current configuration as a struct ng_bridge_config.

       NGM_BRIDGE_RESET (<b>reset</b>)
            Causes the node to forget all hosts and unmute all links.  The node configuration is not changed.

       NGM_BRIDGE_GET_STATS (<b>getstats</b>)
            This command takes a four byte link number as an argument and returns a struct  ng_bridge_link_stats
            containing statistics for the corresponding link, which must be currently connected:

            /* Statistics structure (one for each link) */
            struct ng_bridge_link_stats {
              uint64_t   recvOctets;     /* total octets rec'd on link */
              uint64_t   recvPackets;    /* total pkts rec'd on link */
              uint64_t   recvMulticasts; /* multicast pkts rec'd on link */
              uint64_t   recvBroadcasts; /* broadcast pkts rec'd on link */
              uint64_t   recvUnknown;    /* pkts rec'd with unknown dest addr */
              uint64_t   recvRunts;      /* pkts rec'd less than 14 bytes */
              uint64_t   recvInvalid;    /* pkts rec'd with bogus source addr */
              uint64_t   xmitOctets;     /* total octets xmit'd on link */
              uint64_t   xmitPackets;    /* total pkts xmit'd on link */
              uint64_t   xmitMulticasts; /* multicast pkts xmit'd on link */
              uint64_t   xmitBroadcasts; /* broadcast pkts xmit'd on link */
              uint64_t   loopDrops;      /* pkts dropped due to loopback */
              uint64_t   loopDetects;    /* number of loop detections */
              uint64_t   memoryFailures; /* times couldn't get mem or mbuf */
            };

       NGM_BRIDGE_CLR_STATS (<b>clrstats</b>)
            This command takes a four byte link number as an argument and clears the statistics for that link.

       NGM_BRIDGE_GETCLR_STATS (<b>getclrstats</b>)
            Same as NGM_BRIDGE_GET_STATS, but also atomically clears the statistics as well.

       NGM_BRIDGE_GET_TABLE (<b>gettable</b>)
            Returns the current host mapping table used to direct packets, in a struct ng_bridge_host_ary.

       NGM_BRIDGE_SET_PERSISTENT (<b>setpersistent</b>)
            This command sets the persistent flag on the node, and takes no arguments.

</pre><h4><b>SHUTDOWN</b></h4><pre>
       This  node  shuts  down  upon  receipt  of  a  NGM_SHUTDOWN  control message, or when all hooks have been
       disconnected.  Setting the persistent flag  via  a  NGM_BRIDGE_SET_PERSISTENT  control  message  disables
       automatic node shutdown when the last hook gets disconnected.

</pre><h4><b>FILES</b></h4><pre>
       <u>/usr/share/examples/netgraph/ether.bridge</u>
                 Example script showing how to set up a bridging network

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man4/if_bridge.4.html">if_bridge</a></u>(4), <u><a href="../man4/netgraph.4.html">netgraph</a></u>(4), <u><a href="../man4/ng_ether.4.html">ng_ether</a></u>(4), <u><a href="../man4/ng_hub.4.html">ng_hub</a></u>(4), <u><a href="../man4/ng_one2many.4.html">ng_one2many</a></u>(4), <u><a href="../man8/ngctl.8.html">ngctl</a></u>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>ng_bridge</b> node type was implemented in FreeBSD 4.2.

</pre><h4><b>AUTHORS</b></h4><pre>
       Archie Cobbs &lt;<u><a href="mailto:archie@FreeBSD.org">archie@FreeBSD.org</a></u>&gt;

Debian                                           October 2, 2019                                    <u><a href="../man4/NG_BRIDGE.4.html">NG_BRIDGE</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>