<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alertmanager - Configure Prometheus Alerting</title>
    <meta name="description" content="Configure Prometheus Alertmanager to manage and route alerts effectively. This guide provides a sample Alertmanager configuration for Slack and Pushover notifications, handling different alert severities and environments.">
    <meta name="keywords" content="Alertmanager, Prometheus, alerting, monitoring, configuration, Slack, Pushover, notifications, YAML">
    <meta name="author" content="Hexmos">
    <link rel="canonical" href="https://example.com/alertmanager">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://example.com/alertmanager">
    <meta property="og:title" content="Alertmanager - Configure Prometheus Alerting">
    <meta property="og:description" content="Configure Prometheus Alertmanager to manage and route alerts effectively. This guide provides a sample Alertmanager configuration for Slack and Pushover notifications, handling different alert severities and environments.">
    <meta property="og:image" content="https://example.com/alertmanager-banner.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://example.com/alertmanager">
    <meta property="twitter:title" content="Alertmanager - Configure Prometheus Alerting">
    <meta property="twitter:description" content="Configure Prometheus Alertmanager to manage and route alerts effectively. This guide provides a sample Alertmanager configuration for Slack and Pushover notifications, handling different alert severities and environments.">
    <meta property="twitter:image" content="https://example.com/alertmanager-banner.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h2 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2>Alertmanager</h2>
        </div>
        <div class="content">
            <p>This document provides a sample Alertmanager configuration. Alertmanager is a critical component of the Prometheus monitoring system, responsible for receiving alerts from Prometheus and routing them to various notification channels. This configuration demonstrates how to set up routing based on alert severity and environment, sending notifications to Slack and Pushover.</p>
            <h2>Configuration Details</h2>
            <p>Explore the configuration details of Alertmanager, a crucial component for managing alerts from Prometheus. Learn how to set up global settings, routing rules, and receivers for effective notification management.</p>
            <h3>Global Settings</h3>
            <p>The <code>global</code> section defines overall settings such as the <code>resolve_timeout</code> (how long to wait before considering an alert resolved) and the <code>slack_api_url</code> (the webhook URL for Slack notifications).</p>
            <h3>Routing Rules</h3>
            <p>The <code>route</code> section defines how alerts are grouped and routed. Alerts are grouped by <code>alertname</code>, <code>cluster</code>, <code>job</code>, <code>environment</code>, and <code>severity</code>. The <code>repeat_interval</code> prevents duplicate alerts within a 24-hour period, and the <code>group_interval</code> aggregates alerts within a 5-minute window.</p>
            <h3>Receivers</h3>
            <p>The <code>receivers</code> section defines the notification channels. This example uses Slack and Pushover. Each receiver has its own configuration, specifying things like the channel, message formatting, and whether to send resolved alerts.</p>
            <pre><code class="language-yaml"># https://prometheus.io/docs/alerting/latest/notification_examples/
# https://rtfm.co.ua/en/prometheus-alertmanagers-alerts-receivers-and-routing-based-on-severity-level-and-tags/
global:
  resolve_timeout: 5m
  slack_api_url: 'https://hooks.slack.com/services/x/x/x'

route:
  # https://www.robustperception.io/whats-the-difference-between-group_interval-group_wait-and-repeat_interval
  group_by: ['alertname', 'cluster', 'job', 'environment', 'severity']
  repeat_interval: 24h
  group_interval: 5m
  receiver: 'warning'
  routes:
    - match:
        severity: warning
      receiver: warning
      routes:
      - match_re:
          environment: .*(-prod).*
        receiver: critical

receivers:
  - name: 'warning'
    slack_configs:
      - send_resolved: true
        channel: "#notifications"
        title_link: 'http://alertmanager.localdns.xyz/prometheus/alerts'
        title: '{{ if eq .Status "firing" }}:flushed:{{ else }}:sunglasses:{{ end }} [{{ .Status | toUpper }}] {{ .CommonAnnotations.summary }} (warning)'
        text: "{{ range .Alerts }}*Priority*: `{{ .Labels.severity | toUpper }}`\nTarget: {{ .Labels.instance }}\n{{ .Annotations.description }}\n{{ end }}"

  - name: 'critical'
    slack_configs:
      - send_resolved: true
        channel: "#notifications"
        title_link: 'http://alertmanager.localdns.xyz/prometheus/alerts'
        title: '{{ if eq .Status "firing" }}:scream:{{ else }}:sunglasses:{{ end }} [{{ .Status | toUpper }}] {{ .CommonAnnotations.summary }} (critical)'
        text: "{{ range .Alerts }}*Priority*: `{{ .Labels.severity | toUpper }}`\n*Description*: {{ .Annotations.description }}\n{{ end }}"
    pushover_configs:
      - token: example-token
        user_key: example-key
        title: '{{ if eq .Status "firing" }}ALARM{{ else }}OK{{ end }} [{{ .Status | toUpper }}] {{ .CommonAnnotations.summary }}'
        message: '{{ template "pushover.default.message" . }}'
        url: '{{ template "pushover.default.url" . }}'
        priority: '{{ if eq .Status "firing" }}2{{ else }}0{{ end }}'

  - name: 'detailed-slack'
    slack_configs:
      - send_resolved: true
        title_link: 'http://alertmanager.localdns.xyz/#/alerts'
        title: '{{ if eq .Status "firing" }}:sadparrot:{{ else }}:fastparrot:{{ end }} [{{ .Status | toUpper }}] {{ .CommonAnnotations.title }} (instances)'
        channel: '#notifications'
        text: &gt;-
          {{ range .Alerts }}
            *Alert:* {{ .Annotations.summary }} - `{{ .Labels.severity }}`
            *Description:* {{ .Annotations.description }}
            *Graph:* &lt;{{ .GeneratorURL }}|:chart_with_upwards_trend:&gt;
            *Runbook:* &lt;{{ .Annotations.runbook }}|:spiral_note_pad:&gt;
            *Details:*
            {{ range .Labels.SortedPairs }} â€¢ *{{ .Name }}:* `{{ .Value }}`
            {{ end }}
          {{ end }}
        username: 'AlertManager'
        icon_emoji: ':prometheus:'
</code></pre>
            <h2>Further Reading</h2>
            <p>For more detailed information on configuring Alertmanager, refer to the official <a href="https://prometheus.io/docs/alerting/latest/alertmanager/">Prometheus Alertmanager documentation</a>.</p>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>
