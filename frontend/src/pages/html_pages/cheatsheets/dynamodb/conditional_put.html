<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DynamoDB Conditional Put - Ensure Data Integrity</title>
    <meta name="description" content="Perform conditional PUT operations in DynamoDB to ensure data integrity. Learn how to use ConditionExpression to prevent overwriting existing items with the DynamoDB conditional put.">
    <meta name="keywords" content="DynamoDB, conditional put, put item, conditionexpression, dynamodb put, dynamodb data integrity, aws dynamodb, nosql, database operations, conditional writes">
    <link rel="canonical" href="https://www.example.com/dynamodb/conditional_put.html">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="DynamoDB Conditional Put - Ensure Data Integrity">
    <meta property="og:description" content="Perform conditional PUT operations in DynamoDB to ensure data integrity. Learn how to use ConditionExpression to prevent overwriting existing items with the DynamoDB conditional put.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.example.com/dynamodb/conditional_put.html">
    <meta property="og:image" content="https://www.example.com/images/dynamodb-conditional-put.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="DynamoDB Conditional Put - Ensure Data Integrity">
    <meta name="twitter:description" content="Perform conditional PUT operations in DynamoDB to ensure data integrity. Learn how to use ConditionExpression to prevent overwriting existing items with the DynamoDB conditional put.">
    <meta name="twitter:image" content="https://www.example.com/images/dynamodb-conditional-put.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>DynamoDB Conditional Put Example</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <p>This section demonstrates how to perform a conditional PUT operation in AWS DynamoDB using Python and the Boto3 SDK. A conditional PUT ensures that an item is only written to the table if a specified condition is met. This is crucial for maintaining data integrity and preventing unintended data overwrites.</p>

                <h2>Understanding DynamoDB Conditional Writes</h2>
                <p>Conditional writes in DynamoDB allow you to execute operations like <code>PutItem</code>, <code>UpdateItem</code>, or <code>DeleteItem</code> only if certain conditions on the item's attributes are satisfied. The <code>ConditionExpression</code> parameter is used to define these conditions. If the condition evaluates to false, the operation fails, and DynamoDB returns a <code>ConditionalCheckFailedException</code>.</p>

                <h2>Python Example: Conditional PutItem</h2>
                <p>The following Python code snippet illustrates a conditional <code>PutItem</code> operation. The condition specified is <code>attribute_not_exists(gamerid)</code>, which means the item will only be put if the <code>gamerid</code> attribute does not already exist in the table. This is a common pattern to ensure that a new record is created and not accidentally duplicated or overwritten.</p>

                <h3>Code Implementation</h3>
                <pre><code class="language-python">import boto3
from botocore import exceptions
import time

# Initialize DynamoDB client
# Replace with your actual AWS credentials and endpoint if not using default configuration
client = boto3.Session(region_name='eu-west-1').client('dynamodb', aws_access_key_id='', aws_secret_access_key='', endpoint_url='http://localhost:4567')

try:
    # Attempt to put an item with a condition
    response = client.put_item(
        TableName='gamescores',
        Item={
            'event': {'S': 'gaming_nationals_zaf'},
            'timestamp': {'S': '2019-02-08T14:53'},
            'score': {'N': '11885'},
            'name': {'S': 'will'},
            'gamerid': {'S': 'wilson9335'},
            'game': {'S': 'counter strike'},
            'age': {'N': '27'},
            'rank': {'S': 'professional'},
            'location': {'S': 'sweden'}
        },
        # Condition: Only put the item if 'gamerid' attribute does not exist
        ConditionExpression='attribute_not_exists(gamerid)'
    )
    print("Item successfully put with conditional check.")
    print(response)

except exceptions.ClientError as e:
    # Handle the case where the condition fails
    if e.response['Error']['Code'] == 'ConditionalCheckFailedException':
        print('ConditionalCheckFailedException: The gamerid already exists. Item was not put.')
    else:
        print(f"An unexpected error occurred: {e}")
</code></pre>

                <h2>Key Concepts and Best Practices</h2>
                <h3><code>ConditionExpression</code></h3>
                <p>The <code>ConditionExpression</code> is a powerful feature for implementing optimistic locking and ensuring data consistency. You can use various operators and functions to define complex conditions based on attribute values, existence, and comparisons.</p>

                <h3><code>attribute_not_exists()</code></h3>
                <p>This function within <code>ConditionExpression</code> checks if a specified attribute exists. It's commonly used to ensure that you are creating a new record rather than updating an existing one, or to prevent duplicate entries based on a unique identifier.</p>

                <h3>Error Handling</h3>
                <p>Always wrap your DynamoDB operations in a <code>try-except</code> block to catch potential <code>ClientError</code> exceptions, especially the <code>ConditionalCheckFailedException</code>. This allows your application to gracefully handle situations where the condition is not met.</p>

                <h2>Further Reading</h2>
                <ul>
                    <li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Expressions.ConditionExpressions.html" target="_blank">DynamoDB Condition Expressions Documentation</a></li>
                    <li><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/dynamodb/client/put_item.html" target="_blank">Boto3 PutItem API Reference</a></li>
                    <li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DataModeling.html" target="_blank">DynamoDB Data Modeling Concepts</a></li>
                </ul>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>