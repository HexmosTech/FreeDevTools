<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECS Environment and Secrets Management - Hexmos</title>
    <meta name="description" content="Manage environment variables and secrets for your ECS containers effectively. Learn how to configure AWS ECS task definitions for secure secret handling.">
    <meta name="keywords" content="ECS, AWS, Docker, container, environment variables, secrets, SSM, Parameter Store, IAM, task definition, configuration, DevOps, cloud, microservices">
    <link rel="canonical" href="https://www.hexmos.com/ecs/env_and_secrets.html">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="ECS Environment and Secrets Management - Hexmos">
    <meta property="og:description" content="Manage environment variables and secrets for your ECS containers effectively. Learn how to configure AWS ECS task definitions for secure secret handling.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.hexmos.com/ecs/env_and_secrets.html">
    <meta property="og:image" content="https://www.hexmos.com/images/og-image.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ECS Environment and Secrets Management - Hexmos">
    <meta name="twitter:description" content="Manage environment variables and secrets for your ECS containers effectively. Learn how to configure AWS ECS task definitions for secure secret handling.">
    <meta name="twitter:image" content="https://www.hexmos.com/images/twitter-image.jpg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ECS Environment and Secrets Management</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <h2>Understanding ECS Environment and Secrets</h2>
                <p>Managing environment variables and sensitive data like API keys, database credentials, and other secrets is crucial for the security and proper functioning of your containerized applications on Amazon Elastic Container Service (ECS). This section demonstrates how to configure your ECS task definitions to securely inject these values into your containers.</p>

                <h2>Configuring Environment Variables in ECS Task Definitions</h2>
                <p>Environment variables provide a way to pass configuration data to your containers without hardcoding them into your container images. In an ECS task definition, you can specify environment variables within the <code>containerDefinitions</code> array.</p>

                <h2>Securely Handling Secrets with AWS Systems Manager (SSM) Parameter Store</h2>
                <p>For sensitive information, it's best practice to use a secrets management service. AWS Systems Manager (SSM) Parameter Store is a popular choice for securely storing configuration data and secrets. You can reference parameters stored in SSM Parameter Store directly within your ECS task definitions.</p>

                <h2>Example ECS Task Definition for Environment and Secrets</h2>
                <p>The following JSON snippet illustrates a basic ECS task definition that includes both standard environment variables and secrets fetched from AWS SSM Parameter Store. This example uses an Nginx container.</p>
                <pre><code class="language-json">{
  "family": "app-with-secrets",
  "executionRoleArn":"arn:aws:iam::xxxxxxxxxxxx:role/ecs-exec-role",
  "taskRoleArn":"arn:aws:iam::xxxxxxxxxxxx:role/ecs-task-role",
  "containerDefinitions": [
    {
      "name": "nginx",
      "image": "nginx:latest",
      "memoryReservation": 256,
      "portMappings":[
        {
          "protocol":"tcp",
          "containerPort":3000,
          "hostPort":0
        }
      ],
      "environment": [
        {
          "name": "AWS_DEFAULT_REGION",
          "value": "eu-west-1"
        }
      ],
      "secrets": [
        {
          "name": "ACCESS_KEY_ID",
          "valueFrom": "arn:aws:ssm:eu-west-1:xxxxxxxxxxxx:parameter/myapp/prod/AWS_ACCESS_KEY_ID"          
        }
      ],
      "essential": true,
      "privileged": true
    }
  ]
}
</code></pre>

                <h2>Key Components Explained</h2>
                <ul>
                    <li><code>executionRoleArn</code>: The IAM role that the ECS agent assumes to make AWS API calls on your behalf.</li>
                    <li><code>taskRoleArn</code>: The IAM role that is assumed by tasks when they are run. This role grants permissions to your application code within the container.</li>
                    <li><code>environment</code>: An array of key-value pairs for standard environment variables.</li>
                    <li><code>secrets</code>: An array where each object maps a container environment variable name to a reference for a secret stored in AWS Secrets Manager or SSM Parameter Store. The <code>valueFrom</code> field specifies the ARN of the secret.</li>
                </ul>

                <h2>Best Practices for Secrets Management</h2>
                <p>Always use a dedicated secrets management service like AWS Secrets Manager or SSM Parameter Store for sensitive data. Avoid hardcoding secrets directly into your task definitions or container images. Ensure that your IAM roles have the least privilege necessary to access these secrets.</p>
                <p>For more in-depth information on AWS ECS and security best practices, refer to the official <a href="https://docs.aws.amazon.com/ecs/latest/developerguide/specifying-sensitive-data.html" target="_blank" rel="noopener noreferrer">AWS ECS Developer Guide</a>.</p>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>