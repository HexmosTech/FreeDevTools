<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cAdvisor Task Definition - Container Monitoring Configuration</title>
    <meta name="description" content="Configure a cAdvisor task definition for container monitoring. This JSON task definition specifies image, ports, volumes, and essential settings for cAdvisor.">
    <meta name="keywords" content="cadvisor, task definition, docker, container monitoring, json, aws ecs, configuration, sys, var_run, cgroup, dev_disk, var_lib_docker">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://example.com/ecs/cadvisor_taskdef.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://example.com/ecs/cadvisor_taskdef.html">
    <meta property="og:title" content="cAdvisor Task Definition - Container Monitoring Configuration">
    <meta property="og:description" content="Configure a cAdvisor task definition for container monitoring. This JSON task definition specifies image, ports, volumes, and essential settings for cAdvisor.">
    <meta property="og:image" content="https://example.com/path/to/your/og-image.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://example.com/ecs/cadvisor_taskdef.html">
    <meta name="twitter:title" content="cAdvisor Task Definition - Container Monitoring Configuration">
    <meta name="twitter:description" content="Configure a cAdvisor task definition for container monitoring. This JSON task definition specifies image, ports, volumes, and essential settings for cAdvisor.">
    <meta name="twitter:image" content="https://example.com/path/to/your/twitter-image.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>cAdvisor Task Definition</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <h2>Understanding the cAdvisor Task Definition</h2>
                <p>This document provides a detailed look at a task definition for cAdvisor, a container monitoring tool. The configuration is designed for deployment within container orchestration platforms like AWS ECS. It outlines the necessary parameters to run cAdvisor effectively, enabling detailed performance metrics collection for your containers.</p>

                <h2>cAdvisor Configuration Breakdown</h2>
                <p>The core of the configuration is a JSON object defining the task. This includes the container definition, specifying the Docker image, resource allocation, port mappings, and essential runtime privileges. cAdvisor requires elevated permissions and specific volume mounts to access host system information, which are crucial for its monitoring capabilities.</p>

                <h3>Key Container Definition Parameters</h3>
                <ul>
                    <li><strong>Name:</strong> Identifies the container as 'cadvisor'.</li>
                    <li><strong>Image:</strong> Uses the official 'google/cadvisor' Docker image.</li>
                    <li><strong>Memory Reservation:</strong> Sets a baseline memory allocation of 256 MiB.</li>
                    <li><strong>Port Mappings:</strong> Exposes the container's port 8080 to the host's port 8080 for accessing the cAdvisor UI and API.</li>
                    <li><strong>Essential:</strong> Marks the container as essential for the task to run.</li>
                    <li><strong>Privileged:</strong> Grants the container elevated privileges, necessary for accessing host system resources.</li>
                </ul>

                <h3>Required Volume Mounts for cAdvisor</h3>
                <p>To gather comprehensive system and container metrics, cAdvisor needs access to various host directories. The task definition includes mounts for:</p>
                <ul>
                    <li><code>/rootfs</code> (read-only): The host's root filesystem.</li>
                    <li><code>/var/run</code>: For runtime information, writable.</li>
                    <li><code>/sys</code> (read-only): System information and kernel parameters.</li>
                    <li><code>/var/lib/docker</code> (read-only): Docker daemon's data directory.</li>
                    <li><code>/dev/disk</code> (read-only): Host disk devices.</li>
                    <li><code>/sys/fs/cgroup</code> (read-only): Control group information.</li>
                </ul>

                <h2>Volume Definitions</h2>
                <p>The task definition also specifies the corresponding host volumes that map to the container paths. These volumes ensure cAdvisor can correctly access the required host system directories.</p>

                <h3>External Resources for Container Monitoring</h3>
                <ul>
                    <li><a href="https://github.com/google/cadvisor" target="_blank" rel="noopener noreferrer">cAdvisor GitHub Repository</a>: Official source for cAdvisor.</li>
                    <li><a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html" target="_blank" rel="noopener noreferrer">AWS ECS Task Definitions Documentation</a>: Learn more about configuring tasks on AWS.</li>
                    <li><a href="https://kubernetes.io/docs/concepts/cluster-administration/logging/" target="_blank" rel="noopener noreferrer">Kubernetes Logging and Monitoring Concepts</a>: Broader context on container monitoring.</li>
                </ul>
            </div>
            <pre><code class="language-json">{
  "family": "cadvisor",
  "containerDefinitions": [
    {
      "name": "cadvisor",
      "image": "google/cadvisor",
      "memoryReservation": 256,
      "portMappings":[
        {
          "protocol":"tcp",
          "containerPort":8080,
          "hostPort":8080
        }
      ],
      "essential": true,
      "privileged": true,
      "mountPoints": [
        {
          "sourceVolume": "root",
          "containerPath": "/rootfs",
          "readOnly": true
        },
        {
          "sourceVolume": "var_run",
          "containerPath": "/var/run",
          "readOnly": false
        },
        {
          "sourceVolume": "sys",
          "containerPath": "/sys",
          "readOnly": true
        },
        {
          "sourceVolume": "var_lib_docker",
          "containerPath": "/var/lib/docker",
          "readOnly": true
        },
        {
          "sourceVolume": "dev_disk",
          "containerPath": "/dev/disk",
          "readOnly": true
        },
        {
          "sourceVolume": "cgroup",
          "containerPath": "/sys/fs/cgroup",
          "readOnly": true
        }
      ]
    }
  ],
  "volumes": [
    {
      "host" : {
        "sourcePath" : "/"
      },
      "name" : "root"
    },
    {
      "host" : {
        "sourcePath" : "/var/run"
      },
      "name" : "var_run"
    },
    {
      "host" : {
        "sourcePath" : "/sys"
      },
      "name" : "sys"
    },
    {
      "host" : {
        "sourcePath" : "/var/lib/docker"
      },
      "name" : "var_lib_docker"
    },
    {
      "host" : {
        "sourcePath" : "/dev_disk"
      },
      "name" : "dev_disk"
    },
    {
      "host" : {
        "sourcePath" : "/cgroup"
      },
      "name" : "cgroup"
    }
  ]
}
</code></pre>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>