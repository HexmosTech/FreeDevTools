<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14 Sed Filter And Transform Text</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>14 Sed Filter And Transform Text</h1>
        </div>
        <div class="content">
            <div class="markdown-content"><h1>14. <code>sed</code> filter and transform text</h1>
<h2>14.1. Overview</h2>
<ul>
<li>looks for pattern and edits them</li>
<li>works on both files and stdin</li>
<li>original files is not updated</li>
<li>results are put into standard output</li>
<li>syntax is <code>sed 'instructions' file</code></li>
<li>instruction is of format <code>'[address]command/regex/replace/modifier'</code> </li>
<li>example - '5,15s/abc/ABC/g' -&gt; this will substitute abc with ABC in lines 5 to 15. <ul>
<li>modifier g specifies that all occurences of abc in line will be replaced with ABC</li>
</ul>
</li>
<li>when address is used, the lines belonging to the address are examined/modified. -&gt; <code>sed '1,100 s/A/a/' file.txt</code>. this restricts substition to first 100 lines.</li>
<li>By default all the lines are printed. When '-n' flag is used, this behavior is suppressed. Nothing will be printed unless an explicit request to print is found.</li>
<li>A pattern can be used as a address -&gt; <code>sed -n '/start/,/stop/ p' file.txt</code></li>
<li>When '!' is used, the command is run outside of the address -&gt; <code>sed -n '/match/ !p' file.txt</code></li>
</ul>
<table>
<thead>
<tr>
<th>command</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>d</td>
<td>delete</td>
</tr>
<tr>
<td>p</td>
<td>print</td>
</tr>
<tr>
<td>s</td>
<td>substitute</td>
</tr>
<tr>
<td>q</td>
<td>quit</td>
</tr>
<tr>
<td>a</td>
<td>insert a line after pattern</td>
</tr>
<tr>
<td>i</td>
<td>insert a line before pattern</td>
</tr>
<tr>
<td>c</td>
<td>change a line</td>
</tr>
<tr>
<td>y</td>
<td>transform</td>
</tr>
</tbody>
</table>
<h2>14.2. Examples</h2>
<ul>
<li>remove blank lines<br><code>sed '/^$/d' file.txt</code></li>
<li>remove all lines with search string<br><code>sed '/Search/d' file.txt</code></li>
<li>remove all instances of search string<br><code>sed 's/Search//g' file.txt</code></li>
<li>print lines with the search string<br><code>sed '/Search/ p' file.txt</code></li>
<li>substitue a string with another<br><code>sed 's/oldString/newString/g' file.txt</code></li>
<li>remove trailing spaces<br><code>sed 's/ *$//' file.txt</code></li>
<li>remove leading spaces<br><code>sed `s/^ *//' file.txt</code></li>
<li>add spaces to start of everyline<br><code>sed 's/^/    /' file.txt</code></li>
<li>print the first 10 line<br><code>sed '10 q' file.txt</code><br><code>sed -n '1,10 p' file.txt</code></li>
<li>append line after a pattern<br><code>sed '/pattern/ a add line here' file.txt</code></li>
<li>insert line before a pattern<br><code>sed '/pattern/ i add line here' file.txt</code></li>
<li>change a line with a pattern<br><code>sed '/pattern/ c line changed here' file.txt</code></li>
<li>change a-&gt;p, b-&gt;q, c-&gt;r<br><code>sed 'y/abc/pqr/' file.txt</code></li>
</ul>
<h2>14.3. Grouping</h2>
<ul>
<li>sed allows capturing specific parts of text into groups.</li>
<li>these groups can be manipulated</li>
<li>group is enclosed within parentheses expression "(" and ")" in the search string</li>
<li>each group is assigned a number. The first group is assigned \1 and so on.</li>
<li>\1 can be both in pattern string and replacement string</li>
</ul>
<h3>14.3.1. Grouping Examples:</h3>
<ul>
<li>switch first and second columns<br><code>sed 's/\([a-z]*\) \([a-z]*\)/\2 \1/' file.txt</code></li>
<li>print lines which have consecutive duplicate words<br><code>sed -n '/\([a-z][a-z]*\) \1/p' file.txt</code></li>
<li>remove consecutive duplicate words in a line<br><code>sed 's/\([a-z][a-z]*\) \1/\1/' file.txt</code></li>
</ul>
<h2>14.4. Hold Buffer</h2>
<ul>
<li>When sed read text, each line is placed into a temporary space.</li>
<li>When a new line is read, the old text is replaced by the new line in the temporary space.</li>
<li>This temporary space is called pattern space.</li>
<li>Hold buffer is like a long term storage. text can be copied to and from pattern space.</li>
</ul>
<table>
<thead>
<tr>
<th>command</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>x</td>
<td>exchange hold space and pattern space</td>
</tr>
<tr>
<td>h</td>
<td>copy pattern buffer into hold space</td>
</tr>
<tr>
<td>H</td>
<td>append pattern buffer into hold space</td>
</tr>
<tr>
<td>g</td>
<td>copy hold space to pattern space</td>
</tr>
<tr>
<td>G</td>
<td>append hold buffer into pattern buffer</td>
</tr>
</tbody>
</table>
<h3>14.4.1. Example</h3>
<ul>
<li>print one line after and before the pattern match<br><code>sed -n '/999/ !{x;d};/999/ {x;p;x;p;n;p}' file.txt</code></li>
<li>add space after every line<br><code>sed 'G' file.txt</code></li>
<li>insert blank line above every line which matches pattern<br><code>sed '/start/ {x;p;x}' file.txt</code></li>
<li>Insert blank line after every line which matches pattern<br><code>sed '/start/ {G}' file.txt</code></li>
<li>Insert blank line before and after every line which matches pattern<br><code>sed '/start/ {x;p;x;G}' file.txt</code></li>
</ul></div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>